From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul  1 14:43:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 1 Jul 1997 15:43:20 +0200
Subject: R-alpha: sd2rd v0.1-3
Message-ID: <199707011343.PAA04807@aragorn.ci.tuwien.ac.at>

Thanks to Martin, there is another update of the S doc -> R doc script.
It now correctly maps .SE into SECTION.
-k

***********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-3";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

$opt_x = 0;
use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &section(0, "SECTION(Side Effects@@"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &section(0, "SECTION($word[1]@@");
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 17:33:12 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 12:33:12 -0400 (EDT)
Subject: R-alpha: bug in eigen()
Message-ID: <Pine.SUN.3.95.970701122527.2221A-100000@paca>


  I don't have time to track this down right now -- if no-one does it in
the next few days before I finish the current piece of work I will try to
find it myself.  
  R gets the wrong answer for the eigensystem of a (particular) 4x4
matrix (SunOS 4.1.4).

Running these commands:

x _ matrix(
     c(-10,   0    ,0     ,0,
         0  ,-0.3  ,0     ,0,
         1  , 0.03 ,-0.594,0.0020,
         1.2, 0.036,0.0792,-0.0176),byrow=T,ncol=4)
eigen(x)


R gives:

$values
[1] -10.2425681  -0.5515844  -0.3023825   0.1849350
 
$vectors
              [,1]        [,2]         [,3]      [,4]
[1,] -0.9881475178  0.06506841 -0.008135724 0.1387962
[2,] -0.0007232329 -0.07331061  0.993467182 0.0874528
[3,]  0.1014706558  0.95415639  0.046029849 0.2777959
[4,]  0.1151853550 -0.28280247 -0.104105822 0.9465290
 
S-PLUS 3.1 gives:

$values:
[1] -10.00000000  -0.59427468  -0.30000000  -0.01732532
 
$vectors:
           [,1]        [,2]       [,3]         [,4] 
[1,]  1.0000000  0.00000000  0.0000000  0.000000000
[2,]  0.0000000  0.00000000  1.0000000  0.000000000
[3,] -0.1062897 -0.06249770  0.1009810 -0.003466636
[4,] -0.1193683  0.00858338 -0.1557992 -0.999560734


Note that the structure of the matrix actually gives us (-10.0) and (-0.3)
for free, so the S-PLUS answer looks right.

  Even worse:

eigen(x[3:4,3:4])

  gives (R)

$values
[1] -0.604684392 -0.006915608
 
$vectors
           [,1]      [,2]
[1,]  0.9910228 0.1336929
[2,] -0.1336929 0.9910228


 (S-PLUS)
$values:
[1] -0.59427468 -0.01732532
 
$vectors:
            [,1]         [,2] 
[1,] -0.06249770 -0.003466636
[2,]  0.00858338 -0.999560734

  so it's not just some funky pivoting problem.

  Or am I doing something *really* dumb?

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 18:09:25 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 13:09:25 -0400 (EDT)
Subject: R-alpha: eigen() bug
Message-ID: <Pine.SUN.3.95.970701130757.2597A-100000@paca>


  It looks like there may be a mismatch between the library function and
the C code ... the help file for eigen() says that the function checks to
see if the matrix is symmetrix first, and passes it off to different
routines in different cases.  It looks like eigen() doesn't actually
bother to do any checking, and just *assumes* it's symmetric ...

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul  1 18:24:22 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 1 Jul 1997 19:24:22 +0200
Subject: R-alpha: eigen() bug -- fixed in 0.50 (soon...)
In-Reply-To: <Pine.SUN.3.95.970701130757.2597A-100000@paca> (message from Ben
 Bolker on Tue, 1 Jul 1997 13:09:25 -0400 (EDT))
Message-ID: <199707011724.TAA02001@sophie.ethz.ch>

I  have learned that the bug is fixed in the next release ...
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 18:33:29 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 13:33:29 -0400 (EDT)
Subject: R-alpha: bugs generally
Message-ID: <Pine.SUN.3.95.970701132909.2633B-100000@paca>


  In the future (say after release 0.5 goes out), would it be feasible to
start a publically-accessible list of bug reports, known bugs, and
patches?  (Something like the current TASKS list, but maybe a little bit
more dynamic?)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jul  2 22:11:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 2 Jul 1997 14:11:54 -0700 (PDT)
Subject: R-alpha: R-beta: image()
In-Reply-To: <199707011343.PAA04807@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970702141038.2207A-100000@zen>


Using image() produces plots that look fine on the x11() device and in
ghostview at screen resolution but contain lots of horizontal white lines
at higher resolution. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul  3 06:27:42 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 3 Jul 1997 07:27:42 +0200
Subject: R-alpha: bugs generally
In-Reply-To: <Pine.SUN.3.95.970701132909.2633B-100000@paca>
References: <Pine.SUN.3.95.970701132909.2633B-100000@paca>
Message-ID: <199707030527.HAA05571@aragorn.ci.tuwien.ac.at>

>>>>> Ben Bolker writes:

>   In the future (say after release 0.5 goes out), would it be feasible
> to start a publically-accessible list of bug reports, known bugs, and
> patches?  (Something like the current TASKS list, but maybe a little
> bit more dynamic?)

There has recently been some discussion regarding widening the official
developer base and the amount of people who can apply patches to the
source tree.  I think that as soon as that is worked out, we can also
start thinking about a bug management system.  What I have in mind is
something akin to the debian-bugs system.

But clearly, without a `patch management system' we cannot do that.

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  3 16:54:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Jul 1997 17:54:51 +0200
Subject: R-alpha: plot(  pch = <character> ) is slow.. -- why ? --
Message-ID: <199707031554.RAA04752@sophie.ethz.ch>

Can anyone explain this to us :


> unlist(version)
              platform                   arch                     os 
"sparc-sun-solaris2.5"                "sparc"           "solaris2.5" 
                system                 status             status.rev 
   "sparc, solaris2.5"                 "Beta"                    "0" 
                 major                  minor                   year 
                   "0"                   "49"                 "1997" 
              language 
                   "R" 


# (The following is using  x11() and an  Ultrasparc I.
# You should decrease from '20000' if you have a slower machine):

> x <- runif(20000)

> for(i in 1:10) print(unix.time(plot(x)))
[1] 1.66 0.04 3.00 0.00 0.00
[1] 1.33 0.04 2.00 0.00 0.00
[1] 1.68 0.04 3.00 0.00 0.00
[1] 1.40 0.05 2.00 0.00 0.00
[1] 1.67 0.06 2.00 0.00 0.00
[1] 1.44 0.05 3.00 0.00 0.00
[1] 1.68 0.06 2.00 0.00 0.00
[1] 1.38 0.04 2.00 0.00 0.00
[1] 1.66 0.06 2.00 0.00 0.00
[1] 1.41 0.06 3.00 0.00 0.00
> 
> for(i in 1:10) print(unix.time(plot(x, pch='-')))
[1]  4.76  3.25 21.00  0.00  0.00
[1]  4.29  2.51 20.00  0.00  0.00
[1]  4.46  2.95 20.00  0.00  0.00
[1]  4.75  2.95 21.00  0.00  0.00
[1]  5.42  2.99 23.00  0.00  0.00
[1]  4.73  3.14 23.00  0.00  0.00
[1]  4.93  3.00 23.00  0.00  0.00
[1]  4.62  3.02 22.00  0.00  0.00
[1]  4.76  3.06 23.00  0.00  0.00
[1]  4.62  2.82 22.00  0.00  0.00
                ^^^^^
		this tells you that the DRAWING PROCESS is the slow thing.
		it takes about 10 times longer...


Why is x11 much faster in drawing pch=1 (a circle), than a simple "-" ?
Is this X11's `fault' ?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Thu Jul  3 17:28:58 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Thu, 3 Jul 1997 09:28:58 -0700 (PDT)
Subject: R-alpha: plot(  pch = <character> ) is slow.. -- why ? --
In-Reply-To: <199707031554.RAA04752@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970703091049.5412B-100000@chekov>

On Thu, 3 Jul 1997, Martin Maechler wrote:

> # (The following is using  x11() and an  Ultrasparc I.
> # You should decrease from '20000' if you have a slower machine):
> 
> > x <- runif(20000)
> 
> > for(i in 1:10) print(unix.time(plot(x)))
> [1] 1.66 0.04 3.00 0.00 0.00
> > for(i in 1:10) print(unix.time(plot(x, pch='-')))
> [1]  4.76  3.25 21.00  0.00  0.00
> 
> Why is x11 much faster in drawing pch=1 (a circle), than a simple "-" ?
> Is this X11's `fault' ?

Same thing on a Pentium Pro running Linux and displaying on a Sparcstation
10.  

It looks like X11's fault: the graphics code directly calls the X11
functions in each case, however S-PLUS does not have this slowdown.  I
would have thought the explanation was that "-" requires plotting text and
the circle is just graphics, however the square (pch=0) which is also a
simple graphic is just as slow.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Jul  3 17:42:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 3 Jul 1997 18:42:55 +0200
Subject: R-alpha: confidence interval of t.test
Message-ID: <199707031642.SAA09777@galadriel.ci.tuwien.ac.at>


Sorry if this has been discussed here before, but anyway:

The are differences between the confidence intervals of the t.test as
done by R and Splus:

*** R

R> x<-rnorm(1000)+1
R> t.text(x)
Error: couldn't find function "t.text"
R> t.test(x)

         One Sample t-test 

data:  x 
t = 31.4062, df = 999, p-value = 0 
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 0.917027 1.039261 
sample estimates:
mean of x 
 0.978144 

R> t.test(x, mu=1)

         One Sample t-test 

data:  x 
t = -0.7017, df = 999, p-value = 0.483 
alternative hypothesis: true mean is not equal to 1 
95 percent confidence interval:
 -0.08297297  0.03926111                      <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
sample estimates:
mean of x 
 0.978144 



*** Splus

> x<-rnorm(1000)+1
> t.test(x)

         One-sample t-Test 

data:  x 
t = 28.6918, df = 999, p-value = 0 
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 0.8975418 1.0293277 
sample estimates:
 mean of x 
 0.9634347

> t.test(x, mu=1)

         One-sample t-Test 

data:  x 
t = -1.0889, df = 999, p-value = 0.2764 
alternative hypothesis: true mean is not equal to 1 
95 percent confidence interval:
 0.8975418 1.0293277                    <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
sample estimates:
 mean of x 
 0.9634347



*******************


As you can See R's confidence intervals are centered around the
deviation from the null, whereas those of Splus are centered around
the observed value ... the later seems the more intuitive thing to me.

So is this a bug or feature of R (in my eyes it's a bug)?


Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul  7 14:33:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 7 Jul 1997 15:33:47 +0200
Subject: R-alpha: box( col = ..)  does not work
Message-ID: <199707071333.PAA00765@sophie.ethz.ch>

The 'col' argument does not work with  box(.)  contrary to the
documentation.
'lty' does nicely.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 10 13:17:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 10 Jul 1997 14:17:48 +0200
Subject: R-alpha: R-mailinglists -- "server down" scheduled for Friday, July 18 (MET)
Message-ID: <199707101217.OAA01668@sophie.ethz.ch>

It's vacation time here, so ...

Friday in 8 days, our main server will get an OS upgrade
	(Solaris 2.4 |--> 2.5.1).
This will make the  R-mailinglists fail for several hours
(or more if we are unlucky).

I hope that the next  alpha or beta release of R 
will be well BEFORE that date such that nobody will suffer from this out
time. 

[ Usual working time of the upgrade staff is 8.00 -- 17.00 (= 5pm)
  Middle-European Summer Time  ("MET DST") which is Universal Time +2(hours),
  i.e., it won't affect NZ's Friday much... ]


Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 11 16:39:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 11 Jul 1997 17:39:48 +0200
Subject: R-alpha: wishlist
Message-ID: <199707111539.RAA01670@aragorn.ci.tuwien.ac.at>

Here's something which could go on the TODO list:  give scan() the
ability to also read in fixed-width format data files, e.g. with an
optional `widths' argument as in S-PLUS.
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul 14 15:24:07 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 14 Jul 1997 16:24:07 +0200
Subject: R-alpha: <primitive>  vs .Internal(.) [was "Problem with `rpois'"]
In-Reply-To: <m3u3i4mg2g.fsf@sade.uio.no> (fredrigl@math.uio.no)
Message-ID: <199707141424.QAA00881@sophie.ethz.ch>

This is more a `request for comment' than anything else.

>>>>> "Fredr" == Fredrik Glockner <fredrigl@math.uio.no> writes:

    Fredr> There is a problem with `rpois'.  It does seem to take care
    Fredr> about the order of the arguments.  This is an example:

    >> rpois(n=1,lambda=2)
    Fredr> [1] 3
    >> rpois(lambda=2,n=1)
    Fredr> [1] 2 0

    Fredr> It obviously uses the first argument as the number of samples to
    Fredr> be drawn, which is wrong.

    Fredr> I used Version 0.49 Beta (April 23, 1997).

I assume that all you R-devel'ers thought something like

	"Well yes, we know this is because 'rpois' is a primitive function
	and  R&R  once had this problem on their  TODO / TASKS list ".

However, there was no answer going through  R-help or even CC'ed to
R-devel.

I've been think about this dilemma a little bit myself,
have looked at		main/names.c    a little bit,
and ``concluded'' (i.e. "wildly guessed")
that

	i. a) <primitive> functions must be somewhat more efficient than
		.Internal(foo(..)) ones.
           
	   b) How much more efficient? [CPU / memory] ??

	
	ii. From the point of view of the
			``robust / portable / defensive'' programming paradigm
	    it is really quit undesirable to have these <primitive>
	    functions.
	    R programmers have no reliable way of finding out the argument
	    specifications of these functions, unless by searching for the
	    corresponding "do_FOO" function and reading it's C code.

	    I know there's  help(.)   and yes, this helps (!) -- but still....
	  
	    The above <bug report> of   Fredrik  is really are reason for using
	    "proper" (non-primitive) R functions as much as possible. 

	iii.   ????
		    <<< The things  Ross and Luke and ?? will tell us.
	
--
In summary, my proposal is to use   <primitive>s  much less than currently.
But I'm more than willing to learn why this would not be a good idea.

Finally:

I've spent 2 hours or so to wade through the  probability distribution
codes and 'patch' all these functions such as to use  
	function(..) .Internal(..)
code instead of being primitve.

The following patch applies cleanly .. and seems to do just what I want.
Of course, it solves Fredrik's problem.

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/


--- src/library/base/funs/distn.~1~	Mon Nov 25 11:42:00 1996
+++ src/library/base/funs/distn	Mon Jul 14 15:52:55 1997
@@ -42,3 +38,49 @@
 qweibull <- function(p, shape, scale=1) .Internal(qweibull(p, shape, scale))
 rweibull <- function(n, shape, scale=1) .Internal(rweibull(n, shape, scale))
 
+
+##--- Argument names taken from  ../man/Beta :
+dbeta <- function(x, a, b) .Internal(dbeta(x, a, b))
+pbeta <- function(q, a, b) .Internal(pbeta(q, a, b))
+qbeta <- function(p, a, b) .Internal(qbeta(p, a, b))
+rbeta <- function(n, a, b) .Internal(rbeta(n, a, b))
+##--- Argument names taken from  ../man/Binomial :
+dbinom <- function(x, n, p) .Internal(dbinom(x, n, p))
+pbinom <- function(q, n, p) .Internal(pbinom(q, n, p))
+qbinom <- function(prob, n, p) .Internal(qbinom(prob, n, p))
+rbinom <- function(nobs, n, p) .Internal(rbinom(nobs, n, p))
+##--- Argument names taken from  ../man/Chisquare :
+dchisq <- function(x, df) .Internal(dchisq(x, df))
+pchisq <- function(q, df) .Internal(pchisq(q, df))
+qchisq <- function(p, df) .Internal(qchisq(p, df))
+rchisq <- function(n, df) .Internal(rchisq(n, df))
+##--- Argument names taken from  ../man/F :
+df <- function(x, n1, n2) .Internal(df(x, n1, n2))
+pf <- function(q, n1, n2) .Internal(pf(q, n1, n2))
+qf <- function(p, n1, n2) .Internal(qf(p, n1, n2))
+rf <- function(n, n1, n2) .Internal(rf(n, n1, n2))
+##--- Argument names taken from  ../man/Geometric :
+dgeom <- function(x, p) .Internal(dgeom(x, p))
+pgeom <- function(q, p) .Internal(pgeom(q, p))
+qgeom <- function(prob, p) .Internal(qgeom(prob, p))
+rgeom <- function(n, p) .Internal(rgeom(n, p))
+##--- Argument names taken from  ../man/Hypergeometric :
+dhyper <- function(x, N1, N2, n) .Internal(dhyper(x, N1, N2, n))
+phyper <- function(q, N1, N2, n) .Internal(phyper(q, N1, N2, n))
+qhyper <- function(p, N1, N2, n) .Internal(qhyper(p, N1, N2, n))
+rhyper <- function(nobs, N1, N2, n) .Internal(rhyper(nobs, N1, N2, n))
+##--- Argument names taken from  ../man/NegBinomial :
+dnbinom <- function(x, n, p) .Internal(dnbinom(x, n, p))
+pnbinom <- function(q, n, p) .Internal(pnbinom(q, n, p))
+qnbinom <- function(prob, n, p) .Internal(qnbinom(prob, n, p))
+rnbinom <- function(nobs, n, p) .Internal(rnbinom(nobs, n, p))
+##--- Argument names taken from  ../man/Poisson :
+dpois <- function(x, lambda) .Internal(dpois(x, lambda))
+ppois <- function(q, lambda) .Internal(ppois(q, lambda))
+qpois <- function(p, lambda) .Internal(qpois(p, lambda))
+rpois <- function(n, lambda) .Internal(rpois(n, lambda))
+##--- Argument names taken from  ../man/T
+dt <- function(x, df) .Internal(dt(x, df))
+pt <- function(q, df) .Internal(pt(q, df))
+qt <- function(p, df) .Internal(qt(p, df))
+rt <- function(n, df) .Internal(rt(n, df))
--- src/main/names.c.~2~	Fri Jul  4 16:42:42 1997
+++ src/main/names.c	Mon Jul 14 15:52:33 1997
@@ -210,25 +210,25 @@
 {"lchoose",	do_math2,	4,	1,	2,	PP_FUNCALL,	0},
 {"choose",	do_math2,	5,	1,	2,	PP_FUNCALL,	0},
 
-{"dchisq",	do_math2,	6,	1,	2,	PP_FUNCALL,	0},
-{"pchisq",	do_math2,	7,	1,	2,	PP_FUNCALL,	0},
-{"qchisq",	do_math2,	8,	1,	2,	PP_FUNCALL,	0},
+{"dchisq",	do_math2,	6,	11,	2,	PP_FUNCALL,	0},
+{"pchisq",	do_math2,	7,	11,	2,	PP_FUNCALL,	0},
+{"qchisq",	do_math2,	8,	11,	2,	PP_FUNCALL,	0},
 
 {"dexp",	do_math2,	9,	11,	2,	PP_FUNCALL,	0},
 {"pexp",	do_math2,	10,	11,	2,	PP_FUNCALL,	0},
 {"qexp",	do_math2,	11,	11,	2,	PP_FUNCALL,	0},
 
-{"dgeom",	do_math2,	12,	1,	2,	PP_FUNCALL,	0},
-{"pgeom",	do_math2,	13,	1,	2,	PP_FUNCALL,	0},
-{"qgeom",	do_math2,	14,	1,	2,	PP_FUNCALL,	0},
-
-{"dpois",	do_math2,	15,	1,	2,	PP_FUNCALL,	0},
-{"ppois",	do_math2,	16,	1,	2,	PP_FUNCALL,	0},
-{"qpois",	do_math2,	17,	1,	2,	PP_FUNCALL,	0},
-
-{"dt",		do_math2,	18,	1,	2,	PP_FUNCALL,	0},
-{"pt",		do_math2,	19,	1,	2,	PP_FUNCALL,	0},
-{"qt",		do_math2,	20,	1,	2,	PP_FUNCALL,	0},
+{"dgeom",	do_math2,	12,	11,	2,	PP_FUNCALL,	0},
+{"pgeom",	do_math2,	13,	11,	2,	PP_FUNCALL,	0},
+{"qgeom",	do_math2,	14,	11,	2,	PP_FUNCALL,	0},
+
+{"dpois",	do_math2,	15,	11,	2,	PP_FUNCALL,	0},
+{"ppois",	do_math2,	16,	11,	2,	PP_FUNCALL,	0},
+{"qpois",	do_math2,	17,	11,	2,	PP_FUNCALL,	0},
+
+{"dt",		do_math2,	18,	11,	2,	PP_FUNCALL,	0},
+{"pt",		do_math2,	19,	11,	2,	PP_FUNCALL,	0},
+{"qt",		do_math2,	20,	11,	2,	PP_FUNCALL,	0},
 
 
 #ifdef COMPLEX_DATA
@@ -244,21 +244,21 @@
 
 /* Mathematical Functions of Three Variables */
 
-{"dbeta",	do_math3,	1,	1,	3,	PP_FUNCALL,	0},
-{"pbeta",	do_math3,	2,	1,	3,	PP_FUNCALL,	0},
-{"qbeta",	do_math3,	3,	1,	3,	PP_FUNCALL,	0},
-
-{"dbinom",	do_math3,	4,	1,	3,	PP_FUNCALL,	0},
-{"pbinom",	do_math3,	5,	1,	3,	PP_FUNCALL,	0},
-{"qbinom",	do_math3,	6,	1,	3,	PP_FUNCALL,	0},
+{"dbeta",	do_math3,	1,	11,	3,	PP_FUNCALL,	0},
+{"pbeta",	do_math3,	2,	11,	3,	PP_FUNCALL,	0},
+{"qbeta",	do_math3,	3,	11,	3,	PP_FUNCALL,	0},
+
+{"dbinom",	do_math3,	4,	11,	3,	PP_FUNCALL,	0},
+{"pbinom",	do_math3,	5,	11,	3,	PP_FUNCALL,	0},
+{"qbinom",	do_math3,	6,	11,	3,	PP_FUNCALL,	0},
 
 {"dcauchy",	do_math3,	7,	11,	3,	PP_FUNCALL,	0},
 {"pcauchy",	do_math3,	8,	11,	3,	PP_FUNCALL,	0},
 {"qcauchy",	do_math3,	9,	11,	3,	PP_FUNCALL,	0},
 
-{"df",		do_math3,	10,	1,	3,	PP_FUNCALL,	0},
-{"pf",		do_math3,	11,	1,	3,	PP_FUNCALL,	0},
-{"qf",		do_math3,	12,	1,	3,	PP_FUNCALL,	0},
+{"df",		do_math3,	10,	11,	3,	PP_FUNCALL,	0},
+{"pf",		do_math3,	11,	11,	3,	PP_FUNCALL,	0},
+{"qf",		do_math3,	12,	11,	3,	PP_FUNCALL,	0},
 
 {"dgamma",	do_math3,	13,	11,	3,	PP_FUNCALL,	0},
 {"pgamma",	do_math3,	14,	11,	3,	PP_FUNCALL,	0},
@@ -272,9 +272,9 @@
 {"plogis",	do_math3,	20,	11,	3,	PP_FUNCALL,	0},
 {"qlogis",	do_math3,	21,	11,	3,	PP_FUNCALL,	0},
 
-{"dnbinom",	do_math3,	22,	1,	3,	PP_FUNCALL,	0},
-{"pnbinom",	do_math3,	23,	1,	3,	PP_FUNCALL,	0},
-{"qnbinom",	do_math3,	24,	1,	3,	PP_FUNCALL,	0},
+{"dnbinom",	do_math3,	22,	11,	3,	PP_FUNCALL,	0},
+{"pnbinom",	do_math3,	23,	11,	3,	PP_FUNCALL,	0},
+{"qnbinom",	do_math3,	24,	11,	3,	PP_FUNCALL,	0},
 
 {"dnorm",	do_math3,	25,	11,	3,	PP_FUNCALL,	0},
 {"pnorm",	do_math3,	26,	11,	3,	PP_FUNCALL,	0},
@@ -288,39 +288,39 @@
 {"pweibull",	do_math3,	32,	11,	3,	PP_FUNCALL,	0},
 {"qweibull",	do_math3,	33,	11,	3,	PP_FUNCALL,	0},
 
-{"dnchisq",	do_math3,	34,	1,	3,	PP_FUNCALL,	0},
-{"pnchisq",	do_math3,	35,	1,	3,	PP_FUNCALL,	0},
-{"qnchisq",	do_math3,	36,	1,	3,	PP_FUNCALL,	0},
+{"dnchisq",	do_math3,	34,	11,	3,	PP_FUNCALL,	0},
+{"pnchisq",	do_math3,	35,	11,	3,	PP_FUNCALL,	0},
+{"qnchisq",	do_math3,	36,	11,	3,	PP_FUNCALL,	0},
 
 
 /* Mathematical Functions of Four Variables */
 
-{"dhyper",	do_math4,	1,	1,	4,	PP_FUNCALL,	0},
-{"phyper",	do_math4,	2,	1,	4,	PP_FUNCALL,	0},
-{"qhyper",	do_math4,	3,	1,	4,	PP_FUNCALL,	0},
+{"dhyper",	do_math4,	1,	11,	4,	PP_FUNCALL,	0},
+{"phyper",	do_math4,	2,	11,	4,	PP_FUNCALL,	0},
+{"qhyper",	do_math4,	3,	11,	4,	PP_FUNCALL,	0},
 
 
 /* Random Numbers */
 
-{"rchisq",	do_random1,	0,	1,	2,	PP_FUNCALL,	0},
+{"rchisq",	do_random1,	0,	11,	2,	PP_FUNCALL,	0},
 {"rexp",	do_random1,	1,	11,	2,	PP_FUNCALL,	0},
-{"rgeom",	do_random1,	2,	1,	2,	PP_FUNCALL,	0},
-{"rpois",	do_random1,	3,	1,	2,	PP_FUNCALL,	0},
-{"rt",		do_random1,	4,	1,	2,	PP_FUNCALL,	0},
+{"rgeom",	do_random1,	2,	11,	2,	PP_FUNCALL,	0},
+{"rpois",	do_random1,	3,	11,	2,	PP_FUNCALL,	0},
+{"rt",		do_random1,	4,	11,	2,	PP_FUNCALL,	0},
 
-{"rbeta",	do_random2,	0,	1,	3,	PP_FUNCALL,	0},
-{"rbinom",	do_random2,	1,	1,	3,	PP_FUNCALL,	0},
+{"rbeta",	do_random2,	0,	11,	3,	PP_FUNCALL,	0},
+{"rbinom",	do_random2,	1,	11,	3,	PP_FUNCALL,	0},
 {"rcauchy",	do_random2,	2,	11,	3,	PP_FUNCALL,	0},
-{"rf",		do_random2,	3,	1,	3,	PP_FUNCALL,	0},
+{"rf",		do_random2,	3,	11,	3,	PP_FUNCALL,	0},
 {"rgamma",	do_random2,	4,	11,	3,	PP_FUNCALL,	0},
 {"rlnorm",	do_random2,	5,	11,	3,	PP_FUNCALL,	0},
 {"rlogis",	do_random2,	6,	11,	3,	PP_FUNCALL,	0},
-{"rnbinom",	do_random2,	7,	1,	3,	PP_FUNCALL,	0},
+{"rnbinom",	do_random2,	7,	11,	3,	PP_FUNCALL,	0},
 {"rnorm",	do_random2,	8,	11,	3,	PP_FUNCALL,	0},
 {"runif",	do_random2,	9,	11,	3,	PP_FUNCALL,	0},
 {"rweibull",	do_random2,	10,	11,	3,	PP_FUNCALL,	0},
 
-{"rhyper",	do_random3,	0,	1,	4,	PP_FUNCALL,	0},
+{"rhyper",	do_random3,	0,	11,	4,	PP_FUNCALL,	0},
 
 {"sample",	do_sample,	0,	11,	3,	PP_FUNCALL,	0},
 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From malewski@Psyres-Stuttgart.DE  Wed Jul 16 21:48:52 1997
From: malewski@Psyres-Stuttgart.DE (Peter Malewski)
Date: Wed, 16 Jul 1997 22:48:52 +0200 (MET DST)
Subject: R-alpha: memory problems ?
Message-ID: <Pine.GSO.3.96.970716224139.11598C-100000@sunserv>

Hallo,

This is not so urgent, because most analysis are made by S+, -> just a
hint: I had run Rapril under Win95 with 64 Mb RAM. After a Ram upgrade to
128 mb R doesn't start any more.

good luck for the future ...






=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Peter Malewski                            Center for Psychotherapy Research
Psychologist                              Christian-Belser-Strasse 79a
Project TR-EAT                            D-70597 Stuttgart Germany
                                                 
malewski@psyres-stuttgart.de                      
+49 711 6781-404 (phone)                       
+49 711 6876902  (fax)    
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Thu Jul 17 20:16:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Thu, 17 Jul 1997 15:16:55 -0400 (EDT)
Subject: R-alpha: functionality of CASIM: C/S-Plus interface
Message-ID: <Pine.SUN.3.95.970717151335.4942A-100000@paca>


   Some people here have started using CASIM, which is an add-on we got a
while back for S-Plus that allows one to spawn an S-Plus process from a C
program and communicate with it.
   How hard do folks think it would be to develop such an interface for R?
I might try it, but I'm not completely sure I'm up to it (although it
would exercise my programming skills).
   Also, I wonder again at the ethics of looking at the CASIM header files
(which came from StatSci) when trying to work up an R interface --
although I notice that the header files say "CSIRO division of Mathematics
and Statistics" on them rather than "StatSci" ...

  Ben

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From oehl@Psyres-Stuttgart.DE  Tue Jul 22 09:56:56 1997
From: oehl@Psyres-Stuttgart.DE (Jens Oehlschlaegel)
Date: Tue, 22 Jul 1997 10:56:56 +0200 (MET DST)
Subject: R-alpha: some thoughts about factor()
Message-ID: <Pine.GSO.3.96.970722105018.17490E-100000@sunserv>



Dear R-people,

recently at s-news we had a discussion about factor().
I thought you might be interested in some of my thoughts about factors.

Any comments welcome


Best regards


Jens Oehlschlaegel-Akiyoshi


-------------------------------------------------------------------

I think the problem is deeper than that factors would just be handled
inapprobriately by some S+ functions, the inconsistency is built in
the constructor factor(), and thus is built in the concept! 

Let me cite S+ online help of factor() on the meaning of levels:

VALUE
object of class "factor", representing values taken from the finite set
given by levels. It is important that this object 
is not numeric; in particular, comparisons and other operations behave
AS IF THEY OPERATED ON VALUES FROM THE LEVELS SET, WHICH IS ALWAYS OF
MODE CHARACTER.

Let's try comparisions on values from the level set:

> my.animals <- c(4,5,6,4,5,6)
> my.levels <- 4:6
> my.labels <- c("dog","cat","rat")
> animals <- factor(my.animals,levels=my.levels,labels=my.labels)
> unclass(animals)
[1] 1 2 3 1 2 3
attr(, "levels"):
[1] "dog" "cat" "rat"

Obviously labels become levels, and comparisions with levels will never work,
whether levels are given as numerics or as characters, as in

> animals==4
[1] F F F F F F
> animals=="4"
[1] F F F F F F

Obviously currently all comparisions work on the LABELS SET, which is the
only one stored with the factor object, but which - for purpose of
confusion - is a named attribute "levels", whereas
 
> labels(animals) 
[1] "1" "2" "3" "4" "5" "6"

is a totally different story. 



All a user like me wishes is something like

> unclass(animals)
[1] 4 5 6 4 5 6
attr(, "labels"):
[1] "dog" "cat" "rat"

and of course it would be user-friendly if S+ would recognize which of
both representations are meant in comparisions and assignments like

animals==4
animals=="dog"
animals[1] <- 4
animals[1] <- "dog"

not coercing 4s to "4"s but interpreting animals the right way, isn't S+
an interpreter?


If there is no way around a need for internal numeric representation of
integers 1:x then a factor object could look like

> unclass(animals)
[1] 1 2 3 1 2 3
attr(, "levels"):
[1] "dog" "cat" "rat"
attr(, "nlevels"):
[1] 4 5 6


and consequently


[old function, sorry for the s-at-the-end-confusion] 
codes(animals)  could return 1 2 3 1 2 3

[old function] 
levels(animals) could return "dog" "cat" "rat"
[new function] 
level(animals) could return "dog" "cat" "rat" "dog" "cat" "rat"

[new function] 
nlevels(animals) could return 4 5 6
[new function]
nlevel(animals) could return 4 5 6 4 5 6


for reasons of consistency, so everyone would know he has to write either 

  nlevel(animals)==4
  nlevel(animals)[1] <- 4

or

  level(animals)=="dog"
  level(animals)[1] <- "dog"


Concerning defaults one probably would keep returning

animals
[1] "dog" "cat" "rat" "dog" "cat" "rat"

for reasons of compatibility

but make the evaluator coerce animals to nlevel(animals) in

animals[1] <- 4

instead of 

coercing 4 to "4"


I have no idea about how to change the constructor factor() to keep
compatibility, perhaps just keep arguments old.levels=new.nlevels and
old.labels=new.levels, together with a clear help function? 

DOES THAT SOUND ANY BETTER?



yours sincerely

--
Jens Oehlschlaegel-Akiyoshi
Psychologist/Statistician
Project TR-EAT + COST Action B6
                                                 F.rankfurt
oehl@psyres-stuttgart.de                         A.ttention
+49 711 6781-408 (phone)                         I.nventory
+49 711 6876902  (fax)                           R .-----.
                                                  / ----- \
Center for Psychotherapy Research                | | 0 0 | |
Christian-Belser-Strasse 79a                     | |  ?  | |
D-70597 Stuttgart Germany                         \ ----- /
-------------------------------------------------- '-----' -
                                                 it's better








=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul 22 21:30:47 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 22 Jul 1997 16:30:47 -0400 (EDT)
Subject: R-alpha: split() S/R mismatch?
Message-ID: <Pine.SUN.3.95.970722162745.10400A-100000@paca>


  I *think* that split(x,f) in S/S-PLUS (SunOS 4, S-PLUS 3.2) by default
replicates f as many times as necessary to cover the length of x.  In R it
apparently doesn't.

  I have the following function:

matsplit <-
function (x, crit) 
{
        lapply(split(x, crit), matrix, ncol = ncol(x))
        #  x is a matrix, crit is a vector with length dim(x)[1] ...
        #   makes a list of matrices split by row
}

The following:

y _ cbind(matrix(1:10,ncol=2,byrow=T),rep(1:2,c(2,3)))
matsplit(y[,1:2],y[,3])

gives

$"1":
     [,1] [,2] 
[1,]    1    2
[2,]    3    4
 
$"2":
     [,1] [,2] 
[1,]    5    6
[2,]    7    8
[3,]    9   10
 
 in S-PLUS; in R it gives

Error in split(x, as.factor(f)) : argument lengths differ

 I can find a workaround.  Is this a bug, a feature, or just a difference?

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Jul 22 23:12:34 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
Subject: R-alpha: New version of R for testing
Message-ID: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>

The newest version of R for Unix (version 0.50 alpha-1) is now (or will
soon be) available from the following sites.

    NORTH AMERICA:
	http://lib.stat.cmu.edu/R/Alpha

    EUROPE:
        ftp://ftp.stat.math.ethz.ch/R/
        ftp://statlab.uni-heidelberg.de/pub/mirrors/auckland/R/

    JAPAN:
        ftp://ftp.u-aizu.ac.jp/pub/lang/R/

    NEW ZEALAND:
        ftp://stat.auckland.ac.nz/pub/R/

Please obtain a copy from site close to you.  Note that New Zealand
is not close to anywhere other than itself :-).

This is primarily a bug-fix release, although there is some new
functionalty.  As noted in the 0.49 release announcement, the primary
goal at present is stability.  This is partly for the benefit of anyone
who might be using R, but also so that we we can bring the PC and
Mac versions into sync with the Unix version.

The "alpha-1" indicates that there may be a few stability problems with
this version.  This is because there are been a number of very low-level
changes which have not been exercised as much as they might.  We hope
that these can be found and fixed in a couple of patch cycles.  Then
we will declare it to be "R-0.50 stable".

This version owes a good deal to Martin Maechler who probably did as
much bug-fixing as R+R together this time.

	R + R + M


We have not kept good a records of bug fixes or updates the TASKS list
(we should have this updated for the "stable" release).  A partial list
of changes follows.

-------------------------------------------------------------------

		  CHANGES IN VERSION R VERSION 0.50

WARNING!!!

 o  A change in the way that "expressions" are implemented means that
    saved data images which contain expressions will probably not
    restore properly.

NEW FEATURES

 o  "expressions" are now implemented as a basic type rather than as
    a class of object.  This change was made as move toward compatibility
    with S and also to implement mathematical annotation in graphs.

 o  "eigen" can now handle complex and non-symmetric matrices.

 o  Libraries are now attached by loading their code into newly created
    environment frames on the search path rather than in with the general
    system code.  This means that libraries can be unloaded as well as
    loaded.  They can also have .First.lib and .Last.lib functions.

 o  There is now an experimental function called "delay" which creates
    a promise to evaluate an expression.  This provides direct access
    to the lazy evaluation mechanism used by R.

 o  >>>>  'make tests'   allows to test--run all the help() examples.
 
 o  New functions   matplot / matpoints / matlines.

 o  cut has 2 new arguments. 'right = TRUE' gives intervals closed on the
	right, open to the left (as S); 'right = FALSE' allows to reverse
	this. The code for default label construction has been enhanced,
	and can be controlled by the new argument 'dig.lab'.

 o  legend(.) has 2 new arguments 'cex' (obvious) and 'merge = FALSE'.
	-> ?legend.

 o  deparse  has a 2nd argument allowing for a kind of line width.

 o  many help(.) pages have been updated with working examples,
	and several new ones have been created.

BUG FIXES

 o  A bug which prevented the "pictex" graphics driver from working
    has been fixed.

 o  Regression diagnostics obtained with "lm.influence" now work when
    there are weights.	This means they should work for glms.

 o  There was a problem in parsing files from statements which were
    separated from following statements by ";" (e.g. data(iris); iris).
    This is fixed.

 o  Comments are handled better in functions.  The rule is that they
    are shifted to just before their statements.  Comments after the
    last statement of a function are lost.

 o  It is now possible to perform complicated mutations of expressions.
    For example
	e <- quote(f(x=1,y=2))
	names(e)[[2]] <- "a"
    will change the x= argument tag into a=.  In the past this produced
    odd error messages.

 o  The length function now tries to return a "sensible" value for all
    the built-in types.	 For example, symbols now have length 1.

 o  "update" should now work in both "lm" and "glm" models.

 o  The functions Re, Im, Mod, Arg and Conj will now accept real-valued
    arguments and return the obvious results.

 o  Minor graphics cleanup.

 o  A fix for convergence problems in glm from Thomas Lumley included.

 o  A new version of qt() should not take infinitely long to get an
    answer in the large degrees if freedom case.  The underlying code
    (Hill 1970, CACM) appears to be much faster and more accurate than
    Splus.

 o  A final Newton step has beed added to give a final "polish" to
    the quantiles produced by pnorm().	These should be close to full
    accuracy now.

 o  A bug in qbeta found by Martin Maechler has been fixed.  This should
    speed up quantile computation for the F and Beta distributions.

 o  rainbow(.) now allows "start > end" indexing the "color circle".
    topo.colors(n), terrain.colors(n), heat.colors(n) now also work for n=1,2.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Jul 23 12:21:47 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Jul 1997 07:21:47 -0400
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of "Wed, 23 Jul 1997 10:12:34 +1200 (NZST)"
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <wnc67u2ovxw.fsf@urn.math.sc.edu>



FYI:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version 0.50 alpha-1) is
    Ross> now (or will soon be) available from the following sites.

    Ross>     NORTH AMERICA:
    Ross> 	http://lib.stat.cmu.edu/R/Alpha

Exists at StatLib, compiles, runs most basic things (don't know about
bugs), and seems to work under Solaris 2.5.  (I'll try debian this
afternoon at home while babysitting).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Jul 23 12:25:47 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Jul 1997 07:25:47 -0400
Subject: R-alpha: New version of R for testing
In-Reply-To: Anthony Rossini's message of "23 Jul 1997 07:21:47 -0400"
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz> <wnc67u2ovxw.fsf@urn.math.sc.edu>
Message-ID: <wnc4t9movr8.fsf@urn.math.sc.edu>


>>>>> "Anthony" == Anthony Rossini <rossini@stat.sc.edu> writes:

    Anthony> FYI:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version 0.50 alpha-1) is
    Ross> now (or will soon be) available from the following sites.

    Ross> NORTH AMERICA: http://lib.stat.cmu.edu/R/Alpha

    Anthony> Exists at StatLib, compiles, runs most basic things
    Anthony> (don't know about bugs), and seems to work under Solaris
    Anthony> 2.5.  (I'll try debian this afternoon at home while
    Anthony> babysitting).

Also should've noted:

	ftp://lib.stat.cmu.edu/R/Alpha/R-0.50-a1.tgz

also works, for those who'd rather use FTP.

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 23 16:06:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Jul 1997 17:06:49 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <199707231506.RAA16235@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.50 alpha-1) is now (or will
> soon be) available from the following sites.

> ...

R + R + M,

Thanks for putting out the new version.  Finally, it's back to testing
(and porting) ...

I have one immediate bug report.

I think in R-0.50-a1/mansrc/latex/Rdoc.sty,

	\begin{list}{}\SetLmargin}%

in the code for the Header environment must be

	\begin{list}{}\SetLmargin\item}%

(Otherwise, make install-latex gives many errors.)  Martin?

A context diff is appended below.

Also, in the data subdir, quakes and sunspots should have mode 644.

-k

***********************
*** mansrc/latex/Rdoc.sty.orig	Wed Jul 23 17:03:46 1997
--- mansrc/latex/Rdoc.sty	Wed Jul 23 17:03:56 1997
***************
*** 28,34 ****
      \makebox[1in][r]{\tt #1} \\ \hline
    \end{tabular}
  \end{center}
! \begin{list}{}\SetLmargin}%
  {\end{list}}
  
  \newenvironment{Arguments}[0]{
--- 28,34 ----
      \makebox[1in][r]{\tt #1} \\ \hline
    \end{tabular}
  \end{center}
! \begin{list}{}\SetLmargin\item}%
  {\end{list}}
  
  \newenvironment{Arguments}[0]{
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Jul 23 22:53:45 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Jul 1997 23:53:45 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <x2vi21bfkm.fsf@bush.kubism.ku.dk>


In the minor department, I see that you've worked around the .orig
patch problem in src/library/base/Makefile. I know that I (and Martin)
suggested that particular way of doing it, i.e.

        @cat `ls funs/[a-z]* | sed '/CVS/d; /~$$/d; /\.orig$$/d; /\.bak$$/d'` \
         | sed '/^[     ]*$$/d'  > ../../../library/base
#                  ^^ = TAB + Space

-- but on 2nd thought, wouldn't it be more logical simply to change
the source file names to have suffix .R and use

	@cat *.R | sed ...

The current way has all sorts of gotchas built in. What if Netscape
dumps core when started in src/library/base/funs, e.g.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jul 24 21:45:07 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 24 Jul 1997 22:45:07 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <x2g1t4gox8.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> NEW FEATURES
> 
>  o  "expressions" are now implemented as a basic type rather than as
>     a class of object.  This change was made as move toward compatibility
>     with S and also to implement mathematical annotation in graphs.

Something looks wrong:

> expression(2+2)
expression(2 + 2)
> expression(2+2)[[1]]
expression(2 + 2)
> expression(2+2)[[1]][[1]]
expression(2 + 2)

- How the blazes is a poor soul supposed to get at the parse tree for
an expression? According to the docs, an expression is supposed to be
a list of calls, but obviously

> mode(expression(2+2)[[1]])
[1] "expression"

----------

Another piece of weirdness:

> t(table(0))
Error: dimnames: number of dimensions must equal number of names

# That one used to cause a segmentation fault (my bug report for it
# seems to have fallen off of the TASKS list - bug suicide?)

> t(as.matrix(table(0)))
     0
[1,] 1

# Looks OK now ... or is it? Watch:

> ?ls
Warning: invalid 'cutoff' for deparse, used default
#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        
        List Objects

             ls(name, pos=2, envir=sys.frame(sys.parent()),
                    all.names=FALSE, pattern)

Same thing happens if you omit the 2nd expression.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Arne Kovac <maak@stats.bris.ac.uk>  Fri Jul 25 04:51:25 1997
From: Arne Kovac <maak@stats.bris.ac.uk> (Arne Kovac)
Date: Fri, 25 Jul 1997 03:51:25 +0000 (GMT)
Subject: R-alpha: Treatment of seed
Message-ID: <Pine.LNX.3.95.970725033537.4471B-100000@ts1.bris.ac.uk>

There is a difference between R and S (or S-Plus, I'm not sure about
that) concerning the generation of random numbers.

If an error occurs during the execution of a function, the seed is
restored to its old value in S-Plus, but not in R. This feature of S-Plus
has just turned out to be very useful for me because I got an error
message during a small simulation for a certain choice of parameters.

Here is a silly example:

R> silly<-function()
+ {
+ tmp<-rnorm(5)
+ unknownfunction()
+ }
R> .Random.seed
[1]  8886  1153 10190
R> silly()
Error: couldn't find function "unknownfunction"
R> .Random.seed
[1]  9859  1963 19516


Splus> silly<-function()
+ {
+ tmp<-rnorm(5)
+ unknownfunction()
+ }
Splus> .Random.seed
 [1] 37 31 60  6 22  0 47 15  0 30 41  0
Splus> silly()
Error in silly(): couldn't find function "unknownfunction"
Dumped
Splus> .Random.seed
 [1] 37 31 60  6 22  0 47 15  0 30 41  0

Arne Kovac

-- 
Arne Kovac
School of Mathematics           Phone: +44 (0117) 942 7551
University of Bristol           A.Kovac@bristol.ac.uk    
University Walk                 http://www.stats.bris.ac.uk/~maak
Bristol, BS8 1TW, U.K.



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:54:56 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:54:56 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2vi21bfkm.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2vi21bfkm.fsf@bush.kubism.ku.dk>
Message-ID: <199707250854.KAA17771@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> In the minor department, I see that you've worked around the .orig
> patch problem in src/library/base/Makefile. I know that I (and Martin)
> suggested that particular way of doing it, i.e.

>         @cat `ls funs/[a-z]* | sed '/CVS/d; /~$$/d; /\.orig$$/d; /\.bak$$/d'` \
>          | sed '/^[     ]*$$/d'  > ../../../library/base
> #                  ^^ = TAB + Space

> -- but on 2nd thought, wouldn't it be more logical simply to change
> the source file names to have suffix .R and use

> 	@cat *.R | sed ...

> The current way has all sorts of gotchas built in. What if Netscape
> dumps core when started in src/library/base/funs, e.g.

I think this is a very good idea.  (Would also allow us to keep e.g. .S
sources when porting ...).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:56:10 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:56:10 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2g1t4gox8.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2g1t4gox8.fsf@bush.kubism.ku.dk>
Message-ID: <199707250856.KAA17775@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Another piece of weirdness:

>> t(table(0))
> Error: dimnames: number of dimensions must equal number of names

> # That one used to cause a segmentation fault (my bug report for it
> # seems to have fallen off of the TASKS list - bug suicide?)

>> t(as.matrix(table(0)))
>      0
> [1,] 1

> # Looks OK now ... or is it? Watch:

>> ?ls
> Warning: invalid 'cutoff' for deparse, used default
> #^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Indeed.  Was also on my bugs list, however with the

	t(table(1))

example.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:57:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:57:31 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.50 alpha-1) is now (or
> will soon be) available from the following sites.

> ...

Here are some comments on the new version.  Actually, quite a few ...
Hard to structure the whole thing nicely.

* My
	R> x <- 1:5
	R> dimnames(x)[1,2] <- NULL
segfault in dimnames mutation appears as Open in TASKS, and as Closed in
TASKS.OLD.

* In

R> D(expression(z * (log(z) /z)), "z")
(log(z)/z) + z * (1/z/z - log(z)/z^2)

the "1/z/z" is perhaps not optimal ...

* TASKS has

TASK:	"chisquare.test" problem
STATUS:	Open
FROM:	<venkat@biosta.mskcc.org>
	Can you change the explicit "cat" statement in the
	"chisquare.test" function which insists on writing to the
	screen even when the output is redirected to a variable? (Using
	"htest" class as in "t.test" function.)
	[ Should we switch to the library one. ]

As I already suggested, it would be nice to include all of ctest with
the distribution proper.

I have another question/suggestion re chisquare tests.  Several of my
functions in ctest now return "observed" and "expected" components.
Would it be a good idea to print these automatically (if they exist) in
print.htest?

* In src/unix/system.c, one `Rdata' should be `RData' (d -> D).

* No methods for as.data.frame exist!

* How can I return from browser()?
return() does not seem to work for me!

* TASKS has

TASK:	abline + coefficients
STATUS:	Closed
FROM:	<nobu@psrc.isac.co.jp>
	I found a little different behavior of R with S.
	at R-0.49:
	    > a
	    [1] 12 23 22 34 44 54 55 70 78
	    > plot(a)
	    > abline(lsfit(seq(1,len=length(a)), a))
	    Error: no applicable method for "coefficients"
	at S (from AT&T '92) result draw coefficient line without error.
	Then I think to need define a function as followed:
	    coefficients.default <- function(x) x$coef
	[ Default method already added for Doug Bates. ]

For me, this produces no error but abline does not produce any output
for me.  Can anyone check/confirm this?

See also

TASK:	"abline" incompatibility
STATUS:	Open
FROM:	<nobu@psrc.isac.co.jp>

and the 

* TASKS has

TASK:	ls.print
STATUS:	Open
FROM:	<maechler@stat.math.ethz.ch>
	Yes, I do confirm that the  Help page  (?NCOL) contains  '.COL'.
	Apply the following patch (to doc2ms) in  $RHOME/etc , and "all
	is well":

This seems to be fine now.  Martin?

* The ls.print problem reported by <VENKAT@biosta.mskcc.org> seems to be
gone now.  (Still labeled as Open in TASKS).

* Some of the "formula" problems in TASKS (<mikem@stat.cmu.edu>, 
<p.dalgaard@kubism.ku.dk> and <thomas@biostat.washington.edu> seem to be
gone now.

* Several of the graphics patches sent by
<kovac@figaro.stats.bris.ac.uk> (labeled Open in TASKS) seem to have
been taken care of already, in particular by integrating Martin's
patches.  Martin?

* As a remark on

TASK:	String length problems
STATUS:	Closed
FROM:	<maechler@stat.math.ethz.ch>
	This is not a  cat(.) but a  string storing/parsing problem:
	nchar("\n\n")  # gives  2  instead of 3
	[ Hmmm.  Was this typed to readline I wonder?  There it  ]
	[ seems that ^L must be escaped with ^V.  Using the ANSI ]
	[ \f will now produce a literal formfeed.  Indeed, using ]
	[ any of the ANSI C escapes will work.			 ]

note that under ESS pre 4.9,

	R> nchar("\n\n")

	[1] 2

(empty line in between!), so "^L" needs to be escaped here too.  (Same
for single quotes.)

* TASKS has

TASK:	Documentation Nit
STATUS:	Closed
FROM:	<Kurt.Hornik@ci.tuwien.ac.at>
	The documentation for ls/objects has
		ls(name, pos=2, envir=sys.frame(sys.parent()),
		   all.names=FALSE, pattern)
	but the code has
		ls <-
		function (name, pos = -1, envir = NULL,
			  all.files = FALSE, pattern)
	[ At one time these were equivalent.  Are they still? ]

However, the documentation is still unchanged!

* Re 

TASK:	"cat" problem
STATUS:	Closed
FROM:	<hornik@ci.tuwien.ac.at>
	* cat() is a bit inconsistent:

	...

	[ This is the way S does it! ]

Yes, I know that the current behavior is how S does it.  Still, there
are situations (as e.g. in the code for write.table) where I'd like to
have the different behavior.  Could we have an extra option to cat()
which suppresses a final newline even if sep contains a newline?

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

	R> x <- 1:5
	R> x
	[1] 1 2 3 4 5
	R> i <- c(F, T)
	R> x[i]
	Error: invalid subscript type
	R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

	R> x[-6]
	Error: subscript out of bounds

* There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

	R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
	R> f
	[1] a a b
	R> codes(f)
	[1] 1 1 2
	R> levels(f)
	[1] "a" "b" "c"

which gives e.g.

	R> tapply(rep(1, length(f)), f, sum)
	Error: names attribute must be the same length as the vector

One solution is to replace

	namelist[[i]] <- levels(index)

by

	namelist[[i]] <- unique(levels(index)[index])

but perhaps there is something smarter ...

* The `shortest program to produce a segfault' now gives:

	R> t(table(1))
	Error: dimnames: number of dimensions must equal number of names

(See Peter's mail for the consecutive deparse warnings ...)

* Please add

	family.lm <- function (object) { gaussian() }

to the base library.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 17:08:44 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 09:08:44 -0700 (PDT)
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970725090507.3738B-100000@zen>


There is a bug in image() which I think I reported before but which isn't
in TASKS.  The little rectangles it draws don't quite meet up in the
vertical direction if an image is drawn in x11() and then printed using
save.plot().

Looking at the code I can't see how this could possibly happen, and it
didn't happen in the interpreted version, but it might be worth putting in
an overlap of 1% or so to stop it. 

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 17:12:41 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 09:12:41 -0700 (PDT)
Subject: R-alpha: Re: R-beta: R 0.50 alpha
In-Reply-To: <199707251602.SAA13750@hypatia.math.ethz.ch>
Message-ID: <Pine.SUN.3.95.970725090903.3738C-100000@zen>

On 25 Jul 1997, Ennapadam Venkatraman wrote:

> Autoloading of libraries doesn't seem to work: 
This is strange.  The autoloading works for me (on Linux).

> 
> The coxph function the the library survival4 doesn't seem to work. It just
> crashes R. See the example below:

I get a seg fault on calls to some, but not all, compiled routines.  For
example, it happens with both the right-censored and counting process
fitting routines in survival4 and with the Cgee code, but not with ace,
avas, as.date  or the Kaplan-Meier fits in survival4.  I'm trying to find
out why.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 19:45:57 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 11:45:57 -0700 (PDT)
Subject: R-alpha: new version
In-Reply-To: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970725113626.3738E-100000@zen>

I have traced down the segfault that Venkat and I reported with C
routines. It is in S_alloc, which explains why only some routines cause
problems.

The problem is that size is declared but never set, resulting in
(xxgdb) print size
$10 = 1081754432

I don't know precisely what is happening here but my guess is that we
should have size=nelem*eltsize/sizeof(char). 

(Q: Is it necessary or even true that eltsize/sizeof(char) is always an
integer?) 

char *S_alloc(long nelem, int eltsize)
{
	unsigned int i, size;
	char *p = R_alloc(nelem, eltsize);
	for(i=0 ; i<size; i++)
		p[i] = 0;
	return p;
}


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 21:44:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 13:44:54 -0700 (PDT)
Subject: R-alpha: errors in batch mode
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970725134337.3738G-100000@zen>


Errors in batch mode no longer cause a stack imbalance but they do cause
execution to be halted.  Is this a feature?  It makes it harder to run
test code on new releases.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 21:54:28 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 13:54:28 -0700 (PDT)
Subject: R-alpha: help processing
In-Reply-To: <Pine.SUN.3.95.970725134337.3738G-100000@zen>
Message-ID: <Pine.SUN.3.95.970725134816.3738H-100000@zen>


On Solaris (and presumably other System V Unices), the default buffer
length for m4 is only 4096 characters. This limits the length of
ARGUMENTS() or VALUES() in help files. survfit.coxph overflows this limit. 

Adding the option -B 8192 to m4 in the etc/doc2* files fixes this.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 23:53:34 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 15:53:34 -0700 (PDT)
Subject: R-alpha: autoload
In-Reply-To: <Pine.SUN.3.95.970725113626.3738E-100000@zen>
Message-ID: <Pine.SUN.3.95.970725154855.3738I-100000@zen>


You can use the new delay() function to implement autoloading of libraries
or source files.  Functions autosource() and autoload() follow, together
with examples.  autoload("coxph","survival4") creates a promise to
evaluate autoloader("coxph","survival4"), which in turn calls
library(survival4), removes the promise, and evaluates "coxph" in the
newly created environment.  I was somewhat surprised that it worked.

	-thomas


 autosource<- function (name, file) 
{
        newcall <- paste("delay(autosourcer(\"", name, "\",\"", file, 
                "\"))", sep = "")
        assign(name, parse(text = newcall), env = .GlobalEnv)
}
 autosourcer <- function (name, file) 
{
        eval(parse(text = paste("source(\"", file, "\")", sep = "")), 
                .GlobalEnv)
        eval(as.name(name), sys.parent())
}



 autoload<- function (name, file) 
{
        newcall <- paste("delay(autoloader(\"", name, "\",\"", file, 
                "\"))", sep = "")
        assign(name, parse(text = newcall), env = .GlobalEnv)
}
 autoloader <- function (name, file) 
{
	name<-paste(name,"",sep="")
	rm(list=name,envir=sys.frame(sys.parent()),inherits=TRUE)
        eval(parse(text = paste("library(\"", file, "\")", sep = "")), 
                .GlobalEnv)
        eval(as.name(name), pos.to.env(2))
}


autosource("gee",system.file("library","gee"))
autoload("coxph","survival4")
y<-rnorm(100)
x<-rnorm(100)
g<-sort(rep(1:10,10))
tt<-1:10
cc<-rep(1,10)
xx<-rnorm(10)
substitute(gee)
substitute(coxph)
gee(y~x,g)
coxph(Surv(tt,cc)~xx)
q("no")




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Jul 26 00:46:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 16:46:03 -0700 (PDT)
Subject: R-alpha: .Libraries
In-Reply-To: <Pine.SUN.3.95.970725154855.3738I-100000@zen>
Message-ID: <Pine.SUN.3.95.970725164456.4219A-100000@zen>


The old way of keeping track of which libraries are loaded was with the
variable .Libraries.  It is still there, but it isn't updated when
libraries are detached.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Arne Kovac <maak@stats.bris.ac.uk>  Sun Jul 27 04:15:01 1997
From: Arne Kovac <maak@stats.bris.ac.uk> (Arne Kovac)
Date: Sun, 27 Jul 1997 03:15:01 +0000 (GMT)
Subject: Lost comments (was Re: R-alpha: New version of R for testing)
Message-ID: <Pine.LNX.3.95.970727031430.9276A-100000@ts1.bris.ac.uk>

On Wed, 23 Jul 1997, Ross Ihaka wrote:

>  o  Comments are handled better in functions.  The rule is that they
>     are shifted to just before their statements.  Comments after the
>     last statement of a function are lost.

More generally each comment between the last statement of a block and its
closing bracket is lost!! I wonder if this is really an advantage: I just
"uncommented" a line for test purposes to see some minutes later that I
had to retype it again. :-(

> dummy<-
+ function () 
+ {
+         for (i in 1:3) {
+                 print(1)
+                #print(2)
+         }
+         More()
+         Commands()
+ }
> dummy
function () 
{
        for (i in 1:3) {
                print(1)
        }
        More()
        Commands()
}

Arne Kovac

-- 
Arne Kovac
School of Mathematics           Phone: +44 (0117) 942 7551
University of Bristol           A.Kovac@bristol.ac.uk    
University Walk                 http://www.stats.bris.ac.uk/~maak
Bristol, BS8 1TW, U.K.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Jul 27 05:03:49 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 27 Jul 1997 16:03:49 +1200 (NZST)
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2g1t4gox8.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2g1t4gox8.fsf@bush.kubism.ku.dk>
Message-ID: <199707270403.QAA12146@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
 > 
 > > NEW FEATURES
 > > 
 > >  o  "expressions" are now implemented as a basic type rather than as
 > >     a class of object.  This change was made as move toward compatibility
 > >     with S and also to implement mathematical annotation in graphs.
 > 
 > Something looks wrong:
 > 
 > > expression(2+2)
 > expression(2 + 2)
 > > expression(2+2)[[1]]
 > expression(2 + 2)
 > > expression(2+2)[[1]][[1]]
 > expression(2 + 2)
 > 
 > - How the blazes is a poor soul supposed to get at the parse tree for
 > an expression? According to the docs, an expression is supposed to be
 > a list of calls, but obviously

Oops sorry.  Incomplete implementation.  I have a fix for this now as
will as fixes for mutations of expressions of the form

	> e <- expression(x+y)
	> e[[1]][[1]] <- as.name("f")

I hope to have patches and an "a2" release later this week.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Jul 27 05:19:47 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 27 Jul 1997 16:19:47 +1200 (NZST)
Subject: R-alpha: Mathematical Anotation in Plots
Message-ID: <199707270419.QAA12212@stat1.stat.auckland.ac.nz>

I forgot to mention that version 0.50 will do "greek" and "accents" in
plot labels.  The basic idea is that you should be able to replace any
character vector by an expression vector when doing plot annotation.

E.g.
	plot(rnorm(10),main=expression(hat(Theta)))

This produces a plot with a main title consisting of a capital Theta
with a "hat" on it.  The idea is to use R parse trees to represent
mathematical expressions.

Most things are as you would expect, with the following exceptions:

 o  ^ is used for superscripting and [] for subscripting so that
    x[i]^2 is the equivalent of the TeX x_i^2.

 o  you use over(x,y) for a fraction with x in the numerator and y
    in the denominator.

 o  the *" operator is used to denote juxtaposition. sometimes this
    makes sense - e.g. x*e^{x/lambda}, and sometimes it is a bit ugly
    e.g. "Distribution of "*hat(Theta). I haven't thought of a
    better solution (yet).

This is a very immature implementation, but you might enjoy playing
with it.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Jul 27 19:07:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jul 1997 20:07:06 +0200
Subject: R-alpha: Environment strangeness
Message-ID: <x290ys1i9h.fsf@bush.kubism.ku.dk>

Maybe I'm just not understanding things well enough (actually, that's
why I was fooling around with this in the first place), but:

> g
function () 
{
        e <- sys.frame(sys.parent())
        print(ls(envir = e))
        eval(print(b), e)
}
> f
function () 
{
        b <- 7913
        g()
}
> f()
[1] "b"
Error: Object "b" not found

Er? Is "b" in environment "e" or not?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: new functions
Message-ID: <199707281323.PAA18631@aragorn.ci.tuwien.ac.at>

The following two functions might be worth adding to the distribution:

**************************************************************
as.ordered <- function(x) { 
  if (is.ordered(x)) x else ordered(x)
}

data.class <- function(x) {
  if (length(cl <- class(x)))
    cl[1]
  else {
    l <- length(dim(x))
    if (l == 2)
      "matrix"
    else if (l > 0)
      "array"
    else
      mode(x)
  }
}
**************************************************************

Re data.class:  Couldn't we introduce a "matrix" and an "array" class
right away?  (I already asked this once).  The functions for creating or
coercing such objects could easily add the corresponding class
attribute ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R 0.50.a1 problems with lm/glm methods
Message-ID: <199707281323.PAA18639@aragorn.ci.tuwien.ac.at>

Thanks for fixing formula() and update().

Here are some open problems.

* effects:

** There is no help available for effects()

** The lm() help page has effects(lm.obj), but from the code it is clear
that the one-arg version cannot work.

Shouldn't it simply return z$effects?

** The two-arg version only works for factors (?) ... otherwise,
	z$model.frame[factors & pattern != 0]
gives an error.  Can someone explain to me what this is doing?

* plot:

There should be a plot.lm() function which reports that useful
diagnostic plots have not been implemented yet.

Perhaps we should do something like

	unimplemented <- function () {
		stop("Not implemented yet ... sorry.")
	}

	plot.lm <- function (...) unimplemented()
	plot.glm <- function (...) unimplemented()

and similarly for other stuff which is known to be missing?  (This would
also help improving the TASK handling :-))

* predict:

** There is no help available for predict()

** The one-arg version of predict.default() cannot work.  For objects
of class "lm", it should simply return the fitted values, right?

** The two-arg version of predict.default() cannot work because no
fitted object has a "covmat" component.  Anyway, shouldn't the general
form be something like
	predict(object, newdata, ...)
???

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 segfault
Message-ID: <199707281323.PAA18655@aragorn.ci.tuwien.ac.at>

Perhaps not the shortest way, but ...

**************************************************
R> x <- data.frame(x = 3:5, y = 5:7)
R> rownames(x) <- 1:3 
R> x
  x y
1 3 5
2 4 6
3 5 7
R> mode(x) <- "character"
Segmentation fault
**************************************************

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: R 0.50.a1 suggestion
Message-ID: <199707281323.PAA18629@aragorn.ci.tuwien.ac.at>

Could we introduce a library hierarchy in the `data' directory?  The
standard stuff would then go into `data/base', and if add-ons have their
own data (examples!), these would go into a corresponding subdir of
`data'.

Only three small changes would be necessary:

1. In `data', create a `base' subdir and move all data files there.

2. Replace `cmd/filename' by the version below:

*********************************************************************
#!/bin/sh

for file in $HOME/lib/R/$1/$2 \
            $RHOME/$1/$2 \
            $RHOME/$1/[^.]*/$2;
do
    if [ -r $file ]
    then
	echo $file
	break
    fi
done

if [ ! -r $file ]
then
    echo
fi
*********************************************************************

3. In src/library/LIBSETUP.in, add

*********************************************************************
        if test -d ${lib}/data
        then
                mkdir -p ../../data/${lib}
                cp ${lib}/data/* ../../data/${lib}
        fi
*********************************************************************

before the final `done'.

We've been using the above filename script for a very long time now,
without any problems ...

Please ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R-0.50.a1:  buglet in lsfit()
Message-ID: <199707281323.PAA18653@aragorn.ci.tuwien.ac.at>

I just discovered why
	abline(lsfit(x, y))
does not produce any output (as I mentioned on Friday).  In lsfit(), the
coefficients output component was incorrectly named "coef" and not
"coefficients", hence the coefficients method returned NULL ...

The patch below fixes the problem.

-k

************************************************************************
*** src/library/base/funs/lsfit.orig	Sat Jul 26 09:38:47 1997
--- src/library/base/funs/lsfit	Sat Jul 26 09:39:46 1997
*************** lsfit <- function(x, y, wt=NULL, interce
*** 100,106 ****
  	}
  	z$qr <- as.matrix(z$qr)
  	colnames(z$qr) <- xnames
! 	output <- list(coef=z$coefficients, residuals=resids)
  
  	# if X matrix was collinear, then the columns would have been
  	# pivoted hence xnames need to be corrected
--- 100,106 ----
  	}
  	z$qr <- as.matrix(z$qr)
  	colnames(z$qr) <- xnames
! 	output <- list(coefficients=z$coefficients, residuals=resids)
  
  	# if X matrix was collinear, then the columns would have been
  	# pivoted hence xnames need to be corrected
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:46 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:46 +0200
Subject: R-alpha: R 0.50.a1 S_alloc BUG, priority = URGENT
Message-ID: <199707281323.PAA18627@aragorn.ci.tuwien.ac.at>

The current version of S_alloc in src/main/memory.c is

char *S_alloc(long nelem, int eltsize)
{
	unsigned int i, size;
	char *p = R_alloc(nelem, eltsize);
	for(i=0 ; i<size; i++)
		p[i] = 0;
	return p;
}

which segfaults because `size' is not initialized.  I am not what the
right fix is, adding

	size = nelem * eltsize;

before the loop seems to work.

As an aside ... I think the seed* functions in S are called

	seed_in
	seed_out

and not seeds_in and seeds_out as currently in src/main/random.c.

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 unlist() problems
Message-ID: <199707281323.PAA18658@aragorn.ci.tuwien.ac.at>

Two things.

TASKS has

TASK:	Naming with Numeric Values and "unlist"
STATUS:	Open
FROM:	<hornik@ci.tuwien.ac.at>
	R> l <- list("11" = 1:5)
	R> l
	$11
	[1] 1 2 3 4 5
	R> unlist(l)
	111 112 113 114 115 
	  1   2   3   4   5 
	[ Bug or feature ? ]

This seems to be a feature (at least, SPLUS does the same), so please
close that task.

***

However, please add the following.

***********************************************************************
R> x <- rnorm(20)
R> y <- rnorm(20)
R> z <- lm(y ~ x)

R> typeof(z)
[1] "list"

R> unlist(z)
[[1]]
[1] 0.07030757

[[2]]
[1] -0.1790483

[[3]]
NULL

[[4]]
NULL

and many more ending in

[[152]]
NULL

[[153]]
NULL

[[154]]
NULL
***********************************************************************

This seems to be a BUG.  SPLUS gives

***********************************************************************
 coefficients.(Intercept)       coefficients.x         residuals.1 
 "-0.322342946956607"     "-0.351990317000716" "-1.05699395125055"
          residuals.2          residuals.3          residuals.4 
 "0.0685214529487529" "-0.825270557482947" "-0.309643367007542"
          residuals.5         residuals.6          residuals.7 
 "-0.970498865234358" "0.239072541069321" "-0.203418862242607"
           residuals.8          residuals.9        residuals.10 
 "-0.0279508657540235" "-0.546704750104556" "-1.41036201719063"
         residuals.11         residuals.12       residuals.13 
 "-0.177627379541701" "-0.159357852715235" "1.01771682562243"
***********************************************************************

etc etc

I haven't looked into the unlist code at all.  Here's another problem.

***********************************************************************
R> l <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
R> l
$a
$a[[1]]
[1] 1 2 3 4 5

$a[[2]]
[1] "A" "B" "C" "D" "E"


$b
[1] "Z"

$c
[1] NA

R> unlist(l)
INTERNAL ERROR: ans_nnames = 10    ans_length = 12
Error: incorrect names vector length
***********************************************************************

Hmm ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: R 0.50.a1 && gdb support
Message-ID: <199707281323.PAA18636@aragorn.ci.tuwien.ac.at>

Can we have gdb support?  (I don't use xxgdb.)

Perhaps in the wrapper one could add something like

*************************************************************
if [ "$1" = "-gdb" ]
then
	shift
	DEBUGGER=gdb
fi
*************************************************************

and at the end have

*************************************************************
if [ "$DEBUGGER" = "gdb" ]
then
    exec gdb $RHOME/bin/R.binary $*
else    
    exec $DEBUGGER $RHOME/bin/R.binary -v 4 $*
fi    
*************************************************************

Or is there a way to pass command line options for the program through
gdb?

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 problem
Message-ID: <199707281323.PAA18657@aragorn.ci.tuwien.ac.at>

Here's something really strange.

********************************************************
R> x <- 1:5
R> x
[1] 1 2 3 4 5

R> test1
function (x) 
{
        structure(x, call = sys.call())
}
R> test1(x)
[1] 1 2 3 4 5
attr(,"call")
test1(x)

R> test2
function (x) 
{
        attr(x, "call") <- sys.call()
        x
}
R> test2(x)
Error: stack overflow
********************************************************

Using the attr() form results in an endless loop ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R 0.50.a1:  small patches for graphics and image demo
Message-ID: <199707281323.PAA18638@aragorn.ci.tuwien.ac.at>

Applying the following patches closes the following task (part 1 was
already taken care of).

TASK:   New Problems
STATUS: Open
FROM:   <Kurt.Hornik@ci.tuwien.ac.at>
        New minor remarks:
        * The documentation for `image' still has the old order z, x, y.
        * Perhaps one should add `par(ask = T)' in the image demo?
        * Perhaps one should save the original value of par() at the
	beginning of the graphics demo, and restore that at its end
	(s.t. typically asking is turned off again).

Thanks,
-k

************************************************************************
*** demos/graphics/graphics.orig	Sat Jul 26 10:40:03 1997
--- demos/graphics/graphics	Sat Jul 26 10:37:50 1997
***************
*** 1,5 ****
  ###-*- R -*-
! par(ask = interactive() && .Device == "X11")	# For source
  
  # Here is some code which illustrates some of the differences between
  # R and S graphics capabilities.  Note that colors are generally specified
--- 1,6 ----
  ###-*- R -*-
! 
! opar <- par(ask = interactive() && .Device == "X11")	# For source
  
  # Here is some code which illustrates some of the differences between
  # R and S graphics capabilities.  Note that colors are generally specified
*************** data("volcano")
*** 115,121 ****
  x <- 10*1:nrow(volcano)
  y <- 10*1:ncol(volcano)
  l <- pretty(range(volcano), 10)
! opar <- par(bg="lightcyan")
  pin <- par("pin")
  xdelta <- diff(range(x))
  ydelta <- diff(range(y))
--- 116,122 ----
  x <- 10*1:nrow(volcano)
  y <- 10*1:ncol(volcano)
  l <- pretty(range(volcano), 10)
! par(bg="lightcyan")
  pin <- par("pin")
  xdelta <- diff(range(x))
  ydelta <- diff(range(y))
*************** mtext("10 Meter Contour Spacing", side=3
*** 141,144 ****
--- 142,146 ----
  par(bg="cornsilk")
  data(quakes)
  coplot(long~lat|depth, data=quakes, pch=21, bg="green3")
+ 
  par(opar)
*** demos/graphics/image.orig	Sat Jul 26 10:40:07 1997
--- demos/graphics/image	Sat Jul 26 10:41:46 1997
***************
*** 1,4 ****
--- 1,7 ----
  #### -*- R -*-
+ 
+ opar <- par(ask = interactive() && .Device == "X11") # For source
+ 
  data(volcano)
  x <- 10*(1:nrow(volcano))
  y <- 10*(1:ncol(volcano))
*************** axis(2, at=seq(100, 600, by=100))
*** 30,32 ****
--- 33,36 ----
  box()
  title(main="Maunga Whau Volcano", font.main=4)
  
+ par(opar)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:46 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:46 +0200
Subject: R-alpha: R 0.50.a1:  patch for NChisquare documentation
Message-ID: <199707281323.PAA18624@aragorn.ci.tuwien.ac.at>

The patch below fixes the NChisquare documentation problem that I've
been mentioning for some time now.

NOTE:  There is one DEQN where the LaTeX part contains real LaTeX code,
because I did not see how to get a sum sign (and a roman math font)
otherwise.  Seems to work, though ... MARTIN?

-k

**********************************************************************
*** src/library/base/man/NChisquare.orig	Sat Jul 26 10:50:54 1997
--- src/library/base/man/NChisquare	Sat Jul 26 11:26:23 1997
***************
*** 1,26 ****
  TITLE(NChisquare @@ The Non-Central Chi-Square Distribution)
  USAGE(
! dnchisq(x, df)
! pnchisq(x, df)
! qnchisq(x, df)
! rnchisq(x, df)
  )
  ALIAS(dnchisq)
  ALIAS(pnchisq)
  ALIAS(qnchisq)
  ALIAS(rnchisq)
  DESCRIPTION(
! These functions provide information about the non-central
! chi-square distribution with LANG(df) degrees of freedom.
! LANG(dnchisq) gives the density, LANG(pnchisq) gives the
! distribution function LANG(qnchisq) gives the quantile
  function and LANG(rnchisq) generates random deviates.
  PARA
! The non-central chi-square distribution with EQN(n)
! degrees-of-freedom has density
! DEQN(f(x) =
! OVER(1 @@ SUP(2@@n/2) greekGamma (n/2))
! SUP(x@@n/2-1) SUP(e@@-x/2)
! @@f(x) = 1 / (2^(n/2) Gamma(n/2))  x^(n/2-1) e^-x/2)
  for EQN(x GE 0).
  )
--- 1,28 ----
  TITLE(NChisquare @@ The Non-Central Chi-Square Distribution)
  USAGE(
! dnchisq(x, df, lambda)
! pnchisq(x, df, lambda)
! qnchisq(x, df, lambda)
! rnchisq(x, df, lambda)
  )
  ALIAS(dnchisq)
  ALIAS(pnchisq)
  ALIAS(qnchisq)
  ALIAS(rnchisq)
  DESCRIPTION(
! These functions provide information about the non-central chi-square
! distribution with LANG(df) degrees of freedom and non-centrality
! parameter LANG(lambda).  LANG(dnchisq) gives the density, LANG(pnchisq)
! gives the distribution function LANG(qnchisq) gives the quantile
  function and LANG(rnchisq) generates random deviates.
  PARA
! The non-central chi-square distribution with EQN(df) degrees of freedom
! and non-centrality parameter EQN(greeklambda) has density
! DEQN(f(x) = SUP(e @@ -\lambda / 2)
!   \sum_{r=0}^\infty \frac{\lambda^r}{2^r r!} \mathrm{pchisq}(x, df + 2r) 
!   @@
!   f(x) = exp(-lambda/2) SUM_{r=0}^infty (lambda^r / 2^r r!)
!   pchisq(x, df + 2r)
! )
  for EQN(x GE 0).
  )
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Jul 28 20:24:45 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 28 Jul 1997 21:24:45 +0200
Subject: R-alpha: R 0.50.a1 problem
In-Reply-To: Kurt Hornik's message of Mon, 28 Jul 1997 15:23:49 +0200
References: <199707281323.PAA18657@aragorn.ci.tuwien.ac.at>
Message-ID: <x2bu3nj7ya.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> R> test2
> function (x) 
> {
>         attr(x, "call") <- sys.call()
>         x
> }
> R> test2(x)
> Error: stack overflow
> ********************************************************
> 
> Using the attr() form results in an endless loop ...

Sounds familiar. The "assignment causes evaluation effect". Hey,
here's an amusing variant:

> fff<-function(){cll<-substitute(ls());print(cll);x<-1;
attr(x,"junk")<-cll;x}
> fff
function () 
{
        cll <- substitute(ls())
        print(cll)
        x <- 1
        attr(x, "junk") <- cll
        x
}
> fff()
ls()
[1] 1
attr(,"junk")
[1] "*tmp*" "cll"   "x"    
> fff
function () 
{
        cll <- substitute(ls())
        print(cll)
        x <- structure(1, junk = c("*tmp*", "cll", "x"))
        attr(x, "junk") <- cll
        x
}
> 

...I know that R is a functional programming language and that
functions can write and modify other functions, but this seems to be
overdoing it a bit, donchathinkso <evil grin>? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Tue Jul 29 10:28:50 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
Subject: R-alpha: Bugs in R-0.50-a1.
Message-ID: <9707290928.AA07210@alpha.luc.ac.be>

Problems in R but not in S:
---------------------------

1) 'unlist' seems to have several other problems than the ones
reported up to now. For instance, 'unlist' can be used on almost any
object in S without much trouble. Eg.:
	S> unlist(c(2))
	[1] 2
	S>
	---
	R> unlist(c(2))
	Segmentation fault (core dumped)
This occurs in R-0.49 and in R-0.50-a1.

2) Problem with the parser: When a function contains a condition
between brackets the closing bracket must be adjacent to the last item
in R but not in S. Here is an example:
	S> new <- function (x,y,z,k) {
	S+ message <- list(x,y,a=if(z) k
	S+ )
	S+ message
	S+ }
	S>
	---
	R> new <- function (x,y,z,k) {
	R+ message <- list(x,y,a=if(z) k
	R+ )
	)
	^
	Error: syntax error
	R> 
This occurs in R-0.49 and in R-0.50-a1.


Problems in R:
--------------

1) The 'R Graphics' window does not have any X class or resource and
therefore cannot be given a default size or geometry. Would it be
possible to give the graphic window a class name so that the size
could be specified in the '.Xdefaults' file?

2) It does not appear to be possible to specify the 'xlim' when using
boxplot. This might also be the case in S but would be nice to
have. Eg., when plotting several boxplots together, lets say 7. One
would generally plot 4 first and then 3. Hence, if they are fitted on
the same page the boxplots of the first line will be wider than on the
second...

3) Some problems occur when using the help. Eg.,
R> ?"+"
sorry, no help for "Arithmetic".
R>
This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
any item contained in a help file starting with a capital letter.

4) The option 'right' when using print gives an error. In S,
'print.default' calls 'print.structure' and then 'print.matrix'. This
last one allows this option. Can anything be done as 'print.default'
is internal in R?

5) The control-c still does not work on R-0.50-a1 under certain
variants of Linux. What is the easiest way to fix this?

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jul 29 12:31:39 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Jul 1997 13:31:39 +0200
Subject: R-alpha: Bugs in R-0.50-a1.
In-Reply-To: Patrick Lindsey's message of Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
References: <9707290928.AA07210@alpha.luc.ac.be>
Message-ID: <x2u3hegkmc.fsf@bush.kubism.ku.dk>

Patrick Lindsey <plindsey@luc.ac.be> writes:

> 5) The control-c still does not work on R-0.50-a1 under certain
> variants of Linux. What is the easiest way to fix this?

Upgrade the readline library to v.2.1 and relink (for some reason that
I never figured out, this installs as libreadline.so.3.0, unless you
specifically tell it otherwise), RedHat has an RPM package in the
contrib section. Debians package is the newer one.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Ben Bolker <ben@eno.Princeton.EDU>  Tue Jul 29 16:58:08 1997
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 29 Jul 1997 11:58:08 -0400 (EDT)
Subject: R-alpha: more graphics: lwd, persistent lty settings
Message-ID: <Pine.SUN.3.95.970729114304.26114A-100000@paca>


  [ SunOS 4.1.3, R-0.50-a1; I'm mostly very pleased, I haven't been
pounding on it as hard as some folks have ]
 
   par(lwd) seems to be a bit of a stub right now; I wouldn't necessarily
expect it to do anything in the x11() driver (nor would I know how to fix
it), but it would be nice in the postscript driver (e.g. for thick lines
for things to be made into slides).
   I will try to work on this, but I wouldn't mind if someone got there
before me.

  Also: the effects of setting lty are sometimes unnecessarily persistent
-- for example in the example below the box around the legend is drawn in
line type 2 (dashed) -- I would think that the GSavePars/GRestorePars
calls at the beginning and end of abline (in plot.c) ought to do the job,
but I haven't had time to go through it in detail ... 

x _ (1:100)/10
plot(x,sin(x))
abline(h=0,lty=2)
legend(0,-0.1,"a",pch=1)


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Jul 29 21:45:10 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Jul 1997 08:45:10 +1200 (NZST)
Subject: R-alpha: stat.auckland.ac.nz
Message-ID: <199707292045.IAA07780@stat1.stat.auckland.ac.nz>

The R anon-ftp site at stat.auckland.ac.nz is currently out of action.
We are in the throws of upgrading from a tired old SparcServer 10 to a
new Sun Enterprise Server.  Normality should be restored within the
next couple of days.

The good news is that we can configure and compile R in rather less
than a minute.  This should help the development process.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Jul 30 00:58:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Jul 1997 11:58:14 +1200 (NZST)
Subject: R-alpha: R-beta: RPM package for R
In-Reply-To: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
References: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
Message-ID: <199707292358.LAA18350@stat1.stat.auckland.ac.nz>

Martyn Plummer writes in r-announce:
 > A precompiled "RPM" binary of R-0.50.a1 is now available on CRAN for
 > installation on Linux systems which use the RedHat Package
 > Manager

Before we get to may versions floating about ... 

I had intended that these "a1", "a2" ... releases be hacker releases
which will be followed by a R-0.50.stable release when the (worst)
problems are sorted out.  Thats why I announced to "r-devel" rather
than "r-announce".

(Note this is information rather than any kind of policy statement,
you are of course free to do whatever you like with R)
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Wed Jul 30 02:29:54 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 30 Jul 1997 13:29:54 +1200 (NZST)
Subject: R-alpha: Environment strangeness
Message-ID: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>

Peter Dalgaard asked about environments,

----- Begin Included Message -----

 
Maybe I'm just not understanding things well enough (actually, that's
why I was fooling around with this in the first place), but:

> g
function()
{
	e<-sys.frame(sys.parent())
	print(ls(envir=e))
	eval(print(b), e)
}
> f
function () 
{
        b <- 7913
        g()
}
> f()
[1] "b"
Error: Object "b" not found

Er? Is "b" in environment "e" or not?

 
----- End Included Message -----

Ross and I have been back and forth on this one a few times already;
it's probably a faq (Kurt);
  eval evaluates an expression in an environment; 
 consider the two cases below

1)
  a<-expression(x+y)
  eval(a,e1)

2)
  eval(x+y,e1)

 Now, there is no way these can both work. It seems like the first option
is to be preferred because the second can easily be achieved by wrapping
an expression around the x+y (with the first option as the default). Used in
this manner expression is a quoting mechanism.
 eval(expression(x+y),e1) does what you want.
 If 2) is the default mechanism then there is no easy way to get 1) to work
since what we want there is the value bound to a in the environment that
eval is called from not the value of a in e1.
  So Peter's example with a small change,
g<-function() {
	e<-sys.frame(sys.parent())
	print(ls(envir=e))
	eval(expression(print(b),e)
}

will work as desired.

robert
   
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Ben Bolker <ben@eno.Princeton.EDU>  Wed Jul 30 02:54:34 1997
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 29 Jul 1997 21:54:34 -0400 (EDT)
Subject: R-alpha: line types
Message-ID: <Pine.SUN.3.95.970729161448.26747A-100000@paca>


  Responding to my own post, after some hacking:

  To fix the behavior of the following test code (the rect()s inherit the
lty set by the previous abline())--

x _ (1:100)/10
plot(x,sin(x))
abline(h=0,lty=2,col="red")
rect(1,0,2,0.5)
abline(v=2)
rect(3,0,4,0.5)

Here are some diffs (now all I have to do is wade through and get lwd
working properly ...)

*** devX11.c.orig	Tue Jul 29 16:44:19 1997
--- devX11.c	Tue Jul 29 16:57:55 1997
***************
*** 671,676 ****
--- 671,677 ----
  	}
  	if (fg != NA_INTEGER) {
  		SetColor(fg);
+ 		SetLinetype(GP->lty);
  		XDrawRectangle(display, window, wgc, (int)x0, (int)y0,
  			(int)x1 - (int)x0, (int)y1 - (int)y0);
  	}
*** devPS.c.orig	Sun Jul  6 21:29:03 1997
--- devPS.c	Tue Jul 29 17:01:05 1997
***************
*** 433,438 ****
--- 433,439 ----
  	}
  	if(fg != NA_INTEGER) {
  		SetColor(fg);
+ 		SetLinetype(GP->lty);
  		PostScriptOpenRectangle(psfp, x0, y0, x1, y1);
  	}
  }
*** plot.c.orig	Tue Jul 29 16:43:34 1997
--- plot.c	Tue Jul 29 16:51:02 1997
***************
*** 875,880 ****
--- 875,883 ----
  
  	GSavePars();
  
+ 	if(nlty && INTEGER(lty)[i % nlty] != NA_INTEGER) GP->lty = INTEGER(lty)[i % nlty];
+ 	else GP->lty = DP->lty;
+ 
  	xl = REAL(sxl);
  	xr = REAL(sxr);
  	yb = REAL(syb);


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Jul 30 13:12:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Jul 1997 14:12:40 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: Robert Gentleman's message of Wed, 30 Jul 1997 13:29:54 +1200 (NZST)
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
Message-ID: <x2204gg2mf.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> Ross and I have been back and forth on this one a few times already;
> it's probably a faq (Kurt);
                ^^^^^

This belongs on the *manual page*. I suggest something along these
lines:

NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
get values of LANG(x) and LANG(y) looked up in the environment
LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
LANG(expr) is usually a simple variable ITALIC(containing) an
expression to evaluate or a LANG(substitute(...)) call
ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
passed to the evaluator.
)


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Wed Jul 30 15:50:05 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 30 Jul 1997 10:50:05 -0400 (EDT)
Subject: R-alpha: more on line types
Message-ID: <Pine.SUN.3.95.970730101356.8353A-100000@eno.Princeton.EDU>


   forgot to fix psx11.c and devPicTeX.c while I was at it (devPicTeX.c
doesn't seem to change the color).  Should psx11.c be devpsx11.c?  Diffs:

*** psx11.c.orig	Wed Jul 30 10:08:48 1997
--- psx11.c	Wed Jul 30 10:09:10 1997
***************
*** 293,298 ****
--- 293,299 ----
  	}
  	if(fg != NA_INTEGER) {
  		psx11_SetColor(fg);
+ 		psx11_SetLinetype(GP->lty);
  		PostScriptOpenRectangle(psfp,
  			xoffset + xscale * x0,
  			yoffset + yscale * y0,
*** devPicTeX.c.orig	Wed Jul 30 10:16:33 1997
--- devPicTeX.c	Wed Jul 30 10:11:24 1997
***************
*** 446,451 ****
--- 446,452 ----
  /* Possibly Filled Rectangle */
  static void PicTeX_Rect(double x0, double y0, double x1, double y1, int bg, int fg)
  {
+         SetLinetype(GP->lty);
  	PicTeX_MoveTo(x0, y0);
  	PicTeX_LineTo(x1, y0);
  	PicTeX_LineTo(x1, y1);

   A less trivial question about setting line widths: in X, the same call
(XSetLineAttributes) sets both line type and line width.  In PostScript
there are two separate calls.

  The following quick hack to SetLinetype() appears to work pretty well
for X11, although there may be a better way to do it (logically,
SetLinetype ought to take both lty and lwd as arguments, or there should
be a separate SetLinewidth -- however, if there were two functions each
would have to look at least briefly at the current settings so as not to
screw them up):

  Before doing this in PostScript (where the width and type are set in
separate calls), I'd like advice.
  Also, is there a particular reason that default line width in PostScript
is 0.75 and not 1.0?

*** devX11.c.orig	Tue Jul 29 16:44:19 1997
--- devX11.c	Wed Jul 30 10:21:43 1997
***************
*** 389,395 ****
  
  	if(newlty != lty) {
  		if(newlty == 0) {
! 			XSetLineAttributes(display, wgc, 1, LineSolid, CapRound, JoinRound);
  			lty = newlty;
  		}
  		else {
--- 389,395 ----
  
  	if(newlty != lty) {
  		if(newlty == 0) {
! 			XSetLineAttributes(display, wgc, GP->lwd, LineSolid, CapRound, JoinRound);
  			lty = newlty;
  		}
  		else {
***************
*** 400,406 ****
  				newlty = newlty>>4;
  			}
  			XSetDashes(display, wgc, 0, dashlist, ndash);
! 			XSetLineAttributes(display, wgc, 1,
  				LineOnOffDash, CapButt, JoinRound);
  		}
  	}
--- 400,406 ----
  				newlty = newlty>>4;
  			}
  			XSetDashes(display, wgc, 0, dashlist, ndash);
! 			XSetLineAttributes(display, wgc, GP->lwd,
  				LineOnOffDash, CapButt, JoinRound);
  		}
  	}





Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Thu Jul 31 08:34:02 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Thu, 31 Jul 1997 09:34:02 +0200 (MET DST)
Subject: R-alpha: More problems with R0.50.a1
Message-ID: <9707310734.AA26662@alpha.luc.ac.be>

More problems...

1) when -lf2c is used for linking as in the standard Makefile in
src/main, it does not include the library as shown by ldd on my
slackware linux 2.0.29 but does on RedHat linux 2.0.27. But with
slackware adding the -L/usr/lib just before -lf2c does include it. On
the other hand readline in the same directory is included both times.
(We need the f2c library for complex numbers in Richard Jones' carma
for kalman filtering which we are dynamically loading.)

2) matrix(2,nrow=3,ncol=3)[!is.na(matrix(2,nrow=3,ncol=3))]
gives a vector of nine 2's
if the matrix has row and column names, the vector has the 3 column
names completed with six NA names.

3) Robert's example on 'Environment strangeness' has 2 errors:
	- missing bracket on the second last line of his g function.
	- should not try to print before b has been retrieved from the
	  appropriate environment (on same line as above).

4) why does the following function yield errors with R scoping rules?
> p <- function () {
	b <- 123
	s()
}
> s <- function () {
	print(b)
}
> p()
Error: Object "b" not found.

5) getting the call line and saving it as an attribute:
This works:
> f <- function () {
	x <- match.call()
	print(x)
}
This recurses in an infinite loop, recalling the 'f' function each
time the "attr" line is stored in the "call" attribute of x.
> f <- function () {
	x <- 2
	print(x)
	attr(x,"call") <- match.call()
	print(attributes(x))
}

6) The following gives a error. How can this be solved?
> "[<-.newtype" <- function(...) {
	NextMethod("[<-")
}
> f <- function () {
	idx <- 2
	tmp <- matrix(3,ncol=4,nrow=4)
	class(tmp) <- "newtype"
	tmp[idx,] <- matrix(1,ncol=4,nrow=4)[2,]
}
> f()
Error: Object "idx" not found.

This did not work in R0.49 either, but does work in S..
(In R the name of the variable "idx" is passed to "[<-.newtype" in the
row and col local variable as in S it is the contents of "idx" which
are passed through.)
I had solved this for R0.49 by adding the line:
	idx <- eval(idx,sys.frame(sys.parent()))
But this does not work any more in R0.50.a1...
So I modified the line to:
        idx <- eval(expression(idx),sys.frame(sys.parent()))
but this did not change anything.
It looks as if the environments were not always retrieved properly and
that R scoping rules are not always followed. I thought that R would
be able to find any variable defined in a previous environment so that
they did not have to be passed from function to function as in S.

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 31 16:59:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 31 Jul 1997 17:59:00 +0200
Subject: R-alpha: Re: R-beta: Questions
In-Reply-To: <m0wqEgL-000FqEC@Tedistan.annex.umist.ac.uk>
 (Ted.Harding@nessie.mcc.ac.uk)
Message-ID: <199707311559.RAA25751@sophie.ethz.ch>


		(CC'ed to R-devel instead of R-help)

>>>>> "Ted" == Ted Harding <Ted.Harding@nessie.mcc.ac.uk> writes
			(on Jul 21, 1997):

    Ted> Q1: Is anyone collecting suggestions for amendments to the
    Ted> documentation (online "help" and R-Notes)? --

    Ted> Q2: (Supersedes Q1 to am unknown extent) -- or are there moves to
    Ted> bring R more in line with the documentation?

Yes to both.
Besides R & R (who collect and amend and ...),
I've also chosen to emphasize working on the on line help.
The 'R-devel' mailing list is also used to report / fix  documentation
glitches... 

You may want to have a look at the new alpha (pre)release of R 
which shows quite some improvements to documentation..
A new
	make tests
runs all the online "help" Examples

If you'd send  diffs of    src/library/base/man/... files to   R-devel,
chances are even higher
that the improvements will make it to subsequent releases..

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Jul 31 21:38:12 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 1 Aug 1997 08:38:12 +1200 (NZST)
Subject: R-alpha: More problems with R0.50.a1
Message-ID: <199707312038.IAA19799@stat1.stat.auckland.ac.nz>

Patrick,

   I can easily respond to some of the questions.
   
   2) That's the same thing S does (they don't propagate names though). There
    are many instances where coercion or subsetting causes a loss of
    dimensioning information. In this case you are asking for a subset of the
    values in x; you haven't specified a format for them so they come back as
    a vector.
   
   3) Sorry about that; I was working without cut and paste as we transferred
   to the new machine.
   
   4) b is defined in the environment created for the evaluation of p.
   The function s has as its parent the global environment (that's the
   environment that was active when s was defined). There is no value for
   b stored there hence s cannot find it. What you seem to want here
   is really dynamic scope rather than lexical scope. Dynamic scope was
   used in the early Lisp implementations but was quickly seen to be a
   mistake and I don't believe that it is used by any active languages
   (apart from people trying to fake it in Splus). 
   It's reasonably easy to tweak R to have this rather than lexical scope
   but the down side is pretty large. Imagine a more complicated system
   with a much deeper call stack; now s will grab the definition of b that
   is closest to it in the call stack; this may not be the one you want and
   it can take forever to find the problem.
   
   5) I think Ross has fixed this. At least both of the functions you gave
   run without error in the version I've got now. We will probably put up
   some patches pretty soon.
   
   6) This will take some work. I'm still unconvinced that any of this Method
   stuff deserves any effort whatsoever. It has to be a better idea to write
   a real object system rather than try to constantly patch this thing. But
   I will spend some time digging around. To see where idx has disappeared.
   
  
   robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul  1 14:43:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 1 Jul 1997 15:43:20 +0200
Subject: R-alpha: sd2rd v0.1-3
Message-ID: <199707011343.PAA04807@aragorn.ci.tuwien.ac.at>

Thanks to Martin, there is another update of the S doc -> R doc script.
It now correctly maps .SE into SECTION.
-k

***********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-3";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

$opt_x = 0;
use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &section(0, "SECTION(Side Effects@@"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &section(0, "SECTION($word[1]@@");
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 17:33:12 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 12:33:12 -0400 (EDT)
Subject: R-alpha: bug in eigen()
Message-ID: <Pine.SUN.3.95.970701122527.2221A-100000@paca>


  I don't have time to track this down right now -- if no-one does it in
the next few days before I finish the current piece of work I will try to
find it myself.  
  R gets the wrong answer for the eigensystem of a (particular) 4x4
matrix (SunOS 4.1.4).

Running these commands:

x _ matrix(
     c(-10,   0    ,0     ,0,
         0  ,-0.3  ,0     ,0,
         1  , 0.03 ,-0.594,0.0020,
         1.2, 0.036,0.0792,-0.0176),byrow=T,ncol=4)
eigen(x)


R gives:

$values
[1] -10.2425681  -0.5515844  -0.3023825   0.1849350
 
$vectors
              [,1]        [,2]         [,3]      [,4]
[1,] -0.9881475178  0.06506841 -0.008135724 0.1387962
[2,] -0.0007232329 -0.07331061  0.993467182 0.0874528
[3,]  0.1014706558  0.95415639  0.046029849 0.2777959
[4,]  0.1151853550 -0.28280247 -0.104105822 0.9465290
 
S-PLUS 3.1 gives:

$values:
[1] -10.00000000  -0.59427468  -0.30000000  -0.01732532
 
$vectors:
           [,1]        [,2]       [,3]         [,4] 
[1,]  1.0000000  0.00000000  0.0000000  0.000000000
[2,]  0.0000000  0.00000000  1.0000000  0.000000000
[3,] -0.1062897 -0.06249770  0.1009810 -0.003466636
[4,] -0.1193683  0.00858338 -0.1557992 -0.999560734


Note that the structure of the matrix actually gives us (-10.0) and (-0.3)
for free, so the S-PLUS answer looks right.

  Even worse:

eigen(x[3:4,3:4])

  gives (R)

$values
[1] -0.604684392 -0.006915608
 
$vectors
           [,1]      [,2]
[1,]  0.9910228 0.1336929
[2,] -0.1336929 0.9910228


 (S-PLUS)
$values:
[1] -0.59427468 -0.01732532
 
$vectors:
            [,1]         [,2] 
[1,] -0.06249770 -0.003466636
[2,]  0.00858338 -0.999560734

  so it's not just some funky pivoting problem.

  Or am I doing something *really* dumb?

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 18:09:25 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 13:09:25 -0400 (EDT)
Subject: R-alpha: eigen() bug
Message-ID: <Pine.SUN.3.95.970701130757.2597A-100000@paca>


  It looks like there may be a mismatch between the library function and
the C code ... the help file for eigen() says that the function checks to
see if the matrix is symmetrix first, and passes it off to different
routines in different cases.  It looks like eigen() doesn't actually
bother to do any checking, and just *assumes* it's symmetric ...

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul  1 18:24:22 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 1 Jul 1997 19:24:22 +0200
Subject: R-alpha: eigen() bug -- fixed in 0.50 (soon...)
In-Reply-To: <Pine.SUN.3.95.970701130757.2597A-100000@paca> (message from Ben
 Bolker on Tue, 1 Jul 1997 13:09:25 -0400 (EDT))
Message-ID: <199707011724.TAA02001@sophie.ethz.ch>

I  have learned that the bug is fixed in the next release ...
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 18:33:29 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 13:33:29 -0400 (EDT)
Subject: R-alpha: bugs generally
Message-ID: <Pine.SUN.3.95.970701132909.2633B-100000@paca>


  In the future (say after release 0.5 goes out), would it be feasible to
start a publically-accessible list of bug reports, known bugs, and
patches?  (Something like the current TASKS list, but maybe a little bit
more dynamic?)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jul  2 22:11:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 2 Jul 1997 14:11:54 -0700 (PDT)
Subject: R-alpha: R-beta: image()
In-Reply-To: <199707011343.PAA04807@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970702141038.2207A-100000@zen>


Using image() produces plots that look fine on the x11() device and in
ghostview at screen resolution but contain lots of horizontal white lines
at higher resolution. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul  3 06:27:42 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 3 Jul 1997 07:27:42 +0200
Subject: R-alpha: bugs generally
In-Reply-To: <Pine.SUN.3.95.970701132909.2633B-100000@paca>
References: <Pine.SUN.3.95.970701132909.2633B-100000@paca>
Message-ID: <199707030527.HAA05571@aragorn.ci.tuwien.ac.at>

>>>>> Ben Bolker writes:

>   In the future (say after release 0.5 goes out), would it be feasible
> to start a publically-accessible list of bug reports, known bugs, and
> patches?  (Something like the current TASKS list, but maybe a little
> bit more dynamic?)

There has recently been some discussion regarding widening the official
developer base and the amount of people who can apply patches to the
source tree.  I think that as soon as that is worked out, we can also
start thinking about a bug management system.  What I have in mind is
something akin to the debian-bugs system.

But clearly, without a `patch management system' we cannot do that.

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  3 16:54:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Jul 1997 17:54:51 +0200
Subject: R-alpha: plot(  pch = <character> ) is slow.. -- why ? --
Message-ID: <199707031554.RAA04752@sophie.ethz.ch>

Can anyone explain this to us :


> unlist(version)
              platform                   arch                     os 
"sparc-sun-solaris2.5"                "sparc"           "solaris2.5" 
                system                 status             status.rev 
   "sparc, solaris2.5"                 "Beta"                    "0" 
                 major                  minor                   year 
                   "0"                   "49"                 "1997" 
              language 
                   "R" 


# (The following is using  x11() and an  Ultrasparc I.
# You should decrease from '20000' if you have a slower machine):

> x <- runif(20000)

> for(i in 1:10) print(unix.time(plot(x)))
[1] 1.66 0.04 3.00 0.00 0.00
[1] 1.33 0.04 2.00 0.00 0.00
[1] 1.68 0.04 3.00 0.00 0.00
[1] 1.40 0.05 2.00 0.00 0.00
[1] 1.67 0.06 2.00 0.00 0.00
[1] 1.44 0.05 3.00 0.00 0.00
[1] 1.68 0.06 2.00 0.00 0.00
[1] 1.38 0.04 2.00 0.00 0.00
[1] 1.66 0.06 2.00 0.00 0.00
[1] 1.41 0.06 3.00 0.00 0.00
> 
> for(i in 1:10) print(unix.time(plot(x, pch='-')))
[1]  4.76  3.25 21.00  0.00  0.00
[1]  4.29  2.51 20.00  0.00  0.00
[1]  4.46  2.95 20.00  0.00  0.00
[1]  4.75  2.95 21.00  0.00  0.00
[1]  5.42  2.99 23.00  0.00  0.00
[1]  4.73  3.14 23.00  0.00  0.00
[1]  4.93  3.00 23.00  0.00  0.00
[1]  4.62  3.02 22.00  0.00  0.00
[1]  4.76  3.06 23.00  0.00  0.00
[1]  4.62  2.82 22.00  0.00  0.00
                ^^^^^
		this tells you that the DRAWING PROCESS is the slow thing.
		it takes about 10 times longer...


Why is x11 much faster in drawing pch=1 (a circle), than a simple "-" ?
Is this X11's `fault' ?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Thu Jul  3 17:28:58 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Thu, 3 Jul 1997 09:28:58 -0700 (PDT)
Subject: R-alpha: plot(  pch = <character> ) is slow.. -- why ? --
In-Reply-To: <199707031554.RAA04752@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970703091049.5412B-100000@chekov>

On Thu, 3 Jul 1997, Martin Maechler wrote:

> # (The following is using  x11() and an  Ultrasparc I.
> # You should decrease from '20000' if you have a slower machine):
> 
> > x <- runif(20000)
> 
> > for(i in 1:10) print(unix.time(plot(x)))
> [1] 1.66 0.04 3.00 0.00 0.00
> > for(i in 1:10) print(unix.time(plot(x, pch='-')))
> [1]  4.76  3.25 21.00  0.00  0.00
> 
> Why is x11 much faster in drawing pch=1 (a circle), than a simple "-" ?
> Is this X11's `fault' ?

Same thing on a Pentium Pro running Linux and displaying on a Sparcstation
10.  

It looks like X11's fault: the graphics code directly calls the X11
functions in each case, however S-PLUS does not have this slowdown.  I
would have thought the explanation was that "-" requires plotting text and
the circle is just graphics, however the square (pch=0) which is also a
simple graphic is just as slow.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Jul  3 17:42:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 3 Jul 1997 18:42:55 +0200
Subject: R-alpha: confidence interval of t.test
Message-ID: <199707031642.SAA09777@galadriel.ci.tuwien.ac.at>


Sorry if this has been discussed here before, but anyway:

The are differences between the confidence intervals of the t.test as
done by R and Splus:

*** R

R> x<-rnorm(1000)+1
R> t.text(x)
Error: couldn't find function "t.text"
R> t.test(x)

         One Sample t-test 

data:  x 
t = 31.4062, df = 999, p-value = 0 
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 0.917027 1.039261 
sample estimates:
mean of x 
 0.978144 

R> t.test(x, mu=1)

         One Sample t-test 

data:  x 
t = -0.7017, df = 999, p-value = 0.483 
alternative hypothesis: true mean is not equal to 1 
95 percent confidence interval:
 -0.08297297  0.03926111                      <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
sample estimates:
mean of x 
 0.978144 



*** Splus

> x<-rnorm(1000)+1
> t.test(x)

         One-sample t-Test 

data:  x 
t = 28.6918, df = 999, p-value = 0 
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 0.8975418 1.0293277 
sample estimates:
 mean of x 
 0.9634347

> t.test(x, mu=1)

         One-sample t-Test 

data:  x 
t = -1.0889, df = 999, p-value = 0.2764 
alternative hypothesis: true mean is not equal to 1 
95 percent confidence interval:
 0.8975418 1.0293277                    <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
sample estimates:
 mean of x 
 0.9634347



*******************


As you can See R's confidence intervals are centered around the
deviation from the null, whereas those of Splus are centered around
the observed value ... the later seems the more intuitive thing to me.

So is this a bug or feature of R (in my eyes it's a bug)?


Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul  7 14:33:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 7 Jul 1997 15:33:47 +0200
Subject: R-alpha: box( col = ..)  does not work
Message-ID: <199707071333.PAA00765@sophie.ethz.ch>

The 'col' argument does not work with  box(.)  contrary to the
documentation.
'lty' does nicely.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 10 13:17:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 10 Jul 1997 14:17:48 +0200
Subject: R-alpha: R-mailinglists -- "server down" scheduled for Friday, July 18 (MET)
Message-ID: <199707101217.OAA01668@sophie.ethz.ch>

It's vacation time here, so ...

Friday in 8 days, our main server will get an OS upgrade
	(Solaris 2.4 |--> 2.5.1).
This will make the  R-mailinglists fail for several hours
(or more if we are unlucky).

I hope that the next  alpha or beta release of R 
will be well BEFORE that date such that nobody will suffer from this out
time. 

[ Usual working time of the upgrade staff is 8.00 -- 17.00 (= 5pm)
  Middle-European Summer Time  ("MET DST") which is Universal Time +2(hours),
  i.e., it won't affect NZ's Friday much... ]


Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 11 16:39:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 11 Jul 1997 17:39:48 +0200
Subject: R-alpha: wishlist
Message-ID: <199707111539.RAA01670@aragorn.ci.tuwien.ac.at>

Here's something which could go on the TODO list:  give scan() the
ability to also read in fixed-width format data files, e.g. with an
optional `widths' argument as in S-PLUS.
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul 14 15:24:07 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 14 Jul 1997 16:24:07 +0200
Subject: R-alpha: <primitive>  vs .Internal(.) [was "Problem with `rpois'"]
In-Reply-To: <m3u3i4mg2g.fsf@sade.uio.no> (fredrigl@math.uio.no)
Message-ID: <199707141424.QAA00881@sophie.ethz.ch>

This is more a `request for comment' than anything else.

>>>>> "Fredr" == Fredrik Glockner <fredrigl@math.uio.no> writes:

    Fredr> There is a problem with `rpois'.  It does seem to take care
    Fredr> about the order of the arguments.  This is an example:

    >> rpois(n=1,lambda=2)
    Fredr> [1] 3
    >> rpois(lambda=2,n=1)
    Fredr> [1] 2 0

    Fredr> It obviously uses the first argument as the number of samples to
    Fredr> be drawn, which is wrong.

    Fredr> I used Version 0.49 Beta (April 23, 1997).

I assume that all you R-devel'ers thought something like

	"Well yes, we know this is because 'rpois' is a primitive function
	and  R&R  once had this problem on their  TODO / TASKS list ".

However, there was no answer going through  R-help or even CC'ed to
R-devel.

I've been think about this dilemma a little bit myself,
have looked at		main/names.c    a little bit,
and ``concluded'' (i.e. "wildly guessed")
that

	i. a) <primitive> functions must be somewhat more efficient than
		.Internal(foo(..)) ones.
           
	   b) How much more efficient? [CPU / memory] ??

	
	ii. From the point of view of the
			``robust / portable / defensive'' programming paradigm
	    it is really quit undesirable to have these <primitive>
	    functions.
	    R programmers have no reliable way of finding out the argument
	    specifications of these functions, unless by searching for the
	    corresponding "do_FOO" function and reading it's C code.

	    I know there's  help(.)   and yes, this helps (!) -- but still....
	  
	    The above <bug report> of   Fredrik  is really are reason for using
	    "proper" (non-primitive) R functions as much as possible. 

	iii.   ????
		    <<< The things  Ross and Luke and ?? will tell us.
	
--
In summary, my proposal is to use   <primitive>s  much less than currently.
But I'm more than willing to learn why this would not be a good idea.

Finally:

I've spent 2 hours or so to wade through the  probability distribution
codes and 'patch' all these functions such as to use  
	function(..) .Internal(..)
code instead of being primitve.

The following patch applies cleanly .. and seems to do just what I want.
Of course, it solves Fredrik's problem.

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/


--- src/library/base/funs/distn.~1~	Mon Nov 25 11:42:00 1996
+++ src/library/base/funs/distn	Mon Jul 14 15:52:55 1997
@@ -42,3 +38,49 @@
 qweibull <- function(p, shape, scale=1) .Internal(qweibull(p, shape, scale))
 rweibull <- function(n, shape, scale=1) .Internal(rweibull(n, shape, scale))
 
+
+##--- Argument names taken from  ../man/Beta :
+dbeta <- function(x, a, b) .Internal(dbeta(x, a, b))
+pbeta <- function(q, a, b) .Internal(pbeta(q, a, b))
+qbeta <- function(p, a, b) .Internal(qbeta(p, a, b))
+rbeta <- function(n, a, b) .Internal(rbeta(n, a, b))
+##--- Argument names taken from  ../man/Binomial :
+dbinom <- function(x, n, p) .Internal(dbinom(x, n, p))
+pbinom <- function(q, n, p) .Internal(pbinom(q, n, p))
+qbinom <- function(prob, n, p) .Internal(qbinom(prob, n, p))
+rbinom <- function(nobs, n, p) .Internal(rbinom(nobs, n, p))
+##--- Argument names taken from  ../man/Chisquare :
+dchisq <- function(x, df) .Internal(dchisq(x, df))
+pchisq <- function(q, df) .Internal(pchisq(q, df))
+qchisq <- function(p, df) .Internal(qchisq(p, df))
+rchisq <- function(n, df) .Internal(rchisq(n, df))
+##--- Argument names taken from  ../man/F :
+df <- function(x, n1, n2) .Internal(df(x, n1, n2))
+pf <- function(q, n1, n2) .Internal(pf(q, n1, n2))
+qf <- function(p, n1, n2) .Internal(qf(p, n1, n2))
+rf <- function(n, n1, n2) .Internal(rf(n, n1, n2))
+##--- Argument names taken from  ../man/Geometric :
+dgeom <- function(x, p) .Internal(dgeom(x, p))
+pgeom <- function(q, p) .Internal(pgeom(q, p))
+qgeom <- function(prob, p) .Internal(qgeom(prob, p))
+rgeom <- function(n, p) .Internal(rgeom(n, p))
+##--- Argument names taken from  ../man/Hypergeometric :
+dhyper <- function(x, N1, N2, n) .Internal(dhyper(x, N1, N2, n))
+phyper <- function(q, N1, N2, n) .Internal(phyper(q, N1, N2, n))
+qhyper <- function(p, N1, N2, n) .Internal(qhyper(p, N1, N2, n))
+rhyper <- function(nobs, N1, N2, n) .Internal(rhyper(nobs, N1, N2, n))
+##--- Argument names taken from  ../man/NegBinomial :
+dnbinom <- function(x, n, p) .Internal(dnbinom(x, n, p))
+pnbinom <- function(q, n, p) .Internal(pnbinom(q, n, p))
+qnbinom <- function(prob, n, p) .Internal(qnbinom(prob, n, p))
+rnbinom <- function(nobs, n, p) .Internal(rnbinom(nobs, n, p))
+##--- Argument names taken from  ../man/Poisson :
+dpois <- function(x, lambda) .Internal(dpois(x, lambda))
+ppois <- function(q, lambda) .Internal(ppois(q, lambda))
+qpois <- function(p, lambda) .Internal(qpois(p, lambda))
+rpois <- function(n, lambda) .Internal(rpois(n, lambda))
+##--- Argument names taken from  ../man/T
+dt <- function(x, df) .Internal(dt(x, df))
+pt <- function(q, df) .Internal(pt(q, df))
+qt <- function(p, df) .Internal(qt(p, df))
+rt <- function(n, df) .Internal(rt(n, df))
--- src/main/names.c.~2~	Fri Jul  4 16:42:42 1997
+++ src/main/names.c	Mon Jul 14 15:52:33 1997
@@ -210,25 +210,25 @@
 {"lchoose",	do_math2,	4,	1,	2,	PP_FUNCALL,	0},
 {"choose",	do_math2,	5,	1,	2,	PP_FUNCALL,	0},
 
-{"dchisq",	do_math2,	6,	1,	2,	PP_FUNCALL,	0},
-{"pchisq",	do_math2,	7,	1,	2,	PP_FUNCALL,	0},
-{"qchisq",	do_math2,	8,	1,	2,	PP_FUNCALL,	0},
+{"dchisq",	do_math2,	6,	11,	2,	PP_FUNCALL,	0},
+{"pchisq",	do_math2,	7,	11,	2,	PP_FUNCALL,	0},
+{"qchisq",	do_math2,	8,	11,	2,	PP_FUNCALL,	0},
 
 {"dexp",	do_math2,	9,	11,	2,	PP_FUNCALL,	0},
 {"pexp",	do_math2,	10,	11,	2,	PP_FUNCALL,	0},
 {"qexp",	do_math2,	11,	11,	2,	PP_FUNCALL,	0},
 
-{"dgeom",	do_math2,	12,	1,	2,	PP_FUNCALL,	0},
-{"pgeom",	do_math2,	13,	1,	2,	PP_FUNCALL,	0},
-{"qgeom",	do_math2,	14,	1,	2,	PP_FUNCALL,	0},
-
-{"dpois",	do_math2,	15,	1,	2,	PP_FUNCALL,	0},
-{"ppois",	do_math2,	16,	1,	2,	PP_FUNCALL,	0},
-{"qpois",	do_math2,	17,	1,	2,	PP_FUNCALL,	0},
-
-{"dt",		do_math2,	18,	1,	2,	PP_FUNCALL,	0},
-{"pt",		do_math2,	19,	1,	2,	PP_FUNCALL,	0},
-{"qt",		do_math2,	20,	1,	2,	PP_FUNCALL,	0},
+{"dgeom",	do_math2,	12,	11,	2,	PP_FUNCALL,	0},
+{"pgeom",	do_math2,	13,	11,	2,	PP_FUNCALL,	0},
+{"qgeom",	do_math2,	14,	11,	2,	PP_FUNCALL,	0},
+
+{"dpois",	do_math2,	15,	11,	2,	PP_FUNCALL,	0},
+{"ppois",	do_math2,	16,	11,	2,	PP_FUNCALL,	0},
+{"qpois",	do_math2,	17,	11,	2,	PP_FUNCALL,	0},
+
+{"dt",		do_math2,	18,	11,	2,	PP_FUNCALL,	0},
+{"pt",		do_math2,	19,	11,	2,	PP_FUNCALL,	0},
+{"qt",		do_math2,	20,	11,	2,	PP_FUNCALL,	0},
 
 
 #ifdef COMPLEX_DATA
@@ -244,21 +244,21 @@
 
 /* Mathematical Functions of Three Variables */
 
-{"dbeta",	do_math3,	1,	1,	3,	PP_FUNCALL,	0},
-{"pbeta",	do_math3,	2,	1,	3,	PP_FUNCALL,	0},
-{"qbeta",	do_math3,	3,	1,	3,	PP_FUNCALL,	0},
-
-{"dbinom",	do_math3,	4,	1,	3,	PP_FUNCALL,	0},
-{"pbinom",	do_math3,	5,	1,	3,	PP_FUNCALL,	0},
-{"qbinom",	do_math3,	6,	1,	3,	PP_FUNCALL,	0},
+{"dbeta",	do_math3,	1,	11,	3,	PP_FUNCALL,	0},
+{"pbeta",	do_math3,	2,	11,	3,	PP_FUNCALL,	0},
+{"qbeta",	do_math3,	3,	11,	3,	PP_FUNCALL,	0},
+
+{"dbinom",	do_math3,	4,	11,	3,	PP_FUNCALL,	0},
+{"pbinom",	do_math3,	5,	11,	3,	PP_FUNCALL,	0},
+{"qbinom",	do_math3,	6,	11,	3,	PP_FUNCALL,	0},
 
 {"dcauchy",	do_math3,	7,	11,	3,	PP_FUNCALL,	0},
 {"pcauchy",	do_math3,	8,	11,	3,	PP_FUNCALL,	0},
 {"qcauchy",	do_math3,	9,	11,	3,	PP_FUNCALL,	0},
 
-{"df",		do_math3,	10,	1,	3,	PP_FUNCALL,	0},
-{"pf",		do_math3,	11,	1,	3,	PP_FUNCALL,	0},
-{"qf",		do_math3,	12,	1,	3,	PP_FUNCALL,	0},
+{"df",		do_math3,	10,	11,	3,	PP_FUNCALL,	0},
+{"pf",		do_math3,	11,	11,	3,	PP_FUNCALL,	0},
+{"qf",		do_math3,	12,	11,	3,	PP_FUNCALL,	0},
 
 {"dgamma",	do_math3,	13,	11,	3,	PP_FUNCALL,	0},
 {"pgamma",	do_math3,	14,	11,	3,	PP_FUNCALL,	0},
@@ -272,9 +272,9 @@
 {"plogis",	do_math3,	20,	11,	3,	PP_FUNCALL,	0},
 {"qlogis",	do_math3,	21,	11,	3,	PP_FUNCALL,	0},
 
-{"dnbinom",	do_math3,	22,	1,	3,	PP_FUNCALL,	0},
-{"pnbinom",	do_math3,	23,	1,	3,	PP_FUNCALL,	0},
-{"qnbinom",	do_math3,	24,	1,	3,	PP_FUNCALL,	0},
+{"dnbinom",	do_math3,	22,	11,	3,	PP_FUNCALL,	0},
+{"pnbinom",	do_math3,	23,	11,	3,	PP_FUNCALL,	0},
+{"qnbinom",	do_math3,	24,	11,	3,	PP_FUNCALL,	0},
 
 {"dnorm",	do_math3,	25,	11,	3,	PP_FUNCALL,	0},
 {"pnorm",	do_math3,	26,	11,	3,	PP_FUNCALL,	0},
@@ -288,39 +288,39 @@
 {"pweibull",	do_math3,	32,	11,	3,	PP_FUNCALL,	0},
 {"qweibull",	do_math3,	33,	11,	3,	PP_FUNCALL,	0},
 
-{"dnchisq",	do_math3,	34,	1,	3,	PP_FUNCALL,	0},
-{"pnchisq",	do_math3,	35,	1,	3,	PP_FUNCALL,	0},
-{"qnchisq",	do_math3,	36,	1,	3,	PP_FUNCALL,	0},
+{"dnchisq",	do_math3,	34,	11,	3,	PP_FUNCALL,	0},
+{"pnchisq",	do_math3,	35,	11,	3,	PP_FUNCALL,	0},
+{"qnchisq",	do_math3,	36,	11,	3,	PP_FUNCALL,	0},
 
 
 /* Mathematical Functions of Four Variables */
 
-{"dhyper",	do_math4,	1,	1,	4,	PP_FUNCALL,	0},
-{"phyper",	do_math4,	2,	1,	4,	PP_FUNCALL,	0},
-{"qhyper",	do_math4,	3,	1,	4,	PP_FUNCALL,	0},
+{"dhyper",	do_math4,	1,	11,	4,	PP_FUNCALL,	0},
+{"phyper",	do_math4,	2,	11,	4,	PP_FUNCALL,	0},
+{"qhyper",	do_math4,	3,	11,	4,	PP_FUNCALL,	0},
 
 
 /* Random Numbers */
 
-{"rchisq",	do_random1,	0,	1,	2,	PP_FUNCALL,	0},
+{"rchisq",	do_random1,	0,	11,	2,	PP_FUNCALL,	0},
 {"rexp",	do_random1,	1,	11,	2,	PP_FUNCALL,	0},
-{"rgeom",	do_random1,	2,	1,	2,	PP_FUNCALL,	0},
-{"rpois",	do_random1,	3,	1,	2,	PP_FUNCALL,	0},
-{"rt",		do_random1,	4,	1,	2,	PP_FUNCALL,	0},
+{"rgeom",	do_random1,	2,	11,	2,	PP_FUNCALL,	0},
+{"rpois",	do_random1,	3,	11,	2,	PP_FUNCALL,	0},
+{"rt",		do_random1,	4,	11,	2,	PP_FUNCALL,	0},
 
-{"rbeta",	do_random2,	0,	1,	3,	PP_FUNCALL,	0},
-{"rbinom",	do_random2,	1,	1,	3,	PP_FUNCALL,	0},
+{"rbeta",	do_random2,	0,	11,	3,	PP_FUNCALL,	0},
+{"rbinom",	do_random2,	1,	11,	3,	PP_FUNCALL,	0},
 {"rcauchy",	do_random2,	2,	11,	3,	PP_FUNCALL,	0},
-{"rf",		do_random2,	3,	1,	3,	PP_FUNCALL,	0},
+{"rf",		do_random2,	3,	11,	3,	PP_FUNCALL,	0},
 {"rgamma",	do_random2,	4,	11,	3,	PP_FUNCALL,	0},
 {"rlnorm",	do_random2,	5,	11,	3,	PP_FUNCALL,	0},
 {"rlogis",	do_random2,	6,	11,	3,	PP_FUNCALL,	0},
-{"rnbinom",	do_random2,	7,	1,	3,	PP_FUNCALL,	0},
+{"rnbinom",	do_random2,	7,	11,	3,	PP_FUNCALL,	0},
 {"rnorm",	do_random2,	8,	11,	3,	PP_FUNCALL,	0},
 {"runif",	do_random2,	9,	11,	3,	PP_FUNCALL,	0},
 {"rweibull",	do_random2,	10,	11,	3,	PP_FUNCALL,	0},
 
-{"rhyper",	do_random3,	0,	1,	4,	PP_FUNCALL,	0},
+{"rhyper",	do_random3,	0,	11,	4,	PP_FUNCALL,	0},
 
 {"sample",	do_sample,	0,	11,	3,	PP_FUNCALL,	0},
 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From malewski@Psyres-Stuttgart.DE  Wed Jul 16 21:48:52 1997
From: malewski@Psyres-Stuttgart.DE (Peter Malewski)
Date: Wed, 16 Jul 1997 22:48:52 +0200 (MET DST)
Subject: R-alpha: memory problems ?
Message-ID: <Pine.GSO.3.96.970716224139.11598C-100000@sunserv>

Hallo,

This is not so urgent, because most analysis are made by S+, -> just a
hint: I had run Rapril under Win95 with 64 Mb RAM. After a Ram upgrade to
128 mb R doesn't start any more.

good luck for the future ...






=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Peter Malewski                            Center for Psychotherapy Research
Psychologist                              Christian-Belser-Strasse 79a
Project TR-EAT                            D-70597 Stuttgart Germany
                                                 
malewski@psyres-stuttgart.de                      
+49 711 6781-404 (phone)                       
+49 711 6876902  (fax)    
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Thu Jul 17 20:16:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Thu, 17 Jul 1997 15:16:55 -0400 (EDT)
Subject: R-alpha: functionality of CASIM: C/S-Plus interface
Message-ID: <Pine.SUN.3.95.970717151335.4942A-100000@paca>


   Some people here have started using CASIM, which is an add-on we got a
while back for S-Plus that allows one to spawn an S-Plus process from a C
program and communicate with it.
   How hard do folks think it would be to develop such an interface for R?
I might try it, but I'm not completely sure I'm up to it (although it
would exercise my programming skills).
   Also, I wonder again at the ethics of looking at the CASIM header files
(which came from StatSci) when trying to work up an R interface --
although I notice that the header files say "CSIRO division of Mathematics
and Statistics" on them rather than "StatSci" ...

  Ben

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From oehl@Psyres-Stuttgart.DE  Tue Jul 22 09:56:56 1997
From: oehl@Psyres-Stuttgart.DE (Jens Oehlschlaegel)
Date: Tue, 22 Jul 1997 10:56:56 +0200 (MET DST)
Subject: R-alpha: some thoughts about factor()
Message-ID: <Pine.GSO.3.96.970722105018.17490E-100000@sunserv>



Dear R-people,

recently at s-news we had a discussion about factor().
I thought you might be interested in some of my thoughts about factors.

Any comments welcome


Best regards


Jens Oehlschlaegel-Akiyoshi


-------------------------------------------------------------------

I think the problem is deeper than that factors would just be handled
inapprobriately by some S+ functions, the inconsistency is built in
the constructor factor(), and thus is built in the concept! 

Let me cite S+ online help of factor() on the meaning of levels:

VALUE
object of class "factor", representing values taken from the finite set
given by levels. It is important that this object 
is not numeric; in particular, comparisons and other operations behave
AS IF THEY OPERATED ON VALUES FROM THE LEVELS SET, WHICH IS ALWAYS OF
MODE CHARACTER.

Let's try comparisions on values from the level set:

> my.animals <- c(4,5,6,4,5,6)
> my.levels <- 4:6
> my.labels <- c("dog","cat","rat")
> animals <- factor(my.animals,levels=my.levels,labels=my.labels)
> unclass(animals)
[1] 1 2 3 1 2 3
attr(, "levels"):
[1] "dog" "cat" "rat"

Obviously labels become levels, and comparisions with levels will never work,
whether levels are given as numerics or as characters, as in

> animals==4
[1] F F F F F F
> animals=="4"
[1] F F F F F F

Obviously currently all comparisions work on the LABELS SET, which is the
only one stored with the factor object, but which - for purpose of
confusion - is a named attribute "levels", whereas
 
> labels(animals) 
[1] "1" "2" "3" "4" "5" "6"

is a totally different story. 



All a user like me wishes is something like

> unclass(animals)
[1] 4 5 6 4 5 6
attr(, "labels"):
[1] "dog" "cat" "rat"

and of course it would be user-friendly if S+ would recognize which of
both representations are meant in comparisions and assignments like

animals==4
animals=="dog"
animals[1] <- 4
animals[1] <- "dog"

not coercing 4s to "4"s but interpreting animals the right way, isn't S+
an interpreter?


If there is no way around a need for internal numeric representation of
integers 1:x then a factor object could look like

> unclass(animals)
[1] 1 2 3 1 2 3
attr(, "levels"):
[1] "dog" "cat" "rat"
attr(, "nlevels"):
[1] 4 5 6


and consequently


[old function, sorry for the s-at-the-end-confusion] 
codes(animals)  could return 1 2 3 1 2 3

[old function] 
levels(animals) could return "dog" "cat" "rat"
[new function] 
level(animals) could return "dog" "cat" "rat" "dog" "cat" "rat"

[new function] 
nlevels(animals) could return 4 5 6
[new function]
nlevel(animals) could return 4 5 6 4 5 6


for reasons of consistency, so everyone would know he has to write either 

  nlevel(animals)==4
  nlevel(animals)[1] <- 4

or

  level(animals)=="dog"
  level(animals)[1] <- "dog"


Concerning defaults one probably would keep returning

animals
[1] "dog" "cat" "rat" "dog" "cat" "rat"

for reasons of compatibility

but make the evaluator coerce animals to nlevel(animals) in

animals[1] <- 4

instead of 

coercing 4 to "4"


I have no idea about how to change the constructor factor() to keep
compatibility, perhaps just keep arguments old.levels=new.nlevels and
old.labels=new.levels, together with a clear help function? 

DOES THAT SOUND ANY BETTER?



yours sincerely

--
Jens Oehlschlaegel-Akiyoshi
Psychologist/Statistician
Project TR-EAT + COST Action B6
                                                 F.rankfurt
oehl@psyres-stuttgart.de                         A.ttention
+49 711 6781-408 (phone)                         I.nventory
+49 711 6876902  (fax)                           R .-----.
                                                  / ----- \
Center for Psychotherapy Research                | | 0 0 | |
Christian-Belser-Strasse 79a                     | |  ?  | |
D-70597 Stuttgart Germany                         \ ----- /
-------------------------------------------------- '-----' -
                                                 it's better








=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul 22 21:30:47 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 22 Jul 1997 16:30:47 -0400 (EDT)
Subject: R-alpha: split() S/R mismatch?
Message-ID: <Pine.SUN.3.95.970722162745.10400A-100000@paca>


  I *think* that split(x,f) in S/S-PLUS (SunOS 4, S-PLUS 3.2) by default
replicates f as many times as necessary to cover the length of x.  In R it
apparently doesn't.

  I have the following function:

matsplit <-
function (x, crit) 
{
        lapply(split(x, crit), matrix, ncol = ncol(x))
        #  x is a matrix, crit is a vector with length dim(x)[1] ...
        #   makes a list of matrices split by row
}

The following:

y _ cbind(matrix(1:10,ncol=2,byrow=T),rep(1:2,c(2,3)))
matsplit(y[,1:2],y[,3])

gives

$"1":
     [,1] [,2] 
[1,]    1    2
[2,]    3    4
 
$"2":
     [,1] [,2] 
[1,]    5    6
[2,]    7    8
[3,]    9   10
 
 in S-PLUS; in R it gives

Error in split(x, as.factor(f)) : argument lengths differ

 I can find a workaround.  Is this a bug, a feature, or just a difference?

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Jul 22 23:12:34 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
Subject: R-alpha: New version of R for testing
Message-ID: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>

The newest version of R for Unix (version 0.50 alpha-1) is now (or will
soon be) available from the following sites.

    NORTH AMERICA:
	http://lib.stat.cmu.edu/R/Alpha

    EUROPE:
        ftp://ftp.stat.math.ethz.ch/R/
        ftp://statlab.uni-heidelberg.de/pub/mirrors/auckland/R/

    JAPAN:
        ftp://ftp.u-aizu.ac.jp/pub/lang/R/

    NEW ZEALAND:
        ftp://stat.auckland.ac.nz/pub/R/

Please obtain a copy from site close to you.  Note that New Zealand
is not close to anywhere other than itself :-).

This is primarily a bug-fix release, although there is some new
functionalty.  As noted in the 0.49 release announcement, the primary
goal at present is stability.  This is partly for the benefit of anyone
who might be using R, but also so that we we can bring the PC and
Mac versions into sync with the Unix version.

The "alpha-1" indicates that there may be a few stability problems with
this version.  This is because there are been a number of very low-level
changes which have not been exercised as much as they might.  We hope
that these can be found and fixed in a couple of patch cycles.  Then
we will declare it to be "R-0.50 stable".

This version owes a good deal to Martin Maechler who probably did as
much bug-fixing as R+R together this time.

	R + R + M


We have not kept good a records of bug fixes or updates the TASKS list
(we should have this updated for the "stable" release).  A partial list
of changes follows.

-------------------------------------------------------------------

		  CHANGES IN VERSION R VERSION 0.50

WARNING!!!

 o  A change in the way that "expressions" are implemented means that
    saved data images which contain expressions will probably not
    restore properly.

NEW FEATURES

 o  "expressions" are now implemented as a basic type rather than as
    a class of object.  This change was made as move toward compatibility
    with S and also to implement mathematical annotation in graphs.

 o  "eigen" can now handle complex and non-symmetric matrices.

 o  Libraries are now attached by loading their code into newly created
    environment frames on the search path rather than in with the general
    system code.  This means that libraries can be unloaded as well as
    loaded.  They can also have .First.lib and .Last.lib functions.

 o  There is now an experimental function called "delay" which creates
    a promise to evaluate an expression.  This provides direct access
    to the lazy evaluation mechanism used by R.

 o  >>>>  'make tests'   allows to test--run all the help() examples.
 
 o  New functions   matplot / matpoints / matlines.

 o  cut has 2 new arguments. 'right = TRUE' gives intervals closed on the
	right, open to the left (as S); 'right = FALSE' allows to reverse
	this. The code for default label construction has been enhanced,
	and can be controlled by the new argument 'dig.lab'.

 o  legend(.) has 2 new arguments 'cex' (obvious) and 'merge = FALSE'.
	-> ?legend.

 o  deparse  has a 2nd argument allowing for a kind of line width.

 o  many help(.) pages have been updated with working examples,
	and several new ones have been created.

BUG FIXES

 o  A bug which prevented the "pictex" graphics driver from working
    has been fixed.

 o  Regression diagnostics obtained with "lm.influence" now work when
    there are weights.	This means they should work for glms.

 o  There was a problem in parsing files from statements which were
    separated from following statements by ";" (e.g. data(iris); iris).
    This is fixed.

 o  Comments are handled better in functions.  The rule is that they
    are shifted to just before their statements.  Comments after the
    last statement of a function are lost.

 o  It is now possible to perform complicated mutations of expressions.
    For example
	e <- quote(f(x=1,y=2))
	names(e)[[2]] <- "a"
    will change the x= argument tag into a=.  In the past this produced
    odd error messages.

 o  The length function now tries to return a "sensible" value for all
    the built-in types.	 For example, symbols now have length 1.

 o  "update" should now work in both "lm" and "glm" models.

 o  The functions Re, Im, Mod, Arg and Conj will now accept real-valued
    arguments and return the obvious results.

 o  Minor graphics cleanup.

 o  A fix for convergence problems in glm from Thomas Lumley included.

 o  A new version of qt() should not take infinitely long to get an
    answer in the large degrees if freedom case.  The underlying code
    (Hill 1970, CACM) appears to be much faster and more accurate than
    Splus.

 o  A final Newton step has beed added to give a final "polish" to
    the quantiles produced by pnorm().	These should be close to full
    accuracy now.

 o  A bug in qbeta found by Martin Maechler has been fixed.  This should
    speed up quantile computation for the F and Beta distributions.

 o  rainbow(.) now allows "start > end" indexing the "color circle".
    topo.colors(n), terrain.colors(n), heat.colors(n) now also work for n=1,2.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Jul 23 12:21:47 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Jul 1997 07:21:47 -0400
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of "Wed, 23 Jul 1997 10:12:34 +1200 (NZST)"
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <wnc67u2ovxw.fsf@urn.math.sc.edu>



FYI:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version 0.50 alpha-1) is
    Ross> now (or will soon be) available from the following sites.

    Ross>     NORTH AMERICA:
    Ross> 	http://lib.stat.cmu.edu/R/Alpha

Exists at StatLib, compiles, runs most basic things (don't know about
bugs), and seems to work under Solaris 2.5.  (I'll try debian this
afternoon at home while babysitting).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Jul 23 12:25:47 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Jul 1997 07:25:47 -0400
Subject: R-alpha: New version of R for testing
In-Reply-To: Anthony Rossini's message of "23 Jul 1997 07:21:47 -0400"
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz> <wnc67u2ovxw.fsf@urn.math.sc.edu>
Message-ID: <wnc4t9movr8.fsf@urn.math.sc.edu>


>>>>> "Anthony" == Anthony Rossini <rossini@stat.sc.edu> writes:

    Anthony> FYI:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version 0.50 alpha-1) is
    Ross> now (or will soon be) available from the following sites.

    Ross> NORTH AMERICA: http://lib.stat.cmu.edu/R/Alpha

    Anthony> Exists at StatLib, compiles, runs most basic things
    Anthony> (don't know about bugs), and seems to work under Solaris
    Anthony> 2.5.  (I'll try debian this afternoon at home while
    Anthony> babysitting).

Also should've noted:

	ftp://lib.stat.cmu.edu/R/Alpha/R-0.50-a1.tgz

also works, for those who'd rather use FTP.

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 23 16:06:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Jul 1997 17:06:49 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <199707231506.RAA16235@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.50 alpha-1) is now (or will
> soon be) available from the following sites.

> ...

R + R + M,

Thanks for putting out the new version.  Finally, it's back to testing
(and porting) ...

I have one immediate bug report.

I think in R-0.50-a1/mansrc/latex/Rdoc.sty,

	\begin{list}{}\SetLmargin}%

in the code for the Header environment must be

	\begin{list}{}\SetLmargin\item}%

(Otherwise, make install-latex gives many errors.)  Martin?

A context diff is appended below.

Also, in the data subdir, quakes and sunspots should have mode 644.

-k

***********************
*** mansrc/latex/Rdoc.sty.orig	Wed Jul 23 17:03:46 1997
--- mansrc/latex/Rdoc.sty	Wed Jul 23 17:03:56 1997
***************
*** 28,34 ****
      \makebox[1in][r]{\tt #1} \\ \hline
    \end{tabular}
  \end{center}
! \begin{list}{}\SetLmargin}%
  {\end{list}}
  
  \newenvironment{Arguments}[0]{
--- 28,34 ----
      \makebox[1in][r]{\tt #1} \\ \hline
    \end{tabular}
  \end{center}
! \begin{list}{}\SetLmargin\item}%
  {\end{list}}
  
  \newenvironment{Arguments}[0]{
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Jul 23 22:53:45 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Jul 1997 23:53:45 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <x2vi21bfkm.fsf@bush.kubism.ku.dk>


In the minor department, I see that you've worked around the .orig
patch problem in src/library/base/Makefile. I know that I (and Martin)
suggested that particular way of doing it, i.e.

        @cat `ls funs/[a-z]* | sed '/CVS/d; /~$$/d; /\.orig$$/d; /\.bak$$/d'` \
         | sed '/^[     ]*$$/d'  > ../../../library/base
#                  ^^ = TAB + Space

-- but on 2nd thought, wouldn't it be more logical simply to change
the source file names to have suffix .R and use

	@cat *.R | sed ...

The current way has all sorts of gotchas built in. What if Netscape
dumps core when started in src/library/base/funs, e.g.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jul 24 21:45:07 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 24 Jul 1997 22:45:07 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <x2g1t4gox8.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> NEW FEATURES
> 
>  o  "expressions" are now implemented as a basic type rather than as
>     a class of object.  This change was made as move toward compatibility
>     with S and also to implement mathematical annotation in graphs.

Something looks wrong:

> expression(2+2)
expression(2 + 2)
> expression(2+2)[[1]]
expression(2 + 2)
> expression(2+2)[[1]][[1]]
expression(2 + 2)

- How the blazes is a poor soul supposed to get at the parse tree for
an expression? According to the docs, an expression is supposed to be
a list of calls, but obviously

> mode(expression(2+2)[[1]])
[1] "expression"

----------

Another piece of weirdness:

> t(table(0))
Error: dimnames: number of dimensions must equal number of names

# That one used to cause a segmentation fault (my bug report for it
# seems to have fallen off of the TASKS list - bug suicide?)

> t(as.matrix(table(0)))
     0
[1,] 1

# Looks OK now ... or is it? Watch:

> ?ls
Warning: invalid 'cutoff' for deparse, used default
#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        
        List Objects

             ls(name, pos=2, envir=sys.frame(sys.parent()),
                    all.names=FALSE, pattern)

Same thing happens if you omit the 2nd expression.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Arne Kovac <maak@stats.bris.ac.uk>  Fri Jul 25 04:51:25 1997
From: Arne Kovac <maak@stats.bris.ac.uk> (Arne Kovac)
Date: Fri, 25 Jul 1997 03:51:25 +0000 (GMT)
Subject: R-alpha: Treatment of seed
Message-ID: <Pine.LNX.3.95.970725033537.4471B-100000@ts1.bris.ac.uk>

There is a difference between R and S (or S-Plus, I'm not sure about
that) concerning the generation of random numbers.

If an error occurs during the execution of a function, the seed is
restored to its old value in S-Plus, but not in R. This feature of S-Plus
has just turned out to be very useful for me because I got an error
message during a small simulation for a certain choice of parameters.

Here is a silly example:

R> silly<-function()
+ {
+ tmp<-rnorm(5)
+ unknownfunction()
+ }
R> .Random.seed
[1]  8886  1153 10190
R> silly()
Error: couldn't find function "unknownfunction"
R> .Random.seed
[1]  9859  1963 19516


Splus> silly<-function()
+ {
+ tmp<-rnorm(5)
+ unknownfunction()
+ }
Splus> .Random.seed
 [1] 37 31 60  6 22  0 47 15  0 30 41  0
Splus> silly()
Error in silly(): couldn't find function "unknownfunction"
Dumped
Splus> .Random.seed
 [1] 37 31 60  6 22  0 47 15  0 30 41  0

Arne Kovac

-- 
Arne Kovac
School of Mathematics           Phone: +44 (0117) 942 7551
University of Bristol           A.Kovac@bristol.ac.uk    
University Walk                 http://www.stats.bris.ac.uk/~maak
Bristol, BS8 1TW, U.K.



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:54:56 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:54:56 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2vi21bfkm.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2vi21bfkm.fsf@bush.kubism.ku.dk>
Message-ID: <199707250854.KAA17771@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> In the minor department, I see that you've worked around the .orig
> patch problem in src/library/base/Makefile. I know that I (and Martin)
> suggested that particular way of doing it, i.e.

>         @cat `ls funs/[a-z]* | sed '/CVS/d; /~$$/d; /\.orig$$/d; /\.bak$$/d'` \
>          | sed '/^[     ]*$$/d'  > ../../../library/base
> #                  ^^ = TAB + Space

> -- but on 2nd thought, wouldn't it be more logical simply to change
> the source file names to have suffix .R and use

> 	@cat *.R | sed ...

> The current way has all sorts of gotchas built in. What if Netscape
> dumps core when started in src/library/base/funs, e.g.

I think this is a very good idea.  (Would also allow us to keep e.g. .S
sources when porting ...).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:56:10 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:56:10 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2g1t4gox8.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2g1t4gox8.fsf@bush.kubism.ku.dk>
Message-ID: <199707250856.KAA17775@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Another piece of weirdness:

>> t(table(0))
> Error: dimnames: number of dimensions must equal number of names

> # That one used to cause a segmentation fault (my bug report for it
> # seems to have fallen off of the TASKS list - bug suicide?)

>> t(as.matrix(table(0)))
>      0
> [1,] 1

> # Looks OK now ... or is it? Watch:

>> ?ls
> Warning: invalid 'cutoff' for deparse, used default
> #^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Indeed.  Was also on my bugs list, however with the

	t(table(1))

example.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:57:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:57:31 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.50 alpha-1) is now (or
> will soon be) available from the following sites.

> ...

Here are some comments on the new version.  Actually, quite a few ...
Hard to structure the whole thing nicely.

* My
	R> x <- 1:5
	R> dimnames(x)[1,2] <- NULL
segfault in dimnames mutation appears as Open in TASKS, and as Closed in
TASKS.OLD.

* In

R> D(expression(z * (log(z) /z)), "z")
(log(z)/z) + z * (1/z/z - log(z)/z^2)

the "1/z/z" is perhaps not optimal ...

* TASKS has

TASK:	"chisquare.test" problem
STATUS:	Open
FROM:	<venkat@biosta.mskcc.org>
	Can you change the explicit "cat" statement in the
	"chisquare.test" function which insists on writing to the
	screen even when the output is redirected to a variable? (Using
	"htest" class as in "t.test" function.)
	[ Should we switch to the library one. ]

As I already suggested, it would be nice to include all of ctest with
the distribution proper.

I have another question/suggestion re chisquare tests.  Several of my
functions in ctest now return "observed" and "expected" components.
Would it be a good idea to print these automatically (if they exist) in
print.htest?

* In src/unix/system.c, one `Rdata' should be `RData' (d -> D).

* No methods for as.data.frame exist!

* How can I return from browser()?
return() does not seem to work for me!

* TASKS has

TASK:	abline + coefficients
STATUS:	Closed
FROM:	<nobu@psrc.isac.co.jp>
	I found a little different behavior of R with S.
	at R-0.49:
	    > a
	    [1] 12 23 22 34 44 54 55 70 78
	    > plot(a)
	    > abline(lsfit(seq(1,len=length(a)), a))
	    Error: no applicable method for "coefficients"
	at S (from AT&T '92) result draw coefficient line without error.
	Then I think to need define a function as followed:
	    coefficients.default <- function(x) x$coef
	[ Default method already added for Doug Bates. ]

For me, this produces no error but abline does not produce any output
for me.  Can anyone check/confirm this?

See also

TASK:	"abline" incompatibility
STATUS:	Open
FROM:	<nobu@psrc.isac.co.jp>

and the 

* TASKS has

TASK:	ls.print
STATUS:	Open
FROM:	<maechler@stat.math.ethz.ch>
	Yes, I do confirm that the  Help page  (?NCOL) contains  '.COL'.
	Apply the following patch (to doc2ms) in  $RHOME/etc , and "all
	is well":

This seems to be fine now.  Martin?

* The ls.print problem reported by <VENKAT@biosta.mskcc.org> seems to be
gone now.  (Still labeled as Open in TASKS).

* Some of the "formula" problems in TASKS (<mikem@stat.cmu.edu>, 
<p.dalgaard@kubism.ku.dk> and <thomas@biostat.washington.edu> seem to be
gone now.

* Several of the graphics patches sent by
<kovac@figaro.stats.bris.ac.uk> (labeled Open in TASKS) seem to have
been taken care of already, in particular by integrating Martin's
patches.  Martin?

* As a remark on

TASK:	String length problems
STATUS:	Closed
FROM:	<maechler@stat.math.ethz.ch>
	This is not a  cat(.) but a  string storing/parsing problem:
	nchar("\n\n")  # gives  2  instead of 3
	[ Hmmm.  Was this typed to readline I wonder?  There it  ]
	[ seems that ^L must be escaped with ^V.  Using the ANSI ]
	[ \f will now produce a literal formfeed.  Indeed, using ]
	[ any of the ANSI C escapes will work.			 ]

note that under ESS pre 4.9,

	R> nchar("\n\n")

	[1] 2

(empty line in between!), so "^L" needs to be escaped here too.  (Same
for single quotes.)

* TASKS has

TASK:	Documentation Nit
STATUS:	Closed
FROM:	<Kurt.Hornik@ci.tuwien.ac.at>
	The documentation for ls/objects has
		ls(name, pos=2, envir=sys.frame(sys.parent()),
		   all.names=FALSE, pattern)
	but the code has
		ls <-
		function (name, pos = -1, envir = NULL,
			  all.files = FALSE, pattern)
	[ At one time these were equivalent.  Are they still? ]

However, the documentation is still unchanged!

* Re 

TASK:	"cat" problem
STATUS:	Closed
FROM:	<hornik@ci.tuwien.ac.at>
	* cat() is a bit inconsistent:

	...

	[ This is the way S does it! ]

Yes, I know that the current behavior is how S does it.  Still, there
are situations (as e.g. in the code for write.table) where I'd like to
have the different behavior.  Could we have an extra option to cat()
which suppresses a final newline even if sep contains a newline?

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

	R> x <- 1:5
	R> x
	[1] 1 2 3 4 5
	R> i <- c(F, T)
	R> x[i]
	Error: invalid subscript type
	R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

	R> x[-6]
	Error: subscript out of bounds

* There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

	R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
	R> f
	[1] a a b
	R> codes(f)
	[1] 1 1 2
	R> levels(f)
	[1] "a" "b" "c"

which gives e.g.

	R> tapply(rep(1, length(f)), f, sum)
	Error: names attribute must be the same length as the vector

One solution is to replace

	namelist[[i]] <- levels(index)

by

	namelist[[i]] <- unique(levels(index)[index])

but perhaps there is something smarter ...

* The `shortest program to produce a segfault' now gives:

	R> t(table(1))
	Error: dimnames: number of dimensions must equal number of names

(See Peter's mail for the consecutive deparse warnings ...)

* Please add

	family.lm <- function (object) { gaussian() }

to the base library.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 17:08:44 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 09:08:44 -0700 (PDT)
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970725090507.3738B-100000@zen>


There is a bug in image() which I think I reported before but which isn't
in TASKS.  The little rectangles it draws don't quite meet up in the
vertical direction if an image is drawn in x11() and then printed using
save.plot().

Looking at the code I can't see how this could possibly happen, and it
didn't happen in the interpreted version, but it might be worth putting in
an overlap of 1% or so to stop it. 

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 17:12:41 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 09:12:41 -0700 (PDT)
Subject: R-alpha: Re: R-beta: R 0.50 alpha
In-Reply-To: <199707251602.SAA13750@hypatia.math.ethz.ch>
Message-ID: <Pine.SUN.3.95.970725090903.3738C-100000@zen>

On 25 Jul 1997, Ennapadam Venkatraman wrote:

> Autoloading of libraries doesn't seem to work: 
This is strange.  The autoloading works for me (on Linux).

> 
> The coxph function the the library survival4 doesn't seem to work. It just
> crashes R. See the example below:

I get a seg fault on calls to some, but not all, compiled routines.  For
example, it happens with both the right-censored and counting process
fitting routines in survival4 and with the Cgee code, but not with ace,
avas, as.date  or the Kaplan-Meier fits in survival4.  I'm trying to find
out why.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 19:45:57 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 11:45:57 -0700 (PDT)
Subject: R-alpha: new version
In-Reply-To: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970725113626.3738E-100000@zen>

I have traced down the segfault that Venkat and I reported with C
routines. It is in S_alloc, which explains why only some routines cause
problems.

The problem is that size is declared but never set, resulting in
(xxgdb) print size
$10 = 1081754432

I don't know precisely what is happening here but my guess is that we
should have size=nelem*eltsize/sizeof(char). 

(Q: Is it necessary or even true that eltsize/sizeof(char) is always an
integer?) 

char *S_alloc(long nelem, int eltsize)
{
	unsigned int i, size;
	char *p = R_alloc(nelem, eltsize);
	for(i=0 ; i<size; i++)
		p[i] = 0;
	return p;
}


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 21:44:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 13:44:54 -0700 (PDT)
Subject: R-alpha: errors in batch mode
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970725134337.3738G-100000@zen>


Errors in batch mode no longer cause a stack imbalance but they do cause
execution to be halted.  Is this a feature?  It makes it harder to run
test code on new releases.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 21:54:28 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 13:54:28 -0700 (PDT)
Subject: R-alpha: help processing
In-Reply-To: <Pine.SUN.3.95.970725134337.3738G-100000@zen>
Message-ID: <Pine.SUN.3.95.970725134816.3738H-100000@zen>


On Solaris (and presumably other System V Unices), the default buffer
length for m4 is only 4096 characters. This limits the length of
ARGUMENTS() or VALUES() in help files. survfit.coxph overflows this limit. 

Adding the option -B 8192 to m4 in the etc/doc2* files fixes this.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 23:53:34 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 15:53:34 -0700 (PDT)
Subject: R-alpha: autoload
In-Reply-To: <Pine.SUN.3.95.970725113626.3738E-100000@zen>
Message-ID: <Pine.SUN.3.95.970725154855.3738I-100000@zen>


You can use the new delay() function to implement autoloading of libraries
or source files.  Functions autosource() and autoload() follow, together
with examples.  autoload("coxph","survival4") creates a promise to
evaluate autoloader("coxph","survival4"), which in turn calls
library(survival4), removes the promise, and evaluates "coxph" in the
newly created environment.  I was somewhat surprised that it worked.

	-thomas


 autosource<- function (name, file) 
{
        newcall <- paste("delay(autosourcer(\"", name, "\",\"", file, 
                "\"))", sep = "")
        assign(name, parse(text = newcall), env = .GlobalEnv)
}
 autosourcer <- function (name, file) 
{
        eval(parse(text = paste("source(\"", file, "\")", sep = "")), 
                .GlobalEnv)
        eval(as.name(name), sys.parent())
}



 autoload<- function (name, file) 
{
        newcall <- paste("delay(autoloader(\"", name, "\",\"", file, 
                "\"))", sep = "")
        assign(name, parse(text = newcall), env = .GlobalEnv)
}
 autoloader <- function (name, file) 
{
	name<-paste(name,"",sep="")
	rm(list=name,envir=sys.frame(sys.parent()),inherits=TRUE)
        eval(parse(text = paste("library(\"", file, "\")", sep = "")), 
                .GlobalEnv)
        eval(as.name(name), pos.to.env(2))
}


autosource("gee",system.file("library","gee"))
autoload("coxph","survival4")
y<-rnorm(100)
x<-rnorm(100)
g<-sort(rep(1:10,10))
tt<-1:10
cc<-rep(1,10)
xx<-rnorm(10)
substitute(gee)
substitute(coxph)
gee(y~x,g)
coxph(Surv(tt,cc)~xx)
q("no")




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Jul 26 00:46:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 16:46:03 -0700 (PDT)
Subject: R-alpha: .Libraries
In-Reply-To: <Pine.SUN.3.95.970725154855.3738I-100000@zen>
Message-ID: <Pine.SUN.3.95.970725164456.4219A-100000@zen>


The old way of keeping track of which libraries are loaded was with the
variable .Libraries.  It is still there, but it isn't updated when
libraries are detached.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Arne Kovac <maak@stats.bris.ac.uk>  Sun Jul 27 04:15:01 1997
From: Arne Kovac <maak@stats.bris.ac.uk> (Arne Kovac)
Date: Sun, 27 Jul 1997 03:15:01 +0000 (GMT)
Subject: Lost comments (was Re: R-alpha: New version of R for testing)
Message-ID: <Pine.LNX.3.95.970727031430.9276A-100000@ts1.bris.ac.uk>

On Wed, 23 Jul 1997, Ross Ihaka wrote:

>  o  Comments are handled better in functions.  The rule is that they
>     are shifted to just before their statements.  Comments after the
>     last statement of a function are lost.

More generally each comment between the last statement of a block and its
closing bracket is lost!! I wonder if this is really an advantage: I just
"uncommented" a line for test purposes to see some minutes later that I
had to retype it again. :-(

> dummy<-
+ function () 
+ {
+         for (i in 1:3) {
+                 print(1)
+                #print(2)
+         }
+         More()
+         Commands()
+ }
> dummy
function () 
{
        for (i in 1:3) {
                print(1)
        }
        More()
        Commands()
}

Arne Kovac

-- 
Arne Kovac
School of Mathematics           Phone: +44 (0117) 942 7551
University of Bristol           A.Kovac@bristol.ac.uk    
University Walk                 http://www.stats.bris.ac.uk/~maak
Bristol, BS8 1TW, U.K.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Jul 27 05:03:49 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 27 Jul 1997 16:03:49 +1200 (NZST)
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2g1t4gox8.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2g1t4gox8.fsf@bush.kubism.ku.dk>
Message-ID: <199707270403.QAA12146@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
 > 
 > > NEW FEATURES
 > > 
 > >  o  "expressions" are now implemented as a basic type rather than as
 > >     a class of object.  This change was made as move toward compatibility
 > >     with S and also to implement mathematical annotation in graphs.
 > 
 > Something looks wrong:
 > 
 > > expression(2+2)
 > expression(2 + 2)
 > > expression(2+2)[[1]]
 > expression(2 + 2)
 > > expression(2+2)[[1]][[1]]
 > expression(2 + 2)
 > 
 > - How the blazes is a poor soul supposed to get at the parse tree for
 > an expression? According to the docs, an expression is supposed to be
 > a list of calls, but obviously

Oops sorry.  Incomplete implementation.  I have a fix for this now as
will as fixes for mutations of expressions of the form

	> e <- expression(x+y)
	> e[[1]][[1]] <- as.name("f")

I hope to have patches and an "a2" release later this week.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Jul 27 05:19:47 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 27 Jul 1997 16:19:47 +1200 (NZST)
Subject: R-alpha: Mathematical Anotation in Plots
Message-ID: <199707270419.QAA12212@stat1.stat.auckland.ac.nz>

I forgot to mention that version 0.50 will do "greek" and "accents" in
plot labels.  The basic idea is that you should be able to replace any
character vector by an expression vector when doing plot annotation.

E.g.
	plot(rnorm(10),main=expression(hat(Theta)))

This produces a plot with a main title consisting of a capital Theta
with a "hat" on it.  The idea is to use R parse trees to represent
mathematical expressions.

Most things are as you would expect, with the following exceptions:

 o  ^ is used for superscripting and [] for subscripting so that
    x[i]^2 is the equivalent of the TeX x_i^2.

 o  you use over(x,y) for a fraction with x in the numerator and y
    in the denominator.

 o  the *" operator is used to denote juxtaposition. sometimes this
    makes sense - e.g. x*e^{x/lambda}, and sometimes it is a bit ugly
    e.g. "Distribution of "*hat(Theta). I haven't thought of a
    better solution (yet).

This is a very immature implementation, but you might enjoy playing
with it.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Jul 27 19:07:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jul 1997 20:07:06 +0200
Subject: R-alpha: Environment strangeness
Message-ID: <x290ys1i9h.fsf@bush.kubism.ku.dk>

Maybe I'm just not understanding things well enough (actually, that's
why I was fooling around with this in the first place), but:

> g
function () 
{
        e <- sys.frame(sys.parent())
        print(ls(envir = e))
        eval(print(b), e)
}
> f
function () 
{
        b <- 7913
        g()
}
> f()
[1] "b"
Error: Object "b" not found

Er? Is "b" in environment "e" or not?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: new functions
Message-ID: <199707281323.PAA18631@aragorn.ci.tuwien.ac.at>

The following two functions might be worth adding to the distribution:

**************************************************************
as.ordered <- function(x) { 
  if (is.ordered(x)) x else ordered(x)
}

data.class <- function(x) {
  if (length(cl <- class(x)))
    cl[1]
  else {
    l <- length(dim(x))
    if (l == 2)
      "matrix"
    else if (l > 0)
      "array"
    else
      mode(x)
  }
}
**************************************************************

Re data.class:  Couldn't we introduce a "matrix" and an "array" class
right away?  (I already asked this once).  The functions for creating or
coercing such objects could easily add the corresponding class
attribute ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R 0.50.a1 problems with lm/glm methods
Message-ID: <199707281323.PAA18639@aragorn.ci.tuwien.ac.at>

Thanks for fixing formula() and update().

Here are some open problems.

* effects:

** There is no help available for effects()

** The lm() help page has effects(lm.obj), but from the code it is clear
that the one-arg version cannot work.

Shouldn't it simply return z$effects?

** The two-arg version only works for factors (?) ... otherwise,
	z$model.frame[factors & pattern != 0]
gives an error.  Can someone explain to me what this is doing?

* plot:

There should be a plot.lm() function which reports that useful
diagnostic plots have not been implemented yet.

Perhaps we should do something like

	unimplemented <- function () {
		stop("Not implemented yet ... sorry.")
	}

	plot.lm <- function (...) unimplemented()
	plot.glm <- function (...) unimplemented()

and similarly for other stuff which is known to be missing?  (This would
also help improving the TASK handling :-))

* predict:

** There is no help available for predict()

** The one-arg version of predict.default() cannot work.  For objects
of class "lm", it should simply return the fitted values, right?

** The two-arg version of predict.default() cannot work because no
fitted object has a "covmat" component.  Anyway, shouldn't the general
form be something like
	predict(object, newdata, ...)
???

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 segfault
Message-ID: <199707281323.PAA18655@aragorn.ci.tuwien.ac.at>

Perhaps not the shortest way, but ...

**************************************************
R> x <- data.frame(x = 3:5, y = 5:7)
R> rownames(x) <- 1:3 
R> x
  x y
1 3 5
2 4 6
3 5 7
R> mode(x) <- "character"
Segmentation fault
**************************************************

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: R 0.50.a1 suggestion
Message-ID: <199707281323.PAA18629@aragorn.ci.tuwien.ac.at>

Could we introduce a library hierarchy in the `data' directory?  The
standard stuff would then go into `data/base', and if add-ons have their
own data (examples!), these would go into a corresponding subdir of
`data'.

Only three small changes would be necessary:

1. In `data', create a `base' subdir and move all data files there.

2. Replace `cmd/filename' by the version below:

*********************************************************************
#!/bin/sh

for file in $HOME/lib/R/$1/$2 \
            $RHOME/$1/$2 \
            $RHOME/$1/[^.]*/$2;
do
    if [ -r $file ]
    then
	echo $file
	break
    fi
done

if [ ! -r $file ]
then
    echo
fi
*********************************************************************

3. In src/library/LIBSETUP.in, add

*********************************************************************
        if test -d ${lib}/data
        then
                mkdir -p ../../data/${lib}
                cp ${lib}/data/* ../../data/${lib}
        fi
*********************************************************************

before the final `done'.

We've been using the above filename script for a very long time now,
without any problems ...

Please ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R-0.50.a1:  buglet in lsfit()
Message-ID: <199707281323.PAA18653@aragorn.ci.tuwien.ac.at>

I just discovered why
	abline(lsfit(x, y))
does not produce any output (as I mentioned on Friday).  In lsfit(), the
coefficients output component was incorrectly named "coef" and not
"coefficients", hence the coefficients method returned NULL ...

The patch below fixes the problem.

-k

************************************************************************
*** src/library/base/funs/lsfit.orig	Sat Jul 26 09:38:47 1997
--- src/library/base/funs/lsfit	Sat Jul 26 09:39:46 1997
*************** lsfit <- function(x, y, wt=NULL, interce
*** 100,106 ****
  	}
  	z$qr <- as.matrix(z$qr)
  	colnames(z$qr) <- xnames
! 	output <- list(coef=z$coefficients, residuals=resids)
  
  	# if X matrix was collinear, then the columns would have been
  	# pivoted hence xnames need to be corrected
--- 100,106 ----
  	}
  	z$qr <- as.matrix(z$qr)
  	colnames(z$qr) <- xnames
! 	output <- list(coefficients=z$coefficients, residuals=resids)
  
  	# if X matrix was collinear, then the columns would have been
  	# pivoted hence xnames need to be corrected
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:46 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:46 +0200
Subject: R-alpha: R 0.50.a1 S_alloc BUG, priority = URGENT
Message-ID: <199707281323.PAA18627@aragorn.ci.tuwien.ac.at>

The current version of S_alloc in src/main/memory.c is

char *S_alloc(long nelem, int eltsize)
{
	unsigned int i, size;
	char *p = R_alloc(nelem, eltsize);
	for(i=0 ; i<size; i++)
		p[i] = 0;
	return p;
}

which segfaults because `size' is not initialized.  I am not what the
right fix is, adding

	size = nelem * eltsize;

before the loop seems to work.

As an aside ... I think the seed* functions in S are called

	seed_in
	seed_out

and not seeds_in and seeds_out as currently in src/main/random.c.

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 unlist() problems
Message-ID: <199707281323.PAA18658@aragorn.ci.tuwien.ac.at>

Two things.

TASKS has

TASK:	Naming with Numeric Values and "unlist"
STATUS:	Open
FROM:	<hornik@ci.tuwien.ac.at>
	R> l <- list("11" = 1:5)
	R> l
	$11
	[1] 1 2 3 4 5
	R> unlist(l)
	111 112 113 114 115 
	  1   2   3   4   5 
	[ Bug or feature ? ]

This seems to be a feature (at least, SPLUS does the same), so please
close that task.

***

However, please add the following.

***********************************************************************
R> x <- rnorm(20)
R> y <- rnorm(20)
R> z <- lm(y ~ x)

R> typeof(z)
[1] "list"

R> unlist(z)
[[1]]
[1] 0.07030757

[[2]]
[1] -0.1790483

[[3]]
NULL

[[4]]
NULL

and many more ending in

[[152]]
NULL

[[153]]
NULL

[[154]]
NULL
***********************************************************************

This seems to be a BUG.  SPLUS gives

***********************************************************************
 coefficients.(Intercept)       coefficients.x         residuals.1 
 "-0.322342946956607"     "-0.351990317000716" "-1.05699395125055"
          residuals.2          residuals.3          residuals.4 
 "0.0685214529487529" "-0.825270557482947" "-0.309643367007542"
          residuals.5         residuals.6          residuals.7 
 "-0.970498865234358" "0.239072541069321" "-0.203418862242607"
           residuals.8          residuals.9        residuals.10 
 "-0.0279508657540235" "-0.546704750104556" "-1.41036201719063"
         residuals.11         residuals.12       residuals.13 
 "-0.177627379541701" "-0.159357852715235" "1.01771682562243"
***********************************************************************

etc etc

I haven't looked into the unlist code at all.  Here's another problem.

***********************************************************************
R> l <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
R> l
$a
$a[[1]]
[1] 1 2 3 4 5

$a[[2]]
[1] "A" "B" "C" "D" "E"


$b
[1] "Z"

$c
[1] NA

R> unlist(l)
INTERNAL ERROR: ans_nnames = 10    ans_length = 12
Error: incorrect names vector length
***********************************************************************

Hmm ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: R 0.50.a1 && gdb support
Message-ID: <199707281323.PAA18636@aragorn.ci.tuwien.ac.at>

Can we have gdb support?  (I don't use xxgdb.)

Perhaps in the wrapper one could add something like

*************************************************************
if [ "$1" = "-gdb" ]
then
	shift
	DEBUGGER=gdb
fi
*************************************************************

and at the end have

*************************************************************
if [ "$DEBUGGER" = "gdb" ]
then
    exec gdb $RHOME/bin/R.binary $*
else    
    exec $DEBUGGER $RHOME/bin/R.binary -v 4 $*
fi    
*************************************************************

Or is there a way to pass command line options for the program through
gdb?

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 problem
Message-ID: <199707281323.PAA18657@aragorn.ci.tuwien.ac.at>

Here's something really strange.

********************************************************
R> x <- 1:5
R> x
[1] 1 2 3 4 5

R> test1
function (x) 
{
        structure(x, call = sys.call())
}
R> test1(x)
[1] 1 2 3 4 5
attr(,"call")
test1(x)

R> test2
function (x) 
{
        attr(x, "call") <- sys.call()
        x
}
R> test2(x)
Error: stack overflow
********************************************************

Using the attr() form results in an endless loop ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R 0.50.a1:  small patches for graphics and image demo
Message-ID: <199707281323.PAA18638@aragorn.ci.tuwien.ac.at>

Applying the following patches closes the following task (part 1 was
already taken care of).

TASK:   New Problems
STATUS: Open
FROM:   <Kurt.Hornik@ci.tuwien.ac.at>
        New minor remarks:
        * The documentation for `image' still has the old order z, x, y.
        * Perhaps one should add `par(ask = T)' in the image demo?
        * Perhaps one should save the original value of par() at the
	beginning of the graphics demo, and restore that at its end
	(s.t. typically asking is turned off again).

Thanks,
-k

************************************************************************
*** demos/graphics/graphics.orig	Sat Jul 26 10:40:03 1997
--- demos/graphics/graphics	Sat Jul 26 10:37:50 1997
***************
*** 1,5 ****
  ###-*- R -*-
! par(ask = interactive() && .Device == "X11")	# For source
  
  # Here is some code which illustrates some of the differences between
  # R and S graphics capabilities.  Note that colors are generally specified
--- 1,6 ----
  ###-*- R -*-
! 
! opar <- par(ask = interactive() && .Device == "X11")	# For source
  
  # Here is some code which illustrates some of the differences between
  # R and S graphics capabilities.  Note that colors are generally specified
*************** data("volcano")
*** 115,121 ****
  x <- 10*1:nrow(volcano)
  y <- 10*1:ncol(volcano)
  l <- pretty(range(volcano), 10)
! opar <- par(bg="lightcyan")
  pin <- par("pin")
  xdelta <- diff(range(x))
  ydelta <- diff(range(y))
--- 116,122 ----
  x <- 10*1:nrow(volcano)
  y <- 10*1:ncol(volcano)
  l <- pretty(range(volcano), 10)
! par(bg="lightcyan")
  pin <- par("pin")
  xdelta <- diff(range(x))
  ydelta <- diff(range(y))
*************** mtext("10 Meter Contour Spacing", side=3
*** 141,144 ****
--- 142,146 ----
  par(bg="cornsilk")
  data(quakes)
  coplot(long~lat|depth, data=quakes, pch=21, bg="green3")
+ 
  par(opar)
*** demos/graphics/image.orig	Sat Jul 26 10:40:07 1997
--- demos/graphics/image	Sat Jul 26 10:41:46 1997
***************
*** 1,4 ****
--- 1,7 ----
  #### -*- R -*-
+ 
+ opar <- par(ask = interactive() && .Device == "X11") # For source
+ 
  data(volcano)
  x <- 10*(1:nrow(volcano))
  y <- 10*(1:ncol(volcano))
*************** axis(2, at=seq(100, 600, by=100))
*** 30,32 ****
--- 33,36 ----
  box()
  title(main="Maunga Whau Volcano", font.main=4)
  
+ par(opar)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:46 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:46 +0200
Subject: R-alpha: R 0.50.a1:  patch for NChisquare documentation
Message-ID: <199707281323.PAA18624@aragorn.ci.tuwien.ac.at>

The patch below fixes the NChisquare documentation problem that I've
been mentioning for some time now.

NOTE:  There is one DEQN where the LaTeX part contains real LaTeX code,
because I did not see how to get a sum sign (and a roman math font)
otherwise.  Seems to work, though ... MARTIN?

-k

**********************************************************************
*** src/library/base/man/NChisquare.orig	Sat Jul 26 10:50:54 1997
--- src/library/base/man/NChisquare	Sat Jul 26 11:26:23 1997
***************
*** 1,26 ****
  TITLE(NChisquare @@ The Non-Central Chi-Square Distribution)
  USAGE(
! dnchisq(x, df)
! pnchisq(x, df)
! qnchisq(x, df)
! rnchisq(x, df)
  )
  ALIAS(dnchisq)
  ALIAS(pnchisq)
  ALIAS(qnchisq)
  ALIAS(rnchisq)
  DESCRIPTION(
! These functions provide information about the non-central
! chi-square distribution with LANG(df) degrees of freedom.
! LANG(dnchisq) gives the density, LANG(pnchisq) gives the
! distribution function LANG(qnchisq) gives the quantile
  function and LANG(rnchisq) generates random deviates.
  PARA
! The non-central chi-square distribution with EQN(n)
! degrees-of-freedom has density
! DEQN(f(x) =
! OVER(1 @@ SUP(2@@n/2) greekGamma (n/2))
! SUP(x@@n/2-1) SUP(e@@-x/2)
! @@f(x) = 1 / (2^(n/2) Gamma(n/2))  x^(n/2-1) e^-x/2)
  for EQN(x GE 0).
  )
--- 1,28 ----
  TITLE(NChisquare @@ The Non-Central Chi-Square Distribution)
  USAGE(
! dnchisq(x, df, lambda)
! pnchisq(x, df, lambda)
! qnchisq(x, df, lambda)
! rnchisq(x, df, lambda)
  )
  ALIAS(dnchisq)
  ALIAS(pnchisq)
  ALIAS(qnchisq)
  ALIAS(rnchisq)
  DESCRIPTION(
! These functions provide information about the non-central chi-square
! distribution with LANG(df) degrees of freedom and non-centrality
! parameter LANG(lambda).  LANG(dnchisq) gives the density, LANG(pnchisq)
! gives the distribution function LANG(qnchisq) gives the quantile
  function and LANG(rnchisq) generates random deviates.
  PARA
! The non-central chi-square distribution with EQN(df) degrees of freedom
! and non-centrality parameter EQN(greeklambda) has density
! DEQN(f(x) = SUP(e @@ -\lambda / 2)
!   \sum_{r=0}^\infty \frac{\lambda^r}{2^r r!} \mathrm{pchisq}(x, df + 2r) 
!   @@
!   f(x) = exp(-lambda/2) SUM_{r=0}^infty (lambda^r / 2^r r!)
!   pchisq(x, df + 2r)
! )
  for EQN(x GE 0).
  )
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Jul 28 20:24:45 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 28 Jul 1997 21:24:45 +0200
Subject: R-alpha: R 0.50.a1 problem
In-Reply-To: Kurt Hornik's message of Mon, 28 Jul 1997 15:23:49 +0200
References: <199707281323.PAA18657@aragorn.ci.tuwien.ac.at>
Message-ID: <x2bu3nj7ya.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> R> test2
> function (x) 
> {
>         attr(x, "call") <- sys.call()
>         x
> }
> R> test2(x)
> Error: stack overflow
> ********************************************************
> 
> Using the attr() form results in an endless loop ...

Sounds familiar. The "assignment causes evaluation effect". Hey,
here's an amusing variant:

> fff<-function(){cll<-substitute(ls());print(cll);x<-1;
attr(x,"junk")<-cll;x}
> fff
function () 
{
        cll <- substitute(ls())
        print(cll)
        x <- 1
        attr(x, "junk") <- cll
        x
}
> fff()
ls()
[1] 1
attr(,"junk")
[1] "*tmp*" "cll"   "x"    
> fff
function () 
{
        cll <- substitute(ls())
        print(cll)
        x <- structure(1, junk = c("*tmp*", "cll", "x"))
        attr(x, "junk") <- cll
        x
}
> 

...I know that R is a functional programming language and that
functions can write and modify other functions, but this seems to be
overdoing it a bit, donchathinkso <evil grin>? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Tue Jul 29 10:28:50 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
Subject: R-alpha: Bugs in R-0.50-a1.
Message-ID: <9707290928.AA07210@alpha.luc.ac.be>

Problems in R but not in S:
---------------------------

1) 'unlist' seems to have several other problems than the ones
reported up to now. For instance, 'unlist' can be used on almost any
object in S without much trouble. Eg.:
	S> unlist(c(2))
	[1] 2
	S>
	---
	R> unlist(c(2))
	Segmentation fault (core dumped)
This occurs in R-0.49 and in R-0.50-a1.

2) Problem with the parser: When a function contains a condition
between brackets the closing bracket must be adjacent to the last item
in R but not in S. Here is an example:
	S> new <- function (x,y,z,k) {
	S+ message <- list(x,y,a=if(z) k
	S+ )
	S+ message
	S+ }
	S>
	---
	R> new <- function (x,y,z,k) {
	R+ message <- list(x,y,a=if(z) k
	R+ )
	)
	^
	Error: syntax error
	R> 
This occurs in R-0.49 and in R-0.50-a1.


Problems in R:
--------------

1) The 'R Graphics' window does not have any X class or resource and
therefore cannot be given a default size or geometry. Would it be
possible to give the graphic window a class name so that the size
could be specified in the '.Xdefaults' file?

2) It does not appear to be possible to specify the 'xlim' when using
boxplot. This might also be the case in S but would be nice to
have. Eg., when plotting several boxplots together, lets say 7. One
would generally plot 4 first and then 3. Hence, if they are fitted on
the same page the boxplots of the first line will be wider than on the
second...

3) Some problems occur when using the help. Eg.,
R> ?"+"
sorry, no help for "Arithmetic".
R>
This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
any item contained in a help file starting with a capital letter.

4) The option 'right' when using print gives an error. In S,
'print.default' calls 'print.structure' and then 'print.matrix'. This
last one allows this option. Can anything be done as 'print.default'
is internal in R?

5) The control-c still does not work on R-0.50-a1 under certain
variants of Linux. What is the easiest way to fix this?

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jul 29 12:31:39 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Jul 1997 13:31:39 +0200
Subject: R-alpha: Bugs in R-0.50-a1.
In-Reply-To: Patrick Lindsey's message of Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
References: <9707290928.AA07210@alpha.luc.ac.be>
Message-ID: <x2u3hegkmc.fsf@bush.kubism.ku.dk>

Patrick Lindsey <plindsey@luc.ac.be> writes:

> 5) The control-c still does not work on R-0.50-a1 under certain
> variants of Linux. What is the easiest way to fix this?

Upgrade the readline library to v.2.1 and relink (for some reason that
I never figured out, this installs as libreadline.so.3.0, unless you
specifically tell it otherwise), RedHat has an RPM package in the
contrib section. Debians package is the newer one.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Ben Bolker <ben@eno.Princeton.EDU>  Tue Jul 29 16:58:08 1997
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 29 Jul 1997 11:58:08 -0400 (EDT)
Subject: R-alpha: more graphics: lwd, persistent lty settings
Message-ID: <Pine.SUN.3.95.970729114304.26114A-100000@paca>


  [ SunOS 4.1.3, R-0.50-a1; I'm mostly very pleased, I haven't been
pounding on it as hard as some folks have ]
 
   par(lwd) seems to be a bit of a stub right now; I wouldn't necessarily
expect it to do anything in the x11() driver (nor would I know how to fix
it), but it would be nice in the postscript driver (e.g. for thick lines
for things to be made into slides).
   I will try to work on this, but I wouldn't mind if someone got there
before me.

  Also: the effects of setting lty are sometimes unnecessarily persistent
-- for example in the example below the box around the legend is drawn in
line type 2 (dashed) -- I would think that the GSavePars/GRestorePars
calls at the beginning and end of abline (in plot.c) ought to do the job,
but I haven't had time to go through it in detail ... 

x _ (1:100)/10
plot(x,sin(x))
abline(h=0,lty=2)
legend(0,-0.1,"a",pch=1)


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Jul 29 21:45:10 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Jul 1997 08:45:10 +1200 (NZST)
Subject: R-alpha: stat.auckland.ac.nz
Message-ID: <199707292045.IAA07780@stat1.stat.auckland.ac.nz>

The R anon-ftp site at stat.auckland.ac.nz is currently out of action.
We are in the throws of upgrading from a tired old SparcServer 10 to a
new Sun Enterprise Server.  Normality should be restored within the
next couple of days.

The good news is that we can configure and compile R in rather less
than a minute.  This should help the development process.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Jul 30 00:58:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Jul 1997 11:58:14 +1200 (NZST)
Subject: R-alpha: R-beta: RPM package for R
In-Reply-To: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
References: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
Message-ID: <199707292358.LAA18350@stat1.stat.auckland.ac.nz>

Martyn Plummer writes in r-announce:
 > A precompiled "RPM" binary of R-0.50.a1 is now available on CRAN for
 > installation on Linux systems which use the RedHat Package
 > Manager

Before we get to may versions floating about ... 

I had intended that these "a1", "a2" ... releases be hacker releases
which will be followed by a R-0.50.stable release when the (worst)
problems are sorted out.  Thats why I announced to "r-devel" rather
than "r-announce".

(Note this is information rather than any kind of policy statement,
you are of course free to do whatever you like with R)
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Wed Jul 30 02:29:54 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 30 Jul 1997 13:29:54 +1200 (NZST)
Subject: R-alpha: Environment strangeness
Message-ID: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>

Peter Dalgaard asked about environments,

----- Begin Included Message -----

 
Maybe I'm just not understanding things well enough (actually, that's
why I was fooling around with this in the first place), but:

> g
function()
{
	e<-sys.frame(sys.parent())
	print(ls(envir=e))
	eval(print(b), e)
}
> f
function () 
{
        b <- 7913
        g()
}
> f()
[1] "b"
Error: Object "b" not found

Er? Is "b" in environment "e" or not?

 
----- End Included Message -----

Ross and I have been back and forth on this one a few times already;
it's probably a faq (Kurt);
  eval evaluates an expression in an environment; 
 consider the two cases below

1)
  a<-expression(x+y)
  eval(a,e1)

2)
  eval(x+y,e1)

 Now, there is no way these can both work. It seems like the first option
is to be preferred because the second can easily be achieved by wrapping
an expression around the x+y (with the first option as the default). Used in
this manner expression is a quoting mechanism.
 eval(expression(x+y),e1) does what you want.
 If 2) is the default mechanism then there is no easy way to get 1) to work
since what we want there is the value bound to a in the environment that
eval is called from not the value of a in e1.
  So Peter's example with a small change,
g<-function() {
	e<-sys.frame(sys.parent())
	print(ls(envir=e))
	eval(expression(print(b),e)
}

will work as desired.

robert
   
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Ben Bolker <ben@eno.Princeton.EDU>  Wed Jul 30 02:54:34 1997
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 29 Jul 1997 21:54:34 -0400 (EDT)
Subject: R-alpha: line types
Message-ID: <Pine.SUN.3.95.970729161448.26747A-100000@paca>


  Responding to my own post, after some hacking:

  To fix the behavior of the following test code (the rect()s inherit the
lty set by the previous abline())--

x _ (1:100)/10
plot(x,sin(x))
abline(h=0,lty=2,col="red")
rect(1,0,2,0.5)
abline(v=2)
rect(3,0,4,0.5)

Here are some diffs (now all I have to do is wade through and get lwd
working properly ...)

*** devX11.c.orig	Tue Jul 29 16:44:19 1997
--- devX11.c	Tue Jul 29 16:57:55 1997
***************
*** 671,676 ****
--- 671,677 ----
  	}
  	if (fg != NA_INTEGER) {
  		SetColor(fg);
+ 		SetLinetype(GP->lty);
  		XDrawRectangle(display, window, wgc, (int)x0, (int)y0,
  			(int)x1 - (int)x0, (int)y1 - (int)y0);
  	}
*** devPS.c.orig	Sun Jul  6 21:29:03 1997
--- devPS.c	Tue Jul 29 17:01:05 1997
***************
*** 433,438 ****
--- 433,439 ----
  	}
  	if(fg != NA_INTEGER) {
  		SetColor(fg);
+ 		SetLinetype(GP->lty);
  		PostScriptOpenRectangle(psfp, x0, y0, x1, y1);
  	}
  }
*** plot.c.orig	Tue Jul 29 16:43:34 1997
--- plot.c	Tue Jul 29 16:51:02 1997
***************
*** 875,880 ****
--- 875,883 ----
  
  	GSavePars();
  
+ 	if(nlty && INTEGER(lty)[i % nlty] != NA_INTEGER) GP->lty = INTEGER(lty)[i % nlty];
+ 	else GP->lty = DP->lty;
+ 
  	xl = REAL(sxl);
  	xr = REAL(sxr);
  	yb = REAL(syb);


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Jul 30 13:12:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Jul 1997 14:12:40 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: Robert Gentleman's message of Wed, 30 Jul 1997 13:29:54 +1200 (NZST)
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
Message-ID: <x2204gg2mf.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> Ross and I have been back and forth on this one a few times already;
> it's probably a faq (Kurt);
                ^^^^^

This belongs on the *manual page*. I suggest something along these
lines:

NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
get values of LANG(x) and LANG(y) looked up in the environment
LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
LANG(expr) is usually a simple variable ITALIC(containing) an
expression to evaluate or a LANG(substitute(...)) call
ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
passed to the evaluator.
)


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Wed Jul 30 15:50:05 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 30 Jul 1997 10:50:05 -0400 (EDT)
Subject: R-alpha: more on line types
Message-ID: <Pine.SUN.3.95.970730101356.8353A-100000@eno.Princeton.EDU>


   forgot to fix psx11.c and devPicTeX.c while I was at it (devPicTeX.c
doesn't seem to change the color).  Should psx11.c be devpsx11.c?  Diffs:

*** psx11.c.orig	Wed Jul 30 10:08:48 1997
--- psx11.c	Wed Jul 30 10:09:10 1997
***************
*** 293,298 ****
--- 293,299 ----
  	}
  	if(fg != NA_INTEGER) {
  		psx11_SetColor(fg);
+ 		psx11_SetLinetype(GP->lty);
  		PostScriptOpenRectangle(psfp,
  			xoffset + xscale * x0,
  			yoffset + yscale * y0,
*** devPicTeX.c.orig	Wed Jul 30 10:16:33 1997
--- devPicTeX.c	Wed Jul 30 10:11:24 1997
***************
*** 446,451 ****
--- 446,452 ----
  /* Possibly Filled Rectangle */
  static void PicTeX_Rect(double x0, double y0, double x1, double y1, int bg, int fg)
  {
+         SetLinetype(GP->lty);
  	PicTeX_MoveTo(x0, y0);
  	PicTeX_LineTo(x1, y0);
  	PicTeX_LineTo(x1, y1);

   A less trivial question about setting line widths: in X, the same call
(XSetLineAttributes) sets both line type and line width.  In PostScript
there are two separate calls.

  The following quick hack to SetLinetype() appears to work pretty well
for X11, although there may be a better way to do it (logically,
SetLinetype ought to take both lty and lwd as arguments, or there should
be a separate SetLinewidth -- however, if there were two functions each
would have to look at least briefly at the current settings so as not to
screw them up):

  Before doing this in PostScript (where the width and type are set in
separate calls), I'd like advice.
  Also, is there a particular reason that default line width in PostScript
is 0.75 and not 1.0?

*** devX11.c.orig	Tue Jul 29 16:44:19 1997
--- devX11.c	Wed Jul 30 10:21:43 1997
***************
*** 389,395 ****
  
  	if(newlty != lty) {
  		if(newlty == 0) {
! 			XSetLineAttributes(display, wgc, 1, LineSolid, CapRound, JoinRound);
  			lty = newlty;
  		}
  		else {
--- 389,395 ----
  
  	if(newlty != lty) {
  		if(newlty == 0) {
! 			XSetLineAttributes(display, wgc, GP->lwd, LineSolid, CapRound, JoinRound);
  			lty = newlty;
  		}
  		else {
***************
*** 400,406 ****
  				newlty = newlty>>4;
  			}
  			XSetDashes(display, wgc, 0, dashlist, ndash);
! 			XSetLineAttributes(display, wgc, 1,
  				LineOnOffDash, CapButt, JoinRound);
  		}
  	}
--- 400,406 ----
  				newlty = newlty>>4;
  			}
  			XSetDashes(display, wgc, 0, dashlist, ndash);
! 			XSetLineAttributes(display, wgc, GP->lwd,
  				LineOnOffDash, CapButt, JoinRound);
  		}
  	}





Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Thu Jul 31 08:34:02 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Thu, 31 Jul 1997 09:34:02 +0200 (MET DST)
Subject: R-alpha: More problems with R0.50.a1
Message-ID: <9707310734.AA26662@alpha.luc.ac.be>

More problems...

1) when -lf2c is used for linking as in the standard Makefile in
src/main, it does not include the library as shown by ldd on my
slackware linux 2.0.29 but does on RedHat linux 2.0.27. But with
slackware adding the -L/usr/lib just before -lf2c does include it. On
the other hand readline in the same directory is included both times.
(We need the f2c library for complex numbers in Richard Jones' carma
for kalman filtering which we are dynamically loading.)

2) matrix(2,nrow=3,ncol=3)[!is.na(matrix(2,nrow=3,ncol=3))]
gives a vector of nine 2's
if the matrix has row and column names, the vector has the 3 column
names completed with six NA names.

3) Robert's example on 'Environment strangeness' has 2 errors:
	- missing bracket on the second last line of his g function.
	- should not try to print before b has been retrieved from the
	  appropriate environment (on same line as above).

4) why does the following function yield errors with R scoping rules?
> p <- function () {
	b <- 123
	s()
}
> s <- function () {
	print(b)
}
> p()
Error: Object "b" not found.

5) getting the call line and saving it as an attribute:
This works:
> f <- function () {
	x <- match.call()
	print(x)
}
This recurses in an infinite loop, recalling the 'f' function each
time the "attr" line is stored in the "call" attribute of x.
> f <- function () {
	x <- 2
	print(x)
	attr(x,"call") <- match.call()
	print(attributes(x))
}

6) The following gives a error. How can this be solved?
> "[<-.newtype" <- function(...) {
	NextMethod("[<-")
}
> f <- function () {
	idx <- 2
	tmp <- matrix(3,ncol=4,nrow=4)
	class(tmp) <- "newtype"
	tmp[idx,] <- matrix(1,ncol=4,nrow=4)[2,]
}
> f()
Error: Object "idx" not found.

This did not work in R0.49 either, but does work in S..
(In R the name of the variable "idx" is passed to "[<-.newtype" in the
row and col local variable as in S it is the contents of "idx" which
are passed through.)
I had solved this for R0.49 by adding the line:
	idx <- eval(idx,sys.frame(sys.parent()))
But this does not work any more in R0.50.a1...
So I modified the line to:
        idx <- eval(expression(idx),sys.frame(sys.parent()))
but this did not change anything.
It looks as if the environments were not always retrieved properly and
that R scoping rules are not always followed. I thought that R would
be able to find any variable defined in a previous environment so that
they did not have to be passed from function to function as in S.

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 31 16:59:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 31 Jul 1997 17:59:00 +0200
Subject: R-alpha: Re: R-beta: Questions
In-Reply-To: <m0wqEgL-000FqEC@Tedistan.annex.umist.ac.uk>
 (Ted.Harding@nessie.mcc.ac.uk)
Message-ID: <199707311559.RAA25751@sophie.ethz.ch>


		(CC'ed to R-devel instead of R-help)

>>>>> "Ted" == Ted Harding <Ted.Harding@nessie.mcc.ac.uk> writes
			(on Jul 21, 1997):

    Ted> Q1: Is anyone collecting suggestions for amendments to the
    Ted> documentation (online "help" and R-Notes)? --

    Ted> Q2: (Supersedes Q1 to am unknown extent) -- or are there moves to
    Ted> bring R more in line with the documentation?

Yes to both.
Besides R & R (who collect and amend and ...),
I've also chosen to emphasize working on the on line help.
The 'R-devel' mailing list is also used to report / fix  documentation
glitches... 

You may want to have a look at the new alpha (pre)release of R 
which shows quite some improvements to documentation..
A new
	make tests
runs all the online "help" Examples

If you'd send  diffs of    src/library/base/man/... files to   R-devel,
chances are even higher
that the improvements will make it to subsequent releases..

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Jul 31 21:38:12 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 1 Aug 1997 08:38:12 +1200 (NZST)
Subject: R-alpha: More problems with R0.50.a1
Message-ID: <199707312038.IAA19799@stat1.stat.auckland.ac.nz>

Patrick,

   I can easily respond to some of the questions.
   
   2) That's the same thing S does (they don't propagate names though). There
    are many instances where coercion or subsetting causes a loss of
    dimensioning information. In this case you are asking for a subset of the
    values in x; you haven't specified a format for them so they come back as
    a vector.
   
   3) Sorry about that; I was working without cut and paste as we transferred
   to the new machine.
   
   4) b is defined in the environment created for the evaluation of p.
   The function s has as its parent the global environment (that's the
   environment that was active when s was defined). There is no value for
   b stored there hence s cannot find it. What you seem to want here
   is really dynamic scope rather than lexical scope. Dynamic scope was
   used in the early Lisp implementations but was quickly seen to be a
   mistake and I don't believe that it is used by any active languages
   (apart from people trying to fake it in Splus). 
   It's reasonably easy to tweak R to have this rather than lexical scope
   but the down side is pretty large. Imagine a more complicated system
   with a much deeper call stack; now s will grab the definition of b that
   is closest to it in the call stack; this may not be the one you want and
   it can take forever to find the problem.
   
   5) I think Ross has fixed this. At least both of the functions you gave
   run without error in the version I've got now. We will probably put up
   some patches pretty soon.
   
   6) This will take some work. I'm still unconvinced that any of this Method
   stuff deserves any effort whatsoever. It has to be a better idea to write
   a real object system rather than try to constantly patch this thing. But
   I will spend some time digging around. To see where idx has disappeared.
   
  
   robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jul  1 14:43:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 1 Jul 1997 15:43:20 +0200
Subject: R-alpha: sd2rd v0.1-3
Message-ID: <199707011343.PAA04807@aragorn.ci.tuwien.ac.at>

Thanks to Martin, there is another update of the S doc -> R doc script.
It now correctly maps .SE into SECTION.
-k

***********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-3";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

$opt_x = 0;
use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &section(0, "SECTION(Side Effects@@"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &section(0, "SECTION($word[1]@@");
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 17:33:12 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 12:33:12 -0400 (EDT)
Subject: R-alpha: bug in eigen()
Message-ID: <Pine.SUN.3.95.970701122527.2221A-100000@paca>


  I don't have time to track this down right now -- if no-one does it in
the next few days before I finish the current piece of work I will try to
find it myself.  
  R gets the wrong answer for the eigensystem of a (particular) 4x4
matrix (SunOS 4.1.4).

Running these commands:

x _ matrix(
     c(-10,   0    ,0     ,0,
         0  ,-0.3  ,0     ,0,
         1  , 0.03 ,-0.594,0.0020,
         1.2, 0.036,0.0792,-0.0176),byrow=T,ncol=4)
eigen(x)


R gives:

$values
[1] -10.2425681  -0.5515844  -0.3023825   0.1849350
 
$vectors
              [,1]        [,2]         [,3]      [,4]
[1,] -0.9881475178  0.06506841 -0.008135724 0.1387962
[2,] -0.0007232329 -0.07331061  0.993467182 0.0874528
[3,]  0.1014706558  0.95415639  0.046029849 0.2777959
[4,]  0.1151853550 -0.28280247 -0.104105822 0.9465290
 
S-PLUS 3.1 gives:

$values:
[1] -10.00000000  -0.59427468  -0.30000000  -0.01732532
 
$vectors:
           [,1]        [,2]       [,3]         [,4] 
[1,]  1.0000000  0.00000000  0.0000000  0.000000000
[2,]  0.0000000  0.00000000  1.0000000  0.000000000
[3,] -0.1062897 -0.06249770  0.1009810 -0.003466636
[4,] -0.1193683  0.00858338 -0.1557992 -0.999560734


Note that the structure of the matrix actually gives us (-10.0) and (-0.3)
for free, so the S-PLUS answer looks right.

  Even worse:

eigen(x[3:4,3:4])

  gives (R)

$values
[1] -0.604684392 -0.006915608
 
$vectors
           [,1]      [,2]
[1,]  0.9910228 0.1336929
[2,] -0.1336929 0.9910228


 (S-PLUS)
$values:
[1] -0.59427468 -0.01732532
 
$vectors:
            [,1]         [,2] 
[1,] -0.06249770 -0.003466636
[2,]  0.00858338 -0.999560734

  so it's not just some funky pivoting problem.

  Or am I doing something *really* dumb?

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 18:09:25 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 13:09:25 -0400 (EDT)
Subject: R-alpha: eigen() bug
Message-ID: <Pine.SUN.3.95.970701130757.2597A-100000@paca>


  It looks like there may be a mismatch between the library function and
the C code ... the help file for eigen() says that the function checks to
see if the matrix is symmetrix first, and passes it off to different
routines in different cases.  It looks like eigen() doesn't actually
bother to do any checking, and just *assumes* it's symmetric ...

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jul  1 18:24:22 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 1 Jul 1997 19:24:22 +0200
Subject: R-alpha: eigen() bug -- fixed in 0.50 (soon...)
In-Reply-To: <Pine.SUN.3.95.970701130757.2597A-100000@paca> (message from Ben
 Bolker on Tue, 1 Jul 1997 13:09:25 -0400 (EDT))
Message-ID: <199707011724.TAA02001@sophie.ethz.ch>

I  have learned that the bug is fixed in the next release ...
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul  1 18:33:29 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 1 Jul 1997 13:33:29 -0400 (EDT)
Subject: R-alpha: bugs generally
Message-ID: <Pine.SUN.3.95.970701132909.2633B-100000@paca>


  In the future (say after release 0.5 goes out), would it be feasible to
start a publically-accessible list of bug reports, known bugs, and
patches?  (Something like the current TASKS list, but maybe a little bit
more dynamic?)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jul  2 22:11:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 2 Jul 1997 14:11:54 -0700 (PDT)
Subject: R-alpha: R-beta: image()
In-Reply-To: <199707011343.PAA04807@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970702141038.2207A-100000@zen>


Using image() produces plots that look fine on the x11() device and in
ghostview at screen resolution but contain lots of horizontal white lines
at higher resolution. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jul  3 06:27:42 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 3 Jul 1997 07:27:42 +0200
Subject: R-alpha: bugs generally
In-Reply-To: <Pine.SUN.3.95.970701132909.2633B-100000@paca>
References: <Pine.SUN.3.95.970701132909.2633B-100000@paca>
Message-ID: <199707030527.HAA05571@aragorn.ci.tuwien.ac.at>

>>>>> Ben Bolker writes:

>   In the future (say after release 0.5 goes out), would it be feasible
> to start a publically-accessible list of bug reports, known bugs, and
> patches?  (Something like the current TASKS list, but maybe a little
> bit more dynamic?)

There has recently been some discussion regarding widening the official
developer base and the amount of people who can apply patches to the
source tree.  I think that as soon as that is worked out, we can also
start thinking about a bug management system.  What I have in mind is
something akin to the debian-bugs system.

But clearly, without a `patch management system' we cannot do that.

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul  3 16:54:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Jul 1997 17:54:51 +0200
Subject: R-alpha: plot(  pch = <character> ) is slow.. -- why ? --
Message-ID: <199707031554.RAA04752@sophie.ethz.ch>

Can anyone explain this to us :


> unlist(version)
              platform                   arch                     os 
"sparc-sun-solaris2.5"                "sparc"           "solaris2.5" 
                system                 status             status.rev 
   "sparc, solaris2.5"                 "Beta"                    "0" 
                 major                  minor                   year 
                   "0"                   "49"                 "1997" 
              language 
                   "R" 


# (The following is using  x11() and an  Ultrasparc I.
# You should decrease from '20000' if you have a slower machine):

> x <- runif(20000)

> for(i in 1:10) print(unix.time(plot(x)))
[1] 1.66 0.04 3.00 0.00 0.00
[1] 1.33 0.04 2.00 0.00 0.00
[1] 1.68 0.04 3.00 0.00 0.00
[1] 1.40 0.05 2.00 0.00 0.00
[1] 1.67 0.06 2.00 0.00 0.00
[1] 1.44 0.05 3.00 0.00 0.00
[1] 1.68 0.06 2.00 0.00 0.00
[1] 1.38 0.04 2.00 0.00 0.00
[1] 1.66 0.06 2.00 0.00 0.00
[1] 1.41 0.06 3.00 0.00 0.00
> 
> for(i in 1:10) print(unix.time(plot(x, pch='-')))
[1]  4.76  3.25 21.00  0.00  0.00
[1]  4.29  2.51 20.00  0.00  0.00
[1]  4.46  2.95 20.00  0.00  0.00
[1]  4.75  2.95 21.00  0.00  0.00
[1]  5.42  2.99 23.00  0.00  0.00
[1]  4.73  3.14 23.00  0.00  0.00
[1]  4.93  3.00 23.00  0.00  0.00
[1]  4.62  3.02 22.00  0.00  0.00
[1]  4.76  3.06 23.00  0.00  0.00
[1]  4.62  2.82 22.00  0.00  0.00
                ^^^^^
		this tells you that the DRAWING PROCESS is the slow thing.
		it takes about 10 times longer...


Why is x11 much faster in drawing pch=1 (a circle), than a simple "-" ?
Is this X11's `fault' ?

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Thomas Lumley <thomas@biostat.washington.edu>  Thu Jul  3 17:28:58 1997
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Thu, 3 Jul 1997 09:28:58 -0700 (PDT)
Subject: R-alpha: plot(  pch = <character> ) is slow.. -- why ? --
In-Reply-To: <199707031554.RAA04752@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970703091049.5412B-100000@chekov>

On Thu, 3 Jul 1997, Martin Maechler wrote:

> # (The following is using  x11() and an  Ultrasparc I.
> # You should decrease from '20000' if you have a slower machine):
> 
> > x <- runif(20000)
> 
> > for(i in 1:10) print(unix.time(plot(x)))
> [1] 1.66 0.04 3.00 0.00 0.00
> > for(i in 1:10) print(unix.time(plot(x, pch='-')))
> [1]  4.76  3.25 21.00  0.00  0.00
> 
> Why is x11 much faster in drawing pch=1 (a circle), than a simple "-" ?
> Is this X11's `fault' ?

Same thing on a Pentium Pro running Linux and displaying on a Sparcstation
10.  

It looks like X11's fault: the graphics code directly calls the X11
functions in each case, however S-PLUS does not have this slowdown.  I
would have thought the explanation was that "-" requires plotting text and
the circle is just graphics, however the square (pch=0) which is also a
simple graphic is just as slow.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Jul  3 17:42:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 3 Jul 1997 18:42:55 +0200
Subject: R-alpha: confidence interval of t.test
Message-ID: <199707031642.SAA09777@galadriel.ci.tuwien.ac.at>


Sorry if this has been discussed here before, but anyway:

The are differences between the confidence intervals of the t.test as
done by R and Splus:

*** R

R> x<-rnorm(1000)+1
R> t.text(x)
Error: couldn't find function "t.text"
R> t.test(x)

         One Sample t-test 

data:  x 
t = 31.4062, df = 999, p-value = 0 
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 0.917027 1.039261 
sample estimates:
mean of x 
 0.978144 

R> t.test(x, mu=1)

         One Sample t-test 

data:  x 
t = -0.7017, df = 999, p-value = 0.483 
alternative hypothesis: true mean is not equal to 1 
95 percent confidence interval:
 -0.08297297  0.03926111                      <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
sample estimates:
mean of x 
 0.978144 



*** Splus

> x<-rnorm(1000)+1
> t.test(x)

         One-sample t-Test 

data:  x 
t = 28.6918, df = 999, p-value = 0 
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 0.8975418 1.0293277 
sample estimates:
 mean of x 
 0.9634347

> t.test(x, mu=1)

         One-sample t-Test 

data:  x 
t = -1.0889, df = 999, p-value = 0.2764 
alternative hypothesis: true mean is not equal to 1 
95 percent confidence interval:
 0.8975418 1.0293277                    <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
sample estimates:
 mean of x 
 0.9634347



*******************


As you can See R's confidence intervals are centered around the
deviation from the null, whereas those of Splus are centered around
the observed value ... the later seems the more intuitive thing to me.

So is this a bug or feature of R (in my eyes it's a bug)?


Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul  7 14:33:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 7 Jul 1997 15:33:47 +0200
Subject: R-alpha: box( col = ..)  does not work
Message-ID: <199707071333.PAA00765@sophie.ethz.ch>

The 'col' argument does not work with  box(.)  contrary to the
documentation.
'lty' does nicely.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 10 13:17:48 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 10 Jul 1997 14:17:48 +0200
Subject: R-alpha: R-mailinglists -- "server down" scheduled for Friday, July 18 (MET)
Message-ID: <199707101217.OAA01668@sophie.ethz.ch>

It's vacation time here, so ...

Friday in 8 days, our main server will get an OS upgrade
	(Solaris 2.4 |--> 2.5.1).
This will make the  R-mailinglists fail for several hours
(or more if we are unlucky).

I hope that the next  alpha or beta release of R 
will be well BEFORE that date such that nobody will suffer from this out
time. 

[ Usual working time of the upgrade staff is 8.00 -- 17.00 (= 5pm)
  Middle-European Summer Time  ("MET DST") which is Universal Time +2(hours),
  i.e., it won't affect NZ's Friday much... ]


Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 11 16:39:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 11 Jul 1997 17:39:48 +0200
Subject: R-alpha: wishlist
Message-ID: <199707111539.RAA01670@aragorn.ci.tuwien.ac.at>

Here's something which could go on the TODO list:  give scan() the
ability to also read in fixed-width format data files, e.g. with an
optional `widths' argument as in S-PLUS.
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jul 14 15:24:07 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 14 Jul 1997 16:24:07 +0200
Subject: R-alpha: <primitive>  vs .Internal(.) [was "Problem with `rpois'"]
In-Reply-To: <m3u3i4mg2g.fsf@sade.uio.no> (fredrigl@math.uio.no)
Message-ID: <199707141424.QAA00881@sophie.ethz.ch>

This is more a `request for comment' than anything else.

>>>>> "Fredr" == Fredrik Glockner <fredrigl@math.uio.no> writes:

    Fredr> There is a problem with `rpois'.  It does seem to take care
    Fredr> about the order of the arguments.  This is an example:

    >> rpois(n=1,lambda=2)
    Fredr> [1] 3
    >> rpois(lambda=2,n=1)
    Fredr> [1] 2 0

    Fredr> It obviously uses the first argument as the number of samples to
    Fredr> be drawn, which is wrong.

    Fredr> I used Version 0.49 Beta (April 23, 1997).

I assume that all you R-devel'ers thought something like

	"Well yes, we know this is because 'rpois' is a primitive function
	and  R&R  once had this problem on their  TODO / TASKS list ".

However, there was no answer going through  R-help or even CC'ed to
R-devel.

I've been think about this dilemma a little bit myself,
have looked at		main/names.c    a little bit,
and ``concluded'' (i.e. "wildly guessed")
that

	i. a) <primitive> functions must be somewhat more efficient than
		.Internal(foo(..)) ones.
           
	   b) How much more efficient? [CPU / memory] ??

	
	ii. From the point of view of the
			``robust / portable / defensive'' programming paradigm
	    it is really quit undesirable to have these <primitive>
	    functions.
	    R programmers have no reliable way of finding out the argument
	    specifications of these functions, unless by searching for the
	    corresponding "do_FOO" function and reading it's C code.

	    I know there's  help(.)   and yes, this helps (!) -- but still....
	  
	    The above <bug report> of   Fredrik  is really are reason for using
	    "proper" (non-primitive) R functions as much as possible. 

	iii.   ????
		    <<< The things  Ross and Luke and ?? will tell us.
	
--
In summary, my proposal is to use   <primitive>s  much less than currently.
But I'm more than willing to learn why this would not be a good idea.

Finally:

I've spent 2 hours or so to wade through the  probability distribution
codes and 'patch' all these functions such as to use  
	function(..) .Internal(..)
code instead of being primitve.

The following patch applies cleanly .. and seems to do just what I want.
Of course, it solves Fredrik's problem.

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/


--- src/library/base/funs/distn.~1~	Mon Nov 25 11:42:00 1996
+++ src/library/base/funs/distn	Mon Jul 14 15:52:55 1997
@@ -42,3 +38,49 @@
 qweibull <- function(p, shape, scale=1) .Internal(qweibull(p, shape, scale))
 rweibull <- function(n, shape, scale=1) .Internal(rweibull(n, shape, scale))
 
+
+##--- Argument names taken from  ../man/Beta :
+dbeta <- function(x, a, b) .Internal(dbeta(x, a, b))
+pbeta <- function(q, a, b) .Internal(pbeta(q, a, b))
+qbeta <- function(p, a, b) .Internal(qbeta(p, a, b))
+rbeta <- function(n, a, b) .Internal(rbeta(n, a, b))
+##--- Argument names taken from  ../man/Binomial :
+dbinom <- function(x, n, p) .Internal(dbinom(x, n, p))
+pbinom <- function(q, n, p) .Internal(pbinom(q, n, p))
+qbinom <- function(prob, n, p) .Internal(qbinom(prob, n, p))
+rbinom <- function(nobs, n, p) .Internal(rbinom(nobs, n, p))
+##--- Argument names taken from  ../man/Chisquare :
+dchisq <- function(x, df) .Internal(dchisq(x, df))
+pchisq <- function(q, df) .Internal(pchisq(q, df))
+qchisq <- function(p, df) .Internal(qchisq(p, df))
+rchisq <- function(n, df) .Internal(rchisq(n, df))
+##--- Argument names taken from  ../man/F :
+df <- function(x, n1, n2) .Internal(df(x, n1, n2))
+pf <- function(q, n1, n2) .Internal(pf(q, n1, n2))
+qf <- function(p, n1, n2) .Internal(qf(p, n1, n2))
+rf <- function(n, n1, n2) .Internal(rf(n, n1, n2))
+##--- Argument names taken from  ../man/Geometric :
+dgeom <- function(x, p) .Internal(dgeom(x, p))
+pgeom <- function(q, p) .Internal(pgeom(q, p))
+qgeom <- function(prob, p) .Internal(qgeom(prob, p))
+rgeom <- function(n, p) .Internal(rgeom(n, p))
+##--- Argument names taken from  ../man/Hypergeometric :
+dhyper <- function(x, N1, N2, n) .Internal(dhyper(x, N1, N2, n))
+phyper <- function(q, N1, N2, n) .Internal(phyper(q, N1, N2, n))
+qhyper <- function(p, N1, N2, n) .Internal(qhyper(p, N1, N2, n))
+rhyper <- function(nobs, N1, N2, n) .Internal(rhyper(nobs, N1, N2, n))
+##--- Argument names taken from  ../man/NegBinomial :
+dnbinom <- function(x, n, p) .Internal(dnbinom(x, n, p))
+pnbinom <- function(q, n, p) .Internal(pnbinom(q, n, p))
+qnbinom <- function(prob, n, p) .Internal(qnbinom(prob, n, p))
+rnbinom <- function(nobs, n, p) .Internal(rnbinom(nobs, n, p))
+##--- Argument names taken from  ../man/Poisson :
+dpois <- function(x, lambda) .Internal(dpois(x, lambda))
+ppois <- function(q, lambda) .Internal(ppois(q, lambda))
+qpois <- function(p, lambda) .Internal(qpois(p, lambda))
+rpois <- function(n, lambda) .Internal(rpois(n, lambda))
+##--- Argument names taken from  ../man/T
+dt <- function(x, df) .Internal(dt(x, df))
+pt <- function(q, df) .Internal(pt(q, df))
+qt <- function(p, df) .Internal(qt(p, df))
+rt <- function(n, df) .Internal(rt(n, df))
--- src/main/names.c.~2~	Fri Jul  4 16:42:42 1997
+++ src/main/names.c	Mon Jul 14 15:52:33 1997
@@ -210,25 +210,25 @@
 {"lchoose",	do_math2,	4,	1,	2,	PP_FUNCALL,	0},
 {"choose",	do_math2,	5,	1,	2,	PP_FUNCALL,	0},
 
-{"dchisq",	do_math2,	6,	1,	2,	PP_FUNCALL,	0},
-{"pchisq",	do_math2,	7,	1,	2,	PP_FUNCALL,	0},
-{"qchisq",	do_math2,	8,	1,	2,	PP_FUNCALL,	0},
+{"dchisq",	do_math2,	6,	11,	2,	PP_FUNCALL,	0},
+{"pchisq",	do_math2,	7,	11,	2,	PP_FUNCALL,	0},
+{"qchisq",	do_math2,	8,	11,	2,	PP_FUNCALL,	0},
 
 {"dexp",	do_math2,	9,	11,	2,	PP_FUNCALL,	0},
 {"pexp",	do_math2,	10,	11,	2,	PP_FUNCALL,	0},
 {"qexp",	do_math2,	11,	11,	2,	PP_FUNCALL,	0},
 
-{"dgeom",	do_math2,	12,	1,	2,	PP_FUNCALL,	0},
-{"pgeom",	do_math2,	13,	1,	2,	PP_FUNCALL,	0},
-{"qgeom",	do_math2,	14,	1,	2,	PP_FUNCALL,	0},
-
-{"dpois",	do_math2,	15,	1,	2,	PP_FUNCALL,	0},
-{"ppois",	do_math2,	16,	1,	2,	PP_FUNCALL,	0},
-{"qpois",	do_math2,	17,	1,	2,	PP_FUNCALL,	0},
-
-{"dt",		do_math2,	18,	1,	2,	PP_FUNCALL,	0},
-{"pt",		do_math2,	19,	1,	2,	PP_FUNCALL,	0},
-{"qt",		do_math2,	20,	1,	2,	PP_FUNCALL,	0},
+{"dgeom",	do_math2,	12,	11,	2,	PP_FUNCALL,	0},
+{"pgeom",	do_math2,	13,	11,	2,	PP_FUNCALL,	0},
+{"qgeom",	do_math2,	14,	11,	2,	PP_FUNCALL,	0},
+
+{"dpois",	do_math2,	15,	11,	2,	PP_FUNCALL,	0},
+{"ppois",	do_math2,	16,	11,	2,	PP_FUNCALL,	0},
+{"qpois",	do_math2,	17,	11,	2,	PP_FUNCALL,	0},
+
+{"dt",		do_math2,	18,	11,	2,	PP_FUNCALL,	0},
+{"pt",		do_math2,	19,	11,	2,	PP_FUNCALL,	0},
+{"qt",		do_math2,	20,	11,	2,	PP_FUNCALL,	0},
 
 
 #ifdef COMPLEX_DATA
@@ -244,21 +244,21 @@
 
 /* Mathematical Functions of Three Variables */
 
-{"dbeta",	do_math3,	1,	1,	3,	PP_FUNCALL,	0},
-{"pbeta",	do_math3,	2,	1,	3,	PP_FUNCALL,	0},
-{"qbeta",	do_math3,	3,	1,	3,	PP_FUNCALL,	0},
-
-{"dbinom",	do_math3,	4,	1,	3,	PP_FUNCALL,	0},
-{"pbinom",	do_math3,	5,	1,	3,	PP_FUNCALL,	0},
-{"qbinom",	do_math3,	6,	1,	3,	PP_FUNCALL,	0},
+{"dbeta",	do_math3,	1,	11,	3,	PP_FUNCALL,	0},
+{"pbeta",	do_math3,	2,	11,	3,	PP_FUNCALL,	0},
+{"qbeta",	do_math3,	3,	11,	3,	PP_FUNCALL,	0},
+
+{"dbinom",	do_math3,	4,	11,	3,	PP_FUNCALL,	0},
+{"pbinom",	do_math3,	5,	11,	3,	PP_FUNCALL,	0},
+{"qbinom",	do_math3,	6,	11,	3,	PP_FUNCALL,	0},
 
 {"dcauchy",	do_math3,	7,	11,	3,	PP_FUNCALL,	0},
 {"pcauchy",	do_math3,	8,	11,	3,	PP_FUNCALL,	0},
 {"qcauchy",	do_math3,	9,	11,	3,	PP_FUNCALL,	0},
 
-{"df",		do_math3,	10,	1,	3,	PP_FUNCALL,	0},
-{"pf",		do_math3,	11,	1,	3,	PP_FUNCALL,	0},
-{"qf",		do_math3,	12,	1,	3,	PP_FUNCALL,	0},
+{"df",		do_math3,	10,	11,	3,	PP_FUNCALL,	0},
+{"pf",		do_math3,	11,	11,	3,	PP_FUNCALL,	0},
+{"qf",		do_math3,	12,	11,	3,	PP_FUNCALL,	0},
 
 {"dgamma",	do_math3,	13,	11,	3,	PP_FUNCALL,	0},
 {"pgamma",	do_math3,	14,	11,	3,	PP_FUNCALL,	0},
@@ -272,9 +272,9 @@
 {"plogis",	do_math3,	20,	11,	3,	PP_FUNCALL,	0},
 {"qlogis",	do_math3,	21,	11,	3,	PP_FUNCALL,	0},
 
-{"dnbinom",	do_math3,	22,	1,	3,	PP_FUNCALL,	0},
-{"pnbinom",	do_math3,	23,	1,	3,	PP_FUNCALL,	0},
-{"qnbinom",	do_math3,	24,	1,	3,	PP_FUNCALL,	0},
+{"dnbinom",	do_math3,	22,	11,	3,	PP_FUNCALL,	0},
+{"pnbinom",	do_math3,	23,	11,	3,	PP_FUNCALL,	0},
+{"qnbinom",	do_math3,	24,	11,	3,	PP_FUNCALL,	0},
 
 {"dnorm",	do_math3,	25,	11,	3,	PP_FUNCALL,	0},
 {"pnorm",	do_math3,	26,	11,	3,	PP_FUNCALL,	0},
@@ -288,39 +288,39 @@
 {"pweibull",	do_math3,	32,	11,	3,	PP_FUNCALL,	0},
 {"qweibull",	do_math3,	33,	11,	3,	PP_FUNCALL,	0},
 
-{"dnchisq",	do_math3,	34,	1,	3,	PP_FUNCALL,	0},
-{"pnchisq",	do_math3,	35,	1,	3,	PP_FUNCALL,	0},
-{"qnchisq",	do_math3,	36,	1,	3,	PP_FUNCALL,	0},
+{"dnchisq",	do_math3,	34,	11,	3,	PP_FUNCALL,	0},
+{"pnchisq",	do_math3,	35,	11,	3,	PP_FUNCALL,	0},
+{"qnchisq",	do_math3,	36,	11,	3,	PP_FUNCALL,	0},
 
 
 /* Mathematical Functions of Four Variables */
 
-{"dhyper",	do_math4,	1,	1,	4,	PP_FUNCALL,	0},
-{"phyper",	do_math4,	2,	1,	4,	PP_FUNCALL,	0},
-{"qhyper",	do_math4,	3,	1,	4,	PP_FUNCALL,	0},
+{"dhyper",	do_math4,	1,	11,	4,	PP_FUNCALL,	0},
+{"phyper",	do_math4,	2,	11,	4,	PP_FUNCALL,	0},
+{"qhyper",	do_math4,	3,	11,	4,	PP_FUNCALL,	0},
 
 
 /* Random Numbers */
 
-{"rchisq",	do_random1,	0,	1,	2,	PP_FUNCALL,	0},
+{"rchisq",	do_random1,	0,	11,	2,	PP_FUNCALL,	0},
 {"rexp",	do_random1,	1,	11,	2,	PP_FUNCALL,	0},
-{"rgeom",	do_random1,	2,	1,	2,	PP_FUNCALL,	0},
-{"rpois",	do_random1,	3,	1,	2,	PP_FUNCALL,	0},
-{"rt",		do_random1,	4,	1,	2,	PP_FUNCALL,	0},
+{"rgeom",	do_random1,	2,	11,	2,	PP_FUNCALL,	0},
+{"rpois",	do_random1,	3,	11,	2,	PP_FUNCALL,	0},
+{"rt",		do_random1,	4,	11,	2,	PP_FUNCALL,	0},
 
-{"rbeta",	do_random2,	0,	1,	3,	PP_FUNCALL,	0},
-{"rbinom",	do_random2,	1,	1,	3,	PP_FUNCALL,	0},
+{"rbeta",	do_random2,	0,	11,	3,	PP_FUNCALL,	0},
+{"rbinom",	do_random2,	1,	11,	3,	PP_FUNCALL,	0},
 {"rcauchy",	do_random2,	2,	11,	3,	PP_FUNCALL,	0},
-{"rf",		do_random2,	3,	1,	3,	PP_FUNCALL,	0},
+{"rf",		do_random2,	3,	11,	3,	PP_FUNCALL,	0},
 {"rgamma",	do_random2,	4,	11,	3,	PP_FUNCALL,	0},
 {"rlnorm",	do_random2,	5,	11,	3,	PP_FUNCALL,	0},
 {"rlogis",	do_random2,	6,	11,	3,	PP_FUNCALL,	0},
-{"rnbinom",	do_random2,	7,	1,	3,	PP_FUNCALL,	0},
+{"rnbinom",	do_random2,	7,	11,	3,	PP_FUNCALL,	0},
 {"rnorm",	do_random2,	8,	11,	3,	PP_FUNCALL,	0},
 {"runif",	do_random2,	9,	11,	3,	PP_FUNCALL,	0},
 {"rweibull",	do_random2,	10,	11,	3,	PP_FUNCALL,	0},
 
-{"rhyper",	do_random3,	0,	1,	4,	PP_FUNCALL,	0},
+{"rhyper",	do_random3,	0,	11,	4,	PP_FUNCALL,	0},
 
 {"sample",	do_sample,	0,	11,	3,	PP_FUNCALL,	0},
 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From malewski@Psyres-Stuttgart.DE  Wed Jul 16 21:48:52 1997
From: malewski@Psyres-Stuttgart.DE (Peter Malewski)
Date: Wed, 16 Jul 1997 22:48:52 +0200 (MET DST)
Subject: R-alpha: memory problems ?
Message-ID: <Pine.GSO.3.96.970716224139.11598C-100000@sunserv>

Hallo,

This is not so urgent, because most analysis are made by S+, -> just a
hint: I had run Rapril under Win95 with 64 Mb RAM. After a Ram upgrade to
128 mb R doesn't start any more.

good luck for the future ...






=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Peter Malewski                            Center for Psychotherapy Research
Psychologist                              Christian-Belser-Strasse 79a
Project TR-EAT                            D-70597 Stuttgart Germany
                                                 
malewski@psyres-stuttgart.de                      
+49 711 6781-404 (phone)                       
+49 711 6876902  (fax)    
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Thu Jul 17 20:16:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Thu, 17 Jul 1997 15:16:55 -0400 (EDT)
Subject: R-alpha: functionality of CASIM: C/S-Plus interface
Message-ID: <Pine.SUN.3.95.970717151335.4942A-100000@paca>


   Some people here have started using CASIM, which is an add-on we got a
while back for S-Plus that allows one to spawn an S-Plus process from a C
program and communicate with it.
   How hard do folks think it would be to develop such an interface for R?
I might try it, but I'm not completely sure I'm up to it (although it
would exercise my programming skills).
   Also, I wonder again at the ethics of looking at the CASIM header files
(which came from StatSci) when trying to work up an R interface --
although I notice that the header files say "CSIRO division of Mathematics
and Statistics" on them rather than "StatSci" ...

  Ben

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From oehl@Psyres-Stuttgart.DE  Tue Jul 22 09:56:56 1997
From: oehl@Psyres-Stuttgart.DE (Jens Oehlschlaegel)
Date: Tue, 22 Jul 1997 10:56:56 +0200 (MET DST)
Subject: R-alpha: some thoughts about factor()
Message-ID: <Pine.GSO.3.96.970722105018.17490E-100000@sunserv>



Dear R-people,

recently at s-news we had a discussion about factor().
I thought you might be interested in some of my thoughts about factors.

Any comments welcome


Best regards


Jens Oehlschlaegel-Akiyoshi


-------------------------------------------------------------------

I think the problem is deeper than that factors would just be handled
inapprobriately by some S+ functions, the inconsistency is built in
the constructor factor(), and thus is built in the concept! 

Let me cite S+ online help of factor() on the meaning of levels:

VALUE
object of class "factor", representing values taken from the finite set
given by levels. It is important that this object 
is not numeric; in particular, comparisons and other operations behave
AS IF THEY OPERATED ON VALUES FROM THE LEVELS SET, WHICH IS ALWAYS OF
MODE CHARACTER.

Let's try comparisions on values from the level set:

> my.animals <- c(4,5,6,4,5,6)
> my.levels <- 4:6
> my.labels <- c("dog","cat","rat")
> animals <- factor(my.animals,levels=my.levels,labels=my.labels)
> unclass(animals)
[1] 1 2 3 1 2 3
attr(, "levels"):
[1] "dog" "cat" "rat"

Obviously labels become levels, and comparisions with levels will never work,
whether levels are given as numerics or as characters, as in

> animals==4
[1] F F F F F F
> animals=="4"
[1] F F F F F F

Obviously currently all comparisions work on the LABELS SET, which is the
only one stored with the factor object, but which - for purpose of
confusion - is a named attribute "levels", whereas
 
> labels(animals) 
[1] "1" "2" "3" "4" "5" "6"

is a totally different story. 



All a user like me wishes is something like

> unclass(animals)
[1] 4 5 6 4 5 6
attr(, "labels"):
[1] "dog" "cat" "rat"

and of course it would be user-friendly if S+ would recognize which of
both representations are meant in comparisions and assignments like

animals==4
animals=="dog"
animals[1] <- 4
animals[1] <- "dog"

not coercing 4s to "4"s but interpreting animals the right way, isn't S+
an interpreter?


If there is no way around a need for internal numeric representation of
integers 1:x then a factor object could look like

> unclass(animals)
[1] 1 2 3 1 2 3
attr(, "levels"):
[1] "dog" "cat" "rat"
attr(, "nlevels"):
[1] 4 5 6


and consequently


[old function, sorry for the s-at-the-end-confusion] 
codes(animals)  could return 1 2 3 1 2 3

[old function] 
levels(animals) could return "dog" "cat" "rat"
[new function] 
level(animals) could return "dog" "cat" "rat" "dog" "cat" "rat"

[new function] 
nlevels(animals) could return 4 5 6
[new function]
nlevel(animals) could return 4 5 6 4 5 6


for reasons of consistency, so everyone would know he has to write either 

  nlevel(animals)==4
  nlevel(animals)[1] <- 4

or

  level(animals)=="dog"
  level(animals)[1] <- "dog"


Concerning defaults one probably would keep returning

animals
[1] "dog" "cat" "rat" "dog" "cat" "rat"

for reasons of compatibility

but make the evaluator coerce animals to nlevel(animals) in

animals[1] <- 4

instead of 

coercing 4 to "4"


I have no idea about how to change the constructor factor() to keep
compatibility, perhaps just keep arguments old.levels=new.nlevels and
old.labels=new.levels, together with a clear help function? 

DOES THAT SOUND ANY BETTER?



yours sincerely

--
Jens Oehlschlaegel-Akiyoshi
Psychologist/Statistician
Project TR-EAT + COST Action B6
                                                 F.rankfurt
oehl@psyres-stuttgart.de                         A.ttention
+49 711 6781-408 (phone)                         I.nventory
+49 711 6876902  (fax)                           R .-----.
                                                  / ----- \
Center for Psychotherapy Research                | | 0 0 | |
Christian-Belser-Strasse 79a                     | |  ?  | |
D-70597 Stuttgart Germany                         \ ----- /
-------------------------------------------------- '-----' -
                                                 it's better








=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Tue Jul 22 21:30:47 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Tue, 22 Jul 1997 16:30:47 -0400 (EDT)
Subject: R-alpha: split() S/R mismatch?
Message-ID: <Pine.SUN.3.95.970722162745.10400A-100000@paca>


  I *think* that split(x,f) in S/S-PLUS (SunOS 4, S-PLUS 3.2) by default
replicates f as many times as necessary to cover the length of x.  In R it
apparently doesn't.

  I have the following function:

matsplit <-
function (x, crit) 
{
        lapply(split(x, crit), matrix, ncol = ncol(x))
        #  x is a matrix, crit is a vector with length dim(x)[1] ...
        #   makes a list of matrices split by row
}

The following:

y _ cbind(matrix(1:10,ncol=2,byrow=T),rep(1:2,c(2,3)))
matsplit(y[,1:2],y[,3])

gives

$"1":
     [,1] [,2] 
[1,]    1    2
[2,]    3    4
 
$"2":
     [,1] [,2] 
[1,]    5    6
[2,]    7    8
[3,]    9   10
 
 in S-PLUS; in R it gives

Error in split(x, as.factor(f)) : argument lengths differ

 I can find a workaround.  Is this a bug, a feature, or just a difference?

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Jul 22 23:12:34 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
Subject: R-alpha: New version of R for testing
Message-ID: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>

The newest version of R for Unix (version 0.50 alpha-1) is now (or will
soon be) available from the following sites.

    NORTH AMERICA:
	http://lib.stat.cmu.edu/R/Alpha

    EUROPE:
        ftp://ftp.stat.math.ethz.ch/R/
        ftp://statlab.uni-heidelberg.de/pub/mirrors/auckland/R/

    JAPAN:
        ftp://ftp.u-aizu.ac.jp/pub/lang/R/

    NEW ZEALAND:
        ftp://stat.auckland.ac.nz/pub/R/

Please obtain a copy from site close to you.  Note that New Zealand
is not close to anywhere other than itself :-).

This is primarily a bug-fix release, although there is some new
functionalty.  As noted in the 0.49 release announcement, the primary
goal at present is stability.  This is partly for the benefit of anyone
who might be using R, but also so that we we can bring the PC and
Mac versions into sync with the Unix version.

The "alpha-1" indicates that there may be a few stability problems with
this version.  This is because there are been a number of very low-level
changes which have not been exercised as much as they might.  We hope
that these can be found and fixed in a couple of patch cycles.  Then
we will declare it to be "R-0.50 stable".

This version owes a good deal to Martin Maechler who probably did as
much bug-fixing as R+R together this time.

	R + R + M


We have not kept good a records of bug fixes or updates the TASKS list
(we should have this updated for the "stable" release).  A partial list
of changes follows.

-------------------------------------------------------------------

		  CHANGES IN VERSION R VERSION 0.50

WARNING!!!

 o  A change in the way that "expressions" are implemented means that
    saved data images which contain expressions will probably not
    restore properly.

NEW FEATURES

 o  "expressions" are now implemented as a basic type rather than as
    a class of object.  This change was made as move toward compatibility
    with S and also to implement mathematical annotation in graphs.

 o  "eigen" can now handle complex and non-symmetric matrices.

 o  Libraries are now attached by loading their code into newly created
    environment frames on the search path rather than in with the general
    system code.  This means that libraries can be unloaded as well as
    loaded.  They can also have .First.lib and .Last.lib functions.

 o  There is now an experimental function called "delay" which creates
    a promise to evaluate an expression.  This provides direct access
    to the lazy evaluation mechanism used by R.

 o  >>>>  'make tests'   allows to test--run all the help() examples.
 
 o  New functions   matplot / matpoints / matlines.

 o  cut has 2 new arguments. 'right = TRUE' gives intervals closed on the
	right, open to the left (as S); 'right = FALSE' allows to reverse
	this. The code for default label construction has been enhanced,
	and can be controlled by the new argument 'dig.lab'.

 o  legend(.) has 2 new arguments 'cex' (obvious) and 'merge = FALSE'.
	-> ?legend.

 o  deparse  has a 2nd argument allowing for a kind of line width.

 o  many help(.) pages have been updated with working examples,
	and several new ones have been created.

BUG FIXES

 o  A bug which prevented the "pictex" graphics driver from working
    has been fixed.

 o  Regression diagnostics obtained with "lm.influence" now work when
    there are weights.	This means they should work for glms.

 o  There was a problem in parsing files from statements which were
    separated from following statements by ";" (e.g. data(iris); iris).
    This is fixed.

 o  Comments are handled better in functions.  The rule is that they
    are shifted to just before their statements.  Comments after the
    last statement of a function are lost.

 o  It is now possible to perform complicated mutations of expressions.
    For example
	e <- quote(f(x=1,y=2))
	names(e)[[2]] <- "a"
    will change the x= argument tag into a=.  In the past this produced
    odd error messages.

 o  The length function now tries to return a "sensible" value for all
    the built-in types.	 For example, symbols now have length 1.

 o  "update" should now work in both "lm" and "glm" models.

 o  The functions Re, Im, Mod, Arg and Conj will now accept real-valued
    arguments and return the obvious results.

 o  Minor graphics cleanup.

 o  A fix for convergence problems in glm from Thomas Lumley included.

 o  A new version of qt() should not take infinitely long to get an
    answer in the large degrees if freedom case.  The underlying code
    (Hill 1970, CACM) appears to be much faster and more accurate than
    Splus.

 o  A final Newton step has beed added to give a final "polish" to
    the quantiles produced by pnorm().	These should be close to full
    accuracy now.

 o  A bug in qbeta found by Martin Maechler has been fixed.  This should
    speed up quantile computation for the F and Beta distributions.

 o  rainbow(.) now allows "start > end" indexing the "color circle".
    topo.colors(n), terrain.colors(n), heat.colors(n) now also work for n=1,2.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Jul 23 12:21:47 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Jul 1997 07:21:47 -0400
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of "Wed, 23 Jul 1997 10:12:34 +1200 (NZST)"
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <wnc67u2ovxw.fsf@urn.math.sc.edu>



FYI:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version 0.50 alpha-1) is
    Ross> now (or will soon be) available from the following sites.

    Ross>     NORTH AMERICA:
    Ross> 	http://lib.stat.cmu.edu/R/Alpha

Exists at StatLib, compiles, runs most basic things (don't know about
bugs), and seems to work under Solaris 2.5.  (I'll try debian this
afternoon at home while babysitting).

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Jul 23 12:25:47 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Jul 1997 07:25:47 -0400
Subject: R-alpha: New version of R for testing
In-Reply-To: Anthony Rossini's message of "23 Jul 1997 07:21:47 -0400"
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz> <wnc67u2ovxw.fsf@urn.math.sc.edu>
Message-ID: <wnc4t9movr8.fsf@urn.math.sc.edu>


>>>>> "Anthony" == Anthony Rossini <rossini@stat.sc.edu> writes:

    Anthony> FYI:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> The newest version of R for Unix (version 0.50 alpha-1) is
    Ross> now (or will soon be) available from the following sites.

    Ross> NORTH AMERICA: http://lib.stat.cmu.edu/R/Alpha

    Anthony> Exists at StatLib, compiles, runs most basic things
    Anthony> (don't know about bugs), and seems to work under Solaris
    Anthony> 2.5.  (I'll try debian this afternoon at home while
    Anthony> babysitting).

Also should've noted:

	ftp://lib.stat.cmu.edu/R/Alpha/R-0.50-a1.tgz

also works, for those who'd rather use FTP.

best,

-- 
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
        "'Bother,' said Pooh, as Cthulu rose up and ate him."
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jul 23 16:06:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Jul 1997 17:06:49 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <199707231506.RAA16235@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.50 alpha-1) is now (or will
> soon be) available from the following sites.

> ...

R + R + M,

Thanks for putting out the new version.  Finally, it's back to testing
(and porting) ...

I have one immediate bug report.

I think in R-0.50-a1/mansrc/latex/Rdoc.sty,

	\begin{list}{}\SetLmargin}%

in the code for the Header environment must be

	\begin{list}{}\SetLmargin\item}%

(Otherwise, make install-latex gives many errors.)  Martin?

A context diff is appended below.

Also, in the data subdir, quakes and sunspots should have mode 644.

-k

***********************
*** mansrc/latex/Rdoc.sty.orig	Wed Jul 23 17:03:46 1997
--- mansrc/latex/Rdoc.sty	Wed Jul 23 17:03:56 1997
***************
*** 28,34 ****
      \makebox[1in][r]{\tt #1} \\ \hline
    \end{tabular}
  \end{center}
! \begin{list}{}\SetLmargin}%
  {\end{list}}
  
  \newenvironment{Arguments}[0]{
--- 28,34 ----
      \makebox[1in][r]{\tt #1} \\ \hline
    \end{tabular}
  \end{center}
! \begin{list}{}\SetLmargin\item}%
  {\end{list}}
  
  \newenvironment{Arguments}[0]{
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Jul 23 22:53:45 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Jul 1997 23:53:45 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <x2vi21bfkm.fsf@bush.kubism.ku.dk>


In the minor department, I see that you've worked around the .orig
patch problem in src/library/base/Makefile. I know that I (and Martin)
suggested that particular way of doing it, i.e.

        @cat `ls funs/[a-z]* | sed '/CVS/d; /~$$/d; /\.orig$$/d; /\.bak$$/d'` \
         | sed '/^[     ]*$$/d'  > ../../../library/base
#                  ^^ = TAB + Space

-- but on 2nd thought, wouldn't it be more logical simply to change
the source file names to have suffix .R and use

	@cat *.R | sed ...

The current way has all sorts of gotchas built in. What if Netscape
dumps core when started in src/library/base/funs, e.g.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jul 24 21:45:07 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 24 Jul 1997 22:45:07 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: Ross Ihaka's message of Wed, 23 Jul 1997 10:12:34 +1200 (NZST)
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <x2g1t4gox8.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> NEW FEATURES
> 
>  o  "expressions" are now implemented as a basic type rather than as
>     a class of object.  This change was made as move toward compatibility
>     with S and also to implement mathematical annotation in graphs.

Something looks wrong:

> expression(2+2)
expression(2 + 2)
> expression(2+2)[[1]]
expression(2 + 2)
> expression(2+2)[[1]][[1]]
expression(2 + 2)

- How the blazes is a poor soul supposed to get at the parse tree for
an expression? According to the docs, an expression is supposed to be
a list of calls, but obviously

> mode(expression(2+2)[[1]])
[1] "expression"

----------

Another piece of weirdness:

> t(table(0))
Error: dimnames: number of dimensions must equal number of names

# That one used to cause a segmentation fault (my bug report for it
# seems to have fallen off of the TASKS list - bug suicide?)

> t(as.matrix(table(0)))
     0
[1,] 1

# Looks OK now ... or is it? Watch:

> ?ls
Warning: invalid 'cutoff' for deparse, used default
#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        
        List Objects

             ls(name, pos=2, envir=sys.frame(sys.parent()),
                    all.names=FALSE, pattern)

Same thing happens if you omit the 2nd expression.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Arne Kovac <maak@stats.bris.ac.uk>  Fri Jul 25 04:51:25 1997
From: Arne Kovac <maak@stats.bris.ac.uk> (Arne Kovac)
Date: Fri, 25 Jul 1997 03:51:25 +0000 (GMT)
Subject: R-alpha: Treatment of seed
Message-ID: <Pine.LNX.3.95.970725033537.4471B-100000@ts1.bris.ac.uk>

There is a difference between R and S (or S-Plus, I'm not sure about
that) concerning the generation of random numbers.

If an error occurs during the execution of a function, the seed is
restored to its old value in S-Plus, but not in R. This feature of S-Plus
has just turned out to be very useful for me because I got an error
message during a small simulation for a certain choice of parameters.

Here is a silly example:

R> silly<-function()
+ {
+ tmp<-rnorm(5)
+ unknownfunction()
+ }
R> .Random.seed
[1]  8886  1153 10190
R> silly()
Error: couldn't find function "unknownfunction"
R> .Random.seed
[1]  9859  1963 19516


Splus> silly<-function()
+ {
+ tmp<-rnorm(5)
+ unknownfunction()
+ }
Splus> .Random.seed
 [1] 37 31 60  6 22  0 47 15  0 30 41  0
Splus> silly()
Error in silly(): couldn't find function "unknownfunction"
Dumped
Splus> .Random.seed
 [1] 37 31 60  6 22  0 47 15  0 30 41  0

Arne Kovac

-- 
Arne Kovac
School of Mathematics           Phone: +44 (0117) 942 7551
University of Bristol           A.Kovac@bristol.ac.uk    
University Walk                 http://www.stats.bris.ac.uk/~maak
Bristol, BS8 1TW, U.K.



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:54:56 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:54:56 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2vi21bfkm.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2vi21bfkm.fsf@bush.kubism.ku.dk>
Message-ID: <199707250854.KAA17771@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> In the minor department, I see that you've worked around the .orig
> patch problem in src/library/base/Makefile. I know that I (and Martin)
> suggested that particular way of doing it, i.e.

>         @cat `ls funs/[a-z]* | sed '/CVS/d; /~$$/d; /\.orig$$/d; /\.bak$$/d'` \
>          | sed '/^[     ]*$$/d'  > ../../../library/base
> #                  ^^ = TAB + Space

> -- but on 2nd thought, wouldn't it be more logical simply to change
> the source file names to have suffix .R and use

> 	@cat *.R | sed ...

> The current way has all sorts of gotchas built in. What if Netscape
> dumps core when started in src/library/base/funs, e.g.

I think this is a very good idea.  (Would also allow us to keep e.g. .S
sources when porting ...).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:56:10 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:56:10 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2g1t4gox8.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2g1t4gox8.fsf@bush.kubism.ku.dk>
Message-ID: <199707250856.KAA17775@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Another piece of weirdness:

>> t(table(0))
> Error: dimnames: number of dimensions must equal number of names

> # That one used to cause a segmentation fault (my bug report for it
> # seems to have fallen off of the TASKS list - bug suicide?)

>> t(as.matrix(table(0)))
>      0
> [1,] 1

> # Looks OK now ... or is it? Watch:

>> ?ls
> Warning: invalid 'cutoff' for deparse, used default
> #^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Indeed.  Was also on my bugs list, however with the

	t(table(1))

example.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jul 25 09:57:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Jul 1997 10:57:31 +0200
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.50 alpha-1) is now (or
> will soon be) available from the following sites.

> ...

Here are some comments on the new version.  Actually, quite a few ...
Hard to structure the whole thing nicely.

* My
	R> x <- 1:5
	R> dimnames(x)[1,2] <- NULL
segfault in dimnames mutation appears as Open in TASKS, and as Closed in
TASKS.OLD.

* In

R> D(expression(z * (log(z) /z)), "z")
(log(z)/z) + z * (1/z/z - log(z)/z^2)

the "1/z/z" is perhaps not optimal ...

* TASKS has

TASK:	"chisquare.test" problem
STATUS:	Open
FROM:	<venkat@biosta.mskcc.org>
	Can you change the explicit "cat" statement in the
	"chisquare.test" function which insists on writing to the
	screen even when the output is redirected to a variable? (Using
	"htest" class as in "t.test" function.)
	[ Should we switch to the library one. ]

As I already suggested, it would be nice to include all of ctest with
the distribution proper.

I have another question/suggestion re chisquare tests.  Several of my
functions in ctest now return "observed" and "expected" components.
Would it be a good idea to print these automatically (if they exist) in
print.htest?

* In src/unix/system.c, one `Rdata' should be `RData' (d -> D).

* No methods for as.data.frame exist!

* How can I return from browser()?
return() does not seem to work for me!

* TASKS has

TASK:	abline + coefficients
STATUS:	Closed
FROM:	<nobu@psrc.isac.co.jp>
	I found a little different behavior of R with S.
	at R-0.49:
	    > a
	    [1] 12 23 22 34 44 54 55 70 78
	    > plot(a)
	    > abline(lsfit(seq(1,len=length(a)), a))
	    Error: no applicable method for "coefficients"
	at S (from AT&T '92) result draw coefficient line without error.
	Then I think to need define a function as followed:
	    coefficients.default <- function(x) x$coef
	[ Default method already added for Doug Bates. ]

For me, this produces no error but abline does not produce any output
for me.  Can anyone check/confirm this?

See also

TASK:	"abline" incompatibility
STATUS:	Open
FROM:	<nobu@psrc.isac.co.jp>

and the 

* TASKS has

TASK:	ls.print
STATUS:	Open
FROM:	<maechler@stat.math.ethz.ch>
	Yes, I do confirm that the  Help page  (?NCOL) contains  '.COL'.
	Apply the following patch (to doc2ms) in  $RHOME/etc , and "all
	is well":

This seems to be fine now.  Martin?

* The ls.print problem reported by <VENKAT@biosta.mskcc.org> seems to be
gone now.  (Still labeled as Open in TASKS).

* Some of the "formula" problems in TASKS (<mikem@stat.cmu.edu>, 
<p.dalgaard@kubism.ku.dk> and <thomas@biostat.washington.edu> seem to be
gone now.

* Several of the graphics patches sent by
<kovac@figaro.stats.bris.ac.uk> (labeled Open in TASKS) seem to have
been taken care of already, in particular by integrating Martin's
patches.  Martin?

* As a remark on

TASK:	String length problems
STATUS:	Closed
FROM:	<maechler@stat.math.ethz.ch>
	This is not a  cat(.) but a  string storing/parsing problem:
	nchar("\n\n")  # gives  2  instead of 3
	[ Hmmm.  Was this typed to readline I wonder?  There it  ]
	[ seems that ^L must be escaped with ^V.  Using the ANSI ]
	[ \f will now produce a literal formfeed.  Indeed, using ]
	[ any of the ANSI C escapes will work.			 ]

note that under ESS pre 4.9,

	R> nchar("\n\n")

	[1] 2

(empty line in between!), so "^L" needs to be escaped here too.  (Same
for single quotes.)

* TASKS has

TASK:	Documentation Nit
STATUS:	Closed
FROM:	<Kurt.Hornik@ci.tuwien.ac.at>
	The documentation for ls/objects has
		ls(name, pos=2, envir=sys.frame(sys.parent()),
		   all.names=FALSE, pattern)
	but the code has
		ls <-
		function (name, pos = -1, envir = NULL,
			  all.files = FALSE, pattern)
	[ At one time these were equivalent.  Are they still? ]

However, the documentation is still unchanged!

* Re 

TASK:	"cat" problem
STATUS:	Closed
FROM:	<hornik@ci.tuwien.ac.at>
	* cat() is a bit inconsistent:

	...

	[ This is the way S does it! ]

Yes, I know that the current behavior is how S does it.  Still, there
are situations (as e.g. in the code for write.table) where I'd like to
have the different behavior.  Could we have an extra option to cat()
which suppresses a final newline even if sep contains a newline?

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

	R> x <- 1:5
	R> x
	[1] 1 2 3 4 5
	R> i <- c(F, T)
	R> x[i]
	Error: invalid subscript type
	R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

	R> x[-6]
	Error: subscript out of bounds

* There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

	R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
	R> f
	[1] a a b
	R> codes(f)
	[1] 1 1 2
	R> levels(f)
	[1] "a" "b" "c"

which gives e.g.

	R> tapply(rep(1, length(f)), f, sum)
	Error: names attribute must be the same length as the vector

One solution is to replace

	namelist[[i]] <- levels(index)

by

	namelist[[i]] <- unique(levels(index)[index])

but perhaps there is something smarter ...

* The `shortest program to produce a segfault' now gives:

	R> t(table(1))
	Error: dimnames: number of dimensions must equal number of names

(See Peter's mail for the consecutive deparse warnings ...)

* Please add

	family.lm <- function (object) { gaussian() }

to the base library.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 17:08:44 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 09:08:44 -0700 (PDT)
Subject: R-alpha: New version of R for testing
In-Reply-To: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970725090507.3738B-100000@zen>


There is a bug in image() which I think I reported before but which isn't
in TASKS.  The little rectangles it draws don't quite meet up in the
vertical direction if an image is drawn in x11() and then printed using
save.plot().

Looking at the code I can't see how this could possibly happen, and it
didn't happen in the interpreted version, but it might be worth putting in
an overlap of 1% or so to stop it. 

	-thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 17:12:41 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 09:12:41 -0700 (PDT)
Subject: R-alpha: Re: R-beta: R 0.50 alpha
In-Reply-To: <199707251602.SAA13750@hypatia.math.ethz.ch>
Message-ID: <Pine.SUN.3.95.970725090903.3738C-100000@zen>

On 25 Jul 1997, Ennapadam Venkatraman wrote:

> Autoloading of libraries doesn't seem to work: 
This is strange.  The autoloading works for me (on Linux).

> 
> The coxph function the the library survival4 doesn't seem to work. It just
> crashes R. See the example below:

I get a seg fault on calls to some, but not all, compiled routines.  For
example, it happens with both the right-censored and counting process
fitting routines in survival4 and with the Cgee code, but not with ace,
avas, as.date  or the Kaplan-Meier fits in survival4.  I'm trying to find
out why.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 19:45:57 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 11:45:57 -0700 (PDT)
Subject: R-alpha: new version
In-Reply-To: <199707250857.KAA17779@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970725113626.3738E-100000@zen>

I have traced down the segfault that Venkat and I reported with C
routines. It is in S_alloc, which explains why only some routines cause
problems.

The problem is that size is declared but never set, resulting in
(xxgdb) print size
$10 = 1081754432

I don't know precisely what is happening here but my guess is that we
should have size=nelem*eltsize/sizeof(char). 

(Q: Is it necessary or even true that eltsize/sizeof(char) is always an
integer?) 

char *S_alloc(long nelem, int eltsize)
{
	unsigned int i, size;
	char *p = R_alloc(nelem, eltsize);
	for(i=0 ; i<size; i++)
		p[i] = 0;
	return p;
}


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 21:44:54 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 13:44:54 -0700 (PDT)
Subject: R-alpha: errors in batch mode
In-Reply-To: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970725134337.3738G-100000@zen>


Errors in batch mode no longer cause a stack imbalance but they do cause
execution to be halted.  Is this a feature?  It makes it harder to run
test code on new releases.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 21:54:28 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 13:54:28 -0700 (PDT)
Subject: R-alpha: help processing
In-Reply-To: <Pine.SUN.3.95.970725134337.3738G-100000@zen>
Message-ID: <Pine.SUN.3.95.970725134816.3738H-100000@zen>


On Solaris (and presumably other System V Unices), the default buffer
length for m4 is only 4096 characters. This limits the length of
ARGUMENTS() or VALUES() in help files. survfit.coxph overflows this limit. 

Adding the option -B 8192 to m4 in the etc/doc2* files fixes this.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jul 25 23:53:34 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 15:53:34 -0700 (PDT)
Subject: R-alpha: autoload
In-Reply-To: <Pine.SUN.3.95.970725113626.3738E-100000@zen>
Message-ID: <Pine.SUN.3.95.970725154855.3738I-100000@zen>


You can use the new delay() function to implement autoloading of libraries
or source files.  Functions autosource() and autoload() follow, together
with examples.  autoload("coxph","survival4") creates a promise to
evaluate autoloader("coxph","survival4"), which in turn calls
library(survival4), removes the promise, and evaluates "coxph" in the
newly created environment.  I was somewhat surprised that it worked.

	-thomas


 autosource<- function (name, file) 
{
        newcall <- paste("delay(autosourcer(\"", name, "\",\"", file, 
                "\"))", sep = "")
        assign(name, parse(text = newcall), env = .GlobalEnv)
}
 autosourcer <- function (name, file) 
{
        eval(parse(text = paste("source(\"", file, "\")", sep = "")), 
                .GlobalEnv)
        eval(as.name(name), sys.parent())
}



 autoload<- function (name, file) 
{
        newcall <- paste("delay(autoloader(\"", name, "\",\"", file, 
                "\"))", sep = "")
        assign(name, parse(text = newcall), env = .GlobalEnv)
}
 autoloader <- function (name, file) 
{
	name<-paste(name,"",sep="")
	rm(list=name,envir=sys.frame(sys.parent()),inherits=TRUE)
        eval(parse(text = paste("library(\"", file, "\")", sep = "")), 
                .GlobalEnv)
        eval(as.name(name), pos.to.env(2))
}


autosource("gee",system.file("library","gee"))
autoload("coxph","survival4")
y<-rnorm(100)
x<-rnorm(100)
g<-sort(rep(1:10,10))
tt<-1:10
cc<-rep(1,10)
xx<-rnorm(10)
substitute(gee)
substitute(coxph)
gee(y~x,g)
coxph(Surv(tt,cc)~xx)
q("no")




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sat Jul 26 00:46:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 25 Jul 1997 16:46:03 -0700 (PDT)
Subject: R-alpha: .Libraries
In-Reply-To: <Pine.SUN.3.95.970725154855.3738I-100000@zen>
Message-ID: <Pine.SUN.3.95.970725164456.4219A-100000@zen>


The old way of keeping track of which libraries are loaded was with the
variable .Libraries.  It is still there, but it isn't updated when
libraries are detached.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Arne Kovac <maak@stats.bris.ac.uk>  Sun Jul 27 04:15:01 1997
From: Arne Kovac <maak@stats.bris.ac.uk> (Arne Kovac)
Date: Sun, 27 Jul 1997 03:15:01 +0000 (GMT)
Subject: Lost comments (was Re: R-alpha: New version of R for testing)
Message-ID: <Pine.LNX.3.95.970727031430.9276A-100000@ts1.bris.ac.uk>

On Wed, 23 Jul 1997, Ross Ihaka wrote:

>  o  Comments are handled better in functions.  The rule is that they
>     are shifted to just before their statements.  Comments after the
>     last statement of a function are lost.

More generally each comment between the last statement of a block and its
closing bracket is lost!! I wonder if this is really an advantage: I just
"uncommented" a line for test purposes to see some minutes later that I
had to retype it again. :-(

> dummy<-
+ function () 
+ {
+         for (i in 1:3) {
+                 print(1)
+                #print(2)
+         }
+         More()
+         Commands()
+ }
> dummy
function () 
{
        for (i in 1:3) {
                print(1)
        }
        More()
        Commands()
}

Arne Kovac

-- 
Arne Kovac
School of Mathematics           Phone: +44 (0117) 942 7551
University of Bristol           A.Kovac@bristol.ac.uk    
University Walk                 http://www.stats.bris.ac.uk/~maak
Bristol, BS8 1TW, U.K.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Jul 27 05:03:49 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 27 Jul 1997 16:03:49 +1200 (NZST)
Subject: R-alpha: New version of R for testing
In-Reply-To: <x2g1t4gox8.fsf@bush.kubism.ku.dk>
References: <199707222212.KAA14350@stat1.stat.auckland.ac.nz>
 <x2g1t4gox8.fsf@bush.kubism.ku.dk>
Message-ID: <199707270403.QAA12146@stat1.stat.auckland.ac.nz>

Peter Dalgaard BSA writes:
 > Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
 > 
 > > NEW FEATURES
 > > 
 > >  o  "expressions" are now implemented as a basic type rather than as
 > >     a class of object.  This change was made as move toward compatibility
 > >     with S and also to implement mathematical annotation in graphs.
 > 
 > Something looks wrong:
 > 
 > > expression(2+2)
 > expression(2 + 2)
 > > expression(2+2)[[1]]
 > expression(2 + 2)
 > > expression(2+2)[[1]][[1]]
 > expression(2 + 2)
 > 
 > - How the blazes is a poor soul supposed to get at the parse tree for
 > an expression? According to the docs, an expression is supposed to be
 > a list of calls, but obviously

Oops sorry.  Incomplete implementation.  I have a fix for this now as
will as fixes for mutations of expressions of the form

	> e <- expression(x+y)
	> e[[1]][[1]] <- as.name("f")

I hope to have patches and an "a2" release later this week.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Jul 27 05:19:47 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 27 Jul 1997 16:19:47 +1200 (NZST)
Subject: R-alpha: Mathematical Anotation in Plots
Message-ID: <199707270419.QAA12212@stat1.stat.auckland.ac.nz>

I forgot to mention that version 0.50 will do "greek" and "accents" in
plot labels.  The basic idea is that you should be able to replace any
character vector by an expression vector when doing plot annotation.

E.g.
	plot(rnorm(10),main=expression(hat(Theta)))

This produces a plot with a main title consisting of a capital Theta
with a "hat" on it.  The idea is to use R parse trees to represent
mathematical expressions.

Most things are as you would expect, with the following exceptions:

 o  ^ is used for superscripting and [] for subscripting so that
    x[i]^2 is the equivalent of the TeX x_i^2.

 o  you use over(x,y) for a fraction with x in the numerator and y
    in the denominator.

 o  the *" operator is used to denote juxtaposition. sometimes this
    makes sense - e.g. x*e^{x/lambda}, and sometimes it is a bit ugly
    e.g. "Distribution of "*hat(Theta). I haven't thought of a
    better solution (yet).

This is a very immature implementation, but you might enjoy playing
with it.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Jul 27 19:07:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jul 1997 20:07:06 +0200
Subject: R-alpha: Environment strangeness
Message-ID: <x290ys1i9h.fsf@bush.kubism.ku.dk>

Maybe I'm just not understanding things well enough (actually, that's
why I was fooling around with this in the first place), but:

> g
function () 
{
        e <- sys.frame(sys.parent())
        print(ls(envir = e))
        eval(print(b), e)
}
> f
function () 
{
        b <- 7913
        g()
}
> f()
[1] "b"
Error: Object "b" not found

Er? Is "b" in environment "e" or not?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: new functions
Message-ID: <199707281323.PAA18631@aragorn.ci.tuwien.ac.at>

The following two functions might be worth adding to the distribution:

**************************************************************
as.ordered <- function(x) { 
  if (is.ordered(x)) x else ordered(x)
}

data.class <- function(x) {
  if (length(cl <- class(x)))
    cl[1]
  else {
    l <- length(dim(x))
    if (l == 2)
      "matrix"
    else if (l > 0)
      "array"
    else
      mode(x)
  }
}
**************************************************************

Re data.class:  Couldn't we introduce a "matrix" and an "array" class
right away?  (I already asked this once).  The functions for creating or
coercing such objects could easily add the corresponding class
attribute ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R 0.50.a1 problems with lm/glm methods
Message-ID: <199707281323.PAA18639@aragorn.ci.tuwien.ac.at>

Thanks for fixing formula() and update().

Here are some open problems.

* effects:

** There is no help available for effects()

** The lm() help page has effects(lm.obj), but from the code it is clear
that the one-arg version cannot work.

Shouldn't it simply return z$effects?

** The two-arg version only works for factors (?) ... otherwise,
	z$model.frame[factors & pattern != 0]
gives an error.  Can someone explain to me what this is doing?

* plot:

There should be a plot.lm() function which reports that useful
diagnostic plots have not been implemented yet.

Perhaps we should do something like

	unimplemented <- function () {
		stop("Not implemented yet ... sorry.")
	}

	plot.lm <- function (...) unimplemented()
	plot.glm <- function (...) unimplemented()

and similarly for other stuff which is known to be missing?  (This would
also help improving the TASK handling :-))

* predict:

** There is no help available for predict()

** The one-arg version of predict.default() cannot work.  For objects
of class "lm", it should simply return the fitted values, right?

** The two-arg version of predict.default() cannot work because no
fitted object has a "covmat" component.  Anyway, shouldn't the general
form be something like
	predict(object, newdata, ...)
???

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 segfault
Message-ID: <199707281323.PAA18655@aragorn.ci.tuwien.ac.at>

Perhaps not the shortest way, but ...

**************************************************
R> x <- data.frame(x = 3:5, y = 5:7)
R> rownames(x) <- 1:3 
R> x
  x y
1 3 5
2 4 6
3 5 7
R> mode(x) <- "character"
Segmentation fault
**************************************************

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: R 0.50.a1 suggestion
Message-ID: <199707281323.PAA18629@aragorn.ci.tuwien.ac.at>

Could we introduce a library hierarchy in the `data' directory?  The
standard stuff would then go into `data/base', and if add-ons have their
own data (examples!), these would go into a corresponding subdir of
`data'.

Only three small changes would be necessary:

1. In `data', create a `base' subdir and move all data files there.

2. Replace `cmd/filename' by the version below:

*********************************************************************
#!/bin/sh

for file in $HOME/lib/R/$1/$2 \
            $RHOME/$1/$2 \
            $RHOME/$1/[^.]*/$2;
do
    if [ -r $file ]
    then
	echo $file
	break
    fi
done

if [ ! -r $file ]
then
    echo
fi
*********************************************************************

3. In src/library/LIBSETUP.in, add

*********************************************************************
        if test -d ${lib}/data
        then
                mkdir -p ../../data/${lib}
                cp ${lib}/data/* ../../data/${lib}
        fi
*********************************************************************

before the final `done'.

We've been using the above filename script for a very long time now,
without any problems ...

Please ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R-0.50.a1:  buglet in lsfit()
Message-ID: <199707281323.PAA18653@aragorn.ci.tuwien.ac.at>

I just discovered why
	abline(lsfit(x, y))
does not produce any output (as I mentioned on Friday).  In lsfit(), the
coefficients output component was incorrectly named "coef" and not
"coefficients", hence the coefficients method returned NULL ...

The patch below fixes the problem.

-k

************************************************************************
*** src/library/base/funs/lsfit.orig	Sat Jul 26 09:38:47 1997
--- src/library/base/funs/lsfit	Sat Jul 26 09:39:46 1997
*************** lsfit <- function(x, y, wt=NULL, interce
*** 100,106 ****
  	}
  	z$qr <- as.matrix(z$qr)
  	colnames(z$qr) <- xnames
! 	output <- list(coef=z$coefficients, residuals=resids)
  
  	# if X matrix was collinear, then the columns would have been
  	# pivoted hence xnames need to be corrected
--- 100,106 ----
  	}
  	z$qr <- as.matrix(z$qr)
  	colnames(z$qr) <- xnames
! 	output <- list(coefficients=z$coefficients, residuals=resids)
  
  	# if X matrix was collinear, then the columns would have been
  	# pivoted hence xnames need to be corrected
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:46 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:46 +0200
Subject: R-alpha: R 0.50.a1 S_alloc BUG, priority = URGENT
Message-ID: <199707281323.PAA18627@aragorn.ci.tuwien.ac.at>

The current version of S_alloc in src/main/memory.c is

char *S_alloc(long nelem, int eltsize)
{
	unsigned int i, size;
	char *p = R_alloc(nelem, eltsize);
	for(i=0 ; i<size; i++)
		p[i] = 0;
	return p;
}

which segfaults because `size' is not initialized.  I am not what the
right fix is, adding

	size = nelem * eltsize;

before the loop seems to work.

As an aside ... I think the seed* functions in S are called

	seed_in
	seed_out

and not seeds_in and seeds_out as currently in src/main/random.c.

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 unlist() problems
Message-ID: <199707281323.PAA18658@aragorn.ci.tuwien.ac.at>

Two things.

TASKS has

TASK:	Naming with Numeric Values and "unlist"
STATUS:	Open
FROM:	<hornik@ci.tuwien.ac.at>
	R> l <- list("11" = 1:5)
	R> l
	$11
	[1] 1 2 3 4 5
	R> unlist(l)
	111 112 113 114 115 
	  1   2   3   4   5 
	[ Bug or feature ? ]

This seems to be a feature (at least, SPLUS does the same), so please
close that task.

***

However, please add the following.

***********************************************************************
R> x <- rnorm(20)
R> y <- rnorm(20)
R> z <- lm(y ~ x)

R> typeof(z)
[1] "list"

R> unlist(z)
[[1]]
[1] 0.07030757

[[2]]
[1] -0.1790483

[[3]]
NULL

[[4]]
NULL

and many more ending in

[[152]]
NULL

[[153]]
NULL

[[154]]
NULL
***********************************************************************

This seems to be a BUG.  SPLUS gives

***********************************************************************
 coefficients.(Intercept)       coefficients.x         residuals.1 
 "-0.322342946956607"     "-0.351990317000716" "-1.05699395125055"
          residuals.2          residuals.3          residuals.4 
 "0.0685214529487529" "-0.825270557482947" "-0.309643367007542"
          residuals.5         residuals.6          residuals.7 
 "-0.970498865234358" "0.239072541069321" "-0.203418862242607"
           residuals.8          residuals.9        residuals.10 
 "-0.0279508657540235" "-0.546704750104556" "-1.41036201719063"
         residuals.11         residuals.12       residuals.13 
 "-0.177627379541701" "-0.159357852715235" "1.01771682562243"
***********************************************************************

etc etc

I haven't looked into the unlist code at all.  Here's another problem.

***********************************************************************
R> l <- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
R> l
$a
$a[[1]]
[1] 1 2 3 4 5

$a[[2]]
[1] "A" "B" "C" "D" "E"


$b
[1] "Z"

$c
[1] NA

R> unlist(l)
INTERNAL ERROR: ans_nnames = 10    ans_length = 12
Error: incorrect names vector length
***********************************************************************

Hmm ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:47 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:47 +0200
Subject: R-alpha: R 0.50.a1 && gdb support
Message-ID: <199707281323.PAA18636@aragorn.ci.tuwien.ac.at>

Can we have gdb support?  (I don't use xxgdb.)

Perhaps in the wrapper one could add something like

*************************************************************
if [ "$1" = "-gdb" ]
then
	shift
	DEBUGGER=gdb
fi
*************************************************************

and at the end have

*************************************************************
if [ "$DEBUGGER" = "gdb" ]
then
    exec gdb $RHOME/bin/R.binary $*
else    
    exec $DEBUGGER $RHOME/bin/R.binary -v 4 $*
fi    
*************************************************************

Or is there a way to pass command line options for the program through
gdb?

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:49 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:49 +0200
Subject: R-alpha: R 0.50.a1 problem
Message-ID: <199707281323.PAA18657@aragorn.ci.tuwien.ac.at>

Here's something really strange.

********************************************************
R> x <- 1:5
R> x
[1] 1 2 3 4 5

R> test1
function (x) 
{
        structure(x, call = sys.call())
}
R> test1(x)
[1] 1 2 3 4 5
attr(,"call")
test1(x)

R> test2
function (x) 
{
        attr(x, "call") <- sys.call()
        x
}
R> test2(x)
Error: stack overflow
********************************************************

Using the attr() form results in an endless loop ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:48 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:48 +0200
Subject: R-alpha: R 0.50.a1:  small patches for graphics and image demo
Message-ID: <199707281323.PAA18638@aragorn.ci.tuwien.ac.at>

Applying the following patches closes the following task (part 1 was
already taken care of).

TASK:   New Problems
STATUS: Open
FROM:   <Kurt.Hornik@ci.tuwien.ac.at>
        New minor remarks:
        * The documentation for `image' still has the old order z, x, y.
        * Perhaps one should add `par(ask = T)' in the image demo?
        * Perhaps one should save the original value of par() at the
	beginning of the graphics demo, and restore that at its end
	(s.t. typically asking is turned off again).

Thanks,
-k

************************************************************************
*** demos/graphics/graphics.orig	Sat Jul 26 10:40:03 1997
--- demos/graphics/graphics	Sat Jul 26 10:37:50 1997
***************
*** 1,5 ****
  ###-*- R -*-
! par(ask = interactive() && .Device == "X11")	# For source
  
  # Here is some code which illustrates some of the differences between
  # R and S graphics capabilities.  Note that colors are generally specified
--- 1,6 ----
  ###-*- R -*-
! 
! opar <- par(ask = interactive() && .Device == "X11")	# For source
  
  # Here is some code which illustrates some of the differences between
  # R and S graphics capabilities.  Note that colors are generally specified
*************** data("volcano")
*** 115,121 ****
  x <- 10*1:nrow(volcano)
  y <- 10*1:ncol(volcano)
  l <- pretty(range(volcano), 10)
! opar <- par(bg="lightcyan")
  pin <- par("pin")
  xdelta <- diff(range(x))
  ydelta <- diff(range(y))
--- 116,122 ----
  x <- 10*1:nrow(volcano)
  y <- 10*1:ncol(volcano)
  l <- pretty(range(volcano), 10)
! par(bg="lightcyan")
  pin <- par("pin")
  xdelta <- diff(range(x))
  ydelta <- diff(range(y))
*************** mtext("10 Meter Contour Spacing", side=3
*** 141,144 ****
--- 142,146 ----
  par(bg="cornsilk")
  data(quakes)
  coplot(long~lat|depth, data=quakes, pch=21, bg="green3")
+ 
  par(opar)
*** demos/graphics/image.orig	Sat Jul 26 10:40:07 1997
--- demos/graphics/image	Sat Jul 26 10:41:46 1997
***************
*** 1,4 ****
--- 1,7 ----
  #### -*- R -*-
+ 
+ opar <- par(ask = interactive() && .Device == "X11") # For source
+ 
  data(volcano)
  x <- 10*(1:nrow(volcano))
  y <- 10*(1:ncol(volcano))
*************** axis(2, at=seq(100, 600, by=100))
*** 30,32 ****
--- 33,36 ----
  box()
  title(main="Maunga Whau Volcano", font.main=4)
  
+ par(opar)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jul 28 14:23:46 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Jul 1997 15:23:46 +0200
Subject: R-alpha: R 0.50.a1:  patch for NChisquare documentation
Message-ID: <199707281323.PAA18624@aragorn.ci.tuwien.ac.at>

The patch below fixes the NChisquare documentation problem that I've
been mentioning for some time now.

NOTE:  There is one DEQN where the LaTeX part contains real LaTeX code,
because I did not see how to get a sum sign (and a roman math font)
otherwise.  Seems to work, though ... MARTIN?

-k

**********************************************************************
*** src/library/base/man/NChisquare.orig	Sat Jul 26 10:50:54 1997
--- src/library/base/man/NChisquare	Sat Jul 26 11:26:23 1997
***************
*** 1,26 ****
  TITLE(NChisquare @@ The Non-Central Chi-Square Distribution)
  USAGE(
! dnchisq(x, df)
! pnchisq(x, df)
! qnchisq(x, df)
! rnchisq(x, df)
  )
  ALIAS(dnchisq)
  ALIAS(pnchisq)
  ALIAS(qnchisq)
  ALIAS(rnchisq)
  DESCRIPTION(
! These functions provide information about the non-central
! chi-square distribution with LANG(df) degrees of freedom.
! LANG(dnchisq) gives the density, LANG(pnchisq) gives the
! distribution function LANG(qnchisq) gives the quantile
  function and LANG(rnchisq) generates random deviates.
  PARA
! The non-central chi-square distribution with EQN(n)
! degrees-of-freedom has density
! DEQN(f(x) =
! OVER(1 @@ SUP(2@@n/2) greekGamma (n/2))
! SUP(x@@n/2-1) SUP(e@@-x/2)
! @@f(x) = 1 / (2^(n/2) Gamma(n/2))  x^(n/2-1) e^-x/2)
  for EQN(x GE 0).
  )
--- 1,28 ----
  TITLE(NChisquare @@ The Non-Central Chi-Square Distribution)
  USAGE(
! dnchisq(x, df, lambda)
! pnchisq(x, df, lambda)
! qnchisq(x, df, lambda)
! rnchisq(x, df, lambda)
  )
  ALIAS(dnchisq)
  ALIAS(pnchisq)
  ALIAS(qnchisq)
  ALIAS(rnchisq)
  DESCRIPTION(
! These functions provide information about the non-central chi-square
! distribution with LANG(df) degrees of freedom and non-centrality
! parameter LANG(lambda).  LANG(dnchisq) gives the density, LANG(pnchisq)
! gives the distribution function LANG(qnchisq) gives the quantile
  function and LANG(rnchisq) generates random deviates.
  PARA
! The non-central chi-square distribution with EQN(df) degrees of freedom
! and non-centrality parameter EQN(greeklambda) has density
! DEQN(f(x) = SUP(e @@ -\lambda / 2)
!   \sum_{r=0}^\infty \frac{\lambda^r}{2^r r!} \mathrm{pchisq}(x, df + 2r) 
!   @@
!   f(x) = exp(-lambda/2) SUM_{r=0}^infty (lambda^r / 2^r r!)
!   pchisq(x, df + 2r)
! )
  for EQN(x GE 0).
  )
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Jul 28 20:24:45 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 28 Jul 1997 21:24:45 +0200
Subject: R-alpha: R 0.50.a1 problem
In-Reply-To: Kurt Hornik's message of Mon, 28 Jul 1997 15:23:49 +0200
References: <199707281323.PAA18657@aragorn.ci.tuwien.ac.at>
Message-ID: <x2bu3nj7ya.fsf@bush.kubism.ku.dk>

Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

> R> test2
> function (x) 
> {
>         attr(x, "call") <- sys.call()
>         x
> }
> R> test2(x)
> Error: stack overflow
> ********************************************************
> 
> Using the attr() form results in an endless loop ...

Sounds familiar. The "assignment causes evaluation effect". Hey,
here's an amusing variant:

> fff<-function(){cll<-substitute(ls());print(cll);x<-1;
attr(x,"junk")<-cll;x}
> fff
function () 
{
        cll <- substitute(ls())
        print(cll)
        x <- 1
        attr(x, "junk") <- cll
        x
}
> fff()
ls()
[1] 1
attr(,"junk")
[1] "*tmp*" "cll"   "x"    
> fff
function () 
{
        cll <- substitute(ls())
        print(cll)
        x <- structure(1, junk = c("*tmp*", "cll", "x"))
        attr(x, "junk") <- cll
        x
}
> 

...I know that R is a functional programming language and that
functions can write and modify other functions, but this seems to be
overdoing it a bit, donchathinkso <evil grin>? 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Tue Jul 29 10:28:50 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
Subject: R-alpha: Bugs in R-0.50-a1.
Message-ID: <9707290928.AA07210@alpha.luc.ac.be>

Problems in R but not in S:
---------------------------

1) 'unlist' seems to have several other problems than the ones
reported up to now. For instance, 'unlist' can be used on almost any
object in S without much trouble. Eg.:
	S> unlist(c(2))
	[1] 2
	S>
	---
	R> unlist(c(2))
	Segmentation fault (core dumped)
This occurs in R-0.49 and in R-0.50-a1.

2) Problem with the parser: When a function contains a condition
between brackets the closing bracket must be adjacent to the last item
in R but not in S. Here is an example:
	S> new <- function (x,y,z,k) {
	S+ message <- list(x,y,a=if(z) k
	S+ )
	S+ message
	S+ }
	S>
	---
	R> new <- function (x,y,z,k) {
	R+ message <- list(x,y,a=if(z) k
	R+ )
	)
	^
	Error: syntax error
	R> 
This occurs in R-0.49 and in R-0.50-a1.


Problems in R:
--------------

1) The 'R Graphics' window does not have any X class or resource and
therefore cannot be given a default size or geometry. Would it be
possible to give the graphic window a class name so that the size
could be specified in the '.Xdefaults' file?

2) It does not appear to be possible to specify the 'xlim' when using
boxplot. This might also be the case in S but would be nice to
have. Eg., when plotting several boxplots together, lets say 7. One
would generally plot 4 first and then 3. Hence, if they are fitted on
the same page the boxplots of the first line will be wider than on the
second...

3) Some problems occur when using the help. Eg.,
R> ?"+"
sorry, no help for "Arithmetic".
R>
This occurs in R-0.49 and in R-0.50-a1 and seems to be the case for
any item contained in a help file starting with a capital letter.

4) The option 'right' when using print gives an error. In S,
'print.default' calls 'print.structure' and then 'print.matrix'. This
last one allows this option. Can anything be done as 'print.default'
is internal in R?

5) The control-c still does not work on R-0.50-a1 under certain
variants of Linux. What is the easiest way to fix this?

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jul 29 12:31:39 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Jul 1997 13:31:39 +0200
Subject: R-alpha: Bugs in R-0.50-a1.
In-Reply-To: Patrick Lindsey's message of Tue, 29 Jul 1997 11:28:50 +0200 (MET DST)
References: <9707290928.AA07210@alpha.luc.ac.be>
Message-ID: <x2u3hegkmc.fsf@bush.kubism.ku.dk>

Patrick Lindsey <plindsey@luc.ac.be> writes:

> 5) The control-c still does not work on R-0.50-a1 under certain
> variants of Linux. What is the easiest way to fix this?

Upgrade the readline library to v.2.1 and relink (for some reason that
I never figured out, this installs as libreadline.so.3.0, unless you
specifically tell it otherwise), RedHat has an RPM package in the
contrib section. Debians package is the newer one.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Ben Bolker <ben@eno.Princeton.EDU>  Tue Jul 29 16:58:08 1997
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 29 Jul 1997 11:58:08 -0400 (EDT)
Subject: R-alpha: more graphics: lwd, persistent lty settings
Message-ID: <Pine.SUN.3.95.970729114304.26114A-100000@paca>


  [ SunOS 4.1.3, R-0.50-a1; I'm mostly very pleased, I haven't been
pounding on it as hard as some folks have ]
 
   par(lwd) seems to be a bit of a stub right now; I wouldn't necessarily
expect it to do anything in the x11() driver (nor would I know how to fix
it), but it would be nice in the postscript driver (e.g. for thick lines
for things to be made into slides).
   I will try to work on this, but I wouldn't mind if someone got there
before me.

  Also: the effects of setting lty are sometimes unnecessarily persistent
-- for example in the example below the box around the legend is drawn in
line type 2 (dashed) -- I would think that the GSavePars/GRestorePars
calls at the beginning and end of abline (in plot.c) ought to do the job,
but I haven't had time to go through it in detail ... 

x _ (1:100)/10
plot(x,sin(x))
abline(h=0,lty=2)
legend(0,-0.1,"a",pch=1)


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Jul 29 21:45:10 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Jul 1997 08:45:10 +1200 (NZST)
Subject: R-alpha: stat.auckland.ac.nz
Message-ID: <199707292045.IAA07780@stat1.stat.auckland.ac.nz>

The R anon-ftp site at stat.auckland.ac.nz is currently out of action.
We are in the throws of upgrading from a tired old SparcServer 10 to a
new Sun Enterprise Server.  Normality should be restored within the
next couple of days.

The good news is that we can configure and compile R in rather less
than a minute.  This should help the development process.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Jul 30 00:58:14 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Jul 1997 11:58:14 +1200 (NZST)
Subject: R-alpha: R-beta: RPM package for R
In-Reply-To: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
References: <3.0.1.16.19970729173011.31175978@droopy.iarc.fr>
Message-ID: <199707292358.LAA18350@stat1.stat.auckland.ac.nz>

Martyn Plummer writes in r-announce:
 > A precompiled "RPM" binary of R-0.50.a1 is now available on CRAN for
 > installation on Linux systems which use the RedHat Package
 > Manager

Before we get to may versions floating about ... 

I had intended that these "a1", "a2" ... releases be hacker releases
which will be followed by a R-0.50.stable release when the (worst)
problems are sorted out.  Thats why I announced to "r-devel" rather
than "r-announce".

(Note this is information rather than any kind of policy statement,
you are of course free to do whatever you like with R)
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Wed Jul 30 02:29:54 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Wed, 30 Jul 1997 13:29:54 +1200 (NZST)
Subject: R-alpha: Environment strangeness
Message-ID: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>

Peter Dalgaard asked about environments,

----- Begin Included Message -----

 
Maybe I'm just not understanding things well enough (actually, that's
why I was fooling around with this in the first place), but:

> g
function()
{
	e<-sys.frame(sys.parent())
	print(ls(envir=e))
	eval(print(b), e)
}
> f
function () 
{
        b <- 7913
        g()
}
> f()
[1] "b"
Error: Object "b" not found

Er? Is "b" in environment "e" or not?

 
----- End Included Message -----

Ross and I have been back and forth on this one a few times already;
it's probably a faq (Kurt);
  eval evaluates an expression in an environment; 
 consider the two cases below

1)
  a<-expression(x+y)
  eval(a,e1)

2)
  eval(x+y,e1)

 Now, there is no way these can both work. It seems like the first option
is to be preferred because the second can easily be achieved by wrapping
an expression around the x+y (with the first option as the default). Used in
this manner expression is a quoting mechanism.
 eval(expression(x+y),e1) does what you want.
 If 2) is the default mechanism then there is no easy way to get 1) to work
since what we want there is the value bound to a in the environment that
eval is called from not the value of a in e1.
  So Peter's example with a small change,
g<-function() {
	e<-sys.frame(sys.parent())
	print(ls(envir=e))
	eval(expression(print(b),e)
}

will work as desired.

robert
   
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Ben Bolker <ben@eno.Princeton.EDU>  Wed Jul 30 02:54:34 1997
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 29 Jul 1997 21:54:34 -0400 (EDT)
Subject: R-alpha: line types
Message-ID: <Pine.SUN.3.95.970729161448.26747A-100000@paca>


  Responding to my own post, after some hacking:

  To fix the behavior of the following test code (the rect()s inherit the
lty set by the previous abline())--

x _ (1:100)/10
plot(x,sin(x))
abline(h=0,lty=2,col="red")
rect(1,0,2,0.5)
abline(v=2)
rect(3,0,4,0.5)

Here are some diffs (now all I have to do is wade through and get lwd
working properly ...)

*** devX11.c.orig	Tue Jul 29 16:44:19 1997
--- devX11.c	Tue Jul 29 16:57:55 1997
***************
*** 671,676 ****
--- 671,677 ----
  	}
  	if (fg != NA_INTEGER) {
  		SetColor(fg);
+ 		SetLinetype(GP->lty);
  		XDrawRectangle(display, window, wgc, (int)x0, (int)y0,
  			(int)x1 - (int)x0, (int)y1 - (int)y0);
  	}
*** devPS.c.orig	Sun Jul  6 21:29:03 1997
--- devPS.c	Tue Jul 29 17:01:05 1997
***************
*** 433,438 ****
--- 433,439 ----
  	}
  	if(fg != NA_INTEGER) {
  		SetColor(fg);
+ 		SetLinetype(GP->lty);
  		PostScriptOpenRectangle(psfp, x0, y0, x1, y1);
  	}
  }
*** plot.c.orig	Tue Jul 29 16:43:34 1997
--- plot.c	Tue Jul 29 16:51:02 1997
***************
*** 875,880 ****
--- 875,883 ----
  
  	GSavePars();
  
+ 	if(nlty && INTEGER(lty)[i % nlty] != NA_INTEGER) GP->lty = INTEGER(lty)[i % nlty];
+ 	else GP->lty = DP->lty;
+ 
  	xl = REAL(sxl);
  	xr = REAL(sxr);
  	yb = REAL(syb);


Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Jul 30 13:12:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Jul 1997 14:12:40 +0200
Subject: R-alpha: Environment strangeness
In-Reply-To: Robert Gentleman's message of Wed, 30 Jul 1997 13:29:54 +1200 (NZST)
References: <199707300129.NAA21654@stat1.stat.auckland.ac.nz>
Message-ID: <x2204gg2mf.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> Ross and I have been back and forth on this one a few times already;
> it's probably a faq (Kurt);
                ^^^^^

This belongs on the *manual page*. I suggest something along these
lines:

NOTE( Calling LANG(eval(x+y,e)) does not do what one might think. To
get values of LANG(x) and LANG(y) looked up in the environment
LANG(e), use LANG(eval(expression(x+y),e)). The logic is that
LANG(expr) is usually a simple variable ITALIC(containing) an
expression to evaluate or a LANG(substitute(...)) call
ITALIC(resulting) in an expression. Hence, the value of LANG(expr) is
passed to the evaluator.
)


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Wed Jul 30 15:50:05 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 30 Jul 1997 10:50:05 -0400 (EDT)
Subject: R-alpha: more on line types
Message-ID: <Pine.SUN.3.95.970730101356.8353A-100000@eno.Princeton.EDU>


   forgot to fix psx11.c and devPicTeX.c while I was at it (devPicTeX.c
doesn't seem to change the color).  Should psx11.c be devpsx11.c?  Diffs:

*** psx11.c.orig	Wed Jul 30 10:08:48 1997
--- psx11.c	Wed Jul 30 10:09:10 1997
***************
*** 293,298 ****
--- 293,299 ----
  	}
  	if(fg != NA_INTEGER) {
  		psx11_SetColor(fg);
+ 		psx11_SetLinetype(GP->lty);
  		PostScriptOpenRectangle(psfp,
  			xoffset + xscale * x0,
  			yoffset + yscale * y0,
*** devPicTeX.c.orig	Wed Jul 30 10:16:33 1997
--- devPicTeX.c	Wed Jul 30 10:11:24 1997
***************
*** 446,451 ****
--- 446,452 ----
  /* Possibly Filled Rectangle */
  static void PicTeX_Rect(double x0, double y0, double x1, double y1, int bg, int fg)
  {
+         SetLinetype(GP->lty);
  	PicTeX_MoveTo(x0, y0);
  	PicTeX_LineTo(x1, y0);
  	PicTeX_LineTo(x1, y1);

   A less trivial question about setting line widths: in X, the same call
(XSetLineAttributes) sets both line type and line width.  In PostScript
there are two separate calls.

  The following quick hack to SetLinetype() appears to work pretty well
for X11, although there may be a better way to do it (logically,
SetLinetype ought to take both lty and lwd as arguments, or there should
be a separate SetLinewidth -- however, if there were two functions each
would have to look at least briefly at the current settings so as not to
screw them up):

  Before doing this in PostScript (where the width and type are set in
separate calls), I'd like advice.
  Also, is there a particular reason that default line width in PostScript
is 0.75 and not 1.0?

*** devX11.c.orig	Tue Jul 29 16:44:19 1997
--- devX11.c	Wed Jul 30 10:21:43 1997
***************
*** 389,395 ****
  
  	if(newlty != lty) {
  		if(newlty == 0) {
! 			XSetLineAttributes(display, wgc, 1, LineSolid, CapRound, JoinRound);
  			lty = newlty;
  		}
  		else {
--- 389,395 ----
  
  	if(newlty != lty) {
  		if(newlty == 0) {
! 			XSetLineAttributes(display, wgc, GP->lwd, LineSolid, CapRound, JoinRound);
  			lty = newlty;
  		}
  		else {
***************
*** 400,406 ****
  				newlty = newlty>>4;
  			}
  			XSetDashes(display, wgc, 0, dashlist, ndash);
! 			XSetLineAttributes(display, wgc, 1,
  				LineOnOffDash, CapButt, JoinRound);
  		}
  	}
--- 400,406 ----
  				newlty = newlty>>4;
  			}
  			XSetDashes(display, wgc, 0, dashlist, ndash);
! 			XSetLineAttributes(display, wgc, GP->lwd,
  				LineOnOffDash, CapButt, JoinRound);
  		}
  	}





Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From plindsey@luc.ac.be  Thu Jul 31 08:34:02 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Thu, 31 Jul 1997 09:34:02 +0200 (MET DST)
Subject: R-alpha: More problems with R0.50.a1
Message-ID: <9707310734.AA26662@alpha.luc.ac.be>

More problems...

1) when -lf2c is used for linking as in the standard Makefile in
src/main, it does not include the library as shown by ldd on my
slackware linux 2.0.29 but does on RedHat linux 2.0.27. But with
slackware adding the -L/usr/lib just before -lf2c does include it. On
the other hand readline in the same directory is included both times.
(We need the f2c library for complex numbers in Richard Jones' carma
for kalman filtering which we are dynamically loading.)

2) matrix(2,nrow=3,ncol=3)[!is.na(matrix(2,nrow=3,ncol=3))]
gives a vector of nine 2's
if the matrix has row and column names, the vector has the 3 column
names completed with six NA names.

3) Robert's example on 'Environment strangeness' has 2 errors:
	- missing bracket on the second last line of his g function.
	- should not try to print before b has been retrieved from the
	  appropriate environment (on same line as above).

4) why does the following function yield errors with R scoping rules?
> p <- function () {
	b <- 123
	s()
}
> s <- function () {
	print(b)
}
> p()
Error: Object "b" not found.

5) getting the call line and saving it as an attribute:
This works:
> f <- function () {
	x <- match.call()
	print(x)
}
This recurses in an infinite loop, recalling the 'f' function each
time the "attr" line is stored in the "call" attribute of x.
> f <- function () {
	x <- 2
	print(x)
	attr(x,"call") <- match.call()
	print(attributes(x))
}

6) The following gives a error. How can this be solved?
> "[<-.newtype" <- function(...) {
	NextMethod("[<-")
}
> f <- function () {
	idx <- 2
	tmp <- matrix(3,ncol=4,nrow=4)
	class(tmp) <- "newtype"
	tmp[idx,] <- matrix(1,ncol=4,nrow=4)[2,]
}
> f()
Error: Object "idx" not found.

This did not work in R0.49 either, but does work in S..
(In R the name of the variable "idx" is passed to "[<-.newtype" in the
row and col local variable as in S it is the contents of "idx" which
are passed through.)
I had solved this for R0.49 by adding the line:
	idx <- eval(idx,sys.frame(sys.parent()))
But this does not work any more in R0.50.a1...
So I modified the line to:
        idx <- eval(expression(idx),sys.frame(sys.parent()))
but this did not change anything.
It looks as if the environments were not always retrieved properly and
that R scoping rules are not always followed. I thought that R would
be able to find any variable defined in a previous environment so that
they did not have to be passed from function to function as in S.

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jul 31 16:59:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 31 Jul 1997 17:59:00 +0200
Subject: R-alpha: Re: R-beta: Questions
In-Reply-To: <m0wqEgL-000FqEC@Tedistan.annex.umist.ac.uk>
 (Ted.Harding@nessie.mcc.ac.uk)
Message-ID: <199707311559.RAA25751@sophie.ethz.ch>


		(CC'ed to R-devel instead of R-help)

>>>>> "Ted" == Ted Harding <Ted.Harding@nessie.mcc.ac.uk> writes
			(on Jul 21, 1997):

    Ted> Q1: Is anyone collecting suggestions for amendments to the
    Ted> documentation (online "help" and R-Notes)? --

    Ted> Q2: (Supersedes Q1 to am unknown extent) -- or are there moves to
    Ted> bring R more in line with the documentation?

Yes to both.
Besides R & R (who collect and amend and ...),
I've also chosen to emphasize working on the on line help.
The 'R-devel' mailing list is also used to report / fix  documentation
glitches... 

You may want to have a look at the new alpha (pre)release of R 
which shows quite some improvements to documentation..
A new
	make tests
runs all the online "help" Examples

If you'd send  diffs of    src/library/base/man/... files to   R-devel,
chances are even higher
that the improvements will make it to subsequent releases..

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Jul 31 21:38:12 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 1 Aug 1997 08:38:12 +1200 (NZST)
Subject: R-alpha: More problems with R0.50.a1
Message-ID: <199707312038.IAA19799@stat1.stat.auckland.ac.nz>

Patrick,

   I can easily respond to some of the questions.
   
   2) That's the same thing S does (they don't propagate names though). There
    are many instances where coercion or subsetting causes a loss of
    dimensioning information. In this case you are asking for a subset of the
    values in x; you haven't specified a format for them so they come back as
    a vector.
   
   3) Sorry about that; I was working without cut and paste as we transferred
   to the new machine.
   
   4) b is defined in the environment created for the evaluation of p.
   The function s has as its parent the global environment (that's the
   environment that was active when s was defined). There is no value for
   b stored there hence s cannot find it. What you seem to want here
   is really dynamic scope rather than lexical scope. Dynamic scope was
   used in the early Lisp implementations but was quickly seen to be a
   mistake and I don't believe that it is used by any active languages
   (apart from people trying to fake it in Splus). 
   It's reasonably easy to tweak R to have this rather than lexical scope
   but the down side is pretty large. Imagine a more complicated system
   with a much deeper call stack; now s will grab the definition of b that
   is closest to it in the call stack; this may not be the one you want and
   it can take forever to find the problem.
   
   5) I think Ross has fixed this. At least both of the functions you gave
   run without error in the version I've got now. We will probably put up
   some patches pretty soon.
   
   6) This will take some work. I'm still unconvinced that any of this Method
   stuff deserves any effort whatsoever. It has to be a better idea to write
   a real object system rather than try to constantly patch this thing. But
   I will spend some time digging around. To see where idx has disappeared.
   
  
   robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

