From jo@ec|@ud|o@|@r|@ @end|ng |rom gm@||@com  Sat Jun  4 05:43:39 2022
From: jo@ec|@ud|o@|@r|@ @end|ng |rom gm@||@com (jcfaria)
Date: Sat, 04 Jun 2022 03:43:39 +0000
Subject: [Rd] Writing Extensions for R under Windows: is it better for GUIs
 to communicate with R via Rgui.exe, Rterm.exe or R.dll?
Message-ID: <emcfa70b95-004c-45fb-8936-55133f137688@dell>

Writing Extensions for R under Windows: is it better for GUIs to 
communicate with R via Rgui.exe, Rterm.exe or R.dll?

In the construction of extensions (GUIs) for R, in the establishment of 
communication, according to the options below:

1- Rgui.exe (via Windows API) vs. R.dll (embedded R)
2- Rterm.exe (via IPC) vs. R.dll (embedded R)

What are the advantages and disadvantages in each case?

I would like to take advantage of the email to thank Tomas Kalibera for 
his efforts in solving the problems
of R 4.2.0 communication and the Tinn-R project. Once fixed the issues 
in R that surfaced
due to using GraphApp (cross-platform GUI Library in C for Windows) it 
was possible to fix the communication issues in Tinn-R
with Rterm.exe and Rgui.exe. Version 9.01.XX.XX with the corrections 
will be released soon. At the moment we are in
extensive testing phase.

Thanks in advance,
///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\
Jose Claudio Faria
UESC/DCET/Brasil
joseclaudio.faria at gmail.com
Telefones:
55(73)3680.5545 - UESC
55(73)99966.9100 - VIVO
///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\
If you have software to deal with statistics, you have arms,
if you have good software, you have arms and legs,
if you have software like R, you have arms, legs and wings...
the height of your flight depends only on you.

	[[alternative HTML version deleted]]


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Tue Jun  7 08:09:29 2022
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Mon, 6 Jun 2022 23:09:29 -0700
Subject: [Rd] trace() an S3-classed function in .GlobalEnv
Message-ID: <CAPRVBcwOh0zst8mGTCfYXK6OXdGViGHUOiV5A8NhV4Lh6eo2gQ@mail.gmail.com>

Consider:

foo <- function() {
  invisible(1 + 1)
}
trace(foo, quote(message("traced")), print=FALSE)
foo()
# traced

But with a minimal change:

class(foo) <- "bar"
trace(foo, quote(message("traced")), print=FALSE)
# Constructing traceable class ?barWithTrace?
# Error in .classEnv(className) :
#   unable to find an environment containing class ?bar?

I don't see anything like this mentioned in ?trace (nor does a Google
search turn up more than a handful of references to this error),
and from trying to debug what trace() is doing, we arrive to the error line[1]:

.makeTraceClass(traceClass, class(original))  #
methods:::.makeTraceClass("barWithTrace", "bar")

I don't quite follow what's going on here, but it looks like trace()
is trying to determine an S4 class definition for "bar", but isS4(bar)
is FALSE.

I can (apparently -- not sure if there are as yet-unseen downstream
consequences) work around the issue by unsetting the class, tracing,
then re-setting:

class(foo) <- NULL
trace(foo, quote(message("traced")), print=FALSE)
class(foo) <- "bar"

But obviously this is a bit clunky. Is this a bug, or am I missing something?

Mike C

[1] https://github.com/r-devel/r-svn/blob/e2a64a4e14adbc4e9e8635eaa8cbd2835ce1d764/src/library/methods/R/trace.R#L240


From @eb@@t|@n@kr@ntz @end|ng |rom gr@du@te|n@t|tute@ch  Tue Jun  7 20:44:39 2022
From: @eb@@t|@n@kr@ntz @end|ng |rom gr@du@te|n@t|tute@ch (Sebastian Martin Krantz)
Date: Tue, 7 Jun 2022 20:44:39 +0200
Subject: [Rd] R CMD Check should allow packages with C and C++ and OpenMP
 without generating a NOTE
Message-ID: <CAOsNuxCte7DOu5kBjH44CxeJnR=bHr7DVAZZk=rQ9M_J5502qA@mail.gmail.com>

Dear Developers,

I have the following issue with my package collapse:
https://github.com/SebKrantz/collapse,
whose code base is 34.5% C code and 28.3% C++, and to which I now want to
add OpenMP multithreading and send it to CRAN. For this I have set up a
Makevars file with

PKG_CFLAGS = $(SHLIB_OPENMP_CFLAGS)
PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS)
PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS)

as linking is through C++ via Rcpp. The problem is that this generates a
NOTE on R CMD Check:

src/Makevars: SHLIB_OPENMP_CFLAGS is included in PKG_CFLAGS but not in
PKG_LIBS

If I alternatively put

PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS) $(SHLIB_OPENMP_CFLAGS)

I get another NOTE stating that this is not portable. Finally putting

PKG_LIBS = $(SHLIB_OPENMP_CFLAGS)

gives a note (or warning) that linking is through C++. CRAN maintainers
have not engaged constructively with me on the issue, but I do believe this
is an issue requiring constructive engagement i.e. I believe R CMD Check
should be adjusted to allow for such a configuration, and possibly some
instructions should be added to the Writing R Extensions Manual. I have
also asked Dirk Eddelbuettel (
https://github.com/SebKrantz/collapse/issues/258) who agrees that this is
an upstream issue. I am happy for any proactive comments or suggestions.

Best regards,

Sebastian Krantz

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed Jun  8 12:44:21 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 8 Jun 2022 12:44:21 +0200
Subject: [Rd] trace() an S3-classed function in .GlobalEnv
In-Reply-To: <CAPRVBcwOh0zst8mGTCfYXK6OXdGViGHUOiV5A8NhV4Lh6eo2gQ@mail.gmail.com>
References: <CAPRVBcwOh0zst8mGTCfYXK6OXdGViGHUOiV5A8NhV4Lh6eo2gQ@mail.gmail.com>
Message-ID: <25248.32133.650644.55624@stat.math.ethz.ch>

>>>>> Michael Chirico 
>>>>>     on Mon, 6 Jun 2022 23:09:29 -0700 writes:

    > Consider:

    > foo <- function() {
    > invisible(1 + 1)
    > }
    > trace(foo, quote(message("traced")), print=FALSE)
    > foo()
    > # traced

    > But with a minimal change:

    > class(foo) <- "bar"
    > trace(foo, quote(message("traced")), print=FALSE)
    > # Constructing traceable class ?barWithTrace?
    > # Error in .classEnv(className) :
    > #   unable to find an environment containing class ?bar?

    > I don't see anything like this mentioned in ?trace (nor does a Google
    > search turn up more than a handful of references to this error),
    > and from trying to debug what trace() is doing, we arrive to the error line[1]:

    > .makeTraceClass(traceClass, class(original))  #
    > methods:::.makeTraceClass("barWithTrace", "bar")

    > I don't quite follow what's going on here, but it looks like trace()
    > is trying to determine an S4 class definition for "bar", but isS4(bar)
    > is FALSE.

    > I can (apparently -- not sure if there are as yet-unseen downstream
    > consequences) work around the issue by unsetting the class, tracing,
    > then re-setting:

    > class(foo) <- NULL
    > trace(foo, quote(message("traced")), print=FALSE)
    > class(foo) <- "bar"

    > But obviously this is a bit clunky. Is this a bug, or am I missing something?

Just a short note of  semi-confirmation:

At the time S4 generics and methods were introduced into R,
trace() was made much more flexible, notably to be able to trace
S4 methods.

It can well be that it originally also worked for functions with
an explicit S3 class, but as such functions are very rare, it
could well be you've found a bug, namely that trace() assumes
that if a function has a non-trivial class, it must be an S4
one.

... and I know you know how to report bugs ;-)

Thank you in advance!
Martin

    > Mike C

    > [1] https://github.com/r-devel/r-svn/blob/e2a64a4e14adbc4e9e8635eaa8cbd2835ce1d764/src/library/methods/R/trace.R#L240

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From @eb@@t|@n@kr@ntz @end|ng |rom gr@du@te|n@t|tute@ch  Wed Jun  8 14:00:15 2022
From: @eb@@t|@n@kr@ntz @end|ng |rom gr@du@te|n@t|tute@ch (Sebastian Martin Krantz)
Date: Wed, 8 Jun 2022 14:00:15 +0200
Subject: [Rd] 
 R CMD Check should allow packages with C and C++ and OpenMP
 without generating a NOTE
In-Reply-To: <CAOsNuxCte7DOu5kBjH44CxeJnR=bHr7DVAZZk=rQ9M_J5502qA@mail.gmail.com>
References: <CAOsNuxCte7DOu5kBjH44CxeJnR=bHr7DVAZZk=rQ9M_J5502qA@mail.gmail.com>
Message-ID: <CAOsNuxDjhYQQ4127NicL+2vR3mj66rvwcKVm7-r9FsKzRB8jwA@mail.gmail.com>

For the record: it seems a simple text-substitution approach in the
Makevars file solves the issue, e.g. to have a package combining C, C++ and
OpenMP, your Makevars file could look like this:

PKG_CFLAGS = $($(subst OPENMP,OPENMP_CFLAGS,SHLIB_OPENMP))
PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS)
PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS)

where $($(subst OPENMP,OPENMP_CFLAGS,SHLIB_OPENMP)) substitutes
OPENMP_CFLAGS for OPENMP, thus reconstructing SHLIB_OPENMP_CFLAGS and
avoiding errors from static code analysis on R CMD Check.

Needless to say this is not very elegant and it would be great if R CMD
Check could be adjusted.

Best regards,

Sebastian

On Tue, 7 Jun 2022 at 20:44, Sebastian Martin Krantz <
sebastian.krantz at graduateinstitute.ch> wrote:

> Dear Developers,
>
> I have the following issue with my package collapse:
> https://github.com/SebKrantz/collapse,
> whose code base is 34.5% C code and 28.3% C++, and to which I now want to
> add OpenMP multithreading and send it to CRAN. For this I have set up a
> Makevars file with
>
> PKG_CFLAGS = $(SHLIB_OPENMP_CFLAGS)
> PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS)
> PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS)
>
> as linking is through C++ via Rcpp. The problem is that this generates a
> NOTE on R CMD Check:
>
> src/Makevars: SHLIB_OPENMP_CFLAGS is included in PKG_CFLAGS but not in
> PKG_LIBS
>
> If I alternatively put
>
> PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS) $(SHLIB_OPENMP_CFLAGS)
>
> I get another NOTE stating that this is not portable. Finally putting
>
> PKG_LIBS = $(SHLIB_OPENMP_CFLAGS)
>
> gives a note (or warning) that linking is through C++. CRAN maintainers
> have not engaged constructively with me on the issue, but I do believe this
> is an issue requiring constructive engagement i.e. I believe R CMD Check
> should be adjusted to allow for such a configuration, and possibly some
> instructions should be added to the Writing R Extensions Manual. I have
> also asked Dirk Eddelbuettel (
> https://github.com/SebKrantz/collapse/issues/258) who agrees that this is
> an upstream issue. I am happy for any proactive comments or suggestions.
>
> Best regards,
>
> Sebastian Krantz
>
>
>
>
>

	[[alternative HTML version deleted]]


From @cott @end|ng |rom p@tchmypc@com  Wed Jun  8 14:36:10 2022
From: @cott @end|ng |rom p@tchmypc@com (Scott McAllister)
Date: Wed, 8 Jun 2022 12:36:10 +0000
Subject: [Rd] Unsigned binary
Message-ID: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>

Good afternoon

Are you aware that the current release of R for Windows (4.2.0) is unsigned? Do you have any plans to rectify this ?

Thanks,

Scott McAllister - Support Engineer
Rate Your Experience: Great<https://patchmypc.com/customer-feedback-scott> | Good<https://patchmypc.com/customer-feedback-scott> | Poor<https://patchmypc.com/customer-feedback-scott>
Support Session: 30 Minutes<https://patchmypc.com/scott-30-minute-session> | 60 Minutes<https://patchmypc.com/scott-60-minute-session>
Learn More: Live Demo<https://patchmypc.com/schedule-live-demo> | Setup Call<https://patchmypc.com/schedule-setup-call> | Review Call<https://patchmypc.com/environment-review-call> | Trial<https://patchmypc.com/free-trial> | Quote<https://patchmypc.com/request-quote>
Follow Us: Twitter<https://patchmypc.com/twitter> | LinkedIn<https://patchmypc.com/linkedin>
Sales and Support: + 1-866-343-3083
[Sent from Front]

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jun  8 16:57:54 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 8 Jun 2022 17:57:54 +0300
Subject: [Rd] 
 Writing Extensions for R under Windows: is it better for GUIs
 to communicate with R via Rgui.exe, Rterm.exe or R.dll?
In-Reply-To: <emcfa70b95-004c-45fb-8936-55133f137688@dell>
References: <emcfa70b95-004c-45fb-8936-55133f137688@dell>
Message-ID: <20220608175754.5dbd228a@arachnoid>

On Sat, 04 Jun 2022 03:43:39 +0000
jcfaria <joseclaudio.faria at gmail.com> wrote:

> Writing Extensions for R under Windows: is it better for GUIs to 
> communicate with R via Rgui.exe, Rterm.exe or R.dll?

Well, WRE section 8 is all about linking the GUI to R as a DLL. It does
mention the alternative approaches like Rserve or DCOM, but such
interfaces are limited to some extents.

> In the construction of extensions (GUIs) for R, in the establishment
> of communication, according to the options below:
> 
> 1- Rgui.exe (via Windows API) vs. R.dll (embedded R)

Setting aside the fact that Windows API is not cross platform (which
may be not the point if you're writing a Windows-only GUI), the
messages that the application accepts and interprets are not a part of
a documented interface, so while they tend to be stable (because
Windows is mostly stable in handing the same kinds of messages to the
applications running there), they may be broken (like in R 4.2.0).

Linking to R.dll has a higher initial cost of setting up (you have to
write those callbacks, you have to set up R_HOME...), but the interface
won't be broken without a good reason and a migration plan.

> 2- Rterm.exe (via IPC) vs. R.dll (embedded R)

The console interface might be better understood and more stable than
passing messages to windows. If you're writing some kind of universal
interface suitable for different applications, all of which run a
Run-Eval-Print Loop in the command line, this may be a better approach
to take instead of linking to them individually. Although not without
problems [*], this is probably more stable than talking to Rgui.exe by
means of SendInput().

> What are the advantages and disadvantages in each case?

The advantages of linking to R.dll include being able to set up all
kinds of callbacks (EditFile, Busy, dataentry/dataviewer/selectlist) to
make their behaviour fit the theme of your application. The
disadvantages include a higher initial cost of setting it up and maybe
having to recompile it for different versions of R.

-- 
Best regards,
Ivan

[*] Check out ConEmu <https://conemu.github.io/> source code for
workarounds they probably amassed for all kinds of applications that
would otherwise prefer to be running in the standard console window.


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Wed Jun  8 19:12:25 2022
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Wed, 8 Jun 2022 10:12:25 -0700
Subject: [Rd] trace() an S3-classed function in .GlobalEnv
In-Reply-To: <25248.32133.650644.55624@stat.math.ethz.ch>
References: <CAPRVBcwOh0zst8mGTCfYXK6OXdGViGHUOiV5A8NhV4Lh6eo2gQ@mail.gmail.com>
 <25248.32133.650644.55624@stat.math.ethz.ch>
Message-ID: <CAPRVBczpqRsvqcUaFMdC333_iYo4w7+M+i6hVGU59ZZ0Vn0+kQ@mail.gmail.com>

Thanks, that seems like a reasonable assessment.

Also worth noting that tracing wipes out a function's attributes,
which is also not documented:

foo = function(x) {
  invisible(1 + 1)
}
attr(foo, "bar") <- 2

trace(foo, quote(message('traced')))
names(attributes(foo))
# [1] "original" "source"   "class"

PS one day I hope to master the dark art of choosing r-devel or
bugzilla for issues :)

On Wed, Jun 8, 2022 at 3:44 AM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> Michael Chirico
> >>>>>     on Mon, 6 Jun 2022 23:09:29 -0700 writes:
>
>     > Consider:
>
>     > foo <- function() {
>     > invisible(1 + 1)
>     > }
>     > trace(foo, quote(message("traced")), print=FALSE)
>     > foo()
>     > # traced
>
>     > But with a minimal change:
>
>     > class(foo) <- "bar"
>     > trace(foo, quote(message("traced")), print=FALSE)
>     > # Constructing traceable class ?barWithTrace?
>     > # Error in .classEnv(className) :
>     > #   unable to find an environment containing class ?bar?
>
>     > I don't see anything like this mentioned in ?trace (nor does a Google
>     > search turn up more than a handful of references to this error),
>     > and from trying to debug what trace() is doing, we arrive to the error line[1]:
>
>     > .makeTraceClass(traceClass, class(original))  #
>     > methods:::.makeTraceClass("barWithTrace", "bar")
>
>     > I don't quite follow what's going on here, but it looks like trace()
>     > is trying to determine an S4 class definition for "bar", but isS4(bar)
>     > is FALSE.
>
>     > I can (apparently -- not sure if there are as yet-unseen downstream
>     > consequences) work around the issue by unsetting the class, tracing,
>     > then re-setting:
>
>     > class(foo) <- NULL
>     > trace(foo, quote(message("traced")), print=FALSE)
>     > class(foo) <- "bar"
>
>     > But obviously this is a bit clunky. Is this a bug, or am I missing something?
>
> Just a short note of  semi-confirmation:
>
> At the time S4 generics and methods were introduced into R,
> trace() was made much more flexible, notably to be able to trace
> S4 methods.
>
> It can well be that it originally also worked for functions with
> an explicit S3 class, but as such functions are very rare, it
> could well be you've found a bug, namely that trace() assumes
> that if a function has a non-trivial class, it must be an S4
> one.
>
> ... and I know you know how to report bugs ;-)
>
> Thank you in advance!
> Martin
>
>     > Mike C
>
>     > [1] https://github.com/r-devel/r-svn/blob/e2a64a4e14adbc4e9e8635eaa8cbd2835ce1d764/src/library/methods/R/trace.R#L240
>
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Thu Jun  9 13:03:10 2022
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (NP))
Date: Thu, 9 Jun 2022 11:03:10 +0000
Subject: [Rd] Behavior of ylim in boxplot() when horizontal=TRUE
Message-ID: <6677093c725645a68ee92cdf054fdf87@UM-MAIL3214.unimaas.nl>

Hi all,

I just noticed something when using boxplot(). Say we have this boxplot:

boxplot(mpg ~ cyl, data=mtcars, xlab="Cylinders", ylab="Miles per Galon", ylim=c(10,40), log="y")

ylab, ylim, and log="y" are all consistently adjusting things on the y-axis (the numeric 'outcome' variable).

Now let's use horizontal=TRUE:

boxplot(mpg ~ cyl, data=mtcars, las=1, xlab="Miles per Galon", ylab="Cylinders", horizontal=TRUE, ylim=c(10,40), log="x")

Now xlab and log="x" are used to adjust things on the x-axis, but ylim still needs to be used to adjust the range of the numeric 'outcome' variable. Not a big deal, but this seems a bit inconsistent.

Best,
Wolfgang


From pd@|gd @end|ng |rom gm@||@com  Fri Jun 10 14:01:41 2022
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Fri, 10 Jun 2022 14:01:41 +0200
Subject: [Rd] R 4.2.1 scheduled for June 23
Message-ID: <492506A5-D562-4E87-BA6C-A25CB185AD57@gmail.com>

Full schedule available on developer.r-project.org in a short while.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From @tephen@berm@n @end|ng |rom gmx@net  Tue Jun 14 11:18:06 2022
From: @tephen@berm@n @end|ng |rom gmx@net (Stephen Berman)
Date: Tue, 14 Jun 2022 11:18:06 +0200
Subject: [Rd] qt() returns Inf with certain negative ncp values
Message-ID: <871qvrmwmp.fsf@gmx.net>

I asked about the following observations on r-help and it was suggested
that they may indicate an algorithmic problem with qt(), so I thought I
should report them here.


The Inf results below seem surprising:

> sapply(-1:-10, \(ncp) qt(1-1*(10^(-4+ncp)), 35, ncp))
 [1]  3.6527153  3.0627759  2.4158355  1.7380812  1.0506904  0.3700821
 [7]        Inf -0.9279783 -1.5341759 -2.1085213

> sapply(seq(-6.9, -7.9, -0.1), \(ncp) qt(1-1*(10^(-4+ncp)), 35, ncp))
 [1] -0.2268386        Inf        Inf        Inf -0.4857400 -0.5497784
 [7] -0.6135402 -0.6770143 -0.7401974 -0.8030853 -0.8656810

These inputs also yield many repetitions of the following warning
message:

In qt(1 - 1 * (10^(-4 + ncp)), 35, ncp) :
  full precision may not have been achieved in 'pnt{final}'

In particular, in the range -1:-10 I don't get this warning with ncp =
-1 through -4, but I do get it once with each of -5 and -8 through -10,
32 times with -6, and 50 times with -7.  In the range -6.9:-7.9 I get
the warning twice with each of -6.9 and -7.3 through -7.7, once with
-7.8 and -7.9, and 50 times with each of -7.0 through -7.2.


In case it matters:

> sessionInfo()
R Under development (unstable) (2022-06-05 r82452)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux From Scratch r11.0-165

Matrix products: default
BLAS:   /usr/lib/R/lib/libRblas.so
LAPACK: /usr/lib/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.3.0 tools_4.3.0


Thanks.
Steve Berman


From Andre@G||||bert @end|ng |rom chu-rouen@|r  Tue Jun 14 15:39:41 2022
From: Andre@G||||bert @end|ng |rom chu-rouen@|r (GILLIBERT, Andre)
Date: Tue, 14 Jun 2022 13:39:41 +0000
Subject: [Rd] qt() returns Inf with certain negative ncp values
In-Reply-To: <871qvrmwmp.fsf@gmx.net>
References: <871qvrmwmp.fsf@gmx.net>
Message-ID: <018a37d6d5864b1a88b11b811c876581@chu-rouen.fr>

Hello, 

> I asked about the following observations on r-help and it was suggested that they may indicate an algorithmic problem with qt(), so I thought I should report them here.

I explored numerical accuracy issues of pt and qt with non-central parameters.
There seems to be problems when probabilities are small (less than 10^-12 or 10^-14).

A few examples:
pnorm(-30)# equal to 4.9e-198, which looks fine
pt(-30, df=10000, ncp=0)# equal to 1e-189, which looks fine too
pt(-30, df=10000, ncp=0.01) # equal to 1.044e-14, which looks bad. It should be closer to zero than the previous one
pt(-300, df=10000, ncp=0.01) # equal to 1.044e-14, while it should be even closer to zero !
pt(-3000, df=10000, ncp=0.01) # still equal to 1.044e-14, while it should be even closer to zero !

qnorm(1e-13) # equal to -7.349, which looks fine
qt(1e-13, df=10000, ncp=0) # equal to -7.359, which looks fine
qt(1e-13, df=10000, ncp=0.01) # equal to -7.364, which looks fine
qt(1.044e-14, df=10000, ncp=0.01) # equal to -8.28, which looks fine
qt(1.043e-14, df=10000, ncp=0.01) # equal to -Inf, which is far too negative...

The source code shows that the non-central qt() works by inverting the non-central pt()
https://github.com/wch/r-source/blob/trunk/src/nmath/qnt.c
Consequently, both problems are related.



-----Message d'origine-----
De?: R-devel <r-devel-bounces at r-project.org> De la part de Stephen Berman
Envoy??: mardi 14 juin 2022 11:18
??: r-devel at r-project.org
Objet?: [Rd] qt() returns Inf with certain negative ncp values


I asked about the following observations on r-help and it was suggested that they may indicate an algorithmic problem with qt(), so I thought I should report them here.


The Inf results below seem surprising:

> sapply(-1:-10, \(ncp) qt(1-1*(10^(-4+ncp)), 35, ncp))
 [1]  3.6527153  3.0627759  2.4158355  1.7380812  1.0506904  0.3700821
 [7]        Inf -0.9279783 -1.5341759 -2.1085213

> sapply(seq(-6.9, -7.9, -0.1), \(ncp) qt(1-1*(10^(-4+ncp)), 35, ncp))
 [1] -0.2268386        Inf        Inf        Inf -0.4857400 -0.5497784
 [7] -0.6135402 -0.6770143 -0.7401974 -0.8030853 -0.8656810

These inputs also yield many repetitions of the following warning
message:

In qt(1 - 1 * (10^(-4 + ncp)), 35, ncp) :
  full precision may not have been achieved in 'pnt{final}'

In particular, in the range -1:-10 I don't get this warning with ncp =
-1 through -4, but I do get it once with each of -5 and -8 through -10,
32 times with -6, and 50 times with -7.  In the range -6.9:-7.9 I get the warning twice with each of -6.9 and -7.3 through -7.7, once with
-7.8 and -7.9, and 50 times with each of -7.0 through -7.2.


In case it matters:

> sessionInfo()
R Under development (unstable) (2022-06-05 r82452)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux From Scratch r11.0-165

Matrix products: default
BLAS:   /usr/lib/R/lib/libRblas.so
LAPACK: /usr/lib/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.3.0 tools_4.3.0


Thanks.
Steve Berman

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Tue Jun 14 18:00:24 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Tue, 14 Jun 2022 18:00:24 +0200
Subject: [Rd] qt() returns Inf with certain negative ncp values
In-Reply-To: <018a37d6d5864b1a88b11b811c876581@chu-rouen.fr>
References: <871qvrmwmp.fsf@gmx.net>
 <018a37d6d5864b1a88b11b811c876581@chu-rouen.fr>
Message-ID: <25256.45208.821335.812617@stat.math.ethz.ch>

>>>>> GILLIBERT, Andre 
>>>>>     on Tue, 14 Jun 2022 13:39:41 +0000 writes:

    > Hello,
    >> I asked about the following observations on r-help and it
    >> was suggested that they may indicate an algorithmic
    >> problem with qt(), so I thought I should report them
    >> here.

Which is fine.
Usually you should *CAREFULLY* read the corresponding reference
documentation before posting.

In this case, we have on R's help page {on non-central pt():}

    This computes the lower tail only, so the upper tail suffers
    from cancellation and a warning will be given when this is
    likely to be significant. 

and (in ?Note:?)

    The code for non-zero ncp is principally intended to be used
    for moderate values of ncp: it will not be highly accurate,
    especially in the tails, for large values. 

and further also that a simple inversion is used for computing
the non-central qt().

    > I explored numerical accuracy issues of pt and qt with
    > non-central parameters.  There seems to be problems when
    > probabilities are small (less than 10^-12 or 10^-14).

Yes, the help (above) says  "especially in the tails",
i.e., this is also well known.

    > A few examples: pnorm(-30)# equal to 4.9e-198, which looks
    > fine pt(-30, df=10000, ncp=0)# equal to 1e-189, which
    > looks fine too pt(-30, df=10000, ncp=0.01) # equal to
    > 1.044e-14, which looks bad. It should be closer to zero
    > than the previous one pt(-300, df=10000, ncp=0.01) # equal
    > to 1.044e-14, while it should be even closer to zero !
    > pt(-3000, df=10000, ncp=0.01) # still equal to 1.044e-14,
    > while it should be even closer to zero !

    > qnorm(1e-13) # equal to -7.349, which looks fine qt(1e-13,
    > df=10000, ncp=0) # equal to -7.359, which looks fine
    > qt(1e-13, df=10000, ncp=0.01) # equal to -7.364, which
    > looks fine qt(1.044e-14, df=10000, ncp=0.01) # equal to
    > -8.28, which looks fine qt(1.043e-14, df=10000, ncp=0.01)
    > # equal to -Inf, which is far too negative...

    > The source code shows that the non-central qt() works by
    > inverting the non-central pt()
    > https://github.com/wch/r-source/blob/trunk/src/nmath/qnt.c

exactly; as the help page also says ..

    > Consequently, both problems are related.

Indeed, and known and documented for a long time..

Still, this lack of a better algorithm had bothered me (as R
Core member) in the past quite a bit, and I had implemented other
approximations for cases where the current algorithm is
deficient... but I had not been entirely satisfied, nor had I
finished exploring or finding solutions in all relevant cases.

In the mean time I had created CRAN package 'DPQ' (Density,
Probability, Quantile computations) which also contains
quite a few functions related to better/alternative computations
of pt(*, ncp=*)  which I call pnt(), not the least because R's
implementation of the algorithm is in   <Rsrc>/src/nmath/pnt.c
and the C function is called pnt().

Till now, I have not found a student or a collaborator to
finally get this project further  {{hint, hint!}}.

In DPQ, (download the *source* package if you are interested),
there's a help page listing the current approaches I have

  https://search.r-project.org/CRAN/refmans/DPQ/html/pnt.html
or
  https://rdrr.io/cran/DPQ/man/pnt.html

Additionally, in the source (man/pnt.Rd) there are comments about a not yet
implemented one, and there are even two R scripts exhibiting
bogous (and already fixed) behavior of the non-central t CDF:

 https://rdrr.io/rforge/DPQ/src/tests/t-nonc-tst.R   and
 https://rdrr.io/rforge/DPQ/src/tests/pnt-prec.R

Indeed, this situation *can* be improved, but it needs dedicated work
of people somewhat knowledgable in applied math etc.

Would you (readers ..) be interested in helping?

Best,
Martin

Martin Maechler
ETH Zurich  and  R Core team


PS: I'm adding code to explore this specific issue (better
    inversion for those cases where pnt() is not the problem)
    to my DPQ package  just these hours, notably a simple function
    qtU() which only uses pt() and uniroot() to compute
    (non-central) t-quantiles.


From @tephen@berm@n @end|ng |rom gmx@net  Wed Jun 15 00:55:49 2022
From: @tephen@berm@n @end|ng |rom gmx@net (Stephen Berman)
Date: Wed, 15 Jun 2022 00:55:49 +0200
Subject: [Rd] qt() returns Inf with certain negative ncp values
In-Reply-To: <25256.45208.821335.812617@stat.math.ethz.ch> (Martin Maechler's
 message of "Tue, 14 Jun 2022 18:00:24 +0200")
References: <871qvrmwmp.fsf@gmx.net>
 <018a37d6d5864b1a88b11b811c876581@chu-rouen.fr>
 <25256.45208.821335.812617@stat.math.ethz.ch>
Message-ID: <87v8t2luru.fsf@gmx.net>

On Tue, 14 Jun 2022 18:00:24 +0200 Martin Maechler <maechler at stat.math.ethz.ch> wrote:

>>>>>> GILLIBERT, Andre
>>>>>>     on Tue, 14 Jun 2022 13:39:41 +0000 writes:
>
>     > Hello,
>     >> I asked about the following observations on r-help and it
>     >> was suggested that they may indicate an algorithmic
>     >> problem with qt(), so I thought I should report them
>     >> here.
>
> Which is fine.
> Usually you should *CAREFULLY* read the corresponding reference
> documentation before posting.

I actually have read the documentation before, though admittedly I
didn't reread it carefully before posting, but I vaguely remembered the
reservations about the tail accuracy of large values.  The main reason I
posted was my surprise at getting seemingly good values, then suddenly
Inf, then again seemingly good values.  I actually ran into this issue
when I was graphing various effect sizes with t-distributions and with a
large effect suddenly got an error and no graph, but then with an even
larger effect got a graph again.

[...]
> Still, this lack of a better algorithm had bothered me (as R
> Core member) in the past quite a bit, and I had implemented other
> approximations for cases where the current algorithm is
> deficient... but I had not been entirely satisfied, nor had I
> finished exploring or finding solutions in all relevant cases.
>
> In the mean time I had created CRAN package 'DPQ' (Density,
> Probability, Quantile computations) which also contains
> quite a few functions related to better/alternative computations
> of pt(*, ncp=*)  which I call pnt(), not the least because R's
> implementation of the algorithm is in   <Rsrc>/src/nmath/pnt.c
> and the C function is called pnt().
>
> Till now, I have not found a student or a collaborator to
> finally get this project further  {{hint, hint!}}.
>
> In DPQ, (download the *source* package if you are interested),
> there's a help page listing the current approaches I have
>
>   https://search.r-project.org/CRAN/refmans/DPQ/html/pnt.html
> or
>   https://rdrr.io/cran/DPQ/man/pnt.html
>
> Additionally, in the source (man/pnt.Rd) there are comments about a not yet
> implemented one, and there are even two R scripts exhibiting
> bogous (and already fixed) behavior of the non-central t CDF:
>
>  https://rdrr.io/rforge/DPQ/src/tests/t-nonc-tst.R   and
>  https://rdrr.io/rforge/DPQ/src/tests/pnt-prec.R
>
> Indeed, this situation *can* be improved, but it needs dedicated work
> of people somewhat knowledgable in applied math etc.
>
> Would you (readers ..) be interested in helping?

I'm afraid I don't have enough knowledge or time to be useful for such a
project.  But what you describe sounds interesting and I'll try to find
time to look at it.

Thanks for your reply, I really appreciate it.

Steve Berman


From m@rtyn@p|ummer @end|ng |rom gm@||@com  Thu Jun 16 20:09:19 2022
From: m@rtyn@p|ummer @end|ng |rom gm@||@com (Martyn Plummer)
Date: Thu, 16 Jun 2022 19:09:19 +0100
Subject: [Rd] Unsigned binary
In-Reply-To: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
References: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
Message-ID: <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>

On Wed, 8 Jun 2022 at 13:52, Scott McAllister <scott at patchmypc.com> wrote:

> Good afternoon
>
> Are you aware that the current release of R for Windows (4.2.0) is
> unsigned? Do you have any plans to rectify this ?
>
>
Yes and yes. Ideally the installer should be signed by The R Foundation. We
are working on this but the process of validating the R Foundation for a
code signing certificate is quite bureaucratic.
In the meantime release 4.2.1 will be signed by me (Co-President of the R
Foundation) using a personal certificate issued by Sectigo.

Martyn


> Thanks,
>
> Scott McAllister - Support Engineer
> Rate Your Experience: Great<https://patchmypc.com/customer-feedback-scott>
> | Good<https://patchmypc.com/customer-feedback-scott> | Poor<
> https://patchmypc.com/customer-feedback-scott>
> Support Session: 30 Minutes<https://patchmypc.com/scott-30-minute-session>
> | 60 Minutes<https://patchmypc.com/scott-60-minute-session>
> Learn More: Live Demo<https://patchmypc.com/schedule-live-demo> | Setup
> Call<https://patchmypc.com/schedule-setup-call> | Review Call<
> https://patchmypc.com/environment-review-call> | Trial<
> https://patchmypc.com/free-trial> | Quote<
> https://patchmypc.com/request-quote>
> Follow Us: Twitter<https://patchmypc.com/twitter> | LinkedIn<
> https://patchmypc.com/linkedin>
> Sales and Support: + 1-866-343-3083
> [Sent from Front]
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From @cott @end|ng |rom p@tchmypc@com  Fri Jun 17 13:41:35 2022
From: @cott @end|ng |rom p@tchmypc@com (Scott McAllister)
Date: Fri, 17 Jun 2022 11:41:35 +0000
Subject: [Rd] Unsigned binary
In-Reply-To: <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>
References: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
 <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>
Message-ID: <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>

Thank you for your update on this

If you can keep me updated on when version 4.2.1 is rereleased with the interim code signing certificate, that would be fantastic

Thanks,

Scott McAllister - Support Engineer
Rate Your Experience: Great<https://patchmypc.com/customer-feedback-scott> | Good<https://patchmypc.com/customer-feedback-scott> | Poor<https://patchmypc.com/customer-feedback-scott>
Support Session: 30 Minutes<https://patchmypc.com/scott-30-minute-session> | 60 Minutes<https://patchmypc.com/scott-60-minute-session>
Learn More: Live Demo<https://patchmypc.com/schedule-live-demo> | Setup Call<https://patchmypc.com/schedule-setup-call> | Review Call<https://patchmypc.com/environment-review-call> | Trial<https://patchmypc.com/free-trial> | Quote<https://patchmypc.com/request-quote>
Follow Us: Twitter<https://patchmypc.com/twitter> | LinkedIn<https://patchmypc.com/linkedin>
Sales and Support: + 1-866-343-3083
[Sent from Front]
On June 16, 2022, 7:09 PM GMT+1 martyn.plummer at gmail.com<mailto:martyn.plummer at gmail.com> wrote:



On Wed, 8 Jun 2022 at 13:52, Scott McAllister <scott at patchmypc.com<mailto:scott at patchmypc.com>> wrote:
Good afternoon

Are you aware that the current release of R for Windows (4.2.0) is unsigned? Do you have any plans to rectify this ?


Yes and yes. Ideally the installer should be signed by The R Foundation. We are working on this but the process of validating the R Foundation for a code signing certificate is quite bureaucratic.
In the meantime release 4.2.1 will be signed by me (Co-President of the R Foundation) using a personal certificate issued by Sectigo.

Martyn

Thanks,

Scott McAllister - Support Engineer
Rate Your Experience: Great<https://patchmypc.com/customer-feedback-scott<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>> | Good<https://patchmypc.com/customer-feedback-scott<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>> | Poor<https://patchmypc.com/customer-feedback-scott<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>>
Support Session: 30 Minutes<https://patchmypc.com/scott-30-minute-session<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fscott-30-minute-session&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=7YhxNKzq80ny5vuWuca%2FoK7UY98aoiiCzcjaHAxKYVE%3D&reserved=0>> | 60 Minutes<https://patchmypc.com/scott-60-minute-session<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fscott-60-minute-session&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=w4t%2Fbr%2Fj%2FngISt1dUP%2FxxFRihPVqEm%2F5G%2F7vCvR2%2B5o%3D&reserved=0>>
Learn More: Live Demo<https://patchmypc.com/schedule-live-demo<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fschedule-live-demo&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=JmTNdLSdz8vDcL5Ktn6SR%2FUOjkw2M2ugbXF2KpoVQNw%3D&reserved=0>> | Setup Call<https://patchmypc.com/schedule-setup-call<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fschedule-setup-call&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=CbfqUHeUyeJYNpyHdvyXKzyhQMfgDYewXVYfVafkyv0%3D&reserved=0>> | Review Call<https://patchmypc.com/environment-review-call<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fenvironment-review-call&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=a6ZU5ecE49Af%2Fouh52VxhKmHQHj8SN1o2U9tQmoU7MY%3D&reserved=0>> | Trial<https://patchmypc.com/free-trial<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Ffree-trial&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dFd9pklda%2FDasL0cSkWQF36PICt7oBIO%2BUP97HOOZKY%3D&reserved=0>> | Quote<https://patchmypc.com/request-quote<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Frequest-quote&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=sD%2BzhTswdB7NP8TWxTkJOTwjGzuD0PMA%2FNrUH6XsL3k%3D&reserved=0>>
Follow Us: Twitter<https://patchmypc.com/twitter<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Ftwitter&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=V4CQFSRfc%2F2yuzwv95hWArdsPywhvy3ZV2UlNOvGcvw%3D&reserved=0>> | LinkedIn<https://patchmypc.com/linkedin<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Flinkedin&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=u%2B2ve%2BXkeqbiezcZKBvtdEICpUI1vPTGKM%2FlNSz9WRk%3D&reserved=0>>
Sales and Support: + 1-866-343-3083
[Sent from Front]

        [[alternative HTML version deleted]]

______________________________________________
R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=LhVRlaLmu1AC9tXvl3PZ60C8BSFniVrSEdsYFg7HgVI%3D&reserved=0>

	[[alternative HTML version deleted]]


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Sat Jun 18 15:07:08 2022
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Sat, 18 Jun 2022 14:07:08 +0100
Subject: [Rd] Unsigned binary
In-Reply-To: <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>
References: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
 <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>
 <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>
Message-ID: <5522f8c4-b95f-dac7-baeb-212f31276989@dewey.myzen.co.uk>

According to this post from Peter Dalgard on R-announce 
https://stat.ethz.ch/pipermail/r-announce/2022/000684.html
4.1.1 will be released (not re-released) on June 23.

Michael

On 17/06/2022 12:41, Scott McAllister wrote:
> Thank you for your update on this
> 
> If you can keep me updated on when version 4.2.1 is rereleased with the interim code signing certificate, that would be fantastic
> 
> Thanks,
> 
> Scott McAllister - Support Engineer
> Rate Your Experience: Great<https://patchmypc.com/customer-feedback-scott> | Good<https://patchmypc.com/customer-feedback-scott> | Poor<https://patchmypc.com/customer-feedback-scott>
> Support Session: 30 Minutes<https://patchmypc.com/scott-30-minute-session> | 60 Minutes<https://patchmypc.com/scott-60-minute-session>
> Learn More: Live Demo<https://patchmypc.com/schedule-live-demo> | Setup Call<https://patchmypc.com/schedule-setup-call> | Review Call<https://patchmypc.com/environment-review-call> | Trial<https://patchmypc.com/free-trial> | Quote<https://patchmypc.com/request-quote>
> Follow Us: Twitter<https://patchmypc.com/twitter> | LinkedIn<https://patchmypc.com/linkedin>
> Sales and Support: + 1-866-343-3083
> [Sent from Front]
> On June 16, 2022, 7:09 PM GMT+1 martyn.plummer at gmail.com<mailto:martyn.plummer at gmail.com> wrote:
> 
> 
> 
> On Wed, 8 Jun 2022 at 13:52, Scott McAllister <scott at patchmypc.com<mailto:scott at patchmypc.com>> wrote:
> Good afternoon
> 
> Are you aware that the current release of R for Windows (4.2.0) is unsigned? Do you have any plans to rectify this ?
> 
> 
> Yes and yes. Ideally the installer should be signed by The R Foundation. We are working on this but the process of validating the R Foundation for a code signing certificate is quite bureaucratic.
> In the meantime release 4.2.1 will be signed by me (Co-President of the R Foundation) using a personal certificate issued by Sectigo.
> 
> Martyn
> 
> Thanks,
> 
> Scott McAllister - Support Engineer
> Rate Your Experience: Great<https://patchmypc.com/customer-feedback-scott<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>> | Good<https://patchmypc.com/customer-feedback-scott<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>> | Poor<https://patchmypc.com/customer
>   -feedback-scott<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>>
> Support Session: 30 Minutes<https://patchmypc.com/scott-30-minute-session<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fscott-30-minute-session&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=7YhxNKzq80ny5vuWuca%2FoK7UY98aoiiCzcjaHAxKYVE%3D&reserved=0>> | 60 Minutes<https://patchmypc.com/scott-60-minute-session<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fscott-60-minute-session&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=w4t%2Fbr%2Fj%2FngISt1dUP%2FxxFRihPVqEm%2F5G%2F7vCvR2%2B5o%3D&reserved=0>>
> Learn More: Live Demo<https://patchmypc.com/schedule-live-demo<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fschedule-live-demo&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=JmTNdLSdz8vDcL5Ktn6SR%2FUOjkw2M2ugbXF2KpoVQNw%3D&reserved=0>> | Setup Call<https://patchmypc.com/schedule-setup-call<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fschedule-setup-call&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=CbfqUHeUyeJYNpyHdvyXKzyhQMfgDYewXVYfVafkyv0%3D&reserved=0>> | Review Call<https://patchmypc.com/environment-review-ca
>   ll<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fenvironment-review-call&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=a6ZU5ecE49Af%2Fouh52VxhKmHQHj8SN1o2U9tQmoU7MY%3D&reserved=0>> | Trial<https://patchmypc.com/free-trial<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Ffree-trial&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dFd9pklda%2FDasL0cSkWQF36PICt7oBIO%2BUP97HOOZKY%3D&reserved=0>> | Quote<https://patchmypc.com/request-quote<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Frequ
>   est-quote&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=sD%2BzhTswdB7NP8TWxTkJOTwjGzuD0PMA%2FNrUH6XsL3k%3D&reserved=0>>
> Follow Us: Twitter<https://patchmypc.com/twitter<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Ftwitter&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=V4CQFSRfc%2F2yuzwv95hWArdsPywhvy3ZV2UlNOvGcvw%3D&reserved=0>> | LinkedIn<https://patchmypc.com/linkedin<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Flinkedin&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=u%2B2ve%2BXkeqbiezcZKBvtdEICpUI1vPTGKM%2FlNSz9WRk%3D&reserved=0>>
> Sales and Support: + 1-866-343-3083
> [Sent from Front]
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel<https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=LhVRlaLmu1AC9tXvl3PZ60C8BSFniVrSEdsYFg7HgVI%3D&reserved=0>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Michael
http://www.dewey.myzen.co.uk/home.html

From henr|k@bengt@@on @end|ng |rom gm@||@com  Sat Jun 18 17:49:01 2022
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Sat, 18 Jun 2022 08:49:01 -0700
Subject: [Rd] Unsigned binary
In-Reply-To: <5522f8c4-b95f-dac7-baeb-212f31276989@dewey.myzen.co.uk>
References: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
 <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>
 <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>
 <5522f8c4-b95f-dac7-baeb-212f31276989@dewey.myzen.co.uk>
Message-ID: <CAFDcVCRqNQ=rGFQQHXYzz1ECfZMLy+N551YzqY-B1FOB363R6A@mail.gmail.com>

For future needs:

Existing and upcoming releases are always announced on the front page
https://www.r-project.org/. Upcoming releases are put there as soon as a
decision is made. For guesstimates, see past release patterns.

/Henrik

On Sat, Jun 18, 2022, 06:07 Michael Dewey <lists at dewey.myzen.co.uk> wrote:

> According to this post from Peter Dalgard on R-announce
> https://stat.ethz.ch/pipermail/r-announce/2022/000684.html
> 4.1.1 will be released (not re-released) on June 23.
>
> Michael
>
> On 17/06/2022 12:41, Scott McAllister wrote:
> > Thank you for your update on this
> >
> > If you can keep me updated on when version 4.2.1 is rereleased with the
> interim code signing certificate, that would be fantastic
> >
> > Thanks,
> >
> > Scott McAllister - Support Engineer
> > Rate Your Experience: Great<
> https://patchmypc.com/customer-feedback-scott> | Good<
> https://patchmypc.com/customer-feedback-scott> | Poor<
> https://patchmypc.com/customer-feedback-scott>
> > Support Session: 30 Minutes<
> https://patchmypc.com/scott-30-minute-session> | 60 Minutes<
> https://patchmypc.com/scott-60-minute-session>
> > Learn More: Live Demo<https://patchmypc.com/schedule-live-demo> | Setup
> Call<https://patchmypc.com/schedule-setup-call> | Review Call<
> https://patchmypc.com/environment-review-call> | Trial<
> https://patchmypc.com/free-trial> | Quote<
> https://patchmypc.com/request-quote>
> > Follow Us: Twitter<https://patchmypc.com/twitter> | LinkedIn<
> https://patchmypc.com/linkedin>
> > Sales and Support: + 1-866-343-3083
> > [Sent from Front]
> > On June 16, 2022, 7:09 PM GMT+1 martyn.plummer at gmail.com<mailto:
> martyn.plummer at gmail.com> wrote:
> >
> >
> >
> > On Wed, 8 Jun 2022 at 13:52, Scott McAllister <scott at patchmypc.com
> <mailto:scott at patchmypc.com>> wrote:
> > Good afternoon
> >
> > Are you aware that the current release of R for Windows (4.2.0) is
> unsigned? Do you have any plans to rectify this ?
> >
> >
> > Yes and yes. Ideally the installer should be signed by The R Foundation.
> We are working on this but the process of validating the R Foundation for a
> code signing certificate is quite bureaucratic.
> > In the meantime release 4.2.1 will be signed by me (Co-President of the
> R Foundation) using a personal certificate issued by Sectigo.
> >
> > Martyn
> >
> > Thanks,
> >
> > Scott McAllister - Support Engineer
> > Rate Your Experience: Great<
> https://patchmypc.com/customer-feedback-scott<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>>
> | Good<https://patchmypc.com/customer-feedback-scott<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0>>
> | Poor<https://patchmypc.com/custom
>  er
> >   -feedback-scott<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fcustomer-feedback-scott&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=n6Hj7adkzgTFt1Esxno1l9A%2F6t4SUo9N7NqEMDWJhg4%3D&reserved=0
> >>
> > Support Session: 30 Minutes<
> https://patchmypc.com/scott-30-minute-session<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fscott-30-minute-session&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=7YhxNKzq80ny5vuWuca%2FoK7UY98aoiiCzcjaHAxKYVE%3D&reserved=0>>
> | 60 Minutes<https://patchmypc.com/scott-60-minute-session<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fscott-60-minute-session&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=w4t%2Fbr%2Fj%2FngISt1dUP%2FxxFRihPVqEm%2F5G%2F7vCvR2%2B5o%3D&reserved=0
> >>
> > Learn More: Live Demo<https://patchmypc.com/schedule-live-demo<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fschedule-live-demo&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=JmTNdLSdz8vDcL5Ktn6SR%2FUOjkw2M2ugbXF2KpoVQNw%3D&reserved=0>>
> | Setup Call<https://patchmypc.com/schedule-setup-call<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fschedule-setup-call&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=CbfqUHeUyeJYNpyHdvyXKzyhQMfgDYewXVYfVafkyv0%3D&reserved=0>>
> | Review Call<https://patchmypc.com/environment-review-
>  ca
> >   ll<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fenvironment-review-call&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=a6ZU5ecE49Af%2Fouh52VxhKmHQHj8SN1o2U9tQmoU7MY%3D&reserved=0>>
> | Trial<https://patchmypc.com/free-trial<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Ffree-trial&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=dFd9pklda%2FDasL0cSkWQF36PICt7oBIO%2BUP97HOOZKY%3D&reserved=0>>
> | Quote<https://patchmypc.com/request-quote<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Fr
>  equ
> >   est-quote&data=05%7C01%7Cscott%40patchmypc.com
> %7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=sD%2BzhTswdB7NP8TWxTkJOTwjGzuD0PMA%2FNrUH6XsL3k%3D&reserved=0>>
> > Follow Us: Twitter<https://patchmypc.com/twitter<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Ftwitter&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=V4CQFSRfc%2F2yuzwv95hWArdsPywhvy3ZV2UlNOvGcvw%3D&reserved=0>>
> | LinkedIn<https://patchmypc.com/linkedin<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fpatchmypc.com%2Flinkedin&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=u%2B2ve%2BXkeqbiezcZKBvtdEICpUI1vPTGKM%2FlNSz9WRk%3D&reserved=0
> >>
> > Sales and Support: + 1-866-343-3083
> > [Sent from Front]
> >
> >          [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel<
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=05%7C01%7Cscott%40patchmypc.com%7C605c017192cb43f3df1208da4fc35c53%7Cb79783df131e4d0083036f66c0fa4bfb%7C0%7C0%7C637909997738076394%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=LhVRlaLmu1AC9tXvl3PZ60C8BSFniVrSEdsYFg7HgVI%3D&reserved=0
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>
> --
> Michael
> http://www.dewey.myzen.co.uk/home.html
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From berw|n@tur|@ch @end|ng |rom gm@||@com  Sat Jun 18 16:58:19 2022
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Sat, 18 Jun 2022 22:58:19 +0800
Subject: [Rd] Trying to compile R 4.2.x on Linux as 32bit sub-architecture
Message-ID: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>

G'day all,

Apologies for not reporting this earlier, but our teaching semester has
just finished and I learned from experience not to update my R version
to a version that my students were not using. :)

When installing R on my Linux machines, I usually install it as a 32bit
and a 64bit sub-architecture, with the 64bit one being the default.  My
main computer also runs daily scripts during the night to install
R-patched and R-devel in this manner.

However, I now realise that I can neither install R 4.2.0 nor R-patched
as a 32bit sub-architecture on my Linux machines (which were running
Xubuntu 20.04 but were recently upgraded to Xubuntu 22.04).  The
installation process always fails at the same test.  I attach the
relevant file from trying to compile R-patched during last night's run.
 
Hopefully this report is in time before the release of R 4.2.1. :)

Or is it time to stop compiling R on Linux as a 32bit sub-architecture?
My understanding is that R 4.2.0 on Windows is already provided only as
a 64bit binary, not sure what the situation on MacOS is.  How long will
support for a 32bit version of R on Linux continue?

Thank you very much for any help/insight.

Cheers,

	Berwin

From berw|n@tur|@ch @end|ng |rom gm@||@com  Sat Jun 18 20:16:34 2022
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Sun, 19 Jun 2022 02:16:34 +0800
Subject: [Rd] 
 Trying to compile R 4.2.x on Linux as 32bit sub-architecture
In-Reply-To: <25261.65414.379675.51967@rob.eddelbuettel.com>
References: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>
 <25261.65414.379675.51967@rob.eddelbuettel.com>
Message-ID: <20220619021634.7f33fd6e@ECM-DTC-716.uniwa.uwa.edu.au>

G'day Dirk,

On Sat, 18 Jun 2022 11:38:30 -0500
Dirk Eddelbuettel <edd at debian.org> wrote:

> See
>     https://buildd.debian.org/status/package.php?p=r-base
> and note the i386 entry.

Thank you for that.  I presume that refers to a 32bit version of debian
with 32 bit compiler suit?

I should probably have been more specific.  My Ubuntu machines are
64bit architectures and I install R as 32bit sub-architecture and 64
sub-architecture with the same compiler suite.  Well for the 32bit
compilation I specify the additional flag "-m32" to the (gcc) compilers.

Cheers,

	Berwin


From berw|n@tur|@ch @end|ng |rom gm@||@com  Sat Jun 18 20:30:03 2022
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Sun, 19 Jun 2022 02:30:03 +0800
Subject: [Rd] 
 Trying to compile R 4.2.x on Linux as 32bit sub-architecture
In-Reply-To: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>
References: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>
Message-ID: <20220619023003.687c603e@ECM-DTC-716.uniwa.uwa.edu.au>

G'day all,

On Sat, 18 Jun 2022 22:58:19 +0800
Berwin A Turlach <Berwin.Turlach at gmail.com> wrote:

> [...] I attach the relevant file from trying to compile R-patched
> during last night's run. 

Mmh, on the web-interface to the mailing list I see that the attachment
might have been deleted.  Perhaps because it was too large?

So below the start and the final part from reg-tests-1d.Rout.fail which
shows where the error occurs.

Cheers,
	
	Berwin

----------------------------
R version 4.2.1 RC (2022-06-17 r82501) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu/32 (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## Regression tests for R >= 3.4.0
[...very large snip...]
> ## pretty(x) when range(x) is finite but diff(range(x)) is +/- Inf:
> B <- 1e308; 2*B; (s <- seq(-B,B,length.out = 3))
[1] Inf
[1] -1e+308   0e+00  1e+308
> options(warn=1) # => warnings *as they happen*
> (ps <- pretty(c(-B,B)))
[1] -1e+308 -5e+307   0e+00  5e+307  1e+308
> ## Warning in pretty.default(c(-B, B)) :
> ##   Internal(pretty()): very large range 4e+307, corrected to 2.24712e+307
> nps <- length(ps)
> dd <- sum((dps <- diff(ps))/length(dps)) # mean w/o overflow
> epsC <- .Machine$double.eps
> relD <- (dps/dd - 1)/epsC
> relEr <- function(f, y) abs((f-y)/(f+y)*2) # cheap relative error, |f| > 0 !
> stopifnot(is.finite(mean(ps)), ## these all failed without "long-double"
+           is.finite(mdp <- mean(dps)),
+           all.equal(dd, mdp, tolerance=1e-15))
> stopifnot(relEr(c(-B,B), ps[c(1L,nps)]) <= 4*epsC,
+           -8 <= relD, relD <= 8) # seen [-1.5,.., 3.0]; w/o long-double: [-5, .., 4]
> ## ps was   0 Inf Inf Inf Inf Inf Inf Inf Inf Inf  0 , in R <= 4.1.0
> f. <- c(-1.797, -1.79, -1.75, seq(-1.7, -1, by=.1))
> stopifnot(!is.unsorted(f.)) ; f.nm <- setNames(, f.)
> fmtRng <- function(x) paste(format(range(x)), collapse=", ")
> ns <- c(2:12, 15, 20, 30, 51, 100, 2001, 1e5)
> nms.n <- formatC(ns, digits=0, format="f")
> nmsRng <- c(t(outer(paste0("r",1:2), c("lo","hi"), paste, sep=".")))
> rr <- matrix(NA, length(ns), 4, dimnames=list(nms.n, nmsRng))
> for(i.n in seq_along(ns)) {
+     n <- ns[i.n]
+     cat("n = ", n,":\n--------\n")
+     pBL <- lapply(f., function(f) structure(pretty(c(f*1e308, 2^1023.9), n), f=f))
+     ## -> a warning per f
+     n.s <- lengths(pBL) # how close to target 'n' ??
+     cat("lengths(.) in [", fmtRng(n.s), "]\n")
+     if(n <= 15) stopifnot(n.s <= 20)# seen {14,..,17}
+     else stopifnot(abs(n.s/n - 1) <= 1/2)
+     if(n) cat("length(.) <> n relative err in [", fmtRng(n.s/n - 1), "]\n")
+     ## .pretty(*, bounds=FALSE) :
+     prM <- t(sapply(f.nm, function(f)
+         unlist( .pretty(c(f*1e308, 2^1023.9), n, bounds=FALSE) )))
+     print(prM)
+     luM <- prM[,c("ns","nu")] * prM[,"unit"] # the pretty-scaled unit
+     r1 <- luM[,"ns"] / (f.nm*1e308)
+     rr[i.n, 1:2] <- r1 <- range(r1)
+     cat(sprintf("range(r1): [%g, %g]\n", r1[1], r1[2]))
+     r2 <- luM[,"nu"] / 2^1023.9
+     rr[i.n, 3:4] <- r2 <- range(r2)
+     cat(sprintf("range(r2): [%g, %g]\n", r2[1], r2[2]))
+     stopifnot(exprs = { is.matrix(prM)
+             prM[,"nu"] - prM[,"ns"] == prM[,"n"] # could differ, but not for this data
+             identical(colnames(prM), c("ns", "nu", "n", "unit"))
+             ## These bounds depend on 'n' :
+             r1 >= if(n <= 12) 0.55 else 0.89
+             r1 <= if(n <= 15) 1.4  else 1.1
+             r2 >= if(n <= 12) 0.58 else 0.95
+             r2 <= if(n <= 15) 1    else 1.025
+     })
+     invisible(lapply(pBL, function(ps) {
+         mdB <- sum((dB <- diff(ps))/length(dB))
+         rd <- dB/mdB - 1 # relative differences
+         ## print(range(rd))
+         x <- c(attr(ps,"f")*1e308, 2^1023.9)
+         stopifnot(if(n >= 1) abs(rd) <= n * 3e-15 else TRUE,
+                   ps[1] <= x[1] , x[2] <= ps[length(ps)])
+     }))
+ }
n =  2 :
--------
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.73715e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.73365e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.71365e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.68865e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.63865e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.58865e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.53865e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.48865e+308, corrected to 1.43815e+308
Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
  R_pretty(): very large range 'cell'=1.43865e+308, corrected to 1.43815e+308
lengths(.) in [ 1, 3 ]
length(.) <> n relative err in [ -0.5,  0.5 ]
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.73715e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.73365e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.71365e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.68865e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.63865e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.58865e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.53865e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.48865e+308, corrected to 1.43815e+308
Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
  R_pretty(): very large range 'cell'=1.43865e+308, corrected to 1.43815e+308
       ns nu n   unit
-1.797  0  0 0    Inf
-1.79   0  0 0    Inf
-1.75   0  0 0    Inf
-1.7    0  0 0    Inf
-1.6    0  0 0    Inf
-1.5    0  0 0    Inf
-1.4    0  0 0    Inf
-1.3    0  0 0    Inf
-1.2    0  0 0    Inf
-1.1   -1  1 2 1e+308
-1     -1  1 2 1e+308
range(r1): [NaN, NaN]
range(r2): [NaN, NaN]
Error: r1 >= if (n <= 12) 0.55 else 0.89 are not all TRUE
Execution halted


From jeroenoom@ @end|ng |rom gm@||@com  Sun Jun 19 12:45:36 2022
From: jeroenoom@ @end|ng |rom gm@||@com (Jeroen Ooms)
Date: Sun, 19 Jun 2022 12:45:36 +0200
Subject: [Rd] Unsigned binary
In-Reply-To: <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>
References: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
 <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>
 <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>
Message-ID: <CABFfbXtHGftT9s6gePMZShvzrC3SuamJGmehEuEieCLRwJOiCA@mail.gmail.com>

On Fri, Jun 17, 2022 at 2:46 PM Scott McAllister <scott at patchmypc.com>
wrote:

> Thank you for your update on this
>
> If you can keep me updated on when version 4.2.1 is rereleased with the
> interim code signing certificate, that would be fantastic


Signed (unofficial) builds are also available from
https://github.com/r-windows/r-base/releases

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Jun 20 15:35:34 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Jun 2022 15:35:34 +0200
Subject: [Rd] 
 Trying to compile R 4.2.x on Linux as 32bit sub-architecture
In-Reply-To: <20220619023003.687c603e@ECM-DTC-716.uniwa.uwa.edu.au>
References: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>
 <20220619023003.687c603e@ECM-DTC-716.uniwa.uwa.edu.au>
Message-ID: <25264.30630.11417.849490@stat.math.ethz.ch>

>>>>> Berwin A Turlach 
>>>>>     on Sun, 19 Jun 2022 02:30:03 +0800 writes:

    > G'day all, On Sat, 18 Jun 2022 22:58:19 +0800 Berwin A
    > Turlach <Berwin.Turlach at gmail.com> wrote:

    >> [...] I attach the relevant file from trying to compile
    >> R-patched during last night's run.

    > Mmh, on the web-interface to the mailing list I see that
    > the attachment might have been deleted.  Perhaps because
    > it was too large?

    > So below the start and the final part from
    > reg-tests-1d.Rout.fail which shows where the error occurs.

    > Cheers,
    > Berwin


Aaah... now we are talking ;-)

Thank you, Berwin!

Your subject was misleading to me.  This does not seem to be
about *compiling* R 4.2.x  but rather *checking* / *testing* its
functionality *after compilation and installation.

I think you are right, and we should adapt our regression tests
to still not fail here.
Also, as I was the one who added these checks, I'd like to get
this "right".

Last but not least:  We are *grateful* indeed for people like
you, testing a *pre-release* version such as   '4.2.1 RC' as we
can see below.

Note that I do test with  '../R/configure --disable-long-double'
but this cannot be the only reason.
BTW, all the pretty *warnings* below are fine and expected; the
problem is that resulting numbers end up "wrong"

I will need some more information:
Ideally, the R console output of these 5 lines of R code:

sessionInfo()
Sys.info()
capabilities()
str(.Machine)
str(.Platform)

Could you help here, doing this *off*-list?

Thanking you in advance and giving best regards,
Martin


    > ----------------------------
    > R version 4.2.1 RC (2022-06-17 r82501) -- "Funny-Looking Kid"
    > Copyright (C) 2022 The R Foundation for Statistical Computing
    > Platform: x86_64-pc-linux-gnu/32 (32-bit)

    > R is free software and comes with ABSOLUTELY NO WARRANTY.
    > You are welcome to redistribute it under certain conditions.
    > Type 'license()' or 'licence()' for distribution details.

    > R is a collaborative project with many contributors.
    > Type 'contributors()' for more information and
    > 'citation()' on how to cite R or R packages in publications.

    > Type 'demo()' for some demos, 'help()' for on-line help, or
    > 'help.start()' for an HTML browser interface to help.
    > Type 'q()' to quit R.

    >> ## Regression tests for R >= 3.4.0

 > [...very large snip...]

    >> ## pretty(x) when range(x) is finite but diff(range(x)) is +/- Inf:
    >> B <- 1e308; 2*B; (s <- seq(-B,B,length.out = 3))
    > [1] Inf
    > [1] -1e+308   0e+00  1e+308
    >> options(warn=1) # => warnings *as they happen*
    >> (ps <- pretty(c(-B,B)))
    > [1] -1e+308 -5e+307   0e+00  5e+307  1e+308
    >> ## Warning in pretty.default(c(-B, B)) :
    >> ##   Internal(pretty()): very large range 4e+307, corrected to 2.24712e+307
    >> nps <- length(ps)
    >> dd <- sum((dps <- diff(ps))/length(dps)) # mean w/o overflow
    >> epsC <- .Machine$double.eps
    >> relD <- (dps/dd - 1)/epsC
    >> relEr <- function(f, y) abs((f-y)/(f+y)*2) # cheap relative error, |f| > 0 !
    >> stopifnot(is.finite(mean(ps)), ## these all failed without "long-double"
    > +           is.finite(mdp <- mean(dps)),
    > +           all.equal(dd, mdp, tolerance=1e-15))
    >> stopifnot(relEr(c(-B,B), ps[c(1L,nps)]) <= 4*epsC,
    > +           -8 <= relD, relD <= 8) # seen [-1.5,.., 3.0]; w/o long-double: [-5, .., 4]
    >> ## ps was   0 Inf Inf Inf Inf Inf Inf Inf Inf Inf  0 , in R <= 4.1.0
    >> f. <- c(-1.797, -1.79, -1.75, seq(-1.7, -1, by=.1))
    >> stopifnot(!is.unsorted(f.)) ; f.nm <- setNames(, f.)
    >> fmtRng <- function(x) paste(format(range(x)), collapse=", ")
    >> ns <- c(2:12, 15, 20, 30, 51, 100, 2001, 1e5)
    >> nms.n <- formatC(ns, digits=0, format="f")
    >> nmsRng <- c(t(outer(paste0("r",1:2), c("lo","hi"), paste, sep=".")))
    >> rr <- matrix(NA, length(ns), 4, dimnames=list(nms.n, nmsRng))
    >> for(i.n in seq_along(ns)) {
    > +     n <- ns[i.n]
    > +     cat("n = ", n,":\n--------\n")
    > +     pBL <- lapply(f., function(f) structure(pretty(c(f*1e308, 2^1023.9), n), f=f))
    > +     ## -> a warning per f
    > +     n.s <- lengths(pBL) # how close to target 'n' ??
    > +     cat("lengths(.) in [", fmtRng(n.s), "]\n")
    > +     if(n <= 15) stopifnot(n.s <= 20)# seen {14,..,17}
    > +     else stopifnot(abs(n.s/n - 1) <= 1/2)
    > +     if(n) cat("length(.) <> n relative err in [", fmtRng(n.s/n - 1), "]\n")
    > +     ## .pretty(*, bounds=FALSE) :
    > +     prM <- t(sapply(f.nm, function(f)
    > +         unlist( .pretty(c(f*1e308, 2^1023.9), n, bounds=FALSE) )))
    > +     print(prM)
    > +     luM <- prM[,c("ns","nu")] * prM[,"unit"] # the pretty-scaled unit
    > +     r1 <- luM[,"ns"] / (f.nm*1e308)
    > +     rr[i.n, 1:2] <- r1 <- range(r1)
    > +     cat(sprintf("range(r1): [%g, %g]\n", r1[1], r1[2]))
    > +     r2 <- luM[,"nu"] / 2^1023.9
    > +     rr[i.n, 3:4] <- r2 <- range(r2)
    > +     cat(sprintf("range(r2): [%g, %g]\n", r2[1], r2[2]))
    > +     stopifnot(exprs = { is.matrix(prM)
    > +             prM[,"nu"] - prM[,"ns"] == prM[,"n"] # could differ, but not for this data
    > +             identical(colnames(prM), c("ns", "nu", "n", "unit"))
    > +             ## These bounds depend on 'n' :
    > +             r1 >= if(n <= 12) 0.55 else 0.89
    > +             r1 <= if(n <= 15) 1.4  else 1.1
    > +             r2 >= if(n <= 12) 0.58 else 0.95
    > +             r2 <= if(n <= 15) 1    else 1.025
    > +     })
    > +     invisible(lapply(pBL, function(ps) {
    > +         mdB <- sum((dB <- diff(ps))/length(dB))
    > +         rd <- dB/mdB - 1 # relative differences
    > +         ## print(range(rd))
    > +         x <- c(attr(ps,"f")*1e308, 2^1023.9)
    > +         stopifnot(if(n >= 1) abs(rd) <= n * 3e-15 else TRUE,
    > +                   ps[1] <= x[1] , x[2] <= ps[length(ps)])
    > +     }))
    > + }
    > n =  2 :
    > --------
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.73715e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.73365e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.71365e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.68865e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.63865e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.58865e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.53865e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.48865e+308, corrected to 1.43815e+308
    > Warning in pretty.default(c(f * 1e+308, 2^1023.9), n) :
    > R_pretty(): very large range 'cell'=1.43865e+308, corrected to 1.43815e+308
    > lengths(.) in [ 1, 3 ]
    > length(.) <> n relative err in [ -0.5,  0.5 ]
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.73715e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.73365e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.71365e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.68865e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.63865e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.58865e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.53865e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.48865e+308, corrected to 1.43815e+308
    > Warning in .pretty(c(f * 1e+308, 2^1023.9), n, bounds = FALSE) :
    > R_pretty(): very large range 'cell'=1.43865e+308, corrected to 1.43815e+308
    > ns nu n   unit
    > -1.797  0  0 0    Inf
    > -1.79   0  0 0    Inf
    > -1.75   0  0 0    Inf
    > -1.7    0  0 0    Inf
    > -1.6    0  0 0    Inf
    > -1.5    0  0 0    Inf
    > -1.4    0  0 0    Inf
    > -1.3    0  0 0    Inf
    > -1.2    0  0 0    Inf
    > -1.1   -1  1 2 1e+308
    > -1     -1  1 2 1e+308
    > range(r1): [NaN, NaN]
    > range(r2): [NaN, NaN]
    > Error: r1 >= if (n <= 12) 0.55 else 0.89 are not all TRUE
    > Execution halted

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From berw|n@tur|@ch @end|ng |rom gm@||@com  Mon Jun 20 15:40:17 2022
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Mon, 20 Jun 2022 21:40:17 +0800
Subject: [Rd] 
 Trying to compile R 4.2.x on Linux as 32bit sub-architecture
In-Reply-To: <f5803feb-ce34-d9e2-0180-4bab4f964874@gmail.com>
References: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>
 <1bd9158c-cffd-e61a-3337-5fee2fd2ce5c@gmail.com>
 <20220620203551.0ca8eabe@ECM-DTC-716.uniwa.uwa.edu.au>
 <f5803feb-ce34-d9e2-0180-4bab4f964874@gmail.com>
Message-ID: <20220620214017.5046dd43@absentia>

G'day Tomas,

On Mon, 20 Jun 2022 14:46:04 +0200
Tomas Kalibera <tomas.kalibera at gmail.com> wrote:

> > Well, what puzzles me is that I had no problem with R-patched right
> > until the end of the 4.1 branch.  And I have no problems with
> > R-devel, that is also still installing a 32bit and a 64bit version
> > just fine.
> >
> > It is just R 4.2 that gives me the problem.  
> Ah, that's interesting. And could you perhaps bisect it to the 
> problematic commit? That might increase the chances you get attention
> of the person who authored it. After all you could also send a patch

Well, I found via Google a command that could tell me the first revision
of a branch.  Apparently revision 81976 is the first revision of the 4.2
branch:

------------------------------------------------------------------------
r81976 | pd | 2022-03-25 07:02:01 +0800 (Fri, 25 Mar 2022) | 1 line

Create R-4-2-branch
------------------------------------------------------------------------

I checked this branch out and it already displays the same problem,
the same test in reg-tests-1d.R falls over.  But I am pretty sure that
R-devel (and R-patched) compiled fine on that day. So where was the
change made before the R-4.2-branch was created?

Cheers,

	Berwin


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Jun 20 15:45:40 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Jun 2022 15:45:40 +0200
Subject: [Rd] Unsigned binary
In-Reply-To: <CABFfbXtHGftT9s6gePMZShvzrC3SuamJGmehEuEieCLRwJOiCA@mail.gmail.com>
References: <MW4PR12MB5665254214EE4D218F76D6A0A3A49@MW4PR12MB5665.namprd12.prod.outlook.com>
 <CA+aisX0PDnmsL0BgVTLzOtD07UNWYZDdo+_MEcjhZih4XDnVKQ@mail.gmail.com>
 <MW4PR12MB5665E473B8068A346A668172A3AF9@MW4PR12MB5665.namprd12.prod.outlook.com>
 <CABFfbXtHGftT9s6gePMZShvzrC3SuamJGmehEuEieCLRwJOiCA@mail.gmail.com>
Message-ID: <25264.31236.650358.678527@stat.math.ethz.ch>

>>>>> Jeroen Ooms 
>>>>>     on Sun, 19 Jun 2022 12:45:36 +0200 writes:

    > On Fri, Jun 17, 2022 at 2:46 PM Scott McAllister <scott at patchmypc.com>
    > wrote:

    >> Thank you for your update on this
    >> 
    >> If you can keep me updated on when version 4.2.1 is rereleased with the
    >> interim code signing certificate, that would be fantastic

    > Signed (unofficial) builds are also available from
    > https://github.com/r-windows/r-base/releases

Hmm, sorry to be blunt,  but I think these should really *NOT*
be used anymore (for R versions >= 4.2.0)
as they are not based on the official R sources for Windows, 
AFAIK, and *also* this unofficial version is still building
packages the old way instead of the new one which is documented in e.g.

     https://blog.r-project.org/

viz.

     https://blog.r-project.org/2021/12/07/upcoming-changes-in-r-4.2-on-windows/
and  https://blog.r-project.org/2022/06/16/upcoming-changes-in-r-4.2.1-on-windows/

Martin Maechler
(R core team; co-author of the first blog above)


From ht @end|ng |rom he@therturner@net  Mon Jun 20 16:21:10 2022
From: ht @end|ng |rom he@therturner@net (Heather Turner)
Date: Mon, 20 Jun 2022 15:21:10 +0100
Subject: [Rd] Bug BBQ
Message-ID: <c5c3f424-c53a-4cdc-be55-68aca8920b7c@www.fastmail.com>

Dear All,

The R Contribution Working Group is organizing a Bug BBQ as a satellite event to useR!
https://contributor.r-project.org/events/bug-bbq

The event is spread over Friday June 24 UTC, after useR! ends (there is no need to have registered for useR!). You are encouraged to put aside some time during the Bug BBQ to review the open bugs and see if you can contribute.

There will be three organized sessions for people to discuss, work together and share their expertise - you are welcome to join in one or more of these sessions (see the link above for times + Zoom registration links, Session 1 starts on Thursday June 23 in UTC negative time zones). 

We will be treating R's Bugzilla as read-only during the event: if you wish to contribute as part of the Bug BBQ, please follow the guidance on the event page.

Hope to see many of you there!

Best wishes,

Heather


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Jun 20 17:06:02 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 20 Jun 2022 18:06:02 +0300
Subject: [Rd] HTML documentation check: 'condition must be plain text'
Message-ID: <20220620180602.36c20989@arachnoid>

Hi,

Use of \Sexpr in an \if condition in R documentation results in a NOTE,
but only during HTML documentation check, not any of the previous Rd
checks:

  \if{\Sexpr{'TRUE'}}{The condition evaluates to true.}

* checking HTML version of manual ... NOTE
Encountered the following conversion/validation errors:
foo.Rd:10: condition must be plain text

Is this supported? "Writing R documentation" ?2.11 seems to agree:

>> Also accepted [as a condition] are TRUE (matching all formats) and
>> FALSE (matching no formats). These could be the output of the \Sexpr
>> macro.

In order to check the HTML documentation, check_Rd2HTML() runs
tools::Rd2HTML() on the results of tools::Rd_db() [1]. The former runs
\Sexpr[stage=render] macros and the latter runs \Sexpr[stage=build]
macros, leaving \Sexpr[stage=install] macros unevaluated. The NOTE goes
away if I switch the "stage" argument to anything but "install".

Is there any downside to adding stages = c('build', 'install') to the
Rd_db call or stages = c('install', 'render') to the Rd2HTML call in
order to make this NOTE go away?

-- 
Best regards,
Ivan

[1]
https://github.com/r-devel/r-svn/blob/d25e77715164e39c96baae4c180d8f980ec93932/src/library/tools/R/check.R#L4911-L4939


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Jun 20 17:48:21 2022
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 20 Jun 2022 17:48:21 +0200
Subject: [Rd] 
 Trying to compile R 4.2.x on Linux as 32bit sub-architecture
In-Reply-To: <20220620214017.5046dd43@absentia>
References: <20220618225819.6778cf9c@ECM-DTC-716.uniwa.uwa.edu.au>
 <1bd9158c-cffd-e61a-3337-5fee2fd2ce5c@gmail.com>
 <20220620203551.0ca8eabe@ECM-DTC-716.uniwa.uwa.edu.au>
 <f5803feb-ce34-d9e2-0180-4bab4f964874@gmail.com>
 <20220620214017.5046dd43@absentia>
Message-ID: <81e05bd3-649c-0066-cac7-d1b45d323ec0@gmail.com>


On 6/20/22 15:40, Berwin A Turlach wrote:
> G'day Tomas,
>
> On Mon, 20 Jun 2022 14:46:04 +0200
> Tomas Kalibera <tomas.kalibera at gmail.com> wrote:
>
>>> Well, what puzzles me is that I had no problem with R-patched right
>>> until the end of the 4.1 branch.  And I have no problems with
>>> R-devel, that is also still installing a 32bit and a 64bit version
>>> just fine.
>>>
>>> It is just R 4.2 that gives me the problem.
>> Ah, that's interesting. And could you perhaps bisect it to the
>> problematic commit? That might increase the chances you get attention
>> of the person who authored it. After all you could also send a patch
> Well, I found via Google a command that could tell me the first revision
> of a branch.  Apparently revision 81976 is the first revision of the 4.2
> branch:
>
> ------------------------------------------------------------------------
> r81976 | pd | 2022-03-25 07:02:01 +0800 (Fri, 25 Mar 2022) | 1 line
>
> Create R-4-2-branch
> ------------------------------------------------------------------------
>
> I checked this branch out and it already displays the same problem,
> the same test in reg-tests-1d.R falls over.  But I am pretty sure that
> R-devel (and R-patched) compiled fine on that day. So where was the
> change made before the R-4.2-branch was created?

the R-4-2-branch was created from R-devel branch by that commit you 
found, so the previous changes were on R-devel. So you could now 
actually search for a commit on R-devel (after r81978) that fixed it, 
perhaps it is something that could be ported to R-4-2-branch.

You could restrict the search for changes in the corresponding test 
files, first, checking if the tests/the tolerances have changed (that 
would be easy, "svn blame" would help: "svn blame", "svn blame -r xxxx", 
"svn log --diff", etc). If it is not a change in the tests but rather in 
the computations, that would be harder to guess, still bisecting should 
find it.

Best
Tomas

>
> Cheers,
>
> 	Berwin


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jun 22 17:25:02 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 22 Jun 2022 18:25:02 +0300
Subject: [Rd] stats::getInitial: requires the model to live in the stats
 namespace or above
Message-ID: <20220622182502.191d3a93@arachnoid>

Hello R-devel,

Here's a corner case I've stumbled upon recently:

local({
	# Originally this was a package namespace, but a local
	# environment also leads to failure
	stopifnot(!identical(environment(), globalenv()))

	# Make a self-starting model inside this private environment...
	SSlinear <- selfStart(
		~ a * x + b,
		function(mCall, data, LHS, ...) {
			xy <- sortedXyData(mCall[['x']], LHS, data)
			setNames(
				coef(lm(y ~ x, xy)),
				mCall[c('b', 'a')]
			)
		},
		c('a', 'b')
	)

	# ...and try to use it
	x <- 1:100
	y <- 100 + 5 * x + rnorm(length(x), sd = 10)
	nls(y ~ SSlinear(x, a, b))
	# error in get('SSlinear'): object not found
})

As a workaround, I'll just provide the starting values manually,
but should this work?

As implemented [1], getInitial requires the model object to live in the
stats package namespace or any of its parents, which eventually include
the global environment and the attached packages, but not the private
namespaces of the packages or any other local environments. This
results from the fact that getInitial() uses plain get() in order to
resolve the symbol for the self-starting model, and get() defaults to
the current environment, which leads a chain of stats -> imports:stats
-> base -> global environment -> attached packages.

It seems easy to suggest get(., envir = environment(object)) as a fix,
which would be able to access anything available at the time of
creation of the formula. On the other hand, it would break the case
when the stats package is not attached to the global environment or the
formula environment, which currently works.

-- 
Best regards,
Ivan

[1]
https://github.com/r-devel/r-svn/blob/d43497cbc927e632c6f597fa23001c3f31d4cae6/src/library/stats/R/selfStart.R#L81-L87


From w||||@mwdun|@p @end|ng |rom gm@||@com  Wed Jun 22 18:44:25 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Wed, 22 Jun 2022 09:44:25 -0700
Subject: [Rd] stats::getInitial: requires the model to live in the stats
 namespace or above
In-Reply-To: <20220622182502.191d3a93@arachnoid>
References: <20220622182502.191d3a93@arachnoid>
Message-ID: <CAHqSRuS51ruHwGy7gysr-pOA2fOEi4A2CYRuQahMrBkzdx6a5g@mail.gmail.com>

Shouldn't the get()'s in stats:::getInitial.formula be looking in the
environment of the formula, not the environment of getInitial.formula?

--- selfStart.R (revision 82512)
+++ selfStart.R (working copy)
@@ -78,13 +79,19 @@
     switch (length(object),
             stop("argument 'object' has an impossible length"),
         {                              # one-sided formula
-           func <- get(as.character(object[[2L]][[1L]]))
+            if (!is.call(object[[2L]])) {
+                stop("Right-hand side of formula is not a call")
+            }
+           func <- get(as.character(object[[2L]][[1L]]), mode="function",
envir=environment(object))
            getInitial(func, data,
                       mCall = as.list(match.call(func, call =
object[[2L]])),
                        ...)
         },
         {                              # two-sided formula
-           func <- get(as.character(object[[3L]][[1L]]))
+            if (!is.call(object[[3L]])) {
+                stop("Right-hand side of formula is not a call")
+            }
+           func <- get(as.character(object[[3L]][[1L]]), mode="function",
envir=environment(object))
            getInitial(func, data,
                       mCall = as.list(match.call(func, call =
object[[3L]])),
                       LHS = object[[2L]], ...)

-Bill


On Wed, Jun 22, 2022 at 8:25 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> Hello R-devel,
>
> Here's a corner case I've stumbled upon recently:
>
> local({
>         # Originally this was a package namespace, but a local
>         # environment also leads to failure
>         stopifnot(!identical(environment(), globalenv()))
>
>         # Make a self-starting model inside this private environment...
>         SSlinear <- selfStart(
>                 ~ a * x + b,
>                 function(mCall, data, LHS, ...) {
>                         xy <- sortedXyData(mCall[['x']], LHS, data)
>                         setNames(
>                                 coef(lm(y ~ x, xy)),
>                                 mCall[c('b', 'a')]
>                         )
>                 },
>                 c('a', 'b')
>         )
>
>         # ...and try to use it
>         x <- 1:100
>         y <- 100 + 5 * x + rnorm(length(x), sd = 10)
>         nls(y ~ SSlinear(x, a, b))
>         # error in get('SSlinear'): object not found
> })
>
> As a workaround, I'll just provide the starting values manually,
> but should this work?
>
> As implemented [1], getInitial requires the model object to live in the
> stats package namespace or any of its parents, which eventually include
> the global environment and the attached packages, but not the private
> namespaces of the packages or any other local environments. This
> results from the fact that getInitial() uses plain get() in order to
> resolve the symbol for the self-starting model, and get() defaults to
> the current environment, which leads a chain of stats -> imports:stats
> -> base -> global environment -> attached packages.
>
> It seems easy to suggest get(., envir = environment(object)) as a fix,
> which would be able to access anything available at the time of
> creation of the formula. On the other hand, it would break the case
> when the stats package is not attached to the global environment or the
> formula environment, which currently works.
>
> --
> Best regards,
> Ivan
>
> [1]
>
> https://github.com/r-devel/r-svn/blob/d43497cbc927e632c6f597fa23001c3f31d4cae6/src/library/stats/R/selfStart.R#L81-L87
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From @eb@meyer @end|ng |rom |@u@de  Wed Jun 22 18:47:45 2022
From: @eb@meyer @end|ng |rom |@u@de (Sebastian Meyer)
Date: Wed, 22 Jun 2022 18:47:45 +0200
Subject: [Rd] stats::getInitial: requires the model to live in the stats
 namespace or above
In-Reply-To: <20220622182502.191d3a93@arachnoid>
References: <20220622182502.191d3a93@arachnoid>
Message-ID: <8c95fa55-a616-38d2-4ee0-7e4d16a50f85@fau.de>

Thank you, Ivan, for this careful report. You are right and I have 
actually found that issue myself while working on nlme bugs some months 
ago, but had decided to postpone working on that until someone reports 
any real problems with how this is implemented since ages.

Here is my (smaller) example:

> local({
>     mySSfunc <- stats::SSlogis
>     getInitial(circumference ~ mySSfunc(age, Asym, xmid, scal), Orange)
> })

Error in get(as.character(object[[3L]][[1L]])) :
   object 'mySSfunc' not found

And also evil code that I had planned as a regression test:

> plogis <- stats::SSlogis
> in2 <- getInitial(circumference ~ plogis(age, Asym, xmid, scal), Orange)

Error in getInitial.default(func, data, mCall = as.list(match.call(func, :
   no 'getInitial' method found for "function" objects

I had similar thoughts about the "obvious" patch that you describe and 
also assume a minor slow-down in variable lookup for the standard use 
case with the pre-defined self-starting functions from stats. However, 
these problems may not be relevant in practice ... they seem to be less 
relevant than the bug itself since we now both found it independently 
and it cannot be worked around. Furthermore, stats is a base package 
attached by default (but packages like yours could even "Depends: stats" 
to ensure that self-starting functions from stats are eventually found 
starting from the formula environment, often the global environment, if 
not masked).

I'd suggest you add this report to R's Bugzilla so that it can be linked 
from the NEWS once this gets addressed.

Thanks and best regards,

	Sebastian Meyer


Am 22.06.22 um 17:25 schrieb Ivan Krylov:
> Hello R-devel,
> 
> Here's a corner case I've stumbled upon recently:
> 
> local({
> 	# Originally this was a package namespace, but a local
> 	# environment also leads to failure
> 	stopifnot(!identical(environment(), globalenv()))
> 
> 	# Make a self-starting model inside this private environment...
> 	SSlinear <- selfStart(
> 		~ a * x + b,
> 		function(mCall, data, LHS, ...) {
> 			xy <- sortedXyData(mCall[['x']], LHS, data)
> 			setNames(
> 				coef(lm(y ~ x, xy)),
> 				mCall[c('b', 'a')]
> 			)
> 		},
> 		c('a', 'b')
> 	)
> 
> 	# ...and try to use it
> 	x <- 1:100
> 	y <- 100 + 5 * x + rnorm(length(x), sd = 10)
> 	nls(y ~ SSlinear(x, a, b))
> 	# error in get('SSlinear'): object not found
> })
> 
> As a workaround, I'll just provide the starting values manually,
> but should this work?
> 
> As implemented [1], getInitial requires the model object to live in the
> stats package namespace or any of its parents, which eventually include
> the global environment and the attached packages, but not the private
> namespaces of the packages or any other local environments. This
> results from the fact that getInitial() uses plain get() in order to
> resolve the symbol for the self-starting model, and get() defaults to
> the current environment, which leads a chain of stats -> imports:stats
> -> base -> global environment -> attached packages.
> 
> It seems easy to suggest get(., envir = environment(object)) as a fix,
> which would be able to access anything available at the time of
> creation of the formula. On the other hand, it would break the case
> when the stats package is not attached to the global environment or the
> formula environment, which currently works.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jun 22 19:57:53 2022
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 22 Jun 2022 13:57:53 -0400
Subject: [Rd] stats::getInitial: requires the model to live in the stats
 namespace or above
In-Reply-To: <CAHqSRuS51ruHwGy7gysr-pOA2fOEi4A2CYRuQahMrBkzdx6a5g@mail.gmail.com>
References: <20220622182502.191d3a93@arachnoid>
 <CAHqSRuS51ruHwGy7gysr-pOA2fOEi4A2CYRuQahMrBkzdx6a5g@mail.gmail.com>
Message-ID: <99a6c2b5-e2cf-8d09-24b2-1b6e57241ab3@gmail.com>

On 22/06/2022 12:44 p.m., Bill Dunlap wrote:
> Shouldn't the get()'s in stats:::getInitial.formula be looking in the
> environment of the formula, not the environment of getInitial.formula?

Yes, that definitely looks like the right environment to use.  Ivan, is 
that what you meant by "environment(object)"?

Duncan Murdoch

> 
> --- selfStart.R (revision 82512)
> +++ selfStart.R (working copy)
> @@ -78,13 +79,19 @@
>       switch (length(object),
>               stop("argument 'object' has an impossible length"),
>           {                              # one-sided formula
> -           func <- get(as.character(object[[2L]][[1L]]))
> +            if (!is.call(object[[2L]])) {
> +                stop("Right-hand side of formula is not a call")
> +            }
> +           func <- get(as.character(object[[2L]][[1L]]), mode="function",
> envir=environment(object))
>              getInitial(func, data,
>                         mCall = as.list(match.call(func, call =
> object[[2L]])),
>                          ...)
>           },
>           {                              # two-sided formula
> -           func <- get(as.character(object[[3L]][[1L]]))
> +            if (!is.call(object[[3L]])) {
> +                stop("Right-hand side of formula is not a call")
> +            }
> +           func <- get(as.character(object[[3L]][[1L]]), mode="function",
> envir=environment(object))
>              getInitial(func, data,
>                         mCall = as.list(match.call(func, call =
> object[[3L]])),
>                         LHS = object[[2L]], ...)
> 
> -Bill
> 
> 
> On Wed, Jun 22, 2022 at 8:25 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:
> 
>> Hello R-devel,
>>
>> Here's a corner case I've stumbled upon recently:
>>
>> local({
>>          # Originally this was a package namespace, but a local
>>          # environment also leads to failure
>>          stopifnot(!identical(environment(), globalenv()))
>>
>>          # Make a self-starting model inside this private environment...
>>          SSlinear <- selfStart(
>>                  ~ a * x + b,
>>                  function(mCall, data, LHS, ...) {
>>                          xy <- sortedXyData(mCall[['x']], LHS, data)
>>                          setNames(
>>                                  coef(lm(y ~ x, xy)),
>>                                  mCall[c('b', 'a')]
>>                          )
>>                  },
>>                  c('a', 'b')
>>          )
>>
>>          # ...and try to use it
>>          x <- 1:100
>>          y <- 100 + 5 * x + rnorm(length(x), sd = 10)
>>          nls(y ~ SSlinear(x, a, b))
>>          # error in get('SSlinear'): object not found
>> })
>>
>> As a workaround, I'll just provide the starting values manually,
>> but should this work?
>>
>> As implemented [1], getInitial requires the model object to live in the
>> stats package namespace or any of its parents, which eventually include
>> the global environment and the attached packages, but not the private
>> namespaces of the packages or any other local environments. This
>> results from the fact that getInitial() uses plain get() in order to
>> resolve the symbol for the self-starting model, and get() defaults to
>> the current environment, which leads a chain of stats -> imports:stats
>> -> base -> global environment -> attached packages.
>>
>> It seems easy to suggest get(., envir = environment(object)) as a fix,
>> which would be able to access anything available at the time of
>> creation of the formula. On the other hand, it would break the case
>> when the stats package is not attached to the global environment or the
>> formula environment, which currently works.
>>
>> --
>> Best regards,
>> Ivan
>>
>> [1]
>>
>> https://github.com/r-devel/r-svn/blob/d43497cbc927e632c6f597fa23001c3f31d4cae6/src/library/stats/R/selfStart.R#L81-L87
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jun 22 23:05:09 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 23 Jun 2022 00:05:09 +0300
Subject: [Rd] stats::getInitial: requires the model to live in the stats
 namespace or above
In-Reply-To: <99a6c2b5-e2cf-8d09-24b2-1b6e57241ab3@gmail.com>
References: <20220622182502.191d3a93@arachnoid>
 <CAHqSRuS51ruHwGy7gysr-pOA2fOEi4A2CYRuQahMrBkzdx6a5g@mail.gmail.com>
 <99a6c2b5-e2cf-8d09-24b2-1b6e57241ab3@gmail.com>
Message-ID: <20220623000509.53d374e8@Tarkus>

On Wed, 22 Jun 2022 13:57:53 -0400
Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> On 22/06/2022 12:44 p.m., Bill Dunlap wrote:
> > Shouldn't the get()'s in stats:::getInitial.formula be looking in
> > the environment of the formula, not the environment of
> > getInitial.formula?  
> 
> Yes, that definitely looks like the right environment to use.  Ivan,
> is that what you meant by "environment(object)"?

Yes, I meant the formula by "object", following the name of
getInitial.formula's argument.

-- 
Best regards,
Ivan


From pd@me@ @end|ng |rom cb@@dk  Thu Jun 23 09:55:57 2022
From: pd@me@ @end|ng |rom cb@@dk (Peter Dalgaard)
Date: Thu, 23 Jun 2022 07:55:57 +0000
Subject: [Rd] R 4.2.1 is released
Message-ID: <8041EC09-6465-4939-896A-E85F838AADA3@cbs.dk>

The build system rolled up R-4.2.1.tar.gz (codename "One Push-Up") this morning.

The list below details the changes in this release. 

You can get the source code from

https://cran.r-project.org/src/base/R-4/R-4.2.1.tar.gz

or wait for it to be mirrored at a CRAN site nearer to you.

Binaries for various platforms will appear in due course.


For the R Core Team,

Peter Dalgaard


These are the checksums (md5 and SHA-256) for the freshly created files, in case you wish
to check that they are uncorrupted:

MD5 (AUTHORS) = 320967884b547734d6279dedbc739dd4
MD5 (COPYING) = eb723b61539feef013de476e68b5c50a
MD5 (COPYING.LIB) = a6f89e2100d9b6cdffcea4f398e37343
MD5 (FAQ) = f593bc2137bcb005337630ca5611a26f
MD5 (INSTALL) = 7893f754308ca31f1ccf62055090ad7b
MD5 (NEWS) = 1004838de767cced995c375aae100afc
MD5 (NEWS.0) = bfcd7c147251b5474d96848c6f57e5a8
MD5 (NEWS.1) = eb78c4d053ec9c32b815cf0c2ebea801
MD5 (NEWS.2) = b38d94569700664205a76a7de836ba83
MD5 (NEWS.3) = e55ed2c8a547b827b46e08eb7137ba23
MD5 (R-latest.tar.gz) = d363458f20d011c9edf55c8c828af242
MD5 (README) = f468f281c919665e276a1b691decbbe6
MD5 (RESOURCES) = a79b9b338cab09bd665f6b62ac6f455b
MD5 (THANKS) = 45b6d2e88a6ecb5b24fa33a781351cd5
MD5 (VERSION-INFO.dcf) = 4a0d3c959d821eb56df62f39325c5506
MD5 (R-4/R-4.2.1.tar.gz) = d363458f20d011c9edf55c8c828af242

60a0d150e6fc1f424be76ad7b645d236b56e747692a4679f81ce6536c550e949  AUTHORS
e6d6a009505e345fe949e1310334fcb0747f28dae2856759de102ab66b722cb4  COPYING
6095e9ffa777dd22839f7801aa845b31c9ed07f3d6bf8a26dc5d2dec8ccc0ef3  COPYING.LIB
1b1f962382ff185e14b6b5b9b40dc87360399466c7d7ce928ae443261e3955c9  FAQ
f87461be6cbaecc4dce44ac58e5bd52364b0491ccdadaf846cb9b452e9550f31  INSTALL
8ee3b9f7ca0ac8366c8aa5be33d6bb13dbf7b084e119aa71d5b232590d166d6b  NEWS
4e21b62f515b749f80997063fceab626d7258c7d650e81a662ba8e0640f12f62  NEWS.0
12b30c724117b1b2b11484673906a6dcd48a361f69fc420b36194f9218692d01  NEWS.1
cde079b6beab7d700d3d4ecda494e2681ad3b7f8fab13b68be090f949393ec62  NEWS.2
1910a2405300b9bc7c76beeb0753a5249cf799afe175ce28f8d782fab723e012  NEWS.3
4d52db486d27848e54613d4ee977ad952ec08ce17807e1b525b10cd4436c643f  R-latest.tar.gz
2fdd3e90f23f32692d4b3a0c0452f2c219a10882033d1774f8cadf25886c3ddc  README
8b7d3856100220f4555d4d57140829f2e81c27eccec5b441f5dce616e9ec9061  RESOURCES
8319c5415de58ee10d4bc058d79c370fd8e6b2ad09e25d7a1e04b74ca5f380a6  THANKS
59604d5bbdd869681bef33e84ddec3a7c4a4dedab6e154f4cf40e4694ff69ece  VERSION-INFO.dcf
4d52db486d27848e54613d4ee977ad952ec08ce17807e1b525b10cd4436c643f  R-4/R-4.2.1.tar.gz

This is the relevant part of the NEWS file

CHANGES IN R 4.2.1:

  NEW FEATURES:

    * New function utils::findCRANmirror() to find out if a CRAN mirror
      has been selected, otherwise fallback to the main site.  This
      behaves in the same way as tools::CRAN_package_db() and is
      intended for packages wishing to access CRAN for purposes other
      than installing packages.

      The need for this was shown by a day when the main CRAN website
      was offline and a dozen or so packages which had its URL
      hardcoded failed their checks.

  INSTALLATION on a UNIX-ALIKE:

    * The libraries searched for by --with-blas (without a value) now
      include BLIS (after OpenBLAS but before ATLAS).  And on macOS,
      the Accelerate framework (after ATLAS).  (This is patterned after
      the AX_BLAS macro from the Autoconf Archive.)

    * The included LAPACK sources have been updated to 3.10.1.

  UTILITIES:

    * The (full path to) the command tidy to be used for HTML
      validation can be set by environment variable R_TIDYCMD.

    * Setting environment variable _R_CHECK_RD_VALIDATE_RD2HTML_ to a
      false value will override R CMD check --as-cran and turn off HTML
      validation.  This provides a way to circumvent a problematic
      tidy.

      The 2006 version that ships with macOS is always skipped.

  C-LEVEL FACILITIES:

    * The undocumented legacy declarations of Sint, Sfloat, SINT_MAX
      and SINT_MIN in header R.h are deprecated.

  BUG FIXES:

    * fisher.test(d) no longer segfaults for "large" d; fixing PR#18336
      by preventing/detecting an integer overflow reliably.

    * tar(., files=*) now produces correctly the warning about invalid
      uid or gid of files, fixing PR#18344, reported by Martin Morgan.

    * tk_choose.files() with multi = FALSE misbehaved on paths
      containing spaces (PR#18334) (regression introduced in R 4.0.0).

    * sort(x, partial = ind, *) now works correctly notably for the
      non-default na.last = FALSE or TRUE, fixing PR#18335 reported by
      James Edwards.

    * Environment variable _R_CHECK_XREFS_REPOSITORIES_ is only used
      for checking .Rd cross-references in R CMD check (as documented)
      and not for other uses looking for a CRAN mirror.

    * The search for a CRAN mirror when checking packages now uses
      getOption("repos") if that specifies a CRAN mirror, even when it
      does not also specify all three Bioconductor repositories (as was
      previously required).

    * The HTML code generated by tools::Rd2HTML() has been improved to
      pass tidy 5.8.0.

  BUG FIXES on Windows:

    * Writing to a clipboard connection works again, fixing a
      regression in R 4.2.0 (PR#18332).  Re-using a closed clipboard
      connection longer issues a spurious warning about an ignored
      encoding argument.

    * C function getlocale no longer attempts to query an unsupported
      category from the OS, even when requested at R level, which may
      cause crashes when R 4.2.0 (which uses UCRT) is embedded
      (reported by Kevin Ushey).

    * Accent keys now work in GraphApp Unicode windows, which are used
      by Rgui whenever running in a multibyte locale (so also in UTF-8,
      hence fixing a regression in R 4.2.0 for users of systems where R
      4.1 used a single-byte locale).

    * Completion in Rgui now works also with non-ASCII characters.

    * Rgui no longer truncates usage information with --help.

    * Text injection from external applications via SendInput now works
      in GraphApp Unicode windows, fixing a regression in R 4.2.0 for
      Rgui users of systems where R 4.1 used a single-byte locale but R
      4.2.0 uses UTF-8.

    * Performance of txtProgressBar() in Rgui when running in a
      multi-byte locale has been improved (fixing a performance
      regression in R 4.2.0 for users of systems where R 4.1 used a
      single-byte locale).

    * The script editor in Rgui now works also on systems using UTF-8
      as the native encoding.  Users of the script editor have to
      convert their scripts with non-ASCII characters to UTF-8 before
      reading them in R 4.2.1 or newer (on recent Windows where UTF-8
      is used).  This fixes a regression in R 4.2.0, which prevented
      some operations with scripts when they contained non-ASCII
      characters.


-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From Kurt@Horn|k @end|ng |rom wu@@c@@t  Thu Jun 23 12:37:12 2022
From: Kurt@Horn|k @end|ng |rom wu@@c@@t (Kurt Hornik)
Date: Thu, 23 Jun 2022 12:37:12 +0200
Subject: [Rd] HTML documentation check: 'condition must be plain text'
In-Reply-To: <20220620180602.36c20989@arachnoid>
References: <20220620180602.36c20989@arachnoid>
Message-ID: <25268.16984.355401.377288@hornik.net>

>>>>> Ivan Krylov writes:

> Hi,
> Use of \Sexpr in an \if condition in R documentation results in a NOTE,
> but only during HTML documentation check, not any of the previous Rd
> checks:

>   \if{\Sexpr{'TRUE'}}{The condition evaluates to true.}

> * checking HTML version of manual ... NOTE
> Encountered the following conversion/validation errors:
> foo.Rd:10: condition must be plain text

> Is this supported? "Writing R documentation" ?2.11 seems to agree:

>>> Also accepted [as a condition] are TRUE (matching all formats) and
>>> FALSE (matching no formats). These could be the output of the \Sexpr
>>> macro.

> In order to check the HTML documentation, check_Rd2HTML() runs
> tools::Rd2HTML() on the results of tools::Rd_db() [1]. The former runs
> \Sexpr[stage=render] macros and the latter runs \Sexpr[stage=build]
> macros, leaving \Sexpr[stage=install] macros unevaluated. The NOTE goes
> away if I switch the "stage" argument to anything but "install".

> Is there any downside to adding stages = c('build', 'install') to the
> Rd_db call or stages = c('install', 'render') to the Rd2HTML call in
> order to make this NOTE go away?

Thanks for spotting this.  There is in the current check code which
builds the Rd db from the package sources in which case one cannot
safely assume that install (as well as render) stage Sexprs can be
processed.  I'll try to change this so that we use the installed package
if possible etc.

Best
-k

> -- 
> Best regards,
> Ivan

> [1]
> https://github.com/r-devel/r-svn/blob/d25e77715164e39c96baae4c180d8f980ec93932/src/library/tools/R/check.R#L4911-L4939

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Thu Jun 23 18:07:31 2022
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Thu, 23 Jun 2022 16:07:31 +0000
Subject: [Rd] svd() results should have a class
Message-ID: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>

Dear R-Devel,

I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.

Thanks

Russ Lenth
Russell-lenth at uiowa.edu

	[[alternative HTML version deleted]]


From rh@r|ow86 @end|ng |rom gm@||@com  Fri Jun 24 01:53:39 2022
From: rh@r|ow86 @end|ng |rom gm@||@com (Robert Harlow)
Date: Thu, 23 Jun 2022 19:53:39 -0400
Subject: [Rd] svd() results should have a class
In-Reply-To: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
Message-ID: <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>

Don't have a view on whether it makes sense in base R or not, but WRE
section 7.1 may be helpful to you:
https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.

It's not uncommon for packages to want to make base methods generic and the
above link provides advice on how to do so.

Bob

On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu>
wrote:

> Dear R-Devel,
>
> I noticed that if we run base::svd(x), we obtain an object of class
> "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants
> to write methods for singular value decompositions? Note that other
> matrix-decomposition routines like qr() and eigen() each return objects
> having those names.
>
> Thanks
>
> Russ Lenth
> Russell-lenth at uiowa.edu
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Fri Jun 24 02:07:44 2022
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Fri, 24 Jun 2022 00:07:44 +0000
Subject: [Rd] [External] Re:  svd() results should have a class
In-Reply-To: <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
Message-ID: <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>

Bob,

I'm not talking about using svd as a generic method. I am talking about a method FOR svd results, e.g. an S3 method like foo.svd(), for which there already exist other methods, say foo.default and foo.qr. Currently if I wanted to do

    svdobj <- svd(x)
    foo(svdobj)

it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.

Russ

Sent from my iPad

On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:

?
Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.

It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.

Bob

On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
Dear R-Devel,

I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.

Thanks

Russ Lenth
Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>

        [[alternative HTML version deleted]]

______________________________________________
R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From g@bembecker @end|ng |rom gm@||@com  Fri Jun 24 02:18:48 2022
From: g@bembecker @end|ng |rom gm@||@com (Gabriel Becker)
Date: Thu, 23 Jun 2022 17:18:48 -0700
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
Message-ID: <CAD4oTHE9vA7xeVh4S0K9SNEgizzBN2M1_Xkp+vkiVWtrmMWnNQ@mail.gmail.com>

This does make sense to me, though I admit to not feeling super strongly
about it. Particularly in the light of the precedent from qr().

It would also be "mostly" backwards compatible, as there would not be
methods for the new class for existing code to get hung up on out of the
gate. Particularly, if class(svd(...)) was c("svd", "list") to ensure
existing methods were always hit. I don't have a great sense of the
difference in end behavior between doing that and just having the class e
"svd", though.

Should we add this as a very late addition to the Bug BBQ list for further
discussion?

~G

On Thu, Jun 23, 2022 at 5:08 PM Lenth, Russell V <russell-lenth at uiowa.edu>
wrote:

> Bob,
>
> I'm not talking about using svd as a generic method. I am talking about a
> method FOR svd results, e.g. an S3 method like foo.svd(), for which there
> already exist other methods, say foo.default and foo.qr. Currently if I
> wanted to do
>
>     svdobj <- svd(x)
>     foo(svdobj)
>
> it would not dispatch correctly because there is no svd class. Instead, it
> would be handled by foo.list if it exists, and it is certainly not clear
> that foo.list would do the right thing.
>
> Russ
>
> Sent from my iPad
>
> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>
> ?
> Don't have a view on whether it makes sense in base R or not, but WRE
> section 7.1 may be helpful to you:
> https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>
> It's not uncommon for packages to want to make base methods generic and
> the above link provides advice on how to do so.
>
> Bob
>
> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu
> <mailto:russell-lenth at uiowa.edu>> wrote:
> Dear R-Devel,
>
> I noticed that if we run base::svd(x), we obtain an object of class
> "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants
> to write methods for singular value decompositions? Note that other
> matrix-decomposition routines like qr() and eigen() each return objects
> having those names.
>
> Thanks
>
> Russ Lenth
> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jun 24 02:22:40 2022
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 23 Jun 2022 20:22:40 -0400
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
Message-ID: <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>

On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
> Bob,
> 
> I'm not talking about using svd as a generic method. I am talking about a method FOR svd results, e.g. an S3 method like foo.svd(), for which there already exist other methods, say foo.default and foo.qr. Currently if I wanted to do
> 
>      svdobj <- svd(x)
>      foo(svdobj)
> 
> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.

I think this would be more convincing if you gave a real example.  You 
can see the existing methods for the "qr" and "eigen" classes using

   methods(class = "qr")
   methods(class = "eigen")

When I do it, I think I'm only seeing methods from base packages, and 
they are:

   kappa for qr
   solve for qr
   print for eigen

I think the default print method works fine for svd() results. 
kappa.svd would probably make sense, but would need some thought: 
calculating kappa on a matrix and using the help page for kappa to 
naively calculate it from the svd() of that matrix give different results:

   > set.seed(123)
   > X <- matrix(rnorm(25), 5,5)
   > kappa(X)
   [1] 90.71283
   > s <- svd(X)
   > s$d[1]/s$d[length(s$d)]
   [1] 62.68048

Duncan Murdoch

> Russ
> 
> Sent from my iPad
> 
> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
> 
> ?
> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
> 
> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
> 
> Bob
> 
> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
> Dear R-Devel,
> 
> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
> 
> Thanks
> 
> Russ Lenth
> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From rh@r|ow86 @end|ng |rom gm@||@com  Fri Jun 24 02:25:39 2022
From: rh@r|ow86 @end|ng |rom gm@||@com (Robert Harlow)
Date: Thu, 23 Jun 2022 20:25:39 -0400
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <CAD4oTHE9vA7xeVh4S0K9SNEgizzBN2M1_Xkp+vkiVWtrmMWnNQ@mail.gmail.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <CAD4oTHE9vA7xeVh4S0K9SNEgizzBN2M1_Xkp+vkiVWtrmMWnNQ@mail.gmail.com>
Message-ID: <CAHdfS96NfMVL_RacH_bK6p+QBSWP7vmyE39wcwk=qAWK1P85Zw@mail.gmail.com>

Sorry, Russ - did not interpret your note correctly!



On Thu, Jun 23, 2022 at 8:18 PM Gabriel Becker <gabembecker at gmail.com>
wrote:

> This does make sense to me, though I admit to not feeling super strongly
> about it. Particularly in the light of the precedent from qr().
>
> It would also be "mostly" backwards compatible, as there would not be
> methods for the new class for existing code to get hung up on out of the
> gate. Particularly, if class(svd(...)) was c("svd", "list") to ensure
> existing methods were always hit. I don't have a great sense of the
> difference in end behavior between doing that and just having the class e
> "svd", though.
>
> Should we add this as a very late addition to the Bug BBQ list for further
> discussion?
>
> ~G
>
> On Thu, Jun 23, 2022 at 5:08 PM Lenth, Russell V <russell-lenth at uiowa.edu>
> wrote:
>
>> Bob,
>>
>> I'm not talking about using svd as a generic method. I am talking about a
>> method FOR svd results, e.g. an S3 method like foo.svd(), for which there
>> already exist other methods, say foo.default and foo.qr. Currently if I
>> wanted to do
>>
>>     svdobj <- svd(x)
>>     foo(svdobj)
>>
>> it would not dispatch correctly because there is no svd class. Instead,
>> it would be handled by foo.list if it exists, and it is certainly not clear
>> that foo.list would do the right thing.
>>
>> Russ
>>
>> Sent from my iPad
>>
>> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>>
>> ?
>> Don't have a view on whether it makes sense in base R or not, but WRE
>> section 7.1 may be helpful to you:
>> https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>>
>> It's not uncommon for packages to want to make base methods generic and
>> the above link provides advice on how to do so.
>>
>> Bob
>>
>> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <
>> russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
>> Dear R-Devel,
>>
>> I noticed that if we run base::svd(x), we obtain an object of class
>> "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants
>> to write methods for singular value decompositions? Note that other
>> matrix-decomposition routines like qr() and eigen() each return objects
>> having those names.
>>
>> Thanks
>>
>> Russ Lenth
>> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>

	[[alternative HTML version deleted]]


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Fri Jun 24 02:45:21 2022
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Fri, 24 Jun 2022 00:45:21 +0000
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
Message-ID: <DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>

Duncan et al.,

The real example would be the estimability package, in which there is a generic function nonest.basis and methods for classes lm, matrix, and qr. I wanted to add a method for class svd except there is no such class.

I agree BTW that the safe thing to do would be to have the returned object be of class c("svd", "list").

Best,

Russ

-----Original Message-----
From: Duncan Murdoch <murdoch.duncan at gmail.com> 
Sent: Thursday, June 23, 2022 7:23 PM
To: Lenth, Russell V <russell-lenth at uiowa.edu>; Robert Harlow <rharlow86 at gmail.com>
Cc: r-devel at r-project.org
Subject: Re: [Rd] [External] Re: svd() results should have a class

On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
> Bob,
> 
> I'm not talking about using svd as a generic method. I am talking 
> about a method FOR svd results, e.g. an S3 method like foo.svd(), for 
> which there already exist other methods, say foo.default and foo.qr. 
> Currently if I wanted to do
> 
>      svdobj <- svd(x)
>      foo(svdobj)
> 
> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.

I think this would be more convincing if you gave a real example.  You can see the existing methods for the "qr" and "eigen" classes using

   methods(class = "qr")
   methods(class = "eigen")

When I do it, I think I'm only seeing methods from base packages, and they are:

   kappa for qr
   solve for qr
   print for eigen

I think the default print method works fine for svd() results. 
kappa.svd would probably make sense, but would need some thought: 
calculating kappa on a matrix and using the help page for kappa to naively calculate it from the svd() of that matrix give different results:

   > set.seed(123)
   > X <- matrix(rnorm(25), 5,5)
   > kappa(X)
   [1] 90.71283
   > s <- svd(X)
   > s$d[1]/s$d[length(s$d)]
   [1] 62.68048

Duncan Murdoch

> Russ
> 
> Sent from my iPad
> 
> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
> 
> ?
> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
> 
> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
> 
> Bob
> 
> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
> Dear R-Devel,
> 
> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
> 
> Thanks
> 
> Russ Lenth
> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From @oko| @end|ng |rom |n@@-tou|ou@e@|r  Fri Jun 24 09:54:29 2022
From: @oko| @end|ng |rom |n@@-tou|ou@e@|r (Serguei Sokol)
Date: Fri, 24 Jun 2022 09:54:29 +0200
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
Message-ID: <859aaea6-da82-30d5-4415-19dd80c2ee73@insa-toulouse.fr>

Le 24/06/2022 ? 02:22, Duncan Murdoch a ?crit?:
> On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
>> Bob,
>>
>> I'm not talking about using svd as a generic method. I am talking 
>> about a method FOR svd results, e.g. an S3 method like foo.svd(), for 
>> which there already exist other methods, say foo.default and foo.qr. 
>> Currently if I wanted to do
>>
>> ???? svdobj <- svd(x)
>> ???? foo(svdobj)
>>
>> it would not dispatch correctly because there is no svd class. 
>> Instead, it would be handled by foo.list if it exists, and it is 
>> certainly not clear that foo.list would do the right thing.
>
> I think this would be more convincing if you gave a real example. You 
> can see the existing methods for the "qr" and "eigen" classes using
>
> ? methods(class = "qr")
> ? methods(class = "eigen")
>
> When I do it, I think I'm only seeing methods from base packages, and 
> they are:
>
> ? kappa for qr
> ? solve for qr
> ? print for eigen
>
> I think the default print method works fine for svd() results. 
> kappa.svd would probably make sense, but would need some thought: 
> calculating kappa on a matrix and using the help page for kappa to 
> naively calculate it from the svd() of that matrix give different 
> results:
>
> ? > set.seed(123)
> ? > X <- matrix(rnorm(25), 5,5)
> ? > kappa(X)
> ? [1] 90.71283
> ? > s <- svd(X)
> ? > s$d[1]/s$d[length(s$d)]
> ? [1] 62.68048
But ...

 > kappa(X, exact=TRUE)
[1] 62.68048

So, the honor of svd() is safe ;)

I would definitely see solve.svd() method if such class would be added.

Best,
Serguei.

>
> Duncan Murdoch
>
>> Russ
>>
>> Sent from my iPad
>>
>> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>>
>> ?
>> Don't have a view on whether it makes sense in base R or not, but WRE 
>> section 7.1 may be helpful to you: 
>> https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>>
>> It's not uncommon for packages to want to make base methods generic 
>> and the above link provides advice on how to do so.
>>
>> Bob
>>
>> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V 
>> <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
>> Dear R-Devel,
>>
>> I noticed that if we run base::svd(x), we obtain an object of class 
>> "list". Shouldn't there be an "svd" class, in case someone (e.g., me) 
>> wants to write methods for singular value decompositions? Note that 
>> other matrix-decomposition routines like qr() and eigen() each return 
>> objects having those names.
>>
>> Thanks
>>
>> Russ Lenth
>> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>>
>> ???????? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Serguei Sokol
Ingenieur de recherche INRAE

Cellule Math?matiques
TBI, INSA/INRAE UMR 792, INSA/CNRS UMR 5504
135 Avenue de Rangueil
31077 Toulouse Cedex 04

tel: +33 5 61 55 98 49
email: sokol at insa-toulouse.fr
http://www.toulouse-biotechnology-institute.fr/en/technology_platforms/mathematics-cell.html


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Jun 24 10:41:57 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 24 Jun 2022 10:41:57 +0200
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
 <DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
Message-ID: <25269.30933.736441.238198@stat.math.ethz.ch>

>>>>> Lenth, Russell V 
>>>>>     on Fri, 24 Jun 2022 00:45:21 +0000 writes:

    > Duncan et al.,
    > The real example would be the estimability package, in which there is a generic function nonest.basis and methods for classes lm, matrix, and qr. I wanted to add a method for class svd except there is no such class.

    > I agree BTW that the safe thing to do would be to have the returned object be of class c("svd", "list").

Well.. "safe" is relative here.
Practically *all* S3 classes are internally lists (notable
exceptions: "Date", "PosixCT") and we
never (AFAIR) append "list" to the class vector in such cases.

Martin

    > Best,

    > Russ

    > -----Original Message-----
    > From: Duncan Murdoch <murdoch.duncan at gmail.com> 
    > Sent: Thursday, June 23, 2022 7:23 PM
    > To: Lenth, Russell V <russell-lenth at uiowa.edu>; Robert Harlow <rharlow86 at gmail.com>
    > Cc: r-devel at r-project.org
    > Subject: Re: [Rd] [External] Re: svd() results should have a class

    > On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
    >> Bob,
    >> 
    >> I'm not talking about using svd as a generic method. I am talking 
    >> about a method FOR svd results, e.g. an S3 method like foo.svd(), for 
    >> which there already exist other methods, say foo.default and foo.qr. 
    >> Currently if I wanted to do
    >> 
    >> svdobj <- svd(x)
    >> foo(svdobj)
    >> 
    >> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.

    > I think this would be more convincing if you gave a real example.  You can see the existing methods for the "qr" and "eigen" classes using

    > methods(class = "qr")
    > methods(class = "eigen")

    > When I do it, I think I'm only seeing methods from base packages, and they are:

    > kappa for qr
    > solve for qr
    > print for eigen

    > I think the default print method works fine for svd() results. 
    > kappa.svd would probably make sense, but would need some thought: 
    > calculating kappa on a matrix and using the help page for kappa to naively calculate it from the svd() of that matrix give different results:

    >> set.seed(123)
    >> X <- matrix(rnorm(25), 5,5)
    >> kappa(X)
    > [1] 90.71283
    >> s <- svd(X)
    >> s$d[1]/s$d[length(s$d)]
    > [1] 62.68048

    > Duncan Murdoch

    >> Russ
    >> 
    >> Sent from my iPad
    >> 
    >> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
    >> 
    >> ?
    >> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
    >> 
    >> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
    >> 
    >> Bob
    >> 
    >> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
    >> Dear R-Devel,
    >> 
    >> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
    >> 
    >> Thanks
    >> 
    >> Russ Lenth
    >> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
    >> 
    >> [[alternative HTML version deleted]]
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list 
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> [[alternative HTML version deleted]]
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From pro|jcn@@h @end|ng |rom gm@||@com  Fri Jun 24 14:33:37 2022
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Fri, 24 Jun 2022 08:33:37 -0400
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <25269.30933.736441.238198@stat.math.ethz.ch>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
 <DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
 <25269.30933.736441.238198@stat.math.ethz.ch>
Message-ID: <a7d81455-6a6a-3e35-532b-01ceb9dd5e6c@gmail.com>

More a question than a comment: Is there an issue that methods for any svd result would need
to be cautious about the possibility that there are multiple forms of the svd for a matrix?
That is, for an m by n matrix A, we can have   A --> U S V'
   Full:  U m*m, S m*n V n*n
   Thin:  U m*n  S n*n V n*n
   Truncated:  U m*r S r*r V n*r  where r is the rank (and deciding that might require a referral
      to a higher power)

There are, of course, similar issues for the various QR outputs (Householder, Givens, Gram-Schmidt,
     modified Gram-Schmidt, and so on).

JN

On 2022-06-24 04:41, Martin Maechler wrote:
>>>>>> Lenth, Russell V
>>>>>>      on Fri, 24 Jun 2022 00:45:21 +0000 writes:
> 
>      > Duncan et al.,
>      > The real example would be the estimability package, in which there is a generic function nonest.basis and methods for classes lm, matrix, and qr. I wanted to add a method for class svd except there is no such class.
> 
>      > I agree BTW that the safe thing to do would be to have the returned object be of class c("svd", "list").
> 
> Well.. "safe" is relative here.
> Practically *all* S3 classes are internally lists (notable
> exceptions: "Date", "PosixCT") and we
> never (AFAIR) append "list" to the class vector in such cases.
> 
> Martin
> 
>      > Best,
> 
>      > Russ
> 
>      > -----Original Message-----
>      > From: Duncan Murdoch <murdoch.duncan at gmail.com>
>      > Sent: Thursday, June 23, 2022 7:23 PM
>      > To: Lenth, Russell V <russell-lenth at uiowa.edu>; Robert Harlow <rharlow86 at gmail.com>
>      > Cc: r-devel at r-project.org
>      > Subject: Re: [Rd] [External] Re: svd() results should have a class
> 
>      > On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
>      >> Bob,
>      >>
>      >> I'm not talking about using svd as a generic method. I am talking
>      >> about a method FOR svd results, e.g. an S3 method like foo.svd(), for
>      >> which there already exist other methods, say foo.default and foo.qr.
>      >> Currently if I wanted to do
>      >>
>      >> svdobj <- svd(x)
>      >> foo(svdobj)
>      >>
>      >> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.
> 
>      > I think this would be more convincing if you gave a real example.  You can see the existing methods for the "qr" and "eigen" classes using
> 
>      > methods(class = "qr")
>      > methods(class = "eigen")
> 
>      > When I do it, I think I'm only seeing methods from base packages, and they are:
> 
>      > kappa for qr
>      > solve for qr
>      > print for eigen
> 
>      > I think the default print method works fine for svd() results.
>      > kappa.svd would probably make sense, but would need some thought:
>      > calculating kappa on a matrix and using the help page for kappa to naively calculate it from the svd() of that matrix give different results:
> 
>      >> set.seed(123)
>      >> X <- matrix(rnorm(25), 5,5)
>      >> kappa(X)
>      > [1] 90.71283
>      >> s <- svd(X)
>      >> s$d[1]/s$d[length(s$d)]
>      > [1] 62.68048
> 
>      > Duncan Murdoch
> 
>      >> Russ
>      >>
>      >> Sent from my iPad
>      >>
>      >> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>      >>
>      >> ?
>      >> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>      >>
>      >> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
>      >>
>      >> Bob
>      >>
>      >> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
>      >> Dear R-Devel,
>      >>
>      >> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
>      >>
>      >> Thanks
>      >>
>      >> Russ Lenth
>      >> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>      >>
>      >> [[alternative HTML version deleted]]
>      >>
>      >> ______________________________________________
>      >> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-devel
>      >>
>      >> [[alternative HTML version deleted]]
>      >>
>      >> ______________________________________________
>      >> R-devel at r-project.org mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>      > ______________________________________________
>      > R-devel at r-project.org mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From j|ox @end|ng |rom mcm@@ter@c@  Fri Jun 24 15:55:45 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Fri, 24 Jun 2022 09:55:45 -0400
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <14370_1656031767_25O0nPc8028559_DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
 <14370_1656031767_25O0nPc8028559_DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
Message-ID: <6aebd94c-3a2d-53bf-d5ae-ac0cbf4b7e03@mcmaster.ca>

Dear Russ,

A couple of thoughts:

First, it's not clear to me where the svd objects are coming from -- 
that is, are they generated in the estimability package or coming, e.g., 
from model objects? If the former, then you could do something like 
this, creating your own svd class:

 > SVD <- function(x, ...){
+   s <- svd(x, ...)
+   class(s) <- "svd" # or c("svd", class(s))
+   s
+ }

And then, e.g.,

 > kappa.svd <- function(z, tol=sqrt(.Machine$double.eps), ...){
+   d <- z$d
+   d <- d[abs(d) > tol]
+   d[1]/d[length(d)]
+ }

 > m <- lm(Employed ~ ., data=longley)
 > kappa(m, exact=TRUE)
[1] 23845862
 > kappa(SVD(model.matrix(m)))
[1] 23845862

(I suspect you would have thought of this if it solved your problem.)

Second, I think that it's a good idea more generally to have base::svd() 
return objects of class "svd", and I doubt whether it really matters to 
append "list" to the class vector. It's not impossible, of course, that 
changing the class to "svd" from "list" would break something, but it's 
also hard to imagine a .list method that would expect an svd object.

Best,
  John

On 2022-06-23 8:45 p.m., Lenth, Russell V wrote:
> Duncan et al.,
> 
> The real example would be the estimability package, in which there is a generic function nonest.basis and methods for classes lm, matrix, and qr. I wanted to add a method for class svd except there is no such class.
> 
> I agree BTW that the safe thing to do would be to have the returned object be of class c("svd", "list").
> 
> Best,
> 
> Russ
> 
> -----Original Message-----
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Thursday, June 23, 2022 7:23 PM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>; Robert Harlow <rharlow86 at gmail.com>
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] [External] Re: svd() results should have a class
> 
> On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
>> Bob,
>>
>> I'm not talking about using svd as a generic method. I am talking
>> about a method FOR svd results, e.g. an S3 method like foo.svd(), for
>> which there already exist other methods, say foo.default and foo.qr.
>> Currently if I wanted to do
>>
>>       svdobj <- svd(x)
>>       foo(svdobj)
>>
>> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.
> 
> I think this would be more convincing if you gave a real example.  You can see the existing methods for the "qr" and "eigen" classes using
> 
>     methods(class = "qr")
>     methods(class = "eigen")
> 
> When I do it, I think I'm only seeing methods from base packages, and they are:
> 
>     kappa for qr
>     solve for qr
>     print for eigen
> 
> I think the default print method works fine for svd() results.
> kappa.svd would probably make sense, but would need some thought:
> calculating kappa on a matrix and using the help page for kappa to naively calculate it from the svd() of that matrix give different results:
> 
>     > set.seed(123)
>     > X <- matrix(rnorm(25), 5,5)
>     > kappa(X)
>     [1] 90.71283
>     > s <- svd(X)
>     > s$d[1]/s$d[length(s$d)]
>     [1] 62.68048
> 
> Duncan Murdoch
> 
>> Russ
>>
>> Sent from my iPad
>>
>> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>>
>> ?
>> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>>
>> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
>>
>> Bob
>>
>> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
>> Dear R-Devel,
>>
>> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
>>
>> Thanks
>>
>> Russ Lenth
>> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>>
>>           [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Fri Jun 24 16:41:08 2022
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Fri, 24 Jun 2022 14:41:08 +0000
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <6aebd94c-3a2d-53bf-d5ae-ac0cbf4b7e03@mcmaster.ca>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
 <14370_1656031767_25O0nPc8028559_DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
 <6aebd94c-3a2d-53bf-d5ae-ac0cbf4b7e03@mcmaster.ca>
Message-ID: <DM6PR04MB447444A739EFD94ADD3D697CF1B49@DM6PR04MB4474.namprd04.prod.outlook.com>

John,

Interestingly, for testing purposes, I created an SVD() function exactly like the one you show, even the same name.
What I think I'll do in the estimability package is just quietly add (but not export) a nonest.basis.svd function. Its main use, actually, will be that the nonest.basis.matrix method will be modified to pass most of its work to nonest.basis.svd(svd(x)) since, as it turns out, svd() is the simplest and most efficient way to obtain the desired result -- better than what I have now. I may also add a .list method that checks to see if the right named components of the right classes for svd are available, then passes to the .svd method.

So what I am saying is that there is no urgency to making the requested change.

If you do decide to add a class to svd() values (and La.svd()??), I defer to you experts on whether to inherit from "list". 

Best,

Russ

-----Original Message-----
From: John Fox <jfox at mcmaster.ca> 
Sent: Friday, June 24, 2022 8:56 AM
To: Lenth, Russell V <russell-lenth at uiowa.edu>
Cc: r-devel at r-project.org; Duncan Murdoch <murdoch.duncan at gmail.com>; Robert Harlow <rharlow86 at gmail.com>
Subject: Re: [Rd] [External] Re: svd() results should have a class

Dear Russ,

A couple of thoughts:

First, it's not clear to me where the svd objects are coming from -- that is, are they generated in the estimability package or coming, e.g., from model objects? If the former, then you could do something like this, creating your own svd class:

 > SVD <- function(x, ...){
+   s <- svd(x, ...)
+   class(s) <- "svd" # or c("svd", class(s))
+   s
+ }

And then, e.g.,

 > kappa.svd <- function(z, tol=sqrt(.Machine$double.eps), ...){
+   d <- z$d
+   d <- d[abs(d) > tol]
+   d[1]/d[length(d)]
+ }

 > m <- lm(Employed ~ ., data=longley)
 > kappa(m, exact=TRUE)
[1] 23845862
 > kappa(SVD(model.matrix(m)))
[1] 23845862

(I suspect you would have thought of this if it solved your problem.)

Second, I think that it's a good idea more generally to have base::svd() return objects of class "svd", and I doubt whether it really matters to append "list" to the class vector. It's not impossible, of course, that changing the class to "svd" from "list" would break something, but it's also hard to imagine a .list method that would expect an svd object.

Best,
  John

On 2022-06-23 8:45 p.m., Lenth, Russell V wrote:
> Duncan et al.,
> 
> The real example would be the estimability package, in which there is a generic function nonest.basis and methods for classes lm, matrix, and qr. I wanted to add a method for class svd except there is no such class.
> 
> I agree BTW that the safe thing to do would be to have the returned object be of class c("svd", "list").
> 
> Best,
> 
> Russ
> 
> -----Original Message-----
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Thursday, June 23, 2022 7:23 PM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>; Robert Harlow 
> <rharlow86 at gmail.com>
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] [External] Re: svd() results should have a class
> 
> On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
>> Bob,
>>
>> I'm not talking about using svd as a generic method. I am talking 
>> about a method FOR svd results, e.g. an S3 method like foo.svd(), for 
>> which there already exist other methods, say foo.default and foo.qr.
>> Currently if I wanted to do
>>
>>       svdobj <- svd(x)
>>       foo(svdobj)
>>
>> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.
> 
> I think this would be more convincing if you gave a real example.  You 
> can see the existing methods for the "qr" and "eigen" classes using
> 
>     methods(class = "qr")
>     methods(class = "eigen")
> 
> When I do it, I think I'm only seeing methods from base packages, and they are:
> 
>     kappa for qr
>     solve for qr
>     print for eigen
> 
> I think the default print method works fine for svd() results.
> kappa.svd would probably make sense, but would need some thought:
> calculating kappa on a matrix and using the help page for kappa to naively calculate it from the svd() of that matrix give different results:
> 
>     > set.seed(123)
>     > X <- matrix(rnorm(25), 5,5)
>     > kappa(X)
>     [1] 90.71283
>     > s <- svd(X)
>     > s$d[1]/s$d[length(s$d)]
>     [1] 62.68048
> 
> Duncan Murdoch
> 
>> Russ
>>
>> Sent from my iPad
>>
>> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>>
>> ?
>> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>>
>> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
>>
>> Bob
>>
>> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
>> Dear R-Devel,
>>
>> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
>>
>> Thanks
>>
>> Russ Lenth
>> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>>
>>           [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
--
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From tdhock5 @end|ng |rom gm@||@com  Fri Jun 24 17:08:05 2022
From: tdhock5 @end|ng |rom gm@||@com (Toby Hocking)
Date: Fri, 24 Jun 2022 17:08:05 +0200
Subject: [Rd] new warnings when compiling cmplxblas.f
Message-ID: <CALK03d0-BqJaRnqbZDMvkXVehFzcO2KfCDN9oN8YQufP3SgBTg@mail.gmail.com>

Hi all, I am observing the following warnings which are new (at least on my
system, ubuntu 18.04 with gfortran 10.1) when compiling the new release,
R-4.2.1 (make command).

$ ./configure --prefix=$HOME --enable-lto
...
$ make
...
make[4]: Entering directory '/home/tdhock/R/R-4.2.1/src/extra/blas'
gfortran -fno-optimize-sibling-calls -fpic  -g -O2 -mtune=native -Wall
-pedantic -flto -c blas.f -o blas.o
gfortran -fno-optimize-sibling-calls -fpic  -g -O2 -mtune=native -Wall
-pedantic -flto -c cmplxblas.f -o cmplxblas.o
cmplxblas.f:2:21:

    2 |       double complex z,zz
      |                     1
Warning: GNU Extension: DOUBLE COMPLEX at (1)
...
cmplxblas.f:4808:26:

 4808 |                   RTEMP = RTEMP + DCONJG( A( L, J ) )*A( L, J )
      |                          1
Warning: Possible change of value in conversion from COMPLEX(8) to REAL(8)
at (1) [-Wconversion]
gcc -shared -fopenmp -g -O2 -Wall -pedantic -mtune=native -flto -fpic
 -L/home/tdhock/lib64 -o libRblas.so blas.o  cmplxblas.o -lgfortran -lm
-lquadmath
#gcc-ar -cr libRblas.so blas.o  cmplxblas.o
make[4]: Leaving directory '/home/tdhock/R/R-4.2.1/src/extra/blas'
...
$ gfortran --version
GNU Fortran (GCC) 10.1.0
Copyright (C) 2020 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Above was the result when using the following in config.site:
RANLIB=gcc-ranlib
AR=gcc-ar
CXXFLAGS="-g -O2 -Wall -pedantic -mtune=native -Wno-ignored-attributes
-Wno-deprecated-declarations -Wno-parentheses"
FFLAGS="-g -O2 -mtune=native -Wall -pedantic"
CFLAGS="-g -O2 -Wall -pedantic -mtune=native"
LDFLAGS="-L$HOME/lib64"

	[[alternative HTML version deleted]]


From pro|jcn@@h @end|ng |rom gm@||@com  Fri Jun 24 18:11:29 2022
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Fri, 24 Jun 2022 12:11:29 -0400
Subject: [Rd] Understanding some code within nls()
Message-ID: <bd226ba8-2270-0008-7fce-4f9677b534df@gmail.com>

In working to try to improve the nls() function, a Google Summer of Code contributor and
I have found our understanding of the setPars() function in nls() in base R to be
inadequate.

setPars <- function(newPars) {
    setPars(newPars)
    resid <<- .swts * (lhs - (rhs <<- getRHS())) # envir = thisEnv {2 x}
    dev   <<- sum(resid^2) # envir = thisEnv
    if(length(gr <- attr(rhs, "gradient")) == 1L) gr <- c(gr)
    QR <<- qr(.swts * gr) # envir = thisEnv
    (QR$rank < min(dim(QR$qr))) # to catch the singular gradient matrix
}

There is a similar but not identical function in the minpack.lm.

I'd be grateful if anyone who has ideas on how this function is working
(in particular why the recursive call and then the "<<-" assignments are
needed) would get in touch offline to profjcnash _at_ gmail.com. I suspect
a list discussion is not useful without some preparatory work to narrow
the queries.

My intention is to write up a 1-2 page explanation as a prelude to modifying
code to introduce Marquardt stabilizations and bounds-constrained parameters,
which nls() currently lacks. Also I have examples where minpack.lm seems
to be failing to get bounds constraints correct. The nlsr package (Duncan
Murdoch and myself) does get these correct, but focusses on solving the
nonlinear least squares problem, and lacks many useful features for modeling
that are found in nls(). However, nls() often fails due to "singular gradient"
or else needs to use altered calls to apply special methods.

Assuming some success, I'll post links to the list.

John Nash


From j|ox @end|ng |rom mcm@@ter@c@  Fri Jun 24 18:24:10 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Fri, 24 Jun 2022 12:24:10 -0400
Subject: [Rd] [External] Re: svd() results should have a class
In-Reply-To: <DM6PR04MB447444A739EFD94ADD3D697CF1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
References: <DM6PR04MB44740AA49A865D347A1B1874F1B59@DM6PR04MB4474.namprd04.prod.outlook.com>
 <CAHdfS95A=m78=5-KyfL8FhsEyq3iVMMb1ZP9raEF+OggpQ8+hg@mail.gmail.com>
 <047B89DD-29EC-438D-ABB6-264764A37FA4@uiowa.edu>
 <51b2bb0e-4d9a-5a1f-c11e-1295a3df4464@gmail.com>
 <14370_1656031767_25O0nPc8028559_DM6PR04MB44748FDE876C820D94F5C2D5F1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
 <6aebd94c-3a2d-53bf-d5ae-ac0cbf4b7e03@mcmaster.ca>
 <DM6PR04MB447444A739EFD94ADD3D697CF1B49@DM6PR04MB4474.namprd04.prod.outlook.com>
Message-ID: <c64da371-588e-9d4c-3452-16c8bd740766@mcmaster.ca>

Dear Russ,

On 2022-06-24 10:41 a.m., Lenth, Russell V wrote:
> John,
> 
> Interestingly, for testing purposes, I created an SVD() function exactly like the one you show, even the same name.
> What I think I'll do in the estimability package is just quietly add (but not export) a nonest.basis.svd function. Its main use, actually, will be that the nonest.basis.matrix method will be modified to pass most of its work to nonest.basis.svd(svd(x)) since, as it turns out, svd() is the simplest and most efficient way to obtain the desired result -- better than what I have now. I may also add a .list method that checks to see if the right named components of the right classes for svd are available, then passes to the .svd method.

The possibility of adding a .list method and looking at the object to 
see whether it appears to be an svd also occurred to me, but I thought 
that it might be safer to add a .default method.

> 
> So what I am saying is that there is no urgency to making the requested change.
> 
> If you do decide to add a class to svd() values (and La.svd()??), I defer to you experts on whether to inherit from "list".

To be clear, I'm not a member of R core and so this isn't up to me (nor 
am I more expert than you!).

Thanks, by the way, for the very useful estimability package.

Best,
  John

> 
> Best,
> 
> Russ
> 
> -----Original Message-----
> From: John Fox <jfox at mcmaster.ca>
> Sent: Friday, June 24, 2022 8:56 AM
> To: Lenth, Russell V <russell-lenth at uiowa.edu>
> Cc: r-devel at r-project.org; Duncan Murdoch <murdoch.duncan at gmail.com>; Robert Harlow <rharlow86 at gmail.com>
> Subject: Re: [Rd] [External] Re: svd() results should have a class
> 
> Dear Russ,
> 
> A couple of thoughts:
> 
> First, it's not clear to me where the svd objects are coming from -- that is, are they generated in the estimability package or coming, e.g., from model objects? If the former, then you could do something like this, creating your own svd class:
> 
>   > SVD <- function(x, ...){
> +   s <- svd(x, ...)
> +   class(s) <- "svd" # or c("svd", class(s))
> +   s
> + }
> 
> And then, e.g.,
> 
>   > kappa.svd <- function(z, tol=sqrt(.Machine$double.eps), ...){
> +   d <- z$d
> +   d <- d[abs(d) > tol]
> +   d[1]/d[length(d)]
> + }
> 
>   > m <- lm(Employed ~ ., data=longley)
>   > kappa(m, exact=TRUE)
> [1] 23845862
>   > kappa(SVD(model.matrix(m)))
> [1] 23845862
> 
> (I suspect you would have thought of this if it solved your problem.)
> 
> Second, I think that it's a good idea more generally to have base::svd() return objects of class "svd", and I doubt whether it really matters to append "list" to the class vector. It's not impossible, of course, that changing the class to "svd" from "list" would break something, but it's also hard to imagine a .list method that would expect an svd object.
> 
> Best,
>    John
> 
> On 2022-06-23 8:45 p.m., Lenth, Russell V wrote:
>> Duncan et al.,
>>
>> The real example would be the estimability package, in which there is a generic function nonest.basis and methods for classes lm, matrix, and qr. I wanted to add a method for class svd except there is no such class.
>>
>> I agree BTW that the safe thing to do would be to have the returned object be of class c("svd", "list").
>>
>> Best,
>>
>> Russ
>>
>> -----Original Message-----
>> From: Duncan Murdoch <murdoch.duncan at gmail.com>
>> Sent: Thursday, June 23, 2022 7:23 PM
>> To: Lenth, Russell V <russell-lenth at uiowa.edu>; Robert Harlow
>> <rharlow86 at gmail.com>
>> Cc: r-devel at r-project.org
>> Subject: Re: [Rd] [External] Re: svd() results should have a class
>>
>> On 23/06/2022 8:07 p.m., Lenth, Russell V wrote:
>>> Bob,
>>>
>>> I'm not talking about using svd as a generic method. I am talking
>>> about a method FOR svd results, e.g. an S3 method like foo.svd(), for
>>> which there already exist other methods, say foo.default and foo.qr.
>>> Currently if I wanted to do
>>>
>>>        svdobj <- svd(x)
>>>        foo(svdobj)
>>>
>>> it would not dispatch correctly because there is no svd class. Instead, it would be handled by foo.list if it exists, and it is certainly not clear that foo.list would do the right thing.
>>
>> I think this would be more convincing if you gave a real example.  You
>> can see the existing methods for the "qr" and "eigen" classes using
>>
>>      methods(class = "qr")
>>      methods(class = "eigen")
>>
>> When I do it, I think I'm only seeing methods from base packages, and they are:
>>
>>      kappa for qr
>>      solve for qr
>>      print for eigen
>>
>> I think the default print method works fine for svd() results.
>> kappa.svd would probably make sense, but would need some thought:
>> calculating kappa on a matrix and using the help page for kappa to naively calculate it from the svd() of that matrix give different results:
>>
>>      > set.seed(123)
>>      > X <- matrix(rnorm(25), 5,5)
>>      > kappa(X)
>>      [1] 90.71283
>>      > s <- svd(X)
>>      > s$d[1]/s$d[length(s$d)]
>>      [1] 62.68048
>>
>> Duncan Murdoch
>>
>>> Russ
>>>
>>> Sent from my iPad
>>>
>>> On Jun 23, 2022, at 6:53 PM, Robert Harlow <rharlow86 at gmail.com> wrote:
>>>
>>> ?
>>> Don't have a view on whether it makes sense in base R or not, but WRE section 7.1 may be helpful to you: https://cran.r-project.org/doc/manuals/R-exts.html#Adding-new-generics.
>>>
>>> It's not uncommon for packages to want to make base methods generic and the above link provides advice on how to do so.
>>>
>>> Bob
>>>
>>> On Thu, Jun 23, 2022 at 12:07 PM Lenth, Russell V <russell-lenth at uiowa.edu<mailto:russell-lenth at uiowa.edu>> wrote:
>>> Dear R-Devel,
>>>
>>> I noticed that if we run base::svd(x), we obtain an object of class "list". Shouldn't there be an "svd" class, in case someone (e.g., me) wants to write methods for singular value decompositions? Note that other matrix-decomposition routines like qr() and eigen() each return objects having those names.
>>>
>>> Thanks
>>>
>>> Russ Lenth
>>> Russell-lenth at uiowa.edu<mailto:Russell-lenth at uiowa.edu>
>>>
>>>            [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
> 
-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Sat Jun 25 08:37:52 2022
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Sat, 25 Jun 2022 01:37:52 -0500
Subject: [Rd] 
 as.Date (and strptime?) does not recognize "&nbsp; " as a blank
Message-ID: <ffca1662-3ad3-95b0-b5f9-374dffcd0943@prodsyse.com>

Hello, All:


	  When is a space not a space?


	  Consider the following:


 > (pblmDate <- textutils::HTMLdecode("&nbsp;2 Mar 2018"))
[1] " 2 Mar 2018"
 > as.Date(pblmDate, format='%e %b %Y')
[1] NA
 > as.Date(' 2 Mar 2018', format='%e %b %Y')
[1] "2018-03-02"


	  Is this a feature or a bug?


	  I can work around it, now that I know what it is, but it took me a 
few hours to diagnose.


	  Thanks,
	  Spencer Graves


p.s.  I got this from scraping a website with code that had worked for 
me roughly 20 months ago.  I suspect that in the interim, someone 
probably replaced ' 2 Mar 2018' with "&nbsp;2 Mar 2018".


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Sat Jun 25 08:47:41 2022
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Sat, 25 Jun 2022 01:47:41 -0500
Subject: [Rd] 
 as.Date (and strptime?) does not recognize "&nbsp; " as a blank
In-Reply-To: <ffca1662-3ad3-95b0-b5f9-374dffcd0943@prodsyse.com>
References: <ffca1662-3ad3-95b0-b5f9-374dffcd0943@prodsyse.com>
Message-ID: <b7458796-4406-7da9-c893-db33f819b0a9@prodsyse.com>

p.s.  Is there a way to get XML::readHTMLTable to automatically convert 
"&nbsp;" to a normal blank space?


On 6/25/22 1:37 AM, Spencer Graves wrote:
> Hello, All:
> 
> 
>  ????? When is a space not a space?
> 
> 
>  ????? Consider the following:
> 
> 
>  > (pblmDate <- textutils::HTMLdecode("&nbsp;2 Mar 2018"))
> [1] " 2 Mar 2018"
>  > as.Date(pblmDate, format='%e %b %Y')
> [1] NA
>  > as.Date(' 2 Mar 2018', format='%e %b %Y')
> [1] "2018-03-02"
> 
> 
>  ????? Is this a feature or a bug?
> 
> 
>  ????? I can work around it, now that I know what it is, but it took me 
> a few hours to diagnose.
> 
> 
>  ????? Thanks,
>  ????? Spencer Graves
> 
> 
> p.s.? I got this from scraping a website with code that had worked for 
> me roughly 20 months ago.? I suspect that in the interim, someone 
> probably replaced ' 2 Mar 2018' with "&nbsp;2 Mar 2018".
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From pd@|gd @end|ng |rom gm@||@com  Sat Jun 25 10:20:39 2022
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Sat, 25 Jun 2022 10:20:39 +0200
Subject: [Rd] Understanding some code within nls()
In-Reply-To: <bd226ba8-2270-0008-7fce-4f9677b534df@gmail.com>
References: <bd226ba8-2270-0008-7fce-4f9677b534df@gmail.com>
Message-ID: <6E828323-BAA5-4997-B9BC-95674C4A05A3@gmail.com>

Where do you see that?

I see two instances in nls.R of

setPars = function(newPars) {...

but they are both part of a list element assignment, not function definitions as such. I.e., they are used for exporting an internal function to the outside world. The function sets variables in the environment of its defining function (e.g. nlsModel()), hence the <<-  

AFAICT, the code you write would die in an infite recursion immediately.

- Peter



> On 24 Jun 2022, at 18:11 , J C Nash <profjcnash at gmail.com> wrote:
> 
> In working to try to improve the nls() function, a Google Summer of Code contributor and
> I have found our understanding of the setPars() function in nls() in base R to be
> inadequate.
> 
> setPars <- function(newPars) {
>   setPars(newPars)
>   resid <<- .swts * (lhs - (rhs <<- getRHS())) # envir = thisEnv {2 x}
>   dev   <<- sum(resid^2) # envir = thisEnv
>   if(length(gr <- attr(rhs, "gradient")) == 1L) gr <- c(gr)
>   QR <<- qr(.swts * gr) # envir = thisEnv
>   (QR$rank < min(dim(QR$qr))) # to catch the singular gradient matrix
> }
> 
> There is a similar but not identical function in the minpack.lm.
> 
> I'd be grateful if anyone who has ideas on how this function is working
> (in particular why the recursive call and then the "<<-" assignments are
> needed) would get in touch offline to profjcnash _at_ gmail.com. I suspect
> a list discussion is not useful without some preparatory work to narrow
> the queries.
> 
> My intention is to write up a 1-2 page explanation as a prelude to modifying
> code to introduce Marquardt stabilizations and bounds-constrained parameters,
> which nls() currently lacks. Also I have examples where minpack.lm seems
> to be failing to get bounds constraints correct. The nlsr package (Duncan
> Murdoch and myself) does get these correct, but focusses on solving the
> nonlinear least squares problem, and lacks many useful features for modeling
> that are found in nls(). However, nls() often fails due to "singular gradient"
> or else needs to use altered calls to apply special methods.
> 
> Assuming some success, I'll post links to the list.
> 
> John Nash
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu  Sat Jun 25 13:10:43 2022
From: m@x|m@n@z@rov @end|ng |rom open@n@|yt|c@@eu (Maxim Nazarov)
Date: Sat, 25 Jun 2022 11:10:43 +0000
Subject: [Rd] 
 as.Date (and strptime?) does not recognize "&nbsp; " as a blank
In-Reply-To: <ffca1662-3ad3-95b0-b5f9-374dffcd0943@prodsyse.com>
References: <ffca1662-3ad3-95b0-b5f9-374dffcd0943@prodsyse.com>
Message-ID: <010201819a8e8fd5-5b4a4be1-e8ab-4b0a-9896-c6d03385dbef-000000@eu-west-1.amazonses.com>

Hello,

> When is a space not a space?
I guess the answer is when it is a non-breaking one?..

We can observe:
 > charToRaw(textutils::HTMLdecode("&nbsp;"))
 [1] c2 a0
 > charToRaw(" ")
 [1] 20
So one can argue that everything works correctly - `textutils` function converts HTML's non-breaking space '&nbsp;' into R's non-breaking space '\xa0', while %e format of as.Date expects a 'normal' space.
But this is obviously not user-friendly especially since both symbols are displayed the same way on the console.
So your options might be to either:
 * manually change all 'weird' spaces into normal ones with something like gsub("\\h", " ", ..., perl = TRUE) - for the list of other weird spaces see https://www.pcre.org/original/doc/html/pcrepattern.html#genericchartypes
 * persuade textutils author to change &nbsp; into a normal space (they seem to be working with a simple lookup table - https://github.com/enricoschumann/textutils/blob/b813c7bd4b55daef5fa7612e3fbfe82962711940/R/char_refs.R#L1465-L1466)
 * persuade R-Core (or submit a PR) to relax expectations of as.Date/strptime

Kind regards,
Maxim Nazarov

----- On Jun 25, 2022, at 8:37 AM, Spencer Graves spencer.graves at prodsyse.com wrote:

> Hello, All:
> 
> 
>	  When is a space not a space?
> 
> 
>	  Consider the following:
> 
> 
> > (pblmDate <- textutils::HTMLdecode("&nbsp;2 Mar 2018"))
> [1] " 2 Mar 2018"
> > as.Date(pblmDate, format='%e %b %Y')
> [1] NA
> > as.Date(' 2 Mar 2018', format='%e %b %Y')
> [1] "2018-03-02"
> 
> 
>	  Is this a feature or a bug?
> 
> 
>	  I can work around it, now that I know what it is, but it took me a
> few hours to diagnose.
> 
> 
>	  Thanks,
>	  Spencer Graves
> 
> 
> p.s.  I got this from scraping a website with code that had worked for
> me roughly 20 months ago.  I suspect that in the interim, someone
> probably replaced ' 2 Mar 2018' with "&nbsp;2 Mar 2018".
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Sat Jun 25 15:13:26 2022
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Sat, 25 Jun 2022 08:13:26 -0500
Subject: [Rd] 
 as.Date (and strptime?) does not recognize "&nbsp; " as a blank
In-Reply-To: <010201819a8e8fd5-5b4a4be1-e8ab-4b0a-9896-c6d03385dbef-000000@eu-west-1.amazonses.com>
References: <ffca1662-3ad3-95b0-b5f9-374dffcd0943@prodsyse.com>
 <010201819a8e8fd5-5b4a4be1-e8ab-4b0a-9896-c6d03385dbef-000000@eu-west-1.amazonses.com>
Message-ID: <3f6da3f4-5eb2-93f6-5c75-c1f35b40edb8@prodsyse.com>

Hi, Maxim et al.:


On 6/25/22 6:10 AM, Maxim Nazarov wrote:
> Hello,
> 
>> When is a space not a space?
> I guess the answer is when it is a non-breaking one?..
> 
> We can observe:
>   > charToRaw(textutils::HTMLdecode("&nbsp;"))
>   [1] c2 a0
>   > charToRaw(" ")
>   [1] 20
> So one can argue that everything works correctly - `textutils` function converts HTML's non-breaking space '&nbsp;' into R's non-breaking space '\xa0', while %e format of as.Date expects a 'normal' space.
> But this is obviously not user-friendly especially since both symbols are displayed the same way on the console.
> So your options might be to either:
>   * manually change all 'weird' spaces into normal ones with something like gsub("\\h", " ", ..., perl = TRUE) - for the list of other weird spaces see https://www.pcre.org/original/doc/html/pcrepattern.html#genericchartypes
>   * persuade textutils author to change &nbsp; into a normal space (they seem to be working with a simple lookup table - https://github.com/enricoschumann/textutils/blob/b813c7bd4b55daef5fa7612e3fbfe82962711940/R/char_refs.R#L1465-L1466)
>   * persuade R-Core (or submit a PR) to relax expectations of as.Date/strptime
> 

	  Thanks for the reply.  Since "this is obviously not user-friendly", 
as you noted, I felt a need to bring it to the attention of this group, 
and let them decide what if anything they would want to do about it.


	  In any event, I found a fix for my immediate problem.  It's not as 
elegant as yours, but it works.

	  Best Wishes,
	  Spencer




> Kind regards,
> Maxim Nazarov
> 
> ----- On Jun 25, 2022, at 8:37 AM, Spencer Graves spencer.graves at prodsyse.com wrote:
> 
>> Hello, All:
>>
>>
>> 	  When is a space not a space?
>>
>>
>> 	  Consider the following:
>>
>>
>>> (pblmDate <- textutils::HTMLdecode("&nbsp;2 Mar 2018"))
>> [1] " 2 Mar 2018"
>>> as.Date(pblmDate, format='%e %b %Y')
>> [1] NA
>>> as.Date(' 2 Mar 2018', format='%e %b %Y')
>> [1] "2018-03-02"
>>
>>
>> 	  Is this a feature or a bug?
>>
>>
>> 	  I can work around it, now that I know what it is, but it took me a
>> few hours to diagnose.
>>
>>
>> 	  Thanks,
>> 	  Spencer Graves
>>
>>
>> p.s.  I got this from scraping a website with code that had worked for
>> me roughly 20 months ago.  I suspect that in the interim, someone
>> probably replaced ' 2 Mar 2018' with "&nbsp;2 Mar 2018".
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


