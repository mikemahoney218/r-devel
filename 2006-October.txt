From ggrothendieck at gmail.com  Sun Oct  1 04:54:47 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 30 Sep 2006 22:54:47 -0400
Subject: [Rd] Rcmd install mypkg
Message-ID: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>

I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
that I get this error:

C:\Rpkgs>Rcmd install mypkg
no Perl script 'install'

The same command worked with no error in 2.3.1pat.  If I capitalize
INSTALL it does work; however, this was not necessary previously.

Note that

C:\Rpkgs>Rcmd check mypkg

unlike install, still works in either lower or upper case in 2.4.0 alpha.



From deepayan.sarkar at gmail.com  Sun Oct  1 05:34:25 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Sat, 30 Sep 2006 20:34:25 -0700
Subject: [Rd] newly introduced lattice bug
In-Reply-To: <20060930163029.BJD98568@po-d.temple.edu>
References: <20060930163029.BJD98568@po-d.temple.edu>
Message-ID: <eb555e660609302034s65d9d631je6f16a9233415f3f@mail.gmail.com>

On 9/30/06, Richard M. Heiberger <rmh at temple.edu> wrote:
> > library(lattice)
> > xyplot(rnorm(10) ~ rnorm(10) | factor(1:10), layout=c(2,3))
> > version
>                _
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status         RC
> major          2
> minor          4.0
> year           2006
> month          09
> day            27
> svn rev        39543
> language       R
> version.string R version 2.4.0 RC (2006-09-27 r39543)
> >
>
>
> This was downloaded two minutes ago from the CRAN page
> http://cran.us.r-project.org/bin/windows/base/rtest.html
> dated
> Last build: 2006-09-29, by Duncan Murdoch
>
>
> The bug is that 2.4.0 RC displays 12 panels, with the incorrect top two panels
> on the second page being copies of the correct top two panels on the first page.
>
> I just noticed this in R version 2.4.0 beta (2006-09-20 r39421)
> and immediately got a newer version of R before reporting it.
>
> R-2.3.1 displays the correct 10 panels.

Thanks for catching this. Some variables were not being reinitialized
for new pages. Fixed version should be available soon.

Deepayan



From ggrothendieck at gmail.com  Sun Oct  1 13:20:04 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 1 Oct 2006 07:20:04 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <451F97CB.8020000@stats.uwo.ca>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
Message-ID: <971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>

This would seem to violate the user interface stereotype that
command lines are case insensitive on Windows.

On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 9/30/2006 10:54 PM, Gabor Grothendieck wrote:
> > I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
> > that I get this error:
> >
> > C:\Rpkgs>Rcmd install mypkg
> > no Perl script 'install'
> >
> > The same command worked with no error in 2.3.1pat.  If I capitalize
> > INSTALL it does work; however, this was not necessary previously.
> >
> > Note that
> >
> > C:\Rpkgs>Rcmd check mypkg
> >
> > unlike install, still works in either lower or upper case in 2.4.0 alpha.
>
> This is a documented change--see the CHANGES file.
>
> Duncan Murdoch
>



From pburns at pburns.seanet.com  Sun Oct  1 13:11:50 2006
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sun, 01 Oct 2006 12:11:50 +0100
Subject: [Rd] stack imbalance in contour
Message-ID: <451FA276.2070902@pburns.seanet.com>

I'm not sure if this has much significance or not -- but
it sounds rather ominous.  It doesn't appear to be new
as it happens with 2.0.0 in Linux (but the formatting of
the warning messages has improved).

 > contour(array(3e10, c(10,10), list(1:10, 11:20)))
Warning: stack imbalance in 'contour', 20 then 24
Warning: stack imbalance in '.Internal', 19 then 23
Warning: stack imbalance in '{', 17 then 21
Warning message:
all z values are equal
 > sessionInfo()
R version 2.4.0 RC (2006-09-27 r39543)
i386-pc-mingw32

locale:
LC_COLLATE=English_United Kingdom.1252;LC_CTYPE=English_United 
Kingdom.1252;LC_MONETARY=English_United 
Kingdom.1252;LC_NUMERIC=C;LC_TIME=English_United Kingdom.1252

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "base"    


Patrick Burns
patrick at burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")



From murdoch at stats.uwo.ca  Sun Oct  1 12:26:19 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 01 Oct 2006 06:26:19 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
Message-ID: <451F97CB.8020000@stats.uwo.ca>

On 9/30/2006 10:54 PM, Gabor Grothendieck wrote:
> I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
> that I get this error:
> 
> C:\Rpkgs>Rcmd install mypkg
> no Perl script 'install'
> 
> The same command worked with no error in 2.3.1pat.  If I capitalize
> INSTALL it does work; however, this was not necessary previously.
> 
> Note that
> 
> C:\Rpkgs>Rcmd check mypkg
> 
> unlike install, still works in either lower or upper case in 2.4.0 alpha.

This is a documented change--see the CHANGES file.

Duncan Murdoch



From ligges at statistik.uni-dortmund.de  Sun Oct  1 14:36:27 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun, 01 Oct 2006 14:36:27 +0200
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
Message-ID: <451FB64B.5000400@statistik.uni-dortmund.de>



Gabor Grothendieck wrote:
> This would seem to violate the user interface stereotype that
> command lines are case insensitive on Windows.

This is an improvement. R tries to be as unique as possible on all 
platforms.

Uwe Ligges


> On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 9/30/2006 10:54 PM, Gabor Grothendieck wrote:
>>> I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
>>> that I get this error:
>>>
>>> C:\Rpkgs>Rcmd install mypkg
>>> no Perl script 'install'
>>>
>>> The same command worked with no error in 2.3.1pat.  If I capitalize
>>> INSTALL it does work; however, this was not necessary previously.
>>>
>>> Note that
>>>
>>> C:\Rpkgs>Rcmd check mypkg
>>>
>>> unlike install, still works in either lower or upper case in 2.4.0 alpha.
>> This is a documented change--see the CHANGES file.
>>
>> Duncan Murdoch
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From p.dalgaard at biostat.ku.dk  Sun Oct  1 14:38:51 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 01 Oct 2006 14:38:51 +0200
Subject: [Rd] stack imbalance in contour
In-Reply-To: <451FA276.2070902@pburns.seanet.com>
References: <451FA276.2070902@pburns.seanet.com>
Message-ID: <x2y7s06wis.fsf@turmalin.kubism.ku.dk>

Patrick Burns <pburns at pburns.seanet.com> writes:

> I'm not sure if this has much significance or not -- but
> it sounds rather ominous.  It doesn't appear to be new
> as it happens with 2.0.0 in Linux (but the formatting of
> the warning messages has improved).
> 
>  > contour(array(3e10, c(10,10), list(1:10, 11:20)))
> Warning: stack imbalance in 'contour', 20 then 24
> Warning: stack imbalance in '.Internal', 19 then 23
> Warning: stack imbalance in '{', 17 then 21
> Warning message:
> all z values are equal
>  > sessionInfo()
> R version 2.4.0 RC (2006-09-27 r39543)
> i386-pc-mingw32

I see it on Linux too. It's a serious programming error in that
something has its PROTECT/UNPROTECT mechanism messed up. Fortunately,
it is protecting too much, which is not usually fatal. Also, it
appears to happen only in the all z equal case (the value 3e10 is
not magic - any nonzero z will do). We should get it tracked down,
but it's not worth breaking the code freeze for 2.4.0 over.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From ggrothendieck at gmail.com  Sun Oct  1 14:53:30 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 1 Oct 2006 08:53:30 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <451FB64B.5000400@statistik.uni-dortmund.de>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FB64B.5000400@statistik.uni-dortmund.de>
Message-ID: <971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>

On 10/1/06, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
>
>
> Gabor Grothendieck wrote:
> > This would seem to violate the user interface stereotype that
> > command lines are case insensitive on Windows.
>
> This is an improvement. R tries to be as unique as possible on all
> platforms.

Not sure what the above means but if you mean it works the same
on all platforms that is an error in the design of the software in my view.
The objective should be that it fits into the environment its working in.

Any Windows user can tell the difference between "clunky" UNIX-derived
software which does not feel right on the Windows platform and
software that adapts its interface to work like all other Windows programs
in that environment.

>
> Uwe Ligges
>
>
> > On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 9/30/2006 10:54 PM, Gabor Grothendieck wrote:
> >>> I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
> >>> that I get this error:
> >>>
> >>> C:\Rpkgs>Rcmd install mypkg
> >>> no Perl script 'install'
> >>>
> >>> The same command worked with no error in 2.3.1pat.  If I capitalize
> >>> INSTALL it does work; however, this was not necessary previously.
> >>>
> >>> Note that
> >>>
> >>> C:\Rpkgs>Rcmd check mypkg
> >>>
> >>> unlike install, still works in either lower or upper case in 2.4.0 alpha.
> >> This is a documented change--see the CHANGES file.
> >>
> >> Duncan Murdoch
> >>
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>



From ahenningsen at agric-econ.uni-kiel.de  Sun Oct  1 15:35:54 2006
From: ahenningsen at agric-econ.uni-kiel.de (ahenningsen at agric-econ.uni-kiel.de)
Date: Sun,  1 Oct 2006 15:35:54 +0200 (CEST)
Subject: [Rd] WISH: "R CMD build" should use the (correct) package name
	(PR#9266)
Message-ID: <20061001133554.DE54F29C44@slim.kubism.ku.dk>

Full_Name: Arne Henningsen
Version: >= 2.3.0
OS: Linux (SuSE 10.0)
Submission from: (NULL) (134.245.18.1)


Since R version 2.3.0 "R CMD check" and "R CMD INSTALL" work for packages whose
package name is different from the directory name in which it is located (see
http://cran.r-project.org/src/base/NEWS). While "R CMD check" and "R CMD
INSTALL" determine the correct package name from the DESCRIPTION file, "R CMD
build" uses the directory name (and not the package name) for the file name of
the source package and for the base directory inside this .tar.gz archive (see
also http://tolstoy.newcastle.edu.au/R/e2/devel/06/09/0406.html).
Please let "R CMD build" determine the correct package name from the DESCRIPTION
file.

Thanks,
Arne



From duncan at wald.ucdavis.edu  Sun Oct  1 16:49:56 2006
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Sun, 01 Oct 2006 07:49:56 -0700
Subject: [Rd] WISH: "R CMD build" should use the (correct) package name
 (PR#9266)
In-Reply-To: <20061001133554.DE54F29C44@slim.kubism.ku.dk>
References: <20061001133554.DE54F29C44@slim.kubism.ku.dk>
Message-ID: <451FD594.9010704@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


I happened to be looking at that myself yesterday.
It is relatively easy to get the package name
from the DESCRIPTION file and not the directory name.
But there are other issues. I'll look into this further
in a week or two.

 D.

ahenningsen at agric-econ.uni-kiel.de wrote:
> Full_Name: Arne Henningsen
> Version: >= 2.3.0
> OS: Linux (SuSE 10.0)
> Submission from: (NULL) (134.245.18.1)
> 
> 
> Since R version 2.3.0 "R CMD check" and "R CMD INSTALL" work for packages whose
> package name is different from the directory name in which it is located (see
> http://cran.r-project.org/src/base/NEWS). While "R CMD check" and "R CMD
> INSTALL" determine the correct package name from the DESCRIPTION file, "R CMD
> build" uses the directory name (and not the package name) for the file name of
> the source package and for the base directory inside this .tar.gz archive (see
> also http://tolstoy.newcastle.edu.au/R/e2/devel/06/09/0406.html).
> Please let "R CMD build" determine the correct package name from the DESCRIPTION
> file.
> 
> Thanks,
> Arne
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

- --
Duncan Temple Lang                    duncan at wald.ucdavis.edu
Department of Statistics              work:  (530) 752-4782
4210 Mathematical Sciences Building   fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis,
CA 95616,
USA
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (Darwin)

iD8DBQFFH9WU9p/Jzwa2QP4RAjWHAJ0bJYcFY/hxKSwXKNbC0r1RxnSB+ACffdCo
z9vr7teuozTLiEoKOOTjab8=
=ALqL
-----END PGP SIGNATURE-----



From duncan at wald.ucdavis.edu  Sun Oct  1 16:50:10 2006
From: duncan at wald.ucdavis.edu (duncan at wald.ucdavis.edu)
Date: Sun,  1 Oct 2006 16:50:10 +0200 (CEST)
Subject: [Rd] WISH: "R CMD build" should use the (correct) package name
	(PR#9267)
Message-ID: <20061001145010.83C7749FDE@slim.kubism.ku.dk>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


I happened to be looking at that myself yesterday.
It is relatively easy to get the package name
from the DESCRIPTION file and not the directory name.
But there are other issues. I'll look into this further
in a week or two.

 D.

ahenningsen at agric-econ.uni-kiel.de wrote:
> Full_Name: Arne Henningsen
> Version: >= 2.3.0
> OS: Linux (SuSE 10.0)
> Submission from: (NULL) (134.245.18.1)
> 
> 
> Since R version 2.3.0 "R CMD check" and "R CMD INSTALL" work for packages whose
> package name is different from the directory name in which it is located (see
> http://cran.r-project.org/src/base/NEWS). While "R CMD check" and "R CMD
> INSTALL" determine the correct package name from the DESCRIPTION file, "R CMD
> build" uses the directory name (and not the package name) for the file name of
> the source package and for the base directory inside this .tar.gz archive (see
> also http://tolstoy.newcastle.edu.au/R/e2/devel/06/09/0406.html).
> Please let "R CMD build" determine the correct package name from the DESCRIPTION
> file.
> 
> Thanks,
> Arne
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

- --
Duncan Temple Lang                    duncan at wald.ucdavis.edu
Department of Statistics              work:  (530) 752-4782
4210 Mathematical Sciences Building   fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis,
CA 95616,
USA
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (Darwin)

iD8DBQFFH9WU9p/Jzwa2QP4RAjWHAJ0bJYcFY/hxKSwXKNbC0r1RxnSB+ACffdCo
z9vr7teuozTLiEoKOOTjab8=
=ALqL
-----END PGP SIGNATURE-----



From edd at debian.org  Sun Oct  1 19:06:37 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 1 Oct 2006 12:06:37 -0500
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FB64B.5000400@statistik.uni-dortmund.de>
	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>
Message-ID: <17695.62877.892232.309341@basebud.nulle.part>


On 1 October 2006 at 08:53, Gabor Grothendieck wrote:
| On 10/1/06, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
| > Gabor Grothendieck wrote:
| > > This would seem to violate the user interface stereotype that
| > > command lines are case insensitive on Windows.
| >
| > This is an improvement. R tries to be as unique as possible on all
| > platforms.
| 
| Not sure what the above means but if you mean it works the same
| on all platforms that is an error in the design of the software in my view.
| The objective should be that it fits into the environment its working in.
| 
| Any Windows user can tell the difference between "clunky" UNIX-derived
| software which does not feel right on the Windows platform and
| software that adapts its interface to work like all other Windows programs
| in that environment.

Generally speaking, I think many of us would beg to differ and much rather
(continue to) see consistency of R across platforms.

Personally speaking, I would think that taking what I consider to be a clunky
OS and UI to be the gold standard as somewhat questionable. But that may just
be me.

Cheers, Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From ggrothendieck at gmail.com  Sun Oct  1 19:10:07 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 1 Oct 2006 13:10:07 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <17695.62877.892232.309341@basebud.nulle.part>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FB64B.5000400@statistik.uni-dortmund.de>
	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>
	<17695.62877.892232.309341@basebud.nulle.part>
Message-ID: <971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>

On 10/1/06, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 1 October 2006 at 08:53, Gabor Grothendieck wrote:
> | On 10/1/06, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
> | > Gabor Grothendieck wrote:
> | > > This would seem to violate the user interface stereotype that
> | > > command lines are case insensitive on Windows.
> | >
> | > This is an improvement. R tries to be as unique as possible on all
> | > platforms.
> |
> | Not sure what the above means but if you mean it works the same
> | on all platforms that is an error in the design of the software in my view.
> | The objective should be that it fits into the environment its working in.
> |
> | Any Windows user can tell the difference between "clunky" UNIX-derived
> | software which does not feel right on the Windows platform and
> | software that adapts its interface to work like all other Windows programs
> | in that environment.
>
> Generally speaking, I think many of us would beg to differ and much rather
> (continue to) see consistency of R across platforms.
>
> Personally speaking, I would think that taking what I consider to be a clunky
> OS and UI to be the gold standard as somewhat questionable. But that may just
> be me.
>
> Cheers, Dirk
>
> --
> Hell, there are no rules here - we're trying to accomplish something.
>                                                  -- Thomas A. Edison
>

I don't want to get into a debate on the merits of an OS but in terms of
user interface principles one wants to fit into the environment that the
software is working in rather than have the user familiarize themselves
with multiple styles of interaction.

If you are running UNIX and Windows you can expect differences when
you move from one to the other but you do not expect differences when
running one program vs. another in the same OS.



From murdoch at stats.uwo.ca  Sun Oct  1 19:10:20 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 01 Oct 2006 13:10:20 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
Message-ID: <451FF67C.2020205@stats.uwo.ca>

On 10/1/2006 7:20 AM, Gabor Grothendieck wrote:
> This would seem to violate the user interface stereotype that
> command lines are case insensitive on Windows.

And command options use a / prefix in Windows, but a - or -- prefix in 
R, and the path separator in Windows is \ in most places, but / is 
accepted in R.  There are a large number of inconsistencies between 
Windows and other systems, and R mostly follows the GNU conventions; 
it's a GNU project, after all.

Duncan Murdoch

> 
> On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 9/30/2006 10:54 PM, Gabor Grothendieck wrote:
>>> I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
>>> that I get this error:
>>>
>>> C:\Rpkgs>Rcmd install mypkg
>>> no Perl script 'install'
>>>
>>> The same command worked with no error in 2.3.1pat.  If I capitalize
>>> INSTALL it does work; however, this was not necessary previously.
>>>
>>> Note that
>>>
>>> C:\Rpkgs>Rcmd check mypkg
>>>
>>> unlike install, still works in either lower or upper case in 2.4.0 alpha.
>> This is a documented change--see the CHANGES file.
>>
>> Duncan Murdoch
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From ggrothendieck at gmail.com  Sun Oct  1 19:23:46 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 1 Oct 2006 13:23:46 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <451FF67C.2020205@stats.uwo.ca>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FF67C.2020205@stats.uwo.ca>
Message-ID: <971536df0610011023o5fd3d059p459ace909d0dd8e1@mail.gmail.com>

On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/1/2006 7:20 AM, Gabor Grothendieck wrote:
> > This would seem to violate the user interface stereotype that
> > command lines are case insensitive on Windows.
>
> And command options use a / prefix in Windows, but a - or -- prefix in
> R, and the path separator in Windows is \ in most places, but / is
> accepted in R.  There are a large number of inconsistencies between
> Windows and other systems, and R mostly follows the GNU conventions;
> it's a GNU project, after all.

That's not a bad point but is there really any reason to make it even
less windows-like?  After all, it did work in either case before and
windows filenames are case insensitive so its not like there is
a valid distinction between install and INSTALL if the word refers
to a filename.

>
> Duncan Murdoch
>
> >
> > On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 9/30/2006 10:54 PM, Gabor Grothendieck wrote:
> >>> I noticed that in "R version 2.4.0 alpha (2006-09-16 r39365)" on Windows XP
> >>> that I get this error:
> >>>
> >>> C:\Rpkgs>Rcmd install mypkg
> >>> no Perl script 'install'
> >>>
> >>> The same command worked with no error in 2.3.1pat.  If I capitalize
> >>> INSTALL it does work; however, this was not necessary previously.
> >>>
> >>> Note that
> >>>
> >>> C:\Rpkgs>Rcmd check mypkg
> >>>
> >>> unlike install, still works in either lower or upper case in 2.4.0 alpha.
> >> This is a documented change--see the CHANGES file.
> >>
> >> Duncan Murdoch
> >>
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From murdoch at stats.uwo.ca  Sun Oct  1 19:31:54 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 01 Oct 2006 13:31:54 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>	<451F97CB.8020000@stats.uwo.ca>	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>	<451FB64B.5000400@statistik.uni-dortmund.de>	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>	<17695.62877.892232.309341@basebud.nulle.part>
	<971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>
Message-ID: <451FFB8A.9020705@stats.uwo.ca>

On 10/1/2006 1:10 PM, Gabor Grothendieck wrote:
> On 10/1/06, Dirk Eddelbuettel <edd at debian.org> wrote:
>> On 1 October 2006 at 08:53, Gabor Grothendieck wrote:
>> | On 10/1/06, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
>> | > Gabor Grothendieck wrote:
>> | > > This would seem to violate the user interface stereotype that
>> | > > command lines are case insensitive on Windows.
>> | >
>> | > This is an improvement. R tries to be as unique as possible on all
>> | > platforms.
>> |
>> | Not sure what the above means but if you mean it works the same
>> | on all platforms that is an error in the design of the software in my view.
>> | The objective should be that it fits into the environment its working in.
>> |
>> | Any Windows user can tell the difference between "clunky" UNIX-derived
>> | software which does not feel right on the Windows platform and
>> | software that adapts its interface to work like all other Windows programs
>> | in that environment.
>>
>> Generally speaking, I think many of us would beg to differ and much rather
>> (continue to) see consistency of R across platforms.
>>
>> Personally speaking, I would think that taking what I consider to be a clunky
>> OS and UI to be the gold standard as somewhat questionable. But that may just
>> be me.
>>
>> Cheers, Dirk
>>
>> --
>> Hell, there are no rules here - we're trying to accomplish something.
>>                                                  -- Thomas A. Edison
>>
> 
> I don't want to get into a debate on the merits of an OS but in terms of
> user interface principles one wants to fit into the environment that the
> software is working in rather than have the user familiarize themselves
> with multiple styles of interaction.

This is why Rgui tries to follow Windows conventions (not entirely 
successfully, and about 10 years behind the times, but anyway...). 
However, the command line utilities are used in the build process for 
packages and for R itself, and so it makes maintenance a lot easier for 
those to follow consistent cross-platform conventions.

Requiring Perl script names to be specified in a case-sensitive way 
doesn't affect the R build process, but it does mean that a script 
written on Windows is slightly more likely to work when someone runs it
on another platform.  There's an "install" command in at least some 
flavours of Unix that would be invoked instead of R's INSTALL script if 
you said "R CMD install" on one of those platforms, and that's not a 
good thing.

So what I'd suggest you do if you find typing INSTALL to be painful is 
to install an alias or command script that wraps it up in a way that 
feels more comfortable to you.

Duncan Murdoch


> If you are running UNIX and Windows you can expect differences when
> you move from one to the other but you do not expect differences when
> running one program vs. another in the same OS.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From ggrothendieck at gmail.com  Sun Oct  1 20:07:07 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 1 Oct 2006 14:07:07 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <451FFB8A.9020705@stats.uwo.ca>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FB64B.5000400@statistik.uni-dortmund.de>
	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>
	<17695.62877.892232.309341@basebud.nulle.part>
	<971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>
	<451FFB8A.9020705@stats.uwo.ca>
Message-ID: <971536df0610011107q261cac2bp57f4cfae10f329d9@mail.gmail.com>

On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>
> So what I'd suggest you do if you find typing INSTALL to be painful is
> to install an alias or command script that wraps it up in a way that
> feels more comfortable to you.

It would be possible to do some processing in Rcmd.bat in batchfiles
but I am somewhat loathe to do that since it would result in a potential
difference between Rcmd.bat in batchfiles and Rcmd delivered with R
and right now its entirely consistent -- it just passes the command line
right through.



From h.wickham at gmail.com  Sun Oct  1 22:30:16 2006
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 1 Oct 2006 15:30:16 -0500
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <451FFB8A.9020705@stats.uwo.ca>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FB64B.5000400@statistik.uni-dortmund.de>
	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>
	<17695.62877.892232.309341@basebud.nulle.part>
	<971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>
	<451FFB8A.9020705@stats.uwo.ca>
Message-ID: <f8e6ff050610011330i528d59b0o5525e71df42bd118@mail.gmail.com>

> Requiring Perl script names to be specified in a case-sensitive way
> doesn't affect the R build process, but it does mean that a script
> written on Windows is slightly more likely to work when someone runs it
> on another platform.  There's an "install" command in at least some
> flavours of Unix that would be invoked instead of R's INSTALL script if
> you said "R CMD install" on one of those platforms, and that's not a
> good thing.

Will this be changing on OS X too?  My version of 2006-09-20 r39433
accepts either upper or lower case commands.

Hadley



From murdoch at stats.uwo.ca  Mon Oct  2 02:32:08 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 01 Oct 2006 20:32:08 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <f8e6ff050610011330i528d59b0o5525e71df42bd118@mail.gmail.com>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>	<451F97CB.8020000@stats.uwo.ca>	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>	<451FB64B.5000400@statistik.uni-dortmund.de>	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>	<17695.62877.892232.309341@basebud.nulle.part>	<971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>	<451FFB8A.9020705@stats.uwo.ca>
	<f8e6ff050610011330i528d59b0o5525e71df42bd118@mail.gmail.com>
Message-ID: <45205E08.9070706@stats.uwo.ca>

On 10/1/2006 4:30 PM, hadley wickham wrote:
>> Requiring Perl script names to be specified in a case-sensitive way
>> doesn't affect the R build process, but it does mean that a script
>> written on Windows is slightly more likely to work when someone runs it
>> on another platform.  There's an "install" command in at least some
>> flavours of Unix that would be invoked instead of R's INSTALL script if
>> you said "R CMD install" on one of those platforms, and that's not a
>> good thing.
> 
> Will this be changing on OS X too?  My version of 2006-09-20 r39433
> accepts either upper or lower case commands.

I think OS X uses the same scripts as other Unix platforms.  So if 
they're happy working on a case-insensitive file system, it's unlikely 
we'll force a change, whether it would be a good idea or not.

In fact, I'm fairly ambivalent about this one:  I'm a long-time believer 
in case-insensitivity.  I'd prefer if R were case-insensitive in all 
respects.  However, it's not, so consistency pulls me to case-sensitivity.

Duncan Murdoch



From ggrothendieck at gmail.com  Mon Oct  2 02:57:27 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 1 Oct 2006 20:57:27 -0400
Subject: [Rd] Rcmd install mypkg
In-Reply-To: <45205E08.9070706@stats.uwo.ca>
References: <971536df0609301954l52105948hefed30aed57fb74a@mail.gmail.com>
	<451F97CB.8020000@stats.uwo.ca>
	<971536df0610010420g4b5d8974p263c68c9a7bef398@mail.gmail.com>
	<451FB64B.5000400@statistik.uni-dortmund.de>
	<971536df0610010553o185ef20clc920499e7fcda389@mail.gmail.com>
	<17695.62877.892232.309341@basebud.nulle.part>
	<971536df0610011010o599e62e7g78c5db47d09cbf8@mail.gmail.com>
	<451FFB8A.9020705@stats.uwo.ca>
	<f8e6ff050610011330i528d59b0o5525e71df42bd118@mail.gmail.com>
	<45205E08.9070706@stats.uwo.ca>
Message-ID: <971536df0610011757m3f455237n7a49c4550ee515a2@mail.gmail.com>

I think the really annoying thing is that it was changed for the worse.
Why not just keep it how it was before?

On 10/1/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/1/2006 4:30 PM, hadley wickham wrote:
> >> Requiring Perl script names to be specified in a case-sensitive way
> >> doesn't affect the R build process, but it does mean that a script
> >> written on Windows is slightly more likely to work when someone runs it
> >> on another platform.  There's an "install" command in at least some
> >> flavours of Unix that would be invoked instead of R's INSTALL script if
> >> you said "R CMD install" on one of those platforms, and that's not a
> >> good thing.
> >
> > Will this be changing on OS X too?  My version of 2006-09-20 r39433
> > accepts either upper or lower case commands.
>
> I think OS X uses the same scripts as other Unix platforms.  So if
> they're happy working on a case-insensitive file system, it's unlikely
> we'll force a change, whether it would be a good idea or not.
>
> In fact, I'm fairly ambivalent about this one:  I'm a long-time believer
> in case-insensitivity.  I'd prefer if R were case-insensitive in all
> respects.  However, it's not, so consistency pulls me to case-sensitivity.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From yurchikb at yahoo.com  Mon Oct  2 04:45:00 2006
From: yurchikb at yahoo.com (yurchikb at yahoo.com)
Date: Mon,  2 Oct 2006 04:45:00 +0200 (CEST)
Subject: [Rd] pdf() and postscript() fails (PR#9268)
Message-ID: <20061002024500.A252E49FDB@slim.kubism.ku.dk>

Full_Name: yury bakshi
Version: R-2.3.1
OS: XP, cygwin
Submission from: (NULL) (24.187.26.0)



> pdf()
Error in pdf() : failed to load default encoding
In addition: Warning message:
failed to load encoding file 'WinAnsi.enc'
>
> postscript()
Error in postscript() : failed to load encoding
In addition: Warning message:
failed to load encoding file 'WinAnsi.enc'
>



From r.hankin at noc.soton.ac.uk  Mon Oct  2 09:51:39 2006
From: r.hankin at noc.soton.ac.uk (r.hankin at noc.soton.ac.uk)
Date: Mon,  2 Oct 2006 09:51:39 +0200 (CEST)
Subject: [Rd] Trig.Rd typo (PR#9269)
Message-ID: <20061002075139.82D3B4BEB1@slim.kubism.ku.dk>

Full_Name: Robin Hankin
Version: 2.4.0 RC
OS: MacOSX 10.4.7
Submission from: (NULL) (139.166.242.29)


The first cut line described in Trig.Rd for asin() is incorrect in the ascii
version of the manpage.

The Rd file reads:

 For \code{asin()} and \code{acos()}, there are two cuts, both along
   the real axis: \eqn{\left(-\infty, -1\right]}{\(-Inf, 1\]} and
 
Note the inconsistency between the ascii and latex equations.
It should read:

 For \code{asin()} and \code{acos()}, there are two cuts, both along
   the real axis: \eqn{\left(-\infty, -1\right]}{\(-Inf, -1\]} and


where the final "1" has been changed to a "-1".  Ref:  AMS-55, page 79,
figure 4.4.


It's very difficult to catch this kind of error: thanks to Kjetil Halvorson for
his sharp-eyed comment.



From ligges at statistik.uni-dortmund.de  Mon Oct  2 09:57:11 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon, 02 Oct 2006 09:57:11 +0200
Subject: [Rd] pdf() and postscript() fails (PR#9268)
In-Reply-To: <20061002024500.A252E49FDB@slim.kubism.ku.dk>
References: <20061002024500.A252E49FDB@slim.kubism.ku.dk>
Message-ID: <4520C657.1050602@statistik.uni-dortmund.de>



yurchikb at yahoo.com wrote:
> Full_Name: yury bakshi
> Version: R-2.3.1
> OS: XP, cygwin

Is this a self compiled version? The cygwin platform is not supported.


> Submission from: (NULL) (24.187.26.0)
> 
> 
> 
>> pdf()

Works for me.


> Error in pdf() : failed to load default encoding
> In addition: Warning message:
> failed to load encoding file 'WinAnsi.enc'

Have you removed some files from your installation?

Uwe Ligges



>> postscript()
> Error in postscript() : failed to load encoding
> In addition: Warning message:
> failed to load encoding file 'WinAnsi.enc'
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From maechler at stat.math.ethz.ch  Mon Oct  2 11:08:36 2006
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Mon,  2 Oct 2006 11:08:36 +0200 (CEST)
Subject: [Rd] Trig.Rd typo (PR#9269)
Message-ID: <20061002090836.8AAC94BE9B@slim.kubism.ku.dk>

Thank you, Robin (and Kjetil),
for spotting and reporting this so precisely.

This is a (somewhat rare) example of a bug that is trivial
enough to fix so the fix even made it into the  "deep frozen" 
release candidate (R 2.4.0, to be released tomorrow).

Martin Maechler, ETH Zurich

>>>>> "Robin" == r hankin <r.hankin at noc.soton.ac.uk>
>>>>>     on Mon,  2 Oct 2006 09:51:39 +0200 (CEST) writes:

    Robin> Full_Name: Robin Hankin Version: 2.4.0 RC OS: MacOSX
    Robin> 10.4.7 Submission from: (NULL) (139.166.242.29)


    Robin> The first cut line described in Trig.Rd for asin() is
    Robin> incorrect in the ascii version of the manpage.

    Robin> The Rd file reads:

    Robin>  For \code{asin()} and \code{acos()}, there are two
    Robin> cuts, both along the real axis: \eqn{\left(-\infty,
    Robin> -1\right]}{\(-Inf, 1\]} and
 
    Robin> Note the inconsistency between the ascii and latex
    Robin> equations.  It should read:

    Robin>  For \code{asin()} and \code{acos()}, there are two
    Robin> cuts, both along the real axis: \eqn{\left(-\infty,
    Robin> -1\right]}{\(-Inf, -1\]} and


    Robin> where the final "1" has been changed to a "-1".  Ref:
    Robin> AMS-55, page 79, figure 4.4.


    Robin> It's very difficult to catch this kind of error:
    Robin> thanks to Kjetil Halvorson for his sharp-eyed
    Robin> comment.

    Robin> ______________________________________________
    Robin> R-devel at r-project.org mailing list
    Robin> https://stat.ethz.ch/mailman/listinfo/r-devel



From sgiannerini at gmail.com  Mon Oct  2 13:37:07 2006
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Mon, 2 Oct 2006 13:37:07 +0200
Subject: [Rd] CCF and ACF
Message-ID: <3c12769c0610020437m408fba35q438ffdd147212f49@mail.gmail.com>

Dear all,

 given two numeric vectors x and y, the ACF(x) at lag k is
cor(x(t),x(t+k)) while the CCF(x,y) at lag k is cor(x(t),y(t-k)). See
below for a simple example.

 > set.seed(1)
 > x <- rnorm(10)
 > y <- rnorm(10)
> x
 [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684
 0.4874291  0.7383247  0.5757814 -0.3053884
> y
 [1]  1.51178117  0.38984324 -0.62124058 -2.21469989  1.12493092
-0.04493361 -0.01619026  0.94383621  0.82122120  0.59390132
> x <- x - mean(x);
> y <- y -mean(y);

   ## ACF OF x(t)
> print(acf(x,lag=2,plot=F),digits=5))

 Autocorrelations of series 'x', by lag

        0        1        2
 1.00000 -0.26486 -0.25352

  ## For Instance ACF(x) at lag 1 is Corr(x(t),x(t+1)):

  > sum(x[1:9]*x[2:10])/sum(x^2)
[1] -0.2648633

  ## whereas CCF(x,y) at lag 1 is Corr(x(t),y(t-1))
 > ccf(x,y,lag=2,plot=F)

Autocorrelations of series 'X', by lag

    -2     -1      0      1      2
   -0.139  0.593 -0.377 -0.382  0.116

 > sum(x[1:9]*y[2:10])/sqrt(sum(x^2)*sum(y^2))

[1] 0.5930216

> sum(x[2:10]*y[1:9])/sqrt(sum(x^2)*sum(y^2))
 [1] -0.3822885

from a quick survey on textbooks (Brockwell and Davis, Chatfield,
Fuller) it looks like different authors use different conventions so
that I think that it would be nice to clarify this in the
documentation.

Ciao

Simone

> R.version
               _
platform       i386-pc-mingw32
arch           i386
os             mingw32
system         i386, mingw32
status         beta
major          2
minor          4.0
year           2006
month          09
day            20
svn rev        39421
language       R
version.string R version 2.4.0 beta (2006-09-20 r39421)

> Sys.getlocale()
[1] "LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
States.1252;LC_MONETARY=English_United
States.1252;LC_NUMERIC=C;LC_TIME=English_United  States.1252"


______________________________________________________

Simone Giannerini
 Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
 Tel: +39 051 2098262  Fax: +39 051 232153



From ggrothendieck at gmail.com  Mon Oct  2 14:30:51 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 2 Oct 2006 08:30:51 -0400
Subject: [Rd] CCF and ACF
In-Reply-To: <3c12769c0610020437m408fba35q438ffdd147212f49@mail.gmail.com>
References: <3c12769c0610020437m408fba35q438ffdd147212f49@mail.gmail.com>
Message-ID: <971536df0610020530p7bcdc724g140d57e25fda12e9@mail.gmail.com>

Using "ts" objects these can be written in the following consistent
manner:

> sum(ts(x) * lag(ts(x)) / sum(ts(x)^2))
[1] -0.2648633

> sum(ts(x) * lag(ts(y)) / sqrt(sum(ts(y)^2) * sum(ts(x)^2)))
[1] 0.5930216

On 10/2/06, Simone Giannerini <sgiannerini at gmail.com> wrote:
> Dear all,
>
>  given two numeric vectors x and y, the ACF(x) at lag k is
> cor(x(t),x(t+k)) while the CCF(x,y) at lag k is cor(x(t),y(t-k)). See
> below for a simple example.
>
>  > set.seed(1)
>  > x <- rnorm(10)
>  > y <- rnorm(10)
> > x
>  [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684
>  0.4874291  0.7383247  0.5757814 -0.3053884
> > y
>  [1]  1.51178117  0.38984324 -0.62124058 -2.21469989  1.12493092
> -0.04493361 -0.01619026  0.94383621  0.82122120  0.59390132
> > x <- x - mean(x);
> > y <- y -mean(y);
>
>   ## ACF OF x(t)
> > print(acf(x,lag=2,plot=F),digits=5))
>
>  Autocorrelations of series 'x', by lag
>
>        0        1        2
>  1.00000 -0.26486 -0.25352
>
>  ## For Instance ACF(x) at lag 1 is Corr(x(t),x(t+1)):
>
>  > sum(x[1:9]*x[2:10])/sum(x^2)
> [1] -0.2648633
>
>  ## whereas CCF(x,y) at lag 1 is Corr(x(t),y(t-1))
>  > ccf(x,y,lag=2,plot=F)
>
> Autocorrelations of series 'X', by lag
>
>    -2     -1      0      1      2
>   -0.139  0.593 -0.377 -0.382  0.116
>
>  > sum(x[1:9]*y[2:10])/sqrt(sum(x^2)*sum(y^2))
>
> [1] 0.5930216
>
> > sum(x[2:10]*y[1:9])/sqrt(sum(x^2)*sum(y^2))
>  [1] -0.3822885
>
> from a quick survey on textbooks (Brockwell and Davis, Chatfield,
> Fuller) it looks like different authors use different conventions so
> that I think that it would be nice to clarify this in the
> documentation.
>
> Ciao
>
> Simone
>
> > R.version
>               _
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status         beta
> major          2
> minor          4.0
> year           2006
> month          09
> day            20
> svn rev        39421
> language       R
> version.string R version 2.4.0 beta (2006-09-20 r39421)
>
> > Sys.getlocale()
> [1] "LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United  States.1252"
>
>
> ______________________________________________________
>
> Simone Giannerini
>  Dipartimento di Scienze Statistiche "Paolo Fortunati"
> Universita' di Bologna
> Via delle belle arti 41 - 40126  Bologna,  ITALY
>  Tel: +39 051 2098262  Fax: +39 051 232153
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From jfox at mcmaster.ca  Mon Oct  2 15:10:57 2006
From: jfox at mcmaster.ca (John Fox)
Date: Mon, 2 Oct 2006 09:10:57 -0400
Subject: [Rd] [R] RODBC ERROR on Rcmdr install
In-Reply-To: <200609301740.28744.vdemart1@tin.it>
Message-ID: <20061002131057.RKXE13653.tomts36-srv.bellnexxia.net@JohnDesktop8300>

Dear Vittorio,

Thanks for the clarification. This raises two questions: (1) If a *nix
system has an ODBC driver, can one then read Excel, Access, and dBase data
sets via RODBC (which is what the Rcmdr menu item in question provides for)?
(2) If so, is there a way for me to detect whether unixODBC is present, or
would I have to rely, e.g., on a user-set option?

I'm moving this message to the r-devel list.

Regards,
 John

--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario
Canada L8S 4M4
905-525-9140x23604
http://socserv.mcmaster.ca/jfox 
-------------------------------- 

> -----Original Message-----
> From: r-help-bounces at stat.math.ethz.ch 
> [mailto:r-help-bounces at stat.math.ethz.ch] On Behalf Of vittorio
> Sent: Saturday, September 30, 2006 12:40 PM
> To: r-help at stat.math.ethz.ch
> Subject: Re: [R] RODBC ERROR on Rcmdr install
> 
> Alle 22:55, venerd? 29 settembre 2006, John Fox ha scritto:
> > As I understand it, RODBC isn't useful on non-Windows 
> systems, since 
> > the necessary ODBC drivers aren't available. (Someone will 
> correct me, 
> > I'm sure, if I don't have that entirely straight.) The 
> RODBC package 
> > is used in the Rcmdr to read Excel and some other files 
> under Windows; 
> > in the latest version of the Rcmdr, you won't even see this 
> menu item 
> > in non-Windows systems.
> 
> As a matter of fact RODBC can be profitably used under *nix 
> OS together with unixODBC to connect to many DBs.
> I've been using RODBC with unixODBC on linux, freebsd and win 
> xp  to connect smoothly to postgresql, mysql  and oracle 
> (somewhat tricky to me under *nix, you need ** to buy ** a 
> driver) and I know that connections are possible to many 
> other *nix DBs under *nix itself. 
> 
> Ciao
> Vittorio
> 
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



From spencer.graves at pdf.com  Mon Oct  2 15:59:08 2006
From: spencer.graves at pdf.com (Spencer Graves)
Date: Mon, 02 Oct 2006 07:59:08 -0600
Subject: [Rd] Fwd: Selfstarting models for soil hydrology using R
In-Reply-To: <20060925123549.13294.qmail@web38712.mail.mud.yahoo.com>
References: <20060925123549.13294.qmail@web38712.mail.mud.yahoo.com>
Message-ID: <45211B2C.4030604@pdf.com>

      The traditional way to handle something like this is to develop 
your own package for R, possibly even consisting of this one example 
with your documentation using the standard R documentation protocol.  
Instructions for how to do this are contained in the "Writing R 
Extensions" manual, which is the upper right option from help.start(). 

      An alternative would be to add that to the R Wiki. 

      Hope this helps. 
      Spencer Graves

CHRISTIAN OMUTO wrote:
>> Dear,
>> I have developed and tested some models in soil
>> hydrology with NLME library in R. I want to ask
>> if it could be possible to submit this to the NLME
>> library (with sample data) as a toolbox or something
>> so
>> that anyone downloading new components of new
>> versions
>> of R may simply call (say
>> SSbrookscorey function to predict water retention in
>> the same way someone can call SSlogis to predict
>> logistic function in the current version)? I would
>> be
>> grateful for your support. I can also give in-depth
>> description and capabilities for white papers
>> concerning the applications of R in soil hydrology.
>> Please advice me.
>> Dr. Christian Thine,
>> University of Nairobi, Kenya.
>>
>>
>> __________________________________________________
>> Do You Yahoo!?
>>     
>
>   
>> protection around 
>> http://mail.yahoo.com 
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From mschwartz at mn.rr.com  Mon Oct  2 18:03:09 2006
From: mschwartz at mn.rr.com (Marc Schwartz (via MN))
Date: Mon, 02 Oct 2006 11:03:09 -0500
Subject: [Rd] [R] RODBC ERROR on Rcmdr install
In-Reply-To: <20061002131057.RKXE13653.tomts36-srv.bellnexxia.net@JohnDesktop8300>
References: <20061002131057.RKXE13653.tomts36-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <1159804990.4058.41.camel@localhost.localdomain>

John et al,

First, RODBC is indeed quite useful under Linux and I use it to connect
to an Oracle 10g server running on RHEL.  Oracle provides FREE Linux
ODBC drivers that support this functionality:

http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/linuxsoft.html

That same scenario will be in place for any database provider that
offers a native Linux ODBC driver for their application. unixODBC by
itself is only half of the solution.

With respect to Excel and Access under Linux, there are several options,
none of which include ODBC, since a certain large software company in
the northwestern U.S. has no incentive to provide ODBC drivers for
competitive OSs.

For Excel, one can of course export data to ASCII files, which includes
the use of OO.org's Calc application under Linux, which in turn supports
the reading and writing of Excel format files.  In addition, there is
the 'gdata' package on CRAN which provides the read.xls() function.

For Access, about the only things that I am familiar with under Linux
are the MDB Tools package:

  http://mdbtools.sourceforge.net

and the Easysoft ODBC-ODBC bridge product:

http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html

The former is in some stage of being incorporated into OO.org's suite of
applications to enable the manipulation of Access MDB files within that
environment. More information on that is available here:

  http://dba.openoffice.org/

For dBase, the only things that I have seen besides R's 'foreign'
package are the DataDirect ODBC suite:

  http://www.componentsource.com/products/515702/18763/summary.html

and the 'dbf' converter:

  http://berg-systeme.de/dbf.html


With respect to the detection of unixODBC and the requisite client
drivers, there are multiple system and user specific files where such
information may be available. These include:

/etc/odbc.ini

/etc/odbcinst.ini

~/.odbc.ini (User specific)

These would correspond to System and User DSN's.

The use or lack thereof for any of these files, will be highly dependent
upon how the drivers were installed.

One of the other solutions that is evolving is JDBC, which is Java
based. However, I have seen mixed reports of success using that
interface, and I don't recall seeing any support for this in R as of
yet, though I may certainly be wrong.

You might want to move this thread yet again, over to the r-sig-DB list,
where you may find more robust solutions and a DB focused constituency.

HTH,

Marc Schwartz

On Mon, 2006-10-02 at 09:10 -0400, John Fox wrote:
> Dear Vittorio,
> 
> Thanks for the clarification. This raises two questions: (1) If a *nix
> system has an ODBC driver, can one then read Excel, Access, and dBase data
> sets via RODBC (which is what the Rcmdr menu item in question provides for)?
> (2) If so, is there a way for me to detect whether unixODBC is present, or
> would I have to rely, e.g., on a user-set option?
> 
> I'm moving this message to the r-devel list.
> 
> Regards,
>  John
> > -----Original Message-----
> > From: r-help-bounces at stat.math.ethz.ch 
> > [mailto:r-help-bounces at stat.math.ethz.ch] On Behalf Of vittorio
> > Sent: Saturday, September 30, 2006 12:40 PM
> > To: r-help at stat.math.ethz.ch
> > Subject: Re: [R] RODBC ERROR on Rcmdr install
> > 
> > Alle 22:55, venerd? 29 settembre 2006, John Fox ha scritto:
> > > As I understand it, RODBC isn't useful on non-Windows 
> > systems, since 
> > > the necessary ODBC drivers aren't available. (Someone will 
> > correct me, 
> > > I'm sure, if I don't have that entirely straight.) The 
> > RODBC package 
> > > is used in the Rcmdr to read Excel and some other files 
> > under Windows; 
> > > in the latest version of the Rcmdr, you won't even see this 
> > menu item 
> > > in non-Windows systems.
> > 
> > As a matter of fact RODBC can be profitably used under *nix 
> > OS together with unixODBC to connect to many DBs.
> > I've been using RODBC with unixODBC on linux, freebsd and win 
> > xp  to connect smoothly to postgresql, mysql  and oracle 
> > (somewhat tricky to me under *nix, you need ** to buy ** a 
> > driver) and I know that connections are possible to many 
> > other *nix DBs under *nix itself. 
> > 
> > Ciao
> > Vittorio
> >



From jbrzusto at fastmail.fm  Mon Oct  2 20:09:33 2006
From: jbrzusto at fastmail.fm (jbrzusto at fastmail.fm)
Date: Mon,  2 Oct 2006 20:09:33 +0200 (CEST)
Subject: [Rd] 2.3.1: interacting bugs in load() and gzfile() (PR#9271)
Message-ID: <20061002180933.AABB04BEA0@slim.kubism.ku.dk>


Hello,

If repeated calls are made to save() using the same pre-opened gzfile
connection to a file, and then the connection is closed, the objects
saved by the second and subsequent calls are not correctly restored by
repeated calls to load() with a new gzfile connection to the same file.

What follows are a session exposing the bugs, analysis (see ANALYSIS),
patches (see PATCHES), and a session showing correct behaviour after
patching (see FIXED).  The problematic code is still present in the
trunk of the svn repository.

This is really due to two minor bugs, but because they interact,
I'm submitting this as one report.

Regards,

John Brzustowski

================================================================================
THE BUGS (with comments inserted)

> sessionInfo()
Version 2.3.1 (2006-06-01) 
i686-pc-linux-gnu 

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[7] "base" 

## create two objects and save them to a gzfile:

> x <- 1:10
> y <- x^2
> f <- gzfile("tmp.dat", "wb")
> save(x, file=f)

## notice where the second object will be written:

> seek(f, NA)
[1] 88
> save(y, file=f)
> close(f)

## open the file and try to load the two objects, one at a time

> f <- gzfile("tmp.dat", "rb")
> e <- new.env()
> load(f,e)
> ls(e)
[1] "x"

## x was loaded correctly, but the connection has been closed:

> f
     description            class             mode             text 
"gzcon(tmp.dat)"          "gzcon"             "rb"         "binary" 
          opened         can read        can write 
        "closed"          "yes"               "no" 

## <interaction> (see ANALYSIS)
## Try again:

> load(f,e)
Warning message:
this is already a gzcon connection in: gzcon(con, level, allowNonCompressed) 
> ls(e)
[1] "x"

## why the warning?
## and why was nothing apparently read this time?

> f
     description            class             mode             text 
"gzcon(tmp.dat)"          "gzcon"             "rb"         "binary" 
          opened         can read        can write 
        "opened"            "yes"             "no" 

> load(f,e)
Warning message:
this is already a gzcon connection in: gzcon(con, level, allowNonCompressed) 
> ls(e)
[1] "x" "y"

## this time, y was read correctly, but again why the warning?

> f
     description            class             mode             text 
"gzcon(tmp.dat)"          "gzcon"             "rb"         "binary" 
          opened         can read        can write 
        "closed"            "yes"             "no" 

## </interaction>

## try again, but first seek on the connection to the location of the second object

> close(f)
> f <- gzfile("tmp.dat", "rb")
> e <- new.env()
> seek(f,88)
[1] 0
> load(f,e)
> ls(e)
[1] "x"

## this should have loaded the object "y", which according to the earlier call to seek()
## begins at file offset 88.

========================================================================================
ANALYSIS

There are two minor bugs here:

1.  The internal function loadFromConnection() incorrectly closes a
    connection that was already open when it was called, instead of
    closing a connection that was *not* already open.

2.  gzfile() sets a class of its return value to "file", rather than
    "gzfile":

> f <- gzfile("whatever.gz", "wb")
> class(f)
[1] "file"      "connection"

    In contrast, bzfile() exhibits correct behaviour:

> f2<-bzfile("more.bz2", "wb")
> class(f2)
[1] "bzfile"     "connection"

This prevents load() from noticing that the connection passed to it is already
a gzfile, since it tests for inheritance from class "gzfile".  Therefore,
load() always re-opens the gzfile connection with gzcon(), which causes
reading to proceed from the beginning of the file, regardless of any seek() on 
the original gzfile connection.  This reopening of a gzfile with gzcon() causes
the warning, and prevents the seek() before the load() from having any effect.

Interaction: because (with bug 2) load() always reopens a gzfile
connection, bug 1's effect is to not close that reopened connection.
Ironically, this allows (with warnings) objects from multiple calls to save() to be
restored by multiple calls to load(), as demonstrated by the
<interaction></interaction> section in the session above, provided load() is being
called with a filename or closed connection rather than an open gzfile
connection.

================================================================================
PATCHES:

for bug 1:

diff -u R-2.3.1.original/src/main/saveload.c R-2.3.1/src/main/saveload.c
--- R-2.3.1.original/src/main/saveload.c	2006-04-09 18:19:51.000000000 -0400
+++ R-2.3.1/src/main/saveload.c	2006-10-02 13:10:21.000000000 -0400
@@ -2301,6 +2301,7 @@
 	PROTECT(res = RestoreToEnv(R_Unserialize(&in), aenv));
 	if (wasopen) {
 	    endcontext(&cntxt);
+        } else {
 	    con->close(con);
 	}
 	UNPROTECT(1);

for bug 2:

diff -u  R-2.3.1.original/src/main/connections.c R-2.3.1/src/main/connections.c
--- R-2.3.1.original/src/main/connections.c	2006-05-18 05:13:54.000000000 -0400
+++ R-2.3.1/src/main/connections.c	2006-10-02 11:53:10.000000000 -0400
@@ -1172,7 +1172,7 @@
     PROTECT(ans = allocVector(INTSXP, 1));
     INTEGER(ans)[0] = ncon;
     PROTECT(class = allocVector(STRSXP, 2));
-    SET_STRING_ELT(class, 0, mkChar("file"));
+    SET_STRING_ELT(class, 0, mkChar("gzfile"));
     SET_STRING_ELT(class, 1, mkChar("connection"));
     classgets(ans, class);
     UNPROTECT(2);

================================================================================
FIXED:

Here's how the patched version operates:

## create two objects and serialize them to a gzfile
> x <- 1:10
> y <- x^2
> f <- gzfile("tmp.dat", "wb")
> save(x, file=f)
> seek(f, NA)
[1] 88
> save(y, file=f)
> close(f)

## re-open the gzfile
> f <- gzfile("tmp.dat", "rb")

## seek to the second object and load it
> seek(f,88)
[1] 0
> e <- new.env()
> load(f,e)
> ls(e)
[1] "y"
> eval(quote(y), e)
 [1]   1   4   9  16  25  36  49  64  81 100

## seek to the first object and load it

> seek(f,0)
[1] 216
> load(f,e)
> ls(e)
[1] "x" "y"
> eval(quote(x), e)
 [1]  1  2  3  4  5  6  7  8  9 10
>



From jmc at r-project.org  Mon Oct  2 20:52:37 2006
From: jmc at r-project.org (John Chambers)
Date: Mon, 02 Oct 2006 14:52:37 -0400
Subject: [Rd] Help for methods
In-Reply-To: <451E68EE.8080201@stats.uwo.ca>
References: <f8e6ff050609180824y1ca82a2cm3c3520ade980f7e8@mail.gmail.com>
	<450FE1A3.8030808@cimr.cam.ac.uk>
	<f8e6ff050609190552v34d29e95m4c62b9f8c7f3841e@mail.gmail.com>
	<450FEB14.1080409@stats.uwo.ca>
	<f8e6ff050609190616h26cf45em427f3ecb8a30ca28@mail.gmail.com>
	<450FF864.20803@stats.uwo.ca>
	<f8e6ff050609292217t2e038583pa7a70ef490a66e54@mail.gmail.com>
	<451E68EE.8080201@stats.uwo.ca>
Message-ID: <45215FF5.3000405@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061002/8199e005/attachment-0003.pl 

From ross at biostat.ucsf.edu  Mon Oct  2 21:15:58 2006
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Mon, 02 Oct 2006 19:15:58 +0000
Subject: [Rd] documenation duplication and proposed automatic tools
Message-ID: <1159816558.7161.348.camel@iron.psg.net>

I've been looking at documenting S4 classes and methods, though I have a
feeling many of these issues apply to S3 as well.

My impression is that the documentation system requires or recommends
creating basically the same information in several places.  I'd like to
explain that, see if I'm correct, and suggest that a more automated
framework might make life easier.

PROBLEM

Consider a class A and a method foo that operates on A.  As I understand
it, I must document the generic function foo (or ?foo will not produce a
response) and the method foo (or methods ? foo will not produce a
response).  Additionally, it appears to be recommended that I document
foo in the Methods section of the documentation for class A.  Finally, I
may want to document the method foo with specific arguments
(particularly if if uses "unusual" arguments, but presumably also if the
semantics are different in a class that extends A).

This seems like a lot of work to me, and it also seems error prone  and
subject to synchronization errors.  R CMD check checks vanilla function
documentation for agreement with the code, but I'm not sure that method
documentation in other contexts gets much help.

To complete the picture, suppose there is a another function, "bar",
that operates on A.  B extends A, and reimplements foo, but not bar.

I think the suggestion is that I go back and add the B-flavored method
foo to the general methods documentation for foo.  I also have a choice
whether I should mention bar in the documentation for the class B.  If I
mention it, it's easier for the reader to grasp the whole interface that
B presents.  However, I make it harder to determine which methods
implement new functionality.

SOLUTION

There are a bunch of things users of OO systems typically want to know:
1) the relations between classes
2) the methods implemented by a class (for B, just foo)
3) the interface provided by a class (for B, foo and bar)
4) the various implementations of a particular method

All of these can be discovered dynamically by the user.  The problem is
that current documentation system attempts to reproduce this dynamic
information in static pages.  prompt, promptClass and promptMethods
functions generate templates that contain much of the information (or at
least there supposed to; they seem to miss stuff for me, for example
saying there are no methods when there are methods).  This is helpful,
but has two weaknesses.  First, the class developer must enter very
similar information in multiple places (specifically, function, methods,
and class documentation).  Second, that information is likely to get
dated as the classes are modified and extended.

I think it would be better if the class developer could enter the
information once, and the documentation system assemble it dynamically
when the user asks a question.  For example, if the user asks for
documentation on a class, the resulting page would be contstructed by
pulling together the class description, appropriate method descriptions,
and links to classes the focal class extends (as well, possibly, as
classes that extend it).  Similarly, a request for methods could
assemble a page out of the snippets documenting the individual methods,
including links to the relevant classes.

I realize that implementing this is not trivial, and I'm not necessarily
advocating it as a priority.  But I wonder how it strikes people.

-- 
Ross Boylan                                      wk:  (415) 514-8146
185 Berry St #5700                               ross at biostat.ucsf.edu
Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
University of California, San Francisco
San Francisco, CA 94107-1739                     hm:  (415) 550-1062



From hpages at fhcrc.org  Mon Oct  2 21:21:31 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Mon, 02 Oct 2006 12:21:31 -0700
Subject: [Rd] More strange [[ behaviour
Message-ID: <452166BB.3040901@fhcrc.org>

Hi,

> setClass("MyList", "list")
[1] "MyList"
> a <- new("MyList")
> a
An object of class "MyList"
list()
> setMethod("[[", "MyList", function(x, i, j, ...) cat("Just testing\n"))
> a[[]]
Just testing
> a[[1]]
Just testing
> a[[a=1]]
Just testing
> a[[b=1]]
Just testing
...
> a[[v=1]]
Just testing
> a[[w=1]]
Just testing
> a[[x=1]]
Error in a[[x = 1]] : subscript out of bounds
> a[[y=1]]
Just testing
> a[[z=1]]
Just testing

Can someone explain me why the "[[x=1]]" case is treated differently?

Cheers,
H.



From murdoch at stats.uwo.ca  Mon Oct  2 21:45:23 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 02 Oct 2006 15:45:23 -0400
Subject: [Rd] More strange [[ behaviour
In-Reply-To: <452166BB.3040901@fhcrc.org>
References: <452166BB.3040901@fhcrc.org>
Message-ID: <45216C53.4040803@stats.uwo.ca>

On 10/2/2006 3:21 PM, Herve Pages wrote:
> Hi,
> 
>> setClass("MyList", "list")
> [1] "MyList"
>> a <- new("MyList")
>> a
> An object of class "MyList"
> list()
>> setMethod("[[", "MyList", function(x, i, j, ...) cat("Just testing\n"))
>> a[[]]
> Just testing
>> a[[1]]
> Just testing
>> a[[a=1]]
> Just testing
>> a[[b=1]]
> Just testing
> ...
>> a[[v=1]]
> Just testing
>> a[[w=1]]
> Just testing
>> a[[x=1]]
> Error in a[[x = 1]] : subscript out of bounds
>> a[[y=1]]
> Just testing
>> a[[z=1]]
> Just testing
> 
> Can someone explain me why the "[[x=1]]" case is treated differently?

Indexing is a function call, with arguments x, i, j, ... .  If you use 
y=1, you're setting something in the "..." part of the arg list.  If you 
say x=1, you're setting the first arg, but because a[[x=1]] is the same 
as "[["(a, x=1), it is going to evaluate it as "[["(x=1, i=a) and try to 
index 1 by a instead of a by 1.

Duncan Murdoch



From hpages at fhcrc.org  Mon Oct  2 22:21:45 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Mon, 02 Oct 2006 13:21:45 -0700
Subject: [Rd] More strange [[ behaviour
In-Reply-To: <45216C53.4040803@stats.uwo.ca>
References: <452166BB.3040901@fhcrc.org> <45216C53.4040803@stats.uwo.ca>
Message-ID: <452174D9.60408@fhcrc.org>

Duncan Murdoch wrote:
> On 10/2/2006 3:21 PM, Herve Pages wrote:
>>> a[[x=1]]
>> Error in a[[x = 1]] : subscript out of bounds
>>
>
> Indexing is a function call, with arguments x, i, j, ... .  If you use
> y=1, you're setting something in the "..." part of the arg list.  If
> you say x=1, you're setting the first arg, but because a[[x=1]] is the
> same as "[["(a, x=1), it is going to evaluate it as "[["(x=1, i=a) and
> try to index 1 by a instead of a by 1.
Hi Duncan,

Right, thanks for the explanation and sorry for not paying more
attention.

Best,
H.



From hb at stat.berkeley.edu  Tue Oct  3 00:27:51 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 2 Oct 2006 15:27:51 -0700
Subject: [Rd] documenation duplication and proposed automatic tools
In-Reply-To: <1159816558.7161.348.camel@iron.psg.net>
References: <1159816558.7161.348.camel@iron.psg.net>
Message-ID: <59d7961d0610021527j11cc65bakae9d75b6dbaef97a@mail.gmail.com>

Hi.  Far from complete, but some sketches on a solution is in the
Rdoc-to-Rd translator of the R.oo package.  I, the author, never made
this very public because it uses a very ugly parser etc for it, but
the basics is there and I use it to generate \usage{} statements and
class hierarchies automatically, import example code and so on.  I
never have worry about consistency between code and Rd usage because
they are generated automatically.

An alternative to generate dynamic help pages in HTML (or other
formats too) is provided by the R.rsp package which allows you to
write things like:

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
        "http://www.w3.org/TR/REC-html40/loose.dtd">
<%title="R Server Pages - Hello world!"%>
<html>
 <head>
  <title><%=title%></title>
 </head>
 <body>
  <h1><%=title%></h1>
  <p>
  This is an example of an RSP page.  This HTML page was generated
  from an RSP file on a <%=format(Sys.time(), "%A")%> at
  <%=format(Sys.time(), "%H:%M:%S")%>.
  </p>
 </body>
</html>

and have R to translate it to HTML code.  It even got a built-in HTTP
daemon (from Rpad) to do this automatically.  This would allow you to
generate instant help on classes and objects etc.

/Henrik

On 10/2/06, Ross Boylan <ross at biostat.ucsf.edu> wrote:
> I've been looking at documenting S4 classes and methods, though I have a
> feeling many of these issues apply to S3 as well.
>
> My impression is that the documentation system requires or recommends
> creating basically the same information in several places.  I'd like to
> explain that, see if I'm correct, and suggest that a more automated
> framework might make life easier.
>
> PROBLEM
>
> Consider a class A and a method foo that operates on A.  As I understand
> it, I must document the generic function foo (or ?foo will not produce a
> response) and the method foo (or methods ? foo will not produce a
> response).  Additionally, it appears to be recommended that I document
> foo in the Methods section of the documentation for class A.  Finally, I
> may want to document the method foo with specific arguments
> (particularly if if uses "unusual" arguments, but presumably also if the
> semantics are different in a class that extends A).
>
> This seems like a lot of work to me, and it also seems error prone  and
> subject to synchronization errors.  R CMD check checks vanilla function
> documentation for agreement with the code, but I'm not sure that method
> documentation in other contexts gets much help.
>
> To complete the picture, suppose there is a another function, "bar",
> that operates on A.  B extends A, and reimplements foo, but not bar.
>
> I think the suggestion is that I go back and add the B-flavored method
> foo to the general methods documentation for foo.  I also have a choice
> whether I should mention bar in the documentation for the class B.  If I
> mention it, it's easier for the reader to grasp the whole interface that
> B presents.  However, I make it harder to determine which methods
> implement new functionality.
>
> SOLUTION
>
> There are a bunch of things users of OO systems typically want to know:
> 1) the relations between classes
> 2) the methods implemented by a class (for B, just foo)
> 3) the interface provided by a class (for B, foo and bar)
> 4) the various implementations of a particular method
>
> All of these can be discovered dynamically by the user.  The problem is
> that current documentation system attempts to reproduce this dynamic
> information in static pages.  prompt, promptClass and promptMethods
> functions generate templates that contain much of the information (or at
> least there supposed to; they seem to miss stuff for me, for example
> saying there are no methods when there are methods).  This is helpful,
> but has two weaknesses.  First, the class developer must enter very
> similar information in multiple places (specifically, function, methods,
> and class documentation).  Second, that information is likely to get
> dated as the classes are modified and extended.
>
> I think it would be better if the class developer could enter the
> information once, and the documentation system assemble it dynamically
> when the user asks a question.  For example, if the user asks for
> documentation on a class, the resulting page would be contstructed by
> pulling together the class description, appropriate method descriptions,
> and links to classes the focal class extends (as well, possibly, as
> classes that extend it).  Similarly, a request for methods could
> assemble a page out of the snippets documenting the individual methods,
> including links to the relevant classes.
>
> I realize that implementing this is not trivial, and I'm not necessarily
> advocating it as a priority.  But I wonder how it strikes people.
>
> --
> Ross Boylan                                      wk:  (415) 514-8146
> 185 Berry St #5700                               ross at biostat.ucsf.edu
> Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
> University of California, San Francisco
> San Francisco, CA 94107-1739                     hm:  (415) 550-1062
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From dhinds at sonic.net  Tue Oct  3 01:57:12 2006
From: dhinds at sonic.net (dhinds at sonic.net)
Date: Mon, 2 Oct 2006 23:57:12 +0000 (UTC)
Subject: [Rd] Maybe a bug in warning() for condition objects?
Message-ID: <efs90n$j9n$1@sea.gmane.org>


I'm using R-2.3.1 but the code in question is the same in the
01-Oct-2006 snapshot for release 2.4.0.  I'd like to evaluate an
expression, catching errors and handling them as warnings.  My first
attempt:

  x <- tryCatch(lm(xyzzy), error=warning)

didn't work; the error is still treated as an error, not a warning.
So I thought, hmmm, the condition is still classed as an "error", how
about if I change that:

  as.warning <- function(e) warning(simpleWarning(e$message,e$call))
  x <- tryCatch(lm(xyzzy), error=as.warning)

Still no luck.  But this works:

  as.warning <- function(e) .signalSimpleWarning(e$message,e$call)
  x <- tryCatch(lm(xyzzy), error=as.warning)

I think the problem here is that warning() contains the code:

        withRestarts({
            .Internal(.signalCondition(cond, message, call))
            .Internal(.dfltStop(message, call))
        }, muffleWarning = function() NULL)

i.e., the default action is .dfltStop(), not .dfltWarn().  Is this
intentional?  It seems to make more sense to me for the default action
for conditions passed to warning() to be .dfltWarn(), but I may well
be misunderstanding something.

-- David Hinds



From sgiannerini at gmail.com  Tue Oct  3 10:15:54 2006
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Tue, 3 Oct 2006 10:15:54 +0200
Subject: [Rd] CCF and ACF
In-Reply-To: <971536df0610020530p7bcdc724g140d57e25fda12e9@mail.gmail.com>
References: <3c12769c0610020437m408fba35q438ffdd147212f49@mail.gmail.com>
	<971536df0610020530p7bcdc724g140d57e25fda12e9@mail.gmail.com>
Message-ID: <3c12769c0610030115p46c68760lf904e5cc4973c11e@mail.gmail.com>

Thank you Gabor, by the way I have checked in the Matlab GARCH
toolbox, the crosscorrelation function is reversed with respect to R,
I think it would be useful for the users to have documented the way
CCF is computed.

Simone

On 10/2/06, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> Using "ts" objects these can be written in the following consistent
> manner:
>
> > sum(ts(x) * lag(ts(x)) / sum(ts(x)^2))
> [1] -0.2648633
>
> > sum(ts(x) * lag(ts(y)) / sqrt(sum(ts(y)^2) * sum(ts(x)^2)))
> [1] 0.5930216
>
> On 10/2/06, Simone Giannerini <sgiannerini at gmail.com> wrote:
> > Dear all,
> >
> >  given two numeric vectors x and y, the ACF(x) at lag k is
> > cor(x(t),x(t+k)) while the CCF(x,y) at lag k is cor(x(t),y(t-k)). See
> > below for a simple example.
> >
> >  > set.seed(1)
> >  > x <- rnorm(10)
> >  > y <- rnorm(10)
> > > x
> >  [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 -0.8204684
> >  0.4874291  0.7383247  0.5757814 -0.3053884
> > > y
> >  [1]  1.51178117  0.38984324 -0.62124058 -2.21469989  1.12493092
> > -0.04493361 -0.01619026  0.94383621  0.82122120  0.59390132
> > > x <- x - mean(x);
> > > y <- y -mean(y);
> >
> >   ## ACF OF x(t)
> > > print(acf(x,lag=2,plot=F),digits=5))
> >
> >  Autocorrelations of series 'x', by lag
> >
> >        0        1        2
> >  1.00000 -0.26486 -0.25352
> >
> >  ## For Instance ACF(x) at lag 1 is Corr(x(t),x(t+1)):
> >
> >  > sum(x[1:9]*x[2:10])/sum(x^2)
> > [1] -0.2648633
> >
> >  ## whereas CCF(x,y) at lag 1 is Corr(x(t),y(t-1))
> >  > ccf(x,y,lag=2,plot=F)
> >
> > Autocorrelations of series 'X', by lag
> >
> >    -2     -1      0      1      2
> >   -0.139  0.593 -0.377 -0.382  0.116
> >
> >  > sum(x[1:9]*y[2:10])/sqrt(sum(x^2)*sum(y^2))
> >
> > [1] 0.5930216
> >
> > > sum(x[2:10]*y[1:9])/sqrt(sum(x^2)*sum(y^2))
> >  [1] -0.3822885
> >
> > from a quick survey on textbooks (Brockwell and Davis, Chatfield,
> > Fuller) it looks like different authors use different conventions so
> > that I think that it would be nice to clarify this in the
> > documentation.
> >
> > Ciao
> >
> > Simone
> >
> > > R.version
> >               _
> > platform       i386-pc-mingw32
> > arch           i386
> > os             mingw32
> > system         i386, mingw32
> > status         beta
> > major          2
> > minor          4.0
> > year           2006
> > month          09
> > day            20
> > svn rev        39421
> > language       R
> > version.string R version 2.4.0 beta (2006-09-20 r39421)
> >
> > > Sys.getlocale()
> > [1] "LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> > States.1252;LC_MONETARY=English_United
> > States.1252;LC_NUMERIC=C;LC_TIME=English_United  States.1252"
> >
> >
> > ______________________________________________________
> >
> > Simone Giannerini
> >  Dipartimento di Scienze Statistiche "Paolo Fortunati"
> > Universita' di Bologna
> > Via delle belle arti 41 - 40126  Bologna,  ITALY
> >  Tel: +39 051 2098262  Fax: +39 051 232153
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>


-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153



From frank.schaeffer at infocity.de  Tue Oct  3 12:26:49 2006
From: frank.schaeffer at infocity.de (frank.schaeffer at infocity.de)
Date: Tue,  3 Oct 2006 12:26:49 +0200 (CEST)
Subject: [Rd] Error in X11 (PR#9272)
Message-ID: <20061003102649.E951B4C920@slim.kubism.ku.dk>

Full_Name: Frank Sch?ffer
Version: 2.3.1
OS: Ubuntu 6.10 (Edgy Eft)
Submission from: (NULL) (86.56.0.173)


frank at darwin:~$ R

R : Copyright 2006, The R Foundation for Statistical Computing
Version 2.3.1 (2006-06-01)
ISBN 3-900051-07-0

R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
Tippen Sie 'license()' or 'licence()' f?r Details dazu.

R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.

Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
Tippen Sie 'q()', um R zu verlassen.

> plot(2,3)
Fehler in X11() : kann keine X11 Schriften finden
Bitte Fontpath ?berpr?fen.

"Translated to english"
Error in X11() : could not find any X11 fonts
Check that the Font Path is correct.

This occurs at every time and also if I type demo(graphics). This appear at both
native English language-pack or German language-pack delivered with ubuntu
6.10.

Best regards

Frank



From p.dalgaard at biostat.ku.dk  Tue Oct  3 12:35:38 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 03 Oct 2006 12:35:38 +0200
Subject: [Rd] Error in X11 (PR#9272)
In-Reply-To: <20061003102649.E951B4C920@slim.kubism.ku.dk>
References: <20061003102649.E951B4C920@slim.kubism.ku.dk>
Message-ID: <x2ejtplm9x.fsf@viggo.kubism.ku.dk>

frank.schaeffer at infocity.de writes:

> Full_Name: Frank Sch?ffer
> Version: 2.3.1
> OS: Ubuntu 6.10 (Edgy Eft)
> Submission from: (NULL) (86.56.0.173)
> 
> 
> frank at darwin:~$ R
> 
> R : Copyright 2006, The R Foundation for Statistical Computing
> Version 2.3.1 (2006-06-01)
> ISBN 3-900051-07-0
> 
> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
> Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
> 
> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
> um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.
> 
> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
> Tippen Sie 'q()', um R zu verlassen.
> 
> > plot(2,3)
> Fehler in X11() : kann keine X11 Schriften finden
> Bitte Fontpath ?berpr?fen.
> 
> "Translated to english"
> Error in X11() : could not find any X11 fonts
> Check that the Font Path is correct.
> 
> This occurs at every time and also if I type demo(graphics). This appear at both
> native English language-pack or German language-pack delivered with ubuntu
> 6.10.

The most obvious guess is that you do not have the X11 fonts
installed that R needs. That is an installation problem, not a bug in
R. 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From jeff.horner at vanderbilt.edu  Tue Oct  3 18:09:56 2006
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Tue, 03 Oct 2006 11:09:56 -0500
Subject: [Rd] Possible bug in Rcons_vprintf
In-Reply-To: <17694.33006.587070.870361@stat.math.ethz.ch>
References: <451D809B.3060906@vanderbilt.edu>
	<17694.33006.587070.870361@stat.math.ethz.ch>
Message-ID: <45228B54.2010604@vanderbilt.edu>

Martin Maechler wrote:
> Thanks, Jeffrey,
> 
> that (change) looks very logical, reasonable, ...
> and I'll commit a patch to R-devel ASAP.
> 
> On the other hand, I'm currently not intending to port the fix
> to the currently "deep frozen" R-2.4-branch [because "you never know ..."]
> unless you can argue a bit more why the change seems important 
> (or at least can demonstrate bogous behavior that is fixed by it).

Not a big deal at the moment... although I would have argued for its 
inclusion into R 2.4 if rJava, a well established package used by JGR, 
demonstrated bogus behavior... because it does depend on R_WriteConsole, 
but it turns out that rjava ignores the second argument defining the 
length of the buffer to be printed. Is this appropriate?

rJava is making an assumption that in a call to R_WriteConsole, the 
buffer is always null terminated, and this seems supported by the R 
source. The following grep output on R-2-4-branch (but probably in 
R-trunk, too) shows that each call to R_WriteConsole *does* pass 
null-terminated strings:

# some of the output has been edited
$ find . -follow -name '*.[ch]' | xargs grep -B 1 R_WriteConsole
./src/library/grDevices/src/devWindows.c-    setstatus(msg);
./src/library/grDevices/src/devWindows.c:    R_WriteConsole(msg, 
strlen(msg));
./src/library/grDevices/src/devWindows.c:    R_WriteConsole("\n", 1);
--
./src/main/printutils.c-#endif /* HAVE_VA_COPY */
./src/main/printutils.c:    R_WriteConsole(p, strlen(buf));
--
./src/main/printutils.c-        slen = strlen(buf);
./src/main/printutils.c:        R_WriteConsole(buf, slen);
--
./src/gnuwin32/sys-win32.c-             } else
./src/gnuwin32/sys-win32.c:                 R_WriteConsole(buf, 
strlen(buf));
--
./src/gnuwin32/system.c-                            buf[len] = '\0';
./src/gnuwin32/system.c:                            R_WriteConsole(buf, 
strlen(buf));
--
./src/gnuwin32/system.c-        fflush(R_Consolefile);
./src/gnuwin32/system.c:    } else R_WriteConsole(s, strlen(s));


Jeff

> 
> Martin
> 
>>>>>> "Jeffrey" == Jeffrey Horner <jeff.horner at vanderbilt.edu>
>>>>>>     on Fri, 29 Sep 2006 15:22:51 -0500 writes:
> 
>     Jeffrey> In R-2-4-branch r39548, Rcons_vprintf is called from stdout_vfprintf 
>     Jeffrey> when R_Outputfile is NULL. When called and output is greater than 
>     Jeffrey> R_BUFSIZE, output is truncated to R_BUFSIZE. Here's a one-line fix:
> 
>     Jeffrey> Index: src/main/printutils.c
>     Jeffrey> ===================================================================
>     Jeffrey> --- src/main/printutils.c       (revision 39548)
>     Jeffrey> +++ src/main/printutils.c       (working copy)
>     Jeffrey> @@ -638,7 +638,7 @@
>     Jeffrey> res = R_BUFSIZE;
>     Jeffrey> }
>     Jeffrey> #endif /* HAVE_VA_COPY */
>     Jeffrey> -    R_WriteConsole(p, strlen(buf));
>     Jeffrey> +    R_WriteConsole(p, strlen(p));
>     Jeffrey> #ifdef HAVE_VA_COPY
>     Jeffrey> if(usedRalloc) vmaxset(vmax);
>     Jeffrey> if(usedVasprintf) free(p);
> 
> 
>     Jeffrey> Jeff
>     Jeffrey> -- 
>     Jeffrey> http://biostat.mc.vanderbilt.edu/JeffreyHorner
> 


-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner



From iverson at biostat.wisc.edu  Tue Oct  3 20:22:36 2006
From: iverson at biostat.wisc.edu (Erik Iverson)
Date: Tue, 03 Oct 2006 13:22:36 -0500
Subject: [Rd] developing a package with a name space
Message-ID: <4522AA6C.5040904@biostat.wisc.edu>

Hello -

I'm currently maintaining an R package that uses a name space, and am 
also starting a new R package that will use a name space.

According the the R News June 2003 issue, "Adding a name space to a 
package may complicate debugging code ... it is a good idea not to add a 
name space to a package until it is completely debugged, and to remove 
the name space if further debugging is needed ... other alternatives are 
being explored ... ".

Is renaming/removing the NAMESPACE file still the favored approach when 
developing and debugging code for an R package?

I suppose the alternative I have in mind is something like sourcing an R 
file, and using assignInNamespace(), may be more trouble than it is worth.

I am doing this development using ESS by the way.

Thanks for any guidance!
Erik Iverson



From murdoch at stats.uwo.ca  Tue Oct  3 20:39:42 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Oct 2006 14:39:42 -0400
Subject: [Rd] developing a package with a name space
In-Reply-To: <4522AA6C.5040904@biostat.wisc.edu>
References: <4522AA6C.5040904@biostat.wisc.edu>
Message-ID: <4522AE6E.5050401@stats.uwo.ca>

On 10/3/2006 2:22 PM, Erik Iverson wrote:
> Hello -
> 
> I'm currently maintaining an R package that uses a name space, and am 
> also starting a new R package that will use a name space.
> 
> According the the R News June 2003 issue, "Adding a name space to a 
> package may complicate debugging code ... it is a good idea not to add a 
> name space to a package until it is completely debugged, and to remove 
> the name space if further debugging is needed ... other alternatives are 
> being explored ... ".
> 
> Is renaming/removing the NAMESPACE file still the favored approach when 
> developing and debugging code for an R package?
> 
> I suppose the alternative I have in mind is something like sourcing an R 
> file, and using assignInNamespace(), may be more trouble than it is worth.
> 
> I am doing this development using ESS by the way.
> 

It depends on the type of debugging you're doing.  The reason for that 
suggestion is that usually when you edit a new function, it will live in 
the global environment, rather than the namespace.  This means it won't 
see objects in the namespace, and they'll see a local copy before they 
see it.

You can make it see things there by setting its environment to be the 
namespace.  I always forget the syntax for that, so I usually do 
something like

environment(newfn) <- environment(someexportedfn)

Note that if you use fix(), the environment is automatically preserved, 
but you'll still create your new copy in the global environment.

To let other functions see it, you need to use assignInNamespace().

Duncan Murdoch



From dhinds at sonic.net  Wed Oct  4 02:32:34 2006
From: dhinds at sonic.net (dhinds at sonic.net)
Date: Wed,  4 Oct 2006 02:32:34 +0200 (CEST)
Subject: [Rd] Bug in warning() for condition objects (PR#9274)
Message-ID: <20061004003234.1973A49FDD@slim.kubism.ku.dk>

Full_Name: David Hinds
Version: 2.4.0
OS: Windows XP
Submission from: (NULL) (64.168.232.238)


A (maybe naive) use of tryCatch to trap errors and report as warnings does not
work, i.e.:

  x <- tryCatch(lm(xyzzy), error=warning)

In src/library/base/R/stop.R, the warning() function contains the following
code, for handling condition objects:

        withRestarts({
            .Internal(.signalCondition(cond, message, call))
            .Internal(.dfltStop(message, call))
        }, muffleWarning = function() NULL)

So all conditions result in calling .dfltStop().  It would seem more useful
and/or consistent for warning() to call .dfltWarn(), or in the alternative, to
choose between .dfltStop and .dfltWarn based on the class of the condition
object.



From hpages at fhcrc.org  Wed Oct  4 05:58:54 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Tue, 03 Oct 2006 20:58:54 -0700
Subject: [Rd] Display problem with named raw vectors
Message-ID: <4523317E.5030803@fhcrc.org>

Hi,


I found that displaying a raw vector with long names is not
as pretty as for other types of named vectors:

    > r <- charToRaw("Mz")
    > r
    [1] 4d 7a
    > names(r) <- c("M", "zzzzzz")
    > r
         M zzzzzz
    4d 7a

The names and the values are not aligned :-(

    > i <- as.integer(r)
    > i
    [1]  77 122
    > names(i) <- c("M", "zzzzzz")
    > i
         M zzzzzz
        77    122

Much better :-)
(Note that the names were lost during coercion... surprising
but documented.)

Cheers,
H.



From imosqueira at suk.azti.es  Wed Oct  4 12:31:41 2006
From: imosqueira at suk.azti.es (Iago Mosqueira)
Date: Wed, 04 Oct 2006 12:31:41 +0200
Subject: [Rd] Default argument value for "["
In-Reply-To: <mailman.9.1159956004.28879.r-devel@r-project.org>
References: <mailman.9.1159956004.28879.r-devel@r-project.org>
Message-ID: <1159957901.14595.24.camel@localhost.localdomain>

Dear all,

After installing R 2.4.0, a definition of "[" for an S4 class has
stopped working as the default for drop in the generic, TRUE, appears to
override the default in the method

The method is defined for demonstration purposes as

setMethod("[", signature(x="FLQuant"),
	function(x, i="missing", j="missing", k="missing", l="missing",
		m="missing", ..., drop=FALSE) {

		print(drop)
	}
)

When called as

new('FLQuant')[1,]

drop is TRUE, instead of FALSE. Am I missing something? Has there been a
change in R 2.4.0 of relevance here? I could not find it in the NEWS
file.

Many thanks,


Iago Mosqueira



From gavin.simpson at ucl.ac.uk  Wed Oct  4 13:55:41 2006
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed, 04 Oct 2006 12:55:41 +0100
Subject: [Rd] Status of R 2.4.0 in svn repository and R-Admin manual
Message-ID: <1159962941.18729.49.camel@gsimpson.geog.ucl.ac.uk>

Dear list,

I have been using and testing the alpha/betas of R 2.4.0, sources for
which I got from svn.r-project.org/R/branches/R-2-4-branch, and which I
compiled on my Fedora Core 5 machine. No problems there. I have just
updated the source tree today and re-compiled - which also works just
fine. When run, this gives:

R version 2.4.0 Patched (2006-10-03 r39576)

So I assume from that, that I am using the latest version of the R 2.4
branch?

This is a little at odds with the R-Admin manual, which in section 1.2.1
states that you get R-patched from
https://svn.r-project.org/R/branches/R-x-y-patches/ . But there is no
R-2-4-patches/ on svn.r-project.org/R/branches/. Is the documentation in
this manual incorrect for R >= 2.4.0, and will
svn.r-project.org/R/branches/R-2-4-branch continue to be R 2.4.0
patched? Or will a R-x-y-branches branch be created for this release?

Thanks in advance,

G

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Gavin Simpson                 [t] +44 (0)20 7679 0522
 ECRC & ENSIS, UCL Geography,  [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%



From p.dalgaard at biostat.ku.dk  Wed Oct  4 15:03:57 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 04 Oct 2006 15:03:57 +0200
Subject: [Rd] Status of R 2.4.0 in svn repository and R-Admin manual
In-Reply-To: <1159962941.18729.49.camel@gsimpson.geog.ucl.ac.uk>
References: <1159962941.18729.49.camel@gsimpson.geog.ucl.ac.uk>
Message-ID: <x264f0z0zm.fsf@turmalin.kubism.ku.dk>

Gavin Simpson <gavin.simpson at ucl.ac.uk> writes:

> Dear list,
> 
> I have been using and testing the alpha/betas of R 2.4.0, sources for
> which I got from svn.r-project.org/R/branches/R-2-4-branch, and which I
> compiled on my Fedora Core 5 machine. No problems there. I have just
> updated the source tree today and re-compiled - which also works just
> fine. When run, this gives:
> 
> R version 2.4.0 Patched (2006-10-03 r39576)
> 
> So I assume from that, that I am using the latest version of the R 2.4
> branch?
> 
> This is a little at odds with the R-Admin manual, which in section 1.2.1
> states that you get R-patched from
> https://svn.r-project.org/R/branches/R-x-y-patches/ . But there is no
> R-2-4-patches/ on svn.r-project.org/R/branches/. Is the documentation in
> this manual incorrect for R >= 2.4.0, and will
> svn.r-project.org/R/branches/R-2-4-branch continue to be R 2.4.0
> patched? Or will a R-x-y-branches branch be created for this release?

This is just an oversight.

Thing is that we decided to create the branch already at
"Grand-Feature Freeze", which simplifies the release phase procedures
quite a bit and reduces the risk of last-minute surprises. It also
opens up the "trunk" for new development a bit earlier. So 2.4.x
alpha/beta/RC/<final>/Patched releases are now all cut from the same
branch. A side effect was that the branch name "x-y-patches" would be
a misnomer, so it got changed.


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From gavin.simpson at ucl.ac.uk  Wed Oct  4 15:31:52 2006
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed, 04 Oct 2006 14:31:52 +0100
Subject: [Rd] Status of R 2.4.0 in svn repository and R-Admin manual
In-Reply-To: <x264f0z0zm.fsf@turmalin.kubism.ku.dk>
References: <1159962941.18729.49.camel@gsimpson.geog.ucl.ac.uk>
	<x264f0z0zm.fsf@turmalin.kubism.ku.dk>
Message-ID: <1159968712.18729.57.camel@gsimpson.geog.ucl.ac.uk>

On Wed, 2006-10-04 at 15:03 +0200, Peter Dalgaard wrote:
> Gavin Simpson <gavin.simpson at ucl.ac.uk> writes:
> 
> > Dear list,
> > 
> > I have been using and testing the alpha/betas of R 2.4.0, sources for
> > which I got from svn.r-project.org/R/branches/R-2-4-branch, and which I
> > compiled on my Fedora Core 5 machine. No problems there. I have just
> > updated the source tree today and re-compiled - which also works just
> > fine. When run, this gives:
> > 
> > R version 2.4.0 Patched (2006-10-03 r39576)
> > 
> > So I assume from that, that I am using the latest version of the R 2.4
> > branch?
> > 
> > This is a little at odds with the R-Admin manual, which in section 1.2.1
> > states that you get R-patched from
> > https://svn.r-project.org/R/branches/R-x-y-patches/ . But there is no
> > R-2-4-patches/ on svn.r-project.org/R/branches/. Is the documentation in
> > this manual incorrect for R >= 2.4.0, and will
> > svn.r-project.org/R/branches/R-2-4-branch continue to be R 2.4.0
> > patched? Or will a R-x-y-branches branch be created for this release?
> 
> This is just an oversight.
> 
> Thing is that we decided to create the branch already at
> "Grand-Feature Freeze", which simplifies the release phase procedures
> quite a bit and reduces the risk of last-minute surprises. It also
> opens up the "trunk" for new development a bit earlier. So 2.4.x
> alpha/beta/RC/<final>/Patched releases are now all cut from the same
> branch. A side effect was that the branch name "x-y-patches" would be
> a misnomer, so it got changed.

Hi Peter,

Thanks for clearing that up for me. If this is the way things are going
to be done in future, here is a patch to the R-admin.texi sources (also
attached)

All the best,

G

## Patch to R-admin.texi - I hope I did this right, first time and all?

Index: doc/manual/R-admin.texi
===================================================================
--- doc/manual/R-admin.texi     (revision 39576)
+++ doc/manual/R-admin.texi     (working copy)
@@ -166,7 +166,7 @@
 @url{http://subversion.tigris.org/, @code{subversion.tigris.org}}), you
 can check out and update the current r-devel from
 @url{https://svn.r-project.org/R/trunk/} and the current r-patched from
- at samp{https://svn.r-project.org/R/branches/R- at var{x}- at var{y}-patches/}
+ at samp{https://svn.r-project.org/R/branches/R- at var{x}- at var{y}-branch/}
 (where @var{x} and @var{y} are the major and minor number of the current
 released version of R).  E.g., use

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Gavin Simpson                 [t] +44 (0)20 7679 0522
 ECRC & ENSIS, UCL Geography,  [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%

From p.dalgaard at biostat.ku.dk  Wed Oct  4 15:52:04 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 04 Oct 2006 15:52:04 +0200
Subject: [Rd] Status of R 2.4.0 in svn repository and R-Admin manual
In-Reply-To: <1159968712.18729.57.camel@gsimpson.geog.ucl.ac.uk>
References: <1159962941.18729.49.camel@gsimpson.geog.ucl.ac.uk>
	<x264f0z0zm.fsf@turmalin.kubism.ku.dk>
	<1159968712.18729.57.camel@gsimpson.geog.ucl.ac.uk>
Message-ID: <x2wt7gxk6z.fsf@turmalin.kubism.ku.dk>

Gavin Simpson <gavin.simpson at ucl.ac.uk> writes:

> On Wed, 2006-10-04 at 15:03 +0200, Peter Dalgaard wrote:
> > Gavin Simpson <gavin.simpson at ucl.ac.uk> writes:
> > 
> > > Dear list,
> > > 
> > > I have been using and testing the alpha/betas of R 2.4.0, sources for
> > > which I got from svn.r-project.org/R/branches/R-2-4-branch, and which I
> > > compiled on my Fedora Core 5 machine. No problems there. I have just
> > > updated the source tree today and re-compiled - which also works just
> > > fine. When run, this gives:
> > > 
> > > R version 2.4.0 Patched (2006-10-03 r39576)
> > > 
> > > So I assume from that, that I am using the latest version of the R 2.4
> > > branch?
> > > 
> > > This is a little at odds with the R-Admin manual, which in section 1.2.1
> > > states that you get R-patched from
> > > https://svn.r-project.org/R/branches/R-x-y-patches/ . But there is no
> > > R-2-4-patches/ on svn.r-project.org/R/branches/. Is the documentation in
> > > this manual incorrect for R >= 2.4.0, and will
> > > svn.r-project.org/R/branches/R-2-4-branch continue to be R 2.4.0
> > > patched? Or will a R-x-y-branches branch be created for this release?
> > 
> > This is just an oversight.
> > 
> > Thing is that we decided to create the branch already at
> > "Grand-Feature Freeze", which simplifies the release phase procedures
> > quite a bit and reduces the risk of last-minute surprises. It also
> > opens up the "trunk" for new development a bit earlier. So 2.4.x
> > alpha/beta/RC/<final>/Patched releases are now all cut from the same
> > branch. A side effect was that the branch name "x-y-patches" would be
> > a misnomer, so it got changed.
> 
> Hi Peter,
> 
> Thanks for clearing that up for me. If this is the way things are going
> to be done in future, here is a patch to the R-admin.texi sources (also
> attached)
> 
> All the best,
> 
> G
> 
> ## Patch to R-admin.texi - I hope I did this right, first time and all?

Technically, it's fine, but I suspect that more needs to be changed.
I've been trying to work in a new terminology where "r-release-branch"
replaces "r-patched" (for much the same reason as renaming the branch
tag). 

I have this partly in place in 
http://developer.r-project.org/SVNtips.html
but I see that there is still a handful of places that I have missed.  

> Index: doc/manual/R-admin.texi
> ===================================================================
> --- doc/manual/R-admin.texi     (revision 39576)
> +++ doc/manual/R-admin.texi     (working copy)
> @@ -166,7 +166,7 @@
>  @url{http://subversion.tigris.org/, @code{subversion.tigris.org}}), you
>  can check out and update the current r-devel from
>  @url{https://svn.r-project.org/R/trunk/} and the current r-patched from
> - at samp{https://svn.r-project.org/R/branches/R- at var{x}- at var{y}-patches/}
> + at samp{https://svn.r-project.org/R/branches/R- at var{x}- at var{y}-branch/}
>  (where @var{x} and @var{y} are the major and minor number of the current
>  released version of R).  E.g., use
> 
> -- 
> %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
>  Gavin Simpson                 [t] +44 (0)20 7679 0522
>  ECRC & ENSIS, UCL Geography,  [f] +44 (0)20 7679 0565
>  Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
>  Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
>  UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
> %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
> 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From jmc at r-project.org  Wed Oct  4 15:52:21 2006
From: jmc at r-project.org (John Chambers)
Date: Wed, 04 Oct 2006 09:52:21 -0400
Subject: [Rd] Default argument value for "["
In-Reply-To: <1159957901.14595.24.camel@localhost.localdomain>
References: <mailman.9.1159956004.28879.r-devel@r-project.org>
	<1159957901.14595.24.camel@localhost.localdomain>
Message-ID: <4523BC95.6010505@r-project.org>

I think the problem in your case comes from the mechanism used to handle 
non-standard argument lists; notice that you have added 3 new 
arguments.  If you look at the body of the resulting method you will see 
that the mechanism used to handle this (defining a function .local) 
fails to copy the default value from the method, as in the simpler 
example below:

 > setMethod("[", c("mm"), function(x, i, j, k..., drop=FALSE)browser())
[1] "["
 > selectMethod("[", "mm")
Method Definition:

function (x, i, j, ..., drop = TRUE)
{
    .local <- function (x, i, j, k..., drop = FALSE)
    browser()
    .local(x, i, j, ..., drop = drop)
}


We can probably fix this.  Meanwhile, the workaround is to use the same 
mechanism yourself, but get the  default value right.  Define your 
method as a function (like the .local you see when printing the current 
method) and then define a method with the formally correct arguments 
(function(x, i, j, ..., drop=FALSE)) and call your function from that 
method.

Beware there is _another_ related "bug":  if you use callNextMethod(), 
it does not seem to copy the default value of drop= either.  (It's a bit 
more debatable what callNextMethod() with no arguments should do in this 
case, so the problem here may be an "undesired feature" rather than a 
bug.)  You didn't show your real method, so this may not apply in your 
example.

By the way, I would be a little surprised if this had anything to do 
with changes in 2.4.0, at least those I'm aware of.


Iago Mosqueira wrote:
> Dear all,
>
> After installing R 2.4.0, a definition of "[" for an S4 class has
> stopped working as the default for drop in the generic, TRUE, appears to
> override the default in the method
>
> The method is defined for demonstration purposes as
>
> setMethod("[", signature(x="FLQuant"),
> 	function(x, i="missing", j="missing", k="missing", l="missing",
> 		m="missing", ..., drop=FALSE) {
>
> 		print(drop)
> 	}
> )
>
> When called as
>
> new('FLQuant')[1,]
>
> drop is TRUE, instead of FALSE. Am I missing something? Has there been a
> change in R 2.4.0 of relevance here? I could not find it in the NEWS
> file.
>
> Many thanks,
>
>
> Iago Mosqueira
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From luke at stat.uiowa.edu  Wed Oct  4 16:40:01 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed, 4 Oct 2006 09:40:01 -0500 (CDT)
Subject: [Rd] Bug in warning() for condition objects (PR#9274)
In-Reply-To: <20061004003234.1973A49FDD@slim.kubism.ku.dk>
References: <20061004003234.1973A49FDD@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0610040939150.17688@nokomis.stat.uiowa.edu>

Thanks.  I think your analysis is probably correct.  Will look into
this and fix shortly.

Best,

luke

On Wed, 4 Oct 2006, dhinds at sonic.net wrote:

> Full_Name: David Hinds
> Version: 2.4.0
> OS: Windows XP
> Submission from: (NULL) (64.168.232.238)
>
>
> A (maybe naive) use of tryCatch to trap errors and report as warnings does not
> work, i.e.:
>
>  x <- tryCatch(lm(xyzzy), error=warning)
>
> In src/library/base/R/stop.R, the warning() function contains the following
> code, for handling condition objects:
>
>        withRestarts({
>            .Internal(.signalCondition(cond, message, call))
>            .Internal(.dfltStop(message, call))
>        }, muffleWarning = function() NULL)
>
> So all conditions result in calling .dfltStop().  It would seem more useful
> and/or consistent for warning() to call .dfltWarn(), or in the alternative, to
> choose between .dfltStop and .dfltWarn based on the class of the condition
> object.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From imosqueira at suk.azti.es  Wed Oct  4 17:13:54 2006
From: imosqueira at suk.azti.es (Iago Mosqueira)
Date: Wed, 04 Oct 2006 17:13:54 +0200
Subject: [Rd] Default argument value for "["
In-Reply-To: <4523BC95.6010505@r-project.org>
References: <mailman.9.1159956004.28879.r-devel@r-project.org>
	<1159957901.14595.24.camel@localhost.localdomain>
	<4523BC95.6010505@r-project.org>
Message-ID: <1159974834.14595.41.camel@localhost.localdomain>

El mi?, 04-10-2006 a las 09:52 -0400, John Chambers escribi?:
> I think the problem in your case comes from the mechanism used to handle 
> non-standard argument lists; notice that you have added 3 new 
> arguments.

Yes, our object is always 5 dimensional. We could use (...) but it
looked overly complex.

>   If you look at the body of the resulting method you will see 
> that the mechanism used to handle this (defining a function .local) 
> fails to copy the default value from the method, as in the simpler 
> example below:
> 
>  > setMethod("[", c("mm"), function(x, i, j, k..., drop=FALSE)browser())
> [1] "["
>  > selectMethod("[", "mm")
> Method Definition:
> 
> function (x, i, j, ..., drop = TRUE)
> {
>     .local <- function (x, i, j, k..., drop = FALSE)
>     browser()
>     .local(x, i, j, ..., drop = drop)
> }
> 
> 
> We can probably fix this.  Meanwhile, the workaround is to use the same 
> mechanism yourself, but get the  default value right.  Define your 
> method as a function (like the .local you see when printing the current 
> method) and then define a method with the formally correct arguments 
> (function(x, i, j, ..., drop=FALSE)) and call your function from that 
> method.

OK, many thanks.

> Beware there is _another_ related "bug":  if you use callNextMethod(), 
> it does not seem to copy the default value of drop= either.  (It's a bit 
> more debatable what callNextMethod() with no arguments should do in this 
> case, so the problem here may be an "undesired feature" rather than a 
> bug.)  You didn't show your real method, so this may not apply in your 
> example.

I am adding the whole method below, but I do not thing this applies as
it is currently written.

> By the way, I would be a little surprised if this had anything to do 
> with changes in 2.4.0, at least those I'm aware of.

This maybe the case, but it was working fine in 2.3.1.

Cheers,


Iago

setMethod("[", signature(x="FLQuant"),
	function(x, i="missing", j="missing", k="missing", l="missing",
m="missing",
		..., drop=FALSE) {

		if (missing(i))
			#i  <-  dimnames(x at .Data)[1][[1]]
			i  <-  seq(1, length(dimnames(x at .Data)[1][[1]]))
		if (missing(j))
			j  <-  dimnames(x at .Data)[2][[1]]
   		if (missing(k))
   			k  <-  dimnames(x at .Data)[3][[1]]
		if (missing(l))
			l  <-  dimnames(x at .Data)[4][[1]]
		if (missing(m))
			m  <-  dimnames(x at .Data)[5][[1]]

   		if (!drop) {
	  		flq	 <- FLQuant(x at .Data[i, j, k, l, m, drop=FALSE])
			units(flq) <- units(x)
			quant(flq) <- quant(x)
		}
		else if(drop)
             flq  <- x at .Data[i, j, k, l, m, ..., drop=TRUE]

   		return(flq)
	}
)


> Iago Mosqueira wrote:
> > Dear all,
> >
> > After installing R 2.4.0, a definition of "[" for an S4 class has
> > stopped working as the default for drop in the generic, TRUE, appears to
> > override the default in the method
> >
> > The method is defined for demonstration purposes as
> >
> > setMethod("[", signature(x="FLQuant"),
> > 	function(x, i="missing", j="missing", k="missing", l="missing",
> > 		m="missing", ..., drop=FALSE) {
> >
> > 		print(drop)
> > 	}
> > )
> >
> > When called as
> >
> > new('FLQuant')[1,]
> >
> > drop is TRUE, instead of FALSE. Am I missing something? Has there been a
> > change in R 2.4.0 of relevance here? I could not find it in the NEWS
> > file.
> >
> > Many thanks,
> >
> >
> > Iago Mosqueira
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >



From hb at stat.berkeley.edu  Wed Oct  4 20:18:29 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 4 Oct 2006 11:18:29 -0700
Subject: [Rd] exists(..., inherits) & get(..., inherits)
Message-ID: <59d7961d0610041118r6fbc145at7986e0e34d53fece@mail.gmail.com>

Hi,

are there corresponding methods to exists() and get() where one can
stratify on class, e.g.
 exists(..., inherits) instead of exists(..., mode)?

Thanks

Henrik



From andrew_duba at wustl.edu  Wed Oct  4 22:32:30 2006
From: andrew_duba at wustl.edu (andrew_duba at wustl.edu)
Date: Wed,  4 Oct 2006 22:32:30 +0200 (CEST)
Subject: [Rd] Compilation issue (PR#9275)
Message-ID: <20061004203230.415AC28FCD@slim.kubism.ku.dk>

Full_Name: Andrew J. Duba
Version: 2.4.0
OS: OS X
Submission from: (NULL) (128.252.95.46)


I am trying to compile the newest version of R.  I am using g77 version 3.4.3
and gcc 4.0.  After running gnu make (version 3.8) I get the following error:

Error in dyn.load(x, as.logical(local), as.logical(now)) :
        unable to load shared library
'/Users/aduba/sources/R-2.4.0/library/tools/libs/tools.so':
  dlopen(/Users/aduba/sources/R-2.4.0/library/tools/libs/tools.so, 6): Symbol
not found: _z_abs
  Referenced from: /Users/aduba/sources/R-2.4.0/lib/libRblas.dylib
  Expected in: flat namespace
Execution halted



From mmartin at itasoftware.com  Thu Oct  5 02:15:34 2006
From: mmartin at itasoftware.com (Martin C. Martin)
Date: Wed, 04 Oct 2006 20:15:34 -0400
Subject: [Rd] update.default evaluating in wrong environment?
Message-ID: <45244EA6.4010108@itasoftware.com>

Hi all,

update.default, which is the method used to update "lm" objects (among 
others), extracts the "call" element from it's first argument, updates 
it, then evaluates it in the parent.frame().  Shouldn't it be evaluated 
in environment(formula(object)), if that's non-NULL?

I ask because I call "lm" from within a function, and the data argument 
is a local variable of that function.  After that, I can't update the 
model any more, since the new lm() call (the one evaled in 
parent.frame()) can't find the data.

Best,
Martin



From martin at martincmartin.com  Thu Oct  5 02:16:10 2006
From: martin at martincmartin.com (Martin C. Martin)
Date: Wed, 04 Oct 2006 20:16:10 -0400
Subject: [Rd] update.default evaluating in wrong environment?
Message-ID: <45244ECA.8070705@martincmartin.com>

Hi all,

update.default, which is the method used to update "lm" objects (among
others), extracts the "call" element from it's first argument, updates
it, then evaluates it in the parent.frame().  Shouldn't it be evaluated
in environment(formula(object)), if that's non-NULL?

I ask because I call "lm" from within a function, and the data argument
is a local variable of that function.  After that, I can't update the
model any more, since the new lm() call (the one evaled in
parent.frame()) can't find the data.

Best,
Martin



From martin at martincmartin.com  Thu Oct  5 02:17:28 2006
From: martin at martincmartin.com (Martin C. Martin)
Date: Wed, 04 Oct 2006 20:17:28 -0400
Subject: [Rd] Bug in stepAIC?
Message-ID: <45244F18.2040302@martincmartin.com>

Hi,

It seems that, when I use weights during an initial least-squares 
regression fit, and later try to add terms using stepAIC(), it uses the 
weights when looking to remove terms, but not when looking to add them:

hills.lm <- lm(time ~ dist + climb, data = hills, weights = 1/dist^2)
small.hills.lm <- stepAIC(hills.lm)
stepAIC(small.hills.lm, time ~ dist + climb)

In the first stepAIC(), it says that the AIC for the full "time ~ dist + 
climb" is 94.41.  Yet, during the second stepAIC, it says adding climb 
would produce an AIC of 212.1 (and an RSS of 12633.3).  Is this a bug?

Best,
Martin



From bchristo at email.arizona.edu  Thu Oct  5 03:10:30 2006
From: bchristo at email.arizona.edu (bchristo at email.arizona.edu)
Date: Thu,  5 Oct 2006 03:10:30 +0200 (CEST)
Subject: [Rd] mean relative differences from all.equal() (PR#9276)
Message-ID: <20061005011030.AFB66207F3@slim.kubism.ku.dk>

Full_Name: Brad Christoffersen
Version: 2.3.1
OS: Windows XP
Submission from: (NULL) (128.196.193.132)


Why is the difference between two numbers so different from the "mean relative
difference" output from the all.equal() function?  Is this an artifact of the
way R stores numerics?  I could not find this problem as I searched through the
submitted bugs. But I am brand new to R so I apologize if there is something
obvious I'm missing here.

rm(list=ls(all=TRUE))  ## Remove all objects that could hinder w/ consistent
output
a <- 204
b <- 203.9792
all.equal(a,b)
[1] "Mean relative  difference: 0.0001019608"
a - b
[1] 0.0208

---------- version ---------
platform       i386-pc-mingw32           
arch           i386                      
os             mingw32                   
system         i386, mingw32             
status                                   
major          2                         
minor          3.1                       
year           2006                      
month          06                        
day            01                        
svn rev        38247                     
language       R                         
version.string Version 2.3.1 (2006-06-01)

Thanks,
Brad



From MSchwartz at mn.rr.com  Thu Oct  5 03:22:57 2006
From: MSchwartz at mn.rr.com (MSchwartz at mn.rr.com)
Date: Thu,  5 Oct 2006 03:22:57 +0200 (CEST)
Subject: [Rd] mean relative differences from all.equal() (PR#9276)
Message-ID: <20061005012257.D0E5D207F3@slim.kubism.ku.dk>

On Thu, 2006-10-05 at 03:10 +0200, bchristo at email.arizona.edu wrote:
> Full_Name: Brad Christoffersen
> Version: 2.3.1
> OS: Windows XP
> Submission from: (NULL) (128.196.193.132)
> 
> 
> Why is the difference between two numbers so different from the "mean relative
> difference" output from the all.equal() function?  Is this an artifact of the
> way R stores numerics?  I could not find this problem as I searched through the
> submitted bugs. But I am brand new to R so I apologize if there is something
> obvious I'm missing here.
> 
> rm(list=ls(all=TRUE))  ## Remove all objects that could hinder w/ consistent
> output
> a <- 204
> b <- 203.9792
> all.equal(a,b)
> [1] "Mean relative  difference: 0.0001019608"
> a - b
> [1] 0.0208

Read the Details section of ?all.equal, which states:

Numerical comparisons for scale = NULL (the default) are done by first
computing the mean absolute difference of the two numerical vectors. If
this is smaller than tolerance or not finite, absolute differences are
used, otherwise relative differences scaled by the mean absolute
difference.

If scale is positive, absolute comparisons are made after scaling
(dividing) by scale


Thus on R version 2.4.0 (2006-10-03):

> all.equal(a, b, scale = 1)
[1] "Mean scaled  difference: 0.0208"


Please do not report doubts about behavior as bugs.  Simply post a query
on r-help first. If it is a bug, somebody will confirm it and you can
then report it as such.

BTW, time to upgrade...Go Wildcats!

HTH,

Marc Schwartz



From hpages at fhcrc.org  Thu Oct  5 04:04:27 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Wed, 04 Oct 2006 19:04:27 -0700
Subject: [Rd] Last R-devel snapshot is an empty tarball
Message-ID: <4524682B.7010603@fhcrc.org>

Dear list,

The last R-devel snapshot (2006-10-03) is an empty tarball:
  ftp://ftp.stat.math.ethz.ch/Software/R/
Thanks,

H.



From murdoch at stats.uwo.ca  Thu Oct  5 04:51:58 2006
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Thu,  5 Oct 2006 04:51:58 +0200 (CEST)
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
Message-ID: <20061005025158.19A9C20804@slim.kubism.ku.dk>

I've tracked down where this is occurring, but I don't know how to fix 
it.  Here's a summary:

If the language in Windows is set to simplified Chinese (i.e. Chinese 
(PRC)) and message translations are installed, then on startup Rgui 
crashes when it tries to install the console popup menu.  The crash 
comes when it gets an error trying to do a conversion using mbrtowc, and 
tries to report it using error(); but the R symbol table is needed for 
that, and it hasn't been set up yet.

I'm not sure which menu entry causes the crash, but I think it's not the 
first, so conceivably this is caused by an error in one of the 
translation files.  Indeed, setting the language to Chinese (Taiwan) works.

I don't know how to debug the translation files, so I'm going to have to 
leave this one for now.  I think Brian Ripley is the only one who 
understands all the details of what goes on in the translations, and 
he's away until Oct 9.

Duncan Murdoch

On 10/3/2006 9:00 PM, ronggui wrote:
> This morning I downloaded R-2.4.0 and install in under Windows. I customized
> the installation and choose "Message translations",but I could not launch
> Rgui.exe successfully( Rterm.exe worked fine). If I did't choose "Message
> translations", Rgui.exe worked fine.
> 
> "Message translations" is Simplified Chinese.
> 
>> version
>                _
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status
> major          2
> minor          4.0
> year           2006
> month          10
> day            03
> svn rev        39566
> language       R
> version.string R version 2.4.0 (2006-10-03)
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



From MSchwartz at mn.rr.com  Thu Oct  5 04:57:41 2006
From: MSchwartz at mn.rr.com (MSchwartz at mn.rr.com)
Date: Thu,  5 Oct 2006 04:57:41 +0200 (CEST)
Subject: [Rd] mean relative differences from all.equal() (PR#9276)
Message-ID: <20061005025741.5667120804@slim.kubism.ku.dk>

On Wed, 2006-10-04 at 20:22 -0500, Marc Schwartz wrote:
> On Thu, 2006-10-05 at 03:10 +0200, bchristo at email.arizona.edu wrote:
> > Full_Name: Brad Christoffersen
> > Version: 2.3.1
> > OS: Windows XP
> > Submission from: (NULL) (128.196.193.132)
> > 
> > 
> > Why is the difference between two numbers so different from the "mean relative
> > difference" output from the all.equal() function?  Is this an artifact of the
> > way R stores numerics?  I could not find this problem as I searched through the
> > submitted bugs. But I am brand new to R so I apologize if there is something
> > obvious I'm missing here.
> > 
> > rm(list=ls(all=TRUE))  ## Remove all objects that could hinder w/ consistent
> > output
> > a <- 204
> > b <- 203.9792
> > all.equal(a,b)
> > [1] "Mean relative  difference: 0.0001019608"
> > a - b
> > [1] 0.0208
> 
> Read the Details section of ?all.equal, which states:
> 
> Numerical comparisons for scale = NULL (the default) are done by first
> computing the mean absolute difference of the two numerical vectors. If
> this is smaller than tolerance or not finite, absolute differences are
> used, otherwise relative differences scaled by the mean absolute
> difference.
> 
> If scale is positive, absolute comparisons are made after scaling
> (dividing) by scale
> 
> 
> Thus on R version 2.4.0 (2006-10-03):
> 
> > all.equal(a, b, scale = 1)
> [1] "Mean scaled  difference: 0.0208"
> 
> 
> Please do not report doubts about behavior as bugs.  Simply post a query
> on r-help first. If it is a bug, somebody will confirm it and you can
> then report it as such.
> 
> BTW, time to upgrade...Go Wildcats!
> 
> HTH,
> 
> Marc Schwartz

[OFFLIST and PRIVATE]

Brad,

A couple of comments.

First, welcome to R. I hope that you enjoy it and find it of value.

If you are not used to open source software and communities (ie. Linux,
etc.), you will find that this community, unlike commercial paid support
forums, tends to be direct with respect to comments. Don't take it
personally.

Be aware that nobody is getting paid to support R. It is developed and
supported on a voluntary basis by a large body of folks, mainly those
known as "R Core". Some of them have quite literally risked their
academic careers and livelihood to facilitate R's existence.

You will, over time, get a flavor for the nature of the community and
the interchange that takes place. As a result of the voluntary nature of
the community, there is an a priori expectation that you will have put
forth reasonable efforts to avail yourself of the various support
resources before posting. Especially in the case of a bug report, as a
member of R Core has to manually manage the handling and resolution of
bug reports.

A good place to start is to review the R Posting Guide:

http://www.r-project.org/posting-guide.html

which covers many of these issues and how to go about getting support
via the various sources provided.

That all being said, you will find that R's support mechanisms and
resources are second to none and I would challenge any commercial
software vendor to provide a comparable level of support and expertise.

With respect to your specific question above and how the result is
obtained:

> (a - b) / a
[1] 0.0001019608

Here, 'a' is used as the scaling factor, since you only passed single
values. If these were 'vectors' of values, the scaling factor would be
impacted accordingly.

As a result of R's open source nature, you have access to all of the
source code that is R. You can download the source tarball (archive)
from one of the CRAN mirrors, if you so desire.

In this case, the actual function that is used is called
all.equal.numeric(). This is a consequence of how R uses 'dispatch
methods' after a call to a 'generic' function, such as all.equal(). If
you are not familiar with these terms, the available R documentation is
a good place to start, if you should decide to pursue moving into that
level of detail. If you have experience in other programming languages,
this may be second nature already.

In many cases, R's functions are written in R itself. Others are written
in FORTRAN and/or C that is compiled and linked to R via various calling
mechanisms. Since R is an interpreted language, you can have easy access
to many of the functions within the R console.

Thus, at the R command prompt, you can type:

> all.equal.numeric

[Note without the parens]

which will then display a representation of the function's source code,
enabling you to review how the function works. If you desire to become a
better R user/programmer, this approach provides a reasonable way to see
how functions are coded and to investigate algorithms and techniques.

I hope that the above is helpful.

Best regards,

Marc



From MSchwartz at mn.rr.com  Thu Oct  5 05:08:28 2006
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 04 Oct 2006 22:08:28 -0500
Subject: [Rd] mean relative differences from all.equal() (PR#9276)
In-Reply-To: <1160017025.7049.56.camel@localhost.localdomain>
References: <20061005011030.AFB66207F3@slim.kubism.ku.dk>
	<1160011359.7049.3.camel@localhost.localdomain>
	<1160017025.7049.56.camel@localhost.localdomain>
Message-ID: <1160017709.7049.61.camel@localhost.localdomain>

On Wed, 2006-10-04 at 21:57 -0500, Marc Schwartz wrote:
> On Wed, 2006-10-04 at 20:22 -0500, Marc Schwartz wrote:
> > On Thu, 2006-10-05 at 03:10 +0200, bchristo at email.arizona.edu wrote:
> > > Full_Name: Brad Christoffersen
> > > Version: 2.3.1
> > > OS: Windows XP
> > > Submission from: (NULL) (128.196.193.132)
> > > 
> > > 
> > > Why is the difference between two numbers so different from the "mean relative
> > > difference" output from the all.equal() function?  Is this an artifact of the
> > > way R stores numerics?  I could not find this problem as I searched through the
> > > submitted bugs. But I am brand new to R so I apologize if there is something
> > > obvious I'm missing here.
> > > 
> > > rm(list=ls(all=TRUE))  ## Remove all objects that could hinder w/ consistent
> > > output
> > > a <- 204
> > > b <- 203.9792
> > > all.equal(a,b)
> > > [1] "Mean relative  difference: 0.0001019608"
> > > a - b
> > > [1] 0.0208
> > 
> > Read the Details section of ?all.equal, which states:
> > 
> > Numerical comparisons for scale = NULL (the default) are done by first
> > computing the mean absolute difference of the two numerical vectors. If
> > this is smaller than tolerance or not finite, absolute differences are
> > used, otherwise relative differences scaled by the mean absolute
> > difference.
> > 
> > If scale is positive, absolute comparisons are made after scaling
> > (dividing) by scale
> > 
> > 
> > Thus on R version 2.4.0 (2006-10-03):
> > 
> > > all.equal(a, b, scale = 1)
> > [1] "Mean scaled  difference: 0.0208"
> > 
> > 
> > Please do not report doubts about behavior as bugs.  Simply post a query
> > on r-help first. If it is a bug, somebody will confirm it and you can
> > then report it as such.
> > 
> > BTW, time to upgrade...Go Wildcats!
> > 
> > HTH,
> > 
> > Marc Schwartz
> 
> [OFFLIST and PRIVATE]
> 
> Brad,
> 
> A couple of comments.
> 
> First, welcome to R. I hope that you enjoy it and find it of value.
> 
> If you are not used to open source software and communities (ie. Linux,
> etc.), you will find that this community, unlike commercial paid support
> forums, tends to be direct with respect to comments. Don't take it
> personally.
> 
> Be aware that nobody is getting paid to support R. It is developed and
> supported on a voluntary basis by a large body of folks, mainly those
> known as "R Core". Some of them have quite literally risked their
> academic careers and livelihood to facilitate R's existence.
> 
> You will, over time, get a flavor for the nature of the community and
> the interchange that takes place. As a result of the voluntary nature of
> the community, there is an a priori expectation that you will have put
> forth reasonable efforts to avail yourself of the various support
> resources before posting. Especially in the case of a bug report, as a
> member of R Core has to manually manage the handling and resolution of
> bug reports.
> 
> A good place to start is to review the R Posting Guide:
> 
> http://www.r-project.org/posting-guide.html
> 
> which covers many of these issues and how to go about getting support
> via the various sources provided.
> 
> That all being said, you will find that R's support mechanisms and
> resources are second to none and I would challenge any commercial
> software vendor to provide a comparable level of support and expertise.
> 
> With respect to your specific question above and how the result is
> obtained:
> 
> > (a - b) / a
> [1] 0.0001019608
> 
> Here, 'a' is used as the scaling factor, since you only passed single
> values. If these were 'vectors' of values, the scaling factor would be
> impacted accordingly.
> 
> As a result of R's open source nature, you have access to all of the
> source code that is R. You can download the source tarball (archive)
> from one of the CRAN mirrors, if you so desire.
> 
> In this case, the actual function that is used is called
> all.equal.numeric(). This is a consequence of how R uses 'dispatch
> methods' after a call to a 'generic' function, such as all.equal(). If
> you are not familiar with these terms, the available R documentation is
> a good place to start, if you should decide to pursue moving into that
> level of detail. If you have experience in other programming languages,
> this may be second nature already.
> 
> In many cases, R's functions are written in R itself. Others are written
> in FORTRAN and/or C that is compiled and linked to R via various calling
> mechanisms. Since R is an interpreted language, you can have easy access
> to many of the functions within the R console.
> 
> Thus, at the R command prompt, you can type:
> 
> > all.equal.numeric
> 
> [Note without the parens]
> 
> which will then display a representation of the function's source code,
> enabling you to review how the function works. If you desire to become a
> better R user/programmer, this approach provides a reasonable way to see
> how functions are coded and to investigate algorithms and techniques.
> 
> I hope that the above is helpful.
> 
> Best regards,
> 
> Marc

My most sincere and public apologies to Brad. The reply message above
was mistakenly copied to the list.

Brad I am sorry.

Marc Schwartz



From p.dalgaard at biostat.ku.dk  Thu Oct  5 09:40:45 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 05 Oct 2006 09:40:45 +0200
Subject: [Rd] Last R-devel snapshot is an empty tarball
In-Reply-To: <4524682B.7010603@fhcrc.org>
References: <4524682B.7010603@fhcrc.org>
Message-ID: <x28xjv1a82.fsf@turmalin.kubism.ku.dk>

Herve Pages <hpages at fhcrc.org> writes:

> Dear list,
> 
> The last R-devel snapshot (2006-10-03) is an empty tarball:
>   ftp://ftp.stat.math.ethz.ch/Software/R/

We know... "make dist" was broken for a while. The unstable
development version will occasionally develop instabilities...

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From rasmussen.bryan at gmail.com  Thu Oct  5 10:05:27 2006
From: rasmussen.bryan at gmail.com (bryan rasmussen)
Date: Thu, 5 Oct 2006 10:05:27 +0200
Subject: [Rd] example using R to aggregate data from multiple Excel files
Message-ID: <3bb44c6e0610050105s201251a1ycdd961333426c1fd@mail.gmail.com>

Hi,

I have a project to analyse the various Web server statistics for a
server on a weekly basis for the past year using data maintained in
about 20 excel files per week. I need to go through these files and
aggregate the data, obviously the excel files are pretty simple 2
column affairs (I say obviously because otherwise why was the data
maintained in 20 files for web site usage per week if the files
themselves were not very simple) I am looking for examples of going
over a bunch of excel files with R, extracting the data and then
aggregating for analysis.

Cheers,
Bryan Rasmussen



From sdavis2 at mail.nih.gov  Thu Oct  5 13:30:14 2006
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu, 5 Oct 2006 07:30:14 -0400
Subject: [Rd] example using R to aggregate data from multiple Excel files
In-Reply-To: <3bb44c6e0610050105s201251a1ycdd961333426c1fd@mail.gmail.com>
References: <3bb44c6e0610050105s201251a1ycdd961333426c1fd@mail.gmail.com>
Message-ID: <200610050730.14257.sdavis2@mail.nih.gov>

On Thursday 05 October 2006 04:05, bryan rasmussen wrote:
> Hi,
>
> I have a project to analyse the various Web server statistics for a
> server on a weekly basis for the past year using data maintained in
> about 20 excel files per week. I need to go through these files and
> aggregate the data, obviously the excel files are pretty simple 2
> column affairs (I say obviously because otherwise why was the data
> maintained in 20 files for web site usage per week if the files
> themselves were not very simple) I am looking for examples of going
> over a bunch of excel files with R, extracting the data and then
> aggregating for analysis.

You probably want to write to the R-help list, not the R-devel list.  That 
said, you probably want to look at the dir() command and read.xls() from the 
gdata/gtools/gplots packages (you need to install all three).  Alternatively, 
you can look at using ODBC to connect to the files.

Sean



From nakama at ki.rim.or.jp  Thu Oct  5 14:06:07 2006
From: nakama at ki.rim.or.jp (Ei-ji Nakama)
Date: Thu, 5 Oct 2006 21:06:07 +0900
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <20061005025158.19A9C20804@slim.kubism.ku.dk>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>
Message-ID: <dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>

I do not understand Chinese, but recognize kanji.
RGui-zh_CN.po is written in utf-8, but charset=CP936 wrote.

  perl -p -i -e 's#charset=CP936#charset=utf-8#' RGui-zh_CN.po
  msgfmt -o RGui.mo RGui-zh_CN.po

2006/10/5, murdoch at stats.uwo.ca <murdoch at stats.uwo.ca>:
> I've tracked down where this is occurring, but I don't know how to fix
> it.  Here's a summary:
>
> If the language in Windows is set to simplified Chinese (i.e. Chinese
> (PRC)) and message translations are installed, then on startup Rgui
> crashes when it tries to install the console popup menu.  The crash
> comes when it gets an error trying to do a conversion using mbrtowc, and
> tries to report it using error(); but the R symbol table is needed for
> that, and it hasn't been set up yet.
>
> I'm not sure which menu entry causes the crash, but I think it's not the
> first, so conceivably this is caused by an error in one of the
> translation files.  Indeed, setting the language to Chinese (Taiwan) works.
>
> I don't know how to debug the translation files, so I'm going to have to
> leave this one for now.  I think Brian Ripley is the only one who
> understands all the details of what goes on in the translations, and
> he's away until Oct 9.
>
> Duncan Murdoch
>
> On 10/3/2006 9:00 PM, ronggui wrote:
> > This morning I downloaded R-2.4.0 and install in under Windows. I customized
> > the installation and choose "Message translations",but I could not launch
> > Rgui.exe successfully( Rterm.exe worked fine). If I did't choose "Message
> > translations", Rgui.exe worked fine.
> >
> > "Message translations" is Simplified Chinese.
> >
> >> version
> >                _
> > platform       i386-pc-mingw32
> > arch           i386
> > os             mingw32
> > system         i386, mingw32
> > status
> > major          2
> > minor          4.0
> > year           2006
> > month          10
> > day            03
> > svn rev        39566
> > language       R
> > version.string R version 2.4.0 (2006-10-03)
> >
> >
> >
> >
> > ------------------------------------------------------------------------
> >
> > ______________________________________________
> > R-help at stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>


-- 
EI-JI Nakama  <nakama at ki.rim.or.jp>
"\u4e2d\u9593\u6804\u6cbb"  <nakama at ki.rim.or.jp>



From pollari at sun3.oulu.fi  Thu Oct  5 14:29:03 2006
From: pollari at sun3.oulu.fi (pollari at sun3.oulu.fi)
Date: Thu,  5 Oct 2006 14:29:03 +0200 (CEST)
Subject: [Rd] Error in seq.default(xtsp[1], xtsp[2], length = n) : (PR#9278)
Message-ID: <20061005122903.CE13D4C89E@slim.kubism.ku.dk>

This error came when compiling R 2.4.0 with Sun Studio 11 compiler in sparc.

mkdir ../../../../library/stats/libs
building package 'datasets'
mkdir ../../../library/datasets
mkdir ../../../library/datasets/R
mkdir ../../../library/datasets/data
Error in seq.default(xtsp[1], xtsp[2], length = n) :
        length must be non-negative number
Execution halted
*** Error code 1
make: Fatal error: Command failed for target `all'
Current working directory /wrk2/R-2.4.0/src/library/datasets
*** Error code 1
make: Fatal error: Command failed for target `R'
Current working directory /wrk2/R-2.4.0/src/library
*** Error code 1
make: Fatal error: Command failed for target `R'
Current working directory /wrk2/R-2.4.0/src
*** Error code 1
make: Fatal error: Command failed for target `R'



From maechler at stat.math.ethz.ch  Thu Oct  5 14:42:53 2006
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Thu,  5 Oct 2006 14:42:53 +0200 (CEST)
Subject: [Rd] Compilation issue (PR#9275)
Message-ID: <20061005124253.C82D4206A0@slim.kubism.ku.dk>

I think this is not a bug,
..

>>>>> "andrew" == andrew duba <andrew_duba at wustl.edu>
>>>>>     on Wed,  4 Oct 2006 22:32:30 +0200 (CEST) writes:

    andrew> Full_Name: Andrew J. Duba
    andrew> Version: 2.4.0
    andrew> OS: OS X
    andrew> Submission from: (NULL) (128.252.95.46)


    andrew> I am trying to compile the newest version of R.  I
    andrew> am using g77 version 3.4.3 and gcc 4.0.  After
    andrew> running gnu make (version 3.8) I get the following
    andrew> error:

    andrew> Error in dyn.load(x, as.logical(local), as.logical(now)) :
    andrew> unable to load shared library
    andrew> '/Users/aduba/sources/R-2.4.0/library/tools/libs/tools.so':
    andrew> dlopen(/Users/aduba/sources/R-2.4.0/library/tools/libs/tools.so, 6): Symbol
    andrew> not found: _z_abs
    andrew> Referenced from: /Users/aduba/sources/R-2.4.0/lib/libRblas.dylib
    andrew> Expected in: flat namespace
    andrew> Execution halted

To me, that's a known symptom of either using the wrong options
to configure or typically rather trying to build R-2.4.0 ``not
from scratch'' but inside a place you had built an older version
of R.

Did you read (a bit in) the "R Administration and Installation"
manual?

In any case, for a bug report, this did not give enough
information (e.g., what version of Unix are you using ?).

Please, rather send a *question* to R-devel (in this case) or
R-help, rather than producing a bug report, unless you *really*
know that something *is* a bug.

Regards,
Martin Maechler, ETH Zurich



From murdoch at stats.uwo.ca  Thu Oct  5 15:23:41 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 05 Oct 2006 09:23:41 -0400
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>
	<dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
Message-ID: <4525075D.4040102@stats.uwo.ca>

On 2006-10-5 8:06, Ei-ji Nakama wrote:
> I do not understand Chinese, but recognize kanji.
> RGui-zh_CN.po is written in utf-8, but charset=CP936 wrote.
> 
>   perl -p -i -e 's#charset=CP936#charset=utf-8#' RGui-zh_CN.po
>   msgfmt -o RGui.mo RGui-zh_CN.po

Thanks!!  That does fix the error, at least on my system.  I'll commit 
the change to R-devel and R-patched.

Duncan Murdoch

> 
> 2006/10/5, murdoch at stats.uwo.ca <murdoch at stats.uwo.ca>:
>> I've tracked down where this is occurring, but I don't know how to fix
>> it.  Here's a summary:
>>
>> If the language in Windows is set to simplified Chinese (i.e. Chinese
>> (PRC)) and message translations are installed, then on startup Rgui
>> crashes when it tries to install the console popup menu.  The crash
>> comes when it gets an error trying to do a conversion using mbrtowc, and
>> tries to report it using error(); but the R symbol table is needed for
>> that, and it hasn't been set up yet.
>>
>> I'm not sure which menu entry causes the crash, but I think it's not the
>> first, so conceivably this is caused by an error in one of the
>> translation files.  Indeed, setting the language to Chinese (Taiwan) works.
>>
>> I don't know how to debug the translation files, so I'm going to have to
>> leave this one for now.  I think Brian Ripley is the only one who
>> understands all the details of what goes on in the translations, and
>> he's away until Oct 9.
>>
>> Duncan Murdoch
>>
>> On 10/3/2006 9:00 PM, ronggui wrote:
>> > This morning I downloaded R-2.4.0 and install in under Windows. I customized
>> > the installation and choose "Message translations",but I could not launch
>> > Rgui.exe successfully( Rterm.exe worked fine). If I did't choose "Message
>> > translations", Rgui.exe worked fine.
>> >
>> > "Message translations" is Simplified Chinese.
>> >
>> >> version
>> >                _
>> > platform       i386-pc-mingw32
>> > arch           i386
>> > os             mingw32
>> > system         i386, mingw32
>> > status
>> > major          2
>> > minor          4.0
>> > year           2006
>> > month          10
>> > day            03
>> > svn rev        39566
>> > language       R
>> > version.string R version 2.4.0 (2006-10-03)
>> >
>> >
>> >
>> >
>> > ------------------------------------------------------------------------
>> >
>> > ______________________________________________
>> > R-help at stat.math.ethz.ch mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
> 
>



From sfalcon at fhcrc.org  Thu Oct  5 15:51:03 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Thu, 05 Oct 2006 06:51:03 -0700
Subject: [Rd] Last R-devel snapshot is an empty tarball
In-Reply-To: <x28xjv1a82.fsf@turmalin.kubism.ku.dk> (Peter Dalgaard's message
	of "05 Oct 2006 09:40:45 +0200")
References: <4524682B.7010603@fhcrc.org> <x28xjv1a82.fsf@turmalin.kubism.ku.dk>
Message-ID: <m2u02ieurc.fsf@ziti.local>

Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
> Herve Pages <hpages at fhcrc.org> writes:
>
>> Dear list,
>> 
>> The last R-devel snapshot (2006-10-03) is an empty tarball:
>>   ftp://ftp.stat.math.ethz.ch/Software/R/
>
> We know... "make dist" was broken for a while. The unstable
> development version will occasionally develop instabilities...

Might this be a good forum to announce such problems when they become
known?  

+ seth



From p.dalgaard at biostat.ku.dk  Thu Oct  5 15:59:44 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 05 Oct 2006 15:59:44 +0200
Subject: [Rd] Last R-devel snapshot is an empty tarball
In-Reply-To: <m2u02ieurc.fsf@ziti.local>
References: <4524682B.7010603@fhcrc.org>
	<x28xjv1a82.fsf@turmalin.kubism.ku.dk> <m2u02ieurc.fsf@ziti.local>
Message-ID: <x2bqoq6ey7.fsf@viggo.kubism.ku.dk>

Seth Falcon <sfalcon at fhcrc.org> writes:

> Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
> > Herve Pages <hpages at fhcrc.org> writes:
> >
> >> Dear list,
> >> 
> >> The last R-devel snapshot (2006-10-03) is an empty tarball:
> >>   ftp://ftp.stat.math.ethz.ch/Software/R/
> >
> > We know... "make dist" was broken for a while. The unstable
> > development version will occasionally develop instabilities...
> 
> Might this be a good forum to announce such problems when they become
> known?  

Yes, in principle. We tend to want to fix them rather than announce
them, though. (It wasn't realized that there was a problem until
yesterday when Kurt was adjusting his package check procedures after
Tuesday's release.)

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From maechler at stat.math.ethz.ch  Thu Oct  5 16:42:16 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 5 Oct 2006 16:42:16 +0200
Subject: [Rd] Last R-devel snapshot is an empty tarball
In-Reply-To: <x2bqoq6ey7.fsf@viggo.kubism.ku.dk>
References: <4524682B.7010603@fhcrc.org> <x28xjv1a82.fsf@turmalin.kubism.ku.dk>
	<m2u02ieurc.fsf@ziti.local> <x2bqoq6ey7.fsf@viggo.kubism.ku.dk>
Message-ID: <17701.6600.716126.750697@stat.math.ethz.ch>

>>>>> "PD" == Peter Dalgaard <p.dalgaard at biostat.ku.dk>
>>>>>     on 05 Oct 2006 15:59:44 +0200 writes:

    PD> Seth Falcon <sfalcon at fhcrc.org> writes:
    >> Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
    >> > Herve Pages <hpages at fhcrc.org> writes:
    >> >
    >> >> Dear list,
    >> >> 
    >> >> The last R-devel snapshot (2006-10-03) is an empty tarball:
    >> >>   ftp://ftp.stat.math.ethz.ch/Software/R/
    >> >
    >> > We know... "make dist" was broken for a while. The unstable
    >> > development version will occasionally develop instabilities...
    >> 
    >> Might this be a good forum to announce such problems when they become
    >> known?  

    PD> Yes, in principle. We tend to want to fix them rather than announce
    PD> them, though.

I had sent Herve a private message with similar content.
You could also just send them to the core team, or,
if you know who is responsible, as in the present case, I am,
send it to me directly.   The smaller the forum, the better for
things that *are* important. 

Martin

    PD>  (It wasn't realized that there was a problem until
    PD> yesterday when Kurt was adjusting his package check procedures after
    PD> Tuesday's release.)



From simon.urbanek at r-project.org  Thu Oct  5 18:23:02 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 5 Oct 2006 12:23:02 -0400
Subject: [Rd] Compilation issue (PR#9275)
In-Reply-To: <20061004203230.415AC28FCD@slim.kubism.ku.dk>
References: <20061004203230.415AC28FCD@slim.kubism.ku.dk>
Message-ID: <329F45A2-91DD-4DBF-9DB0-645AC9ECDB9D@r-project.org>


On Oct 4, 2006, at 4:32 PM, andrew_duba at wustl.edu wrote:

> Full_Name: Andrew J. Duba
> Version: 2.4.0
> OS: OS X
> Submission from: (NULL) (128.252.95.46)
>
>
> I am trying to compile the newest version of R.  I am using g77  
> version 3.4.3
> and gcc 4.0.

This is not a bug - please see the FAQ for Mac OS X -  you cannot mix  
compiler versions. Use either gcc3+g77 or gcc4+gfortran.

Cheers,
Simon


>   After running gnu make (version 3.8) I get the following error:
>
> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>         unable to load shared library
> '/Users/aduba/sources/R-2.4.0/library/tools/libs/tools.so':
>   dlopen(/Users/aduba/sources/R-2.4.0/library/tools/libs/tools.so,  
> 6): Symbol
> not found: _z_abs
>   Referenced from: /Users/aduba/sources/R-2.4.0/lib/libRblas.dylib
>   Expected in: flat namespace
> Execution halted
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From hpages at fhcrc.org  Thu Oct  5 19:04:40 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Thu, 05 Oct 2006 10:04:40 -0700
Subject: [Rd] Last R-devel snapshot is an empty tarball
In-Reply-To: <17700.64607.17076.75659@stat.math.ethz.ch>
References: <4524682B.7010603@fhcrc.org>
	<17700.64607.17076.75659@stat.math.ethz.ch>
Message-ID: <45253B28.4040800@fhcrc.org>

Martin Maechler wrote:
> Hi Herve,
>
>     Herve> Dear list,
>     Herve> The last R-devel snapshot (2006-10-03) is an empty tarball:
>     Herve> ftp://ftp.stat.math.ethz.ch/Software/R/
>     Herve> Thanks,
>
> Peter already replied.
> The snapshot is now back to normal.
>
> The real problem was that the snapshot was broken for about 10
> days till someone noticed.
> So indeed, we would have been grateful if your e-mail had
> arrived a week earlier ;-) ;-)
>   

Hi Martin, Peter,

Thanks for fixing the problem! I've just downloaded the last
R-devel snapshot tarball (2006-10-04) and will give it a try today...

I did notice the 10-day gap but I suspected you R guys already knew
about it and that you were too busy with the R 2.4.0 pre-release stuff
to care about it _at that moment_. So I decided to wait until after the
release. Then yesterday I saw this R-devel snapshot tarball (the
first one in 12 days) and decided to give it a try, because, like Kurt,
I need it for our check procedure too (Bioconductor) ;-)

Cheers,
H.



From fparlamis at mac.com  Fri Oct  6 12:02:48 2006
From: fparlamis at mac.com (Parlamis Franklin)
Date: Fri, 6 Oct 2006 00:02:48 -1000
Subject: [Rd] class unions?
Message-ID: <EBA89392-7277-48CA-9AF8-F134D860C710@mac.com>

the code below has me confused:

	setClassUnion("index", c("numeric", "character", "logical"))
	extends("numeric") # i don't see the class union
	library(Matrix)
	extends("numeric") # now i see the class union

i am aware that the "Matrix" package separately defines the "index"  
class union.
is it the case that class definitions need to occur in packages?

i am also having trouble dispatching on class unions defined in the  
global environment,
which may just be the same problem. see code below:

	setClassUnion("numORchar", c("numeric", "character"))
	foo <- function(x) "Default"
	setMethod("foo", signature(x = "numORchar"),
		function(x) "numORchar")
	foo(2) # gives the default method

franklin

 > version
                _
platform       powerpc-apple-darwin8.7.0
arch           powerpc
os             darwin8.7.0
system         powerpc, darwin8.7.0
status
major          2
minor          4.0
year           2006
month          10
day            03
svn rev        39566
language       R
version.string R version 2.4.0 (2006-10-03)



From thomas.friedrichsmeier at rub.de  Fri Oct  6 15:05:05 2006
From: thomas.friedrichsmeier at rub.de (thomas.friedrichsmeier at rub.de)
Date: Fri,  6 Oct 2006 15:05:05 +0200 (CEST)
Subject: [Rd] operator :: and symbols not in the namespace of a package with
	a namespace (PR#9279)
Message-ID: <20061006130505.A50374BEC2@slim.kubism.ku.dk>

Full_Name: Thomas Friedrichsmeier
Version: 2.4.0
OS: GNU/Linux
Submission from: (NULL) (84.61.116.51)


Since R 2.4.0, operator "::" also returns objects in the package environment, if
the package does not have a namespace. This is a very welcome addition.

Additional wish:
If a package has a namespace, but does not place all symbols in that namespace,
lookup will still fail. For example in package boot (version 1.2-26):

library (boot)
exists ("motor", envir=as.environment ("package:boot"))   # TRUE
getAnywhere ("motor")                                     # found in
package:boot
boot::motor                                               # error not in
namespace

This is as documented, but I think it would be convenient, if boot::motor would
also return the object in this case.

This might be achieved by adding an additional tryCatch in "::": If the package
has a namespace, try getExportedValue (), if that fails, try to get from package
environment instead. E.g.:

"::" <- function (pkg, name)
{
    pkg <- as.character(substitute(pkg))
    name <- as.character(substitute(name))
    ns <- tryCatch(asNamespace(pkg), hasNoNamespaceError = function(e) NULL)
    if (is.null(ns)) {
        pos <- match(paste("package", pkg, sep = ":"), search(), 
            0)
        if (pos == 0) 
            stop(gettextf(paste("package '%s' has no name space and", 
                "is not on the search path"), pkg), domain = NA)
        get(name, pos = pos, inherits = FALSE)
    }
    else tryCatch(getExportedValue(pkg, name), error=function (e) {
                       pos <- match(paste("package", pkg, sep=":"), search(),
0)
                       get(name, pos, inherits=FALSE)
                  })
}



From murdoch at stats.uwo.ca  Fri Oct  6 15:30:50 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 06 Oct 2006 09:30:50 -0400
Subject: [Rd] operator :: and symbols not in the namespace of a package
 with	a namespace (PR#9279)
In-Reply-To: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
References: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
Message-ID: <45265A8A.6060505@stats.uwo.ca>

On 10/6/2006 9:05 AM, thomas.friedrichsmeier at rub.de wrote:
> Full_Name: Thomas Friedrichsmeier
> Version: 2.4.0
> OS: GNU/Linux
> Submission from: (NULL) (84.61.116.51)
> 
> 
> Since R 2.4.0, operator "::" also returns objects in the package environment, if
> the package does not have a namespace. This is a very welcome addition.
> 
> Additional wish:
> If a package has a namespace, but does not place all symbols in that namespace,
> lookup will still fail. For example in package boot (version 1.2-26):
> 
> library (boot)
> exists ("motor", envir=as.environment ("package:boot"))   # TRUE
> getAnywhere ("motor")                                     # found in
> package:boot
> boot::motor                                               # error not in
> namespace
> 
> This is as documented, but I think it would be convenient, if boot::motor would
> also return the object in this case.

At first I was ready to disagree with you, telling you to use the ":::" 
operator for something that is not exported:  but in fact motor is a 
dataset, so it is exported from the package by being loaded into the 
package environment when the package is loaded.  I agree that the "::" 
operator should find it.

I think the rule should be:  the "::" operator looks at the symbols that 
are publicly available from the package, i.e. boot::motor should 
effectively be an abbreviation for

get("motor", pos="package:boot", inherits=FALSE)

after making sure boot is loaded.  I think getExportedValue() is a much 
more rarely needed function, so users should need to use it explicitly.

Duncan Murdoch

> 
> This might be achieved by adding an additional tryCatch in "::": If the package
> has a namespace, try getExportedValue (), if that fails, try to get from package
> environment instead. E.g.:
> 
> "::" <- function (pkg, name)
> {
>     pkg <- as.character(substitute(pkg))
>     name <- as.character(substitute(name))
>     ns <- tryCatch(asNamespace(pkg), hasNoNamespaceError = function(e) NULL)
>     if (is.null(ns)) {
>         pos <- match(paste("package", pkg, sep = ":"), search(), 
>             0)
>         if (pos == 0) 
>             stop(gettextf(paste("package '%s' has no name space and", 
>                 "is not on the search path"), pkg), domain = NA)
>         get(name, pos = pos, inherits = FALSE)
>     }
>     else tryCatch(getExportedValue(pkg, name), error=function (e) {
>                        pos <- match(paste("package", pkg, sep=":"), search(),
> 0)
>                        get(name, pos, inherits=FALSE)
>                   })
> }
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From jmc at r-project.org  Fri Oct  6 15:48:49 2006
From: jmc at r-project.org (John Chambers)
Date: Fri, 06 Oct 2006 09:48:49 -0400
Subject: [Rd] class unions?
In-Reply-To: <EBA89392-7277-48CA-9AF8-F134D860C710@mac.com>
References: <EBA89392-7277-48CA-9AF8-F134D860C710@mac.com>
Message-ID: <45265EC1.5040004@r-project.org>

The problem is a combination of a class union definition that includes a 
basic type as a member, and is not in a package.

Class "numeric" is sealed, so at present setClassUnion() doesn't cache 
the new superclass in the definition of "numeric".  In 2.4.0 that 
happens when a package is attached (before, it didn't happen at all).  
It's _probably_ true that the caching should take place in 
setClassUnion(), but that needs a little consideration.

Meanwhile the workaround is to call cacheMetaData(1) to cache the 
information in the global environment--that's what happens when a 
corresponding package is attached.

 > setClassUnion("index", c("numeric", "character", "logical"))
[1] "index"
 > cacheMetaData(1)
 > extends("numeric")
[1] "numeric"   "vector"    "index"


Parlamis Franklin wrote:
> the code below has me confused:
>
> 	setClassUnion("index", c("numeric", "character", "logical"))
> 	extends("numeric") # i don't see the class union
> 	library(Matrix)
> 	extends("numeric") # now i see the class union
>
> i am aware that the "Matrix" package separately defines the "index"  
> class union.
> is it the case that class definitions need to occur in packages?
>
> i am also having trouble dispatching on class unions defined in the  
> global environment,
> which may just be the same problem.
Yes.  You need to cacheMetaData(1) before calling foo(2).
>  see code below:
>
> 	setClassUnion("numORchar", c("numeric", "character"))
> 	foo <- function(x) "Default"
> 	setMethod("foo", signature(x = "numORchar"),
> 		function(x) "numORchar")
> 	foo(2) # gives the default method
>
> franklin
>
>  > version
>                 _
> platform       powerpc-apple-darwin8.7.0
> arch           powerpc
> os             darwin8.7.0
> system         powerpc, darwin8.7.0
> status
> major          2
> minor          4.0
> year           2006
> month          10
> day            03
> svn rev        39566
> language       R
> version.string R version 2.4.0 (2006-10-03)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From jmc at r-project.org  Fri Oct  6 16:16:51 2006
From: jmc at r-project.org (John Chambers)
Date: Fri, 06 Oct 2006 10:16:51 -0400
Subject: [Rd] Default argument value for "["
In-Reply-To: <1159974834.14595.41.camel@localhost.localdomain>
References: <mailman.9.1159956004.28879.r-devel@r-project.org>
	<1159957901.14595.24.camel@localhost.localdomain>
	<4523BC95.6010505@r-project.org>
	<1159974834.14595.41.camel@localhost.localdomain>
Message-ID: <45266553.2050403@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061006/0a07aab5/attachment-0003.pl 

From luke at stat.uiowa.edu  Fri Oct  6 16:44:53 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 6 Oct 2006 09:44:53 -0500 (CDT)
Subject: [Rd] operator :: and symbols not in the namespace of a package
 with	a namespace (PR#9279)
In-Reply-To: <45265A8A.6060505@stats.uwo.ca>
References: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
	<45265A8A.6060505@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>

On Fri, 6 Oct 2006, Duncan Murdoch wrote:

> On 10/6/2006 9:05 AM, thomas.friedrichsmeier at rub.de wrote:
>> Full_Name: Thomas Friedrichsmeier
>> Version: 2.4.0
>> OS: GNU/Linux
>> Submission from: (NULL) (84.61.116.51)
>>
>>
>> Since R 2.4.0, operator "::" also returns objects in the package environment, if
>> the package does not have a namespace. This is a very welcome addition.
>>
>> Additional wish:
>> If a package has a namespace, but does not place all symbols in that namespace,
>> lookup will still fail. For example in package boot (version 1.2-26):
>>
>> library (boot)
>> exists ("motor", envir=as.environment ("package:boot"))   # TRUE
>> getAnywhere ("motor")                                     # found in
>> package:boot
>> boot::motor                                               # error not in
>> namespace
>>
>> This is as documented, but I think it would be convenient, if boot::motor would
>> also return the object in this case.
>
> At first I was ready to disagree with you, telling you to use the ":::"
> operator for something that is not exported:  but in fact motor is a
> dataset, so it is exported from the package by being loaded into the
> package environment when the package is loaded.  I agree that the "::"
> operator should find it.

It might be a good idea to rethink the decision to have data be
handled specially instead of having data sets be treated as ordinary
exported variables.  There may be a good reason for doing what we do
now but I don't know what it is.  If there really is a good reason to
continue this then maybe we should think about this addition.  It
doesn't feel like the right thing to do but may be harmless.

> I think the rule should be:  the "::" operator looks at the symbols that
> are publicly available from the package, i.e. boot::motor should
> effectively be an abbreviation for
>
> get("motor", pos="package:boot", inherits=FALSE)
>
> after making sure boot is loaded.  I think getExportedValue() is a much
> more rarely needed function, so users should need to use it explicitly.

No. :: exists precisely to allow code to access exported variables
without attaching the namespace.  It is the only way I use this feature
and the reason the feature exists.

Best,

luke



>
> Duncan Murdoch
>
>>
>> This might be achieved by adding an additional tryCatch in "::": If the package
>> has a namespace, try getExportedValue (), if that fails, try to get from package
>> environment instead. E.g.:
>>
>> "::" <- function (pkg, name)
>> {
>>     pkg <- as.character(substitute(pkg))
>>     name <- as.character(substitute(name))
>>     ns <- tryCatch(asNamespace(pkg), hasNoNamespaceError = function(e) NULL)
>>     if (is.null(ns)) {
>>         pos <- match(paste("package", pkg, sep = ":"), search(),
>>             0)
>>         if (pos == 0)
>>             stop(gettextf(paste("package '%s' has no name space and",
>>                 "is not on the search path"), pkg), domain = NA)
>>         get(name, pos = pos, inherits = FALSE)
>>     }
>>     else tryCatch(getExportedValue(pkg, name), error=function (e) {
>>                        pos <- match(paste("package", pkg, sep=":"), search(),
>> 0)
>>                        get(name, pos, inherits=FALSE)
>>                   })
>> }
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From murdoch at stats.uwo.ca  Fri Oct  6 16:59:32 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 06 Oct 2006 10:59:32 -0400
Subject: [Rd] operator :: and symbols not in the namespace of a package
 with	a namespace (PR#9279)
In-Reply-To: <Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>
References: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
	<45265A8A.6060505@stats.uwo.ca>
	<Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>
Message-ID: <45266F54.7070209@stats.uwo.ca>

On 10/6/2006 10:44 AM, Luke Tierney wrote:
> On Fri, 6 Oct 2006, Duncan Murdoch wrote:
> 
>> On 10/6/2006 9:05 AM, thomas.friedrichsmeier at rub.de wrote:
>>> Full_Name: Thomas Friedrichsmeier
>>> Version: 2.4.0
>>> OS: GNU/Linux
>>> Submission from: (NULL) (84.61.116.51)
>>>
>>>
>>> Since R 2.4.0, operator "::" also returns objects in the package environment, if
>>> the package does not have a namespace. This is a very welcome addition.
>>>
>>> Additional wish:
>>> If a package has a namespace, but does not place all symbols in that namespace,
>>> lookup will still fail. For example in package boot (version 1.2-26):
>>>
>>> library (boot)
>>> exists ("motor", envir=as.environment ("package:boot"))   # TRUE
>>> getAnywhere ("motor")                                     # found in
>>> package:boot
>>> boot::motor                                               # error not in
>>> namespace
>>>
>>> This is as documented, but I think it would be convenient, if boot::motor would
>>> also return the object in this case.
>>
>> At first I was ready to disagree with you, telling you to use the ":::"
>> operator for something that is not exported:  but in fact motor is a
>> dataset, so it is exported from the package by being loaded into the
>> package environment when the package is loaded.  I agree that the "::"
>> operator should find it.
> 
> It might be a good idea to rethink the decision to have data be
> handled specially instead of having data sets be treated as ordinary
> exported variables.  There may be a good reason for doing what we do
> now but I don't know what it is.  If there really is a good reason to
> continue this then maybe we should think about this addition.  It
> doesn't feel like the right thing to do but may be harmless.

I think there would be a good reason if it was expensive to load 
datasets, but now it's cheap, so I don't think there's a good reason any 
more.
> 
>> I think the rule should be:  the "::" operator looks at the symbols that
>> are publicly available from the package, i.e. boot::motor should
>> effectively be an abbreviation for
>>
>> get("motor", pos="package:boot", inherits=FALSE)
>>
>> after making sure boot is loaded.  I think getExportedValue() is a much
>> more rarely needed function, so users should need to use it explicitly.
> 
> No. :: exists precisely to allow code to access exported variables
> without attaching the namespace.  It is the only way I use this feature
> and the reason the feature exists.

Right, the description I gave above is wrong, but I think the current 
behaviour is wrong too.  A reasonable alternative use for "::" is to 
specify where to go to look for a variable whose name may clash with 
another.  Avoiding the side effect of changing the search list is a very 
nice feature of it.

Is there a simple way to do a load of a package as if it was being 
attached, but without putting it into the search list?  If so, that's 
what I meant above :-), with the search taking place in the public 
environment of the package.

Duncan Murdoch
> 
> Best,
> 
> luke
> 
> 
> 
>>
>> Duncan Murdoch
>>
>>>
>>> This might be achieved by adding an additional tryCatch in "::": If the package
>>> has a namespace, try getExportedValue (), if that fails, try to get from package
>>> environment instead. E.g.:
>>>
>>> "::" <- function (pkg, name)
>>> {
>>>     pkg <- as.character(substitute(pkg))
>>>     name <- as.character(substitute(name))
>>>     ns <- tryCatch(asNamespace(pkg), hasNoNamespaceError = function(e) NULL)
>>>     if (is.null(ns)) {
>>>         pos <- match(paste("package", pkg, sep = ":"), search(),
>>>             0)
>>>         if (pos == 0)
>>>             stop(gettextf(paste("package '%s' has no name space and",
>>>                 "is not on the search path"), pkg), domain = NA)
>>>         get(name, pos = pos, inherits = FALSE)
>>>     }
>>>     else tryCatch(getExportedValue(pkg, name), error=function (e) {
>>>                        pos <- match(paste("package", pkg, sep=":"), search(),
>>> 0)
>>>                        get(name, pos, inherits=FALSE)
>>>                   })
>>> }
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>



From hin-tak.leung at cimr.cam.ac.uk  Fri Oct  6 19:35:16 2006
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 06 Oct 2006 18:35:16 +0100
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <4525075D.4040102@stats.uwo.ca>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>	<dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
	<4525075D.4040102@stats.uwo.ca>
Message-ID: <452693D4.2010905@cimr.cam.ac.uk>

Duncan Murdoch wrote:
> On 2006-10-5 8:06, Ei-ji Nakama wrote:
>> I do not understand Chinese, but recognize kanji.
>> RGui-zh_CN.po is written in utf-8, but charset=CP936 wrote.
>>
>>   perl -p -i -e 's#charset=CP936#charset=utf-8#' RGui-zh_CN.po
>>   msgfmt -o RGui.mo RGui-zh_CN.po
> 
> Thanks!!  That does fix the error, at least on my system.  I'll commit 
> the change to R-devel and R-patched.

Hmm, I do understand Chinese, and I can confirm that the content
of RGui-zh_CN.po in R 2.4 is in utf-8 rather than CP936.

I can also confirm that CP950(big5) for RGui-zh_TW.po is correct, and
CP932(shift-JIS) for  RGui-ja.po is also correct. (so you'll need to 
find some korean to verify CP949 for RGui-ko.po).

However, the fix is slightly "asymmetric". Out of ru, zh_CN, zh_TW,
ja, ko, only ru in R-2.4.0/po/*.po is in localised encoding,
(the others 4 in UTF-8), whereas RGui-*.po, after the fix, all
are in localised encoding except RGui-zh_CN.po .

I would propose correcting the encoding of the *content*, rather
than the charset tag, so that Rgui-* all uses localised ones (CP932, 
CP936, CP949, CP950). That should be better for older windows...

Just my two cents/pennies...

Hin-Tak Leung



From murdoch at stats.uwo.ca  Fri Oct  6 19:41:30 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 06 Oct 2006 13:41:30 -0400
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <452693D4.2010905@cimr.cam.ac.uk>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>	<dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
	<4525075D.4040102@stats.uwo.ca> <452693D4.2010905@cimr.cam.ac.uk>
Message-ID: <4526954A.7050509@stats.uwo.ca>

On 10/6/2006 1:35 PM, Hin-Tak Leung wrote:
> Duncan Murdoch wrote:
>> On 2006-10-5 8:06, Ei-ji Nakama wrote:
>>> I do not understand Chinese, but recognize kanji.
>>> RGui-zh_CN.po is written in utf-8, but charset=CP936 wrote.
>>>
>>>   perl -p -i -e 's#charset=CP936#charset=utf-8#' RGui-zh_CN.po
>>>   msgfmt -o RGui.mo RGui-zh_CN.po
>> 
>> Thanks!!  That does fix the error, at least on my system.  I'll commit 
>> the change to R-devel and R-patched.
> 
> Hmm, I do understand Chinese, and I can confirm that the content
> of RGui-zh_CN.po in R 2.4 is in utf-8 rather than CP936.
> 
> I can also confirm that CP950(big5) for RGui-zh_TW.po is correct, and
> CP932(shift-JIS) for  RGui-ja.po is also correct. (so you'll need to 
> find some korean to verify CP949 for RGui-ko.po).
> 
> However, the fix is slightly "asymmetric". Out of ru, zh_CN, zh_TW,
> ja, ko, only ru in R-2.4.0/po/*.po is in localised encoding,
> (the others 4 in UTF-8), whereas RGui-*.po, after the fix, all
> are in localised encoding except RGui-zh_CN.po .
> 
> I would propose correcting the encoding of the *content*, rather
> than the charset tag, so that Rgui-* all uses localised ones (CP932, 
> CP936, CP949, CP950). That should be better for older windows...

I did try that, but iconv didn't want to convert the file from UTF-8 to 
CP936.  I've no idea why not.

In any case, those files only need to be readable by the translation 
teams, not by end-users, so I don't think the asymmetry matters:  if a 
translator finds it easy to work in UTF-8 that's fine for R, as long as 
it is correctly recorded.

Duncan Murdoch



From hb at stat.berkeley.edu  Sat Oct  7 00:20:15 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Fri, 6 Oct 2006 15:20:15 -0700
Subject: [Rd] Extreme slowdown with named vectors. A bug?
Message-ID: <59d7961d0610061520g4510172bh6b7bbdf19b20b477@mail.gmail.com>

Tried the following with R --vanilla on the Rv2.4.0 release (see
details at the end).  I think the script and its comments speaks for
itself, but the outcome is certainly not wanted.

for (n in 58950:58970) {
  cat("n=", n, "\n", sep="");

  # Clean up first
  rm(names, x, y); gc();

  # Create a named vector of length n
  # Try with format "%5d" and it works
  names <- sprintf("%05d", 1:n);
  x <- seq(along=names);
  names(x) <- names;

  # Extract the first k elements
  k <- 36422;
  t0 <- system.time({
    y <- x[names[1:k]];
  })
  str(y);

  # But with one more it takes
  # for ever when n >= 58960
  k <- k + 1;
  t1 <- system.time({
    y <- x[names[1:k]];
  })
  # ...then t1/t0 ~= 300-500 and growing!
  print(t1/t0);
  str(y);
}


The interesting this is that if you replace

 y <- x[names[1:k]];

with

 idxs <- match(names[1:k], names(x));
 y <- x[idxs];

everything is fine.

(For those working with the Affy 100K SNP chips, the freaky thing is
that the problem occurs at n = 58960 which is exactly the number of
SNPs on the Xba array; that's how I found out about the bug/feature it
the first place).

Tried this on two different systems:

> sessionInfo()
R version 2.4.0 (2006-10-03)
i386-pc-mingw32
locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
States.1252;LC_MONETARY=English_United
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "base"

> sessionInfo()
R version 2.4.0 (2006-10-03)
x86_64-unknown-linux-gnu
locale:
C
attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "base"

Cheers

/Henrik



From cberry at tajo.ucsd.edu  Sat Oct  7 01:23:37 2006
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Fri, 6 Oct 2006 16:23:37 -0700
Subject: [Rd] Extreme slowdown with named vectors. A bug?
In-Reply-To: <59d7961d0610061520g4510172bh6b7bbdf19b20b477@mail.gmail.com>
References: <59d7961d0610061520g4510172bh6b7bbdf19b20b477@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610061606390.30258@tajo.ucsd.edu>


Another example:

> avec <- 1:55000
> names(avec) <- as.character(avec)
> system.time(avec[names(avec)[1:39045]])
[1] 0.06 0.00 0.07   NA   NA
> system.time(avec[names(avec)[1:39046]])
[1] 23.89  0.00 23.94    NA    NA
> version
                _
platform       i386-pc-mingw32
arch           i386
os             mingw32
system         i386, mingw32
status
major          2
minor          4.0
year           2006
month          10
day            03
svn rev        39566
language       R
version.string R version 2.4.0 (2006-10-03)


FWIW, this example shows similar behavior on R-2.2.0 Linux.



On Fri, 6 Oct 2006, Henrik Bengtsson wrote:

> Tried the following with R --vanilla on the Rv2.4.0 release (see
> details at the end).  I think the script and its comments speaks for
> itself, but the outcome is certainly not wanted.
>
[snip]


Charles C. Berry                        (858) 534-2098
                                          Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	         UC San Diego
http://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0717



From murdoch at stats.uwo.ca  Sat Oct  7 03:10:54 2006
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Sat,  7 Oct 2006 03:10:54 +0200 (CEST)
Subject: [Rd] Extreme slowdown with named vectors. A bug? (PR#9280)
Message-ID: <20061007011054.E5D0955A3B@slim.kubism.ku.dk>

On 10/6/2006 6:20 PM, Henrik Bengtsson wrote:
> Tried the following with R --vanilla on the Rv2.4.0 release (see
> details at the end).  I think the script and its comments speaks for
> itself, but the outcome is certainly not wanted.

I see a similar effect to what you're describing.  I also see it in 
2.3.1, so it's not a new bug.

I tracked it down to an overflow occurring in the stringSubscript 
function in src/main/subscript.c:  at the beginning there's a test

ns * nx > 1000

When ns and nx are both large, the product overflows and becomes 
negative.  I'll see if I can fix it.

Duncan Murdoch


> 
> for (n in 58950:58970) {
>   cat("n=", n, "\n", sep="");
> 
>   # Clean up first
>   rm(names, x, y); gc();
> 
>   # Create a named vector of length n
>   # Try with format "%5d" and it works
>   names <- sprintf("%05d", 1:n);
>   x <- seq(along=names);
>   names(x) <- names;
> 
>   # Extract the first k elements
>   k <- 36422;
>   t0 <- system.time({
>     y <- x[names[1:k]];
>   })
>   str(y);
> 
>   # But with one more it takes
>   # for ever when n >= 58960
>   k <- k + 1;
>   t1 <- system.time({
>     y <- x[names[1:k]];
>   })
>   # ...then t1/t0 ~= 300-500 and growing!
>   print(t1/t0);
>   str(y);
> }
> 
> 
> The interesting this is that if you replace
> 
>  y <- x[names[1:k]];
> 
> with
> 
>  idxs <- match(names[1:k], names(x));
>  y <- x[idxs];
> 
> everything is fine.
> 
> (For those working with the Affy 100K SNP chips, the freaky thing is
> that the problem occurs at n = 58960 which is exactly the number of
> SNPs on the Xba array; that's how I found out about the bug/feature it
> the first place).
> 
> Tried this on two different systems:
> 
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> [7] "base"
> 
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> x86_64-unknown-linux-gnu
> locale:
> C
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> [7] "base"
> 
> Cheers
> 
> /Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From murdoch at stats.uwo.ca  Sat Oct  7 05:13:39 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 06 Oct 2006 23:13:39 -0400
Subject: [Rd] Extreme slowdown with named vectors. A bug?
In-Reply-To: <59d7961d0610061520g4510172bh6b7bbdf19b20b477@mail.gmail.com>
References: <59d7961d0610061520g4510172bh6b7bbdf19b20b477@mail.gmail.com>
Message-ID: <45271B63.8050907@stats.uwo.ca>

On 10/6/2006 6:20 PM, Henrik Bengtsson wrote:
> Tried the following with R --vanilla on the Rv2.4.0 release (see
> details at the end).  I think the script and its comments speaks for
> itself, but the outcome is certainly not wanted.

I think this is fixed now in R-devel and R-patched.  Thanks for the 
report, and the detailed script to reproduce the bug.

Duncan Murdoch

> 
> for (n in 58950:58970) {
>   cat("n=", n, "\n", sep="");
> 
>   # Clean up first
>   rm(names, x, y); gc();
> 
>   # Create a named vector of length n
>   # Try with format "%5d" and it works
>   names <- sprintf("%05d", 1:n);
>   x <- seq(along=names);
>   names(x) <- names;
> 
>   # Extract the first k elements
>   k <- 36422;
>   t0 <- system.time({
>     y <- x[names[1:k]];
>   })
>   str(y);
> 
>   # But with one more it takes
>   # for ever when n >= 58960
>   k <- k + 1;
>   t1 <- system.time({
>     y <- x[names[1:k]];
>   })
>   # ...then t1/t0 ~= 300-500 and growing!
>   print(t1/t0);
>   str(y);
> }
> 
> 
> The interesting this is that if you replace
> 
>  y <- x[names[1:k]];
> 
> with
> 
>  idxs <- match(names[1:k], names(x));
>  y <- x[idxs];
> 
> everything is fine.
> 
> (For those working with the Affy 100K SNP chips, the freaky thing is
> that the problem occurs at n = 58960 which is exactly the number of
> SNPs on the Xba array; that's how I found out about the bug/feature it
> the first place).
> 
> Tried this on two different systems:
> 
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> [7] "base"
> 
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> x86_64-unknown-linux-gnu
> locale:
> C
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> [7] "base"
> 
> Cheers
> 
> /Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From nakama at ki.rim.or.jp  Sat Oct  7 07:52:52 2006
From: nakama at ki.rim.or.jp (Ei-ji Nakama)
Date: Sat, 7 Oct 2006 14:52:52 +0900
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <4526954A.7050509@stats.uwo.ca>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>
	<dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
	<4525075D.4040102@stats.uwo.ca> <452693D4.2010905@cimr.cam.ac.uk>
	<4526954A.7050509@stats.uwo.ca>
Message-ID: <dc41e1260610062252j53cd5113s942c6b90a97fa8f1@mail.gmail.com>

 iconv  -f  utf-8 -t cp936 RGui-zh_CN.po > RGui-zh_CN.po.cp936
 iconv: illegal input sequence at position 19303

 iconv -c -f  utf-8 -t cp936 RGui-zh_CN.po > RGui-zh_CN.po.cp936
      ^^
 iconv -f cp936 -t utf-8 RGui-zh_CN.po.cp936 > RGui-zh_CN.po.cp936utf8
 diff -uN  RGui-zh_CN.po   RGui-zh_CN.po.cp936utf8
@@ -852,7 +852,7 @@

 #: rui.c:1283 rui.c:1404
 msgid "menu + item is limited to 1000 bytes"
-msgstr "xxx"
+msgstr "xxx"

 grep -C1 "menu + item is limited to 1000 bytes" RGui-zh_CN.po

This should ask a translator for text of a part for a difference.
BTW, there is not a problem in GB18030.

2006/10/7, Duncan Murdoch <murdoch at stats.uwo.ca>:
> On 10/6/2006 1:35 PM, Hin-Tak Leung wrote:
> > Duncan Murdoch wrote:
> >> On 2006-10-5 8:06, Ei-ji Nakama wrote:
> >>> I do not understand Chinese, but recognize kanji.
> >>> RGui-zh_CN.po is written in utf-8, but charset=CP936 wrote.
> >>>
> >>>   perl -p -i -e 's#charset=CP936#charset=utf-8#' RGui-zh_CN.po
> >>>   msgfmt -o RGui.mo RGui-zh_CN.po
> >>
> >> Thanks!!  That does fix the error, at least on my system.  I'll commit
> >> the change to R-devel and R-patched.
> >
> > Hmm, I do understand Chinese, and I can confirm that the content
> > of RGui-zh_CN.po in R 2.4 is in utf-8 rather than CP936.
> >
> > I can also confirm that CP950(big5) for RGui-zh_TW.po is correct, and
> > CP932(shift-JIS) for  RGui-ja.po is also correct. (so you'll need to
> > find some korean to verify CP949 for RGui-ko.po).
> >
> > However, the fix is slightly "asymmetric". Out of ru, zh_CN, zh_TW,
> > ja, ko, only ru in R-2.4.0/po/*.po is in localised encoding,
> > (the others 4 in UTF-8), whereas RGui-*.po, after the fix, all
> > are in localised encoding except RGui-zh_CN.po .
> >
> > I would propose correcting the encoding of the *content*, rather
> > than the charset tag, so that Rgui-* all uses localised ones (CP932,
> > CP936, CP949, CP950). That should be better for older windows...
>
> I did try that, but iconv didn't want to convert the file from UTF-8 to
> CP936.  I've no idea why not.
>
> In any case, those files only need to be readable by the translation
> teams, not by end-users, so I don't think the asymmetry matters:  if a
> translator finds it easy to work in UTF-8 that's fine for R, as long as
> it is correctly recorded.
>
> Duncan Murdoch
>
>
>


-- 
EI-JI Nakama  <nakama at ki.rim.or.jp>
"\u4e2d\u9593\u6804\u6cbb"  <nakama at ki.rim.or.jp>



From hb at stat.berkeley.edu  Sat Oct  7 08:11:04 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Fri, 6 Oct 2006 23:11:04 -0700
Subject: [Rd] Extreme slowdown with named vectors. A bug?
In-Reply-To: <45271B63.8050907@stats.uwo.ca>
References: <59d7961d0610061520g4510172bh6b7bbdf19b20b477@mail.gmail.com>
	<45271B63.8050907@stats.uwo.ca>
Message-ID: <59d7961d0610062311y305f0f7dyd8383dca115af853@mail.gmail.com>

Thank *you* for identifying the source of the problem and fixing. :) /Henrik

On 10/6/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/6/2006 6:20 PM, Henrik Bengtsson wrote:
> > Tried the following with R --vanilla on the Rv2.4.0 release (see
> > details at the end).  I think the script and its comments speaks for
> > itself, but the outcome is certainly not wanted.
>
> I think this is fixed now in R-devel and R-patched.  Thanks for the
> report, and the detailed script to reproduce the bug.
>
> Duncan Murdoch
>
> >
> > for (n in 58950:58970) {
> >   cat("n=", n, "\n", sep="");
> >
> >   # Clean up first
> >   rm(names, x, y); gc();
> >
> >   # Create a named vector of length n
> >   # Try with format "%5d" and it works
> >   names <- sprintf("%05d", 1:n);
> >   x <- seq(along=names);
> >   names(x) <- names;
> >
> >   # Extract the first k elements
> >   k <- 36422;
> >   t0 <- system.time({
> >     y <- x[names[1:k]];
> >   })
> >   str(y);
> >
> >   # But with one more it takes
> >   # for ever when n >= 58960
> >   k <- k + 1;
> >   t1 <- system.time({
> >     y <- x[names[1:k]];
> >   })
> >   # ...then t1/t0 ~= 300-500 and growing!
> >   print(t1/t0);
> >   str(y);
> > }
> >
> >
> > The interesting this is that if you replace
> >
> >  y <- x[names[1:k]];
> >
> > with
> >
> >  idxs <- match(names[1:k], names(x));
> >  y <- x[idxs];
> >
> > everything is fine.
> >
> > (For those working with the Affy 100K SNP chips, the freaky thing is
> > that the problem occurs at n = 58960 which is exactly the number of
> > SNPs on the Xba array; that's how I found out about the bug/feature it
> > the first place).
> >
> > Tried this on two different systems:
> >
> >> sessionInfo()
> > R version 2.4.0 (2006-10-03)
> > i386-pc-mingw32
> > locale:
> > LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> > States.1252;LC_MONETARY=English_United
> > States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> > attached base packages:
> > [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> > [7] "base"
> >
> >> sessionInfo()
> > R version 2.4.0 (2006-10-03)
> > x86_64-unknown-linux-gnu
> > locale:
> > C
> > attached base packages:
> > [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> > [7] "base"
> >
> > Cheers
> >
> > /Henrik
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From jeff.horner at vanderbilt.edu  Sat Oct  7 22:34:26 2006
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Sat, 07 Oct 2006 15:34:26 -0500
Subject: [Rd] Request to open up getConnection to embedded interface
Message-ID: <45280F52.8010704@vanderbilt.edu>

Hello all,

I would like to request that getConnection() and the struct Rconn 
declarations be added to the R embedded interface. Here's why.

It's common in CGI scripts for web applications to direct stdin, stdout, 
and stderr map to reading from the browser, writing to the browser, and 
writing to a web log file respectively; very nice and neat. However, 
things get a little hairy once language interpreters are embedded into 
web servers.

For modules like RApache, there are Apache api calls that govern how to 
  read/write from/to the browser so simple redirection is not feasible.

With the above request, here is how RApache can alter stdout's behavior:

     ...

     Rf_initEmbeddedR(argc, argv); /* initialize R */


     /* Redirect stdout to apache specific routines */
     con = getConnection(1);
     con->private = (void *) apr_pcalloc(p,sizeof(struct ApacheOutpcon));
     con->text = FALSE; /* allows us to do binary writes */
     con->vfprintf = mr_stdout_vfprintf;
     con->write = mr_stdout_write;
     con->fflush = mr_stdout_fflush;

     ...

And here are the definitions of the mr_* functions:

int mr_stdout_vfprintf(Rconnection con, const char *format, va_list ap){
     RApacheOutpcon this = con->private;
     apr_status_t rv;
     rv = apr_brigade_vprintf(this->brigade, ap_filter_flush, 
this->filter, format, ap);
     return (rv == APR_SUCCESS)? 0 : 1;
}
int mr_stdout_fflush(Rconnection con){
     RApacheOutpcon this = con->private;
     ap_filter_flush(this->brigade,this->filter);
     /* still need a return value */
}
size_t mr_stdout_write(const void *ptr, size_t size, size_t n, 
Rconnection con){
     RApacheOutpcon this = con->private;
     apr_status_t rv;
     rv = apr_brigade_write(this->brigade, ap_filter_flush, 
this->filter, (const char *)ptr, size*n);
     return (rv == APR_SUCCESS)? n : 1;
}

(stdin and stderr can be altered in a similar manner, but they not shown).

  And with that, it's easy to implement simple code to write data to the 
web browser in various formats:

dataprovider <- function(r){

     args <- apache.get_args(r);
     con <- dbConnect(dbDriver("MySQL"),dbname=db)
     d <- dbGetQuery(con,"select * from table")

     if (is.null(args$format)){
         apache.set_content_type(r,"text/html")
         if (length(d)>1)
             HTML(d,file=stdout()) # from R2HTML
         else
             cat("<H1>Empty</H1>")
     } else if (args$format == 'csv'){
             apache.set_content_type(r,"text/csv")
             write.csv(d)
     } else if (args$format == 'xml'){
             apache.set_content_type(r,"text/xml")
             writeSDML(d)          # from StatDataML
     } else if (args$format == 'rds'){
             apache.set_content_type(r,'application/octet-stream')
             save(d,file=stdout()) # yes, even this works
     }

     dbDisconnect(con)
     OK
}

And of course the output of the above can either be sent to the browser 
or even to an interactive R session like this:

load(url("http://example.com/dataprovider?format=rds"))

or this via StatDataML

d <- readSDML(file="http://example.com/dataprovider?format=xml")

or this via read.csv

d <- read.csv(file=url("http://example.com/dataprovider?format=csv")


Of course there are other ways to accomplish this, like allowing c code 
to place c generated connection objects onto the Connection array and 
then use sink(), but that only works for stdout. Another way is to 
enhance the default stdin, stdout, stderr reading and writing routines 
to test for the existence of user provided routines, similar to the way 
stdout_vfprintf tests R_Outputfile.

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner



From duncan at wald.ucdavis.edu  Sun Oct  8 00:34:29 2006
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Sat, 07 Oct 2006 15:34:29 -0700
Subject: [Rd] Request to open up getConnection to embedded interface
In-Reply-To: <45280F52.8010704@vanderbilt.edu>
References: <45280F52.8010704@vanderbilt.edu>
Message-ID: <45282B75.8070902@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Hi Jeff

  Robert Gentleman and I were just conversing about the need to
make connections part of the general API in some way, be it
as they are now or slightly changed.  It is not just for
the embedded case, but for packages also that we need to be
able to access them from C code and even extend them.
For me, the RCurl and Rcompression packages on omegahat.org
are two clear cases of unnecessarily constrained and complex code.

We need to make much of core R system extensible
at the package level rather than only allowing it to be done
at the R-level.

 So this is on the list of things to do.

  D.



Jeffrey Horner wrote:
> Hello all,
> 
> I would like to request that getConnection() and the struct Rconn 
> declarations be added to the R embedded interface. Here's why.
> 
> It's common in CGI scripts for web applications to direct stdin, stdout, 
> and stderr map to reading from the browser, writing to the browser, and 
> writing to a web log file respectively; very nice and neat. However, 
> things get a little hairy once language interpreters are embedded into 
> web servers.
> 
> For modules like RApache, there are Apache api calls that govern how to 
>   read/write from/to the browser so simple redirection is not feasible.
> 
> With the above request, here is how RApache can alter stdout's behavior:
> 
>      ...
> 
>      Rf_initEmbeddedR(argc, argv); /* initialize R */
> 
> 
>      /* Redirect stdout to apache specific routines */
>      con = getConnection(1);
>      con->private = (void *) apr_pcalloc(p,sizeof(struct ApacheOutpcon));
>      con->text = FALSE; /* allows us to do binary writes */
>      con->vfprintf = mr_stdout_vfprintf;
>      con->write = mr_stdout_write;
>      con->fflush = mr_stdout_fflush;
> 
>      ...
> 
> And here are the definitions of the mr_* functions:
> 
> int mr_stdout_vfprintf(Rconnection con, const char *format, va_list ap){
>      RApacheOutpcon this = con->private;
>      apr_status_t rv;
>      rv = apr_brigade_vprintf(this->brigade, ap_filter_flush, 
> this->filter, format, ap);
>      return (rv == APR_SUCCESS)? 0 : 1;
> }
> int mr_stdout_fflush(Rconnection con){
>      RApacheOutpcon this = con->private;
>      ap_filter_flush(this->brigade,this->filter);
>      /* still need a return value */
> }
> size_t mr_stdout_write(const void *ptr, size_t size, size_t n, 
> Rconnection con){
>      RApacheOutpcon this = con->private;
>      apr_status_t rv;
>      rv = apr_brigade_write(this->brigade, ap_filter_flush, 
> this->filter, (const char *)ptr, size*n);
>      return (rv == APR_SUCCESS)? n : 1;
> }
> 
> (stdin and stderr can be altered in a similar manner, but they not shown).
> 
>   And with that, it's easy to implement simple code to write data to the 
> web browser in various formats:
> 
> dataprovider <- function(r){
> 
>      args <- apache.get_args(r);
>      con <- dbConnect(dbDriver("MySQL"),dbname=db)
>      d <- dbGetQuery(con,"select * from table")
> 
>      if (is.null(args$format)){
>          apache.set_content_type(r,"text/html")
>          if (length(d)>1)
>              HTML(d,file=stdout()) # from R2HTML
>          else
>              cat("<H1>Empty</H1>")
>      } else if (args$format == 'csv'){
>              apache.set_content_type(r,"text/csv")
>              write.csv(d)
>      } else if (args$format == 'xml'){
>              apache.set_content_type(r,"text/xml")
>              writeSDML(d)          # from StatDataML
>      } else if (args$format == 'rds'){
>              apache.set_content_type(r,'application/octet-stream')
>              save(d,file=stdout()) # yes, even this works
>      }
> 
>      dbDisconnect(con)
>      OK
> }
> 
> And of course the output of the above can either be sent to the browser 
> or even to an interactive R session like this:
> 
> load(url("http://example.com/dataprovider?format=rds"))
> 
> or this via StatDataML
> 
> d <- readSDML(file="http://example.com/dataprovider?format=xml")
> 
> or this via read.csv
> 
> d <- read.csv(file=url("http://example.com/dataprovider?format=csv")
> 
> 
> Of course there are other ways to accomplish this, like allowing c code 
> to place c generated connection objects onto the Connection array and 
> then use sink(), but that only works for stdout. Another way is to 
> enhance the default stdin, stdout, stderr reading and writing routines 
> to test for the existence of user provided routines, similar to the way 
> stdout_vfprintf tests R_Outputfile.
> 
> Jeff

- --
Duncan Temple Lang                    duncan at wald.ucdavis.edu
Department of Statistics              work:  (530) 752-4782
4210 Mathematical Sciences Building   fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis,
CA 95616,
USA
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (Darwin)

iD8DBQFFKCt19p/Jzwa2QP4RAqLkAJ47ztIGE2e8ZWiLEuCEUUq4XnqP8ACfZxtN
Teu5CpGmoMXfNVwMs6lw8HQ=
=n4LI
-----END PGP SIGNATURE-----



From jeff.horner at vanderbilt.edu  Sun Oct  8 01:03:19 2006
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Sat, 07 Oct 2006 18:03:19 -0500
Subject: [Rd] Request to open up getConnection to embedded interface
In-Reply-To: <45282B75.8070902@wald.ucdavis.edu>
References: <45280F52.8010704@vanderbilt.edu>
	<45282B75.8070902@wald.ucdavis.edu>
Message-ID: <45283237.9010107@vanderbilt.edu>

Duncan Temple Lang wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> 
> Hi Jeff
> 
>   Robert Gentleman and I were just conversing about the need to
> make connections part of the general API in some way, be it
> as they are now or slightly changed.  It is not just for
> the embedded case, but for packages also that we need to be
> able to access them from C code and even extend them.
> For me, the RCurl and Rcompression packages on omegahat.org
> are two clear cases of unnecessarily constrained and complex code.
> 
> We need to make much of core R system extensible
> at the package level rather than only allowing it to be done
> at the R-level.
> 
>  So this is on the list of things to do.

Excellent! The sooner the better. My interests are in the connections, 
serialization and compression stuff. I'd like to help in any way from 
documentation to debugging to coding, whatever...

Jeff
--
http://biostat.mc.vanderbilt.edu/JeffreyHorner



From p.dalgaard at biostat.ku.dk  Sun Oct  8 13:05:34 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 08 Oct 2006 13:05:34 +0200
Subject: [Rd] [R] [R-pkg] New packages pmg, gWidgets, gWidgetsRGtk2
In-Reply-To: <x2k63bytcs.fsf@turmalin.kubism.ku.dk>
References: <576452c40610060739i4a2bf2ccj3763683f31608db2@mail.gmail.com>
	<971536df0610060926s34e95924y4b84c141cc9586a7@mail.gmail.com>
	<8764ewjnpi.fsf@wiener.math.csi.cuny.edu>
	<x2k63bytcs.fsf@turmalin.kubism.ku.dk>
Message-ID: <x2fydzysn5.fsf@turmalin.kubism.ku.dk>

Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:

> verzani at math.csi.cuny.edu writes:
> 
> > Finally, for some reason I'm trying to track down, under Windows, pmg
> > is crashing when a cairoDevice graphics device is being closed. This
> > affects the plotnotebook and the Lattice Explorer. I have an update to
> > gWidgetsRGtk2 that may fix it, but I haven't had a chance to fully
> > test it. It can be installed with
> 
> This appears not to be Windows-specific. I see it on Fedora Core 5
> too:
> 
> > plot(x = ashina$vas.active, y = ashina$vas.plac, type = "p",
> +     pch = 1, col = ashina$grp)
> 
>  *** caught segfault ***
> address 0xfc, cause 'memory not mapped'
> 
> Traceback:
>  1: dev.off(h$obj at device)
>  2: handler(...)
>  3: function (...) {    handler(...)    return(TRUE)}(list(obj = <S4
>  object of class "gGraphicsRGtk">, action = NULL),     <pointer:
>  0xc327a60>)
> 
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> 
> (2.4.0 Patched, upon closing the plotnotebook)

Followup:

gdb says 

#0  0x080e7910 in Rf_KillDevice (dd=0x8287fc0)
    at ../../../R/src/main/graphics.c:4814
4814        ((GEDevDesc*) dd)->dev->close(((GEDevDesc*) dd)->dev);
(gdb) p ((GEDevDesc*) dd)->dev
$1 = (NewDevDesc *) 0x0
(gdb) bt
#0  0x080e7910 in Rf_KillDevice (dd=0x8287fc0)
    at ../../../R/src/main/graphics.c:4814
#1  0x002202da in kill_cairo (dd=Variable "dd" is not available.
) at cairoDevice.c:197
#2  0x00db21d9 in g_cclosure_marshal_VOID__VOID ()
   from /usr/lib/libgobject-2.0.so.0
#3  0x00da4f8b in g_closure_invoke () from
    /usr/lib/libgobject-2.0.so.0
#4  0x00db5e3d in g_signal_override_class_closure ()
   from /usr/lib/libgobject-2.0.so.0
#5  0x00db7347 in g_signal_emit_valist () from
    /usr/lib/libgobject-2.0.so.0
#6  0x00db7509 in g_signal_emit () from /usr/lib/libgobject-2.0.so.0
#7  0x010e7761 in gtk_object_destroy () from
    /usr/lib/libgtk-x11-2.0.so.0
#8  0x011bde61 in gtk_widget_hide () from /usr/lib/libgtk-x11-2.0.so.0
#9  0x00da7600 in g_object_run_dispose () from
    /usr/lib/libgobject-2.0.so.0
#10 0x010e756e in gtk_object_destroy () from
    /usr/lib/libgtk-x11-2.0.so.0
#11 0x011be045 in gtk_widget_destroy () from
    /usr/lib/libgtk-x11-2.0.so.0
#12 0x00222258 in freeCairoDesc (dd=0xc45cfd8) at cairoDevice.c:22
#13 0x0022253d in Cairo_Close (dd=0xc45cfd8) at cairoDevice.c:550
#14 0x080e78a3 in Rf_killDevice (devNum=1)
    at ../../../R/src/main/graphics.c:4826
#15 0x08121c3f in do_devoff (call=0xbbb3c2c, op=0x9c96c28,
    args=0xbbb32b8,
    env=0xbbb3d44) at ../../../R/src/main/plot.c:132
#....

I'm a bit clueless regarding gtk, but it looks like a reentrancy
issue, with a signal trying to close the device while it is already
in the process of being closed. 

(CC moved to r-devel)

        -p

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From verzani at math.csi.cuny.edu  Sun Oct  8 23:22:15 2006
From: verzani at math.csi.cuny.edu (John Verzani)
Date: Sun, 8 Oct 2006 17:22:15 -0400 (EDT)
Subject: [Rd] [R] [R-pkg] New packages pmg, gWidgets, gWidgetsRGtk2
In-Reply-To: <x2fydzysn5.fsf@turmalin.kubism.ku.dk>
References: <576452c40610060739i4a2bf2ccj3763683f31608db2@mail.gmail.com>
	<971536df0610060926s34e95924y4b84c141cc9586a7@mail.gmail.com>
	<8764ewjnpi.fsf@wiener.math.csi.cuny.edu>
	<x2k63bytcs.fsf@turmalin.kubism.ku.dk>
	<x2fydzysn5.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.58.0610081721020.9060@wiener.math.csi.cuny.edu>

Dear Peter,

Thanks. I think I fixed it. I was using an old version of cairoDevice so 
wasn't seeing the issue. I uploaded a new version of gWidgetsRGtk2 to CRAN 
and hopefully that fixes the issue.

Best,

John

On Sun, 8 Oct 2006, Peter Dalgaard wrote:

> Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
> 
> > verzani at math.csi.cuny.edu writes:
> > 
> > > Finally, for some reason I'm trying to track down, under Windows, pmg
> > > is crashing when a cairoDevice graphics device is being closed. This
> > > affects the plotnotebook and the Lattice Explorer. I have an update to
> > > gWidgetsRGtk2 that may fix it, but I haven't had a chance to fully
> > > test it. It can be installed with
> > 
> > This appears not to be Windows-specific. I see it on Fedora Core 5
> > too:
> > 
> > > plot(x = ashina$vas.active, y = ashina$vas.plac, type = "p",
> > +     pch = 1, col = ashina$grp)
> > 
> >  *** caught segfault ***
> > address 0xfc, cause 'memory not mapped'
> > 
> > Traceback:
> >  1: dev.off(h$obj at device)
> >  2: handler(...)
> >  3: function (...) {    handler(...)    return(TRUE)}(list(obj = <S4
> >  object of class "gGraphicsRGtk">, action = NULL),     <pointer:
> >  0xc327a60>)
> > 
> > Possible actions:
> > 1: abort (with core dump)
> > 2: normal R exit
> > 3: exit R without saving workspace
> > 4: exit R saving workspace
> > 
> > (2.4.0 Patched, upon closing the plotnotebook)
> 
> Followup:
> 
> gdb says 
> 
> #0  0x080e7910 in Rf_KillDevice (dd=0x8287fc0)
>     at ../../../R/src/main/graphics.c:4814
> 4814        ((GEDevDesc*) dd)->dev->close(((GEDevDesc*) dd)->dev);
> (gdb) p ((GEDevDesc*) dd)->dev
> $1 = (NewDevDesc *) 0x0
> (gdb) bt
> #0  0x080e7910 in Rf_KillDevice (dd=0x8287fc0)
>     at ../../../R/src/main/graphics.c:4814
> #1  0x002202da in kill_cairo (dd=Variable "dd" is not available.
> ) at cairoDevice.c:197
> #2  0x00db21d9 in g_cclosure_marshal_VOID__VOID ()
>    from /usr/lib/libgobject-2.0.so.0
> #3  0x00da4f8b in g_closure_invoke () from
>     /usr/lib/libgobject-2.0.so.0
> #4  0x00db5e3d in g_signal_override_class_closure ()
>    from /usr/lib/libgobject-2.0.so.0
> #5  0x00db7347 in g_signal_emit_valist () from
>     /usr/lib/libgobject-2.0.so.0
> #6  0x00db7509 in g_signal_emit () from /usr/lib/libgobject-2.0.so.0
> #7  0x010e7761 in gtk_object_destroy () from
>     /usr/lib/libgtk-x11-2.0.so.0
> #8  0x011bde61 in gtk_widget_hide () from /usr/lib/libgtk-x11-2.0.so.0
> #9  0x00da7600 in g_object_run_dispose () from
>     /usr/lib/libgobject-2.0.so.0
> #10 0x010e756e in gtk_object_destroy () from
>     /usr/lib/libgtk-x11-2.0.so.0
> #11 0x011be045 in gtk_widget_destroy () from
>     /usr/lib/libgtk-x11-2.0.so.0
> #12 0x00222258 in freeCairoDesc (dd=0xc45cfd8) at cairoDevice.c:22
> #13 0x0022253d in Cairo_Close (dd=0xc45cfd8) at cairoDevice.c:550
> #14 0x080e78a3 in Rf_killDevice (devNum=1)
>     at ../../../R/src/main/graphics.c:4826
> #15 0x08121c3f in do_devoff (call=0xbbb3c2c, op=0x9c96c28,
>     args=0xbbb32b8,
>     env=0xbbb3d44) at ../../../R/src/main/plot.c:132
> #....
> 
> I'm a bit clueless regarding gtk, but it looks like a reentrancy
> issue, with a signal trying to close the device while it is already
> in the process of being closed. 
> 
> (CC moved to r-devel)
> 
>         -p
> 
> -- 
>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>



From usa90100 at gmail.com  Mon Oct  9 12:44:10 2006
From: usa90100 at gmail.com (usa90100 at gmail.com)
Date: Mon,  9 Oct 2006 12:44:10 +0200 (CEST)
Subject: [Rd] Italian Wine Tour (PR#9281)
Message-ID: <20061009104410.1034CC109@slim.kubism.ku.dk>


--Boundary_(ID_6VG5ntkkKoC/+iJCJpG2RQ)
Content-type: text/plain; charset=windows-1252
Content-transfer-encoding: 7BIT



usa90100 at gmail.com

--Boundary_(ID_6VG5ntkkKoC/+iJCJpG2RQ)
Content-type: text/html; charset=windows-1252
Content-transfer-encoding: 7BIT


--Boundary_(ID_6VG5ntkkKoC/+iJCJpG2RQ)--



From imosqueira at suk.azti.es  Mon Oct  9 14:07:35 2006
From: imosqueira at suk.azti.es (Iago Mosqueira)
Date: Mon, 09 Oct 2006 14:07:35 +0200
Subject: [Rd] Default argument value for "["
In-Reply-To: <45266553.2050403@r-project.org>
References: <mailman.9.1159956004.28879.r-devel@r-project.org>
	<1159957901.14595.24.camel@localhost.localdomain>
	<4523BC95.6010505@r-project.org>
	<1159974834.14595.41.camel@localhost.localdomain>
	<45266553.2050403@r-project.org>
Message-ID: <1160395656.5615.46.camel@localhost.localdomain>

El vie, 06-10-2006 a las 10:16 -0400, John Chambers escribi?:
> Should now be fixed in r-devel and 2.4 patched.

Hi,

I am now working with R-devel. I am finding this problem with the same
code. When the package is installed and loaded, '[' fails with

> ple4 at catch[,1]
Error: subindex out of limits
Erro en FLQuant(x at .Data[i, j, k, l, m, drop = FALSE]) : 
        error in evaluating the argument 'object' in selecting a method
for function 'FLQuant'

but if I redefine the method by sourcing the same code inside the
session, it works fine. Calling getMethod('[','FLQuant') before and
after this operation shows no difference.

> getMethod('[','FLQuant')
Method Definition:

function (x, i = "missing", j = "missing", ..., drop = FALSE) 
{
    .local <- function (x, i = "missing", j = "missing", k = "missing", 
        l = "missing", m = "missing", ..., drop = FALSE) 
    {
        if (missing(i)) 
            i <- seq(1, length(dimnames(x at .Data)[1][[1]]))
        if (missing(j)) 
            j <- dimnames(x at .Data)[2][[1]]
        if (missing(k)) 
            k <- dimnames(x at .Data)[3][[1]]
        if (missing(l)) 
            l <- dimnames(x at .Data)[4][[1]]
        if (missing(m)) 
            m <- dimnames(x at .Data)[5][[1]]
        if (drop == FALSE) {
            flq <- FLQuant(x at .Data[i, j, k, l, m, drop = FALSE])
            units(flq) <- units(x)
            quant(flq) <- quant(x)
        }
        else flq <- x at .Data[i, j, k, l, m, ..., drop = TRUE]
        return(flq)
    }
    .local(x, i, j, ..., drop = drop)
}

Signatures:
        x        
target  "FLQuant"
defined "FLQuant"

Any idea where the problem might originate?

Thanks,


Iago




> Iago Mosqueira wrote: 
> > El mi?, 04-10-2006 a las 09:52 -0400, John Chambers escribi?:
> >   
> > > I think the problem in your case comes from the mechanism used to handle 
> > > non-standard argument lists; notice that you have added 3 new 
> > > arguments.
> > >     
> > 
> > Yes, our object is always 5 dimensional. We could use (...) but it
> > looked overly complex.
> > 
> >   
> > >   If you look at the body of the resulting method you will see 
> > > that the mechanism used to handle this (defining a function .local) 
> > > fails to copy the default value from the method, as in the simpler 
> > > example below:
> > > 
> > >  > setMethod("[", c("mm"), function(x, i, j, k..., drop=FALSE)browser())
> > > [1] "["
> > >  > selectMethod("[", "mm")
> > > Method Definition:
> > > 
> > > function (x, i, j, ..., drop = TRUE)
> > > {
> > >     .local <- function (x, i, j, k..., drop = FALSE)
> > >     browser()
> > >     .local(x, i, j, ..., drop = drop)
> > > }
> > > 
> > > 
> > > We can probably fix this.  Meanwhile, the workaround is to use the same 
> > > mechanism yourself, but get the  default value right.  Define your 
> > > method as a function (like the .local you see when printing the current 
> > > method) and then define a method with the formally correct arguments 
> > > (function(x, i, j, ..., drop=FALSE)) and call your function from that 
> > > method.
> > >     
> > 
> > OK, many thanks.
> > 
> >   
> > > Beware there is _another_ related "bug":  if you use callNextMethod(), 
> > > it does not seem to copy the default value of drop= either.  (It's a bit 
> > > more debatable what callNextMethod() with no arguments should do in this 
> > > case, so the problem here may be an "undesired feature" rather than a 
> > > bug.)  You didn't show your real method, so this may not apply in your 
> > > example.
> > >     
> > 
> > I am adding the whole method below, but I do not thing this applies as
> > it is currently written.
> > 
> >   
> > > By the way, I would be a little surprised if this had anything to do 
> > > with changes in 2.4.0, at least those I'm aware of.
> > >     
> > 
> > This maybe the case, but it was working fine in 2.3.1.
> > 
> > Cheers,
> > 
> > 
> > Iago
> > 
> > setMethod("[", signature(x="FLQuant"),
> > 	function(x, i="missing", j="missing", k="missing", l="missing",
> > m="missing",
> > 		..., drop=FALSE) {
> > 
> > 		if (missing(i))
> > 			#i  <-  dimnames(x at .Data)[1][[1]]
> > 			i  <-  seq(1, length(dimnames(x at .Data)[1][[1]]))
> > 		if (missing(j))
> > 			j  <-  dimnames(x at .Data)[2][[1]]
> >    		if (missing(k))
> >    			k  <-  dimnames(x at .Data)[3][[1]]
> > 		if (missing(l))
> > 			l  <-  dimnames(x at .Data)[4][[1]]
> > 		if (missing(m))
> > 			m  <-  dimnames(x at .Data)[5][[1]]
> > 
> >    		if (!drop) {
> > 	  		flq	 <- FLQuant(x at .Data[i, j, k, l, m, drop=FALSE])
> > 			units(flq) <- units(x)
> > 			quant(flq) <- quant(x)
> > 		}
> > 		else if(drop)
> >              flq  <- x at .Data[i, j, k, l, m, ..., drop=TRUE]
> > 
> >    		return(flq)
> > 	}
> > )
> > 
> > 
> >   
> > > Iago Mosqueira wrote:
> > >     
> > > > Dear all,
> > > > 
> > > > After installing R 2.4.0, a definition of "[" for an S4 class has
> > > > stopped working as the default for drop in the generic, TRUE, appears to
> > > > override the default in the method
> > > > 
> > > > The method is defined for demonstration purposes as
> > > > 
> > > > setMethod("[", signature(x="FLQuant"),
> > > > 	function(x, i="missing", j="missing", k="missing", l="missing",
> > > > 		m="missing", ..., drop=FALSE) {
> > > > 
> > > > 		print(drop)
> > > > 	}
> > > > )
> > > > 
> > > > When called as
> > > > 
> > > > new('FLQuant')[1,]
> > > > 
> > > > drop is TRUE, instead of FALSE. Am I missing something? Has there been a
> > > > change in R 2.4.0 of relevance here? I could not find it in the NEWS
> > > > file.
> > > > 
> > > > Many thanks,
> > > > 
> > > > 
> > > > Iago Mosqueira



From ehlers at c3sl.ufpr.br  Mon Oct  9 14:56:55 2006
From: ehlers at c3sl.ufpr.br (ehlers at c3sl.ufpr.br)
Date: Mon,  9 Oct 2006 14:56:55 +0200 (CEST)
Subject: [Rd] dump (PR#9282)
Message-ID: <20061009125655.D229F3F02C@slim.kubism.ku.dk>

Full_Name: Ricardo Ehlers
Version: 2.4.0
OS: Linux
Submission from: (NULL) (200.138.34.134)


The dump function is outputing something different from previous versions. For
example

> a <- c(1,2,3); dump('a',file='test')

now results in `a` <- c(1,2) instead of "a" <- c(1,2) in the file 'test'

This prevents using the bayesmix package and running JAGS from within R in an
automatic fashion.



From ripley at stats.ox.ac.uk  Mon Oct  9 15:52:46 2006
From: ripley at stats.ox.ac.uk (Brian Ripley)
Date: Mon, 9 Oct 2006 14:52:46 +0100 (BST)
Subject: [Rd] dump (PR#9282)
In-Reply-To: <20061009125655.D229F3F02C@slim.kubism.ku.dk>
References: <20061009125655.D229F3F02C@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0610091450400.29440@auk.stats>

This is not an error in R: the later format is more correct R.  Those 
packages have made unwarranted assumptions about the format produced by 
dump(), so please reports bugs in them to their maintainers.

On Mon, 9 Oct 2006, ehlers at c3sl.ufpr.br wrote:

> Full_Name: Ricardo Ehlers
> Version: 2.4.0
> OS: Linux
> Submission from: (NULL) (200.138.34.134)
>
>
> The dump function is outputing something different from previous versions. For
> example
>
>> a <- c(1,2,3); dump('a',file='test')
>
> now results in `a` <- c(1,2) instead of "a" <- c(1,2) in the file 'test'
>
> This prevents using the bayesmix package and running JAGS from within R in an
> automatic fashion.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ripley at stats.ox.ac.uk  Mon Oct  9 17:18:13 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 9 Oct 2006 16:18:13 +0100 (BST)
Subject: [Rd] operator :: and symbols not in the namespace of a package
 with a namespace
In-Reply-To: <Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>
References: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
	<45265A8A.6060505@stats.uwo.ca>
	<Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>
Message-ID: <Pine.LNX.4.64.0610091611110.17674@gannet.stats.ox.ac.uk>

On Fri, 6 Oct 2006, Luke Tierney wrote:

> On Fri, 6 Oct 2006, Duncan Murdoch wrote:
>
>> On 10/6/2006 9:05 AM, thomas.friedrichsmeier at rub.de wrote:
>>> Full_Name: Thomas Friedrichsmeier
>>> Version: 2.4.0
>>> OS: GNU/Linux
>>> Submission from: (NULL) (84.61.116.51)
>>>
>>>
>>> Since R 2.4.0, operator "::" also returns objects in the package environment, if
>>> the package does not have a namespace. This is a very welcome addition.
>>>
>>> Additional wish:
>>> If a package has a namespace, but does not place all symbols in that namespace,
>>> lookup will still fail. For example in package boot (version 1.2-26):
>>>
>>> library (boot)
>>> exists ("motor", envir=as.environment ("package:boot"))   # TRUE
>>> getAnywhere ("motor")                                     # found in
>>> package:boot
>>> boot::motor                                               # error not in
>>> namespace
>>>
>>> This is as documented, but I think it would be convenient, if boot::motor would
>>> also return the object in this case.
>>
>> At first I was ready to disagree with you, telling you to use the ":::"
>> operator for something that is not exported:  but in fact motor is a
>> dataset, so it is exported from the package by being loaded into the
>> package environment when the package is loaded.  I agree that the "::"
>> operator should find it.
>
> It might be a good idea to rethink the decision to have data be
> handled specially instead of having data sets be treated as ordinary
> exported variables.  There may be a good reason for doing what we do
> now but I don't know what it is.  If there really is a good reason to
> continue this then maybe we should think about this addition.  It
> doesn't feel like the right thing to do but may be harmless.

The reason was (and is) that if datasets are in the namespace, functions 
in the namespace find them ahead of a dataset of the same name in the 
user's workspace.  (This broke the MASS scripts, for example, and also 
affects car.)  (We do have a mechanism to put system datasets in the 
namespace where this is the desired behaviour, but it seems uncommon.)  I 
really don't fancy explaining to our beginning students that when they are 
asked to correct some entries in a dataset some functions will see the 
corrected version and some the original if they just use fix().

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From luke at stat.uiowa.edu  Mon Oct  9 17:33:12 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon, 9 Oct 2006 10:33:12 -0500 (CDT)
Subject: [Rd] operator :: and symbols not in the namespace of a package
 with a namespace
In-Reply-To: <Pine.LNX.4.64.0610091611110.17674@gannet.stats.ox.ac.uk>
References: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
	<45265A8A.6060505@stats.uwo.ca>
	<Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>
	<Pine.LNX.4.64.0610091611110.17674@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0610091032220.18405@nokomis.stat.uiowa.edu>

On Mon, 9 Oct 2006, Prof Brian Ripley wrote:

> On Fri, 6 Oct 2006, Luke Tierney wrote:
>
>> On Fri, 6 Oct 2006, Duncan Murdoch wrote:
>> 
>>> On 10/6/2006 9:05 AM, thomas.friedrichsmeier at rub.de wrote:
>>>> Full_Name: Thomas Friedrichsmeier
>>>> Version: 2.4.0
>>>> OS: GNU/Linux
>>>> Submission from: (NULL) (84.61.116.51)
>>>> 
>>>> 
>>>> Since R 2.4.0, operator "::" also returns objects in the package 
>>>> environment, if
>>>> the package does not have a namespace. This is a very welcome addition.
>>>> 
>>>> Additional wish:
>>>> If a package has a namespace, but does not place all symbols in that 
>>>> namespace,
>>>> lookup will still fail. For example in package boot (version 1.2-26):
>>>> 
>>>> library (boot)
>>>> exists ("motor", envir=as.environment ("package:boot"))   # TRUE
>>>> getAnywhere ("motor")                                     # found in
>>>> package:boot
>>>> boot::motor                                               # error not in
>>>> namespace
>>>> 
>>>> This is as documented, but I think it would be convenient, if boot::motor 
>>>> would
>>>> also return the object in this case.
>>> 
>>> At first I was ready to disagree with you, telling you to use the ":::"
>>> operator for something that is not exported:  but in fact motor is a
>>> dataset, so it is exported from the package by being loaded into the
>>> package environment when the package is loaded.  I agree that the "::"
>>> operator should find it.
>> 
>> It might be a good idea to rethink the decision to have data be
>> handled specially instead of having data sets be treated as ordinary
>> exported variables.  There may be a good reason for doing what we do
>> now but I don't know what it is.  If there really is a good reason to
>> continue this then maybe we should think about this addition.  It
>> doesn't feel like the right thing to do but may be harmless.
>
> The reason was (and is) that if datasets are in the namespace, functions in 
> the namespace find them ahead of a dataset of the same name in the user's 
> workspace.  (This broke the MASS scripts, for example, and also affects car.) 
> (We do have a mechanism to put system datasets in the namespace where this is 
> the desired behaviour, but it seems uncommon.)  I really don't fancy 
> explaining to our beginning students that when they are asked to correct some 
> entries in a dataset some functions will see the corrected version and some 
> the original if they just use fix().

This behavior does not seem desireable. Can you give specific
examples?

Best,

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From ggrothendieck at gmail.com  Mon Oct  9 17:46:51 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 9 Oct 2006 11:46:51 -0400
Subject: [Rd] Where to put sgml file
Message-ID: <971536df0610090846y23b40eadq823be5265db40857@mail.gmail.com>

I have a package that will have an sgml file.  One of the demos in ./demo
will use it.  Where should I put it?

I tried putting it in ./demo but it did not survive the build so
currently I put it in ./inst and it gets copied to the same level as the
DESCRIPTION file and the demo gets it from there.  Is that right or
is there a better choice?  I assume I can't use ./data since its not in
the form that is directly readable as an R data file.



From Roger.Bivand at nhh.no  Mon Oct  9 17:59:24 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 9 Oct 2006 17:59:24 +0200 (CEST)
Subject: [Rd] Where to put sgml file
In-Reply-To: <971536df0610090846y23b40eadq823be5265db40857@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0610091757441.19518-100000@reclus.nhh.no>

On Mon, 9 Oct 2006, Gabor Grothendieck wrote:

> I have a package that will have an sgml file.  One of the demos in ./demo
> will use it.  Where should I put it?
> 
> I tried putting it in ./demo but it did not survive the build so
> currently I put it in ./inst and it gets copied to the same level as the
> DESCRIPTION file and the demo gets it from there.  Is that right or
> is there a better choice?  I assume I can't use ./data since its not in
> the form that is directly readable as an R data file.

Perhaps add a folder to ./inst, and put the file there. You can always get 
to it with system.file(). 

> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From friedrich.leisch at stat.uni-muenchen.de  Mon Oct  9 18:08:05 2006
From: friedrich.leisch at stat.uni-muenchen.de (Friedrich Leisch)
Date: Mon, 9 Oct 2006 18:08:05 +0200
Subject: [Rd] Where to put sgml file
In-Reply-To: <971536df0610090846y23b40eadq823be5265db40857@mail.gmail.com>
References: <971536df0610090846y23b40eadq823be5265db40857@mail.gmail.com>
Message-ID: <17706.29669.958145.312621@lxh5.stat.uni-muenchen.de>

>>>>> On Mon, 9 Oct 2006 11:46:51 -0400,
>>>>> Gabor Grothendieck (GG) wrote:

  > I have a package that will have an sgml file.  One of the demos in ./demo
  > will use it.  Where should I put it?

  > I tried putting it in ./demo but it did not survive the build so
  > currently I put it in ./inst and it gets copied to the same level as the
  > DESCRIPTION file and the demo gets it from there.  Is that right or
  > is there a better choice?

I would probably use a directory "inst/sgml-files" (replace "sgml-files"
by your favorite name which is not already used by R like "data") and
place the file there. If it is a single file and no second file is on
the horizon, then putting it directly into "inst" is also OK.

  > I assume I can't use ./data since its not in
  > the form that is directly readable as an R data file.

exactly.

best,
fritz



From Robert.McGehee at geodecapital.com  Mon Oct  9 22:41:56 2006
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Mon, 9 Oct 2006 16:41:56 -0400
Subject: [Rd] Installing Rmpi on 64-bit Linux Athlon
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C946933@MSGBOSCLB2WIN.DMN1.FMR.COM>

Hello,
We have recently added a 64-bit 2 x Dual-Core Athlon server running Red
Hat Enterprise Linux AS release 3 to allow for processing of large data
sets (>4GB) in R. To integrate this server into our Linux cluster, I
have been trying (unsuccessfully) to use Rmpi/lam-mpi to parallel
process some of our scripts. While I have successfully compiled R 2.4.0
and lam-mpi 7.1.2 on this server using a 64-bit architecture, I have not
been able to install Rmpi to interface with lam-mpi, despite success on
nearly identical servers in a 32-bit architecture. When trying on the
64-bit server, I receive the error "cannot find -lmpi" during
compilation (see below). 

If anyone has had success in this regards and notice an installation
problem that I may have overlooked, I would greatly appreciate any
advice. Note that because I do not have root access, all of the lam-mpi
and R files were installed locally.

Thanks in advance,
Robert

### Below is configuration scripts for R, Lam-MPI and Rmpi:

setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"
setenv prefix "/home/a347549/local64"

### R 2.4.0 Configure
./configure --prefix=$prefix --with-x
--with-tcl-config="$prefix/lib/tclConfig.sh"
--with-tk-config="$prefix/lib/tkConfig.sh"
--with-blas="-L$builddir/ATLAS/lib/Linux_HAMMER64SSE2_4 -lptf77blas
-lpthread -latlas"

### Lam-MPI 7.1.2 Configure:
./configure --prefix=$prefix --enable-shared --disable-static
--without-romio --with-rsh="ssh -xq"

### Rmpi INSTALL
R CMD INSTALL Rmpi --configure-args="--with-mpi=$prefix --prefix=$prefix
CC=mpicc" -l $R_LIBS

* Installing *source* package 'Rmpi' ...
Try to find mpi.h ...
Found in /gcm/home/a347549/local64/include
Try to find libmpi or libmpich ...
checking for main in -lmpi... yes
Try to find liblam ...
checking for main in -llam... yes
checking for openpty in -lutil... yes
checking for main in -lpthread... yes
configure: creating ./config.status
config.status: creating src/Makevars
** libs
gcc -I/gcm/home/a347549/local64/lib64/R/include
-I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
-DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
-DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
-I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c RegQuery.c -o
RegQuery.o
gcc -I/gcm/home/a347549/local64/lib64/R/include
-I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
-DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
-DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
-I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c Rmpi.c -o Rmpi.o
gcc -I/gcm/home/a347549/local64/lib64/R/include
-I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
-DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
-DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
-I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c conversion.c -o
conversion.o
gcc -I/gcm/home/a347549/local64/lib64/R/include
-I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
-DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
-DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
-I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c internal.c -o
internal.o
gcc -shared -L/usr/local/lib64 -o Rmpi.so RegQuery.o Rmpi.o conversion.o
internal.o -lmpi -llam -lutil -lpthread   
/usr/bin/ld: cannot find -lmpi
collect2: ld returned 1 exit status
make: *** [Rmpi.so] Error 1
chmod: cannot access `/home/a347549/code/rlib64/Rmpi/libs/*': No such
file or directory
ERROR: compilation failed for package 'Rmpi'
** Removing '/home/a347549/code/rlib64/Rmpi'
[lwtc5.fmr.com/A347549] /home/a347549/code


############################################################
In addition, here is the output of Rmpi's config.log
############################################################

> cat config.log
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by configure, which was
generated by GNU Autoconf 2.59.  Invocation command line was

  $ ./configure --with-mpi=/gcm/home/a347549/local64
--prefix=/gcm/home/a347549/local64 CC=mpicc

## --------- ##
## Platform. ##
## --------- ##

hostname = lwtc5.fmr.com
uname -m = x86_64
uname -r = 2.6.9-34.0.1.ELsmp
uname -s = Linux
uname -v = #1 SMP Wed May 17 16:59:36 EDT 2006

/usr/bin/uname -p = unknown
/bin/uname -X     = unknown

/bin/arch              = x86_64
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
hostinfo               = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /home/a347549/local64/java/bin
PATH: /home/a347549/local64/tibrv/bin
PATH: /home/a347549/local64/ant/bin
PATH: /home/a347549/local64/bin
PATH: /usr/bin/X11
PATH: /home/a347549/bin
PATH: /home/a347549/local64/java/bin
PATH: /home/a347549/local64/tibrv/bin
PATH: /home/a347549/local64/ant/bin
PATH: /home/a347549/local64/bin
PATH: /usr/bin/X11
PATH: /home/a347549/bin
PATH: /usr/kerberos/bin
PATH: /usr/local/bin
PATH: /bin
PATH: /usr/bin
PATH: /usr/X11R6/bin
PATH: .
PATH: .


## ----------- ##
## Core tests. ##
## ----------- ##

configure:2944: checking for main in -lmpi
configure:2968: mpicc -o conftest    conftest.c -lmpi   >&5
configure:2974: $? = 0
configure:2978: test -z 
			 || test ! -s conftest.err
configure:2981: $? = 0
configure:2984: test -s conftest
configure:2987: $? = 0
configure:3000: result: yes
configure:3018: checking for main in -llam
configure:3042: mpicc -o conftest    conftest.c -llam   >&5
configure:3048: $? = 0
configure:3052: test -z 
			 || test ! -s conftest.err
configure:3055: $? = 0
configure:3058: test -s conftest
configure:3061: $? = 0
configure:3074: result: yes
configure:3086: checking for openpty in -lutil
configure:3116: mpicc -o conftest    conftest.c -lutil   >&5
configure:3122: $? = 0
configure:3126: test -z 
			 || test ! -s conftest.err
configure:3129: $? = 0
configure:3132: test -s conftest
configure:3135: $? = 0
configure:3148: result: yes
configure:3154: checking for main in -lpthread
configure:3178: mpicc -o conftest    conftest.c -lpthread   >&5
configure:3184: $? = 0
configure:3188: test -z 
			 || test ! -s conftest.err
configure:3191: $? = 0
configure:3194: test -s conftest
configure:3197: $? = 0
configure:3210: result: yes
configure:3352: creating ./config.status

## ---------------------- ##
## Running config.status. ##
## ---------------------- ##

This file was extended by config.status, which was
generated by GNU Autoconf 2.59.  Invocation command line was

  CONFIG_FILES    = 
  CONFIG_HEADERS  = 
  CONFIG_LINKS    = 
  CONFIG_COMMANDS = 
  $ ./config.status 

on lwtc5.fmr.com

config.status:635: creating src/Makevars

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_env_CC_set=set
ac_cv_env_CC_value=mpicc
ac_cv_env_CFLAGS_set=
ac_cv_env_CFLAGS_value=
ac_cv_env_CPPFLAGS_set=
ac_cv_env_CPPFLAGS_value=
ac_cv_env_CPP_set=
ac_cv_env_CPP_value=
ac_cv_env_LDFLAGS_set=
ac_cv_env_LDFLAGS_value=
ac_cv_env_build_alias_set=
ac_cv_env_build_alias_value=
ac_cv_env_host_alias_set=
ac_cv_env_host_alias_value=
ac_cv_env_target_alias_set=
ac_cv_env_target_alias_value=
ac_cv_lib_lam_main=yes
ac_cv_lib_mpi_main=yes
ac_cv_lib_pthread_main=yes
ac_cv_lib_util_openpty=yes

## ----------------- ##
## Output variables. ##
## ----------------- ##

CC='mpicc'
CFLAGS=''
CPP=''
CPPFLAGS=''
DEFS='-DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\"
-DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" '
ECHO_C=''
ECHO_N='-n'
ECHO_T=''
EGREP='grep -E'
EXEEXT=''
LDFLAGS=''
LIBOBJS=''
LIBS=''
LTLIBOBJS=''
OBJEXT=''
PACKAGE_BUGREPORT=''
PACKAGE_NAME=''
PACKAGE_STRING=''
PACKAGE_TARNAME=''
PACKAGE_VERSION=''
PATH_SEPARATOR=':'
PKG_CPPFLAGS='-I/gcm/home/a347549/local64/include -DMPI2'
PKG_LIBS='-lmpi -llam -lutil -lpthread'
SHELL='/bin/sh'
ac_ct_CC=''
bindir='${exec_prefix}/bin'
build_alias=''
datadir='${prefix}/share'
exec_prefix='${prefix}'
host_alias=''
includedir='${prefix}/include'
infodir='${prefix}/info'
libdir='${exec_prefix}/lib'
libexecdir='${exec_prefix}/libexec'
localstatedir='${prefix}/var'
mandir='${prefix}/man'
oldincludedir='/usr/include'
prefix='/gcm/home/a347549/local64'
program_transform_name='s,x,x,'
sbindir='${exec_prefix}/sbin'
sharedstatedir='${prefix}/com'
sysconfdir='${prefix}/etc'
target_alias=''

## ----------- ##
## confdefs.h. ##
## ----------- ##

#define PACKAGE_BUGREPORT ""
#define PACKAGE_NAME ""
#define PACKAGE_STRING ""
#define PACKAGE_TARNAME ""
#define PACKAGE_VERSION ""

configure: exit 0



Robert McGehee
Quantitative Analyst
Geode Capital Management, LLC
53 State Street, 5th Floor | Boston, MA | 02109
Tel: 617/392-8396    Fax:617/476-6389
mailto:robert.mcgehee at geodecapital.com



This e-mail, and any attachments hereto, are intended for us...{{dropped}}



From JLewis at wyeth.com  Mon Oct  9 23:26:29 2006
From: JLewis at wyeth.com (JLewis at wyeth.com)
Date: Mon,  9 Oct 2006 23:26:29 +0200 (CEST)
Subject: [Rd] header containing (PR#9171)
Message-ID: <20061009212629.EE4014BE99@slim.kubism.ku.dk>

Another example where the "Warning message: full precision was not
achieved in 'pnt'" is given is
  qt(.95,15,12)
which returns the value 17.631800001788577 in R2.4.0.  By symmetry,
this value should be identical to
  -qt(.05,15,-12)
which returns without warning the value 17.6318000017885623 in R2.4.0. 
To full DP precision, I believe that qt(.95,15,12) and -qt(.05,15,-12)
should be 17.631800001755318 (verified using the Maple
CDF(NonCentralStudentT()) function evaluated to 50 figures).
 
Since the difference between qt(.95,15,12) and -qt(.05,15,-12) is
orders of magnitude smaller than their differences from the correct
value, it seems that the decision on whether to give this warning is
being made based on criteria that the algorithm is not capable of
supporting.
 
Jerry W. Lewis
Wyeth BioPharma
Andover, MA
 
 

	[[alternative HTML version deleted]]



From jeff.horner at vanderbilt.edu  Mon Oct  9 23:40:14 2006
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Mon, 09 Oct 2006 16:40:14 -0500
Subject: [Rd] Discussion starter for package level Connection API
Message-ID: <452AC1BE.90104@vanderbilt.edu>

Thought I'd try and start a discussion. Feel free to jump in.

I guess R needs to strike the right balance between opening up the 
internals to package writers and not allowing them to do bad things. My 
first attempt at cracking this nut is to just memcpy() the Rconnection 
and not allow access to the private stuff:

/* Alternative to allowing C code access to connection API. */
Rconnection R_GetConnection(Rconnection ucon, int idx){
     Rconnection rcon;

     /* Valid connection? */
     if ((rcon = getConnection(idx)) == NULL)
         return NULL;

     memcpy(ucon,rcon,sizeof(struct Rconn));

     /* Don't reveal private data */
     ucon->private = NULL;

     return ucon;
}

This would take an user allocated Rconnection and fill out all structure 
members but deny access to the private data. It also presumes that the 
full Rconnection structure is available in an R_ext/ header file. This 
has the advantage of getting access to all the function pointers so that 
data can be pushed and pulled through the connection, without any 
knowledge of what's in the private area.

The first problem is with the class and description members. What to do? 
As it is, the user could do bad things like rename the class or 
description. If the function copied the strings, then the user would 
have to deallocate them as well.

Then there's the PushBack members, to which the user would have full 
access. Looks like they're only used in text connections. Would these be 
better off placed in the private member structure?

Also, the user has the capability to call close on the connection 
without updating the original isopen member.

Here's a rather restrictive approach whereby the user must know the 
integer index of the connection. Each function is a wrapper around the 
related Rconnection member.

int R_VfprintfConnection(int idx, const char *format, va_list ap){
     Rconnection con = getConnection(idx);

     if (!con) return -1; /* just like fprintf(3)? */

     if(!con->isopen) error(_("connection is not open"));
     if(!con->canwrite) error(_("cannot write to this connection"));

     return con->vfprintf(con,format,ap);
}

int R_FgetcConnection(int idx){
     Rconnection con = getConnection(idx);

     if (!con) return EOF; /* just like fgetc(3)? */

     if(!con->isopen) error(_("connection is not open"));
     if(!con->canread) error(_("cannot read from this connection"));

     return con->fgetc(con);
}

double R_SeekConnection(int idx, double where, int origin, int rw){
     Rconnection con = getConnection(idx);

     if (!con) return -1; /* just like fseek(3)? */
     if(!con->isopen) error(_("connection is not open"));
     if(!con->canseek) error(_("cannot seek on this connection"));

     return con->seek(con,where,origin,rw);
}

void R_TruncateConnection(int idx){
     Rconnection con = getConnection(idx);

     if (con) con->truncate(con);
}

int R_FlushConnection(int idx){
     Rconnection con = getConnection(idx);

     if (!con) return EOF; /* like fflush(3) */

     return con->fflush(con);
}

size_t R_ReadConnection(int idx, void *buf, size_t size, size_t n){
     Rconnection con = getConnection(idx);

     if (!con) return 0;

     if(!con->isopen) error(_("connection is not open"));
     if(!con->canread) error(_("cannot read from this connection"));

     return con->read(buf,size,n,con);
}

size_t R_WriteConnection(int idx, void *buf, size_t size, size_t n)
{
     Rconnection con = getConnection(idx);

     if (!con) return -1; /* just like write(2)? */

     if(!con->isopen) error(_("connection is not open"));
     if(!con->canwrite) error(_("cannot write to this connection"));

     return con->write(buf, size, n, con);
}

Thus, the user has no access to the Rconnection at all. Only question 
from me is whether there's too much overhead in calling getConnection(), 
especially when calling R_FgetcConnection() in a loop.

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner



From bolker at zoo.ufl.edu  Tue Oct 10 00:17:57 2006
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Mon, 09 Oct 2006 18:17:57 -0400
Subject: [Rd] boxplot, notches, etc.
Message-ID: <452ACA95.9010606@zoo.ufl.edu>


  Sorry to repost this, but it looks like it's getting
buried in r-help (originally posted October 5: my experience
says that if it hasn't been answered by then it won't be).
I wouldn't bother, but I'm worried that r-devel might be
better, *and* a previous e-mail of mine on the subject in
January also seemed to get buried.

  Synopsis: boxplot notches look weird when notches
are greater than hinges ((1.58*IQR/sqrt(n)) > approx IQR).
When log="y" this causes an error.  Below are several
reproducible examples, some discussion, and a patch against
calc.R.

  Please feel free to say "this is just cosmetic/isn't an issue, go
away" ...

  cheers
    Ben Bolker

bogdan romocea <br44114 <at> gmail.com> writes:

>
> A function I've been using for a while returned a surprising [to me,
> given the data] error recently:
>    Error in plot.window(xlim, ylim, log, asp, ...) :
>        Logarithmic axis must have positive limits
>
> After some digging I realized what was going on:
> x <- c(10460.97, 10808.67, 29499.98, 1, 35818.62, 48535.59, 1, 1,
>    42512.1, 1627.39, 1, 7571.06, 21479.69, 25, 1, 16143.85, 12736.96,
>    1, 7603.63, 1, 33155.24, 1, 1, 50, 3361.78, 1, 37781.84, 1, 1,
>    1, 46492.05, 22334.88, 1, 1)
> summary(x)
> boxplot(x,notch=TRUE,log="y")  #unexpected
> boxplot(x)  #ok
> boxplot(x,log="y")  #ok
> boxplot(x,notch=TRUE)  #aha
>

  Mick Crawley (author of several books on ecological
data analysis in R) submitted a related issue as
bug #7690, which I was mildly surprised to see
filed as "not reproducible" (I didn't have problems reproducing
it at the time ... I posted my then-patch
to R-devel at the time
https://stat.ethz.ch/pipermail/r-devel/2006-January/036257.html )
The problem typically occurs
for very small data sets, when the notches can
be bigger than the hinges.

  As I said then,

>  I can imagine debate about what should be done in this case --
> you could just say "don't do that", since the notches are based
> on an asymptotic argument ... the diff below just truncates
> the notches to the hinges, but produces a warning saying that the
> notches have been truncated.

The interaction with
log="y" is new to me, though, and my old patch
didn't catch it.

   Here's my reproducible version:

set.seed(1001)
npts <- 7
X <- rnorm(2*npts,rep(c(3,4.5),each=npts),sd=1)
f <- factor(rep(1:2,each=npts))
par(mfrow=c(1,2))
boxplot(X~f,notch=TRUE)

  A possible fix is to truncate the notches
(and issue a warning) when this happens,
in src/library/grDevices/R/calc.R:

[WATCH OUT FOR LINE WRAPPING BELOW!]

*** calc.R      2006-10-07 17:44:49.000000000 -0400
--- newcalc.R   2006-10-07 19:25:38.000000000 -0400
***************
*** 16,21 ****
--- 16,26 ----
        if(any(out[nna])) stats[c(1, 5)] <- range(x[!out], na.rm = TRUE)
      }
      conf <- if(do.conf) stats[3] + c(-1.58, 1.58) * iqr / sqrt(n)
+     if (do.conf) {
+       if (conf[1]<stats[2] || conf[2]>stats[4]) warning("confidence
limits > hinges: notches truncated")
+       conf[1] <- max(conf[1],stats[2])
+       conf[2] <- min(conf[2],stats[4])
+     }
      list(stats = stats, n = n, conf = conf,
         out = if(do.out) x[out & nna] else numeric(0))
  }

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 254 bytes
Desc: OpenPGP digital signature
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20061009/ca6413fe/attachment-0004.bin 

From jeff.horner at vanderbilt.edu  Tue Oct 10 06:46:38 2006
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Mon, 09 Oct 2006 23:46:38 -0500
Subject: [Rd] Discussion starter for package level Connection API
In-Reply-To: <452AC1BE.90104@vanderbilt.edu>
References: <452AC1BE.90104@vanderbilt.edu>
Message-ID: <452B25AE.2070005@vanderbilt.edu>

Here's a function to create new connections. It returns and SEXP that 
can be returned to R code, but before that, the user can set up all the 
function pointer members via passing in the address of an Rconnection. 
Here's how you'd call it:

SEXP newcon;
Rconnection conptr;

newcon = R_NewConnection("newcon","newdesc","w",&conptr);

conptr->vfprintf = apachecon_vfprintf;
conptr->write = apachecon_write;
...
conptr->private = apachecon_init(); /* or whathaveyou */
return newcon;

And if you wanted to know the index, all you have to do is get it from 
asInteger(newcon). Here's the code for R_NewConnection;

SEXP R_NewConnection(char *class, char *description, char *mode, 
Rconnection *con)
{
     SEXP sclass, ans;
     Rconnection new = NULL;
     int ncon;

     /* Get index before we allocate memory */
     ncon = NextConnection();

     new = (Rconnection) malloc(sizeof(struct Rconn));
     if(!new) error(_("allocation of new connection failed"));
	new->class = (char *) malloc(strlen(class) + 1);
     if(!new->class) {
     	free(new);
     	error(_("allocation of terminal connection failed"));
     }
     strcpy(new->class, class);
     new->description = (char *) malloc(strlen(description) + 1);
     if(!new->description) {
     	free(new->class); free(new);
     	error(_("allocation of terminal connection failed"));
     }
     init_con(new, description, mode);
     new->isopen = TRUE;
     new->canread = (strcmp(mode, "r") == 0);
     new->canwrite = (strcmp(mode, "w") == 0);
     new->destroy = &null_close;
     new->private = NULL;

     /* Add to Connections, and also
      * allow users to assign function
      * pointer members
      */
     *con = Connections[ncon] = new;

     /* Create something to pass to R code */
     PROTECT(ans = allocVector(INTSXP, 1));
     INTEGER(ans)[0] = ncon;
     PROTECT(sclass = allocVector(STRSXP, 2));
     SET_STRING_ELT(sclass, 0, mkChar(class));
     SET_STRING_ELT(sclass, 1, mkChar("connection"));
     classgets(ans, sclass);
     UNPROTECT(2);

     return ans;
}


Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner



From c.farrow at compserv.gla.ac.uk  Tue Oct 10 10:22:25 2006
From: c.farrow at compserv.gla.ac.uk (c.farrow at compserv.gla.ac.uk)
Date: Tue, 10 Oct 2006 09:22:25 +0100 (BST)
Subject: [Rd] Installing Rmpi on 64-bit Linux Athlon
In-Reply-To: <67DCA285A2D7754280D3B8E88EB548020C946933@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB548020C946933@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <tkrat.e87490a8f0058cbd@compserv.gla.ac.uk>

Hi,

I think you need to reverse the order of the first two lines as
currently you are using $prefix before it is defined.

setenv prefix "/home/a347549/local64"
setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"


colin.


On  9 Oct, McGehee, Robert wrote:
> Hello,
> We have recently added a 64-bit 2 x Dual-Core Athlon server running Red
> Hat Enterprise Linux AS release 3 to allow for processing of large data
> sets (>4GB) in R. To integrate this server into our Linux cluster, I
> have been trying (unsuccessfully) to use Rmpi/lam-mpi to parallel
> process some of our scripts. While I have successfully compiled R 2.4.0
> and lam-mpi 7.1.2 on this server using a 64-bit architecture, I have not
> been able to install Rmpi to interface with lam-mpi, despite success on
> nearly identical servers in a 32-bit architecture. When trying on the
> 64-bit server, I receive the error "cannot find -lmpi" during
> compilation (see below). 
> 
> If anyone has had success in this regards and notice an installation
> problem that I may have overlooked, I would greatly appreciate any
> advice. Note that because I do not have root access, all of the lam-mpi
> and R files were installed locally.
> 
> Thanks in advance,
> Robert
> 
> ### Below is configuration scripts for R, Lam-MPI and Rmpi:
> 
> setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"
> setenv prefix "/home/a347549/local64"
> 
> ### R 2.4.0 Configure
> ./configure --prefix=$prefix --with-x
> --with-tcl-config="$prefix/lib/tclConfig.sh"
> --with-tk-config="$prefix/lib/tkConfig.sh"
> --with-blas="-L$builddir/ATLAS/lib/Linux_HAMMER64SSE2_4 -lptf77blas
> -lpthread -latlas"
> 
> ### Lam-MPI 7.1.2 Configure:
> ./configure --prefix=$prefix --enable-shared --disable-static
> --without-romio --with-rsh="ssh -xq"
> 
> ### Rmpi INSTALL
> R CMD INSTALL Rmpi --configure-args="--with-mpi=$prefix --prefix=$prefix
> CC=mpicc" -l $R_LIBS
> 
> * Installing *source* package 'Rmpi' ...
> Try to find mpi.h ...
> Found in /gcm/home/a347549/local64/include
> Try to find libmpi or libmpich ...
> checking for main in -lmpi... yes
> Try to find liblam ...
> checking for main in -llam... yes
> checking for openpty in -lutil... yes
> checking for main in -lpthread... yes
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> gcc -I/gcm/home/a347549/local64/lib64/R/include
> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c RegQuery.c -o
> RegQuery.o
> gcc -I/gcm/home/a347549/local64/lib64/R/include
> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c Rmpi.c -o Rmpi.o
> gcc -I/gcm/home/a347549/local64/lib64/R/include
> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c conversion.c -o
> conversion.o
> gcc -I/gcm/home/a347549/local64/lib64/R/include
> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c internal.c -o
> internal.o
> gcc -shared -L/usr/local/lib64 -o Rmpi.so RegQuery.o Rmpi.o conversion.o
> internal.o -lmpi -llam -lutil -lpthread   
> /usr/bin/ld: cannot find -lmpi
> collect2: ld returned 1 exit status
> make: *** [Rmpi.so] Error 1
> chmod: cannot access `/home/a347549/code/rlib64/Rmpi/libs/*': No such
> file or directory
> ERROR: compilation failed for package 'Rmpi'
> ** Removing '/home/a347549/code/rlib64/Rmpi'
> [lwtc5.fmr.com/A347549] /home/a347549/code
> 
> 
> ############################################################
> In addition, here is the output of Rmpi's config.log
> ############################################################
> 
>> cat config.log
> This file contains any messages produced by compilers while
> running configure, to aid debugging if configure makes a mistake.
> 
> It was created by configure, which was
> generated by GNU Autoconf 2.59.  Invocation command line was
> 
>   $ ./configure --with-mpi=/gcm/home/a347549/local64
> --prefix=/gcm/home/a347549/local64 CC=mpicc
> 
> ## --------- ##
> ## Platform. ##
> ## --------- ##
> 
> hostname = lwtc5.fmr.com
> uname -m = x86_64
> uname -r = 2.6.9-34.0.1.ELsmp
> uname -s = Linux
> uname -v = #1 SMP Wed May 17 16:59:36 EDT 2006
> 
> /usr/bin/uname -p = unknown
> /bin/uname -X     = unknown
> 
> /bin/arch              = x86_64
> /usr/bin/arch -k       = unknown
> /usr/convex/getsysinfo = unknown
> hostinfo               = unknown
> /bin/machine           = unknown
> /usr/bin/oslevel       = unknown
> /bin/universe          = unknown
> 
> PATH: /home/a347549/local64/java/bin
> PATH: /home/a347549/local64/tibrv/bin
> PATH: /home/a347549/local64/ant/bin
> PATH: /home/a347549/local64/bin
> PATH: /usr/bin/X11
> PATH: /home/a347549/bin
> PATH: /home/a347549/local64/java/bin
> PATH: /home/a347549/local64/tibrv/bin
> PATH: /home/a347549/local64/ant/bin
> PATH: /home/a347549/local64/bin
> PATH: /usr/bin/X11
> PATH: /home/a347549/bin
> PATH: /usr/kerberos/bin
> PATH: /usr/local/bin
> PATH: /bin
> PATH: /usr/bin
> PATH: /usr/X11R6/bin
> PATH: .
> PATH: .
> 
> 
> ## ----------- ##
> ## Core tests. ##
> ## ----------- ##
> 
> configure:2944: checking for main in -lmpi
> configure:2968: mpicc -o conftest    conftest.c -lmpi   >&5
> configure:2974: $? = 0
> configure:2978: test -z 
> 			 || test ! -s conftest.err
> configure:2981: $? = 0
> configure:2984: test -s conftest
> configure:2987: $? = 0
> configure:3000: result: yes
> configure:3018: checking for main in -llam
> configure:3042: mpicc -o conftest    conftest.c -llam   >&5
> configure:3048: $? = 0
> configure:3052: test -z 
> 			 || test ! -s conftest.err
> configure:3055: $? = 0
> configure:3058: test -s conftest
> configure:3061: $? = 0
> configure:3074: result: yes
> configure:3086: checking for openpty in -lutil
> configure:3116: mpicc -o conftest    conftest.c -lutil   >&5
> configure:3122: $? = 0
> configure:3126: test -z 
> 			 || test ! -s conftest.err
> configure:3129: $? = 0
> configure:3132: test -s conftest
> configure:3135: $? = 0
> configure:3148: result: yes
> configure:3154: checking for main in -lpthread
> configure:3178: mpicc -o conftest    conftest.c -lpthread   >&5
> configure:3184: $? = 0
> configure:3188: test -z 
> 			 || test ! -s conftest.err
> configure:3191: $? = 0
> configure:3194: test -s conftest
> configure:3197: $? = 0
> configure:3210: result: yes
> configure:3352: creating ./config.status
> 
> ## ---------------------- ##
> ## Running config.status. ##
> ## ---------------------- ##
> 
> This file was extended by config.status, which was
> generated by GNU Autoconf 2.59.  Invocation command line was
> 
>   CONFIG_FILES    = 
>   CONFIG_HEADERS  = 
>   CONFIG_LINKS    = 
>   CONFIG_COMMANDS = 
>   $ ./config.status 
> 
> on lwtc5.fmr.com
> 
> config.status:635: creating src/Makevars
> 
> ## ---------------- ##
> ## Cache variables. ##
> ## ---------------- ##
> 
> ac_cv_env_CC_set=set
> ac_cv_env_CC_value=mpicc
> ac_cv_env_CFLAGS_set=
> ac_cv_env_CFLAGS_value=
> ac_cv_env_CPPFLAGS_set=
> ac_cv_env_CPPFLAGS_value=
> ac_cv_env_CPP_set=
> ac_cv_env_CPP_value=
> ac_cv_env_LDFLAGS_set=
> ac_cv_env_LDFLAGS_value=
> ac_cv_env_build_alias_set=
> ac_cv_env_build_alias_value=
> ac_cv_env_host_alias_set=
> ac_cv_env_host_alias_value=
> ac_cv_env_target_alias_set=
> ac_cv_env_target_alias_value=
> ac_cv_lib_lam_main=yes
> ac_cv_lib_mpi_main=yes
> ac_cv_lib_pthread_main=yes
> ac_cv_lib_util_openpty=yes
> 
> ## ----------------- ##
> ## Output variables. ##
> ## ----------------- ##
> 
> CC='mpicc'
> CFLAGS=''
> CPP=''
> CPPFLAGS=''
> DEFS='-DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\"
> -DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" '
> ECHO_C=''
> ECHO_N='-n'
> ECHO_T=''
> EGREP='grep -E'
> EXEEXT=''
> LDFLAGS=''
> LIBOBJS=''
> LIBS=''
> LTLIBOBJS=''
> OBJEXT=''
> PACKAGE_BUGREPORT=''
> PACKAGE_NAME=''
> PACKAGE_STRING=''
> PACKAGE_TARNAME=''
> PACKAGE_VERSION=''
> PATH_SEPARATOR=':'
> PKG_CPPFLAGS='-I/gcm/home/a347549/local64/include -DMPI2'
> PKG_LIBS='-lmpi -llam -lutil -lpthread'
> SHELL='/bin/sh'
> ac_ct_CC=''
> bindir='${exec_prefix}/bin'
> build_alias=''
> datadir='${prefix}/share'
> exec_prefix='${prefix}'
> host_alias=''
> includedir='${prefix}/include'
> infodir='${prefix}/info'
> libdir='${exec_prefix}/lib'
> libexecdir='${exec_prefix}/libexec'
> localstatedir='${prefix}/var'
> mandir='${prefix}/man'
> oldincludedir='/usr/include'
> prefix='/gcm/home/a347549/local64'
> program_transform_name='s,x,x,'
> sbindir='${exec_prefix}/sbin'
> sharedstatedir='${prefix}/com'
> sysconfdir='${prefix}/etc'
> target_alias=''
> 
> ## ----------- ##
> ## confdefs.h. ##
> ## ----------- ##
> 
> #define PACKAGE_BUGREPORT ""
> #define PACKAGE_NAME ""
> #define PACKAGE_STRING ""
> #define PACKAGE_TARNAME ""
> #define PACKAGE_VERSION ""
> 
> configure: exit 0
> 
> 
> 
> Robert McGehee
> Quantitative Analyst
> Geode Capital Management, LLC
> 53 State Street, 5th Floor | Boston, MA | 02109
> Tel: 617/392-8396    Fax:617/476-6389
> mailto:robert.mcgehee at geodecapital.com
> 
> 
> 
> This e-mail, and any attachments hereto, are intended for us...{{dropped}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Colin Farrow
Computing Service, University of Glasgow, Glasgow G12 8QQ
Tel: 0141 330 4862, Email: c.farrow at compserv.gla.ac.uk
---



From hin-tak.leung at cimr.cam.ac.uk  Tue Oct 10 12:09:35 2006
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Tue, 10 Oct 2006 11:09:35 +0100
Subject: [Rd] Installing Rmpi on 64-bit Linux Athlon
In-Reply-To: <tkrat.e87490a8f0058cbd@compserv.gla.ac.uk>
References: <67DCA285A2D7754280D3B8E88EB548020C946933@MSGBOSCLB2WIN.DMN1.FMR.COM>
	<tkrat.e87490a8f0058cbd@compserv.gla.ac.uk>
Message-ID: <452B715F.10807@cimr.cam.ac.uk>

No, both of you are not doing it correctly - you are confused about 
linker problem with runtime issue. LD_LIBRARY_PATH is a runtime
flag. You want to set the linker flag to influence the linker behavior:

setenv LDFLAGS="-L$prefix/lib -L$prefix/lib64"

or edit the makefile or Makevars do the equivalent with PKG_LDFLAGS
in the Rmpi package.

BTW, the syntax for using LD_LIBRARY_PATH is also wrong - to use it the 
way it is intended, you need:

setenv LD_LIBRARY_PATH "$prefix/lib:$prefix/lib64"

c.farrow at compserv.gla.ac.uk wrote:
> Hi,
> 
> I think you need to reverse the order of the first two lines as
> currently you are using $prefix before it is defined.
> 
> setenv prefix "/home/a347549/local64"
> setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"
> 
> 
> colin.
> 
> 
> On  9 Oct, McGehee, Robert wrote:
>> Hello,
>> We have recently added a 64-bit 2 x Dual-Core Athlon server running Red
>> Hat Enterprise Linux AS release 3 to allow for processing of large data
>> sets (>4GB) in R. To integrate this server into our Linux cluster, I
>> have been trying (unsuccessfully) to use Rmpi/lam-mpi to parallel
>> process some of our scripts. While I have successfully compiled R 2.4.0
>> and lam-mpi 7.1.2 on this server using a 64-bit architecture, I have not
>> been able to install Rmpi to interface with lam-mpi, despite success on
>> nearly identical servers in a 32-bit architecture. When trying on the
>> 64-bit server, I receive the error "cannot find -lmpi" during
>> compilation (see below). 
>>
>> If anyone has had success in this regards and notice an installation
>> problem that I may have overlooked, I would greatly appreciate any
>> advice. Note that because I do not have root access, all of the lam-mpi
>> and R files were installed locally.
>>
>> Thanks in advance,
>> Robert
>>
>> ### Below is configuration scripts for R, Lam-MPI and Rmpi:
>>
>> setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"
>> setenv prefix "/home/a347549/local64"
>>
>> ### R 2.4.0 Configure
>> ./configure --prefix=$prefix --with-x
>> --with-tcl-config="$prefix/lib/tclConfig.sh"
>> --with-tk-config="$prefix/lib/tkConfig.sh"
>> --with-blas="-L$builddir/ATLAS/lib/Linux_HAMMER64SSE2_4 -lptf77blas
>> -lpthread -latlas"
>>
>> ### Lam-MPI 7.1.2 Configure:
>> ./configure --prefix=$prefix --enable-shared --disable-static
>> --without-romio --with-rsh="ssh -xq"
>>
>> ### Rmpi INSTALL
>> R CMD INSTALL Rmpi --configure-args="--with-mpi=$prefix --prefix=$prefix
>> CC=mpicc" -l $R_LIBS
>>
>> * Installing *source* package 'Rmpi' ...
>> Try to find mpi.h ...
>> Found in /gcm/home/a347549/local64/include
>> Try to find libmpi or libmpich ...
>> checking for main in -lmpi... yes
>> Try to find liblam ...
>> checking for main in -llam... yes
>> checking for openpty in -lutil... yes
>> checking for main in -lpthread... yes
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> ** libs
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c RegQuery.c -o
>> RegQuery.o
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c Rmpi.c -o Rmpi.o
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c conversion.c -o
>> conversion.o
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c internal.c -o
>> internal.o
>> gcc -shared -L/usr/local/lib64 -o Rmpi.so RegQuery.o Rmpi.o conversion.o
>> internal.o -lmpi -llam -lutil -lpthread   
>> /usr/bin/ld: cannot find -lmpi
>> collect2: ld returned 1 exit status
>> make: *** [Rmpi.so] Error 1
>> chmod: cannot access `/home/a347549/code/rlib64/Rmpi/libs/*': No such
>> file or directory
>> ERROR: compilation failed for package 'Rmpi'
>> ** Removing '/home/a347549/code/rlib64/Rmpi'
>> [lwtc5.fmr.com/A347549] /home/a347549/code
>>
>>
>> ############################################################
>> In addition, here is the output of Rmpi's config.log
>> ############################################################
>>
>>> cat config.log
>> This file contains any messages produced by compilers while
>> running configure, to aid debugging if configure makes a mistake.
>>
>> It was created by configure, which was
>> generated by GNU Autoconf 2.59.  Invocation command line was
>>
>>   $ ./configure --with-mpi=/gcm/home/a347549/local64
>> --prefix=/gcm/home/a347549/local64 CC=mpicc
>>
>> ## --------- ##
>> ## Platform. ##
>> ## --------- ##
>>
>> hostname = lwtc5.fmr.com
>> uname -m = x86_64
>> uname -r = 2.6.9-34.0.1.ELsmp
>> uname -s = Linux
>> uname -v = #1 SMP Wed May 17 16:59:36 EDT 2006
>>
>> /usr/bin/uname -p = unknown
>> /bin/uname -X     = unknown
>>
>> /bin/arch              = x86_64
>> /usr/bin/arch -k       = unknown
>> /usr/convex/getsysinfo = unknown
>> hostinfo               = unknown
>> /bin/machine           = unknown
>> /usr/bin/oslevel       = unknown
>> /bin/universe          = unknown
>>
>> PATH: /home/a347549/local64/java/bin
>> PATH: /home/a347549/local64/tibrv/bin
>> PATH: /home/a347549/local64/ant/bin
>> PATH: /home/a347549/local64/bin
>> PATH: /usr/bin/X11
>> PATH: /home/a347549/bin
>> PATH: /home/a347549/local64/java/bin
>> PATH: /home/a347549/local64/tibrv/bin
>> PATH: /home/a347549/local64/ant/bin
>> PATH: /home/a347549/local64/bin
>> PATH: /usr/bin/X11
>> PATH: /home/a347549/bin
>> PATH: /usr/kerberos/bin
>> PATH: /usr/local/bin
>> PATH: /bin
>> PATH: /usr/bin
>> PATH: /usr/X11R6/bin
>> PATH: .
>> PATH: .
>>
>>
>> ## ----------- ##
>> ## Core tests. ##
>> ## ----------- ##
>>
>> configure:2944: checking for main in -lmpi
>> configure:2968: mpicc -o conftest    conftest.c -lmpi   >&5
>> configure:2974: $? = 0
>> configure:2978: test -z 
>> 			 || test ! -s conftest.err
>> configure:2981: $? = 0
>> configure:2984: test -s conftest
>> configure:2987: $? = 0
>> configure:3000: result: yes
>> configure:3018: checking for main in -llam
>> configure:3042: mpicc -o conftest    conftest.c -llam   >&5
>> configure:3048: $? = 0
>> configure:3052: test -z 
>> 			 || test ! -s conftest.err
>> configure:3055: $? = 0
>> configure:3058: test -s conftest
>> configure:3061: $? = 0
>> configure:3074: result: yes
>> configure:3086: checking for openpty in -lutil
>> configure:3116: mpicc -o conftest    conftest.c -lutil   >&5
>> configure:3122: $? = 0
>> configure:3126: test -z 
>> 			 || test ! -s conftest.err
>> configure:3129: $? = 0
>> configure:3132: test -s conftest
>> configure:3135: $? = 0
>> configure:3148: result: yes
>> configure:3154: checking for main in -lpthread
>> configure:3178: mpicc -o conftest    conftest.c -lpthread   >&5
>> configure:3184: $? = 0
>> configure:3188: test -z 
>> 			 || test ! -s conftest.err
>> configure:3191: $? = 0
>> configure:3194: test -s conftest
>> configure:3197: $? = 0
>> configure:3210: result: yes
>> configure:3352: creating ./config.status
>>
>> ## ---------------------- ##
>> ## Running config.status. ##
>> ## ---------------------- ##
>>
>> This file was extended by config.status, which was
>> generated by GNU Autoconf 2.59.  Invocation command line was
>>
>>   CONFIG_FILES    = 
>>   CONFIG_HEADERS  = 
>>   CONFIG_LINKS    = 
>>   CONFIG_COMMANDS = 
>>   $ ./config.status 
>>
>> on lwtc5.fmr.com
>>
>> config.status:635: creating src/Makevars
>>
>> ## ---------------- ##
>> ## Cache variables. ##
>> ## ---------------- ##
>>
>> ac_cv_env_CC_set=set
>> ac_cv_env_CC_value=mpicc
>> ac_cv_env_CFLAGS_set=
>> ac_cv_env_CFLAGS_value=
>> ac_cv_env_CPPFLAGS_set=
>> ac_cv_env_CPPFLAGS_value=
>> ac_cv_env_CPP_set=
>> ac_cv_env_CPP_value=
>> ac_cv_env_LDFLAGS_set=
>> ac_cv_env_LDFLAGS_value=
>> ac_cv_env_build_alias_set=
>> ac_cv_env_build_alias_value=
>> ac_cv_env_host_alias_set=
>> ac_cv_env_host_alias_value=
>> ac_cv_env_target_alias_set=
>> ac_cv_env_target_alias_value=
>> ac_cv_lib_lam_main=yes
>> ac_cv_lib_mpi_main=yes
>> ac_cv_lib_pthread_main=yes
>> ac_cv_lib_util_openpty=yes
>>
>> ## ----------------- ##
>> ## Output variables. ##
>> ## ----------------- ##
>>
>> CC='mpicc'
>> CFLAGS=''
>> CPP=''
>> CPPFLAGS=''
>> DEFS='-DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\"
>> -DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" '
>> ECHO_C=''
>> ECHO_N='-n'
>> ECHO_T=''
>> EGREP='grep -E'
>> EXEEXT=''
>> LDFLAGS=''
>> LIBOBJS=''
>> LIBS=''
>> LTLIBOBJS=''
>> OBJEXT=''
>> PACKAGE_BUGREPORT=''
>> PACKAGE_NAME=''
>> PACKAGE_STRING=''
>> PACKAGE_TARNAME=''
>> PACKAGE_VERSION=''
>> PATH_SEPARATOR=':'
>> PKG_CPPFLAGS='-I/gcm/home/a347549/local64/include -DMPI2'
>> PKG_LIBS='-lmpi -llam -lutil -lpthread'
>> SHELL='/bin/sh'
>> ac_ct_CC=''
>> bindir='${exec_prefix}/bin'
>> build_alias=''
>> datadir='${prefix}/share'
>> exec_prefix='${prefix}'
>> host_alias=''
>> includedir='${prefix}/include'
>> infodir='${prefix}/info'
>> libdir='${exec_prefix}/lib'
>> libexecdir='${exec_prefix}/libexec'
>> localstatedir='${prefix}/var'
>> mandir='${prefix}/man'
>> oldincludedir='/usr/include'
>> prefix='/gcm/home/a347549/local64'
>> program_transform_name='s,x,x,'
>> sbindir='${exec_prefix}/sbin'
>> sharedstatedir='${prefix}/com'
>> sysconfdir='${prefix}/etc'
>> target_alias=''
>>
>> ## ----------- ##
>> ## confdefs.h. ##
>> ## ----------- ##
>>
>> #define PACKAGE_BUGREPORT ""
>> #define PACKAGE_NAME ""
>> #define PACKAGE_STRING ""
>> #define PACKAGE_TARNAME ""
>> #define PACKAGE_VERSION ""
>>
>> configure: exit 0
>>
>>
>>
>> Robert McGehee
>> Quantitative Analyst
>> Geode Capital Management, LLC
>> 53 State Street, 5th Floor | Boston, MA | 02109
>> Tel: 617/392-8396    Fax:617/476-6389
>> mailto:robert.mcgehee at geodecapital.com
>>
>>
>>
>> This e-mail, and any attachments hereto, are intended for us...{{dropped}}
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From Arnost.Komarek at med.kuleuven.be  Tue Oct 10 15:30:25 2006
From: Arnost.Komarek at med.kuleuven.be (Arnost.Komarek at med.kuleuven.be)
Date: Tue, 10 Oct 2006 15:30:25 +0200 (CEST)
Subject: [Rd] read.table versus read.csv (PR#9284)
Message-ID: <20061010133025.CD1274C89A@slim.kubism.ku.dk>

This message is in MIME format.

--=_6vx1wr5xhvr4
Content-Type: text/plain;
	charset=ISO-8859-1;
	DelSp="Yes";
	format="flowed"
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Dear R Core Team,

Help to 'read.table' claims that
'read.csv' is identical to 'read.table' except for the defaults.

However, 'read.table' seems to have problems when reading character =20
variables containing single quotes (') whereas 'read.csv' does not. =20
Consider the data set "aaup.csv" which is attached to this e-mail. The =20
data file contains names of variables on the 1st row, values are =20
separated by commas (",") and missing values are denoted by "*". The =20
second column of the data is character, never containing commas, =20
however sometimes containing single quotes ('). The following 2 =20
commands should normally be equivalent:

data.table <- read.table("aaup.csv", sep=3D",", na.string=3D"*", header=3DTR=
UE)
data.csv <- read.csv("aaup.csv", na.string=3D"*", header=3DTRUE)

Whereas 'read.csv' reads the data correctly, 'read.table' reads =20
everything between two occurences of ' as ONE data row:

dim(data.csv)
results (correctly) in 1161  17

dim(data.table)
results in 955   17

For example:
Line 78 of 'aaup.csv' is:
  1302,Saint Mary's Coll. of =20
Calif.,CA,IIA,614,494,404,500,754,616,497,618,38,55,42,0,135

Line 162 of 'aaup.csv' is:
  9635,Florida Internat'l =20
Univ.,FL,IIA,558,423,395,433,719,553,509,562,182,261,220,76,767

Line 163 of 'aaup.csv' is:
  9841,University of North =20
Florida,FL,IIB,498,405,343,408,663,544,462,547,73,81,57,19,230

data.csv[77,]
gives correctly 78th row of the data file 'aaup.csv'

data.table[77,]
gives joined 78th - 162nd row of the data file

data.table[78,]
is equal to the 163rd row of the data file 'aaup.csv'

The problem occurs on R 2.4.0 running on Linux Debian system (see =20
below full information concerning the platform). However, according to =20
my information, exactly the same problems happens with R running on =20
Windows XP Professional, Windows XP Home Edition and Linux Mandrake =20
10.1.

Kind regards
Arnost Komarek

--=20
Arnost Komarek
Biostatistisch Centrum K.U. Leuven
U.Z. St. Rafael
Kapucijnenvoer 35
B-3000 Leuven
Belgium
Tel : +32 - 16 - 33 68 86
Fax: +32 - 16 - 33 70 15
Web: http://www.med.kuleuven.be/biostat/


--please do not edit the information below--

Version:
  platform =3D i686-pc-linux-gnu
  arch =3D i686
  os =3D linux-gnu
  system =3D i686, linux-gnu
  status =3D
  major =3D 2
  minor =3D 4.0
  year =3D 2006
  month =3D 10
  day =3D 03
  svn rev =3D 39566
  language =3D R
  version.string =3D R version 2.4.0 (2006-10-03)

Locale:
LC_CTYPE=3Dnl_BE at euro;LC_NUMERIC=3DC;LC_TIME=3Dnl_BE at euro;LC_COLLATE=3Dnl_BE=
@euro;LC_MONETARY=3Dnl_BE at euro;LC_MESSAGES=3Dnl_BE at euro;LC_PAPER=3Dnl_BE at eur=
o;LC_NAME=3DC;LC_ADDRESS=3DC;LC_TELEPHONE=3DC;LC_MEASUREMENT=3Dnl_BE at euro;LC=
_IDENTIFICATION=3DC

Search Path:
  .GlobalEnv, package:methods, package:stats, package:graphics, =20
package:grDevices, package:utils, package:datasets, Autoloads, =20
package:base








Disclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm


--=_6vx1wr5xhvr4
Content-Type: text/x-comma-separated-values;
	charset=UTF-8;
	name="aaup.csv"
Content-Disposition: attachment;
	filename="aaup.csv"
Content-Transfer-Encoding: quoted-printable

FICE,name,state,type,salary.prof,salary.assoc,salary.assist,salary,compens.p=
rof,compens.assoc,compens.assist,compens,n.prof,n.assoc,n.assist,n.instruct,=
n.staff
1061,Alaska Pacific University,AK,IIB,454,382,362,382,567,485,471,487,6,11,9=
,4,32
1063,Univ.Alaska-Fairbanks,AK,I,686,560,432,508,914,753,572,677,74,125,118,4=
0,404
1065,Univ.Alaska-Southeast,AK,IIA,533,494,329,415,716,663,442,559,9,26,20,9,=
70
11462,Univ.Alaska-Anchorage,AK,IIA,612,507,414,498,825,681,557,670,115,124,1=
01,21,392
1002,Alabama Agri.&Mech. Univ.,AL,IIA,442,369,310,350,530,444,376,423,59,77,=
102,24,262
1004,University of Montevallo,AL,IIA,441,385,310,388,542,473,383,477,57,33,3=
5,2,127
1008,Athens State College,AL,IIB,466,394,351,396,558,476,427,478,20,18,30,0,=
68
1009,Auburn University- Main,AL,I,580,437,374,455,692,527,451,546,366,354,30=
1,66,1109
1012,Birmingham Southern College,AL,IIB,498,379,322,401,655,501,404,523,34,2=
5,27,3,89
1016,Univ. of North Alabama,AL,IIB,506,412,359,411,607,508,445,503,67,40,66,=
27,200
1019,Huntingdon College,AL,IIB,339,303,287,301,421,371,347,366,8,15,19,2,44
1020,Jacksonville State Univ.,AL,IIA,461,389,338,386,585,496,436,493,106,42,=
66,58,272
1024,Livingston University,AL,IIB,360,304,258,300,433,369,313,363,27,25,33,4=
,89
1029,University of Mobile,AL,IIB,354,321,277,291,436,401,346,363,17,19,31,19=
,86
1033,Oakwood College,AL,IIB,301,290,283,290,375,363,355,362,18,28,28,3,77
1036,Samford University,AL,IIA,565,425,363,449,710,556,476,578,83,46,77,9,21=
5
1041,Spring Hill College,AL,IIB,431,352,311,373,518,425,374,449,23,17,14,1,5=
5
1044,Stillman College,AL,IIB,321,288,251,272,388,354,312,335,13,18,18,10,59
1047,Troy State University-Main,AL,IIA,462,385,322,350,560,467,392,426,25,59=
,100,19,204
1050,Tuskegee University,AL,IIA,410,352,306,327,487,415,362,387,57,65,85,45,=
254
1051,University of Alabama,AL,I,605,447,382,463,746,563,483,580,267,206,206,=
76,762
1052,Univ. Alabama at Birmingham,AL,I,633,445,366,461,786,569,475,587,106,16=
3,107,19,406
1055,Univ. Alabama in Huntsville,AL,IIA,636,443,375,451,771,540,455,548,72,8=
7,98,7,282
1057,University of South Alabama,AL,IIA,542,426,370,418,645,514,450,504,119,=
103,142,64,434
8310,Auburn Univ. at Montgomery,AL,IIA,519,422,343,403,621,507,411,483,56,54=
,63,28,201
1085,Univ. Ark. at Monticello,AR,IIB,453,363,330,349,561,448,402,428,23,24,4=
8,22,117
1086,Univ. Arkansas at Pine Bluff,AR,IIB,406,366,332,335,505,457,415,419,40,=
33,71,46,192
1088,Arkansas College (Lyon College),AR,IIB,499,*,330,399,618,*,402,488,14,5=
,21,2,42
1089,Arkansas Tech University,AR,IIB,439,381,337,374,550,479,427,471,44,71,5=
2,13,180
1090,Arkansas State Univ.-Main,AR,IIA,520,433,342,398,646,541,431,498,103,87=
,141,63,394
1092,Univ. of Central Arkansas,AR,IIA,521,416,339,395,632,507,416,482,93,89,=
82,76,340
1094,University of the Ozarks,AR,IIB,309,280,274,285,428,383,376,391,14,9,15=
,2,40
1098,Henderson State University,AR,IIB,447,375,341,375,561,480,435,477,55,42=
,33,25,155
1099,Hendrix College,AR,IIB,485,399,362,421,664,534,453,562,24,26,14,1,65
1100,John Brown University,AR,IIB,372,338,304,341,478,414,375,426,23,22,10,3=
,58
1101,Univ. Ark. at Little Rock,AR,IIA,536,416,372,415,651,506,450,504,128,11=
7,72,63,398
1102,Ouachita Baptist University,AR,IIB,422,355,289,342,529,445,375,435,36,1=
4,28,19,97
1106,Williams Baptist College,AR,IIB,*,*,264,266,*,*,327,331,4,4,12,4,24
1107,Southern Ark. Univ.-Main,AR,IIA,461,389,321,362,575,484,402,453,27,31,3=
4,23,115
1108,Univ. Arkansas-Fayetteville,AR,I,563,436,379,452,686,531,461,550,314,19=
8,225,54,806
10311,Harding University,AR,IIB,424,374,335,380,512,461,401,460,80,46,41,8,1=
79
1074,Grand Canyon University,AZ,IIB,358,328,274,299,439,395,332,363,20,18,24=
,12,74
1081,Arizona State University,AZ,I,603,449,399,489,723,549,489,593,576,445,2=
51,7,1383
1082,Northern Arizona University,AZ,I,511,422,359,412,619,518,446,507,173,19=
2,175,33,608
1083,University of Arizona,AZ,I,648,462,411,537,771,561,498,645,647,377,272,=
2,1349
1117,Azusa Pacific University,CA,IIA,430,375,318,368,573,494,428,488,43,62,3=
2,12,156
1122,Biola University,CA,IIA,455,369,303,370,582,462,371,464,32,57,31,6,126
1131,California Inst. of Tech.,CA,I,970,733,576,866,1204,909,717,1075,173,40=
,44,0,257
1133,California Lutheran Univ.,CA,IIB,477,392,335,398,600,501,433,507,32,21,=
33,6,92
1137,Cal.St.Univ-Fullerton,CA,IIA,605,493,387,544,760,637,506,690,393,120,10=
5,5,623
1138,Cal.St.Univ-Hayward,CA,IIA,606,491,384,552,762,629,503,699,258,69,49,7,=
383
1139,Cal.St.Univ-Long Beach,CA,IIA,600,474,401,542,751,610,521,685,491,171,1=
12,6,780
1141,Cal.St.Univ-Dominguez Hills,CA,IIA,605,472,392,548,759,606,593,705,178,=
52,37,1,268
1143,Cal.Poly.St.U-Sn Luis Obispo,CA,IIA,607,496,394,571,763,635,514,721,507=
,102,60,1,670
1144,Cal.Poly.St.Univ-Pomona,CA,IIA,610,492,408,559,766,630,531,707,411,116,=
79,4,610
1146,Cal.St.Univ-Chico,CA,IIA,604,482,395,558,758,631,518,707,413,86,73,2,57=
4
1147,Cal.St.Univ-Fresno,CA,IIA,603,476,382,553,757,612,500,699,459,109,67,14=
,649
1149,Humboldt State University,CA,IIA,593,468,387,543,746,603,507,688,213,38=
,50,0,301
1151,San Diego State University,CA,IIA,602,479,403,547,756,615,524,693,576,2=
23,100,10,909
1155,San Jose State University,CA,IIA,598,486,404,528,750,623,526,669,431,22=
2,158,8,819
1156,Sonoma State University,CA,IIA,602,459,380,553,755,592,497,699,170,34,2=
9,0,233
1164,Chapman University,CA,IIA,578,470,420,491,763,627,573,656,38,37,36,0,11=
1
1170,Claremont McKenna College,CA,IIB,716,516,411,601,892,661,510,751,36,16,=
12,2,67
1171,Harvey Mudd College,CA,IIB,771,579,454,638,961,739,588,805,34,14,20,0,6=
8
1172,Pitzer College,CA,IIB,652,439,381,547,824,572,482,695,31,10,13,0,54
1173,Pomona College,CA,IIB,730,525,417,566,909,658,530,708,60,52,40,7,161
1174,Scripps College,CA,IIB,611,458,372,511,776,588,495,658,28,10,15,1,54
1179,College of Notre Dame,CA,IIB,524,421,374,448,630,503,443,535,25,16,15,3=
,59
1183,Holy Names College,CA,IIB,484,394,275,368,542,443,311,413,10,22,18,1,51
1216,University of La Verne,CA,IIA,482,392,326,401,602,478,396,494,41,28,41,=
0,110
1238,Mills College,CA,IIA,593,461,407,492,737,571,507,612,28,16,23,2,70
1249,Occidental College,CA,IIB,624,469,388,490,806,593,482,621,49,42,33,15,1=
39
1253,Fresno Pacific College,CA,IIB,*,*,*,361,*,*,*,447,0,0,0,0,54
1258,Pacific Union College,CA,IIB,362,333,315,336,441,398,376,403,40,17,41,4=
,102
1262,Point Loma Nazarene College,CA,IIB,507,393,358,429,637,523,468,549,43,2=
1,23,7,94
1264,Pepperdine University,CA,IIA,715,561,511,637,930,737,645,829,130,72,22,=
7,231
1302,Saint Mary's Coll. of Calif.,CA,IIA,614,494,404,500,754,616,497,618,38,=
55,42,0,135
1305,Stanford University,CA,I,952,658,519,824,1144,814,653,1000,533,139,145,=
0,834
1312,Univ.of Calif.-Berkeley,CA,I,764,513,433,650,939,631,533,799,834,229,20=
9,0,1346
1313,Univ.of Calif.-Davis,CA,I,683,478,404,561,840,588,496,689,535,190,234,0=
,1072
1314,Univ.of Calif.-Irvine,CA,I,708,488,423,574,870,599,520,705,319,161,138,=
0,673
1315,Univ.of Calif.-Los Angeles,CA,I,741,497,421,609,910,611,517,748,817,267=
,298,0,1499
1316,Univ.of Calif.-Riverside,CA,I,670,461,390,514,824,567,479,632,183,80,14=
0,0,441
1317,Univ.of Calif.-San Diego,CA,I,723,487,401,595,888,598,493,732,405,147,1=
30,0,734
1319,Univ.of Calif.-San Francisco,CA,I,624,449,380,520,767,552,467,639,154,8=
3,74,0,314
1320,Univ.of Calif.-Santa Barbara,CA,I,712,473,401,578,875,581,493,711,371,1=
25,145,0,694
1321,Univ.of Calif.-Santa Cruz,CA,I,677,464,391,537,832,570,481,660,186,93,9=
2,0,413
1322,University of Redlands,CA,IIA,566,468,406,488,716,592,495,610,49,19,39,=
0,109
1325,University of San Francisco,CA,IIA,617,486,405,514,811,644,538,680,129,=
59,80,19,287
1326,Santa Clara University,CA,IIA,763,555,487,578,938,704,624,729,85,117,90=
,0,324
1328,Univ. of Southern California,CA,I,802,574,484,641,1016,751,636,825,485,=
354,286,27,1165
1329,University of the Pacific,CA,IIA,542,420,372,459,666,528,468,570,172,92=
,100,10,377
1341,Westmont College,CA,IIB,489,408,339,415,616,524,429,526,30,19,22,3,74
1342,Whittier College,CA,IIA,666,499,347,531,808,601,416,642,48,27,24,9,108
1343,Woodbury University,CA,IIA,*,373,365,381,*,472,454,478,5,11,6,0,22
3948,San Francisco State Univ.,CA,IIA,599,483,397,541,751,619,518,684,451,13=
3,117,8,709
7993,Cal.St.Univ-Bakersfield,CA,IIA,597,482,377,499,752,619,495,637,95,48,50=
,13,206
10395,University of San Diego,CA,IIA,719,533,452,575,904,678,569,725,105,72,=
76,12,265
11649,Loyola Marymount University,CA,IIA,722,558,414,589,911,724,543,754,130=
,90,83,3,310
1345,Adams State College,CO,IIA,436,356,321,360,527,444,400,444,29,21,40,8,9=
8
1347,Colorado College,CO,IIB,613,488,398,525,776,621,509,665,63,38,26,1,134
1349,Univ. of Northern Colorado,CO,I,480,390,333,385,565,463,399,458,151,111=
,129,35,467
1350,Colorado State University,CO,I,598,447,403,517,714,534,481,617,483,255,=
188,0,926
1353,Fort Lewis College,CO,IIB,439,385,342,392,516,452,402,460,73,35,52,5,16=
5
1358,Mesa State College,CO,IIB,429,353,297,340,508,427,363,410,49,31,37,7,14=
5
1360,Metro. State Coll.of Denver,CO,IIB,480,406,351,418,568,485,424,498,159,=
90,111,8,370
1363,Regis University,CO,IIB,489,434,349,424,626,531,428,527,16,26,12,2,56
1365,University Southern Colorado,CO,IIA,474,422,360,397,559,498,425,468,47,=
45,63,15,170
1370,Univ. of Colorado- Boulder,CO,I,652,494,421,528,797,615,519,649,457,301=
,227,93,1081
1371,University of Denver,CO,I,623,479,430,509,756,588,525,620,142,106,101,6=
,378
1372,Western State Coll. of Colo.,CO,IIB,452,381,324,402,546,460,406,490,52,=
25,26,0,103
4509,Univ. of Colo. at Colo.Sprgs,CO,IIA,522,422,385,451,642,524,480,558,62,=
56,40,3,161
6740,Univ. of Colorado at Denver,CO,IIA,596,453,408,467,726,561,508,576,106,=
108,119,35,368
9401,Colorado Christian Univ.,CO,IIB,*,284,251,255,*,356,318,323,3,8,13,8,32
1374,Albertus Magnus College,CT,IIB,391,343,*,340,444,400,*,393,9,7,5,3,24
1378,Central Connecticut St.Univ.,CT,IIA,666,534,397,518,856,700,536,680,118=
,119,137,16,390
1379,Connecticut College,CT,IIB,619,461,366,499,810,613,477,654,63,35,30,11,=
140
1380,Western Conn. State Univ.,CT,IIA,658,516,477,575,883,711,652,778,90,36,=
50,2,178
1385,Fairfield University,CT,IIA,685,545,452,545,894,733,603,721,62,43,81,6,=
192
1397,University of New Haven,CT,IIA,524,450,401,471,656,576,513,596,72,44,30=
,1,152
1402,Quinnipiac College,CT,IIA,697,540,412,553,877,686,531,701,82,51,64,10,2=
07
1403,Sacred Heart University,CT,IIB,546,444,374,435,686,566,478,553,19,55,30=
,7,111
1406,Southern Conn. State Univ.,CT,IIA,644,514,385,522,819,673,516,678,160,1=
25,120,12,417
1409,Saint Joseph College,CT,IIA,548,451,360,430,654,544,432,517,8,34,22,1,6=
5
1414,Trinity College,CT,IIB,706,501,394,550,901,650,494,704,57,49,32,0,146
1416,University of Bridgeport,CT,IIA,505,437,360,434,644,551,463,553,32,29,2=
6,1,90
1422,University of Hartford,CT,IIA,529,445,380,439,660,566,492,558,76,131,11=
1,3,329
1424,Wesleyan University,CT,IIA,734,504,423,597,936,641,539,761,128,57,66,0,=
254
1425,Eastern Connecticut St.Univ.,CT,IIA,650,515,400,535,856,689,547,714,47,=
47,33,0,127
1426,Yale University,CT,I,928,522,444,708,1127,643,548,863,404,118,191,6,767
1434,American University,DC,I,746,520,417,555,897,641,505,673,165,119,125,37=
,446
1437,Catholic Univ. of America,DC,I,611,449,385,482,718,533,459,570,123,141,=
104,6,374
1443,Gallaudet University,DC,IIA,623,480,399,482,814,638,534,637,86,67,70,35=
,261
1444,George Washington University,DC,I,729,542,447,610,874,653,536,733,316,1=
75,134,12,637
1445,Georgetown University,DC,I,857,552,427,618,1080,710,546,785,192,157,154=
,25,528
1448,Howard University,DC,I,656,483,403,481,780,591,494,587,241,282,189,111,=
891
1452,Mount Vernon College,DC,IIB,*,360,288,330,*,453,364,413,3,10,17,0,30
1460,Trinity College,DC,IIB,457,362,293,350,536,435,349,415,12,12,21,2,47
29100,Univ.of District Columbia,DC,IIA,559,476,390,491,686,586,482,604,184,1=
13,95,8,400
1428,Delaware State University,DE,IIA,545,435,359,379,716,583,491,515,29,47,=
61,34,183
1429,Goldey Beacom College,DE,IIB,492,405,*,417,613,511,*,528,8,14,3,1,26
1431,University of Delaware,DE,I,723,531,422,556,922,693,554,721,341,319,217=
,65,953
1433,Wesley College,DE,IIB,448,373,334,376,565,449,396,456,14,12,22,1,49
1466,Barry University,FL,IIA,488,420,350,394,598,508,424,477,39,77,84,15,215
1468,St. Thomas University,FL,IIA,438,482,351,403,520,570,421,480,23,22,37,4=
,90
1479,Embry-Riddle Aero University,FL,IIA,457,369,310,365,556,452,383,446,70,=
130,84,7,299
1480,Florida A & M University,FL,IIA,524,426,359,424,661,543,460,540,103,123=
,111,27,364
1481,Florida Atlantic University,FL,IIA,580,426,394,461,750,559,517,601,183,=
147,159,30,528
1487,Eckerd College,FL,IIB,534,424,357,436,676,547,472,563,32,18,37,0,87
1488,Florida Southern College,FL,IIB,440,369,331,369,552,473,409,463,30,18,4=
4,4,96
1489,Florida State University,FL,I,564,399,378,473,729,525,494,616,510,316,1=
92,16,1038
1515,Rollins College,FL,IIA,542,420,321,457,678,519,378,564,78,43,26,7,154
1531,Stetson University,FL,IIA,622,437,370,477,794,561,467,605,61,52,65,2,18=
5
1535,University of Florida,FL,I,613,430,399,501,790,567,527,653,981,721,510,=
49,2261
1536,University of Miami,FL,I,693,510,408,513,895,654,514,659,291,200,147,20=
,769
1537,University of South Florida,FL,I,571,418,369,455,735,547,483,591,387,31=
9,239,45,1038
1538,University of Tampa,FL,IIB,495,425,371,416,593,513,438,497,36,37,46,4,1=
27
3954,University Central Florida,FL,IIA,560,420,369,435,698,527,465,545,176,2=
07,162,42,593
3955,University of West Florida,FL,IIA,489,391,350,390,636,505,458,507,59,65=
,75,22,221
8849,Palm Beach Atlantic College,FL,IIB,413,369,333,348,491,451,390,412,11,1=
4,28,13,66
9635,Florida Internat'l Univ.,FL,IIA,558,423,395,433,719,553,509,562,182,261=
,220,76,767
9841,University of North Florida,FL,IIB,498,405,343,408,663,544,462,547,73,8=
1,57,19,230
1542,Agnes Scott College,GA,IIB,527,421,356,426,651,528,441,528,19,24,19,4,6=
6
1544,Albany State College,GA,IIB,444,395,335,371,578,519,437,484,38,24,68,8,=
138
1546,Armstrong State College,GA,IIB,462,367,315,347,588,457,391,434,38,32,11=
9,12,201
1552,Augusta College,GA,IIA,503,409,336,383,645,520,431,489,40,43,79,21,183
1554,Berry College,GA,IIB,515,403,343,399,650,519,439,509,25,20,38,3,92
1561,Columbus College,GA,IIA,456,375,333,396,588,491,437,515,75,50,51,2,178
1564,Emory University,GA,I,796,547,451,608,972,686,567,753,203,177,161,8,549
1566,Fort Valley State College,GA,IIB,471,382,339,379,596,490,439,487,37,39,=
49,17,142
1569,Georgia Institute of Tech.,GA,I,684,517,462,558,862,665,594,711,235,206=
,167,17,626
1570,Southern Coll. of Technology,GA,IIB,457,386,360,398,587,496,460,511,44,=
58,40,4,146
1572,Georgia Southern University,GA,IIA,495,408,328,363,623,509,407,453,105,=
135,254,109,603
1574,Georgia State University,GA,I,666,474,390,502,817,594,493,624,258,254,2=
41,40,793
1577,Kennesaw State College,GA,IIA,523,428,353,399,661,542,445,506,69,116,11=
1,54,350
1580,Mercer University-Entire,GA,IIA,555,423,351,433,686,538,435,540,76,78,8=
1,11,246
1586,Oglethorpe University,GA,IIB,516,454,329,450,630,550,390,546,21,9,10,0,=
44
1591,Shorter College,GA,IIB,370,308,294,317,439,368,355,379,16,17,17,5,55
1598,University of Georgia,GA,I,619,444,378,489,768,553,464,607,650,552,391,=
64,1658
1599,Valdosta State University,GA,IIA,477,386,344,390,603,496,445,500,88,90,=
114,19,311
1601,West Georgia College,GA,IIA,466,391,353,392,595,502,454,502,98,50,97,27=
,272
1602,Georgia College,GA,IIA,447,388,340,373,571,496,440,479,47,41,80,11,179
3484,Covenant College,GA,IIB,429,371,312,388,519,492,390,484,19,12,6,1,38
1610,Univ. of Hawaii at Manoa,HI,I,713,532,458,570,887,677,587,719,442,285,2=
72,100,1099
21078,Univ. of Hawaii-West Oahu,HI,IIB,513,*,396,449,654,*,512,576,8,4,8,0,2=
0
29020,Univ. of Hawaii at Hilo,HI,IIB,576,461,414,467,731,591,534,598,43,47,3=
7,14,141
1846,Briar Cliff College,IA,IIB,367,324,286,313,473,412,359,398,16,13,28,3,6=
0
1847,Buena Vista College,IA,IIB,484,416,339,382,606,522,440,486,20,12,30,10,=
72
1850,Central University of Iowa,IA,IIB,464,413,334,395,572,507,405,483,23,36=
,22,8,89
1852,Clarke College,IA,IIB,436,361,312,338,512,445,379,407,11,10,25,8,54
1854,Coe College,IA,IIB,516,421,340,436,671,541,459,570,30,21,22,0,73
1856,Cornell College,IA,IIB,578,426,368,468,693,534,463,574,31,22,17,5,75
1859,Dordt College,IA,IIB,411,356,308,355,548,470,406,472,30,14,16,12,72
1860,Drake University,IA,IIA,601,458,409,481,762,578,496,600,101,61,107,16,2=
85
1866,Graceland College,IA,IIB,411,331,301,345,490,401,366,418,26,11,29,1,70
1867,Grand View College,IA,IIB,385,320,295,329,481,405,377,416,22,31,20,2,75
1868,Grinnell College,IA,IIB,642,517,405,513,809,641,496,638,46,36,52,3,139
1869,Iowa State University,IA,I,684,506,404,534,842,635,514,666,467,353,284,=
84,1188
1873,Loras College,IA,IIB,419,363,314,363,531,438,378,445,37,35,31,6,109
1874,Luther College,IA,IIB,478,399,347,404,630,548,445,531,63,26,50,16,155
1879,Morningside College,IA,IIB,389,331,303,341,495,414,365,425,20,29,16,1,6=
6
1880,Mount Mercy College,IA,IIB,379,356,334,337,465,427,396,405,7,20,28,8,63
1881,Mount St. Clare College,IA,IIA,*,*,*,302,*,*,*,373,0,0,0,0,18
1883,Northwestern College,IA,IIB,430,372,311,344,531,477,394,434,9,16,27,6,5=
8
1887,Simpson College,IA,IIB,491,377,339,394,645,473,434,504,25,11,17,14,67
1889,St. Ambrose University,IA,IIB,431,374,325,362,541,471,401,450,29,15,44,=
8,98
1890,University of Northern Iowa,IA,IIA,586,469,390,447,730,591,491,561,155,=
152,226,89,622
1891,University of Dubuque,IA,IIB,351,315,309,323,443,392,358,396,19,23,14,2=
,58
1892,University of Iowa,IA,I,706,509,432,579,872,643,549,723,486,308,260,10,=
1064
1893,Upper Iowa University,IA,IIB,*,*,287,303,*,*,348,366,4,5,6,12,27
1896,Wartburg College,IA,IIB,447,370,308,358,564,469,385,451,25,21,29,4,89
1899,Teikyo Westmar University,IA,IIB,*,314,289,292,*,388,355,359,5,13,22,14=
,54
1900,William Penn College,IA,IIB,351,312,269,294,420,386,335,363,8,11,19,7,4=
5
1616,Boise State University,ID,IIA,448,391,354,391,566,498,453,498,157,111,1=
00,7,427
1617,Albertson Coll. of Idaho,ID,IIB,424,338,266,336,540,430,338,428,16,20,1=
9,1,56
1620,Idaho State University,ID,IIA,466,382,337,368,588,487,433,471,128,99,11=
3,120,460
1621,Lewis-Clark State College,ID,IIB,391,329,292,338,499,425,381,436,39,35,=
35,1,110
1624,Northwest Nazarene College,ID,IIB,*,*,*,341,*,*,*,448,0,0,0,0,71
1626,University of Idaho,ID,I,514,408,373,438,640,514,472,550,217,165,155,9,=
546
1633,Augustana College,IL,IIB,527,425,362,418,648,523,449,517,41,28,50,18,13=
7
1634,Aurora University,IL,IIB,434,379,339,372,528,461,402,447,18,16,19,16,69
1635,Barat College,IL,IIB,507,405,333,402,599,473,394,474,9,9,14,0,32
1639,Blackburn University,IL,IIB,*,*,*,312,*,*,*,370,0,0,0,0,23
1641,Bradley University,IL,IIA,570,464,378,442,679,562,449,529,75,88,100,30,=
295
1664,College of Saint Francis,IL,IIB,446,422,345,392,551,524,435,489,12,15,2=
3,0,50
1665,Columbia College,IL,IIB,*,*,*,349,*,*,*,446,0,0,0,0,171
1666,Concordia University,IL,IIB,399,351,295,351,487,435,374,435,30,23,24,1,=
78
1671,DePaul University,IL,IIA,702,543,427,524,857,681,527,648,120,173,152,55=
,500
1674,Eastern Illinois University,IL,IIA,442,373,333,364,515,438,393,428,190,=
161,120,87,560
1678,Eureka College,IL,IIB,*,370,315,355,*,458,390,438,5,16,16,0,37
1684,Greenville College,IL,IIB,374,331,292,336,466,424,370,422,27,11,15,4,57
1688,Illinois College,IL,IIB,522,424,347,424,621,503,410,502,16,18,14,3,51
1691,Illinois Institute of Tech.,IL,I,680,480,452,512,836,606,558,636,93,81,=
73,11,287
1692,Illinois State University,IL,I,548,436,373,460,638,514,445,541,289,187,=
244,0,720
1693,Northeastern Illinois Univ.,IL,IIA,460,378,359,394,529,439,418,455,139,=
88,71,0,331
1694,Chicago State University,IL,IIA,446,369,320,345,509,425,371,399,120,65,=
77,14,351
1696,Illinois Wesleyan University,IL,IIB,570,452,374,445,729,593,477,572,32,=
42,47,8,129
1700,Judson College,IL,IIB,400,358,305,358,486,445,366,438,10,12,6,1,29
1703,Kendall College,IL,IIB,*,357,*,319,*,423,*,377,1,11,3,4,19
1704,Knox College,IL,IIB,508,414,342,432,650,518,416,544,35,17,20,5,77
1706,Lake Forest College,IL,IIB,644,475,402,495,843,650,543,662,26,22,24,5,8=
1
1707,Lewis University,IL,IIA,467,392,330,357,561,481,407,437,37,20,29,52,138
1710,Loyola Univ. of Chicago,IL,I,761,536,433,570,924,664,536,701,164,230,16=
3,6,563
1717,MacMurray College,IL,IIB,324,263,250,262,393,334,307,318,13,9,16,31,69
1722,McKendree College,IL,IIB,433,397,341,381,539,493,407,467,16,10,16,5,47
1724,Millikin University,IL,IIB,478,409,313,386,583,501,383,472,34,38,46,6,1=
24
1725,Monmouth College,IL,IIB,443,339,325,381,544,412,385,464,20,12,11,1,44
1733,National-Louis University,IL,IIA,490,405,337,348,566,472,394,405,20,51,=
120,23,253
1734,North Central College,IL,IIB,473,399,348,398,588,501,437,497,24,40,28,5=
,97
1735,North Park College,IL,IIB,415,337,285,339,540,426,352,431,23,18,18,2,65
1737,Northern Illinois University,IL,I,578,435,375,440,667,509,443,515,314,2=
66,246,112,944
1739,Northwestern University,IL,I,860,596,496,712,1045,735,602,868,460,209,2=
03,0,872
1741,Olivet Nazarene University,IL,IIA,391,335,278,320,476,412,346,395,26,22=
,36,8,92
1744,Principia College,IL,IIB,465,400,345,395,572,540,414,490,20,9,13,7,49
1745,Quincy University,IL,IIB,372,371,285,345,459,462,351,427,18,21,14,2,55
1749,Roosevelt University,IL,IIA,484,405,359,416,610,517,464,531,50,58,42,2,=
152
1750,Rosary College,IL,IIB,448,378,377,382,543,479,454,468,10,25,34,3,72
1758,Southern Ill.Univ-Carbondale,IL,I,564,436,359,422,657,517,431,500,272,2=
55,313,33,977
1759,Southern Ill.Univ-Edwardsvle,IL,IIA,531,442,389,453,616,520,462,531,168=
,126,95,24,421
1767,Illinois Benedictine College,IL,IIA,463,395,315,409,576,493,403,511,38,=
36,17,0,91
1768,Saint Xavier University,IL,IIA,551,452,388,439,667,548,471,531,22,78,53=
,6,159
1772,Trinity College,IL,IIB,*,346,291,320,*,406,347,377,5,11,13,2,31
1774,University of Chicago,IL,I,894,586,515,742,1104,724,636,916,467,138,161=
,36,802
1775,Univ. of Illinois-Urbana,IL,I,682,493,421,570,783,574,494,659,927,520,3=
93,1,1868
1776,Univ. of Illinois-Chicago,IL,I,656,476,411,513,755,555,483,596,401,369,=
296,20,1135
1780,Western Illinois University,IL,IIA,506,427,350,421,587,500,414,493,241,=
171,123,62,606
1781,Wheaton College,IL,IIA,510,437,368,452,640,569,461,574,67,54,32,3,156
3970,Parks Coll.of St.Louis Univ.,IL,IIB,576,540,396,487,694,660,480,591,15,=
12,16,4,47
9333,Sangamon State University,IL,IIA,499,437,370,433,594,516,447,516,50,62,=
46,5,163
1785,Anderson University,IN,IIB,415,340,316,347,532,427,389,437,43,45,36,14,=
138
1786,Ball State University,IN,I,517,410,332,384,666,537,438,501,297,160,350,=
155,965
1787,Bethel College,IN,IIB,*,*,285,295,*,*,363,376,5,4,26,1,36
1788,Butler University,IN,IIA,521,442,366,439,650,551,447,544,72,66,77,3,220
1792,DePauw University,IN,IIB,540,433,361,452,695,570,465,587,51,57,38,0,146
1793,Earlham College,IN,IIB,514,394,338,445,639,483,414,551,44,13,22,0,79
1795,University of Evansville,IN,IIA,500,415,351,414,602,505,415,496,57,43,5=
8,4,170
1798,Franklin College of Indiana,IN,IIB,440,363,325,381,549,453,411,477,24,1=
6,20,0,60
1799,Goshen College,IN,IIB,388,341,291,345,479,410,344,418,37,19,28,0,84
1800,Grace College,IN,IIB,326,264,228,285,439,372,334,395,14,11,6,0,31
1801,Hanover College,IN,IIB,555,437,377,432,682,539,455,524,28,16,35,13,92
1803,Huntington College,IN,IIB,438,367,305,358,544,455,379,444,11,11,13,3,38
1804,University of Indianapolis,IN,IIA,487,408,358,382,620,515,433,469,16,38=
,52,19,125
1808,Univ. of Southern Indiana,IN,IIA,493,421,377,384,636,545,477,491,35,38,=
58,50,181
1809,Indiana Univ.-Bloomington,IN,I,674,479,399,540,852,615,507,685,624,344,=
305,1,1361
1811,Indiana Univ.-East,IN,IIB,*,405,327,341,*,529,424,443,5,12,24,0,59
1812,Indiana-Purdue U.-Fort Wayne,IN,IIA,498,408,340,385,648,534,444,503,53,=
106,123,15,303
1813,Indiana Univ.-Indianapolis,IN,IIA,643,469,405,469,820,604,514,599,170,2=
17,215,1,688
1814,Indiana Univ. at Kokomo,IN,IIB,519,432,380,397,665,548,482,504,13,21,29=
,0,81
1815,Indiana Univ.-Northwest,IN,IIA,544,446,355,410,694,575,449,522,25,63,33=
,0,152
1816,Indiana Univ. at South Bend,IN,IIA,544,445,391,420,696,571,495,537,32,5=
6,57,0,175
1817,Indiana Univ.-Southeast,IN,IIA,529,408,369,422,679,526,470,540,41,24,42=
,0,125
1820,Manchester College,IN,IIB,412,340,289,340,527,416,348,420,24,22,17,11,7=
4
1821,Marian College,IN,IIB,420,329,303,330,520,411,379,411,15,23,34,5,79
1822,Indiana Wesleyan University,IN,IIB,396,342,294,335,492,431,367,418,22,2=
3,34,2,81
1824,Oakland City College,IN,IIB,*,282,252,269,*,340,314,328,3,11,10,4,28
1825,Purdue Univ.-Main Campus,IN,I,721,485,423,562,920,631,548,722,603,411,4=
00,29,1443
1827,Purdue University-Calumet,IN,IIA,519,413,364,405,677,541,479,530,47,105=
,74,21,247
1830,Rose-Hulman Inst. of Tech.,IN,IIB,608,522,447,549,797,679,568,715,51,29=
,21,0,101
1832,Saint Francis College,IN,IIB,*,334,313,316,*,393,371,373,3,8,21,5,37
1833,Saint Joseph's College,IN,IIB,373,374,312,344,486,478,400,443,13,12,19,=
1,45
1834,Calumet College of St.Joseph,IN,IIB,324,264,235,265,426,350,316,353,6,6=
,9,2,23
1835,Saint Mary-of-the-Woods Coll,IN,IIB,307,234,199,232,382,295,246,290,11,=
11,18,4,44
1836,Saint Mary's College,IN,IIB,524,391,331,388,675,509,435,505,21,43,52,1,=
117
1837,Saint Meinrad College,IN,IIB,357,*,*,332,405,*,*,376,6,3,5,1,15
1838,Taylor University,IN,IIB,404,352,300,355,555,486,382,480,36,31,25,3,95
1839,Tri-State University,IN,IIB,395,324,291,340,485,395,356,415,23,28,10,3,=
64
1840,University of Notre Dame,IN,I,798,562,470,637,985,701,573,787,274,195,1=
64,11,644
1842,Valparaiso University,IN,IIA,559,423,372,446,681,525,459,548,67,58,74,5=
,204
1844,Wabash College,IN,IIB,612,474,371,501,770,602,482,637,31,22,20,1,74
9563,Indiana State University,IN,I,500,394,343,423,647,513,438,545,248,133,1=
51,16,548
1903,Baker University,KS,IIB,369,318,288,327,443,396,346,397,18,18,16,0,52
1904,Bethany College,KS,IIB,335,280,248,281,415,360,308,350,16,9,24,2,51
1905,Bethel College,KS,IIB,325,285,267,285,408,356,336,358,16,19,8,5,48
1915,Fort Hays State University,KS,IIA,446,378,325,377,556,475,412,474,84,56=
,71,21,232
1926,Pittsburg State University,KS,IIA,450,381,331,375,567,484,425,477,103,7=
6,70,4,291
1927,Emporia State University,KS,IIA,435,390,330,367,553,499,427,471,67,67,7=
8,26,238
1928,Kansas State University,KS,I,550,419,368,440,686,530,466,554,305,231,25=
9,63,858
1929,Kansas Wesleyan University,KS,IIB,337,290,265,293,394,343,299,340,11,14=
,10,3,38
1933,McPherson College,KS,IIB,318,274,254,272,397,353,313,342,7,16,11,3,37
1937,Ottawa University,KS,IIB,338,292,264,284,410,348,309,338,13,12,22,8,55
1940,Southwestern College,KS,IIB,340,318,278,311,415,388,341,380,16,10,10,3,=
39
1943,Saint Mary College,KS,IIB,336,301,261,282,390,358,313,335,10,11,15,5,43
1946,Tabor College,KS,IIB,304,*,222,257,385,*,282,326,8,5,8,3,24
1948,University of Kansas-Main,KS,I,579,422,367,485,714,529,458,603,474,297,=
204,6,981
1949,Washburn University,KS,IIA,594,438,333,457,719,540,416,561,76,55,59,11,=
201
1950,Wichita State University,KS,IIA,555,417,361,415,679,518,450,514,101,154=
,188,24,467
7032,Mid-America Nazarene College,KS,IIB,371,305,265,300,457,378,329,372,18,=
12,24,6,60
10256,Benedictine College,KS,IIB,335,316,278,296,374,368,327,342,11,16,16,7,=
50
1954,Bellarmine College,KY,IIA,473,385,326,394,583,480,396,482,32,18,27,7,84
1955,Berea College,KY,IIB,552,428,355,436,675,518,421,525,32,43,31,6,112
1958,Brescia College,KY,IIB,*,322,273,299,*,390,324,357,4,10,14,4,32
1959,Campbellsville College,KY,IIB,342,278,252,277,422,350,318,347,12,11,16,=
7,46
1960,Spalding University,KY,IIB,359,315,289,313,416,370,333,363,15,22,26,3,6=
6
1961,Centre College,KY,IIB,521,418,351,431,653,514,423,532,27,21,21,4,73
1962,Cumberland College,KY,IIB,354,291,272,286,438,362,337,355,17,23,32,20,9=
7
1963,Eastern Kentucky University,KY,IIA,519,439,371,442,648,551,468,555,237,=
135,185,29,586
1964,Georgetown College,KY,IIB,398,338,297,343,493,418,352,420,29,18,19,6,72
1968,Kentucky State University,KY,IIB,460,403,329,377,576,505,416,474,26,35,=
52,5,118
1969,Kentucky Wesleyan College,KY,IIB,383,326,292,327,474,404,358,405,17,18,=
11,5,51
1972,Lindsey Wilson College,KY,IIB,*,359,278,294,*,427,331,349,2,7,11,18,38
1976,Morehead State University,KY,IIA,478,395,322,373,600,498,410,472,87,89,=
123,37,336
1977,Murray State University,KY,IIA,462,396,342,383,601,520,451,503,95,101,1=
01,7,336
1980,Pikeville College,KY,IIB,359,314,275,304,434,377,332,367,8,25,15,3,51
1987,Transylvania University,KY,IIB,447,393,318,384,627,526,424,521,18,25,18=
,2,63
1988,Union College,KY,IIB,314,287,255,277,383,353,304,335,11,20,8,9,48
1989,University of Kentucky,KY,I,634,473,418,521,760,574,504,628,470,416,308=
,6,1200
1999,University of Louisville,KY,I,584,442,368,476,715,547,449,584,276,208,1=
69,12,674
2001,Thomas More College,KY,IIB,352,324,277,312,432,394,345,382,12,30,18,1,6=
2
2002,Western Kentucky University,KY,IIA,485,408,347,413,613,517,442,524,223,=
135,144,43,553
9275,Northern Kentucky University,KY,IIA,506,427,350,388,623,529,432,478,83,=
96,90,14,341
2003,Centenary College of La.,LA,IIB,499,380,324,412,625,468,396,512,28,20,1=
6,2,66
2004,Dillard University,LA,IIB,494,373,342,350,567,437,398,406,8,15,59,10,96
2005,Nicholls State University,LA,IIB,440,361,316,338,535,439,385,412,72,67,=
82,40,286
2006,Grambling State University,LA,IIA,442,392,329,349,491,437,369,391,48,48=
,124,45,265
2007,Louisiana College,LA,IIB,375,324,308,338,484,427,401,440,25,13,18,4,60
2008,Louisiana Tech University,LA,IIA,472,408,344,391,549,494,418,467,129,93=
,131,36,389
2010,Louisiana St.Univ.and A&M C.,LA,I,594,437,379,464,711,527,461,559,561,3=
87,313,178,1439
2013,Louisiana St.Univ.Shreveport,LA,IIA,458,414,337,385,539,498,403,458,53,=
37,48,18,156
2015,University of New Orleans,LA,IIA,512,378,352,404,609,453,423,483,199,12=
8,116,67,510
2016,Loyola University,LA,IIA,593,451,393,476,728,560,482,587,77,103,45,2,24=
1
2017,McNeese State University,LA,IIA,456,374,323,363,554,458,398,446,76,77,1=
04,33,290
2020,Northeast Louisiana Univ.,LA,IIA,459,376,325,343,559,458,396,418,88,102=
,159,100,449
2021,Northwestern State Univ.,LA,IIA,418,360,312,335,500,432,375,403,44,47,9=
8,34,223
2023,Our Lady of Holy Cross Coll.,LA,IIB,*,306,325,314,*,378,400,385,1,9,9,6=
,25
2024,Southeastern Louisiana Univ.,LA,IIA,468,405,329,348,566,486,398,421,68,=
68,163,90,389
2026,Southern Univ.at New Orleans,LA,IIB,406,329,298,320,487,397,361,387,23,=
22,64,11,120
2029,Tulane University,LA,I,713,514,418,564,876,646,514,699,172,166,115,3,45=
6
2031,Univ. Southwestern Louisiana,LA,I,533,409,359,402,633,493,434,483,147,1=
36,167,98,548
2032,Xavier University of La.,LA,IIA,459,389,332,352,546,456,386,413,37,41,9=
1,34,203
9636,Southern Univ.A&M Coll.-Main,LA,IIA,455,392,336,367,538,464,398,434,100=
,88,210,48,446
2115,Amherst College,MA,IIB,726,516,425,610,917,661,546,774,87,23,43,0,153
2117,Anna Maria College,MA,IIB,407,364,318,341,499,470,377,416,6,9,14,4,33
2118,Assumption College,MA,IIB,479,400,325,385,610,518,413,492,22,42,40,3,10=
7
2120,Merrimack College,MA,IIB,507,393,326,395,652,518,407,510,24,63,38,0,125
2121,Babson College,MA,IIB,787,613,557,633,975,769,700,790,31,45,31,3,119
2124,Bentley College,MA,IIA,717,566,493,575,894,708,599,712,48,84,56,10,198
2126,Berklee College of Music,MA,IIB,504,402,329,381,605,491,405,466,17,59,6=
1,2,139
2128,Boston College,MA,I,784,569,496,614,964,717,604,761,165,245,126,10,556
2132,Bradford College,MA,IIB,447,352,310,346,557,450,384,435,9,18,8,6,41
2133,Brandeis University,MA,I,687,493,403,550,859,619,496,686,142,71,40,3,29=
9
2139,Clark University,MA,IIA,664,469,395,522,822,593,488,651,58,64,38,0,160
2140,Coll.of Our Lady of the Elms,MA,IIB,431,353,305,342,524,429,371,415,10,=
18,19,5,52
2141,College of the Holy Cross,MA,IIB,695,506,406,519,875,627,500,644,44,84,=
54,4,186
2146,Emerson College,MA,IIA,669,502,386,488,874,652,494,632,21,33,35,3,92
2153,Gordon College,MA,IIB,432,352,319,381,578,467,424,505,35,18,13,5,71
2155,Harvard University,MA,I,1009,559,500,793,1236,723,653,989,654,149,255,8=
,1172
2158,Lasell College,MA,IIB,*,336,322,320,*,403,389,387,3,7,13,4,27
2161,Univ. of Mass. at Lowell,MA,I,664,539,464,587,805,662,577,717,223,191,5=
2,10,476
2178,Massachusetts Inst. of Tech.,MA,I,903,637,528,757,1124,806,678,951,583,=
177,164,36,989
2183,Bridgewater State College,MA,IIA,517,440,400,468,672,583,542,617,144,53=
,41,17,255
2184,Fitchburg State College,MA,IIA,512,429,395,444,644,540,501,560,87,56,70=
,11,224
2187,North Adams State College,MA,IIB,510,394,361,428,642,507,468,546,34,34,=
21,2,91
2189,Westfield State College,MA,IIA,523,419,378,457,662,530,478,578,79,46,44=
,0,169
2190,Worcester State College,MA,IIA,528,456,370,463,669,585,483,593,81,44,30=
,13,168
2192,Mount Holyoke College,MA,IIB,694,505,400,541,866,645,496,678,73,47,51,3=
,191
2199,Northeastern University,MA,I,688,525,460,543,880,689,599,705,236,260,17=
6,0,730
2206,Regis College,MA,IIB,504,425,345,407,627,542,426,513,9,20,14,1,46
2208,Simmons College,MA,IIA,589,471,386,477,724,592,482,593,54,54,53,6,167
2209,Smith College,MA,IIA,732,514,405,591,932,646,502,747,127,70,59,6,262
2210,Univ. of Mass.-Dartmouth,MA,IIA,572,482,420,526,722,611,535,665,203,61,=
32,1,321
2211,Springfield College,MA,IIA,520,404,321,376,643,501,399,467,34,45,78,17,=
174
2217,Stonehill College,MA,IIB,513,428,354,423,657,541,458,539,24,56,36,0,116
2218,Suffolk University,MA,IIA,727,548,484,611,925,706,599,777,111,73,33,15,=
232
2219,Tufts University,MA,I,735,549,447,592,964,710,607,777,148,157,98,2,405
2221,Univ. Massachussets-Amherst,MA,I,704,537,438,607,880,680,557,762,650,30=
6,146,7,1172
2222,Univ. Massachusetts-Boston,MA,IIA,656,543,445,549,813,679,563,686,154,1=
86,100,1,473
2224,Wellesley College,MA,IIB,757,550,453,603,988,712,570,779,97,44,74,4,222
2226,Western New England College,MA,IIA,659,497,437,543,823,632,545,682,54,4=
2,29,6,131
2227,Wheaton College,MA,IIB,602,435,357,486,740,539,448,601,44,16,25,6,91
2228,Wheelock College,MA,IIA,545,420,362,415,662,518,433,505,8,20,20,1,49
2229,Williams College,MA,IIB,707,503,417,543,923,669,566,719,77,36,88,0,213
2233,Worcester Polytechnic Inst.,MA,IIA,659,527,451,546,842,680,557,693,75,7=
0,58,4,212
1436,Capitol College,MD,IIB,*,344,*,352,*,406,*,416,5,7,5,0,17
2062,Bowie State University,MD,IIA,510,433,349,401,647,554,452,515,31,28,51,=
14,127
2065,College of Notre Dame of Md.,MD,IIB,443,377,309,362,493,441,365,419,19,=
25,29,3,76
2067,Columbia Union College,MD,IIB,308,297,293,296,344,329,325,329,17,9,11,5=
,42
2068,Coppin State College,MD,IIB,557,435,366,431,707,559,476,554,26,32,36,4,=
103
2072,Frostburg State University,MD,IIA,498,423,366,416,646,538,468,530,76,56=
,70,8,228
2073,Goucher College,MD,IIB,529,387,358,411,661,489,452,518,21,27,23,4,75
2076,Hood College,MD,IIA,516,425,352,402,665,530,434,502,14,21,40,1,76
2077,Johns Hopkins University,MD,I,798,542,435,593,972,677,551,734,330,110,1=
60,52,767
2078,Loyola College in Maryland,MD,IIA,632,500,397,482,802,640,511,617,50,76=
,89,5,222
2083,Morgan State University,MD,IIA,594,517,439,450,743,651,558,571,26,41,91=
,42,229
2086,Mount Saint Mary's Coll.&Sem,MD,IIB,465,384,311,358,563,487,382,448,14,=
29,34,4,85
2091,Salisbury State University,MD,IIA,543,445,357,404,679,562,458,513,54,63=
,78,8,240
2092,Saint John's College-Main,MD,IIB,*,*,*,437,*,*,*,572,0,0,0,0,43
2095,St.Mary's Coll.of Maryland,MD,IIB,560,426,347,426,686,533,430,526,24,35=
,29,9,97
2099,Towson State University,MD,IIA,531,433,388,439,692,565,505,573,141,136,=
169,25,471
2101,U. S. Naval Academy,MD,IIB,595,455,377,492,721,556,466,600,125,100,67,7=
,299
2102,University of Baltimore,MD,IIA,680,560,490,582,833,693,612,719,62,50,54=
,0,166
2103,Univ.of Maryland-Coll. Park,MD,I,703,487,406,539,865,608,505,669,535,38=
8,163,133,1285
2105,Univ.of Maryland-Balto.Co.,MD,I,638,455,395,464,783,571,491,577,87,119,=
104,32,353
2106,Univ.of Maryland-Estrn Shore,MD,IIA,500,455,388,379,630,572,493,482,8,3=
3,25,5,113
2108,Washington College,MD,IIB,496,419,348,443,637,532,421,562,33,12,15,0,60
2109,Western Maryland College,MD,IIB,477,379,313,412,612,489,400,530,36,30,1=
0,3,79
2033,Univ.of Maine at Presque Isl,ME,IIB,439,354,302,343,562,453,389,440,15,=
19,25,4,67
2036,Bates College,ME,IIB,671,490,404,518,824,600,494,635,45,31,45,6,127
2038,Bowdoin College,ME,IIB,738,527,418,554,918,651,503,682,41,40,35,4,123
2039,Colby College,ME,IIB,745,515,383,524,904,622,453,629,43,33,60,4,140
2040,Univ.of Maine at Farmington,ME,IIB,464,348,292,385,594,448,377,496,47,2=
6,13,14,101
2041,Univ.of Maine at Fort Kent,ME,IIB,436,347,320,356,555,442,415,456,9,10,=
12,2,33
2043,Husson College,ME,IIB,407,358,302,334,454,401,338,374,12,13,18,6,49
2050,University of New England,ME,IIA,450,380,323,354,545,468,396,434,11,22,=
39,4,76
2051,Saint Joseph's College,ME,IIB,*,321,283,295,*,391,353,370,4,8,33,0,45
2052,Thomas College,ME,IIB,*,338,297,318,*,404,341,374,2,7,8,0,17
2053,Univ.of Maine at Orono,ME,I,574,436,366,449,716,552,463,566,122,197,102=
,19,452
2055,Univ.of Maine at Machias,ME,IIB,465,355,284,360,582,459,366,462,7,24,8,=
0,39
6858,Unity College,ME,IIB,355,261,261,285,418,313,313,340,8,7,16,0,31
9762,Univ.of Maine at Southern,ME,IIA,584,439,362,459,724,558,459,578,78,144=
,61,7,291
2234,Adrian College,MI,IIB,439,365,316,386,559,466,407,493,37,8,14,7,66
2235,Albion College,MI,IIB,562,443,346,462,716,573,437,589,47,27,33,2,109
2236,Alma College,MI,IIB,523,408,335,422,645,515,423,527,25,27,21,2,75
2239,Aquinas College,MI,IIB,387,313,275,319,491,376,331,392,27,32,27,4,90
2241,Calvin College,MI,IIB,471,410,363,446,604,527,461,571,152,33,20,7,212
2243,Central Michigan University,MI,IIA,588,460,397,490,768,612,534,648,230,=
191,137,23,581
2247,Concordia College,MI,IIB,342,304,257,289,428,377,340,369,10,12,15,3,40
2252,William Tyndale College,MI,IIB,309,*,*,295,377,*,*,362,1,2,4,0,7
2259,Eastern Michigan University,MI,IIA,560,447,389,462,722,590,519,605,318,=
171,160,17,729
2260,Ferris State University,MI,IIA,546,470,409,467,713,631,566,628,143,160,=
151,10,477
2266,Grand Rapids Baptist College,MI,IIB,353,287,254,283,474,376,326,371,9,1=
9,12,4,44
2268,Grand Valley State Univ.,MI,IIB,568,479,387,467,726,619,508,604,91,105,=
118,7,321
2273,Hope College,MI,IIB,515,420,350,443,681,559,455,585,70,49,38,2,159
2275,Kalamazoo College,MI,IIB,553,440,352,452,696,569,440,571,36,25,24,7,92
2282,Madonna University,MI,IIB,482,395,352,382,576,465,430,459,19,12,42,11,8=
4
2284,Marygrove College,MI,IIB,433,365,290,348,534,450,358,429,7,26,13,3,49
2290,Michigan State University,MI,I,651,493,413,555,843,663,569,732,949,494,=
350,47,1840
2292,Michigan Technological Univ.,MI,IIA,668,482,420,511,854,638,563,671,99,=
124,95,11,338
2293,Lake Superior State Univ.,MI,IIB,510,446,357,422,661,596,473,557,32,35,=
38,7,112
2301,Northern Michigan University,MI,IIA,571,459,347,467,749,609,468,619,149=
,72,61,21,329
2307,Oakland University,MI,IIA,633,518,432,534,831,690,582,710,123,142,85,8,=
358
2308,Olivet College,MI,IIB,400,*,306,329,487,*,357,390,13,4,23,2,44
2314,Saginaw Valley State Univ.,MI,IIA,499,448,364,446,642,586,482,580,91,40=
,29,6,174
2316,Siena Heights College,MI,IIB,*,342,300,325,*,443,383,418,2,31,23,1,57
2318,Spring Arbor College,MI,IIB,368,321,284,320,455,398,370,400,22,15,19,6,=
62
2326,Univ.of Michigan-Dearborn,MI,IIA,552,452,408,451,701,583,531,582,70,66,=
51,0,219
2327,Univ.of Michigan-Flint,MI,IIA,566,460,409,437,708,582,522,555,43,46,57,=
1,184
2329,Wayne State University,MI,I,683,525,447,535,846,664,560,669,317,267,216=
,8,925
2330,Western Michigan University,MI,I,603,489,396,502,755,620,505,633,285,23=
3,189,24,731
4673,Baker College of Flint,MI,IIB,*,*,370,385,*,*,481,496,5,4,25,2,36
6771,Center for Creative Studies,MI,IIB,401,333,263,360,489,413,331,442,29,1=
1,6,2,48
9092,Univ.of Michigan-Ann Arbor,MI,I,777,577,460,605,955,731,595,760,850,419=
,472,9,1968
2334,Augsburg College,MN,IIB,432,356,314,357,559,449,387,450,35,29,58,1,123
2336,Bemidji State University,MN,IIA,490,403,341,419,629,520,443,539,91,40,5=
0,11,192
2340,Carleton College,MN,IIB,638,486,394,521,807,604,505,659,68,36,45,4,155
2341,College of Saint Benedict,MN,IIB,493,404,334,381,595,512,405,468,18,50,=
47,8,125
2342,College of St. Catherine,MN,IIB,428,369,326,356,515,448,385,427,27,53,5=
4,9,143
2343,College of St. Scholastica,MN,IIB,461,374,327,345,568,466,421,436,14,31=
,50,18,119
2345,University of St. Thomas,MN,IIA,563,429,366,402,702,538,465,508,31,104,=
146,29,310
2346,Concordia College-Moorhead,MN,IIB,527,419,356,413,638,503,426,496,47,38=
,60,21,166
2347,Concordia College-St. Paul,MN,IIB,407,363,319,353,493,443,394,433,14,12=
,23,1,50
2353,Gustavus Adolphus College,MN,IIB,486,402,338,408,625,507,423,518,59,47,=
44,12,162
2354,Hamline University,MN,IIA,556,451,342,461,706,575,424,583,58,29,27,8,12=
8
2358,Macalester College,MN,IIB,639,492,406,514,807,622,500,645,46,32,36,7,12=
1
2360,Mankato State University,MN,IIA,523,441,371,453,662,567,482,580,210,138=
,125,16,489
2367,Moorhead State University,MN,IIA,512,421,353,419,651,544,461,540,131,65=
,120,29,345
2371,Northwestern College,MN,IIB,373,339,313,333,510,454,406,441,13,16,27,1,=
57
2375,Southwest State University,MN,IIB,525,417,355,459,686,551,466,602,57,40=
,19,1,117
2377,St. Cloud State University,MN,IIA,518,417,354,441,662,546,464,570,259,1=
43,146,25,573
2379,St. John's University,MN,IIB,512,412,353,418,672,523,435,532,37,44,38,6=
,126
2380,Saint Mary's Coll. of Minn.,MN,IIA,488,396,295,389,595,483,358,473,28,2=
3,27,3,81
2382,St. Olaf College,MN,IIB,551,417,355,446,673,509,430,543,82,93,49,11,235
2388,Univ. Minnesota-Duluth,MN,IIA,551,446,386,458,719,591,520,606,90,112,72=
,11,285
2389,Univ. Minnesota-Morris,MN,IIB,533,399,334,389,697,534,457,522,27,23,45,=
17,112
2394,Winona State University,MN,IIB,515,420,358,430,652,537,454,547,118,73,8=
5,17,293
3969,Univ. Minnesota-Twin Cities,MN,I,662,468,418,557,842,613,552,719,785,46=
8,271,12,1538
9058,Bethel College,MN,IIB,430,356,313,375,597,464,404,503,43,48,12,7,110
2449,Avila College,MO,IIB,379,340,295,317,459,404,349,377,10,13,17,12,52
2453,Central Methodist College,MO,IIB,402,336,252,310,478,403,308,374,11,20,=
22,3,56
2454,Central Missouri State Univ.,MO,IIA,517,440,379,429,630,538,467,526,158=
,103,135,53,451
2456,Columbia College,MO,IIB,362,307,273,299,437,375,336,364,10,11,22,3,46
2460,Culver-Stockton College,MO,IIB,396,348,297,332,463,406,347,388,9,20,22,=
1,52
2461,Drury College,MO,IIB,448,394,323,375,546,483,400,460,26,23,31,2,87
2466,Harris-Stowe State College,MO,IIB,350,298,302,304,431,370,374,377,12,6,=
8,14,40
2473,Kansas City Art Institute,MO,IIB,440,*,299,373,535,*,357,450,26,1,13,7,=
47
2479,Lincoln University,MO,IIA,414,335,282,308,506,413,350,381,22,22,45,30,1=
19
2480,Lindenwood College,MO,IIA,416,367,306,340,477,422,354,392,15,27,55,0,97
2482,Maryville Univ. of St.Louis,MO,IIA,449,355,310,359,548,434,378,442,26,1=
3,27,12,78
2488,Missouri Southern State Coll,MO,IIB,489,406,349,389,592,496,430,476,42,=
50,67,28,187
2489,Missouri Valley College,MO,IIB,*,318,285,302,*,379,334,357,4,18,22,3,47
2490,Missouri Western State Coll.,MO,IIB,473,393,334,385,580,483,414,474,44,=
44,64,9,161
2495,Northeast Missouri St. Univ.,MO,IIA,505,411,342,385,615,502,422,473,54,=
103,142,27,328
2496,Northwest Missouri St. Univ.,MO,IIA,526,404,348,379,634,490,425,461,48,=
49,85,36,231
2498,Park College,MO,IIB,341,320,283,299,407,388,336,356,10,8,24,3,45
2499,Rockhurst College,MO,IIB,448,380,350,369,548,460,422,448,15,31,33,9,88
2500,College of The Ozarks,MO,IIB,446,392,350,393,547,483,425,482,27,25,23,4=
,79
2501,Southeast Missouri St. Univ.,MO,IIA,505,432,359,416,612,527,441,508,113=
,99,106,45,363
2503,Southwest Missouri St. Univ.,MO,IIA,516,422,364,417,617,510,441,502,247=
,151,180,43,671
2506,Saint Louis Univ.-Main,MO,I,657,475,402,500,783,575,484,600,133,111,120=
,31,395
2512,Stephens College,MO,IIB,*,*,*,282,*,*,*,364,0,0,0,0,62
2516,Univ.of Missouri-Columbia,MO,I,603,456,407,485,729,560,499,592,336,256,=
244,63,899
2517,Univ.of Missouri-Rolla,MO,I,663,508,454,564,802,626,557,686,114,79,56,4=
,253
2518,Univ.of Missouri-Kansas City,MO,I,580,445,381,473,702,545,467,577,151,1=
67,107,9,434
2519,Univ.of Missouri-St. Louis,MO,I,576,460,412,476,699,561,503,579,86,103,=
110,5,304
2520,Washington University,MO,I,782,534,451,601,952,652,540,730,264,136,175,=
18,620
2521,Webster University,MO,IIA,505,435,325,395,623,542,414,495,28,29,55,0,11=
5
2523,Westminster College,MO,IIB,451,390,298,381,549,481,361,465,17,17,12,4,5=
0
2524,William Jewell College,MO,IIB,422,342,306,364,529,458,391,463,42,12,31,=
3,88
2525,William Woods University,MO,IIB,370,303,290,312,476,374,350,390,13,13,1=
3,5,45
7540,Missouri Baptist College,MO,IIB,*,294,281,265,*,389,360,344,1,7,10,11,2=
9
9089,Hannibal-LaGrange College,MO,IIB,*,284,248,258,*,366,308,324,4,8,21,5,3=
8
2396,Alcorn State University,MS,IIB,419,371,326,320,534,473,414,406,25,35,35=
,73,168
2397,Belhaven College,MS,IIB,364,304,298,314,423,355,348,366,9,8,15,2,34
2398,Blue Mountain College,MS,IIB,284,259,*,263,347,315,*,322,6,12,5,2,25
2403,Delta State University,MS,IIA,400,337,314,337,487,413,386,413,60,32,47,=
36,175
2410,Jackson State University,MS,IIA,425,391,337,362,511,471,407,436,81,79,1=
14,54,328
2414,Millsaps College,MS,IIB,498,376,322,387,615,478,381,475,25,27,29,4,85
2422,Mississippi Univ. for Women,MS,IIA,400,*,306,324,492,*,379,400,33,5,44,=
30,112
2423,Mississippi State University,MS,I,540,432,389,455,649,521,471,548,278,1=
91,155,40,669
2424,Mississippi Valley St. Univ.,MS,IIB,359,331,287,297,456,423,370,382,25,=
17,38,26,106
2433,Rust College,MS,IIB,341,280,302,285,382,313,337,318,11,8,24,18,61
2439,Tougaloo College,MS,IIB,300,267,244,262,370,327,289,318,17,22,18,9,66
2440,University of Mississippi,MS,I,558,428,384,440,676,524,471,537,138,111,=
158,29,439
2441,Univ.of Southern Mississippi,MS,I,562,438,352,438,664,520,420,520,183,1=
62,160,58,563
2526,Carroll College,MT,IIB,394,343,285,326,478,413,344,394,12,23,29,0,64
2527,College of Great Falls,MT,IIB,361,305,258,299,459,367,312,364,10,19,7,7=
,43
2530,Eastern Montana College,MT,IIA,409,358,292,348,500,440,364,430,47,41,48=
,5,141
2531,Montana Coll.Min.Sci.& Tech.,MT,IIA,481,395,336,420,583,484,416,512,45,=
17,18,6,86
2532,Montana State University,MT,I,497,397,346,407,602,487,427,498,154,146,1=
44,24,468
2533,Northern Montana College,MT,IIA,403,342,309,332,493,425,384,411,15,19,4=
1,3,79
2536,University of Montana,MT,I,446,365,323,392,537,442,395,474,200,79,95,16=
,390
2537,Western Montana Coll.of UM,MT,IIA,388,330,289,313,473,407,359,386,8,12,=
22,4,46
2905,North Carolina A&T St. Univ.,NC,IIA,524,448,409,432,637,547,496,526,68,=
106,116,15,361
2906,Appalachian State University,NC,IIA,491,413,366,424,598,505,448,518,249=
,117,113,19,545
2907,Univ. of N.C. at Asheville,NC,IIB,533,436,350,417,647,532,430,510,40,41=
,37,4,147
2908,Barton College,NC,IIB,348,312,299,311,411,372,349,365,18,25,37,3,84
2909,Barber-Scotia College,NC,IIB,352,312,287,297,412,360,335,347,13,12,14,1=
3,52
2910,Belmont Abbey College,NC,IIB,348,316,281,309,434,392,350,384,8,21,17,0,=
46
2911,Bennett College,NC,IIB,351,377,300,323,418,437,346,375,9,16,16,11,52
2914,Catawba College,NC,IIB,395,326,288,342,490,394,345,418,30,12,23,1,66
2918,Davidson College,NC,IIB,626,460,356,506,801,591,440,644,60,34,32,4,130
2920,Duke University,NC,I,854,584,459,699,1055,728,553,862,330,149,141,0,620
2923,East Carolina University,NC,IIA,554,430,377,415,672,525,462,507,189,187=
,261,11,792
2926,Elizabeth City State Univ.,NC,IIB,472,415,338,398,580,510,420,489,32,32=
,16,3,105
2927,Elon College,NC,IIB,459,388,331,372,572,482,401,456,30,38,64,6,138
2928,Fayetteville State Univ.,NC,IIA,525,437,375,407,640,536,460,499,27,72,5=
0,4,193
2929,Gardner-Webb University,NC,IIB,348,305,294,312,414,357,349,371,39,7,26,=
15,87
2930,Greensboro College,NC,IIB,377,331,309,333,456,400,367,404,11,21,10,2,44
2931,Guilford College,NC,IIB,492,414,338,410,615,505,407,503,32,22,29,5,90
2933,High Point University,NC,IIB,475,397,330,349,591,496,407,435,14,25,35,9=
,94
2936,Johnson C. Smith University,NC,IIB,408,357,303,327,485,427,367,394,11,2=
7,34,12,84
2941,Lenoir-Rhyne College,NC,IIB,377,323,295,345,462,410,357,426,47,26,17,1,=
91
2942,Livingstone College,NC,IIB,*,257,263,259,*,292,298,294,5,12,22,14,53
2944,Mars Hill College,NC,IIB,356,308,259,309,426,378,309,372,35,16,18,11,80
2945,Meredith College,NC,IIB,440,373,328,366,517,442,387,431,26,30,31,16,103
2946,Methodist College,NC,IIB,348,309,295,316,416,371,353,379,21,21,19,1,62
2948,Montreat-Anderson College,NC,IIB,*,304,274,299,*,393,355,393,4,12,8,0,2=
4
2950,North Carolina Central Univ.,NC,IIA,551,447,373,423,670,547,460,518,56,=
84,70,9,263
2951,North Carolina Wesleyan Coll,NC,IIB,384,317,299,320,478,385,360,389,10,=
13,20,2,45
2954,Pembroke State University,NC,IIA,538,403,341,413,655,495,421,505,49,32,=
31,2,143
2955,Pfeiffer College,NC,IIB,395,322,269,337,471,381,321,401,23,9,15,2,49
2957,Queens College,NC,IIB,427,360,319,350,511,437,384,422,14,21,20,8,63
2960,Salem College,NC,IIB,378,349,283,324,466,451,349,407,9,15,17,3,44
2962,Shaw University,NC,IIB,*,321,293,292,*,383,348,345,5,19,43,25,92
2972,North Carolina State Univ.,NC,I,665,475,417,505,797,578,508,610,463,345=
,200,12,1235
2974,Univ. of N.C. at Chapel Hill,NC,I,701,512,410,565,837,620,498,678,572,3=
29,212,18,1268
2975,Univ. of N.C. at Charlotte,NC,IIA,568,448,385,441,686,546,470,536,173,1=
89,197,0,643
2976,Univ. of N.C. at Greensboro,NC,I,610,443,377,435,735,540,461,529,140,17=
8,135,8,572
2978,Wake Forest University,NC,IIA,685,526,433,557,837,641,508,674,135,86,74=
,18,323
2979,Warren Wilson College,NC,IIB,*,*,*,283,*,*,*,352,0,0,0,0,42
2981,Western Carolina University,NC,IIA,515,439,364,414,627,537,448,506,71,1=
06,93,1,319
2984,Univ. of N.C. at Wilmington,NC,IIA,533,419,366,421,648,511,449,514,94,1=
05,108,1,346
2985,Wingate College,NC,IIB,380,308,301,320,469,385,366,394,23,25,24,7,79
2986,Winston-Salem State Univ.,NC,IIB,480,421,365,407,587,516,451,500,39,48,=
30,6,149
2989,Dickinson State University,ND,IIB,402,342,302,316,506,432,376,397,9,14,=
33,13,71
2993,Mayville State University,ND,IIB,415,*,313,340,519,*,399,429,9,4,21,3,3=
7
2994,Minot State University,ND,IIA,457,383,331,347,563,477,416,436,34,41,68,=
16,188
3005,Univ. of North Dakota-Main,ND,I,460,391,345,379,572,489,431,473,130,124=
,163,27,472
3008,Valley City State University,ND,IIB,403,368,313,340,501,462,383,425,12,=
14,16,6,54
9265,North Dakota State Univ.,ND,IIA,473,391,353,398,545,458,420,467,130,125=
,149,6,423
2539,Chadron State College,NE,IIA,491,404,329,390,593,500,406,476,33,20,19,1=
9,91
2540,College of Saint Mary,NE,IIB,*,321,293,300,*,395,347,362,5,13,19,6,43
2541,Concordia Teachers College,NE,IIB,352,316,282,320,423,390,357,393,22,16=
,15,1,54
2542,Creighton University,NE,IIA,649,462,351,437,793,562,418,529,66,119,127,=
22,342
2543,Dana College,NE,IIB,338,300,276,300,404,368,336,364,11,11,11,3,36
2544,Doane College,NE,IIB,436,392,326,360,521,465,391,431,17,7,28,5,57
2548,Hastings College,NE,IIB,426,359,305,353,516,434,369,426,19,19,24,4,66
2551,Univ. of Nebraska at Kearney,NE,IIA,509,433,365,409,618,533,448,502,81,=
89,92,9,309
2553,Midland Lutheran College,NE,IIB,372,*,278,301,449,*,346,371,14,4,25,9,5=
2
2554,Univ.of Nebraska at Omaha,NE,IIA,528,446,417,452,635,540,507,547,149,11=
5,97,36,403
2555,Nebraska Wesleyan University,NE,IIB,454,381,327,396,548,468,400,481,37,=
23,25,2,87
2559,Peru State College,NE,IIB,483,402,308,367,584,493,385,452,14,8,19,9,50
2563,Union College,NE,IIB,290,293,272,288,358,359,334,354,18,14,7,1,40
2565,Univ.of Nebraska-Lincoln,NE,I,661,477,410,523,792,584,505,635,436,344,3=
16,31,1127
2566,Wayne State College,NE,IIA,481,411,324,394,585,501,399,482,46,25,41,13,=
125
9743,Bellevue College,NE,IIB,379,340,289,317,449,404,346,378,6,12,23,0,41
9862,Clarkson College,NE,IIB,*,407,377,368,*,469,434,425,1,6,8,11,26
2572,Colby-Sawyer College,NH,IIB,397,380,277,329,488,468,349,410,9,9,19,1,38
2573,Dartmouth College,NH,I,785,536,429,610,1002,686,532,774,163,89,114,5,37=
1
2575,Franklin Pierce College,NH,IIB,470,382,323,399,605,487,412,510,28,29,17=
,2,76
2579,New England College,NH,IIB,423,329,251,327,551,437,313,423,20,20,23,2,6=
5
2580,New Hampshire College,NH,IIA,567,425,356,459,728,558,464,597,31,32,15,5=
,83
2584,Notre Dame College,NH,IIB,335,299,261,286,393,383,312,349,6,11,13,4,34
2586,Rivier College,NH,IIA,449,363,331,365,541,419,392,429,12,29,18,7,66
2587,Saint Anselm College,NH,IIB,512,403,338,381,633,508,435,483,16,35,51,7,=
109
2589,University of New Hampshire,NH,I,587,454,375,482,729,575,483,607,196,25=
3,127,0,576
2590,Keene State College,NH,IIB,494,417,337,426,622,532,439,542,61,46,40,2,1=
49
2591,Plymouth State College,NH,IIB,518,405,354,431,650,518,458,548,59,55,38,=
6,158
2597,Bloomfield College,NJ,IIB,476,434,354,406,602,547,443,510,12,13,17,4,46
2599,Centenary College,NJ,IIB,*,305,252,266,*,371,310,326,1,10,16,9,36
2600,College of Saint Elizabeth,NJ,IIB,426,388,322,365,490,437,384,420,9,19,=
16,3,47
2603,Drew University,NJ,IIA,603,463,386,529,762,580,479,664,61,28,15,4,108
2608,Georgian Court College,NJ,IIB,490,425,373,403,592,509,450,487,19,13,30,=
8,71
2610,Felician College,NJ,IIB,*,351,311,320,*,422,375,385,1,14,24,5,44
2613,Jersey City State College,NJ,IIB,649,525,405,520,840,697,558,692,80,66,=
90,1,237
2616,Monmouth College,NJ,IIA,616,509,408,519,783,668,523,669,41,55,29,1,126
2617,Montclair State College,NJ,IIA,647,521,417,532,802,661,541,672,155,130,=
125,9,419
2621,New Jersey Inst. of Tech.,NJ,IIA,771,606,501,615,976,790,670,799,104,98=
,71,0,303
2622,Kean College of New Jersey,NJ,IIA,640,516,423,525,833,691,582,700,115,1=
07,115,3,340
2625,William Paterson College,NJ,IIB,653,519,409,535,859,687,541,707,120,97,=
88,7,312
2627,Princeton University,NJ,I,963,564,437,749,1154,686,534,901,402,66,179,1=
6,702
2628,Rider College,NJ,IIA,636,552,511,564,764,668,604,677,59,103,41,1,208
2631,Rutgers State Univ.-Newark,NJ,IIA,893,640,526,693,1097,812,682,871,141,=
125,73,16,374
2632,Seton Hall University,NJ,IIA,736,557,414,553,894,683,507,675,98,110,101=
,13,332
2638,Saint Peter's College,NJ,IIB,477,391,317,404,600,498,412,514,46,42,21,5=
,117
2639,Stevens Institute of Tech.,NJ,IIA,647,494,415,544,807,634,525,685,66,37=
,30,4,137
2642,Trenton State College,NJ,IIB,644,524,422,525,845,691,557,690,108,81,123=
,1,313
4741,Rutgers State Univ.-Camden,NJ,IIA,860,633,510,648,1060,805,664,820,61,7=
3,61,6,206
6964,Rutgers State Univ.-N.Brswck,NJ,I,846,611,478,665,1045,780,624,838,601,=
393,258,90,1374
8770,Fairleigh Dickinson Univ.,NJ,IIA,530,440,404,459,692,579,517,597,147,63=
,54,8,303
9344,Ramapo College of New Jersey,NJ,IIB,645,527,407,532,835,701,563,706,49,=
40,41,1,131
9345,Stockton State College,NJ,IIB,656,496,393,492,790,607,490,603,47,58,65,=
8,178
2093,Saint John's College,NM,IIB,*,*,*,442,*,*,*,587,0,0,0,0,53
2651,Eastern New Mexico Univ.,NM,IIA,497,377,321,360,605,466,399,446,21,42,6=
3,11,144
2653,New Mexico Highlands Univ.,NM,IIA,435,362,305,349,541,454,386,439,26,32=
,59,0,117
2654,New Mexico Inst. Min.&Tech.,NM,I,538,421,405,448,648,512,494,544,39,32,=
29,5,108
2657,New Mexico St. Univ- Main,NM,I,524,433,360,434,641,531,444,533,202,167,=
196,17,582
10313,Univ. New Mexico-Albuquerque,NM,I,579,431,379,466,693,521,459,561,314,=
268,195,0,837
2568,University of Nevada - Reno,NV,I,647,480,390,508,741,558,458,589,145,13=
3,95,5,403
2569,Univ. of Nevada-Las Vegas,NV,IIA,596,476,392,452,699,564,468,537,152,19=
2,214,0,642
2667,Dowling College,NY,IIB,661,596,484,563,891,822,679,776,25,29,36,3,93
2668,Alfred University,NY,IIA,520,427,367,439,641,538,467,548,46,25,36,6,113
2671,Bard College,NY,IIB,657,460,365,521,860,605,481,683,40,15,29,0,84
2681,Canisius College,NY,IIA,542,480,370,468,679,599,450,582,57,73,51,0,181
2685,Cazenovia College,NY,IIB,443,354,295,337,549,445,374,423,8,13,21,3,45
2699,Clarkson University,NY,I,703,515,475,563,875,658,593,707,55,58,43,5,161
2701,Colgate University,NY,IIB,669,505,406,539,848,637,497,677,78,61,56,3,19=
8
2703,College of Mount St. Vincent,NY,IIB,*,388,336,366,*,476,410,450,5,24,20=
,7,56
2704,College of New Rochelle,NY,IIA,539,449,391,447,693,579,499,574,11,38,17=
,1,67
2705,College of Saint Rose,NY,IIA,456,408,329,374,534,503,403,455,19,50,46,1=
4,129
2707,Columbia University,NY,I,882,554,452,687,1136,767,646,915,477,185,199,1=
1,923
2708,Barnard College,NY,IIB,733,516,395,508,943,652,509,654,49,19,56,6,154
2709,Concordia College,NY,IIB,352,289,275,303,436,366,363,387,11,6,14,1,32
2710,Cooper Union for Adv.Sci&Art,NY,IIB,684,514,433,607,872,673,600,784,35,=
18,6,0,59
2711,Cornell Univ.-Endowed Colls.,NY,I,787,562,482,627,1047,748,640,834,447,=
189,148,3,914
2711,Cornell Univ.-Statutory Clls,NY,I,651,511,431,549,847,691,598,732,318,2=
31,105,41,707
2712,D'Youville College,NY,IIB,404,385,327,359,485,456,390,427,15,22,32,7,76
2713,Dominican College,NY,IIB,*,400,354,365,*,508,438,454,4,10,19,9,42
2718,Elmira College,NY,IIB,497,342,306,359,666,449,395,472,13,24,26,0,63
2722,Fordham University,NY,I,744,573,444,590,945,729,557,748,166,183,140,9,4=
98
2728,Hamilton College,NY,IIB,631,478,377,478,801,608,475,604,46,37,54,12,149
2729,Hartwick College,NY,IIB,505,423,340,419,628,517,409,513,50,23,36,0,123
2731,Hobart-William Smith Colls.,NY,IIB,605,462,352,495,749,579,431,614,61,3=
9,34,3,137
2732,Hofstra University,NY,I,757,550,470,584,956,692,579,731,127,131,141,7,4=
06
2734,Houghton College,NY,IIB,370,323,265,327,487,424,343,428,30,29,17,1,77
2735,Hilbert College,NY,IIB,318,*,261,278,376,*,315,336,6,3,12,7,28
2737,Iona College,NY,IIA,594,462,393,461,756,594,496,587,42,81,59,10,192
2739,Ithaca College,NY,IIB,606,484,366,443,761,605,461,557,70,153,184,21,428
2744,Keuka College,NY,IIB,403,346,283,338,473,412,335,399,15,8,19,0,42
2748,Le Moyne College,NY,IIB,542,455,365,445,684,576,465,564,30,50,36,3,119
2758,Manhattan College,NY,IIA,595,500,388,488,767,627,495,621,45,74,50,3,172
2765,Marist College,NY,IIB,580,485,373,417,741,643,481,542,16,34,91,0,151
2768,Marymount Coll. Tarrytown,NY,IIB,426,349,297,357,546,442,383,455,17,24,=
13,2,56
2769,Marymount Manhattan College,NY,IIB,*,407,332,382,*,495,407,464,4,26,19,=
0,49
2772,Mercy College,NY,IIB,524,399,341,416,640,493,423,511,53,38,48,6,149
2775,Molloy College,NY,IIB,541,435,353,381,697,551,463,494,16,20,58,22,116
2777,Medaille College,NY,IIB,435,371,276,349,525,446,322,418,11,16,13,2,43
2778,Mount Saint Mary College,NY,IIB,514,407,349,395,633,505,424,482,14,8,23=
,6,51
2779,Nazareth Coll. of Rochester,NY,IIB,513,428,343,430,634,533,425,532,37,3=
3,35,0,105
2785,New York University,NY,I,887,591,507,683,1172,785,674,905,532,337,252,4=
2,1231
2788,Niagara University,NY,IIA,503,430,376,443,612,524,448,537,39,43,24,2,10=
8
2791,Pace University,NY,IIA,685,513,436,576,851,643,556,720,187,124,77,3,397
2803,Rensselaer Polytechnic Inst.,NY,I,750,548,475,640,922,703,601,799,190,1=
18,61,0,369
2806,Rochester Institute of Tech.,NY,IIA,568,476,417,466,710,603,527,587,182=
,215,179,13,665
2810,Russell Sage College,NY,IIA,487,409,351,397,609,506,435,493,19,56,37,6,=
118
2813,Sarah Lawrence College,NY,IIB,623,478,398,541,779,610,495,677,39,14,13,=
0,69
2814,Skidmore College,NY,IIB,642,492,397,498,831,639,516,646,42,69,48,5,164
2816,Siena College,NY,IIB,515,429,357,434,667,567,474,570,52,53,49,1,155
2817,St.Bonaventure University,NY,IIA,492,398,377,425,642,535,495,562,56,51,=
43,4,154
2820,St. Francis College,NY,IIB,543,466,350,446,689,607,457,573,22,14,14,7,5=
7
2821,St. John Fisher College,NY,IIB,513,427,376,432,635,512,451,524,29,40,36=
,1,106
2825,Saint Joseph's College,NY,IIB,495,398,349,372,584,478,419,446,12,15,46,=
8,81
2829,St. Lawrence University,NY,IIB,627,473,366,488,799,613,472,627,50,56,40=
,7,153
2832,St. Thomas Aquinas College,NY,IIB,510,408,374,419,617,526,454,515,18,16=
,26,3,63
2835,SUNY at Albany,NY,I,732,526,407,576,934,679,524,739,260,217,125,0,638
2836,SUNY at Binghamton,NY,I,705,511,407,555,902,665,528,716,172,175,82,0,46=
0
2838,SUNY at Stony Brook,NY,I,755,534,414,589,961,688,526,751,346,216,183,24=
,801
2841,SUNY College at Brockport,NY,IIA,603,501,397,492,778,651,509,636,87,107=
,88,0,296
2842,SUNY College at Buffalo,NY,IIA,536,433,359,444,693,560,464,573,144,157,=
88,3,424
2843,SUNY College at Cortland,NY,IIA,530,411,341,432,691,537,439,563,85,76,6=
6,0,234
2844,SUNY College at Fredonia,NY,IIA,562,438,350,450,731,569,451,585,93,65,5=
4,15,235
2845,SUNY College at Geneseo,NY,IIA,541,411,348,405,704,536,448,525,48,78,79=
,23,243
2846,SUNY College at New Paltz,NY,IIA,584,458,373,462,758,594,480,598,90,96,=
73,0,283
2847,SUNY College at Oneonta,NY,IIA,539,428,362,440,705,557,467,571,93,78,81=
,1,267
2848,SUNY College at Oswego,NY,IIA,537,427,339,441,702,556,435,574,111,105,7=
8,4,302
2849,SUNY College at Plattsburgh,NY,IIA,538,435,343,445,701,566,441,578,107,=
76,71,1,266
2850,SUNY College at Potsdam,NY,IIA,531,413,337,424,691,539,436,552,78,63,52=
,9,219
2882,Syracuse University,NY,I,648,475,394,526,851,645,528,701,371,301,205,10=
,891
2883,Syracuse Univ.-Utica College,NY,IIB,487,394,339,401,642,520,439,527,27,=
46,32,0,105
2889,Union College,NY,IIA,638,508,399,512,841,677,501,667,60,50,54,9,173
2894,University of Rochester,NY,I,747,520,434,611,895,626,520,733,252,130,11=
0,7,508
2895,Vassar College,NY,IIB,674,517,408,523,879,669,512,674,70,60,66,9,212
2899,Wagner College,NY,IIB,457,366,326,368,587,477,438,483,20,17,31,4,72
2901,Wells College,NY,IIB,464,373,318,396,568,454,389,484,21,10,14,0,46
4779,Long Island University,NY,IIA,631,513,408,531,825,672,520,690,233,175,1=
24,22,561
4804,New York Inst. of Technology,NY,IIA,569,492,410,491,726,642,546,639,68,=
106,43,11,228
6791,SUNY College at Purchase,NY,IIB,534,432,362,437,696,565,468,570,29,52,2=
8,0,114
6792,SUNY Coll.Tech. Utica-Rome,NY,IIA,536,457,414,444,701,591,529,573,8,48,=
19,8,85
7109,SUNY College at Old Westbury,NY,IIB,592,480,374,466,758,616,485,599,36,=
42,40,8,127
9554,SUNY at Buffalo,NY,I,762,548,423,601,970,704,534,767,400,338,218,9,982
10286,SUNY Empire State College,NY,IIB,543,437,361,430,706,562,468,554,33,47=
,35,3,132
3011,Art Academy of Cincinnati,OH,IIB,*,286,*,304,*,354,*,371,5,6,5,1,17
3012,Ashland University,OH,IIB,484,418,329,398,624,530,437,515,52,58,58,4,17=
9
3014,Baldwin-Wallace College,OH,IIB,530,431,360,464,662,552,464,587,74,39,35=
,0,148
3016,Bluffton College,OH,IIB,368,309,272,312,466,389,347,399,16,13,19,1,49
3018,Bowling Green State Univ.,OH,I,620,481,394,483,817,644,530,643,226,212,=
180,65,690
3023,Capital University,OH,IIA,563,405,334,424,704,540,429,543,54,36,57,11,1=
58
3024,Case Western Reserve Univ.,OH,I,754,518,470,585,948,663,600,744,213,133=
,126,58,530
3025,Cedarville College,OH,IIB,419,364,300,346,527,459,379,436,32,37,60,3,13=
2
3032,Cleveland State University,OH,IIA,611,459,390,486,750,575,495,606,166,2=
23,128,14,531
3033,College of Mount St. Joseph,OH,IIB,477,412,339,360,575,482,401,423,10,2=
1,52,17,100
3036,Franciscan Univ.Steubenville,OH,IIB,445,362,300,349,580,440,405,449,15,=
32,34,2,83
3037,College of Wooster,OH,IIB,561,411,346,449,735,518,429,575,52,24,44,2,12=
2
3038,Mount Union College,OH,IIB,476,394,325,399,609,508,412,509,25,21,17,7,7=
0
3041,Defiance College The,OH,IIB,373,333,277,326,438,388,330,382,14,18,11,0,=
46
3042,Denison University,OH,IIB,558,414,346,445,757,528,439,584,58,32,55,0,14=
6
3045,University of Findlay,OH,IIB,417,370,301,330,526,470,369,413,18,29,51,7=
,115
3046,Franklin University,OH,IIB,*,*,*,345,*,*,*,438,0,0,0,0,39
3048,Heidelberg College,OH,IIB,399,334,298,331,491,407,349,397,17,18,24,8,67
3049,Hiram College,OH,IIB,468,367,302,373,602,469,379,474,28,22,20,11,81
3050,John Carroll University,OH,IIA,587,473,389,465,717,586,490,576,59,56,74=
,14,203
3051,Kent State Univ.-Kent Campus,OH,I,654,473,389,502,810,602,505,636,221,2=
44,203,14,682
3065,Kenyon College,OH,IIB,608,439,381,480,777,552,475,608,49,36,38,8,131
3069,Lourdes College,OH,IIB,*,330,283,280,*,413,371,361,2,8,15,22,47
3072,Malone College,OH,IIB,410,352,306,343,515,441,383,432,20,18,26,4,70
3073,Marietta College,OH,IIB,445,366,298,370,569,464,367,470,27,18,19,5,69
3084,Muskingum College,OH,IIB,446,365,290,353,574,461,378,453,19,19,28,3,69
3085,Notre Dame College of Ohio,OH,IIB,*,294,269,290,*,346,318,340,5,9,15,0,=
29
3086,Oberlin College,OH,IIB,588,454,385,507,789,605,491,673,121,69,43,6,239
3089,Ohio Northern University,OH,IIB,511,431,371,437,639,546,465,550,55,53,3=
9,8,155
3092,Ohio State Univ.-Lima,OH,IIB,*,460,335,384,*,567,424,480,3,14,19,3,39
3093,Ohio State Univ.-Mansfield,OH,IIB,*,396,350,375,*,494,441,470,2,19,18,2=
,41
3094,Ohio State Univ.-Marion,OH,IIB,508,424,337,410,622,526,426,510,6,10,9,1=
,26
3095,Ohio State Univ.-Newark,OH,IIB,*,417,353,392,*,518,445,489,4,13,17,2,36
3100,Ohio University-Athens,OH,I,632,486,393,512,786,618,512,648,248,241,192=
,4,687
3109,Ohio Wesleyan University,OH,IIB,541,395,354,453,726,584,500,626,67,25,4=
2,2,136
3110,Otterbein College,OH,IIB,459,372,329,363,600,467,399,457,22,42,56,10,13=
0
3121,Tiffin University,OH,IIB,485,379,334,379,593,470,410,466,6,7,14,0,27
3123,Univ. of Akron- Main Campus,OH,I,577,448,387,479,718,567,497,603,278,25=
3,147,39,717
3125,Univ.of Cinti.-Main Campus,OH,I,666,483,393,535,856,622,506,688,447,410=
,244,12,1113
3127,University of Dayton,OH,IIA,590,479,392,482,765,616,495,618,123,159,130=
,7,419
3131,University of Toledo,OH,I,608,457,379,486,750,572,481,607,217,152,167,2=
0,556
3133,Urbana University,OH,IIB,335,266,241,272,425,314,297,333,9,12,14,1,36
3134,Ursuline College,OH,IIB,413,350,297,306,476,410,361,363,8,10,20,24,62
3135,Walsh University,OH,IIB,407,344,278,346,504,427,352,432,17,19,10,0,49
3142,Wilmington College,OH,IIB,407,357,303,335,481,430,364,401,10,18,32,1,61
3143,Wittenberg University,OH,IIB,546,413,341,438,704,543,436,567,49,55,32,6=
,142
3144,Xavier University,OH,IIA,571,473,378,449,712,586,467,557,58,75,78,19,23=
0
3145,Youngstown State University,OH,IIA,591,450,362,481,723,562,461,597,204,=
116,106,33,459
6883,Ohio State Univ.-Main campus,OH,I,703,491,415,555,846,603,516,676,758,6=
79,443,30,1910
7104,Miami University,OH,I,616,474,376,478,797,614,487,619,258,225,219,60,76=
3
8795,Antioch University,OH,IIA,441,348,300,316,571,457,398,418,30,15,17,3,16=
2
9168,Wright State University-Main,OH,IIA,642,468,385,465,781,580,485,576,126=
,176,132,45,493
12748,Shawnee State University,OH,IIB,510,439,368,411,658,563,502,537,15,54,=
35,15,119
3150,Cameron University,OK,IIB,426,360,329,345,531,452,415,434,44,35,63,34,1=
77
3151,Bartlesville Wesleyan Coll.,OK,IIB,*,*,*,264,*,*,*,358,0,0,0,0,26
3152,University of Central Okla.,OK,IIA,503,442,384,416,606,536,469,505,108,=
57,166,58,389
3154,East Central University,OK,IIB,453,407,352,378,538,488,429,456,39,31,64=
,23,158
3157,Langston University,OK,IIB,459,375,313,342,545,454,383,415,12,31,34,29,=
108
3161,Northeastern State Univ.,OK,IIB,455,374,348,377,554,462,431,464,80,49,7=
1,52,257
3163,Northwestern Okla.State Univ,OK,IIB,435,397,321,336,522,479,390,407,12,=
11,30,24,77
3164,Oklahoma Baptist University,OK,IIB,379,335,282,317,467,420,359,399,22,3=
3,42,5,102
3165,Okla. Christian U. of S&Arts,OK,IIB,432,372,317,385,527,454,371,466,39,=
18,15,5,77
3167,Univ. of Sci.& Arts of Okla.,OK,IIB,427,369,336,362,528,459,434,454,13,=
18,11,10,52
3170,Oklahoma State Univ.-Main,OK,I,532,409,373,449,655,509,460,555,342,247,=
181,11,794
3174,Oklahoma Panhandle St.Univ.,OK,IIB,427,360,311,346,515,444,386,425,15,1=
4,14,11,54
3175,Phillips University,OK,IIB,365,315,273,317,438,381,327,381,16,10,15,1,4=
2
3179,Southeastern Okla. St. Univ.,OK,IIA,464,407,348,363,558,493,425,440,33,=
17,61,37,148
3181,Sthwtrn Okl.St.U.-Weatherfrd,OK,IIA,464,429,382,393,567,528,474,485,56,=
33,65,44,198
3184,University of Oklahoma,OK,I,600,445,368,470,752,563,468,593,286,225,236=
,24,778
3185,University of Tulsa,OK,IIA,686,500,404,513,835,608,493,625,84,108,73,20=
,287
1339,Western Baptist College,OR,IIB,*,308,252,285,*,451,340,388,3,7,7,5,22
3191,Concordia College,OR,IIB,401,329,307,349,496,414,389,436,13,15,7,1,36
3193,Eastern Oregon State College,OR,IIB,470,363,309,373,612,482,412,492,20,=
23,17,5,65
3194,George Fox College,OR,IIB,418,373,302,355,531,468,371,444,20,27,27,3,77
3197,Lewis & Clark College,OR,IIA,601,442,362,477,749,570,440,598,74,36,47,6=
,171
3198,Linfield College,OR,IIB,481,377,319,397,650,522,448,546,47,47,31,4,129
3208,Northwest Christian College,OR,IIB,*,*,*,292,*,*,*,409,4,5,2,0,11
3209,Western Oregon State College,OR,IIA,439,354,315,361,575,470,417,472,60,=
40,33,2,155
3210,Oregon State University,OR,I,597,473,400,475,762,615,522,615,206,209,13=
3,46,622
3211,Oregon Institute of Tech.,OR,IIB,500,441,391,438,648,574,512,572,38,32,=
32,7,109
3212,Pacific University,OR,IIA,441,381,341,370,561,469,421,461,28,32,41,7,10=
8
3216,Portland State University,OR,I,544,437,382,474,693,564,498,609,205,113,=
77,16,411
3217,Reed College,OR,IIB,596,442,378,495,729,545,463,607,47,20,31,0,98
3219,Southern Oregon State Coll.,OR,IIA,460,371,315,393,598,491,417,517,72,4=
9,25,12,161
3223,University of Oregon,OR,I,597,446,375,459,762,579,488,594,240,182,152,8=
9,671
3224,University of Portland,OR,IIA,587,437,387,436,716,542,470,536,26,57,42,=
2,135
3225,Warner Pacific College,OR,IIB,*,279,216,269,*,340,262,328,4,14,8,0,26
3227,Willamette University,OR,IIB,596,390,345,478,758,524,466,621,69,43,28,4=
,145
3229,Albright College,PA,IIB,488,396,359,430,648,514,451,562,39,21,15,3,79
3230,Allegheny College,PA,IIB,576,414,332,415,744,537,418,532,36,46,54,8,144
3233,Alvernia College,PA,IIB,402,315,295,303,506,370,347,361,7,12,30,11,60
3235,Beaver College,PA,IIA,496,405,353,381,652,532,462,500,12,20,32,2,68
3237,Bryn Mawr College,PA,IIA,620,466,379,511,767,605,478,639,65,23,20,3,129
3238,Bucknell University,PA,IIA,658,497,415,528,840,637,542,678,84,85,73,1,2=
43
3241,Cabrini College,PA,IIB,471,*,354,398,597,*,448,503,15,5,18,3,41
3242,Carnegie-Mellon University,PA,I,829,566,499,678,994,691,617,820,256,138=
,125,4,523
3243,Cedar Crest College,PA,IIB,475,392,318,375,591,495,392,468,14,17,29,0,6=
0
3244,Chatham College,PA,IIB,492,397,323,394,628,503,407,500,13,12,16,2,43
3245,Chestnut Hill College,PA,IIB,*,322,277,311,*,400,348,391,5,10,18,4,37
3247,College Misericordia,PA,IIB,493,425,346,377,578,508,420,455,9,22,48,5,8=
4
3252,Del. Valley Coll/Sci.&Agr.,PA,IIB,504,411,347,379,649,511,426,473,10,27=
,21,15,73
3253,Dickinson College,PA,IIB,622,468,380,466,797,601,478,593,35,47,51,7,144
3256,Drexel University,PA,I,674,496,459,568,843,619,570,709,153,114,73,0,341
3258,Duquesne University,PA,IIA,602,469,393,475,753,597,497,601,98,97,113,28=
,336
3259,Eastern College,PA,IIA,442,342,329,363,636,413,398,473,19,17,17,4,57
3262,Elizabethtown College,PA,IIB,552,456,371,448,718,581,465,571,30,39,26,6=
,105
3265,Franklin and Marshall Coll.,PA,IIB,675,481,387,517,902,653,519,694,56,4=
3,44,9,152
3266,Gannon University,PA,IIA,453,377,341,365,586,489,434,469,35,54,76,17,18=
2
3267,Geneva College,PA,IIB,416,366,312,366,527,475,402,469,17,17,16,0,50
3268,Gettysburg College,PA,IIB,627,475,400,485,820,630,516,637,38,65,28,20,1=
51
3270,Gwynedd-Mercy College,PA,IIB,356,316,269,280,428,383,330,341,13,18,51,1=
6,98
3274,Haverford College,PA,IIB,653,498,392,521,876,702,551,716,40,19,33,3,95
3275,Holy Family College,PA,IIB,480,395,335,364,599,504,432,465,12,14,33,16,=
75
3276,Immaculata College,PA,IIB,451,406,310,385,572,521,399,492,10,8,8,2,28
3277,Indiana University of Penn.,PA,IIA,675,541,425,546,859,708,571,711,243,=
201,173,41,658
3278,Thomas Jefferson University,PA,IIA,*,505,428,441,*,678,558,578,5,9,24,1=
8,59
3279,Juniata College,PA,IIB,488,391,316,419,634,497,427,545,36,20,16,2,74
3282,King's College,PA,IIB,498,427,354,409,641,548,444,520,22,28,45,0,95
3284,Lafayette College,PA,IIB,686,517,419,506,873,668,536,647,37,62,71,8,179
3287,La Salle University,PA,IIA,585,482,426,470,733,616,543,597,30,80,95,4,2=
09
3288,Lebanon Valley College,PA,IIB,472,401,362,419,593,512,466,531,28,21,17,=
1,67
3289,Lehigh University,PA,I,757,543,448,635,955,700,568,805,216,118,77,4,416
3290,Lincoln University,PA,IIB,516,400,348,393,628,492,433,486,22,26,18,12,8=
7
3293,Lycoming College,PA,IIB,502,436,352,395,656,575,442,507,16,26,33,11,86
3296,Marywood College,PA,IIA,514,429,356,412,635,524,443,508,25,41,52,3,121
3297,Mercyhurst College,PA,IIB,444,390,312,339,592,497,390,429,15,25,46,15,1=
01
3298,Messiah College,PA,IIB,481,400,351,393,621,514,446,505,34,37,45,15,131
3301,Moravian College,PA,IIB,490,406,343,423,624,516,430,537,35,29,19,3,86
3303,Carlow College,PA,IIB,497,383,314,359,623,490,397,454,8,18,20,7,53
3304,Muhlenberg College,PA,IIB,589,432,359,449,809,568,463,600,36,31,37,2,11=
5
3313,Widener University,PA,IIA,670,556,439,529,870,714,567,683,60,136,88,18,=
309
3315,Bloomsburg Univ. of Penn.,PA,IIA,669,538,428,528,856,710,580,696,98,109=
,131,10,348
3316,California Univ. of Penn.,PA,IIA,674,541,436,549,850,700,578,708,112,10=
8,64,25,309
3317,Cheyney University of Penn.,PA,IIA,692,554,379,550,884,732,530,725,35,3=
5,21,7,98
3320,East Stroudsburg University,PA,IIA,676,531,415,526,858,696,556,686,95,7=
2,85,20,272
3321,Edinboro University of Penn.,PA,IIA,676,545,424,516,870,714,570,679,111=
,86,169,26,392
3322,Kutztown Univ. of Penn.,PA,IIA,669,544,418,528,847,707,558,685,119,117,=
122,25,383
3323,Lock Haven University,PA,IIB,676,544,417,508,820,675,527,631,46,64,61,2=
6,197
3324,Mansfield Univ. of Penn.,PA,IIB,665,532,428,516,839,690,568,670,47,60,5=
8,14,179
3325,Millersville Univ. of Penn.,PA,IIA,660,552,429,549,842,723,576,716,117,=
97,100,6,320
3326,Shippensburg University,PA,IIA,673,545,425,573,848,706,567,735,148,67,8=
3,3,301
3327,Slippery Rock Univ. of Penn.,PA,IIA,675,532,431,537,836,670,552,676,127=
,104,138,11,380
3328,West Chester Univ. of Penn.,PA,IIA,667,540,431,533,821,680,554,671,136,=
163,176,8,483
3354,Phila.Coll.of Textiles&Sci.,PA,IIB,538,425,362,417,693,571,452,538,17,2=
8,39,1,85
3357,Point Park College,PA,IIB,411,331,290,357,519,430,363,452,33,19,17,1,73
3359,Robert Morris College,PA,IIB,575,454,406,438,724,576,513,554,11,43,42,7=
,103
3362,Seton Hill College,PA,IIB,489,380,329,368,575,479,403,453,7,23,24,1,56
3366,Saint Francis College,PA,IIB,472,392,323,375,573,481,403,463,20,14,24,8=
,66
3367,St. Joseph's University,PA,IIA,594,484,427,487,764,628,539,623,39,50,63=
,2,154
3368,Saint Vincent College,PA,IIB,436,399,317,363,603,540,406,481,14,20,20,1=
0,64
3369,Susquehanna University,PA,IIB,534,420,359,422,661,519,443,521,25,26,33,=
5,89
3370,Swarthmore College,PA,IIB,704,519,417,562,868,651,526,699,68,44,47,2,16=
3
3371,Temple University,PA,I,736,579,454,606,913,724,568,755,490,332,291,37,1=
150
3376,Thiel College,PA,IIB,408,342,287,369,534,443,376,481,33,14,10,1,58
3378,University of Pennsylvania,PA,I,881,622,532,744,1086,831,712,945,541,24=
0,212,0,993
3379,Univ. of Pittsburgh-Main,PA,I,736,516,421,547,910,653,537,688,427,402,3=
73,63,1325
3380,Univ. of Pittsburgh-Bradford,PA,IIB,489,418,340,373,619,517,419,464,8,1=
4,25,8,55
3381,Univ. of Pittsburgh-Grnsburg,PA,IIB,478,401,314,369,602,507,401,467,9,2=
3,14,10,56
3382,Univ. of Pittsburgh-Johnstwn,PA,IIB,554,430,322,404,704,538,401,507,16,=
63,32,17,133
3384,University of Scranton,PA,IIA,565,479,437,475,736,632,571,621,51,86,95,=
5,242
3385,Ursinus College,PA,IIB,528,419,354,434,686,547,458,563,32,28,29,2,91
3388,Villanova University,PA,IIA,726,535,438,536,912,698,586,698,133,143,206=
,21,503
3389,Washington & Jefferson Coll.,PA,IIB,549,480,373,473,689,608,494,602,33,=
29,18,7,87
3391,Waynesburg College,PA,IIB,407,332,297,333,541,453,399,451,20,11,22,11,6=
7
3392,Westminster College,PA,IIB,497,410,337,423,603,498,394,508,47,12,24,10,=
93
3394,Wilkes University,PA,IIA,499,430,338,409,612,534,408,502,31,53,53,0,138
3396,Wilson College,PA,IIB,322,314,269,294,402,366,315,350,8,9,12,3,32
3399,York College of Pennsylvania,PA,IIB,615,512,414,464,809,664,537,603,13,=
32,67,1,113
3986,Alltwn.Coll.St.Francis Sales,PA,IIB,486,415,342,365,594,532,429,458,6,1=
9,33,10,68
3987,La Roche College,PA,IIB,433,364,302,351,518,438,355,419,11,12,21,0,44
3988,Neumann College,PA,IIB,*,328,296,307,*,457,399,415,5,9,27,3,44
6965,Penn State Univ.-Main Campus,PA,I,721,509,417,522,887,642,525,652,622,4=
49,427,160,1799
9235,Clarion University of Penn.,PA,IIA,649,539,419,517,824,694,549,665,100,=
92,110,22,324
3401,Brown University,RI,I,752,515,433,625,956,659,554,797,286,100,111,0,514
3402,Bryant College,RI,IIB,632,582,502,556,812,746,629,709,40,43,45,0,135
3406,Providence College,RI,IIA,633,526,418,489,827,712,544,646,43,68,93,15,2=
19
3407,Rhode Island College,RI,IIA,518,442,381,453,675,581,504,594,125,101,96,=
1,323
3409,Rhode Island School Design,RI,IIB,558,427,351,444,739,576,484,598,35,49=
,34,0,118
3411,Salve Regina University,RI,IIA,495,397,327,385,620,496,406,481,29,43,37=
,14,124
3414,University of Rhode Island,RI,I,630,473,416,541,813,622,548,703,334,187=
,135,3,659
4917,Roger Williams University,RI,IIB,*,*,*,464,*,*,*,605,0,0,0,0,104
3419,Charleston Southern Univ.,SC,IIB,429,356,299,327,518,430,359,395,12,20,=
29,6,72
3420,Benedict College,SC,IIB,320,260,241,257,381,311,289,308,21,10,29,18,78
3422,Central Wesleyan College,SC,IIB,293,247,214,264,366,311,261,329,20,7,9,=
0,36
3423,Citadel Military Coll.of SC,SC,IIA,469,405,332,421,576,502,415,520,65,5=
9,24,0,148
3425,Clemson University,SC,I,602,441,375,466,728,544,465,571,296,224,191,42,=
801
3427,Coker College,SC,IIB,425,359,318,358,521,425,378,430,14,9,18,2,43
3428,College of Charleston,SC,IIA,475,410,320,374,581,505,399,462,68,102,118=
,32,320
3430,Columbia College,SC,IIB,415,355,330,358,515,441,402,442,23,25,15,9,76
3431,Converse College,SC,IIB,467,384,317,372,582,495,402,473,12,31,23,3,69
3432,Erskine College,SC,IIB,420,*,297,355,527,*,366,444,19,5,14,2,40
3434,Furman University,SC,IIB,551,414,343,453,719,530,430,583,86,39,54,6,185
3435,Lander University,SC,IIB,453,381,343,380,557,472,427,470,34,31,41,4,114
3436,Limestone College,SC,IIB,277,282,250,264,319,328,287,303,7,8,11,2,28
3439,Morris College,SC,IIB,*,278,252,269,*,314,285,303,5,16,21,4,46
3440,Newberry College,SC,IIB,351,290,243,287,411,344,290,339,11,19,11,5,46
3445,Presbyterian College,SC,IIB,503,376,316,397,637,478,395,501,26,22,22,5,=
75
3446,South Carolina State College,SC,IIB,458,379,307,350,561,467,382,432,59,=
58,77,36,255
3448,Univ. South Carolina-Main,SC,I,585,436,385,475,705,532,472,577,417,335,=
194,60,1034
3449,Univ. South Carolina-Aiken,SC,IIB,461,392,317,374,563,481,392,457,30,39=
,36,12,117
3451,Coastal Carolina University,SC,IIB,437,377,314,340,535,464,389,419,23,4=
3,49,28,143
3455,Voorhees College,SC,IIB,*,*,254,233,*,*,287,265,1,3,12,14,30
3456,Winthrop University,SC,IIA,464,378,327,378,578,474,413,474,73,78,70,19,=
242
3457,Wofford College,SC,IIB,537,413,367,448,662,519,469,560,24,27,11,2,64
6951,Univ. South Carolina-Sprtbrg,SC,IIB,433,368,303,366,529,452,376,450,49,=
43,16,21,132
9226,Francis Marion University,SC,IIB,476,394,328,387,585,488,410,480,64,37,=
40,25,166
3458,Augustana College,SD,IIB,434,382,322,364,576,519,429,487,34,22,45,7,108
3459,Black Hills State University,SD,IIB,410,341,303,329,487,409,366,396,24,=
13,50,11,98
3461,Dakota Wesleyan University,SD,IIB,*,290,246,257,*,356,302,317,4,11,13,7=
,36
3463,Dakota State University,SD,IIB,469,357,349,351,554,427,419,420,9,11,24,=
12,56
3466,Northern State University,SD,IIA,417,333,297,337,498,402,362,407,27,30,=
35,12,104
3469,Sioux Falls College,SD,IIB,376,308,289,311,463,388,364,391,7,12,15,2,36
3470,South Dakota Sch.Min.& Tech.,SD,IIA,473,414,362,419,562,495,435,500,45,=
28,26,5,104
3471,South Dakota State Univ.,SD,IIA,440,368,326,368,521,440,392,440,132,67,=
122,44,367
10300,University of South Dakota,SD,I,480,364,340,362,570,438,410,436,88,75,=
134,55,352
3478,Austin Peay State University,TN,IIA,482,362,314,374,581,445,390,458,86,=
47,102,17,252
3479,Belmont University,TN,IIA,484,372,315,382,573,445,377,455,42,54,45,7,14=
8
3480,Bethel College,TN,IIB,287,*,255,262,345,*,307,323,9,4,9,5,27
3481,Carson-Newman College,TN,IIB,393,334,286,324,475,405,339,390,32,33,41,1=
1,117
3482,Christian Brothers Univ.,TN,IIB,414,347,312,345,509,435,395,432,22,28,3=
2,4,86
3486,David Lipscomb University,TN,IIB,453,374,308,365,561,473,374,451,33,22,=
25,17,97
3487,East Tennessee State Univ.,TN,IIA,519,449,358,411,629,548,441,504,129,1=
24,165,68,486
3490,Fisk University,TN,IIB,383,369,269,319,451,437,314,375,17,19,17,2,65
3492,Freed-Hardeman University,TN,IIB,382,326,271,305,454,401,346,374,16,23,=
20,9,69
3498,Lambuth University,TN,IIB,316,288,283,294,405,380,363,379,15,9,16,2,42
3500,Lee College,TN,IIB,350,320,284,297,431,407,334,360,12,20,29,13,74
3505,Maryville College,TN,IIB,429,351,289,338,520,419,348,406,12,14,19,4,49
3509,Memphis State University,TN,I,558,425,376,443,674,522,464,542,264,194,1=
93,71,722
3510,Middle Tenn. State Univ.,TN,IIA,542,418,336,410,654,511,416,501,202,167=
,224,76,669
3511,Milligan College,TN,IIB,398,334,291,347,465,404,337,410,21,16,15,0,52
3518,Southern C.Seventh-Day Advts,TN,IIB,270,261,249,260,348,331,322,334,34,=
32,19,5,90
3519,Rhodes College,TN,IIB,575,446,353,430,741,566,428,538,23,37,46,4,110
3522,Tennessee State University,TN,IIA,477,418,330,407,595,524,420,512,111,7=
8,71,28,288
3523,Tennessee Technological Univ,TN,IIA,547,424,346,436,664,527,439,540,146=
,98,100,32,376
3527,Tusculum College,TN,IIB,353,327,290,314,426,396,340,373,6,7,14,0,27
3528,Union University,TN,IIB,396,361,318,332,496,454,396,414,18,22,52,20,112
3529,Univ. of Tenn.at Chattanooga,TN,IIA,494,420,365,428,628,525,452,538,113=
,60,79,11,263
3530,Univ.of Tennessee-Knoxville,TN,I,600,454,402,501,756,570,500,630,535,32=
5,202,65,1139
3531,Univ.of Tennessee-Martin,TN,IIA,473,409,337,413,615,509,426,527,103,57,=
48,17,225
3534,University of the South,TN,IIB,578,427,347,485,759,571,447,636,53,20,18=
,6,99
3535,Vanderbilt University,TN,I,807,522,432,612,988,651,538,756,289,160,177,=
9,657
6725,Univ. of Tennessee- Memphis,TN,I,605,461,403,486,757,576,502,607,53,60,=
40,11,164
3537,Abilene Christian University,TX,IIA,424,375,339,376,555,491,418,494,68,=
42,36,14,160
3541,Angelo State University,TX,IIB,485,425,369,398,618,549,484,517,68,27,40=
,45,180
3543,Austin College,TX,IIB,508,394,320,418,629,500,390,518,37,20,23,4,84
3564,East Texas Baptist Univ.,TX,IIB,377,318,325,329,460,409,403,409,19,9,17=
,10,55
3565,East Texas State University,TX,IIA,494,378,351,418,625,487,456,536,107,=
66,58,13,248
3571,Hardin-Simmons University,TX,IIA,378,311,295,330,457,380,357,400,39,11,=
25,9,84
3576,Houston Baptist University,TX,IIA,408,363,314,345,507,456,397,434,34,19=
,43,15,111
3581,Lamar University-Beaumont,TX,IIA,482,382,334,361,591,475,417,447,82,81,=
91,64,343
3584,LeTourneau University,TX,IIB,404,343,319,349,525,431,428,449,15,18,11,6=
,50
3592,Midwestern State University,TX,IIA,491,418,362,399,613,528,463,505,42,4=
5,54,20,162
3594,University of North Texas,TX,I,551,443,382,448,674,550,479,555,249,203,=
234,5,751
3598,Our Lady of the Lake Univ.,TX,IIA,499,405,346,379,577,469,399,437,24,25=
,30,21,101
3599,Univ. of Texas-Pan Amer.Univ,TX,IIA,503,426,343,367,625,536,439,467,63,=
85,109,109,369
3604,Rice University,TX,I,809,548,481,663,992,682,593,816,224,89,91,8,422
3606,Sam Houston State University,TX,IIA,497,403,341,408,633,523,451,529,147=
,63,116,10,365
3610,Schreiner College,TX,IIB,354,300,257,282,425,363,313,343,12,8,8,12,40
3613,Southern Methodist Univ.,TX,I,733,505,463,550,918,636,570,687,158,154,1=
35,5,483
3615,Southwest Texas State Univ.,TX,IIA,495,410,328,385,619,521,426,492,209,=
135,204,53,662
3620,Southwestern University,TX,IIB,627,470,373,478,763,581,465,590,22,33,25=
,3,83
3621,St. Edward's University,TX,IIB,469,385,331,380,552,454,392,448,12,45,24=
,2,83
3623,St. Mary's University,TX,IIA,652,474,383,502,744,560,452,585,58,57,49,5=
,169
3624,Stephen F.Austin State Univ.,TX,IIA,473,379,338,380,582,478,434,481,138=
,74,114,37,391
3625,Sul Ross State University,TX,IIB,440,368,310,354,562,474,410,462,34,15,=
24,8,95
3630,Prairie View A&M University,TX,IIA,485,421,347,369,616,542,455,481,34,5=
8,64,73,232
3631,Tarleton State University,TX,IIA,446,399,347,354,570,516,455,462,42,48,=
48,62,204
3636,Texas Christian University,TX,I,654,477,423,511,811,599,518,632,107,109=
,99,9,336
3639,Texas A&M Univ.-Kingsville,TX,IIA,467,393,348,386,589,502,450,494,72,51=
,41,12,192
3641,Texas Lutheran College,TX,IIB,458,370,313,365,564,456,386,449,20,13,20,=
8,61
3642,Texas Southern University,TX,I,551,455,366,423,684,573,469,535,83,82,10=
4,50,331
3644,Texas Tech University,TX,I,610,429,363,468,762,550,472,595,270,216,220,=
14,742
3645,Texas Wesleyan University,TX,IIB,456,536,298,439,570,656,370,544,42,30,=
15,9,96
3646,Texas Woman's University,TX,I,499,401,342,396,623,507,438,501,93,107,10=
1,40,353
3647,Trinity University,TX,IIA,696,477,389,548,860,610,497,686,95,61,57,3,21=
6
3651,University of Dallas,TX,IIA,474,432,364,395,578,550,446,489,23,35,25,1,=
108
3652,University of Houston,TX,I,681,462,398,520,836,585,510,651,341,288,238,=
24,903
3656,Univ. of Texas at Arlington,TX,I,581,438,395,455,724,557,506,577,185,22=
4,137,0,608
3658,Univ. of Texas at Austin,TX,I,732,476,432,577,888,599,548,713,997,439,4=
80,30,2099
3661,Univ. of Texas at El Paso,TX,IIA,522,417,365,404,679,552,488,535,101,12=
2,142,10,423
3663,Wayland Baptist Univ.,TX,IIB,433,278,252,311,502,338,362,387,18,19,15,1=
0,62
3665,West Texas A&M University,TX,IIA,467,358,326,340,583,457,419,435,65,35,=
58,58,228
6967,Baylor University,TX,I,619,474,397,476,791,610,504,607,226,131,103,7,60=
1
9651,Texas A&M Internat'l Univ.,TX,IIB,445,432,380,404,570,554,494,522,10,16=
,18,4,48
9741,Univ. of Texas at Dallas,TX,I,661,505,451,557,810,634,571,692,89,58,59,=
1,207
9930,Univ. of Texas -Permian Bsn.,TX,IIB,457,393,348,384,576,501,449,491,21,=
18,26,6,76
10115,Univ. of Texas -San Antonio,TX,IIA,546,441,379,429,685,562,489,548,61,=
120,108,6,314
10298,Texas A&M Univ.at Galveston,TX,IIB,570,368,376,393,714,475,482,503,15,=
15,8,0,63
10366,Texas A & M University-Main,TX,I,645,460,394,505,798,587,509,637,652,4=
24,305,2,1546
11161,Texas A&M U.-Corpus Christi,TX,IIA,475,396,334,400,604,513,440,517,49,=
44,45,4,142
11163,Univ. of Texas at Tyler,TX,IIA,522,421,359,409,666,548,496,538,39,37,2=
4,0,133
11711,Univ. of Houston-Clear Lake,TX,IIA,558,479,409,467,696,605,520,590,48,=
65,45,4,174
11854,University of Central Texas,TX,IIB,*,321,279,302,*,392,350,368,2,7,8,2=
,19
12826,Univ. of Houston-Downtown,TX,IIB,503,404,336,365,628,507,429,463,20,53=
,44,1,153
13231,Univ. of Houston-Victoria,TX,IIB,*,389,319,355,*,498,411,456,5,11,11,2=
,29
29269,East Texas State U-Texarkana,TX,IIB,480,373,*,429,616,490,*,556,20,6,2=
,4,32
3670,Brigham Young University,UT,I,661,504,431,543,851,668,577,711,577,382,3=
04,49,1372
3675,University of Utah,UT,I,615,432,383,498,792,574,514,652,388,231,216,25,=
860
3677,Utah State University,UT,I,518,403,364,420,688,546,497,567,199,165,158,=
20,583
3678,Southern Utah University,UT,IIB,421,349,290,335,546,473,413,459,33,48,5=
5,11,147
3680,Weber State University,UT,IIB,483,388,341,389,633,522,458,518,160,97,12=
4,61,459
3681,Westminster Coll. Slt.Lke.Cy,UT,IIB,445,367,325,359,578,459,399,448,15,=
25,35,4,79
3702,Averett College,VA,IIB,372,319,281,328,454,395,342,400,19,15,11,3,48
3704,Bridgewater College,VA,IIB,450,390,332,383,563,483,417,479,22,15,21,4,6=
2
3705,College of William and Mary,VA,I,679,499,382,525,827,621,484,650,185,13=
2,123,30,470
3706,Christopher Newport Univ.,VA,IIB,509,442,363,412,632,553,458,515,39,44,=
68,15,166
3708,Eastern Mennonite Coll.&Sem.,VA,IIB,387,335,286,325,480,411,355,402,26,=
13,15,13,69
3709,Emory and Henry College,VA,IIB,440,358,296,363,531,439,351,438,18,19,14=
,3,54
3711,Ferrum College,VA,IIB,415,342,299,353,508,417,362,431,27,21,16,5,69
3713,Hampden-Sydney College,VA,IIB,529,397,338,417,631,481,419,502,28,28,13,=
0,80
3714,Hampton University,VA,IIA,494,377,323,359,568,440,374,415,45,86,134,13,=
297
3715,Hollins College,VA,IIB,498,398,306,388,609,512,374,484,18,27,23,3,71
3719,Longwood College,VA,IIB,487,420,336,393,611,529,431,497,33,50,50,17,150
3720,Lynchburg College,VA,IIA,465,392,317,395,567,484,396,486,49,36,37,3,125
3721,James Madison University,VA,IIA,521,447,366,441,647,560,466,553,187,151=
,131,39,508
3723,Mary Baldwin College,VA,IIB,457,370,311,362,551,457,380,443,13,31,25,2,=
71
3724,Marymount University,VA,IIA,524,418,369,448,616,493,434,528,48,30,34,0,=
112
3728,Old Dominion University,VA,I,595,451,370,446,731,564,468,557,165,228,15=
6,52,643
3732,Radford University,VA,IIA,499,393,354,407,613,488,443,505,137,119,92,43=
,391
3733,Randolph-Macon College,VA,IIB,522,395,313,399,632,484,385,488,22,30,21,=
6,79
3734,Randolph-Macon Woman's Coll.,VA,IIB,495,411,337,409,623,512,424,512,17,=
28,18,2,65
3735,Virginia Commonwealth Univ.,VA,I,610,492,404,491,753,611,501,609,220,31=
0,211,43,784
3736,Roanoke College,VA,IIB,494,408,338,412,624,523,422,522,27,37,28,0,92
3737,Shenandoah University,VA,IIB,463,387,330,392,554,464,394,469,32,26,25,6=
,89
3739,Saint Paul's College,VA,IIB,319,309,275,290,399,368,341,357,8,9,8,8,33
3742,Sweet Briar College,VA,IIB,539,433,372,468,666,524,445,572,28,26,11,0,6=
5
3744,University of Richmond,VA,IIA,711,550,418,565,883,686,512,700,80,70,72,=
0,222
3746,Mary Washington College,VA,IIB,475,397,325,401,602,507,421,513,59,43,48=
,0,157
3747,U. Va. Clinch Valley College,VA,IIB,445,352,313,350,552,442,397,440,17,=
14,18,4,58
3749,George Mason University,VA,I,753,524,445,568,909,650,550,696,210,266,15=
6,43,675
3752,Virginia Intermont College,VA,IIB,332,318,279,307,392,373,333,363,7,15,=
12,0,34
3753,Virginia Military Institute,VA,IIB,532,446,364,467,668,573,465,590,52,1=
4,24,2,94
3754,Virginia Poly.Inst.&St.Univ.,VA,I,655,467,404,519,802,582,506,641,598,5=
26,270,91,1485
3764,Virginia State University,VA,IIA,453,416,375,398,554,510,462,489,55,49,=
59,28,191
3765,Norfolk State University,VA,IIA,492,429,355,406,618,545,456,516,83,88,9=
2,30,297
3766,Virginia Union University,VA,IIB,401,351,264,283,459,404,302,324,8,15,3=
7,8,78
3767,Virginia Wesleyan College,VA,IIB,527,432,356,436,643,534,447,538,28,11,=
24,9,72
3768,Washington & Lee University,VA,IIB,685,487,397,592,842,605,480,728,84,3=
0,24,0,138
6968,University of Virginia,VA,I,777,517,430,610,953,653,545,757,445,277,201=
,18,973
10392,Liberty University,VA,IIA,401,341,279,327,458,389,322,375,44,56,51,17,=
168
29261,Christendom College,VA,IIB,*,*,279,320,*,*,336,396,1,5,7,0,13
3682,Bennington College,VT,IIB,*,*,*,373,*,*,*,449,0,0,0,0,46
3683,Castleton State College,VT,IIB,432,355,302,355,580,484,410,480,26,27,34=
,3,90
3687,Green Mountain College,VT,IIB,416,355,309,342,518,448,390,430,9,11,10,5=
,35
3688,Johnson State College,VT,IIB,423,349,303,342,550,478,429,469,14,21,29,2=
,66
3689,Lyndon State College,VT,IIB,433,366,293,366,584,501,411,500,18,22,17,0,=
57
3691,Middlebury College,VT,IIB,678,469,398,512,878,599,493,651,68,33,56,14,1=
82
3692,Norwich University,VT,IIA,423,356,297,371,545,468,394,484,62,51,32,1,14=
6
3694,Saint Michael's College,VT,IIB,501,414,344,404,675,548,457,540,33,38,46=
,0,122
3695,Trinity College of Vermont,VT,IIB,364,340,299,325,432,407,365,392,6,20,=
11,1,40
3696,University of Vermont,VT,I,606,450,370,458,770,586,486,592,175,174,115,=
0,555
3771,Central Washington Univ.,WA,IIA,483,355,292,401,596,447,374,501,172,80,=
72,0,340
3775,Eastern Washington Univ.,WA,IIA,480,406,352,425,601,514,451,537,181,79,=
74,14,348
3777,Heritage College,WA,IIB,*,359,319,322,*,437,392,395,4,7,9,8,28
3778,Gonzaga University,WA,IIA,616,428,345,420,741,527,432,518,49,83,96,23,2=
51
3785,Pacific Lutheran University,WA,IIA,494,409,351,422,617,513,434,527,78,8=
8,63,0,229
3788,Seattle Pacific University,WA,IIA,457,388,335,390,563,485,422,485,50,48=
,34,7,144
3790,Seattle University,WA,IIA,565,476,408,458,674,572,495,551,53,88,69,14,2=
37
3794,Saint Martin's College,WA,IIB,378,347,303,325,441,418,360,386,7,14,28,1=
,50
3797,University of Puget Sound,WA,IIB,623,469,389,516,788,599,495,655,80,44,=
51,0,175
3798,University of Washington,WA,I,683,485,421,555,838,606,524,687,893,472,3=
52,11,1906
3799,Walla Walla College,WA,IIB,333,314,300,312,403,382,367,379,45,20,36,13,=
117
3800,Washington State University,WA,I,597,447,393,470,734,559,488,584,337,28=
1,279,62,965
3802,Western Washington Univ.,WA,IIA,537,444,371,462,665,553,461,573,153,141=
,67,6,385
3803,Whitman College,WA,IIB,568,451,372,476,717,571,468,602,37,32,23,1,93
3804,Whitworth College,WA,IIB,426,349,279,345,513,426,345,420,26,39,18,10,93
8155,Evergreen State College,WA,IIB,*,*,*,430,*,*,*,541,0,0,0,0,154
3832,Alverno College,WI,IIB,438,352,282,314,511,411,332,368,9,31,74,0,114
3835,Beloit College,WI,IIB,521,409,357,453,660,512,428,565,42,15,22,1,80
3839,Carthage College,WI,IIB,434,374,319,371,556,485,406,475,28,18,35,0,81
3842,Concordia Univ. Wisconsin,WI,IIB,416,391,340,348,507,509,434,443,10,14,=
35,1,74
3854,Lakeland College,WI,IIB,406,*,321,329,489,*,384,393,11,3,19,8,46
3856,Lawrence University,WI,IIB,570,425,364,462,691,521,439,561,42,28,31,3,1=
04
3861,Marian Coll.of Fond du Lac,WI,IIB,440,371,302,334,548,464,373,414,9,17,=
41,4,71
3863,Marquette University,WI,I,705,521,426,527,884,662,525,662,94,238,151,0,=
483
3868,Milwaukee School of Engrg.,WI,IIB,484,411,353,439,609,522,427,551,56,27=
,20,0,103
3869,Mount Mary College,WI,IIB,393,327,282,312,493,393,327,371,8,19,19,6,52
3875,Northland College,WI,IIB,375,296,271,325,458,354,344,397,19,15,7,2,44
3884,Ripon College,WI,IIB,491,380,320,409,619,479,401,515,28,23,17,1,69
3892,St. Norbert College,WI,IIB,546,445,353,415,712,585,457,541,15,45,42,7,1=
09
3895,Univ. Wisconsin-Madison,WI,I,666,498,439,573,831,628,566,721,918,287,36=
0,30,1641
3896,Univ. Wisconsin-Milwaukee,WI,I,604,465,421,495,761,598,544,632,267,306,=
192,2,797
3899,Univ. Wisconsin-Green Bay,WI,IIA,498,417,356,419,638,541,468,543,52,55,=
35,3,157
3911,Viterbo College,WI,IIB,448,366,316,344,553,441,395,423,10,23,28,10,71
3915,Univ. Wisconsin-Stout,WI,IIA,502,394,349,412,642,513,460,536,121,71,69,=
6,300
3917,Univ. Wisconsin-Eau Claire,WI,IIA,489,410,372,428,627,533,487,555,167,1=
26,112,12,417
3919,Univ. Wisconsin-La Crosse,WI,IIA,511,424,384,430,653,549,502,556,128,10=
3,90,8,369
3921,Univ. Wisconsin-Platteville,WI,IIA,517,417,357,437,661,542,470,565,94,5=
7,58,0,221
3923,Univ. Wisconsin-River Falls,WI,IIA,485,399,340,420,622,519,449,545,112,=
57,57,2,238
3924,Univ. Wisconsin-Stevens Pnt.,WI,IIA,516,423,353,437,658,548,464,565,138=
,104,84,5,344
3925,Univ. Wisconsin-Superior,WI,IIA,501,410,348,432,642,533,459,561,42,26,1=
9,5,97
3926,Univ. Wisconsin-Whitewater,WI,IIA,525,434,368,432,670,562,483,559,127,1=
03,99,5,379
5015,Univ. Wisconsin-Parkside,WI,IIA,535,427,391,434,680,553,510,561,49,58,3=
7,1,163
9630,Univ. Wisconsin-Oshkosh,WI,IIA,541,435,374,439,688,562,490,567,104,108,=
130,4,356
3806,Alderson Broaddus College,WV,IIB,385,315,272,299,507,402,349,386,9,18,2=
5,11,63
3808,Bethany College,WV,IIB,397,348,286,340,501,485,358,433,21,6,23,0,50
3809,Bluefield State College,WV,IIB,409,315,268,310,483,388,341,384,23,22,34=
,12,91
3810,Concord College,WV,IIB,400,342,284,325,505,438,372,420,29,18,35,12,94
3811,Davis and Elkins College,WV,IIB,373,305,259,299,480,388,339,386,14,10,1=
4,7,46
3812,Fairmont State College,WV,IIB,432,362,317,361,526,446,394,445,57,44,45,=
27,173
3813,Glenville State College,WV,IIB,396,325,274,298,484,405,341,371,12,17,28=
,16,75
3815,Marshall University,WV,IIA,477,390,309,390,576,478,384,477,144,121,102,=
30,397
3818,University of Charleston,WV,IIB,385,347,324,333,484,440,413,423,10,21,2=
1,15,67
3820,Salem-Teikyo University,WV,IIB,422,353,305,306,509,429,368,369,6,11,17,=
16,50
3822,Shepherd College,WW,IIB,415,348,312,342,508,421,383,418,27,31,33,14,115
3823,West Liberty State College,WV,IIB,417,327,235,337,513,404,294,417,42,62=
,18,7,130
3825,West Virginia Inst. of Tech.,WV,IIB,408,340,297,349,502,419,369,431,54,=
43,29,11,137
3827,West Virginia University,WV,I,535,431,361,439,642,521,438,529,335,237,2=
72,22,895
3830,West Virginia Wesleyan Coll.,WV,IIB,441,383,339,383,572,494,434,495,25,=
22,24,3,74
3831,Wheeling Jesuit College,WV,IIB,403,348,282,315,486,416,348,381,8,20,25,=
12,65
3932,University of Wyoming,WY,I,539,410,374,445,658,507,464,549,241,154,164,=
2,591

--=_6vx1wr5xhvr4--



From bolker at zoo.ufl.edu  Tue Oct 10 15:45:43 2006
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue, 10 Oct 2006 13:45:43 +0000 (UTC)
Subject: [Rd] read.table versus read.csv (PR#9284)
References: <20061010133025.CD1274C89A@slim.kubism.ku.dk>
Message-ID: <loom.20061010T153843-813@post.gmane.org>

 
Arnost.Komarek <at> med.kuleuven.be> writes:
> 
> Dear R Core Team,
> 
> Help to 'read.table' claims that
> 'read.csv' is identical to 'read.table' except for the defaults.

  Pedantically speaking, the claim is true: the difference is
in the default for the quote= argument.

> 
> However, 'read.table' seems to have problems when reading character =20
> variables containing single quotes (') whereas 'read.csv' does not. 

  This behavior is documented, if perhaps not obvious.

from ?read.table:

read.table(file, header = FALSE, sep = "", quote = "\"'",
 [snip]
     read.csv(file, header = TRUE, sep = ",", quote="\"", dec=".",
              fill = TRUE, comment.char="", ...)

Both single and double quotes are included in the default quote=
argument for read.table(), only double quotes are included
in the default for read.csv().

  To make read.csv() behave like read.table() in this respect, specify

read.csv(...,quote="\"'")

  a brief search in svn logs, RSiteSearch, etc., doesn't shed any
light on *why* this difference is there ...

  Ben Bolker



From richj at essex.ac.uk  Tue Oct 10 18:58:25 2006
From: richj at essex.ac.uk (richj at essex.ac.uk)
Date: Tue, 10 Oct 2006 18:58:25 +0200 (CEST)
Subject: [Rd] possible bug? (PR#9285)
Message-ID: <20061010165825.A7CEAA26A@slim.kubism.ku.dk>

=20

=20

I use the FEAR package available from=20

=20

http://www.clemson.edu/economics/faculty/wilson/

=20

which works perfectly in Rv2.2.0; after installing from a local zip and
loading I find:

=20

USING R version 2.2.0

=20

> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))

+ if(nchar(pkg)) library(pkg, character.only=3DTRUE)})

Loading required package: KernSmooth

KernSmooth 2.22 installed

Copyright M. P. Wand 1997

FEAR (Frontier Efficiency Analysis with R) 0.913 installed

Copyright Paul W. Wilson 2005

>

=20

and everything works well.

=20

On the other hand with R version 2.4.0, although the package installs
properly from the local zip, it does not load correctly (the same
problem occurs with the patched version of 2.4.0).

=20

=20

USING R version 2.4.0

=20

> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))

+ if(nchar(pkg)) library(pkg, character.only=3DTRUE)})

> utils:::menuInstallLocal()

package 'FEAR' successfully unpacked and MD5 sums checked

updating HTML package descriptions

> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))

+ if(nchar(pkg)) library(pkg, character.only=3DTRUE)})

Loading required package: KernSmooth

KernSmooth 2.22 installed

Copyright M. P. Wand 1997

Error in dyn.load(x, as.logical(local), as.logical(now)) :=20

        unable to load shared library
'C:/PROGRA~1/R/R-24~1.0/library/FEAR/libs/FEAR.dll':

  LoadLibrary failure:  The specified procedure could not be found.

Error in library(pkg, character.only =3D TRUE) :=20

        .First.lib failed for 'FEAR'

=20

=20

=20

Is this a bug in R version 2.4.0 and is there a fix?

=20

=20

=20

*************************

 Prof J Richmond

 Department of Economics

 University of Essex

 Colchester CO4 3SQ

 United Kingdom

 Tel: +44-(0)1206-872769

 FAX: +44-(0)1206-872724

 email: richj at essex.ac.uk

 *************************

=20


	[[alternative HTML version deleted]]



From Roger.Bivand at nhh.no  Tue Oct 10 19:09:52 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 10 Oct 2006 19:09:52 +0200 (CEST)
Subject: [Rd] possible bug? (PR#9285)
In-Reply-To: <20061010165825.A7CEAA26A@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0610101905390.20484-100000@reclus.nhh.no>

On Tue, 10 Oct 2006 richj at essex.ac.uk wrote:

> =20

Not a bug. Please contact the author of the non-CRAN, binary-only package, 
as requested in FAQ 9.2: "Bug reports on contributed packages should be 
sent first to the package maintainer, and only submitted to the R-bugs 
repository by package maintainers, mentioning the package in the subject 
line."

> 
> =20
> 
> I use the FEAR package available from=20
> 
> =20
> 
> http://www.clemson.edu/economics/faculty/wilson/
> 
> =20
> 
> which works perfectly in Rv2.2.0; after installing from a local zip and
> loading I find:
> 
> =20
> 
> USING R version 2.2.0
> 
> =20
> 
> > local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
> 
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> 
> Loading required package: KernSmooth
> 
> KernSmooth 2.22 installed
> 
> Copyright M. P. Wand 1997
> 
> FEAR (Frontier Efficiency Analysis with R) 0.913 installed
> 
> Copyright Paul W. Wilson 2005
> 
> >
> 
> =20
> 
> and everything works well.
> 
> =20
> 
> On the other hand with R version 2.4.0, although the package installs
> properly from the local zip, it does not load correctly (the same
> problem occurs with the patched version of 2.4.0).
> 
> =20
> 
> =20
> 
> USING R version 2.4.0
> 
> =20
> 
> > local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
> 
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> 
> > utils:::menuInstallLocal()
> 
> package 'FEAR' successfully unpacked and MD5 sums checked
> 
> updating HTML package descriptions
> 
> > local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
> 
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> 
> Loading required package: KernSmooth
> 
> KernSmooth 2.22 installed
> 
> Copyright M. P. Wand 1997
> 
> Error in dyn.load(x, as.logical(local), as.logical(now)) :=20
> 
>         unable to load shared library
> 'C:/PROGRA~1/R/R-24~1.0/library/FEAR/libs/FEAR.dll':
> 
>   LoadLibrary failure:  The specified procedure could not be found.
> 
> Error in library(pkg, character.only =3D TRUE) :=20
> 
>         .First.lib failed for 'FEAR'
> 
> =20
> 
> =20
> 
> =20
> 
> Is this a bug in R version 2.4.0 and is there a fix?
> 
> =20
> 
> =20
> 
> =20
> 
> *************************
> 
>  Prof J Richmond
> 
>  Department of Economics
> 
>  University of Essex
> 
>  Colchester CO4 3SQ
> 
>  United Kingdom
> 
>  Tel: +44-(0)1206-872769
> 
>  FAX: +44-(0)1206-872724
> 
>  email: richj at essex.ac.uk
> 
>  *************************
> 
> =20
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From murdoch at stats.uwo.ca  Tue Oct 10 19:13:56 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 10 Oct 2006 13:13:56 -0400
Subject: [Rd] possible bug? (PR#9285)
In-Reply-To: <20061010165825.A7CEAA26A@slim.kubism.ku.dk>
References: <20061010165825.A7CEAA26A@slim.kubism.ku.dk>
Message-ID: <452BD4D4.2030600@stats.uwo.ca>

On 10/10/2006 12:58 PM, richj at essex.ac.uk wrote:
> =20
> 
> =20
> 
> I use the FEAR package available from=20
> 
> =20
> 
> http://www.clemson.edu/economics/faculty/wilson/

You should contact Prof. Wilson-- this is a bug in his package, not in 
R.  Perhaps all that is needed is for it to be re-built in 2.4.0, but 
you'll need the package source for that.  As far as I could see (in a 
very cursory examination) this is not available on his web site.

Duncan Murdoch

> 
> =20
> 
> which works perfectly in Rv2.2.0; after installing from a local zip and
> loading I find:
> 
> =20
> 
> USING R version 2.2.0
> 
> =20
> 
>> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
> 
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> 
> Loading required package: KernSmooth
> 
> KernSmooth 2.22 installed
> 
> Copyright M. P. Wand 1997
> 
> FEAR (Frontier Efficiency Analysis with R) 0.913 installed
> 
> Copyright Paul W. Wilson 2005
> 
>>
> 
> =20
> 
> and everything works well.
> 
> =20
> 
> On the other hand with R version 2.4.0, although the package installs
> properly from the local zip, it does not load correctly (the same
> problem occurs with the patched version of 2.4.0).
> 
> =20
> 
> =20
> 
> USING R version 2.4.0
> 
> =20
> 
>> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
> 
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> 
>> utils:::menuInstallLocal()
> 
> package 'FEAR' successfully unpacked and MD5 sums checked
> 
> updating HTML package descriptions
> 
>> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
> 
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> 
> Loading required package: KernSmooth
> 
> KernSmooth 2.22 installed
> 
> Copyright M. P. Wand 1997
> 
> Error in dyn.load(x, as.logical(local), as.logical(now)) :=20
> 
>         unable to load shared library
> 'C:/PROGRA~1/R/R-24~1.0/library/FEAR/libs/FEAR.dll':
> 
>   LoadLibrary failure:  The specified procedure could not be found.
> 
> Error in library(pkg, character.only =3D TRUE) :=20
> 
>         .First.lib failed for 'FEAR'
> 
> =20
> 
> =20
> 
> =20
> 
> Is this a bug in R version 2.4.0 and is there a fix?
> 
> =20
> 
> =20
> 
> =20
> 
> *************************
> 
>  Prof J Richmond
> 
>  Department of Economics
> 
>  University of Essex
> 
>  Colchester CO4 3SQ
> 
>  United Kingdom
> 
>  Tel: +44-(0)1206-872769
> 
>  FAX: +44-(0)1206-872724
> 
>  email: richj at essex.ac.uk
> 
>  *************************
> 
> =20
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From higgins at nceas.ucsb.edu  Tue Oct 10 22:28:02 2006
From: higgins at nceas.ucsb.edu (higgins at nceas.ucsb.edu)
Date: Tue, 10 Oct 2006 22:28:02 +0200 (CEST)
Subject: [Rd] error in dput applied to dataframe (PR#9286)
Message-ID: <20061010202802.94EA4A26A@slim.kubism.ku.dk>

Full_Name: Daniel F Higgins
Version: 2.4.0
OS: Windows XP and Mac OSX
Submission from: (NULL) (128.111.242.49)


Create a dataframe as indicated below and apply 'dput' to it; note that the
row.names attribute is incorrect!

> aaa <- c("AAA","BBB","AAA")
> bbb <- c(1,2,3)
> df <- data.frame(aaa,bbb)
> dput(df)
structure(list(aaa = structure(c(1, 2, 1), .Label = c("AAA", 
"BBB"), class = "factor"), bbb = c(1, 2, 3)), .Names = c("aaa", 
"bbb"), row.names = c(NA, 3), class = "data.frame")
> dput(df,file="puttest.R")
> dget("puttest.R")
Error in attributes(.Data) <- c(attributes(.Data), attrib) : 
        row names must be 'character' or 'integer', not 'double'
>

However, if R version 2.3 is used, the value for row.names is:
row.names = c("1", "2", "3")
and the dget command then works



From higgins at nceas.ucsb.edu  Tue Oct 10 22:57:00 2006
From: higgins at nceas.ucsb.edu (higgins at nceas.ucsb.edu)
Date: Tue, 10 Oct 2006 22:57:00 +0200 (CEST)
Subject: [Rd] png problem on Intel Mac (PR#9287)
Message-ID: <20061010205700.B106420750@slim.kubism.ku.dk>

Full_Name: Daniel F Higgins
Version: 2.4.0
OS: Mac OS X 10.4.8
Submission from: (NULL) (128.111.242.49)


When running the commands

png(filename='aaa.jpg', width=480, height=480)
plot(c(1,2,3))

in the Mac OSX graphical interface window, the png file 'aaa.png' is created if
one clicks on the 'X' icon to start the X window application first.

However, if you enter 'R' on the command line (i.e. inside Terminal) and then
enter the same commands using the command line version of R, no png file ever
gets created (and no errors are generated).

Note that this error does not occur on older PowerPC Mac (only on Intel Mac)

(And it would be nice if X did not have to be running to create png or jpeg
output graphics.)



From macq at llnl.gov  Wed Oct 11 01:36:38 2006
From: macq at llnl.gov (Don MacQueen)
Date: Tue, 10 Oct 2006 16:36:38 -0700
Subject: [Rd] png problem on Intel Mac (PR#9287)
In-Reply-To: <20061010205700.B106420750@slim.kubism.ku.dk>
References: <20061010205700.B106420750@slim.kubism.ku.dk>
Message-ID: <p0623091ec151dee82b7c@[128.115.153.6]>

At 10:57 PM +0200 10/10/06, higgins at nceas.ucsb.edu wrote:
>Full_Name: Daniel F Higgins
>Version: 2.4.0
>OS: Mac OS X 10.4.8
>Submission from: (NULL) (128.111.242.49)
>
>
>When running the commands
>
>png(filename='aaa.jpg', width=480, height=480)
>plot(c(1,2,3))
>
>in the Mac OSX graphical interface window, the png file 'aaa.png' is 
>created if
>one clicks on the 'X' icon to start the X window application first.
>
>However, if you enter 'R' on the command line (i.e. inside Terminal) and then
>enter the same commands using the command line version of R, no png file ever
>gets created (and no errors are generated).
>
>Note that this error does not occur on older PowerPC Mac (only on Intel Mac)
>
>(And it would be nice if X did not have to be running to create png or jpeg
>output graphics.)

See the GDD package.

>______________________________________________
>R-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA



From fparlamis at mac.com  Wed Oct 11 02:53:00 2006
From: fparlamis at mac.com (Parlamis Franklin)
Date: Tue, 10 Oct 2006 14:53:00 -1000
Subject: [Rd] dispatching on group generics with more than one formal
Message-ID: <6FB8311F-57A3-4FFB-BAF2-B49A9A3442CB@mac.com>

please see the code below.  foo2 fails to dispatch correctly, but foo  
does fine.  i have tried 'cacheMetaData(1)' and a number of different  
variants of 'cacheGenericsMetaData', on the possibility there is a  
caching issue.  but i still can't sort it out.

also one general question: does it really matter what's in the body  
of the function definition in a 'setGroupGeneric' call?  the actual  
group function definition is always overwritten by a message to the  
effect the function should not be called directly.
__

setGroupGeneric("Foo", function(x) standardGeneric("Foo"))
setGroupGeneric("Foo2", function(x, y) standardGeneric("Foo2"))
setGeneric("foo", function(x) standardGeneric("foo"),
	group = "Foo", useAsDefault = function(x) "Default")
setGeneric("foo2", function(x, y) standardGeneric("foo2"),
	group = "Foo2", useAsDefault = function(x, y) "Default2")
setMethod("Foo", signature(x = "numeric"), function(x) "Special")
setMethod("Foo2", signature(x = "numeric", y = "missing"),
	function(x, y) "Special2")	
foo(1)  # gives the group method
foo2(1) # gives the default method
selectMethod("foo2", signature(x = "numeric", y = "missing")) # but  
method selection appears to work correctly

__

franklin parlamis

 > version

platform       powerpc-apple-darwin8.7.0
arch           powerpc
os             darwin8.7.0
system         powerpc, darwin8.7.0
status
major          2
minor          4.0
year           2006
month          10
day            03
svn rev        39566
language       R
version.string R version 2.4.0 (2006-10-03)



From savicky at cs.cas.cz  Wed Oct 11 07:28:09 2006
From: savicky at cs.cas.cz (savicky at cs.cas.cz)
Date: Wed, 11 Oct 2006 07:28:09 +0200 (CEST)
Subject: [Rd] expression as a parameter of binom.test (PR#9288)
Message-ID: <20061011052809.9D29828FA9@slim.kubism.ku.dk>

Full_Name: Petr Savicky
Version: 2.4.0
OS: Fedora Core release 2
Submission from: (NULL) (62.24.91.47)


the error is 

> binom.test(0.56*10000,10000)
Error in binom.test(0.56 * 10000, 10000) : 
        'x' must be nonnegative and integer

while

> binom.test(5600,10000)

yields correct result.

The same error occurrs for
> binom.test(0.57*10000,10000)



From ripley at stats.ox.ac.uk  Wed Oct 11 09:15:25 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 11 Oct 2006 08:15:25 +0100 (BST)
Subject: [Rd] possible bug? (PR#9285)
In-Reply-To: <20061010165825.A7CEAA26A@slim.kubism.ku.dk>
References: <20061010165825.A7CEAA26A@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0610110807360.8304@gannet.stats.ox.ac.uk>

This is a problem in a (non-CRAN) contributed package, and so a misuse of 
R-bugs: please do read the R FAQ and posting guide.

Binary versions of packages need to be matched to versions of R: almost 
certainly this needs to be re-installed from the sources (which it seems 
that author is not distributiing).

Note that the 'current' version of the packages is said on its webpage to 
be from July 2003, but the package was built under R 2.0.1 in July 2005.


On Tue, 10 Oct 2006, richj at essex.ac.uk wrote:

> =20
>
> =20
>
> I use the FEAR package available from=20
>
> =20
>
> http://www.clemson.edu/economics/faculty/wilson/
>
> =20
>
> which works perfectly in Rv2.2.0; after installing from a local zip and
> loading I find:
>
> =20
>
> USING R version 2.2.0
>
> =20
>
>> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
>
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
>
> Loading required package: KernSmooth
>
> KernSmooth 2.22 installed
>
> Copyright M. P. Wand 1997
>
> FEAR (Frontier Efficiency Analysis with R) 0.913 installed
>
> Copyright Paul W. Wilson 2005
>
>>
>
> =20
>
> and everything works well.
>
> =20
>
> On the other hand with R version 2.4.0, although the package installs
> properly from the local zip, it does not load correctly (the same
> problem occurs with the patched version of 2.4.0).
>
> =20
>
> =20
>
> USING R version 2.4.0
>
> =20
>
>> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
>
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
>
>> utils:::menuInstallLocal()
>
> package 'FEAR' successfully unpacked and MD5 sums checked
>
> updating HTML package descriptions
>
>> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
>
> + if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
>
> Loading required package: KernSmooth
>
> KernSmooth 2.22 installed
>
> Copyright M. P. Wand 1997
>
> Error in dyn.load(x, as.logical(local), as.logical(now)) :=20
>
>        unable to load shared library
> 'C:/PROGRA~1/R/R-24~1.0/library/FEAR/libs/FEAR.dll':
>
>  LoadLibrary failure:  The specified procedure could not be found.
>
> Error in library(pkg, character.only =3D TRUE) :=20
>
>        .First.lib failed for 'FEAR'
>
> =20
>
> =20
>
> =20
>
> Is this a bug in R version 2.4.0 and is there a fix?
>
> =20
>
> =20
>
> =20
>
> *************************
>
> Prof J Richmond
>
> Department of Economics
>
> University of Essex
>
> Colchester CO4 3SQ
>
> United Kingdom
>
> Tel: +44-(0)1206-872769
>
> FAX: +44-(0)1206-872724
>
> email: richj at essex.ac.uk
>
> *************************
>
> =20
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From Roger.Bivand at nhh.no  Wed Oct 11 09:17:03 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 11 Oct 2006 09:17:03 +0200 (CEST)
Subject: [Rd] expression as a parameter of binom.test (PR#9288)
In-Reply-To: <20061011052809.9D29828FA9@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0610110904170.21219-100000@reclus.nhh.no>

On Wed, 11 Oct 2006 savicky at cs.cas.cz wrote:

> Full_Name: Petr Savicky
> Version: 2.4.0
> OS: Fedora Core release 2
> Submission from: (NULL) (62.24.91.47)
> 
> 
> the error is 
> 
> > binom.test(0.56*10000,10000)
> Error in binom.test(0.56 * 10000, 10000) : 
>         'x' must be nonnegative and integer

Well, do:

binom.test(as.integer(0.56*10000),10000)

then.

storage.mode(0.56*10000) 

is "double", not "integer". Footnote 9 in "An Introduction to R", and in 
the table early in Chapter 2 in "R Language Definition". In fact it is 
another rendition of FAQ 7.31 (is anybody logging a time series of 7.31?):

x <- 0.56*10000
x1 <- 5600
all.equal(x, x1) 
identical(x, x1)

and fails:

x != round(x)

in binom.test; it passes:

!isTRUE(all.equal(x, round(x)))

which might be more graceful.

> 
> while
> 
> > binom.test(5600,10000)
> 
> yields correct result.
> 
> The same error occurrs for
> > binom.test(0.57*10000,10000)
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ripley at stats.ox.ac.uk  Wed Oct 11 10:09:41 2006
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Wed, 11 Oct 2006 10:09:41 +0200 (CEST)
Subject: [Rd] expression as a parameter of binom.test (PR#9288)
Message-ID: <20061011080941.637F64C92B@slim.kubism.ku.dk>

On Wed, 11 Oct 2006, Roger Bivand wrote:

> On Wed, 11 Oct 2006 savicky at cs.cas.cz wrote:
>
>> Full_Name: Petr Savicky
>> Version: 2.4.0
>> OS: Fedora Core release 2
>> Submission from: (NULL) (62.24.91.47)
>>
>>
>> the error is
>>
>>> binom.test(0.56*10000,10000)
>> Error in binom.test(0.56 * 10000, 10000) :
>>         'x' must be nonnegative and integer
>
> Well, do:
>
> binom.test(as.integer(0.56*10000),10000)
>
> then.
>
> storage.mode(0.56*10000)
>
> is "double", not "integer". Footnote 9 in "An Introduction to R", and in
> the table early in Chapter 2 in "R Language Definition". In fact it is
> another rendition of FAQ 7.31 (is anybody logging a time series of 7.31?):
>
> x <- 0.56*10000
> x1 <- 5600
> all.equal(x, x1)
> identical(x, x1)
>
> and fails:
>
> x != round(x)
>
> in binom.test; it passes:
>
> !isTRUE(all.equal(x, round(x)))
>
> which might be more graceful.

I think we would want an absolute and not relative tolerance there.
I've allowed a 1e-7 fuzz in R-devel.

>
>>
>> while
>>
>>> binom.test(5600,10000)
>>
>> yields correct result.
>>
>> The same error occurrs for
>>> binom.test(0.57*10000,10000)
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From tadakado at gmail.com  Wed Oct 11 11:29:03 2006
From: tadakado at gmail.com (tadakado at gmail.com)
Date: Wed, 11 Oct 2006 11:29:03 +0200 (CEST)
Subject: [Rd] nls function does not use subset argument (PR#9290)
Message-ID: <20061011092903.BB944407EA@slim.kubism.ku.dk>

Full_Name: Tadashi Kadowaki
Version: 2.4.0
OS: Redhat Linux 9
Submission from: (NULL) (58.12.166.67)


Doesn't nls function support subset?  It seems not to work.
And, there are no information in the online help.
Has it sunk into oblivion?



From ripley at stats.ox.ac.uk  Wed Oct 11 11:42:31 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 11 Oct 2006 10:42:31 +0100 (BST)
Subject: [Rd] nls function does not use subset argument (PR#9290)
In-Reply-To: <20061011092903.BB944407EA@slim.kubism.ku.dk>
References: <20061011092903.BB944407EA@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0610111038420.6508@gannet.stats.ox.ac.uk>

This is not the place to ask a question: do read the FAQ.

?nls shows that nls does have a 'subset' argument, and it does work.
Compare

> ?nls
> x <- 1:10
> y <- 2*x + 3                            # perfect fit
> yeps <- y + rnorm(length(y), sd = 0.01) # added noise
> nls(yeps ~ a + b*x, start = list(a = 0.12345, b = 0.54321),
+     trace = TRUE)
1360.779 :  0.12345 0.54321
0.000778241 :  3.002946 1.999563
0.000778241 :  3.002946 1.999563
Nonlinear regression model
   model:  yeps ~ a + b * x
    data:  parent.frame()
        a        b
3.002946 1.999563
  residual sum-of-squares: 0.000778241
> nls(yeps ~ a + b*x, start = list(a = 0.12345, b = 0.54321),
+     trace = TRUE, subset=1:9)
1056.760 :  0.12345 0.54321
0.0007055261 :  3.000838 2.000138
0.0007055261 :  3.000838 2.000138
Nonlinear regression model
   model:  yeps ~ a + b * x
    data:  parent.frame()
        a        b
3.000838 2.000138
  residual sum-of-squares: 0.0007055261

I find your comments baffling: please provide a reproducible example of 
your claims.


On Wed, 11 Oct 2006, tadakado at gmail.com wrote:

> Full_Name: Tadashi Kadowaki
> Version: 2.4.0
> OS: Redhat Linux 9
> Submission from: (NULL) (58.12.166.67)
>
>
> Doesn't nls function support subset?  It seems not to work.
> And, there are no information in the online help.
> Has it sunk into oblivion?
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From p.dalgaard at biostat.ku.dk  Wed Oct 11 11:55:56 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 11 Oct 2006 11:55:56 +0200
Subject: [Rd] nls function does not use subset argument (PR#9290)
In-Reply-To: <20061011092903.BB944407EA@slim.kubism.ku.dk>
References: <20061011092903.BB944407EA@slim.kubism.ku.dk>
Message-ID: <x2y7rnuqfn.fsf@viggo.kubism.ku.dk>

tadakado at gmail.com writes:

> Full_Name: Tadashi Kadowaki
> Version: 2.4.0
> OS: Redhat Linux 9
> Submission from: (NULL) (58.12.166.67)
> 
> 
> Doesn't nls function support subset?  It seems not to work.
> And, there are no information in the online help.
> Has it sunk into oblivion?

Whatever gave you those ideas?

Yes, nls supports subset.
Yes, it does seem to work.
Yes, it is documented in the online help.
No, it has not sunk into anything.


> nls(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase, subset=Run==1)
Nonlinear regression model
  model:  density ~ SSlogis(log(conc), Asym, xmid, scal)
   data:  DNase
    Asym     xmid     scal
2.345180 1.483090 1.041455
 residual sum-of-squares: 0.004789569


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From tadakado at gmail.com  Wed Oct 11 14:10:43 2006
From: tadakado at gmail.com (Tadashi Kadowaki)
Date: Wed, 11 Oct 2006 21:10:43 +0900
Subject: [Rd] nls function does not use subset argument (PR#9290)
In-Reply-To: <x2y7rnuqfn.fsf@viggo.kubism.ku.dk>
References: <20061011092903.BB944407EA@slim.kubism.ku.dk>
	<x2y7rnuqfn.fsf@viggo.kubism.ku.dk>
Message-ID: <dcb3073c0610110510m548cab97t15c36894b43e83da@mail.gmail.com>

I am sorry, it was my program's bug.
Yes, subset works!
Yes, nls works correctly!

I didn't pay enough attention to NAs.
NA threw off start value estimation in my program.
So, I got different results when I filtered NAs beforehand
and filtered by subset.
I also confused because subset does not appear in the
code of the nls function.
Then, I reached a wrong conclusion.

Thank you very much for your time.

Tadashi Kadowaki

11 Oct 2006 11:55:56 +0200, Peter Dalgaard <p.dalgaard at biostat.ku.dk>:
> tadakado at gmail.com writes:
>
> > Full_Name: Tadashi Kadowaki
> > Version: 2.4.0
> > OS: Redhat Linux 9
> > Submission from: (NULL) (58.12.166.67)
> >
> >
> > Doesn't nls function support subset?  It seems not to work.
> > And, there are no information in the online help.
> > Has it sunk into oblivion?
>
> Whatever gave you those ideas?
>
> Yes, nls supports subset.
> Yes, it does seem to work.
> Yes, it is documented in the online help.
> No, it has not sunk into anything.
>
>
> > nls(density ~ SSlogis(log(conc), Asym, xmid, scal), DNase, subset=Run==1)
> Nonlinear regression model
>  model:  density ~ SSlogis(log(conc), Asym, xmid, scal)
>   data:  DNase
>    Asym     xmid     scal
> 2.345180 1.483090 1.041455
>  residual sum-of-squares: 0.004789569
>
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>



From sfalcon at fhcrc.org  Wed Oct 11 16:29:48 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 11 Oct 2006 07:29:48 -0700
Subject: [Rd] operator :: and symbols not in the namespace of a package
	with a namespace
In-Reply-To: <Pine.LNX.4.64.0610091611110.17674@gannet.stats.ox.ac.uk> (Brian
	Ripley's message of "Mon, 9 Oct 2006 16:18:13 +0100 (BST)")
References: <20061006130505.A50374BEC2@slim.kubism.ku.dk>
	<45265A8A.6060505@stats.uwo.ca>
	<Pine.LNX.4.64.0610060938000.7912@nokomis.stat.uiowa.edu>
	<Pine.LNX.4.64.0610091611110.17674@gannet.stats.ox.ac.uk>
Message-ID: <m28xjn6i3n.fsf@ziti.local>

Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:
> The reason was (and is) that if datasets are in the namespace, functions 
> in the namespace find them ahead of a dataset of the same name in the 
> user's workspace.  

That this is desirable seems to be where opinions differ.  The
Bioconductor project distributes many so-called data packages and
having the data protected by the package namespace would be an
improvement.

It also makes things easier to explain to new users.  Once the
namespace concept is understood, one doesn't need to also learn about
data being an exception.

> (This broke the MASS scripts, for example, and also 
> affects car.)  (We do have a mechanism to put system datasets in the 
> namespace where this is the desired behaviour, but it seems
> uncommon.) 

I will investigate whether this mechanism would suit our needs, but my
impression is that it is less flexible than the data mechanism.  In
particular, one has to have a single rda file and make use of
lazy-loading which has serious performance implications for users
installing from source.

> I really don't fancy explaining to our beginning students that when
> they are asked to correct some entries in a dataset some functions
> will see the corrected version and some the original if they just
> use fix().

Explaining this concept to students could be difficult, but don't they
need to understand this namespace concept when they modify functions?


+ seth

--
Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
http://bioconductor.org



From jmc at r-project.org  Wed Oct 11 19:40:53 2006
From: jmc at r-project.org (John Chambers)
Date: Wed, 11 Oct 2006 13:40:53 -0400
Subject: [Rd] dispatching on group generics with more than one formal
In-Reply-To: <6FB8311F-57A3-4FFB-BAF2-B49A9A3442CB@mac.com>
References: <6FB8311F-57A3-4FFB-BAF2-B49A9A3442CB@mac.com>
Message-ID: <452D2CA5.7010603@r-project.org>

Yes, a bug.

The problem is that all generics start off with only 1 active argument 
in the signature (for efficiency).  As soon as a method is specified 
with >1 args in the signature, the number of active arguments is 
supposed to be incremented accordingly.  But specifying the method for 
the _group_ generic doesn't trigger this in the members of the group, as 
it should.

Should be fairly easy to fix, but I won't likely have time for a few days.

Meanwhile, a workaround is to define a method for the member generic 
with >1 arguments in the signature:

 > setMethod("foo2", c("character", "missing"),
    function(x, y) "CharacterMethod")
[1] "foo2"

 > foo2(1)
[1] "Special2"



Parlamis Franklin wrote:
> please see the code below.  foo2 fails to dispatch correctly, but foo  
> does fine.  i have tried 'cacheMetaData(1)' and a number of different  
> variants of 'cacheGenericsMetaData', on the possibility there is a  
> caching issue.  but i still can't sort it out.
>
> also one general question: does it really matter what's in the body  
> of the function definition in a 'setGroupGeneric' call?  the actual  
> group function definition is always overwritten by a message to the  
> effect the function should not be called directly.
> __
>
> setGroupGeneric("Foo", function(x) standardGeneric("Foo"))
> setGroupGeneric("Foo2", function(x, y) standardGeneric("Foo2"))
> setGeneric("foo", function(x) standardGeneric("foo"),
> 	group = "Foo", useAsDefault = function(x) "Default")
> setGeneric("foo2", function(x, y) standardGeneric("foo2"),
> 	group = "Foo2", useAsDefault = function(x, y) "Default2")
> setMethod("Foo", signature(x = "numeric"), function(x) "Special")
> setMethod("Foo2", signature(x = "numeric", y = "missing"),
> 	function(x, y) "Special2")	
> foo(1)  # gives the group method
> foo2(1) # gives the default method
> selectMethod("foo2", signature(x = "numeric", y = "missing")) # but  
> method selection appears to work correctly
>
> __
>
> franklin parlamis
>
>  > version
>
> platform       powerpc-apple-darwin8.7.0
> arch           powerpc
> os             darwin8.7.0
> system         powerpc, darwin8.7.0
> status
> major          2
> minor          4.0
> year           2006
> month          10
> day            03
> svn rev        39566
> language       R
> version.string R version 2.4.0 (2006-10-03)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From sfalcon at fhcrc.org  Wed Oct 11 20:48:42 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 11 Oct 2006 11:48:42 -0700
Subject: [Rd] Possible bug in accessing methods documentation?
Message-ID: <m2ac423cz9.fsf@ziti.local>

Hi,

Reading help("Documentation"), I'm led to believe that a help call
like:

    ?myFun(x, sqrt(wt))

Will search for help on the appropriate method in the case that myFun
is generic.  This isn't working for me.  Here is an example using the
Biobase package:

## If Biobase is not installed
source("http://bioconductor.org/biocLite.R")
biocLite("Biobase")

> library("Biobase")
> data(sample.ExpressionSet)
> class(sample.ExpressionSet)
[1] "ExpressionSet"
attr(,"package")
[1] "Biobase"
> z <- featureNames(sample.ExpressionSet)
> z[1:2]
[1] "AFFX-MurIL2_at"  "AFFX-MurIL10_at"
> ?featureNames(sample.ExpressionSet)
Warning message:
no method defined for function 'featureNames' and signature 'object = "missing"' in: .helpForCall(e1Expr, parent.frame()) 
Error in .helpForCall(e1Expr, parent.frame()) : 
        no documentation for function 'featureNames' and signature 'object = "missing"'


Am I expecting the wrong thing or is this broken?  

+ seth



From murdoch at stats.uwo.ca  Wed Oct 11 22:26:40 2006
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Wed, 11 Oct 2006 22:26:40 +0200 (CEST)
Subject: [Rd] Possible bug in accessing methods documentation? (PR#9291)
Message-ID: <20061011202640.39C2A4BEC6@slim.kubism.ku.dk>

On 10/11/2006 2:48 PM, Seth Falcon wrote:
> Hi,
> 
> Reading help("Documentation"), I'm led to believe that a help call
> like:
> 
>     ?myFun(x, sqrt(wt))
> 
> Will search for help on the appropriate method in the case that myFun
> is generic.  This isn't working for me.  Here is an example using the
> Biobase package:
> 
> ## If Biobase is not installed
> source("http://bioconductor.org/biocLite.R")
> biocLite("Biobase")
> 
>> library("Biobase")
>> data(sample.ExpressionSet)
>> class(sample.ExpressionSet)
> [1] "ExpressionSet"
> attr(,"package")
> [1] "Biobase"
>> z <- featureNames(sample.ExpressionSet)
>> z[1:2]
> [1] "AFFX-MurIL2_at"  "AFFX-MurIL10_at"
>> ?featureNames(sample.ExpressionSet)
> Warning message:
> no method defined for function 'featureNames' and signature 'object = "missing"' in: .helpForCall(e1Expr, parent.frame()) 
> Error in .helpForCall(e1Expr, parent.frame()) : 
>         no documentation for function 'featureNames' and signature 'object = "missing"'
> 
> 
> Am I expecting the wrong thing or is this broken?  

I think it's broken.  The line that looks broken is in .helpForCall, 
where it has

methods::"elNamed<-"(sigClasses, arg, class(argVal))

Looking at the elNamed<- function, I think this is supposed to be 
equivalent to

sigClasses[[arg]] <- class(argVal)

but it is not making any assignment.  I don't understand the point of 
doing the assignment that way, or why it's not working, so I'll leave 
this for someone else.

Duncan Murdoch



From murdoch at stats.uwo.ca  Wed Oct 11 23:33:26 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 11 Oct 2006 17:33:26 -0400
Subject: [Rd] Possible bug in accessing methods documentation? (PR#9291)
In-Reply-To: <20061011202640.39C2A4BEC6@slim.kubism.ku.dk>
References: <20061011202640.39C2A4BEC6@slim.kubism.ku.dk>
Message-ID: <452D6326.7030309@stats.uwo.ca>

On 10/11/2006 4:26 PM, murdoch at stats.uwo.ca wrote:
> On 10/11/2006 2:48 PM, Seth Falcon wrote:
>> Hi,
>>
>> Reading help("Documentation"), I'm led to believe that a help call
>> like:
>>
>>     ?myFun(x, sqrt(wt))
>>
>> Will search for help on the appropriate method in the case that myFun
>> is generic.  This isn't working for me.  Here is an example using the
>> Biobase package:
>>
>> ## If Biobase is not installed
>> source("http://bioconductor.org/biocLite.R")
>> biocLite("Biobase")
>>
>>> library("Biobase")
>>> data(sample.ExpressionSet)
>>> class(sample.ExpressionSet)
>> [1] "ExpressionSet"
>> attr(,"package")
>> [1] "Biobase"
>>> z <- featureNames(sample.ExpressionSet)
>>> z[1:2]
>> [1] "AFFX-MurIL2_at"  "AFFX-MurIL10_at"
>>> ?featureNames(sample.ExpressionSet)
>> Warning message:
>> no method defined for function 'featureNames' and signature 'object = "missing"' in: .helpForCall(e1Expr, parent.frame()) 
>> Error in .helpForCall(e1Expr, parent.frame()) : 
>>         no documentation for function 'featureNames' and signature 'object = "missing"'
>>
>>
>> Am I expecting the wrong thing or is this broken?  
> 
> I think it's broken.  The line that looks broken is in .helpForCall, 
> where it has
> 
> methods::"elNamed<-"(sigClasses, arg, class(argVal))
> 
> Looking at the elNamed<- function, I think this is supposed to be 
> equivalent to
> 
> sigClasses[[arg]] <- class(argVal)
> 
> but it is not making any assignment.  I don't understand the point of 
> doing the assignment that way, or why it's not working, so I'll leave 
> this for someone else.

Actually, why it's not working is obvious:  it's not assigning the 
result back into sigClasses.  But I still don't understand what it is 
doing that is different from the version below.

Duncan Murdoch



From bflat24 at gmail.com  Wed Oct 11 23:58:59 2006
From: bflat24 at gmail.com (T C)
Date: Wed, 11 Oct 2006 17:58:59 -0400
Subject: [Rd] Compiling R 2.4.0 in ubuntu/linux
Message-ID: <ca7bd80e0610111458u7956d43cvb8920e1f2ea09e11@mail.gmail.com>

I'm not sure if this is the place to post this question, but, I am
having trouble compiling the source code. I do have a suitable C
compiler and f2c but I get this error when I run ./configure

configure: error: --with-readline=yes (default) and headers/libs are
not available

Any ideas? Thanks.



From mtmorgan at fhcrc.org  Thu Oct 12 00:04:05 2006
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Wed, 11 Oct 2006 15:04:05 -0700
Subject: [Rd] Possible bug in accessing methods documentation?
In-Reply-To: <m2ac423cz9.fsf@ziti.local> (Seth Falcon's message of "Wed, 11
	Oct 2006 11:48:42 -0700")
References: <m2ac423cz9.fsf@ziti.local>
Message-ID: <6phd58ymrvu.fsf@gopher4.fhcrc.org>

Seth's example is really good -- ExpressionSet extends eSet, and
featureNames is defined on eSet rather than ExpressionSet. To live
up to the documentation, we should end up at the help page with
\alias{featureNames,eSet-method}. A simpler example from the same
package is

?exprs(sample.ExpressionSet)

which should take us to the page with
\alias{exprs,ExpressionSet-method}. 

Probably related to the overall issue,

method ? exprs("ExpressionSet")
method ? featureNames("ExpressionSet") # inheritance

do not work.  Also, in the examples for ?"?"

methods ? combo

should probably be

method ? combo

Martin

Seth Falcon <sfalcon at fhcrc.org> writes:

> Hi,
>
> Reading help("Documentation"), I'm led to believe that a help call
> like:
>
>     ?myFun(x, sqrt(wt))
>
> Will search for help on the appropriate method in the case that myFun
> is generic.  This isn't working for me.  Here is an example using the
> Biobase package:
>
> ## If Biobase is not installed
> source("http://bioconductor.org/biocLite.R")
> biocLite("Biobase")
>
>> library("Biobase")
>> data(sample.ExpressionSet)
>> class(sample.ExpressionSet)
> [1] "ExpressionSet"
> attr(,"package")
> [1] "Biobase"
>> z <- featureNames(sample.ExpressionSet)
>> z[1:2]
> [1] "AFFX-MurIL2_at"  "AFFX-MurIL10_at"
>> ?featureNames(sample.ExpressionSet)
> Warning message:
> no method defined for function 'featureNames' and signature 'object = "missing"' in: .helpForCall(e1Expr, parent.frame()) 
> Error in .helpForCall(e1Expr, parent.frame()) : 
>         no documentation for function 'featureNames' and signature 'object = "missing"'
>
>
> Am I expecting the wrong thing or is this broken?  
>
> + seth
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin T. Morgan
Bioconductor / Computational Biology
http://bioconductor.org



From gavin.simpson at ucl.ac.uk  Thu Oct 12 00:16:51 2006
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed, 11 Oct 2006 23:16:51 +0100
Subject: [Rd] Compiling R 2.4.0 in ubuntu/linux
In-Reply-To: <ca7bd80e0610111458u7956d43cvb8920e1f2ea09e11@mail.gmail.com>
References: <ca7bd80e0610111458u7956d43cvb8920e1f2ea09e11@mail.gmail.com>
Message-ID: <1160605011.2343.22.camel@graptoleberis.geog.ucl.ac.uk>

On Wed, 2006-10-11 at 17:58 -0400, T C wrote:
> I'm not sure if this is the place to post this question, but, I am
> having trouble compiling the source code. I do have a suitable C
> compiler and f2c but I get this error when I run ./configure
> 
> configure: error: --with-readline=yes (default) and headers/libs are
> not available
> 
> Any ideas? Thanks.

You need the readline development headers, which in general are found in
<package_name>-devel package available for your distribution. You might
have readline installed, but clearly you don't have the development
headers or they are installed in a non-standard place that the configure
script can't find them.

I'm not familiar with Ubuntu, but on Fedora the package you need is
readline-devel. Install it using Ubuntu's package manager and then try
to recompile.

And please *don't* post to both R-Help *and* R-devel; posting to one
list is quite sufficient and only R-devel is the appropriate list for
questions of this nature.

HTH

G

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Gavin Simpson                 [t] +44 (0)20 7679 0522
 ECRC & ENSIS, UCL Geography,  [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/cv/
 London, UK. WC1E 6BT.         [w] http://www.ucl.ac.uk/~ucfagls/
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%



From bullard at berkeley.edu  Thu Oct 12 02:52:09 2006
From: bullard at berkeley.edu (James Bullard)
Date: Wed, 11 Oct 2006 17:52:09 -0700
Subject: [Rd] Compiling R 2.4.0 in ubuntu/linux
In-Reply-To: <1160605011.2343.22.camel@graptoleberis.geog.ucl.ac.uk>
References: <ca7bd80e0610111458u7956d43cvb8920e1f2ea09e11@mail.gmail.com>
	<1160605011.2343.22.camel@graptoleberis.geog.ucl.ac.uk>
Message-ID: <452D91B9.8090700@berkeley.edu>



Gavin Simpson wrote:
> On Wed, 2006-10-11 at 17:58 -0400, T C wrote:
>> I'm not sure if this is the place to post this question, but, I am
>> having trouble compiling the source code. I do have a suitable C
>> compiler and f2c but I get this error when I run ./configure
>>
>> configure: error: --with-readline=yes (default) and headers/libs are
>> not available
>>
>> Any ideas? Thanks.
> 
> You need the readline development headers, which in general are found in
> <package_name>-devel package available for your distribution. You might
> have readline installed, but clearly you don't have the development
> headers or they are installed in a non-standard place that the configure
> script can't find them.
> 
> I'm not familiar with Ubuntu, but on Fedora the package you need is
> readline-devel. Install it using Ubuntu's package manager and then try
> to recompile.

On ubuntu (dapper) the package is:

libreadline5-dev


> 
> And please *don't* post to both R-Help *and* R-devel; posting to one
> list is quite sufficient and only R-devel is the appropriate list for
> questions of this nature.
> 
> HTH
> 
> G
>



From deepayan.sarkar at gmail.com  Thu Oct 12 03:22:56 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Wed, 11 Oct 2006 18:22:56 -0700
Subject: [Rd] warnings with plot=FALSE in hist.default
Message-ID: <eb555e660610111822n37f03720k76cd72a30b23bf6c@mail.gmail.com>

Hi,

the NEWS for R 2.4.0 has:

    o   hist(*, plot = FALSE) now warns about unused arguments.

I'm sure this does some good for someone somewhere, but it causes
lattice::histogram() calls to produce warnings now in certain cases,
which I need to fix. However, ?hist makes no mention of this new state
of affairs, and the definition of ``unused'' seems arbitrary since
'freq' and 'probability', which have no effect (unless they contradict
each other) do not trigger the warning. Could the help page be
clarified to reflect the intent so that I don't get caught by more
changes later?

Thanks,

Deepayan

P.S. The help page also has

     ...: further graphical parameters passed to 'plot.histogram' and
          their to 'title' and 'axis' (if 'plot=TRUE').

which is grammatically incorrect (I'm not sure what was intended).



From ripley at stats.ox.ac.uk  Thu Oct 12 09:18:59 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 12 Oct 2006 08:18:59 +0100 (BST)
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <4526954A.7050509@stats.uwo.ca>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>
	<dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
	<4525075D.4040102@stats.uwo.ca> <452693D4.2010905@cimr.cam.ac.uk>
	<4526954A.7050509@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0610091258200.24252@gannet.stats.ox.ac.uk>

On Fri, 6 Oct 2006, Duncan Murdoch wrote:

> On 10/6/2006 1:35 PM, Hin-Tak Leung wrote:
>> Duncan Murdoch wrote:
>>> On 2006-10-5 8:06, Ei-ji Nakama wrote:
>>>> I do not understand Chinese, but recognize kanji.
>>>> RGui-zh_CN.po is written in utf-8, but charset=CP936 wrote.
>>>>
>>>>   perl -p -i -e 's#charset=CP936#charset=utf-8#' RGui-zh_CN.po
>>>>   msgfmt -o RGui.mo RGui-zh_CN.po
>>>
>>> Thanks!!  That does fix the error, at least on my system.  I'll commit
>>> the change to R-devel and R-patched.
>>
>> Hmm, I do understand Chinese, and I can confirm that the content
>> of RGui-zh_CN.po in R 2.4 is in utf-8 rather than CP936.
>>
>> I can also confirm that CP950(big5) for RGui-zh_TW.po is correct, and
>> CP932(shift-JIS) for  RGui-ja.po is also correct. (so you'll need to
>> find some korean to verify CP949 for RGui-ko.po).
>>
>> However, the fix is slightly "asymmetric". Out of ru, zh_CN, zh_TW,
>> ja, ko, only ru in R-2.4.0/po/*.po is in localised encoding,
>> (the others 4 in UTF-8), whereas RGui-*.po, after the fix, all
>> are in localised encoding except RGui-zh_CN.po .
>>
>> I would propose correcting the encoding of the *content*, rather
>> than the charset tag, so that Rgui-* all uses localised ones (CP932,
>> CP936, CP949, CP950). That should be better for older windows...

That was the intention, but the translator marked it incorrectly, and it 
appeared to be valid CP936 so not picked up by me.

> I did try that, but iconv didn't want to convert the file from UTF-8 to
> CP936.  I've no idea why not.
>
> In any case, those files only need to be readable by the translation
> teams, not by end-users, so I don't think the asymmetry matters:  if a
> translator finds it easy to work in UTF-8 that's fine for R, as long as
> it is correctly recorded.

Not really: the file does need to be convertible to the target encoding, 
and on Windows that is e.g. CP936.  That is why we have the RGui files in 
the native encoding: for all the other files we prefer UTF-8 or Latin-1.

I need to sort out with the translator a valid CP936 version of that file: 
it contains a character that is not in CP936.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From hin-tak.leung at cimr.cam.ac.uk  Thu Oct 12 12:36:32 2006
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 12 Oct 2006 11:36:32 +0100
Subject: [Rd] Bug in 2.4.0 Windows menu setup (PR#9277)
In-Reply-To: <Pine.LNX.4.64.0610091258200.24252@gannet.stats.ox.ac.uk>
References: <20061005025158.19A9C20804@slim.kubism.ku.dk>
	<dc41e1260610050506i3b65913ifca644ebd0b690e4@mail.gmail.com>
	<4525075D.4040102@stats.uwo.ca> <452693D4.2010905@cimr.cam.ac.uk>
	<4526954A.7050509@stats.uwo.ca>
	<Pine.LNX.4.64.0610091258200.24252@gannet.stats.ox.ac.uk>
Message-ID: <452E1AB0.9090808@cimr.cam.ac.uk>

Prof Brian Ripley wrote:
> On Fri, 6 Oct 2006, Duncan Murdoch wrote:
> 
>> On 10/6/2006 1:35 PM, Hin-Tak Leung wrote:
<snipped>
>>> I would propose correcting the encoding of the *content*, rather
>>> than the charset tag, so that Rgui-* all uses localised ones (CP932,
>>> CP936, CP949, CP950). That should be better for older windows...
> 
> That was the intention, but the translator marked it incorrectly, and it 
> appeared to be valid CP936 so not picked up by me.
> 
<snipped>
> 
> I need to sort out with the translator a valid CP936 version of that 
> file: it contains a character that is not in CP936.

Hi. There is one invalid character at line 855. Here is the patch,
the corrected utf-8 version (against 2.4.0, without changing the
charset tag...), and the correctly converted CP936
(a.k.a. GB2312 or EUC-CN) version.

I have checked round-trip conversion with CP936<->utf-8 with both
iconv and Ken Lunde's cjkvconv.pl .

You can either apply the patch, or just replace what is in the R
source with the EUC-CN version. (the latter would be my preferred
solution, but since it is sort of "unnessarily large change",
I'll live with the former...).

Hin-Tak Leung


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: RGui-zh_CN.po.euc-cn.corrected
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061012/ce62e689/attachment-0006.pl 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: RGui-zh_CN.po.utf8.corrected
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061012/ce62e689/attachment-0007.pl 

From p.smith at auckland.ac.nz  Thu Oct 12 13:46:21 2006
From: p.smith at auckland.ac.nz (p.smith at auckland.ac.nz)
Date: Thu, 12 Oct 2006 13:46:21 +0200 (CEST)
Subject: [Rd] Installation fails on FreeBSD (PR#9293)
Message-ID: <20061012114621.16FF549FE2@slim.kubism.ku.dk>

Full_Name: Peter Smith
Version: 2.3.1
OS: FreeBSD 5.3
Submission from: (NULL) (219.88.191.10)


I'm installing R from the FreeBSD ports tree (i.e. running make from
/usr/ports/math/R). During the make, the following error message is generated.

<snip>
     Formats: text html latex example 
 >>> Building/Updating help pages for package 'tcltk'
     Formats: text html latex example 
building/updating package indices ...
begin installing recommended package foreign
* Installing *source* package 'foreign' ...
eval: ./configure: Permission denied
ERROR: configuration failed for package 'foreign'
<snip>

The problem seems to occur when the following command is executed.

MAKE="make" R_LIBS= ../../../bin/R CMD INSTALL --no-lock -l "../../../library"
foreign.tgz > foreign.ts.out 2>&1 || (cat foreign.ts.out && exit 1)


The contents of foreign.ts.out is:
* Installing *source* package 'foreign' ...
eval: ./configure: Permission denied
ERROR: configuration failed for package 'foreign'
** Removing '/usr/ports/math/R/work/R-2.3.1/library/foreign



From p.dalgaard at biostat.ku.dk  Thu Oct 12 14:42:28 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 12 Oct 2006 14:42:28 +0200
Subject: [Rd] Installation fails on FreeBSD (PR#9293)
In-Reply-To: <20061012114621.16FF549FE2@slim.kubism.ku.dk>
References: <20061012114621.16FF549FE2@slim.kubism.ku.dk>
Message-ID: <x28xjl903v.fsf@viggo.kubism.ku.dk>

p.smith at auckland.ac.nz writes:

> Full_Name: Peter Smith
> Version: 2.3.1
> OS: FreeBSD 5.3
> Submission from: (NULL) (219.88.191.10)
> 
> 
> I'm installing R from the FreeBSD ports tree (i.e. running make from
> /usr/ports/math/R). During the make, the following error message is generated.
> 
> <snip>
>      Formats: text html latex example 
>  >>> Building/Updating help pages for package 'tcltk'
>      Formats: text html latex example 
> building/updating package indices ...
> begin installing recommended package foreign
> * Installing *source* package 'foreign' ...
> eval: ./configure: Permission denied
> ERROR: configuration failed for package 'foreign'
> <snip>
> 
> The problem seems to occur when the following command is executed.
> 
> MAKE="make" R_LIBS= ../../../bin/R CMD INSTALL --no-lock -l "../../../library"
> foreign.tgz > foreign.ts.out 2>&1 || (cat foreign.ts.out && exit 1)
> 
> 
> The contents of foreign.ts.out is:
> * Installing *source* package 'foreign' ...
> eval: ./configure: Permission denied

I don't think this is a bug in R. More likely, you have a permission
problem in your setup, possibly a too restrictive umask setting. The
system is complaining that it cannot run the configure script.

[In principle, R could try and remedy such problems by overriding
system defaults. We have discussed this before and come down on the
side that if the user or the system adminstrator sets things up so
that there are things that users cannot do by default (such as running
arbitrary downloaded scripts), then it is not our business to fix it
behind their backs.]

> ERROR: configuration failed for package 'foreign'
> ** Removing '/usr/ports/math/R/work/R-2.3.1/library/foreign



-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.smith at auckland.ac.nz  Thu Oct 12 15:05:37 2006
From: p.smith at auckland.ac.nz (Smith, Peter)
Date: Fri, 13 Oct 2006 02:05:37 +1300
Subject: [Rd] Installation fails on FreeBSD (PR#9293)
References: <20061012114621.16FF549FE2@slim.kubism.ku.dk>
	<x28xjl903v.fsf@viggo.kubism.ku.dk>
Message-ID: <1E11F4042C05ED4BAA6BA96319DA5661A84AC9@comxchg1.com.auckland.ac.nz>

Hi Peter,
 
Hmm, I thought so as well -- and so I did a chown and a chmod and set umask to 0000 and still the problem persists. Then I went wild and tried doing it as root, and still the problem remains.
 
So, I've now deleted everything in the ports tree and am kicking off the make again. But since it is now 2:00 in the morning, I'll leave it to run whilst I sleep.
 
Thanks for your prompt suggestions. Much appreciated.
 
Regards
Peter
 

________________________________

From: pd at pubhealth.ku.dk on behalf of Peter Dalgaard
Sent: Fri 13/10/06 1:42
To: p.smith at auckland.ac.nz
Cc: r-devel at stat.math.ethz.ch; R-bugs at biostat.ku.dk
Subject: Re: [Rd] Installation fails on FreeBSD (PR#9293)



p.smith at auckland.ac.nz writes:

> Full_Name: Peter Smith
> Version: 2.3.1
> OS: FreeBSD 5.3
> Submission from: (NULL) (219.88.191.10)
>
>
> I'm installing R from the FreeBSD ports tree (i.e. running make from
> /usr/ports/math/R). During the make, the following error message is generated.
>
> <snip>
>      Formats: text html latex example
>  >>> Building/Updating help pages for package 'tcltk'
>      Formats: text html latex example
> building/updating package indices ...
> begin installing recommended package foreign
> * Installing *source* package 'foreign' ...
> eval: ./configure: Permission denied
> ERROR: configuration failed for package 'foreign'
> <snip>
>
> The problem seems to occur when the following command is executed.
>
> MAKE="make" R_LIBS= ../../../bin/R CMD INSTALL --no-lock -l "../../../library"
> foreign.tgz > foreign.ts.out 2>&1 || (cat foreign.ts.out && exit 1)
>
>
> The contents of foreign.ts.out is:
> * Installing *source* package 'foreign' ...
> eval: ./configure: Permission denied

I don't think this is a bug in R. More likely, you have a permission
problem in your setup, possibly a too restrictive umask setting. The
system is complaining that it cannot run the configure script.

[In principle, R could try and remedy such problems by overriding
system defaults. We have discussed this before and come down on the
side that if the user or the system adminstrator sets things up so
that there are things that users cannot do by default (such as running
arbitrary downloaded scripts), then it is not our business to fix it
behind their backs.]

> ERROR: configuration failed for package 'foreign'
> ** Removing '/usr/ports/math/R/work/R-2.3.1/library/foreign



--
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From whit.armstrong at hcmny.com  Thu Oct 12 15:08:25 2006
From: whit.armstrong at hcmny.com (Armstrong, Whit)
Date: Thu, 12 Oct 2006 09:08:25 -0400
Subject: [Rd] plot.POSIXct
Message-ID: <E58BE6136618CF4C964F6EC7773AE569B5040C@ex4.nyc.hcmny.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061012/518d8e4c/attachment-0003.pl 

From whit.armstrong at hcmny.com  Thu Oct 12 15:12:27 2006
From: whit.armstrong at hcmny.com (Armstrong, Whit)
Date: Thu, 12 Oct 2006 09:12:27 -0400
Subject: [Rd] plot.POSIXct
Message-ID: <E58BE6136618CF4C964F6EC7773AE569B5040D@ex4.nyc.hcmny.com>

Sorry forgot to include:

> R.Version()
$platform
[1] "x86_64-unknown-linux-gnu"

$arch
[1] "x86_64"

$os
[1] "linux-gnu"

$system
[1] "x86_64, linux-gnu"

$status
[1] ""

$major
[1] "2"

$minor
[1] "4.0"

$year
[1] "2006"

$month
[1] "10"

$day
[1] "03"

$`svn rev`
[1] "39566"

$language
[1] "R"

$version.string
[1] "R version 2.4.0 (2006-10-03)"




This e-mail message is intended only for the named recipient(s) above. It may contain confidential information. If you are not the intended recipient you are hereby notified that any dissemination, distribution or copying of this e-mail and any attachment(s) is strictly prohibited. If you have received this e-mail in error, please immediately notify the sender by replying to this e-mail and delete the message and any attachment(s) from your system. Thank you.


From murdoch at stats.uwo.ca  Thu Oct 12 15:33:34 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 12 Oct 2006 09:33:34 -0400
Subject: [Rd] plot.POSIXct
In-Reply-To: <E58BE6136618CF4C964F6EC7773AE569B5040C@ex4.nyc.hcmny.com>
References: <E58BE6136618CF4C964F6EC7773AE569B5040C@ex4.nyc.hcmny.com>
Message-ID: <452E442E.6070305@stats.uwo.ca>

On 10/12/2006 9:08 AM, Armstrong, Whit wrote:
> I've never had any issues with the way that plot.POSIXct chooses the
> labels of the date axis before, but in this particular case it's output
> is a little confusing.

It was wrong, but this was fixed in R-patched last week.  I've added an 
item to NEWS about it.

Duncan Murdoch

> 
> plot(seq(as.POSIXct("1997-10-01"),length.out=108,by="month"),rnorm(108))
> 
> This command produces a chart with every x tick mark labeled as "Jan
> 01".
> 
> I can replicate this chart by adding the format string "%b %d".
> 
> plot(seq(as.POSIXct("1997-10-01"),length.out=108,by="month"),rnorm(108),
> format="%b-%d")
> 
> My contention is that plot.POSIXct should choose "%Y" in this case,
> which would show unique labels rather than repeated labels.
> 
> plot(seq(as.POSIXct("1997-10-01"),length.out=108,by="month"),rnorm(108),
> format="%Y")
> 
> 
> 
> Now, just looking at axis.POSIXct it seems that the terminal condition
> of this if/else sequence sets format to "%b %d":
> 
>  }
>     else if (d < 7 * 60 * 60 * 24) {
>         sc <- 60 * 60 * 24
>         if (missing(format)) 
>             format <- "%a"
>     }
>     else {
>         sc <- 60 * 60 * 24
>         if (missing(format)) 
>             format <- "%b %d"  #****** here
>     }
> 
> 
> when the second set of if conditions fires up, format has already bet
> set, so the missing(format) test fails here and does not set the format
> to %Y:
> 
>  else {
>         class(z) <- c("POSIXt", "POSIXct")
>         zz <- as.POSIXlt(z)
>         zz$mday <- 1
>         zz$isdst <- zz$mon <- zz$hour <- zz$min <- zz$sec <- 0
>         zz$year <- pretty(zz$year)
>         z <- as.POSIXct(zz)
>         if (missing(format)) 
>             format <- "%Y"   #******  here
>     }
> 
> I'm not sure if this is the intended behavior or not.  Does anyone else
> have any thoughts on this issue?
> 
> Thanks,
> Whit
> 
> 
> 
> 
> 
> This e-mail message is intended only for the named recipient(s) above. It may contain confidential information. If you are not the intended recipient you are hereby notified that any dissemination, distribution or copying of this e-mail and any attachment(s) is strictly prohibited. If you have received this e-mail in error, please immediately notify the sender by replying to this e-mail and delete the message and any attachment(s) from your system. Thank you.
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From ripley at stats.ox.ac.uk  Thu Oct 12 16:18:45 2006
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 12 Oct 2006 16:18:45 +0200 (CEST)
Subject: [Rd] error in dput applied to dataframe (PR#9286)
Message-ID: <20061012141845.CC93E4C934@slim.kubism.ku.dk>

The help for dput says

      Deparsing an object is difficult, and not always possible.  With
      the default 'control = c("showAttributes")', 'dput()' attempts to
      deparse in a way that is readable, but for more complex or unusual
      objects, not likely to be parsed as identical to the original.
      Use 'control = "all"'  for the most complete deparsing; use
      'control = NULL' for the simplest deparsing, not even including
      attributes.

You needed to take note of that:

> dput(df, control="all")
structure(list(aaa = structure(as.integer(c(1, 2, 1)), .Label = c("AAA",
"BBB"), class = "factor"), bbb = c(1, 2, 3)), .Names = c("aaa",
"bbb"), row.names = as.integer(c(NA, 3)), class = "data.frame")

dump() would have worked correctly.

On Tue, 10 Oct 2006, higgins at nceas.ucsb.edu wrote:

> Full_Name: Daniel F Higgins
> Version: 2.4.0
> OS: Windows XP and Mac OSX
> Submission from: (NULL) (128.111.242.49)
>
>
> Create a dataframe as indicated below and apply 'dput' to it; note that the
> row.names attribute is incorrect!
>
>> aaa <- c("AAA","BBB","AAA")
>> bbb <- c(1,2,3)
>> df <- data.frame(aaa,bbb)
>> dput(df)
> structure(list(aaa = structure(c(1, 2, 1), .Label = c("AAA",
> "BBB"), class = "factor"), bbb = c(1, 2, 3)), .Names = c("aaa",
> "bbb"), row.names = c(NA, 3), class = "data.frame")
>> dput(df,file="puttest.R")
>> dget("puttest.R")
> Error in attributes(.Data) <- c(attributes(.Data), attrib) :
>        row names must be 'character' or 'integer', not 'double'
>>
>
> However, if R version 2.3 is used, the value for row.names is:
> row.names = c("1", "2", "3")
> and the dget command then works

There was no 'R version 2.3': please see the posting guide.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From rjvbertin at gmail.com  Thu Oct 12 19:12:43 2006
From: rjvbertin at gmail.com (=?ISO-8859-1?Q?Ren=E9_J.V._Bertin?=)
Date: Thu, 12 Oct 2006 19:12:43 +0200
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <452E7095.40804@wald.ucdavis.edu>
References: <797664590610120908k3f8090d4p61a850cf6be60ccc@mail.gmail.com>
	<452E7095.40804@wald.ucdavis.edu>
Message-ID: <797664590610121012g430c58f1x91756c2437e7510d@mail.gmail.com>

Thanks, Duncan,

> It is a mixture of two things. Yes, R is not thread safe so if
> two system threads were to access R concurrently, bad things would
> happen a.s.

  That's clear, yes. :-/ And a pity, but so be it.

> It is also an issue when Python is compiled and linked with
> threaded options and routines from  the system, e.g. libpthread
> and R is not.  When R is dynamically loaded into the Python
> process, unless R is very carefully compiled, symbols (i.e. routines)

I built Python with --enable-threads, but I don't think R has a build
option for this?

> that R uses will come from the Python executable and these may not
> agree with R's view at compilation. And bad things happen.

  But that would also happen in single-threaded applications, and it
doesn't. Unless I'm understanding you wrong...

> This depends on your operating system, and it doesn't appear that
> you have told us what that is. Bad boy :-)

  Indeed it depends on the OS. Read again. It says (somewhere...) that
I'm using Mac Os X 10.4.8 :P . And under that OS, symbols are not
visible by default across shared libraries.

> This is an issue with Rpy, RSPython, RSPerl, R apache module, rJava, .......

Rpy only allows the creation of a single R "instance". Suppose it were
possible, it probably wouldn't help to create as many instances as
there are to be threads, right? The "memory not mapped" error message
suggests one thread tries to access memory that was just freed by
another thread. A bit surprising maybe that this happens in a function
that appears to be intended to be recursive (judging from the
traceback). As far as I understand, thread-safe means re-entrant which
means recursive-safe too...

...

> e.g. make it extensible at the native level.  For stat. computing
> to continue to grow and for all of us to be able to explore newer
> areas, we probably need to think about building infrastructure for the
> next 5- 10 years and not continue to tweak a model that has been around
> for 30 years.  How we do this requires some serious thought

  I can't agree more, but have no suggestions....

> and evaluating trade-offs of building things ourselves with a small
> community or leveraging other existing or emerging systems, e.g. Python,
> Perl6/Parrot, etc.

  Well, Python is great, numpy and scipy allow one to do serious work,
but there are things in which R has a clear advantage. Just to name
some: handling of missing values is one (and the reason I'm not using
numpy or scipy's var function). Slicing is another (somewhat
cumbersome in Python), data.frames yet another. I'm not sure how easy
it would be to extend Python's syntax to accomodate for something
useful as

a[ is.na(a) ] <- -1

R.B.



From rcheng at purdue.edu  Thu Oct 12 19:45:24 2006
From: rcheng at purdue.edu (rcheng at purdue.edu)
Date: Thu, 12 Oct 2006 19:45:24 +0200 (CEST)
Subject: [Rd] data.frame within a function (PR#9294)
Message-ID: <20061012174524.9270B4C916@slim.kubism.ku.dk>

Full_Name: Riyan Cheng
Version: windows 2.0.1
OS: windows xp
Submission from: (NULL) (74.140.105.186)



If one runs the following function ff(), an error would occur regarding
data.frame():
  ff<- function(){
     x<- rnorm(10)
     y<- rnorm(10)
     lm1<- lm(y~1,data=data.frame(y=y,x=x)); cat("ok\n")
     update(lm1,~ .+x,evaluate=T); cat("also ok\n")
     add1(lm1, ~ .+x);  cat("again ok\n")
  }
  ff()
But if there are external variables y and x, one would not get correct results.
This problem does not exist if one directly runs the body of the function:
  x<- rnorm(10)
  y<- rnorm(10)
  lm1<- lm(y~1,data=data.frame(y=y,x=x)); cat("ok\n")
  update(lm1,~ .+x,evaluate=T); cat("also ok\n")
  add1(lm1, ~ .+x);  cat("again ok\n")

There is exactly the same problem in Unix version.



From murdoch at stats.uwo.ca  Thu Oct 12 19:54:09 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 12 Oct 2006 13:54:09 -0400
Subject: [Rd] data.frame within a function (PR#9294)
In-Reply-To: <20061012174524.9270B4C916@slim.kubism.ku.dk>
References: <20061012174524.9270B4C916@slim.kubism.ku.dk>
Message-ID: <452E8141.5010400@stats.uwo.ca>

On 10/12/2006 1:45 PM, rcheng at purdue.edu wrote:
> Full_Name: Riyan Cheng
> Version: windows 2.0.1

This version is really quite ancient.  The current release is 2.4.0.

> OS: windows xp
> Submission from: (NULL) (74.140.105.186)
> 
> 
> 
> If one runs the following function ff(), an error would occur regarding
> data.frame():
>   ff<- function(){
>      x<- rnorm(10)
>      y<- rnorm(10)
>      lm1<- lm(y~1,data=data.frame(y=y,x=x)); cat("ok\n")
>      update(lm1,~ .+x,evaluate=T); cat("also ok\n")
>      add1(lm1, ~ .+x);  cat("again ok\n")
>   }
>   ff()
> But if there are external variables y and x, one would not get correct results.

If the problem still exists, then please say what the results are that 
you get, and why you think they are not correct.

Duncan Murdoch

> This problem does not exist if one directly runs the body of the function:
>   x<- rnorm(10)
>   y<- rnorm(10)
>   lm1<- lm(y~1,data=data.frame(y=y,x=x)); cat("ok\n")
>   update(lm1,~ .+x,evaluate=T); cat("also ok\n")
>   add1(lm1, ~ .+x);  cat("again ok\n")
> 
> There is exactly the same problem in Unix version.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From p.smith at auckland.ac.nz  Thu Oct 12 21:49:53 2006
From: p.smith at auckland.ac.nz (Smith, Peter)
Date: Fri, 13 Oct 2006 08:49:53 +1300
Subject: [Rd] Installation fails on FreeBSD (PR#9293)
References: <20061012114621.16FF549FE2@slim.kubism.ku.dk>
	<x28xjl903v.fsf@viggo.kubism.ku.dk>
Message-ID: <1E11F4042C05ED4BAA6BA96319DA5661A84ACC@comxchg1.com.auckland.ac.nz>

Hi Peter,
 
Okay, I've now fixed the problem.
 
My /tmp directory was mounted with noexec -- so the configuration script couldn't run.
 
>From a security point of view, it is always a dilemma if 'executables' should be allowed to run in /tmp -- it's a favourite point for attacks.
 
Anyway, I temporarily removed noexec, did the install and then put it back again.
 
Kind regards
Peter

________________________________

From: pd at pubhealth.ku.dk on behalf of Peter Dalgaard
Sent: Fri 13/10/06 1:42
To: p.smith at auckland.ac.nz
Cc: r-devel at stat.math.ethz.ch; R-bugs at biostat.ku.dk
Subject: Re: [Rd] Installation fails on FreeBSD (PR#9293)



p.smith at auckland.ac.nz writes:

> Full_Name: Peter Smith
> Version: 2.3.1
> OS: FreeBSD 5.3
> Submission from: (NULL) (219.88.191.10)
>
>
> I'm installing R from the FreeBSD ports tree (i.e. running make from
> /usr/ports/math/R). During the make, the following error message is generated.
>
> <snip>
>      Formats: text html latex example
>  >>> Building/Updating help pages for package 'tcltk'
>      Formats: text html latex example
> building/updating package indices ...
> begin installing recommended package foreign
> * Installing *source* package 'foreign' ...
> eval: ./configure: Permission denied
> ERROR: configuration failed for package 'foreign'
> <snip>
>
> The problem seems to occur when the following command is executed.
>
> MAKE="make" R_LIBS= ../../../bin/R CMD INSTALL --no-lock -l "../../../library"
> foreign.tgz > foreign.ts.out 2>&1 || (cat foreign.ts.out && exit 1)
>
>
> The contents of foreign.ts.out is:
> * Installing *source* package 'foreign' ...
> eval: ./configure: Permission denied

I don't think this is a bug in R. More likely, you have a permission
problem in your setup, possibly a too restrictive umask setting. The
system is complaining that it cannot run the configure script.

[In principle, R could try and remedy such problems by overriding
system defaults. We have discussed this before and come down on the
side that if the user or the system adminstrator sets things up so
that there are things that users cannot do by default (such as running
arbitrary downloaded scripts), then it is not our business to fix it
behind their backs.]

> ERROR: configuration failed for package 'foreign'
> ** Removing '/usr/ports/math/R/work/R-2.3.1/library/foreign



--
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From Soren.Hojsgaard at agrsci.dk  Thu Oct 12 22:44:18 2006
From: Soren.Hojsgaard at agrsci.dk (=?iso-8859-1?Q?S=F8ren_H=F8jsgaard?=)
Date: Thu, 12 Oct 2006 22:44:18 +0200
Subject: [Rd] Should NA's in summary() output always be reported???
Message-ID: <C83C5E3DEEE97E498B74729A33F6EAEC0387846F@DJFPOST01.djf.agrsci.dk>

Consider
> summary(1:5)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1         2         3          3          4        5 
> summary(c(1:5,NA))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
      1         2         3          3          4         5       1 

Wouldn't it be more stringent if "NA's" was also reported in the first case??
Regards
S?ren



From falimadhi at iq.harvard.edu  Fri Oct 13 00:08:19 2006
From: falimadhi at iq.harvard.edu (Ferdinand Alimadhi)
Date: Thu, 12 Oct 2006 18:08:19 -0400
Subject: [Rd] Should NA's in summary() output always be reported???
In-Reply-To: <C83C5E3DEEE97E498B74729A33F6EAEC0387846F@DJFPOST01.djf.agrsci.dk>
References: <C83C5E3DEEE97E498B74729A33F6EAEC0387846F@DJFPOST01.djf.agrsci.dk>
Message-ID: <452EBCD3.7050201@iq.harvard.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061012/efd162eb/attachment-0003.pl 

From smckinney at bccrc.ca  Fri Oct 13 01:58:16 2006
From: smckinney at bccrc.ca (Steven McKinney)
Date: Thu, 12 Oct 2006 16:58:16 -0700
Subject: [Rd] getMethods() not finding all methods
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>



Running R2.4.0 on Apple Mac OS X 10.4.8,
in Emacs ESS mode, and also R.app.


In an attempt to learn a bit more about
a particular method (geneNames in package affy)
I invoked

  getMethods("geneNames")

which produced geneNames methods, but not the
one in affy (output below).

I had to know the signature (AffyBatch) in order
to find the method

> getMethod("geneNames", "AffyBatch")

Isn't getMethods() supposed to get them all?

Is this a problem, or bug, or am I misunderstanding 
something?

I try to use getMethods() to learn how things work,
without having to always get the source code and
grep my way through the source.  Is there another
way to get all methods that I should be using?

Any info appreciated.




> library(affy)
Loading required package: Biobase
Loading required package: tools

Welcome to Bioconductor

    Vignettes contain introductory material. To view, type
    'openVignette()' or start with 'help(Biobase)'. For details
    on reading vignettes, see the openVignette help page.

Loading required package: affyio
> getMethods("geneNames")
An object of class ?MethodsList?
Slot "methods":
$ExpressionSet
Method Definition:

function (object) 
{
    .Deprecated("featureNames")
    featureNames(object)
}
<environment: namespace:Biobase>

Signatures:
        object         
target  "ExpressionSet"
defined "ExpressionSet"

$exprSet
Method Definition:

function (object) 
featureNames(object)
<environment: namespace:Biobase>

Signatures:
        object   
target  "exprSet"
defined "exprSet"


Slot "argument":
object

Slot "allMethods":
$ExpressionSet
Method Definition:

function (object) 
{
    .Deprecated("featureNames")
    featureNames(object)
}
<environment: namespace:Biobase>

Signatures:
        object         
target  "ExpressionSet"
defined "ExpressionSet"

$exprSet
Method Definition:

function (object) 
featureNames(object)
<environment: namespace:Biobase>

Signatures:
        object   
target  "exprSet"
defined "exprSet"


> search()
 [1] ".GlobalEnv"        "package:affy"      "package:affyio"    "package:Biobase"   "package:tools"     "tools:RGUI"       
 [7] "package:methods"   "package:stats"     "package:graphics"  "package:grDevices" "package:utils"     "package:datasets" 
[13] "Autoloads"         "package:base"     
> getMethod("geneNames", "AffyBatch")
Method Definition:

function (object) 
{
    cdf.envir <- getCdfInfo(object)
    return(ls(env = cdf.envir))
}

Signatures:
        object     
target  "AffyBatch"
defined "AffyBatch"
> 




Steven McKinney

Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre

email: smckinney at bccrc.ca

tel: 604-675-8000 x7561

BCCRC
Molecular Oncology
675 West 10th Ave, Floor 4
Vancouver B.C. 
V5Z 1L3
Canada



From sfalcon at fhcrc.org  Fri Oct 13 02:28:01 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Thu, 12 Oct 2006 17:28:01 -0700
Subject: [Rd] getMethods() not finding all methods
In-Reply-To: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>
	(Steven McKinney's message of "Thu, 12 Oct 2006 16:58:16 -0700")
References: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>
Message-ID: <m2wt75m54e.fsf@ziti.local>

"Steven McKinney" <smckinney at bccrc.ca> writes:

> Running R2.4.0 on Apple Mac OS X 10.4.8,
> in Emacs ESS mode, and also R.app.
>
>
> In an attempt to learn a bit more about
> a particular method (geneNames in package affy)
> I invoked
>
>   getMethods("geneNames")
>
> which produced geneNames methods, but not the
> one in affy (output below).
>
> I had to know the signature (AffyBatch) in order
> to find the method
>
>> getMethod("geneNames", "AffyBatch")
>
> Isn't getMethods() supposed to get them all?
>
> Is this a problem, or bug, or am I misunderstanding 
> something?
>
> I try to use getMethods() to learn how things work,
> without having to always get the source code and
> grep my way through the source.  Is there another
> way to get all methods that I should be using?
>
> Any info appreciated.

I think it may be a bug in getMethods.  At least, I would expect it to
show the AffyBatch method.  The output of showMethods is, IMO, more
readable and, in this case, more useful:

> library(affy)
[snip]
> showMethods("geneNames")
Function: geneNames (package Biobase)
object="AffyBatch"
object="ExpressionSet"
object="exprSet"

As an aside, geneNames is deprecated in favor of featureNames, a
somewhat more "P.C." term for the things measured on the chips :-)

Best,

+ seth



From smckinney at bccrc.ca  Fri Oct 13 03:39:06 2006
From: smckinney at bccrc.ca (Steven McKinney)
Date: Thu, 12 Oct 2006 18:39:06 -0700
Subject: [Rd] getMethods() not finding all methods
References: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>
	<m2wt75m54e.fsf@ziti.local>
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0235F920@crcmail1.BCCRC.CA>

Hi Seth,

Thanks for the info - actually one of the things
I like about getMethods is seeing the function
internals - as you point out, geneNames is being
deprecated in favour of featureNames, which is
revealed by the guts of the geneNames method ;)


> getMethods("geneNames")
An object of class ?MethodsList?
Slot "methods":
$ExpressionSet
Method Definition:

function (object)
{
    .Deprecated("featureNames")
    featureNames(object)
}
<environment: namespace:Biobase>

Signatures:
        object        
target  "ExpressionSet"
defined "ExpressionSet"




-----Original Message-----
From: r-devel-bounces at r-project.org on behalf of Seth Falcon
Sent: Thu 10/12/2006 5:28 PM
To: r-devel at stat.math.ethz.ch
Subject: Re: [Rd] getMethods() not finding all methods
 
"Steven McKinney" <smckinney at bccrc.ca> writes:

> Running R2.4.0 on Apple Mac OS X 10.4.8,
> in Emacs ESS mode, and also R.app.
>
>
> In an attempt to learn a bit more about
> a particular method (geneNames in package affy)
> I invoked
>
>   getMethods("geneNames")
>
> which produced geneNames methods, but not the
> one in affy (output below).
>
> I had to know the signature (AffyBatch) in order
> to find the method
>
>> getMethod("geneNames", "AffyBatch")
>
> Isn't getMethods() supposed to get them all?
>
> Is this a problem, or bug, or am I misunderstanding 
> something?
>
> I try to use getMethods() to learn how things work,
> without having to always get the source code and
> grep my way through the source.  Is there another
> way to get all methods that I should be using?
>
> Any info appreciated.

I think it may be a bug in getMethods.  At least, I would expect it to
show the AffyBatch method.  The output of showMethods is, IMO, more
readable and, in this case, more useful:

> library(affy)
[snip]
> showMethods("geneNames")
Function: geneNames (package Biobase)
object="AffyBatch"
object="ExpressionSet"
object="exprSet"

As an aside, geneNames is deprecated in favor of featureNames, a
somewhat more "P.C." term for the things measured on the chips :-)

Best,

+ seth

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel



From jmc at r-project.org  Fri Oct 13 14:51:09 2006
From: jmc at r-project.org (John Chambers)
Date: Fri, 13 Oct 2006 08:51:09 -0400
Subject: [Rd] getMethods() not finding all methods
In-Reply-To: <0BE438149FF2254DB4199E2682C8DFEB0235F920@crcmail1.BCCRC.CA>
References: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>
	<m2wt75m54e.fsf@ziti.local>
	<0BE438149FF2254DB4199E2682C8DFEB0235F920@crcmail1.BCCRC.CA>
Message-ID: <452F8BBD.3020401@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061013/5ae3af07/attachment-0003.pl 

From sfalcon at fhcrc.org  Fri Oct 13 16:27:13 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Fri, 13 Oct 2006 07:27:13 -0700
Subject: [Rd] getMethods() not finding all methods
In-Reply-To: <452F8BBD.3020401@r-project.org> (John Chambers's message of "Fri,
	13 Oct 2006 08:51:09 -0400")
References: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>
	<m2wt75m54e.fsf@ziti.local>
	<0BE438149FF2254DB4199E2682C8DFEB0235F920@crcmail1.BCCRC.CA>
	<452F8BBD.3020401@r-project.org>
Message-ID: <m2lknkl29q.fsf@ziti.local>

John Chambers <jmc at r-project.org> writes:
> Yes, that's why showMethods() has the option includeDefs=TRUE to
> include the definitions.  There are other options to look at multiple
> functions or specific classes.  Look at ?showMethods

A feature request: it would be useful in the context of attempting to
build documentation helper tools to have a return value that was
more structured than what printTo=FALSE provides.

> And no, it's not a bug in getMethods(), which was never intended for
> human-readable output, but a side-effect of the changes for faster
> caching and dispatch in 2.4.0.  With the use of environments in place
> of the methods list objects (returned by getMethods()), getMethods()
> will probably be deprecated in the next version.

I was expecting a different result based on the first sentence in the
doc describing getMethods:

     The function 'getMethods' returns all the methods for a particular
     generic (in the form of a generic function with the methods
     information in its environment).

Hence, it surprises me that not all methods are returned.  Reading on
I now see:

     ... is not intended to be called directly.

So I guess I got what I deserve ;-)

+ seth



From jmc at r-project.org  Fri Oct 13 17:29:43 2006
From: jmc at r-project.org (John Chambers)
Date: Fri, 13 Oct 2006 11:29:43 -0400
Subject: [Rd] getMethods() not finding all methods
In-Reply-To: <m2lknkl29q.fsf@ziti.local>
References: <0BE438149FF2254DB4199E2682C8DFEB01D555DF@crcmail1.BCCRC.CA>
	<m2wt75m54e.fsf@ziti.local>
	<0BE438149FF2254DB4199E2682C8DFEB0235F920@crcmail1.BCCRC.CA>
	<452F8BBD.3020401@r-project.org> <m2lknkl29q.fsf@ziti.local>
Message-ID: <452FB0E7.8010204@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061013/ec794743/attachment-0003.pl 

From Robert.McGehee at geodecapital.com  Fri Oct 13 20:44:33 2006
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Fri, 13 Oct 2006 14:44:33 -0400
Subject: [Rd] Installing Rmpi on 64-bit Linux Athlon
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C94693C@MSGBOSCLB2WIN.DMN1.FMR.COM>

Many thanks for help on this. Using Hin-Tak's (offline) suggestion, I
was able to get Rmpi to compile on R 2.4.0 by manually linking the
offending code using a different shared library (which didn't seem to be
picked up with any of the command-line arguments), and then
re-installing the usual way.

setenv LDFLAGS "-L$prefix/lib -L$prefix/lib64"
R CMD INSTALL ~/code/Rmpi --configure-args="--with-mpi=$prefix
--prefix=$prefix CC=mpicc" -l $R_LIBS
cd ~/code/Rmpi/src
gcc -shared -L$prefix/lib -o Rmpi.so RegQuery.o Rmpi.o conversion.o
internal.o -lmpi -llam -lutil -lpthread   
R CMD INSTALL ~/code/Rmpi --configure-args="--with-mpi=$prefix CC=mpicc"
-l $R_LIBS

Once the package was installed, I quickly found out that Rmpi simply
does not work under R 2.4.0 (for me at least), partly because of a
change in the serialize function in R 2.4.0 (affecting bin.nchar()), and
partly for reasons I haven't been able to figure out. (Looks like a
failure in the mpi_allgather function in Rmpi.c, but am not sure). So
for now, I'm retaining R 2.3.1 for parallel processing work.

If anyone succeeds in compiling Rmpi on 2.4.0, please pass along any
necessary changes to the package maintainer.
Best,
Robert

-----Original Message-----
From: Hin-Tak Leung [mailto:hin-tak.leung at cimr.cam.ac.uk] 
Sent: Tuesday, October 10, 2006 6:10 AM
To: c.farrow at compserv.gla.ac.uk
Cc: McGehee, Robert; r-devel at stat.math.ethz.ch
Subject: Re: [Rd] Installing Rmpi on 64-bit Linux Athlon

No, both of you are not doing it correctly - you are confused about 
linker problem with runtime issue. LD_LIBRARY_PATH is a runtime
flag. You want to set the linker flag to influence the linker behavior:

setenv LDFLAGS="-L$prefix/lib -L$prefix/lib64"

or edit the makefile or Makevars do the equivalent with PKG_LDFLAGS
in the Rmpi package.

BTW, the syntax for using LD_LIBRARY_PATH is also wrong - to use it the 
way it is intended, you need:

setenv LD_LIBRARY_PATH "$prefix/lib:$prefix/lib64"

c.farrow at compserv.gla.ac.uk wrote:
> Hi,
> 
> I think you need to reverse the order of the first two lines as
> currently you are using $prefix before it is defined.
> 
> setenv prefix "/home/a347549/local64"
> setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"
> 
> 
> colin.
> 
> 
> On  9 Oct, McGehee, Robert wrote:
>> Hello,
>> We have recently added a 64-bit 2 x Dual-Core Athlon server running
Red
>> Hat Enterprise Linux AS release 3 to allow for processing of large
data
>> sets (>4GB) in R. To integrate this server into our Linux cluster, I
>> have been trying (unsuccessfully) to use Rmpi/lam-mpi to parallel
>> process some of our scripts. While I have successfully compiled R
2.4.0
>> and lam-mpi 7.1.2 on this server using a 64-bit architecture, I have
not
>> been able to install Rmpi to interface with lam-mpi, despite success
on
>> nearly identical servers in a 32-bit architecture. When trying on the
>> 64-bit server, I receive the error "cannot find -lmpi" during
>> compilation (see below). 
>>
>> If anyone has had success in this regards and notice an installation
>> problem that I may have overlooked, I would greatly appreciate any
>> advice. Note that because I do not have root access, all of the
lam-mpi
>> and R files were installed locally.
>>
>> Thanks in advance,
>> Robert
>>
>> ### Below is configuration scripts for R, Lam-MPI and Rmpi:
>>
>> setenv LD_LIBRARY_PATH "-L$prefix/lib -L$prefix/lib64"
>> setenv prefix "/home/a347549/local64"
>>
>> ### R 2.4.0 Configure
>> ./configure --prefix=$prefix --with-x
>> --with-tcl-config="$prefix/lib/tclConfig.sh"
>> --with-tk-config="$prefix/lib/tkConfig.sh"
>> --with-blas="-L$builddir/ATLAS/lib/Linux_HAMMER64SSE2_4 -lptf77blas
>> -lpthread -latlas"
>>
>> ### Lam-MPI 7.1.2 Configure:
>> ./configure --prefix=$prefix --enable-shared --disable-static
>> --without-romio --with-rsh="ssh -xq"
>>
>> ### Rmpi INSTALL
>> R CMD INSTALL Rmpi --configure-args="--with-mpi=$prefix
--prefix=$prefix
>> CC=mpicc" -l $R_LIBS
>>
>> * Installing *source* package 'Rmpi' ...
>> Try to find mpi.h ...
>> Found in /gcm/home/a347549/local64/include
>> Try to find libmpi or libmpich ...
>> checking for main in -lmpi... yes
>> Try to find liblam ...
>> checking for main in -llam... yes
>> checking for openpty in -lutil... yes
>> checking for main in -lpthread... yes
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> ** libs
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c RegQuery.c -o
>> RegQuery.o
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c Rmpi.c -o Rmpi.o
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c conversion.c -o
>> conversion.o
>> gcc -I/gcm/home/a347549/local64/lib64/R/include
>> -I/gcm/home/a347549/local64/lib64/R/include -DPACKAGE_NAME=\"\"
>> -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\"
>> -DPACKAGE_BUGREPORT=\"\"  -I/gcm/home/a347549/local64/include -DMPI2
>> -I/usr/local/include    -fpic  -g -O2 -std=gnu99 -c internal.c -o
>> internal.o
>> gcc -shared -L/usr/local/lib64 -o Rmpi.so RegQuery.o Rmpi.o
conversion.o
>> internal.o -lmpi -llam -lutil -lpthread   
>> /usr/bin/ld: cannot find -lmpi
>> collect2: ld returned 1 exit status
>> make: *** [Rmpi.so] Error 1
>> chmod: cannot access `/home/a347549/code/rlib64/Rmpi/libs/*': No such
>> file or directory
>> ERROR: compilation failed for package 'Rmpi'
>> ** Removing '/home/a347549/code/rlib64/Rmpi'
>> [lwtc5.fmr.com/A347549] /home/a347549/code
>>
>>
>> ############################################################
>> In addition, here is the output of Rmpi's config.log
>> ############################################################
>>
>>> cat config.log
>> This file contains any messages produced by compilers while
>> running configure, to aid debugging if configure makes a mistake.
>>
>> It was created by configure, which was
>> generated by GNU Autoconf 2.59.  Invocation command line was
>>
>>   $ ./configure --with-mpi=/gcm/home/a347549/local64
>> --prefix=/gcm/home/a347549/local64 CC=mpicc
>>
>> ## --------- ##
>> ## Platform. ##
>> ## --------- ##
>>
>> hostname = lwtc5.fmr.com
>> uname -m = x86_64
>> uname -r = 2.6.9-34.0.1.ELsmp
>> uname -s = Linux
>> uname -v = #1 SMP Wed May 17 16:59:36 EDT 2006
>>
>> /usr/bin/uname -p = unknown
>> /bin/uname -X     = unknown
>>
>> /bin/arch              = x86_64
>> /usr/bin/arch -k       = unknown
>> /usr/convex/getsysinfo = unknown
>> hostinfo               = unknown
>> /bin/machine           = unknown
>> /usr/bin/oslevel       = unknown
>> /bin/universe          = unknown
>>
>> PATH: /home/a347549/local64/java/bin
>> PATH: /home/a347549/local64/tibrv/bin
>> PATH: /home/a347549/local64/ant/bin
>> PATH: /home/a347549/local64/bin
>> PATH: /usr/bin/X11
>> PATH: /home/a347549/bin
>> PATH: /home/a347549/local64/java/bin
>> PATH: /home/a347549/local64/tibrv/bin
>> PATH: /home/a347549/local64/ant/bin
>> PATH: /home/a347549/local64/bin
>> PATH: /usr/bin/X11
>> PATH: /home/a347549/bin
>> PATH: /usr/kerberos/bin
>> PATH: /usr/local/bin
>> PATH: /bin
>> PATH: /usr/bin
>> PATH: /usr/X11R6/bin
>> PATH: .
>> PATH: .
>>
>>
>> ## ----------- ##
>> ## Core tests. ##
>> ## ----------- ##
>>
>> configure:2944: checking for main in -lmpi
>> configure:2968: mpicc -o conftest    conftest.c -lmpi   >&5
>> configure:2974: $? = 0
>> configure:2978: test -z 
>> 			 || test ! -s conftest.err
>> configure:2981: $? = 0
>> configure:2984: test -s conftest
>> configure:2987: $? = 0
>> configure:3000: result: yes
>> configure:3018: checking for main in -llam
>> configure:3042: mpicc -o conftest    conftest.c -llam   >&5
>> configure:3048: $? = 0
>> configure:3052: test -z 
>> 			 || test ! -s conftest.err
>> configure:3055: $? = 0
>> configure:3058: test -s conftest
>> configure:3061: $? = 0
>> configure:3074: result: yes
>> configure:3086: checking for openpty in -lutil
>> configure:3116: mpicc -o conftest    conftest.c -lutil   >&5
>> configure:3122: $? = 0
>> configure:3126: test -z 
>> 			 || test ! -s conftest.err
>> configure:3129: $? = 0
>> configure:3132: test -s conftest
>> configure:3135: $? = 0
>> configure:3148: result: yes
>> configure:3154: checking for main in -lpthread
>> configure:3178: mpicc -o conftest    conftest.c -lpthread   >&5
>> configure:3184: $? = 0
>> configure:3188: test -z 
>> 			 || test ! -s conftest.err
>> configure:3191: $? = 0
>> configure:3194: test -s conftest
>> configure:3197: $? = 0
>> configure:3210: result: yes
>> configure:3352: creating ./config.status
>>
>> ## ---------------------- ##
>> ## Running config.status. ##
>> ## ---------------------- ##
>>
>> This file was extended by config.status, which was
>> generated by GNU Autoconf 2.59.  Invocation command line was
>>
>>   CONFIG_FILES    = 
>>   CONFIG_HEADERS  = 
>>   CONFIG_LINKS    = 
>>   CONFIG_COMMANDS = 
>>   $ ./config.status 
>>
>> on lwtc5.fmr.com
>>
>> config.status:635: creating src/Makevars
>>
>> ## ---------------- ##
>> ## Cache variables. ##
>> ## ---------------- ##
>>
>> ac_cv_env_CC_set=set
>> ac_cv_env_CC_value=mpicc
>> ac_cv_env_CFLAGS_set=
>> ac_cv_env_CFLAGS_value=
>> ac_cv_env_CPPFLAGS_set=
>> ac_cv_env_CPPFLAGS_value=
>> ac_cv_env_CPP_set=
>> ac_cv_env_CPP_value=
>> ac_cv_env_LDFLAGS_set=
>> ac_cv_env_LDFLAGS_value=
>> ac_cv_env_build_alias_set=
>> ac_cv_env_build_alias_value=
>> ac_cv_env_host_alias_set=
>> ac_cv_env_host_alias_value=
>> ac_cv_env_target_alias_set=
>> ac_cv_env_target_alias_value=
>> ac_cv_lib_lam_main=yes
>> ac_cv_lib_mpi_main=yes
>> ac_cv_lib_pthread_main=yes
>> ac_cv_lib_util_openpty=yes
>>
>> ## ----------------- ##
>> ## Output variables. ##
>> ## ----------------- ##
>>
>> CC='mpicc'
>> CFLAGS=''
>> CPP=''
>> CPPFLAGS=''
>> DEFS='-DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\"
-DPACKAGE_VERSION=\"\"
>> -DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" '
>> ECHO_C=''
>> ECHO_N='-n'
>> ECHO_T=''
>> EGREP='grep -E'
>> EXEEXT=''
>> LDFLAGS=''
>> LIBOBJS=''
>> LIBS=''
>> LTLIBOBJS=''
>> OBJEXT=''
>> PACKAGE_BUGREPORT=''
>> PACKAGE_NAME=''
>> PACKAGE_STRING=''
>> PACKAGE_TARNAME=''
>> PACKAGE_VERSION=''
>> PATH_SEPARATOR=':'
>> PKG_CPPFLAGS='-I/gcm/home/a347549/local64/include -DMPI2'
>> PKG_LIBS='-lmpi -llam -lutil -lpthread'
>> SHELL='/bin/sh'
>> ac_ct_CC=''
>> bindir='${exec_prefix}/bin'
>> build_alias=''
>> datadir='${prefix}/share'
>> exec_prefix='${prefix}'
>> host_alias=''
>> includedir='${prefix}/include'
>> infodir='${prefix}/info'
>> libdir='${exec_prefix}/lib'
>> libexecdir='${exec_prefix}/libexec'
>> localstatedir='${prefix}/var'
>> mandir='${prefix}/man'
>> oldincludedir='/usr/include'
>> prefix='/gcm/home/a347549/local64'
>> program_transform_name='s,x,x,'
>> sbindir='${exec_prefix}/sbin'
>> sharedstatedir='${prefix}/com'
>> sysconfdir='${prefix}/etc'
>> target_alias=''
>>
>> ## ----------- ##
>> ## confdefs.h. ##
>> ## ----------- ##
>>
>> #define PACKAGE_BUGREPORT ""
>> #define PACKAGE_NAME ""
>> #define PACKAGE_STRING ""
>> #define PACKAGE_TARNAME ""
>> #define PACKAGE_VERSION ""
>>
>> configure: exit 0
>>
>>
>>
>> Robert McGehee
>> Quantitative Analyst
>> Geode Capital Management, LLC
>> 53 State Street, 5th Floor | Boston, MA | 02109
>> Tel: 617/392-8396    Fax:617/476-6389
>> mailto:robert.mcgehee at geodecapital.com
>>
>>
>>
>> This e-mail, and any attachments hereto, are intended for
us...{{dropped}}
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From watplatt at us.ibm.com  Fri Oct 13 21:43:13 2006
From: watplatt at us.ibm.com (watplatt at us.ibm.com)
Date: Fri, 13 Oct 2006 21:43:13 +0200 (CEST)
Subject: [Rd] Unable to build (PR#9295)
Message-ID: <20061013194313.2A2FD4C89A@slim.kubism.ku.dk>

Full_Name: Daniel E. Platt
Version: 2.4.0
OS: AIX 5.3
Submission from: (NULL) (129.34.20.23)


Did a new build of gcc c,c++,gfortran v4.1.1, (re)built R 2.3.1 using
config.site as spec'd in R-admin.pdf in sec C.9 as described by Jagat Sheth,
with addition of FC=gfortran (configure tried using f95, which is present on the
system, but won't bind with gcc's obj files).

Applying the same to 4.1.1 produces the following:

make[4]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library/tools/src'
Error in dyn.load(x, as.logical(local), as.logical(now)) : 
        unable to load shared library
'/geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so':
  rtld: 0712-001 Symbol TYPEOF was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol Rf_error was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol Rf_asLogical was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol LENGTH was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol STRING_ELT was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), bu
Execution halted
make[3]: *** [all] Error 1
make[3]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library/tools'
make[2]: *** [R] Error 1
make[2]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src'
make: *** [R] Error 1

Are there undefined #define's leaking in as code?

Dan



From russell-lenth at uiowa.edu  Fri Oct 13 23:29:18 2006
From: russell-lenth at uiowa.edu (russell-lenth at uiowa.edu)
Date: Fri, 13 Oct 2006 23:29:18 +0200 (CEST)
Subject: [Rd] No exit codes from RTerm (Windows) (PR#9296)
Message-ID: <20061013212918.267F54C916@slim.kubism.ku.dk>

Full_Name: Russell V. Lenth
Version: 2.3.1
OS: Windows XP Pro
Submission from: (NULL) (128.255.132.188)


I wrote a simple .BAT file to run the Sweave function on a file (via RTerm),
then run pdflatex on the result (after RTerm exits).  The issue is that if an
error condition occurs in RTerm, it is prudent to not do the pdflatex processing
afterward.  

Here are the relevant statements in the BAT script:

    echo Sweave("%1",style=F,eps=F) | Rterm --no-save --no-restore
    if not errorlevel == 0 goto end

The problem is that the errorlevel seems to always be 0, even if an error
occurs.  I have a similar shell script for our linux system, and it works
correctly.  Are there no provisions for RTerm to return an exit code in Windows?
 It would be very useful to me if it would return a nonzero exit code when there
is an error.



From ggrothendieck at gmail.com  Fri Oct 13 23:40:19 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 13 Oct 2006 17:40:19 -0400
Subject: [Rd] No exit codes from RTerm (Windows) (PR#9296)
In-Reply-To: <20061013212918.267F54C916@slim.kubism.ku.dk>
References: <20061013212918.267F54C916@slim.kubism.ku.dk>
Message-ID: <971536df0610131440h568dce8didf64c992ebe17190@mail.gmail.com>

I have an XP batch file that runs sweave and figures out whether to proceed
by comparing the file dates on the .Rnw and .tex files (and also on the
.tex and .pdf files).   It will be included in the next version of the
batchfiles project:
    http://cran.r-project.org/contrib/extra/batchfiles/
hopefully to be released this weekend or shortly.  I will contact you
offline if in case you would like to test it.


On 10/13/06, russell-lenth at uiowa.edu <russell-lenth at uiowa.edu> wrote:
> Full_Name: Russell V. Lenth
> Version: 2.3.1
> OS: Windows XP Pro
> Submission from: (NULL) (128.255.132.188)
>
>
> I wrote a simple .BAT file to run the Sweave function on a file (via RTerm),
> then run pdflatex on the result (after RTerm exits).  The issue is that if an
> error condition occurs in RTerm, it is prudent to not do the pdflatex processing
> afterward.
>
> Here are the relevant statements in the BAT script:
>
>    echo Sweave("%1",style=F,eps=F) | Rterm --no-save --no-restore
>    if not errorlevel == 0 goto end
>
> The problem is that the errorlevel seems to always be 0, even if an error
> occurs.  I have a similar shell script for our linux system, and it works
> correctly.  Are there no provisions for RTerm to return an exit code in Windows?
>  It would be very useful to me if it would return a nonzero exit code when there
> is an error.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From ripley at stats.ox.ac.uk  Sat Oct 14 10:39:19 2006
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Sat, 14 Oct 2006 10:39:19 +0200 (CEST)
Subject: [Rd] No exit codes from RTerm (Windows) (PR#9296)
Message-ID: <20061014083919.0800B4C915@slim.kubism.ku.dk>

Rterm (sic) does return an error status.  You have not provided a 
reproducible example, so here is one (done in tcsh)

% echo 'q()' | rterm --vanilla --slave || echo failed
% echo 'q(status=3)' | rterm --vanilla --slave || echo failed
failed
% echo 'stop("test")' | rterm --vanilla --slave || echo failed
Error: test
Execution halted
failed

Whatever the problem is in your case, it is not what you have erroneously 
reported as a bug.  (BTW, I knew this worked as the R scripts, including 
the build process, make heavy use of it.)

On Fri, 13 Oct 2006, russell-lenth at uiowa.edu wrote:

> Full_Name: Russell V. Lenth
> Version: 2.3.1

Not current: see the FAQ which asks you not to report on obselete versions 
of R.

> OS: Windows XP Pro
> Submission from: (NULL) (128.255.132.188)
>
>
> I wrote a simple .BAT file to run the Sweave function on a file (via RTerm),
> then run pdflatex on the result (after RTerm exits).  The issue is that if an
> error condition occurs in RTerm, it is prudent to not do the pdflatex processing
> afterward.
>
> Here are the relevant statements in the BAT script:
>
>    echo Sweave("%1",style=F,eps=F) | Rterm --no-save --no-restore
>    if not errorlevel == 0 goto end
>
> The problem is that the errorlevel seems to always be 0, even if an error
> occurs.  I have a similar shell script for our linux system, and it works
> correctly.  Are there no provisions for RTerm to return an exit code in Windows?
> It would be very useful to me if it would return a nonzero exit code when there
> is an error.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From din.chen at sdstate.edu  Sat Oct 14 15:28:02 2006
From: din.chen at sdstate.edu (din.chen at sdstate.edu)
Date: Sat, 14 Oct 2006 15:28:02 +0200 (CEST)
Subject: [Rd] error in lme4 for R 2.4.0 (PR#9297)
Message-ID: <20061014132802.57581CBEA@slim.kubism.ku.dk>

Full_Name: Din Chen
Version: 2.4.0
OS: Windows XP
Submission from: (NULL) (66.17.122.18)


I just updated the R.2.4.0. and got the error message for random effect
modelling, which was working on R.2.3.1.

library(lme4)
mmod <- lmer(bright ~ 1+(1|operator), pulp)
summary(mmod)

Then when I tried to extract the residuals and random effect using:
resid(mmodr)
ranef(mmodr)

I got error message:

Error in resid(mmod) : no slot of name "family" for this object of class "lmer"



From russell-lenth at uiowa.edu  Sat Oct 14 19:56:05 2006
From: russell-lenth at uiowa.edu (russell-lenth at uiowa.edu)
Date: Sat, 14 Oct 2006 19:56:05 +0200 (CEST)
Subject: [Rd] No exit codes from RTerm (Windows) (PR#9296)
Message-ID: <20061014175605.1089D3EFF7@slim.kubism.ku.dk>

I am so embarrassed.  I now see the syntax error in my original batch 
file; and if I correct it, it works just fine.  I don't know why I 
didn't get a DOS error with it; if I had, it obviously would have saved 
me from reporting it as an R bug.  My apologies for causing trouble -- 
it definitely is not a bug in R.

best,

Russ
-- 
Russell V. Lenth, Professor
Department of Statistics
   & Actuarial Science            (319)335-0814    FAX (319)335-3017
The University of Iowa           russell-lenth at uiowa.edu
Iowa City, IA 52242  USA         http://www.stat.uiowa.edu/~rlenth/

Prof Brian Ripley wrote:
> Rterm (sic) does return an error status.  You have not provided a 
> reproducible example, so here is one (done in tcsh)
> 
> % echo 'q()' | rterm --vanilla --slave || echo failed
> % echo 'q(status=3)' | rterm --vanilla --slave || echo failed
> failed
> % echo 'stop("test")' | rterm --vanilla --slave || echo failed
> Error: test
> Execution halted
> failed
> 
> Whatever the problem is in your case, it is not what you have 
> erroneously reported as a bug.  (BTW, I knew this worked as the R 
> scripts, including the build process, make heavy use of it.)
> 
> On Fri, 13 Oct 2006, russell-lenth at uiowa.edu wrote:
> 
>> Full_Name: Russell V. Lenth
>> Version: 2.3.1
> 
> 
> Not current: see the FAQ which asks you not to report on obselete 
> versions of R.
> 
>> OS: Windows XP Pro
>> Submission from: (NULL) (128.255.132.188)
>>
>>
>> I wrote a simple .BAT file to run the Sweave function on a file (via 
>> RTerm),
>> then run pdflatex on the result (after RTerm exits).  The issue is 
>> that if an
>> error condition occurs in RTerm, it is prudent to not do the pdflatex 
>> processing
>> afterward.
>>
>> Here are the relevant statements in the BAT script:
>>
>>    echo Sweave("%1",style=F,eps=F) | Rterm --no-save --no-restore
>>    if not errorlevel == 0 goto end
>>
>> The problem is that the errorlevel seems to always be 0, even if an error
>> occurs.  I have a similar shell script for our linux system, and it works
>> correctly.  Are there no provisions for RTerm to return an exit code 
>> in Windows?
>> It would be very useful to me if it would return a nonzero exit code 
>> when there
>> is an error.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>



From p.dalgaard at biostat.ku.dk  Sat Oct 14 22:14:01 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 14 Oct 2006 22:14:01 +0200
Subject: [Rd] error in lme4 for R 2.4.0 (PR#9297)
In-Reply-To: <20061014132802.57581CBEA@slim.kubism.ku.dk>
References: <20061014132802.57581CBEA@slim.kubism.ku.dk>
Message-ID: <x264emzmd2.fsf@turmalin.kubism.ku.dk>

din.chen at sdstate.edu writes:

> Full_Name: Din Chen
> Version: 2.4.0
> OS: Windows XP
> Submission from: (NULL) (66.17.122.18)
> 
> 
> I just updated the R.2.4.0. and got the error message for random effect
> modelling, which was working on R.2.3.1.
> 
> library(lme4)
> mmod <- lmer(bright ~ 1+(1|operator), pulp)
> summary(mmod)
> 
> Then when I tried to extract the residuals and random effect using:
> resid(mmodr)
> ranef(mmodr)
> 
> I got error message:
> 
> Error in resid(mmod) : no slot of name "family" for this object of class "lmer"

The convention is that bugs in contributed packages should be reported
to the maintainer, not r-bugs.

Did you reinstall the package for 2.4.0?

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From sfalcon at fhcrc.org  Sun Oct 15 20:48:45 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Sun, 15 Oct 2006 11:48:45 -0700
Subject: [Rd] Feature request: names(someEnv) same as ls(someEnv)
Message-ID: <m21wp9e7oy.fsf@ziti.local>

Hi,

I would be nice if names() returned the equivalent of ls() for
environments.

--- a/src/main/attrib.c
+++ b/src/main/attrib.c
@@ -687,6 +687,8 @@ SEXP attribute_hidden do_names(SEXP call
     s = CAR(args);
     if (isVector(s) || isList(s) || isLanguage(s))
        return getAttrib(s, R_NamesSymbol);
+    if (isEnvironment(s))
+        return R_lsInternal(s, 0);
     return R_NilValue;
 }


+ seth

--
Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
http://bioconductor.org



From murdoch at stats.uwo.ca  Sun Oct 15 21:04:14 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 15 Oct 2006 15:04:14 -0400
Subject: [Rd] Feature request: names(someEnv) same as ls(someEnv)
In-Reply-To: <m21wp9e7oy.fsf@ziti.local>
References: <m21wp9e7oy.fsf@ziti.local>
Message-ID: <4532862E.7090309@stats.uwo.ca>

On 10/15/2006 2:48 PM, Seth Falcon wrote:
> Hi,
> 
> I would be nice if names() returned the equivalent of ls() for
> environments.

Wouldn't that just confuse people into thinking that environments are 
vectors?  Wouldn't it then be reasonable to assume that 
env[[which(names(env) == "foo")]] would be a synonym for env$foo?

I don't see why this would be nice:  why not just use ls()?

Duncan Murdoch

> 
> --- a/src/main/attrib.c
> +++ b/src/main/attrib.c
> @@ -687,6 +687,8 @@ SEXP attribute_hidden do_names(SEXP call
>      s = CAR(args);
>      if (isVector(s) || isList(s) || isLanguage(s))
>         return getAttrib(s, R_NamesSymbol);
> +    if (isEnvironment(s))
> +        return R_lsInternal(s, 0);
>      return R_NilValue;
>  }
> 
> 
> + seth
> 
> --
> Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
> http://bioconductor.org
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From rgentlem at fhcrc.org  Sun Oct 15 22:15:41 2006
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Sun, 15 Oct 2006 13:15:41 -0700
Subject: [Rd] Feature request: names(someEnv) same as ls(someEnv)
In-Reply-To: <4532862E.7090309@stats.uwo.ca>
References: <m21wp9e7oy.fsf@ziti.local> <4532862E.7090309@stats.uwo.ca>
Message-ID: <453296ED.9090505@fhcrc.org>



Duncan Murdoch wrote:
> On 10/15/2006 2:48 PM, Seth Falcon wrote:
>> Hi,
>>
>> I would be nice if names() returned the equivalent of ls() for
>> environments.
> 
> Wouldn't that just confuse people into thinking that environments are 
> vectors?  Wouldn't it then be reasonable to assume that 
> env[[which(names(env) == "foo")]] would be a synonym for env$foo?

  absolutely not - environments can only be subscripted by name, not by 
logicals or integer subscripts - so I hope that most users would figure 
that one out


> 
> I don't see why this would be nice:  why not just use ls()?

   why? environments do get used, by many as vectors (well hash tables), 
modulo the restrictions on subscripting and the analogy is quite useful 
and should be encouraged IMHO.

  Robert

> 
> Duncan Murdoch
> 
>> --- a/src/main/attrib.c
>> +++ b/src/main/attrib.c
>> @@ -687,6 +687,8 @@ SEXP attribute_hidden do_names(SEXP call
>>      s = CAR(args);
>>      if (isVector(s) || isList(s) || isLanguage(s))
>>         return getAttrib(s, R_NamesSymbol);
>> +    if (isEnvironment(s))
>> +        return R_lsInternal(s, 0);
>>      return R_NilValue;
>>  }
>>
>>
>> + seth
>>
>> --
>> Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
>> http://bioconductor.org
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org



From murdoch at stats.uwo.ca  Sun Oct 15 22:45:15 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 15 Oct 2006 16:45:15 -0400
Subject: [Rd] Feature request: names(someEnv) same as ls(someEnv)
In-Reply-To: <453296ED.9090505@fhcrc.org>
References: <m21wp9e7oy.fsf@ziti.local> <4532862E.7090309@stats.uwo.ca>
	<453296ED.9090505@fhcrc.org>
Message-ID: <45329DDB.5000600@stats.uwo.ca>

On 10/15/2006 4:15 PM, Robert Gentleman wrote:
> 
> Duncan Murdoch wrote:
>> On 10/15/2006 2:48 PM, Seth Falcon wrote:
>>> Hi,
>>>
>>> I would be nice if names() returned the equivalent of ls() for
>>> environments.
>> Wouldn't that just confuse people into thinking that environments are 
>> vectors?  Wouldn't it then be reasonable to assume that 
>> env[[which(names(env) == "foo")]] would be a synonym for env$foo?
> 
>   absolutely not - environments can only be subscripted by name, not by 
> logicals or integer subscripts - so I hope that most users would figure 
> that one out
> 
> 
>> I don't see why this would be nice:  why not just use ls()?
> 
>    why? environments do get used, by many as vectors (well hash tables), 
> modulo the restrictions on subscripting and the analogy is quite useful 
> and should be encouraged IMHO.

I think there's an important difference between a hash table and a 
vector.  Order matters in a vector.  Right now, if "foo" is the third 
name, then x$foo is the third element, but that's not true in an 
environment, where "third element" just doesn't make sense.

It will also be strange that you can ask to see the names, but you can't 
set them (unless you also want to also extend "names<-" to work on 
environments).

If you do go ahead with this change, I'd suggest implementing it as a 
new method

  names.environment <- function(x) ls(x)

rather than doing it at the C level.  At least then it will be 
consistent with the man page.

Duncan Murdoch

> 
>   Robert
> 
>> Duncan Murdoch
>>
>>> --- a/src/main/attrib.c
>>> +++ b/src/main/attrib.c
>>> @@ -687,6 +687,8 @@ SEXP attribute_hidden do_names(SEXP call
>>>      s = CAR(args);
>>>      if (isVector(s) || isList(s) || isLanguage(s))
>>>         return getAttrib(s, R_NamesSymbol);
>>> +    if (isEnvironment(s))
>>> +        return R_lsInternal(s, 0);
>>>      return R_NilValue;
>>>  }
>>>
>>>
>>> + seth
>>>
>>> --
>>> Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
>>> http://bioconductor.org
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>



From bates at stat.wisc.edu  Mon Oct 16 16:25:31 2006
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon, 16 Oct 2006 09:25:31 -0500
Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4
Message-ID: <40e66e0b0610160725y1afbaa56v906ac6efc595ae26@mail.gmail.com>

I am encountering segfaults when checking the lme4 package on an
Athlon64 system if I use the acml blas.  R was built as a 64-bit
application using the GCC 4.0.3 compiler suite including gfortran.
The version of acml is 3.5.0 gfortran64.

I do not encounter the segfaults when I compile R with R's built-in
BLAS.  The errors occur in the first example in lme4 in a call to
lmer. It looks like they would occur in any call to lmer.  Running
under the debugger shows that the segfault occurs in a call to dtrsm
(a level-3 BLAS routine to solve a triangular system of equations)
that is called from within a cholmod (sparse matrix library) routine.

Has anyone succeeded in running R CMD check on the lme4 package with
accelerated BLAS?  I'm trying to pin down is this occurs only with
ACML or also with Atlas and/or Goto's BLAS.



From Robert.McGehee at geodecapital.com  Mon Oct 16 17:00:06 2006
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Mon, 16 Oct 2006 11:00:06 -0400
Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C946941@MSGBOSCLB2WIN.DMN1.FMR.COM>

I am not encountering segfaults on a 64-bit build of R 2.4.0 compiled
with gcc and g77 3.4.5 and ATLAS 3.6.0 on a Red Hat Athlon64 system.

-----Original Message-----
From: r-devel-bounces at r-project.org
[mailto:r-devel-bounces at r-project.org] On Behalf Of Douglas Bates
Sent: Monday, October 16, 2006 10:26 AM
To: R Development Mailing List
Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4

I am encountering segfaults when checking the lme4 package on an
Athlon64 system if I use the acml blas.  R was built as a 64-bit
application using the GCC 4.0.3 compiler suite including gfortran.
The version of acml is 3.5.0 gfortran64.

I do not encounter the segfaults when I compile R with R's built-in
BLAS.  The errors occur in the first example in lme4 in a call to
lmer. It looks like they would occur in any call to lmer.  Running
under the debugger shows that the segfault occurs in a call to dtrsm
(a level-3 BLAS routine to solve a triangular system of equations)
that is called from within a cholmod (sparse matrix library) routine.

Has anyone succeeded in running R CMD check on the lme4 package with
accelerated BLAS?  I'm trying to pin down is this occurs only with
ACML or also with Atlas and/or Goto's BLAS.

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel



From ggrothendieck at gmail.com  Mon Oct 16 17:09:21 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 16 Oct 2006 11:09:21 -0400
Subject: [Rd] OmegaHat and install packages menu
Message-ID: <971536df0610160809m1dca89cbkd81b9e07ad4fc570@mail.gmail.com>

On Windows, if I set the repositories to only Omegahat using
the

   Packages | Select repositories

menu and then bring up the install packages menu:

   Packages | Install packages

I find that several packages are listed twice.  Why is that?

I am using Windows XP:

"R version 2.4.0 Patched (2006-10-07 r39598)"



From sgiannerini at gmail.com  Mon Oct 16 17:14:06 2006
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Mon, 16 Oct 2006 17:14:06 +0200
Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4
In-Reply-To: <40e66e0b0610160725y1afbaa56v906ac6efc595ae26@mail.gmail.com>
References: <40e66e0b0610160725y1afbaa56v906ac6efc595ae26@mail.gmail.com>
Message-ID: <3c12769c0610160814g2d027ca4x8183f0966c096e06@mail.gmail.com>

I did not try the ACML but I have experienced problems both in
configure and in make on my SUSE 10.0 x86_64 with gcc 4.0.2. The
problem was due to a bug in gfortran so that I had to update to
version 4.2 (I did not update gcc though). I do not know whether this
may apply to you but updating the gfortran is highly recommended by
the developers.

Kind regards,

Simone


On 10/16/06, Douglas Bates <bates at stat.wisc.edu> wrote:
> I am encountering segfaults when checking the lme4 package on an
> Athlon64 system if I use the acml blas.  R was built as a 64-bit
> application using the GCC 4.0.3 compiler suite including gfortran.
> The version of acml is 3.5.0 gfortran64.
>
> I do not encounter the segfaults when I compile R with R's built-in
> BLAS.  The errors occur in the first example in lme4 in a call to
> lmer. It looks like they would occur in any call to lmer.  Running
> under the debugger shows that the segfault occurs in a call to dtrsm
> (a level-3 BLAS routine to solve a triangular system of equations)
> that is called from within a cholmod (sparse matrix library) routine.
>
> Has anyone succeeded in running R CMD check on the lme4 package with
> accelerated BLAS?  I'm trying to pin down is this occurs only with
> ACML or also with Atlas and/or Goto's BLAS.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153



From hin-tak.leung at cimr.cam.ac.uk  Mon Oct 16 17:22:31 2006
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Mon, 16 Oct 2006 16:22:31 +0100
Subject: [Rd] Bugs with partial name matching during partial replacement
 (PR#9202)
In-Reply-To: <20060905014002.634C928F8E@slim.kubism.ku.dk>
References: <20060905014002.634C928F8E@slim.kubism.ku.dk>
Message-ID: <4533A3B7.8040103@cimr.cam.ac.uk>

This is a rather interesting, but I don't think it is a bug - it is
just things that "you are not supposed to do"... you are assuming
a certain evaluation order of the 4 "$" operators in
" D$ABC[D$M] = D$V[D$M] " as in:

temp1 <- D$M                 # 2nd and 4th
temp2 <- D$V[temp1]          # 3rd
D$ABC[temp1] = temp2         # 1st

What R did was this:

temp4 <- D$ABC         # make reference, expand to D$ABCD , 1st
temp1 <- D$M           # 2nd, and 4th
temp2 <- D$V[temp1]    # 3rd

temp4[temp1] <- temp2  # oh dear, it looks as if we are
D$ABC <- temp4         # trying to write to a reference,
                        # better make a copy instead

R is doing the 4 $'s roughly from left to right, if you have some ideas 
how R works inside. (I am not saying this behavior is a "good" thing,
but at least it is consistent). Basically it is a very bad habit to 
write code that depends on evaluation order of operators at the same
precendence.

The difference in behavior in the two case is probably due to
coercion, (and also how lazy R does make-a-reference versus "oops, you 
seems to try to write to a reference so I better copy it") but
I'll leave you to think about what order R is doing the combination of
the 4 $'s and coercing between types... Basically writing code that 
depends on evaluation order is a bad idea.

c.f. this bit of C code:

i =0;
++i = ++i + ++i;

what value do you think "i" should be?

amaliy1 at uic.edu wrote:
> Hello,
> 
> First the version info:
> platform       powerpc-apple-darwin8.6.0
> arch           powerpc
> os             darwin8.6.0
> system         powerpc, darwin8.6.0
> status
> major          2
> minor          3.1
> year           2006
> month          06
> day            01
> svn rev        38247
> language       R
> version.string Version 2.3.1 (2006-06-01)
> 
> I have encountered some unusual behavior when trying to create new  
> columns in a data frame that have names that would generate a partial  
> match with an existing column with a longer name.  It is my  
> understanding that replacement operations shouldn't have partial  
> matching, but it is not clear to me whether this applies only when  
> the named column exists and not for new assignments.
> 
> The first example:
> 
>  > D = data.frame(M=c(T,T,F,F,F,T,F,T,F,F,T,T,T),V=I(sprintf("ZZ%02d", 
> 1:13)),ABCD=13:1)
>  > D
>         M    V ABCD
> 1   TRUE ZZ01   13
> 2   TRUE ZZ02   12
> 3  FALSE ZZ03   11
> 4  FALSE ZZ04   10
> 5  FALSE ZZ05    9
> 6   TRUE ZZ06    8
> 7  FALSE ZZ07    7
> 8   TRUE ZZ08    6
> 9  FALSE ZZ09    5
> 10 FALSE ZZ10    4
> 11  TRUE ZZ11    3
> 12  TRUE ZZ12    2
> 13  TRUE ZZ13    1
>  > D$CBA[D$M] = D$V[D$M]
>  > D
>         M    V ABCD  CBA
> 1   TRUE ZZ01   13 ZZ01
> 2   TRUE ZZ02   12 ZZ02
> 3  FALSE ZZ03   11 <NA>
> 4  FALSE ZZ04   10 <NA>
> 5  FALSE ZZ05    9 <NA>
> 6   TRUE ZZ06    8 ZZ06
> 7  FALSE ZZ07    7 <NA>
> 8   TRUE ZZ08    6 ZZ08
> 9  FALSE ZZ09    5 <NA>
> 10 FALSE ZZ10    4 <NA>
> 11  TRUE ZZ11    3 ZZ11
> 12  TRUE ZZ12    2 ZZ12
> 13  TRUE ZZ13    1 ZZ13
>  > D$ABC[D$M] = D$V[D$M]
>  > D
>         M    V ABCD  CBA  ABC
> 1   TRUE ZZ01   13 ZZ01 ZZ01
> 2   TRUE ZZ02   12 ZZ02 ZZ02
> 3  FALSE ZZ03   11 <NA>   11
> 4  FALSE ZZ04   10 <NA>   10
> 5  FALSE ZZ05    9 <NA>    9
> 6   TRUE ZZ06    8 ZZ06 ZZ06
> 7  FALSE ZZ07    7 <NA>    7
> 8   TRUE ZZ08    6 ZZ08 ZZ08
> 9  FALSE ZZ09    5 <NA>    5
> 10 FALSE ZZ10    4 <NA>    4
> 11  TRUE ZZ11    3 ZZ11 ZZ11
> 12  TRUE ZZ12    2 ZZ12 ZZ12
> 13  TRUE ZZ13    1 ZZ13 ZZ13
> 
> I expected ABC to equal CBA with NA values in rows not assigned, but  
> instead it appears that an extraction from D$ABCD and coercion to  
> string is being performed in the process of creating D$ABC.
> 
> Here is something I believe is definitely a bug:
> 
>  > D = data.frame(M=c(T,T,F,F,F,T,F,T,F,F,T,T,T),V=1:13,ABCD=13:1)
>  > D
>         M  V ABCD
> 1   TRUE  1   13
> 2   TRUE  2   12
> 3  FALSE  3   11
> 4  FALSE  4   10
> 5  FALSE  5    9
> 6   TRUE  6    8
> 7  FALSE  7    7
> 8   TRUE  8    6
> 9  FALSE  9    5
> 10 FALSE 10    4
> 11  TRUE 11    3
> 12  TRUE 12    2
> 13  TRUE 13    1
>  > D$CBA[D$M] = D$V[D$M]
>  > D
>         M  V ABCD CBA
> 1   TRUE  1   13   1
> 2   TRUE  2   12   2
> 3  FALSE  3   11  NA
> 4  FALSE  4   10  NA
> 5  FALSE  5    9  NA
> 6   TRUE  6    8   6
> 7  FALSE  7    7  NA
> 8   TRUE  8    6   8
> 9  FALSE  9    5  NA
> 10 FALSE 10    4  NA
> 11  TRUE 11    3  11
> 12  TRUE 12    2  12
> 13  TRUE 13    1  13
>  > D$ABC[D$M] = D$V[D$M]
>  > D
>         M  V ABCD CBA ABC
> 1   TRUE  1    1   1   1
> 2   TRUE  2    2   2   2
> 3  FALSE  3   11  NA  11
> 4  FALSE  4   10  NA  10
> 5  FALSE  5    9  NA   9
> 6   TRUE  6    6   6   6
> 7  FALSE  7    7  NA   7
> 8   TRUE  8    8   8   8
> 9  FALSE  9    5  NA   5
> 10 FALSE 10    4  NA   4
> 11  TRUE 11   11  11  11
> 12  TRUE 12   12  12  12
> 13  TRUE 13   13  13  13
> 
> ABC is created as before with valued from ABCD in the unassigned  
> rows, but ABCD is being modified as well.  The only difference form  
> the previous example is that V is now just a numeric column.
> 
> Anil Maliyekkel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From hin-tak.leung at cimr.cam.ac.uk  Mon Oct 16 17:23:25 2006
From: hin-tak.leung at cimr.cam.ac.uk (hin-tak.leung at cimr.cam.ac.uk)
Date: Mon, 16 Oct 2006 17:23:25 +0200 (CEST)
Subject: [Rd] Bugs with partial name matching during partial replacement
	(PR#9299)
Message-ID: <20061016152325.B8EB556199@slim.kubism.ku.dk>

This is a rather interesting, but I don't think it is a bug - it is
just things that "you are not supposed to do"... you are assuming
a certain evaluation order of the 4 "$" operators in
" D$ABC[D$M] = D$V[D$M] " as in:

temp1 <- D$M                 # 2nd and 4th
temp2 <- D$V[temp1]          # 3rd
D$ABC[temp1] = temp2         # 1st

What R did was this:

temp4 <- D$ABC         # make reference, expand to D$ABCD , 1st
temp1 <- D$M           # 2nd, and 4th
temp2 <- D$V[temp1]    # 3rd

temp4[temp1] <- temp2  # oh dear, it looks as if we are
D$ABC <- temp4         # trying to write to a reference,
                        # better make a copy instead

R is doing the 4 $'s roughly from left to right, if you have some ideas 
how R works inside. (I am not saying this behavior is a "good" thing,
but at least it is consistent). Basically it is a very bad habit to 
write code that depends on evaluation order of operators at the same
precendence.

The difference in behavior in the two case is probably due to
coercion, (and also how lazy R does make-a-reference versus "oops, you 
seems to try to write to a reference so I better copy it") but
I'll leave you to think about what order R is doing the combination of
the 4 $'s and coercing between types... Basically writing code that 
depends on evaluation order is a bad idea.

c.f. this bit of C code:

i =0;
++i = ++i + ++i;

what value do you think "i" should be?

amaliy1 at uic.edu wrote:
> Hello,
> 
> First the version info:
> platform       powerpc-apple-darwin8.6.0
> arch           powerpc
> os             darwin8.6.0
> system         powerpc, darwin8.6.0
> status
> major          2
> minor          3.1
> year           2006
> month          06
> day            01
> svn rev        38247
> language       R
> version.string Version 2.3.1 (2006-06-01)
> 
> I have encountered some unusual behavior when trying to create new  
> columns in a data frame that have names that would generate a partial  
> match with an existing column with a longer name.  It is my  
> understanding that replacement operations shouldn't have partial  
> matching, but it is not clear to me whether this applies only when  
> the named column exists and not for new assignments.
> 
> The first example:
> 
>  > D = data.frame(M=c(T,T,F,F,F,T,F,T,F,F,T,T,T),V=I(sprintf("ZZ%02d", 
> 1:13)),ABCD=13:1)
>  > D
>         M    V ABCD
> 1   TRUE ZZ01   13
> 2   TRUE ZZ02   12
> 3  FALSE ZZ03   11
> 4  FALSE ZZ04   10
> 5  FALSE ZZ05    9
> 6   TRUE ZZ06    8
> 7  FALSE ZZ07    7
> 8   TRUE ZZ08    6
> 9  FALSE ZZ09    5
> 10 FALSE ZZ10    4
> 11  TRUE ZZ11    3
> 12  TRUE ZZ12    2
> 13  TRUE ZZ13    1
>  > D$CBA[D$M] = D$V[D$M]
>  > D
>         M    V ABCD  CBA
> 1   TRUE ZZ01   13 ZZ01
> 2   TRUE ZZ02   12 ZZ02
> 3  FALSE ZZ03   11 <NA>
> 4  FALSE ZZ04   10 <NA>
> 5  FALSE ZZ05    9 <NA>
> 6   TRUE ZZ06    8 ZZ06
> 7  FALSE ZZ07    7 <NA>
> 8   TRUE ZZ08    6 ZZ08
> 9  FALSE ZZ09    5 <NA>
> 10 FALSE ZZ10    4 <NA>
> 11  TRUE ZZ11    3 ZZ11
> 12  TRUE ZZ12    2 ZZ12
> 13  TRUE ZZ13    1 ZZ13
>  > D$ABC[D$M] = D$V[D$M]
>  > D
>         M    V ABCD  CBA  ABC
> 1   TRUE ZZ01   13 ZZ01 ZZ01
> 2   TRUE ZZ02   12 ZZ02 ZZ02
> 3  FALSE ZZ03   11 <NA>   11
> 4  FALSE ZZ04   10 <NA>   10
> 5  FALSE ZZ05    9 <NA>    9
> 6   TRUE ZZ06    8 ZZ06 ZZ06
> 7  FALSE ZZ07    7 <NA>    7
> 8   TRUE ZZ08    6 ZZ08 ZZ08
> 9  FALSE ZZ09    5 <NA>    5
> 10 FALSE ZZ10    4 <NA>    4
> 11  TRUE ZZ11    3 ZZ11 ZZ11
> 12  TRUE ZZ12    2 ZZ12 ZZ12
> 13  TRUE ZZ13    1 ZZ13 ZZ13
> 
> I expected ABC to equal CBA with NA values in rows not assigned, but  
> instead it appears that an extraction from D$ABCD and coercion to  
> string is being performed in the process of creating D$ABC.
> 
> Here is something I believe is definitely a bug:
> 
>  > D = data.frame(M=c(T,T,F,F,F,T,F,T,F,F,T,T,T),V=1:13,ABCD=13:1)
>  > D
>         M  V ABCD
> 1   TRUE  1   13
> 2   TRUE  2   12
> 3  FALSE  3   11
> 4  FALSE  4   10
> 5  FALSE  5    9
> 6   TRUE  6    8
> 7  FALSE  7    7
> 8   TRUE  8    6
> 9  FALSE  9    5
> 10 FALSE 10    4
> 11  TRUE 11    3
> 12  TRUE 12    2
> 13  TRUE 13    1
>  > D$CBA[D$M] = D$V[D$M]
>  > D
>         M  V ABCD CBA
> 1   TRUE  1   13   1
> 2   TRUE  2   12   2
> 3  FALSE  3   11  NA
> 4  FALSE  4   10  NA
> 5  FALSE  5    9  NA
> 6   TRUE  6    8   6
> 7  FALSE  7    7  NA
> 8   TRUE  8    6   8
> 9  FALSE  9    5  NA
> 10 FALSE 10    4  NA
> 11  TRUE 11    3  11
> 12  TRUE 12    2  12
> 13  TRUE 13    1  13
>  > D$ABC[D$M] = D$V[D$M]
>  > D
>         M  V ABCD CBA ABC
> 1   TRUE  1    1   1   1
> 2   TRUE  2    2   2   2
> 3  FALSE  3   11  NA  11
> 4  FALSE  4   10  NA  10
> 5  FALSE  5    9  NA   9
> 6   TRUE  6    6   6   6
> 7  FALSE  7    7  NA   7
> 8   TRUE  8    8   8   8
> 9  FALSE  9    5  NA   5
> 10 FALSE 10    4  NA   4
> 11  TRUE 11   11  11  11
> 12  TRUE 12   12  12  12
> 13  TRUE 13   13  13  13
> 
> ABC is created as before with valued from ABCD in the unassigned  
> rows, but ABCD is being modified as well.  The only difference form  
> the previous example is that V is now just a numeric column.
> 
> Anil Maliyekkel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From murdoch at stats.uwo.ca  Mon Oct 16 17:27:13 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 16 Oct 2006 11:27:13 -0400
Subject: [Rd] OmegaHat and install packages menu
In-Reply-To: <971536df0610160809m1dca89cbkd81b9e07ad4fc570@mail.gmail.com>
References: <971536df0610160809m1dca89cbkd81b9e07ad4fc570@mail.gmail.com>
Message-ID: <4533A4D1.9050002@stats.uwo.ca>

On 10/16/2006 11:09 AM, Gabor Grothendieck wrote:
> On Windows, if I set the repositories to only Omegahat using
> the
> 
>    Packages | Select repositories
> 
> menu and then bring up the install packages menu:
> 
>    Packages | Install packages
> 
> I find that several packages are listed twice.  Why is that?
> 
> I am using Windows XP:
> 
> "R version 2.4.0 Patched (2006-10-07 r39598)"

Run available.packages() (which is what you're seeing in the menu). 
There are multiple versions of some packages available.

It would be nice if the list presented from the menu were more 
informative; I think the Mac GUI does a good job of this. Nice, but a 
fair bit of work, I think.

Duncan Murdoch



From jmacdon at med.umich.edu  Mon Oct 16 17:45:20 2006
From: jmacdon at med.umich.edu (James W. MacDonald)
Date: Mon, 16 Oct 2006 11:45:20 -0400
Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4
In-Reply-To: <67DCA285A2D7754280D3B8E88EB548020C946941@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB548020C946941@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <4533A910.5090404@med.umich.edu>

I am not encountering segfaults either, using earlier versions of 
gcc/gfortran64 (4.0.0) and acml (3.0.0) on a 64 bit build of R-2.4.0 on 
Fedora Core 4

Best,

Jim



McGehee, Robert wrote:
> I am not encountering segfaults on a 64-bit build of R 2.4.0 compiled
> with gcc and g77 3.4.5 and ATLAS 3.6.0 on a Red Hat Athlon64 system.
> 
> -----Original Message-----
> From: r-devel-bounces at r-project.org
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Douglas Bates
> Sent: Monday, October 16, 2006 10:26 AM
> To: R Development Mailing List
> Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4
> 
> I am encountering segfaults when checking the lme4 package on an
> Athlon64 system if I use the acml blas.  R was built as a 64-bit
> application using the GCC 4.0.3 compiler suite including gfortran.
> The version of acml is 3.5.0 gfortran64.
> 
> I do not encounter the segfaults when I compile R with R's built-in
> BLAS.  The errors occur in the first example in lme4 in a call to
> lmer. It looks like they would occur in any call to lmer.  Running
> under the debugger shows that the segfault occurs in a call to dtrsm
> (a level-3 BLAS routine to solve a triangular system of equations)
> that is called from within a cholmod (sparse matrix library) routine.
> 
> Has anyone succeeded in running R CMD check on the lme4 package with
> accelerated BLAS?  I'm trying to pin down is this occurs only with
> ACML or also with Atlas and/or Goto's BLAS.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
James W. MacDonald
Affymetrix and cDNA Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
734-647-5623


**********************************************************
Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues.



From ripley at stats.ox.ac.uk  Mon Oct 16 19:18:24 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 16 Oct 2006 18:18:24 +0100 (BST)
Subject: [Rd] x86_64, acml-3.5.0-gfortran64 and lme4
In-Reply-To: <40e66e0b0610160725y1afbaa56v906ac6efc595ae26@mail.gmail.com>
References: <40e66e0b0610160725y1afbaa56v906ac6efc595ae26@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610161758010.30837@gannet.stats.ox.ac.uk>

On Mon, 16 Oct 2006, Douglas Bates wrote:

> I am encountering segfaults when checking the lme4 package on an
> Athlon64 system if I use the acml blas.  R was built as a 64-bit
> application using the GCC 4.0.3 compiler suite including gfortran.
> The version of acml is 3.5.0 gfortran64.

gcc 4.1.1 is current, and I would suggest an update would be a good idea: 
my tests with gcc4 went a lot better with 4.1.0 than 4.0.3.

I have an FC5 dual x86_64 system (hence gcc 4.1.1) with ACML 3.5.0 and 
Goto 1.06 (I cannot get ATLAS to build on that system).  I too get a 
segfault with ACML (I used the _mp version, but also tried with it 
confined to a single thread), but not with Goto nor R's internal BLAS.

> I do not encounter the segfaults when I compile R with R's built-in
> BLAS.  The errors occur in the first example in lme4 in a call to
> lmer. It looks like they would occur in any call to lmer.  Running
> under the debugger shows that the segfault occurs in a call to dtrsm
> (a level-3 BLAS routine to solve a triangular system of equations)
> that is called from within a cholmod (sparse matrix library) routine.
>
> Has anyone succeeded in running R CMD check on the lme4 package with
> accelerated BLAS?  I'm trying to pin down is this occurs only with
> ACML or also with Atlas and/or Goto's BLAS.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From watplatt at us.ibm.com  Mon Oct 16 21:47:01 2006
From: watplatt at us.ibm.com (watplatt at us.ibm.com)
Date: Mon, 16 Oct 2006 21:47:01 +0200 (CEST)
Subject: [Rd] PR#9295
Message-ID: <20061016194701.0CFDF561A2@slim.kubism.ku.dk>

I asked a question that might help me track down what changed between 
2.3.1 that did build and the 2.4.0 version that will not build.  Some of 
the undefined names the linker was complaining about looked like #define 
symbols that were not picked up by configure.  The first thing I was 
hoping for was to find out if this problem looked familiar?  Whether or 
not, I'm willing to try to work on it, but hope I can get reasonable 
answers to honest questions....

Dan

Saw:

IBM employee is unable to make AIX work: so why does he expect us to?

in response to:

From: watplatt at us.ibm.com
To: R-bugs at biostat.ku.dk
Subject: Unable to build
Date: Fri, 13 Oct 2006 21:42:37 +0200 (CEST)

Full_Name: Daniel E. Platt
Version: 2.4.0
OS: AIX 5.3
Submission from: (NULL) (129.34.20.23)


Did a new build of gcc c,c++,gfortran v4.1.1, (re)built R 2.3.1 using
config.site as spec'd in R-admin.pdf in sec C.9 as described by Jagat 
Sheth,
with addition of FC=gfortran (configure tried using f95, which is present 
on the
system, but won't bind with gcc's obj files).


Applying the same to 4.1.1 produces the following:

make[4]: Leaving directory 
`/geno4/watplatt/R/R-2.4.0/src/library/tools/src'
Error in dyn.load(x, as.logical(local), as.logical(now)) : 
        unable to load shared library
'/geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so':
  rtld: 0712-001 Symbol TYPEOF was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol Rf_error was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol Rf_asLogical was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol LENGTH was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
but a
runtime definition
      of the symbol was not found.
rtld: 0712-001 Symbol STRING_ELT was referenced
      from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
bu
Execution halted
make[3]: *** [all] Error 1
make[3]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library/tools'
make[2]: *** [R] Error 1
make[2]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src'
make: *** [R] Error 1

Are there undefined #define's leaking in as code?

Dan




Daniel E. Platt
Bioinformatics and Pattern Discovery
IBM T. J. Watson Research Center
Yorktown Hgts, NY 10598
(914)945-1388
	[[alternative HTML version deleted]]



From tlumley at u.washington.edu  Mon Oct 16 21:54:53 2006
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon, 16 Oct 2006 12:54:53 -0700 (PDT)
Subject: [Rd] PR#9299:Re: Bugs with partial name matching during partial
 replacement (PR#9299)
In-Reply-To: <20061016152325.B8EB556199@slim.kubism.ku.dk>
References: <20061016152325.B8EB556199@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0610161252080.777@homer24.u.washington.edu>

On Mon, 16 Oct 2006, hin-tak.leung at cimr.cam.ac.uk wrote:

> This is a rather interesting, but I don't think it is a bug - it is
> just things that "you are not supposed to do"

It was a bug. It has been fixed in R 2.4.0. Unfortunately, since you 
didn't quote the PR# of the original bug in the subject line you have just 
filed a new bug report for it.

 	-thomas


>	... you are assuming
> a certain evaluation order of the 4 "$" operators in
> " D$ABC[D$M] = D$V[D$M] " as in:
>
> temp1 <- D$M                 # 2nd and 4th
> temp2 <- D$V[temp1]          # 3rd
> D$ABC[temp1] = temp2         # 1st
>
> What R did was this:
>
> temp4 <- D$ABC         # make reference, expand to D$ABCD , 1st
> temp1 <- D$M           # 2nd, and 4th
> temp2 <- D$V[temp1]    # 3rd
>
> temp4[temp1] <- temp2  # oh dear, it looks as if we are
> D$ABC <- temp4         # trying to write to a reference,
>                        # better make a copy instead
>
> R is doing the 4 $'s roughly from left to right, if you have some ideas
> how R works inside. (I am not saying this behavior is a "good" thing,
> but at least it is consistent). Basically it is a very bad habit to
> write code that depends on evaluation order of operators at the same
> precendence.
>
> The difference in behavior in the two case is probably due to
> coercion, (and also how lazy R does make-a-reference versus "oops, you
> seems to try to write to a reference so I better copy it") but
> I'll leave you to think about what order R is doing the combination of
> the 4 $'s and coercing between types... Basically writing code that
> depends on evaluation order is a bad idea.
>
> c.f. this bit of C code:
>
> i =0;
> ++i = ++i + ++i;
>
> what value do you think "i" should be?
>
> amaliy1 at uic.edu wrote:
>> Hello,
>>
>> First the version info:
>> platform       powerpc-apple-darwin8.6.0
>> arch           powerpc
>> os             darwin8.6.0
>> system         powerpc, darwin8.6.0
>> status
>> major          2
>> minor          3.1
>> year           2006
>> month          06
>> day            01
>> svn rev        38247
>> language       R
>> version.string Version 2.3.1 (2006-06-01)
>>
>> I have encountered some unusual behavior when trying to create new
>> columns in a data frame that have names that would generate a partial
>> match with an existing column with a longer name.  It is my
>> understanding that replacement operations shouldn't have partial
>> matching, but it is not clear to me whether this applies only when
>> the named column exists and not for new assignments.
>>
>> The first example:
>>
>> > D = data.frame(M=c(T,T,F,F,F,T,F,T,F,F,T,T,T),V=I(sprintf("ZZ%02d",
>> 1:13)),ABCD=13:1)
>> > D
>>         M    V ABCD
>> 1   TRUE ZZ01   13
>> 2   TRUE ZZ02   12
>> 3  FALSE ZZ03   11
>> 4  FALSE ZZ04   10
>> 5  FALSE ZZ05    9
>> 6   TRUE ZZ06    8
>> 7  FALSE ZZ07    7
>> 8   TRUE ZZ08    6
>> 9  FALSE ZZ09    5
>> 10 FALSE ZZ10    4
>> 11  TRUE ZZ11    3
>> 12  TRUE ZZ12    2
>> 13  TRUE ZZ13    1
>> > D$CBA[D$M] = D$V[D$M]
>> > D
>>         M    V ABCD  CBA
>> 1   TRUE ZZ01   13 ZZ01
>> 2   TRUE ZZ02   12 ZZ02
>> 3  FALSE ZZ03   11 <NA>
>> 4  FALSE ZZ04   10 <NA>
>> 5  FALSE ZZ05    9 <NA>
>> 6   TRUE ZZ06    8 ZZ06
>> 7  FALSE ZZ07    7 <NA>
>> 8   TRUE ZZ08    6 ZZ08
>> 9  FALSE ZZ09    5 <NA>
>> 10 FALSE ZZ10    4 <NA>
>> 11  TRUE ZZ11    3 ZZ11
>> 12  TRUE ZZ12    2 ZZ12
>> 13  TRUE ZZ13    1 ZZ13
>> > D$ABC[D$M] = D$V[D$M]
>> > D
>>         M    V ABCD  CBA  ABC
>> 1   TRUE ZZ01   13 ZZ01 ZZ01
>> 2   TRUE ZZ02   12 ZZ02 ZZ02
>> 3  FALSE ZZ03   11 <NA>   11
>> 4  FALSE ZZ04   10 <NA>   10
>> 5  FALSE ZZ05    9 <NA>    9
>> 6   TRUE ZZ06    8 ZZ06 ZZ06
>> 7  FALSE ZZ07    7 <NA>    7
>> 8   TRUE ZZ08    6 ZZ08 ZZ08
>> 9  FALSE ZZ09    5 <NA>    5
>> 10 FALSE ZZ10    4 <NA>    4
>> 11  TRUE ZZ11    3 ZZ11 ZZ11
>> 12  TRUE ZZ12    2 ZZ12 ZZ12
>> 13  TRUE ZZ13    1 ZZ13 ZZ13
>>
>> I expected ABC to equal CBA with NA values in rows not assigned, but
>> instead it appears that an extraction from D$ABCD and coercion to
>> string is being performed in the process of creating D$ABC.
>>
>> Here is something I believe is definitely a bug:
>>
>> > D = data.frame(M=c(T,T,F,F,F,T,F,T,F,F,T,T,T),V=1:13,ABCD=13:1)
>> > D
>>         M  V ABCD
>> 1   TRUE  1   13
>> 2   TRUE  2   12
>> 3  FALSE  3   11
>> 4  FALSE  4   10
>> 5  FALSE  5    9
>> 6   TRUE  6    8
>> 7  FALSE  7    7
>> 8   TRUE  8    6
>> 9  FALSE  9    5
>> 10 FALSE 10    4
>> 11  TRUE 11    3
>> 12  TRUE 12    2
>> 13  TRUE 13    1
>> > D$CBA[D$M] = D$V[D$M]
>> > D
>>         M  V ABCD CBA
>> 1   TRUE  1   13   1
>> 2   TRUE  2   12   2
>> 3  FALSE  3   11  NA
>> 4  FALSE  4   10  NA
>> 5  FALSE  5    9  NA
>> 6   TRUE  6    8   6
>> 7  FALSE  7    7  NA
>> 8   TRUE  8    6   8
>> 9  FALSE  9    5  NA
>> 10 FALSE 10    4  NA
>> 11  TRUE 11    3  11
>> 12  TRUE 12    2  12
>> 13  TRUE 13    1  13
>> > D$ABC[D$M] = D$V[D$M]
>> > D
>>         M  V ABCD CBA ABC
>> 1   TRUE  1    1   1   1
>> 2   TRUE  2    2   2   2
>> 3  FALSE  3   11  NA  11
>> 4  FALSE  4   10  NA  10
>> 5  FALSE  5    9  NA   9
>> 6   TRUE  6    6   6   6
>> 7  FALSE  7    7  NA   7
>> 8   TRUE  8    8   8   8
>> 9  FALSE  9    5  NA   5
>> 10 FALSE 10    4  NA   4
>> 11  TRUE 11   11  11  11
>> 12  TRUE 12   12  12  12
>> 13  TRUE 13   13  13  13
>>
>> ABC is created as before with valued from ABCD in the unassigned
>> rows, but ABCD is being modified as well.  The only difference form
>> the previous example is that V is now just a numeric column.
>>
>> Anil Maliyekkel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle



From murdoch at stats.uwo.ca  Mon Oct 16 22:28:57 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 16 Oct 2006 16:28:57 -0400
Subject: [Rd] Build question Re:  PR#9295
In-Reply-To: <20061016194701.0CFDF561A2@slim.kubism.ku.dk>
References: <20061016194701.0CFDF561A2@slim.kubism.ku.dk>
Message-ID: <4533EB89.5050504@stats.uwo.ca>

On 10/16/2006 3:47 PM, watplatt at us.ibm.com wrote:
> I asked a question that might help me track down what changed between 
> 2.3.1 that did build and the 2.4.0 version that will not build.  

Actually, I think your message came through as a bug report, suggesting 
you were expecting someone else to fix it.

Perhaps now that it's clear that you are asking a question, someone will 
be able to help:  but surely you have access to better AIX tech support 
than most people on this list?

Duncan Murdoch

Some of
> the undefined names the linker was complaining about looked like #define 
> symbols that were not picked up by configure.  The first thing I was 
> hoping for was to find out if this problem looked familiar?  Whether or 
> not, I'm willing to try to work on it, but hope I can get reasonable 
> answers to honest questions....
> 
> Dan
> 
> Saw:
> 
> IBM employee is unable to make AIX work: so why does he expect us to?
> 
> in response to:
> 
> From: watplatt at us.ibm.com
> To: R-bugs at biostat.ku.dk
> Subject: Unable to build
> Date: Fri, 13 Oct 2006 21:42:37 +0200 (CEST)
> 
> Full_Name: Daniel E. Platt
> Version: 2.4.0
> OS: AIX 5.3
> Submission from: (NULL) (129.34.20.23)
> 
> 
> Did a new build of gcc c,c++,gfortran v4.1.1, (re)built R 2.3.1 using
> config.site as spec'd in R-admin.pdf in sec C.9 as described by Jagat 
> Sheth,
> with addition of FC=gfortran (configure tried using f95, which is present 
> on the
> system, but won't bind with gcc's obj files).
> 
> 
> Applying the same to 4.1.1 produces the following:
> 
> make[4]: Leaving directory 
> `/geno4/watplatt/R/R-2.4.0/src/library/tools/src'
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>         unable to load shared library
> '/geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so':
>   rtld: 0712-001 Symbol TYPEOF was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol Rf_error was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol Rf_asLogical was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol LENGTH was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol STRING_ELT was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> bu
> Execution halted
> make[3]: *** [all] Error 1
> make[3]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library/tools'
> make[2]: *** [R] Error 1
> make[2]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src'
> make: *** [R] Error 1
> 
> Are there undefined #define's leaking in as code?
> 
> Dan
> 
> 
> 
> 
> Daniel E. Platt
> Bioinformatics and Pattern Discovery
> IBM T. J. Watson Research Center
> Yorktown Hgts, NY 10598
> (914)945-1388
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From p.dalgaard at biostat.ku.dk  Mon Oct 16 22:29:38 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 16 Oct 2006 22:29:38 +0200
Subject: [Rd] PR#9295
In-Reply-To: <20061016194701.0CFDF561A2@slim.kubism.ku.dk>
References: <20061016194701.0CFDF561A2@slim.kubism.ku.dk>
Message-ID: <x2fydo9f7x.fsf@turmalin.kubism.ku.dk>

watplatt at us.ibm.com writes:

> I asked a question that might help me track down what changed between 
> 2.3.1 that did build and the 2.4.0 version that will not build.  Some of 
> the undefined names the linker was complaining about looked like #define 
> symbols that were not picked up by configure.  The first thing I was 
> hoping for was to find out if this problem looked familiar?  Whether or 
> not, I'm willing to try to work on it, but hope I can get reasonable 
> answers to honest questions....

Well, you should have seen the snide remarks that I decided to keep to
myself.... (Along the lines of "please tell us the fix in time for the
_next_ release")

Anyways, AFAIK those entry points are not supposed to be macros. They
are also undefined symbols in tools.so on Fedora, so your issue would
seem to be with the linker. The culprit is likely changes to the
symbol registration mechanism, or an unforeseen complication of this:

    o   configure now defaults to 'run-time linking' on AIX
        (and AIX < 4.2 is no longer allowed), using -bexpall rather
        than export/import files.  If this works, it allows R to be
        built in the same way as other Unix-alikes, including with R
        as a shared library and with a shared BLAS.

Also, of course, check that you are doing a clean build and that the
previous build is not somehow interfering.
 
> Dan
> 
> Saw:
> 
> IBM employee is unable to make AIX work: so why does he expect us to?
> 
> in response to:
> 
> From: watplatt at us.ibm.com
> To: R-bugs at biostat.ku.dk
> Subject: Unable to build
> Date: Fri, 13 Oct 2006 21:42:37 +0200 (CEST)
> 
> Full_Name: Daniel E. Platt
> Version: 2.4.0
> OS: AIX 5.3
> Submission from: (NULL) (129.34.20.23)
> 
> 
> Did a new build of gcc c,c++,gfortran v4.1.1, (re)built R 2.3.1 using
> config.site as spec'd in R-admin.pdf in sec C.9 as described by Jagat 
> Sheth,
> with addition of FC=gfortran (configure tried using f95, which is present 
> on the
> system, but won't bind with gcc's obj files).
> 
> 
> Applying the same to 4.1.1 produces the following:
> 
> make[4]: Leaving directory 
> `/geno4/watplatt/R/R-2.4.0/src/library/tools/src'
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>         unable to load shared library
> '/geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so':
>   rtld: 0712-001 Symbol TYPEOF was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol Rf_error was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol Rf_asLogical was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol LENGTH was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> but a
> runtime definition
>       of the symbol was not found.
> rtld: 0712-001 Symbol STRING_ELT was referenced
>       from module /geno4/watplatt/R/R-2.4.0/library/tools/libs/tools.so(), 
> bu
> Execution halted
> make[3]: *** [all] Error 1
> make[3]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library/tools'
> make[2]: *** [R] Error 1
> make[2]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src/library'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/geno4/watplatt/R/R-2.4.0/src'
> make: *** [R] Error 1
> 
> Are there undefined #define's leaking in as code?
> 
> Dan
> 
> 
> 
> 
> Daniel E. Platt
> Bioinformatics and Pattern Discovery
> IBM T. J. Watson Research Center
> Yorktown Hgts, NY 10598
> (914)945-1388
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From bates at stat.wisc.edu  Mon Oct 16 22:56:08 2006
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon, 16 Oct 2006 15:56:08 -0500
Subject: [Rd] error in lme4 for R 2.4.0 (PR#9297)
In-Reply-To: <20061014132802.57581CBEA@slim.kubism.ku.dk>
References: <20061014132802.57581CBEA@slim.kubism.ku.dk>
Message-ID: <40e66e0b0610161356o39c03e64h71badc162f194450@mail.gmail.com>

On 10/14/06, din.chen at sdstate.edu <din.chen at sdstate.edu> wrote:
> Full_Name: Din Chen
> Version: 2.4.0
> OS: Windows XP
> Submission from: (NULL) (66.17.122.18)
>
>
> I just updated the R.2.4.0. and got the error message for random effect
> modelling, which was working on R.2.3.1.
>
> library(lme4)
> mmod <- lmer(bright ~ 1+(1|operator), pulp)
> summary(mmod)
>
> Then when I tried to extract the residuals and random effect using:
> resid(mmodr)
> ranef(mmodr)
>
> I got error message:
>
> Error in resid(mmod) : no slot of name "family" for this object of class "lmer"

Insufficient testing by the author.  I need to modify the resid
methods for the new class definitions.  I'll upload lme4_0.9975-6 with
a fix for this later today.

The ranef method does work ok, I believe.



From watplatt at us.ibm.com  Mon Oct 16 23:29:59 2006
From: watplatt at us.ibm.com (Daniel Platt)
Date: Mon, 16 Oct 2006 17:29:59 -0400
Subject: [Rd] PR#9295
In-Reply-To: <x2fydo9f7x.fsf@turmalin.kubism.ku.dk>
Message-ID: <OFD0621DBC.D7A9D9F1-ON85257209.00754A60-85257209.00761B04@us.ibm.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061016/804db47e/attachment-0003.pl 

From hin-tak.leung at cimr.cam.ac.uk  Tue Oct 17 13:05:36 2006
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Tue, 17 Oct 2006 12:05:36 +0100
Subject: [Rd] PR#9299:Re: Bugs with partial name matching during partial
 replacement (PR#9299)
In-Reply-To: <Pine.LNX.4.64.0610161252080.777@homer24.u.washington.edu>
References: <20061016152325.B8EB556199@slim.kubism.ku.dk>
	<Pine.LNX.4.64.0610161252080.777@homer24.u.washington.edu>
Message-ID: <4534B900.2090107@cimr.cam.ac.uk>

Thomas Lumley wrote:
> On Mon, 16 Oct 2006, hin-tak.leung at cimr.cam.ac.uk wrote:
> 
>> This is a rather interesting, but I don't think it is a bug - it is
>> just things that "you are not supposed to do"
> 
> It was a bug. It has been fixed in R 2.4.0. Unfortunately, since you 
> didn't quote the PR# of the original bug in the subject line you have 
> just filed a new bug report for it.
> 
>     -thomas

I am sorry (about both the duplicate report and the comment).

I don't know what happened with the duplication - but as you see
I replied to both r-devel and r-bugs in the same e-mail, and the
one arriving back via r-devel did have the right subject with
the PR#9202 at the end, and the other copy via r-bugs didn't and
got a new one. It seems somewhere during in the round-trip
over-long subject lines get truncated and/or a new-line inserted in
the middle. May worth investigating...

Regards,
Hin-Tak



From ripley at stats.ox.ac.uk  Tue Oct 17 15:06:28 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 17 Oct 2006 14:06:28 +0100 (BST)
Subject: [Rd] PR#9299:Re: Bugs with partial name matching during partial
 replacement (PR#9299)
In-Reply-To: <4534B900.2090107@cimr.cam.ac.uk>
References: <20061016152325.B8EB556199@slim.kubism.ku.dk>
	<Pine.LNX.4.64.0610161252080.777@homer24.u.washington.edu>
	<4534B900.2090107@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0610171401350.29107@gannet.stats.ox.ac.uk>

On Tue, 17 Oct 2006, Hin-Tak Leung wrote:

> Thomas Lumley wrote:
>> On Mon, 16 Oct 2006, hin-tak.leung at cimr.cam.ac.uk wrote:
>>
>>> This is a rather interesting, but I don't think it is a bug - it is
>>> just things that "you are not supposed to do"
>>
>> It was a bug. It has been fixed in R 2.4.0. Unfortunately, since you
>> didn't quote the PR# of the original bug in the subject line you have
>> just filed a new bug report for it.
>>
>>     -thomas
>
> I am sorry (about both the duplicate report and the comment).
>
> I don't know what happened with the duplication - but as you see
> I replied to both r-devel and r-bugs in the same e-mail, and the
> one arriving back via r-devel did have the right subject with
> the PR#9202 at the end, and the other copy via r-bugs didn't and
> got a new one. It seems somewhere during in the round-trip
> over-long subject lines get truncated and/or a new-line inserted in
> the middle. May worth investigating...

We know you need to have the PR# number on the first line of the subject. 
This is why Thomas duplicated it (and I move it to the beginning).

At one time JitterBug had a higher version number than R, and at around 
that time it seemed to be orphaned.  Now R > 2.4.0, and JitterBug is still 
at 1.6.2.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From bolker at zoo.ufl.edu  Tue Oct 17 15:09:21 2006
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue, 17 Oct 2006 13:09:21 +0000 (UTC)
Subject: [Rd] boxplot, notches, etc.
References: <452ACA95.9010606@zoo.ufl.edu>
Message-ID: <loom.20061017T150813-982@post.gmane.org>

Ben Bolker <bolker <at> zoo.ufl.edu> writes:

> 
>   Synopsis: boxplot notches look weird when notches
> are greater than hinges ((1.58*IQR/sqrt(n)) > approx IQR).
> When log="y" this causes an error.  Below are several
> reproducible examples, some discussion, and a patch against
> calc.R.
> 
>   Please feel free to say "this is just cosmetic/isn't an issue, go
> away" ...
> 
>   cheers
>     Ben Bolker
> 

  followup (one week later): does anyone have any
opinions on this ... ???  (If someone will tell
me this isn't worth pursuing, I will give up on it)

    Ben Bolker



From rmh at temple.edu  Tue Oct 17 18:30:18 2006
From: rmh at temple.edu (Richard M. Heiberger)
Date: Tue, 17 Oct 2006 12:30:18 -0400 (EDT)
Subject: [Rd] request for additional test in R CMD check
Message-ID: <20061017123018.BKM19969@po-d.temple.edu>

I inadvertently had the same function name defined in two different
.R files.  Can you add a test for that to the check program and
issue a warning?

Thanks
Rich



From plindenbaum at yahoo.fr  Tue Oct 17 19:15:07 2006
From: plindenbaum at yahoo.fr (Pierre LINDENBAUM)
Date: Tue, 17 Oct 2006 17:15:07 +0000 (GMT)
Subject: [Rd] R and JAVA
Message-ID: <20061017171507.88001.qmail@web26512.mail.ukl.yahoo.com>

Hi all,
I'm Pierre Lindenbaum and I'm new to 'R'.

I'm currently working with a colleague who has created a java bioinformatic tool using 'R' . No problem : we work on linux, we call 'R' using a system call via java.lang.Runtime.exec, we know the $path to 'R', etc...

But now, we would like to distribute our java application as a *.jar archive and I wondered what is the best way to install it on window: is there a way to embed 'R' in my java archive ?  can I install 'R' on windows from  my java archive ?  what is the best way to call 'R' from java. Can I avoid this system call ?...etc...

Any help will be appreciated :-)

Thanks in advance.

Pierre



From sfalcon at fhcrc.org  Tue Oct 17 20:07:14 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Tue, 17 Oct 2006 11:07:14 -0700
Subject: [Rd] request for additional test in R CMD check
In-Reply-To: <20061017123018.BKM19969@po-d.temple.edu> (Richard M. Heiberger's
	message of "Tue, 17 Oct 2006 12:30:18 -0400 (EDT)")
References: <20061017123018.BKM19969@po-d.temple.edu>
Message-ID: <m2y7rex1d9.fsf@ziti.local>

"Richard M. Heiberger" <rmh at temple.edu> writes:

> I inadvertently had the same function name defined in two different
> .R files.  Can you add a test for that to the check program and
> issue a warning?

Please, not without a flag asking for such a check/warning.

There are reasonable cases where a function is redefined based on
available packages, for example.

+ seth

--
Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
http://bioconductor.org



From smckinney at bccrc.ca  Tue Oct 17 20:42:59 2006
From: smckinney at bccrc.ca (Steven McKinney)
Date: Tue, 17 Oct 2006 11:42:59 -0700
Subject: [Rd] boxplot, notches, etc.
References: <452ACA95.9010606@zoo.ufl.edu>
	<loom.20061017T150813-982@post.gmane.org>
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0235F936@crcmail1.BCCRC.CA>

Hi Ben,

I like the odd looking notches, they reveal
that the data comprising the box plot need 
more careful review.

Tukey et al (1) comment that
"It should be noted that the convention has been
adopted that, should the notch lie outside either
hinge, an unnotched box, plotted with dashed lines,
is displayed for that group indicating low confidence
in it."
While this convention appears to have been abandoned,
the wierd-looking notches indicate a group with odd
behaviour warranting more careful consideration.

So I vote to retain odd-looking notches.

Et al and Tukey (1) discuss their reasoning and empirical findings
as to the formulation for the notch width.  They used
median +/- 1.7(1.25R/1.35sqrt(N)) which reduces to
median +/- 1.574*(IQR)/sqrt(N)

Perhaps similar reasoning can resolve the issue of
notches for boxplots of log(y)?
I'll see if I can work through the normal - lognormal
transformation machinery and propose a reasonable
notch strategy for the log(y) case.  Maybe someone
out there has already done so?


(1) R. McGill, J. Tukey, W. Larsen (1978) "Variations of Box Plots"
The American Statistician, Vol. 32, No. 1, pp 12-16
http://www.jstor.org/view/00031305/di020553/02p0045u/0

Cheers

Steven McKinney

Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre

email: smckinney at bccrc.ca

tel: 604-675-8000 x7561

BCCRC
Molecular Oncology
675 West 10th Ave, Floor 4
Vancouver B.C. 
V5Z 1L3
Canada




-----Original Message-----
From: r-devel-bounces at r-project.org on behalf of Ben Bolker
Sent: Tue 10/17/2006 6:09 AM
To: r-devel at stat.math.ethz.ch
Subject: Re: [Rd] boxplot, notches, etc.
 
Ben Bolker <bolker <at> zoo.ufl.edu> writes:

> 
>   Synopsis: boxplot notches look weird when notches
> are greater than hinges ((1.58*IQR/sqrt(n)) > approx IQR).
> When log="y" this causes an error.  Below are several
> reproducible examples, some discussion, and a patch against
> calc.R.
> 
>   Please feel free to say "this is just cosmetic/isn't an issue, go
> away" ...
> 
>   cheers
>     Ben Bolker
> 

  followup (one week later): does anyone have any
opinions on this ... ???  (If someone will tell
me this isn't worth pursuing, I will give up on it)

    Ben Bolker

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel



From simon.urbanek at r-project.org  Tue Oct 17 20:43:31 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 17 Oct 2006 14:43:31 -0400
Subject: [Rd] [R] performance reflections
In-Reply-To: <797664590610160829v25648887w1956a31d47d55aa5@mail.gmail.com>
References: <797664590610160635n2b5cac70s44c76b53b2a66d3@mail.gmail.com>
	<68C111EF-B010-43B9-9FDA-418816611654@r-project.org>
	<797664590610160829v25648887w1956a31d47d55aa5@mail.gmail.com>
Message-ID: <2679D302-A4C6-4700-82EF-540E925165C9@r-project.org>

[This is a follow up on gcc3 vs. gcc4 discussion. Background: R  
benchmark tests ( http://www.sciviews.org/benchmark/index.html ) show  
a dramatic difference in "Escoufier's method on a 37x37 matrix  
(mixed)" test when comparing binaries for PowerPC compiled with gcc3  
vs gcc4.]

On Oct 16, 2006, at 11:29 AM, Ren? J.V. Bertin wrote:

> Anyway, it has nothing to do with the G4 optimisations, as the  
> generic 2.4.0 on CRAN also shows the same performance drop.
>

Thanks for the example. I think I have a clarification on this. On a  
higher level it's happening in "do_cov", but the underlying issue is  
the use of "long double" computations. First the results:

The timings I get (on 2xG5 2.7GHz) are:

gcc3: 0.8s
gcc4: 4.5s (dynamic libgcc)
gcc4: 4.2s (static libgcc)

Basically any calls that use long double will be affected:
qadd: 4.5s (gcc3 opt), 6.7s (Agcc4 opt), 7.4s (gcc3), 7.9s (gcc4 opt 
+dyngcc), 10.5s (Agcc4), 10.6s (gcc4 dyngcc)

(this test basically runs 500x 1M long double additions on an array -  
it's even more extreme if you run it on short arrays : 250kx1k will  
give 2s on gcc3 and 7.7s on gcc4)

Now, the actual reason is that gcc3 simply ignores "long double" and  
performs all computation using regular double precision (sizeof(long  
double)=8 in gcc3 and 16 in gcc4). What this means is that you lose  
precision in gcc3. To illustrate the impact, changing "long double"  
to "double" in gcc4 will bring the 250kx1k test down from 7.7s to  
2.1s which is almost the same as gcc3.

Thus, restricting R to double computations I get for the 37x37 test  
with gcc 4.0.3:
gcc4nld: 0.7s
which is actually even faster than the gcc3 result.

Attached you will find the R benchmarks 2.3 results (ran with R  
2.4.0) - there is pretty much no difference between the binaries  
except for the 37x37 test and the explanation is above.

Cheers,
Simon


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: rbench24.txt
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061017/e2067bcc/attachment-0004.txt 

From bolker at zoo.ufl.edu  Wed Oct 18 00:54:18 2006
From: bolker at zoo.ufl.edu (bolker at zoo.ufl.edu)
Date: Wed, 18 Oct 2006 00:54:18 +0200 (CEST)
Subject: [Rd] plotting text with very small negative rotation hangs (PR#9301)
Message-ID: <20061017225418.465522477D@slim.kubism.ku.dk>

This is an OpenPGP/MIME signed message (RFC 2440 and 3156)
--------------enig308510A16A445880F353C5C9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable


to trigger the bug:

plot(0:1,0:1)
text(0.5,0.5,"abc",srt=3D-1e-9)

this doesn't happen for positive, small srt,
or for negative srt with magnitude greater
than about 1e-8 (the example in plot.phylo
in the ape package triggers it, with a
srt value of -3e-15).

plot(0:1,0:1)
for (i in 1:10) {
  cat(i,"\n")
  text(0.5,0.5,"hello",srt=3D(-10^-i))
}

  I have traced this a fair ways into
the C code -- I think it happens somewhere
in clipText -- but I'm not sure.  Sorry not
to be able to provide a fix at the moment.

  This is on Ubuntu 6.06, not sure whether
it affects other platforms or not ...

  Ben Bolker

> version
               _
platform       i686-pc-linux-gnu
arch           i686
os             linux-gnu
system         i686, linux-gnu
status
major          2
minor          4.0
year           2006
month          10
day            03
svn rev        39566
language       R
version.string R version 2.4.0 (2006-10-03)


--------------enig308510A16A445880F353C5C9
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFFNV75c5UpGjwzenMRAhu9AKCVHQ3khVCj1skWyn8wCHl2w0nkbQCfdct5
zehYhcbw2bazsjuTvX9eAIk=
=CL1h
-----END PGP SIGNATURE-----

--------------enig308510A16A445880F353C5C9--



From sfalcon at fhcrc.org  Wed Oct 18 01:02:15 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Tue, 17 Oct 2006 16:02:15 -0700
Subject: [Rd] Caching bug with showMethods?
Message-ID: <m2ac3uv954.fsf@ziti.local>

showMethods isn't reporting inherited methods when it is first
called.  The methods are there and after calling them, showMethods
gives the right output.

Here is an example (using R-devel r39647):

setClass("A", representation(x="numeric"),
         prototype=list(x=1))

setClass("B", contains="A",
         prototype=list(x=2))

setMethod("initialize", "A",
          function(.Object) {
              cat("In A's init\n")
              .Object at x <- .Object at x + 1
              .Object
          })

setMethod("show", "A",
          function(object) cat("An A like thing. x =", object at x, "\n"))

showMethods(classes="B")  ## should give output, but doesn't
showMethods(classes="A")

aa <- new("A")
bb <- new("B")

aa
bb

## Now it will give output
showMethods(classes="B")




--
+ seth



From bolker at zoo.ufl.edu  Wed Oct 18 01:24:39 2006
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue, 17 Oct 2006 23:24:39 +0000 (UTC)
Subject: [Rd] plotting text with very small negative rotation hangs
	(PR#9301)
References: <20061017225418.465522477D@slim.kubism.ku.dk>
Message-ID: <loom.20061018T012340-115@post.gmane.org>

 <bolker <at> zoo.ufl.edu> writes:


> to trigger the bug:
> 
> plot(0:1,0:1)
> text(0.5,0.5,"abc",srt=-1e-9)
> 
> this doesn't happen for positive, small srt,
> or for negative srt with magnitude greater
> than about 1e-8 (the example in plot.phylo
> in the ape package triggers it, with a
> srt value of -3e-15).
> 
> plot(0:1,0:1)
> for (i in 1:10) {
>   cat(i,"\n")
>   text(0.5,0.5,"hello",srt=(-10^-i))
> }
> 
>
  There were some "3D"s inserted after
the equals signs.  I don't know what that
is -- some kind of encoding issue ... ??
 
   sorry 'bout that

  Ben Bolker



From simon.urbanek at r-project.org  Wed Oct 18 02:08:20 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 17 Oct 2006 20:08:20 -0400
Subject: [Rd] Error condition in evaluating a promise
Message-ID: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>

Is there a way to raise an error condition when a promise is  
evaluated such that is can be evaluated again? Right now strange  
things happen when the evaluation fails:

 > delayedAssign("x", if (failed) stop("you have to initialize me  
first!") else foo)
 > foo <- "I'm foo"
 > failed<-TRUE
 > x
Error: you have to initialize me first!
 > x
Error: recursive default argument reference

^^-- from now on x is completely unusable - it has no value (i.e.  
cannot be passed to any function) and yet won't be evaluated again

 > failed<-FALSE
 > x
Error: recursive default argument reference
 > delayedAssign("x", if (failed) stop("you have to initialize me  
first!") else foo)
 > x
[1] "I'm foo"

I'd expect something like
 > failed<-TRUE
 > x
Error: you have to initialize me first!
 > x
Error: you have to initialize me first!
 > failed<-FALSE
 > x
[1] "I'm foo"

Is there a way to achieve that? Intuitively I'd think that this is  
the desired behavior, because currently the promise is sort of  
'broken' after an error (AFAICT the behavior is not documented  
anywhere) - but then, I wasn't messing with promises until now...

Thanks,
Simon



From mtmorgan at fhcrc.org  Wed Oct 18 02:33:33 2006
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 17 Oct 2006 17:33:33 -0700
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org> (Simon
	Urbanek's message of "Tue, 17 Oct 2006 20:08:20 -0400")
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
Message-ID: <6phvemixy1u.fsf@gopher4.fhcrc.org>

> delayMe <- function() {
+     if (failed) {
+         delayedAssign("x", delayMe(), assign.env=topenv())
+         stop("init me!")
+     } else foo
+ }
> 
> failed <- TRUE
> foo <- "is me"
> delayedAssign("x", delayMe())
> x
Error in delayMe() : init me!
> x
Error in delayMe() : init me!
> failed <- FALSE
> x
[1] "is me"

??

Martin

Simon Urbanek <simon.urbanek at r-project.org> writes:

> Is there a way to raise an error condition when a promise is  
> evaluated such that is can be evaluated again? Right now strange  
> things happen when the evaluation fails:
>
>  > delayedAssign("x", if (failed) stop("you have to initialize me  
> first!") else foo)
>  > foo <- "I'm foo"
>  > failed<-TRUE
>  > x
> Error: you have to initialize me first!
>  > x
> Error: recursive default argument reference
>
> ^^-- from now on x is completely unusable - it has no value (i.e.  
> cannot be passed to any function) and yet won't be evaluated again
>
>  > failed<-FALSE
>  > x
> Error: recursive default argument reference
>  > delayedAssign("x", if (failed) stop("you have to initialize me  
> first!") else foo)
>  > x
> [1] "I'm foo"
>
> I'd expect something like
>  > failed<-TRUE
>  > x
> Error: you have to initialize me first!
>  > x
> Error: you have to initialize me first!
>  > failed<-FALSE
>  > x
> [1] "I'm foo"
>
> Is there a way to achieve that? Intuitively I'd think that this is  
> the desired behavior, because currently the promise is sort of  
> 'broken' after an error (AFAICT the behavior is not documented  
> anywhere) - but then, I wasn't messing with promises until now...
>
> Thanks,
> Simon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin T. Morgan
Bioconductor / Computational Biology
http://bioconductor.org



From p.murrell at auckland.ac.nz  Wed Oct 18 02:51:43 2006
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Wed, 18 Oct 2006 13:51:43 +1300
Subject: [Rd] plotting text with very small negative rotation hangs
	(PR#9301)
In-Reply-To: <20061017225418.465522477D@slim.kubism.ku.dk>
References: <20061017225418.465522477D@slim.kubism.ku.dk>
Message-ID: <45357A9F.9020000@stat.auckland.ac.nz>

Hi


bolker at zoo.ufl.edu wrote:
> This is an OpenPGP/MIME signed message (RFC 2440 and 3156)
> --------------enig308510A16A445880F353C5C9
> Content-Type: text/plain; charset=ISO-8859-1
> Content-Transfer-Encoding: quoted-printable
> 
> 
> to trigger the bug:
> 
> plot(0:1,0:1)
> text(0.5,0.5,"abc",srt=3D-1e-9)
> 
> this doesn't happen for positive, small srt,
> or for negative srt with magnitude greater
> than about 1e-8 (the example in plot.phylo
> in the ape package triggers it, with a
> srt value of -3e-15).
> 
> plot(0:1,0:1)
> for (i in 1:10) {
>   cat(i,"\n")
>   text(0.5,0.5,"hello",srt=3D(-10^-i))
> }
> 
>   I have traced this a fair ways into
> the C code -- I think it happens somewhere
> in clipText -- but I'm not sure.  Sorry not
> to be able to provide a fix at the moment.


I can confirm a (ridiculously) long pause on CentOS.  Tracing deeper
into C code, it appears to be a loop in XmbRotCreateTextItem() in
rotate.c, which misses an important case when setting up loop
parameters.  I have committed a fix to r-devel which solves the problem
for the example above.

Paul


>   This is on Ubuntu 6.06, not sure whether
> it affects other platforms or not ...
> 
>   Ben Bolker
> 
>> version
>                _
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status
> major          2
> minor          4.0
> year           2006
> month          10
> day            03
> svn rev        39566
> language       R
> version.string R version 2.4.0 (2006-10-03)
> 
> 
> --------------enig308510A16A445880F353C5C9
> Content-Type: application/pgp-signature; name="signature.asc"
> Content-Description: OpenPGP digital signature
> Content-Disposition: attachment; filename="signature.asc"
> 
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.2.2 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
> 
> iD8DBQFFNV75c5UpGjwzenMRAhu9AKCVHQ3khVCj1skWyn8wCHl2w0nkbQCfdct5
> zehYhcbw2bazsjuTvX9eAIk=
> =CL1h
> -----END PGP SIGNATURE-----
> 
> --------------enig308510A16A445880F353C5C9--
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/



From simon.urbanek at r-project.org  Wed Oct 18 03:20:06 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 17 Oct 2006 21:20:06 -0400
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <6phvemixy1u.fsf@gopher4.fhcrc.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
Message-ID: <1BF71ED7-1F46-43F3-83BE-D353FC410BA6@r-project.org>


On Oct 17, 2006, at 8:33 PM, Martin Morgan wrote:

>> delayMe <- function() {
> +     if (failed) {
> +         delayedAssign("x", delayMe(), assign.env=topenv())
> +         stop("init me!")
> +     } else foo
> + }
>>
>> failed <- TRUE
>> foo <- "is me"
>> delayedAssign("x", delayMe())
>> x
> Error in delayMe() : init me!
>> x
> Error in delayMe() : init me!
>> failed <- FALSE
>> x
> [1] "is me"
>
> ??
>

This works only because you assigned both x and the delayMe function  
to the global environment. This won't work in any other case (and no,  
I didn't want to use this in the global environment - you shouldn't  
be trashing it anyway ;)).

Of course you can recursively re-install the promise, but that's  
beside the point.
FWIW a general solution re-installing the promise could look like this:
local({ ae<-parent.env(environment()); d<-function() {print 
(environment()); if(failed) { delayedAssign("x", d(), assign.env=ae);  
stop("init me!") } else foo}; delayedAssign("x", d(),assign.env=ae)})

However in my particular case the whole point of using a promise is  
that I'm dealing with a sealed environment (namespace) so you cannot  
re-install delayedAssign again (it will fail because the binding is  
locked). If the promise worked as I envision, re-installing  
delayedAssign would be unnecessary, because the promise is already in  
place and will stay there until the evaluation is successful.

Cheers,
Simon

> Simon Urbanek <simon.urbanek at r-project.org> writes:
>
>> Is there a way to raise an error condition when a promise is
>> evaluated such that is can be evaluated again? Right now strange
>> things happen when the evaluation fails:
>>
>>> delayedAssign("x", if (failed) stop("you have to initialize me
>> first!") else foo)
>>> foo <- "I'm foo"
>>> failed<-TRUE
>>> x
>> Error: you have to initialize me first!
>>> x
>> Error: recursive default argument reference
>>
>> ^^-- from now on x is completely unusable - it has no value (i.e.
>> cannot be passed to any function) and yet won't be evaluated again
>>
>>> failed<-FALSE
>>> x
>> Error: recursive default argument reference
>>> delayedAssign("x", if (failed) stop("you have to initialize me
>> first!") else foo)
>>> x
>> [1] "I'm foo"
>>
>> I'd expect something like
>>> failed<-TRUE
>>> x
>> Error: you have to initialize me first!
>>> x
>> Error: you have to initialize me first!
>>> failed<-FALSE
>>> x
>> [1] "I'm foo"
>>
>> Is there a way to achieve that? Intuitively I'd think that this is
>> the desired behavior, because currently the promise is sort of
>> 'broken' after an error (AFAICT the behavior is not documented
>> anywhere) - but then, I wasn't messing with promises until now...
>>
>> Thanks,
>> Simon
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> -- 
> Martin T. Morgan
> Bioconductor / Computational Biology
> http://bioconductor.org
>
>



From nakama at ki.rim.or.jp  Wed Oct 18 05:24:45 2006
From: nakama at ki.rim.or.jp (Ei-ji Nakama)
Date: Wed, 18 Oct 2006 12:24:45 +0900
Subject: [Rd] [R] crush in edit()
In-Reply-To: <935872030610170845w54095f7dg3acc01de99b79153@mail.gmail.com>
References: <935872030610170845w54095f7dg3acc01de99b79153@mail.gmail.com>
Message-ID: <dc41e1260610172024t59a59886hea5b2823cdb373ba@mail.gmail.com>

It is a problem by stack smashing protector.
--- src/modules/X11/dataentry.c.orig    2006-09-04 23:41:34.000000000 +0900
+++ src/modules/X11/dataentry.c 2006-10-18 11:31:43.000000000 +0900
@@ -1046,7 +1046,7 @@
            for(j=0;*(wcspc+j)!=L'\0';j++)wcs[j]=*(wcspc+j);
            wcs[j]=L'\0';
            w_p=wcs;
-           cnt=wcsrtombs(s,(const wchar_t **)&w_p,sizeof(wcs),NULL);
+           cnt=wcsrtombs(s,(const wchar_t **)&w_p,sizeof(s)-1,NULL);
            s[cnt]='\0';
             if (textwidth(s, strlen(s)) < (bw - text_offset)) break;
             *(++wcspc) = L'<';
@@ -1056,7 +1056,7 @@
            for(j=0;*(wcspc+j)!=L'\0';j++)wcs[j]=*(wcspc+j);
            wcs[j]=L'\0';
            w_p=wcs;
-           cnt=wcsrtombs(s,(const wchar_t **)&w_p,sizeof(wcs),NULL);
+           cnt=wcsrtombs(s,(const wchar_t **)&w_p,sizeof(s)-1,NULL);
            s[cnt]='\0';
             if (textwidth(s, strlen(s)) < (bw - text_offset)) break;
             *(wcspbuf + i - 2) = L'>';
@@ -1066,7 +1066,7 @@
     for(j=0;*(wcspc+j)!=L'\0';j++) wcs[j]=*(wcspc+j);
     wcs[j]=L'\0';
     w_p=wcs;
-    cnt=wcsrtombs(s,(const wchar_t **)&w_p,sizeof(wcs),NULL);
+    cnt=wcsrtombs(s,(const wchar_t **)&w_p,sizeof(s)-1,NULL);

     drawtext(x_pos + text_offset, y_pos + box_h - text_offset, s, cnt);

@@ -2398,6 +2398,7 @@
     int cnt;
     char last_mbs[8];
     char *mbs;
+    size_t bytes;

     mbs = (str == NULL) ? buf : str;

@@ -2411,8 +2412,8 @@
     if(wcs[0] == L'\0') return 0;

     memset(last_mbs, 0, sizeof(last_mbs));
-    wcrtomb(last_mbs, wcs[cnt-1], &mb_st);
-    return(strlen(last_mbs));
+    bytes=wcrtomb(last_mbs, wcs[cnt-1], &mb_st); /* -Wall */
+    return(bytes);
 #else
     return(1);
 #endif


2006/10/18, crazybuddy Vincent <crazyvincent at gmail.com>:
> Dear all,
>
> I am new to R system. When I tried to edit data read from a csv file, R
> system crushed, I got an error message as follows:
>
> > edit(data)
> *** buffer overflow detected ***: /usr/lib/R/bin/exec/R terminated
> ======= Backtrace: =========
> /lib/libc.so.6(__chk_fail+0x41)[0x49d020b1]
> /lib/libc.so.6[0x49d034a2]
> /usr/lib/R/modules//R_X11.so[0x33ed7a]
> /usr/lib/R/modules//R_X11.so[0x34050d]
> /usr/lib/R/modules//R_X11.so[0x341858]
> /usr/lib/R/modules//R_X11.so(RX11_dataentry+0xa25)[0x342f45]
> /usr/lib/R/lib/libR.so[0xa34675]
> /usr/lib/R/lib/libR.so[0x954ed6]
> /usr/lib/R/lib/libR.so(Rf_eval+0x483)[0x925b23]
> /usr/lib/R/lib/libR.so[0x929ed8]
> /usr/lib/R/lib/libR.so(Rf_eval+0x483)[0x925b23]
> /usr/lib/R/lib/libR.so[0x926a37]
> /usr/lib/R/lib/libR.so(Rf_eval+0x483)[0x925b23]
> /usr/lib/R/lib/libR.so(Rf_applyClosure+0x2a7)[0x928117]
> /usr/lib/R/lib/libR.so[0x95661f]
> /usr/lib/R/lib/libR.so(Rf_usemethod+0x609)[0x957a89]
> /usr/lib/R/lib/libR.so[0x95825e]
> /usr/lib/R/lib/libR.so(Rf_eval+0x483)[0x925b23]
> /usr/lib/R/lib/libR.so(Rf_applyClosure+0x2a7)[0x928117]
> /usr/lib/R/lib/libR.so(Rf_eval+0x2f4)[0x925994]
> /usr/lib/R/lib/libR.so(Rf_ReplIteration+0x311)[0x945361]
> /usr/lib/R/lib/libR.so[0x945571]
> /usr/lib/R/lib/libR.so(run_Rmainloop+0x60)[0x9458c0]
> /usr/lib/R/lib/libR.so(Rf_mainloop+0x1c)[0x9458ec]
> /usr/lib/R/bin/exec/R(main+0x46)[0x80486f6]
> /lib/libc.so.6(__libc_start_main+0xdc)[0x49c3b4e4]
> /usr/lib/R/bin/exec/R[0x80485f1]
> ======= Memory map: ========
> 00111000-0012f000 r-xp 00000000 fd:00 16943095
> /usr/lib/R/library/grDevices/libs/grDevices.so
> 0012f000-00130000 rwxp 0001d000 fd:00 16943095
> /usr/lib/R/library/grDevices/libs/grDevices.so
> 00130000-00181000 r-xp 00000000 fd:00 16976568
> /usr/lib/R/library/stats/libs/stats.so
> 00181000-00183000 rwxp 00051000 fd:00 16976568
> /usr/lib/R/library/stats/libs/stats.so
> 00339000-00352000 r-xp 00000000 fd:00 15959326   /usr/lib/R/modules/R_X11.so
> 00352000-00353000 rwxp 00018000 fd:00 15959326   /usr/lib/R/modules/R_X11.so
> 00353000-0035f000 rwxp 00353000 00:00 0
> 00480000-00496000 r-xp 00000000 fd:00 15303387   /usr/lib/gconv/SJIS.so
> 00496000-00498000 rwxp 00015000 fd:00 15303387   /usr/lib/gconv/SJIS.so
> 0056e000-00598000 r-xp 00000000 fd:00 16452204   /usr/lib/R/lib/libRblas.so
> 00598000-00599000 rwxp 00029000 fd:00 16452204   /usr/lib/R/lib/libRblas.so
> 00848000-00851000 r-xp 00000000 fd:00 15204401   /lib/libnss_files-2.4.so
> 00851000-00852000 r-xp 00008000 fd:00 15204401   /lib/libnss_files-2.4.so
> 00852000-00853000 rwxp 00009000 fd:00 15204401   /lib/libnss_files-2.4.so
> 00885000-00abd000 r-xp 00000000 fd:00 16452203   /usr/lib/R/lib/libR.so
> 00abd000-00aca000 rwxp 00238000 fd:00 16452203   /usr/lib/R/lib/libR.so
> 00aca000-00b61000 rwxp 00aca000 00:00 0
> 00c47000-00c4d000 r-xp 00000000 fd:00 16944203
> /usr/lib/R/library/methods/libs/methods.so
> 00c4d000-00c4e000 rwxp 00005000 fd:00 16944203
> /usr/lib/R/library/methods/libs/methods.so
> 00eb6000-00f31000 r-xp 00000000 fd:00 15242987
> /usr/lib/libgfortran.so.1.0.0
> 00f31000-00f32000 rwxp 0007b000 fd:00 15242987
> /usr/lib/libgfortran.so.1.0.0
> 00f44000-00f45000 r-xp 00000000 fd:00 15303344   /usr/lib/gconv/ISO8859-1.so
> 00f45000-00f47000 rwxp 00000000 fd:00 15303344   /usr/lib/gconv/ISO8859-1.so
> 08048000-08049000 r-xp 00000000 fd:00 15796032   /usr/lib/R/bin/exec/R
> 08049000-0804a000 rwxp 00000000 fd:00 15796032   /usr/lib/R/bin/exec/R
> 09ef7000-0af9f000 rwxp 09ef7000 00:00 0          [heap]
> 49c08000-49c09000 r-xp 49c08000 00:00 0          [vdso]
> 49c09000-49c22000 r-xp 00000000 fd:00 15206828   /lib/ld-2.4.so
> 49c22000-49c23000 r-xp 00018000 fd:00 15206828   /lib/ld-2.4.so
> 49c23000-49c24000 rwxp 00019000 fd:00 15206828   /lib/ld-2.4.so
> 49c26000-49d53000 r-xp 00000000 fd:00 15206829   /lib/libc-2.4.so
> 49d53000-49d55000 r-xp 0012d000 fd:00 15206829   /lib/libc-2.4.so
> 49d55000-49d56000 rwxp 0012f000 fd:00 15206829   /lib/libc-2.4.so
> 49d56000-49d59000 rwxp 49d56000 00:00 0
> 49d5b000-49d7e000 r-xp 00000000 fd:00 15206830   /lib/libm-2.4.so
> 49d7e000-49d7f000 r-xp 00022000 fd:00 15206830   /lib/libm-2.4.so
> 49d7f000-49d80000 rwxp 00023000 fd:00 15206830   /lib/libm-2.4.so
> 49d82000-49d84000 r-xp 00000000 fd:00 15206831   /lib/libdl-2.4.so
> 49d84000-49d85000 r-xp 00001000 fd:00 15206831   /Aborted
>
> I am using R 2.4.0 i386 on Fedora core 5, any one please help me on this?
>
> Thank you very much.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>
>


-- 
EI-JI Nakama  <nakama at ki.rim.or.jp>
"\u4e2d\u9593\u6804\u6cbb"  <nakama at ki.rim.or.jp>



From mtmorgan at fhcrc.org  Wed Oct 18 05:43:52 2006
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 17 Oct 2006 20:43:52 -0700
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <6phvemixy1u.fsf@gopher4.fhcrc.org> (Martin Morgan's message of
	"Tue, 17 Oct 2006 17:33:33 -0700")
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
Message-ID: <6phvemiuw3r.fsf@gopher4.fhcrc.org>

I believe the technique is to create an environment in the namespace,
and then to access that through functions:

sandbox/NAMESPACE
export(getx, setx)

sandbox/R/sandbox.R:

sandbox <- new.env(parent=emptyenv())
getx <- function() sandbox$x
setx <- function(val) sandbox$x <- val

> library(sandbox)
> environmentIsLocked(getNamespace("sandbox"))
[1] "TRUE"
> getx()
NULL
> setx(2)
> getx()
[1] 2

or otherwise:

> sbox <- sandbox:::sandbox
> sbox$x <- 3
> getx()
[1] 3
> sbox$y <- 4
> sbox$y
[1] 4

I think this works with delayedAssign.

> delayedAssign("z", { cat("hi\n"); 2}, assign.env=sbox)
> sbox$z
hi
[1] 2
> sbox$z
[1] 2

Martin


Martin Morgan <mtmorgan at fhcrc.org> writes:

>> delayMe <- function() {
> +     if (failed) {
> +         delayedAssign("x", delayMe(), assign.env=topenv())
> +         stop("init me!")
> +     } else foo
> + }
>> 
>> failed <- TRUE
>> foo <- "is me"
>> delayedAssign("x", delayMe())
>> x
> Error in delayMe() : init me!
>> x
> Error in delayMe() : init me!
>> failed <- FALSE
>> x
> [1] "is me"
>
> ??
>
> Martin
>
> Simon Urbanek <simon.urbanek at r-project.org> writes:
>
>> Is there a way to raise an error condition when a promise is  
>> evaluated such that is can be evaluated again? Right now strange  
>> things happen when the evaluation fails:
>>
>>  > delayedAssign("x", if (failed) stop("you have to initialize me  
>> first!") else foo)
>>  > foo <- "I'm foo"
>>  > failed<-TRUE
>>  > x
>> Error: you have to initialize me first!
>>  > x
>> Error: recursive default argument reference
>>
>> ^^-- from now on x is completely unusable - it has no value (i.e.  
>> cannot be passed to any function) and yet won't be evaluated again
>>
>>  > failed<-FALSE
>>  > x
>> Error: recursive default argument reference
>>  > delayedAssign("x", if (failed) stop("you have to initialize me  
>> first!") else foo)
>>  > x
>> [1] "I'm foo"
>>
>> I'd expect something like
>>  > failed<-TRUE
>>  > x
>> Error: you have to initialize me first!
>>  > x
>> Error: you have to initialize me first!
>>  > failed<-FALSE
>>  > x
>> [1] "I'm foo"
>>
>> Is there a way to achieve that? Intuitively I'd think that this is  
>> the desired behavior, because currently the promise is sort of  
>> 'broken' after an error (AFAICT the behavior is not documented  
>> anywhere) - but then, I wasn't messing with promises until now...
>>
>> Thanks,
>> Simon
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> -- 
> Martin T. Morgan
> Bioconductor / Computational Biology
> http://bioconductor.org
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin T. Morgan
Bioconductor / Computational Biology
http://bioconductor.org



From ripley at stats.ox.ac.uk  Wed Oct 18 10:15:16 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 18 Oct 2006 09:15:16 +0100 (BST)
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <1BF71ED7-1F46-43F3-83BE-D353FC410BA6@r-project.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
	<1BF71ED7-1F46-43F3-83BE-D353FC410BA6@r-project.org>
Message-ID: <Pine.LNX.4.64.0610180856450.10475@gannet.stats.ox.ac.uk>

As is clear from the message you got, promises were originally implemented 
to handle lazy evaluation of closure arguments, as essentially transient 
objects.  There are several aspects of their implementation that are 
tailored to that use, one being that they can only be evaluated once (as a 
loop-detection test).

There is very little documentation on promises, mainly I believe because 
their use at R level is not encouraged.  There is documentation at C level 
in the R-ints.texi manual, including statements that make it clear that 
they can only be evaluated once.  Simple questions like exactly when a 
promise gets evaluated still don't have precise documented answers (and 
indeed we keep on finding errors in the code when they needed to be 
evaluated and were not).

I am not sure what you are really trying to do here: your example is very 
simple and does not (I guess) indicate the real application.  It is 
possible we could change the semantics only to stop re-evaluation during 
evaluation, and set a different flag on successful evaluation.

On Tue, 17 Oct 2006, Simon Urbanek wrote:

>
> On Oct 17, 2006, at 8:33 PM, Martin Morgan wrote:
>
>>> delayMe <- function() {
>> +     if (failed) {
>> +         delayedAssign("x", delayMe(), assign.env=topenv())
>> +         stop("init me!")
>> +     } else foo
>> + }
>>>
>>> failed <- TRUE
>>> foo <- "is me"
>>> delayedAssign("x", delayMe())
>>> x
>> Error in delayMe() : init me!
>>> x
>> Error in delayMe() : init me!
>>> failed <- FALSE
>>> x
>> [1] "is me"
>>
>> ??
>>
>
> This works only because you assigned both x and the delayMe function
> to the global environment. This won't work in any other case (and no,
> I didn't want to use this in the global environment - you shouldn't
> be trashing it anyway ;)).
>
> Of course you can recursively re-install the promise, but that's
> beside the point.
> FWIW a general solution re-installing the promise could look like this:
> local({ ae<-parent.env(environment()); d<-function() {print
> (environment()); if(failed) { delayedAssign("x", d(), assign.env=ae);
> stop("init me!") } else foo}; delayedAssign("x", d(),assign.env=ae)})
>
> However in my particular case the whole point of using a promise is
> that I'm dealing with a sealed environment (namespace) so you cannot
> re-install delayedAssign again (it will fail because the binding is
> locked). If the promise worked as I envision, re-installing
> delayedAssign would be unnecessary, because the promise is already in
> place and will stay there until the evaluation is successful.
>
> Cheers,
> Simon
>
>> Simon Urbanek <simon.urbanek at r-project.org> writes:
>>
>>> Is there a way to raise an error condition when a promise is
>>> evaluated such that is can be evaluated again? Right now strange
>>> things happen when the evaluation fails:
>>>
>>>> delayedAssign("x", if (failed) stop("you have to initialize me
>>> first!") else foo)
>>>> foo <- "I'm foo"
>>>> failed<-TRUE
>>>> x
>>> Error: you have to initialize me first!
>>>> x
>>> Error: recursive default argument reference
>>>
>>> ^^-- from now on x is completely unusable - it has no value (i.e.
>>> cannot be passed to any function) and yet won't be evaluated again
>>>
>>>> failed<-FALSE
>>>> x
>>> Error: recursive default argument reference
>>>> delayedAssign("x", if (failed) stop("you have to initialize me
>>> first!") else foo)
>>>> x
>>> [1] "I'm foo"
>>>
>>> I'd expect something like
>>>> failed<-TRUE
>>>> x
>>> Error: you have to initialize me first!
>>>> x
>>> Error: you have to initialize me first!
>>>> failed<-FALSE
>>>> x
>>> [1] "I'm foo"
>>>
>>> Is there a way to achieve that? Intuitively I'd think that this is
>>> the desired behavior, because currently the promise is sort of
>>> 'broken' after an error (AFAICT the behavior is not documented
>>> anywhere) - but then, I wasn't messing with promises until now...
>>>
>>> Thanks,
>>> Simon
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> --
>> Martin T. Morgan
>> Bioconductor / Computational Biology
>> http://bioconductor.org
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From georgi at molgen.mpg.de  Wed Oct 18 11:15:07 2006
From: georgi at molgen.mpg.de (Benjamin Georgi)
Date: Wed, 18 Oct 2006 11:15:07 +0200
Subject: [Rd] Automatic C wrapper generation
Message-ID: <4535F09B.2010003@molgen.mpg.de>

Hi,

I'm looking into creating R bindings for a medium sized C library. I 
have read up on how to access simple C functions using the .C and .Call 
methods and what I'm looking for now is a way to automate the generation 
of the necessary glue code.

Ideal would be a SWIG-like package that does most of the leg work of the 
interface generation for R.

Any tips or suggestions in that regard would be appreciated.

Best,
Benjamin


---
  Benjamin Georgi
  Max-Planck-Institute for Molecular Genetics
  Computational Molecular Biology
---
  Ihnestrasse 73                       mail: georgi at molgen.mpg.de
  D-14195 Berlin, Germany              phone: +49-30-8413-1146



From edd at debian.org  Wed Oct 18 12:13:29 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 18 Oct 2006 05:13:29 -0500
Subject: [Rd] Automatic C wrapper generation
In-Reply-To: <4535F09B.2010003@molgen.mpg.de>
References: <4535F09B.2010003@molgen.mpg.de>
Message-ID: <17717.65097.345368.804829@basebud.nulle.part>


On 18 October 2006 at 11:15, Benjamin Georgi wrote:
| I'm looking into creating R bindings for a medium sized C library. I 
| have read up on how to access simple C functions using the .C and .Call 
| methods and what I'm looking for now is a way to automate the generation 
| of the necessary glue code.
| 
| Ideal would be a SWIG-like package that does most of the leg work of the 
| interface generation for R.

Swig 1.3.30 will have basic R support. You can check it out from their CVS.
I haven't used it yet so I do not know how far this will get you.

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From ulrich.beutner at kssg.ch  Wed Oct 18 12:21:54 2006
From: ulrich.beutner at kssg.ch (ulrich.beutner at kssg.ch)
Date: Wed, 18 Oct 2006 12:21:54 +0200 (CEST)
Subject: [Rd] survdiff Mac binary in Survival pckg (PR#9302)
Message-ID: <20061018102154.EE8C9561AF@slim.kubism.ku.dk>

Full_Name: Ulrich Beutner
Version: 2.4.0
OS: MacOS 10.4 (PPC G4)
Submission from: (NULL) (193.134.32.99)


It appears that there is bug in the Macintosh binary of survdiff (part of
survival library)
Following the output of the example for survdiff under Windows XP and
Macintosh.
While under WinXP correct Chisquare and P values are reported, in the Mac
Version Chisquare is 0 (also with other datasets) and as a consquence P is
always 1.

(all programs downloaded and installed on Oct18, 2006, thus I guess I used the
most current version in all cases)


Windows XP

> survdiff(Surv(futime, fustat) ~ rx,data=ovarian)
Call:
survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)

      N Observed Expected (O-E)^2/E (O-E)^2/V
rx=1 13        7     5.23     0.596      1.06
rx=2 13        5     6.77     0.461      1.06

 Chisq= 1.1  on 1 degrees of freedom, p= 0.303


        ^^^^ what it should be       ^^^^^^^^  


Macintosh

> survdiff(Surv(futime, fustat) ~ rx,data=ovarian)
Call:
survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)

      N Observed Expected (O-E)^2/E (O-E)^2/V
rx=1 13        7     5.23     0.596      1.06
rx=2 13        5     6.77     0.461      1.06

 Chisq= 0  on 1 degrees of freedom, p= 1 

   ^^^^^^      Incorrect data      ^^^^^^



From jmc at r-project.org  Wed Oct 18 15:31:21 2006
From: jmc at r-project.org (John Chambers)
Date: Wed, 18 Oct 2006 09:31:21 -0400
Subject: [Rd] Caching bug with showMethods?
In-Reply-To: <m2ac3uv954.fsf@ziti.local>
References: <m2ac3uv954.fsf@ziti.local>
Message-ID: <45362CA9.4050803@r-project.org>

No, not a bug.

Inherited methods are never cached until they are needed, for rather 
obvious efficiency reasons. See ?showMethods, under argument inherited=

If what you were trying to do was find out what method would be called 
for class "B" without calling it, use selectMethod().

Seth Falcon wrote:
> showMethods isn't reporting inherited methods when it is first
> called.  The methods are there and after calling them, showMethods
> gives the right output.
>
> Here is an example (using R-devel r39647):
>
> setClass("A", representation(x="numeric"),
>          prototype=list(x=1))
>
> setClass("B", contains="A",
>          prototype=list(x=2))
>
> setMethod("initialize", "A",
>           function(.Object) {
>               cat("In A's init\n")
>               .Object at x <- .Object at x + 1
>               .Object
>           })
>
> setMethod("show", "A",
>           function(object) cat("An A like thing. x =", object at x, "\n"))
>
> showMethods(classes="B")  ## should give output, but doesn't
> showMethods(classes="A")
>
> aa <- new("A")
> bb <- new("B")
>
> aa
> bb
>
> ## Now it will give output
> showMethods(classes="B")
>
>
>
>
> --
> + seth
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From duncan at wald.ucdavis.edu  Wed Oct 18 15:34:59 2006
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Wed, 18 Oct 2006 06:34:59 -0700
Subject: [Rd] Automatic C wrapper generation
In-Reply-To: <17717.65097.345368.804829@basebud.nulle.part>
References: <4535F09B.2010003@molgen.mpg.de>
	<17717.65097.345368.804829@basebud.nulle.part>
Message-ID: <45362D83.6020704@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


In addition to the SWIG support for R, I am also in
the process of finishing off another approach which
uses the compiler directly (rather than an intermediate
input file) and can read the body of the routines in order
to analyze the expressions there.  And we can do the generation
and analysis in R.

A partially complete version is available at

  http://www.omegahat.org/Prerelease/RGCCTranslationUnit_0.3-0.tar.gz

and an associated run-time support package at

http://www.omegahat.org/Prerelease/RAutoGenRunTime_0.1.0.tar.gz

I am hoping to finish off all of the details in the next week.
However, I have used already to generate parts of the Rcompression
package from bzip and for wxWidgets wrappers in C++.
venthough I initiated the RSWIG project, I believe this is a
richer approach, but of course there is still some setup cost.

 D.


Dirk Eddelbuettel wrote:
> On 18 October 2006 at 11:15, Benjamin Georgi wrote:
> | I'm looking into creating R bindings for a medium sized C library. I 
> | have read up on how to access simple C functions using the .C and .Call 
> | methods and what I'm looking for now is a way to automate the generation 
> | of the necessary glue code.
> | 
> | Ideal would be a SWIG-like package that does most of the leg work of the 
> | interface generation for R.
> 
> Swig 1.3.30 will have basic R support. You can check it out from their CVS.
> I haven't used it yet so I do not know how far this will get you.
> 
> Dirk
> 

- --
Duncan Temple Lang                    duncan at wald.ucdavis.edu
Department of Statistics              work:  (530) 752-4782
4210 Mathematical Sciences Building   fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis,
CA 95616,
USA
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (Darwin)

iD8DBQFFNi2D9p/Jzwa2QP4RApB7AJ4j06PkVGsxzOfFrwgjzS4DT6WCyACdEnbY
oY6bmM4KdeX+EVNW+VrK9UA=
=AJk/
-----END PGP SIGNATURE-----



From sfalcon at fhcrc.org  Wed Oct 18 16:30:12 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 07:30:12 -0700
Subject: [Rd] Caching bug with showMethods?
In-Reply-To: <45362CA9.4050803@r-project.org> (John Chambers's message of "Wed,
	18 Oct 2006 09:31:21 -0400")
References: <m2ac3uv954.fsf@ziti.local> <45362CA9.4050803@r-project.org>
Message-ID: <m2zmbtsnm3.fsf@ziti.local>

John Chambers <jmc at r-project.org> writes:
> No, not a bug.
>
> Inherited methods are never cached until they are needed, for rather
> obvious efficiency reasons. See ?showMethods, under argument
> inherited=

ok, I missed the doc, which is quite clear about showMethods not doing
what I wanted...

> If what you were trying to do was find out what method would be called
> for class "B" without calling it, use selectMethod().

Yes, that is what I was trying to do.  I thought showMethods was the
preferred user interface to ask the system about what methods are
available.  

When would one want the behavior of showMethods?  Is it ever useful
for a user to ask, "what are the methods that have been cached?".

The problem with using selectMethod is one needs to know in advance
the name of a generic.  I would like to have a tool that lets me
discover "what can be done" with an instance of a given class.
showMethods is very close to being that tool, but the interaction with
the method caching makes it confusing (until one has a solid
understanding of the method caching, but IMHO this isn't something a
user should need to know about if at all possible).


Best,

+ seth

--
Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
http://bioconductor.org



From simon.urbanek at r-project.org  Wed Oct 18 16:42:20 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 18 Oct 2006 10:42:20 -0400
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <6phvemiuw3r.fsf@gopher4.fhcrc.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
	<6phvemiuw3r.fsf@gopher4.fhcrc.org>
Message-ID: <9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>

Martin,

On Oct 17, 2006, at 11:43 PM, Martin Morgan wrote:

> I believe the technique is to create an environment in the  
> namespace, and then to access that through functions:
>

thanks, but this is not what I want (the symbols in the environment  
are invisible outside) and it has nothing to do with the question I  
posed: as I was saying in the previous e-mail the point is to have  
exported variables in a namespace, but their value is known only  
after the namespace was attached (to be precise I'm talking about  
rJava here and many variables are valid only after the VM was  
initialized - using them before is an error). I have an ugly work- 
around for that as well, the question was whether promises could be  
used for that purpose as a more clean solution and the answer appears  
to be no - at least for R <=2.4.0.

Thanks,
Simon



From dray at biomserv.univ-lyon1.fr  Wed Oct 18 17:02:25 2006
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Wed, 18 Oct 2006 17:02:25 +0200
Subject: [Rd] latin1,utf-8...encoding and data
Message-ID: <45364201.9060003@biomserv.univ-lyon1.fr>

Hello,
I have some questions concerning encoding and package distribution. We 
develop the ade4 package. For some data sets included in the package, 
there are accentued character (e.g. ?,?...). The data sets have been 
saved using latin1 encoding, but some of us use utf-8 and can not see 
some data sets which contains accented chracters.
e.g:

librarry(ade4)
data(rankrock)
rankrock

in this case, characters are in rownames. Other data sets have such 
characters in data (e.g. levels of factors..). A solution is to use 
iconv... this is quite easy for us but perhaps more difficult for a user 
which can have no idea of the problem. This problem is quite marginal 
for the moment but some linux distribution are utf-8 by default (e.g. 
ubuntu) and I suppose that the problem will be more and more present in 
the future.

So we wonder if there is a proper way to code and save these data sets. 
I have found some documents of B. Ripley and this note :

http://developer.r-project.org/210update.txt

  -  Names in data objects (e.g. in .rda files) are problematic.  It
     is likely that by release time these will be treated as in
     Latin-1.

If I am correct, I did not find an answer to this problem.

What are the plans of R gurus on this question ?
Thanks a lot.
Sincerely.

Please add my adress in answers as I am not subsciber of this list.


-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From sfalcon at fhcrc.org  Wed Oct 18 17:23:26 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 08:23:26 -0700
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org> (Simon
	Urbanek's message of "Wed, 18 Oct 2006 10:42:20 -0400")
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
	<6phvemiuw3r.fsf@gopher4.fhcrc.org>
	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
Message-ID: <m2d58psl5d.fsf@ziti.local>

Simon Urbanek <simon.urbanek at r-project.org> writes:
> thanks, but this is not what I want (the symbols in the environment  
> are invisible outside) and it has nothing to do with the question I  
> posed: as I was saying in the previous e-mail the point is to have  
> exported variables in a namespace, but their value is known only  
> after the namespace was attached (to be precise I'm talking about  
> rJava here and many variables are valid only after the VM was  
> initialized - using them before is an error). 

We have a similar use case and here is one workaround:

Define an environment in your name space and use it to store the
information that you get after VM-init.

There are a number of ways to expose this:

* Export the env and use vmEnv$foo

* Provide accessor functions, getVmFooInfo()

* Or you can take the accessor function approach a bit further to make
  things look like a regular variable by using active bindings.  I can
  give more details if you want.  We are using this in the BSgenome
  package in BioC.

HTH,

+ seth



From duncan at wald.ucdavis.edu  Wed Oct 18 17:41:01 2006
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Wed, 18 Oct 2006 08:41:01 -0700
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>	<6phvemixy1u.fsf@gopher4.fhcrc.org>	<6phvemiuw3r.fsf@gopher4.fhcrc.org>
	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
Message-ID: <45364B0D.5060300@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Hi Simon.

 One approach is RObjectTables. This provides a way to
customize how variables are accessed/assigned in
an environment and so allows an operation to do something
to compute the value of a variable while still allowing
it to be used as a variable rather than an explicit function
call by the user.

Otherwise, Seth's suggestion of an accessor function is the natural way.
This does arise often and we need an extensible SEXP facility
that allows us to capture some of the idioms that continue to arise.

 D.

Simon Urbanek wrote:
> Martin,
> 
> On Oct 17, 2006, at 11:43 PM, Martin Morgan wrote:
> 
> 
>>I believe the technique is to create an environment in the  
>>namespace, and then to access that through functions:
>>
> 
> 
> thanks, but this is not what I want (the symbols in the environment  
> are invisible outside) and it has nothing to do with the question I  
> posed: as I was saying in the previous e-mail the point is to have  
> exported variables in a namespace, but their value is known only  
> after the namespace was attached (to be precise I'm talking about  
> rJava here and many variables are valid only after the VM was  
> initialized - using them before is an error). I have an ugly work- 
> around for that as well, the question was whether promises could be  
> used for that purpose as a more clean solution and the answer appears  
> to be no - at least for R <=2.4.0.
> 
> Thanks,
> Simon
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

- --
Duncan Temple Lang                    duncan at wald.ucdavis.edu
Department of Statistics              work:  (530) 752-4782
4210 Mathematical Sciences Building   fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis,
CA 95616,
USA
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (Darwin)

iD8DBQFFNksN9p/Jzwa2QP4RAjXYAJ0cbGzw6IsCU62RWGxHDS7v1E4jzwCeOWSz
HGMaKhRjidss+7cu3gok2YU=
=3XhK
-----END PGP SIGNATURE-----



From simon.urbanek at r-project.org  Wed Oct 18 17:44:23 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 18 Oct 2006 11:44:23 -0400
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <m2d58psl5d.fsf@ziti.local>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
	<6phvemiuw3r.fsf@gopher4.fhcrc.org>
	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
	<m2d58psl5d.fsf@ziti.local>
Message-ID: <5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>

Seth,

thanks for the suggestions.

On Oct 18, 2006, at 11:23 AM, Seth Falcon wrote:

> Simon Urbanek <simon.urbanek at r-project.org> writes:
>> thanks, but this is not what I want (the symbols in the environment
>> are invisible outside) and it has nothing to do with the question I
>> posed: as I was saying in the previous e-mail the point is to have
>> exported variables in a namespace, but their value is known only
>> after the namespace was attached (to be precise I'm talking about
>> rJava here and many variables are valid only after the VM was
>> initialized - using them before is an error).
>
> We have a similar use case and here is one workaround:
>
> Define an environment in your name space and use it to store the
> information that you get after VM-init.
>
> There are a number of ways to expose this:
>
> * Export the env and use vmEnv$foo
>
> * Provide accessor functions, getVmFooInfo()
>
> * Or you can take the accessor function approach a bit further to make
>   things look like a regular variable by using active bindings.  I can
>   give more details if you want.  We are using this in the BSgenome
>   package in BioC.
>

I'm aware of all three solutions and I've tested all three of them  
(there is in fact a fourth one I'm actually using, but I won't go  
into detail on that one ;)). Active bindings are the closest you can  
get, but then the value is retrieved each time which I would like to  
avoid.

The solution with promises is very elegant, because it guarantees  
that on success the final value will be locked. It also makes sense  
semantically, because the value is determined by code bound to the  
variable and premature evaluation is an error - just perfect.

Probably I should have been more clear in my original e-mail - the  
question was not to find a work-around, I have plenty of them ;), the  
question was whether the behavior of promises under error conditions  
is desirable or not (see subject ;)). For the internal use of  
promises it is irrelevant, because promises as function arguments are  
discarded when an error condition arises. However, if used in the  
"wild", the behavior as described would be IMHO more useful.

Cheers,
Simon



From ripley at stats.ox.ac.uk  Wed Oct 18 17:53:19 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 18 Oct 2006 16:53:19 +0100 (BST)
Subject: [Rd] latin1,utf-8...encoding and data
In-Reply-To: <45364201.9060003@biomserv.univ-lyon1.fr>
References: <45364201.9060003@biomserv.univ-lyon1.fr>
Message-ID: <Pine.LNX.4.64.0610181647410.26390@gannet.stats.ox.ac.uk>

Only ASCII letters are portable: those accented characters do not even 
exist in many of the encodings used for R, e.g. Russian and Japanese on 
Windows machines.

There is no way to associate an encoding with a character string in R.  We 
considered it, but it would have had severe back-compatibility problems 
and little advantage (you cannot display non-ASCII character strings 
portably: even if you have a Unicode encoding you still need to select a 
suitable font).

'B. Ripley' (sic)


On Wed, 18 Oct 2006, St?phane Dray wrote:

> Hello,
> I have some questions concerning encoding and package distribution. We
> develop the ade4 package. For some data sets included in the package,
> there are accentued character (e.g. ?,?...). The data sets have been
> saved using latin1 encoding, but some of us use utf-8 and can not see
> some data sets which contains accented chracters.
> e.g:
>
> librarry(ade4)
> data(rankrock)
> rankrock
>
> in this case, characters are in rownames. Other data sets have such
> characters in data (e.g. levels of factors..). A solution is to use
> iconv... this is quite easy for us but perhaps more difficult for a user
> which can have no idea of the problem. This problem is quite marginal
> for the moment but some linux distribution are utf-8 by default (e.g.
> ubuntu) and I suppose that the problem will be more and more present in
> the future.
>
> So we wonder if there is a proper way to code and save these data sets.
> I have found some documents of B. Ripley and this note :
>
> http://developer.r-project.org/210update.txt
>
>  -  Names in data objects (e.g. in .rda files) are problematic.  It
>     is likely that by release time these will be treated as in
>     Latin-1.
>
> If I am correct, I did not find an answer to this problem.
>
> What are the plans of R gurus on this question ?
> Thanks a lot.
> Sincerely.
>
> Please add my adress in answers as I am not subsciber of this list.
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From luke at stat.uiowa.edu  Wed Oct 18 17:55:33 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed, 18 Oct 2006 10:55:33 -0500 (CDT)
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <45364B0D.5060300@wald.ucdavis.edu>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org> <6phvemiuw3r.fsf@gopher4.fhcrc.org>
	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
	<45364B0D.5060300@wald.ucdavis.edu>
Message-ID: <Pine.LNX.4.64.0610181053420.21388@nokomis.stat.uiowa.edu>

Active bindings are another option (?makeActiveBinding).

It might be worth revisiting how promises are evaluated to see if at
elast a more sensible error message can be achieved, but making sure
any changes do not affect performance will be tricky.

Best,

luke

On Wed, 18 Oct 2006, Duncan Temple Lang wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
>
> Hi Simon.
>
> One approach is RObjectTables. This provides a way to
> customize how variables are accessed/assigned in
> an environment and so allows an operation to do something
> to compute the value of a variable while still allowing
> it to be used as a variable rather than an explicit function
> call by the user.
>
> Otherwise, Seth's suggestion of an accessor function is the natural way.
> This does arise often and we need an extensible SEXP facility
> that allows us to capture some of the idioms that continue to arise.
>
> D.
>
> Simon Urbanek wrote:
>> Martin,
>>
>> On Oct 17, 2006, at 11:43 PM, Martin Morgan wrote:
>>
>>
>>> I believe the technique is to create an environment in the
>>> namespace, and then to access that through functions:
>>>
>>
>>
>> thanks, but this is not what I want (the symbols in the environment
>> are invisible outside) and it has nothing to do with the question I
>> posed: as I was saying in the previous e-mail the point is to have
>> exported variables in a namespace, but their value is known only
>> after the namespace was attached (to be precise I'm talking about
>> rJava here and many variables are valid only after the VM was
>> initialized - using them before is an error). I have an ugly work-
>> around for that as well, the question was whether promises could be
>> used for that purpose as a more clean solution and the answer appears
>> to be no - at least for R <=2.4.0.
>>
>> Thanks,
>> Simon
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> - --
> Duncan Temple Lang                    duncan at wald.ucdavis.edu
> Department of Statistics              work:  (530) 752-4782
> 4210 Mathematical Sciences Building   fax:   (530) 752-7099
> One Shields Ave.
> University of California at Davis
> Davis,
> CA 95616,
> USA
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.3 (Darwin)
>
> iD8DBQFFNksN9p/Jzwa2QP4RAjXYAJ0cbGzw6IsCU62RWGxHDS7v1E4jzwCeOWSz
> HGMaKhRjidss+7cu3gok2YU=
> =3XhK
> -----END PGP SIGNATURE-----
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From rgentlem at fhcrc.org  Wed Oct 18 18:24:25 2006
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Wed, 18 Oct 2006 09:24:25 -0700
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>	<6phvemixy1u.fsf@gopher4.fhcrc.org>	<6phvemiuw3r.fsf@gopher4.fhcrc.org>	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>	<m2d58psl5d.fsf@ziti.local>
	<5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>
Message-ID: <45365539.9050106@fhcrc.org>



Simon Urbanek wrote:
> Seth,
> 
> thanks for the suggestions.
> 
> On Oct 18, 2006, at 11:23 AM, Seth Falcon wrote:
> 
>> Simon Urbanek <simon.urbanek at r-project.org> writes:
>>> thanks, but this is not what I want (the symbols in the environment
>>> are invisible outside) and it has nothing to do with the question I
>>> posed: as I was saying in the previous e-mail the point is to have
>>> exported variables in a namespace, but their value is known only
>>> after the namespace was attached (to be precise I'm talking about
>>> rJava here and many variables are valid only after the VM was
>>> initialized - using them before is an error).
>> We have a similar use case and here is one workaround:
>>
>> Define an environment in your name space and use it to store the
>> information that you get after VM-init.
>>
>> There are a number of ways to expose this:
>>
>> * Export the env and use vmEnv$foo
>>
>> * Provide accessor functions, getVmFooInfo()
>>
>> * Or you can take the accessor function approach a bit further to make
>>   things look like a regular variable by using active bindings.  I can
>>   give more details if you want.  We are using this in the BSgenome
>>   package in BioC.
>>
> 
> I'm aware of all three solutions and I've tested all three of them  
> (there is in fact a fourth one I'm actually using, but I won't go  
> into detail on that one ;)). Active bindings are the closest you can  
> get, but then the value is retrieved each time which I would like to  
> avoid.
> 
> The solution with promises is very elegant, because it guarantees  
> that on success the final value will be locked. It also makes sense  
> semantically, because the value is determined by code bound to the  
> variable and premature evaluation is an error - just perfect.
> 
> Probably I should have been more clear in my original e-mail - the  
> question was not to find a work-around, I have plenty of them ;), the  
> question was whether the behavior of promises under error conditions  
> is desirable or not (see subject ;)). For the internal use of  
> promises it is irrelevant, because promises as function arguments are  
> discarded when an error condition arises. However, if used in the  
> "wild", the behavior as described would be IMHO more useful.
> 

   Promises were never intended for use at the user level, and I don't 
think that they can easily be made useful at that level without exposing 
a lot of stuff that cannot easily be explained/made bullet proof.  As 
Brian said, you have not told us what you want, and I am pretty sure 
that there are good solutions available at the R level for most problems.

   Although the discussion has not really started, things like dispatch 
in the S4 system are likely to make lazy evaluation a thing of the past 
since it is pretty hard to dispatch on class without knowing what the 
class is. That means, that as we move to more S4 methods/dispatch we 
will be doing more evaluation of arguments.

    best wishes
      Robert


> Cheers,
> Simon
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org



From agner at agner.org  Wed Oct 18 19:11:53 2006
From: agner at agner.org (agner at agner.org)
Date: Wed, 18 Oct 2006 19:11:53 +0200 (CEST)
Subject: [Rd] Problems building package under Windows (PR#9303)
Message-ID: <20061018171153.A2F9E4D2D9@slim.kubism.ku.dk>

This is a multi-part message in MIME format.
--------------090108060506030400070300
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Dear R people

I want to contribute a new package (various noncentral hypergeometric 
distribution functions) using C++, but there are many errors when I try 
to build even a simple package.

Here are the most important errors I have encountered so far:

1.
Trying to build the DLL, it can't find some of the include files. I had 
to make the following change in Makefile
and copy some .h files:
---------------------------------------------------------------------------------------------------------------

CFLAGS = $(OPTFLAGS) -I../include -I. -DHAVE_CONFIG_H -DR_DLL_BUILD
replace by:
CFLAGS = $(OPTFLAGS) -I../include -I../../include -I. -DHAVE_CONFIG_H 
-DR_DLL_BUILD

2.
Filename case sensitivity.
---------------------------------------------------------------------------------------------------------------
For some reasons, the perl scripts "build" and "check" are lower case, 
but "INSTALL" is uppercase. So I have to write
R CMD build
but
R CMD INSTALL

You may consider making Rcmd.exe case insensitive.

3.
Problem with tar in BUILD and INSTALL scripts:
---------------------------------------------------------------------------------------------------------------
This doesn't work:

    # workaround for paths in Cygwin tar
    $pkg =~ s+^([A-Za-x]):+/cygdrive/\1+;

It works when I change it to:

    $pkg =~ s+^([A-Za-x]):+/\1+;

This should be fixed everywhere you call tar

4.
Trying to execute zip in INSTALL script:
---------------------------------------------------------------------------------------------------------------

system("zip -r9Xq $startdir/$filename.zip $pkgname");

There is no zip in Mingw, or I haven't found it. I had to change this to 
make a .tar.gz file instead. Remember the workaround mentioned in point 
3 above.

5.
Cannot install archive
---------------------------------------------------------------------------------------------------------------
After the fixes above, I finally got an archive that looks OK, but it 
will not install. Trying:

R CMD INSTALL Test1_1.0.tar.gz

I get the following response:

---------- Making package Test1 ------------
  adding build stamp to DESCRIPTION
Warning message:
*** someone has corrupted the Built field in package 'test1' ***
  no R files in this package
  no man files in this package
  installing indices
Error in Rdinfo(RdFiles[i]) : missing/empty \name field in 
'c:/PROGRA~1/R/R-24~1
.0/R7CFE~1.INS/Test1/man/Test1.Rd.gz'
Rd files must have a non-empty \name.
See chapter 'Writing R documentation' in manual 'Writing R Extensions'.
Execution halted
make[2]: *** [indices] Error 1
make[1]: *** [all] Error 2
make: *** [pkg-Test1] Error 2
*** Installation of Test1 failed ***
Removing 'C:/PROGRA~1/R/R-24~1.0/library/Test1'

The first three messages don't make sense to me:
- Nobody has corrupted the built field, at least I haven't touched it
- There ARE R files in the package
- There ARE man files in the package

The fourth error indicates that it doesn't recognize that the Test1.Rd 
file is compressed. I didn't compress it, the scripts did!

I am including the file Test1_1.0.tar.gz for your inspection.

---------------------------------------------------------------------------------------------------------------

This is as far as I have come after several days of work. I still don't 
have even the simplest example working.

Could you please tell me how to get around the problems I haven't solved 
yet.

---------------------------------------------------------------------------------------------------------------

The poor documentation makes things worse. Allow me to propose some 
improvements in the manual "Writing R Extensions":

* The manual doesn't tell clearly which directory to run R CMD ...  
from. This is important.

* The manual doesn't tell clearly what software I need to install. I 
figured out that I needed Mingw, but it would be helpful
   to tell which packages of Mingw to install.

* It is not clear that you have to install Perl

* It doesn't tell that I need to install MS HTML Help Workshop.

  There seems to be a problem calling MS HELP (hcc.exe) unless the path 
is specified as DOS filenames without spaces.

* It would be useful if you told where to get Mingw, Perl and MS Help 
from. Maybe I am using wrong versions?

* The manual needs to tell whether to use _cdecl or _stdcall calling 
convention for C/C++ code under Windows32.

* A full working example of a package with a small C/C++ code would be 
very helpful. The package should contain all
   necessary source files and the commands to build and install it.

---------------------------------------------------------------------------------------------------------------

And one more thing:
I had severe problems making Mingw work on my computer. The error 
"Couldn't reserve space for cygwin's heap" came up all the time. It 
appeared to be a problem with DLL's having conflicting base addresses.

Not your fault, but when I tried to avoid the problem by compiling the 
DLL with a different compiler it turned out that I needed the file 
R.lib. To make R.lib I needed R.exp. To make R.exp I needed to rebuild R 
from its source, using the Mingw that didn't work! When I finally got 
Mingw to work and fixed the problems mentioned above, I got more and 
more errors from make, and when I finally got an R.exp file, it was empty!

May I suggest that you provide the files R.exp and R.lib with the binary 
source for Windows, or make them available for download. This would make 
it much easier to use a different compiler. For example, the Intel C++ 
compiler has a lot of advanced optimization options and big math 
function libraries that one might want to use.

---------------------------------------------------------------------------------------------------------------
For your ref. I have R version 2.4.0, and the following Mingw modules: 
mingw-runtime-3.10.tar.gz, w32api-3.7.tar.gz,
binutils-2.16.91-20060119-1.tar.gz, gcc-core-3.4.5-20060117-1.tar.gz, 
mingw32-make-3.80.0-3.tar.gz,
msys-1.0.dll-SNAP-1.0.11-2006.04.23.tar.bz2,
Windows 2000


--------------090108060506030400070300
Content-Type: application/x-gzip;
 name="Test1_1.0.tar.gz"
Content-Transfer-Encoding: base64
Content-Disposition: inline;
 filename="Test1_1.0.tar.gz"

H4sIACFENkUAA+yaB1DT2bfHf0FFehNFUCD0IpBCIARRWuidBBGRJgQIJYEkNOkCC9LrKhZA
aYILigqISJESBJQuAhasSEBQUASk+IKw+9+37nv/95/5786b+eeTuXN+555z7/0mJ7kz906w
ODIFBgH+UqBQBBSpokK3UChSFbFhYfSu7/4WAAyqAlNBIOBQZVUACkMgVJUBsMpfK2uTADLF
hQQGA9puvngCnkwhuVCIpD/J+29x8t+h7G8B+73+rp4UX5+/7FvwL9UfDqfXX0VFVYVR/7+D
39f/+7OSq6fvv3kNerWhqgjE/1B/BBymAv9D/ZFwFSQAhv6bdfwp/+H1N8Ji9LfRrTO9geit
kS+liHk7APCsgcLKQ/t48ziAgk7xife8f/Cdt8bv3bLBWxbLs2kfbNl10Kb1Qv+wruVGCEtv
bBsd9HymLQ3f6Pyat/G80cdK1+SVyeSgJNbHe3F5UwN2K/4rlmYGprEc/xj3fezGrsYCkTBC
HzVEW4Oiq1gLvrtYHbqCjXkhEhistZG5AQYUPWAZrUGPYewwWD0zIJr5EpruYS0sjXTpwX5W
LbpnY21KT6d7IbabHlbHlO4ZQdkhkvpG7hS8mQueAIqO8awQY4VIWugYG5ljsKBZs5x9uyGS
trbaZDLRFe9CwQfiTPEEb/KGOOE/DViSiH44EiUENGu0nXcjwwQXEkQkuf02bM8PnTpYEg4H
erYj3XT3DzG0C8UFNGNlzv9DxMzFDzQryib4Q+AfCuTAnBAo1IjghgtW2tgoQKdF4+xYIT5E
D6KSl58HqFnkLI4VYk3fOJRcyWTQ6LZYpl0QysZmoujn4urt4oHbHJYanM7HvhnY7MhnSzdm
29p2KERXEHBadDMO34xfw6Yb86urb4jH0GfCQcxdfOmfD5kCABqyv+/H0H+T9GUgZhhdoq8f
CUcm49wgukQCBUegAJeN2yQV/k/ZJKLPRhbgtV/un+bTQwQjgjsROMEC+afJWJILgexOJPlC
vqvXkHb6F4aEIvV14WooBFQRhVaGKcJgaPqTDhypCIVqQ3VRMD2ULlI3HGJEoO9kBFfcxrwb
XxD8X7yENY6Mo2BdTvjggAnC37JVM2DAgAEDBgwYMGDA4D+Zr0yjoCAQN+g0cBgQBUQAJoAD
sAEIgCtABHwBP4AE4AAy/YUD3OjZHIAZgAF0/zQWCiABfXoMDqgBKAABQAFFukUDygCM/gSj
v9D0Pg6vzXWZ6c302FHdjRuLX9vWRQewcZvCBmwHuNGqeqzAHsDQUBt8BEci44kEMEIJiVBS
Q0Lh9LgksHHPAmyN/HU0wOZX1DFP/c1lAjiB35+96dMLAtZgQ5yPH5h+dANvHbDB3w/RdF3M
wPfz9XcNvx2s6bPzAH843wM76Rr2E+I0OIBNGZwAwIOVwJiVG/OBNpbfEvfDbcz/BvD7d8KA
AQMGDBgwYMCAAQMGDBgw+H8J99apn+X7vze0AUspANAEGtYrptL3ZMe3H4g1Tpc8lW56fv6y
bUPDjQXHO7IVAZmSBdWJp7T7groyDgaMqHmyFMfE+N0CnPXdKz3pM3LUPlsMXmqoVxB7nin2
zMyo0P6AEkHvRo1I+KnYCibVsl2OfoVFI43Phiqahp83xHXqVIXXm1Ct1pUUa0fAbJU+ejk7
yJKc8kdgYdQrcjZl7Hy7WJN9c5b6v24oPMcLlUWKuzdl2ZNGTamCl9ld+tx2grUWdqO1BN5a
JXBtS9QoeDnHkdYZFHZdOc3M+Mrl0vJYK37rbDxrFbbLwThRegZMZipCZfe/si7efo0fmSSk
F3hOIkMiXXYAMRRb1Bsi9YHthJf4NevytutY1iQdsK86nNc+WVA8eWryso/M2Kt3uVQJBXTu
CXyEXi4/lxi1MiuceB3ZxtWORcDUA4v9eGtaTGTbRJJ+6gEn8+tJehOOf5UYuF9BLW3PDIyL
dTNKPs6mfnBFYN9NYl5+kkDiZHSwdLU36FDkdojBenI8bU3Qcjl01/LtjpD8epHmxYg5dFui
BJ+M+WxtxDc/YsXe4hO1CwL1DZByj8QmyZq9TE4x3nyuS+Clk0/629rSYRlHvXZ31NrO8b7U
HPtccTuswiSJowfXKVQoUBesnbC++I2v2v7DGbcmkzyl/quBl99qoa0VIG+YB+9nkK7ONEd9
GhPmcbFX8+OldnQ+FkgZFV/t8YnXqDEOS3Qa0VvAfqnmQxyOXD8sVp1zlcPicLa69JUZIde4
j2I1aXosrUeGr4q5tmoAT0nvDfdk2zBnTmY5S6HmKEXCyXacQWEJQXDhktqVjGY5vqUdL3Gh
dQE/tYzsmnNiZ7VNonXozHNfar1UANmjSRqFY9s7C/XHBJRgNzxZMIZFTmoxiNneHVap52VS
+2gHushpuRGtLMmKlTE7nJpJzjN1+PUldYEPkOKnAjrXbg7a311hYudDv8onm5Rr3BwZio63
PTyqLwZ5i10KEQ3UjDc+MOTU5QqKHl08nbU0lzEtsZor0CeuTZHcV3rMOKFGqKNvjuYfRxoO
3YvqsugyUBKxbHwnQ2I18rESrHWcWFmbq4ZgBp2l2V0VVORvFoSO7RmO4oapGtvM/7wK84hW
ez5HgwSOJLT1tSlWVb+K+ex/k5DYe7qjJ0lCXKpu97jeqkgtJGsh0de1bW+75uGTYke4J1gE
MAHozJ7W0GHEuNaSbuoHzw9C8UJmz0Iknj0421Ke1hv0uvTlFJO1F//d5IPy8c1v3n8pDcvE
KB6YsAuWPySDMkjiscpI57Gs7fsgKMdOHUhSFHUrbhm5qyid8PldKu/EyVvNNwSmnKKEq9Sc
NBL7uYeo7NRPeIFtt6hMn3ZwdiXV+XksK95AVKGVxtmr+EVTmEW7qbdFM+Q08p49vrG2nlBo
PWa5LGjg0tZaMF+W3rYrFeEiJBBE4+IO1wUR2QWuIUmj5lKr1J/NqEFJ8qFtPlq9nOX7PeXu
UArTJA2fC/TdesVxTNnuzMMztXqtSQaVR2Er0ayZmDCfJslG+QnahwNC7xrPrmMIjTja89l9
GNQ5V8L7oPJxYfDOT/WzllP93aQKf21CnugT8OhufyZ5ke72n0SFZPjWzZZy89979mu2PKHa
NcPdu8L97z71TLe9FjZx34Bnwrcuci78wYtdiJHq43fClkPDHDsculAiIzeXbmsQyh+juRMu
Ok4cCAeR9uA/XC/iRhHPQgoOo0mcVWfewMoCEVF2K6+btO5TMwKJLS8Pt9bfd5J11HmoXMdd
53In7dtcH19+gz5m/lpmZfaVCx9rZrcNrqPcMQqIa7X6Qq8vne0Z8zgxu5YuERyfX/tTm7j2
K6GSU+2yDgtttZNWl40Py1LLPtcWNMd/FUUI2Kx66HDSvMbm7rXYP93e80VsfvR2b1pamWeU
nt3s/OllXlYfwdnbmqqLpwJRMT1PBVaQiQ8855UiW2c4sobgQoOqSkkXVrMMCHdrPt/zXw3e
NV8ic/wSRvDEChoiKufs3iQeveafjffRZHvsdWEE9k7zFHhyX4Qj3q4n7tu3cG81n3eoHRyP
x++WpnUj34zmGYURCD2t7xctItg0OSaufYkx2h1p2CtdPdKheWV01aIpYaSse854fLmJfK/A
Vky8zPGOwRo0/Xl+ossgaKkpxrZUeKZRSLPpBmrgcUfao5VQaa0E99SL+d1hzT2zfpnHcp3X
YxNS9kR+U9aYQdquPemNdxLuE5tfx9iXrQ8Frqy3FYtc15D+tu3To5/Twj5n+SceF+FSpuZ8
1YFR5HbkfNulad10r0LiymPd3vu8n7Owlb2gsNA3h8wlSLsNEnQRAc+DvnVlumr2Tx58m4LN
CvDqB5N2LtwnStUOIoNoaTzKk2vCe3xmzTpFn13qQjoL8ZYERJ5oK15MeRKUxH53gZS/OPz6
ZVPKDE/EKc5R1BwnPhe9gO19gxIoHX+I+yyieNdbXb94+bgC0xtFmSnxcb38Z7FIpAFS0/+V
6rhc5G2T85qI+Iw6x3Xh0uHI5ccHG7elVoT8PGK/Vn8+2D06OKU2bEdg+z2pW/vLEZHG+pVe
+PzG4xwRJ7bXufe8kaAYyDKJInjvJrJE3NNQtqq3sJJfg5dYzlGF5iMJHo6Owbg4g0Xec/d7
WXisDCTtnl/XQDZ2OZh3LB9PK4WJHVaPOvge0hj5+mnoGcrn5jcnPPTKw4k9OQ2qXbUzumNr
LKVhnqYveMUTxhINeMTQCbziMyxoNK/46GrN2xfELCMan7Nc7TbCBRAQddOWyUu/fq/cnebs
F9IpvmNRn95bgbm0hNwf8DtpGnIN9/mgOb3TpczuG7yx48vX2F9pvN9DqtO6BC3vsPOZsjIl
16XlCVzKmBxfp9uX7Dp1Fs71kcxdVSIZrqpqmimDy+WzT3NvBX0JuOdME1QKPJUBkm5ODeXr
7QOV75uRWmyu0nc0b3OuTy50juqsSBQaOC/Ffn8+JnjboukrZ0l5xCc91AWus3LWY+jT41ef
sucnktzGb+PGjTALQ/6GOano5PlfXhVlr14pIfVXjnMfyz/ZtJ258vya8pM4tZ3wQ/FLH9V2
jnNe45pKCFGVjOq1H2gHyQA6mKCLGtd7A16/zJ5S0J+erCs5oKVQNjpRoeZJWzBrrbhcLv7V
sB5BizVcEFgI5vGWVJl+elSVFk11kbzi7az2cruHJMFk9511WnWX1o2e9ByZgAdF+w5Uv6yz
U3qvfqTybOFD65GXhzwDd8dVTPTM7J+QiZ7CDviAhVNLWHfHVxVfpEFFZz0OPTx5WD+yS1ux
1lqVB0wGn2PuflByQz6SplAwlTpVcS4k7+O7O7OhdpCafCb7gCKSRM3+160f343vfWC2bxq1
aOyi8KJbjNn5LdfAjDOf3D2je42jF6QiG71cygPubFeljJlfjI8DT54jfcZP9Kn02ltZ+w+e
c7booHEkqTzi5FizctyWNOIjmWNDMD70Zfho975CvmpWC2TPkSn4g4kGxUaMTUJHDt6K0rxS
16Jy9NGb3J5HU9V2AVlvJxHRjhd4mFemMwOzr4U8drsFlbHNOf3kRlG+HQ1vUDaYW31gYJt5
M4tHLn4f0VXTQZkGta8EP3tXj+0sfur++WHtYP35+Fk1sdFOfumZVj/Pad+pCq/B1AiWlSBV
G4dM9+fiSm9ZgmgSVok61NnLpWFD+m9vKL8LcZhao8Sx56j0y75O2KOuzTw9dVY3Oi+ixql7
7zH2eXJvHIrDkpoSmF9xkMIm3TMteMmK3CFHMF1vNGlwO7/9uckFsq32GS6VsIjjstT2k45Q
skR/TOH9YpdCFUv10Sl579unhsY4z1pM9S6riCRKn1Zl1Zz/ID0MtVCGVsmeERMqjcjqJlOM
H/altPQ/SrU26+35CM841lq7rl9YJoI9Ft4YVVJ9sWca5fC6m/meqZczQWHx6UFMe0BZsUkz
lvxSji0v9nSZ/sdHfcbB5zhQw7MODx/mmcB/kVYc6mHNFSu7ymTSDgrgayqQu1Uv7vciJ+Vx
Nv9eYZXU0OF7JTsfXez7+OTnEZPpuIv9uVMNRbOWk4n89fvxjnmXupWnDsJp072/GMmdi1XT
Vqu2GqiMnWQJ8sGOBXZG2nq2yA4eLfcytXEQU/EcI6WpB9dalPQXWHDTrmOR7Onv19qmk3bh
nMXePVK3OUUw9DA1z/bvu806haJM+x8Q9i4bPfIFIyUsf55aOTEwcreUUKFo+/pIDSWXuneS
2X3/hUqf9nNXtHTctOSVwyg6JVI7vSquioanjg81VHuYse7svcrnsHdEcfDQ2LRfms9T/i9L
DylXcb5nOFZFL+bZ+zSU632YlmC2sU2FKT22KPR61HKF5re/i116QKoSh/EKRYYcyZxa+diX
Pjj6X+xdCTxU3fsf2be0apOunbLNWLMXihKy74yZYYZZNDOWki2lJCWylCSFEkWLtU1Epbdo
Qam0CpE20e5/750xDVHq7e39/X5/58Pcuec+5znPec7yfM95zj2zwK32KVfYq6g+Cc3gE4Ur
zk5J8kveHdwpXXDG7J4nJuWKg+0G+3N15kvozc9OrGzsmbC1g/c9htSyT2NeT9zkXsEuCxtx
d89+5Yy7N20frBJ9MmOq7+oT85Ujy2+l3XOxqM5M7ws4ZjFfvDA2F9921qU7QDi9VHxubAHe
+ZDDrlNWLSSii8Yn45aElgmpzbsIjtemlVgcWEKL3bqTknFpadTipDzVlA4xkT1cDftPSCf2
XGi4HCF+23mm8gmHjg92XTfQKbqlpXzFXuSGJuGnFvsDN87JKO328LHROHkVGWTllfBWXrdR
71hFbVtMbUyhN1V51gLLzIAu55Ry+ro5h0sEMBHnll6rnEmy+hQYb39dJvbxnmcCco4Ca1wW
PMoIq3JwynOoNm8vv2aftSDro9thbNU0nrVy2ypjn+W4yDwJbed+YiE0z1ktSC58el09kCo4
o7FPW5Ljeo32fQ3aDjm1NwkKa+ikaadrUqK2pq3tuTtn19aJB1/dn1bt1up2QB791rYqzT9f
TtC42m0jpr3z7S5L0a7EvSnu8ruOZxfYHDCMqq+af8+4YvnT9U1vbpofWjUrr+yZUOyqW8sq
+G9gqfvULme721z5y+ehWcDsGRc0FrbWrTznc6oC5bAliKz9xqk+MM3p4NwwkdhML7vGbSis
g3785BuGKw+iFzyqWTOjdovrLtnGCarH+gJ3F8zOP3ekM8ztkO4NxRKzLOXDxwWl33gcbg1M
C1i/egnV4K9zJxt0ZJEFIcZq07m4ltKoa3hnxDXHqrq1OzSsKJPCPSQtcDi9ludIfXbVS/c5
dn5HZHycRNLvHElciFL375qhUVW0OH3byevmvV7HkXXrG13xM7rEZr5ZVn/9lUUF2u5eD9nM
vm7Jnhu6lyp58sKuHZhN783h+Zi7uCHFK9Wx3rNZNHet6TUpjS/708tqSg/L68lhejqfOi67
Sc7vXj0Xe2bru/nN5w0K60w1feq0qy9VBLkLmnrrhO6tcT+mkuvXzN/7scB6+klfaaSe4cl9
D+7zdygXPjsswNd48UO63pc7pqR50SsWXjro+gzFI4BIDRKcnFkzgV4gk1N25sjd3qTz659j
3oh17H96d9YsTZ3EZWaUA+sXWPSdcF3fde5jIkfxK1JPm9Z7xXP6x5ykCuZN1Jwf7741N+rG
NUea64yKQ1b38gULaEqXZHt3u5k18Pd15hk8NUITOidPe2MbTah4Et/YFOBx9fj8TVzJc65J
NC6ZvjuPe4dOS9Merq57S7TIK+5wL3Hc78mnaxLSTnXKnC2zefVLv/ndaTGZnXxq4ffdc2p3
3McUZoSuvmDuuqLjrPnGvtWzSKFt1dKe6rMcGiPli2ZVTnVb0aug1N3vuaJJcWMq3sG39sOr
2dLWE/TTj0pYFBI/R9t31TQfTdzikrsp/2jkiWWnmotknvWWNcmku1ZepJMd5KLPBfFeMpO2
R2799BS1JtPKsXapzqI7NgWU/KwnybkXNm7o1Os4efvpxLhtoouiSoNd8uQU09/dOzVbZJ/s
rlW4dVYrIm9TOg+7a5j5XVa40z4tRKB2X1f2JXkJqV7z7A+yGbpWBzaKt6HyF8y1fyq3EmV7
ZE23arVcMCmouV0rzq1tzpVXzYtMZ3Xs9JxDV5P8cGa1Ut5KzUMhRbeky/ZjT902eUM5vzC0
M/VCLilBgbN/1rW1lonzUqtCtQ+X6VWcFLtxP1rjoPFtsZsLpywqWZLLRXtV+1eU/ZwXTufe
J8bePRFe+7zM7sh2DyNV2eU66katSctQrjbbZnZJ8Qro6sY1xC8xPpPciVfLEz+naWfHR70r
zk1prDVVrFhq4pe86/BK3iyrTqsZsUGAheUTTT+BKdyyj5Jt7S/LI9O6rA9l7DFFNuXFP0hx
vB4ZHmpjq23Qmn7sum7Lnc/pMsduElDbb9je9zVty9jd3vZS3OKLxO5Atb0zvLbfraclHVmB
DolJ7558JWFJ25cw2mqHkvyAhvfbcGuStzt7O6r47J8m9+C2Y5LJ0pgPL4LIsVc00BkTRY/m
Cl/kpB/aar6JIwRvcXdNFHc6uTSpUVW+wE9hrvNUxc+nD95otpjv2tlXzLXvw/JXkREZhnaK
V9XEFb0/tbgJdmmt4j9d7pN+PbBVe1I6f0D6lN059ENX+o8l81tanyX5C93PaBSVabFr4OTx
y864/iYmJVrMvlnsNogsjli6nCcGu5DeTPkr5ngDvukOT2+W5fXVITUG9yoX+F7oP9P5Zr7V
Us26k6fuL1+mY6vb9hAjZ7zheuJR500Wn1oaci501qPtm1a345ceFqvuu6L90ptfMbZnclmt
SorzLu5Vc7uWZCReczh/ztc3w/7lAvKa8L1l7nSnurpDocV3nFTO8Mh4+PRLcq96X5aqfCu2
ea39ylk7rk7RDJgs5FJ7fUNWZ+4x9zaniXYL4k6prufANWl10D417TZ5ZX+V3Ik5YVdRvkHz
tXNqCflg5erOfDL1ducUnGhuk+v+y3t2UnTFTm+NnYI2TVwrLt5e4oOvCa7enSduft/D/dFZ
l0LuBXL1z7SSpit/QEWefu0t3xIaEkbSXmUxnZipJnD0aFFp8Wd6o/ZMpFCJAncjKgUn+yiw
BG8vek2bYNvXFyyIp8o2PVup5Fm+xbDgyApldMDNnbkyeRW3r2i+D64oNGo1iNI5mdulKH41
ub/x1lurEzd42m7qfTzolZtCS810PLSQr8Ty9hqE1vb36ddCJqW8vZqxhfTY2bz4PFarftWl
lLASi4jVXy76xA88rW+N7y7tcjXce0HS7GFEtcX5UDPNadIU9cQzm4oNBwqDbD8Z9pUKnkdt
va+W++DLqu2xhZ/Xr6Xrhe1avClz+cD5orP9Etlna5yCjffcDT9vdaYLU6u8F7O5ZuZmO30H
9aaiCCTvKxr94b75sf3NcfoOA0cMKkU+WZlk9K/sf8yHe9TcJWu56kysvNi1MN+IzkfNe7w6
uerURXQkistNbboe/7VZ/6WoaGDccvctDadiuDi51voF9bjy+h7oF46/kXUUMMPcOW1p3vLi
0peuhceysyKcuHZWCgsaCXslcATwfOE27PDdMMCRTKK6criX7D/TxvNELqKb7/Si8shFxUYD
lKXEjLNCardkXsRIcVgtmE04u+nhLIOTIgYl4V7Kn9M/IxoQuOmO4jEelSKtyySOfhZ4IfnI
L1hmT8TuyM0vVOrfOb5I+Xh+8qn1bglBvP0SKl6VPU9eKMvmorpXPJnak+bb6yvu7eF679WT
z4GcxnyHF6+fJLF008Ki+5rB/W8fmKVKn5Ht2cIhttmuehJW/zB+zVvLvLTbMsc8ReVUc26I
awb4zt1/kWZQaGFza4eNTFRAwjzNqzdOBoYIh+8v0C/DfSTVA1bEpdVWRLsLBgvVLwrcNQqw
8CvJK31Inr/XTNgGdXTKMT1T6Yg6k/6L5cISztIKNrk7phltv5ON8+a3FJhWYuUga2a9eG8c
ouuqa87dmIICo+3pOThvc+iZK/jMzWbv0c8HUJtNVLmn3kEusJZOUci8lRVRxTVBz8LngdSl
iVHruU+ZTFi/VcF6agfaJkpKTjP5AsJ4Z+8xuzuVOcnSCPEDATbUqQ4RUxvC13E7i3glX6o9
SJHa1cbhlskVQ1jI0SbnUrVe6JgV58wkid38EqhDqgfOVZnwFCZlnOd/qe6QdrGyKjumImlP
n8Da2YoWBMDgvVCfVOT8qQJ6izlWHiYVldQt4nCQn1BktShnnwBddXJkupy57tNqTJZAd2LH
lmS/hElFLvTLi2w4zWSOCEwR857pbpbQHHXJJoVrzVyzrV4yvV2L1vGizGdNl9b1Qk8oAG6d
MyEErauZKL1cTHSuboJqlpXC7XXZG+t3zVYyCwp5ZGe+aJbw+TzddWLqZntspZ8tWselbrHS
d7r0NSOzLOOE+fFYvyPr1GdPOXRToBEvbXVu6sqcBDt+d/ucVKcNYtwJOGolcZqi/wIsh2sW
Jeo9STA6ODtq3VJdBezdk6YhU3X5tqGy6rKtuWx2TsBZyKPypkXZyRrtnLrZYr7p3mR+a9n1
kkl1k+Vxi3eYZ/Flo7jqdlrjbOQn5FlEoWSn7bTbbHR6ehNigbXYO9VXXkVTNScKOnFbpdGM
qp5whJYWP+xCeDfmt3+eY4rJydB9yX9FYKpvS2wkxuGw195tQQ57Q7o8Ts2/cci9qk30gQA+
8PnAZwRhDbfYacW06e8+fZgxbeWeB14H31RPuILO8nHDxtM/3XIJUSxScvB/SUG8o5zgmSs4
byunW0y05k3BU0kyiTIiMRzHL9QkyanHCAvVpXz84CckSE5K6n2DUnUz6rlrlqqA0TTS9Jda
6iMkTK3fQ7/hU9OCEFfCmJGKUjUpvtOz5h6aI1To3nnA9eIsVLbwnN4S0lrxCmHBe/fbX7sG
vD+3nVSWXbcq+lHZHKTqMkkt2w3lHPN3CO7K3a/mK3A7FRhYxx8xx675cF20VuQJ/+kreVyD
X7SeiguqeFD1nAvjdFreLcrY45QTcv9hpFnDSoneStrJk8De+aRTD0T17BGUysOOpWQ0oZ9H
OdSy4T7ioWb0wjNhH/o5i8+GXw6VCVFqOvLoQSQYq1MZlZAaKecUwCefIzzjXUbqha2v8SIT
7/EaBU+dGMNPqp6kc3P5u3fyojtnCp3Rxy/infhSLE3cQH7eDcE7N7Lvh75b01nosXfypAZa
x6PbonNna00xbmnZb9yYr/C+cx1dKqf3kBOmJuE63kCfruzhfFz2naGaROa56x/PkbvNkx43
upwIU1m/TWL9tYTPHU0LzpjsaM2NdjhssKm3k2vgerhZ5wmsd4veLO0gmxjX0oUfFvm01Ukt
Jz5cdWLZi1R7v0b+MzfT+PwCfRJ1Ds2itXXmH/nIs+/plYt1l0+1WTxv4XvbbNiaP+GD+8kM
ieZCo4vEW4C0aMGsCU+f5r0wFLQVa8gvcAJMgrpno/pEZ7/mlZs0YXmKsETKXOO6R2bGj54s
M37y1GJi+0GtXZIaoTFp1/ZJ4I/nXQShQKLmirlNRxyNi/1mkJqMUP6LdzbP3nega/YJ0pkY
4u0iCddS4qY+0tzX+naairjLLwXrS1KUOjcIcvfUn1t453FczOKS961pDSRHzyXK9zS/fDbm
OxDsbTU19dNVj2a+oDQq70eRJKXtlF1FmebOj5SC8+7Y77DsWVEXU3p0y6lSKbXz+QVq6/kM
F/eqCyfb1JW3HDh6tiC/qlS65i06R0TkbS9Pjt117pfhauaN5c/3+B3rq1ibtO+I0NFESqiT
QZGl7aZj5q+v7l8gqGx1gK8rxeQKdvlz47nr4o42kEXKtAhR6Od7DhlJrJgQ90JUOZsevSBE
ZpmN2QnFw1rpDo9FSa+XtywjdfUse4LAdS8t2vth0/wO17tG7+/Et50gbjAWOjZg5yFlaa5I
ovk9IL+Vzq6tEJNWSIo8oL9yRjBBQugTOjTpot/WKcSy3cfazBq+7Aosi6hHhbw8uGlNYeLl
8u7zJYV9gtMiXx9UxB/tP/8X9rD+nAc99itEA8yfHz+W31iCinW+2hFUnrS7wDAffwR91TfN
XivGVelBsQzqVNG5juScK7tLbkgTEq+03QmtV/QoCDjOc7SlKNC8h//L+amFO2yftU5yL5+c
+vw59tphazHFlmLH/MAlovHIN73Owvk5BXVOfH9lLObOai9QTkPVHqjPn+7Wfz9bZrddwPOL
pgd4Fkzz4/Z2V8xcfOav2uKWeJMK/IVXrre9/7JyORBqvCqAssVZYU59KPl8M8m+eFOO7aNz
zy3OSBShzlD2Utc8tXzT+ki0B/8XUsgSqbd7Uf7pHKTodS2xjzwbbweoxbktnFyVtp1GUXXw
31vsMZH2orvqTG1ZMX6en1g9JrnLv1vf/8XBzdmtmfP0nT/tyU53iLPrMeV0sdYwEtxVbZX4
2GOy7+ZTCrlFfHn6IiZtj3QvbUknvE9eZdPjnRiBvvM6fQN37tZinyc7Wj2O1hhs0UZXuE5b
jr7sqL6IN55CVdxeIOYit95hi6cYzbg/3/1KqYKo52S79iuPI7f0GkvUxZR4xWTtzSQblqG0
AnllOHe2ZC3eXZUXqtgttm+e9sZMC8nH+WY3fZ0jz4nuKbmZIOZ88GaK9q1PhicQe+x2Vt/c
eb4mdIKqXpiX0Jbzm6l82IY9G1CT7rndt92bFrO1OnNpzYdi1HaRaP0ZxvF9L0Tw+47n41qW
Xtz1xYjc+37OWlstS8tX6htvc25q379DrzdWKLmiOutTzP6PLiWtG4mUOFTOmqlnIgJKlFAv
eAYm8Sz/ErvPU3FnXVlauAPipdbHyVJfbvJsTIjzLJ4dFbpTxfDtaRHyQNit4/FI0uHt2L4M
rsptST68WyofbWlqbWt8zFu67LNxxcNXXZu29F72FFHmqb9/8ck7p1bXxU14vqqijf1xnDeT
sAtdQmfM2DZzlWxq+dW2vQd71gJbUX0SW9/Vhm7xdCoXLVAS39Kg0D53Y3x7VW7JwVUGH52X
haumTqRnRYc/kdvUcD2X+PK+R59KQ+Hso9NvzAv10ovjOFn0TmVga9jcW5weua/eDWhNf+Av
jSr23EI9ejs9uoWD8D41TK7/ggQv7vF9+WeiG3w3pub39ar0rJu44OVHUursmNv+WQ9Prg1b
d+D2bnG9JyRt308zPffXzBQZkLY7u815gy9lb83ey2dXdi/2TNj4IQqRVtqxar/L3NVLXa8v
v+Dzpe+smea8L0LrH8jrIt+3q963nC7NH4GYkhhx9+pSoudEe43nMZmF9pEShJlSLz8jagt7
tgHvOwWOEspDd/Lfjd9l/d44s50zG3W0La/NSaOu91N0dPjbpp05BhFFwWaOlyo/fohqNSxR
DZ23VcF73dkMcb85ajU116eriesp9qfnRaQ6mn/ouMNrUCj0maMU6Dl+RXdjBGeCxJdLl94Y
aBWjNDgHNvMsXSt+tbf/Zbhi0/NPyknvUgvLidOSN8bzvivPNLzgudM0fuO1wlemV+28SQ+W
cOOyXp0Nl1QduIAYEFExGric18u5lreiqMDj+rxWqeJbDuIN8+5w2B+Y1EoR8bal6GufVvxI
w8hYUXdSubOfHMx4qS5c2K2Q8Dg+zHDXB/UvogeC1kv3EPZERcw+p2t8tFtfpfOYKiGF3Lnl
kP0pramT6jGh8zg/SRXx6UScv3HP7vVtuUTSLhHvuaT7+/Wu7M9/vlGJsyDo1t1MHpWXOXjC
THR7XmIJmddzZ4RkXJjondI3HvxfqmpDm4SzJR+LnhUpWft0Z7DgkdcRnAflVvJN5Ije8l46
pd9lZvNAfe1E0oIHL7MCN02SNOGbvHh9neFmuQvTLmGPGWbN6jud+Rex6+qHGs8PxZsqGc8Z
3hrIUmw/G5aR/UpFY0dQdpal6/XD7TONBzLfypYQOgSzHI5PLY985Ub0fPbZ1KHu8Qra3PfE
GKyPRVC5b1mykImwZ/+lvK6Zd6cuDImPqKasvBbKx5MsbibZbiQq21/ke1U/CP0hakrOY5Gu
fRKLByUbzBmKkTJBfBl854UP/JcH/wffjZGWZG4mifyTO1fGw68Fxvk/xlaWdqaW8IEo/0D4
/vk/YBxKY/D8H6SWFnT+l4amhub4+T9/IpiS6dTVOsCQ01qEBRYRCWgajjYsnnEnLMB8jQx8
zEpggqNhqIQAOoFC1gEc8Wg6QMfjWC+nYSk4GiBPw1OodIBIIOMUgPBw1kM6gU7EgRHCAvY2
FjqAsrIK449I8KaiqasZx8OowAdUfXumjLCAsAB7EYaLzi5suH8wFgl/ooYJHB7uE0jGQN8B
OgWUFhRC+SckGkkS1DBJUH9CEhRTkp+ofwYHE1NbYxtzaztzK8t/oI39qP9ropCs/q+pBT5H
aiLBy3j//wPBmtGZWN3FbnUAeGM92K/toM45lh4tLMB8x1UHQCqrgq0aTQfTocDKVUKqKiG1
wO4QSAfJIV4UIJhKoeMAAl1YADoviw7+45hPwFaPoZACiGAU9F1vNSWQ6oMOJNKNaBQSLhiP
o+KUyTi6wbB+s4JCxQFob0ogHQiGZCXQmSKS0Ku9cQAJekzHo8kAhYwbFNiCgMGRaYOlIzLu
AAINShxIxuKohsICTEVgQSIcFrDC0AGkNoDU0lFdqKOqDhdPFxjSMoQFFgcSiHQdwAZAKasr
q+oCBDVtTaUAjBJI5BushtL9qpRBTupaukAwgYylBNN+qu/+jsAcQXDEgH/uENCfOv8RqQrZ
f3XV8fM//0hgq/9FZPg189+fx4/Gf1UtrWH1r6kJNpfx8f8PhCGQin8YDIRvR4pE8TMxzb8t
/nj4m4Gt/w8eHPHbww/6P0oNNXz811TTVB3v/38iwJUODA/Mzq5jN+JTG8CEggkk4UDgBqEv
aOYTHu7J5+PJF+jJR/bkw3jy0T35CJ58FPAWgG8o4AULXQbnM8ICnnwmnnw4Tz4anIAKJwhg
T6kDUcEZgrPFRSAsJGMIIECTRyppwBCOpgBgv2JAgOLDgH4QTGVNoiAQ+DVDezg3tCefL5jz
V/awDuRDFBhEi2BhfOHCkGAJybBUtK8JACAEmqoxECgIL+VC5AAImYJyspeMDucFloY4JDVI
Ze4DkHEYHI0GTuIUGegUiwNhMJHGQKlQGdjLBiLbIByrGA4wXyIsIVsxvsoDJQ9CEwNxABVH
D6SSQegK5gjCWhDcogELc1s7RSAQVCUjKYS3kYAOYDJUmXJwvNxXGtQoNCg5lghg7TJEdIRF
pMK6I8CfvjrsVEwyS7im6UOLAU6BqWAJqAAZnCTQmDplPFqB9scBFPghDQfXMA1sCmCcI5pK
BvE1CKPpeMCN+Sx0MDYsFMoyDAhn1XAgnCsezp4qD1aPArsAweBEBJx4AGioShlpbOAa9YE/
qYOtAsNowGxJA8AJCBXnA7YFMli90AwGqgsigY4Dx41AKk4lGOcN0MBbuL0MCmQL88EBsGhE
uJFS2OWhePuBJYLZ2eJwwCIijQKgaYAcNGzLKYIETD6mnnwhsOJJcFciDhdPSkoJDIAtnhJI
xAJgQzExtzE1trNwBnAhOEwgHTrMFZCQACAqtiSAvr4BAFa9D9jpACyajma0HioanLKQFNkJ
wUChQssWACSaPESrT4BApQIAn1YEKQM6QhaLpmJhTmA10mnKbAICduzdF2yvmEAqqEw6cTXY
ISABsGDJmdSDZGDXBUIWIJEQm397PP1vC8Pt/yDO+515/Mj+I1Hqw+y/lpaG2rj9/xNh6ALv
2DDACPYfHvHx8NhDBwbHVmhAC4DjwIHSn2V4mVCAMTgB8vBwxxyJGamJgzYDWqUBx//RuDCg
Ap0x0P08qvj5NaMhQITJ5TtwhH3BbKh03yIDFrJgLcgNrsgx4xkLc2wUrCeshTfGyhszlrEA
BwX2RTjmQ9bS1/fWvtjAF1icIBw1iIALhsqFpwRDpgiyAWxFVAQIZAwxEAsZXCiaRKHRmSwI
pAAKFRz26RAz8G9w4Kax1PIDkzx0zXCw/n5x6RCSALQyTC5oeFkSAG2SCnghsXiOVoFjBALh
oI4HjT5kExmghQ0aQObQG+TtS6WACgd1Bx3EDvcnVlY/ggWAFdzU0ESo/fnD8ICRDQlstAGg
0DRFAKfsq8zUupxegL+vgRwwVrQAJqGBNQdCAlwIGrrSBnUCVS1bpQ6vzn97TBsPYw/D7D/q
n8jjl+b/yHH7/ycCXOnA8PD/b/6PGp//j8//x+f//8XzfxRqHHv8fGDbQfKP5fEr/l+k1rj/
908Etvofcsz47ww/wn+ob/y/Whqocfz3R4KehImVsZ2ztSkAVTtgbb/YwtwYkFRSUXFUM1ZR
MbEzAczsVlgA6sqqSAD+wTACY86pomJqKWkgLKAHpTPQw+PQWAM9eC+fgc1YNgzpqTCIQQ4k
EPqA2dMDlHCrAglB+pLMX25TgtY8JCHgB93pS9JxIXS4qeoCGDyaCpoOfQKNoqStrbFQCQnL
As2DQftL1Jek0VeDE1Y8DkeXBOggG2ZqDI0mCeBBC60vydhJZwP9ZB2cVoVRBG8KdjVcLKTB
GPYx6hFIvgCGiKbRwAwoAdBP4kkCNCpmkD34h6VgGP1r8PfyJAE0ESyNqw0AxbhLGoBZIw0g
46WHpzKuWEIQSETwJetLYsCi46iwhOghkrOzZgpIg/suyBCSajQpcD50WAphAYYYzOUkAPpl
OndJEEFh6Xh9STVVUE84gi+ezvjuTaFicVR9SVVIXPT3pSGwhpHvixIYMEQQO0rAz+SvAiqJ
qTWUwZAJyZAfRvCCl9HkgCDmTzAglVVBfaNYKeFfUrCGlMeKBh8woBBTFnD4koErgE4Fmzh2
MBqlAcay1PDt3lRJgyFxkNhgo8fCjLBjaVwjbJIFYA7gB/WX5fkX5ECx5Y8alv8oO16HZqAC
1wf8De6fenADMhiHe387fHd39W/K4wf2X01TFTnU/qNUtdTG/T9/JPxr9h/27AwfVv7DQcGI
hgGgBZJIaOpqfUloyZ0xzR3iVAuF+1gYOCYyxkmDER8zxjtwFGXafSpk+yQNhq21fR0V2cZE
0Gz9sr6/mjy8mgHb6g74RI1R4gDw8ivbq8e6aDfcyaKnEjBEJHhZbKg4zFpgKd4GC8Axg0Ya
Wh9gUyUEeSQNWI41WIcjEABM88gwTV9N24jcmP64UXlZDxr9sXFj+fBGZQjjlrExY7j+RuX0
1R84VoYsd+GoPEd1Iw7LgtVoGe3jV/2KQzyKMKuhPqihbYjx5oE8TWFoKxrqVGQkYbT27zsW
ZYl03VF8i7K+dF1YHGgV62c8i0MFtmGtIA6V+G97FYdmM7iW+E0mY/crwuR6GAoWZzBsQgBp
KcDfF9IIA16wRQyDpWxPGOAQ5jeCwKZMPySbwFQcQ+Rf8VSCzKk4JnvG5GukiRdrgqSHIxnY
MYYI8Bv7hAJglZ19DUXSAP7uzigTa7byn4VgR3yX7Tfn8UP8p4kcvv6jpjG+//ePhH8I/40y
q/tfwnej4Lrfg+dG1d/Y8NrvcJgOHXrtaTCaGTruft04zT6UwiaX6gsXkm2oHo7ZADTV15tI
wfgzURvksYQ1RacESML6ZNiVEKY9YFszgArIcnYOpRr0w468fPAdTPm3vLJDdeUAuV6Hcf+O
b1ZYYCTnLAuR/KreGG7dkZQ3sqN32IrO99iixswWJTdyRegx9AW26kHVQYpj+muHqo7hLR6q
YUsQtQ2vvm+9xmyQboye4+84jscEKb9xHY8R1/2823hsSG4Ux/GIgC2QDjZ0BhKAnLdMCAN9
ZQNlTGfz2GDZz7mbmZ5mCAV+z9n8d/3MY3Yxf7u7/H8RL454gsBvzuOX8N+4/++PhHH894v4
DzUy/kP9f8N/qHH8N47/xvHfOP7738Z/0O7C/138Z25pYur0mzl/DT86/0MNqTb8/DfU+P7/
PxNGfv8fGP0gstFeGPypfSSsffTfhK+nwY38ZsJ3JPu3VflfGRj9n4gGgfI/tgH45/b/IqH+
r6GFHN//+ycCe/0P3QBE/21HQf3w/W81jW/2/6iPj/9/JLiZgRNgHHVR6JDKDwv9xQ0lYQw+
yjZYNA2vPMhNWMANDR2GycwlbHhmjFiQyp9xRGbo0CdKbHy8cb4EcijbVCPMDZz6o0P+7B4V
NxwZO0QINsngCSNLKjc7tHcgEU0NJRLDQlnnCeoAsgwnkpvb4JGLsoNbRqAo1nYQWQguQjGM
PR2ybJs3oFjWxgzZ0XdgQHRh/+x2C6Y6GCVnqYIxR2JpYvg73L9+8uMv7K+AJWQKxBLw63SM
JeTf3mEBZ8TGmJUZOP+Cpl/sOf3kNgs3aAYW6mYBEi8Khd/lDmNewr5mPZgNK9/Bydk3McYg
t7Bf3jsBZzaUE3sUlN04IvsvCN/Y/99o9wfDj+y/JnL4+19aaurj53//kTDU/oeFjjK7GsFG
w4dYjxKPYosf3WL/jlXq0S0xvGL99RY0fN7gME0KY9+2AKdmewLfD0vIWsr+GkXEDs0QtBgk
V8bwHBLmzv5m+GDk19fD4SyGM4Ct07f5DAcTf2uNemQjDa9Vh/3aAvWPtcFYgwZVMtq75cOJ
UaMRQy+Zj6Q6eH2Y+WiwLCyLCzeWsMHV3LDBtWSmocQMbS/QmjKbpkd6Cf03vH8O5w1nNRpO
+mYNeczY5edXkX8CrYyylDwElECLsWGMzzDmSvGvgZJfWjn+7jvq/+K2gf9oqDTc/qP+dfuP
HN//+QfDEPuP+oH9R41i/7+JR7HF/2faf9S4/R+3/+P2f9z+//Nu4/8G+0/wpv1HnP+C1FJH
jZ//8gcDW/3DX5WxxN+9/RPGf6PXP1Lz2/rXQiLH/T9/JKxwSUBwglcu8H9gAIEoY8YbjSFt
JPg/cV7FRMQJ/isSZRwWVyTs8OC4GECl+FLRJACDJoPGExq9qYHggEkGTKxsQcSCxSkLCwtI
M3lYmyIQFhx8iFZjTdNBvg8QE6UEOSZowz8tORP8h35qchLzH4AoTvjD3ycw5OZgyg+HBMbN
g0cIuFxwAogW+pjEIIEv1gjEYujqBWYB8Q9AIIgTRi5kwxh08bMBmmbRwespXqZAfOyFYARQ
NC9lyAyB3+G+ACAYuhAaSmeEQFQqUxmEsKyqTLqJ39AZKXvT4MbbwIwYKURC/HAMfrCOrBFf
62A4PwKDDtahF7MMU0aSj0bFIJg6DmDSiY5EhyNSMEz5Ipn5zv6GbvHIko+Hnw32sW2ODrbR
3UJxYULRAxwi6/PByNi10lxx7pPiVvDFuknzxQpJd8iA1RBbC5JBNDuqkJUb+kR2VG6oorvG
TUcYnfDfcJ1uGjd3EvitSziBPUR3cS28QZ0Vx7mhkv5moIFBDUfSuuLpsojYadIdZjwIBPJ6
LPzoAhc8MnRIg3EbBgInDbIPXILsg+lfxuN6XT083auEENA9SB85SL8fJq2kEy/ARdsPidMR
CkrewQN+dMoODAwkMISMD0LEn5KDiMYgH3KgI5cbLL4+u3zrwZhOCsixYxf47QLcJZGVnZ5g
THwJRMHkb18B5RfbFt09sxxKH2fKF2sH6tRCmiuWS7pDCUx8Kfodx6zKakYy+3IWfcUgvYU0
lAam/wx2m0vVbPoF68+9Mxgs3td7MGmsey+UMPBdbNgnKFkMJP+FOFMh6GY1JDCXNDQ4xNaW
QYNnrIk0VwcVouGSjq3uCIG+iUl3WIPXezx3eW9xI1RP+N+bCSaCqDvw0PNbcYHv4sBswAy6
3b9KZM9g2AbVD0seviwEAGpVG0GfMTApTvj/2HsSqCiObRtEBRRFBMUNR0VFcLD3nlFBWUYW
9wFcIgq9CmF1ZkDD0ajIRCaIItGIiNERF5LggktQo0QCiguiT40SXBIJJigalRjc5VX3QETy
/8vJ+Ynv/Xe4c6qr7q17b1Xfe6u6uxqqRSRtqkW6l0WuWATOvX2qJH3/kKZ4BNFoYczrCQSe
NOqG6Y8ZSnTdDQ1N9my03yhWjU9oAL0JtwMOzn7V2Dhz1uwS5Ngyj3xQBdVZj03rqxeL+qsJ
j+qK3vSHSX9aP9lYqZ6QWjokddpGpImNOkuNdhH9//v2XEF7M1q3Z29q7wJor6V3wPkfOg+L
/qyzN3UDnHea2bJiS7Nk8Sq29KlYq7nz2oAhxgzJ/7PT/C0abxoaQg57S/YM6lp4bNldToyd
9JA85GpTQDQ67AnfH3W4P+CRzgGMUP2xhI51HmanAhd0WbLQNc8r4ZHVGYC9V79sVHBCR+C3
2S9OlYCTwUHLhx8DmYOc2EMxKMUwqDOXoiML0L58KKqVakNNIVt7FtS2tieYP5bePSKem4fY
d32jzrJpjJaUqbK8ABhtgY70RVllqhwRLVNtFjOD6qDRHlSUqbaaqHkm6hGjo0TNN1H3mKjH
jH0l6n4TWmqUif1SnTQ6S3m50UXKzxuHS/mlroXtYVASDKpKw2hgp3xgJ8mGFvpjXfXzzKSz
DBbD+TYoiw7vmrLKTBoCyKkisUIaozpny9onIrOPhW1zoJT5WGZ03x9lHCvOB+1E1jQHX7Hs
I34HGzL42BttQVwbghzTHOzFgk9f4xSpfjiYHhoNQTKDD2x0FEeBQ1+pHjeGi14PUqQ5cGLB
Z7QxXhLwNQmMNfj4pzk4A16jTNI8RXK5wWeCoXLASWn+cJaZnbLwSk1x9QcSge/9JNncoI8A
mGRlgz5aLDpKxXix2Fcq6sSiZEv9ArEomVO/UCyaLLqkyaIpry2amq4XW5HiL0+y6wPRrg0J
3sgFMAacxMlDvMv4zfCgFti+dsRLIFRi6CeGSbqPRe4SKbfM3SzmTSFjeFBrCdiUlYb6hIK6
gtoo6Le5TYTGwUeAvoyM5utX4+DyVvj5VnhpK/xSK/xYK/xkK7yyFb6nFZ7fCs97A5fm5+nP
wJWnuf81rfhrW+F3W+EPJFyMg3BxthFpjeKd+l8DB5t0toRm/a3zNvgvhM2dx7VE5RMCvP18
fKZjqFzlL8fkQYETAuV+wf5q+cSASX6ADHjmY2iYNoLW8Fy8TiP31EYm8TIPD5mYxwkugCdM
5R8W5O+lVvkOE3Wa/r9kLsvKMXfcnRBLI9i4WCFy7gjx47gjgD65SZ8cKHQXHxMgP17npYuL
mUTH8F4yF/DMHTNcph3e3IZ22DDZAI+3s0Dw3w/Nz97oFNOzdHNyAfhwkGCQzneDoNHicyD0
eplIfI+C/Rv73Qb/dwgOf10uBc/xeQCPaEF7BGhHAJ7RgmbLQFBNC7w1PAF1FkDOln5Nk4Ey
DNJokPxp8bvjEBQKEgdSfAu+haCcAlKW2Bf679NpBnlxnDjDeEHQbmhcZGwTcu2NmQeCnKGw
MBDrcbH8gkhxvSYOCqO1Wl4jlrOgMF6jiY0T9TmY00wcoMLmghCdoI0QaWPMBQ3PQ5DGPIaO
llY1ICjJPIaP0fKiOFRkplZ5TYCgse3UQpjEMY1nm1Yfe1oAWrz457Is4NVB74p4QuxvFGmt
pSmNV6knqSZgaPParX34v04x2kRWozNxu4S/mdR/xwJwG/xHQ9Vva69m0hKfo2nl7Q26eD2A
/we6lQUYe6A0Ix7EVov1U3tzHBynQUFQGDiqIDUoBUCToUkADwDHcaAswlGL+69EPS7SQt/K
7OZV23ZNeprXd1uCRiIEgVGhgSKhWGgu0BYJRUM80BwLCZA4ICdJPDCEg6SUchUk9igU6g30
NfP7gqSFWElPPNAXCWRjpTZ8oQngJ5O0aUCuBikeogFvFDjOBXIyMPR0krwOQiDxYdgF9Pa1
7mkgaUDta50I5C4tzc6BugM+H0CPATpN3BzQlwD4OEnK1F5rDSiQxyUdMtAWCnIYIiE50AuD
IwxhkHS7BWR7Af1TgGwc9C7QwYIeyiRLmWwTAXAdaHkkNAL85ks/d8AtB7SWMu7Suc9tsgck
+ZMGlN9bW5wnRU8Fg1oaULWgnn7DnlYWNa1Wt9vgPwLAgC8FmQ88EZ4Hr4C3wGfha3A93A0Z
jjBINJKJ5CBD0LmoDl2MZqH70KNoBfot+hQ1x2ywQZgc88QCMAZLwpZgmVgx9gyzwB3xgfgk
XMAX42vxz/HD+Nf4afwCfg2/jbsRFDGa8CemE+FEBJFELCFSidXEeiKfKCCqiFvEA+I50YHs
RvYlnUl30otkyARyEakn95JfkxfIarKeNKfsqIEUSnlTakpDJVOZ1BYqnxLfi0ivRNqeB/40
mN7/xtCxf9/r/z/3/p+S3v+jON72/v9twGv/Bzf945773KS/uI0//P9PnGzlfwpEQNv7/7cB
/dMsTYVO90Lux1WPs30Z2uigHalydo03+3Sn/fVt6V22jlvXP8SOGLnW9Z27ZqHRI6pmd8zg
XzUUzbxqcaHm0u6d9YOXrv92/XtxglPHS7d1tdN+GsJll1ptymDrkjbqrX969/T1Df4Dk6du
V7s3hPKwOiD/bmH+kx63H8Qe/b761H1mXXy3a+fWDKLYzzzsI7/QRcytUgRWr1iVfFaoe7Qq
Yp+V8+Cr50s79azLt3Q/QKvZjaPeCTxR+Y1BfcAJ21adiK1dXfFk2L1e+pGd2DO6yroX399r
SE20++iTu8SV4ETXSdFmtu/mDD1tH6DuURwXct7KcGhgvH322PgrX4z0zv9qX4HLlFFJ11mk
y5oo7+dlZWMSk8o23phcfTDVpyL6h19yBq81MG7hvwxnftmX8rGT48jF3C+Ov6hl5Y8yc7Zf
q3fPJo/PzKqZmjPxqPKbHqXbOsG70aEzVkdmzjXCdNRd1/mO6eUTL16IWN4h1Db0M0W7ob02
dLfr+qF+5Gxn+NRPq6LyL/veMjw/fmfNOoy8drZyY6B+1JpdezNPb+n6ZF3svqPlX920suMG
sBb+8d1GkadvOSJOUaV9kqyNVivYI5t623y8pNcHwU9vP9OdjL+3fGcmN3tMYbhMPWSLcve6
Kt8v7vWca7ZueMCGIeN2vFLXnnlQ9/LXs9/3MESd3nqzT35Y1o7OfYvU9n26bCSjDL2+mZkm
d1+yt9y14HDlPb8Pz+6EZxxYyyztmeo36trGxLqk3Cl+oSucG1atSnv66FFpY0zsw3NfL5af
yfaYM2zC9h8rTtSv7z2r5PG+kAVFFvlDi4vdsh8mTxs9fdmyLhvNXGfbLG9XnvPO2i9v+RGj
n7+IsrlyW9U31lCT+uIGfmHpnOyiFKN/UKHbmvPaGNmzwh1F0aURG2b4bp2VWyGvHG7etTo+
wX6BbG3RyZq8W+1c7R0gj1edggpHjJ0i3JFPq+pDL73IhFhvXXrfctjnn+4KbPw6tyrEadXt
hd692OM70brEbfMSxm5LSOZ6Dnj0sOCQ0W9tzd1fot0CD1I/JMVP7OUXn9uhpv3A3NrqFw27
5AP3xsyMPeLHI5U7Cm7d26kZsasxMPS7Mlp3zn0D2Sn1aUU/9sQFeu/Rhq7jndilA7y8uz0t
vlJvkTH+pC23PPjsDZdlM0LGsy/ia77Uu1lGaD/98VqO55XPPyndc93tI4OnO0vlTr3n1jtq
5ub77l3cKpXhayJ+XPlx3PrP+emJj6ek9Rqatjd6UCX1WLfm/nfzX9BndZ/4phR0roj7YNN9
96Jqf2W5sfHglfn3a06M9MzyXDRycO8HFm4TV2tOn0vtbD9hR0z/+n6k3WMv9aMp3p7Hnxyd
0W/1dyF0gtuC6vYdKxLbjf61+ohHh2ivrD4rSrxcBoXB5rs2Wx2bev7O8zmT3ZdVbDkZtb32
UPSPnTKtT7jaxBADq+wcVGMWNH6WnDj/kRYLG+dxM+5ccsiozcuX17llJC4iFi6IeDe2/YsN
dpcbd6T8+tg5v3Fxxp5XG1KOBlSCgwv98tVi1devOvheyzl92ObfO8O1wb8C0/V/ou/fea/1
h99/I1p8/w0T9//BxW2A2q7/bwFwBU+xKI0yKILxDMogFLgHU1A4w+ECh1GIzNVn8qRg1aTg
IBtrgaVolKMRBeBmUYpnUSVMkLCgUKLAwxwlc/VVBfmoA6YEB0yeZGNNAiVKXkBpgsRRilXi
GIvxCI6zFEMzSlgpc5W2nbKxVjAcD+74KZjGSJxQYCTNkwjMoyzGsBzP0TLXibyOHgFuTTWc
1sYawVAK5TnQbYKhCUypIJQcTGFKGFHAChYVmtgjtDytYSOaZHiSxmCOoEBDSprgYZqFFSDu
MIbmeYwkmmSa9z6RZEieI2FCQJVKRsB5GiMIHKMIFIZZBEFZRCFzVct/t2uK2sZaSSo4BJhE
lFaQAsGjKEaxDE6QKEMoWbalnMhPM4iSxAQWRkkOoZSABTiDURAUiaIwx7RsB5X0U5TAgQqB
ommWAHIwSxK0QGM8CfxAAruqTcqBx3ClwKMKJaMUBJpVYiTH8AQisDRK0mDggdNmpQ3fTPf+
bEQM0E5TGAX8jPIKUiEQDOgPh/A4xjEERWMILnOVPhbuFSttVmZjzfI4yRACw1JKJYzxLEyy
ChrhaIrjlYKC45v4mzrEKliGBgFDAJUsypEcxQGdLI7QFC4auSW3/LfNonicUTIchbMsDUwL
AhUmlEoMVRA4wgkKXNlCCgW+BuZhMRBBMIGiCgwlwMlgwEYgo5QcywHu1p+7tLGGcWBPEsQc
hwoCwytR0B4FRgLwGYcqcLxJ6PffyAKiKAMDw8IKYFgWAfFIMzRL8RirUPACIg6hVp9XACdE
iG6mEAWr4DEYhUHIoAwJ00qKQWmSYVuIoE0iJMOxjABTHElxoscZhYCRFI2wFKVEENEv/8sm
PkCUVMCgXwKhoGgwIhFagZMwzwkEhgsUquDeEDWJIAwrMEqepwieJQhEQfEIy7Bg5MIKkmYE
uqUIahKBORzEFctxINBImEEEEkOVPAXmFpgXcKmDb/yVOYhOhGGACNBJCRjNMkqSIxhSCbwK
Yg2jgVtbPZe27Sjxl0PT9V+c/P62Nv7c+o+0/x9GYm3rP28DWvi/xQXzr23jj/Z/BN5u5X+K
QNq+//dW4PX6z8ZMr8nLYPuyTqxZ+jg79khDXscAsvv9cR5Z71UW++62TMBZea9zw+c8qd2w
e1Za516sk9OixqLHz569/+hlli3T/WpxXNfZmpXbU1bVta/q9k7j2ltwpdvJld+gVpfPKwqr
lO1DFn+k/weeA2tdgke50Hd+vpFp6+K84o517/EfX/x89Grt5mE972b3UPWy6DKsxGb2opn2
m8IGmru3b2/YhlsmV9xst7sKKin4pjblSeBjxjNox66Hub7aqGFO21PjT2hezgouv3JIHvry
7NQ6m/lHEmY/1i9e4eO/f/+m/gd+yvO85Wg9axh3YpD8yNBup7LSrJ6NfzluUpeSiyfvzM+4
PmLbD31w76X7pzkcq+iQU1U43WHzmd7Bjz1v0UVCUXpe8oXy9wXvA5+m3R7oFHw8Pm4rXT/G
8tWZLf0mfDXIMa60qKfGaf5An969V+9Kd9qaOqPDvfT3ofW7U3oe+n/xvqvF+G9x8/vXtvEH
4x+BW+z/SlK4OP5xcLloG/9vAV6P/5ig63EXYdvJYy6v6VG61fOh8NDcf3/g4c/6uZl3uGW0
yw2aNfVGxroF6SrGr0Gf17iwOHYEnd7j1MNFVY+fX386t2xezuGguOzFJanpnzw9sEIT27Br
5uTyke22F/sdP7qtOO4wn1d0zdfe0nfFVr9RVoMv1hxYudXcTlt8I5wr6b/AJfGDT6ifn8/5
btPmW7eHZDpPt3O8ueSLwssdMi3QAPa0fu1397ntP0f2KBkq7/6x34SCpeEPzLQfUGrE+z7X
wblw7bxjyXaHv2SdC2JT82TqPR/Vz+m7pHR0uPeGgfvPlvuevOTXecEBesBMi7EvxldP3nVk
/vQbqTNkQZp+Q0LjbT5MDnb0nJN5Mxx/sD0lLHTl88jzFHL1BaMYPPhZ9eZ/cIEad+/1UWWR
lycmnp1X0fVSp2yY1Tk15F5I/jFpXY/6b7N9Ql1+7rodX7cldcNUl9CddZ237L1ckW7sWc7o
t41iR04ZrW+8/XPhICrvi4LUPQefak+wVw8fXe80SjUxZ0i74+8Jzxdn7V92/f0d8LKsO+aC
zeSF/1yf8NfX/pzJ8bwrC6ILv8sl7hJ6NO9D3O/ud2q7sk8L5fk8jFv1xNBIXNtiW0L/6vIj
EXf912Uofnv35vWr00V1u+fp7xMvUZjOvnQvT+QplxWB5enqWdVTc7c/q532rnLSrOXtDa+O
5qqqerxq/hd17dt/hntOB5w5h0RhNQqoDpDKf8j4Cg3sINT+MzEzR2v/AVWPjv/RBSDK/96g
jVmHDQRCc9stGhsUncN73wY42pToL43lkvVaENm69IjSupQ12mrdL6dP99omIiIMbB5+v3fX
+t7cvdFKLUoiqs/6fCXWn506a3JkwrlDxw6Y5shlRcm8bJzM/+zHlufuFvIFK+JjX8havj4p
8ET55p+ghiZzneo/OpoJGpZlX2dorvs4Vy+UeYfQpPuP11mrOzoc5X14ZXvs9v/TWDlUDTWU
j7ZM8Hx5gXnXp3Wxdq/NbVKFt316Fm8k/9Ut/J7B+6MHrZy9N7+7scmX45OmqKfJlnNVQZf0
183VKZ16cvWKPx0nd2t++PgtZL77/VvrH9bPF4/UUHtysHSufWhT1u3t7S83T2Jd/7Dn/o+V
obyXlY273bYekY66aVnXtvRI8nVX163lb7dvSRHRuGnefP++fVaf8mUFZvxBOqQAJP8H0XD1
B4n9f1Nj0Pi/2ej53/QBsPgHj/3RyA7C9z8YocW/qZnJaPufLgB2RjdoubuCja6CEjghKPFy
JYAZCUAxbGfagWWNsMmCTrwByxrjlNVzyywqLtHLyUxCUwIUyQO6Q0ehIDsdxNBUqAbdFAEU
LkosqtRLqQQKakBdqANzqib4eOvRoWHyADT/69Lw+gdy7n8wMhs9/4cuACn+0SYyqWcHwfLf
xBz9/gcDk9HxX7oAZWVlBVDZb6WANucKkggB3epgRdrVPkg3+ICMcATd+5BajGa8AnQ6GKTC
G3JuJFAJ3G6IhJaWAuyINPDhe+QdVA+BAx3Mgxag539q5nsYIDj/Y2iCdv77aP+fXgAt/6Pk
e5w3bWFmbPSsDD4cFkwa4cjOw+aIR1BzeOgWMmj532jg878hOP+Pnv9MH4Ca/43IzP9GIzj/
GxkN5fw/CkbBKBgFo2AUjIJRMApGFgAANtM/4AAYAQA=
--------------090108060506030400070300--



From rdpeng at gmail.com  Wed Oct 18 19:17:01 2006
From: rdpeng at gmail.com (Roger D. Peng)
Date: Wed, 18 Oct 2006 13:17:01 -0400
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <45365539.9050106@fhcrc.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>	<6phvemixy1u.fsf@gopher4.fhcrc.org>	<6phvemiuw3r.fsf@gopher4.fhcrc.org>	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>	<m2d58psl5d.fsf@ziti.local>	<5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>
	<45365539.9050106@fhcrc.org>
Message-ID: <4536618D.9070409@gmail.com>

I've encountered a (I think) related problem when using promises to load 
relatively large datasets.  For example something like

delayedAssign("x", getBigDataset())

runs into the same problem if you hit Ctrl-C while 'x' is being evaluated for 
the first time.  Afterwards, there's no way to retrieve the dataset associated 
with 'x'.

Active bindings work in this case, but the problem is that I usually only want 
to load a large dataset once.

-roger

Robert Gentleman wrote:
> 
> Simon Urbanek wrote:
>> Seth,
>>
>> thanks for the suggestions.
>>
>> On Oct 18, 2006, at 11:23 AM, Seth Falcon wrote:
>>
>>> Simon Urbanek <simon.urbanek at r-project.org> writes:
>>>> thanks, but this is not what I want (the symbols in the environment
>>>> are invisible outside) and it has nothing to do with the question I
>>>> posed: as I was saying in the previous e-mail the point is to have
>>>> exported variables in a namespace, but their value is known only
>>>> after the namespace was attached (to be precise I'm talking about
>>>> rJava here and many variables are valid only after the VM was
>>>> initialized - using them before is an error).
>>> We have a similar use case and here is one workaround:
>>>
>>> Define an environment in your name space and use it to store the
>>> information that you get after VM-init.
>>>
>>> There are a number of ways to expose this:
>>>
>>> * Export the env and use vmEnv$foo
>>>
>>> * Provide accessor functions, getVmFooInfo()
>>>
>>> * Or you can take the accessor function approach a bit further to make
>>>   things look like a regular variable by using active bindings.  I can
>>>   give more details if you want.  We are using this in the BSgenome
>>>   package in BioC.
>>>
>> I'm aware of all three solutions and I've tested all three of them  
>> (there is in fact a fourth one I'm actually using, but I won't go  
>> into detail on that one ;)). Active bindings are the closest you can  
>> get, but then the value is retrieved each time which I would like to  
>> avoid.
>>
>> The solution with promises is very elegant, because it guarantees  
>> that on success the final value will be locked. It also makes sense  
>> semantically, because the value is determined by code bound to the  
>> variable and premature evaluation is an error - just perfect.
>>
>> Probably I should have been more clear in my original e-mail - the  
>> question was not to find a work-around, I have plenty of them ;), the  
>> question was whether the behavior of promises under error conditions  
>> is desirable or not (see subject ;)). For the internal use of  
>> promises it is irrelevant, because promises as function arguments are  
>> discarded when an error condition arises. However, if used in the  
>> "wild", the behavior as described would be IMHO more useful.
>>
> 
>    Promises were never intended for use at the user level, and I don't 
> think that they can easily be made useful at that level without exposing 
> a lot of stuff that cannot easily be explained/made bullet proof.  As 
> Brian said, you have not told us what you want, and I am pretty sure 
> that there are good solutions available at the R level for most problems.
> 
>    Although the discussion has not really started, things like dispatch 
> in the S4 system are likely to make lazy evaluation a thing of the past 
> since it is pretty hard to dispatch on class without knowing what the 
> class is. That means, that as we move to more S4 methods/dispatch we 
> will be doing more evaluation of arguments.
> 
>     best wishes
>       Robert
> 
> 
>> Cheers,
>> Simon
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 

-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/



From fuss-h at ulster.ac.uk  Wed Oct 18 20:00:11 2006
From: fuss-h at ulster.ac.uk (fuss-h at ulster.ac.uk)
Date: Wed, 18 Oct 2006 20:00:11 +0200 (CEST)
Subject: [Rd] Line numbers above 99 not readable in editor (PR#9304)
Message-ID: <20061018180011.C0B73B6BA@slim.kubism.ku.dk>

Full_Name: Hendrik Fu?
Version: 2.4.0
OS: Mac OS 10.4.8
Submission from: (NULL) (201.27.210.144)


On Mac OS, in the file editor, line numbers on the left-hand side will be
truncated if greater than 99. They show up as e.g.:

12
12
12
12
12
12
12
12
12
12
13
13
13
13
...



From simon.urbanek at r-project.org  Wed Oct 18 20:04:31 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 18 Oct 2006 14:04:31 -0400
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <4536618D.9070409@gmail.com>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>	<6phvemixy1u.fsf@gopher4.fhcrc.org>	<6phvemiuw3r.fsf@gopher4.fhcrc.org>	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>	<m2d58psl5d.fsf@ziti.local>	<5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>
	<45365539.9050106@fhcrc.org> <4536618D.9070409@gmail.com>
Message-ID: <8332D09D-AAE2-4892-94DE-64E2AA4509EF@r-project.org>


On Oct 18, 2006, at 1:17 PM, Roger D. Peng wrote:

> I've encountered a (I think) related problem when using promises to  
> load relatively large datasets.  For example something like
>
> delayedAssign("x", getBigDataset())
>
> runs into the same problem if you hit Ctrl-C while 'x' is being  
> evaluated for the first time.  Afterwards, there's no way to  
> retrieve the dataset associated with 'x'.
>
> Active bindings work in this case, but the problem is that I  
> usually only want to load a large dataset once.
>

I agree. There are basically a few options AFAICS:
1) document in delayedAssign that error conditions during evaluation  
will lead to unusable/unrecoverable state of the promise and add a  
note discouraging the use of promises in R code (as they were never  
meant for that)
2) reset PRSEEN on error in eval of the promise code (probably  
expensive as it would apply to every promise)
3) optionally add a flag to promises created by delayedAssign such  
that those can be distinguished and handled separately (e.g. don't  
set PRSEEN, or install an error handler before evaluation to reset  
PRSEEN). This would not affect the internal use of promises and thus  
would have no impact on speed. It would, however, make them more robust.
4) add a function that will reset a 'rogue' promise (e.g.  
recoverDelayed(sym, env)) which could be used in a custom error  
handler in the promise code. This is basically poor man's version of 3)

Personally I would vote for 3), but I can see the arguments for 1).

Cheers,
Simon



From simon.urbanek at r-project.org  Wed Oct 18 20:14:03 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 18 Oct 2006 14:14:03 -0400
Subject: [Rd] Line numbers above 99 not readable in editor (PR#9304)
In-Reply-To: <20061018180011.C0B73B6BA@slim.kubism.ku.dk>
References: <20061018180011.C0B73B6BA@slim.kubism.ku.dk>
Message-ID: <859CC83D-65BD-44F3-A9D6-57C096B4D0C8@r-project.org>


On Oct 18, 2006, at 2:00 PM, fuss-h at ulster.ac.uk wrote:

> Full_Name: Hendrik Fu?
> Version: 2.4.0
> OS: Mac OS 10.4.8
> Submission from: (NULL) (201.27.210.144)
>
>
> On Mac OS, in the file editor, line numbers on the left-hand side  
> will be
> truncated if greater than 99.

You may want to increase the margin size in the preferences if you  
wish to see the full number.

Although not a bug per se, it could be useful to align the line  
numbers on the right instead.

Cheers,
Simon



From luke at stat.uiowa.edu  Wed Oct 18 21:04:07 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed, 18 Oct 2006 14:04:07 -0500 (CDT)
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <8332D09D-AAE2-4892-94DE-64E2AA4509EF@r-project.org>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org> <6phvemiuw3r.fsf@gopher4.fhcrc.org>
	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
	<m2d58psl5d.fsf@ziti.local>
	<5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>
	<45365539.9050106@fhcrc.org> <4536618D.9070409@gmail.com>
	<8332D09D-AAE2-4892-94DE-64E2AA4509EF@r-project.org>
Message-ID: <Pine.LNX.4.64.0610181349000.21388@nokomis.stat.uiowa.edu>

On Wed, 18 Oct 2006, Simon Urbanek wrote:

>
> On Oct 18, 2006, at 1:17 PM, Roger D. Peng wrote:
>
>> I've encountered a (I think) related problem when using promises to
>> load relatively large datasets.  For example something like
>>
>> delayedAssign("x", getBigDataset())
>>
>> runs into the same problem if you hit Ctrl-C while 'x' is being
>> evaluated for the first time.  Afterwards, there's no way to
>> retrieve the dataset associated with 'x'.
>>
>> Active bindings work in this case, but the problem is that I
>> usually only want to load a large dataset once.
>>
>
> I agree. There are basically a few options AFAICS:
> 1) document in delayedAssign that error conditions during evaluation
> will lead to unusable/unrecoverable state of the promise and add a
> note discouraging the use of promises in R code (as they were never
> meant for that)
> 2) reset PRSEEN on error in eval of the promise code (probably
> expensive as it would apply to every promise)

Definitely not an option as you would need to set up to catch the
error at that point ant that is currently _very_ expensive.

> 3) optionally add a flag to promises created by delayedAssign such
> that those can be distinguished and handled separately (e.g. don't
> set PRSEEN, or install an error handler before evaluation to reset
> PRSEEN). This would not affect the internal use of promises and thus
> would have no impact on speed. It would, however, make them more robust.

Doesn't really solve the problem because delayedAssign isn't the only
way to get into this pickle.  The current implementation makes sense
if promises cannot outlive the calls that create them, but with
lexical scope that is not the case. Here is an artificial example:

     > f<-function(x) function() x
     > g <- f(1)
     > g()
     [1] 1
     > g <- f(stop("foo"))
     > g()
     Error in g() : foo
     > g()
     Error in g() : recursive default argument reference

There may be a fix but it won't be a quick fix, unfortunately.

> 4) add a function that will reset a 'rogue' promise (e.g.
> recoverDelayed(sym, env)) which could be used in a custom error
> handler in the promise code. This is basically poor man's version of 3)

Might be sueful as a debugging aid but I'd be nervous about using it
in production code.

> Personally I would vote for 3), but I can see the arguments for 1).

I'd prefer 1 until we have a chance to think this through more
carefully.  Given that R has side effects it isn't clear that marking
promises as unevaluated if they did not complete their evaluation (but
may have completed part of it) is clearly preferable to treating them
as evaluated if they haven't completed all their evaluation.

Best,

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From jmc at r-project.org  Wed Oct 18 20:36:24 2006
From: jmc at r-project.org (John Chambers)
Date: Wed, 18 Oct 2006 14:36:24 -0400
Subject: [Rd] Caching bug with showMethods?
In-Reply-To: <m2zmbtsnm3.fsf@ziti.local>
References: <m2ac3uv954.fsf@ziti.local> <45362CA9.4050803@r-project.org>
	<m2zmbtsnm3.fsf@ziti.local>
Message-ID: <45367428.9040606@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061018/aabced44/attachment-0003.pl 

From khansen at stat.Berkeley.EDU  Wed Oct 18 21:32:37 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Wed, 18 Oct 2006 12:32:37 -0700
Subject: [Rd] Problems building package under Windows (PR#9303)
In-Reply-To: <20061018171153.A2F9E4D2D9@slim.kubism.ku.dk>
References: <20061018171153.A2F9E4D2D9@slim.kubism.ku.dk>
Message-ID: <7EC66C92-3E6E-4658-9ACA-67EA48E102F4@stat.berkeley.edu>

(I have removed a CC to R-bugs)

It seems like you are using windows. If you take the time to read the  
R-admin manual, it tells you how to set up your system for building  
packages under Windows (R-extensions tells you how to make packages,  
R-admin tells you how to set up your system). This will answer all  
your questions about perl and so on. Essentially you need to check  
out http://www.murdoch-sutherland.com/Rtools/ (but read the manual  
anyway) and you might also want to read the R for WIndows FAQ.

1000's of people build packages for R under Windows, many of which  
includes C code (C++ can be a bit troublesome, at least in my  
personal experience, but it still mostly work). The are myriad  
examples of such packages on CRAN (as an aside, for C++ you might  
want to check out RcppTemplate). You might have paused a moment to  
consider this fact before you assumed that just because you cannot  
get it to work, it must be a bug.

In the R community it is frowned upon to submit non-bug bug reports,  
please read the guidelines for this. Essentially this boils down to  
the fact that now someone in R-core needs to spend valuable time  
cleaning up the bug report. It is furthermore considered polite to  
give your name in emails.

Kasper Daniel Hansen


On Oct 18, 2006, at 10:11 AM, agner at agner.org wrote:

> This is a multi-part message in MIME format.
> --------------090108060506030400070300
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> Content-Transfer-Encoding: 7bit
>
> Dear R people
>
> I want to contribute a new package (various noncentral hypergeometric
> distribution functions) using C++, but there are many errors when I  
> try
> to build even a simple package.
>
> Here are the most important errors I have encountered so far:
>
> 1.
> Trying to build the DLL, it can't find some of the include files. I  
> had
> to make the following change in Makefile
> and copy some .h files:
> ---------------------------------------------------------------------- 
> -----------------------------------------
>
> CFLAGS = $(OPTFLAGS) -I../include -I. -DHAVE_CONFIG_H -DR_DLL_BUILD
> replace by:
> CFLAGS = $(OPTFLAGS) -I../include -I../../include -I. -DHAVE_CONFIG_H
> -DR_DLL_BUILD
>
> 2.
> Filename case sensitivity.
> ---------------------------------------------------------------------- 
> -----------------------------------------
> For some reasons, the perl scripts "build" and "check" are lower case,
> but "INSTALL" is uppercase. So I have to write
> R CMD build
> but
> R CMD INSTALL
>
> You may consider making Rcmd.exe case insensitive.
>
> 3.
> Problem with tar in BUILD and INSTALL scripts:
> ---------------------------------------------------------------------- 
> -----------------------------------------
> This doesn't work:
>
>     # workaround for paths in Cygwin tar
>     $pkg =~ s+^([A-Za-x]):+/cygdrive/\1+;
>
> It works when I change it to:
>
>     $pkg =~ s+^([A-Za-x]):+/\1+;
>
> This should be fixed everywhere you call tar
>
> 4.
> Trying to execute zip in INSTALL script:
> ---------------------------------------------------------------------- 
> -----------------------------------------
>
> system("zip -r9Xq $startdir/$filename.zip $pkgname");
>
> There is no zip in Mingw, or I haven't found it. I had to change  
> this to
> make a .tar.gz file instead. Remember the workaround mentioned in  
> point
> 3 above.
>
> 5.
> Cannot install archive
> ---------------------------------------------------------------------- 
> -----------------------------------------
> After the fixes above, I finally got an archive that looks OK, but it
> will not install. Trying:
>
> R CMD INSTALL Test1_1.0.tar.gz
>
> I get the following response:
>
> ---------- Making package Test1 ------------
>   adding build stamp to DESCRIPTION
> Warning message:
> *** someone has corrupted the Built field in package 'test1' ***
>   no R files in this package
>   no man files in this package
>   installing indices
> Error in Rdinfo(RdFiles[i]) : missing/empty \name field in
> 'c:/PROGRA~1/R/R-24~1
> .0/R7CFE~1.INS/Test1/man/Test1.Rd.gz'
> Rd files must have a non-empty \name.
> See chapter 'Writing R documentation' in manual 'Writing R  
> Extensions'.
> Execution halted
> make[2]: *** [indices] Error 1
> make[1]: *** [all] Error 2
> make: *** [pkg-Test1] Error 2
> *** Installation of Test1 failed ***
> Removing 'C:/PROGRA~1/R/R-24~1.0/library/Test1'
>
> The first three messages don't make sense to me:
> - Nobody has corrupted the built field, at least I haven't touched it
> - There ARE R files in the package
> - There ARE man files in the package
>
> The fourth error indicates that it doesn't recognize that the Test1.Rd
> file is compressed. I didn't compress it, the scripts did!
>
> I am including the file Test1_1.0.tar.gz for your inspection.
>
> ---------------------------------------------------------------------- 
> -----------------------------------------
>
> This is as far as I have come after several days of work. I still  
> don't
> have even the simplest example working.
>
> Could you please tell me how to get around the problems I haven't  
> solved
> yet.
>
> ---------------------------------------------------------------------- 
> -----------------------------------------
>
> The poor documentation makes things worse. Allow me to propose some
> improvements in the manual "Writing R Extensions":
>
> * The manual doesn't tell clearly which directory to run R CMD ...
> from. This is important.
>
> * The manual doesn't tell clearly what software I need to install. I
> figured out that I needed Mingw, but it would be helpful
>    to tell which packages of Mingw to install.
>
> * It is not clear that you have to install Perl
>
> * It doesn't tell that I need to install MS HTML Help Workshop.
>
>   There seems to be a problem calling MS HELP (hcc.exe) unless the  
> path
> is specified as DOS filenames without spaces.
>
> * It would be useful if you told where to get Mingw, Perl and MS Help
> from. Maybe I am using wrong versions?
>
> * The manual needs to tell whether to use _cdecl or _stdcall calling
> convention for C/C++ code under Windows32.
>
> * A full working example of a package with a small C/C++ code would be
> very helpful. The package should contain all
>    necessary source files and the commands to build and install it.
>
> ---------------------------------------------------------------------- 
> -----------------------------------------
>
> And one more thing:
> I had severe problems making Mingw work on my computer. The error
> "Couldn't reserve space for cygwin's heap" came up all the time. It
> appeared to be a problem with DLL's having conflicting base addresses.
>
> Not your fault, but when I tried to avoid the problem by compiling the
> DLL with a different compiler it turned out that I needed the file
> R.lib. To make R.lib I needed R.exp. To make R.exp I needed to  
> rebuild R
> from its source, using the Mingw that didn't work! When I finally got
> Mingw to work and fixed the problems mentioned above, I got more and
> more errors from make, and when I finally got an R.exp file, it was  
> empty!
>
> May I suggest that you provide the files R.exp and R.lib with the  
> binary
> source for Windows, or make them available for download. This would  
> make
> it much easier to use a different compiler. For example, the Intel C++
> compiler has a lot of advanced optimization options and big math
> function libraries that one might want to use.
>
> ---------------------------------------------------------------------- 
> -----------------------------------------
> For your ref. I have R version 2.4.0, and the following Mingw modules:
> mingw-runtime-3.10.tar.gz, w32api-3.7.tar.gz,
> binutils-2.16.91-20060119-1.tar.gz, gcc-core-3.4.5-20060117-1.tar.gz,
> mingw32-make-3.80.0-3.tar.gz,
> msys-1.0.dll-SNAP-1.0.11-2006.04.23.tar.bz2,
> Windows 2000
>
>
> --------------090108060506030400070300
> Content-Type: application/x-gzip;
>  name="Test1_1.0.tar.gz"
> Content-Transfer-Encoding: base64
> Content-Disposition: inline;
>  filename="Test1_1.0.tar.gz"
>
> H4sIACFENkUAA 
> +yaB1DT2bfHf0FFehNFUCD0IpBCIARRWuidBBGRJgQIJYEkNOkCC9LrKhZA
> aYILigqISJESBJQuAhasSEBQUASk+IKw+9+37nv/95/5786b+eeTuXN 
> +555z7/0mJ7kz906w
> ODIFBgH 
> +UqBQBBSpokK3UChSFbFhYfSu7/4WAAyqAlNBIOBQZVUACkMgVJUBsMpfK2uTADLF
> hQQGA9puvngCnkwhuVCIpD/J+29x8t+h7G8B+73+rp4UX5+/ 
> 7FvwL9UfDqfXX0VFVYVR/7+D
> 39f/+7OSq6fvv3kNerWhqgjE/1B/BBymAv9D/ZFwFSQAhv6bdfwp/ 
> +H1N8Ji9LfRrTO9geit
> kS+liHk7APCsgcLKQ/t48ziAgk7xife8f/Cdt8bv3bLBWxbLs2kfbNl10Kb1Qv 
> +wruVGCEtv
> bBsd9HymLQ3f6Pyat/G80cdK1+SVyeSgJNbHe3F5UwN2K/4rlmYGprEc/ 
> xj3fezGrsYCkTBC
> HzVEW4Oiq1gLvrtYHbqCjXkhEhistZG5AQYUPWAZrUGPYewwWD0zIJr5EpruYS0sjXTpwX 
> 5W
> LbpnY21KT6d7IbabHlbHlO4ZQdkhkvpG7hS8mQueAIqO8awQY4VIWugYG5ljsKBZs5x9uy 
> GS
> trbaZDLRFe9CwQfiTPEEb/KGOOE/ 
> DViSiH44EiUENGu0nXcjwwQXEkQkuf02bM8PnTpYEg4H
> erYj3XT3DzG0C8UFNGNlzv9DxMzFDzQryib4Q+AfCuTAnBAo1IjghgtW2tgoQKdF4 
> +xYIT5E
> D6KSl58HqFnkLI4VYk3fOJRcyWTQ6LZYpl0QysZmoujn4urt4oHbHJYanM7HvhnY7MhnSz 
> dm
> 29p2KERXEHBadDMO34xfw6Yb86urb4jH0GfCQcxdfOmfD5kCABqyv+/H0H 
> +T9GUgZhhdoq8f
> CUcm49wgukQCBUegAJeN2yQV/k/ZJKLPRhbgtV/un+bTQwQjgjsROMEC 
> +afJWJILgexOJPlC
> vqvXkHb6F4aEIvV14WooBFQRhVaGKcJgaPqTDhypCIVqQ3VRMD2ULlI3HGJEoO9kBFfcxr 
> wb
> XxD8X7yENY6Mo2BdTvjggAnC37JVM2DAgAEDBgwYMGDA4D+Zr0yjoCAQN 
> +g0cBgQBUQAJoAD
> sAEIgCtABHwBP4AE4AAy/YUD3OjZHIAZgAF0/ 
> zQWCiABfXoMDqgBKAABQAFFukUDygCM/gSj
> v9D0Pg6vzXWZ6c302FHdjRuLX9vWRQewcZvCBmwHuNGqeqzAHsDQUBt8BEci44kEMEIJiV 
> BS
> Q0Lh9LgksHHPAmyN/HU0wOZX1DFP/c1lAjiB35+96dMLAtZgQ5yPH5h+dANvHbDB3w/ 
> RdF3M
> wPfz9XcNvx2s6bPzAH843wM76Rr2E+I0OIBNGZwAwIOVwJiVG/OBNpbfEvfDbcz/ 
> BvD7d8KA
> AQMGDBgwYMCAAQMGDBgw+H8J99apn 
> +X7vze0AUspANAEGtYrptL3ZMe3H4g1Tpc8lW56fv6y
> bUPDjQXHO7IVAZmSBdWJp7T7groyDgaMqHmyFMfE 
> +N0CnPXdKz3pM3LUPlsMXmqoVxB7nin2
> zMyo0P6AEkHvRo1I+KnYCibVsl2OfoVFI43Phiqahp83xHXqVIXXm1Ct1pUUa0fAbJU 
> +ejk7
> yJKc8kdgYdQrcjZl7Hy7WJN9c5b6v24oPMcLlUWKuzdl2ZNGTamCl9ld 
> +tx2grUWdqO1BN5a
> JXBtS9QoeDnHkdYZFHZdOc3M+Mrl0vJYK37rbDxrFbbLwThRegZMZipCZfe/ 
> si7efo0fmSSk
> F3hOIkMiXXYAMRRb1Bsi9YHthJf4NevytutY1iQdsK86nNc+WVA8eWryso/ 
> M2Kt3uVQJBXTu
> CXyEXi4/lxi1MiuceB3ZxtWORcDUA4v9eGtaTGTbRJJ+6gEn8 
> +tJehOOf5UYuF9BLW3PDIyL
> dTNKPs6mfnBFYN9NYl5+kkDiZHSwdLU36FDkdojBenI8bU3Qcjl01/ 
> LtjpD8epHmxYg5dFui
> BJ+M+WxtxDc/YsXe4hO1CwL1DZByj8QmyZq9TE4x3nyuS 
> +Clk0/629rSYRlHvXZ31NrO8b7U
> HPtccTuswiSJowfXKVQoUBesnbC++I2v2v7DGbcmkzyl/quBl99qoa0VIG+YB 
> +9nkK7ONEd9
> GhPmcbFX8+OldnQ+FkgZFV/ 
> t8YnXqDEOS3Qa0VvAfqnmQxyOXD8sVp1zlcPicLa69JUZIde4
> j2I1aXosrUeGr4q5tmoAT0nvDfdk2zBnTmY5S6HmKEXCyXacQWEJQXDhktqVjGY5vqUdL3 
> Gh
> dQE/tYzsmnNiZ7VNonXozHNfar1UANmjSRqFY9s7C/ 
> XHBJRgNzxZMIZFTmoxiNneHVap52VS
> +2gHushpuRGtLMmKlTE7nJpJzjN1 
> +PUldYEPkOKnAjrXbg7a311hYudDv8onm5Rr3BwZio63
> PTyqLwZ5i10KEQ3UjDc 
> +MOTU5QqKHl08nbU0lzEtsZor0CeuTZHcV3rMOKFGqKNvjuYfRxoO
> 3YvqsugyUBKxbHwnQ2I18rESrHWcWFmbq4ZgBp2l2V0VVORvFoSO7RmO4oapGtvM/ 
> 7wK84hW
> ez5HgwSOJLT1tSlWVb+K+ex/k5DYe7qjJ0lCXKpu97jeqkgtJGsh0de1bW 
> +75uGTYke4J1gE
> MAHozJ7W0GHEuNaSbuoHzw9C8UJmz0Iknj0421Ke1hv0uvTlFJO1F// 
> d5IPy8c1v3n8pDcvE
> KB6YsAuWPySDMkjiscpI57Gs7fsgKMdOHUhSFHUrbhm5qyid8PldKu/ 
> EyVvNNwSmnKKEq9Sc
> NBL7uYeo7NRPeIFtt6hMn3ZwdiXV+XksK95AVKGVxtmr+EVTmEW7qbdFM 
> +Q08p49vrG2nlBo
> PWa5LGjg0tZaMF+W3rYrFeEiJBBE4+IO1wUR2QWuIUmj5lKr1J/ 
> NqEFJ8qFtPlq9nOX7PeXu
> UArTJA2fC/TdesVxTNnuzMMztXqtSQaVR2Er0ayZmDCfJslG 
> +QnahwNC7xrPrmMIjTja89l9
> GNQ5V8L7oPJxYfDOT/ 
> WzllP93aQKf21CnugT8OhufyZ5ke72n0SFZPjWzZZy89979mu2PKHa
> NcPdu8L97z71TLe9FjZx34Bnwrcuci78wYtdiJHq43fClkPDHDsculAiIzeXbmsQyh 
> +juRMu
> Ok4cCAeR9uA/XC/iRhHPQgoOo0mcVWfewMoCEVF2K6 
> +btO5TMwKJLS8Pt9bfd5J11HmoXMdd
> 53In7dtcH19+gz5m/lpmZfaVCx9rZrcNrqPcMQqIa7X6Qq8vne0Z8zgxu5YuERyfX/ 
> tTm7j2
> K6GSU+2yDgtttZNWl40Py1LLPtcWNMd/ 
> FUUI2Kx66HDSvMbm7rXYP93e80VsfvR2b1pamWeU
> nt3s/OllXlYfwdnbmqqLpwJRMT1PBVaQiQ8855UiW2c4sobgQoOqSkkXVrMMCHdrPt/ 
> zXw3e
> NV8ic/ 
> wSRvDEChoiKufs3iQeveafjffRZHvsdWEE9k7zFHhyX4Qj3q4n7tu3cG81n3eoHRyP
> x+ 
> +WpnUj34zmGYURCD2t7xctItg0OSaufYkx2h1p2CtdPdKheWV01aIpYaSse854fLmJfK/A
> Vky8zPGOwRo0/Xl+ossgaKkpxrZUeKZRSLPpBmrgcUfao5VQaa0E99SL 
> +d1hzT2zfpnHcp3X
> YxNS9kR+U9aYQdquPemNdxLuE5tfx9iXrQ8Frqy3FYtc15D+tu3To5/Twj5n+SceF 
> +FSpuZ8
> 1YFR5HbkfNulad10r0LiymPd3vu8n7Owlb2gsNA3h8wlSLsNEnQRAc 
> +DvnVlumr2Tx58m4LN
> CvDqB5N2LtwnStUOIoNoaTzKk2vCe3xmzTpFn13qQjoL8ZYERJ5oK15MeRKUxH53gZS/ 
> OPz6
> ZVPKDE/EKc5R1BwnPhe9gO19gxIoHX+I+yyieNdbXb94 
> +bgC0xtFmSnxcb38Z7FIpAFS0/+V
> 6rhc5G2T85qI+Iw6x3Xh0uHI5ccHG7elVoT8PGK/Vn8+2D06OKU2bEdg+z2pW/vLEZHG 
> +pVe
> +PzG4xwRJ7bXufe8kaAYyDKJInjvJrJE3NNQtqq3sJJfg5dYzlGF5iMJHo6Owbg4g0Xec/ 
> d7
> WXisDCTtnl/XQDZ2OZh3LB9PK4WJHVaPOvge0hj5 
> +mnoGcrn5jcnPPTKw4k9OQ2qXbUzumNr
> LKVhnqYveMUTxhINeMTQCbziMyxoNK/46GrN2xfELCMan7Nc7TbCBRAQddOWyUu/fq/ 
> cnebs
> F9IpvmNRn95bgbm0hNwf8DtpGnIN9/ 
> mgOb3TpczuG7yx48vX2F9pvN9DqtO6BC3vsPOZsjIl
> 16XlCVzKmBxfp9uX7Dp1Fs71kcxdVSIZrqpqmimDy 
> +WzT3NvBX0JuOdME1QKPJUBkm5ODeXr
> 7QOV75uRWmyu0nc0b3OuTy50juqsSBQaOC/Ffn8+JnjboukrZ0l5xCc91AWus3LWY 
> +jT41ef
> sucnktzGb+PGjTALQ/6GOano5PlfXhVlr14pIfVXjnMfyz/ZtJ258vya8pM4tZ3wQ/ 
> FLH9V2
> jnNe45pKCFGVjOq1H2gHyQA6mKCLGtd7A16/zJ5S0J 
> +erCs5oKVQNjpRoeZJWzBrrbhcLv7V
> sB5BizVcEFgI5vGWVJl+elSVFk11kbzi7az2cruHJMFk9511WnWX1o2e9ByZgAdF 
> +w5Uv6yz
> U3qvfqTybOFD65GXhzwDd8dVTPTM7J+QiZ7CDviAhVNLWHfHVxVfpEFFZz0OPTx5WD 
> +yS1ux
> 1lqVB0wGn2PuflByQz6SplAwlTpVcS4k7+O7O7OhdpCafCb7gCKSRM3 
> +160f343vfWC2bxq1
> aOyi8KJbjNn5LdfAjDOf3D2je42jF6QiG71cygPubFeljJlfjI8DT54jfcZP9Kn02ltZ 
> +w+e
> c7booHEkqTzi5FizctyWNOIjmWNDMD70Zfho975CvmpWC2TPkSn4g4kGxUaMTUJHDt6K0r 
> xS
> 16Jy9NGb3J5HU9V2AVlvJxHRjhd4mFemMwOzr4U8drsFlbHNOf3kRlG 
> +HQ1vUDaYW31gYJt5
> M4tHLn4f0VXTQZkGta8EP3tXj+0sfur++WHtYP35+Fk1sdFOfumZVj/Pad+pCq/ 
> B1AiWlSBV
> G4dM9+fiSm9ZgmgSVok61NnLpWFD+m9vKL8LcZhao8Sx56j0y75O2KOuzTw9dVY3Oi 
> +ixql7
> 7zH2eXJvHIrDkpoSmF9xkMIm3TMteMmK3CFHMF1vNGlwO7/9uckFsq32GS6VsIjjstT2k4 
> 5Q
> skR/TOH9YpdCFUv10Sl579unhsY4z1pM9S6riCRKn1Zl1Zz/ 
> ID0MtVCGVsmeERMqjcjqJlOM
> H/altPQ/SrU26+35CM841lq7rl9YJoI9Ft4YVVJ9sWca5fC6m/ 
> meqZczQWHx6UFMe0BZsUkz
> lvxSji0v9nSZ/sdHfcbB5zhQw7MODx/mmcB/ 
> kVYc6mHNFSu7ymTSDgrgayqQu1Uv7vciJ+Vx
> Nv9eYZXU0OF7JTsfXez7+OTnEZPpuIv9uVMNRbOWk4n89fvxjnmXupWnDsJp072/ 
> GMmdi1XT
> Vqu2GqiMnWQJ8sGOBXZG2nq2yA4eLfcytXEQU/ 
> EcI6WpB9dalPQXWHDTrmOR7Onv19qmk3bh
> nMXePVK3OUUw9DA1z/bvu806haJM+x8Q9i4bPfIFIyUsf55aOTEwcreUUKFo+/ 
> pIDSWXuneS
> 2X3/ 
> hUqf9nNXtHTctOSVwyg6JVI7vSquioanjg81VHuYse7svcrnsHdEcfDQ2LRfms9T/i9L
> DylXcb5nOFZFL+bZ+zSU632YlmC2sU2FKT22KPR61HKF5re/i116QKoSh/EKRYYcyZxa 
> +diX
> Pjj6X 
> +xdCTxU3fsf2be0apOunbLNWLMXihKy74yZYYZZNDOWki2lJCWylCSFEkWLtU1Epbdo
> Qam0CpE20e5/750xDVHq7e39/X5/58Pcuec+5znPec7yfM95zj2zwK32KVfYq6g 
> +Cc3gE4Ur
> zk5J8kveHdwpXXDG7J4nJuWKg+0G+3N15kvozc9OrGzsmbC1g/ 
> c9htSyT2NeT9zkXsEuCxtx
> d89+5Yy7N20frBJ9MmOq7+oT85Ujy2 
> +l3XOxqM5M7ws4ZjFfvDA2F9921qU7QDi9VHxubAHe
> +ZDDrlNWLSSii8Yn45aElgmpzbsIjtemlVgcWEKL3bqTknFpadTipDzVlA4xkT1cDftPSC 
> f2
> XGi4HCF 
> +23mm8gmHjg92XTfQKbqlpXzFXuSGJuGnFvsDN87JKO328LHROHkVGWTllfBWXrdR
> 71hFbVtMbUyhN1V51gLLzIAu55Ry+ro5h0sEMBHnll6rnEmy 
> +hQYb39dJvbxnmcCco4Ca1wW
> PMoIq3JwynOoNm8vv2aftSDro9thbNU0nrVy2ypjn+W4yDwJbed 
> +YiE0z1ktSC58el09kCo4
> o7FPW5Ljeo32fQ3aDjm1NwkKa+ikaadrUqK2pq3tuTtn19aJB1/ 
> dn1bt1up2QB791rYqzT9f
> TtC42m0jpr3z7S5L0a7EvSnu8ruOZxfYHDCMqq+af8+4YvnT9U1vbpofWjUrr 
> +yZUOyqW8sq
> +G9gqfvULme721z5y+ehWcDsGRc0FrbWrTznc6oC5bAliKz9xqk 
> +MM3p4NwwkdhML7vGbSis
> g3785BuGKw+iFzyqWTOjdovrLtnGCarH 
> +gJ3F8zOP3ekM8ztkO4NxRKzLOXDxwWl33gcbg1M
> C1i/ 
> egnV4K9zJxt0ZJEFIcZq07m4ltKoa3hnxDXHqrq1OzSsKJPCPSQtcDi9ludIfXbVS/c5
> dn5HZHycRNLvHElciFL375qhUVW0OH3byevmvV7HkXXrG13xM7rEZr5ZVn/ 
> 9lUUF2u5eD9nM
> vm7Jnhu6lyp58sKuHZhN783h+Zi7uCHFK9Wx3rNZNHet6TUpjS/708tqSg/ 
> L68lhejqfOi67
> Sc7vXj0Xe2bru/nN5w0K60w1feq0qy9VBLkLmnrrhO6tcT+mkuvXzN/7scB6 
> +klfaaSe4cl9
> D+7zdygXPjsswNd48UO63pc7pqR50SsWXjro 
> +gzFI4BIDRKcnFkzgV4gk1N25sjd3qTz659j
> 3oh17H96d9YsTZ3EZWaUA 
> +sXWPSdcF3fde5jIkfxK1JPm9Z7xXP6x5ykCuZN1Jwf7741N+rG
> NUea64yKQ1b38gULaEqXZHt3u5k18Pd15hk8NUITOidPe2MbTah4Et/ 
> YFOBx9fj8TVzJc65J
> NC6ZvjuPe4dOS9Merq57S7TIK+5wL3Hc78mnaxLSTnXKnC2zefVLv/ 
> ndaTGZnXxq4ffdc2p3
> 3McUZoSuvmDuuqLjrPnGvtWzSKFt1dKe6rMcGiPli2ZVTnVb0aug1N3vuaJJcWMq3sG39s 
> Or
> 2dLWE/TTj0pYFBI/R9t31TQfTdzikrsp/ 
> 2jkiWWnmotknvWWNcmku1ZepJMd5KLPBfFeMpO2
> R2799BS1JtPKsXapzqI7NgWU/KwnybkXNm7o1Os4efvpxLhtoouiSoNd8uQU09/ 
> dOzVbZJ/s
> rlW4dVYrIm9TOg+7a5j5XVa40z4tRKB2X1f2JXkJqV7z7A 
> +yGbpWBzaKt6HyF8y1fyq3EmV7
> ZE23arVcMCmouV0rzq1tzpVXzYtMZ3Xs9JxDV5P8cGa1Ut5KzUMhRbeky/ 
> ZjT902eUM5vzC0
> M/VCLilBgbN/1rW1lonzUqtCtQ+X6VWcFLtxP1rjoPFtsZsLpywqWZLLRXtV+1eU/ 
> ZwXTufe
> J8bePRFe+7zM7sh2DyNV2eU66katSctQrjbbZnZJ8Qro6sY1xC8xPpPciVfLEz 
> +naWfHR70r
> zk1prDVVrFhq4pe86/BK3iyrTqsZsUGAheUTTT+BKdyyj5Jt7S/ 
> LI9O6rA9l7DFFNuXFP0hx
> vB4ZHmpjq23Qmn7sum7Lnc/ 
> pMsduElDbb9je9zVty9jd3vZS3OKLxO5Atb0zvLbfraclHVmB
> DolJ7558JWFJ25cw2mqHkvyAhvfbcGuStzt7O6r47J8m9 
> +C2Y5LJ0pgPL4LIsVc00BkTRY/m
> Cl/kpB/aar6JIwRvcXdNFHc6uTSpUVW+wE9hrvNUxc+nD95otpjv2tlXzLXvw/ 
> JXkREZhnaK
> V9XEFb0/tbgJdmmt4j9d7pN+PbBVe1I6f0D6lN059ENX 
> +o8l81tanyX5C93PaBSVabFr4OTx
> y864/iYmJVrMvlnsNogsjli6nCcGu5DeTPkr5ngDvukOT2+W5fXVITUG9yoX 
> +F7oP9P5Zr7V
> Us26k6fuL1 
> +mY6vb9hAjZ7zheuJR500Wn1oaci501qPtm1a345ceFqvuu6L90ptfMbZnclmt
> SorzLu5Vc7uWZCReczh/ztc3w/7lAvKa8L1l7nSnurpDocV3nFTO8Mh4 
> +PRLcq96X5aqfCu2
> ea39ylk7rk7RDJgs5FJ7fUNWZ+4x9zaniXYL4k6prufANWl10D417TZ5ZX 
> +V3Ik5YVdRvkHz
> tXNqCflg5erOfDL1ducUnGhuk+v+y3t2UnTFTm+NnYI2TVwrLt5e4oOvCa7enSduft/ 
> D/dFZ
> l0LuBXL1z7SSpit/QEWefu0t3xIaEkbSXmUxnZipJnD0aFFp8Wd6o/ZMpFCJAncjKgUn 
> +yiw
> BG8vek2bYNvXFyyIp8o2PVup5Fm+xbDgyApldMDNnbkyeRW3r2i 
> +D64oNGo1iNI5mdulKH41
> ub/ 
> x1lurEzd42m7qfTzolZtCS810PLSQr8Ty9hqE1vb36ddCJqW8vZqxhfTY2bz4PFarftWl
> lLASi4jVXy76xA88rW 
> +N7y7tcjXce0HS7GFEtcX5UDPNadIU9cQzm4oNBwqDbD8Z9pUKnkdt
> va+W++DLqu2xhZ/Xr6Xrhe1avClz 
> +cD5orP9Etlna5yCjffcDT9vdaYLU6u8F7O5ZuZmO30H
> 9aaiCCTvKxr94b75sf3NcfoOA0cMKkU+WZlk9K/sf8yHe9TcJWu56kysvNi1MN 
> +IzkfNe7w6
> uerURXQkistNbboe/7VZ/6WoaGDccvctDadiuDi51voF9bjy+h7oF46/ 
> kXUUMMPcOW1p3vLi
> 0peuhceysyKcuHZWCgsaCXslcATwfOE27PDdMMCRTKK6criX7D/TxvNELqKb7/ 
> Si8shFxUYD
> lKXEjLNCardkXsRIcVgtmE04u+nhLIOTIgYl4V7Kn9M/ 
> IxoQuOmO4jEelSKtyySOfhZ4IfnI
> L1hmT8TuyM0vVOrfOb5I+Xh+8qn1bglBvP0SKl6VPU9eKMvmorpXPJnak 
> +bb6yvu7eF679WT
> z4GcxnyHF6+fJLF008Ki+5rB/W8fmKVKn5Ht2cIhttmuehJW/zB 
> +zVvLvLTbMsc8ReVUc26I
> awb4zt1/kWZQaGFza4eNTFRAwjzNqzdOBoYIh+8v0C/ 
> DfSTVA1bEpdVWRLsLBgvVLwrcNQqw
> 8CvJK31Inr/XTNgGdXTKMT1T6Yg6k/6L5cISztIKNrk7phltv5ON8 
> +a3FJhWYuUga2a9eG8c
> ouuqa87dmIICo+3pOThvc+iZK/ 
> jMzWbv0c8HUJtNVLmn3kEusJZOUci8lRVRxTVBz8LngdSl
> iVHruU+ZTFi/VcF6agfaJkpKTjP5AsJ4Z 
> +8xuzuVOcnSCPEDATbUqQ4RUxvC13E7i3glX6o9
> SJHa1cbhlskVQ1jI0SbnUrVe6JgV58wkid38EqhDqgfOVZnwFCZlnOd/ 
> qe6QdrGyKjumImlP
> n8Da2YoWBMDgvVCfVOT8qQJ6izlWHiYVldQt4nCQn1BktShnnwBddXJkupy57tNqTJZAd2 
> LH
> lmS/ 
> hElFLvTLi2w4zWSOCEwR857pbpbQHHXJJoVrzVyzrV4yvV2L1vGizGdNl9b1Qk8oAG6d
> MyEErauZKL1cTHSuboJqlpXC7XXZG+t3zVYyCwp5ZGe+aJbw 
> +TzddWLqZntspZ8tWselbrHS
> d7r0NSOzLOOE+fFYvyPr1GdPOXRToBEvbXVu6sqcBDt+d/ucVKcNYtwJOGolcZqi/ 
> wIsh2sW
> Jeo9STA6ODtq3VJdBezdk6YhU3X5tqGy6rKtuWx2TsBZyKPypkXZyRrtnLrZYr7p3mR 
> +a9n1
> kkl1k+Vxi3eYZ/ 
> Flo7jqdlrjbOQn5FlEoWSn7bTbbHR6ehNigbXYO9VXXkVTNScKOnFbpdGM
> qp5whJYWP+xCeDfmt3+eY4rJydB9yX9FYKpvS2wkxuGw195tQQ57Q7o8Ts2/ 
> cci9qk30gQA+
> 8PnAZwRhDbfYacW06e8+fZgxbeWeB14H31RPuILO8nHDxtM/3XIJUSxScvB/ 
> SUG8o5zgmSs4
> byunW0y05k3BU0kyiTIiMRzHL9QkyanHCAvVpXz84CckSE5K6n2DUnUz6rlrlqqA0TTS9J 
> da
> 6iMkTK3fQ7/hU9OCEFfCmJGKUjUpvtOz5h6aI1To3nnA9eIsVLbwnN4S0lrxCmHBe/ 
> fbX7sG
> vD+3nVSWXbcq+lHZHKTqMkkt2w3lHPN3CO7K3a/mK3A7FRhYxx8xx675cF20VuQJ/ 
> +kreVyD
> X7SeiguqeFD1nAvjdFreLcrY45QTcv9hpFnDSoneStrJk8De 
> +aRTD0T17BGUysOOpWQ0oZ9H
> OdSy4T7ioWb0wjNhH/o5i8 
> +GXw6VCVFqOvLoQSQYq1MZlZAaKecUwCefIzzjXUbqha2v8SIT
> 7/EaBU+dGMNPqp6kc3P5u3fyojtnCp3Rxy/ 
> infhSLE3cQH7eDcE7N7Lvh75b01nosXfypAZa
> x6PbonNna00xbmnZb9yYr/C+cx1dKqf3kBOmJuE63kCfruzhfFz2naGaROa56x/ 
> PkbvNkx43
> upwIU1m/ 
> TWL9tYTPHU0LzpjsaM2NdjhssKm3k2vgerhZ5wmsd4veLO0gmxjX0oUfFvm01Ukt
> Jz5cdWLZi1R7v0b+MzfT+PwCfRJ1Ds2itXXmH/nIs+/plYt1l0+1WTxv4XvbbNiaP+GD 
> +8kM
> ieZCo4vEW4C0aMGsCU+f5r0wFLQVa8gvcAJMgrpno/pEZ7/ 
> mlZs0YXmKsETKXOO6R2bGj54s
> M37y1GJi+0GtXZIaoTFp1/ZJ4I/nXQShQKLmirlNRxyNi/1mkJqMUP6LdzbP3nega/ 
> YJ0pkY
> 4u0iCddS4qY+0tzX+naairjLLwXrS1KUOjcIcvfUn1t453FczOKS961pDSRHzyXK9zS/ 
> fDbm
> OxDsbTU19dNVj2a+oDQq70eRJKXtlF1FmebOj5SC8+7Y77DsWVEXU3p0y6lSKbXz 
> +QVq6/kM
> F/eqCyfb1JW3HDh6tiC/qlS65i06R0TkbS9Pjt117pfhauaN5c/3+B3rq1ibtO 
> +I0NFESqiT
> QZGl7aZj5q 
> +v7l8gqGx1gK8rxeQKdvlz47nr4o42kEXKtAhR6Od7DhlJrJgQ90JUOZsevSBE
> ZpmN2QnFw1rpDo9FSa+XtywjdfUse4LAdS8t2vth0/wO17tG7+/ 
> Et50gbjAWOjZg5yFlaa5I
> ovk9IL+Vzq6tEJNWSIo8oL9yRjBBQugTOjTpot/WKcSy3cfazBq 
> +7Aosi6hHhbw8uGlNYeLl
> 8u7zJYV9gtMiXx9UxB/tP/8X9rD+nAc99itEA8yfHz+W31iCinW 
> +2hFUnrS7wDAffwR91TfN
> XivGVelBsQzqVNG5juScK7tLbkgTEq+03QmtV/QoCDjOc7SlKNC8h//L 
> +amFO2yftU5yL5+c
> +vw59tphazHFlmLH/MAlovHIN73Owvk5BXVOfH9lLObOai9QTkPVHqjPn 
> +7Wfz9bZrddwPOL
> pgd4Fkzz4/Z2V8xcfOav2uKWeJMK/IVXrre9/7JyORBqvCqAssVZYU59KPl8M8m 
> +eFOO7aNz
> zy3OSBShzlD2Utc8tXzT+ki0B/ 
> 8XUsgSqbd7Uf7pHKTodS2xjzwbbweoxbktnFyVtp1GUXXw
> 31vsMZH2orvqTG1ZMX6en1g9JrnLv1vf/8XBzdmtmfP0nT/ 
> tyU53iLPrMeV0sdYwEtxVbZX4
> 2GOy7 
> +ZTCrlFfHn6IiZtj3QvbUknvE9eZdPjnRiBvvM6fQN37tZinyc7Wj2O1hhs0UZXuE5b
> jr7sqL6IN55CVdxeIOYit95hi6cYzbg/ 
> 3/1KqYKo52S79iuPI7f0GkvUxZR4xWTtzSQblqG0
> AnllOHe2ZC3eXZUXqtgttm+e9sZMC8nH+WY3fZ0jz4nuKbmZIOZ88GaK9q1PhicQe 
> +x2Vt/c
> eb4mdIKqXpiX0Jbzm6l82IY9G1CT7rndt92bFrO1OnNpzYdi1HaRaP0ZxvF9L0Tw 
> +47n41qW
> Xtz1xYjc 
> +37OWlstS8tX6htvc25q379DrzdWKLmiOutTzP6PLiWtG4mUOFTOmqlnIgJKlFAv
> eAYm8Sz/ErvPU3FnXVlauAPipdbHyVJfbvJsTIjzLJ4dFbpTxfDtaRHyQNit4/ 
> FI0uHt2L4M
> rsptST68WyofbWlqbWt8zFu67LNxxcNXXZu29F72FFHmqb9/8ck7p1bXxU14vqqijf1xnD 
> eT
> sAtdQmfM2DZzlWxq+dW2vQd71gJbUX0SW9/ 
> Vhm7xdCoXLVAS39Kg0D53Y3x7VW7JwVUGH52X
> haumTqRnRYc/kdvUcD2X+PK+R59KQ+Hso9NvzAv10ovjOFn0TmVga9jcW5weua/ 
> eDWhNf+Av
> jSr23EI9ejs9uoWD8D41TK7/ggQv7vF9+WeiG3w3pub39ar0rJu44OVHUursmNv 
> +WQ9Prg1b
> d+D2bnG9JyRt308zPffXzBQZkLY7u815gy9lb83ey2dXdi/2TNj4IQqRVtqxar/ 
> L3NVLXa8v
> v+Dzpe+smea8L0LrH8jrIt+3q963nC7NH4GYkhhx9 
> +pSoudEe43nMZmF9pEShJlSLz8jagt7
> tgHvOwWOEspDd/Lfjd9l/d44s50zG3W0La/NSaOu91N0dPjbpp05BhFFwWaOlyo/ 
> fohqNSxR
> DZ23VcF73dkMcb85ajU116eriesp9qfnRaQ6mn/ouMNrUCj0maMU6Dl 
> +RXdjBGeCxJdLl94Y
> aBWjNDgHNvMsXSt+tbf/Zbhi0/NPyknvUgvLidOSN8bzvivPNLzgudM0fuO1wlemV 
> +28SQ+W
> cOOyXp0Nl1QduIAYEFExGric18u5lreiqMDj+rxWqeJbDuIN8+5w2B 
> +Y1EoR8bal6GufVvxI
> w8hYUXdSubOfHMx4qS5c2K2Q8Dg+zHDXB/UvogeC1kv3EPZERcw 
> +p2t8tFtfpfOYKiGF3Lnl
> kP0pramT6jGh8zg/SRXx6UScv3HP7vVtuUTSLhHvuaT7+/Wu7M9/ 
> vlGJsyDo1t1MHpWXOXjC
> THR7XmIJmddzZ4RkXJjondI3HvxfqmpDm4SzJR 
> +LnhUpWft0Z7DgkdcRnAflVvJN5Ije8l46
> pd9lZvNAfe1E0oIHL7MCN02SNOGbvHh9neFmuQvTLmGPGWbN6jud+Rex6 
> +qHGs8PxZsqGc8Z
> 3hrIUmw/G5aR/UpFY0dQdpal6/ 
> XD7TONBzLfypYQOgSzHI5PLY985Ub0fPbZ1KHu8Qra3PfE
> GKyPRVC5b1mykImwZ/+lvK6Zd6cuDImPqKasvBbKx5MsbibZbiQq21/ke1U/ 
> CP0hakrOY5Gu
> fRKLByUbzBmKkTJBfBl854UP/JcH/wffjZGWZG4mifyTO1fGw68Fxvk/ 
> xlaWdqaW8IEo/0D4
> /vk/YBxKY/D8H6SWFnT+l4amhub4+T9/ 
> IpiS6dTVOsCQ01qEBRYRCWgajjYsnnEnLMB8jQx8
> zEpggqNhqIQAOoFC1gEc8Wg6QMfjWC 
> +nYSk4GiBPw1OodIBIIOMUgPBw1kM6gU7EgRHCAvY2
> FjqAsrIK449I8KaiqasZx8OowAdUfXumjLCAsAB7EYaLzi5suH8wFgl/ 
> ooYJHB7uE0jGQN8B
> OgWUFhRC+SckGkkS1DBJUH9CEhRTkp+ofwYHE1NbYxtzaztzK8t/oI39qP9ropCs/q 
> +pBT5H
> aiLBy3j//wPBmtGZWN3FbnUAeGM92K/ 
> toM45lh4tLMB8x1UHQCqrgq0aTQfTocDKVUKqKiG1
> wO4QSAfJIV4UIJhKoeMAAl1YADoviw7 
> +45hPwFaPoZACiGAU9F1vNSWQ6oMOJNKNaBQSLhiP
> o+KUyTi6wbB 
> +s4JCxQFob0ogHQiGZCXQmSKS0Ku9cQAJekzHo8kAhYwbFNiCgMGRaYOlIzLu
> AAINShxIxuKohsICTEVgQSIcFrDC0AGkNoDU0lFdqKOqDhdPFxjSMoQFFgcSiHQdwAZAKa 
> sr
> q+oCBDVtTaUAjBJI5BushtL9qpRBTupaukAwgYylBNN+qu/+jsAcQXDEgH/ 
> uENCfOv8RqQrZ
> f3XV8fM//0hgq/9FZPg189+fx4/ 
> Gf1UtrWH1r6kJNpfx8f8PhCGQin8YDIRvR4pE8TMxzb8t
> /nj4m4Gt/w8eHPHbww/6P0oNNXz811TTVB3v/38iwJUODA/Mzq5jN 
> +JTG8CEggkk4UDgBqEv
> aOYTHu7J5+PJF+jJR/ 
> bkw3jy0T35CJ58FPAWgG8o4AULXQbnM8ICnnwmnnw4Tz4anIAKJwhg
> T6kDUcEZgrPFRSAsJGMIIECTRyppwBCOpgBgv2JAgOLDgH4QTGVNoiAQ 
> +DVDezg3tCefL5jz
> V/awDuRDFBhEi2BhfOHCkGAJybBUtK8JACAEmqoxECgIL 
> +VC5AAImYJyspeMDucFloY4JDVI
> Ze4DkHEYHI0GTuIUGegUiwNhMJHGQKlQGdjLBiLbIByrGA4wXyIsIVsxvsoDJQ9CEwNxAB 
> VH
> D6SSQegK5gjCWhDcogELc1s7RSAQVCUjKYS3kYAOYDJUmXJwvNxXGtQoNCg5lghg7TJEdI 
> RF
> pMK6I8CfvjrsVEwyS7im6UOLAU6BqWAJqAAZnCTQmDplPFqB9scBFPghDQfXMA1sCmCcI5 
> pK
> BvE1CKPpeMCN 
> +Sx0MDYsFMoyDAhn1XAgnCsezp4qD1aPArsAweBEBJx4AGioShlpbOAa9YE/
> qYOtAsNowGxJA8AJCBXnA7YFMli90AwGqgsigY4Dx41AKk4lGOcN0MBbuL0MCmQL88EBsG 
> hE
> uJFS2OWhePuBJYLZ2eJwwCIijQKgaYAcNGzLKYIETD6mnnwhsOJJcFciDhdPSkoJDIAtnh 
> JI
> xAJgQzExtzE1trNwBnAhOEwgHTrMFZCQACAqtiSAvr4BAFa9D9jpACyajma0HioanLKQFN 
> kJ
> wUChQssWACSaPESrT4BApQIAn1YEKQM6QhaLpmJhTmA10mnKbAICduzdF2yvmEAqqEw6cT 
> XY
> ISABsGDJmdSDZGDXBUIWIJEQm397PP1vC8Pt/yDO+515/Mj+I1Hqw+y/lpaG2rj9/ 
> xNh6ALv
> 2DDACPYfHvHx8NhDBwbHVmhAC4DjwIHSn2V4mVCAMTgB8vBwxxyJGamJgzYDWqUBx// 
> RuDCg
> Ap0x0P08qvj5NaMhQITJ5TtwhH3BbKh03yIDFrJgLcgNrsgx4xkLc2wUrCeshTfGyhszlr 
> EA
> BwX2RTjmQ9bS1/ 
> fWvtjAF1icIBw1iIALhsqFpwRDpgiyAWxFVAQIZAwxEAsZXCiaRKHRmSwI
> pAAKFRz26RAz8G9w4Kax1PIDkzx0zXCw/ 
> n5x6RCSALQyTC5oeFkSAG2SCnghsXiOVoFjBALh
> oI4HjT5kExmghQ0aQObQG+TtS6WACgd1Bx3EDvcnVlY/ggWAFdzU0ESo/ 
> fnD8ICRDQlstAGg
> 0DRFAKfsq8zUupxegL+vgRwwVrQAJqGBNQdCAlwIGrrSBnUCVS1bpQ6vzn97TBsPYw/ 
> D7D/q
> n8jjl+b/yHH7/ycCXOnA8PD/b/6PGp//j8//x+f//8XzfxRqHHv8fGDbQfKP5fEr/l 
> +k1rj/
> 908Etvofcsz47ww/wn+ob/y/Whqocfz3R4KehImVsZ2ztSkAVTtgbb/ 
> YwtwYkFRSUXFUM1ZR
> MbEzAczsVlgA6sqqSAD+wTACY86pomJqKWkgLKAHpTPQw+PQWAM9eC 
> +fgc1YNgzpqTCIQQ4k
> EPqA2dMDlHCrAglB 
> +pLMX25TgtY8JCHgB93pS9JxIXS4qeoCGDyaCpoOfQKNoqStrbFQCQnL
> As2DQftL1Jek0VeDE1Y8DkeXBOggG2ZqDI0mCeBBC60vydhJZwP9ZB2cVoVRBG8KdjVcLK 
> TB
> GPYx6hFIvgCGiKbRwAwoAdBP4kkCNCpmkD34h6VgGP1r8PfyJAE0ESyNqw0AxbhLGoBZIw 
> 0g
> 46WHpzKuWEIQSETwJetLYsCi46iwhOghkrOzZgpIg/ 
> suyBCSajQpcD50WAphAYYYzOUkAPpl
> OndJEEFh6Xh9STVVUE84gi+ezvjuTaFicVR9SVVIXPT3pSGwhpHvixIYMEQQO0rAz 
> +SvAiqJ
> qTWUwZAJyZAfRvCCl9HkgCDmTzAglVVBfaNYKeFfUrCGlMeKBh8woBBTFnD4koErgE4Fmz 
> h2
> MBqlAcay1PDt3lRJgyFxkNhgo8fCjLBjaVwjbJIFYA7gB/ 
> WX5fkX5ECx5Y8alv8oO16HZqAC
> 1wf8De6fenADMhiHe387fHd39W/K4wf2X01TFTnU/qNUtdTG/T9/JPxr9h/ 
> 27AwfVv7DQcGI
> hgGgBZJIaOpqfUloyZ0xzR3iVAuF+1gYOCYyxkmDER8zxjtwFGXafSpk 
> +yQNhq21fR0V2cZE
> 0Gz9sr6/ 
> mjy8mgHb6g74RI1R4gDw8ivbq8e6aDfcyaKnEjBEJHhZbKg4zFpgKd4GC8Axg0Ya
> Wh9gUyUEeSQNWI41WIcjEABM88gwTV9N24jcmP64UXlZDxr9sXFj+fBGZQjjlrExY7j 
> +RuX0
> 1R84VoYsd+GoPEd1Iw7LgtVoGe3jV/ 
> 2KQzyKMKuhPqihbYjx5oE8TWFoKxrqVGQkYbT27zsW
> ZYl03VF8i7K+dF1YHGgV62c8i0MFtmGtIA6V+G97FYdmM7iW+E0mY/ 
> crwuR6GAoWZzBsQgBp
> KcDfF9IIA16wRQyDpWxPGOAQ5jeCwKZMPySbwFQcQ 
> +Rf8VSCzKk4JnvG5GukiRdrgqSHIxnY
> MYYI8Bv7hAJglZ19DUXSAP7uzigTa7byn4VgR3yX7Tfn8UP8p4kcvv6jpjG+// 
> ePhH8I/40y
> q/tfwnej4Lrfg+dG1d/ 
> Y8NrvcJgOHXrtaTCaGTruft04zT6UwiaX6gsXkm2oHo7ZADTV15tI
> wfgzURvksYQ1RacESML6ZNiVEKY9YFszgArIcnYOpRr0w468fPAdTPm3vLJDdeUAuV6Hcf 
> +O
> b1ZYYCTnLAuR/KreGG7dkZQ3sqN32IrO99iixswWJTdyRegx9AW26kHVQYpj 
> +muHqo7hLR6q
> YUsQtQ2vvm+9xmyQboye4+84jscEKb9xHY8R1/2823hsSG4Ux/ 
> GIgC2QDjZ0BhKAnLdMCAN9
> ZQNlTGfz2GDZz7mbmZ5mCAV+z9n8d/3MY3Yxf7u7/H8RL454gsBvzuOX8N+4/+ 
> +PhHH894v4
> DzUy/kP9f8N/qHH8N47/xvHfOP7738Z/0O7C/138Z25pYur0mzl/DT86/0MNqTb8/DfU 
> +P7/
> PxNGfv8fGP0gstFeGPypfSSsffTfhK+nwY38ZsJ3JPu3VflfGRj9n4gGgfI/tgH45/b/ 
> IqH+
> r6GFHN//+ycCe/0P3QBE/21HQf3w/W81jW/2/6iPj/9/ 
> JLiZgRNgHHVR6JDKDwv9xQ0lYQw+
> yjZYNA2vPMhNWMANDR2GycwlbHhmjFiQyp9xRGbo0CdKbHy8cb4EcijbVCPMDZz6o0P 
> +7B4V
> NxwZO0QINsngCSNLKjc7tHcgEU0NJRLDQlnnCeoAsgwnkpvb4JGLsoNbRqAo1nYQWQguQj 
> GM
> PR2ybJs3oFjWxgzZ0XdgQHRh/+x2C6Y6GCVnqYIxR2JpYvg73L9+8uMv7K 
> +AJWQKxBLw63SM
> JeTf3mEBZ8TGmJUZOP+Cpl/sOf3kNgs3aAYW6mYBEi8Khd/lDmNewr5mPZgNK9/ 
> Bydk3McYg
> t7Bf3jsBZzaUE3sUlN04IvsvCN/Y/99o9wfDj+y/JnL4+19aaurj53//kTDU/ 
> oeFjjK7GsFG
> w4dYjxKPYosf3WL/jlXq0S0xvGL99RY0fN7gME0KY9+2AKdmewLfD0vIWsr 
> +GkXEDs0QtBgk
> V8bwHBLmzv5m+GDk19fD4SyGM4Ct07f5DAcTf2uNemQjDa9Vh/ 
> 3aAvWPtcFYgwZVMtq75cOJ
> UaMRQy+Zj6Q6eH2Y+WiwLCyLCzeWsMHV3LDBtWSmocQMbS/ 
> QmjKbpkd6Cf03vH8O5w1nNRpO
> +mYNeczY5edXkX8CrYyylDwElECLsWGMzzDmSvGvgZJfWjn+7jvq/+K2gf9oqDTc/qP 
> +dfuP
> HN//+QfDEPuP+oH9R41i/7+JR7HF/2faf9S4/R+3/+P2f9z+//Nu4/8G+0/wpv1HnP 
> +C1FJH
> jZ//8gcDW/3DX5WxxN+9/RPGf6PXP1Lz2/rXQiLH/T9/ 
> JKxwSUBwglcu8H9gAIEoY8YbjSFt
> JPg/cV7FRMQJ/isSZRwWVyTs8OC4GECl 
> +FLRJACDJoPGExq9qYHggEkGTKxsQcSCxSkLCwtI
> M3lYmyIQFhx8iFZjTdNBvg8QE6UEOSZowz8tORP8h35qchLzH4AoTvjD3ycw5OZgyg 
> +HBMbN
> g0cIuFxwAogW 
> +pjEIIEv1gjEYujqBWYB8Q9AIIgTRi5kwxh08bMBmmbRwespXqZAfOyFYARQ
> NC9lyAyB3+G+ACAYuhAaSmeEQFQqUxmEsKyqTLqJ39AZKXvT4MbbwIwYKURC/ 
> HAMfrCOrBFf
> 62A4PwKDDtahF7MMU0aSj0bFIJg6DmDSiY5EhyNSMEz5Ipn5zv6GbvHIko 
> +Hnw32sW2ODrbR
> 3UJxYULRAxwi6/PByNi10lxx7pPiVvDFuknzxQpJd8iA1RBbC5JBNDuqkJUb 
> +kR2VG6oorvG
> TUcYnfDfcJ1uGjd3EvitSziBPUR3cS28QZ0Vx7mhkv5moIFBDUfSuuLpsojYadIdZjwIBP 
> J6
> LPzoAhc8MnRIg3EbBgInDbIPXILsg+lfxuN6XT083auEENA9SB85SL8fJq2kEy/ 
> ARdsPidMR
> CkrewQN+dMoODAwkMISMD0LEn5KDiMYgH3KgI5cbLL4 
> +u3zrwZhOCsixYxf47QLcJZGVnZ5g
> THwJRMHkb18B5RfbFt09sxxKH2fKF2sH6tRCmiuWS7pDCUx8Kfodx6zKakYy 
> +3IWfcUgvYU0
> lAam/wx2m0vVbPoF68+9Mxgs3td7MGmsey+UMPBdbNgnKFkMJP 
> +FOFMh6GY1JDCXNDQ4xNaW
> QYNnrIk0VwcVouGSjq3uCIG+iUl3WIPXezx3eW9xI1RP+N 
> +bCSaCqDvw0PNbcYHv4sBswAy6
> 3b9KZM9g2AbVD0seviwEAGpVG0GfMTApTvj/ 
> 2HsSqCiObRtEBRRFBMUNR0VFcLD3nlFBWUYW
> 9wFcIgq9CmF1ZkDD0ajIRCaIItGIiNERF5LggktQo0QCiguiT40SXBIJJigalRjc5VX3QE 
> Ty
> /8vJ+Ynv/Xe4c6qr7q17b1Xfe6u6uxqqRSRtqkW6l0WuWATOvX2qJH3/ 
> kKZ4BNFoYczrCQSe
> NOqG6Y8ZSnTdDQ1N9my03yhWjU9oAL0JtwMOzn7V2Dhz1uwS5Ngyj3xQBdVZj03rqxeL 
> +qsJ
> j+qK3vSHSX9aP9lYqZ6QWjokddpGpImNOkuNdhH9// 
> v2XEF7M1q3Z29q7wJor6V3wPkfOg+L
> /qyzN3UDnHea2bJiS7Nk8Sq29KlYq7nz2oAhxgzJ/7PT/C0abxoaQg57S/ 
> YM6lp4bNldToyd
> 9JA85GpTQDQ67AnfH3W4P 
> +CRzgGMUP2xhI51HmanAhd0WbLQNc8r4ZHVGYC9V79sVHBCR+C3
> 2S9OlYCTwUHLhx8DmYOc2EMxKMUwqDOXoiML0L58KKqVakNNIVt7FtS2tieYP5bePSKem4 
> fY
> d32jzrJpjJaUqbK8ABhtgY70RVllqhwRLVNtFjOD6qDRHlSUqbaaqHkm6hGjo0TNN1H3mK 
> jH
> jH0l6n4TWmqUif1SnTQ6S3m50UXKzxuHS/ 
> mlroXtYVASDKpKw2hgp3xgJ8mGFvpjXfXzzKSz
> DBbD+TYoiw7vmrLKTBoCyKkisUIaozpny9onIrOPhW1zoJT5WGZ03x9lHCvOB 
> +1E1jQHX7Hs
> I34HGzL42BttQVwbghzTHOzFgk9f4xSpfjiYHhoNQTKDD2x0FEeBQ1 
> +pHjeGi14PUqQ5cGLB
> Z7QxXhLwNQmMNfj4pzk4A16jTNI8RXK5wWeCoXLASWn+cJaZnbLwSk1x9QcSge/ 
> 9JNncoI8A
> mGRlgz5aLDpKxXix2Fcq6sSiZEv9ArEomVO/UCyaLLqkyaIpry2amq4XW5HiL0 
> +y6wPRrg0J
> 3sgFMAacxMlDvMv4zfCgFti 
> +dsRLIFRi6CeGSbqPRe4SKbfM3SzmTSFjeFBrCdiUlYb6hIK6
> gtoo6Le5TYTGwUeAvoyM5utX4+DyVvj5VnhpK/xSK/xYK/ 
> xkK7yyFb6nFZ7fCs97A5fm5+nP
> wJWnuf81rfhrW+F3W+EPJFyMg3BxthFpjeKd+l8DB5t0toRm/ 
> a3zNvgvhM2dx7VE5RMCvP18
> fKZjqFzlL8fkQYETAuV+wf5q 
> +cSASX6ADHjmY2iYNoLW8Fy8TiP31EYm8TIPD5mYxwkugCdM
> 5R8W5O+lVvkOE3Wa/ 
> r9kLsvKMXfcnRBLI9i4WCFy7gjx47gjgD65SZ8cKHQXHxMgP17npYuL
> mUTH8F4yF/DMHTNcph3e3IZ22DDZAI+3s0Dw3w/ 
> Nz97oFNOzdHNyAfhwkGCQzneDoNHicyD0
> eplIfI+C/Rv73Qb/dwgOf10uBc/ 
> xeQCPaEF7BGhHAJ7RgmbLQFBNC7w1PAF1FkDOln5Nk4Ey
> DNJokPxp8bvjEBQKEgdSfAu 
> +haCcAlKW2Bf679NpBnlxnDjDeEHQbmhcZGwTcu2NmQeCnKGw
> MBDrcbH8gkhxvSYOCqO1Wl4jlrOgMF6jiY0T9TmY00wcoMLmghCdoI0QaWPMBQ3PQ5DGPI 
> aO
> llY1ICjJPIaP0fKiOFRkplZ5TYCgse3UQpjEMY1nm1Yfe1oAWrz457Is4NVB74p4QuxvFG 
> mt
> pSmNV6knqSZgaPParX34v04x2kRWozNxu4S/mdR/xwJwG/ 
> xHQ9Vva69m0hKfo2nl7Q26eD2A
> /we6lQUYe6A0Ix7EVov1U3tzHBynQUFQGDiqIDUoBUCToUkADwDHcaAswlGL 
> +69EPS7SQt/K
> 7OZV23ZNeprXd1uCRiIEgVGhgSKhWGgu0BYJRUM80BwLCZA4ICdJPDCEg6SUchUk9igU6g 
> 30
> NfP7gqSFWElPPNAXCWRjpTZ8oQngJ5O0aUCuBikeogFvFDjOBXIyMPR0krwOQiDxYdgF9P 
> a1
> 7mkgaUDta50I5C4tzc6BugM 
> +H0CPATpN3BzQlwD4OEnK1F5rDSiQxyUdMtAWCnIYIiE50AuD
> IwxhkHS7BWR7Af1TgGwc9C7QwYIeyiRLmWwTAXAdaHkkNAL85ks/ 
> d8AtB7SWMu7Suc9tsgck
> +ZMGlN9bW5wnRU8Fg1oaULWgnn7DnlYWNa1Wt9vgPwLAgC8FmQ88EZ4Hr4C3wGfha3A93A 
> 0Z
> jjBINJKJ5CBD0LmoDl2MZqH70KNoBfot 
> +hQ1x2ywQZgc88QCMAZLwpZgmVgx9gyzwB3xgfgk
> XMAX42vxz/HD+Nf4afwCfg2/jbsRFDGa8CemE+FEBJFELCFSidXEeiKfKCCqiFvEA 
> +I50YHs
> RvYlnUl30otkyARyEakn95JfkxfIarKeNKfsqIEUSnlTakpDJVOZ1BYqnxLfi0ivRNqeB/ 
> 40
> mN7/xtCxf9/r/z/3/p+S3v+jON72/v9twGv/Bzf945773KS/uI0// 
> P9PnGzlfwpEQNv7/7cB
> /dMsTYVO90Lux1WPs30Z2uigHalydo03+3Sn/ 
> fVt6V22jlvXP8SOGLnW9Z27ZqHRI6pmd8zg
> XzUUzbxqcaHm0u6d9YOXrv92/XtxglPHS7d1tdN+GsJll1ptymDrkjbqrX969/ 
> T1Df4Dk6du
> V7s3hPKwOiD/bmH+kx63H8Qe/b761H1mXXy3a+fWDKLYzzzsI7/ 
> QRcytUgRWr1iVfFaoe7Qq
> Yp+V8+Cr50s79azLt3Q/QKvZjaPeCTxR+Y1BfcAJ21adiK1dXfFk2L1e 
> +pGd2DO6yroX399r
> SE20++iTu8SV4ETXSdFmtu/ 
> mDD1tH6DuURwXct7KcGhgvH322PgrX4z0zv9qX4HLlFFJ11mk
> y5oo7+dlZWMSk8o23phcfTDVpyL6h19yBq81MG7hvwxnftmX8rGT48jF3C 
> +Ov6hl5Y8yc7Zf
> q3fPJo/PzKqZmjPxqPKbHqXbOsG70aEzVkdmzjXCdNRd1/ 
> mO6eUTL16IWN4h1Db0M0W7ob02
> dLfr+qF+5Gxn+NRPq6LyL/veMjw/fmfNOoy8drZyY6B+1JpdezNPb 
> +n6ZF3svqPlX920suMG
> sBb+8d1GkadvOSJOUaV9kqyNVivYI5t623y8pNcHwU9vP9OdjL 
> +3fGcmN3tMYbhMPWSLcve6
> Kt8v7vWca7ZueMCGIeN2vFLXnnlQ9/LXs9/3MESd3nqzT35Y1o7OfYvU9n26bCSjDL2 
> +mZkm
> d1+yt9y14HDlPb8Pz+6EZxxYyyztmeo36trGxLqk3Cl 
> +oSucG1atSnv66FFpY0zsw3NfL5af
> yfaYM2zC9h8rTtSv7z2r5PG+kAVFFvlDi4vdsh8mTxs9fdmyLhvNXGfbLG9XnvPO2i9v 
> +RGj
> n7+IsrlyW9U31lCT+uIGfmHpnOyiFKN/ 
> UKHbmvPaGNmzwh1F0aURG2b4bp2VWyGvHG7etTo+
> wX6BbG3RyZq8W+1c7R0gj1edggpHjJ0i3JFPq+pDL73IhFhvXXrfctjnn 
> +4KbPw6tyrEadXt
> hd692OM70brEbfMSxm5LSOZ6Dnj0sOCQ0W9tzd1fot0CD1I/ 
> JMVP7OUXn9uhpv3A3NrqFw27
> 5AP3xsyMPeLHI5U7Cm7d26kZsasxMPS7Mlp3zn0D2Sn1aUU/9sQFeu/ 
> Rhq7jndilA7y8uz0t
> vlJvkTH+pC23PPjsDZdlM0LGsy/ia77Uu1lGaD/ 
> 98VqO55XPPyndc93tI4OnO0vlTr3n1jtq
> 5ub77l3cKpXhayJ+XPlx3PrP+emJj6ek9Rqatjd6UCX1WLfm/nfzX9BndZ/ 
> 4phR0roj7YNN9
> 96Jqf2W5sfHglfn3a06M9MzyXDRycO8HFm4TV2tOn0vtbD9hR0z/ 
> +n6k3WMv9aMp3p7Hnxyd
> 0W/1dyF0gtuC6vYdKxLbjf61 
> +ohHh2ivrD4rSrxcBoXB5rs2Wx2bev7O8zmT3ZdVbDkZtb32
> UPSPnTKtT7jaxBADq+wcVGMWNH6WnDj/kRYLG+dxM 
> +5ccsiozcuX17llJC4iFi6IeDe2/YsN
> dpcbd6T8+tg5v3Fxxp5XG1KOBlSCgwv98tVi1devOvheyzl92ObfO8O1wb8C0/V/ou/ 
> fea/1
> h99/I1p8/w0T9//BxW2A2q7/bwFwBU+xKI0yKILxDMogFLgHU1A4w 
> +ECh1GIzNVn8qRg1aTg
> IBtrgaVolKMRBeBmUYpnUSVMkLCgUKLAwxwlc/ 
> VVBfmoA6YEB0yeZGNNAiVKXkBpgsRRilXi
> GIvxCI6zFEMzSlgpc5W2nbKxVjAcD 
> +74KZjGSJxQYCTNkwjMoyzGsBzP0TLXibyOHgFuTTWc
> 1sYawVAK5TnQbYKhCUypIJQcTGFKGFHAChYVmtgjtDytYSOaZHiSxmCOoEBDSprgYZqFFS 
> Du
> MIbmeYwkmmSa9z6RZEieI2FCQJVKRsB5GiMIHKMIFIZZBEFZRCFzVct/ 
> t2uK2sZaSSo4BJhE
> lFaQAsGjKEaxDE6QKEMoWbalnMhPM4iSxAQWRkkOoZSABTiDURAUiaIwx7RsB5X0U5TAgQ 
> qB
> ommWAHIwSxK0QGM8CfxAAruqTcqBx3ClwKMKJaMUBJpVYiTH8AQisDRK0mDggdNmpQ3fTP 
> f+
> bEQM0E5TGAX8jPIKUiEQDOgPh/ 
> A4xjEERWMILnOVPhbuFSttVmZjzfI4yRACw1JKJYzxLEyy
> ChrhaIrjlYKC45v4mzrEKliGBgFDAJUsypEcxQGdLI7QFC4auSW3/ 
> LfNonicUTIchbMsDUwL
> AhUmlEoMVRA4wgkKXNlCCgW+BuZhMRBBMIGiCgwlwMlgwEYgo5QcywHu1p 
> +7tLGGcWBPEsQc
> hwoCwytR0B4FRgLwGYcqcLxJ6PffyAKiKAMDw8IKYFgWAfFIMzRL8RirUPACIg6hVp9XAC 
> dE
> iG6mEAWr4DEYhUHIoAwJ00qKQWmSYVuIoE0iJMOxjABTHElxoscZhYCRFI2wFKVEENEv/8 
> sm
> PkCUVMCgXwKhoGgwIhFagZMwzwkEhgsUquDeEDWJIAwrMEqepwieJQhEQfEIy7Bg5MIKkm 
> YE
> uqUIahKBORzEFctxINBImEEEEkOVPAXmFpgXcKmDb/ 
> yVOYhOhGGACNBJCRjNMkqSIxhSCbwK
> Yg2jgVtbPZe27Sjxl0PT9V+c/P62Nv7c+o+0/x9GYm3rP28DWvi/xQXzr23jj/Z/ 
> BN5u5X+K
> QNq+//dW4PX6z8ZMr8nLYPuyTqxZ+jg79khDXscAsvv9cR5Z71UW++62TMBZea9zw 
> +c8qd2w
> e1Za516sk9OixqLHz569/+hlli3T/WpxXNfZmpXbU1bVta/q9k7j2ltwpdvJld 
> +gVpfPKwqr
> lO1DFn+k/weeA2tdgke50Hd+vpFp6+K84o517/EfX/ 
> x89Grt5mE972b3UPWy6DKsxGb2opn2
> m8IGmru3b2/ 
> YhlsmV9xst7sKKin4pjblSeBjxjNox66Hub7aqGFO21PjT2hezgouv3JIHvry
> 7NQ6m/lHEmY/1i9e4eO/f/+m/gd 
> +yvO85Wg9axh3YpD8yNBup7LSrJ6NfzluUpeSiyfvzM+4
> PmLbD31w76X7pzkcq+iQU1U43WHzmd7Bjz1v0UVCUXpe8oXy9wXvA5 
> +m3R7oFHw8Pm4rXT/G
> 8tWZLf0mfDXIMa60qKfGaf5An969V+9Kd9qaOqPDvfT3ofW7U3oe+n/xvqvF+G9x8/ 
> vXtvEH
> 4x+BW+z/SlK4OP5xcLloG/9vAV6P/5ig63EXYdvJYy6v6VG61fOh8NDcf3/g4c/ 
> 6uZl3uGW0
> yw2aNfVGxroF6SrGr0Gf17iwOHYEnd7j1MNFVY 
> +fX386t2xezuGguOzFJanpnzw9sEIT27Br
> 5uTyke22F/sdP7qtOO4wn1d0zdfe0nfFVr9RVoMv1hxYudXcTlt8I5wr6b/ 
> AJfGDT6ifn8/5
> btPmW7eHZDpPt3O8ueSLwssdMi3QAPa0fu1397ntP0f2KBkq7/6x34SCpeEPzLQfUGrE 
> +z7X
> wblw7bxjyXaHv2SdC2JT82TqPR/Vz 
> +m7pHR0uPeGgfvPlvuevOTXecEBesBMi7EvxldP3nVk
> /vQbqTNkQZp+Q0LjbT5MDnb0nJN5Mxx/sD0lLHTl88jzFHL1BaMYPPhZ9eZ/cIEad+/ 
> 1UWWR
> lycmnp1X0fVSp2yY1Tk15F5I/jFpXY/6b7N9Ql1 
> +7rodX7cldcNUl9CddZ237L1ckW7sWc7o
> t41iR04ZrW+8/XPhICrvi4LUPQefak+wVw8fXe80SjUxZ0i74+8Jzxdn7V92/ 
> f0d8LKsO+aC
> zeSF/1yf8NfX/pzJ8bwrC6ILv8sl7hJ6NO9D3O/ud2q7sk8L5fk8jFv1xNBIXNtiW0L/ 
> 6vIj
> EXf912Uofnv35vWr00V1u+fp7xMvUZjOvnQvT+QplxWB5enqWdVTc7c/ 
> q532rnLSrOXtDa+O
> 5qqqerxq/hd17dt/hntOB5w5h0RhNQqoDpDKf8j4Cg3sINT+MzEzR2v/AVWPjv/ 
> RBSDK/96g
> jVmHDQRCc9stGhsUncN73wY42pToL43lkvVaENm69IjSupQ12mrdL6dP99omIiIMbB5 
> +v3fX
> +t7cvdFKLUoiqs/6fCXWn506a3JkwrlDxw6Y5shlRcm8bJzM/+zHlufuFvIFK 
> +JjX8havj4p
> 8ET55p+ghiZzneo/OpoJGpZlX2dorvs4Vy+UeYfQpPuP11mrOzoc5X14ZXvs9v/ 
> TWDlUDTWU
> j7ZM8Hx5gXnXp3Wxdq/NbVKFt316Fm8k/9Ut/J7B+6MHrZy9N7 
> +7scmX45OmqKfJlnNVQZf0
> 183VKZ16cvWKPx0nd2t++PgtZL77/VvrH9bPF4/UUHtysHSufWhT1u3t7S83T2Jd/ 
> 7Dn/o+V
> obyXlY273bYekY66aVnXtvRI8nVX163lb7dvSRHRuGnefP+ 
> +fVaf8mUFZvxBOqQAJP8H0XD1
> B4n9f1Nj0Pi/2ej53/QBsPgHj/3RyA7C9z8YocW/ 
> qZnJaPufLgB2RjdoubuCja6CEjghKPFy
> JYAZCUAxbGfagWWNsMmCTrwByxrjlNVzyywqLtHLyUxCUwIUyQO6Q0ehIDsdxNBUqAbdFA 
> EU
> LkosqtRLqQQKakBdqANzqib4eOvRoWHyADT/69Lw+gdy7n8wMhs9/4cuACn 
> +0SYyqWcHwfLf
> xBz9/gcDk9HxX7oAZWVlBVDZb6WANucKkggB3epgRdrVPkg3+ICMcATd 
> +5BajGa8AnQ6GKTC
> G3JuJFAJ3G6IhJaWAuyINPDhe+QdVA+BAx3Mgxag539q5nsYIDj/Y2iCdv77aP 
> +fXgAt/6Pk
> e5w3bWFmbPSsDD4cFkwa4cjOw+aIR1BzeOgWMmj532jg878hOP+Pnv9MH4Ca/ 
> 43IzP9GIzj/
> GxkN5fw/CkbBKBgFo2AUjIJRMApGFgAANtM/4AAYAQA=
> --------------090108060506030400070300--
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From sfalcon at fhcrc.org  Wed Oct 18 22:29:23 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 13:29:23 -0700
Subject: [Rd] Caching bug with showMethods?
In-Reply-To: <45367428.9040606@r-project.org> (John Chambers's message of "Wed,
	18 Oct 2006 14:36:24 -0400")
References: <m2ac3uv954.fsf@ziti.local> <45362CA9.4050803@r-project.org>
	<m2zmbtsnm3.fsf@ziti.local> <45367428.9040606@r-project.org>
Message-ID: <m2d58pid0c.fsf@ziti.local>

John Chambers <jmc at r-project.org> writes:
> If showMethods() were extended in this way but consistent with its
> behavior now, you would potentially get a mess (and do a lot of
> computation).  Any method with "ANY" in any element of its signature
> qualifies (in particular, all default methods).  And if you said
> inherited=TRUE, but did NOT give a limiting class---!
>
> I think the definition you want is to find all methods for which one
> of the superclasses of "B" appears explicitly in a signature, but
> excluding "ANY" from the superclasses used.  That's quite a different
> (and longer) calculation than showMethods() does, but could indeed be
> useful.

Yes, I think excluding "ANY", but including "B" and any of its
superclasses is what would be most useful.  I realize it will take
longer to compute, but I do think it would be a useful tool.

+ seth



From sfalcon at fhcrc.org  Wed Oct 18 22:30:56 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 13:30:56 -0700
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <4536618D.9070409@gmail.com> (Roger D. Peng's message of "Wed,
	18 Oct 2006 13:17:01 -0400")
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>
	<6phvemixy1u.fsf@gopher4.fhcrc.org>
	<6phvemiuw3r.fsf@gopher4.fhcrc.org>
	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>
	<m2d58psl5d.fsf@ziti.local>
	<5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>
	<45365539.9050106@fhcrc.org> <4536618D.9070409@gmail.com>
Message-ID: <m28xjdicxr.fsf@ziti.local>

"Roger D. Peng" <rdpeng at gmail.com> writes:

> I've encountered a (I think) related problem when using promises to load 
> relatively large datasets.  For example something like
>
> delayedAssign("x", getBigDataset())
>
> runs into the same problem if you hit Ctrl-C while 'x' is being evaluated for 
> the first time.  Afterwards, there's no way to retrieve the dataset associated 
> with 'x'.
>
> Active bindings work in this case, but the problem is that I usually only want 
> to load a large dataset once.

You can do that with active bindings.  Have the function look in an
environment for the data.  If found, return it.  If not, load it into
the env and then return it.

We are using this approach in the BSGenome package in BioC (look there
for an example if you want) and it provides behavior very similar to
lazy data, but more manageable in a number of ways.

+ seth



From sfalcon at fhcrc.org  Wed Oct 18 22:32:57 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 13:32:57 -0700
Subject: [Rd] Warnings about unrecognized escapes in Rd
Message-ID: <m24pu1icue.fsf@ziti.local>

Hi,

The warning that was recently added to R-devel about unrecognized
escapes has been very helpful in identifying a number of incorrectly
specified regular expressions.

We are, however, seeing warning messages for Rd files that contiain
'\_' and I think that _is_ a recognized escape.

Can the check be refined so that '\_' is not warned about in Rd files?

+ seth



From p.dalgaard at biostat.ku.dk  Wed Oct 18 22:47:52 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 18 Oct 2006 22:47:52 +0200
Subject: [Rd] Warnings about unrecognized escapes in Rd
In-Reply-To: <m24pu1icue.fsf@ziti.local>
References: <m24pu1icue.fsf@ziti.local>
Message-ID: <x2hcy11hc7.fsf@turmalin.kubism.ku.dk>

Seth Falcon <sfalcon at fhcrc.org> writes:

> Hi,
> 
> The warning that was recently added to R-devel about unrecognized
> escapes has been very helpful in identifying a number of incorrectly
> specified regular expressions.
> 
> We are, however, seeing warning messages for Rd files that contiain
> '\_' and I think that _is_ a recognized escape.
> 
> Can the check be refined so that '\_' is not warned about in Rd files?

Er, do you have a minimal example showing the behaviour? It's not
quite clear whether you have this happening everywhere or only in
example sections, formulas or...?

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From sfalcon at fhcrc.org  Wed Oct 18 23:01:31 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 14:01:31 -0700
Subject: [Rd] Warnings about unrecognized escapes in Rd
In-Reply-To: <x2hcy11hc7.fsf@turmalin.kubism.ku.dk> (Peter Dalgaard's message
	of "18 Oct 2006 22:47:52 +0200")
References: <m24pu1icue.fsf@ziti.local> <x2hcy11hc7.fsf@turmalin.kubism.ku.dk>
Message-ID: <m2r6x5gwyc.fsf@ziti.local>

Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
> Er, do you have a minimal example showing the behaviour? It's not
> quite clear whether you have this happening everywhere or only in
> example sections, formulas or...?

Oups.  The example I was looking at has \_ in a number of places in
the Rd files so perhaps the warning is correct (in which case, my
apologies for the noise).

I'll look into it further.

Of course it would be easier to detect this if the warning message
gave more information about where the problem was encountered ;-)

+ seth



From murdoch at stats.uwo.ca  Thu Oct 19 00:11:45 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 18 Oct 2006 18:11:45 -0400
Subject: [Rd] Error condition in evaluating a promise
In-Reply-To: <4536618D.9070409@gmail.com>
References: <0359A469-1F7D-4CEF-A408-CCB185D5F90E@r-project.org>	<6phvemixy1u.fsf@gopher4.fhcrc.org>	<6phvemiuw3r.fsf@gopher4.fhcrc.org>	<9AE19AAE-9CAD-4697-82DC-07724445114C@r-project.org>	<m2d58psl5d.fsf@ziti.local>	<5EB2115D-9911-4268-85FA-9AB03F0D9009@r-project.org>	<45365539.9050106@fhcrc.org>
	<4536618D.9070409@gmail.com>
Message-ID: <4536A6A1.3040807@stats.uwo.ca>

On 10/18/2006 1:17 PM, Roger D. Peng wrote:
> I've encountered a (I think) related problem when using promises to load 
> relatively large datasets.  For example something like
> 
> delayedAssign("x", getBigDataset())
> 
> runs into the same problem if you hit Ctrl-C while 'x' is being evaluated for 
> the first time.  Afterwards, there's no way to retrieve the dataset associated 
> with 'x'.

This is only true if the assignment was made in the global environment. 
  If that was executed within a function, or the assignment was made in 
any environment except .GlobalEnv, then you can use

substitute(x, env=whatever)

to recover the getBigDataset() function call.  It could then be 
re-evaluated.

Why is the global environment special?  For backwards compatibility, I'm 
told.

Duncan Murdoch

> 
> Active bindings work in this case, but the problem is that I usually only want 
> to load a large dataset once.
> 
> -roger
> 
> Robert Gentleman wrote:
>> Simon Urbanek wrote:
>>> Seth,
>>>
>>> thanks for the suggestions.
>>>
>>> On Oct 18, 2006, at 11:23 AM, Seth Falcon wrote:
>>>
>>>> Simon Urbanek <simon.urbanek at r-project.org> writes:
>>>>> thanks, but this is not what I want (the symbols in the environment
>>>>> are invisible outside) and it has nothing to do with the question I
>>>>> posed: as I was saying in the previous e-mail the point is to have
>>>>> exported variables in a namespace, but their value is known only
>>>>> after the namespace was attached (to be precise I'm talking about
>>>>> rJava here and many variables are valid only after the VM was
>>>>> initialized - using them before is an error).
>>>> We have a similar use case and here is one workaround:
>>>>
>>>> Define an environment in your name space and use it to store the
>>>> information that you get after VM-init.
>>>>
>>>> There are a number of ways to expose this:
>>>>
>>>> * Export the env and use vmEnv$foo
>>>>
>>>> * Provide accessor functions, getVmFooInfo()
>>>>
>>>> * Or you can take the accessor function approach a bit further to make
>>>>   things look like a regular variable by using active bindings.  I can
>>>>   give more details if you want.  We are using this in the BSgenome
>>>>   package in BioC.
>>>>
>>> I'm aware of all three solutions and I've tested all three of them  
>>> (there is in fact a fourth one I'm actually using, but I won't go  
>>> into detail on that one ;)). Active bindings are the closest you can  
>>> get, but then the value is retrieved each time which I would like to  
>>> avoid.
>>>
>>> The solution with promises is very elegant, because it guarantees  
>>> that on success the final value will be locked. It also makes sense  
>>> semantically, because the value is determined by code bound to the  
>>> variable and premature evaluation is an error - just perfect.
>>>
>>> Probably I should have been more clear in my original e-mail - the  
>>> question was not to find a work-around, I have plenty of them ;), the  
>>> question was whether the behavior of promises under error conditions  
>>> is desirable or not (see subject ;)). For the internal use of  
>>> promises it is irrelevant, because promises as function arguments are  
>>> discarded when an error condition arises. However, if used in the  
>>> "wild", the behavior as described would be IMHO more useful.
>>>
>>    Promises were never intended for use at the user level, and I don't 
>> think that they can easily be made useful at that level without exposing 
>> a lot of stuff that cannot easily be explained/made bullet proof.  As 
>> Brian said, you have not told us what you want, and I am pretty sure 
>> that there are good solutions available at the R level for most problems.
>>
>>    Although the discussion has not really started, things like dispatch 
>> in the S4 system are likely to make lazy evaluation a thing of the past 
>> since it is pretty hard to dispatch on class without knowing what the 
>> class is. That means, that as we move to more S4 methods/dispatch we 
>> will be doing more evaluation of arguments.
>>
>>     best wishes
>>       Robert
>>
>>
>>> Cheers,
>>> Simon
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>



From salking at verizon.net  Thu Oct 19 01:29:10 2006
From: salking at verizon.net (salking at verizon.net)
Date: Thu, 19 Oct 2006 01:29:10 +0200 (CEST)
Subject: [Rd] Error: subscript out of bounds (PR#9305)
Message-ID: <20061018232910.64158AC01@slim.kubism.ku.dk>

Full_Name: Steven King
Version: 1.16
OS: OSX vesion 10.4.8
Submission from: (NULL) (71.126.161.149)



Setting a matrix is a function - the failure occurs only on 2 X 2 matrices.

x<-matrix(1:4,nrow=2)
> x
     [,1] [,2]
[1,]    1    3
[2,]    2    4
> x[x]<-2
Error: subscript out of bounds



From ggrothendieck at gmail.com  Thu Oct 19 02:32:15 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 18 Oct 2006 20:32:15 -0400
Subject: [Rd] Error: subscript out of bounds (PR#9305)
In-Reply-To: <20061018232910.64158AC01@slim.kubism.ku.dk>
References: <20061018232910.64158AC01@slim.kubism.ku.dk>
Message-ID: <971536df0610181732w439f714cv9d81fe584f88451f@mail.gmail.com>

See ?"[" and note in particular

"A third form of indexing is via a numeric matrix with the one column
for each dimension: each row of the index matrix then selects a single
element of the array, and the result is a vector."

Thus the result in this case should be a vector with element 1,3 as its first
component and element 2,4 as its second.  Of course since x is 2x2
neither of these exist.

Thus its behaving correctly.

On 10/18/06, salking at verizon.net <salking at verizon.net> wrote:
> Full_Name: Steven King
> Version: 1.16
> OS: OSX vesion 10.4.8
> Submission from: (NULL) (71.126.161.149)
>
>
>
> Setting a matrix is a function - the failure occurs only on 2 X 2 matrices.
>
> x<-matrix(1:4,nrow=2)
> > x
>     [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> > x[x]<-2
> Error: subscript out of bounds
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From murdoch at stats.uwo.ca  Thu Oct 19 04:00:37 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 18 Oct 2006 22:00:37 -0400
Subject: [Rd] Problems building package under Windows (PR#9303)
In-Reply-To: <20061018171153.A2F9E4D2D9@slim.kubism.ku.dk>
References: <20061018171153.A2F9E4D2D9@slim.kubism.ku.dk>
Message-ID: <4536DC45.3020504@stats.uwo.ca>

On 10/18/2006 1:11 PM, agner at agner.org wrote:
> This is a multi-part message in MIME format.
> --------------090108060506030400070300
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> Content-Transfer-Encoding: 7bit
> 
> Dear R people
> 
> I want to contribute a new package (various noncentral hypergeometric 
> distribution functions) using C++, but there are many errors when I try 
> to build even a simple package.

You haven't followed the instructions for setting up to build a package. 
  These are in the R Installation and Administration Manual, referenced 
from Windows FAQ entry 4.1, and the README file in the R home directory. 
  I suppose we could put in more pointers to these instructions, but 
where?  The FAQ seems the natural place to look when you first have 
problems.

Because you didn't read these instructions, you've wasted a lot of time 
solving problems that you shouldn't have had.  That's sad, but it's 
really your own fault.  Reporting it as a bug in R wastes other people's 
time; that's not very polite at all.

Duncan Murdoch

> 
> Here are the most important errors I have encountered so far:
> 
> 1.
> Trying to build the DLL, it can't find some of the include files. I had 
> to make the following change in Makefile
> and copy some .h files:
> ---------------------------------------------------------------------------------------------------------------
> 
> CFLAGS = $(OPTFLAGS) -I../include -I. -DHAVE_CONFIG_H -DR_DLL_BUILD
> replace by:
> CFLAGS = $(OPTFLAGS) -I../include -I../../include -I. -DHAVE_CONFIG_H 
> -DR_DLL_BUILD
> 
> 2.
> Filename case sensitivity.
> ---------------------------------------------------------------------------------------------------------------
> For some reasons, the perl scripts "build" and "check" are lower case, 
> but "INSTALL" is uppercase. So I have to write
> R CMD build
> but
> R CMD INSTALL
> 
> You may consider making Rcmd.exe case insensitive.
> 
> 3.
> Problem with tar in BUILD and INSTALL scripts:
> ---------------------------------------------------------------------------------------------------------------
> This doesn't work:
> 
>     # workaround for paths in Cygwin tar
>     $pkg =~ s+^([A-Za-x]):+/cygdrive/\1+;
> 
> It works when I change it to:
> 
>     $pkg =~ s+^([A-Za-x]):+/\1+;
> 
> This should be fixed everywhere you call tar
> 
> 4.
> Trying to execute zip in INSTALL script:
> ---------------------------------------------------------------------------------------------------------------
> 
> system("zip -r9Xq $startdir/$filename.zip $pkgname");
> 
> There is no zip in Mingw, or I haven't found it. I had to change this to 
> make a .tar.gz file instead. Remember the workaround mentioned in point 
> 3 above.
> 
> 5.
> Cannot install archive
> ---------------------------------------------------------------------------------------------------------------
> After the fixes above, I finally got an archive that looks OK, but it 
> will not install. Trying:
> 
> R CMD INSTALL Test1_1.0.tar.gz
> 
> I get the following response:
> 
> ---------- Making package Test1 ------------
>   adding build stamp to DESCRIPTION
> Warning message:
> *** someone has corrupted the Built field in package 'test1' ***
>   no R files in this package
>   no man files in this package
>   installing indices
> Error in Rdinfo(RdFiles[i]) : missing/empty \name field in 
> 'c:/PROGRA~1/R/R-24~1
> .0/R7CFE~1.INS/Test1/man/Test1.Rd.gz'
> Rd files must have a non-empty \name.
> See chapter 'Writing R documentation' in manual 'Writing R Extensions'.
> Execution halted
> make[2]: *** [indices] Error 1
> make[1]: *** [all] Error 2
> make: *** [pkg-Test1] Error 2
> *** Installation of Test1 failed ***
> Removing 'C:/PROGRA~1/R/R-24~1.0/library/Test1'
> 
> The first three messages don't make sense to me:
> - Nobody has corrupted the built field, at least I haven't touched it
> - There ARE R files in the package
> - There ARE man files in the package
> 
> The fourth error indicates that it doesn't recognize that the Test1.Rd 
> file is compressed. I didn't compress it, the scripts did!
> 
> I am including the file Test1_1.0.tar.gz for your inspection.
> 
> ---------------------------------------------------------------------------------------------------------------
> 
> This is as far as I have come after several days of work. I still don't 
> have even the simplest example working.
> 
> Could you please tell me how to get around the problems I haven't solved 
> yet.
> 
> ---------------------------------------------------------------------------------------------------------------
> 
> The poor documentation makes things worse. Allow me to propose some 
> improvements in the manual "Writing R Extensions":
> 
> * The manual doesn't tell clearly which directory to run R CMD ...  
> from. This is important.
> 
> * The manual doesn't tell clearly what software I need to install. I 
> figured out that I needed Mingw, but it would be helpful
>    to tell which packages of Mingw to install.
> 
> * It is not clear that you have to install Perl
> 
> * It doesn't tell that I need to install MS HTML Help Workshop.
> 
>   There seems to be a problem calling MS HELP (hcc.exe) unless the path 
> is specified as DOS filenames without spaces.
> 
> * It would be useful if you told where to get Mingw, Perl and MS Help 
> from. Maybe I am using wrong versions?
> 
> * The manual needs to tell whether to use _cdecl or _stdcall calling 
> convention for C/C++ code under Windows32.
> 
> * A full working example of a package with a small C/C++ code would be 
> very helpful. The package should contain all
>    necessary source files and the commands to build and install it.
> 
> ---------------------------------------------------------------------------------------------------------------
> 
> And one more thing:
> I had severe problems making Mingw work on my computer. The error 
> "Couldn't reserve space for cygwin's heap" came up all the time. It 
> appeared to be a problem with DLL's having conflicting base addresses.
> 
> Not your fault, but when I tried to avoid the problem by compiling the 
> DLL with a different compiler it turned out that I needed the file 
> R.lib. To make R.lib I needed R.exp. To make R.exp I needed to rebuild R 
> from its source, using the Mingw that didn't work! When I finally got 
> Mingw to work and fixed the problems mentioned above, I got more and 
> more errors from make, and when I finally got an R.exp file, it was empty!
> 
> May I suggest that you provide the files R.exp and R.lib with the binary 
> source for Windows, or make them available for download. This would make 
> it much easier to use a different compiler. For example, the Intel C++ 
> compiler has a lot of advanced optimization options and big math 
> function libraries that one might want to use.
> 
> ---------------------------------------------------------------------------------------------------------------
> For your ref. I have R version 2.4.0, and the following Mingw modules: 
> mingw-runtime-3.10.tar.gz, w32api-3.7.tar.gz,
> binutils-2.16.91-20060119-1.tar.gz, gcc-core-3.4.5-20060117-1.tar.gz, 
> mingw32-make-3.80.0-3.tar.gz,
> msys-1.0.dll-SNAP-1.0.11-2006.04.23.tar.bz2,
> Windows 2000
> 
> 
> --------------090108060506030400070300
> Content-Type: application/x-gzip;
>  name="Test1_1.0.tar.gz"
> Content-Transfer-Encoding: base64
> Content-Disposition: inline;
>  filename="Test1_1.0.tar.gz"
> 
> H4sIACFENkUAA+yaB1DT2bfHf0FFehNFUCD0IpBCIARRWuidBBGRJgQIJYEkNOkCC9LrKhZA
> aYILigqISJESBJQuAhasSEBQUASk+IKw+9+37nv/95/5786b+eeTuXN+555z7/0mJ7kz906w
> ODIFBgH+UqBQBBSpokK3UChSFbFhYfSu7/4WAAyqAlNBIOBQZVUACkMgVJUBsMpfK2uTADLF
> hQQGA9puvngCnkwhuVCIpD/J+29x8t+h7G8B+73+rp4UX5+/7FvwL9UfDqfXX0VFVYVR/7+D
> 39f/+7OSq6fvv3kNerWhqgjE/1B/BBymAv9D/ZFwFSQAhv6bdfwp/+H1N8Ji9LfRrTO9geit
> kS+liHk7APCsgcLKQ/t48ziAgk7xife8f/Cdt8bv3bLBWxbLs2kfbNl10Kb1Qv+wruVGCEtv
> bBsd9HymLQ3f6Pyat/G80cdK1+SVyeSgJNbHe3F5UwN2K/4rlmYGprEc/xj3fezGrsYCkTBC
> HzVEW4Oiq1gLvrtYHbqCjXkhEhistZG5AQYUPWAZrUGPYewwWD0zIJr5EpruYS0sjXTpwX5W
> LbpnY21KT6d7IbabHlbHlO4ZQdkhkvpG7hS8mQueAIqO8awQY4VIWugYG5ljsKBZs5x9uyGS
> trbaZDLRFe9CwQfiTPEEb/KGOOE/DViSiH44EiUENGu0nXcjwwQXEkQkuf02bM8PnTpYEg4H
> erYj3XT3DzG0C8UFNGNlzv9DxMzFDzQryib4Q+AfCuTAnBAo1IjghgtW2tgoQKdF4+xYIT5E
> D6KSl58HqFnkLI4VYk3fOJRcyWTQ6LZYpl0QysZmoujn4urt4oHbHJYanM7HvhnY7MhnSzdm
> 29p2KERXEHBadDMO34xfw6Yb86urb4jH0GfCQcxdfOmfD5kCABqyv+/H0H+T9GUgZhhdoq8f
> CUcm49wgukQCBUegAJeN2yQV/k/ZJKLPRhbgtV/un+bTQwQjgjsROMEC+afJWJILgexOJPlC
> vqvXkHb6F4aEIvV14WooBFQRhVaGKcJgaPqTDhypCIVqQ3VRMD2ULlI3HGJEoO9kBFfcxrwb
> XxD8X7yENY6Mo2BdTvjggAnC37JVM2DAgAEDBgwYMGDA4D+Zr0yjoCAQN+g0cBgQBUQAJoAD
> sAEIgCtABHwBP4AE4AAy/YUD3OjZHIAZgAF0/zQWCiABfXoMDqgBKAABQAFFukUDygCM/gSj
> v9D0Pg6vzXWZ6c302FHdjRuLX9vWRQewcZvCBmwHuNGqeqzAHsDQUBt8BEci44kEMEIJiVBS
> Q0Lh9LgksHHPAmyN/HU0wOZX1DFP/c1lAjiB35+96dMLAtZgQ5yPH5h+dANvHbDB3w/RdF3M
> wPfz9XcNvx2s6bPzAH843wM76Rr2E+I0OIBNGZwAwIOVwJiVG/OBNpbfEvfDbcz/BvD7d8KA
> AQMGDBgwYMCAAQMGDBgw+H8J99apn+X7vze0AUspANAEGtYrptL3ZMe3H4g1Tpc8lW56fv6y
> bUPDjQXHO7IVAZmSBdWJp7T7groyDgaMqHmyFMfE+N0CnPXdKz3pM3LUPlsMXmqoVxB7nin2
> zMyo0P6AEkHvRo1I+KnYCibVsl2OfoVFI43Phiqahp83xHXqVIXXm1Ct1pUUa0fAbJU+ejk7
> yJKc8kdgYdQrcjZl7Hy7WJN9c5b6v24oPMcLlUWKuzdl2ZNGTamCl9ld+tx2grUWdqO1BN5a
> JXBtS9QoeDnHkdYZFHZdOc3M+Mrl0vJYK37rbDxrFbbLwThRegZMZipCZfe/si7efo0fmSSk
> F3hOIkMiXXYAMRRb1Bsi9YHthJf4NevytutY1iQdsK86nNc+WVA8eWryso/M2Kt3uVQJBXTu
> CXyEXi4/lxi1MiuceB3ZxtWORcDUA4v9eGtaTGTbRJJ+6gEn8+tJehOOf5UYuF9BLW3PDIyL
> dTNKPs6mfnBFYN9NYl5+kkDiZHSwdLU36FDkdojBenI8bU3Qcjl01/LtjpD8epHmxYg5dFui
> BJ+M+WxtxDc/YsXe4hO1CwL1DZByj8QmyZq9TE4x3nyuS+Clk0/629rSYRlHvXZ31NrO8b7U
> HPtccTuswiSJowfXKVQoUBesnbC++I2v2v7DGbcmkzyl/quBl99qoa0VIG+YB+9nkK7ONEd9
> GhPmcbFX8+OldnQ+FkgZFV/t8YnXqDEOS3Qa0VvAfqnmQxyOXD8sVp1zlcPicLa69JUZIde4
> j2I1aXosrUeGr4q5tmoAT0nvDfdk2zBnTmY5S6HmKEXCyXacQWEJQXDhktqVjGY5vqUdL3Gh
> dQE/tYzsmnNiZ7VNonXozHNfar1UANmjSRqFY9s7C/XHBJRgNzxZMIZFTmoxiNneHVap52VS
> +2gHushpuRGtLMmKlTE7nJpJzjN1+PUldYEPkOKnAjrXbg7a311hYudDv8onm5Rr3BwZio63
> PTyqLwZ5i10KEQ3UjDc+MOTU5QqKHl08nbU0lzEtsZor0CeuTZHcV3rMOKFGqKNvjuYfRxoO
> 3YvqsugyUBKxbHwnQ2I18rESrHWcWFmbq4ZgBp2l2V0VVORvFoSO7RmO4oapGtvM/7wK84hW
> ez5HgwSOJLT1tSlWVb+K+ex/k5DYe7qjJ0lCXKpu97jeqkgtJGsh0de1bW+75uGTYke4J1gE
> MAHozJ7W0GHEuNaSbuoHzw9C8UJmz0Iknj0421Ke1hv0uvTlFJO1F//d5IPy8c1v3n8pDcvE
> KB6YsAuWPySDMkjiscpI57Gs7fsgKMdOHUhSFHUrbhm5qyid8PldKu/EyVvNNwSmnKKEq9Sc
> NBL7uYeo7NRPeIFtt6hMn3ZwdiXV+XksK95AVKGVxtmr+EVTmEW7qbdFM+Q08p49vrG2nlBo
> PWa5LGjg0tZaMF+W3rYrFeEiJBBE4+IO1wUR2QWuIUmj5lKr1J/NqEFJ8qFtPlq9nOX7PeXu
> UArTJA2fC/TdesVxTNnuzMMztXqtSQaVR2Er0ayZmDCfJslG+QnahwNC7xrPrmMIjTja89l9
> GNQ5V8L7oPJxYfDOT/WzllP93aQKf21CnugT8OhufyZ5ke72n0SFZPjWzZZy89979mu2PKHa
> NcPdu8L97z71TLe9FjZx34Bnwrcuci78wYtdiJHq43fClkPDHDsculAiIzeXbmsQyh+juRMu
> Ok4cCAeR9uA/XC/iRhHPQgoOo0mcVWfewMoCEVF2K6+btO5TMwKJLS8Pt9bfd5J11HmoXMdd
> 53In7dtcH19+gz5m/lpmZfaVCx9rZrcNrqPcMQqIa7X6Qq8vne0Z8zgxu5YuERyfX/tTm7j2
> K6GSU+2yDgtttZNWl40Py1LLPtcWNMd/FUUI2Kx66HDSvMbm7rXYP93e80VsfvR2b1pamWeU
> nt3s/OllXlYfwdnbmqqLpwJRMT1PBVaQiQ8855UiW2c4sobgQoOqSkkXVrMMCHdrPt/zXw3e
> NV8ic/wSRvDEChoiKufs3iQeveafjffRZHvsdWEE9k7zFHhyX4Qj3q4n7tu3cG81n3eoHRyP
> x++WpnUj34zmGYURCD2t7xctItg0OSaufYkx2h1p2CtdPdKheWV01aIpYaSse854fLmJfK/A
> Vky8zPGOwRo0/Xl+ossgaKkpxrZUeKZRSLPpBmrgcUfao5VQaa0E99SL+d1hzT2zfpnHcp3X
> YxNS9kR+U9aYQdquPemNdxLuE5tfx9iXrQ8Frqy3FYtc15D+tu3To5/Twj5n+SceF+FSpuZ8
> 1YFR5HbkfNulad10r0LiymPd3vu8n7Owlb2gsNA3h8wlSLsNEnQRAc+DvnVlumr2Tx58m4LN
> CvDqB5N2LtwnStUOIoNoaTzKk2vCe3xmzTpFn13qQjoL8ZYERJ5oK15MeRKUxH53gZS/OPz6
> ZVPKDE/EKc5R1BwnPhe9gO19gxIoHX+I+yyieNdbXb94+bgC0xtFmSnxcb38Z7FIpAFS0/+V
> 6rhc5G2T85qI+Iw6x3Xh0uHI5ccHG7elVoT8PGK/Vn8+2D06OKU2bEdg+z2pW/vLEZHG+pVe
> +PzG4xwRJ7bXufe8kaAYyDKJInjvJrJE3NNQtqq3sJJfg5dYzlGF5iMJHo6Owbg4g0Xec/d7
> WXisDCTtnl/XQDZ2OZh3LB9PK4WJHVaPOvge0hj5+mnoGcrn5jcnPPTKw4k9OQ2qXbUzumNr
> LKVhnqYveMUTxhINeMTQCbziMyxoNK/46GrN2xfELCMan7Nc7TbCBRAQddOWyUu/fq/cnebs
> F9IpvmNRn95bgbm0hNwf8DtpGnIN9/mgOb3TpczuG7yx48vX2F9pvN9DqtO6BC3vsPOZsjIl
> 16XlCVzKmBxfp9uX7Dp1Fs71kcxdVSIZrqpqmimDy+WzT3NvBX0JuOdME1QKPJUBkm5ODeXr
> 7QOV75uRWmyu0nc0b3OuTy50juqsSBQaOC/Ffn8+JnjboukrZ0l5xCc91AWus3LWY+jT41ef
> sucnktzGb+PGjTALQ/6GOano5PlfXhVlr14pIfVXjnMfyz/ZtJ258vya8pM4tZ3wQ/FLH9V2
> jnNe45pKCFGVjOq1H2gHyQA6mKCLGtd7A16/zJ5S0J+erCs5oKVQNjpRoeZJWzBrrbhcLv7V
> sB5BizVcEFgI5vGWVJl+elSVFk11kbzi7az2cruHJMFk9511WnWX1o2e9ByZgAdF+w5Uv6yz
> U3qvfqTybOFD65GXhzwDd8dVTPTM7J+QiZ7CDviAhVNLWHfHVxVfpEFFZz0OPTx5WD+yS1ux
> 1lqVB0wGn2PuflByQz6SplAwlTpVcS4k7+O7O7OhdpCafCb7gCKSRM3+160f343vfWC2bxq1
> aOyi8KJbjNn5LdfAjDOf3D2je42jF6QiG71cygPubFeljJlfjI8DT54jfcZP9Kn02ltZ+w+e
> c7booHEkqTzi5FizctyWNOIjmWNDMD70Zfho975CvmpWC2TPkSn4g4kGxUaMTUJHDt6K0rxS
> 16Jy9NGb3J5HU9V2AVlvJxHRjhd4mFemMwOzr4U8drsFlbHNOf3kRlG+HQ1vUDaYW31gYJt5
> M4tHLn4f0VXTQZkGta8EP3tXj+0sfur++WHtYP35+Fk1sdFOfumZVj/Pad+pCq/B1AiWlSBV
> G4dM9+fiSm9ZgmgSVok61NnLpWFD+m9vKL8LcZhao8Sx56j0y75O2KOuzTw9dVY3Oi+ixql7
> 7zH2eXJvHIrDkpoSmF9xkMIm3TMteMmK3CFHMF1vNGlwO7/9uckFsq32GS6VsIjjstT2k45Q
> skR/TOH9YpdCFUv10Sl579unhsY4z1pM9S6riCRKn1Zl1Zz/ID0MtVCGVsmeERMqjcjqJlOM
> H/altPQ/SrU26+35CM841lq7rl9YJoI9Ft4YVVJ9sWca5fC6m/meqZczQWHx6UFMe0BZsUkz
> lvxSji0v9nSZ/sdHfcbB5zhQw7MODx/mmcB/kVYc6mHNFSu7ymTSDgrgayqQu1Uv7vciJ+Vx
> Nv9eYZXU0OF7JTsfXez7+OTnEZPpuIv9uVMNRbOWk4n89fvxjnmXupWnDsJp072/GMmdi1XT
> Vqu2GqiMnWQJ8sGOBXZG2nq2yA4eLfcytXEQU/EcI6WpB9dalPQXWHDTrmOR7Onv19qmk3bh
> nMXePVK3OUUw9DA1z/bvu806haJM+x8Q9i4bPfIFIyUsf55aOTEwcreUUKFo+/pIDSWXuneS
> 2X3/hUqf9nNXtHTctOSVwyg6JVI7vSquioanjg81VHuYse7svcrnsHdEcfDQ2LRfms9T/i9L
> DylXcb5nOFZFL+bZ+zSU632YlmC2sU2FKT22KPR61HKF5re/i116QKoSh/EKRYYcyZxa+diX
> Pjj6X+xdCTxU3fsf2be0apOunbLNWLMXihKy74yZYYZZNDOWki2lJCWylCSFEkWLtU1Epbdo
> Qam0CpE20e5/750xDVHq7e39/X5/58Pcuec+5znPec7yfM95zj2zwK32KVfYq6g+Cc3gE4Ur
> zk5J8kveHdwpXXDG7J4nJuWKg+0G+3N15kvozc9OrGzsmbC1g/c9htSyT2NeT9zkXsEuCxtx
> d89+5Yy7N20frBJ9MmOq7+oT85Ujy2+l3XOxqM5M7ws4ZjFfvDA2F9921qU7QDi9VHxubAHe
> +ZDDrlNWLSSii8Yn45aElgmpzbsIjtemlVgcWEKL3bqTknFpadTipDzVlA4xkT1cDftPSCf2
> XGi4HCF+23mm8gmHjg92XTfQKbqlpXzFXuSGJuGnFvsDN87JKO328LHROHkVGWTllfBWXrdR
> 71hFbVtMbUyhN1V51gLLzIAu55Ry+ro5h0sEMBHnll6rnEmy+hQYb39dJvbxnmcCco4Ca1wW
> PMoIq3JwynOoNm8vv2aftSDro9thbNU0nrVy2ypjn+W4yDwJbed+YiE0z1ktSC58el09kCo4
> o7FPW5Ljeo32fQ3aDjm1NwkKa+ikaadrUqK2pq3tuTtn19aJB1/dn1bt1up2QB791rYqzT9f
> TtC42m0jpr3z7S5L0a7EvSnu8ruOZxfYHDCMqq+af8+4YvnT9U1vbpofWjUrr+yZUOyqW8sq
> +G9gqfvULme721z5y+ehWcDsGRc0FrbWrTznc6oC5bAliKz9xqk+MM3p4NwwkdhML7vGbSis
> g3785BuGKw+iFzyqWTOjdovrLtnGCarH+gJ3F8zOP3ekM8ztkO4NxRKzLOXDxwWl33gcbg1M
> C1i/egnV4K9zJxt0ZJEFIcZq07m4ltKoa3hnxDXHqrq1OzSsKJPCPSQtcDi9ludIfXbVS/c5
> dn5HZHycRNLvHElciFL375qhUVW0OH3byevmvV7HkXXrG13xM7rEZr5ZVn/9lUUF2u5eD9nM
> vm7Jnhu6lyp58sKuHZhN783h+Zi7uCHFK9Wx3rNZNHet6TUpjS/708tqSg/L68lhejqfOi67
> Sc7vXj0Xe2bru/nN5w0K60w1feq0qy9VBLkLmnrrhO6tcT+mkuvXzN/7scB6+klfaaSe4cl9
> D+7zdygXPjsswNd48UO63pc7pqR50SsWXjro+gzFI4BIDRKcnFkzgV4gk1N25sjd3qTz659j
> 3oh17H96d9YsTZ3EZWaUA+sXWPSdcF3fde5jIkfxK1JPm9Z7xXP6x5ykCuZN1Jwf7741N+rG
> NUea64yKQ1b38gULaEqXZHt3u5k18Pd15hk8NUITOidPe2MbTah4Et/YFOBx9fj8TVzJc65J
> NC6ZvjuPe4dOS9Merq57S7TIK+5wL3Hc78mnaxLSTnXKnC2zefVLv/ndaTGZnXxq4ffdc2p3
> 3McUZoSuvmDuuqLjrPnGvtWzSKFt1dKe6rMcGiPli2ZVTnVb0aug1N3vuaJJcWMq3sG39sOr
> 2dLWE/TTj0pYFBI/R9t31TQfTdzikrsp/2jkiWWnmotknvWWNcmku1ZepJMd5KLPBfFeMpO2
> R2799BS1JtPKsXapzqI7NgWU/KwnybkXNm7o1Os4efvpxLhtoouiSoNd8uQU09/dOzVbZJ/s
> rlW4dVYrIm9TOg+7a5j5XVa40z4tRKB2X1f2JXkJqV7z7A+yGbpWBzaKt6HyF8y1fyq3EmV7
> ZE23arVcMCmouV0rzq1tzpVXzYtMZ3Xs9JxDV5P8cGa1Ut5KzUMhRbeky/ZjT902eUM5vzC0
> M/VCLilBgbN/1rW1lonzUqtCtQ+X6VWcFLtxP1rjoPFtsZsLpywqWZLLRXtV+1eU/ZwXTufe
> J8bePRFe+7zM7sh2DyNV2eU66katSctQrjbbZnZJ8Qro6sY1xC8xPpPciVfLEz+naWfHR70r
> zk1prDVVrFhq4pe86/BK3iyrTqsZsUGAheUTTT+BKdyyj5Jt7S/LI9O6rA9l7DFFNuXFP0hx
> vB4ZHmpjq23Qmn7sum7Lnc/pMsduElDbb9je9zVty9jd3vZS3OKLxO5Atb0zvLbfraclHVmB
> DolJ7558JWFJ25cw2mqHkvyAhvfbcGuStzt7O6r47J8m9+C2Y5LJ0pgPL4LIsVc00BkTRY/m
> Cl/kpB/aar6JIwRvcXdNFHc6uTSpUVW+wE9hrvNUxc+nD95otpjv2tlXzLXvw/JXkREZhnaK
> V9XEFb0/tbgJdmmt4j9d7pN+PbBVe1I6f0D6lN059ENX+o8l81tanyX5C93PaBSVabFr4OTx
> y864/iYmJVrMvlnsNogsjli6nCcGu5DeTPkr5ngDvukOT2+W5fXVITUG9yoX+F7oP9P5Zr7V
> Us26k6fuL1+mY6vb9hAjZ7zheuJR500Wn1oaci501qPtm1a345ceFqvuu6L90ptfMbZnclmt
> SorzLu5Vc7uWZCReczh/ztc3w/7lAvKa8L1l7nSnurpDocV3nFTO8Mh4+PRLcq96X5aqfCu2
> ea39ylk7rk7RDJgs5FJ7fUNWZ+4x9zaniXYL4k6prufANWl10D417TZ5ZX+V3Ik5YVdRvkHz
> tXNqCflg5erOfDL1ducUnGhuk+v+y3t2UnTFTm+NnYI2TVwrLt5e4oOvCa7enSduft/D/dFZ
> l0LuBXL1z7SSpit/QEWefu0t3xIaEkbSXmUxnZipJnD0aFFp8Wd6o/ZMpFCJAncjKgUn+yiw
> BG8vek2bYNvXFyyIp8o2PVup5Fm+xbDgyApldMDNnbkyeRW3r2i+D64oNGo1iNI5mdulKH41
> ub/x1lurEzd42m7qfTzolZtCS810PLSQr8Ty9hqE1vb36ddCJqW8vZqxhfTY2bz4PFarftWl
> lLASi4jVXy76xA88rW+N7y7tcjXce0HS7GFEtcX5UDPNadIU9cQzm4oNBwqDbD8Z9pUKnkdt
> va+W++DLqu2xhZ/Xr6Xrhe1avClz+cD5orP9Etlna5yCjffcDT9vdaYLU6u8F7O5ZuZmO30H
> 9aaiCCTvKxr94b75sf3NcfoOA0cMKkU+WZlk9K/sf8yHe9TcJWu56kysvNi1MN+IzkfNe7w6
> uerURXQkistNbboe/7VZ/6WoaGDccvctDadiuDi51voF9bjy+h7oF46/kXUUMMPcOW1p3vLi
> 0peuhceysyKcuHZWCgsaCXslcATwfOE27PDdMMCRTKK6criX7D/TxvNELqKb7/Si8shFxUYD
> lKXEjLNCardkXsRIcVgtmE04u+nhLIOTIgYl4V7Kn9M/IxoQuOmO4jEelSKtyySOfhZ4IfnI
> L1hmT8TuyM0vVOrfOb5I+Xh+8qn1bglBvP0SKl6VPU9eKMvmorpXPJnak+bb6yvu7eF679WT
> z4GcxnyHF6+fJLF008Ki+5rB/W8fmKVKn5Ht2cIhttmuehJW/zB+zVvLvLTbMsc8ReVUc26I
> awb4zt1/kWZQaGFza4eNTFRAwjzNqzdOBoYIh+8v0C/DfSTVA1bEpdVWRLsLBgvVLwrcNQqw
> 8CvJK31Inr/XTNgGdXTKMT1T6Yg6k/6L5cISztIKNrk7phltv5ON8+a3FJhWYuUga2a9eG8c
> ouuqa87dmIICo+3pOThvc+iZK/jMzWbv0c8HUJtNVLmn3kEusJZOUci8lRVRxTVBz8LngdSl
> iVHruU+ZTFi/VcF6agfaJkpKTjP5AsJ4Z+8xuzuVOcnSCPEDATbUqQ4RUxvC13E7i3glX6o9
> SJHa1cbhlskVQ1jI0SbnUrVe6JgV58wkid38EqhDqgfOVZnwFCZlnOd/qe6QdrGyKjumImlP
> n8Da2YoWBMDgvVCfVOT8qQJ6izlWHiYVldQt4nCQn1BktShnnwBddXJkupy57tNqTJZAd2LH
> lmS/hElFLvTLi2w4zWSOCEwR857pbpbQHHXJJoVrzVyzrV4yvV2L1vGizGdNl9b1Qk8oAG6d
> MyEErauZKL1cTHSuboJqlpXC7XXZG+t3zVYyCwp5ZGe+aJbw+TzddWLqZntspZ8tWselbrHS
> d7r0NSOzLOOE+fFYvyPr1GdPOXRToBEvbXVu6sqcBDt+d/ucVKcNYtwJOGolcZqi/wIsh2sW
> Jeo9STA6ODtq3VJdBezdk6YhU3X5tqGy6rKtuWx2TsBZyKPypkXZyRrtnLrZYr7p3mR+a9n1
> kkl1k+Vxi3eYZ/Flo7jqdlrjbOQn5FlEoWSn7bTbbHR6ehNigbXYO9VXXkVTNScKOnFbpdGM
> qp5whJYWP+xCeDfmt3+eY4rJydB9yX9FYKpvS2wkxuGw195tQQ57Q7o8Ts2/cci9qk30gQA+
> 8PnAZwRhDbfYacW06e8+fZgxbeWeB14H31RPuILO8nHDxtM/3XIJUSxScvB/SUG8o5zgmSs4
> byunW0y05k3BU0kyiTIiMRzHL9QkyanHCAvVpXz84CckSE5K6n2DUnUz6rlrlqqA0TTS9Jda
> 6iMkTK3fQ7/hU9OCEFfCmJGKUjUpvtOz5h6aI1To3nnA9eIsVLbwnN4S0lrxCmHBe/fbX7sG
> vD+3nVSWXbcq+lHZHKTqMkkt2w3lHPN3CO7K3a/mK3A7FRhYxx8xx675cF20VuQJ/+kreVyD
> X7SeiguqeFD1nAvjdFreLcrY45QTcv9hpFnDSoneStrJk8De+aRTD0T17BGUysOOpWQ0oZ9H
> OdSy4T7ioWb0wjNhH/o5i8+GXw6VCVFqOvLoQSQYq1MZlZAaKecUwCefIzzjXUbqha2v8SIT
> 7/EaBU+dGMNPqp6kc3P5u3fyojtnCp3Rxy/infhSLE3cQH7eDcE7N7Lvh75b01nosXfypAZa
> x6PbonNna00xbmnZb9yYr/C+cx1dKqf3kBOmJuE63kCfruzhfFz2naGaROa56x/PkbvNkx43
> upwIU1m/TWL9tYTPHU0LzpjsaM2NdjhssKm3k2vgerhZ5wmsd4veLO0gmxjX0oUfFvm01Ukt
> Jz5cdWLZi1R7v0b+MzfT+PwCfRJ1Ds2itXXmH/nIs+/plYt1l0+1WTxv4XvbbNiaP+GD+8kM
> ieZCo4vEW4C0aMGsCU+f5r0wFLQVa8gvcAJMgrpno/pEZ7/mlZs0YXmKsETKXOO6R2bGj54s
> M37y1GJi+0GtXZIaoTFp1/ZJ4I/nXQShQKLmirlNRxyNi/1mkJqMUP6LdzbP3nega/YJ0pkY
> 4u0iCddS4qY+0tzX+naairjLLwXrS1KUOjcIcvfUn1t453FczOKS961pDSRHzyXK9zS/fDbm
> OxDsbTU19dNVj2a+oDQq70eRJKXtlF1FmebOj5SC8+7Y77DsWVEXU3p0y6lSKbXz+QVq6/kM
> F/eqCyfb1JW3HDh6tiC/qlS65i06R0TkbS9Pjt117pfhauaN5c/3+B3rq1ibtO+I0NFESqiT
> QZGl7aZj5q+v7l8gqGx1gK8rxeQKdvlz47nr4o42kEXKtAhR6Od7DhlJrJgQ90JUOZsevSBE
> ZpmN2QnFw1rpDo9FSa+XtywjdfUse4LAdS8t2vth0/wO17tG7+/Et50gbjAWOjZg5yFlaa5I
> ovk9IL+Vzq6tEJNWSIo8oL9yRjBBQugTOjTpot/WKcSy3cfazBq+7Aosi6hHhbw8uGlNYeLl
> 8u7zJYV9gtMiXx9UxB/tP/8X9rD+nAc99itEA8yfHz+W31iCinW+2hFUnrS7wDAffwR91TfN
> XivGVelBsQzqVNG5juScK7tLbkgTEq+03QmtV/QoCDjOc7SlKNC8h//L+amFO2yftU5yL5+c
> +vw59tphazHFlmLH/MAlovHIN73Owvk5BXVOfH9lLObOai9QTkPVHqjPn+7Wfz9bZrddwPOL
> pgd4Fkzz4/Z2V8xcfOav2uKWeJMK/IVXrre9/7JyORBqvCqAssVZYU59KPl8M8m+eFOO7aNz
> zy3OSBShzlD2Utc8tXzT+ki0B/8XUsgSqbd7Uf7pHKTodS2xjzwbbweoxbktnFyVtp1GUXXw
> 31vsMZH2orvqTG1ZMX6en1g9JrnLv1vf/8XBzdmtmfP0nT/tyU53iLPrMeV0sdYwEtxVbZX4
> 2GOy7+ZTCrlFfHn6IiZtj3QvbUknvE9eZdPjnRiBvvM6fQN37tZinyc7Wj2O1hhs0UZXuE5b
> jr7sqL6IN55CVdxeIOYit95hi6cYzbg/3/1KqYKo52S79iuPI7f0GkvUxZR4xWTtzSQblqG0
> AnllOHe2ZC3eXZUXqtgttm+e9sZMC8nH+WY3fZ0jz4nuKbmZIOZ88GaK9q1PhicQe+x2Vt/c
> eb4mdIKqXpiX0Jbzm6l82IY9G1CT7rndt92bFrO1OnNpzYdi1HaRaP0ZxvF9L0Tw+47n41qW
> Xtz1xYjc+37OWlstS8tX6htvc25q379DrzdWKLmiOutTzP6PLiWtG4mUOFTOmqlnIgJKlFAv
> eAYm8Sz/ErvPU3FnXVlauAPipdbHyVJfbvJsTIjzLJ4dFbpTxfDtaRHyQNit4/FI0uHt2L4M
> rsptST68WyofbWlqbWt8zFu67LNxxcNXXZu29F72FFHmqb9/8ck7p1bXxU14vqqijf1xnDeT
> sAtdQmfM2DZzlWxq+dW2vQd71gJbUX0SW9/Vhm7xdCoXLVAS39Kg0D53Y3x7VW7JwVUGH52X
> haumTqRnRYc/kdvUcD2X+PK+R59KQ+Hso9NvzAv10ovjOFn0TmVga9jcW5weua/eDWhNf+Av
> jSr23EI9ejs9uoWD8D41TK7/ggQv7vF9+WeiG3w3pub39ar0rJu44OVHUursmNv+WQ9Prg1b
> d+D2bnG9JyRt308zPffXzBQZkLY7u815gy9lb83ey2dXdi/2TNj4IQqRVtqxar/L3NVLXa8v
> v+Dzpe+smea8L0LrH8jrIt+3q963nC7NH4GYkhhx9+pSoudEe43nMZmF9pEShJlSLz8jagt7
> tgHvOwWOEspDd/Lfjd9l/d44s50zG3W0La/NSaOu91N0dPjbpp05BhFFwWaOlyo/fohqNSxR
> DZ23VcF73dkMcb85ajU116eriesp9qfnRaQ6mn/ouMNrUCj0maMU6Dl+RXdjBGeCxJdLl94Y
> aBWjNDgHNvMsXSt+tbf/Zbhi0/NPyknvUgvLidOSN8bzvivPNLzgudM0fuO1wlemV+28SQ+W
> cOOyXp0Nl1QduIAYEFExGric18u5lreiqMDj+rxWqeJbDuIN8+5w2B+Y1EoR8bal6GufVvxI
> w8hYUXdSubOfHMx4qS5c2K2Q8Dg+zHDXB/UvogeC1kv3EPZERcw+p2t8tFtfpfOYKiGF3Lnl
> kP0pramT6jGh8zg/SRXx6UScv3HP7vVtuUTSLhHvuaT7+/Wu7M9/vlGJsyDo1t1MHpWXOXjC
> THR7XmIJmddzZ4RkXJjondI3HvxfqmpDm4SzJR+LnhUpWft0Z7DgkdcRnAflVvJN5Ije8l46
> pd9lZvNAfe1E0oIHL7MCN02SNOGbvHh9neFmuQvTLmGPGWbN6jud+Rex6+qHGs8PxZsqGc8Z
> 3hrIUmw/G5aR/UpFY0dQdpal6/XD7TONBzLfypYQOgSzHI5PLY985Ub0fPbZ1KHu8Qra3PfE
> GKyPRVC5b1mykImwZ/+lvK6Zd6cuDImPqKasvBbKx5MsbibZbiQq21/ke1U/CP0hakrOY5Gu
> fRKLByUbzBmKkTJBfBl854UP/JcH/wffjZGWZG4mifyTO1fGw68Fxvk/xlaWdqaW8IEo/0D4
> /vk/YBxKY/D8H6SWFnT+l4amhub4+T9/IpiS6dTVOsCQ01qEBRYRCWgajjYsnnEnLMB8jQx8
> zEpggqNhqIQAOoFC1gEc8Wg6QMfjWC+nYSk4GiBPw1OodIBIIOMUgPBw1kM6gU7EgRHCAvY2
> FjqAsrIK449I8KaiqasZx8OowAdUfXumjLCAsAB7EYaLzi5suH8wFgl/ooYJHB7uE0jGQN8B
> OgWUFhRC+SckGkkS1DBJUH9CEhRTkp+ofwYHE1NbYxtzaztzK8t/oI39qP9ropCs/q+pBT5H
> aiLBy3j//wPBmtGZWN3FbnUAeGM92K/toM45lh4tLMB8x1UHQCqrgq0aTQfTocDKVUKqKiG1
> wO4QSAfJIV4UIJhKoeMAAl1YADoviw7+45hPwFaPoZACiGAU9F1vNSWQ6oMOJNKNaBQSLhiP
> o+KUyTi6wbB+s4JCxQFob0ogHQiGZCXQmSKS0Ku9cQAJekzHo8kAhYwbFNiCgMGRaYOlIzLu
> AAINShxIxuKohsICTEVgQSIcFrDC0AGkNoDU0lFdqKOqDhdPFxjSMoQFFgcSiHQdwAZAKasr
> q+oCBDVtTaUAjBJI5BushtL9qpRBTupaukAwgYylBNN+qu/+jsAcQXDEgH/uENCfOv8RqQrZ
> f3XV8fM//0hgq/9FZPg189+fx4/Gf1UtrWH1r6kJNpfx8f8PhCGQin8YDIRvR4pE8TMxzb8t
> /nj4m4Gt/w8eHPHbww/6P0oNNXz811TTVB3v/38iwJUODA/Mzq5jN+JTG8CEggkk4UDgBqEv
> aOYTHu7J5+PJF+jJR/bkw3jy0T35CJ58FPAWgG8o4AULXQbnM8ICnnwmnnw4Tz4anIAKJwhg
> T6kDUcEZgrPFRSAsJGMIIECTRyppwBCOpgBgv2JAgOLDgH4QTGVNoiAQ+DVDezg3tCefL5jz
> V/awDuRDFBhEi2BhfOHCkGAJybBUtK8JACAEmqoxECgIL+VC5AAImYJyspeMDucFloY4JDVI
> Ze4DkHEYHI0GTuIUGegUiwNhMJHGQKlQGdjLBiLbIByrGA4wXyIsIVsxvsoDJQ9CEwNxABVH
> D6SSQegK5gjCWhDcogELc1s7RSAQVCUjKYS3kYAOYDJUmXJwvNxXGtQoNCg5lghg7TJEdIRF
> pMK6I8CfvjrsVEwyS7im6UOLAU6BqWAJqAAZnCTQmDplPFqB9scBFPghDQfXMA1sCmCcI5pK
> BvE1CKPpeMCN+Sx0MDYsFMoyDAhn1XAgnCsezp4qD1aPArsAweBEBJx4AGioShlpbOAa9YE/
> qYOtAsNowGxJA8AJCBXnA7YFMli90AwGqgsigY4Dx41AKk4lGOcN0MBbuL0MCmQL88EBsGhE
> uJFS2OWhePuBJYLZ2eJwwCIijQKgaYAcNGzLKYIETD6mnnwhsOJJcFciDhdPSkoJDIAtnhJI
> xAJgQzExtzE1trNwBnAhOEwgHTrMFZCQACAqtiSAvr4BAFa9D9jpACyajma0HioanLKQFNkJ
> wUChQssWACSaPESrT4BApQIAn1YEKQM6QhaLpmJhTmA10mnKbAICduzdF2yvmEAqqEw6cTXY
> ISABsGDJmdSDZGDXBUIWIJEQm397PP1vC8Pt/yDO+515/Mj+I1Hqw+y/lpaG2rj9/xNh6ALv
> 2DDACPYfHvHx8NhDBwbHVmhAC4DjwIHSn2V4mVCAMTgB8vBwxxyJGamJgzYDWqUBx//RuDCg
> Ap0x0P08qvj5NaMhQITJ5TtwhH3BbKh03yIDFrJgLcgNrsgx4xkLc2wUrCeshTfGyhszlrEA
> BwX2RTjmQ9bS1/fWvtjAF1icIBw1iIALhsqFpwRDpgiyAWxFVAQIZAwxEAsZXCiaRKHRmSwI
> pAAKFRz26RAz8G9w4Kax1PIDkzx0zXCw/n5x6RCSALQyTC5oeFkSAG2SCnghsXiOVoFjBALh
> oI4HjT5kExmghQ0aQObQG+TtS6WACgd1Bx3EDvcnVlY/ggWAFdzU0ESo/fnD8ICRDQlstAGg
> 0DRFAKfsq8zUupxegL+vgRwwVrQAJqGBNQdCAlwIGrrSBnUCVS1bpQ6vzn97TBsPYw/D7D/q
> n8jjl+b/yHH7/ycCXOnA8PD/b/6PGp//j8//x+f//8XzfxRqHHv8fGDbQfKP5fEr/l+k1rj/
> 908Etvofcsz47ww/wn+ob/y/Whqocfz3R4KehImVsZ2ztSkAVTtgbb/YwtwYkFRSUXFUM1ZR
> MbEzAczsVlgA6sqqSAD+wTACY86pomJqKWkgLKAHpTPQw+PQWAM9eC+fgc1YNgzpqTCIQQ4k
> EPqA2dMDlHCrAglB+pLMX25TgtY8JCHgB93pS9JxIXS4qeoCGDyaCpoOfQKNoqStrbFQCQnL
> As2DQftL1Jek0VeDE1Y8DkeXBOggG2ZqDI0mCeBBC60vydhJZwP9ZB2cVoVRBG8KdjVcLKTB
> GPYx6hFIvgCGiKbRwAwoAdBP4kkCNCpmkD34h6VgGP1r8PfyJAE0ESyNqw0AxbhLGoBZIw0g
> 46WHpzKuWEIQSETwJetLYsCi46iwhOghkrOzZgpIg/suyBCSajQpcD50WAphAYYYzOUkAPpl
> OndJEEFh6Xh9STVVUE84gi+ezvjuTaFicVR9SVVIXPT3pSGwhpHvixIYMEQQO0rAz+SvAiqJ
> qTWUwZAJyZAfRvCCl9HkgCDmTzAglVVBfaNYKeFfUrCGlMeKBh8woBBTFnD4koErgE4Fmzh2
> MBqlAcay1PDt3lRJgyFxkNhgo8fCjLBjaVwjbJIFYA7gB/WX5fkX5ECx5Y8alv8oO16HZqAC
> 1wf8De6fenADMhiHe387fHd39W/K4wf2X01TFTnU/qNUtdTG/T9/JPxr9h/27AwfVv7DQcGI
> hgGgBZJIaOpqfUloyZ0xzR3iVAuF+1gYOCYyxkmDER8zxjtwFGXafSpk+yQNhq21fR0V2cZE
> 0Gz9sr6/mjy8mgHb6g74RI1R4gDw8ivbq8e6aDfcyaKnEjBEJHhZbKg4zFpgKd4GC8Axg0Ya
> Wh9gUyUEeSQNWI41WIcjEABM88gwTV9N24jcmP64UXlZDxr9sXFj+fBGZQjjlrExY7j+RuX0
> 1R84VoYsd+GoPEd1Iw7LgtVoGe3jV/2KQzyKMKuhPqihbYjx5oE8TWFoKxrqVGQkYbT27zsW
> ZYl03VF8i7K+dF1YHGgV62c8i0MFtmGtIA6V+G97FYdmM7iW+E0mY/crwuR6GAoWZzBsQgBp
> KcDfF9IIA16wRQyDpWxPGOAQ5jeCwKZMPySbwFQcQ+Rf8VSCzKk4JnvG5GukiRdrgqSHIxnY
> MYYI8Bv7hAJglZ19DUXSAP7uzigTa7byn4VgR3yX7Tfn8UP8p4kcvv6jpjG+//ePhH8I/40y
> q/tfwnej4Lrfg+dG1d/Y8NrvcJgOHXrtaTCaGTruft04zT6UwiaX6gsXkm2oHo7ZADTV15tI
> wfgzURvksYQ1RacESML6ZNiVEKY9YFszgArIcnYOpRr0w468fPAdTPm3vLJDdeUAuV6Hcf+O
> b1ZYYCTnLAuR/KreGG7dkZQ3sqN32IrO99iixswWJTdyRegx9AW26kHVQYpj+muHqo7hLR6q
> YUsQtQ2vvm+9xmyQboye4+84jscEKb9xHY8R1/2823hsSG4Ux/GIgC2QDjZ0BhKAnLdMCAN9
> ZQNlTGfz2GDZz7mbmZ5mCAV+z9n8d/3MY3Yxf7u7/H8RL454gsBvzuOX8N+4/++PhHH894v4
> DzUy/kP9f8N/qHH8N47/xvHfOP7738Z/0O7C/138Z25pYur0mzl/DT86/0MNqTb8/DfU+P7/
> PxNGfv8fGP0gstFeGPypfSSsffTfhK+nwY38ZsJ3JPu3VflfGRj9n4gGgfI/tgH45/b/IqH+
> r6GFHN//+ycCe/0P3QBE/21HQf3w/W81jW/2/6iPj/9/JLiZgRNgHHVR6JDKDwv9xQ0lYQw+
> yjZYNA2vPMhNWMANDR2GycwlbHhmjFiQyp9xRGbo0CdKbHy8cb4EcijbVCPMDZz6o0P+7B4V
> NxwZO0QINsngCSNLKjc7tHcgEU0NJRLDQlnnCeoAsgwnkpvb4JGLsoNbRqAo1nYQWQguQjGM
> PR2ybJs3oFjWxgzZ0XdgQHRh/+x2C6Y6GCVnqYIxR2JpYvg73L9+8uMv7K+AJWQKxBLw63SM
> JeTf3mEBZ8TGmJUZOP+Cpl/sOf3kNgs3aAYW6mYBEi8Khd/lDmNewr5mPZgNK9/Bydk3McYg
> t7Bf3jsBZzaUE3sUlN04IvsvCN/Y/99o9wfDj+y/JnL4+19aaurj53//kTDU/oeFjjK7GsFG
> w4dYjxKPYosf3WL/jlXq0S0xvGL99RY0fN7gME0KY9+2AKdmewLfD0vIWsr+GkXEDs0QtBgk
> V8bwHBLmzv5m+GDk19fD4SyGM4Ct07f5DAcTf2uNemQjDa9Vh/3aAvWPtcFYgwZVMtq75cOJ
> UaMRQy+Zj6Q6eH2Y+WiwLCyLCzeWsMHV3LDBtWSmocQMbS/QmjKbpkd6Cf03vH8O5w1nNRpO
> +mYNeczY5edXkX8CrYyylDwElECLsWGMzzDmSvGvgZJfWjn+7jvq/+K2gf9oqDTc/qP+dfuP
> HN//+QfDEPuP+oH9R41i/7+JR7HF/2faf9S4/R+3/+P2f9z+//Nu4/8G+0/wpv1HnP+C1FJH
> jZ//8gcDW/3DX5WxxN+9/RPGf6PXP1Lz2/rXQiLH/T9/JKxwSUBwglcu8H9gAIEoY8YbjSFt
> JPg/cV7FRMQJ/isSZRwWVyTs8OC4GECl+FLRJACDJoPGExq9qYHggEkGTKxsQcSCxSkLCwtI
> M3lYmyIQFhx8iFZjTdNBvg8QE6UEOSZowz8tORP8h35qchLzH4AoTvjD3ycw5OZgyg+HBMbN
> g0cIuFxwAogW+pjEIIEv1gjEYujqBWYB8Q9AIIgTRi5kwxh08bMBmmbRwespXqZAfOyFYARQ
> NC9lyAyB3+G+ACAYuhAaSmeEQFQqUxmEsKyqTLqJ39AZKXvT4MbbwIwYKURC/HAMfrCOrBFf
> 62A4PwKDDtahF7MMU0aSj0bFIJg6DmDSiY5EhyNSMEz5Ipn5zv6GbvHIko+Hnw32sW2ODrbR
> 3UJxYULRAxwi6/PByNi10lxx7pPiVvDFuknzxQpJd8iA1RBbC5JBNDuqkJUb+kR2VG6oorvG
> TUcYnfDfcJ1uGjd3EvitSziBPUR3cS28QZ0Vx7mhkv5moIFBDUfSuuLpsojYadIdZjwIBPJ6
> LPzoAhc8MnRIg3EbBgInDbIPXILsg+lfxuN6XT083auEENA9SB85SL8fJq2kEy/ARdsPidMR
> CkrewQN+dMoODAwkMISMD0LEn5KDiMYgH3KgI5cbLL4+u3zrwZhOCsixYxf47QLcJZGVnZ5g
> THwJRMHkb18B5RfbFt09sxxKH2fKF2sH6tRCmiuWS7pDCUx8Kfodx6zKakYy+3IWfcUgvYU0
> lAam/wx2m0vVbPoF68+9Mxgs3td7MGmsey+UMPBdbNgnKFkMJP+FOFMh6GY1JDCXNDQ4xNaW
> QYNnrIk0VwcVouGSjq3uCIG+iUl3WIPXezx3eW9xI1RP+N+bCSaCqDvw0PNbcYHv4sBswAy6
> 3b9KZM9g2AbVD0seviwEAGpVG0GfMTApTvj/2HsSqCiObRtEBRRFBMUNR0VFcLD3nlFBWUYW
> 9wFcIgq9CmF1ZkDD0ajIRCaIItGIiNERF5LggktQo0QCiguiT40SXBIJJigalRjc5VX3QETy
> /8vJ+Ynv/Xe4c6qr7q17b1Xfe6u6uxqqRSRtqkW6l0WuWATOvX2qJH3/kKZ4BNFoYczrCQSe
> NOqG6Y8ZSnTdDQ1N9my03yhWjU9oAL0JtwMOzn7V2Dhz1uwS5Ngyj3xQBdVZj03rqxeL+qsJ
> j+qK3vSHSX9aP9lYqZ6QWjokddpGpImNOkuNdhH9//v2XEF7M1q3Z29q7wJor6V3wPkfOg+L
> /qyzN3UDnHea2bJiS7Nk8Sq29KlYq7nz2oAhxgzJ/7PT/C0abxoaQg57S/YM6lp4bNldToyd
> 9JA85GpTQDQ67AnfH3W4P+CRzgGMUP2xhI51HmanAhd0WbLQNc8r4ZHVGYC9V79sVHBCR+C3
> 2S9OlYCTwUHLhx8DmYOc2EMxKMUwqDOXoiML0L58KKqVakNNIVt7FtS2tieYP5bePSKem4fY
> d32jzrJpjJaUqbK8ABhtgY70RVllqhwRLVNtFjOD6qDRHlSUqbaaqHkm6hGjo0TNN1H3mKjH
> jH0l6n4TWmqUif1SnTQ6S3m50UXKzxuHS/mlroXtYVASDKpKw2hgp3xgJ8mGFvpjXfXzzKSz
> DBbD+TYoiw7vmrLKTBoCyKkisUIaozpny9onIrOPhW1zoJT5WGZ03x9lHCvOB+1E1jQHX7Hs
> I34HGzL42BttQVwbghzTHOzFgk9f4xSpfjiYHhoNQTKDD2x0FEeBQ1+pHjeGi14PUqQ5cGLB
> Z7QxXhLwNQmMNfj4pzk4A16jTNI8RXK5wWeCoXLASWn+cJaZnbLwSk1x9QcSge/9JNncoI8A
> mGRlgz5aLDpKxXix2Fcq6sSiZEv9ArEomVO/UCyaLLqkyaIpry2amq4XW5HiL0+y6wPRrg0J
> 3sgFMAacxMlDvMv4zfCgFti+dsRLIFRi6CeGSbqPRe4SKbfM3SzmTSFjeFBrCdiUlYb6hIK6
> gtoo6Le5TYTGwUeAvoyM5utX4+DyVvj5VnhpK/xSK/xYK/xkK7yyFb6nFZ7fCs97A5fm5+nP
> wJWnuf81rfhrW+F3W+EPJFyMg3BxthFpjeKd+l8DB5t0toRm/a3zNvgvhM2dx7VE5RMCvP18
> fKZjqFzlL8fkQYETAuV+wf5q+cSASX6ADHjmY2iYNoLW8Fy8TiP31EYm8TIPD5mYxwkugCdM
> 5R8W5O+lVvkOE3Wa/r9kLsvKMXfcnRBLI9i4WCFy7gjx47gjgD65SZ8cKHQXHxMgP17npYuL
> mUTH8F4yF/DMHTNcph3e3IZ22DDZAI+3s0Dw3w/Nz97oFNOzdHNyAfhwkGCQzneDoNHicyD0
> eplIfI+C/Rv73Qb/dwgOf10uBc/xeQCPaEF7BGhHAJ7RgmbLQFBNC7w1PAF1FkDOln5Nk4Ey
> DNJokPxp8bvjEBQKEgdSfAu+haCcAlKW2Bf679NpBnlxnDjDeEHQbmhcZGwTcu2NmQeCnKGw
> MBDrcbH8gkhxvSYOCqO1Wl4jlrOgMF6jiY0T9TmY00wcoMLmghCdoI0QaWPMBQ3PQ5DGPIaO
> llY1ICjJPIaP0fKiOFRkplZ5TYCgse3UQpjEMY1nm1Yfe1oAWrz457Is4NVB74p4QuxvFGmt
> pSmNV6knqSZgaPParX34v04x2kRWozNxu4S/mdR/xwJwG/xHQ9Vva69m0hKfo2nl7Q26eD2A
> /we6lQUYe6A0Ix7EVov1U3tzHBynQUFQGDiqIDUoBUCToUkADwDHcaAswlGL+69EPS7SQt/K
> 7OZV23ZNeprXd1uCRiIEgVGhgSKhWGgu0BYJRUM80BwLCZA4ICdJPDCEg6SUchUk9igU6g30
> NfP7gqSFWElPPNAXCWRjpTZ8oQngJ5O0aUCuBikeogFvFDjOBXIyMPR0krwOQiDxYdgF9Pa1
> 7mkgaUDta50I5C4tzc6BugM+H0CPATpN3BzQlwD4OEnK1F5rDSiQxyUdMtAWCnIYIiE50AuD
> IwxhkHS7BWR7Af1TgGwc9C7QwYIeyiRLmWwTAXAdaHkkNAL85ks/d8AtB7SWMu7Suc9tsgck
> +ZMGlN9bW5wnRU8Fg1oaULWgnn7DnlYWNa1Wt9vgPwLAgC8FmQ88EZ4Hr4C3wGfha3A93A0Z
> jjBINJKJ5CBD0LmoDl2MZqH70KNoBfot+hQ1x2ywQZgc88QCMAZLwpZgmVgx9gyzwB3xgfgk
> XMAX42vxz/HD+Nf4afwCfg2/jbsRFDGa8CemE+FEBJFELCFSidXEeiKfKCCqiFvEA+I50YHs
> RvYlnUl30otkyARyEakn95JfkxfIarKeNKfsqIEUSnlTakpDJVOZ1BYqnxLfi0ivRNqeB/40
> mN7/xtCxf9/r/z/3/p+S3v+jON72/v9twGv/Bzf945773KS/uI0//P9PnGzlfwpEQNv7/7cB
> /dMsTYVO90Lux1WPs30Z2uigHalydo03+3Sn/fVt6V22jlvXP8SOGLnW9Z27ZqHRI6pmd8zg
> XzUUzbxqcaHm0u6d9YOXrv92/XtxglPHS7d1tdN+GsJll1ptymDrkjbqrX969/T1Df4Dk6du
> V7s3hPKwOiD/bmH+kx63H8Qe/b761H1mXXy3a+fWDKLYzzzsI7/QRcytUgRWr1iVfFaoe7Qq
> Yp+V8+Cr50s79azLt3Q/QKvZjaPeCTxR+Y1BfcAJ21adiK1dXfFk2L1e+pGd2DO6yroX399r
> SE20++iTu8SV4ETXSdFmtu/mDD1tH6DuURwXct7KcGhgvH322PgrX4z0zv9qX4HLlFFJ11mk
> y5oo7+dlZWMSk8o23phcfTDVpyL6h19yBq81MG7hvwxnftmX8rGT48jF3C+Ov6hl5Y8yc7Zf
> q3fPJo/PzKqZmjPxqPKbHqXbOsG70aEzVkdmzjXCdNRd1/mO6eUTL16IWN4h1Db0M0W7ob02
> dLfr+qF+5Gxn+NRPq6LyL/veMjw/fmfNOoy8drZyY6B+1JpdezNPb+n6ZF3svqPlX920suMG
> sBb+8d1GkadvOSJOUaV9kqyNVivYI5t623y8pNcHwU9vP9OdjL+3fGcmN3tMYbhMPWSLcve6
> Kt8v7vWca7ZueMCGIeN2vFLXnnlQ9/LXs9/3MESd3nqzT35Y1o7OfYvU9n26bCSjDL2+mZkm
> d1+yt9y14HDlPb8Pz+6EZxxYyyztmeo36trGxLqk3Cl+oSucG1atSnv66FFpY0zsw3NfL5af
> yfaYM2zC9h8rTtSv7z2r5PG+kAVFFvlDi4vdsh8mTxs9fdmyLhvNXGfbLG9XnvPO2i9v+RGj
> n7+IsrlyW9U31lCT+uIGfmHpnOyiFKN/UKHbmvPaGNmzwh1F0aURG2b4bp2VWyGvHG7etTo+
> wX6BbG3RyZq8W+1c7R0gj1edggpHjJ0i3JFPq+pDL73IhFhvXXrfctjnn+4KbPw6tyrEadXt
> hd692OM70brEbfMSxm5LSOZ6Dnj0sOCQ0W9tzd1fot0CD1I/JMVP7OUXn9uhpv3A3NrqFw27
> 5AP3xsyMPeLHI5U7Cm7d26kZsasxMPS7Mlp3zn0D2Sn1aUU/9sQFeu/Rhq7jndilA7y8uz0t
> vlJvkTH+pC23PPjsDZdlM0LGsy/ia77Uu1lGaD/98VqO55XPPyndc93tI4OnO0vlTr3n1jtq
> 5ub77l3cKpXhayJ+XPlx3PrP+emJj6ek9Rqatjd6UCX1WLfm/nfzX9BndZ/4phR0roj7YNN9
> 96Jqf2W5sfHglfn3a06M9MzyXDRycO8HFm4TV2tOn0vtbD9hR0z/+n6k3WMv9aMp3p7Hnxyd
> 0W/1dyF0gtuC6vYdKxLbjf61+ohHh2ivrD4rSrxcBoXB5rs2Wx2bev7O8zmT3ZdVbDkZtb32
> UPSPnTKtT7jaxBADq+wcVGMWNH6WnDj/kRYLG+dxM+5ccsiozcuX17llJC4iFi6IeDe2/YsN
> dpcbd6T8+tg5v3Fxxp5XG1KOBlSCgwv98tVi1devOvheyzl92ObfO8O1wb8C0/V/ou/fea/1
> h99/I1p8/w0T9//BxW2A2q7/bwFwBU+xKI0yKILxDMogFLgHU1A4w+ECh1GIzNVn8qRg1aTg
> IBtrgaVolKMRBeBmUYpnUSVMkLCgUKLAwxwlc/VVBfmoA6YEB0yeZGNNAiVKXkBpgsRRilXi
> GIvxCI6zFEMzSlgpc5W2nbKxVjAcD+74KZjGSJxQYCTNkwjMoyzGsBzP0TLXibyOHgFuTTWc
> 1sYawVAK5TnQbYKhCUypIJQcTGFKGFHAChYVmtgjtDytYSOaZHiSxmCOoEBDSprgYZqFFSDu
> MIbmeYwkmmSa9z6RZEieI2FCQJVKRsB5GiMIHKMIFIZZBEFZRCFzVct/t2uK2sZaSSo4BJhE
> lFaQAsGjKEaxDE6QKEMoWbalnMhPM4iSxAQWRkkOoZSABTiDURAUiaIwx7RsB5X0U5TAgQqB
> ommWAHIwSxK0QGM8CfxAAruqTcqBx3ClwKMKJaMUBJpVYiTH8AQisDRK0mDggdNmpQ3fTPf+
> bEQM0E5TGAX8jPIKUiEQDOgPh/A4xjEERWMILnOVPhbuFSttVmZjzfI4yRACw1JKJYzxLEyy
> ChrhaIrjlYKC45v4mzrEKliGBgFDAJUsypEcxQGdLI7QFC4auSW3/LfNonicUTIchbMsDUwL
> AhUmlEoMVRA4wgkKXNlCCgW+BuZhMRBBMIGiCgwlwMlgwEYgo5QcywHu1p+7tLGGcWBPEsQc
> hwoCwytR0B4FRgLwGYcqcLxJ6PffyAKiKAMDw8IKYFgWAfFIMzRL8RirUPACIg6hVp9XACdE
> iG6mEAWr4DEYhUHIoAwJ00qKQWmSYVuIoE0iJMOxjABTHElxoscZhYCRFI2wFKVEENEv/8sm
> PkCUVMCgXwKhoGgwIhFagZMwzwkEhgsUquDeEDWJIAwrMEqepwieJQhEQfEIy7Bg5MIKkmYE
> uqUIahKBORzEFctxINBImEEEEkOVPAXmFpgXcKmDb/yVOYhOhGGACNBJCRjNMkqSIxhSCbwK
> Yg2jgVtbPZe27Sjxl0PT9V+c/P62Nv7c+o+0/x9GYm3rP28DWvi/xQXzr23jj/Z/BN5u5X+K
> QNq+//dW4PX6z8ZMr8nLYPuyTqxZ+jg79khDXscAsvv9cR5Z71UW++62TMBZea9zw+c8qd2w
> e1Za516sk9OixqLHz569/+hlli3T/WpxXNfZmpXbU1bVta/q9k7j2ltwpdvJld+gVpfPKwqr
> lO1DFn+k/weeA2tdgke50Hd+vpFp6+K84o517/EfX/x89Grt5mE972b3UPWy6DKsxGb2opn2
> m8IGmru3b2/YhlsmV9xst7sKKin4pjblSeBjxjNox66Hub7aqGFO21PjT2hezgouv3JIHvry
> 7NQ6m/lHEmY/1i9e4eO/f/+m/gd+yvO85Wg9axh3YpD8yNBup7LSrJ6NfzluUpeSiyfvzM+4
> PmLbD31w76X7pzkcq+iQU1U43WHzmd7Bjz1v0UVCUXpe8oXy9wXvA5+m3R7oFHw8Pm4rXT/G
> 8tWZLf0mfDXIMa60qKfGaf5An969V+9Kd9qaOqPDvfT3ofW7U3oe+n/xvqvF+G9x8/vXtvEH
> 4x+BW+z/SlK4OP5xcLloG/9vAV6P/5ig63EXYdvJYy6v6VG61fOh8NDcf3/g4c/6uZl3uGW0
> yw2aNfVGxroF6SrGr0Gf17iwOHYEnd7j1MNFVY+fX386t2xezuGguOzFJanpnzw9sEIT27Br
> 5uTyke22F/sdP7qtOO4wn1d0zdfe0nfFVr9RVoMv1hxYudXcTlt8I5wr6b/AJfGDT6ifn8/5
> btPmW7eHZDpPt3O8ueSLwssdMi3QAPa0fu1397ntP0f2KBkq7/6x34SCpeEPzLQfUGrE+z7X
> wblw7bxjyXaHv2SdC2JT82TqPR/Vz+m7pHR0uPeGgfvPlvuevOTXecEBesBMi7EvxldP3nVk
> /vQbqTNkQZp+Q0LjbT5MDnb0nJN5Mxx/sD0lLHTl88jzFHL1BaMYPPhZ9eZ/cIEad+/1UWWR
> lycmnp1X0fVSp2yY1Tk15F5I/jFpXY/6b7N9Ql1+7rodX7cldcNUl9CddZ237L1ckW7sWc7o
> t41iR04ZrW+8/XPhICrvi4LUPQefak+wVw8fXe80SjUxZ0i74+8Jzxdn7V92/f0d8LKsO+aC
> zeSF/1yf8NfX/pzJ8bwrC6ILv8sl7hJ6NO9D3O/ud2q7sk8L5fk8jFv1xNBIXNtiW0L/6vIj
> EXf912Uofnv35vWr00V1u+fp7xMvUZjOvnQvT+QplxWB5enqWdVTc7c/q532rnLSrOXtDa+O
> 5qqqerxq/hd17dt/hntOB5w5h0RhNQqoDpDKf8j4Cg3sINT+MzEzR2v/AVWPjv/RBSDK/96g
> jVmHDQRCc9stGhsUncN73wY42pToL43lkvVaENm69IjSupQ12mrdL6dP99omIiIMbB5+v3fX
> +t7cvdFKLUoiqs/6fCXWn506a3JkwrlDxw6Y5shlRcm8bJzM/+zHlufuFvIFK+JjX8havj4p
> 8ET55p+ghiZzneo/OpoJGpZlX2dorvs4Vy+UeYfQpPuP11mrOzoc5X14ZXvs9v/TWDlUDTWU
> j7ZM8Hx5gXnXp3Wxdq/NbVKFt316Fm8k/9Ut/J7B+6MHrZy9N7+7scmX45OmqKfJlnNVQZf0
> 183VKZ16cvWKPx0nd2t++PgtZL77/VvrH9bPF4/UUHtysHSufWhT1u3t7S83T2Jd/7Dn/o+V
> obyXlY273bYekY66aVnXtvRI8nVX163lb7dvSRHRuGnefP++fVaf8mUFZvxBOqQAJP8H0XD1
> B4n9f1Nj0Pi/2ej53/QBsPgHj/3RyA7C9z8YocW/qZnJaPufLgB2RjdoubuCja6CEjghKPFy
> JYAZCUAxbGfagWWNsMmCTrwByxrjlNVzyywqLtHLyUxCUwIUyQO6Q0ehIDsdxNBUqAbdFAEU
> LkosqtRLqQQKakBdqANzqib4eOvRoWHyADT/69Lw+gdy7n8wMhs9/4cuACn+0SYyqWcHwfLf
> xBz9/gcDk9HxX7oAZWVlBVDZb6WANucKkggB3epgRdrVPkg3+ICMcATd+5BajGa8AnQ6GKTC
> G3JuJFAJ3G6IhJaWAuyINPDhe+QdVA+BAx3Mgxag539q5nsYIDj/Y2iCdv77aP+fXgAt/6Pk
> e5w3bWFmbPSsDD4cFkwa4cjOw+aIR1BzeOgWMmj532jg878hOP+Pnv9MH4Ca/43IzP9GIzj/
> GxkN5fw/CkbBKBgFo2AUjIJRMApGFgAANtM/4AAYAQA=
> --------------090108060506030400070300--
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From ggrothendieck at gmail.com  Thu Oct 19 04:32:14 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 18 Oct 2006 22:32:14 -0400
Subject: [Rd] http://cran.r-project.org/contrib/extra/
Message-ID: <971536df0610181932v6af9f46cmd1e226d46d91eeee@mail.gmail.com>

I can't seem to find any way to get from the main R page to

   http://cran.r-project.org/contrib/extra/

via any series of links.   Does such a path exist?  Where is it?



From sfalcon at fhcrc.org  Thu Oct 19 06:19:44 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 18 Oct 2006 21:19:44 -0700
Subject: [Rd] Warnings about unrecognized escapes in Rd
In-Reply-To: <m2r6x5gwyc.fsf@ziti.local> (Seth Falcon's message of "Wed,
	18 Oct 2006 14:01:31 -0700")
References: <m24pu1icue.fsf@ziti.local> <x2hcy11hc7.fsf@turmalin.kubism.ku.dk>
	<m2r6x5gwyc.fsf@ziti.local>
Message-ID: <m2hcy1djj3.fsf@ziti.local>

Seth Falcon <sfalcon at fhcrc.org> writes:

> Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
>> Er, do you have a minimal example showing the behaviour? It's not
>> quite clear whether you have this happening everywhere or only in
>> example sections, formulas or...?
>
> Oups.  The example I was looking at has \_ in a number of places in
> the Rd files so perhaps the warning is correct (in which case, my
> apologies for the noise).
>
> I'll look into it further.
>
> Of course it would be easier to detect this if the warning message
> gave more information about where the problem was encountered ;-)

Just to complete the thread: I was wrong, R was warning about
unrecognized escape sequences in example and usage sections, not
documentation text.

Sorry for the noise.

+ seth



From ripley at stats.ox.ac.uk  Thu Oct 19 08:20:02 2006
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 19 Oct 2006 08:20:02 +0200 (CEST)
Subject: [Rd] Error: subscript out of bounds (PR#9305)
Message-ID: <20061019062002.5AA29561AC@slim.kubism.ku.dk>

Why do you consider this to be a bug: you are using matrix indexing, and 
there is no element c(1,3) of x?

This form of indexing is covered in 'An Introduction to R'.


On Thu, 19 Oct 2006, salking at verizon.net wrote:

> Full_Name: Steven King
> Version: 1.16

There is no such version of R.

> OS: OSX vesion 10.4.8
> Submission from: (NULL) (71.126.161.149)
>
>
>
> Setting a matrix is a function - the failure occurs only on 2 X 2 matrices.
>
> x<-matrix(1:4,nrow=2)
>> x
>     [,1] [,2]
> [1,]    1    3
> [2,]    2    4
>> x[x]<-2
> Error: subscript out of bounds

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ripley at stats.ox.ac.uk  Thu Oct 19 08:26:19 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 19 Oct 2006 07:26:19 +0100 (BST)
Subject: [Rd] Warnings about unrecognized escapes in Rd
In-Reply-To: <m2hcy1djj3.fsf@ziti.local>
References: <m24pu1icue.fsf@ziti.local> <x2hcy11hc7.fsf@turmalin.kubism.ku.dk>
	<m2r6x5gwyc.fsf@ziti.local> <m2hcy1djj3.fsf@ziti.local>
Message-ID: <Pine.LNX.4.64.0610190721210.4048@gannet.stats.ox.ac.uk>

On Wed, 18 Oct 2006, Seth Falcon wrote:

> Seth Falcon <sfalcon at fhcrc.org> writes:
>
>> Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
>>> Er, do you have a minimal example showing the behaviour? It's not
>>> quite clear whether you have this happening everywhere or only in
>>> example sections, formulas or...?
>>
>> Oups.  The example I was looking at has \_ in a number of places in
>> the Rd files so perhaps the warning is correct (in which case, my
>> apologies for the noise).
>>
>> I'll look into it further.
>>
>> Of course it would be easier to detect this if the warning message
>> gave more information about where the problem was encountered ;-)
>
> Just to complete the thread: I was wrong, R was warning about
> unrecognized escape sequences in example and usage sections, not
> documentation text.

This warning comes from the parser, and only when parsing quoted 
strings.  That is why it is hard to give any more information about where 
the error is: the parser does not know much about where in the input it 
is.  (You can't even easily give the current string as you are in the 
middle of parsing it: I am working on that one.)

>
> Sorry for the noise.
>
> + seth
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ligges at statistik.uni-dortmund.de  Thu Oct 19 09:39:39 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 19 Oct 2006 09:39:39 +0200
Subject: [Rd] http://cran.r-project.org/contrib/extra/
In-Reply-To: <971536df0610181932v6af9f46cmd1e226d46d91eeee@mail.gmail.com>
References: <971536df0610181932v6af9f46cmd1e226d46d91eeee@mail.gmail.com>
Message-ID: <45372BBB.7050100@statistik.uni-dortmund.de>



Gabor Grothendieck wrote:
> I can't seem to find any way to get from the main R page to
> 
>    http://cran.r-project.org/contrib/extra/


Everything in there is linked on CRAN -> Software - Other

Uwe Ligges


> via any series of links.   Does such a path exist?  Where is it?
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From dray at biomserv.univ-lyon1.fr  Thu Oct 19 09:46:49 2006
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Thu, 19 Oct 2006 09:46:49 +0200
Subject: [Rd] latin1,utf-8...encoding and data
In-Reply-To: <Pine.LNX.4.64.0610181647410.26390@gannet.stats.ox.ac.uk>
References: <45364201.9060003@biomserv.univ-lyon1.fr>
	<Pine.LNX.4.64.0610181647410.26390@gannet.stats.ox.ac.uk>
Message-ID: <45372D69.6020505@biomserv.univ-lyon1.fr>

Thanks a lot for this clear answer. So there is no way to preserve our 
french cultural exception (accented characters), if we want to be 
international... I have thought that the inclusion of  a parameter 
encoding in data function (e.g. data(mydata,encoding="latin1")) like in 
the function 'file' could be an way to solve the problem. Apparently, 
the problem is much more complicated...

Sincerely.


Prof Brian Ripley wrote:

> Only ASCII letters are portable: those accented characters do not even 
> exist in many of the encodings used for R, e.g. Russian and Japanese 
> on Windows machines.
>
> There is no way to associate an encoding with a character string in 
> R.  We considered it, but it would have had severe back-compatibility 
> problems and little advantage (you cannot display non-ASCII character 
> strings portably: even if you have a Unicode encoding you still need 
> to select a suitable font).
>
> 'B. Ripley' (sic)
>
>
> On Wed, 18 Oct 2006, St?phane Dray wrote:
>
>> Hello,
>> I have some questions concerning encoding and package distribution. We
>> develop the ade4 package. For some data sets included in the package,
>> there are accentued character (e.g. ?,?...). The data sets have been
>> saved using latin1 encoding, but some of us use utf-8 and can not see
>> some data sets which contains accented chracters.
>> e.g:
>>
>> librarry(ade4)
>> data(rankrock)
>> rankrock
>>
>> in this case, characters are in rownames. Other data sets have such
>> characters in data (e.g. levels of factors..). A solution is to use
>> iconv... this is quite easy for us but perhaps more difficult for a user
>> which can have no idea of the problem. This problem is quite marginal
>> for the moment but some linux distribution are utf-8 by default (e.g.
>> ubuntu) and I suppose that the problem will be more and more present in
>> the future.
>>
>> So we wonder if there is a proper way to code and save these data sets.
>> I have found some documents of B. Ripley and this note :
>>
>> http://developer.r-project.org/210update.txt
>>
>>  -  Names in data objects (e.g. in .rda files) are problematic.  It
>>     is likely that by release time these will be treated as in
>>     Latin-1.
>>
>> If I am correct, I did not find an answer to this problem.
>>
>> What are the plans of R gurus on this question ?
>> Thanks a lot.
>> Sincerely.
>>
>> Please add my adress in answers as I am not subsciber of this list.
>>
>>
>>
>


-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From frederic.gosselin at cemagref.fr  Thu Oct 19 14:05:32 2006
From: frederic.gosselin at cemagref.fr (frederic.gosselin at cemagref.fr)
Date: Thu, 19 Oct 2006 14:05:32 +0200 (CEST)
Subject: [Rd] bug when loading a new version of a function in a given .Rdata
	file (PR#9306)
Message-ID: <20061019120532.D4A04561AD@slim.kubism.ku.dk>

Full_Name: Fr?d?ric Gosselin
Version: 2.4.0
OS: windows XP
Submission from: (NULL) (195.221.118.82)


When I download a new version of a function just by copying it in the active
window of Rgui 2.4.0, it crashes. It does not happen when I first edit the
function (with fix()) and then copy the function in the new window. It does not
happen either when I copy the same function in another R session.

Both the .Rdata and functions are available.

Sincerely,

F. Gosselin



From balajis at stanford.edu  Thu Oct 19 15:05:36 2006
From: balajis at stanford.edu (Balaji S. Srinivasan)
Date: Thu, 19 Oct 2006 06:05:36 -0700
Subject: [Rd] arraytake for extracting subarrays from multidimensional arrays
Message-ID: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061019/0e53325a/attachment-0003.pl 

From r.hankin at noc.soton.ac.uk  Thu Oct 19 15:24:24 2006
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Thu, 19 Oct 2006 14:24:24 +0100
Subject: [Rd] arraytake for extracting subarrays from multidimensional
	arrays
In-Reply-To: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>
References: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>
Message-ID: <8E95D83B-82A1-4754-AB91-1DA1431E29DF@soc.soton.ac.uk>

Hi

Your arraytake() function does indeed do something
that can't be done elegantly by apltake(), AFAICS

I think that arraytake() would make a splendid addition
to the magic package.

Would that be acceptable?

best wishes


rksh


[I can't help thinking that a judicious use of do.call() could
replace the eval(parse(text=...)) construction tho' . . .]





does more-or-less this.

On 19 Oct 2006, at 14:05, Balaji S. Srinivasan wrote:

> Hi,
>
> I recently encountered a problem with array subsetting and came up  
> with a
> fix. Given an array of arbitrary dimensions, in which the number of
> dimensions is only known at runtime, I wanted to extract a  
> subarray. The
> main issue with doing this is that in order to extract a subarray  
> from an
> array of (say) 4 dimensions you usually specify something like this
>
> a.subarray <- a[,c(4,2),1:5,]
>
> However, if your code needs to handle an array with an arbitrary  
> number of
> dimensions then you can't hard code the number of commas while  
> writing the
> code. (Regarding motivation, the reason this came up is because I  
> wanted to
> do some toy problems involving conditioning on multiple variables in a
> multidimensional joint pmf.)
>
> I looked through commands like slice.index and so on, but they  
> seemed to
> require reshaping and big logical matrix intermediates, which were not
> memory efficient enough for me. apltake in the magic package was  
> the closest
> but it only allowed subsetting of contiguous indices from either  
> the first
> or last element in any given dimension. It was certainly possible  
> to call
> apltake multiple times to extract arbitrary subarrays via  
> combinations of
> index intervals for each dimension, and then combine them with  
> abind as
> necessary, but this did not seem elegant.
>
> Anyway, I then decided to simply generate code with parse and eval.  
> I found
> this post by Henrik Bengtsson which had the same idea:
>
> http://tolstoy.newcastle.edu.au/R/devel/05/11/3266.html
>
> I just took that code one step further and put together a utility  
> function
> that I think might be fairly useful. I haven't completely  
> robustified it
> against all kinds of pathological inputs, but if there is any  
> interest from
> the development team it would be nice to add an error-checked  
> version of
> this to R (or I guess I could keep it in a package).
>
>
> Simple usage example:
> ------
>> source("arraytake.R")
>> a <- array(1:24,c(2,3,4))
>
>> a[,1:3,c(4,2)] ##This invocation requires hard coding the number of
> dimensions of a
> , , 1
>
>      [,1] [,2] [,3]
> [1,]   19   21   23
> [2,]   20   22   24
>
> , , 2
>
>      [,1] [,2] [,3]
> [1,]    7    9   11
> [2,]    8   10   12
>
>
>> arraytake(a,list(NULL,1:3,c(4,2))) ##This invocation does not, and
> produces the same result
> , , 1
>
>      [,1] [,2] [,3]
> [1,]   19   21   23
> [2,]   20   22   24
>
> , , 2
>
>      [,1] [,2] [,3]
> [1,]    7    9   11
> [2,]    8   10   12
>
>
>
> Code below:
> --------
> arraytake <- function(x,indlist) {
>
>   #Returns subarrays of arbitrary dimensioned arrays
>   #1) Let x be a multidimensional array with an arbitrary number of
> dimensions.
>   #2) Let indlist be a list of vectors. The length of indlist is  
> the same as
> the number of
>   #dimensions in x. Each element of the indlist is a vector which  
> specifies
> which
>   #indexes to extract in the corresponding dimension. If the  
> element of the
> indlist is
>   #NULL, then we return all elements in that dimension.
>
>   #The main way this works is by programmatically building up a comma
> separated argument to "[" as a string
>   #and then simply evaluating that expression. This way one does  
> not need to
> specify the number of
>   #commas.
>
>   if(length(dim(x)) != length(indlist)) {
>     return();  #we would put some error message here in production  
> code
>   }
>
>   #First build up a string w/ indices for each dimension
>   d <- length(indlist);  #number of dims
>   indvecstr <- matrix(0,d,1);
>   for(i in 1:d) {
>     if(is.null(indlist[[i]])) {
>       indvecstr[i] <- "";
>     } else{
>       indvecstr[i] <-
> paste("c(",paste(indlist[[i]],sep="",collapse=","),")",sep="")
>     }
>   }
>
>   #Then build up the argument string to "["
>   argstr <- paste(indvecstr,sep="",collapse=",")
>   argstr <- paste("x[",argstr,"]",sep="")
>
>   #Finally, return the subsetted array
>   return(eval(parse(text=argstr)))
> }
>
>
>
>
>
>
>
> -- 
> Dr. Balaji S. Srinivasan
> Stanford University
> Depts. of Statistics and Computer Science
> 318 Campus Drive, Clark Center S251
> (650) 380-0695
> balajis at stanford.edu
> http://jinome.stanford.edu
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743



From ggrothendieck at gmail.com  Thu Oct 19 15:26:09 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 19 Oct 2006 09:26:09 -0400
Subject: [Rd] arraytake for extracting subarrays from multidimensional
	arrays
In-Reply-To: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>
References: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>
Message-ID: <971536df0610190626i7af36e19m1e8f005490a5a3e9@mail.gmail.com>

Note that it can also be done like with do.call:

a <- array(1:24, 2:4)
L <- list(TRUE, 1:3, c(4, 2))
do.call("[", c(list(a), L))

On 10/19/06, Balaji S. Srinivasan <balajis at stanford.edu> wrote:
> Hi,
>
> I recently encountered a problem with array subsetting and came up with a
> fix. Given an array of arbitrary dimensions, in which the number of
> dimensions is only known at runtime, I wanted to extract a subarray. The
> main issue with doing this is that in order to extract a subarray from an
> array of (say) 4 dimensions you usually specify something like this
>
> a.subarray <- a[,c(4,2),1:5,]
>
> However, if your code needs to handle an array with an arbitrary number of
> dimensions then you can't hard code the number of commas while writing the
> code. (Regarding motivation, the reason this came up is because I wanted to
> do some toy problems involving conditioning on multiple variables in a
> multidimensional joint pmf.)
>
> I looked through commands like slice.index and so on, but they seemed to
> require reshaping and big logical matrix intermediates, which were not
> memory efficient enough for me. apltake in the magic package was the closest
> but it only allowed subsetting of contiguous indices from either the first
> or last element in any given dimension. It was certainly possible to call
> apltake multiple times to extract arbitrary subarrays via combinations of
> index intervals for each dimension, and then combine them with abind as
> necessary, but this did not seem elegant.
>
> Anyway, I then decided to simply generate code with parse and eval. I found
> this post by Henrik Bengtsson which had the same idea:
>
> http://tolstoy.newcastle.edu.au/R/devel/05/11/3266.html
>
> I just took that code one step further and put together a utility function
> that I think might be fairly useful. I haven't completely robustified it
> against all kinds of pathological inputs, but if there is any interest from
> the development team it would be nice to add an error-checked version of
> this to R (or I guess I could keep it in a package).
>
>
> Simple usage example:
> ------
> > source("arraytake.R")
> > a <- array(1:24,c(2,3,4))
>
> > a[,1:3,c(4,2)] ##This invocation requires hard coding the number of
> dimensions of a
> , , 1
>
>     [,1] [,2] [,3]
> [1,]   19   21   23
> [2,]   20   22   24
>
> , , 2
>
>     [,1] [,2] [,3]
> [1,]    7    9   11
> [2,]    8   10   12
>
>
> > arraytake(a,list(NULL,1:3,c(4,2))) ##This invocation does not, and
> produces the same result
> , , 1
>
>     [,1] [,2] [,3]
> [1,]   19   21   23
> [2,]   20   22   24
>
> , , 2
>
>     [,1] [,2] [,3]
> [1,]    7    9   11
> [2,]    8   10   12
>
>
>
> Code below:
> --------
> arraytake <- function(x,indlist) {
>
>  #Returns subarrays of arbitrary dimensioned arrays
>  #1) Let x be a multidimensional array with an arbitrary number of
> dimensions.
>  #2) Let indlist be a list of vectors. The length of indlist is the same as
> the number of
>  #dimensions in x. Each element of the indlist is a vector which specifies
> which
>  #indexes to extract in the corresponding dimension. If the element of the
> indlist is
>  #NULL, then we return all elements in that dimension.
>
>  #The main way this works is by programmatically building up a comma
> separated argument to "[" as a string
>  #and then simply evaluating that expression. This way one does not need to
> specify the number of
>  #commas.
>
>  if(length(dim(x)) != length(indlist)) {
>    return();  #we would put some error message here in production code
>  }
>
>  #First build up a string w/ indices for each dimension
>  d <- length(indlist);  #number of dims
>  indvecstr <- matrix(0,d,1);
>  for(i in 1:d) {
>    if(is.null(indlist[[i]])) {
>      indvecstr[i] <- "";
>    } else{
>      indvecstr[i] <-
> paste("c(",paste(indlist[[i]],sep="",collapse=","),")",sep="")
>    }
>  }
>
>  #Then build up the argument string to "["
>  argstr <- paste(indvecstr,sep="",collapse=",")
>  argstr <- paste("x[",argstr,"]",sep="")
>
>  #Finally, return the subsetted array
>  return(eval(parse(text=argstr)))
> }
>
>
>
>
>
>
>
> --
> Dr. Balaji S. Srinivasan
> Stanford University
> Depts. of Statistics and Computer Science
> 318 Campus Drive, Clark Center S251
> (650) 380-0695
> balajis at stanford.edu
> http://jinome.stanford.edu
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From maechler at stat.math.ethz.ch  Thu Oct 19 15:26:55 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 19 Oct 2006 15:26:55 +0200
Subject: [Rd] latin1,utf-8...encoding and data
In-Reply-To: <45372D69.6020505@biomserv.univ-lyon1.fr>
References: <45364201.9060003@biomserv.univ-lyon1.fr>
	<Pine.LNX.4.64.0610181647410.26390@gannet.stats.ox.ac.uk>
	<45372D69.6020505@biomserv.univ-lyon1.fr>
Message-ID: <17719.32031.63875.505570@stat.math.ethz.ch>

>>>>> "St?phane" == St?phane Dray <dray at biomserv.univ-lyon1.fr>
>>>>>     on Thu, 19 Oct 2006 09:46:49 +0200 writes:

    St?phane> Thanks a lot for this clear answer. So there is no way to preserve our 
    St?phane> french cultural exception (accented characters), 

I agree that there are many French cultural exceptions ;-) 
--- and as a Swiss, I highly estimate several of them ---
however "accented" characters (with the appropriate meaning of "accented")
are not at all a French exception, rather almost a continental
European one {as long as we are staying in the "latin" alphabet
context}.  If I think of what I know of Europe, the only
country/language *not* using some version of "accented"
characters are the British and (I think) the Dutch/Flamish.
Everyone else (? probably I forgot some, and don't know about others
like gaelic,...)  has some kind of accents...

I agree with St?phane that this is unfortunate for quite a few
of us, and it came as a big surprise to me when I first heard
about this from Brian.  .. aah, life was easy when we western
chauvinists could behave as if the whole relevant part of the
world was happy with iso-latin1...

Martin 


    St?phane> if we want to be international... I have thought
    St?phane> that the inclusion of a parameter encoding in data
    St?phane> function (e.g. data(mydata,encoding="latin1"))
    St?phane> like in the function 'file' could be an way to
    St?phane> solve the problem. Apparently, the problem is much
    St?phane> more complicated...

    St?phane> Sincerely.


    St?phane> Prof Brian Ripley wrote:

    >> Only ASCII letters are portable: those accented characters do not even 
    >> exist in many of the encodings used for R, e.g. Russian and Japanese 
    >> on Windows machines.
    >> 
    >> There is no way to associate an encoding with a character string in 
    >> R.  We considered it, but it would have had severe back-compatibility 
    >> problems and little advantage (you cannot display non-ASCII character 
    >> strings portably: even if you have a Unicode encoding you still need 
    >> to select a suitable font).
    >> 
    >> 'B. Ripley' (sic)
    >> 
    >> 
    >> On Wed, 18 Oct 2006, St?phane Dray wrote:
    >> 
    >>> Hello,
    >>> I have some questions concerning encoding and package distribution. We
    >>> develop the ade4 package. For some data sets included in the package,
    >>> there are accentued character (e.g. ?,?...). The data sets have been
    >>> saved using latin1 encoding, but some of us use utf-8 and can not see
    >>> some data sets which contains accented chracters.
    >>> e.g:
    >>> 
    >>> librarry(ade4)
    >>> data(rankrock)
    >>> rankrock
    >>> 
    >>> in this case, characters are in rownames. Other data sets have such
    >>> characters in data (e.g. levels of factors..). A solution is to use
    >>> iconv... this is quite easy for us but perhaps more difficult for a user
    >>> which can have no idea of the problem. This problem is quite marginal
    >>> for the moment but some linux distribution are utf-8 by default (e.g.
    >>> ubuntu) and I suppose that the problem will be more and more present in
    >>> the future.
    >>> 
    >>> So we wonder if there is a proper way to code and save these data sets.
    >>> I have found some documents of B. Ripley and this note :
    >>> 
    >>> http://developer.r-project.org/210update.txt
    >>> 
    >>> -  Names in data objects (e.g. in .rda files) are problematic.  It
    >>> is likely that by release time these will be treated as in
    >>> Latin-1.
    >>> 
    >>> If I am correct, I did not find an answer to this problem.
    >>> 
    >>> What are the plans of R gurus on this question ?
    >>> Thanks a lot.
    >>> Sincerely.
    >>> 
    >>> Please add my adress in answers as I am not subsciber of this list.



From r.hankin at noc.soton.ac.uk  Thu Oct 19 15:40:59 2006
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Thu, 19 Oct 2006 14:40:59 +0100
Subject: [Rd] arraytake for extracting subarrays from multidimensional
	arrays
In-Reply-To: <971536df0610190626i7af36e19m1e8f005490a5a3e9@mail.gmail.com>
References: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>
	<971536df0610190626i7af36e19m1e8f005490a5a3e9@mail.gmail.com>
Message-ID: <9E6A83CF-8AD4-4538-BD61-DDFE3A4615F0@soc.soton.ac.uk>


On 19 Oct 2006, at 14:26, Gabor Grothendieck wrote:

> Note that it can also be done like with do.call:
>
> a <- array(1:24, 2:4)
> L <- list(TRUE, 1:3, c(4, 2))
> do.call("[", c(list(a), L))
>



aargggh, you beat me to it.  I didn't think  to pass TRUE to  "[" .

I'll stick it in the package with joint attribution to Gabor and Balaji
and document it with apltake() and apldrop().


best wishes all


rksh


> On 10/19/06, Balaji S. Srinivasan <balajis at stanford.edu> wrote:
>> Hi,
>>
>> I recently encountered a problem with array subsetting and came up  
>> with a
>> fix. Given an array of arbitrary dimensions, in which the number of
>> dimensions is only known at runtime, I wanted to extract a  
>> subarray. The
>> main issue with doing this is that in order to extract a subarray  
>> from an
>> array of (say) 4 dimensions you usually specify something like this
>>
>> a.subarray <- a[,c(4,2),1:5,]
>>
>> However, if your code needs to handle an array with an arbitrary  
>> number of
>> dimensions then you can't hard code the number of commas while  
>> writing the
>> code. (Regarding motivation, the reason this came up is because I  
>> wanted to
>> do some toy problems involving conditioning on multiple variables  
>> in a
>> multidimensional joint pmf.)
>>
>> I looked through commands like slice.index and so on, but they  
>> seemed to
>> require reshaping and big logical matrix intermediates, which were  
>> not
>> memory efficient enough for me. apltake in the magic package was  
>> the closest
>> but it only allowed subsetting of contiguous indices from either  
>> the first
>> or last element in any given dimension. It was certainly possible  
>> to call
>> apltake multiple times to extract arbitrary subarrays via  
>> combinations of
>> index intervals for each dimension, and then combine them with  
>> abind as
>> necessary, but this did not seem elegant.
>>
>> Anyway, I then decided to simply generate code with parse and  
>> eval. I found
>> this post by Henrik Bengtsson which had the same idea:
>>
>> http://tolstoy.newcastle.edu.au/R/devel/05/11/3266.html
>>
>> I just took that code one step further and put together a utility  
>> function
>> that I think might be fairly useful. I haven't completely  
>> robustified it
>> against all kinds of pathological inputs, but if there is any  
>> interest from
>> the development team it would be nice to add an error-checked  
>> version of
>> this to R (or I guess I could keep it in a package).
>>
>>
>> Simple usage example:
>> ------
>>> source("arraytake.R")
>>> a <- array(1:24,c(2,3,4))
>>
>>> a[,1:3,c(4,2)] ##This invocation requires hard coding the number of
>> dimensions of a
>> , , 1
>>
>>     [,1] [,2] [,3]
>> [1,]   19   21   23
>> [2,]   20   22   24
>>
>> , , 2
>>
>>     [,1] [,2] [,3]
>> [1,]    7    9   11
>> [2,]    8   10   12
>>
>>
>>> arraytake(a,list(NULL,1:3,c(4,2))) ##This invocation does not, and
>> produces the same result
>> , , 1
>>
>>     [,1] [,2] [,3]
>> [1,]   19   21   23
>> [2,]   20   22   24
>>
>> , , 2
>>
>>     [,1] [,2] [,3]
>> [1,]    7    9   11
>> [2,]    8   10   12
>>
>>
>>
>> Code below:
>> --------
>> arraytake <- function(x,indlist) {
>>
>>  #Returns subarrays of arbitrary dimensioned arrays
>>  #1) Let x be a multidimensional array with an arbitrary number of
>> dimensions.
>>  #2) Let indlist be a list of vectors. The length of indlist is  
>> the same as
>> the number of
>>  #dimensions in x. Each element of the indlist is a vector which  
>> specifies
>> which
>>  #indexes to extract in the corresponding dimension. If the  
>> element of the
>> indlist is
>>  #NULL, then we return all elements in that dimension.
>>
>>  #The main way this works is by programmatically building up a comma
>> separated argument to "[" as a string
>>  #and then simply evaluating that expression. This way one does  
>> not need to
>> specify the number of
>>  #commas.
>>
>>  if(length(dim(x)) != length(indlist)) {
>>    return();  #we would put some error message here in production  
>> code
>>  }
>>
>>  #First build up a string w/ indices for each dimension
>>  d <- length(indlist);  #number of dims
>>  indvecstr <- matrix(0,d,1);
>>  for(i in 1:d) {
>>    if(is.null(indlist[[i]])) {
>>      indvecstr[i] <- "";
>>    } else{
>>      indvecstr[i] <-
>> paste("c(",paste(indlist[[i]],sep="",collapse=","),")",sep="")
>>    }
>>  }
>>
>>  #Then build up the argument string to "["
>>  argstr <- paste(indvecstr,sep="",collapse=",")
>>  argstr <- paste("x[",argstr,"]",sep="")
>>
>>  #Finally, return the subsetted array
>>  return(eval(parse(text=argstr)))
>> }
>>
>>
>>
>>
>>
>>
>>
>> --
>> Dr. Balaji S. Srinivasan
>> Stanford University
>> Depts. of Statistics and Computer Science
>> 318 Campus Drive, Clark Center S251
>> (650) 380-0695
>> balajis at stanford.edu
>> http://jinome.stanford.edu
>>
>>        [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743



From David.Brahm at geodecapital.com  Thu Oct 19 17:18:53 2006
From: David.Brahm at geodecapital.com (Brahm, David)
Date: Thu, 19 Oct 2006 11:18:53 -0400
Subject: [Rd] Memory leak
Message-ID: <4DD6F8B8782D584FABF50BF3A32B03D806867DE6@MSGBOSCLF2WIN.DMN1.FMR.COM>

This is a followup to the R-help thread, "Error: STRING_ELT() can only
be applied to a 'character vector', not a 'builtin'".  Thanks to Prof.
Brian Ripley for suggesting the use of gctorture and valgrind.  I am
getting segmentation faults that appear to come from a memory leak.

I now have a reproducible example (below).  It requires the "g.data"
package (available on CRAN), which contains no C or Fortran code, but
does make extensive use of delayedAssign.  The script was run under
R-2.4.0 (but errors have been occuring through several upgrades) on a
Compaq DL 380-G3 running Red Hat Enterprise Linux 3.0 (i386 32-bit).
I would appreciate any help interpreting the output, or suggesting
followup investigation!

-- David Brahm (brahm at alum.mit.edu) 

****************************** Script ********************************

#!/bin/csh
tail +3 "$0" | R -d "/home/a215020/Bin/bin/valgrind --tool=memcheck
--leak-check=full" --vanilla --slave --args $*; exit
unlink("/tmp/myddp1", recursive=TRUE)
unlink("/tmp/myddp2", recursive=TRUE)
gctorture(TRUE)
require(g.data)
y <- list()
s <- list(tgt="ABCDE", acq="FGHIJ", rat=1, cash=0, stdt=20051031)
acq.dvd <- tgt.dvd <- NULL
dts <-
c(20051031,20051101,20051102,20051103,20051104,20051107,20051108,2005110
9,20051110)

g.data.attach("/tmp/myddp1")
assign("id.ric", c("ABCDE","FGHIJ", letters[1:16]), 2)
assign("id.dvd", rep(0, 18), 2)
assign("tm.time", 1:392, 2)
assign("bid", matrix(1, 392, 18, dimnames=list(NULL, id.ric)), 2)
assign("ask", matrix(2, 392, 18, dimnames=list(NULL, id.ric)), 2)
g.data.save()
detach(2)

g.data.attach("/tmp/myddp2")
assign("id.ric", letters[1:18], 2)
g.data.save()
detach(2)

for (date in dts) {
    cat(date, "\n")
    cat("debug2\n")
    ii <- (match(date, dts)-1) %% 2 + 1
    g.data.attach(paste("/tmp/myddp", ii, sep=""))
    if (!all(c(s$tgt, s$acq) %in% id.ric)) {detach(2); next}
    k <- paste(substring(date, c(5,7,3), c(6,8,4)), collapse="/")
    cat("debug3\n")
    acq.dvd[k] <- id.dvd[s$acq]
    tgt.dvd[k] <- id.dvd[s$tgt]
    qt <- tm.time >= 5 & tm.time <= 388
    tms <- tm.time[qt]
    cat("debug4\n")
    y[[k]] <- bid[qt,s$acq] * s$rat + s$cash - ask[qt,s$tgt]
    cat("debug5\n")
    detach(2)
}
cat("done\n")

****************************** Output ********************************

==11423== Memcheck, a memory error detector.
==11423== Copyright (C) 2002-2006, and GNU GPL'd, by Julian Seward et
al.
==11423== Using LibVEX rev 1658, a library for dynamic binary
translation.
==11423== Copyright (C) 2004-2006, and GNU GPL'd, by OpenWorks LLP.
==11423== Using valgrind-3.2.1, a dynamic binary instrumentation
framework.
==11423== Copyright (C) 2000-2006, and GNU GPL'd, by Julian Seward et
al.
==11423== For more details, rerun with: -v
==11423== 
Loading required package: g.data
[1] TRUE
Warning message:
'g.data.save' will create: /tmp/myddp1 
 in: g.data.attach("/tmp/myddp1") 
Warning message:
'g.data.save' will create: /tmp/myddp2 
 in: g.data.attach("/tmp/myddp2") 
20051031 
debug2
debug3
debug4
debug5
20051101 
debug2
20051102 
debug2
debug3
debug4
debug5
20051103 
debug2
20051104 
debug2
debug3
debug4
debug5
20051107 
debug2
20051108 
debug2
debug3
debug4
debug5
20051109 
debug2
20051110 
debug2
debug3
==11423== Invalid read of size 1
==11423==    at 0x80F1390: SETCAR (memory.c:2626)
==11423==    by 0x80C1617: R_HashSet (envir.c:219)
==11423==    by 0x80C2CC1: Rf_defineVar (envir.c:1261)
==11423==    by 0x814F6BE: RestoreToEnv (saveload.c:2043)
==11423==    by 0x8150465: do_loadFromConn2 (saveload.c:2358)
==11423==    by 0x80F95FF: do_internal (names.c:1097)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==  Address 0x473D163 is 3 bytes inside a block of size 168
free'd
==11423==    at 0x401B2A3: free (vg_replace_malloc.c:233)
==11423==    by 0x80ED27C: ReleaseLargeFreeVectors (memory.c:759)
==11423==    by 0x80EED30: RunGenCollect (memory.c:1351)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80F000C: Rf_allocVector (memory.c:1942)
==11423==    by 0x814F67A: RestoreToEnv (saveload.c:2038)
==11423==    by 0x8150465: do_loadFromConn2 (saveload.c:2358)
==11423==    by 0x80F95FF: do_internal (names.c:1097)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423== 
==11423== Invalid read of size 1
==11423==    at 0x80EF3B8: RunGenCollect (memory.c:1240)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80EFD25: Rf_cons (memory.c:1732)
==11423==    by 0x80CDA44: Rf_promiseArgs (eval.c:1551)
==11423==    by 0x80CB19A: Rf_eval (eval.c:454)
==11423==    by 0x80A198B: Rf_endcontext (context.c:241)
==11423==    by 0x80CB57C: Rf_applyClosure (eval.c:617)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==  Address 0x473D163 is 3 bytes inside a block of size 168
free'd
==11423==    at 0x401B2A3: free (vg_replace_malloc.c:233)
==11423==    by 0x80ED27C: ReleaseLargeFreeVectors (memory.c:759)
==11423==    by 0x80EED30: RunGenCollect (memory.c:1351)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80F000C: Rf_allocVector (memory.c:1942)
==11423==    by 0x814F67A: RestoreToEnv (saveload.c:2038)
==11423==    by 0x8150465: do_loadFromConn2 (saveload.c:2358)
==11423==    by 0x80F95FF: do_internal (names.c:1097)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423== 
==11423== Invalid write of size 1
==11423==    at 0x80EF3C2: RunGenCollect (memory.c:1240)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80EFD25: Rf_cons (memory.c:1732)
==11423==    by 0x80CDA44: Rf_promiseArgs (eval.c:1551)
==11423==    by 0x80CB19A: Rf_eval (eval.c:454)
==11423==    by 0x80A198B: Rf_endcontext (context.c:241)
==11423==    by 0x80CB57C: Rf_applyClosure (eval.c:617)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==  Address 0x473D163 is 3 bytes inside a block of size 168
free'd
==11423==    at 0x401B2A3: free (vg_replace_malloc.c:233)
==11423==    by 0x80ED27C: ReleaseLargeFreeVectors (memory.c:759)
==11423==    by 0x80EED30: RunGenCollect (memory.c:1351)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80F000C: Rf_allocVector (memory.c:1942)
==11423==    by 0x814F67A: RestoreToEnv (saveload.c:2038)
==11423==    by 0x8150465: do_loadFromConn2 (saveload.c:2358)
==11423==    by 0x80F95FF: do_internal (names.c:1097)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423== 
==11423== Invalid read of size 4
==11423==    at 0x80EF3C5: RunGenCollect (memory.c:1240)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80EFD25: Rf_cons (memory.c:1732)
==11423==    by 0x80CDA44: Rf_promiseArgs (eval.c:1551)
==11423==    by 0x80CB19A: Rf_eval (eval.c:454)
==11423==    by 0x80A198B: Rf_endcontext (context.c:241)
==11423==    by 0x80CB57C: Rf_applyClosure (eval.c:617)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==  Address 0x473D168 is 8 bytes inside a block of size 168
free'd
==11423==    at 0x401B2A3: free (vg_replace_malloc.c:233)
==11423==    by 0x80ED27C: ReleaseLargeFreeVectors (memory.c:759)
==11423==    by 0x80EED30: RunGenCollect (memory.c:1351)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80F000C: Rf_allocVector (memory.c:1942)
==11423==    by 0x814F67A: RestoreToEnv (saveload.c:2038)
==11423==    by 0x8150465: do_loadFromConn2 (saveload.c:2358)
==11423==    by 0x80F95FF: do_internal (names.c:1097)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423== 
==11423== Invalid read of size 4
==11423==    at 0x80EF3C8: RunGenCollect (memory.c:1240)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80EFD25: Rf_cons (memory.c:1732)
==11423==    by 0x80CDA44: Rf_promiseArgs (eval.c:1551)
==11423==    by 0x80CB19A: Rf_eval (eval.c:454)
==11423==    by 0x80A198B: Rf_endcontext (context.c:241)
==11423==    by 0x80CB57C: Rf_applyClosure (eval.c:617)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423==    by 0x80CB1B7: Rf_eval (eval.c:455)
==11423==  Address 0x473D16C is 12 bytes inside a block of size 168
free'd
==11423==    at 0x401B2A3: free (vg_replace_malloc.c:233)
==11423==    by 0x80ED27C: ReleaseLargeFreeVectors (memory.c:759)
==11423==    by 0x80EED30: RunGenCollect (memory.c:1351)
==11423==    by 0x80F0635: R_gc_internal (memory.c:2141)
==11423==    by 0x80F000C: Rf_allocVector (memory.c:1942)
==11423==    by 0x814F67A: RestoreToEnv (saveload.c:2038)
==11423==    by 0x8150465: do_loadFromConn2 (saveload.c:2358)
==11423==    by 0x80F95FF: do_internal (names.c:1097)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CCAC1: do_begin (eval.c:1107)
==11423==    by 0x80CB320: Rf_eval (eval.c:431)
==11423==    by 0x80CB5E0: Rf_applyClosure (eval.c:614)
==11423== 

<********** (lots more of the same deleted - DB) ************>

==11423== More than 100 errors detected.  Subsequent errors
==11423== will still be recorded, but in less detail than before.
debug4
debug5
done
==11423== 
==11423== ERROR SUMMARY: 3173 errors from 100 contexts (suppressed: 43
from 2)
==11423== malloc/free: in use at exit: 12,199,229 bytes in 5,842 blocks.
==11423== malloc/free: 83,926 allocs, 78,084 frees, 75,199,703 bytes
allocated.
==11423== For counts of detected errors, rerun with: -v
==11423== searching for pointers to 5,842 not-freed blocks.
==11423== checked 12,108,392 bytes.
==11423== 
==11423== 
==11423== 35 bytes in 1 blocks are definitely lost in loss record 9 of
34
==11423==    at 0x401A6EE: malloc (vg_replace_malloc.c:149)
==11423==    by 0x816E183: Rf_InitTempDir (sysutils.c:589)
==11423==    by 0x80EAF47: setup_Rmainloop (main.c:724)
==11423==    by 0x80EB52A: Rf_mainloop (main.c:933)
==11423==    by 0x8068381: main (Rmain.c:33)
==11423== 
==11423== 
==11423== 468 bytes in 22 blocks are definitely lost in loss record 16
of 34
==11423==    at 0x401A6EE: malloc (vg_replace_malloc.c:149)
==11423==    by 0x806B7C8: Putenv (Renviron.c:130)
==11423==    by 0x806B9A5: process_Renviron (Renviron.c:192)
==11423==    by 0x806BAB5: process_system_Renviron (Renviron.c:225)
==11423==    by 0x8174F1A: Rf_initialize_R (system.c:223)
==11423==    by 0x806837C: main (Rmain.c:32)
==11423== 
==11423== LEAK SUMMARY:
==11423==    definitely lost: 503 bytes in 23 blocks.
==11423==      possibly lost: 0 bytes in 0 blocks.
==11423==    still reachable: 12,198,726 bytes in 5,819 blocks.
==11423==         suppressed: 0 bytes in 0 blocks.
==11423== Reachable blocks (those to which a pointer was found) are not
shown.
==11423== To see them, rerun with: --show-reachable=yes



From ross at biostat.ucsf.edu  Thu Oct 19 19:45:26 2006
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Thu, 19 Oct 2006 10:45:26 -0700
Subject: [Rd] \link to another package
Message-ID: <1161279926.18091.13.camel@iron.psg.net>

In the documentation for my package I would like to reference the Rmpi
documentation.  I started with \link{Rmpi}, which caused R CMD check to
complain that it could not resolve the link.  Since Rmpi wasn't loaded,
this isn't surprising.

Ideally the user would see Rmpi, but the link would go to Rmpi's
Rmpi-pkg.  It's not clear to me if this is possible.  I've combined two
documented features to say \link[Rmpi=Rmpi-pkg]{Rmpi}.  Is that OK?

According to the 2.3.1 documentation
\link[Rmpi]{Rmpi} gets me the Rmpi link in the Rmpi package and
\line[=Rmpi-pkg]{Rmpi} gets me Rmpi-pkg.
There is no mention of combining these two syntaxes.

There is also a discussion of \link[Rmpi:bar]{Rmpi}, but that appears to
refer to a *file* bar.html rather than an internal value (i.e.,
\alias{bar}).

Not only R CMD check but some users of the package may not have Rmpi
loaded, so I'd like the documentation to work gracefully in that
situation.  "Gracefully" means that if Rmpi is not loaded the help still
shows; it does not mean that clicking on the link magically produces the
Rmpi documentation.

-- 
Ross Boylan                                      wk:  (415) 514-8146
185 Berry St #5700                               ross at biostat.ucsf.edu
Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
University of California, San Francisco
San Francisco, CA 94107-1739                     hm:  (415) 550-1062



From fparlamis at mac.com  Thu Oct 19 20:52:42 2006
From: fparlamis at mac.com (Parlamis Franklin)
Date: Thu, 19 Oct 2006 08:52:42 -1000
Subject: [Rd] default arguments in generics and methods
Message-ID: <0D795BA2-D5C6-4A6F-997E-C763905C677C@mac.com>

i believe the following is true but would appreciate confirmation  
that it is intended behavior and will continue:

if a default argument is employed in the definition of a generic  
function, and the generic is called with the argument in question  
(call it 'ARG') missing, then the method for signature (..., ARG =  
"missing", ...) will be called by 'standardGeneric' whether or not  
ARG is evaluated in the body of the generic prior to the call to  
'standardGeneric';  however, the value assigned to ARG in the method  
call will depend on whether ARG was evaluated in the body of the  
generic prior to the call to 'standardGeneric' (with the default  
value assigned in the case of prior evaluation and no value assigned  
in the case of no prior evaluation).  furthermore, if ARG is  
explicitly assigned to in the body of the generic prior to the call  
to 'standardGeneric', then the method for signature (..., ARG = class 
(ARG), ...) will be called, with the assigned value of ARG passed to  
the call.

this behavior is exhibited by the code below:

__

setGeneric("foo", function(x = 1) standardGeneric("foo"),  
useAsDefault = FALSE)
setMethod("foo", signature(x = "missing"), function(x = 3) x)

setGeneric("foo2", function(x = 1) {x; standardGeneric("foo2")},  
useAsDefault = FALSE)
setMethod("foo2", signature(x = "missing"), function(x = 3) x)

setGeneric("foo3", function(x = 1) {x<-2; standardGeneric("foo3")},  
useAsDefault = FALSE)
setMethod("foo3", signature(x = "missing"), function(x = 3) x)
setMethod("foo3", signature(x = "numeric"), function(x = 3) x^2)

foo()		# returns 3
foo2()		# returns 1
foo3()		# returns 4

___

franklin parlamis



From kwright68 at gmail.com  Thu Oct 19 22:14:27 2006
From: kwright68 at gmail.com (Kevin Wright)
Date: Thu, 19 Oct 2006 15:14:27 -0500
Subject: [Rd] Bug in Acrobat Reader 7 (or R?) with translucent text
Message-ID: <adf71a630610191314q5c40042dw9528a48f9ef55ce7@mail.gmail.com>

My setup:  R 2.4.0, Windows 2000, Acrobat Reader 7.

When I create a .pdf with translucent colors, the translucency works
correctly for points, but not for text.  Below is some R code that
creates a .pdf with this phenomenon.

I was going to report this as a bug in R, but then I tried to view the
pdf with a couple of other viewers and found that at least one of the
viewers correctly displayed the file (with translucent text), so maybe
it is a bug with Acrobat Reader.  It might be worth checking to see if
colors for "text" are handled any differently than colors for "points"
that might cause this problem.

Best,

Kevin Wright


black <- rgb(0,0,0,.75)
blue <- rgb(0, .2, 1, .75)
red <- rgb(1,0,0,.75)
pdf("pdfcols.pdf", version="1.4")
set.seed(50)
plot(.5,.5,type="n",xlim=c(0,1),ylim=c(0,1))
points(runif(200),runif(200), col=black)
points(runif(200),runif(200), col=blue)
points(runif(200),runif(200), col=red)
text(.1, .1, "This is red", col=red)
text(.1, .1, "Also red", col=red)
text(.2, .2, "This is blue", col=blue)
text(.2, .2, "Also blue", col=blue)
text(.3, .3, "This is black", col=black)
text(.3, .3, "Also black", col=black)
points(runif(200),runif(200), col=black)
points(runif(200),runif(200), col=blue)
points(runif(200),runif(200), col=red)
dev.off()



From MSchwartz at mn.rr.com  Thu Oct 19 23:03:34 2006
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Thu, 19 Oct 2006 16:03:34 -0500
Subject: [Rd] Bug in Acrobat Reader 7 (or R?) with translucent text
In-Reply-To: <adf71a630610191314q5c40042dw9528a48f9ef55ce7@mail.gmail.com>
References: <adf71a630610191314q5c40042dw9528a48f9ef55ce7@mail.gmail.com>
Message-ID: <1161291814.13063.61.camel@localhost.localdomain>

On Thu, 2006-10-19 at 15:14 -0500, Kevin Wright wrote:
> My setup:  R 2.4.0, Windows 2000, Acrobat Reader 7.
> 
> When I create a .pdf with translucent colors, the translucency works
> correctly for points, but not for text.  Below is some R code that
> creates a .pdf with this phenomenon.
> 
> I was going to report this as a bug in R, but then I tried to view the
> pdf with a couple of other viewers and found that at least one of the
> viewers correctly displayed the file (with translucent text), so maybe
> it is a bug with Acrobat Reader.  It might be worth checking to see if
> colors for "text" are handled any differently than colors for "points"
> that might cause this problem.
> 
> Best,
> 
> Kevin Wright
> 
> 
> black <- rgb(0,0,0,.75)
> blue <- rgb(0, .2, 1, .75)
> red <- rgb(1,0,0,.75)
> pdf("pdfcols.pdf", version="1.4")
> set.seed(50)
> plot(.5,.5,type="n",xlim=c(0,1),ylim=c(0,1))
> points(runif(200),runif(200), col=black)
> points(runif(200),runif(200), col=blue)
> points(runif(200),runif(200), col=red)
> text(.1, .1, "This is red", col=red)
> text(.1, .1, "Also red", col=red)
> text(.2, .2, "This is blue", col=blue)
> text(.2, .2, "Also blue", col=blue)
> text(.3, .3, "This is black", col=black)
> text(.3, .3, "Also black", col=black)
> points(runif(200),runif(200), col=black)
> points(runif(200),runif(200), col=blue)
> points(runif(200),runif(200), col=red)
> dev.off()

I can confirm problems on FC5 using Reader 7.0.8. The text appears
opaque.

An easier to see plot example might be:

black <- rgb(0, 0, 0, .5)
blue <- rgb(0, .2, 1, .5)
red <- rgb(1, 0, 0, .5)
pdf("TL.pdf", version = "1.4")
plot(1, 1, type = "n")
text(1.01, 1, "XXXXXXX", cex = 5, col = black)
text(1.02, 1, "XXXXXXX", cex = 5, col = red)
text(1.03, 1, "XXXXXXX", cex = 5, col = blue)
dev.off()

Using the 'Document Viewer' application on FC5, which is Evince, and
xpdf, the text is clearly translucent.

It's a bug in Adobe, unless there is a setting in Reader that impacts
this. Reviewing and trying some (ie. CoolType, Smoothing, etc.), there
is nothing immediately apparent that effects the display.

PDF File attached.

HTH,

Marc Schwartz

-------------- next part --------------
A non-text attachment was scrubbed...
Name: TL.pdf
Type: application/pdf
Size: 2934 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20061019/0995fcbe/attachment-0004.pdf 

From jgvcqa at rit.edu  Thu Oct 19 23:34:34 2006
From: jgvcqa at rit.edu (jgvcqa at rit.edu)
Date: Thu, 19 Oct 2006 23:34:34 +0200 (CEST)
Subject: [Rd] bug in rect (PR#9307)
Message-ID: <20061019213434.A40F324796@slim.kubism.ku.dk>

Full_Name: Joe Voelkel
Version: 2.4.0
OS: Windows XP
Submission from: (NULL) (129.21.11.37)


Using "border=NA" in the call to rect generates an error. But the help file says
border=NA is acceptable. 

(The problem is that border=NA evaluates to TRUE for "is.logical(border)" inside
the function. Using rect with border=FALSE works fine)



From whit.armstrong at hcmny.com  Fri Oct 20 00:50:56 2006
From: whit.armstrong at hcmny.com (Armstrong, Whit)
Date: Thu, 19 Oct 2006 18:50:56 -0400
Subject: [Rd] lapack tests fail  -- is this something to worry about?
Message-ID: <E58BE6136618CF4C964F6EC7773AE569C9A565@ex4.nyc.hcmny.com>

I see the comment here about some 64bit combinations failing.

Well, my configuration fails.  Is this really something to worry about?

for R-patched:
fi1->cat SVN-REVISION 
Revision: 39576
Last Changed Date: 2006-10-03
fi1->


> ## failed for some 64bit-Lapack-gcc combinations:
> sm <- cbind(1, 3:1, 1:3)
> eigenok(sm, eigen(sm))
Error: abs(A %*% V - V %*% diag(lam)) < Eps is not all TRUE
> eigenok(sm, eigen(sm, sym=FALSE))
Error: abs(A %*% V - V %*% diag(lam)) < Eps is not all TRUE
> 


I'm not using a nonstandard blas or lapack, just the ones included in R.


Here is my system information:

fi1->gcc --version
gcc (GCC) 3.2.3 20030502 (Red Hat Linux 3.2.3-47)
Copyright (C) 2002 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is
NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE.

fi1->uname -a
Linux fi1.nyc.office.hcmny.com 2.4.21-32.ELsmp #1 SMP Fri Apr 15
21:03:28 EDT 2005 x86_64 x86_64 x86_64 GNU/Linux
fi1->


This is RHEL v3.  I know gcc 3.2.3 is old, but I don't have root, and
our admins are not crazy about changing 1 system to accommodate 1 user,
so I'm happy to ignore the test failure if it's not something to worry
about.  I'm not using lapack routines in my code, but I don't know to
what extent R makes use of lapack internally.

Can anyone give me the skinny on whether this test failure really
matters?

Thanks,
Whit





This e-mail message is intended only for the named recipient(s) above. It may contain confidential information. If you are not the intended recipient you are hereby notified that any dissemination, distribution or copying of this e-mail and any attachment(s) is strictly prohibited. If you have received this e-mail in error, please immediately notify the sender by replying to this e-mail and delete the message and any attachment(s) from your system. Thank you.


From balajis at stanford.edu  Fri Oct 20 00:51:55 2006
From: balajis at stanford.edu (Balaji S. Srinivasan)
Date: Thu, 19 Oct 2006 15:51:55 -0700
Subject: [Rd] arraytake for extracting subarrays from multidimensional
	arrays
In-Reply-To: <9E6A83CF-8AD4-4538-BD61-DDFE3A4615F0@soc.soton.ac.uk>
References: <39422c340610190605v266f31eet28252a4f09b0dabe@mail.gmail.com>
	<971536df0610190626i7af36e19m1e8f005490a5a3e9@mail.gmail.com>
	<9E6A83CF-8AD4-4538-BD61-DDFE3A4615F0@soc.soton.ac.uk>
Message-ID: <39422c340610191551r11e56509r5a3a7baf208b42a9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061019/171d0e07/attachment-0003.pl 

From murdoch at stats.uwo.ca  Fri Oct 20 01:00:32 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 19 Oct 2006 19:00:32 -0400
Subject: [Rd] bug in rect (PR#9307)
In-Reply-To: <20061019213434.A40F324796@slim.kubism.ku.dk>
References: <20061019213434.A40F324796@slim.kubism.ku.dk>
Message-ID: <45380390.5010209@stats.uwo.ca>

On 10/19/2006 5:34 PM, jgvcqa at rit.edu wrote:
> Full_Name: Joe Voelkel
> Version: 2.4.0
> OS: Windows XP
> Submission from: (NULL) (129.21.11.37)
> 
> 
> Using "border=NA" in the call to rect generates an error. But the help file says
> border=NA is acceptable. 
> 
> (The problem is that border=NA evaluates to TRUE for "is.logical(border)" inside
> the function. Using rect with border=FALSE works fine)

I don't see this.  Could you post some code to illustrate?

Duncan Murdoch



From smckinney at bccrc.ca  Fri Oct 20 01:06:56 2006
From: smckinney at bccrc.ca (Steven McKinney)
Date: Thu, 19 Oct 2006 16:06:56 -0700
Subject: [Rd] Bug in Acrobat Reader 7 (or R?) with translucent text
References: <adf71a630610191314q5c40042dw9528a48f9ef55ce7@mail.gmail.com>
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0235F94B@crcmail1.BCCRC.CA>

Hi Kevin,

On my Mac, (PowerPC OS X 10.4.8)
I see the same plot in Adobe reader and
in the Mac preview app.  

Text is transluscent when overlaid by a plot icon. 
 
Text is not transluscent when overlaid by other text.  (Is
this expected?)

Plot icons are transluscent when overlaid by 
other plot icons.

Adobe is buggy!  (I have trouble with Adobe rendering
a pdf containing four scatterplots with 380000 
data points each, though the Mac preview.app 
can render them properly.)

Good luck filing a bug report with Adobe :(


Adobe:
Version 7.0.8 5/16/2006

R:
> sessionInfo()
R version 2.4.0 (2006-10-03) 
powerpc-apple-darwin8.7.0 

locale:
en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8



Steven McKinney

Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre

email: smckinney at bccrc.ca

tel: 604-675-8000 x7561

BCCRC
Molecular Oncology
675 West 10th Ave, Floor 4
Vancouver B.C. 
V5Z 1L3
Canada




-----Original Message-----
From: r-devel-bounces at r-project.org on behalf of Kevin Wright
Sent: Thu 10/19/2006 1:14 PM
To: r-devel at stat.math.ethz.ch
Subject: [Rd] Bug in Acrobat Reader 7 (or R?) with translucent text
 
My setup:  R 2.4.0, Windows 2000, Acrobat Reader 7.

When I create a .pdf with translucent colors, the translucency works
correctly for points, but not for text.  Below is some R code that
creates a .pdf with this phenomenon.

I was going to report this as a bug in R, but then I tried to view the
pdf with a couple of other viewers and found that at least one of the
viewers correctly displayed the file (with translucent text), so maybe
it is a bug with Acrobat Reader.  It might be worth checking to see if
colors for "text" are handled any differently than colors for "points"
that might cause this problem.

Best,

Kevin Wright


black <- rgb(0,0,0,.75)
blue <- rgb(0, .2, 1, .75)
red <- rgb(1,0,0,.75)
pdf("pdfcols.pdf", version="1.4")
set.seed(50)
plot(.5,.5,type="n",xlim=c(0,1),ylim=c(0,1))
points(runif(200),runif(200), col=black)
points(runif(200),runif(200), col=blue)
points(runif(200),runif(200), col=red)
text(.1, .1, "This is red", col=red)
text(.1, .1, "Also red", col=red)
text(.2, .2, "This is blue", col=blue)
text(.2, .2, "Also blue", col=blue)
text(.3, .3, "This is black", col=black)
text(.3, .3, "Also black", col=black)
points(runif(200),runif(200), col=black)
points(runif(200),runif(200), col=blue)
points(runif(200),runif(200), col=red)
dev.off()

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel



From p.dalgaard at biostat.ku.dk  Fri Oct 20 01:22:24 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 20 Oct 2006 01:22:24 +0200
Subject: [Rd] bug in rect (PR#9307)
In-Reply-To: <45380390.5010209@stats.uwo.ca>
References: <20061019213434.A40F324796@slim.kubism.ku.dk>
	<45380390.5010209@stats.uwo.ca>
Message-ID: <x2y7rbki1b.fsf@turmalin.kubism.ku.dk>

Duncan Murdoch <murdoch at stats.uwo.ca> writes:

> On 10/19/2006 5:34 PM, jgvcqa at rit.edu wrote:
> > Full_Name: Joe Voelkel
> > Version: 2.4.0
> > OS: Windows XP
> > Submission from: (NULL) (129.21.11.37)
> > 
> > 
> > Using "border=NA" in the call to rect generates an error. But the help file says
> > border=NA is acceptable. 
> > 
> > (The problem is that border=NA evaluates to TRUE for "is.logical(border)" inside
> > the function. Using rect with border=FALSE works fine)
> 
> I don't see this.  Could you post some code to illustrate?

He should, but it is actually plain to see in the code:

    if (!is.null(density) && !is.null(angle)) {
        if (is.logical(border)) {
            if (border)
                border <- col
            else border <- NA
        }

so it requires non-default density and angle to bite. The code should
probably read 

...
   if(!is.na(border) && is.logical(border)) 
... 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From murdoch at stats.uwo.ca  Fri Oct 20 01:41:50 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 19 Oct 2006 19:41:50 -0400
Subject: [Rd] bug in rect (PR#9307)
In-Reply-To: <x2y7rbki1b.fsf@turmalin.kubism.ku.dk>
References: <20061019213434.A40F324796@slim.kubism.ku.dk>	<45380390.5010209@stats.uwo.ca>
	<x2y7rbki1b.fsf@turmalin.kubism.ku.dk>
Message-ID: <45380D3E.8010005@stats.uwo.ca>

On 10/19/2006 7:22 PM, Peter Dalgaard wrote:
> Duncan Murdoch <murdoch at stats.uwo.ca> writes:
> 
>> On 10/19/2006 5:34 PM, jgvcqa at rit.edu wrote:
>>> Full_Name: Joe Voelkel
>>> Version: 2.4.0
>>> OS: Windows XP
>>> Submission from: (NULL) (129.21.11.37)
>>>
>>>
>>> Using "border=NA" in the call to rect generates an error. But the help file says
>>> border=NA is acceptable. 
>>>
>>> (The problem is that border=NA evaluates to TRUE for "is.logical(border)" inside
>>> the function. Using rect with border=FALSE works fine)
>> I don't see this.  Could you post some code to illustrate?
> 
> He should, but it is actually plain to see in the code:
> 
>     if (!is.null(density) && !is.null(angle)) {
>         if (is.logical(border)) {
>             if (border)
>                 border <- col
>             else border <- NA
>         }
> 
> so it requires non-default density and angle to bite. The code should
> probably read 
> 
> ...
>    if(!is.na(border) && is.logical(border)) 
> ... 
> 

Right.  Looks like there might be a similar bug lurking in lpolygon and 
lrect in lattice, so I'm cc'ing Deepayan.

Are you fixing rect?

Duncan Murdoch



From jgvcqa at rit.edu  Fri Oct 20 02:37:45 2006
From: jgvcqa at rit.edu (Joseph Voelkel)
Date: Thu, 19 Oct 2006 20:37:45 -0400
Subject: [Rd] bug in rect (PR#9307)
In-Reply-To: <45380D3E.8010005@stats.uwo.ca>
Message-ID: <59909136C2A872409F02F3B6E334FDA20223686D@svits11.main.ad.rit.edu>

Thanks. I'll just get out of your way at this point.

Joe

 

-----Original Message-----
From: Duncan Murdoch [mailto:murdoch at stats.uwo.ca] 
Sent: Thursday, October 19, 2006 7:42 PM
To: Peter Dalgaard
Cc: R-bugs at biostat.ku.dk; r-devel at stat.math.ethz.ch; Joseph Voelkel;
Deepayan Sarkar
Subject: Re: [Rd] bug in rect (PR#9307)

On 10/19/2006 7:22 PM, Peter Dalgaard wrote:
> Duncan Murdoch <murdoch at stats.uwo.ca> writes:
> 
>> On 10/19/2006 5:34 PM, jgvcqa at rit.edu wrote:
>>> Full_Name: Joe Voelkel
>>> Version: 2.4.0
>>> OS: Windows XP
>>> Submission from: (NULL) (129.21.11.37)
>>>
>>>
>>> Using "border=NA" in the call to rect generates an error. But the
help file says
>>> border=NA is acceptable. 
>>>
>>> (The problem is that border=NA evaluates to TRUE for
"is.logical(border)" inside
>>> the function. Using rect with border=FALSE works fine)
>> I don't see this.  Could you post some code to illustrate?
> 
> He should, but it is actually plain to see in the code:
> 
>     if (!is.null(density) && !is.null(angle)) {
>         if (is.logical(border)) {
>             if (border)
>                 border <- col
>             else border <- NA
>         }
> 
> so it requires non-default density and angle to bite. The code should
> probably read 
> 
> ...
>    if(!is.na(border) && is.logical(border)) 
> ... 
> 

Right.  Looks like there might be a similar bug lurking in lpolygon and 
lrect in lattice, so I'm cc'ing Deepayan.

Are you fixing rect?

Duncan Murdoch



From juri.solodenko at bayertechnology.com  Fri Oct 20 10:14:56 2006
From: juri.solodenko at bayertechnology.com (juri.solodenko at bayertechnology.com)
Date: Fri, 20 Oct 2006 10:14:56 +0200
Subject: [Rd] R.lib for MS Visual C++
Message-ID: <OF172FAACE.C4F3FFCA-ONC125720D.002B0C64-C125720D.002D505B@bayer.de>


Hello,

I'm trying to compile a library in MS Visual C++ using R.dll.
For that, I need R.lib for linking.
Where can I get it?

"Readme.packages" for R says: "First build the import library R.lib by lib
/def:R.exp /out:Rdll.lib"
But for this, I need R.exp, that is also not provided with R installation
(Lib.exe output: LIB : fatal error LNK1104: cannot open file "R.exp")

So how can I get R.lib?

Thanks for your help.

Best Regards,
Juri



From ripley at stats.ox.ac.uk  Fri Oct 20 10:34:31 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 20 Oct 2006 09:34:31 +0100 (BST)
Subject: [Rd] R.lib for MS Visual C++
In-Reply-To: <OF172FAACE.C4F3FFCA-ONC125720D.002B0C64-C125720D.002D505B@bayer.de>
References: <OF172FAACE.C4F3FFCA-ONC125720D.002B0C64-C125720D.002D505B@bayer.de>
Message-ID: <Pine.LNX.4.64.0610200930280.5813@gannet.stats.ox.ac.uk>

On Fri, 20 Oct 2006, juri.solodenko at bayertechnology.com wrote:

>
> Hello,
>
> I'm trying to compile a library in MS Visual C++ using R.dll.
> For that, I need R.lib for linking.
> Where can I get it?
>
> "Readme.packages" for R says: "First build the import library R.lib by lib
> /def:R.exp /out:Rdll.lib"
> But for this, I need R.exp, that is also not provided with R installation
> (Lib.exe output: LIB : fatal error LNK1104: cannot open file "R.exp")
>
> So how can I get R.lib?

It actually says:

   You may if you prefer use Visual C++ to make the DLLs (unless they use
   Fortran source!). First build the import library Rdll.lib by

         make R.exp
         lib /def:R.exp /out:Rdll.lib

in current versions of R.  (Please note what the posting guide says about 
updating *before* posting.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From fparlamis at mac.com  Fri Oct 20 11:24:42 2006
From: fparlamis at mac.com (Parlamis Franklin)
Date: Thu, 19 Oct 2006 23:24:42 -1000
Subject: [Rd] understanding virtual classes and extensions thereof
Message-ID: <060DBDD8-C750-4BCE-BB58-FF71D1BDFA28@mac.com>

I am having some trouble creating a hierarchy of virtual classes  
(akin to the class structure in the 'Matrix' package).  I think they  
arise from my not understanding the best way to specify virtual  
subclasses of a virtual class.  please see questions below code.

setClass("mom")

setClass("kid1", representation("mom", "VIRTUAL"))
setClass("kid2", representation("VIRTUAL"), contains = "mom")
setClass("kid3"); setIs("kid3", "mom")

(i) Are 'kid1' and 'kid2' equivalent?  I.e., is there any difference  
between including a superclass as an unnamed argument in the  
'representation' call and including it in the 'contains' argument?   
If not, why does the 'contains' argument exist?

(ii) What is the difference between 'kid1' and 'kid2', on the one  
hand, and 'kid3', on the other hand?  I see that 'kid1' and 'kid2'  
have prototypes of class 'S4', while 'kid3' has a prototype of class  
"NULL".  But I don't really understand the implications of that.  I  
am using virtual classes mostly to economize on method writing.  Will  
it matter on any level whether my virtual classes have NULL or S4  
prototypes?

On a related note, the behavior exhibited below also seems infelicitous

setClass("kid4", contains = "mom")
new("kid4")  # error in the show method

franklin parlamis



From juri.solodenko at bayertechnology.com  Fri Oct 20 11:34:01 2006
From: juri.solodenko at bayertechnology.com (juri.solodenko at bayertechnology.com)
Date: Fri, 20 Oct 2006 11:34:01 +0200
Subject: [Rd] Antwort: Re:  R.lib for MS Visual C++
In-Reply-To: <Pine.LNX.4.64.0610200930280.5813@gannet.stats.ox.ac.uk>
Message-ID: <OF9970FB93.04212555-ONC125720D.00324430-C125720D.00348DD7@bayer.de>

Dear Prof. Ripley,

thanks for your prompt answer.
But under MS Visual Studio there is no make utility (nmake is used to link C++
projects from makefiles).
So is it possible to create R.lib with MS Visual Studio or should I install some
other compiler for that (gnuwin?)?

Best Regards,
Juri



                                                                                
             Prof Brian Ripley                                                  
             <ripley at stats.ox.ac                                                
             .uk>                                                            An 
                                          juri.solodenko at bayertechnology.com    
             20.10.2006 10:34                                             Kopie 
                                          r-devel at r-project.org                 
                                                                          Thema 
                                          Re: [Rd] R.lib for MS Visual C++      
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                




On Fri, 20 Oct 2006, juri.solodenko at bayertechnology.com wrote:

>
> Hello,
>
> I'm trying to compile a library in MS Visual C++ using R.dll.
> For that, I need R.lib for linking.
> Where can I get it?
>
> "Readme.packages" for R says: "First build the import library R.lib by lib
> /def:R.exp /out:Rdll.lib"
> But for this, I need R.exp, that is also not provided with R installation
> (Lib.exe output: LIB : fatal error LNK1104: cannot open file "R.exp")
>
> So how can I get R.lib?

It actually says:

   You may if you prefer use Visual C++ to make the DLLs (unless they use
   Fortran source!). First build the import library Rdll.lib by

         make R.exp
         lib /def:R.exp /out:Rdll.lib

in current versions of R.  (Please note what the posting guide says about
updating *before* posting.)

--
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ripley at stats.ox.ac.uk  Fri Oct 20 11:57:30 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 20 Oct 2006 10:57:30 +0100 (BST)
Subject: [Rd] Antwort: Re:  R.lib for MS Visual C++
In-Reply-To: <OF9970FB93.04212555-ONC125720D.00324430-C125720D.00348DD7@bayer.de>
References: <OF9970FB93.04212555-ONC125720D.00324430-C125720D.00348DD7@bayer.de>
Message-ID: <Pine.LNX.4.64.0610201057130.11642@gannet.stats.ox.ac.uk>

On Fri, 20 Oct 2006, juri.solodenko at bayertechnology.com wrote:

> Dear Prof. Ripley,
>
> thanks for your prompt answer.
> But under MS Visual Studio there is no make utility (nmake is used to link C++
> projects from makefiles).
> So is it possible to create R.lib with MS Visual Studio or should I install some
> other compiler for that (gnuwin?)?

You should use the build environment described in that file, which *does*
provide 'make'.


>
> Best Regards,
> Juri
>
>
>
>
>             Prof Brian Ripley
>             <ripley at stats.ox.ac
>             .uk>                                                            An
>                                          juri.solodenko at bayertechnology.com
>             20.10.2006 10:34                                             Kopie
>                                          r-devel at r-project.org
>                                                                          Thema
>                                          Re: [Rd] R.lib for MS Visual C++
>
>
>
>
>
>
>
>
>
>
> On Fri, 20 Oct 2006, juri.solodenko at bayertechnology.com wrote:
>
>>
>> Hello,
>>
>> I'm trying to compile a library in MS Visual C++ using R.dll.
>> For that, I need R.lib for linking.
>> Where can I get it?
>>
>> "Readme.packages" for R says: "First build the import library R.lib by lib
>> /def:R.exp /out:Rdll.lib"
>> But for this, I need R.exp, that is also not provided with R installation
>> (Lib.exe output: LIB : fatal error LNK1104: cannot open file "R.exp")
>>
>> So how can I get R.lib?
>
> It actually says:
>
>   You may if you prefer use Visual C++ to make the DLLs (unless they use
>   Fortran source!). First build the import library Rdll.lib by
>
>         make R.exp
>         lib /def:R.exp /out:Rdll.lib
>
> in current versions of R.  (Please note what the posting guide says about
> updating *before* posting.)
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ripley at stats.ox.ac.uk  Fri Oct 20 13:57:26 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 20 Oct 2006 12:57:26 +0100 (BST)
Subject: [Rd] lapack tests fail  -- is this something to worry about?
In-Reply-To: <E58BE6136618CF4C964F6EC7773AE569C9A565@ex4.nyc.hcmny.com>
References: <E58BE6136618CF4C964F6EC7773AE569C9A565@ex4.nyc.hcmny.com>
Message-ID: <Pine.LNX.4.64.0610201251270.22501@gannet.stats.ox.ac.uk>

I think it is just that you should bear in mind that your system is less 
accurate than a more modern one (and lots of compiler bugs have been fixed 
since gcc 3.2.3).

[I am surprised your sysadmins are happy running an OS that is lacking so 
many of the security features of current Linuxen.  Ours are not!]


On Thu, 19 Oct 2006, Armstrong, Whit wrote:

> I see the comment here about some 64bit combinations failing.
>
> Well, my configuration fails.  Is this really something to worry about?
>
> for R-patched:
> fi1->cat SVN-REVISION
> Revision: 39576
> Last Changed Date: 2006-10-03
> fi1->
>
>
>> ## failed for some 64bit-Lapack-gcc combinations:
>> sm <- cbind(1, 3:1, 1:3)
>> eigenok(sm, eigen(sm))
> Error: abs(A %*% V - V %*% diag(lam)) < Eps is not all TRUE
>> eigenok(sm, eigen(sm, sym=FALSE))
> Error: abs(A %*% V - V %*% diag(lam)) < Eps is not all TRUE
>>
>
>
> I'm not using a nonstandard blas or lapack, just the ones included in R.
>
>
> Here is my system information:
>
> fi1->gcc --version
> gcc (GCC) 3.2.3 20030502 (Red Hat Linux 3.2.3-47)
> Copyright (C) 2002 Free Software Foundation, Inc.
> This is free software; see the source for copying conditions.  There is
> NO
> warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR
> PURPOSE.
>
> fi1->uname -a
> Linux fi1.nyc.office.hcmny.com 2.4.21-32.ELsmp #1 SMP Fri Apr 15
> 21:03:28 EDT 2005 x86_64 x86_64 x86_64 GNU/Linux
> fi1->
>
>
> This is RHEL v3.  I know gcc 3.2.3 is old, but I don't have root, and
> our admins are not crazy about changing 1 system to accommodate 1 user,
> so I'm happy to ignore the test failure if it's not something to worry
> about.  I'm not using lapack routines in my code, but I don't know to
> what extent R makes use of lapack internally.
>
> Can anyone give me the skinny on whether this test failure really
> matters?
>
> Thanks,
> Whit
>
>
>
>
>
> This e-mail message is intended only for the named recipient(s) above. It may contain confidential information. If you are not the intended recipient you are hereby notified that any dissemination, distribution or copying of this e-mail and any attachment(s) is strictly prohibited. If you have received this e-mail in error, please immediately notify the sender by replying to this e-mail and delete the message and any attachment(s) from your system. Thank you.
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From p.dalgaard at biostat.ku.dk  Fri Oct 20 14:15:12 2006
From: p.dalgaard at biostat.ku.dk (p.dalgaard at biostat.ku.dk)
Date: Fri, 20 Oct 2006 14:15:12 +0200 (CEST)
Subject: [Rd] bug in rect (PR#9307)
Message-ID: <20061020121512.317F9561B1@slim.kubism.ku.dk>

Duncan Murdoch <murdoch at stats.uwo.ca> writes:

> Are you fixing rect?

Done now (-patched and -devel).

--=20
   O__  ---- Peter Dalgaard             =C3=98ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From Gregor.Gorjanc at bfro.uni-lj.si  Fri Oct 20 15:48:58 2006
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Fri, 20 Oct 2006 15:48:58 +0200
Subject: [Rd] R CMD check/build --binary fail with data/RCS map
Message-ID: <7FFEE688B57D7346BC6241C55900E730F31C96@pollux.bfro.uni-lj.si>

Hello,

On Windows XP using R 2.4.0pat (2006-10-19 r39674) from CRAN (sorry, no 
r-devel) R CMD check of R CMD build --binary fails if package has RCS 
folder in data map. This does not happen on my Debian GNU/Linux box with 
R 2.4.0 (2006-10-03). Is this a bug?

Here is the transript from the command prompt

C:\Programs\R>R CMD check test
* checking for working latex ... OK
* using log directory 'C:/Programs/R/test.Rcheck'
* using R version 2.4.0 Patched (2006-10-19 r39674)
* checking for file 'test/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'test' version '0.1'
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking whether package 'test' can be installed ... ERROR
Installation failed.
See 'C:/Programs/R/test.Rcheck/00install.out' for details.

and the contents of C:/Programs/R/test.Rcheck/00install.out

installing R.css in C:/Programs/R/test.Rcheck


---------- Making package test ------------
  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  installing R files
  installing data files
cp: omitting directory `data/RCS'
make[2]: *** [C:/Programs/R/test.Rcheck/test/data] Error 1
make[1]: *** [all] Error 2
make: *** [pkg-test] Error 2
*** Installation of test failed ***

Removing 'C:/Programs/R/test.Rcheck/test'

I have also attached test package.

Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana     PhD student
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.
----------------------------------------------------------------------



-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_0.1.tar.gz
Type: application/x-gzip
Size: 672 bytes
Desc: test_0.1.tar.gz
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20061020/23e284eb/attachment-0004.gz 

From rjvbertin at gmail.com  Fri Oct 20 16:11:11 2006
From: rjvbertin at gmail.com (=?ISO-8859-1?Q?Ren=E9_J.V._Bertin?=)
Date: Fri, 20 Oct 2006 16:11:11 +0200
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <F722604B-31E6-43B0-B215-3E3CCB96780F@r-project.org>
References: <797664590610120908k3f8090d4p61a850cf6be60ccc@mail.gmail.com>
	<452E7095.40804@wald.ucdavis.edu>
	<797664590610121012g430c58f1x91756c2437e7510d@mail.gmail.com>
	<F722604B-31E6-43B0-B215-3E3CCB96780F@r-project.org>
Message-ID: <797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>

Since Python has been mentioned in this context: Could not Python's
threading model and implementation serve as a guideline?

>From a few simple benchmarks I've run, it seems as if the Python
interpreter itself is thread-safe but not threadable. That is, when I
run something "pure Python" like a recursive function that returns the
nth Fibonacci number in parallel, there is no speed-up for 2 threads
on a dual-processor machine. However, calling sleep in parallel does
scale down with the number of threads, even on a single-processor ;)

Real-life code does tend to speed up somewhat, though never as much as
one would hope.

Just an idea...

Ren?



From luke at stat.uiowa.edu  Fri Oct 20 16:24:01 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 20 Oct 2006 09:24:01 -0500 (CDT)
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
References: <797664590610120908k3f8090d4p61a850cf6be60ccc@mail.gmail.com>
	<452E7095.40804@wald.ucdavis.edu>
	<797664590610121012g430c58f1x91756c2437e7510d@mail.gmail.com>
	<F722604B-31E6-43B0-B215-3E3CCB96780F@r-project.org>
	<797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610200918560.2751@nokomis.stat.uiowa.edu>

There are several sets of notes on threading off
http://developer.r-project.org page--somewhat old but still relevant.
The Python approach is discussed there.  That approach, which gives
concurrency but not parallelism, is in principle fleasible for R but
getting from here to there is non-trivial given that we have some
unique issues related to FORTRAN semantics as well as how many R
packages are written.  It may happen yet, but probably later rather
than sooner.

Best,

luke

On Fri, 20 Oct 2006, Ren? J.V. Bertin wrote:

> Since Python has been mentioned in this context: Could not Python's
> threading model and implementation serve as a guideline?
>
>> From a few simple benchmarks I've run, it seems as if the Python
> interpreter itself is thread-safe but not threadable. That is, when I
> run something "pure Python" like a recursive function that returns the
> nth Fibonacci number in parallel, there is no speed-up for 2 threads
> on a dual-processor machine. However, calling sleep in parallel does
> scale down with the number of threads, even on a single-processor ;)
>
> Real-life code does tend to speed up somewhat, though never as much as
> one would hope.
>
> Just an idea...
>
> Ren?
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From groemping at tfh-berlin.de  Fri Oct 20 16:53:38 2006
From: groemping at tfh-berlin.de (=?ISO-8859-1?Q?Ulrike_Gr=F6mping?=)
Date: Fri, 20 Oct 2006 16:53:38 +0200
Subject: [Rd] Problem tracking down an R CMD check syntax error
Message-ID: <20061020144253.M58182@tfh-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061020/9c514bd2/attachment-0003.pl 

From duncan at wald.ucdavis.edu  Fri Oct 20 18:59:04 2006
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Fri, 20 Oct 2006 09:59:04 -0700
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <Pine.LNX.4.64.0610200918560.2751@nokomis.stat.uiowa.edu>
References: <797664590610120908k3f8090d4p61a850cf6be60ccc@mail.gmail.com>
	<452E7095.40804@wald.ucdavis.edu>
	<797664590610121012g430c58f1x91756c2437e7510d@mail.gmail.com>
	<F722604B-31E6-43B0-B215-3E3CCB96780F@r-project.org>
	<797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
	<Pine.LNX.4.64.0610200918560.2751@nokomis.stat.uiowa.edu>
Message-ID: <45390058.80503@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



Luke Tierney wrote:
> There are several sets of notes on threading off
> http://developer.r-project.org page--somewhat old but still relevant.
> The Python approach is discussed there.  That approach, which gives
> concurrency but not parallelism, is in principle fleasible for R but
> getting from here to there is non-trivial given that we have some
> unique issues related to FORTRAN semantics as well as how many R
> packages are written.  It may happen yet, but probably later rather
> than sooner.
> 

To follow up on Luke's comments..

We can partially automate the work to get multiple evaluators in R.
And we are getting very close to having the underlying tools to do this.
But it still remains to be seen whether the extra work to introduce
threads is warranted. Will people actually use them in R and will it
have a significant impact on the computations or simply make writing
GUIs within R slightly easier to manage?
The design of R may not be ideal for high performance computing and
a new architecture and system explicitly for more specialized
computation in the short term may be warranted. Some of us are thinking
about this from a variety of different perspectives.  Lee Edlefsen h
has some intersting work at exametrix.com


One of the reasons I am hesitant to use Python as a framework on
which to build a new system is the "thread-safe but not threadable"
issue. Also, it is not easily extensible in an object oriented manner
and this is a big issue for evolvability and user extensions to a system.

> Best,
> 
> luke
> 
> On Fri, 20 Oct 2006, Ren? J.V. Bertin wrote:
> 
>> Since Python has been mentioned in this context: Could not Python's
>> threading model and implementation serve as a guideline?
>>
>>> From a few simple benchmarks I've run, it seems as if the Python
>>
>> interpreter itself is thread-safe but not threadable. That is, when I
>> run something "pure Python" like a recursive function that returns the
>> nth Fibonacci number in parallel, there is no speed-up for 2 threads
>> on a dual-processor machine. However, calling sleep in parallel does
>> scale down with the number of threads, even on a single-processor ;)
>>
>> Real-life code does tend to speed up somewhat, though never as much as
>> one would hope.
>>
>> Just an idea...
>>
>> Ren?
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 

- --
Duncan Temple Lang                    duncan at wald.ucdavis.edu
Department of Statistics              work:  (530) 752-4782
4210 Mathematical Sciences Building   fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis,
CA 95616,
USA
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (Darwin)

iD8DBQFFOQBY9p/Jzwa2QP4RAoD9AJwOxnuLKp+1pkregjsmgi0XQczqDgCbBFsB
eR4bQXKHNUBk6RILk0kxVg4=
=1YKW
-----END PGP SIGNATURE-----



From groemp at tfh-berlin.de  Fri Oct 20 19:02:27 2006
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Fri, 20 Oct 2006 10:02:27 -0700 (PDT)
Subject: [Rd] Problem tracking down an R CMD check syntax error
In-Reply-To: <20061020144253.M58182@tfh-berlin.de>
References: <20061020144253.M58182@tfh-berlin.de>
Message-ID: <6920950.post@talk.nabble.com>


My original post got slightly messed up somehow, so let me restructure it in
order to make it understandable:

Dear all,

I am stuck with tracking down an error I get from R CMD check (Windows, R
2.4.0, same error for R 2.2.1): when running R CMD check over a modified
version of package relaimpo, I get the following output in install.out:

preparing package relaimpo for lazy loading
Loading required package: MASS
Loading required package: boot
Error in parse(file, n, text, prompt) : syntax error at
2193: 
}
2194: 
Error: unable to load R code in package 'relaimpo'
Execution halted
make: *** [lazyload] Error 1
*** Installation of relaimpo failed ***

I've tracked down the "}" in question, and it is in the file zzz.R that
hasn't been changed for ages and works without problems in the current
version of the package. I include this file below. Does anyone have a hint
for me where I should look for the root cause of the problem ? 

Regards, Ulrike

############## file zzz.R which gets blamed #############
.onLoad <- function(lib, pkg){
?? if(!require(MASS, quietly = TRUE))
??????? stop("Could not load package MASS")
?? if(!require(boot, quietly = TRUE))
??????? stop("Could not load package boot")
?? if(!require(methods, quietly = TRUE))
??????? stop("Could not load package methods")

cat("This is the non-US version of package relaimpo including the metric
pmvd.","\n")
cat("Please make sure that you are entitled to using it.","\n")
cat("If you are a US-user, please use the global version (without pmvd) that
is available on CRAN.","\n")

#cat("This is the global version of package relaimpo.","\n")
#cat( "If you are a non-US user, a version with the interesting additional
metric pmvd is available","\n")
#cat("from Ulrike Groempings web site at www.tfh-berlin.de/~groemp.","\n")

}

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
View this message in context: http://www.nabble.com/Problem-tracking-down-an-R-CMD-check-syntax-error-tf2481045.html#a6920950
Sent from the R devel mailing list archive at Nabble.com.



From ripley at stats.ox.ac.uk  Fri Oct 20 19:23:54 2006
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 20 Oct 2006 18:23:54 +0100 (GMT Daylight Time)
Subject: [Rd] Problem tracking down an R CMD check syntax error
In-Reply-To: <6920950.post@talk.nabble.com>
References: <20061020144253.M58182@tfh-berlin.de>
	<6920950.post@talk.nabble.com>
Message-ID: <Pine.WNT.4.64.0610201821530.1244@Petrel>

On Fri, 20 Oct 2006, Ulrike Gr?mping wrote:

>
> My original post got slightly messed up somehow, so let me restructure it in
> order to make it understandable:
>
> Dear all,
>
> I am stuck with tracking down an error I get from R CMD check (Windows, R
> 2.4.0, same error for R 2.2.1): when running R CMD check over a modified
> version of package relaimpo, I get the following output in install.out:
>
> preparing package relaimpo for lazy loading
> Loading required package: MASS
> Loading required package: boot
> Error in parse(file, n, text, prompt) : syntax error at
> 2193:
> }
> 2194:
> Error: unable to load R code in package 'relaimpo'
> Execution halted
> make: *** [lazyload] Error 1
> *** Installation of relaimpo failed ***
>
> I've tracked down the "}" in question, and it is in the file zzz.R that
> hasn't been changed for ages and works without problems in the current
> version of the package. I include this file below. Does anyone have a hint
> for me where I should look for the root cause of the problem ?

Earlier files: this is after concatenating all the files.

Check for missing final newlines on all the files, and that you can 
source() them individually.


> Regards, Ulrike
>
> ############## file zzz.R which gets blamed #############
> .onLoad <- function(lib, pkg){
> ?? if(!require(MASS, quietly = TRUE))
> ??????? stop("Could not load package MASS")
> ?? if(!require(boot, quietly = TRUE))
> ??????? stop("Could not load package boot")
> ?? if(!require(methods, quietly = TRUE))
> ??????? stop("Could not load package methods")
>
> cat("This is the non-US version of package relaimpo including the metric
> pmvd.","\n")
> cat("Please make sure that you are entitled to using it.","\n")
> cat("If you are a US-user, please use the global version (without pmvd) that
> is available on CRAN.","\n")
>
> #cat("This is the global version of package relaimpo.","\n")
> #cat( "If you are a non-US user, a version with the interesting additional
> metric pmvd is available","\n")
> #cat("from Ulrike Groempings web site at www.tfh-berlin.de/~groemp.","\n")
>
> }
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> -- 
> View this message in context: http://www.nabble.com/Problem-tracking-down-an-R-CMD-check-syntax-error-tf2481045.html#a6920950
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rjvbertin at gmail.com  Fri Oct 20 20:37:40 2006
From: rjvbertin at gmail.com (=?ISO-8859-1?Q?Ren=E9_J.V._Bertin?=)
Date: Fri, 20 Oct 2006 20:37:40 +0200
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <45390058.80503@wald.ucdavis.edu>
References: <797664590610120908k3f8090d4p61a850cf6be60ccc@mail.gmail.com>
	<452E7095.40804@wald.ucdavis.edu>
	<797664590610121012g430c58f1x91756c2437e7510d@mail.gmail.com>
	<F722604B-31E6-43B0-B215-3E3CCB96780F@r-project.org>
	<797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
	<Pine.LNX.4.64.0610200918560.2751@nokomis.stat.uiowa.edu>
	<45390058.80503@wald.ucdavis.edu>
Message-ID: <797664590610201137t6e180e3eyd3fe6860b8886145@mail.gmail.com>

> But it still remains to be seen whether the extra work to introduce
> threads is warranted. Will people actually use them in R and will it
> have a significant impact on the computations or simply make writing
> GUIs within R slightly easier to manage?

  If threads can be set up easily, why not? Now that multi-core
machines are becoming more easily available...

It is not just about reducing computation time, btw. Not so long ago,
I was setting up a system in Matlab to do concurrent sampling of a DAQ
and an eye-tracker, and to show and record the sampled data. The DAQ
toolbox fires off its own thread that does the actual sampling and can
be configured to call a Matlab callback function at a predetermined
interval.
The eye-tracker code is single-threaded. If Matlab had been
threadable, I'd have been able to sample the tracker in a different
thread, and not miss out on the data coming in while plotting.

> One of the reasons I am hesitant to use Python as a framework on
> which to build a new system is the "thread-safe but not threadable"
> issue. Also, it is not easily extensible in an object oriented manner

  Well, I didn't mean to suggest that it would the perfect solution.
It seemed like a potentially worthwhile, feasible temporary solution
that would allow at least some multithreading. I don't see how it is
not easily extensible in an OO manner, though. The Python threads I
use *are* objects (and very similar apparently to Java's threading
model).

Best,
Ren?



From luke at stat.uiowa.edu  Fri Oct 20 22:00:35 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 20 Oct 2006 15:00:35 -0500 (CDT)
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <797664590610201137t6e180e3eyd3fe6860b8886145@mail.gmail.com>
References: <797664590610120908k3f8090d4p61a850cf6be60ccc@mail.gmail.com>
	<452E7095.40804@wald.ucdavis.edu>
	<797664590610121012g430c58f1x91756c2437e7510d@mail.gmail.com>
	<F722604B-31E6-43B0-B215-3E3CCB96780F@r-project.org>
	<797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
	<Pine.LNX.4.64.0610200918560.2751@nokomis.stat.uiowa.edu>
	<45390058.80503@wald.ucdavis.edu>
	<797664590610201137t6e180e3eyd3fe6860b8886145@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610201455530.2586@itasca2.wildberry.org>

On Fri, 20 Oct 2006, Ren? J.V. Bertin wrote:

>> But it still remains to be seen whether the extra work to introduce
>> threads is warranted. Will people actually use them in R and will it
>> have a significant impact on the computations or simply make writing
>> GUIs within R slightly easier to manage?
>
>  If threads can be set up easily, why not? Now that multi-core
> machines are becoming more easily available...

If it was easy it would have been done along time ago.  And what does
multi-core have to do with Python style threading? Nothing of course
...

>
> It is not just about reducing computation time, btw. Not so long ago,
> I was setting up a system in Matlab to do concurrent sampling of a DAQ
> and an eye-tracker, and to show and record the sampled data. The DAQ
> toolbox fires off its own thread that does the actual sampling and can
> be configured to call a Matlab callback function at a predetermined
> interval.
> The eye-tracker code is single-threaded. If Matlab had been
> threadable, I'd have been able to sample the tracker in a different
> thread, and not miss out on the data coming in while plotting.

Yes, concurrent threading as available in Pyton is useful.  Is is
useful enough to justify the effort of those who are going to end up
doing the work (given that there are other things we could also be
working on)?  That is not clear.

Best,

luke

>> One of the reasons I am hesitant to use Python as a framework on
>> which to build a new system is the "thread-safe but not threadable"
>> issue. Also, it is not easily extensible in an object oriented manner
>
>  Well, I didn't mean to suggest that it would the perfect solution.
> It seemed like a potentially worthwhile, feasible temporary solution
> that would allow at least some multithreading. I don't see how it is
> not easily extensible in an OO manner, though. The Python threads I
> use *are* objects (and very similar apparently to Java's threading
> model).
>
> Best,
> Ren?
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From ggrothendieck at gmail.com  Fri Oct 20 22:19:45 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 20 Oct 2006 16:19:45 -0400
Subject: [Rd] R sequence function (was: Re: [R] Recursive decreasing
	sequences)
Message-ID: <971536df0610201319r3caad88ehabcf82ab077fc39a@mail.gmail.com>

This seems a lot faster than using the R sequence function.  Suggest
that sequence be rewritten.

On 10/20/06, Marc Schwartz <MSchwartz at mn.rr.com> wrote:
> On Fri, 2006-10-20 at 12:51 -0700, Julian Burgos wrote:
> > Hello fellow R's,
> >
> > I'm sure there must be an easy way to do this.  But after digging in the
> > documentation and thinking about it for a while I couldn't figure it
> > out.  I need to get a decreasing recursive vector in.  I mean something
> > like this: if starting at 2, and ending at 6, the vector should be
> >
> >  2 3 4 5 6 3 4 5 6 4 5 6 5 6 6
> >
> > An easy way would be to do this
> >
> >     x <- integer(0)
> >     for (i in 5) x <- c(x, i:5)
> >
> > But I need to create really long vectors (where the ending value is in
> > the order of 6500) , and using loops is way to slow.  I'm looking for a
> > vectorized method.  Any help will be welcomed.
>
> How about this:
>
> Range <- c(2:6)
>
> > unlist(sapply(seq(along = Range), function(x) Range[x]:max(Range)))
>  [1] 2 3 4 5 6 3 4 5 6 4 5 6 5 6 6
>
>
> Then:
>
> Range2 <- 2:6500
>
> > str(Range2)
>  int [1:6499] 2 3 4 5 6 7 8 9 10 11 ...
>
>
> system.time(res <- unlist(sapply(seq(along = Range2),
>                                 function(x) Range2[x]:max(Range2))))
> [1] 0.492 0.136 0.647 0.000 0.000
>
>
> > str(res)
>  int [1:21121750] 2 3 4 5 6 7 8 9 10 11 ...
>
>
> HTH,
>
> Marc Schwartz
>
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>



From lfrank at cema.edu.ar  Fri Oct 20 22:39:33 2006
From: lfrank at cema.edu.ar (lfrank at cema.edu.ar)
Date: Fri, 20 Oct 2006 22:39:33 +0200 (CEST)
Subject: [Rd] sort function (PR#9309)
Message-ID: <20061020203933.4C1BFA236@slim.kubism.ku.dk>

Full_Name: Luis Frank
Version: 2.3.1
OS: 
Submission from: (NULL) (168.96.156.79)


Hallo!

In version 2.3.1 tha sort function applied to a vector trasposes it. This does
not happen in earlier versions. As a consequence, old programms don?t work in
newer versions.

Thanks!
Luis



From ligges at statistik.uni-dortmund.de  Fri Oct 20 23:09:02 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri, 20 Oct 2006 23:09:02 +0200
Subject: [Rd] sort function (PR#9309)
In-Reply-To: <20061020203933.4C1BFA236@slim.kubism.ku.dk>
References: <20061020203933.4C1BFA236@slim.kubism.ku.dk>
Message-ID: <45393AEE.4050308@statistik.uni-dortmund.de>

lfrank at cema.edu.ar wrote:
> Full_Name: Luis Frank
> Version: 2.3.1
> OS: 
> Submission from: (NULL) (168.96.156.79)
> 
> 
> Hallo!
> 
> In version 2.3.1 tha sort function applied to a vector trasposes it. This does
> not happen in earlier versions. As a consequence, old programms don?t work in
> newer versions.
> 
> Thanks!
> Luis


Please read the FAQ how to report bugs.

1. You are using an outdated version of R, please only report bugs of 
recent R versions.
2. You have not given your OS.
3. You have not given an example that reproduces the bug, my try does 
not transpose anything:
  x <- 5:1
  x
  sort(x)

So, please ....

Uwe Ligges


> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From mwtoews at sfu.ca  Sat Oct 21 02:32:01 2006
From: mwtoews at sfu.ca (Michael Toews)
Date: Fri, 20 Oct 2006 17:32:01 -0700
Subject: [Rd] parse/INSTALL feature request(s)
Message-ID: <45396A81.8080808@sfu.ca>

Hi,
I have a feature request for 'parse', and possibly the 'R CMD INSTALL' 
command to display more informative error information. Specifically, 
after making several modifications to a package on my system (the 
package name is irrelevant; I'm using R 2.3.1 on Debian):
$ R CMD INSTALL seas
* Installing *source* package 'seas' ...
** R
** data
** inst
** preparing package for lazy loading
Error in parse(file, n, text, prompt) : syntax error at
1222:       ylim <-
1223:     else
Execution halted
ERROR: lazy loading failed for package 'seas'
** Removing '/usr/local/lib/R/site-library/seas'

Of the 24 or so *.R source files in the edited package, I'm not sure 
where I had made the syntax error, but it would be very nice to see an 
error message that says something more helpful, such as "Error in 
parse(file, n, text, prompt) : syntax error in function 'foo' at ...". 
Is it possible for 'parse' to display the parent function name in which 
the error occurred? As for 'R CMD INSTALL' goes, I realize that all the 
*.R files are cat'ed together, then parsed as one file, so it is 
difficult report a file name and line number(s). Is this concatenating 
necessary? Or couldn't the individual files be parsed (and errors/line 
#'s reported for offending files), then combined in an environment for 
the INSTALL'ed package?

In the mean time, my solution to find the offending file is:
for(i in dir(pattern=".R$")){
    print(i)
    parse(i)
}

Thanks,
+mt



From murdoch at stats.uwo.ca  Sat Oct 21 04:10:16 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 20 Oct 2006 22:10:16 -0400
Subject: [Rd] parse/INSTALL feature request(s)
In-Reply-To: <45396A81.8080808@sfu.ca>
References: <45396A81.8080808@sfu.ca>
Message-ID: <45398188.4000709@stats.uwo.ca>

On 10/20/2006 8:32 PM, Michael Toews wrote:
> Hi,
> I have a feature request for 'parse', and possibly the 'R CMD INSTALL' 
> command to display more informative error information. Specifically, 
> after making several modifications to a package on my system (the 
> package name is irrelevant; I'm using R 2.3.1 on Debian):
> $ R CMD INSTALL seas
> * Installing *source* package 'seas' ...
> ** R
> ** data
> ** inst
> ** preparing package for lazy loading
> Error in parse(file, n, text, prompt) : syntax error at
> 1222:       ylim <-
> 1223:     else
> Execution halted
> ERROR: lazy loading failed for package 'seas'
> ** Removing '/usr/local/lib/R/site-library/seas'
> 
> Of the 24 or so *.R source files in the edited package, I'm not sure 
> where I had made the syntax error, but it would be very nice to see an 
> error message that says something more helpful, such as "Error in 
> parse(file, n, text, prompt) : syntax error in function 'foo' at ...". 

Yes, that would be nice, but I don't think it's possible:  if the parse 
fails, R won't know enough to know that it was in the middle of parsing 
function 'foo'.

What would be possible is to do like other preprocessors do, and put 
comments into the source file to indicate the origin of each line:  then 
the parser could tell you the location in the original file, which would 
be a lot more useful.  This would slow things down a bit and make the 
package bigger so we'd probably want it to be optional, but it would 
help a lot in situations like yours.

> Is it possible for 'parse' to display the parent function name in which 
> the error occurred? As for 'R CMD INSTALL' goes, I realize that all the 
> *.R files are cat'ed together, then parsed as one file, so it is 
> difficult report a file name and line number(s). Is this concatenating 
> necessary? Or couldn't the individual files be parsed (and errors/line 
> #'s reported for offending files), then combined in an environment for 
> the INSTALL'ed package?

I don't know the reason for putting them in one file.

> In the mean time, my solution to find the offending file is:
> for(i in dir(pattern=".R$")){
>     print(i)
>     parse(i)
> }

That looks like a good idea; if it doesn't catch the error, then it's 
probably something wrong with the last line in one of the files, e.g. 
not having a newline at the end of it.

Duncan Murdoch



From ggrothendieck at gmail.com  Sat Oct 21 05:11:15 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 20 Oct 2006 23:11:15 -0400
Subject: [Rd] parse/INSTALL feature request(s)
In-Reply-To: <45398188.4000709@stats.uwo.ca>
References: <45396A81.8080808@sfu.ca> <45398188.4000709@stats.uwo.ca>
Message-ID: <971536df0610202011u25f8ccfnba45dc9cc07f39d1@mail.gmail.com>

On 10/20/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/20/2006 8:32 PM, Michael Toews wrote:
> > Hi,
> > I have a feature request for 'parse', and possibly the 'R CMD INSTALL'
> > command to display more informative error information. Specifically,
> > after making several modifications to a package on my system (the
> > package name is irrelevant; I'm using R 2.3.1 on Debian):
> > $ R CMD INSTALL seas
> > * Installing *source* package 'seas' ...
> > ** R
> > ** data
> > ** inst
> > ** preparing package for lazy loading
> > Error in parse(file, n, text, prompt) : syntax error at
> > 1222:       ylim <-
> > 1223:     else
> > Execution halted
> > ERROR: lazy loading failed for package 'seas'
> > ** Removing '/usr/local/lib/R/site-library/seas'
> >
> > Of the 24 or so *.R source files in the edited package, I'm not sure
> > where I had made the syntax error, but it would be very nice to see an
> > error message that says something more helpful, such as "Error in
> > parse(file, n, text, prompt) : syntax error in function 'foo' at ...".
>
> Yes, that would be nice, but I don't think it's possible:  if the parse
> fails, R won't know enough to know that it was in the middle of parsing
> function 'foo'.
>
> What would be possible is to do like other preprocessors do, and put
> comments into the source file to indicate the origin of each line:  then
> the parser could tell you the location in the original file, which would
> be a lot more useful.  This would slow things down a bit and make the
> package bigger so we'd probably want it to be optional, but it would
> help a lot in situations like yours.
>
> > Is it possible for 'parse' to display the parent function name in which
> > the error occurred? As for 'R CMD INSTALL' goes, I realize that all the
> > *.R files are cat'ed together, then parsed as one file, so it is
> > difficult report a file name and line number(s). Is this concatenating
> > necessary? Or couldn't the individual files be parsed (and errors/line
> > #'s reported for offending files), then combined in an environment for
> > the INSTALL'ed package?
>
> I don't know the reason for putting them in one file.
>
> > In the mean time, my solution to find the offending file is:
> > for(i in dir(pattern=".R$")){
> >     print(i)
> >     parse(i)
> > }
>
> That looks like a good idea; if it doesn't catch the error, then it's
> probably something wrong with the last line in one of the files, e.g.
> not having a newline at the end of it.
>

I try to develop my functions one at a time for this very reason.  Of course
its not always feasible but if you can do it followed by an install each time
it makes it easier to locate problems.



From ligges at statistik.uni-dortmund.de  Sat Oct 21 13:03:10 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat, 21 Oct 2006 13:03:10 +0200
Subject: [Rd] [R] R-2.4.0 and MS Vista OS - installing packages
In-Reply-To: <00a401c6f4b1$9900c0f0$6400a8c0@DD4XFW31>
References: <00a401c6f4b1$9900c0f0$6400a8c0@DD4XFW31>
Message-ID: <4539FE6E.8010500@statistik.uni-dortmund.de>

[moved to R-devel]

Thanks for the report.
It would be interesting to know if the package installation fails 
because of chm files or because you are trying to install stuff into a 
directory with insufficient permissions even for other files.
If we are supposed packages in a different way for Vista, it would be 
nice to be able (i.e. knowing what to do) to apply relevant changes 
before the next major release (R-2.5.0?).

Best,
Uwe


Charles Annis, P.E. wrote:
> Problem solved!
> 
> Thanks to all and especially Clint Bowman and Uwe Ligges who pointed to the
> fly in the ointment, viz. Vista's "User Account Control," UAC.  
> 
> To allow installation of R packages, you must open the Vista Control Panel
> and choose Windows Security Center.  Then turn the UAC off.  This will
> require a restart of the computer.  After the computer restarts and you
> summon R, packages can be installed from CRAN in the usual way.  After
> installation you can reassert the UAC which also requires a computer
> restart.  Vista starts up about 5X faster than my 3 year old Windows XP
> machine, so the restarts are not onerous.
> 
> Many thanks to you all!
> 
> Charles Annis, P.E.
> 
> Charles.Annis at StatisticalEngineering.com
> phone: 561-352-9699
> eFax:  614-455-3265
> http://www.StatisticalEngineering.com
>  
> 
> -----Original Message-----
> From: r-help-bounces at stat.math.ethz.ch
> [mailto:r-help-bounces at stat.math.ethz.ch] On Behalf Of Clint Bowman
> Sent: Friday, October 20, 2006 4:59 PM
> To: Charles Annis, P.E.
> Cc: r-help at stat.math.ethz.ch
> Subject: Re: [R] R-2.4.0 and MS Vista OS - installing packages
> 
> This week's eweek has an article on Vista's security and system
> administration--I'm guessing (a Linux user guess) that you are running
> afoul of Vista's User Account Control feature.
> 
> Clint Bowman			INTERNET:	clint at ecy.wa.gov
> Air Dispersion Modeler		INTERNET:	clint at math.utah.edu
> Air Quality Program		VOICE:		(360) 407-6815
> Department of Ecology		FAX:		(360) 407-7534
> 
> 	USPS:  		PO Box 47600, Olympia, WA 98504-7600
> 	Parcels:	300 Desmond Drive, Lacey, WA 98503-1274
> 
> On Fri, 20 Oct 2006, Charles Annis, P.E. wrote:
> 
>> I have installed Microsoft Vista Release Candidate 1, and R-2.4.0, on a 4
>> year old DELL box with a 2.26 GHz P4 and 1 gig.  It was a clean install ?
> R
>> is the only non-MS program running.
>>
>> I cannot install packages from CRAN, nor from local zipped files.  (I have
>> R-2.4.0 installed on a Windows XP machine and have had no problems so the
>> difficulty seems to be Vista not R, however they aren't playing together
>> nicely as they should.)
>>
>> The CRAN installation of R-2.4.0 on the Vista machine was without
> incident,
>> but after downloading the zipped packages from CRAN I get this error
>> message:
>>
>>
>>> utils:::menuInstallPkgs()
>> trying URL
>>
> 'http://cran.us.r-project.org/bin/windows/contrib/2.4/RColorBrewer_0.2-3.zip
>> '
>> Content type 'application/zip' length 39787 bytes
>> opened URL
>> downloaded 38Kb
>>
>> Error in zip.unpack(pkg, tmpDir) : cannot open file 'C:/Program
>> Files/R/R-2.4.0/library/file6fc97ac2/RColorBrewer/chtml/RColorBrewer.chm'
>> Any help would be appreciated.  Thanks.
>>
>>
>> Charles Annis, P.E.
>>
>> Charles.Annis at StatisticalEngineering.com
>> phone: 561-352-9699
>> eFax:  614-455-3265
>> http://www.StatisticalEngineering.com
>>  
>>
>> ______________________________________________
>> R-help at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



From groemping at tfh-berlin.de  Sat Oct 21 14:44:26 2006
From: groemping at tfh-berlin.de (=?ISO-8859-1?Q?Ulrike_Gr=F6mping?=)
Date: Sat, 21 Oct 2006 14:44:26 +0200
Subject: [Rd] sort function (PR#9309)
In-Reply-To: <45393AEE.4050308@statistik.uni-dortmund.de>
References: <20061020203933.4C1BFA236@slim.kubism.ku.dk>
	<45393AEE.4050308@statistik.uni-dortmund.de>
Message-ID: <20061021123910.M97500@tfh-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061021/3c8de5eb/attachment-0003.pl 

From ligges at statistik.uni-dortmund.de  Sat Oct 21 14:59:35 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat, 21 Oct 2006 14:59:35 +0200
Subject: [Rd] sort function (PR#9309)
In-Reply-To: <20061021123910.M97500@tfh-berlin.de>
References: <20061020203933.4C1BFA236@slim.kubism.ku.dk>
	<45393AEE.4050308@statistik.uni-dortmund.de>
	<20061021123910.M97500@tfh-berlin.de>
Message-ID: <453A19B7.3060401@statistik.uni-dortmund.de>



Ulrike Gr?mping wrote:
> What Luis probably means can be reproduced by this little example:
> 
> a<-5:1
> b<-t(t(a))
> b
> sort(b)
> 
> In R 2.2.1 (Windows XP), sort(b) is a matrix with 1 column, like b. In R 2.4.0 (and presumably already 2.3.1), sort(b) is no longer a matrix but a vector (and displayed as a row).

I see. This is not a bug. It *was* a bug in R < 2.3.0 and has been 
fixed. From NEWS:

     o   sort() now does not return inappropriate attributes such as
     "dim" and "tsp": it only returns names.

You cannot expect sort to do anything meaningful when applied to 
matrices or arrays other than returning a sorted vector of the elements, 
and that is what sort does nowadays.

Best,
Uwe Ligges


> Regards, Ulrike
> 
> ---------- Original Message -----------
> From: Uwe Ligges <ligges at statistik.uni-dortmund.de> 
> To: lfrank at cema.edu.ar 
> Cc: r-devel at stat.math.ethz.ch 
> Sent: Fri, 20 Oct 2006 23:09:02 +0200 
> Subject: Re: [Rd] sort function (PR#9309)
> 
>> lfrank at cema.edu.ar wrote: 
>>> Full_Name: Luis Frank 
>>> Version: 2.3.1 
>>> OS: 
>>> Submission from: (NULL) (168.96.156.79) 
>>>
>>>
>>> Hallo! 
>>>
>>> In version 2.3.1 tha sort function applied to a vector trasposes it. This does 
>>> not happen in earlier versions. As a consequence, old programms don?t work in 
>>> newer versions. 
>>>
>>> Thanks! 
>>> Luis 
>> Please read the FAQ how to report bugs. 
>>
>> 1. You are using an outdated version of R, please only report bugs of 
>> recent R versions. 
>> 2. You have not given your OS. 
>> 3. You have not given an example that reproduces the bug, my try does 
>> not transpose anything: 
>>  x <- 5:1 
>>  x 
>>  sort(x) 
>>
>> So, please .... 
>>
>> Uwe Ligges 
>>
>>> ______________________________________________ 
>>> R-devel at r-project.org mailing list 
>>> https://stat.ethz.ch/mailman/listinfo/r-devel 
>> ______________________________________________ 
>> R-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-devel 
> ------- End of Original Message -------
> 
>  
>



From atp at piskorski.com  Sat Oct 21 16:10:12 2006
From: atp at piskorski.com (Andrew Piskorski)
Date: Sat, 21 Oct 2006 10:10:12 -0400
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
References: <797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
Message-ID: <20061021141012.GA7466@tehun.pair.com>

On Fri, Oct 20, 2006 at 04:11:11PM +0200,  Ren? J.V. Bertin  wrote:
> Since Python has been mentioned in this context: Could not Python's
> threading model and implementation serve as a guideline?

Why would you want to do that?  Does that model have some particular
synergy with R's design or current limitations?  (From later posts, I
suspect that the answer to that is "yes".)

I'm curious, what is the current state of the R implementation's
support for thread-safety, re-entrant code, and concurrency?  What
issues in the code block improvement?  Is there a summary anywhere
more recent than the the info here?:

  http://developer.r-project.org/RThreads/index.html

And perhaps most importantly, what are the main users or use cases
driving (or likely to drive in the future) improved multi-threading
support?  Who really wants it, and why?

It would certainly be nice to make R completely thread-safe (and
ideally, fully reentrant), so that it could be easily embedded into a
multi-threaded program.  But, that sounds like a non-mainstream use of
R, and thus unlikely to motivate most of the R core developers.

R also already has about 8 different packages for doing parallel
programming across multiple machines using MPI, PVM, or etc.  I wonder
to what degree these obviate the need for multi-threaded R.
(Certainly not 100%, as most of those approaches will have vastly
worse latency than multi-threading.  But I wonder how much of the same
use cases they cover, 20%, or 80%?)

There's also the broader question of how or whether multi-threading
support would help, hinder, or otherwise interact with other potential
cool changes to R.  E.g., a high-performance byte-code interpreter, or
Lisp-like macros.

Any large single threaded application like R is going to have its own
particular obstacles to making the code thread-safe, and more to
making it reentrant and adding good multi-threading support of one
flavor or another.

I don't know what the particular obstacles for R are.  But if I was
looking for a GENERAL example of implementing a multi-threaded
interpreter, I certainly wouldn't choose Python.

Neither Python nor Ruby have real multi-threading, and are only
thread-safe via some sort of global lock.  (Only one thread can ever
run at a time, no matter how many CPUs your machine has.)  Perl
probably does support real multi-threading, but people say it hasn't
had much real world use.  Tcl has excellent multi-threading support,
using independent interpreters on top of OS threads (POSIX or Win32),
and has been in heavy use for many years.  I don't know about Lua,
JavaScript, the eleventy dozen different Scheme implementations,
etc. etc.

There are lots of different models for threading and concurrency.
OS-threads vs. user-mode threads is just one variable in the choice
space.  There's also message passing vs. shared memory, threads
vs. event-based programming, default shared-everything vs. default
shared-nothing, etc. etc.

In my experience, Tcl's "apartment model" for multi-threading is quite
nice to work with.  With it, you program each Tcl interpreter as if it
was a stand-alone shared-nothing process, which communicates with
other Tcl interpreters only through explicit shared memory and message
passing APIs.  Underneath, the C code sees the true shared-everything
threading implementation, but also has APIs to make working with it
easier.

(Note that Tcl implements that on top of POSIX and Win32 threads, but
you could implement the exact same script-level model on top of
inter-process shared memory.  Only the C code underneath would see any
difference.)

I have never really used any other threading model extensively, so I
can't do a proper hands-on compare and contrast.  However, my
suspicion is that "shared nothing by default" models (like Tcl's
threading) are the better way to go, rather than "shared everything by
default" (like POSIX threads).  The Erlang and Mozart/Oz folks both
seem to think so, etc.

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/



From jmc at r-project.org  Sat Oct 21 16:28:36 2006
From: jmc at r-project.org (John Chambers)
Date: Sat, 21 Oct 2006 10:28:36 -0400
Subject: [Rd] default arguments in generics and methods
In-Reply-To: <0D795BA2-D5C6-4A6F-997E-C763905C677C@mac.com>
References: <0D795BA2-D5C6-4A6F-997E-C763905C677C@mac.com>
Message-ID: <453A2E94.3070302@r-project.org>

You're conflating 3 different things here:  how methods are selected, 
how R treats missing arguments, and how the standardGeneric() call is 
implemented.

Maybe more relevant, if this question is motivated by a practical need, 
you may want to rethink what the generic function does.  "Nonstandard" 
generic functions are called that  for a reason.  The concept behind 
methods in S is that a generic function defines the _function_ or 
purpose of the computation, but it's only the methods that define how 
the purpose is carried out.

Using a nonstandard generic that does some extra computation always 
blurs the concept, and often makes methods harder to write or 
understand.  That you've found it necessary to worry about the subtle 
points in your question is a warning sign.  It's usually worth asking 
whether the place that you call standardGeneric() could in fact _be_ the 
generic, with the other computations moved to a nongeneric wrapper 
function.  Having said that,  when the computations depend on missing 
arguments, the situation may be more complicated.

Anyway, the following relate to your question.

1.  In method selection, the "missing" class is used if the C-level 
equivalent of the test missing(ARG) is TRUE when selection takes place.  
On to point 2.

2.  The R evaluator stores a special object corresponding to missing 
arguments.  Missing arguments are treated by the lazy evaluation rules, 
so the exact contents of the current object of this name in the local 
environment will depend on whether there has been a reference to the 
argument.  The missing(ARG) test remains TRUE when the default 
expression is evaluated but becomes FALSE if a direct assignment of ARG 
takes place (just reporting this, not defending it).

3.  standardGeneric() creates a  new context into which it copies 
bindings for all the objects in the frame of the generic function call, 
but tries to maintain defaults for missing arguments.  If you want to 
see how it works, look at the routine R_execMethod in file 
src/main/eval.c of the R source.

The somewhat unfortunate result of all this can be seen by comparing two 
nonstandard generics:

setGeneric("foo", function(x, y){if(missing(y)) y <- x+1; 
standardGeneric("foo")})

setGeneric("foo2", function(x, y = x+1){if(missing(y)) message(y); 
standardGeneric("foo2")})

The "foo" function will never dispatch a method for c("numeric", 
"missing") because y is assigned directly.  The "foo2" function will 
dispatch such a method though, even though the numerical value of y will 
be the same in message(y).

As may be obvious, the computation is subtle and it might be foolish to 
rely on the details as if they were part of the API.

Parlamis Franklin wrote:
> i believe the following is true but would appreciate confirmation  
> that it is intended behavior and will continue:
>
> if a default argument is employed in the definition of a generic  
> function, and the generic is called with the argument in question  
> (call it 'ARG') missing, then the method for signature (..., ARG =  
> "missing", ...) will be called by 'standardGeneric' whether or not  
> ARG is evaluated in the body of the generic prior to the call to  
> 'standardGeneric';  however, the value assigned to ARG in the method  
> call will depend on whether ARG was evaluated in the body of the  
> generic prior to the call to 'standardGeneric' (with the default  
> value assigned in the case of prior evaluation and no value assigned  
> in the case of no prior evaluation).  furthermore, if ARG is  
> explicitly assigned to in the body of the generic prior to the call  
> to 'standardGeneric', then the method for signature (..., ARG = class 
> (ARG), ...) will be called, with the assigned value of ARG passed to  
> the call.
>
> this behavior is exhibited by the code below:
>
> __
>
> setGeneric("foo", function(x = 1) standardGeneric("foo"),  
> useAsDefault = FALSE)
> setMethod("foo", signature(x = "missing"), function(x = 3) x)
>
> setGeneric("foo2", function(x = 1) {x; standardGeneric("foo2")},  
> useAsDefault = FALSE)
> setMethod("foo2", signature(x = "missing"), function(x = 3) x)
>
> setGeneric("foo3", function(x = 1) {x<-2; standardGeneric("foo3")},  
> useAsDefault = FALSE)
> setMethod("foo3", signature(x = "missing"), function(x = 3) x)
> setMethod("foo3", signature(x = "numeric"), function(x = 3) x^2)
>
> foo()		# returns 3
> foo2()		# returns 1
> foo3()		# returns 4
>
> ___
>
> franklin parlamis
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From jmc at r-project.org  Sat Oct 21 16:43:14 2006
From: jmc at r-project.org (John Chambers)
Date: Sat, 21 Oct 2006 10:43:14 -0400
Subject: [Rd] understanding virtual classes and extensions thereof
In-Reply-To: <060DBDD8-C750-4BCE-BB58-FF71D1BDFA28@mac.com>
References: <060DBDD8-C750-4BCE-BB58-FF71D1BDFA28@mac.com>
Message-ID: <453A3202.9040203@r-project.org>

IMO, the recommended version is:

setClass("kid2", contains = c("mom", "VIRTUAL"))

because it's the clearest, using the representation argument only for 
defining slots.  Better yet, if your virtual classes don't have any 
slots defined, use setClassUnion() for "mom", with the other classes 
members of the union.

The other versions are mainly to be back-compatible, with "Programming 
with Data" in particular.  They _should_ produce the same result.

As for:

setClass("kid4", contains = "mom")

this is currently a meaningless class: It's not virtual but it has no 
meaningful prototype.  My preference would be a change that makes this a 
virtual class, as the programmer probably intended (maybe with a warning 
for now since it's technically a change in the API).


Parlamis Franklin wrote:
> I am having some trouble creating a hierarchy of virtual classes  
> (akin to the class structure in the 'Matrix' package).  I think they  
> arise from my not understanding the best way to specify virtual  
> subclasses of a virtual class.  please see questions below code.
>
> setClass("mom")
>
> setClass("kid1", representation("mom", "VIRTUAL"))
> setClass("kid2", representation("VIRTUAL"), contains = "mom")
> setClass("kid3"); setIs("kid3", "mom")
>
> (i) Are 'kid1' and 'kid2' equivalent?  I.e., is there any difference  
> between including a superclass as an unnamed argument in the  
> 'representation' call and including it in the 'contains' argument?   
> If not, why does the 'contains' argument exist?
>
> (ii) What is the difference between 'kid1' and 'kid2', on the one  
> hand, and 'kid3', on the other hand?  I see that 'kid1' and 'kid2'  
> have prototypes of class 'S4', while 'kid3' has a prototype of class  
> "NULL".  But I don't really understand the implications of that.  I  
> am using virtual classes mostly to economize on method writing.  Will  
> it matter on any level whether my virtual classes have NULL or S4  
> prototypes?
>
> On a related note, the behavior exhibited below also seems infelicitous
>
> setClass("kid4", contains = "mom")
> new("kid4")  # error in the show method
>
> franklin parlamis
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From Charles.Annis at StatisticalEngineering.com  Sat Oct 21 16:55:09 2006
From: Charles.Annis at StatisticalEngineering.com (Charles Annis, P.E.)
Date: Sat, 21 Oct 2006 10:55:09 -0400
Subject: [Rd] [R] R-2.4.0 and MS Vista OS - installing packages
In-Reply-To: <4539FE6E.8010500@statistik.uni-dortmund.de>
Message-ID: <00c801c6f520$e764f670$6400a8c0@DD4XFW31>

I wish I were a more knowledgeable computer weenie, but I'm just an amateur
beta-testing the Vista OS.

Since I could install R easily from CRAN but the packages balked with the
default security settings but installed without incident when I turned the
User Account Control off, I would guess that it's the OS, not R.  

Does the base installation use chm files?

Charles Annis, P.E.

Charles.Annis at StatisticalEngineering.com
phone: 561-352-9699
eFax:  614-455-3265
http://www.StatisticalEngineering.com
 

-----Original Message-----
From: Uwe Ligges [mailto:ligges at statistik.uni-dortmund.de] 
Sent: Saturday, October 21, 2006 7:03 AM
To: Charles.Annis at statisticalengineering.com
Cc: 'Clint Bowman'; r-devel at stat.math.ethz.ch
Subject: Re: [R] R-2.4.0 and MS Vista OS - installing packages

[moved to R-devel]

Thanks for the report.
It would be interesting to know if the package installation fails 
because of chm files or because you are trying to install stuff into a 
directory with insufficient permissions even for other files.
If we are supposed packages in a different way for Vista, it would be 
nice to be able (i.e. knowing what to do) to apply relevant changes 
before the next major release (R-2.5.0?).

Best,
Uwe


Charles Annis, P.E. wrote:
> Problem solved!
> 
> Thanks to all and especially Clint Bowman and Uwe Ligges who pointed to
the
> fly in the ointment, viz. Vista's "User Account Control," UAC.  
> 
> To allow installation of R packages, you must open the Vista Control Panel
> and choose Windows Security Center.  Then turn the UAC off.  This will
> require a restart of the computer.  After the computer restarts and you
> summon R, packages can be installed from CRAN in the usual way.  After
> installation you can reassert the UAC which also requires a computer
> restart.  Vista starts up about 5X faster than my 3 year old Windows XP
> machine, so the restarts are not onerous.
> 
> Many thanks to you all!
> 
> Charles Annis, P.E.
> 
> Charles.Annis at StatisticalEngineering.com
> phone: 561-352-9699
> eFax:  614-455-3265
> http://www.StatisticalEngineering.com
>  
> 
> -----Original Message-----
> From: r-help-bounces at stat.math.ethz.ch
> [mailto:r-help-bounces at stat.math.ethz.ch] On Behalf Of Clint Bowman
> Sent: Friday, October 20, 2006 4:59 PM
> To: Charles Annis, P.E.
> Cc: r-help at stat.math.ethz.ch
> Subject: Re: [R] R-2.4.0 and MS Vista OS - installing packages
> 
> This week's eweek has an article on Vista's security and system
> administration--I'm guessing (a Linux user guess) that you are running
> afoul of Vista's User Account Control feature.
> 
> Clint Bowman			INTERNET:	clint at ecy.wa.gov
> Air Dispersion Modeler		INTERNET:	clint at math.utah.edu
> Air Quality Program		VOICE:		(360) 407-6815
> Department of Ecology		FAX:		(360) 407-7534
> 
> 	USPS:  		PO Box 47600, Olympia, WA 98504-7600
> 	Parcels:	300 Desmond Drive, Lacey, WA 98503-1274
> 
> On Fri, 20 Oct 2006, Charles Annis, P.E. wrote:
> 
>> I have installed Microsoft Vista Release Candidate 1, and R-2.4.0, on a 4
>> year old DELL box with a 2.26 GHz P4 and 1 gig.  It was a clean install -
> R
>> is the only non-MS program running.
>>
>> I cannot install packages from CRAN, nor from local zipped files.  (I
have
>> R-2.4.0 installed on a Windows XP machine and have had no problems so the
>> difficulty seems to be Vista not R, however they aren't playing together
>> nicely as they should.)
>>
>> The CRAN installation of R-2.4.0 on the Vista machine was without
> incident,
>> but after downloading the zipped packages from CRAN I get this error
>> message:
>>
>>
>>> utils:::menuInstallPkgs()
>> trying URL
>>
>
'http://cran.us.r-project.org/bin/windows/contrib/2.4/RColorBrewer_0.2-3.zip
>> '
>> Content type 'application/zip' length 39787 bytes
>> opened URL
>> downloaded 38Kb
>>
>> Error in zip.unpack(pkg, tmpDir) : cannot open file 'C:/Program
>> Files/R/R-2.4.0/library/file6fc97ac2/RColorBrewer/chtml/RColorBrewer.chm'
>> Any help would be appreciated.  Thanks.
>>
>>
>> Charles Annis, P.E.
>>
>> Charles.Annis at StatisticalEngineering.com
>> phone: 561-352-9699
>> eFax:  614-455-3265
>> http://www.StatisticalEngineering.com
>>  
>>
>> ______________________________________________
>> R-help at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



From fparlamis at mac.com  Sat Oct 21 21:11:56 2006
From: fparlamis at mac.com (Parlamis Franklin)
Date: Sat, 21 Oct 2006 09:11:56 -1000
Subject: [Rd] understanding virtual classes and extensions thereof
In-Reply-To: <453A3202.9040203@r-project.org>
References: <060DBDD8-C750-4BCE-BB58-FF71D1BDFA28@mac.com>
	<453A3202.9040203@r-project.org>
Message-ID: <7D28B0ED-FDE6-474A-AEF6-19E903ADF054@mac.com>

thank you John, as always, for your thoughtful responses.  (i've been  
teaching my children to play chess, which probably isn't that  
different an experience ;)  one further comment and a related (maybe)  
bug report.

comment:

setClass("mom")
setClass("kid2", contains = c("mom", "VIRTUAL"))

will give 'kid2' a prototype of class 'S4', whereas

setClass("kid2")
setClassUnion("mom", "kid2")

will give it a 'NULL' prototype.  as i mentioned in the last message,  
i don't know if that matters on any level, but i instinctively prefer  
the 'NULL' prototype.

__

(maybe) bug report:

the existence of an extends relation in the class definition depends  
on the order of the setIs calls.  see code below.

setClass("A")
setClass("AA")
setClass("AAA")
setClass("AAAA")
setIs("AA", "A")
setIs("AAA", "AA")
setIs("AAAA", "AAA")
getClass("AAAA")  # works fine

setClass("B")
setClass("BB")
setClass("BBB")
setIs("BBB", "BB")
setClass("BBBB")
setIs("BBBB", "BBB")
setIs("BB", "B")
getClass("BBBB") # does not show extension of class 'B'
extends("BBBB", "B") # does not show extension of class 'B'
attr(completeExtends(getClass("BBBB")), "names") # there it is

please note that this behavior does not occur if i only go to depth 3  
on the virtual nesting.

i am working in the global environment, so perhaps this is an issue  
of recaching at some point.

franklin

On Oct 21, 2006, at 4:43 AM, John Chambers wrote:

> IMO, the recommended version is:
>
> setClass("kid2", contains = c("mom", "VIRTUAL"))
>
> because it's the clearest, using the representation argument only  
> for defining slots.  Better yet, if your virtual classes don't have  
> any slots defined, use setClassUnion() for "mom", with the other  
> classes members of the union.
>
> The other versions are mainly to be back-compatible, with  
> "Programming with Data" in particular.  They _should_ produce the  
> same result.
>
> As for:
>
> setClass("kid4", contains = "mom")
>
> this is currently a meaningless class: It's not virtual but it has  
> no meaningful prototype.  My preference would be a change that  
> makes this a virtual class, as the programmer probably intended  
> (maybe with a warning for now since it's technically a change in  
> the API).
>
>
> Parlamis Franklin wrote:
>> I am having some trouble creating a hierarchy of virtual classes   
>> (akin to the class structure in the 'Matrix' package).  I think  
>> they  arise from my not understanding the best way to specify  
>> virtual  subclasses of a virtual class.  please see questions  
>> below code.
>>
>> setClass("mom")
>>
>> setClass("kid1", representation("mom", "VIRTUAL"))
>> setClass("kid2", representation("VIRTUAL"), contains = "mom")
>> setClass("kid3"); setIs("kid3", "mom")
>>
>> (i) Are 'kid1' and 'kid2' equivalent?  I.e., is there any  
>> difference  between including a superclass as an unnamed argument  
>> in the  'representation' call and including it in the 'contains'  
>> argument?   If not, why does the 'contains' argument exist?
>>
>> (ii) What is the difference between 'kid1' and 'kid2', on the one   
>> hand, and 'kid3', on the other hand?  I see that 'kid1' and  
>> 'kid2'  have prototypes of class 'S4', while 'kid3' has a  
>> prototype of class  "NULL".  But I don't really understand the  
>> implications of that.  I  am using virtual classes mostly to  
>> economize on method writing.  Will  it matter on any level whether  
>> my virtual classes have NULL or S4  prototypes?
>>
>> On a related note, the behavior exhibited below also seems  
>> infelicitous
>>
>> setClass("kid4", contains = "mom")
>> new("kid4")  # error in the show method
>>
>> franklin parlamis
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>



From mtmorgan at fhcrc.org  Sun Oct 22 00:23:27 2006
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sat, 21 Oct 2006 15:23:27 -0700
Subject: [Rd] understanding virtual classes and extensions thereof
In-Reply-To: <453A3202.9040203@r-project.org> (John Chambers's message of
	"Sat, 21 Oct 2006 10:43:14 -0400")
References: <060DBDD8-C750-4BCE-BB58-FF71D1BDFA28@mac.com>
	<453A3202.9040203@r-project.org>
Message-ID: <6phk62txq8w.fsf@gopher4.fhcrc.org>



John Chambers <jmc at r-project.org> writes:

> As for:
>
> setClass("kid4", contains = "mom")
>
> this is currently a meaningless class: It's not virtual but it has no 
> meaningful prototype.  My preference would be a change that makes this a 
> virtual class, as the programmer probably intended (maybe with a warning 
> for now since it's technically a change in the API).

Maybe I misunderstand the statement about making these constructs
virtual, but I want to use 'empty' classes as predicates for method
dispatch etc. I want to be able to continue to do this:

setClass("Kid")
setClass("GoodKid", contains="Kid")
setClass("BadKid", contains="Kid")

setGeneric("deserts",
           function(object, ...) standardGeneric("deserts"))
setMethod("deserts",
          signature(object="GoodKid"),
          function(object, ...) "learn chess with dad!")
setMethod("deserts",
          signature(object="BadKid"),
          function(object, ...) "straight to bed")

I had been silently hoping that VIRTUAL would *not* be the default, so
that in the above example I could instantiate a niether good nor bad
Kid without some artifice.

Martin

> Parlamis Franklin wrote:
>> I am having some trouble creating a hierarchy of virtual classes  
>> (akin to the class structure in the 'Matrix' package).  I think they  
>> arise from my not understanding the best way to specify virtual  
>> subclasses of a virtual class.  please see questions below code.
>>
>> setClass("mom")
>>
>> setClass("kid1", representation("mom", "VIRTUAL"))
>> setClass("kid2", representation("VIRTUAL"), contains = "mom")
>> setClass("kid3"); setIs("kid3", "mom")
>>
>> (i) Are 'kid1' and 'kid2' equivalent?  I.e., is there any difference  
>> between including a superclass as an unnamed argument in the  
>> 'representation' call and including it in the 'contains' argument?   
>> If not, why does the 'contains' argument exist?
>>
>> (ii) What is the difference between 'kid1' and 'kid2', on the one  
>> hand, and 'kid3', on the other hand?  I see that 'kid1' and 'kid2'  
>> have prototypes of class 'S4', while 'kid3' has a prototype of class  
>> "NULL".  But I don't really understand the implications of that.  I  
>> am using virtual classes mostly to economize on method writing.  Will  
>> it matter on any level whether my virtual classes have NULL or S4  
>> prototypes?
>>
>> On a related note, the behavior exhibited below also seems infelicitous
>>
>> setClass("kid4", contains = "mom")
>> new("kid4")  # error in the show method
>>
>> franklin parlamis
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin T. Morgan
Bioconductor / Computational Biology
http://bioconductor.org



From mwtoews at sfu.ca  Sun Oct 22 00:36:43 2006
From: mwtoews at sfu.ca (Michael Toews)
Date: Sat, 21 Oct 2006 15:36:43 -0700
Subject: [Rd] parse/INSTALL feature request(s)
In-Reply-To: <971536df0610202011u25f8ccfnba45dc9cc07f39d1@mail.gmail.com>
References: <45396A81.8080808@sfu.ca> <45398188.4000709@stats.uwo.ca>
	<971536df0610202011u25f8ccfnba45dc9cc07f39d1@mail.gmail.com>
Message-ID: <453AA0FB.9080502@sfu.ca>

> What would be possible is to do like other preprocessors do, and put
> comments into the source file to indicate the origin of each line:  then
> the parser could tell you the location in the original file, which would
> be a lot more useful.

I think what you are referring to is already nicely implemented (in 
R/src/main/source.c lines 89 to 97), and the errors are correctly shown 
in my example as lines 1222 to 1223. However, these line numbers are 
irrelevant to the original files, as they been concatenated into one 
large file (I think on line 765 of R/src/scripts/INSTALL.in ). This 
single file is loaded into an R environment (on line 790 of INSTALL.in), 
which is also the region where my original error from 'R CMD INSTALL' 
was thrown. The loading is done by the 'tools:::makeLazyLoading' 
function, which loads in the single R-source file into a fresh 
environment for the package.

I'm unsure of why a single R source file is needed in INSTALL (which 
limits the ability to show any offending file names and their line 
numbers). The functions in R/src/library/tools/R/makeLazyLoad.R could 
perhaps be made a bit more versatile to individually read the R source 
files for a package using a 'pattern="\.R$"', and throw an error from 
'sys.source' displaying the file name, and other error messages from 
'parse'. This is simply a feature-request suggestion, but as Gabor 
advised, I should really develop my functions file-by-file.
+mt



From murdoch at stats.uwo.ca  Sun Oct 22 03:07:58 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 21 Oct 2006 21:07:58 -0400
Subject: [Rd] parse/INSTALL feature request(s)
In-Reply-To: <453AA0FB.9080502@sfu.ca>
References: <45396A81.8080808@sfu.ca> <45398188.4000709@stats.uwo.ca>
	<971536df0610202011u25f8ccfnba45dc9cc07f39d1@mail.gmail.com>
	<453AA0FB.9080502@sfu.ca>
Message-ID: <453AC46E.5060805@stats.uwo.ca>

On 10/21/2006 6:36 PM, Michael Toews wrote:
>> What would be possible is to do like other preprocessors do, and put
>> comments into the source file to indicate the origin of each line:  then
>> the parser could tell you the location in the original file, which would
>> be a lot more useful.
> 
> I think what you are referring to is already nicely implemented 

Thank you.

> (in 
> R/src/main/source.c lines 89 to 97), and the errors are correctly shown 
> in my example as lines 1222 to 1223. However, these line numbers are 
> irrelevant to the original files, as they been concatenated into one 
> large file (I think on line 765 of R/src/scripts/INSTALL.in ).

No, that's not what I was referring to.  Preprocessors put lines like

#line 3 "header.h"

into their output so that the compiler can put useful debugging 
information into files when it processes them.  R could do that when it 
concatenates the files, and then tell you the origin of each line, not 
the relatively useless line number from the concatenated file.  (A very 
simple version would add a record like that on every line, and that 
would work with the current error reporting system; a slightly more 
sophisticated version would just put those lines in between each 
concatenated file, and then the error reporting would need to be made 
aware of them.)

  This
> single file is loaded into an R environment (on line 790 of INSTALL.in), 
> which is also the region where my original error from 'R CMD INSTALL' 
> was thrown. The loading is done by the 'tools:::makeLazyLoading' 
> function, which loads in the single R-source file into a fresh 
> environment for the package.
> 
> I'm unsure of why a single R source file is needed in INSTALL (which 
> limits the ability to show any offending file names and their line 
> numbers). The functions in R/src/library/tools/R/makeLazyLoad.R could 
> perhaps be made a bit more versatile to individually read the R source 
> files for a package using a 'pattern="\.R$"', and throw an error from 
> 'sys.source' displaying the file name, and other error messages from 
> 'parse'. This is simply a feature-request suggestion, but as Gabor 
> advised, I should really develop my functions file-by-file.

I'm reasonably hopeful that version 2.5.0 will have more source level 
debugging support in it, at least to the level of the "slightly more 
sophisticated version", and maybe better than that.

If you'd like to help with this, you can see the (currently extremely 
unstable and incomplete) code on the djm-source branch in the 
repository.  No support for "#line" yet.

Duncan Murdoch



From deepayan.sarkar at gmail.com  Sun Oct 22 21:56:31 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Sun, 22 Oct 2006 12:56:31 -0700
Subject: [Rd] Getting hold of a package's environment from C code
Message-ID: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>

Hi,

I have a package where I'm calling an R function (say "foo") from C
code. "foo" is in the same package, but is not exported. I construct
the call using lang1(install("foo")), but to eval it I need the
package's environment.  Is there a way to do this? Passing the correct
environment through .Call() is not an option.

Right now, I'm getting the environment first using something like

  rho = PROTECT(eval(lang2(install("environment"), install("bar")),
R_GlobalEnv))

where bar _is_ exported. However, this doesn't work if the package is
loaded but not attached, and is also risky because someone might
define another "bar" that is found first.

One solution that might work is to make 'rho' a global variable and
assign the correct value when the package is loaded. Is that a good
idea? How should I PROTECT it?

-Deepayan



From murdoch at stats.uwo.ca  Sun Oct 22 22:28:06 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 22 Oct 2006 16:28:06 -0400
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
Message-ID: <453BD456.4050702@stats.uwo.ca>

On 10/22/2006 3:56 PM, Deepayan Sarkar wrote:
> Hi,
> 
> I have a package where I'm calling an R function (say "foo") from C
> code. "foo" is in the same package, but is not exported. I construct
> the call using lang1(install("foo")), but to eval it I need the
> package's environment.  Is there a way to do this? Passing the correct
> environment through .Call() is not an option.
> 
> Right now, I'm getting the environment first using something like
> 
>   rho = PROTECT(eval(lang2(install("environment"), install("bar")),
> R_GlobalEnv))
> 
> where bar _is_ exported. However, this doesn't work if the package is
> loaded but not attached, and is also risky because someone might
> define another "bar" that is found first.

In R code, you could use getNamespace("pkg") to get the namespace 
environment.  I haven't tried this, but I'd assume

PROTECT(rho = eval(lang2(install("getNamespace"),
                          ScalarString(mkChar("pkg"))));

(or something like it) would be the C equivalent.

 >
 > One solution that might work is to make 'rho' a global variable and
 > assign the correct value when the package is loaded. Is that a good
 > idea? How should I PROTECT it?

I'd say to avoid globals if you can, and I think you can here.

Duncan Murdoch



From antonio.fabio at gmail.com  Sun Oct 22 22:33:14 2006
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Sun, 22 Oct 2006 22:33:14 +0200
Subject: [Rd] utils::methods doesn't list methods of 'hidden' generics
Message-ID: <b0808fdc0610221333m2f31d882h350fb49e7076d2e7@mail.gmail.com>

Hi all.
I've seen that, on my R installation, utils::methods doesn't list
methods of generics whose name begins with a dot, and I can't see that
mentioned in utils::methods help page.

Antonio.

#########################################
> .foo <- function(x, ...) UseMethod(".foo")
> .foo.bar <- function(x, ...) {}
> methods(.foo)
no methods were found
> version
               _
platform       x86_64-unknown-linux-gnu
arch           x86_64
os             linux-gnu
system         x86_64, linux-gnu
status
major          2
minor          4.0
year           2006
month          10
day            03
svn rev        39566
language       R
version.string R version 2.4.0 (2006-10-03)



From deepayan.sarkar at gmail.com  Sun Oct 22 23:24:51 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Sun, 22 Oct 2006 14:24:51 -0700
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <453BD456.4050702@stats.uwo.ca>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
Message-ID: <eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>

On 10/22/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/22/2006 3:56 PM, Deepayan Sarkar wrote:
> > Hi,
> >
> > I have a package where I'm calling an R function (say "foo") from C
> > code. "foo" is in the same package, but is not exported. I construct
> > the call using lang1(install("foo")), but to eval it I need the
> > package's environment.  Is there a way to do this? Passing the correct
> > environment through .Call() is not an option.
> >
> > Right now, I'm getting the environment first using something like
> >
> >   rho = PROTECT(eval(lang2(install("environment"), install("bar")),
> > R_GlobalEnv))
> >
> > where bar _is_ exported. However, this doesn't work if the package is
> > loaded but not attached, and is also risky because someone might
> > define another "bar" that is found first.
>
> In R code, you could use getNamespace("pkg") to get the namespace
> environment.  I haven't tried this, but I'd assume
>
> PROTECT(rho = eval(lang2(install("getNamespace"),
>                           ScalarString(mkChar("pkg"))));
>
> (or something like it) would be the C equivalent.

Thanks, that works perfectly.

-Deepayan



From Robert.McGehee at geodecapital.com  Mon Oct 23 05:16:36 2006
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Sun, 22 Oct 2006 23:16:36 -0400
Subject: [Rd] Changing function arguments
Message-ID: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>

R-Developers,
I'm looking for some help computing on the R language.

I'm hoping to write a function that parses a language or expression
object and returns another expression with all instances of certain
argument of a given function altered. For instance, say I would like my
function, myFun to take an expression and whenever the argument 'x'
appears within the function FUN inside that expression, return an
altered expression in which 'x' is incremented by one.

Thus,
> x <- expression(FUN(x = 0) + log(FUN(x = 3)))
> myFun(x)
[1] expression(FUN(x = 1) + log(FUN(x = 4)))

Conceptually, it looks like I want to recursively break a language
object into its component functions, search for FUN and increment one of
its arguments ('x'), then reassemble and return the resulting
expression. However, I haven't been able to come up with a clean way to
do this. Suggestions would be greatly appreciated.

Thanks in advance,
Robert

Robert McGehee
Quantitative Analyst
Geode Capital Management, LLC
53 State Street, 5th Floor | Boston, MA | 02109
Tel: 617/392-8396    Fax:617/476-6389
mailto:robert.mcgehee at geodecapital.com



This e-mail, and any attachments hereto, are intended for us...{{dropped}}



From cberry at tajo.ucsd.edu  Mon Oct 23 05:59:15 2006
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Sun, 22 Oct 2006 20:59:15 -0700
Subject: [Rd] Changing function arguments
In-Reply-To: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <Pine.LNX.4.64.0610222028190.21767@tajo.ucsd.edu>


See

 	?body
 	?parse
 	?deparse
 	?gsub

> foo <- function(x) x+.1
> bar <- function(y) y+foo(x=1) + foo(x=2)
> bar(1)
[1] 4.2
> body(bar)
y + foo(x = 1) + foo(x = 2)
> body(bar) <- parse(text=gsub("x[ ]*=[ ]*([0-9])","x = 1 + \\1",deparse(body(bar))))
> bar(1)
[1] 6.2
> body(bar)
y + foo(x = 1 + 1) + foo(x = 1 + 2)
>

There are many, many ways to skin this cat.

The 'parse( text = ... )' is but one.

Operating on parsed objects without deparsing them is often 
preferred.

On Sun, 22 Oct 2006, McGehee, Robert wrote:

> R-Developers,
> I'm looking for some help computing on the R language.
>
> I'm hoping to write a function that parses a language or expression
> object and returns another expression with all instances of certain
> argument of a given function altered. For instance, say I would like my
> function, myFun to take an expression and whenever the argument 'x'
> appears within the function FUN inside that expression, return an
> altered expression in which 'x' is incremented by one.
>
> Thus,
>> x <- expression(FUN(x = 0) + log(FUN(x = 3)))
>> myFun(x)
> [1] expression(FUN(x = 1) + log(FUN(x = 4)))
>
> Conceptually, it looks like I want to recursively break a language
> object into its component functions, search for FUN and increment one of
> its arguments ('x'), then reassemble and return the resulting
> expression. However, I haven't been able to come up with a clean way to
> do this. Suggestions would be greatly appreciated.
>
> Thanks in advance,
> Robert
>
> Robert McGehee
> Quantitative Analyst
> Geode Capital Management, LLC
> 53 State Street, 5th Floor | Boston, MA | 02109
> Tel: 617/392-8396    Fax:617/476-6389
> mailto:robert.mcgehee at geodecapital.com
>
>
>
> This e-mail, and any attachments hereto, are intended for us...{{dropped}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                        (858) 534-2098
                                          Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	         UC San Diego
http://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0717



From sfalcon at fhcrc.org  Mon Oct 23 06:05:18 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Sun, 22 Oct 2006 21:05:18 -0700
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	(Deepayan Sarkar's message of "Sun, 22 Oct 2006 14:24:51 -0700")
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
Message-ID: <m2ac3n3ce9.fsf@ziti.fhcrc.org>

"Deepayan Sarkar" <deepayan.sarkar at gmail.com> writes:

> On 10/22/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> In R code, you could use getNamespace("pkg") to get the namespace
>> environment.  I haven't tried this, but I'd assume
>>
>> PROTECT(rho = eval(lang2(install("getNamespace"),
>>                           ScalarString(mkChar("pkg"))));
>>
>> (or something like it) would be the C equivalent.

Perhaps:

R_FindNamespace(mkString(where))


+ seth



From sfalcon at fhcrc.org  Mon Oct 23 06:29:01 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Sun, 22 Oct 2006 21:29:01 -0700
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <m2ac3n3ce9.fsf@ziti.fhcrc.org> (Seth Falcon's message of "Sun,
	22 Oct 2006 21:05:18 -0700")
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	<m2ac3n3ce9.fsf@ziti.fhcrc.org>
Message-ID: <m28xj71wqa.fsf@ziti.fhcrc.org>

Seth Falcon <sfalcon at fhcrc.org> writes:
> Perhaps:
>
> R_FindNamespace(mkString(where))

Sorry, this won't help you for package-level code as this function is
part of the internal use only API.  It would be nice to have access to
it or a similar function from C in package code.



From ggrothendieck at gmail.com  Mon Oct 23 07:13:26 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 23 Oct 2006 01:13:26 -0400
Subject: [Rd] Changing function arguments
In-Reply-To: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <971536df0610222213g4f08515sfd462dc7080c26a@mail.gmail.com>

Try this.  If the first arg of FUN is x then it increments it.

incrx <- function (e) {
    is.node <- function(x) is.symbol(x) || is.double(x)
    if (is.node(e)) return(e)
    if (is.name(e[[1]]) && e[[1]] == as.name("FUN") && names(e)[2] == "x")
        e[[2]] <- e[[2]] + 1
    for (i in 1:length(e)) e[[i]] <- incrx(e[[i]])
    return(e)
}

incrx(expression(FUN(x = 0) + log(FUN(x = 3))))


On 10/22/06, McGehee, Robert <Robert.McGehee at geodecapital.com> wrote:
> R-Developers,
> I'm looking for some help computing on the R language.
>
> I'm hoping to write a function that parses a language or expression
> object and returns another expression with all instances of certain
> argument of a given function altered. For instance, say I would like my
> function, myFun to take an expression and whenever the argument 'x'
> appears within the function FUN inside that expression, return an
> altered expression in which 'x' is incremented by one.
>
> Thus,
> > x <- expression(FUN(x = 0) + log(FUN(x = 3)))
> > myFun(x)
> [1] expression(FUN(x = 1) + log(FUN(x = 4)))
>
> Conceptually, it looks like I want to recursively break a language
> object into its component functions, search for FUN and increment one of
> its arguments ('x'), then reassemble and return the resulting
> expression. However, I haven't been able to come up with a clean way to
> do this. Suggestions would be greatly appreciated.
>
> Thanks in advance,
> Robert
>
> Robert McGehee
> Quantitative Analyst
> Geode Capital Management, LLC
> 53 State Street, 5th Floor | Boston, MA | 02109
> Tel: 617/392-8396    Fax:617/476-6389
> mailto:robert.mcgehee at geodecapital.com
>
>
>
> This e-mail, and any attachments hereto, are intended for us...{{dropped}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From ripley at stats.ox.ac.uk  Mon Oct 23 08:41:00 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 23 Oct 2006 07:41:00 +0100 (BST)
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610230738340.10335@gannet.stats.ox.ac.uk>

On Sun, 22 Oct 2006, Deepayan Sarkar wrote:

> On 10/22/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 10/22/2006 3:56 PM, Deepayan Sarkar wrote:
>>> Hi,
>>>
>>> I have a package where I'm calling an R function (say "foo") from C
>>> code. "foo" is in the same package, but is not exported. I construct
>>> the call using lang1(install("foo")), but to eval it I need the
>>> package's environment.  Is there a way to do this? Passing the correct
>>> environment through .Call() is not an option.
>>>
>>> Right now, I'm getting the environment first using something like
>>>
>>>   rho = PROTECT(eval(lang2(install("environment"), install("bar")),
>>> R_GlobalEnv))
>>>
>>> where bar _is_ exported. However, this doesn't work if the package is
>>> loaded but not attached, and is also risky because someone might
>>> define another "bar" that is found first.
>>
>> In R code, you could use getNamespace("pkg") to get the namespace
>> environment.  I haven't tried this, but I'd assume
>>
>> PROTECT(rho = eval(lang2(install("getNamespace"),
>>                           ScalarString(mkChar("pkg"))));
>>
>> (or something like it) would be the C equivalent.

mkString("pkg") is simpler than ScalarString(mkChar("pkg")).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ripley at stats.ox.ac.uk  Mon Oct 23 09:22:10 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 23 Oct 2006 08:22:10 +0100 (BST)
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <m28xj71wqa.fsf@ziti.fhcrc.org>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	<m2ac3n3ce9.fsf@ziti.fhcrc.org> <m28xj71wqa.fsf@ziti.fhcrc.org>
Message-ID: <Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>

On Sun, 22 Oct 2006, Seth Falcon wrote:

> Seth Falcon <sfalcon at fhcrc.org> writes:
>> Perhaps:
>>
>> R_FindNamespace(mkString(where))
>
> Sorry, this won't help you for package-level code as this function is
> part of the internal use only API.  It would be nice to have access to
> it or a similar function from C in package code.

Hmm, it is declared in Rinternals.h, which is the public header for 
manipulating R objects at C level.  As such it is available to packages, 
but as it is not documented in 'Writing R Extensions' it is subject to 
change.

R_FindNamespace is essentially the same code as Duncan M provided, so it 
is a pretty simple function.  (It still contains a test that namespaces 
are supported, and that seems long overdue for removal.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ripley at stats.ox.ac.uk  Mon Oct 23 09:43:38 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 23 Oct 2006 08:43:38 +0100 (BST)
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	<m2ac3n3ce9.fsf@ziti.fhcrc.org> <m28xj71wqa.fsf@ziti.fhcrc.org>
	<Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0610230831110.11172@gannet.stats.ox.ac.uk>

As far as I can tell from the original post, Deepayan asked for a way 
to find a package's namespace environment (rather than the package 
environment, <namespace:foo> not <package:foo>), so the subject line is 
subject to misinterpretation.

On Mon, 23 Oct 2006, Prof Brian Ripley wrote:

> On Sun, 22 Oct 2006, Seth Falcon wrote:
>
>> Seth Falcon <sfalcon at fhcrc.org> writes:
>>> Perhaps:
>>> 
>>> R_FindNamespace(mkString(where))
>> 
>> Sorry, this won't help you for package-level code as this function is
>> part of the internal use only API.  It would be nice to have access to
>> it or a similar function from C in package code.
>
> Hmm, it is declared in Rinternals.h, which is the public header for 
> manipulating R objects at C level.  As such it is available to packages, but 
> as it is not documented in 'Writing R Extensions' it is subject to change.
>
> R_FindNamespace is essentially the same code as Duncan M provided, so it is a 
> pretty simple function.  (It still contains a test that namespaces are 
> supported, and that seems long overdue for removal.)

I think Deepayan's original enquiry was about getting hold of a namespace 
environment from within an already loaded namespace.  That can be done 
entirely at C level, as we don't have the complication of possibly loading 
the namespace.  Just

     val = findVarInFrame(R_NamespaceRegistry, install("pkgname"));

does that job, with val == R_UnboundValue should the namespace not be 
loaded.  AFAICS, everything here is available to a package writer, and 
this is equally undocumented.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From luke at stat.uiowa.edu  Mon Oct 23 15:18:32 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon, 23 Oct 2006 08:18:32 -0500 (CDT)
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	<m2ac3n3ce9.fsf@ziti.fhcrc.org> <m28xj71wqa.fsf@ziti.fhcrc.org>
	<Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0610230817380.3414@itasca2.wildberry.org>

On Mon, 23 Oct 2006, Prof Brian Ripley wrote:

> On Sun, 22 Oct 2006, Seth Falcon wrote:
>
>> Seth Falcon <sfalcon at fhcrc.org> writes:
>>> Perhaps:
>>>
>>> R_FindNamespace(mkString(where))
>>
>> Sorry, this won't help you for package-level code as this function is
>> part of the internal use only API.  It would be nice to have access to
>> it or a similar function from C in package code.
>
> Hmm, it is declared in Rinternals.h, which is the public header for
> manipulating R objects at C level.  As such it is available to packages,
> but as it is not documented in 'Writing R Extensions' it is subject to
> change.
>
> R_FindNamespace is essentially the same code as Duncan M provided, so it
> is a pretty simple function.  (It still contains a test that namespaces
> are supported, and that seems long overdue for removal.)

Except for a small detail: the code in R_FindNamespace protects the
expression before callign eval -- this is needed since eval does not.

Best,

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From luke at stat.uiowa.edu  Mon Oct 23 15:23:20 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon, 23 Oct 2006 08:23:20 -0500 (CDT)
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <Pine.LNX.4.64.0610230831110.11172@gannet.stats.ox.ac.uk>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	<m2ac3n3ce9.fsf@ziti.fhcrc.org> <m28xj71wqa.fsf@ziti.fhcrc.org>
	<Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0610230831110.11172@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0610230819160.3414@itasca2.wildberry.org>

On Mon, 23 Oct 2006, Prof Brian Ripley wrote:

> As far as I can tell from the original post, Deepayan asked for a way
> to find a package's namespace environment (rather than the package
> environment, <namespace:foo> not <package:foo>), so the subject line is
> subject to misinterpretation.
>
> On Mon, 23 Oct 2006, Prof Brian Ripley wrote:
>
>> On Sun, 22 Oct 2006, Seth Falcon wrote:
>>
>>> Seth Falcon <sfalcon at fhcrc.org> writes:
>>>> Perhaps:
>>>>
>>>> R_FindNamespace(mkString(where))
>>>
>>> Sorry, this won't help you for package-level code as this function is
>>> part of the internal use only API.  It would be nice to have access to
>>> it or a similar function from C in package code.
>>
>> Hmm, it is declared in Rinternals.h, which is the public header for
>> manipulating R objects at C level.  As such it is available to packages, but
>> as it is not documented in 'Writing R Extensions' it is subject to change.
>>
>> R_FindNamespace is essentially the same code as Duncan M provided, so it is a
>> pretty simple function.  (It still contains a test that namespaces are
>> supported, and that seems long overdue for removal.)
>
> I think Deepayan's original enquiry was about getting hold of a namespace
> environment from within an already loaded namespace.  That can be done
> entirely at C level, as we don't have the complication of possibly loading
> the namespace.  Just
>
>     val = findVarInFrame(R_NamespaceRegistry, install("pkgname"));
>
> does that job, with val == R_UnboundValue should the namespace not be
> loaded.  AFAICS, everything here is available to a package writer, and
> this is equally undocumented.

This level of detail should remain undocumented as it might be useful
to change the representation at some point. R_FindNamespace is a safer
bet, and we probably should document it as officially available..

Best,

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From tlumley at u.washington.edu  Mon Oct 23 16:54:23 2006
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon, 23 Oct 2006 07:54:23 -0700 (PDT)
Subject: [Rd] Changing function arguments
In-Reply-To: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB5480211DDA481@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <Pine.LNX.4.64.0610230753420.29706@homer21.u.washington.edu>

On Sun, 22 Oct 2006, McGehee, Robert wrote:

> R-Developers,
> I'm looking for some help computing on the R language.
>
> I'm hoping to write a function that parses a language or expression
> object and returns another expression with all instances of certain
> argument of a given function altered. For instance, say I would like my
> function, myFun to take an expression and whenever the argument 'x'
> appears within the function FUN inside that expression, return an
> altered expression in which 'x' is incremented by one.
>

This sort of recursive parsing and modification is done by the bquote() 
function, so you could look there.

     -thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle



From Claudio.Lottaz at molgen.mpg.de  Mon Oct 23 17:13:18 2006
From: Claudio.Lottaz at molgen.mpg.de (Claudio Lottaz)
Date: Mon, 23 Oct 2006 17:13:18 +0200
Subject: [Rd] Excessive network load
Message-ID: <005401c6f6b5$c556ee80$70160e8d@molgen.mpg.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061023/c74b7892/attachment-0003.pl 

From Robert.McGehee at geodecapital.com  Mon Oct 23 18:06:06 2006
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Mon, 23 Oct 2006 12:06:06 -0400
Subject: [Rd] Changing function arguments
Message-ID: <67DCA285A2D7754280D3B8E88EB5480211DDA483@MSGBOSCLB2WIN.DMN1.FMR.COM>

Thanks all. Combining your suggestions, and marking up Gabor's example,
below is the function 'chgArg', which recursively goes through an
expression or language object looking for all functions that contain
'arg', and then incrementing that argument by 'offset'. 

The biggest improvement over the suggestions is that chgArg checks the
formals of the function such that if the user does not supply the
argument, but instead relies on the default, the function will still
increment. Also, 'match.call' is used to match the user's expression
with the function call in case one is relying on positional or partial
matching.

ex:
> FUN <- function(xx = 0, yy = 0, zz = 0) xx + yy + zz
> e <- substitute(FUN() + FUN(x = 5)/FUN(xx = 5) + FUN(1, 2, 3))
> chgArg(e, "xx", 1)
[1] FUN(xx = 1) + FUN(xx = 6)/FUN(xx = 6) + FUN(xx = 2, yy = 2, zz = 3)

The only surprise I came across was when I tried explicitly setting
name/value arguments for a call, the name did not "stick", as it would
with a list (though a call object is _clearly_ not a list).

> e <- substitute(FUN(2))
> e[["xx"]] <- 3
> names(e)
[1] NULL

Meaning, I had to explicitly build the call using 'call()'.

Thanks as always for the help,
Robert

chgArg <- function (e, arg, offset) {
    if (is.expression(e)) return(as.expression(Recall(e[[1]], arg = arg,
offset = offset)))
    if (is.symbol(e) || is.double(e)) return (e)
    if (is.function(get(as.character(e[[1]]))) &&
               arg %in% names(formals(as.character(e[[1]])))) {
        mc <- match.call(get(as.character(e[[1]])), e)
        curArg <- ifelse(is.null(mc[[arg]]),
formals(as.character(e[[1]]))[[arg]], mc[[arg]])
        allArgs <- as.list(mc[-1])
        allArgs[[arg]] <- curArg + offset
        e <- do.call("call", c(as.character(mc[[1]]), allArgs))
    }
    for (i in 1:length(e)) e[[i]] <- Recall(e[[i]], arg = arg, offset =
offset)
    return(e)
}

-----Original Message-----
From: Thomas Lumley [mailto:tlumley at u.washington.edu] 
Sent: Monday, October 23, 2006 10:54 AM
To: McGehee, Robert
Cc: R Development Mailing List
Subject: Re: [Rd] Changing function arguments

On Sun, 22 Oct 2006, McGehee, Robert wrote:

> R-Developers,
> I'm looking for some help computing on the R language.
>
> I'm hoping to write a function that parses a language or expression
> object and returns another expression with all instances of certain
> argument of a given function altered. For instance, say I would like
my
> function, myFun to take an expression and whenever the argument 'x'
> appears within the function FUN inside that expression, return an
> altered expression in which 'x' is incremented by one.
>

This sort of recursive parsing and modification is done by the bquote() 
function, so you could look there.

     -thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle



From deepayan.sarkar at gmail.com  Mon Oct 23 22:10:57 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Mon, 23 Oct 2006 13:10:57 -0700
Subject: [Rd] Getting hold of a package's environment from C code
In-Reply-To: <Pine.LNX.4.64.0610230819160.3414@itasca2.wildberry.org>
References: <eb555e660610221256g3952a408sc25f06afe8307cb5@mail.gmail.com>
	<453BD456.4050702@stats.uwo.ca>
	<eb555e660610221424kac664fanba7b998b12faaf1e@mail.gmail.com>
	<m2ac3n3ce9.fsf@ziti.fhcrc.org> <m28xj71wqa.fsf@ziti.fhcrc.org>
	<Pine.LNX.4.64.0610230810330.10964@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0610230831110.11172@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0610230819160.3414@itasca2.wildberry.org>
Message-ID: <eb555e660610231310k598e8522y90887c9d5eb08a5b@mail.gmail.com>

On 10/23/06, Luke Tierney <luke at stat.uiowa.edu> wrote:
> On Mon, 23 Oct 2006, Prof Brian Ripley wrote:
>
> > As far as I can tell from the original post, Deepayan asked for a way
> > to find a package's namespace environment (rather than the package
> > environment, <namespace:foo> not <package:foo>), so the subject line is
> > subject to misinterpretation.
> >
> > On Mon, 23 Oct 2006, Prof Brian Ripley wrote:
> >
> >> On Sun, 22 Oct 2006, Seth Falcon wrote:
> >>
> >>> Seth Falcon <sfalcon at fhcrc.org> writes:
> >>>> Perhaps:
> >>>>
> >>>> R_FindNamespace(mkString(where))
> >>>
> >>> Sorry, this won't help you for package-level code as this function is
> >>> part of the internal use only API.  It would be nice to have access to
> >>> it or a similar function from C in package code.
> >>
> >> Hmm, it is declared in Rinternals.h, which is the public header for
> >> manipulating R objects at C level.  As such it is available to packages, but
> >> as it is not documented in 'Writing R Extensions' it is subject to change.
> >>
> >> R_FindNamespace is essentially the same code as Duncan M provided, so it is a
> >> pretty simple function.  (It still contains a test that namespaces are
> >> supported, and that seems long overdue for removal.)
> >
> > I think Deepayan's original enquiry was about getting hold of a namespace
> > environment from within an already loaded namespace.  That can be done
> > entirely at C level, as we don't have the complication of possibly loading
> > the namespace.  Just
> >
> >     val = findVarInFrame(R_NamespaceRegistry, install("pkgname"));
> >
> > does that job, with val == R_UnboundValue should the namespace not be
> > loaded.  AFAICS, everything here is available to a package writer, and
> > this is equally undocumented.
>
> This level of detail should remain undocumented as it might be useful
> to change the representation at some point. R_FindNamespace is a safer
> bet, and we probably should document it as officially available..

OK, so I'm now using

   rho = PROTECT(R_FindNamespace(mkString("mypkg"))),

Thanks,
Deepayan



From deepayan.sarkar at gmail.com  Tue Oct 24 01:51:50 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Mon, 23 Oct 2006 16:51:50 -0700
Subject: [Rd] ANN/RFC: package providing TAB completion for readline-based R
Message-ID: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>

Announcement:

(For those every-once-in-a-while occasions when you run R from a
terminal instead of Emacs, and then wish something would happen when
you hit TAB...)

Last week, I started looking at the GNU Readline documentation to see
if I could figure out how to use it for command completion within R.
It turned out to be easier than I had expected, and I now have a beta
version of the 'rcompletion' package available at

http://www.stat.wisc.edu/~deepayan/R/rcompletion_0.0-6.tar.gz

>From the help page:

Description:

     This package provides pseudo-intelligent TAB completion for a
     readline enabled instance of R when it is run from a terminal (or
     more specifically, an interface which uses readline to accept user
     input). It has no effect on the various GUI interfaces to R,
     including ESS and the standard Windows interface.

For more details, install and load the package, then type

package?rcompletion

at the R prompt. Testing and feedback would be appreciated. Feature
requests and patches are also welcome, of course.


Questions:

There are a couple of things about which I would like some advice:

(1) The package currently contains a very rudimentary configure script
which stops installation when readline is not found. I'm not sure if
this is portable enough. .../src/unix/sys-std.c has more sophisticated
conditional directives, but I don't know enough about this sort of
thing to interpret those. Any thoughts or suggestions on this would be
appreciated.

(2) What's the recommended procedure to distribute this, given that
(a) it's not relevant on Windows (i.e. won't do anything even if it
could be installed) and (b) may or may not be relevant on Macs, some
of which apparently have a fake readline that doesn't support
completion?

-Deepayan



From edd at debian.org  Tue Oct 24 03:50:55 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 23 Oct 2006 20:50:55 -0500
Subject: [Rd] ANN/RFC: package providing TAB completion for
	readline-based R
In-Reply-To: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
References: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
Message-ID: <17725.29055.367514.571245@basebud.nulle.part>


On 23 October 2006 at 16:51, Deepayan Sarkar wrote:
[... nice announcement trimmed ...]
| There are a couple of things about which I would like some advice:
| 
| (1) The package currently contains a very rudimentary configure script
| which stops installation when readline is not found. I'm not sure if
| this is portable enough. .../src/unix/sys-std.c has more sophisticated
| conditional directives, but I don't know enough about this sort of
| thing to interpret those. Any thoughts or suggestions on this would be
| appreciated.

littler has the same issue for getopt, R itself, R as a dynamic library,
....  So far, we are going with 'just bark and stop'.

For rcompletion, I hope you simply stick with configure.  I don't like the
trend of shipping everything again and again (Hi, Seth :)

| (2) What's the recommended procedure to distribute this, given that
| (a) it's not relevant on Windows (i.e. won't do anything even if it
| could be installed) and (b) may or may not be relevant on Macs, some
| of which apparently have a fake readline that doesn't support
| completion?

Again, I also wondered if littler should just pretend to be a CRAN package so
that at least the update and compile mechanism works from R (given how we
need re-runs of configure and make if something changes as we depend on
compile-time 'hard' settings for littler as opposed to env. vars for R).

The problem we are facing is that we're unsure how to get to
/usr/(local/)/bin from update.packages() ...

Given that you'll undoubtedly come up with something clever, Jeff and I will
be sure to see if we can mimic it :)

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From deepayan.sarkar at gmail.com  Tue Oct 24 07:15:14 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Mon, 23 Oct 2006 22:15:14 -0700
Subject: [Rd] ANN/RFC: package providing TAB completion for
	readline-based R
In-Reply-To: <17725.29055.367514.571245@basebud.nulle.part>
References: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
	<17725.29055.367514.571245@basebud.nulle.part>
Message-ID: <eb555e660610232215w32e2c10dx41a33a0c90fb8c87@mail.gmail.com>

On 10/23/06, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 23 October 2006 at 16:51, Deepayan Sarkar wrote:
> [... nice announcement trimmed ...]
> | There are a couple of things about which I would like some advice:
> |
> | (1) The package currently contains a very rudimentary configure script
> | which stops installation when readline is not found. I'm not sure if
> | this is portable enough. .../src/unix/sys-std.c has more sophisticated
> | conditional directives, but I don't know enough about this sort of
> | thing to interpret those. Any thoughts or suggestions on this would be
> | appreciated.
>
> littler has the same issue for getopt, R itself, R as a dynamic library,
> ....  So far, we are going with 'just bark and stop'.
>
> For rcompletion, I hope you simply stick with configure.  I don't like the
> trend of shipping everything again and again (Hi, Seth :)
>
> | (2) What's the recommended procedure to distribute this, given that
> | (a) it's not relevant on Windows (i.e. won't do anything even if it
> | could be installed) and (b) may or may not be relevant on Macs, some
> | of which apparently have a fake readline that doesn't support
> | completion?
>
> Again, I also wondered if littler should just pretend to be a CRAN package so
> that at least the update and compile mechanism works from R (given how we
> need re-runs of configure and make if something changes as we depend on
> compile-time 'hard' settings for littler as opposed to env. vars for R).
>
> The problem we are facing is that we're unsure how to get to
> /usr/(local/)/bin from update.packages() ...
>
> Given that you'll undoubtedly come up with something clever, Jeff and
> I will be sure to see if we can mimic it :)

Well, rcompletion is a proper package, the only issue is that it's
platform / environment dependent. I know there are other such
packages, I just don't know how they are dealt with.

I don't see how you can get around the /usr/bin problem for littler,
except by asking the user to manually do something like

ln -s /path/to/library/littler/bin/r /usr/local/bin/

which at least wouldn't have to be repeated on further upgrades if you
detect that the link exists.

-Deepayan



From ripley at stats.ox.ac.uk  Tue Oct 24 08:57:42 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 24 Oct 2006 07:57:42 +0100 (BST)
Subject: [Rd] Excessive network load
In-Reply-To: <005401c6f6b5$c556ee80$70160e8d@molgen.mpg.de>
References: <005401c6f6b5$c556ee80$70160e8d@molgen.mpg.de>
Message-ID: <Pine.LNX.4.64.0610240742040.31577@gannet.stats.ox.ac.uk>

You haven't even told us your OS!

The simple solution is to use a local copy of R.  It is probably the case 
that few of those 1500 packages are used, and certainly that few are used 
in each R session: you may also want to install locally any that are 
heavily used.

We found it advantageous to do this for Windows users of R (where the 
remote discs are mounted by SMB) quite a while ago, and more recently 
moved to local installation of R on Linux machines.  The issue was not 
network load but latency for interactive users: although R is heavily used 
here it is not a major component of our network load and we are rather 
protecting R users against other applications that are much more 
demanding.

On Mon, 23 Oct 2006, Claudio Lottaz wrote:

> Dear all,
>
> I wonder, if anybody experiences similar problems and if there are any 
> simple solutions to be suggested. We observe that R causes a lot of 
> network traffic and thus slows down the performance of the whole 
> network. When tracing the network traffic on the machine which serves 
> the R installation via NFS, we see thousands of requests at 
> initialization of R processes and regular calls, probably to shared 
> libraries. Is there a way to compile or run R such that it causes less 
> load on the network?
>
> Here is some information  on our installation:
> - We use a single installation of R (version 2.3.1) loaded over NFS
> - there are approximately 1500 packages installed using ~8GB of disk
> - We use R on a queuing system running up to 50 processes in parallel
>
> The load on the machine which serves the R installation frequently rises up to 5 or so although it is a dedicated machine.
> Any hints towards measures against network load are highly appreciated.
>
> Thanks,
> Claudio
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From ligges at statistik.uni-dortmund.de  Tue Oct 24 09:53:13 2006
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue, 24 Oct 2006 09:53:13 +0200
Subject: [Rd] ANN/RFC: package providing TAB completion for
 readline-based R
In-Reply-To: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
References: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
Message-ID: <453DC669.9070605@statistik.uni-dortmund.de>



Deepayan Sarkar wrote:
> Announcement:
> 
> (For those every-once-in-a-while occasions when you run R from a
> terminal instead of Emacs, and then wish something would happen when
> you hit TAB...)
> 
> Last week, I started looking at the GNU Readline documentation to see
> if I could figure out how to use it for command completion within R.
> It turned out to be easier than I had expected, and I now have a beta
> version of the 'rcompletion' package available at
> 
> http://www.stat.wisc.edu/~deepayan/R/rcompletion_0.0-6.tar.gz
> 
>>From the help page:
> 
> Description:
> 
>      This package provides pseudo-intelligent TAB completion for a
>      readline enabled instance of R when it is run from a terminal (or
>      more specifically, an interface which uses readline to accept user
>      input). It has no effect on the various GUI interfaces to R,
>      including ESS and the standard Windows interface.
> 
> For more details, install and load the package, then type
> 
> package?rcompletion
> 
> at the R prompt. Testing and feedback would be appreciated. Feature
> requests and patches are also welcome, of course.
> 
> 
> Questions:
> 
> There are a couple of things about which I would like some advice:
> 
> (1) The package currently contains a very rudimentary configure script
> which stops installation when readline is not found. I'm not sure if
> this is portable enough. .../src/unix/sys-std.c has more sophisticated
> conditional directives, but I don't know enough about this sort of
> thing to interpret those. Any thoughts or suggestions on this would be
> appreciated.
> 
> (2) What's the recommended procedure to distribute this, given that
> (a) it's not relevant on Windows (i.e. won't do anything even if it
> could be installed) and (b) may or may not be relevant on Macs, some
> of which apparently have a fake readline that doesn't support
> completion?


Distribution can happen regularly as a CRAN package. I will put it on my 
exclude list in order not to try building Windows binaries in that case.

Uwe


> -Deepayan
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From ripley at stats.ox.ac.uk  Tue Oct 24 10:52:50 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 24 Oct 2006 09:52:50 +0100 (BST)
Subject: [Rd] ANN/RFC: package providing TAB completion for
 readline-based R
In-Reply-To: <453DC669.9070605@statistik.uni-dortmund.de>
References: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
	<453DC669.9070605@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.64.0610240900100.32267@gannet.stats.ox.ac.uk>

On Tue, 24 Oct 2006, Uwe Ligges wrote:

>
>
> Deepayan Sarkar wrote:
>> Announcement:
>>
>> (For those every-once-in-a-while occasions when you run R from a
>> terminal instead of Emacs, and then wish something would happen when
>> you hit TAB...)
>>
>> Last week, I started looking at the GNU Readline documentation to see
>> if I could figure out how to use it for command completion within R.
>> It turned out to be easier than I had expected, and I now have a beta
>> version of the 'rcompletion' package available at
>>
>> http://www.stat.wisc.edu/~deepayan/R/rcompletion_0.0-6.tar.gz
>>
>>> From the help page:
>>
>> Description:
>>
>>      This package provides pseudo-intelligent TAB completion for a
>>      readline enabled instance of R when it is run from a terminal (or
>>      more specifically, an interface which uses readline to accept user
>>      input). It has no effect on the various GUI interfaces to R,
>>      including ESS and the standard Windows interface.
>>
>> For more details, install and load the package, then type
>>
>> package?rcompletion
>>
>> at the R prompt. Testing and feedback would be appreciated. Feature
>> requests and patches are also welcome, of course.
>>
>>
>> Questions:
>>
>> There are a couple of things about which I would like some advice:
>>
>> (1) The package currently contains a very rudimentary configure script
>> which stops installation when readline is not found. I'm not sure if
>> this is portable enough. .../src/unix/sys-std.c has more sophisticated
>> conditional directives, but I don't know enough about this sort of
>> thing to interpret those. Any thoughts or suggestions on this would be
>> appreciated.

I don't think that is safe.  You can have R installed with readline 
support even if there are neither readline headers nor library on the 
current machine (use a static library), and R can be run without readline 
(via --no-readline) even if it is installed.

However, your configure script fails on my machine (x86_64 FC5).  It seems 
that you need both to get LDFLAGS and LD_LIBRARY_PATH from R and use them, 
and also use a version of autoconf that knows about lib64 (since the 
readline DSO is in /usr/lib64).  Since I don't get any further I am not 
sure what really happens, but it seems you don't link your DLL against 
-lreadline, and I think you need to to allow for static libreadline.a (the 
relevant code seems to be a separate .o and so is likely not linked into R 
in that case).

I guess that you want to know that R was installed with readline support 
at install time, and is running with the readline console?  It is not 
immediately obvious to me that either is currently known to a package 
writer/user.

>> (2) What's the recommended procedure to distribute this, given that
>> (a) it's not relevant on Windows (i.e. won't do anything even if it
>> could be installed) and (b) may or may not be relevant on Macs, some
>> of which apparently have a fake readline that doesn't support
>> completion?
>
>
> Distribution can happen regularly as a CRAN package. I will put it on my
> exclude list in order not to try building Windows binaries in that case.

I think there should also be a configure.win which explains that the 
package is not usable on Windows, in case someone tries to install from 
the sources.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595



From sebastien.villemot at ens.fr  Tue Oct 24 11:55:17 2006
From: sebastien.villemot at ens.fr (sebastien.villemot at ens.fr)
Date: Tue, 24 Oct 2006 11:55:17 +0200 (CEST)
Subject: [Rd] Variables ordering problem in mle() (PR#9313)
Message-ID: <20061024095517.CFEDFA1AA@slim.kubism.ku.dk>

Full_Name: S?bastien Villemot
Version: 2.4.0
OS: Debian testing
Submission from: (NULL) (62.212.121.128)


Hi,

In the mle() function of the stats4 package, there is a bug in the ordering of
the variables given in the 'start' argument.

By just changing the order of the variables listed in the 'start' list (the
initialization values), it is possible to obtain different estimation results
(actually different local minima).

The bug is easy to reproduce, with the following example:

> library(stats4)
> g <- function(x, y) -cos(x) + abs(y)
> mle(g, start = list(x = 0, y = 7))

Call:
mle(minuslogl = g, start = list(x = 0, y = 7))

Coefficients:
           x            y 
0.000000e+00 1.409463e-18 

> mle(g, start = list(y = 7, x = 0))

Call:
mle(minuslogl = g, start = list(y = 7, x = 0))

Coefficients:
       x        y 
6.283185 0.000000 


The problem comes from the reordering of the 'start' list at the following line
of the body of 'mle':
  start <- start[order(oo)]
which is not accompanied by a reordering of the 'nm' list used in the 'f' local
function at:
    names(l) <- nm

Greets,

S.V.


> sessionInfo()
R version 2.4.0 (2006-10-03)
i486-pc-linux-gnu

locale:
LC_CTYPE=fr_FR.UTF-8;LC_NUMERIC=C;LC_TIME=fr_FR.UTF-8;LC_COLLATE=fr_FR.UTF-8;LC_MONETARY=fr_FR.UTF-8;LC_MESSAGES=fr_FR.UTF-8;LC_PAPER=fr_FR.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=fr_FR.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] "stats4"    "methods"   "stats"     "graphics"  "grDevices" "utils"
[7] "datasets"  "base"



From fuss-h at ulster.ac.uk  Tue Oct 24 18:38:18 2006
From: fuss-h at ulster.ac.uk (fuss-h at ulster.ac.uk)
Date: Tue, 24 Oct 2006 18:38:18 +0200 (CEST)
Subject: [Rd] Statusbar help sometimes displays wrong function (PR#9314)
Message-ID: <20061024163818.808B4561F0@slim.kubism.ku.dk>

Full_Name: Hendrik Fu?
Version: 2.4.0
OS: Mac OS 10.4.8
Submission from: (NULL) (201.43.91.248)


Steps to reproduce the bug:

Define the function

  my.mean = function(x,y) (x+y)/2

then type "my.m" in the interactive shell and press TAB. "my.mean(" appears at
the input prompt, but the status bar displays synopsis for mean() rather than
my.mean().



From pgilbert at bank-banque-canada.ca  Tue Oct 24 18:58:20 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 24 Oct 2006 12:58:20 -0400
Subject: [Rd] as.missing
Message-ID: <453E462C.6050103@bank-banque-canada.ca>

(I'm not sure if this is a request for a feature, or another instance 
where a feature has eluded me for many years.)

Often I have a function which calls other functions, and may often use 
the default arguments to those functions, but needs the capability to 
pass along non-default choices. I usually do this with some variation on

foo <- function(x, foo2Args=NULL or a list(foo2defaults),
                    foo3Args=NULL or a list(foo3defaults))

and then have logic to check for NULL, or use the list in combination 
with do.call.  It is also possible to do this with ..., but it always 
seems a bit dangerous passing all the unnamed arguments along to all the 
functions being called, especially when I always seem to be calling 
functions that have similar arguments (maxit, eps, start, frequency, etc).

It is a situation I have learned to live with, but one of my 
co-maintainers just pointed out to me that there should be a good way to 
do this in R.  Perhaps there is something else I have missed all these 
years?  Is there a way to do this cleanly? It would be nice to have 
something like

foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())

then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but 
these would get treated as if they were missing, unless they are given 
other values.

Paul Gilbert
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From murdoch at stats.uwo.ca  Tue Oct 24 19:53:40 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 24 Oct 2006 13:53:40 -0400
Subject: [Rd] as.missing
In-Reply-To: <453E462C.6050103@bank-banque-canada.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
Message-ID: <453E5324.60103@stats.uwo.ca>

On 10/24/2006 12:58 PM, Paul Gilbert wrote:
> (I'm not sure if this is a request for a feature, or another instance 
> where a feature has eluded me for many years.)
> 
> Often I have a function which calls other functions, and may often use 
> the default arguments to those functions, but needs the capability to 
> pass along non-default choices. I usually do this with some variation on
> 
> foo <- function(x, foo2Args=NULL or a list(foo2defaults),
>                     foo3Args=NULL or a list(foo3defaults))
> 
> and then have logic to check for NULL, or use the list in combination 
> with do.call.  It is also possible to do this with ..., but it always 
> seems a bit dangerous passing all the unnamed arguments along to all the 
> functions being called, especially when I always seem to be calling 
> functions that have similar arguments (maxit, eps, start, frequency, etc).
> 
> It is a situation I have learned to live with, but one of my 
> co-maintainers just pointed out to me that there should be a good way to 
> do this in R.  Perhaps there is something else I have missed all these 
> years?  Is there a way to do this cleanly? It would be nice to have 
> something like
> 
> foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())
> 
> then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but 
> these would get treated as if they were missing, unless they are given 
> other values.

I was going to say I couldn't see the difference between this and just 
declaring

  foo <- function(x, foo2Args, foo3Args)

with no defaults.  However, this little demo illustrates the point, I think:

 > g <- function(gnodef, gdef=1) {
+    if (missing(gnodef)) cat('gnodef is missing\n')
+    if (missing(gdef)) cat('gdef is missing\n')
+    cat('gdef is ',gdef,'\n')
+  }
 >
 >  f <- function(fnodef, fdef) {
+    g(fnodef, fdef)
+  }
 >
 >  g()
gnodef is missing
gdef is missing
gdef is  1
 >  f()
gnodef is missing
gdef is missing
Error in cat("gdef is ", gdef, "\n") : argument "fdef" is missing, with 
no default


What would be nice to be able to do is to have a simple way for f() to 
act just like g() does.

Duncan Murdoch



From cberry at tajo.ucsd.edu  Tue Oct 24 22:55:36 2006
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Tue, 24 Oct 2006 13:55:36 -0700
Subject: [Rd] as.missing
In-Reply-To: <453E5324.60103@stats.uwo.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
	<453E5324.60103@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0610241355040.8001@tajo.ucsd.edu>

On Tue, 24 Oct 2006, Duncan Murdoch wrote:

> On 10/24/2006 12:58 PM, Paul Gilbert wrote:
>> (I'm not sure if this is a request for a feature, or another instance
>> where a feature has eluded me for many years.)
>>
>> Often I have a function which calls other functions, and may often use
>> the default arguments to those functions, but needs the capability to
>> pass along non-default choices. I usually do this with some variation on
>>
>> foo <- function(x, foo2Args=NULL or a list(foo2defaults),
>>                     foo3Args=NULL or a list(foo3defaults))
>>
>> and then have logic to check for NULL, or use the list in combination
>> with do.call.  It is also possible to do this with ..., but it always
>> seems a bit dangerous passing all the unnamed arguments along to all the
>> functions being called, especially when I always seem to be calling
>> functions that have similar arguments (maxit, eps, start, frequency, etc).
>>
>> It is a situation I have learned to live with, but one of my
>> co-maintainers just pointed out to me that there should be a good way to
>> do this in R.  Perhaps there is something else I have missed all these
>> years?  Is there a way to do this cleanly? It would be nice to have
>> something like
>>
>> foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())
>>
>> then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but
>> these would get treated as if they were missing, unless they are given
>> other values.
>
> I was going to say I couldn't see the difference between this and just
> declaring
>
>  foo <- function(x, foo2Args, foo3Args)
>
> with no defaults.  However, this little demo illustrates the point, I think:
>
> > g <- function(gnodef, gdef=1) {
> +    if (missing(gnodef)) cat('gnodef is missing\n')
> +    if (missing(gdef)) cat('gdef is missing\n')
> +    cat('gdef is ',gdef,'\n')
> +  }
> >
> >  f <- function(fnodef, fdef) {
> +    g(fnodef, fdef)
> +  }
> >
> >  g()
> gnodef is missing
> gdef is missing
> gdef is  1
> >  f()
> gnodef is missing
> gdef is missing
> Error in cat("gdef is ", gdef, "\n") : argument "fdef" is missing, with
> no default
>
>
> What would be nice to be able to do is to have a simple way for f() to
> act just like g() does.


Is this what you want?

>   f <- function(fnodef, fdef=NULL) {
+ g()}
> f()
gnodef is missing
gdef is missing
gdef is  1
>

>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                        (858) 534-2098
                                          Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	         UC San Diego
http://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0717



From p.dalgaard at biostat.ku.dk  Tue Oct 24 23:12:10 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 24 Oct 2006 23:12:10 +0200
Subject: [Rd] as.missing
In-Reply-To: <Pine.LNX.4.64.0610241355040.8001@tajo.ucsd.edu>
References: <453E462C.6050103@bank-banque-canada.ca>
	<453E5324.60103@stats.uwo.ca>
	<Pine.LNX.4.64.0610241355040.8001@tajo.ucsd.edu>
Message-ID: <x2wt6pe7v9.fsf@turmalin.kubism.ku.dk>

"Charles C. Berry" <cberry at tajo.ucsd.edu> writes:

> On Tue, 24 Oct 2006, Duncan Murdoch wrote:

> > with no defaults.  However, this little demo illustrates the point, I think:
> >
> > > g <- function(gnodef, gdef=1) {
> > +    if (missing(gnodef)) cat('gnodef is missing\n')
> > +    if (missing(gdef)) cat('gdef is missing\n')
> > +    cat('gdef is ',gdef,'\n')
> > +  }
> > >
> > >  f <- function(fnodef, fdef) {
> > +    g(fnodef, fdef)
> > +  }
> > >
> > >  g()
> > gnodef is missing
> > gdef is missing
> > gdef is  1
> > >  f()
> > gnodef is missing
> > gdef is missing
> > Error in cat("gdef is ", gdef, "\n") : argument "fdef" is missing, with
> > no default
> >
> >
> > What would be nice to be able to do is to have a simple way for f() to
> > act just like g() does.
> 
> 
> Is this what you want?
> 
> >   f <- function(fnodef, fdef=NULL) {
> + g()}
> > f()
> gnodef is missing
> gdef is missing
> gdef is  1

I think not. More like 

  f <- function(fnodef, fdef) {
    if(missing(fdef)) g(fnodef) else  g(fnodef, fdef) 
  }

(the generalization of which is obviously a pain...)



-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From A.Robinson at ms.unimelb.edu.au  Wed Oct 25 00:25:09 2006
From: A.Robinson at ms.unimelb.edu.au (A.Robinson at ms.unimelb.edu.au)
Date: Wed, 25 Oct 2006 00:25:09 +0200 (CEST)
Subject: [Rd] Cook's Distance in GLM (PR#9316)
Message-ID: <20061024222509.A5062B186@slim.kubism.ku.dk>

Hi Community,

I'm trying to reconcile Cook's Distances computed in glm.  The
following snippet of code shows that the Cook's Distances contours on
the plot of Residuals v Leverage do not seem to be the same as the
values produced by cooks.distance() or in the Cook's Distance against
observation number plot.

counts <- c(18,17,15,20,10,20,25,13,12)
outcome <- gl(3,1,9)
treatment <- gl(3,3)
d.AD <- data.frame(treatment, outcome, counts)
glm.D93 <- glm(counts ~ outcome + treatment, family=poisson())

opar <- par(mfrow=c(2,1))
plot(glm.D93, which=c(4,5))
par(opar)

cooks.distance(glm.D93)

The difference is reasonably moderate in this case.  My suspicions
were aroused by a case in which the plot showed five or size points
greater than 1, none of which could be identified in the output of the
function. 

> version  
               _                                          
platform       i386-unknown-freebsd6.1                    
arch           i386                                       
os             freebsd6.1                                 
system         i386, freebsd6.1                           
status         Patched                                    
major          2                                          
minor          4.0                                        
year           2006                                       
month          10                                         
day            03                                         
svn rev        39576                                      
language       R                                          
version.string R version 2.4.0 Patched (2006-10-03 r39576)


Cheers

Andrew

-- 
Andrew Robinson  
Department of Mathematics and Statistics            Tel: +61-3-8344-9763
University of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599
http://www.ms.unimelb.edu.au/~andrewpr
http://blogs.mbs.edu/fishing-in-the-bay/



From p.dalgaard at biostat.ku.dk  Wed Oct 25 00:53:46 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 25 Oct 2006 00:53:46 +0200
Subject: [Rd] Cook's Distance in GLM (PR#9316)
In-Reply-To: <20061024222509.A5062B186@slim.kubism.ku.dk>
References: <20061024222509.A5062B186@slim.kubism.ku.dk>
Message-ID: <x2y7r5s4ud.fsf@turmalin.kubism.ku.dk>

A.Robinson at ms.unimelb.edu.au writes:

> Hi Community,
> 
> I'm trying to reconcile Cook's Distances computed in glm.  The
> following snippet of code shows that the Cook's Distances contours on
> the plot of Residuals v Leverage do not seem to be the same as the
> values produced by cooks.distance() or in the Cook's Distance against
> observation number plot.
> 
> counts <- c(18,17,15,20,10,20,25,13,12)
> outcome <- gl(3,1,9)
> treatment <- gl(3,3)
> d.AD <- data.frame(treatment, outcome, counts)
> glm.D93 <- glm(counts ~ outcome + treatment, family=poisson())
> 
> opar <- par(mfrow=c(2,1))
> plot(glm.D93, which=c(4,5))
> par(opar)
> 
> cooks.distance(glm.D93)
> 
> The difference is reasonably moderate in this case.  My suspicions
> were aroused by a case in which the plot showed five or size points
> greater than 1, none of which could be identified in the output of the
> function. 

Hmm, yes. A good guess is that the contour levels need to be modified
by a dispersion factor. The plot is much more consistent with

cooks.distance(glm.D93,dispersion=5.129/4 )

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.murrell at auckland.ac.nz  Wed Oct 25 04:24:50 2006
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Wed, 25 Oct 2006 15:24:50 +1300
Subject: [Rd] stack imbalance in contour
In-Reply-To: <x2y7s06wis.fsf@turmalin.kubism.ku.dk>
References: <451FA276.2070902@pburns.seanet.com>
	<x2y7s06wis.fsf@turmalin.kubism.ku.dk>
Message-ID: <453ECAF2.4010103@stat.auckland.ac.nz>

Hi


Peter Dalgaard wrote:
> Patrick Burns <pburns at pburns.seanet.com> writes:
> 
>> I'm not sure if this has much significance or not -- but
>> it sounds rather ominous.  It doesn't appear to be new
>> as it happens with 2.0.0 in Linux (but the formatting of
>> the warning messages has improved).
>>
>>  > contour(array(3e10, c(10,10), list(1:10, 11:20)))
>> Warning: stack imbalance in 'contour', 20 then 24
>> Warning: stack imbalance in '.Internal', 19 then 23
>> Warning: stack imbalance in '{', 17 then 21
>> Warning message:
>> all z values are equal
>>  > sessionInfo()
>> R version 2.4.0 RC (2006-09-27 r39543)
>> i386-pc-mingw32
> 
> I see it on Linux too. It's a serious programming error in that
> something has its PROTECT/UNPROTECT mechanism messed up. Fortunately,
> it is protecting too much, which is not usually fatal. Also, it
> appears to happen only in the all z equal case (the value 3e10 is
> not magic - any nonzero z will do). We should get it tracked down,
> but it's not worth breaking the code freeze for 2.4.0 over.


Now fixed in r-devel and r-patched.

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/



From deepayan.sarkar at gmail.com  Wed Oct 25 04:52:09 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Tue, 24 Oct 2006 19:52:09 -0700
Subject: [Rd] ANN/RFC: package providing TAB completion for
	readline-based R
In-Reply-To: <Pine.LNX.4.64.0610240900100.32267@gannet.stats.ox.ac.uk>
References: <eb555e660610231651q7a2c399ch3dff71bad6abf246@mail.gmail.com>
	<453DC669.9070605@statistik.uni-dortmund.de>
	<Pine.LNX.4.64.0610240900100.32267@gannet.stats.ox.ac.uk>
Message-ID: <eb555e660610241952x749791d4j4616ccc67342851@mail.gmail.com>

On 10/24/06, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> On Tue, 24 Oct 2006, Uwe Ligges wrote:
[...]
> >> Questions:
> >>
> >> There are a couple of things about which I would like some advice:
> >>
> >> (1) The package currently contains a very rudimentary configure script
> >> which stops installation when readline is not found. I'm not sure if
> >> this is portable enough. .../src/unix/sys-std.c has more sophisticated
> >> conditional directives, but I don't know enough about this sort of
> >> thing to interpret those. Any thoughts or suggestions on this would be
> >> appreciated.
>
> I don't think that is safe.  You can have R installed with readline
> support even if there are neither readline headers nor library on the
> current machine (use a static library), and R can be run without readline
> (via --no-readline) even if it is installed.

I don't think the last case is a problem; nothing useful will happen
after loading the package in that case, but nothing bad will happen
either. If there's no readline library, is there anything the
configure script can reasonably do other than abort? If the library is
there but the headers aren't, I can probably use headers included in
the package. Is that a reasonable approach? I have no idea what to do
with a static library.

> However, your configure script fails on my machine (x86_64 FC5).

Fails in what sense? Does it abort saying it didn't find readline?

> It seems
> that you need both to get LDFLAGS and LD_LIBRARY_PATH from R and use them,
> and also use a version of autoconf that knows about lib64 (since the
> readline DSO is in /usr/lib64).  Since I don't get any further I am not
> sure what really happens, but it seems you don't link your DLL against
> -lreadline, and I think you need to to allow for static libreadline.a (the
> relevant code seems to be a separate .o and so is likely not linked into R
> in that case).

I have modified configure.in to add a -lreadline to PKG_LIBS, and also
to use header files from within the package if the system headers are
not found. The new version is at

http://www.stat.wisc.edu/~deepayan/R/rcompletion_0.0-7.tar.gz

I'm working on a 64 bit system, so I'm hoping autoconf knows what to
do there. I'm not sure how to get or use LDFLAGS and LD_LIBRARY_PATH
from R. R CMD config LDFLAGS does give me something (but I'm not sure
what to do with it), but there doesn't seem to be anything analogous
to LD_LIBRARY_PATH.

> I guess that you want to know that R was installed with readline support
> at install time, and is running with the readline console?  It is not
> immediately obvious to me that either is currently known to a package
> writer/user.

I don't think that's as much of an issue. If R doesn't ever make a
call to readline(), whether  the rcompletion package is loaded or not
won't make any difference. The user won't get the benefits, but that's
a choice made by the user. For example, running R through ESS and then
loading rcompletion doesn't have any effect at all.

The one scenario that definitely needs to be avoided is where R CMD
INSTALL appears to install the package successfully and then
library(rcompletion) causes an error (either immediately on load or
later). Unless anyone reports seeing that, I'll plan to upload this to
CRAN in a few days.

Cases where configure aborts even though it shouldn't will probably
need some time (and help) to work out, since I'm completely new to
autotools.


> >> (2) What's the recommended procedure to distribute this, given that
> >> (a) it's not relevant on Windows (i.e. won't do anything even if it
> >> could be installed) and (b) may or may not be relevant on Macs, some
> >> of which apparently have a fake readline that doesn't support
> >> completion?
> >
> >
> > Distribution can happen regularly as a CRAN package. I will put it on my
> > exclude list in order not to try building Windows binaries in that case.
>
> I think there should also be a configure.win which explains that the
> package is not usable on Windows, in case someone tries to install from
> the sources.

If configure.win doesn't exist, would it try to use configure? In that
case, installation should just abort when readline isn't found,
shouldn't it? Would having a configure.win serve any additional
purpose?

-Deepayan



From ripley at stats.ox.ac.uk  Wed Oct 25 11:42:58 2006
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 25 Oct 2006 10:42:58 +0100 (BST)
Subject: [Rd] latin1,utf-8...encoding and data
In-Reply-To: <17719.32031.63875.505570@stat.math.ethz.ch>
References: <45364201.9060003@biomserv.univ-lyon1.fr>
	<Pine.LNX.4.64.0610181647410.26390@gannet.stats.ox.ac.uk>
	<45372D69.6020505@biomserv.univ-lyon1.fr>
	<17719.32031.63875.505570@stat.math.ethz.ch>
Message-ID: <Pine.LNX.4.64.0610251001330.30429@gannet.stats.ox.ac.uk>

This is indeed unfortunate, but expecting Chinese speakers (20% of the 
world's population) to write in Latin-1 was also unfortunate.

What I had (and still have) some hope of doing is being able to mark 
character strings as UTF-8, probably via a flag bit on the CHARSXP.  Then 
output routines could be made to convert (if possible) to the current 
locale.  But that was before I found out how hard it was to get non-ASCII 
characters displayed correctly.  Also, any solution to this almost 
certainly means abandoning Windows 95/98/ME as they don't have support for 
Unicode (and although we could add such support at C level, they would not 
have the Unicode fonts needed).  (It might be OK to do that now, but it 
was not a couple of years ago.)

Don't underestimate the font problem.  Last week I gave a seminar about 
statistical computing in my own dept, and I thought I would show R 
operating in Chinese (we have quite a number of Chinese speakers, indeed 
more than from Latin-1 languages).  It did not work correctly in my 
pre-seminar tests, because there were no CJK fonts installed on the 
lecture-room computer.  There was no warning nor error, just 
unintelligible output.

If you are only concerned with Latin-1 and UTF-8, there is something you 
can do.  Rather than have a .rda file, store your datasets as .R files, 
with another .R file as a driver.  So you would need something like

ex1.R:
source("ex1_dat.R", encoding="latin1")

ex_dat.R:
dump of the object, converted to latin1.

If you don't specify lazydata, this will ensure the object gets converted 
to the current locale when the data() statement is executed.  If you do 
specify lazydata, the conversion will happen when the package is 
installed, which is fine if you (and any other users) always use the same 
locale (or at least always use a locale with the same encoding, e.g. 
always use a UTF-8 locale).  However, this is really only of use in 
locales that will have font coverage of Latin-1, and R installations 
without iconv will not do any necessary conversion (which is why I 
suggest dumping in latin1 and not in UTF-8).


On Thu, 19 Oct 2006, Martin Maechler wrote:

>>>>>> "St?phane" == St?phane Dray <dray at biomserv.univ-lyon1.fr>
>>>>>>     on Thu, 19 Oct 2006 09:46:49 +0200 writes:
>
>    St?phane> Thanks a lot for this clear answer. So there is no way to preserve our
>    St?phane> french cultural exception (accented characters),
>
> I agree that there are many French cultural exceptions ;-)
> --- and as a Swiss, I highly estimate several of them ---
> however "accented" characters (with the appropriate meaning of "accented")
> are not at all a French exception, rather almost a continental
> European one {as long as we are staying in the "latin" alphabet
> context}.  If I think of what I know of Europe, the only
> country/language *not* using some version of "accented"
> characters are the British and (I think) the Dutch/Flamish.
> Everyone else (? probably I forgot some, and don't know about others
> like gaelic,...)  has some kind of accents...
>
> I agree with St?phane that this is unfortunate for quite a few
> of us, and it came as a big surprise to me when I first heard
> about this from Brian.  .. aah, life was easy when we western
> chauvinists could behave as if the whole relevant part of the
> world was happy with iso-latin1...
>
> Martin
>
>
>    St?phane> if we want to be international... I have thought
>    St?phane> that the inclusion of a parameter encoding in data
>    St?phane> function (e.g. data(mydata,encoding="latin1"))
>    St?phane> like in the function 'file' could be an way to
>    St?phane> solve the problem. Apparently, the problem is much
>    St?phane> more complicated...
>
>    St?phane> Sincerely.
>
>
>    St?phane> Prof Brian Ripley wrote:
>
>    >> Only ASCII letters are portable: those accented characters do not even
>    >> exist in many of the encodings used for R, e.g. Russian and Japanese
>    >> on Windows machines.
>    >>
>    >> There is no way to associate an encoding with a character string in
>    >> R.  We considered it, but it would have had severe back-compatibility
>    >> problems and little advantage (you cannot display non-ASCII character
>    >> strings portably: even if you have a Unicode encoding you still need
>    >> to select a suitable font).
>    >>
>    >> 'B. Ripley' (sic)
>    >>
>    >>
>    >> On Wed, 18 Oct 2006, St?phane Dray wrote:
>    >>
>    >>> Hello,
>    >>> I have some questions concerning encoding and package distribution. We
>    >>> develop the ade4 package. For some data sets included in the package,
>    >>> there are accentued character (e.g. ?,?...). The data sets have been
>    >>> saved using latin1 encoding, but some of us use utf-8 and can not see
>    >>> some data sets which contains accented chracters.
>    >>> e.g:
>    >>>
>    >>> librarry(ade4)
>    >>> data(rankrock)
>    >>> rankrock
>    >>>
>    >>> in this case, characters are in rownames. Other data sets have such
>    >>> characters in data (e.g. levels of factors..). A solution is to use
>    >>> iconv... this is quite easy for us but perhaps more difficult for a user
>    >>> which can have no idea of the problem. This problem is quite marginal
>    >>> for the moment but some linux distribution are utf-8 by default (e.g.
>    >>> ubuntu) and I suppose that the problem will be more and more present in
>    >>> the future.
>    >>>
>    >>> So we wonder if there is a proper way to code and save these data sets.
>    >>> I have found some documents of B. Ripley and this note :
>    >>>
>    >>> http://developer.r-project.org/210update.txt
>    >>>
>    >>> -  Names in data objects (e.g. in .rda files) are problematic.  It
>    >>> is likely that by release time these will be treated as in
>    >>> Latin-1.
>    >>>
>    >>> If I am correct, I did not find an answer to this problem.
>    >>>
>    >>> What are the plans of R gurus on this question ?
>    >>> Thanks a lot.
>    >>> Sincerely.
>    >>>
>    >>> Please add my adress in answers as I am not subsciber of this list.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Wed Oct 25 15:34:17 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 25 Oct 2006 09:34:17 -0400
Subject: [Rd] Watch out for the latest Cygwin upgrade
Message-ID: <453F67D9.1090803@stats.uwo.ca>

I just updated my copy of Cygwin to the latest version, and now Windows 
builds are failing on that machine.  The only parts of the R toolset I 
changed were the Cygwin dlls.  I haven't tracked down exactly what the 
problem is, and probably won't be able to do so for a few days.

So if you're a Windows user thinking about a Cygwin upgrade, be prepared 
for problems...

Duncan Murdoch



From ggrothendieck at gmail.com  Wed Oct 25 16:58:51 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 10:58:51 -0400
Subject: [Rd] sourcing dput output
Message-ID: <971536df0610250758h661fd5cci6791a8e166b9aae3@mail.gmail.com>

Is this not supposed to work?

> dput(BOD, file = "/BOD.R")
> source("/BOD.R")
Error in attributes(.Data) <- c(attributes(.Data), attrib) :
        row names must be 'character' or 'integer', not 'double'

> dput(iris, file = "/iris.R")
> source("/iris.R")
Error in attributes(.Data) <- c(attributes(.Data), attrib) :
        row names must be 'character' or 'integer', not 'double'

> R.version.string # XP
[1] "R version 2.4.0 Patched (2006-10-07 r39598)"

I also tried control = "all" as an argument to dput as well as a number
of other control values but did not find one that worked.

dump("BOD.R", file = "/BOD.R"); source("/BOD.R")

and similarly for iris do work.  Also under 2.3.1pat dput output of these
two data frame could be sourced:

> dput("BOD", file = "/BOD.R")
> source("/BOD.R")
> dput("iris", file = "/iris.R")
> source("/iris.R")
> R.version.string
[1] "Version 2.3.1 Patched (2006-06-04 r38279)"

What is supposed to be the difference between dput and dump anyways
and should dput output be source-able like it used to be?



From p.dalgaard at biostat.ku.dk  Wed Oct 25 17:13:23 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 25 Oct 2006 17:13:23 +0200
Subject: [Rd] sourcing dput output
In-Reply-To: <971536df0610250758h661fd5cci6791a8e166b9aae3@mail.gmail.com>
References: <971536df0610250758h661fd5cci6791a8e166b9aae3@mail.gmail.com>
Message-ID: <x2d58gtomk.fsf@viggo.kubism.ku.dk>

"Gabor Grothendieck" <ggrothendieck at gmail.com> writes:

> Is this not supposed to work?
> 
> > dput(BOD, file = "/BOD.R")
> > source("/BOD.R")
> Error in attributes(.Data) <- c(attributes(.Data), attrib) :
>         row names must be 'character' or 'integer', not 'double'
> 
> > dput(iris, file = "/iris.R")
> > source("/iris.R")
> Error in attributes(.Data) <- c(attributes(.Data), attrib) :
>         row names must be 'character' or 'integer', not 'double'
> 
> > R.version.string # XP
> [1] "R version 2.4.0 Patched (2006-10-07 r39598)"
> 
> I also tried control = "all" as an argument to dput as well as a number
> of other control values but did not find one that worked.


Eh?

> dput(iris, file = "/tmp/iris.R")
> source("/tmp/iris.R")
Error in attributes(.Data) <- c(attributes(.Data), attrib) :
        row names must be 'character' or 'integer', not 'double'
> dput(iris, file = "/tmp/iris.R",control="all")
> source("/tmp/iris.R")
> dput(BOD, file = "/tmp/BOD.R",control="all")
> source("/tmp/BOD.R")
>                                                                

Happy as a clam...

>  R.version.string
[1] "R version 2.4.0 Patched (2006-10-20 r39680)"

(SUSE 9.3, local compile)
-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From ggrothendieck at gmail.com  Wed Oct 25 17:31:30 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 11:31:30 -0400
Subject: [Rd] sourcing dput output
In-Reply-To: <x2d58gtomk.fsf@viggo.kubism.ku.dk>
References: <971536df0610250758h661fd5cci6791a8e166b9aae3@mail.gmail.com>
	<x2d58gtomk.fsf@viggo.kubism.ku.dk>
Message-ID: <971536df0610250831j31b8d90fxa3209cf20e6bbfa3@mail.gmail.com>

Thanks.

However, that still leaves these questions:

1. I assume the changes to the internal representation of rownames is
behind this but should not dput continue to work exactly the same as
it used to work???  I would think that the internal representation aspect
would be just that -- internal and not affect various commands.

2. what is the difference between dput and dump supposed to be
anyways?

On 25 Oct 2006 17:13:23 +0200, Peter Dalgaard <p.dalgaard at biostat.ku.dk> wrote:
> "Gabor Grothendieck" <ggrothendieck at gmail.com> writes:
>
> > Is this not supposed to work?
> >
> > > dput(BOD, file = "/BOD.R")
> > > source("/BOD.R")
> > Error in attributes(.Data) <- c(attributes(.Data), attrib) :
> >         row names must be 'character' or 'integer', not 'double'
> >
> > > dput(iris, file = "/iris.R")
> > > source("/iris.R")
> > Error in attributes(.Data) <- c(attributes(.Data), attrib) :
> >         row names must be 'character' or 'integer', not 'double'
> >
> > > R.version.string # XP
> > [1] "R version 2.4.0 Patched (2006-10-07 r39598)"
> >
> > I also tried control = "all" as an argument to dput as well as a number
> > of other control values but did not find one that worked.
>
>
> Eh?
>
> > dput(iris, file = "/tmp/iris.R")
> > source("/tmp/iris.R")
> Error in attributes(.Data) <- c(attributes(.Data), attrib) :
>        row names must be 'character' or 'integer', not 'double'
> > dput(iris, file = "/tmp/iris.R",control="all")
> > source("/tmp/iris.R")
> > dput(BOD, file = "/tmp/BOD.R",control="all")
> > source("/tmp/BOD.R")
> >
>
> Happy as a clam...
>
> >  R.version.string
> [1] "R version 2.4.0 Patched (2006-10-20 r39680)"
>
> (SUSE 9.3, local compile)
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>



From pgilbert at bank-banque-canada.ca  Wed Oct 25 17:47:50 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 25 Oct 2006 11:47:50 -0400
Subject: [Rd] as.missing
In-Reply-To: <x2wt6pe7v9.fsf@turmalin.kubism.ku.dk>
References: <453E462C.6050103@bank-banque-canada.ca>	<453E5324.60103@stats.uwo.ca>	<Pine.LNX.4.64.0610241355040.8001@tajo.ucsd.edu>
	<x2wt6pe7v9.fsf@turmalin.kubism.ku.dk>
Message-ID: <453F8726.6060409@bank-banque-canada.ca>



Peter Dalgaard wrote:

>"Charles C. Berry" <cberry at tajo.ucsd.edu> writes:
>
>  
>
>>On Tue, 24 Oct 2006, Duncan Murdoch wrote:
>>    
>>
>
>  
>
>>>with no defaults.  However, this little demo illustrates the point, I think:
>>>
>>>      
>>>
>>>>g <- function(gnodef, gdef=1) {
>>>>        
>>>>
>>>+    if (missing(gnodef)) cat('gnodef is missing\n')
>>>+    if (missing(gdef)) cat('gdef is missing\n')
>>>+    cat('gdef is ',gdef,'\n')
>>>+  }
>>>      
>>>
>>>> f <- function(fnodef, fdef) {
>>>>        
>>>>
>>>+    g(fnodef, fdef)
>>>+  }
>>>      
>>>
>>>> g()
>>>>        
>>>>
>>>gnodef is missing
>>>gdef is missing
>>>gdef is  1
>>>      
>>>
>>>> f()
>>>>        
>>>>
>>>gnodef is missing
>>>gdef is missing
>>>Error in cat("gdef is ", gdef, "\n") : argument "fdef" is missing, with
>>>no default
>>>
>>>
>>>What would be nice to be able to do is to have a simple way for f() to
>>>act just like g() does.
>>>      
>>>
>>Is this what you want?
>>
>>    
>>
>>>  f <- function(fnodef, fdef=NULL) {
>>>      
>>>
>>+ g()}
>>    
>>
>>>f()
>>>      
>>>
>>gnodef is missing
>>gdef is missing
>>gdef is  1
>>    
>>
>
>I think not. More like 
>
>  f <- function(fnodef, fdef) {
>    if(missing(fdef)) g(fnodef) else  g(fnodef, fdef) 
>  }
>
>(the generalization of which is obviously a pain...)
>
>  
>
Yes, both a pain and the resulting code can be unnecessarily difficult 
to read, compared with something like

  f <- function(fnodef, gArgs=as.missing()) {g(fnodef, gArgs) }

which would generalize cleanly.
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From term at blueyonder.co.uk  Wed Oct 25 18:03:35 2006
From: term at blueyonder.co.uk (Tom McCallum)
Date: Wed, 25 Oct 2006 17:03:35 +0100
Subject: [Rd] Cross-compilation
Message-ID: <op.thziv9jjmfjo24@norisk>

Hi everyone,

I am trying to cross-compile a package I wrote using the Yan and Rossini  
tutorial "Building Microsoft Windows versions of R and R packages using  
Intel Linux".  I have got reasonably far with this but when doing the  
linking using the line:

i586-mingw32-g++  -shared -s  -o mylibrary.dll mylibrary.def mylibrary.o  
mylibrary_res.o  -L/my/path/RCrossBuild/WinR/R-2.4.0/bin -lR

I get lots of these type of messages:
/my/path/to/mylibrary.cpp:43: undefined reference to  
`_GLOBAL_OFFSET_TABLE_'

and other similar linker errors for virtually every object and command in  
the program.  After some googling I have found that there may be problems  
with the libgcc.a library and its default -fPIC argument during  
compilation.

Has anyone got this tutorial to work and if so how did they overcome this?

I am attempting to do this on Fedora Core 4 on a 32-bit machine, having  
completed all the previous sections of the tutorial for building a  
cross-platform version of R.

Many thanks

Tom

-- 
---

Tom McCallum

WWW: http://www.tom-mccallum.com
Tel: 0131-4783393
Mobile: 07866-470257



From ggrothendieck at gmail.com  Wed Oct 25 18:28:13 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 12:28:13 -0400
Subject: [Rd] as.missing
In-Reply-To: <453E462C.6050103@bank-banque-canada.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
Message-ID: <971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>

You can do it like this:

> as.missing <- force
> g <- function(x = as.missing()) missing(x)
> g(3)
[1] FALSE
> g()
[1] TRUE

On 10/24/06, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
> (I'm not sure if this is a request for a feature, or another instance
> where a feature has eluded me for many years.)
>
> Often I have a function which calls other functions, and may often use
> the default arguments to those functions, but needs the capability to
> pass along non-default choices. I usually do this with some variation on
>
> foo <- function(x, foo2Args=NULL or a list(foo2defaults),
>                    foo3Args=NULL or a list(foo3defaults))
>
> and then have logic to check for NULL, or use the list in combination
> with do.call.  It is also possible to do this with ..., but it always
> seems a bit dangerous passing all the unnamed arguments along to all the
> functions being called, especially when I always seem to be calling
> functions that have similar arguments (maxit, eps, start, frequency, etc).
>
> It is a situation I have learned to live with, but one of my
> co-maintainers just pointed out to me that there should be a good way to
> do this in R.  Perhaps there is something else I have missed all these
> years?  Is there a way to do this cleanly? It would be nice to have
> something like
>
> foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())
>
> then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but
> these would get treated as if they were missing, unless they are given
> other values.
>
> Paul Gilbert
> ====================================================================================
>
> La version fran?aise suit le texte anglais.
>
> ------------------------------------------------------------------------------------
>
> This email may contain privileged and/or confidential inform...{{dropped}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From rdiaz at cnio.es  Wed Oct 25 19:10:40 2006
From: rdiaz at cnio.es (Ramon Diaz-Uriarte)
Date: Wed, 25 Oct 2006 19:10:40 +0200
Subject: [Rd] Cross-compilation
In-Reply-To: <op.thziv9jjmfjo24@norisk>
References: <op.thziv9jjmfjo24@norisk>
Message-ID: <200610251910.40831.rdiaz@cnio.es>

Dear Tom,

It has worked for me out-of-the box in at least two times, one a while ago 
with R-2.2-something and recently with R-2.4.0. In both cases, I was running 
Debian (with a mix of testing and unstable) on x86. I never had to do 
anything, just run the script and at least in one case I did crosscompile a 
package with C++.


R.

On Wednesday 25 October 2006 18:03, Tom McCallum wrote:
> Hi everyone,
>
> I am trying to cross-compile a package I wrote using the Yan and Rossini
> tutorial "Building Microsoft Windows versions of R and R packages using
> Intel Linux".  I have got reasonably far with this but when doing the
> linking using the line:
>
> i586-mingw32-g++  -shared -s  -o mylibrary.dll mylibrary.def mylibrary.o
> mylibrary_res.o  -L/my/path/RCrossBuild/WinR/R-2.4.0/bin -lR
>
> I get lots of these type of messages:
> /my/path/to/mylibrary.cpp:43: undefined reference to
> `_GLOBAL_OFFSET_TABLE_'
>
> and other similar linker errors for virtually every object and command in
> the program.  After some googling I have found that there may be problems
> with the libgcc.a library and its default -fPIC argument during
> compilation.
>
> Has anyone got this tutorial to work and if so how did they overcome this?
>
> I am attempting to do this on Fedora Core 4 on a 32-bit machine, having
> completed all the previous sections of the tutorial for building a
> cross-platform version of R.
>
> Many thanks
>
> Tom

-- 
Ram?n D?az-Uriarte
Bioinformatics 
Centro Nacional de Investigaciones Oncol?gicas (CNIO)
(Spanish National Cancer Center)
Melchor Fern?ndez Almagro, 3
28029 Madrid (Spain)
Fax: +-34-91-224-6972
Phone: +-34-91-224-6900

http://ligarto.org/rdiaz
PGP KeyID: 0xE89B3462
(http://ligarto.org/rdiaz/0xE89B3462.asc)



**NOTA DE CONFIDENCIALIDAD** Este correo electr?nico, y en s...{{dropped}}



From p.dalgaard at biostat.ku.dk  Wed Oct 25 19:23:30 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 25 Oct 2006 19:23:30 +0200
Subject: [Rd] sourcing dput output
In-Reply-To: <971536df0610250831j31b8d90fxa3209cf20e6bbfa3@mail.gmail.com>
References: <971536df0610250758h661fd5cci6791a8e166b9aae3@mail.gmail.com>
	<x2d58gtomk.fsf@viggo.kubism.ku.dk>
	<971536df0610250831j31b8d90fxa3209cf20e6bbfa3@mail.gmail.com>
Message-ID: <x2u01stilp.fsf@turmalin.kubism.ku.dk>

"Gabor Grothendieck" <ggrothendieck at gmail.com> writes:

> Thanks.
> 
> However, that still leaves these questions:
> 
> 1. I assume the changes to the internal representation of rownames is
> behind this but should not dput continue to work exactly the same as
> it used to work???  I would think that the internal representation aspect
> would be just that -- internal and not affect various commands.

dput (and deparse) does reveal internal structure, and is sometimes
used for that purpose. It does have some cases where the
representation is not completely accurate, which is a bit unfortunate,
but awkward to avoid, e.g.

> deparse(1:5)
[1] "c(1, 2, 3, 4, 5)"

but if you parse and evaluate that, you get mode "double", not
"integer". Therefore

> deparse(1:5,control="all")
[1] "as.integer(c(1, 2, 3, 4, 5))"

which evaluates correctly, but may clutter up displays in some
contexts (which escape me just now, but changing the default and
running make check should be illuminating).

[It is probably a generic design error in the S language(s) that there
isn't a parseable representation of every possible object, but that is
a bit late to fix.]
 
> 2. what is the difference between dput and dump supposed to be
> anyways?

They are mostly the same, dump is primarily for storage, dput might
also be for display. Notice that dump works for multiple objects since
it also stores variable names.


> On 25 Oct 2006 17:13:23 +0200, Peter Dalgaard <p.dalgaard at biostat.ku.dk> wrote:
> > "Gabor Grothendieck" <ggrothendieck at gmail.com> writes:
> >
> > > Is this not supposed to work?
> > >
> > > > dput(BOD, file = "/BOD.R")
> > > > source("/BOD.R")
> > > Error in attributes(.Data) <- c(attributes(.Data), attrib) :
> > >         row names must be 'character' or 'integer', not 'double'
> > >
> > > > dput(iris, file = "/iris.R")
> > > > source("/iris.R")
> > > Error in attributes(.Data) <- c(attributes(.Data), attrib) :
> > >         row names must be 'character' or 'integer', not 'double'
> > >
> > > > R.version.string # XP
> > > [1] "R version 2.4.0 Patched (2006-10-07 r39598)"
> > >
> > > I also tried control = "all" as an argument to dput as well as a number
> > > of other control values but did not find one that worked.
> >
> >
> > Eh?
> >
> > > dput(iris, file = "/tmp/iris.R")
> > > source("/tmp/iris.R")
> > Error in attributes(.Data) <- c(attributes(.Data), attrib) :
> >        row names must be 'character' or 'integer', not 'double'
> > > dput(iris, file = "/tmp/iris.R",control="all")
> > > source("/tmp/iris.R")
> > > dput(BOD, file = "/tmp/BOD.R",control="all")
> > > source("/tmp/BOD.R")
> > >
> >
> > Happy as a clam...
> >
> > >  R.version.string
> > [1] "R version 2.4.0 Patched (2006-10-20 r39680)"
> >
> > (SUSE 9.3, local compile)
> > --
> >   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
> >  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> >  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> > ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
> >
> 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From ljlayne at unm.edu  Wed Oct 25 19:28:03 2006
From: ljlayne at unm.edu (ljlayne at unm.edu)
Date: Wed, 25 Oct 2006 19:28:03 +0200 (CEST)
Subject: [Rd] library loading errors (PR#9317)
Message-ID: <20061025172803.1B1493FC78@slim.kubism.ku.dk>

Full_Name: Larry Layne
Version: 2.4.0
OS: MS Windows 2000
Submission from: (NULL) (129.24.91.249)


All of the following libraries loaded just fine in version 2.3.1:

> utils:::menuInstallLocal()
package 'tripack' successfully unpacked and MD5 sums checked
updating HTML package descriptions
> library(tripack)
Error in dyn.load(x, as.logical(local), as.logical(now)) : 
        unable to load shared library
'C:/PROGRA~1/R/R-24~1.0/library/tripack/libs/tripack.dll':
  LoadLibrary failure:  The specified procedure could not be found.

Error in library(tripack) : .First.lib failed for 'tripack'
> library(maptools)
Loading required package: foreign
Error in dyn.load(x, as.logical(local), as.logical(now)) : 
        unable to load shared library
'C:/PROGRA~1/R/R-24~1.0/library/foreign/libs/foreign.dll':
  LoadLibrary failure:  The specified procedure could not be found.

Error: package 'foreign' could not be loaded
> library(maps)
> library(geoR)
Loading required package: sp
Error in loadNamespace(package, c(which.lib.loc, lib.loc), keep.source =
keep.source) : 
        in 'sp' methods for export not found: bbox, coordinates, coordinates<-,
coordnames, coordnames<-, gridded, polygons, polygons<-, dimensions, [,
transform, overlay, plot, recenter, spplot, spsample, summary
Error: package 'sp' could not be loaded
>



From term at blueyonder.co.uk  Wed Oct 25 19:28:45 2006
From: term at blueyonder.co.uk (Tom McCallum)
Date: Wed, 25 Oct 2006 18:28:45 +0100
Subject: [Rd] Cross-compilation
In-Reply-To: <200610251910.40831.rdiaz@cnio.es>
References: <op.thziv9jjmfjo24@norisk> <200610251910.40831.rdiaz@cnio.es>
Message-ID: <op.thzmt7scmfjo24@norisk>

Thanks for your reply, as an example it appears to have difficulty linking  
to even ostream library of the standard C++, as shown below:

/home/tmccallum/ritzel/RItzel/src/Classifier.cpp:209: undefined reference  
to `_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc'
Classifier.o: In function `operator<<':
/usr/lib/gcc/i386-redhat-linux/4.0.2/../../../../include/c++/4.0.2/ostream:218:  
undefined reference to `_ZNSolsEd'
/usr/lib/gcc/i386-redhat-linux/4.0.2/../../../../include/c++/4.0.2/ostream:196:  
undefined reference to `_ZNSolsEl'

I am currently working R-2.4.0 as downloaded today.

I know the g++ has gone through some alterations and wondered if you knew  
the version of g++ you cross-compiled your package with for comparison -  
mine is g++ (GCC) 4.0.2 20051125 (Red Hat 4.0.2-8).

Many thanks

Tom


On Wed, 25 Oct 2006 18:10:40 +0100, Ramon Diaz-Uriarte <rdiaz at cnio.es>  
wrote:

> Dear Tom,
>
> It has worked for me out-of-the box in at least two times, one a while  
> ago
> with R-2.2-something and recently with R-2.4.0. In both cases, I was  
> running
> Debian (with a mix of testing and unstable) on x86. I never had to do
> anything, just run the script and at least in one case I did  
> crosscompile a
> package with C++.
>
>
> R.
>
> On Wednesday 25 October 2006 18:03, Tom McCallum wrote:
>> Hi everyone,
>>
>> I am trying to cross-compile a package I wrote using the Yan and Rossini
>> tutorial "Building Microsoft Windows versions of R and R packages using
>> Intel Linux".  I have got reasonably far with this but when doing the
>> linking using the line:
>>
>> i586-mingw32-g++  -shared -s  -o mylibrary.dll mylibrary.def mylibrary.o
>> mylibrary_res.o  -L/my/path/RCrossBuild/WinR/R-2.4.0/bin -lR
>>
>> I get lots of these type of messages:
>> /my/path/to/mylibrary.cpp:43: undefined reference to
>> `_GLOBAL_OFFSET_TABLE_'
>>
>> and other similar linker errors for virtually every object and command  
>> in
>> the program.  After some googling I have found that there may be  
>> problems
>> with the libgcc.a library and its default -fPIC argument during
>> compilation.
>>
>> Has anyone got this tutorial to work and if so how did they overcome  
>> this?
>>
>> I am attempting to do this on Fedora Core 4 on a 32-bit machine, having
>> completed all the previous sections of the tutorial for building a
>> cross-platform version of R.
>>
>> Many thanks
>>
>> Tom
>



-- 
---

Tom McCallum

WWW: http://www.tom-mccallum.com
Tel: 0131-4783393
Mobile: 07866-470257



From Roger.Bivand at nhh.no  Wed Oct 25 19:49:28 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 25 Oct 2006 19:49:28 +0200 (CEST)
Subject: [Rd] library loading errors (PR#9317)
In-Reply-To: <20061025172803.1B1493FC78@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0610251940400.28949-100000@reclus.nhh.no>

On Wed, 25 Oct 2006 ljlayne at unm.edu wrote:

> Full_Name: Larry Layne
> Version: 2.4.0
> OS: MS Windows 2000
> Submission from: (NULL) (129.24.91.249)
> 
> 
> All of the following libraries loaded just fine in version 2.3.1:

Not a bug. For sp in particular, please simply re-install the contributed 
package, and possibly others, because (as noted in NEWS) there are 
incompatibilities in the way classes are built in binary packages between 
R 2.3.1 and R 2.4.0:

update.packages(checkBuilt=TRUE)

It is possible that you also have an old version of the recommended 
package foreign in your library path - look at what:

.libPaths()

says and see if an old foreign isn't lurking ahead of the 2.4.0 one built 
with the binary you installed. Output of .sessionInfo() and .libPaths() 
may lead you to the root of the problem.

> 
> > utils:::menuInstallLocal()
> package 'tripack' successfully unpacked and MD5 sums checked
> updating HTML package descriptions
> > library(tripack)
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>         unable to load shared library
> 'C:/PROGRA~1/R/R-24~1.0/library/tripack/libs/tripack.dll':
>   LoadLibrary failure:  The specified procedure could not be found.
> 
> Error in library(tripack) : .First.lib failed for 'tripack'
> > library(maptools)
> Loading required package: foreign
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>         unable to load shared library
> 'C:/PROGRA~1/R/R-24~1.0/library/foreign/libs/foreign.dll':
>   LoadLibrary failure:  The specified procedure could not be found.
> 
> Error: package 'foreign' could not be loaded
> > library(maps)
> > library(geoR)
> Loading required package: sp
> Error in loadNamespace(package, c(which.lib.loc, lib.loc), keep.source =
> keep.source) : 
>         in 'sp' methods for export not found: bbox, coordinates, coordinates<-,
> coordnames, coordnames<-, gridded, polygons, polygons<-, dimensions, [,
> transform, overlay, plot, recenter, spplot, spsample, summary
> Error: package 'sp' could not be loaded
> >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ljlayne at unm.edu  Wed Oct 25 22:18:15 2006
From: ljlayne at unm.edu (Larry Layne)
Date: Wed, 25 Oct 2006 14:18:15 -0600
Subject: [Rd] library loading errors (PR#9317)
In-Reply-To: <Pine.LNX.4.44.0610251940400.28949-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0610251940400.28949-100000@reclus.nhh.no>
Message-ID: <EB9281AF493437C79D5204C0@dhcp-129-24-91-249.unm.edu>

Some of the packages needed to be newer, as you indicated. Thanks.

--On Wednesday, October 25, 2006 7:49 PM +0200 Roger Bivand 
<Roger.Bivand at nhh.no> wrote:

> On Wed, 25 Oct 2006 ljlayne at unm.edu wrote:
>
>> Full_Name: Larry Layne
>> Version: 2.4.0
>> OS: MS Windows 2000
>> Submission from: (NULL) (129.24.91.249)
>>
>>
>> All of the following libraries loaded just fine in version 2.3.1:
>
> Not a bug. For sp in particular, please simply re-install the contributed
> package, and possibly others, because (as noted in NEWS) there are
> incompatibilities in the way classes are built in binary packages between
> R 2.3.1 and R 2.4.0:
>
> update.packages(checkBuilt=TRUE)
>
> It is possible that you also have an old version of the recommended
> package foreign in your library path - look at what:
>
> .libPaths()
>
> says and see if an old foreign isn't lurking ahead of the 2.4.0 one built
> with the binary you installed. Output of .sessionInfo() and .libPaths()
> may lead you to the root of the problem.
>
>>
>> > utils:::menuInstallLocal()
>> package 'tripack' successfully unpacked and MD5 sums checked
>> updating HTML package descriptions
>> > library(tripack)
>> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>>         unable to load shared library
>> 'C:/PROGRA~1/R/R-24~1.0/library/tripack/libs/tripack.dll':
>>   LoadLibrary failure:  The specified procedure could not be found.
>>
>> Error in library(tripack) : .First.lib failed for 'tripack'
>> > library(maptools)
>> Loading required package: foreign
>> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>>         unable to load shared library
>> 'C:/PROGRA~1/R/R-24~1.0/library/foreign/libs/foreign.dll':
>>   LoadLibrary failure:  The specified procedure could not be found.
>>
>> Error: package 'foreign' could not be loaded
>> > library(maps)
>> > library(geoR)
>> Loading required package: sp
>> Error in loadNamespace(package, c(which.lib.loc, lib.loc), keep.source =
>> keep.source) :
>>         in 'sp' methods for export not found: bbox, coordinates,
>>         coordinates<-, coordnames, coordnames<-, gridded, polygons,
>> polygons<-, dimensions, [, transform, overlay, plot, recenter, spplot,
>> spsample, summary
>> Error: package 'sp' could not be loaded
>> >
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From sfalcon at fhcrc.org  Wed Oct 25 23:23:21 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 25 Oct 2006 14:23:21 -0700
Subject: [Rd] NA handling in as.character applied to a list
Message-ID: <m24ptsay46.fsf@ziti.local>

Hi all,

In some circumstances, as.character applied to a list converts real
NA's into the string "NA".  Propagation of NAs is something R does
very well and unless there are good reasons for losing the NA, it
would improve the consistency w.r.t. NA handling for as.character to
behave differently.

Here's an example:

## Create a list with character, logical, and integer NA elements
v <- list(a=as.character(NA), b=NA, c=as.integer(NA))
sapply(v, is.na)

       a    b    c 
    TRUE TRUE TRUE 

sapply(as.character(v), is.na)

     <NA>    NA    NA 
     TRUE FALSE FALSE 

Thoughts?

+ seth

--
Seth Falcon | Computational Biology | Fred Hutchinson Cancer Research Center
http://bioconductor.org



From gkotler at rics.bwh.harvard.edu  Wed Oct 25 23:50:08 2006
From: gkotler at rics.bwh.harvard.edu (Gregory Kotler)
Date: Wed, 25 Oct 2006 17:50:08 -0400
Subject: [Rd] Cox model - (TStart,Tstop] algorith
Message-ID: <453FDC10.5060801@rics.bwh.harvard.edu>

Hi ALL,
 To fit proportional hazard Cox Model with counting
process style of input data R and S-plus implement
"(TStart,Tstop] algorithm" (agfit3.c) which  uses
"smart subsets" of sorted events time. Are there any
accessible publications where the idea of this
algorithm was represented ?

 Thank you,
    Gregory Kotler



From p.dalgaard at biostat.ku.dk  Thu Oct 26 00:18:25 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 26 Oct 2006 00:18:25 +0200
Subject: [Rd] NA handling in as.character applied to a list
In-Reply-To: <m24ptsay46.fsf@ziti.local>
References: <m24ptsay46.fsf@ziti.local>
Message-ID: <x2d58gt4y6.fsf@turmalin.kubism.ku.dk>

Seth Falcon <sfalcon at fhcrc.org> writes:

> Hi all,
> 
> In some circumstances, as.character applied to a list converts real
> NA's into the string "NA".  Propagation of NAs is something R does
> very well and unless there are good reasons for losing the NA, it
> would improve the consistency w.r.t. NA handling for as.character to
> behave differently.
> 
> Here's an example:
> 
> ## Create a list with character, logical, and integer NA elements
> v <- list(a=as.character(NA), b=NA, c=as.integer(NA))
> sapply(v, is.na)
> 
>        a    b    c 
>     TRUE TRUE TRUE 
> 
> sapply(as.character(v), is.na)
> 
>      <NA>    NA    NA 
>      TRUE FALSE FALSE 
> 
> Thoughts?

Hmm...

> as.character(v)
[1] NA   "NA" "NA"

This does look like a leftover from times when there was no character
NA in the language. It is the kind of thing you need to be very
careful about fixing though. (I have a couple of scars from
as.character on formulas when introducing backtick quoting.)


BTW, another little bit of nastiness popped up when playing around
with this:

> dput(v,control="all")
structure(list(a = NA, b = NA, c = as.integer(NA)), .Names = c("a",
"b", "c"))

> sapply(v,mode)
          a           b           c
"character"   "logical"   "numeric"



-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From ggrothendieck at gmail.com  Thu Oct 26 02:14:08 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 20:14:08 -0400
Subject: [Rd] how to determine if a function's result is invisible
Message-ID: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>

Suppose we have a function such as the following

F <- function(f, x) f(x)+1

which runs function f and then transforms it.  I would like the
corresponding function which works the same except that
unlike F returns an invisible result if and only if f does.

Is there some way of determining whether f returns
an invisible result or not?

Thus we want this:

f <- function(x) x
g <- function(x) invisible(x)

> F(f, 1)
2
>

> F(g, 1)
>



From MSchwartz at mn.rr.com  Thu Oct 26 03:20:32 2006
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 25 Oct 2006 20:20:32 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
Message-ID: <1161825632.4556.14.camel@localhost.localdomain>

On Wed, 2006-10-25 at 20:14 -0400, Gabor Grothendieck wrote:
> Suppose we have a function such as the following
> 
> F <- function(f, x) f(x)+1
> 
> which runs function f and then transforms it.  I would like the
> corresponding function which works the same except that
> unlike F returns an invisible result if and only if f does.
> 
> Is there some way of determining whether f returns
> an invisible result or not?
> 
> Thus we want this:
> 
> f <- function(x) x
> g <- function(x) invisible(x)
> 
> > F(f, 1)
> 2
> >
> 
> > F(g, 1)
> >

Gabor,

There may be a better way of doing this and/or this will spark some
thoughts.

Let's create two simple functions:

 f.inv <- function(x) {invisible(x)}

 f <- function(x) {x}

So we now have:

> f.inv(1)
> f(1)
[1] 1


> any(grep("invisible", (deparse(f))))
[1] FALSE

> any(grep("invisible", (deparse(f.inv))))
[1] TRUE


This is not extensively tested of course, but another function that
comes to mind that does return a result 'invisibly' is:

> any(grep("invisible", (deparse(barplot.default))))
[1] TRUE

So there seems to be some foundation for working, as long as the target
function can be deparsed, which may limit things with respect to
C/FORTRAN based functions.

HTH,

Marc Schwartz



From mwtoews at sfu.ca  Thu Oct 26 03:54:10 2006
From: mwtoews at sfu.ca (Michael Toews)
Date: Wed, 25 Oct 2006 18:54:10 -0700
Subject: [Rd]  NA handling in as.character applied to a list
References: m24ptsay46.fsf@ziti.local
Message-ID: <45401542.3090305@sfu.ca>

Also, Splus 7 has a different behaviour from R:
 > sapply(v, is.na)
 a b c
 F T T
 > sapply(as.character(v), is.na)
[1] F F F
 > as.character(v)
[1] "\"NA\"" "NA"     "NA"

In R, it remains logical: if it isn't in character mode, then 
as.character always turns NA's into "NA"'s. If that behaviour is not 
desired, and you want to keep character NA's as true NA's, then you can 
test from the original object.

I agree that is dangerous to change the behaviour of simple things like 
this, and don't recommend any change in behaviour. However, this isn't 
documented, so here is my suggested patch for ?as.character . (Edit this 
as necessary).
+mt


From mwtoews at sfu.ca  Thu Oct 26 04:00:03 2006
From: mwtoews at sfu.ca (Michael Toews)
Date: Wed, 25 Oct 2006 19:00:03 -0700
Subject: [Rd]   NA handling in as.character applied to a list
Message-ID: <454016A3.2090308@sfu.ca>

Okay ... I'll try to attach that patch once more ... (does this list 
only accept certain exertions for attachments? I used '.patch', but it 
must have been filtered off, so I'll try '.patch.txt' now ...)
+mt
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: character.patch.txt
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061025/ff0cc2f5/attachment-0004.txt 

From deepayan.sarkar at gmail.com  Thu Oct 26 04:16:37 2006
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Wed, 25 Oct 2006 19:16:37 -0700
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <1161825632.4556.14.camel@localhost.localdomain>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<1161825632.4556.14.camel@localhost.localdomain>
Message-ID: <eb555e660610251916g16502346mad5808724a0d9905@mail.gmail.com>

On 10/25/06, Marc Schwartz <MSchwartz at mn.rr.com> wrote:
> On Wed, 2006-10-25 at 20:14 -0400, Gabor Grothendieck wrote:
> > Suppose we have a function such as the following
> >
> > F <- function(f, x) f(x)+1
> >
> > which runs function f and then transforms it.  I would like the
> > corresponding function which works the same except that
> > unlike F returns an invisible result if and only if f does.
> >
> > Is there some way of determining whether f returns
> > an invisible result or not?
> >
> > Thus we want this:
> >
> > f <- function(x) x
> > g <- function(x) invisible(x)
> >
> > > F(f, 1)
> > 2
> > >
> >
> > > F(g, 1)
> > >
>
> Gabor,
>
> There may be a better way of doing this and/or this will spark some
> thoughts.
>
> Let's create two simple functions:
>
>  f.inv <- function(x) {invisible(x)}
>
>  f <- function(x) {x}
>
> So we now have:
>
> > f.inv(1)
> > f(1)
> [1] 1
>
>
> > any(grep("invisible", (deparse(f))))
> [1] FALSE
>
> > any(grep("invisible", (deparse(f.inv))))
> [1] TRUE

That's not going to work, since invisibility can also be a side effect
of assignment, e.g.

g <- function(x) { x <- x }

-Deepayan



From hb at stat.berkeley.edu  Thu Oct 26 04:31:22 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 26 Oct 2006 12:31:22 +1000
Subject: [Rd] Error: invalid multibyte string
Message-ID: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>

I'm observing the following on different platforms:

> parse(text='"\\x7F"')
expression("\177")
> parse(text='"\\x80"')
Error: invalid multibyte string
...
> parse(text='"\\xFF"')
Error: invalid multibyte string

However,

cat("\x7F\n\x80\n...\xFF\n")

works.  Using R --vanilla.

SYSTEMS GIVING THE ERROR:
> sessionInfo()
R version 2.4.0 (2006-10-03)
x86_64-unknown-linux-gnu
locale:
LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C

R version 2.4.0 Patched (2006-10-03 r39576)
i686-pc-linux-gnu
locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C


SYSTEMS OK:
R version 2.4.0 Under development (unstable) (2006-07-23 r38687)
x86_64-unknown-linux-gnu
locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

R version 2.4.0 (2006-10-03)
i386-pc-mingw32
locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
States.1252;LC_MONETARY=English_United
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

R version 2.4.0 Patched (2006-10-10 r39600)
i386-pc-mingw32
locale:
LC_COLLATE=English_Australia.1252;LC_CTYPE=English_Australia.1252;LC_MONETARY=En
glish_Australia.1252;LC_NUMERIC=C;LC_TIME=English_Australia.1252

Version 2.3.0 (2006-04-24)
x86_64-unknown-linux-gnu
locale: <not reported>


All of the above have the following packages attached:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "base"

We identified this problem because R CMD check complained:

> * checking package dependencies ... WARNING
> Error in deparse(e[[2]]) : invalid multibyte string
> Execution halted

because we use "\xFF" (or "\377") in the source code to be used as a
terminator in a vector buffer; "\0" can't be used for other reasons.

Is the above a bug in R or one in my head?

/H



From murdoch at stats.uwo.ca  Thu Oct 26 04:56:42 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 25 Oct 2006 22:56:42 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
Message-ID: <454023EA.4020403@stats.uwo.ca>

On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
> Suppose we have a function such as the following
> 
> F <- function(f, x) f(x)+1
> 
> which runs function f and then transforms it.  I would like the
> corresponding function which works the same except that
> unlike F returns an invisible result if and only if f does.
> 
> Is there some way of determining whether f returns
> an invisible result or not?
> 
> Thus we want this:
> 
> f <- function(x) x
> g <- function(x) invisible(x)
> 
>> F(f, 1)
> 2
> 
>> F(g, 1)

I don't think there's a way to do that.  Internally there's a global 
flag called R_Visible; if it is set to zero, the value won't print.  But 
  it gets reset to 1 very easily (e.g. by adding 1 to the result of an 
invisible function), and it's not available in the API for you to write 
C code to look at it.

I think you'll just have to do require the user of your F to tell you 
that they want the result to be invisible.

Duncan Murdoch



From ggrothendieck at gmail.com  Thu Oct 26 05:02:14 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 23:02:14 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <454023EA.4020403@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
Message-ID: <971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>

On 10/25/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
> > Suppose we have a function such as the following
> >
> > F <- function(f, x) f(x)+1
> >
> > which runs function f and then transforms it.  I would like the
> > corresponding function which works the same except that
> > unlike F returns an invisible result if and only if f does.
> >
> > Is there some way of determining whether f returns
> > an invisible result or not?
> >
> > Thus we want this:
> >
> > f <- function(x) x
> > g <- function(x) invisible(x)
> >
> >> F(f, 1)
> > 2
> >
> >> F(g, 1)
>
> I don't think there's a way to do that.  Internally there's a global
> flag called R_Visible; if it is set to zero, the value won't print.  But
>  it gets reset to 1 very easily (e.g. by adding 1 to the result of an
> invisible function), and it's not available in the API for you to write
> C code to look at it.
>
> I think you'll just have to do require the user of your F to tell you
> that they want the result to be invisible.
>
> Duncan Murdoch
>

Perhaps R_Visible be made available at the R level in the future.
It would be helpful in situations where you are transforming a
function but want to keep aspects of it such as whether the
return result is invisible.



From ggrothendieck at gmail.com  Thu Oct 26 05:10:46 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 23:10:46 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <1161825632.4556.14.camel@localhost.localdomain>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<1161825632.4556.14.camel@localhost.localdomain>
Message-ID: <971536df0610252010j32f33342m78fee7588d1439fd@mail.gmail.com>

On 10/25/06, Marc Schwartz <MSchwartz at mn.rr.com> wrote:
> On Wed, 2006-10-25 at 20:14 -0400, Gabor Grothendieck wrote:
> > Suppose we have a function such as the following
> >
> > F <- function(f, x) f(x)+1
> >
> > which runs function f and then transforms it.  I would like the
> > corresponding function which works the same except that
> > unlike F returns an invisible result if and only if f does.
> >
> > Is there some way of determining whether f returns
> > an invisible result or not?
> >
> > Thus we want this:
> >
> > f <- function(x) x
> > g <- function(x) invisible(x)
> >
> > > F(f, 1)
> > 2
> > >
> >
> > > F(g, 1)
> > >
>
> Gabor,
>
> There may be a better way of doing this and/or this will spark some
> thoughts.
>
> Let's create two simple functions:
>
>  f.inv <- function(x) {invisible(x)}
>
>  f <- function(x) {x}
>
> So we now have:
>
> > f.inv(1)
> > f(1)
> [1] 1
>
>
> > any(grep("invisible", (deparse(f))))
> [1] FALSE
>
> > any(grep("invisible", (deparse(f.inv))))
> [1] TRUE
>
>
> This is not extensively tested of course, but another function that
> comes to mind that does return a result 'invisibly' is:
>
> > any(grep("invisible", (deparse(barplot.default))))
> [1] TRUE
>
> So there seems to be some foundation for working, as long as the target
> function can be deparsed, which may limit things with respect to
> C/FORTRAN based functions.
>
> HTH,
>
> Marc Schwartz
>
>
>

Clever idea.  As others have mentioned there are some limitations
plus generics would not work since the code is in the methods
but its an interesting suggestion that would work part of the time.



From MSchwartz at mn.rr.com  Thu Oct 26 05:22:43 2006
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 25 Oct 2006 22:22:43 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <eb555e660610251916g16502346mad5808724a0d9905@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<1161825632.4556.14.camel@localhost.localdomain>
	<eb555e660610251916g16502346mad5808724a0d9905@mail.gmail.com>
Message-ID: <1161832963.4556.25.camel@localhost.localdomain>

On Wed, 2006-10-25 at 19:16 -0700, Deepayan Sarkar wrote:
> On 10/25/06, Marc Schwartz <MSchwartz at mn.rr.com> wrote:
> > On Wed, 2006-10-25 at 20:14 -0400, Gabor Grothendieck wrote:
> > > Suppose we have a function such as the following
> > >
> > > F <- function(f, x) f(x)+1
> > >
> > > which runs function f and then transforms it.  I would like the
> > > corresponding function which works the same except that
> > > unlike F returns an invisible result if and only if f does.
> > >
> > > Is there some way of determining whether f returns
> > > an invisible result or not?
> > >
> > > Thus we want this:
> > >
> > > f <- function(x) x
> > > g <- function(x) invisible(x)
> > >
> > > > F(f, 1)
> > > 2
> > > >
> > >
> > > > F(g, 1)
> > > >
> >
> > Gabor,
> >
> > There may be a better way of doing this and/or this will spark some
> > thoughts.
> >
> > Let's create two simple functions:
> >
> >  f.inv <- function(x) {invisible(x)}
> >
> >  f <- function(x) {x}
> >
> > So we now have:
> >
> > > f.inv(1)
> > > f(1)
> > [1] 1
> >
> >
> > > any(grep("invisible", (deparse(f))))
> > [1] FALSE
> >
> > > any(grep("invisible", (deparse(f.inv))))
> > [1] TRUE
> 
> That's not going to work, since invisibility can also be a side effect
> of assignment, e.g.
> 
> g <- function(x) { x <- x }

Good point.  Can we tweak it a bit to try to cover additional
situations, such as this? For example:


is.invisible <- function(x)
{
  dep.x <- deparse(x)

  ifelse(any(grep("invisible", dep.x)) |
         any(grep("<-", dep.x[length(dep.x) - 1])),
         TRUE, FALSE)
}


f.inv <- function(x) {invisible(x)}
f <- function(x) {x}
g <- function(x) { x <- x }


> is.invisible(f.inv)
[1] TRUE

> is.invisible(f)
[1] FALSE

> is.invisible(g)
[1] TRUE


In this case to (possibly) cover the assignment situation, I am looking
for an assignment operator ("<-") in the last code line of the function
body. Note that if there are blank lines in the function body after the
assignment line and before the closing brace, the assignment line is
still the final line of code found in the deparse().

Given Duncan's comment, it sounds like this might not be doable for 100%
of the situations, but we may be able to cover the 80% of the common
ones.

Gabor, to your follow up comment about generics, perhaps the code can be
yet further extended to check the class of the relevant argument(s) to
the function(s) in question to similarly search/deparse the methods that
would presumably be dispatched. It would certainly become more
convoluted however.

Thoughts?

Marc



From ggrothendieck at gmail.com  Thu Oct 26 05:43:27 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 25 Oct 2006 23:43:27 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <1161832963.4556.25.camel@localhost.localdomain>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<1161825632.4556.14.camel@localhost.localdomain>
	<eb555e660610251916g16502346mad5808724a0d9905@mail.gmail.com>
	<1161832963.4556.25.camel@localhost.localdomain>
Message-ID: <971536df0610252043m11995a37lebad6b1624bec8d@mail.gmail.com>

On 10/25/06, Marc Schwartz <MSchwartz at mn.rr.com> wrote:
> On Wed, 2006-10-25 at 19:16 -0700, Deepayan Sarkar wrote:
> > On 10/25/06, Marc Schwartz <MSchwartz at mn.rr.com> wrote:
> > > On Wed, 2006-10-25 at 20:14 -0400, Gabor Grothendieck wrote:
> > > > Suppose we have a function such as the following
> > > >
> > > > F <- function(f, x) f(x)+1
> > > >
> > > > which runs function f and then transforms it.  I would like the
> > > > corresponding function which works the same except that
> > > > unlike F returns an invisible result if and only if f does.
> > > >
> > > > Is there some way of determining whether f returns
> > > > an invisible result or not?
> > > >
> > > > Thus we want this:
> > > >
> > > > f <- function(x) x
> > > > g <- function(x) invisible(x)
> > > >
> > > > > F(f, 1)
> > > > 2
> > > > >
> > > >
> > > > > F(g, 1)
> > > > >
> > >
> > > Gabor,
> > >
> > > There may be a better way of doing this and/or this will spark some
> > > thoughts.
> > >
> > > Let's create two simple functions:
> > >
> > >  f.inv <- function(x) {invisible(x)}
> > >
> > >  f <- function(x) {x}
> > >
> > > So we now have:
> > >
> > > > f.inv(1)
> > > > f(1)
> > > [1] 1
> > >
> > >
> > > > any(grep("invisible", (deparse(f))))
> > > [1] FALSE
> > >
> > > > any(grep("invisible", (deparse(f.inv))))
> > > [1] TRUE
> >
> > That's not going to work, since invisibility can also be a side effect
> > of assignment, e.g.
> >
> > g <- function(x) { x <- x }
>
> Good point.  Can we tweak it a bit to try to cover additional
> situations, such as this? For example:
>
>
> is.invisible <- function(x)
> {
>  dep.x <- deparse(x)
>
>  ifelse(any(grep("invisible", dep.x)) |
>         any(grep("<-", dep.x[length(dep.x) - 1])),
>         TRUE, FALSE)
> }
>
>
> f.inv <- function(x) {invisible(x)}
> f <- function(x) {x}
> g <- function(x) { x <- x }
>
>
> > is.invisible(f.inv)
> [1] TRUE
>
> > is.invisible(f)
> [1] FALSE
>
> > is.invisible(g)
> [1] TRUE
>
>
> In this case to (possibly) cover the assignment situation, I am looking
> for an assignment operator ("<-") in the last code line of the function
> body. Note that if there are blank lines in the function body after the
> assignment line and before the closing brace, the assignment line is
> still the final line of code found in the deparse().
>
> Given Duncan's comment, it sounds like this might not be doable for 100%
> of the situations, but we may be able to cover the 80% of the common
> ones.
>
> Gabor, to your follow up comment about generics, perhaps the code can be
> yet further extended to check the class of the relevant argument(s) to
> the function(s) in question to similarly search/deparse the methods that
> would presumably be dispatched. It would certainly become more
> convoluted however.

In the case of S3 one could search for a UseMethod and, if found, just
search all available methods for invisible without trying to figure out
which one(s) get dispatched on the theory that its likely
that they will all return or all not return invisibly since methods are
supposed to maintain a certain sense of semantic consistency.

In the case of internal R functions there may not be that many that
return invisibly so one could just make a list of them and check against
that list.  Is there some way to grep these out?



From murdoch at stats.uwo.ca  Thu Oct 26 06:11:13 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 26 Oct 2006 00:11:13 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
Message-ID: <45403561.1000808@stats.uwo.ca>

On 10/25/2006 11:02 PM, Gabor Grothendieck wrote:
> On 10/25/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
>>> Suppose we have a function such as the following
>>>
>>> F <- function(f, x) f(x)+1
>>>
>>> which runs function f and then transforms it.  I would like the
>>> corresponding function which works the same except that
>>> unlike F returns an invisible result if and only if f does.
>>>
>>> Is there some way of determining whether f returns
>>> an invisible result or not?
>>>
>>> Thus we want this:
>>>
>>> f <- function(x) x
>>> g <- function(x) invisible(x)
>>>
>>>> F(f, 1)
>>> 2
>>>
>>>> F(g, 1)
>> I don't think there's a way to do that.  Internally there's a global
>> flag called R_Visible; if it is set to zero, the value won't print.  But
>>  it gets reset to 1 very easily (e.g. by adding 1 to the result of an
>> invisible function), and it's not available in the API for you to write
>> C code to look at it.
>>
>> I think you'll just have to do require the user of your F to tell you
>> that they want the result to be invisible.
>>
>> Duncan Murdoch
>>
> 
> Perhaps R_Visible be made available at the R level in the future.
> It would be helpful in situations where you are transforming a
> function but want to keep aspects of it such as whether the
> return result is invisible.

Actually, there is a way, but it's undocumented (i.e., use at your own 
risk).  It's the eval.with.vis function.  This is an internal function 
that is used within source() and capture.output(); you'll have to guess 
from the usage there what the args are.   But here's an F that does 
something close to what you want:

 > fix(F)
 > f <- function() 1
 > g <- function() invisible(1)
 >
 > F <- function (expr)
+ {
+     expr <- substitute(expr)
+     pf <- parent.frame()
+     tmp <- .Internal(eval.with.vis(expr, pf,
+         baseenv()))
+     tmp
+ }
 > F(f())
$value
[1] 1

$visible
[1] TRUE

 > F(g())
$value
[1] 1

$visible
[1] FALSE



From dhinds at sonic.net  Thu Oct 26 08:13:22 2006
From: dhinds at sonic.net (dhinds at sonic.net)
Date: Thu, 26 Oct 2006 06:13:22 +0000 (UTC)
Subject: [Rd] Watch out for the latest Cygwin upgrade
References: <453F67D9.1090803@stats.uwo.ca>
Message-ID: <ehpjm2$bsb$1@sea.gmane.org>

Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> I just updated my copy of Cygwin to the latest version, and now Windows 
> builds are failing on that machine.  The only parts of the R toolset I 
> changed were the Cygwin dlls.  I haven't tracked down exactly what the 
> problem is, and probably won't be able to do so for a few days.

> So if you're a Windows user thinking about a Cygwin upgrade, be prepared 
> for problems...

The change that bit me is that the latest cygwin bash is unhappy with
cr/lf line endings in scripts.  Which breaks some of the "R CMD ..."
scripts in non-obvious ways.  The error messages are hard to interpret
because they have embedded "\r" characters, causing some of the text
of the messages to be overwritten.

There is a sort-of workaround in the latest release (the "igncr" shell
option) but that seems to still be in flux so I decided to revert to
the previous release for now.

There seems to be a somewhat cavalier attitude among Cygwin developers
about backwards compatibility.  They've said that their primary focus
is on making cygwin as linux-like as possible, and they're willing to
sacrifice interoperability to do so.

-- Dave



From tom at levelelimited.com  Thu Oct 26 09:05:45 2006
From: tom at levelelimited.com (tom at levelelimited.com)
Date: Thu, 26 Oct 2006 08:05:45 +0100
Subject: [Rd] Cross-compilation
In-Reply-To: <op.thzmt7scmfjo24@norisk>
References: <op.thziv9jjmfjo24@norisk> <200610251910.40831.rdiaz@cnio.es>
	<op.thzmt7scmfjo24@norisk>
Message-ID: <j7qedl.u1t7jy@webmail.livemail.co.uk>

More information for you.

In order to test some ideas I had I first attempted to compile the gafit
package which is just a single file - this compiled fine (this is a C
package).  

I then added the iostream library to it as so:

#include <iostream>

and altered the extension from c to cpp so it would compile as a C++ program
and I get the following:

*********************************
   START OUTPUT
*********************************
export
PATH=/my/path/RCrossBuild/cross-tools/bin:/my/path/RCrossBuild/cross-tools/mingw32/bin:/usr/local/pgsql/bin:/home/tmccallum/sbin:/usr/java/jdk1.5.0_06/bin:/usr/java/jdk1.5.0_06/jre/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin:/home/tmccallum/bin;
\
export mypkg=`echo gafittest | cut -d'_' -f1,1`; \
export mypkg_v=gafittest; \
cd /my/path/RCrossBuild/pkgsrc; \
rm -rf $mypkg; \
tar zxf gafittest.tar.gz; \
echo ---        ----$mypkg------; \
cd /my/path/RCrossBuild/WinR/R-2.4.0/src/gnuwin32/; \
make PKGDIR=/my/path/RCrossBuild/pkgsrc RLIB=/my/path/RCrossBuild/WinRlibs
STAMP=no pkg-$mypkg; \
mkdir -p         /my/path/RCrossBuild/WinRlibs; \
cd /my/path/RCrossBuild/WinRlibs; \
rm -rf $mypkg_v.zip; \
zip -rl $mypkg_v.zip $mypkg -x \*.so \*.dll \*.RData \*.rda \*.gz \*.zip
\*.rds \*.pdf \*.ps;\
zip -r9 $mypkg_v.zip $mypkg -i \*.so \*.dll \*.RData \*.rda \*.gz \*.zip
\*.rds \*.pdf \*.ps;\
rm -rf $mypkg_v
--- ----gafittest------
make[1]: Entering directory `/my/path/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'

---------- Making package gafittest ------------
  adding build stamp to DESCRIPTION
  making DLL ...
making gafit.d from gafit.cpp
In file included from
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/bits/locale_facets.h:1533,
                 from
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/bits/basic_ios.h:44,
                 from
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/ios:51,
                 from
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/ostream:45,
                 from
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/iostream:45,
                 from gafit.cpp:22:
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/bits/codecvt.h:219:45:
macro "length" passed 4 arguments, but takes just 1
make[4]: *** [gafit.d] Error 1
make[3]: *** [srcDynlib] Error 2
make[2]: *** [all] Error 2
make[1]: *** [pkg-gafittest] Error 2
make[1]: Leaving directory `/my/path/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'
  adding: gafittest/ (stored 0%)
  adding: gafittest/DESCRIPTION (deflated 41%)
  adding: gafittest/Meta/ (stored 0%)
  adding: gafittest/COPYING (deflated 62%)
  adding: gafittest/Meta/package.rds (deflated 54%)

*********************************
   END OUTPUT
*********************************

I have checked the search paths and it is using the includes in gcc 3.4.5 that
come with mingW32 as the docs say it should.  Line 22 of gafit that it points
to is where I include iostream (have tried both <iostream> and "iostream" to
see if it made any difference).  So I think that the g++ version of mingW32
may be the problem.

Any suggestions,

Tom





"Tom McCallum" <term at blueyonder.co.uk> wrote:

> Thanks for your reply, as an example it appears to have difficulty linking  
> to even ostream library of the standard C++, as shown below:
> 
> /home/tmccallum/ritzel/RItzel/src/Classifier.cpp:209: undefined reference  
> to `_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc'
> Classifier.o: In function `operator<<':
>
/usr/lib/gcc/i386-redhat-linux/4.0.2/../../../../include/c++/4.0.2/ostream:218:
>  
> undefined reference to `_ZNSolsEd'
>
/usr/lib/gcc/i386-redhat-linux/4.0.2/../../../../include/c++/4.0.2/ostream:196:
>  
> undefined reference to `_ZNSolsEl'
> 
> I am currently working R-2.4.0 as downloaded today.
> 
> I know the g++ has gone through some alterations and wondered if you knew  
> the version of g++ you cross-compiled your package with for comparison -  
> mine is g++ (GCC) 4.0.2 20051125 (Red Hat 4.0.2-8).
> 
> Many thanks
> 
> Tom
> 
> 
> On Wed, 25 Oct 2006 18:10:40 +0100, Ramon Diaz-Uriarte <rdiaz at cnio.es>  
> wrote:
> 
> > Dear Tom,
> >
> > It has worked for me out-of-the box in at least two times, one a while  
> > ago
> > with R-2.2-something and recently with R-2.4.0. In both cases, I was  
> > running
> > Debian (with a mix of testing and unstable) on x86. I never had to do
> > anything, just run the script and at least in one case I did  
> > crosscompile a
> > package with C++.
> >
> >
> > R.
> >
> > On Wednesday 25 October 2006 18:03, Tom McCallum wrote:
> >> Hi everyone,
> >>
> >> I am trying to cross-compile a package I wrote using the Yan and Rossini
> >> tutorial "Building Microsoft Windows versions of R and R packages using
> >> Intel Linux".  I have got reasonably far with this but when doing the
> >> linking using the line:
> >>
> >> i586-mingw32-g++  -shared -s  -o mylibrary.dll mylibrary.def mylibrary.o
> >> mylibrary_res.o  -L/my/path/RCrossBuild/WinR/R-2.4.0/bin -lR
> >>
> >> I get lots of these type of messages:
> >> /my/path/to/mylibrary.cpp:43: undefined reference to
> >> `_GLOBAL_OFFSET_TABLE_'
> >>
> >> and other similar linker errors for virtually every object and command  
> >> in
> >> the program.  After some googling I have found that there may be  
> >> problems
> >> with the libgcc.a library and its default -fPIC argument during
> >> compilation.
> >>
> >> Has anyone got this tutorial to work and if so how did they overcome  
> >> this?
> >>
> >> I am attempting to do this on Fedora Core 4 on a 32-bit machine, having
> >> completed all the previous sections of the tutorial for building a
> >> cross-platform version of R.
> >>
> >> Many thanks
> >>
> >> Tom
> >
> 
>



From tom at levelelimited.com  Thu Oct 26 09:25:19 2006
From: tom at levelelimited.com (tom at levelelimited.com)
Date: Thu, 26 Oct 2006 08:25:19 +0100
Subject: [Rd] Cross-compilation
In-Reply-To: <j7qedl.u1t7jy@webmail.livemail.co.uk>
References: <op.thziv9jjmfjo24@norisk> <200610251910.40831.rdiaz@cnio.es>
	<op.thzmt7scmfjo24@norisk> <j7qedl.u1t7jy@webmail.livemail.co.uk>
Message-ID: <j7qfa7.gagzbc@webmail.livemail.co.uk>

False alarm, those errors were due to the old iostream R.h ordering required -
so not a lead after all.

Tom

tom at levelelimited.com wrote:

> More information for you.
> 
> In order to test some ideas I had I first attempted to compile the gafit
> package which is just a single file - this compiled fine (this is a C
> package).  
> 
> I then added the iostream library to it as so:
> 
> #include <iostream>
> 
> and altered the extension from c to cpp so it would compile as a C++ program
> and I get the following:
> 
> *********************************
>    START OUTPUT
> *********************************
> export
>
PATH=/my/path/RCrossBuild/cross-tools/bin:/my/path/RCrossBuild/cross-tools/mingw32/bin:/usr/local/pgsql/bin:/home/tmccallum/sbin:/usr/java/jdk1.5.0_06/bin:/usr/java/jdk1.5.0_06/jre/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin:/home/tmccallum/bin;
> \
> export mypkg=`echo gafittest | cut -d'_' -f1,1`; \
> export mypkg_v=gafittest; \
> cd /my/path/RCrossBuild/pkgsrc; \
> rm -rf $mypkg; \
> tar zxf gafittest.tar.gz; \
> echo ---        ----$mypkg------; \
> cd /my/path/RCrossBuild/WinR/R-2.4.0/src/gnuwin32/; \
> make PKGDIR=/my/path/RCrossBuild/pkgsrc RLIB=/my/path/RCrossBuild/WinRlibs
> STAMP=no pkg-$mypkg; \
> mkdir -p         /my/path/RCrossBuild/WinRlibs; \
> cd /my/path/RCrossBuild/WinRlibs; \
> rm -rf $mypkg_v.zip; \
> zip -rl $mypkg_v.zip $mypkg -x \*.so \*.dll \*.RData \*.rda \*.gz \*.zip
> \*.rds \*.pdf \*.ps;\
> zip -r9 $mypkg_v.zip $mypkg -i \*.so \*.dll \*.RData \*.rda \*.gz \*.zip
> \*.rds \*.pdf \*.ps;\
> rm -rf $mypkg_v
> --- ----gafittest------
> make[1]: Entering directory `/my/path/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'
> 
> ---------- Making package gafittest ------------
>   adding build stamp to DESCRIPTION
>   making DLL ...
> making gafit.d from gafit.cpp
> In file included from
>
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/bits/locale_facets.h:1533,
>                  from
>
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/bits/basic_ios.h:44,
>                  from
>
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/ios:51,
>                  from
>
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/ostream:45,
>                  from
>
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/iostream:45,
>                  from gafit.cpp:22:
>
/my/path/RCrossBuild/cross-tools/bin/../lib/gcc/i586-mingw32/3.4.5/../../../../include/c++/3.4.5/bits/codecvt.h:219:45:
> macro "length" passed 4 arguments, but takes just 1
> make[4]: *** [gafit.d] Error 1
> make[3]: *** [srcDynlib] Error 2
> make[2]: *** [all] Error 2
> make[1]: *** [pkg-gafittest] Error 2
> make[1]: Leaving directory `/my/path/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'
>   adding: gafittest/ (stored 0%)
>   adding: gafittest/DESCRIPTION (deflated 41%)
>   adding: gafittest/Meta/ (stored 0%)
>   adding: gafittest/COPYING (deflated 62%)
>   adding: gafittest/Meta/package.rds (deflated 54%)
> 
> *********************************
>    END OUTPUT
> *********************************
> 
> I have checked the search paths and it is using the includes in gcc 3.4.5
that
> come with mingW32 as the docs say it should.  Line 22 of gafit that it
points
> to is where I include iostream (have tried both <iostream> and "iostream" to
> see if it made any difference).  So I think that the g++ version of mingW32
> may be the problem.
> 
> Any suggestions,
> 
> Tom
> 
> 
> 
> 
> 
> "Tom McCallum" <term at blueyonder.co.uk> wrote:
> 
> > Thanks for your reply, as an example it appears to have difficulty linking
 
> > to even ostream library of the standard C++, as shown below:
> > 
> > /home/tmccallum/ritzel/RItzel/src/Classifier.cpp:209: undefined reference 

> > to `_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc'
> > Classifier.o: In function `operator<<':
> >
>
/usr/lib/gcc/i386-redhat-linux/4.0.2/../../../../include/c++/4.0.2/ostream:218:
> >  
> > undefined reference to `_ZNSolsEd'
> >
>
/usr/lib/gcc/i386-redhat-linux/4.0.2/../../../../include/c++/4.0.2/ostream:196:
> >  
> > undefined reference to `_ZNSolsEl'
> > 
> > I am currently working R-2.4.0 as downloaded today.
> > 
> > I know the g++ has gone through some alterations and wondered if you knew 

> > the version of g++ you cross-compiled your package with for comparison -  
> > mine is g++ (GCC) 4.0.2 20051125 (Red Hat 4.0.2-8).
> > 
> > Many thanks
> > 
> > Tom
> > 
> > 
> > On Wed, 25 Oct 2006 18:10:40 +0100, Ramon Diaz-Uriarte <rdiaz at cnio.es>  
> > wrote:
> > 
> > > Dear Tom,
> > >
> > > It has worked for me out-of-the box in at least two times, one a while  
> > > ago
> > > with R-2.2-something and recently with R-2.4.0. In both cases, I was  
> > > running
> > > Debian (with a mix of testing and unstable) on x86. I never had to do
> > > anything, just run the script and at least in one case I did  
> > > crosscompile a
> > > package with C++.
> > >
> > >
> > > R.
> > >
> > > On Wednesday 25 October 2006 18:03, Tom McCallum wrote:
> > >> Hi everyone,
> > >>
> > >> I am trying to cross-compile a package I wrote using the Yan and
Rossini
> > >> tutorial "Building Microsoft Windows versions of R and R packages using
> > >> Intel Linux".  I have got reasonably far with this but when doing the
> > >> linking using the line:
> > >>
> > >> i586-mingw32-g++  -shared -s  -o mylibrary.dll mylibrary.def
mylibrary.o
> > >> mylibrary_res.o  -L/my/path/RCrossBuild/WinR/R-2.4.0/bin -lR
> > >>
> > >> I get lots of these type of messages:
> > >> /my/path/to/mylibrary.cpp:43: undefined reference to
> > >> `_GLOBAL_OFFSET_TABLE_'
> > >>
> > >> and other similar linker errors for virtually every object and command 

> > >> in
> > >> the program.  After some googling I have found that there may be  
> > >> problems
> > >> with the libgcc.a library and its default -fPIC argument during
> > >> compilation.
> > >>
> > >> Has anyone got this tutorial to work and if so how did they overcome  
> > >> this?
> > >>
> > >> I am attempting to do this on Fedora Core 4 on a 32-bit machine, having
> > >> completed all the previous sections of the tutorial for building a
> > >> cross-platform version of R.
> > >>
> > >> Many thanks
> > >>
> > >> Tom
> > >
> > 
> >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From ggrothendieck at gmail.com  Thu Oct 26 11:26:20 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 26 Oct 2006 05:26:20 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45403561.1000808@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
Message-ID: <971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>

On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/25/2006 11:02 PM, Gabor Grothendieck wrote:
> > On 10/25/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
> >>> Suppose we have a function such as the following
> >>>
> >>> F <- function(f, x) f(x)+1
> >>>
> >>> which runs function f and then transforms it.  I would like the
> >>> corresponding function which works the same except that
> >>> unlike F returns an invisible result if and only if f does.
> >>>
> >>> Is there some way of determining whether f returns
> >>> an invisible result or not?
> >>>
> >>> Thus we want this:
> >>>
> >>> f <- function(x) x
> >>> g <- function(x) invisible(x)
> >>>
> >>>> F(f, 1)
> >>> 2
> >>>
> >>>> F(g, 1)
> >> I don't think there's a way to do that.  Internally there's a global
> >> flag called R_Visible; if it is set to zero, the value won't print.  But
> >>  it gets reset to 1 very easily (e.g. by adding 1 to the result of an
> >> invisible function), and it's not available in the API for you to write
> >> C code to look at it.
> >>
> >> I think you'll just have to do require the user of your F to tell you
> >> that they want the result to be invisible.
> >>
> >> Duncan Murdoch
> >>
> >
> > Perhaps R_Visible be made available at the R level in the future.
> > It would be helpful in situations where you are transforming a
> > function but want to keep aspects of it such as whether the
> > return result is invisible.
>
> Actually, there is a way, but it's undocumented (i.e., use at your own
> risk).  It's the eval.with.vis function.  This is an internal function
> that is used within source() and capture.output(); you'll have to guess
> from the usage there what the args are.   But here's an F that does
> something close to what you want:
>
>  > fix(F)
>  > f <- function() 1
>  > g <- function() invisible(1)
>  >
>  > F <- function (expr)
> + {
> +     expr <- substitute(expr)
> +     pf <- parent.frame()
> +     tmp <- .Internal(eval.with.vis(expr, pf,
> +         baseenv()))
> +     tmp
> + }
>  > F(f())
> $value
> [1] 1
>
> $visible
> [1] TRUE
>
>  > F(g())
> $value
> [1] 1
>
> $visible
> [1] FALSE
>
>


Perfect.  Thanks!!!!



From phgrosjean at sciviews.org  Thu Oct 26 12:28:43 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Thu, 26 Oct 2006 12:28:43 +0200
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
Message-ID: <45408DDB.6060308@sciviews.org>



> On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
[...]
>> Actually, there is a way, but it's undocumented (i.e., use at your own
>> risk).  It's the eval.with.vis function.  This is an internal function

Yes... and there are three problems here:
1) To spot the undocumented function one is looking for,
2) To figure out how to use it,
3) To rewrite your code regularly if you maintain packages that use 
several of such undocumented functions. This is the case of many R GUI 
projects... and one reason why staying up-to-date with the new versions 
of R (every 6 months) is a nightmare for these GUIs!

For instance, I use eval.with.vis() in the latest version of svSockets 
package in the SciViews bundle, but I am afraid to release it on CRAN 
because I know of the nightware I will face if this function (silently) 
changes its behavior in subsequent versions of R.

I guess there is no solution to this problem, since there is certainly a 
good reason for keeping portions of R code undocumented (and thus 
flagged as :" use-it-at-your-own-risk!"), but it does not eases our life!

Best,

Philippe Grosjean

>> that is used within source() and capture.output(); you'll have to guess
>> from the usage there what the args are.   But here's an F that does
>> something close to what you want:
>>
>>  > fix(F)
>>  > f <- function() 1
>>  > g <- function() invisible(1)
>>  >
>>  > F <- function (expr)
>> + {
>> +     expr <- substitute(expr)
>> +     pf <- parent.frame()
>> +     tmp <- .Internal(eval.with.vis(expr, pf,
>> +         baseenv()))
>> +     tmp
>> + }
>>  > F(f())
>> $value
>> [1] 1
>>
>> $visible
>> [1] TRUE
>>
>>  > F(g())
>> $value
>> [1] 1
>>
>> $visible
>> [1] FALSE
>>
>>



From maechler at stat.math.ethz.ch  Thu Oct 26 12:33:23 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 26 Oct 2006 12:33:23 +0200
Subject: [Rd] attachments on R mailing lists
In-Reply-To: <454016A3.2090308@sfu.ca>
References: <454016A3.2090308@sfu.ca>
Message-ID: <17728.36595.819699.895138@stat.math.ethz.ch>


>>>>> "Michael" == Michael Toews <mwtoews at sfu.ca>
>>>>>     on Wed, 25 Oct 2006 19:00:03 -0700 writes:

    Michael> Okay ... I'll try to attach that patch once more
    Michael> ... (does this list only accept certain exertions
    Michael> for attachments? I used '.patch', but it must have
    Michael> been filtered off, so I'll try '.patch.txt' now

It's not the file name, but the MIME type of an attachment which
is important.
  text/plain  is valid, e.g.,

The posting guide and even http://www.r-project.org/mail.html
mention this.

It seems your e-mail software does not allow to specify the MIME
type used, but rather determines it from the file extension.
Other e-mail client programs send all "unknown" attachments" as
binary; and most ascii texts seem "unknown" in this regard.

All this feels Micro$oftish and it is sad to see that such a 
softie--attitude also invades free software developments such as a
unix-based version Thunderbird which I'm guessing you use.

Regards,
Martin Maechler, ETH Zurich
(R mailing list manager)



From ggrothendieck at gmail.com  Thu Oct 26 12:38:01 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 26 Oct 2006 06:38:01 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45408DDB.6060308@sciviews.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45408DDB.6060308@sciviews.org>
Message-ID: <971536df0610260338i613f2f79n6f87b388b171246@mail.gmail.com>

On 10/26/06, Philippe Grosjean <phgrosjean at sciviews.org> wrote:
>
>
> > On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> [...]
> >> Actually, there is a way, but it's undocumented (i.e., use at your own
> >> risk).  It's the eval.with.vis function.  This is an internal function
>
> Yes... and there are three problems here:
> 1) To spot the undocumented function one is looking for,
> 2) To figure out how to use it,
> 3) To rewrite your code regularly if you maintain packages that use
> several of such undocumented functions. This is the case of many R GUI
> projects... and one reason why staying up-to-date with the new versions
> of R (every 6 months) is a nightmare for these GUIs!
>
> For instance, I use eval.with.vis() in the latest version of svSockets
> package in the SciViews bundle, but I am afraid to release it on CRAN
> because I know of the nightware I will face if this function (silently)
> changes its behavior in subsequent versions of R.
>
> I guess there is no solution to this problem, since there is certainly a
> good reason for keeping portions of R code undocumented (and thus
> flagged as :" use-it-at-your-own-risk!"), but it does not eases our life!
>
> Best,
>
> Philippe Grosjean
>
> >> that is used within source() and capture.output(); you'll have to guess
> >> from the usage there what the args are.   But here's an F that does
> >> something close to what you want:
> >>
> >>  > fix(F)
> >>  > f <- function() 1
> >>  > g <- function() invisible(1)
> >>  >
> >>  > F <- function (expr)
> >> + {
> >> +     expr <- substitute(expr)
> >> +     pf <- parent.frame()
> >> +     tmp <- .Internal(eval.with.vis(expr, pf,
> >> +         baseenv()))
> >> +     tmp
> >> + }
> >>  > F(f())
> >> $value
> >> [1] 1
> >>
> >> $visible
> >> [1] TRUE
> >>
> >>  > F(g())
> >> $value
> >> [1] 1
> >>
> >> $visible
> >> [1] FALSE
> >>
> >>
>
>

I will be using it in the next version of the gsubfn package and am also
considering it for an application in the dyn package too so that makes
two or three packages already.  I think it would be a good idea to make it
or equivalent generally available in R.



From murdoch at stats.uwo.ca  Thu Oct 26 12:44:06 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 26 Oct 2006 06:44:06 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45408DDB.6060308@sciviews.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45408DDB.6060308@sciviews.org>
Message-ID: <45409176.5040105@stats.uwo.ca>

On 10/26/2006 6:28 AM, Philippe Grosjean wrote:
> 
>> On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> [...]
>>> Actually, there is a way, but it's undocumented (i.e., use at your own
>>> risk).  It's the eval.with.vis function.  This is an internal function
> 
> Yes... and there are three problems here:
> 1) To spot the undocumented function one is looking for,
> 2) To figure out how to use it,
> 3) To rewrite your code regularly if you maintain packages that use 
> several of such undocumented functions. This is the case of many R GUI 
> projects... and one reason why staying up-to-date with the new versions 
> of R (every 6 months) is a nightmare for these GUIs!

Those are definitely real problems.

At the last useR meeting, Thomas Baier made an excellent suggestion: 
someone should put together an API specifically for R GUIs.  I think 
eval.with.vis would have to be part of such an API; there are dozens of 
other currently undocumented or unavailable functions as well.

This is a difficult project, because it would have to get agreement on 
what should be part of the API, and that will constrain future changes: 
  so there would be a lot of resistance to making it too constraining. 
It will need to be flexible, so that R isn't required to supply services 
that don't make sense in all contexts.

Duncan Murdoch

> For instance, I use eval.with.vis() in the latest version of svSockets 
> package in the SciViews bundle, but I am afraid to release it on CRAN 
> because I know of the nightware I will face if this function (silently) 
> changes its behavior in subsequent versions of R.
> 
> I guess there is no solution to this problem, since there is certainly a 
> good reason for keeping portions of R code undocumented (and thus 
> flagged as :" use-it-at-your-own-risk!"), but it does not eases our life!
> 
> Best,
> 
> Philippe Grosjean
> 
>>> that is used within source() and capture.output(); you'll have to guess
>>> from the usage there what the args are.   But here's an F that does
>>> something close to what you want:
>>>
>>>  > fix(F)
>>>  > f <- function() 1
>>>  > g <- function() invisible(1)
>>>  >
>>>  > F <- function (expr)
>>> + {
>>> +     expr <- substitute(expr)
>>> +     pf <- parent.frame()
>>> +     tmp <- .Internal(eval.with.vis(expr, pf,
>>> +         baseenv()))
>>> +     tmp
>>> + }
>>>  > F(f())
>>> $value
>>> [1] 1
>>>
>>> $visible
>>> [1] TRUE
>>>
>>>  > F(g())
>>> $value
>>> [1] 1
>>>
>>> $visible
>>> [1] FALSE
>>>
>>>



From ggrothendieck at gmail.com  Thu Oct 26 13:12:00 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 26 Oct 2006 07:12:00 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45409176.5040105@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45408DDB.6060308@sciviews.org> <45409176.5040105@stats.uwo.ca>
Message-ID: <971536df0610260412m776ca055o2fc440662d0161c1@mail.gmail.com>

Perhaps there could be a set of functions that are made available
without the promise of future compatibility but with the promise
that they will change less frequently than if they were not documented
and if they are changed the changes will be highlighted
to make it easier for the users of the API to know about such
changes.  That might overcome resistance stemming from the
fear of prematurely setting design decisions in stone.

On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/26/2006 6:28 AM, Philippe Grosjean wrote:
> >
> >> On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> > [...]
> >>> Actually, there is a way, but it's undocumented (i.e., use at your own
> >>> risk).  It's the eval.with.vis function.  This is an internal function
> >
> > Yes... and there are three problems here:
> > 1) To spot the undocumented function one is looking for,
> > 2) To figure out how to use it,
> > 3) To rewrite your code regularly if you maintain packages that use
> > several of such undocumented functions. This is the case of many R GUI
> > projects... and one reason why staying up-to-date with the new versions
> > of R (every 6 months) is a nightmare for these GUIs!
>
> Those are definitely real problems.
>
> At the last useR meeting, Thomas Baier made an excellent suggestion:
> someone should put together an API specifically for R GUIs.  I think
> eval.with.vis would have to be part of such an API; there are dozens of
> other currently undocumented or unavailable functions as well.
>
> This is a difficult project, because it would have to get agreement on
> what should be part of the API, and that will constrain future changes:
>  so there would be a lot of resistance to making it too constraining.
> It will need to be flexible, so that R isn't required to supply services
> that don't make sense in all contexts.
>
> Duncan Murdoch
>
> > For instance, I use eval.with.vis() in the latest version of svSockets
> > package in the SciViews bundle, but I am afraid to release it on CRAN
> > because I know of the nightware I will face if this function (silently)
> > changes its behavior in subsequent versions of R.
> >
> > I guess there is no solution to this problem, since there is certainly a
> > good reason for keeping portions of R code undocumented (and thus
> > flagged as :" use-it-at-your-own-risk!"), but it does not eases our life!
> >
> > Best,
> >
> > Philippe Grosjean
> >
> >>> that is used within source() and capture.output(); you'll have to guess
> >>> from the usage there what the args are.   But here's an F that does
> >>> something close to what you want:
> >>>
> >>>  > fix(F)
> >>>  > f <- function() 1
> >>>  > g <- function() invisible(1)
> >>>  >
> >>>  > F <- function (expr)
> >>> + {
> >>> +     expr <- substitute(expr)
> >>> +     pf <- parent.frame()
> >>> +     tmp <- .Internal(eval.with.vis(expr, pf,
> >>> +         baseenv()))
> >>> +     tmp
> >>> + }
> >>>  > F(f())
> >>> $value
> >>> [1] 1
> >>>
> >>> $visible
> >>> [1] TRUE
> >>>
> >>>  > F(g())
> >>> $value
> >>> [1] 1
> >>>
> >>> $visible
> >>> [1] FALSE
> >>>
> >>>
>
>



From Ted.Harding at nessie.mcc.ac.uk  Thu Oct 26 13:56:25 2006
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Thu, 26 Oct 2006 12:56:25 +0100 (BST)
Subject: [Rd] attachments on R mailing lists
In-Reply-To: <17728.36595.819699.895138@stat.math.ethz.ch>
Message-ID: <XFMail.061026125625.Ted.Harding@nessie.mcc.ac.uk>

On 26-Oct-06 Martin Maechler wrote:
> 
>>>>>> "Michael" == Michael Toews <mwtoews at sfu.ca>
>>>>>>     on Wed, 25 Oct 2006 19:00:03 -0700 writes:
> 
>     Michael> Okay ... I'll try to attach that patch once more
>     Michael> ... (does this list only accept certain exertions
>     Michael> for attachments? I used '.patch', but it must have
>     Michael> been filtered off, so I'll try '.patch.txt' now
> 
> It's not the file name, but the MIME type of an attachment which
> is important.
>   text/plain  is valid, e.g.,
> 
> The posting guide and even http://www.r-project.org/mail.html
> mention this.
> 
> It seems your e-mail software does not allow to specify the MIME
> type used, but rather determines it from the file extension.
> Other e-mail client programs send all "unknown" attachments" as
> binary; and most ascii texts seem "unknown" in this regard.

Mine (XFMail) always gives me the option to confirm or change the
MIME type it has determined from the extension or, if it does not
recognise the extension, I am asked to assign the MIME type.

> All this feels Micro$oftish and it is sad to see that such a 
> softie--attitude also invades free software developments such
> as a unix-based version Thunderbird which I'm guessing you use.

I have to agree with this. Quite apart from any criticisms one
may have of the quality of technical performance of M$ software,
one of its major annoyances since its early days has been its
tendency to "know better" than the user, and to assume control
over choices which the user would prefer to make judiciously.

One outstanding quality of Unix, and later Linux, is the fact
that the user can consciously choose and control what the software
does. Regrettably, Linux increasingly conceals this beneath
"user-friendly" interfaces which take control, softie-style.
This is undoubtedly an attempt to appeal to a wider user-base.
Fortunately, the underlying controllability is still accessible
in many cases if you lift the lid. But GUI-driven applications
such as web-browsers and web-based mailers tend to work from
the top (GUI) down, making this hard to reach.

Best wishes to all,
Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding at nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 26-Oct-06                                       Time: 12:56:22
------------------------------ XFMail ------------------------------



From phgrosjean at sciviews.org  Thu Oct 26 16:29:09 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Thu, 26 Oct 2006 16:29:09 +0200
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45409176.5040105@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45408DDB.6060308@sciviews.org> <45409176.5040105@stats.uwo.ca>
Message-ID: <4540C635.1010604@sciviews.org>



Duncan Murdoch wrote:
[...]
> At the last useR meeting, Thomas Baier made an excellent suggestion: 
> someone should put together an API specifically for R GUIs.  I think 
> eval.with.vis would have to be part of such an API; there are dozens of 
> other currently undocumented or unavailable functions as well.

Ah, ha! I am very happy to discover that Thomas Baier had this excellent 
idea at the last useR meeting. It is almost four years that I claims for 
a R GUI API. If you look  at the manual that comes with the SciViews 
bundle (available on CRAN), you will notice that there is a manual 
called 'SciViews-R, A GUI API and a suite of application for R' (see 
http://www.sciviews.org/SciViews-R/Manual.pdf) with about 50 pages that 
discuss several aspects related to R GUI APIs.

There are also threads in the R Wiki that discusses a similar topic 
(although more related to graphical widgets): 
http://wiki.r-project.org/rwiki/doku.php?id=developers:iwidgets&s=api, 
http://wiki.r-project.org/rwiki/doku.php?id=developers:gwidgets_api.
This is mainly the work of John Versani, after a discussion between Him, 
Simon Urbanek (iWidgets), Michael Lawrence (RGtk2), and myself (SciViews).

That said, I did several attempt to put all people at R-SIG-GUI around a 
table to define a common R GUI API,... and I got no significant echo. 
So, I personally give up with this topic and look at what others, 
perhaps stronger than me in R programming or in communication with other 
developers, will do.

But, please, do not give credit for "first idea" to someone else on such 
a topic... It is long enough that I fight for better R GUIs (for 
instance, http://www.r-project.org/GUI), that this looks offending to me!

Best,

Philippe Grosjean

> This is a difficult project, because it would have to get agreement on 
> what should be part of the API, and that will constrain future changes: 
>  so there would be a lot of resistance to making it too constraining. It 
> will need to be flexible, so that R isn't required to supply services 
> that don't make sense in all contexts.
> 
> Duncan Murdoch
> 
>> For instance, I use eval.with.vis() in the latest version of svSockets 
>> package in the SciViews bundle, but I am afraid to release it on CRAN 
>> because I know of the nightware I will face if this function 
>> (silently) changes its behavior in subsequent versions of R.
>>
>> I guess there is no solution to this problem, since there is certainly 
>> a good reason for keeping portions of R code undocumented (and thus 
>> flagged as :" use-it-at-your-own-risk!"), but it does not eases our life!
>>
>> Best,
>>
>> Philippe Grosjean
>>
>>>> that is used within source() and capture.output(); you'll have to guess
>>>> from the usage there what the args are.   But here's an F that does
>>>> something close to what you want:
>>>>
>>>>  > fix(F)
>>>>  > f <- function() 1
>>>>  > g <- function() invisible(1)
>>>>  >
>>>>  > F <- function (expr)
>>>> + {
>>>> +     expr <- substitute(expr)
>>>> +     pf <- parent.frame()
>>>> +     tmp <- .Internal(eval.with.vis(expr, pf,
>>>> +         baseenv()))
>>>> +     tmp
>>>> + }
>>>>  > F(f())
>>>> $value
>>>> [1] 1
>>>>
>>>> $visible
>>>> [1] TRUE
>>>>
>>>>  > F(g())
>>>> $value
>>>> [1] 1
>>>>
>>>> $visible
>>>> [1] FALSE
>>>>
>>>>
> 
> 
>



From pgilbert at bank-banque-canada.ca  Thu Oct 26 16:55:45 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 26 Oct 2006 10:55:45 -0400
Subject: [Rd] as.missing
In-Reply-To: <971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
Message-ID: <4540CC71.1010108@bank-banque-canada.ca>

I don't see how this solves the problem.

 > as.missing <- force
 >  f <- function(y, x=1) {cat(missing(x)) ; x}
 > g <- function(x) f(3,x)
 > g(1)
FALSE[1] 1
 > g()
TRUEError in f(3, x) : argument "x" is missing, with no default

I think I still have to put all the logic in g() to figure out if the 
argument is missing, rather than the nice clean solution of just passing 
the argument along to the function it calls. How does this differ from 
the problem I already have when I  specifying the argument as NULL and 
do all the checking in  g?

Paul

Gabor Grothendieck wrote:

> You can do it like this:
>
>> as.missing <- force
>> g <- function(x = as.missing()) missing(x)
>> g(3)
>
> [1] FALSE
>
>> g()
>
> [1] TRUE
>
> On 10/24/06, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
>
>> (I'm not sure if this is a request for a feature, or another instance
>> where a feature has eluded me for many years.)
>>
>> Often I have a function which calls other functions, and may often use
>> the default arguments to those functions, but needs the capability to
>> pass along non-default choices. I usually do this with some variation on
>>
>> foo <- function(x, foo2Args=NULL or a list(foo2defaults),
>>                    foo3Args=NULL or a list(foo3defaults))
>>
>> and then have logic to check for NULL, or use the list in combination
>> with do.call.  It is also possible to do this with ..., but it always
>> seems a bit dangerous passing all the unnamed arguments along to all the
>> functions being called, especially when I always seem to be calling
>> functions that have similar arguments (maxit, eps, start, frequency, 
>> etc).
>>
>> It is a situation I have learned to live with, but one of my
>> co-maintainers just pointed out to me that there should be a good way to
>> do this in R.  Perhaps there is something else I have missed all these
>> years?  Is there a way to do this cleanly? It would be nice to have
>> something like
>>
>> foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())
>>
>> then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but
>> these would get treated as if they were missing, unless they are given
>> other values.
>>
>> Paul Gilbert
>
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From tlumley at u.washington.edu  Thu Oct 26 17:32:37 2006
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu, 26 Oct 2006 08:32:37 -0700 (PDT)
Subject: [Rd] Error: invalid multibyte string
In-Reply-To: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>
References: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu>

On Thu, 26 Oct 2006, Henrik Bengtsson wrote:

> I'm observing the following on different platforms:
>
>> parse(text='"\\x7F"')
> expression("\177")
>> parse(text='"\\x80"')
> Error: invalid multibyte string

Yes. It's an invalid multibyte string.  In UTF-8 a single byte is a valid 
character string only if it is below x80, so x7F is fine but x80 is not. 
In fact x80 is not the leading byte of any valid UTF-8 character.

You have to work out what the Unicode code point is for whatever character 
you were expecting to be x80 and convert that to UTF-8.

I'm surprised that one of your UTF-8 machines worked -- I don't think it 
should.

 	-thomas

> ...
>> parse(text='"\\xFF"')
> Error: invalid multibyte string
>
> However,
>
> cat("\x7F\n\x80\n...\xFF\n")
>
> works.  Using R --vanilla.

> SYSTEMS GIVING THE ERROR:
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> x86_64-unknown-linux-gnu
> locale:
> LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C
>
> R version 2.4.0 Patched (2006-10-03 r39576)
> i686-pc-linux-gnu
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
>
> SYSTEMS OK:
> R version 2.4.0 Under development (unstable) (2006-07-23 r38687)
> x86_64-unknown-linux-gnu
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> R version 2.4.0 (2006-10-03)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> R version 2.4.0 Patched (2006-10-10 r39600)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_Australia.1252;LC_CTYPE=English_Australia.1252;LC_MONETARY=En
> glish_Australia.1252;LC_NUMERIC=C;LC_TIME=English_Australia.1252
>
> Version 2.3.0 (2006-04-24)
> x86_64-unknown-linux-gnu
> locale: <not reported>
>
>
> All of the above have the following packages attached:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> [7] "base"
>
> We identified this problem because R CMD check complained:
>
>> * checking package dependencies ... WARNING
>> Error in deparse(e[[2]]) : invalid multibyte string
>> Execution halted
>
> because we use "\xFF" (or "\377") in the source code to be used as a
> terminator in a vector buffer; "\0" can't be used for other reasons.
>
> Is the above a bug in R or one in my head?
>
> /H
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle



From p.dalgaard at biostat.ku.dk  Thu Oct 26 18:43:45 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 26 Oct 2006 18:43:45 +0200
Subject: [Rd] Error: invalid multibyte string
In-Reply-To: <Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu>
References: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>
	<Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu>
Message-ID: <x2hcxrrpry.fsf@turmalin.kubism.ku.dk>

Thomas Lumley <tlumley at u.washington.edu> writes:

> On Thu, 26 Oct 2006, Henrik Bengtsson wrote:
> 
> > I'm observing the following on different platforms:
> >
> >> parse(text='"\\x7F"')
> > expression("\177")
> >> parse(text='"\\x80"')
> > Error: invalid multibyte string
> 
> Yes. It's an invalid multibyte string.  In UTF-8 a single byte is a valid 
> character string only if it is below x80, so x7F is fine but x80 is not. 
> In fact x80 is not the leading byte of any valid UTF-8 character.
> 
> You have to work out what the Unicode code point is for whatever character 
> you were expecting to be x80 and convert that to UTF-8.
> 
> I'm surprised that one of your UTF-8 machines worked -- I don't think it 
> should.

Interestingly, we can parse, but not print or deparse:

> x<-parse(text='"\\x80"')
> x
Error: invalid multibyte string
> z <- deparse(x)
Error in deparse(x) : invalid multibyte string
> cat(x[[1]])
?>

(the last line has a funny little cedilla-like symbol in pos 1)

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From sfalcon at fhcrc.org  Thu Oct 26 19:20:44 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Thu, 26 Oct 2006 10:20:44 -0700
Subject: [Rd] NA handling in as.character applied to a list
In-Reply-To: <x2d58gt4y6.fsf@turmalin.kubism.ku.dk> (Peter Dalgaard's message
	of "26 Oct 2006 00:18:25 +0200")
References: <m24ptsay46.fsf@ziti.local> <x2d58gt4y6.fsf@turmalin.kubism.ku.dk>
Message-ID: <m28xj32dub.fsf@ziti.local>

Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
> Hmm...
>
>> as.character(v)
> [1] NA   "NA" "NA"
>
> This does look like a leftover from times when there was no character
> NA in the language. It is the kind of thing you need to be very
> careful about fixing though. (I have a couple of scars from
> as.character on formulas when introducing backtick quoting.)

Well, I guess that's an argument for leaving the inconsistent
behavior.  In case there is interest in fixing, here is a patch I was
playing with.  It doesn't address the nasties with dput.  


index 8eec5c3..787c230 100644
--- a/src/main/coerce.c
+++ b/src/main/coerce.c
@@ -1041,6 +1041,14 @@ #if 0
            else if (isSymbol(VECTOR_ELT(v, i)))
                SET_STRING_ELT(rval, i, PRINTNAME(VECTOR_ELT(v, i)));
 #endif
+            else if ((length(VECTOR_ELT(v, i)) == 1) && 
+                      (isInteger(VECTOR_ELT(v, i)) ||
+                       isReal(VECTOR_ELT(v, i)) ||
+                       isLogical(VECTOR_ELT(v, i)))) {
+                SET_STRING_ELT(rval, i, 
+                               STRING_ELT(coerceVector(VECTOR_ELT(v, i), 
+                                                       STRSXP), 0));
+            }
            else
                SET_STRING_ELT(rval, i,
                               STRING_ELT(deparse1line(VECTOR_ELT(v, i), 0), 0));



From bill at insightful.com  Thu Oct 26 19:23:12 2006
From: bill at insightful.com (Bill Dunlap)
Date: Thu, 26 Oct 2006 10:23:12 -0700 (PDT)
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <454023EA.4020403@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
Message-ID: <Pine.GSO.4.56.0610261017090.22589@durian.statsci.com>

On Wed, 25 Oct 2006, Duncan Murdoch wrote:

> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
> > Suppose we have a function such as the following
> >
> > F <- function(f, x) f(x)+1
> >
> > which runs function f and then transforms it.  I would like the
> > corresponding function which works the same except that
> > unlike F returns an invisible result if and only if f does.
>
> I don't think there's a way to do that.  Internally there's a global
> flag called R_Visible; if it is set to zero, the value won't print.  But
>   it gets reset to 1 very easily (e.g. by adding 1 to the result of an
> invisible function), and it's not available in the API for you to write
> C code to look at it.

source(print.eval=TRUE) appears to do this by using an eval.with.vis()
function that calls a .Internal():
    eval.with.vis <- function(expr, envir = parent.frame(),
            enclos = if (is.list(envir) || is.pairlist(envir)) parent.frame() else baseenv())
            .Internal(eval.with.vis(expr, envir, enclos))
Perhaps that could be adapted for more general use.

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com
360-428-8146

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."



From hpages at fhcrc.org  Thu Oct 26 23:18:07 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Thu, 26 Oct 2006 14:18:07 -0700
Subject: [Rd] S4 pb in R 2.5.0
Message-ID: <4541260F.9020507@fhcrc.org>

Hi,

When playing interactively with the S4 system, I've tried
to define the following class:

    > setClass("A", representation("integer"))
    [1] "A"
    > showClass("A")
     
    Slots:
                  
    Name:    .Data
    Class: integer
     
    Extends:
    Class "integer", from data part
    Class "vector", by class "integer", distance 2
    Class "numeric", by class "integer", distance 2

then I realized that I made a typo (I don't want to extend
the "integer" type) so I redefined class A:

    > setClass("A", representation(toto="integer"))
    > showClass("A")
    Slots:
                  
    Name:     toto
    Class: integer

Now if I try to extend A:

    > setClass("Aa", representation("A"))
    Error in reconcilePropertiesAndPrototype(name, slots, prototype,
    superClasses,  :
            "A" is not eligible to be the data part of another class
    (must be a basic class or a virtual class with no slots)

Surprising. And even more surprising: I don't get this if I don't
try to define class A twice or if I invert the order of the 2 calls
to setClass("A", ...)!

    > sessionInfo()
    R version 2.4.0 (2006-10-03)
    x86_64-unknown-linux-gnu
     
    locale:
    LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
     
    attached base packages:
    [1] "methods"   "stats"     "graphics"  "grDevices" "utils"    
    "datasets"
    [7] "base"

No problem with R-2.4.0.

Thanks,
H.



From hpages at fhcrc.org  Fri Oct 27 01:20:33 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Thu, 26 Oct 2006 16:20:33 -0700
Subject: [Rd] Pb with .findInheritedMethods
Message-ID: <454142C1.9030809@fhcrc.org>

Hi again,


Here is a very simplified version of a class hierarchy
defined in the Biobase package (Bioconductor). I post
here because this seems to be an S4 related problem:

    setClass("A", representation(name="character"))
    setMethod("initialize", "A", function(.Object) {.Object at name <- "I'm
    an A"; .Object})

    setClass("Ab", contains="A")
    setMethod("initialize", "Ab", function(.Object) callNextMethod(.Object))

    setClass("Abc", contains="Ab")

    setClass("Abcd", contains = c("Abc"))

Now if I do:

    tmp1 <- new("Abc")
    tmp2 <- new("Abcd")

I get the following warning:

    Warning message:
    Ambiguous method selection for "initialize", target "Abcd" (the
    first of the signatures shown will be used)
        Abc
        Ab
     in: .findInheritedMethods(classes, fdef, mtable)

I don't really understand why .findInheritedMethods is
complaining here...
And if I don't do 'tmp1 <- new("Abc")' before I
do 'tmp2 <- new("Abcd")', then I don't get the warning
anymore!

Does anybody have an explanation for this?


Thanks,
H.



From murdoch at stats.uwo.ca  Fri Oct 27 01:21:07 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 26 Oct 2006 19:21:07 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4540C635.1010604@sciviews.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45408DDB.6060308@sciviews.org> <45409176.5040105@stats.uwo.ca>
	<4540C635.1010604@sciviews.org>
Message-ID: <454142E3.5000207@stats.uwo.ca>

On 10/26/2006 10:29 AM, Philippe Grosjean wrote:

> But, please, do not give credit for "first idea" to someone else on such 
> a topic... It is long enough that I fight for better R GUIs (for 
> instance, http://www.r-project.org/GUI), that this looks offending to me!

Sorry, I didn't mean to claim that he's the first one to think of this, 
just that he did bring it up recently, and that it's an excellent idea.

I think the fact that we don't have a GUI API is support for my 
statement that it's a difficult project.  Not all the difficulties are 
technical.

Duncan Murdoch



From murdoch at stats.uwo.ca  Fri Oct 27 01:21:19 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 26 Oct 2006 19:21:19 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610260412m776ca055o2fc440662d0161c1@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	
	<454023EA.4020403@stats.uwo.ca>	
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	
	<45403561.1000808@stats.uwo.ca>	
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>	
	<45408DDB.6060308@sciviews.org> <45409176.5040105@stats.uwo.ca>
	<971536df0610260412m776ca055o2fc440662d0161c1@mail.gmail.com>
Message-ID: <454142EF.3080009@stats.uwo.ca>

On 10/26/2006 7:12 AM, Gabor Grothendieck wrote:
> Perhaps there could be a set of functions that are made available
> without the promise of future compatibility but with the promise
> that they will change less frequently than if they were not documented
> and if they are changed the changes will be highlighted
> to make it easier for the users of the API to know about such
> changes.  That might overcome resistance stemming from the
> fear of prematurely setting design decisions in stone.

Actually, I think that's about as much of a guarantee as things that are 
set in stone get.  R is built of soft stone :-).

Duncan Murdoch

> 
> On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 10/26/2006 6:28 AM, Philippe Grosjean wrote:
>>>> On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>> [...]
>>>>> Actually, there is a way, but it's undocumented (i.e., use at your own
>>>>> risk).  It's the eval.with.vis function.  This is an internal function
>>> Yes... and there are three problems here:
>>> 1) To spot the undocumented function one is looking for,
>>> 2) To figure out how to use it,
>>> 3) To rewrite your code regularly if you maintain packages that use
>>> several of such undocumented functions. This is the case of many R GUI
>>> projects... and one reason why staying up-to-date with the new versions
>>> of R (every 6 months) is a nightmare for these GUIs!
>> Those are definitely real problems.
>>
>> At the last useR meeting, Thomas Baier made an excellent suggestion:
>> someone should put together an API specifically for R GUIs.  I think
>> eval.with.vis would have to be part of such an API; there are dozens of
>> other currently undocumented or unavailable functions as well.
>>
>> This is a difficult project, because it would have to get agreement on
>> what should be part of the API, and that will constrain future changes:
>>  so there would be a lot of resistance to making it too constraining.
>> It will need to be flexible, so that R isn't required to supply services
>> that don't make sense in all contexts.
>>
>> Duncan Murdoch
>>
>>> For instance, I use eval.with.vis() in the latest version of svSockets
>>> package in the SciViews bundle, but I am afraid to release it on CRAN
>>> because I know of the nightware I will face if this function (silently)
>>> changes its behavior in subsequent versions of R.
>>>
>>> I guess there is no solution to this problem, since there is certainly a
>>> good reason for keeping portions of R code undocumented (and thus
>>> flagged as :" use-it-at-your-own-risk!"), but it does not eases our life!
>>>
>>> Best,
>>>
>>> Philippe Grosjean
>>>
>>>>> that is used within source() and capture.output(); you'll have to guess
>>>>> from the usage there what the args are.   But here's an F that does
>>>>> something close to what you want:
>>>>>
>>>>>  > fix(F)
>>>>>  > f <- function() 1
>>>>>  > g <- function() invisible(1)
>>>>>  >
>>>>>  > F <- function (expr)
>>>>> + {
>>>>> +     expr <- substitute(expr)
>>>>> +     pf <- parent.frame()
>>>>> +     tmp <- .Internal(eval.with.vis(expr, pf,
>>>>> +         baseenv()))
>>>>> +     tmp
>>>>> + }
>>>>>  > F(f())
>>>>> $value
>>>>> [1] 1
>>>>>
>>>>> $visible
>>>>> [1] TRUE
>>>>>
>>>>>  > F(g())
>>>>> $value
>>>>> [1] 1
>>>>>
>>>>> $visible
>>>>> [1] FALSE
>>>>>
>>>>>
>>



From hpages at fhcrc.org  Fri Oct 27 02:58:56 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Thu, 26 Oct 2006 17:58:56 -0700
Subject: [Rd] S4 pb in R 2.5.0
In-Reply-To: <4541260F.9020507@fhcrc.org>
References: <4541260F.9020507@fhcrc.org>
Message-ID: <454159D0.10707@fhcrc.org>

Herve Pages wrote:
> ...
>
>     > sessionInfo()
>     R version 2.4.0 (2006-10-03)
>     x86_64-unknown-linux-gnu
>      
>     locale:
>     LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
>      
>     attached base packages:
>     [1] "methods"   "stats"     "graphics"  "grDevices" "utils"    
>     "datasets"
>     [7] "base"
>   

oops, please replace by

> sessionInfo()
R version 2.5.0 Under development (unstable) (2006-10-20 r39686)
x86_64-unknown-linux-gnu
 
locale:
LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
 
attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "base"

sorry,

> No problem with R-2.4.0.
>   

This is still true.


H.



From hpages at fhcrc.org  Fri Oct 27 03:02:44 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Thu, 26 Oct 2006 18:02:44 -0700
Subject: [Rd] Pb with .findInheritedMethods
In-Reply-To: <454142C1.9030809@fhcrc.org>
References: <454142C1.9030809@fhcrc.org>
Message-ID: <45415AB4.3050505@fhcrc.org>

Hi again,

This happens with R-2.4.0 and R-devel.

Cheers,
H.

Herve Pages wrote:
> Hi again,
>
>
> Here is a very simplified version of a class hierarchy
> defined in the Biobase package (Bioconductor). I post
> here because this seems to be an S4 related problem:
>
>     setClass("A", representation(name="character"))
>     setMethod("initialize", "A", function(.Object) {.Object at name <- "I'm
>     an A"; .Object})
>
>     setClass("Ab", contains="A")
>     setMethod("initialize", "Ab", function(.Object) callNextMethod(.Object))
>
>     setClass("Abc", contains="Ab")
>
>     setClass("Abcd", contains = c("Abc"))
>
> Now if I do:
>
>     tmp1 <- new("Abc")
>     tmp2 <- new("Abcd")
>
> I get the following warning:
>
>     Warning message:
>     Ambiguous method selection for "initialize", target "Abcd" (the
>     first of the signatures shown will be used)
>         Abc
>         Ab
>      in: .findInheritedMethods(classes, fdef, mtable)
>
> I don't really understand why .findInheritedMethods is
> complaining here...
> And if I don't do 'tmp1 <- new("Abc")' before I
> do 'tmp2 <- new("Abcd")', then I don't get the warning
> anymore!
>
> Does anybody have an explanation for this?
>
>
> Thanks,
> H.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From ggrothendieck at gmail.com  Fri Oct 27 03:30:07 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 26 Oct 2006 21:30:07 -0400
Subject: [Rd] as.missing
In-Reply-To: <4540CC71.1010108@bank-banque-canada.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
Message-ID: <971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>

This is what I get:

> as.missing <- force
> f <- function(y, x=1) {cat(missing(x)) ; x}
> g <- function(x=as.missing()) f(3,x)
> g()
FALSEError in as.missing() : argument "x" is missing, with no default
> traceback()
3: as.missing()
2: f(3, x)
1: g()
> traceback()
3: as.missing()
2: f(3, x)
1: g()

so g did in fact pass the missing to f and it was only f that blew up,
not g.  If that's not what you want please explain.


On 10/26/06, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
> I don't see how this solves the problem.
>
>  > as.missing <- force
>  >  f <- function(y, x=1) {cat(missing(x)) ; x}
>  > g <- function(x) f(3,x)
>  > g(1)
> FALSE[1] 1
>  > g()
> TRUEError in f(3, x) : argument "x" is missing, with no default
>
> I think I still have to put all the logic in g() to figure out if the
> argument is missing, rather than the nice clean solution of just passing
> the argument along to the function it calls. How does this differ from
> the problem I already have when I  specifying the argument as NULL and
> do all the checking in  g?
>
> Paul
>
> Gabor Grothendieck wrote:
>
> > You can do it like this:
> >
> >> as.missing <- force
> >> g <- function(x = as.missing()) missing(x)
> >> g(3)
> >
> > [1] FALSE
> >
> >> g()
> >
> > [1] TRUE
> >
> > On 10/24/06, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
> >
> >> (I'm not sure if this is a request for a feature, or another instance
> >> where a feature has eluded me for many years.)
> >>
> >> Often I have a function which calls other functions, and may often use
> >> the default arguments to those functions, but needs the capability to
> >> pass along non-default choices. I usually do this with some variation on
> >>
> >> foo <- function(x, foo2Args=NULL or a list(foo2defaults),
> >>                    foo3Args=NULL or a list(foo3defaults))
> >>
> >> and then have logic to check for NULL, or use the list in combination
> >> with do.call.  It is also possible to do this with ..., but it always
> >> seems a bit dangerous passing all the unnamed arguments along to all the
> >> functions being called, especially when I always seem to be calling
> >> functions that have similar arguments (maxit, eps, start, frequency,
> >> etc).
> >>
> >> It is a situation I have learned to live with, but one of my
> >> co-maintainers just pointed out to me that there should be a good way to
> >> do this in R.  Perhaps there is something else I have missed all these
> >> years?  Is there a way to do this cleanly? It would be nice to have
> >> something like
> >>
> >> foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())
> >>
> >> then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but
> >> these would get treated as if they were missing, unless they are given
> >> other values.
> >>
> >> Paul Gilbert
> >
> ====================================================================================
>
> La version fran?aise suit le texte anglais.
>
> ------------------------------------------------------------------------------------
>
> This email may contain privileged and/or confidential info...{{dropped}}



From hb at stat.berkeley.edu  Fri Oct 27 03:38:34 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Fri, 27 Oct 2006 11:38:34 +1000
Subject: [Rd] Error: invalid multibyte string
In-Reply-To: <x2hcxrrpry.fsf@turmalin.kubism.ku.dk>
References: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>
	<Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu>
	<x2hcxrrpry.fsf@turmalin.kubism.ku.dk>
Message-ID: <59d7961d0610261838m3dea1a2eq24d5a8b84c2a1b82@mail.gmail.com>

In Section "Package subdirectories" in "Writing R Extensions" [2.4.0
(2006-10-10)] it says:

"Only ASCII characters (and the control characters tab, formfeed, LF
and CR) should be used in code files. Other characters are accepted in
comments, but then the comments may not be readable in e.g. a UTF-8
locale. Non-ASCII characters in object names will normally [1] fail
when the package is installed. Any byte will be allowed [2] in a
quoted character string (but \uxxxx escapes should not be used), but
non-ASCII character strings may not be usable in some locales and may
display incorrectly in others.", where the footnote [2] reads "It is
good practice to encode them as octal or hex escape sequences".

(Note: ASCII refers (correctly) to the 7-bit ASCII [0-127] and none of
the 8-bit ASCII extensions [128-255].)

According to sentense about quoted strings, the following R/*.R code
should still be valid:

    pads <- sapply(0:64, FUN=function(x) paste(rep("\xFF", x), collapse=""));

or as we first had:

    pads <- sapply(0:64, FUN=function(x) paste(rep("\377", x), collapse=""));

Is R CMD check, or more precisely
tools:::.check_packages_used(dir=\"${pkgdir}\") in (perl script
bin/check) too picky?  In check_packages_used() there is an internal
function find_bad_exprs() trying to identify "bad expressions", and it
is when it tries to deparse() the above parse():ed code it complains.
This is exactly what Peter pointed out in his example.

Cheers

Henrik





On 26 Oct 2006 18:43:45 +0200, Peter Dalgaard <p.dalgaard at biostat.ku.dk> wrote:
> Thomas Lumley <tlumley at u.washington.edu> writes:
>
> > On Thu, 26 Oct 2006, Henrik Bengtsson wrote:
> >
> > > I'm observing the following on different platforms:
> > >
> > >> parse(text='"\\x7F"')
> > > expression("\177")
> > >> parse(text='"\\x80"')
> > > Error: invalid multibyte string
> >
> > Yes. It's an invalid multibyte string.  In UTF-8 a single byte is a valid
> > character string only if it is below x80, so x7F is fine but x80 is not.
> > In fact x80 is not the leading byte of any valid UTF-8 character.
> >
> > You have to work out what the Unicode code point is for whatever character
> > you were expecting to be x80 and convert that to UTF-8.
> >
> > I'm surprised that one of your UTF-8 machines worked -- I don't think it
> > should.
>
> Interestingly, we can parse, but not print or deparse:
>
> > x<-parse(text='"\\x80"')
> > x
> Error: invalid multibyte string
> > z <- deparse(x)
> Error in deparse(x) : invalid multibyte string
> > cat(x[[1]])
> ?>
>
> (the last line has a funny little cedilla-like symbol in pos 1)
>
> --
>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>



From dadrummond at gmail.com  Fri Oct 27 05:00:04 2006
From: dadrummond at gmail.com (dadrummond at gmail.com)
Date: Fri, 27 Oct 2006 05:00:04 +0200 (CEST)
Subject: [Rd] improperly persisting dialog after Source... on Macintel
	(PR#9318)
Message-ID: <20061027030004.5AA4B17553@slim.kubism.ku.dk>

Full_Name: Allan Drummond
Version: 2.3.1
OS: Mac OS X 10.4.8
Submission from: (NULL) (65.96.163.97)


When a file is sourced as the first, or near the first, step using R Gui on
Intel Macbook Pro running OS X 10.4.8, the "R File to Source" dialog reappears
upon switching away from and back to R Gui.

Using Intel Mac, steps are:

1) Open R Gui with at least one other application open
2) As first command, Source... a file (either cmd-shift-O or use menu), choosing
from dialog box.  Contents of file seem irrelevant.  Upon choosing the file, the
dialog should disappear as expected
3) Cmd-Tab to another open application
4) Cmd-Tab back to R.
5) "R File to Source" dialog reappears.  Now, it cannot be dismissed by Cancel
button, nor by any other means that I can detect.  Contents are
non-interactive.



From bhs2 at mevik.net  Fri Oct 27 11:09:17 2006
From: bhs2 at mevik.net (=?iso-8859-1?q?Bj=F8rn-Helge_Mevik?=)
Date: Fri, 27 Oct 2006 11:09:17 +0200
Subject: [Rd] as.missing
In-Reply-To: <971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
	(Gabor
	Grothendieck's message of "Thu, 26 Oct 2006 21:30:07 -0400")
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
Message-ID: <m0hcxq3z2a.fsf@bar.nemo-project.org>

Gabor Grothendieck wrote:

> This is what I get:
>
>> as.missing <- force
>> f <- function(y, x=1) {cat(missing(x)) ; x}
>> g <- function(x=as.missing()) f(3,x)
>> g()
> FALSEError in as.missing() : argument "x" is missing, with no default
>> traceback()
> 3: as.missing()
> 2: f(3, x)
> 1: g()
>> traceback()
> 3: as.missing()
> 2: f(3, x)
> 1: g()
>
> so g did in fact pass the missing to f and it was only f that blew up,
> not g.  If that's not what you want please explain.

I _think_ what he wants is:

> g()
TRUE[1] 1

I.e., when x is missing in g, and g calls f(3,x), f will use its
default value for x.

-- 
Bj?rn-Helge Mevik



From joehl at web.de  Fri Oct 27 11:14:25 2006
From: joehl at web.de (=?iso-8859-15?Q?Jens_Oehlschl=E4gel?=)
Date: Fri, 27 Oct 2006 11:14:25 +0200
Subject: [Rd] =?iso-8859-15?q?What_to_do_with_a_inconsistency_in_rank=28?=
 =?iso-8859-15?q?=29_that=27s_in_S+_and_R_ever_since=3F?=
Message-ID: <646350458@web.de>

Dear R-developers,

I just realized that rank() behaves inconsistent if combining one of na.last in {TRUE|FALSE} with a ties.method in {"average"|"random"|"max"|"min"}.
The documentation suggests that e.g. with na.last=TRUE NAs are treated like the last (=highest) value, which obviously is not the case:

> rank(c(1,2,2,NA,NA), na.last = TRUE, ties.method = c("average", "first", "random", "max", "min")[1])
[1] 1.0 2.5 2.5 4.0 5.0

I'd expect 

[1] 1.0 2.5 2.5 4.5 4.5

rather, but in fact NAs seem to be always treated ties.method = "first". I have no idea in which situation one could desire e.g. ties.method = "average" except for NAs!?

I am aware that the prototype behaves like this and R ever since behaves like this, however to me this appears very unfortunate. In order not to 'break' existing code, what about adding ties.methods {"NAaverage"|"NArandom"|"NAmax"|"NAmin"} that behave consistently? 

Best regards


Jens Oehlschl?gel


P.S. Please cc. me, I am not on the list


> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          4.0                         
year           2006                        
month          10                          
day            03                          
svn rev        39566                       
language       R                           
version.string R version 2.4.0 (2006-10-03)



From Bernhard_Pfaff at fra.invesco.com  Fri Oct 27 12:46:56 2006
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Fri, 27 Oct 2006 11:46:56 +0100
Subject: [Rd] all.names() and all.vars(): sorting order of functions' return
	vector
Message-ID: <E4A9111DA23BA048B9A46686BF727CF461BDD7@DEFRAXMB01.corp.amvescap.net>

Dear list-subscriber,

in the process of writing a general code snippet to extract coefficients
in an expression (in the example below: 0.5 and -0.7), I stumbled over
the following peculiar (at least peculiar to me:-) ) sorting behaviour
of the function all.names():

> expr1 <- expression(x3 = 0.5 * x1 - 0.7 * x2)
> all.names(expr1)
[1] "-"  "*"  "x1" "*"  "x2"
> all.vars(expr1)
[1] "x1" "x2"
> expr2 <- expression(x3 <-  0.5 * x1 - 0.7 * x2)
> all.names(expr2)
[1] "<-" "x3" "-"  "*"  "x1" "*"  "x2"
> all.vars(expr2)
[1] "x3" "x1" "x2"
> expr3 <- expression(x3 ~  0.5 * x1 - 0.7 * x2)
> all.names(expr3)
[1] "~"  "x3" "-"  "*"  "x1" "*"  "x2"
> all.vars(expr3)
[1] "x3" "x1" "x2"
> 

For all.names(expr2) and all.names(expr3) I would expect something like:

[1] "x3" "<-" "*" "x1" "-" "*" "x2"

[1] "x3" "~" "*" "x1" "-" "*" "x2"

To which kind of rule is the sorting order in the returned character
vector produced? Any help or pointers is much appreciated.

Best,
Bernhard


> sessionInfo()
R version 2.5.0 Under development (unstable) (2006-10-10 r39600) 
i386-pc-mingw32 

locale:
LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=
German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "datasets"  "utils"

[7] "base"     

other attached packages:
    nlme fortunes 
"3.1-77"  "1.3-2" 
> 
*****************************************************************
Confidentiality Note: The information contained in this mess...{{dropped}}



From term at blueyonder.co.uk  Fri Oct 27 13:11:45 2006
From: term at blueyonder.co.uk (Tom McCallum)
Date: Fri, 27 Oct 2006 12:11:45 +0100
Subject: [Rd] Overloading functions
Message-ID: <op.th2upvilmfjo24@norisk>

Hi Everyone

I have a function f which does something using a function g.  Function f  
is in a library and g has a default stub in the library but will be mainly  
overloaded in a later R script.  For example:

########## In a compiled package 'P' #################
g <- function() {
    cat("Original function g");
}

f <- function( newGsource=NULL ) {
     if( is.null(newGsource) == FALSE ) {
	source( newGsource ); # load new function g
     }	
     g();
     return(1);
}
#####################################################

If I call f() then I get "Original function g".

But I want to overload g so I do the following in the file newg.R:

############### CONTENTS of newg.R ##########################
g <- function() {
    cat("New function g in newg.R");
}
################ END CONTENTS ###############################

and call f( newGsource="newg.R" ) but I still get "Original function g".

Any suggestions?

Tom

-- 
---

Tom McCallum

WWW: http://www.tom-mccallum.com
Tel: 0131-4783393
Mobile: 07866-470257



From ggrothendieck at gmail.com  Fri Oct 27 13:21:23 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 27 Oct 2006 07:21:23 -0400
Subject: [Rd] all.names() and all.vars(): sorting order of functions'
	return vector
In-Reply-To: <E4A9111DA23BA048B9A46686BF727CF461BDD7@DEFRAXMB01.corp.amvescap.net>
References: <E4A9111DA23BA048B9A46686BF727CF461BDD7@DEFRAXMB01.corp.amvescap.net>
Message-ID: <971536df0610270421s5c28b228j3041935a4df8bfd1@mail.gmail.com>

Rewrite

   expr2 <- expression(x3 <-  0.5 * x1 - 0.7 * x2)

like this:

   expression(`<-`(x3, `-`(`*`(0.5, x1), `*`(0.7, x2))))

and it becomes clear.

On 10/27/06, Pfaff, Bernhard Dr. <Bernhard_Pfaff at fra.invesco.com> wrote:
> Dear list-subscriber,
>
> in the process of writing a general code snippet to extract coefficients
> in an expression (in the example below: 0.5 and -0.7), I stumbled over
> the following peculiar (at least peculiar to me:-) ) sorting behaviour
> of the function all.names():
>
> > expr1 <- expression(x3 = 0.5 * x1 - 0.7 * x2)
> > all.names(expr1)
> [1] "-"  "*"  "x1" "*"  "x2"
> > all.vars(expr1)
> [1] "x1" "x2"
> > expr2 <- expression(x3 <-  0.5 * x1 - 0.7 * x2)
> > all.names(expr2)
> [1] "<-" "x3" "-"  "*"  "x1" "*"  "x2"
> > all.vars(expr2)
> [1] "x3" "x1" "x2"
> > expr3 <- expression(x3 ~  0.5 * x1 - 0.7 * x2)
> > all.names(expr3)
> [1] "~"  "x3" "-"  "*"  "x1" "*"  "x2"
> > all.vars(expr3)
> [1] "x3" "x1" "x2"
> >
>
> For all.names(expr2) and all.names(expr3) I would expect something like:
>
> [1] "x3" "<-" "*" "x1" "-" "*" "x2"
>
> [1] "x3" "~" "*" "x1" "-" "*" "x2"
>
> To which kind of rule is the sorting order in the returned character
> vector produced? Any help or pointers is much appreciated.
>
> Best,
> Bernhard
>
>
> > sessionInfo()
> R version 2.5.0 Under development (unstable) (2006-10-10 r39600)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=
> German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "datasets"  "utils"
>
> [7] "base"
>
> other attached packages:
>    nlme fortunes
> "3.1-77"  "1.3-2"
> >
> *****************************************************************
> Confidentiality Note: The information contained in this mess...{{dropped}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From ggrothendieck at gmail.com  Fri Oct 27 13:31:39 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 27 Oct 2006 07:31:39 -0400
Subject: [Rd] all.names() and all.vars(): sorting order of functions'
	return vector
In-Reply-To: <E4A9111DA23BA048B9A46686BF727CF461BDD7@DEFRAXMB01.corp.amvescap.net>
References: <E4A9111DA23BA048B9A46686BF727CF461BDD7@DEFRAXMB01.corp.amvescap.net>
Message-ID: <971536df0610270431q4a54d36dke73fe9eaebbda580@mail.gmail.com>

Rewrite

   expr2 <- expression(x3 <-  0.5 * x1 - 0.7 * x2)

like this:

   expr2 <- expression(`<-`(x3, `-`(`*`(0.5, x1), `*`(0.7, x2))))

and it becomes clear.

On 10/27/06, Pfaff, Bernhard Dr. <Bernhard_Pfaff at fra.invesco.com> wrote:
> Dear list-subscriber,
>
> in the process of writing a general code snippet to extract coefficients
> in an expression (in the example below: 0.5 and -0.7), I stumbled over
> the following peculiar (at least peculiar to me:-) ) sorting behaviour
> of the function all.names():
>
> > expr1 <- expression(x3 = 0.5 * x1 - 0.7 * x2)
> > all.names(expr1)
> [1] "-"  "*"  "x1" "*"  "x2"
> > all.vars(expr1)
> [1] "x1" "x2"
> > expr2 <- expression(x3 <-  0.5 * x1 - 0.7 * x2)
> > all.names(expr2)
> [1] "<-" "x3" "-"  "*"  "x1" "*"  "x2"
> > all.vars(expr2)
> [1] "x3" "x1" "x2"
> > expr3 <- expression(x3 ~  0.5 * x1 - 0.7 * x2)
> > all.names(expr3)
> [1] "~"  "x3" "-"  "*"  "x1" "*"  "x2"
> > all.vars(expr3)
> [1] "x3" "x1" "x2"
> >
>
> For all.names(expr2) and all.names(expr3) I would expect something like:
>
> [1] "x3" "<-" "*" "x1" "-" "*" "x2"
>
> [1] "x3" "~" "*" "x1" "-" "*" "x2"
>
> To which kind of rule is the sorting order in the returned character
> vector produced? Any help or pointers is much appreciated.
>
> Best,
> Bernhard
>
>
> > sessionInfo()
> R version 2.5.0 Under development (unstable) (2006-10-10 r39600)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=
> German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "datasets"  "utils"
>
> [7] "base"
>
> other attached packages:
>    nlme fortunes
> "3.1-77"  "1.3-2"
> >
> *****************************************************************
> Confidentiality Note: The information contained in this mess...{{dropped}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



From jmc at r-project.org  Fri Oct 27 15:08:19 2006
From: jmc at r-project.org (John Chambers)
Date: Fri, 27 Oct 2006 09:08:19 -0400
Subject: [Rd] Pb with .findInheritedMethods
In-Reply-To: <45415AB4.3050505@fhcrc.org>
References: <454142C1.9030809@fhcrc.org> <45415AB4.3050505@fhcrc.org>
Message-ID: <454204C3.2030606@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061027/6d9485ff/attachment-0003.pl 

From jmc at r-project.org  Fri Oct 27 15:16:45 2006
From: jmc at r-project.org (John Chambers)
Date: Fri, 27 Oct 2006 09:16:45 -0400
Subject: [Rd] S4 pb in R 2.5.0
In-Reply-To: <4541260F.9020507@fhcrc.org>
References: <4541260F.9020507@fhcrc.org>
Message-ID: <454206BD.70605@r-project.org>

Thanks for the typo, it might have taken a while to find this one otherwise!

In 2.5.0 and 2.4patched, the subclass information attempts to be 
complete.  That subclass information needs to be removed from all 
superclasses when the class is redefined, and currently isn't.  The 
particular superclass link to "vector" is what makes the code think that 
"A" is meant to be the data part of the new class.  When you redefined 
"A" to no longer contain "integer", that link should have gone away.

Looks fairly straightforward to fix but as with your other bug report, 
may not happen for a few days.


Herve Pages wrote:
> Hi,
>
> When playing interactively with the S4 system, I've tried
> to define the following class:
>
>     > setClass("A", representation("integer"))
>     [1] "A"
>     > showClass("A")
>      
>     Slots:
>                   
>     Name:    .Data
>     Class: integer
>      
>     Extends:
>     Class "integer", from data part
>     Class "vector", by class "integer", distance 2
>     Class "numeric", by class "integer", distance 2
>
> then I realized that I made a typo (I don't want to extend
> the "integer" type) so I redefined class A:
>
>     > setClass("A", representation(toto="integer"))
>     > showClass("A")
>     Slots:
>                   
>     Name:     toto
>     Class: integer
>
> Now if I try to extend A:
>
>     > setClass("Aa", representation("A"))
>     Error in reconcilePropertiesAndPrototype(name, slots, prototype,
>     superClasses,  :
>             "A" is not eligible to be the data part of another class
>     (must be a basic class or a virtual class with no slots)
>
> Surprising. And even more surprising: I don't get this if I don't
> try to define class A twice or if I invert the order of the 2 calls
> to setClass("A", ...)!
>
>     > sessionInfo()
>     R version 2.4.0 (2006-10-03)
>     x86_64-unknown-linux-gnu
>      
>     locale:
>     LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
>      
>     attached base packages:
>     [1] "methods"   "stats"     "graphics"  "grDevices" "utils"    
>     "datasets"
>     [7] "base"
>
> No problem with R-2.4.0.
>
> Thanks,
> H.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



From pgilbert at bank-banque-canada.ca  Fri Oct 27 15:55:46 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 27 Oct 2006 09:55:46 -0400
Subject: [Rd] as.missing
In-Reply-To: <m0hcxq3z2a.fsf@bar.nemo-project.org>
References: <453E462C.6050103@bank-banque-canada.ca>	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>	<4540CC71.1010108@bank-banque-canada.ca>	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
	<m0hcxq3z2a.fsf@bar.nemo-project.org>
Message-ID: <45420FE2.5090000@bank-banque-canada.ca>



Bj?rn-Helge Mevik wrote:

>Gabor Grothendieck wrote:
>
>  
>
>>This is what I get:
>>
>>    
>>
>>>as.missing <- force
>>>f <- function(y, x=1) {cat(missing(x)) ; x}
>>>g <- function(x=as.missing()) f(3,x)
>>>g()
>>>      
>>>
>>FALSEError in as.missing() : argument "x" is missing, with no default
>>    
>>
>>>traceback()
>>>      
>>>
>>3: as.missing()
>>2: f(3, x)
>>1: g()
>>    
>>
>>>traceback()
>>>      
>>>
>>3: as.missing()
>>2: f(3, x)
>>1: g()
>>
>>so g did in fact pass the missing to f and it was only f that blew up,
>>not g.  If that's not what you want please explain.
>>    
>>
>
>I _think_ what he wants is:
>
>  
>
>>g()
>>    
>>
>TRUE[1] 1
>
>I.e., when x is missing in g, and g calls f(3,x), f will use its
>default value for x.
>  
>
Yes, that is the behaviour I am looking for. That is, f  should do what 
it normal would do if it were called with x missing.
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From p.dalgaard at biostat.ku.dk  Fri Oct 27 16:24:10 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 27 Oct 2006 16:24:10 +0200
Subject: [Rd] as.missing
In-Reply-To: <45420FE2.5090000@bank-banque-canada.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
	<m0hcxq3z2a.fsf@bar.nemo-project.org>
	<45420FE2.5090000@bank-banque-canada.ca>
Message-ID: <x2pscdltv9.fsf@turmalin.kubism.ku.dk>

Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:

> >I.e., when x is missing in g, and g calls f(3,x), f will use its
> >default value for x.
> >  
> >
> Yes, that is the behaviour I am looking for. That is, f  should do what 
> it normal would do if it were called with x missing.

But if x has a default in g then that default should presumably be
used? And what if x is given a value in the evaluation frame of g
before it is used by f (which can happen, you know, even after the
evaluation of f has begun)? Now imagine a longer chain of calls.

I think what you're asking for is essentially dynamic scoping for
missing arguments: you'd have to backtrack along the call chain to
find the first instance where x is either given a value or has a
default. This sounds messy.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From MOkoniewski at PICR.man.ac.uk  Fri Oct 27 16:50:17 2006
From: MOkoniewski at PICR.man.ac.uk (Michal Okoniewski)
Date: Fri, 27 Oct 2006 15:50:17 +0100
Subject: [Rd] RMySQL and stored procedures
Message-ID: <BAA35444B19AD940997ED02A6996AAE0048D73D5@sanmail.picr.man.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061027/42f7e7c8/attachment-0003.pl 

From term at blueyonder.co.uk  Fri Oct 27 16:54:40 2006
From: term at blueyonder.co.uk (Tom McCallum)
Date: Fri, 27 Oct 2006 15:54:40 +0100
Subject: [Rd] Overloading functions
In-Reply-To: <Pine.OSF.4.58.0610270842350.65414@wotan.mdacc.tmc.edu>
References: <op.th2upvilmfjo24@norisk>
	<Pine.OSF.4.58.0610270842350.65414@wotan.mdacc.tmc.edu>
Message-ID: <op.th241errmfjo24@norisk>

On Fri, 27 Oct 2006 14:49:15 +0100, Paul Roebuck <roebuck at mdanderson.org>  
wrote:

> On Fri, 27 Oct 2006, Tom McCallum wrote:
>
>> I have a function f which does something using a function g.  Function f
>> is in a library and g has a default stub in the library but will be  
>> mainly
>> overloaded in a later R script.  For example:
>>
>> ########## In a compiled package 'P' #################
>> g <- function() {
>>     cat("Original function g");
>> }
>>
>> f <- function( newGsource=NULL ) {
>>      if( is.null(newGsource) == FALSE ) {
>> 	source( newGsource ); # load new function g
>>      }
>>      g();
>>      return(1);
>> }
>> #####################################################
>>
>> If I call f() then I get "Original function g".
>>
>> But I want to overload g so I do the following in the file newg.R:
>>
>> ############### CONTENTS of newg.R ##########################
>> g <- function() {
>>     cat("New function g in newg.R");
>> }
>> ################ END CONTENTS ###############################
>>
>> and call f( newGsource="newg.R" ) but I still get "Original function g".
>>
>> Any suggestions?
>
> ?environment
>
> ----------------------------------------------------------
> SIGSIG -- signature too long (core dumped)
>
>

Thanks for that, have almost figured out how to do it,  have got my  
namespace but when I "assign" the new value
I get "cannot change value of a locked binding".  Is there any way to say  
that a particular item in a package
is able to be overridden using assign?

I assume when I export a function in the NAMESPACE file it is locking the  
value to the name.  So I assume it is here I need
to change something - if this is even possible to do.

Cheers

Tom

-- 
---

Tom McCallum



From tom.mccallum at levelelimited.com  Fri Oct 27 17:09:01 2006
From: tom.mccallum at levelelimited.com (Tom McCallum)
Date: Fri, 27 Oct 2006 16:09:01 +0100
Subject: [Rd] Overloading functions
In-Reply-To: <op.th241errmfjo24@norisk>
References: <op.th2upvilmfjo24@norisk>
	<Pine.OSF.4.58.0610270842350.65414@wotan.mdacc.tmc.edu>
	<op.th241errmfjo24@norisk>
Message-ID: <op.th25pbxdffxks9@norisk>

On Fri, 27 Oct 2006 15:54:40 +0100, Tom McCallum <term at blueyonder.co.uk>  
wrote:

> On Fri, 27 Oct 2006 14:49:15 +0100, Paul Roebuck <roebuck at mdanderson.org>
> wrote:
>
>> On Fri, 27 Oct 2006, Tom McCallum wrote:
>>
>>> I have a function f which does something using a function g.  Function  
>>> f
>>> is in a library and g has a default stub in the library but will be
>>> mainly
>>> overloaded in a later R script.  For example:
>>>
>>> ########## In a compiled package 'P' #################
>>> g <- function() {
>>>     cat("Original function g");
>>> }
>>>
>>> f <- function( newGsource=NULL ) {
>>>      if( is.null(newGsource) == FALSE ) {
>>> 	source( newGsource ); # load new function g
>>>      }
>>>      g();
>>>      return(1);
>>> }
>>> #####################################################
>>>
>>> If I call f() then I get "Original function g".
>>>
>>> But I want to overload g so I do the following in the file newg.R:
>>>
>>> ############### CONTENTS of newg.R ##########################
>>> g <- function() {
>>>     cat("New function g in newg.R");
>>> }
>>> ################ END CONTENTS ###############################
>>>
>>> and call f( newGsource="newg.R" ) but I still get "Original function  
>>> g".
>>>
>>> Any suggestions?
>>
>> ?environment
>>
>> ----------------------------------------------------------
>> SIGSIG -- signature too long (core dumped)
>>
>>
>
> Thanks for that, have almost figured out how to do it,  have got my
> namespace but when I "assign" the new value
> I get "cannot change value of a locked binding".  Is there any way to say
> that a particular item in a package
> is able to be overridden using assign?
>
> I assume when I export a function in the NAMESPACE file it is locking the
> value to the name.  So I assume it is here I need
> to change something - if this is even possible to do.
>
> Cheers
>
> Tom
>
  found the use of assignInNamespace - done!

Thanks for your help.



From murdoch at stats.uwo.ca  Fri Oct 27 17:23:55 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 27 Oct 2006 11:23:55 -0400
Subject: [Rd] as.missing
In-Reply-To: <x2pscdltv9.fsf@turmalin.kubism.ku.dk>
References: <453E462C.6050103@bank-banque-canada.ca>	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>	<4540CC71.1010108@bank-banque-canada.ca>	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>	<m0hcxq3z2a.fsf@bar.nemo-project.org>	<45420FE2.5090000@bank-banque-canada.ca>
	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>
Message-ID: <4542248B.2040703@stats.uwo.ca>

On 10/27/2006 10:24 AM, Peter Dalgaard wrote:
> Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
> 
>> >I.e., when x is missing in g, and g calls f(3,x), f will use its
>> >default value for x.
>> >  
>> >
>> Yes, that is the behaviour I am looking for. That is, f  should do what 
>> it normal would do if it were called with x missing.
> 
> But if x has a default in g then that default should presumably be
> used? And what if x is given a value in the evaluation frame of g
> before it is used by f (which can happen, you know, even after the
> evaluation of f has begun)? Now imagine a longer chain of calls.
> 
> I think what you're asking for is essentially dynamic scoping for
> missing arguments: you'd have to backtrack along the call chain to
> find the first instance where x is either given a value or has a
> default. This sounds messy.

I've been meaning to look at the code to see how this is handled now, 
but haven't had a chance yet.  I would guess at some level there's a 
test something like

if (name not in actualarglist) treat as missing
else treat as present

I think Paul's suggestion could be implemented by making this just a bit 
more complicated:

if (name not in actualarglist || get(name) == SpecialMissingValue) treat 
as missing
else treat as present

where SpecialMissingValue is what as.missing() returns.

So if my guess is right, this would be fairly easy to implement.  But 
it's also possible that this test shows up implicitly in many places, in 
which case it would be a lot messier.

Duncan Murdoch



From pgilbert at bank-banque-canada.ca  Fri Oct 27 17:30:21 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 27 Oct 2006 11:30:21 -0400
Subject: [Rd] as.missing
In-Reply-To: <x2pscdltv9.fsf@turmalin.kubism.ku.dk>
References: <453E462C.6050103@bank-banque-canada.ca>	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>	<4540CC71.1010108@bank-banque-canada.ca>	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>	<m0hcxq3z2a.fsf@bar.nemo-project.org>	<45420FE2.5090000@bank-banque-canada.ca>
	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>
Message-ID: <4542260D.2000606@bank-banque-canada.ca>



Peter Dalgaard wrote:

>Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
>
>  
>
>>>I.e., when x is missing in g, and g calls f(3,x), f will use its
>>>default value for x.
>>> 
>>>
>>>      
>>>
>>Yes, that is the behaviour I am looking for. That is, f  should do what 
>>it normal would do if it were called with x missing.
>>    
>>
>
>But if x has a default in g then that default should presumably be
>used? 
>
Yes.  The value of x in g would get passed to f, default or otherwise. 
If that value is something that indicates x is missing, then it should 
be treated as if it is missing in f. This means f should use its default 
value, rather than throw an error saying x is missing.

>And what if x is given a value in the evaluation frame of g
>before it is used by f (which can happen, you know, even after the
>evaluation of f has begun)? Now imagine a longer chain of calls.
>
>I think what you're asking for is essentially dynamic scoping for
>missing arguments: you'd have to backtrack along the call chain to
>find the first instance where x is either given a value or has a
>default. This sounds messy.
>  
>
You understand this better than I do, but I don't think I am asking to 
do this. Currently I think f  looks back too far and finds x is missing 
and g does not have a default value for x, so it throws an error.  Why 
can't f find its own default value for x?
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From tlumley at u.washington.edu  Fri Oct 27 17:34:18 2006
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri, 27 Oct 2006 08:34:18 -0700 (PDT)
Subject: [Rd] Error: invalid multibyte string
In-Reply-To: <59d7961d0610261838m3dea1a2eq24d5a8b84c2a1b82@mail.gmail.com>
References: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com> 
	<Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu> 
	<x2hcxrrpry.fsf@turmalin.kubism.ku.dk>
	<59d7961d0610261838m3dea1a2eq24d5a8b84c2a1b82@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610270826140.27715@homer23.u.washington.edu>

On Fri, 27 Oct 2006, Henrik Bengtsson wrote:

> In Section "Package subdirectories" in "Writing R Extensions" [2.4.0
> (2006-10-10)] it says:
>
> "Only ASCII characters (and the control characters tab, formfeed, LF
> and CR) should be used in code files. Other characters are accepted in
> comments, but then the comments may not be readable in e.g. a UTF-8
> locale. Non-ASCII characters in object names will normally [1] fail
> when the package is installed. Any byte will be allowed [2] in a
> quoted character string (but \uxxxx escapes should not be used), but
> non-ASCII character strings may not be usable in some locales and may
> display incorrectly in others.", where the footnote [2] reads "It is
> good practice to encode them as octal or hex escape sequences".
>
> (Note: ASCII refers (correctly) to the 7-bit ASCII [0-127] and none of
> the 8-bit ASCII extensions [128-255].)
>
> According to sentense about quoted strings, the following R/*.R code
> should still be valid:
>
>    pads <- sapply(0:64, FUN=function(x) paste(rep("\xFF", x), collapse=""));

That looks like it should be valid (at least according to the 
documentation), even though it won't run usefully on UTF-F locales.  What 
you wrote before was:

>> > On Thu, 26 Oct 2006, Henrik Bengtsson wrote:
>> >
>> > > I'm observing the following on different platforms:
>> > >
>> > >> parse(text='"\\x7F"')
>> > > expression("\177")
>> > >> parse(text='"\\x80"')
>> > > Error: invalid multibyte string

and that error *is* correct behaviour -- you can't parse() something that 
isn't a valid character string.

 	-thomas



From atp at piskorski.com  Fri Oct 27 17:38:32 2006
From: atp at piskorski.com (Andrew Piskorski)
Date: Fri, 27 Oct 2006 11:38:32 -0400
Subject: [Rd] What to do with a inconsistency in rank() that's in S+ and
	R ever since?
In-Reply-To: <646350458@web.de>
References: <646350458@web.de>
Message-ID: <20061027153832.GA45538@tehun.pair.com>

On Fri, Oct 27, 2006 at 11:14:25AM +0200, Jens Oehlschl?gel wrote:

> rather, but in fact NAs seem to be always treated ties.method =
> "first". I have no idea in which situation one could desire
> e.g. ties.method = "average" except for NAs!?

Interesting.  I was aware of the S-Plus vs. R difference, but I didn't
realize that it appears to be because R rank() ignores
ties.method="average" for NA values.

> I am aware that the prototype behaves like this and R ever since
> behaves like this, however to me this appears very unfortunate. In
> order not to 'break' existing code, what about adding ties.methods

If you only care about ranking integers and floating point numbers,
it's pretty straghtforward to take the S-Plus implementation of
rank(), call it to my.rank(), and use it in both R and S-Plus.  (Since
the R rank() makes calls to .Internal(), you can't re-use its
implementation in S-Plus.)

Note though that the S-Plus-style my.rank() will still sort strings
differently in R than in S-Plus.  I never looked into why.

Some old notes I have on this issue:

  R and S-Plus rank() treat NAs differently (which can magnifiy other
  floating point differences):

  # S-Plus 6.2.1:            # R 2.1.0:
  > rank(1:5)                > rank(1:5)
  [1] 1 2 3 4 5              [1] 1 2 3 4 5
  > rank(c(1,2,NA,4,NA))     > rank(c(1,2,NA,4,NA))
  [1] 1.0 2.0 4.5 3.0 4.5    [1] 1 2 4 3 5
  > rank(c(1,NA,3,4,NA))     > rank(c(1,NA,3,4,NA))
  [1] 1.0 4.5 2.0 3.0 4.5    [1] 1 4 2 3 5
  > rank(c(1,NA,3))          > rank(c(1,NA,3))
  [1] 1 3 2                  [1] 1 3 2
  > rank(c(NA,NA,3))         > rank(c(NA,NA,3))
  [1] 2.5 2.5 1.0            [1] 2 3 1

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/



From pgilbert at bank-banque-canada.ca  Fri Oct 27 17:38:05 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 27 Oct 2006 11:38:05 -0400
Subject: [Rd] as.missing
In-Reply-To: <4542248B.2040703@stats.uwo.ca>
References: <453E462C.6050103@bank-banque-canada.ca>	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>	<4540CC71.1010108@bank-banque-canada.ca>	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>	<m0hcxq3z2a.fsf@bar.nemo-project.org>	<45420FE2.5090000@bank-banque-canada.ca>
	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>
	<4542248B.2040703@stats.uwo.ca>
Message-ID: <454227DD.3000405@bank-banque-canada.ca>



Duncan Murdoch wrote:

> On 10/27/2006 10:24 AM, Peter Dalgaard wrote:
>
>> Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
>>
>>> >I.e., when x is missing in g, and g calls f(3,x), f will use its
>>> >default value for x.
>>> >  >
>>> Yes, that is the behaviour I am looking for. That is, f  should do 
>>> what it normal would do if it were called with x missing.
>>
>>
>> But if x has a default in g then that default should presumably be
>> used? And what if x is given a value in the evaluation frame of g
>> before it is used by f (which can happen, you know, even after the
>> evaluation of f has begun)? Now imagine a longer chain of calls.
>>
>> I think what you're asking for is essentially dynamic scoping for
>> missing arguments: you'd have to backtrack along the call chain to
>> find the first instance where x is either given a value or has a
>> default. This sounds messy.
>
>
> I've been meaning to look at the code to see how this is handled now, 
> but haven't had a chance yet.  I would guess at some level there's a 
> test something like
>
> if (name not in actualarglist) treat as missing
> else treat as present
>
> I think Paul's suggestion could be implemented by making this just a 
> bit more complicated:
>
> if (name not in actualarglist || get(name) == SpecialMissingValue) 
> treat as missing
> else treat as present
>
> where SpecialMissingValue is what as.missing() returns.
>
> So if my guess is right, this would be fairly easy to implement.  But 
> it's also possible that this test shows up implicitly in many places, 
> in which case it would be a lot messier.

Great! Let's hope it is not messy.  BTW, I don't have any special reason 
to think as.missing() should be a function. It could be a special  
defined constant.

>
> Duncan Murdoch
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From p.dalgaard at biostat.ku.dk  Fri Oct 27 17:40:37 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 27 Oct 2006 17:40:37 +0200
Subject: [Rd] as.missing
In-Reply-To: <4542260D.2000606@bank-banque-canada.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
	<m0hcxq3z2a.fsf@bar.nemo-project.org>
	<45420FE2.5090000@bank-banque-canada.ca>
	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>
	<4542260D.2000606@bank-banque-canada.ca>
Message-ID: <x2mz7hzs0a.fsf@turmalin.kubism.ku.dk>

Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:

> Peter Dalgaard wrote:
> 
> >Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
> >
> >
> >>>I.e., when x is missing in g, and g calls f(3,x), f will use its
> >>>default value for x.
> >>>
> >> Yes, that is the behaviour I am looking for. That is, f  should do
> >> what it normal would do if it were called with x missing.
> >>
> >
> >But if x has a default in g then that default should presumably be
> > used?
> Yes.  The value of x in g would get passed to f, default or otherwise.
> If that value is something that indicates x is missing, then it should
> be treated as if it is missing in f. This means f should use its
> default value, rather than throw an error saying x is missing.
> 
> >And what if x is given a value in the evaluation frame of g
> >before it is used by f (which can happen, you know, even after the
> >evaluation of f has begun)? Now imagine a longer chain of calls.
> >
> >I think what you're asking for is essentially dynamic scoping for
> >missing arguments: you'd have to backtrack along the call chain to
> >find the first instance where x is either given a value or has a
> >default. This sounds messy.
> >
> You understand this better than I do, but I don't think I am asking to
> do this. Currently I think f  looks back too far and finds x is
> missing and g does not have a default value for x, so it throws an
> error.  Why can't f find its own default value for x?

Because it's being told to use the value of the argument instead. I
think. 

This stuff is treacherous. E.g. what would you expect from this?

g <- function(x) {f <- function(y) {x <<- 1; y} ; f(x)}
g()

 
-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From pgilbert at bank-banque-canada.ca  Fri Oct 27 17:53:33 2006
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 27 Oct 2006 11:53:33 -0400
Subject: [Rd] as.missing
In-Reply-To: <x2mz7hzs0a.fsf@turmalin.kubism.ku.dk>
References: <453E462C.6050103@bank-banque-canada.ca>	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>	<4540CC71.1010108@bank-banque-canada.ca>	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>	<m0hcxq3z2a.fsf@bar.nemo-project.org>	<45420FE2.5090000@bank-banque-canada.ca>	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>	<4542260D.2000606@bank-banque-canada.ca>
	<x2mz7hzs0a.fsf@turmalin.kubism.ku.dk>
Message-ID: <45422B7D.204@bank-banque-canada.ca>



Peter Dalgaard wrote:

>Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
>
>  
>
>>Peter Dalgaard wrote:
>>
>>    
>>
>>>Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
>>>
>>>
>>>      
>>>
>>>>>I.e., when x is missing in g, and g calls f(3,x), f will use its
>>>>>default value for x.
>>>>>
>>>>>          
>>>>>
>>>>Yes, that is the behaviour I am looking for. That is, f  should do
>>>>what it normal would do if it were called with x missing.
>>>>
>>>>        
>>>>
>>>But if x has a default in g then that default should presumably be
>>>used?
>>>      
>>>
>>Yes.  The value of x in g would get passed to f, default or otherwise.
>>If that value is something that indicates x is missing, then it should
>>be treated as if it is missing in f. This means f should use its
>>default value, rather than throw an error saying x is missing.
>>
>>    
>>
>>>And what if x is given a value in the evaluation frame of g
>>>before it is used by f (which can happen, you know, even after the
>>>evaluation of f has begun)? Now imagine a longer chain of calls.
>>>
>>>I think what you're asking for is essentially dynamic scoping for
>>>missing arguments: you'd have to backtrack along the call chain to
>>>find the first instance where x is either given a value or has a
>>>default. This sounds messy.
>>>
>>>      
>>>
>>You understand this better than I do, but I don't think I am asking to
>>do this. Currently I think f  looks back too far and finds x is
>>missing and g does not have a default value for x, so it throws an
>>error.  Why can't f find its own default value for x?
>>    
>>
>
>Because it's being told to use the value of the argument instead. I
>think. 
>
>This stuff is treacherous. E.g. what would you expect from this?
>
>g <- function(x) {f <- function(y) {x <<- 1; y} ; f(x)}
>g()
>
>  
>
I'm confused.  Neither f nor g have a default here, so I don't think 
this is related to what I'm talking about. Currently, in your example, f 
find x with a value of 1, and I am not suggesting changing that. I'm 
only suggesting that if f finds x is missing, it should look at it's own 
default argument.
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}



From ggrothendieck at gmail.com  Fri Oct 27 18:24:12 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 27 Oct 2006 12:24:12 -0400
Subject: [Rd] as.missing
In-Reply-To: <971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
Message-ID: <971536df0610270924i284467c1q226404f8060f8628@mail.gmail.com>

On 10/26/06, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> This is what I get:
>
> > as.missing <- force
> > f <- function(y, x=1) {cat(missing(x)) ; x}
> > g <- function(x=as.missing()) f(3,x)
> > g()
> FALSEError in as.missing() : argument "x" is missing, with no default
> > traceback()
> 3: as.missing()
> 2: f(3, x)
> 1: g()
> > traceback()
> 3: as.missing()
> 2: f(3, x)
> 1: g()
>
> so g did in fact pass the missing to f and it was only f that blew up,
> not g.  If that's not what you want please explain.
>
>
> On 10/26/06, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
> > I don't see how this solves the problem.
> >
> >  > as.missing <- force
> >  >  f <- function(y, x=1) {cat(missing(x)) ; x}
> >  > g <- function(x) f(3,x)
> >  > g(1)
> > FALSE[1] 1
> >  > g()
> > TRUEError in f(3, x) : argument "x" is missing, with no default
> >
> > I think I still have to put all the logic in g() to figure out if the
> > argument is missing, rather than the nice clean solution of just passing
> > the argument along to the function it calls. How does this differ from
> > the problem I already have when I  specifying the argument as NULL and
> > do all the checking in  g?
> >
> > Paul
> >
> > Gabor Grothendieck wrote:
> >
> > > You can do it like this:
> > >
> > >> as.missing <- force
> > >> g <- function(x = as.missing()) missing(x)
> > >> g(3)
> > >
> > > [1] FALSE
> > >
> > >> g()
> > >
> > > [1] TRUE
> > >
> > > On 10/24/06, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
> > >
> > >> (I'm not sure if this is a request for a feature, or another instance
> > >> where a feature has eluded me for many years.)
> > >>
> > >> Often I have a function which calls other functions, and may often use
> > >> the default arguments to those functions, but needs the capability to
> > >> pass along non-default choices. I usually do this with some variation on
> > >>
> > >> foo <- function(x, foo2Args=NULL or a list(foo2defaults),
> > >>                    foo3Args=NULL or a list(foo3defaults))
> > >>
> > >> and then have logic to check for NULL, or use the list in combination
> > >> with do.call.  It is also possible to do this with ..., but it always
> > >> seems a bit dangerous passing all the unnamed arguments along to all the
> > >> functions being called, especially when I always seem to be calling
> > >> functions that have similar arguments (maxit, eps, start, frequency,
> > >> etc).
> > >>
> > >> It is a situation I have learned to live with, but one of my
> > >> co-maintainers just pointed out to me that there should be a good way to
> > >> do this in R.  Perhaps there is something else I have missed all these
> > >> years?  Is there a way to do this cleanly? It would be nice to have
> > >> something like
> > >>
> > >> foo <- function(x, foo2Args=as.missing(),  foo3Args=as.missing())
> > >>
> > >> then the call to foo2 and foo3 could specify  foo2Args and foo3Args, but
> > >> these would get treated as if they were missing, unless they are given
> > >> other values.
> > >>
> > >> Paul Gilbert
> > >
> > ====================================================================================
> >
> > La version fran?aise suit le texte anglais.
> >
> > ------------------------------------------------------------------------------------
> >
> > This email may contain privileged and/or confidential information, and the Bank of
> > Canada does not waive any related rights. Any distribution, use, or copying of this
> > email or the information it contains by other than the intended recipient is
> > unauthorized. If you received this email in error please delete it immediately from
> > your system and notify the sender promptly by email that you have done so.
> >
> > ------------------------------------------------------------------------------------
> >
> > Le pr?sent courriel peut contenir de l'information privil?gi?e ou confidentielle.
> > La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute diffusion,
> > utilisation ou copie de ce courriel ou des renseignements qu'il contient par une
> > personne autre que le ou les destinataires d?sign?s est interdite. Si vous recevez
> > ce courriel par erreur, veuillez le supprimer imm?diatement et envoyer sans d?lai ?
> > l'exp?diteur un message ?lectronique pour l'aviser que vous avez ?limin? de votre
> > ordinateur toute copie du courriel re?u.
> >
>

How about using this is.missing() instead of missing():


> is.missing <- function(x) {
+
+ mc <- match.call()
+ mc[[1]] <- as.name("missing")
+ missing <- eval.parent(mc)
+
+ xc <- deparse(substitute(x))
+ fo <- formals(sys.function(-1))
+ has.default <- !identical(fo[[xc]], alist(dummy=)[[1]])
+
+ if (has.default) {
+    mc <- match.call(sys.function(-1), call = sys.call(-1))
+    miss <- !(xc %in% names(mc))
+    miss <- miss || missing
+    if (missing)
+       eval.parent(substitute(x <- default, list(default = fo[[xc]])))
+    p <- parent.frame()
+    miss
+ } else missing
+ }
>
> g1 <- function(x = 3, y = 5, z) {
+ im <- is.missing(x)
+ print(im)
+ print(x)
+ }
> g1()
[1] TRUE
[1] 3
> f1 <- function(x) g1(x)
> f1()
[1] TRUE
[1] 3
> f1(10)
[1] FALSE
[1] 10
>
> g2 <- function(x = 3, y = 5, z) {
+ im <- if (is.missing(x)) TRUE else FALSE
+ print(im)
+ print(x)
+ }
> g2()
[1] TRUE
[1] 3
> f2 <- function(x) g2(x)
> f2()
[1] TRUE
[1] 3
> f2(20)
[1] FALSE
[1] 20
>
> ### this one does not seem to work -- is.missing can't be passed as arg
> g3 <- function(x = 3, y = 5, z) {
+ cat(is.missing(x), x, "\n")
+ }
>
> g3()
TRUE
> g3(30)
TRUE 30
>
> f3 <- function(x) g1(x)
> f3()
[1] TRUE
[1] 3
>
> gz <- function(x = 3, y = 5, z) {
+ im <- is.missing(z)
+ print(im)
+ try(print(z))
+ }
> gz()
[1] TRUE
Error in print(z) : argument "z" is missing, with no default
>



From luke at stat.uiowa.edu  Fri Oct 27 18:32:12 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 27 Oct 2006 11:32:12 -0500 (CDT)
Subject: [Rd] as.missing
In-Reply-To: <45422B7D.204@bank-banque-canada.ca>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
	<m0hcxq3z2a.fsf@bar.nemo-project.org>
	<45420FE2.5090000@bank-banque-canada.ca>
	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>
	<4542260D.2000606@bank-banque-canada.ca>
	<x2mz7hzs0a.fsf@turmalin.kubism.ku.dk>
	<45422B7D.204@bank-banque-canada.ca>
Message-ID: <Pine.LNX.4.64.0610271126070.7708@nokomis.stat.uiowa.edu>

There are lot of subtle issues involved here. We should think through
carefuly exactly what semantics we want for missing value propagation
before making any changes.  Making usage easy at top level is
genearlly a good thing, but for usage within functions eliminating
error messages by making more automated choices may not be a good
thing--it may mask real mistakes.

There are also issues with the internal implementation if missing
arguments we ned to think carefuly about before exposing them at teh R
level.  The fact that internally there is a missing argument token
does not mean it is a good thing to expose that detail at the R level
(and it already is in call objects and creates some issues with
computing on the language.

Like I said, it's complicated, so let's not leap before we look
carefully.

Best,

luke

On Fri, 27 Oct 2006, Paul Gilbert wrote:

>

Peter Dalgaard wrote:

>Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
>
> 
>
>>Peter Dalgaard wrote:
>>
>> 
>>
>>>Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
>>>
>>>
>>> 
>>>
>>>>>I.e., when x is missing in g, and g calls f(3,x), f will use its
>>>>>default value for x.
>>>>>
>>>>> 
>>>>>
>>>>Yes, that is the behaviour I am looking for. That is, f  should do
>>>>what it normal would do if it were called with x missing.
>>>>
>>>> 
>>>>
>>>But if x has a default in g then that default should presumably be
>>>used?
>>> 
>>>
>>Yes.  The value of x in g would get passed to f, default or otherwise.
>>If that value is something that indicates x is missing, then it should
>>be treated as if it is missing in f. This means f should use its
>>default value, rather than throw an error saying x is missing.
>>
>> 
>>
>>>And what if x is given a value in the evaluation frame of g
>>>before it is used by f (which can happen, you know, even after the
>>>evaluation of f has begun)? Now imagine a longer chain of calls.
>>>
>>>I think what you're asking for is essentially dynamic scoping for
>>>missing arguments: you'd have to backtrack along the call chain to
>>>find the first instance where x is either given a value or has a
>>>default. This sounds messy.
>>>
>>> 
>>>
>>You understand this better than I do, but I don't think I am asking to
>>do this. Currently I think f  looks back too far and finds x is
>>missing and g does not have a default value for x, so it throws an
>>error.  Why can't f find its own default value for x?
>> 
>>
>
>Because it's being told to use the value of the argument instead. I
>think. 
>
>This stuff is treacherous. E.g. what would you expect from this?
>
>g <- function(x) {f <- function(y) {x <<- 1; y} ; f(x)}
>g()
>
> 
>
I'm confused.  Neither f nor g have a default here, so I don't think 
this is related to what I'm talking about. Currently, in your example, f 
find x with a value of 1, and I am not suggesting changing that. I'm 
only suggesting that if f finds x is missing, it should look at it's own 
default argument.
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential inform...{{dropped}}

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From ggrothendieck at gmail.com  Fri Oct 27 19:36:18 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 27 Oct 2006 13:36:18 -0400
Subject: [Rd] Idea: Testimonials
Message-ID: <971536df0610271036l15c8c46ahb549331458668afd@mail.gmail.com>

It occurred to me that we could have an optional file called TESTIMONIALS
that comes with each package which could be a list of short testimonials from
users indicating success with that package and possibly a few details of
the successful application, e.g. it was used to analyse xyz data.

Users would be encouraged to send in testimonials.

This would give new users an immediate idea of what others have
done with any given package.

It would be up to the authors and maintainer to solicit the testimonials.
The author and maintainer could list their own applications in
that file too if they wished.

Another possibility is to place the testimonials in the vignette if there
is one.



From hpages at fhcrc.org  Fri Oct 27 20:22:08 2006
From: hpages at fhcrc.org (Herve Pages)
Date: Fri, 27 Oct 2006 11:22:08 -0700
Subject: [Rd] Pb with .findInheritedMethods
In-Reply-To: <454204C3.2030606@r-project.org>
References: <454142C1.9030809@fhcrc.org> <45415AB4.3050505@fhcrc.org>
	<454204C3.2030606@r-project.org>
Message-ID: <45424E50.8030206@fhcrc.org>

Hi John,


John Chambers wrote:
> A problem with callNextMethod, which is caching an inherited method as
> if it was not inherited, causing confusion on the next search.  Should
> be fairly easy to fix, but may be a while before I get time to do so.
>
> By the way, I hope your simplified example does not reflect what
> happens in the actual one.
>    callNextMethod(.Object)
> throws away all the ... arguments to new(), which rather defeats the
> purpose of having initialize() methods.  Generally, callNextMethod()
> should get no arguments or all the arguments it needs, including ...
> See ?callNextMethod

Thanks for looking at this!

Yes it is a simplified version of a real case and
here .Object is all what callNextMethod() needs because
the initialize method for an "A" object takes no argument
other than .Object

More generally I don't see what's wrong with not passing
to callNextMethod all the arguments coming from the call
to new:

    setClass("A", representation(toto="integer"))
    setMethod("initialize", "A", function(.Object, toto0) {.Object at toto
    <- as.integer(toto0); .Object})
    new("A", 45.1)

    setClass("Ab", contains="A")
    setMethod("initialize", "Ab", function(.Object, x, y)
    callNextMethod(.Object, x*y+1))
    new("Ab", 5, 2)


Regards,

H.



From apjaworski at mmm.com  Fri Oct 27 20:55:53 2006
From: apjaworski at mmm.com (apjaworski at mmm.com)
Date: Fri, 27 Oct 2006 13:55:53 -0500
Subject: [Rd] sources of 2.4.0 patched
Message-ID: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>

Hi,

I have a question about the availability of tarballs for 2.4.0-patched.

I routinely compile and install fresh versions of R-patched as well as
R-devel every few days.  I do it mostly "for fun" but also to check for
possible build problems or problems with my development environment
(Win2000, cygwin plus all the necessary tools including MinGW compilers and
MiKTex).

I get the tarballs form ftp://ftp.stat.math.ethz.ch/Software/R and I
noticed that the only R-patched there is dated 2006-10-03, while R-devel is
up to 2006-10-25.  Did, by any chance, a depository for the R-patched
tarballs move someplace else, or is the 2006-10-03 version the latest one.

Thanks in advance,

Andy

__________________________________
Andy Jaworski
518-1-01
Process Laboratory
3M Corporate Research Laboratory
-----
E-mail: apjaworski at mmm.com
Tel:  (651) 733-6092
Fax:  (651) 736-3122



From bkinney at hmdc.harvard.edu  Fri Oct 27 21:20:05 2006
From: bkinney at hmdc.harvard.edu (bkinney at hmdc.harvard.edu)
Date: Fri, 27 Oct 2006 21:20:05 +0200 (CEST)
Subject: [Rd] pcre library in R (PR#9319)
Message-ID: <20061027192005.3523956228@slim.kubism.ku.dk>

Full_Name: Earl Kinney
Version: 2.4.0
OS: Red Hat Enterprise Linux 4
Submission from: (NULL) (140.247.116.214)


At HMDC, we make use of the cross building tools to build Windows R libraries on
Linux.  Recently when attempting to update the cross building environment to
2.4.0 we encountered a linker error.  The error reference an undefined symbol
"__pcre_ucp_findprop".  After walking through the code there appear to be a
combination of two problems:

1. Some of the PCRE code does not properly wrap ucp calls with appropriate
"#ifdef SUPPORT_UCP" directives.  I plan to report this to the PCRE developers.

2. In R, the implementations for this ucp function are removed, as R does not
link against the entire pcre library.

I was able to get around this problem by including the following files directly
from the PCRE distribution and adding them to the makefiles:

pcre_ucp_searchfuncs.c
ucptable.c

As this is such a trivial change, if you could please consider adding this to
future releases of R with this release of PCRE, I would be most appreciative.

Regards,
Earl (Bob) Kinney
UNIX Systsms Administrator
Harvard-MIT Data Center



From rfrancois at mango-solutions.com  Fri Oct 27 21:33:06 2006
From: rfrancois at mango-solutions.com (Romain Francois)
Date: Fri, 27 Oct 2006 20:33:06 +0100
Subject: [Rd] Idea: Testimonials
In-Reply-To: <971536df0610271036l15c8c46ahb549331458668afd@mail.gmail.com>
References: <971536df0610271036l15c8c46ahb549331458668afd@mail.gmail.com>
Message-ID: <45425EF2.5030502@mango-solutions.com>

Gabor Grothendieck wrote:
> It occurred to me that we could have an optional file called TESTIMONIALS
> that comes with each package which could be a list of short testimonials from
> users indicating success with that package and possibly a few details of
> the successful application, e.g. it was used to analyse xyz data.
>
> Users would be encouraged to send in testimonials.
>
> This would give new users an immediate idea of what others have
> done with any given package.
>
> It would be up to the authors and maintainer to solicit the testimonials.
> The author and maintainer could list their own applications in
> that file too if they wished.
>
> Another possibility is to place the testimonials in the vignette if there
> is one.
>   
Hi,

Could that kind of things go to the wiki
http://wiki.r-project.org/rwiki/doku.php?id=packages:packages

Romain

-- 
*mangosolutions*
/data analysis that delivers/

Tel   +44 1249 467 467
Fax   +44 1249 467 468



From p.dalgaard at biostat.ku.dk  Sat Oct 28 00:08:24 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 28 Oct 2006 00:08:24 +0200
Subject: [Rd] as.missing
In-Reply-To: <Pine.LNX.4.64.0610271126070.7708@nokomis.stat.uiowa.edu>
References: <453E462C.6050103@bank-banque-canada.ca>
	<971536df0610250928q615c2e4dl950e8f576c492789@mail.gmail.com>
	<4540CC71.1010108@bank-banque-canada.ca>
	<971536df0610261830o4d36376bk4b90d42e218eb2d0@mail.gmail.com>
	<m0hcxq3z2a.fsf@bar.nemo-project.org>
	<45420FE2.5090000@bank-banque-canada.ca>
	<x2pscdltv9.fsf@turmalin.kubism.ku.dk>
	<4542260D.2000606@bank-banque-canada.ca>
	<x2mz7hzs0a.fsf@turmalin.kubism.ku.dk>
	<45422B7D.204@bank-banque-canada.ca>
	<Pine.LNX.4.64.0610271126070.7708@nokomis.stat.uiowa.edu>
Message-ID: <x21wot9ztz.fsf@turmalin.kubism.ku.dk>

Luke Tierney <luke at stat.uiowa.edu> writes:

> There are lot of subtle issues involved here. We should think through
> carefuly exactly what semantics we want for missing value propagation
> before making any changes.  Making usage easy at top level is
> genearlly a good thing, but for usage within functions eliminating
> error messages by making more automated choices may not be a good
> thing--it may mask real mistakes.
> 
> There are also issues with the internal implementation if missing
> arguments we ned to think carefuly about before exposing them at teh R
> level.  The fact that internally there is a missing argument token
> does not mean it is a good thing to expose that detail at the R level
> (and it already is in call objects and creates some issues with
> computing on the language.
> 
> Like I said, it's complicated, so let's not leap before we look
> carefully.

I think I'm beginning to realize what the problem really is: 

It would (conceptually, at least) be fairly simple to change the
current semantics of evaluating an argument to be like

   if (x is a promise)
     evaluate its expression part
   if (value is missing)
     if (there's a default)
         x <- evaluate default
     else
         x <- .Missing # missing value marker 

Then, if you have a chain where f1(x) calls f2(x) calls .... fn(x),  
and x is missing in the first call, fn() will see the first default
for x among f1, f2, ...., f(n-1) if any exists. 

One problem with this is when to declare an Error. It may or may not
be an error to have something evaluating to .Missing, depending on the
context in which the evaluation occurs. I'm pretty sure that is a Bad
Thing design-wise.

Another problem is that, currently, argument passing works by
assigning a promise to the name, which is either a promise to evaluate
the default expression or to evaluat the one in the actual argument.
With the change, you'd need to be able to evaluate defaults, even when
an expression has been passed as an argument, which probably means
that promises need to be three-pronged structures (value, expression,
default expression), or that you have to keep the formal argument list
around in the evaluation frame.


> Best,
> 
> luke
> 
> On Fri, 27 Oct 2006, Paul Gilbert wrote:
> 
> >
> 
> Peter Dalgaard wrote:
> 
> >Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
> >
> >
> >>Peter Dalgaard wrote:
> >>
> >>
> >>>Paul Gilbert <pgilbert at bank-banque-canada.ca> writes:
> >>>
> >>>
> >>>
> >>>>>I.e., when x is missing in g, and g calls f(3,x), f will use its
> >>>>>default value for x.
> >>>>>
> >>>>>
> >>>>Yes, that is the behaviour I am looking for. That is, f  should do
> >>>>what it normal would do if it were called with x missing.
> >>>>
> >>>>
> >>>But if x has a default in g then that default should presumably be
> >>>used?
> >>>
> >>Yes.  The value of x in g would get passed to f, default or otherwise.
> >>If that value is something that indicates x is missing, then it should
> >>be treated as if it is missing in f. This means f should use its
> >>default value, rather than throw an error saying x is missing.
> >>
> >>
> >>>And what if x is given a value in the evaluation frame of g
> >>>before it is used by f (which can happen, you know, even after the
> >>>evaluation of f has begun)? Now imagine a longer chain of calls.
> >>>
> >>>I think what you're asking for is essentially dynamic scoping for
> >>>missing arguments: you'd have to backtrack along the call chain to
> >>>find the first instance where x is either given a value or has a
> >>>default. This sounds messy.
> >>>
> >>>
> >>You understand this better than I do, but I don't think I am asking to
> >>do this. Currently I think f  looks back too far and finds x is
> >>missing and g does not have a default value for x, so it throws an
> >>error.  Why can't f find its own default value for x?
> >>
> >
> >Because it's being told to use the value of the argument instead. I
> > think. This stuff is treacherous. E.g. what would you expect from
> > this?
> >
> >g <- function(x) {f <- function(y) {x <<- 1; y} ; f(x)}
> >g()
> >
> >
> I'm confused.  Neither f nor g have a default here, so I don't think
> this is related to what I'm talking about. Currently, in your example,
> f find x with a value of 1, and I am not suggesting changing that. I'm
> only suggesting that if f finds x is missing, it should look at it's
> own default argument.

You can add defaults if you want. The thing I was illustrating is that
even though a missing x is passed for y, this is not checked until y
is needed, by which time x might have become non-missing. The point is
that even if you had 

g <- function(x) {f <- function(y=2) {x <<- 1; y} ; f(x)}

then once the f is called, y is a promise to evaluate x in g's frame
and the default expression is lost.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.dalgaard at biostat.ku.dk  Sat Oct 28 00:18:23 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 28 Oct 2006 00:18:23 +0200
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
Message-ID: <x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>

apjaworski at mmm.com writes:

> Hi,
> 
> I have a question about the availability of tarballs for 2.4.0-patched.
> 
> I routinely compile and install fresh versions of R-patched as well as
> R-devel every few days.  I do it mostly "for fun" but also to check for
> possible build problems or problems with my development environment
> (Win2000, cygwin plus all the necessary tools including MinGW compilers and
> MiKTex).
> 
> I get the tarballs form ftp://ftp.stat.math.ethz.ch/Software/R and I
> noticed that the only R-patched there is dated 2006-10-03, while R-devel is
> up to 2006-10-25.  Did, by any chance, a depository for the R-patched
> tarballs move someplace else, or is the 2006-10-03 version the latest one.

To my knowledge, neither. Something has gone wrong. The build date on
the file is Oct 27... I suspect that the svn update is somehow failing
on the machine that does the builds (i.e. it just keeps on building
from the 2006-10-03 checkout).

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From hb at stat.berkeley.edu  Sat Oct 28 00:40:55 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Sat, 28 Oct 2006 08:40:55 +1000
Subject: [Rd] Error: invalid multibyte string
In-Reply-To: <Pine.LNX.4.64.0610270826140.27715@homer23.u.washington.edu>
References: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>
	<Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu>
	<x2hcxrrpry.fsf@turmalin.kubism.ku.dk>
	<59d7961d0610261838m3dea1a2eq24d5a8b84c2a1b82@mail.gmail.com>
	<Pine.LNX.4.64.0610270826140.27715@homer23.u.washington.edu>
Message-ID: <59d7961d0610271540m4ec81c8fv427daeda2b2b5470@mail.gmail.com>

On 10/28/06, Thomas Lumley <tlumley at u.washington.edu> wrote:
> On Fri, 27 Oct 2006, Henrik Bengtsson wrote:
>
> > In Section "Package subdirectories" in "Writing R Extensions" [2.4.0
> > (2006-10-10)] it says:
> >
> > "Only ASCII characters (and the control characters tab, formfeed, LF
> > and CR) should be used in code files. Other characters are accepted in
> > comments, but then the comments may not be readable in e.g. a UTF-8
> > locale. Non-ASCII characters in object names will normally [1] fail
> > when the package is installed. Any byte will be allowed [2] in a
> > quoted character string (but \uxxxx escapes should not be used), but
> > non-ASCII character strings may not be usable in some locales and may
> > display incorrectly in others.", where the footnote [2] reads "It is
> > good practice to encode them as octal or hex escape sequences".
> >
> > (Note: ASCII refers (correctly) to the 7-bit ASCII [0-127] and none of
> > the 8-bit ASCII extensions [128-255].)
> >
> > According to sentense about quoted strings, the following R/*.R code
> > should still be valid:
> >
> >    pads <- sapply(0:64, FUN=function(x) paste(rep("\xFF", x), collapse=""));
>
> That looks like it should be valid (at least according to the
> documentation), even though it won't run usefully on UTF-F locales.  What
> you wrote before was:
>
> >> > On Thu, 26 Oct 2006, Henrik Bengtsson wrote:
> >> >
> >> > > I'm observing the following on different platforms:
> >> > >
> >> > >> parse(text='"\\x7F"')
> >> > > expression("\177")
> >> > >> parse(text='"\\x80"')
> >> > > Error: invalid multibyte string
>
> and that error *is* correct behaviour -- you can't parse() something that
> isn't a valid character string.

Hmm... are you really sure?  That should be a (double) quoted \x80
(four characters + quotes), which has been put in a (single) quoted
string where backslash is escaped?

Maybe it is more clear to write:

> expr <- parse(text='x <- "\\x41"')
> eval(expr)
> print(x)
[1] "A"

and same for

> expr <- parse(text='x <- "\\x7F"')
> eval(expr)
> print(x)
> expr <- parse(text='x <- "\\x80"')
> eval(expr)
> print(x)

(Unfortunately I can't access the machines that gives me the errors
right now, but I assume the error occurs when eval() is called.)

/H

>
>         -thomas
>



From tharkban at gmail.com  Sat Oct 28 01:33:20 2006
From: tharkban at gmail.com (tharkban at gmail.com)
Date: Sat, 28 Oct 2006 01:33:20 +0200 (CEST)
Subject: [Rd] interactive mode without tty (PR#9320)
Message-ID: <20061027233320.51DEC5621F@slim.kubism.ku.dk>

Full_Name: Manfred Georg
Version: 2.4.0
OS: linux
Submission from: (NULL) (128.252.166.190)


Hello,

I would like to see a command line flag
--interactive (--no-interactive)
or similar, to explicitly set whether we are in interactive mode on startup
(default, of course, remaining whether input is from a tty or not).  I had to
hack the source so that I could take input from a named pipe and get the
behavior I wanted, and that seems silly to me.  octave, provides exactly such a
flag, which I used, and it worked wonderfully.

This is a quick fix, I can provide a patch if you want.

Thank you,

Manfred



From gyadav at ccilindia.co.in  Sat Oct 28 05:36:00 2006
From: gyadav at ccilindia.co.in (gyadav at ccilindia.co.in)
Date: Sat, 28 Oct 2006 09:06:00 +0530
Subject: [Rd] ALARM!!!! Re: [R] regarding large csv file import
In-Reply-To: <644e1f320610270839o6570380dg54dfda85499efdf8@mail.gmail.com>
Message-ID: <OFEEEB3683.148EB1CE-ON65257215.00130BC3-65257214.0013D7B3@ccilindia.co.in>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061028/f500004d/attachment-0003.pl 

From gyadav at ccilindia.co.in  Sat Oct 28 09:21:18 2006
From: gyadav at ccilindia.co.in (gyadav at ccilindia.co.in)
Date: Sat, 28 Oct 2006 12:51:18 +0530
Subject: [Rd] ALARM!!!! Re: [R] regarding large csv file import
In-Reply-To: <644e1f320610272047i51cfed96mf9cbd97944b4c3ef@mail.gmail.com>
Message-ID: <OFFD6B3056.75603018-ON65257215.0027B6BE-65257214.00287802@ccilindia.co.in>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061028/6a7ff0ab/attachment-0003.pl 

From edd at debian.org  Sat Oct 28 15:30:38 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 28 Oct 2006 08:30:38 -0500
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
Message-ID: <17731.23422.758314.211918@basebud.nulle.part>


On 28 October 2006 at 00:18, Peter Dalgaard wrote:
| apjaworski at mmm.com writes:
| > I get the tarballs form ftp://ftp.stat.math.ethz.ch/Software/R and I
| > noticed that the only R-patched there is dated 2006-10-03, while R-devel is
| > up to 2006-10-25.  Did, by any chance, a depository for the R-patched
| > tarballs move someplace else, or is the 2006-10-03 version the latest one.
| 
| To my knowledge, neither. Something has gone wrong. The build date on
| the file is Oct 27... I suspect that the svn update is somehow failing
| on the machine that does the builds (i.e. it just keeps on building
| from the 2006-10-03 checkout).

That seems to be the case again this morning.

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From dsamperi at DecisionSynergy.com  Sat Oct 28 18:56:37 2006
From: dsamperi at DecisionSynergy.com (Dominick Samperi)
Date: Sat, 28 Oct 2006 12:56:37 -0400
Subject: [Rd] What can be effectively implemented in R vs C/C++?
Message-ID: <45438BC5.6020205@DecisionSynergy.com>

I have found that many numerical algorithms run much more
quickly when implemented in C/C++ than when implemented
as an R function, and this is not surprising, of course, because
R is an interpreted language. In particular, recursive R functions
seem to run very slowly.

Are there any general guidelines about what can be
effectively implemented as an R function vs what is best
implemented in C/C++, with R used as a front-end?

Thanks,
ds



From murdoch at stats.uwo.ca  Sat Oct 28 19:12:59 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 28 Oct 2006 13:12:59 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
Message-ID: <45438F9B.7000905@stats.uwo.ca>

On 10/26/2006 5:26 AM, Gabor Grothendieck wrote:
> On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 10/25/2006 11:02 PM, Gabor Grothendieck wrote:
>>> On 10/25/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
>>>>> Suppose we have a function such as the following
>>>>>
>>>>> F <- function(f, x) f(x)+1
>>>>>
>>>>> which runs function f and then transforms it.  I would like the
>>>>> corresponding function which works the same except that
>>>>> unlike F returns an invisible result if and only if f does.
>>>>>
>>>>> Is there some way of determining whether f returns
>>>>> an invisible result or not?
>>>>>
>>>>> Thus we want this:
>>>>>
>>>>> f <- function(x) x
>>>>> g <- function(x) invisible(x)
>>>>>
>>>>>> F(f, 1)
>>>>> 2
>>>>>
>>>>>> F(g, 1)
>>>> I don't think there's a way to do that.  Internally there's a global
>>>> flag called R_Visible; if it is set to zero, the value won't print.  But
>>>>  it gets reset to 1 very easily (e.g. by adding 1 to the result of an
>>>> invisible function), and it's not available in the API for you to write
>>>> C code to look at it.
>>>>
>>>> I think you'll just have to do require the user of your F to tell you
>>>> that they want the result to be invisible.
>>>>
>>>> Duncan Murdoch
>>>>
>>> Perhaps R_Visible be made available at the R level in the future.
>>> It would be helpful in situations where you are transforming a
>>> function but want to keep aspects of it such as whether the
>>> return result is invisible.
>> Actually, there is a way, but it's undocumented (i.e., use at your own
>> risk).  It's the eval.with.vis function.  This is an internal function
>> that is used within source() and capture.output(); you'll have to guess
>> from the usage there what the args are.   But here's an F that does
>> something close to what you want:
>>
>>  > fix(F)
>>  > f <- function() 1
>>  > g <- function() invisible(1)
>>  >
>>  > F <- function (expr)
>> + {
>> +     expr <- substitute(expr)
>> +     pf <- parent.frame()
>> +     tmp <- .Internal(eval.with.vis(expr, pf,
>> +         baseenv()))
>> +     tmp
>> + }
>>  > F(f())
>> $value
>> [1] 1
>>
>> $visible
>> [1] TRUE
>>
>>  > F(g())
>> $value
>> [1] 1
>>
>> $visible
>> [1] FALSE
>>
>>
> 
> 
> Perfect.  Thanks!!!!

I've just added this function to R-devel (to become 2.5.0 next spring):

withVisible <- function(x) {
     x <- substitute(x)
     v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
     v
}

Luke Tierney suggested simplifying the interface (no need to duplicate 
the 3 parameter eval interface, you can just wrap this in evalq() if you 
need that flexibility); the name "with.vis" was suggested, but it looks 
like an S3 method for the with() generic, so I renamed it.

Duncan Murdoch



From ggrothendieck at gmail.com  Sat Oct 28 19:39:43 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 28 Oct 2006 13:39:43 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45438F9B.7000905@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca>
Message-ID: <971536df0610281039g702780bbge339ea5423e38ad1@mail.gmail.com>

Thanks!

On 10/28/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/26/2006 5:26 AM, Gabor Grothendieck wrote:
> > On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 10/25/2006 11:02 PM, Gabor Grothendieck wrote:
> >>> On 10/25/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >>>> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
> >>>>> Suppose we have a function such as the following
> >>>>>
> >>>>> F <- function(f, x) f(x)+1
> >>>>>
> >>>>> which runs function f and then transforms it.  I would like the
> >>>>> corresponding function which works the same except that
> >>>>> unlike F returns an invisible result if and only if f does.
> >>>>>
> >>>>> Is there some way of determining whether f returns
> >>>>> an invisible result or not?
> >>>>>
> >>>>> Thus we want this:
> >>>>>
> >>>>> f <- function(x) x
> >>>>> g <- function(x) invisible(x)
> >>>>>
> >>>>>> F(f, 1)
> >>>>> 2
> >>>>>
> >>>>>> F(g, 1)
> >>>> I don't think there's a way to do that.  Internally there's a global
> >>>> flag called R_Visible; if it is set to zero, the value won't print.  But
> >>>>  it gets reset to 1 very easily (e.g. by adding 1 to the result of an
> >>>> invisible function), and it's not available in the API for you to write
> >>>> C code to look at it.
> >>>>
> >>>> I think you'll just have to do require the user of your F to tell you
> >>>> that they want the result to be invisible.
> >>>>
> >>>> Duncan Murdoch
> >>>>
> >>> Perhaps R_Visible be made available at the R level in the future.
> >>> It would be helpful in situations where you are transforming a
> >>> function but want to keep aspects of it such as whether the
> >>> return result is invisible.
> >> Actually, there is a way, but it's undocumented (i.e., use at your own
> >> risk).  It's the eval.with.vis function.  This is an internal function
> >> that is used within source() and capture.output(); you'll have to guess
> >> from the usage there what the args are.   But here's an F that does
> >> something close to what you want:
> >>
> >>  > fix(F)
> >>  > f <- function() 1
> >>  > g <- function() invisible(1)
> >>  >
> >>  > F <- function (expr)
> >> + {
> >> +     expr <- substitute(expr)
> >> +     pf <- parent.frame()
> >> +     tmp <- .Internal(eval.with.vis(expr, pf,
> >> +         baseenv()))
> >> +     tmp
> >> + }
> >>  > F(f())
> >> $value
> >> [1] 1
> >>
> >> $visible
> >> [1] TRUE
> >>
> >>  > F(g())
> >> $value
> >> [1] 1
> >>
> >> $visible
> >> [1] FALSE
> >>
> >>
> >
> >
> > Perfect.  Thanks!!!!
>
> I've just added this function to R-devel (to become 2.5.0 next spring):
>
> withVisible <- function(x) {
>     x <- substitute(x)
>     v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>     v
> }
>
> Luke Tierney suggested simplifying the interface (no need to duplicate
> the 3 parameter eval interface, you can just wrap this in evalq() if you
> need that flexibility); the name "with.vis" was suggested, but it looks
> like an S3 method for the with() generic, so I renamed it.
>
> Duncan Murdoch
>



From maechler at stat.math.ethz.ch  Sat Oct 28 21:48:50 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 28 Oct 2006 21:48:50 +0200
Subject: [Rd] Idea: Testimonials
In-Reply-To: <45425EF2.5030502@mango-solutions.com>
References: <971536df0610271036l15c8c46ahb549331458668afd@mail.gmail.com>
	<45425EF2.5030502@mango-solutions.com>
Message-ID: <17731.46114.942787.471256@stat.math.ethz.ch>

>>>>> "Romain" == Romain Francois <rfrancois at mango-solutions.com>
>>>>>     on Fri, 27 Oct 2006 20:33:06 +0100 writes:

    Romain> Gabor Grothendieck wrote:
    >> It occurred to me that we could have an optional file
    >> called TESTIMONIALS that comes with each package which
    >> could be a list of short testimonials from users
    >> indicating success with that package and possibly a few
    >> details of the successful application, e.g. it was used
    >> to analyse xyz data.
    >> 
    >> Users would be encouraged to send in testimonials.
    >> 
    >> This would give new users an immediate idea of what
    >> others have done with any given package.
    >> 
    >> It would be up to the authors and maintainer to solicit
    >> the testimonials.  The author and maintainer could list
    >> their own applications in that file too if they wished.
    >> 
    >> Another possibility is to place the testimonials in the
    >> vignette if there is one.
    >> 
    Romain> Hi,

    Romain> Could that kind of things go to the wiki
    Romain> http://wiki.r-project.org/rwiki/doku.php?id=packages:packages

Yes, I think it could, and even think it should.
For the time being the 'packages' section of the RWiki (URL
above) should be used much more in my view.

Here is ``my wish'' :

Ideally, for all CRAN (or Bioconductor or Omegahat) package
that's not there already,
there would be either
1) a nightly CRON job that built a web page template automatically,
   just from analyzing <CRAN>/src/packages/ content
2) a "button" that user could press which creates a web page
   template for package

These templates would already have a few pieces of information,
including a link to CRAN / BioC / ... for the package source
(and reference PDF).

--> and now the topic has really diverted and should probably be
continued on the R-SIG-Wiki mailing list.

Martin Maechler, ETH Zurich



From maechler at stat.math.ethz.ch  Sat Oct 28 22:15:34 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 28 Oct 2006 22:15:34 +0200
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <17731.23422.758314.211918@basebud.nulle.part>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
	<17731.23422.758314.211918@basebud.nulle.part>
Message-ID: <17731.47718.276693.860730@stat.math.ethz.ch>

>>>>> "Dirk" == Dirk Eddelbuettel <edd at debian.org>
>>>>>     on Sat, 28 Oct 2006 08:30:38 -0500 writes:

    Dirk> On 28 October 2006 at 00:18, Peter Dalgaard wrote: |
    Dirk> apjaworski at mmm.com writes: | > I get the tarballs form
    Dirk> ftp://ftp.stat.math.ethz.ch/Software/R and I | >
    Dirk> noticed that the only R-patched there is dated
    Dirk> 2006-10-03, while R-devel is | > up to 2006-10-25.
    Dirk> Did, by any chance, a depository for the R-patched | >
    Dirk> tarballs move someplace else, or is the 2006-10-03
    Dirk> version the latest one.  | | To my knowledge,
    Dirk> neither. Something has gone wrong. The build date on |
    Dirk> the file is Oct 27... I suspect that the svn update is
    Dirk> somehow failing | on the machine that does the builds
    Dirk> (i.e. it just keeps on building | from the 2006-10-03
    Dirk> checkout).

    Dirk> That seems to be the case again this morning.

but no longer now.
[A  "svn cleanup"  was needed.
 I've amended the cron-job script to do an "svn cleanup" now 
 always before "svn update".  This of course is a waste of time in
 99.9% of cases; but it's just a CPU's time, not a person's ....]

Usually such problems would be solved more quickly if someone
e-mailed me directly...

Martin Maechler, ETH Zurich



From jfox at mcmaster.ca  Sat Oct 28 22:28:27 2006
From: jfox at mcmaster.ca (John Fox)
Date: Sat, 28 Oct 2006 16:28:27 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45438F9B.7000905@stats.uwo.ca>
Message-ID: <20061028202827.SSTU1747.tomts25-srv.bellnexxia.net@JohnDesktop8300>

Dear Duncan,

Thanks for this -- it'll enable me to get rid of a list of functions
returning invisible output that the Rcmdr maintains.

Regards,
 John

--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario
Canada L8S 4M4
905-525-9140x23604
http://socserv.mcmaster.ca/jfox 
-------------------------------- 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
> Sent: Saturday, October 28, 2006 12:13 PM
> To: Gabor Grothendieck
> Cc: Luke Tierney; Martin Maechler; R Development Mailing List
> Subject: Re: [Rd] how to determine if a function's result is invisible
> 
> On 10/26/2006 5:26 AM, Gabor Grothendieck wrote:
> > On 10/26/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 10/25/2006 11:02 PM, Gabor Grothendieck wrote:
> >>> On 10/25/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >>>> On 10/25/2006 8:14 PM, Gabor Grothendieck wrote:
> >>>>> Suppose we have a function such as the following
> >>>>>
> >>>>> F <- function(f, x) f(x)+1
> >>>>>
> >>>>> which runs function f and then transforms it.  I would like the 
> >>>>> corresponding function which works the same except that 
> unlike F 
> >>>>> returns an invisible result if and only if f does.
> >>>>>
> >>>>> Is there some way of determining whether f returns an invisible 
> >>>>> result or not?
> >>>>>
> >>>>> Thus we want this:
> >>>>>
> >>>>> f <- function(x) x
> >>>>> g <- function(x) invisible(x)
> >>>>>
> >>>>>> F(f, 1)
> >>>>> 2
> >>>>>
> >>>>>> F(g, 1)
> >>>> I don't think there's a way to do that.  Internally there's a 
> >>>> global flag called R_Visible; if it is set to zero, the 
> value won't 
> >>>> print.  But  it gets reset to 1 very easily (e.g. by adding 1 to 
> >>>> the result of an invisible function), and it's not 
> available in the 
> >>>> API for you to write C code to look at it.
> >>>>
> >>>> I think you'll just have to do require the user of your 
> F to tell 
> >>>> you that they want the result to be invisible.
> >>>>
> >>>> Duncan Murdoch
> >>>>
> >>> Perhaps R_Visible be made available at the R level in the future.
> >>> It would be helpful in situations where you are transforming a 
> >>> function but want to keep aspects of it such as whether 
> the return 
> >>> result is invisible.
> >> Actually, there is a way, but it's undocumented (i.e., use at your 
> >> own risk).  It's the eval.with.vis function.  This is an internal 
> >> function that is used within source() and 
> capture.output(); you'll have to guess
> >> from the usage there what the args are.   But here's an F that does
> >> something close to what you want:
> >>
> >>  > fix(F)
> >>  > f <- function() 1
> >>  > g <- function() invisible(1)
> >>  >
> >>  > F <- function (expr)
> >> + {
> >> +     expr <- substitute(expr)
> >> +     pf <- parent.frame()
> >> +     tmp <- .Internal(eval.with.vis(expr, pf,
> >> +         baseenv()))
> >> +     tmp
> >> + }
> >>  > F(f())
> >> $value
> >> [1] 1
> >>
> >> $visible
> >> [1] TRUE
> >>
> >>  > F(g())
> >> $value
> >> [1] 1
> >>
> >> $visible
> >> [1] FALSE
> >>
> >>
> > 
> > 
> > Perfect.  Thanks!!!!
> 
> I've just added this function to R-devel (to become 2.5.0 
> next spring):
> 
> withVisible <- function(x) {
>      x <- substitute(x)
>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>      v
> }
> 
> Luke Tierney suggested simplifying the interface (no need to 
> duplicate the 3 parameter eval interface, you can just wrap 
> this in evalq() if you need that flexibility); the name 
> "with.vis" was suggested, but it looks like an S3 method for 
> the with() generic, so I renamed it.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From rjvbertin at gmail.com  Sat Oct 28 23:10:31 2006
From: rjvbertin at gmail.com (=?ISO-8859-1?Q?Ren=E9_J.V._Bertin?=)
Date: Sat, 28 Oct 2006 23:10:31 +0200
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <20061021141012.GA7466@tehun.pair.com>
References: <797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
	<20061021141012.GA7466@tehun.pair.com>
Message-ID: <797664590610281410x281addaelcd13d7d8cdf43968@mail.gmail.com>

I don't want to keep hammering on the possible interest of python in
this context... but have you seen this?

http://ipython.scipy.org/moin/Parallel_Computing

I know, not exactly the same as multithreading ;)



From edd at debian.org  Sat Oct 28 23:30:02 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 28 Oct 2006 16:30:02 -0500
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <17731.47718.276693.860730@stat.math.ethz.ch>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
	<17731.23422.758314.211918@basebud.nulle.part>
	<17731.47718.276693.860730@stat.math.ethz.ch>
Message-ID: <17731.52186.348264.984860@basebud.nulle.part>


On 28 October 2006 at 22:15, Martin Maechler wrote:
| >>>>> "Dirk" == Dirk Eddelbuettel <edd at debian.org>
| >>>>>     on Sat, 28 Oct 2006 08:30:38 -0500 writes:
| 
|     Dirk> On 28 October 2006 at 00:18, Peter Dalgaard wrote: |
|     Dirk> apjaworski at mmm.com writes: | > I get the tarballs form
|     Dirk> ftp://ftp.stat.math.ethz.ch/Software/R and I | >
|     Dirk> noticed that the only R-patched there is dated
|     Dirk> 2006-10-03, while R-devel is | > up to 2006-10-25.
|     Dirk> Did, by any chance, a depository for the R-patched | >
|     Dirk> tarballs move someplace else, or is the 2006-10-03
|     Dirk> version the latest one.  | | To my knowledge,
|     Dirk> neither. Something has gone wrong. The build date on |
|     Dirk> the file is Oct 27... I suspect that the svn update is
|     Dirk> somehow failing | on the machine that does the builds
|     Dirk> (i.e. it just keeps on building | from the 2006-10-03
|     Dirk> checkout).
| 
|     Dirk> That seems to be the case again this morning.
| 
| but no longer now.

Thanks!

| [A  "svn cleanup"  was needed.
|  I've amended the cron-job script to do an "svn cleanup" now 
|  always before "svn update".  This of course is a waste of time in
|  99.9% of cases; but it's just a CPU's time, not a person's ....]
| 
| Usually such problems would be solved more quickly if someone
| e-mailed me directly...

Put a README into the directory ?

[ BTW SVN 1.4.0, now in Debian testing testing apparently shrinks archive
size by a third but you need to 'dump' and 'restore'. ]

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From simon.urbanek at r-project.org  Sat Oct 28 23:33:11 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 28 Oct 2006 17:33:11 -0400
Subject: [Rd] [R] multithreading calling from the rpy Python package
In-Reply-To: <797664590610281410x281addaelcd13d7d8cdf43968@mail.gmail.com>
References: <797664590610200711w46a60957s44cd805ea7909a5b@mail.gmail.com>
	<20061021141012.GA7466@tehun.pair.com>
	<797664590610281410x281addaelcd13d7d8cdf43968@mail.gmail.com>
Message-ID: <EEEDC3B7-9867-4B64-AE00-218F325EB4DF@r-project.org>


On Oct 28, 2006, at 5:10 PM, Ren? J.V. Bertin wrote:

> I don't want to keep hammering on the possible interest of python in
> this context... but have you seen this?
>
> http://ipython.scipy.org/moin/Parallel_Computing
>
> I know, not exactly the same as multithreading ;)
>

Um - have you seen this?
http://cran.r-project.org/src/contrib/Descriptions/snow.html
It allows parallel computing in R - and has support for more backends  
than the ipython stuff ;).

On a more serious note I can only repeat what have been said before -  
AFAIK the Python concept is too limited to be really of significant  
use in R and real threaded R is not on the horizon anytime soon.  
However, approaches like snow were suitable for most parallelization  
tasks I have encountered in R... So unless someone writes a lot of  
[the right] code (which would be great!) it's unlikely to change.

Cheers,
Simon



From phgrosjean at sciviews.org  Sun Oct 29 00:03:18 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun, 29 Oct 2006 00:03:18 +0200
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <45438F9B.7000905@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca>
Message-ID: <4543D3A6.7010900@sciviews.org>

Duncan Murdoch wrote:
[...]
> I've just added this function to R-devel (to become 2.5.0 next spring):
> 
> withVisible <- function(x) {
>      x <- substitute(x)
>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>      v
> }
> 
> Luke Tierney suggested simplifying the interface (no need to duplicate 
> the 3 parameter eval interface, you can just wrap this in evalq() if you 
> need that flexibility); the name "with.vis" was suggested, but it looks 
> like an S3 method for the with() generic, so I renamed it.
> 
> Duncan Murdoch

Excellent, many thanks... but I am afraid I cannot use this function 
because you force evaluation on parent.frame(), where I need to evaluate 
it in .GlobalEnv (which is NOT equal to parent.frame() in my context). 
Would it be possible to change it to:

withVisible <- function(x, env = parent.frame()) {
     x <- substitute(x)
     v <- .Internal(eval.with.vis(x, env, baseenv()))
     v
}

...so that we got additional flexibility?

This is one good example of problems we encounter if we want to make R 
GUIs that emulate the very, very complex mechanism used by R to evaluate 
a command send at the prompt.

Since we are on this topic, here is a copy of the function I am working 
on. It emulates most of the mechanism (Is the code line complete or not? 
Do we issue one or several warnings? When? Correct error message in case 
of a stop condition or other errors? Return of results with visibility? 
Etc.). As you can see, it is incredibly complex. So, do I make a mistake 
somewhere, or are we really forced to make all these computations to 
emulate the way R works at the command line (to put in a context, this 
is part of a R socket server to be used, for instance, in Tinn-R to fork 
output of R in the Tinn-R console, without blocking the original R 
console, or R terminal).

Best,

Philippe Grosjean


processSocket <- function(msg) {
     # This is the default R function that processes a command send
     # by a socket client
     # 'msg' is assumed to be R code contained in a string
	
     # First parse code
     msgcon <- textConnection(msg)
     expr <- try(parse(msgcon), silent = TRUE)
     close(msgcon)
		
     # Determine if this code is correctly parsed
     if (inherits(expr, "try-error")) {
         results <- expr
         # Determine if it is incorrect code, or incomplete line!
         if (length(grep("\n2:", results)) == 1) {
             ### TODO: use the continue prompt from options!
             results <- "\n+ "	# Send just the continue prompt
             # The client must manage the rest!
         } else {
             # Rework error message
             toReplace <-  "^([^ ]* )[^:]*(:.*)$"
             Replace <- "\\1\\2"
             results <- sub(toReplace, Replace, results)
             # Add the prompt at the end to show that R is ready
             # to process new commands
             results <- paste(results, "> ", sep = "\n")
         }
     } else { # Code is correctly parsed,
     # evaluate generated expression(s)
		
     # capture.all() is inspired from capture.output(),
     # but it captures both the output and the message streams
     capture.all <- function(expr) {
	file <- textConnection("rval", "w", local = TRUE)
         sink(file, type = "output")
        	sink(file, type = "message")
        	on.exit({
             sink(type = "output")
             sink(type = "message")
             close(file)
        	})
     	### TODO: do not erase 'last.warning',
         # otherwise warnings(), etc. do not work!
	evalVis <- function(Expr) {
	    if (getOption("warn") == 0) {
		# We need to install our own warning handling
		# and also, we use a customized interrupt handler
		owarn <- getOption("warning.expression")
		# Inactivate current warning handler
		options(warning.expression = expression())
		# ... and make sure it is restored at the end
		on.exit({
		    # Check that the warning.expression
                     # was not changed
		    nwarn <- getOption("warning.expression")
	            if (!is.null(nwarn) &&
                         length(as.character(nwarn)) == 0)
			options(warning.expression = owarn)
	            # If the evaluation did not generated warnings,
                     # restore old "last.warning"
		    if (!exists("last.warning",
                         envir = .GlobalEnv) &&
                         !is.null(save.last.warning))
			last.warning <<- save.last.warning	
		})
		# Save the current content of "last.warning"
                 # From .GlobalEnv
		if (exists("last.warning", envir = .GlobalEnv)) {
		    save.last.warning <- get("last.warning",
                         envir = .GlobalEnv)
		    # ... and delete it
		    rm(last.warning, envir = .GlobalEnv)
		} else {
		    save.last.warning <- NULL
		}
		myEvalEnv.. <- .GlobalEnv
		res <- try(withCallingHandlers(.Internal(
                     eval.with.vis(Expr, myEvalEnv.., baseenv())),
		# Our custom warning handler
		### TODO: how to deal with immediate warnings!
                 # (currently, all warnings are differed!)
		warning = function(w) {
		    if (exists("last.warning", envir =.GlobalEnv)) {
			lwarn <- get("last.warning",
                             envir = .GlobalEnv)
		    } else lwarn <- list()
		    # Do not add more than 50 warnings
		    if (length(lwarn) >= 50) return()
		    # Add the warning to this list
		    nwarn <- length(lwarn)
		    names.warn <- names(lwarn)
		    Call <- conditionCall(w)
	            # If warning generated in eval environment,
                     # put it as character(0)
		    if (Call == "eval.with.vis(Expr, myEvalEnv..,
                         baseenv())")
		        Call <- character(0) # I don't use NULL,
                     # because it doesn't add to a list!
	            lwarn[[nwarn + 1]] <- Call
		    names(lwarn) <- c(names.warn,
                         conditionMessage(w))
		    # Save the modified version in .GlobalEnv
		    last.warning <<- lwarn
	            return()
		},
		interrupt = function(i) cat("<INTERRUPTED!>\n")),
                     silent = TRUE)
		# Possibly add 'last.warning' as attribute to res
	        if (exists("last.warning", envir = .GlobalEnv))
		    attr(res, "last.warning") <- get("last.warning",
                         envir = .GlobalEnv)
             } else {	# We have a simpler warning handler
		owarn <- getOption("warning.expression")
		# Inactivate current warning handler
		options(warning.expression = expression())
		# ... and make sure it is restored at the end
		on.exit({
		    # Check that the warning.expression was
                     #not changed
		    nwarn <- getOption("warning.expression")
		    if (!is.null(nwarn) &&
                         length(as.character(nwarn)) == 0)
	                options(warning.expression = owarn)	
		})
		myEvalEnv.. <- .GlobalEnv
	        res <- try(withCallingHandlers(.Internal(
                     eval.with.vis(Expr, myEvalEnv.., baseenv())),
                     warning = function(w) {
	            Mes <- conditionMessage(w)
		    Call <- conditionCall(w)
		    # Result depends upon 'warn'
	            Warn <- getOption("warn")
	            if (Warn < 0) { # Do nothing!
	                return()
	            } else if (Warn > 1) { # Generate an error!
			Mes <- paste("(converted from warning)", Mes)
		        stop(simpleError(Mes, call = Call))
                     } else { # Print the warning message
			# Format the warning message
		        ### TODO: translate this!
		        # If warning generated in eval
                         # environment, do not print call	
			if (Call == "eval.with.vis(Expr,
                             myEvalEnv.., baseenv())") {
		            cat("Warning message:\n", Mes,
                                 "\n", sep = "")
		        } else {
		            cat("Warning message:\n", Mes,
                                 " in: ", as.character(Call),
                                 "\n", sep = "")
		        }
	            }	
		},
                 interrupt = function(i)
                     cat("<INTERRUPTED!>\n")), silent = TRUE)
             }
             return(res)
         }
    	tmp <- list()
         for (i in 1:length(expr)) {
     	    tmp[[i]] <- evalVis(expr[[i]])
             if (inherits(tmp[[i]], "try-error"))  break		
     	}
	#tmp <- lapply(expr, evalVis) # This one does not stop
         #on error!?
        	# This is my function to display delayed warnings
	WarningMessage <- function(last.warning) {
	    n.warn <- length(last.warning)
             if (n.warn < 11) {	# If less than 11 warnings,
                                 # print them
		if (exists("last.warning", envir = .GlobalEnv)) {
		    owarn <- get("last.warning", envir = .GlobalEnv)
		} else owarn <- NULL
		last.warning <<- last.warning
		invisible(warnings())
		if (is.null(owarn)) {
		    rm("last.warning", envir = .GlobalEnv)
		} else last.warning <<- owarn
             } else {
		# Generate a message similar to the one we got
                 # at the command line
		### TODO: translation of this message!
		if (n.warn >= 50) {
		    cat("There were 50 or more warnings (use warnings() to see the 
first 50)\n")
		} else {
	            cat("There were", n.warn, "warnings (use warnings() to see 
them)\n", sep = " ")
		}
	    }
	    return(invisible(n.warn))
         }
         # Process all generated items		
         for (item in tmp) {
             if (inherits(item, "try-error")) {
                 # Rework the error message if it occurs in the
                 # calling environment
        	        toReplace <-  "^([^ ]*) .*eval\.with\.vis[(]Expr,
                     myEvalEnv\.\., baseenv[(][)][)].*:.*\n\t(.*)$"
        	        Replace <- "\\1 : \\2"
	        cat(sub(toReplace, Replace, unclass(item)))
	        # Do we have to print 'last.warning'?
	        last.warning <- attr(item, "last.warning")
	        if (!is.null(last.warning)) {
	            # Add "In addition: " before warning, like at
                     # the command line
		    cat("In addition: ")
		    WarningMessage(last.warning)
	        }
        	    } else {	 # No error
                 if (item$visible) {
                     print(item$value)
        	        }
        	        # Do we have to print 'last.warning'?
	        last.warning <- attr(item, "last.warning")
	        if (!is.null(last.warning))
	            WarningMessage(last.warning)
	        }
     	    }
     	    return(rval)
         }
         results <- capture.all(expr)
         if (inherits(results, "list"))
             results <- paste(results, collapse = "\n")
         # Add the prompt at the end to show that R is ready to process
         # new commands
         results <- paste(paste(results, collapse = "\n"), "> ",
             sep = "\n")
         # Note: we don't use options()$prompt here... we always use a
         # fixed string! It is the client that must manage
         # possible change
     }
     return(results)
}



From jmc at r-project.org  Sun Oct 29 01:26:27 2006
From: jmc at r-project.org (John Chambers)
Date: Sat, 28 Oct 2006 19:26:27 -0400
Subject: [Rd] Pb with .findInheritedMethods
In-Reply-To: <45424E50.8030206@fhcrc.org>
References: <454142C1.9030809@fhcrc.org> <45415AB4.3050505@fhcrc.org>
	<454204C3.2030606@r-project.org> <45424E50.8030206@fhcrc.org>
Message-ID: <4543E723.4080402@r-project.org>

Herve Pages wrote:
> ....
> More generally I don't see what's wrong with not passing
> to callNextMethod all the arguments coming from the call
> to new:
>
>     setClass("A", representation(toto="integer"))
>     setMethod("initialize", "A", function(.Object, toto0) {.Object at toto
>     <- as.integer(toto0); .Object})
>     new("A", 45.1)
>
>     setClass("Ab", contains="A")
>     setMethod("initialize", "Ab", function(.Object, x, y)
>     callNextMethod(.Object, x*y+1))
>     new("Ab", 5, 2)
>   

As I mentioned, this relates to writing methods for initialize().   
Imagine someone else extends the class "Ab", for which you wrote a 
method.  If they add slots to their class and you do not pass down ... 
to callNextMethod(), then you have blocked users from setting values for 
those slots in calls to new(), since the ... argument is thrown away by 
your method.

So in your example, it's more socially responsible to add "..." as a 
formal argument to your method, and then to pass it on to callNextMethod():

   setMethod("initialize", "Ab", function(.Object, x, y, ...)
    callNextMethod(.Object, x*y+1, ...))

The other aspect to this is that the last specialized method in your chain of class definitions should end up with:
   callNextMethod(.Object, ...)
Then the default initialize() method will set values for named slots.  Again, the point is to allow others to extend your class definitions.



>
> Regards,
>
> H.
>
>



From murdoch at stats.uwo.ca  Sun Oct 29 02:53:09 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 28 Oct 2006 20:53:09 -0400
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4543D3A6.7010900@sciviews.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
Message-ID: <4543FB75.7090405@stats.uwo.ca>

On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
> Duncan Murdoch wrote:
> [...]
>> I've just added this function to R-devel (to become 2.5.0 next spring):
>>
>> withVisible <- function(x) {
>>      x <- substitute(x)
>>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>>      v
>> }
>>
>> Luke Tierney suggested simplifying the interface (no need to duplicate 
>> the 3 parameter eval interface, you can just wrap this in evalq() if you 
>> need that flexibility); the name "with.vis" was suggested, but it looks 
>> like an S3 method for the with() generic, so I renamed it.
>>
>> Duncan Murdoch
> 
> Excellent, many thanks... but I am afraid I cannot use this function 
> because you force evaluation on parent.frame(), where I need to evaluate 
> it in .GlobalEnv (which is NOT equal to parent.frame() in my context). 
> Would it be possible to change it to:
> 
> withVisible <- function(x, env = parent.frame()) {
>      x <- substitute(x)
>      v <- .Internal(eval.with.vis(x, env, baseenv()))
>      v
> }
> 
> ...so that we got additional flexibility?

As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).

> This is one good example of problems we encounter if we want to make R 
> GUIs that emulate the very, very complex mechanism used by R to evaluate 
> a command send at the prompt.

No, it's not.

Duncan Murdoch

> 
> Since we are on this topic, here is a copy of the function I am working 
> on. It emulates most of the mechanism (Is the code line complete or not? 
> Do we issue one or several warnings? When? Correct error message in case 
> of a stop condition or other errors? Return of results with visibility? 
> Etc.). As you can see, it is incredibly complex. So, do I make a mistake 
> somewhere, or are we really forced to make all these computations to 
> emulate the way R works at the command line (to put in a context, this 
> is part of a R socket server to be used, for instance, in Tinn-R to fork 
> output of R in the Tinn-R console, without blocking the original R 
> console, or R terminal).

I
> 
> Best,
> 
> Philippe Grosjean
> 
> 
> processSocket <- function(msg) {
>      # This is the default R function that processes a command send
>      # by a socket client
>      # 'msg' is assumed to be R code contained in a string
> 	
>      # First parse code
>      msgcon <- textConnection(msg)
>      expr <- try(parse(msgcon), silent = TRUE)
>      close(msgcon)
> 		
>      # Determine if this code is correctly parsed
>      if (inherits(expr, "try-error")) {
>          results <- expr
>          # Determine if it is incorrect code, or incomplete line!
>          if (length(grep("\n2:", results)) == 1) {
>              ### TODO: use the continue prompt from options!
>              results <- "\n+ "	# Send just the continue prompt
>              # The client must manage the rest!
>          } else {
>              # Rework error message
>              toReplace <-  "^([^ ]* )[^:]*(:.*)$"
>              Replace <- "\\1\\2"
>              results <- sub(toReplace, Replace, results)
>              # Add the prompt at the end to show that R is ready
>              # to process new commands
>              results <- paste(results, "> ", sep = "\n")
>          }
>      } else { # Code is correctly parsed,
>      # evaluate generated expression(s)
> 		
>      # capture.all() is inspired from capture.output(),
>      # but it captures both the output and the message streams
>      capture.all <- function(expr) {
> 	file <- textConnection("rval", "w", local = TRUE)
>          sink(file, type = "output")
>         	sink(file, type = "message")
>         	on.exit({
>              sink(type = "output")
>              sink(type = "message")
>              close(file)
>         	})
>      	### TODO: do not erase 'last.warning',
>          # otherwise warnings(), etc. do not work!
> 	evalVis <- function(Expr) {
> 	    if (getOption("warn") == 0) {
> 		# We need to install our own warning handling
> 		# and also, we use a customized interrupt handler
> 		owarn <- getOption("warning.expression")
> 		# Inactivate current warning handler
> 		options(warning.expression = expression())
> 		# ... and make sure it is restored at the end
> 		on.exit({
> 		    # Check that the warning.expression
>                      # was not changed
> 		    nwarn <- getOption("warning.expression")
> 	            if (!is.null(nwarn) &&
>                          length(as.character(nwarn)) == 0)
> 			options(warning.expression = owarn)
> 	            # If the evaluation did not generated warnings,
>                      # restore old "last.warning"
> 		    if (!exists("last.warning",
>                          envir = .GlobalEnv) &&
>                          !is.null(save.last.warning))
> 			last.warning <<- save.last.warning	
> 		})
> 		# Save the current content of "last.warning"
>                  # From .GlobalEnv
> 		if (exists("last.warning", envir = .GlobalEnv)) {
> 		    save.last.warning <- get("last.warning",
>                          envir = .GlobalEnv)
> 		    # ... and delete it
> 		    rm(last.warning, envir = .GlobalEnv)
> 		} else {
> 		    save.last.warning <- NULL
> 		}
> 		myEvalEnv.. <- .GlobalEnv
> 		res <- try(withCallingHandlers(.Internal(
>                      eval.with.vis(Expr, myEvalEnv.., baseenv())),
> 		# Our custom warning handler
> 		### TODO: how to deal with immediate warnings!
>                  # (currently, all warnings are differed!)
> 		warning = function(w) {
> 		    if (exists("last.warning", envir =.GlobalEnv)) {
> 			lwarn <- get("last.warning",
>                              envir = .GlobalEnv)
> 		    } else lwarn <- list()
> 		    # Do not add more than 50 warnings
> 		    if (length(lwarn) >= 50) return()
> 		    # Add the warning to this list
> 		    nwarn <- length(lwarn)
> 		    names.warn <- names(lwarn)
> 		    Call <- conditionCall(w)
> 	            # If warning generated in eval environment,
>                      # put it as character(0)
> 		    if (Call == "eval.with.vis(Expr, myEvalEnv..,
>                          baseenv())")
> 		        Call <- character(0) # I don't use NULL,
>                      # because it doesn't add to a list!
> 	            lwarn[[nwarn + 1]] <- Call
> 		    names(lwarn) <- c(names.warn,
>                          conditionMessage(w))
> 		    # Save the modified version in .GlobalEnv
> 		    last.warning <<- lwarn
> 	            return()
> 		},
> 		interrupt = function(i) cat("<INTERRUPTED!>\n")),
>                      silent = TRUE)
> 		# Possibly add 'last.warning' as attribute to res
> 	        if (exists("last.warning", envir = .GlobalEnv))
> 		    attr(res, "last.warning") <- get("last.warning",
>                          envir = .GlobalEnv)
>              } else {	# We have a simpler warning handler
> 		owarn <- getOption("warning.expression")
> 		# Inactivate current warning handler
> 		options(warning.expression = expression())
> 		# ... and make sure it is restored at the end
> 		on.exit({
> 		    # Check that the warning.expression was
>                      #not changed
> 		    nwarn <- getOption("warning.expression")
> 		    if (!is.null(nwarn) &&
>                          length(as.character(nwarn)) == 0)
> 	                options(warning.expression = owarn)	
> 		})
> 		myEvalEnv.. <- .GlobalEnv
> 	        res <- try(withCallingHandlers(.Internal(
>                      eval.with.vis(Expr, myEvalEnv.., baseenv())),
>                      warning = function(w) {
> 	            Mes <- conditionMessage(w)
> 		    Call <- conditionCall(w)
> 		    # Result depends upon 'warn'
> 	            Warn <- getOption("warn")
> 	            if (Warn < 0) { # Do nothing!
> 	                return()
> 	            } else if (Warn > 1) { # Generate an error!
> 			Mes <- paste("(converted from warning)", Mes)
> 		        stop(simpleError(Mes, call = Call))
>                      } else { # Print the warning message
> 			# Format the warning message
> 		        ### TODO: translate this!
> 		        # If warning generated in eval
>                          # environment, do not print call	
> 			if (Call == "eval.with.vis(Expr,
>                              myEvalEnv.., baseenv())") {
> 		            cat("Warning message:\n", Mes,
>                                  "\n", sep = "")
> 		        } else {
> 		            cat("Warning message:\n", Mes,
>                                  " in: ", as.character(Call),
>                                  "\n", sep = "")
> 		        }
> 	            }	
> 		},
>                  interrupt = function(i)
>                      cat("<INTERRUPTED!>\n")), silent = TRUE)
>              }
>              return(res)
>          }
>     	tmp <- list()
>          for (i in 1:length(expr)) {
>      	    tmp[[i]] <- evalVis(expr[[i]])
>              if (inherits(tmp[[i]], "try-error"))  break		
>      	}
> 	#tmp <- lapply(expr, evalVis) # This one does not stop
>          #on error!?
>         	# This is my function to display delayed warnings
> 	WarningMessage <- function(last.warning) {
> 	    n.warn <- length(last.warning)
>              if (n.warn < 11) {	# If less than 11 warnings,
>                                  # print them
> 		if (exists("last.warning", envir = .GlobalEnv)) {
> 		    owarn <- get("last.warning", envir = .GlobalEnv)
> 		} else owarn <- NULL
> 		last.warning <<- last.warning
> 		invisible(warnings())
> 		if (is.null(owarn)) {
> 		    rm("last.warning", envir = .GlobalEnv)
> 		} else last.warning <<- owarn
>              } else {
> 		# Generate a message similar to the one we got
>                  # at the command line
> 		### TODO: translation of this message!
> 		if (n.warn >= 50) {
> 		    cat("There were 50 or more warnings (use warnings() to see the 
> first 50)\n")
> 		} else {
> 	            cat("There were", n.warn, "warnings (use warnings() to see 
> them)\n", sep = " ")
> 		}
> 	    }
> 	    return(invisible(n.warn))
>          }
>          # Process all generated items		
>          for (item in tmp) {
>              if (inherits(item, "try-error")) {
>                  # Rework the error message if it occurs in the
>                  # calling environment
>         	        toReplace <-  "^([^ ]*) .*eval\.with\.vis[(]Expr,
>                      myEvalEnv\.\., baseenv[(][)][)].*:.*\n\t(.*)$"
>         	        Replace <- "\\1 : \\2"
> 	        cat(sub(toReplace, Replace, unclass(item)))
> 	        # Do we have to print 'last.warning'?
> 	        last.warning <- attr(item, "last.warning")
> 	        if (!is.null(last.warning)) {
> 	            # Add "In addition: " before warning, like at
>                      # the command line
> 		    cat("In addition: ")
> 		    WarningMessage(last.warning)
> 	        }
>         	    } else {	 # No error
>                  if (item$visible) {
>                      print(item$value)
>         	        }
>         	        # Do we have to print 'last.warning'?
> 	        last.warning <- attr(item, "last.warning")
> 	        if (!is.null(last.warning))
> 	            WarningMessage(last.warning)
> 	        }
>      	    }
>      	    return(rval)
>          }
>          results <- capture.all(expr)
>          if (inherits(results, "list"))
>              results <- paste(results, collapse = "\n")
>          # Add the prompt at the end to show that R is ready to process
>          # new commands
>          results <- paste(paste(results, collapse = "\n"), "> ",
>              sep = "\n")
>          # Note: we don't use options()$prompt here... we always use a
>          # fixed string! It is the client that must manage
>          # possible change
>      }
>      return(results)
> }
>



From sfalcon at fhcrc.org  Sun Oct 29 02:13:57 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Sat, 28 Oct 2006 18:13:57 -0700
Subject: [Rd] Pb with .findInheritedMethods
In-Reply-To: <4543E723.4080402@r-project.org> (John Chambers's message of "Sat,
	28 Oct 2006 19:26:27 -0400")
References: <454142C1.9030809@fhcrc.org> <45415AB4.3050505@fhcrc.org>
	<454204C3.2030606@r-project.org> <45424E50.8030206@fhcrc.org>
	<4543E723.4080402@r-project.org>
Message-ID: <m2iri3q5yi.fsf@ziti.local>

John Chambers <jmc at r-project.org> writes:
> As I mentioned, this relates to writing methods for initialize().
> Imagine someone else extends the class "Ab", for which you wrote a
> method.  If they add slots to their class and you do not pass down ...
> to callNextMethod(), then you have blocked users from setting values
> for those slots in calls to new(), since the ... argument is thrown
> away by your method.

If you have written an initialize method, then it is likely because
you want to do something other than just fill slots.  A subclass will
most likely need to define its own initialize method and in this case,
I'm not sure passing ... will matter.

> The other aspect to this is that the last specialized method in your
> chain of class definitions should end up with: callNextMethod(.Object,
> ...)  Then the default initialize() method will set values for named
> slots.

Unless that isn't the behavior one desires (and I would claim this is
a rather common situation).  As part of the user interface to the
class, the developer may want to decouple the intitialization
interface from specific slot names.


+ seth



From phgrosjean at sciviews.org  Sun Oct 29 10:47:20 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun, 29 Oct 2006 10:47:20 +0100
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4543FB75.7090405@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca>
Message-ID: <454478A8.9000903@sciviews.org>

Duncan Murdoch wrote:
> On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
>> Duncan Murdoch wrote:
>> [...]
>>> I've just added this function to R-devel (to become 2.5.0 next spring):
>>>
>>> withVisible <- function(x) {
>>>      x <- substitute(x)
>>>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>>>      v
>>> }
>>>
>>> Luke Tierney suggested simplifying the interface (no need to 
>>> duplicate the 3 parameter eval interface, you can just wrap this in 
>>> evalq() if you need that flexibility); the name "with.vis" was 
>>> suggested, but it looks like an S3 method for the with() generic, so 
>>> I renamed it.
>>>
>>> Duncan Murdoch
>>
>> Excellent, many thanks... but I am afraid I cannot use this function 
>> because you force evaluation on parent.frame(), where I need to 
>> evaluate it in .GlobalEnv (which is NOT equal to parent.frame() in my 
>> context). Would it be possible to change it to:
>>
>> withVisible <- function(x, env = parent.frame()) {
>>      x <- substitute(x)
>>      v <- .Internal(eval.with.vis(x, env, baseenv()))
>>      v
>> }
>>
>> ...so that we got additional flexibility?
> 
> As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).

Fine, that's not needed. But, what's better: to use two embedded 
functions, like you propose, or to add an argument with default value in 
one function? I guess you know the answer, both in term of simplicity 
and in term of efficiency.

>> This is one good example of problems we encounter if we want to make R 
>> GUIs that emulate the very, very complex mechanism used by R to 
>> evaluate a command send at the prompt.
> 
> No, it's not.

Yes, it is, because it is not that easy for everybody to determine if a 
function returns its result visibly or not... or this thread would never 
been started. Also, I don't think it is that easy to find the answer to 
a problem, if that solution is hidden in an undocumented function only. 
Hopefully, the problem is solved now, thanks to your initiative.

Otherwise, command line process in R (S) IS very complex. Just a couple 
of reasons why it is:

- There is no explicit indicator that a code line is continued to the 
next line. It is the parser that determines that, according to the 
context. This problem has already been discussed on R-Help, and Peter 
Dalgaard proposed a solution... Again, there is no isLineComplete() 
function or so, that does this automatically. So, here is one, after 
Peter Dalgaard's idea:

isLineComplete <- function(x) {
     # x is a character string vector with R code
     # The function determines if the parser is satisfied with it
     # or it needs more input (code is continued at the next line)

     # First parse code
     con <- textConnection(x)
     expr <- try(parse(con), silent = TRUE)
     close(con)

     # Determine if this code is correctly parsed
     if (inherits(expr, "try-error")) {
         results <- expr
         # Determine if it is an incomplete line
         if (length(grep("\n2:", results)) == 1) return(FALSE)
     }
     # Note: here, we return TRUE also if the code is wrong
     # but one could enhance the function to return something
     # else in case of wrong R code
     return(TRUE)
}

 > isLineComplete("ls()")
[1] TRUE
 > isLineComplete("ls(")
[1] FALSE
 > isLineComplete("ls())")
[1] TRUE

- For functions like: xxx.yyy(), it is impossible to know if they are 
xxx methods for yyy S3 objects, or simply a function called xxx.yyy() 
without parsing the code, or interrogating R another way.

- The mechanism that manages warnings is very complex. First you have 
options(warn=X). Then, depending on its value, warnings are issued as 
errors, as warnings immediately, or their output is differed at the end 
of all the output (and in this case, warnings are only printed if there 
are few of them. Otherwise a message is issued and only the 50 first 
warnings are saved in last.warning). So, OK, fine. Convenience and 
flexibility is obviously what motivated this design. But now, is it a 
function that emulates this behavior to capture code evaluation in a 
variable, including possible warnings and errors? I did look for it, and 
I didn't found it. Functions like capture.output() do not capture errors 
or warnings:

 >  res <- capture.output(1+1, 2+2)
 > res
[1] "[1] 2" "[1] 4"
 > res <- capture.output({1+1; 2+AAA})
Erreur dans eval.with.vis(expr, pf, baseenv()) :
         objet "AAA" non trouv?
 > res <- capture.output(1:3+1:2)
Warning message:
la longueur de l'objet le plus long
         n'est pas un multiple de la longueur de l'objet le plus court 
in: 1:3 + 1:2

Thus, I am left with little tools in R to emulate this. I have to get 
hands durty and write my own capture.all() function, which starts like this:

capture.all <- function(expr) {
     file <- textConnection("rval", "w", local = TRUE)
     sink(file, type = "output")
     sink(file, type = "message")
     on.exit({
         sink(type = "output")
         sink(type = "message")
         close(file)
     })

	[....]

}

Fortunately, I can use the convenient withCallingHandler(), 
simpleCondition(), simpleError(), simpleWarning(), signalCondition(), 
etc. to get full control on how my code is evaluated in R, including 
handling of errors and warnings.

However, I notice that emulating the complex R mechanism of handling 
warnings is not that an easy thing to program with the 
withCallingHandlers() function. The result is the very long and awful 
function printed at the very end of this message.

May be, am I not using the right function here, and may be I did not 
spot the undocumented function that deals nicely with warnings like I 
want. But whatever the answer, this is definitely not an easy task to 
spot or program the function to do this.

As an example, John Fox did an excellent job to put the results of code 
evaluation right in the R Commander window... but R code evaluation is 
not handled perfectly there: no split of R code on two or more lines is 
permitted, and warnings are not handled by his code. As a result, 
warnings still print on the original R console window that may be hidden 
with the large R Commander window... and that could lead to weird 
situations where people do not understand why R/R Commander is not 
giving the expected results, as they don't see the warnings. I am sure 
that John tries to solve these problems, but apparently, he was not 
successful.

Otherwise, I appreciate your efforts to make things simpler and neater. 
One example is your withVisible() function. Another example is your 
better reimplementation of custom menus in RGui. Thanks.

Philippe Grosjean


> Duncan Murdoch
> 
>>
>> Since we are on this topic, here is a copy of the function I am 
>> working on. It emulates most of the mechanism (Is the code line 
>> complete or not? Do we issue one or several warnings? When? Correct 
>> error message in case of a stop condition or other errors? Return of 
>> results with visibility? Etc.). As you can see, it is incredibly 
>> complex. So, do I make a mistake somewhere, or are we really forced to 
>> make all these computations to emulate the way R works at the command 
>> line (to put in a context, this is part of a R socket server to be 
>> used, for instance, in Tinn-R to fork output of R in the Tinn-R 
>> console, without blocking the original R console, or R terminal).
> 
> I
>>
>> Best,
>>
>> Philippe Grosjean
>>
>>
>> processSocket <- function(msg) {
>>      # This is the default R function that processes a command send
>>      # by a socket client
>>      # 'msg' is assumed to be R code contained in a string
>>     
>>      # First parse code
>>      msgcon <- textConnection(msg)
>>      expr <- try(parse(msgcon), silent = TRUE)
>>      close(msgcon)
>>        
>>      # Determine if this code is correctly parsed
>>      if (inherits(expr, "try-error")) {
>>          results <- expr
>>          # Determine if it is incorrect code, or incomplete line!
>>          if (length(grep("\n2:", results)) == 1) {
>>              ### TODO: use the continue prompt from options!
>>              results <- "\n+ "    # Send just the continue prompt
>>              # The client must manage the rest!
>>          } else {
>>              # Rework error message
>>              toReplace <-  "^([^ ]* )[^:]*(:.*)$"
>>              Replace <- "\\1\\2"
>>              results <- sub(toReplace, Replace, results)
>>              # Add the prompt at the end to show that R is ready
>>              # to process new commands
>>              results <- paste(results, "> ", sep = "\n")
>>          }
>>      } else { # Code is correctly parsed,
>>      # evaluate generated expression(s)
>>        
>>      # capture.all() is inspired from capture.output(),
>>      # but it captures both the output and the message streams
>>      capture.all <- function(expr) {
>>     file <- textConnection("rval", "w", local = TRUE)
>>          sink(file, type = "output")
>>             sink(file, type = "message")
>>             on.exit({
>>              sink(type = "output")
>>              sink(type = "message")
>>              close(file)
>>             })
>>          ### TODO: do not erase 'last.warning',
>>          # otherwise warnings(), etc. do not work!
>>     evalVis <- function(Expr) {
>>         if (getOption("warn") == 0) {
>>         # We need to install our own warning handling
>>         # and also, we use a customized interrupt handler
>>         owarn <- getOption("warning.expression")
>>         # Inactivate current warning handler
>>         options(warning.expression = expression())
>>         # ... and make sure it is restored at the end
>>         on.exit({
>>             # Check that the warning.expression
>>                      # was not changed
>>             nwarn <- getOption("warning.expression")
>>                 if (!is.null(nwarn) &&
>>                          length(as.character(nwarn)) == 0)
>>             options(warning.expression = owarn)
>>                 # If the evaluation did not generated warnings,
>>                      # restore old "last.warning"
>>             if (!exists("last.warning",
>>                          envir = .GlobalEnv) &&
>>                          !is.null(save.last.warning))
>>             last.warning <<- save.last.warning   
>>         })
>>         # Save the current content of "last.warning"
>>                  # From .GlobalEnv
>>         if (exists("last.warning", envir = .GlobalEnv)) {
>>             save.last.warning <- get("last.warning",
>>                          envir = .GlobalEnv)
>>             # ... and delete it
>>             rm(last.warning, envir = .GlobalEnv)
>>         } else {
>>             save.last.warning <- NULL
>>         }
>>         myEvalEnv.. <- .GlobalEnv
>>         res <- try(withCallingHandlers(.Internal(
>>                      eval.with.vis(Expr, myEvalEnv.., baseenv())),
>>         # Our custom warning handler
>>         ### TODO: how to deal with immediate warnings!
>>                  # (currently, all warnings are differed!)
>>         warning = function(w) {
>>             if (exists("last.warning", envir =.GlobalEnv)) {
>>             lwarn <- get("last.warning",
>>                              envir = .GlobalEnv)
>>             } else lwarn <- list()
>>             # Do not add more than 50 warnings
>>             if (length(lwarn) >= 50) return()
>>             # Add the warning to this list
>>             nwarn <- length(lwarn)
>>             names.warn <- names(lwarn)
>>             Call <- conditionCall(w)
>>                 # If warning generated in eval environment,
>>                      # put it as character(0)
>>             if (Call == "eval.with.vis(Expr, myEvalEnv..,
>>                          baseenv())")
>>                 Call <- character(0) # I don't use NULL,
>>                      # because it doesn't add to a list!
>>                 lwarn[[nwarn + 1]] <- Call
>>             names(lwarn) <- c(names.warn,
>>                          conditionMessage(w))
>>             # Save the modified version in .GlobalEnv
>>             last.warning <<- lwarn
>>                 return()
>>         },
>>         interrupt = function(i) cat("<INTERRUPTED!>\n")),
>>                      silent = TRUE)
>>         # Possibly add 'last.warning' as attribute to res
>>             if (exists("last.warning", envir = .GlobalEnv))
>>             attr(res, "last.warning") <- get("last.warning",
>>                          envir = .GlobalEnv)
>>              } else {    # We have a simpler warning handler
>>         owarn <- getOption("warning.expression")
>>         # Inactivate current warning handler
>>         options(warning.expression = expression())
>>         # ... and make sure it is restored at the end
>>         on.exit({
>>             # Check that the warning.expression was
>>                      #not changed
>>             nwarn <- getOption("warning.expression")
>>             if (!is.null(nwarn) &&
>>                          length(as.character(nwarn)) == 0)
>>                     options(warning.expression = owarn)   
>>         })
>>         myEvalEnv.. <- .GlobalEnv
>>             res <- try(withCallingHandlers(.Internal(
>>                      eval.with.vis(Expr, myEvalEnv.., baseenv())),
>>                      warning = function(w) {
>>                 Mes <- conditionMessage(w)
>>             Call <- conditionCall(w)
>>             # Result depends upon 'warn'
>>                 Warn <- getOption("warn")
>>                 if (Warn < 0) { # Do nothing!
>>                     return()
>>                 } else if (Warn > 1) { # Generate an error!
>>             Mes <- paste("(converted from warning)", Mes)
>>                 stop(simpleError(Mes, call = Call))
>>                      } else { # Print the warning message
>>             # Format the warning message
>>                 ### TODO: translate this!
>>                 # If warning generated in eval
>>                          # environment, do not print call   
>>             if (Call == "eval.with.vis(Expr,
>>                              myEvalEnv.., baseenv())") {
>>                     cat("Warning message:\n", Mes,
>>                                  "\n", sep = "")
>>                 } else {
>>                     cat("Warning message:\n", Mes,
>>                                  " in: ", as.character(Call),
>>                                  "\n", sep = "")
>>                 }
>>                 }   
>>         },
>>                  interrupt = function(i)
>>                      cat("<INTERRUPTED!>\n")), silent = TRUE)
>>              }
>>              return(res)
>>          }
>>         tmp <- list()
>>          for (i in 1:length(expr)) {
>>              tmp[[i]] <- evalVis(expr[[i]])
>>              if (inherits(tmp[[i]], "try-error"))  break       
>>          }
>>     #tmp <- lapply(expr, evalVis) # This one does not stop
>>          #on error!?
>>             # This is my function to display delayed warnings
>>     WarningMessage <- function(last.warning) {
>>         n.warn <- length(last.warning)
>>              if (n.warn < 11) {    # If less than 11 warnings,
>>                                  # print them
>>         if (exists("last.warning", envir = .GlobalEnv)) {
>>             owarn <- get("last.warning", envir = .GlobalEnv)
>>         } else owarn <- NULL
>>         last.warning <<- last.warning
>>         invisible(warnings())
>>         if (is.null(owarn)) {
>>             rm("last.warning", envir = .GlobalEnv)
>>         } else last.warning <<- owarn
>>              } else {
>>         # Generate a message similar to the one we got
>>                  # at the command line
>>         ### TODO: translation of this message!
>>         if (n.warn >= 50) {
>>             cat("There were 50 or more warnings (use warnings() to see 
>> the first 50)\n")
>>         } else {
>>                 cat("There were", n.warn, "warnings (use warnings() to 
>> see them)\n", sep = " ")
>>         }
>>         }
>>         return(invisible(n.warn))
>>          }
>>          # Process all generated items       
>>          for (item in tmp) {
>>              if (inherits(item, "try-error")) {
>>                  # Rework the error message if it occurs in the
>>                  # calling environment
>>                     toReplace <-  "^([^ ]*) .*eval\.with\.vis[(]Expr,
>>                      myEvalEnv\.\., baseenv[(][)][)].*:.*\n\t(.*)$"
>>                     Replace <- "\\1 : \\2"
>>             cat(sub(toReplace, Replace, unclass(item)))
>>             # Do we have to print 'last.warning'?
>>             last.warning <- attr(item, "last.warning")
>>             if (!is.null(last.warning)) {
>>                 # Add "In addition: " before warning, like at
>>                      # the command line
>>             cat("In addition: ")
>>             WarningMessage(last.warning)
>>             }
>>                 } else {     # No error
>>                  if (item$visible) {
>>                      print(item$value)
>>                     }
>>                     # Do we have to print 'last.warning'?
>>             last.warning <- attr(item, "last.warning")
>>             if (!is.null(last.warning))
>>                 WarningMessage(last.warning)
>>             }
>>              }
>>              return(rval)
>>          }
>>          results <- capture.all(expr)
>>          if (inherits(results, "list"))
>>              results <- paste(results, collapse = "\n")
>>          # Add the prompt at the end to show that R is ready to process
>>          # new commands
>>          results <- paste(paste(results, collapse = "\n"), "> ",
>>              sep = "\n")
>>          # Note: we don't use options()$prompt here... we always use a
>>          # fixed string! It is the client that must manage
>>          # possible change
>>      }
>>      return(results)
>> }
>>
> 
> 
>



From murdoch at stats.uwo.ca  Sun Oct 29 11:44:03 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 29 Oct 2006 05:44:03 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <454478A8.9000903@sciviews.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca> <454478A8.9000903@sciviews.org>
Message-ID: <454485F3.1020206@stats.uwo.ca>

On 10/29/2006 4:47 AM, Philippe Grosjean wrote:
> Duncan Murdoch wrote:
>> On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
>>> Duncan Murdoch wrote:
>>> [...]
>>>> I've just added this function to R-devel (to become 2.5.0 next spring):
>>>>
>>>> withVisible <- function(x) {
>>>>      x <- substitute(x)
>>>>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>>>>      v
>>>> }
>>>>
>>>> Luke Tierney suggested simplifying the interface (no need to 
>>>> duplicate the 3 parameter eval interface, you can just wrap this in 
>>>> evalq() if you need that flexibility); the name "with.vis" was 
>>>> suggested, but it looks like an S3 method for the with() generic, so 
>>>> I renamed it.
>>>>
>>>> Duncan Murdoch
>>> Excellent, many thanks... but I am afraid I cannot use this function 
>>> because you force evaluation on parent.frame(), where I need to 
>>> evaluate it in .GlobalEnv (which is NOT equal to parent.frame() in my 
>>> context). Would it be possible to change it to:
>>>
>>> withVisible <- function(x, env = parent.frame()) {
>>>      x <- substitute(x)
>>>      v <- .Internal(eval.with.vis(x, env, baseenv()))
>>>      v
>>> }
>>>
>>> ...so that we got additional flexibility?
>> As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).
> 
> Fine, that's not needed. But, what's better: to use two embedded 
> functions, like you propose, or to add an argument with default value in 
> one function? I guess you know the answer, both in term of simplicity 
> and in term of efficiency.
> 
>>> This is one good example of problems we encounter if we want to make R 
>>> GUIs that emulate the very, very complex mechanism used by R to 
>>> evaluate a command send at the prompt.
>> No, it's not.
> 
> Yes, it is, because it is not that easy for everybody to determine if a 
> function returns its result visibly or not... or this thread would never 
> been started. 

No, it's not, because the problem you claimed to exist doesn't exist.

> Also, I don't think it is that easy to find the answer to 
> a problem, if that solution is hidden in an undocumented function only. 

That's an example of a real problem.

> Hopefully, the problem is solved now, thanks to your initiative.

And also thanks to Gabor bringing it up:  and that's really the solution 
to this second problem.  If you want to do something unusual and don't 
see a way to do it, ask on R-devel.  If the solution you get requires 
undocumented functions calls or other kludges, suggest a clean solution 
to it.

> Otherwise, command line process in R (S) IS very complex. Just a couple 
> of reasons why it is:
> 
> - There is no explicit indicator that a code line is continued to the 
> next line. It is the parser that determines that, according to the 
> context. This problem has already been discussed on R-Help, and Peter 
> Dalgaard proposed a solution... Again, there is no isLineComplete() 
> function or so, that does this automatically. So, here is one, after 
> Peter Dalgaard's idea:

The code below looks fragile to me:  it depends on the format of the 
error message report.  I'm hoping to make syntax errors more informative 
in the next release, and that will probably change the format of the 
reports.

More information about an error is available at the C level, but I'm not 
sure how much of that is published in the API.

Now would be a good time to suggest the ideal thing for parse() to 
return, from your point of view.  It may not be doable, but if it is, 
and it would work in other situations, there's a chance it will make it 
into 2.5.0.

> 
> isLineComplete <- function(x) {
>      # x is a character string vector with R code
>      # The function determines if the parser is satisfied with it
>      # or it needs more input (code is continued at the next line)
> 
>      # First parse code
>      con <- textConnection(x)
>      expr <- try(parse(con), silent = TRUE)
>      close(con)
> 
>      # Determine if this code is correctly parsed
>      if (inherits(expr, "try-error")) {
>          results <- expr
>          # Determine if it is an incomplete line
>          if (length(grep("\n2:", results)) == 1) return(FALSE)
>      }
>      # Note: here, we return TRUE also if the code is wrong
>      # but one could enhance the function to return something
>      # else in case of wrong R code
>      return(TRUE)
> }
> 
>  > isLineComplete("ls()")
> [1] TRUE
>  > isLineComplete("ls(")
> [1] FALSE
>  > isLineComplete("ls())")
> [1] TRUE
> 
> - For functions like: xxx.yyy(), it is impossible to know if they are 
> xxx methods for yyy S3 objects, or simply a function called xxx.yyy() 
> without parsing the code, or interrogating R another way.

I think you shouldn't care.  You should leave the evaluation of 
expressions up to R.  R should provide a way for a GUI to evaluate 
something, and should tell the GUI as much as the GUI needs to know to 
operate, but the GUI shouldn't try to be an R interpreter.

> - The mechanism that manages warnings is very complex. First you have 
> options(warn=X). Then, depending on its value, warnings are issued as 
> errors, as warnings immediately, or their output is differed at the end 
> of all the output (and in this case, warnings are only printed if there 
> are few of them. Otherwise a message is issued and only the 50 first 
> warnings are saved in last.warning). So, OK, fine. Convenience and 
> flexibility is obviously what motivated this design. But now, is it a 
> function that emulates this behavior to capture code evaluation in a 
> variable, including possible warnings and errors? I did look for it, and 
> I didn't found it. Functions like capture.output() do not capture errors 
> or warnings:
> 
>  >  res <- capture.output(1+1, 2+2)
>  > res
> [1] "[1] 2" "[1] 4"
>  > res <- capture.output({1+1; 2+AAA})
> Erreur dans eval.with.vis(expr, pf, baseenv()) :
>          objet "AAA" non trouv?
>  > res <- capture.output(1:3+1:2)
> Warning message:
> la longueur de l'objet le plus long
>          n'est pas un multiple de la longueur de l'objet le plus court 
> in: 1:3 + 1:2
> 
> Thus, I am left with little tools in R to emulate this. I have to get 
> hands durty and write my own capture.all() function, which starts like this:
> 
> capture.all <- function(expr) {
>      file <- textConnection("rval", "w", local = TRUE)
>      sink(file, type = "output")
>      sink(file, type = "message")
>      on.exit({
>          sink(type = "output")
>          sink(type = "message")
>          close(file)
>      })
> 
> 	[....]
> 
> }
> 
> Fortunately, I can use the convenient withCallingHandler(), 
> simpleCondition(), simpleError(), simpleWarning(), signalCondition(), 
> etc. to get full control on how my code is evaluated in R, including 
> handling of errors and warnings.
> 
> However, I notice that emulating the complex R mechanism of handling 
> warnings is not that an easy thing to program with the 
> withCallingHandlers() function. The result is the very long and awful 
> function printed at the very end of this message.
> 
> May be, am I not using the right function here, and may be I did not 
> spot the undocumented function that deals nicely with warnings like I 
> want. But whatever the answer, this is definitely not an easy task to 
> spot or program the function to do this.

I think it's unlikely that I will be doing anything with the 
error/warning mechanism, but there are other people who might.  So I'd 
suggest you propose a change that would meet your needs, and see if 
anyone responds.

Duncan Murdoch

> 
> As an example, John Fox did an excellent job to put the results of code 
> evaluation right in the R Commander window... but R code evaluation is 
> not handled perfectly there: no split of R code on two or more lines is 
> permitted, and warnings are not handled by his code. As a result, 
> warnings still print on the original R console window that may be hidden 
> with the large R Commander window... and that could lead to weird 
> situations where people do not understand why R/R Commander is not 
> giving the expected results, as they don't see the warnings. I am sure 
> that John tries to solve these problems, but apparently, he was not 
> successful.
> 
> Otherwise, I appreciate your efforts to make things simpler and neater. 
> One example is your withVisible() function. Another example is your 
> better reimplementation of custom menus in RGui. Thanks.
> 
> Philippe Grosjean
> 
> 
>> Duncan Murdoch
>>
>>> Since we are on this topic, here is a copy of the function I am 
>>> working on. It emulates most of the mechanism (Is the code line 
>>> complete or not? Do we issue one or several warnings? When? Correct 
>>> error message in case of a stop condition or other errors? Return of 
>>> results with visibility? Etc.). As you can see, it is incredibly 
>>> complex. So, do I make a mistake somewhere, or are we really forced to 
>>> make all these computations to emulate the way R works at the command 
>>> line (to put in a context, this is part of a R socket server to be 
>>> used, for instance, in Tinn-R to fork output of R in the Tinn-R 
>>> console, without blocking the original R console, or R terminal).
>> I
>>> Best,
>>>
>>> Philippe Grosjean
>>>
>>>
>>> processSocket <- function(msg) {
>>>      # This is the default R function that processes a command send
>>>      # by a socket client
>>>      # 'msg' is assumed to be R code contained in a string
>>>     
>>>      # First parse code
>>>      msgcon <- textConnection(msg)
>>>      expr <- try(parse(msgcon), silent = TRUE)
>>>      close(msgcon)
>>>        
>>>      # Determine if this code is correctly parsed
>>>      if (inherits(expr, "try-error")) {
>>>          results <- expr
>>>          # Determine if it is incorrect code, or incomplete line!
>>>          if (length(grep("\n2:", results)) == 1) {
>>>              ### TODO: use the continue prompt from options!
>>>              results <- "\n+ "    # Send just the continue prompt
>>>              # The client must manage the rest!
>>>          } else {
>>>              # Rework error message
>>>              toReplace <-  "^([^ ]* )[^:]*(:.*)$"
>>>              Replace <- "\\1\\2"
>>>              results <- sub(toReplace, Replace, results)
>>>              # Add the prompt at the end to show that R is ready
>>>              # to process new commands
>>>              results <- paste(results, "> ", sep = "\n")
>>>          }
>>>      } else { # Code is correctly parsed,
>>>      # evaluate generated expression(s)
>>>        
>>>      # capture.all() is inspired from capture.output(),
>>>      # but it captures both the output and the message streams
>>>      capture.all <- function(expr) {
>>>     file <- textConnection("rval", "w", local = TRUE)
>>>          sink(file, type = "output")
>>>             sink(file, type = "message")
>>>             on.exit({
>>>              sink(type = "output")
>>>              sink(type = "message")
>>>              close(file)
>>>             })
>>>          ### TODO: do not erase 'last.warning',
>>>          # otherwise warnings(), etc. do not work!
>>>     evalVis <- function(Expr) {
>>>         if (getOption("warn") == 0) {
>>>         # We need to install our own warning handling
>>>         # and also, we use a customized interrupt handler
>>>         owarn <- getOption("warning.expression")
>>>         # Inactivate current warning handler
>>>         options(warning.expression = expression())
>>>         # ... and make sure it is restored at the end
>>>         on.exit({
>>>             # Check that the warning.expression
>>>                      # was not changed
>>>             nwarn <- getOption("warning.expression")
>>>                 if (!is.null(nwarn) &&
>>>                          length(as.character(nwarn)) == 0)
>>>             options(warning.expression = owarn)
>>>                 # If the evaluation did not generated warnings,
>>>                      # restore old "last.warning"
>>>             if (!exists("last.warning",
>>>                          envir = .GlobalEnv) &&
>>>                          !is.null(save.last.warning))
>>>             last.warning <<- save.last.warning   
>>>         })
>>>         # Save the current content of "last.warning"
>>>                  # From .GlobalEnv
>>>         if (exists("last.warning", envir = .GlobalEnv)) {
>>>             save.last.warning <- get("last.warning",
>>>                          envir = .GlobalEnv)
>>>             # ... and delete it
>>>             rm(last.warning, envir = .GlobalEnv)
>>>         } else {
>>>             save.last.warning <- NULL
>>>         }
>>>         myEvalEnv.. <- .GlobalEnv
>>>         res <- try(withCallingHandlers(.Internal(
>>>                      eval.with.vis(Expr, myEvalEnv.., baseenv())),
>>>         # Our custom warning handler
>>>         ### TODO: how to deal with immediate warnings!
>>>                  # (currently, all warnings are differed!)
>>>         warning = function(w) {
>>>             if (exists("last.warning", envir =.GlobalEnv)) {
>>>             lwarn <- get("last.warning",
>>>                              envir = .GlobalEnv)
>>>             } else lwarn <- list()
>>>             # Do not add more than 50 warnings
>>>             if (length(lwarn) >= 50) return()
>>>             # Add the warning to this list
>>>             nwarn <- length(lwarn)
>>>             names.warn <- names(lwarn)
>>>             Call <- conditionCall(w)
>>>                 # If warning generated in eval environment,
>>>                      # put it as character(0)
>>>             if (Call == "eval.with.vis(Expr, myEvalEnv..,
>>>                          baseenv())")
>>>                 Call <- character(0) # I don't use NULL,
>>>                      # because it doesn't add to a list!
>>>                 lwarn[[nwarn + 1]] <- Call
>>>             names(lwarn) <- c(names.warn,
>>>                          conditionMessage(w))
>>>             # Save the modified version in .GlobalEnv
>>>             last.warning <<- lwarn
>>>                 return()
>>>         },
>>>         interrupt = function(i) cat("<INTERRUPTED!>\n")),
>>>                      silent = TRUE)
>>>         # Possibly add 'last.warning' as attribute to res
>>>             if (exists("last.warning", envir = .GlobalEnv))
>>>             attr(res, "last.warning") <- get("last.warning",
>>>                          envir = .GlobalEnv)
>>>              } else {    # We have a simpler warning handler
>>>         owarn <- getOption("warning.expression")
>>>         # Inactivate current warning handler
>>>         options(warning.expression = expression())
>>>         # ... and make sure it is restored at the end
>>>         on.exit({
>>>             # Check that the warning.expression was
>>>                      #not changed
>>>             nwarn <- getOption("warning.expression")
>>>             if (!is.null(nwarn) &&
>>>                          length(as.character(nwarn)) == 0)
>>>                     options(warning.expression = owarn)   
>>>         })
>>>         myEvalEnv.. <- .GlobalEnv
>>>             res <- try(withCallingHandlers(.Internal(
>>>                      eval.with.vis(Expr, myEvalEnv.., baseenv())),
>>>                      warning = function(w) {
>>>                 Mes <- conditionMessage(w)
>>>             Call <- conditionCall(w)
>>>             # Result depends upon 'warn'
>>>                 Warn <- getOption("warn")
>>>                 if (Warn < 0) { # Do nothing!
>>>                     return()
>>>                 } else if (Warn > 1) { # Generate an error!
>>>             Mes <- paste("(converted from warning)", Mes)
>>>                 stop(simpleError(Mes, call = Call))
>>>                      } else { # Print the warning message
>>>             # Format the warning message
>>>                 ### TODO: translate this!
>>>                 # If warning generated in eval
>>>                          # environment, do not print call   
>>>             if (Call == "eval.with.vis(Expr,
>>>                              myEvalEnv.., baseenv())") {
>>>                     cat("Warning message:\n", Mes,
>>>                                  "\n", sep = "")
>>>                 } else {
>>>                     cat("Warning message:\n", Mes,
>>>                                  " in: ", as.character(Call),
>>>                                  "\n", sep = "")
>>>                 }
>>>                 }   
>>>         },
>>>                  interrupt = function(i)
>>>                      cat("<INTERRUPTED!>\n")), silent = TRUE)
>>>              }
>>>              return(res)
>>>          }
>>>         tmp <- list()
>>>          for (i in 1:length(expr)) {
>>>              tmp[[i]] <- evalVis(expr[[i]])
>>>              if (inherits(tmp[[i]], "try-error"))  break       
>>>          }
>>>     #tmp <- lapply(expr, evalVis) # This one does not stop
>>>          #on error!?
>>>             # This is my function to display delayed warnings
>>>     WarningMessage <- function(last.warning) {
>>>         n.warn <- length(last.warning)
>>>              if (n.warn < 11) {    # If less than 11 warnings,
>>>                                  # print them
>>>         if (exists("last.warning", envir = .GlobalEnv)) {
>>>             owarn <- get("last.warning", envir = .GlobalEnv)
>>>         } else owarn <- NULL
>>>         last.warning <<- last.warning
>>>         invisible(warnings())
>>>         if (is.null(owarn)) {
>>>             rm("last.warning", envir = .GlobalEnv)
>>>         } else last.warning <<- owarn
>>>              } else {
>>>         # Generate a message similar to the one we got
>>>                  # at the command line
>>>         ### TODO: translation of this message!
>>>         if (n.warn >= 50) {
>>>             cat("There were 50 or more warnings (use warnings() to see 
>>> the first 50)\n")
>>>         } else {
>>>                 cat("There were", n.warn, "warnings (use warnings() to 
>>> see them)\n", sep = " ")
>>>         }
>>>         }
>>>         return(invisible(n.warn))
>>>          }
>>>          # Process all generated items       
>>>          for (item in tmp) {
>>>              if (inherits(item, "try-error")) {
>>>                  # Rework the error message if it occurs in the
>>>                  # calling environment
>>>                     toReplace <-  "^([^ ]*) .*eval\.with\.vis[(]Expr,
>>>                      myEvalEnv\.\., baseenv[(][)][)].*:.*\n\t(.*)$"
>>>                     Replace <- "\\1 : \\2"
>>>             cat(sub(toReplace, Replace, unclass(item)))
>>>             # Do we have to print 'last.warning'?
>>>             last.warning <- attr(item, "last.warning")
>>>             if (!is.null(last.warning)) {
>>>                 # Add "In addition: " before warning, like at
>>>                      # the command line
>>>             cat("In addition: ")
>>>             WarningMessage(last.warning)
>>>             }
>>>                 } else {     # No error
>>>                  if (item$visible) {
>>>                      print(item$value)
>>>                     }
>>>                     # Do we have to print 'last.warning'?
>>>             last.warning <- attr(item, "last.warning")
>>>             if (!is.null(last.warning))
>>>                 WarningMessage(last.warning)
>>>             }
>>>              }
>>>              return(rval)
>>>          }
>>>          results <- capture.all(expr)
>>>          if (inherits(results, "list"))
>>>              results <- paste(results, collapse = "\n")
>>>          # Add the prompt at the end to show that R is ready to process
>>>          # new commands
>>>          results <- paste(paste(results, collapse = "\n"), "> ",
>>>              sep = "\n")
>>>          # Note: we don't use options()$prompt here... we always use a
>>>          # fixed string! It is the client that must manage
>>>          # possible change
>>>      }
>>>      return(results)
>>> }
>>>
>>
>>



From phgrosjean at sciviews.org  Sun Oct 29 14:00:35 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun, 29 Oct 2006 14:00:35 +0100
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <454485F3.1020206@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca> <454478A8.9000903@sciviews.org>
	<454485F3.1020206@stats.uwo.ca>
Message-ID: <4544A5F3.70907@sciviews.org>

[I cut in this message that becomes very long]

Duncan Murdoch wrote:
[...]
> And also thanks to Gabor bringing it up:  and that's really the solution 
> to this second problem.  If you want to do something unusual and don't 
> see a way to do it, ask on R-devel.  If the solution you get requires 
> undocumented functions calls or other kludges, suggest a clean solution 
> to it.

But that's exactly what I am doing!
OK, now the problem formulated in simple terms: I need a R function that 
parses and executes one or several lines of R code and returns EXACTLY 
the same output (including presentation of errors, warnings, etc.) as if 
I issued the same code at the command prompt. Something like:

execute("some R code\nanother line of R code\netc")

The output of execute() would be character strings corresponding to what 
is printed at the R console. May be you don't need such function 
personally, but I can cite at least two examples where we need it: R 
Commander and Tinn-R... and I am sure it could benefit for other R GUIs too.

Now, the best suggestion I can do for this is the awful code below. 
Several points to finalize, and as you say, several parts of the code 
are subject to problems in future versions of R, because workarounds are 
rather fragile against possible future changes in R.

[...]
> The code below looks fragile to me:  it depends on the format of the 
> error message report.  I'm hoping to make syntax errors more informative 
> in the next release, and that will probably change the format of the 
> reports.

Yes, I know! That is why this code is NOT released to CRAN, and also why 
I do NOT propose it as to John Fox or Jose-Claudio Faria as a patch for 
R Commander or Tinn-R, respectively. We are precisely discussing the 
problem to find better solutions (the R GUI API?). For instance, could 
you suggest a better isLineComplete() function? I am pretty sure one 
could get something better using C code, which is something I have not 
attempted to do.

> More information about an error is available at the C level, but I'm not 
> sure how much of that is published in the API.
> 
> Now would be a good time to suggest the ideal thing for parse() to 
> return, from your point of view.  It may not be doable, but if it is, 
> and it would work in other situations, there's a chance it will make it 
> into 2.5.0.

OK, you have it formulated hereabove.

>>
>> isLineComplete <- function(x) {
>>      # x is a character string vector with R code
>>      # The function determines if the parser is satisfied with it
>>      # or it needs more input (code is continued at the next line)
>>
>>      # First parse code
>>      con <- textConnection(x)
>>      expr <- try(parse(con), silent = TRUE)
>>      close(con)
>>
>>      # Determine if this code is correctly parsed
>>      if (inherits(expr, "try-error")) {
>>          results <- expr
>>          # Determine if it is an incomplete line
>>          if (length(grep("\n2:", results)) == 1) return(FALSE)
>>      }
>>      # Note: here, we return TRUE also if the code is wrong
>>      # but one could enhance the function to return something
>>      # else in case of wrong R code
>>      return(TRUE)
>> }
>>
>>  > isLineComplete("ls()")
>> [1] TRUE
>>  > isLineComplete("ls(")
>> [1] FALSE
>>  > isLineComplete("ls())")
>> [1] TRUE
>>
>> - For functions like: xxx.yyy(), it is impossible to know if they are 
>> xxx methods for yyy S3 objects, or simply a function called xxx.yyy() 
>> without parsing the code, or interrogating R another way.
> 
> I think you shouldn't care.  You should leave the evaluation of 
> expressions up to R.

Ah, ha! Do you mean that the only valid way to make syntax highlighting 
of R code is by parsing that code with R? This is too bad that many 
excellent syntax highlighting engines around cannot be used then. For 
instance, the best I could do, using GeSHi, is materialized in the R 
Wiki. You could certainly spot several places where syntax highlighting 
of R code is wrong in the Wiki, but it was the best I could do without 
parsing the code in R, indeed. This was about three months of work to 
get that result.

> R should provide a way for a GUI to evaluate 
> something, and should tell the GUI as much as the GUI needs to know to 
> operate, but the GUI shouldn't try to be an R interpreter.

Really? An embedded R interpreter is absolutely not needed in a R GUI? I 
am afraid I do not agree with this, especially because I thing that a 
GUI should only help users to write code: it should display correct R 
code and show the user how it works at the command prompt... to 
encourage him to switch to the prompt as soon as possible. And that 
would certainly benefit from an embedded R interpreter in the GUI. 
Again, the same actual examples: R Commander and Tinn-R... plus many 
others.

[...]
> I think it's unlikely that I will be doing anything with the 
> error/warning mechanism, but there are other people who might.  So I'd 
> suggest you propose a change that would meet your needs, and see if 
> anyone responds.

...??? But that's what I am doing in this thread? Do I need to formulate 
it in a different way, perhaps?

Philippe Grosjean

[...]



From ggrothendieck at gmail.com  Sun Oct 29 14:03:27 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 29 Oct 2006 08:03:27 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4543FB75.7090405@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca>
Message-ID: <971536df0610290503m9e653caoe0b14b077319d4cc@mail.gmail.com>

On 10/28/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
> > Duncan Murdoch wrote:
> > [...]
> >> I've just added this function to R-devel (to become 2.5.0 next spring):
> >>
> >> withVisible <- function(x) {
> >>      x <- substitute(x)
> >>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
> >>      v
> >> }
> >>
> >> Luke Tierney suggested simplifying the interface (no need to duplicate
> >> the 3 parameter eval interface, you can just wrap this in evalq() if you
> >> need that flexibility); the name "with.vis" was suggested, but it looks
> >> like an S3 method for the with() generic, so I renamed it.
> >>
> >> Duncan Murdoch
> >
> > Excellent, many thanks... but I am afraid I cannot use this function
> > because you force evaluation on parent.frame(), where I need to evaluate
> > it in .GlobalEnv (which is NOT equal to parent.frame() in my context).
> > Would it be possible to change it to:
> >
> > withVisible <- function(x, env = parent.frame()) {
> >      x <- substitute(x)
> >      v <- .Internal(eval.with.vis(x, env, baseenv()))
> >      v
> > }
> >
> > ...so that we got additional flexibility?
>
> As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).

Even if its not strictly necessary in terms of minimality it still might be
convenient and consistent with other eval-style functions which do tend
to provide an env= or in the case of lm-style functions a data= argument.
Also its very easy to do and the underlying internal function supports it.



From murdoch at stats.uwo.ca  Sun Oct 29 14:22:43 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 29 Oct 2006 08:22:43 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610290503m9e653caoe0b14b077319d4cc@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	
	<454023EA.4020403@stats.uwo.ca>	
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	
	<45403561.1000808@stats.uwo.ca>	
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>	
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>	
	<4543FB75.7090405@stats.uwo.ca>
	<971536df0610290503m9e653caoe0b14b077319d4cc@mail.gmail.com>
Message-ID: <4544AB23.6070004@stats.uwo.ca>

On 10/29/2006 8:03 AM, Gabor Grothendieck wrote:
> On 10/28/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
>>> Duncan Murdoch wrote:
>>> [...]
>>>> I've just added this function to R-devel (to become 2.5.0 next spring):
>>>>
>>>> withVisible <- function(x) {
>>>>      x <- substitute(x)
>>>>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>>>>      v
>>>> }
>>>>
>>>> Luke Tierney suggested simplifying the interface (no need to duplicate
>>>> the 3 parameter eval interface, you can just wrap this in evalq() if you
>>>> need that flexibility); the name "with.vis" was suggested, but it looks
>>>> like an S3 method for the with() generic, so I renamed it.
>>>>
>>>> Duncan Murdoch
>>> Excellent, many thanks... but I am afraid I cannot use this function
>>> because you force evaluation on parent.frame(), where I need to evaluate
>>> it in .GlobalEnv (which is NOT equal to parent.frame() in my context).
>>> Would it be possible to change it to:
>>>
>>> withVisible <- function(x, env = parent.frame()) {
>>>      x <- substitute(x)
>>>      v <- .Internal(eval.with.vis(x, env, baseenv()))
>>>      v
>>> }
>>>
>>> ...so that we got additional flexibility?
>> As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).
> 
> Even if its not strictly necessary in terms of minimality it still might be
> convenient and consistent with other eval-style functions which do tend
> to provide an env= or in the case of lm-style functions a data= argument.
> Also its very easy to do and the underlying internal function supports it.

I agree with Luke here.  It's a bad design to make every function do 
everything.  This function reveals the "R_visible" flag.  It doesn't 
need to do anything else.

Duncan Murdoch



From ggrothendieck at gmail.com  Sun Oct 29 14:28:08 2006
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 29 Oct 2006 08:28:08 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4544AB23.6070004@stats.uwo.ca>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca>
	<971536df0610290503m9e653caoe0b14b077319d4cc@mail.gmail.com>
	<4544AB23.6070004@stats.uwo.ca>
Message-ID: <971536df0610290528x82176ay1744f059b26b13eb@mail.gmail.com>

On 10/29/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/29/2006 8:03 AM, Gabor Grothendieck wrote:
> > On 10/28/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
> >>> Duncan Murdoch wrote:
> >>> [...]
> >>>> I've just added this function to R-devel (to become 2.5.0 next spring):
> >>>>
> >>>> withVisible <- function(x) {
> >>>>      x <- substitute(x)
> >>>>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
> >>>>      v
> >>>> }
> >>>>
> >>>> Luke Tierney suggested simplifying the interface (no need to duplicate
> >>>> the 3 parameter eval interface, you can just wrap this in evalq() if you
> >>>> need that flexibility); the name "with.vis" was suggested, but it looks
> >>>> like an S3 method for the with() generic, so I renamed it.
> >>>>
> >>>> Duncan Murdoch
> >>> Excellent, many thanks... but I am afraid I cannot use this function
> >>> because you force evaluation on parent.frame(), where I need to evaluate
> >>> it in .GlobalEnv (which is NOT equal to parent.frame() in my context).
> >>> Would it be possible to change it to:
> >>>
> >>> withVisible <- function(x, env = parent.frame()) {
> >>>      x <- substitute(x)
> >>>      v <- .Internal(eval.with.vis(x, env, baseenv()))
> >>>      v
> >>> }
> >>>
> >>> ...so that we got additional flexibility?
> >> As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).
> >
> > Even if its not strictly necessary in terms of minimality it still might be
> > convenient and consistent with other eval-style functions which do tend
> > to provide an env= or in the case of lm-style functions a data= argument.
> > Also its very easy to do and the underlying internal function supports it.
>
> I agree with Luke here.  It's a bad design to make every function do
> everything.  This function reveals the "R_visible" flag.  It doesn't
> need to do anything else.
>
> Duncan Murdoch
>

But I think that consistency with the rest of R is more important here.
R is hardly minimal -- its a grab bag of a huge amount of functionality
thrown in by numerous people working in parallel so I don't think that
minimality is the right principle here.

If one did not know the calling sequence I think a reasonable guess
would be that there would be such an env= argument so the principle of least
surprise suggests that it be there.



From luke at stat.uiowa.edu  Sun Oct 29 15:02:48 2006
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Sun, 29 Oct 2006 08:02:48 -0600 (CST)
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <971536df0610290528x82176ay1744f059b26b13eb@mail.gmail.com>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca>
	<971536df0610290503m9e653caoe0b14b077319d4cc@mail.gmail.com>
	<4544AB23.6070004@stats.uwo.ca>
	<971536df0610290528x82176ay1744f059b26b13eb@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0610290738080.23717@itasca2.wildberry.org>

On Sun, 29 Oct 2006, Gabor Grothendieck wrote:

> On 10/29/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 10/29/2006 8:03 AM, Gabor Grothendieck wrote:
>>> On 10/28/06, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>> On 10/28/2006 6:03 PM, Philippe Grosjean wrote:
>>>>> Duncan Murdoch wrote:
>>>>> [...]
>>>>>> I've just added this function to R-devel (to become 2.5.0 next spring):
>>>>>>
>>>>>> withVisible <- function(x) {
>>>>>>      x <- substitute(x)
>>>>>>      v <- .Internal(eval.with.vis(x, parent.frame(), baseenv()))
>>>>>>      v
>>>>>> }
>>>>>>
>>>>>> Luke Tierney suggested simplifying the interface (no need to duplicate
>>>>>> the 3 parameter eval interface, you can just wrap this in evalq() if you
>>>>>> need that flexibility); the name "with.vis" was suggested, but it looks
>>>>>> like an S3 method for the with() generic, so I renamed it.
>>>>>>
>>>>>> Duncan Murdoch
>>>>> Excellent, many thanks... but I am afraid I cannot use this function
>>>>> because you force evaluation on parent.frame(), where I need to evaluate
>>>>> it in .GlobalEnv (which is NOT equal to parent.frame() in my context).
>>>>> Would it be possible to change it to:
>>>>>
>>>>> withVisible <- function(x, env = parent.frame()) {
>>>>>      x <- substitute(x)
>>>>>      v <- .Internal(eval.with.vis(x, env, baseenv()))
>>>>>      v
>>>>> }
>>>>>
>>>>> ...so that we got additional flexibility?
>>>> As I said, that's not needed.  Use evalq(withVisible(x), envir=.GlobalEnv).
>>>
>>> Even if its not strictly necessary in terms of minimality it still might be
>>> convenient and consistent with other eval-style functions which do tend
>>> to provide an env= or in the case of lm-style functions a data= argument.
>>> Also its very easy to do and the underlying internal function supports it.
>>
>> I agree with Luke here.  It's a bad design to make every function do
>> everything.  This function reveals the "R_visible" flag.  It doesn't
>> need to do anything else.
>>
>> Duncan Murdoch
>>
>
> But I think that consistency with the rest of R is more important here.
> R is hardly minimal -- its a grab bag of a huge amount of functionality
> thrown in by numerous people working in parallel so I don't think that
> minimality is the right principle here.
>
> If one did not know the calling sequence I think a reasonable guess
> would be that there would be such an env= argument so the principle of least
> surprise suggests that it be there.

You are missing the point. withVisible is not an eval-type function in
the sense of taking a quoted expression as its argument and evaluating
that in a particular environment.  It instead insures that the literal
argument expresion is evaluated in a way consistent with standard
evaluation within a context where the visibility is captured.  As such
it is more closely related to try or tryCatch than to eval.  The
language we use to distinguish these cases in the documentation isn't
ideal and could use some work.

Use of nonstandard evaluation, i.e. direct calls to eval, are a source
of many bugs and confusions to code readers (people or code analysis
tools).  We need to avoid encouraging more of that. That is why it
makes sense to handle things such as this in a way that is consistent
with standard evaluation.  If you have an unevaluated expression you
want to evaluate in a way that captures the visibility then

     evalVis <- function(...) withVisible(eval(...))

will do this.

The current implementation does happen to use an eval construct but
that isn't guaranteed to remain. Conceptually what we want is
something that captures an argument promise and insures that this is
forced in a way that captures
visibility. .Internal(eval.with.vis(substitute(...))) happens to be a
convenient way to do this at the moment but should be changed
eventually to work in terms of promises (so that byte compiled
promises, for example, are run as byte compiled code, not by
interpreted as would happen now.)


Best,

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu



From murdoch at stats.uwo.ca  Sun Oct 29 15:19:05 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 29 Oct 2006 09:19:05 -0500
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4544A5F3.70907@sciviews.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca> <454478A8.9000903@sciviews.org>
	<454485F3.1020206@stats.uwo.ca> <4544A5F3.70907@sciviews.org>
Message-ID: <4544B859.8010604@stats.uwo.ca>

On 10/29/2006 8:00 AM, Philippe Grosjean wrote:
> [I cut in this message that becomes very long]
> 
> Duncan Murdoch wrote:
> [...]
>> And also thanks to Gabor bringing it up:  and that's really the solution 
>> to this second problem.  If you want to do something unusual and don't 
>> see a way to do it, ask on R-devel.  If the solution you get requires 
>> undocumented functions calls or other kludges, suggest a clean solution 
>> to it.
> 
> But that's exactly what I am doing!

So far I don't think we have a "clean solution".  See comments below.

> OK, now the problem formulated in simple terms: I need a R function that 
> parses and executes one or several lines of R code and returns EXACTLY 
> the same output (including presentation of errors, warnings, etc.) as if 
> I issued the same code at the command prompt. Something like:

If you need that, you should write it yourself from components that R 
provides.  "The same output" should not be a well defined concept:  it's 
up to the GUI to decide what the output is, i.e. how values and errors 
are presented, etc.

What R needs is a way for you to write that function.  In particular, 
you should have a way to parse source code (you do), you should have a 
way to execute parsed code (you do), and you should have a way to work 
out what R would print and what error messages or warnings it might want 
to display. It's mainly the 3rd part that is incomplete now, and 
withVisible is intended to help with that.  As you've pointed out, the 
parsing also has some problems with communicating errors to you (e.g. 
letting you know when the input is incomplete).

> execute("some R code\nanother line of R code\netc")
> 
> The output of execute() would be character strings corresponding to what 
> is printed at the R console. May be you don't need such function 
> personally, but I can cite at least two examples where we need it: R 
> Commander and Tinn-R... and I am sure it could benefit for other R GUIs too.

And I disagree with that claim.  Those GUIs don't need to replicate R's 
console, they need to present results and error messages in an 
appropriate way.  The way this is done in existing R console 
implementations is a very old and robust model (the teletype), but it's 
not necessarily an appropriate model for all GUIs.

> Now, the best suggestion I can do for this is the awful code below. 
> Several points to finalize, and as you say, several parts of the code 
> are subject to problems in future versions of R, because workarounds are 
> rather fragile against possible future changes in R.
> 
> [...]
>> The code below looks fragile to me:  it depends on the format of the 
>> error message report.  I'm hoping to make syntax errors more informative 
>> in the next release, and that will probably change the format of the 
>> reports.
> 
> Yes, I know! That is why this code is NOT released to CRAN, and also why 
> I do NOT propose it as to John Fox or Jose-Claudio Faria as a patch for 
> R Commander or Tinn-R, respectively. We are precisely discussing the 
> problem to find better solutions (the R GUI API?). For instance, could 
> you suggest a better isLineComplete() function? I am pretty sure one 
> could get something better using C code, which is something I have not 
> attempted to do.

I don't know a better isLineComplete function currently, but if parse() 
returned more structured error information, it would be easy to write 
one.  (Of course, we might not need one in that case...)

I think that's a better approach, and it's definitely something that I 
am interested in working on.  It seems to me to be a waste of my time to 
make internal changes that will not only allow, but *force* all GUI 
writers to replicate the R console.  It should be easy to do that (and 
it's not now), but it should also be easy to do something quite different.
> 
>> More information about an error is available at the C level, but I'm not 
>> sure how much of that is published in the API.
>>
>> Now would be a good time to suggest the ideal thing for parse() to 
>> return, from your point of view.  It may not be doable, but if it is, 
>> and it would work in other situations, there's a chance it will make it 
>> into 2.5.0.
> 
> OK, you have it formulated hereabove.

Not yet...

>>> isLineComplete <- function(x) {
>>>      # x is a character string vector with R code
>>>      # The function determines if the parser is satisfied with it
>>>      # or it needs more input (code is continued at the next line)
>>>
>>>      # First parse code
>>>      con <- textConnection(x)
>>>      expr <- try(parse(con), silent = TRUE)
>>>      close(con)
>>>
>>>      # Determine if this code is correctly parsed
>>>      if (inherits(expr, "try-error")) {
>>>          results <- expr
>>>          # Determine if it is an incomplete line
>>>          if (length(grep("\n2:", results)) == 1) return(FALSE)
>>>      }
>>>      # Note: here, we return TRUE also if the code is wrong
>>>      # but one could enhance the function to return something
>>>      # else in case of wrong R code
>>>      return(TRUE)
>>> }
>>>
>>>  > isLineComplete("ls()")
>>> [1] TRUE
>>>  > isLineComplete("ls(")
>>> [1] FALSE
>>>  > isLineComplete("ls())")
>>> [1] TRUE
>>>
>>> - For functions like: xxx.yyy(), it is impossible to know if they are 
>>> xxx methods for yyy S3 objects, or simply a function called xxx.yyy() 
>>> without parsing the code, or interrogating R another way.
>> I think you shouldn't care.  You should leave the evaluation of 
>> expressions up to R.
> 
> Ah, ha! Do you mean that the only valid way to make syntax highlighting 
> of R code is by parsing that code with R?

I think the only reliable way would involve R.  Whether other methods 
are "valid" or not depends on their goals.

 > This is too bad that many
> excellent syntax highlighting engines around cannot be used then. For 
> instance, the best I could do, using GeSHi, is materialized in the R 
> Wiki. You could certainly spot several places where syntax highlighting 
> of R code is wrong in the Wiki, but it was the best I could do without 
> parsing the code in R, indeed. This was about three months of work to 
> get that result.

I think a syntax highlighting engine that can't work with the R parser 
couldn't do an excellent job.  Take a look at the MacOSX GUI:  it can 
provide syntax hints on functions you've just written.  It needs to be 
working closely with R to do that, it can't use a big pre-compiled table 
of existing functions.

>> R should provide a way for a GUI to evaluate 
>> something, and should tell the GUI as much as the GUI needs to know to 
>> operate, but the GUI shouldn't try to be an R interpreter.
> 
> Really? An embedded R interpreter is absolutely not needed in a R GUI? I 
> am afraid I do not agree with this, especially because I thing that a 
> GUI should only help users to write code: it should display correct R 
> code and show the user how it works at the command prompt... to 
> encourage him to switch to the prompt as soon as possible. And that 
> would certainly benefit from an embedded R interpreter in the GUI. 
> Again, the same actual examples: R Commander and Tinn-R... plus many 
> others.

I think you misunderstood me.  I think the GUI should do all those 
things, but you as a GUI writer shouldn't have to write an R interpreter 
to do them.  You should be able to ask R to do that kind of work for you.
> 
> [...]
>> I think it's unlikely that I will be doing anything with the 
>> error/warning mechanism, but there are other people who might.  So I'd 
>> suggest you propose a change that would meet your needs, and see if 
>> anyone responds.
> 
> ...??? But that's what I am doing in this thread? Do I need to formulate 
> it in a different way, perhaps?

Yes, I think so.  I think it would help to break down your questions to 
small, self-contained tasks, and work on them one at a time.  What's the 
most important thing you'd like R to do for you that you can't figure 
out?  Perhaps it's already there, and you just need someone to tell you 
what to do, or maybe it's not there, and R needs some changes.

In the latter case, you'll have to convince someone in R Core that your 
problem is worth solving.  That means making it appear that the value 
gained (from their point of view, not yours) exceeds the amount of work 
required so much that they should put aside other work to solve your 
problem.  (There are very few idle cycles in the R Core to work on low 
priority jobs.)

You can decrease the amount of their work by actually designing and 
submitting a nice clean patch to implement the change, but convincing 
them of the value of the change is harder.  So make a clear, short 
argument about why the change would be valuable.

So far I've been convinced that exposing the R_Visible flag is a good 
idea, and that's done.  I'm also convinced that it would be valuable to 
make more error information available from the parser, but I don't yet 
know the best way to do that.

I'm not convinced that the error and warning mechanism needs changes, 
and even if I were, I would not work on that problem:  it would just 
take too much of my time to learn the internals of the error handling 
well enough to make changes.  So you'll have to convince someone else of 
the need for changes there.

Duncan Murdoch



From jmc at r-project.org  Sun Oct 29 15:28:17 2006
From: jmc at r-project.org (John Chambers)
Date: Sun, 29 Oct 2006 09:28:17 -0500
Subject: [Rd] Pb with .findInheritedMethods
In-Reply-To: <m2iri3q5yi.fsf@ziti.local>
References: <454142C1.9030809@fhcrc.org> <45415AB4.3050505@fhcrc.org>
	<454204C3.2030606@r-project.org> <45424E50.8030206@fhcrc.org>
	<4543E723.4080402@r-project.org> <m2iri3q5yi.fsf@ziti.local>
Message-ID: <4544BA81.7090703@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061029/227f9663/attachment-0003.pl 

From mtmorgan at fhcrc.org  Sun Oct 29 15:56:59 2006
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 29 Oct 2006 06:56:59 -0800
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <4544B859.8010604@stats.uwo.ca> (Duncan Murdoch's message of
	"Sun, 29 Oct 2006 09:19:05 -0500")
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>
	<454023EA.4020403@stats.uwo.ca>
	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>
	<45403561.1000808@stats.uwo.ca>
	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>
	<45438F9B.7000905@stats.uwo.ca> <4543D3A6.7010900@sciviews.org>
	<4543FB75.7090405@stats.uwo.ca> <454478A8.9000903@sciviews.org>
	<454485F3.1020206@stats.uwo.ca> <4544A5F3.70907@sciviews.org>
	<4544B859.8010604@stats.uwo.ca>
Message-ID: <6phwt6jgog4.fsf@gopher4.fhcrc.org>

>> Yes, I know! That is why this code is NOT released to CRAN, and also why 
>> I do NOT propose it as to John Fox or Jose-Claudio Faria as a patch for 
>> R Commander or Tinn-R, respectively. We are precisely discussing the 
>> problem to find better solutions (the R GUI API?). For instance, could 
>> you suggest a better isLineComplete() function? I am pretty sure one 
>> could get something better using C code, which is something I have not 
>> attempted to do.
>
> I don't know a better isLineComplete function currently, but if parse() 
> returned more structured error information, it would be easy to write 
> one.  (Of course, we might not need one in that case...)
>
> I think that's a better approach, and it's definitely something that I 
> am interested in working on.  It seems to me to be a waste of my time to 
> make internal changes that will not only allow, but *force* all GUI 
> writers to replicate the R console.  It should be easy to do that (and 
> it's not now), but it should also be easy to do something quite different.

Prof. Ripley improved the mechanism for handling this at the C level
during the last release cycle. The basic strategy is

#include <R_ext/Parse.h>

SEXP parses(SEXP cmd, SEXP rho) {
  ParseStatus status;
  SEXP res = R_ParseVector(cmd, -1, &status);
  switch(status) {
  case PARSE_NULL:
  case PARSE_OK:
    break;
  case PARSE_INCOMPLETE:
    ...
    break;
  case PARSE_ERROR:
    ...
    break;
  case PARSE_EOF:
    ... /* not sure we ever reach here -- incomplete before eof */
    break;
  }
  return res;
}

my implementation of '...' is to signalCondition, so at the R level
you can detect the outcome in a tryCatch, something like

        expr <- readLines(file, 1)
        expr <- tryCatch(.Call("parses", expr, environment()),
                         parse_incomplete = ...)


Martin
-- 
Bioconductor / Computational Biology
http://bioconductor.org



From phgrosjean at sciviews.org  Sun Oct 29 17:16:57 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun, 29 Oct 2006 17:16:57 +0100
Subject: [Rd] how to determine if a function's result is invisible
In-Reply-To: <6phwt6jgog4.fsf@gopher4.fhcrc.org>
References: <971536df0610251714u451cf80fy80bf38cb2f130734@mail.gmail.com>	<454023EA.4020403@stats.uwo.ca>	<971536df0610252002s46ef72b2n32df3e180a49e990@mail.gmail.com>	<45403561.1000808@stats.uwo.ca>	<971536df0610260226o55726354j8cbdfa5af07ae508@mail.gmail.com>	<45438F9B.7000905@stats.uwo.ca>
	<4543D3A6.7010900@sciviews.org>	<4543FB75.7090405@stats.uwo.ca>
	<454478A8.9000903@sciviews.org>	<454485F3.1020206@stats.uwo.ca>
	<4544A5F3.70907@sciviews.org>	<4544B859.8010604@stats.uwo.ca>
	<6phwt6jgog4.fsf@gopher4.fhcrc.org>
Message-ID: <4544D3F9.4080500@sciviews.org>

Martin Morgan wrote:
>>> Yes, I know! That is why this code is NOT released to CRAN, and also why 
>>> I do NOT propose it as to John Fox or Jose-Claudio Faria as a patch for 
>>> R Commander or Tinn-R, respectively. We are precisely discussing the 
>>> problem to find better solutions (the R GUI API?). For instance, could 
>>> you suggest a better isLineComplete() function? I am pretty sure one 
>>> could get something better using C code, which is something I have not 
>>> attempted to do.
>> I don't know a better isLineComplete function currently, but if parse() 
>> returned more structured error information, it would be easy to write 
>> one.  (Of course, we might not need one in that case...)
>>
>> I think that's a better approach, and it's definitely something that I 
>> am interested in working on.  It seems to me to be a waste of my time to 
>> make internal changes that will not only allow, but *force* all GUI 
>> writers to replicate the R console.  It should be easy to do that (and 
>> it's not now), but it should also be easy to do something quite different.
> 
> Prof. Ripley improved the mechanism for handling this at the C level
> during the last release cycle. The basic strategy is
> 
> #include <R_ext/Parse.h>
> 
> SEXP parses(SEXP cmd, SEXP rho) {
>   ParseStatus status;
>   SEXP res = R_ParseVector(cmd, -1, &status);
>   switch(status) {
>   case PARSE_NULL:
>   case PARSE_OK:
>     break;
>   case PARSE_INCOMPLETE:
>     ...
>     break;
>   case PARSE_ERROR:
>     ...
>     break;
>   case PARSE_EOF:
>     ... /* not sure we ever reach here -- incomplete before eof */
>     break;
>   }
>   return res;
> }
> 
> my implementation of '...' is to signalCondition, so at the R level
> you can detect the outcome in a tryCatch, something like
> 
>         expr <- readLines(file, 1)
>         expr <- tryCatch(.Call("parses", expr, environment()),
>                          parse_incomplete = ...)
> 
> 
> Martin

Oh, very nice! I'll look at this. Many thanks.

Philippe



From Philippe.Grosjean at umh.ac.be  Sun Oct 29 17:54:51 2006
From: Philippe.Grosjean at umh.ac.be (Philippe Grosjean)
Date: Sun, 29 Oct 2006 17:54:51 +0100
Subject: [Rd] R GUI API: suggestion for R function to put in there?
Message-ID: <4544DCDB.3060703@umh.ac.be>

Well, following a discussion with Duncan Murdoch, where he suggests me 
to rewrite my requests, here it is.

Just a couple of problems I found difficult to solve, as a writer of R 
GUIs, and for which I would be very happy to get a R function (plus 
rationates):

- To know if an evaluation returns invisibly or not. This is discussed 
in a previous thread. We now have withVisible().

- To know if some R code is complete or is continued to the next line. 
The following trick was suggested by Peter Dalgaard once, but it is 
fragile because it depends on the way R prints errors, and that may 
change in the future:

isLineComplete <- function(x) {
       # x is a character string vector with R code
       # The function determines if the parser is satisfied with it
       # or it needs more input (code is continued at the next line)

       # First parse code
       con <- textConnection(x)
       expr <- try(parse(con), silent = TRUE)
       close(con)

       # Determine if this code is correctly parsed
       if (inherits(expr, "try-error")) {
           results <- expr
           # Determine if it is an incomplete line
           if (length(grep("\n2:", results)) == 1) return(FALSE)
       }
       # Note: here, we return TRUE also if the code is wrong
       # but one could enhance the function to return something
       # else in case of wrong R code
       return(TRUE)
  }

   > isLineComplete("ls()")
  [1] TRUE
   > isLineComplete("ls(")
  [1] FALSE
   > isLineComplete("ls())")
  [1] TRUE

- To execute R code contained in a string and return the result of this 
evaluation in a string (including presentation of error messages and 
warnings) exactly as if this was entered at the prompt. Duncan Murdoch 
is against such a kind of function (he says a GUI should not substitute 
to the R interpreter, and it should manage and present errors or 
warnings in a better way than the teletype approach of the command 
line). However, there are occasions where we would like to embed a 
little R interpreter in a GUI. R Commander and Tinn-R are two good 
examples. Also, I advocate for a R GUI that is a layer on top of the R 
Console, but ultimately shows to the user (1) what is the equivalent R 
code he should type at the prompt, and (2) what does R replies if this 
code is issued at the prompt. That way, the GUI is just a convenient way 
to learn R, and to get a smooth move to the intimidating command line. 
In this context a kind of 'execute("some R code")' function should be 
fine (and I see a couple of additional usages for this too).

- In the same idea, to write a similar function, but that returns a list 
of strings, each string being flagged as 'output', 'warning' or 'error'. 
The succession should correspond to the evaluation (this is especially 
tricky for warning messages, due to the complex way R handles those 
warning message.

- To know which objects were changed since a given date, or during last 
call. This should require a time flag on the variable that contains this 
object. One particular application is an object explorer that could 
update information quickly if it could query only those objects that 
have changed since last process. This topic has already been discussed a 
couple of times, and no convincing solution has emerged (technical 
problems), it seems... but it is worth to continue thinking about it.

- To know if R is currently processing something in another event loop. 
Since R was designed initially to work with a single event loop, this 
was obviously useless. Now that we can use separate event loops for, 
let's say, command issued at the prompt, and do some other jobs with the 
embedded Tcl (tcltk package), for instance, it could be useful to know 
the state of R for the respective event loops. For instance, I would 
like to know if R is processing some code issued at the prompt, from an 
interface written in Tcl (like svSockets, for instance, or the mini-web 
server built in Rpad, for another example).

This is just a couple of suggestions that would make the life of R GUI 
writers a little bit easier (at least mine). Now, I don't want to enter 
in endless discussion if something is useful or not,... but if someone 
has the solution for one of these problems, or is ready to write an R 
function to provide such functionalities, i would be very happy.

Best,

Philippe Grosjean



From juan_sr at uol.com.br  Sun Oct 29 16:58:02 2006
From: juan_sr at uol.com.br (Juan Santiago Ramseyer)
Date: Sun, 29 Oct 2006 12:58:02 -0300
Subject: [Rd] install packages RMySQL fail
Message-ID: <1162137482.7303.8.camel@localhost.localdomain>

install packages RMySQL fail.

System Fedora Core 6 x86_64

see down. It's bug or incomplete install MySQL?

Juan.

______________________________________________________________
PROMPT MySQL

$ mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2 to server version: 5.0.22

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql>
______________________________________________________________

PROMPT R INSTALLING RMySQL

> install.packages()
tentando a URL
'http://www.insecta.ufv.br/CRAN/src/contrib/RMySQL_0.5-10.tar.gz'
Content type 'application/x-tar' length 142671 bytes
URL aberta
==================================================
downloaded 139Kb

* Installing *source* package 'RMySQL' ...
creating cache ./config.cache
checking how to run the C preprocessor... cc -E
checking for compress in -lz... yes
checking for getopt_long in -lc... yes
checking for mysql_init in -lmysqlclient... no
checking for mysql.h... no
checking for mysql_init in -lmysqlclient... no
checking for mysql_init in -lmysqlclient... no
checking for mysql_init in -lmysqlclient... no
checking for mysql_init in -lmysqlclient... no
checking for mysql_init in -lmysqlclient... no
checking for /usr/local/include/mysql/mysql.h... no
checking for /usr/include/mysql/mysql.h... yes

Configuration error:
  could not find the MySQL installation include and/or library
  directories.  Manually specify the location of the MySQL
  libraries and the header files and re-run R CMD INSTALL.

INSTRUCTIONS:

1. Define and export the 2 shell variables PKG_CPPFLAGS and
   PKG_LIBS to include the directory for header files (*.h)
   and libraries, for example (using Bourne shell syntax):

      export PKG_CPPFLAGS="-I<MySQL-include-dir>"
      export PKG_LIBS="-L<MySQL-lib-dir> -lmysqlclient"

   Re-run the R INSTALL command:

      R CMD INSTALL RMySQL_<version>.tar.gz

2. Alternatively, you may pass the configure arguments
      --with-mysql-dir=<base-dir> (distribution directory)
   or
      --with-mysql-inc=<base-inc> (where MySQL header files reside)
      --with-mysql-lib=<base-lib> (where MySQL libraries reside)
   in the call to R INSTALL --configure-args='...'

   R CMD INSTALL --configure-args='--with-mysql-dir=DIR'
RMySQL_<version>.tar.gz

ERROR: configuration failed for package 'RMySQL'
** Removing '/usr/lib64/R/library/RMySQL'

The downloaded packages are in
        /tmp/Rtmpioa2vr/downloaded_packages
Warning message:
installation of package 'RMySQL' had non-zero exit status in:
install.packages()



From h.wickham at gmail.com  Sun Oct 29 17:28:17 2006
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 29 Oct 2006 11:28:17 -0500
Subject: [Rd] R GUI API: suggestion for R function to put in there?
In-Reply-To: <4544DCDB.3060703@umh.ac.be>
References: <4544DCDB.3060703@umh.ac.be>
Message-ID: <f8e6ff050610290828v28339862m7ef735bfca146cba@mail.gmail.com>

> - To execute R code contained in a string and return the result of this
> evaluation in a string (including presentation of error messages and
> warnings) exactly as if this was entered at the prompt. Duncan Murdoch
> is against such a kind of function (he says a GUI should not substitute
> to the R interpreter, and it should manage and present errors or
> warnings in a better way than the teletype approach of the command

This is useful for useful for things like Sweave.  I have a modified
version of capture.output that captures everything:

capture.all <- function(code, envir = globalenv()) {
	printErrors <- function(code) {
		tryCatch(
			eval(parse(text=code), envir = envir),
			error = function(e) o(e)
		)
	}

	paste(capture.output(
	  withCallingHandlers(printErrors(code), warning = function(x) {
		cat("Warning: ", x$message, "\n")
		invokeRestart("muffleWarning")
	})), collapse="\n", sep="")
}

for my (unreleased) sweave-like package.  It's not perfect, but it has
served my needs.

Hadley



From edd at debian.org  Sun Oct 29 17:29:20 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 29 Oct 2006 10:29:20 -0600
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <17731.47718.276693.860730@stat.math.ethz.ch>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
	<17731.23422.758314.211918@basebud.nulle.part>
	<17731.47718.276693.860730@stat.math.ethz.ch>
Message-ID: <17732.55008.463758.127507@basebud.nulle.part>


On 28 October 2006 at 22:15, Martin Maechler wrote:
| but no longer now.
| [A  "svn cleanup"  was needed.
|  I've amended the cron-job script to do an "svn cleanup" now 
|  always before "svn update".  This of course is a waste of time in
|  99.9% of cases; but it's just a CPU's time, not a person's ....]
| 
| Usually such problems would be solved more quickly if someone
| e-mailed me directly...

Something still looks still fishy. Cut&pasted from the directory view:

Directory: R-patched.tar.bz2  	 	10/29/2006  	01:00:00 AM
Directory: R-patched.tar.gz 		10/29/2006 	01:00:00 AM
File: R-patched_2006-10-03.tar.bz2 	11798 KB 	10/28/2006 	12:58:00 AM
File: R-patched_2006-10-03.tar.gz 	14214 KB 	10/28/2006 	12:57:00 AM
File: R-patched_2006-10-27.tar.bz2 	11810 KB 	10/29/2006 	01:00:00 AM
File: R-patched_2006-10-27.tar.gz 	14221 KB 	10/29/2006 	12:59:00 AM
File: R-release.diff.gz 	68 KB 	10/29/2006 	01:17:00 AM

Or is the date in R-patched derived from the last SVN checkin which would
then happen to have been 2006-10-27?  Not according to the top of the svn log
from http://developer.r-project.org/R.svnlog.2006: (and cut down to dates
only)

r39739 | murdoch | 2006-10-28 21:13:45 -0400 (Sat, 28 Oct 2006) | 1 line
r39738 | murdoch | 2006-10-28 21:07:16 -0400 (Sat, 28 Oct 2006) | 1 line
r39737 | murdoch | 2006-10-28 19:56:27 -0400 (Sat, 28 Oct 2006) | 1 line
r39736 | murdoch | 2006-10-28 13:04:58 -0400 (Sat, 28 Oct 2006) | 1 line
r39735 | maechler | 2006-10-27 17:53:36 -0400 (Fri, 27 Oct 2006) | 1 line
r39734 | hornik | 2006-10-27 13:59:17 -0400 (Fri, 27 Oct 2006) | 1 line
r39733 | hornik | 2006-10-27 13:59:16 -0400 (Fri, 27 Oct 2006) | 1 line
[...]


Hth, Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From phgrosjean at sciviews.org  Sun Oct 29 18:40:07 2006
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun, 29 Oct 2006 18:40:07 +0100
Subject: [Rd] R GUI API: suggestion for R function to put in there?
In-Reply-To: <f8e6ff050610290828v28339862m7ef735bfca146cba@mail.gmail.com>
References: <4544DCDB.3060703@umh.ac.be>
	<f8e6ff050610290828v28339862m7ef735bfca146cba@mail.gmail.com>
Message-ID: <4544E777.8050502@sciviews.org>



hadley wickham wrote:
>> - To execute R code contained in a string and return the result of this
>> evaluation in a string (including presentation of error messages and
>> warnings) exactly as if this was entered at the prompt. Duncan Murdoch
>> is against such a kind of function (he says a GUI should not substitute
>> to the R interpreter, and it should manage and present errors or
>> warnings in a better way than the teletype approach of the command
> 
> This is useful for useful for things like Sweave.  I have a modified
> version of capture.output that captures everything:
> 
> capture.all <- function(code, envir = globalenv()) {
>     printErrors <- function(code) {
>         tryCatch(
>             eval(parse(text=code), envir = envir),
>             error = function(e) o(e)
>         )
>     }
> 
>     paste(capture.output(
>       withCallingHandlers(printErrors(code), warning = function(x) {
>         cat("Warning: ", x$message, "\n")
>         invokeRestart("muffleWarning")
>     })), collapse="\n", sep="")
> }
> 
> for my (unreleased) sweave-like package.  It's not perfect, but it has
> served my needs.
> 
> Hadley

Thanks, but... something is missing: what is the function o()? I don't 
find it elsewhere.
Best,

Philippe Grosjean



From sfalcon at fhcrc.org  Sun Oct 29 17:44:47 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Sun, 29 Oct 2006 08:44:47 -0800
Subject: [Rd] install packages RMySQL fail
In-Reply-To: <1162137482.7303.8.camel@localhost.localdomain> (Juan Santiago
	Ramseyer's message of "Sun, 29 Oct 2006 12:58:02 -0300")
References: <1162137482.7303.8.camel@localhost.localdomain>
Message-ID: <m2ac3foyv4.fsf@ziti.local>

Juan Santiago Ramseyer <juan_sr at uol.com.br> writes:

> install packages RMySQL fail.
>
> System Fedora Core 6 x86_64
>
> see down. It's bug or incomplete install MySQL?

You need to install the devel headers for MySQL.  This should be
available as an rpm for your system.

+ seth



From murdoch at stats.uwo.ca  Sun Oct 29 17:49:41 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 29 Oct 2006 11:49:41 -0500
Subject: [Rd] R GUI API: suggestion for R function to put in there?
In-Reply-To: <4544DCDB.3060703@umh.ac.be>
References: <4544DCDB.3060703@umh.ac.be>
Message-ID: <4544DBA5.3000702@stats.uwo.ca>

Thanks for posting this list.  I just want to clarify one place where 
you quote me:

On 10/29/2006 11:54 AM, Philippe Grosjean wrote:

  ... deletions

> - To execute R code contained in a string and return the result of this 
> evaluation in a string (including presentation of error messages and 
> warnings) exactly as if this was entered at the prompt. Duncan Murdoch 
> is against such a kind of function (he says a GUI should not substitute 
> to the R interpreter, and it should manage and present errors or 
> warnings in a better way than the teletype approach of the command 
> line). 

I actually said that a GUI should "be able to" do these things.  My only 
objection to the proposed function is that it's not sufficient.  R 
should supply facilities that make it easy to write that function, by 
supplying the mechanisms for the GUI to get at everything necessary.

Duncan Murdoch



From edd at debian.org  Sun Oct 29 18:43:36 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 29 Oct 2006 11:43:36 -0600
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <17732.55008.463758.127507@basebud.nulle.part>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
	<17731.23422.758314.211918@basebud.nulle.part>
	<17731.47718.276693.860730@stat.math.ethz.ch>
	<17732.55008.463758.127507@basebud.nulle.part>
Message-ID: <17732.59464.767865.803543@basebud.nulle.part>


On 29 October 2006 at 10:29, Dirk Eddelbuettel wrote:
| 
| On 28 October 2006 at 22:15, Martin Maechler wrote:
| | but no longer now.
| | [A  "svn cleanup"  was needed.
| |  I've amended the cron-job script to do an "svn cleanup" now 
| |  always before "svn update".  This of course is a waste of time in
| |  99.9% of cases; but it's just a CPU's time, not a person's ....]
| | 
| | Usually such problems would be solved more quickly if someone
| | e-mailed me directly...
| 
| Something still looks still fishy. Cut&pasted from the directory view:
| 
| Directory: R-patched.tar.bz2  	 	10/29/2006  	01:00:00 AM
| Directory: R-patched.tar.gz 		10/29/2006 	01:00:00 AM
| File: R-patched_2006-10-03.tar.bz2 	11798 KB 	10/28/2006 	12:58:00 AM
| File: R-patched_2006-10-03.tar.gz 	14214 KB 	10/28/2006 	12:57:00 AM
| File: R-patched_2006-10-27.tar.bz2 	11810 KB 	10/29/2006 	01:00:00 AM
| File: R-patched_2006-10-27.tar.gz 	14221 KB 	10/29/2006 	12:59:00 AM
| File: R-release.diff.gz 	68 KB 	10/29/2006 	01:17:00 AM
| 
| Or is the date in R-patched derived from the last SVN checkin which would
| then happen to have been 2006-10-27?  Not according to the top of the svn log
| from http://developer.r-project.org/R.svnlog.2006: (and cut down to dates
| only)
| 
| r39739 | murdoch | 2006-10-28 21:13:45 -0400 (Sat, 28 Oct 2006) | 1 line
| r39738 | murdoch | 2006-10-28 21:07:16 -0400 (Sat, 28 Oct 2006) | 1 line
| r39737 | murdoch | 2006-10-28 19:56:27 -0400 (Sat, 28 Oct 2006) | 1 line
| r39736 | murdoch | 2006-10-28 13:04:58 -0400 (Sat, 28 Oct 2006) | 1 line
| r39735 | maechler | 2006-10-27 17:53:36 -0400 (Fri, 27 Oct 2006) | 1 line
| r39734 | hornik | 2006-10-27 13:59:17 -0400 (Fri, 27 Oct 2006) | 1 line
| r39733 | hornik | 2006-10-27 13:59:16 -0400 (Fri, 27 Oct 2006) | 1 line
| [...]

... unless of course all those checkins went to trunk/ aka R-devel.

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From murdoch at stats.uwo.ca  Sun Oct 29 19:26:08 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 29 Oct 2006 13:26:08 -0500
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <17732.59464.767865.803543@basebud.nulle.part>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>	<17731.23422.758314.211918@basebud.nulle.part>	<17731.47718.276693.860730@stat.math.ethz.ch>	<17732.55008.463758.127507@basebud.nulle.part>
	<17732.59464.767865.803543@basebud.nulle.part>
Message-ID: <4544F240.3060305@stats.uwo.ca>

On 10/29/2006 12:43 PM, Dirk Eddelbuettel wrote:
> On 29 October 2006 at 10:29, Dirk Eddelbuettel wrote:
> | 
> | On 28 October 2006 at 22:15, Martin Maechler wrote:
> | | but no longer now.
> | | [A  "svn cleanup"  was needed.
> | |  I've amended the cron-job script to do an "svn cleanup" now 
> | |  always before "svn update".  This of course is a waste of time in
> | |  99.9% of cases; but it's just a CPU's time, not a person's ....]
> | | 
> | | Usually such problems would be solved more quickly if someone
> | | e-mailed me directly...
> | 
> | Something still looks still fishy. Cut&pasted from the directory view:
> | 
> | Directory: R-patched.tar.bz2  	 	10/29/2006  	01:00:00 AM
> | Directory: R-patched.tar.gz 		10/29/2006 	01:00:00 AM
> | File: R-patched_2006-10-03.tar.bz2 	11798 KB 	10/28/2006 	12:58:00 AM
> | File: R-patched_2006-10-03.tar.gz 	14214 KB 	10/28/2006 	12:57:00 AM
> | File: R-patched_2006-10-27.tar.bz2 	11810 KB 	10/29/2006 	01:00:00 AM
> | File: R-patched_2006-10-27.tar.gz 	14221 KB 	10/29/2006 	12:59:00 AM
> | File: R-release.diff.gz 	68 KB 	10/29/2006 	01:17:00 AM
> | 
> | Or is the date in R-patched derived from the last SVN checkin which would
> | then happen to have been 2006-10-27?  Not according to the top of the svn log
> | from http://developer.r-project.org/R.svnlog.2006: (and cut down to dates
> | only)
> | 
> | r39739 | murdoch | 2006-10-28 21:13:45 -0400 (Sat, 28 Oct 2006) | 1 line
> | r39738 | murdoch | 2006-10-28 21:07:16 -0400 (Sat, 28 Oct 2006) | 1 line
> | r39737 | murdoch | 2006-10-28 19:56:27 -0400 (Sat, 28 Oct 2006) | 1 line
> | r39736 | murdoch | 2006-10-28 13:04:58 -0400 (Sat, 28 Oct 2006) | 1 line
> | r39735 | maechler | 2006-10-27 17:53:36 -0400 (Fri, 27 Oct 2006) | 1 line
> | r39734 | hornik | 2006-10-27 13:59:17 -0400 (Fri, 27 Oct 2006) | 1 line
> | r39733 | hornik | 2006-10-27 13:59:16 -0400 (Fri, 27 Oct 2006) | 1 line
> | [...]
> 
> ... unless of course all those checkins went to trunk/ aka R-devel.

Tbey're not all to trunk, but 39735 is the last one to R-patched, so the 
date in the dir listing looks okay.

Duncan Murdoch



From p.dalgaard at biostat.ku.dk  Sun Oct 29 19:29:25 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 29 Oct 2006 19:29:25 +0100
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <17732.59464.767865.803543@basebud.nulle.part>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
	<17731.23422.758314.211918@basebud.nulle.part>
	<17731.47718.276693.860730@stat.math.ethz.ch>
	<17732.55008.463758.127507@basebud.nulle.part>
	<17732.59464.767865.803543@basebud.nulle.part>
Message-ID: <x2vem3m0vu.fsf@turmalin.kubism.ku.dk>

Dirk Eddelbuettel <edd at debian.org> writes:


> ... unless of course all those checkins went to trunk/ aka R-devel.

... which "svn -r 39733:BASE" on the branch would have told you:

$ svn log -r 39733:BASE
------------------------------------------------------------------------
r39734 | hornik | 2006-10-27 19:59:17 +0200 (Fri, 27 Oct 2006) | 1
line

Updated.
------------------------------------------------------------------------
r39735 | maechler | 2006-10-27 23:53:36 +0200 (Fri, 27 Oct 2006) | 1
line

belongs to r39726 (dotchart par tweak)
------------------------------------------------------------------------
r39741 | murdoch | 2006-10-29 17:23:55 +0100 (Sun, 29 Oct 2006) | 1
line

Port r39740 (Rconsole fixes) from trunk
------------------------------------------------------------------------

i.e. there is one from the 29th after the snapshot at ~1 AM and none
from the 28th.

 


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From edd at debian.org  Mon Oct 30 00:35:54 2006
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 29 Oct 2006 17:35:54 -0600
Subject: [Rd] sources of 2.4.0 patched
In-Reply-To: <x2vem3m0vu.fsf@turmalin.kubism.ku.dk>
References: <OF599FE263.0859234B-ON86257214.0066E214-86257214.0067FEAB@mmm.com>
	<x2wt6l8ksw.fsf@turmalin.kubism.ku.dk>
	<17731.23422.758314.211918@basebud.nulle.part>
	<17731.47718.276693.860730@stat.math.ethz.ch>
	<17732.55008.463758.127507@basebud.nulle.part>
	<17732.59464.767865.803543@basebud.nulle.part>
	<x2vem3m0vu.fsf@turmalin.kubism.ku.dk>
Message-ID: <17733.15066.908222.866691@basebud.nulle.part>


On 29 October 2006 at 19:29, Peter Dalgaard wrote:
| Dirk Eddelbuettel <edd at debian.org> writes:
| 
| 
| > ... unless of course all those checkins went to trunk/ aka R-devel.
| 
| ... which "svn -r 39733:BASE" on the branch would have told you:

At that point it "couldn't have" as I was quoting from the web-log as I wrote
(quoting from my email now)

| then happen to have been 2006-10-27?  Not according to the top of the svn log
| from http://developer.r-project.org/R.svnlog.2006: (and cut down to dates

I am now proud owner of (partial) svn checkrout (of 2.4-patched only) so I
take the hint with re the svn usage with nodding approval.

Thanks, Dirk


-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison



From hb at stat.berkeley.edu  Mon Oct 30 02:37:01 2006
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 30 Oct 2006 11:37:01 +1000
Subject: [Rd] Error: invalid multibyte string
In-Reply-To: <59d7961d0610271540m4ec81c8fv427daeda2b2b5470@mail.gmail.com>
References: <59d7961d0610251931i3d2a8a55x308bae32e5668236@mail.gmail.com>
	<Pine.LNX.4.64.0610260824520.9367@homer23.u.washington.edu>
	<x2hcxrrpry.fsf@turmalin.kubism.ku.dk>
	<59d7961d0610261838m3dea1a2eq24d5a8b84c2a1b82@mail.gmail.com>
	<Pine.LNX.4.64.0610270826140.27715@homer23.u.washington.edu>
	<59d7961d0610271540m4ec81c8fv427daeda2b2b5470@mail.gmail.com>
Message-ID: <59d7961d0610291737u7ba5f4c2x463904bf704b1bb3@mail.gmail.com>

On 10/28/06, Henrik Bengtsson <hb at stat.berkeley.edu> wrote:
> On 10/28/06, Thomas Lumley <tlumley at u.washington.edu> wrote:
> > On Fri, 27 Oct 2006, Henrik Bengtsson wrote:
> >
> > > In Section "Package subdirectories" in "Writing R Extensions" [2.4.0
> > > (2006-10-10)] it says:
> > >
> > > "Only ASCII characters (and the control characters tab, formfeed, LF
> > > and CR) should be used in code files. Other characters are accepted in
> > > comments, but then the comments may not be readable in e.g. a UTF-8
> > > locale. Non-ASCII characters in object names will normally [1] fail
> > > when the package is installed. Any byte will be allowed [2] in a
> > > quoted character string (but \uxxxx escapes should not be used), but
> > > non-ASCII character strings may not be usable in some locales and may
> > > display incorrectly in others.", where the footnote [2] reads "It is
> > > good practice to encode them as octal or hex escape sequences".
> > >
> > > (Note: ASCII refers (correctly) to the 7-bit ASCII [0-127] and none of
> > > the 8-bit ASCII extensions [128-255].)
> > >
> > > According to sentense about quoted strings, the following R/*.R code
> > > should still be valid:
> > >
> > >    pads <- sapply(0:64, FUN=function(x) paste(rep("\xFF", x), collapse=""));
> >
> > That looks like it should be valid (at least according to the
> > documentation), even though it won't run usefully on UTF-F locales.  What
> > you wrote before was:
> >
> > >> > On Thu, 26 Oct 2006, Henrik Bengtsson wrote:
> > >> >
> > >> > > I'm observing the following on different platforms:
> > >> > >
> > >> > >> parse(text='"\\x7F"')
> > >> > > expression("\177")
> > >> > >> parse(text='"\\x80"')
> > >> > > Error: invalid multibyte string
> >
> > and that error *is* correct behaviour -- you can't parse() something that
> > isn't a valid character string.
>
> Hmm... are you really sure?  That should be a (double) quoted \x80
> (four characters + quotes), which has been put in a (single) quoted
> string where backslash is escaped?
>
> Maybe it is more clear to write:
>
> > expr <- parse(text='x <- "\\x41"')
> > eval(expr)
> > print(x)
> [1] "A"
>
> and same for
>
> > expr <- parse(text='x <- "\\x7F"')
> > eval(expr)
> > print(x)
> > expr <- parse(text='x <- "\\x80"')
> > eval(expr)
> > print(x)
>
> (Unfortunately I can't access the machines that gives me the errors
> right now, but I assume the error occurs when eval() is called.)

The error occurs when print():ing, i.e.

> expr <- parse(text='x <- "\\x7F"')
> eval(expr)
> print(x)
[1] "\177"

> expr <- parse(text='x <- "\\x80"')
> eval(expr)
> print(x)
[1]Error: invalid multibyte string

/Henrik

>
> /H
>
> >
> >         -thomas
> >
>



From Bernhard_Pfaff at fra.invesco.com  Mon Oct 30 11:20:00 2006
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Mon, 30 Oct 2006 10:20:00 -0000
Subject: [Rd] Typo in help-file for 'regexp'
Message-ID: <E4A9111DA23BA048B9A46686BF727CF461BDDE@DEFRAXMB01.corp.amvescap.net>

Dear R-maintainer,

in the help-file for 'regexp' I detected the following word redundancy:


Is:
===
For basic and extended regular expressions the the collation order is
taken from the OS's ...
                                           ^^^^^^^
Should read:
============
For basic and extended regular expressions the collation order is taken
from the OS's ...


Best,
Bernhard
*****************************************************************
Confidentiality Note: The information contained in this mess...{{dropped}}



From murdoch at stats.uwo.ca  Mon Oct 30 12:53:30 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 30 Oct 2006 06:53:30 -0500
Subject: [Rd] Typo in help-file for 'regexp'
In-Reply-To: <E4A9111DA23BA048B9A46686BF727CF461BDDE@DEFRAXMB01.corp.amvescap.net>
References: <E4A9111DA23BA048B9A46686BF727CF461BDDE@DEFRAXMB01.corp.amvescap.net>
Message-ID: <4545E7BA.80009@stats.uwo.ca>

On 10/30/2006 5:20 AM, Pfaff, Bernhard Dr. wrote:
> Dear R-maintainer,
> 
> in the help-file for 'regexp' I detected the following word redundancy:
> 
> 
> Is:
> ===
> For basic and extended regular expressions the the collation order is
> taken from the OS's ...
>                                            ^^^^^^^
> Should read:
> ============
> For basic and extended regular expressions the collation order is taken
> from the OS's ...
> 

Thanks, I fixed that (and several other instances of the same typo).

Duncan Murdoch



From m.reuter at ucl.ac.uk  Mon Oct 30 13:31:01 2006
From: m.reuter at ucl.ac.uk (m.reuter at ucl.ac.uk)
Date: Mon, 30 Oct 2006 13:31:01 +0100 (CET)
Subject: [Rd] Compilation issue (PR#9275)
Message-ID: <20061030123101.176D8539E0@slim.kubism.ku.dk>

Hi,

I have encountered the same problem as the original poster, Andrew, 
even when matching C and fortran compiler versions. I have tried both 
gcc-3.3 with g77 (version 3.4.3) via
    ./configure CC=gcc-3.3
and gcc 4.0.0 with gfortran (version 4.0.2) via
    ./configure FC=gfortran
but both resulted in the same error
    Error in dyn.load(x, as.logical(local), as.logical(now)) :
            unable to load shared library 
'/R-2.4.0/library/tools/libs/tools.so':
      dlopen(/R-2.4.0/library/tools/libs/tools.so, 6): Symbol not found: _z_abs
      Referenced from: /R-2.4.0/lib/libRblas.dylib
      Expected in: flat namespace
    Execution halted

I don't want to claim this is a bug, but to point out that matching 
(major) versions of compilers does not cure the problem.

Best wishes, Max
-- 



___________________________________________________________
Max Reuter

Departement of Biology
University College London
The Galton Laboratory
4 Stephenson Way
London NW1 2HE, UK

Phone: +44-20-76795095			 Fax: +44-20-76795052



From simon.urbanek at r-project.org  Mon Oct 30 15:58:31 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 30 Oct 2006 09:58:31 -0500
Subject: [Rd] Compilation issue (PR#9275)
In-Reply-To: <20061030123101.176D8539E0@slim.kubism.ku.dk>
References: <20061030123101.176D8539E0@slim.kubism.ku.dk>
Message-ID: <B430A42E-1A0D-472E-8D1D-8C2EA9F7BD18@r-project.org>


On Oct 30, 2006, at 7:31 AM, m.reuter at ucl.ac.uk wrote:

> I have encountered the same problem as the original poster, Andrew,  
> even when matching C and fortran compiler versions. I have tried  
> both gcc-3.3 with g77 (version 3.4.3) via
>     ./configure CC=gcc-3.3
> and gcc 4.0.0 with gfortran (version 4.0.2) via
>     ./configure FC=gfortran
> but both resulted in the same error
>     Error in dyn.load(x, as.logical(local), as.logical(now)) :
>             unable to load shared library
> '/R-2.4.0/library/tools/libs/tools.so':
>       dlopen(/R-2.4.0/library/tools/libs/tools.so, 6): Symbol not  
> found: _z_abs
>       Referenced from: /R-2.4.0/lib/libRblas.dylib
>       Expected in: flat namespace
>     Execution halted
>
> I don't want to claim this is a bug, but to point out that matching  
> (major) versions of compilers does not cure the problem.
>

Max,

can you send me the detail about you setup, please? (most importantly  
OS X version and platform). Also quite helpful would be the last page  
of the confgure output.

The error above looks familiar from times when BLAS parameters had to  
be specified at configure time. Depending on your cctools, you may  
not be able to use the new system, so possibly you have to use  ./ 
configure  --with-blas='-framework vecLib' --with-lapack

Cheers,
Simon



From thomas.friedrichsmeier at ruhr-uni-bochum.de  Mon Oct 30 16:33:47 2006
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: Mon, 30 Oct 2006 16:33:47 +0100
Subject: [Rd] R GUI API: suggestion for R function to put in there?
Message-ID: <200610301633.51302.thomas.friedrichsmeier@ruhr-uni-bochum.de>

Hi Philippe!

Sorry to break the threading and formatting, I'm not subscribed to r-devel, 
hence just copying from the web archive.

Philippe Grosjean wrote:
>- To know if some R code is complete or is continued to the next line. 
> The following trick was suggested by Peter Dalgaard once, but it is 
> fragile because it depends on the way R prints errors, and that may 
> change in the future:

This is doable in C using R_ParseVector. If you would like to see details, of 
how this is done in RKWard, contact me via private mail.

One problem, however, we did not solve: Is there a way to get at syntax errors 
(if any) from C? parseError () is not exported.

> - To execute R code contained in a string and return the result of this 
> evaluation in a string (including presentation of error messages and 
> warnings) exactly as if this was entered at the prompt.

In RKWard we come close to this using R_ParseVector and some further tricks 
(not quite perfect, however), so again, contact me on this, if you like.
Still, having a more straight-forward way to evaluate a string just as like it 
had been entered on the console would be very nice to have.

> - In the same idea, to write a similar function, but that returns a list 
> of strings, each string being flagged as 'output', 'warning' or 'error'. 
> The succession should correspond to the evaluation (this is especially 
> tricky for warning messages, due to the complex way R handles those 
> warning message.

I very much second this. Note also that I would be nice to catch direct uses 
of REprintf () (which may not neccessarily be a warning or error, but may be 
elegible for special handling in the front-end; hence the suggestion by 
Hadley Wickham does not cover everything I'd like to see covered).
I once made a proposal on how to achieve some of this from C (last public 
message on this was 
https://stat.ethz.ch/pipermail/r-devel/2005-October/035144.html). Patch has 
since been improved 
(http://rkward.sourceforge.net/temp/r_writeerrconsole_v3_updated2.diff), but 
it seems, whenever I send it to Duncan, it happens to be a bad point of time 
for him to review it. Anybody else willing to test this on Windows / help me 
get this to an includable state?

> - To know which objects were changed since a given date, or during last 
> call. This should require a time flag on the variable that contains this 
> object. One particular application is an object explorer that could 
> update information quickly if it could query only those objects that 
> have changed since last process. This topic has already been discussed a 
> couple of times, and no convincing solution has emerged (technical 
> problems), it seems... but it is worth to continue thinking about it.

I've attacked this problem in RKWard very recently (not a full time flag, but 
at least catching all modifications). The approach we use since 0.4.0 is to
1) after each evaluation check for new / removed symbols in .GlobalEnv (not 
very elegant, but good enough)
2) move all symbols in .GlobalEnv to a dedicated environment, and 
in .GlobalEnv replace them with active bindings. Assignments to the symbols 
can now simply be detected via the active binding.
Once again, more details on request. Of course an easier solution would be 
very welcome, but it seems to work pretty well.

Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20061030/a1fb6dfc/attachment-0004.bin 

From jerry.allgood at veriquest.com  Mon Oct 30 19:08:57 2006
From: jerry.allgood at veriquest.com (jerry.allgood at veriquest.com)
Date: Mon, 30 Oct 2006 19:08:57 +0100 (CET)
Subject: [Rd] party package (PR#9324)
Message-ID: <20061030180857.0143B561F0@slim.kubism.ku.dk>

Full_Name: 
Version: 2.4.0
OS: XP
Submission from: (NULL) (206.180.154.109)


party package source download's PDFs (???_8?_??_cgraph.pdf) caused WinZip unzip
of .tar to abort. suggest repkg. :-) THANKS!



From murdoch at stats.uwo.ca  Mon Oct 30 19:17:17 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 30 Oct 2006 13:17:17 -0500
Subject: [Rd] party package (PR#9324)
In-Reply-To: <20061030180857.0143B561F0@slim.kubism.ku.dk>
References: <20061030180857.0143B561F0@slim.kubism.ku.dk>
Message-ID: <454641AD.4040402@stats.uwo.ca>

On 10/30/2006 1:08 PM, jerry.allgood at veriquest.com wrote:
> Full_Name: 
> Version: 2.4.0
> OS: XP
> Submission from: (NULL) (206.180.154.109)
> 
> 
> party package source download's PDFs (???_8?_??_cgraph.pdf) caused WinZip unzip
> of .tar to abort. suggest repkg. :-) THANKS!

This sounds like a Winzip bug to me.  I just tried

  tar zxvf ../party_0.9-5.tar.gz

and it unzipped with no error.  (If you want to use the source package, 
you should have tar.  If you only want the binary, you don't need the 
tar file, just download the .zip.)

Duncan Murdoch



From mgeorg at arl.wustl.edu  Mon Oct 30 20:06:54 2006
From: mgeorg at arl.wustl.edu (Manfred Georg)
Date: Mon, 30 Oct 2006 13:06:54 -0600 (CST)
Subject: [Rd] interactive flag unix
Message-ID: <Pine.LNX.4.63.0610301253180.12789@bang.arl.wustl.edu>

Hi,

I would like to see a way to force R to be in interactive mode
with a flag.  So that the default behavior of being in interactive
mode if the input is from a keybord can be overridden.

Something like:
R --interactive
R --no-interactive

octave has a flag like this and it words nicely for what I need
(input from named pipe).
Anyway, the fix is just a simple change to src/unix/system.c
I can write a patch if you would like.
I think something like this already exists in the windows wrapper (--ess).

Also, what is up with the bug tracker?  Things in there seem to
be from 2000-2003 and a couple days after filing a bug I still don't
see it.  Is it being used?  And if not, it should probably be disabled,
so people don't waste their time posting to the wrong place.

Manfred

##################################################################
"Must I do all the evil I can before I learn to shun it?  Is it
not enough to know the evil to shun it?  If not, we should be
sincere enough to admit that we love evil too well to give it up."
                                  - Mohandas K. Gandhi



From p.dalgaard at biostat.ku.dk  Mon Oct 30 21:42:30 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 30 Oct 2006 21:42:30 +0100
Subject: [Rd] interactive flag unix
In-Reply-To: <Pine.LNX.4.63.0610301253180.12789@bang.arl.wustl.edu>
References: <Pine.LNX.4.63.0610301253180.12789@bang.arl.wustl.edu>
Message-ID: <x23b95r0w9.fsf@turmalin.kubism.ku.dk>

Manfred Georg <mgeorg at arl.wustl.edu> writes:

> Also, what is up with the bug tracker?  Things in there seem to
> be from 2000-2003 and a couple days after filing a bug I still don't
> see it.  Is it being used?  And if not, it should probably be disabled,
> so people don't waste their time posting to the wrong place.

If it's not in incoming (or already filed), then there's a problem,
otherwise not. Things in there get sorted periodically, but that
requires manual intervention. All reports are echoed to the r-devel
list and any comments appended, but there's no guarantee that anyone
has anything to say...

Notice also that several categories span multiple pages, and that they
are sorted by increasing date. We don't throw reports away until we
are absolutely sure that they are outdated, so the first page of each
category can look rather old. (Perhaps we need an "old" category).

There are several things wrong with the bug tracker and we have
reasons to want to replace it at some point, but it is working and we
do use it.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From gregor.gorjanc at bfro.uni-lj.si  Mon Oct 30 21:47:49 2006
From: gregor.gorjanc at bfro.uni-lj.si (Gregor Gorjanc)
Date: Mon, 30 Oct 2006 21:47:49 +0100
Subject: [Rd] [R] read.fwf and header
In-Reply-To: <1162239329.4179.29.camel@localhost.localdomain>
References: <454649B5.70504@bfro.uni-lj.si>
	<1162239329.4179.29.camel@localhost.localdomain>
Message-ID: <454664F5.30907@bfro.uni-lj.si>

Marc Schwartz wrote:
> On Mon, 2006-10-30 at 19:51 +0100, Gregor Gorjanc wrote:
>> Hi!
>>
>> I have data (also in attached file) in the following form:
>>
>> num1 num2 num3 int1 fac1 fac2 cha1 cha2 Date POSIXt
>>  1                1   f q   1900-01-01 1900-01-01 01:01:01
>>  2 1.0 1316666.5  2 a g r z            1900-01-01 01:01:01
>>  3 1.5 1188830.5  3 b h s y 1900-01-01 1900-01-01 01:01:01
>>  4 2.0 1271846.3  4 c i t x 1900-01-01 1900-01-01 01:01:01
>>  5 2.5  829737.4    d j u w 1900-01-01
>>  6 3.0 1240967.3  5 e k v v 1900-01-01 1900-01-01 01:01:01
>>  7 3.5  919684.4  6 f l w u 1900-01-01 1900-01-01 01:01:01
>>  8 4.0  968214.6  7 g m x t 1900-01-01 1900-01-01 01:01:01
>>  9 4.5 1232076.4  8 h n y s 1900-01-01 1900-01-01 01:01:01
>> 10 5.0 1141273.4  9 i o z r 1900-01-01 1900-01-01 01:01:01
>>    5.5  988481.4 10 j     q 1900-01-01 1900-01-01 01:01:01
>>
>> This is a FWF (fixed width format) file. I can not use read.table here,
>> because of missing values. I have tried with the following
>>
>>> read.fwf(file="test.txt", widths=c(3, 4, 10, 3, 2, 2, 2, 2, 11, 20),
>> header=TRUE)
>>
>> Error in read.table(file = FILE, header = header, sep = sep, as.is =
>> as.is,  :
>> 	more columns than column names
>>
>> I could use:
>>
>>> read.fwf(file="test.txt", widths=c(3, 4, 10, 3, 2, 2, 2, 2, 11, 20),
>> header=FALSE, skip=1)
>>    V1  V2        V3 V4 V5 V6 V7 V8          V9                 V10
>> 1   1  NA        NA  1    f  q     1900-01-01  1900-01-01 01:01:01
>> 2   2 1.0 1316666.5  2 a  g  r  z              1900-01-01 01:01:01
>> 3   3 1.5 1188830.5  3 b  h  s  y  1900-01-01  1900-01-01 01:01:01
>> 4   4 2.0 1271846.3  4 c  i  t  x  1900-01-01  1900-01-01 01:01:01
>> 5   5 2.5  829737.4 NA d  j  u  w  1900-01-01
>> 6   6 3.0 1240967.3  5 e  k  v  v  1900-01-01  1900-01-01 01:01:01
>> 7   7 3.5  919684.4  6 f  l  w  u  1900-01-01  1900-01-01 01:01:01
>> 8   8 4.0  968214.6  7 g  m  x  t  1900-01-01  1900-01-01 01:01:01
>> 9   9 4.5 1232076.4  8 h  n  y  s  1900-01-01  1900-01-01 01:01:01
>> 10 10 5.0 1141273.4  9 i  o  z  r  1900-01-01  1900-01-01 01:01:01
>> 11 NA 5.5  988481.4 10 j        q  1900-01-01  1900-01-01 01:01:01
>>
>> Does anyone have a clue, how to get above result with header?
>>
>> Thanks!
> 
> The attachment did not come through. Perhaps it was too large?
> 
> Not sure if this is the most efficient way, but how about this:
> 
> DF <- read.fwf("test.txt", 
>                 widths=c(3, 4, 10, 3, 2, 2, 2, 2, 11, 20),
>                 skip = 1, strip.white = TRUE,
>                 col.names = read.table("test.txt", 
>                                        nrow = 1, as.is = TRUE)[1, ])
> 

Argh, my fault as I forgot to attach it :(

> Not sure if this is the most efficient way, but how about this:
>
> DF <- read.fwf("test.txt",
>                 widths=c(3, 4, 10, 3, 2, 2, 2, 2, 11, 20),
>                 skip = 1, strip.white = TRUE,
>                 col.names = read.table("test.txt",
>                                        nrow = 1, as.is = TRUE)[1, ])
>

That is a very nice compromise! No need for [1, ], due to nrow=1.

> Of course, with the limited number of columns, you can always just set
>
> colnames(DF) <- c("num1", "num2", "num3", "int1", "fac1",
>                   "fac2", "cha1", "cha2", "Date", "POSIXt")
>

I fully agree here, but I kind of lack this directly in read.fwf. I hope
that someone from R-core is also listening to this ;)

Thank you!

Gregor
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test.txt
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20061030/88560f7c/attachment-0004.txt 

From nali at umn.edu  Tue Oct 31 00:09:58 2006
From: nali at umn.edu (Na Li)
Date: Mon, 30 Oct 2006 17:09:58 -0600
Subject: [Rd] matrix/array types, extending R API?
Message-ID: <n4iri12yex.fsf@bass.biostat.umn.edu>


In writing R packages, I need some rudimentary support for matrix/array
in C code and I would also like to use Blas/Lapack functions.

Previously I just rolled out my own (simple) C++ classes.  But it
becomes troublesome for multiple packages (having duplicated files and
needing to keep them in sync, etc.)    

I found that the src/library/stats/src/mAR.c defined struct Array and
some utility functions, which would be useful.

Since I think some simple matrix support is widely needed, I wonder if
the core team would consider include this (or similar things, such as
the C++ classes in package Matrix, with more intuitive interface to
Blas/Lapack for 'casual' users) in R public API?

Thanks,

Michael



From dfolkins at temple.edu  Tue Oct 31 02:48:46 2006
From: dfolkins at temple.edu (dfolkins at temple.edu)
Date: Tue, 31 Oct 2006 02:48:46 +0100 (CET)
Subject: [Rd] about mantelhaen.test (PR#7779)
Message-ID: <20061031014846.E8D7E3F006@slim.kubism.ku.dk>

This is an OpenPGP/MIME signed message (RFC 2440 and 3156)
--------------enig5A700CC15DEABD01445A1B70
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

I have modified the code originally posted to include capability for
arbitrary weightings for the rows and columns (which apply in the
nominal-ordinal and the ordinal-ordinal cases). The code is pasted below
(as well as an example based on job satisfaction data).

However, I cannot figure out how to make the output of class "htest"
make nicely-formatted output. When I use the class htest, with a list of
df's, test statistics, etc, the printed output looks ugly. (See the last
few commented lines at the end of the function for my aborted attempt to
do this. To see what happens when that code is used, comment out the
last four uncommented lines (the ones that mention variable "result"),
and uncomment all the commented lines at the end.)

I am an R newbie by any standard, so if anyone could clue me in on how
to use htest in the case of multiple statistics and dfs, that would be
great.

Once we have that, does that mean that this can serve as a good
replacement for mantelhaen.test() in R?

Any comments appreciated!

code follows:
------
# takes a 3-d array x, scores for rows, and scores for columns
# runs nominal-nominal, ordinal-nominal, and ordinal-ordinal CMH tests
# this function is based on one posted at
# http://bugs.r-project.org/cgi-bin/R/wishlist?id=3D7779;user=3Dguest

mh.test <- function(x, row_scores=3DNULL, col_scores=3DNULL) {
    if (length(dim(x)) !=3D 3){
        stop("x must be a 3 dimensional array")
    }
    if (any(apply(x, 3, sum) < 2)){
        stop("sample size in each stratum must be > 1")
    }
    I <- dim(x)[1];    J <- dim(x)[2];    K <- dim(x)[3]
    if ( (length(row_scores) !=3D I & !is.null(row_scores) ) |
(length(col_scores) !=3D J & !is.null(col_scores)) ){
        stop("scores dimensions must equal to data dimensions")
    }
    if (is.null(row_scores)){
        row_scores =3D 1:I
    }
    if (is.null(col_scores)) {
        col_scores =3D 1:J
    }

    df_GMH <- (I - 1) * (J - 1);    df_SMH <- I - 1;    df_CSMH <- 1
    A_GMH <- cbind(diag(I-1), 0) %x% cbind(diag(J-1), 0)
    #A_SMH <- cbind(diag(I-1), 0) %x% t(1:J)
    A_SMH <- cbind(diag(I-1), 0) %x% t(col_scores)
    #A_CSMH <- t(1:I) %x% t(1:J)
    A_CSMH <- t(row_scores) %x% t(col_scores)
    Y_GMH <- matrix(0, nc =3D 1, nr =3D df_GMH)
    Y_SMH <- matrix(0, nc =3D 1, nr =3D df_SMH)
    Y_CSMH <- matrix(0, nc =3D 1, nr =3D df_CSMH)
    S_GMH <- matrix(0, nc =3D df_GMH, nr =3D df_GMH)
    S_SMH <- matrix(0, nc =3D df_SMH, nr =3D df_SMH)
    S_CSMH <- matrix(0, nc =3D df_CSMH, nr =3D df_CSMH)
    for(k in 1:K) {
        V <- NULL
        f <- x[, , k]
        ntot <- sum(f)
        p_ip <- apply(f, 1, sum) / ntot
        p_pj <- apply(f, 2, sum) / ntot
        m <- p_ip %x% p_pj * ntot
        V <- ntot^2 * ((diag(p_ip) - p_ip %*% t(p_ip)) %x% (diag(p_pj) -
p_pj %*% t(p_pj))) / (ntot-1)
        Y_GMH <- Y_GMH + A_GMH %*% (c(t(f)) - m)
        Y_SMH <- Y_SMH + A_SMH %*% (c(t(f)) - m)
        Y_CSMH <- Y_CSMH + A_CSMH %*% (c(t(f)) - m)
        S_GMH <- S_GMH + A_GMH %*% V %*% t(A_GMH)
        S_SMH <- S_SMH + A_SMH %*% V %*% t(A_SMH)
        S_CSMH <- S_CSMH + A_CSMH %*% V %*% t(A_CSMH)
    }
    Q_GMH <- t(Y_GMH) %*% solve(S_GMH) %*% Y_GMH
    Q_SMH <- t(Y_SMH) %*% solve(S_SMH) %*% Y_SMH
    Q_CSMH <- t(Y_CSMH) %*% solve(S_CSMH) %*% Y_CSMH
    STATISTIC <- c(Q_CSMH, Q_SMH, Q_GMH)
    PARAMETER <- c(df_CSMH, df_SMH, df_GMH)
    PVAL <- pchisq(STATISTIC, PARAMETER, lower =3D FALSE)
    result <- cbind(STATISTIC, PARAMETER, PVAL)
    rownames(result) <- list("Nonzero Correlation", "Row Mean Scores
Differ", "General Association")
    colnames(result) <- list("Statistic", "df", "p-value")
    return (result)
    #DNAME <- deparse(substitute(x))
    #METHOD =3D "Cochran-Mantel-Haenszel Statistics (Based on Table Score=
s)"
    #names(STATISTIC) =3D list("Nonzero Correlation", "Row Mean Scores
Differ", "General Association")
    #names(PARAMETER) =3D list("df", "df", "df")

    #structure(list(statistic =3D STATISTIC, parameter =3D PARAMETER,
p.value =3D PVAL, method =3D METHOD, data.name=3DDNAME), class =3D "power=
=2Ehtest")
        #data.name =3D DNAME, observed =3D x, expected =3D E, residuals =3D=
 (x -
E)/sqrt(E)), class =3D "htest")
}

--------test results:--------
> Satisfaction <-
+     as.table(array(c(1, 2, 0, 0, 3, 3, 1, 2,
+                       11, 17, 8, 4, 2, 3, 5, 2,
+                       1, 0, 0, 0, 1, 3, 0, 1,
+                       2, 5, 7, 9, 1, 1, 3, 6),
+                     dim =3D c(4, 4, 2),
+                     dimnames =3D
+                     list(Income =3D
+                          c("<5000", "5000-15000",
+                            "15000-25000", ">25000"),
+                          "JobSatisfaction" =3D
+                          c("V_D", "L_S", "M_S", "V_S"),
+                          Gender =3D c("Female", "Male"))))
> Satisfaction
, , Gender =3D Female
             JobSatisfaction
Income        V_D L_S M_S V_S
  <5000         1   3 11     2
  5000-15000    2   3 17     3
  15000-25000   0   1    8   5
  >25000        0   2    4   2
, , Gender =3D Male
             JobSatisfaction
Income        V_D L_S M_S V_S
  <5000         1   1    2   1
  5000-15000    0   3    5   1
  15000-25000   0   0    7   3
  >25000        0   1    9   6
> mh.test(Satisfaction, c(3,10,20,35), c(1,3,4,5))
                        Statistic df    p-value
Nonzero Correlation      6.156301 1 0.01309447
Row Mean Scores Differ 9.034222 3 0.02883933
General Association     10.200089 9 0.33453118


--------------enig5A700CC15DEABD01445A1B70
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFFRqs35/k4vslVlLIRAg/5AJ93AGEdIakk7T27coDij6jAdo7n6gCeNP/0
YoIcLAawlVvg4yILUXHJZM0=
=+GEH
-----END PGP SIGNATURE-----

--------------enig5A700CC15DEABD01445A1B70--



From rmjohnston at mac.com  Tue Oct 31 02:50:09 2006
From: rmjohnston at mac.com (rmjohnston at mac.com)
Date: Tue, 31 Oct 2006 02:50:09 +0100 (CET)
Subject: [Rd] Confidence interval calculation in prop.test (PR#9325)
Message-ID: <20061031015009.7A7903F006@slim.kubism.ku.dk>

Full_Name: Richard Johnston
Version: 2.4.0
OS: OS X
Submission from: (NULL) (69.169.0.241)


The confidence interval calculation for prop.test appears incorrect when
alternative="greater" .  The upper limit is always set to 1.0000.  The lower
limit appears to be correct.

> total=c(250,250)
> success=c(55,31)
> prop.test(success,total,alternative="greater",correct=TRUE)

	2-sample test for equality of proportions with continuity correction

data:  success out of total 
X-squared = 7.4289, df = 1, p-value = 0.003209
alternative hypothesis: greater 
95 percent confidence interval:
 0.03693065 1.00000000 
sample estimates:
prop 1 prop 2 
 0.220  0.124



From murdoch at stats.uwo.ca  Tue Oct 31 03:20:14 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 30 Oct 2006 21:20:14 -0500
Subject: [Rd] Confidence interval calculation in prop.test (PR#9325)
In-Reply-To: <20061031015009.7A7903F006@slim.kubism.ku.dk>
References: <20061031015009.7A7903F006@slim.kubism.ku.dk>
Message-ID: <4546B2DE.7010002@stats.uwo.ca>

On 10/30/2006 8:50 PM, rmjohnston at mac.com wrote:
> Full_Name: Richard Johnston
> Version: 2.4.0
> OS: OS X
> Submission from: (NULL) (69.169.0.241)
> 
> 
> The confidence interval calculation for prop.test appears incorrect when
> alternative="greater" .  The upper limit is always set to 1.0000.  The lower
> limit appears to be correct.

That looks like a one-sided confidence interval, i.e. an interval of the 
type Delta > 0.0369, where Delta is the difference in proportions.  It 
is then clipped to [-1, 1], since that's the largest possible range for 
the difference.

What were you expecting to see?

Duncan Murdoch


> 
>> total=c(250,250)
>> success=c(55,31)
>> prop.test(success,total,alternative="greater",correct=TRUE)
> 
> 	2-sample test for equality of proportions with continuity correction
> 
> data:  success out of total 
> X-squared = 7.4289, df = 1, p-value = 0.003209
> alternative hypothesis: greater 
> 95 percent confidence interval:
>  0.03693065 1.00000000 
> sample estimates:
> prop 1 prop 2 
>  0.220  0.124
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



From p.c.j.kleiweg at rug.nl  Tue Oct 31 11:47:23 2006
From: p.c.j.kleiweg at rug.nl (p.c.j.kleiweg at rug.nl)
Date: Tue, 31 Oct 2006 11:47:23 +0100 (CET)
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
Message-ID: <20061031104723.0E81FAC02@slim.kubism.ku.dk>


'make check' fails on d-p-q-r-tests:

> ##-- non central Chi^2 :
> xB <- c(2000,1e6,1e50,Inf)
> for(df in c(0.1, 1, 10))
+     for(ncp in c(0, 1, 10, 100)) stopifnot(pchisq(xB, df=df, ncp=ncp) == 1)
Error: pchisq(xB, df = df, ncp = ncp) == 1 is not all TRUE
Execution halted


Here is some more testing:

xB <- c(2000,1e6,1e50,Inf)
for(df in c(0.1, 1, 10)) for(ncp in c(0, 1, 10, 100)) { print(pchisq(xB, df=df, ncp=ncp)); print(pchisq(xB, df=df, ncp=ncp) == 1) }
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] FALSE FALSE FALSE  TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] FALSE FALSE FALSE  TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] FALSE FALSE FALSE  TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE

options(digits=22)
for(df in c(0.1, 1, 10)) for(ncp in c(0, 1, 10, 100)) { print(pchisq(xB, df=df, ncp=ncp)); print(pchisq(xB, df=df, ncp=ncp) == 1) }
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 0.9999999999999998889777 0.9999999999999998889777 0.9999999999999998889777 1.0000000000000000000000
[1] FALSE FALSE FALSE  TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 0.9999999999999998889777 0.9999999999999998889777 0.9999999999999998889777 1.0000000000000000000000
[1] FALSE FALSE FALSE  TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE
[1] 0.9999999999999998889777 0.9999999999999998889777 0.9999999999999998889777 1.0000000000000000000000
[1] FALSE FALSE FALSE  TRUE
[1] 1 1 1 1
[1] TRUE TRUE TRUE TRUE



--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 4.0
 year = 2006
 month = 10
 day = 03
 svn rev = 39566
 language = R
 version.string = R version 2.4.0 (2006-10-03)

Locale:
LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:methods, package:stats, package:utils, package:datasets, package:graphics, package:grDevices, Autoloads, package:base



From p.c.j.kleiweg at rug.nl  Tue Oct 31 11:54:09 2006
From: p.c.j.kleiweg at rug.nl (p.c.j.kleiweg at rug.nl)
Date: Tue, 31 Oct 2006 11:54:09 +0100 (CET)
Subject: [Rd] malformed manual page with 'man R' (PR#9327)
Message-ID: <20061031105409.EF764561C8@slim.kubism.ku.dk>


I get a malformed manual page with 'man R':


WARNING:(1)                    FSF                    WARNING:(1)

NAME
       WARNING: - a language for data analysis and graphics

SYNOPSIS
       R [options] [< infile] [> outfile]
       R CMD command [arguments]

DESCRIPTION
       WARNING: ignoring environment value of R_HOME

       Start  R, a system for statistical computation and graphics, with the specified options, or invoke an
       R tool via the 'R CMD' interface.

(more deleted)


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 4.0
 year = 2006
 month = 10
 day = 03
 svn rev = 39566
 language = R
 version.string = R version 2.4.0 (2006-10-03)

Locale:
LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:methods, package:stats, package:utils, package:datasets, package:graphics, package:grDevices, Autoloads, package:base



From p.dalgaard at biostat.ku.dk  Tue Oct 31 12:05:21 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 31 Oct 2006 12:05:21 +0100
Subject: [Rd] lme4 install,
	was Re: [R] Which executable is associated with R CMD INSTALL?
In-Reply-To: <20061031091759.GB3676@ihug.co.nz>
References: <20061030193251.GA3676@ihug.co.nz> <4546725A.7000905@stats.uwo.ca>
	<20061031091759.GB3676@ihug.co.nz>
Message-ID: <x24ptkyccu.fsf_-_@viggo.kubism.ku.dk>


[move to r-devel, put maintainer in loop]

Patrick Connolly <p_connolly at ihug.co.nz> writes:

> On Mon, 30-Oct-2006 at 04:44PM -0500, Duncan Murdoch wrote:
> 
>  
> |> Try "R CMD printenv R_HOME" and you'll find which R home directory it is 
> |> using.  You can see a lot more with "R CMD printenv" or various options 
> |> to "R CMD config".
> 
> Thanks for that information.  It knocks my theory on the head.  Pity
> that, because I might have been able to do something about it if that
> was the problem.  Now I'm at a loss to work out why lme4 installation
> cannot find Matrix, and more strangely, why nothing else gave a
> similar problem.  I think I've tried every version of lme4 and Matrix
> that has emerged since R-2.4.0 has been released.
> 
> The fact that no other Red hat user has a problem indicates the
> problem is this end; but I'm short of ideas about where to look.
> Looks like it's back to versions 6 months old -- like proprietary
> software users have to put up with. :-(

Hmmm, I can provoke this on SUSE too (I was going to ask you to try
this!):

mkdir foo
MY_R=~/misc/r-release-branch/BUILD/bin/R
R_LIBS=foo $MY_R --vanilla << EOF
 options(repos=c(CRAN="http://cran.dk.r-project.org"))
 install.packages("lme4", depend=TRUE)
EOF

This installs Matrix alright, then dies with

Warning in install.packages("lme4", depend = TRUE) :
         argument 'lib' is missing: using foo
trying URL 'http://cran.dk.r-project.org/src/contrib/lme4_0.9975-8.tar.gz'
Content type 'application/x-tar' length 235617 bytes
opened URL
==================================================
downloaded 230Kb

* Installing *source* package 'lme4' ...
** libs

gcc -I/usr/local/src/pd/r-release-branch/BUILD/include
  -I/usr/local/src/pd/r-release-branch/BUILD/include
  -I/usr/local/include -fpic -g -O2 -std=gnu99 -c Wishart.c -o Wishart.o

In file included from Wishart.h:4,
                 from Wishart.c:1:
lme4_utils.h:9:20: Matrix.h: No such file or directory
In file included from Wishart.h:4,
                 from Wishart.c:1:
lme4_utils.h:25: error: syntax error before "c"
lme4_utils.h:25: warning: type defaults to `int' in declaration of `c'
lme4_utils.h:25: warning: data definition has no type or storage class
lme4_utils.h:163: error: syntax error before "cholmod_factor"
lme4_utils.h:177: error: syntax error before "cholmod_factor"
make: *** [Wishart.o] Error 1
ERROR: compilation failed for package 'lme4'

And Matrix.h is sitting happily in foo/Matrix/include/ but obviously
not getting included. Should there have been a copy inside lme4?

What is not obvious to me is how this can work anywhere...

I also tried unpacking the lme4 directory from its tarball, dropping
all files from the Matrix installed include dir into lme4/src and then

$MY_R CMD INSTALL -l foo lme4

but no go

gcc -shared -L/usr/local/lib64 -o lme4.so Matrix_stubs.o Wishart.o
glmer.o init.o lme4_utils.o lmer.o local_stubs.o pedigree.o
-L/usr/local/src/pd/r-release-branch/BUILD/lib -lRlapack
-L/usr/local/src/pd/r-release-branch/BUILD/lib -lRblas -lg2c -lm
-lgcc_s

local_stubs.o(.text+0x0): In function `M_numeric_as_chm_dense':
/home/bs/pd/tmp/lme4/src/Matrix_stubs.c:420: multiple definition of `M_numeric_as_chm_dense'
Matrix_stubs.o(.text+0x0):/home/bs/pd/tmp/lme4/src/Matrix_stubs.c:420: first defined here

local_stubs.o(.text+0x70): In function `M_dpoMatrix_chol':
/home/bs/pd/tmp/lme4/src/Matrix_stubs.c:412: multiple definition of `M_dpoMatrix_chol'
Matrix_stubs.o(.text+0x70):/home/bs/pd/tmp/lme4/src/Matrix_stubs.c:412: first defined here
..etc..

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.dalgaard at biostat.ku.dk  Tue Oct 31 12:15:23 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 31 Oct 2006 12:15:23 +0100
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
In-Reply-To: <20061031104723.0E81FAC02@slim.kubism.ku.dk>
References: <20061031104723.0E81FAC02@slim.kubism.ku.dk>
Message-ID: <x2zmbcwxbo.fsf@viggo.kubism.ku.dk>

p.c.j.kleiweg at rug.nl writes:

> 'make check' fails on d-p-q-r-tests:
...
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = 
>  major = 2
>  minor = 4.0
>  year = 2006
>  month = 10
>  day = 03
>  svn rev = 39566
>  language = R
>  version.string = R version 2.4.0 (2006-10-03)
> 
> Locale:
> LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C


You need to be more specific (yes, it is unfortunate that we cannot
extract all details about Linuxen from the Version: listing). Which
distribution, did you compile youself or use a binary, and if the
former: did you set any special compiler flags?

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.dalgaard at biostat.ku.dk  Tue Oct 31 13:20:28 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 31 Oct 2006 13:20:28 +0100
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
In-Reply-To: <Pine.LNX.4.63.0610311225350.1131@kleigh.nl>
References: <20061031104723.0E81FAC02@slim.kubism.ku.dk>
	<x2zmbcwxbo.fsf@viggo.kubism.ku.dk>
	<Pine.LNX.4.63.0610311225350.1131@kleigh.nl>
Message-ID: <x2vem0wub7.fsf@viggo.kubism.ku.dk>

Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:

> Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
> 
> > p.c.j.kleiweg at rug.nl writes:
> > 
> > > 'make check' fails on d-p-q-r-tests:
> > ...
> > > --please do not edit the information below--
> > > 
> > > Version:
> > >  platform = i686-pc-linux-gnu
> > >  arch = i686
> > >  os = linux-gnu
> > >  system = i686, linux-gnu
> > >  status = 
> > >  major = 2
> > >  minor = 4.0
> > >  year = 2006
> > >  month = 10
> > >  day = 03
> > >  svn rev = 39566
> > >  language = R
> > >  version.string = R version 2.4.0 (2006-10-03)
> > > 
> > > Locale:
> > > LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C
> > 
> > 
> > You need to be more specific (yes, it is unfortunate that we cannot
> > extract all details about Linuxen from the Version: listing). Which
> > distribution, did you compile youself or use a binary, and if the
> > former: did you set any special compiler flags?
> 
> config.log:

11000 lines or so deleted, and you still didn't answer the questions....

(well, I can tell that it is SUSE, and it must be an old version since
you are using the ancient 2.95.3 compilers...)

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.dalgaard at biostat.ku.dk  Tue Oct 31 13:20:43 2006
From: p.dalgaard at biostat.ku.dk (p.dalgaard at biostat.ku.dk)
Date: Tue, 31 Oct 2006 13:20:43 +0100 (CET)
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
Message-ID: <20061031122043.1DFC35623D@slim.kubism.ku.dk>

Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:

> Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
>=20
> > p.c.j.kleiweg at rug.nl writes:
> >=20
> > > 'make check' fails on d-p-q-r-tests:
> > ...
> > > --please do not edit the information below--
> > >=20
> > > Version:
> > >  platform =3D i686-pc-linux-gnu
> > >  arch =3D i686
> > >  os =3D linux-gnu
> > >  system =3D i686, linux-gnu
> > >  status =3D=20
> > >  major =3D 2
> > >  minor =3D 4.0
> > >  year =3D 2006
> > >  month =3D 10
> > >  day =3D 03
> > >  svn rev =3D 39566
> > >  language =3D R
> > >  version.string =3D R version 2.4.0 (2006-10-03)
> > >=20
> > > Locale:
> > > LC_CTYPE=3Dnl_NL at euro;LC_NUMERIC=3DC;LC_TIME=3Dnl_NL at euro;LC_COLLATE=
=3DC;LC_MONETARY=3Dnl_NL at euro;LC_MESSAGES=3Dnl_NL at euro;LC_PAPER=3Dnl_NL at eur=
o;LC_NAME=3DC;LC_ADDRESS=3DC;LC_TELEPHONE=3DC;LC_MEASUREMENT=3Dnl_NL at euro;L=
C_IDENTIFICATION=3DC
> >=20
> >=20
> > You need to be more specific (yes, it is unfortunate that we cannot
> > extract all details about Linuxen from the Version: listing). Which
> > distribution, did you compile youself or use a binary, and if the
> > former: did you set any special compiler flags?
>=20
> config.log:

11000 lines or so deleted, and you still didn't answer the questions....

(well, I can tell that it is SUSE, and it must be an old version since
you are using the ancient 2.95.3 compilers...)

--=20
   O__  ---- Peter Dalgaard             =C3=98ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.c.j.kleiweg at rug.nl  Tue Oct 31 13:36:59 2006
From: p.c.j.kleiweg at rug.nl (Peter Kleiweg)
Date: Tue, 31 Oct 2006 13:36:59 +0100 (CET)
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
In-Reply-To: <x2vem0wub7.fsf@viggo.kubism.ku.dk>
References: <20061031104723.0E81FAC02@slim.kubism.ku.dk>
	<x2zmbcwxbo.fsf@viggo.kubism.ku.dk>
	<Pine.LNX.4.63.0610311225350.1131@kleigh.nl>
	<x2vem0wub7.fsf@viggo.kubism.ku.dk>
Message-ID: <Pine.LNX.4.63.0610311328250.1131@kleigh.nl>

Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:

> Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:
> 
> > Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
> > 
> > > p.c.j.kleiweg at rug.nl writes:
> > > 
> > > > 'make check' fails on d-p-q-r-tests:
> > > ...
> > > > --please do not edit the information below--
> > > > 
> > > > Version:
> > > >  platform = i686-pc-linux-gnu
> > > >  arch = i686
> > > >  os = linux-gnu
> > > >  system = i686, linux-gnu
> > > >  status = 
> > > >  major = 2
> > > >  minor = 4.0
> > > >  year = 2006
> > > >  month = 10
> > > >  day = 03
> > > >  svn rev = 39566
> > > >  language = R
> > > >  version.string = R version 2.4.0 (2006-10-03)
> > > > 
> > > > Locale:
> > > > LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C
> > > 
> > > 
> > > You need to be more specific (yes, it is unfortunate that we cannot
> > > extract all details about Linuxen from the Version: listing). Which
> > > distribution, did you compile youself or use a binary, and if the
> > > former: did you set any special compiler flags?
> > 
> > config.log:
> 
> 11000 lines or so deleted, and you still didn't answer the questions....
>
> (well, I can tell that it is SUSE, and it must be an old version since
> you are using the ancient 2.95.3 compilers...)

Let me see...

> Which distribution

SuSE. It's right there in config.log.
And there is nothing ancient about 2.95.3 compilers. 

> did you compile youself or use a binary

I sent you config.log. That should give you a clue. 

> did you set any special compiler flags?

Did you read the first few lines of config.log?


Any questions I missed?

-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/



From p.dalgaard at biostat.ku.dk  Tue Oct 31 14:01:17 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 31 Oct 2006 14:01:17 +0100
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
In-Reply-To: <Pine.LNX.4.63.0610311328250.1131@kleigh.nl>
References: <20061031104723.0E81FAC02@slim.kubism.ku.dk>
	<x2zmbcwxbo.fsf@viggo.kubism.ku.dk>
	<Pine.LNX.4.63.0610311225350.1131@kleigh.nl>
	<x2vem0wub7.fsf@viggo.kubism.ku.dk>
	<Pine.LNX.4.63.0610311328250.1131@kleigh.nl>
Message-ID: <x2r6wowsf6.fsf@viggo.kubism.ku.dk>

Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:

> Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
> 
> > Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:
> > 
> > > Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
> > > 
> > > > p.c.j.kleiweg at rug.nl writes:
> > > > 
> > > > > 'make check' fails on d-p-q-r-tests:
> > > > ...
> > > > > --please do not edit the information below--
> > > > > 
> > > > > Version:
> > > > >  platform = i686-pc-linux-gnu
> > > > >  arch = i686
> > > > >  os = linux-gnu
> > > > >  system = i686, linux-gnu
> > > > >  status = 
> > > > >  major = 2
> > > > >  minor = 4.0
> > > > >  year = 2006
> > > > >  month = 10
> > > > >  day = 03
> > > > >  svn rev = 39566
> > > > >  language = R
> > > > >  version.string = R version 2.4.0 (2006-10-03)
> > > > > 
> > > > > Locale:
> > > > > LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C
> > > > 
> > > > 
> > > > You need to be more specific (yes, it is unfortunate that we cannot
> > > > extract all details about Linuxen from the Version: listing). Which
> > > > distribution, did you compile youself or use a binary, and if the
> > > > former: did you set any special compiler flags?
> > > 
> > > config.log:
> > 
> > 11000 lines or so deleted, and you still didn't answer the questions....
> >
> > (well, I can tell that it is SUSE, and it must be an old version since
> > you are using the ancient 2.95.3 compilers...)
> 
> Let me see...
> 
> > Which distribution
> 
> SuSE. It's right there in config.log.
> And there is nothing ancient about 2.95.3 compilers. 
> 
> > did you compile youself or use a binary
> 
> I sent you config.log. That should give you a clue. 
> 
> > did you set any special compiler flags?
> 
> Did you read the first few lines of config.log?
> 
> 
> Any questions I missed?

Why should we care? It's your problem and your job to make it easier
for maintainers to track down problems. Copying config.log to a public
mailing list could be considered thoughtless, the above is plainly
insulting. 

Maybe someone else will help you, but I have definitely lost all
interest. For your information, the problem does not occur in SUSE 9.3
and 10.0.


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.dalgaard at biostat.ku.dk  Tue Oct 31 14:01:35 2006
From: p.dalgaard at biostat.ku.dk (p.dalgaard at biostat.ku.dk)
Date: Tue, 31 Oct 2006 14:01:35 +0100 (CET)
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
Message-ID: <20061031130135.CB65B561BC@slim.kubism.ku.dk>

Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:

> Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
>=20
> > Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:
> >=20
> > > Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 20=
06:
> > >=20
> > > > p.c.j.kleiweg at rug.nl writes:
> > > >=20
> > > > > 'make check' fails on d-p-q-r-tests:
> > > > ...
> > > > > --please do not edit the information below--
> > > > >=20
> > > > > Version:
> > > > >  platform =3D i686-pc-linux-gnu
> > > > >  arch =3D i686
> > > > >  os =3D linux-gnu
> > > > >  system =3D i686, linux-gnu
> > > > >  status =3D=20
> > > > >  major =3D 2
> > > > >  minor =3D 4.0
> > > > >  year =3D 2006
> > > > >  month =3D 10
> > > > >  day =3D 03
> > > > >  svn rev =3D 39566
> > > > >  language =3D R
> > > > >  version.string =3D R version 2.4.0 (2006-10-03)
> > > > >=20
> > > > > Locale:
> > > > > LC_CTYPE=3Dnl_NL at euro;LC_NUMERIC=3DC;LC_TIME=3Dnl_NL at euro;LC_COLL=
ATE=3DC;LC_MONETARY=3Dnl_NL at euro;LC_MESSAGES=3Dnl_NL at euro;LC_PAPER=3Dnl_NL@=
euro;LC_NAME=3DC;LC_ADDRESS=3DC;LC_TELEPHONE=3DC;LC_MEASUREMENT=3Dnl_NL at eur=
o;LC_IDENTIFICATION=3DC
> > > >=20
> > > >=20
> > > > You need to be more specific (yes, it is unfortunate that we cannot
> > > > extract all details about Linuxen from the Version: listing). Which
> > > > distribution, did you compile youself or use a binary, and if the
> > > > former: did you set any special compiler flags?
> > >=20
> > > config.log:
> >=20
> > 11000 lines or so deleted, and you still didn't answer the questions....
> >
> > (well, I can tell that it is SUSE, and it must be an old version since
> > you are using the ancient 2.95.3 compilers...)
>=20
> Let me see...
>=20
> > Which distribution
>=20
> SuSE. It's right there in config.log.
> And there is nothing ancient about 2.95.3 compilers.=20
>=20
> > did you compile youself or use a binary
>=20
> I sent you config.log. That should give you a clue.=20
>=20
> > did you set any special compiler flags?
>=20
> Did you read the first few lines of config.log?
>=20
>=20
> Any questions I missed?

Why should we care? It's your problem and your job to make it easier
for maintainers to track down problems. Copying config.log to a public
mailing list could be considered thoughtless, the above is plainly
insulting.=20

Maybe someone else will help you, but I have definitely lost all
interest. For your information, the problem does not occur in SUSE 9.3
and 10.0.


--=20
   O__  ---- Peter Dalgaard             =C3=98ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From p.c.j.kleiweg at rug.nl  Tue Oct 31 14:16:58 2006
From: p.c.j.kleiweg at rug.nl (Peter Kleiweg)
Date: Tue, 31 Oct 2006 14:16:58 +0100 (CET)
Subject: [Rd] 'make check' fails on d-p-q-r-tests (PR#9326)
In-Reply-To: <x2r6wowsf6.fsf@viggo.kubism.ku.dk>
References: <20061031104723.0E81FAC02@slim.kubism.ku.dk>
	<x2zmbcwxbo.fsf@viggo.kubism.ku.dk>
	<Pine.LNX.4.63.0610311225350.1131@kleigh.nl>
	<x2vem0wub7.fsf@viggo.kubism.ku.dk>
	<Pine.LNX.4.63.0610311328250.1131@kleigh.nl>
	<x2r6wowsf6.fsf@viggo.kubism.ku.dk>
Message-ID: <Pine.LNX.4.63.0610311403400.1131@kleigh.nl>

Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:

> Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:
> 
> > Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
> > 
> > > Peter Kleiweg <p.c.j.kleiweg at rug.nl> writes:
> > > 
> > > > Peter Dalgaard schreef op de 31e dag van de wijnmaand van het jaar 2006:
> > > > 
> > > > > p.c.j.kleiweg at rug.nl writes:
> > > > > 
> > > > > > 'make check' fails on d-p-q-r-tests:
> > > > > ...
> > > > > > --please do not edit the information below--
> > > > > > 
> > > > > > Version:
> > > > > >  platform = i686-pc-linux-gnu
> > > > > >  arch = i686
> > > > > >  os = linux-gnu
> > > > > >  system = i686, linux-gnu
> > > > > >  status = 
> > > > > >  major = 2
> > > > > >  minor = 4.0
> > > > > >  year = 2006
> > > > > >  month = 10
> > > > > >  day = 03
> > > > > >  svn rev = 39566
> > > > > >  language = R
> > > > > >  version.string = R version 2.4.0 (2006-10-03)
> > > > > > 
> > > > > > Locale:
> > > > > > LC_CTYPE=nl_NL at euro;LC_NUMERIC=C;LC_TIME=nl_NL at euro;LC_COLLATE=C;LC_MONETARY=nl_NL at euro;LC_MESSAGES=nl_NL at euro;LC_PAPER=nl_NL at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=nl_NL at euro;LC_IDENTIFICATION=C
> > > > > 
> > > > > 
> > > > > You need to be more specific (yes, it is unfortunate that we cannot
> > > > > extract all details about Linuxen from the Version: listing). Which
> > > > > distribution, did you compile youself or use a binary, and if the
> > > > > former: did you set any special compiler flags?
> > > > 
> > > > config.log:
> > > 
> > > 11000 lines or so deleted, and you still didn't answer the questions....
> > >
> > > (well, I can tell that it is SUSE, and it must be an old version since
> > > you are using the ancient 2.95.3 compilers...)
> > 
> > Let me see...
> > 
> > > Which distribution
> > 
> > SuSE. It's right there in config.log.
> > And there is nothing ancient about 2.95.3 compilers. 
> > 
> > > did you compile youself or use a binary
> > 
> > I sent you config.log. That should give you a clue. 
> > 
> > > did you set any special compiler flags?
> > 
> > Did you read the first few lines of config.log?
> > 
> > 
> > Any questions I missed?
> 
> Why should we care? It's your problem and your job to make it easier
> for maintainers to track down problems. Copying config.log to a public
> mailing list could be considered thoughtless, the above is plainly
> insulting. 

My problem? It is YOUR software. I guess it is your job not to 
give a fuck when people take the trouble of pointing out bugs.

> Maybe someone else will help you, but I have definitely lost all
> interest. For your information, the problem does not occur in SUSE 9.3
> and 10.0.

I am not the one in need of help. 


-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/



From michael.hoehle at gmail.com  Tue Oct 31 14:38:53 2006
From: michael.hoehle at gmail.com (Michael Hoehle)
Date: Tue, 31 Oct 2006 14:38:53 +0100
Subject: [Rd] Syntax Error in Rcmd check on Windows
Message-ID: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>

Dear R-developers,

I am currently developing an R package called RLadyBug. When
developing under Linux "R CMD check ." works fine without a warning.
However, when I do "Rcmd check ." under Windows (version 2.4.0 and
earlier)  I get a ?syntax error" when checking the examples.

This puzzles me somewhat, because a manual source("RLadyBug-Ex.R") on
Windows works fine. On the other hand, a "Rterm.exe --no-save <
RLadyBug-Ex.R" in a command shell under Windows reproduces the error.
My first guess was that the very long line was causing the problem,
but when I open RLadyBug-Ex.R in Emacs, change the coding system from
"undecided-dos" to "undecided-unix" and save the file "Rterm.exe
--no-save < RLadyBug-Ex.R" works fine....

Does anybody has an idea what is causing the error and how to fix this?

Best regards,

Michael H?hle

--

---
* checking for working latex ... OK
* using log directory 'z:/Transmission/RLadyBug/..Rcheck'
* using R version 2.4.0 (2006-10-03)
* checking for file './DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'RLadyBug' version '0.4-1'
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking whether package 'RLadyBug' can be installed ... OK
* checking package directory ... OK
* checking for portable file names ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for syntax errors ... OK
* checking R files for non-ASCII characters ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the name space can be loaded with stated dependencies ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* creating RLadyBug-Ex.R ... OK
* checking examples ... ERROR
Running examples in 'RLadyBug-Ex.R' failed.
The error most likely occurred in:

> ### * LBExperiment-class
>
> flush(stderr()); flush(stdout())
>
> ### Name: LBExperiment-class
> ### Title: Class "LBExperiment"
> ### Aliases: LBExperiment-class show,LBExperiment-method
> ###   plot,LBExperiment-method plot,LBExperiment,missing-method
> ###   summary,LBExperiment-method data2events,LBExperiment-method
> ###   data2events
> ### Keywords: classes
>
> ### ** Examples
>
> sim.layout <- new( "LBLayout", S0=matrix( c( 13, rep( 14, 7 ) ), ncol=4 ),
+                   E0=matrix( c(  1, rep(  0, 7 ) ), ncol=4 ) )
> sim.opts <- new( "LBOptions", seed=2006,
+                             LBmodel=c( "gamma", "gamma", "gamma", FALSE ),
+                             ignoreData=c( FALSE, FALSE, FALSE ),
+                             initBeta =list( init=0.125,
+                                         gamma=0.001, delta=0.001 ),
+                             initBetaN=list( init=0.018,
+                                         gamma=0.001, delta=0.001 ),
+                             initIncu=list( asis=FALSE, const=FALSE,
+                                     g=6.697, g.gamma=0.001, g.delta=0.001,
+                                     d=0.84, d.gamma=0.001,d.delta=0.001 ),
+                             initInf=list( 1.772, 0.001, 0.001,
0.123, 0.001, 0.001 ),
+                             initDia=list( 149.126, 0.001, 0.001,
+                                     8.737, 0.001, 0.001 ) )
Error: syntax error in:
"a=list( 149.126, 0.001, 0.001,
"                                   8.737, 0.001, 0.001 ) )
Execution halted



From murdoch at stats.uwo.ca  Tue Oct 31 14:54:56 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 31 Oct 2006 08:54:56 -0500
Subject: [Rd] Syntax Error in Rcmd check on Windows
In-Reply-To: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
References: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
Message-ID: <454755B0.4050606@stats.uwo.ca>

On 10/31/2006 8:38 AM, Michael Hoehle wrote:
> Dear R-developers,
> 
> I am currently developing an R package called RLadyBug. When
> developing under Linux "R CMD check ." works fine without a warning.
> However, when I do "Rcmd check ." under Windows (version 2.4.0 and
> earlier)  I get a ?syntax error" when checking the examples.
> 
> This puzzles me somewhat, because a manual source("RLadyBug-Ex.R") on
> Windows works fine. On the other hand, a "Rterm.exe --no-save <
> RLadyBug-Ex.R" in a command shell under Windows reproduces the error.
> My first guess was that the very long line was causing the problem,
> but when I open RLadyBug-Ex.R in Emacs, change the coding system from
> "undecided-dos" to "undecided-unix" and save the file "Rterm.exe
> --no-save < RLadyBug-Ex.R" works fine....
> 
> Does anybody has an idea what is causing the error and how to fix this?

No. Could you send me the RLadyBug-Ex.R file?  I'd like to get an exact 
copy of what you have, so please put it in a .zip or other archive.  If 
you use .zip, you'll need to rename it when mailing (or just put it on a 
web page somewhere), because our mail server doesn't accept emailed .zip 
files.

Duncan Murdoch

> 
> Best regards,
> 
> Michael H?hle
> 
> --
> 
> ---
> * checking for working latex ... OK
> * using log directory 'z:/Transmission/RLadyBug/..Rcheck'
> * using R version 2.4.0 (2006-10-03)
> * checking for file './DESCRIPTION' ... OK
> * checking extension type ... Package
> * this is package 'RLadyBug' version '0.4-1'
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking whether package 'RLadyBug' can be installed ... OK
> * checking package directory ... OK
> * checking for portable file names ... OK
> * checking DESCRIPTION meta-information ... OK
> * checking top-level files ... OK
> * checking index information ... OK
> * checking package subdirectories ... OK
> * checking R files for syntax errors ... OK
> * checking R files for non-ASCII characters ... OK
> * checking whether the package can be loaded ... OK
> * checking whether the package can be loaded with stated dependencies ... OK
> * checking whether the name space can be loaded with stated dependencies ... OK
> * checking S3 generic/method consistency ... OK
> * checking replacement functions ... OK
> * checking foreign function calls ... OK
> * checking R code for possible problems ... OK
> * checking Rd files ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... OK
> * checking Rd \usage sections ... OK
> * creating RLadyBug-Ex.R ... OK
> * checking examples ... ERROR
> Running examples in 'RLadyBug-Ex.R' failed.
> The error most likely occurred in:
> 
>> ### * LBExperiment-class
>>
>> flush(stderr()); flush(stdout())
>>
>> ### Name: LBExperiment-class
>> ### Title: Class "LBExperiment"
>> ### Aliases: LBExperiment-class show,LBExperiment-method
>> ###   plot,LBExperiment-method plot,LBExperiment,missing-method
>> ###   summary,LBExperiment-method data2events,LBExperiment-method
>> ###   data2events
>> ### Keywords: classes
>>
>> ### ** Examples
>>
>> sim.layout <- new( "LBLayout", S0=matrix( c( 13, rep( 14, 7 ) ), ncol=4 ),
> +                   E0=matrix( c(  1, rep(  0, 7 ) ), ncol=4 ) )
>> sim.opts <- new( "LBOptions", seed=2006,
> +                             LBmodel=c( "gamma", "gamma", "gamma", FALSE ),
> +                             ignoreData=c( FALSE, FALSE, FALSE ),
> +                             initBeta =list( init=0.125,
> +                                         gamma=0.001, delta=0.001 ),
> +                             initBetaN=list( init=0.018,
> +                                         gamma=0.001, delta=0.001 ),
> +                             initIncu=list( asis=FALSE, const=FALSE,
> +                                     g=6.697, g.gamma=0.001, g.delta=0.001,
> +                                     d=0.84, d.gamma=0.001,d.delta=0.001 ),
> +                             initInf=list( 1.772, 0.001, 0.001,
> 0.123, 0.001, 0.001 ),
> +                             initDia=list( 149.126, 0.001, 0.001,
> +                                     8.737, 0.001, 0.001 ) )
> Error: syntax error in:
> "a=list( 149.126, 0.001, 0.001,
> "                                   8.737, 0.001, 0.001 ) )
> Execution halted

Is there a closing parenthesis not shown?  Because they don't balance in 
that expression.



From p.dalgaard at biostat.ku.dk  Tue Oct 31 15:05:51 2006
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 31 Oct 2006 15:05:51 +0100
Subject: [Rd] Syntax Error in Rcmd check on Windows
In-Reply-To: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
References: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
Message-ID: <x2iri0wpfk.fsf@viggo.kubism.ku.dk>

"Michael Hoehle" <michael.hoehle at gmail.com> writes:

> Dear R-developers,
> 
> I am currently developing an R package called RLadyBug. When
> developing under Linux "R CMD check ." works fine without a warning.
> However, when I do "Rcmd check ." under Windows (version 2.4.0 and
> earlier)  I get a ??syntax error" when checking the examples.
> 
> This puzzles me somewhat, because a manual source("RLadyBug-Ex.R") on
> Windows works fine. On the other hand, a "Rterm.exe --no-save <
> RLadyBug-Ex.R" in a command shell under Windows reproduces the error.
> My first guess was that the very long line was causing the problem,
> but when I open RLadyBug-Ex.R in Emacs, change the coding system from
> "undecided-dos" to "undecided-unix" and save the file "Rterm.exe
> --no-save < RLadyBug-Ex.R" works fine....
> 
> Does anybody has an idea what is causing the error and how to fix this?
> 
> Best regards,
> 
> Michael H?hle

....
> > sim.opts <- new( "LBOptions", seed=2006,
> +                             LBmodel=c( "gamma", "gamma", "gamma", FALSE ),
> +                             ignoreData=c( FALSE, FALSE, FALSE ),
> +                             initBeta =list( init=0.125,
> +                                         gamma=0.001, delta=0.001 ),
> +                             initBetaN=list( init=0.018,
> +                                         gamma=0.001, delta=0.001 ),
> +                             initIncu=list( asis=FALSE, const=FALSE,
> +                                     g=6.697, g.gamma=0.001, g.delta=0.001,
> +                                     d=0.84, d.gamma=0.001,d.delta=0.001 ),
> +                             initInf=list( 1.772, 0.001, 0.001,
> 0.123, 0.001, 0.001 ),
> +                             initDia=list( 149.126, 0.001, 0.001,
> +                                     8.737, 0.001, 0.001 ) )
> Error: syntax error in:
> "a=list( 149.126, 0.001, 0.001,
> "                                   8.737, 0.001, 0.001 ) )
> Execution halted
....

It's a longshot, but could some funny characters have crept in around
"initDia"?? (There's a way to open it in Hex from inside Emacs, isn't
there?)

-- 
   O__  ---- Peter Dalgaard             ??ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907



From bolker at zoo.ufl.edu  Tue Oct 31 15:50:06 2006
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue, 31 Oct 2006 09:50:06 -0500
Subject: [Rd] help with extended mle package?
Message-ID: <4547629E.5030405@zoo.ufl.edu>


  A while back, I wrote to the list/engaged in some debate with
Peter Dalgaard about the mle() function in the stats4 package --
in particular, I wanted it to have a data= argument so that
parameters could be estimated for different sets of data with
the same minuslogl function: Peter disagreed, suggesting that
a function-defining-function (e.g. something like

minusloglfun <- function(data) {
   with(data,
      function(param1,param2) {
         [negative log-likelihood expression]
      })
) was a good solution.

  I also had some confusion/misunderstanding about the differences
between the fullcoef and coef slots within the mle object.

  Since then I've done a fair amount with my version
of mle()  [bbmle, available from
http://www.zoo.ufl.edu/bolker/R/src/bbmle_0.3.0.tar.gz ] ;


 - confidence limits estimated by spline back-fitting
(as in base mle package) OR uniroot (for higher precision/
models with non-smooth profiles) OR quadratic approximation

 - allows parameters to be specified as a named vector
rather than a named list (so you can in principle use the
same objective function for optim() or mle())

 - options for profile plots

 - anova method for mle to produce Likelihood Ratio Test
tables

 - AIC, BIC methods for single and multiple models

 - some robustness -- e.g. continues with more informative
messages if (e.g.) Hessian can't be inverted or profile
finds better fit

  I'm afraid, however, that my code is now getting somewhat
idiosyncratic and spaghetti-ish -- I ran into this particularly
when trying to add some options to the AIC method to allow
(e.g.) small-sample corrections or calculation of AIC weights
a la Burnham and Anderson.

  I did have the original goal of also extending mle in the
direction of allowing more analytic expressions for parameters
of known distributions (like Jim Lindsey's packages, but ideally (?)
more robust), but I haven't gotten there yet.  My main goal
is to make mle a practical, robust and convenient tool for
analysis ... in the long run I would love it if at least
some of my changes got rolled back into stats4.

   Anyone out there interesting in hacking on this a bit more
with me/providing some perspective on which bells and whistles
are really necessary and which are unnecessary complications?

  cheers
    Ben Bolker


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 254 bytes
Desc: OpenPGP digital signature
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20061031/3a1dc985/attachment-0004.bin 

From michael.hoehle at gmail.com  Tue Oct 31 16:06:00 2006
From: michael.hoehle at gmail.com (Michael Hoehle)
Date: Tue, 31 Oct 2006 16:06:00 +0100
Subject: [Rd] Syntax Error in Rcmd check on Windows
In-Reply-To: <454755B0.4050606@stats.uwo.ca>
References: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
	<454755B0.4050606@stats.uwo.ca>
Message-ID: <84fc09fb0610310706m2c24796bg783d7dfee8887a99@mail.gmail.com>

Hello again,

Thank you for the feedback. I put the source File on the net as

http://www.statistik.lmu.de/~hoehle/software/RLadyBug/RLadyBug-Ex.zip

In case you need the entire "..Rcheck" directory I put this as

http://www.statistik.lmu.de/~hoehle/software/RLadyBug/Rcheck.zip

The "("  ")" should balance as it runs through source without
problems. I tried to use "hexl-mode" in Emacs to look for funny
characters, but didn't find any. If I delete the "initDia" line I just
get an syntax error a few lines later...

Probably its something very stupid thats wrong, but atm I fail to see it.

Best regards,

Michael H?hle



From r.hankin at noc.soton.ac.uk  Tue Oct 31 16:24:38 2006
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Tue, 31 Oct 2006 15:24:38 +0000
Subject: [Rd] setReplaceMethod
Message-ID: <5959F116-B18B-4D0D-BD64-02F8B6EA880E@soc.soton.ac.uk>

Hi

If     x <- 1:10    then  x[5] <- 1i    will promote
x to be a complex vector.

Suppose I  have an S4 class "brob", and have functions
is.brob(), as.brob(), as.numeric() and so forth (minimal self-contained
code below).

If x is numeric (1:10, say) and y is a brob, what
is the best way to make

x[5] <- y

promote x to a brob in the same way as the complex example?

Or is this not desirable for some reason?


My first idea was to use

setReplaceMethod("[",signature("ANY","brob"), ...)

but this gives a seal error:

Error in setMethod(paste(f, "<-", sep = ""), ..., where = where) :
	the method for function "[<-" and signature x="ANY", i="brob" is  
sealed and cannot be re-defined




so this can't be right.











setClass("swift",
          representation = "VIRTUAL"
          )

setClass("brob",
          representation = representation 
(x="numeric",positive="logical"),
          prototype      = list(x=numeric(),positive=logical()),
          contains       = "swift"
          )

setAs("brob", "numeric", function(from){
   out <- exp(from at x)
   out[!from at positive] <- -out[!from at positive]
   return(out)
} )

setMethod("as.numeric",signature(x="brob"),function(x){as(x,"numeric")})
is.brob <- function(x){is(x,"brob")}

"brob" <- function(x=double(),positive){
   if(missing(positive)){
     positive <- rep(TRUE,length(x))
   }
   if(length(positive)==1){
     positive <- rep(positive,length(x))
   }
   new("brob",x=as.numeric(x),positive=positive)
}

"as.brob" <- function(x){
   if(is.brob(x)){
     return(x)
   } else if(is.complex(x)) {
     warning("imaginary parts discarded")
     return(Recall(Re(x)))
   } else if(is.glub(x)){
     warning("imaginary parts discarded")
     return(Re(x))
   } else {
     return(brob(log(abs(x)), x>=0))
   }
}

setMethod("[", "brob",
           function(x, i, j, drop){
             brob(x at x[i], x at positive[i])
           } )

setReplaceMethod("[",signature(x="brob"),
                  function(x,i,j,value){
                    jj.x <- x at x
                    jj.pos <- x at positive
                    if(is.brob(value)){
                      jj.x[i] <- value at x
                      jj.pos[i] <- value at positive
                      return(brob(x=jj.x,positive=jj.pos))
                    } else {
                      x[i] <- as.brob(value)
                      return(x)
                    }
                  } )


setReplaceMethod("[",signature("ANY","brob"),

                  function(x,i,j,value){
                    x <- as.brob(x)
                    x[i] <- as.brob(value)
                    return(x)
                  }
                  )




--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743



From murdoch at stats.uwo.ca  Tue Oct 31 19:23:58 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 31 Oct 2006 13:23:58 -0500
Subject: [Rd] Syntax Error in Rcmd check on Windows
In-Reply-To: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
References: <84fc09fb0610310538v1d80061cr65553e95a63f1329@mail.gmail.com>
Message-ID: <454794BE.4020807@stats.uwo.ca>

On 10/31/2006 8:38 AM, Michael Hoehle wrote:
> Dear R-developers,
> 
> I am currently developing an R package called RLadyBug. When
> developing under Linux "R CMD check ." works fine without a warning.
> However, when I do "Rcmd check ." under Windows (version 2.4.0 and
> earlier)  I get a ?syntax error" when checking the examples.

Thanks for pointing me to the source.  I can reproduce the problem, and 
I'm fairly sure it's an R bug, not a problem in your source.  I need to 
trace through at a low level to confirm this and to work out the fix.

Duncan Murdoch



From vdergachev at rcgardis.com  Tue Oct 31 20:24:01 2006
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Tue, 31 Oct 2006 14:24:01 -0500
Subject: [Rd] Some R questions
Message-ID: <200610311424.01627.vdergachev@rcgardis.com>

Hi all, 

   I am working with some large data sets (1-4 GB) and have some questions 
that I hope someone can help me with:

   1.  Is there a way to turn off garbage collector from within C interface ?
      	what I am trying to do is suck data from mysql (using my own C
 	functions) and I see that allocating each column (with about 1-4 million
        items) takes between 0.5 and 1 seconds. My first thought was that it
        would be nice to turn off garbage collector, allocate all the data, 
	copy values and then turn the garbage collector back on.

   2.  For creating STRSXP should I be using mkChar() or mkString() to create
 	element values ? Is there a way to do it without allocating a cons cell ?
	(otherwise a single STRSXP with 1e6 length slows down garbage collector)

   3. 	Is "row.names" attribute required for data frames and, if so, can I
 	use some other type besides STRSXP ?

   4.	While poking around to find out why some of my code is excessively slow
      	I have come upon definition of `[.data.frame` - subscription operator
	for data frames, which appears to be written in R. I am wondering whether
	I am looking at the right place and whether anyone would be interested in
	a piece of C code optimizing it - in particular extraction of single element
	is quite slow (i.e. calls like T[i, j]).

                   thank you very much !

                                 Vladimir Dergachev



From jrstear at sandia.gov  Tue Oct 31 20:48:08 2006
From: jrstear at sandia.gov (Jon Stearley)
Date: Tue, 31 Oct 2006 12:48:08 -0700
Subject: [Rd] missing SIGWINCH?
Message-ID: <CD068A86-EFB8-46C6-97A6-0C89FB94DFD2@sandia.gov>

I have an R library which uses identify() and system(com="xterm -e  
less /a/corresponding/file") to view files when I click on an x11()  
plot.  I can successfully resize the xterm on Linux (i486) and Macos  
10.4 (G4 and G5), but NOT Macos 10.4 (Intel).  For example, on a new  
mac pro:

# in a terminal,xterm,iterm,etc:
xterm -e "printenv | less"
# the resulting xterm resizes fine - eg text wraps at resized window  
boundaries.  so i don't think the problem is in xterm (?)

# BUT, in R:
system(com="xterm -e 'printenv | less'")
# the resulting xterm DOES NOT resize fine - eg text does not wrap at  
resized window boundaries.

these both work fine on the other platforms, and i don't see any  
obviously important differences in the environment variables.  i have  
confirmed this behaviour on two different out-of-the-box mac pros.   
perhaps there is a peculiarity with R's system() on macos/intel (i  
have no idea)?

not being able to resize the resulting xterm turns out to be a major  
bummer for my application - any help towards debugging this would be  
much appreciated.  thank you!

-- 
+--------------------------------------------------------------+
| Jon Stearley                  (505) 845-7571  (FAX 844-9297) |
| Sandia National Laboratories  Scalable Systems Integration   |
+--------------------------------------------------------------+



From simon.urbanek at r-project.org  Tue Oct 31 21:50:40 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 31 Oct 2006 15:50:40 -0500
Subject: [Rd] missing SIGWINCH?
In-Reply-To: <CD068A86-EFB8-46C6-97A6-0C89FB94DFD2@sandia.gov>
References: <CD068A86-EFB8-46C6-97A6-0C89FB94DFD2@sandia.gov>
Message-ID: <D43824B9-F14B-4CA5-BE85-6695568639F2@r-project.org>

Jon,

I don't have access to a Mac Pro, so I can't test anything, but based  
on your report I found a bug in R_system that affects signal handling  
during "system" calls on Macs. Please test the current R-devel  
(39754) or R-2-4-branch (39755) to see if it solves your problem.

Thanks,
Simon

On Oct 31, 2006, at 2:48 PM, Jon Stearley wrote:

> I have an R library which uses identify() and system(com="xterm -e   
> less /a/corresponding/file") to view files when I click on an x11 
> ()  plot.  I can successfully resize the xterm on Linux (i486) and  
> Macos  10.4 (G4 and G5), but NOT Macos 10.4 (Intel).  For example,  
> on a new  mac pro:
> [...]
>



