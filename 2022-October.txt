From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Sat Oct  1 18:00:07 2022
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (NP))
Date: Sat, 1 Oct 2022 16:00:07 +0000
Subject: [Rd] Linking to Intel's MKL on Windows
In-Reply-To: <CAP1vfdtozPWjKkvL9tqKZPKA1y+B44d2tc+yO6n4tYCUpJQOug@mail.gmail.com>
References: <CAP1vfdtozPWjKkvL9tqKZPKA1y+B44d2tc+yO6n4tYCUpJQOug@mail.gmail.com>
Message-ID: <acfeb141204c48ebb18d8c6737f1d1a9@UM-MAIL3214.unimaas.nl>

Hi Christine,

MKL is a closed-source commercial product (yes, one can get it for free, but it is not libre/open-source software).

Best,
Wolfgang

>-----Original Message-----
>From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Christine
>Stawitz - NOAA Federal via R-devel
>Sent: Friday, 30 September, 2022 18:46
>To: r-devel at r-project.org
>Subject: [Rd] Linking to Intel's MKL on Windows
>
>Hi,
>
>Recently I became aware that Microsoft R Open provides accelerated matrix
>algebra computations through Intel's Math Kernel Libraries. However, the
>version of R shipped with the Microsoft R Open is too out of date to be
>able to use concurrently with other dependencies while developing our
>package. This thread suggests a way to get the updated matrix libraries
>with a more recent version of R, however it is unlikely to be approved by
>our IT admin since those of us in government agencies aren't typically
>given admin privileges: Linking Intel's Math Kernel Library (MKL) to R on
>Windows - Stack Overflow
><https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-
>mkl-to-r-on-windows>
>
>Is there a reason why CRAN doesn't provide a version of R with the updated
>libraries such that developers don't have to recompile R or copy .dlls
>around as described above? It would help those of us running software with
>slow-running matrix calculations in R.
>
>Thanks,
>Christine
>
>--
>Christine C. Stawitz, PhD. (pronouns: she/her)
>
>National Stock Assessment Program Modeling Team
>
>NOAA Fisheries Office of Science and Technology |  U.S. Department of
>Commerce
>
>Mobile: 206-617-2060
>
>www.fisheries.noaa.gov


From bbo|ker @end|ng |rom gm@||@com  Sat Oct  1 18:48:39 2022
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sat, 1 Oct 2022 12:48:39 -0400
Subject: [Rd] Linking to Intel's MKL on Windows
In-Reply-To: <acfeb141204c48ebb18d8c6737f1d1a9@UM-MAIL3214.unimaas.nl>
References: <CAP1vfdtozPWjKkvL9tqKZPKA1y+B44d2tc+yO6n4tYCUpJQOug@mail.gmail.com>
 <acfeb141204c48ebb18d8c6737f1d1a9@UM-MAIL3214.unimaas.nl>
Message-ID: <13d28348-762f-c15a-4ece-980498e7e990@gmail.com>

    Maybe you can find out more about Microsoft's development/release 
process for MRO and why they're still on 4.0.2 (from June 2020)?  I 
followed the "user forum" link on their web page, but it appears to be a 
generic Windows forum ...

https://social.msdn.microsoft.com/Forums/en-US/home?forum%20=ropen

    I might tweet at @revodavid (David Smith) to see if there's any more 
information available about the MRO release schedule ...

   good luck,
    Ben Bolker




On 2022-10-01 12:00 p.m., Viechtbauer, Wolfgang (NP) wrote:
> Hi Christine,
> 
> MKL is a closed-source commercial product (yes, one can get it for free, but it is not libre/open-source software).
> 
> Best,
> Wolfgang
> 
>> -----Original Message-----
>> From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Christine
>> Stawitz - NOAA Federal via R-devel
>> Sent: Friday, 30 September, 2022 18:46
>> To: r-devel at r-project.org
>> Subject: [Rd] Linking to Intel's MKL on Windows
>>
>> Hi,
>>
>> Recently I became aware that Microsoft R Open provides accelerated matrix
>> algebra computations through Intel's Math Kernel Libraries. However, the
>> version of R shipped with the Microsoft R Open is too out of date to be
>> able to use concurrently with other dependencies while developing our
>> package. This thread suggests a way to get the updated matrix libraries
>> with a more recent version of R, however it is unlikely to be approved by
>> our IT admin since those of us in government agencies aren't typically
>> given admin privileges: Linking Intel's Math Kernel Library (MKL) to R on
>> Windows - Stack Overflow
>> <https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-
>> mkl-to-r-on-windows>
>>
>> Is there a reason why CRAN doesn't provide a version of R with the updated
>> libraries such that developers don't have to recompile R or copy .dlls
>> around as described above? It would help those of us running software with
>> slow-running matrix calculations in R.
>>
>> Thanks,
>> Christine
>>
>> --
>> Christine C. Stawitz, PhD. (pronouns: she/her)
>>
>> National Stock Assessment Program Modeling Team
>>
>> NOAA Fisheries Office of Science and Technology |  U.S. Department of
>> Commerce
>>
>> Mobile: 206-617-2060
>>
>> www.fisheries.noaa.gov
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Sun Oct  2 01:52:39 2022
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Sat, 1 Oct 2022 19:52:39 -0400
Subject: [Rd] Linking to Intel's MKL on Windows
In-Reply-To: <13d28348-762f-c15a-4ece-980498e7e990@gmail.com>
References: <13d28348-762f-c15a-4ece-980498e7e990@gmail.com>
Message-ID: <DE8330EC-333A-4F4A-8333-035E1B9ECCA3@gmail.com>

Also, you can build Rblas against OpenBLAS even on Windows which will go far in speeding up matrix calculations. 

Thanks,

Avi

Sent from my iPhone

> On Oct 1, 2022, at 12:49 PM, Ben Bolker <bbolker at gmail.com> wrote:
> 
> ?   Maybe you can find out more about Microsoft's development/release process for MRO and why they're still on 4.0.2 (from June 2020)?  I followed the "user forum" link on their web page, but it appears to be a generic Windows forum ...
> 
> https://social.msdn.microsoft.com/Forums/en-US/home?forum%20=ropen
> 
>   I might tweet at @revodavid (David Smith) to see if there's any more information available about the MRO release schedule ...
> 
>  good luck,
>   Ben Bolker
> 
> 
> 
> 
>> On 2022-10-01 12:00 p.m., Viechtbauer, Wolfgang (NP) wrote:
>> Hi Christine,
>> MKL is a closed-source commercial product (yes, one can get it for free, but it is not libre/open-source software).
>> Best,
>> Wolfgang
>>> -----Original Message-----
>>> From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Christine
>>> Stawitz - NOAA Federal via R-devel
>>> Sent: Friday, 30 September, 2022 18:46
>>> To: r-devel at r-project.org
>>> Subject: [Rd] Linking to Intel's MKL on Windows
>>> 
>>> Hi,
>>> 
>>> Recently I became aware that Microsoft R Open provides accelerated matrix
>>> algebra computations through Intel's Math Kernel Libraries. However, the
>>> version of R shipped with the Microsoft R Open is too out of date to be
>>> able to use concurrently with other dependencies while developing our
>>> package. This thread suggests a way to get the updated matrix libraries
>>> with a more recent version of R, however it is unlikely to be approved by
>>> our IT admin since those of us in government agencies aren't typically
>>> given admin privileges: Linking Intel's Math Kernel Library (MKL) to R on
>>> Windows - Stack Overflow
>>> <https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-
>>> mkl-to-r-on-windows>
>>> 
>>> Is there a reason why CRAN doesn't provide a version of R with the updated
>>> libraries such that developers don't have to recompile R or copy .dlls
>>> around as described above? It would help those of us running software with
>>> slow-running matrix calculations in R.
>>> 
>>> Thanks,
>>> Christine
>>> 
>>> --
>>> Christine C. Stawitz, PhD. (pronouns: she/her)
>>> 
>>> National Stock Assessment Program Modeling Team
>>> 
>>> NOAA Fisheries Office of Science and Technology |  U.S. Department of
>>> Commerce
>>> 
>>> Mobile: 206-617-2060
>>> 
>>> www.fisheries.noaa.gov
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
> > E-mail is sent at my convenience; I don't expect replies outside of working hours.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From @uh@rto_@nggono @end|ng |rom y@hoo@com  Sun Oct  2 10:42:50 2022
From: @uh@rto_@nggono @end|ng |rom y@hoo@com (Suharto Anggono Suharto Anggono)
Date: Sun, 2 Oct 2022 08:42:50 +0000 (UTC)
Subject: [Rd] as.character.POSIXt in R devel
References: <1454067819.3486826.1664700170912.ref@mail.yahoo.com>
Message-ID: <1454067819.3486826.1664700170912@mail.yahoo.com>

With?r82904,?'as.character.POSIXt'?in?R?devel?is?changed.?The?NEWS?item:
as.character(<POSIXt>)?now?behaves?more?in?line?with?the
???methods?for?atomic?vectors?such?as?numbers,?and?is?no?longer
???influenced?by?options().

Part?of?the?code:

???????s?<-?trunc(x$sec)
????????fs?<-?x$sec?-?s
????????r1?<-?sprintf("%d-%02d-%02d",?1900?+?x$year,?x$mon+1L,?x$mday)
??????if(any(n0?<-?time?!=?0))?#?add?time?if?not?0
????????????r1[n0]?<-?paste(r1[n0],
????????????????????????sprintf("%02d:%02d:%02d%s",?x$hour[n0],?x$min[n0],?s[n0],
????????????????????????????????substr(as.character(fs[n0]),?2L,?32L)))


*?Wrong:
The?result?is?wrong?when?as.character(fs[n0])?has?scientific?notation.
Example?(modified?from?https://bugs.r-project.org/show_bug.cgi?id=9819):
op?<-?options(scipen?=?0,?OutDec?=?".")?#?(default?setting)
x?<-?as.POSIXlt("2007-07-27?16:11:03.000002")
as.character(x)
#?"2007-07-27?16:11:03.99999999983547e-06"
as.character(x$sec?-?trunc(x$sec))
#?"1.99999999983547e-06"
options(op)

'as.character.POSIXt'?could?temporarily?set?option?'scipen'?large?enough?to?prevent?scientific?notation?in?as.character(fs[n0])?.


*?Too?much?precision:
In?some?cases?with?fractional?seconds?with?seconds?close?to?60,?the?result?has?many?decimal?places?while?there?is?an?accurate?representation?with?less?decimal?places.?It?is?actually?OK,?just?unpleasant.
Example?(modified?from?https://bugs.r-project.org/show_bug.cgi?id=14693):
op?<-?options(scipen?=?0,?OutDec?=?".")?#?(default?setting)
x?<-?as.POSIXlt("2011-10-01?12:34:56.3")
x$sec?==?56.3?#?TRUE
print(x$sec,?17)
#?[1]?56.299999999999997
as.character(x)
#?"2011-10-01?12:34:56.299999999999997"
format(x,?"%Y-%m-%d?%H:%M:%OS1")?#?short?and?accurate
#?"2011-10-01?12:34:56.3"
ct?<-?as.POSIXct(x,?tz?=?"UTC")
identical(ct,
as.POSIXct("2011-10-01?12:34:56.3",?tz?=?"UTC"))
#?TRUE
print(as.numeric(ct),?17)
#?[1]?1317472496.3
lct?<-?as.POSIXlt(ct)
lct$sec?==?56.3?#?FALSE
print(lct$sec,?17)
#?[1]?56.299999952316284
as.character(ct)
#?"2011-10-01?12:34:56.299999952316284"
options(op)

The?"POSIXct"?case?is?a?little?different?because?some?precision?is?already?lost?after?converted?to?"POSIXct".

In?'as.character.POSIXt',?using?'as.character'?on?the?seconds?(not?separating?the?fractional?part)?might?be?good?enough,?but?a?leading?zero?must?be?added?as?necessary.


*?Different?from?'format':

-?With?fractional?seconds,?the?result?is?influenced?by?option?'OutDec'.

-?From?"Printing?years"?in??strptime:?"For?years?0?to?999?most?OSes?pad?with?zeros?or?spaces?to?4?characters,?and?Linux?outputs?just?the?number."
Because?(1900?+?x$year)?is?formatted?with?%d?in?'as.character.POSIXt',?years?0?to?999?is?output?without?padding.?It?is?different?from?'format'?in?OSes?other?than?Linux.


*?Behavior?with?"improper"?"POSIXlt"?object:

-?"POSIXlt"?object?with?out-of-bounds?components?is?not?normalized.
Example?(modified?from?regr.tests-1d.R):
op?<-?options(scipen?=?0)?#?(default?setting)
x?<-?structure(
list(sec?=?10000,?min?=?59L,?hour?=?18L,
mday?=?6L,?mon?=?11L,?year?=?116L,
wday?=?2L,?yday?=?340L,
isdst?=?0L,?zone?=?"CET",?gmtoff?=?3600L),
class?=?c("POSIXlt",?"POSIXt"),?tzone?=?"CET")
as.character(x)
#?"2016-12-06?18:59:10000"
format(x)
#?"2016-12-06?21:45:40"
options(op)

-?With?"POSIXlt"?object?where?sec,?min,?hour,?mday,?mon,?and?year?components?are?not?all?of?the?same?length,?recycling?is?not?handled.
Example?(modified?from?regr.tests-1d.R):
op?<-?options(scipen?=?0)?#?(default?setting)
x?<-?structure(
list(sec?=?c(1,??2),?min?=?59L,?hour?=?18L,
mday?=?6L,?mon?=?11L,?year?=?116L,
wday?=?2L,?yday?=?340L,
isdst?=?0L,?zone?=?"CET",?gmtoff?=?3600L),
class?=?c("POSIXlt",?"POSIXt"),?tzone?=?"CET")
as.character(x)
#?c("2016-12-06?18:59:01",?"NA?NA:NA:02")
format(x)
#?c("2016-12-06?18:59:01",?"2016-12-06?18:59:02")
options(op)


