From ggrothendieck at gmail.com  Mon Jan  1 07:28:46 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 1 Jan 2007 01:28:46 -0500
Subject: [Rd] Wish list
Message-ID: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>

This is my 2007 New Year wishlist for R features:

1. Matrix Multiplication
   Enhance matrix multiplication to work with multidimensional
   arrays such that the last dimension of the first multiplicand
   must equal the first dimension of the second. See:
   https://www.stat.math.ethz.ch/pipermail/r-devel/2006-July/038497.html

2. Grid
   - logical-valued function as first arg of grid.edit
   - transparency under Windows (not sure if this involves grid
     or just the Windows graphics device)
   - shading patterns
   - more interactivity features
   - safe way to get name of a grid object, e.g.
        names.vpPath <- names.viewport <- function(x) x$name
   - safe way to get children of a grid object
        getChildren.viewport <- function(x) x$children
     and the order; see:
     https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033532.html
   - facility for using a name, viewport or vpPath interchangably
     so that, for example, any of them can be specified in
     in print.trellis(..., draw.in=...) or draw.key(..., vp=...)

3. Lattice.
   - make panel functions generic
   - allow print.trellis args to be specified in xyplot, etc.
   - shading patterns (once grid implements them)
   - safe way to access lattice:::getStatus and lattice:::updateList
   - allow name, viewport or vpPath to be specified in draw.in=
     arg of print.trellis (and vp= arg of draw.key?)
   - document parameters, i.e. those output from trellis.par.get()
   - support for groups in histogram

4. Higher level Windows clipboard functions.
   Since R 2.3.0 R can handle non-text objects
on the Windows clipboard.  We now need some higher
level functionality that makes use of that
to read in non-text from the clipboard.  For
example, one can select a table on an HTML
page in Internet Explorer and invoke copy
and it will copy it to the clipboard in a
non-text format.  If one invokes paste in
Excel, Excel will automatically detect the
non-text format and copy it in the expected
way so that it appears in Excel one table
cell per Excel cell.

However, R does not currently
support this level of integration. (Current
workaround is to paste it into Excel and then copy
it back out of Excel.  Excel will insert tabs between
text that is so copied.)

6. Allow attributes to be associated with an environment
variable without having them associated with the environment
itself.  This would allow more powerful inheritance in
the case of subclasses of environment.
See:
  https://stat.ethz.ch/pipermail/r-devel/2006-July/038377.html
and subsequent postings in that thread.  Any package
that uses the list(env = whatever) idiom to define
objects could make use of this.

7. documentation standards for packages
   - NEWS/ChangeLog (also should be accessible from CRAN page for package
     and should be included in built version of package)
   - package?mypackage

8. Need to be able to distinguish between ordinary missing values
and structurally missing ones.

9. bidirectional pipes in Windows

10. Create a log updated at a regular frequency (daily or real time)
that tracks all changes on CRAN, e.g.

	Date(GMT)           Package Version Action
	2006-09-20 21:22:01 mypkg   1.0.1   new
	2006-09-20 22:00:23 mypkg2  0.2.1   updated

11. make integrate generic.  Ryacas could use that.

12. Remove all R CMD dependencies on the find.exe command.  find is a built
    in command in Windows and having find.exe on my path causes
    problems with other programs.

13. Make upper/lower case of simplify/SIMPLIFY consistent on all
    apply commands and add a simplify= arg to by.

14. better reporting of location of errors and warnings in R CMD check.

15. tcl tile library (needs tcl 8.5 or to be compiled in with 8.4)

16. extend aggregate to allow vector valued functions:
    aggregate(CO2[4:5], CO2[1:2], function(x) c(mean = mean(x), sd = sd(x)))
    [summaryBy in doBy package and cast in reshape package can already
    do similar things but this seems sufficiently fundamental that it
    ought to be in the base of R]

17. All OSes should support input= arg of system.

My previous New Year wishlists are here:

https://www.stat.math.ethz.ch/pipermail/r-devel/2006-January/035949.html
https://www.stat.math.ethz.ch/pipermail/r-help/2005-January/061984.html
https://www.stat.math.ethz.ch/pipermail/r-devel/2004-January/028465.html


From murdoch at stats.uwo.ca  Mon Jan  1 17:10:42 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 01 Jan 2007 11:10:42 -0500
Subject: [Rd] Wish list
In-Reply-To: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
Message-ID: <45993282.7030409@stats.uwo.ca>

A few comments thrown in, and some general comments at the bottom.

On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
> This is my 2007 New Year wishlist for R features:
> 
> 1. Matrix Multiplication
>    Enhance matrix multiplication to work with multidimensional
>    arrays such that the last dimension of the first multiplicand
>    must equal the first dimension of the second. See:
>    https://www.stat.math.ethz.ch/pipermail/r-devel/2006-July/038497.html
> 
> 2. Grid
>    - logical-valued function as first arg of grid.edit
>    - transparency under Windows (not sure if this involves grid
>      or just the Windows graphics device)
>    - shading patterns
>    - more interactivity features
>    - safe way to get name of a grid object, e.g.
>         names.vpPath <- names.viewport <- function(x) x$name
>    - safe way to get children of a grid object
>         getChildren.viewport <- function(x) x$children
>      and the order; see:
>      https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033532.html
>    - facility for using a name, viewport or vpPath interchangably
>      so that, for example, any of them can be specified in
>      in print.trellis(..., draw.in=...) or draw.key(..., vp=...)
> 
> 3. Lattice.
>    - make panel functions generic
>    - allow print.trellis args to be specified in xyplot, etc.
>    - shading patterns (once grid implements them)
>    - safe way to access lattice:::getStatus and lattice:::updateList
>    - allow name, viewport or vpPath to be specified in draw.in=
>      arg of print.trellis (and vp= arg of draw.key?)
>    - document parameters, i.e. those output from trellis.par.get()
>    - support for groups in histogram
> 
> 4. Higher level Windows clipboard functions.
>    Since R 2.3.0 R can handle non-text objects
> on the Windows clipboard.  We now need some higher
> level functionality that makes use of that
> to read in non-text from the clipboard.  For
> example, one can select a table on an HTML
> page in Internet Explorer and invoke copy
> and it will copy it to the clipboard in a
> non-text format.  If one invokes paste in
> Excel, Excel will automatically detect the
> non-text format and copy it in the expected
> way so that it appears in Excel one table
> cell per Excel cell.
> 
> However, R does not currently
> support this level of integration. (Current
> workaround is to paste it into Excel and then copy
> it back out of Excel.  Excel will insert tabs between
> text that is so copied.)

R doesn't have HTML parsing built in, so this would be a fairly major 
addition.  It's a much better idea to write a package to do this.  If 
the R clipboard support is missing something that such a package would 
need, that would be a reasonable addition to R.

> 
> 6. Allow attributes to be associated with an environment
> variable without having them associated with the environment
> itself.  This would allow more powerful inheritance in
> the case of subclasses of environment.
> See:
>   https://stat.ethz.ch/pipermail/r-devel/2006-July/038377.html
> and subsequent postings in that thread.  Any package
> that uses the list(env = whatever) idiom to define
> objects could make use of this.

As I said in that thread, this is not a good suggestion.

> 7. documentation standards for packages
>    - NEWS/ChangeLog (also should be accessible from CRAN page for package
>      and should be included in built version of package)
>    - package?mypackage

I don't understand the second part of this.  We already support a 
package?mypackage topic, and recommend that people put it in.  Are you 
saying packages should be rejected if they don't?  That's an awful lot 
of work you're asking other people to do.

> 8. Need to be able to distinguish between ordinary missing values
> and structurally missing ones.

I think this is something that you need to do in a different way.  There 
are tons of possible semantics for what NA should mean.  I don't think 
this should be made more complicated for everyone.

> 9. bidirectional pipes in Windows
> 
> 10. Create a log updated at a regular frequency (daily or real time)
> that tracks all changes on CRAN, e.g.
> 
> 	Date(GMT)           Package Version Action
> 	2006-09-20 21:22:01 mypkg   1.0.1   new
> 	2006-09-20 22:00:23 mypkg2  0.2.1   updated
> 
> 11. make integrate generic.  Ryacas could use that.
> 
> 12. Remove all R CMD dependencies on the find.exe command.  find is a built
>     in command in Windows and having find.exe on my path causes
>     problems with other programs.

A simpler fix for this would be for you to define a wrapper for R CMD 
that installed the R tools path before executing, and uninstalls it 
afterwards.  But this is unnecessary for most people, because 
Microsoft's find.exe is pretty rarely used.

> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
>     apply commands and add a simplify= arg to by.

It would have been good not to introduce the inconsistency years ago, 
but it's too late to change now.

> 14. better reporting of location of errors and warnings in R CMD check.

This is in the works, but probably not for 2.5.x.
> 
> 15. tcl tile library (needs tcl 8.5 or to be compiled in with 8.4)
> 
> 16. extend aggregate to allow vector valued functions:
>     aggregate(CO2[4:5], CO2[1:2], function(x) c(mean = mean(x), sd = sd(x)))
>     [summaryBy in doBy package and cast in reshape package can already
>     do similar things but this seems sufficiently fundamental that it
>     ought to be in the base of R]
> 
> 17. All OSes should support input= arg of system.
> 
> My previous New Year wishlists are here:
> 
> https://www.stat.math.ethz.ch/pipermail/r-devel/2006-January/035949.html
> https://www.stat.math.ethz.ch/pipermail/r-help/2005-January/061984.html
> https://www.stat.math.ethz.ch/pipermail/r-devel/2004-January/028465.html

To anyone still reading:

Many of the suggestions above would improve R, but they're unlikely to 
happen unless someone volunteers to do them.  I'd suggest picking 
whichever one of these or some other list that you think is the highest 
priority, and post a specific proposal to this list about how to do it. 
  If you get a negative response or no response, move on to the next 
one, or put it into a contributed package instead.

When you make the proposal, consider how much work you're asking other 
people to do, and how much you're volunteering to do yourself.  If 
you're asking others to do a lot, then the suggestion had better be 
really valuable to *them*.

Duncan Murdoch


From cberry at tajo.ucsd.edu  Mon Jan  1 18:59:43 2007
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Mon, 1 Jan 2007 09:59:43 -0800
Subject: [Rd] Wish list
In-Reply-To: <45993282.7030409@stats.uwo.ca>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45993282.7030409@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0701010946250.6276@tajo.ucsd.edu>

On Mon, 1 Jan 2007, Duncan Murdoch wrote:

> A few comments thrown in, and some general comments at the bottom.
>
> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
>> This is my 2007 New Year wishlist for R features:
>>
>> 1. [deleted thru 12]

>> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
>>     apply commands and add a simplify= arg to by.
>
> It would have been good not to introduce the inconsistency years ago,
> but it's too late to change now.
>

Really? The consistency issue only concerns mapply, I think.

How 'bout changing the formals of mapply to

$FUN


$...


$MoreArgs
NULL

$SIMPLIFY
simplify

$USE.NAMES
[1] TRUE

$simplify
[1] TRUE

i.e. add simplify = TRUE and change SIMPLIFY's default to 'simplify'

Then the default behavior is retained, specifying a value for 
either SIMPLIFY or simplify gives the desired behavior and SIMPLIFY takes 
precedence over simplify if both are given values. Not pretty, perhaps, 
but it does the job.

I suppose this could get one into trouble if one of the ... args is named 
'simplify', but I do not imagine that is a big deal.


>> 14. [rest deleted]


Charles C. Berry                        (858) 534-2098
                                          Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	         UC San Diego
http://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0717


From ggrothendieck at gmail.com  Mon Jan  1 19:10:35 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 1 Jan 2007 13:10:35 -0500
Subject: [Rd] Wish list
In-Reply-To: <45993282.7030409@stats.uwo.ca>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45993282.7030409@stats.uwo.ca>
Message-ID: <971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>

On 1/1/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> A few comments thrown in, and some general comments at the bottom.
>
> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
> > This is my 2007 New Year wishlist for R features:
> >
> > 1. Matrix Multiplication
> >    Enhance matrix multiplication to work with multidimensional
> >    arrays such that the last dimension of the first multiplicand
> >    must equal the first dimension of the second. See:
> >    https://www.stat.math.ethz.ch/pipermail/r-devel/2006-July/038497.html
> >
> > 2. Grid
> >    - logical-valued function as first arg of grid.edit
> >    - transparency under Windows (not sure if this involves grid
> >      or just the Windows graphics device)
> >    - shading patterns
> >    - more interactivity features
> >    - safe way to get name of a grid object, e.g.
> >         names.vpPath <- names.viewport <- function(x) x$name
> >    - safe way to get children of a grid object
> >         getChildren.viewport <- function(x) x$children
> >      and the order; see:
> >      https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033532.html
> >    - facility for using a name, viewport or vpPath interchangably
> >      so that, for example, any of them can be specified in
> >      in print.trellis(..., draw.in=...) or draw.key(..., vp=...)
> >
> > 3. Lattice.
> >    - make panel functions generic
> >    - allow print.trellis args to be specified in xyplot, etc.
> >    - shading patterns (once grid implements them)
> >    - safe way to access lattice:::getStatus and lattice:::updateList
> >    - allow name, viewport or vpPath to be specified in draw.in=
> >      arg of print.trellis (and vp= arg of draw.key?)
> >    - document parameters, i.e. those output from trellis.par.get()
> >    - support for groups in histogram
> >
> > 4. Higher level Windows clipboard functions.
> >    Since R 2.3.0 R can handle non-text objects
> > on the Windows clipboard.  We now need some higher
> > level functionality that makes use of that
> > to read in non-text from the clipboard.  For
> > example, one can select a table on an HTML
> > page in Internet Explorer and invoke copy
> > and it will copy it to the clipboard in a
> > non-text format.  If one invokes paste in
> > Excel, Excel will automatically detect the
> > non-text format and copy it in the expected
> > way so that it appears in Excel one table
> > cell per Excel cell.
> >
> > However, R does not currently
> > support this level of integration. (Current
> > workaround is to paste it into Excel and then copy
> > it back out of Excel.  Excel will insert tabs between
> > text that is so copied.)
>
> R doesn't have HTML parsing built in, so this would be a fairly major
> addition.  It's a much better idea to write a package to do this.  If
> the R clipboard support is missing something that such a package would
> need, that would be a reasonable addition to R.
>
> >
> > 6. Allow attributes to be associated with an environment
> > variable without having them associated with the environment
> > itself.  This would allow more powerful inheritance in
> > the case of subclasses of environment.
> > See:
> >   https://stat.ethz.ch/pipermail/r-devel/2006-July/038377.html
> > and subsequent postings in that thread.  Any package
> > that uses the list(env = whatever) idiom to define
> > objects could make use of this.
>
> As I said in that thread, this is not a good suggestion.

Yes, but I disagree with that assessment and I am not the
only one.

>
> > 7. documentation standards for packages
> >    - NEWS/ChangeLog (also should be accessible from CRAN page for package
> >      and should be included in built version of package)
> >    - package?mypackage
>
> I don't understand the second part of this.  We already support a
> package?mypackage topic, and recommend that people put it in.  Are you
> saying packages should be rejected if they don't?  That's an awful lot
> of work you're asking other people to do.

There should be some guidelines as to what goes into mypackage-package.Rd .

>
> > 8. Need to be able to distinguish between ordinary missing values
> > and structurally missing ones.
>
> I think this is something that you need to do in a different way.  There
> are tons of possible semantics for what NA should mean.  I don't think
> this should be made more complicated for everyone.
>

Although one does not want to overcomplicate things the fact is that
there are two issues here: structural and non-structural and trying to
force them into a single construct is not simplifying -- rather it
fails to model
what is required adequately.


> > 9. bidirectional pipes in Windows
> >
> > 10. Create a log updated at a regular frequency (daily or real time)
> > that tracks all changes on CRAN, e.g.
> >
> >       Date(GMT)           Package Version Action
> >       2006-09-20 21:22:01 mypkg   1.0.1   new
> >       2006-09-20 22:00:23 mypkg2  0.2.1   updated
> >
> > 11. make integrate generic.  Ryacas could use that.
> >
> > 12. Remove all R CMD dependencies on the find.exe command.  find is a built
> >     in command in Windows and having find.exe on my path causes
> >     problems with other programs.
>
> A simpler fix for this would be for you to define a wrapper for R CMD
> that installed the R tools path before executing, and uninstalls it
> afterwards.  But this is unnecessary for most people, because
> Microsoft's find.exe is pretty rarely used.
>

Anyone who uses batch files will use it quite a bit.  It certainly causes
me problems on an ongoing basis and is an unacceptable conflict in
my opinion.

I realize that its not entirely of R's doing but it would be best if R did not
make it worse by requiring the use of find.

> > 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
> >     apply commands and add a simplify= arg to by.
>
> It would have been good not to introduce the inconsistency years ago,
> but it's too late to change now.

Its not too late to add it to by().

Also note that the gsubfn package does have a workaround for this.  In gsubfn
one can preface any R function with fn$ and if that is done then the function
can have a simplify= argument which fn$ intercepts and processes.  e.g.

library(gsubfn)
fn$by(CO2[4:5], CO2[2], x ~ coef(lm(uptake ~ ., x)), simplify = rbind)

fn$ can also interpret formulas as functions (and does quasi perl interpolation
in strings) so the formula in the third argument is regarded to be the same
as the anonymous function:  function(x) coef(lm(uptake ~., x)) .

More examples are in the gsubfn vignette.

>
> > 14. better reporting of location of errors and warnings in R CMD check.
>
> This is in the works, but probably not for 2.5.x.
> >

Great.  This will be very welcome.

> > 15. tcl tile library (needs tcl 8.5 or to be compiled in with 8.4)
> >
> > 16. extend aggregate to allow vector valued functions:
> >     aggregate(CO2[4:5], CO2[1:2], function(x) c(mean = mean(x), sd = sd(x)))
> >     [summaryBy in doBy package and cast in reshape package can already
> >     do similar things but this seems sufficiently fundamental that it
> >     ought to be in the base of R]
> >
> > 17. All OSes should support input= arg of system.
> >
> > My previous New Year wishlists are here:
> >
> > https://www.stat.math.ethz.ch/pipermail/r-devel/2006-January/035949.html
> > https://www.stat.math.ethz.ch/pipermail/r-help/2005-January/061984.html
> > https://www.stat.math.ethz.ch/pipermail/r-devel/2004-January/028465.html
>
> To anyone still reading:
>
> Many of the suggestions above would improve R, but they're unlikely to
> happen unless someone volunteers to do them.  I'd suggest picking
> whichever one of these or some other list that you think is the highest
> priority, and post a specific proposal to this list about how to do it.
>  If you get a negative response or no response, move on to the next
> one, or put it into a contributed package instead.
>

I think it works best when contributors develop their software in
contributed packages since it avoids squabbles with the core group.

The core group can then integrate these into R itself if it seems warranted.

> When you make the proposal, consider how much work you're asking other
> people to do, and how much you're volunteering to do yourself.  If
> you're asking others to do a lot, then the suggestion had better be
> really valuable to *them*.
>

The implementation effort should not be a significant consideration in
generating wish lists.    What should be considered is what is really needed.
Its better to know what you need and then later decide whether to implement
it or not than to suppress articulating the need.  Otherwise the development
is driven by what is easy to do rather than what is needed.


From rgentlem at fhcrc.org  Mon Jan  1 19:37:09 2007
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Mon, 01 Jan 2007 10:37:09 -0800
Subject: [Rd] Wish list
In-Reply-To: <971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>	<45993282.7030409@stats.uwo.ca>
	<971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>
Message-ID: <459954D5.7020507@fhcrc.org>



Gabor Grothendieck wrote:
> On 1/1/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> A few comments thrown in, and some general comments at the bottom.
>>
>> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
>>> This is my 2007 New Year wishlist for R features:
>>>
>>> 1. Matrix Multiplication
>>>    Enhance matrix multiplication to work with multidimensional
>>>    arrays such that the last dimension of the first multiplicand
>>>    must equal the first dimension of the second. See:
>>>    https://www.stat.math.ethz.ch/pipermail/r-devel/2006-July/038497.html
>>>
>>> 2. Grid
>>>    - logical-valued function as first arg of grid.edit
>>>    - transparency under Windows (not sure if this involves grid
>>>      or just the Windows graphics device)
>>>    - shading patterns
>>>    - more interactivity features
>>>    - safe way to get name of a grid object, e.g.
>>>         names.vpPath <- names.viewport <- function(x) x$name
>>>    - safe way to get children of a grid object
>>>         getChildren.viewport <- function(x) x$children
>>>      and the order; see:
>>>      https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033532.html
>>>    - facility for using a name, viewport or vpPath interchangably
>>>      so that, for example, any of them can be specified in
>>>      in print.trellis(..., draw.in=...) or draw.key(..., vp=...)
>>>
>>> 3. Lattice.
>>>    - make panel functions generic
>>>    - allow print.trellis args to be specified in xyplot, etc.
>>>    - shading patterns (once grid implements them)
>>>    - safe way to access lattice:::getStatus and lattice:::updateList
>>>    - allow name, viewport or vpPath to be specified in draw.in=
>>>      arg of print.trellis (and vp= arg of draw.key?)
>>>    - document parameters, i.e. those output from trellis.par.get()
>>>    - support for groups in histogram
>>>
>>> 4. Higher level Windows clipboard functions.
>>>    Since R 2.3.0 R can handle non-text objects
>>> on the Windows clipboard.  We now need some higher
>>> level functionality that makes use of that
>>> to read in non-text from the clipboard.  For
>>> example, one can select a table on an HTML
>>> page in Internet Explorer and invoke copy
>>> and it will copy it to the clipboard in a
>>> non-text format.  If one invokes paste in
>>> Excel, Excel will automatically detect the
>>> non-text format and copy it in the expected
>>> way so that it appears in Excel one table
>>> cell per Excel cell.
>>>
>>> However, R does not currently
>>> support this level of integration. (Current
>>> workaround is to paste it into Excel and then copy
>>> it back out of Excel.  Excel will insert tabs between
>>> text that is so copied.)
>> R doesn't have HTML parsing built in, so this would be a fairly major
>> addition.  It's a much better idea to write a package to do this.  If
>> the R clipboard support is missing something that such a package would
>> need, that would be a reasonable addition to R.
>>
>>> 6. Allow attributes to be associated with an environment
>>> variable without having them associated with the environment
>>> itself.  This would allow more powerful inheritance in
>>> the case of subclasses of environment.
>>> See:
>>>   https://stat.ethz.ch/pipermail/r-devel/2006-July/038377.html
>>> and subsequent postings in that thread.  Any package
>>> that uses the list(env = whatever) idiom to define
>>> objects could make use of this.
>> As I said in that thread, this is not a good suggestion.
> 
> Yes, but I disagree with that assessment and I am not the
> only one.

   Nor is Duncan alone in his.

   best wishes
     Robert

> 
>>> 7. documentation standards for packages
>>>    - NEWS/ChangeLog (also should be accessible from CRAN page for package
>>>      and should be included in built version of package)
>>>    - package?mypackage
>> I don't understand the second part of this.  We already support a
>> package?mypackage topic, and recommend that people put it in.  Are you
>> saying packages should be rejected if they don't?  That's an awful lot
>> of work you're asking other people to do.
> 
> There should be some guidelines as to what goes into mypackage-package.Rd .
> 
>>> 8. Need to be able to distinguish between ordinary missing values
>>> and structurally missing ones.
>> I think this is something that you need to do in a different way.  There
>> are tons of possible semantics for what NA should mean.  I don't think
>> this should be made more complicated for everyone.
>>
> 
> Although one does not want to overcomplicate things the fact is that
> there are two issues here: structural and non-structural and trying to
> force them into a single construct is not simplifying -- rather it
> fails to model
> what is required adequately.
> 
> 
>>> 9. bidirectional pipes in Windows
>>>
>>> 10. Create a log updated at a regular frequency (daily or real time)
>>> that tracks all changes on CRAN, e.g.
>>>
>>>       Date(GMT)           Package Version Action
>>>       2006-09-20 21:22:01 mypkg   1.0.1   new
>>>       2006-09-20 22:00:23 mypkg2  0.2.1   updated
>>>
>>> 11. make integrate generic.  Ryacas could use that.
>>>
>>> 12. Remove all R CMD dependencies on the find.exe command.  find is a built
>>>     in command in Windows and having find.exe on my path causes
>>>     problems with other programs.
>> A simpler fix for this would be for you to define a wrapper for R CMD
>> that installed the R tools path before executing, and uninstalls it
>> afterwards.  But this is unnecessary for most people, because
>> Microsoft's find.exe is pretty rarely used.
>>
> 
> Anyone who uses batch files will use it quite a bit.  It certainly causes
> me problems on an ongoing basis and is an unacceptable conflict in
> my opinion.
> 
> I realize that its not entirely of R's doing but it would be best if R did not
> make it worse by requiring the use of find.
> 
>>> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
>>>     apply commands and add a simplify= arg to by.
>> It would have been good not to introduce the inconsistency years ago,
>> but it's too late to change now.
> 
> Its not too late to add it to by().
> 
> Also note that the gsubfn package does have a workaround for this.  In gsubfn
> one can preface any R function with fn$ and if that is done then the function
> can have a simplify= argument which fn$ intercepts and processes.  e.g.
> 
> library(gsubfn)
> fn$by(CO2[4:5], CO2[2], x ~ coef(lm(uptake ~ ., x)), simplify = rbind)
> 
> fn$ can also interpret formulas as functions (and does quasi perl interpolation
> in strings) so the formula in the third argument is regarded to be the same
> as the anonymous function:  function(x) coef(lm(uptake ~., x)) .
> 
> More examples are in the gsubfn vignette.
> 
>>> 14. better reporting of location of errors and warnings in R CMD check.
>> This is in the works, but probably not for 2.5.x.
> 
> Great.  This will be very welcome.
> 
>>> 15. tcl tile library (needs tcl 8.5 or to be compiled in with 8.4)
>>>
>>> 16. extend aggregate to allow vector valued functions:
>>>     aggregate(CO2[4:5], CO2[1:2], function(x) c(mean = mean(x), sd = sd(x)))
>>>     [summaryBy in doBy package and cast in reshape package can already
>>>     do similar things but this seems sufficiently fundamental that it
>>>     ought to be in the base of R]
>>>
>>> 17. All OSes should support input= arg of system.
>>>
>>> My previous New Year wishlists are here:
>>>
>>> https://www.stat.math.ethz.ch/pipermail/r-devel/2006-January/035949.html
>>> https://www.stat.math.ethz.ch/pipermail/r-help/2005-January/061984.html
>>> https://www.stat.math.ethz.ch/pipermail/r-devel/2004-January/028465.html
>> To anyone still reading:
>>
>> Many of the suggestions above would improve R, but they're unlikely to
>> happen unless someone volunteers to do them.  I'd suggest picking
>> whichever one of these or some other list that you think is the highest
>> priority, and post a specific proposal to this list about how to do it.
>>  If you get a negative response or no response, move on to the next
>> one, or put it into a contributed package instead.
>>
> 
> I think it works best when contributors develop their software in
> contributed packages since it avoids squabbles with the core group.
> 
> The core group can then integrate these into R itself if it seems warranted.
> 
>> When you make the proposal, consider how much work you're asking other
>> people to do, and how much you're volunteering to do yourself.  If
>> you're asking others to do a lot, then the suggestion had better be
>> really valuable to *them*.
>>
> 
> The implementation effort should not be a significant consideration in
> generating wish lists.    What should be considered is what is really needed.
> Its better to know what you need and then later decide whether to implement
> it or not than to suppress articulating the need.  Otherwise the development
> is driven by what is easy to do rather than what is needed.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org


From ggrothendieck at gmail.com  Mon Jan  1 19:51:20 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 1 Jan 2007 13:51:20 -0500
Subject: [Rd] Wish list
In-Reply-To: <459954D5.7020507@fhcrc.org>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45993282.7030409@stats.uwo.ca>
	<971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>
	<459954D5.7020507@fhcrc.org>
Message-ID: <971536df0701011051s4b82e6fcl527b622dbb3eadaa@mail.gmail.com>

On 1/1/07, Robiert Gentleman <rgentlem at fhcrc.org> wrote:
>
>
> Gabor Grothendieck wrote:
> > On 1/1/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> A few comments thrown in, and some general comments at the bottom.
> >>
> >> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
> >>> This is my 2007 New Year wishlist for R features:
> >>>
> >>> 1. Matrix Multiplication
> >>>    Enhance matrix multiplication to work with multidimensional
> >>>    arrays such that the last dimension of the first multiplicand
> >>>    must equal the first dimension of the second. See:
> >>>    https://www.stat.math.ethz.ch/pipermail/r-devel/2006-July/038497.html
> >>>
> >>> 2. Grid
> >>>    - logical-valued function as first arg of grid.edit
> >>>    - transparency under Windows (not sure if this involves grid
> >>>      or just the Windows graphics device)
> >>>    - shading patterns
> >>>    - more interactivity features
> >>>    - safe way to get name of a grid object, e.g.
> >>>         names.vpPath <- names.viewport <- function(x) x$name
> >>>    - safe way to get children of a grid object
> >>>         getChildren.viewport <- function(x) x$children
> >>>      and the order; see:
> >>>      https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033532.html
> >>>    - facility for using a name, viewport or vpPath interchangably
> >>>      so that, for example, any of them can be specified in
> >>>      in print.trellis(..., draw.in=...) or draw.key(..., vp=...)
> >>>
> >>> 3. Lattice.
> >>>    - make panel functions generic
> >>>    - allow print.trellis args to be specified in xyplot, etc.
> >>>    - shading patterns (once grid implements them)
> >>>    - safe way to access lattice:::getStatus and lattice:::updateList
> >>>    - allow name, viewport or vpPath to be specified in draw.in=
> >>>      arg of print.trellis (and vp= arg of draw.key?)
> >>>    - document parameters, i.e. those output from trellis.par.get()
> >>>    - support for groups in histogram
> >>>
> >>> 4. Higher level Windows clipboard functions.
> >>>    Since R 2.3.0 R can handle non-text objects
> >>> on the Windows clipboard.  We now need some higher
> >>> level functionality that makes use of that
> >>> to read in non-text from the clipboard.  For
> >>> example, one can select a table on an HTML
> >>> page in Internet Explorer and invoke copy
> >>> and it will copy it to the clipboard in a
> >>> non-text format.  If one invokes paste in
> >>> Excel, Excel will automatically detect the
> >>> non-text format and copy it in the expected
> >>> way so that it appears in Excel one table
> >>> cell per Excel cell.
> >>>
> >>> However, R does not currently
> >>> support this level of integration. (Current
> >>> workaround is to paste it into Excel and then copy
> >>> it back out of Excel.  Excel will insert tabs between
> >>> text that is so copied.)
> >> R doesn't have HTML parsing built in, so this would be a fairly major
> >> addition.  It's a much better idea to write a package to do this.  If
> >> the R clipboard support is missing something that such a package would
> >> need, that would be a reasonable addition to R.
> >>
> >>> 6. Allow attributes to be associated with an environment
> >>> variable without having them associated with the environment
> >>> itself.  This would allow more powerful inheritance in
> >>> the case of subclasses of environment.
> >>> See:
> >>>   https://stat.ethz.ch/pipermail/r-devel/2006-July/038377.html
> >>> and subsequent postings in that thread.  Any package
> >>> that uses the list(env = whatever) idiom to define
> >>> objects could make use of this.
> >> As I said in that thread, this is not a good suggestion.
> >
> > Yes, but I disagree with that assessment and I am not the
> > only one.
>
>   Nor is Duncan alone in his.

Nor am I.  Read the thread.


From Kurt.Hornik at wu-wien.ac.at  Mon Jan  1 22:58:40 2007
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Mon, 1 Jan 2007 22:58:40 +0100
Subject: [Rd] Connections to https: URLs -- IE expert help needed
In-Reply-To: <4589B4E1.8090102@wald.ucdavis.edu>
References: <Pine.LNX.4.64.0612201725400.12201@gannet.stats.ox.ac.uk>
	<4589B4E1.8090102@wald.ucdavis.edu>
Message-ID: <17817.33808.900582.330470@mithrandir.hornik.net>

>>>>> Duncan Temple Lang writes:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1

> Prof Brian Ripley wrote:
>> I've added to R-devel the ability to use download.file() and url() to 
>> https: URLs, *only* if --internet2 is used on Windows.
>> 
>> This uses the Internet Explorer internals, and only works if the 
>> certificate is accepted (so e.g. does not work for 
>> https://svn.r-project.org).
>> 
>> Now I use IE (and Windows for that matter) only when really necessary, and 
>> Firefox has simple ways to permanently accept non-verifiable certificates. 
>> I would be grateful if someone who is much more familiar with IE could 
>> write a note explaining how to deal with this that we could add to the 
>> rw-FAQ.
>> 
>> To forestall the inevitable question: there are no plans to add https: 
>> support on any other platform, but it is something that would make a nice 
>> project for a user contribution.  The current internal code is based on 
>> likxml2, and that AFAICS still does not have https: support.
>> 

> Generally (i.e. not in particular response to Brian but related to
> this thread)

With a similar disclaimer: Brian's efforts were triggered by me asking
how to use url() to read R's mailing list archive files, such as

  https://stat.ethz.ch/pipermail/r-help/2007-January.txt.gz

directly into R.  Turns out we cannot ... which, in a way, is a shame
("R cannot read its own web pages") :-(

Best
-k

> An alternative is to use RCurl and leave HTTPS and a host of other
> protocols and details to an external library (e.g. libcurl, libwww,
> etc.) and an R package that interfaces to it.

> If we want the facilities to be accessible via the connections
> interface, then we can make that API extensible by packages.  Jeff
> Horner has a proposal on that.

> Generally, it is important if R is to continue to evolve that the R
> internals become extensible by package developers so that we can do
> some new experiments and provide alternative implementations of the
> basic structures rather than being tied to the existing
> representation.  An object oriented framework underlying the R source
> code would enable this and would solve numerous problems that have
> arisen recently and I strongly suspect many more that will arise.

>  D.


> - --
> Duncan Temple Lang                    duncan at wald.ucdavis.edu
> Department of Statistics              work:  (530) 752-4782
> 4210 Mathematical Sciences Building   fax:   (530) 752-7099
> One Shields Ave.
> University of California at Davis
> Davis,
> CA 95616,
> USA
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.3 (Darwin)

> iD8DBQFFibTh9p/Jzwa2QP4RAgBiAJ9YojjDf0DMIo9FQ7yW1MiMdANvogCfRgCX
> zci7UsavJESdidbyiCl2Xgw=
> =HiuE
> -----END PGP SIGNATURE-----

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Tue Jan  2 00:53:27 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 01 Jan 2007 18:53:27 -0500
Subject: [Rd] Wish list
In-Reply-To: <971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>	
	<45993282.7030409@stats.uwo.ca>
	<971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>
Message-ID: <45999EF7.4070706@stats.uwo.ca>

On 1/1/2007 1:10 PM, Gabor Grothendieck wrote:
> On 1/1/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> A few comments thrown in, and some general comments at the bottom.
>>
>> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
>>> This is my 2007 New Year wishlist for R features:
>>>
>>> 1. Matrix Multiplication
>>>    Enhance matrix multiplication to work with multidimensional
>>>    arrays such that the last dimension of the first multiplicand
>>>    must equal the first dimension of the second. See:
>>>    https://www.stat.math.ethz.ch/pipermail/r-devel/2006-July/038497.html
>>>
>>> 2. Grid
>>>    - logical-valued function as first arg of grid.edit
>>>    - transparency under Windows (not sure if this involves grid
>>>      or just the Windows graphics device)
>>>    - shading patterns
>>>    - more interactivity features
>>>    - safe way to get name of a grid object, e.g.
>>>         names.vpPath <- names.viewport <- function(x) x$name
>>>    - safe way to get children of a grid object
>>>         getChildren.viewport <- function(x) x$children
>>>      and the order; see:
>>>      https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033532.html
>>>    - facility for using a name, viewport or vpPath interchangably
>>>      so that, for example, any of them can be specified in
>>>      in print.trellis(..., draw.in=...) or draw.key(..., vp=...)
>>>
>>> 3. Lattice.
>>>    - make panel functions generic
>>>    - allow print.trellis args to be specified in xyplot, etc.
>>>    - shading patterns (once grid implements them)
>>>    - safe way to access lattice:::getStatus and lattice:::updateList
>>>    - allow name, viewport or vpPath to be specified in draw.in=
>>>      arg of print.trellis (and vp= arg of draw.key?)
>>>    - document parameters, i.e. those output from trellis.par.get()
>>>    - support for groups in histogram
>>>
>>> 4. Higher level Windows clipboard functions.
>>>    Since R 2.3.0 R can handle non-text objects
>>> on the Windows clipboard.  We now need some higher
>>> level functionality that makes use of that
>>> to read in non-text from the clipboard.  For
>>> example, one can select a table on an HTML
>>> page in Internet Explorer and invoke copy
>>> and it will copy it to the clipboard in a
>>> non-text format.  If one invokes paste in
>>> Excel, Excel will automatically detect the
>>> non-text format and copy it in the expected
>>> way so that it appears in Excel one table
>>> cell per Excel cell.
>>>
>>> However, R does not currently
>>> support this level of integration. (Current
>>> workaround is to paste it into Excel and then copy
>>> it back out of Excel.  Excel will insert tabs between
>>> text that is so copied.)
>> R doesn't have HTML parsing built in, so this would be a fairly major
>> addition.  It's a much better idea to write a package to do this.  If
>> the R clipboard support is missing something that such a package would
>> need, that would be a reasonable addition to R.
>>
>>> 6. Allow attributes to be associated with an environment
>>> variable without having them associated with the environment
>>> itself.  This would allow more powerful inheritance in
>>> the case of subclasses of environment.
>>> See:
>>>   https://stat.ethz.ch/pipermail/r-devel/2006-July/038377.html
>>> and subsequent postings in that thread.  Any package
>>> that uses the list(env = whatever) idiom to define
>>> objects could make use of this.
>> As I said in that thread, this is not a good suggestion.
> 
> Yes, but I disagree with that assessment and I am not the
> only one.

It doesn't matter how many people disagree:  what matters is achieving a 
consensus about what change is needed.  I don't think you could convince 
me that the proposal you made is the right way to solve this problem, 
and I know there are others who don't agree with the proposal I made to 
solve it.  So it is unlikely to be changed, unless someone comes up with 
a new proposal.

>>> 7. documentation standards for packages
>>>    - NEWS/ChangeLog (also should be accessible from CRAN page for package
>>>      and should be included in built version of package)
>>>    - package?mypackage
>> I don't understand the second part of this.  We already support a
>> package?mypackage topic, and recommend that people put it in.  Are you
>> saying packages should be rejected if they don't?  That's an awful lot
>> of work you're asking other people to do.
> 
> There should be some guidelines as to what goes into mypackage-package.Rd .

There are, in the Writing R Extensions manual.

>>> 8. Need to be able to distinguish between ordinary missing values
>>> and structurally missing ones.
>> I think this is something that you need to do in a different way.  There
>> are tons of possible semantics for what NA should mean.  I don't think
>> this should be made more complicated for everyone.
>>
> 
> Although one does not want to overcomplicate things the fact is that
> there are two issues here: structural and non-structural and trying to
> force them into a single construct is not simplifying -- rather it
> fails to model
> what is required adequately.

There aren't just two types of missingness, there are hundreds.  For 
example, I might have some values missing because I couldn't read the 
writing where they were recorded, and others missing because the 
instrument failed.  In some context I might want to distinguish between 
those two causes of missingness.  But if I assigned special NA values to 
them, then I'd need to develop an algebra of how those two kinds of 
missingness combine in arithmetical operations.  I don't think R should 
build in all of that machinery, because it's hopeless to expect to model 
all the different ideas of missingness people might want to model.

>>> 9. bidirectional pipes in Windows
>>>
>>> 10. Create a log updated at a regular frequency (daily or real time)
>>> that tracks all changes on CRAN, e.g.
>>>
>>>       Date(GMT)           Package Version Action
>>>       2006-09-20 21:22:01 mypkg   1.0.1   new
>>>       2006-09-20 22:00:23 mypkg2  0.2.1   updated
>>>
>>> 11. make integrate generic.  Ryacas could use that.
>>>
>>> 12. Remove all R CMD dependencies on the find.exe command.  find is a built
>>>     in command in Windows and having find.exe on my path causes
>>>     problems with other programs.
>> A simpler fix for this would be for you to define a wrapper for R CMD
>> that installed the R tools path before executing, and uninstalls it
>> afterwards.  But this is unnecessary for most people, because
>> Microsoft's find.exe is pretty rarely used.
>>
> 
> Anyone who uses batch files will use it quite a bit.  It certainly causes
> me problems on an ongoing basis and is an unacceptable conflict in
> my opinion.

If you're using batch files, the fix I suggested is trivial for you.

> I realize that its not entirely of R's doing but it would be best if R did not
> make it worse by requiring the use of find.
> 
>>> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
>>>     apply commands and add a simplify= arg to by.
>> It would have been good not to introduce the inconsistency years ago,
>> but it's too late to change now.
> 
> Its not too late to add it to by().
> 
> Also note that the gsubfn package does have a workaround for this.  In gsubfn
> one can preface any R function with fn$ and if that is done then the function
> can have a simplify= argument which fn$ intercepts and processes.  e.g.
> 
> library(gsubfn)
> fn$by(CO2[4:5], CO2[2], x ~ coef(lm(uptake ~ ., x)), simplify = rbind)
> 
> fn$ can also interpret formulas as functions (and does quasi perl interpolation
> in strings) so the formula in the third argument is regarded to be the same
> as the anonymous function:  function(x) coef(lm(uptake ~., x)) .
> 
> More examples are in the gsubfn vignette.
> 
>>> 14. better reporting of location of errors and warnings in R CMD check.
>> This is in the works, but probably not for 2.5.x.
> 
> Great.  This will be very welcome.
> 
>>> 15. tcl tile library (needs tcl 8.5 or to be compiled in with 8.4)
>>>
>>> 16. extend aggregate to allow vector valued functions:
>>>     aggregate(CO2[4:5], CO2[1:2], function(x) c(mean = mean(x), sd = sd(x)))
>>>     [summaryBy in doBy package and cast in reshape package can already
>>>     do similar things but this seems sufficiently fundamental that it
>>>     ought to be in the base of R]
>>>
>>> 17. All OSes should support input= arg of system.
>>>
>>> My previous New Year wishlists are here:
>>>
>>> https://www.stat.math.ethz.ch/pipermail/r-devel/2006-January/035949.html
>>> https://www.stat.math.ethz.ch/pipermail/r-help/2005-January/061984.html
>>> https://www.stat.math.ethz.ch/pipermail/r-devel/2004-January/028465.html
>> To anyone still reading:
>>
>> Many of the suggestions above would improve R, but they're unlikely to
>> happen unless someone volunteers to do them.  I'd suggest picking
>> whichever one of these or some other list that you think is the highest
>> priority, and post a specific proposal to this list about how to do it.
>>  If you get a negative response or no response, move on to the next
>> one, or put it into a contributed package instead.
>>
> 
> I think it works best when contributors develop their software in
> contributed packages since it avoids squabbles with the core group.
> 
> The core group can then integrate these into R itself if it seems warranted.
> 
>> When you make the proposal, consider how much work you're asking other
>> people to do, and how much you're volunteering to do yourself.  If
>> you're asking others to do a lot, then the suggestion had better be
>> really valuable to *them*.
>>
> 
> The implementation effort should not be a significant consideration in
> generating wish lists.    What should be considered is what is really needed.
> Its better to know what you need and then later decide whether to implement
> it or not than to suppress articulating the need.  Otherwise the development
> is driven by what is easy to do rather than what is needed.

I'm not complaining about your wish list, just suggesting what people 
should do next if they want to see any of these items (or others) 
implemented.

Duncan Murdoch


From ggrothendieck at gmail.com  Tue Jan  2 01:17:55 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 1 Jan 2007 19:17:55 -0500
Subject: [Rd] Wish list
In-Reply-To: <45999EF7.4070706@stats.uwo.ca>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45993282.7030409@stats.uwo.ca>
	<971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>
	<45999EF7.4070706@stats.uwo.ca>
Message-ID: <971536df0701011617g7dfaac5bx137b67e304afdeb2@mail.gmail.com>

> > Anyone who uses batch files will use it quite a bit.  It certainly causes
> > me problems on an ongoing basis and is an unacceptable conflict in
> > my opinion.
>
> If you're using batch files, the fix I suggested is trivial for you.

The batch files could come from other programs you
are using which one does not really want to have
to figure them out and modify them.  In any case,
R should not be written in
a way which conflicts with system utilities.


From murdoch at stats.uwo.ca  Tue Jan  2 01:32:29 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 01 Jan 2007 19:32:29 -0500
Subject: [Rd] Wish list
In-Reply-To: <Pine.LNX.4.64.0701010946250.6276@tajo.ucsd.edu>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45993282.7030409@stats.uwo.ca>
	<Pine.LNX.4.64.0701010946250.6276@tajo.ucsd.edu>
Message-ID: <4599A81D.6050202@stats.uwo.ca>

On 1/1/2007 12:59 PM, Charles C. Berry wrote:
> On Mon, 1 Jan 2007, Duncan Murdoch wrote:
> 
>> A few comments thrown in, and some general comments at the bottom.
>>
>> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
>>> This is my 2007 New Year wishlist for R features:
>>>
>>> 1. [deleted thru 12]
> 
>>> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
>>>     apply commands and add a simplify= arg to by.
>> It would have been good not to introduce the inconsistency years ago,
>> but it's too late to change now.
>>
> 
> Really? The consistency issue only concerns mapply, I think.

mapply and its wrapper Vectorize, and perhaps some functions in 
contributed packages.

> 
> How 'bout changing the formals of mapply to
> 
> $FUN
> 
> 
> $...
> 
> 
> $MoreArgs
> NULL
> 
> $SIMPLIFY
> simplify
> 
> $USE.NAMES
> [1] TRUE
> 
> $simplify
> [1] TRUE
> 
> i.e. add simplify = TRUE and change SIMPLIFY's default to 'simplify'
> 
> Then the default behavior is retained, specifying a value for 
> either SIMPLIFY or simplify gives the desired behavior and SIMPLIFY takes 
> precedence over simplify if both are given values. Not pretty, perhaps, 
> but it does the job.

This allows mapply(..., simplify=TRUE), but is that really "the job"?  I 
think the point of consistency is to make code easier to read and write, 
and I'm not sure making this one parameter partially case-insensitive 
achieves that.  Should the same thing be done to the functions that 
currently use "simplify", to achieve even more consistency?  Yecch.

> I suppose this could get one into trouble if one of the ... args is named 
> 'simplify', but I do not imagine that is a big deal.

I think the reasoning behind the choice of SIMPLIFY was probably to 
avoid a clash with one of the ... args.

I'd prefer a more general solution to this problem, like what the Mac 
GUI does, and giving argument hints as a function call is being typed. 
(I think ESS may do this too, but I don't use it.)  There are lots of 
inconsistencies in R functions, and I think making the syntax looser in 
order to accept a consistent superset is not the right approach: 
instead, the editor should make it easier for a user to discover what is 
appropriate in any given context.

Duncan Murdoch


From murdoch at stats.uwo.ca  Tue Jan  2 01:40:50 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 01 Jan 2007 19:40:50 -0500
Subject: [Rd] Wish list
In-Reply-To: <971536df0701011617g7dfaac5bx137b67e304afdeb2@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>	<45993282.7030409@stats.uwo.ca>	<971536df0701011010n79989438i3ee33f5030f0687a@mail.gmail.com>	<45999EF7.4070706@stats.uwo.ca>
	<971536df0701011617g7dfaac5bx137b67e304afdeb2@mail.gmail.com>
Message-ID: <4599AA12.9000000@stats.uwo.ca>

On 1/1/2007 7:17 PM, Gabor Grothendieck wrote:
>>> Anyone who uses batch files will use it quite a bit.  It certainly causes
>>> me problems on an ongoing basis and is an unacceptable conflict in
>>> my opinion.
>> If you're using batch files, the fix I suggested is trivial for you.
> 
> The batch files could come from other programs you
> are using which one does not really want to have
> to figure them out and modify them.  

You don't need to modify any other batch files, you just need to create 
a new batch file named "R.bat" as a wrapper for R.  I forget batch file 
syntax, so I'm sure this is wrong, but it would look something like this:

SAVEPATH=%PATH%
PATH=Rtools\bin;R\bin;...
R %1 %2 ...
PATH=%SAVEPATH%

 > In any case,
 > R should not be written in
 > a way which conflicts with system utilities.

I'd guess the "find" that R uses predates the one that Microsoft 
invented.  Think of the R toolset as an attempt to correct the mistakes 
that Microsoft made, by making the environment more Unix-like.

Duncan Murdoch


From duncan at wald.ucdavis.edu  Tue Jan  2 02:15:02 2007
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Mon, 1 Jan 2007 17:15:02 -0800
Subject: [Rd] Connections to https: URLs -- IE expert help needed
In-Reply-To: <17817.33808.900582.330470@mithrandir.hornik.net>
References: <Pine.LNX.4.64.0612201725400.12201@gannet.stats.ox.ac.uk>
	<4589B4E1.8090102@wald.ucdavis.edu>
	<17817.33808.900582.330470@mithrandir.hornik.net>
Message-ID: <20070102011502.GE27570@wald.ucdavis.edu>

Kurt Hornik wrote:
> >>>>> Duncan Temple Lang writes:
> 
> > -----BEGIN PGP SIGNED MESSAGE-----
> > Hash: SHA1
> 
> > Prof Brian Ripley wrote:
> >> I've added to R-devel the ability to use download.file() and url() to 
> >> https: URLs, *only* if --internet2 is used on Windows.
> >> 
> >> This uses the Internet Explorer internals, and only works if the 
> >> certificate is accepted (so e.g. does not work for 
> >> https://svn.r-project.org).
> >> 
> >> Now I use IE (and Windows for that matter) only when really necessary, and 
> >> Firefox has simple ways to permanently accept non-verifiable certificates. 
> >> I would be grateful if someone who is much more familiar with IE could 
> >> write a note explaining how to deal with this that we could add to the 
> >> rw-FAQ.
> >> 
> >> To forestall the inevitable question: there are no plans to add https: 
> >> support on any other platform, but it is something that would make a nice 
> >> project for a user contribution.  The current internal code is based on 
> >> likxml2, and that AFAICS still does not have https: support.
> >> 
> 
> > Generally (i.e. not in particular response to Brian but related to
> > this thread)
> 
> With a similar disclaimer: Brian's efforts were triggered by me asking
> how to use url() to read R's mailing list archive files, such as
> 
>   https://stat.ethz.ch/pipermail/r-help/2007-January.txt.gz
> 
> directly into R.  Turns out we cannot ... which, in a way, is a shame
> ("R cannot read its own web pages") :-(

Indeed, it is a shame.  Although, when I process mail messages,
I use Perl's very rich collection of modules for processing
mail in so many different formats. And then I use RSPerl
to control this and get the data into R pretty quickly.
So we can do it in R and probably the delegation to 
mail-processing software is a good given the number of special
cases, etc.

And even if we had HTTPs in R, we would still want to deal with
the certificate on that page, which gets us to more details.
Which is the reason I think leaving things to libcurl,
libwww, etc. will be best as they continue to evolve
to handle new protocols and settings.

 D.

> 
> Best
> -k
> 
> > An alternative is to use RCurl and leave HTTPS and a host of other
> > protocols and details to an external library (e.g. libcurl, libwww,
> > etc.) and an R package that interfaces to it.
> 
> > If we want the facilities to be accessible via the connections
> > interface, then we can make that API extensible by packages.  Jeff
> > Horner has a proposal on that.
> 
> > Generally, it is important if R is to continue to evolve that the R
> > internals become extensible by package developers so that we can do
> > some new experiments and provide alternative implementations of the
> > basic structures rather than being tied to the existing
> > representation.  An object oriented framework underlying the R source
> > code would enable this and would solve numerous problems that have
> > arisen recently and I strongly suspect many more that will arise.
> 
> >  D.
> 
> 
> > - --
> > Duncan Temple Lang                    duncan at wald.ucdavis.edu
> > Department of Statistics              work:  (530) 752-4782
> > 4210 Mathematical Sciences Building   fax:   (530) 752-7099
> > One Shields Ave.
> > University of California at Davis
> > Davis,
> > CA 95616,
> > USA
> > -----BEGIN PGP SIGNATURE-----
> > Version: GnuPG v1.4.3 (Darwin)
> 
> > iD8DBQFFibTh9p/Jzwa2QP4RAgBiAJ9YojjDf0DMIo9FQ7yW1MiMdANvogCfRgCX
> > zci7UsavJESdidbyiCl2Xgw=
> > =HiuE
> > -----END PGP SIGNATURE-----
> 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Duncan Temple Lang                duncan at wald.ucdavis.edu
Department of Statistics          work:  (530) 752-4782
4210 Mathematical Sciences Bldg.  fax:   (530) 752-7099
One Shields Ave.
University of California at Davis
Davis, CA 95616, USA



-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20070101/9924d296/attachment.bin 

From murdoch at stats.uwo.ca  Tue Jan  2 02:44:40 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 01 Jan 2007 20:44:40 -0500
Subject: [Rd] Wish list
In-Reply-To: <59d7961d0701011735l187466c2v60a32576f35ef2e3@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>	
	<45993282.7030409@stats.uwo.ca>	
	<Pine.LNX.4.64.0701010946250.6276@tajo.ucsd.edu>	
	<4599A81D.6050202@stats.uwo.ca>
	<59d7961d0701011735l187466c2v60a32576f35ef2e3@mail.gmail.com>
Message-ID: <4599B908.3060509@stats.uwo.ca>

Henrik Bengtsson wrote:
> On 1/2/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>   
>> On 1/1/2007 12:59 PM, Charles C. Berry wrote:
>>     
>>> On Mon, 1 Jan 2007, Duncan Murdoch wrote:
>>>
>>>       
>>>> A few comments thrown in, and some general comments at the bottom.
>>>>
>>>> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
>>>>         
>>>>> This is my 2007 New Year wishlist for R features:
>>>>>
>>>>> 1. [deleted thru 12]
>>>>>           
>>>>> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
>>>>>     apply commands and add a simplify= arg to by.
>>>>>           
>>>> It would have been good not to introduce the inconsistency years ago,
>>>> but it's too late to change now.
>>>>
>>>>         
>>> Really? The consistency issue only concerns mapply, I think.
>>>       
>> mapply and its wrapper Vectorize, and perhaps some functions in
>> contributed packages.
>>
>>     
>>> How 'bout changing the formals of mapply to
>>>
>>> $FUN
>>>
>>>
>>> $...
>>>
>>>
>>> $MoreArgs
>>> NULL
>>>
>>> $SIMPLIFY
>>> simplify
>>>
>>> $USE.NAMES
>>> [1] TRUE
>>>
>>> $simplify
>>> [1] TRUE
>>>
>>> i.e. add simplify = TRUE and change SIMPLIFY's default to 'simplify'
>>>
>>> Then the default behavior is retained, specifying a value for
>>> either SIMPLIFY or simplify gives the desired behavior and SIMPLIFY takes
>>> precedence over simplify if both are given values. Not pretty, perhaps,
>>> but it does the job.
>>>       
>> This allows mapply(..., simplify=TRUE), but is that really "the job"?  I
>> think the point of consistency is to make code easier to read and write,
>> and I'm not sure making this one parameter partially case-insensitive
>> achieves that.  Should the same thing be done to the functions that
>> currently use "simplify", to achieve even more consistency?  Yecch.
>>     
>
> Given that you want to take the step to change/remove an argument, I
> think this is a good strategy; first provide a backward compatible API
> and announce that the original argument is deprecated, and then when
> everyone had a chance to update and test dependent code, you can
> safely remove the argument.
>   
Given that premise, and with the addition that at some point in the 
process using the obsolete parameter would generate a warning, I'd agree. 

But I don't see that the value of the change *in this particular case* 
is worth the effort.

Duncan Murdoch


> My $.02
>
> Henrik
>
>   
>>> I suppose this could get one into trouble if one of the ... args is named
>>> 'simplify', but I do not imagine that is a big deal.
>>>       
>> I think the reasoning behind the choice of SIMPLIFY was probably to
>> avoid a clash with one of the ... args.
>>
>> I'd prefer a more general solution to this problem, like what the Mac
>> GUI does, and giving argument hints as a function call is being typed.
>> (I think ESS may do this too, but I don't use it.)  There are lots of
>> inconsistencies in R functions, and I think making the syntax looser in
>> order to accept a consistent superset is not the right approach:
>> instead, the editor should make it easier for a user to discover what is
>> appropriate in any given context.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>


From phgrosjean at sciviews.org  Tue Jan  2 08:07:36 2007
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Tue, 02 Jan 2007 08:07:36 +0100
Subject: [Rd] Wish list
In-Reply-To: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
Message-ID: <459A04B8.1040404@sciviews.org>



Gabor Grothendieck wrote:
> This is my 2007 New Year wishlist for R features:
> 

[Wishes 1-14 deleted from this message]

> 15. tcl tile library (needs tcl 8.5 or to be compiled in with 8.4)

Well, there is tcltk2 on CRAN that provides this. Currently, it is for 
Windows only, but the limitation is really because the package provides 
tile as a Windows binary (so that it works and uses the adequate tile 
version for this R package under Windows). I should rework this and 
simply tell in the package help that tile must be installed manually on 
other platforms.

Note that L am currently reworking tcltk2, so that change will be 
available... in the couple next months.

Best wishes for 2007,

Philippe Grosjean

> 16. extend aggregate to allow vector valued functions:
>     aggregate(CO2[4:5], CO2[1:2], function(x) c(mean = mean(x), sd = sd(x)))
>     [summaryBy in doBy package and cast in reshape package can already
>     do similar things but this seems sufficiently fundamental that it
>     ought to be in the base of R]
> 
> 17. All OSes should support input= arg of system.
> 
> My previous New Year wishlists are here:
> 
> https://www.stat.math.ethz.ch/pipermail/r-devel/2006-January/035949.html
> https://www.stat.math.ethz.ch/pipermail/r-help/2005-January/061984.html
> https://www.stat.math.ethz.ch/pipermail/r-devel/2004-January/028465.html
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hb at stat.berkeley.edu  Tue Jan  2 02:35:18 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Tue, 2 Jan 2007 12:35:18 +1100
Subject: [Rd] Wish list
In-Reply-To: <4599A81D.6050202@stats.uwo.ca>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45993282.7030409@stats.uwo.ca>
	<Pine.LNX.4.64.0701010946250.6276@tajo.ucsd.edu>
	<4599A81D.6050202@stats.uwo.ca>
Message-ID: <59d7961d0701011735l187466c2v60a32576f35ef2e3@mail.gmail.com>

On 1/2/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 1/1/2007 12:59 PM, Charles C. Berry wrote:
> > On Mon, 1 Jan 2007, Duncan Murdoch wrote:
> >
> >> A few comments thrown in, and some general comments at the bottom.
> >>
> >> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
> >>> This is my 2007 New Year wishlist for R features:
> >>>
> >>> 1. [deleted thru 12]
> >
> >>> 13. Make upper/lower case of simplify/SIMPLIFY consistent on all
> >>>     apply commands and add a simplify= arg to by.
> >> It would have been good not to introduce the inconsistency years ago,
> >> but it's too late to change now.
> >>
> >
> > Really? The consistency issue only concerns mapply, I think.
>
> mapply and its wrapper Vectorize, and perhaps some functions in
> contributed packages.
>
> >
> > How 'bout changing the formals of mapply to
> >
> > $FUN
> >
> >
> > $...
> >
> >
> > $MoreArgs
> > NULL
> >
> > $SIMPLIFY
> > simplify
> >
> > $USE.NAMES
> > [1] TRUE
> >
> > $simplify
> > [1] TRUE
> >
> > i.e. add simplify = TRUE and change SIMPLIFY's default to 'simplify'
> >
> > Then the default behavior is retained, specifying a value for
> > either SIMPLIFY or simplify gives the desired behavior and SIMPLIFY takes
> > precedence over simplify if both are given values. Not pretty, perhaps,
> > but it does the job.
>
> This allows mapply(..., simplify=TRUE), but is that really "the job"?  I
> think the point of consistency is to make code easier to read and write,
> and I'm not sure making this one parameter partially case-insensitive
> achieves that.  Should the same thing be done to the functions that
> currently use "simplify", to achieve even more consistency?  Yecch.

Given that you want to take the step to change/remove an argument, I
think this is a good strategy; first provide a backward compatible API
and announce that the original argument is deprecated, and then when
everyone had a chance to update and test dependent code, you can
safely remove the argument.

My $.02

Henrik

>
> > I suppose this could get one into trouble if one of the ... args is named
> > 'simplify', but I do not imagine that is a big deal.
>
> I think the reasoning behind the choice of SIMPLIFY was probably to
> avoid a clash with one of the ... args.
>
> I'd prefer a more general solution to this problem, like what the Mac
> GUI does, and giving argument hints as a function call is being typed.
> (I think ESS may do this too, but I don't use it.)  There are lots of
> inconsistencies in R functions, and I think making the syntax looser in
> order to accept a consistent superset is not the right approach:
> instead, the editor should make it easier for a user to discover what is
> appropriate in any given context.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ivo_welch at brown.edu  Tue Jan  2 16:42:24 2007
From: ivo_welch at brown.edu (ivo welch)
Date: Tue, 02 Jan 2007 10:42:24 -0500
Subject: [Rd] proposal: allowing alternative variance estimators in glm/lm
Message-ID: <459A7D60.9010905@brown.edu>


Dear Brian / Thomas:

May I suggest a "cheap" and amateurish solution, obviously without much
knowledge or intelligence about the subject?

As a non-statistician user of R, maybe a hook functionality at strategic
places could provide some flexibility without too much pain.   I think
replacing the standard output from summary.lm would be a bad idea (it
could easily create errors downstream, when idiots like myself ask "why
don't I get the s.e. that stata produces?  duh---you loaded
heteroskedasticity adjustment, but forgot about it).  But I think some
flexibility to add more information would be a very good thing. 

Hooks that can be set by functions (perhaps cascades) would allow third
parties to create additional statistics, that could survive future
changes to the functions themselves, without requiring a full object
paradigm.   For example, summary.lm could provide two hooks that allow
programmers to chain my own objects to either the ans$coefficients and
the ans object.  (I guess even one hook would do.)  Well-thought-out
hooks could also add to print methods, etc., without requiring complete
function rewrites, and would survive future changes in the real R code
itself.

>From the perspective of a first-time amateurish end-user, an invokation
of "library(lm.addnormalized)" could then magically always add a
normalized coefficient to the coefficient output.  An invokation of
"library(lm.addheteroskedasticity)" could magically always add
heteroskedasticity se's and T-stats.  And so on.


As I said, I don't know what I am talking about.  I am really a
non-statistician end-user, who is really a bit over his head with all of
this---I am using R not because it is sensible given my needs and
abilities, but because I am in awe by many of its capabilities ( and
because I enjoy Brian berating me while he offers me usually desparately
needed help ;-) ).

Regards,

/ivo


From tlumley at u.washington.edu  Tue Jan  2 19:03:02 2007
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue, 2 Jan 2007 10:03:02 -0800 (PST)
Subject: [Rd] proposal: allowing alternative variance estimators in
	glm/lm
In-Reply-To: <459A7D60.9010905@brown.edu>
References: <459A7D60.9010905@brown.edu>
Message-ID: <Pine.LNX.4.64.0701020914560.18859@homer23.u.washington.edu>

On Tue, 2 Jan 2007, ivo welch wrote:
>
> As a non-statistician user of R, maybe a hook functionality at strategic
> places could provide some flexibility without too much pain.   I think
> replacing the standard output from summary.lm would be a bad idea (it
> could easily create errors downstream, when idiots like myself ask "why
> don't I get the s.e. that stata produces?  duh---you loaded
> heteroskedasticity adjustment, but forgot about it).  But I think some
> flexibility to add more information would be a very good thing.
>
> Hooks that can be set by functions (perhaps cascades) would allow third
> parties to create additional statistics, that could survive future
> changes to the functions themselves, without requiring a full object
> paradigm.   For example, summary.lm could provide two hooks that allow
> programmers to chain my own objects to either the ans$coefficients and
> the ans object.  (I guess even one hook would do.)  Well-thought-out
> hooks could also add to print methods, etc., without requiring complete
> function rewrites, and would survive future changes in the real R code
> itself.

In some sense this is what I was proposing -- I think that summary.lm and 
predict.lm should get coefficients from coef() and variance matrices from 
vcov() to provide hooks.

This should ideally happen automatically by inheritance, but for 
historical reasons all the basic code was written for the most specialized 
case (classical linear model) rather than the most general case.

>> From the perspective of a first-time amateurish end-user, an invokation
> of "library(lm.addnormalized)" could then magically always add a
> normalized coefficient to the coefficient output.  An invokation of
> "library(lm.addheteroskedasticity)" could magically always add
> heteroskedasticity se's and T-stats.  And so on.

Ick.

I really think you want these properties to be part of the object, not 
global options (and particularly not global options set by the library() 
function).  It should be possible to simultaneously have objects that 
use the fisher-information standard errors and other objects that use 
sandwich estimators.

I would say that "using sandwich standard errors" is a property that 
should be specified when the object is created (as it is for 
survival::coxph()  and gee::gee()).

"Displaying normalized coefficients" is a bit different.  I don't think 
you want to override what the coef() method produces, since that will mess 
up fitted values and predictions. You would also need to override the 
vcov() method, and that would cause other problems.

So in order to do what you want, the objects would need a printedcoef() 
and printedSE() method in addition to the actual coef() and vcov(). These 
would have to be called by a summary-like function.  But even this isn't 
the level of generality that you would want, since if you are doing this 
work it would be nice to allow transformed coefficients (eg odds ratios 
rather than log odds ratios for logistic regression), and you probably 
then need a printedCI() method for confidence intervals.  This would give 
quite a useful modelsummary() function (provided it did something 
sensible when the additional methods weren't present).   The Design 
package does things along these lines already, but its display functions 
don't work on vanilla model objects.

In any case, I don't think this function should be called summary.lm(). My 
proposal was just to allow predict.lm and summary.lm to be used in cases 
where they already give the right sort of results and in addition to tidy 
up the duplication of variance-matrix code.

 	-thomas


From ross at biostat.ucsf.edu  Tue Jan  2 23:08:57 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Tue, 02 Jan 2007 14:08:57 -0800
Subject: [Rd] Am I missing something about debugging?
Message-ID: <1167775737.21960.49.camel@iron.psg.net>

I would like to be able to trace execution into calls below the current
function, or to follow execution as calls return.  This is roughly the
distinction between "step" and "next" in many debuggers.

I would also like to be able to switch to a location further up the call
stack than the location at which I enter the debugger, to see the
context of the current operations.

Are there ways to do these things with the R debugger?  I've studied the
man pages and FAQ's, and looked at the debug package, but I don't see a
way except for manually calling debug on the function that is about to
be called if I want to descend.  That's quite awkward, particularly
since it must be manually undone (the debug package may be better on
that score).  I'm also not entirely sure that such recursion
(essentially, debugging within the debugger) is OK.

I tried looking up the stack with things like sys.calls(), from within
the browser, but they operated as if I were at the top level (e.g.,
sys.function(-1) gets an error that it can't go there).  I was doing
this in ess, and there's some chance the "can't write .Last.value" error
(wording approximate) cause by having an old version is screwing things
up).

Since R is interpreted I would expect debugging to be a snap, but these
limitations make me suspect there is something about the language design
that makes implementing these facilities hard.  For example, the browser
as documented in the Green book has up and down functions to change the
frame (p. 265); these are conspicuously absent in R.
-- 
Ross Boylan                                      wk:  (415) 514-8146
185 Berry St #5700                               ross at biostat.ucsf.edu
Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
University of California, San Francisco
San Francisco, CA 94107-1739                     hm:  (415) 550-1062


From murdoch at stats.uwo.ca  Tue Jan  2 23:24:35 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 02 Jan 2007 17:24:35 -0500
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <1167775737.21960.49.camel@iron.psg.net>
References: <1167775737.21960.49.camel@iron.psg.net>
Message-ID: <459ADBA3.6050800@stats.uwo.ca>

I don't think you're missing anything with the debug() function. It 
needs updating.

I don't think there's any structural reason why you shouldn't be able to 
do the things you're talking about in R, but they haven't been 
implemented.

Mark Bravington put together a package (called debug) that does more 
than debug() does, but I haven't used it much, and I don't know if it 
does what you want.

I recently added things to the R parser to keep track of connections 
between R code and source files; that was partly meant as a first step 
towards improving the debugging facilities.  I'd be happy to help anyone 
who wants to do the hard work, but I don't think I'll be able to work on 
it before next summer.  (If you do decide to work on it, please let me 
know, just in case I do get a chance:  no point duplicating effort.)

Duncan Murdoch

On 1/2/2007 5:08 PM, Ross Boylan wrote:
> I would like to be able to trace execution into calls below the current
> function, or to follow execution as calls return.  This is roughly the
> distinction between "step" and "next" in many debuggers.
> 
> I would also like to be able to switch to a location further up the call
> stack than the location at which I enter the debugger, to see the
> context of the current operations.
> 
> Are there ways to do these things with the R debugger?  I've studied the
> man pages and FAQ's, and looked at the debug package, but I don't see a
> way except for manually calling debug on the function that is about to
> be called if I want to descend.  That's quite awkward, particularly
> since it must be manually undone (the debug package may be better on
> that score).  I'm also not entirely sure that such recursion
> (essentially, debugging within the debugger) is OK.
> 
> I tried looking up the stack with things like sys.calls(), from within
> the browser, but they operated as if I were at the top level (e.g.,
> sys.function(-1) gets an error that it can't go there).  I was doing
> this in ess, and there's some chance the "can't write .Last.value" error
> (wording approximate) cause by having an old version is screwing things
> up).
> 
> Since R is interpreted I would expect debugging to be a snap, but these
> limitations make me suspect there is something about the language design
> that makes implementing these facilities hard.  For example, the browser
> as documented in the Green book has up and down functions to change the
> frame (p. 265); these are conspicuously absent in R.


From ross at biostat.ucsf.edu  Tue Jan  2 23:46:06 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Tue, 02 Jan 2007 14:46:06 -0800
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <459ADBA3.6050800@stats.uwo.ca>
References: <1167775737.21960.49.camel@iron.psg.net>
	<459ADBA3.6050800@stats.uwo.ca>
Message-ID: <1167777966.21960.58.camel@iron.psg.net>

On Tue, 2007-01-02 at 17:24 -0500, Duncan Murdoch wrote:
> I don't think you're missing anything with the debug() function. It 
> needs updating.
Bummer!
> 
> I don't think there's any structural reason why you shouldn't be able to 
> do the things you're talking about in R, but they haven't been 
> implemented.
> 
That's good to know.  I was wondering if the lexical scoping was
complicating things.  At least the way I think of it, every call has two
sets of (potentially) nested environments: the lexical scopes of the
function definition and the dynamic scopes of the call.  But since the
dynamic scopes are available, using them seems possible.

> Mark Bravington put together a package (called debug) that does more 
> than debug() does, but I haven't used it much, and I don't know if it 
> does what you want.
> 
It looked to me as if it was some help, but no advance on the
investigating dynamic frames front.

> I recently added things to the R parser to keep track of connections 
> between R code and source files; that was partly meant as a first step 
> towards improving the debugging facilities.  I'd be happy to help anyone 
> who wants to do the hard work, but I don't think I'll be able to work on 
> it before next summer.  (If you do decide to work on it, please let me 
> know, just in case I do get a chance:  no point duplicating effort.)
I didn't even realize such a facility was needed, which shows how much I
know!  Working on the debugger is probably not in my job description,
unless I get really annoyed.

The smalltalk debugger is the standard by which I judge all others; it's
just amazing.  You can go up and down the stack, graphically examine
variables (and follow links), and change code in the middle of debugging
and then continue.

Ross


From murdoch at stats.uwo.ca  Wed Jan  3 00:44:22 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 02 Jan 2007 18:44:22 -0500
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <1167777966.21960.58.camel@iron.psg.net>
References: <1167775737.21960.49.camel@iron.psg.net>	
	<459ADBA3.6050800@stats.uwo.ca>
	<1167777966.21960.58.camel@iron.psg.net>
Message-ID: <459AEE56.9000503@stats.uwo.ca>

On 1/2/2007 5:46 PM, Ross Boylan wrote:
> On Tue, 2007-01-02 at 17:24 -0500, Duncan Murdoch wrote:
>> I don't think you're missing anything with the debug() function. It 
>> needs updating.
> Bummer!
>> I don't think there's any structural reason why you shouldn't be able to 
>> do the things you're talking about in R, but they haven't been 
>> implemented.
>>
> That's good to know.  I was wondering if the lexical scoping was
> complicating things.  At least the way I think of it, every call has two
> sets of (potentially) nested environments: the lexical scopes of the
> function definition and the dynamic scopes of the call.  But since the
> dynamic scopes are available, using them seems possible.

I wouldn't call the dynamic scopes "nested", more like "chained".  If a 
search fails in one of them, it never looks in the next one:  only the 
lexical scope nesting does that.
> 
>> Mark Bravington put together a package (called debug) that does more 
>> than debug() does, but I haven't used it much, and I don't know if it 
>> does what you want.
>>
> It looked to me as if it was some help, but no advance on the
> investigating dynamic frames front.
> 
>> I recently added things to the R parser to keep track of connections 
>> between R code and source files; that was partly meant as a first step 
>> towards improving the debugging facilities.  I'd be happy to help anyone 
>> who wants to do the hard work, but I don't think I'll be able to work on 
>> it before next summer.  (If you do decide to work on it, please let me 
>> know, just in case I do get a chance:  no point duplicating effort.)
> I didn't even realize such a facility was needed, which shows how much I
> know!  Working on the debugger is probably not in my job description,
> unless I get really annoyed.
> 
> The smalltalk debugger is the standard by which I judge all others; it's
> just amazing.  You can go up and down the stack, graphically examine
> variables (and follow links), and change code in the middle of debugging
> and then continue.

Everything except the "change code" part is pretty standard in a modern 
debugger; I'd hope an R debugger could do them.  An interpreter like R 
could allow changes, but I'm not sure what the user interface would look 
like...

Duncan Murdoch


From ross at biostat.ucsf.edu  Wed Jan  3 01:29:43 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Tue, 02 Jan 2007 16:29:43 -0800
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <459AEE56.9000503@stats.uwo.ca>
References: <1167775737.21960.49.camel@iron.psg.net>
	<459ADBA3.6050800@stats.uwo.ca>
	<1167777966.21960.58.camel@iron.psg.net>
	<459AEE56.9000503@stats.uwo.ca>
Message-ID: <1167784183.21960.99.camel@iron.psg.net>

On Tue, 2007-01-02 at 18:44 -0500, Duncan Murdoch wrote:
> On 1/2/2007 5:46 PM, Ross Boylan wrote:
.... 
> > The smalltalk debugger is the standard by which I judge all others; it's
> > just amazing.  You can go up and down the stack, graphically examine
> > variables (and follow links), and change code in the middle of debugging
> > and then continue.
> 
> Everything except the "change code" part is pretty standard in a modern 
> debugger; I'd hope an R debugger could do them.  An interpreter like R 
> could allow changes, but I'm not sure what the user interface would look 
> like...
> 
> Duncan Murdoch
At least in MS Visual C++ a few years ago and gdb today, data tend not
to be presented in immediately digestible form.  For a list or vector,
one gets the pointers and counts in the header, rather than the list
itself (and then if the objects are themselves complex (e.g.,
std::string!), you have the problem of seeing bits rather than semantics
recursively).  And I think neither put you inside an environment in
which you can do general operations in the language, such as invoking
methods on objects.  The R browser already has that last feature.  And I
see I left it out of my original list, which was focused more on stuff
not in the R debugger.  Interactive function invocation immediately
allows friendlier presentation, since one can print or show any object
in the browser (print or show being among the methods one can invoke).

I think ddd lets you graphically navigate your data.

Visual C++ and maybe gdb/gcc are also moving to providing "edit and
continue" functionality in which you can change code and
recompile/relink on the fly.  It's kind of brittle; for example if you
change the object layout or really anything in the ABI, you can edit
but you can't continue.

In contrast, smalltalk is pretty good about even such tough cases as
redefining the slots (in R's lingo) of a class.  For methods, if you are
in c, called from b, called from a, and you redefine b, the debugger
won't let you continue in b or c, but it will allow you to restart b and
continue from there.  And if you stopped in b, you're free to redefine c
and then continue the execution, which will go into the new c code
(oops, a function named "c" written in smalltalk).
-- 
Ross Boylan                                      wk:  (415) 514-8146
185 Berry St #5700                               ross at biostat.ucsf.edu
Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
University of California, San Francisco
San Francisco, CA 94107-1739                     hm:  (415) 550-1062


From ellis at stat.harvard.edu  Wed Jan  3 02:06:06 2007
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Tue, 2 Jan 2007 17:06:06 -0800
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <1167784183.21960.99.camel@iron.psg.net>
References: <1167775737.21960.49.camel@iron.psg.net>
	<459ADBA3.6050800@stats.uwo.ca>
	<1167777966.21960.58.camel@iron.psg.net>
	<459AEE56.9000503@stats.uwo.ca>
	<1167784183.21960.99.camel@iron.psg.net>
Message-ID: <7098abec0701021706re570830v577ce66c8234730c@mail.gmail.com>

While a Smalltalk-style debugger would be pretty awesome, I suspect
R's semantics would make restartable exceptions pretty difficult and
R's current implementation would make getting the continuation-like
object you'd need pretty difficult, at least across the range of
platforms supported by R.

A solution, of course, would be to implement R's interpreter in
Smalltalk as a domain-specific language. Vista Smalltalk apparently
hosts a Lisp/Scheme interpreter and I know of at least one Lisp
implementation for Squeak, which serve as pretty good starting points
for an S-like language. :-)

On 1/2/07, Ross Boylan <ross at biostat.ucsf.edu> wrote:
> On Tue, 2007-01-02 at 18:44 -0500, Duncan Murdoch wrote:
> > On 1/2/2007 5:46 PM, Ross Boylan wrote:
> ....
> > > The smalltalk debugger is the standard by which I judge all others; it's
> > > just amazing.  You can go up and down the stack, graphically examine
> > > variables (and follow links), and change code in the middle of debugging
> > > and then continue.
> >
> > Everything except the "change code" part is pretty standard in a modern
> > debugger; I'd hope an R debugger could do them.  An interpreter like R
> > could allow changes, but I'm not sure what the user interface would look
> > like...
> >
> > Duncan Murdoch
> At least in MS Visual C++ a few years ago and gdb today, data tend not
> to be presented in immediately digestible form.  For a list or vector,
> one gets the pointers and counts in the header, rather than the list
> itself (and then if the objects are themselves complex (e.g.,
> std::string!), you have the problem of seeing bits rather than semantics
> recursively).  And I think neither put you inside an environment in
> which you can do general operations in the language, such as invoking
> methods on objects.  The R browser already has that last feature.  And I
> see I left it out of my original list, which was focused more on stuff
> not in the R debugger.  Interactive function invocation immediately
> allows friendlier presentation, since one can print or show any object
> in the browser (print or show being among the methods one can invoke).
>
> I think ddd lets you graphically navigate your data.
>
> Visual C++ and maybe gdb/gcc are also moving to providing "edit and
> continue" functionality in which you can change code and
> recompile/relink on the fly.  It's kind of brittle; for example if you
> change the object layout or really anything in the ABI, you can edit
> but you can't continue.
>
> In contrast, smalltalk is pretty good about even such tough cases as
> redefining the slots (in R's lingo) of a class.  For methods, if you are
> in c, called from b, called from a, and you redefine b, the debugger
> won't let you continue in b or c, but it will allow you to restart b and
> continue from there.  And if you stopped in b, you're free to redefine c
> and then continue the execution, which will go into the new c code
> (oops, a function named "c" written in smalltalk).
> --
> Ross Boylan                                      wk:  (415) 514-8146
> 185 Berry St #5700                               ross at biostat.ucsf.edu
> Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
> University of California, San Francisco
> San Francisco, CA 94107-1739                     hm:  (415) 550-1062
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From S.J.Eglen at damtp.cam.ac.uk  Tue Jan  2 17:27:05 2007
From: S.J.Eglen at damtp.cam.ac.uk (S.J.Eglen at damtp.cam.ac.uk)
Date: Tue,  2 Jan 2007 17:27:05 +0100 (CET)
Subject: [Rd] Typos in TclInterface.Rd (PR#9436)
Message-ID: <20070102162705.78E3F49FE4@slim.kubism.ku.dk>

Some typos in TclInferface.Rd

line 192: SIDE
  \code{tclvalue} function, which can also occur on the left SIE of

line 199: INITIALIZES
  \code{tclArray} creates a new Tcl array and INITALIZES it to the empty

line 221: DISTINCTION
  argument; there are cases where the DISTICTION matters to Tcl,

Stephen
--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 4.1
 year = 2006
 month = 12
 day = 18
 svn rev = 40228
 language = R
 version.string = R version 2.4.1 (2006-12-18)

Locale:
C

Search Path:
 .GlobalEnv, package:tcltk, package:stats, package:utils, package:datasets, package:graphics, package:grDevices, package:methods, Autoloads, package:base


From tshort at eprisolutions.com  Wed Jan  3 03:28:06 2007
From: tshort at eprisolutions.com (tshort)
Date: Tue, 2 Jan 2007 18:28:06 -0800 (PST)
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <1167775737.21960.49.camel@iron.psg.net>
References: <1167775737.21960.49.camel@iron.psg.net>
Message-ID: <8134920.post@talk.nabble.com>


Rather than using debug, I generally like using recover. When called, it
shows the call stack, and you can pick what to view. Using
option(error=recover) triggers it on errors. You can't step through code as
when using browser(), but I find jumping to different points on the call
stack to be more useful.

- Tom

Tom Short
EPRI



Ross Boylan wrote:
> 
> I would like to be able to trace execution into calls below the current
> function, or to follow execution as calls return.  This is roughly the
> distinction between "step" and "next" in many debuggers.
> 
> I would also like to be able to switch to a location further up the call
> stack than the location at which I enter the debugger, to see the
> context of the current operations.
> 
> Are there ways to do these things with the R debugger?  I've studied the
> man pages and FAQ's, and looked at the debug package, but I don't see a
> way except for manually calling debug on the function that is about to
> be called if I want to descend.  That's quite awkward, particularly
> since it must be manually undone (the debug package may be better on
> that score).  I'm also not entirely sure that such recursion
> (essentially, debugging within the debugger) is OK.
> 
> I tried looking up the stack with things like sys.calls(), from within
> the browser, but they operated as if I were at the top level (e.g.,
> sys.function(-1) gets an error that it can't go there).  I was doing
> this in ess, and there's some chance the "can't write .Last.value" error
> (wording approximate) cause by having an old version is screwing things
> up).
> 
> Since R is interpreted I would expect debugging to be a snap, but these
> limitations make me suspect there is something about the language design
> that makes implementing these facilities hard.  For example, the browser
> as documented in the Green book has up and down functions to change the
> frame (p. 265); these are conspicuously absent in R.
> -- 
> Ross Boylan                                      wk:  (415) 514-8146
> 185 Berry St #5700                               ross at biostat.ucsf.edu
> Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
> University of California, San Francisco
> San Francisco, CA 94107-1739                     hm:  (415) 550-1062
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
View this message in context: http://www.nabble.com/Am-I-missing-something-about-debugging--tf2910389.html#a8134920
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Wed Jan  3 09:16:55 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Jan 2007 08:16:55 +0000 (GMT)
Subject: [Rd] Typos in TclInterface.Rd (PR#9436)
In-Reply-To: <20070102162705.78E3F49FE4@slim.kubism.ku.dk>
References: <20070102162705.78E3F49FE4@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0701030811300.26603@gannet.stats.ox.ac.uk>

If you are going to impose the cost on the developers of a bug report on 
typos, please at least do as we _do_ ask and check the current version, in 
your case at

https://svn.r-project.org/R/trunk/src/library/tcltk/man/TclInterface.Rd

You will I believe want to update your bug report.


On Tue, 2 Jan 2007, S.J.Eglen at damtp.cam.ac.uk wrote:

> Some typos in TclInferface.Rd
>
> line 192: SIDE
>  \code{tclvalue} function, which can also occur on the left SIE of
>
> line 199: INITIALIZES
>  \code{tclArray} creates a new Tcl array and INITALIZES it to the empty
>
> line 221: DISTINCTION
>  argument; there are cases where the DISTICTION matters to Tcl,
>
> Stephen
> --please do not edit the information below--
>
> Version:
> platform = i686-pc-linux-gnu
> arch = i686
> os = linux-gnu
> system = i686, linux-gnu
> status =
> major = 2
> minor = 4.1
> year = 2006
> month = 12
> day = 18
> svn rev = 40228
> language = R
> version.string = R version 2.4.1 (2006-12-18)
>
> Locale:
> C
>
> Search Path:
> .GlobalEnv, package:tcltk, package:stats, package:utils, package:datasets, package:graphics, package:grDevices, package:methods, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From r at erik.prutser.cx  Wed Jan  3 09:47:54 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Wed, 03 Jan 2007 09:47:54 +0100
Subject: [Rd] How to execute R scripts simultaneously from multiple threads
Message-ID: <459B6DBA.3050207@erik.prutser.cx>

Hi All,

My problem is about parallel execution of R-scripts. My platform is linux.

A program that is written in C needs to execute multiple R-scripts 
simultaneously. The C program makes use of multi-threading. Each thread 
must initiate the execution of one script. Performance is very important.

Appearantly the R C-API does not provide a mechanism for parallel 
execution..

It is preferred that the solution is not based on multi-processing (like 
C/S), because that would introduce IPC overhead.

Hopefully some thread-safe (single-proces) solution is readily 
available, written in C.

What is the best solution to do this?

(If there is no single-process solution, what is the alternative?)

Regards,
Erik.
-- 
Shannon's Observation:
	Nothing is so frustrating as a bad situation that is beginning to
	improve.


From r at erik.prutser.cx  Wed Jan  3 09:49:37 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Wed, 03 Jan 2007 09:49:37 +0100
Subject: [Rd] troubles installing SJava for R
Message-ID: <459B6E21.5080002@erik.prutser.cx>

Hello all,

I am using R 2.4.0 and SJava 0.69-0 on linux.

I am not able to install SJava on R. The following errors appear when 
installing:

...
** R
** inst
WARNING: use of install..R is no longer supported
** preparing package for lazy loading
Creating a new generic function for "merge" in "SJava"
** help
 >>> Building/Updating help pages for package 'SJava'
Formats: text html latex example
...

This error appears when I try to load SJava:

...
Type 'q()' to quit R.

 > library(SJava)
Error in dyn.load(x, as.logical(local), as.logical(now)) :
unable to load shared library 
'/usr/local/lib/R/library/SJava/libs/SJava.so':
/usr/local/lib/R/library/SJava/libs/SJava.so: undefined symbol: R_PPStackTop
Error in library(SJava) : .First.lib failed for 'SJava'
 > q()
...

Can anyone please help?

Regards,
Erik
-- 
We are not a clone.


From ripley at stats.ox.ac.uk  Wed Jan  3 10:58:12 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Jan 2007 09:58:12 +0000 (GMT)
Subject: [Rd] troubles installing SJava for R
In-Reply-To: <459B6E21.5080002@erik.prutser.cx>
References: <459B6E21.5080002@erik.prutser.cx>
Message-ID: <Pine.LNX.4.64.0701030935570.29618@gannet.stats.ox.ac.uk>

It seems the version of SJava you used needs updating.  (install.R was 
deprecated long ago, formally so in 2.3.0, and R_PPStackTop was never 
part of the API.)

Please do as the R posting guide asked you to, and contact the maintainer.
(It also asked you not to report on obselete versions of R.)

SJava is part of the Omegahat project, and that has its own mailing list: 
R-devel is not appropriate.


On Wed, 3 Jan 2007, Erik van Zijst wrote:

> Hello all,
>
> I am using R 2.4.0 and SJava 0.69-0 on linux.

'linux' is too vague here.  My guess is that you are using R compiled as a 
shared library using a compiler that support visibility attributes.

> I am not able to install SJava on R. The following errors appear when
> installing:
>
> ...
> ** R
> ** inst
> WARNING: use of install..R is no longer supported
> ** preparing package for lazy loading
> Creating a new generic function for "merge" in "SJava"
> ** help
> >>> Building/Updating help pages for package 'SJava'
> Formats: text html latex example
> ...
>
> This error appears when I try to load SJava:
>
> ...
> Type 'q()' to quit R.
>
> > library(SJava)
> Error in dyn.load(x, as.logical(local), as.logical(now)) :
> unable to load shared library
> '/usr/local/lib/R/library/SJava/libs/SJava.so':
> /usr/local/lib/R/library/SJava/libs/SJava.so: undefined symbol: R_PPStackTop
> Error in library(SJava) : .First.lib failed for 'SJava'
> > q()
> ...
>
> Can anyone please help?
>
> Regards,
> Erik
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From S.J.Eglen at damtp.cam.ac.uk  Wed Jan  3 11:30:42 2007
From: S.J.Eglen at damtp.cam.ac.uk (Stephen Eglen)
Date: Wed, 3 Jan 2007 10:30:42 +0000
Subject: [Rd] Typos in TclInterface.Rd (PR#9436)
In-Reply-To: <Pine.LNX.4.64.0701030811300.26603@gannet.stats.ox.ac.uk>
References: <20070102162705.78E3F49FE4@slim.kubism.ku.dk>
	<Pine.LNX.4.64.0701030811300.26603@gannet.stats.ox.ac.uk>
Message-ID: <17819.34258.567962.55691@notch.damtp.cam.ac.uk>


 > If you are going to impose the cost on the developers of a bug report on 
 > typos, please at least do as we _do_ ask and check the current version, in 
 > your case at
 > 
 > https://svn.r-project.org/R/trunk/src/library/tcltk/man/TclInterface.Rd
 > 
 > You will I believe want to update your bug report.

Thanks, this one still remains (other two already fixed).

 > > line 192: SIDE
 > >  \code{tclvalue} function, which can also occur on the left SIE of

Stephen


From byron.ellis at gmail.com  Wed Jan  3 11:37:15 2007
From: byron.ellis at gmail.com (Byron Ellis)
Date: Wed, 3 Jan 2007 02:37:15 -0800
Subject: [Rd] How to execute R scripts simultaneously from multiple
	threads
In-Reply-To: <459B6DBA.3050207@erik.prutser.cx>
References: <459B6DBA.3050207@erik.prutser.cx>
Message-ID: <7098abec0701030237q3c56a59cx7b0428096d2a535a@mail.gmail.com>

Short Answer: There isn't one.

On 1/3/07, Erik van Zijst <r at erik.prutser.cx> wrote:
> Hi All,
>
> My problem is about parallel execution of R-scripts. My platform is linux.
>
> A program that is written in C needs to execute multiple R-scripts
> simultaneously. The C program makes use of multi-threading. Each thread
> must initiate the execution of one script. Performance is very important.
>
> Appearantly the R C-API does not provide a mechanism for parallel
> execution..
>
> It is preferred that the solution is not based on multi-processing (like
> C/S), because that would introduce IPC overhead.
>
> Hopefully some thread-safe (single-proces) solution is readily
> available, written in C.
>
> What is the best solution to do this?
>
> (If there is no single-process solution, what is the alternative?)
>
> Regards,
> Erik.
> --
> Shannon's Observation:
>         Nothing is so frustrating as a bad situation that is beginning to
>         improve.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From r at erik.prutser.cx  Wed Jan  3 13:00:24 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Wed, 03 Jan 2007 13:00:24 +0100
Subject: [Rd] How to execute R scripts simultaneously from multiple
	threads
In-Reply-To: <7098abec0701030237q3c56a59cx7b0428096d2a535a@mail.gmail.com>
References: <459B6DBA.3050207@erik.prutser.cx>
	<7098abec0701030237q3c56a59cx7b0428096d2a535a@mail.gmail.com>
Message-ID: <459B9AD8.4070208@erik.prutser.cx>

Byron Ellis wrote:
> Short Answer: There isn't one.

I was afraid so. Thanks for confirming.


> On 1/3/07, Erik van Zijst <r at erik.prutser.cx> wrote:
> 
>> Hi All,
>>
>> My problem is about parallel execution of R-scripts. My platform is 
>> linux.
>>
>> A program that is written in C needs to execute multiple R-scripts
>> simultaneously. The C program makes use of multi-threading. Each thread
>> must initiate the execution of one script. Performance is very important.
>>
>> Appearantly the R C-API does not provide a mechanism for parallel
>> execution..
>>
>> It is preferred that the solution is not based on multi-processing (like
>> C/S), because that would introduce IPC overhead.
>>
>> Hopefully some thread-safe (single-proces) solution is readily
>> available, written in C.
>>
>> What is the best solution to do this?
>>
>> (If there is no single-process solution, what is the alternative?)
>>
>> Regards,
>> Erik.
>> -- 
>> Shannon's Observation:
>>         Nothing is so frustrating as a bad situation that is beginning to
>>         improve.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 

-- 
Computers will not be perfected until they can compute how much more
than the estimate the job will cost.


From alfilnegro.sv at gmail.com  Wed Jan  3 18:46:16 2007
From: alfilnegro.sv at gmail.com (Ricardo Rios)
Date: Wed, 3 Jan 2007 11:46:16 -0600
Subject: [Rd] Which programming paradigm is the most used for make R
	packages?
Message-ID: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>

Hi wizards, does somebody know  Which programming paradigm is the most
used for make R packages ? Thanks in advance.

-- 
personal web site:
http://www.geocities.com/ricardo_rios_sv/index.html


From vdergachev at rcgardis.com  Wed Jan  3 19:37:45 2007
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Wed, 3 Jan 2007 13:37:45 -0500
Subject: [Rd] How to execute R scripts simultaneously from multiple
	threads
In-Reply-To: <459B6DBA.3050207@erik.prutser.cx>
References: <459B6DBA.3050207@erik.prutser.cx>
Message-ID: <200701031337.45613.vdergachev@rcgardis.com>

On Wednesday 03 January 2007 3:47 am, Erik van Zijst wrote:
> Hi All,
>
> My problem is about parallel execution of R-scripts. My platform is linux.
>
> A program that is written in C needs to execute multiple R-scripts
> simultaneously. The C program makes use of multi-threading. Each thread
> must initiate the execution of one script. Performance is very important.
>
> Appearantly the R C-API does not provide a mechanism for parallel
> execution..
>
> It is preferred that the solution is not based on multi-processing (like
> C/S), because that would introduce IPC overhead.

One thing to keep in mind is that IPC is very fast in Linux. So unless you are 
making lots of calls to really tiny functions this should not be an issue.

What can be an issue is the overhead of starting a new R process. In which 
case you can make some helper processes that do the same thing you wanted 
from a multi-thread one and just pass the data around.

                             best

                                  Vladimir Dergachev

>
> Hopefully some thread-safe (single-proces) solution is readily
> available, written in C.
>
> What is the best solution to do this?
>
> (If there is no single-process solution, what is the alternative?)
>
> Regards,
> Erik.


From ripley at stats.ox.ac.uk  Wed Jan  3 19:47:22 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Jan 2007 18:47:22 +0000 (GMT)
Subject: [Rd] Which programming paradigm is the most used for make R
 packages?
In-Reply-To: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701031845210.24378@gannet.stats.ox.ac.uk>

On Wed, 3 Jan 2007, Ricardo Rios wrote:

> Hi wizards, does somebody know  Which programming paradigm is the most
> used for make R packages ? Thanks in advance.

R programming?

Most R packages are either written solely in R or in R with a small 
amount of C or Fortran support code.  That includes the packages which 
ship with R itself (although some have a substantial amount of support 
code).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jhallman at frb.gov  Wed Jan  3 16:42:38 2007
From: jhallman at frb.gov (Jeffrey J. Hallman)
Date: 03 Jan 2007 10:42:38 -0500
Subject: [Rd] Am I missing something about debugging?
References: <1167775737.21960.49.camel@iron.psg.net>
	<459ADBA3.6050800@stats.uwo.ca>
	<1167777966.21960.58.camel@iron.psg.net>
	<459AEE56.9000503@stats.uwo.ca>
	<1167784183.21960.99.camel@iron.psg.net>
	<7098abec0701021706re570830v577ce66c8234730c@mail.gmail.com>
Message-ID: <xmrps9w6rrl.fsf@mralx1.rsma.frb.gov>

Thoughts from a pro-Smalltalk bigot:

"Byron Ellis" <ellis at stat.harvard.edu> writes:
> While a Smalltalk-style debugger would be pretty awesome, I suspect
> R's semantics would make restartable exceptions pretty difficult and
> R's current implementation would make getting the continuation-like
> object you'd need pretty difficult, at least across the range of
> platforms supported by R.
> 
> A solution, of course, would be to implement R's interpreter in
> Smalltalk as a domain-specific language. Vista Smalltalk apparently
> hosts a Lisp/Scheme interpreter and I know of at least one Lisp
> implementation for Squeak, which serve as pretty good starting points
> for an S-like language. :-)

I've programmed extensively in both Splus/R and Smalltalk, and I am much less
enamored of this idea than I used to be.  R and Smalltalk are fundamentally
different and require different mindsets to write decent code.  Here are some
of the differences:

1. Smalltalk objects are passed by reference, while R passes by value.

2. Smalltalk programs consist of messages sent to objects (receivers) and
   assignments.  R programs consist of function calls and assignments. 

3. Smalltalk is single-inheritance and single-dispatch.  R has multiple
   inheritance and multiple dispatch. 

4. The simplicity of the Smalltalk model is in part responsible for the
   fantastic development tools. Single dispatch lets every method belong to a
   particular class.  In fact, everything in the system is an instance of some
   class, including messages, methods, and even classes themselves.  The
   system browser essentially just browses (and lets you edit) classes, and
   that's essentially all that you need.  There are other browsers, but
   they're really just different views into the same thing.

5. The style of programming is different.  One example is how to implement a
   computation with some inputs that have default values.  In R, you would
   write a function like this:

   myFun <- function(arg1, arg2 = default2, arg3 = default3){ 
   ...
   return(aComputedResult)
   }

   and call it any of these ways:

   answer <- myFun(arg1 = 1)
   answer <- myFun(arg1 = 1, arg2 = 2)
   answer <- myFun(arg1 = 1, arg3 = 3)
   answer <- myFun(arg1 = 1, arg2 = 2, arg3 = 3)

   The naive way to do the same in Smalltalk uses 4 methods implemented in the
   class of arg1.  The one that does the actual computing looks like this:

   myFunArg2: firstNumber arg3: secondNumber
     ....
     ^ aComputedResult          "'^' is the return operator."

   The other three methods are:

   myFunArg2: aNumber
     ^ self myFunArg2: aNumber arg3: default3

   myFunArg3: aNumber
     ^ self myFunArg2: default2 arg3: aNumber

   myFun
     ^ self myFunArg2: default2 arg3: default3

   and the four ways you can invoke these are:

   answer := 1 myFun.
   answer := 1 myFunArg2: 2.
   answer := 1 myFunArg3: 3.
   answer := 1 myFunArg2: 2 arg3: 3.

   Compared to R this is kind of clunky, with a combinatoric explosion in the
   number of methods as the number of arguments increases. To avoid that, an
   experienced Smalltalker might instead create the class MyFunArgs to
   implement the idea of "arguments for computing myFun".  MyFunArgs would
   have instance variables arg1, arg2 and arg3, and myFun would be invoked by
   sending the message 'compute' to an instance of myFunArgs.  MyFunArgs would
   have an initialize method that set up the default values, so that 

   MyFunArgs arg1: aNumber

   returned an instance with arg1 set to aNumber, arg2 set to default2, and
   arg3 set to default3.  Then you'd call it in one of these ways:

   answer := (MyFunArgs arg1: 1) compute.
   answer := ((MyFunArgs arg1: 1) arg2: 2) compute.
   answer := ((MyFunArgs arg1: 1) arg3: 3) compute.
   answer := ((MyFunArgs arg1: 1) arg2: 2; arg3: 3) compute.

For all of these reasons and more, R code does not translate cleanly to
Smalltalk, and even writing an R interpreter in Smalltalk does not really take
advantage of the Smalltalk way of programming.

On the other hand, Smalltalk is a very nice language, and with a bit of work
to set up the fundamental classes (e.g., Matrix, Vector, StatisticalModel,
etc...), a very nice data analysis environment could be created using it. The
virtues of such a system would be many.  First and foremost is that, at the
level of 'computing on the language', Smalltalk is easy to understand, as it
really consists of only a few simple ideas consistently exploited to create a
sophisticated system. Second, there are free Smalltalk implementations that
can create complicated GUI applications much more easily than can be done in R
or Splus. Third, even the slowest Smalltalk interpreters are faster than the R
interpreter.  Of course, in many cases this would not matter since R and 
Smalltalk programmers alike can always call out to C or Fortran for
numerically intensive computations.  

Jeff


From ellis at stat.harvard.edu  Wed Jan  3 21:13:47 2007
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Wed, 3 Jan 2007 12:13:47 -0800
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <xmrps9w6rrl.fsf@mralx1.rsma.frb.gov>
References: <1167775737.21960.49.camel@iron.psg.net>
	<459ADBA3.6050800@stats.uwo.ca>
	<1167777966.21960.58.camel@iron.psg.net>
	<459AEE56.9000503@stats.uwo.ca>
	<1167784183.21960.99.camel@iron.psg.net>
	<7098abec0701021706re570830v577ce66c8234730c@mail.gmail.com>
	<xmrps9w6rrl.fsf@mralx1.rsma.frb.gov>
Message-ID: <7098abec0701031213k4abbcf82x705ae7fccbaac650@mail.gmail.com>

On 03 Jan 2007 10:42:38 -0500, Jeffrey J. Hallman <jhallman at frb.gov> wrote:
> Thoughts from a pro-Smalltalk bigot:

I'm surprised anyone took the idea seriously enough to respond. :-)

>
>
> I've programmed extensively in both Splus/R and Smalltalk, and I am much less
> enamored of this idea than I used to be.  R and Smalltalk are fundamentally
> different and require different mindsets to write decent code.  Here are some
> of the differences:
>
> 1. Smalltalk objects are passed by reference, while R passes by value.

Yes, but what's pass-by-value other than a possibly clever version of
[anObject doSomething:[anotherObject copy]]?

>
> 2. Smalltalk programs consist of messages sent to objects (receivers) and
>    assignments.  R programs consist of function calls and assignments.
>
> 3. Smalltalk is single-inheritance and single-dispatch.  R has multiple
>    inheritance and multiple dispatch.

I would argue that Smalltalk is heading in this direction with the
introduction of Traits and other class composition techniques.
Multiple-dispatch is something Smalltalks generally don't do, but it's
not something it can't do. Actually, there was a paper just recently
(on Arxiv maybe?) that showed a very elegant way of putting multiple
dispatch into a single dispatch system. Sadly, I seem to have
misplaced the PDF (Just more proof I need one of those Sony Reader
things...)

>
> 4. The simplicity of the Smalltalk model is in part responsible for the
>    fantastic development tools. Single dispatch lets every method belong to a
>    particular class.  In fact, everything in the system is an instance of some
>    class, including messages, methods, and even classes themselves.  The
>    system browser essentially just browses (and lets you edit) classes, and
>    that's essentially all that you need.  There are other browsers, but
>    they're really just different views into the same thing.

More importantly, the reference-based-nature make it much easier to
change a method in a class and have the right thing happen. With R
it's unclear if you could make sure that all copies of a function are
accounted for without resorting to walking the image.... Sort of like
the problems with posing in modern Smalltalks.

>
> 5. The style of programming is different.  One example is how to implement a
>    computation with some inputs that have default values.  In R, you would
>    write a function like this:
>
>    myFun <- function(arg1, arg2 = default2, arg3 = default3){
>    ...
>    return(aComputedResult)
>    }
>
>    and call it any of these ways:
>
>    answer <- myFun(arg1 = 1)
>    answer <- myFun(arg1 = 1, arg2 = 2)
>    answer <- myFun(arg1 = 1, arg3 = 3)
>    answer <- myFun(arg1 = 1, arg2 = 2, arg3 = 3)
>
>    The naive way to do the same in Smalltalk uses 4 methods implemented in the
>    class of arg1.  The one that does the actual computing looks like this:
>
>    myFunArg2: firstNumber arg3: secondNumber
>      ....
>      ^ aComputedResult          "'^' is the return operator."
>
>    The other three methods are:
>
>    myFunArg2: aNumber
>      ^ self myFunArg2: aNumber arg3: default3
>
>    myFunArg3: aNumber
>      ^ self myFunArg2: default2 arg3: aNumber
>
>    myFun
>      ^ self myFunArg2: default2 arg3: default3
>
>    and the four ways you can invoke these are:
>
>    answer := 1 myFun.
>    answer := 1 myFunArg2: 2.
>    answer := 1 myFunArg3: 3.
>    answer := 1 myFunArg2: 2 arg3: 3.
>
>    Compared to R this is kind of clunky, with a combinatoric explosion in the
>    number of methods as the number of arguments increases. To avoid that, an
>    experienced Smalltalker might instead create the class MyFunArgs to
>    implement the idea of "arguments for computing myFun".  MyFunArgs would
>    have instance variables arg1, arg2 and arg3, and myFun would be invoked by
>    sending the message 'compute' to an instance of myFunArgs.  MyFunArgs would
>    have an initialize method that set up the default values, so that
>
>    MyFunArgs arg1: aNumber
>
>    returned an instance with arg1 set to aNumber, arg2 set to default2, and
>    arg3 set to default3.  Then you'd call it in one of these ways:
>
>    answer := (MyFunArgs arg1: 1) compute.
>    answer := ((MyFunArgs arg1: 1) arg2: 2) compute.
>    answer := ((MyFunArgs arg1: 1) arg3: 3) compute.
>    answer := ((MyFunArgs arg1: 1) arg2: 2; arg3: 3) compute.
>
> For all of these reasons and more, R code does not translate cleanly to
> Smalltalk, and even writing an R interpreter in Smalltalk does not really take
> advantage of the Smalltalk way of programming.

Actually, R's argument list is more like a dictionary than it is like
a Smalltalk or C-style argument list so I'd probably opt for something
with a Dictionary-like structure if I were building something in
Smalltalk. Hmm, R is Dicts all the way down!

However, this illustrates the point of WHY you might want a domain
specific language for statistics in Smalltalk. There are somethings
that the Smalltalk syntax is just sort of clunky for doing and the
sorts of manipulations we commonly do in R is one of them. By the same
token some things are a pain to implement in R. User interfaces come
to mind. Of course the entire thing would be built on some sort of
Smalltalk analysis structure so you wouldn't have to use the R-style
if you didn't want to.

>
> On the other hand, Smalltalk is a very nice language, and with a bit of work
> to set up the fundamental classes (e.g., Matrix, Vector, StatisticalModel,
> etc...), a very nice data analysis environment could be created using it. The
> virtues of such a system would be many.  First and foremost is that, at the
> level of 'computing on the language', Smalltalk is easy to understand, as it
> really consists of only a few simple ideas consistently exploited to create a
> sophisticated system. Second, there are free Smalltalk implementations that
> can create complicated GUI applications much more easily than can be done in R
> or Splus. Third, even the slowest Smalltalk interpreters are faster than the R


Oh, I tend to agree. I really enjoy Smalltalk development (except for
the default lack of reasonable Emacs keybindings...) and there are
some really powerful tools in there, not to mention things like
Seaside. For example, I was thinking just yesterday that it would be
really cool if you could attach a Graphics Device to a VNC server and
let people with VNC clients log in and write on the Device
John-Madden-Telestrator-Style (henceforth known as Collabotron 3000.
It's my idea, I get to name it. :-) ).

In Squeak this would be pretty easy since there's already a VNC server
(and client) implementation just lying around waiting to be used. Not
quite trivial, but all the bits and pieces are there.

On the flip side, for me, all of these virtues are almost always
outweighed by CRAN.

> interpreter.  Of course, in many cases this would not matter since R and
> Smalltalk programmers alike can always call out to C or Fortran for
> numerically intensive computations.

I think it does matter, the longer you can stay in the higher level
language the better.

>
> Jeff
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From ross at biostat.ucsf.edu  Wed Jan  3 21:49:56 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Wed, 3 Jan 2007 12:49:56 -0800
Subject: [Rd] Which programming paradigm is the most used for make R
	packages?
In-Reply-To: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
Message-ID: <20070103204956.GB8906@wheat.betterworld.us>

On Wed, Jan 03, 2007 at 11:46:16AM -0600, Ricardo Rios wrote:
> Hi wizards, does somebody know  Which programming paradigm is the most
> used for make R packages ? Thanks in advance.
> 
You need to explain what you mean by the question, for example what
paradigms you have in mind.

R is a functional language; as I've discovered, this means some
standard OO programming approaches don't carry over too naturally.  In
particular, functions don't really "belong" to classes.  R purists
would probably want that to say class-based 00 programming doesn't
fit, since R is function-based OO.

There is a package that  permits a more traditional ("class-based") OO
style; I think it's called R.oo.

Ross Boylan


From hb at stat.berkeley.edu  Thu Jan  4 00:00:01 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 4 Jan 2007 10:00:01 +1100
Subject: [Rd] Which programming paradigm is the most used for make R
	packages?
In-Reply-To: <20070103204956.GB8906@wheat.betterworld.us>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
	<20070103204956.GB8906@wheat.betterworld.us>
Message-ID: <59d7961d0701031500v2cf8df0cs6b5544fe4d660db7@mail.gmail.com>

On 1/4/07, Ross Boylan <ross at biostat.ucsf.edu> wrote:
> On Wed, Jan 03, 2007 at 11:46:16AM -0600, Ricardo Rios wrote:
> > Hi wizards, does somebody know  Which programming paradigm is the most
> > used for make R packages ? Thanks in advance.
> >
> You need to explain what you mean by the question, for example what
> paradigms you have in mind.
>
> R is a functional language; as I've discovered, this means some
> standard OO programming approaches don't carry over too naturally.  In
> particular, functions don't really "belong" to classes.  R purists
> would probably want that to say class-based 00 programming doesn't
> fit, since R is function-based OO.
>
> There is a package that  permits a more traditional ("class-based") OO
> style; I think it's called R.oo.

More precisely, for the R purists, R.oo provides utility functions to
define S3 methods safely, and in addition, as you write, a top-level
class Object that provides class-based object-oriented design and
implementation with support for reference variables through standard
S3 inheritance.

Cheers

Henrik

>
> Ross Boylan
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From sfalcon at fhcrc.org  Thu Jan  4 00:21:18 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 03 Jan 2007 15:21:18 -0800
Subject: [Rd] Capturing argument values
In-Reply-To: <20061231012017.GD23253@wheat.betterworld.us> (Ross Boylan's
	message of "Sat, 30 Dec 2006 17:20:17 -0800")
References: <20061231012017.GD23253@wheat.betterworld.us>
Message-ID: <m27iw3d7dd.fsf@fhcrc.org>

Ross Boylan <ross at biostat.ucsf.edu> writes:

> I would like to preserve the values of all the arguments to a function
> in a results object.
> foo <- function(a, b=1) ....
> foo(x, 3)
>
> match.call() looks promising, but it records that a is x, while I want
> the value of x (in the calling frame).  Also, if the invocation is
> foo(x), then match.call doesn't record that b is 1.
>
> So I tried this (inside the function definition):
>     myargs <- lapply(names(formals()),
>                      function(x) eval(as.name(x)))
>
> That's pretty close.  However, my function has an optional argument in
> this sense:
> bar <- function(x, testing) ...
> where code in the body is 
>   if (! missing(testing)) do stuff
>
> When the eval in the previous lapply runs for a function call in which
> testing is not supplied, I get
> Error in eval(expr, envir, enclos) : argument "testing" is missing,
> with no default
> exposing a weakness in both my implementation and problem specification.
>
> I think I could simply screen "testing" out of the formals and be
> happy, but are there better ways of handling this situation?

Why not just give testing a default value?  Otherwise, filtering out
missing args as you mentioned.

+ seth


From xiao.gang.fan1 at libertysurf.fr  Wed Jan  3 18:55:22 2007
From: xiao.gang.fan1 at libertysurf.fr (xiao.gang.fan1 at libertysurf.fr)
Date: Wed,  3 Jan 2007 18:55:22 +0100 (CET)
Subject: [Rd] pb in regular expression with the character "-" (PR#9437)
Message-ID: <20070103175522.D1D843F03E@slim.kubism.ku.dk>

Full_Name: FAN
Version: 2.4.0
OS: Windows
Submission from: (NULL) (159.50.101.9)


These are expected:

> grep("[\-|c]", c("a-a","b"))
[1] 1

> gsub("[\-|c]", "&", c("a-a","b"))
[1] "a&a" "b"  

but these are strange:

> grep("[d|\-|c]", c("a-a","b"))
integer(0)

> gsub("[d|\-|c]", "&", c("a-a","b"))
[1] "a-a" "b"  

Thanks


From r at erik.prutser.cx  Thu Jan  4 10:54:35 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Thu, 04 Jan 2007 10:54:35 +0100
Subject: [Rd] How to execute R scripts simultaneously from multiple
	threads
In-Reply-To: <200701031337.45613.vdergachev@rcgardis.com>
References: <459B6DBA.3050207@erik.prutser.cx>
	<200701031337.45613.vdergachev@rcgardis.com>
Message-ID: <459CCEDB.5040201@erik.prutser.cx>

Vladimir Dergachev wrote:
> On Wednesday 03 January 2007 3:47 am, Erik van Zijst wrote:
> 
>>Appearantly the R C-API does not provide a mechanism for parallel
>>execution..
>>
>>It is preferred that the solution is not based on multi-processing (like
>>C/S), because that would introduce IPC overhead.
> 
> One thing to keep in mind is that IPC is very fast in Linux. So unless you are 
> making lots of calls to really tiny functions this should not be an issue.

Using pipes or shared memory to pass things around to other processes on 
the same box is very fast indeed, but if we base our design around 
something like RServe which uses TCP it could be significantly slower.
Our R-based system will be running scripts in response to high-volume 
real-time stock exchange data, so we expect lots of calls to many tiny 
functions indeed.

> What can be an issue is the overhead of starting a new R process. In which 
> case you can make some helper processes that do the same thing you wanted 
> from a multi-thread one and just pass the data around.

Yes, we'll need to keep a pool of processes. Maybe use RServer, or build 
something ourselves around shared memory if the proof of concept proves 
TCP is too heavy for this.

thanks,
Erik


>                              best
> 
>                                   Vladimir Dergachev
> 
> 
>>Hopefully some thread-safe (single-proces) solution is readily
>>available, written in C.
>>
>>What is the best solution to do this?
>>
>>(If there is no single-process solution, what is the alternative?)
>>
>>Regards,
>>Erik.
> 
> 

-- 
USENET would be a better laboratory is there were more labor and less 
oratory.
		-- Elizabeth Haley


From karsten_krug at gmx.net  Thu Jan  4 11:24:29 2007
From: karsten_krug at gmx.net (karsten_krug at gmx.net)
Date: Thu,  4 Jan 2007 11:24:29 +0100 (CET)
Subject: [Rd] problem with function 'optimise' (PR#9438)
Message-ID: <20070104102429.70F874C9A4@slim.kubism.ku.dk>

Full_Name: Karsten Krug
Version: 2.4.0
OS: Open Suse 10.0, Windows XP
Submission from: (NULL) (88.134.13.50)



I found a problem in the 'optimise' function for one dimensional optimisation.


Example 1:
Try to find a maximum of the function below with the use of 'optimise' in the
interval [0,0.5]. The function follows a parabola and has two local maxima
located at the margins of the interval [0,0.5]. Please try the following code
which performs this optimisation, produces a plot of the function within the
given interval and adds the computed maximum returned by 'optimise()' 

ex1 <- function(x) log(4 * x^2 - 2 * x + 0.5)
opt1 <- optimise(ex1, lower=0, upper=0.5, maximum=T)
x <- seq(0,0.5,0.001)
plot(x, ex1(x), type="l")
abline(v=opt1$maximum, col="red")

The returned value of the maximum is 0.309017 which is definitely wrong.


Example 2:
The next function has also two equivalent maxima this time not located at the
margins of the interval [0, 9/41]. Thus, the maxima are real analytic extrema.
The function 'optimise()' again returns a wrong value.    

ex2 <- function(x) log((18/41) * x - 2 * x^2) + 16 *  log(4 * x^2 - (36/41) * x
+ (9/41)) + 24 * log((23/82) +  (18/41) * x - 2 * x^2)
opt2 <- optimise(ex2, lower=0, upper=(9/41), maximum=T)
x <- seq(0,9/41,0.001)
plot(x,ex2(x),type="l")
abline(v=opt2$maximum, col="red")


The two functions are not only of theoretical interest but have to be optimised
as likelihood functions when dealing with SNP data. 

I observed this problem on Windows XP and Open Suse 10.0. Other platforms have
to be tested.


Some informations:

Open Suse 10.0

platform       i686-pc-linux-gnu
arch           i686
os             linux-gnu
system         i686, linux-gnu
status
major          2
minor          4.0
year           2006
month          10
day            03
svn rev        39566
language       R
version.string R version 2.4.0 (2006-10-03)

Windows XP:

platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          4.0                         
year           2006                        
month          10                          
day            03                          
svn rev        39566                       
language       R                           
version.string R version 2.4.0 (2006-10-03)



With best regards,

Karsten Krug
Student at University of Leipzig


From ripley at stats.ox.ac.uk  Thu Jan  4 11:42:23 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 4 Jan 2007 10:42:23 +0000 (GMT)
Subject: [Rd] pb in regular expression with the character "-" (PR#9437)
In-Reply-To: <20070103175522.D1D843F03E@slim.kubism.ku.dk>
References: <20070103175522.D1D843F03E@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0701041020150.15115@gannet.stats.ox.ac.uk>

Why do you think this is a bug in R?  You have not told us what you 
expected, but the character range |-| contains only | .  Not agreeing with 
your expectations (unstated or otherwise) is not a bug in R.

\- is the same as -, and - is special in character classes.  (If it is 
first or last it is treated literally.)  And | is not a metacharacter 
inside a character class.  Also,

> grep("[d\\-c]", c("a-a","b"))
[1] 1 2
> grep("[d\\-c]", c("a-a","b"), perl=TRUE)
[1] 1

shows that escaping - works only in perl (which you will find from the 
background references mentioned, e.g.

   The interpretation of an ordinary character preceded by a backslash
   ('\') is undefined.

.)

This is all carefully documented in ?regexp, e.g.

      Patterns are described here as they would be printed by 'cat': do
      remember that backslashes need to be doubled in entering R
      character strings from the keyboard.


This is not the first time you have wasted our resources with false 
bug reports, so please show more respect for the R developers' time.
You were also explicitly asked not to report on obselete versions of R.

On Wed, 3 Jan 2007, xiao.gang.fan1 at libertysurf.fr wrote:

> Full_Name: FAN
> Version: 2.4.0
> OS: Windows
> Submission from: (NULL) (159.50.101.9)
>
>
> These are expected:
>
>> grep("[\-|c]", c("a-a","b"))
> [1] 1
>
>> gsub("[\-|c]", "&", c("a-a","b"))
> [1] "a&a" "b"
>
> but these are strange:
>
>> grep("[d|\-|c]", c("a-a","b"))
> integer(0)
>
>> gsub("[d|\-|c]", "&", c("a-a","b"))
> [1] "a-a" "b"
>
> Thanks
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From b.rowlingson at lancaster.ac.uk  Thu Jan  4 11:52:05 2007
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 04 Jan 2007 10:52:05 +0000
Subject: [Rd] Which programming paradigm is the most used for make
	R	packages?
In-Reply-To: <20070103204956.GB8906@wheat.betterworld.us>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
	<20070103204956.GB8906@wheat.betterworld.us>
Message-ID: <459CDC55.4090508@lancaster.ac.uk>

Ross Boylan wrote:
> On Wed, Jan 03, 2007 at 11:46:16AM -0600, Ricardo Rios wrote:
>> Hi wizards, does somebody know  Which programming paradigm is the most
>> used for make R packages ? Thanks in advance.
>>
> You need to explain what you mean by the question, for example what
> paradigms you have in mind.
>

  Judging by the R code some people in our department write, the most 
used paradigm is 'bash something out that works and worry about 
paradigms later'-paradigm, used in conjunction with the 'write a very 
long .R file and source() it whenever you want to do 
something'-paradigm. This seems related to the 'write-first' paradigm, 
as opposed to the 'think-first' paradigm.

  Partly this is often due to the exploratory nature of working with R. 
You get a data set. You go 'okay, well, what's the mean of each 
column?', and do that. Then you wonder how A depends on B. Then you 
wonder how A depends on B given, ooh, C. Then you think, well, if I 
split the data into old and new measurements, rescaled by the median and 
offset by D, maybe something interesting appears. By now you've written 
40 lines of R code and its starting to get messy...

  By the end of the thesis, instead of a nice neat redistributable R 
package that would look great on CRAN, there's a whole pile of R code 
scattered around in various directories.

  How many statistics departments still teach programming to their 
undergraduates? We dropped Fortran about 10 years ago, nowadays they 
maybe type a few things into a script for Matlab in their second year, 
learn R at the end of year 2, and do a project perhaps with R in their 
third year. But they are expected to develop their own paradigm for 
working in R. I don't think the fundamentals of programming, let along 
the idea of paradigms (functional/OO/whatever) is introduced.

  Scary. And wandering off-topic.

Barry


From dimitris.rizopoulos at med.kuleuven.be  Thu Jan  4 13:13:58 2007
From: dimitris.rizopoulos at med.kuleuven.be (Dimitris Rizopoulos)
Date: Thu, 4 Jan 2007 13:13:58 +0100
Subject: [Rd] problem with function 'optimise' (PR#9438)
References: <20070104102429.70F874C9A4@slim.kubism.ku.dk>
Message-ID: <003201c72ff9$d0434460$0540210a@www.domain>

the issue here is a numerical one; for instance in your first example 
check:

eps <- sqrt(.Machine$double.eps)
opt1 <- optimise(ex1, lower = 0 - eps, upper = 0.5, maximum = TRUE)

# or

opt1 <- optimise(ex1, lower = 0 + eps, upper = 0.5, maximum = TRUE)


which gives the correct results.

I hope it helps.

Best,
Dimitris

----
Dimitris Rizopoulos
Ph.D. Student
Biostatistical Centre
School of Public Health
Catholic University of Leuven

Address: Kapucijnenvoer 35, Leuven, Belgium
Tel: +32/(0)16/336899
Fax: +32/(0)16/337015
Web: http://med.kuleuven.be/biostat/
     http://www.student.kuleuven.be/~m0390867/dimitris.htm



----- Original Message ----- 
From: <karsten_krug at gmx.net>
To: <r-devel at stat.math.ethz.ch>
Cc: <R-bugs at biostat.ku.dk>
Sent: Thursday, January 04, 2007 11:24 AM
Subject: [Rd] problem with function 'optimise' (PR#9438)


> Full_Name: Karsten Krug
> Version: 2.4.0
> OS: Open Suse 10.0, Windows XP
> Submission from: (NULL) (88.134.13.50)
>
>
>
> I found a problem in the 'optimise' function for one dimensional 
> optimisation.
>
>
> Example 1:
> Try to find a maximum of the function below with the use of 
> 'optimise' in the
> interval [0,0.5]. The function follows a parabola and has two local 
> maxima
> located at the margins of the interval [0,0.5]. Please try the 
> following code
> which performs this optimisation, produces a plot of the function 
> within the
> given interval and adds the computed maximum returned by 
> 'optimise()'
>
> ex1 <- function(x) log(4 * x^2 - 2 * x + 0.5)
> opt1 <- optimise(ex1, lower=0, upper=0.5, maximum=T)
> x <- seq(0,0.5,0.001)
> plot(x, ex1(x), type="l")
> abline(v=opt1$maximum, col="red")
>
> The returned value of the maximum is 0.309017 which is definitely 
> wrong.
>
>
> Example 2:
> The next function has also two equivalent maxima this time not 
> located at the
> margins of the interval [0, 9/41]. Thus, the maxima are real 
> analytic extrema.
> The function 'optimise()' again returns a wrong value.
>
> ex2 <- function(x) log((18/41) * x - 2 * x^2) + 16 *  log(4 * x^2 - 
> (36/41) * x
> + (9/41)) + 24 * log((23/82) +  (18/41) * x - 2 * x^2)
> opt2 <- optimise(ex2, lower=0, upper=(9/41), maximum=T)
> x <- seq(0,9/41,0.001)
> plot(x,ex2(x),type="l")
> abline(v=opt2$maximum, col="red")
>
>
> The two functions are not only of theoretical interest but have to 
> be optimised
> as likelihood functions when dealing with SNP data.
>
> I observed this problem on Windows XP and Open Suse 10.0. Other 
> platforms have
> to be tested.
>
>
> Some informations:
>
> Open Suse 10.0
>
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status
> major          2
> minor          4.0
> year           2006
> month          10
> day            03
> svn rev        39566
> language       R
> version.string R version 2.4.0 (2006-10-03)
>
> Windows XP:
>
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status
> major          2
> minor          4.0
> year           2006
> month          10
> day            03
> svn rev        39566
> language       R
> version.string R version 2.4.0 (2006-10-03)
>
>
>
> With best regards,
>
> Karsten Krug
> Student at University of Leipzig
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


Disclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm


From Mark.Bravington at csiro.au  Thu Jan  4 07:06:49 2007
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Thu, 4 Jan 2007 17:06:49 +1100
Subject: [Rd] Am I missing something about debugging?
Message-ID: <D79013E40FEF254AAF0D72DFC94F27482307C0@extas4-hba.tas.csiro.au>

It is possible to do some of these things with the 'debug' package-- the
article in R-news 2003 #3 shows a few of the tricks. Suppose 'b1' calls
'c1'. If 'c1' exists as "permanent" function defined outside 'b1' (which
I generally prefer, for clarity), then you can call 'mtrace( c1)' and
'c1' will be invoked whenever it's called-- you don't have to first
'mtrace' 'b1' and then manually call 'mtrace(c1)' while inside 'b1'.

Even if 'c1' is defined inside the body of 'b1', you can get something
similar by using conditional breakpoints, like this

> mtrace( b1)
> # whatever you type to get 'b1' going
D(17)> # now look at the code window for 'b1' and find the line just
after the definition of 'c1'
D(17)> # ... say that's on line 11
D(17)> bp( 11, {mtrace( c1);FALSE})
# which will auto-mtrace 'c1' without stopping; of course you could
hardwire this in the code of 'b1' too

the point is that you can stick all sorts of code inside a conditional
breakpoint to do other things-- if the expression returns FALSE then the
breakpoint won't be triggered, but the side-effects will still happen.
You can also use conditional breakpoints and 'skip' command to patch
code on-the-fly, but I generally find it's too much trouble.


Note also the trick of 
D(17)> bp(1,F) 

which is useful if 'b1' will be called again within the lifetime of the
current top-level expression and you actually don't want to stop.

The point about context is subtle because of R's scoping rules-- should
one look at lexical scope, or at things defined in calling functions?
The former happens by default in the 'debug' package (ie if you type the
name of something that can be "seen" from the current function, then the
debugger will find it, even if it's not defined in the current frame).
For the latter, though, if you are currently "inside" c1, then one way
to do it is to use 'sys.parent()' or 'sys.parent(2)' or whatever to
figure out the frame number of the "context" you want, then you could do
e.g.

D(18)> sp <- sys.frame( sys.parent( 2))
D(18)> evalq( ls(), sp)

etc which is not too bad. It's worth experimenting with sys.call etc
while inside my debugger, too-- I have gone to some lengths to try to
ensure that those functions work the way that might be expected (even
though they actually don't... long story).

If you are 'mtrace'ing one of the calling functions as well, then you
can also look at the frame numbers in the code windows to work out where
to 'evalq'.

The current 'debug' package doesn't include a "watch window" (even
though it's something I rely on heavily in Delphi, my main other
language) mainly because R can get stuck figuring out what to display in
that window. It's not that hard to do (I used ot have one in the Splus
version of my debugger) and I might add one in future if demand is high
enough. It would help if there was some way to "time-out" a
calculation-- e.g. a 'time.try' function a la

  result <- time.try( { do.some.big.calculation}, 0.05)

which would return an object of class "too-slow" if the calculation
takes more than 0.05s.

I'm certainly willing to consider adding other features to the 'debug'
package if they are easy enough and demand is high enough! [And if I
have time, which I mostly don't :( ]

Hope this is of some use

Mark


Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623
 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Ross Boylan
> Sent: Wednesday, 3 January 2007 9:09 AM
> To: R Development List
> Subject: [Rd] Am I missing something about debugging?
> 
> I would like to be able to trace execution into calls below 
> the current function, or to follow execution as calls return. 
>  This is roughly the distinction between "step" and "next" in 
> many debuggers.
> 
> I would also like to be able to switch to a location further 
> up the call stack than the location at which I enter the 
> debugger, to see the context of the current operations.
> 
> Are there ways to do these things with the R debugger?  I've 
> studied the man pages and FAQ's, and looked at the debug 
> package, but I don't see a way except for manually calling 
> debug on the function that is about to be called if I want to 
> descend.  That's quite awkward, particularly since it must be 
> manually undone (the debug package may be better on that 
> score).  I'm also not entirely sure that such recursion 
> (essentially, debugging within the debugger) is OK.
> 
> I tried looking up the stack with things like sys.calls(), 
> from within the browser, but they operated as if I were at 
> the top level (e.g.,
> sys.function(-1) gets an error that it can't go there).  I 
> was doing this in ess, and there's some chance the "can't 
> write .Last.value" error (wording approximate) cause by 
> having an old version is screwing things up).
> 
> Since R is interpreted I would expect debugging to be a snap, 
> but these limitations make me suspect there is something 
> about the language design that makes implementing these 
> facilities hard.  For example, the browser as documented in 
> the Green book has up and down functions to change the frame 
> (p. 265); these are conspicuously absent in R.
> -- 
> Ross Boylan                                      wk:  (415) 514-8146
> 185 Berry St #5700                               ross at biostat.ucsf.edu
> Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
> University of California, San Francisco
> San Francisco, CA 94107-1739                     hm:  (415) 550-1062
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From ripley at stats.ox.ac.uk  Thu Jan  4 14:59:33 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 4 Jan 2007 13:59:33 +0000 (GMT)
Subject: [Rd] problem with function 'optimise' (PR#9438)
In-Reply-To: <003201c72ff9$d0434460$0540210a@www.domain>
References: <20070104102429.70F874C9A4@slim.kubism.ku.dk>
	<003201c72ff9$d0434460$0540210a@www.domain>
Message-ID: <Pine.LNX.4.64.0701041339250.25465@gannet.stats.ox.ac.uk>

That's only incidental to the story.  The problem is (code in 
src/appl/fmin.c) that at the first step symmetry (in both examples) gives 
fu=fx, and the code has

 	if (fx <= fu) {
 	    if (u < x)
 		a = u;
 	    else
 		b = u;
 	}
 	if (fu <= fx) {
...

This appears to be an error in the C translation, for the original Fortran 
does not do this.


On Thu, 4 Jan 2007, Dimitris Rizopoulos wrote:

> the issue here is a numerical one; for instance in your first example
> check:
>
> eps <- sqrt(.Machine$double.eps)
> opt1 <- optimise(ex1, lower = 0 - eps, upper = 0.5, maximum = TRUE)
>
> # or
>
> opt1 <- optimise(ex1, lower = 0 + eps, upper = 0.5, maximum = TRUE)
>
>
> which gives the correct results.
>
> I hope it helps.
>
> Best,
> Dimitris
>
> ----
> Dimitris Rizopoulos
> Ph.D. Student
> Biostatistical Centre
> School of Public Health
> Catholic University of Leuven
>
> Address: Kapucijnenvoer 35, Leuven, Belgium
> Tel: +32/(0)16/336899
> Fax: +32/(0)16/337015
> Web: http://med.kuleuven.be/biostat/
>     http://www.student.kuleuven.be/~m0390867/dimitris.htm
>
>
>
> ----- Original Message -----
> From: <karsten_krug at gmx.net>
> To: <r-devel at stat.math.ethz.ch>
> Cc: <R-bugs at biostat.ku.dk>
> Sent: Thursday, January 04, 2007 11:24 AM
> Subject: [Rd] problem with function 'optimise' (PR#9438)
>
>
>> Full_Name: Karsten Krug
>> Version: 2.4.0
>> OS: Open Suse 10.0, Windows XP
>> Submission from: (NULL) (88.134.13.50)
>>
>>
>>
>> I found a problem in the 'optimise' function for one dimensional
>> optimisation.
>>
>>
>> Example 1:
>> Try to find a maximum of the function below with the use of
>> 'optimise' in the
>> interval [0,0.5]. The function follows a parabola and has two local
>> maxima
>> located at the margins of the interval [0,0.5]. Please try the
>> following code
>> which performs this optimisation, produces a plot of the function
>> within the
>> given interval and adds the computed maximum returned by
>> 'optimise()'
>>
>> ex1 <- function(x) log(4 * x^2 - 2 * x + 0.5)
>> opt1 <- optimise(ex1, lower=0, upper=0.5, maximum=T)
>> x <- seq(0,0.5,0.001)
>> plot(x, ex1(x), type="l")
>> abline(v=opt1$maximum, col="red")
>>
>> The returned value of the maximum is 0.309017 which is definitely
>> wrong.
>>
>>
>> Example 2:
>> The next function has also two equivalent maxima this time not
>> located at the
>> margins of the interval [0, 9/41]. Thus, the maxima are real
>> analytic extrema.
>> The function 'optimise()' again returns a wrong value.
>>
>> ex2 <- function(x) log((18/41) * x - 2 * x^2) + 16 *  log(4 * x^2 -
>> (36/41) * x
>> + (9/41)) + 24 * log((23/82) +  (18/41) * x - 2 * x^2)
>> opt2 <- optimise(ex2, lower=0, upper=(9/41), maximum=T)
>> x <- seq(0,9/41,0.001)
>> plot(x,ex2(x),type="l")
>> abline(v=opt2$maximum, col="red")
>>
>>
>> The two functions are not only of theoretical interest but have to
>> be optimised
>> as likelihood functions when dealing with SNP data.
>>
>> I observed this problem on Windows XP and Open Suse 10.0. Other
>> platforms have
>> to be tested.
>>
>>
>> Some informations:
>>
>> Open Suse 10.0
>>
>> platform       i686-pc-linux-gnu
>> arch           i686
>> os             linux-gnu
>> system         i686, linux-gnu
>> status
>> major          2
>> minor          4.0
>> year           2006
>> month          10
>> day            03
>> svn rev        39566
>> language       R
>> version.string R version 2.4.0 (2006-10-03)
>>
>> Windows XP:
>>
>> platform       i386-pc-mingw32
>> arch           i386
>> os             mingw32
>> system         i386, mingw32
>> status
>> major          2
>> minor          4.0
>> year           2006
>> month          10
>> day            03
>> svn rev        39566
>> language       R
>> version.string R version 2.4.0 (2006-10-03)
>>
>>
>>
>> With best regards,
>>
>> Karsten Krug
>> Student at University of Leipzig
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
> Disclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From alfilnegro.sv at gmail.com  Thu Jan  4 15:47:07 2007
From: alfilnegro.sv at gmail.com (Ricardo Rios)
Date: Thu, 4 Jan 2007 08:47:07 -0600
Subject: [Rd] Which programming paradigm is the most used for make R
	packages?
In-Reply-To: <20070103204956.GB8906@wheat.betterworld.us>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
	<20070103204956.GB8906@wheat.betterworld.us>
Message-ID: <50a711930701040647m8f938dekb8a470abd189aac9@mail.gmail.com>

A programming paradigm is a paradigmatic style of programming (compare
with a methodology, which is a paradigmatic style of doing software
engineering). I think , the programming paradigm most used for make R
packages is the functional programming , but I don't know this
statistic. I need this information in my thesis.

On 1/3/07, Ross Boylan <ross at biostat.ucsf.edu> wrote:
> On Wed, Jan 03, 2007 at 11:46:16AM -0600, Ricardo Rios wrote:
> > Hi wizards, does somebody know  Which programming paradigm is the most
> > used for make R packages ? Thanks in advance.
> >
> You need to explain what you mean by the question, for example what
> paradigms you have in mind.
>
> R is a functional language; as I've discovered, this means some
> standard OO programming approaches don't carry over too naturally.  In
> particular, functions don't really "belong" to classes.  R purists
> would probably want that to say class-based 00 programming doesn't
> fit, since R is function-based OO.
>
> There is a package that  permits a more traditional ("class-based") OO
> style; I think it's called R.oo.
>
> Ross Boylan
>


-- 
personal web site:
http://www.geocities.com/ricardo_rios_sv/index.html


From ggrothendieck at gmail.com  Thu Jan  4 16:00:40 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 4 Jan 2007 10:00:40 -0500
Subject: [Rd] Which programming paradigm is the most used for make R
	packages?
In-Reply-To: <50a711930701040647m8f938dekb8a470abd189aac9@mail.gmail.com>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
	<20070103204956.GB8906@wheat.betterworld.us>
	<50a711930701040647m8f938dekb8a470abd189aac9@mail.gmail.com>
Message-ID: <971536df0701040700udbf43f8m71a781bc52c00867@mail.gmail.com>

Its object oriented in the sense of the Dylan language.  It has
some functional elements but true functional languages have
better support for recursion, tail recursion and absence of side
effects whereas side effects are common in R.


On 1/4/07, Ricardo Rios <alfilnegro.sv at gmail.com> wrote:
> A programming paradigm is a paradigmatic style of programming (compare
> with a methodology, which is a paradigmatic style of doing software
> engineering). I think , the programming paradigm most used for make R
> packages is the functional programming , but I don't know this
> statistic. I need this information in my thesis.
>
> On 1/3/07, Ross Boylan <ross at biostat.ucsf.edu> wrote:
> > On Wed, Jan 03, 2007 at 11:46:16AM -0600, Ricardo Rios wrote:
> > > Hi wizards, does somebody know  Which programming paradigm is the most
> > > used for make R packages ? Thanks in advance.
> > >
> > You need to explain what you mean by the question, for example what
> > paradigms you have in mind.
> >
> > R is a functional language; as I've discovered, this means some
> > standard OO programming approaches don't carry over too naturally.  In
> > particular, functions don't really "belong" to classes.  R purists
> > would probably want that to say class-based 00 programming doesn't
> > fit, since R is function-based OO.
> >
> > There is a package that  permits a more traditional ("class-based") OO
> > style; I think it's called R.oo.
> >
> > Ross Boylan
> >
>
>
> --
> personal web site:
> http://www.geocities.com/ricardo_rios_sv/index.html
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From tlumley at u.washington.edu  Thu Jan  4 16:35:25 2007
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu, 4 Jan 2007 07:35:25 -0800 (PST)
Subject: [Rd] Which programming paradigm is the most used for make R
 packages?
In-Reply-To: <50a711930701040647m8f938dekb8a470abd189aac9@mail.gmail.com>
References: <50a711930701030946s7d4983d5h2150a4081f5677c6@mail.gmail.com>
	<20070103204956.GB8906@wheat.betterworld.us>
	<50a711930701040647m8f938dekb8a470abd189aac9@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701040722030.13841@homer24.u.washington.edu>

On Thu, 4 Jan 2007, Ricardo Rios wrote:
> engineering). I think , the programming paradigm most used for make R
> packages is the functional programming , but I don't know this
> statistic. I need this information in my thesis.

Then you may be in trouble. R (and S before it) are not tidily 
classifiable.  R supports functional programming, and object-oriented 
programming, but most large bodies of code would not satisfy a purist in 
either area.  S3 classes are a very weak OOP mechanism, and R code usually 
has too much assignment to qualify as functional programming. It is also 
quite possible to write old-fashioned purely imperative code in R [a Real 
Programmer can write Fortran in any language], and some people do this.

So, in order to find out what is most widely used you need some way to 
take a probability sample of R programs, and then some criteria for 
classifying them.  All you can get from this list is information on what R 
supports, and a convenience sample of opinions on how programming should 
be done, which won't be sufficient if this really is an important issue in 
your thesis.

If you were willing to take published packages as representative 
then CRAN and Bioconductor are available for sampling....


 	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From vdergachev at rcgardis.com  Thu Jan  4 18:37:29 2007
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Thu, 4 Jan 2007 12:37:29 -0500
Subject: [Rd] How to execute R scripts simultaneously from multiple
	threads
In-Reply-To: <459CCEDB.5040201@erik.prutser.cx>
References: <459B6DBA.3050207@erik.prutser.cx>
	<200701031337.45613.vdergachev@rcgardis.com>
	<459CCEDB.5040201@erik.prutser.cx>
Message-ID: <200701041237.30054.vdergachev@rcgardis.com>

On Thursday 04 January 2007 4:54 am, Erik van Zijst wrote:
> Vladimir Dergachev wrote:
> > On Wednesday 03 January 2007 3:47 am, Erik van Zijst wrote:
> >>Appearantly the R C-API does not provide a mechanism for parallel
> >>execution..
> >>
> >>It is preferred that the solution is not based on multi-processing (like
> >>C/S), because that would introduce IPC overhead.
> >
> > One thing to keep in mind is that IPC is very fast in Linux. So unless
> > you are making lots of calls to really tiny functions this should not be
> > an issue.
>
> Using pipes or shared memory to pass things around to other processes on
> the same box is very fast indeed, but if we base our design around
> something like RServe which uses TCP it could be significantly slower.
> Our R-based system will be running scripts in response to high-volume
> real-time stock exchange data, so we expect lots of calls to many tiny
> functions indeed.

Very interesting :) 

If you are running RServe on the other box you will need to send data over 
ethernet anyway (and will probably use TCP). If it is on the same box and you 
use "localhost" the packets will go over loopback - which would be 
significantly faster.

At some point (years ago) there was even an argument on some mailiing list 
(xfree86-devel ?) about whether Xserver should support shared memory as unix 
socket was "fast enough" - with the other side arguing that when you pass 
megabyte images around (as in DVD playback) there is non-negligible overhead.

                       best

                           Vladimir Dergachev


From ross at biostat.ucsf.edu  Thu Jan  4 19:04:19 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Thu, 04 Jan 2007 10:04:19 -0800
Subject: [Rd] Am I missing something about debugging?
In-Reply-To: <D79013E40FEF254AAF0D72DFC94F27482307C0@extas4-hba.tas.csiro.au>
References: <D79013E40FEF254AAF0D72DFC94F27482307C0@extas4-hba.tas.csiro.au>
Message-ID: <1167933859.12058.28.camel@iron.psg.net>

On Thu, 2007-01-04 at 17:06 +1100, Mark.Bravington at csiro.au wrote:
> It is possible to do some of these things with the 'debug' package-- the
> article in R-news 2003 #3 shows a few of the tricks. Suppose 'b1' calls
> 'c1'. If 'c1' exists as "permanent" function defined outside 'b1' (which
> I generally prefer, for clarity), then you can call 'mtrace( c1)' and
> 'c1' will be invoked whenever it's called-- you don't have to first
> 'mtrace' 'b1' and then manually call 'mtrace(c1)' while inside 'b1'.
Is the effect of mtrace permanent?  For example, if 
b1 <- function() {
  # stuff
  c1()
  # stuff
  c1()
}
And you mtrace(c1), will both calls to c1, as well as any outside of b1,
bring up the debugger?

I ask because sometimes the normal "step" semantics in debugging is more
useful, i.e., debug into the next call to c1 only.  As I understand it,
the debug package can put a one-time only breakpoint (with go), but only
in the body of the currently active function.

Am I correct that both the debug package and the regular debug require
explicitly removing debugging from a function to turn off debugging?

> 
> Even if 'c1' is defined inside the body of 'b1', you can get something
> similar by using conditional breakpoints, like this
> 
> > mtrace( b1)
> > # whatever you type to get 'b1' going
> D(17)> # now look at the code window for 'b1' and find the line just
> after the definition of 'c1'
> D(17)> # ... say that's on line 11
> D(17)> bp( 11, {mtrace( c1);FALSE})
> # which will auto-mtrace 'c1' without stopping; of course you could
> hardwire this in the code of 'b1' too
> 
If you invoke b1 multiple times, will the previous procedure result in
wrapping c1 multiple times, e.g., first time through c1 is replaced by
mtrace(c1); second time rewrites the already rewritten fucntion?  Is
that a problem?

> the point is that you can stick all sorts of code inside a conditional
> breakpoint to do other things-- if the expression returns FALSE then the
> breakpoint won't be triggered, but the side-effects will still happen.
> You can also use conditional breakpoints and 'skip' command to patch
> code on-the-fly, but I generally find it's too much trouble.
> 
> 
> Note also the trick of 
> D(17)> bp(1,F) 
> 
> which is useful if 'b1' will be called again within the lifetime of the
> current top-level expression and you actually don't want to stop.
Is bp(1, FALSE) equivalent to mtrace(f, false), if one is currently
debugging in f?

> 
> The point about context is subtle because of R's scoping rules-- should
> one look at lexical scope, or at things defined in calling functions?
> The former happens by default in the 'debug' package (ie if you type the
> name of something that can be "seen" from the current function, then the
> debugger will find it, even if it's not defined in the current frame).
> For the latter, though, if you are currently "inside" c1, then one way
> to do it is to use 'sys.parent()' or 'sys.parent(2)' or whatever to
> figure out the frame number of the "context" you want, then you could do
> e.g.

> D(18)> sp <- sys.frame( sys.parent( 2))
> D(18)> evalq( ls(), sp)
> 
> etc which is not too bad. It's worth experimenting with sys.call etc
> while inside my debugger, too-- I have gone to some lengths to try to
> ensure that those functions work the way that might be expected (even
> though they actually don't... long story).
> 
sys.parent and friends  didn't seem to work for me in vanilla R
debugging, so this sounds really useful to me.
> If you are 'mtrace'ing one of the calling functions as well, then you
> can also look at the frame numbers in the code windows to work out where
> to 'evalq'.
I thought the frame numbers shown in the debugger are numbered
successively for the call stack, and that these are not necessarily the
same as the frame numbers in R.  My understanding is that the latter are
not guaranteed to be consecutive (relative to the call stack).  From the
description of sys.parent:
     The parent frame of a function evaluation is the environment in
     which the function was called.  It is not necessarily numbered one
     less than the frame number of the current evaluation,

> 
> The current 'debug' package doesn't include a "watch window" (even
> though it's something I rely on heavily in Delphi, my main other
> language) mainly because R can get stuck figuring out what to display in
> that window. 
Just out of curiosity, how does that problem arise?  I'd expect showing
the variables in a frame to be straightforward.

> It's not that hard to do (I used ot have one in the Splus
> version of my debugger) and I might add one in future if demand is high
> enough. It would help if there was some way to "time-out" a
> calculation-- e.g. a 'time.try' function a la
> 
>   result <- time.try( { do.some.big.calculation}, 0.05)
> 
> which would return an object of class "too-slow" if the calculation
> takes more than 0.05s.
> 
> I'm certainly willing to consider adding other features to the 'debug'
> package if they are easy enough and demand is high enough! [And if I
> have time, which I mostly don't :( ]
> 
> Hope this is of some use
> 
> Mark
Thanks for the info.  It sounds as if the better handling of sys.* in
the debug package may get me enough ability to look up the stack to
satisfy me.  Or I may discover that the ESS .Last.value problem is
behind my inability to use sys.* in the regular browser.

P.S. Earlier in this thread I mentioned that viewing even basic objects
like lists can be awkward in regular debuggers (I was thinking mostly of
C++).  As a current example, there is thread that begins at
http://lists.kde.org/?t=116777858300001&r=1&w=2&n=13 on the trials of
viewing a single string (this is for KDE, which has a C++ core).


From jeff.horner at vanderbilt.edu  Thu Jan  4 19:27:09 2007
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Thu, 04 Jan 2007 12:27:09 -0600
Subject: [Rd] How to execute R scripts simultaneously from
	multiple	threads
In-Reply-To: <200701041237.30054.vdergachev@rcgardis.com>
References: <459B6DBA.3050207@erik.prutser.cx>	<200701031337.45613.vdergachev@rcgardis.com>	<459CCEDB.5040201@erik.prutser.cx>
	<200701041237.30054.vdergachev@rcgardis.com>
Message-ID: <459D46FD.2060307@vanderbilt.edu>

Vladimir Dergachev wrote:
> On Thursday 04 January 2007 4:54 am, Erik van Zijst wrote:
>> Vladimir Dergachev wrote:
>>> On Wednesday 03 January 2007 3:47 am, Erik van Zijst wrote:
>>>> Appearantly the R C-API does not provide a mechanism for parallel
>>>> execution..
>>>>
>>>> It is preferred that the solution is not based on multi-processing (like
>>>> C/S), because that would introduce IPC overhead.
>>> One thing to keep in mind is that IPC is very fast in Linux. So unless
>>> you are making lots of calls to really tiny functions this should not be
>>> an issue.
>> Using pipes or shared memory to pass things around to other processes on
>> the same box is very fast indeed, but if we base our design around
>> something like RServe which uses TCP it could be significantly slower.
>> Our R-based system will be running scripts in response to high-volume
>> real-time stock exchange data, so we expect lots of calls to many tiny
>> functions indeed.
> 
> Very interesting :) 
> 
> If you are running RServe on the other box you will need to send data over 
> ethernet anyway (and will probably use TCP). If it is on the same box and you 
> use "localhost" the packets will go over loopback - which would be 
> significantly faster.

I haven't looked at RServe in awhile, but I think that it fires up an R 
interpreter in response to a client request and then sticks around for 
the same client to serve it additional requests. The question is how 
does it manage all the R interpreters with varying demand.

This issue is solved when you embed R into Apache (using the prefork 
MPM), as the pool of apache child processes (each with their own R 
interpreter) expands and contracts on demand. Using this with the 
loopback device would be a nice solution:

http://biostat.mc.vanderbilt.edu/RApacheProject

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From mtmorgan at fhcrc.org  Thu Jan  4 21:07:09 2007
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 04 Jan 2007 12:07:09 -0800
Subject: [Rd] How to execute R scripts simultaneously from
	multiple	threads
In-Reply-To: <459D46FD.2060307@vanderbilt.edu> (Jeffrey Horner's message of
	"Thu, 04 Jan 2007 12:27:09 -0600")
References: <459B6DBA.3050207@erik.prutser.cx>
	<200701031337.45613.vdergachev@rcgardis.com>
	<459CCEDB.5040201@erik.prutser.cx>
	<200701041237.30054.vdergachev@rcgardis.com>
	<459D46FD.2060307@vanderbilt.edu>
Message-ID: <6phvejmbloy.fsf@gopher4.fhcrc.org>

Vladimir, Jeff, et al.,

This is more pre-publicity than immediately available solution, but
we've been working on the 'RWebServices' project. The R evaluator and
user functions get wrapped in Java, and the Java exposed as web
service. We use ActiveMQ to broker transactions between the front-end
web service and persistent back-end R workers. The workers rely on
SJava to wrap and evaluate R.

Some of the features and opportunities of this system are: strongly
typed functions in R (using the TypeInfo package); native R-Java
translation (using SJava and our own converters); programmatic
interface (i.e., as web services; this benefits from use of S4 as a
formal class system); scalable computation (through addition of more /
specialized workers in ActiveMQ); and access to Java-based tools
available for web service deployment. Creating web services can be
nearly automatic, once the R functions are appropriately typed. Mostly
our focus has been on big-data computation, which might be orthogonal
to the needs of the original post.

We will provide more information at the Directions in Statistical
Computing conference in mid-February, so please drop me a line if
you'd like to be kept up-to-date.

Martin
-- 
Martin T. Morgan
Bioconductor / Computational Biology
http://bioconductor.org

Jeffrey Horner <jeff.horner at vanderbilt.edu> writes:

> Vladimir Dergachev wrote:
>> On Thursday 04 January 2007 4:54 am, Erik van Zijst wrote:
>>> Vladimir Dergachev wrote:
>>>> On Wednesday 03 January 2007 3:47 am, Erik van Zijst wrote:
>>>>> Appearantly the R C-API does not provide a mechanism for parallel
>>>>> execution..
>>>>>
>>>>> It is preferred that the solution is not based on multi-processing (like
>>>>> C/S), because that would introduce IPC overhead.
>>>> One thing to keep in mind is that IPC is very fast in Linux. So unless
>>>> you are making lots of calls to really tiny functions this should not be
>>>> an issue.
>>> Using pipes or shared memory to pass things around to other processes on
>>> the same box is very fast indeed, but if we base our design around
>>> something like RServe which uses TCP it could be significantly slower.
>>> Our R-based system will be running scripts in response to high-volume
>>> real-time stock exchange data, so we expect lots of calls to many tiny
>>> functions indeed.
>> 
>> Very interesting :) 
>> 
>> If you are running RServe on the other box you will need to send data over 
>> ethernet anyway (and will probably use TCP). If it is on the same box and you 
>> use "localhost" the packets will go over loopback - which would be 
>> significantly faster.
>
> I haven't looked at RServe in awhile, but I think that it fires up an R 
> interpreter in response to a client request and then sticks around for 
> the same client to serve it additional requests. The question is how 
> does it manage all the R interpreters with varying demand.
>
> This issue is solved when you embed R into Apache (using the prefork 
> MPM), as the pool of apache child processes (each with their own R 
> interpreter) expands and contracts on demand. Using this with the 
> loopback device would be a nice solution:
>
> http://biostat.mc.vanderbilt.edu/RApacheProject
>
> Jeff
> -- 
> http://biostat.mc.vanderbilt.edu/JeffreyHorner
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From xiao.gang.fan1 at libertysurf.fr  Thu Jan  4 21:52:07 2007
From: xiao.gang.fan1 at libertysurf.fr (Fan)
Date: Thu, 04 Jan 2007 21:52:07 +0100
Subject: [Rd] pb in regular expression with the character "-" (PR#9437)
In-Reply-To: <Pine.LNX.4.64.0701041020150.15115@gannet.stats.ox.ac.uk>
References: <20070103175522.D1D843F03E@slim.kubism.ku.dk>
	<Pine.LNX.4.64.0701041020150.15115@gannet.stats.ox.ac.uk>
Message-ID: <459D68F7.3000505@libertysurf.fr>

Let me detail a bit my bug report:

the two commands ("expected" vs "strange") should return the
same result, the objective of the commands is to test the presence
of several characters, '-'included.

The order in which we specify the different characters must not be
an issue, i.e., to test the presence of several characters, including
say char_1, the regular expressions [char_1|char_2|char_3] and 
[char_2|char_1|char_3] should play the same role. Other softwares
work just like this.

What's reported is that R actually returns different result for the
character "-" (\- in a RE) regarding it's position in the regular
expression, and the "perl" option would not be relevant.

Prof Brian Ripley wrote:
> Why do you think this is a bug in R?  You have not told us what you 
> expected, but the character range |-| contains only | .  Not agreeing 
> with your expectations (unstated or otherwise) is not a bug in R.
> 
> \- is the same as -, and - is special in character classes.  (If it is 
> first or last it is treated literally.)  And | is not a metacharacter 
> inside a character class.  Also,
> 
>> grep("[d\\-c]", c("a-a","b"))
> 
> [1] 1 2
> 
>> grep("[d\\-c]", c("a-a","b"), perl=TRUE)
> 
> [1] 1
> 
> shows that escaping - works only in perl (which you will find from the 
> background references mentioned, e.g.
> 
>   The interpretation of an ordinary character preceded by a backslash
>   ('\') is undefined.
> 
> .)
> 
> This is all carefully documented in ?regexp, e.g.
> 
>      Patterns are described here as they would be printed by 'cat': do
>      remember that backslashes need to be doubled in entering R
>      character strings from the keyboard.
> 
> 
> This is not the first time you have wasted our resources with false bug 
> reports, so please show more respect for the R developers' time.
> You were also explicitly asked not to report on obselete versions of R.
> 
> On Wed, 3 Jan 2007, xiao.gang.fan1 at libertysurf.fr wrote:
> 
>> Full_Name: FAN
>> Version: 2.4.0
>> OS: Windows
>> Submission from: (NULL) (159.50.101.9)
>>
>>
>> These are expected:
>>
>>> grep("[\-|c]", c("a-a","b"))
>>
>> [1] 1
>>
>>> gsub("[\-|c]", "&", c("a-a","b"))
>>
>> [1] "a&a" "b"
>>
>> but these are strange:
>>
>>> grep("[d|\-|c]", c("a-a","b"))
>>
>> integer(0)
>>
>>> gsub("[d|\-|c]", "&", c("a-a","b"))
>>
>> [1] "a-a" "b"
>>
>> Thanks
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From braunm at MIT.EDU  Thu Jan  4 22:09:36 2007
From: braunm at MIT.EDU (Michael Braun)
Date: Thu, 4 Jan 2007 16:09:36 -0500
Subject: [Rd] Parameter changes and segfault when calling C code through
	.Call
Message-ID: <20070104160936562.00000002744@braunm1>

I am experiencing some odd behavior with the .Call interface, and I am hoping someone out there can help me with it.  Below is a simple example (in that there are R packages that do exactly what I want), but this code illustrates the problem.  Thanks in advance for any help you can provide.

Suppose I want to compute the log density of a multivariate normal distribution using C code and the gsl library.  My R program is:

	dyn.load("mvnorm-logpdf.so")

	x<-c(0,0,0,0,0,0)
	mu<-c(0,0,0,0,0,0)
	sig<-diag(6)
	print(sig)
	w<-.Call("R_mvnorm_logpdf",as.double(x),as.double(mu),sig, as.integer(6))
	print(sig) # sig has changed after .Call

This code takes the SEXP's that were passed from R and converts them to gsl objects, and then calls the logpdf function:

# include <R.h>
# include <Rinternals.h>
# include <Rmath.h>
# include <gsl/gsl_matrix.h>
# include <gsl/gsl_vector.h>
# include <gsl/gsl_blas.h>
# include <gsl/gsl_linalg.h>
# include <gsl/gsl_math.h>


	SEXP R_mvnorm_logpdf (SEXP xx, SEXP mux, SEXP sigmax, SEXP kx) {
	
		int k = INTEGER(kx)[0];
		double * xAr = REAL(xx);
		double * muAr = REAL(mux);
		double * sigmaAr = REAL(sigmax);
		SEXP res;
	
		gsl_vector_view xView = gsl_vector_view_array(xAr,k);
		gsl_vector_view muView = gsl_vector_view_array(muAr,k);
		gsl_matrix_view sigmaView = gsl_matrix_view_array(sigmaAr,k,k);

		gsl_vector * x = &xView.vector;
		gsl_vector * mu = &muView.vector;
		gsl_matrix * sigma = &sigmaView.matrix;

1:		double logans = gsl_MB_mvnorm_logpdf(x, mu, sigma, k); // <-call logpdf here

		PROTECT(res=allocVector(REALSXP,1));
		REAL(res)[0] = logans;
		UNPROTECT(1);
		return(res);
	}

The logpdf function is here

	double gsl_MB_mvnorm_logpdf(gsl_vector * beta, gsl_vector * betaMean, gsl_matrix * sigma, int k) {
		// computes density of multivariate normal vector at vector beta, with mean betaMean and cov sigma

		double logdetSigma = 0;
		double res;
		double * kern;
		int i, err;

		// pointer to Cholesky decomp of sigma
		gsl_matrix * sigmaChol = gsl_matrix_alloc(k, k); // define matrix that will store Chol decomp
		gsl_matrix_memcpy(sigmaChol, sigma);
		gsl_linalg_cholesky_decomp(sigmaChol);

		// compute logdet of sigma by 2*sum of log of diagomal elements of chol decomp
		for (i=0; i<k; i++) {
			logdetSigma = logdetSigma + log(gsl_matrix_get(sigmaChol,i,i));
		}
		logdetSigma = 2*logdetSigma;
	
		// compute (beta-mean)' sigma^(-1) (beta-mean)
		gsl_vector * x = gsl_vector_alloc(k);

2:  // gsl_matrix_fprintf(stdout,sigma,"%f");

		gsl_vector_memcpy(x, beta);
		gsl_vector_sub(x, betaMean); // beta - betaMean
	
		gsl_vector * y = gsl_vector_alloc(k);
		gsl_vector_memcpy(y,x);
		gsl_blas_dtrsv(CblasLower, CblasNoTrans, CblasNonUnit, sigmaChol, y); // y = inv(chol)*x from BLAS
		gsl_blas_ddot(y,y,kern); // kern = y'y

		// compute log density
		res = -k*M_LN_SQRT_2PI - 0.5*(logdetSigma + *kern);
 
		// release space
		gsl_matrix_free(sigmaChol);
		gsl_vector_free(x);
		gsl_vector_free(y);

		return(res);
	} // end gsl_mvnorm_pdf

The problem is that after I make the .Call in R, the value of the sig matrix changes (the 1 in the upper left corner changes from a 1 to a 0).  Since I don't make changes to the sigma object directly, I don't know how that could happen.  The following output is the sig matrix, before and after the .Call.

	> source("pdfTest.R")
	     [,1] [,2] [,3] [,4] [,5] [,6]
	[1,]    1    0    0    0    0    0
	[2,]    0    1    0    0    0    0
	[3,]    0    0    1    0    0    0
	[4,]    0    0    0    1    0    0
	[5,]    0    0    0    0    1    0
	[6,]    0    0    0    0    0    1
	     [,1] [,2] [,3] [,4] [,5] [,6]
	[1,]    0    0    0    0    0    0
	[2,]    0    1    0    0    0    0
	[3,]    0    0    1    0    0    0
	[4,]    0    0    0    1    0    0
	[5,]    0    0    0    0    1    0
	[6,]    0    0    0    0    0    1

Through some debugging, I do know that it occurs somewhere in the logpdf function (line 1: in the first func).  I should also note that this function does compute the density correctly.

Here's some other, potentially relevant information.  Note the print statement in line 2 of the logpdf function.  If that print were "uncommented" and placed somewhere *earlier* in the function, the elements of the sigma matrix are as they should be, and the program runs with no problem (except for the change in sig as described above).  However, if the print statement is at line 2: or later, the correct matrix elements are printed, but then the .Call crashes with the following message:

	 *** caught segfault ***
	address 0x6, cause 'memory not mapped'

(If I change the size of the matrix to diag(k), the 0x6 becomes 0xk). So, for some reason, k is interpreted as a memory address.  I double-checked for places where I may have confused pointers and values, but I can't see where that would have happened.  Also, after searching through the R-devel archives, I noticed that others have had other odd 'memory not mapped' errors in totally different scenarios.

So I am flummoxed, and don't really know where to go from here.

Best wishes,

MB



------------------------------------------
Michael Braun
Assistant Professor of Marketing
MIT Sloan School of Management
38 Memorial Drive, E56-329
Cambridge, MA 02139
braunm at mit.edu
(617) 253-3436


From maechler at stat.math.ethz.ch  Thu Jan  4 22:18:08 2007
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Thu,  4 Jan 2007 22:18:08 +0100 (CET)
Subject: [Rd] pb in regular expression with the character "-" (PR#9437)
Message-ID: <20070104211808.504803F03A@slim.kubism.ku.dk>

>>>>> "FanX" == Xiao Gang Fan <xiao.gang.fan1 at libertysurf.fr>
>>>>>     on Thu, 04 Jan 2007 21:52:07 +0100 writes:

    FanX> Let me detail a bit my bug report: the two commands
    FanX> ("expected" vs "strange") should return the same
    FanX> result, the objective of the commands is to test the
    FanX> presence of several characters, '-'included.

    FanX> The order in which we specify the different characters
    FanX> must not be an issue, i.e., to test the presence of
    FanX> several characters, including say char_1, the regular
    FanX> expressions [char_1|char_2|char_3] and
    FanX> [char_2|char_1|char_3] should play the same
    FanX> role. Other softwares work just like this.

    FanX> What's reported is that R actually returns different
    FanX> result for the character "-" (\- in a RE) regarding
    FanX> it's position in the regular expression, and the
    FanX> "perl" option would not be relevant.

Fan, it seems haven't understood what Brian Ripley explained to
you:  Let me try to spell it out for you:

"\-" is *NOT* what you seem still to be thinking it is:

  > "\-"
  [1] "-"
  > identical("\-", "-")
  [1] TRUE
  > 

This is all in the R-FAQ entry
    >>> 7.37 Why does backslash behave strangely inside strings?
========================================================





and in several other places, and yes,
please do read the R FAQ and maybe more documentation
about R and "bug reporting" before your next bug report.

Consider my guesstimate:
For 99% of all R users, the amount of time they need working
pretty intensely with R before they find a bug in it, 
is nowadays more than three years, and maybe even much more
-- such as their lifetime :-)

Martin Maechler, ETH Zurich



    FanX> Prof Brian Ripley wrote:
    >> Why do you think this is a bug in R?  You have not told
    >> us what you expected, but the character range |-|
    >> contains only | .  Not agreeing with your expectations
    >> (unstated or otherwise) is not a bug in R.
    >> 
    >> \- is the same as -, and - is special in character
    >> classes.  (If it is first or last it is treated
    >> literally.)  And | is not a metacharacter inside a
    >> character class.  Also,
    >> 
    >>> grep("[d\\-c]", c("a-a","b"))
    >>  [1] 1 2
    >> 
    >>> grep("[d\\-c]", c("a-a","b"), perl=TRUE)
    >>  [1] 1
    >> 
    >> shows that escaping - works only in perl (which you will
    >> find from the background references mentioned, e.g.
    >> 
    >> The interpretation of an ordinary character preceded by a
    >> backslash ('\') is undefined.
    >> 
    >> .)
    >> 
    >> This is all carefully documented in ?regexp, e.g.
    >> 
    >> Patterns are described here as they would be printed by
    >> 'cat': do remember that backslashes need to be doubled in
    >> entering R character strings from the keyboard.
    >> 
    >> 
    >> This is not the first time you have wasted our resources
    >> with false bug reports, so please show more respect for
    >> the R developers' time.  You were also explicitly asked
    >> not to report on obselete versions of R.
    >> 
    >> On Wed, 3 Jan 2007, xiao.gang.fan1 at libertysurf.fr wrote:
    >> 
    >>> Full_Name: FAN Version: 2.4.0 OS: Windows Submission
    >>> from: (NULL) (159.50.101.9)
    >>> 
    >>> 
    >>> These are expected:
    >>> 
    >>>> grep("[\-|c]", c("a-a","b"))
    >>>  [1] 1
    >>> 
    >>>> gsub("[\-|c]", "&", c("a-a","b"))
    >>>  [1] "a&a" "b"
    >>> 
    >>> but these are strange:
    >>> 
    >>>> grep("[d|\-|c]", c("a-a","b"))
    >>>  integer(0)
    >>> 
    >>>> gsub("[d|\-|c]", "&", c("a-a","b"))
    >>>  [1] "a-a" "b"
    >>> 
    >>> Thanks
    >>> 
    >>> ______________________________________________
    >>> R-devel at r-project.org mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>> 
    >>

    FanX> ______________________________________________
    FanX> R-devel at r-project.org mailing list
    FanX> https://stat.ethz.ch/mailman/listinfo/r-devel


From sfalcon at fhcrc.org  Thu Jan  4 22:31:01 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Thu, 04 Jan 2007 13:31:01 -0800
Subject: [Rd] Parameter changes and segfault when calling C code through
	.Call
In-Reply-To: <20070104160936562.00000002744@braunm1> (Michael Braun's message
	of "Thu, 4 Jan 2007 16:09:36 -0500")
References: <20070104160936562.00000002744@braunm1>
Message-ID: <m27iw232ei.fsf@fhcrc.org>

"Michael Braun" <braunm at MIT.EDU> writes:
> Suppose I want to compute the log density of a multivariate normal
> distribution using C code and the gsl library.  My R program is:

>
> 	dyn.load("mvnorm-logpdf.so")
>
> 	x<-c(0,0,0,0,0,0)
> 	mu<-c(0,0,0,0,0,0)
> 	sig<-diag(6)
> 	print(sig)
> 	w<-.Call("R_mvnorm_logpdf",as.double(x),as.double(mu),sig, as.integer(6))
> 	print(sig) # sig has changed after .Call

Arguments sent via the .Call interface are not copied.  In almost all
cases, they should be treated as read-only data.

You can copy a given SEXP using duplicate.  Something along these
lines (untested):

   SEXP sigma_copy;
   PROTECT(sigma_copy = duplicate(sigmax));

But it seems pretty clear that sigmaView is holding a pointer to
sigmaAr which in turn points to the data in sigmax.

+ seth


From ripley at stats.ox.ac.uk  Fri Jan  5 00:06:00 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Fri,  5 Jan 2007 00:06:00 +0100 (CET)
Subject: [Rd] pb in regular expression with the character "-" (PR#9437)
Message-ID: <20070104230600.7E8AB572FE@slim.kubism.ku.dk>

Both Solaris 8 grep and GNU grep 2.5.1 give

gannet% cat > foo.txt
a-a
b
gannet% egrep '[d|-|c]' foo.txt
gannet% egrep '[-|c]' foo.txt
a-a

agreeing exactly with R (and the POSIX standard) and contradicting 'Fan'.


On Thu, 4 Jan 2007, Fan wrote:

> Let me detail a bit my bug report:
>
> the two commands ("expected" vs "strange") should return the
> same result, the objective of the commands is to test the presence
> of several characters, '-'included.
>
> The order in which we specify the different characters must not be
> an issue, i.e., to test the presence of several characters, including
> say char_1, the regular expressions [char_1|char_2|char_3] and 
> [char_2|char_1|char_3] should play the same role. Other softwares
> work just like this.
>
> What's reported is that R actually returns different result for the
> character "-" (\- in a RE) regarding it's position in the regular
> expression, and the "perl" option would not be relevant.

As described in the relevant international standard and R's own 
documentation.

> Prof Brian Ripley wrote:
>> Why do you think this is a bug in R?  You have not told us what you 
>> expected, but the character range |-| contains only | .  Not agreeing with 
>> your expectations (unstated or otherwise) is not a bug in R.
>> 
>> \- is the same as -, and - is special in character classes.  (If it is 
>> first or last it is treated literally.)  And | is not a metacharacter 
>> inside a character class.  Also,
>> 
>>> grep("[d\\-c]", c("a-a","b"))
>> 
>> [1] 1 2
>> 
>>> grep("[d\\-c]", c("a-a","b"), perl=TRUE)
>> 
>> [1] 1
>> 
>> shows that escaping - works only in perl (which you will find from the 
>> background references mentioned, e.g.
>>
>>   The interpretation of an ordinary character preceded by a backslash
>>   ('\') is undefined.
>> 
>> .)
>> 
>> This is all carefully documented in ?regexp, e.g.
>>
>>      Patterns are described here as they would be printed by 'cat': do
>>      remember that backslashes need to be doubled in entering R
>>      character strings from the keyboard.
>> 
>> 
>> This is not the first time you have wasted our resources with false bug 
>> reports, so please show more respect for the R developers' time.
>> You were also explicitly asked not to report on obselete versions of R.
>> 
>> On Wed, 3 Jan 2007, xiao.gang.fan1 at libertysurf.fr wrote:
>> 
>>> Full_Name: FAN
>>> Version: 2.4.0
>>> OS: Windows
>>> Submission from: (NULL) (159.50.101.9)
>>> 
>>> 
>>> These are expected:
>>> 
>>>> grep("[\-|c]", c("a-a","b"))
>>> 
>>> [1] 1
>>> 
>>>> gsub("[\-|c]", "&", c("a-a","b"))
>>> 
>>> [1] "a&a" "b"
>>> 
>>> but these are strange:
>>> 
>>>> grep("[d|\-|c]", c("a-a","b"))
>>> 
>>> integer(0)
>>> 
>>>> gsub("[d|\-|c]", "&", c("a-a","b"))
>>> 
>>> [1] "a-a" "b"
>>> 
>>> Thanks
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Mark.Bravington at csiro.au  Fri Jan  5 00:16:34 2007
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Fri, 5 Jan 2007 10:16:34 +1100
Subject: [Rd] Am I missing something about debugging?
Message-ID: <D79013E40FEF254AAF0D72DFC94F27482307C1@extas4-hba.tas.csiro.au>

Hi Ross

> Suppose 'b1' 
> > calls 'c1'. If 'c1' exists as "permanent" function defined outside 
> > 'b1' (which I generally prefer, for clarity), then you can call 
> > 'mtrace( c1)' and 'c1' will be invoked whenever it's called-- you 
> > don't have to first 'mtrace' 'b1' and then manually call 
> 'mtrace(c1)' while inside 'b1'.
> Is the effect of mtrace permanent?  For example, if
> b1 <- function() {
>   # stuff
>   c1()
>   # stuff
>   c1()
> }
> And you mtrace(c1), will both calls to c1, as well as any 
> outside of b1, bring up the debugger?

Yes. But there are a couple of tricks you could use to avoid it. First
(less neat), you could 'mtrace( b1)' and then set two fake conditional
breakpoints inside 'b1': one of '{mtrace( c1);F}' before the first call
to 'c1', and one of '{mtrace(c1,F);F}' just after. Second (neater), you
could avoid 'mtrace'ing 'b1' altogether, and instead replace the default
breakpoint at line 1 in 'c1' [SEE ** BELOW] with a conditional
breakpoint. The conditional breakpoint would have to be a bit clever--
it might have to inspect the value of a variable in 'b1' or something
like that. For example, suppose you wrote 'b1' like this:

c1.call.count <- 1
c1( ...)
repeat{
  c1.call.count <- c1.call.count+1
  blah.blah.blah()
  c1(...)
}

Then you could 'mtrace( c1)' and do 

'bp( 1, { get( 'c1.call.count', envir=sys.frame( mvb.sys.parent()))==1,
fname='c1')'

before running 'b1'. Lo & behold, it will only stop in 'c1' on the first
call, not on subsequent ones. [I guess I could add a pass count feature
to the debugger, to make this easier.]

Note that you can call 'bp' without actually being in debug mode, by
using the 'fname' parameter-- the problem is that it is not usually
obvious what line number to set the breakpoint at (though you can find
out by inspecting 'tracees$f'). You can alternatively just 'mtrace( c1)'
and then reset the breakpoint manually the first time it comes up.

One thing I noticed while trying the stuff above, is that you do need to
use 'mvb.sys.parent' instead of 'sys.parent' in the above.
'mvb.sys.parent' and friends are the "do what I mean, not what I say"
equivalents of 'sys.parent' etc for use inside the debugger. The 'debug'
package goes to some trouble to replace calls to 'sys.parent' with calls
to the 'mvb...' equivalents, both in user input and in the debuggee
function, but evidently doesn't do so inside breakpoint expressions.
Consider it a feature...

The frame stack is a thing of great weirdness, by the way; the same
frame can appear several times in the stack, especially when debugging.
I would not recommend trying to really understand it unless you really
have to; the 'debug' package makes efforts to avoid you having to!

> 
> I ask because sometimes the normal "step" semantics in 
> debugging is more useful, i.e., debug into the next call to 
> c1 only.  As I understand it, the debug package can put a 
> one-time only breakpoint (with go), but only in the body of 
> the currently active function.
> 
> Am I correct that both the debug package and the regular 
> debug require explicitly removing debugging from a function 
> to turn off debugging?

True, for the debug package. Not sure about vanilla R debugging
(dissatisfaction with which drove me to write the 'debug' package-- so I
don't use the vanilla stuff these days!).

> 
> > 
> > Even if 'c1' is defined inside the body of 'b1', you can 
> get something 
> > similar by using conditional breakpoints, like this
> > 
> > > mtrace( b1)
> > > # whatever you type to get 'b1' going
> > D(17)> # now look at the code window for 'b1' and find the 
> line just 
> > after the definition of 'c1'
> > D(17)> # ... say that's on line 11
> > D(17)> bp( 11, {mtrace( c1);FALSE})
> > # which will auto-mtrace 'c1' without stopping; of course you could 
> > hardwire this in the code of 'b1' too
> > 
> If you invoke b1 multiple times, will the previous procedure 
> result in wrapping c1 multiple times, e.g., first time 
> through c1 is replaced by mtrace(c1); second time rewrites 
> the already rewritten fucntion?  Is that a problem?

It won't cause a problem; the 'debug' package notices when a function
has already been 'mtrace'd (by inspecting the actual function body) and
doesn't add another "layer".

> 
> > the point is that you can stick all sorts of code inside a 
> conditional 
> > breakpoint to do other things-- if the expression returns 
> FALSE then 
> > the breakpoint won't be triggered, but the side-effects 
> will still happen.
> > You can also use conditional breakpoints and 'skip' command 
> to patch 
> > code on-the-fly, but I generally find it's too much trouble.
> > 
> > 
> > Note also the trick of
> > D(17)> bp(1,F)
> > 
> > which is useful if 'b1' will be called again within the lifetime of 
> > the current top-level expression and you actually don't 
> want to stop.
> Is bp(1, FALSE) equivalent to mtrace(f, false), if one is 
> currently debugging in f?

[**] 
Not exactly-- but read on. If 'f' is running, you can't un-'mtrace' it.
However, you can prevent the debugger *stopping* when it next enters 'f'
(the difference then is only one of speed). When you 'mtrace' a
function, a breakpoint is set on line 1, to ensure that the debugger
halts for user input when the function is entered. (You'll see a red
asterisk in the code window at line 1, to show that there's some kind of
breakpoint there.) What 'bp(1,F)' does, is disable that breakpoint, so
that the debugger will keep plowing through the code of 'f' without
halting (until another breakpoint or an error). The code window isn't
displayed until/unless the debugger actually halts.

> 
> > 
> > The point about context is subtle because of R's scoping rules-- 
> > should one look at lexical scope, or at things defined in 
> calling functions?
> > The former happens by default in the 'debug' package (ie if 
> you type 
> > the name of something that can be "seen" from the current function, 
> > then the debugger will find it, even if it's not defined in 
> the current frame).
> > For the latter, though, if you are currently "inside" c1, 
> then one way 
> > to do it is to use 'sys.parent()' or 'sys.parent(2)' or whatever to 
> > figure out the frame number of the "context" you want, then 
> you could 
> > do e.g.
> 
> > D(18)> sp <- sys.frame( sys.parent( 2)) D(18)> evalq( ls(), sp)
> > 
> > etc which is not too bad. It's worth experimenting with 
> sys.call etc 
> > while inside my debugger, too-- I have gone to some lengths 
> to try to 
> > ensure that those functions work the way that might be 
> expected (even 
> > though they actually don't... long story).
> > 
> sys.parent and friends  didn't seem to work for me in vanilla 
> R debugging, so this sounds really useful to me.
> > If you are 'mtrace'ing one of the calling functions as 
> well, then you 
> > can also look at the frame numbers in the code windows to work out 
> > where to 'evalq'.
> I thought the frame numbers shown in the debugger are 
> numbered successively for the call stack, and that these are 
> not necessarily the same as the frame numbers in R.  My 
> understanding is that the latter are not guaranteed to be 
> consecutive (relative to the call stack).  From the 
> description of sys.parent:
>      The parent frame of a function evaluation is the environment in
>      which the function was called.  It is not necessarily 
> numbered one
>      less than the frame number of the current evaluation,
> 

The number shown in the 'debug' package (ie the number xxx in the
"D(xxx)>" prompt, and in the separate code windows) is the true frame
number. So I will quite often have two code windows visible, one saying
"outerfunc(4)" and the other [currently active] saying "innerfunc(17)".
Typing 'sys.nframe' will return 17 and 'sys.parent()' will return 4.

again, not sure about vanilla debug.

> > 
> > The current 'debug' package doesn't include a "watch window" (even 
> > though it's something I rely on heavily in Delphi, my main other
> > language) mainly because R can get stuck figuring out what 
> to display 
> > in that window.
> Just out of curiosity, how does that problem arise?  I'd 
> expect showing the variables in a frame to be straightforward.

I think the main issue is ensuring that the watch expressions don't take
overwhelmingly long to display.... imagine if you have some really huge
object resulting from a watch expression which takes 5 minutes to
print-- how do you get R to display only the first 2 lines "quickly"?
What about things that have weird attributes? What if there is a bug in
the print method for the class of object, or a mismatch between the
object's contents and the expectation of the print method? All sorts of
awkwardness can & does happen... Sod's law at work, basically.  I
haven't looked into how far things like 'str' could make it painless
these days.

HTH

Mark

Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623

> 
> > It's not that hard to do (I used ot have one in the Splus 
> version of 
> > my debugger) and I might add one in future if demand is 
> high enough. 
> > It would help if there was some way to "time-out" a
> > calculation-- e.g. a 'time.try' function a la
> > 
> >   result <- time.try( { do.some.big.calculation}, 0.05)
> > 
> > which would return an object of class "too-slow" if the calculation 
> > takes more than 0.05s.
> > 
> > I'm certainly willing to consider adding other features to 
> the 'debug'
> > package if they are easy enough and demand is high enough! 
> [And if I 
> > have time, which I mostly don't :( ]
> > 
> > Hope this is of some use
> > 
> > Mark
> Thanks for the info.  It sounds as if the better handling of 
> sys.* in the debug package may get me enough ability to look 
> up the stack to satisfy me.  Or I may discover that the ESS 
> .Last.value problem is behind my inability to use sys.* in 
> the regular browser.
> 
> P.S. Earlier in this thread I mentioned that viewing even 
> basic objects like lists can be awkward in regular debuggers 
> (I was thinking mostly of
> C++).  As a current example, there is thread that begins at
> http://lists.kde.org/?t=116777858300001&r=1&w=2&n=13 on the 
> trials of viewing a single string (this is for KDE, which has 
> a C++ core).
> 
>


From r at erik.prutser.cx  Fri Jan  5 10:58:41 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Fri, 05 Jan 2007 10:58:41 +0100
Subject: [Rd] How to execute R scripts simultaneously
	from	multiple	threads
In-Reply-To: <6phvejmbloy.fsf@gopher4.fhcrc.org>
References: <459B6DBA.3050207@erik.prutser.cx>	<200701031337.45613.vdergachev@rcgardis.com>	<459CCEDB.5040201@erik.prutser.cx>	<200701041237.30054.vdergachev@rcgardis.com>	<459D46FD.2060307@vanderbilt.edu>
	<6phvejmbloy.fsf@gopher4.fhcrc.org>
Message-ID: <459E2151.8000708@erik.prutser.cx>

Hi Martin,

Your approach of bolting a webservices layer on top of R is a really
nice (and quite natural) thing to do.

I appreciate your early announcement in response to our thread and I'd
very much like to be kept in the loop of future announcements, so please
add my address to your list.

As you already suggested, webservices are fairly expensive with their
HTTP and XML-parsing, making it less suitable for many small
invocations. However, it makes an ideal fit in most other environments.
Webservices adoption has come a long way, so I expect it to easily find
its way into the enterprise (is it GPL-licensed?).

cheers,
Erik


Martin Morgan wrote:
> Vladimir, Jeff, et al.,
> 
> This is more pre-publicity than immediately available solution, but
> we've been working on the 'RWebServices' project. The R evaluator and
> user functions get wrapped in Java, and the Java exposed as web
> service. We use ActiveMQ to broker transactions between the front-end
> web service and persistent back-end R workers. The workers rely on
> SJava to wrap and evaluate R.
> 
> Some of the features and opportunities of this system are: strongly
> typed functions in R (using the TypeInfo package); native R-Java
> translation (using SJava and our own converters); programmatic
> interface (i.e., as web services; this benefits from use of S4 as a
> formal class system); scalable computation (through addition of more /
> specialized workers in ActiveMQ); and access to Java-based tools
> available for web service deployment. Creating web services can be
> nearly automatic, once the R functions are appropriately typed. Mostly
> our focus has been on big-data computation, which might be orthogonal
> to the needs of the original post.
> 
> We will provide more information at the Directions in Statistical
> Computing conference in mid-February, so please drop me a line if
> you'd like to be kept up-to-date.
> 
> Martin

-- 
<< WAIT >>


From ripley at stats.ox.ac.uk  Fri Jan  5 11:00:09 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Jan 2007 10:00:09 +0000 (GMT)
Subject: [Rd] Connections to https: URLs -- IE expert help needed
In-Reply-To: <20070102011502.GE27570@wald.ucdavis.edu>
References: <Pine.LNX.4.64.0612201725400.12201@gannet.stats.ox.ac.uk>
	<4589B4E1.8090102@wald.ucdavis.edu>
	<17817.33808.900582.330470@mithrandir.hornik.net>
	<20070102011502.GE27570@wald.ucdavis.edu>
Message-ID: <Pine.LNX.4.64.0701050943540.2656@gannet.stats.ox.ac.uk>

On Mon, 1 Jan 2007, Duncan Temple Lang wrote:

> Kurt Hornik wrote:
>>>>>>> Duncan Temple Lang writes:
>>
>>> -----BEGIN PGP SIGNED MESSAGE-----
>>> Hash: SHA1
>>
>>> Prof Brian Ripley wrote:
>>>> I've added to R-devel the ability to use download.file() and url() to
>>>> https: URLs, *only* if --internet2 is used on Windows.
>>>>
>>>> This uses the Internet Explorer internals, and only works if the
>>>> certificate is accepted (so e.g. does not work for
>>>> https://svn.r-project.org).
>>>>
>>>> Now I use IE (and Windows for that matter) only when really necessary, and
>>>> Firefox has simple ways to permanently accept non-verifiable certificates.
>>>> I would be grateful if someone who is much more familiar with IE could
>>>> write a note explaining how to deal with this that we could add to the
>>>> rw-FAQ.
>>>>
>>>> To forestall the inevitable question: there are no plans to add https:
>>>> support on any other platform, but it is something that would make a nice
>>>> project for a user contribution.  The current internal code is based on
>>>> likxml2, and that AFAICS still does not have https: support.
>>>>
>>
>>> Generally (i.e. not in particular response to Brian but related to
>>> this thread)
>>
>> With a similar disclaimer: Brian's efforts were triggered by me asking
>> how to use url() to read R's mailing list archive files, such as
>>
>>   https://stat.ethz.ch/pipermail/r-help/2007-January.txt.gz
>>
>> directly into R.  Turns out we cannot ... which, in a way, is a shame
>> ("R cannot read its own web pages") :-(
>
> Indeed, it is a shame.  Although, when I process mail messages,
> I use Perl's very rich collection of modules for processing
> mail in so many different formats. And then I use RSPerl
> to control this and get the data into R pretty quickly.
> So we can do it in R and probably the delegation to
> mail-processing software is a good given the number of special
> cases, etc.
>
> And even if we had HTTPs in R, we would still want to deal with
> the certificate on that page, which gets us to more details.
> Which is the reason I think leaving things to libcurl,
> libwww, etc. will be best as they continue to evolve
> to handle new protocols and settings.

The issue here is the same as it ever was, that of event-loops and not 
blocking the R process.  I think that is where the missing extensibility 
is, and it has been raised for at least 6 years now.

If I try to get that example URI with RCurl it

1) blocks the R process for a long time.
2) fails to retrieve the URI as it is unable to handle the certificate.

Can you please point us to an extension package that behaves better?

[When Kurt first sent me the example, I was surprised that wget handled 
it. I then checked, and wget < 1.10 does not check certificates at all.]

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From r at erik.prutser.cx  Fri Jan  5 11:04:51 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Fri, 05 Jan 2007 11:04:51 +0100
Subject: [Rd] How to execute R scripts simultaneously from
	multiple	threads
In-Reply-To: <459D46FD.2060307@vanderbilt.edu>
References: <459B6DBA.3050207@erik.prutser.cx>	<200701031337.45613.vdergachev@rcgardis.com>	<459CCEDB.5040201@erik.prutser.cx>
	<200701041237.30054.vdergachev@rcgardis.com>
	<459D46FD.2060307@vanderbilt.edu>
Message-ID: <459E22C3.3040801@erik.prutser.cx>

Jeffrey Horner wrote:
> I haven't looked at RServe in awhile, but I think that it fires up an R 
> interpreter in response to a client request and then sticks around for 
> the same client to serve it additional requests. The question is how 
> does it manage all the R interpreters with varying demand.
> 
> This issue is solved when you embed R into Apache (using the prefork 
> MPM), as the pool of apache child processes (each with their own R 
> interpreter) expands and contracts on demand. Using this with the 
> loopback device would be a nice solution:

We've looked at RApache as well. It offers a nice pooling solution quite 
in line with Apache's own runtime.
We'd certainly need pooling for our solution as we can't afford a fork 
for each evaluation. Luckily, as you mentioned already, this is fairly 
easy when using RServe as well. If you keep the connection to an 
R-process open, it stays alive. We'd do the actual pooling mechanism 
ourselves.

Erik
-- 
QOTD:
	"I'm on a seafood diet -- I see food and I eat it."


From r at erik.prutser.cx  Fri Jan  5 11:29:48 2007
From: r at erik.prutser.cx (Erik van Zijst)
Date: Fri, 05 Jan 2007 11:29:48 +0100
Subject: [Rd] How to execute R scripts simultaneously from multiple
	threads
In-Reply-To: <200701041237.30054.vdergachev@rcgardis.com>
References: <459B6DBA.3050207@erik.prutser.cx>
	<200701031337.45613.vdergachev@rcgardis.com>
	<459CCEDB.5040201@erik.prutser.cx>
	<200701041237.30054.vdergachev@rcgardis.com>
Message-ID: <459E289C.1080201@erik.prutser.cx>

Vladimir Dergachev wrote:
>>Using pipes or shared memory to pass things around to other processes on
>>the same box is very fast indeed, but if we base our design around
>>something like RServe which uses TCP it could be significantly slower.
>>Our R-based system will be running scripts in response to high-volume
>>real-time stock exchange data, so we expect lots of calls to many tiny
>>functions indeed.
> 
> Very interesting :) 
> 
> If you are running RServe on the other box you will need to send data over 
> ethernet anyway (and will probably use TCP). If it is on the same box and you 
> use "localhost" the packets will go over loopback - which would be 
> significantly faster.

I'd like to do as little IO as possible, so I'm looking at using a 
single, very powerfull box and keep everything local.

> At some point (years ago) there was even an argument on some mailiing list 
> (xfree86-devel ?) about whether Xserver should support shared memory as unix 
> socket was "fast enough" - with the other side arguing that when you pass 
> megabyte images around (as in DVD playback) there is non-negligible overhead.

We're currently doing performance tests with the RServe-approach where 
we measure the actual evaluation time of a function. I'm interested in 
the evaluation-time versus overhead ratio. Loopback TCP might work as 
long as this ratio is sufficiently high.

Erik
-- 
Practice is the best of all instructors.
		-- Publilius


From mtmorgan at fhcrc.org  Fri Jan  5 14:16:18 2007
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 05 Jan 2007 05:16:18 -0800
Subject: [Rd] How to execute R scripts simultaneously
	from	multiple	threads
In-Reply-To: <459E2151.8000708@erik.prutser.cx> (Erik van Zijst's message of
	"Fri, 05 Jan 2007 10:58:41 +0100")
References: <459B6DBA.3050207@erik.prutser.cx>
	<200701031337.45613.vdergachev@rcgardis.com>
	<459CCEDB.5040201@erik.prutser.cx>
	<200701041237.30054.vdergachev@rcgardis.com>
	<459D46FD.2060307@vanderbilt.edu> <6phvejmbloy.fsf@gopher4.fhcrc.org>
	<459E2151.8000708@erik.prutser.cx>
Message-ID: <6phac0x7gwt.fsf@gopher4.fhcrc.org>

Hi Erik,

Erik van Zijst <r at erik.prutser.cx> writes:

> Hi Martin,
>
> Your approach of bolting a webservices layer on top of R is a really
> nice (and quite natural) thing to do.
[...]
> As you already suggested, webservices are fairly expensive with their
> HTTP and XML-parsing, making it less suitable for many small
> invocations. However, it makes an ideal fit in most other environments.
> Webservices adoption has come a long way, so I expect it to easily find
> its way into the enterprise (is it GPL-licensed?).

The core work is supported by funds from http://cabig.cancer.gov; the
license is open-source (see links at
http://cabig.nci.nih.gov/working_groups/DSIC_SLWG).

Thanks for your interest and support,

Martin
-- 
Martin T. Morgan
Bioconductor / Computational Biology
http://bioconductor.org


From jcadima at math.isa.utl.pt  Fri Jan  5 17:18:40 2007
From: jcadima at math.isa.utl.pt (Jorge Cadima)
Date: Fri, 05 Jan 2007 16:18:40 +0000
Subject: [Rd] help for memory problem with 64-bit machines
Message-ID: <E1H2rmC-0005nz-00@DMjcadima>


Hello,

I would appreciate *any* ideas on this problem. I'm the maintainer of a 
package ("subselect"), which on CRAN's Daily Package Checks is OK on all 
flavours of R, except  r-devel Linux x86_64, where there is a "memory not 
mapped" segfault with the very first example that is tried out (output below). 
Additionally, a user with an AMD64 machine has just reported a similar 
problem, and kindly ran a couple of tests identifying the culprit (output 
below):a Fortran routine. Unfortunately, I don't have 64-bit machines 
available and the segfault has not occured with other machines, so I am having 
trouble trying to spot the problem.

I suspect the problem lies in  one of two things:

1) The Fortran subroutine where the crash occurs has variable-length arrays. 
Could there be a problem with this (the user who spotted the problem is 
running the gfortran gcc compiler - I presume r-devel Linux x86_64 does too)?
3) the guilty routine ("randsk1") calls a second routine ("randint") which, in 
turn, calls R's Random Number Generator. Can the problem arise in the 
Fortran/R interface?

As I said, any idea of what the problem may be, or where I can look for help, 
would be much appreciated.

In despair, but with best regards,
Jorge Cadima

-------------------------------------------------------------------------------
---
--- Cran Daily Package check output -------------------------------------------
---
-------------------------------------------------------------------------------
---

    * using R version 2.5.0 Under development (unstable) (2007-01-03 r40349)
    * checking for file 'subselect/DESCRIPTION' ... OK
    * this is package 'subselect' version '0.9-999'
    * checking package dependencies ... OK
 (...)
    * creating subselect-Ex.R ... OK
    * checking examples ... ERROR
      Running examples in 'subselect-Ex.R' failed.
      The error most likely occurred in:

      > ### * anneal
      >
      > flush(stderr()); flush(stdout())
      >
      > ### Name: anneal
      > ### Title: Simulated Annealing Search for an optimal k-variable subset
      > ### Aliases: anneal
      > ### Keywords: manip
      >
      > ### ** Examples
      >
      >
      > ## --------------------------------------------------------------------
      >
      > ##
      > ## (1) For illustration of use, a small data set with very few 
iterations
      > ## of the algorithm, using the RM criterion.
      > ##
      >
      > data(swiss)
      > anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")

      *** caught segfault ***
      address 0x47cd37c, cause 'memory not mapped'

      Traceback:
      1: .Fortran("anneal", as.integer(criterio), as.integer(p), 
as.double(as.vector(mat)), as.integer(kmin), as.integer(kmax), 
as.double(valores), as.integer(vars), as.double(bestval), as.integer(bestvar), 
as.integer(nexclude), as.integer(exc), as.integer(ninclude), as.integer(inc), 
as.integer(nsol), as.integer(niter), as.logical(improvement), 
as.double(cooling), as.double(temp), as.integer(coolfreq), 
as.integer(length(pcindices)), as.integer(pcindices), as.logical(esp), 
as.logical(silog), as.integer(as.vector(initialsol)), as.double(valp), 
as.double(as.vector(vecp)), as.double(as.vector(H)), as.integer(r), PACKAGE = 
"subselect")
      2: anneal(cor(swiss), 2, 3, nsol = 4, niter = 10, criterion = "RM")
      aborting ...

-------------------------------------------------------------------------------
-----
------- user's tests output ---------------------------------------------------
--
-------------------------------------------------------------------------------
--

The install
===========

work:/home/jimmy/R # R CMD INSTALL subselect_0.9-999.tar.gz
* Installing *source* package 'subselect' ...
** libs
gfortran   -fpic   -c anneal.f -o anneal.o
gfortran   -fpic   -c auxiliar.f -o auxiliar.o
g++ -I/usr/lib64/R/include -I/usr/lib64/R/include  -I/usr/local/include   
-fpic  -g -O2 -c CCRcrt.cpp -o CCRcrt.o

(...)

g++ -I/usr/lib64/R/include -I/usr/lib64/R/include  -I/usr/local/include   
-fpic  -g -O2 -c Wrkf1.cpp -o Wrkf1.o
g++ -shared -L/usr/local/lib64 -o subselect.so anneal.o auxiliar.o CCRcrt.o 
GCDcrt.o genetic.o Gstatma.o improve.o MStcrt.o NewtonRp.o Qforms.o RMcrt.o 
Rnk3CCRcrt.o RVcrt.o SpecialArrays.o SR_datatrnsf.o SR_intf.o SRI_sscma.o 
Sscma.o Subsets.o Varsmbo.o VSQforms.o wrap.o Wrkf1.o -L/usr/lib64/R/lib 
-lRlapack  -lgfortran -lm -lgcc_s -lgfortran -lm -lgcc_s -L/usr/lib64/R/lib -lR
** R
** inst
** preparing package for lazy loading
** help
 >>> Building/Updating help pages for package 'subselect'
     Formats: text html latex example
  anneal                            text    html    latex   example

(...)

  zeta2                             text    html    latex   example
** building package indices ...
* DONE (subselect)
work:/home/jimmy/R #                   



The library is put into:
/usr/lib64/R/library/subselect/libs/subselect.so

and nm -s give me (in part):

work:/home/jimmy/R # nm -s /usr/lib64/R/library/subselect/libs/subselect.so
0000000000012a4c T anneal_
....
0000000000014580 T randint_
000000000001446a T randsk1_
                 U Rf_error
000000000003470f T rndend_
0000000000034704 T rndstart_
                 U Rprintf
....
etc

So randsk1 is there.


Running the subselect example from the manual:

jimmy at work:~> R

R : Copyright 2006, The R Foundation for Statistical Computing
Version 2.3.1 (2006-06-01)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(subselect)
> data(swiss)
> anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")

 *** caught segfault ***
address 0xffffffffb03f38dc, cause 'memory not mapped'

Traceback:
 1: .Fortran("anneal", as.integer(criterio), as.integer(p), 
as.double(as.vector(mat)),     as.integer(kmin), as.integer(kmax), 
as.double(valores), as.integer(vars),     as.double(bestval), 
as.integer(bestvar), as.integer(nexclude),     as.integer(exc), 
as.integer(ninclude), as.integer(inc), as.integer(nsol),     
as.integer(niter), as.logical(improvement), as.double(cooling),     
as.double(temp), as.integer(coolfreq), as.integer(length(pcindices)),     
as.integer(pcindices), as.logical(esp), as.logical(silog),     
as.integer(as.vector(initialsol)), as.double(valp), 
as.double(as.vector(vecp)),     as.double(as.vector(H)), as.integer(r), 
PACKAGE = "subselect")
 2: anneal(cor(swiss), 2, 3, nsol = 4, niter = 10, criterion = "RM")

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:                  


Running R in the debugger with this input file:

library(subselect)
data(swiss)
anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")

(gdb) run

Program received signal SIGSEGV, Segmentation fault.
0x00002b86c2ed9526 in randsk1_ () from /usr/lib64/R/library/subselect/libs/subs
elect.so
(gdb) 



-- 
Jorge Cadima
Departamento de Matem?tica
Instituto Superior de Agronomia
Universidade T?cnica de Lisboa
Tapada da Ajuda
1349-017 Lisboa
Portugal

e-mail: jcadima at isa.utl.pt
phone: +351 21 365 3317
fax: +351 21 363 07 23


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan  5 17:50:37 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 05 Jan 2007 16:50:37 +0000
Subject: [Rd] help for memory problem with 64-bit machines
In-Reply-To: <E1H2rmC-0005nz-00@DMjcadima>
References: <E1H2rmC-0005nz-00@DMjcadima>
Message-ID: <459E81DD.6060707@cimr.cam.ac.uk>

I got the same error with 64-bit R 2.4.1 on FC6 x86_64, and 32-bit
R 2.4.1 on the same machine is okay. There is definitely something wrong
with your code.

I would suggest fixing all the compier warnings - there are piles of
them about uninitialized variables, and about doing comparison
between signed and unsigned expressions, etc first. Put -Wall in
CFLAGS CXXFLAGS and FFLAGS and you'll see.

good luck.

Hin-Tak Leung


Jorge Cadima wrote:
> Hello,
> 
> I would appreciate *any* ideas on this problem. I'm the maintainer of a 
> package ("subselect"), which on CRAN's Daily Package Checks is OK on all 
> flavours of R, except  r-devel Linux x86_64, where there is a "memory not 
> mapped" segfault with the very first example that is tried out (output below). 
> Additionally, a user with an AMD64 machine has just reported a similar 
> problem, and kindly ran a couple of tests identifying the culprit (output 
> below):a Fortran routine. Unfortunately, I don't have 64-bit machines 
> available and the segfault has not occured with other machines, so I am having 
> trouble trying to spot the problem.
> 
> I suspect the problem lies in  one of two things:
> 
> 1) The Fortran subroutine where the crash occurs has variable-length arrays. 
> Could there be a problem with this (the user who spotted the problem is 
> running the gfortran gcc compiler - I presume r-devel Linux x86_64 does too)?
> 3) the guilty routine ("randsk1") calls a second routine ("randint") which, in 
> turn, calls R's Random Number Generator. Can the problem arise in the 
> Fortran/R interface?
> 
> As I said, any idea of what the problem may be, or where I can look for help, 
> would be much appreciated.
> 
> In despair, but with best regards,
> Jorge Cadima
> 
> -------------------------------------------------------------------------------
> ---
> --- Cran Daily Package check output -------------------------------------------
> ---
> -------------------------------------------------------------------------------
> ---
> 
>     * using R version 2.5.0 Under development (unstable) (2007-01-03 r40349)
>     * checking for file 'subselect/DESCRIPTION' ... OK
>     * this is package 'subselect' version '0.9-999'
>     * checking package dependencies ... OK
>  (...)
>     * creating subselect-Ex.R ... OK
>     * checking examples ... ERROR
>       Running examples in 'subselect-Ex.R' failed.
>       The error most likely occurred in:
> 
>       > ### * anneal
>       >
>       > flush(stderr()); flush(stdout())
>       >
>       > ### Name: anneal
>       > ### Title: Simulated Annealing Search for an optimal k-variable subset
>       > ### Aliases: anneal
>       > ### Keywords: manip
>       >
>       > ### ** Examples
>       >
>       >
>       > ## --------------------------------------------------------------------
>       >
>       > ##
>       > ## (1) For illustration of use, a small data set with very few 
> iterations
>       > ## of the algorithm, using the RM criterion.
>       > ##
>       >
>       > data(swiss)
>       > anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")
> 
>       *** caught segfault ***
>       address 0x47cd37c, cause 'memory not mapped'
> 
>       Traceback:
>       1: .Fortran("anneal", as.integer(criterio), as.integer(p), 
> as.double(as.vector(mat)), as.integer(kmin), as.integer(kmax), 
> as.double(valores), as.integer(vars), as.double(bestval), as.integer(bestvar), 
> as.integer(nexclude), as.integer(exc), as.integer(ninclude), as.integer(inc), 
> as.integer(nsol), as.integer(niter), as.logical(improvement), 
> as.double(cooling), as.double(temp), as.integer(coolfreq), 
> as.integer(length(pcindices)), as.integer(pcindices), as.logical(esp), 
> as.logical(silog), as.integer(as.vector(initialsol)), as.double(valp), 
> as.double(as.vector(vecp)), as.double(as.vector(H)), as.integer(r), PACKAGE = 
> "subselect")
>       2: anneal(cor(swiss), 2, 3, nsol = 4, niter = 10, criterion = "RM")
>       aborting ...
> 
> -------------------------------------------------------------------------------
> -----
> ------- user's tests output ---------------------------------------------------
> --
> -------------------------------------------------------------------------------
> --
> 
> The install
> ===========
> 
> work:/home/jimmy/R # R CMD INSTALL subselect_0.9-999.tar.gz
> * Installing *source* package 'subselect' ...
> ** libs
> gfortran   -fpic   -c anneal.f -o anneal.o
> gfortran   -fpic   -c auxiliar.f -o auxiliar.o
> g++ -I/usr/lib64/R/include -I/usr/lib64/R/include  -I/usr/local/include   
> -fpic  -g -O2 -c CCRcrt.cpp -o CCRcrt.o
> 
> (...)
> 
> g++ -I/usr/lib64/R/include -I/usr/lib64/R/include  -I/usr/local/include   
> -fpic  -g -O2 -c Wrkf1.cpp -o Wrkf1.o
> g++ -shared -L/usr/local/lib64 -o subselect.so anneal.o auxiliar.o CCRcrt.o 
> GCDcrt.o genetic.o Gstatma.o improve.o MStcrt.o NewtonRp.o Qforms.o RMcrt.o 
> Rnk3CCRcrt.o RVcrt.o SpecialArrays.o SR_datatrnsf.o SR_intf.o SRI_sscma.o 
> Sscma.o Subsets.o Varsmbo.o VSQforms.o wrap.o Wrkf1.o -L/usr/lib64/R/lib 
> -lRlapack  -lgfortran -lm -lgcc_s -lgfortran -lm -lgcc_s -L/usr/lib64/R/lib -lR
> ** R
> ** inst
> ** preparing package for lazy loading
> ** help
>  >>> Building/Updating help pages for package 'subselect'
>      Formats: text html latex example
>   anneal                            text    html    latex   example
> 
> (...)
> 
>   zeta2                             text    html    latex   example
> ** building package indices ...
> * DONE (subselect)
> work:/home/jimmy/R #                   
> 
> 
> 
> The library is put into:
> /usr/lib64/R/library/subselect/libs/subselect.so
> 
> and nm -s give me (in part):
> 
> work:/home/jimmy/R # nm -s /usr/lib64/R/library/subselect/libs/subselect.so
> 0000000000012a4c T anneal_
> ....
> 0000000000014580 T randint_
> 000000000001446a T randsk1_
>                  U Rf_error
> 000000000003470f T rndend_
> 0000000000034704 T rndstart_
>                  U Rprintf
> ....
> etc
> 
> So randsk1 is there.
> 
> 
> Running the subselect example from the manual:
> 
> jimmy at work:~> R
> 
> R : Copyright 2006, The R Foundation for Statistical Computing
> Version 2.3.1 (2006-06-01)
> ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
>> library(subselect)
>> data(swiss)
>> anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")
> 
>  *** caught segfault ***
> address 0xffffffffb03f38dc, cause 'memory not mapped'
> 
> Traceback:
>  1: .Fortran("anneal", as.integer(criterio), as.integer(p), 
> as.double(as.vector(mat)),     as.integer(kmin), as.integer(kmax), 
> as.double(valores), as.integer(vars),     as.double(bestval), 
> as.integer(bestvar), as.integer(nexclude),     as.integer(exc), 
> as.integer(ninclude), as.integer(inc), as.integer(nsol),     
> as.integer(niter), as.logical(improvement), as.double(cooling),     
> as.double(temp), as.integer(coolfreq), as.integer(length(pcindices)),     
> as.integer(pcindices), as.logical(esp), as.logical(silog),     
> as.integer(as.vector(initialsol)), as.double(valp), 
> as.double(as.vector(vecp)),     as.double(as.vector(H)), as.integer(r), 
> PACKAGE = "subselect")
>  2: anneal(cor(swiss), 2, 3, nsol = 4, niter = 10, criterion = "RM")
> 
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:                  
> 
> 
> Running R in the debugger with this input file:
> 
> library(subselect)
> data(swiss)
> anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")
> 
> (gdb) run
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x00002b86c2ed9526 in randsk1_ () from /usr/lib64/R/library/subselect/libs/subs
> elect.so
> (gdb) 
> 
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From P.Dalgaard at biostat.ku.dk  Fri Jan  5 18:10:34 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 05 Jan 2007 18:10:34 +0100
Subject: [Rd] help for memory problem with 64-bit machines
In-Reply-To: <459E81DD.6060707@cimr.cam.ac.uk>
References: <E1H2rmC-0005nz-00@DMjcadima> <459E81DD.6060707@cimr.cam.ac.uk>
Message-ID: <459E868A.2080302@biostat.ku.dk>

Hin-Tak Leung wrote:
> I got the same error with 64-bit R 2.4.1 on FC6 x86_64, and 32-bit
> R 2.4.1 on the same machine is okay. There is definitely something wrong
> with your code.
>
> I would suggest fixing all the compier warnings - there are piles of
> them about uninitialized variables, and about doing comparison
> between signed and unsigned expressions, etc first. Put -Wall in
> CFLAGS CXXFLAGS and FFLAGS and you'll see.
>
> good luck.
>
> Hin-Tak Leung
>
>   
Good advice. Also, the most common culprit for 64/32 problem is pointers
stored as integers so watch out for any of those. And notice that you
can set a breakpoint at randsk1_ and start poking around to see what is
inside various variables and singlestep to the point of the crash (it's
a bit painful and confusing in Fortran code, though.)

    -pd
> Jorge Cadima wrote:
>   
>> Hello,
>>
>> I would appreciate *any* ideas on this problem. I'm the maintainer of a 
>> package ("subselect"), which on CRAN's Daily Package Checks is OK on all 
>> flavours of R, except  r-devel Linux x86_64, where there is a "memory not 
>> mapped" segfault with the very first example that is tried out (output below). 
>> Additionally, a user with an AMD64 machine has just reported a similar 
>> problem, and kindly ran a couple of tests identifying the culprit (output 
>> below):a Fortran routine. Unfortunately, I don't have 64-bit machines 
>> available and the segfault has not occured with other machines, so I am having 
>> trouble trying to spot the problem.
>>
>> I suspect the problem lies in  one of two things:
>>
>> 1) The Fortran subroutine where the crash occurs has variable-length arrays. 
>> Could there be a problem with this (the user who spotted the problem is 
>> running the gfortran gcc compiler - I presume r-devel Linux x86_64 does too)?
>> 3) the guilty routine ("randsk1") calls a second routine ("randint") which, in 
>> turn, calls R's Random Number Generator. Can the problem arise in the 
>> Fortran/R interface?
>>
>> As I said, any idea of what the problem may be, or where I can look for help, 
>> would be much appreciated.
>>
>> In despair, but with best regards,
>> Jorge Cadima
>>
>> -------------------------------------------------------------------------------
>> ---
>> --- Cran Daily Package check output -------------------------------------------
>> ---
>> -------------------------------------------------------------------------------
>> ---
>>
>>     * using R version 2.5.0 Under development (unstable) (2007-01-03 r40349)
>>     * checking for file 'subselect/DESCRIPTION' ... OK
>>     * this is package 'subselect' version '0.9-999'
>>     * checking package dependencies ... OK
>>  (...)
>>     * creating subselect-Ex.R ... OK
>>     * checking examples ... ERROR
>>       Running examples in 'subselect-Ex.R' failed.
>>       The error most likely occurred in:
>>
>>       > ### * anneal
>>       >
>>       > flush(stderr()); flush(stdout())
>>       >
>>       > ### Name: anneal
>>       > ### Title: Simulated Annealing Search for an optimal k-variable subset
>>       > ### Aliases: anneal
>>       > ### Keywords: manip
>>       >
>>       > ### ** Examples
>>       >
>>       >
>>       > ## --------------------------------------------------------------------
>>       >
>>       > ##
>>       > ## (1) For illustration of use, a small data set with very few 
>> iterations
>>       > ## of the algorithm, using the RM criterion.
>>       > ##
>>       >
>>       > data(swiss)
>>       > anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")
>>
>>       *** caught segfault ***
>>       address 0x47cd37c, cause 'memory not mapped'
>>
>>       Traceback:
>>       1: .Fortran("anneal", as.integer(criterio), as.integer(p), 
>> as.double(as.vector(mat)), as.integer(kmin), as.integer(kmax), 
>> as.double(valores), as.integer(vars), as.double(bestval), as.integer(bestvar), 
>> as.integer(nexclude), as.integer(exc), as.integer(ninclude), as.integer(inc), 
>> as.integer(nsol), as.integer(niter), as.logical(improvement), 
>> as.double(cooling), as.double(temp), as.integer(coolfreq), 
>> as.integer(length(pcindices)), as.integer(pcindices), as.logical(esp), 
>> as.logical(silog), as.integer(as.vector(initialsol)), as.double(valp), 
>> as.double(as.vector(vecp)), as.double(as.vector(H)), as.integer(r), PACKAGE = 
>> "subselect")
>>       2: anneal(cor(swiss), 2, 3, nsol = 4, niter = 10, criterion = "RM")
>>       aborting ...
>>
>> -------------------------------------------------------------------------------
>> -----
>> ------- user's tests output ---------------------------------------------------
>> --
>> -------------------------------------------------------------------------------
>> --
>>
>> The install
>> ===========
>>
>> work:/home/jimmy/R # R CMD INSTALL subselect_0.9-999.tar.gz
>> * Installing *source* package 'subselect' ...
>> ** libs
>> gfortran   -fpic   -c anneal.f -o anneal.o
>> gfortran   -fpic   -c auxiliar.f -o auxiliar.o
>> g++ -I/usr/lib64/R/include -I/usr/lib64/R/include  -I/usr/local/include   
>> -fpic  -g -O2 -c CCRcrt.cpp -o CCRcrt.o
>>
>> (...)
>>
>> g++ -I/usr/lib64/R/include -I/usr/lib64/R/include  -I/usr/local/include   
>> -fpic  -g -O2 -c Wrkf1.cpp -o Wrkf1.o
>> g++ -shared -L/usr/local/lib64 -o subselect.so anneal.o auxiliar.o CCRcrt.o 
>> GCDcrt.o genetic.o Gstatma.o improve.o MStcrt.o NewtonRp.o Qforms.o RMcrt.o 
>> Rnk3CCRcrt.o RVcrt.o SpecialArrays.o SR_datatrnsf.o SR_intf.o SRI_sscma.o 
>> Sscma.o Subsets.o Varsmbo.o VSQforms.o wrap.o Wrkf1.o -L/usr/lib64/R/lib 
>> -lRlapack  -lgfortran -lm -lgcc_s -lgfortran -lm -lgcc_s -L/usr/lib64/R/lib -lR
>> ** R
>> ** inst
>> ** preparing package for lazy loading
>> ** help
>>  >>> Building/Updating help pages for package 'subselect'
>>      Formats: text html latex example
>>   anneal                            text    html    latex   example
>>
>> (...)
>>
>>   zeta2                             text    html    latex   example
>> ** building package indices ...
>> * DONE (subselect)
>> work:/home/jimmy/R #                   
>>
>>
>>
>> The library is put into:
>> /usr/lib64/R/library/subselect/libs/subselect.so
>>
>> and nm -s give me (in part):
>>
>> work:/home/jimmy/R # nm -s /usr/lib64/R/library/subselect/libs/subselect.so
>> 0000000000012a4c T anneal_
>> ....
>> 0000000000014580 T randint_
>> 000000000001446a T randsk1_
>>                  U Rf_error
>> 000000000003470f T rndend_
>> 0000000000034704 T rndstart_
>>                  U Rprintf
>> ....
>> etc
>>
>> So randsk1 is there.
>>
>>
>> Running the subselect example from the manual:
>>
>> jimmy at work:~> R
>>
>> R : Copyright 2006, The R Foundation for Statistical Computing
>> Version 2.3.1 (2006-06-01)
>> ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>>   Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>     
>>> library(subselect)
>>> data(swiss)
>>> anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")
>>>       
>>  *** caught segfault ***
>> address 0xffffffffb03f38dc, cause 'memory not mapped'
>>
>> Traceback:
>>  1: .Fortran("anneal", as.integer(criterio), as.integer(p), 
>> as.double(as.vector(mat)),     as.integer(kmin), as.integer(kmax), 
>> as.double(valores), as.integer(vars),     as.double(bestval), 
>> as.integer(bestvar), as.integer(nexclude),     as.integer(exc), 
>> as.integer(ninclude), as.integer(inc), as.integer(nsol),     
>> as.integer(niter), as.logical(improvement), as.double(cooling),     
>> as.double(temp), as.integer(coolfreq), as.integer(length(pcindices)),     
>> as.integer(pcindices), as.logical(esp), as.logical(silog),     
>> as.integer(as.vector(initialsol)), as.double(valp), 
>> as.double(as.vector(vecp)),     as.double(as.vector(H)), as.integer(r), 
>> PACKAGE = "subselect")
>>  2: anneal(cor(swiss), 2, 3, nsol = 4, niter = 10, criterion = "RM")
>>
>> Possible actions:
>> 1: abort (with core dump)
>> 2: normal R exit
>> 3: exit R without saving workspace
>> 4: exit R saving workspace
>> Selection:                  
>>
>>
>> Running R in the debugger with this input file:
>>
>> library(subselect)
>> data(swiss)
>> anneal(cor(swiss),2,3,nsol=4,niter=10,criterion="RM")
>>
>> (gdb) run
>>
>> Program received signal SIGSEGV, Segmentation fault.
>> 0x00002b86c2ed9526 in randsk1_ () from /usr/lib64/R/library/subselect/libs/subs
>> elect.so
>> (gdb) 
>>
>>
>>
>>
>>
>> ------------------------------------------------------------------------
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From vdergachev at rcgardis.com  Fri Jan  5 19:00:16 2007
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Fri, 5 Jan 2007 13:00:16 -0500
Subject: [Rd] help for memory problem with 64-bit machines
In-Reply-To: <459E868A.2080302@biostat.ku.dk>
References: <E1H2rmC-0005nz-00@DMjcadima> <459E81DD.6060707@cimr.cam.ac.uk>
	<459E868A.2080302@biostat.ku.dk>
Message-ID: <200701051300.16117.vdergachev@rcgardis.com>

On Friday 05 January 2007 12:10 pm, Peter Dalgaard wrote:
> Hin-Tak Leung wrote:
> > I got the same error with 64-bit R 2.4.1 on FC6 x86_64, and 32-bit
> > R 2.4.1 on the same machine is okay. There is definitely something wrong
> > with your code.
> >
> > I would suggest fixing all the compier warnings - there are piles of
> > them about uninitialized variables, and about doing comparison
> > between signed and unsigned expressions, etc first. Put -Wall in
> > CFLAGS CXXFLAGS and FFLAGS and you'll see.

Also, the issue I most commonly see is the difference in size for "long" data 
type. On 32 bit sizeof(long)=sizeof(int)=32, but on 64bit sizeof(long)=64 
while sizeof(int)=32. 

This reverses a formerly safe practice of using long for 32 bit (and insuring 
the code compiles correctly on 16 bit machines).

                            best

                                Vladimir Dergachev

> >
> > good luck.
> >
> > Hin-Tak Leung
>
> Good advice. Also, the most common culprit for 64/32 problem is pointers
> stored as integers so watch out for any of those. And notice that you
> can set a breakpoint at randsk1_ and start poking around to see what is
> inside various variables and singlestep to the point of the crash (it's
> a bit painful and confusing in Fortran code, though.)
>
>     -pd
>


From ripley at stats.ox.ac.uk  Fri Jan  5 20:39:56 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Jan 2007 19:39:56 +0000 (GMT)
Subject: [Rd] help for memory problem with 64-bit machines
In-Reply-To: <200701051300.16117.vdergachev@rcgardis.com>
References: <E1H2rmC-0005nz-00@DMjcadima> <459E81DD.6060707@cimr.cam.ac.uk>
	<459E868A.2080302@biostat.ku.dk>
	<200701051300.16117.vdergachev@rcgardis.com>
Message-ID: <Pine.LNX.4.64.0701051937030.4384@gannet.stats.ox.ac.uk>

The problem with the misuse of 'long' in package 'subselect' was reported 
to Mr Cadima in February 2005 (along with a number of other package 
maintainers).


On Fri, 5 Jan 2007, Vladimir Dergachev wrote:

> On Friday 05 January 2007 12:10 pm, Peter Dalgaard wrote:
>> Hin-Tak Leung wrote:
>>> I got the same error with 64-bit R 2.4.1 on FC6 x86_64, and 32-bit
>>> R 2.4.1 on the same machine is okay. There is definitely something wrong
>>> with your code.
>>>
>>> I would suggest fixing all the compier warnings - there are piles of
>>> them about uninitialized variables, and about doing comparison
>>> between signed and unsigned expressions, etc first. Put -Wall in
>>> CFLAGS CXXFLAGS and FFLAGS and you'll see.
>
> Also, the issue I most commonly see is the difference in size for "long" data
> type. On 32 bit sizeof(long)=sizeof(int)=32, but on 64bit sizeof(long)=64
> while sizeof(int)=32.
>
> This reverses a formerly safe practice of using long for 32 bit (and insuring
> the code compiles correctly on 16 bit machines).
>
>                            best
>
>                                Vladimir Dergachev
>
>>>
>>> good luck.
>>>
>>> Hin-Tak Leung
>>
>> Good advice. Also, the most common culprit for 64/32 problem is pointers
>> stored as integers so watch out for any of those. And notice that you
>> can set a breakpoint at randsk1_ and start poking around to see what is
>> inside various variables and singlestep to the point of the crash (it's
>> a bit painful and confusing in Fortran code, though.)
>>
>>     -pd
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan  5 20:51:12 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 05 Jan 2007 19:51:12 +0000
Subject: [Rd] help for memory problem with 64-bit machines
In-Reply-To: <459E868A.2080302@biostat.ku.dk>
References: <E1H2rmC-0005nz-00@DMjcadima> <459E81DD.6060707@cimr.cam.ac.uk>
	<459E868A.2080302@biostat.ku.dk>
Message-ID: <459EAC30.7020203@cimr.cam.ac.uk>

What Peter & Vladimir refers to are the causes of problems - adding 
"-Wall" to all of CFLAGS, CXXFLAGS, FFLAGS should spot some of them.
I did know of one case of uninitialised variable causing a crash -
doing "FILE *file; close(file);" crashes with gcc but not with sun 
workshop (sun workshop implicitly zeros uninitialise variables). There
is a gcc compiler switch (-fzero-uninitialized? or something,
read the manual) which does the same thing if you want to quickly check 
if the problem is due to uninitialised variables, but you better fix
*each* of the uninitialised variables anway.

Things to look out for in Peter's case are any explicit casts (which
are not a good idea, and also won't be picked up by -Wall because gcc
assumes that *you* are responsible for whatever you explicitly
asked for) e.g:
int a = (int) pointer_type;

The signed/unsigned comparion warning can be an overlap of the bit-width
difference Vladimir noted. A somewhat contrived example:

long a = 0xFFFFFFFF; /* = -1 in 32-bit, but a large number in 64-bit */
unsigned long b = 0;
if (a < b) {/* true in 32-bit, false in 64-bit */}

Peter Dalgaard wrote:
> Hin-Tak Leung wrote:
>> I got the same error with 64-bit R 2.4.1 on FC6 x86_64, and 32-bit
>> R 2.4.1 on the same machine is okay. There is definitely something wrong
>> with your code.
>>
>> I would suggest fixing all the compier warnings - there are piles of
>> them about uninitialized variables, and about doing comparison
>> between signed and unsigned expressions, etc first. Put -Wall in
>> CFLAGS CXXFLAGS and FFLAGS and you'll see.
>>
>> good luck.
>>
>> Hin-Tak Leung
>>
>>   
> Good advice. Also, the most common culprit for 64/32 problem is pointers
> stored as integers so watch out for any of those. And notice that you
> can set a breakpoint at randsk1_ and start poking around to see what is
> inside various variables and singlestep to the point of the crash (it's
> a bit painful and confusing in Fortran code, though.)
>> 
>> Also, the issue I most commonly see is the difference in size for "long" data 
>> type. On 32 bit sizeof(long)=sizeof(int)=32, but on 64bit sizeof(long)=64 
>> while sizeof(int)=32. 
>> 
>> This reverses a formerly safe practice of using long for 32 bit (and insuring 
>> the code compiles correctly on 16 bit machines).


From hpages at fhcrc.org  Sat Jan  6 04:59:20 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Fri, 05 Jan 2007 19:59:20 -0800
Subject: [Rd] Can't load XML_1.4-0.zip in last R devel
Message-ID: <459F1E98.9070609@fhcrc.org>

Hi,

I can't load XML_1.4-0.zip in last R devel (Windows):

  R version 2.5.0 Under development (unstable) (2007-01-05 r40386)
  Copyright (C) 2007 The R Foundation for Statistical Computing
  ISBN 3-900051-07-0

  R is free software and comes with ABSOLUTELY NO WARRANTY.
  You are welcome to redistribute it under certain conditions.
  Type 'license()' or 'licence()' for distribution details.

    Natural language support but running in an English locale

  R is a collaborative project with many contributors.
  Type 'contributors()' for more information and
  'citation()' on how to cite R or R packages in publications.

  Type 'demo()' for some demos, 'help()' for on-line help, or
  'help.start()' for an HTML browser interface to help.
  Type 'q()' to quit R.

  > install.packages('XML')
  --- Please select a CRAN mirror for use in this session ---
  trying URL 'http://cran.fhcrc.org/bin/windows/contrib/2.5/XML_1.4-0.zip'
  Content type 'application/zip' length 1647612 bytes
  opened URL
  downloaded 1608Kb

  package 'XML' successfully unpacked and MD5 sums checked

  The downloaded packages are in
          C:\Documents and Settings\biocbuild\Local
  Settings\tmpdir\RtmpXybdrb\downloaded_packages
  updating HTML package descriptions
  > library(XML)
  Error in Sys.putenv(names(x), as.character(unlist(x))) :
          wrong type for argument
  Error: .onLoad failed in 'loadNamespace' for 'XML'
  Error: package/namespace load failed for 'XML'
  >


I don't get this with R devel from 2006-12-05:

  R version 2.5.0 Under development (unstable) (2006-12-05 r40126)
  Copyright (C) 2006 The R Foundation for Statistical Computing
  ISBN 3-900051-07-0

  R is free software and comes with ABSOLUTELY NO WARRANTY.
  You are welcome to redistribute it under certain conditions.
  Type 'license()' or 'licence()' for distribution details.

    Natural language support but running in an English locale

  R is a collaborative project with many contributors.
  Type 'contributors()' for more information and
  'citation()' on how to cite R or R packages in publications.

  Type 'demo()' for some demos, 'help()' for on-line help, or
  'help.start()' for an HTML browser interface to help.
  Type 'q()' to quit R.

  > install.packages('XML')
  --- Please select a CRAN mirror for use in this session ---
  trying URL 'http://cran.fhcrc.org/bin/windows/contrib/2.5/XML_1.4-0.zip'
  Content type 'application/zip' length 1647612 bytes
  opened URL
  downloaded 1608Kb

  package 'XML' successfully unpacked and MD5 sums checked

  The downloaded packages are in
          C:\Documents and Settings\biocbuild\Local
  Settings\tmpdir\RtmpaIcdrb\downloaded_packages
  updating HTML package descriptions
  > library(XML)
  >


Cheers,
H.


From hpages at fhcrc.org  Sat Jan  6 05:41:48 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Fri, 05 Jan 2007 20:41:48 -0800
Subject: [Rd] pb in regular expression with the character "-" (PR#9437)
In-Reply-To: <20070104211808.504803F03A@slim.kubism.ku.dk>
References: <20070104211808.504803F03A@slim.kubism.ku.dk>
Message-ID: <459F288C.5030701@fhcrc.org>

Hi all,

maechler at stat.math.ethz.ch wrote:
> 
> Consider my guesstimate:
> For 99% of all R users, the amount of time they need working
> pretty intensely with R before they find a bug in it, 
> is nowadays more than three years, and maybe even much more
> -- such as their lifetime :-)

Perhaps I belong to the 1% of unlucky users that don't have to
wait that long ;-)

  > nchar("?A", type = "bytes")
  [1] 3
  > nchar("?A", type = "chars")
  [1] 2

  OK

Now:

  > regexpr("A", "?A")
  [1] 2
  attr(,"match.length")
  [1] 1

  still OK

But:

  > regexpr("A", "?A", useBytes=TRUE)
  [1] 2
  attr(,"match.length")
  [1] 1

  not OK anymore (3 expected, not 2)

Let's try with fixed=TRUE:

  > regexpr("A", "?A", useBytes=TRUE, fixed=TRUE)
  [1] 3
  attr(,"match.length")
  [1] 1

  much better!

H.


> sessionInfo()
R version 2.5.0 Under development (unstable) (2007-01-05 r40386)
i686-pc-linux-gnu

locale:
LC_CTYPE=en_CA.UTF-8;LC_NUMERIC=C;LC_TIME=en_CA.UTF-8;LC_COLLATE=en_CA.UTF-8;LC_MONETARY=en_CA.UTF-8;LC_MESSAGES=en_CA.UTF-8;LC_PAPER=en_CA.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_CA.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
[7] "base"

but this happens also in 2.4.0 and 2.4.1.


From ripley at stats.ox.ac.uk  Sat Jan  6 09:10:51 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Jan 2007 08:10:51 +0000 (GMT)
Subject: [Rd] Can't load XML_1.4-0.zip in last R devel
In-Reply-To: <459F1E98.9070609@fhcrc.org>
References: <459F1E98.9070609@fhcrc.org>
Message-ID: <Pine.LNX.4.64.0701060800150.1307@gannet.stats.ox.ac.uk>

The package source file XML/R/zzz.R contains

      temp <- Sys.getenv("PATH")
  ...
      on.exit(Sys.putenv(temp))

and ?Sys.putenv says

Usage:

      Sys.putenv(...)

      ...: arguments in 'name=value' form, with 'value' coercible to a
           character string.

so I believe this needs (and needed) to be Sys.putenv(PATH=temp).

In 2.4.1 it fails to reset the path which was apparently the intention.
Now, my belief is that this kludge is no longer necessary as library() 
does the appropriate PATH setting (and uses Sys.putenv correctly).

It would have been helpful to make use of R's debugging tools yourself: 
this was not at all hard to find and not an R-devel issue AFAICS.


On Fri, 5 Jan 2007, Herve Pages wrote:

> Hi,
>
> I can't load XML_1.4-0.zip in last R devel (Windows):
>
>  R version 2.5.0 Under development (unstable) (2007-01-05 r40386)
>  Copyright (C) 2007 The R Foundation for Statistical Computing
>  ISBN 3-900051-07-0
>
>  R is free software and comes with ABSOLUTELY NO WARRANTY.
>  You are welcome to redistribute it under certain conditions.
>  Type 'license()' or 'licence()' for distribution details.
>
>    Natural language support but running in an English locale
>
>  R is a collaborative project with many contributors.
>  Type 'contributors()' for more information and
>  'citation()' on how to cite R or R packages in publications.
>
>  Type 'demo()' for some demos, 'help()' for on-line help, or
>  'help.start()' for an HTML browser interface to help.
>  Type 'q()' to quit R.
>
>  > install.packages('XML')
>  --- Please select a CRAN mirror for use in this session ---
>  trying URL 'http://cran.fhcrc.org/bin/windows/contrib/2.5/XML_1.4-0.zip'
>  Content type 'application/zip' length 1647612 bytes
>  opened URL
>  downloaded 1608Kb
>
>  package 'XML' successfully unpacked and MD5 sums checked
>
>  The downloaded packages are in
>          C:\Documents and Settings\biocbuild\Local
>  Settings\tmpdir\RtmpXybdrb\downloaded_packages
>  updating HTML package descriptions
>  > library(XML)
>  Error in Sys.putenv(names(x), as.character(unlist(x))) :
>          wrong type for argument
>  Error: .onLoad failed in 'loadNamespace' for 'XML'
>  Error: package/namespace load failed for 'XML'
>  >
>
>
> I don't get this with R devel from 2006-12-05:
>
>  R version 2.5.0 Under development (unstable) (2006-12-05 r40126)
>  Copyright (C) 2006 The R Foundation for Statistical Computing
>  ISBN 3-900051-07-0
>
>  R is free software and comes with ABSOLUTELY NO WARRANTY.
>  You are welcome to redistribute it under certain conditions.
>  Type 'license()' or 'licence()' for distribution details.
>
>    Natural language support but running in an English locale
>
>  R is a collaborative project with many contributors.
>  Type 'contributors()' for more information and
>  'citation()' on how to cite R or R packages in publications.
>
>  Type 'demo()' for some demos, 'help()' for on-line help, or
>  'help.start()' for an HTML browser interface to help.
>  Type 'q()' to quit R.
>
>  > install.packages('XML')
>  --- Please select a CRAN mirror for use in this session ---
>  trying URL 'http://cran.fhcrc.org/bin/windows/contrib/2.5/XML_1.4-0.zip'
>  Content type 'application/zip' length 1647612 bytes
>  opened URL
>  downloaded 1608Kb
>
>  package 'XML' successfully unpacked and MD5 sums checked
>
>  The downloaded packages are in
>          C:\Documents and Settings\biocbuild\Local
>  Settings\tmpdir\RtmpaIcdrb\downloaded_packages
>  updating HTML package descriptions
>  > library(XML)
>  >
>
>
> Cheers,
> H.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From duncan at wald.ucdavis.edu  Sat Jan  6 23:54:02 2007
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Sat, 06 Jan 2007 14:54:02 -0800
Subject: [Rd] Connections to https: URLs -- IE expert help needed
In-Reply-To: <Pine.LNX.4.64.0701050943540.2656@gannet.stats.ox.ac.uk>
References: <Pine.LNX.4.64.0612201725400.12201@gannet.stats.ox.ac.uk>	<4589B4E1.8090102@wald.ucdavis.edu>	<17817.33808.900582.330470@mithrandir.hornik.net>	<20070102011502.GE27570@wald.ucdavis.edu>
	<Pine.LNX.4.64.0701050943540.2656@gannet.stats.ox.ac.uk>
Message-ID: <45A0288A.80307@wald.ucdavis.edu>



Prof Brian Ripley wrote:
> On Mon, 1 Jan 2007, Duncan Temple Lang wrote:
> 
>> Kurt Hornik wrote:
>>>>>>>> Duncan Temple Lang writes:
>>>> -----BEGIN PGP SIGNED MESSAGE-----
>>>> Hash: SHA1
>>>> Prof Brian Ripley wrote:
>>>>> I've added to R-devel the ability to use download.file() and url() to
>>>>> https: URLs, *only* if --internet2 is used on Windows.
>>>>>
>>>>> This uses the Internet Explorer internals, and only works if the
>>>>> certificate is accepted (so e.g. does not work for
>>>>> https://svn.r-project.org).
>>>>>
>>>>> Now I use IE (and Windows for that matter) only when really necessary, and
>>>>> Firefox has simple ways to permanently accept non-verifiable certificates.
>>>>> I would be grateful if someone who is much more familiar with IE could
>>>>> write a note explaining how to deal with this that we could add to the
>>>>> rw-FAQ.
>>>>>
>>>>> To forestall the inevitable question: there are no plans to add https:
>>>>> support on any other platform, but it is something that would make a nice
>>>>> project for a user contribution.  The current internal code is based on
>>>>> likxml2, and that AFAICS still does not have https: support.
>>>>>
>>>> Generally (i.e. not in particular response to Brian but related to
>>>> this thread)
>>> With a similar disclaimer: Brian's efforts were triggered by me asking
>>> how to use url() to read R's mailing list archive files, such as
>>>
>>>   https://stat.ethz.ch/pipermail/r-help/2007-January.txt.gz
>>>
>>> directly into R.  Turns out we cannot ... which, in a way, is a shame
>>> ("R cannot read its own web pages") :-(
>> Indeed, it is a shame.  Although, when I process mail messages,
>> I use Perl's very rich collection of modules for processing
>> mail in so many different formats. And then I use RSPerl
>> to control this and get the data into R pretty quickly.
>> So we can do it in R and probably the delegation to
>> mail-processing software is a good given the number of special
>> cases, etc.
>>
>> And even if we had HTTPs in R, we would still want to deal with
>> the certificate on that page, which gets us to more details.
>> Which is the reason I think leaving things to libcurl,
>> libwww, etc. will be best as they continue to evolve
>> to handle new protocols and settings.
> 
> The issue here is the same as it ever was, that of event-loops and not 
> blocking the R process.  I think that is where the missing extensibility 
> is, and it has been raised for at least 6 years now.

Of course, that is one area where extensibility is needed.
Attempts have been made to address this generaly over the last 6 
years,
but the architecture of and the focus on the current numerous R 
front-ends is not necessarily ideal for trying to solve this 
properly.

But your sentence suggests that the extensibility of the
connection API is not an issue.  And we don't agree
on that. I think the two issues of extensibility are
relevant. Blocking is important, but not being able
to explore or add new facilities is fundamental
and I believe of immense importance. Extensibility
of the R engine at the system level rather than in the
interpreted language is a major impediment to the evolution
of R, IMHO.

> 
> If I try to get that example URI with RCurl it
> 
> 1) blocks the R process for a long time.
> 2) fails to retrieve the URI as it is unable to handle the certificate.

2) is, as you would put it, "user error" ;-)
You need to tell libcurl what options you want in the request.
Telling it whether to ignore certificates, where the certificates 
are, etc.  are query-specific options.

> 
> Can you please point us to an extension package that behaves better?
> 

Well, as regards point 1), libcurl does have facilities for
non-blocking calls and so does RCurl via the multi_ interface
of libcurl and the function getURIAsynchronous() in RCurl and the
lower-level functions.
  And one could also merge the basic libcurl interface
into our select calls. I seem to recall libwww has features we 
also can manually integrate into our event loop.

The key thing I am trying to get across is that if we
are going to include these things into R and we have
to do things manually, then we should try to integrate
them in an evolvable, extensible manner that leverages
libraries that do things properly.

> [When Kurt first sent me the example, I was surprised that wget handled 
> it. I then checked, and wget < 1.10 does not check certificates at all.]
>


From murdoch at stats.uwo.ca  Sun Jan  7 01:45:31 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 06 Jan 2007 19:45:31 -0500
Subject: [Rd] Wish list
In-Reply-To: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
Message-ID: <45A042AB.4080709@stats.uwo.ca>

On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:

> 7. documentation standards for packages
>    - NEWS/ChangeLog (also should be accessible from CRAN page for package
>      and should be included in built version of package)
>    - package?mypackage

Just to let you know:  I uploaded a revision of rgl just a minute ago, 
and moved the ChangeLog file to a place where it will be included when 
installed, and available from the ?rgl or package?rgl help topic.

Thanks for the suggestion.

Duncan Murdoch


From chris at cepheus.net  Sun Jan  7 06:29:15 2007
From: chris at cepheus.net (Chris Eisley)
Date: Sat, 06 Jan 2007 21:29:15 -0800
Subject: [Rd] Scoping issues
Message-ID: <45A0852B.5030502@cepheus.net>

Hi everyone,

I'm trying to split up a large R file that implements a tcl/tk gui into
several smaller ones.  The problem is that the main GUI creation
function defines many tclVars and tkframes that need to be accessible to
functions that are currently defined in main function, but which I'd
like to move to different source files.  These files make up a package,
so it seems that using source() is a bad idea.  I could try argument
passing, but there are a lot of arguments to pass in some cases.

The lexical scoping is hurting me here, but I assume there's a good way
to deal with this kind of issue.  Any help is greatly appreciated.

-Chris


From ggrothendieck at gmail.com  Sun Jan  7 11:01:33 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 7 Jan 2007 05:01:33 -0500
Subject: [Rd] environmentName
Message-ID: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>

I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
each environment has:

(1) a name
(2) a hex value

so

1. environmentName gets the name.  Is there any way to set the name?

2. is there any way to get the hex value for an environment other than doing:
       e <- new.env()
       capture.output(e)


From murdoch at stats.uwo.ca  Sun Jan  7 12:30:12 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 07 Jan 2007 06:30:12 -0500
Subject: [Rd] environmentName
In-Reply-To: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>
Message-ID: <45A0D9C4.2090508@stats.uwo.ca>

On 1/7/2007 5:01 AM, Gabor Grothendieck wrote:
> I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
> each environment has:
> 
> (1) a name
> (2) a hex value
> 
> so
> 
> 1. environmentName gets the name.  Is there any way to set the name?

The NEWS entry says:

     o	New function environmentName() to give the print name of
	environments such as "namespace:base".
	This is now used by str().

Take a look at the implementation in src/main/builtin.c.  The name isn't 
part of the environment, this is just derived from how the environment 
is being used.

If you want to attach a label to an environment, use an attribute.  You 
can put an S3 class on an environment if you want it to print your label 
by default rather than use the standard print mechanism.

> 2. is there any way to get the hex value for an environment other than doing:
>        e <- new.env()
>        capture.output(e)

Not in R code, but there's no use for it in R code, either.  If you want 
to test for whether two variables refer to the same environment, then 
attach a unique label to the environments when you create them and check 
the labels.

Duncan Murdoch


From ggrothendieck at gmail.com  Sun Jan  7 12:46:25 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 7 Jan 2007 06:46:25 -0500
Subject: [Rd] environmentName
In-Reply-To: <45A0D9C4.2090508@stats.uwo.ca>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>
	<45A0D9C4.2090508@stats.uwo.ca>
Message-ID: <971536df0701070346jf142c8di814c131d2397742f@mail.gmail.com>

On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 1/7/2007 5:01 AM, Gabor Grothendieck wrote:
> > I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
> > each environment has:
> >
> > (1) a name
> > (2) a hex value
> >
> > so
> >
> > 1. environmentName gets the name.  Is there any way to set the name?
>
> The NEWS entry says:
>
>     o  New function environmentName() to give the print name of
>        environments such as "namespace:base".
>        This is now used by str().
>
> Take a look at the implementation in src/main/builtin.c.  The name isn't
> part of the environment, this is just derived from how the environment
> is being used.
>
> If you want to attach a label to an environment, use an attribute.  You
> can put an S3 class on an environment if you want it to print your label
> by default rather than use the standard print mechanism.
>
> > 2. is there any way to get the hex value for an environment other than doing:
> >        e <- new.env()
> >        capture.output(e)
>
> Not in R code, but there's no use for it in R code, either.  If you want

The proto package currently uses capture.output, as above, to
get a printable unique identifier for environments:

> library(proto)
> name.proto(new.env())
[1] "0x0195860c"

This is used to display the relationships among environment and proto
objects in graph.proto and str.proto .

It would be nice to be able to get the hex identifier directly rather than
having to go through this indirect method.

> to test for whether two variables refer to the same environment, then
> attach a unique label to the environments when you create them and check
> the labels.

Its possible to assign a name to a proto object but I need to be able to
generate an identifier even if the object does not have a name.


From ripley at stats.ox.ac.uk  Sun Jan  7 14:10:38 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 7 Jan 2007 13:10:38 +0000 (GMT)
Subject: [Rd] environmentName
In-Reply-To: <45A0D9C4.2090508@stats.uwo.ca>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>
	<45A0D9C4.2090508@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0701071309160.28744@gannet.stats.ox.ac.uk>

On Sun, 7 Jan 2007, Duncan Murdoch wrote:

[...]

> If you want
> to test for whether two variables refer to the same environment, then
> attach a unique label to the environments when you create them and check
> the labels.

You can simply use identical(env1, env2).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jfox at mcmaster.ca  Sun Jan  7 14:57:27 2007
From: jfox at mcmaster.ca (John Fox)
Date: Sun, 7 Jan 2007 08:57:27 -0500
Subject: [Rd] Scoping issues
In-Reply-To: <45A0852B.5030502@cepheus.net>
Message-ID: <20070107135726.QSPQ11361.tomts43-srv.bellnexxia.net@JohnDesktop8300>

Dear Chris,

If I correctly understand what you want to do, the Rcmdr package uses the
following functions (slightly modified from original version contributed by
Philippe Grosjean) to solve a similar problem:

RcmdrEnv <- function() {
    pos <-  match("RcmdrEnv", search())
    if (is.na(pos)) { # Must create it
        RcmdrEnv <- list()
        attach(RcmdrEnv, pos = length(search()) - 1)
        rm(RcmdrEnv)
        pos <- match("RcmdrEnv", search())
        }
    return(pos.to.env(pos))
    }

putRcmdr <- function(x, value)
    assign(x, value, envir = RcmdrEnv())

getRcmdr <- function(x, mode="any")
    get(x, envir = RcmdrEnv(), mode = mode, inherits = FALSE)

I hope this helps,
 John

--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario
Canada L8S 4M4
905-525-9140x23604
http://socserv.mcmaster.ca/jfox 
-------------------------------- 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Chris Eisley
> Sent: Sunday, January 07, 2007 12:29 AM
> To: r-devel at r-project.org
> Subject: [Rd] Scoping issues
> 
> Hi everyone,
> 
> I'm trying to split up a large R file that implements a 
> tcl/tk gui into several smaller ones.  The problem is that 
> the main GUI creation function defines many tclVars and 
> tkframes that need to be accessible to functions that are 
> currently defined in main function, but which I'd like to 
> move to different source files.  These files make up a 
> package, so it seems that using source() is a bad idea.  I 
> could try argument passing, but there are a lot of arguments 
> to pass in some cases.
> 
> The lexical scoping is hurting me here, but I assume there's 
> a good way to deal with this kind of issue.  Any help is 
> greatly appreciated.
> 
> -Chris
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Sun Jan  7 15:45:37 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 7 Jan 2007 14:45:37 +0000 (GMT)
Subject: [Rd] Scoping issues
In-Reply-To: <20070107135726.QSPQ11361.tomts43-srv.bellnexxia.net@JohnDesktop8300>
References: <20070107135726.QSPQ11361.tomts43-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <Pine.LNX.4.64.0701071435220.12570@gannet.stats.ox.ac.uk>

I don't undersand what the issues are, but he actually said

>> These files make up a package,

and all the source files on an R packages are concatenated and loaded into 
a single environment.  So my understanding of the answer to

>> I assume there's a good way to deal with this kind of issue.

is 'yes, build an R package'.

If you really don't want to do that, you cannot easily use source() with 
such an environment as RcmdrEnv(), but you can use sys.source().


On Sun, 7 Jan 2007, John Fox wrote:

> Dear Chris,
>
> If I correctly understand what you want to do, the Rcmdr package uses the
> following functions (slightly modified from original version contributed by
> Philippe Grosjean) to solve a similar problem:
>
> RcmdrEnv <- function() {
>    pos <-  match("RcmdrEnv", search())
>    if (is.na(pos)) { # Must create it
>        RcmdrEnv <- list()
>        attach(RcmdrEnv, pos = length(search()) - 1)
>        rm(RcmdrEnv)
>        pos <- match("RcmdrEnv", search())
>        }
>    return(pos.to.env(pos))
>    }
>
> putRcmdr <- function(x, value)
>    assign(x, value, envir = RcmdrEnv())
>
> getRcmdr <- function(x, mode="any")
>    get(x, envir = RcmdrEnv(), mode = mode, inherits = FALSE)
>
> I hope this helps,
> John
>
> --------------------------------
> John Fox
> Department of Sociology
> McMaster University
> Hamilton, Ontario
> Canada L8S 4M4
> 905-525-9140x23604
> http://socserv.mcmaster.ca/jfox
> --------------------------------
>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org
>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Chris Eisley
>> Sent: Sunday, January 07, 2007 12:29 AM
>> To: r-devel at r-project.org
>> Subject: [Rd] Scoping issues
>>
>> Hi everyone,
>>
>> I'm trying to split up a large R file that implements a
>> tcl/tk gui into several smaller ones.  The problem is that
>> the main GUI creation function defines many tclVars and
>> tkframes that need to be accessible to functions that are
>> currently defined in main function, but which I'd like to
>> move to different source files.  These files make up a
>> package, so it seems that using source() is a bad idea.  I
>> could try argument passing, but there are a lot of arguments
>> to pass in some cases.
>>
>> The lexical scoping is hurting me here, but I assume there's
>> a good way to deal with this kind of issue.  Any help is
>> greatly appreciated.
>>
>> -Chris

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Sun Jan  7 16:01:49 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 7 Jan 2007 10:01:49 -0500
Subject: [Rd] environmentName
In-Reply-To: <45A0D9C4.2090508@stats.uwo.ca>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>
	<45A0D9C4.2090508@stats.uwo.ca>
Message-ID: <971536df0701070701y58646fe8k28e4b3c7bb67f937@mail.gmail.com>

One other comment.  If I place an attribute on the environment as you
suggest that changes all uses of the environment.  I cannot keep the
original environment intact and have a subobject which represents the
original environment plus the attribute.  This is just one example of why
the feature discussed in my wishlist is needed (i.e. the ability to have
the attributes attached to variables rather than to the environment itself).
The only way to handle this currently is with the list(env = ...) construct
and attach the name to that but that is a lot of overhead since its means
that the subobject is not an environment so all environment methods
need to be replicated rather than inherited/delegated from the superobject
which really ought to be properly supported.

On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 1/7/2007 5:01 AM, Gabor Grothendieck wrote:
> > I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
> > each environment has:
> >
> > (1) a name
> > (2) a hex value
> >
> > so
> >
> > 1. environmentName gets the name.  Is there any way to set the name?
>
> The NEWS entry says:
>
>     o  New function environmentName() to give the print name of
>        environments such as "namespace:base".
>        This is now used by str().
>
> Take a look at the implementation in src/main/builtin.c.  The name isn't
> part of the environment, this is just derived from how the environment
> is being used.
>
> If you want to attach a label to an environment, use an attribute.  You
> can put an S3 class on an environment if you want it to print your label
> by default rather than use the standard print mechanism.
>
> > 2. is there any way to get the hex value for an environment other than doing:
> >        e <- new.env()
> >        capture.output(e)
>
> Not in R code, but there's no use for it in R code, either.  If you want
> to test for whether two variables refer to the same environment, then
> attach a unique label to the environments when you create them and check
> the labels.
>
> Duncan Murdoch
>


From murdoch at stats.uwo.ca  Sun Jan  7 17:23:33 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 07 Jan 2007 11:23:33 -0500
Subject: [Rd] environmentName
In-Reply-To: <971536df0701070701y58646fe8k28e4b3c7bb67f937@mail.gmail.com>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>	
	<45A0D9C4.2090508@stats.uwo.ca>
	<971536df0701070701y58646fe8k28e4b3c7bb67f937@mail.gmail.com>
Message-ID: <45A11E85.60307@stats.uwo.ca>

On 1/7/2007 10:01 AM, Gabor Grothendieck wrote:
> One other comment.  If I place an attribute on the environment as you
> suggest that changes all uses of the environment.  

Yes, that's exactly what you wanted, as far as I can tell.  If an 
environment prints as

<environment: 0x0181a320>

then all uses of that environment will print the same way.

Duncan Murdoch

I cannot keep the
> original environment intact and have a subobject which represents the
> original environment plus the attribute.  This is just one example of why
> the feature discussed in my wishlist is needed (i.e. the ability to have
> the attributes attached to variables rather than to the environment itself).
> The only way to handle this currently is with the list(env = ...) construct
> and attach the name to that but that is a lot of overhead since its means
> that the subobject is not an environment so all environment methods
> need to be replicated rather than inherited/delegated from the superobject
> which really ought to be properly supported.
> 
> On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 1/7/2007 5:01 AM, Gabor Grothendieck wrote:
>>> I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
>>> each environment has:
>>>
>>> (1) a name
>>> (2) a hex value
>>>
>>> so
>>>
>>> 1. environmentName gets the name.  Is there any way to set the name?
>> The NEWS entry says:
>>
>>     o  New function environmentName() to give the print name of
>>        environments such as "namespace:base".
>>        This is now used by str().
>>
>> Take a look at the implementation in src/main/builtin.c.  The name isn't
>> part of the environment, this is just derived from how the environment
>> is being used.
>>
>> If you want to attach a label to an environment, use an attribute.  You
>> can put an S3 class on an environment if you want it to print your label
>> by default rather than use the standard print mechanism.
>>
>>> 2. is there any way to get the hex value for an environment other than doing:
>>>        e <- new.env()
>>>        capture.output(e)
>> Not in R code, but there's no use for it in R code, either.  If you want
>> to test for whether two variables refer to the same environment, then
>> attach a unique label to the environments when you create them and check
>> the labels.
>>
>> Duncan Murdoch
>>


From ggrothendieck at gmail.com  Sun Jan  7 17:31:43 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 7 Jan 2007 11:31:43 -0500
Subject: [Rd] environmentName
In-Reply-To: <45A11E85.60307@stats.uwo.ca>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>
	<45A0D9C4.2090508@stats.uwo.ca>
	<971536df0701070701y58646fe8k28e4b3c7bb67f937@mail.gmail.com>
	<45A11E85.60307@stats.uwo.ca>
Message-ID: <971536df0701070831u704cfca9hda67a128b5a282f3@mail.gmail.com>

What I was referring to was your suggestion to add a class and a Name
attribute to the environment.  That would change all references to it.
But what I would really want to do is to leave it alone unchanged so it
can be used in its original form by other applications but for my purpose
create a subobject which does not modify the original object. The problem
is that attributes are always associated with the environment itself and
not the reference to it so in order to do this one would
have to create a wrapper list(env = e, Name = "My Name") which would not
inherit any of the environment methods since its not an environment but
instead I would have to replicate every environment method myself.


On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 1/7/2007 10:01 AM, Gabor Grothendieck wrote:
> > One other comment.  If I place an attribute on the environment as you
> > suggest that changes all uses of the environment.
>
> Yes, that's exactly what you wanted, as far as I can tell.  If an
> environment prints as
>
> <environment: 0x0181a320>
>
> then all uses of that environment will print the same way.
>
> Duncan Murdoch
>
> I cannot keep the
> > original environment intact and have a subobject which represents the
> > original environment plus the attribute.  This is just one example of why
> > the feature discussed in my wishlist is needed (i.e. the ability to have
> > the attributes attached to variables rather than to the environment itself).
> > The only way to handle this currently is with the list(env = ...) construct
> > and attach the name to that but that is a lot of overhead since its means
> > that the subobject is not an environment so all environment methods
> > need to be replicated rather than inherited/delegated from the superobject
> > which really ought to be properly supported.
> >
> > On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On 1/7/2007 5:01 AM, Gabor Grothendieck wrote:
> >>> I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
> >>> each environment has:
> >>>
> >>> (1) a name
> >>> (2) a hex value
> >>>
> >>> so
> >>>
> >>> 1. environmentName gets the name.  Is there any way to set the name?
> >> The NEWS entry says:
> >>
> >>     o  New function environmentName() to give the print name of
> >>        environments such as "namespace:base".
> >>        This is now used by str().
> >>
> >> Take a look at the implementation in src/main/builtin.c.  The name isn't
> >> part of the environment, this is just derived from how the environment
> >> is being used.
> >>
> >> If you want to attach a label to an environment, use an attribute.  You
> >> can put an S3 class on an environment if you want it to print your label
> >> by default rather than use the standard print mechanism.
> >>
> >>> 2. is there any way to get the hex value for an environment other than doing:
> >>>        e <- new.env()
> >>>        capture.output(e)
> >> Not in R code, but there's no use for it in R code, either.  If you want
> >> to test for whether two variables refer to the same environment, then
> >> attach a unique label to the environments when you create them and check
> >> the labels.
> >>
> >> Duncan Murdoch
> >>
>
>


From murdoch at stats.uwo.ca  Sun Jan  7 17:43:55 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 07 Jan 2007 11:43:55 -0500
Subject: [Rd] environmentName
In-Reply-To: <971536df0701070831u704cfca9hda67a128b5a282f3@mail.gmail.com>
References: <971536df0701070201n511119cfh6faae2b5828d445b@mail.gmail.com>	
	<45A0D9C4.2090508@stats.uwo.ca>	
	<971536df0701070701y58646fe8k28e4b3c7bb67f937@mail.gmail.com>	
	<45A11E85.60307@stats.uwo.ca>
	<971536df0701070831u704cfca9hda67a128b5a282f3@mail.gmail.com>
Message-ID: <45A1234B.6020208@stats.uwo.ca>

On 1/7/2007 11:31 AM, Gabor Grothendieck wrote:
> What I was referring to was your suggestion to add a class and a Name
> attribute to the environment.

Yes, that was clear.

Duncan Murdoch

   That would change all references to it.
> But what I would really want to do is to leave it alone unchanged so it
> can be used in its original form by other applications but for my purpose
> create a subobject which does not modify the original object. The problem
> is that attributes are always associated with the environment itself and
> not the reference to it so in order to do this one would
> have to create a wrapper list(env = e, Name = "My Name") which would not
> inherit any of the environment methods since its not an environment but
> instead I would have to replicate every environment method myself.
> 
> 
> On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 1/7/2007 10:01 AM, Gabor Grothendieck wrote:
>>> One other comment.  If I place an attribute on the environment as you
>>> suggest that changes all uses of the environment.
>> Yes, that's exactly what you wanted, as far as I can tell.  If an
>> environment prints as
>>
>> <environment: 0x0181a320>
>>
>> then all uses of that environment will print the same way.
>>
>> Duncan Murdoch
>>
>> I cannot keep the
>>> original environment intact and have a subobject which represents the
>>> original environment plus the attribute.  This is just one example of why
>>> the feature discussed in my wishlist is needed (i.e. the ability to have
>>> the attributes attached to variables rather than to the environment itself).
>>> The only way to handle this currently is with the list(env = ...) construct
>>> and attach the name to that but that is a lot of overhead since its means
>>> that the subobject is not an environment so all environment methods
>>> need to be replicated rather than inherited/delegated from the superobject
>>> which really ought to be properly supported.
>>>
>>> On 1/7/07, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>> On 1/7/2007 5:01 AM, Gabor Grothendieck wrote:
>>>>> I noticed the new environmentName in R 2.5.0dev.  Thus I gather that
>>>>> each environment has:
>>>>>
>>>>> (1) a name
>>>>> (2) a hex value
>>>>>
>>>>> so
>>>>>
>>>>> 1. environmentName gets the name.  Is there any way to set the name?
>>>> The NEWS entry says:
>>>>
>>>>     o  New function environmentName() to give the print name of
>>>>        environments such as "namespace:base".
>>>>        This is now used by str().
>>>>
>>>> Take a look at the implementation in src/main/builtin.c.  The name isn't
>>>> part of the environment, this is just derived from how the environment
>>>> is being used.
>>>>
>>>> If you want to attach a label to an environment, use an attribute.  You
>>>> can put an S3 class on an environment if you want it to print your label
>>>> by default rather than use the standard print mechanism.
>>>>
>>>>> 2. is there any way to get the hex value for an environment other than doing:
>>>>>        e <- new.env()
>>>>>        capture.output(e)
>>>> Not in R code, but there's no use for it in R code, either.  If you want
>>>> to test for whether two variables refer to the same environment, then
>>>> attach a unique label to the environments when you create them and check
>>>> the labels.
>>>>
>>>> Duncan Murdoch
>>>>
>>


From cstevenson at edisonresearch.com  Sun Jan  7 04:01:10 2007
From: cstevenson at edisonresearch.com (cstevenson at edisonresearch.com)
Date: Sun,  7 Jan 2007 04:01:10 +0100 (CET)
Subject: [Rd] round(4.5) does not work (PR#9439)
Message-ID: <20070107030110.B8FA54C98B@slim.kubism.ku.dk>

Anything that has 4.5 in it will always round to 4.  For example 24.5 becomes 24 and 34.5 becomes 34.  Or 1234567894.5 will become 1234567894.

> round(4.5)
[1] 4
> round(3.5)
[1] 4

Thanks,

Clint W. Stevenson
Senior Statistician
Edison Media Research
cstevenson at edisonresearch.com


--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 2
 minor = 4.1
 year = 2006
 month = 12
 day = 18
 svn rev = 40228
 language = R
 version.string = R version 2.4.1 (2006-12-18)

Windows XP Professional (build 2600) Service Pack 2.0

Locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base


From murdoch at stats.uwo.ca  Sun Jan  7 18:39:53 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 07 Jan 2007 12:39:53 -0500
Subject: [Rd] round(4.5) does not work (PR#9439)
In-Reply-To: <20070107030110.B8FA54C98B@slim.kubism.ku.dk>
References: <20070107030110.B8FA54C98B@slim.kubism.ku.dk>
Message-ID: <45A13069.8070506@stats.uwo.ca>

On 1/6/2007 10:01 PM, cstevenson at edisonresearch.com wrote:
> Anything that has 4.5 in it will always round to 4.  For example 24.5 becomes 24 and 34.5 becomes 34.  Or 1234567894.5 will become 1234567894.
> 
>> round(4.5)
> [1] 4
>> round(3.5)
> [1] 4

That's behaving as documented, using "banker's rounding". See the ?round 
man page.

Duncan Murdoch

> Thanks,
> 
> Clint W. Stevenson
> Senior Statistician
> Edison Media Research
> cstevenson at edisonresearch.com
> 
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status = 
>  major = 2
>  minor = 4.1
>  year = 2006
>  month = 12
>  day = 18
>  svn rev = 40228
>  language = R
>  version.string = R version 2.4.1 (2006-12-18)
> 
> Windows XP Professional (build 2600) Service Pack 2.0
> 
> Locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> Search Path:
>  .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Mark.Bravington at csiro.au  Mon Jan  8 00:55:38 2007
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Mon, 8 Jan 2007 10:55:38 +1100
Subject: [Rd] substitute creates an object
	whichprints	incorrectly	(PR#9427)
Message-ID: <D79013E40FEF254AAF0D72DFC94F27482307C3@extas4-hba.tas.csiro.au>

> I think we should get rid of source attributes completely, 
> since they are no longer needed, but your comment still 
> applies to source references. We should strip them when code 
> gets modified.
> 
> Duncan Murdoch

I would be very concerned about losing source attributes-- it would
break a lot of my code :(! It's very useful to have a single portable R
object that contains the whole of a function, including its printable
representation with full comments and formatted in whatever style the
author prefers (and indeed the documentation, in the way I work); I use
.Rdata files to swap multiple functions & data with colleagues all the
time.

Source references-to-files entail having to keep track of separate
files, so are much less portable.

I haven't had time to follow Duncan's recent changes on source
references, but would it also be possible to use the new
attribute-attaching-indexing mechanism to point to places in the
'source' attribute rather than in a file? That might offer the best of
both worlds to dinosaurs like me who rely on source attributes...

Mark Bravington

CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623
 

> 
> > 
> >> Perhaps the compromise has to be to warn people that 
> keep.source=TRUE 
> >> can be dangerous in this way, both in the help informaton for 
> >> options() and for substitute().
> >>
> >> ?
> >>
> >> Bill Venables.
> >>
> >> -----Original Message-----
> >> From: Peter Dalgaard [mailto:p.dalgaard at biostat.ku.dk]
> >> Sent: Friday, 22 December 2006 9:47 PM
> >> To: Venables, Bill (CMIS, Cleveland)
> >> Cc: r-devel at stat.math.ethz.ch; R-bugs at biostat.ku.dk
> >> Subject: Re: [Rd] substitute creates an object which prints 
> >> incorrectly
> >> (PR#9427)
> >>
> >> Bill.Venables at csiro.au wrote:
> >>   
> >>> The function "substitute" seems to fail to make a genuine 
> >>> substitution, although the printed verision seems fine.  
> Here is an 
> >>> example.
> >>>
> >>>   
> >>>     
> >>>> m <- substitute(Y <- function(x) FUN(x+1),
> >>>>     
> >>>>       
> >>> + list(Y = as.name("y"), FUN = as.name("sin")))
> >>>   
> >>>     
> >>>> m
> >>>>     
> >>>>       
> >>> y <- function(x) sin(x + 1)
> >>>   
> >>>     
> >>>> eval(m)
> >>>> y
> >>>>     
> >>>>       
> >>> function(x) FUN(x+1)
> >>>
> >>> However the story doesn't end there.  The substitution appears to 
> >>> have been made, even though the printed version, this 
> time, suggests 
> >>> otherwise.
> >>>
> >>>   
> >>>     
> >>>> y(pi)
> >>>>     
> >>>>       
> >>> [1] -0.841471
> >>>   
> >>>     
> >>>> sin(pi+1)
> >>>>     
> >>>>       
> >>> [1] -0.841471
> >>>   
> >>>
> >>>   
> >>>     
> >> Yes, this is (fairly) well known. It has to do with the 
> retention of 
> >> function source.
> >>
> >> The thing to notice is that it is only the printing of y that is 
> >> really confused. If you do
> >>
> >> dput(y)
> >> attr(y, "source")
> >> attr(y, "source") <- NULL
> >> y
> >>
> >> then you should see the point. The tricky bit is that the "source" 
> >> attribute exists in an intermediate form inside m. Notice that m 
> >> contains, not the function itself, but a call to the function 
> >> `function`
> >>
> >> which creates the function when eval'ed. This call contains the 
> >> function
> >>
> >> source as its 4th element (look at m[[3]][[4]] in your 
> example), and 
> >> you
> >>
> >> might try setting it to NULL and see how things will clear up.
> >>
> >> The issue with substitute is that it cannot sensibly 
> substitute into 
> >> character vectors, so it just leaves  the source as is, 
> which gives 
> >> the symptoms you see. It could, however, and probably should, 
> >> recognize calls to `function` and NULL out their 4th element. It 
> >> cannot be done completely failsafe though (`function` could result 
> >> from a computation, or even be part of the substitution), 
> so one has 
> >> to decide that the extreme cases are too extreme worry about them.
> >>  
> >> -pd
> >>
> >>   
> >>> Bill Venables
> >>> CMIS, CSIRO Laboratories,
> >>> PO Box 120, Cleveland, Qld. 4163
> >>> AUSTRALIA
> >>> Office Phone (email preferred): +61 7 3826 7251 
> >>> Fax (if absolutely necessary):    +61 7 3826 7304 
> >>> Mobile (rarely used):                +61 4 1963 4642 
> >>> Home Phone:                          +61 7 3286 7700 
> >>> mailto:Bill.Venables at csiro.au
> >>> http://www.cmis.csiro.au/bill.venables/
> >>>
> >>>
> >>> --please do not edit the information below--
> >>>
> >>> Version:
> >>>  platform = i386-pc-mingw32
> >>>  arch = i386
> >>>  os = mingw32
> >>>  system = i386, mingw32
> >>>  status =
> >>>  major = 2
> >>>  minor = 4.1
> >>>  year = 2006
> >>>  month = 12
> >>>  day = 18
> >>>  svn rev = 40228
> >>>  language = R
> >>>  version.string = R version 2.4.1 (2006-12-18)
> >>>
> >>> Windows XP Professional (build 2600) Service Pack 2.0
> >>>
> >>> Locale:
> >>>
> >>>     
> >> 
> LC_COLLATE=English_Australia.1252;LC_CTYPE=English_Australia.1252;LC_
> >> MON
> >>   
> >> 
> ETARY=English_Australia.1252;LC_NUMERIC=C;LC_TIME=English_Australia.1
> >> 252
> >>   
> >>> Search Path:
> >>>  .GlobalEnv, .R_Store, package:RODBC, package:xlsReadWrite, 
> >>> package:cluster, package:vegan, package:ASOR, package:stats, 
> >>> package:graphics, package:grDevices, package:utils, 
> >>> package:datasets, .R_Data, .R_Utils, package:svIDE, 
> package:tcltk, 
> >>> package:methods, Autoloads, package:base
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>
> >>>     
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From murdoch at stats.uwo.ca  Mon Jan  8 01:09:15 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 07 Jan 2007 19:09:15 -0500
Subject: [Rd] substitute creates an object
	whichprints	incorrectly	(PR#9427)
In-Reply-To: <D79013E40FEF254AAF0D72DFC94F27482307C3@extas4-hba.tas.csiro.au>
References: <D79013E40FEF254AAF0D72DFC94F27482307C3@extas4-hba.tas.csiro.au>
Message-ID: <45A18BAB.6070708@stats.uwo.ca>

On 1/7/2007 6:55 PM, Mark.Bravington at csiro.au wrote:
>> I think we should get rid of source attributes completely, 
>> since they are no longer needed, but your comment still 
>> applies to source references. We should strip them when code 
>> gets modified.
>>
>> Duncan Murdoch
> 
> I would be very concerned about losing source attributes-- it would
> break a lot of my code :(! It's very useful to have a single portable R
> object that contains the whole of a function, including its printable
> representation with full comments and formatted in whatever style the
> author prefers (and indeed the documentation, in the way I work); I use
> .Rdata files to swap multiple functions & data with colleagues all the
> time.
> 
> Source references-to-files entail having to keep track of separate
> files, so are much less portable.
> 
> I haven't had time to follow Duncan's recent changes on source
> references, but would it also be possible to use the new
> attribute-attaching-indexing mechanism to point to places in the
> 'source' attribute rather than in a file? That might offer the best of
> both worlds to dinosaurs like me who rely on source attributes...

You can do essentially that using a reference to a srcfilecopy, instead 
of a srcfile.  It keeps a copy of the source. The difference between 
this and your proposal is that if there are multiple functions defined 
in the same file, the source references of all of them refer to the same 
copy of the source file (so you can see the comments that came between 
the function definitions, etc.)

What is not done yet (and I probably won't have time to do for 2.5.0) is 
working out exactly what the user interface is that determines whether a 
srcfilecopy gets produced automatically.  Right now it only happens if 
you parse using the text= arg instead of the file= arg, but clearly 
there are situations where you'd want to save a copy even though you're 
reading from a file.

Duncan Murdoch

> 
> Mark Bravington
> 
> CSIRO Mathematical & Information Sciences
> Marine Laboratory
> Castray Esplanade
> Hobart 7001
> TAS
> 
> ph (+61) 3 6232 5118
> fax (+61) 3 6232 5012
> mob (+61) 438 315 623
>  
> 
>>>> Perhaps the compromise has to be to warn people that 
>> keep.source=TRUE 
>>>> can be dangerous in this way, both in the help informaton for 
>>>> options() and for substitute().
>>>>
>>>> ?
>>>>
>>>> Bill Venables.
>>>>
>>>> -----Original Message-----
>>>> From: Peter Dalgaard [mailto:p.dalgaard at biostat.ku.dk]
>>>> Sent: Friday, 22 December 2006 9:47 PM
>>>> To: Venables, Bill (CMIS, Cleveland)
>>>> Cc: r-devel at stat.math.ethz.ch; R-bugs at biostat.ku.dk
>>>> Subject: Re: [Rd] substitute creates an object which prints 
>>>> incorrectly
>>>> (PR#9427)
>>>>
>>>> Bill.Venables at csiro.au wrote:
>>>>   
>>>>> The function "substitute" seems to fail to make a genuine 
>>>>> substitution, although the printed verision seems fine.  
>> Here is an 
>>>>> example.
>>>>>
>>>>>   
>>>>>     
>>>>>> m <- substitute(Y <- function(x) FUN(x+1),
>>>>>>     
>>>>>>       
>>>>> + list(Y = as.name("y"), FUN = as.name("sin")))
>>>>>   
>>>>>     
>>>>>> m
>>>>>>     
>>>>>>       
>>>>> y <- function(x) sin(x + 1)
>>>>>   
>>>>>     
>>>>>> eval(m)
>>>>>> y
>>>>>>     
>>>>>>       
>>>>> function(x) FUN(x+1)
>>>>>
>>>>> However the story doesn't end there.  The substitution appears to 
>>>>> have been made, even though the printed version, this 
>> time, suggests 
>>>>> otherwise.
>>>>>
>>>>>   
>>>>>     
>>>>>> y(pi)
>>>>>>     
>>>>>>       
>>>>> [1] -0.841471
>>>>>   
>>>>>     
>>>>>> sin(pi+1)
>>>>>>     
>>>>>>       
>>>>> [1] -0.841471
>>>>>   
>>>>>
>>>>>   
>>>>>     
>>>> Yes, this is (fairly) well known. It has to do with the 
>> retention of 
>>>> function source.
>>>>
>>>> The thing to notice is that it is only the printing of y that is 
>>>> really confused. If you do
>>>>
>>>> dput(y)
>>>> attr(y, "source")
>>>> attr(y, "source") <- NULL
>>>> y
>>>>
>>>> then you should see the point. The tricky bit is that the "source" 
>>>> attribute exists in an intermediate form inside m. Notice that m 
>>>> contains, not the function itself, but a call to the function 
>>>> `function`
>>>>
>>>> which creates the function when eval'ed. This call contains the 
>>>> function
>>>>
>>>> source as its 4th element (look at m[[3]][[4]] in your 
>> example), and 
>>>> you
>>>>
>>>> might try setting it to NULL and see how things will clear up.
>>>>
>>>> The issue with substitute is that it cannot sensibly 
>> substitute into 
>>>> character vectors, so it just leaves  the source as is, 
>> which gives 
>>>> the symptoms you see. It could, however, and probably should, 
>>>> recognize calls to `function` and NULL out their 4th element. It 
>>>> cannot be done completely failsafe though (`function` could result 
>>>> from a computation, or even be part of the substitution), 
>> so one has 
>>>> to decide that the extreme cases are too extreme worry about them.
>>>>  
>>>> -pd
>>>>
>>>>   
>>>>> Bill Venables
>>>>> CMIS, CSIRO Laboratories,
>>>>> PO Box 120, Cleveland, Qld. 4163
>>>>> AUSTRALIA
>>>>> Office Phone (email preferred): +61 7 3826 7251 
>>>>> Fax (if absolutely necessary):    +61 7 3826 7304 
>>>>> Mobile (rarely used):                +61 4 1963 4642 
>>>>> Home Phone:                          +61 7 3286 7700 
>>>>> mailto:Bill.Venables at csiro.au
>>>>> http://www.cmis.csiro.au/bill.venables/
>>>>>
>>>>>
>>>>> --please do not edit the information below--
>>>>>
>>>>> Version:
>>>>>  platform = i386-pc-mingw32
>>>>>  arch = i386
>>>>>  os = mingw32
>>>>>  system = i386, mingw32
>>>>>  status =
>>>>>  major = 2
>>>>>  minor = 4.1
>>>>>  year = 2006
>>>>>  month = 12
>>>>>  day = 18
>>>>>  svn rev = 40228
>>>>>  language = R
>>>>>  version.string = R version 2.4.1 (2006-12-18)
>>>>>
>>>>> Windows XP Professional (build 2600) Service Pack 2.0
>>>>>
>>>>> Locale:
>>>>>
>>>>>     
>> LC_COLLATE=English_Australia.1252;LC_CTYPE=English_Australia.1252;LC_
>>>> MON
>>>>   
>>>>
>> ETARY=English_Australia.1252;LC_NUMERIC=C;LC_TIME=English_Australia.1
>>>> 252
>>>>   
>>>>> Search Path:
>>>>>  .GlobalEnv, .R_Store, package:RODBC, package:xlsReadWrite, 
>>>>> package:cluster, package:vegan, package:ASOR, package:stats, 
>>>>> package:graphics, package:grDevices, package:utils, 
>>>>> package:datasets, .R_Data, .R_Utils, package:svIDE, 
>> package:tcltk, 
>>>>> package:methods, Autoloads, package:base
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>     
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


From hin-tak.leung at cimr.cam.ac.uk  Mon Jan  8 12:36:20 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Mon, 08 Jan 2007 11:36:20 +0000
Subject: [Rd] How to execute R scripts simultaneously from
	multiple	threads
In-Reply-To: <459E289C.1080201@erik.prutser.cx>
References: <459B6DBA.3050207@erik.prutser.cx>	<200701031337.45613.vdergachev@rcgardis.com>	<459CCEDB.5040201@erik.prutser.cx>	<200701041237.30054.vdergachev@rcgardis.com>
	<459E289C.1080201@erik.prutser.cx>
Message-ID: <45A22CB4.1090305@cimr.cam.ac.uk>

Erik van Zijst wrote:
> Vladimir Dergachev wrote:
<snipped>
>> At some point (years ago) there was even an argument on some mailiing list 
>> (xfree86-devel ?) about whether Xserver should support shared memory as unix 
>> socket was "fast enough" - with the other side arguing that when you pass 
>> megabyte images around (as in DVD playback) there is non-negligible overhead.
> 
> We're currently doing performance tests with the RServe-approach where 
> we measure the actual evaluation time of a function. I'm interested in 
> the evaluation-time versus overhead ratio. Loopback TCP might work as 
> long as this ratio is sufficiently high.

Slightly off-topic, Vladimir sounded as if there was any argument of 
supporting shared memory in X... AFAIK, the shared memory extension
*is* part of Xorg!

$ grep 'MIT-SHM' /var/log/Xorg.0.log
(II) Initializing built-in extension MIT-SHM

- the shared memory extension is also crucial for
client-side font-rendering (xft/freetype) a.k.a. all those
nicely anti-aliased texts in firefox and openoffice, besides
DVD playbacks.

HTL


From hin-tak.leung at cimr.cam.ac.uk  Mon Jan  8 13:15:24 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Mon, 08 Jan 2007 12:15:24 +0000
Subject: [Rd] (PR#9437) pb in regular expression with the character "-"
In-Reply-To: <20070104230600.7E8AB572FE@slim.kubism.ku.dk>
References: <20070104230600.7E8AB572FE@slim.kubism.ku.dk>
Message-ID: <45A235DC.7070506@cimr.cam.ac.uk>

May I chip in at this point - I agree the bug report was invalid, but
many of the replies were missing the point, as far as I see. It
wasn't the backslash escape that "Fan" is *mainly* confused about
(which he obviously is...), but the uses of the different brackets:
[] ,() .

He/She was expecting this:
         egrep '[a|\-|c]' foo.txt
to work the same as:
         egrep '(a|\-|c)'  foo.txt

which they do not. They are totally different. (and he doesn't know
the proper use of "|" either... so we basically have established that 
"Fan" doesn't understand how \, |, [] and () are used in
regular expressions...).

HTL

ripley at stats.ox.ac.uk wrote:
> Both Solaris 8 grep and GNU grep 2.5.1 give
> 
> gannet% cat > foo.txt
> a-a
> b
> gannet% egrep '[d|-|c]' foo.txt
> gannet% egrep '[-|c]' foo.txt
> a-a
> 
> agreeing exactly with R (and the POSIX standard) and contradicting 'Fan'.
> 
> 
> On Thu, 4 Jan 2007, Fan wrote:
> 
>> Let me detail a bit my bug report:
>>
>> the two commands ("expected" vs "strange") should return the
>> same result, the objective of the commands is to test the presence
>> of several characters, '-'included.
>>
>> The order in which we specify the different characters must not be
>> an issue, i.e., to test the presence of several characters, including
>> say char_1, the regular expressions [char_1|char_2|char_3] and 
>> [char_2|char_1|char_3] should play the same role. Other softwares
>> work just like this.
>>
>> What's reported is that R actually returns different result for the
>> character "-" (\- in a RE) regarding it's position in the regular
>> expression, and the "perl" option would not be relevant.
> 
> As described in the relevant international standard and R's own 
> documentation.
> 
>> Prof Brian Ripley wrote:
>>> Why do you think this is a bug in R?  You have not told us what you 
>>> expected, but the character range |-| contains only | .  Not agreeing with 
>>> your expectations (unstated or otherwise) is not a bug in R.
>>>
>>> \- is the same as -, and - is special in character classes.  (If it is 
>>> first or last it is treated literally.)  And | is not a metacharacter 
>>> inside a character class.  Also,
>>>
>>>> grep("[d\\-c]", c("a-a","b"))
>>> [1] 1 2
>>>
>>>> grep("[d\\-c]", c("a-a","b"), perl=TRUE)
>>> [1] 1
>>>
>>> shows that escaping - works only in perl (which you will find from the 
>>> background references mentioned, e.g.
>>>
>>>   The interpretation of an ordinary character preceded by a backslash
>>>   ('\') is undefined.
>>>
>>> .)
>>>
>>> This is all carefully documented in ?regexp, e.g.
>>>
>>>      Patterns are described here as they would be printed by 'cat': do
>>>      remember that backslashes need to be doubled in entering R
>>>      character strings from the keyboard.
>>>
>>>
>>> This is not the first time you have wasted our resources with false bug 
>>> reports, so please show more respect for the R developers' time.
>>> You were also explicitly asked not to report on obselete versions of R.
>>>
>>> On Wed, 3 Jan 2007, xiao.gang.fan1 at libertysurf.fr wrote:
>>>
>>>> Full_Name: FAN
>>>> Version: 2.4.0
>>>> OS: Windows
>>>> Submission from: (NULL) (159.50.101.9)
>>>>
>>>>
>>>> These are expected:
>>>>
>>>>> grep("[\-|c]", c("a-a","b"))
>>>> [1] 1
>>>>
>>>>> gsub("[\-|c]", "&", c("a-a","b"))
>>>> [1] "a&a" "b"
>>>>
>>>> but these are strange:
>>>>
>>>>> grep("[d|\-|c]", c("a-a","b"))
>>>> integer(0)
>>>>
>>>>> gsub("[d|\-|c]", "&", c("a-a","b"))
>>>> [1] "a-a" "b"
>>>>
>>>> Thanks
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>


From ripley at stats.ox.ac.uk  Mon Jan  8 13:34:00 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 8 Jan 2007 12:34:00 +0000 (GMT)
Subject: [Rd] (PR#9437) pb in regular expression with the character "-"
In-Reply-To: <45A235DC.7070506@cimr.cam.ac.uk>
References: <20070104230600.7E8AB572FE@slim.kubism.ku.dk>
	<45A235DC.7070506@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701081230140.17810@gannet.stats.ox.ac.uk>

On Mon, 8 Jan 2007, Hin-Tak Leung wrote:

> May I chip in at this point - I agree the bug report was invalid, but
> many of the replies were missing the point, as far as I see. It
> wasn't the backslash escape that "Fan" is *mainly* confused about
> (which he obviously is...), but the uses of the different brackets:
> [] ,() .
>
> He/She was expecting this:
>         egrep '[a|\-|c]' foo.txt
> to work the same as:
>         egrep '(a|\-|c)'  foo.txt
>
> which they do not. They are totally different. (and he doesn't know
> the proper use of "|" either... so we basically have established that
> "Fan" doesn't understand how \, |, [] and () are used in
> regular expressions...).

And I think *you* have missed the point of the posting you quoted here, 
which was to show how '[a|-|c]' actually worked in 'other software'.

How '[a|\-|c]' (or '(a|\-|c)) works in egrep is explicitly undefined by 
POSIX, as I said in my original reply.

>
> HTL
>
> ripley at stats.ox.ac.uk wrote:
>> Both Solaris 8 grep and GNU grep 2.5.1 give
>>
>> gannet% cat > foo.txt
>> a-a
>> b
>> gannet% egrep '[d|-|c]' foo.txt
>> gannet% egrep '[-|c]' foo.txt
>> a-a
>>
>> agreeing exactly with R (and the POSIX standard) and contradicting 'Fan'.
>>
>>
>> On Thu, 4 Jan 2007, Fan wrote:
>>
>>> Let me detail a bit my bug report:
>>>
>>> the two commands ("expected" vs "strange") should return the
>>> same result, the objective of the commands is to test the presence
>>> of several characters, '-'included.
>>>
>>> The order in which we specify the different characters must not be
>>> an issue, i.e., to test the presence of several characters, including
>>> say char_1, the regular expressions [char_1|char_2|char_3] and
>>> [char_2|char_1|char_3] should play the same role. Other softwares
>>> work just like this.
>>>
>>> What's reported is that R actually returns different result for the
>>> character "-" (\- in a RE) regarding it's position in the regular
>>> expression, and the "perl" option would not be relevant.
>>
>> As described in the relevant international standard and R's own
>> documentation.
>>
>>> Prof Brian Ripley wrote:
>>>> Why do you think this is a bug in R?  You have not told us what you
>>>> expected, but the character range |-| contains only | .  Not agreeing with
>>>> your expectations (unstated or otherwise) is not a bug in R.
>>>>
>>>> \- is the same as -, and - is special in character classes.  (If it is
>>>> first or last it is treated literally.)  And | is not a metacharacter
>>>> inside a character class.  Also,
>>>>
>>>>> grep("[d\\-c]", c("a-a","b"))
>>>> [1] 1 2
>>>>
>>>>> grep("[d\\-c]", c("a-a","b"), perl=TRUE)
>>>> [1] 1
>>>>
>>>> shows that escaping - works only in perl (which you will find from the
>>>> background references mentioned, e.g.
>>>>
>>>>   The interpretation of an ordinary character preceded by a backslash
>>>>   ('\') is undefined.
>>>>
>>>> .)
>>>>
>>>> This is all carefully documented in ?regexp, e.g.
>>>>
>>>>      Patterns are described here as they would be printed by 'cat': do
>>>>      remember that backslashes need to be doubled in entering R
>>>>      character strings from the keyboard.
>>>>
>>>>
>>>> This is not the first time you have wasted our resources with false bug
>>>> reports, so please show more respect for the R developers' time.
>>>> You were also explicitly asked not to report on obselete versions of R.
>>>>
>>>> On Wed, 3 Jan 2007, xiao.gang.fan1 at libertysurf.fr wrote:
>>>>
>>>>> Full_Name: FAN
>>>>> Version: 2.4.0
>>>>> OS: Windows
>>>>> Submission from: (NULL) (159.50.101.9)
>>>>>
>>>>>
>>>>> These are expected:
>>>>>
>>>>>> grep("[\-|c]", c("a-a","b"))
>>>>> [1] 1
>>>>>
>>>>>> gsub("[\-|c]", "&", c("a-a","b"))
>>>>> [1] "a&a" "b"
>>>>>
>>>>> but these are strange:
>>>>>
>>>>>> grep("[d|\-|c]", c("a-a","b"))
>>>>> integer(0)
>>>>>
>>>>>> gsub("[d|\-|c]", "&", c("a-a","b"))
>>>>> [1] "a-a" "b"
>>>>>
>>>>> Thanks
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Mon Jan  8 16:25:56 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 8 Jan 2007 16:25:56 +0100
Subject: [Rd] Wish list
In-Reply-To: <45A042AB.4080709@stats.uwo.ca>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45A042AB.4080709@stats.uwo.ca>
Message-ID: <17826.25220.148425.414315@stat.math.ethz.ch>

>>>>> "Duncan" == Duncan Murdoch <murdoch at stats.uwo.ca>
>>>>>     on Sat, 06 Jan 2007 19:45:31 -0500 writes:

    Duncan> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
    >> 7. documentation standards for packages - NEWS/ChangeLog
    >> (also should be accessible from CRAN page for package and
    >> should be included in built version of package) -
    >> package?mypackage

    Duncan> Just to let you know: I uploaded a revision of rgl
    Duncan> just a minute ago, and moved the ChangeLog file to a
    Duncan> place where it will be included when installed, and
    Duncan> available from the ?rgl or package?rgl help topic.

That's a good idea, but I think  "R CMD build" should try to do
this automatically,
and indeed try both 'NEWS' and 'ChangeLog'.

With something like the following as basic idea, 
ugly at the moment
(I'm using 'sh' syntax; assuming working directory is "just
 inside" the source package) :

 if [ ! -f inst/ChangeLog ]
 then
   if [ -f ChangeLog ]
   then
      if [ ! -d inst ] ; then mkdir inst ; fi
      mv ChangeLog inst

      <<< tar cfz .... etc build the   <pkg>_<version>tar.gz >>>

      mv inst/ChangeLog .
   fi
 fi

{{ yes, a proper solution would not use  'mv' and 'mv back' }}

For pkg authors on a Unix alike OS, a very simple
solution would be to simply always have the real file in  
   inst/ChangeLog
and have
   ln -s inst/ChangeLog .
such that niceities like "C-x 4 a" in Emacs for semi-automatic
ChangeLog updating still work.

----- 

BTW, I wonder if extending the list to also include files such
as "TODO" or "README" wouldn't make sense too, but probably not:
People really interested in a package's development look at the
package *source*, not the installed package.

    Duncan> Thanks for the suggestion.
    Duncan> Duncan Murdoch

yes, indeed.
Martin Maechler


From ggrothendieck at gmail.com  Mon Jan  8 16:45:52 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 8 Jan 2007 10:45:52 -0500
Subject: [Rd] Wish list
In-Reply-To: <17826.25220.148425.414315@stat.math.ethz.ch>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45A042AB.4080709@stats.uwo.ca>
	<17826.25220.148425.414315@stat.math.ethz.ch>
Message-ID: <971536df0701080745l3e076299k760279b7b10f2562@mail.gmail.com>

On 1/8/07, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> >>>>> "Duncan" == Duncan Murdoch <murdoch at stats.uwo.ca>
> >>>>>     on Sat, 06 Jan 2007 19:45:31 -0500 writes:
>
>    Duncan> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
>    >> 7. documentation standards for packages - NEWS/ChangeLog
>    >> (also should be accessible from CRAN page for package and
>    >> should be included in built version of package) -
>    >> package?mypackage
>
>    Duncan> Just to let you know: I uploaded a revision of rgl
>    Duncan> just a minute ago, and moved the ChangeLog file to a
>    Duncan> place where it will be included when installed, and
>    Duncan> available from the ?rgl or package?rgl help topic.
>
> That's a good idea, but I think  "R CMD build" should try to do
> this automatically,
> and indeed try both 'NEWS' and 'ChangeLog'.
>
> With something like the following as basic idea,
> ugly at the moment
> (I'm using 'sh' syntax; assuming working directory is "just
>  inside" the source package) :
>
>  if [ ! -f inst/ChangeLog ]
>  then
>   if [ -f ChangeLog ]
>   then
>      if [ ! -d inst ] ; then mkdir inst ; fi
>      mv ChangeLog inst
>
>      <<< tar cfz .... etc build the   <pkg>_<version>tar.gz >>>
>
>      mv inst/ChangeLog .
>   fi
>  fi
>
> {{ yes, a proper solution would not use  'mv' and 'mv back' }}
>
> For pkg authors on a Unix alike OS, a very simple
> solution would be to simply always have the real file in
>   inst/ChangeLog
> and have
>   ln -s inst/ChangeLog .
> such that niceities like "C-x 4 a" in Emacs for semi-automatic
> ChangeLog updating still work.
>
> -----
>
> BTW, I wonder if extending the list to also include files such
> as "TODO" or "README" wouldn't make sense too, but probably not:
> People really interested in a package's development look at the
> package *source*, not the installed package.

I think it would be nice to extend this to THANKS so that contributors
are recognized by the users of the package and not just the developers.


From sfalcon at fhcrc.org  Mon Jan  8 16:54:46 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Mon, 08 Jan 2007 07:54:46 -0800
Subject: [Rd] can't compile on OSX: unsetenv header issues
Message-ID: <m23b6lfr95.fsf@fhcrc.org>

Hi,

A recent change has R failing to compile (for me) on ppc OSX 10.4.8 like this:

../../../../R-devel/src/main/datetime.c: In function `reset_tz':
../../../../R-devel/src/main/datetime.c:511: error: void value not ignored as it ought to be

I suspect there is some sort of configure magic that needs to happen
to get the POSIX compatible unsetenv on OSX.  Here's what I think is
the relevant bit from stdlib.h, but I'm hoping someone with more OSX
experience will recognize what needs to be done.

#if __DARWIN_UNIX03
int      unsetenv(const char *) __DARWIN_ALIAS(unsetenv);
#else /* !__DARWIN_UNIX03 */
void     unsetenv(const char *);
#endif /* __DARWIN_UNIX03 */


+ seth


From ggrothendieck at gmail.com  Mon Jan  8 17:50:59 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 8 Jan 2007 11:50:59 -0500
Subject: [Rd] Wish list
In-Reply-To: <971536df0701080745l3e076299k760279b7b10f2562@mail.gmail.com>
References: <971536df0612312228i4a4bb0b2h6c52c081213c296@mail.gmail.com>
	<45A042AB.4080709@stats.uwo.ca>
	<17826.25220.148425.414315@stat.math.ethz.ch>
	<971536df0701080745l3e076299k760279b7b10f2562@mail.gmail.com>
Message-ID: <971536df0701080850nbddb575saeff9d621fa47ac2@mail.gmail.com>

On 1/8/07, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> On 1/8/07, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> > >>>>> "Duncan" == Duncan Murdoch <murdoch at stats.uwo.ca>
> > >>>>>     on Sat, 06 Jan 2007 19:45:31 -0500 writes:
> >
> >    Duncan> On 1/1/2007 1:28 AM, Gabor Grothendieck wrote:
> >    >> 7. documentation standards for packages - NEWS/ChangeLog
> >    >> (also should be accessible from CRAN page for package and
> >    >> should be included in built version of package) -
> >    >> package?mypackage
> >
> >    Duncan> Just to let you know: I uploaded a revision of rgl
> >    Duncan> just a minute ago, and moved the ChangeLog file to a
> >    Duncan> place where it will be included when installed, and
> >    Duncan> available from the ?rgl or package?rgl help topic.
> >
> > That's a good idea, but I think  "R CMD build" should try to do
> > this automatically,
> > and indeed try both 'NEWS' and 'ChangeLog'.
> >
> > With something like the following as basic idea,
> > ugly at the moment
> > (I'm using 'sh' syntax; assuming working directory is "just
> >  inside" the source package) :
> >
> >  if [ ! -f inst/ChangeLog ]
> >  then
> >   if [ -f ChangeLog ]
> >   then
> >      if [ ! -d inst ] ; then mkdir inst ; fi
> >      mv ChangeLog inst
> >
> >      <<< tar cfz .... etc build the   <pkg>_<version>tar.gz >>>
> >
> >      mv inst/ChangeLog .
> >   fi
> >  fi
> >
> > {{ yes, a proper solution would not use  'mv' and 'mv back' }}
> >
> > For pkg authors on a Unix alike OS, a very simple
> > solution would be to simply always have the real file in
> >   inst/ChangeLog
> > and have
> >   ln -s inst/ChangeLog .
> > such that niceities like "C-x 4 a" in Emacs for semi-automatic
> > ChangeLog updating still work.
> >
> > -----
> >
> > BTW, I wonder if extending the list to also include files such
> > as "TODO" or "README" wouldn't make sense too, but probably not:
> > People really interested in a package's development look at the
> > package *source*, not the installed package.
>
> I think it would be nice to extend this to THANKS so that contributors
> are recognized by the users of the package and not just the developers.
>

Also it would be nice if links to these files were on the CRAN description
page, e.g. to be clear I am referring to pages such as this:

http://cran.r-project.org/src/contrib/Descriptions/gsubfn.html

The NEWS and ChangeLog, in particular, contain information that
a user might want to read prior to downloading the package and
links to them would be particularly helpful there.


From ripley at stats.ox.ac.uk  Mon Jan  8 18:47:28 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 8 Jan 2007 17:47:28 +0000 (GMT)
Subject: [Rd] can't compile on OSX: unsetenv header issues
In-Reply-To: <m23b6lfr95.fsf@fhcrc.org>
References: <m23b6lfr95.fsf@fhcrc.org>
Message-ID: <Pine.LNX.4.64.0701081740560.319@gannet.stats.ox.ac.uk>

On Mon, 8 Jan 2007, Seth Falcon wrote:

> Hi,
>
> A recent change has R failing to compile (for me) on ppc OSX 10.4.8 like this:
>
> ../../../../R-devel/src/main/datetime.c: In function `reset_tz':
> ../../../../R-devel/src/main/datetime.c:511: error: void value not ignored as it ought to be
>
> I suspect there is some sort of configure magic that needs to happen
> to get the POSIX compatible unsetenv on OSX.  Here's what I think is
> the relevant bit from stdlib.h, but I'm hoping someone with more OSX
> experience will recognize what needs to be done.

So do I, but does defining __DARWIN_UNIX03 at the head of that file (and
sysutils.c) solve this?

OSes who adopt pretty standard function names with non-standard 
implementations used to be commonplace, but I had rather hoped we had seen 
the last of this after Single Unix Standard, POSIX ....


> #if __DARWIN_UNIX03
> int      unsetenv(const char *) __DARWIN_ALIAS(unsetenv);
> #else /* !__DARWIN_UNIX03 */
> void     unsetenv(const char *);
> #endif /* __DARWIN_UNIX03 */
>
>
> + seth
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From tpapp at Princeton.EDU  Mon Jan  8 18:49:02 2007
From: tpapp at Princeton.EDU (Tamas K Papp)
Date: Mon, 8 Jan 2007 18:49:02 +0100
Subject: [Rd] klin: a package for solving linear equations with Kronecker
	structure
Message-ID: <20070108174902.GA483@pu100877.student.princeton.edu>

Hi,

I decided to package some functions I wrote.  klin is a package that
implements efficient ways to evaluate and solve equations of the form
Ax=b, where A is a kronecker product of matrices.  Functions to solve
least squares problems of this type are also included.

The exact algorithm used was published by Buis and Dyksen in 1996, but
the general principles have been known for a while (de Boor 1978,
Pereyra and Scherer 1978).  It is usually 5-1000x times faster
(depending on the size of your matrices) than calculating the
Kronecker product.

The latest version can be found here:

http://www.princeton.edu/~tpapp/software.html

I am planning to submit it to CRAN after a brief period of time.  In
the meantime, I would be interested in suggestions, comments, bugs --
this is my first R package so I tried to do things right and would be
happy to learn about all mistakes.

I am using these algorithms for working with tensor B-splines.  I am
planning to package the code for the latter soon.

Best,

Tamas


From vdergachev at rcgardis.com  Mon Jan  8 19:00:23 2007
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Mon, 8 Jan 2007 13:00:23 -0500
Subject: [Rd]
	=?iso-8859-1?q?How_to_execute_R_scripts_simultaneously_from_?=
	=?iso-8859-1?q?multiple=09threads?=
In-Reply-To: <45A22CB4.1090305@cimr.cam.ac.uk>
References: <459B6DBA.3050207@erik.prutser.cx>
	<459E289C.1080201@erik.prutser.cx>
	<45A22CB4.1090305@cimr.cam.ac.uk>
Message-ID: <200701081300.23284.vdergachev@rcgardis.com>

On Monday 08 January 2007 6:36 am, Hin-Tak Leung wrote:
> Erik van Zijst wrote:
> > Vladimir Dergachev wrote:
>
> <snipped>
>
> >> At some point (years ago) there was even an argument on some mailiing
> >> list (xfree86-devel ?) about whether Xserver should support shared
> >> memory as unix socket was "fast enough" - with the other side arguing
> >> that when you pass megabyte images around (as in DVD playback) there is
> >> non-negligible overhead.
> >
> > We're currently doing performance tests with the RServe-approach where
> > we measure the actual evaluation time of a function. I'm interested in
> > the evaluation-time versus overhead ratio. Loopback TCP might work as
> > long as this ratio is sufficiently high.
>
> Slightly off-topic, Vladimir sounded as if there was any argument of
> supporting shared memory in X... AFAIK, the shared memory extension
> *is* part of Xorg!
>
> $ grep 'MIT-SHM' /var/log/Xorg.0.log
> (II) Initializing built-in extension MIT-SHM

It is - and it was when the discussion happened (several years ago). 
The issue was whether to introduce shared memory support for Xv extension.
(and yes, it was introduced..)

                   best

                       Vladimir Dergachev

>
> - the shared memory extension is also crucial for
> client-side font-rendering (xft/freetype) a.k.a. all those
> nicely anti-aliased texts in firefox and openoffice, besides
> DVD playbacks.
>
> HTL


From sfalcon at fhcrc.org  Mon Jan  8 19:04:27 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Mon, 08 Jan 2007 10:04:27 -0800
Subject: [Rd] undocumented name mangling during unlist?
Message-ID: <m27ivxe6ok.fsf@fhcrc.org>

The documentation for unlist says:

     By default, 'unlist' tries to retain the naming information
     present in 'x'.  If 'use.names = FALSE' all naming information is
     dropped.

Hence, I find it odd that I see the following:

    > b <- list("highway1"=1:5)
    > unlist(b)
    highway11 highway12 highway13 highway14 highway15 
            1         2         3         4         5 

I suspect this is essential behavior for something or other, but it
seems that this approach is inefficient for large lists and in many
contexts does not preserve names, but invents new ones.

/me ducks

+ seth


From chris at cepheus.net  Mon Jan  8 19:50:47 2007
From: chris at cepheus.net (Chris Eisley)
Date: Mon, 08 Jan 2007 10:50:47 -0800
Subject: [Rd] Scoping issues
In-Reply-To: <Pine.LNX.4.64.0701071435220.12570@gannet.stats.ox.ac.uk>
References: <20070107135726.QSPQ11361.tomts43-srv.bellnexxia.net@JohnDesktop8300>
	<Pine.LNX.4.64.0701071435220.12570@gannet.stats.ox.ac.uk>
Message-ID: <45A29287.20600@cepheus.net>

Hello Prof Ripley,

Prof Brian Ripley wrote:
> I don't undersand what the issues are, but he actually said
> 
>>> These files make up a package,
> 
> and all the source files on an R packages are concatenated and loaded 
> into a single environment.  So my understanding of the answer to
> 
>>> I assume there's a good way to deal with this kind of issue.
> 
> is 'yes, build an R package'.
> 

My code is built as a package, but having a package doesn't seem to 
prevent the kind of problem I'm running into.  My code is currently 
structured as such:

ui.main <- function() {
	ui.func1 <- function {
		...
		do.something(ui.widget1)
		do.something(ui.widget2)
		do.something(ui.widget3)
		...
	}
	ui.widget1 <- tkframe(...)
	ui.widget2 <- tkframe(...)
	ui.widget3 <- tkframe(...)
	...
	ui.func1()
}

I'd like to move the definition of ui.func1 and those of other functions 
like it to seperate source files, since my main "ui" source file is 
getting quite large.  The variables need to be available to several 
other functions that I'd like to move to separate source files.  Since 
the tkframe variables can't be created in the environment of ui.main, 
I'm not sure how to get around this problem without a lot of argument 
passing.


> On Sun, 7 Jan 2007, John Fox wrote:
> 

Hello John,

>> Dear Chris,
>>
>> If I correctly understand what you want to do, the Rcmdr package uses the
>> following functions (slightly modified from original version 
>> contributed by
>> Philippe Grosjean) to solve a similar problem:
>>
>> RcmdrEnv <- function() {
>>    pos <-  match("RcmdrEnv", search())
>>    if (is.na(pos)) { # Must create it
>>        RcmdrEnv <- list()
>>        attach(RcmdrEnv, pos = length(search()) - 1)
>>        rm(RcmdrEnv)
>>        pos <- match("RcmdrEnv", search())
>>        }
>>    return(pos.to.env(pos))
>>    }
>>
>> putRcmdr <- function(x, value)
>>    assign(x, value, envir = RcmdrEnv())
>>
>> getRcmdr <- function(x, mode="any")
>>    get(x, envir = RcmdrEnv(), mode = mode, inherits = FALSE)
>>

I think I understand what's going on here, but it seems like a rather 
arcane solution to such a basic problem.  It seems as if I'm trying to 
code in a way that's incompatible with R's scoping.

-Chris


From ggrothendieck at gmail.com  Mon Jan  8 20:15:29 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 8 Jan 2007 14:15:29 -0500
Subject: [Rd] Scoping issues
In-Reply-To: <45A29287.20600@cepheus.net>
References: <20070107135726.QSPQ11361.tomts43-srv.bellnexxia.net@JohnDesktop8300>
	<Pine.LNX.4.64.0701071435220.12570@gannet.stats.ox.ac.uk>
	<45A29287.20600@cepheus.net>
Message-ID: <971536df0701081115k37177a37t7d8e05e1a0034b7a@mail.gmail.com>

On 1/8/07, Chris Eisley <chris at cepheus.net> wrote:
> Hello Prof Ripley,
>
> Prof Brian Ripley wrote:
> > I don't undersand what the issues are, but he actually said
> >
> >>> These files make up a package,
> >
> > and all the source files on an R packages are concatenated and loaded
> > into a single environment.  So my understanding of the answer to
> >
> >>> I assume there's a good way to deal with this kind of issue.
> >
> > is 'yes, build an R package'.
> >
>
> My code is built as a package, but having a package doesn't seem to
> prevent the kind of problem I'm running into.  My code is currently
> structured as such:
>
> ui.main <- function() {
>        ui.func1 <- function {
>                ...
>                do.something(ui.widget1)
>                do.something(ui.widget2)
>                do.something(ui.widget3)
>                ...
>        }
>        ui.widget1 <- tkframe(...)
>        ui.widget2 <- tkframe(...)
>        ui.widget3 <- tkframe(...)
>        ...
>        ui.func1()
> }

Assuming ui.main can find ui.func1 we can create a local
copy of ui.func1 that is the same as the external ui.func
but has its environment set to the environment within ui.main
so that it can find ui.widget1, ui.widget2 and ui.widget3:

ui.main <- function() {
       environment(ui.func1) <- environment()
       ui.widget1 <- tkframe(...)
       ui.widget2 <- tkframe(...)
       ui.widget3 <- tkframe(...)
       ...
       ui.func1()
}

>
> I'd like to move the definition of ui.func1 and those of other functions
> like it to seperate source files, since my main "ui" source file is
> getting quite large.  The variables need to be available to several
> other functions that I'd like to move to separate source files.  Since
> the tkframe variables can't be created in the environment of ui.main,
> I'm not sure how to get around this problem without a lot of argument
> passing.
>
>
> > On Sun, 7 Jan 2007, John Fox wrote:
> >
>
> Hello John,
>
> >> Dear Chris,
> >>
> >> If I correctly understand what you want to do, the Rcmdr package uses the
> >> following functions (slightly modified from original version
> >> contributed by
> >> Philippe Grosjean) to solve a similar problem:
> >>
> >> RcmdrEnv <- function() {
> >>    pos <-  match("RcmdrEnv", search())
> >>    if (is.na(pos)) { # Must create it
> >>        RcmdrEnv <- list()
> >>        attach(RcmdrEnv, pos = length(search()) - 1)
> >>        rm(RcmdrEnv)
> >>        pos <- match("RcmdrEnv", search())
> >>        }
> >>    return(pos.to.env(pos))
> >>    }
> >>
> >> putRcmdr <- function(x, value)
> >>    assign(x, value, envir = RcmdrEnv())
> >>
> >> getRcmdr <- function(x, mode="any")
> >>    get(x, envir = RcmdrEnv(), mode = mode, inherits = FALSE)
> >>
>
> I think I understand what's going on here, but it seems like a rather
> arcane solution to such a basic problem.  It seems as if I'm trying to
> code in a way that's incompatible with R's scoping.
>
> -Chris


From simon.urbanek at r-project.org  Mon Jan  8 21:07:24 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 8 Jan 2007 15:07:24 -0500
Subject: [Rd] can't compile on OSX: unsetenv header issues
In-Reply-To: <Pine.LNX.4.64.0701081740560.319@gannet.stats.ox.ac.uk>
References: <m23b6lfr95.fsf@fhcrc.org>
	<Pine.LNX.4.64.0701081740560.319@gannet.stats.ox.ac.uk>
Message-ID: <6B1C87E2-8971-4D40-A143-089C7E030758@r-project.org>


On Jan 8, 2007, at 12:47 PM, Prof Brian Ripley wrote:

> On Mon, 8 Jan 2007, Seth Falcon wrote:
>
>> Hi,
>>
>> A recent change has R failing to compile (for me) on ppc OSX  
>> 10.4.8 like this:
>>
>> ../../../../R-devel/src/main/datetime.c: In function `reset_tz':
>> ../../../../R-devel/src/main/datetime.c:511: error: void value not  
>> ignored as it ought to be
>>
>> I suspect there is some sort of configure magic that needs to happen
>> to get the POSIX compatible unsetenv on OSX.  Here's what I think is
>> the relevant bit from stdlib.h, but I'm hoping someone with more OSX
>> experience will recognize what needs to be done.
>
> So do I, but does defining __DARWIN_UNIX03 at the head of that file  
> (and sysutils.c) solve this?
>

I wouldn't set that one - it is used internally only. Instead, we  
should consider using _POSIX_C_SOURCE if we really want true POSIX  
compatibility. However, that is bound to affect all POSIX platforms,  
so I'm wondering if we are ready for that.
For the record, defining any of _APPLE_C_SOURCE, _XOPEN_SOURCE or  
_POSIX_C_SOURCE has the side-effect of enabling __DARWIN_UNIX03 on OS  
X, so _APPLE_C_SOURCE is an alternative if we want to restrict this  
to OS X only (it has the same effect, though).

Cheers,
Simon


> OSes who adopt pretty standard function names with non-standard
> implementations used to be commonplace, but I had rather hoped we  
> had seen
> the last of this after Single Unix Standard, POSIX ....
>
>
>> #if __DARWIN_UNIX03
>> int      unsetenv(const char *) __DARWIN_ALIAS(unsetenv);
>> #else /* !__DARWIN_UNIX03 */
>> void     unsetenv(const char *);
>> #endif /* __DARWIN_UNIX03 */
>>
>>
>> + seth
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From simon.urbanek at r-project.org  Mon Jan  8 23:58:11 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 8 Jan 2007 17:58:11 -0500
Subject: [Rd] can't compile on OSX: unsetenv header issues
In-Reply-To: <m23b6lfr95.fsf@fhcrc.org>
References: <m23b6lfr95.fsf@fhcrc.org>
Message-ID: <0DF677E7-1F8D-40D4-A498-C8A0832C39E9@r-project.org>

Thanks, Seth,

it's now fixed in R-devel.

Cheers,
Simon


On Jan 8, 2007, at 10:54 AM, Seth Falcon wrote:

> Hi,
>
> A recent change has R failing to compile (for me) on ppc OSX 10.4.8  
> like this:
>
> ../../../../R-devel/src/main/datetime.c: In function `reset_tz':
> ../../../../R-devel/src/main/datetime.c:511: error: void value not  
> ignored as it ought to be
>
> I suspect there is some sort of configure magic that needs to happen
> to get the POSIX compatible unsetenv on OSX.  Here's what I think is
> the relevant bit from stdlib.h, but I'm hoping someone with more OSX
> experience will recognize what needs to be done.
>
> #if __DARWIN_UNIX03
> int      unsetenv(const char *) __DARWIN_ALIAS(unsetenv);
> #else /* !__DARWIN_UNIX03 */
> void     unsetenv(const char *);
> #endif /* __DARWIN_UNIX03 */
>
>
> + seth
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ripley at stats.ox.ac.uk  Tue Jan  9 17:30:22 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 9 Jan 2007 16:30:22 +0000 (GMT)
Subject: [Rd] undocumented name mangling during unlist?
In-Reply-To: <m27ivxe6ok.fsf@fhcrc.org>
References: <m27ivxe6ok.fsf@fhcrc.org>
Message-ID: <Pine.LNX.4.64.0701091623480.24672@gannet.stats.ox.ac.uk>

On Mon, 8 Jan 2007, Seth Falcon wrote:

> The documentation for unlist says:
>
>     By default, 'unlist' tries to retain the naming information
>     present in 'x'.  If 'use.names = FALSE' all naming information is
>     dropped.
>
> Hence, I find it odd that I see the following:
>
>    > b <- list("highway1"=1:5)
>    > unlist(b)
>    highway11 highway12 highway13 highway14 highway15
>            1         2         3         4         5
>
> I suspect this is essential behavior for something or other, but it
> seems that this approach is inefficient for large lists and in many
> contexts does not preserve names, but invents new ones.

There is the information that the entries came from element "highway1" 
which needs to be preserved.  c() and unlist() share code, and both try to 
create different names for elements of different origin.

Why is this 'inefficient' (names are optional) and what do you propose 
that meets the conditions?

It is probably not coincidental that S3 did this the same way.


>
> /me ducks
>
> + seth
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From sfalcon at fhcrc.org  Tue Jan  9 18:43:51 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Tue, 09 Jan 2007 09:43:51 -0800
Subject: [Rd] undocumented name mangling during unlist?
In-Reply-To: <Pine.LNX.4.64.0701091623480.24672@gannet.stats.ox.ac.uk> (Brian
	Ripley's message of "Tue, 9 Jan 2007 16:30:22 +0000 (GMT)")
References: <m27ivxe6ok.fsf@fhcrc.org>
	<Pine.LNX.4.64.0701091623480.24672@gannet.stats.ox.ac.uk>
Message-ID: <m2r6u42izs.fsf@fhcrc.org>

Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:

> On Mon, 8 Jan 2007, Seth Falcon wrote:
>
>> The documentation for unlist says:
>>
>>     By default, 'unlist' tries to retain the naming information
>>     present in 'x'.  If 'use.names = FALSE' all naming information is
>>     dropped.
>>
>> Hence, I find it odd that I see the following:
>>
>>    > b <- list("highway1"=1:5)
>>    > unlist(b)
>>    highway11 highway12 highway13 highway14 highway15
>>            1         2         3         4         5
>>
>> I suspect this is essential behavior for something or other, but it
>> seems that this approach is inefficient for large lists and in many
>> contexts does not preserve names, but invents new ones.
>
> There is the information that the entries came from element "highway1"
> which needs to be preserved.  

In my view, preserving is not the same as creating a new name where
the original is a substring.

> c() and unlist() share code, and both try to create different names
> for elements of different origin.

I guess I don't understand.  In my example, aren't the elements all of
the same origin (from the highway1 entry of the list)?  

Granting a different interpretation of origin, it seems the attempt is
not very complete:

    v2 <- list(a=rep(1, 2), b=rep(2, 2), a=rep(3, 2))
    unlist(v2)  ## names are _not_ unique
    a1 a2 b1 b2 a1 a2 
     1  1  2  2  3  3 

> Why is this 'inefficient' (names are optional) and what do you
> propose that meets the conditions?

Could the origin name simply be repeated?

  unlist(b)
  highway1 highway1 highway1 highway1 highway1
         1        2        3        4        5

Efficiency could be gained by reusing the CHARSXP to name all elements
instead of having to created new strings for each name.

+ seth


From ripley at stats.ox.ac.uk  Wed Jan 10 14:06:30 2007
From: ripley at stats.ox.ac.uk (Brian Ripley)
Date: Wed, 10 Jan 2007 13:06:30 +0000 (GMT)
Subject: [Rd] Trailing message on R CMD BATCH
Message-ID: <Pine.LNX.4.64.0701101300030.11387@auk.stats>

Unix versions of R CMD BATCH have reported proc.time() unless the script 
ends in q().  E.g. if the input is 'search()' the output is

> invisible(options(echo = TRUE))
> search()
[1] ".GlobalEnv"        "package:stats"     "package:graphics"
[4] "package:grDevices" "package:utils"     "package:datasets"
[7] "package:methods"   "Autoloads"         "package:base"
>
> proc.time()
[1] 1.053 0.067 1.109 0.000 0.000
>

This was undocumented, and not shared by the Windows version.

Is it useful?
Do people want it retained?

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pburns at pburns.seanet.com  Wed Jan 10 16:36:26 2007
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Wed, 10 Jan 2007 15:36:26 +0000
Subject: [Rd] Trailing message on R CMD BATCH
In-Reply-To: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
References: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
Message-ID: <45A507FA.2070501@pburns.seanet.com>

I rather like it.

Patrick Burns
patrick at burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

Brian Ripley wrote:

>Unix versions of R CMD BATCH have reported proc.time() unless the script 
>ends in q().  E.g. if the input is 'search()' the output is
>
>  
>
>>invisible(options(echo = TRUE))
>>search()
>>    
>>
>[1] ".GlobalEnv"        "package:stats"     "package:graphics"
>[4] "package:grDevices" "package:utils"     "package:datasets"
>[7] "package:methods"   "Autoloads"         "package:base"
>  
>
>>proc.time()
>>    
>>
>[1] 1.053 0.067 1.109 0.000 0.000
>  
>
>
>This was undocumented, and not shared by the Windows version.
>
>Is it useful?
>Do people want it retained?
>
>  
>


From rdpeng at gmail.com  Wed Jan 10 16:41:38 2007
From: rdpeng at gmail.com (Roger D. Peng)
Date: Wed, 10 Jan 2007 10:41:38 -0500
Subject: [Rd] Trailing message on R CMD BATCH
In-Reply-To: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
References: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
Message-ID: <45A50932.90408@gmail.com>

I do find the timing useful and would prefer it to be retained unless it causes 
a problem elsewhere.

-roger

Brian Ripley wrote:
> Unix versions of R CMD BATCH have reported proc.time() unless the script 
> ends in q().  E.g. if the input is 'search()' the output is
> 
>> invisible(options(echo = TRUE))
>> search()
> [1] ".GlobalEnv"        "package:stats"     "package:graphics"
> [4] "package:grDevices" "package:utils"     "package:datasets"
> [7] "package:methods"   "Autoloads"         "package:base"
>> proc.time()
> [1] 1.053 0.067 1.109 0.000 0.000
> 
> This was undocumented, and not shared by the Windows version.
> 
> Is it useful?
> Do people want it retained?
> 

-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From khansen at stat.Berkeley.EDU  Wed Jan 10 18:12:03 2007
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Wed, 10 Jan 2007 09:12:03 -0800
Subject: [Rd] Trailing message on R CMD BATCH
In-Reply-To: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
References: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
Message-ID: <B4D3A62B-7D08-4DE4-9B20-C61A8EB17AE1@stat.berkeley.edu>

I use it a lot.

Kasper

On Jan 10, 2007, at 5:06 AM, Brian Ripley wrote:

> Unix versions of R CMD BATCH have reported proc.time() unless the  
> script
> ends in q().  E.g. if the input is 'search()' the output is
>
>> invisible(options(echo = TRUE))
>> search()
> [1] ".GlobalEnv"        "package:stats"     "package:graphics"
> [4] "package:grDevices" "package:utils"     "package:datasets"
> [7] "package:methods"   "Autoloads"         "package:base"
>>
>> proc.time()
> [1] 1.053 0.067 1.109 0.000 0.000
>>
>
> This was undocumented, and not shared by the Windows version.
>
> Is it useful?
> Do people want it retained?
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From bcarvalh at jhsph.edu  Wed Jan 10 18:27:34 2007
From: bcarvalh at jhsph.edu (Benilton Carvalho)
Date: Wed, 10 Jan 2007 12:27:34 -0500 (EST)
Subject: [Rd] Trailing message on R CMD BATCH
In-Reply-To: <45A50932.90408@gmail.com>
References: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
	<45A50932.90408@gmail.com>
Message-ID: <Pine.LNX.4.61.0701101225480.5019@enigma.local>

I do find that info to be useful and would very much appreciate if it is 
kept.

b

Brian Ripley wrote:
> Unix versions of R CMD BATCH have reported proc.time() unless the script
> ends in q().  E.g. if the input is 'search()' the output is
>
>> invisible(options(echo = TRUE))
>> search()
> [1] ".GlobalEnv"        "package:stats"     "package:graphics"
> [4] "package:grDevices" "package:utils"     "package:datasets"
> [7] "package:methods"   "Autoloads"         "package:base"
>> proc.time()
> [1] 1.053 0.067 1.109 0.000 0.000
>
> This was undocumented, and not shared by the Windows version.
>
> Is it useful?
> Do people want it retained?
>


From hin-tak.leung at cimr.cam.ac.uk  Wed Jan 10 20:29:22 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Wed, 10 Jan 2007 19:29:22 +0000
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1 windows
	binaries?
Message-ID: <45A53E92.6070104@cimr.cam.ac.uk>

Does anybody (most probably the core team) know if there is
any difference in how the official 2.4.0 and 2.4.1 binaries are
built?

Problem is, 2.4.0 loads with the wine (I tried a few recent
versions, and also used 2.3.x under wine from time to time),
but 2.4.1 won't.

Thanks.

Hin-Tak Leung


From murdoch at stats.uwo.ca  Wed Jan 10 20:59:45 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 10 Jan 2007 14:59:45 -0500
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A53E92.6070104@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk>
Message-ID: <45A545B1.6070508@stats.uwo.ca>

On 1/10/2007 2:29 PM, Hin-Tak Leung wrote:
> Does anybody (most probably the core team) know if there is
> any difference in how the official 2.4.0 and 2.4.1 binaries are
> built?
> 
> Problem is, 2.4.0 loads with the wine (I tried a few recent
> versions, and also used 2.3.x under wine from time to time),
> but 2.4.1 won't.

Yes, there were changes to the MinGW run-time library between those two 
releases.  See http://www.murdoch-sutherland.com/Rtools/.

If you can be more specific about the problem, it's possible the Wine or 
MinGW people could fix it.

Duncan Murdoch


From gregor.gorjanc at bfro.uni-lj.si  Wed Jan 10 21:22:32 2007
From: gregor.gorjanc at bfro.uni-lj.si (Gregor Gorjanc)
Date: Wed, 10 Jan 2007 20:22:32 +0000 (UTC)
Subject: [Rd] Trailing message on R CMD BATCH
References: <Pine.LNX.4.64.0701101300030.11387@auk.stats>
Message-ID: <loom.20070110T212054-330@post.gmane.org>

Brian Ripley <ripley <at> stats.ox.ac.uk> writes:
> Unix versions of R CMD BATCH have reported proc.time() unless the script 
> ends in q().  E.g. if the input is 'search()' the output is
> 
> > invisible(options(echo = TRUE))
> > search()
> [1] ".GlobalEnv"        "package:stats"     "package:graphics"
> [4] "package:grDevices" "package:utils"     "package:datasets"
> [7] "package:methods"   "Autoloads"         "package:base"
> >
> > proc.time()
> [1] 1.053 0.067 1.109 0.000 0.000
> >

I did not notice that this is only for unix version of R CMD BATCH. Since 
R CMD BATCH is prefered way to run things in background and usually for longer
time it is good to have this info. I would suggest to add this also in Windows
version.

Gregor


From apjaworski at mmm.com  Wed Jan 10 22:28:17 2007
From: apjaworski at mmm.com (apjaworski at mmm.com)
Date: Wed, 10 Jan 2007 15:28:17 -0600
Subject: [Rd] Compiling R-devel under Windows
Message-ID: <OFC6D0207E.81FDEB25-ON8625725F.006FF9FB-8625725F.0075F246@mmm.com>

Hello there,

I have a habit of compiling R-patched and R-devel every few days.
Recently, I noticed the following problem:

I downloaded both versions with Revision: 40421, Last Changed Date:
2007-01-09.  R-patched compiles with no problem.  R-devel compiles fine but
when it starts to make PDF documentation it generates the following (tail
of the "make distribution" output):

! pdfTeX warning (dest): name{Rfn.survival} has been referenced but does
not ex
ist, replaced by a fixed one

<C:/local/MiKTeX/fonts/type1/bluesky/cm/cmti10.pfb>{8r.enc}<C:/local/MiKTeX/fon
ts/type1/urw/times/utmbi8a.pfb><C:/local/MiKTeX/fonts/type1/bluesky/ams/cmbsy7.
pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmbx10.pfb><C:/local/MiKTeX/fonts/t
ype1/bluesky/cm/cmmib10.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmr5.pfb><C
:/local/MiKTeX/fonts/type1/urw/courier/ucrro8a.pfb><C:/local/MiKTeX/fonts/type1
/bluesky/cm/cmmi5.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmr7.pfb><C:/loca
l/MiKTeX/fonts/type1/bluesky/cm/cmex10.pfb><C:/local/MiKTeX/fonts/type1/bluesky
/cm/cmmi7.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmr10.pfb><C:/local/MiKTe
X/fonts/type1/bluesky/cm/cmsy7.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmmi
10.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmsy10.pfb><C:/local/MiKTeX/font
s/type1/urw/times/utmri8a.pfb><C:/local/MiKTeX/fonts/type1/urw/courier/ucrr8a.p
fb><C:/local/MiKTeX/fonts/type1/urw/courier/ucrb8a.pfb><C:/local/MiKTeX/fonts/t
ype1/urw/times/utmr8a.pfb><C:/local/MiKTeX/fonts/type1/urw/helvetic/uhvr8a.pfb>
<C:/local/MiKTeX/fonts/type1/urw/times/utmr8a.pfb><C:/local/MiKTeX/fonts/type1/
urw/times/utmb8a.pfb>
Output written on refman.pdf (1447 pages, 6487470 bytes).
Transcript written on refman.log.
make[2]: *** [refman.pdf] Error 1
make[1]: *** [manuals] Error 2
make[1]: Leaving directory `/home/andyj/R-devel/src/gnuwin32'
make: *** [distribution] Error 2

It looks like the first version of refman.pdf gets generated fine and
something happens when it needs to run makeindex.  I tried to look at the
Makefile.win in doc/manuals but I cannot see anything obvious there.  In
any case, the makefiles are quite elabortae and interlinekd, so I probably
would not know how to fix them.

I am on Win2000.  I compile R using the Cygwin environment, but I have
MinGW installed and its executables are first on the search path.  I am
using MiKTeX and it is up-to-date.

Thanks in advance,

Andy

PS.  I seem to remember that this happened already a few versions ago.


__________________________________
Andy Jaworski
518-1-01
Process Laboratory
3M Corporate Research Laboratory
-----
E-mail: apjaworski at mmm.com
Tel:  (651) 733-6092
Fax:  (651) 736-3122


From ripley at stats.ox.ac.uk  Wed Jan 10 22:59:37 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 10 Jan 2007 21:59:37 +0000 (GMT)
Subject: [Rd] Compiling R-devel under Windows
In-Reply-To: <OFC6D0207E.81FDEB25-ON8625725F.006FF9FB-8625725F.0075F246@mmm.com>
References: <OFC6D0207E.81FDEB25-ON8625725F.006FF9FB-8625725F.0075F246@mmm.com>
Message-ID: <Pine.LNX.4.64.0701102149170.16713@gannet.stats.ox.ac.uk>

You have an old snapshot.  R-devel r40430 seems fine.

You could have looked at the refman.log for informative output (no need to 
speculate: it was a help file that was provisional at the time).  Please 
don't expect all aspects of R-devel to work on all platforms at all times: 
It is

    R version 2.5.0 Under development (unstable)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^

On Wed, 10 Jan 2007, apjaworski at mmm.com wrote:

> Hello there,
>
> I have a habit of compiling R-patched and R-devel every few days.
> Recently, I noticed the following problem:
>
> I downloaded both versions with Revision: 40421, Last Changed Date:
> 2007-01-09.  R-patched compiles with no problem.  R-devel compiles fine but
> when it starts to make PDF documentation it generates the following (tail
> of the "make distribution" output):
>
> ! pdfTeX warning (dest): name{Rfn.survival} has been referenced but does
> not ex
> ist, replaced by a fixed one
>
> <C:/local/MiKTeX/fonts/type1/bluesky/cm/cmti10.pfb>{8r.enc}<C:/local/MiKTeX/fon
> ts/type1/urw/times/utmbi8a.pfb><C:/local/MiKTeX/fonts/type1/bluesky/ams/cmbsy7.
> pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmbx10.pfb><C:/local/MiKTeX/fonts/t
> ype1/bluesky/cm/cmmib10.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmr5.pfb><C
> :/local/MiKTeX/fonts/type1/urw/courier/ucrro8a.pfb><C:/local/MiKTeX/fonts/type1
> /bluesky/cm/cmmi5.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmr7.pfb><C:/loca
> l/MiKTeX/fonts/type1/bluesky/cm/cmex10.pfb><C:/local/MiKTeX/fonts/type1/bluesky
> /cm/cmmi7.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmr10.pfb><C:/local/MiKTe
> X/fonts/type1/bluesky/cm/cmsy7.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmmi
> 10.pfb><C:/local/MiKTeX/fonts/type1/bluesky/cm/cmsy10.pfb><C:/local/MiKTeX/font
> s/type1/urw/times/utmri8a.pfb><C:/local/MiKTeX/fonts/type1/urw/courier/ucrr8a.p
> fb><C:/local/MiKTeX/fonts/type1/urw/courier/ucrb8a.pfb><C:/local/MiKTeX/fonts/t
> ype1/urw/times/utmr8a.pfb><C:/local/MiKTeX/fonts/type1/urw/helvetic/uhvr8a.pfb>
> <C:/local/MiKTeX/fonts/type1/urw/times/utmr8a.pfb><C:/local/MiKTeX/fonts/type1/
> urw/times/utmb8a.pfb>
> Output written on refman.pdf (1447 pages, 6487470 bytes).
> Transcript written on refman.log.
> make[2]: *** [refman.pdf] Error 1
> make[1]: *** [manuals] Error 2
> make[1]: Leaving directory `/home/andyj/R-devel/src/gnuwin32'
> make: *** [distribution] Error 2
>
> It looks like the first version of refman.pdf gets generated fine and
> something happens when it needs to run makeindex.  I tried to look at the
> Makefile.win in doc/manuals but I cannot see anything obvious there.  In
> any case, the makefiles are quite elabortae and interlinekd, so I probably
> would not know how to fix them.
>
> I am on Win2000.  I compile R using the Cygwin environment, but I have
> MinGW installed and its executables are first on the search path.  I am
> using MiKTeX and it is up-to-date.
>
> Thanks in advance,
>
> Andy
>
> PS.  I seem to remember that this happened already a few versions ago.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ellis at stat.harvard.edu  Thu Jan 11 06:25:45 2007
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Wed, 10 Jan 2007 21:25:45 -0800
Subject: [Rd] Perhaps a stupid question about clipboards....
Message-ID: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>

I have a stupid question. Why is the clipboard accessed through file()
and not, say, a clipboard() connection? Is there a good reason for
this or is it simply historical?

-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From mniu at optonline.net  Thu Jan 11 07:06:42 2007
From: mniu at optonline.net (mniu at optonline.net)
Date: Thu, 11 Jan 2007 07:06:42 +0100 (CET)
Subject: [Rd] Installation on CYGWIN Failed (PR#9442)
Message-ID: <20070111060642.F0C3519BA1@slim.kubism.ku.dk>

This is a multi-part message in MIME format.

--Boundary_(ID_0J8TMtVXSg+LJn2Si9guUw)
Content-type: text/plain; charset=us-ascii
Content-transfer-encoding: 7BIT

Hi,

 

I tried to install R-2.4.1 on cygwin system. "./configure" succeeded, but
make failed. Below, I provide the output from the process: error message,
and info from configure output, in that order. I appreciate that someone can
guide me (technically in-sophisticated) through this process.

 

Again, thanks for your help.

 

Michael Niu

 

(1). Output from make

 

make[3]: Entering directory `/R/R-2.4.1/src/extra/blas'

make[4]: Entering directory `/R/R-2.4.1/src/extra/blas'

g77 -D__NO_MATH_INLINES -fpic  -g -O2 -c blas.f -o blas.o

blas.f:0: warning: -fpic ignored for target (all code is position
independent)

g77 -D__NO_MATH_INLINES -fpic  -g -O2 -c cmplxblas.f -o cmplxblas.o

cmplxblas.f:0: warning: -fpic ignored for target (all code is position
independent)

gcc -std=gnu99 -shared -L/usr/local/lib -o libRblas.so blas.o   cmplxblas.o

blas.o: In function `dgbmv_':

/R/R-2.4.1/src/extra/blas/blas.f:357: undefined reference to `_xerbla_'

blas.o: In function `dgemm_':

/R/R-2.4.1/src/extra/blas/blas.f:682: undefined reference to `_xerbla_'

blas.o: In function `dgemv_':

/R/R-2.4.1/src/extra/blas/blas.f:940: undefined reference to `_xerbla_'

blas.o: In function `dger_':

/R/R-2.4.1/src/extra/blas/blas.f:1171: undefined reference to `_xerbla_'

blas.o: In function `dsbmv_':

/R/R-2.4.1/src/extra/blas/blas.f:1800: undefined reference to `_xerbla_'

blas.o:/R/R-2.4.1/src/extra/blas/blas.f:2183: more undefined references to
`_xerbla_' follow

cmplxblas.o: In function `zrotg_':

/R/R-2.4.1/src/extra/blas/cmplxblas.f:5579: undefined reference to `_z_abs'

/R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined reference to `_z_abs'

/R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined reference to `_z_abs'

/R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined reference to `_z_abs'

/R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined reference to `_z_abs'

cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:5588: more undefined
references to `_z_abs' follow

cmplxblas.o: In function `zsymm_':

/R/R-2.4.1/src/extra/blas/cmplxblas.f:5778: undefined reference to
`_xerbla_'

cmplxblas.o: In function `zsyr2k_':

/R/R-2.4.1/src/extra/blas/cmplxblas.f:6071: undefined reference to
`_xerbla_'

cmplxblas.o: In function `zsyrk_':

/R/R-2.4.1/src/extra/blas/cmplxblas.f:6376: undefined reference to
`_xerbla_'

cmplxblas.o: In function `ztbmv_':

/R/R-2.4.1/src/extra/blas/cmplxblas.f:6684: undefined reference to
`_xerbla_'

cmplxblas.o: In function `ztbsv_':

/R/R-2.4.1/src/extra/blas/cmplxblas.f:7065: undefined reference to
`_xerbla_'

cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:7398: more undefined
references to `_xerbla_' fol

ow

collect2: ld returned 1 exit status

make[4]: *** [libRblas.so] Error 1

make[4]: Leaving directory `/R/R-2.4.1/src/extra/blas'

make[3]: *** [R] Error 2

make[3]: Leaving directory `/R/R-2.4.1/src/extra/blas'

make[2]: *** [R] Error 1

make[2]: Leaving directory `/R/R-2.4.1/src/extra'

make[1]: *** [R] Error 1

make[1]: Leaving directory `/R/R-2.4.1/src'

make: *** [R] Error 1

 

(2). Output from configure

 

uname -m = i686

uname -r = 1.5.19(0.150/4/2) 

uname -s = CYGWIN_NT-5.1

uname -v = 2006-01-20 13:28

 

/usr/bin/uname -p = unknown

/bin/uname -X     = unknown

 

/bin/arch              = unknown

/usr/bin/arch -k       = unknown

/usr/convex/getsysinfo = unknown

hostinfo               = unknown

/bin/machine           = unknown

/usr/bin/oslevel       = unknown

/bin/universe          = unknown

 

PATH: .

PATH: /usr/bin

PATH: /usr/lib/lapack/

PATH: /usr/X11R6

PATH: /home/zniu/bin

PATH: ${PATH}

PATH:  /.

PATH:  ${HOME}/bin

PATH:  x

PATH: /cygwin/bin

 

.....

 

configure: exit 0

 

R is now configured for i686-pc-cygwin

 

  Source directory:          .

  Installation directory:    /usr/local

 

  C compiler:                gcc -std=gnu99 -D__NO_MATH_INLINES -g -O2

  Fortran 77 compiler:       g77  -g -O2

 

  C++ compiler:              g++  -g -O2

  Fortran 90/95 compiler:    g77 -g -O2

 

  Interfaces supported:      X11

  External libraries:        readline

  Additional capabilities:   PNG, JPEG, iconv, MBCS, NLS

  Options enabled:           shared BLAS, R profiling

 

  Recommended packages:      yes

 

 


--Boundary_(ID_0J8TMtVXSg+LJn2Si9guUw)
Content-type: text/html; charset=us-ascii
Content-transfer-encoding: 7BIT

<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=us-ascii">
<meta name=Generator content="Microsoft Word 11 (filtered medium)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:Arial;
	color:windowtext;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=Section1>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>Hi,<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>I tried to install R-2.4.1 on cygwin system. &#8220;./configure&#8221;
succeeded, but make failed. Below, I provide the output from the process: error
message, and info from configure output, in that order. I appreciate that someone
can guide me (technically in-sophisticated) through this process.<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>Again, thanks for your help.<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>Michael Niu<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>(1). <b><u><span style='font-weight:bold'>Output from make</span></u></b><o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[3]: Entering directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[4]: Entering directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>g77 -D__NO_MATH_INLINES -fpic&nbsp; -g -O2 -c blas.f -o
blas.o<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.f:0: warning: -fpic ignored for target (all code is
position independent)<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>g77 -D__NO_MATH_INLINES -fpic&nbsp; -g -O2 -c cmplxblas.f -o
cmplxblas.o<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.f:0: warning: -fpic ignored for target (all code
is position independent)<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>gcc -std=gnu99 -shared -L/usr/local/lib -o libRblas.so
blas.o&nbsp;&nbsp; cmplxblas.o<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.o: In function `dgbmv_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:357: undefined reference to
`_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.o: In function `dgemm_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:682: undefined reference to
`_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.o: In function `dgemv_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:940: undefined reference to
`_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.o: In function `dger_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:1171: undefined reference
to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.o: In function `dsbmv_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:1800: undefined reference
to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>blas.o:/R/R-2.4.1/src/extra/blas/blas.f:2183: more undefined
references to `_xerbla_' follow<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o: In function `zrotg_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5579: undefined
reference to `_z_abs'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined
reference to `_z_abs'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined
reference to `_z_abs'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined
reference to `_z_abs'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined
reference to `_z_abs'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:5588: more
undefined references to `_z_abs' follow<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o: In function `zsymm_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5778: undefined
reference to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o: In function `zsyr2k_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:6071: undefined
reference to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o: In function `zsyrk_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:6376: undefined
reference to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o: In function `ztbmv_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:6684: undefined
reference to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o: In function `ztbsv_':<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:7065: undefined
reference to `_xerbla_'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:7398: more
undefined references to `_xerbla_' fol<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>ow<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>collect2: ld returned 1 exit status<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[4]: *** [libRblas.so] Error 1<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[4]: Leaving directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[3]: *** [R] Error 2<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[3]: Leaving directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[2]: *** [R] Error 1<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[2]: Leaving directory `/R/R-2.4.1/src/extra'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[1]: *** [R] Error 1<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make[1]: Leaving directory `/R/R-2.4.1/src'<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>make: *** [R] Error 1<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>(2). <b><u><span style='font-weight:bold'>Output from
configure</span></u></b><o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>uname -m = i686<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>uname -r = 1.5.19(0.150/4/2)</span></font> <o:p></o:p></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>uname -s = CYGWIN_NT-5.1<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>uname -v = 2006-01-20 13:28<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=3 face="Times New Roman"><span style='font-size:
12.0pt'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/usr/bin/uname -p = unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/bin/uname -X&nbsp;&nbsp;&nbsp;&nbsp; = unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/bin/arch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/usr/bin/arch -k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/usr/convex/getsysinfo = unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>hostinfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/bin/machine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/usr/bin/oslevel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>/bin/universe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= unknown<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: .<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: /usr/bin<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: /usr/lib/lapack/<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: /usr/X11R6<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: /home/zniu/bin<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: ${PATH}<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH:&nbsp; /.<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH:&nbsp; ${HOME}/bin<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH:&nbsp; x<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>PATH: /cygwin/bin<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&#8230;&#8230;&#8230;&#8230;&#8230;<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>configure: exit 0<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>R is now configured for i686-pc-cygwin<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Source
directory:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Installation directory:&nbsp;&nbsp;&nbsp; /usr/local<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; C
compiler:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
gcc -std=gnu99 -D__NO_MATH_INLINES -g -O2<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Fortran 77
compiler:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g77&nbsp; -g -O2<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; C++
compiler:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
g++&nbsp; -g -O2<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Fortran 90/95 compiler:&nbsp;&nbsp;&nbsp; g77 -g -O2<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Interfaces supported:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
X11<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; External
libraries:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readline<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Additional capabilities:&nbsp;&nbsp; PNG, JPEG,
iconv, MBCS, NLS<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Options
enabled:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; shared
BLAS, R profiling<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'>&nbsp; Recommended packages:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
yes<o:p></o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

<p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>

</div>

</body>

</html>

--Boundary_(ID_0J8TMtVXSg+LJn2Si9guUw)--


From maechler at stat.math.ethz.ch  Thu Jan 11 09:07:19 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 11 Jan 2007 09:07:19 +0100
Subject: [Rd] Perhaps a stupid question about clipboards....
In-Reply-To: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
References: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
Message-ID: <17829.61495.797997.327193@stat.math.ethz.ch>

>>>>> "Byron" == Byron Ellis <ellis at stat.harvard.edu>
>>>>>     on Wed, 10 Jan 2007 21:25:45 -0800 writes:

    Byron> I have a stupid question. 
not stupid.

    Byron> Why is the clipboard accessed through file() and not,
    Byron> say, a clipboard() connection? Is there a good reason
    Byron> for this or is it simply historical?

Why use a new function name for just one special case?
Or do you ask because it would help *find* the feature?

Martin


From ripley at stats.ox.ac.uk  Thu Jan 11 09:47:46 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 11 Jan 2007 08:47:46 +0000 (GMT)
Subject: [Rd] Perhaps a stupid question about clipboards....
In-Reply-To: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
References: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701110843110.15307@gannet.stats.ox.ac.uk>

On Wed, 10 Jan 2007, Byron Ellis wrote:

> I have a stupid question. Why is the clipboard accessed through file()
> and not, say, a clipboard() connection? Is there a good reason for
> this or is it simply historical?

You can in most uses replace file("clipboard") by "clipboard".

In fact internally file, clipboard and url connections are separate (and 
show up so under showConnections), but all three can be accessed via 
file().

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Thu Jan 11 09:54:55 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 11 Jan 2007 09:54:55 +0100 (CET)
Subject: [Rd] Installation on CYGWIN Failed (PR#9442)
Message-ID: <20070111085455.09DB25731E@slim.kubism.ku.dk>

CYGWIN is not a supported system, so why have you filed a bug report on a 
help request?  This is a volunteer project, and we need users of minority 
platforms to support the developers, not v.v.

You could have sought help on the R-devel list, and save the developers 
needless work.

One reason it is not supported is that it does not have a standard dlopen,
and apparently (I am not sure what libtool did here) does not allow 
unresolved symbols in modules as dlopen would.

The actual linker command that failed is missing in your output below.

It used to be possible to build the Windows port of R under Cygwin (and 
may still be), but we gave up supporting that some years ago.

On Thu, 11 Jan 2007, mniu at optonline.net wrote:

> This is a multi-part message in MIME format.
>
> --Boundary_(ID_0J8TMtVXSg+LJn2Si9guUw)
> Content-type: text/plain; charset=us-ascii
> Content-transfer-encoding: 7BIT
>
> Hi,
>
>
>
> I tried to install R-2.4.1 on cygwin system. "./configure" succeeded, but
> make failed. Below, I provide the output from the process: error message,
> and info from configure output, in that order. I appreciate that someone can
> guide me (technically in-sophisticated) through this process.
>
>
>
> Again, thanks for your help.
>
>
>
> Michael Niu
>
>
>
> (1). Output from make
>
>
>
> make[3]: Entering directory `/R/R-2.4.1/src/extra/blas'
>
> make[4]: Entering directory `/R/R-2.4.1/src/extra/blas'
>
> g77 -D__NO_MATH_INLINES -fpic  -g -O2 -c blas.f -o blas.o
>
> blas.f:0: warning: -fpic ignored for target (all code is position
> independent)
>
> g77 -D__NO_MATH_INLINES -fpic  -g -O2 -c cmplxblas.f -o cmplxblas.o
>
> cmplxblas.f:0: warning: -fpic ignored for target (all code is position
> independent)
>
> gcc -std=gnu99 -shared -L/usr/local/lib -o libRblas.so blas.o   cmplxblas.o
>
> blas.o: In function `dgbmv_':
>
> /R/R-2.4.1/src/extra/blas/blas.f:357: undefined reference to `_xerbla_'
>
> blas.o: In function `dgemm_':
>
> /R/R-2.4.1/src/extra/blas/blas.f:682: undefined reference to `_xerbla_'
>
> blas.o: In function `dgemv_':
>
> /R/R-2.4.1/src/extra/blas/blas.f:940: undefined reference to `_xerbla_'
>
> blas.o: In function `dger_':
>
> /R/R-2.4.1/src/extra/blas/blas.f:1171: undefined reference to `_xerbla_'
>
> blas.o: In function `dsbmv_':
>
> /R/R-2.4.1/src/extra/blas/blas.f:1800: undefined reference to `_xerbla_'
>
> blas.o:/R/R-2.4.1/src/extra/blas/blas.f:2183: more undefined references to
> `_xerbla_' follow
>
> cmplxblas.o: In function `zrotg_':
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:5579: undefined reference to `_z_abs'
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined reference to `_z_abs'
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined reference to `_z_abs'
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined reference to `_z_abs'
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined reference to `_z_abs'
>
> cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:5588: more undefined
> references to `_z_abs' follow
>
> cmplxblas.o: In function `zsymm_':
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:5778: undefined reference to
> `_xerbla_'
>
> cmplxblas.o: In function `zsyr2k_':
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:6071: undefined reference to
> `_xerbla_'
>
> cmplxblas.o: In function `zsyrk_':
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:6376: undefined reference to
> `_xerbla_'
>
> cmplxblas.o: In function `ztbmv_':
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:6684: undefined reference to
> `_xerbla_'
>
> cmplxblas.o: In function `ztbsv_':
>
> /R/R-2.4.1/src/extra/blas/cmplxblas.f:7065: undefined reference to
> `_xerbla_'
>
> cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:7398: more undefined
> references to `_xerbla_' fol
>
> ow
>
> collect2: ld returned 1 exit status
>
> make[4]: *** [libRblas.so] Error 1
>
> make[4]: Leaving directory `/R/R-2.4.1/src/extra/blas'
>
> make[3]: *** [R] Error 2
>
> make[3]: Leaving directory `/R/R-2.4.1/src/extra/blas'
>
> make[2]: *** [R] Error 1
>
> make[2]: Leaving directory `/R/R-2.4.1/src/extra'
>
> make[1]: *** [R] Error 1
>
> make[1]: Leaving directory `/R/R-2.4.1/src'
>
> make: *** [R] Error 1
>
>
>
> (2). Output from configure
>
>
>
> uname -m = i686
>
> uname -r = 1.5.19(0.150/4/2)
>
> uname -s = CYGWIN_NT-5.1
>
> uname -v = 2006-01-20 13:28
>
>
>
> /usr/bin/uname -p = unknown
>
> /bin/uname -X     = unknown
>
>
>
> /bin/arch              = unknown
>
> /usr/bin/arch -k       = unknown
>
> /usr/convex/getsysinfo = unknown
>
> hostinfo               = unknown
>
> /bin/machine           = unknown
>
> /usr/bin/oslevel       = unknown
>
> /bin/universe          = unknown
>
>
>
> PATH: .
>
> PATH: /usr/bin
>
> PATH: /usr/lib/lapack/
>
> PATH: /usr/X11R6
>
> PATH: /home/zniu/bin
>
> PATH: ${PATH}
>
> PATH:  /.
>
> PATH:  ${HOME}/bin
>
> PATH:  x
>
> PATH: /cygwin/bin
>
>
>
> .....
>
>
>
> configure: exit 0
>
>
>
> R is now configured for i686-pc-cygwin
>
>
>
>  Source directory:          .
>
>  Installation directory:    /usr/local
>
>
>
>  C compiler:                gcc -std=gnu99 -D__NO_MATH_INLINES -g -O2
>
>  Fortran 77 compiler:       g77  -g -O2
>
>
>
>  C++ compiler:              g++  -g -O2
>
>  Fortran 90/95 compiler:    g77 -g -O2
>
>
>
>  Interfaces supported:      X11
>
>  External libraries:        readline
>
>  Additional capabilities:   PNG, JPEG, iconv, MBCS, NLS
>
>  Options enabled:           shared BLAS, R profiling
>
>
>
>  Recommended packages:      yes
>
>
>
>
>
>
> --Boundary_(ID_0J8TMtVXSg+LJn2Si9guUw)
> Content-type: text/html; charset=us-ascii
> Content-transfer-encoding: 7BIT
>
> <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
>
> <head>
> <meta http-equiv=Content-Type content="text/html; charset=us-ascii">
> <meta name=Generator content="Microsoft Word 11 (filtered medium)">
> <style>
> <!--
> /* Font Definitions */
> @font-face
> 	{font-family:SimSun;
> 	panose-1:2 1 6 0 3 1 1 1 1 1;}
> @font-face
> 	{font-family:"\@SimSun";
> 	panose-1:2 1 6 0 3 1 1 1 1 1;}
> /* Style Definitions */
> p.MsoNormal, li.MsoNormal, div.MsoNormal
> 	{margin:0in;
> 	margin-bottom:.0001pt;
> 	font-size:12.0pt;
> 	font-family:"Times New Roman";}
> a:link, span.MsoHyperlink
> 	{color:blue;
> 	text-decoration:underline;}
> a:visited, span.MsoHyperlinkFollowed
> 	{color:purple;
> 	text-decoration:underline;}
> span.EmailStyle17
> 	{mso-style-type:personal-compose;
> 	font-family:Arial;
> 	color:windowtext;}
> @page Section1
> 	{size:8.5in 11.0in;
> 	margin:1.0in 1.25in 1.0in 1.25in;}
> div.Section1
> 	{page:Section1;}
> -->
> </style>
>
> </head>
>
> <body lang=EN-US link=blue vlink=purple>
>
> <div class=Section1>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>Hi,<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>I tried to install R-2.4.1 on cygwin system. &#8220;./configure&#8221;
> succeeded, but make failed. Below, I provide the output from the process: error
> message, and info from configure output, in that order. I appreciate that someone
> can guide me (technically in-sophisticated) through this process.<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>Again, thanks for your help.<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>Michael Niu<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>(1). <b><u><span style='font-weight:bold'>Output from make</span></u></b><o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[3]: Entering directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[4]: Entering directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>g77 -D__NO_MATH_INLINES -fpic&nbsp; -g -O2 -c blas.f -o
> blas.o<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.f:0: warning: -fpic ignored for target (all code is
> position independent)<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>g77 -D__NO_MATH_INLINES -fpic&nbsp; -g -O2 -c cmplxblas.f -o
> cmplxblas.o<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.f:0: warning: -fpic ignored for target (all code
> is position independent)<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>gcc -std=gnu99 -shared -L/usr/local/lib -o libRblas.so
> blas.o&nbsp;&nbsp; cmplxblas.o<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.o: In function `dgbmv_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:357: undefined reference to
> `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.o: In function `dgemm_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:682: undefined reference to
> `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.o: In function `dgemv_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:940: undefined reference to
> `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.o: In function `dger_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:1171: undefined reference
> to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.o: In function `dsbmv_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/blas.f:1800: undefined reference
> to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>blas.o:/R/R-2.4.1/src/extra/blas/blas.f:2183: more undefined
> references to `_xerbla_' follow<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o: In function `zrotg_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5579: undefined
> reference to `_z_abs'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined
> reference to `_z_abs'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5585: undefined
> reference to `_z_abs'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined
> reference to `_z_abs'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5586: undefined
> reference to `_z_abs'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:5588: more
> undefined references to `_z_abs' follow<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o: In function `zsymm_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:5778: undefined
> reference to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o: In function `zsyr2k_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:6071: undefined
> reference to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o: In function `zsyrk_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:6376: undefined
> reference to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o: In function `ztbmv_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:6684: undefined
> reference to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o: In function `ztbsv_':<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/R/R-2.4.1/src/extra/blas/cmplxblas.f:7065: undefined
> reference to `_xerbla_'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>cmplxblas.o:/R/R-2.4.1/src/extra/blas/cmplxblas.f:7398: more
> undefined references to `_xerbla_' fol<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>ow<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>collect2: ld returned 1 exit status<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[4]: *** [libRblas.so] Error 1<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[4]: Leaving directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[3]: *** [R] Error 2<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[3]: Leaving directory `/R/R-2.4.1/src/extra/blas'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[2]: *** [R] Error 1<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[2]: Leaving directory `/R/R-2.4.1/src/extra'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[1]: *** [R] Error 1<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make[1]: Leaving directory `/R/R-2.4.1/src'<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>make: *** [R] Error 1<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>(2). <b><u><span style='font-weight:bold'>Output from
> configure</span></u></b><o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>uname -m = i686<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>uname -r = 1.5.19(0.150/4/2)</span></font> <o:p></o:p></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>uname -s = CYGWIN_NT-5.1<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>uname -v = 2006-01-20 13:28<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=3 face="Times New Roman"><span style='font-size:
> 12.0pt'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/usr/bin/uname -p = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/bin/uname -X&nbsp;&nbsp;&nbsp;&nbsp; = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/bin/arch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/usr/bin/arch -k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
> unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/usr/convex/getsysinfo = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>hostinfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/bin/machine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/usr/bin/oslevel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
> unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>/bin/universe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> = unknown<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: .<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: /usr/bin<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: /usr/lib/lapack/<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: /usr/X11R6<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: /home/zniu/bin<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: ${PATH}<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH:&nbsp; /.<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH:&nbsp; ${HOME}/bin<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH:&nbsp; x<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>PATH: /cygwin/bin<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&#8230;&#8230;&#8230;&#8230;&#8230;<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>configure: exit 0<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>R is now configured for i686-pc-cygwin<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Source
> directory:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Installation directory:&nbsp;&nbsp;&nbsp; /usr/local<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; C
> compiler:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> gcc -std=gnu99 -D__NO_MATH_INLINES -g -O2<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Fortran 77
> compiler:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g77&nbsp; -g -O2<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; C++
> compiler:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> g++&nbsp; -g -O2<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Fortran 90/95 compiler:&nbsp;&nbsp;&nbsp; g77 -g -O2<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Interfaces supported:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> X11<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; External
> libraries:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readline<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Additional capabilities:&nbsp;&nbsp; PNG, JPEG,
> iconv, MBCS, NLS<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Options
> enabled:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; shared
> BLAS, R profiling<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'>&nbsp; Recommended packages:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
> yes<o:p></o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> <p class=MsoNormal><font size=2 face=Arial><span style='font-size:10.0pt;
> font-family:Arial'><o:p>&nbsp;</o:p></span></font></p>
>
> </div>
>
> </body>
>
> </html>
>
> --Boundary_(ID_0J8TMtVXSg+LJn2Si9guUw)--
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 11 12:52:44 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 11 Jan 2007 11:52:44 +0000
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A545B1.6070508@stats.uwo.ca>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
Message-ID: <45A6250C.3020802@cimr.cam.ac.uk>

Duncan Murdoch wrote:
> On 1/10/2007 2:29 PM, Hin-Tak Leung wrote:
>> Does anybody (most probably the core team) know if there is
>> any difference in how the official 2.4.0 and 2.4.1 binaries are
>> built?
>>
>> Problem is, 2.4.0 loads with the wine (I tried a few recent
>> versions, and also used 2.3.x under wine from time to time),
>> but 2.4.1 won't.
> 
> Yes, there were changes to the MinGW run-time library between those two 
> releases.  See http://www.murdoch-sutherland.com/Rtools/.
> 
> If you can be more specific about the problem, it's possible the Wine or 
> MinGW people could fix it.

With 2.4.1, "wine Rgui.exe" launches the main Rgui window, then crashes
and dropped with debug traces without being able to get to the
Rconsole tab. Logically it is a wine "bug", since the same binary
runs under genuine windows, but it looks like it is due to change
from mingw, so I guess I should involve both parties.

BTW, I am also cross-compiling some R packages with the cross tools 
provided by Prof Ripley. Presumably it means that I need to hack away
the bundled mingw stuff in the cross-tool and replaced them with the 
newer mingw libraries as well? (the whole thing with wine is so that I 
can cross-compile and test right away...)

Hin-Tak


From murdoch at stats.uwo.ca  Thu Jan 11 13:13:20 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 11 Jan 2007 07:13:20 -0500
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A6250C.3020802@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
Message-ID: <45A629E0.8090100@stats.uwo.ca>

On 1/11/2007 6:52 AM, Hin-Tak Leung wrote:
> Duncan Murdoch wrote:
>> On 1/10/2007 2:29 PM, Hin-Tak Leung wrote:
>>> Does anybody (most probably the core team) know if there is
>>> any difference in how the official 2.4.0 and 2.4.1 binaries are
>>> built?
>>>
>>> Problem is, 2.4.0 loads with the wine (I tried a few recent
>>> versions, and also used 2.3.x under wine from time to time),
>>> but 2.4.1 won't.
>> Yes, there were changes to the MinGW run-time library between those two 
>> releases.  See http://www.murdoch-sutherland.com/Rtools/.
>>
>> If you can be more specific about the problem, it's possible the Wine or 
>> MinGW people could fix it.
> 
> With 2.4.1, "wine Rgui.exe" launches the main Rgui window, then crashes
> and dropped with debug traces without being able to get to the
> Rconsole tab. Logically it is a wine "bug", since the same binary
> runs under genuine windows, but it looks like it is due to change
> from mingw, so I guess I should involve both parties.

I'd suggest trying a build with debug information ("make distclean; make 
DEBUG=T"), so that the debug trace has symbol names and line information 
in it.  I could easily do such a build of R-patched or R-devel for you
if you want to try this.

> 
> BTW, I am also cross-compiling some R packages with the cross tools 
> provided by Prof Ripley. Presumably it means that I need to hack away
> the bundled mingw stuff in the cross-tool and replaced them with the 
> newer mingw libraries as well? (the whole thing with wine is so that I 
> can cross-compile and test right away...)

I've never used the cross-compiling tools, so I can't help you with this.

Duncan Murdoch

> Hin-Tak
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Thu Jan 11 15:00:49 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 11 Jan 2007 14:00:49 +0000 (GMT)
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A6250C.3020802@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>

On Thu, 11 Jan 2007, Hin-Tak Leung wrote:

> Duncan Murdoch wrote:
>> On 1/10/2007 2:29 PM, Hin-Tak Leung wrote:
>>> Does anybody (most probably the core team) know if there is
>>> any difference in how the official 2.4.0 and 2.4.1 binaries are
>>> built?
>>> 
>>> Problem is, 2.4.0 loads with the wine (I tried a few recent
>>> versions, and also used 2.3.x under wine from time to time),
>>> but 2.4.1 won't.
>> 
>> Yes, there were changes to the MinGW run-time library between those two 
>> releases.  See http://www.murdoch-sutherland.com/Rtools/.
>> 
>> If you can be more specific about the problem, it's possible the Wine or 
>> MinGW people could fix it.
>
> With 2.4.1, "wine Rgui.exe" launches the main Rgui window, then crashes
> and dropped with debug traces without being able to get to the
> Rconsole tab. Logically it is a wine "bug", since the same binary
> runs under genuine windows, but it looks like it is due to change
> from mingw, so I guess I should involve both parties.
>
> BTW, I am also cross-compiling some R packages with the cross tools provided 
> by Prof Ripley. Presumably it means that I need to hack away
> the bundled mingw stuff in the cross-tool and replaced them with the newer 
> mingw libraries as well? (the whole thing with wine is so that I can 
> cross-compile and test right away...)

My belief is that the cross-tools I package build R 2.4.x but need 
updating for 2.5.0.

As I use x86_64 cross tools for R-devel it does not affect me, but I 
will rebuild the tools on an i386 box in due course.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ahenningsen at email.uni-kiel.de  Thu Jan 11 15:07:00 2007
From: ahenningsen at email.uni-kiel.de (ahenningsen at email.uni-kiel.de)
Date: Thu, 11 Jan 2007 15:07:00 +0100 (CET)
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9443)
Message-ID: <20070111140700.45BD75730B@slim.kubism.ku.dk>

Full_Name: Arne Henningsen
Version: 2.4.0
OS: Linux
Submission from: (NULL) (134.245.140.242)


Sweave does not allow line breaks after forward slashes ("/"). This might lead
to a long "substring" of a command that cannot be wrapped. Hence, Sweave either
keeps this long "substring" in the current line and produces a too long line or
it moves the entire "substring" in the following line and leaves the current
line rather empty. This problem can be solved if Sweave is allowed to introduce
line breaks after forward slashes. (I guess that this problem can also be solved
if parse() adds a blank after a forward slash.)

Example: 
The following expression cannot be wrapped by Sweave:

mean(myDataframe$myFirstVariable)/mean(myDataframe$mySecondVariable)


Thanks for the great software packages (R, Sweave, ...),
Arne


From friedrich.leisch at stat.uni-muenchen.de  Thu Jan 11 15:42:26 2007
From: friedrich.leisch at stat.uni-muenchen.de (Friedrich Leisch)
Date: Thu, 11 Jan 2007 15:42:26 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward
	slashes	(PR#9443)
In-Reply-To: <20070111140700.45BD75730B@slim.kubism.ku.dk>
References: <20070111140700.45BD75730B@slim.kubism.ku.dk>
Message-ID: <17830.19666.63280.738462@lxh5.stat.uni-muenchen.de>

>>>>> On Thu, 11 Jan 2007 15:07:00 +0100 (CET),
>>>>> ahenningsen  (a) wrote:

  > Full_Name: Arne Henningsen
  > Version: 2.4.0
  > OS: Linux
  > Submission from: (NULL) (134.245.140.242)


  > Sweave does not allow line breaks after forward slashes ("/"). This might lead
  > to a long "substring" of a command that cannot be wrapped. Hence, Sweave either
  > keeps this long "substring" in the current line and produces a too long line or
  > it moves the entire "substring" in the following line and leaves the current
  > line rather empty. This problem can be solved if Sweave is allowed to introduce
  > line breaks after forward slashes. (I guess that this problem can also be solved
  > if parse() adds a blank after a forward slash.)

  > Example: 
  > The following expression cannot be wrapped by Sweave:

  > mean(myDataframe$myFirstVariable)/mean(myDataframe$mySecondVariable)


In R 2.5.0 you can use Sweave option keep.source=TRUE to keep the
original formatting of source code, including all indentation and line
breaks -> does this solve your problem?

Best,
Fritz Leisch


From friedrich.leisch at stat.uni-muenchen.de  Thu Jan 11 15:42:43 2007
From: friedrich.leisch at stat.uni-muenchen.de (friedrich.leisch at stat.uni-muenchen.de)
Date: Thu, 11 Jan 2007 15:42:43 +0100 (CET)
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9444)
Message-ID: <20070111144243.9B09519BA1@slim.kubism.ku.dk>

>>>>> On Thu, 11 Jan 2007 15:07:00 +0100 (CET),
>>>>> ahenningsen  (a) wrote:

  > Full_Name: Arne Henningsen
  > Version: 2.4.0
  > OS: Linux
  > Submission from: (NULL) (134.245.140.242)


  > Sweave does not allow line breaks after forward slashes ("/"). This might lead
  > to a long "substring" of a command that cannot be wrapped. Hence, Sweave either
  > keeps this long "substring" in the current line and produces a too long line or
  > it moves the entire "substring" in the following line and leaves the current
  > line rather empty. This problem can be solved if Sweave is allowed to introduce
  > line breaks after forward slashes. (I guess that this problem can also be solved
  > if parse() adds a blank after a forward slash.)

  > Example: 
  > The following expression cannot be wrapped by Sweave:

  > mean(myDataframe$myFirstVariable)/mean(myDataframe$mySecondVariable)


In R 2.5.0 you can use Sweave option keep.source=TRUE to keep the
original formatting of source code, including all indentation and line
breaks -> does this solve your problem?

Best,
Fritz Leisch


From murdoch at stats.uwo.ca  Thu Jan 11 15:53:41 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 11 Jan 2007 09:53:41 -0500
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
 (PR#9443)
In-Reply-To: <20070111140700.45BD75730B@slim.kubism.ku.dk>
References: <20070111140700.45BD75730B@slim.kubism.ku.dk>
Message-ID: <45A64F75.9040906@stats.uwo.ca>

On 1/11/2007 9:07 AM, ahenningsen at email.uni-kiel.de wrote:
> Full_Name: Arne Henningsen
> Version: 2.4.0
> OS: Linux
> Submission from: (NULL) (134.245.140.242)
> 
> 
> Sweave does not allow line breaks after forward slashes ("/"). This might lead
> to a long "substring" of a command that cannot be wrapped. Hence, Sweave either
> keeps this long "substring" in the current line and produces a too long line or
> it moves the entire "substring" in the following line and leaves the current
> line rather empty. This problem can be solved if Sweave is allowed to introduce
> line breaks after forward slashes. (I guess that this problem can also be solved
> if parse() adds a blank after a forward slash.)
> 
> Example: 
> The following expression cannot be wrapped by Sweave:
> 
> mean(myDataframe$myFirstVariable)/mean(myDataframe$mySecondVariable)

It's actually deparse() that causes this, but the problem is already 
solved in R-devel (to become R 2.5.0).  If you don't like the formatting 
that deparse() gives to one of your expressions, use the Sweave option
keep.source=TRUE, and your original formatting will be kept for that 
chunk.  Or globally retain your formatting via 
\SweaveOpts{keep.source=TRUE} at the start of your file.

Duncan Murdoch


From murdoch at stats.uwo.ca  Thu Jan 11 15:56:06 2007
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Thu, 11 Jan 2007 15:56:06 +0100 (CET)
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9445)
Message-ID: <20070111145606.01B5E57300@slim.kubism.ku.dk>

On 1/11/2007 9:07 AM, ahenningsen at email.uni-kiel.de wrote:
> Full_Name: Arne Henningsen
> Version: 2.4.0
> OS: Linux
> Submission from: (NULL) (134.245.140.242)
> 
> 
> Sweave does not allow line breaks after forward slashes ("/"). This might lead
> to a long "substring" of a command that cannot be wrapped. Hence, Sweave either
> keeps this long "substring" in the current line and produces a too long line or
> it moves the entire "substring" in the following line and leaves the current
> line rather empty. This problem can be solved if Sweave is allowed to introduce
> line breaks after forward slashes. (I guess that this problem can also be solved
> if parse() adds a blank after a forward slash.)
> 
> Example: 
> The following expression cannot be wrapped by Sweave:
> 
> mean(myDataframe$myFirstVariable)/mean(myDataframe$mySecondVariable)

It's actually deparse() that causes this, but the problem is already 
solved in R-devel (to become R 2.5.0).  If you don't like the formatting 
that deparse() gives to one of your expressions, use the Sweave option
keep.source=TRUE, and your original formatting will be kept for that 
chunk.  Or globally retain your formatting via 
\SweaveOpts{keep.source=TRUE} at the start of your file.

Duncan Murdoch


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 11 16:12:30 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 11 Jan 2007 15:12:30 +0000
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A629E0.8090100@stats.uwo.ca>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
Message-ID: <45A653DE.8010704@cimr.cam.ac.uk>

Duncan Murdoch wrote:
> On 1/11/2007 6:52 AM, Hin-Tak Leung wrote:
>> Duncan Murdoch wrote:
>>> On 1/10/2007 2:29 PM, Hin-Tak Leung wrote:
>>>> Does anybody (most probably the core team) know if there is
>>>> any difference in how the official 2.4.0 and 2.4.1 binaries are
>>>> built?
>>>>
>>>> Problem is, 2.4.0 loads with the wine (I tried a few recent
>>>> versions, and also used 2.3.x under wine from time to time),
>>>> but 2.4.1 won't.
>>> Yes, there were changes to the MinGW run-time library between those 
>>> two releases.  See http://www.murdoch-sutherland.com/Rtools/.
>>>
>>> If you can be more specific about the problem, it's possible the Wine 
>>> or MinGW people could fix it.
>>
>> With 2.4.1, "wine Rgui.exe" launches the main Rgui window, then crashes
>> and dropped with debug traces without being able to get to the
>> Rconsole tab. Logically it is a wine "bug", since the same binary
>> runs under genuine windows, but it looks like it is due to change
>> from mingw, so I guess I should involve both parties.
> 
> I'd suggest trying a build with debug information ("make distclean; make 
> DEBUG=T"), so that the debug trace has symbol names and line information 
> in it.  I could easily do such a build of R-patched or R-devel for you
> if you want to try this.

Thanks for the offer; but I think wine should cope as anything runs 
under windows should run, so I am inclined on playing with wine a bit to 
see if I can get it to tell me a bit more about what it is not
happy about 2.4.1. wine just should not be sensitive to mingw versions.

<snipped>

Hin-Tak


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 11 16:31:26 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 11 Jan 2007 15:31:26 +0000
Subject: [Rd] cross tools (was Re: wine and build difference between R.2.4.0
 and R 2.4.1 windows binaries?)
In-Reply-To: <Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
Message-ID: <45A6584E.5030507@cimr.cam.ac.uk>

Prof Brian Ripley wrote:
> On Thu, 11 Jan 2007, Hin-Tak Leung wrote:
<snipped earlier discussion on wine>
>>
>> BTW, I am also cross-compiling some R packages with the cross tools 
>> provided by Prof Ripley. Presumably it means that I need to hack away
>> the bundled mingw stuff in the cross-tool and replaced them with the 
>> newer mingw libraries as well? (the whole thing with wine is so that I 
>> can cross-compile and test right away...)
> 
> My belief is that the cross-tools I package build R 2.4.x but need 
> updating for 2.5.0.
> 
> As I use x86_64 cross tools for R-devel it does not affect me, but I 
> will rebuild the tools on an i386 box in due course.

My main use of the cross-tool is to build the windows binary of a
custom R package (rather than R itself) - so that I can distribute it 
(after testing on some windows machines which are not equiped
with development tools), so it is more important that the cross
tool generates binaries which are compatible with the latest
official windows binary distribution, rather than being able to
build the latest development source as a whole.

FWIW, I use the i386 cross-tool provided on x86_64, and also
build wine as 32-bit and runs windows R that way. I am not
even sure if it is possible to dual-boot windows on opteron if
I had wanted to. (a waste, in any case...).

It might be worth building the cross tools as 32-bit on x86_64
just so that what you use is the same as what you give away :-)?

(I only routinely build 3 packages as 32-bit rather than
64-bit on x86_64 - R for memory consumption, wine because it
just isn't written for 64-bit, and ghostscript because
a lot of font-rendering issues are 32-bit/64-bit sensitive).

Hin-Tak


From jeff.horner at vanderbilt.edu  Thu Jan 11 18:49:14 2007
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Thu, 11 Jan 2007 11:49:14 -0600
Subject: [Rd] Miniscule patch to internet.c
Message-ID: <45A6789A.7090304@vanderbilt.edu>

Looks like a benign copy-paste issue. This is in R_newurl, and I doubt 
anyone would miss that one byte, though.

Index: src/modules/internet/internet.c
===================================================================
--- src/modules/internet/internet.c     (revision 40446)
+++ src/modules/internet/internet.c     (working copy)
@@ -167,7 +167,7 @@

      new = (Rconnection) malloc(sizeof(struct Rconn));
      if(!new) error(_("allocation of url connection failed"));
-    new->class = (char *) malloc(strlen("file") + 1);
+    new->class = (char *) malloc(strlen("url") + 1);
      if(!new->class) {
         free(new);
         error(_("allocation of url connection failed"));

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From ellis at stat.harvard.edu  Fri Jan 12 01:49:13 2007
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Thu, 11 Jan 2007 16:49:13 -0800
Subject: [Rd] Perhaps a stupid question about clipboards....
In-Reply-To: <17829.61495.797997.327193@stat.math.ethz.ch>
References: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
	<17829.61495.797997.327193@stat.math.ethz.ch>
Message-ID: <7098abec0701111649y56ab88b8p749f22b926b427c3@mail.gmail.com>

On 1/11/07, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
>     Byron> Why is the clipboard accessed through file() and not,
>     Byron> say, a clipboard() connection? Is there a good reason
>     Byron> for this or is it simply historical?
>
> Why use a new function name for just one special case?
> Or do you ask because it would help *find* the feature?

For the same reason that pipes have their own function? Additionally,
some systems have named clipboards (e.g. OS X and IIRC X11, though
that may require an extension of some sort) that you might want to
access explicitly.

Actually, ?clipboard turns up the right help page so if you didn't
know that there wasn't such a function you'd end up at the right place
(if perhaps a bit confused). As it happens, I use OS X so I had to use
pipe() since there isn't built in functionality. :-)


>
> Martin
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From ahenningsen at email.uni-kiel.de  Fri Jan 12 09:34:15 2007
From: ahenningsen at email.uni-kiel.de (Arne Henningsen)
Date: Fri, 12 Jan 2007 09:34:15 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9444)
In-Reply-To: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
Message-ID: <200701120934.15332.ahenningsen@email.uni-kiel.de>

Dear Fritz and Duncan,

thank you very much for your answers.

On Thursday 11 January 2007 15:42, friedrich.leisch at stat.uni-muenchen.de 
wrote:
> [...]
> In R 2.5.0 you can use Sweave option keep.source=TRUE to keep the
> original formatting of source code, including all indentation and line
> breaks -> does this solve your problem?

short answer: Yes.
long answer: I generally like the formatting of the code chunks by Sweave 
(deparse). Therefore, I hesitate a bit to use "keep.source=TRUE".

On Thursday 11 January 2007 15:56, murdoch at stats.uwo.ca wrote:
> [...]
> It's actually deparse() that causes this, but the problem is already
> solved in R-devel (to become R 2.5.0).  

Great!

> If you don't like the formatting 
> that deparse() gives to one of your expressions, use the Sweave option
> keep.source=TRUE, and your original formatting will be kept for that
> chunk.  Or globally retain your formatting via
> \SweaveOpts{keep.source=TRUE} at the start of your file.

see above.

Best wishes,
Arne

-- 
Arne Henningsen
Department of Agricultural Economics
University of Kiel
Olshausenstr. 40
D-24098 Kiel (Germany)
Tel: +49-431-880 4445
Fax: +49-431-880 1397
ahenningsen at agric-econ.uni-kiel.de
http://www.uni-kiel.de/agrarpol/ahenningsen/


From ripley at stats.ox.ac.uk  Fri Jan 12 10:01:02 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Jan 2007 09:01:02 +0000 (GMT)
Subject: [Rd] Perhaps a stupid question about clipboards....
In-Reply-To: <7098abec0701111649y56ab88b8p749f22b926b427c3@mail.gmail.com>
References: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
	<17829.61495.797997.327193@stat.math.ethz.ch>
	<7098abec0701111649y56ab88b8p749f22b926b427c3@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701120854320.1756@gannet.stats.ox.ac.uk>

On Thu, 11 Jan 2007, Byron Ellis wrote:

> On 1/11/07, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
>>     Byron> Why is the clipboard accessed through file() and not,
>>     Byron> say, a clipboard() connection? Is there a good reason
>>     Byron> for this or is it simply historical?
>>
>> Why use a new function name for just one special case?
>> Or do you ask because it would help *find* the feature?
>
> For the same reason that pipes have their own function? Additionally,
> some systems have named clipboards (e.g. OS X and IIRC X11, though
> that may require an extension of some sort) that you might want to
> access explicitly.

X11 has two, and with an extension three, and all can be accessed via 
file().

> Actually, ?clipboard turns up the right help page so if you didn't
> know that there wasn't such a function you'd end up at the right place
> (if perhaps a bit confused). As it happens, I use OS X so I had to use
> pipe() since there isn't built in functionality. :-)

That is because no one has contributed it.  Please do so yourself.
When you do, please bear in the mind the convenience factor I pointed out 
earlier in this thread.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Fri Jan 12 11:39:11 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 12 Jan 2007 05:39:11 -0500
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
 (PR#9444)
In-Reply-To: <200701120826.36423.ahenningsen@agric-econ.uni-kiel.de>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
	<200701120826.36423.ahenningsen@agric-econ.uni-kiel.de>
Message-ID: <45A7654F.90004@stats.uwo.ca>

On 1/12/2007 2:26 AM, Arne Henningsen wrote:
> Dear Fritz and Duncan,
> 
> thank you very much for your answers.
> 
> On Thursday 11 January 2007 15:42, friedrich.leisch at stat.uni-muenchen.de 
> wrote:
>> [...]
>> In R 2.5.0 you can use Sweave option keep.source=TRUE to keep the
>> original formatting of source code, including all indentation and line
>> breaks -> does this solve your problem?
> 
> short answer: Yes.
> long answer: I generally like the formatting of the code chunks by Sweave 
> (deparse). Therefore, I hesitate a bit to use "keep.source=TRUE".
> 
> On Thursday 11 January 2007 15:56, murdoch at stats.uwo.ca wrote:
>> [...]
>> It's actually deparse() that causes this, but the problem is already
>> solved in R-devel (to become R 2.5.0).  
> 
> Great!

I think you misunderstood me, given the "long answer".  We haven't 
changed the way deparse() handles "/". The solution in R-devel is given 
below.

Duncan Murdoch

>> If you don't like the formatting 
>> that deparse() gives to one of your expressions, use the Sweave option
>> keep.source=TRUE, and your original formatting will be kept for that
>> chunk.  Or globally retain your formatting via
>> \SweaveOpts{keep.source=TRUE} at the start of your file.
> 
> see above.
> 
> Best wishes,
> Arne
>


From s.p.pears at hotmail.co.uk  Fri Jan 12 12:41:09 2007
From: s.p.pears at hotmail.co.uk (Simon Pears)
Date: Fri, 12 Jan 2007 11:41:09 +0000
Subject: [Rd] Using R as a server to process multiple requests
Message-ID: <BAY108-F2152944E7D1D0013854E80E4B00@phx.gbl>

Hi

Has anyone experience of using R as a server to procuess multiple Java 
client requests. I am aware of RServe. However, in a Windows environment I 
think only one connection at a time is allowed.

Has anyone used spawning a R Process from Java for each request, e.g

Process process = Runtime.getRuntime().exec(rExecutable)
BufferedWriter bw = new BufferedWriter(new 
OutputStreamWriter(process.getOutputStream()), buffSize);
BufferedReader br = new BufferedReader(new 
InputStreamReader(process.getInputStream()),   buffSize);
BufferedReader be = new BufferedReader(new 
InputStreamReader(process.getErrorStream()),   buffSize);

Regards Simon

_________________________________________________________________
Be the first to hear what's new at MSN - sign up to our free newsletters!


From ripley at stats.ox.ac.uk  Fri Jan 12 13:05:03 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Jan 2007 12:05:03 +0000 (GMT)
Subject: [Rd] cross tools (was Re: wine and build difference between
 R.2.4.0 and R 2.4.1 windows binaries?)
In-Reply-To: <45A6584E.5030507@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
	<45A6584E.5030507@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>

On Thu, 11 Jan 2007, Hin-Tak Leung wrote:

> Prof Brian Ripley wrote:
>> On Thu, 11 Jan 2007, Hin-Tak Leung wrote:
> <snipped earlier discussion on wine>
>>> 
>>> BTW, I am also cross-compiling some R packages with the cross tools 
>>> provided by Prof Ripley. Presumably it means that I need to hack away
>>> the bundled mingw stuff in the cross-tool and replaced them with the newer 
>>> mingw libraries as well? (the whole thing with wine is so that I can 
>>> cross-compile and test right away...)
>> 
>> My belief is that the cross-tools I package build R 2.4.x but need updating 
>> for 2.5.0.
>> 
>> As I use x86_64 cross tools for R-devel it does not affect me, but I will 
>> rebuild the tools on an i386 box in due course.
>
> My main use of the cross-tool is to build the windows binary of a
> custom R package (rather than R itself) - so that I can distribute it (after 
> testing on some windows machines which are not equiped
> with development tools), so it is more important that the cross
> tool generates binaries which are compatible with the latest
> official windows binary distribution, rather than being able to
> build the latest development source as a whole.
>
> FWIW, I use the i386 cross-tool provided on x86_64, and also
> build wine as 32-bit and runs windows R that way. I am not
> even sure if it is possible to dual-boot windows on opteron if
> I had wanted to. (a waste, in any case...).
>
> It might be worth building the cross tools as 32-bit on x86_64
> just so that what you use is the same as what you give away :-)?

I do still have a i686 Linux machine, and I will use that to rebuild the 
cross-tools and test them.  There are some subtle differences (e.g. in 
address formats), which is why I wanted to make sure that cross-building 
on x86_64 was also possible.  I know the i386 cross-tools do run on 
x86_64.

The version from my i686 box is now on the website.

> (I only routinely build 3 packages as 32-bit rather than
> 64-bit on x86_64 - R for memory consumption, wine because it
> just isn't written for 64-bit, and ghostscript because
> a lot of font-rendering issues are 32-bit/64-bit sensitive).

Then you probably don't use Java, where there seem major 64-bit issues 
(starting with the missing browser plug-in, and including very few of 
the Java-based R packages working on most combinations of JRE and OS: I 
did briefly get a JRE working on FC5).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 12 13:31:48 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 12 Jan 2007 12:31:48 +0000
Subject: [Rd] cross tools (was Re: wine and build difference between
 R.2.4.0 and R 2.4.1 windows binaries?)
In-Reply-To: <Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
	<45A6584E.5030507@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>
Message-ID: <45A77FB4.6020301@cimr.cam.ac.uk>

Prof Brian Ripley wrote:
> On Thu, 11 Jan 2007, Hin-Tak Leung wrote:
> 
>> Prof Brian Ripley wrote:
>>> On Thu, 11 Jan 2007, Hin-Tak Leung wrote:
>> <snipped earlier discussion on wine>
>>>>
>>>> BTW, I am also cross-compiling some R packages with the cross tools 
>>>> provided by Prof Ripley. Presumably it means that I need to hack away
>>>> the bundled mingw stuff in the cross-tool and replaced them with the 
>>>> newer mingw libraries as well? (the whole thing with wine is so that 
>>>> I can cross-compile and test right away...)
>>>
>>> My belief is that the cross-tools I package build R 2.4.x but need 
>>> updating for 2.5.0.
>>>
>>> As I use x86_64 cross tools for R-devel it does not affect me, but I 
>>> will rebuild the tools on an i386 box in due course.
>>
>> My main use of the cross-tool is to build the windows binary of a
>> custom R package (rather than R itself) - so that I can distribute it 
>> (after testing on some windows machines which are not equiped
>> with development tools), so it is more important that the cross
>> tool generates binaries which are compatible with the latest
>> official windows binary distribution, rather than being able to
>> build the latest development source as a whole.
>>
>> FWIW, I use the i386 cross-tool provided on x86_64, and also
>> build wine as 32-bit and runs windows R that way. I am not
>> even sure if it is possible to dual-boot windows on opteron if
>> I had wanted to. (a waste, in any case...).
>>
>> It might be worth building the cross tools as 32-bit on x86_64
>> just so that what you use is the same as what you give away :-)?
> 
> I do still have a i686 Linux machine, and I will use that to rebuild the 
> cross-tools and test them.  There are some subtle differences (e.g. in 
> address formats), which is why I wanted to make sure that cross-building 
> on x86_64 was also possible.  I know the i386 cross-tools do run on x86_64.
> 
> The version from my i686 box is now on the website.

Oh yes, I meant the i386 cross-tool *you* provided on x86_64 .
BTW, there are a bunch of ready-made cross tool rpm's on
http://mirzam.it.vu.nl/mingw/

linked from wine's dev-guide:
http://www.winehq.com/site/docs/winedev-guide/cross-compiling-tests

>> (I only routinely build 3 packages as 32-bit rather than
>> 64-bit on x86_64 - R for memory consumption, wine because it
>> just isn't written for 64-bit, and ghostscript because
>> a lot of font-rendering issues are 32-bit/64-bit sensitive).
> 
> Then you probably don't use Java, where there seem major 64-bit issues 
> (starting with the missing browser plug-in, and including very few of 
> the Java-based R packages working on most combinations of JRE and OS: I 
> did briefly get a JRE working on FC5).

I do use Java, just not in relation to R - it has been a while since
I played with SJava. Sun's JDK (32-bit) has been working consistently. 
On FC5 x86_64 the default
gcj-based JRE was a bit funny, but since upgraded to FC6, I found
the gcj-based JRE on x86_64 can run haploview 
(http://www.broad.mit.edu/mpg/haploview/) reasonably well.
If you want 64-bit R working with a 64-bit JRE, the gcj-based jre seems
to be the only route. I have built something involving JNI recently
using the gcj-based jdk seems alright. (it did finish compilation
- it is a suite of applications [http://gridengine.sunsource.net/],
only a small part is JNI based and I don't know the specific
part well enough to judge for an mis-compilation or
broken functionality).

Hin-Tak


From ripley at stats.ox.ac.uk  Fri Jan 12 13:38:03 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Jan 2007 12:38:03 +0000 (GMT)
Subject: [Rd] cross tools (was Re: wine and build difference between
 R.2.4.0 and R 2.4.1 windows binaries?)
In-Reply-To: <45A77FB4.6020301@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
	<45A6584E.5030507@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>
	<45A77FB4.6020301@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701121234070.6620@gannet.stats.ox.ac.uk>

On Fri, 12 Jan 2007, Hin-Tak Leung wrote:

[...]

> Oh yes, I meant the i386 cross-tool *you* provided on x86_64 .
> BTW, there are a bunch of ready-made cross tool rpm's on
> http://mirzam.it.vu.nl/mingw/

Like all other sets I know of they appear to lack g77 and so are 
inadequate to make R.  (Also, their mingw-runtime is well outdated.)

The xmingw-build scripts now available on www.mingw.org make building a 
cross-compiler almost straightforward (although I suspect the important 
changes are to the source tarballs).

> linked from wine's dev-guide:
> http://www.winehq.com/site/docs/winedev-guide/cross-compiling-tests

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 12 15:44:08 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 12 Jan 2007 14:44:08 +0000
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A629E0.8090100@stats.uwo.ca>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
Message-ID: <45A79EB8.8010606@cimr.cam.ac.uk>

Duncan Murdoch wrote:
> On 1/11/2007 6:52 AM, Hin-Tak Leung wrote:
>> Duncan Murdoch wrote:
>>> On 1/10/2007 2:29 PM, Hin-Tak Leung wrote:
>>>> Does anybody (most probably the core team) know if there is
>>>> any difference in how the official 2.4.0 and 2.4.1 binaries are
>>>> built?
>>>>
>>>> Problem is, 2.4.0 loads with the wine (I tried a few recent
>>>> versions, and also used 2.3.x under wine from time to time),
>>>> but 2.4.1 won't.
>>> Yes, there were changes to the MinGW run-time library between those 
>>> two releases.  See http://www.murdoch-sutherland.com/Rtools/.
>>>
>>> If you can be more specific about the problem, it's possible the Wine 
>>> or MinGW people could fix it.
>>
>> With 2.4.1, "wine Rgui.exe" launches the main Rgui window, then crashes
>> and dropped with debug traces without being able to get to the
>> Rconsole tab. Logically it is a wine "bug", since the same binary
>> runs under genuine windows, but it looks like it is due to change
>> from mingw, so I guess I should involve both parties.
> 
> I'd suggest trying a build with debug information ("make distclean; make 
> DEBUG=T"), so that the debug trace has symbol names and line information 
> in it.  I could easily do such a build of R-patched or R-devel for you
> if you want to try this.

I tried loading R-patched and R2.5dev (they both have a time stamp for 
11 Jan early morning):

http://cran.r-project.org/bin/windows/base/R-2.4.1pat-win32.exe
http://cran.r-project.org/bin/windows/base/R-2.5.0dev-win32.exe

Neither of them loads under wine. I am inclined to fix wine itself
rather than requiring changes in mingw or R to cope. So as a first
thing I'd like to try build the older 2.4.0 with the new tools (this is 
not a request for help - I think I'll try the cross-tools myself) - 
because that should eliminate any possibillity that some newly added 
code triggers difference between wine and real windows.

I'd like to know one thing though - was there any specific reason for
the mingw upgrade after 2.4.0, or was it just a routine
latest-is-greatest upgrade?

Hin-Tak

<snipped>


From ripley at stats.ox.ac.uk  Fri Jan 12 15:51:48 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Jan 2007 14:51:48 +0000 (GMT)
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A79EB8.8010606@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>

On Fri, 12 Jan 2007, Hin-Tak Leung wrote:

> I'd like to know one thing though - was there any specific reason for
> the mingw upgrade after 2.4.0, or was it just a routine
> latest-is-greatest upgrade?

There are specific requirements: from the CHANGES file

2.4.0:

mingw-runtime >= 3.10 is required to build R (a bug fix in the handling
of MBCS code is required).  This is enforced by a check in building
Rpwd.exe.

2.5.0-to-be:

mingw-runtime >= 3.11 is needed to build R.

[There are multiple reasons, but one is that isblank is missing in earlier 
versions.]

I am almost certain that I have build R 2.4.1 with mingw-runtime 3.10.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 12 18:04:19 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 12 Jan 2007 17:04:19 +0000
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
Message-ID: <45A7BF93.1090109@cimr.cam.ac.uk>

Prof Brian Ripley wrote:
> On Fri, 12 Jan 2007, Hin-Tak Leung wrote:
> 
>> I'd like to know one thing though - was there any specific reason for
>> the mingw upgrade after 2.4.0, or was it just a routine
>> latest-is-greatest upgrade?
> 
> There are specific requirements: from the CHANGES file
> 
> 2.4.0:
> 
> mingw-runtime >= 3.10 is required to build R (a bug fix in the handling
> of MBCS code is required).  This is enforced by a check in building
> Rpwd.exe.

Argh... MBCS. I tried running wine with debug on,
( WINEDEBUG=+relay wine Rgui.exe 2>&1 ) and it shows that just before 
2.4.1/2.5dev crashes, R tried to called strlen() and strchr() on
"Error: invalid multibyte string" in ntdll.

Call ntdll.strlen(6c9a0a80 "Error: invalid multibyte string\n") ret=6c9150bd
Call ntdll.strchr(00e192e0 "Error: invalid multibyte string\n",0000000a) 
ret=6c704ec0

It might be bogus, but the same trace is not found in
WINEDEBUG=+relay wine Rgui.exe 2>&1
with R 2.4.0 .

Can I have a svn revision number for the MBCS change please? It
should probably be the first thing I look at, as soon as I get
my cross-compile tools up to date... thanks a lot.

Hin-Tak

> 
> 2.5.0-to-be:
> 
> mingw-runtime >= 3.11 is needed to build R.
> 
> [There are multiple reasons, but one is that isblank is missing in 
> earlier versions.]
> 
> I am almost certain that I have build R 2.4.1 with mingw-runtime 3.10.
>


From ripley at stats.ox.ac.uk  Fri Jan 12 18:20:55 2007
From: ripley at stats.ox.ac.uk (Brian Ripley)
Date: Fri, 12 Jan 2007 17:20:55 +0000 (GMT)
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A7BF93.1090109@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
	<45A7BF93.1090109@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701121714001.18003@auk.stats>

On Fri, 12 Jan 2007, Hin-Tak Leung wrote:

> Prof Brian Ripley wrote:
>> On Fri, 12 Jan 2007, Hin-Tak Leung wrote:
>> 
>>> I'd like to know one thing though - was there any specific reason for
>>> the mingw upgrade after 2.4.0, or was it just a routine
>>> latest-is-greatest upgrade?
>> 
>> There are specific requirements: from the CHANGES file
>> 
>> 2.4.0:
>> 
>> mingw-runtime >= 3.10 is required to build R (a bug fix in the handling
>> of MBCS code is required).  This is enforced by a check in building
>> Rpwd.exe.
>
> Argh... MBCS. I tried running wine with debug on,
> ( WINEDEBUG=+relay wine Rgui.exe 2>&1 ) and it shows that just before 
> 2.4.1/2.5dev crashes, R tried to called strlen() and strchr() on
> "Error: invalid multibyte string" in ntdll.
>
> Call ntdll.strlen(6c9a0a80 "Error: invalid multibyte string\n") ret=6c9150bd
> Call ntdll.strchr(00e192e0 "Error: invalid multibyte string\n",0000000a) 
> ret=6c704ec0
>
> It might be bogus, but the same trace is not found in
> WINEDEBUG=+relay wine Rgui.exe 2>&1
> with R 2.4.0 .

What locale are you in?  Running R under WINE in a multibyte Linux locale 
may not work, depending on how WINE handles it.


> Can I have a svn revision number for the MBCS change please? It

You could do what I had to do, svn blame src/gnuwin32/CHANGES, which 
points to r38776.  The log on developer.r-project.org shows

r38776 | ripley | 2006-08-03 04:49:43 -0400 (Thu, 03 Aug 2006) | 1 line
Changed paths:
    M /trunk/src/gnuwin32/CHANGES
    M /trunk/src/gnuwin32/Makefile
    M /trunk/src/gnuwin32/front-ends/rpwd.c
    D /trunk/src/gnuwin32/wcrtomb.c

require mingw-runtime-3.10

so it looks like we deleted a patched version once my bug report on mingw 
had worked through.  Note, pre-2.4.0 as the extract shows.

> should probably be the first thing I look at, as soon as I get
> my cross-compile tools up to date... thanks a lot.
>
> Hin-Tak
>
>> 
>> 2.5.0-to-be:
>> 
>> mingw-runtime >= 3.11 is needed to build R.
>> 
>> [There are multiple reasons, but one is that isblank is missing in earlier 
>> versions.]
>> 
>> I am almost certain that I have build R 2.4.1 with mingw-runtime 3.10.
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From simon.urbanek at r-project.org  Fri Jan 12 18:42:20 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 12 Jan 2007 12:42:20 -0500
Subject: [Rd] cross tools (was Re: wine and build difference between
	R.2.4.0 and R 2.4.1 windows binaries?)
In-Reply-To: <45A77FB4.6020301@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
	<45A6584E.5030507@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>
	<45A77FB4.6020301@cimr.cam.ac.uk>
Message-ID: <6F0F0E99-8335-4E79-92F1-A569EA059D8B@r-project.org>


On Jan 12, 2007, at 7:31 AM, Hin-Tak Leung wrote:

> I do use Java, just not in relation to R - it has been a while  
> since I played with SJava. Sun's JDK (32-bit) has been working  
> consistently.
> On FC5 x86_64 the default gcj-based JRE was a bit funny, but since  
> upgraded to FC6, I found the gcj-based JRE on x86_64 can run  
> haploview  (http://www.broad.mit.edu/mpg/haploview/) reasonably  
> well. If you want 64-bit R working with a 64-bit JRE, the gcj-based  
> jre seems to be the only route.

For the record, rJava and JRI work fine with Sun's Java 1.6 on 64-bit  
systems (fine being defined by the fact that JGR works :)). JGC-based  
JRE is still quite buggy on both 32 and 64-bit machines as far as we  
can tell, but for non-GUI task it seems to work. However, I don't  
think this is what Brian has in mind ...

Cheers,
Simon



> I have built something involving JNI recently
> using the gcj-based jdk seems alright. (it did finish compilation
> - it is a suite of applications [http://gridengine.sunsource.net/],
> only a small part is JNI based and I don't know the specific
> part well enough to judge for an mis-compilation or
> broken functionality).
>
> Hin-Tak
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Fri Jan 12 19:07:43 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 12 Jan 2007 13:07:43 -0500
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A7BF93.1090109@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
	<45A7BF93.1090109@cimr.cam.ac.uk>
Message-ID: <45A7CE6F.2050103@stats.uwo.ca>

On 1/12/2007 12:04 PM, Hin-Tak Leung wrote:
> Prof Brian Ripley wrote:
>> On Fri, 12 Jan 2007, Hin-Tak Leung wrote:
>> 
>>> I'd like to know one thing though - was there any specific reason for
>>> the mingw upgrade after 2.4.0, or was it just a routine
>>> latest-is-greatest upgrade?
>> 
>> There are specific requirements: from the CHANGES file
>> 
>> 2.4.0:
>> 
>> mingw-runtime >= 3.10 is required to build R (a bug fix in the handling
>> of MBCS code is required).  This is enforced by a check in building
>> Rpwd.exe.
> 
> Argh... MBCS. I tried running wine with debug on,
> ( WINEDEBUG=+relay wine Rgui.exe 2>&1 ) and it shows that just before 
> 2.4.1/2.5dev crashes, R tried to called strlen() and strchr() on
> "Error: invalid multibyte string" in ntdll.
> 
> Call ntdll.strlen(6c9a0a80 "Error: invalid multibyte string\n") ret=6c9150bd
> Call ntdll.strchr(00e192e0 "Error: invalid multibyte string\n",0000000a) 
> ret=6c704ec0

That may be the error people were getting when running 2.4.0 in a 
Simplified Chinese locale, because one of the translation files had the 
wrong encoding.  See this message in CHANGES:

The Simplified Chinese menu messages were in the wrong format, causing
RGui to crash on startup. (PR#9277)

Duncan Murdoch

> 
> It might be bogus, but the same trace is not found in
> WINEDEBUG=+relay wine Rgui.exe 2>&1
> with R 2.4.0 .
> 
> Can I have a svn revision number for the MBCS change please? It
> should probably be the first thing I look at, as soon as I get
> my cross-compile tools up to date... thanks a lot.
> 
> Hin-Tak
> 
>> 
>> 2.5.0-to-be:
>> 
>> mingw-runtime >= 3.11 is needed to build R.
>> 
>> [There are multiple reasons, but one is that isblank is missing in 
>> earlier versions.]
>> 
>> I am almost certain that I have build R 2.4.1 with mingw-runtime 3.10.
>>


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 12 19:26:11 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 12 Jan 2007 18:26:11 +0000
Subject: [Rd] wine and build difference between R.2.4.0 and R 2.4.1
 windows binaries?
In-Reply-To: <45A7CE6F.2050103@stats.uwo.ca>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
	<45A7BF93.1090109@cimr.cam.ac.uk> <45A7CE6F.2050103@stats.uwo.ca>
Message-ID: <45A7D2C3.1050204@cimr.cam.ac.uk>

Duncan Murdoch wrote:
> On 1/12/2007 12:04 PM, Hin-Tak Leung wrote:
>> Prof Brian Ripley wrote:
>>> On Fri, 12 Jan 2007, Hin-Tak Leung wrote:
>>>
>>>> I'd like to know one thing though - was there any specific reason for
>>>> the mingw upgrade after 2.4.0, or was it just a routine
>>>> latest-is-greatest upgrade?
>>>
>>> There are specific requirements: from the CHANGES file
>>>
>>> 2.4.0:
>>>
>>> mingw-runtime >= 3.10 is required to build R (a bug fix in the handling
>>> of MBCS code is required).  This is enforced by a check in building
>>> Rpwd.exe.
>>
>> Argh... MBCS. I tried running wine with debug on,
>> ( WINEDEBUG=+relay wine Rgui.exe 2>&1 ) and it shows that just before 
>> 2.4.1/2.5dev crashes, R tried to called strlen() and strchr() on
>> "Error: invalid multibyte string" in ntdll.
>>
>> Call ntdll.strlen(6c9a0a80 "Error: invalid multibyte string\n") 
>> ret=6c9150bd
>> Call ntdll.strchr(00e192e0 "Error: invalid multibyte 
>> string\n",0000000a) ret=6c704ec0
> 
> That may be the error people were getting when running 2.4.0 in a 
> Simplified Chinese locale, because one of the translation files had the 
> wrong encoding.  See this message in CHANGES:
> 
> The Simplified Chinese menu messages were in the wrong format, causing
> RGui to crash on startup. (PR#9277)


2.4.0 works and 2.4.1/2.5dev crashes, all on the same machine with
the same version of wine in en_GB.UTF-8 locale.

export |grep 'LANG'
declare -x LANG="en_GB.UTF-8"

I found all 3 versions of Rgui.exe hangs (and not crashes) if I run
wine under LANG=C .

I think it would be most interesting to try building the older 2.4.0
with newer mingw - that would distinguish whether it is code change
in R or change in mingw. (I'll give this a try in the next few days).

Hin-Tak


> 
> Duncan Murdoch
> 
>>
>> It might be bogus, but the same trace is not found in
>> WINEDEBUG=+relay wine Rgui.exe 2>&1
>> with R 2.4.0 .
>>
>> Can I have a svn revision number for the MBCS change please? It
>> should probably be the first thing I look at, as soon as I get
>> my cross-compile tools up to date... thanks a lot.
>>
>> Hin-Tak
>>
>>>
>>> 2.5.0-to-be:
>>>
>>> mingw-runtime >= 3.11 is needed to build R.
>>>
>>> [There are multiple reasons, but one is that isblank is missing in 
>>> earlier versions.]
>>>
>>> I am almost certain that I have build R 2.4.1 with mingw-runtime 3.10.
>>>
>


From ellis at stat.harvard.edu  Fri Jan 12 20:18:02 2007
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Fri, 12 Jan 2007 11:18:02 -0800
Subject: [Rd] Perhaps a stupid question about clipboards....
In-Reply-To: <Pine.LNX.4.64.0701120854320.1756@gannet.stats.ox.ac.uk>
References: <7098abec0701102125p7c5b7dd5rf66598c9b8bddc29@mail.gmail.com>
	<17829.61495.797997.327193@stat.math.ethz.ch>
	<7098abec0701111649y56ab88b8p749f22b926b427c3@mail.gmail.com>
	<Pine.LNX.4.64.0701120854320.1756@gannet.stats.ox.ac.uk>
Message-ID: <7098abec0701121118w535cb302iefbbb222f9e7784e@mail.gmail.com>

On 1/12/07, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> On Thu, 11 Jan 2007, Byron Ellis wrote:
>
>
> X11 has two, and with an extension three, and all can be accessed via
> file().

OS X supports arbitrarily and even uniquely named pasteboards (for use
as an IPC mechanism). I suppose a URI-esque "clipboard://" structure
could be used to figure out what you mean with "clipboard" pointing to
the "general" pasteboard.

>
> That is because no one has contributed it.  Please do so yourself.
> When you do, please bear in the mind the convenience factor I pointed out
> earlier in this thread.

That's probably because accessing the clipboard/pasteboards without
access to Objective-C is not documented and may not even be possible
(pbpaste and friends link the Objective-C frameworks to get the job
done). I saw that ObjC compiling has been added to R-devel so it may
now be not so bad...

>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 12 21:05:10 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 12 Jan 2007 20:05:10 +0000
Subject: [Rd] Java on 64-bin Linux [was: cross tools (was Re: wine and
 build difference between R.2.4.0 and R 2.4.1 windows binaries?)]
In-Reply-To: <3BF165D3-DFCA-480E-87D2-6FCAE85FF4E4@r-project.org>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
	<45A6584E.5030507@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>
	<45A77FB4.6020301@cimr.cam.ac.uk>
	<6F0F0E99-8335-4E79-92F1-A569EA059D8B@r-project.org>
	<Pine.LNX.4.64.0701121746030.29011@gannet.stats.ox.ac.uk>
	<45A7D414.40808@cimr.cam.ac.uk>
	<3BF165D3-DFCA-480E-87D2-6FCAE85FF4E4@r-project.org>
Message-ID: <45A7E9F6.5020703@cimr.cam.ac.uk>

Simon Urbanek wrote:
> 
> On Jan 12, 2007, at 1:31 PM, Hin-Tak Leung wrote:
> 
>> Prof Brian Ripley wrote:
>>> On Fri, 12 Jan 2007, Simon Urbanek wrote:
>>>>
>>>> On Jan 12, 2007, at 7:31 AM, Hin-Tak Leung wrote:
>>>>
>>>>> I do use Java, just not in relation to R - it has been a while 
>>>>> since I played with SJava. Sun's JDK (32-bit) has been working 
>>>>> consistently.
>>>>> On FC5 x86_64 the default gcj-based JRE was a bit funny, but since 
>>>>> upgraded to FC6, I found the gcj-based JRE on x86_64 can run 
>>>>> haploview (http://www.broad.mit.edu/mpg/haploview/) reasonably 
>>>>> well. If you want 64-bit R working with a 64-bit JRE, the gcj-based 
>>>>> jre seems to be the only route.
>>>>
>>>> For the record, rJava and JRI work fine with Sun's Java 1.6 on 
>>>> 64-bit systems (fine being defined by the fact that JGR works :)). 
>>>> JGC-based JRE is still quite buggy on both 32 and 64-bit machines as 
>>>> far as we can tell, but for non-GUI task it seems to work. However, 
>>>> I don't think this is what Brian has in mind ...
>>> Sun's Java 1.6 does not run JGR or rJava on our FC5 Opteron boxes 
>>> unfortunately, which is behind my comment.  (It gives the same 
>>> problems as 1.5.0_x, which Simon also had)  An essentially identical 
>>> i686 installation (same set of FC5 RPMs) does run rJava etc.  We did 
>>> manage to get a Blackdown version of Java 1.4.2 to start rJava, but 
>>> it soon crashed.
>>
>> haploview is GUI and it does run alright-ish under the gcj-based jre 
>> under FC6. I know gcj is not as mature as blackdown or Sun's ; but 
>> given Sun's is 32-bit only, and gcj is shipped with FC6... and yes, 
>> gcj on FC5 was a bit funny.
>>
> 
> I'm running everything on Debian etch (=testing) and they are usually up 
> to date. GIJ/GCJ/GNU classpath have made astonishing progress, but they 
> are still not ready for the  prime-time. Swing & co. are just too 
> complex to have a bullet-proof implementation - even Sun took years to 
> come even close to an usable implementation ..

I don't intend to start a distribution war, but I found Debian testing
too *conservative* during my 1-week trial of Debian a couple of
years ago, and opted for Debian unstable almost right away. (and I try 
to avoid Debian/Debian hang-outs - too many egos and bickering and
just not getting anything done). Debian stable is a joke for a fossil.

As for "not ready for prime-time" and the other comments
- nothing is ready for prime time if nothing ever get tested/used.
I only disguish between usable and not-usable. FWIW, I work with
some people who describe R as not ready for prime-time as well :-P.

And you can also discard Wine as "windows is too complex to have
a bullet-proof implementation, even Microsoft took years to come even 
close to an usable implementation"...

Given that JNI with GCJ on FC6 does work with a reasonably complex
piece of software (gridengine.sunsource.net), and the GUI components 
does work with a fairly graphically-rich piece of software
(haploview), I'd say it is worth giving gcj is try. After all,
nothing is ready for prime-time if nothing ever get used/tested -
and it applies as much to GCJ as it is for R.

Just my 2-cents.

Hin-Tak


From alexandrarma at yahoo.com.br  Fri Jan 12 19:35:32 2007
From: alexandrarma at yahoo.com.br (alexandrarma at yahoo.com.br)
Date: Fri, 12 Jan 2007 19:35:32 +0100 (CET)
Subject: [Rd] Package is not on the repository (PR#9450)
Message-ID: <20070112183532.E3FDF572C7@slim.kubism.ku.dk>

Full_Name: Alexandra R Mendes de Almeida
Version: 2.4.1
OS: Linux
Submission from: (NULL) (201.51.225.154)


R-Masters

The packahe SGAx is not on the repository.
See the message returned by R when i tried to install it:

> install.packages("SAGx")
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
Warning in download.packages(unique(pkgs), destdir = tmpd, available =
available,  :
         no package 'SAGx' at the repositories

Please, could you fix it?!
Thank you very much!!!

Alexandra Almeida


From jraponte77 at yahoo.com  Thu Jan 11 01:43:59 2007
From: jraponte77 at yahoo.com (jraponte77 at yahoo.com)
Date: Thu, 11 Jan 2007 01:43:59 +0100 (CET)
Subject: [Rd] R 2.4.0 on Solaris 10 (PR#9441)
Message-ID: <20070111004359.7E22454A7F@slim.kubism.ku.dk>

Full_Name: Ricardo Aponte
Version: R 2.4.0
OS: Solaris 10
Submission from: (NULL) (200.71.37.195)


Hello   

I'm having trouble building R under Unix. I've searched for information about it
on google or the R database but I didn't find any answer on my problem. I would
be thankful if somebody could help me working that out. 

./configure  

R is now configured for sparc-sun-solaris2.10

  Source directory:          .
  Installation directory:    /usr/local

  C compiler:                gcc  -g -O2 -std=gnu99
  Fortran 77 compiler:       g77  -g -O2

  C++ compiler:              g++  -g -O2
  Fortran 90/95 compiler:    g77 -g -O2

  Interfaces supported:      X11
  External libraries:
  Additional capabilities:   PNG, JPEG, NLS
  Options enabled:           shared BLAS, R profiling

  Recommended packages:      yes

configure: WARNING: you cannot build DVI versions of the R manuals
configure: WARNING: you cannot build PDF versions of the R manuals


and output for make command

make[3]: Leaving directory `/datos/java/temp/R-2.4.0/src/main'
make[3]: Entering directory `/datos/java/temp/R-2.4.0/src/main'
gcc  -L/opt/SUNWmlib/lib -L/opt/SUNWmlib/lib/sparcv9 -o R.bin Rmain.o
CConverters.o CommandLineArgs.o Rdynload.o Renviron.o RNG.o apply.o arithmetic.o
apse.o array.o attrib.o base.o bind.o builtin.o character.o coerce.o colors.o
complex.o connections.o context.o cov.o cum.o dcf.o datetime.o debug.o deparse.o
deriv.o dotcode.o dounzip.o dstruct.o duplicate.o engine.o envir.o errors.o
eval.o format.o fourier.o gevents.o gram.o gram-ex.o graphics.o identical.o
internet.o iosupport.o lapack.o list.o localecharset.o logic.o main.o mapply.o
match.o memory.o model.o names.o objects.o optim.o optimize.o options.o par.o
paste.o pcre.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o
printvector.o printutils.o qsort.o random.o regex.o registration.o relop.o
rlocale.o saveload.o scan.o seq.o serialize.o size.o sort.o source.o split.o
sprintf.o startup.o subassign.o subscript.o subset.o summary.o sysutils.o
unique.o util.o version.o vfonts.o xxxpr.o  mkdtemp.o  ../unix/libunix.a
./appl/libappl.a ../nmath/libnmath.a -L../../lib -lRblas -lg2c -lm -lgcc_s 
./extra/zlib/libz.a ../extra/bzip2/libbz2.a ../extra/pcre/libpcre.a 
./extra/intl/libintl.a  -lnsl -lsocket -ldl -lm
Undefined                       first referenced
 symbol                             in file
__builtin_isnan                     arithmetic.o
ld: fatal: Symbol referencing errors. No output written to R.bin
collect2: ld returned 1 exit status
make[3]: *** [R.bin] Error 1
make[3]: Leaving directory `/datos/java/temp/R-2.4.0/src/main'
make[2]: *** [R] Error 2
make[2]: Leaving directory `/datos/java/temp/R-2.4.0/src/main'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/datos/java/temp/R-2.4.0/src'
make: *** [R] Error 1


From polzehl at pubhealth.ku.dk  Fri Jan 12 18:49:43 2007
From: polzehl at pubhealth.ku.dk (polzehl at pubhealth.ku.dk)
Date: Fri, 12 Jan 2007 18:49:43 +0100 (CET)
Subject: [Rd] incorrect result of deriv (PR#9449)
Message-ID: <20070112174943.12AB43F03B@slim.kubism.ku.dk>

Full_Name: Joerg Polzehl
Version: 2.3.1
OS: x86_64, linux-gnu
Submission from: (NULL) (62.141.176.22)


I observed an incorrect behavior of function deriv when evaluating arguments of
dnorm

deriv(~dnorm(z,0,s),"z")
expression({
    .value <- dnorm(z, 0, s)
    .grad <- array(0, c(length(.value), 1), list(NULL, c("z")))
    .grad[, "z"] <- -(z * dnorm(z))
    attr(.value, "gradient") <- .grad
    .value
})

deriv(~exp(-z^2/(2*s^2))/s/sqrt(2*pi),"z")
expression({
    .expr4 <- 2 * s^2
    .expr6 <- exp(-z^2/.expr4)
    .expr9 <- sqrt(2 * pi)
    .value <- .expr6/s/.expr9
    .grad <- array(0, c(length(.value), 1), list(NULL, c("z")))
    .grad[, "z"] <- -(.expr6 * (2 * z/.expr4)/s/.expr9)
    attr(.value, "gradient") <- .grad
    .value
})

should provide the same expression but

> eval(deriv(~exp(-z^2/(2*s^2))/s/sqrt(2*pi),"z"),list(z=1,s=2))
[1] 0.1760327
attr(,"gradient")
               z
[1,] -0.04400817

> eval(deriv(~dnorm(z,0,s),"z"),list(z=1,s=2))
[1] 0.1760327
attr(,"gradient")
              z
[1,] -0.2419707

provide different gradients ...


From ess28 at cornell.edu  Fri Jan 12 23:17:10 2007
From: ess28 at cornell.edu (Emmanuel Sharef)
Date: Fri, 12 Jan 2007 17:17:10 -0500
Subject: [Rd] Memory corruption in dynamically loaded code
Message-ID: <D5735DCF-9F91-4BBB-A37F-B1F06092804E@cornell.edu>

Hello,

I've compiled some Fortran code and dyn.loaded it into R as in the  
"Writing R Extensions" manual. The code receives four large arrays of  
doubles from R (size about 3000x3000), and runs through several loops  
with BLAS calls. However, I get a memory corruption error when  
running it -- the full output is attached at the end.

I've been trying to pinpoint and solve the problem, and two things  
seem odd to me: First, if I run the same code with a much smaller  
data set, so that the arrays are about 500x500 each, there are no  
problems (this seems to indicate that I'm not writing outside array  
bounds). Second, using the gdb debugger (with ddd frontend), I  
noticed that the error only occurs on the second pass through the  
main Fortran code loop, which should not be very different from the  
first. The crash occurs during a call to the BLAS routine DSYR.

I've been trying to replicate the problem in a smaller code snippet  
for posting to the list, but haven't had any luck so far. Perhaps  
there are some ideas based on the output?

This is with R 2.4.1 on Ubuntu, and also occurs with R 2.4.1 on Mac  
OS X (gcc 3.4.6 and 3.4.2 respectively).

Many thanks,
Emmanuel

*** glibc detected *** /usr/lib/R/bin/exec/R: malloc(): memory  
corruption: 0xb7c42480 ***
======= Backtrace: =========
/lib/tls/i686/cmov/libc.so.6[0xb7b781cd]
/lib/tls/i686/cmov/libc.so.6(malloc+0x7f)[0xb7b7983f]
/usr/lib/atlas/sse2/libblas.so.3(ATL_dsyr+0x7f)[0xb77ec16f]
======= Memory map: ========
08048000-08049000 r-xp 00000000 08:03 967805     /usr/lib/R/bin/exec/R
08049000-0804a000 rw-p 00000000 08:03 967805     /usr/lib/R/bin/exec/R
0804a000-08d74000 rw-p 0804a000 00:00 0          [heap]
93600000-93621000 rw-p 93600000 00:00 0
93621000-93700000 ---p 93621000 00:00 0
937bb000-b6f74000 rw-p 937bb000 00:00 0
b6f74000-b70aa000 r-xp 00000000 08:03 967808     /usr/lib/R/lib/ 
libRlapack.so
b70aa000-b70ab000 rw-p 00136000 08:03 967808     /usr/lib/R/lib/ 
libRlapack.so
b70ab000-b716e000 rw-p b70ab000 00:00 0
b716e000-b71cd000 r-xp 00000000 08:03 983801     /usr/lib/R/library/ 
stats/libs/stats.so
b71cd000-b71cf000 rw-p 0005e000 08:03 983801     /usr/lib/R/library/ 
stats/libs/stats.so
b71cf000-b723d000 rw-p b71cf000 00:00 0
b723d000-b725b000 r-xp 00000000 08:03 983477     /usr/lib/R/library/ 
grDevices/libs/grDevices.so
b725b000-b725c000 rw-p 0001e000 08:03 983477     /usr/lib/R/library/ 
grDevices/libs/grDevices.so
b725c000-b7265000 r-xp 00000000 08:03 967490     /lib/tls/i686/cmov/ 
libnss_files-2.4.so
b7265000-b7267000 rw-p 00008000 08:03 967490     /lib/tls/i686/cmov/ 
libnss_files-2.4.so
b7267000-b726f000 r-xp 00000000 08:03 967494     /lib/tls/i686/cmov/ 
libnss_nis-2.4.so
b726f000-b7271000 rw-p 00007000 08:03 967494     /lib/tls/i686/cmov/ 
libnss_nis-2.4.so
b7271000-b7283000 r-xp 00000000 08:03 967484     /lib/tls/i686/cmov/ 
libnsl-2.4.so
b7283000-b7285000 rw-p 00011000 08:03 967484     /lib/tls/i686/cmov/ 
libnsl-2.4.so
b7285000-b7287000 rw-p b7285000 00:00 0
b7287000-b728e000 r-xp 00000000 08:03 967486     /lib/tls/i686/cmov/ 
libnss_compat-2.4.so
b728e000-b7290000 rw-p 00006000 08:03 967486     /lib/tls/i686/cmov/ 
libnss_compat-2.4.so
b7293000-b7296000 r-xp 00000000 00:15 265        /media/mac/rd2.so
b7296000-b7297000 rw-p 00002000 00:15 265        /media/mac/rd2.so
b7297000-b729d000 r-xp 00000000 08:03 984591     /usr/lib/R/library/ 
methods/libs/methods.so
b729d000-b729e000 rw-p 00005000 08:03 984591     /usr/lib/R/library/ 
methods/libs/methods.so
b729e000-b729f000 r-xp 00000000 08:03 901812     /usr/lib/gconv/ 
ISO8859-1.so
b729f000-b72a1000 rw-p 00001000 08:03 901812     /usr/lib/gconv/ 
ISO8859-1.so
b72a1000-b72e2000 rw-p b72a1000 00:00 0
b72e2000-b72e3000 r--p 00000000 08:03 985193     /usr/share/R/share/ 
locale/en/LC_MESSAGES/R.mo
b72e3000-b7316000 rw-p b72e3000 00:00 0
b7316000-b73ed000 r--p 00000000 08:03 969067     /usr/lib/locale/ 
en_US.utf8/LC_COLLATE
b73ed000-b7420000 r--p 00000000 08:03 969068     /usr/lib/locale/ 
en_US.utf8/LC_CTYPE
b7420000-b7422000 rw-p b7420000 00:00 0
b7422000-b7459000 r-xp 00000000 08:03 933965     /lib/libncurses.so.5.5
b7459000-b7461000 rw-p 00037000 08:03 933965     /lib/libncurses.so.5.5
b7461000-b7462000 rw-p b7461000 00:00 0
b7462000-b7464000 r-xp 00000000 08:03 967479     /lib/tls/i686/cmov/ 
libdl-2.4.so
b7464000-b7466000 rw-p 00001000 08:03 967479     /lib/tls/i686/cmov/ 
libdl-2.4.so
b7466000-b7479000 r-xp 00000000 08:03 870346     /usr/lib/libz.so.1.2.3
b7479000-b747a000 rw-p 00012000 08:03 870346     /usr/lib/libz.so.1.2.3
b747a000-b7489000 r-xp 00000000 08:03 933929     /lib/libbz2.so.1.0.3
b7489000-b748a000 rw-p 0000f000 08:03 933929     /lib/libbz2.so.1.0.3
b748a000-b748b000 rw-p b748a000 00:00 0
b748b000-b74a2000 r-xp 00000000 08:03 870020     /usr/lib/libpcre.so. 
3.12.0
b74a2000-b74b9000 rw-p 00016000 08:03 870020     /usr/lib/libpcre.so. 
3.12.0
b74b9000-b74e2000 r-xp 00000000 08:03 933997     /lib/libreadline.so.5.1
b74e2000-b74e6000 rw-p 00029000 08:03 933997     /lib/libreadline.so.5.1
b74e6000-b74e7000 rw-p b74e6000 00:00 0
b74e7000-b74f1000 r-xp 00000000 08:03 933955     /lib/libgcc_s.so.1
b74f1000-b74f2000 rw-p 00009000 08:03 933955     /lib/libgcc_s.so.1
b74f2000-b7516000 r-xp 00000000 08:03 967481     /lib/tls/i686/cmov/ 
libm-2.4.so
b7516000-b7518000 rw-p 00023000 08:03 967481     /lib/tls/i686/cmov/ 
libm-2.4.so
b7518000-b7531000 r-xp 00000000 08:03 869976     /usr/lib/libg2c.so. 
0.0.0
b7531000-b7532000 rw-p 00019000 08:03 869976     /usr/lib/libg2c.so. 
0.0.0
b7532000-b753f000 rw-p b7532000 00:00 0
b753f000-b7b0b000 r-xp 00000000 08:03 1478971    /usr/lib/atlas/sse2/ 
libblas.so.3.0
b7b0b000-b7b10000 rw-p 005cc000 08:03 1478971    /usr/lib/atlas/sse2/ 
libblas.so.3.0
b7b10000-b7b11000 rw-p b7b10000 00:00 0
b7b11000-b7c3e000 r-xp 00000000 08:03 967473     /lib/tls/i686/cmov/ 
libc-2.4.so
b7c3e000-b7c40000 r--p 0012c000 08:03 967473     /lib/tls/i686/cmov/ 
libc-2.4.so
b7c40000-b7c42000 rw-p 0012e000 08:03 967473     /lib/tls/i686/cmov/ 
libc-2.4.so
b7c42000-b7c45000 rw-p b7c42000 00:00 0
b7c47000-b7c48000 r--p 00000000 08:03 969070     /usr/lib/locale/ 
en_US.utf8/LC_MEASUREMENT
b7c48000-b7c49000 r--p 00000000 08:03 969074     /usr/lib/locale/ 
en_US.utf8/LC_PAPER
b7c49000-b7c4a000 r--p 00000000 08:03 969071     /usr/lib/locale/ 
en_US.utf8/LC_MONETARY
b7c4a000-b7c4b000 r--p 00000000 08:03 969076     /usr/lib/locale/ 
en_US.utf8/LC_TIME
b7c4b000-b7c52000 r--s 00000000 08:03 901864     /usr/lib/gconv/gconv- 
modules.cache
b7c52000-b7c53000 r--p 00000000 08:03 999466     /usr/lib/locale/ 
en_US.utf8/LC_MESSAGES/SYS_LC_MESSAGES
b7c53000-b7e7e000 r-xp 00000000 08:03 967807     /usr/lib/R/lib/libR.so
b7e7e000-b7e8b000 rw-p 0022a000 08:03 967807     /usr/lib/R/lib/libR.so
b7e8b000-b7f24000 rw-p b7e8b000 00:00 0
b7f24000-b7f3d000 r-xp 00000000 08:03 933910     /lib/ld-2.4.so
b7f3d000-b7f3f000 rw-p 00018000 08:03 933910     /lib/ld-2.4.so
bfae6000-bfb71000 rwxp bfae6000 00:00 0          [stack]
bfb71000-bfb74000 rw-p bfb71000 00:00 0
ffffe000-fffff000 ---p 00000000 00:00 0          [vdso]
Aborted (core dumped)


From smckinney at bccrc.ca  Fri Jan 12 23:18:10 2007
From: smckinney at bccrc.ca (Steven McKinney)
Date: Fri, 12 Jan 2007 14:18:10 -0800
Subject: [Rd] Minor logical bug in rbind.data.frame ?
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0235FA8D@crcmail1.BCCRC.CA>


When attempting to merge 3 data frames, one of which has fewer columns
than the others, rbind.data.frame correctly refuses to perform the bind.
However, the error message given is a bit obscure due to a logical
bug in the match.names() internal function to rbind.data.frame.

Illustration:

## Three data frames with same column variable names:
> foo <- data.frame(v1 = c('a', 'b'), v2 = c(1, 2), v3 = ordered(c('x', 'y')))
> bar <- data.frame(v2 = c(3, 4), v3 = ordered(c('x', 'y')), v1 = c('c', 'd'))
> baz <- data.frame(v1 = c('a', 'e'), v2 = c(5, 6), v3 = ordered(c('x', 'z')))
> rbind(foo, bar, baz)
  v1 v2 v3
1  a  1  x
2  b  2  y
3  c  3  x
4  d  4  y
5  a  5  x
6  e  6  z
> ## All is fine.

## Third data frame has a different third column variable
> fifi <- data.frame(v1 = c('a', 'e'), v2 = c(9, 10), v4 = ordered(c('y', 'z')))
> rbind(foo, bar, fifi)
Error in match.names(clabs, names(xi)) : names do not match previous names:
	v4
> ## Output looks fine.

## Third data frame is missing a column.
> gaga <- data.frame(v1 = c('a', 'e'), v2 = c(7, 8))
> rbind(foo, bar, gaga)
Error in paste(nmi[nii == 0], collapse = ", ") : 
	object "nii" not found
In addition: Warning message:
longer object length
	is not a multiple of shorter object length in: clabs == nmi 
>


This somewhat cryptic error message results because the second portion
of the second if() test clause in the match.names() function is not
evaluated, as it is the second argument to function '&&' and the first
argument (length(nmi) == length(clabs)) evaluates to FALSE.  Thus variable
nii is not defined and the stop() command at the end of match.names()
throws an (unintended?) error.

If I switch the order of these two arguments to '&&' (see my
test function sm.rbind.data.frame below)  I get what
appears to be the intended output given an input data frame with a
missing column (relative to the prior data frames):

> sm.rbind.data.frame(foo, bar, gaga)
Error in match.names(clabs, names(xi)) : names do not match previous names:
	
In addition: Warning message:
longer object length
	is not a multiple of shorter object length in: clabs == nmi 



Is this a possible fix for rbind.data.frame, or would the changed order
break something else?


## Modified function handles all the above test cases properly
> sm.rbind.data.frame(foo, bar, baz)
  v1 v2 v3
1  a  1  x
2  b  2  y
3  c  3  x
4  d  4  y
5  a  5  x
6  e  6  z
> sm.rbind.data.frame(foo, bar, fifi)
Error in match.names(clabs, names(xi)) : names do not match previous names:
	v4
> sm.rbind.data.frame(foo, bar, gaga)
Error in match.names(clabs, names(xi)) : names do not match previous names:
	
In addition: Warning message:
longer object length
	is not a multiple of shorter object length in: clabs == nmi 
> 


### rbind.data.frame with modified match.names()
sm.rbind.data.frame <- 
function (..., deparse.level = 1) 
{
    match.names <- function(clabs, nmi) {
        if (all(clabs == nmi)) 
            NULL
### Switched order of args to '&&' in following if() test clause
        else if (all(nii <- match(nmi, 
            clabs, 0)) && length(nmi) == length(clabs)) {
            m <- pmatch(nmi, clabs, 0)
            if (any(m == 0)) 
                stop("names do not match previous names")
            m
        }
        else stop("names do not match previous names:\n\t", paste(nmi[nii == 
            0], collapse = ", "))
    }
    Make.row.names <- function(nmi, ri, ni, nrow) {
        if (nchar(nmi) > 0) {
            if (ni == 0) 
                character(0)
            else if (ni > 1) 
                paste(nmi, ri, sep = ".")
            else nmi
        }
        else if (nrow > 0 && identical(ri, 1:ni)) 
            as.integer(seq.int(from = nrow + 1, length = ni))
        else ri
    }
    allargs <- list(...)
    allargs <- allargs[sapply(allargs, length) > 0]
    n <- length(allargs)
    if (n == 0) 
        return(structure(list(), class = "data.frame", row.names = integer()))
    nms <- names(allargs)
    if (is.null(nms)) 
        nms <- character(length(allargs))
    cl <- NULL
    perm <- rows <- rlabs <- vector("list", n)
    nrow <- 0
    value <- clabs <- NULL
    all.levs <- list()
    for (i in 1:n) {
        xi <- allargs[[i]]
        nmi <- nms[i]
        if (is.matrix(xi)) 
            allargs[[i]] <- xi <- as.data.frame(xi)
        if (inherits(xi, "data.frame")) {
            if (is.null(cl)) 
                cl <- oldClass(xi)
            ri <- attr(xi, "row.names")
            ni <- length(ri)
            if (is.null(clabs)) 
                clabs <- names(xi)
            else {
                pi <- match.names(clabs, names(xi))
                if (!is.null(pi)) 
                  perm[[i]] <- pi
            }
            rows[[i]] <- seq.int(from = nrow + 1, length = ni)
            rlabs[[i]] <- Make.row.names(nmi, ri, ni, nrow)
            nrow <- nrow + ni
            if (is.null(value)) {
                value <- unclass(xi)
                nvar <- length(value)
                all.levs <- vector("list", nvar)
                has.dim <- logical(nvar)
                facCol <- logical(nvar)
                ordCol <- logical(nvar)
                for (j in 1:nvar) {
                  xj <- value[[j]]
                  if (!is.null(levels(xj))) {
                    all.levs[[j]] <- levels(xj)
                    facCol[j] <- TRUE
                  }
                  else facCol[j] <- is.factor(xj)
                  ordCol[j] <- is.ordered(xj)
                  has.dim[j] <- length(dim(xj)) == 2
                }
            }
            else for (j in 1:nvar) {
                xij <- xi[[j]]
                if (is.null(pi) || is.na(jj <- pi[[j]])) 
                  jj <- j
                if (facCol[jj]) {
                  if (length(lij <- levels(xij)) > 0) {
                    all.levs[[jj]] <- unique(c(all.levs[[jj]], 
                      lij))
                    ordCol[jj] <- ordCol[jj] & is.ordered(xij)
                  }
                  else if (is.character(xij)) 
                    all.levs[[jj]] <- unique(c(all.levs[[jj]], 
                      xij))
                }
            }
        }
        else if (is.list(xi)) {
            ni <- range(sapply(xi, length))
            if (ni[1] == ni[2]) 
                ni <- ni[1]
            else stop("invalid list argument: all variables should have the same length")
            rows[[i]] <- ri <- as.integer(seq.int(from = nrow + 
                1, length = ni))
            nrow <- nrow + ni
            rlabs[[i]] <- Make.row.names(nmi, ri, ni, nrow)
            if (length(nmi <- names(xi)) > 0) {
                if (is.null(clabs)) 
                  clabs <- nmi
                else {
                  tmp <- match.names(clabs, nmi)
                  if (!is.null(tmp)) 
                    perm[[i]] <- tmp
                }
            }
        }
        else if (length(xi) > 0) {
            rows[[i]] <- nrow <- nrow + 1
            rlabs[[i]] <- if (nchar(nmi) > 0) 
                nmi
            else as.integer(nrow)
        }
    }
    nvar <- length(clabs)
    if (nvar == 0) 
        nvar <- max(sapply(allargs, length))
    if (nvar == 0) 
        return(structure(list(), class = "data.frame", row.names = integer()))
    pseq <- 1:nvar
    if (is.null(value)) {
        value <- list()
        value[pseq] <- list(logical(nrow))
    }
    names(value) <- clabs
    for (j in 1:nvar) if (length(lij <- all.levs[[j]]) > 0) 
        value[[j]] <- factor(as.vector(value[[j]]), lij, ordered = ordCol[j])
    if (any(has.dim)) {
        rmax <- max(unlist(rows))
        for (i in (1:nvar)[has.dim]) if (!inherits(xi <- value[[i]], 
            "data.frame")) {
            dn <- dimnames(xi)
            rn <- dn[[1]]
            if (length(rn) > 0) 
                length(rn) <- rmax
            pi <- dim(xi)[2]
            length(xi) <- rmax * pi
            value[[i]] <- array(xi, c(rmax, pi), list(rn, dn[[2]]))
        }
    }
    for (i in 1:n) {
        xi <- unclass(allargs[[i]])
        if (!is.list(xi)) 
            if (length(xi) != nvar) 
                xi <- rep(xi, length.out = nvar)
        ri <- rows[[i]]
        pi <- perm[[i]]
        if (is.null(pi)) 
            pi <- pseq
        for (j in 1:nvar) {
            jj <- pi[j]
            xij <- xi[[j]]
            if (has.dim[jj]) {
                value[[jj]][ri, ] <- xij
                rownames(value[[jj]])[ri] <- rownames(xij)
            }
            else {
                value[[jj]][ri] <- if (is.factor(xij)) 
                  as.vector(xij)
                else xij
                if (!is.null(nm <- names(xij))) 
                  names(value[[jj]])[ri] <- nm
            }
        }
    }
    rlabs <- unlist(rlabs)
    if (any(duplicated(rlabs))) 
        rlabs <- make.unique(as.character(unlist(rlabs)), sep = "")
    if (is.null(cl)) {
        as.data.frame(value, row.names = rlabs)
    }
    else {
        class(value) <- cl
        attr(value, "row.names") <- rlabs
        value
    }
}






Steven McKinney

Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre

email: smckinney at bccrc.ca

tel: 604-675-8000 x7561

BCCRC
Molecular Oncology
675 West 10th Ave, Floor 4
Vancouver B.C. 
V5Z 1L3
Canada


From hpages at fhcrc.org  Fri Jan 12 23:52:59 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Fri, 12 Jan 2007 14:52:59 -0800
Subject: [Rd] R.INSTALL on Windows
Message-ID: <45A8114B.3020500@fhcrc.org>

Hi,

I'd like to point out a potential problem with the current R.INSTALL
directory created by 'R CMD INSTALL' when applied to a source package.

On Windows (and, AFAIK, only on Windows), 'R CMD INSTALL mypackage_1.0.0.tar.gz'
creates a temporary R.INSTALL directory in the current directory. This
directory is removed before the command terminates but only if it was
successful.

One inconvenient of this behaviour is that you can get a clash when you try to
build 2 Windows binary packages (with 'R CMD INSTALL --build') at the same time
in the same directory. I can circumvent the 00LOCK mechanism by providing
a different --library option to the 2 commands but, if I'm running the 2 commands
in the same directory, then they will be creating and using the same R.INSTALL.
Then, the first command who terminates will remove it and break the other command.

Is there an easy way to prevent this?

Is there any reason why R.INSTALL is not kept at the end of 'R CMD INSTALL',
or why 'R CMD INSTALL' doesn't use a package specific directory name
(e.g. R.INSTALL.mypackage) like 'R CMD check' does, or why it doesn't
use one of the "standard" temp places (defined by env. var. TMP or TMPDIR).

Thanks in advance!

Cheers,
H.


From Kurt.Hornik at wu-wien.ac.at  Sat Jan 13 10:18:39 2007
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Sat, 13 Jan 2007 10:18:39 +0100
Subject: [Rd] cross tools (was Re: wine and build difference
	between	R.2.4.0 and R 2.4.1 windows binaries?)
In-Reply-To: <6F0F0E99-8335-4E79-92F1-A569EA059D8B@r-project.org>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111358340.23502@gannet.stats.ox.ac.uk>
	<45A6584E.5030507@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701111546520.13776@gannet.stats.ox.ac.uk>
	<45A77FB4.6020301@cimr.cam.ac.uk>
	<6F0F0E99-8335-4E79-92F1-A569EA059D8B@r-project.org>
Message-ID: <17832.41967.443742.860112@mithrandir.hornik.net>

>>>>> Simon Urbanek writes:

> On Jan 12, 2007, at 7:31 AM, Hin-Tak Leung wrote:

>> I do use Java, just not in relation to R - it has been a while  
>> since I played with SJava. Sun's JDK (32-bit) has been working  
>> consistently.
>> On FC5 x86_64 the default gcj-based JRE was a bit funny, but since  
>> upgraded to FC6, I found the gcj-based JRE on x86_64 can run  
>> haploview  (http://www.broad.mit.edu/mpg/haploview/) reasonably  
>> well. If you want 64-bit R working with a 64-bit JRE, the gcj-based  
>> jre seems to be the only route.

> For the record, rJava and JRI work fine with Sun's Java 1.6 on 64-bit  
> systems (fine being defined by the fact that JGR works :)).

Well, RWeka works too, so things are really fine :-)

-k

> JGC-based  
> JRE is still quite buggy on both 32 and 64-bit machines as far as we  
> can tell, but for non-GUI task it seems to work. However, I don't  
> think this is what Brian has in mind ...

> Cheers,
> Simon



>> I have built something involving JNI recently
>> using the gcj-based jdk seems alright. (it did finish compilation
>> - it is a suite of applications [http://gridengine.sunsource.net/],
>> only a small part is JNI based and I don't know the specific
>> part well enough to judge for an mis-compilation or
>> broken functionality).
>> 
>> Hin-Tak
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.uni-dortmund.de  Sat Jan 13 12:19:25 2007
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat, 13 Jan 2007 12:19:25 +0100
Subject: [Rd] Package is not on the repository (PR#9450)
In-Reply-To: <20070112183532.E3FDF572C7@slim.kubism.ku.dk>
References: <20070112183532.E3FDF572C7@slim.kubism.ku.dk>
Message-ID: <45A8C03D.8060906@statistik.uni-dortmund.de>

Why do you submit a bug report? Please read the FAQs and learn what a 
bug is: If some *contributed* package is not available on CRAN, this is 
not a bug in R, but maybe of CRAN or the package maintainer or the 
package or ... *you*, because the was never intended to be there on CRAN!

Particularly, SAGx is a Bioconductor package:
http://bioconductor.org/packages/1.9/bioc/html/SAGx.html

Hence please look at the BioC repository and ask on the corresponding 
mailing list, in case there is really something wrong!

Uwe Ligges



alexandrarma at yahoo.com.br wrote:
> Full_Name: Alexandra R Mendes de Almeida
> Version: 2.4.1
> OS: Linux
> Submission from: (NULL) (201.51.225.154)
> 
> 
> R-Masters
> 
> The packahe SGAx is not on the repository.
> See the message returned by R when i tried to install it:
> 
>> install.packages("SAGx")
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> Warning in download.packages(unique(pkgs), destdir = tmpd, available =
> available,  :
>          no package 'SAGx' at the repositories
> 
> Please, could you fix it?!
> Thank you very much!!!
> 
> Alexandra Almeida
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.uni-dortmund.de  Sat Jan 13 12:22:47 2007
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat, 13 Jan 2007 12:22:47 +0100
Subject: [Rd] R 2.4.0 on Solaris 10 (PR#9441)
In-Reply-To: <20070111004359.7E22454A7F@slim.kubism.ku.dk>
References: <20070111004359.7E22454A7F@slim.kubism.ku.dk>
Message-ID: <45A8C107.3040108@statistik.uni-dortmund.de>

Please read the FAQs in order to learn what a bug is and how to report it.
Have you read the R Installation and Administration manual about details 
and quirks with your platform?
Please try the most recent version of R (which is 2.4.1), follow the 
details from the manual mentioned and ask again (but on the mailing list 
R-help rather than submitting a bug report!) if you still fail with the 
attempts to install R.

Uwe Ligges



jraponte77 at yahoo.com wrote:
> Full_Name: Ricardo Aponte
> Version: R 2.4.0
> OS: Solaris 10
> Submission from: (NULL) (200.71.37.195)
> 
> 
> Hello   
> 
> I'm having trouble building R under Unix. I've searched for information about it
> on google or the R database but I didn't find any answer on my problem. I would
> be thankful if somebody could help me working that out. 
> 
> ./configure  
> 
> R is now configured for sparc-sun-solaris2.10
> 
>   Source directory:          .
>   Installation directory:    /usr/local
> 
>   C compiler:                gcc  -g -O2 -std=gnu99
>   Fortran 77 compiler:       g77  -g -O2
> 
>   C++ compiler:              g++  -g -O2
>   Fortran 90/95 compiler:    g77 -g -O2
> 
>   Interfaces supported:      X11
>   External libraries:
>   Additional capabilities:   PNG, JPEG, NLS
>   Options enabled:           shared BLAS, R profiling
> 
>   Recommended packages:      yes
> 
> configure: WARNING: you cannot build DVI versions of the R manuals
> configure: WARNING: you cannot build PDF versions of the R manuals
> 
> 
> and output for make command
> 
> make[3]: Leaving directory `/datos/java/temp/R-2.4.0/src/main'
> make[3]: Entering directory `/datos/java/temp/R-2.4.0/src/main'
> gcc  -L/opt/SUNWmlib/lib -L/opt/SUNWmlib/lib/sparcv9 -o R.bin Rmain.o
> CConverters.o CommandLineArgs.o Rdynload.o Renviron.o RNG.o apply.o arithmetic.o
> apse.o array.o attrib.o base.o bind.o builtin.o character.o coerce.o colors.o
> complex.o connections.o context.o cov.o cum.o dcf.o datetime.o debug.o deparse.o
> deriv.o dotcode.o dounzip.o dstruct.o duplicate.o engine.o envir.o errors.o
> eval.o format.o fourier.o gevents.o gram.o gram-ex.o graphics.o identical.o
> internet.o iosupport.o lapack.o list.o localecharset.o logic.o main.o mapply.o
> match.o memory.o model.o names.o objects.o optim.o optimize.o options.o par.o
> paste.o pcre.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o
> printvector.o printutils.o qsort.o random.o regex.o registration.o relop.o
> rlocale.o saveload.o scan.o seq.o serialize.o size.o sort.o source.o split.o
> sprintf.o startup.o subassign.o subscript.o subset.o summary.o sysutils.o
> unique.o util.o version.o vfonts.o xxxpr.o  mkdtemp.o  ../unix/libunix.a
> ./appl/libappl.a ../nmath/libnmath.a -L../../lib -lRblas -lg2c -lm -lgcc_s 
> ./extra/zlib/libz.a ../extra/bzip2/libbz2.a ../extra/pcre/libpcre.a 
> ./extra/intl/libintl.a  -lnsl -lsocket -ldl -lm
> Undefined                       first referenced
>  symbol                             in file
> __builtin_isnan                     arithmetic.o
> ld: fatal: Symbol referencing errors. No output written to R.bin
> collect2: ld returned 1 exit status
> make[3]: *** [R.bin] Error 1
> make[3]: Leaving directory `/datos/java/temp/R-2.4.0/src/main'
> make[2]: *** [R] Error 2
> make[2]: Leaving directory `/datos/java/temp/R-2.4.0/src/main'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/datos/java/temp/R-2.4.0/src'
> make: *** [R] Error 1
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jorgnsn at lcd.uregina.ca  Fri Jan 12 22:52:27 2007
From: jorgnsn at lcd.uregina.ca (jorgnsn at lcd.uregina.ca)
Date: Fri, 12 Jan 2007 22:52:27 +0100 (CET)
Subject: [Rd] help.start()'s error redirection fails to hide mozilla's "No
	running window found" message (PR#9452)
Message-ID: <20070112215227.0A23D19A5F@slim.kubism.ku.dk>

Full_Name: John Jorgensen
Version: 2.4.0
OS: Solaris 9
Submission from: (NULL) (142.3.169.170)


This is not a serious problem, but while trying to understand some difficulties
that R had finding our copy of mozilla, I noticed that the browseURL() function
defined in help.start.R includes the lines:

    system(paste(browser, remoteCmd, "2>&1 >/dev/null ||",
                 browser, quotedUrl, "&"))

I assume the intent is to hide the "No running window found" or equivalent
message that the remoteCmd might print before trying to start a new instance of
the browser.  On  the shells I've tried, though, you need to reverse the order
of the redirections to achieve this, i.e.:  ">dev/null 2>&1" instead of "2>&1
>/dev/null".

Apologies if I've misunderstood your intent, or if there are other shells where
you need the order you've used.


From maechler at stat.math.ethz.ch  Sat Jan 13 14:02:37 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 13 Jan 2007 14:02:37 +0100
Subject: [Rd] help.start()'s error redirection fails to hide mozilla's
	"No running window found" message (PR#9452)
In-Reply-To: <20070112215227.0A23D19A5F@slim.kubism.ku.dk>
References: <20070112215227.0A23D19A5F@slim.kubism.ku.dk>
Message-ID: <17832.55405.459013.689604@stat.math.ethz.ch>

>>>>> "jorgnsn" == jorgnsn  <jorgnsn at lcd.uregina.ca>
>>>>>     on Fri, 12 Jan 2007 22:52:27 +0100 (CET) writes:

    jorgnsn> Full_Name: John Jorgensen
    jorgnsn> Version: 2.4.0
    jorgnsn> OS: Solaris 9
    jorgnsn> Submission from: (NULL) (142.3.169.170)


    jorgnsn> This is not a serious problem, but while trying to
    jorgnsn> understand some difficulties that R had finding our
    jorgnsn> copy of mozilla, I noticed that the browseURL()
    jorgnsn> function defined in help.start.R includes the
    jorgnsn> lines:

    jorgnsn> system(paste(browser, remoteCmd, "2>&1 >/dev/null ||",
    jorgnsn> browser, quotedUrl, "&"))

    jorgnsn> I assume the intent is to hide the "No running
    jorgnsn> window found" or equivalent message that the
    jorgnsn> remoteCmd might print before trying to start a new
    jorgnsn> instance of the browser.  On the shells I've tried,
    jorgnsn> though, you need to reverse the order of the
    jorgnsn> redirections to achieve this, i.e.: ">dev/null
    jorgnsn> 2>&1" instead of "2>&1 > /dev/null".

    jorgnsn> Apologies if I've misunderstood your intent, or if
    jorgnsn> there are other shells where you need the order
    jorgnsn> you've used.

I don't think there are. It looks like you are entirely right,
and we use the correct order "> /dev/null 2>&1" in quite a few
other places.

Thank you for the report.
Martin Maechler, ETH Zurich


From murdoch at stats.uwo.ca  Sat Jan 13 21:58:31 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 13 Jan 2007 15:58:31 -0500
Subject: [Rd] Working with Sweave:  inverse search?
Message-ID: <45A947F7.9080206@stats.uwo.ca>

The xdvi and yap DVI viewers allow inverse (aka reverse) search:  you 
click on a location in the output display, and your editor moves to the 
corresponding location in the input file.  yap at least also allows 
forward search, where you can have your editor tell it to location where 
a particular input line is displayed.

I would like something like this to work in Sweave files.  That is, I 
write an Sweave file and process it through to a .dvi in the previewer, 
then I click in a previewer and am taken to the original location in the 
Sweave file.

There seem to be two obstacles:  The latex I'm using (from MikTeX) 
doesn't give any way to indicate the original source file when the .tex 
comes out of Sweave, and Sweave doesn't keep track of the concordance 
between input lines and output lines.

Both of these are fixable, but it looks like a few hours work; has 
anyone done this already?

Duncan Murdoch


From dsamperi at DecisionSynergy.com  Sun Jan 14 02:20:39 2007
From: dsamperi at DecisionSynergy.com (Dominick Samperi)
Date: Sat, 13 Jan 2007 20:20:39 -0500
Subject: [Rd] FinancePack and The Mind of the Market
Message-ID: <45A98567.8070208@DecisionSynergy.com>

The C++ and R code that is part of the R packages
FinancePack and FractalPack may be of some interest
to users of QuantLib and/or R-sig-finance. There you
will find open source implementations of implied tree
construction, volatility surface calibration, credit
modeling, time series generation using multifractals and
other methods, agent-based simulations, Mandelbrot
set exploration, scale-free and random network
simulations, and a few other functions.

The underlying C++ code is NOT copyleft, and can
be incorporated into systems like QuantLib (for example)
under the terms of an Open Source License.

Some of this software was designed to complement my
paper titled "The Mind of the Market", where I develop
a neuroscientific viewpoint on finance practice. It can be
downloaded from http://ssrn.com/abstract=955023.

Please feel free (and obliged if you find this stuff useful) to send me
any feedback on the software and/or the paper that you might
have (especially the paper).

These packages were designed to serve as examples for
researchers and practitioners who want to provide
software illustrations of their work along with
paper publications, something that seems to be fairly
common in statistics, but not common enough in
other disciplines like finance.  The idea is to provide
a complete framework including a GUI to illustrate
your results and permit the user to experiment. The
wide availability of the open source R system makes
this more feasible. (The importance of this
for computational science is discussed under the topic
"reproducible research" at
http://www-stat.stanford.edu/~wavelab, for example).

The packages and associated documentation can be
downloaded from http://www.DecisionSynergy.com.
The document FinancePack.pdf describes both packages
and elaborates on the philosophy mentioned above. The
package RcppTemplate may be helpful for building an R
package around C++ code that implements your ideas.

See FinancePack.pdf for more info, and please read
"The Mind of the Market" and send me your thoughts...

Thanks,
Dominick


From murdoch at stats.uwo.ca  Sun Jan 14 19:54:20 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 14 Jan 2007 13:54:20 -0500
Subject: [Rd] Working with Sweave:  inverse search?
In-Reply-To: <45A947F7.9080206@stats.uwo.ca>
References: <45A947F7.9080206@stats.uwo.ca>
Message-ID: <45AA7C5C.7030402@stats.uwo.ca>

On 1/13/2007 3:58 PM, Duncan Murdoch wrote:
> The xdvi and yap DVI viewers allow inverse (aka reverse) search:  you 
> click on a location in the output display, and your editor moves to the 
> corresponding location in the input file.  yap at least also allows 
> forward search, where you can have your editor tell it to location where 
> a particular input line is displayed.
> 
> I would like something like this to work in Sweave files.  That is, I 
> write an Sweave file and process it through to a .dvi in the previewer, 
> then I click in a previewer and am taken to the original location in the 
> Sweave file.
> 
> There seem to be two obstacles:  The latex I'm using (from MikTeX) 
> doesn't give any way to indicate the original source file when the .tex 
> comes out of Sweave, and Sweave doesn't keep track of the concordance 
> between input lines and output lines.
> 
> Both of these are fixable, but it looks like a few hours work; has 
> anyone done this already?

I went ahead and wrote a prototype of this.  It works by having Sweave 
output a \special that contains the information necessary to patch the 
.dvi file so it points to the .Rnw rather than .tex source.  There's an 
R function that carries out the patching, after you run latex on the 
document.  Currently the patching runs pretty slowly, but I suspect if I 
rewrite it in C rather than R it would be acceptably fast.

If anyone has any interest in this, please let me know.

Duncan Murdoch


From antonio.fabio at gmail.com  Mon Jan 15 17:01:47 2007
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Mon, 15 Jan 2007 17:01:47 +0100
Subject: [Rd] [OT] old news on the home page
Message-ID: <b0808fdc0701150801p440ba6d2lf737e78d55baf207@mail.gmail.com>

Hi all.
I've noticed that on the R homepage:
http://www.r-project.org/
one can read, as the latest news:
" R version 2.4.0 has been released on 2006-10-03."
and can't find any citation of the 2.4.1 release of the last 18 december.

Bests,
Antonio.


From ahenningsen at email.uni-kiel.de  Mon Jan 15 17:23:14 2007
From: ahenningsen at email.uni-kiel.de (Arne Henningsen)
Date: Mon, 15 Jan 2007 17:23:14 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9444)
In-Reply-To: <45A7654F.90004@stats.uwo.ca>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
	<200701120826.36423.ahenningsen@agric-econ.uni-kiel.de>
	<45A7654F.90004@stats.uwo.ca>
Message-ID: <200701151723.14912.ahenningsen@email.uni-kiel.de>

On Friday, 12. January 2007 11:39, you wrote:
> [...]
> I think you misunderstood me, given the "long answer".  

Indeed, I misunderstood you. 

> We haven't 
> changed the way deparse() handles "/". The solution in R-devel is given
> below.

I prefer to use "keep.source=FALSE", because I generally like that Sweave 
takes the job to format the code chunks. Therefore, it would be great if 
Sweave is allowed to introduce line breaks after forward slashes, e.g. if 
deparse() adds a blank after a forward slash.
Please move this wish from "wishlst-fulfilled" to "wishlst".

Thanks,
Arne

>
> Duncan Murdoch

-- 
Arne Henningsen
Department of Agricultural Economics
University of Kiel
Olshausenstr. 40
D-24098 Kiel (Germany)
Tel: +49-431-880 4445
Fax: +49-431-880 1397
ahenningsen at agric-econ.uni-kiel.de
http://www.uni-kiel.de/agrarpol/ahenningsen/


From groemping at tfh-berlin.de  Mon Jan 15 18:02:32 2007
From: groemping at tfh-berlin.de (=?ISO-8859-1?Q?Ulrike_Gr=F6mping?=)
Date: Mon, 15 Jan 2007 18:02:32 +0100
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <20070115142934.M50535@tfh-berlin.de>
References: <20070115142934.M50535@tfh-berlin.de>
Message-ID: <20070115170148.M17385@tfh-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070115/823448e9/attachment.pl 

From murdoch at stats.uwo.ca  Mon Jan 15 18:44:54 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 15 Jan 2007 12:44:54 -0500
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
 (PR#9444)
In-Reply-To: <200701151723.14912.ahenningsen@email.uni-kiel.de>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>	<200701120826.36423.ahenningsen@agric-econ.uni-kiel.de>	<45A7654F.90004@stats.uwo.ca>
	<200701151723.14912.ahenningsen@email.uni-kiel.de>
Message-ID: <45ABBD96.6060505@stats.uwo.ca>

On 1/15/2007 11:23 AM, Arne Henningsen wrote:
> On Friday, 12. January 2007 11:39, you wrote:
>> [...]
>> I think you misunderstood me, given the "long answer".  
> 
> Indeed, I misunderstood you. 
> 
>> We haven't 
>> changed the way deparse() handles "/". The solution in R-devel is given
>> below.
> 
> I prefer to use "keep.source=FALSE", because I generally like that Sweave 
> takes the job to format the code chunks. Therefore, it would be great if 
> Sweave is allowed to introduce line breaks after forward slashes, e.g. if 
> deparse() adds a blank after a forward slash.
> Please move this wish from "wishlst-fulfilled" to "wishlst".

I don't think so.  If I thought it was a reasonable request, I'd do 
that, but it's not.  You have a perfectly general solution to your 
problem.  The fact that it isn't the one you want doesn't mean it needs 
to be listed as an outstanding issue in the bug reporting system.

Duncan Murdoch


From murdoch at stats.uwo.ca  Mon Jan 15 19:07:10 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 15 Jan 2007 13:07:10 -0500
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <20070115170148.M17385@tfh-berlin.de>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
Message-ID: <45ABC2CE.6030705@stats.uwo.ca>

On 1/15/2007 12:02 PM, Ulrike Gr?mping wrote:
> Dear R-developers,
> 
> the following may seem a weird question for R-devel ? I try anyway, because it 
> does seem to be related to usage of R and R's way of interacting with the 
> hardware.
> 
> When running R (2.4.0) on my new dual core Windows XP system (Intel Core 2 Duo 
> E6600, Mainboard ASUS P5B, BeQuiet Power Unit), I observe various types of 
> sounds (not related to fans) when running at full usage of at least one of the 
> cores.
> 
> The most annoying sound ? a high-pitched noise like a whine ? I have so far 
> observed running simulations in R only and couldn?t reproduce with any other 
> software (sometimes it?s also more a rustle than a whine, that one is not 
> disturbing). I can clearly track it down to particular instances of R ? as 
> soon as I left-click on a blue window bar in the affected R-Gui, the noise 
> stops (and there are sometimes other instances of R running in parallel which 
> are completely unrelated to the whine). I?ve also stopped R when the computer 
> just whined and started SAS, fully using the CPU as well ? no whine. Shut down 
> SAS, restart R ? whine again. Apparently, it can also be related to what 
> exactly R is doing at the particular moment. For example, I just discovered 
> that simulations of one type were finished, because the computer ? running 
> another simulation under full load on R in a quiet way ? started whining at 
> the moment it switched to the new type of simulation.
> 
> The hardware technician I?ve asked about this issue does not have any idea and 
> suspects R to do something peculiar that causes the noise. It?s not the 
> mainboards fault (that has already been changed for another reason, and the 
> behavior remains). I can?t definitely locate the source of the sound. I 
> suspect that it?s the Power Unit, but there are so many parts close together 
> that I am not really sure.
> 
> I do not know enough about interactions of R with hardware to know whether it 
> is even possible for anyone deeper into the matter to develop an idea what 
> could be behind this behavior. For the moment, I can get rid of the whine by 
> using the mainboard tool ?AI Gear? to reduce the processor?s speed from 2.4GHz 
> to 1.7GHz when I want to concentrate ? then the whine is gone (but the 
> simulation is slower).

I haven't heard this from R, but on occasion I've had noisy CPUs.  I 
suspect it's a case of some repetitive calculation leading to repetitive 
electric fields which happen to cause physical resonance of some part of 
your system.  That agrees with the observation that changing the speed
changed the noisiness.  Another way to get rid of it would be to change 
the contents of the loop:  make it run faster or slower and the noise 
should go away.

Duncan Murdoch

> 
> Does anyone have any idea ? or hints regarding what else I could think about ?
> 
> Regards, Ulrike
> 
> ****************************** 
> Prof. Dr. Ulrike Gr?mping 
> Fachbereich II 
> TFH Berlin 
> Luxemburger Str. 10 
> 13353 Berlin 
> mail: groemping at tfh-berlin.de 
> www: www.tfh-berlin.de/~groemp/ 
> ******************************
> 
> ------- End of Forwarded Message -------
> 
> ****************************** 
> Prof. Dr. Ulrike Gr?mping 
> Fachbereich II 
> TFH Berlin 
> Luxemburger Str. 10 
> 13353 Berlin 
> mail: groemping at tfh-berlin.de 
> www: www.tfh-berlin.de/~groemp/ 
> ******************************
> 
>  
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------------------------------------------------
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.uni-dortmund.de  Mon Jan 15 19:12:40 2007
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon, 15 Jan 2007 19:12:40 +0100
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <20070115170148.M17385@tfh-berlin.de>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
Message-ID: <45ABC418.4060303@statistik.uni-dortmund.de>

Ulrike,

It can happen that different types of simulations and programs can put 
load on different regions of the CPU and comsume different amounts of 
power or simply are causing different patterns in the power consumptions


Two things might cause the noise (at least, I have seen these things in 
Dortmund before), given in the order I would look at it at:

1. the power supply
2. some "Spule" (sorry folks, I don't know the english word) on the 
mainboard (in most of the cases ASUS is quite OK and does not produce 
such stuff)

If the former, buy a better one, if the latter, you can put some paper 
or part of old cloth around it.

Best,
Uwe



Ulrike Gr?mping wrote:
> Dear R-developers,
> 
> the following may seem a weird question for R-devel ? I try anyway, because it 
> does seem to be related to usage of R and R's way of interacting with the 
> hardware.
> 
> When running R (2.4.0) on my new dual core Windows XP system (Intel Core 2 Duo 
> E6600, Mainboard ASUS P5B, BeQuiet Power Unit), I observe various types of 
> sounds (not related to fans) when running at full usage of at least one of the 
> cores.
> 
> The most annoying sound ? a high-pitched noise like a whine ? I have so far 
> observed running simulations in R only and couldn?t reproduce with any other 
> software (sometimes it?s also more a rustle than a whine, that one is not 
> disturbing). I can clearly track it down to particular instances of R ? as 
> soon as I left-click on a blue window bar in the affected R-Gui, the noise 
> stops (and there are sometimes other instances of R running in parallel which 
> are completely unrelated to the whine). I?ve also stopped R when the computer 
> just whined and started SAS, fully using the CPU as well ? no whine. Shut down 
> SAS, restart R ? whine again. Apparently, it can also be related to what 
> exactly R is doing at the particular moment. For example, I just discovered 
> that simulations of one type were finished, because the computer ? running 
> another simulation under full load on R in a quiet way ? started whining at 
> the moment it switched to the new type of simulation.
> 
> The hardware technician I?ve asked about this issue does not have any idea and 
> suspects R to do something peculiar that causes the noise. It?s not the 
> mainboards fault (that has already been changed for another reason, and the 
> behavior remains). I can?t definitely locate the source of the sound. I 
> suspect that it?s the Power Unit, but there are so many parts close together 
> that I am not really sure.
> 
> I do not know enough about interactions of R with hardware to know whether it 
> is even possible for anyone deeper into the matter to develop an idea what 
> could be behind this behavior. For the moment, I can get rid of the whine by 
> using the mainboard tool ?AI Gear? to reduce the processor?s speed from 2.4GHz 
> to 1.7GHz when I want to concentrate ? then the whine is gone (but the 
> simulation is slower).
> 
> Does anyone have any idea ? or hints regarding what else I could think about ?
> 
> Regards, Ulrike
> 
> ****************************** 
> Prof. Dr. Ulrike Gr?mping 
> Fachbereich II 
> TFH Berlin 
> Luxemburger Str. 10 
> 13353 Berlin 
> mail: groemping at tfh-berlin.de 
> www: www.tfh-berlin.de/~groemp/ 
> ******************************
> 
> ------- End of Forwarded Message -------
> 
> ****************************** 
> Prof. Dr. Ulrike Gr?mping 
> Fachbereich II 
> TFH Berlin 
> Luxemburger Str. 10 
> 13353 Berlin 
> mail: groemping at tfh-berlin.de 
> www: www.tfh-berlin.de/~groemp/ 
> ******************************
> 
>  
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------------------------------------------------
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hin-tak.leung at cimr.cam.ac.uk  Mon Jan 15 19:49:35 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Mon, 15 Jan 2007 18:49:35 +0000
Subject: [Rd] mingw-cross with R 2.4.x Re: wine and build difference between
 R.2.4.0 and R 2.4.1 windows binaries?
In-Reply-To: <45A7D2C3.1050204@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk>
	<45A545B1.6070508@stats.uwo.ca>	<45A6250C.3020802@cimr.cam.ac.uk>
	<45A629E0.8090100@stats.uwo.ca>	<45A79EB8.8010606@cimr.cam.ac.uk>	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>	<45A7BF93.1090109@cimr.cam.ac.uk>
	<45A7CE6F.2050103@stats.uwo.ca> <45A7D2C3.1050204@cimr.cam.ac.uk>
Message-ID: <45ABCCBF.3080204@cimr.cam.ac.uk>

Hin-Tak Leung wrote:
<snipped>
> 2.4.0 works and 2.4.1/2.5dev crashes, all on the same machine with
> the same version of wine in en_GB.UTF-8 locale.
> 
> export |grep 'LANG'
> declare -x LANG="en_GB.UTF-8"
> 
> I found all 3 versions of Rgui.exe hangs (and not crashes) if I run
> wine under LANG=C .
> 
> I think it would be most interesting to try building the older 2.4.0
> with newer mingw - that would distinguish whether it is code change
> in R or change in mingw. (I'll give this a try in the next few days).

I have managed to build both R 2.4.0 and 2.4.1 with the newer
mingw 3.11+ (both crashes under wine and works okay under XP)
and can now confirm that the wine crash seems to be due to mingw change.

Some comments, notes below, in case it may be useful to others (and
also a good reminder for myself as well):

- building the cross-compiler itself was relatively easy with the
   latest cross-build script from mingw, except by default it doesn't do
   the bleeding-edge component versions.

My /usr/bin/R is 32-bit 2.4.1 and my /usr/bin/R64 is 64-bit 2.4.0 -
so I can cross-build two different versions of R. (cross-build R 
requires the *exact same* version of native R).

binutils-2.17.50-20060824-1-src.tar.gz
gcc-ada-3.4.5-20060117-1-src.tar.gz
gcc-core-3.4.5-20060117-1-src.tar.gz
gcc-g++-3.4.5-20060117-1-src.tar.gz
gcc-g77-3.4.5-20060117-1-src.tar.gz
gcc-java-3.4.5-20060117-1-src.tar.gz
gcc-objc-3.4.5-20060117-1-src.tar.gz
mingw-runtime-3.11-20061202-1-src.tar.gz
w32api-3.8-src.tar.gz

- Although http://www.murdoch-sutherland.com/Rtools/ states
that mingw-runtime-3.11 is required, there was a bug with
mingw-runtime-3.11-src.tar.gz for cross-build. (20061202 is
a post-release fix which wasn't much advertised as such). The nature
of the problem about GCC_NO_EXECUTABLES was discussed in this thread:
http://www.arcknowledge.com/gmane.comp.gnu.mingw.devel/2006-11/threads.html#00029

- I needed to copy R/src/intl and R/src/extra/pcre from 2.4.1 to 2.4.0
to get the older R 2.4.0 to build against newer mingw.

- for both versions, symbol export doesn't work and a big chunk
   of R won't link; my initial work around was to stick
    "-Wl,--export-all-symbols" (...barbaric...) to get some executable
    to link.
   later I worked out the proper way is to do
     export NM=/path-to/bin/i386-mingw32-nm
   and also edit the R/src/gnuwin32/Makefile and replaces the two lines
   of this portion of sed code (8 dots):
      $(SED) -n 's/^........ [BCDRT] _/ /p'
   with this (16 dots):
       $(SED) -n 's/^................ [BCDRT] _/ /p'

It seems that the SED change is in R trunk (with "s/^.* ...").
and the NM export is probably not necessary and due to
my mistake somewhere on dependency generation, as Mkrules does
make NM=$(BINPREF)nm .


From marc_schwartz at comcast.net  Mon Jan 15 20:08:08 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Mon, 15 Jan 2007 13:08:08 -0600
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <45ABC418.4060303@statistik.uni-dortmund.de>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
	<45ABC418.4060303@statistik.uni-dortmund.de>
Message-ID: <1168888088.4936.22.camel@localhost.localdomain>

"Spule":  Spool or coil perhaps?:

  http://de.wikipedia.org/wiki/Spule_(Elektrotechnik)

In addition to both Uwe's and Duncan's replies, it might be of value to
gather some additional empiric data, such as CPU Temps and Fan Speeds
and note if there is some threshold as to when this sound occurs.

An application that I have seen referenced, but do not use since I am on
Linux is:

  http://www.almico.com/speedfan.php

but you may want to do further reviews before using.

It is possible that even running at 100% CPU, as noted, there may be
certain types of operations that will result in higher CPU temps,
causing higher fan speeds. The sound may very well be coming from one or
more of the fans or housings in your system, as a result of vibration or
resonance.

In most current generations of computers, there are multiple fans in the
system. One or more on the power supply, one or more on the CPU itself
and perhaps others within the case to enhance airflow and cooling. The
same is the case in laptops.

HTH,

Marc Schwartz

On Mon, 2007-01-15 at 19:12 +0100, Uwe Ligges wrote:
> Ulrike,
> 
> It can happen that different types of simulations and programs can put 
> load on different regions of the CPU and comsume different amounts of 
> power or simply are causing different patterns in the power consumptions
> 
> 
> Two things might cause the noise (at least, I have seen these things in 
> Dortmund before), given in the order I would look at it at:
> 
> 1. the power supply
> 2. some "Spule" (sorry folks, I don't know the english word) on the 
> mainboard (in most of the cases ASUS is quite OK and does not produce 
> such stuff)
> 
> If the former, buy a better one, if the latter, you can put some paper 
> or part of old cloth around it.
> 
> Best,
> Uwe
> 
> 
> 
> Ulrike Gr?mping wrote:
> > Dear R-developers,
> > 
> > the following may seem a weird question for R-devel ? I try anyway, because it 
> > does seem to be related to usage of R and R's way of interacting with the 
> > hardware.
> > 
> > When running R (2.4.0) on my new dual core Windows XP system (Intel Core 2 Duo 
> > E6600, Mainboard ASUS P5B, BeQuiet Power Unit), I observe various types of 
> > sounds (not related to fans) when running at full usage of at least one of the 
> > cores.
> > 
> > The most annoying sound ? a high-pitched noise like a whine ? I have so far 
> > observed running simulations in R only and couldn?t reproduce with any other 
> > software (sometimes it?s also more a rustle than a whine, that one is not 
> > disturbing). I can clearly track it down to particular instances of R ? as 
> > soon as I left-click on a blue window bar in the affected R-Gui, the noise 
> > stops (and there are sometimes other instances of R running in parallel which 
> > are completely unrelated to the whine). I?ve also stopped R when the computer 
> > just whined and started SAS, fully using the CPU as well ? no whine. Shut down 
> > SAS, restart R ? whine again. Apparently, it can also be related to what 
> > exactly R is doing at the particular moment. For example, I just discovered 
> > that simulations of one type were finished, because the computer ? running 
> > another simulation under full load on R in a quiet way ? started whining at 
> > the moment it switched to the new type of simulation.
> > 
> > The hardware technician I?ve asked about this issue does not have any idea and 
> > suspects R to do something peculiar that causes the noise. It?s not the 
> > mainboards fault (that has already been changed for another reason, and the 
> > behavior remains). I can?t definitely locate the source of the sound. I 
> > suspect that it?s the Power Unit, but there are so many parts close together 
> > that I am not really sure.
> > 
> > I do not know enough about interactions of R with hardware to know whether it 
> > is even possible for anyone deeper into the matter to develop an idea what 
> > could be behind this behavior. For the moment, I can get rid of the whine by 
> > using the mainboard tool ?AI Gear? to reduce the processor?s speed from 2.4GHz 
> > to 1.7GHz when I want to concentrate ? then the whine is gone (but the 
> > simulation is slower).
> > 
> > Does anyone have any idea ? or hints regarding what else I could think about ?
> > 
> > Regards, Ulrike
> > 
> > ****************************** 
> > Prof. Dr. Ulrike Gr?mping 
> > Fachbereich II 
> > TFH Berlin 
> > Luxemburger Str. 10 
> > 13353 Berlin 
> > mail: groemping at tfh-berlin.de 
> > www: www.tfh-berlin.de/~groemp/ 
> > ******************************
> > 
> > ------- End of Forwarded Message -------
> > 
> > ****************************** 
> > Prof. Dr. Ulrike Gr?mping 
> > Fachbereich II 
> > TFH Berlin 
> > Luxemburger Str. 10 
> > 13353 Berlin 
> > mail: groemping at tfh-berlin.de 
> > www: www.tfh-berlin.de/~groemp/ 
> > ******************************
> > 
> >  
> > 
> > 	[[alternative HTML version deleted]]
> > 
> > 
> > 
> > ------------------------------------------------------------------------
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From groemping at tfh-berlin.de  Mon Jan 15 20:35:56 2007
From: groemping at tfh-berlin.de (=?ISO-8859-1?Q?Ulrike_Gr=F6mping?=)
Date: Mon, 15 Jan 2007 20:35:56 +0100
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <1168888088.4936.22.camel@localhost.localdomain>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
	<45ABC418.4060303@statistik.uni-dortmund.de>
	<1168888088.4936.22.camel@localhost.localdomain>
Message-ID: <20070115193517.M92885@tfh-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070115/2d3ee0a0/attachment.pl 

From groemping at tfh-berlin.de  Mon Jan 15 20:38:51 2007
From: groemping at tfh-berlin.de (=?ISO-8859-1?Q?Ulrike_Gr=F6mping?=)
Date: Mon, 15 Jan 2007 20:38:51 +0100
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <45ABC2CE.6030705@stats.uwo.ca>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
	<45ABC2CE.6030705@stats.uwo.ca>
Message-ID: <20070115193622.M22641@tfh-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070115/dc29c18d/attachment.pl 

From thomas.friedrichsmeier at ruhr-uni-bochum.de  Mon Jan 15 20:25:37 2007
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (thomas.friedrichsmeier at ruhr-uni-bochum.de)
Date: Mon, 15 Jan 2007 20:25:37 +0100 (CET)
Subject: [Rd] PR#9279 is not fulfilled
Message-ID: <20070115192537.900F7538F3@slim.kubism.ku.dk>

As of SVN revision 40493, this wish is NOT fulfilled, and should be moved out 
of the wishlist-fulfilled category again.

The note "Use :::" does NOT address this issue, and the triple colon operator 
will fail to look up the symbols in question just like the double colon 
operator. In fact this issue has nothing to do with whether the symbol is 
exported or not, but with whether or not the symbol is placed in the 
namespace at all.

Please run the code example provided in the original report.

See also this thread: 
https://stat.ethz.ch/pipermail/r-devel/2006-October/043027.html .

Regards
Thomas Friedrichsmeier


From marc_schwartz at comcast.net  Mon Jan 15 20:49:46 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Mon, 15 Jan 2007 13:49:46 -0600
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <20070115193517.M92885@tfh-berlin.de>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
	<45ABC418.4060303@statistik.uni-dortmund.de>
	<1168888088.4936.22.camel@localhost.localdomain>
	<20070115193517.M92885@tfh-berlin.de>
Message-ID: <1168890587.4936.29.camel@localhost.localdomain>

Ulrike,

Well, it sounds like you are doing the correct things.  Nice to know
that Speedfan seems to work well.

The comments from others on the ASUS boards would certainly seem to
support Duncan's and Uwe's hypotheses.

If the supplier is willing to replace the power unit, it is certainly
worth trying. 

If however it does not work, is there an option from your hardware
vendor to replace the motherboard with something other than ASUS?
Presumably, this is annoying enough to be worth pursuing.

Regards,

Marc

On Mon, 2007-01-15 at 20:35 +0100, Ulrike Gr?mping wrote:
> Marc,
> 
> actually I am running speedfan and can even change fan speed with
> it,and this does not do anything to the noise. I've had the noise
> occurboth with CPU temps of 51C and 36C, depending on whether I insist
> onlow CPU fan speed or allow almost 3000rpm. I've completely stopped
> thechassis fan with no noise reduction, the only remaining fan is
> thepower unit fan, which is almost always at something around 900rpm.
> SoI'm almost sure it is something closer to what Duncan or Uwe
> suggest.
> 
> The Power Unit's supplier actually offered to replace the unit (a
> 430WBeQuiet Dark Power Pro), so I will next try out whether this
> helps, Isuppose. I am however wondering, whether this has a chance of
> beinghelpful, because some gaming people on the internet claim that
> theirASUS main boards make all power units squeak, while the same
> powerunits are completely quiet in connection with other boards.
> 
> Regards, Ulrike
> 
> ---------- Original Message -----------
> From: Marc Schwartz <marc_schwartz at comcast.net> 
> To: Uwe Ligges <ligges at statistik.uni-dortmund.de> 
> Cc: Ulrike Grmping <groemp at tfh-berlin.de>, r-devel at r-project.org 
> Sent: Mon, 15 Jan 2007 13:08:08 -0600 
> Subject: Re: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
> 
> > "Spule": Spool or coil perhaps?: 
> > 
> > http://de.wikipedia.org/wiki/Spule_(Elektrotechnik) 
> > 
> > In addition to both Uwe's and Duncan's replies, it might be of value to 
> > gather some additional empiric data, such as CPU Temps and Fan Speeds 
> > and note if there is some threshold as to when this sound occurs. 
> > 
> > An application that I have seen referenced, but do not use since I am on 
> > Linux is: 
> > 
> > http://www.almico.com/speedfan.php 
> > 
> > but you may want to do further reviews before using. 
> > 
> > It is possible that even running at 100% CPU, as noted, there may be 
> > certain types of operations that will result in higher CPU temps, 
> > causing higher fan speeds. The sound may very well be coming from one or 
> > more of the fans or housings in your system, as a result of vibration or 
> > resonance. 
> > 
> > In most current generations of computers, there are multiple fans in the 
> > system. One or more on the power supply, one or more on the CPU itself 
> > and perhaps others within the case to enhance airflow and cooling. The 
> > same is the case in laptops. 
> > 
> > HTH, 
> > 
> > Marc Schwartz 

<snip>


From ggrothendieck at gmail.com  Mon Jan 15 21:02:13 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 15 Jan 2007 15:02:13 -0500
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <20070115193622.M22641@tfh-berlin.de>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de> <45ABC2CE.6030705@stats.uwo.ca>
	<20070115193622.M22641@tfh-berlin.de>
Message-ID: <971536df0701151202j5d4d630dh925c7df5b844517e@mail.gmail.com>

I don't think it would be necessary to do any programming.  Just run
another program at the same time.

On 1/15/07, Ulrike Gr?mping <groemping at tfh-berlin.de> wrote:
> Duncan,
> thanks. Not knowing what is a quiet or noisy loop beforehand, I wouldn't like to do my programming around that theme though :-)
> By the way, does your phrase "noisy CPUs" suggest noisy types of CPU or noisy individuals of generally ok types of CPU (you might not know that, though)?
> Regards, Ulrike
>
> ---------- Original Message -----------
> From: Duncan Murdoch <murdoch at stats.uwo.ca>
> To: Ulrike Gr?mping <groemping at tfh-berlin.de>
> Cc: r-devel at r-project.org
> Sent: Mon, 15 Jan 2007 13:07:10 -0500
> Subject: Re: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
>
> > On 1/15/2007 12:02 PM, Ulrike Gr?mping wrote:
> > > Dear R-developers,
> > >
> > > the following may seem a weird question for R-devel [WINDOWS-1252?]? I try anyway, because it
> > > does seem to be related to usage of R and R's way of interacting with the
> > > hardware.
> > >
> > > When running R (2.4.0) on my new dual core Windows XP system (Intel Core 2 Duo
> > > E6600, Mainboard ASUS P5B, BeQuiet Power Unit), I observe various types of
> > > sounds (not related to fans) when running at full usage of at least one of the
> > > cores.
> > >
> > > The most annoying sound [WINDOWS-1252?]? a high-pitched noise like a whine [WINDOWS-1252?]? I have so far
> > > observed running simulations in R only and [WINDOWS-1252?]couldn't reproduce with any other
> > > software (sometimes [WINDOWS-1252?]it's also more a rustle than a whine, that one is not
> > > disturbing). I can clearly track it down to particular instances of R [WINDOWS-1252?]? as
> > > soon as I left-click on a blue window bar in the affected R-Gui, the noise
> > > stops (and there are sometimes other instances of R running in parallel which
> > > are completely unrelated to the whine). [WINDOWS-1252?]I've also stopped R when the computer
> > > just whined and started SAS, fully using the CPU as well [WINDOWS-1252?]? no whine. Shut down
> > > SAS, restart R ? whine again. Apparently, it can also be related to what
> > > exactly R is doing at the particular moment. For example, I just discovered
> > > that simulations of one type were finished, because the computer [WINDOWS-1252?]? running
> > > another simulation under full load on R in a quiet way [WINDOWS-1252?]? started whining at
> > > the moment it switched to the new type of simulation.
> > >
> > > The hardware technician [WINDOWS-1252?]I've asked about this issue does not have any idea and
> > > suspects R to do something peculiar that causes the noise. [WINDOWS-1252?]It's not the
> > > mainboards fault (that has already been changed for another reason, and the
> > > behavior remains). I [WINDOWS-1252?]can't definitely locate the source of the sound. I
> > > suspect that [WINDOWS-1252?]it's the Power Unit, but there are so many parts close together
> > > that I am not really sure.
> > >
> > > I do not know enough about interactions of R with hardware to know whether it
> > > is even possible for anyone deeper into the matter to develop an idea what
> > > could be behind this behavior. For the moment, I can get rid of the whine by
> > > using the mainboard tool [WINDOWS-1252?]?AI [WINDOWS-1252?]Gear" to reduce the [WINDOWS-1252?]processor's speed from 2.4GHz
> > > to 1.7GHz when I want to concentrate [WINDOWS-1252?]? then the whine is gone (but the
> > > simulation is slower).
> >
> > I haven't heard this from R, but on occasion I've had noisy CPUs. I
> > suspect it's a case of some repetitive calculation leading to repetitive
> > electric fields which happen to cause physical resonance of some part of
> > your system. That agrees with the observation that changing the speed
> > changed the noisiness. Another way to get rid of it would be to change
> > the contents of the loop: make it run faster or slower and the noise
> > should go away.
> >
> > Duncan Murdoch
> >
> > >
> > > Does anyone have any idea [WINDOWS-1252?]? or hints regarding what else I could think about ?
> > >
> > > Regards, Ulrike
> > >
> > > ******************************
> > > Prof. Dr. Ulrike Gr?mping
> > > Fachbereich II
> > > TFH Berlin
> > > Luxemburger Str. 10
> > > 13353 Berlin
> > > mail: groemping at tfh-berlin.de
> > > www: www.tfh-berlin.de/~groemp/
> > > ******************************
> > >
> > > ------- End of Forwarded Message -------
> > >
> > > ******************************
> > > Prof. Dr. Ulrike Gr?mping
> > > Fachbereich II
> > > TFH Berlin
> > > Luxemburger Str. 10
> > > 13353 Berlin
> > > mail: groemping at tfh-berlin.de
> > > www: www.tfh-berlin.de/~groemp/
> > > ******************************
> > >
> > >
> > >
> > > [[alternative HTML version deleted]]
> > >
> > >
> > >
> > > ------------------------------------------------------------------------
> > >
> > > ______________________________________________
> > > R-devel at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-devel
> ------- End of Original Message -------
>
>
>        [[alternative HTML version deleted]]
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>


From ahenningsen at email.uni-kiel.de  Mon Jan 15 23:43:48 2007
From: ahenningsen at email.uni-kiel.de (Arne Henningsen)
Date: Mon, 15 Jan 2007 23:43:48 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9444)
In-Reply-To: <45ABBD96.6060505@stats.uwo.ca>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
	<200701151723.14912.ahenningsen@email.uni-kiel.de>
	<45ABBD96.6060505@stats.uwo.ca>
Message-ID: <200701152343.49210.ahenningsen@email.uni-kiel.de>

On Monday, 15. January 2007 18:44, Duncan Murdoch wrote:
> On 1/15/2007 11:23 AM, Arne Henningsen wrote:
> > On Friday, 12. January 2007 11:39, you wrote:
> >> [...]
> >> I think you misunderstood me, given the "long answer".
> >
> > Indeed, I misunderstood you.
> >
> >> We haven't
> >> changed the way deparse() handles "/". The solution in R-devel is given
> >> below.
> >
> > I prefer to use "keep.source=FALSE", because I generally like that Sweave
> > takes the job to format the code chunks. Therefore, it would be great if
> > Sweave is allowed to introduce line breaks after forward slashes, e.g. if
> > deparse() adds a blank after a forward slash.
> > Please move this wish from "wishlst-fulfilled" to "wishlst".
>
> I don't think so.  If I thought it was a reasonable request, I'd do
> that, but it's not.  You have a perfectly general solution to your
> problem.  

However, setting "keep.source = FALSE" has (IMHO) one major advantage:
I can easily (and globally) change the width of the code chunks by "options( 
width = XXX )", e.g. if I change the paper size, the margins or the font 
size. With "keep.source = TRUE", I would have to reformat all code chunks by 
hand and I generally prefer that my software (LaTeX, Sweave) does this task 
for me. Hence,  "keep.source = TRUE" is not a "perfectly general solution" 
(at least) for me.

> The fact that it isn't the one you want doesn't mean it needs 
> to be listed as an outstanding issue in the bug reporting system.

Okay. Where can I list "minor" wishes?

Arne

>
> Duncan Murdoch

-- 
Arne Henningsen
Department of Agricultural Economics
University of Kiel
Olshausenstr. 40
D-24098 Kiel (Germany)
Tel: +49-431-880 4445
Fax: +49-431-880 1397
ahenningsen at agric-econ.uni-kiel.de
http://www.uni-kiel.de/agrarpol/ahenningsen/


From murdoch at stats.uwo.ca  Tue Jan 16 05:22:45 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 15 Jan 2007 23:22:45 -0500
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
 (PR#9444)
In-Reply-To: <200701152343.49210.ahenningsen@email.uni-kiel.de>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
	<200701151723.14912.ahenningsen@email.uni-kiel.de>
	<45ABBD96.6060505@stats.uwo.ca>
	<200701152343.49210.ahenningsen@email.uni-kiel.de>
Message-ID: <45AC5315.2040406@stats.uwo.ca>

On 1/15/2007 5:43 PM, Arne Henningsen wrote:
> On Monday, 15. January 2007 18:44, Duncan Murdoch wrote:
>> On 1/15/2007 11:23 AM, Arne Henningsen wrote:
>>> On Friday, 12. January 2007 11:39, you wrote:
>>>> [...]
>>>> I think you misunderstood me, given the "long answer".
>>> Indeed, I misunderstood you.
>>>
>>>> We haven't
>>>> changed the way deparse() handles "/". The solution in R-devel is given
>>>> below.
>>> I prefer to use "keep.source=FALSE", because I generally like that Sweave
>>> takes the job to format the code chunks. Therefore, it would be great if
>>> Sweave is allowed to introduce line breaks after forward slashes, e.g. if
>>> deparse() adds a blank after a forward slash.
>>> Please move this wish from "wishlst-fulfilled" to "wishlst".
>> I don't think so.  If I thought it was a reasonable request, I'd do
>> that, but it's not.  You have a perfectly general solution to your
>> problem.  
> 
> However, setting "keep.source = FALSE" has (IMHO) one major advantage:
> I can easily (and globally) change the width of the code chunks by "options( 
> width = XXX )", e.g. if I change the paper size, the margins or the font 
> size. With "keep.source = TRUE", I would have to reformat all code chunks by 
> hand and I generally prefer that my software (LaTeX, Sweave) does this task 
> for me. Hence,  "keep.source = TRUE" is not a "perfectly general solution" 
> (at least) for me.

No, you would only have to reformat the one code chunk where you set 
keep.source = TRUE.  It doesn't need to be a global option.

>> The fact that it isn't the one you want doesn't mean it needs 
>> to be listed as an outstanding issue in the bug reporting system.
> 
> Okay. Where can I list "minor" wishes?

On your to-do list?

Duncan Murdoch


From murdoch at stats.uwo.ca  Tue Jan 16 05:23:03 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 15 Jan 2007 23:23:03 -0500
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <20070115193622.M22641@tfh-berlin.de>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
	<45ABC2CE.6030705@stats.uwo.ca>
	<20070115193622.M22641@tfh-berlin.de>
Message-ID: <45AC5327.3050103@stats.uwo.ca>

On 1/15/2007 2:38 PM, Ulrike Gr?mping wrote:
> Duncan, 
> thanks. Not knowing what is a quiet or noisy loop beforehand, I wouldn't like to do my programming around that theme though :-) 
> By the way, does your phrase "noisy CPUs" suggest noisy types of CPU or noisy individuals of generally ok types of CPU (you might not know that, though)?

I think I've only come across it a couple of times, and didn't have any 
replication, so I don't know if they were unusual individuals or a 
design problem.  From your description of replacing the mb, it sounds as 
though it's a design problem -- unless as Uwe suggested, it's a power 
supply or some other part that you didn't replace.

Duncan Murdoch

> Regards, Ulrike
> 
> ---------- Original Message -----------
> From: Duncan Murdoch <murdoch at stats.uwo.ca> 
> To: Ulrike Gr?mping <groemping at tfh-berlin.de> 
> Cc: r-devel at r-project.org 
> Sent: Mon, 15 Jan 2007 13:07:10 -0500 
> Subject: Re: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
> 
>> On 1/15/2007 12:02 PM, Ulrike Gr?mping wrote: 
>>> Dear R-developers, 
>>>
>>> the following may seem a weird question for R-devel [WINDOWS-1252?]? I try anyway, because it 
>>> does seem to be related to usage of R and R's way of interacting with the 
>>> hardware. 
>>>
>>> When running R (2.4.0) on my new dual core Windows XP system (Intel Core 2 Duo 
>>> E6600, Mainboard ASUS P5B, BeQuiet Power Unit), I observe various types of 
>>> sounds (not related to fans) when running at full usage of at least one of the 
>>> cores. 
>>>
>>> The most annoying sound [WINDOWS-1252?]? a high-pitched noise like a whine [WINDOWS-1252?]? I have so far 
>>> observed running simulations in R only and [WINDOWS-1252?]couldn?t reproduce with any other 
>>> software (sometimes [WINDOWS-1252?]it?s also more a rustle than a whine, that one is not 
>>> disturbing). I can clearly track it down to particular instances of R [WINDOWS-1252?]? as 
>>> soon as I left-click on a blue window bar in the affected R-Gui, the noise 
>>> stops (and there are sometimes other instances of R running in parallel which 
>>> are completely unrelated to the whine). [WINDOWS-1252?]I?ve also stopped R when the computer 
>>> just whined and started SAS, fully using the CPU as well [WINDOWS-1252?]? no whine. Shut down 
>>> SAS, restart R ? whine again. Apparently, it can also be related to what 
>>> exactly R is doing at the particular moment. For example, I just discovered 
>>> that simulations of one type were finished, because the computer [WINDOWS-1252?]? running 
>>> another simulation under full load on R in a quiet way [WINDOWS-1252?]? started whining at 
>>> the moment it switched to the new type of simulation. 
>>>
>>> The hardware technician [WINDOWS-1252?]I?ve asked about this issue does not have any idea and 
>>> suspects R to do something peculiar that causes the noise. [WINDOWS-1252?]It?s not the 
>>> mainboards fault (that has already been changed for another reason, and the 
>>> behavior remains). I [WINDOWS-1252?]can?t definitely locate the source of the sound. I 
>>> suspect that [WINDOWS-1252?]it?s the Power Unit, but there are so many parts close together 
>>> that I am not really sure. 
>>>
>>> I do not know enough about interactions of R with hardware to know whether it 
>>> is even possible for anyone deeper into the matter to develop an idea what 
>>> could be behind this behavior. For the moment, I can get rid of the whine by 
>>> using the mainboard tool [WINDOWS-1252?]?AI [WINDOWS-1252?]Gear? to reduce the [WINDOWS-1252?]processor?s speed from 2.4GHz 
>>> to 1.7GHz when I want to concentrate [WINDOWS-1252?]? then the whine is gone (but the 
>>> simulation is slower). 
>> I haven't heard this from R, but on occasion I've had noisy CPUs.  I 
>> suspect it's a case of some repetitive calculation leading to repetitive 
>> electric fields which happen to cause physical resonance of some part of 
>> your system.  That agrees with the observation that changing the speed 
>> changed the noisiness.  Another way to get rid of it would be to change 
>> the contents of the loop:  make it run faster or slower and the noise 
>> should go away. 
>>
>> Duncan Murdoch 
>>
>>> Does anyone have any idea [WINDOWS-1252?]? or hints regarding what else I could think about ? 
>>>
>>> Regards, Ulrike 
>>>
>>> ****************************** 
>>> Prof. Dr. Ulrike Gr?mping 
>>> Fachbereich II 
>>> TFH Berlin 
>>> Luxemburger Str. 10 
>>> 13353 Berlin 
>>> mail: groemping at tfh-berlin.de 
>>> www: www.tfh-berlin.de/~groemp/ 
>>> ****************************** 
>>>
>>> ------- End of Forwarded Message ------- 
>>>
>>> ****************************** 
>>> Prof. Dr. Ulrike Gr?mping 
>>> Fachbereich II 
>>> TFH Berlin 
>>> Luxemburger Str. 10 
>>> 13353 Berlin 
>>> mail: groemping at tfh-berlin.de 
>>> www: www.tfh-berlin.de/~groemp/ 
>>> ****************************** 
>>>
>>>   
>>>
>>>     [[alternative HTML version deleted]] 
>>>
>>>
>>>
>>> ------------------------------------------------------------------------ 
>>>
>>> ______________________________________________ 
>>> R-devel at r-project.org mailing list 
>>> https://stat.ethz.ch/mailman/listinfo/r-devel 
> ------- End of Original Message -------
>  
>


From elw at stderr.org  Tue Jan 16 05:31:05 2007
From: elw at stderr.org (elw at stderr.org)
Date: Mon, 15 Jan 2007 22:31:05 -0600 (CST)
Subject: [Rd] Whine in dual core Windows PC if R uses full CPU capacity
In-Reply-To: <45AC5327.3050103@stats.uwo.ca>
References: <20070115142934.M50535@tfh-berlin.de>
	<20070115170148.M17385@tfh-berlin.de>
	<45ABC2CE.6030705@stats.uwo.ca> <20070115193622.M22641@tfh-berlin.de>
	<45AC5327.3050103@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0701152228140.20490@illuminati.stderr.org>



> I think I've only come across it a couple of times, and didn't have any 
> replication, so I don't know if they were unusual individuals or a 
> design problem.  From your description of replacing the mb, it sounds as 
> though it's a design problem -- unless as Uwe suggested, it's a power 
> supply or some other part that you didn't replace.

I've seen this kind of resonance problem before, in a couple of different 
computers with a couple of different mixes of hardware.

What usually comes out, eventually, is that some part in your system is 
very poorly shielded and ends up reacting badly to other sorts of activity 
in the system.

I've seen both video cards and audio boards involved in this kind of 
problem, as well as the more sterotypical "dirty" power supply or 
third-rate motherboard design.  I've also seen spurious current applied to 
the expansion bus [by a functional, but marginal card] cause very similar 
issues.

The only way to *really* trace down the problem is to swap the parts in 
the machine for other, known-non-problematic parts.  This is expensive, 
and takes a lot of time.

--elijah


From Torsten.Hothorn at rzmail.uni-erlangen.de  Tue Jan 16 09:00:26 2007
From: Torsten.Hothorn at rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Tue, 16 Jan 2007 09:00:26 +0100 (CET)
Subject: [Rd] R 2.4.0 @ R-project.org
Message-ID: <Pine.LNX.4.64.0701160859270.16417@imbe153.imbe.med.uni-erlangen.de>


R-project.org' News section still has

  R version 2.4.0 has been released on 2006-10-03.

Best wishes,

Torsten


From hin-tak.leung at cimr.cam.ac.uk  Tue Jan 16 11:13:45 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Tue, 16 Jan 2007 10:13:45 +0000
Subject: [Rd] mingw-cross with R 2.4.x Re: wine and build difference
 between R.2.4.0 and R 2.4.1 windows binaries?
In-Reply-To: <45ABCCBF.3080204@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk>
	<45A545B1.6070508@stats.uwo.ca>	<45A6250C.3020802@cimr.cam.ac.uk>
	<45A629E0.8090100@stats.uwo.ca>	<45A79EB8.8010606@cimr.cam.ac.uk>	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>	<45A7BF93.1090109@cimr.cam.ac.uk>
	<45A7CE6F.2050103@stats.uwo.ca> <45A7D2C3.1050204@cimr.cam.ac.uk>
	<45ABCCBF.3080204@cimr.cam.ac.uk>
Message-ID: <45ACA559.5010909@cimr.cam.ac.uk>

Hin-Tak Leung wrote:
> Hin-Tak Leung wrote:
> <snipped>
 > - I needed to copy R/src/intl and R/src/extra/pcre from 2.4.1 to 2.4.0
 > to get the older R 2.4.0 to build against newer mingw.

Since I had to copy a few files from 2.4.1 to 2.4.0 for the older 
version of build, I thought I need to be 100% sure that the wine crash 
is due to mingw rather than those few files.

So previously, both 2.4.0/2.4.1 Rgui binaries from this set crash wine:

> binutils-2.17.50-20060824-1-src.tar.gz
> gcc-ada-3.4.5-20060117-1-src.tar.gz
> gcc-core-3.4.5-20060117-1-src.tar.gz
> gcc-g++-3.4.5-20060117-1-src.tar.gz
> gcc-g77-3.4.5-20060117-1-src.tar.gz
> gcc-java-3.4.5-20060117-1-src.tar.gz
> gcc-objc-3.4.5-20060117-1-src.tar.gz
> mingw-runtime-3.11-20061202-1-src.tar.gz
> w32api-3.8-src.tar.gz

I tried some other combos of mingw-cross.

Both 2.4.0/2.4.1 Rgui binaries from this set works OK-ish with wine
(by that I mean I can so Sys.info() and sessionInfo() - obviously 
somebody requires 3.11 for 2.4.1 for a reason):

gcc-core-3.4.5-20060117-1-src.tar.gz
gcc-ada-3.4.5-20060117-1-src.tar.gz
gcc-g++-3.4.5-20060117-1-src.tar.gz
gcc-g77-3.4.5-20060117-1-src.tar.gz
gcc-java-3.4.5-20060117-1-src.tar.gz
gcc-objc-3.4.5-20060117-1-src.tar.gz
binutils-2.17.50-20060716-1-src.tar.gz
mingw-runtime-3.10-20060909-1-src.tar.gz
w32api-3.7-src.tar.gz

This set produces 2.4.0/2.4.1 Rgui binaries which crash wine:

gcc-core-3.4.5-20060117-1-src.tar.gz
  gcc-ada-3.4.5-20060117-1-src.tar.gz
  gcc-g++-3.4.5-20060117-1-src.tar.gz
  gcc-g77-3.4.5-20060117-1-src.tar.gz
  gcc-java-3.4.5-20060117-1-src.tar.gz
  gcc-objc-3.4.5-20060117-1-src.tar.gz
  binutils-2.17.50-20060716-1-src.tar.gz
  mingw-runtime-3.11-20061202-1-src.tar.gz
  w32api-3.7-src.tar.gz

As can be seen, the difference is only 
mingw-runtime-3.10-20060909-1-src.tar.gz versus 
mingw-runtime-3.11-20061202-1-src.tar.gz .

The issue is filed as http://bugs.winehq.org/show_bug.cgi?id=7181

HTL


From ahenningsen at email.uni-kiel.de  Tue Jan 16 11:26:30 2007
From: ahenningsen at email.uni-kiel.de (Arne Henningsen)
Date: Tue, 16 Jan 2007 11:26:30 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9444)
In-Reply-To: <45AC5315.2040406@stats.uwo.ca>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
	<200701152343.49210.ahenningsen@email.uni-kiel.de>
	<45AC5315.2040406@stats.uwo.ca>
Message-ID: <200701161126.30431.ahenningsen@email.uni-kiel.de>

On Tuesday 16 January 2007 05:22, Duncan Murdoch wrote:
> On 1/15/2007 5:43 PM, Arne Henningsen wrote:
> > On Monday, 15. January 2007 18:44, Duncan Murdoch wrote:
> >> On 1/15/2007 11:23 AM, Arne Henningsen wrote:
> >>> [...]
> >>> I prefer to use "keep.source=FALSE", because I generally like that
> >>> Sweave takes the job to format the code chunks. Therefore, it would be
> >>> great if Sweave is allowed to introduce line breaks after forward
> >>> slashes, e.g. if deparse() adds a blank after a forward slash.
> >>> Please move this wish from "wishlst-fulfilled" to "wishlst".
> >>
> >> I don't think so.  If I thought it was a reasonable request, I'd do
> >> that, but it's not.  You have a perfectly general solution to your
> >> problem.
> >
> > However, setting "keep.source = FALSE" has (IMHO) one major advantage:
> > I can easily (and globally) change the width of the code chunks by
> > "options( width = XXX )", e.g. if I change the paper size, the margins or
> > the font size. With "keep.source = TRUE", I would have to reformat all
> > code chunks by hand and I generally prefer that my software (LaTeX,
> > Sweave) does this task for me. Hence,  "keep.source = TRUE" is not a
> > "perfectly general solution" (at least) for me.
>
> No, you would only have to reformat the one code chunk where you set
> keep.source = TRUE.  It doesn't need to be a global option.

Okay, that's true, but I have more than one code chunk that is not nicely 
formatted because of "/" signs. (And I generally don't like manual 
formatting ;-)).

Is there any reason for deparse() to add spaces around "+", "-", and "*" 
operators but not around "/" operators?
R> deparse(parse( text = "a+b-c*d/e" ))
[1] "expression(a + b - c * d/e)"

> >> The fact that it isn't the one you want doesn't mean it needs
> >> to be listed as an outstanding issue in the bug reporting system.
> >
> > Okay. Where can I list "minor" wishes?
>
> On your to-do list?

Yes, that's a good idea!
This is my patch of /src/main/names.c:

--- names.c.orig        2007-01-16 11:03:24.000000000 +0100
+++ names.c     2007-01-16 10:30:43.000000000 +0100
@@ -149,7 +149,7 @@
 {"+",   do_arith, PLUSOP, 1, 2, {PP_BINARY,  PREC_SUM,    0}},
 {"-",   do_arith, MINUSOP,1, 2, {PP_BINARY,  PREC_SUM,    0}},
 {"*",   do_arith, TIMESOP,1, 2, {PP_BINARY,  PREC_PROD,   0}},
-{"/",   do_arith, DIVOP,  1, 2, {PP_BINARY2, PREC_PROD,   0}},
+{"/",   do_arith, DIVOP,  1, 2, {PP_BINARY,  PREC_PROD,   0}},
 {"^",   do_arith, POWOP,  1, 2, {PP_BINARY2, PREC_POWER,  1}},
 {"%%",  do_arith, MODOP,  1, 2, {PP_BINARY2, PREC_PERCENT,0}},
 {"%/%", do_arith, IDIVOP, 1, 2, {PP_BINARY2, PREC_PERCENT,0}},

(I have removed some blanks so that each line fits in a single line)

Now I get:
R> deparse(parse( text = "a+b-c*d/e" ))
[1] "expression(a + b - c * d / e)"

Does this patch has any negative side effects?

"make check" fails, but AFAIK this is just because of different positions of 
line breaks:
[...]
running code in 'reg-tests-2.R' ... OK
comparing 'reg-tests-2.Rout' 
to './reg-tests-2.Rout.save' ...3639,3640c3639,3640
< aov(formula = dep.variable ~ f1 * f2 + Error(subject / (f1 +
<     f2)), data = sample.df)
---
> aov(formula = dep.variable ~ f1 * f2 + Error(subject/(f1 + f2)),
>     data = sample.df)
3693,3694c3693,3694
< aov(formula = dep.variable ~ f1 * f2 + Error(subject / (f2 +
<     f1)), data = sample.df)
---
> aov(formula = dep.variable ~ f1 * f2 + Error(subject/(f2 + f1)),
>     data = sample.df)
make[3]: *** [reg-tests-2.Rout] Fehler 1
[...]

> Duncan Murdoch

Thank you for all your hints,
Arne

-- 
Arne Henningsen
Department of Agricultural Economics
University of Kiel
Olshausenstr. 40
D-24098 Kiel (Germany)
Tel: +49-431-880 4445
Fax: +49-431-880 1397
ahenningsen at agric-econ.uni-kiel.de
http://www.uni-kiel.de/agrarpol/ahenningsen/


From murdoch at stats.uwo.ca  Tue Jan 16 12:46:51 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 16 Jan 2007 06:46:51 -0500
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
 (PR#9444)
In-Reply-To: <200701161126.30431.ahenningsen@email.uni-kiel.de>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>	<200701152343.49210.ahenningsen@email.uni-kiel.de>	<45AC5315.2040406@stats.uwo.ca>
	<200701161126.30431.ahenningsen@email.uni-kiel.de>
Message-ID: <45ACBB2B.3000705@stats.uwo.ca>

On 1/16/2007 5:26 AM, Arne Henningsen wrote:
> On Tuesday 16 January 2007 05:22, Duncan Murdoch wrote:
>> On 1/15/2007 5:43 PM, Arne Henningsen wrote:
>>> On Monday, 15. January 2007 18:44, Duncan Murdoch wrote:
>>>> On 1/15/2007 11:23 AM, Arne Henningsen wrote:
>>>>> [...]
>>>>> I prefer to use "keep.source=FALSE", because I generally like that
>>>>> Sweave takes the job to format the code chunks. Therefore, it would be
>>>>> great if Sweave is allowed to introduce line breaks after forward
>>>>> slashes, e.g. if deparse() adds a blank after a forward slash.
>>>>> Please move this wish from "wishlst-fulfilled" to "wishlst".
>>>> I don't think so.  If I thought it was a reasonable request, I'd do
>>>> that, but it's not.  You have a perfectly general solution to your
>>>> problem.
>>> However, setting "keep.source = FALSE" has (IMHO) one major advantage:
>>> I can easily (and globally) change the width of the code chunks by
>>> "options( width = XXX )", e.g. if I change the paper size, the margins or
>>> the font size. With "keep.source = TRUE", I would have to reformat all
>>> code chunks by hand and I generally prefer that my software (LaTeX,
>>> Sweave) does this task for me. Hence,  "keep.source = TRUE" is not a
>>> "perfectly general solution" (at least) for me.
>> No, you would only have to reformat the one code chunk where you set
>> keep.source = TRUE.  It doesn't need to be a global option.
> 
> Okay, that's true, but I have more than one code chunk that is not nicely 
> formatted because of "/" signs. (And I generally don't like manual 
> formatting ;-)).
> 
> Is there any reason for deparse() to add spaces around "+", "-", and "*" 
> operators but not around "/" operators?
> R> deparse(parse( text = "a+b-c*d/e" ))
> [1] "expression(a + b - c * d/e)"

I don't know, but it has been like that for the complete history of the 
source code in the repository (almost 10 years).  I suppose someone thought

  a + b - c * d /
  e

would look ugly (even though they were happy to put one of the other 
operators at the end of the line).  This makes me quite reluctant to 
change it:  people get upset about changes to the look of their old 
scripts, because they trigger spurious check errors.

Duncan Murdoch


> 
>>>> The fact that it isn't the one you want doesn't mean it needs
>>>> to be listed as an outstanding issue in the bug reporting system.
>>> Okay. Where can I list "minor" wishes?
>> On your to-do list?
> 
> Yes, that's a good idea!
> This is my patch of /src/main/names.c:
> 
> --- names.c.orig        2007-01-16 11:03:24.000000000 +0100
> +++ names.c     2007-01-16 10:30:43.000000000 +0100
> @@ -149,7 +149,7 @@
>  {"+",   do_arith, PLUSOP, 1, 2, {PP_BINARY,  PREC_SUM,    0}},
>  {"-",   do_arith, MINUSOP,1, 2, {PP_BINARY,  PREC_SUM,    0}},
>  {"*",   do_arith, TIMESOP,1, 2, {PP_BINARY,  PREC_PROD,   0}},
> -{"/",   do_arith, DIVOP,  1, 2, {PP_BINARY2, PREC_PROD,   0}},
> +{"/",   do_arith, DIVOP,  1, 2, {PP_BINARY,  PREC_PROD,   0}},
>  {"^",   do_arith, POWOP,  1, 2, {PP_BINARY2, PREC_POWER,  1}},
>  {"%%",  do_arith, MODOP,  1, 2, {PP_BINARY2, PREC_PERCENT,0}},
>  {"%/%", do_arith, IDIVOP, 1, 2, {PP_BINARY2, PREC_PERCENT,0}},
> 
> (I have removed some blanks so that each line fits in a single line)
> 
> Now I get:
> R> deparse(parse( text = "a+b-c*d/e" ))
> [1] "expression(a + b - c * d / e)"
> 
> Does this patch has any negative side effects?
> 
> "make check" fails, but AFAIK this is just because of different positions of 
> line breaks:
> [...]
> running code in 'reg-tests-2.R' ... OK
> comparing 'reg-tests-2.Rout' 
> to './reg-tests-2.Rout.save' ...3639,3640c3639,3640
> < aov(formula = dep.variable ~ f1 * f2 + Error(subject / (f1 +
> <     f2)), data = sample.df)
> ---
>> aov(formula = dep.variable ~ f1 * f2 + Error(subject/(f1 + f2)),
>>     data = sample.df)
> 3693,3694c3693,3694
> < aov(formula = dep.variable ~ f1 * f2 + Error(subject / (f2 +
> <     f1)), data = sample.df)
> ---
>> aov(formula = dep.variable ~ f1 * f2 + Error(subject/(f2 + f1)),
>>     data = sample.df)
> make[3]: *** [reg-tests-2.Rout] Fehler 1
> [...]
> 
>> Duncan Murdoch
> 
> Thank you for all your hints,
> Arne
>


From hin-tak.leung at cimr.cam.ac.uk  Tue Jan 16 13:48:02 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Tue, 16 Jan 2007 12:48:02 +0000
Subject: [Rd] mingw-cross with R 2.4.x Re: wine and build difference
 between R.2.4.0 and R 2.4.1 windows binaries?
In-Reply-To: <45ACA559.5010909@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk>	<45A545B1.6070508@stats.uwo.ca>	<45A6250C.3020802@cimr.cam.ac.uk>	<45A629E0.8090100@stats.uwo.ca>	<45A79EB8.8010606@cimr.cam.ac.uk>	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>	<45A7BF93.1090109@cimr.cam.ac.uk>	<45A7CE6F.2050103@stats.uwo.ca>
	<45A7D2C3.1050204@cimr.cam.ac.uk>	<45ABCCBF.3080204@cimr.cam.ac.uk>
	<45ACA559.5010909@cimr.cam.ac.uk>
Message-ID: <45ACC982.3000207@cimr.cam.ac.uk>

Hin-Tak Leung wrote:
<wine failed to load mingw 3.11 compiled R 2.4.1>
> The issue is filed as http://bugs.winehq.org/show_bug.cgi?id=7181

One of the main wine developers, Alexandre Julliard, closed the bug
with a patch. I'll patch my wine and see... pretty good going to resolve
a bug within a day...(if the patch works).


From ripley at stats.ox.ac.uk  Tue Jan 16 13:59:33 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 16 Jan 2007 12:59:33 +0000 (GMT)
Subject: [Rd] mingw-cross with R 2.4.x Re: wine and build difference
 between R.2.4.0 and R 2.4.1 windows binaries?
In-Reply-To: <45ACC982.3000207@cimr.cam.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
	<45A7BF93.1090109@cimr.cam.ac.uk> <45A7CE6F.2050103@stats.uwo.ca>
	<45A7D2C3.1050204@cimr.cam.ac.uk> <45ABCCBF.3080204@cimr.cam.ac.uk>
	<45ACA559.5010909@cimr.cam.ac.uk> <45ACC982.3000207@cimr.cam.ac.uk>
Message-ID: <Pine.LNX.4.64.0701161256530.18855@gannet.stats.ox.ac.uk>

On Tue, 16 Jan 2007, Hin-Tak Leung wrote:

> Hin-Tak Leung wrote:
> <wine failed to load mingw 3.11 compiled R 2.4.1>
>> The issue is filed as http://bugs.winehq.org/show_bug.cgi?id=7181
>
> One of the main wine developers, Alexandre Julliard, closed the bug
> with a patch. I'll patch my wine and see... pretty good going to resolve
> a bug within a day...(if the patch works).

I suspect R's median bug resolution time is about that.  (For non-spam 
reported bugs it certainly is, as around 50% are not bugs in R.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hin-tak.leung at cimr.cam.ac.uk  Tue Jan 16 14:55:51 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Tue, 16 Jan 2007 13:55:51 +0000
Subject: [Rd] mingw-cross with R 2.4.x Re: wine and build difference
 between R.2.4.0 and R 2.4.1 windows binaries?
In-Reply-To: <Pine.LNX.4.64.0701161256530.18855@gannet.stats.ox.ac.uk>
References: <45A53E92.6070104@cimr.cam.ac.uk> <45A545B1.6070508@stats.uwo.ca>
	<45A6250C.3020802@cimr.cam.ac.uk> <45A629E0.8090100@stats.uwo.ca>
	<45A79EB8.8010606@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701121446340.11132@gannet.stats.ox.ac.uk>
	<45A7BF93.1090109@cimr.cam.ac.uk> <45A7CE6F.2050103@stats.uwo.ca>
	<45A7D2C3.1050204@cimr.cam.ac.uk> <45ABCCBF.3080204@cimr.cam.ac.uk>
	<45ACA559.5010909@cimr.cam.ac.uk> <45ACC982.3000207@cimr.cam.ac.uk>
	<Pine.LNX.4.64.0701161256530.18855@gannet.stats.ox.ac.uk>
Message-ID: <45ACD967.2010100@cimr.cam.ac.uk>

Prof Brian Ripley wrote:
> On Tue, 16 Jan 2007, Hin-Tak Leung wrote:
> 
>> Hin-Tak Leung wrote:
>> <wine failed to load mingw 3.11 compiled R 2.4.1>
>>> The issue is filed as http://bugs.winehq.org/show_bug.cgi?id=7181
>>
>> One of the main wine developers, Alexandre Julliard, closed the bug
>> with a patch. I'll patch my wine and see... pretty good going to resolve
>> a bug within a day...(if the patch works).
> 
> I suspect R's median bug resolution time is about that.  (For non-spam 
> reported bugs it certainly is, as around 50% are not bugs in R.)

Possibly - but then, most bugs in most medium size software are
shallow (wine's code base is 11MB bz'ed, while R is 15GB gz'ed,
so they are probably comparable in size/complexity, other than wine is a 
bit harder having to imitate a "black-box operation") - the upper
quantile or something further up might be a more interesting
measure :-).

My patched wine rpm build has finished, and I can confirm that I can
now launch 2.4.1 and 2.5dev with it.

Thanks.
Hin-Tak


From MATILDE.TREVISANI at econ.units.it  Tue Jan 16 11:30:14 2007
From: MATILDE.TREVISANI at econ.units.it (MATILDE.TREVISANI at econ.units.it)
Date: Tue, 16 Jan 2007 11:30:14 +0100 (CET)
Subject: [Rd] histbackback function code needs a change with R 2.4.1 version
	(PR#9456)
Message-ID: <20070116103014.AB4CA57338@slim.kubism.ku.dk>

Dear Author and Maintainer of Hmisc contributed package,
Dear R developers,
 
i noticed a problem with histbackback routine when i installed the last version of R (2.4.1)
(With my previous version, 2.3.1, there was no such a problem)
 
If, e.g., you simply edit the command
 
> histbackback(rnorm(20), rnorm(30))
 
a warning message is printed on the console.
 
Warning messages:
1: argument 'probability' is not made use of in: hist.default(x, breaks = brks, plot = FALSE, probability = probability) 
2: argument 'probability' is not made use of in: hist.default(y, breaks = brks, plot = FALSE, probability = probability) 
 
To fix this problem I simply REPLACE lines 26-27 of histbackback() code:
 
ll <- hist(x, breaks = brks, plot = FALSE,probability=probability)
rr <- hist(y, breaks = brks, plot = FALSE,probability=probability)
 
with:
 
ll <- hist(x, breaks = brks, plot = FALSE)
rr <- hist(y, breaks = brks, plot = FALSE) 
 
The problem -- i guess --  is generated by the call to hist() which judges "incompatible" setting
plot = FALSE and contemporarily specifying the probability argument.
In fact, the description of plot argument in hist() function is as follows:
 
plot	 logical. If TRUE (default), a histogram is plotted, otherwise a list of breaks and counts is returned. In the latter case, a warning is used if (typically graphical) arguments are specified that only apply to the plot = TRUE case.

Hence, another correction could be to REMOVE probability argument from the list of "(typically graphical)" arguments that only apply to the plot = TRUE case. 

Then, it becomes a basic matter of R package.

Hope to be of some help and of course I would be very grateful ro receive any comment about.

Sincerely,

Matilde Trevisani


From charles.dupont at vanderbilt.edu  Tue Jan 16 19:24:03 2007
From: charles.dupont at vanderbilt.edu (Charles Dupont)
Date: Tue, 16 Jan 2007 12:24:03 -0600
Subject: [Rd] Why does not the command 'length(a <- 1:5) <- 4' not work?
Message-ID: <45AD1843.1090305@vanderbilt.edu>

when running the command
  > length(a <- 1:5) <- 4

there are two responses.

If 'a' does not exist then the response is

Error in length(a <- 1:5) <- 4 : object "a" not found

If 'a' does exist then the response is

Error in length(a <- 1:5) <- 4 : could not find function "<-<-"

I would assume that 'length(a <- 1:5) <- 4' should work because 
'length(a <- 1:5)' does work.

Thank you for your help.

Charles Dupont
-- 
Charles Dupont	Computer System Analyst		School of Medicine
		Department of Biostatistics	Vanderbilt University


From ripley at stats.ox.ac.uk  Tue Jan 16 19:52:55 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Tue, 16 Jan 2007 19:52:55 +0100 (CET)
Subject: [Rd] histbackback function code needs a change with R 2.4.1
	(PR#9457)
Message-ID: <20070116185255.059354BE77@slim.kubism.ku.dk>

On Tue, 16 Jan 2007, MATILDE.TREVISANI at econ.units.it wrote:

> Dear Author and Maintainer of Hmisc contributed package,

Wromg address, wrong bug repository.

Both the R posting guide and the R FAQ warn you that what you have just 
done is a waste of resources.

[...]

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From tlumley at u.washington.edu  Tue Jan 16 20:02:01 2007
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue, 16 Jan 2007 11:02:01 -0800 (PST)
Subject: [Rd] incorrect result of deriv (PR#9449)
In-Reply-To: <20070112174943.12AB43F03B@slim.kubism.ku.dk>
References: <20070112174943.12AB43F03B@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.64.0701161101070.31153@homer21.u.washington.edu>


This is as documented in help(deriv)
      The internal code knows about the arithmetic operators '+', '-',
      '*', '/' and '^', and the single-variable functions 'exp', 'log',
      'sin', 'cos', 'tan', 'sinh', 'cosh', 'sqrt', 'pnorm', 'dnorm',
      'asin', 'acos', 'atan', 'gamma' and 'lgamma'. (Note that only the
      standard normal distribution is considered.)



 	-thomas




On Fri, 12 Jan 2007, polzehl at pubhealth.ku.dk wrote:

> Full_Name: Joerg Polzehl
> Version: 2.3.1
> OS: x86_64, linux-gnu
> Submission from: (NULL) (62.141.176.22)
>
>
> I observed an incorrect behavior of function deriv when evaluating arguments of
> dnorm
>
> deriv(~dnorm(z,0,s),"z")
> expression({
>    .value <- dnorm(z, 0, s)
>    .grad <- array(0, c(length(.value), 1), list(NULL, c("z")))
>    .grad[, "z"] <- -(z * dnorm(z))
>    attr(.value, "gradient") <- .grad
>    .value
> })
>
> deriv(~exp(-z^2/(2*s^2))/s/sqrt(2*pi),"z")
> expression({
>    .expr4 <- 2 * s^2
>    .expr6 <- exp(-z^2/.expr4)
>    .expr9 <- sqrt(2 * pi)
>    .value <- .expr6/s/.expr9
>    .grad <- array(0, c(length(.value), 1), list(NULL, c("z")))
>    .grad[, "z"] <- -(.expr6 * (2 * z/.expr4)/s/.expr9)
>    attr(.value, "gradient") <- .grad
>    .value
> })
>
> should provide the same expression but
>
>> eval(deriv(~exp(-z^2/(2*s^2))/s/sqrt(2*pi),"z"),list(z=1,s=2))
> [1] 0.1760327
> attr(,"gradient")
>               z
> [1,] -0.04400817
>
>> eval(deriv(~dnorm(z,0,s),"z"),list(z=1,s=2))
> [1] 0.1760327
> attr(,"gradient")
>              z
> [1,] -0.2419707
>
> provide different gradients ...
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From murdoch at stats.uwo.ca  Tue Jan 16 20:12:39 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 16 Jan 2007 14:12:39 -0500
Subject: [Rd] Why does not the command 'length(a <- 1:5) <- 4' not work?
In-Reply-To: <45AD1843.1090305@vanderbilt.edu>
References: <45AD1843.1090305@vanderbilt.edu>
Message-ID: <45AD23A7.4080702@stats.uwo.ca>

On 1/16/2007 1:24 PM, Charles Dupont wrote:
> when running the command
>   > length(a <- 1:5) <- 4
> 
> there are two responses.
> 
> If 'a' does not exist then the response is
> 
> Error in length(a <- 1:5) <- 4 : object "a" not found
> 
> If 'a' does exist then the response is
> 
> Error in length(a <- 1:5) <- 4 : could not find function "<-<-"
> 
> I would assume that 'length(a <- 1:5) <- 4' should work because 
> 'length(a <- 1:5)' does work.

I'm guessing you are assuming it would mean the same as

a <- 1:5
length(a) <- 4

But how would R know the name of the variable whose length is set in the 
second line?  In "a <- 1:5" the "a" is just part of a larger expression, 
it's not special as in some other languages, i.e. R sees that as

"<-"(a, 1:5)

So if you rewrote your original as

length("<-"(a, 1:5)) <- 4

it is a lot less clear that you really mean to create and then change "a".

In general things like

foo(a) <- b

are evaluated as "foo<-"(a, b), where "foo<-" is a function that expects 
a variable reference as its first argument.  There's some magic going on 
to allow things like

a <- matrix(1:4, 2,2)
names(dim(a)) <- letters[1:2]

and I think the parser is trying to set things up for that kind of magic 
in your expression, though I haven't traced through the execution path 
to explain exactly why you saw the error messages you saw.

Duncan Murdoch


From tlumley at u.washington.edu  Tue Jan 16 20:26:27 2007
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue, 16 Jan 2007 11:26:27 -0800 (PST)
Subject: [Rd] Why does not the command 'length(a <- 1:5) <- 4' not work?
In-Reply-To: <45AD1843.1090305@vanderbilt.edu>
References: <45AD1843.1090305@vanderbilt.edu>
Message-ID: <Pine.LNX.4.64.0701161103080.31153@homer21.u.washington.edu>

On Tue, 16 Jan 2007, Charles Dupont wrote:

> I would assume that 'length(a <- 1:5) <- 4' should work because
> 'length(a <- 1:5)' does work.

Appearances can be deceptive.

length(a <- 1:5) evaluates a <- 1:5 and then passes its value to length(), 
in ordinary call-by-value semantics.

That can't be how complex assignment functions work, though.

Consider

length(names(a))<-5

and suppose names(a) is c("A","B").  This code doesn't just evaluate 
names(a) and pass the result on, since
    length(c("A","B"))<-5
would be silly (and invalid).  It must be doing something more 
complicated to make sure that "a", buried deep inside the call, gets 
updated.

What actually happens is that
   f(x) <- y
is rewritten in terms of the assignment function "f<-" as
   x <- "f<-"(x, y)
so
   length(names(a))<-5
is
   names(a) <- "length<-"(names(a), 5)
which in turn is
   a <- "names<-"(a, "length<-"(names(a), 5))

This requires the assignment function "f<-" to exist, of course.

In your case
   length(a <- 1:5) <- 4
is rewritten as
   (a<-1:5) <- "length<-"(a<-1:5, 5)
and then as
   a <- "<-<-"(a, "length<-"(a<-1:5, 5))
which gives the error you report -- there is no function "<-<-".

You  might think the last stage of rewriting could just be avoided, but
   (a<-1:5) <- "length<-"(a<-1:5, 5)
is invalid if not rewritten, since it tries to modify 1:5, which is not a 
variable.

If you want to compute
    a <- 1:5
    length(a)<-4
then just do it like that.


 	-thomas


From edd at debian.org  Tue Jan 16 22:02:08 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 16 Jan 2007 15:02:08 -0600
Subject: [Rd] on.exit called on loading ?
Message-ID: <17837.15696.636229.572815@basebud.nulle.part>


I just found out that an .onLoad() function such as this stylized one (where
I just renamed some identifiers)


.onLoad <- function(lib, pkg) {
  require(zoo, quiet=TRUE, warn.conflicts=FALSE)
  library.dynam("foolib", pkg, lib )
  if (.Platform$OS.type != "windows") {
    initSomeServices()
  }
  if (.Platform$OS.type != "windows") {
    on.exit(closeSomeServices())
  }
}

actually triggers a call of 'closeSomeServices()'. I am probably
misunderstanding something here -- but I thought on.exit() would only be
called on, well, exit ?

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison


From murdoch at stats.uwo.ca  Tue Jan 16 22:39:02 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 16 Jan 2007 16:39:02 -0500
Subject: [Rd] on.exit called on loading ?
In-Reply-To: <17837.15696.636229.572815@basebud.nulle.part>
References: <17837.15696.636229.572815@basebud.nulle.part>
Message-ID: <45AD45F6.4070003@stats.uwo.ca>

On 1/16/2007 4:02 PM, Dirk Eddelbuettel wrote:
> I just found out that an .onLoad() function such as this stylized one (where
> I just renamed some identifiers)
> 
> 
> .onLoad <- function(lib, pkg) {
>   require(zoo, quiet=TRUE, warn.conflicts=FALSE)
>   library.dynam("foolib", pkg, lib )
>   if (.Platform$OS.type != "windows") {
>     initSomeServices()
>   }
>   if (.Platform$OS.type != "windows") {
>     on.exit(closeSomeServices())
>   }
> }
> 
> actually triggers a call of 'closeSomeServices()'. I am probably
> misunderstanding something here -- but I thought on.exit() would only be
> called on, well, exit ?

It's the exit from the function, not the exit from the package (which 
isn't really all that well defined -- do you mean unloading, exit from 
R, detaching??

It's not very easy to have something be guaranteed to execute "when 
you're done".  The RODBC package does it using an external pointer, 
which has a hook that is called when R shuts down.  If it's good enough 
to execute on unloading but skip execution on shutdown, then .onUnload 
is available.

Duncan Murdoch


From hb at stat.berkeley.edu  Tue Jan 16 22:41:45 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 17 Jan 2007 08:41:45 +1100
Subject: [Rd] on.exit called on loading ?
In-Reply-To: <17837.15696.636229.572815@basebud.nulle.part>
References: <17837.15696.636229.572815@basebud.nulle.part>
Message-ID: <59d7961d0701161341p56a6e835h976151743665de25@mail.gmail.com>

on.exit() applies to the function where it was called, i.e.
closeSomeServices() is called when .onLoad() exits, or whatever
function it is defined in.  You're looking for .onUnload().  Make sure
to read the help for details.

Cheers

Henrik


On 1/17/07, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> I just found out that an .onLoad() function such as this stylized one (where
> I just renamed some identifiers)
>
>
> .onLoad <- function(lib, pkg) {
>   require(zoo, quiet=TRUE, warn.conflicts=FALSE)
>   library.dynam("foolib", pkg, lib )
>   if (.Platform$OS.type != "windows") {
>     initSomeServices()
>   }
>   if (.Platform$OS.type != "windows") {
>     on.exit(closeSomeServices())
>   }
> }
>
> actually triggers a call of 'closeSomeServices()'. I am probably
> misunderstanding something here -- but I thought on.exit() would only be
> called on, well, exit ?
>
> Dirk
>
> --
> Hell, there are no rules here - we're trying to accomplish something.
>                                                   -- Thomas A. Edison
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ross at biostat.ucsf.edu  Tue Jan 16 23:03:00 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Tue, 16 Jan 2007 14:03:00 -0800
Subject: [Rd] Problems with checking documentation vs data, and a proposal
Message-ID: <1168984980.28142.42.camel@iron.psg.net>

I have a single data file inputs.RData that contains 3 objects.  I
generated an Rd page for each object using prompt().
When I run R CMD check I get
* checking for code/documentation mismatches ... WARNING
Warning in utils::data(list = al, envir = data_env) : 
	 data set 'gold' not found
(gold is one of the objects).

This appears to be coming from the codocData function defined in
src/library/tools/R/QC.R (this is in the Debianised source 2.4.1, so the
path might be a little different).

According to the help on this function, it will only attempt a match
when there is a single alias in the documentation file, although I'm not
sure that's what the code does (it seems to check only if there is more
than one format section).  At any rate, the central logic appears to
gather up names of data objects and then to load them with
            ## Try loading the data set into data_env.
            utils::data(list = al, envir = data_env)
            if(exists(al, envir = data_env, mode = "list",
                      inherits = FALSE)) {
                al <- get(al, envir = data_env, mode = "list")
            }
Since there is no gold.RData, this is failing.

This leads to 2 issues: what should I do now, and how might this work
better in the future.

Taking the future first, how about having the code first load all the
data files that it finds somewhere near the beginning?  If it did so,
the code
        ## Try finding the variable or data set given by the alias.
        al <- aliases[i]
        if(exists(al, envir = code_env, mode = "list",
                  inherits = FALSE)) {
which precedes the earlier snippet, would find the symbol was defined
and be happy.  I suppose the data could be loaded into code_env,
although using it seems to risk deciding that a data symbol is defined
when the symbol refers to a code object.

I'm not sure if attempting to load the data objects individually should
still be attempted under this scenario, if the symbol is not already
present.

What can I do in the short run, particularly since I would like to have
the code pass R CMD check with versions of R that don't include this
possible enhancement, what can I do?  I see several options, none of
them beautiful:
1) Delete inputs.RData and create 3 separate data objects.  However, I
have code that relies on inputs being present, and the 3 data items go
together naturally.
2) Make a single document describing inputs.RData.  First problem: the
page would be awkward combining all 3 things.  Second, it looks as if
codocData might still try loading the individual data objects, since it
tries to pull data names out of the documentation, even out of
individual item inside \describe.
3) Attempt to disable the checks by adding multiple aliases or something
else to be revealed by closer inspection of the code.  This is a hack
that bypasses the checking altogether (unless it turns out I still get a
complaint about missing documentation).
4) Create gold.RData and others as symlinks to inputs.RData.  Fragile
across operating systems, version control systems, and versions of tar.
Might get errors about multiple data definitions.

Usual caveats: this is all based on my imperfect understanding of the
code.

So, any comments on the possible modification to codocData or the
work-arounds?
-- 
Ross Boylan                                      wk:  (415) 514-8146
185 Berry St #5700                               ross at biostat.ucsf.edu
Dept of Epidemiology and Biostatistics           fax: (415) 514-8150
University of California, San Francisco
San Francisco, CA 94107-1739                     hm:  (415) 550-1062


From edd at debian.org  Tue Jan 16 23:12:43 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 16 Jan 2007 16:12:43 -0600
Subject: [Rd] on.exit called on loading ?
In-Reply-To: <45AD45F6.4070003@stats.uwo.ca>
References: <17837.15696.636229.572815@basebud.nulle.part>
	<45AD45F6.4070003@stats.uwo.ca>
Message-ID: <17837.19931.177286.821128@basebud.nulle.part>


On 16 January 2007 at 16:39, Duncan Murdoch wrote:
| On 1/16/2007 4:02 PM, Dirk Eddelbuettel wrote:
| > I just found out that an .onLoad() function such as this stylized one (where
| > I just renamed some identifiers)
| > 
| > 
| > .onLoad <- function(lib, pkg) {
| >   require(zoo, quiet=TRUE, warn.conflicts=FALSE)
| >   library.dynam("foolib", pkg, lib )
| >   if (.Platform$OS.type != "windows") {
| >     initSomeServices()
| >   }
| >   if (.Platform$OS.type != "windows") {
| >     on.exit(closeSomeServices())
| >   }
| > }
| > 
| > actually triggers a call of 'closeSomeServices()'. I am probably
| > misunderstanding something here -- but I thought on.exit() would only be
| > called on, well, exit ?
| 
| It's the exit from the function, not the exit from the package (which 
| isn't really all that well defined -- do you mean unloading, exit from 
| R, detaching??

Thanks to Robert (off-list), Henrik and Duncan -- I had indeed forgotten /
confused what on.exit() is for. Works as advertised here, but that wasn't
what I wanted at the time. Entirely my bad.
 
| It's not very easy to have something be guaranteed to execute "when 
| you're done".  The RODBC package does it using an external pointer, 
| which has a hook that is called when R shuts down.  If it's good enough 
| to execute on unloading but skip execution on shutdown, then .onUnload 
| is available.

Yes, I am dealing with a moderately more complicated situation (of
subscribing to some stateful internal 'services') and had not found 
.onUnload to be as reliable as I had hoped. But that's another issue.

Thanks again,  Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison


From ross at biostat.ucsf.edu  Tue Jan 16 23:38:10 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Tue, 16 Jan 2007 14:38:10 -0800
Subject: [Rd] Problems with checking documentation vs data,
	and a proposal
In-Reply-To: <1168984980.28142.42.camel@iron.psg.net>
References: <1168984980.28142.42.camel@iron.psg.net>
Message-ID: <1168987091.28142.45.camel@iron.psg.net>

On Tue, 2007-01-16 at 14:03 -0800, Ross Boylan wrote:
> I have a single data file inputs.RData that contains 3 objects.  I
> generated an Rd page for each object using prompt().
> When I run R CMD check I get
> * checking for code/documentation mismatches ... WARNING
> Warning in utils::data(list = al, envir = data_env) : 
> 	 data set 'gold' not found
> (gold is one of the objects).
.....
> What can I do in the short run, particularly since I would like to have
> the code pass R CMD check with versions of R that don't include this
> possible enhancement, what can I do?  I see several options, none of
> them beautiful:
...
> 4) Create gold.RData and others as symlinks to inputs.RData.  Fragile
> across operating systems, version control systems, and versions of tar.
> Might get errors about multiple data definitions.

Option 4 worked, though the symlinks were converted to regular files by
R CMD check.


From hpages at fhcrc.org  Wed Jan 17 04:15:25 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Tue, 16 Jan 2007 19:15:25 -0800
Subject: [Rd] file.copy
Message-ID: <45AD94CD.1000003@fhcrc.org>

Hi,

Copying a non-existing file with file.copy creates an empty file

  > r <- file.copy("non-existing-file", ".")
  > r
  [1] TRUE

... and returns TRUE!

Now, when used in "vectorized" mode

  > r <- file.copy(c("toto1", "toto2"), c("dest1", "dest2"))
  [1] FALSE FALSE

file.copy looks much more reasonable, except that files "dest1"
and "dest2" are still created (despite the fact that "toto1" and
"toto2" don't exist).

If the 'to' argument is not a dir:

  > r <- file.copy(c("toto3", "toto4"), ".")
  > r
  [1] TRUE TRUE

!!?!?

May be those are (undocumented) features, but I bet 99.9% of the users would
expect something different...

Cheers,
H.


From hb at stat.berkeley.edu  Wed Jan 17 07:52:42 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 17 Jan 2007 17:52:42 +1100
Subject: [Rd] file.copy
In-Reply-To: <45AD94CD.1000003@fhcrc.org>
References: <45AD94CD.1000003@fhcrc.org>
Message-ID: <59d7961d0701162252u2758b5abncb0e0e1943af1efc@mail.gmail.com>

FYI: I reported this to r-devel on July 23, 2006:

 http://tolstoy.newcastle.edu.au/R/devel/06/07/6220.html

There was no follow up.

/Henrik

On 1/17/07, Herve Pages <hpages at fhcrc.org> wrote:
> Hi,
>
> Copying a non-existing file with file.copy creates an empty file
>
>   > r <- file.copy("non-existing-file", ".")
>   > r
>   [1] TRUE
>
> ... and returns TRUE!
>
> Now, when used in "vectorized" mode
>
>   > r <- file.copy(c("toto1", "toto2"), c("dest1", "dest2"))
>   [1] FALSE FALSE
>
> file.copy looks much more reasonable, except that files "dest1"
> and "dest2" are still created (despite the fact that "toto1" and
> "toto2" don't exist).
>
> If the 'to' argument is not a dir:
>
>   > r <- file.copy(c("toto3", "toto4"), ".")
>   > r
>   [1] TRUE TRUE
>
> !!?!?
>
> May be those are (undocumented) features, but I bet 99.9% of the users would
> expect something different...
>
> Cheers,
> H.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From friedrich.leisch at stat.uni-muenchen.de  Wed Jan 17 09:19:20 2007
From: friedrich.leisch at stat.uni-muenchen.de (Friedrich Leisch)
Date: Wed, 17 Jan 2007 09:19:20 +0100
Subject: [Rd] [OT] old news on the home page
In-Reply-To: <b0808fdc0701150801p440ba6d2lf737e78d55baf207@mail.gmail.com>
References: <b0808fdc0701150801p440ba6d2lf737e78d55baf207@mail.gmail.com>
Message-ID: <17837.56328.451394.550702@lxh5.stat.uni-muenchen.de>

>>>>> On Mon, 15 Jan 2007 17:01:47 +0100,
>>>>> Antonio, Fabio Di Narzo (AFDN) wrote:

  > Hi all.
  > I've noticed that on the R homepage:
  > http://www.r-project.org/
  > one can read, as the latest news:
  > " R version 2.4.0 has been released on 2006-10-03."
  > and can't find any citation of the 2.4.1 release of the last 18 december.

Thanks a lot for the hint, fixed in SVN (will automatically go online
later today).

Best,
Fritz

-- 
-----------------------------------------------------------------------
Prof. Dr. Friedrich Leisch 

Institut f?r Statistik                          Tel: (+49 89) 2180 3165
Ludwig-Maximilians-Universit?t                  Fax: (+49 89) 2180 5308
Ludwigstra?e 33
D-80539 M?nchen                 http://www.stat.uni-muenchen.de/~leisch


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Wed Jan 17 18:53:15 2007
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: Wed, 17 Jan 2007 18:53:15 +0100
Subject: [Rd] R_ParseVector API change
Message-ID: <200701171853.20328.thomas.friedrichsmeier@ruhr-uni-bochum.de>

Dear R developers,

just a quick question: I noted that R_ParseVector () has gained an additional 
parameter (since SVN rev. 39999). Since R_ParseVector () is part of the 
public API, I'm wondering, whether this API change was intentional or not. 
Either way is fine with me, but in order to make sure the next release of 
RKWard will be compilable with R 2.5.0, I'd like to make sure, whether or not 
the change is here to stay.

Regards
Thomas Friedrichsmeier
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20070117/fac8d584/attachment.bin 

From murdoch at stats.uwo.ca  Wed Jan 17 19:17:54 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 17 Jan 2007 13:17:54 -0500
Subject: [Rd] R_ParseVector API change
In-Reply-To: <200701171853.20328.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <200701171853.20328.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <45AE6852.4050104@stats.uwo.ca>

On 1/17/2007 12:53 PM, Thomas Friedrichsmeier wrote:
> Dear R developers,
> 
> just a quick question: I noted that R_ParseVector () has gained an additional 
> parameter (since SVN rev. 39999). Since R_ParseVector () is part of the 
> public API, I'm wondering, whether this API change was intentional or not. 
> Either way is fine with me, but in order to make sure the next release of 
> RKWard will be compilable with R 2.5.0, I'd like to make sure, whether or not 
> the change is here to stay.

The change was accidental (I forgot that R_ParseVector was in the API 
when I made it), but I think it will stay.  Setting the value of this 
parameter to R_NilValue gets the old behaviour.  Setting it to some 
other SEXP will have that SEXP recorded as the srcfile attribute of 
source references.

I think the description above is the level of detail of the 
implementation that it's safe to work with.  The particular format of 
source references could change.

Duncan Murdoch


From simon.urbanek at r-project.org  Wed Jan 17 19:17:57 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 17 Jan 2007 13:17:57 -0500
Subject: [Rd] R_ParseVector API change
In-Reply-To: <200701171853.20328.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <200701171853.20328.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <703F8D48-BB03-4552-8224-9696046B1E84@r-project.org>

Thomas,

On Jan 17, 2007, at 12:53 PM, Thomas Friedrichsmeier wrote:

> Dear R developers,
>
> just a quick question: I noted that R_ParseVector () has gained an  
> additional  parameter (since SVN rev. 39999). Since R_ParseVector  
> () is part of the  public API, I'm wondering, whether this API  
> change was intentional or not.

Yes, it was intentional (added support for keep.source I believe).  
Duncan, you may want to add the API change to NEWS - it's not  
mentioned there.

Cheers,
Simon


From charlie at stat.umn.edu  Wed Jan 17 20:50:57 2007
From: charlie at stat.umn.edu (charlie at stat.umn.edu)
Date: Wed, 17 Jan 2007 20:50:57 +0100 (CET)
Subject: [Rd] uninformative error message in R CMD check (PR#9459)
Message-ID: <20070117195057.3E2E04C9CA@slim.kubism.ku.dk>

I just saw the following using R version 2.4.1 (2006-12-18) in
output from R CMD check.

    * checking Rd files ... WARNING
    Error in as.vector(x, mode) : invalid argument 'mode'
    Execution halted
    See the chapter 'Writing R documentation files' in manual 'Writing R
    Extensions'.

In looking at the help page (the only one in the package so far) I noticed
that there was no details section even though I wrote one.  The problem
was a missing close curly, that is, I had

    \details{
    Blah, blah, blah.
    \value{
    A list ....
    }

I don't know whether it is possible to have an actually informative
error message, but it would be nice if possible.  The error went away
and the package checked OK when I added the close curly

    \details{
    Blah, blah, blah.
    }
    \value{
    A list ....
    }
-- 
Charles Geyer
Professor, School of Statistics
University of Minnesota
charlie at stat.umn.edu


From ahenningsen at email.uni-kiel.de  Wed Jan 17 23:09:37 2007
From: ahenningsen at email.uni-kiel.de (Arne Henningsen)
Date: Wed, 17 Jan 2007 23:09:37 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
	(PR#9444)
In-Reply-To: <45ACBB2B.3000705@stats.uwo.ca>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>
	<200701161126.30431.ahenningsen@email.uni-kiel.de>
	<45ACBB2B.3000705@stats.uwo.ca>
Message-ID: <200701172309.37981.ahenningsen@email.uni-kiel.de>

On Tuesday, 16. January 2007 12:46, Duncan Murdoch wrote:
> On 1/16/2007 5:26 AM, Arne Henningsen wrote:
> > [...]
> > Is there any reason for deparse() to add spaces around "+", "-", and "*"
> > operators but not around "/" operators?
> > R> deparse(parse( text = "a+b-c*d/e" ))
> > [1] "expression(a + b - c * d/e)"
>
> I don't know, but it has been like that for the complete history of the
> source code in the repository (almost 10 years).  I suppose someone thought
>
>   a + b - c * d /
>   e
>
> would look ugly (even though they were happy to put one of the other
> operators at the end of the line).  

What do the other developeRs and useRs think about this?

> This makes me quite reluctant to 
> change it:  people get upset about changes to the look of their old
> scripts, because they trigger spurious check errors.

Is it possible to add an option to specify whether "/" operators should be 
treated like "+", "-", and "*" operators or not?

Arne

> Duncan Murdoch
>
> >>>> The fact that it isn't the one you want doesn't mean it needs
> >>>> to be listed as an outstanding issue in the bug reporting system.
> >>>
> >>> Okay. Where can I list "minor" wishes?
> >>
> >> On your to-do list?
> >
> > Yes, that's a good idea!
> > This is my patch of /src/main/names.c:
> >
> > --- names.c.orig        2007-01-16 11:03:24.000000000 +0100
> > +++ names.c     2007-01-16 10:30:43.000000000 +0100
> > @@ -149,7 +149,7 @@
> >  {"+",   do_arith, PLUSOP, 1, 2, {PP_BINARY,  PREC_SUM,    0}},
> >  {"-",   do_arith, MINUSOP,1, 2, {PP_BINARY,  PREC_SUM,    0}},
> >  {"*",   do_arith, TIMESOP,1, 2, {PP_BINARY,  PREC_PROD,   0}},
> > -{"/",   do_arith, DIVOP,  1, 2, {PP_BINARY2, PREC_PROD,   0}},
> > +{"/",   do_arith, DIVOP,  1, 2, {PP_BINARY,  PREC_PROD,   0}},
> >  {"^",   do_arith, POWOP,  1, 2, {PP_BINARY2, PREC_POWER,  1}},
> >  {"%%",  do_arith, MODOP,  1, 2, {PP_BINARY2, PREC_PERCENT,0}},
> >  {"%/%", do_arith, IDIVOP, 1, 2, {PP_BINARY2, PREC_PERCENT,0}},
> >
> > (I have removed some blanks so that each line fits in a single line)
> >
> > Now I get:
> > R> deparse(parse( text = "a+b-c*d/e" ))
> > [1] "expression(a + b - c * d / e)"
> >
> > Does this patch has any negative side effects?
> >
> > "make check" fails, but AFAIK this is just because of different positions
> > of line breaks:
> > [...]
> > running code in 'reg-tests-2.R' ... OK
> > comparing 'reg-tests-2.Rout'
> > to './reg-tests-2.Rout.save' ...3639,3640c3639,3640
> > < aov(formula = dep.variable ~ f1 * f2 + Error(subject / (f1 +
> > <     f2)), data = sample.df)
> > ---
> >
> >> aov(formula = dep.variable ~ f1 * f2 + Error(subject/(f1 + f2)),
> >>     data = sample.df)
> >
> > 3693,3694c3693,3694
> > < aov(formula = dep.variable ~ f1 * f2 + Error(subject / (f2 +
> > <     f1)), data = sample.df)
> > ---
> >
> >> aov(formula = dep.variable ~ f1 * f2 + Error(subject/(f2 + f1)),
> >>     data = sample.df)
> >
> > make[3]: *** [reg-tests-2.Rout] Fehler 1
> > [...]
> >
> >> Duncan Murdoch
> >
> > Thank you for all your hints,
> > Arne

-- 
Arne Henningsen
Department of Agricultural Economics
University of Kiel
Olshausenstr. 40
D-24098 Kiel (Germany)
Tel: +49-431-880 4445
Fax: +49-431-880 1397
ahenningsen at agric-econ.uni-kiel.de
http://www.uni-kiel.de/agrarpol/ahenningsen/


From ross at biostat.ucsf.edu  Thu Jan 18 08:56:15 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Wed, 17 Jan 2007 23:56:15 -0800
Subject: [Rd] encoding issues even w/o accents
Message-ID: <20070118075615.GC24158@wheat.betterworld.us>

An earlier thread (in 10/2006) discussed encoding issues in the
context of R data and the desire to represent accented characters.

It matters in another setting: the output generated by R and the
seemingly order character "'" (single quote).  In particular, R CMD
check runs test code and compares the generated output to a saved file
of expected output.  This does not work reliably across encoding
schemes.  This is unfortunate, since it seems the "expected output"
files will necessarily be wrong for someone.

The problem for me was triggered by the single-quote character "'".
On my older systems, this is encoded by 0x27, a perfectly fine ASCII
character.  That is on a Debian GNU/Linux system with LANG=en_US.  On
a newer system I have LANG=en_US.UTF-8.  I don't recall whether
this was a deliberate choice on my part, or simply reflects changing
defaults for the installer.  (Note the earlier thread referred to the
Debian-derived Ubuntu systems as having switched to UTF-8).  Under
UTF-8 the same character is encoded in the 3-byte sequence 0xE28098
(which seems odd; I thought the point of UTF-8 was that ASCII was a
legitimate subset).

The coefficient  printing methods in the stats package use the
single-quote in the key explaining significance levels:
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

I suppose one possible work-around for R CMD check would be to set the
encoding to  some standard value before it runs tests, but that has
some drawbacks.  It doesn't work for packages needing a different
encoding (but perhaps the package could specify an encoding to use by
default?)(*),  It will leave the output files looking weird on systems
with a different encoding.  It will get messed up if one generates the
files under the wrong encoding.

And none of this addresses stuff beyond the context of output file
comparison in R CMD check.

Any thoughts?

Ross Boylan


* From the R Extensions document, discussing the DESCRIPTION file:
   If the `DESCRIPTION' file is not entirely in ASCII it should contain
an `Encoding' field specifying an encoding.  This is currently used as
the encoding of the `DESCRIPTION' file itself, and may in the future be
taken as the encoding for other documentation in the package.  Only
encoding names `latin1', `latin2' and `UTF-8' are known to be portable.

I would not expect that the test output files be considered
"documentation," but I suppose that's subject to interpretation.


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 18 12:59:39 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 18 Jan 2007 11:59:39 +0000
Subject: [Rd] subsetting matrix by subscript=0,x silently skips.
Message-ID: <45AF612B.2080604@cimr.cam.ac.uk>

(e-mailing to R-bugs is intentional - the web itnerface seems to
be down)

 > a<- cbind(c(1,2), c(3,4))
 > a
      [,1] [,2]
[1,]    1    3
[2,]    2    4

 > a[cbind(c(2,2), c(2,1))]
[1] 4 2
 > a[cbind(c(2,3), c(2,1))]
Error: subscript out of bounds
 > a[cbind(c(2,-1), c(2,1))]
Error: negative values are not allowed in a matrix subscript
 > a[cbind(c(2,0), c(2,1))]
[1] 4

Am somewhat surprised that 2,0 just silently skip over and doesn't
throw an error like 2,0 and 2,-1 . Surely it should throw
an error about subscript should be >= 1?



 > sessionInfo()
R version 2.4.1 (2006-12-18)
i686-redhat-linux-gnu

locale:
LC_CTYPE=en_GB.UTF-8;LC_NUMERIC=C;LC_TIME=en_GB.UTF-8;LC_COLLATE=en_GB.UTF-8;LC_MONETARY=en_GB.UTF-8;LC_MESSAGES=en_GB.UTF-8;LC_PAPER=en_GB.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_GB.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] "splines"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "methods"   "base"

other attached packages:
snpMatrix  survival
   "1.0.4"    "2.30"
 >


From murdoch at stats.uwo.ca  Thu Jan 18 13:02:12 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 18 Jan 2007 07:02:12 -0500
Subject: [Rd] on.exit called on loading ?
In-Reply-To: <17837.19931.177286.821128@basebud.nulle.part>
References: <17837.15696.636229.572815@basebud.nulle.part>	<45AD45F6.4070003@stats.uwo.ca>
	<17837.19931.177286.821128@basebud.nulle.part>
Message-ID: <45AF61C4.6040803@stats.uwo.ca>

On 1/16/2007 5:12 PM, Dirk Eddelbuettel wrote:
> On 16 January 2007 at 16:39, Duncan Murdoch wrote:
> | On 1/16/2007 4:02 PM, Dirk Eddelbuettel wrote:
> | > I just found out that an .onLoad() function such as this stylized one (where
> | > I just renamed some identifiers)
> | > 
> | > 
> | > .onLoad <- function(lib, pkg) {
> | >   require(zoo, quiet=TRUE, warn.conflicts=FALSE)
> | >   library.dynam("foolib", pkg, lib )
> | >   if (.Platform$OS.type != "windows") {
> | >     initSomeServices()
> | >   }
> | >   if (.Platform$OS.type != "windows") {
> | >     on.exit(closeSomeServices())
> | >   }
> | > }
> | > 
> | > actually triggers a call of 'closeSomeServices()'. I am probably
> | > misunderstanding something here -- but I thought on.exit() would only be
> | > called on, well, exit ?
> | 
> | It's the exit from the function, not the exit from the package (which 
> | isn't really all that well defined -- do you mean unloading, exit from 
> | R, detaching??
> 
> Thanks to Robert (off-list), Henrik and Duncan -- I had indeed forgotten /
> confused what on.exit() is for. Works as advertised here, but that wasn't
> what I wanted at the time. Entirely my bad.
>  
> | It's not very easy to have something be guaranteed to execute "when 
> | you're done".  The RODBC package does it using an external pointer, 
> | which has a hook that is called when R shuts down.  If it's good enough 
> | to execute on unloading but skip execution on shutdown, then .onUnload 
> | is available.
> 
> Yes, I am dealing with a moderately more complicated situation (of
> subscribing to some stateful internal 'services') and had not found 
> .onUnload to be as reliable as I had hoped. But that's another issue.

reg.finalizer is probably what you want.  Since 2.4.0 it has had an 
option to be called when R shuts down.

Duncan Murdoch


From jombart at biomserv.univ-lyon1.fr  Thu Jan 18 13:32:08 2007
From: jombart at biomserv.univ-lyon1.fr (Thibaut Jombart)
Date: Thu, 18 Jan 2007 13:32:08 +0100
Subject: [Rd] Wishlist: Sweave: allow line breaks after forward slashes
 (PR#9444)
In-Reply-To: <200701172309.37981.ahenningsen@email.uni-kiel.de>
References: <20070111144243.9B09519BA1@slim.kubism.ku.dk>	<200701161126.30431.ahenningsen@email.uni-kiel.de>	<45ACBB2B.3000705@stats.uwo.ca>
	<200701172309.37981.ahenningsen@email.uni-kiel.de>
Message-ID: <45AF68C8.8070807@biomserv.univ-lyon1.fr>

> What do the other developeRs and useRs think about this?
 
Hi,
I here reply as a R user.

>> This makes me quite reluctant to 
>> change it:  people get upset about changes to the look of their old
>> scripts, because they trigger spurious check errors.
>  
>

> Is it possible to add an option to specify whether "/" operators should be 
> treated like "+", "-", and "*" operators or not?

> Arne

I naively assume that, if this is the first time in 10 years that such a problem arises, it is a rather uncommon one, or at least to scarce to add an option which would seem quite surprising to most of the R users. However, anyone meeting this problem would now be able to correct it using your patch ;-)

Regards,
 
Thibaut.

-- 

######################################
Thibaut JOMBART
CNRS UMR 5558 - Laboratoire de Biom?trie et Biologie Evolutive
Universite Lyon 1
43 bd du 11 novembre 1918
69622 Villeurbanne Cedex
T?l. : 04.72.43.29.35
Fax : 04.72.43.13.88
jombart at biomserv.univ-lyon1.fr
http://biomserv.univ-lyon1.fr/sitelabo/pageperso.php?id_personne=178


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Thu Jan 18 13:47:40 2007
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: Thu, 18 Jan 2007 13:47:40 +0100
Subject: [Rd] Emulating a REPL in frontends
Message-ID: <200701181347.44744.thomas.friedrichsmeier@ruhr-uni-bochum.de>

A common need in R frontends is to provide some sort of read, (parse), 
evaluate, print loop. However, there are also a number of points where 
frontends may want to differ from the standard REPL as available e.g. in 
R_ReplDLLdo1().

First some thoughts on what is needed, and what is already there, or missing. 
If you want to skip over this, a short summary is provided in the second 
half, below a line marked "--------":

Read stage:
- R_ReplDLLdo1() calls ReadConsole to fetch an input buffer. This is not well 
ideally for some situations. For example, the "Console", and the R process 
may be running on different machines. Or a frontend may provide several 
consoles or console-alikes working on the same workspace. Or the frontend may 
want to differentiate between "submitting code to the backend", and answering 
requests for input from read.line().

Parse stage:
- If (due to the above mentioned aspects, or for some other reason), a 
frontend does not use R_ReplDLLdo1(), it will have to use R_ParseVector() for 
parsing. There's nothing wrong with that, except for the fact, that there 
does not seem to be a way to get at the full error message in case of a parse 
error, as parseError() is not exported.

Evaluate stage:
- Frontends may want to evaluate a sequence of statements at once, or one at a 
time.
- A typical requirement of a frontend is for evaluation to be guaranteed to 
return to the point of code it was called from.
- Both of this is available using R_tryEval().

Print stage:
- Frontends may want to always print the result of evaluation for some 
statements, they may want to suppress printing entirely for some (internal) 
statement, but most importantly, they will probably want to auto-print values 
for most statements (i.e. print them if and only if R_Visible is TRUE).
- There does not seem to be a good way (from the C-API) to do auto-printing of 
values outside of R_ReplDLLdo1(): R_Visible is not exported any longer, and 
PrintValueEnv() is neither. Rf_PrintValue() should yield the same results as 
PrintValueEnv() in most, but probably not all cases.
- From R API, withVisible() provides a way to emulate auto-printing, but with 
the drawback that wrapping all statements inside withVisible() makes 
potential errors harder to read (you get something like "Error in 
eval.with.vis(x, parent.frame(), baseenv()) :", unless using extra magic to 
convert the Error magic back to "normal").

Other things done in R_ReplDLLdo1() / other REPLs:
- Frontends may want to set R_LastValueSymbol for most (statement entered by 
the user directly), but not all statements (so as to keep .Last.value 
unchanged over internal operations like e.g. updating information on an 
object in an object browser)
- Frontends may want to call toplevel handlers after some statements, but not 
after others (probably a similar distinction).

----------

In summary, it seems like many frontends can not rely on R_ReplDLLdo1() (let 
alone running run_Rmainloop()), or at least not exclusively so. The 
alternative, using R_ParseVector() and R_tryEval() also has drawbacks, most 
importantly problems getting at parse errors, and auto-printing.

Two suggestions, which I hope are not too intrusive:
1) Make parseError() part of the public API. If there is a concern that the 
details of this function may change, a wrapper like the following should be 
good enough for most, if not all frontend purposes:

void Rf_parseErrorDefault()
{
	parseError(R_NilValue, 0);
}

2) Add a simple function to do auto-printing to the public API. E.g.:

Rboolean Rf_doAutoPrint(SEXP exp)
{
	if(R_Visible) {
	    printValueEnv(exp, R_GlobalEnv);
	    return TRUE;		/* was printed */
	}
	return FALSE;
}

Another suggestion, which might well be seen as adding too many constraints on 
future development, but provided for completeness: A more generic version of 
the EPL-part of R_ReplDLLDo1() with function parameters to determine, which 
steps are taken/omitted. I'm attaching a sketch of this. It is a copy with 
minimal modifications of the relevant code sections from R_ReplDLLdo1() and 
friends, which could then be simplified to use this function, internally.

Regards
Thomas Friedrichsmeier
-------------- next part --------------
/* print mode: 0: print if visible. 1: always print 2: never print */
SEXP R_DLLGenericEplDo1 (unsigned char *buffer, ParseStatus *parse_status, Rboolean set_last_sym_value, int print_mode, Rboolean do_toplevel_callbacks)
{
    int c;
    ParseStatus status;
    SEXP value;
    SEXP rho = R_GlobalEnv;
    Rboolean wasDisplayed = FALSE;

    while((c = *buffer++)) {
	R_IoBufferPutc(c, &R_ConsoleIob);
	if(c == ';' || c == '\n') break;
    }
    R_PPStackTop = 0;
    R_CurrentExpr = R_Parse1Buffer(&R_ConsoleIob, 0, &status);
    if(parse_status) *parse_status = status;

    switch(status) {
    case PARSE_NULL:
	R_IoBufferWriteReset(&R_ConsoleIob);
	break;
    case PARSE_OK:
	R_IoBufferReadReset(&R_ConsoleIob);
	R_CurrentExpr = R_Parse1Buffer(&R_ConsoleIob, 1, &status);
	R_Visible = FALSE;
	R_EvalDepth = 0;
	PROTECT(R_CurrentExpr);
	R_Busy(1);
	value = eval(R_CurrentExpr, rho);
	if(set_last_sym_value)
	    SET_SYMVALUE(R_LastvalueSymbol, value);
	if ((print_mode==1) || (R_Visible && (print_mode==0)))
	    wasDisplayed = TRUE;
	    PrintValueEnv(R_CurrentExpr, rho);
	if (R_CollectWarnings)
	    PrintWarnings();
	if(do_toplevel_callbacks) {
	    Rf_callToplevelHandlers(R_CurrentExpr, value, TRUE, wasDisplayed);
	}
	R_CurrentExpr = value;
	UNPROTECT(1);
	R_IoBufferWriteReset(&R_ConsoleIob);
	R_Busy(0);
	return value;
    case PARSE_ERROR:
	parseError(R_NilValue, 0);
	R_IoBufferWriteReset(&R_ConsoleIob);
	break;
    case PARSE_INCOMPLETE:
	R_IoBufferReadReset(&R_ConsoleIob);
	break;
    case PARSE_EOF:
	break;
    }
    return R_NilValue;
}
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20070118/e635bb8a/attachment.bin 

From atossava at cc.helsinki.fi  Thu Jan 18 10:48:42 2007
From: atossava at cc.helsinki.fi (Atro Tossavainen)
Date: Thu, 18 Jan 2007 11:48:42 +0200 (EET)
Subject: [Rd] Building R 2.4.1 on IRIX
Message-ID: <200701180948.l0I9mgdL009486@kruuna.helsinki.fi>

Hi,

I've got the latest MIPS compilers that are C99 aware (7.4.4).

"configure" finishes with:

R is now configured for mips-sgi-irix6.5

  Source directory:          .
  Installation directory:    /afs/bi/v/@sys/apps/stats/R/2.4.1

  C compiler:                cc -c99 -OPT:IEEE_NaN_inf=ON -g
  Fortran 77 compiler:       f77 -OPT:IEEE_NaN_inf=ON -g

  C++ compiler:              CC -OPT:IEEE_NaN_inf=ON -g
  Fortran 90/95 compiler:    f90 -g

  Interfaces supported:      X11
  External libraries:        readline 
  Additional capabilities:   PNG, JPEG, NLS
  Options enabled:           shared BLAS, R profiling

  Recommended packages:      yes

Building R 2.4.1, I stumble across the following error in
src/main/complex.c:

cc -c99 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre  -I. -I../../src/include -I../../src/include -I/afs/bi/p/include -DHAVE_CONFIG_H  -OPT:IEEE_NaN_inf=ON  -g -c complex.c -o complex.o

cc-1143 cc: ERROR File = /usr/include/complex.h, Line = 176
  Declaration is incompatible with "double cabs(struct __cabs_s)" (declared at
          line 667 of "/usr/include/math.h").

  static inline double cabs       (double complex z)      {return __c99_cabs(z); }
                       ^

cc-1143 cc: ERROR File = /usr/include/complex.h, Line = 178
  Declaration is incompatible with "long double cabsl(struct __cabsl_s)"
          (declared at line 528 of "/usr/include/math.h").

  static inline long double cabsl (long double complex z) {return __c99_cabsl(z);}
                            ^

2 errors detected in the compilation of "complex.c".
gmake[3]: *** [complex.o] Error 2


All ideas for fixing this would be welcome.  I'm not subscribed to the
mailing list, so personal copies would be appreciated, but I will be
monitoring the web archives of the list to catch responses posted to
the list only.

Regards,
-- 
Atro Tossavainen (Mr.)               / The Institute of Biotechnology at
Systems Analyst, Techno-Amish &     / the University of Helsinki, Finland,
+358-9-19158939  UNIX Dinosaur     / employs me, but my opinions are my own.
< URL : http : / / www . helsinki . fi / %7E atossava / > NO FILE ATTACHMENTS


From murdoch at stats.uwo.ca  Thu Jan 18 15:52:51 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 18 Jan 2007 09:52:51 -0500
Subject: [Rd] Working with Sweave: inverse search?
In-Reply-To: <c2ee56800701161108m21937957i7253bde6ab5be150@mail.gmail.com>
References: <45A947F7.9080206@stats.uwo.ca> <45AA7C5C.7030402@stats.uwo.ca>
	<c2ee56800701161108m21937957i7253bde6ab5be150@mail.gmail.com>
Message-ID: <45AF89C3.6060501@stats.uwo.ca>

I've now packaged up the Sweave inverse search package, and made the 
prototype available on my web page

http://www.stats.uwo.ca/faculty/murdoch/software

as patchDVI_0.2.tar.gz and patchDVI_0.2.zip.  I don't know of any bugs 
in those, but I'd like to hear about them.

To enable the inverse search, you need an \SweaveOpts line in the .Rnw
file with "concordance=TRUE".

I normally use MikTeX, so to make my life easier I wrote a little 
SweaveMiktex() function and put it in the package.  Using that package 
in Windows, the following batch file processes Sweave, runs latex, 
patches the .dvi, and runs the previewer:

echo library(patchDVI);SweaveMiktex('%2', '%3.tex') | Rterm --slave
yap -1 -s"%1%2" %3.dvi

It needs to be called with three parameters:

%1 - the current line number in the editor; yap will jump to that location

%2 - the name of the current file in the editor; if it's *.tex, then 
Sweave will be skipped, but the patching will still be done (because
some other file in the project might be a .Rnw file).  If not, the file 
is run through Sweave first.

%3 - the base name of the file (no extension) to send to latex.

For example, if I am on line 100 of a chapter called syntax.Rnw in a 
book called programming.tex, I would call this file with args

100 syntax.Rnw programming

If you're using some other TeX package, the SweaveMiktex function might 
still work, but it's likely the script to run it and the previewer would 
have to change.

If you have a completely different work flow, the steps you need to 
implement are these:

1.  Put the \SweaveOpts{concordance=TRUE} line into your .Rnw file.
2.  Run the patchDVI version of Sweave() on your file.
3.  Run latex to produce a .dvi file.
4.  Run the patchDVI function on the .dvi file to patch it.
5.  Run your previewer, with options telling it you want to see a 
particular line in the .Rnw file.

In a big project, you only need to run Sweave on those .Rnw files that 
have changed; the information linking to the original source is output 
in a file in the same place figures from the Sweave output would be 
saved, e.g. in the example above, as "syntax-concordance.tex".

The format of the concordance is very likely to change as patchDVI 
evolves, so you'll want to re-run Sweave if you update your patchDVI 
package.

Duncan Murdoch


From tplate at blackmesacapital.com  Thu Jan 18 16:44:17 2007
From: tplate at blackmesacapital.com (Tony Plate)
Date: Thu, 18 Jan 2007 08:44:17 -0700
Subject: [Rd] subsetting matrix by subscript=0,x silently skips.
In-Reply-To: <45AF612B.2080604@cimr.cam.ac.uk>
References: <45AF612B.2080604@cimr.cam.ac.uk>
Message-ID: <45AF95D1.3010401@blackmesacapital.com>

The help page for "[" says:

A third form of indexing is via a numeric matrix with the one column for 
each dimension: each row of the index matrix then selects a single 
element of the array, and the result is a vector. Negative indices are 
not allowed in the index matrix. NA and zero values are allowed: rows of 
an index matrix containing a zero are ignored, whereas rows containing 
an NA produce an NA in the result.

So, I think it is behaving as documented.

-- Tony Plate

Hin-Tak Leung wrote:
> (e-mailing to R-bugs is intentional - the web itnerface seems to
> be down)
> 
>  > a<- cbind(c(1,2), c(3,4))
>  > a
>       [,1] [,2]
> [1,]    1    3
> [2,]    2    4
> 
>  > a[cbind(c(2,2), c(2,1))]
> [1] 4 2
>  > a[cbind(c(2,3), c(2,1))]
> Error: subscript out of bounds
>  > a[cbind(c(2,-1), c(2,1))]
> Error: negative values are not allowed in a matrix subscript
>  > a[cbind(c(2,0), c(2,1))]
> [1] 4
> 
> Am somewhat surprised that 2,0 just silently skip over and doesn't
> throw an error like 2,0 and 2,-1 . Surely it should throw
> an error about subscript should be >= 1?
> 
> 
> 
>  > sessionInfo()
> R version 2.4.1 (2006-12-18)
> i686-redhat-linux-gnu
> 
> locale:
> LC_CTYPE=en_GB.UTF-8;LC_NUMERIC=C;LC_TIME=en_GB.UTF-8;LC_COLLATE=en_GB.UTF-8;LC_MONETARY=en_GB.UTF-8;LC_MESSAGES=en_GB.UTF-8;LC_PAPER=en_GB.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_GB.UTF-8;LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] "splines"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
> [7] "methods"   "base"
> 
> other attached packages:
> snpMatrix  survival
>    "1.0.4"    "2.30"
>  >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From P.Dalgaard at biostat.ku.dk  Thu Jan 18 17:14:48 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 18 Jan 2007 17:14:48 +0100
Subject: [Rd] subsetting matrix by subscript=0,x silently skips.
In-Reply-To: <45AF612B.2080604@cimr.cam.ac.uk>
References: <45AF612B.2080604@cimr.cam.ac.uk>
Message-ID: <45AF9CF8.60506@biostat.ku.dk>

Hin-Tak Leung wrote:
> (e-mailing to R-bugs is intentional - the web itnerface seems to
> be down)
>   
So is the mail interface... I have alerted our support people, but I
didn't  see the problem until I came back from teaching, so they may not
get it fixed before tomorrow.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 18 17:40:38 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 18 Jan 2007 16:40:38 +0000
Subject: [Rd] subsetting matrix by subscript=0,x silently skips.
In-Reply-To: <45AF95D1.3010401@blackmesacapital.com>
References: <45AF612B.2080604@cimr.cam.ac.uk>
	<45AF95D1.3010401@blackmesacapital.com>
Message-ID: <45AFA306.7010307@cimr.cam.ac.uk>

(I have taken off r-bug@, as multiple e-mails hitting r-bug@ probably 
will result in multiple bug reports, knowing most mail server will
retry)

Tony Plate wrote:
> The help page for "[" says:
> 
> A third form of indexing is via a numeric matrix with the one column for 
> each dimension: each row of the index matrix then selects a single 
> element of the array, and the result is a vector. Negative indices are 
> not allowed in the index matrix. NA and zero values are allowed: rows of 
> an index matrix containing a zero are ignored, whereas rows containing 
> an NA produce an NA in the result.
> 
> So, I think it is behaving as documented.

Hmm, fair enough. I guess the NA one make sense (In R as a rule,
NA in, NA out), but I am not sure I understand or agree with
the rationale of silently ignoring (0,x) and (x,0)'s. Any reason for that?

HTL

> Hin-Tak Leung wrote:
>> (e-mailing to R-bugs is intentional - the web itnerface seems to
>> be down)
>>
>>  > a<- cbind(c(1,2), c(3,4))
>>  > a
>>       [,1] [,2]
>> [1,]    1    3
>> [2,]    2    4
>>
>>  > a[cbind(c(2,2), c(2,1))]
>> [1] 4 2
>>  > a[cbind(c(2,3), c(2,1))]
>> Error: subscript out of bounds
>>  > a[cbind(c(2,-1), c(2,1))]
>> Error: negative values are not allowed in a matrix subscript
>>  > a[cbind(c(2,0), c(2,1))]
>> [1] 4
>>
>> Am somewhat surprised that 2,0 just silently skip over and doesn't
>> throw an error like 2,0 and 2,-1 . Surely it should throw
>> an error about subscript should be >= 1?
>>
>>
>>
>>  > sessionInfo()
>> R version 2.4.1 (2006-12-18)
>> i686-redhat-linux-gnu
>>
>> locale:
>> LC_CTYPE=en_GB.UTF-8;LC_NUMERIC=C;LC_TIME=en_GB.UTF-8;LC_COLLATE=en_GB.UTF-8;LC_MONETARY=en_GB.UTF-8;LC_MESSAGES=en_GB.UTF-8;LC_PAPER=en_GB.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_GB.UTF-8;LC_IDENTIFICATION=C 
>>
>>
>> attached base packages:
>> [1] "splines"   "stats"     "graphics"  "grDevices" "utils"     
>> "datasets"
>> [7] "methods"   "base"
>>
>> other attached packages:
>> snpMatrix  survival
>>    "1.0.4"    "2.30"
>>  >
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From P.Dalgaard at biostat.ku.dk  Thu Jan 18 17:44:24 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 18 Jan 2007 17:44:24 +0100
Subject: [Rd] Building R 2.4.1 on IRIX
In-Reply-To: <200701180948.l0I9mgdL009486@kruuna.helsinki.fi>
References: <200701180948.l0I9mgdL009486@kruuna.helsinki.fi>
Message-ID: <45AFA3E8.6000602@biostat.ku.dk>

Atro Tossavainen wrote:
> Hi,
>
> I've got the latest MIPS compilers that are C99 aware (7.4.4).
>
> "configure" finishes with:
>
> R is now configured for mips-sgi-irix6.5
>
>   Source directory:          .
>   Installation directory:    /afs/bi/v/@sys/apps/stats/R/2.4.1
>
>   C compiler:                cc -c99 -OPT:IEEE_NaN_inf=ON -g
>   Fortran 77 compiler:       f77 -OPT:IEEE_NaN_inf=ON -g
>
>   C++ compiler:              CC -OPT:IEEE_NaN_inf=ON -g
>   Fortran 90/95 compiler:    f90 -g
>
>   Interfaces supported:      X11
>   External libraries:        readline 
>   Additional capabilities:   PNG, JPEG, NLS
>   Options enabled:           shared BLAS, R profiling
>
>   Recommended packages:      yes
>
> Building R 2.4.1, I stumble across the following error in
> src/main/complex.c:
>
> cc -c99 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre  -I. -I../../src/include -I../../src/include -I/afs/bi/p/include -DHAVE_CONFIG_H  -OPT:IEEE_NaN_inf=ON  -g -c complex.c -o complex.o
>
> cc-1143 cc: ERROR File = /usr/include/complex.h, Line = 176
>   Declaration is incompatible with "double cabs(struct __cabs_s)" (declared at
>           line 667 of "/usr/include/math.h").
>
>   static inline double cabs       (double complex z)      {return __c99_cabs(z); }
>                        ^
>
> cc-1143 cc: ERROR File = /usr/include/complex.h, Line = 178
>   Declaration is incompatible with "long double cabsl(struct __cabsl_s)"
>           (declared at line 528 of "/usr/include/math.h").
>
>   static inline long double cabsl (long double complex z) {return __c99_cabsl(z);}
>                             ^
>
> 2 errors detected in the compilation of "complex.c".
> gmake[3]: *** [complex.o] Error 2
>
>
> All ideas for fixing this would be welcome.  I'm not subscribed to the
> mailing list, so personal copies would be appreciated, but I will be
> monitoring the web archives of the list to catch responses posted to
> the list only.
>   
It looks like two system include files are getting into a dogfight. You
might want to investigate whether you can reproduce the issue with a
smaller source file, possibly dropping some of the -I directories in
that cc command line, and submit the issue to the vendor if you get
convinced that the issue is not actually an R one.

If this is the case, your best hope is if you can make cc less picky
about such redefinitions.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 18 18:43:34 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 18 Jan 2007 17:43:34 +0000
Subject: [Rd] Building R 2.4.1 on IRIX
In-Reply-To: <45AFA3E8.6000602@biostat.ku.dk>
References: <200701180948.l0I9mgdL009486@kruuna.helsinki.fi>
	<45AFA3E8.6000602@biostat.ku.dk>
Message-ID: <45AFB1C6.4000907@cimr.cam.ac.uk>

Peter Dalgaard wrote:
> Atro Tossavainen wrote:
>> Hi,
>>
>> I've got the latest MIPS compilers that are C99 aware (7.4.4).
>>
>> "configure" finishes with:
>>
>> R is now configured for mips-sgi-irix6.5
>>
>>   Source directory:          .
>>   Installation directory:    /afs/bi/v/@sys/apps/stats/R/2.4.1
>>
>>   C compiler:                cc -c99 -OPT:IEEE_NaN_inf=ON -g
>>   Fortran 77 compiler:       f77 -OPT:IEEE_NaN_inf=ON -g
>>
>>   C++ compiler:              CC -OPT:IEEE_NaN_inf=ON -g
>>   Fortran 90/95 compiler:    f90 -g
>>
>>   Interfaces supported:      X11
>>   External libraries:        readline 
>>   Additional capabilities:   PNG, JPEG, NLS
>>   Options enabled:           shared BLAS, R profiling
>>
>>   Recommended packages:      yes
>>
>> Building R 2.4.1, I stumble across the following error in
>> src/main/complex.c:
>>
>> cc -c99 -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre  -I. -I../../src/include -I../../src/include -I/afs/bi/p/include -DHAVE_CONFIG_H  -OPT:IEEE_NaN_inf=ON  -g -c complex.c -o complex.o
>>
>> cc-1143 cc: ERROR File = /usr/include/complex.h, Line = 176
>>   Declaration is incompatible with "double cabs(struct __cabs_s)" (declared at
>>           line 667 of "/usr/include/math.h").
>>
>>   static inline double cabs       (double complex z)      {return __c99_cabs(z); }
>>                        ^
>>
>> cc-1143 cc: ERROR File = /usr/include/complex.h, Line = 178
>>   Declaration is incompatible with "long double cabsl(struct __cabsl_s)"
>>           (declared at line 528 of "/usr/include/math.h").
>>
>>   static inline long double cabsl (long double complex z) {return __c99_cabsl(z);}
>>                             ^
>>
>> 2 errors detected in the compilation of "complex.c".
>> gmake[3]: *** [complex.o] Error 2
>>
>>
>> All ideas for fixing this would be welcome.  I'm not subscribed to the
>> mailing list, so personal copies would be appreciated, but I will be
>> monitoring the web archives of the list to catch responses posted to
>> the list only.
>>   
> It looks like two system include files are getting into a dogfight. You
> might want to investigate whether you can reproduce the issue with a
> smaller source file, possibly dropping some of the -I directories in
> that cc command line, and submit the issue to the vendor if you get
> convinced that the issue is not actually an R one.
> 
> If this is the case, your best hope is if you can make cc less picky
> about such redefinitions.
> 

Certainly it looks the case. It might also be worth actually looking at
the two flighting system header files - occasionally sections are
controlled by macros like this:

ifdef _XOPEN_SOURCE
extern void foo(int bar)
#else
static void foo(char bar)
#end

where alternative function prototype definitions are chosen based
on macros. It might be possible to resolve the conflict by defining
a suitable macro during ./confgure. with something like this:
    CFLAGS="-D_XOPEN_SOURCE" ./configure

(in fact posting the two files somewhere or even e-mailing in
might be a good idea - I am not promising I'll look at them
in time though, but somebody else might have the time to do
it, so it might be a good idea to put it up on a URL and wait...).

HTL


From tplate at blackmesacapital.com  Thu Jan 18 19:03:45 2007
From: tplate at blackmesacapital.com (Tony Plate)
Date: Thu, 18 Jan 2007 11:03:45 -0700
Subject: [Rd] subsetting matrix by subscript=0,x silently skips.
In-Reply-To: <45AFA306.7010307@cimr.cam.ac.uk>
References: <45AF612B.2080604@cimr.cam.ac.uk>
	<45AF95D1.3010401@blackmesacapital.com>
	<45AFA306.7010307@cimr.cam.ac.uk>
Message-ID: <45AFB681.7040106@blackmesacapital.com>

Hin-Tak Leung wrote:
> (I have taken off r-bug@, as multiple e-mails hitting r-bug@ probably 
> will result in multiple bug reports, knowing most mail server will
> retry)
> 
> Tony Plate wrote:
> 
>> The help page for "[" says:
>>
>> A third form of indexing is via a numeric matrix with the one column 
>> for each dimension: each row of the index matrix then selects a single 
>> element of the array, and the result is a vector. Negative indices are 
>> not allowed in the index matrix. NA and zero values are allowed: rows 
>> of an index matrix containing a zero are ignored, whereas rows 
>> containing an NA produce an NA in the result.
>>
>> So, I think it is behaving as documented.
> 
> 
> Hmm, fair enough. I guess the NA one make sense (In R as a rule,
> NA in, NA out), but I am not sure I understand or agree with
> the rationale of silently ignoring (0,x) and (x,0)'s. Any reason for that?

AFAIK, the reason is to make the behavior analogous to how regular 
indices are treated, e.g.:

 > x <- array(1:6, dim=2:3)
 > x[c(0,1),2]
[1] 3
 > x[cbind(c(0,1),2)]
[1] 3
 >

(i.e., 0's in indices are omitted)

-- Tony Plate

> 
> HTL
> 
>> Hin-Tak Leung wrote:
>>
>>> (e-mailing to R-bugs is intentional - the web itnerface seems to
>>> be down)
>>>
>>>  > a<- cbind(c(1,2), c(3,4))
>>>  > a
>>>       [,1] [,2]
>>> [1,]    1    3
>>> [2,]    2    4
>>>
>>>  > a[cbind(c(2,2), c(2,1))]
>>> [1] 4 2
>>>  > a[cbind(c(2,3), c(2,1))]
>>> Error: subscript out of bounds
>>>  > a[cbind(c(2,-1), c(2,1))]
>>> Error: negative values are not allowed in a matrix subscript
>>>  > a[cbind(c(2,0), c(2,1))]
>>> [1] 4
>>>
>>> Am somewhat surprised that 2,0 just silently skip over and doesn't
>>> throw an error like 2,0 and 2,-1 . Surely it should throw
>>> an error about subscript should be >= 1?
>>>
>>>
>>>
>>>  > sessionInfo()
>>> R version 2.4.1 (2006-12-18)
>>> i686-redhat-linux-gnu
>>>
>>> locale:
>>> LC_CTYPE=en_GB.UTF-8;LC_NUMERIC=C;LC_TIME=en_GB.UTF-8;LC_COLLATE=en_GB.UTF-8;LC_MONETARY=en_GB.UTF-8;LC_MESSAGES=en_GB.UTF-8;LC_PAPER=en_GB.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_GB.UTF-8;LC_IDENTIFICATION=C 
>>>
>>>
>>> attached base packages:
>>> [1] "splines"   "stats"     "graphics"  "grDevices" "utils"     
>>> "datasets"
>>> [7] "methods"   "base"
>>>
>>> other attached packages:
>>> snpMatrix  survival
>>>    "1.0.4"    "2.30"
>>>  >
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
> 
>


From p.dalgaard at biostat.ku.dk  Thu Jan 18 20:39:09 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 18 Jan 2007 20:39:09 +0100
Subject: [Rd] R-bugs, was  subsetting matrix by subscript=0,
 x silently skips.
In-Reply-To: <45AFA306.7010307@cimr.cam.ac.uk>
References: <45AF612B.2080604@cimr.cam.ac.uk>	<45AF95D1.3010401@blackmesacapital.com>
	<45AFA306.7010307@cimr.cam.ac.uk>
Message-ID: <45AFCCDD.9010706@biostat.ku.dk>

Hin-Tak Leung wrote:
> (I have taken off r-bug@, as multiple e-mails hitting r-bug@ probably 
> will result in multiple bug reports, knowing most mail server will
> retry)
>   
Actually, reports will fall into a deep dark hole.... The home dir of 
r-bugs had gone AWOL and this contains the forwarding file that handles 
incoming mail. So basically, it becomes regular incoming mail for r-bugs 
and I have no (easy) method for resending it from there. If it is 
important, I assume that people will resend.

It seems that the repository is back up again now.

-p


From giampi at kth.se  Fri Jan 19 14:21:24 2007
From: giampi at kth.se (Giampiero Salvi)
Date: Fri, 19 Jan 2007 14:21:24 +0100 (CET)
Subject: [Rd] combn implementation
Message-ID: <Pine.LNX.4.58.0701191413190.20958@ctt35.speech.kth.se>

Hi,
I was checking the source code to the function combn that "generates
all combinations of the elements of 'x' taken 'm' at a time.",
because I wished to modify it. I have a doubt about a statement.
This is the main loop.

    ._1 <- 1:1
    nmmp1 <- n - m + ._1
    while (a[1] != nmmp1) {
        if (e < n - h) {
            h <- ._1
            e <- a[m]
            j <- ._1
        }
        else {
            e <- a[m - h]
            h <- h + ._1
            j <- 1:h
        }
        a[m - h + j] <- e + j
        r <- if (nofun)
            x[a]
        else FUN(x[a], ...)
        if (simplify)
            out[, i] <- r
        else out[[i]] <- r
        i <- i + 1
    }

I wonder what is the meaning of the statement "._1 <- 1:1".
First question: what is the difference with "._1 <- 1"?
Second question (perhaps answerd by the answer to the first): why not
using "1" directly? E.g.:
[...]
h <- 1
e <- a[m]
e <- 1
[...]

Sorry if this is covered by the manuals, but it's not easy to search
for the string "._1" with the usual search engines.
Thank you!
Giampiero


From mkimpel at iupui.edu  Fri Jan 19 09:55:30 2007
From: mkimpel at iupui.edu (Kimpel, Mark William)
Date: Fri, 19 Jan 2007 03:55:30 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
Message-ID: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070119/b5da4921/attachment.pl 

From daniel at danielberg.no  Fri Jan 19 08:19:32 2007
From: daniel at danielberg.no (Daniel Berg)
Date: Fri, 19 Jan 2007 08:19:32 +0100
Subject: [Rd] pcre library in R (PR#9319)
Message-ID: <f13f1c9c0701182319r532aa912p22b3584765911884@mail.gmail.com>

I have the same problem, trying to cross-compile.

I'm running Ubuntu Edgy, kernel 2.6.17-10-generic, on an IBM T60.

I downloaded the Makefile from CRAN and ran make CrossCompileBuild
with the following error messages (also ran each make one at the time
and the problem occurs in make R):

../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1703):
undefined reference to `__pcre_ucp_findprop'
../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1740):
undefined reference to `__pcre_ucp_findprop'
../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1848):
undefined reference to `__pcre_ucp_findprop'
../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x187f):
undefined reference to `__pcre_ucp_findprop'
../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1966):
undefined reference to `__pcre_ucp_findprop'
../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
more undefined references to `__pcre_ucp_findprop' follow
collect2: ld returned 1 exit status
make[4]: *** [R.dll] Error 1
make[3]: *** [../../bin/R.dll] Error 2
make[2]: *** [rbuild] Error 2
make[1]: *** [all] Error 2
make[1]: Leaving directory
`/home/daniel/Jobb/R/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'

Can you please report in greater detail how you added the files
pcre_ucp_searchfuncs.c and ucptable.c Mr. Kinney?
I have downloaded the files but I don't know where to put them, under
/WinR/R-2.4.0/src/extra/pcre? And to which makefile, Makefilw.win?

Thank you.

Best wishes,
Daniel Berg
-- 
danielberg.no


From daniel at danielberg.no  Fri Jan 19 09:46:09 2007
From: daniel at danielberg.no (Daniel Berg)
Date: Fri, 19 Jan 2007 09:46:09 +0100
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
Message-ID: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>

Dear all,

I already posted a question regarding this to an existing thread:
http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start

I apologize for the double posting but I have some further information
that might be illuminating.

I am trying to cross-compile my R-package under ubuntu linux, kernel
2.6.17-10-generic, on an IBM T60.

I am following the suggested steps in
http://cran.r-project.org/doc/contrib/cross-build.pdf

I have tried changing R = R-x.x.x (2.3.1, 2.4.0 and 2.4.1) in
http://cran.ii.uib.no/doc/contrib/Makefile-rcb

1) For R-2.3.1 everything works fine
2) For R-2.4.0 I receive the following error messages from 'make R':

../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
more undefined references to `__pcre_ucp_findprop' follow
collect2: ld returned 1 exit status
make[4]: *** [R.dll] Error 1
make[3]: *** [../../bin/R.dll] Error 2
make[2]: *** [rbuild] Error 2
make[1]: *** [all] Error 2
make[1]: Leaving directory

There is already a post that seems to address the same error:
http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start

However, I have tried the suggestions there with no further success
and I am awaiting further instructions before pursuing that solution.

3) For R-2.4.1 I receive the following error message from 'make R',
under 'Making package tools':

preparing package tools for lazy loading
Error in makeLazyLoadDB(ns, dbbase) : could not find function "seq_along"
Execution halted


Hope this is illuminating and that the 'bugs', whether it is in R or
in PCRE, can be resolved for the next release, this would be highly
appreciated. Meanwhile, any suggestions as to how I can cross-compile
successfully under R-2.4.1 are most welcome.

Best wishes,
Daniel Berg
-- 
danielberg.no


From huber at ebi.ac.uk  Fri Jan 19 14:38:53 2007
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Fri, 19 Jan 2007 13:38:53 +0000
Subject: [Rd] combn implementation
In-Reply-To: <Pine.LNX.4.58.0701191413190.20958@ctt35.speech.kth.se>
References: <Pine.LNX.4.58.0701191413190.20958@ctt35.speech.kth.se>
Message-ID: <45B0C9ED.1080109@ebi.ac.uk>


Dear Giampiero,

> storage.mode(1)
[1] "double"
> storage.mode(1:1)
[1] "integer"

as.integer(1) would perhaps be the more pedagogical way to program this.

 Best wishes
 Wolfgang

------------------------------------------------------------------
Wolfgang Huber  EBI/EMBL  Cambridge UK  http://www.ebi.ac.uk/huber


> Hi,
> I was checking the source code to the function combn that "generates
> all combinations of the elements of 'x' taken 'm' at a time.",
> because I wished to modify it. I have a doubt about a statement.
> This is the main loop.
> 
>     ._1 <- 1:1
>     nmmp1 <- n - m + ._1
>     while (a[1] != nmmp1) {
>         if (e < n - h) {
>             h <- ._1
>             e <- a[m]
>             j <- ._1
>         }
>         else {
>             e <- a[m - h]
>             h <- h + ._1
>             j <- 1:h
>         }
>         a[m - h + j] <- e + j
>         r <- if (nofun)
>             x[a]
>         else FUN(x[a], ...)
>         if (simplify)
>             out[, i] <- r
>         else out[[i]] <- r
>         i <- i + 1
>     }
> 
> I wonder what is the meaning of the statement "._1 <- 1:1".
> First question: what is the difference with "._1 <- 1"?
> Second question (perhaps answerd by the answer to the first): why not
> using "1" directly? E.g.:
> [...]
> h <- 1
> e <- a[m]
> e <- 1
> [...]
> 
> Sorry if this is covered by the manuals, but it's not easy to search
> for the string "._1" with the usual search engines.
> Thank you!
> Giampiero


From maechler at stat.math.ethz.ch  Fri Jan 19 14:45:27 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 19 Jan 2007 14:45:27 +0100
Subject: [Rd] combn implementation
In-Reply-To: <Pine.LNX.4.58.0701191413190.20958@ctt35.speech.kth.se>
References: <Pine.LNX.4.58.0701191413190.20958@ctt35.speech.kth.se>
Message-ID: <17840.52087.10214.316735@stat.math.ethz.ch>

>>>>> "Giampiero" == Giampiero Salvi <giampi at kth.se>
>>>>>     on Fri, 19 Jan 2007 14:21:24 +0100 (CET) writes:

    Giampiero> Hi,
    Giampiero> I was checking the source code to the function combn that "generates
    Giampiero> all combinations of the elements of 'x' taken 'm' at a time.",
    Giampiero> because I wished to modify it. I have a doubt about a statement.
    Giampiero> This is the main loop.

  >     ._1 <- 1:1
  >     nmmp1 <- n - m + ._1
  >     while (a[1] != nmmp1) {
  >         if (e < n - h) {
  >             h <- ._1
  >             e <- a[m]
  >             j <- ._1
  >         }
  >         else {
  >             e <- a[m - h]
  >             h <- h + ._1
  >             j <- 1:h
  >         }
  >         a[m - h + j] <- e + j
  >         r <- if (nofun)
  >             x[a]
  >         else FUN(x[a], ...)
  >         if (simplify)
  >             out[, i] <- r
  >         else out[[i]] <- r
  >         i <- i + 1
  >     }

Not really!  
You are not showing all the comments that go with it!
 --> https://svn.R-project.org/R/trunk/src/library/utils/R/combn.R
is the current source file of the development version whereas
     https://svn.r-project.org/R/tags/R-2-4-1/src/library/utils/R/combn.R
is the R-2.4.1 version

    Giampiero> I wonder what is the meaning of the statement "._1 <- 1:1".

The "real" source in 2.4.1 says
   ._1 <- 1:1 # to keep integer arithmetic
	      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

So: It assigns  "1:1" {the infamous short form for as.integer(1)}
    to the variable '._1'

The variable name is a bit unusual and I had a little chuckle when I
invented it to put there.

However with '1L' in R-devel, i.e. from R-2.5.0 on,
code like the above will be definitely be simplified to use '1L'
in such places, and then assigning it does not make sense
anymore (of course it's questionable if it ever did make sense,
but then, as I said, a had a chuckle and I think I found back
then that it *did* increase speed slightly) ....


    Giampiero> First question: what is the difference with "._1 <- 1"?
explained in the comment

    Giampiero> Second question (perhaps answerd by the answer to the first): 

indeed it is.

    Giampiero> why not using "1" directly? E.g.:

    Giampiero> [...]
    Giampiero> h <- 1
    Giampiero> e <- a[m]
    Giampiero> e <- 1
    Giampiero> [...]

    Giampiero> Sorry if this is covered by the manuals, but it's not easy to search
    Giampiero> for the string "._1" with the usual search engines.
    Giampiero> Thank you!
    Giampiero> Giampiero

You're welcome.

Martin Maechler, ETH Zurich


From murdoch at stats.uwo.ca  Fri Jan 19 14:51:14 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 19 Jan 2007 08:51:14 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <45B0CCD2.1040607@stats.uwo.ca>

On 1/19/2007 3:55 AM, Kimpel, Mark William wrote:
> I have 3 years of experience with R and have an interest in becoming a
> better programmer so that I might someday be able to contribute
> packages. Other than R, my only experience was taking Lisp from Daniel
> Friedman in the 1970's. I would like to learn either C or C++ for
> several reasons:
> 
> To gain a better concept of object oriented programming so that I can
> begin to use S4 methods in R.
> 
> To perhaps speed up some things I do repeatedly in R
> 
> To be able to contribute a package someday.
> 
>  
> 
> I have been doing some reading and from what I can tell R is more
> compatible with C, but C++ has much greater capabilities for OO
> programming.
> 
>  
> 
> I have just started reading The C++ Programming Language: Special
> Edition by Bjarne Stroustrup
> <http://search.barnesandnoble.com/booksearch/results.asp?ATH=Bjarne+Stro
> ustrup&z=y> , he recommends first learning C++ and then then C if
> necessary, but as a developer of C++, he is probably biased.
> 
>  
> 
> I would greatly appreciate the advice of the R developers and package
> contributors on this subject. "C" or "C++"?

For your purposes, I would recommend C.  Most example code you'll find 
is written in C, so it's easier to learn by looking at simple examples 
written by others.  The R external interface was designed with C in 
mind, so you need to tell C++ to act like C to use it.

Regarding OOP, I think the C++ style of OOP is so different from S4 that 
it would not actually be helpful in learning S4.  As far as I know, none 
of the languages that are easy to link to R use the same style of OOP.

On the other hand, taking a disciplined approach to C programming is a 
good idea (which is I think what Stroustrup had in mind).  I'd suggest 
an object oriented Pascal (e.g. Delphi) or Java if that's what you want, 
  because they are simpler than C++.  C and R are very permissive 
languages, and if you take advantage of that you can write amazingly 
sloppy and unmaintainable code.

Duncan Murdoch


From ggrothendieck at gmail.com  Fri Jan 19 14:53:56 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 19 Jan 2007 08:53:56 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <971536df0701190553t3d4a44cftf30813c07039f4cc@mail.gmail.com>

You don't necessarily need to know C or C++ to write an R package.
Many (maybe most) R packages only use R.

On 1/19/07, Kimpel, Mark William <mkimpel at iupui.edu> wrote:
> I have 3 years of experience with R and have an interest in becoming a
> better programmer so that I might someday be able to contribute
> packages. Other than R, my only experience was taking Lisp from Daniel
> Friedman in the 1970's. I would like to learn either C or C++ for
> several reasons:
>
> To gain a better concept of object oriented programming so that I can
> begin to use S4 methods in R.
>
> To perhaps speed up some things I do repeatedly in R
>
> To be able to contribute a package someday.
>
>
>
> I have been doing some reading and from what I can tell R is more
> compatible with C, but C++ has much greater capabilities for OO
> programming.
>
>
>
> I have just started reading The C++ Programming Language: Special
> Edition by Bjarne Stroustrup
> <http://search.barnesandnoble.com/booksearch/results.asp?ATH=Bjarne+Stro
> ustrup&z=y> , he recommends first learning C++ and then then C if
> necessary, but as a developer of C++, he is probably biased.
>
>
>
> I would greatly appreciate the advice of the R developers and package
> contributors on this subject. "C" or "C++"?
>
>
>
> Thanks,
>
>
>
> Mark
>
>
>
> Mark W. Kimpel MD
>
>
>
>
>
> Official Business Address:
>
>
>
> Department of Psychiatry
>
> Indiana University School of Medicine
>
> PR M116
>
> Institute of Psychiatric Research
>
> 791 Union Drive
>
> Indianapolis, IN 46202
>
>
>
> Preferred Mailing Address:
>
>
>
> 15032 Hunter Court
>
> Westfield, IN  46074
>
>
>
> (317) 490-5129 Work, & Mobile
>
>
>
> (317) 663-0513 Home (no voice mail please)
>
> 1-(317)-536-2730 FAX
>
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From rdiaz at cnio.es  Fri Jan 19 15:03:42 2007
From: rdiaz at cnio.es (Ramon Diaz-Uriarte)
Date: Fri, 19 Jan 2007 15:03:42 +0100
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <200701191503.42779.rdiaz@cnio.es>

Dear Mark,

On Friday 19 January 2007 09:55, Kimpel, Mark William wrote:
> I have 3 years of experience with R and have an interest in becoming a
> better programmer so that I might someday be able to contribute
> packages. Other than R, my only experience was taking Lisp from Daniel
> Friedman in the 1970's. I would like to learn either C or C++ for
> several reasons:
>
> To gain a better concept of object oriented programming so that I can
> begin to use S4 methods in R.
>

I do not think C++ is the best idea if you are learning it to understand the 
OOP of R. The OOP of R is probably closer to that of CLOS (the common lisp 
object system) than C++ and Java.

It might be better to directly go ahead and look for documentation specificaly 
about R's OOP.

> To perhaps speed up some things I do repeatedly in R
>
> To be able to contribute a package someday.
>
>
>
> I have been doing some reading and from what I can tell R is more
> compatible with C, but C++ has much greater capabilities for OO
> programming.
>
>
>
> I have just started reading The C++ Programming Language: Special
> Edition by Bjarne Stroustrup
> <http://search.barnesandnoble.com/booksearch/results.asp?ATH=Bjarne+Stro
> ustrup&z=y> , he recommends first learning C++ and then then C if
> necessary, but as a developer of C++, he is probably biased.
>
>
>
> I would greatly appreciate the advice of the R developers and package
> contributors on this subject. "C" or "C++"?
>
>

I'd recommend C instead of C++: C++ is a huge language and it is somewhat 
easier to interface C than C++ from R. (In "non-R" stuff I prefer to use C++ 
better than C, even if just as in "C++as a better C", but this probably is 
not a reasonable reason to learn C++).  

HTH,

R.



>
> Thanks,
>
>
>
> Mark
>
>
>
> Mark W. Kimpel MD
>
>
>
>
>
> Official Business Address:
>
>
>
> Department of Psychiatry
>
> Indiana University School of Medicine
>
> PR M116
>
> Institute of Psychiatric Research
>
> 791 Union Drive
>
> Indianapolis, IN 46202
>
>
>
> Preferred Mailing Address:
>
>
>
> 15032 Hunter Court
>
> Westfield, IN  46074
>
>
>
> (317) 490-5129 Work, & Mobile
>
>
>
> (317) 663-0513 Home (no voice mail please)
>
> 1-(317)-536-2730 FAX
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Ram?n D?az-Uriarte
Centro Nacional de Investigaciones Oncol?gicas (CNIO)
(Spanish National Cancer Center)
Melchor Fern?ndez Almagro, 3
28029 Madrid (Spain)
Fax: +-34-91-224-6972
Phone: +-34-91-224-6900

http://ligarto.org/rdiaz
PGP KeyID: 0xE89B3462
(http://ligarto.org/rdiaz/0xE89B3462.asc)



**NOTA DE CONFIDENCIALIDAD** Este correo electr?nico, y en s...{{dropped}}


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 19 15:27:56 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 19 Jan 2007 14:27:56 +0000
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
In-Reply-To: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
References: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
Message-ID: <45B0D56C.4060007@cimr.cam.ac.uk>

You missed my posts (earlier this week). The subject is:
"mingw-cross with R 2.4.x Re: [Rd] wine and build difference between 
R.2.4.0 and R 2.4.1 windows binaries?" which contains my notes on this 
subject.

Basically you need newer mingw than on Prof Ripley's web site (i.e.
you'll need to build mingw yourself), and as for the pcre error
in 2.4.0, you need to graft pcre from 2.4.1 back. Good luck.

Daniel Berg wrote:
> Dear all,
> 
> I already posted a question regarding this to an existing thread:
> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
> 
> I apologize for the double posting but I have some further information
> that might be illuminating.
> 
> I am trying to cross-compile my R-package under ubuntu linux, kernel
> 2.6.17-10-generic, on an IBM T60.
> 
> I am following the suggested steps in
> http://cran.r-project.org/doc/contrib/cross-build.pdf
> 
> I have tried changing R = R-x.x.x (2.3.1, 2.4.0 and 2.4.1) in
> http://cran.ii.uib.no/doc/contrib/Makefile-rcb
> 
> 1) For R-2.3.1 everything works fine
> 2) For R-2.4.0 I receive the following error messages from 'make R':
> 
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
> more undefined references to `__pcre_ucp_findprop' follow
> collect2: ld returned 1 exit status
> make[4]: *** [R.dll] Error 1
> make[3]: *** [../../bin/R.dll] Error 2
> make[2]: *** [rbuild] Error 2
> make[1]: *** [all] Error 2
> make[1]: Leaving directory
> 
> There is already a post that seems to address the same error:
> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
> 
> However, I have tried the suggestions there with no further success
> and I am awaiting further instructions before pursuing that solution.
> 
> 3) For R-2.4.1 I receive the following error message from 'make R',
> under 'Making package tools':
> 
> preparing package tools for lazy loading
> Error in makeLazyLoadDB(ns, dbbase) : could not find function "seq_along"
> Execution halted
> 
> 
> Hope this is illuminating and that the 'bugs', whether it is in R or
> in PCRE, can be resolved for the next release, this would be highly
> appreciated. Meanwhile, any suggestions as to how I can cross-compile
> successfully under R-2.4.1 are most welcome.
> 
> Best wishes,
> Daniel Berg


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 19 15:31:14 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 19 Jan 2007 14:31:14 +0000
Subject: [Rd] pcre library in R (PR#9319)
In-Reply-To: <f13f1c9c0701182319r532aa912p22b3584765911884@mail.gmail.com>
References: <f13f1c9c0701182319r532aa912p22b3584765911884@mail.gmail.com>
Message-ID: <45B0D632.6040600@cimr.cam.ac.uk>

The usual drill: The problem is fixed in R 2.4.1 (i.e. please do
not report bugs on old versions). In addition, you need newer mingw
than you have.

Daniel Berg wrote:
> I have the same problem, trying to cross-compile.
> 
> I'm running Ubuntu Edgy, kernel 2.6.17-10-generic, on an IBM T60.
> 
> I downloaded the Makefile from CRAN and ran make CrossCompileBuild
> with the following error messages (also ran each make one at the time
> and the problem occurs in make R):
> 
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1703):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1740):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1848):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x187f):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1966):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
> more undefined references to `__pcre_ucp_findprop' follow
> collect2: ld returned 1 exit status
> make[4]: *** [R.dll] Error 1
> make[3]: *** [../../bin/R.dll] Error 2
> make[2]: *** [rbuild] Error 2
> make[1]: *** [all] Error 2
> make[1]: Leaving directory
> `/home/daniel/Jobb/R/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'
> 
> Can you please report in greater detail how you added the files
> pcre_ucp_searchfuncs.c and ucptable.c Mr. Kinney?
> I have downloaded the files but I don't know where to put them, under
> /WinR/R-2.4.0/src/extra/pcre? And to which makefile, Makefilw.win?
> 
> Thank you.
> 
> Best wishes,
> Daniel Berg


From giampi at kth.se  Fri Jan 19 15:32:04 2007
From: giampi at kth.se (Giampiero Salvi)
Date: Fri, 19 Jan 2007 15:32:04 +0100 (CET)
Subject: [Rd] combn implementation
In-Reply-To: <17840.52087.10214.316735@stat.math.ethz.ch>
References: <Pine.LNX.4.58.0701191413190.20958@ctt35.speech.kth.se>
	<17840.52087.10214.316735@stat.math.ethz.ch>
Message-ID: <Pine.LNX.4.58.0701191529570.20958@ctt35.speech.kth.se>

Thank you!
It's clear now. I was not looking at the real source code, but at the
code you get from the print method (that is by simply typing combn
at the prompt), which has all the comments removed. Next time I'll
take my time looking for the real source code ;)

Thanks again,
Giampiero


On Fri, 19 Jan 2007, Martin Maechler wrote:

> >>>>> "Giampiero" == Giampiero Salvi <giampi at kth.se>
> >>>>>     on Fri, 19 Jan 2007 14:21:24 +0100 (CET) writes:
>
>     Giampiero> Hi,
>     Giampiero> I was checking the source code to the function combn that "generates
>     Giampiero> all combinations of the elements of 'x' taken 'm' at a time.",
>     Giampiero> because I wished to modify it. I have a doubt about a statement.
>     Giampiero> This is the main loop.
>
>   >     ._1 <- 1:1
>   >     nmmp1 <- n - m + ._1
>   >     while (a[1] != nmmp1) {
>   >         if (e < n - h) {
>   >             h <- ._1
>   >             e <- a[m]
>   >             j <- ._1
>   >         }
>   >         else {
>   >             e <- a[m - h]
>   >             h <- h + ._1
>   >             j <- 1:h
>   >         }
>   >         a[m - h + j] <- e + j
>   >         r <- if (nofun)
>   >             x[a]
>   >         else FUN(x[a], ...)
>   >         if (simplify)
>   >             out[, i] <- r
>   >         else out[[i]] <- r
>   >         i <- i + 1
>   >     }
>
> Not really!
> You are not showing all the comments that go with it!
>  --> https://svn.R-project.org/R/trunk/src/library/utils/R/combn.R
> is the current source file of the development version whereas
>      https://svn.r-project.org/R/tags/R-2-4-1/src/library/utils/R/combn.R
> is the R-2.4.1 version
>
>     Giampiero> I wonder what is the meaning of the statement "._1 <- 1:1".
>
> The "real" source in 2.4.1 says
>    ._1 <- 1:1 # to keep integer arithmetic
> 	      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>
> So: It assigns  "1:1" {the infamous short form for as.integer(1)}
>     to the variable '._1'
>
> The variable name is a bit unusual and I had a little chuckle when I
> invented it to put there.
>
> However with '1L' in R-devel, i.e. from R-2.5.0 on,
> code like the above will be definitely be simplified to use '1L'
> in such places, and then assigning it does not make sense
> anymore (of course it's questionable if it ever did make sense,
> but then, as I said, a had a chuckle and I think I found back
> then that it *did* increase speed slightly) ....
>
>
>     Giampiero> First question: what is the difference with "._1 <- 1"?
> explained in the comment
>
>     Giampiero> Second question (perhaps answerd by the answer to the first):
>
> indeed it is.
>
>     Giampiero> why not using "1" directly? E.g.:
>
>     Giampiero> [...]
>     Giampiero> h <- 1
>     Giampiero> e <- a[m]
>     Giampiero> e <- 1
>     Giampiero> [...]
>
>     Giampiero> Sorry if this is covered by the manuals, but it's not easy to search
>     Giampiero> for the string "._1" with the usual search engines.
>     Giampiero> Thank you!
>     Giampiero> Giampiero
>
> You're welcome.
>
> Martin Maechler, ETH Zurich
>


From edd at debian.org  Fri Jan 19 15:46:43 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 19 Jan 2007 08:46:43 -0600
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <200701191503.42779.rdiaz@cnio.es>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
	<200701191503.42779.rdiaz@cnio.es>
Message-ID: <17840.55763.499761.363888@basebud.nulle.part>


Mark,

Great question. As Gabor said, if it is "just for R", there is no point in
learning C or C++. However, learning new programming paradigms is very useful
in and by itself, and being able to extend R with C, C++ or Fortran is
extremely useful for R.

I would suggest what I jokingly call 'C+' -- use C++, ignore many of the
advanced features for the next little while, and treat it as a 'better
C'.  There is no cost in terms of R extensibility.  Concentrate on the first
third or so of Stroustrup's book as well as others. There are also many
tutorials out there on the net.

Lastly, if it is "just" for learning other OO paradigms, Python and Ruby are
both excellent, widely used and well documented on the net. I speak neither
very well but have been meaning to learn either or both better for longer
than I'd care to admit in public.

Cheers, Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison


From ripley at stats.ox.ac.uk  Fri Jan 19 17:38:11 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 19 Jan 2007 16:38:11 +0000 (GMT)
Subject: [Rd] pcre library in R (PR#9319)
In-Reply-To: <f13f1c9c0701182319r532aa912p22b3584765911884@mail.gmail.com>
References: <f13f1c9c0701182319r532aa912p22b3584765911884@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701191632430.30077@gannet.stats.ox.ac.uk>

Please, use the current version of R and not an obselete one (you failed 
to report the version, but you do have 'R-2.4.0' in the path name, so I 
presume that is what you are using).  This does not occur under 2.4.1.

(The problem is in the binutils you are using to cross-compile, and an 
alternative is to update that.)

If you want to fix 2.4.0 and use your cross-compiler, I think you can 
remove pcre_dfa_exec.c and remove mention of it from Makefile.win.


On Fri, 19 Jan 2007, Daniel Berg wrote:

> I have the same problem, trying to cross-compile.
>
> I'm running Ubuntu Edgy, kernel 2.6.17-10-generic, on an IBM T60.
>
> I downloaded the Makefile from CRAN and ran make CrossCompileBuild
> with the following error messages (also ran each make one at the time
> and the problem occurs in make R):
>
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1703):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1740):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1848):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x187f):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1966):
> undefined reference to `__pcre_ucp_findprop'
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
> more undefined references to `__pcre_ucp_findprop' follow
> collect2: ld returned 1 exit status
> make[4]: *** [R.dll] Error 1
> make[3]: *** [../../bin/R.dll] Error 2
> make[2]: *** [rbuild] Error 2
> make[1]: *** [all] Error 2
> make[1]: Leaving directory
> `/home/daniel/Jobb/R/RCrossBuild/WinR/R-2.4.0/src/gnuwin32'
>
> Can you please report in greater detail how you added the files
> pcre_ucp_searchfuncs.c and ucptable.c Mr. Kinney?
> I have downloaded the files but I don't know where to put them, under
> /WinR/R-2.4.0/src/extra/pcre? And to which makefile, Makefilw.win?
>
> Thank you.
>
> Best wishes,
> Daniel Berg
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From b.rowlingson at lancaster.ac.uk  Fri Jan 19 19:01:56 2007
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 19 Jan 2007 18:01:56 +0000
Subject: [Rd] obsolescence
In-Reply-To: <Pine.LNX.4.64.0701191632430.30077@gannet.stats.ox.ac.uk>
References: <f13f1c9c0701182319r532aa912p22b3584765911884@mail.gmail.com>
	<Pine.LNX.4.64.0701191632430.30077@gannet.stats.ox.ac.uk>
Message-ID: <45B10794.3080102@lancaster.ac.uk>

Since many posts to R-devel/help invoke this response:

Prof Brian Ripley wrote:
> Please, use the current version of R and not an obselete one 

is there an argument for including a version check on R startup?  These 
things seem somewhat in vogue these days (what with everything on the 
internet being in a permanent 'beta' state), and software will often 
start up with 'A new version of Foobar is available' dialog.

  Perhaps R.version could return a component that says 'current', 
'buggy', or 'obsolete' as appropriate?

  It would need a file on a well-known URL to give the version 
information, an internet connection, and a bit of R code.  And obviously 
a server capable of handling the load...

  I'd vote to have the version check off by default, perhaps settable at 
compile-time, and configurable by the usual R startup mechanism.  The 
check wouldn't run if R is running with the BATCH command.  Personally, 
I'd switch it off completely, because these things annoy me.

  Maybe this is already in R, but I'm using an obsolete version at the 
moment (2.4.0).

Barry


From dsamperi at DecisionSynergy.com  Fri Jan 19 19:21:28 2007
From: dsamperi at DecisionSynergy.com (Dominick Samperi)
Date: Fri, 19 Jan 2007 13:21:28 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <45B10C28.3010402@DecisionSynergy.com>

Kimpel, Mark William wrote:
> I have 3 years of experience with R and have an interest in becoming a
> better programmer so that I might someday be able to contribute
> packages. Other than R, my only experience was taking Lisp from Daniel
> Friedman in the 1970's. I would like to learn either C or C++ for
> several reasons:
>
> To gain a better concept of object oriented programming so that I can
> begin to use S4 methods in R.
>
> To perhaps speed up some things I do repeatedly in R
>
> To be able to contribute a package someday.
>   
If you decide to use C++ with R you should check out the documentation
that comes with the package RcppTemplate, and the sample code that
comes with that package. In my experience C++ (or C or FORTRAN) is
needed for many compute intensive tasks, and the R framework provides
a nice front-end with its extensive collection of visualization and
statistical analysis tools.

Disclaimer: I have no experience with S4.

ds


From ggrothendieck at gmail.com  Fri Jan 19 19:29:56 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 19 Jan 2007 13:29:56 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <45B10C28.3010402@DecisionSynergy.com>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
	<45B10C28.3010402@DecisionSynergy.com>
Message-ID: <971536df0701191029t714172f1j38b3ed62f43ac311@mail.gmail.com>

On 1/19/07, Dominick Samperi <dsamperi at decisionsynergy.com> wrote:
> Kimpel, Mark William wrote:
> > I have 3 years of experience with R and have an interest in becoming a
> > better programmer so that I might someday be able to contribute
> > packages. Other than R, my only experience was taking Lisp from Daniel
> > Friedman in the 1970's. I would like to learn either C or C++ for
> > several reasons:
> >
> > To gain a better concept of object oriented programming so that I can
> > begin to use S4 methods in R.
> >
> > To perhaps speed up some things I do repeatedly in R
> >
> > To be able to contribute a package someday.
> >
> If you decide to use C++ with R you should check out the documentation
> that comes with the package RcppTemplate, and the sample code that
> comes with that package. In my experience C++ (or C or FORTRAN) is
> needed for many compute intensive tasks, and the R framework provides
> a nice front-end with its extensive collection of visualization and
> statistical analysis tools.

Actually I have found the opposite. I have never found C/C++ to be necessary.
I have always been able to optimize the R code itself to get it to run
sufficiently fast for my purposes.


From ripley at stats.ox.ac.uk  Fri Jan 19 19:38:33 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 19 Jan 2007 18:38:33 +0000 (GMT)
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
In-Reply-To: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
References: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701191829070.31465@gannet.stats.ox.ac.uk>

The 2.4.0 issue has been well documented only last week, in the thread

https://stat.ethz.ch/pipermail/r-help/2007-January/123303.html

as well as in an answer I had already posted.

I am almost certain the issue for 2.4.1 is user error.  Remember you need 
to set in MkRules

## =================== cross-compilation settings  =================

...

# path (possibly full path) to same version of R on the host system
# R_EXE=R

R 2.4.1 does have seq_along, so it must not be the same version.


On Fri, 19 Jan 2007, Daniel Berg wrote:

> Dear all,
>
> I already posted a question regarding this to an existing thread:
> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
>
> I apologize for the double posting but I have some further information
> that might be illuminating.
>
> I am trying to cross-compile my R-package under ubuntu linux, kernel
> 2.6.17-10-generic, on an IBM T60.
>
> I am following the suggested steps in
> http://cran.r-project.org/doc/contrib/cross-build.pdf
>
> I have tried changing R = R-x.x.x (2.3.1, 2.4.0 and 2.4.1) in
> http://cran.ii.uib.no/doc/contrib/Makefile-rcb
>
> 1) For R-2.3.1 everything works fine
> 2) For R-2.4.0 I receive the following error messages from 'make R':
>
> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
> more undefined references to `__pcre_ucp_findprop' follow
> collect2: ld returned 1 exit status
> make[4]: *** [R.dll] Error 1
> make[3]: *** [../../bin/R.dll] Error 2
> make[2]: *** [rbuild] Error 2
> make[1]: *** [all] Error 2
> make[1]: Leaving directory
>
> There is already a post that seems to address the same error:
> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
>
> However, I have tried the suggestions there with no further success
> and I am awaiting further instructions before pursuing that solution.
>
> 3) For R-2.4.1 I receive the following error message from 'make R',
> under 'Making package tools':
>
> preparing package tools for lazy loading
> Error in makeLazyLoadDB(ns, dbbase) : could not find function "seq_along"
> Execution halted
>
>
> Hope this is illuminating and that the 'bugs', whether it is in R or
> in PCRE, can be resolved for the next release, this would be highly
> appreciated. Meanwhile, any suggestions as to how I can cross-compile
> successfully under R-2.4.1 are most welcome.
>
> Best wishes,
> Daniel Berg
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From vdergachev at rcgardis.com  Fri Jan 19 19:51:25 2007
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Fri, 19 Jan 2007 13:51:25 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <971536df0701191029t714172f1j38b3ed62f43ac311@mail.gmail.com>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
	<45B10C28.3010402@DecisionSynergy.com>
	<971536df0701191029t714172f1j38b3ed62f43ac311@mail.gmail.com>
Message-ID: <200701191351.25485.vdergachev@rcgardis.com>

On Friday 19 January 2007 1:29 pm, Gabor Grothendieck wrote:
> > If you decide to use C++ with R you should check out the documentation
> > that comes with the package RcppTemplate, and the sample code that
> > comes with that package. In my experience C++ (or C or FORTRAN) is
> > needed for many compute intensive tasks, and the R framework provides
> > a nice front-end with its extensive collection of visualization and
> > statistical analysis tools.
>
> Actually I have found the opposite. I have never found C/C++ to be
> necessary. I have always been able to optimize the R code itself to get it
> to run sufficiently fast for my purposes.
>

The nice thing about being able to use C code is that this provides confidence 
that however slowly your R script runs right now you will be able to make it 
faster - no matter what.

On quite a few occasions I have started writing C code and after thinking 
about how I would structure it realized that I can do the same thing in R and 
still get 50% of the speed improvement I get from C.

Also, I am not sure whether this is mentioned anywhere, but I found it to be 
more convenient to use dyn.load directly instead of creating a full-blown R 
package. This way the edit-compile-test cycle is much more convenient.

                              best

                                   Vladimir Dergachev


From hin-tak.leung at cimr.cam.ac.uk  Fri Jan 19 20:38:56 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 19 Jan 2007 19:38:56 +0000
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
In-Reply-To: <Pine.LNX.4.64.0701191829070.31465@gannet.stats.ox.ac.uk>
References: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
	<Pine.LNX.4.64.0701191829070.31465@gannet.stats.ox.ac.uk>
Message-ID: <45B11E50.8020007@cimr.cam.ac.uk>

Prof Brian Ripley wrote:
> The 2.4.0 issue has been well documented only last week, in the thread
> 
> https://stat.ethz.ch/pipermail/r-help/2007-January/123303.html
> 
> as well as in an answer I had already posted.
> 
> I am almost certain the issue for 2.4.1 is user error.  Remember you need 
> to set in MkRules
> 
> ## =================== cross-compilation settings  =================
> 
> ...
> 
> # path (possibly full path) to same version of R on the host system
> # R_EXE=R
> 
> R 2.4.1 does have seq_along, so it must not be the same version.

I feel that one point in the cross-build related documentation
wasn't emphasized enough, and may have caused this sort of error
when one tries to build multiple versions of R: the version of
native R used *must* match the version of cross R one intends to build.

The user mentioned that he tried building R 2.3.1, 2.4.0 and 2.4.1 ;
the only way it would work successfully would be that he also has
linux native R of all three of those versions.

HTL

> On Fri, 19 Jan 2007, Daniel Berg wrote:
> 
>> Dear all,
>>
>> I already posted a question regarding this to an existing thread:
>> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
>>
>> I apologize for the double posting but I have some further information
>> that might be illuminating.
>>
>> I am trying to cross-compile my R-package under ubuntu linux, kernel
>> 2.6.17-10-generic, on an IBM T60.
>>
>> I am following the suggested steps in
>> http://cran.r-project.org/doc/contrib/cross-build.pdf
>>
>> I have tried changing R = R-x.x.x (2.3.1, 2.4.0 and 2.4.1) in
>> http://cran.ii.uib.no/doc/contrib/Makefile-rcb
>>
>> 1) For R-2.3.1 everything works fine
>> 2) For R-2.4.0 I receive the following error messages from 'make R':
>>
>> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
>> more undefined references to `__pcre_ucp_findprop' follow
>> collect2: ld returned 1 exit status
>> make[4]: *** [R.dll] Error 1
>> make[3]: *** [../../bin/R.dll] Error 2
>> make[2]: *** [rbuild] Error 2
>> make[1]: *** [all] Error 2
>> make[1]: Leaving directory
>>
>> There is already a post that seems to address the same error:
>> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
>>
>> However, I have tried the suggestions there with no further success
>> and I am awaiting further instructions before pursuing that solution.
>>
>> 3) For R-2.4.1 I receive the following error message from 'make R',
>> under 'Making package tools':
>>
>> preparing package tools for lazy loading
>> Error in makeLazyLoadDB(ns, dbbase) : could not find function "seq_along"
>> Execution halted
>>
>>
>> Hope this is illuminating and that the 'bugs', whether it is in R or
>> in PCRE, can be resolved for the next release, this would be highly
>> appreciated. Meanwhile, any suggestions as to how I can cross-compile
>> successfully under R-2.4.1 are most welcome.
>>
>> Best wishes,
>> Daniel Berg
>>
>


From ross at biostat.ucsf.edu  Fri Jan 19 20:39:49 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Fri, 19 Jan 2007 11:39:49 -0800
Subject: [Rd] encoding issues even w/o accents (background on single
	quotes)
In-Reply-To: <20070118075615.GC24158@wheat.betterworld.us>
References: <20070118075615.GC24158@wheat.betterworld.us>
Message-ID: <20070119193949.GG11805@wheat.betterworld.us>

On Wed, Jan 17, 2007 at 11:56:15PM -0800, Ross Boylan wrote:
> An earlier thread (in 10/2006) discussed encoding issues in the
> context of R data and the desire to represent accented characters.
> 
> It matters in another setting: the output generated by R and the
> seemingly order character "'" (single quote).  In particular, R CMD
            ^^^ should be "ordinary"
> check runs test code and compares the generated output to a saved file
> of expected output.  This does not work reliably across encoding
> schemes.  This is unfortunate, since it seems the "expected output"
> files will necessarily be wrong for someone.
> 
> The problem for me was triggered by the single-quote character "'".
> On my older systems, this is encoded by 0x27, a perfectly fine ASCII
> character.  That is on a Debian GNU/Linux system with LANG=en_US.  On
> a newer system I have LANG=en_US.UTF-8.  I don't recall whether
> this was a deliberate choice on my part, or simply reflects changing
> defaults for the installer.  (Note the earlier thread referred to the
> Debian-derived Ubuntu systems as having switched to UTF-8).  Under
> UTF-8 the same character is encoded in the 3-byte sequence 0xE28098
> (which seems odd; I thought the point of UTF-8 was that ASCII was a
> legitimate subset).

Apparently quoting, particularly single quotes, is a can of worms:
http://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html
When Unicode is available (which would be the case with UTF-8),
particular non-ASCII characters are recommended for single quoting.
The 3 byte sequence is the UTF-8 encoding of x2018, the recommended
left single quote mark.

See http://en.wikipedia.org/wiki/UTF-8 on UTF-8 encoding.

This is more than I or, probably, you ever wanted to know about this
issue!

Ross

> 
> The coefficient  printing methods in the stats package use the
> single-quote in the key explaining significance levels:
> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
> 
> I suppose one possible work-around for R CMD check would be to set the
> encoding to  some standard value before it runs tests, but that has
> some drawbacks.  It doesn't work for packages needing a different
> encoding (but perhaps the package could specify an encoding to use by
> default?)(*),  It will leave the output files looking weird on systems
> with a different encoding.  It will get messed up if one generates the
> files under the wrong encoding.
> 
> And none of this addresses stuff beyond the context of output file
> comparison in R CMD check.
> 
> Any thoughts?
> 
> Ross Boylan
> 
> 
> * From the R Extensions document, discussing the DESCRIPTION file:
>    If the `DESCRIPTION' file is not entirely in ASCII it should contain
> an `Encoding' field specifying an encoding.  This is currently used as
> the encoding of the `DESCRIPTION' file itself, and may in the future be
> taken as the encoding for other documentation in the package.  Only
> encoding names `latin1', `latin2' and `UTF-8' are known to be portable.
> 
> I would not expect that the test output files be considered
> "documentation," but I suppose that's subject to interpretation.


From daniel at danielberg.no  Fri Jan 19 20:46:37 2007
From: daniel at danielberg.no (Daniel Berg)
Date: Fri, 19 Jan 2007 20:46:37 +0100
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
In-Reply-To: <45B11E50.8020007@cimr.cam.ac.uk>
References: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
	<Pine.LNX.4.64.0701191829070.31465@gannet.stats.ox.ac.uk>
	<45B11E50.8020007@cimr.cam.ac.uk>
Message-ID: <f13f1c9c0701191146n5d12dda2h273d5cbc40c37395@mail.gmail.com>

Thank you so much for your great answers, and I apologize for using
obsolete versions and not being up to date on all the posts.

My native linux R is indeed R-2.3.1 which was also the version for
which I successfully cross-compiled. When trying to cross-compile for
2.4.0 and 2.4.1 I was not successful.

//Daniel

On 1/19/07, Hin-Tak Leung <hin-tak.leung at cimr.cam.ac.uk> wrote:
> Prof Brian Ripley wrote:
> > The 2.4.0 issue has been well documented only last week, in the thread
> >
> > https://stat.ethz.ch/pipermail/r-help/2007-January/123303.html
> >
> > as well as in an answer I had already posted.
> >
> > I am almost certain the issue for 2.4.1 is user error.  Remember you need
> > to set in MkRules
> >
> > ## =================== cross-compilation settings  =================
> >
> > ...
> >
> > # path (possibly full path) to same version of R on the host system
> > # R_EXE=R
> >
> > R 2.4.1 does have seq_along, so it must not be the same version.
>
> I feel that one point in the cross-build related documentation
> wasn't emphasized enough, and may have caused this sort of error
> when one tries to build multiple versions of R: the version of
> native R used *must* match the version of cross R one intends to build.
>
> The user mentioned that he tried building R 2.3.1, 2.4.0 and 2.4.1 ;
> the only way it would work successfully would be that he also has
> linux native R of all three of those versions.
>
> HTL
>
> > On Fri, 19 Jan 2007, Daniel Berg wrote:
> >
> >> Dear all,
> >>
> >> I already posted a question regarding this to an existing thread:
> >> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
> >>
> >> I apologize for the double posting but I have some further information
> >> that might be illuminating.
> >>
> >> I am trying to cross-compile my R-package under ubuntu linux, kernel
> >> 2.6.17-10-generic, on an IBM T60.
> >>
> >> I am following the suggested steps in
> >> http://cran.r-project.org/doc/contrib/cross-build.pdf
> >>
> >> I have tried changing R = R-x.x.x (2.3.1, 2.4.0 and 2.4.1) in
> >> http://cran.ii.uib.no/doc/contrib/Makefile-rcb
> >>
> >> 1) For R-2.3.1 everything works fine
> >> 2) For R-2.4.0 I receive the following error messages from 'make R':
> >>
> >> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text+0x1f2a):
> >> more undefined references to `__pcre_ucp_findprop' follow
> >> collect2: ld returned 1 exit status
> >> make[4]: *** [R.dll] Error 1
> >> make[3]: *** [../../bin/R.dll] Error 2
> >> make[2]: *** [rbuild] Error 2
> >> make[1]: *** [all] Error 2
> >> make[1]: Leaving directory
> >>
> >> There is already a post that seems to address the same error:
> >> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
> >>
> >> However, I have tried the suggestions there with no further success
> >> and I am awaiting further instructions before pursuing that solution.
> >>
> >> 3) For R-2.4.1 I receive the following error message from 'make R',
> >> under 'Making package tools':
> >>
> >> preparing package tools for lazy loading
> >> Error in makeLazyLoadDB(ns, dbbase) : could not find function "seq_along"
> >> Execution halted
> >>
> >>
> >> Hope this is illuminating and that the 'bugs', whether it is in R or
> >> in PCRE, can be resolved for the next release, this would be highly
> >> appreciated. Meanwhile, any suggestions as to how I can cross-compile
> >> successfully under R-2.4.1 are most welcome.
> >>
> >> Best wishes,
> >> Daniel Berg
> >>
> >
>
>
>


-- 
danielberg.no


From simon.urbanek at r-project.org  Fri Jan 19 21:51:42 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 19 Jan 2007 15:51:42 -0500
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
In-Reply-To: <45B11E50.8020007@cimr.cam.ac.uk>
References: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
	<Pine.LNX.4.64.0701191829070.31465@gannet.stats.ox.ac.uk>
	<45B11E50.8020007@cimr.cam.ac.uk>
Message-ID: <EF6CE7F1-8027-486A-B9E0-8267B54F46B3@r-project.org>


On Jan 19, 2007, at 2:38 PM, Hin-Tak Leung wrote:

> Prof Brian Ripley wrote:
>> The 2.4.0 issue has been well documented only last week, in the  
>> thread
>>
>> https://stat.ethz.ch/pipermail/r-help/2007-January/123303.html
>>
>> as well as in an answer I had already posted.
>>
>> I am almost certain the issue for 2.4.1 is user error.  Remember  
>> you need
>> to set in MkRules
>>
>> ## =================== cross-compilation settings  =================
>>
>> ...
>>
>> # path (possibly full path) to same version of R on the host system
>> # R_EXE=R
>>
>> R 2.4.1 does have seq_along, so it must not be the same version.
>
> I feel that one point in the cross-build related documentation  
> wasn't emphasized enough, and may have caused this sort of error  
> when one tries to build multiple versions of R: the version of  
> native R used *must* match the version of cross R one intends to  
> build.
>

In fact, there is even one more caveat which I don't remember seeing  
mentioned - it *must* be a build without r_arch set, otherwise the  
cross-build fails as well (despite a correct version). I got bitten  
by this recently when trying to use the OS X binary for cross-building..

And while we are at cross-building, it is possible to generate chm  
manuals via hhc through wine, but you have to use original itss.dll  
instead of the one supplied by wine. The hhw path in MkRules must  
then point to the local directory on the host (because it's used for  
the headers files) and you'll have to create shell-wrapper for hhc  
that looks somewhat like "wine hhc.exe $*".

Cheers,
Simon

>
>> On Fri, 19 Jan 2007, Daniel Berg wrote:
>>
>>> Dear all,
>>>
>>> I already posted a question regarding this to an existing thread:
>>> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
>>>
>>> I apologize for the double posting but I have some further  
>>> information
>>> that might be illuminating.
>>>
>>> I am trying to cross-compile my R-package under ubuntu linux, kernel
>>> 2.6.17-10-generic, on an IBM T60.
>>>
>>> I am following the suggested steps in
>>> http://cran.r-project.org/doc/contrib/cross-build.pdf
>>>
>>> I have tried changing R = R-x.x.x (2.3.1, 2.4.0 and 2.4.1) in
>>> http://cran.ii.uib.no/doc/contrib/Makefile-rcb
>>>
>>> 1) For R-2.3.1 everything works fine
>>> 2) For R-2.4.0 I receive the following error messages from 'make R':
>>>
>>> ../extra/pcre/libpcre.a(pcre_dfa_exec.o):pcre_dfa_exec.c:(.text 
>>> +0x1f2a):
>>> more undefined references to `__pcre_ucp_findprop' follow
>>> collect2: ld returned 1 exit status
>>> make[4]: *** [R.dll] Error 1
>>> make[3]: *** [../../bin/R.dll] Error 2
>>> make[2]: *** [rbuild] Error 2
>>> make[1]: *** [all] Error 2
>>> make[1]: Leaving directory
>>>
>>> There is already a post that seems to address the same error:
>>> http://tolstoy.newcastle.edu.au/R/e2/devel/06/10/0852.html#start
>>>
>>> However, I have tried the suggestions there with no further success
>>> and I am awaiting further instructions before pursuing that  
>>> solution.
>>>
>>> 3) For R-2.4.1 I receive the following error message from 'make R',
>>> under 'Making package tools':
>>>
>>> preparing package tools for lazy loading
>>> Error in makeLazyLoadDB(ns, dbbase) : could not find function  
>>> "seq_along"
>>> Execution halted
>>>
>>>
>>> Hope this is illuminating and that the 'bugs', whether it is in R or
>>> in PCRE, can be resolved for the next release, this would be highly
>>> appreciated. Meanwhile, any suggestions as to how I can cross- 
>>> compile
>>> successfully under R-2.4.1 are most welcome.
>>>
>>> Best wishes,
>>> Daniel Berg
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From mkimpel at iupui.edu  Fri Jan 19 16:04:56 2007
From: mkimpel at iupui.edu (Kimpel, Mark William)
Date: Fri, 19 Jan 2007 10:04:56 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <45B0CCD2.1040607@stats.uwo.ca>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
	<45B0CCD2.1040607@stats.uwo.ca>
Message-ID: <836F00680EECD340A96AD34ECFF3B534B4A74F@iu-mssg-mbx106.ads.iu.edu>

Thanks to all for your excellent suggestions. I think will I proceed
working through the Stroustrup book. He has a section on comparing C
with C++ and one on working with legacy C code that may prove helpful. I
also have a "C for Dummies" (something like that, I don't have it right
next to me) that I have also been reading. A couple of follow-up
questions:

1. As I understand it, if I just wanted to distribute compiled code, I
could use whatever extended C or C++ libraries that I wanted to use,
however, since R is open source and people need to be able to compile
things themselves, I imagine I would get into trouble (figuratively)
using, say, the C++ STL. Would I need to distribute these files as well?
For example, iostream instead of stdio.h. Or, should I just not use
those?

2. For those of you who develop C on Windows (probably a small bunch!),
what is your preferred development environment? I have the free Borland
Turbo C++ and Visual C++ 6.0 (I knew enough to stay away from .NET). I
tried to install the C++ module for Eclipse and, for me at least, it was
a nightmare. I am not UNIX or DOS savvy and setting path variables and
the like just made things too complicated.

3. Lastly, is there a C or C++ community similar to R that I could
address questions relating to those languages to? I don't want to abuse
the R list as I learn.

Thanks,
Mark

Mark W. Kimpel MD 

 

(317) 490-5129 Work, & Mobile

 

(317) 663-0513 Home (no voice mail please)

1-(317)-536-2730 FAX


From murdoch at stats.uwo.ca  Fri Jan 19 23:39:35 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 19 Jan 2007 17:39:35 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A74F@iu-mssg-mbx106.ads.iu.edu>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>	<45B0CCD2.1040607@stats.uwo.ca>
	<836F00680EECD340A96AD34ECFF3B534B4A74F@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <45B148A7.9050705@stats.uwo.ca>

On 1/19/2007 10:04 AM, Kimpel, Mark William wrote:
> Thanks to all for your excellent suggestions. I think will I proceed
> working through the Stroustrup book. He has a section on comparing C
> with C++ and one on working with legacy C code that may prove helpful. I
> also have a "C for Dummies" (something like that, I don't have it right
> next to me) that I have also been reading. A couple of follow-up
> questions:
> 
> 1. As I understand it, if I just wanted to distribute compiled code, I
> could use whatever extended C or C++ libraries that I wanted to use,
> however, since R is open source and people need to be able to compile
> things themselves, I imagine I would get into trouble (figuratively)
> using, say, the C++ STL. Would I need to distribute these files as well?
> For example, iostream instead of stdio.h. Or, should I just not use
> those?

The STL is available on most platforms, as far as I know.  Some more 
specialized libraries (e.g. GSL, database access, OpenGL) are more trouble.

If you want to use the more specialized ones, I'd try compiling your 
package using the standard build tools on one or two platforms, and see 
what happens.
> 
> 2. For those of you who develop C on Windows (probably a small bunch!),
> what is your preferred development environment? I have the free Borland
> Turbo C++ and Visual C++ 6.0 (I knew enough to stay away from .NET). I
> tried to install the C++ module for Eclipse and, for me at least, it was
> a nightmare. I am not UNIX or DOS savvy and setting path variables and
> the like just made things too complicated.

R uses the MinGW gcc compiler on Windows, so you need to have it 
available to build your packages when you get to that, but it doesn't 
have a nice IDE like those others.  Some purists hate IDEs, but I think 
they are very helpful.  I've never used Turbo C++ and rarely used 
MSVC++, so I can't really recommend one over the other, but I did like 
the Borland IDE for Pascal/Delphi.

Duncan Murdoch

> 3. Lastly, is there a C or C++ community similar to R that I could
> address questions relating to those languages to? I don't want to abuse
> the R list as I learn.
> 
> Thanks,
> Mark
> 
> Mark W. Kimpel MD 
> 
>  
> 
> (317) 490-5129 Work, & Mobile
> 
>  
> 
> (317) 663-0513 Home (no voice mail please)
> 
> 1-(317)-536-2730 FAX
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hin-tak.leung at cimr.cam.ac.uk  Sat Jan 20 00:46:28 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Fri, 19 Jan 2007 23:46:28 +0000
Subject: [Rd] Cross-compile errors under R-2.4.0 and R-2.4.1
In-Reply-To: <EF6CE7F1-8027-486A-B9E0-8267B54F46B3@r-project.org>
References: <f13f1c9c0701190046n4c487253l2925427712155002@mail.gmail.com>
	<Pine.LNX.4.64.0701191829070.31465@gannet.stats.ox.ac.uk>
	<45B11E50.8020007@cimr.cam.ac.uk>
	<EF6CE7F1-8027-486A-B9E0-8267B54F46B3@r-project.org>
Message-ID: <45B15854.7090708@cimr.cam.ac.uk>

Simon Urbanek wrote:
<snipped>
> 
> In fact, there is even one more caveat which I don't remember seeing 
> mentioned - it *must* be a build without r_arch set, otherwise the 
> cross-build fails as well (despite a correct version). I got bitten by 
> this recently when trying to use the OS X binary for cross-building..

I developed my own multi-arch set up during 2.3.x before the official
implementation - I have a "massaged" rpm spec file which, depends on
whether one does 'rpmbuild --target=i686 R.spec' or just 'rpmbuild 
R.spec' (='rpmbuild --target=x86_64 R.spec'), prepend -m32 to 
CFLAGS/FFLAGS/LDFLAGS, switch %_lib between lib or lib64, and also
rename /usr/bin/R to /usr/bin/R64 . So my 32-bit R and 64-bit R are 
essentially separate: /usr/bin/R + /usr/lib/R for 32-bit, /usr/bin/R64
+ /usr/lib64/R for 64-bit, and they only share the docs directories
such as /usr/share/info and /usr/share/doc/R-* . I read that the new 
r_arch based set-up is more space efficient, but I haven't switch
over yet (and not in any great urgency, since my current bi-arch
set up does what I want).

> And while we are at cross-building, it is possible to generate chm 
> manuals via hhc through wine, but you have to use original itss.dll 
> instead of the one supplied by wine. The hhw path in MkRules must then 
> point to the local directory on the host (because it's used for the 
> headers files) and you'll have to create shell-wrapper for hhc that 
> looks somewhat like "wine hhc.exe $*".

Thanks for that tip - I'll be sure to try it out the next time I 
cross-build. Are you using wine under OS X intel or did we switch
platform in two paragraphs? Just for curiosity.

Hin-Tak


From ross at biostat.ucsf.edu  Sat Jan 20 00:46:58 2007
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Fri, 19 Jan 2007 15:46:58 -0800
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <20070119234658.GA7413@wheat.betterworld.us>

On Fri, Jan 19, 2007 at 03:55:30AM -0500, Kimpel, Mark William wrote:
> I have 3 years of experience with R and have an interest in becoming a
> better programmer so that I might someday be able to contribute
> packages. Other than R, my only experience was taking Lisp from Daniel
> Friedman in the 1970's. I would like to learn either C or C++ for
> several reasons:
> 
> To gain a better concept of object oriented programming so that I can
> begin to use S4 methods in R.
> 
> To perhaps speed up some things I do repeatedly in R
> 
> To be able to contribute a package someday.
> 
>  
> 
> I have been doing some reading and from what I can tell R is more
> compatible with C, but C++ has much greater capabilities for OO
> programming.
> 
>  
> 
> I have just started reading The C++ Programming Language: Special
> Edition by Bjarne Stroustrup
> <http://search.barnesandnoble.com/booksearch/results.asp?ATH=Bjarne+Stro
> ustrup&z=y> , he recommends first learning C++ and then then C if
> necessary, but as a developer of C++, he is probably biased.
> 
>  
> 
> I would greatly appreciate the advice of the R developers and package
> contributors on this subject. "C" or "C++"?
> 

To echo several other comments, if your goal is to work in R, it would
be best to go straight to R.  I haven't used lisp much, but I believe
it is much closer to R than most other languages you could pick.  It
has a functional style, and I recall reading the R's scoping rules
were directly inspired by Scheme, a Lisp variant.  In fact, I didn't
feel I fully grasped them until I looked at Abelson and Sussman's
"Structure and Interpretation of Computer Languages" (which uses
Scheme).

The "functional" OO of R is significantly different from the
"class-based" OO found in most languages calling themselves object
oriented, including C++, Java, Python and smalltalk.  Learning those
other languages to understand R could actually interfere with learning
R.

If and when you need speed, you can program in any language that
supports Fortran or C interfaces, which is almost all of them.

If you're just doing general education....

I use C++ in R, and I have to say that programming in C++ is a
wretched experience.  You have to make a major committment to learning
the language, which is a minefield of gotcha's, to use it in full OO
style.  As others on this list and Stroustrup suggest, you can use it
and just incrementally add features over what you would do in C.  It
can also be speedy and powerful (to run, not to program in!), which is
why I'm using it.

For pure OO, I think you can't beat smalltalk, which is freely
available at www.squeak.org (also there is a GNU and several
commerical versions).  The language rules and syntax fit on one page.
The catch is that to use it you need to learn the environment and the
class library; these too are big tasks.

Objective-C is a much more lightweight C'ish OO than C++ (the author
moved smalltalk concepts into C).  It's available as part of the GNU
compilers.  Unlike smalltalk, you might use it if you cared about
performance, and it's the native language of Mac OS-X.  It has a
relatively small learning curve.

Python and Java are other choices for OO, both significantly simpler
than C++.  I find Python to be simple and elegant; it's also nifty for
scripting random tasks.  Java's widely used on the web and in the
enterprise.  Eiffel is also interesting.

I can't say much about "libraries already on other machines", but the
C runtime is probably the one you can count on being there the most.

Of course, another route would be to explore other functional
languages, a terrain I barely know: Haskell, ML, OCaml...  In
particular, some of them have lazy evaluation of arguments, which R
also employs.  And there are the functional/object languages like CLOS
(I think the O in OCaml is Object).

Anyway, this risks becoming a general language thread.  My main point,
as someone who's been there, is don't use C++ unless you have a
compelling reason and a lot of time!

Ross Boylan

(Among the languages listed, the ones I've used extensively are C,
C++, Objective-C, Python, R, and smalltalk.)


From Roger.Bivand at nhh.no  Sat Jan 20 00:56:43 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 20 Jan 2007 00:56:43 +0100 (CET)
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <836F00680EECD340A96AD34ECFF3B534B4A74F@iu-mssg-mbx106.ads.iu.edu>
Message-ID: <Pine.LNX.4.44.0701200029330.1902-100000@reclus.nhh.no>

On Fri, 19 Jan 2007, Kimpel, Mark William wrote:

> Thanks to all for your excellent suggestions. I think will I proceed
> working through the Stroustrup book. He has a section on comparing C
> with C++ and one on working with legacy C code that may prove helpful. I
> also have a "C for Dummies" (something like that, I don't have it right
> next to me) that I have also been reading. A couple of follow-up
> questions:

C with data abstraction (C with Classes) is where C++ came from (that is a 
hybrid of Simula and C). Clean C is very portable, whereas C++ can get 
caught by name mangling between compiler versions. Arguably (certainly in 
cost and probably in elegance) a good deal can still be harvested from 
another young adult (20+ might be seen as IT archeology by some?) - SICP 
is online at:

http://mitpress.mit.edu/sicp/full-text/book/book.html

and is excellent on programming in general, just Chapter 1 is refreshing
to (re)read every now and then. Kernighan and Pike's "The Practice of
Programming" - simplicity, clarity, generality - is also good for one's
common sense. 


> 
> 1. As I understand it, if I just wanted to distribute compiled code, I
> could use whatever extended C or C++ libraries that I wanted to use,
> however, since R is open source and people need to be able to compile
> things themselves, I imagine I would get into trouble (figuratively)
> using, say, the C++ STL. Would I need to distribute these files as well?
> For example, iostream instead of stdio.h. Or, should I just not use
> those?

Very few things are as standardised as they claim. I/O should not be done 
other than through R (like memory management where possible), so reducing 
the number of things that can go wrong (on some platform).

> 
> 2. For those of you who develop C on Windows (probably a small bunch!),
> what is your preferred development environment? I have the free Borland
> Turbo C++ and Visual C++ 6.0 (I knew enough to stay away from .NET). I
> tried to install the C++ module for Eclipse and, for me at least, it was
> a nightmare. I am not UNIX or DOS savvy and setting path variables and
> the like just made things too complicated.

Just MinGW like R, following the guides to the letter gets you there like
marked stones across a marsh. Leaving the path usually gets you at best
neck deep in the mire, alternatively just bubbles. The existing code in
both base R and the contributed packages is a good guide, but prototyping
in R alone, and profiling to see where things take time before
implementing in a compiled language, is often prudent.

> 
> 3. Lastly, is there a C or C++ community similar to R that I could
> address questions relating to those languages to? I don't want to abuse
> the R list as I learn.
> 
> Thanks,
> Mark
> 
> Mark W. Kimpel MD 
> 
>  
> 
> (317) 490-5129 Work, & Mobile
> 
>  
> 
> (317) 663-0513 Home (no voice mail please)
> 
> 1-(317)-536-2730 FAX
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From cberry at tajo.ucsd.edu  Sat Jan 20 01:43:02 2007
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Fri, 19 Jan 2007 16:43:02 -0800
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <Pine.LNX.4.44.0701200029330.1902-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0701200029330.1902-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.64.0701191639090.26742@tajo.ucsd.edu>

On Sat, 20 Jan 2007, Roger Bivand wrote:

> On Fri, 19 Jan 2007, Kimpel, Mark William wrote:
>
>> Thanks to all for your excellent suggestions. I think will I proceed

[snip]


Commenting on writing R packages with portable C/C++ code:

>
> [F]ollowing the guides to the letter gets you there like
> marked stones across a marsh. Leaving the path usually gets you at best
> neck deep in the mire, alternatively just bubbles.

Fortune!

[snip]


Charles C. Berry                        (858) 534-2098
                                          Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	         UC San Diego
http://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0901


From vdergachev at rcgardis.com  Sat Jan 20 03:42:13 2007
From: vdergachev at rcgardis.com (Vladimir Dergachev)
Date: Fri, 19 Jan 2007 21:42:13 -0500
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <20070119234658.GA7413@wheat.betterworld.us>
References: <836F00680EECD340A96AD34ECFF3B534B4A731@iu-mssg-mbx106.ads.iu.edu>
	<20070119234658.GA7413@wheat.betterworld.us>
Message-ID: <200701192142.13562.vdergachev@rcgardis.com>

On Friday 19 January 2007 6:46 pm, Ross Boylan wrote:
> On Fri, Jan 19, 2007 at 03:55:30AM -0500, Kimpel, Mark William wrote:
> I can't say much about "libraries already on other machines", but the
> C runtime is probably the one you can count on being there the most.

Well, I don't think it is there on Windows machines - and it is specific to 
the compiler. Visual C has several different versions, Borland had its own 
and there were several major releases of GNU C library.

My preference is that on Windows one only distributes static binaries, or, 
uses a small loadable object (i.e. dll) from Tcl/Tk or R.

On Linux I found it is best to link C and X11/GL libraries dynamically (as 
older versions are usually available) and link everything else statically. 
Major exception: condor linked binaries are static.

Caveat - I have not distributed anything but GPL/LGPL code, so making static 
binaries was not an issue. If you have a closed source application than any 
LGPL libraries you use must be linked dynamically and you cannot use GPL code 
at all.

                                   best

                                       Vladimir Dergachev


From p.dalgaard at biostat.ku.dk  Sat Jan 20 09:37:58 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat, 20 Jan 2007 09:37:58 +0100
Subject: [Rd] C vs. C++ as learning and development tool for R
In-Reply-To: <Pine.LNX.4.44.0701200029330.1902-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0701200029330.1902-100000@reclus.nhh.no>
Message-ID: <45B1D4E6.3040803@biostat.ku.dk>

Roger Bivand wrote:
> Just [use] MinGW like R [does], following the guides to the letter gets you there like
> marked stones across a marsh. Leaving the path usually gets you at best
> neck deep in the mire, alternatively just bubbles. 
That's the strongest contender for a space in the fortune file I've seen 
for a while!


From Kurt.Hornik at wu-wien.ac.at  Sun Jan 21 21:50:41 2007
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Sun, 21 Jan 2007 21:50:41 +0100
Subject: [Rd] uninformative error message in R CMD check (PR#9459)
In-Reply-To: <20070117195057.3E2E04C9CA@slim.kubism.ku.dk>
References: <20070117195057.3E2E04C9CA@slim.kubism.ku.dk>
Message-ID: <17843.53793.846683.443080@mithrandir.hornik.net>

>>>>> charlie  writes:

> I just saw the following using R version 2.4.1 (2006-12-18) in
> output from R CMD check.

>     * checking Rd files ... WARNING
>     Error in as.vector(x, mode) : invalid argument 'mode'
>     Execution halted
>     See the chapter 'Writing R documentation files' in manual 'Writing R
>     Extensions'.

> In looking at the help page (the only one in the package so far) I noticed
> that there was no details section even though I wrote one.  The problem
> was a missing close curly, that is, I had

>     \details{
>     Blah, blah, blah.
>     \value{
>     A list ....
>     }

> I don't know whether it is possible to have an actually informative
> error message, but it would be nice if possible.  The error went away
> and the package checked OK when I added the close curly

>     \details{
>     Blah, blah, blah.
>     }
>     \value{
>     A list ....
>     }

I can try, but I need a reproducible example.

For the examples with

\details{
  Bll bll bll.
\value{

etc I tried, I always got

* checking Rd files ... ERROR
Rd files with syntax errors:
  /path/to/file.Rd:
    unterminated section 'details'

-k


From mrennie at utm.utoronto.ca  Tue Jan 23 05:49:04 2007
From: mrennie at utm.utoronto.ca (Michael Rennie)
Date: Mon, 22 Jan 2007 23:49:04 -0500
Subject: [Rd] How to evaluate an lm() object for generating warning
 statement in a function
Message-ID: <6.1.0.6.0.20070122233824.01b9c828@mail.utm.utoronto.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070122/57096490/attachment.pl 

From rdpeng at gmail.com  Tue Jan 23 14:11:56 2007
From: rdpeng at gmail.com (Roger D. Peng)
Date: Tue, 23 Jan 2007 08:11:56 -0500
Subject: [Rd] How to evaluate an lm() object for generating warning
 statement in a function
In-Reply-To: <6.1.0.6.0.20070122233824.01b9c828@mail.utm.utoronto.ca>
References: <6.1.0.6.0.20070122233824.01b9c828@mail.utm.utoronto.ca>
Message-ID: <45B6099C.5090102@gmail.com>

There are two options, you can check to see if 'object.lm' inherits from "lm" 
using 'inherits()' or make comp.var.estimates a generic and then make a method 
for "lm" objects.

-roger

Michael Rennie wrote:
> Hi, there
> 
> I tried this post on R-help but did not generate any replies, so I thought 
> I might try the waters here since it's a more programming-based group.
> 
> I have written a function that will allow me to calculate the variance
> components for a model II (random effects) single factor ANOVA (perhaps 
> this is
> me re-inventing the wheel, but I handn't yet come across anything in R that
> does this for me, but I'm sure people will let me know from this posting if
> there are). The function takes as it's argument an object which holds the
> results of an lm call. e.g.,
> 
> object1<-lm(y~x)
> 
> The function is as follows (some comments included):
> 
> comp.var.estimates<-function(object.lm)
>                  {
>                  anovmod<-anova(object.lm) #get the anova table for the lm
>                  MStreat<-anovmod[1,3]; MSErr<-anovmod[2,3] #extract Mean 
> Squares
>                  dataframe<- as.data.frame(object.lm[13]) #gets the data 
> that went into the lm
>                  ni <- tapply(dataframe[,1], dataframe[,2], length) #number 
> of cases per treatment level
>                  nisq<-ni^2
>                  no<-(1/(length(ni)-1))*(sum(ni)-(sum(nisq)/sum(ni))) 
> #required to calculate variance components
>                  s2a<-((MStreat-MSErr)/no)
>                  stot<-s2a + MSErr
>                  treatvar<-s2a/stot*100  #calculate variance components as 
> a percentage of the total
>                  errorvar<-MSErr/stot*100
>                  list(treat.var.comp=s2a, 
> err.var.comp=MSErr,
>                  p.var.treat=treatvar, p.var.err=errorvar)
>                  }
> comp.var.estimates(object1)
> 
> I'd like to include a "warning" statement in the function that
> returns something like 'function requires arguments that are objects of the 
> form obj<-lm
> (y~x)', but I need a case to evaluate the object against in order to throw the
> warning.
> 
> Any advice?
> 
> I feel like my best opportunity is after the first line into the function,
> where I ask for the ANOVA table. Since this is a 2 X 5 table, presumably I
> should be able to evaluate it against the size of that table? Any thoughts on
> how to check that? I welcome any suggestions.
> 
> Cheers,
> 
> Mike
> 
> 
> 
> 
> Michael Rennie
> Ph.D. Candidate, University of Toronto at Mississauga
> 3359 Mississauga Rd. N.
> Mississauga, ON  L5L 1C6
> Ph: 905-828-5452  Fax: 905-828-3792
> www.utm.utoronto.ca/~w3rennie 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From spencer.graves at pdf.com  Tue Jan 23 16:41:58 2007
From: spencer.graves at pdf.com (Spencer Graves)
Date: Tue, 23 Jan 2007 07:41:58 -0800
Subject: [Rd] can't plot a line
Message-ID: <45B62CC6.1020008@pdf.com>

Consider the following: 

      plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
      lines(c(0,0), (2*c(-pi, pi))^2)

      I see no line in this plot. 

R version 2.4.1 (2006-12-18)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods" 
[7] "base"    

      My work around is the following: 

      pi2.2 <- (2*pi)^2
      lines(c(0, 0), c(-pi2.2, pi2.2))

      Why won't "lines(c(0,0), (2*c(-pi, pi))^2)" work for me? 
      Thanks,
      Spencer Graves


From ggrothendieck at gmail.com  Tue Jan 23 16:54:13 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 23 Jan 2007 10:54:13 -0500
Subject: [Rd] can't plot a line
In-Reply-To: <45B62CC6.1020008@pdf.com>
References: <45B62CC6.1020008@pdf.com>
Message-ID: <971536df0701230754j7b1d9a3ct1a8819da49a4498e@mail.gmail.com>

That's because your "line" is a point.  Both components of the y vector
are equal.  Check your parens.

On 1/23/07, Spencer Graves <spencer.graves at pdf.com> wrote:
> Consider the following:
>
>      plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
>      lines(c(0,0), (2*c(-pi, pi))^2)
>
>      I see no line in this plot.
>
> R version 2.4.1 (2006-12-18)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
> [7] "base"
>
>      My work around is the following:
>
>      pi2.2 <- (2*pi)^2
>      lines(c(0, 0), c(-pi2.2, pi2.2))
>
>      Why won't "lines(c(0,0), (2*c(-pi, pi))^2)" work for me?
>      Thanks,
>      Spencer Graves
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ess28 at cornell.edu  Tue Jan 23 16:58:25 2007
From: ess28 at cornell.edu (Emmanuel Sharef)
Date: Tue, 23 Jan 2007 10:58:25 -0500
Subject: [Rd] can't plot a line
In-Reply-To: <45B62CC6.1020008@pdf.com>
References: <45B62CC6.1020008@pdf.com>
Message-ID: <40EA13FA-EB6B-49CE-A32F-CFE8F6475076@cornell.edu>


On Jan 23, 2007, at 10:41 AM, Spencer Graves wrote:

> Consider the following:
>
>       plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
>       lines(c(0,0), (2*c(-pi, pi))^2)
>

You are creating a line from point (0,(2*(-pi))^2) to point (0,(2*pi) 
^2), however, since (-pi)^2=pi^2, it's not much of a line.


From marc_schwartz at comcast.net  Tue Jan 23 17:02:10 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Tue, 23 Jan 2007 10:02:10 -0600
Subject: [Rd] can't plot a line
In-Reply-To: <45B62CC6.1020008@pdf.com>
References: <45B62CC6.1020008@pdf.com>
Message-ID: <1169568130.4816.20.camel@localhost.localdomain>

On Tue, 2007-01-23 at 07:41 -0800, Spencer Graves wrote:
> Consider the following: 
> 
>       plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
>       lines(c(0,0), (2*c(-pi, pi))^2)
> 
>       I see no line in this plot. 
> 
> R version 2.4.1 (2006-12-18)
> i386-pc-mingw32
> 
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
> States.1252;LC_MONETARY=English_United 
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods" 
> [7] "base"    
> 
>       My work around is the following: 
> 
>       pi2.2 <- (2*pi)^2
>       lines(c(0, 0), c(-pi2.2, pi2.2))
> 
>       Why won't "lines(c(0,0), (2*c(-pi, pi))^2)" work for me? 
>       Thanks,
>       Spencer Graves

In the first case, you are squaring 2*pi and 2*-pi, both resulting in
the same positive number:

> (2*c(-pi, pi))^2
[1] 39.47842 39.47842

You are going from (0,39.47842) to (0,39.47842), hence no line.

HTH,

Marc Schwartz


From bcarvalh at jhsph.edu  Tue Jan 23 17:07:07 2007
From: bcarvalh at jhsph.edu (Benilton Carvalho)
Date: Tue, 23 Jan 2007 11:07:07 -0500
Subject: [Rd] can't plot a line
In-Reply-To: <45B62CC6.1020008@pdf.com>
References: <45B62CC6.1020008@pdf.com>
Message-ID: <CA936E8A-E58F-4A15-90BA-D76798B9BE50@jhsph.edu>

you don't see the line b/c you're squaring both "pi" and "-pi"

compare that with

lines(c(0,0), c(-1,1)*(2*pi)^2)

b


On Jan 23, 2007, at 10:41 AM, Spencer Graves wrote:

> Consider the following:
>
>       plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
>       lines(c(0,0), (2*c(-pi, pi))^2)
>
>       I see no line in this plot.
>
> R version 2.4.1 (2006-12-18)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"   
> "methods"
> [7] "base"
>
>       My work around is the following:
>
>       pi2.2 <- (2*pi)^2
>       lines(c(0, 0), c(-pi2.2, pi2.2))
>
>       Why won't "lines(c(0,0), (2*c(-pi, pi))^2)" work for me?
>       Thanks,
>       Spencer Graves
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From b.rowlingson at lancaster.ac.uk  Tue Jan 23 17:19:27 2007
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 23 Jan 2007 16:19:27 +0000
Subject: [Rd] can't plot a line
In-Reply-To: <45B62CC6.1020008@pdf.com>
References: <45B62CC6.1020008@pdf.com>
Message-ID: <45B6358F.3010007@lancaster.ac.uk>

Spencer Graves wrote:
> Consider the following: 
> 
>       plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
>       lines(c(0,0), (2*c(-pi, pi))^2)

  Because squaring is done before multiplication - its higher priority. 
Hence you end up with (-2*pi)^2 and (2*pi)^2, which are the same, and 
your 'line' becomes a dot.

  How about: lines(c(0,0), (2*pi)^2*c(-1,1))

Barry


From ripley at stats.ox.ac.uk  Tue Jan 23 17:18:45 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 23 Jan 2007 16:18:45 +0000 (GMT)
Subject: [Rd] can't plot a line
In-Reply-To: <45B62CC6.1020008@pdf.com>
References: <45B62CC6.1020008@pdf.com>
Message-ID: <Pine.LNX.4.64.0701231614030.2252@gannet.stats.ox.ac.uk>

On Tue, 23 Jan 2007, Spencer Graves wrote:

> Consider the following:
>
>      plot(0, 0, xlim=c(-10, 10), ylim=c(-50, 50))
>      lines(c(0,0), (2*c(-pi, pi))^2)
>
>      I see no line in this plot.

I do. You are drawing a line from a point to itself.  Try lwd=5 and it 
will be more visible.

>
> R version 2.4.1 (2006-12-18)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
> [7] "base"
>
>      My work around is the following:
>
>      pi2.2 <- (2*pi)^2
>      lines(c(0, 0), c(-pi2.2, pi2.2))

What is (-1)^2?

>      Why won't "lines(c(0,0), (2*c(-pi, pi))^2)" work for me?
>      Thanks,
>      Spencer Graves
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From santos at ensam.inra.fr  Tue Jan 23 18:14:55 2007
From: santos at ensam.inra.fr (Filipe Santos)
Date: Tue, 23 Jan 2007 18:14:55 +0100
Subject: [Rd] Refreshing the GUI and packing images
Message-ID: <200701231814.55960.santos@supagro.inra.fr>

Dear all

I'm developing a grafical interface for Geneland that is presently one of the 
R packages available.

My first question is about refreshing the interface while running a very long 
process.


run<-function(){

? ? ? ? tttry <- tktoplevel()
? ? ? ? tkwm.geometry(tttry, "+200+200")
? ? ? ? tkwm.title(tttry,"wait")
? ? ? ? warn<-tklabel(tttry,image=imagepleasewait)
? ? ? ? tkpack(warn) ? ? ? ? ? ? ? ? ? ? ? ?
? ? ? ? tkfocus(tttry)
? ? ? ? tcl("update")
? ? ? ? ? ? ? ? 
? ? ? ? print("Starting...")

? ? ? ? validate <- 1
? ? 
? ? ? ? onIdle <- function(){
? ? ? ? ? if (validate)==1){
? ? ? ? ? ? Sys.sleep(0.1)
? ? ? ? ? ? tkconfigure(warn,image=imagepleasewait)
? ? ? ? ? ? tcl("after","idle", onIdle())
? ? ? ? ? }
? ? ? ? ? else
? ? ? ? ? ? tkdestroy(tttry)
? ? ? ? }
? ? ? ? onIdle()

? ? ? ? mcmcFmodel(...) ? 
? ? ? ? 
? ? ? ? validate <- 0
}

If I remove the onIdle funtion the GUI stucks when I'm executing the 
mcmcFmodel, if I leave it neves calls mcmcFmodel. Then I thought that there 
could exist a fork() equivalent in R or somehow send a process to background 
but I couldn't find anyway to make that with R-base package.

My second question is in which directory images are supposed to be packed?
R has a strict directory rules for packages and there is no documentation 
regarding where should images for GUIs be putten. I was looking at SciViews 
package and they distribute that under a directory called gui.

Best regards

Filipe Santos


From wl2776 at gmail.com  Tue Jan 23 12:12:23 2007
From: wl2776 at gmail.com (Vladimir Eremeev)
Date: Tue, 23 Jan 2007 03:12:23 -0800 (PST)
Subject: [Rd] is it necessary to always register C routines with
 R_registerRoutines?
Message-ID: <8519680.post@talk.nabble.com>


I am writing bindings to the neural network simulator SNNS.
At present I have used only .C interface, now I'm studying .Call interface.

I have adapted the example from page 77 of r-exts.pdf, however, it crashes
R.
I use MingW as recommended by Duncan Murdoch.
Please, tell me what I am missing.
The code is below.

Thank you.

SEXP snns_getVersion(void)
{SEXP version;
 char *v;
  
  PROTECT(version=NEW_CHARACTER(15));
  v=CHARACTER_POINTER(version);
  strcpy(v,krui_getVersion());
  UNPROTECT(1);
  return version;
}

> sessionInfo()
R version 2.4.1 (2006-12-18) 
i386-pc-mingw32 

locale:
LC_COLLATE=Russian_Russia.1251;LC_CTYPE=Russian_Russia.1251;LC_MONETARY=Russian_Russia.1251;LC_NUMERIC=C;LC_TIME=Russian_Russia.1251

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[7] "base"     
 

-- 
View this message in context: http://www.nabble.com/is-it-necessary-to-always-register-C-routines-with-R_registerRoutines--tf3063486.html#a8519680
Sent from the R devel mailing list archive at Nabble.com.


From wl2776 at gmail.com  Tue Jan 23 12:57:49 2007
From: wl2776 at gmail.com (Vladimir Eremeev)
Date: Tue, 23 Jan 2007 03:57:49 -0800 (PST)
Subject: [Rd] is it necessary to always register C routines with
 R_registerRoutines?
In-Reply-To: <8519680.post@talk.nabble.com>
References: <8519680.post@talk.nabble.com>
Message-ID: <8520292.post@talk.nabble.com>


sorry, forgot to mention.

krui_getVersion returns char *

SEXP snns_getVersion(void)
{SEXP version;
 char *v;
  
  PROTECT(version=NEW_CHARACTER(15));
  v=CHARACTER_POINTER(version);
  strcpy(v,krui_getVersion());
  UNPROTECT(1);
  return version;
}


-- 
View this message in context: http://www.nabble.com/is-it-necessary-to-always-register-C-routines-with-R_registerRoutines--tf3063486.html#a8520292
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Wed Jan 24 10:15:25 2007
From: ripley at stats.ox.ac.uk (Brian Ripley)
Date: Wed, 24 Jan 2007 09:15:25 +0000 (GMT)
Subject: [Rd] is it necessary to always register C routines with
 R_registerRoutines?
In-Reply-To: <8519680.post@talk.nabble.com>
References: <8519680.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.64.0701240902250.5901@auk.stats>

No, in answer to the subject line.

On Tue, 23 Jan 2007, Vladimir Eremeev wrote:

> I am writing bindings to the neural network simulator SNNS.
> At present I have used only .C interface, now I'm studying .Call interface.
>
> I have adapted the example from page 77 of r-exts.pdf, however, it crashes
> R.

Page numbers depend on what paper it is formatted for, but on A4 this is 
nothing like the example on page 77.

> I use MingW as recommended by Duncan Murdoch.
> Please, tell me what I am missing.
> The code is below.
>
> Thank you.
>
> SEXP snns_getVersion(void)
> {SEXP version;
> char *v;
>
>  PROTECT(version=NEW_CHARACTER(15));
>  v=CHARACTER_POINTER(version);
>  strcpy(v,krui_getVersion());

I very much doubt that does what you think it does (but you have not told 
us).  I think the S-compatible Rdefines.h macros are really confusing for 
use in R, as R and S differ in how character vectors are stored.  In 
particular, use of CHARACTER_POINTER is likely to get into trouble as it 
is necessary to use SET_STRING_ELT in R.  (Similarly, CREATE_STRING_VECTOR 
does no such thing: it creates an element of a character vector.)

In this case

 	version = mkString(krui_getVersion());

would seem to be all that is needed.  But if you want to do it by hand,

     PROTECT(version=NEW_CHARACTER(1));
     SET_STRING_ELT(version, 0, mkChar(krui_getVersion()));
     UNPROTECT(1);

is the sort of thing needed.

>  UNPROTECT(1);
>  return version;
> }
>
>> sessionInfo()
> R version 2.4.1 (2006-12-18)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=Russian_Russia.1251;LC_CTYPE=Russian_Russia.1251;LC_MONETARY=Russian_Russia.1251;LC_NUMERIC=C;LC_TIME=Russian_Russia.1251
>
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
> [7] "base"
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From P.Dalgaard at biostat.ku.dk  Wed Jan 24 11:29:38 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 24 Jan 2007 11:29:38 +0100
Subject: [Rd] is it necessary to always register C routines with
	R_registerRoutines?
In-Reply-To: <Pine.LNX.4.64.0701240902250.5901@auk.stats>
References: <8519680.post@talk.nabble.com>
	<Pine.LNX.4.64.0701240902250.5901@auk.stats>
Message-ID: <45B73512.7020205@biostat.ku.dk>

Brian Ripley wrote:
> No, in answer to the subject line.
>
> On Tue, 23 Jan 2007, Vladimir Eremeev wrote:
>
>   
>> I am writing bindings to the neural network simulator SNNS.
>> At present I have used only .C interface, now I'm studying .Call interface.
>>
>> I have adapted the example from page 77 of r-exts.pdf, however, it crashes
>> R.
>>     
>
> Page numbers depend on what paper it is formatted for, but on A4 this is 
> nothing like the example on page 77.
>
>   
p.72 in the current PDF version on CRAN was probably intended (77th page
incl. front matter)

    -p

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From maechler at stat.math.ethz.ch  Wed Jan 24 11:57:48 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 24 Jan 2007 11:57:48 +0100
Subject: [Rd] Matrix subsetting {was "... vectorized nested loop..."}
In-Reply-To: <op.tmmjzpf6i4ukn7@delllap.ugr.es>
References: <op.tmmjzpf6i4ukn7@delllap.ugr.es>
Message-ID: <17847.15276.988909.832523@stat.math.ethz.ch>

Hi Jose,
I'm answering your second batch of questions, since
Chuck Berry has already well done so with the first one

>>>>> "Jose" == Jose Quesada <quesada at gmail.com>
>>>>>     on Tue, 23 Jan 2007 21:46:27 +0100 writes:

[........]

    Jose> # example
    Jose> library(Matrix)
    Jose> x = as(x,"CsparseMatrix")

[..........]

    Jose> Also, I have noticed that getting a row from a Matrix
    Jose> object produces a normal array (i.e., it does not
    Jose> inherit Matrix class). 

This is very much on purpose, following the principle of "least
surprise" so I'm surprised you're suprised.. :

The 'Matrix' behavior has been modelled to follow the more than
20 years old 'matrix' behavior :

 > matrix(1:9, 3) [,2]
 [1] 4 5 6
 > matrix(1:9, 3) [,2 , drop=FALSE]
      [,1]
 [1,]    4
 [2,]    5
 [3,]    6
 > library(Matrix)
 Loading required package: lattice
 > Matrix(1:9, 3) [,2]
 [1] 4 5 6
 > Matrix(1:9, 3) [,2, drop = FALSE]
 3 x 1 Matrix of class "dgeMatrix"
      [,1]
 [1,]    4
 [2,]    5
 [3,]    6
 > 

But then I should not be surprised, because
there has been the R FAQ

>> 7.5 Why do my matrices lose dimensions?

for quite a while.

*And* I think that there is only one "thing" in the S language
about which every "knowledgable one" agrees that it's a "design
bug", and that's the fact that 'drop = TRUE' is the default, and
not 'drop = FALSE' {but it's not possible to change now, please
don't start that discussion!}

    
Given what I say above, I wonder if our ("new-style") 'Matrix'
objects should not behave differently than ("old-style") 'matrix' and
indeed do use a default 'drop = FALSE'.
This might break some Matrix-based code though, but then
'Matrix' is young enough, and working Matrix indexing is much
younger,  and there are only about 4 CRAN/Bioconductor
packages depending on 'Matrix'.
--> This discussion (about changing this behavior in the
"Matrix" package) should definitely be lead on the R-devel
mailing list --> CC'ing to R-devel
{hence one (but please *only* one !) cross-post}

    Jose> However, selecting >1 rows,
    Jose> does produce a same-class matrix. If I convert with
    Jose> as() the output of selecting one row, am I losing
    Jose> performance? Is there any way to make the resulting
    Jose> vector be a 1-D Matrix object?

yes, ", drop = FALSE", see above

Martin


From talepanda at gmail.com  Wed Jan 24 12:11:53 2007
From: talepanda at gmail.com (talepanda)
Date: Wed, 24 Jan 2007 20:11:53 +0900
Subject: [Rd] Useful statusbar in RGui
Message-ID: <3948d9e50701240311x32e806aawadf9d2216391612d@mail.gmail.com>

This may be Windows specific, so not appropriate for this List...

Currently, when I'm in console of Rgui, the status bar says a simple message
"R majer ver. minor ver. - A Language and Environment" which I know.
When I'm in plot area, it says "R Graphics" which I know, again.


I think it is very useful if statusbars says current directory,
because in my daily use I open several Rgui windows in different
directory (that is, different project), and it is diffecult to find
the window which I want.

Someone may hope something else.


So, my proposal is to allow users to change the message in status bar.

I think that a wrapper for function "setstatus" in
src/guiwin32/graphapp/status.c is enough for this purpose.

thanks


From ulfmartin at web.de  Wed Jan 24 12:28:46 2007
From: ulfmartin at web.de (Ulf Martin)
Date: Wed, 24 Jan 2007 12:28:46 +0100
Subject: [Rd] how to properly extend s3 data.frames with s4 classes?
Message-ID: <45B742EE.4050905@web.de>

Dear R Programmers!

After some time of using R I decided to work through John Chambers book 
"Programming with Data" to learn what these S4 classes are all about and 
how they work in R. (I regret not having picked up this rather fine book 
earlier!)

I know from the documentation and the mailing archives that S4 in R is 
not 100% the book and that there are issues especially with dataframes, 
but to my knowledge the following has not been reported yet.


Summary
-------
(a) When extending a S3 data.frame with a S4 class adding a slot, it 
seems to be impossible to initialize objects of these 
"ExtendedDataframes" (XDF) with S3 data.frames.

(b) Extending data.frames with an S4 class without a slot, i.e. creating 
a "WrappedDataframe" (WDF), seems to allow initialization with a 
data.frame, but the behaviour appears to be somewhat inconsistent.

(c) Trying to be "smart" by extending the WrappedDataframe from (b) by 
adding a slot, yields a similar behaviour than (a), i.e. initialization 
with a WDF object fails although WDF is an instance of an S4 class.

It is actually (c) that surprises me most.


Code
----
# (Should be pastable into an R session)
# R version is 2.4.1
#
# === Preliminaries ===
# (">" indicates output)
#
library("methods")
setOldClass("data.frame")
tdf <- data.frame(x=c(1,2), y=c(TRUE,FALSE)) # For testing purposes
#
# === (a) Exdended Dataframe Case ===
#
XDF <- "ExtendedDataframe" # Convenient shortcut
setClass(XDF, representation("data.frame", info="character"))
getClass(XDF)
#
# > Slots:
# >
# > Name:       info
# > Class: character
# >
# > Extends:
# > Class "data.frame", directly
# > Class "oldClass", by class "data.frame", distance 2
#
# So far everything looks good.
# But now,
#
new(XDF)                                 # a1)
new(XDF, data.frame())                   # a2)
new(XDF, tdf, info="Where is the data?") # a3)
#
# all yield:
#
# > An object of class "ExtendedDataframe"
# > NULL
# > <0 rows> (or 0-length row.names)
#
# Only (a3) additionally has
#
# > Slot "info":
# > [1] "Where is the data?"
#
# === (b) Wrapped Dataframe ===
#
WDF <- "WrappedDataframe"
setClass(WDF, representation("data.frame"))
getClass(WDF)
#
# > No Slots, prototype of class "S4"  # N.B.!
# >
# > Extends:
# > Class "data.frame", directly
# > Class "oldClass", by class "data.frame", distance 2
#
new(WDF)
#
# > <S4 Type Object>
# > attr(,"class")
# > [1] "WrappedDataframe"
# > attr(,"class")attr(,"package")
# > [1] ".GlobalEnv"
#
# Now we have attributes -- there wheren't any with XDF.
# Thus, not supplying a slot adds attributes -- confusing.
#
# Now: Initialization with an empty data.frame instead of nothing:
#
new(WDF, data.frame())
#
# > An object of class "WrappedDataframe"
# > Slot "row.names":
# > character(0)
# > Warning message:
# > missing package slot (.GlobalEnv) in object of class
# > "WrappedDataframe" (package info added) in: initialize(value, ...)
#
# OBS! Now there is
#  (i) a slot "row.names" -- which is wrong
#      since WDFs aren't suposed to have any slots;
# (ii) an odd warning about another missing slot
#      (presumably called "package" but the message is
#      somewhat ambigous).
#
# But at least
#
new(WDF, tdf)
#
# yields:
#
# > $x
# > [1] 1 2
# >
# > $y
# > [1]  TRUE FALSE
# >
# > attr(,"row.names")
# > [1] 1 2
# > attr(,"class")
# > [1] "WrappedDataframe"
# > attr(,"class")attr(,"package")
# > [1] ".GlobalEnv"
# > Warning message:
# > missing package slot (.GlobalEnv) in object of class
# > "WrappedDataframe" (package info added) in: initialize(value, ...)
#
# So, at least the data seems to be there. Let's use this one.
#
wdf <- new(WDF, tdf)
#
# === (c) "Smart" Dataframes ===
#
SDF <- "SmartDataframe"
setClass(SDF, representation(WDF, info="character"))
getClass(SDF)
#
# > Slots:
# >
# > Name:       info
# > Class: character
# >
# > Extends:
# > Class "WrappedDataframe", directly
# > Class "data.frame", by class "WrappedDataframe", distance 2
# > Class "oldClass", by class "WrappedDataframe", distance 3
#
# Now I would expect this:
#
new(SDF,wdf)
#
# to show the data in wdf, but in fact I get:
#
# > An object of class "SmartDataframe"
# > NULL
# > <0 rows> (or 0-length row.names)
# > Slot "info":
# > character(0)
#
# which is the same as:
#
new(SDF)
#
# or
#
new(SDF, data.frame())
#
# The slot does get initialized, though
#
new(SDF,wdf,info="Where is the data?")
new(SDF,tdf,info="Where is the data?")
#
# END OF CODE


Further Remarks
---------------
The rationale behind being able to extend S3 data.frames with S4 classes 
is that
(a) there is so much legacy code for data.frames (they are the 
foundation of the data part in "programming with data");
(b) S4 classes allow for validation, multiple dispatch, etc.

I also wonder why the R developers chose this "setOldClass" way of 
making use of S3 classes rather than adding a clean set of wrapper 
classes that delegate calls to them cleanly down to their resp. S3 
companions (i.e. a "Methods" package (capital "M") with "Character", 
"Numeric", "List", "Dataframe", etc.). The present situation appears to 
be somewhat messy.


Anyway -- a great tool and great work!
Cheers!
Ulf Martin


From ripley at stats.ox.ac.uk  Wed Jan 24 15:12:49 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 24 Jan 2007 14:12:49 +0000 (GMT)
Subject: [Rd] Useful statusbar in RGui
In-Reply-To: <3948d9e50701240311x32e806aawadf9d2216391612d@mail.gmail.com>
References: <3948d9e50701240311x32e806aawadf9d2216391612d@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701241314300.21703@gannet.stats.ox.ac.uk>

On Wed, 24 Jan 2007, talepanda wrote:

> This may be Windows specific, so not appropriate for this List...
>
> Currently, when I'm in console of Rgui, the status bar says a simple message
> "R majer ver. minor ver. - A Language and Environment" which I know.
> When I'm in plot area, it says "R Graphics" which I know, again.
>
>
> I think it is very useful if statusbars says current directory,
> because in my daily use I open several Rgui windows in different
> directory (that is, different project), and it is diffecult to find
> the window which I want.

It is not clear to me that information is best put in the status bar and 
not the title bar (which is where Unix-like systems can put it, and even 
where Explorer does, and can be seen in the minimized versions).  So I 
would think setWindowTitle() was at least as appropriate (and so did the 
person who wrote its examples).

> Someone may hope something else.
>
>
> So, my proposal is to allow users to change the message in status bar.
>
> I think that a wrapper for function "setstatus" in
> src/guiwin32/graphapp/status.c is enough for this purpose.

Yes, that has been proposed recently in connection with interfaces for 
messages().  Note though that at present only the MDI interface has the 
option of a status bar.  I think we should move to a more standard way of 
having these 'toolbars' on or off (e.g. ticked items on a View menu).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From talepanda at gmail.com  Wed Jan 24 16:05:55 2007
From: talepanda at gmail.com (talepanda)
Date: Thu, 25 Jan 2007 00:05:55 +0900
Subject: [Rd] Useful statusbar in RGui
In-Reply-To: <Pine.LNX.4.64.0701241314300.21703@gannet.stats.ox.ac.uk>
References: <3948d9e50701240311x32e806aawadf9d2216391612d@mail.gmail.com>
	<Pine.LNX.4.64.0701241314300.21703@gannet.stats.ox.ac.uk>
Message-ID: <3948d9e50701240705q2eaf0eud120e6fcd03ae2cf@mail.gmail.com>

Dear Prof Ripley, thank you for your suggestion.

> > I think it is very useful if statusbars says current directory,
> > because in my daily use I open several Rgui windows in different
> > directory (that is, different project), and it is diffecult to find
> > the window which I want.
>
> It is not clear to me that information is best put in the status bar and
> not the title bar (which is where Unix-like systems can put it, and even
> where Explorer does, and can be seen in the minimized versions).  So I
> would think setWindowTitle() was at least as appropriate (and so did the
> person who wrote its examples).

Title bar is good alternative.
Adding codes below to Rprofile.site works good.

utils::setWindowTitle(base::getwd())
utils::assignInNamespace("setwd",function(dir){.Internal(setwd(dir));setWindowTitle(base::getwd())},"base")

>
> > Someone may hope something else.
> >
> >
> > So, my proposal is to allow users to change the message in status bar.
> >
> > I think that a wrapper for function "setstatus" in
> > src/guiwin32/graphapp/status.c is enough for this purpose.
>
> Yes, that has been proposed recently in connection with interfaces for
> messages().  Note though that at present only the MDI interface has the
> option of a status bar.  I think we should move to a more standard way of
> having these 'toolbars' on or off (e.g. ticked items on a View menu).
>

I agree.
A standard interface is a good interface, and a good interface helps our works.

Thanks, again.


From wl2776 at gmail.com  Wed Jan 24 20:15:49 2007
From: wl2776 at gmail.com (Vladimir Eremeev)
Date: Wed, 24 Jan 2007 11:15:49 -0800 (PST)
Subject: [Rd] how to trace what crashes R
Message-ID: <8570488.post@talk.nabble.com>


I am writing bindings to the C library (neural network simulator SNNS).
DLL was produced with the command
R CMD SHLIB  [source with C-wrappers, callable from R with .C and all
sources from the snns kernel]
I used latest MinGW.

The problem is. R crashes with the "segmentation violation".
Tracing with the insight and with simple Rprintf's gave me that crash occurs
on the call of the function deeply in the snns kernel. 
That is, R correctly calls C wrapper, it calls the kernel function from the
so called "user interface" part, it calls another C function from the
internals, and that one calls the third C function. 
And the segmentation fault occurs on the call of that function, it doesn't
do anything, its arguments have correct values, and it works in the other
situations, for example, when I run executables from the SNNS (either gui
version of the simulator, or batch interpreter).
Moreover, I don't think the reason in the incorrect arguments, since the
called function doesn't do anything. 
Rprintf in the very beginning of its body doesn't work (I traced it in
console mode of R).

How could I trace, what happens?
-- 
View this message in context: http://www.nabble.com/how-to-trace-what-crashes-R-tf3083985.html#a8570488
Sent from the R devel mailing list archive at Nabble.com.


From edd at debian.org  Wed Jan 24 20:47:01 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 24 Jan 2007 13:47:01 -0600
Subject: [Rd] how to trace what crashes R
In-Reply-To: <8570488.post@talk.nabble.com>
References: <8570488.post@talk.nabble.com>
Message-ID: <20070124194701.GA11252@eddelbuettel.com>

On Wed, Jan 24, 2007 at 11:15:49AM -0800, Vladimir Eremeev wrote:
> The problem is. R crashes with the "segmentation violation".
> Tracing with the insight and with simple Rprintf's gave me that crash occurs
> on the call of the function deeply in the snns kernel. 
> That is, R correctly calls C wrapper, it calls the kernel function from the
> so called "user interface" part, it calls another C function from the
> internals, and that one calls the third C function. 
> And the segmentation fault occurs on the call of that function, it doesn't
> do anything, its arguments have correct values, and it works in the other
> situations, for example, when I run executables from the SNNS (either gui
> version of the simulator, or batch interpreter).
> Moreover, I don't think the reason in the incorrect arguments, since the
> called function doesn't do anything. 
> Rprintf in the very beginning of its body doesn't work (I traced it in
> console mode of R).
> 
> How could I trace, what happens?

Compile snns with debugging support, compile R with debugging, start R
as 

   $ R -d gdb		## or ddd if you have it
   
and use the debugger.  There is a lot of useful information in the
fine manual on 'R Extensions'.

Dirk

-- 
Hell, there are no rules here - we're trying to accomplish something. 
                                                  -- Thomas A. Edison


From murdoch at stats.uwo.ca  Wed Jan 24 21:13:24 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 24 Jan 2007 15:13:24 -0500
Subject: [Rd] how to trace what crashes R
In-Reply-To: <20070124194701.GA11252@eddelbuettel.com>
References: <8570488.post@talk.nabble.com>
	<20070124194701.GA11252@eddelbuettel.com>
Message-ID: <45B7BDE4.9090704@stats.uwo.ca>

On 1/24/2007 2:47 PM, Dirk Eddelbuettel wrote:
> On Wed, Jan 24, 2007 at 11:15:49AM -0800, Vladimir Eremeev wrote:
>> The problem is. R crashes with the "segmentation violation".
>> Tracing with the insight and with simple Rprintf's gave me that crash occurs
>> on the call of the function deeply in the snns kernel. 
>> That is, R correctly calls C wrapper, it calls the kernel function from the
>> so called "user interface" part, it calls another C function from the
>> internals, and that one calls the third C function. 
>> And the segmentation fault occurs on the call of that function, it doesn't
>> do anything, its arguments have correct values, and it works in the other
>> situations, for example, when I run executables from the SNNS (either gui
>> version of the simulator, or batch interpreter).
>> Moreover, I don't think the reason in the incorrect arguments, since the
>> called function doesn't do anything. 
>> Rprintf in the very beginning of its body doesn't work (I traced it in
>> console mode of R).
>> 
>> How could I trace, what happens?
> 
> Compile snns with debugging support, compile R with debugging, start R
> as 
> 
>    $ R -d gdb		## or ddd if you have it
>    
> and use the debugger.  There is a lot of useful information in the
> fine manual on 'R Extensions'.

Since Vladimir is using MinGW he's on Windows, and things are slightly 
different:  you would use

insight rgui

to start the debugger.  Other than that, it's mostly the same; details 
aimed at Windows are given in my web page

http://www.stats.uwo.ca/faculty/murdoch/software/debuggingR/

in the "Using gdb to debug C or Fortran code" section.

Duncan Murdoch


From r.darnell at uq.edu.au  Thu Jan 25 03:34:37 2007
From: r.darnell at uq.edu.au (r.darnell at uq.edu.au)
Date: Thu, 25 Jan 2007 03:34:37 +0100 (CET)
Subject: [Rd] Error in loadNamespace(name) (PR#9464)
Message-ID: <20070125023437.912CE19A4A@slim.kubism.ku.dk>

Full_Name: Ross Darnell
Version: 2.4.1
OS: Linux
Submission from: (NULL) (130.102.133.33)


rdarnell at pc:~/Data$ ls -al .RData
-rwxrwxrwx 2 root root 13551 2006-12-06 08:58 .RData
rdarnell at pc:~/Data$ R

R version 2.4.1 (2006-12-18)
Copyright (C) 2006 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Error in loadNamespace(name) : there is no package called 'lattice'
Fatal error: unable to restore saved data in .RData

rdarnell at pc:~/Data$ R --no-restore-data

> load(".RData")
Error in loadNamespace(name) : there is no package called 'lattice'



--please do not edit the information below--

Version:
 platform = i486-pc-linux-gnu
 arch = i486
 os = linux-gnu
 system = i486, linux-gnu
 status = 
 major = 2
 minor = 4.1
 year = 2006
 month = 12
 day = 18
 svn rev = 40228
 language = R
 version.string = R version 2.4.1 (2006-12-18)

Locale:
LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils,
package:datasets, package:methods, Autoloads, package:base


From ripley at stats.ox.ac.uk  Thu Jan 25 08:47:42 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 25 Jan 2007 08:47:42 +0100 (CET)
Subject: [Rd] Error in loadNamespace(name) (PR#9464)
Message-ID: <20070125074742.9B4C04C912@slim.kubism.ku.dk>

There is nothing here to reproduce.
It clearly depends on your .RData, which is not available to us.
Unless you can make it available, we cannot help.

On Thu, 25 Jan 2007, r.darnell at uq.edu.au wrote:

> Full_Name: Ross Darnell
> Version: 2.4.1
> OS: Linux
> Submission from: (NULL) (130.102.133.33)
>
>
> rdarnell at pc:~/Data$ ls -al .RData
> -rwxrwxrwx 2 root root 13551 2006-12-06 08:58 .RData
> rdarnell at pc:~/Data$ R
>
> R version 2.4.1 (2006-12-18)
> Copyright (C) 2006 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> Error in loadNamespace(name) : there is no package called 'lattice'
> Fatal error: unable to restore saved data in .RData
>
> rdarnell at pc:~/Data$ R --no-restore-data
>
>> load(".RData")
> Error in loadNamespace(name) : there is no package called 'lattice'
>
>
>
> --please do not edit the information below--
>
> Version:
> platform = i486-pc-linux-gnu
> arch = i486
> os = linux-gnu
> system = i486, linux-gnu
> status =
> major = 2
> minor = 4.1
> year = 2006
> month = 12
> day = 18
> svn rev = 40228
> language = R
> version.string = R version 2.4.1 (2006-12-18)
>
> Locale:
> LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C
>
> Search Path:
> .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils,
> package:datasets, package:methods, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From P.Dalgaard at biostat.ku.dk  Thu Jan 25 12:00:31 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 25 Jan 2007 12:00:31 +0100
Subject: [Rd] Error in loadNamespace(name) (PR#9464)
In-Reply-To: <20070125074742.9B4C04C912@slim.kubism.ku.dk>
References: <20070125074742.9B4C04C912@slim.kubism.ku.dk>
Message-ID: <45B88DCF.2060605@biostat.ku.dk>

ripley at stats.ox.ac.uk wrote:
> There is nothing here to reproduce.
> It clearly depends on your .RData, which is not available to us.
> Unless you can make it available, we cannot help.
>   
Well, it's insufficient as a bug report, but the "no package called
'lattice'" bit suggests an installation issue. So which kind of
installation is this? Which "Linux", install from source or CRAN binary
or other package repository? Can lattice be loaded by library(lattice),
and if you do so before loading .RData, does it then help?
> On Thu, 25 Jan 2007, r.darnell at uq.edu.au wrote:
>
>   
>> Full_Name: Ross Darnell
>> Version: 2.4.1
>> OS: Linux
>> Submission from: (NULL) (130.102.133.33)
>>
>>
>> rdarnell at pc:~/Data$ ls -al .RData
>> -rwxrwxrwx 2 root root 13551 2006-12-06 08:58 .RData
>> rdarnell at pc:~/Data$ R
>>
>> R version 2.4.1 (2006-12-18)
>> Copyright (C) 2006 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>>  Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>> Error in loadNamespace(name) : there is no package called 'lattice'
>> Fatal error: unable to restore saved data in .RData
>>
>> rdarnell at pc:~/Data$ R --no-restore-data
>>
>>     
>>> load(".RData")
>>>       
>> Error in loadNamespace(name) : there is no package called 'lattice'
>>
>>
>>
>> --please do not edit the information below--
>>
>> Version:
>> platform = i486-pc-linux-gnu
>> arch = i486
>> os = linux-gnu
>> system = i486, linux-gnu
>> status =
>> major = 2
>> minor = 4.1
>> year = 2006
>> month = 12
>> day = 18
>> svn rev = 40228
>> language = R
>> version.string = R version 2.4.1 (2006-12-18)
>>
>> Locale:
>> LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C
>>
>> Search Path:
>> .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils,
>> package:datasets, package:methods, Autoloads, package:base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>     
>
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From ashish.kulkarni at kalyptorisk.com  Thu Jan 25 12:32:49 2007
From: ashish.kulkarni at kalyptorisk.com (Ashish Kulkarni)
Date: Thu, 25 Jan 2007 17:02:49 +0530
Subject: [Rd] serialize() takes too long when serializing to a raw vector
Message-ID: <2AB7346A3227A74BB97F9A0D79E3E65A090DB1@kalyptomail.dnsalias.com>

Hello,

R version 2.4.1 (2006-12-18) 
i386-pc-mingw32

Calling serialize() with a NULL connection serializes it to a raw vector. However, when the object to be serialized is large, it takes a very long time:

> system.time( serialize(matrix(0, 1000, 1000), NULL) )
[1] 38.25 40.73 81.54    NA    NA

> system.time( serialize(matrix(0, 2000, 2000), NULL) )
[1]  609.72  664.75 1318.57      NA      NA

I was using this in Rmpi, where a clustered call returned a large matrix. However, serializing to a file or sockets is very fast for the very same matrix -- hence I wrote this function which runs much faster:

.mpi.quick.serialize <- function (object)
{
    fname <- tempfile("Rmpi")
    stream <- file(fname, "wb")
    on.exit({
        close(stream)
        file.remove(fname)
    })
    serialize(object, stream)
    close(stream)
    size <- file.info(fname)$size
    stream <- file(fname, "rb")
    return(readBin(stream, "raw", n = size))
}

> system.time( .mpi.quick.serialize(matrix(0, 1000, 1000) ) )
[1] 0.2500000000000000 0.0499999999999545 0.3000000000001819
[4]                 NA                 NA

> system.time( .mpi.quick.serialize(matrix(0, 2000, 2000) ) )
[1] 1.059999999999945 0.220000000000027 1.289999999999964
[4]                NA                NA

Does anyone have an idea why the performance difference is so 
large? Also, I was wondering if there is a better way -- the 
above solution feels like a quick fix rather than a correct
approach.

Regards,
ashish


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 25 14:03:15 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 25 Jan 2007 13:03:15 +0000
Subject: [Rd] serialize() takes too long when serializing to a raw vector
In-Reply-To: <2AB7346A3227A74BB97F9A0D79E3E65A090DB1@kalyptomail.dnsalias.com>
References: <2AB7346A3227A74BB97F9A0D79E3E65A090DB1@kalyptomail.dnsalias.com>
Message-ID: <45B8AA93.2000801@cimr.cam.ac.uk>

Ashish Kulkarni wrote:
> Hello,
> 
> R version 2.4.1 (2006-12-18) 
> i386-pc-mingw32
> 
> Calling serialize() with a NULL connection serializes it to a raw vector. However, when the object to be serialized is large, it takes a very long time:
> 
>> system.time( serialize(matrix(0, 1000, 1000), NULL) )
> [1] 38.25 40.73 81.54    NA    NA
> 
>> system.time( serialize(matrix(0, 2000, 2000), NULL) )
> [1]  609.72  664.75 1318.57      NA      NA

<snipped>
>> system.time( .mpi.quick.serialize(matrix(0, 1000, 1000) ) )
> [1] 0.2500000000000000 0.0499999999999545 0.3000000000001819
> [4]                 NA                 NA
> 
>> system.time( .mpi.quick.serialize(matrix(0, 2000, 2000) ) )
> [1] 1.059999999999945 0.220000000000027 1.289999999999964
> [4]                NA                NA
> 
> Does anyone have an idea why the performance difference is so 
> large? Also, I was wondering if there is a better way -- the 
> above solution feels like a quick fix rather than a correct
> approach.

It might be interesting to know get some details on your hardware.

On my box, linux native seems to be a little slower than
your quick.serialize times:

 > system.time( serialize(matrix(0, 1000, 1000), NULL) )
[1] 0.372 0.288 0.692 0.000 0.000
 > system.time( serialize(matrix(0, 2000, 2000), NULL) )
[1] 1.237 1.195 2.501 0.000 0.000

running R 2.4.1 windows under wine (same box) is a good deal s
lower, but is not anywhere nearly as slow as yours.

 > system.time( serialize(matrix(0, 1000, 1000), NULL) )
[1] 0.00 0.00 6.08   NA   NA
 > system.time( serialize(matrix(0, 2000, 2000), NULL) )
[1]  0.01  0.01 78.00    NA    NA
 >

Since you mentioned that you are using Rmpi, there is a possibility
that you might be calling a different serialize() than base::serialize
all together???


From wl2776 at gmail.com  Thu Jan 25 14:11:56 2007
From: wl2776 at gmail.com (Vladimir Eremeev)
Date: Thu, 25 Jan 2007 05:11:56 -0800 (PST)
Subject: [Rd] I have won!
In-Reply-To: <8570488.post@talk.nabble.com>
References: <8570488.post@talk.nabble.com>
Message-ID: <8612674.post@talk.nabble.com>



Vladimir Eremeev wrote:
> 
> That is, R correctly calls C wrapper, 
> ...
> its arguments have correct values
> 
That was not the case. 
I forgot as.integer() in the .C call and one of the arguments was 0 instead
of 1.
Since that, indices in the array were calculated incorrectly, and the
program tried reading prohibited memory address.
-- 
View this message in context: http://www.nabble.com/how-to-trace-what-crashes-R-tf3083985.html#a8612674
Sent from the R devel mailing list archive at Nabble.com.


From ashish.kulkarni at kalyptorisk.com  Thu Jan 25 14:26:22 2007
From: ashish.kulkarni at kalyptorisk.com (Ashish Kulkarni)
Date: Thu, 25 Jan 2007 18:56:22 +0530
Subject: [Rd] serialize() takes too long when serializing to a raw vector
In-Reply-To: <45B8AA93.2000801@cimr.cam.ac.uk>
Message-ID: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>

Hin-Tak Leung wrote:
> 
> It might be interesting to know get some details on your hardware.
> 

It's a P4 2.66GHz with a standard Intel motherboard having 1GB RAM.

> On my box, linux native seems to be a little slower than
> your quick.serialize times:
> 
>  > system.time( serialize(matrix(0, 1000, 1000), NULL) )
> [1] 0.372 0.288 0.692 0.000 0.000
>  > system.time( serialize(matrix(0, 2000, 2000), NULL) )
> [1] 1.237 1.195 2.501 0.000 0.000
> 
> running R 2.4.1 windows under wine (same box) is a good deal s
> lower, but is not anywhere nearly as slow as yours.
> 
>  > system.time( serialize(matrix(0, 1000, 1000), NULL) )
> [1] 0.00 0.00 6.08   NA   NA
>  > system.time( serialize(matrix(0, 2000, 2000), NULL) )
> [1]  0.01  0.01 78.00    NA    NA
>  >
> 

Well, the timings certainly differ quite a bit. What kind of
hardware do you have? I suspect that most of the delay may be
caused by memory reallocation since the size of the output 
raw array is not known up front. I would imagine that WINE 
would use the system memory allocator, not the one used by 
the windows kernel.

> Since you mentioned that you are using Rmpi, there is a possibility
> that you might be calling a different serialize() than base::serialize
> all together???

Nope, I hit this problem while using Rmpi and tracked it down
to .mpi.serialize, which in turn calls base::serialize. From Rmpi:

.mpi.serialize <- function (obj) 
{
    trans_obj = serialize(obj, NULL)
    if (getRversion() >= "2.4.0") 
        return(trans_obj)
    else return(charToRaw(trans_obj))
}

Regards,
ashish


From andy_liaw at merck.com  Thu Jan 25 15:08:08 2007
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu, 25 Jan 2007 09:08:08 -0500
Subject: [Rd] obsolescence
In-Reply-To: <45B10794.3080102@lancaster.ac.uk>
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA039AE136@usctmx1106.merck.com>

I think many would object to automatic check at every start-up.  For the
issue at hand, perhaps a check inside bug.report() would go a long way?
Just an idea...

Andy 

From: Barry Rowlingson
> 
> Since many posts to R-devel/help invoke this response:
> 
> Prof Brian Ripley wrote:
> > Please, use the current version of R and not an obselete one
> 
> is there an argument for including a version check on R 
> startup?  These things seem somewhat in vogue these days 
> (what with everything on the internet being in a permanent 
> 'beta' state), and software will often start up with 'A new 
> version of Foobar is available' dialog.
> 
>   Perhaps R.version could return a component that says 
> 'current', 'buggy', or 'obsolete' as appropriate?
> 
>   It would need a file on a well-known URL to give the 
> version information, an internet connection, and a bit of R 
> code.  And obviously a server capable of handling the load...
> 
>   I'd vote to have the version check off by default, perhaps 
> settable at compile-time, and configurable by the usual R 
> startup mechanism.  The check wouldn't run if R is running 
> with the BATCH command.  Personally, I'd switch it off 
> completely, because these things annoy me.
> 
>   Maybe this is already in R, but I'm using an obsolete 
> version at the moment (2.4.0).
> 
> Barry
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> 


------------------------------------------------------------------------------
Notice:  This e-mail message, together with any attachments,...{{dropped}}


From P.Dalgaard at biostat.ku.dk  Thu Jan 25 15:19:18 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 25 Jan 2007 15:19:18 +0100
Subject: [Rd] serialize() takes too long when serializing to a raw vector
In-Reply-To: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>
References: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>
Message-ID: <45B8BC66.9010904@biostat.ku.dk>

Ashish Kulkarni wrote:
> Hin-Tak Leung wrote:
>   
>> It might be interesting to know get some details on your hardware.
>>
>>     
>
> It's a P4 2.66GHz with a standard Intel motherboard having 1GB RAM.
>
>   
>> On my box, linux native seems to be a little slower than
>> your quick.serialize times:
>>
>>  > system.time( serialize(matrix(0, 1000, 1000), NULL) )
>> [1] 0.372 0.288 0.692 0.000 0.000
>>  > system.time( serialize(matrix(0, 2000, 2000), NULL) )
>> [1] 1.237 1.195 2.501 0.000 0.000
>>
>> running R 2.4.1 windows under wine (same box) is a good deal s
>> lower, but is not anywhere nearly as slow as yours.
>>
>>  > system.time( serialize(matrix(0, 1000, 1000), NULL) )
>> [1] 0.00 0.00 6.08   NA   NA
>>  > system.time( serialize(matrix(0, 2000, 2000), NULL) )
>> [1]  0.01  0.01 78.00    NA    NA
>>  >
>>
>>     
>
> Well, the timings certainly differ quite a bit. What kind of
> hardware do you have? I suspect that most of the delay may be
> caused by memory reallocation since the size of the output 
> raw array is not known up front. I would imagine that WINE 
> would use the system memory allocator, not the one used by 
> the windows kernel.
>
>   
>> Since you mentioned that you are using Rmpi, there is a possibility
>> that you might be calling a different serialize() than base::serialize
>> all together???
>>     
>
> Nope, I hit this problem while using Rmpi and tracked it down
> to .mpi.serialize, which in turn calls base::serialize. From Rmpi:
>
> .mpi.serialize <- function (obj) 
> {
>     trans_obj = serialize(obj, NULL)
>     if (getRversion() >= "2.4.0") 
>         return(trans_obj)
>     else return(charToRaw(trans_obj))
> }
>
>   
Just a little sanity check on Linux. This seems to indicate an
essentially constant run time per million matrix elements. So I suspect
that something Windows-specific is going on.

> x <- sapply(1:8, function(i) {print(i); system.time(
serialize(matrix(0, i*1000, i*1000), NULL) )})
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
[1] 7
[1] 8
> matplot(t(x)/(1:8)^2)
> t(x)
       [,1]   [,2]   [,3] [,4] [,5]
[1,]  0.292  0.660  0.952    0    0
[2,]  1.368  2.492  3.861    0    0
[3,]  2.853  5.861  8.713    0    0
[4,]  5.016 10.540 15.555    0    0
[5,]  8.136 16.425 24.875    0    0
[6,] 11.481 23.926 35.427    0    0
[7,] 15.729 32.810 48.544    0    0
[8,] 20.998 43.218 64.839    0    0


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From luke at stat.uiowa.edu  Thu Jan 25 15:19:37 2007
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Thu, 25 Jan 2007 08:19:37 -0600 (CST)
Subject: [Rd] serialize() takes too long when serializing to a raw vector
In-Reply-To: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>
References: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>
Message-ID: <Pine.LNX.4.64.0701250816310.2832@itasca2.wildberry.org>

There was an error in the buffer allocation code that caused realloc
to be called far more often than needed; on systems where realloc is
slow this will cause problems.  Will be fixed shortly in R-devel and
R-patched.

Best,

luke

On Thu, 25 Jan 2007, Ashish Kulkarni wrote:

> Hin-Tak Leung wrote:
>>
>> It might be interesting to know get some details on your hardware.
>>
>
> It's a P4 2.66GHz with a standard Intel motherboard having 1GB RAM.
>
>> On my box, linux native seems to be a little slower than
>> your quick.serialize times:
>>
>> > system.time( serialize(matrix(0, 1000, 1000), NULL) )
>> [1] 0.372 0.288 0.692 0.000 0.000
>> > system.time( serialize(matrix(0, 2000, 2000), NULL) )
>> [1] 1.237 1.195 2.501 0.000 0.000
>>
>> running R 2.4.1 windows under wine (same box) is a good deal s
>> lower, but is not anywhere nearly as slow as yours.
>>
>> > system.time( serialize(matrix(0, 1000, 1000), NULL) )
>> [1] 0.00 0.00 6.08   NA   NA
>> > system.time( serialize(matrix(0, 2000, 2000), NULL) )
>> [1]  0.01  0.01 78.00    NA    NA
>> >
>>
>
> Well, the timings certainly differ quite a bit. What kind of
> hardware do you have? I suspect that most of the delay may be
> caused by memory reallocation since the size of the output
> raw array is not known up front. I would imagine that WINE
> would use the system memory allocator, not the one used by
> the windows kernel.
>
>> Since you mentioned that you are using Rmpi, there is a possibility
>> that you might be calling a different serialize() than base::serialize
>> all together???
>
> Nope, I hit this problem while using Rmpi and tracked it down
> to .mpi.serialize, which in turn calls base::serialize. From Rmpi:
>
> .mpi.serialize <- function (obj)
> {
>    trans_obj = serialize(obj, NULL)
>    if (getRversion() >= "2.4.0")
>        return(trans_obj)
>    else return(charToRaw(trans_obj))
> }
>
> Regards,
> ashish
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From murdoch at stats.uwo.ca  Thu Jan 25 15:21:41 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 25 Jan 2007 09:21:41 -0500
Subject: [Rd] serialize() takes too long when serializing to a raw vector
In-Reply-To: <2AB7346A3227A74BB97F9A0D79E3E65A090DB1@kalyptomail.dnsalias.com>
References: <2AB7346A3227A74BB97F9A0D79E3E65A090DB1@kalyptomail.dnsalias.com>
Message-ID: <45B8BCF5.6050509@stats.uwo.ca>

On 1/25/2007 6:32 AM, Ashish Kulkarni wrote:
> Hello,
> 
> R version 2.4.1 (2006-12-18) 
> i386-pc-mingw32
> 
> Calling serialize() with a NULL connection serializes it to a raw vector. However, when the object to be serialized is large, it takes a very long time:
> 
>> system.time( serialize(matrix(0, 1000, 1000), NULL) )
> [1] 38.25 40.73 81.54    NA    NA
> 
>> system.time( serialize(matrix(0, 2000, 2000), NULL) )
> [1]  609.72  664.75 1318.57      NA      NA
> 
> I was using this in Rmpi, where a clustered call returned a large matrix. However, serializing to a file or sockets is very fast for the very same matrix -- hence I wrote this function which runs much faster:
> 
> .mpi.quick.serialize <- function (object)
> {
>     fname <- tempfile("Rmpi")
>     stream <- file(fname, "wb")
>     on.exit({
>         close(stream)
>         file.remove(fname)
>     })
>     serialize(object, stream)
>     close(stream)
>     size <- file.info(fname)$size
>     stream <- file(fname, "rb")
>     return(readBin(stream, "raw", n = size))
> }
> 
>> system.time( .mpi.quick.serialize(matrix(0, 1000, 1000) ) )
> [1] 0.2500000000000000 0.0499999999999545 0.3000000000001819
> [4]                 NA                 NA
> 
>> system.time( .mpi.quick.serialize(matrix(0, 2000, 2000) ) )
> [1] 1.059999999999945 0.220000000000027 1.289999999999964
> [4]                NA                NA
> 
> Does anyone have an idea why the performance difference is so 
> large? Also, I was wondering if there is a better way -- the 
> above solution feels like a quick fix rather than a correct
> approach.

It looks like a bug in the serialize code:  it's reallocating the output 
buffer far too often, and that's slowing things down.  I'll confirm 
that's what's going on and fix it.

Duncan Murdoch


From ggrothendieck at gmail.com  Thu Jan 25 15:53:49 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 25 Jan 2007 09:53:49 -0500
Subject: [Rd] ?mean
Message-ID: <971536df0701250653y47f06f84h9cc24a297250e144@mail.gmail.com>

The help page for mean does not say what happens when one
applies mean to a matrix.

mean and sd work in an inconsistent way on a matrix
so that should at least be documented.

Also there should be a See Also to colMeans since that
provides the missing column-wise analog to sd.


From hin-tak.leung at cimr.cam.ac.uk  Thu Jan 25 16:25:43 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Thu, 25 Jan 2007 15:25:43 +0000
Subject: [Rd] serialize() takes too long when serializing to a raw vector
In-Reply-To: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>
References: <2AB7346A3227A74BB97F9A0D79E3E65A090DC9@kalyptomail.dnsalias.com>
Message-ID: <45B8CBF7.3010408@cimr.cam.ac.uk>

Ashish Kulkarni wrote:
> Hin-Tak Leung wrote:
>> It might be interesting to know get some details on your hardware.
>>
> 
> It's a P4 2.66GHz with a standard Intel motherboard having 1GB RAM.
> 
<snipped>

That figures - I am on an opteron 2.2GHz on x86_64 linux with the
same amount memory, and running R in 32-bit mode; so my numbers
are a bit lower than yours.

> Well, the timings certainly differ quite a bit. What kind of
> hardware do you have? I suspect that most of the delay may be
> caused by memory reallocation since the size of the output 
> raw array is not known up front. I would imagine that WINE 
> would use the system memory allocator, not the one used by 
> the windows kernel.
<snipped>

Yes, as others has replied about realloc(). Wine's msvcrt is
probaby some sort of wrapper around glibc's, and differs from how
genuine windows works in that regard.

HTL


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Thu Jan 25 17:05:34 2007
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (thomas.friedrichsmeier at ruhr-uni-bochum.de)
Date: Thu, 25 Jan 2007 17:05:34 +0100 (CET)
Subject: [Rd] Wish: C-API to get parse error messages (PR#9466)
Message-ID: <20070125160534.62EE74C904@slim.kubism.ku.dk>

Full_Name: Thomas Friedrichsmeier
Version: 2.4.1
OS: Linux
Submission from: (NULL) (84.61.205.78)


Currently, the C-API provides for parsing vectors (R_ParseVector()), but there
does not seem to be a way to get at the detailed parse error message from C.
Only a status code is returned, no error message.

In the internal code, the function parseError() is responsible for producing
such an error message. It would be very helpful, if this function could be made
available - directly or indirectly - in the public API. Some more background
information is available at
https://stat.ethz.ch/pipermail/r-devel/2007-January/044336.html.

Below are several alternative suggestions on different ways to add this:

1) Simply make parseError(SEXP call, int linenum) public API (currently not in
the public headers, and not visible in the library).

2) To hide the details of parseError(), instead a wrapper could be created and
made available like e.g.:
void Rf_parseErrorDefault()
{
    parseError(R_NilValue, 0);
}

3) It might be desirable to make parsing and producing the error an atomic
operation to embedding code, in order to guard against race conditions, if there
might be concurrent parses in the future. E.g. provide and export the
following:
SEXP R_ParseVectorWithError(SEXP exp, int num, ParseStatus *status, SEXP file)
{
    SEXP pr;
    pr = R_ParseVector(exp, num, status, file);
    if(status == PARSE_ERROR)
      parseError(R_NilValue, 0);
    return pr;
}

4) Finally, if this wish has any chance of being fulfilled until R 2.5.0,
production of a parse error could be made an additional parameter of
R_ParseVector() (since R_ParseVector() has already gained a new parameter since
2.4, so there would be no additional API breakage):
SEXP R_ParseVector(SEXP exp, int num, ParseStatus *status, SEXP file, Rboolean
doerror);

Regards
Thomas Friedrichsmeier


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Thu Jan 25 17:26:39 2007
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (thomas.friedrichsmeier at ruhr-uni-bochum.de)
Date: Thu, 25 Jan 2007 17:26:39 +0100 (CET)
Subject: [Rd] Wish: C-API to print if R_Visible is TRUE (PR#9467)
Message-ID: <20070125162639.6F59B4C912@slim.kubism.ku.dk>

Full_Name: Thomas Friedrichsmeier
Version: 2.4.1
OS: Linux
Submission from: (NULL) (84.61.205.78)


Frontends wishing to emulate an R console typically want to print the value of
an evaluation, if and only if R_Visible is TRUE. R_Visible has never been part
of the public API (at least not as far as I looked back). In current SVN it is
also hidden from the library. The new R function withVisible() in current SVN
addresses the same issue, but is not easily usable from C (for a more detailed
discussion, see https://stat.ethz.ch/pipermail/r-devel/2007-January/044336.html).

Two alternative suggestions:
1) Make R_Visible part of the public API, or at least make it an exported symbol
again (so the daring can declare it extern and link against it).

2) It might be both cleaner and more convenient for API users to add something
like the following function, instead:
Rboolean Rf_doAutoPrint(SEXP exp, Rboolean forceprint)
{
        if(R_Visible || forceprint) {
            printValueEnv(exp, R_GlobalEnv);
            return TRUE;                /* was printed */
        }
        return FALSE;
}

Regards
Thomas Friedrichsmeier


From Stephen.Pope at ubs.com  Thu Jan 25 17:33:45 2007
From: Stephen.Pope at ubs.com (Stephen Pope)
Date: Thu, 25 Jan 2007 09:33:45 -0700
Subject: [Rd] "rep" missing from methods:::.BasicFunsList
Message-ID: <45B8DBE9.2040802@ubs.com>


With:

R version 2.4.1 Patched (2007-01-22 r40548)

"rep" is missing from methods:::.BasicFunsList, causing 
methods:::genericForPrimitive("rep") to fail, which in turn causes 
setMethod("rep", ...) to fail. (setGeneric("rep") of course fails as it 
should, saying that rep is a primitive and methods can be set).

Here's the fix:

build_main at mambo:/vobs/products/R> gdiff -ub 
src/library/methods/R/BasicFunsList.R@@/main/LATEST 
src/library/methods/R/BasicFunsList.R
--- src/library/methods/R/BasicFunsList.R@@/main/LATEST Tue Jan 23 
22:55:28 2007
+++ src/library/methods/R/BasicFunsList.R       Wed Jan 24 23:56:32 2007
@@ -116,6 +116,10 @@
 }
 , "missing" = FALSE
 , "on.exit" = FALSE
+, "rep" = function(x, ...)
+{
+    standardGeneric("rep")
+}
 , "substitute" = FALSE
 , "symbol.C" = FALSE
 , "symbol.For" = FALSE




Visit our website at http://www.ubs.com

This message contains confidential information and is intend...{{dropped}}


From maechler at stat.math.ethz.ch  Thu Jan 25 17:48:32 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 25 Jan 2007 17:48:32 +0100
Subject: [Rd] ?mean
In-Reply-To: <971536df0701250653y47f06f84h9cc24a297250e144@mail.gmail.com>
References: <971536df0701250653y47f06f84h9cc24a297250e144@mail.gmail.com>
Message-ID: <17848.57184.404781.602759@stat.math.ethz.ch>

>>>>> "Gabor" == Gabor Grothendieck <ggrothendieck at gmail.com>
>>>>>     on Thu, 25 Jan 2007 09:53:49 -0500 writes:

    Gabor> The help page for mean does not say what happens when one
    Gabor> applies mean to a matrix.

    Gabor> mean and sd work in an inconsistent way on a matrix
    Gabor> so that should at least be documented.

You are right (though I think this *was* documented at some
point in time).

As a matter of fact, I hate the the inconsistencies you've
been mentioning, and I think is very wrong from an S-pedagogical
point of view.... both 
that    sd(mat)  :<==> apply(mat, 2, sd)
and   mean(dfr)  :<==> apply(dfr, 2, mean)
  
and it leads just to wrong ``analogy conclusions'' by useRs.

I'd vote for deprecating these ``builtin conveniences''
in order to gain consistency and clarity...

Though I haven't checked how many CRAN + Bioconductor packages
would break if we'd disactivate these two mis-features ...

Martin

    Gabor> Also there should be a See Also to colMeans since that
    Gabor> provides the missing column-wise analog to sd.


From ggrothendieck at gmail.com  Fri Jan 26 02:00:07 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 25 Jan 2007 20:00:07 -0500
Subject: [Rd] Rscript on Windows with R 2.5.0 dev
Message-ID: <971536df0701251700w22daef70ic0c68f8fecdf9e3f@mail.gmail.com>

On Windows XP with
R version 2.5.0 Under development (unstable) (2007-01-22 r40548)

I always get a message about grdevices when I run Rscript, e.g.

C:\> rscript NUL
During startup - Warning messages:
1: there is no package called 'grdevices' in: library(package, lib.loc = lib.loc
, character.only = TRUE, logical = TRUE,
2: package grdevices in options("defaultPackages") was not found


From hb at stat.berkeley.edu  Fri Jan 26 02:35:15 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 25 Jan 2007 17:35:15 -0800
Subject: [Rd] Inferring dimensions on bitmap device from par()
Message-ID: <59d7961d0701251735i5f71f989g8c16704e7605d799@mail.gmail.com>

Hi,

I am trying to infer the dimension of an opened bitmap (png, jpeg,
bitmap device...) from par() parmeters.  From the help on par(), I
found that:

> dim <- c(400, 200)
> png("foo.png", width=dim[1], height=dim[2])
> dim2 <- par("din") * par("cra") / par("cin")
> dev.off()
> dim2
[1] 399.9999 199.9999

I've tried the above on Rv2.4.1 on WinXP and Linux with png() and
jpeg() and the precision is good enough.  However, when I turn to the
bitmap() device, I found the following:

> s <- 3;  # Multiple of 72pt (default value of argument 'res' of bitmap())
> res <- s*72;
> bitmap("foo.png", width=dim[1]/res, height=dim[2]/res, res=res)
> dim2 <- par("din") * par("cra") / par("cin")
> dev.off()
> dim/dim2
[1] 3 3

That is, dim/dim2 is not one, but equal to the multiple 's'.   I
understand that this is because bitmap() is not a device per se and
utilized postscript() plus a call to ghostscript.  But still, does
anyone know if it is possible to infer the correct resolution

 res2 <- s * par("cra") / par("cin")

(or ultimately the dimension of the generated plot in pixels) without
know which of png(), jpeg() or bitmap() was used?  I know of
par("ps"), but its "unit" is device specific.

Thanks

Henrik


From ggrothendieck at gmail.com  Fri Jan 26 05:58:51 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 25 Jan 2007 23:58:51 -0500
Subject: [Rd] Rscript on Windows
Message-ID: <971536df0701252058i739700dx8f7e02f8be48bf4e@mail.gmail.com>

On UNIX one can use #! notation.  It would be nice to be able to do something
similar on Windows.

This could be done by giving Rscript the capability of skipping over
the first few
lines.  For example, there might be a --skip=n argument or perhaps Rscript would
skip over any consecutive leading lines that begin with @ in the R
file since that
cannot be syntactically correct R but does  have meaning to Windows batch,
namely, it means do not display the line beginning with @ (but still run it).
For example, if we implement the @ idea then a sample 3 line file
called grep.bat might look like this:

  @Rscript grep.bat %1
   for(L in grep(commandArgs(TRUE), readLines(file("stdin")), value = TRUE))
      cat(L, "\n", sep = "")

and then we would run it as a Windows batch file like this from the
Windows console to find all lines with the word target:

   grep target < myfile.txt

or if we implemented --skip it might look like this:

  @Rscript --skip=1 grep.bat %1
   for(L in grep(commandArgs(TRUE), readLines(file("stdin")), value = TRUE))
      cat(L, "\n", sep = "")


From ggrothendieck at gmail.com  Fri Jan 26 06:43:51 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 26 Jan 2007 00:43:51 -0500
Subject: [Rd] ?mean
In-Reply-To: <20070126112826.7fd9b170@berwin5>
References: <971536df0701250653y47f06f84h9cc24a297250e144@mail.gmail.com>
	<20070126112826.7fd9b170@berwin5>
Message-ID: <971536df0701252143k3e70fc78wabd801aa9b46180@mail.gmail.com>

Good point.  Perhaps what is needed is a Note clarifying all this in ?mean
(unless the software itself is reworked as Martin has discussed).

Regarding var(x), one could use sd(x)^2.

On 1/25/07, Berwin A Turlach <statba at nus.edu.sg> wrote:
> G'day Gabor,
>
> On Thu, 25 Jan 2007 09:53:49 -0500
> "Gabor Grothendieck" <ggrothendieck at gmail.com> wrote:
>
> > The help page for mean does not say what happens when one
> > applies mean to a matrix.
>
> Well, not directly.  :-)
>
> But the help page of mean says that one of the arguments is:
>
>       x: An R object.  Currently there are methods for numeric data
>          frames, numeric vectors and dates.  A complex vector is
>          allowed for 'trim = 0', only.
>
> And the `Value' section states:
>
>     For a data frame, a named vector with the appropriate method being
>     applied column by column.
>
>     If 'trim' is zero (the default), the arithmetic mean of the values
>     in 'x' is computed, as a numeric or complex vector of length one.
>     If any argument is not logical (coerced to numeric), integer,
>     numeric or complex, 'NA' is returned, with a warning.
>
> Since a matrix is a vector with a dimension attribute, and not a data
> frame, one can deduce that the second paragraph describes the return
> value for `mean(x)' when x is a matrix.
>
> As I always tell my students, reading R help pages is a bit of an
> art. :)
>
> > mean and sd work in an inconsistent way on a matrix so that should at
> > least be documented.
>
> Agreed.  But it is documented in the help page of sd, which clearly
> states:
>
>     [....] If 'x' is a matrix or a data frame, a vector
>     of the standard deviation of the columns is returned.
>
> I guess you also want to have it documented in the mean help page?
>
> But then, should `var' also be mentioned in the mean help page?  This
> command also work in an a different and inconsistent manner to mean on
> matrices.
>
> And, of course, there are other subtle inconsistencies in the language
> used in these help pages.  Note that the mean help page talks about
> "numeric data frames" while the help pages of `var' and `se' talk about
> "data frames" only, though all components of the data frame have to be
> numeric, of course.
>
> > Also there should be a See Also to colMeans since that provides the
> > missing column-wise analog to sd.
>
> That's probably a good idea.  What would you suggest should be
> mentioned to provide the column-wise analog of `var'?
>
> Cheers,
>
>        Berwin
>


From ripley at stats.ox.ac.uk  Fri Jan 26 07:40:09 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Jan 2007 06:40:09 +0000 (GMT)
Subject: [Rd] Inferring dimensions on bitmap device from par()
In-Reply-To: <59d7961d0701251735i5f71f989g8c16704e7605d799@mail.gmail.com>
References: <59d7961d0701251735i5f71f989g8c16704e7605d799@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701260605490.24309@gannet.stats.ox.ac.uk>

You asked

> (or ultimately the dimension of the generated plot in pixels) without
> know which of png(), jpeg() or bitmap() was used?

That is determined by arguments 'width' and 'height' in the call to the 
device, and for the first two it is in pixels and for the third it is in 
inches.  Internally these are just numbers, and in particular the R 
graphics system does not know the resolution to be used in pixelization. 
Since some graphics parameters assume 'inches' and some 'pixels', 
assumptions have to be made.  png() assumes 96dpi and postscript() assumes 
72dpi.

You had the information you asked for, so why not just use it?
R is not claiming to be your keeper.

On Thu, 25 Jan 2007, Henrik Bengtsson wrote:

> Hi,
>
> I am trying to infer the dimension of an opened bitmap (png, jpeg,
> bitmap device...) from par() parmeters.  From the help on par(), I
> found that:
>
>> dim <- c(400, 200)
>> png("foo.png", width=dim[1], height=dim[2])
>> dim2 <- par("din") * par("cra") / par("cin")
>> dev.off()
>> dim2
> [1] 399.9999 199.9999
>
> I've tried the above on Rv2.4.1 on WinXP and Linux with png() and
> jpeg() and the precision is good enough.  However, when I turn to the
> bitmap() device, I found the following:
>
>> s <- 3;  # Multiple of 72pt (default value of argument 'res' of bitmap())
>> res <- s*72;
>> bitmap("foo.png", width=dim[1]/res, height=dim[2]/res, res=res)
>> dim2 <- par("din") * par("cra") / par("cin")
>> dev.off()
>> dim/dim2
> [1] 3 3
>
> That is, dim/dim2 is not one, but equal to the multiple 's'.   I
> understand that this is because bitmap() is not a device per se and
> utilized postscript() plus a call to ghostscript.  But still, does
> anyone know if it is possible to infer the correct resolution
>
> res2 <- s * par("cra") / par("cin")
>
> (or ultimately the dimension of the generated plot in pixels) without
> know which of png(), jpeg() or bitmap() was used?  I know of
> par("ps"), but its "unit" is device specific.
>
> Thanks
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hb at stat.berkeley.edu  Fri Jan 26 09:01:02 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Fri, 26 Jan 2007 00:01:02 -0800
Subject: [Rd] Inferring dimensions on bitmap device from par()
In-Reply-To: <Pine.LNX.4.64.0701260605490.24309@gannet.stats.ox.ac.uk>
References: <59d7961d0701251735i5f71f989g8c16704e7605d799@mail.gmail.com>
	<Pine.LNX.4.64.0701260605490.24309@gannet.stats.ox.ac.uk>
Message-ID: <59d7961d0701260001p416e9c4nc7aec6fdcb3effc0@mail.gmail.com>

On 1/25/07, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> You asked
>
> > (or ultimately the dimension of the generated plot in pixels) without
> > know which of png(), jpeg() or bitmap() was used?
>
> That is determined by arguments 'width' and 'height' in the call to the
> device, and for the first two it is in pixels and for the third it is in
> inches.  Internally these are just numbers, and in particular the R
> graphics system does not know the resolution to be used in pixelization.
> Since some graphics parameters assume 'inches' and some 'pixels',
> assumptions have to be made.  png() assumes 96dpi and postscript() assumes
> 72dpi.

Thanks. That is useful to know.

>
> You had the information you asked for, so why not just use it?

The function plotting does not know about the device, and I want to be
able to keep fixed-sized margins in the output (assuming bitmap
images).

> R is not claiming to be your keeper.

That is one of the answers I expected and wanted to hear given that it
was the case.

/Henrik

>
> On Thu, 25 Jan 2007, Henrik Bengtsson wrote:
>
> > Hi,
> >
> > I am trying to infer the dimension of an opened bitmap (png, jpeg,
> > bitmap device...) from par() parmeters.  From the help on par(), I
> > found that:
> >
> >> dim <- c(400, 200)
> >> png("foo.png", width=dim[1], height=dim[2])
> >> dim2 <- par("din") * par("cra") / par("cin")
> >> dev.off()
> >> dim2
> > [1] 399.9999 199.9999
> >
> > I've tried the above on Rv2.4.1 on WinXP and Linux with png() and
> > jpeg() and the precision is good enough.  However, when I turn to the
> > bitmap() device, I found the following:
> >
> >> s <- 3;  # Multiple of 72pt (default value of argument 'res' of bitmap())
> >> res <- s*72;
> >> bitmap("foo.png", width=dim[1]/res, height=dim[2]/res, res=res)
> >> dim2 <- par("din") * par("cra") / par("cin")
> >> dev.off()
> >> dim/dim2
> > [1] 3 3
> >
> > That is, dim/dim2 is not one, but equal to the multiple 's'.   I
> > understand that this is because bitmap() is not a device per se and
> > utilized postscript() plus a call to ghostscript.  But still, does
> > anyone know if it is possible to infer the correct resolution
> >
> > res2 <- s * par("cra") / par("cin")
> >
> > (or ultimately the dimension of the generated plot in pixels) without
> > know which of png(), jpeg() or bitmap() was used?  I know of
> > par("ps"), but its "unit" is device specific.
> >
> > Thanks
> >
> > Henrik
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From statba at nus.edu.sg  Fri Jan 26 04:28:26 2007
From: statba at nus.edu.sg (Berwin A Turlach)
Date: Fri, 26 Jan 2007 11:28:26 +0800
Subject: [Rd] ?mean
In-Reply-To: <971536df0701250653y47f06f84h9cc24a297250e144@mail.gmail.com>
References: <971536df0701250653y47f06f84h9cc24a297250e144@mail.gmail.com>
Message-ID: <20070126112826.7fd9b170@berwin5>

G'day Gabor,

On Thu, 25 Jan 2007 09:53:49 -0500
"Gabor Grothendieck" <ggrothendieck at gmail.com> wrote:

> The help page for mean does not say what happens when one
> applies mean to a matrix.

Well, not directly.  :-)

But the help page of mean says that one of the arguments is:

       x: An R object.  Currently there are methods for numeric data
          frames, numeric vectors and dates.  A complex vector is
          allowed for 'trim = 0', only.

And the `Value' section states:
 
     For a data frame, a named vector with the appropriate method being
     applied column by column.

     If 'trim' is zero (the default), the arithmetic mean of the values
     in 'x' is computed, as a numeric or complex vector of length one. 
     If any argument is not logical (coerced to numeric), integer,
     numeric or complex, 'NA' is returned, with a warning.

Since a matrix is a vector with a dimension attribute, and not a data
frame, one can deduce that the second paragraph describes the return
value for `mean(x)' when x is a matrix.

As I always tell my students, reading R help pages is a bit of an
art. :)

> mean and sd work in an inconsistent way on a matrix so that should at
> least be documented. 

Agreed.  But it is documented in the help page of sd, which clearly
states:

     [....] If 'x' is a matrix or a data frame, a vector
     of the standard deviation of the columns is returned.

I guess you also want to have it documented in the mean help page?  

But then, should `var' also be mentioned in the mean help page?  This
command also work in an a different and inconsistent manner to mean on
matrices.

And, of course, there are other subtle inconsistencies in the language
used in these help pages.  Note that the mean help page talks about
"numeric data frames" while the help pages of `var' and `se' talk about
"data frames" only, though all components of the data frame have to be
numeric, of course.

> Also there should be a See Also to colMeans since that provides the
> missing column-wise analog to sd.

That's probably a good idea.  What would you suggest should be
mentioned to provide the column-wise analog of `var'?

Cheers,

	Berwin


From deleeuw at cuddyvalley.org  Fri Jan 26 03:27:27 2007
From: deleeuw at cuddyvalley.org (Jan de Leeuw)
Date: Thu, 25 Jan 2007 18:27:27 -0800
Subject: [Rd] i may have missed something ..
Message-ID: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>

but deriv() and friends do not work in R-devel (at least
not on the Mac).
==========================================================
Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
home 661-245-1725 skype 661-347-0667 global 254-381-4905
.mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw
==========================================================
  
                      
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dodo2-1.pdf
Type: application/pdf
Size: 12296 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20070125/a36018f8/attachment.pdf 
-------------- next part --------------



From ripley at stats.ox.ac.uk  Fri Jan 26 09:54:50 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Jan 2007 08:54:50 +0000 (GMT)
Subject: [Rd] i may have missed something ..
In-Reply-To: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
Message-ID: <Pine.LNX.4.64.0701260853410.2972@auk.stats>

On Thu, 25 Jan 2007, Jan de Leeuw wrote:

> but deriv() and friends do not work in R-devel (at least
> not on the Mac).

They work for me under Linux and Windows.  What does example(deriv) give 
you?

> ==========================================================
> Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
> home 661-245-1725 skype 661-347-0667 global 254-381-4905
> .mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw
> ==========================================================
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From volchik2000 at list.ru  Fri Jan 26 10:19:52 2007
From: volchik2000 at list.ru (=?koi8-r?Q?=D2=CF=D7=C5=CE_=E1=CB=D8=C1=D4=CF=C9?=)
Date: Fri, 26 Jan 2007 12:19:52 +0300
Subject: [Rd] Using Windows API functions in R
Message-ID: <E1HANFQ-000LJu-00.volchik2000-list-ru@f71.mail.ru>

Somehow autofilter doesn't allow this message to be posted,
will try another time. 

-----Original Message-----
From: Yuri Volchik <volchik2000 at list.ru>
To: r-devel at r-project.org
Date: Thu, 25 Jan 2007 22:27:13 +0000
Subject: Using Windows API functions in R

> 
> Hi to all.
> 
> In programming one application i have to "press" button to have
> application started, which i would like to do automatically from R.
> To do that i want to use library "user32" function "SendInput"
> 
> http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/sendinput.asp
> 
> So far i managed to write the following
> 
> system(shQuote("C:/Program Files/1.exe"),wait=F)
> system32 <- file.path(Sys.getenv("windir"),"system32")
> user32 <- file.path(system32,"user32.dll")
> dyn.load(user32)
> .C("SendInput",..)
> 
> And now i'm at loss how to represent the data structure needed for
> correct call to that function, may be somebody could help me with
> this?
> 
> Thanks
> 
> -- 
> Best regards,
>  Yuri                          mailto:volchik2000 at list.ru
> 
> 
>


From ripley at stats.ox.ac.uk  Fri Jan 26 10:59:05 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Jan 2007 09:59:05 +0000 (GMT)
Subject: [Rd] Using Windows API functions in R
In-Reply-To: <E1HANFQ-000LJu-00.volchik2000-list-ru@f71.mail.ru>
References: <E1HANFQ-000LJu-00.volchik2000-list-ru@f71.mail.ru>
Message-ID: <Pine.LNX.4.64.0701260951370.13178@gannet.stats.ox.ac.uk>

On Fri, 26 Jan 2007, ????? ??????? wrote:

> Somehow autofilter doesn't allow this message to be posted,
> will try another time.
>
> -----Original Message-----
> From: Yuri Volchik <volchik2000 at list.ru>
> To: r-devel at r-project.org
> Date: Thu, 25 Jan 2007 22:27:13 +0000
> Subject: Using Windows API functions in R
>
>>
>> Hi to all.
>>
>> In programming one application i have to "press" button to have
>> application started, which i would like to do automatically from R.
>> To do that i want to use library "user32" function "SendInput"
>>
>> http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/sendinput.asp
>>
>> So far i managed to write the following
>>
>> system(shQuote("C:/Program Files/1.exe"),wait=F)
>> system32 <- file.path(Sys.getenv("windir"),"system32")
>> user32 <- file.path(system32,"user32.dll")
>> dyn.load(user32)
>> .C("SendInput",..)

You cannot make use of WINAPI calls from .C (or otherwise in R): it is set
up for _cdecl calls only.

You will need to write some wrapper C code.

>> And now i'm at loss how to represent the data structure needed for
>> correct call to that function, may be somebody could help me with
>> this?

You cannot create C structures using .C, only a few basic array types. 
See ?".C" .  Since you need wrapper code, you can create the structures 
needed there.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rough989 at gmail.com  Fri Jan 26 11:30:36 2007
From: rough989 at gmail.com (Stefano Mazzuco)
Date: Fri, 26 Jan 2007 11:30:36 +0100
Subject: [Rd] double integral with C code
Message-ID: <45B9D84C.5080904@gmail.com>

Hi all,
This is more a C querie rather than a R one:
I'm writing a C code passing a function F to adapt fortran subroutine. I
need to integrate over two variables of F, call them x1 and x2. Then I
call the C code in R to optimize the integrated F function.
for example F could be defined as
---------------------------------------
static double marg_like(const double *param,
            double x1,
            double x2){...........}
---------------------------------------
Then I integrate over x1 and x2 with
-------------------------------------------------
F77_CALL(adapt)(2,(-5,-5),(5,5),100,1700,F,0.01,10000)
-------------------------------------------------

So here my question: I should I define x1 and x2? For the time being I
defined them as static variables, i.e.
static double x1;
static double x2;

but I'm pretty sure this is wrong

Any hint?
thanks in advance
Stefano

P.S. Sorry for having posted this in the R-help section, was an unintended mistake.


From jon.clayden at gmail.com  Fri Jan 26 12:25:00 2007
From: jon.clayden at gmail.com (Jon Clayden)
Date: Fri, 26 Jan 2007 11:25:00 +0000
Subject: [Rd] readBin is much slower for raw input than for a file
Message-ID: <68e086180701260325m58269f70w6bfd583c4e9c5aa3@mail.gmail.com>

Dear all,

I'm trying to write an efficient binary file reader for a file type
that is made up of several fields of variable length, and so requires
many small reads. Doing this on the file directly using a sequence of
readBin() calls is a bit too slow for my needs, so I tried buffering
the file into a raw vector and reading from that ("loc" is the
equivalent of the file pointer):

fileSize <- file.info(fileName)$size
connection <- file(fileName, "rb")
bytes <- readBin(connection, "raw", n=fileSize)
loc <- 0
close(connection)

--

# within a custom read function:
if (loc == 0)
    data <- readBin(bytes, what, n, size, ...)
else if (loc > 0)
    data <- readBin(bytes[-(1:loc)], what, n, size, ...)

However, this method runs almost 10 times slower for me than the
sequence of file reads did. The initial call to readBin() - for
reading in the file - is very quick, but running Rprof shows that the
vast majority of the run time in doing the full parse is spent in
readBin, so it does seem to be that that's slowing things down. Can
anyone shed any light on why this is?

I'm not expecting miracles here - and I realise that writing the whole
read routine in C would be much quicker - but surely reading from a
raw vector should work out faster than reading from a file? The system
is R-2.4.1/Linux, Xeon 3.2 GHz, 2 GiB RAM; typical file size is 44
KiB.

Thanks in advance,
Jon


From volchik2000 at list.ru  Fri Jan 26 13:53:08 2007
From: volchik2000 at list.ru (=?koi8-r?Q?=D2=CF=D7=C5=CE_=E1=CB=D8=C1=D4=CF=C9?=)
Date: Fri, 26 Jan 2007 15:53:08 +0300
Subject: [Rd] =?koi8-r?b?VXNpbmcgV2luZG93cyBBUEkgZnVuY3Rpb25zIGluIFI=?=
In-Reply-To: <Pine.LNX.4.64.0701260951370.13178@gannet.stats.ox.ac.uk>
References: <Pine.LNX.4.64.0701260951370.13178@gannet.stats.ox.ac.uk>
Message-ID: <E1HAQZo-000Eix-00.volchik2000-list-ru@f19.mail.ru>

Thanks Professor,

will try to create a wrapper needed to call WIN API functions.

> 
> You cannot make use of WINAPI calls from .C (or otherwise in R): it is set
> up for _cdecl calls only.
> 
> You will need to write some wrapper C code.
> 
> >> And now i'm at loss how to represent the data structure needed for
> >> correct call to that function, may be somebody could help me with
> >> this?
> 
> You cannot create C structures using .C, only a few basic array types. 
> See ?".C" .  Since you need wrapper code, you can create the structures 
> needed there.
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk

Best regards,
Yuri Volchik


From timb at metrumrg.com  Fri Jan 26 14:41:45 2007
From: timb at metrumrg.com (Tim Bergsma)
Date: Fri, 26 Jan 2007 08:41:45 -0500
Subject: [Rd] how to properly extend s3 data.frames with s4 classes?
Message-ID: <45BA0519.2020904@metrumrg.com>

Dear Ulf Martin,

Thank you for your thoughtful analysis regarding the use of S3 data 
frames in S4.  I asked the same question (in a more rudimentary manner) 
on the r-help list on 30 Nov 2006 and 04 Dec 2006.  There were no 
replies.  If you find a solution, please post.

Best Regards,

Tim Bergsma, PhD

Date: Wed, 24 Jan 2007 12:28:46 +0100
From: Ulf Martin <ulfmartin at web.de>
Subject: [Rd] how to properly extend s3 data.frames with s4 classes?
To: R-devel mailing list <r-devel at r-project.org>
Message-ID: <45B742EE.4050905 at web.de>
Content-Type: text/plain; charset=ISO-8859-15; format=flowed

Dear R Programmers!

After some time of using R I decided to work through John Chambers book
"Programming with Data" to learn what these S4 classes are all about and
how they work in R. (I regret not having picked up this rather fine book
earlier!)

I know from the documentation and the mailing archives that S4 in R is
not 100% the book and that there are issues especially with dataframes,
but to my knowledge the following has not been reported yet.


Summary...


From wl2776 at gmail.com  Fri Jan 26 15:31:43 2007
From: wl2776 at gmail.com (Vladimir Eremeev)
Date: Fri, 26 Jan 2007 06:31:43 -0800 (PST)
Subject: [Rd] Rscript on Windows
In-Reply-To: <971536df0701252058i739700dx8f7e02f8be48bf4e@mail.gmail.com>
References: <971536df0701252058i739700dx8f7e02f8be48bf4e@mail.gmail.com>
Message-ID: <8651815.post@talk.nabble.com>


ActivePerl has '-x' switch which tells it to skip all lines in the file till
"#!".
This allows writing perl scripts in ordinary .bat files.

?shQuote contains a link with the following perl script example:
===8<===
@echo off
:: hello.bat
:: Windows executable Perl script
:: Note:
::   assumes perl.exe is in path
::   otherwise, use absolute path
perl -x -S "%0" %*
goto end
#!perl

print "Hello, World!\n";
__END__
:end
:: ------ end of hello.bat ------

Windows Notes: 
" -x " (lower case x): Skip all text until shebang line. 
" -S " (upper case S): Look for script using PATH variable. Special meaning
in Windows: appends .bat or .cmd if lookup for name fails and name does not
have either suffix. 
" %* " only on WinNT/2K/XP; use %1 %2 . . . %9 on Win9x/DOS 
===8<===

I think the simplest way to implement shebang on windows would be embedding
one more command line switch with similar functionality to perl's '-x'.

-- 
View this message in context: http://www.nabble.com/Rscript-on-Windows-tf3120774.html#a8651815
Sent from the R devel mailing list archive at Nabble.com.


From ggrothendieck at gmail.com  Fri Jan 26 15:45:47 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 26 Jan 2007 09:45:47 -0500
Subject: [Rd] Rscript on Windows
In-Reply-To: <8651815.post@talk.nabble.com>
References: <971536df0701252058i739700dx8f7e02f8be48bf4e@mail.gmail.com>
	<8651815.post@talk.nabble.com>
Message-ID: <971536df0701260645p68852335n21812456a52733e8@mail.gmail.com>

Good idea.  ruby seems to work the same way.  python does too but with
a slightly different definition:

C:\> ruby -h | findstr strip
  -x[directory]   strip off text before #!ruby line and perhaps cd to directory

C:\> perl -h | findstr strip
  -x[directory]   strip off text before #!perl line and perhaps cd to directory

C:\> python -h | findstr skip
-x     : skip first line of source, allowing use of non-Unix forms of #!cmd


On 1/26/07, Vladimir Eremeev <wl2776 at gmail.com> wrote:
>
> ActivePerl has '-x' switch which tells it to skip all lines in the file till
> "#!".
> This allows writing perl scripts in ordinary .bat files.
>
> ?shQuote contains a link with the following perl script example:
> ===8<===
> @echo off
> :: hello.bat
> :: Windows executable Perl script
> :: Note:
> ::   assumes perl.exe is in path
> ::   otherwise, use absolute path
> perl -x -S "%0" %*
> goto end
> #!perl
>
> print "Hello, World!\n";
> __END__
> :end
> :: ------ end of hello.bat ------
>
> Windows Notes:
> " -x " (lower case x): Skip all text until shebang line.
> " -S " (upper case S): Look for script using PATH variable. Special meaning
> in Windows: appends .bat or .cmd if lookup for name fails and name does not
> have either suffix.
> " %* " only on WinNT/2K/XP; use %1 %2 . . . %9 on Win9x/DOS
> ===8<===
>
> I think the simplest way to implement shebang on windows would be embedding
> one more command line switch with similar functionality to perl's '-x'.
>
> --
> View this message in context: http://www.nabble.com/Rscript-on-Windows-tf3120774.html#a8651815
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From deleeuw at cuddyvalley.org  Fri Jan 26 16:35:39 2007
From: deleeuw at cuddyvalley.org (Jan de Leeuw)
Date: Fri, 26 Jan 2007 07:35:39 -0800
Subject: [Rd] i may have missed something ..
In-Reply-To: <Pine.LNX.4.64.0701260853410.2972@auk.stats>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
	<Pine.LNX.4.64.0701260853410.2972@auk.stats>
Message-ID: <A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>

This is R revision 40576 compiled with icc/ifort
on OS X 10.4.9 (8P2122). It may be the compiler.

-- J.

 > example(deriv)

deriv> ## formula argument :
deriv> dx2x <- deriv(~ x^2, "x") ; dx2x
expression({
     .value <- x^2
     .grad <- array(0, c(length(.value), 1), list(NULL, c("x")))
     .grad[, "x"] <- 0
     attr(.value, "gradient") <- .grad
     .value
})

deriv> ## Not run:
deriv> ##D expression({
deriv> ##D          .value <- x^2
deriv> ##D          .grad <- array(0, c(length(.value), 1), list 
(NULL, c("x")))
deriv> ##D          .grad[, "x"] <- 2 * x
deriv> ##D          attr(.value, "gradient") <- .grad
deriv> ##D          .value
deriv> ##D })
deriv> ## End(Not run)
deriv> mode(dx2x)
[1] "expression"

deriv> x <- -1:2

deriv> eval(dx2x)
[1] 1 0 1 4
attr(,"gradient")
      x
[1,] 0
[2,] 0
[3,] 0
[4,] 0

deriv> ## Something 'tougher':
deriv> trig.exp <- expression(sin(cos(x + y^2)))

deriv> ( D.sc <- D(trig.exp, "x") )
[1] 0

deriv> all.equal(D(trig.exp[[1]], "x"), D.sc)
[1] TRUE

deriv> ( dxy <- deriv(trig.exp, c("x", "y")) )
expression({
     .value <- sin(cos(x + y^2))
     .grad <- array(0, c(length(.value), 2), list(NULL, c("x",
         "y")))
     .grad[, "x"] <- 0
     .grad[, "y"] <- 0
     attr(.value, "gradient") <- .grad
     .value
})

deriv> y <- 1

deriv> eval(dxy)
[1]  0.8414710  0.5143953 -0.4042392 -0.8360219
attr(,"gradient")
      x y
[1,] 0 0
[2,] 0 0
[3,] 0 0
[4,] 0 0

deriv> eval(D.sc)
[1] 0

deriv> ## function returned:
deriv> deriv((y ~ sin(cos(x) * y)), c("x","y"), func = TRUE)
function (x, y)
{
     .value <- sin(cos(x) * y)
     .grad <- array(0, c(length(.value), 2), list(NULL, c("x",
         "y")))
     .grad[, "x"] <- 0
     .grad[, "y"] <- 0
     attr(.value, "gradient") <- .grad
     .value
}

deriv> ## function with defaulted arguments:
deriv> (fx <- deriv(y ~ b0 + b1 * 2^(-x/th), c("b0", "b1", "th"),
deriv+              function(b0, b1, th, x = 1:7){} ) )
function (b0, b1, th, x = 1:7)
{
     .value <- b0 + b1 * 2^(-x/th)
     .grad <- array(0, c(length(.value), 3), list(NULL, c("b0",
         "b1", "th")))
     .grad[, "b0"] <- 1
     .grad[, "b1"] <- 0
     .grad[, "th"] <- 0
     attr(.value, "gradient") <- .grad
     .value
}

deriv> fx(2,3,4)
[1] 4.522689 4.121320 3.783811 3.500000 3.261345 3.060660 2.891905
attr(,"gradient")
      b0 b1 th
[1,]  1  0  0
[2,]  1  0  0
[3,]  1  0  0
[4,]  1  0  0
[5,]  1  0  0
[6,]  1  0  0
[7,]  1  0  0

deriv> ## Higher derivatives
deriv> deriv3(y ~ b0 + b1 * 2^(-x/th), c("b0", "b1", "th"),
deriv+      c("b0", "b1", "th", "x") )
function (b0, b1, th, x)
{
     .value <- b0 + b1 * 2^(-x/th)
     .grad <- array(0, c(length(.value), 3), list(NULL, c("b0",
         "b1", "th")))
     .hessian <- array(0, c(length(.value), 3, 3), list(NULL,
         c("b0", "b1", "th"), c("b0", "b1", "th")))
     .grad[, "b0"] <- 1
     .grad[, "b1"] <- 0
     .grad[, "th"] <- 0
     attr(.value, "gradient") <- .grad
     attr(.value, "hessian") <- .hessian
     .value
}

deriv> ## Higher derivatives:
deriv> DD <- function(expr,name, order = 1) {
deriv+    if(order < 1) stop("'order' must be >= 1")
deriv+    if(order == 1) D(expr,name)
deriv+    else DD(D(expr, name), name, order - 1)
deriv+ }

deriv> DD(expression(sin(x^2)), "x", 3)
[1] 0
 >

On Jan 26, 2007, at 00:54 , Prof Brian Ripley wrote:

> On Thu, 25 Jan 2007, Jan de Leeuw wrote:
>
>> but deriv() and friends do not work in R-devel (at least
>> not on the Mac).
>
> They work for me under Linux and Windows.  What does example(deriv)  
> give you?
>
>> ==========================================================
>> Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
>> home 661-245-1725 skype 661-347-0667 global 254-381-4905
>> .mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw
>> ==========================================================
>>
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

==========================================================
Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
home 661-245-1725 skype 661-347-0667 global 254-381-4905
.mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw


From ripley at stats.ox.ac.uk  Fri Jan 26 16:52:50 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Jan 2007 15:52:50 +0000 (GMT)
Subject: [Rd] i may have missed something ..
In-Reply-To: <A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
	<Pine.LNX.4.64.0701260853410.2972@auk.stats>
	<A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>
Message-ID: <Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>

Ouch.  It does look like a compiler over-optimization sort of problem.

I presume that is the ix86 icc, with which we have not had much success on 
either Linux or Windows. I've just checked x86_64 icc on Linux, and that 
is working correctly.

Brian

On Fri, 26 Jan 2007, Jan de Leeuw wrote:

> This is R revision 40576 compiled with icc/ifort
> on OS X 10.4.9 (8P2122). It may be the compiler.
>
> -- J.
>
>> example(deriv)
>
> deriv> ## formula argument :
> deriv> dx2x <- deriv(~ x^2, "x") ; dx2x
> expression({
>   .value <- x^2
>   .grad <- array(0, c(length(.value), 1), list(NULL, c("x")))
>   .grad[, "x"] <- 0
>   attr(.value, "gradient") <- .grad
>   .value
> })
>
> deriv> ## Not run:
> deriv> ##D expression({
> deriv> ##D          .value <- x^2
> deriv> ##D          .grad <- array(0, c(length(.value), 1), list(NULL, 
> c("x")))
> deriv> ##D          .grad[, "x"] <- 2 * x
> deriv> ##D          attr(.value, "gradient") <- .grad
> deriv> ##D          .value
> deriv> ##D })
> deriv> ## End(Not run)
> deriv> mode(dx2x)
> [1] "expression"
>
> deriv> x <- -1:2
>
> deriv> eval(dx2x)
> [1] 1 0 1 4
> attr(,"gradient")
>    x
> [1,] 0
> [2,] 0
> [3,] 0
> [4,] 0
>
> deriv> ## Something 'tougher':
> deriv> trig.exp <- expression(sin(cos(x + y^2)))
>
> deriv> ( D.sc <- D(trig.exp, "x") )
> [1] 0
>
> deriv> all.equal(D(trig.exp[[1]], "x"), D.sc)
> [1] TRUE
>
> deriv> ( dxy <- deriv(trig.exp, c("x", "y")) )
> expression({
>   .value <- sin(cos(x + y^2))
>   .grad <- array(0, c(length(.value), 2), list(NULL, c("x",
>       "y")))
>   .grad[, "x"] <- 0
>   .grad[, "y"] <- 0
>   attr(.value, "gradient") <- .grad
>   .value
> })
>
> deriv> y <- 1
>
> deriv> eval(dxy)
> [1]  0.8414710  0.5143953 -0.4042392 -0.8360219
> attr(,"gradient")
>    x y
> [1,] 0 0
> [2,] 0 0
> [3,] 0 0
> [4,] 0 0
>
> deriv> eval(D.sc)
> [1] 0
>
> deriv> ## function returned:
> deriv> deriv((y ~ sin(cos(x) * y)), c("x","y"), func = TRUE)
> function (x, y)
> {
>   .value <- sin(cos(x) * y)
>   .grad <- array(0, c(length(.value), 2), list(NULL, c("x",
>       "y")))
>   .grad[, "x"] <- 0
>   .grad[, "y"] <- 0
>   attr(.value, "gradient") <- .grad
>   .value
> }
>
> deriv> ## function with defaulted arguments:
> deriv> (fx <- deriv(y ~ b0 + b1 * 2^(-x/th), c("b0", "b1", "th"),
> deriv+              function(b0, b1, th, x = 1:7){} ) )
> function (b0, b1, th, x = 1:7)
> {
>   .value <- b0 + b1 * 2^(-x/th)
>   .grad <- array(0, c(length(.value), 3), list(NULL, c("b0",
>       "b1", "th")))
>   .grad[, "b0"] <- 1
>   .grad[, "b1"] <- 0
>   .grad[, "th"] <- 0
>   attr(.value, "gradient") <- .grad
>   .value
> }
>
> deriv> fx(2,3,4)
> [1] 4.522689 4.121320 3.783811 3.500000 3.261345 3.060660 2.891905
> attr(,"gradient")
>    b0 b1 th
> [1,]  1  0  0
> [2,]  1  0  0
> [3,]  1  0  0
> [4,]  1  0  0
> [5,]  1  0  0
> [6,]  1  0  0
> [7,]  1  0  0
>
> deriv> ## Higher derivatives
> deriv> deriv3(y ~ b0 + b1 * 2^(-x/th), c("b0", "b1", "th"),
> deriv+      c("b0", "b1", "th", "x") )
> function (b0, b1, th, x)
> {
>   .value <- b0 + b1 * 2^(-x/th)
>   .grad <- array(0, c(length(.value), 3), list(NULL, c("b0",
>       "b1", "th")))
>   .hessian <- array(0, c(length(.value), 3, 3), list(NULL,
>       c("b0", "b1", "th"), c("b0", "b1", "th")))
>   .grad[, "b0"] <- 1
>   .grad[, "b1"] <- 0
>   .grad[, "th"] <- 0
>   attr(.value, "gradient") <- .grad
>   attr(.value, "hessian") <- .hessian
>   .value
> }
>
> deriv> ## Higher derivatives:
> deriv> DD <- function(expr,name, order = 1) {
> deriv+    if(order < 1) stop("'order' must be >= 1")
> deriv+    if(order == 1) D(expr,name)
> deriv+    else DD(D(expr, name), name, order - 1)
> deriv+ }
>
> deriv> DD(expression(sin(x^2)), "x", 3)
> [1] 0
>> 
>
> On Jan 26, 2007, at 00:54 , Prof Brian Ripley wrote:
>
>> On Thu, 25 Jan 2007, Jan de Leeuw wrote:
>> 
>>> but deriv() and friends do not work in R-devel (at least
>>> not on the Mac).
>> 
>> They work for me under Linux and Windows.  What does example(deriv) give 
>> you?
>> 
>>> ==========================================================
>>> Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
>>> home 661-245-1725 skype 661-347-0667 global 254-381-4905
>>> .mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw
>>> ==========================================================
>>> 
>> 
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ==========================================================
> Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
> home 661-245-1725 skype 661-347-0667 global 254-381-4905
> .mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw
> ==========================================================
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bbuchsbaum at berkeley.edu  Fri Jan 26 16:55:59 2007
From: bbuchsbaum at berkeley.edu (Bradley Buchsbaum)
Date: Fri, 26 Jan 2007 10:55:59 -0500
Subject: [Rd] "[" operator and indexing ambiguity
Message-ID: <43ec92880701260755o7cd9cc8el32c6418066233be2@mail.gmail.com>

Hi,

I am working on writing some S4 classes that represent
multidimensional (brain) image data.  I would like these classes to
support standard array indexing. I have been studying the Matrix and
EBImage (http://www.bioconductor.org/packages/1.9/bioc/html/EBImage.html)
packages to see how this is done.

When using objects of the "array" class directly, R distinguishes
between the calls:

x[i,,] and x[i]

with the former returning a 2D array of values and the latter
returning a single value.  The question I have is whether this same
behavior can be simulated in classes that do not inherit from the
"array" class directly? (See below for a snippet from the EBImage
package which suggests that it cannot).

My guess is that native array indexing is making use of the
information provided by the commas, and this is unavailable to user
implemented class methods?

thanks,

Brad Buchsbaum



# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
setMethod("[", signature(x = "Image", i = "numeric", j = "missing"),
    function(x, i, j, k, ..., drop) {
        if (missing(k)) {
            warning("using index [int], cannot distinguish from
[int,,ANY], use [int,1:dim(x)[2],ANY] otherwise")
            tmp = x at .Data[i, drop = FALSE]
        }
        else {
            tmp = x at .Data[i, , k, drop = FALSE]
        }
        ...
}


From deleeuw at cuddyvalley.org  Fri Jan 26 17:02:03 2007
From: deleeuw at cuddyvalley.org (Jan de Leeuw)
Date: Fri, 26 Jan 2007 08:02:03 -0800
Subject: [Rd] i may have missed something ..
In-Reply-To: <Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
	<Pine.LNX.4.64.0701260853410.2972@auk.stats>
	<A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>
	<Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>
Message-ID: <21F01D97-57C7-4B3F-B56F-C9BD807B99A3@cuddyvalley.org>

Yes. No such problem with the pair gcc/ifort. I'll try
less aggressive optimization with icc on deriv.c (I
also have to do that for regex.c).

-- Jan

On Jan 26, 2007, at 07:52 , Prof Brian Ripley wrote:

> Ouch.  It does look like a compiler over-optimization sort of problem.
>
> I presume that is the ix86 icc, with which we have not had much  
> success on either Linux or Windows. I've just checked x86_64 icc on  
> Linux, and that is working correctly.
>
> Brian
>
>

==========================================================
Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
home 661-245-1725 skype 661-347-0667 global 254-381-4905
.mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw


From deleeuw at cuddyvalley.org  Fri Jan 26 17:22:04 2007
From: deleeuw at cuddyvalley.org (Jan de Leeuw)
Date: Fri, 26 Jan 2007 08:22:04 -0800
Subject: [Rd] i may have missed something ..
In-Reply-To: <Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
	<Pine.LNX.4.64.0701260853410.2972@auk.stats>
	<A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>
	<Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>
Message-ID: <B23E1A36-1A5B-4E32-9EAD-4693A6EFE85C@cuddyvalley.org>

Switching the icc compiler flag from -O3 to -O0 for deriv.c
solves the problem. As I said, I have to do that for
regex.c as well.

-- Jan

On Jan 26, 2007, at 07:52 , Prof Brian Ripley wrote:

> Ouch.  It does look like a compiler over-optimization sort of problem.
>
> I presume that is the ix86 icc, with which we have not had much  
> success on either Linux or Windows. I've just checked x86_64 icc on  
> Linux, and that is working correctly.
>
> Brian
>
>

==========================================================
Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
home 661-245-1725 skype 661-347-0667 global 254-381-4905
.mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw


From JILWIL at SAFECO.com  Fri Jan 26 14:51:04 2007
From: JILWIL at SAFECO.com (WILLIE, JILL)
Date: Fri, 26 Jan 2007 05:51:04 -0800
Subject: [Rd] FW: reducing RODBC odbcQuery memory use?
Message-ID: <916551423F01504BA339BF69CBA3BE72016E7A47@psmrdcex18.psm.pin.safeco.com>

New to R, sorry if one or either of these is an inappropriate list for a
question like this below; please let me know if this is a general help
question.

Jill Willie 
Open Seas
Safeco Insurance
jilwil at safeco.com 

-----Original Message-----
From: WILLIE, JILL 
Sent: Thursday, January 25, 2007 2:27 PM
To: r-help at stat.math.ethz.ch
Subject: reducing RODBC odbcQuery memory use?

Basic Questions:

1.  Can I avoid having RODBC use so much memory (35 times the data size
or more) making a data.frame & then .rda file via. sqlQuery/save?  

2.  If not, is there some more appropriate way from w/in R to pull large
data sets (2-5GB) into .rda files from sql? 

Testing details (R transcript below): 1GB CPU, 1GB RAM windows machine.

1.  testing bigger input table (AUTCombinedWA_BILossCost_1per), size is
20MB in sql, 100000 rows, 2 numeric columns, 55 integer columns;
consumes 350000kb of memory & 800000kb of virtual memory to execute the
sqlQuery command.  Memory not released after the step finishes or upon
execution of odbcCloseAll(), or gc().

2.  tested small input table, size is 2MB in sql, 10000 rows, 2 numeric
columns, 55 integer columns; consumes 55000kb of memory & 515000kb (vm
seems oddly high to me) of virtual memory to execute the sqlQuery
command.

3.  concluded the high memory use is isolated to the odbcQuery step w/in
the sqlQuery function as opposed to sqlGetResults or ODBC itself.


Relevant R session transcript:

>library(RODBC)
>channel<-odbcConnect("psmrd") 
>df_OnePer <-data.frame(sqlQuery(channel, "select * from
AUTCombinedWA_BILossCost_1per"))
>save(df_OnePer, file = "df_OnePer.rda")


Additional testing details:
I exited R which released all memory cleanly, then started R again,
loaded the .rda saved in prior step as below.  This confirmed relatively
little of the memory is consumed going from .rda to data frame;
isolating to the RODBC step:

> load("df_OnePer.rda")
> df <- data.frame(df_OnePer)

I closed R & opened MS Access & used the same DSN "psmrd", & to import
the AUTCombinedWA_BILossCost_1per into MS Access which required about
30000kb of memory & 20000kb of virtual.

And finally, I have this excerpt from Prof Brian Ripley that seems
potentially relevant (if it's not just confusion because I called them
'byte-size' when really I should have said they're integers just having
values limited to 1-255).  In any case I'm unable to see from the RODBC
help how to specify this:  "...sqlQuery returns a data frame directly.
I think you need to tell RODBC to translate your 'byte-sized factors' to
numeric, as it will be going through character if these are a type it
does not know about."  

Read all the RODBC help, read all the data import guide & searched help
archives...can't find an answer.  Would appreciate advice, experience,
or direction.

Jill Willie 
Open Seas
Safeco Insurance
jilwil at safeco.com 


-----Original Message-----
From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sent: Thursday, January 25, 2007 12:05 AM
To: WILLIE, JILL
Cc: r-help at stat.math.ethz.ch
Subject: Re: [R] Size of data vs. needed memory...rule of thumb?

On Wed, 24 Jan 2007, WILLIE, JILL wrote:

> I have been searching all day & most of last night, but can't find any
> benchmarking or recommendations regarding R system requirements for
very
> large (2-5GB) data sets to help guide our hardware configuration.  If
> anybody has experience with this they're willing to share or could
> anybody point me in a direction that might be productive to research,
it
> would be much appreciated.  Specifically:  will R simply use as much
> memory as the OS makes available to it, unlimited?

Under most OSes.  Because Windows has no means to limit the amount made 
available, R under Windows does have it own limiting mechanism (which
you 
hit in the examples below).  R under Linux will allow you to run a 4GB 
process on a machine with 2GB RAM, but you are likely to get around 0.7%

usage.  (One of my colleagues did that on a server earlier this week, 
hence the very specific answer.)

> Is there a multi-threading version R, packages?

Not to run computations in R.  Some parts of R (e.g. GUIs) and some 
libraries (e.g. some BLAS) are multithreaded.  There are multiprocess
packages, e.g. Rmpi, rpvm, snow.

> Does the core R package support 64-bit

Yes, and has for many years.

> & should I expect to see any difference in how memory's handled under 
> that version?

yes, because the address space will not get seriously fragmented.  See
the 
appropriate section in R-admin.html (referenced from INSTALL).

> Is 3 GB of memory to 1GB of data a reasonable ballpark?

I'd say it was a bit low, but it really depends on the analysis you are 
doing, how 1GB of data is made up (many rows?, many cols?, etc) and so
on.
Had you asked me to suggest a ratio I would have said 5.

> Our testing thus far has been on a windows 32-bit box w/1GB of RAM & 1
> CPU; it appears to indicate something like 3GB of RAM for every 1GB of
> sql table (ex-indexes, byte-sized factors).  At this point, we're
> planning on setting up a dual core 64-bit Linux box w/16GB of RAM for
> starters, since we have summed-down sql tables of approx 2-5GB
> generally.
>
> Here's details, just for context, or in case I'm misinterpreting the
> results, or in case there's some more memory-efficient way to get data
> in R's binary format than going w/the data.frame.

Well, sqlQuery returns a data frame directly.  I think you need to tell 
RODBC to translate your 'byte-sized factors' to numeric, as it will be 
going through character if these are a type it does not know about.

> R session:
> 		> library(RODBC)
> 		> channel<-odbcConnect("psmrd")
> 		> FivePer <-data.frame(sqlQuery(channel, "select * from
> AUTCombinedWA_BILossCost_5per"))
>
> 		Error: cannot allocate vector of size 2000 Kb
> 		In addition: Warning messages:
> 		1: Reached total allocation of 1023Mb: see
> help(memory.size)
> 		2: Reached total allocation of 1023Mb: see
> help(memory.size)
>
>
> ODBC connection:
> 		Microsoft SQL Server ODBC Driver Version 03.86.1830
>
> 		Data Source Name: psmrd
> 		Data Source Description:
> 		Server: psmrdcdw01\modeling
> 		Database: OpenSeas_Work1
> 		Language: (Default)
> 		Translate Character Data: Yes
> 		Log Long Running Queries: No
> 		Log Driver Statistics: No
> 		Use Integrated Security: Yes
> 		Use Regional Settings: No
> 		Prepared Statements Option: Drop temporary procedures on
> disconnect
> 		Use Failover Server: No
> 		Use ANSI Quoted Identifiers: Yes
> 		Use ANSI Null, Paddings and Warnings: Yes
> 		Data Encryption: No
>
> Please be patient, I'm a new R user (or at least I'm trying to be...at
> this point I'm mostly a new R-help-reader); I'd appreciated being
> pointed in the right direction if this isn't the right help list to
send
> this question to...or if this question is poorly worded (I did read
the
> posting guide).
>
> Jill Willie
> Open Seas
> Safeco Insurance
> jilwil at safeco.com
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mtmorgan at fhcrc.org  Fri Jan 26 18:50:31 2007
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 26 Jan 2007 09:50:31 -0800
Subject: [Rd] "[" operator and indexing ambiguity
In-Reply-To: <43ec92880701260755o7cd9cc8el32c6418066233be2@mail.gmail.com>
	(Bradley Buchsbaum's message of "Fri, 26 Jan 2007 10:55:59 -0500")
References: <43ec92880701260755o7cd9cc8el32c6418066233be2@mail.gmail.com>
Message-ID: <6phveitpti0.fsf@gopher4.fhcrc.org>

Hackish (and maybe expensive; does match.call duplicate the call
arguments?), but maybe

setClass("A", "numeric")

setMethod("[",
          c(x="A"),
          function(x, i, j, ..., drop=TRUE) {
              "..." %in% names(match.call(expand.dots=FALSE))
          })

> a <- new("A")
> a[i]
[1] FALSE
> a[i,,]
[1] TRUE

? 

Martin

"Bradley Buchsbaum" <bbuchsbaum at berkeley.edu> writes:

> Hi,
>
> I am working on writing some S4 classes that represent
> multidimensional (brain) image data.  I would like these classes to
> support standard array indexing. I have been studying the Matrix and
> EBImage (http://www.bioconductor.org/packages/1.9/bioc/html/EBImage.html)
> packages to see how this is done.
>
> When using objects of the "array" class directly, R distinguishes
> between the calls:
>
> x[i,,] and x[i]
>
> with the former returning a 2D array of values and the latter
> returning a single value.  The question I have is whether this same
> behavior can be simulated in classes that do not inherit from the
> "array" class directly? (See below for a snippet from the EBImage
> package which suggests that it cannot).
>
> My guess is that native array indexing is making use of the
> information provided by the commas, and this is unavailable to user
> implemented class methods?
>
> thanks,
>
> Brad Buchsbaum
>
>
>
> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> setMethod("[", signature(x = "Image", i = "numeric", j = "missing"),
>     function(x, i, j, k, ..., drop) {
>         if (missing(k)) {
>             warning("using index [int], cannot distinguish from
> [int,,ANY], use [int,1:dim(x)[2],ANY] otherwise")
>             tmp = x at .Data[i, drop = FALSE]
>         }
>         else {
>             tmp = x at .Data[i, , k, drop = FALSE]
>         }
>         ...
> }
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin Morgan
Bioconductor / Computational Biology
http://bioconductor.org


From tplate at blackmesacapital.com  Fri Jan 26 19:47:18 2007
From: tplate at blackmesacapital.com (Tony Plate)
Date: Fri, 26 Jan 2007 11:47:18 -0700
Subject: [Rd] "[" operator and indexing ambiguity
In-Reply-To: <43ec92880701260755o7cd9cc8el32c6418066233be2@mail.gmail.com>
References: <43ec92880701260755o7cd9cc8el32c6418066233be2@mail.gmail.com>
Message-ID: <45BA4CB6.6020008@blackmesacapital.com>

You can find this info using the function nargs().  I've used this with 
S3 classes, and as far as I know it should work with S4 classes too. 
See ?nargs for examples.

-- Tony Plate

Bradley Buchsbaum wrote:
> Hi,
> 
> I am working on writing some S4 classes that represent
> multidimensional (brain) image data.  I would like these classes to
> support standard array indexing. I have been studying the Matrix and
> EBImage (http://www.bioconductor.org/packages/1.9/bioc/html/EBImage.html)
> packages to see how this is done.
> 
> When using objects of the "array" class directly, R distinguishes
> between the calls:
> 
> x[i,,] and x[i]
> 
> with the former returning a 2D array of values and the latter
> returning a single value.  The question I have is whether this same
> behavior can be simulated in classes that do not inherit from the
> "array" class directly? (See below for a snippet from the EBImage
> package which suggests that it cannot).
> 
> My guess is that native array indexing is making use of the
> information provided by the commas, and this is unavailable to user
> implemented class methods?
> 
> thanks,
> 
> Brad Buchsbaum
> 
> 
> 
> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> setMethod("[", signature(x = "Image", i = "numeric", j = "missing"),
>     function(x, i, j, k, ..., drop) {
>         if (missing(k)) {
>             warning("using index [int], cannot distinguish from
> [int,,ANY], use [int,1:dim(x)[2],ANY] otherwise")
>             tmp = x at .Data[i, drop = FALSE]
>         }
>         else {
>             tmp = x at .Data[i, , k, drop = FALSE]
>         }
>         ...
> }
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From r.darnell at uq.edu.au  Sat Jan 27 00:26:47 2007
From: r.darnell at uq.edu.au (r.darnell at uq.edu.au)
Date: Sat, 27 Jan 2007 00:26:47 +0100 (CET)
Subject: [Rd] Error in loadNamespace(name) (PR#9464)
Message-ID: <20070126232647.F1BA51DE9D@slim.kubism.ku.dk>

Thank you for your reply. There is some more information that may help 
your reproduce the error.

The .RData file was generated under  MSWindows.  I started with an empty 
workspace and generated an object by

y <- runif(200)

or very similar.

the quit, saving the workspace. (NTFS partition)

I then logged out of  Windows, logged into Lunix (Ubuntu Edgy Eft), 
cd'ed to where the .RData file lived and tried to start R.

I have had the same experience with larger (real) workspaces. If I 
remove the .RData file there is no problem.

Regards
Ross Darnell
 


Prof Brian Ripley wrote:
> There is nothing here to reproduce.
> It clearly depends on your .RData, which is not available to us.
> Unless you can make it available, we cannot help.
>
> On Thu, 25 Jan 2007, r.darnell at uq.edu.au wrote:
>
>> Full_Name: Ross Darnell
>> Version: 2.4.1
>> OS: Linux
>> Submission from: (NULL) (130.102.133.33)
>>
>>
>> rdarnell at pc:~/Data$ ls -al .RData
>> -rwxrwxrwx 2 root root 13551 2006-12-06 08:58 .RData
>> rdarnell at pc:~/Data$ R
>>
>> R version 2.4.1 (2006-12-18)
>> Copyright (C) 2006 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>>  Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>> Error in loadNamespace(name) : there is no package called 'lattice'
>> Fatal error: unable to restore saved data in .RData
>>
>> rdarnell at pc:~/Data$ R --no-restore-data
>>
>>> load(".RData")
>> Error in loadNamespace(name) : there is no package called 'lattice'
>>
>>
>>
>> --please do not edit the information below--
>>
>> Version:
>> platform = i486-pc-linux-gnu
>> arch = i486
>> os = linux-gnu
>> system = i486, linux-gnu
>> status =
>> major = 2
>> minor = 4.1
>> year = 2006
>> month = 12
>> day = 18
>> svn rev = 40228
>> language = R
>> version.string = R version 2.4.1 (2006-12-18)
>>
>> Locale:
>> LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C 
>>
>>
>> Search Path:
>> .GlobalEnv, package:stats, package:graphics, package:grDevices, 
>> package:utils,
>> package:datasets, package:methods, Autoloads, package:base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From ripley at stats.ox.ac.uk  Sat Jan 27 09:27:28 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Sat, 27 Jan 2007 09:27:28 +0100 (CET)
Subject: [Rd] Error in loadNamespace(name) (PR#9464)
Message-ID: <20070127082728.482EE4BEAC@slim.kubism.ku.dk>

It does not help, except to show that your original report was not a 
true reflection of the situation, and that you are not willing to give 
the more information that we did ask for, namely the saved image.

When I do what you said you did, there is no reference to 'lattice' in the 
saved image.

It seems likely that

1) Your Windows setup is not factory-fresh in ways that you have not told 
us.

2) Your 'Lunix' setup is broken, as Peter Dalgaard suggested.

I am going to close this non-bug report.


On Sat, 27 Jan 2007, Ross Darnell wrote:

> Thank you for your reply. There is some more information that may help your 
> reproduce the error.
>
> The .RData file was generated under  MSWindows.  I started with an empty 
> workspace and generated an object by
>
> y <- runif(200)
>
> or very similar.
>
> the quit, saving the workspace. (NTFS partition)
>
> I then logged out of  Windows, logged into Lunix (Ubuntu Edgy Eft), cd'ed to 
> where the .RData file lived and tried to start R.
>
> I have had the same experience with larger (real) workspaces. If I remove the 
> .RData file there is no problem.
>
> Regards
> Ross Darnell
>
>
>
> Prof Brian Ripley wrote:
>> There is nothing here to reproduce.
>> It clearly depends on your .RData, which is not available to us.
>> Unless you can make it available, we cannot help.
>> 
>> On Thu, 25 Jan 2007, r.darnell at uq.edu.au wrote:
>> 
>>> Full_Name: Ross Darnell
>>> Version: 2.4.1
>>> OS: Linux
>>> Submission from: (NULL) (130.102.133.33)
>>> 
>>> 
>>> rdarnell at pc:~/Data$ ls -al .RData
>>> -rwxrwxrwx 2 root root 13551 2006-12-06 08:58 .RData
>>> rdarnell at pc:~/Data$ R
>>> 
>>> R version 2.4.1 (2006-12-18)
>>> Copyright (C) 2006 The R Foundation for Statistical Computing
>>> ISBN 3-900051-07-0
>>> 
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>>
>>>  Natural language support but running in an English locale
>>> 
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>> 
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for an HTML browser interface to help.
>>> Type 'q()' to quit R.
>>> 
>>> Error in loadNamespace(name) : there is no package called 'lattice'
>>> Fatal error: unable to restore saved data in .RData
>>> 
>>> rdarnell at pc:~/Data$ R --no-restore-data
>>> 
>>>> load(".RData")
>>> Error in loadNamespace(name) : there is no package called 'lattice'
>>> 
>>> 
>>> 
>>> --please do not edit the information below--
>>> 
>>> Version:
>>> platform = i486-pc-linux-gnu
>>> arch = i486
>>> os = linux-gnu
>>> system = i486, linux-gnu
>>> status =
>>> major = 2
>>> minor = 4.1
>>> year = 2006
>>> month = 12
>>> day = 18
>>> svn rev = 40228
>>> language = R
>>> version.string = R version 2.4.1 (2006-12-18)
>>> 
>>> Locale:
>>> LC_CTYPE=en_AU.UTF-8;LC_NUMERIC=C;LC_TIME=en_AU.UTF-8;LC_COLLATE=en_AU.UTF-8;LC_MONETARY=en_AU.UTF-8;LC_MESSAGES=en_AU.UTF-8;LC_PAPER=en_AU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_AU.UTF-8;LC_IDENTIFICATION=C 
>>> 
>>> Search Path:
>>> .GlobalEnv, package:stats, package:graphics, package:grDevices, 
>>> package:utils,
>>> package:datasets, package:methods, Autoloads, package:base
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From osklyar at ebi.ac.uk  Sat Jan 27 01:30:51 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Sat, 27 Jan 2007 00:30:51 +0000
Subject: [Rd] "[" operator and indexing ambiguity
Message-ID: <45BA9D3B.9000504@ebi.ac.uk>

Hi everybody. I myself am not subscribed for Rd therefore replying late. 
As the author of EBImage, I'd like to comment on the issue.

As Tony correctly writes one can generally use nargs() to get the number 
of arguments, and this works for "["(x,i,j,...,drop) method as well. The 
problem I had with the EBImage where I could not distinguish between 
x[index] and x[index,,] is that somehow particularly for the "[" method 
and particularly for 3 dimensions nargs in both cases gave me the same 
number of arguments! This behavior was not present when the number of 
dimension was 2 or 4, i.e. for x[index,] or x[index,,,] -- these could 
be easily distinguished from x[index]. Anyway, maybe R changed since and 
I just did not notice that :)

Otherwise, coming back to Bradley's original question, it is generally a 
  difficult task to implement correct indexing if your underlying type 
does not initially support it simply because there are so many 
combinations possible! Originally, EBImage's Image class was not based 
on 'array' and then "[" method definitions were simply overwhelming -- 
too many and too long, and still did not work completely right. Using 
array simply allowed me to pass the arguments as they are to the 
underlying array and only build a couple of features on top.

It becomes even more difficult for the set method "[<-" as you really 
need to parse all indexes and make them rotating if too short etc etc. 
Here the power of R in freestyle indexing of arrays becomes a pain.


-- 
Dr Oleg Sklyar | EBI-EMBL, Cambridge CB10 1SD, UK | +44-1223-494466


From whorfin at pixar.com  Fri Jan 26 23:24:39 2007
From: whorfin at pixar.com (whorfin at pixar.com)
Date: Fri, 26 Jan 2007 23:24:39 +0100 (CET)
Subject: [Rd] Makevars PKG_LIBS ignored by SHLIB (PR#9473)
Message-ID: <20070126222439.227F31C6B7@slim.kubism.ku.dk>

Full_Name: Rick Sayre
Version: 2.4.0
OS: Windows
Submission from: (NULL) (138.72.27.164)


PKG_LIBS works fine on *nix
on windows, it seems to be ignored by the "SHLIB" script
so, R CMD SHLIB blah
properly uses PKG_CPPFLAGS and PKG_CFLAGS from Makevars, but PKG_LIBS is
ignored


From ripley at stats.ox.ac.uk  Sat Jan 27 14:40:47 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Sat, 27 Jan 2007 14:40:47 +0100 (CET)
Subject: [Rd] Makevars PKG_LIBS ignored by SHLIB (PR#9473)
Message-ID: <20070127134047.9511E5A6A3@slim.kubism.ku.dk>

This is a report on an obsolete version of R, on a problem that existed in 
_only_ that version and has already been fixed in the current release 
(and in R-patched before it).

Please learn the courtesy and respect that both the posting guide and FAQ 
ask for in not abusing the project's resources in this way.

On Fri, 26 Jan 2007, whorfin at pixar.com wrote:

> Full_Name: Rick Sayre
> Version: 2.4.0
> OS: Windows
> Submission from: (NULL) (138.72.27.164)
>
>
> PKG_LIBS works fine on *nix
> on windows, it seems to be ignored by the "SHLIB" script
> so, R CMD SHLIB blah
> properly uses PKG_CPPFLAGS and PKG_CFLAGS from Makevars, but PKG_LIBS is
> ignored
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From simon.urbanek at r-project.org  Sat Jan 27 23:01:16 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 27 Jan 2007 17:01:16 -0500
Subject: [Rd] i may have missed something ..
In-Reply-To: <B23E1A36-1A5B-4E32-9EAD-4693A6EFE85C@cuddyvalley.org>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
	<Pine.LNX.4.64.0701260853410.2972@auk.stats>
	<A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>
	<Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>
	<B23E1A36-1A5B-4E32-9EAD-4693A6EFE85C@cuddyvalley.org>
Message-ID: <AAE4C7BE-0626-4282-B632-52DE1A20F92F@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070127/0268b7af/attachment.pl 

From deleeuw at cuddyvalley.org  Sat Jan 27 23:17:53 2007
From: deleeuw at cuddyvalley.org (Jan de Leeuw)
Date: Sat, 27 Jan 2007 14:17:53 -0800
Subject: [Rd] i may have missed something ..
In-Reply-To: <AAE4C7BE-0626-4282-B632-52DE1A20F92F@r-project.org>
References: <3A6441C3-CD8C-4672-86F2-B4088D2CC21C@cuddyvalley.org>
	<Pine.LNX.4.64.0701260853410.2972@auk.stats>
	<A33730DE-566E-4D91-8B63-E1E15DE36203@cuddyvalley.org>
	<Pine.LNX.4.64.0701261547230.1773@gannet.stats.ox.ac.uk>
	<B23E1A36-1A5B-4E32-9EAD-4693A6EFE85C@cuddyvalley.org>
	<AAE4C7BE-0626-4282-B632-52DE1A20F92F@r-project.org>
Message-ID: <4C7F59A5-96CF-44D2-BE83-83716F8C4F68@cuddyvalley.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070127/e4fd3f46/attachment.pl 

From kaplan at santafe.edu  Sun Jan 28 07:07:28 2007
From: kaplan at santafe.edu (t.d. kaplan)
Date: Sat, 27 Jan 2007 23:07:28 -0700
Subject: [Rd] Fwd: controlling plot height
In-Reply-To: <f6aa47200701272120x3d4d472awdfaff6c5ce0bc2f7@mail.gmail.com>
References: <f6aa47200701272120x3d4d472awdfaff6c5ce0bc2f7@mail.gmail.com>
Message-ID: <f6aa47200701272207y70dfa8d9q11b9a9b7b2dfa1c4@mail.gmail.com>

hi,

i am trying to create a plot of reduced height. i am able to achieve
this with:

 par(pin=c(par("pin")[1], 1))

however, the plot is surrounded by large margins. is there a way for
me to reduce the margins to match the dimensions of the plot?

thanks.


From ripley at stats.ox.ac.uk  Sun Jan 28 08:10:05 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Jan 2007 07:10:05 +0000 (GMT)
Subject: [Rd] Fwd: controlling plot height
In-Reply-To: <f6aa47200701272207y70dfa8d9q11b9a9b7b2dfa1c4@mail.gmail.com>
References: <f6aa47200701272120x3d4d472awdfaff6c5ce0bc2f7@mail.gmail.com>
	<f6aa47200701272207y70dfa8d9q11b9a9b7b2dfa1c4@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0701280708020.7800@gannet.stats.ox.ac.uk>

On Sat, 27 Jan 2007, t.d. kaplan wrote:

> hi,
>
> i am trying to create a plot of reduced height. i am able to achieve
> this with:
>
> par(pin=c(par("pin")[1], 1))
>
> however, the plot is surrounded by large margins. is there a way for
> me to reduce the margins to match the dimensions of the plot?

It sounds as if it is the device region not the plot region which you wish 
to reduce in height.  You do that when opening the device, e.g.

pdf(width=10, height=4)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From huber at ebi.ac.uk  Sun Jan 28 15:40:31 2007
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Sun, 28 Jan 2007 14:40:31 +0000
Subject: [Rd] "[",
	.local and S4 methods (was: "[" operator and indexing ambiguity)
Message-ID: <45BCB5DF.8010906@ebi.ac.uk>

Dear Tony,

thanks for the tip with "nargs", when suitably applied, this answers the 
problem.

The behaviour of "nargs" in S4 methods has some subtleties compared to 
that in normal functions, as shown in the example below. I admit that 
this is what had earlier created some confusion about the semantics of 
"nargs". From the perspective of "nargs" and its man page, this all 
seems fine, but its interaction with the S4 methods implementation was 
surprising to me and I'd be interested whether people think that this is 
the desired behaviour.

### ------------------- example code ---------------------------

setClass("foo", representation(x="array"))
a = new("foo")

myfun = function (x, i, j, k, ..., drop=TRUE) {
   cat(paste(match.call()), "\nnargs()=", nargs(),
       missing(i), missing(j), missing(k), missing(drop), "\n\n")
   return(invisible(NULL))
}
setMethod ("[", signature(x="foo", i="numeric", j="missing"), myfun)

a[7]
a[7,]
myfun(a, 7)
myfun(a, 7, )
showMethods("[", classes="foo", inc=TRUE)

### --------------------- example output -----------------------

.local x i j drop
nargs()= 4 FALSE TRUE TRUE FALSE

.local x i j drop
nargs()= 4 FALSE TRUE TRUE FALSE
    ## here it seems impossible to distinguish a[7] from a[7,]
    ## also note that missing(drop) is FALSE

myfun a 7
nargs()= 2 FALSE TRUE TRUE TRUE

myfun a 7
nargs()= 3 FALSE TRUE TRUE TRUE

Function: [ (package base)
x="foo", i="numeric", j="missing"
function (x, i, j, ..., drop = TRUE)
{
     .local <- function (x, i, j, k, ..., drop = TRUE)
     {
         cat(paste(match.call()), "\nnargs()=", nargs(), missing(i),
             missing(j), missing(k), missing(drop), "\n\n")
         return(invisible(NULL))
     }
     .local(x, i, j, ..., drop = drop)
}



### ----------- example code 2 (different signature: no k) ---

myfun = function (x, i, j, ..., drop=TRUE) {
   cat(paste(match.call()), "\nnargs()=", nargs(),
       missing(i), missing(j), missing(drop), "\n\n")
   return(invisible(NULL))
}
setMethod ("[", signature(x="foo", i="numeric", j="missing"), myfun)


a[7]
a[7,]
myfun(a, 7)
myfun(a, 7, )
showMethods("[", classes="foo", inc=TRUE)

### --------------------- example output -----------------------


[ a 7
nargs()= 2 FALSE TRUE TRUE

[ a 7
nargs()= 3 FALSE TRUE TRUE

myfun a 7
nargs()= 2 FALSE TRUE TRUE

myfun a 7
nargs()= 3 FALSE TRUE TRUE

Function: [ (package base)
x="foo", i="numeric", j="missing"
function (x, i, j, ..., drop = TRUE)
{
     cat(paste(match.call()), "\nnargs()=", nargs(), missing(i),
         missing(j), missing(drop), "\n\n")
     return(invisible(NULL))
}

########################################

 > sessionInfo()

R version 2.5.0 Under development (unstable) (2007-01-28 r40602)
i686-pc-linux-gnu

locale:
LC_CTYPE=en_GB.UTF-8;LC_NUMERIC=C;LC_TIME=en_GB.UTF-8;LC_COLLATE=en_GB.UTF-8;LC_MONETARY=en_GB.UTF-8;LC_MESSAGES=en_GB.UTF-8;LC_PAPER=en_GB.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_GB.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
[7] "base"

Best wishes
-- 
------------------------------------------------------------------
Wolfgang Huber  EBI/EMBL  Cambridge UK  http://www.ebi.ac.uk/huber


From kushler at oakland.edu  Sun Jan 28 06:07:02 2007
From: kushler at oakland.edu (kushler at oakland.edu)
Date: Sun, 28 Jan 2007 06:07:02 +0100 (CET)
Subject: [Rd] plot.lm (PR#9474)
Message-ID: <20070128050702.8740D183BA@slim.kubism.ku.dk>

Full_Name: Robert Kushler
Version: 2.4.1
OS: Windows XP
Submission from: (NULL) (69.245.71.40)



In the constant leverage case, plot #5 is not correctly produced.
The labels on the x-axis are sorted correctly by magnitude of the
fitted value, but the data are plotted in the original factor order.

I changed
                facval[ord] <- facval
                xx <- facval
                plot(facval, rs, xlim = c(-1/2, sum((nlev - 1) * 

to
             #  facval[ord] <- facval
                xx <- facval[ord]
                plot(xx, rs, xlim = c(-1/2, sum((nlev - 1) * 

in the "if (isConst.hat)" section of "show[5]".  The data then
plotted correctly but the extreme point labels did not move. 
I'm not up to the task of figuring out how to fix the labels, and
there might be other side effects of the change I made.  In any
case, something needs to be done.

Thanks for your attention (and thanks for a wonderful software system).

Regards,    Rob Kushler


From ripley at stats.ox.ac.uk  Mon Jan 29 12:18:49 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Mon, 29 Jan 2007 12:18:49 +0100 (CET)
Subject: [Rd] plot.lm (PR#9474)
Message-ID: <20070129111849.A92674C904@slim.kubism.ku.dk>

There is nothing to reproduce here.  Please supply a self-contained, 
commented, reproducible example.

On Sun, 28 Jan 2007, kushler at oakland.edu wrote:

> Full_Name: Robert Kushler
> Version: 2.4.1
> OS: Windows XP
> Submission from: (NULL) (69.245.71.40)
>
>
>
> In the constant leverage case, plot #5 is not correctly produced.
> The labels on the x-axis are sorted correctly by magnitude of the
> fitted value, but the data are plotted in the original factor order.
>
> I changed
>                facval[ord] <- facval
>                xx <- facval
>                plot(facval, rs, xlim = c(-1/2, sum((nlev - 1) *
>
> to
>             #  facval[ord] <- facval
>                xx <- facval[ord]
>                plot(xx, rs, xlim = c(-1/2, sum((nlev - 1) *
>
> in the "if (isConst.hat)" section of "show[5]".  The data then
> plotted correctly but the extreme point labels did not move.
> I'm not up to the task of figuring out how to fix the labels, and
> there might be other side effects of the change I made.  In any
> case, something needs to be done.
>
> Thanks for your attention (and thanks for a wonderful software system).
>
> Regards,    Rob Kushler
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From org.r-project at pooryorick.com  Thu Jan 25 22:04:03 2007
From: org.r-project at pooryorick.com (org.r-project at pooryorick.com)
Date: Thu, 25 Jan 2007 22:04:03 +0100 (CET)
Subject: [Rd] misspelling - intension (PR#9470)
Message-ID: <20070125210403.4DEE1281E0@slim.kubism.ku.dk>

Full_Name: Nathan Coulter
Version: R-2.3.1
OS: Linux
Submission from: (NULL) (148.168.40.4)


On page 827 of the Reference Index, "intention" is spelled as "intension":

Another variety of extension starts with one of the built-in data types, perhaps
with the intension of
modifying R?s standard behavior for that class.


From ripley at stats.ox.ac.uk  Mon Jan 29 14:36:30 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Mon, 29 Jan 2007 14:36:30 +0100 (CET)
Subject: [Rd] misspelling - intension (PR#9470)
Message-ID: <20070129133630.63F995A687@slim.kubism.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--27464147-1141997210-1170077752=:21657
Content-Type: TEXT/PLAIN; charset=iso-8859-1; format=flowed
Content-Transfer-Encoding: 8BIT

But not in the SVN trunk (R 2.3.1 is long obsolete).

https://svn.r-project.org/R/trunk/src/library/methods/man/setClass.Rd

A concerted effort on spelling was made a few weeks ago, in R-devel (not 
that 'intension' is not a correct spelling).

On Thu, 25 Jan 2007, org.r-project at pooryorick.com wrote:

> Full_Name: Nathan Coulter
> Version: R-2.3.1
> OS: Linux
> Submission from: (NULL) (148.168.40.4)
>
>
> On page 827 of the Reference Index, "intention" is spelled as "intension":
>
> Another variety of extension starts with one of the built-in data types, perhaps
> with the intension of
> modifying R?s standard behavior for that class.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595
--27464147-1141997210-1170077752=:21657--


From ggrothendieck at gmail.com  Mon Jan 29 15:44:42 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 29 Jan 2007 09:44:42 -0500
Subject: [Rd] Rscript on Windows
In-Reply-To: <971536df0701260645p68852335n21812456a52733e8@mail.gmail.com>
References: <971536df0701252058i739700dx8f7e02f8be48bf4e@mail.gmail.com>
	<8651815.post@talk.nabble.com>
	<971536df0701260645p68852335n21812456a52733e8@mail.gmail.com>
Message-ID: <971536df0701290644w51e75315r59120822cffe2819@mail.gmail.com>

Haven't got any feedback on this one.

Will we be getting a perl/python/ruby style -x switch for Rscript for R 2.5.0?

It certainly would give more flexibility to users of Rscript on non-UNIX systems
where #! notation is not available.

On 1/26/07, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> Good idea.  ruby seems to work the same way.  python does too but with
> a slightly different definition:
>
> C:\> ruby -h | findstr strip
>  -x[directory]   strip off text before #!ruby line and perhaps cd to directory
>
> C:\> perl -h | findstr strip
>  -x[directory]   strip off text before #!perl line and perhaps cd to directory
>
> C:\> python -h | findstr skip
> -x     : skip first line of source, allowing use of non-Unix forms of #!cmd
>
>
> On 1/26/07, Vladimir Eremeev <wl2776 at gmail.com> wrote:
> >
> > ActivePerl has '-x' switch which tells it to skip all lines in the file till
> > "#!".
> > This allows writing perl scripts in ordinary .bat files.
> >
> > ?shQuote contains a link with the following perl script example:
> > ===8<===
> > @echo off
> > :: hello.bat
> > :: Windows executable Perl script
> > :: Note:
> > ::   assumes perl.exe is in path
> > ::   otherwise, use absolute path
> > perl -x -S "%0" %*
> > goto end
> > #!perl
> >
> > print "Hello, World!\n";
> > __END__
> > :end
> > :: ------ end of hello.bat ------
> >
> > Windows Notes:
> > " -x " (lower case x): Skip all text until shebang line.
> > " -S " (upper case S): Look for script using PATH variable. Special meaning
> > in Windows: appends .bat or .cmd if lookup for name fails and name does not
> > have either suffix.
> > " %* " only on WinNT/2K/XP; use %1 %2 . . . %9 on Win9x/DOS
> > ===8<===
> >
> > I think the simplest way to implement shebang on windows would be embedding
> > one more command line switch with similar functionality to perl's '-x'.
> >
> > --
> > View this message in context: http://www.nabble.com/Rscript-on-Windows-tf3120774.html#a8651815
> > Sent from the R devel mailing list archive at Nabble.com.
> >


From hpages at fhcrc.org  Tue Jan 30 00:02:41 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Mon, 29 Jan 2007 15:02:41 -0800
Subject: [Rd] update.packages() doesn't pick up the highest version of
	packages
Message-ID: <45BE7D11.60108@fhcrc.org>

Hi,

Try to install limma 2.8.1 with:

  > biocRep <- "http://bioconductor.org/packages/1.9/bioc"
  > install.packages("limma", repos=biocRep)

then try to update it with

  > repos <- c(biocRep, "http://cran.fhcrc.org")
  > update.packages(repos=repos)

--> it will not get updated (even if there is a 2.9.8 version on CRAN).

This is (1) surprising by itself, (2) inconsistent with install.packages
behaviour.

When given more than 1 repository, install.packages() will go thru
all of them and pick up the higher version of each package to install.
For example, this:

  > repos <- c(biocRep, "http://cran.fhcrc.org")
  > install.packages("limma", repos=repos)

will install limma from CRAN (2.9.8) instead of limma from Bioconductor (2.8.1).

But if a new version of limma shows up on CRAN, this:

  > update.packages(repos=repos)

will not update it...

Cheers,
H.


From tpapp at Princeton.EDU  Tue Jan 30 10:11:01 2007
From: tpapp at Princeton.EDU (Tamas K Papp)
Date: Tue, 30 Jan 2007 10:11:01 +0100
Subject: [Rd] function to remove attributes?
Message-ID: <20070130091101.GA28937@pu100877.student.princeton.edu>

Hi,

I would like to know if there is a compact way to remove attributes
from an object.  I know attributes(obj) <- NULL works, but I wonder if
there is something similar to unclass or unname.  RSiteSearch didn't
reveal anything.

Thanks,

Tamas


From ripley at stats.ox.ac.uk  Tue Jan 30 10:38:28 2007
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 30 Jan 2007 09:38:28 +0000 (GMT Standard Time)
Subject: [Rd] function to remove attributes?
In-Reply-To: <20070130091101.GA28937@pu100877.student.princeton.edu>
References: <20070130091101.GA28937@pu100877.student.princeton.edu>
Message-ID: <Pine.WNT.4.64.0701300937080.2432@Petrel>

On Tue, 30 Jan 2007, Tamas K Papp wrote:

> Hi,
>
> I would like to know if there is a compact way to remove attributes
> from an object.  I know attributes(obj) <- NULL works, but I wonder if
> there is something similar to unclass or unname.  RSiteSearch didn't
> reveal anything.

as.vector is usually used for this purpose, but note the caveat on the help 
page.  (And if you have a classed object you probably do not want to remove 
all attributes, since class is one.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From tom.mccallum at levelelimited.com  Tue Jan 30 11:38:35 2007
From: tom.mccallum at levelelimited.com (Tom McCallum)
Date: Tue, 30 Jan 2007 10:38:35 -0000
Subject: [Rd] Speed of for loops
Message-ID: <op.tmyqilgbffxks9@norisk>

Hi Everyone,

I have a question about for loops.  If you have something like:

f <- function(x) {
	y <- rep(NA,10);
	for( i in 1:10 ) {
		if ( i > 3 ) {
			if ( is.na(y[i-3]) == FALSE ) {
				# some calculation F which depends on one or more of the previously  
generated values in the series
				y[i] = y[i-1]+x[i];
			} else {
				y[i] <- x[i];
			}
		}
	}
	y
}

e.g.

> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
  [1] NA NA NA  4  5  6 13 21 30 40

is there a faster way to process this than with a 'for' loop?  I have  
looked at lapply as well but I have read that lapply is no faster than a  
for loop and for my particular application it is easier to use a for loop.  
Also I have seen 'rle' which I think may help me but am not sure as I have  
only just come across it, any ideas?

Many thanks

Tom



-- 
Dr. Thomas McCallum
Systems Architect,
Level E Limited
ETTC, The King's Buildings
Mayfield Road,
Edinburgh EH9 3JL, UK
Work  +44 (0) 131 472 4813
Fax:  +44 (0) 131 472 4719
http://www.levelelimited.com
Email: tom at levelelimited.com

Level E is a limited company incorporated in Scotland. The c...{{dropped}}


From stefan.theussl at wu-wien.ac.at  Tue Jan 30 00:10:39 2007
From: stefan.theussl at wu-wien.ac.at (Stefan Theussl)
Date: Tue, 30 Jan 2007 00:10:39 +0100
Subject: [Rd] CRAN will be down for 15 minutes
Message-ID: <1170112239.45be7eefbb509@webmail.wu-wien.ac.at>

Dear R Community,

Due to maintenance work CRAN will not be available at 30th January around 10
o'clock in the morning CET.

Best regards,
Stefan Theussl


From jgp at m-itc.net  Tue Jan 30 06:29:14 2007
From: jgp at m-itc.net (jgp at m-itc.net)
Date: Tue, 30 Jan 2007 06:29:14 +0100 (CET)
Subject: [Rd] R crashes when used from within rpy (PR#9481)
Message-ID: <20070130052914.95D105A697@slim.kubism.ku.dk>

Full_Name: Jose Gaetan Pierre
Version: 2.4.1
OS: Fedora Core 6
Submission from: (NULL) (196.27.87.14)


I have been using R from within rpy for a while because I am more familiar with
Python syntax. I first noticed this bug with R-2.4.0.
Screendump: ------------------------------
>>> from rpy import *
>>> beer = r.scan()
1:  3 4 1 1 3 4 3 3 1 3 2 1 2 1 2 3 2 3 1 1 1 1 4 3 1
26: 
Read 25 items
>>> c = r.table(beer)
>>> c
array([10,  4,  8,  3])
>>> r.pie(c)
>>> Error during wrapup: C stack usage is too close to the limit

 *** caught segfault ***
address (nil), cause 'memory not mapped'

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 3
3
>>> 
End of screendump --------------------

R crashes when the mouse is dragged onto the graphics display.

The version of rpy I am using is rpy-1.0-RC2.

Please note that I also have the same problem on OpenSuSe-10.2.

It does not matter whether I install R using provided rpm packages for the
respective Linux system or whether I compile R myself.


Many thanks for your attention.

Jose G Pierre


From ripley at stats.ox.ac.uk  Tue Jan 30 12:18:20 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Tue, 30 Jan 2007 12:18:20 +0100 (CET)
Subject: [Rd] R crashes when used from within rpy (PR#9481)
Message-ID: <20070130111820.606A25A6A7@slim.kubism.ku.dk>

This is not the address for bug reports on 'rpy'.
Your example works in R.

On Tue, 30 Jan 2007, jgp at m-itc.net wrote:

> Full_Name: Jose Gaetan Pierre
> Version: 2.4.1
> OS: Fedora Core 6
> Submission from: (NULL) (196.27.87.14)
>
>
> I have been using R from within rpy for a while because I am more familiar with
> Python syntax. I first noticed this bug with R-2.4.0.
> Screendump: ------------------------------
>>>> from rpy import *
>>>> beer = r.scan()
> 1:  3 4 1 1 3 4 3 3 1 3 2 1 2 1 2 3 2 3 1 1 1 1 4 3 1
> 26:
> Read 25 items
>>>> c = r.table(beer)
>>>> c
> array([10,  4,  8,  3])
>>>> r.pie(c)
>>>> Error during wrapup: C stack usage is too close to the limit
>
> *** caught segfault ***
> address (nil), cause 'memory not mapped'
>
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 3
> 3
>>>>
> End of screendump --------------------
>
> R crashes when the mouse is dragged onto the graphics display.
>
> The version of rpy I am using is rpy-1.0-RC2.
>
> Please note that I also have the same problem on OpenSuSe-10.2.
>
> It does not matter whether I install R using provided rpm packages for the
> respective Linux system or whether I compile R myself.
>
>
> Many thanks for your attention.
>
> Jose G Pierre
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Tue Jan 30 13:04:38 2007
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (thomas.friedrichsmeier at ruhr-uni-bochum.de)
Date: Tue, 30 Jan 2007 13:04:38 +0100 (CET)
Subject: [Rd] R crashes when used from within rpy (PR#9481)
Message-ID: <20070130120438.B08015A6DC@slim.kubism.ku.dk>

--nextPart1830390.4s8xi7h1go
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

On Tuesday 30 January 2007 06:29, jgp at m-itc.net wrote:
> >>> Error during wrapup: C stack usage is too close to the limit

Probably the stack-checking mechanism needs to be adjusted when embedding R=
=20
inside python. This mechanism was added in R 2.3.0, so you could try=20
compiling with R 2.2.x.
See http://cran.r-project.org/doc/manuals/R-exts.html#Threading-issues . I'=
ve=20
only had a cursory look at the RPy code, but it seems to me, the culprit ma=
y=20
be in function r_events in rpymodule.c .

But since this is almost certainly a bug in RPy, not R, you should submit y=
our=20
report to their tracker instead:=20
http://sourceforge.net/tracker/?group_id=3D48422&atid=3D453021
As a rule of thumb, don't report problems here, unless you can reproduce th=
em=20
in a plain R session.

Regards
Thomas Friedrichsmeier

--nextPart1830390.4s8xi7h1go
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQBFvzQwEKRv+5DVNhgRAorEAKCUUNqoF6k/9ipVkbY78ELpqwL2HACgmhTf
kP0VCflFTvnhfxgpJQig+Qw=
=WYJt
-----END PGP SIGNATURE-----

--nextPart1830390.4s8xi7h1go--


From osklyar at ebi.ac.uk  Tue Jan 30 13:15:29 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Tue, 30 Jan 2007 12:15:29 +0000
Subject: [Rd] Speed of for loops
In-Reply-To: <op.tmyqilgbffxks9@norisk>
References: <op.tmyqilgbffxks9@norisk>
Message-ID: <45BF36E1.7050200@ebi.ac.uk>

Tom,

*apply's generally speed up calculations dramatically. However, if and 
only if you do a repetitive operation on a vector, list matrix which 
does NOT require accessing other elements of that variable than the one 
currently in the *apply index. This means in your case any of *apply 
will not speed up your calculation (until you significantly rethink the 
code). At the same time, you can speed up your code by orders of 
magnitude using c-functions for "complex" vector indexing operations. If 
you need instructions, I can send you a very nice "Step-by-step guide 
for using C/C++ in R" which goes beyond "Writing R Extensions" document.

Otherwise, such questions should be posted to R-help, not Rd, please 
post correspondingly.

Best regards,
Oleg

Tom McCallum wrote:
> Hi Everyone,
> 
> I have a question about for loops.  If you have something like:
> 
> f <- function(x) {
> 	y <- rep(NA,10);
> 	for( i in 1:10 ) {
> 		if ( i > 3 ) {
> 			if ( is.na(y[i-3]) == FALSE ) {
> 				# some calculation F which depends on one or more of the previously  
> generated values in the series
> 				y[i] = y[i-1]+x[i];
> 			} else {
> 				y[i] <- x[i];
> 			}
> 		}
> 	}
> 	y
> }
> 
> e.g.
> 
>> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
>   [1] NA NA NA  4  5  6 13 21 30 40
> 
> is there a faster way to process this than with a 'for' loop?  I have  
> looked at lapply as well but I have read that lapply is no faster than a  
> for loop and for my particular application it is easier to use a for loop.  
> Also I have seen 'rle' which I think may help me but am not sure as I have  
> only just come across it, any ideas?
> 
> Many thanks
> 
> Tom
> 
> 
> 

-- 
Dr Oleg Sklyar * EBI/EMBL, Cambridge CB10 1SD, England * +44-1223-494466


From tpapp at Princeton.EDU  Tue Jan 30 15:46:06 2007
From: tpapp at Princeton.EDU (Tamas K Papp)
Date: Tue, 30 Jan 2007 15:46:06 +0100
Subject: [Rd] Speed of for loops
In-Reply-To: <45BF36E1.7050200@ebi.ac.uk>
References: <op.tmyqilgbffxks9@norisk> <45BF36E1.7050200@ebi.ac.uk>
Message-ID: <20070130144606.GA3241@pu100877.student.princeton.edu>

On Tue, Jan 30, 2007 at 12:15:29PM +0000, Oleg Sklyar wrote:

> magnitude using c-functions for "complex" vector indexing operations. If 
> you need instructions, I can send you a very nice "Step-by-step guide 
> for using C/C++ in R" which goes beyond "Writing R Extensions" document.

Hi Oleg,

Can you please post this guide online?  I think that many people would
be interested in reading it, incl. me.

Tamas


From osklyar at ebi.ac.uk  Tue Jan 30 16:27:30 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Tue, 30 Jan 2007 15:27:30 +0000
Subject: [Rd] Step-by-step guide for using C/C++ in R;
	WAS:  Speed of for loops
In-Reply-To: <20070130144606.GA3241@pu100877.student.princeton.edu>
References: <op.tmyqilgbffxks9@norisk> <45BF36E1.7050200@ebi.ac.uk>
	<20070130144606.GA3241@pu100877.student.princeton.edu>
Message-ID: <45BF63E2.3080804@ebi.ac.uk>

I know this should not go to [Rd], but the original post was there and 
the replies as well.

Thank you all who expressed interest in the "Step-by-step guide for 
using C/C++ in R"! Answering some of you, yes it is by me and was 
written to assist other group members to start adding c/c++ code to 
their R coding.

You can now download it from:

http://www.ebi.ac.uk/~osklyar/kb/CtoRinterfacingPrimer.pdf

I would also appreciate your comments if you find it useful or not, or 
maybe what can be added or modified. But not on the list, directly to my 
email please.

Best wishes,
Oleg

Tamas K Papp wrote:
> On Tue, Jan 30, 2007 at 12:15:29PM +0000, Oleg Sklyar wrote:
> 
>> magnitude using c-functions for "complex" vector indexing operations. If 
>> you need instructions, I can send you a very nice "Step-by-step guide 
>> for using C/C++ in R" which goes beyond "Writing R Extensions" document.
> 
> Hi Oleg,
> 
> Can you please post this guide online?  I think that many people would
> be interested in reading it, incl. me.
> 
> Tamas

-- 
Dr Oleg Sklyar * EBI/EMBL, Cambridge CB10 1SD, England * +44-1223-494466


From rdiaz at cnio.es  Tue Jan 30 17:57:24 2007
From: rdiaz at cnio.es (Ramon Diaz-Uriarte)
Date: Tue, 30 Jan 2007 17:57:24 +0100
Subject: [Rd] Speed of for loops
In-Reply-To: <20070130144606.GA3241@pu100877.student.princeton.edu>
References: <op.tmyqilgbffxks9@norisk> <45BF36E1.7050200@ebi.ac.uk>
	<20070130144606.GA3241@pu100877.student.princeton.edu>
Message-ID: <200701301757.24232.rdiaz@cnio.es>

On Tuesday 30 January 2007 15:46, Tamas K Papp wrote:
> On Tue, Jan 30, 2007 at 12:15:29PM +0000, Oleg Sklyar wrote:
> > magnitude using c-functions for "complex" vector indexing operations. If
> > you need instructions, I can send you a very nice "Step-by-step guide
> > for using C/C++ in R" which goes beyond "Writing R Extensions" document.
>
> Hi Oleg,
>
> Can you please post this guide online?  I think that many people would
> be interested in reading it, incl. me.
>

Me too.

Thanks,

R.

> Tamas
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Ram?n D?az-Uriarte
Centro Nacional de Investigaciones Oncol?gicas (CNIO)
(Spanish National Cancer Center)
Melchor Fern?ndez Almagro, 3
28029 Madrid (Spain)
Fax: +-34-91-224-6972
Phone: +-34-91-224-6900

http://ligarto.org/rdiaz
PGP KeyID: 0xE89B3462
(http://ligarto.org/rdiaz/0xE89B3462.asc)



**NOTA DE CONFIDENCIALIDAD** Este correo electr?nico, y en s...{{dropped}}


From efg at stowers-institute.org  Tue Jan 30 18:23:03 2007
From: efg at stowers-institute.org (Earl F. Glynn)
Date: Tue, 30 Jan 2007 11:23:03 -0600
Subject: [Rd] calloc bug in RODBC 1.1-7 and later?
Message-ID: <epnutn$tvp$1@sea.gmane.org>

I'm trying to load Affy Annotation data from an Access database into R using 
RODBC.  This has worked fine for quite some time.  The bug seems to be 
correlated to RODBC versions 1.1-7 and later.

Works fine:  R 2.2.0 with RODBC 1.1-4; R 2.3.0 or R 2.4.1 with RODBC 1.1-6
Fails:  R 2.3.1 with RDOBC 1.1-7; R 2.4.1 with RODC 1.1-7 or 1.1-8

Details
=====
This works fine:



Version 2.2.0  (2005-10-06 r35749)

Package:              RODBC

Version:              1.1-4

Date:                 2005-08-04



R Version 2.3.0 (2006-04-24) or R version 2.4.1 (2006-12-18)

Package:              RODBC

Version:              1.1-6

Date:                 2006-04-04



> library("RODBC")

> channel <- 
> odbcConnectAccess("S:/Bioinformatics/Software/Affy/Data/MOE430A/MOE430A.mdb")

> moe430a <- sqlFetch(channel,"Annotation", as.is=TRUE)

> odbcClose(channel)



> dim(moe430a)

[1] 22690    43



= = = = = = = = = =



calloc bug in RODBC 1.1-7 and later?



R Version 2.3.1 (2006-06-01)



Package:              RODBC

Version:              1.1-7

Date:                 2006-05-24



> library("RODBC")

> channel <- 
> odbcConnectAccess("S:/Bioinformatics/Software/Affy/Data/MOE430A/MOE430A.mdb")

> moe430a <- sqlFetch(channel,"Annotation", as.is=TRUE)

Error in odbcQuery(channel, query, rows_at_time) :

        Calloc could not allocate (67108864 of 1) memory

In addition: Warning message:

Reached total allocation of 1024Mb: see help(memory.size)





R version 2.4.1 (2006-12-18)



Package:              RODBC

Version:              1.1-8

Date:                 2007-01-02



> library("RODBC")

> channel <- 
> odbcConnectAccess("S:/Bioinformatics/Software/Affy/Data/MOE430A/MOE430A.mdb")

> moe430a <- sqlFetch(channel,"Annotation", as.is=TRUE)

Error in odbcQuery(channel, query, rows_at_time) :

        Calloc could not allocate (67108864 of 1) memory





The Access table is the MOE430A Affy Chip data from a CSV format from 
NetAffx

http://www.affymetrix.com/Auth/analysis/downloads/na21/ivt/MOE430A.na21.annot.csv.zip

loaded into Access:

http://research.stowers-institute.org/efg/ScientificSoftware/Applications/Affy/Annotations/index.htm


Is there a change I missed in RODBC 1.1-7?  What else should I do to 
troubleshoot this other than reverting to the older version of RODBC?

Thanks for any help with this.

Earl F. Glynn
Scientific Programmer
Stowers Institute for Medical Research


From Thomas.Petzoldt at TU-Dresden.de  Tue Jan 30 22:16:00 2007
From: Thomas.Petzoldt at TU-Dresden.de (Thomas Petzoldt)
Date: Tue, 30 Jan 2007 22:16:00 +0100
Subject: [Rd] S4 initialize or "generating function"
Message-ID: <45BFB590.3080405@TU-Dresden.de>

Hello,

apologies if I missed something well known. I'm just revising an own
package and wonder if it is still common to use "generating
functions" which have the same name as the corresponding S4 class as
suggested by Chambers, 2001. "Classes and Methods in the S Language".

-- or should one consequently use new and initialize to do such things?

Thank you

Thomas P.


From sfalcon at fhcrc.org  Tue Jan 30 23:07:59 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Tue, 30 Jan 2007 14:07:59 -0800
Subject: [Rd] "[" operator and indexing ambiguity
In-Reply-To: <45BA9D3B.9000504@ebi.ac.uk> (Oleg Sklyar's message of "Sat,
	27 Jan 2007 00:30:51 +0000")
References: <45BA9D3B.9000504@ebi.ac.uk>
Message-ID: <m2r6tcf9s0.fsf@fhcrc.org>

Oleg Sklyar <osklyar at ebi.ac.uk> writes:
> As Tony correctly writes one can generally use nargs() to get the number 
> of arguments, and this works for "["(x,i,j,...,drop) method as well. The 
> problem I had with the EBImage where I could not distinguish between 
> x[index] and x[index,,] is that somehow particularly for the "[" method 
> and particularly for 3 dimensions nargs in both cases gave me the same 
> number of arguments! This behavior was not present when the number of 
> dimension was 2 or 4, i.e. for x[index,] or x[index,,,] -- these could 
> be easily distinguished from x[index]. Anyway, maybe R changed since and 
> I just did not notice that :)

I too find R's behavior surprising when trying to define "[" methods
for S4 classes.  Here's an example where callNextMethod doesn't seem
to work for subclasses of array:

    setClass("MyArray", representation(name="character"),
             contains="array")
    
    setMethod("[", signature(x="MyArray"),
              function(x, i, j, ..., drop=FALSE) {
                  cat("num args: ", nargs(), "\n")
                  callNextMethod()
              })

    v <- array(1:10000, dim=c(10, 10, 10))
    mya <- new("MyArray", name="sam", v)

      > dim(mya)
      [1] 10 10 10

    # this works:
      > mya[3]
      num args:  2 
      [1] 3

    # but this does not:

      > mya[3, , ]
      num args:  4 
      Error in x[i = i, j = , , ...] : incorrect number of dimensions
      Error in callNextMethod() : error in evaluating a 'primitive' next method


+ seth


From hpages at fhcrc.org  Tue Jan 30 23:29:12 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Tue, 30 Jan 2007 14:29:12 -0800
Subject: [Rd] Speed of for loops
In-Reply-To: <op.tmyqilgbffxks9@norisk>
References: <op.tmyqilgbffxks9@norisk>
Message-ID: <45BFC6B8.8040101@fhcrc.org>

Tom McCallum wrote:
> Hi Everyone,
> 
> I have a question about for loops.  If you have something like:
> 
> f <- function(x) {
> 	y <- rep(NA,10);
> 	for( i in 1:10 ) {
> 		if ( i > 3 ) {
> 			if ( is.na(y[i-3]) == FALSE ) {
> 				# some calculation F which depends on one or more of the previously  
> generated values in the series
> 				y[i] = y[i-1]+x[i];
> 			} else {
> 				y[i] <- x[i];
> 			}
> 		}
> 	}
> 	y
> }
> 
> e.g.
> 
>> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
>   [1] NA NA NA  4  5  6 13 21 30 40
> 
> is there a faster way to process this than with a 'for' loop?  I have  
> looked at lapply as well but I have read that lapply is no faster than a  
> for loop and for my particular application it is easier to use a for loop.  
> Also I have seen 'rle' which I think may help me but am not sure as I have  
> only just come across it, any ideas?

Hi Tom,

In the general case, you need a loop in order to propagate calculations
and their results across a vector.

In _your_ particular case however, it seems that all you are doing is a
cumulative sum on x (at least this is what's happening for i >= 6).
So you could do:

f2 <- function(x)
{
    offset <- 3
    start_propagate_at <- 6
    y_length <- 10
    init_range <- (offset+1):start_propagate_at
    y <- rep(NA, offset)
    y[init_range] <- x[init_range]
    y[start_propagate_at:y_length] <- cumsum(x[start_propagate_at:y_length])
    y
}

and it will return the same thing as your function 'f' (at least when 'x' doesn't
contain NAs) but it's not faster :-/

IMO, using sapply for propagating calculations across a vector is not appropriate
because:

  (1) It requires special care. For example, this:

        > x <- 1:10
        > sapply(2:length(x), function(i) {x[i] <- x[i-1]+x[i]})

      doesn't work because the 'x' symbol on the left side of the <- in the
      anonymous function doesn't refer to the 'x' symbol defined in the global
      environment. So you need to use tricks like this:

        > sapply(2:length(x),
                 function(i) {x[i] <- x[i-1]+x[i]; assign("x", x, envir=.GlobalEnv); x[i]})

  (2) Because of this kind of tricks, then it is _very_ slow (about 10 times
      slower or more than a 'for' loop).

Cheers,
H.


> 
> Many thanks
> 
> Tom
> 
> 
>


From byron.ellis at gmail.com  Wed Jan 31 00:23:56 2007
From: byron.ellis at gmail.com (Byron Ellis)
Date: Tue, 30 Jan 2007 15:23:56 -0800
Subject: [Rd] Speed of for loops
In-Reply-To: <45BFC6B8.8040101@fhcrc.org>
References: <op.tmyqilgbffxks9@norisk> <45BFC6B8.8040101@fhcrc.org>
Message-ID: <7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>

Actually, why not use a closure to store previous value(s)?

In the simple case, which depends on x_i and y_{i-1}

gen.iter = function(x) {
    y = NA
    function(i) {
       y <<- if(is.na(y)) x[i] else y+x[i]
    }
}

y = sapply(1:10,gen.iter(x))

Obviously you can modify the function for the bookkeeping required to
manage whatever lag you need. I use this sometimes when I'm
implementing MCMC samplers of various kinds.


On 1/30/07, Herve Pages <hpages at fhcrc.org> wrote:
> Tom McCallum wrote:
> > Hi Everyone,
> >
> > I have a question about for loops.  If you have something like:
> >
> > f <- function(x) {
> >       y <- rep(NA,10);
> >       for( i in 1:10 ) {
> >               if ( i > 3 ) {
> >                       if ( is.na(y[i-3]) == FALSE ) {
> >                               # some calculation F which depends on one or more of the previously
> > generated values in the series
> >                               y[i] = y[i-1]+x[i];
> >                       } else {
> >                               y[i] <- x[i];
> >                       }
> >               }
> >       }
> >       y
> > }
> >
> > e.g.
> >
> >> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
> >   [1] NA NA NA  4  5  6 13 21 30 40
> >
> > is there a faster way to process this than with a 'for' loop?  I have
> > looked at lapply as well but I have read that lapply is no faster than a
> > for loop and for my particular application it is easier to use a for loop.
> > Also I have seen 'rle' which I think may help me but am not sure as I have
> > only just come across it, any ideas?
>
> Hi Tom,
>
> In the general case, you need a loop in order to propagate calculations
> and their results across a vector.
>
> In _your_ particular case however, it seems that all you are doing is a
> cumulative sum on x (at least this is what's happening for i >= 6).
> So you could do:
>
> f2 <- function(x)
> {
>     offset <- 3
>     start_propagate_at <- 6
>     y_length <- 10
>     init_range <- (offset+1):start_propagate_at
>     y <- rep(NA, offset)
>     y[init_range] <- x[init_range]
>     y[start_propagate_at:y_length] <- cumsum(x[start_propagate_at:y_length])
>     y
> }
>
> and it will return the same thing as your function 'f' (at least when 'x' doesn't
> contain NAs) but it's not faster :-/
>
> IMO, using sapply for propagating calculations across a vector is not appropriate
> because:
>
>   (1) It requires special care. For example, this:
>
>         > x <- 1:10
>         > sapply(2:length(x), function(i) {x[i] <- x[i-1]+x[i]})
>
>       doesn't work because the 'x' symbol on the left side of the <- in the
>       anonymous function doesn't refer to the 'x' symbol defined in the global
>       environment. So you need to use tricks like this:
>
>         > sapply(2:length(x),
>                  function(i) {x[i] <- x[i-1]+x[i]; assign("x", x, envir=.GlobalEnv); x[i]})
>
>   (2) Because of this kind of tricks, then it is _very_ slow (about 10 times
>       slower or more than a 'for' loop).
>
> Cheers,
> H.
>
>
> >
> > Many thanks
> >
> > Tom
> >
> >
> >
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From byron.ellis at gmail.com  Wed Jan 31 00:25:16 2007
From: byron.ellis at gmail.com (Byron Ellis)
Date: Tue, 30 Jan 2007 15:25:16 -0800
Subject: [Rd] Speed of for loops
In-Reply-To: <7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>
References: <op.tmyqilgbffxks9@norisk> <45BFC6B8.8040101@fhcrc.org>
	<7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>
Message-ID: <7098abec0701301525g718540d3j958799261c6f9cf3@mail.gmail.com>

Actually, better yet:

gen.iter = function(y=NA) {
  function(x) {
    y <<- if(is.na(y)) x else x+y
  }
}
sapply(x,gen.iter())


On 1/30/07, Byron Ellis <byron.ellis at gmail.com> wrote:
> Actually, why not use a closure to store previous value(s)?
>
> In the simple case, which depends on x_i and y_{i-1}
>
> gen.iter = function(x) {
>     y = NA
>     function(i) {
>        y <<- if(is.na(y)) x[i] else y+x[i]
>     }
> }
>
> y = sapply(1:10,gen.iter(x))
>
> Obviously you can modify the function for the bookkeeping required to
> manage whatever lag you need. I use this sometimes when I'm
> implementing MCMC samplers of various kinds.
>
>
> On 1/30/07, Herve Pages <hpages at fhcrc.org> wrote:
> > Tom McCallum wrote:
> > > Hi Everyone,
> > >
> > > I have a question about for loops.  If you have something like:
> > >
> > > f <- function(x) {
> > >       y <- rep(NA,10);
> > >       for( i in 1:10 ) {
> > >               if ( i > 3 ) {
> > >                       if ( is.na(y[i-3]) == FALSE ) {
> > >                               # some calculation F which depends on one or more of the previously
> > > generated values in the series
> > >                               y[i] = y[i-1]+x[i];
> > >                       } else {
> > >                               y[i] <- x[i];
> > >                       }
> > >               }
> > >       }
> > >       y
> > > }
> > >
> > > e.g.
> > >
> > >> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
> > >   [1] NA NA NA  4  5  6 13 21 30 40
> > >
> > > is there a faster way to process this than with a 'for' loop?  I have
> > > looked at lapply as well but I have read that lapply is no faster than a
> > > for loop and for my particular application it is easier to use a for loop.
> > > Also I have seen 'rle' which I think may help me but am not sure as I have
> > > only just come across it, any ideas?
> >
> > Hi Tom,
> >
> > In the general case, you need a loop in order to propagate calculations
> > and their results across a vector.
> >
> > In _your_ particular case however, it seems that all you are doing is a
> > cumulative sum on x (at least this is what's happening for i >= 6).
> > So you could do:
> >
> > f2 <- function(x)
> > {
> >     offset <- 3
> >     start_propagate_at <- 6
> >     y_length <- 10
> >     init_range <- (offset+1):start_propagate_at
> >     y <- rep(NA, offset)
> >     y[init_range] <- x[init_range]
> >     y[start_propagate_at:y_length] <- cumsum(x[start_propagate_at:y_length])
> >     y
> > }
> >
> > and it will return the same thing as your function 'f' (at least when 'x' doesn't
> > contain NAs) but it's not faster :-/
> >
> > IMO, using sapply for propagating calculations across a vector is not appropriate
> > because:
> >
> >   (1) It requires special care. For example, this:
> >
> >         > x <- 1:10
> >         > sapply(2:length(x), function(i) {x[i] <- x[i-1]+x[i]})
> >
> >       doesn't work because the 'x' symbol on the left side of the <- in the
> >       anonymous function doesn't refer to the 'x' symbol defined in the global
> >       environment. So you need to use tricks like this:
> >
> >         > sapply(2:length(x),
> >                  function(i) {x[i] <- x[i-1]+x[i]; assign("x", x, envir=.GlobalEnv); x[i]})
> >
> >   (2) Because of this kind of tricks, then it is _very_ slow (about 10 times
> >       slower or more than a 'for' loop).
> >
> > Cheers,
> > H.
> >
> >
> > >
> > > Many thanks
> > >
> > > Tom
> > >
> > >
> > >
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>
>
> --
> Byron Ellis (byron.ellis at gmail.com)
> "Oook" -- The Librarian
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From osklyar at ebi.ac.uk  Wed Jan 31 00:42:27 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Tue, 30 Jan 2007 23:42:27 +0000
Subject: [Rd] Speed of for loops
In-Reply-To: <7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>
References: <op.tmyqilgbffxks9@norisk> <45BFC6B8.8040101@fhcrc.org>
	<7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>
Message-ID: <45BFD7E3.7040708@ebi.ac.uk>

It is surely an elegant way of doing things (although far from being 
easy to parse visually) but is it really faster than a loop?

After all, the indexing problem is the same and sapply simply does the 
same job as for in this case, plus "<<-" will _search_ through the 
environment on every single step. Where is the gain?

Oleg

--
Dr Oleg Sklyar | EBI-EMBL, Cambridge CB10 1SD, UK | +44-1223-494466


Byron Ellis wrote:
> Actually, why not use a closure to store previous value(s)?
> 
> In the simple case, which depends on x_i and y_{i-1}
> 
> gen.iter = function(x) {
>     y = NA
>     function(i) {
>        y <<- if(is.na(y)) x[i] else y+x[i]
>     }
> }
> 
> y = sapply(1:10,gen.iter(x))
> 
> Obviously you can modify the function for the bookkeeping required to
> manage whatever lag you need. I use this sometimes when I'm
> implementing MCMC samplers of various kinds.
> 
> 
> On 1/30/07, Herve Pages <hpages at fhcrc.org> wrote:
>> Tom McCallum wrote:
>>> Hi Everyone,
>>>
>>> I have a question about for loops.  If you have something like:
>>>
>>> f <- function(x) {
>>>       y <- rep(NA,10);
>>>       for( i in 1:10 ) {
>>>               if ( i > 3 ) {
>>>                       if ( is.na(y[i-3]) == FALSE ) {
>>>                               # some calculation F which depends on one or more of the previously
>>> generated values in the series
>>>                               y[i] = y[i-1]+x[i];
>>>                       } else {
>>>                               y[i] <- x[i];
>>>                       }
>>>               }
>>>       }
>>>       y
>>> }
>>>
>>> e.g.
>>>
>>>> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
>>>   [1] NA NA NA  4  5  6 13 21 30 40
>>>
>>> is there a faster way to process this than with a 'for' loop?  I have
>>> looked at lapply as well but I have read that lapply is no faster than a
>>> for loop and for my particular application it is easier to use a for loop.
>>> Also I have seen 'rle' which I think may help me but am not sure as I have
>>> only just come across it, any ideas?
>> Hi Tom,
>>
>> In the general case, you need a loop in order to propagate calculations
>> and their results across a vector.
>>
>> In _your_ particular case however, it seems that all you are doing is a
>> cumulative sum on x (at least this is what's happening for i >= 6).
>> So you could do:
>>
>> f2 <- function(x)
>> {
>>     offset <- 3
>>     start_propagate_at <- 6
>>     y_length <- 10
>>     init_range <- (offset+1):start_propagate_at
>>     y <- rep(NA, offset)
>>     y[init_range] <- x[init_range]
>>     y[start_propagate_at:y_length] <- cumsum(x[start_propagate_at:y_length])
>>     y
>> }
>>
>> and it will return the same thing as your function 'f' (at least when 'x' doesn't
>> contain NAs) but it's not faster :-/
>>
>> IMO, using sapply for propagating calculations across a vector is not appropriate
>> because:
>>
>>   (1) It requires special care. For example, this:
>>
>>         > x <- 1:10
>>         > sapply(2:length(x), function(i) {x[i] <- x[i-1]+x[i]})
>>
>>       doesn't work because the 'x' symbol on the left side of the <- in the
>>       anonymous function doesn't refer to the 'x' symbol defined in the global
>>       environment. So you need to use tricks like this:
>>
>>         > sapply(2:length(x),
>>                  function(i) {x[i] <- x[i-1]+x[i]; assign("x", x, envir=.GlobalEnv); x[i]})
>>
>>   (2) Because of this kind of tricks, then it is _very_ slow (about 10 times
>>       slower or more than a 'for' loop).
>>
>> Cheers,
>> H.
>>
>>
>>> Many thanks
>>>
>>> Tom
>>>
>>>
>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
>


From byron.ellis at gmail.com  Wed Jan 31 01:01:59 2007
From: byron.ellis at gmail.com (Byron Ellis)
Date: Tue, 30 Jan 2007 16:01:59 -0800
Subject: [Rd] Speed of for loops
In-Reply-To: <45BFD7E3.7040708@ebi.ac.uk>
References: <op.tmyqilgbffxks9@norisk> <45BFC6B8.8040101@fhcrc.org>
	<7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>
	<45BFD7E3.7040708@ebi.ac.uk>
Message-ID: <7098abec0701301601h6286328aic50043f94601c04a@mail.gmail.com>

IIRC a for loop has more per-iteration overhead that lapply, but the
real answer is "it depends on what you're doing exactly." I've seen it
be a faster, slower and equal approach.

On 1/30/07, Oleg Sklyar <osklyar at ebi.ac.uk> wrote:
> It is surely an elegant way of doing things (although far from being
> easy to parse visually) but is it really faster than a loop?
>
> After all, the indexing problem is the same and sapply simply does the
> same job as for in this case, plus "<<-" will _search_ through the
> environment on every single step. Where is the gain?
>
> Oleg
>
> --
> Dr Oleg Sklyar | EBI-EMBL, Cambridge CB10 1SD, UK | +44-1223-494466
>
>
> Byron Ellis wrote:
> > Actually, why not use a closure to store previous value(s)?
> >
> > In the simple case, which depends on x_i and y_{i-1}
> >
> > gen.iter = function(x) {
> >     y = NA
> >     function(i) {
> >        y <<- if(is.na(y)) x[i] else y+x[i]
> >     }
> > }
> >
> > y = sapply(1:10,gen.iter(x))
> >
> > Obviously you can modify the function for the bookkeeping required to
> > manage whatever lag you need. I use this sometimes when I'm
> > implementing MCMC samplers of various kinds.
> >
> >
> > On 1/30/07, Herve Pages <hpages at fhcrc.org> wrote:
> >> Tom McCallum wrote:
> >>> Hi Everyone,
> >>>
> >>> I have a question about for loops.  If you have something like:
> >>>
> >>> f <- function(x) {
> >>>       y <- rep(NA,10);
> >>>       for( i in 1:10 ) {
> >>>               if ( i > 3 ) {
> >>>                       if ( is.na(y[i-3]) == FALSE ) {
> >>>                               # some calculation F which depends on one or more of the previously
> >>> generated values in the series
> >>>                               y[i] = y[i-1]+x[i];
> >>>                       } else {
> >>>                               y[i] <- x[i];
> >>>                       }
> >>>               }
> >>>       }
> >>>       y
> >>> }
> >>>
> >>> e.g.
> >>>
> >>>> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
> >>>   [1] NA NA NA  4  5  6 13 21 30 40
> >>>
> >>> is there a faster way to process this than with a 'for' loop?  I have
> >>> looked at lapply as well but I have read that lapply is no faster than a
> >>> for loop and for my particular application it is easier to use a for loop.
> >>> Also I have seen 'rle' which I think may help me but am not sure as I have
> >>> only just come across it, any ideas?
> >> Hi Tom,
> >>
> >> In the general case, you need a loop in order to propagate calculations
> >> and their results across a vector.
> >>
> >> In _your_ particular case however, it seems that all you are doing is a
> >> cumulative sum on x (at least this is what's happening for i >= 6).
> >> So you could do:
> >>
> >> f2 <- function(x)
> >> {
> >>     offset <- 3
> >>     start_propagate_at <- 6
> >>     y_length <- 10
> >>     init_range <- (offset+1):start_propagate_at
> >>     y <- rep(NA, offset)
> >>     y[init_range] <- x[init_range]
> >>     y[start_propagate_at:y_length] <- cumsum(x[start_propagate_at:y_length])
> >>     y
> >> }
> >>
> >> and it will return the same thing as your function 'f' (at least when 'x' doesn't
> >> contain NAs) but it's not faster :-/
> >>
> >> IMO, using sapply for propagating calculations across a vector is not appropriate
> >> because:
> >>
> >>   (1) It requires special care. For example, this:
> >>
> >>         > x <- 1:10
> >>         > sapply(2:length(x), function(i) {x[i] <- x[i-1]+x[i]})
> >>
> >>       doesn't work because the 'x' symbol on the left side of the <- in the
> >>       anonymous function doesn't refer to the 'x' symbol defined in the global
> >>       environment. So you need to use tricks like this:
> >>
> >>         > sapply(2:length(x),
> >>                  function(i) {x[i] <- x[i-1]+x[i]; assign("x", x, envir=.GlobalEnv); x[i]})
> >>
> >>   (2) Because of this kind of tricks, then it is _very_ slow (about 10 times
> >>       slower or more than a 'for' loop).
> >>
> >> Cheers,
> >> H.
> >>
> >>
> >>> Many thanks
> >>>
> >>> Tom
> >>>
> >>>
> >>>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From hpages at fhcrc.org  Wed Jan 31 01:44:58 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Tue, 30 Jan 2007 16:44:58 -0800
Subject: [Rd] Speed of for loops
In-Reply-To: <7098abec0701301601h6286328aic50043f94601c04a@mail.gmail.com>
References: <op.tmyqilgbffxks9@norisk>
	<45BFC6B8.8040101@fhcrc.org>	<7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>	<45BFD7E3.7040708@ebi.ac.uk>
	<7098abec0701301601h6286328aic50043f94601c04a@mail.gmail.com>
Message-ID: <45BFE68A.1090701@fhcrc.org>

Hi,

Byron Ellis wrote:
> IIRC a for loop has more per-iteration overhead that lapply, but the
> real answer is "it depends on what you're doing exactly." I've seen it
> be a faster, slower and equal approach.

gen.iter = function(y=NA) {
 function(x) {
   y <<- if(is.na(y)) x else x+y
 }
}

sapply + gen.iter is slithly faster on small vectors:

  > x <- rep(1, 5000)
  > system.time(tt <- sapply(x,gen.iter()))
     user  system elapsed
    0.012   0.000   0.012
  > x <- rep(1, 5000)
  > system.time(tt <- for(i in 2:length(x)) {x[i] <- x[i-1]+x[i]})
     user  system elapsed
    0.016   0.000   0.016

but much slower on big vectors:

  > x <- rep(1, 10000000)
  > system.time(tt <- sapply(x,gen.iter()))
     user  system elapsed
  138.589   0.964 139.633
  > x <- rep(1, 10000000)
  > system.time(tt <- for(i in 2:length(x)) {x[i] <- x[i-1]+x[i]})
     user  system elapsed
   29.978   0.480  30.454


Cheers,
H.


From jtxx000 at gmail.com  Wed Jan 31 02:50:56 2007
From: jtxx000 at gmail.com (jtxx000)
Date: Tue, 30 Jan 2007 20:50:56 -0500
Subject: [Rd] PGF Device
Message-ID: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>

Greetings all,
PGF is a package for LaTeX which works with both ps
and pdf output without any nasty hacks like pictex.
Is there any technical reason why there could not be a
PGF graphic device for R?  If not, I'm going to try to
throw one together.  Any tips for getting started?

Cheers,
Caleb


From Bill.Venables at csiro.au  Wed Jan 31 02:52:27 2007
From: Bill.Venables at csiro.au (Bill.Venables at csiro.au)
Date: Wed, 31 Jan 2007 11:52:27 +1000
Subject: [Rd] segments and arrows generic?
References: <45BE7D11.60108@fhcrc.org>
Message-ID: <B998A44C8986644EA8029CFE6396A924840CBA@exqld2-bne.qld.csiro.au>

Has anyone ever suggested making segments() and arrows() generic (as
indeed they are in another not dissimilar implementation)?

The practical issue with these functions is the need to specify origin
and destination using four separate arguments.  It would be much more
convenient to use only two.  If segments were (S4) generic, for example,
you could write methods for 

signature(x0 = "matrix", y0 = "matrix", x1 = "missing", y1 = "missing")
signature(x0 = "complex", y0 = "complex", x1 = "missing", y1 =
"missing")

With the present function as the default method, no existing working
code would be affected.

Bill Venables


From Karl.Hufthammer at mi.uib.no  Wed Jan 31 11:23:25 2007
From: Karl.Hufthammer at mi.uib.no (Karl Ove Hufthammer)
Date: Wed, 31 Jan 2007 11:23:25 +0100
Subject: [Rd] PGF Device
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
Message-ID: <eppqmt$lo9$1@sea.gmane.org>

jtxx000 skreiv:

> PGF is a package for LaTeX which works with both ps
> and pdf output without any nasty hacks like pictex.
> Is there any technical reason why there could not be a
> PGF graphic device for R?

Not that I can think of. PGF is certainly powerful enough 
for this.

> If not, I'm going to try to throw one together.

Sounds wonderful. I am sure this will be useful for a lot 
of people.

-- 
Karl Ove Hufthammer


From murdoch at stats.uwo.ca  Wed Jan 31 13:29:59 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 31 Jan 2007 07:29:59 -0500
Subject: [Rd] PGF Device
In-Reply-To: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
Message-ID: <45C08BC7.4030305@stats.uwo.ca>

On 1/30/2007 8:50 PM, jtxx000 wrote:
> Greetings all,
> PGF is a package for LaTeX which works with both ps
> and pdf output without any nasty hacks like pictex.
> Is there any technical reason why there could not be a
> PGF graphic device for R?  If not, I'm going to try to
> throw one together.  Any tips for getting started?

The existing drivers are in the grDevices package.  I would start with 
one of those (the picTeX driver would probably be most similar) and go 
from there.  Alternatively, start from devNULL.c and fill in the blanks.

Someone else may be able to offer advice about whether you should be 
targetting this to be your own package, or for inclusion in the R
source.  In the past it's been impossible to create a driver in a 
package, and there's been talk about adding enough to the API to allow 
this, but I don't know whether that's in place yet.

Duncan Murdoch


From tom.mccallum at levelelimited.com  Wed Jan 31 13:35:15 2007
From: tom.mccallum at levelelimited.com (Tom McCallum)
Date: Wed, 31 Jan 2007 12:35:15 -0000
Subject: [Rd] Speed of for loops
In-Reply-To: <45BFD7E3.7040708@ebi.ac.uk>
References: <op.tmyqilgbffxks9@norisk> <45BFC6B8.8040101@fhcrc.org>
	<7098abec0701301523u8c06819nd896cb78f5ede73a@mail.gmail.com>
	<45BFD7E3.7040708@ebi.ac.uk>
Message-ID: <op.tm0qk1daffxks9@norisk>

Thank you all for your advice and tips.  In the end, I think the for loop  
is the easiest way forward due to other requirements but its good to know  
that I haven't missed anything too obvious.

Tom

On Tue, 30 Jan 2007 23:42:27 -0000, Oleg Sklyar <osklyar at ebi.ac.uk> wrote:

> It is surely an elegant way of doing things (although far from being
> easy to parse visually) but is it really faster than a loop?
>
> After all, the indexing problem is the same and sapply simply does the
> same job as for in this case, plus "<<-" will _search_ through the
> environment on every single step. Where is the gain?
>
> Oleg
>
> --
> Dr Oleg Sklyar | EBI-EMBL, Cambridge CB10 1SD, UK | +44-1223-494466
>
>
> Byron Ellis wrote:
>> Actually, why not use a closure to store previous value(s)?
>>
>> In the simple case, which depends on x_i and y_{i-1}
>>
>> gen.iter = function(x) {
>>     y = NA
>>     function(i) {
>>        y <<- if(is.na(y)) x[i] else y+x[i]
>>     }
>> }
>>
>> y = sapply(1:10,gen.iter(x))
>>
>> Obviously you can modify the function for the bookkeeping required to
>> manage whatever lag you need. I use this sometimes when I'm
>> implementing MCMC samplers of various kinds.
>>
>>
>> On 1/30/07, Herve Pages <hpages at fhcrc.org> wrote:
>>> Tom McCallum wrote:
>>>> Hi Everyone,
>>>>
>>>> I have a question about for loops.  If you have something like:
>>>>
>>>> f <- function(x) {
>>>>       y <- rep(NA,10);
>>>>       for( i in 1:10 ) {
>>>>               if ( i > 3 ) {
>>>>                       if ( is.na(y[i-3]) == FALSE ) {
>>>>                               # some calculation F which depends on  
>>>> one or more of the previously
>>>> generated values in the series
>>>>                               y[i] = y[i-1]+x[i];
>>>>                       } else {
>>>>                               y[i] <- x[i];
>>>>                       }
>>>>               }
>>>>       }
>>>>       y
>>>> }
>>>>
>>>> e.g.
>>>>
>>>>> f(c(1,2,3,4,5,6,7,8,9,10,11,12));
>>>>   [1] NA NA NA  4  5  6 13 21 30 40
>>>>
>>>> is there a faster way to process this than with a 'for' loop?  I have
>>>> looked at lapply as well but I have read that lapply is no faster  
>>>> than a
>>>> for loop and for my particular application it is easier to use a for  
>>>> loop.
>>>> Also I have seen 'rle' which I think may help me but am not sure as I  
>>>> have
>>>> only just come across it, any ideas?
>>> Hi Tom,
>>>
>>> In the general case, you need a loop in order to propagate calculations
>>> and their results across a vector.
>>>
>>> In _your_ particular case however, it seems that all you are doing is a
>>> cumulative sum on x (at least this is what's happening for i >= 6).
>>> So you could do:
>>>
>>> f2 <- function(x)
>>> {
>>>     offset <- 3
>>>     start_propagate_at <- 6
>>>     y_length <- 10
>>>     init_range <- (offset+1):start_propagate_at
>>>     y <- rep(NA, offset)
>>>     y[init_range] <- x[init_range]
>>>     y[start_propagate_at:y_length] <-  
>>> cumsum(x[start_propagate_at:y_length])
>>>     y
>>> }
>>>
>>> and it will return the same thing as your function 'f' (at least when  
>>> 'x' doesn't
>>> contain NAs) but it's not faster :-/
>>>
>>> IMO, using sapply for propagating calculations across a vector is not  
>>> appropriate
>>> because:
>>>
>>>   (1) It requires special care. For example, this:
>>>
>>>         > x <- 1:10
>>>         > sapply(2:length(x), function(i) {x[i] <- x[i-1]+x[i]})
>>>
>>>       doesn't work because the 'x' symbol on the left side of the <-  
>>> in the
>>>       anonymous function doesn't refer to the 'x' symbol defined in  
>>> the global
>>>       environment. So you need to use tricks like this:
>>>
>>>         > sapply(2:length(x),
>>>                  function(i) {x[i] <- x[i-1]+x[i]; assign("x", x,  
>>> envir=.GlobalEnv); x[i]})
>>>
>>>   (2) Because of this kind of tricks, then it is _very_ slow (about 10  
>>> times
>>>       slower or more than a 'for' loop).
>>>
>>> Cheers,
>>> H.
>>>
>>>
>>>> Many thanks
>>>>
>>>> Tom
>>>>
>>>>
>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Dr. Thomas McCallum
Systems Architect,
Level E Limited
ETTC, The King's Buildings
Mayfield Road,
Edinburgh EH9 3JL, UK
Work  +44 (0) 131 472 4813
Fax:  +44 (0) 131 472 4719
http://www.levelelimited.com
Email: tom at levelelimited.com

Level E is a limited company incorporated in Scotland. The c...{{dropped}}


From ripley at stats.ox.ac.uk  Wed Jan 31 14:49:22 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 31 Jan 2007 13:49:22 +0000 (GMT)
Subject: [Rd] PGF Device
In-Reply-To: <45C08BC7.4030305@stats.uwo.ca>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
	<45C08BC7.4030305@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>

On Wed, 31 Jan 2007, Duncan Murdoch wrote:

> On 1/30/2007 8:50 PM, jtxx000 wrote:
>> Greetings all,
>> PGF is a package for LaTeX which works with both ps
>> and pdf output without any nasty hacks like pictex.
>> Is there any technical reason why there could not be a
>> PGF graphic device for R?  If not, I'm going to try to
>> throw one together.  Any tips for getting started?
>
> The existing drivers are in the grDevices package.  I would start with
> one of those (the picTeX driver would probably be most similar) and go
> from there.  Alternatively, start from devNULL.c and fill in the blanks.

Please don't start from pictex (it is only half implemented, including no 
real font metrics).  If you need Type1 fonts, I suggest you start from the 
postscript/PDF driver.

> Someone else may be able to offer advice about whether you should be
> targetting this to be your own package, or for inclusion in the R
> source.  In the past it's been impossible to create a driver in a
> package, and there's been talk about adding enough to the API to allow
> this, but I don't know whether that's in place yet.

There are several devices in packages, and this has been possible since at 
least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but 
old Gtk), GNOMEdevice (never finished) and an SVG driver 
(http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on 
CRAN, the quartz device in the R.app front-end, and others.

Paul Murrell used to have a list of known graphics devices, but I was 
unable to locate it quickly.

I've written several devices, including pdf(), xfig() and versions of 
png() etc.  The hard part is getting text and font metrics working: also 
nowadays you need to be prepared to handle UTF-8 text and CJK locales, 
which many graphic systems are not up to speed on (including postscript, 
pdf and latex).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Jan 31 15:08:57 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 31 Jan 2007 14:08:57 +0000 (GMT)
Subject: [Rd] PGF Device
In-Reply-To: <Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
	<45C08BC7.4030305@stats.uwo.ca>
	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0701311401200.17807@gannet.stats.ox.ac.uk>

On Wed, 31 Jan 2007, Prof Brian Ripley wrote:

> On Wed, 31 Jan 2007, Duncan Murdoch wrote:
>
>> On 1/30/2007 8:50 PM, jtxx000 wrote:
>>> Greetings all,
>>> PGF is a package for LaTeX which works with both ps
>>> and pdf output without any nasty hacks like pictex.
>>> Is there any technical reason why there could not be a
>>> PGF graphic device for R?  If not, I'm going to try to
>>> throw one together.  Any tips for getting started?
>>
>> The existing drivers are in the grDevices package.  I would start with
>> one of those (the picTeX driver would probably be most similar) and go
>> from there.  Alternatively, start from devNULL.c and fill in the blanks.
>
> Please don't start from pictex (it is only half implemented, including no
> real font metrics).  If you need Type1 fonts, I suggest you start from the
> postscript/PDF driver.
>
>> Someone else may be able to offer advice about whether you should be
>> targetting this to be your own package, or for inclusion in the R
>> source.  In the past it's been impossible to create a driver in a
>> package, and there's been talk about adding enough to the API to allow
>> this, but I don't know whether that's in place yet.
>
> There are several devices in packages, and this has been possible since at
> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but
> old Gtk), GNOMEdevice (never finished) and an SVG driver
> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on
> CRAN, the quartz device in the R.app front-end, and others.
>
> Paul Murrell used to have a list of known graphics devices, but I was
> unable to locate it quickly.

http://www.stat.auckland.ac.nz/~paul/R/devices.html

There is also GDD on CRAN, and RJavaDevice and RwxDevice on Omegahat.

[...]

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Wed Jan 31 15:12:09 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 31 Jan 2007 09:12:09 -0500
Subject: [Rd] PGF Device
In-Reply-To: <Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
	<45C08BC7.4030305@stats.uwo.ca>
	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
Message-ID: <45C0A3B9.2070808@stats.uwo.ca>

On 1/31/2007 8:49 AM, Prof Brian Ripley wrote:
> On Wed, 31 Jan 2007, Duncan Murdoch wrote:
> 
>> On 1/30/2007 8:50 PM, jtxx000 wrote:
>>> Greetings all,
>>> PGF is a package for LaTeX which works with both ps
>>> and pdf output without any nasty hacks like pictex.
>>> Is there any technical reason why there could not be a
>>> PGF graphic device for R?  If not, I'm going to try to
>>> throw one together.  Any tips for getting started?
>>
>> The existing drivers are in the grDevices package.  I would start with
>> one of those (the picTeX driver would probably be most similar) and go
>> from there.  Alternatively, start from devNULL.c and fill in the blanks.
> 
> Please don't start from pictex (it is only half implemented, including no 
> real font metrics).  If you need Type1 fonts, I suggest you start from the 
> postscript/PDF driver.
> 
>> Someone else may be able to offer advice about whether you should be
>> targetting this to be your own package, or for inclusion in the R
>> source.  In the past it's been impossible to create a driver in a
>> package, and there's been talk about adding enough to the API to allow
>> this, but I don't know whether that's in place yet.
> 
> There are several devices in packages, and this has been possible since at 
> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but 
> old Gtk), GNOMEdevice (never finished) and an SVG driver 
> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on 
> CRAN, the quartz device in the R.app front-end, and others.

Yes, I must have been thinking about connections.  Just for the record, 
is it possible to create a new connection type in a package?

Duncan Murdoch

> 
> Paul Murrell used to have a list of known graphics devices, but I was 
> unable to locate it quickly.
> 
> I've written several devices, including pdf(), xfig() and versions of 
> png() etc.  The hard part is getting text and font metrics working: also 
> nowadays you need to be prepared to handle UTF-8 text and CJK locales, 
> which many graphic systems are not up to speed on (including postscript, 
> pdf and latex).
>


From tpapp at Princeton.EDU  Wed Jan 31 15:50:39 2007
From: tpapp at Princeton.EDU (Tamas K Papp)
Date: Wed, 31 Jan 2007 15:50:39 +0100
Subject: [Rd] possible bug: dev.copy / could not find any X11 fonts
Message-ID: <20070131145039.GA12289@pu100877.student.princeton.edu>

Hi,

I am experiencing something strange, and thought I would ask before
reporting a bug.  I trimmed it down to a self-contained example,
attached as an R file.  The purpose of the functions is to save the
plots into a ps file and simultaneously plot them on an x11 device,
but don't open a new one if there is already one opened (I don't want
the repositioning / flicker).

When running the code:

> source("plotf.r")
> plotf(avc,1)
Error in dev.copy(which = x11dev) : could not find any X11 fonts
Check that the Font Path is correct.

The error message reappears whenever I switch to the plot window.  A
partial plot is in the x11 window.

When called in other contexts, plotting functions work perfectly, so I
don't see what the problem is.

Thanks,

Tamas


version information:
               _                           
platform       i486-pc-linux-gnu           
arch           i486                        
os             linux-gnu                   
system         i486, linux-gnu             
status                                     
major          2                           
minor          4.1                         
year           2006                        
month          12                          
day            18                          
svn rev        40228                       
language       R                           
version.string R version 2.4.1 (2006-12-18)
-------------- next part --------------
a <- 1:5
avc <- list(v=a,cons=a,saving=a)

findx11dev <- function(create=TRUE) {
  devices <- dev.list()
  x11dev <- which(names(devices)=="X11")
  if (length(x11dev)==0) {
    if (create) {
      x11()
      dev.cur()
    } else {
      NULL
    }
  } else {
    devices[tail(x11dev,1)]
  }
}

plotf <- function(avc,k,...) {
  plotm <- function(m, ...)
    plot(1:5,m,type="l",...)
  ## open ps device
  postscript(sprintf("plot-%03d.eps",k))
  psdev <- dev.cur()
  dev.control("enable")
  ## plot
  layout(1:3)
  plotm(avc$v, main="value", ylab="v")
  plotm(avc$cons, main="consumption", ylab="c")
  plotm(avc$saving, main="saving", ylab="s")
  ## copy & close ps device
  x11dev <- findx11dev()
  dev.set(psdev)
  dev.copy(which=x11dev)
  dev.off(psdev)  
}

From sfalcon at fhcrc.org  Wed Jan 31 16:04:11 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 31 Jan 2007 07:04:11 -0800
Subject: [Rd] S4 initialize or "generating function"
In-Reply-To: <45BFB590.3080405@TU-Dresden.de> (Thomas Petzoldt's message of
	"Tue, 30 Jan 2007 22:16:00 +0100")
References: <45BFB590.3080405@TU-Dresden.de>
Message-ID: <m2r6tbdyqc.fsf@fhcrc.org>

Thomas Petzoldt <Thomas.Petzoldt at TU-Dresden.de> writes:

> Hello,
>
> apologies if I missed something well known. I'm just revising an own
> package and wonder if it is still common to use "generating
> functions" which have the same name as the corresponding S4 class as
> suggested by Chambers, 2001. "Classes and Methods in the S Language".
>
> -- or should one consequently use new and initialize to do such
>    things?

If you have no inheritence between the classes in your system (and are
pretty sure you are not going to have any) then I don't think it
really matters whether you define MyClass() to create new instances or
use new("MyClass",...).

There is considerable advantage to having your constructors be real
methods when you do have inheritence relations among your classes.
This allows you to make use of callNextMethod to reduce code
duplication.

Defining an "initialize" method and using new seems to be the standard
and I suspect is required if you want to plug into the validObject
protocol.  The "initialize" setup tries to make some strange
assumptions about how objects should be able to be constructed (IMO) [*1*].
Furthermore, it is a bummer to lose multiple dispatch when defining
constructors.

+ seth


[*1*] The default initialize method interprets named arguments as
slots which is a reasonable default, but not always sensible.  What I
find quite strange is that an un-named argument is interpreted as an
instance that should be cloned.


From tlumley at u.washington.edu  Wed Jan 31 16:50:33 2007
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed, 31 Jan 2007 07:50:33 -0800 (PST)
Subject: [Rd] PGF Device
In-Reply-To: <Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>
	<45C08BC7.4030305@stats.uwo.ca>
	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0701310748340.21996@homer22.u.washington.edu>

On Wed, 31 Jan 2007, Prof Brian Ripley wrote:
> There are several devices in packages, and this has been possible since at
> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but
> old Gtk), GNOMEdevice (never finished) and an SVG driver
> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on
> CRAN, the quartz device in the R.app front-end, and others.
>
> Paul Murrell used to have a list of known graphics devices, but I was
> unable to locate it quickly.
>

There's one at
   http://www.stat.auckland.ac.nz/~paul/R/devices.html
but I don't know how up-to-date it is.

 	-thomas


From nothnagel at medinfo.uni-kiel.de  Wed Jan 31 15:16:02 2007
From: nothnagel at medinfo.uni-kiel.de (nothnagel at medinfo.uni-kiel.de)
Date: Wed, 31 Jan 2007 15:16:02 +0100 (CET)
Subject: [Rd] Bug in 'pchisq' for x=0.0 (PR#9485)
Message-ID: <20070131141602.B2F745A7B5@slim.kubism.ku.dk>

The function 'pchisq' from the 'stats' library gives a wrong result if the
argument equals exactly zero:

# Upper tail of central 1-df chi^2 distribution
> pchisq(1         , 1, ncp=0, lower.tail = F, log.p = FALSE)
[1] 0.3173105
> pchisq(0.5       , 1, ncp=0, lower.tail = F, log.p = FALSE)
[1] 0.4795001
> pchisq(0.01      , 1, ncp=0, lower.tail = F, log.p = FALSE)
[1] 0.9203443
> pchisq(0.0001    , 1, ncp=0, lower.tail = F, log.p = FALSE)
[1] 0.9920213
> pchisq(0.00000001, 1, ncp=0, lower.tail = F, log.p = FALSE)
[1] 0.9999202
> pchisq(0.00      , 1, ncp=0, lower.tail = F, log.p = FALSE)
[1] 0   ## Should be 1.0

The error occurred with R version 2.4.0 (windows) and version 2.3.1 (linux).


Best regards,

Michael Nothnagel

---
Dr. Michael Nothnagel
Institute of Medical Informatics and Statistics, 
University of Kiel
http://capella.uni-kiel.de/
---


From Beyerj at students.uni-marburg.de  Wed Jan 31 16:02:21 2007
From: Beyerj at students.uni-marburg.de (J=?ISO-8859-1?B?9g==?=rg Beyer)
Date: Wed, 31 Jan 2007 16:02:21 +0100
Subject: [Rd] Problems with definitions of S4-generics
Message-ID: <C1E66E0D.2458%Beyerj@students.uni-marburg.de>

Hello all, 

I'd like to report a problem related to S4 classes.

Platform: 
Mac G4/400 PCI (PPC-architecture)
Mac OS 10.4.8
R 2.4.1 for Mac OS X (CRAN binary, 2006-12-19) w/ R.app 1.18

Last December, Simon Urbanek confirmed that the issue is not platform
related, and that it is most likely a bug. He suggested to post my report
to "the appropriate mailing list" -- I choose r-devel.


#### Problem-intro:
## Define two S4-classes

setGeneric("foofunc", def=function(object) {standardGeneric("foofunc")})
setGeneric("barfunc", def=function(object) {standardGeneric("barfunc")})


#### Okay, let's start.
#### Fist the correct part
## Do some tests to see if the generic is present,
## and have a look at some details

isGeneric("foofunc")
# [1] TRUE


findFunction("foofunc")
# [[1]]
# <environment: R_GlobalEnv>


foofunc
# nonstandardGenericFunction for "foofunc" defined from package ".GlobalEnv"
# 
# function (object)
# {
#     standardGeneric("foofunc")
# }
# <environment: 0x293bbb8>
# Methods may be defined for arguments: object


getGeneric("foofunc")
# same result as above



#### Now what I suspect is a bug
## Delete the S4-generic and repeat the "forensic" test calls

removeGeneric("foofunc")
# [1] TRUE


## The following is as expected...

foofunc
# Fehler: objekt "foofunc" nicht gefunden [~ Error: object "foofunc" not
found]


## Oops, but what's that?

getGeneric("foofunc")
# nonstandardGenericFunction for "foofunc" defined from package ".GlobalEnv"
# 
# function (object)
# {
#     standardGeneric("foofunc")
# }
# <environment: 0x19be228>
# Methods may be defined for arguments: object


## Why not try to remove it a second time?

removeGeneric("foofunc")
# [1] FALSE
# Warning message:
# generic function "foofunc" not found for removal in:
removeGeneric("foofunc")


## Another test to see if there is a function definition somewhere
## Weird ... 

isGeneric("foofunc")
# [1] TRUE


## Okay, let's see, where it is
## Ah, registered, but nowhere ...

findFunction("foofunc")
# list()


## Just to be sure, test this other generic
## (which we know *is present*)
## Okay, as expected...

findFunction("barfunc")
# [[1]]
# <environment: R_GlobalEnv>


## End of demo



There are situations where this behavior has negative consequences.
Thanks for your interest.

Cheers

J?rg


From Thomas.Petzoldt at tu-dresden.de  Wed Jan 31 17:11:00 2007
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Wed, 31 Jan 2007 17:11:00 +0100
Subject: [Rd] S4 initialize or "generating function"
In-Reply-To: <m2r6tbdyqc.fsf@fhcrc.org>
References: <45BFB590.3080405@TU-Dresden.de> <m2r6tbdyqc.fsf@fhcrc.org>
Message-ID: <45C0BF94.9020100@tu-dresden.de>

Dear Seth,

thank you for your suggestions. As I have some (shallow) inheritance I 
found indeed that initialize methods are superior. The reasons are, as 
you wrote, inheritance to subclasses and the possibility to use 
callNextMethod.

My code is now in fact much more compact with initialize in contrast to 
MyClass() constructors ("generating functions").

What I did was to create S4 objects which have an own function  slot 
"initfunc", that is called by the initialize method. In this case also 
the "cloning" behavior of initialize makes sense. It resets the S4 
object, possibly with new random start values, see the simplified example:

setClass("bar", representation(foo="numeric", initfunc="function"))
setMethod("initialize", signature(.Object="bar"),
   function(.Object, ...) {
     .Object <- callNextMethod()
     .Object <- .Object at initfunc(.Object)
     invisible(.Object)
   }
)

foobar <- new("bar",  foo = 0,
                 initfunc  = function(obj) {
                   obj at foo = rnorm(1)
                   invisible(obj)
                 }
)
foobar at foo
foobar <- initialize(foobar)
foobar at foo

One odd thing I found was that initialize does obviously not allow to 
incorporate additional named parameters which are not slots.

In essence I think that one should not use the constructor approach 
(from 2001) anymore, even if the "call is independent of the details of 
the representation".

Thank you

Thomas


Seth Falcon wrote:
 > Thomas Petzoldt <Thomas.Petzoldt at TU-Dresden.de> writes:
 >
 >> Hello,
 >>
 >> apologies if I missed something well known. I'm just revising an own
 >> package and wonder if it is still common to use "generating
 >> functions" which have the same name as the corresponding S4 class as
 >> suggested by Chambers, 2001. "Classes and Methods in the S Language".
 >>
 >> -- or should one consequently use new and initialize to do such
 >>    things?
 >
 > If you have no inheritence between the classes in your system (and are
 > pretty sure you are not going to have any) then I don't think it
 > really matters whether you define MyClass() to create new instances or
 > use new("MyClass",...).
 >
 > There is considerable advantage to having your constructors be real
 > methods when you do have inheritence relations among your classes.
 > This allows you to make use of callNextMethod to reduce code
 > duplication.
 >
 > Defining an "initialize" method and using new seems to be the standard
 > and I suspect is required if you want to plug into the validObject
 > protocol.  The "initialize" setup tries to make some strange
 > assumptions about how objects should be able to be constructed (IMO) 
[*1*].
 > Furthermore, it is a bummer to lose multiple dispatch when defining
 > constructors.
 >
 > + seth
 >
 >
 > [*1*] The default initialize method interprets named arguments as
 > slots which is a reasonable default, but not always sensible.  What I
 > find quite strange is that an un-named argument is interpreted as an
 > instance that should be cloned.
 >
 >
 >


-- 
Thomas Petzoldt
Technische Universitaet Dresden
Institut fuer Hydrobiologie        thomas.petzoldt at tu-dresden.de
01062 Dresden                      http://tu-dresden.de/hydrobiologie/
GERMANY


From sfalcon at fhcrc.org  Wed Jan 31 17:31:37 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 31 Jan 2007 08:31:37 -0800
Subject: [Rd] S4 initialize or "generating function"
In-Reply-To: <45C0BF94.9020100@tu-dresden.de> (Thomas Petzoldt's message of
	"Wed, 31 Jan 2007 17:11:00 +0100")
References: <45BFB590.3080405@TU-Dresden.de> <m2r6tbdyqc.fsf@fhcrc.org>
	<45C0BF94.9020100@tu-dresden.de>
Message-ID: <m2wt33cg46.fsf@fhcrc.org>

Thomas Petzoldt <Thomas.Petzoldt at tu-dresden.de> writes:
> One odd thing I found was that initialize does obviously not allow to
> incorporate additional named parameters which are not slots.

?!  Does for me:

      setClass("FOO", representation(x="numeric"))
      [1] "FOO"
       
       setMethod("initialize", "FOO",
                 function(.Object, value) {
                     .Object at x <- value * 2
                     .Object
                 })
      [1] "initialize"

      f <- new("FOO", value=1)
      f
      An object of class "FOO"
      Slot "x":
      [1] 2

> In essence I think that one should not use the constructor approach
> (from 2001) anymore, even if the "call is independent of the details
> of the representation".

Sometimes both are useful.  You can have convenience generator
functions for users, but have initialize methods that get called
internally.  This can also be nice in that the internal code can be
lean, while common user-facing code can do lots of error and sanity
checking, etc.

+ seth


From simon.urbanek at r-project.org  Wed Jan 31 17:32:01 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 31 Jan 2007 11:32:01 -0500
Subject: [Rd] Problems with definitions of S4-generics
In-Reply-To: <C1E66E0D.2458%Beyerj@students.uni-marburg.de>
References: <C1E66E0D.2458%Beyerj@students.uni-marburg.de>
Message-ID: <2D22560B-87AF-4B49-992B-3E85429CA448@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070131/e836e5ee/attachment.pl 

From maechler at stat.math.ethz.ch  Wed Jan 31 17:38:48 2007
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Wed, 31 Jan 2007 17:38:48 +0100 (CET)
Subject: [Rd] Bug in 'pchisq' for x=0.0 (PR#9485)
Message-ID: <20070131163848.C04435A7AF@slim.kubism.ku.dk>

>>>>> "MN" == Michael Nothnagel <nothnagel at medinfo.uni-kiel.de>
>>>>>     on Wed, 31 Jan 2007 15:16:02 +0100 (CET) writes:

    MN> The function 'pchisq' from the 'stats' library gives a wrong result if the
    MN> argument equals exactly zero:

    MN> # Upper tail of central 1-df chi^2 distribution
    >> pchisq(1         , 1, ncp=0, lower.tail = F, log.p = FALSE)
    MN> [1] 0.3173105
    >> pchisq(0.5       , 1, ncp=0, lower.tail = F, log.p = FALSE)
    MN> [1] 0.4795001
    >> pchisq(0.01      , 1, ncp=0, lower.tail = F, log.p = FALSE)
    MN> [1] 0.9203443
    >> pchisq(0.0001    , 1, ncp=0, lower.tail = F, log.p = FALSE)
    MN> [1] 0.9920213
    >> pchisq(0.00000001, 1, ncp=0, lower.tail = F, log.p = FALSE)
    MN> [1] 0.9999202
    >> pchisq(0.00      , 1, ncp=0, lower.tail = F, log.p = FALSE)
    MN> [1] 0   ## Should be 1.0

    MN> The error occurred with R version 2.4.0 (windows) and version 2.3.1 (linux).

Yes, but both of these R versions are outdated.
The current version is 2.4.1
and there, the result *is* 1.

Regards,
Martin Maechler, ETH Zurich


From p.dalgaard at biostat.ku.dk  Wed Jan 31 18:14:10 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 31 Jan 2007 18:14:10 +0100
Subject: [Rd] possible bug: dev.copy / could not find any X11 fonts
In-Reply-To: <20070131145039.GA12289@pu100877.student.princeton.edu>
References: <20070131145039.GA12289@pu100877.student.princeton.edu>
Message-ID: <45C0CE62.90700@biostat.ku.dk>

Tamas K Papp wrote:
> Hi,
>
> I am experiencing something strange, and thought I would ask before
> reporting a bug.  I trimmed it down to a self-contained example,
> attached as an R file.  The purpose of the functions is to save the
> plots into a ps file and simultaneously plot them on an x11 device,
> but don't open a new one if there is already one opened (I don't want
> the repositioning / flicker).
>
> When running the code:
>
>   
>> source("plotf.r")
>> plotf(avc,1)
>>     
> Error in dev.copy(which = x11dev) : could not find any X11 fonts
> Check that the Font Path is correct.
>
> The error message reappears whenever I switch to the plot window.  A
> partial plot is in the x11 window.
>
> When called in other contexts, plotting functions work perfectly, so I
> don't see what the problem is.
>
>   
Annoying, but your example works for me, so I suspect that the problem 
is nevertheless a setup issue at your end....   I would guess that the 
culprit is the tiny font used to label the axes. Things like this 
sometimes happen when you are missing 75dpi fontset. If you fire up 
xfontsel, can you find

-adobe-helvetica-medium-r-*-*-8-*-*-*-*-*-iso8859-1

?
(available pixel sizes should be 8,10,11,12,14,17,18,20,24,25,34)

> Thanks,
>
> Tamas
>
>
> version information:
>                _                           
> platform       i486-pc-linux-gnu           
> arch           i486                        
> os             linux-gnu                   
> system         i486, linux-gnu             
> status                                     
> major          2                           
> minor          4.1                         
> year           2006                        
> month          12                          
> day            18                          
> svn rev        40228                       
> language       R                           
> version.string R version 2.4.1 (2006-12-18)
>   
> ------------------------------------------------------------------------
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Thomas.Petzoldt at tu-dresden.de  Wed Jan 31 18:18:51 2007
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Wed, 31 Jan 2007 18:18:51 +0100
Subject: [Rd] S4 initialize or "generating function"
In-Reply-To: <m2wt33cg46.fsf@fhcrc.org>
References: <45BFB590.3080405@TU-Dresden.de>
	<m2r6tbdyqc.fsf@fhcrc.org>	<45C0BF94.9020100@tu-dresden.de>
	<m2wt33cg46.fsf@fhcrc.org>
Message-ID: <45C0CF7B.90606@tu-dresden.de>

Seth Falcon wrote:
 > Thomas Petzoldt <Thomas.Petzoldt at tu-dresden.de> writes:
 >> One odd thing I found was that initialize does obviously not allow to
 >> incorporate additional named parameters which are not slots.
 >
 > ?!  Does for me:


Your example works but one can not arbitrarily mix slots, other named 
arguments and the default callNextMethod(). The documentation states:

"... 	Data to include in the new object. Named arguments correspond to 
slots in the class definition."


Here is my example (extended from yours):

setClass("FOO", representation(x="numeric", y="numeric"))

setMethod("initialize", "FOO",
          function(.Object, y, value) {
               callNextMethod()
              .Object at x <- value * 2
              .Object
          })

new("FOO", y=1, value=2)

An object of class "FOO"
Slot "x":
[1] 4

Slot "y":
numeric(0)

What is different from what I originally expected. In such cases one has 
to add the arguments to callNextMethod(y=1) explicitly.

 >> In essence I think that one should not use the constructor approach
 >> (from 2001) anymore, even if the "call is independent of the details
 >> of the representation".
 >
 > Sometimes both are useful.  You can have convenience generator
 > functions for users, but have initialize methods that get called
 > internally.  This can also be nice in that the internal code can be
 > lean, while common user-facing code can do lots of error and sanity
 > checking, etc.

I see, and for the moment I let the constructors in the package, but 
they only provide now some class specific defaults and then call the 
(inherited) initialize method via new.

Thomas


From sfalcon at fhcrc.org  Wed Jan 31 18:23:42 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 31 Jan 2007 09:23:42 -0800
Subject: [Rd] "rep" missing from methods:::.BasicFunsList
In-Reply-To: <45B8DBE9.2040802@ubs.com> (Stephen Pope's message of "Thu,
	25 Jan 2007 09:33:45 -0700")
References: <45B8DBE9.2040802@ubs.com>
Message-ID: <m2k5z3cdpd.fsf@fhcrc.org>

Stephen Pope <Stephen.Pope at ubs.com> writes:

> With:
>
> R version 2.4.1 Patched (2007-01-22 r40548)
>
> "rep" is missing from methods:::.BasicFunsList, causing 
> methods:::genericForPrimitive("rep") to fail, which in turn causes 
> setMethod("rep", ...) to fail. (setGeneric("rep") of course fails as it 
> should, saying that rep is a primitive and methods can be set).
>
> Here's the fix:

and it looks like it was applied yesterday.


From ripley at stats.ox.ac.uk  Wed Jan 31 18:33:53 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Wed, 31 Jan 2007 18:33:53 +0100 (CET)
Subject: [Rd] Bug in 'pchisq' for x=0.0 (PR#9485)
Message-ID: <20070131173353.6DB755A7B2@slim.kubism.ku.dk>

Please do not report on obsolete versions of R!  From the changes from 
2.4.1:

     o	pchisq() would sometimes use the wrong tail when calculating
 	non-central probabilities with lower.tail = FALSE. (PR#9406)

You are quite explicitly asked not to waste the R project's resources in 
this way.  Please do re-read the FAQ.


On Wed, 31 Jan 2007, nothnagel at medinfo.uni-kiel.de wrote:

> The function 'pchisq' from the 'stats' library gives a wrong result if the
> argument equals exactly zero:
>
> # Upper tail of central 1-df chi^2 distribution
>> pchisq(1         , 1, ncp=0, lower.tail = F, log.p = FALSE)
> [1] 0.3173105
>> pchisq(0.5       , 1, ncp=0, lower.tail = F, log.p = FALSE)
> [1] 0.4795001
>> pchisq(0.01      , 1, ncp=0, lower.tail = F, log.p = FALSE)
> [1] 0.9203443
>> pchisq(0.0001    , 1, ncp=0, lower.tail = F, log.p = FALSE)
> [1] 0.9920213
>> pchisq(0.00000001, 1, ncp=0, lower.tail = F, log.p = FALSE)
> [1] 0.9999202
>> pchisq(0.00      , 1, ncp=0, lower.tail = F, log.p = FALSE)
> [1] 0   ## Should be 1.0
>
> The error occurred with R version 2.4.0 (windows) and version 2.3.1 (linux).
>
>
> Best regards,
>
> Michael Nothnagel
>
> ---
> Dr. Michael Nothnagel
> Institute of Medical Informatics and Statistics,
> University of Kiel
> http://capella.uni-kiel.de/
> ---
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From sfalcon at fhcrc.org  Wed Jan 31 18:39:57 2007
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Wed, 31 Jan 2007 09:39:57 -0800
Subject: [Rd] S4 initialize or "generating function"
In-Reply-To: <45C0CF7B.90606@tu-dresden.de> (Thomas Petzoldt's message of "Wed,
	31 Jan 2007 18:18:51 +0100")
References: <45BFB590.3080405@TU-Dresden.de> <m2r6tbdyqc.fsf@fhcrc.org>
	<45C0BF94.9020100@tu-dresden.de> <m2wt33cg46.fsf@fhcrc.org>
	<45C0CF7B.90606@tu-dresden.de>
Message-ID: <m23b5rccya.fsf@fhcrc.org>

Thomas Petzoldt <Thomas.Petzoldt at tu-dresden.de> writes:
> Your example works but one can not arbitrarily mix slots, other named
> arguments and the default callNextMethod(). The documentation states:
>
> "... 	Data to include in the new object. Named arguments correspond
> to slots in the class definition."

And this is where I start to get bent out of shape with what
"initialize" wants to assume about how _my_ objects should get
created...

> In such cases one has to add the arguments to callNextMethod(y=1)
> explicitly.

Yes.  There are other cases where you will only get the correct
behavior if you explicitly list args to callNextMethod (I believe that
one case is where your generic has default args).  I guess in my view,
constructors are just another method and so one shouldn't expect them
to align so tightly for related classes.

+ seth


From p.murrell at auckland.ac.nz  Wed Jan 31 22:23:56 2007
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Thu, 01 Feb 2007 10:23:56 +1300
Subject: [Rd] PGF Device
In-Reply-To: <Pine.LNX.4.64.0701310748340.21996@homer22.u.washington.edu>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>	<45C08BC7.4030305@stats.uwo.ca>	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0701310748340.21996@homer22.u.washington.edu>
Message-ID: <45C108EC.8000801@stat.auckland.ac.nz>

Hi


Thomas Lumley wrote:
> On Wed, 31 Jan 2007, Prof Brian Ripley wrote:
>> There are several devices in packages, and this has been possible since at
>> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but
>> old Gtk), GNOMEdevice (never finished) and an SVG driver
>> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on
>> CRAN, the quartz device in the R.app front-end, and others.
>>
>> Paul Murrell used to have a list of known graphics devices, but I was
>> unable to locate it quickly.
>>
> 
> There's one at
>    http://www.stat.auckland.ac.nz/~paul/R/devices.html
> but I don't know how up-to-date it is.


Neither do I :)  but I think most of the existing ones are mentioned
there. (except for Cairo, which has now been added).  I have heard talk
of a driver for MetaPost and one for OpenGL at different times, there
was even one from a company wanting one for "our own vector graphics
language", but I don't know if they came to anything.

Paul


>  	-thomas
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From jeff.horner at vanderbilt.edu  Wed Jan 31 22:43:46 2007
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Wed, 31 Jan 2007 15:43:46 -0600
Subject: [Rd] PGF Device
In-Reply-To: <45C0A3B9.2070808@stats.uwo.ca>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>	<45C08BC7.4030305@stats.uwo.ca>	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>
	<45C0A3B9.2070808@stats.uwo.ca>
Message-ID: <45C10D92.2010708@vanderbilt.edu>

Duncan Murdoch wrote:
> On 1/31/2007 8:49 AM, Prof Brian Ripley wrote:
>> On Wed, 31 Jan 2007, Duncan Murdoch wrote:
>>
>>> On 1/30/2007 8:50 PM, jtxx000 wrote:
>>>> Greetings all,
>>>> PGF is a package for LaTeX which works with both ps
>>>> and pdf output without any nasty hacks like pictex.
>>>> Is there any technical reason why there could not be a
>>>> PGF graphic device for R?  If not, I'm going to try to
>>>> throw one together.  Any tips for getting started?
>>> The existing drivers are in the grDevices package.  I would start with
>>> one of those (the picTeX driver would probably be most similar) and go
>>> from there.  Alternatively, start from devNULL.c and fill in the blanks.
>> Please don't start from pictex (it is only half implemented, including no 
>> real font metrics).  If you need Type1 fonts, I suggest you start from the 
>> postscript/PDF driver.
>>
>>> Someone else may be able to offer advice about whether you should be
>>> targetting this to be your own package, or for inclusion in the R
>>> source.  In the past it's been impossible to create a driver in a
>>> package, and there's been talk about adding enough to the API to allow
>>> this, but I don't know whether that's in place yet.
>> There are several devices in packages, and this has been possible since at 
>> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but 
>> old Gtk), GNOMEdevice (never finished) and an SVG driver 
>> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on 
>> CRAN, the quartz device in the R.app front-end, and others.
> 
> Yes, I must have been thinking about connections.  Just for the record, 
> is it possible to create a new connection type in a package?


No, but it's been proposed:

http://wiki.r-project.org/rwiki/doku.php?id=developers:r_connections_api

Comments are much appreciated.

Jeff

> 
> Duncan Murdoch
> 
>> Paul Murrell used to have a list of known graphics devices, but I was 
>> unable to locate it quickly.
>>
>> I've written several devices, including pdf(), xfig() and versions of 
>> png() etc.  The hard part is getting text and font metrics working: also 
>> nowadays you need to be prepared to handle UTF-8 text and CJK locales, 
>> which many graphic systems are not up to speed on (including postscript, 
>> pdf and latex).
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jeff.horner at vanderbilt.edu  Wed Jan 31 22:53:22 2007
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Wed, 31 Jan 2007 15:53:22 -0600
Subject: [Rd] PGF Device
In-Reply-To: <45C108EC.8000801@stat.auckland.ac.nz>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>	<45C08BC7.4030305@stats.uwo.ca>	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>	<Pine.LNX.4.64.0701310748340.21996@homer22.u.washington.edu>
	<45C108EC.8000801@stat.auckland.ac.nz>
Message-ID: <45C10FD2.1080107@vanderbilt.edu>

Paul Murrell wrote:
> Hi
> 
> 
> Thomas Lumley wrote:
>> On Wed, 31 Jan 2007, Prof Brian Ripley wrote:
>>> There are several devices in packages, and this has been possible since at
>>> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but
>>> old Gtk), GNOMEdevice (never finished) and an SVG driver
>>> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on
>>> CRAN, the quartz device in the R.app front-end, and others.
>>>
>>> Paul Murrell used to have a list of known graphics devices, but I was
>>> unable to locate it quickly.
>>>
>> There's one at
>>    http://www.stat.auckland.ac.nz/~paul/R/devices.html
>> but I don't know how up-to-date it is.
> 
> 
> Neither do I :)  but I think most of the existing ones are mentioned
> there. (except for Cairo, which has now been added).  I have heard talk
> of a driver for MetaPost and one for OpenGL at different times, there
> was even one from a company wanting one for "our own vector graphics
> language", but I don't know if they came to anything.

There's also the Cairo (png and pdf output) and GDD (png) packages for 
*NIX from www.rforge.net. The Cairo PDF output is nice as it embeds 
Truetype and OpenType fonts automatically.

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From p.murrell at auckland.ac.nz  Wed Jan 31 23:30:21 2007
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Thu, 01 Feb 2007 11:30:21 +1300
Subject: [Rd] PGF Device
In-Reply-To: <45C10FD2.1080107@vanderbilt.edu>
References: <693732970701301750x5b4b2daai62380bdf28417158@mail.gmail.com>	<45C08BC7.4030305@stats.uwo.ca>	<Pine.LNX.4.64.0701311328150.17807@gannet.stats.ox.ac.uk>	<Pine.LNX.4.64.0701310748340.21996@homer22.u.washington.edu>
	<45C108EC.8000801@stat.auckland.ac.nz>
	<45C10FD2.1080107@vanderbilt.edu>
Message-ID: <45C1187D.1010604@stat.auckland.ac.nz>

Hi


Jeffrey Horner wrote:
> Paul Murrell wrote:
>> Hi
>>
>>
>> Thomas Lumley wrote:
>>> On Wed, 31 Jan 2007, Prof Brian Ripley wrote:
>>>> There are several devices in packages, and this has been possible since at
>>>> least R 1.4.0 (from 2001).  There used to be gtkDevice (still on CRAN, but
>>>> old Gtk), GNOMEdevice (never finished) and an SVG driver
>>>> (http://www.darkridge.com/~jake/RSvg/), and there are now cairoDevice on
>>>> CRAN, the quartz device in the R.app front-end, and others.
>>>>
>>>> Paul Murrell used to have a list of known graphics devices, but I was
>>>> unable to locate it quickly.
>>>>
>>> There's one at
>>>    http://www.stat.auckland.ac.nz/~paul/R/devices.html
>>> but I don't know how up-to-date it is.
>>
>> Neither do I :)  but I think most of the existing ones are mentioned
>> there. (except for Cairo, which has now been added).  I have heard talk
>> of a driver for MetaPost and one for OpenGL at different times, there
>> was even one from a company wanting one for "our own vector graphics
>> language", but I don't know if they came to anything.
> 
> There's also the Cairo (png and pdf output) and GDD (png) packages for 
> *NIX from www.rforge.net. The Cairo PDF output is nice as it embeds 
> Truetype and OpenType fonts automatically.


Ah!  Thanks!  I had lost track of the Cairo/cairoDevice and GDD/xGD
alphabet soup :)

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From Beyerj at students.uni-marburg.de  Wed Jan 31 18:24:52 2007
From: Beyerj at students.uni-marburg.de (J=?ISO-8859-1?B?9g==?=rg Beyer)
Date: Wed, 31 Jan 2007 18:24:52 +0100
Subject: [Rd] Problems with definitions of S4-generics
In-Reply-To: <2D22560B-87AF-4B49-992B-3E85429CA448@r-project.org>
Message-ID: <C1E68F74.2465%Beyerj@students.uni-marburg.de>

Simon, 
thanks for the clarification, and sorry that I mixed the 'bug' thing up a
bit. Yes, you are correct, in fact it was Byron Ellis earlier in the same
thread who suggested "to file a bug report". (Maybe I misinterpreted the
fact that you didn't contradict. Big mistake.)

J?rg


Am 31.01.2007 17:32 Uhr schrieb Simon Urbanek
(<simon.urbanek at r-project.org>):

> 
> On Jan 31, 2007, at 10:02 AM, J?rg Beyer wrote:
> 
>> Hello all,?
>> 
>> I'd like to report a problem related to S4 classes.
>> 
>> Platform:?
>> Mac G4/400 PCI (PPC-architecture)
>> Mac OS 10.4.8
>> R 2.4.1 for Mac OS X (CRAN binary, 2006-12-19) w/ R.app 1.18
>> 
>> Last December, Simon Urbanek confirmed that the issue is not
>> platform?related, and that it is most likely a bug.
> 
> I didn't confirm any of the sort (especially not that it is a bug), you're
> making things up - this is what I really said:
> http://www.mail-archive.com/r-sig-mac at stat.math.ethz.ch/msg01369.html
> 
> Cheers,
> Simon
> 
>


From cetpaine at gmail.com  Wed Jan 31 19:40:16 2007
From: cetpaine at gmail.com (cetpaine at gmail.com)
Date: Wed, 31 Jan 2007 19:40:16 +0100 (CET)
Subject: [Rd] Bug in R editor (PR#9487)
Message-ID: <20070131184016.C5AEB5A7AC@slim.kubism.ku.dk>

Full_Name: C. E. Timothy Paine
Version: R version 2.4.1 (2006-12-18)
OS: OS X 10.4.8
Submission from: (NULL) (130.39.127.123)


When editing  a script in the editor window, the following messages appear in
the R console. Any further editing in the editor will generate a new line of
error code.  This occurs unpedictably when editing in the editor. Perhaps
related is the observation that when I open an existing script, and select the
text of that script, the script shifts slightly to the right. 

Sorry I can;t provide better info about the problem. 

Thanks for all of your work!
tim


...............R console output...............

 *** caught bus error ***
address 0x3f, cause 'invalid alignment'


Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
2007-01-31 12:28:04.453 R[11756] *** -[NSEvent set]: selector not recognized
[self = 0x52e2c0]
2007-01-31 12:28:04.454 R[11756] *** -[NSEvent set]: selector not recognized
[self = 0x52e2c0]

2007-01-31 12:32:37.166 R[11756] *** -[NSEvent colorUsingColorSpaceName:]:
selector not recognized [self = 0x52e2c0]
2007-01-31 12:32:37.166 R[11756] *** -[NSEvent colorUsingColorSpaceName:]:
selector not recognized [self = 0x52e2c0]
2007-01-31 12:32:37.182 R[11756] *** -[NSEvent colorUsingColorSpaceName:]:
selector not recognized [self = 0x52e2c0]
2007-01-31 12:32:37.183 R[11756] *** -[NSEvent colorUsingColorSpaceName:]:
selector not recognized [self = 0x52e2c0]
2007-01-31 12:32:38.535 R[11756] *** -[NSEvent colorUsingColorSpaceName:]:
selector not recognized [self = 0x52e2c0]
2007-01-31 12:32:38.535 R[11756] *** -[NSEvent colorUsingColorSpaceName:]:
selector not recognized [self = 0x52e2c0]
...




> sessionInfo()
R version 2.4.1 (2006-12-18) 
powerpc-apple-darwin8.8.0 

locale:
en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[7] "base"


From khurana.rupak at gmail.com  Wed Jan 31 21:05:41 2007
From: khurana.rupak at gmail.com (Rupak Khurana)
Date: Wed, 31 Jan 2007 15:05:41 -0500
Subject: [Rd] Fwd: Unable to load rJava - Undefined Symbol GetCreatedJavaVMs
In-Reply-To: <845c15940701311146jd14328drc2c3204803606778@mail.gmail.com>
References: <845c15940701311146jd14328drc2c3204803606778@mail.gmail.com>
Message-ID: <845c15940701311205n2a3dac07rbd198e82621a160d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20070131/26428ce0/attachment.pl 

