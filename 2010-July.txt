From osklyar at ahl.com  Fri Jul  2 09:27:05 2010
From: osklyar at ahl.com (Sklyar, Oleg (London))
Date: Fri, 2 Jul 2010 08:27:05 +0100
Subject: [Rd] POSIXlt matching bug
In-Reply-To: <EEBC169715EB8C438D3C9283AF0F201C08A7C74E@MSGBOSCLM2WIN.DMN1.FMR.COM>
References: <EEBC169715EB8C438D3C9283AF0F201C08A7C74E@MSGBOSCLM2WIN.DMN1.FMR.COM>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430662B27E@mildnpexmb01.maninvestments.ad.man.com>

POSIXlt is a list and it is not a list of dates or times, it is a list
of 

> x <- as.POSIXlt(Sys.Date())
> names(x)
[1] "sec"   "min"   "hour"  "mday"  "mon"   "year"  "wday"  "yday"
"isdst"

So if you want to match these things, you should use POSIXct or any
other numeric-based format (as POSIXct is just a double value for the
number of seconds since 1970-01-01) e.g.

> z <- as.POSIXct(Sys.Date())
> x <- as.POSIXct(Sys.Date())
> z==x
[1] TRUE
> match(z,x)
[1] 1
> z %in% x
[1] TRUE

Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of McGehee, Robert
> Sent: 29 June 2010 15:46
> To: R-bugs at r-project.org; r-devel at r-project.org
> Subject: [Rd] POSIXlt matching bug
> 
> I came across the below mis-feature/bug using match with 
> POSIXlt objects
> (from strptime) in R 2.11.1 (though this appears to be an old issue).
> 
> > x <- as.POSIXlt(Sys.Date())
> > table <- as.POSIXlt(Sys.Date()+0:5)
> > length(x)
> [1] 1
> > x %in% table  # I expect TRUE
> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> > match(x, table) # I expect 1
> [1] NA NA NA NA NA NA NA NA NA
> 
> This behavior seemed more plausible when the length of a 
> POSIXlt object
> was 9 (back in the day), however since the length was redefined, the
> length of x no longer matches the length of the match function output,
> as specified by the ?match documentation: "A vector of the same length
> as 'x'".
> 
> I would normally suggest that we add a POSIXlt method for match that
> converts x into POSIXct or character first. However, match does not
> appear to be generic. Below is a possible rewrite of match 
> that appears
> to work as desired.
> 
> match <- function(x, table, nomatch = NA_integer_, 
> incomparables = NULL)
> 
>     .Internal(match(if(is.factor(x)||inherits(x, "POSIXlt"))
> as.character(x) else x,
>                     if(is.factor(table)||inherits(table, "POSIXlt"))
> as.character(table) else table,
>                     nomatch, incomparables))
> 
> That said, I understand some people may be very sensitive to the speed
> of the match function, and may prefer a simple change to the ?match
> documentation noting this (odd) behavior for POSIXlt. 
> 
> Thanks, Robert
> 
> R.version
>                _                            
> platform       x86_64-unknown-linux-gnu     
> arch           x86_64                       
> os             linux-gnu                    
> system         x86_64, linux-gnu            
> status                                      
> major          2                            
> minor          11.1                         
> year           2010                         
> month          05                           
> day            31                           
> svn rev        52157                        
> language       R                            
> version.string R version 2.11.1 (2010-05-31)
> 
> Robert McGehee, CFA
> Geode Capital Management, LLC
> One Post Office Square, 28th Floor | Boston, MA | 02109
> Tel: 617/392-8396    Fax:617/476-6389
> mailto:robert.mcgehee at geodecapital.com
> 
> 
> >This e-mail, and any attachments hereto, are intended for use by the
> addressee(s) only and may contain information that is (i) confidential
> information of Geode Capital Management, LLC and/or its affiliates,
> and/or (ii) proprietary information of Geode Capital Management, LLC
> and/or its affiliates. If you are not the intended recipient of this
> e-mail, or if you have otherwise received this e-mail in error, please
> immediately notify me by telephone (you may call collect), or 
> by e-mail,
> and please permanently delete the original, any print outs and any
> copies of the foregoing. Any dissemination, distribution or copying of
> this e-mail is strictly prohibited. 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

**********************************************************************
 Please consider the environment before printing this email or its attachments.
The contents of this email are for the named addressees ...{{dropped:19}}


From maechler at stat.math.ethz.ch  Fri Jul  2 12:22:07 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 2 Jul 2010 12:22:07 +0200
Subject: [Rd] POSIXlt matching bug
In-Reply-To: <EEBC169715EB8C438D3C9283AF0F201C08A7C74E@MSGBOSCLM2WIN.DMN1.FMR.COM>
References: <EEBC169715EB8C438D3C9283AF0F201C08A7C74E@MSGBOSCLM2WIN.DMN1.FMR.COM>
Message-ID: <19501.48591.423818.616581@lynne.math.ethz.ch>

>>>>> "RobMcG" == McGehee, Robert <Robert.McGehee at geodecapital.com>
>>>>>     on Tue, 29 Jun 2010 10:46:06 -0400 writes:

    RobMcG> I came across the below mis-feature/bug using match with POSIXlt objects
    RobMcG> (from strptime) in R 2.11.1 (though this appears to be an old issue).

    >> x <- as.POSIXlt(Sys.Date())
    >> table <- as.POSIXlt(Sys.Date()+0:5)
    >> length(x)
    RobMcG> [1] 1
    >> x %in% table  # I expect TRUE
    RobMcG> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
    >> match(x, table) # I expect 1
    RobMcG> [1] NA NA NA NA NA NA NA NA NA

    RobMcG> This behavior seemed more plausible when the length of a POSIXlt object
    RobMcG> was 9 (back in the day), however since the length was redefined, the
    RobMcG> length of x no longer matches the length of the match function output,
    RobMcG> as specified by the ?match documentation: "A vector of the same length
    RobMcG> as 'x'".

    RobMcG> I would normally suggest that we add a POSIXlt method for match that
    RobMcG> converts x into POSIXct or character first. However, match does not
    RobMcG> appear to be generic. Below is a possible rewrite of match that appears
    RobMcG> to work as desired.

    RobMcG> match <- function(x, table, nomatch = NA_integer_, incomparables = NULL)

    RobMcG> .Internal(match(if(is.factor(x)||inherits(x, "POSIXlt"))
    RobMcG> as.character(x) else x,
    RobMcG> if(is.factor(table)||inherits(table, "POSIXlt"))
    RobMcG> as.character(table) else table,
    RobMcG> nomatch, incomparables))

    RobMcG> That said, I understand some people may be very sensitive to the speed
    RobMcG> of the match function, 

yes, indeed. 

I'm currently investigating an alternative, considerably more
programming time, but in the end should loose much less speed,
is to  .Internal()ize the tests in C code,
so that the resulting R code would simply be

match <- function(x, table, nomatch = NA_integer_, incomparables = NULL)
        .Internal(x, table, nomatch, incomparables)


Martin Maechler,
ETH Zurich


    RobMcG> and may prefer a simple change to the ?match
    RobMcG> documentation noting this (odd) behavior for POSIXlt. 

    RobMcG> Thanks, Robert

    RobMcG> R.version
    RobMcG> _                            
    RobMcG> platform       x86_64-unknown-linux-gnu     
    RobMcG> arch           x86_64                       
    RobMcG> os             linux-gnu                    
    RobMcG> system         x86_64, linux-gnu            
    RobMcG> status                                      
    RobMcG> major          2                            
    RobMcG> minor          11.1                         
    RobMcG> year           2010                         
    RobMcG> month          05                           
    RobMcG> day            31                           
    RobMcG> svn rev        52157                        
    RobMcG> language       R                            
    RobMcG> version.string R version 2.11.1 (2010-05-31)

    RobMcG> Robert McGehee, CFA
    RobMcG> Geode Capital Management, LLC
    RobMcG> One Post Office Square, 28th Floor | Boston, MA | 02109
    RobMcG> Tel: 617/392-8396    Fax:617/476-6389
    RobMcG> mailto:robert.mcgehee at geodecapital.com


    >> This e-mail, and any attachments hereto, are intended for use by the
    RobMcG> addressee(s) only and may contain information that is (i) confidential
    RobMcG> information of Geode Capital Management, LLC and/or its affiliates,
    RobMcG> and/or (ii) proprietary information of Geode Capital Management, LLC
    RobMcG> and/or its affiliates. If you are not the intended recipient of this
    RobMcG> e-mail, or if you have otherwise received this e-mail in error, please
    RobMcG> immediately notify me by telephone (you may call collect), or by e-mail,
    RobMcG> and please permanently delete the original, any print outs and any
    RobMcG> copies of the foregoing. Any dissemination, distribution or copying of
    RobMcG> this e-mail is strictly prohibited. 

    RobMcG> ______________________________________________
    RobMcG> R-devel at r-project.org mailing list
    RobMcG> https://stat.ethz.ch/mailman/listinfo/r-devel


From djsamperi at gmail.com  Fri Jul  2 16:10:11 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 2 Jul 2010 10:10:11 -0400
Subject: [Rd] Problem with dyn.load() under Windows 64bit at CRAN
In-Reply-To: <4C2B80AF.2040503@statistik.tu-dortmund.de>
References: <AANLkTilnLDq_LYijOwaRoO-O2Jxd0QlNNr8oN8_65lgs@mail.gmail.com>
	<4C2B80AF.2040503@statistik.tu-dortmund.de>
Message-ID: <AANLkTil45jW8Xp7ThAe7s_9AXgsB2JOnJLUrvNE0aSi3@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100702/2c2b1796/attachment.pl>

From maechler at stat.math.ethz.ch  Fri Jul  2 17:05:33 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 2 Jul 2010 17:05:33 +0200
Subject: [Rd] POSIXlt matching bug
In-Reply-To: <19501.48591.423818.616581@lynne.math.ethz.ch>
References: <EEBC169715EB8C438D3C9283AF0F201C08A7C74E@MSGBOSCLM2WIN.DMN1.FMR.COM>
	<19501.48591.423818.616581@lynne.math.ethz.ch>
Message-ID: <19502.61.233938.955158@lynne.math.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Fri, 2 Jul 2010 12:22:07 +0200 writes:

>>>>> "RobMcG" == McGehee, Robert <Robert.McGehee at geodecapital.com>
>>>>>     on Tue, 29 Jun 2010 10:46:06 -0400 writes:

    RobMcG> I came across the below mis-feature/bug using match with POSIXlt objects
    RobMcG> (from strptime) in R 2.11.1 (though this appears to be an old issue).

    >>> x <- as.POSIXlt(Sys.Date())
    >>> table <- as.POSIXlt(Sys.Date()+0:5)
    >>> length(x)
    RobMcG> [1] 1
    >>> x %in% table  # I expect TRUE
    RobMcG> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
    >>> match(x, table) # I expect 1
    RobMcG> [1] NA NA NA NA NA NA NA NA NA

    RobMcG> This behavior seemed more plausible when the length of a POSIXlt object
    RobMcG> was 9 (back in the day), however since the length was redefined, the
    RobMcG> length of x no longer matches the length of the match function output,
    RobMcG> as specified by the ?match documentation: "A vector of the same length
    RobMcG> as 'x'".

    RobMcG> I would normally suggest that we add a POSIXlt method for match that
    RobMcG> converts x into POSIXct or character first. However, match does not
    RobMcG> appear to be generic. Below is a possible rewrite of match that appears
    RobMcG> to work as desired.

    RobMcG> match <- function(x, table, nomatch = NA_integer_, incomparables = NULL)

    RobMcG> .Internal(match(if(is.factor(x)||inherits(x, "POSIXlt"))
    RobMcG> as.character(x) else x,
    RobMcG> if(is.factor(table)||inherits(table, "POSIXlt"))
    RobMcG> as.character(table) else table,
    RobMcG> nomatch, incomparables))

    RobMcG> That said, I understand some people may be very sensitive to the speed
    RobMcG> of the match function, 

    MM> yes, indeed. 

    MM> I'm currently investigating an alternative, considerably more
    MM> programming time, but in the end should loose much less speed,
    MM> is to  .Internal()ize the tests in C code,
    MM> so that the resulting R code would simply be

    MM> match <- function(x, table, nomatch = NA_integer_, incomparables = NULL)
    MM> .Internal(x, table, nomatch, incomparables)

I have committed such a change to  R-devel, to be 2.12.x.
This should mean that  match() actually is now very slightly
faster than it used to be.
The speed gain may not be measurable though.

Martin Maechler,  ETH Zurich



    RobMcG> and may prefer a simple change to the ?match
    RobMcG> documentation noting this (odd) behavior for POSIXlt. 

    RobMcG> Thanks, Robert

    RobMcG> R.version
    RobMcG> _                            
    RobMcG> platform       x86_64-unknown-linux-gnu     
    RobMcG> arch           x86_64                       
    RobMcG> os             linux-gnu                    
    RobMcG> system         x86_64, linux-gnu            
    RobMcG> status                                      
    RobMcG> major          2                            
    RobMcG> minor          11.1                         
    RobMcG> year           2010                         
    RobMcG> month          05                           
    RobMcG> day            31                           
    RobMcG> svn rev        52157                        
    RobMcG> language       R                            
    RobMcG> version.string R version 2.11.1 (2010-05-31)

    RobMcG> Robert McGehee, CFA
    RobMcG> Geode Capital Management, LLC
    RobMcG> One Post Office Square, 28th Floor | Boston, MA | 02109
    RobMcG> Tel: 617/392-8396    Fax:617/476-6389
    RobMcG> mailto:robert.mcgehee at geodecapital.com


From ligges at statistik.tu-dortmund.de  Fri Jul  2 18:47:37 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 02 Jul 2010 18:47:37 +0200
Subject: [Rd] Problem with dyn.load() under Windows 64bit at CRAN
In-Reply-To: <AANLkTil45jW8Xp7ThAe7s_9AXgsB2JOnJLUrvNE0aSi3@mail.gmail.com>
References: <AANLkTilnLDq_LYijOwaRoO-O2Jxd0QlNNr8oN8_65lgs@mail.gmail.com>	<4C2B80AF.2040503@statistik.tu-dortmund.de>
	<AANLkTil45jW8Xp7ThAe7s_9AXgsB2JOnJLUrvNE0aSi3@mail.gmail.com>
Message-ID: <4C2E1829.3070107@statistik.tu-dortmund.de>

On 02.07.2010 16:10, Dominick Samperi wrote:
> 2010/6/30 Uwe Ligges<ligges at statistik.tu-dortmund.de>
>
>> On 30.06.2010 15:44, Dominick Samperi wrote:
>>
>> Another odd thing about this is that everything worked under Windows 64bit
>>> before the changes were made to serialize the build of packages that
>>> depend on each other.
>>>
>>   That's untrue. I try to serialize some things on winbuilder.
>>
>
> There was a problem building packages that depended on Rcpp due to the
> parallel build process used at CRAN (and a bug in GNU make).


Well, sometimes, *not* always.
And *only* for Windows, it was fine on other platforms.


> The CRAN
> build process was changed (by serializing dependent packages) to fix this
> problem.

*No*! It was *not* changed, as I already told you in my last reply on 
the list. I aimed at and still have not found the time. And again, only 
Windows.

I fear you do not understand what I meant: I am just stopping to build 
some packages in parallel. Other stuff is not affected, hence nothing 
you or this list need to worry about.
I should not have told you, as I understand now. I just tried to give 
you an explanation why your packages failed twice in the past due to bad 
luck.
I just should keep quite in future and answer with a simple "no idea" 
given all the information and even internal guesses are reported in a 
different context and used for list-wide speculation in the end.



> The package cxxPack built fine under Windows 64bit before this
> change was implemented. Now it fails.

No, that's not the reason: the change has not yet been implemented.


> Today the build of cxxPack fails under most of the OS's, and it appears that
> the problem is due to a new release of Rcpp.
>
> Perhaps the idea of wrapping libs inside packages simply does not work,
> at least not without extra support and attention from the CRAN team.


Why should the CRAN team care about it?

Really, given my lack of time and your annoying posts to the lists 
containing misleading information, I probably should stop to care about 
your package at all. There are > 2000 other packages and some more 
important tasks to tackle. Consider the CRAN team would take so much 
time for each single package ...

Uwe


> One possible resolution would be to incorporate whatever I need from Rcpp
> into cxxPack to eliminate the package dependency.
 >
> Thanks,
> Dominick
>


From djsamperi at gmail.com  Fri Jul  2 19:21:14 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 2 Jul 2010 13:21:14 -0400
Subject: [Rd] Problem with dyn.load() under Windows 64bit at CRAN
In-Reply-To: <4C2E1829.3070107@statistik.tu-dortmund.de>
References: <AANLkTilnLDq_LYijOwaRoO-O2Jxd0QlNNr8oN8_65lgs@mail.gmail.com>
	<4C2B80AF.2040503@statistik.tu-dortmund.de>
	<AANLkTil45jW8Xp7ThAe7s_9AXgsB2JOnJLUrvNE0aSi3@mail.gmail.com>
	<4C2E1829.3070107@statistik.tu-dortmund.de>
Message-ID: <AANLkTikY9vokDZPjgBy1dcDdVQ8-TyQEbLZd6tK0BPcH@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100702/55e0de09/attachment.pl>

From jeffrey.horner at gmail.com  Fri Jul  2 22:13:07 2010
From: jeffrey.horner at gmail.com (Jeffrey Horner)
Date: Fri, 2 Jul 2010 15:13:07 -0500
Subject: [Rd] Best way to determine if you're running 32 or 64 bit R on
	windows
Message-ID: <AANLkTin2EK9OyaoETK3S-2qCn3WXB_wvmOF76iLPx-wI@mail.gmail.com>

Hi,

Is this sufficient?

if (.Machine$sizeof.pointer==4){
  cat('32\n')
} else {
  cat('64\n')
}

Or is it better to test something in R.version, say os?

I'd like to use this to specify appropriate linker arguments when
building the RMySQL windows package.

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From maechler at stat.math.ethz.ch  Fri Jul  2 23:09:29 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 2 Jul 2010 21:09:29 +0000 (UTC)
Subject: [Rd]
	=?utf-8?q?Best_way_to_determine_if_you=27re_running_32_or_64?=
	=?utf-8?q?_bit_R_on=09windows?=
References: <AANLkTin2EK9OyaoETK3S-2qCn3WXB_wvmOF76iLPx-wI@mail.gmail.com>
Message-ID: <loom.20100702T230750-230@post.gmane.org>

Jeffrey Horner <jeffrey.horner <at> gmail.com> writes:

> Is this sufficient?
> 
> if (.Machine$sizeof.pointer==4){
>   cat('32\n')
> } else {
>   cat('64\n')
> }
> 
> Or is it better to test something in R.version, say os?

No, the above is perfect,  as it also works on other platforms to distinguish
32-bit and 64-bit.

Regards, Martin


From chiefmurphy at gmail.com  Fri Jul  2 23:26:04 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Fri, 2 Jul 2010 14:26:04 -0700
Subject: [Rd] Attributes of 1st argument in ...
Message-ID: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100702/71f7f50d/attachment.pl>

From olafm at kimberly.tako.de  Sat Jul  3 00:15:57 2010
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Sat, 3 Jul 2010 00:15:57 +0200
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
Message-ID: <C83BA8B5-057A-4A34-A0F6-3D7ADB860E3C@kimberly.tako.de>

Hi Daniel,

On 02.07.2010, at 23:26, Daniel Murphy wrote:
> I am trying to get an attribute of the first argument in a call to a
> function whose formal arguments consist of dots only and do something, e.g.,
> call 'cbind', based on the attribute
> f<- function(...) {get first attribute; maybe or maybe not call 'cbind'}
> 
> I thought of (ignoring "deparse.level" for the moment)
> 
> f<-function(...) {x <- attr(list(...)[[1L]], "foo"); if (x=="bar")
> cbind(...) else x}

what about using the somewhat obscure ..1 syntax? This version runs quite a bit faster for me:

 g <- function(...) {
   x <- attr(..1, "foo")
   if (x == "bar")
     cbind(...)
   else
     x
 }

but it will be hard to quantify how this pans out for your unless we know how many and what size and type the arguments are.

Cheers,
Olaf


From ggrothendieck at gmail.com  Sat Jul  3 00:50:28 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 2 Jul 2010 18:50:28 -0400
Subject: [Rd] kmeans
Message-ID: <AANLkTimbMVbBxRe4bAam8mNrL8QuUFcGncttVB1UT1RV@mail.gmail.com>

In kmeans() in stats one gets an error message with the default
clustering algorithm if centers = 1.  Its often useful to calculate
the sum of squares for 1 cluster, 2 clusters, etc. and this error
complicates things since one has to treat 1 cluster as a special case.
 A second reason is that easily getting the 1 cluster sum of squares
makes it easy to calculate the between cluster sum of squares when
there is more than 1 cluster.

I suggest adding the line marked ### to the source code of kmeans (the
other lines shown are just ther to illustrate context).  Adding this
line forces kmeans to use the code for algorithm 3 if centers is 1.
This is useful since unlike the code for the default algorithm, the
code for algorithm 3 succeeds for centers = 1.

    if(length(centers) == 1) {
	if (centers == 1) nmeth <- 3 ###
	k <- centers

Also note that KMeans in Rcmdr produces a betweenss and a tot.withinss
and it would be nice if kmeans in stats did that too:

> library(Rcmdr)
> str(KMeans(USArrests, 3))
List of 6
 $ cluster     : Named int [1:50] 1 1 1 2 1 2 3 1 1 2 ...
  ..- attr(*, "names")= chr [1:50] "Alabama" "Alaska" "Arizona" "Arkansas" ...
 $ centers     : num [1:3, 1:4] 11.81 8.21 4.27 272.56 173.29 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:3] "1" "2" "3"
  .. ..$ : chr [1:4] "Murder" "Assault" "UrbanPop" "Rape"
 $ withinss    : num [1:3] 19564 9137 19264
 $ size        : int [1:3] 16 14 20
 $ tot.withinss: num 47964  <=================
 $ betweenss   : num 307844 <=================
 - attr(*, "class")= chr "kmeans"


From ripley at stats.ox.ac.uk  Sat Jul  3 08:37:59 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 3 Jul 2010 07:37:59 +0100 (BST)
Subject: [Rd] Best way to determine if you're running 32 or 64 bit R on
 windows
In-Reply-To: <AANLkTin2EK9OyaoETK3S-2qCn3WXB_wvmOF76iLPx-wI@mail.gmail.com>
References: <AANLkTin2EK9OyaoETK3S-2qCn3WXB_wvmOF76iLPx-wI@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007030730500.13321@gannet.stats.ox.ac.uk>

On Fri, 2 Jul 2010, Jeffrey Horner wrote:

> Hi,
>
> Is this sufficient?

Yes, if you want to know in R code.

> if (.Machine$sizeof.pointer==4){
>  cat('32\n')
> } else {
>  cat('64\n')
> }
>
> Or is it better to test something in R.version, say os?

Not 'os' (the OS is the same), but 'arch' changes.  Just as on a Mac 
or on Linux.

> I'd like to use this to specify appropriate linker arguments when
> building the RMySQL windows package.

If you mean *installing*  (R CMD INSTALL, not R CMD build) the 
documented way is to use the environment variable R_ARCH: there are 
also make variables available, e.g. WIN.  See 
http://www.stats.ox.ac.uk/~ripley/Win64/W64porting.html (which is 
linked from the appropriate manuals).

>
> Jeff
> -- 
> http://biostat.mc.vanderbilt.edu/JeffreyHorner
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From olafm at statistik.tu-dortmund.de  Sat Jul  3 00:14:13 2010
From: olafm at statistik.tu-dortmund.de (Olaf Mersmann)
Date: Sat, 3 Jul 2010 00:14:13 +0200
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
Message-ID: <CD24596A-0B94-4A32-822D-98345DFC65D9@statistik.tu-dortmund.de>

Hi Daniel,

On 02.07.2010, at 23:26, Daniel Murphy wrote:
> I am trying to get an attribute of the first argument in a call to a
> function whose formal arguments consist of dots only and do something, e.g.,
> call 'cbind', based on the attribute
> f<- function(...) {get first attribute; maybe or maybe not call 'cbind'}
> 
> I thought of (ignoring "deparse.level" for the moment)
> 
> f<-function(...) {x <- attr(list(...)[[1L]], "foo"); if (x=="bar")
> cbind(...) else x}

what about using the somewhat obscure ..1 syntax? This version runs quite a bit faster for me:

  g <- function(...) {
    x <- attr(..1, "foo")
    if (x == "bar")
      cbind(...)
    else
      x
  }

but it will be hard to quantify how this pans out for your unless we know how many and what size and type the arguments are.

Cheers,
Olaf


From jszhao at yeah.net  Sat Jul  3 14:18:54 2010
From: jszhao at yeah.net (Jinsong Zhao)
Date: Sat, 03 Jul 2010 20:18:54 +0800
Subject: [Rd] bug in devPS.c
Message-ID: <4C2F2AAE.1070202@yeah.net>

Hi there,

I have filed a bug report at:
https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=14326.

And the related patch is at:
https://bugs.r-project.org/bugzilla3/attachment.cgi?id=1113

which will do:

1) correct the binary comment (the second line of PDF file)
2) remove a strange ^M in the PDF file
3) give correct font number for CID fonts when were used with default fonts.

Regards,
Jinsong


From hadley at rice.edu  Sat Jul  3 18:17:29 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Sat, 3 Jul 2010 11:17:29 -0500
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
Message-ID: <AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>

Hi Dan,

Is there a reason you can't change the function to

f <- function(x, ...) {}

?

Hadley

On Fri, Jul 2, 2010 at 4:26 PM, Daniel Murphy <chiefmurphy at gmail.com> wrote:
> R-Devel:
>
> I am trying to get an attribute of the first argument in a call to a
> function whose formal arguments consist of dots only and do something, e.g.,
> call 'cbind', based on the attribute
> f<- function(...) {get first attribute; maybe or maybe not call 'cbind'}
>
> I thought of (ignoring "deparse.level" for the moment)
>
> f<-function(...) {x <- attr(list(...)[[1L]], "foo"); if (x=="bar")
> cbind(...) else x}
>
> but I feared my solution might do some extra copying, with a performance
> penalty if the dotted objects in the actual call to "f' are very large.
>
> I thought the following alternative might avoid a potential performance hit
> by evaluating the attribute in the parent.frame (and therefore avoid extra
> copying?):
>
> f<-function(...)
> {
> ? L<-match.call(expand.dots=FALSE)[[2L]]
> ? x <- eval(substitute(attr(x,"foo"), list(x=L[[1L]])))
> ? if (x=="bar") cbind(...) else x
> }
>
> system.time tests showed this second form to be only marginally faster.
>
> Is my fear about extra copying unwarranted? If not, is there a better way to
> get the "foo" attribute of the first argument other than my two
> alternatives?
>
> Thanks,
> Dan Murphy
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From chiefmurphy at gmail.com  Sun Jul  4 04:30:34 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Sat, 3 Jul 2010 19:30:34 -0700
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
	<AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
Message-ID: <AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100703/ab50b490/attachment.pl>

From pburns at pburns.seanet.com  Sun Jul  4 10:43:44 2010
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sun, 04 Jul 2010 09:43:44 +0100
Subject: [Rd] arr.ind argument to which.min and which.max
Message-ID: <4C3049C0.60101@pburns.seanet.com>

Is there a reason that 'which.min' and
'which.max' don't have an 'arr.ind'
argument?

The context in which I wanted that was
a grid search optimization, which seems
like it would be reasonably common to me.


-- 
Patrick Burns
pburns at pburns.seanet.com
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')


From ripley at stats.ox.ac.uk  Sun Jul  4 13:36:10 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 4 Jul 2010 12:36:10 +0100 (BST)
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
	<AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
	<AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007041223300.30947@gannet.stats.ox.ac.uk>

I think you have missed the use of ..1 etc: see e.g. cBind() in 
package Matrix.

So x <- attr(list(...)[[1L]], "foo") can be x <- attr(..1, "foo")

As for 'extra copying', it all depends on exactly what you are doing, 
but compare

> foo1 <- function(...) length(..1)
> foo2 <- function(...) length(list(...)[[1L]])
> tracemem(x <- runif(1000))
[1] "<0x1b27800>"
> foo1(x)
[1] 1000
> tracemem(x <- runif(1000))
[1] "<0x1b29800>"
> foo2(x)
tracemem[0x1b29800 -> 0x10a2200]: foo2
[1] 1000


On Sat, 3 Jul 2010, Daniel Murphy wrote:

> Hi Hadley,
>
> My actual goal is to have a cbind method in the mondate package that behaves
> just like the base cbind function: class and shape of the result, names,
> etc. Perhaps it's due to the fact that 'cbind' uses its own internal
> dispatching, but I have not found a way to implement a "true" S3-style cbind
> method. (This is probably ancient news to the development team.) An S4 cbind
> method will utilize callNextMethod with just setGeneric("cbind"), which has
> no 'x' in the formal arguments. With no 'x', there's no "first argument" on
> which to dispatch a "mondate" method. I can make the cbind of mondates also
> be a mondate with an all-encompassing setMethod("cbind","ANY", etc) method,
> but that wrests dispatch control from cbind which makes no sense whatsoever.
> So, to make a long story even longer, I settled for a "cbindmondate
> function" that utilizes the speed of base::cbind and (with one exception)
> gives me the hoped-for "base cbind behavior."
>
> I can send examples of my trial-and-error attempts under separate email if
> you're interested.
>
> Best regards,
> Dan
>
> On Sat, Jul 3, 2010 at 9:17 AM, Hadley Wickham <hadley at rice.edu> wrote:
>
>> Hi Dan,
>>
>> Is there a reason you can't change the function to
>>
>> f <- function(x, ...) {}
>>
>> ?
>>
>> Hadley
>>
>> On Fri, Jul 2, 2010 at 4:26 PM, Daniel Murphy <chiefmurphy at gmail.com>
>> wrote:
>>> R-Devel:
>>>
>>> I am trying to get an attribute of the first argument in a call to a
>>> function whose formal arguments consist of dots only and do something,
>> e.g.,
>>> call 'cbind', based on the attribute
>>> f<- function(...) {get first attribute; maybe or maybe not call 'cbind'}
>>>
>>> I thought of (ignoring "deparse.level" for the moment)
>>>
>>> f<-function(...) {x <- attr(list(...)[[1L]], "foo"); if (x=="bar")
>>> cbind(...) else x}
>>>
>>> but I feared my solution might do some extra copying, with a performance
>>> penalty if the dotted objects in the actual call to "f' are very large.
>>>
>>> I thought the following alternative might avoid a potential performance
>> hit
>>> by evaluating the attribute in the parent.frame (and therefore avoid
>> extra
>>> copying?):
>>>
>>> f<-function(...)
>>> {
>>>   L<-match.call(expand.dots=FALSE)[[2L]]
>>>   x <- eval(substitute(attr(x,"foo"), list(x=L[[1L]])))
>>>   if (x=="bar") cbind(...) else x
>>> }
>>>
>>> system.time tests showed this second form to be only marginally faster.
>>>
>>> Is my fear about extra copying unwarranted? If not, is there a better way
>> to
>>> get the "foo" attribute of the first argument other than my two
>>> alternatives?
>>>
>>> Thanks,
>>> Dan Murphy
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>> --
>> Assistant Professor / Dobelman Family Junior Chair
>> Department of Statistics / Rice University
>> http://had.co.nz/
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From chiefmurphy at gmail.com  Sun Jul  4 20:11:43 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Sun, 4 Jul 2010 11:11:43 -0700
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <alpine.LFD.2.00.1007041223300.30947@gannet.stats.ox.ac.uk>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
	<AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
	<AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>
	<alpine.LFD.2.00.1007041223300.30947@gannet.stats.ox.ac.uk>
Message-ID: <AANLkTilr6wTa3-twDfWL3z13lq5Gxz9-lHrvvF-hyjJj@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100704/bc6422b9/attachment.asc>

From mjhmeyer at googlemail.com  Sun Jul  4 13:55:45 2010
From: mjhmeyer at googlemail.com (michael meyer)
Date: Sun, 4 Jul 2010 13:55:45 +0200
Subject: [Rd] Call for suggestions
Message-ID: <AANLkTinPO0sBS7J9HrFpge4wGTJAbuRbWxGTYcElWAli@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100704/49489a11/attachment.pl>

From marc_schwartz at me.com  Mon Jul  5 04:49:51 2010
From: marc_schwartz at me.com (Marc Schwartz)
Date: Sun, 04 Jul 2010 21:49:51 -0500
Subject: [Rd] Possible bug in 2.11.x texmf makefile.in and some related
	things...
Message-ID: <17AB3D1C-ACDF-4E03-B279-B750A60E804D@me.com>

Hi all,

A list of some possible issues:

1. In R 2.11.x, in:

  http://svn.r-project.org/R/branches/R-2-11-branch/share/texmf/

there are two files, jss.cls and jss.bst (for JSS), which appear to be new since 2.10.x. These files are not installed when building/installing R. It would appear that they are not included in:

  https://svn.r-project.org/R/branches/R-2-11-branch/share/Makefile.in

The relevant code there is:

  	@for f in $(srcdir)/texmf/*.sty \
		  $(srcdir)/texmf/*.fd; do \
	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf"; \
	done

which would skip over the two jss files.

This issue came up when another useR (on F12) was building the zoo package with its vignette, which apparently uses jss.cls. Errors were of course observed. I thought that the error was limited to Fedora, but this is an issue in the source.


2. On a related issue, the texmf tree appears to be modified in 2.12.x, with the latex and bibtex files being put into separate folders:

  https://svn.r-project.org/R/trunk/share/texmf/

The makefile.in:

  https://svn.r-project.org/R/trunk/share/Makefile.in  

appears to be modified to handle that split:

  	@for f in $(srcdir)/texmf/bibtex/bst/*; do \
	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf/bibtex/bst"; \
	done
	@for f in $(srcdir)/texmf/tex/latex/*; do \
	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf/tex/latex"; \
	done


So there was perhaps an oversight of sorts for 2.11.x in handling these two JSS related files.


3. A final note, which is that the NEWS file appears to be missing from R-Devel tonight:

  https://svn.r-project.org/R/trunk/

I was trying to read it to note any comments relevant to the above.

HTH,

Marc Schwartz


From ripley at stats.ox.ac.uk  Mon Jul  5 08:50:52 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 5 Jul 2010 07:50:52 +0100 (BST)
Subject: [Rd] Possible bug in 2.11.x texmf makefile.in and some related
 things...
In-Reply-To: <17AB3D1C-ACDF-4E03-B279-B750A60E804D@me.com>
References: <17AB3D1C-ACDF-4E03-B279-B750A60E804D@me.com>
Message-ID: <alpine.LFD.2.00.1007050719020.25780@gannet.stats.ox.ac.uk>

On Sun, 4 Jul 2010, Marc Schwartz wrote:

> Hi all,
>
> A list of some possible issues:
>
> 1. In R 2.11.x, in:
>
>  http://svn.r-project.org/R/branches/R-2-11-branch/share/texmf/
>
> there are two files, jss.cls and jss.bst (for JSS), which appear to 
> be new since 2.10.x. These files are not installed when 
> building/installing R. It would appear that they are not included 
> in:
>
>  https://svn.r-project.org/R/branches/R-2-11-branch/share/Makefile.in
>
> The relevant code there is:
>
>  	@for f in $(srcdir)/texmf/*.sty \
> 		  $(srcdir)/texmf/*.fd; do \
> 	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf"; \
> 	done
>
> which would skip over the two jss files.
>
> This issue came up when another useR (on F12) was building the zoo 
> package with its vignette, which apparently uses jss.cls. Errors 
> were of course observed. I thought that the error was limited to 
> Fedora, but this is an issue in the source.

But there are a fair number of packages which need extra LaTeX files 
to build their vignettes, and e.g. the CRAN test systems have had to 
have these installed for a long time.  Certainly zoo has needed them 
from before 2.11.0, and many believe that a Open Source package needs 
to include copies of such files (see 'Writing R Extensions').

> 2. On a related issue, the texmf tree appears to be modified in 
> 2.12.x, with the latex and bibtex files being put into separate 
> folders:

More precisely, it is a TDS-comformant tree now.

>  https://svn.r-project.org/R/trunk/share/texmf/
>
> The makefile.in:
>
>  https://svn.r-project.org/R/trunk/share/Makefile.in
>
> appears to be modified to handle that split:
>
>  	@for f in $(srcdir)/texmf/bibtex/bst/*; do \
> 	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf/bibtex/bst"; \
> 	done
> 	@for f in $(srcdir)/texmf/tex/latex/*; do \
> 	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf/tex/latex"; \
> 	done
>
>
> So there was perhaps an oversight of sorts for 2.11.x in handling 
> these two JSS related files.

That's a different hand.  I don't know if the files were intended to 
be installed in 2.11.x: they are in R-devel so eventually packages 
depending on R >= 2.12.0 will be able to rely on them.

> 3. A final note, which is that the NEWS file appears to be missing 
> from R-Devel tonight:
>
>  https://svn.r-project.org/R/trunk/
>
> I was trying to read it to note any comments relevant to the above.

Correct.  You need to look in 
https://svn.r-project.org/R/trunk/doc/NEWS.Rd
which says

       \item File \file{NEWS} is now generated at installation with a
       slightly different format: it will be in UTF-8 on platforms using
       UTF-8, and otherwise in ASCII.

       \item \file{NEWS} is no longer in the sources, but generated as
       part of the installation.  The primary source for changes is now
       \file{doc/NEWS.Rd}.

A version of the NEWS file will be in the tarballs.

>
> HTH,
>
> Marc Schwartz
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pdalgd at gmail.com  Mon Jul  5 09:52:18 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Mon, 05 Jul 2010 09:52:18 +0200
Subject: [Rd] Possible bug in 2.11.x texmf makefile.in and some related
 things...
In-Reply-To: <alpine.LFD.2.00.1007050719020.25780@gannet.stats.ox.ac.uk>
References: <17AB3D1C-ACDF-4E03-B279-B750A60E804D@me.com>
	<alpine.LFD.2.00.1007050719020.25780@gannet.stats.ox.ac.uk>
Message-ID: <4C318F32.7030404@gmail.com>

Prof Brian Ripley wrote:
....
>> So there was perhaps an oversight of sorts for 2.11.x in handling 
>> these two JSS related files.
> 
> That's a different hand.  I don't know if the files were intended to 
> be installed in 2.11.x: they are in R-devel so eventually packages 
> depending on R >= 2.12.0 will be able to rely on them.
> 


Looking through the logs, those two files were indeed committed to
r-devel, but long before the creation of R-2-11-branch. They appear not
to be used in any other part of the sources, so are indeed pretty
useless if not copied to the tarball (since we should not assume that
people in general build from svn checkouts). But as Brian points out,
they are only two out of many files that could be included as a service
to the user.

>> 3. A final note, which is that the NEWS file appears to be missing 
>> from R-Devel tonight:
...

>        \item \file{NEWS} is no longer in the sources, but generated as
>        part of the installation.  The primary source for changes is now
>        \file{doc/NEWS.Rd}.
> 
> A version of the NEWS file will be in the tarballs.

Yes. It's generally a bad principle to have anything but the base
sources in the repository, although we have had so for some things in
the past (notably Java class files), because we couldn't rely on
everyone having the appropriate tools. Especially with text files there
will always be the risk of editing the target file instead of the
source. (Just ask the editor of The R Journal how easy it is to remember
to edit RJournal.dtx and not RJournal.sty...)


-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From maechler at stat.math.ethz.ch  Mon Jul  5 11:47:01 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 5 Jul 2010 11:47:01 +0200
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTilr6wTa3-twDfWL3z13lq5Gxz9-lHrvvF-hyjJj@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
	<AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
	<AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>
	<alpine.LFD.2.00.1007041223300.30947@gannet.stats.ox.ac.uk>
	<AANLkTilr6wTa3-twDfWL3z13lq5Gxz9-lHrvvF-hyjJj@mail.gmail.com>
Message-ID: <19505.43541.43754.85521@lynne.math.ethz.ch>

>>>>> "DM" == Daniel Murphy <chiefmurphy at gmail.com>
>>>>>     on Sun, 4 Jul 2010 11:11:43 -0700 writes:

    DM> Thank you, Professor, for drawing my attention to the nifty tracemem
    DM> function. I'm using the ..1 syntax to check the properties of the S4 class
    DM> at function call.

    DM> The Description at ?"cBind" tells me that I'm not alone in this predicament.


    DM> Just as Matrix needs its own cBind function, my package will need its own
    DM> cbindMondate function. Alas, subclasses of mondate will also need their own
    DM> binding functions, thus defeating one of the purposes of the class paradigm
    DM> (for binding, anyway).

I don't think you see the full picture:

Matrix::cBind() builds on methods::cbind2()

and cbind2 / rbind2  are there (in package methods) for you to
use setMethod() on them.

BTW: When Matrix::cBind() -- and cbind2 / rbind2 in package
     methods were written,

R did not have the possibility yet to write methods for "...",
which it now does.

In the package Rmpfr (arbitrary-precision number ["mpfr"] computing),
where I also define methods for matrices of such "mpfr" numbers
(classes "mpfrMatrix" and "mpfrArray"),
I use the new feature of defining methods for "..." :

setGeneric("cbind", signature = "...")

setMethod("cbind", "Mnumber",
	  function(..., deparse.level = 1) {
	      args <- list(...)
	      if(all(sapply(args, is.atomic)))
		  return( base::cbind(..., deparse.level = deparse.level) )
	      ## else: at least one is "mpfr(Matrix/Array)"

	      if(any(sapply(args, is.character))) {
		  ## result will be  <character> matrix !
		  isM <- sapply(args, is, class2 = "mpfr")
		  args[isM] <- lapply(args[isM], as, Class = "character")
		  return(do.call(base::cbind,
				 c(args, list(deparse.level=deparse.level))))

	      } else if(any(sapply(args, is.complex))) {
		  ## result will be  <complex> matrix;
		  ## in the future <complex_mpfr>  ???

		  stop("cbind(...) of 'complex' and 'mpfr' objects is not implemented")
		  ## give at least warning !!
              }
              ## else

     ..........
     ..........
  })


where I use a useful class union

  setClassUnion("Mnumber",
		members = c("array_or_vector", # *but* must be numeric-like
		"mpfr", "mpfrArray", "mpfrMatrix"))

----

As always, I'd recommend to read the R source, rather than just
investigate the installed package.
You can get the *source* tarbal, i.e., the *.tar.gz file from
CRAN, or, as it's all on R-forge,
     http://rmpfr.r-forge.r-project.org/
you can get the source tarball here,
   https://r-forge.r-project.org/R/?group_id=386
or browse the source at
   https://r-forge.r-project.org/scm/viewvc.php/pkg/?root=rmpfr

But if I were you I'd get it via
   svn checkout svn://svn.r-forge.r-project.org/svnroot/rmpfr/pkg Rmpfr



    DM> As an aside, I wonder why, on around line 75, cBind uses 'rep.int("",
    DM> ncol(r))' rather than the slightly faster 'character(ncol(r))'.

Well, I would not remember, but the first one is a more self-explaining,
... and I would guess strongly that time difference is
irrelevant in the context where it's used...
... but then thanks for your hint :-)

Martin


    DM> Thanks again,
    DM> Dan

    DM> On Sun, Jul 4, 2010 at 4:36 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk>wrote:

    >> I think you have missed the use of ..1 etc: see e.g. cBind() in package
    >> Matrix.
    >> 
    >> So x <- attr(list(...)[[1L]], "foo") can be x <- attr(..1, "foo")
    >> 
    >> As for 'extra copying', it all depends on exactly what you are doing, but
    >> compare
    >> 
    >> foo1 <- function(...) length(..1)
    >>> foo2 <- function(...) length(list(...)[[1L]])
    >>> tracemem(x <- runif(1000))
    >>> 
    >> [1] "<0x1b27800>"
    >> 
    >>> foo1(x)
    >>> 
    >> [1] 1000
    >> 
    >>> tracemem(x <- runif(1000))
    >>> 
    >> [1] "<0x1b29800>"
    >> 
    >>> foo2(x)
    >>> 
    >> tracemem[0x1b29800 -> 0x10a2200]: foo2
    >> [1] 1000
    >> 
    >> 
    >> 
    >> <snip>
    >> --
    >> Brian D. Ripley,                  ripley at stats.ox.ac.uk
    >> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
    >> University of Oxford,             Tel:  +44 1865 272861 (self)
    >> 1 South Parks Road,                     +44 1865 272866 (PA)
    >> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
    >> 

    DM> [[alternative HTML version deleted]]

    DM> ______________________________________________
    DM> R-devel at r-project.org mailing list
    DM> https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Mon Jul  5 11:56:58 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 5 Jul 2010 11:56:58 +0200
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <4C3049C0.60101@pburns.seanet.com>
References: <4C3049C0.60101@pburns.seanet.com>
Message-ID: <19505.44138.313406.770145@lynne.math.ethz.ch>

>>>>> "PatB" == Patrick Burns <pburns at pburns.seanet.com>
>>>>>     on Sun, 04 Jul 2010 09:43:44 +0100 writes:

    PatB> Is there a reason that 'which.min' and
    PatB> 'which.max' don't have an 'arr.ind'
    PatB> argument?

well,  help(which.min)  tells you that they really were aimed at
doing their job *fast* for vectors.

Of course you are right and a generalization to arrays might be
convenient at times.

    PatB> The context in which I wanted that was
    PatB> a grid search optimization, which seems
    PatB> like it would be reasonably common to me.

well, as the author of these two functions, I can only say

      "patches are welcome!"

and I think should be pretty simple, right ?
You just have to do very simple remapping of the 1d index 'i' back
to the array index, i.e., the same operation
you need to transform seconds into days:hours:minutes:seconds
{{and yes, we old-timers may recall that APL had an operator (I
  think "T-bar") to do that ...}

Martin Maechler, ETH Zurich


    PatB> -- 
    PatB> Patrick Burns
    PatB> pburns at pburns.seanet.com
    PatB> http://www.burns-stat.com
    PatB> (home of 'Some hints for the R beginner'
    PatB> and 'The R Inferno')


From marc_schwartz at me.com  Mon Jul  5 14:24:38 2010
From: marc_schwartz at me.com (Marc Schwartz)
Date: Mon, 05 Jul 2010 07:24:38 -0500
Subject: [Rd] Possible bug in 2.11.x texmf makefile.in and some related
 things...
In-Reply-To: <alpine.LFD.2.00.1007050719020.25780@gannet.stats.ox.ac.uk>
References: <17AB3D1C-ACDF-4E03-B279-B750A60E804D@me.com>
	<alpine.LFD.2.00.1007050719020.25780@gannet.stats.ox.ac.uk>
Message-ID: <2A08F42A-348B-4EA1-9FE5-BFDCD1639E77@me.com>

On Jul 5, 2010, at 1:50 AM, Prof Brian Ripley wrote:

> On Sun, 4 Jul 2010, Marc Schwartz wrote:
> 
>> Hi all,
>> 
>> A list of some possible issues:
>> 
>> 1. In R 2.11.x, in:
>> 
>> http://svn.r-project.org/R/branches/R-2-11-branch/share/texmf/
>> 
>> there are two files, jss.cls and jss.bst (for JSS), which appear to be new since 2.10.x. These files are not installed when building/installing R. It would appear that they are not included in:
>> 
>> https://svn.r-project.org/R/branches/R-2-11-branch/share/Makefile.in
>> 
>> The relevant code there is:
>> 
>> 	@for f in $(srcdir)/texmf/*.sty \
>> 		  $(srcdir)/texmf/*.fd; do \
>> 	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf"; \
>> 	done
>> 
>> which would skip over the two jss files.
>> 
>> This issue came up when another useR (on F12) was building the zoo package with its vignette, which apparently uses jss.cls. Errors were of course observed. I thought that the error was limited to Fedora, but this is an issue in the source.
> 
> But there are a fair number of packages which need extra LaTeX files to build their vignettes, and e.g. the CRAN test systems have had to have these installed for a long time.  Certainly zoo has needed them from before 2.11.0, and many believe that a Open Source package needs to include copies of such files (see 'Writing R Extensions').


OK...so strictly speaking then, this is a bug in zoo(?), since it does not include those two files to build the relevant documents and would appear to presume that they are available on target build systems?  This is not an issue when installing the package, only when building it locally AFAICS, but lacking the two files, it would not otherwise pass R CMD check. The resultant PDF files are in the zoo source tarball and of course in the binaries.

What is interesting is that if one reviews the CRAN checks for zoo, there are notes for OSX related to jss.cls not being present. So I am guessing that the other OS CRAN build systems have the two files, but the OSX build system does not? That led to some confusion, as I was not sure whether the files were expected to be present, given that zoo passes the checks on the other OS's.


>> 2. On a related issue, the texmf tree appears to be modified in 2.12.x, with the latex and bibtex files being put into separate folders:
> 
> More precisely, it is a TDS-comformant tree now.


Makes sense....thanks.


> 
>> https://svn.r-project.org/R/trunk/share/texmf/
>> 
>> The makefile.in:
>> 
>> https://svn.r-project.org/R/trunk/share/Makefile.in
>> 
>> appears to be modified to handle that split:
>> 
>> 	@for f in $(srcdir)/texmf/bibtex/bst/*; do \
>> 	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf/bibtex/bst"; \
>> 	done
>> 	@for f in $(srcdir)/texmf/tex/latex/*; do \
>> 	  $(INSTALL_DATA) $${f} "$(DESTDIR)$(rsharedir)/texmf/tex/latex"; \
>> 	done
>> 
>> 
>> So there was perhaps an oversight of sorts for 2.11.x in handling these two JSS related files.
> 
> That's a different hand.  I don't know if the files were intended to be installed in 2.11.x: they are in R-devel so eventually packages depending on R >= 2.12.0 will be able to rely on them.
> 
>> 3. A final note, which is that the NEWS file appears to be missing from R-Devel tonight:
>> 
>> https://svn.r-project.org/R/trunk/
>> 
>> I was trying to read it to note any comments relevant to the above.
> 
> Correct.  You need to look in https://svn.r-project.org/R/trunk/doc/NEWS.Rd
> which says
> 
>      \item File \file{NEWS} is now generated at installation with a
>      slightly different format: it will be in UTF-8 on platforms using
>      UTF-8, and otherwise in ASCII.
> 
>      \item \file{NEWS} is no longer in the sources, but generated as
>      part of the installation.  The primary source for changes is now
>      \file{doc/NEWS.Rd}.
> 
> A version of the NEWS file will be in the tarballs.


OK. Again, thanks for the clarifications.

Regards,

Marc


From marc_schwartz at me.com  Mon Jul  5 14:58:06 2010
From: marc_schwartz at me.com (Marc Schwartz)
Date: Mon, 05 Jul 2010 07:58:06 -0500
Subject: [Rd] Possible bug in 2.11.x texmf makefile.in and some related
 things...
In-Reply-To: <4C318F32.7030404@gmail.com>
References: <17AB3D1C-ACDF-4E03-B279-B750A60E804D@me.com>
	<alpine.LFD.2.00.1007050719020.25780@gannet.stats.ox.ac.uk>
	<4C318F32.7030404@gmail.com>
Message-ID: <BB6B552F-D5AC-4D80-ADDE-03AF1FF79CCA@me.com>

On Jul 5, 2010, at 2:52 AM, Peter Dalgaard wrote:

> Prof Brian Ripley wrote:
> ....
>>> So there was perhaps an oversight of sorts for 2.11.x in handling 
>>> these two JSS related files.
>> 
>> That's a different hand.  I don't know if the files were intended to 
>> be installed in 2.11.x: they are in R-devel so eventually packages 
>> depending on R >= 2.12.0 will be able to rely on them.
>> 
> 
> 
> Looking through the logs, those two files were indeed committed to
> r-devel, but long before the creation of R-2-11-branch. They appear not
> to be used in any other part of the sources, so are indeed pretty
> useless if not copied to the tarball


So R has an appendix...  ;-)

Actually, they are in the 2.11.x tarballs. They are just not installed to the target directory tree after a build, given the code in the Makefile.in.


> (since we should not assume that
> people in general build from svn checkouts).


I do and have been for quite some time, but maybe I am just weird that way... 

:-)

Perhaps starting with 2.12.x, I will modify my build script to download the tarball instead.


> But as Brian points out,
> they are only two out of many files that could be included as a service
> to the user.
> 
>>> 3. A final note, which is that the NEWS file appears to be missing 
>>> from R-Devel tonight:
> ...
> 
>>       \item \file{NEWS} is no longer in the sources, but generated as
>>       part of the installation.  The primary source for changes is now
>>       \file{doc/NEWS.Rd}.
>> 
>> A version of the NEWS file will be in the tarballs.
> 
> Yes. It's generally a bad principle to have anything but the base
> sources in the repository, although we have had so for some things in
> the past (notably Java class files), because we couldn't rely on
> everyone having the appropriate tools. Especially with text files there
> will always be the risk of editing the target file instead of the
> source. (Just ask the editor of The R Journal how easy it is to remember
> to edit RJournal.dtx and not RJournal.sty...)


Yep.

Thanks Peter.

Regards,

Marc


From maechler at stat.math.ethz.ch  Mon Jul  5 18:54:36 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 5 Jul 2010 18:54:36 +0200
Subject: [Rd] kmeans
In-Reply-To: <AANLkTimbMVbBxRe4bAam8mNrL8QuUFcGncttVB1UT1RV@mail.gmail.com>
References: <AANLkTimbMVbBxRe4bAam8mNrL8QuUFcGncttVB1UT1RV@mail.gmail.com>
Message-ID: <19506.3660.7100.213608@lynne.math.ethz.ch>

>>>>> Gabor Grothendieck <ggrothendieck at gmail.com>
>>>>>     on Fri, 2 Jul 2010 18:50:28 -0400 writes:

    > In kmeans() in stats one gets an error message with the default
    > clustering algorithm if centers = 1.  Its often useful to calculate
    > the sum of squares for 1 cluster, 2 clusters, etc. and this error
    > complicates things since one has to treat 1 cluster as a special case.
    > A second reason is that easily getting the 1 cluster sum of squares
    > makes it easy to calculate the between cluster sum of squares when
    > there is more than 1 cluster.

    > I suggest adding the line marked ### to the source code of kmeans (the
    > other lines shown are just ther to illustrate context).  Adding this
    > line forces kmeans to use the code for algorithm 3 if centers is 1.
    > This is useful since unlike the code for the default algorithm, the
    > code for algorithm 3 succeeds for centers = 1.

    > if(length(centers) == 1) {
    > if (centers == 1) nmeth <- 3 ###
    > k <- centers

I agree that this is a reasonable improvement,
and have applied this (+ docu + example) to the R-devel sources.

Thank you, Gabor.


    > Also note that KMeans in Rcmdr produces a betweenss and a tot.withinss
    > and it would be nice if kmeans in stats did that too:

Well, patches (to the R-devel *sources*) are happily accepted 

Martin


    >> library(Rcmdr)
    >> str(KMeans(USArrests, 3))
    > List of 6
    > $ cluster     : Named int [1:50] 1 1 1 2 1 2 3 1 1 2 ...
    > ..- attr(*, "names")= chr [1:50] "Alabama" "Alaska" "Arizona" "Arkansas" ...
    > $ centers     : num [1:3, 1:4] 11.81 8.21 4.27 272.56 173.29 ...
    > ..- attr(*, "dimnames")=List of 2
    > .. ..$ : chr [1:3] "1" "2" "3"
    > .. ..$ : chr [1:4] "Murder" "Assault" "UrbanPop" "Rape"
    > $ withinss    : num [1:3] 19564 9137 19264
    > $ size        : int [1:3] 16 14 20
    > $ tot.withinss: num 47964  <=================
    > $ betweenss   : num 307844 <=================
    > - attr(*, "class")= chr "kmeans"

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From pburns at pburns.seanet.com  Mon Jul  5 20:27:20 2010
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Mon, 05 Jul 2010 19:27:20 +0100
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <19505.44138.313406.770145@lynne.math.ethz.ch>
References: <4C3049C0.60101@pburns.seanet.com>
	<19505.44138.313406.770145@lynne.math.ethz.ch>
Message-ID: <4C322408.3060206@pburns.seanet.com>

On 05/07/2010 10:56, Martin Maechler wrote:
>>>>>> "PatB" == Patrick Burns<pburns at pburns.seanet.com>
>>>>>>      on Sun, 04 Jul 2010 09:43:44 +0100 writes:
>
>      PatB>  Is there a reason that 'which.min' and
>      PatB>  'which.max' don't have an 'arr.ind'
>      PatB>  argument?
>
> well,  help(which.min)  tells you that they really were aimed at
> doing their job *fast* for vectors.
>
> Of course you are right and a generalization to arrays might be
> convenient at times.
>
>      PatB>  The context in which I wanted that was
>      PatB>  a grid search optimization, which seems
>      PatB>  like it would be reasonably common to me.
>
> well, as the author of these two functions, I can only say
>
>        "patches are welcome!"
>
> and I think should be pretty simple, right ?
> You just have to do very simple remapping of the 1d index 'i' back
> to the array index, i.e., the same operation
> you need to transform seconds into days:hours:minutes:seconds
> {{and yes, we old-timers may recall that APL had an operator (I
>    think "T-bar") to do that ...}

I think the exercise is just to copy the definition of
'which' and add four characters.

If the order of the if condition were reversed, then
possibly the slight reduction in speed of 'which.min'
and 'which.max' would be more than made up for in the
slight increase in speed of 'which'.

Pat

>
> Martin Maechler, ETH Zurich
>
>
>      PatB>  --
>      PatB>  Patrick Burns
>      PatB>  pburns at pburns.seanet.com
>      PatB>  http://www.burns-stat.com
>      PatB>  (home of 'Some hints for the R beginner'
>      PatB>  and 'The R Inferno')
>

-- 
Patrick Burns
pburns at pburns.seanet.com
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')


From hb at stat.berkeley.edu  Mon Jul  5 22:49:49 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 5 Jul 2010 22:49:49 +0200
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <4C322408.3060206@pburns.seanet.com>
References: <4C3049C0.60101@pburns.seanet.com>
	<19505.44138.313406.770145@lynne.math.ethz.ch>
	<4C322408.3060206@pburns.seanet.com>
Message-ID: <AANLkTil28yqzrVns5iUmgd7Ni1RpnjHTOQ-Q4YVqFiiz@mail.gmail.com>

For what it's worth, see arrayIndex() in R.utils, e.g.

# Single index
print(arrayIndex(21, dim=c(4,3,3)))

# Multiple indices
print(arrayIndex(20:23, dim=c(4,3,3)))

# Whole array
x <- array(1:30, dim=c(5,6))
print(arrayIndex(1:length(x), dim=dim(x)))

# Find (row,column) of maximum value
m <- diag(4-abs(-4:4))
print(arrayIndex(which.max(m), dim=dim(m)))

/Henrik

On Mon, Jul 5, 2010 at 8:27 PM, Patrick Burns <pburns at pburns.seanet.com> wrote:
> On 05/07/2010 10:56, Martin Maechler wrote:
>>>>>>>
>>>>>>> "PatB" == Patrick Burns<pburns at pburns.seanet.com>
>>>>>>> ? ? on Sun, 04 Jul 2010 09:43:44 +0100 writes:
>>
>> ? ? PatB> ?Is there a reason that 'which.min' and
>> ? ? PatB> ?'which.max' don't have an 'arr.ind'
>> ? ? PatB> ?argument?
>>
>> well, ?help(which.min) ?tells you that they really were aimed at
>> doing their job *fast* for vectors.
>>
>> Of course you are right and a generalization to arrays might be
>> convenient at times.
>>
>> ? ? PatB> ?The context in which I wanted that was
>> ? ? PatB> ?a grid search optimization, which seems
>> ? ? PatB> ?like it would be reasonably common to me.
>>
>> well, as the author of these two functions, I can only say
>>
>> ? ? ? "patches are welcome!"
>>
>> and I think should be pretty simple, right ?
>> You just have to do very simple remapping of the 1d index 'i' back
>> to the array index, i.e., the same operation
>> you need to transform seconds into days:hours:minutes:seconds
>> {{and yes, we old-timers may recall that APL had an operator (I
>> ? think "T-bar") to do that ...}
>
> I think the exercise is just to copy the definition of
> 'which' and add four characters.
>
> If the order of the if condition were reversed, then
> possibly the slight reduction in speed of 'which.min'
> and 'which.max' would be more than made up for in the
> slight increase in speed of 'which'.
>
> Pat
>
>>
>> Martin Maechler, ETH Zurich
>>
>>
>> ? ? PatB> ?--
>> ? ? PatB> ?Patrick Burns
>> ? ? PatB> ?pburns at pburns.seanet.com
>> ? ? PatB> ?http://www.burns-stat.com
>> ? ? PatB> ?(home of 'Some hints for the R beginner'
>> ? ? PatB> ?and 'The R Inferno')
>>
>
> --
> Patrick Burns
> pburns at pburns.seanet.com
> http://www.burns-stat.com
> (home of 'Some hints for the R beginner'
> and 'The R Inferno')
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hb at stat.berkeley.edu  Mon Jul  5 22:53:59 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 5 Jul 2010 22:53:59 +0200
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <AANLkTil28yqzrVns5iUmgd7Ni1RpnjHTOQ-Q4YVqFiiz@mail.gmail.com>
References: <4C3049C0.60101@pburns.seanet.com>
	<19505.44138.313406.770145@lynne.math.ethz.ch>
	<4C322408.3060206@pburns.seanet.com>
	<AANLkTil28yqzrVns5iUmgd7Ni1RpnjHTOQ-Q4YVqFiiz@mail.gmail.com>
Message-ID: <AANLkTik9VdisM61U80y5Eb4dDhgHWgwBkEpjB_ixFWtZ@mail.gmail.com>

...and, of course, just after sending it off I found out that from R
v2.11.0 there is now an arrayInd() in the 'base' package doing exactly
the same thing.  See help(arrayInd).

/Henrik

On Mon, Jul 5, 2010 at 10:49 PM, hb <hb at stat.berkeley.edu> wrote:
> For what it's worth, see arrayIndex() in R.utils, e.g.
>
> # Single index
> print(arrayIndex(21, dim=c(4,3,3)))
>
> # Multiple indices
> print(arrayIndex(20:23, dim=c(4,3,3)))
>
> # Whole array
> x <- array(1:30, dim=c(5,6))
> print(arrayIndex(1:length(x), dim=dim(x)))
>
> # Find (row,column) of maximum value
> m <- diag(4-abs(-4:4))
> print(arrayIndex(which.max(m), dim=dim(m)))
>
> /Henrik
>
> On Mon, Jul 5, 2010 at 8:27 PM, Patrick Burns <pburns at pburns.seanet.com> wrote:
>> On 05/07/2010 10:56, Martin Maechler wrote:
>>>>>>>>
>>>>>>>> "PatB" == Patrick Burns<pburns at pburns.seanet.com>
>>>>>>>> ? ? on Sun, 04 Jul 2010 09:43:44 +0100 writes:
>>>
>>> ? ? PatB> ?Is there a reason that 'which.min' and
>>> ? ? PatB> ?'which.max' don't have an 'arr.ind'
>>> ? ? PatB> ?argument?
>>>
>>> well, ?help(which.min) ?tells you that they really were aimed at
>>> doing their job *fast* for vectors.
>>>
>>> Of course you are right and a generalization to arrays might be
>>> convenient at times.
>>>
>>> ? ? PatB> ?The context in which I wanted that was
>>> ? ? PatB> ?a grid search optimization, which seems
>>> ? ? PatB> ?like it would be reasonably common to me.
>>>
>>> well, as the author of these two functions, I can only say
>>>
>>> ? ? ? "patches are welcome!"
>>>
>>> and I think should be pretty simple, right ?
>>> You just have to do very simple remapping of the 1d index 'i' back
>>> to the array index, i.e., the same operation
>>> you need to transform seconds into days:hours:minutes:seconds
>>> {{and yes, we old-timers may recall that APL had an operator (I
>>> ? think "T-bar") to do that ...}
>>
>> I think the exercise is just to copy the definition of
>> 'which' and add four characters.
>>
>> If the order of the if condition were reversed, then
>> possibly the slight reduction in speed of 'which.min'
>> and 'which.max' would be more than made up for in the
>> slight increase in speed of 'which'.
>>
>> Pat
>>
>>>
>>> Martin Maechler, ETH Zurich
>>>
>>>
>>> ? ? PatB> ?--
>>> ? ? PatB> ?Patrick Burns
>>> ? ? PatB> ?pburns at pburns.seanet.com
>>> ? ? PatB> ?http://www.burns-stat.com
>>> ? ? PatB> ?(home of 'Some hints for the R beginner'
>>> ? ? PatB> ?and 'The R Inferno')
>>>
>>
>> --
>> Patrick Burns
>> pburns at pburns.seanet.com
>> http://www.burns-stat.com
>> (home of 'Some hints for the R beginner'
>> and 'The R Inferno')
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>


From djsamperi at gmail.com  Tue Jul  6 01:53:33 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Mon, 5 Jul 2010 19:53:33 -0400
Subject: [Rd] Windows 64bit package build requires underscore hack?
Message-ID: <AANLkTilf-mv81CqcAv-DIWHY-k-aYNe7fkfFx-2iSuoW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100705/40b36499/attachment.pl>

From djsamperi at gmail.com  Tue Jul  6 02:20:35 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Mon, 5 Jul 2010 20:20:35 -0400
Subject: [Rd] Windows 64bit package build requires underscore hack?
In-Reply-To: <AANLkTilf-mv81CqcAv-DIWHY-k-aYNe7fkfFx-2iSuoW@mail.gmail.com>
References: <AANLkTilf-mv81CqcAv-DIWHY-k-aYNe7fkfFx-2iSuoW@mail.gmail.com>
Message-ID: <AANLkTin4sD0Uhn1m7seF9v4I93ArDsSbSF9Nu4O1aU0X@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100705/0fa5112b/attachment.pl>

From chiefmurphy at gmail.com  Tue Jul  6 07:35:44 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Mon, 5 Jul 2010 22:35:44 -0700
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <19505.43541.43754.85521@lynne.math.ethz.ch>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
	<AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
	<AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>
	<alpine.LFD.2.00.1007041223300.30947@gannet.stats.ox.ac.uk>
	<AANLkTilr6wTa3-twDfWL3z13lq5Gxz9-lHrvvF-hyjJj@mail.gmail.com>
	<19505.43541.43754.85521@lynne.math.ethz.ch>
Message-ID: <AANLkTil_tXr3rlt1o90VXdnkfmY4NYCYPkWd2cqPKdIx@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100705/ad9b4dbc/attachment.pl>

From chiefmurphy at gmail.com  Tue Jul  6 08:49:03 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Mon, 5 Jul 2010 23:49:03 -0700
Subject: [Rd] Attributes of 1st argument in ...
In-Reply-To: <AANLkTil_tXr3rlt1o90VXdnkfmY4NYCYPkWd2cqPKdIx@mail.gmail.com>
References: <AANLkTinkSMoLfFm5MGQwA5AGSkVvEEZJhw0GbhKYZ4lB@mail.gmail.com>
	<AANLkTimfOOA7u9pR3pDL-B0vMcunguwC0taMH7bHxlvT@mail.gmail.com>
	<AANLkTikqDu4eFMQd6tsUE9FW82GehHQxhfbMFV_tk3Hy@mail.gmail.com>
	<alpine.LFD.2.00.1007041223300.30947@gannet.stats.ox.ac.uk>
	<AANLkTilr6wTa3-twDfWL3z13lq5Gxz9-lHrvvF-hyjJj@mail.gmail.com>
	<19505.43541.43754.85521@lynne.math.ethz.ch>
	<AANLkTil_tXr3rlt1o90VXdnkfmY4NYCYPkWd2cqPKdIx@mail.gmail.com>
Message-ID: <AANLkTimdc3LSxXB1c54qE44SIRLi0wIXwB5i4Duk8D-9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100705/0d42b535/attachment.pl>

From maechler at stat.math.ethz.ch  Tue Jul  6 11:53:52 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 6 Jul 2010 11:53:52 +0200
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <AANLkTik9VdisM61U80y5Eb4dDhgHWgwBkEpjB_ixFWtZ@mail.gmail.com>
References: <4C3049C0.60101@pburns.seanet.com>
	<19505.44138.313406.770145@lynne.math.ethz.ch>
	<4C322408.3060206@pburns.seanet.com>
	<AANLkTil28yqzrVns5iUmgd7Ni1RpnjHTOQ-Q4YVqFiiz@mail.gmail.com>
	<AANLkTik9VdisM61U80y5Eb4dDhgHWgwBkEpjB_ixFWtZ@mail.gmail.com>
Message-ID: <19506.64816.96176.185437@lynne.math.ethz.ch>

>>>>> "HenrikB" == Henrik Bengtsson <hb at stat.berkeley.edu>
>>>>>     on Mon, 5 Jul 2010 22:53:59 +0200 writes:

    HenrikB> ...and, of course, just after sending it off I found out that from R
    HenrikB> v2.11.0 there is now an arrayInd() in the 'base' package doing exactly
    HenrikB> the same thing.  See help(arrayInd).

yes... and if you wondered *who* re-factored which() into its
internal the arrayInd() part .....
.....
had not known about the R.utils function.


[............]

    >> On Mon, Jul 5, 2010 at 8:27 PM, Patrick Burns <pburns at pburns.seanet.com> wrote:
    >>> On 05/07/2010 10:56, Martin Maechler wrote:
    >>>>>>>>> 
    >>>>>>>>> "PatB" == Patrick Burns<pburns at pburns.seanet.com>
    >>>>>>>>> ? ? on Sun, 04 Jul 2010 09:43:44 +0100 writes:
    >>>> 
    >>>> ? ? PatB> ?Is there a reason that 'which.min' and
    >>>> ? ? PatB> ?'which.max' don't have an 'arr.ind'
    >>>> ? ? PatB> ?argument?
    >>>> 
    >>>> well, ?help(which.min) ?tells you that they really were aimed at
    >>>> doing their job *fast* for vectors.
    >>>> 
    >>>> Of course you are right and a generalization to arrays might be
    >>>> convenient at times.
    >>>> 
    >>>> ? ? PatB> ?The context in which I wanted that was
    >>>> ? ? PatB> ?a grid search optimization, which seems
    >>>> ? ? PatB> ?like it would be reasonably common to me.
    >>>> 
    >>>> well, as the author of these two functions, I can only say
    >>>> 
    >>>> ? ? ? "patches are welcome!"
    >>>> 
    >>>> and I think should be pretty simple, right ?
    >>>> You just have to do very simple remapping of the 1d index 'i' back
    >>>> to the array index, i.e., the same operation
    >>>> you need to transform seconds into days:hours:minutes:seconds
    >>>> {{and yes, we old-timers may recall that APL had an operator (I
    >>>> ? think "T-bar") to do that ...}
    >>> 
    >>> I think the exercise is just to copy the definition of
    >>> 'which' and add four characters.

Well, yes.  But then, one reason for refactoring 'which' into its
vector and arrayInd() part was that people could use arrayInd()
on its own.

Wouldn't it make more sense to call

   arrayInd(which.min(mat), dim(mat))

instead of  
	    which.min(mat, arr.ind = TRUE)

in the spirit of modularity, maintainability, ... ?
Honestly, in my first reply I had forgotten about my own
arrayInd() modularization.... 

    >>> If the order of the if condition were reversed, then
    >>> possibly the slight reduction in speed of 'which.min'
    >>> and 'which.max' would be more than made up for in the
    >>> slight increase in speed of 'which'.

thanks for the hint, but

      "increase in speed of 'which'"  -- really, can you measure that?

(I'll reverse the order anyway)

If we are interested in speed increase, we should add an option
to *not* work with dimnames at all (*) and if we have programmer
time left, we could take it .Internal() and get a real
boost... not now though. 

(*) I'm doing that for now, *and* I would like to change the
    default behavior or arrayInd(), but of course *not* the
    default behavior of which(),
    to *not* attach dimnames to the result, by default.

  I.e., I'm proposing to add   'useNames = FALSE' as argument to
  arrayInd() but have  which() call arrayInd(..., useNames=TRUE).

  This is a back-compatibility change in arrayInd() -- which has
  existed only since 2.11.0 anyway, so would seem ok, to me.

  Opinions ?

--
Martin


From pburns at pburns.seanet.com  Tue Jul  6 12:34:27 2010
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Tue, 06 Jul 2010 11:34:27 +0100
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <19506.64816.96176.185437@lynne.math.ethz.ch>
References: <4C3049C0.60101@pburns.seanet.com>	<19505.44138.313406.770145@lynne.math.ethz.ch>	<4C322408.3060206@pburns.seanet.com>	<AANLkTil28yqzrVns5iUmgd7Ni1RpnjHTOQ-Q4YVqFiiz@mail.gmail.com>	<AANLkTik9VdisM61U80y5Eb4dDhgHWgwBkEpjB_ixFWtZ@mail.gmail.com>
	<19506.64816.96176.185437@lynne.math.ethz.ch>
Message-ID: <4C3306B3.3010200@pburns.seanet.com>

On 06/07/2010 10:53, Martin Maechler wrote:

[ ... ]

>
> Wouldn't it make more sense to call
>
>     arrayInd(which.min(mat), dim(mat))
>
> instead of
> 	    which.min(mat, arr.ind = TRUE)
>
> in the spirit of modularity, maintainability, ... ?
> Honestly, in my first reply I had forgotten about my own
> arrayInd() modularization....

Yes.  Then I guess the suggested change is to
put 'arrayInd' in the See Also and Examples for
'which.min' for dunderheads like me that don't
think of it themselves.

>
>      >>>  If the order of the if condition were reversed, then
>      >>>  possibly the slight reduction in speed of 'which.min'
>      >>>  and 'which.max' would be more than made up for in the
>      >>>  slight increase in speed of 'which'.
>
> thanks for the hint, but
>
>        "increase in speed of 'which'"  -- really, can you measure that?

I doubt it.

>
> (I'll reverse the order anyway)
>
> If we are interested in speed increase, we should add an option
> to *not* work with dimnames at all (*) and if we have programmer
> time left, we could take it .Internal() and get a real
> boost... not now though.
>
> (*) I'm doing that for now, *and* I would like to change the
>      default behavior or arrayInd(), but of course *not* the
>      default behavior of which(),
>      to *not* attach dimnames to the result, by default.
>
>    I.e., I'm proposing to add   'useNames = FALSE' as argument to
>    arrayInd() but have  which() call arrayInd(..., useNames=TRUE).
>
>    This is a back-compatibility change in arrayInd() -- which has
>    existed only since 2.11.0 anyway, so would seem ok, to me.
>
>    Opinions ?

I find it hard to believe that would cause
too much trauma.

Pat

>
> --
> Martin
>

-- 
Patrick Burns
pburns at pburns.seanet.com
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')


From hb at stat.berkeley.edu  Tue Jul  6 14:21:16 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Tue, 6 Jul 2010 14:21:16 +0200
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <19506.64816.96176.185437@lynne.math.ethz.ch>
References: <4C3049C0.60101@pburns.seanet.com>
	<19505.44138.313406.770145@lynne.math.ethz.ch>
	<4C322408.3060206@pburns.seanet.com>
	<AANLkTil28yqzrVns5iUmgd7Ni1RpnjHTOQ-Q4YVqFiiz@mail.gmail.com>
	<AANLkTik9VdisM61U80y5Eb4dDhgHWgwBkEpjB_ixFWtZ@mail.gmail.com>
	<19506.64816.96176.185437@lynne.math.ethz.ch>
Message-ID: <AANLkTinL_FozOrSaC0J14C9LRXi7XXz7DMcvgKyXwcKW@mail.gmail.com>

On Tue, Jul 6, 2010 at 11:53 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> "HenrikB" == Henrik Bengtsson <hb at stat.berkeley.edu>
> >>>>> ? ? on Mon, 5 Jul 2010 22:53:59 +0200 writes:
>
> ? ?HenrikB> ...and, of course, just after sending it off I found out that from R
> ? ?HenrikB> v2.11.0 there is now an arrayInd() in the 'base' package doing exactly
> ? ?HenrikB> the same thing. ?See help(arrayInd).
>
> yes... and if you wondered *who* re-factored which() into its
> internal the arrayInd() part .....
> .....
> had not known about the R.utils function.
>
>
> [............]
>
> ? ?>> On Mon, Jul 5, 2010 at 8:27 PM, Patrick Burns <pburns at pburns.seanet.com> wrote:
> ? ?>>> On 05/07/2010 10:56, Martin Maechler wrote:
> ? ?>>>>>>>>>
> ? ?>>>>>>>>> "PatB" == Patrick Burns<pburns at pburns.seanet.com>
> ? ?>>>>>>>>> ? ? on Sun, 04 Jul 2010 09:43:44 +0100 writes:
> ? ?>>>>
> ? ?>>>> ? ? PatB> ?Is there a reason that 'which.min' and
> ? ?>>>> ? ? PatB> ?'which.max' don't have an 'arr.ind'
> ? ?>>>> ? ? PatB> ?argument?
> ? ?>>>>
> ? ?>>>> well, ?help(which.min) ?tells you that they really were aimed at
> ? ?>>>> doing their job *fast* for vectors.
> ? ?>>>>
> ? ?>>>> Of course you are right and a generalization to arrays might be
> ? ?>>>> convenient at times.
> ? ?>>>>
> ? ?>>>> ? ? PatB> ?The context in which I wanted that was
> ? ?>>>> ? ? PatB> ?a grid search optimization, which seems
> ? ?>>>> ? ? PatB> ?like it would be reasonably common to me.
> ? ?>>>>
> ? ?>>>> well, as the author of these two functions, I can only say
> ? ?>>>>
> ? ?>>>> ? ? ? "patches are welcome!"
> ? ?>>>>
> ? ?>>>> and I think should be pretty simple, right ?
> ? ?>>>> You just have to do very simple remapping of the 1d index 'i' back
> ? ?>>>> to the array index, i.e., the same operation
> ? ?>>>> you need to transform seconds into days:hours:minutes:seconds
> ? ?>>>> {{and yes, we old-timers may recall that APL had an operator (I
> ? ?>>>> ? think "T-bar") to do that ...}
> ? ?>>>
> ? ?>>> I think the exercise is just to copy the definition of
> ? ?>>> 'which' and add four characters.
>
> Well, yes. ?But then, one reason for refactoring 'which' into its
> vector and arrayInd() part was that people could use arrayInd()
> on its own.
>
> Wouldn't it make more sense to call
>
> ? arrayInd(which.min(mat), dim(mat))
>
> instead of
> ? ? ? ? ? ?which.min(mat, arr.ind = TRUE)
>
> in the spirit of modularity, maintainability, ... ?
> Honestly, in my first reply I had forgotten about my own
> arrayInd() modularization....
>
> ? ?>>> If the order of the if condition were reversed, then
> ? ?>>> possibly the slight reduction in speed of 'which.min'
> ? ?>>> and 'which.max' would be more than made up for in the
> ? ?>>> slight increase in speed of 'which'.
>
> thanks for the hint, but
>
> ? ? ?"increase in speed of 'which'" ?-- really, can you measure that?
>
> (I'll reverse the order anyway)
>
> If we are interested in speed increase, we should add an option
> to *not* work with dimnames at all (*) and if we have programmer
> time left, we could take it .Internal() and get a real
> boost... not now though.
>
> (*) I'm doing that for now, *and* I would like to change the
> ? ?default behavior or arrayInd(), but of course *not* the
> ? ?default behavior of which(),
> ? ?to *not* attach dimnames to the result, by default.
>
> ?I.e., I'm proposing to add ? 'useNames = FALSE' as argument to
> ?arrayInd() but have ?which() call arrayInd(..., useNames=TRUE).

I second this.

/Henrik

>
> ?This is a back-compatibility change in arrayInd() -- which has
> ?existed only since 2.11.0 anyway, so would seem ok, to me.
>
> ?Opinions ?
>
> --
> Martin


From jayemerson at gmail.com  Tue Jul  6 14:38:26 2010
From: jayemerson at gmail.com (Jay Emerson)
Date: Tue, 6 Jul 2010 08:38:26 -0400
Subject: [Rd] Windows 64bit package build requires underscore hack?
Message-ID: <AANLkTin5TblK9FgxpCAlztckT6DgBIKWU_0mCzHW1w4I@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100706/68ddb7a0/attachment.pl>

From HodgessE at uhd.edu  Tue Jul  6 17:04:22 2010
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 6 Jul 2010 10:04:22 -0500
Subject: [Rd]  accessing underlying code
Message-ID: <101CBF5360343B45B9C9B0B05D71474C25B848@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100706/2c8bdee7/attachment.pl>

From shotwelm at musc.edu  Tue Jul  6 17:20:20 2010
From: shotwelm at musc.edu (Matt Shotwell)
Date: Tue, 06 Jul 2010 11:20:20 -0400
Subject: [Rd] accessing underlying code
In-Reply-To: <101CBF5360343B45B9C9B0B05D71474C25B848@BALI.uhd.campus>
References: <101CBF5360343B45B9C9B0B05D71474C25B848@BALI.uhd.campus>
Message-ID: <1278429620.17247.2.camel@deacon>

setup_starma is in src/library/stats/src/pacf.c

-Matt

On Tue, 2010-07-06 at 11:04 -0400, Hodgess, Erin wrote:
> Dear R Developers:
> 
> Is there a way to look at the underlying code from such items as R_setup_starma, please?
> 
> Thanks,
> Erin
> 
> 
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
Matthew S. Shotwell
Graduate Student
Division of Biostatistics and Epidemiology
Medical University of South Carolina
http://biostatmatt.com


From simon.urbanek at r-project.org  Tue Jul  6 17:22:31 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 6 Jul 2010 11:22:31 -0400
Subject: [Rd] accessing underlying code
In-Reply-To: <101CBF5360343B45B9C9B0B05D71474C25B848@BALI.uhd.campus>
References: <101CBF5360343B45B9C9B0B05D71474C25B848@BALI.uhd.campus>
Message-ID: <09F1CFBB-3E4C-4849-8567-6868657F3B48@r-project.org>


On Jul 6, 2010, at 11:04 AM, Hodgess, Erin wrote:

> Dear R Developers:
> 
> Is there a way to look at the underlying code from such items as R_setup_starma, please?
> 

Yes, of course, they are in the R sources (src/library/stats/src/pacf.c) - that's the beauty of open source.

Cheers,
Simon


From Vincent.Goulet at act.ulaval.ca  Tue Jul  6 20:32:05 2010
From: Vincent.Goulet at act.ulaval.ca (Vincent Goulet)
Date: Tue, 6 Jul 2010 14:32:05 -0400
Subject: [Rd] arr.ind argument to which.min and which.max
In-Reply-To: <19505.44138.313406.770145@lynne.math.ethz.ch>
References: <4C3049C0.60101@pburns.seanet.com>
	<19505.44138.313406.770145@lynne.math.ethz.ch>
Message-ID: <999CB31F-0D0D-4D25-B939-E501CAB41A7A@act.ulaval.ca>

Le lun. 5 juil. ? 05:56, Martin Maechler a ?crit :

>>>>>> "PatB" == Patrick Burns <pburns at pburns.seanet.com>
>>>>>>    on Sun, 04 Jul 2010 09:43:44 +0100 writes:
> 
>    PatB> Is there a reason that 'which.min' and
>    PatB> 'which.max' don't have an 'arr.ind'
>    PatB> argument?
> 
> well,  help(which.min)  tells you that they really were aimed at
> doing their job *fast* for vectors.
> 
> Of course you are right and a generalization to arrays might be
> convenient at times.
> 
>    PatB> The context in which I wanted that was
>    PatB> a grid search optimization, which seems
>    PatB> like it would be reasonably common to me.
> 
> well, as the author of these two functions, I can only say
> 
>      "patches are welcome!"
> 
> and I think should be pretty simple, right ?
> You just have to do very simple remapping of the 1d index 'i' back
> to the array index, i.e., the same operation
> you need to transform seconds into days:hours:minutes:seconds
> {{and yes, we old-timers may recall that APL had an operator (I
>  think "T-bar") to do that ...}

Ah, a reference to APL! That made my day. :-)

APL was very big among actuaries for a long time. I heard recently that it was still in use on an old system in some small insurance company. I still have on my shelves the reference books for APL*Plus III for Windows (that I ran in OS/2) from Magnugistics; they have an actuarial formula on the cover.

I teach my students arbitrary base conversion to do just what the encode/decode operators (to call them by their names) were doing. I see this new arrayInd() sort of does the same thing now. Darn, this steals me an exercise!

Cheers,

Vincent


> 
> Martin Maechler, ETH Zurich
> 
> 
>    PatB> -- 
>    PatB> Patrick Burns
>    PatB> pburns at pburns.seanet.com
>    PatB> http://www.burns-stat.com
>    PatB> (home of 'Some hints for the R beginner'
>    PatB> and 'The R Inferno')
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From HodgessE at uhd.edu  Tue Jul  6 21:24:17 2010
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 6 Jul 2010 14:24:17 -0500
Subject: [Rd]  using svd in regression with arima
Message-ID: <101CBF5360343B45B9C9B0B05D71474C25B84B@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100706/8f8e2b1d/attachment.pl>

From Robert.McGehee at geodecapital.com  Tue Jul  6 23:38:10 2010
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Tue, 6 Jul 2010 17:38:10 -0400
Subject: [Rd] with(x, Recall()) Crash
Message-ID: <EEBC169715EB8C438D3C9283AF0F201C08A7C9AF@MSGBOSCLM2WIN.DMN1.FMR.COM>

R-devel,
I discovered a segfault in my R code that boiled down to my incorrect
use of the Recall() function embedded within a with() function. Since
segfaults are generally bad things, even when it's the user's fault for
writing nonsense code, I thought I'd pass along the offending code. I've
tested the crash on R 2.11.1 (on Linux and Mac), but not in devel
versions of R. 

HTH, Robert

> x <- 1
> with(x, Recall())
*** caught segfault ***
address 0x1db, cause 'memory not mapped'

Traceback:
 1: eval(expr, envir, enclos)
 2: Recall()
 3: eval(expr, envir, enclos)
 4: eval(substitute(expr), data, enclos = parent.frame())
 5: with.default(x, Recall())
 6: with(x, Recall())

> R.version
               _
platform       x86_64-unknown-linux-gnu
arch           x86_64
os             linux-gnu
system         x86_64, linux-gnu
status
major          2
minor          11.1
year           2010
month          05
day            31
svn rev        52157
language       R
version.string R version 2.11.1 (2010-05-31)

Robert McGehee, CFA
Geode Capital Management, LLC
One Post Office Square, 28th Floor | Boston, MA | 02109
Tel: 617/392-8396    Fax:617/476-6389
mailto:robert.mcgehee at geodecapital.com


>This e-mail, and any attachments hereto, are intended for use by the
addressee(s) only and may contain information that is (i) confidential
information of Geode Capital Management, LLC and/or its affiliates,
and/or (ii) proprietary information of Geode Capital Management, LLC
and/or its affiliates. If you are not the intended recipient of this
e-mail, or if you have otherwise received this e-mail in error, please
immediately notify me by telephone (you may call collect), or by e-mail,
and please permanently delete the original, any print outs and any
copies of the foregoing. Any dissemination, distribution or copying of
this e-mail is strictly prohibited. 


From murdoch.duncan at gmail.com  Wed Jul  7 00:45:03 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 06 Jul 2010 18:45:03 -0400
Subject: [Rd] with(x, Recall()) Crash
In-Reply-To: <EEBC169715EB8C438D3C9283AF0F201C08A7C9AF@MSGBOSCLM2WIN.DMN1.FMR.COM>
References: <EEBC169715EB8C438D3C9283AF0F201C08A7C9AF@MSGBOSCLM2WIN.DMN1.FMR.COM>
Message-ID: <4C33B1EF.8090603@gmail.com>

On 06/07/2010 5:38 PM, McGehee, Robert wrote:
> R-devel,
> I discovered a segfault in my R code that boiled down to my incorrect
> use of the Recall() function embedded within a with() function. Since
> segfaults are generally bad things, even when it's the user's fault for
> writing nonsense code, I thought I'd pass along the offending code. I've
> tested the crash on R 2.11.1 (on Linux and Mac), but not in devel
> versions of R. 
>   

Thanks for posting that.  It does still exist on R-devel, and as you 
say, it shouldn't.  I'll fix it.

Duncan Murdoch
> HTH, Robert
>
>   
>> x <- 1
>> with(x, Recall())
>>     
> *** caught segfault ***
> address 0x1db, cause 'memory not mapped'
>
> Traceback:
>  1: eval(expr, envir, enclos)
>  2: Recall()
>  3: eval(expr, envir, enclos)
>  4: eval(substitute(expr), data, enclos = parent.frame())
>  5: with.default(x, Recall())
>  6: with(x, Recall())
>
>   
>> R.version
>>     
>                _
> platform       x86_64-unknown-linux-gnu
> arch           x86_64
> os             linux-gnu
> system         x86_64, linux-gnu
> status
> major          2
> minor          11.1
> year           2010
> month          05
> day            31
> svn rev        52157
> language       R
> version.string R version 2.11.1 (2010-05-31)
>
> Robert McGehee, CFA
> Geode Capital Management, LLC
> One Post Office Square, 28th Floor | Boston, MA | 02109
> Tel: 617/392-8396    Fax:617/476-6389
> mailto:robert.mcgehee at geodecapital.com
>
>
>   
>> This e-mail, and any attachments hereto, are intended for use by the
>>     
> addressee(s) only and may contain information that is (i) confidential
> information of Geode Capital Management, LLC and/or its affiliates,
> and/or (ii) proprietary information of Geode Capital Management, LLC
> and/or its affiliates. If you are not the intended recipient of this
> e-mail, or if you have otherwise received this e-mail in error, please
> immediately notify me by telephone (you may call collect), or by e-mail,
> and please permanently delete the original, any print outs and any
> copies of the foregoing. Any dissemination, distribution or copying of
> this e-mail is strictly prohibited. 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Wed Jul  7 07:39:07 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 7 Jul 2010 06:39:07 +0100 (BST)
Subject: [Rd] using svd in regression with arima
In-Reply-To: <101CBF5360343B45B9C9B0B05D71474C25B84B@BALI.uhd.campus>
References: <101CBF5360343B45B9C9B0B05D71474C25B84B@BALI.uhd.campus>
Message-ID: <alpine.LFD.2.00.1007070630560.26712@gannet.stats.ox.ac.uk>

On Tue, 6 Jul 2010, Hodgess, Erin wrote:

> Dear R Developers:
>
> Why is it that the singular value decomposition is used when running 
> regression with arima, please?  I've been looking for a reference 
> for that but have come up empty so far.

Do you mean this:

         if (!orig.xreg) {
             S <- svd(na.omit(xreg))
             xreg <- xreg %*% S$v
         }

?  That is a stability measure for the numerical optimization (it 
orthogonalizes the columns, ignoring NAs).

>
> Thank you for any help.
>
> Sincerely,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Julian.Taylor at csiro.au  Wed Jul  7 03:04:53 2010
From: Julian.Taylor at csiro.au (Julian.Taylor at csiro.au)
Date: Wed, 7 Jul 2010 11:04:53 +1000
Subject: [Rd] Large discrepancies in the same object being saved to .RData
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100707/c12f3026/attachment.pl>

From dutangc at gmail.com  Wed Jul  7 14:01:12 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Wed, 7 Jul 2010 14:01:12 +0200
Subject: [Rd] constrained optimization
Message-ID: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100707/40a877b3/attachment.pl>

From murdoch.duncan at gmail.com  Wed Jul  7 14:12:10 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 07 Jul 2010 08:12:10 -0400
Subject: [Rd] Large discrepancies in the same object being saved to
	.RData
In-Reply-To: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
Message-ID: <4C346F1A.8060302@gmail.com>

On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
> Hi developers,
>
>
>
> After some investigation I have found there can be large discrepancies in the same object being saved as an external "xx.RData" file. The immediate repercussion of this is the possible increased size of your .RData workspace for no apparent reason.
>
>
>
> The function and its three scenarios below highlight these discrepancies. Note that the object being returned is exactly the same in each circumstance. The first scenario simply loops over a set of lm() models from a simulated set of data. The second adds a reasonably large matrix calculation within the loop. The third highlights exactly where the discrepancy lies. It appears that when the object is saved to an "xx.RData" it is still burdened, in some capacity, with the objects created in the function. Only deleting these objects at the end of the function ensures the realistic size of the returned object. Performing gc() after each of these short simulations shows that the "Vcells" that are accumulated in the function environment appear to remain after the function returns. These cached remains are then transferred to the .RData upon saving of the object(s). This is occurring quite broadly across the Windows 7 (R 2.10.1) and 64 Bit Ubuntu Linux (R 2.9.0) systems that I use.
>
>
>
> A similar problem was partially pointed out four years ago
>
>
>
> http://tolstoy.newcastle.edu.au/R/help/06/03/24060.html
>
>
>
> and has been made more obvious in the scenarios given below.
>
>
>
> Admittedly I have had many problems with workspace .RData sizes over the years and it has taken me some time to realise what is actually occurring. Can someone enlighten myself and my colleagues as to why the objects created and evaluated in a function call stack are saved, in some capacity, with the returned object?
>   

I haven't worked through your example, but in general the way that local 
objects get captured is when part of the return value includes an 
environment.  Examples of things that include an environment are locally 
created functions and formulas.  It's probably the latter that you're 
seeing.  When R computes the result of "y ~ ." or a similar formula, it 
attaches a pointer to the environment in which the calculation took 
place, so that later when the formula is used, it can look up y there.  
For example, in your line

lm(y ~ ., data = dat)


from your code, the formula "y ~ ." needs to be computed before R knows 
that you've explicitly listed a dataframe holding the data, and before 
it knows whether the variable y is in that dataframe or is just a local 
variable in the current function.

Since these are just pointers to the environment, this doesn't take up 
much space in memory, but when you save the object to disk, a copy of 
the whole environment will be made, and that can end up wasting up a lot 
of space if the environment contains a lot of things that aren't needed 
by the formula.

Duncan Murdoch
>
> Cheers,
>
> Julian
>
>
>
> ####################### small simulation from a clean directory
>
>
>
> lmfunc <- function(loop = 20, add = FALSE, gr = FALSE){
>
>   lmlist <- rmlist <- list()
>
>   set.seed(100)
>
>   dat <- data.frame(matrix(rnorm(100*100), ncol = 100))
>
>   rm <- matrix(rnorm(100000), ncol = 1000)
>
>   names(dat)[1] <- "y"
>
>   i <- 1
>
>   for(i in 1:loop) {
>
>     lmlist[[i]] <- lm(y ~ ., data = dat)
>
>     if(add)
>
>         rmlist[[i]] <- rm
>
>   }
>
>   fm <- lmlist[[loop]]
>
>   if(gr) {
>
>     print(what <- ls(envir = sys.frame(which = 1)))
>
>     remove(list = setdiff(what, "fm"))
>
>   }
>
>   fm
>
> }
>
>
>
> # baseline gc()
>
>
>
>   
>> gc()
>>     
>
>           used (Mb) gc trigger (Mb) max used (Mb)
>
> Ncells 153325  4.1     350000  9.4   350000  9.4
>
> Vcells  99228  0.8     786432  6.0   386446  3.0
>
>
>
> ###### 1. simple lm() simulation
>
>
>
>   
>> lmtest1 <- lmfunc()
>>     
>
>   
>> gc()
>>     
>
>           used (Mb) gc trigger (Mb) max used (Mb)
>
> Ncells 184470  5.0     407500 10.9   350000  9.4
>
> Vcells 842169  6.5    1300721 10.0  1162577  8.9
>
>
>
>   
>> save(lmtest1, file = "lm1.RData")
>>     
>
>   
>> system("ls -s lm1.RData")
>>     
>
> 4312 lm1.RData
>
>
>
> ## A moderate increase in Vcells; .RData object around 4.5 Mb
>
>
>
> ###### 2. add matrix calculation to loop
>
>
>
>   
>> lmtest2 <- lmfunc(add = TRUE)
>>     
>
>   
>> gc()
>>     
>
>            used (Mb) gc trigger (Mb) max used (Mb)
>
> Ncells  209316  5.6     407500 10.9   405340 10.9
>
> Vcells 3584244 27.4    4175939 31.9  3900869 29.8
>
>
>
>   
>> save(lmtest2, file = "lm2.RData")
>>     
>
>   
>> system("ls -s lm2.RData")
>>     
>
> 19324 lm2.RData
>
>
>
> ## A enormous increase in Vcells; .RData object is now 19Mb+
>
>
>
> ###### 3. delete all objects in function call stack
>
>
>
>   
>> lmtest3 <- lmfunc(add = TRUE, gr = TRUE)
>>     
>
>   
>> gc()
>>     
>
>            used (Mb) gc trigger (Mb) max used (Mb)
>
> Ncells  210766  5.7     467875 12.5   467875 12.5
>
> Vcells 3615863 27.6    6933688 52.9  6898609 52.7
>
>
>
>   
>> save(lmtest3, file = "lm3.RData")
>>     
>
>   
>> system("ls -s lm3.RData")
>>     
>
> 320 lm3.RData
>
>
>
> ## A minimal increase in Vcells; .RData object is now 320Kb
>
>
>
>   
>> sapply(ls(pattern = "lmtest*"), function(x) object.size(get(x, envir = .GlobalEnv)))
>>     
>
> lmtest1 lmtest2 lmtest3
>
>  358428  358428  358428
>
>
>
> ## all objects are deemed the same size by object.size()
>
> ######################### End sim
>
> --
> ---
> Dr. Julian Taylor                     phone: +61 8 8303 8792
> Postdoctoral Fellow                     fax: +61 8 8303 8763
> CMIS, CSIRO                          mobile: +61 4 1638 8180
> Private Mail Bag 2                    email: julian.taylor at csiro.au
> Glen Osmond, SA, 5064
> ---
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


From rvaradhan at jhmi.edu  Wed Jul  7 15:10:18 2010
From: rvaradhan at jhmi.edu (Ravi Varadhan)
Date: Wed, 7 Jul 2010 09:10:18 -0400
Subject: [Rd] constrained optimization
In-Reply-To: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
Message-ID: <000f01cb1dd5$bf644450$3e2cccf0$@edu>

Hi Christophe,

I have an algorithm for solving nonlinearly constrained optimization. It is
a combination of an interior point (for inequalities) algorithm with an
augmented Lagrangian (for equalities).  It is coded entirely in R, and hence
is a bit slow, but it seems to do the job quite robustly in terms of
handling poor starting values.  I can send this to you, if you are
interested.

Ravi.

-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
On Behalf Of Christophe Dutang
Sent: Wednesday, July 07, 2010 8:01 AM
To: r-devel at r-project.org
Subject: [Rd] constrained optimization

Dear list,

The task view on optimization does not reference a package for non linear
constrained optimization problems. Stefan Theussl told me to look at the
Rsolnp package, but unfortunately it is not very clear what method is R
ported. (The authors ported the matlab code of Yinyu Ye
http://www.stanford.edu/~yyye/ <http://www.stanford.edu/%7Eyyye/>)

Currently I'm looking for an implementation of sequential quadratic
programming to replicate SNOPT*. A good reference I found on the web is this
booklet
http://www2.imm.dtu.dk/pubdb/views/edoc_download.php/5456/pdf/imm5456.pdf .

Does anyone know an implementation of such algorithms? Is there any fortran
implementation available useful if I have to implement it?

Thanks in advance

Christophe


* SNOPT: An SQP Algorithm For Large-Scale Constrained Optimization (1997) by
Philip E. Gill ,  Walter Murray ,  Michael ,  Michael A. Saunders
-- 
Christophe DUTANG
Ph. D. student at ISFA, Lyon, France

	[[alternative HTML version deleted]]

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From james.foadi at diamond.ac.uk  Wed Jul  7 17:09:52 2010
From: james.foadi at diamond.ac.uk (james.foadi at diamond.ac.uk)
Date: Wed, 7 Jul 2010 16:09:52 +0100
Subject: [Rd] how to define method for "+" function in a new class
References: <EXCHANGE417Ie8tlMaz00000c08@exchangegw1.rl.ac.uk>
Message-ID: <4854F2500EA8C4478A508D2D92973E5202E812CC@EXCHANGE25.fed.cclrc.ac.uk>



Dear R developers,
I have a new class, which I called "Molecule", and have tried to define =
a "+" operation for 2 objects of this class.
This is what I have written so far, although the method is not complete =
(I'm trying to look at it at intermediate stages):

setMethod(
          f=3D"+",
          signature(x=3D"Molecule",y=3D"Molecule"),
          definition=3Dfunction(x,y,...)
                     {
                      # Check both objects are correct
                      checkMolecule(x)
                      checkMolecule(y)

                      # Extract chains information
                      ch1 <- getMoleculeChains(x)
                      ch2 <- getMoleculeChains(y)
                      union_ch <- unique(c(ch1,ch2))
                      not_used <- .ALPHABET
                      for (i in seq(along =3D union_ch))
                      {
                       idx <- which(not_used !=3D union_ch[i])
                       if (length(idx) !=3D 0) not_used <- not_used[idx]
                      }

                      return(not_used)
                     }
         )


The definition of class Molecule is included earlier in the same file. =
When I source it, I get the following error message:

Error in match.call(fun, fcall) :=20
  unused argument(s) (x =3D "Molecule", y =3D "Molecule")


I can't see what's wrong in my method definition. Can anyone help me =
with this?

J

Dr James Foadi PhD
Membrane Protein Laboratory (MPL)
Diamond Light Source Ltd
Diamond House
Harewell Science and Innovation Campus
Chilton, Didcot
Oxfordshire OX11 0DE

Email    :  james.foadi at diamond.ac.uk
Alt Email:  j.foadi at imperial.ac.uk

-- 
This e-mail and any attachments may contain confidential...{{dropped:8}}


From james.foadi at diamond.ac.uk  Wed Jul  7 17:16:50 2010
From: james.foadi at diamond.ac.uk (james.foadi at diamond.ac.uk)
Date: Wed, 7 Jul 2010 16:16:50 +0100
Subject: [Rd] how to define method for "+" function in a new class
References: <EXCHANGE417Ie8tlMaz00000c08@exchangegw1.rl.ac.uk>
	<4854F2500EA8C4478A508D2D92973E5202E812CC@EXCHANGE25.fed.cclrc.ac.uk>
Message-ID: <4854F2500EA8C4478A508D2D92973E5202E812CD@EXCHANGE25.fed.cclrc.ac.uk>

I don't know why a "3D" appears instead of a "(".
Please, interpret a "( whenever you see a "3D".

J

Dr James Foadi PhD
Membrane Protein Laboratory (MPL)
Diamond Light Source Ltd
Diamond House
Harewell Science and Innovation Campus
Chilton, Didcot
Oxfordshire OX11 0DE

Email    :  james.foadi at diamond.ac.uk
Alt Email:  j.foadi at imperial.ac.uk



-----Original Message-----
From: r-devel-bounces at r-project.org on behalf of james.foadi at diamond.ac.uk
Sent: Wed 07/07/2010 16:09
To: r-devel at r-project.org
Subject: [Rd] how to define method for "+" function in a new class
 


Dear R developers,
I have a new class, which I called "Molecule", and have tried to define =
a "+" operation for 2 objects of this class.
This is what I have written so far, although the method is not complete =
(I'm trying to look at it at intermediate stages):

setMethod(
          f=3D"+",
          signature(x=3D"Molecule",y=3D"Molecule"),
          definition=3Dfunction(x,y,...)
                     {
                      # Check both objects are correct
                      checkMolecule(x)
                      checkMolecule(y)

                      # Extract chains information
                      ch1 <- getMoleculeChains(x)
                      ch2 <- getMoleculeChains(y)
                      union_ch <- unique(c(ch1,ch2))
                      not_used <- .ALPHABET
                      for (i in seq(along =3D union_ch))
                      {
                       idx <- which(not_used !=3D union_ch[i])
                       if (length(idx) !=3D 0) not_used <- not_used[idx]
                      }

                      return(not_used)
                     }
         )


The definition of class Molecule is included earlier in the same file. =
When I source it, I get the following error message:

Error in match.call(fun, fcall) :=20
  unused argument(s) (x =3D "Molecule", y =3D "Molecule")


I can't see what's wrong in my method definition. Can anyone help me =
with this?

J

Dr James Foadi PhD
Membrane Protein Laboratory (MPL)
Diamond Light Source Ltd
Diamond House
Harewell Science and Innovation Campus
Chilton, Didcot
Oxfordshire OX11 0DE

Email    :  james.foadi at diamond.ac.uk
Alt Email:  j.foadi at imperial.ac.uk

-- 
This e-mail and any attachments may contain confidential...{{dropped:16}}


From shotwelm at musc.edu  Wed Jul  7 17:39:37 2010
From: shotwelm at musc.edu (Matt Shotwell)
Date: Wed, 07 Jul 2010 11:39:37 -0400
Subject: [Rd] read, write generics?
Message-ID: <1278517177.4853.45.camel@deacon>

R-devel list,

I'm working on a wrapper for R to the POSIX terminal interface. I'd like
to make this code available as a package (as well as a connection
patch).

The 'seek', 'truncate', 'flush', 'open', and 'close' generic functions
are a great help for the packaged interface. The only two missing are
'read' and 'write' generics, but I realize write is currently a wrapper
to 'cat'.

What are your thoughts on adding 'read', and converting 'write' to
generics in a manner similar to 'seek' and friends?

Also, I'd like to use R's 'iconv' function to re-encode text from tty
data, but this is apparently restricted to character encodings that do
not permit embedded NUL characters. I wrote to R-devel about this
earlier [1], with potential solution. Any thoughts on this?

-Matt

[1] http://tolstoy.newcastle.edu.au/R/e10/devel/10/06/0648.html

-- 
Matthew S. Shotwell
Graduate Student
Division of Biostatistics and Epidemiology
Medical University of South Carolina


From mtmorgan at fhcrc.org  Wed Jul  7 17:43:28 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Wed, 07 Jul 2010 08:43:28 -0700
Subject: [Rd] how to define method for "+" function in a new class
In-Reply-To: <4854F2500EA8C4478A508D2D92973E5202E812CC@EXCHANGE25.fed.cclrc.ac.uk>
References: <EXCHANGE417Ie8tlMaz00000c08@exchangegw1.rl.ac.uk>
	<4854F2500EA8C4478A508D2D92973E5202E812CC@EXCHANGE25.fed.cclrc.ac.uk>
Message-ID: <4C34A0A0.8030001@fhcrc.org>

On 07/07/2010 08:09 AM, james.foadi at diamond.ac.uk wrote:
> 
> 
> Dear R developers,
> I have a new class, which I called "Molecule", and have tried to define =
> a "+" operation for 2 objects of this class.
> This is what I have written so far, although the method is not complete =
> (I'm trying to look at it at intermediate stages):
> 
> setMethod(
>           f=3D"+",
>           signature(x=3D"Molecule",y=3D"Molecule"),
>           definition=3Dfunction(x,y,...)
>                      {
>                       # Check both objects are correct
>                       checkMolecule(x)
>                       checkMolecule(y)
> 
>                       # Extract chains information
>                       ch1 <- getMoleculeChains(x)
>                       ch2 <- getMoleculeChains(y)
>                       union_ch <- unique(c(ch1,ch2))
>                       not_used <- .ALPHABET
>                       for (i in seq(along =3D union_ch))
>                       {
>                        idx <- which(not_used !=3D union_ch[i])
>                        if (length(idx) !=3D 0) not_used <- not_used[idx]
>                       }
> 
>                       return(not_used)
>                      }
>          )
> 
> 
> The definition of class Molecule is included earlier in the same file. =
> When I source it, I get the following error message:
> 
> Error in match.call(fun, fcall) :=20
>   unused argument(s) (x =3D "Molecule", y =3D "Molecule")

If I

> getGeneric("+")
standardGeneric for "+" defined from package "base"
  belonging to group(s): Arith

function (e1, e2)
standardGeneric("+", .Primitive("+"))
<environment: 0xb432f8>
Methods may be defined for arguments: e1, e2
Use  showMethods("+")  for currently available ones.

I see that the generic is defined to take two arguments e1 and e2. So

setMethod("+", c("Molecule", "Molecule"), function(e1, e2) {
    ## ...
})

but actually here it might often pay to discover ?GroupGenericFunctions
and end up with something like


setClass("A", representation=representation(x="numeric"))

setMethod("Arith", c("A", "A"), function(e1, e2) {
   new(class(e1), x=callGeneric(e1=e1 at x, e2=e2 at x))
})

and then

> new("A", x=1:5) + new("A", x=5:1)
An object of class "A"
Slot "x":
[1] 6 6 6 6 6

but also

> new("A", x=1:5) * new("A", x=5:1)
An object of class "A"
Slot "x":
[1] 5 8 9 8 5

Martin

> 
> 
> I can't see what's wrong in my method definition. Can anyone help me =
> with this?
> 
> J
> 
> Dr James Foadi PhD
> Membrane Protein Laboratory (MPL)
> Diamond Light Source Ltd
> Diamond House
> Harewell Science and Innovation Campus
> Chilton, Didcot
> Oxfordshire OX11 0DE
> 
> Email    :  james.foadi at diamond.ac.uk
> Alt Email:  j.foadi at imperial.ac.uk
> 


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From james.foadi at diamond.ac.uk  Wed Jul  7 17:56:38 2010
From: james.foadi at diamond.ac.uk (james.foadi at diamond.ac.uk)
Date: Wed, 7 Jul 2010 16:56:38 +0100
Subject: [Rd] how to define method for "+" function in a new class
References: <EXCHANGE417Ie8tlMaz00000c08@exchangegw1.rl.ac.uk>
	<4854F2500EA8C4478A508D2D92973E5202E812CC@EXCHANGE25.fed.cclrc.ac.uk>
	<4C34A0A0.8030001@fhcrc.org>
Message-ID: <4854F2500EA8C4478A508D2D92973E5202E812D0@EXCHANGE25.fed.cclrc.ac.uk>

Thank you, Martin! Very clear.

J

Dr James Foadi PhD
Membrane Protein Laboratory (MPL)
Diamond Light Source Ltd
Diamond House
Harewell Science and Innovation Campus
Chilton, Didcot
Oxfordshire OX11 0DE

Email    :  james.foadi at diamond.ac.uk
Alt Email:  j.foadi at imperial.ac.uk



-----Original Message-----
From: Martin Morgan [mailto:mtmorgan at fhcrc.org]
Sent: Wed 07/07/2010 16:43
To: Foadi, James (Imperial Coll.,RAL,DIA)
Cc: r-devel at r-project.org
Subject: Re: [Rd] how to define method for "+" function in a new class
 
On 07/07/2010 08:09 AM, james.foadi at diamond.ac.uk wrote:
> 
> 
> Dear R developers,
> I have a new class, which I called "Molecule", and have tried to define =
> a "+" operation for 2 objects of this class.
> This is what I have written so far, although the method is not complete =
> (I'm trying to look at it at intermediate stages):
> 
> setMethod(
>           f=3D"+",
>           signature(x=3D"Molecule",y=3D"Molecule"),
>           definition=3Dfunction(x,y,...)
>                      {
>                       # Check both objects are correct
>                       checkMolecule(x)
>                       checkMolecule(y)
> 
>                       # Extract chains information
>                       ch1 <- getMoleculeChains(x)
>                       ch2 <- getMoleculeChains(y)
>                       union_ch <- unique(c(ch1,ch2))
>                       not_used <- .ALPHABET
>                       for (i in seq(along =3D union_ch))
>                       {
>                        idx <- which(not_used !=3D union_ch[i])
>                        if (length(idx) !=3D 0) not_used <- not_used[idx]
>                       }
> 
>                       return(not_used)
>                      }
>          )
> 
> 
> The definition of class Molecule is included earlier in the same file. =
> When I source it, I get the following error message:
> 
> Error in match.call(fun, fcall) :=20
>   unused argument(s) (x =3D "Molecule", y =3D "Molecule")

If I

> getGeneric("+")
standardGeneric for "+" defined from package "base"
  belonging to group(s): Arith

function (e1, e2)
standardGeneric("+", .Primitive("+"))
<environment: 0xb432f8>
Methods may be defined for arguments: e1, e2
Use  showMethods("+")  for currently available ones.

I see that the generic is defined to take two arguments e1 and e2. So

setMethod("+", c("Molecule", "Molecule"), function(e1, e2) {
    ## ...
})

but actually here it might often pay to discover ?GroupGenericFunctions
and end up with something like


setClass("A", representation=representation(x="numeric"))

setMethod("Arith", c("A", "A"), function(e1, e2) {
   new(class(e1), x=callGeneric(e1=e1 at x, e2=e2 at x))
})

and then

> new("A", x=1:5) + new("A", x=5:1)
An object of class "A"
Slot "x":
[1] 6 6 6 6 6

but also

> new("A", x=1:5) * new("A", x=5:1)
An object of class "A"
Slot "x":
[1] 5 8 9 8 5

Martin

> 
> 
> I can't see what's wrong in my method definition. Can anyone help me =
> with this?
> 
> J
> 
> Dr James Foadi PhD
> Membrane Protein Laboratory (MPL)
> Diamond Light Source Ltd
> Diamond House
> Harewell Science and Innovation Campus
> Chilton, Didcot
> Oxfordshire OX11 0DE
> 
> Email    :  james.foadi at diamond.ac.uk
> Alt Email:  j.foadi at imperial.ac.uk
> 


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


-- 
This e-mail and any attachments may contain confidential...{{dropped:8}}


From dutangc at gmail.com  Wed Jul  7 18:23:42 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Wed, 7 Jul 2010 18:23:42 +0200
Subject: [Rd] constrained optimization
In-Reply-To: <AANLkTiklWVWnIjDej3D-qi6C1SFHMn3OTs3ZNwSN6xW4@mail.gmail.com>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
	<AANLkTiklWVWnIjDej3D-qi6C1SFHMn3OTs3ZNwSN6xW4@mail.gmail.com>
Message-ID: <AANLkTikD-DVVWF2jvfuMbmTJ_fiswpZpKnSAQdQsuY40@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100707/aaab95fa/attachment.pl>

From dutangc at gmail.com  Wed Jul  7 18:25:52 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Wed, 7 Jul 2010 18:25:52 +0200
Subject: [Rd] constrained optimization
In-Reply-To: <001701cb1dd7$6dbf7870$493e6950$@edu>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
	<000f01cb1dd5$bf644450$3e2cccf0$@edu>
	<D611103AA7EE3B4DAE7F7D49C72B291A02AEE3BC@EXMAIL2.bocad.bank-banque-canada.ca>
	<001701cb1dd7$6dbf7870$493e6950$@edu>
Message-ID: <AANLkTimgMEuzwbmdS7rAAeP8jULAEStcN-yRsvG8UoH3@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100707/4e29d25b/attachment.pl>

From pdbailey at umd.edu  Wed Jul  7 19:49:43 2010
From: pdbailey at umd.edu (Paul Bailey)
Date: Wed, 7 Jul 2010 10:49:43 -0700 (PDT)
Subject: [Rd] constrained optimization
In-Reply-To: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
Message-ID: <1278524983159-2281282.post@n4.nabble.com>


Have you considered using the optim function with L-BFGS-B for bounded
optimization. Obviously, you will have to do changes of variables so that
everything is in terms of a rectangle (which is the type of bounding that it
accepts).

I believe it is based on "A LIMITED MEMORY ALGORITHM FOR BOUND CONSTRAINED
OPTIMIZATION" By Richard H Byrd,  Peihuang Lu, Jorge Nocedal, and Ciyou Zhu.
Technical Report NAM-08, May 1994.

They also have a paper on the exact implementation. I also believe that R
uses the code from Nocedal et al.
-- 
View this message in context: http://r.789695.n4.nabble.com/constrained-optimization-tp2280809p2281282.html
Sent from the R devel mailing list archive at Nabble.com.


From djsamperi at gmail.com  Wed Jul  7 20:09:13 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Wed, 7 Jul 2010 14:09:13 -0400
Subject: [Rd] constrained optimization
In-Reply-To: <1278524983159-2281282.post@n4.nabble.com>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
	<1278524983159-2281282.post@n4.nabble.com>
Message-ID: <AANLkTiktpTlAaLmySyvZ4H2_sC1dzQayCa7SmWbCv1hN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100707/b752f4b8/attachment.pl>

From pdbailey at umd.edu  Wed Jul  7 20:27:06 2010
From: pdbailey at umd.edu (Paul Bailey)
Date: Wed, 7 Jul 2010 11:27:06 -0700 (PDT)
Subject: [Rd] Accessing options of L-BFGS-B
Message-ID: <1278527226338-2281324.post@n4.nabble.com>


Hi,

I use L-BFGS-B heavily and I want access to some of the options in the code
that R calls but does not provide access to. There are some knobs on the
convergence criteria that are not accessible via optim, specifically, I want
to require a maximum gradient (obviously, it is actually some norm of the
gradient vector so that the requirement is 1 dimensional). I want to do this
because rerunning from various starting points gives me poor convergence and
my own (pure-R) L-BFGS has a poor line search algorithm that sometimes
fails.

Is there a simple way to do this?

As an alternative, the BFGS type papers tend to be long on the BFGS
explanations and short on the line search explanations. If someone pointed
me to a good line search paper that uses the Wolfe conditions...

Thanks,
Paul Bailey
-- 
View this message in context: http://r.789695.n4.nabble.com/Accessing-options-of-L-BFGS-B-tp2281324p2281324.html
Sent from the R devel mailing list archive at Nabble.com.


From pdbailey at umd.edu  Thu Jul  8 06:52:29 2010
From: pdbailey at umd.edu (Paul Bailey)
Date: Wed, 7 Jul 2010 21:52:29 -0700 (PDT)
Subject: [Rd] pass-by-reference
Message-ID: <1278564749228-2281802.post@n4.nabble.com>


I'm working with a large object that I want to modify slightly in a function.
Pass-by-reference would make a lot of sense, but I don't know how to do it.

I've searched this archive and thought that I can do something like

f <- function(x) {
  v1 <- list(a=x,b=3)
  g(x)
  v1
}
g <- function(x) {
  frame <- parent.frame()
  assign("v1",list(a=x,b=x),frame)
}
f(4)
returns list(a=4,b=4)

but what if I wanted to make v1[[1]] = v1[[1]] + v1[[2]] without creating a
copy of v1? 

f2 <- function(x) {
  v1 <- list(a=x,b=3)
  g2(x)
  v1
}
g2 <- function(x) {
  frame <- parent.frame()
  v1 <- get("v1",envir=frame)
  v1[[1]] <- v1[[1]] + v1[[2]]
}
f2(4)

but this fails. (it returns list(a=4,b=3) because v1 was copied into g2, not
passed by reference) Is there a way to do this?
-- 
View this message in context: http://r.789695.n4.nabble.com/pass-by-reference-tp2281802p2281802.html
Sent from the R devel mailing list archive at Nabble.com.


From hb at stat.berkeley.edu  Thu Jul  8 09:14:35 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 8 Jul 2010 09:14:35 +0200
Subject: [Rd] pass-by-reference
In-Reply-To: <1278564749228-2281802.post@n4.nabble.com>
References: <1278564749228-2281802.post@n4.nabble.com>
Message-ID: <AANLkTil0RDbUb5LydnddH2OG5YLsZyxGYF8-wm1FxMnq@mail.gmail.com>

See packages R.oo and proto.

If you wish to do it yourself, you want to utilize environments for this.

/Henrik

On Thu, Jul 8, 2010 at 6:52 AM, Paul Bailey <pdbailey at umd.edu> wrote:
>
> I'm working with a large object that I want to modify slightly in a function.
> Pass-by-reference would make a lot of sense, but I don't know how to do it.
>
> I've searched this archive and thought that I can do something like
>
> f <- function(x) {
> ?v1 <- list(a=x,b=3)
> ?g(x)
> ?v1
> }
> g <- function(x) {
> ?frame <- parent.frame()
> ?assign("v1",list(a=x,b=x),frame)
> }
> f(4)
> returns list(a=4,b=4)
>
> but what if I wanted to make v1[[1]] = v1[[1]] + v1[[2]] without creating a
> copy of v1?
>
> f2 <- function(x) {
> ?v1 <- list(a=x,b=3)
> ?g2(x)
> ?v1
> }
> g2 <- function(x) {
> ?frame <- parent.frame()
> ?v1 <- get("v1",envir=frame)
> ?v1[[1]] <- v1[[1]] + v1[[2]]
> }
> f2(4)
>
> but this fails. (it returns list(a=4,b=3) because v1 was copied into g2, not
> passed by reference) Is there a way to do this?
> --
> View this message in context: http://r.789695.n4.nabble.com/pass-by-reference-tp2281802p2281802.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hb at stat.berkeley.edu  Thu Jul  8 09:20:11 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 8 Jul 2010 09:20:11 +0200
Subject: [Rd] pass-by-reference
In-Reply-To: <AANLkTil0RDbUb5LydnddH2OG5YLsZyxGYF8-wm1FxMnq@mail.gmail.com>
References: <1278564749228-2281802.post@n4.nabble.com>
	<AANLkTil0RDbUb5LydnddH2OG5YLsZyxGYF8-wm1FxMnq@mail.gmail.com>
Message-ID: <AANLkTimaPEMLCRv6qSCA1d7y0BWw0Frw7D831cMdpAPm@mail.gmail.com>

...and for tracing memory allocations/duplications, see tracemem().

/Henrik

On Thu, Jul 8, 2010 at 9:14 AM, Henrik Bengtsson <hb at stat.berkeley.edu> wrote:
> See packages R.oo and proto.
>
> If you wish to do it yourself, you want to utilize environments for this.
>
> /Henrik
>
> On Thu, Jul 8, 2010 at 6:52 AM, Paul Bailey <pdbailey at umd.edu> wrote:
>>
>> I'm working with a large object that I want to modify slightly in a function.
>> Pass-by-reference would make a lot of sense, but I don't know how to do it.
>>
>> I've searched this archive and thought that I can do something like
>>
>> f <- function(x) {
>> ?v1 <- list(a=x,b=3)
>> ?g(x)
>> ?v1
>> }
>> g <- function(x) {
>> ?frame <- parent.frame()
>> ?assign("v1",list(a=x,b=x),frame)
>> }
>> f(4)
>> returns list(a=4,b=4)
>>
>> but what if I wanted to make v1[[1]] = v1[[1]] + v1[[2]] without creating a
>> copy of v1?
>>
>> f2 <- function(x) {
>> ?v1 <- list(a=x,b=3)
>> ?g2(x)
>> ?v1
>> }
>> g2 <- function(x) {
>> ?frame <- parent.frame()
>> ?v1 <- get("v1",envir=frame)
>> ?v1[[1]] <- v1[[1]] + v1[[2]]
>> }
>> f2(4)
>>
>> but this fails. (it returns list(a=4,b=3) because v1 was copied into g2, not
>> passed by reference) Is there a way to do this?
>> --
>> View this message in context: http://r.789695.n4.nabble.com/pass-by-reference-tp2281802p2281802.html
>> Sent from the R devel mailing list archive at Nabble.com.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From ggrothendieck at gmail.com  Thu Jul  8 13:02:31 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 8 Jul 2010 07:02:31 -0400
Subject: [Rd] pass-by-reference
In-Reply-To: <1278564749228-2281802.post@n4.nabble.com>
References: <1278564749228-2281802.post@n4.nabble.com>
Message-ID: <AANLkTikVa4qG4pQl1mRkTOacMZfCk10K0E_j71nAjwtB@mail.gmail.com>

On Thu, Jul 8, 2010 at 12:52 AM, Paul Bailey <pdbailey at umd.edu> wrote:
>
> I'm working with a large object that I want to modify slightly in a function.
> Pass-by-reference would make a lot of sense, but I don't know how to do it.
>
> I've searched this archive and thought that I can do something like
>
> f <- function(x) {
> ?v1 <- list(a=x,b=3)
> ?g(x)
> ?v1
> }
> g <- function(x) {
> ?frame <- parent.frame()
> ?assign("v1",list(a=x,b=x),frame)
> }
> f(4)
> returns list(a=4,b=4)
>
> but what if I wanted to make v1[[1]] = v1[[1]] + v1[[2]] without creating a
> copy of v1?
>
> f2 <- function(x) {
> ?v1 <- list(a=x,b=3)
> ?g2(x)
> ?v1
> }
> g2 <- function(x) {
> ?frame <- parent.frame()
> ?v1 <- get("v1",envir=frame)
> ?v1[[1]] <- v1[[1]] + v1[[2]]
> }
> f2(4)

Try:

g2 <- function(x, env = parent.frame()) {
   with(env, v1[[1]] <- v1[[1]] + v1[[2]])
}

or

g2 <- function(x, env = parent.frame()) {
   env$v1[[1]] <- env$v1[[1]] + env$v1[[2]]
}

Sometimes the reason people want pass by reference is not so much for
efficiency is but that they are trying to recreate an object oriented
structure without realizing it.  In that case the packages referred to
by Henrik would be useful.



>
> but this fails. (it returns list(a=4,b=3) because v1 was copied into g2, not
> passed by reference) Is there a way to do this?
> --
> View this message in context: http://r.789695.n4.nabble.com/pass-by-reference-tp2281802p2281802.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From dutangc at gmail.com  Thu Jul  8 15:11:11 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Thu, 8 Jul 2010 15:11:11 +0200
Subject: [Rd] constrained optimization
In-Reply-To: <1278524983159-2281282.post@n4.nabble.com>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com>
	<1278524983159-2281282.post@n4.nabble.com>
Message-ID: <D4816A76-94EF-480D-8368-645DE21AAA50@gmail.com>

Dear Paul,

No I haven't tried to use L-BFGS-B algorithm with bounds. Let me check if a variable change can be used on my problem.

Thanks

Christophe

Le 7 juil. 2010 ? 19:49, Paul Bailey a ?crit :

> 
> Have you considered using the optim function with L-BFGS-B for bounded
> optimization. Obviously, you will have to do changes of variables so that
> everything is in terms of a rectangle (which is the type of bounding that it
> accepts).
> 
> I believe it is based on "A LIMITED MEMORY ALGORITHM FOR BOUND CONSTRAINED
> OPTIMIZATION" By Richard H Byrd,  Peihuang Lu, Jorge Nocedal, and Ciyou Zhu.
> Technical Report NAM-08, May 1994.
> 
> They also have a paper on the exact implementation. I also believe that R
> uses the code from Nocedal et al.
> -- 
> View this message in context: http://r.789695.n4.nabble.com/constrained-optimization-tp2280809p2281282.html
> Sent from the R devel mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

--
Christophe Dutang
Ph.D. student at ISFA, Lyon, France
website: http://dutangc.free.fr


From jelmerypma at gmail.com  Wed Jul  7 21:17:11 2010
From: jelmerypma at gmail.com (Jelmer Ypma)
Date: Wed, 7 Jul 2010 20:17:11 +0100
Subject: [Rd] constrained optimization
In-Reply-To: <AANLkTikD-DVVWF2jvfuMbmTJ_fiswpZpKnSAQdQsuY40@mail.gmail.com>
References: <AANLkTimfVKwfyHBlZHcLxVnerBUyxsMOiz2haPO18Byx@mail.gmail.com> 
	<AANLkTiklWVWnIjDej3D-qi6C1SFHMn3OTs3ZNwSN6xW4@mail.gmail.com> 
	<AANLkTikD-DVVWF2jvfuMbmTJ_fiswpZpKnSAQdQsuY40@mail.gmail.com>
Message-ID: <AANLkTiln5M3B669EgFnnI9JgjCEmSjJGcNjERxehJ5GF@mail.gmail.com>

As far as I know, the reference describing the algorithm is:
A. W?chter and L. T. Biegler.
On the implementation of a primal-dual interior point filter line
search algorithm for large-scale nonlinear programming.
Mathematical Programming, 106(1):25-57, 2006.

There are more references here:
http://www.coin-or.org/Ipopt/documentation/node205.html

I wouldn't mind putting the interface on CRAN, except that I don't
know how that would work, since compilation of Ipopt is not
straightforward (due to dependencies). There are some pre-compiled
libraries of Ipopt available, but I haven't tried these. On Windows
and Linux I successfully installed Ipopt and the R interface from
source. Ideas on how to make the installation process easier for users
are very welcome!

Jelmer

On Wed, Jul 7, 2010 at 17:23, Christophe Dutang <dutangc at gmail.com> wrote:
> Thank you Jelmer,
>
> I have just spent five minutes on the website, but I'm not sure to
> understand which method is implemented. Is it this method?
> On the Implementation of a Primal-Dual Interior Point Filter Line Search
> Algorithm for Large-Scale Nonlinear Programming
>
> Do you plan to put lpopt on CRAN? I'm willing to test it!
>
> Christophe
>
> 2010/7/7 Jelmer Ypma <jelmerypma at gmail.com>
>>
>> Hi Christophe,
>>
>> I wrote an R interface to Ipopt ( https://projects.coin-or.org/Ipopt
>> ), which does non-linear constrained optimization for very large
>> problems. Would this be of interest to you? It took some time to find
>> out which license I could use to distribute it, but I'm planning to
>> make it publicly available this weekend.
>>
>> Jelmer
>>
>> On Wed, Jul 7, 2010 at 13:01, Christophe Dutang <dutangc at gmail.com> wrote:
>> > Dear list,
>> >
>> > The task view on optimization does not reference a package for non
>> > linear
>> > constrained optimization problems. Stefan Theussl told me to look at the
>> > Rsolnp package, but unfortunately it is not very clear what method is R
>> > ported. (The authors ported the matlab code of Yinyu Ye
>> > http://www.stanford.edu/~yyye/ <http://www.stanford.edu/%7Eyyye/>)
>> >
>> > Currently I'm looking for an implementation of sequential quadratic
>> > programming to replicate SNOPT*. A good reference I found on the web is
>> > this
>> > booklet
>> >
>> > http://www2.imm.dtu.dk/pubdb/views/edoc_download.php/5456/pdf/imm5456.pdf .
>> >
>> > Does anyone know an implementation of such algorithms? Is there any
>> > fortran
>> > implementation available useful if I have to implement it?
>> >
>> > Thanks in advance
>> >
>> > Christophe
>> >
>> >
>> > * SNOPT: An SQP Algorithm For Large-Scale Constrained Optimization
>> > (1997) by
>> > Philip E. Gill , ?Walter Murray , ?Michael , ?Michael A. Saunders
>> > --
>> > Christophe DUTANG
>> > Ph. D. student at ISFA, Lyon, France
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>
>
>
> --
> Christophe DUTANG
> Ph. D. student at ISFA, Lyon, France
>


From ggrothendieck at gmail.com  Fri Jul  9 05:05:23 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 8 Jul 2010 23:05:23 -0400
Subject: [Rd] Strange R object
Message-ID: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>

I have *** attached *** an RData file containing an R object that
is acting strangely.

Try this in a fresh workspace. Do not load zoo or any other package.
We load the object, zz2, from the attached RData file.  It is just
the number 1 with the class c("zooreg", "zoo").

Now create an S3 print routine that simply prints an X when given
an object of class "zoo".

If we use print on the object it produces an X but not if we just
enter it at the console.  Also the object is not identical to its
dput output.

How can such an object exist?  What is it about the object that is
different from structure(1, class = c("zoo", "zooreg")) ?

> # load problem object, zz2
> load("problem.RData")
>
> # examine it. Its very simple.
> dput(zz2)
structure(1, class = c("zooreg", "zoo"))
>
> # define a print routine to intercept it
> print.zoo <- function(x, ...) print("X")
>
> # the print routine works as expected
> print(zz2)
[1] "X"
>
> # but not if we use implicit printing!
> zz2
[1] 1
attr(,"class")
>
>
> # I would have expected that the last statement produce an "X" too!
> ###################################################################
>
> # these have the same dput output but are not identical!
> # I would have expected them to be the identical.
> ###################################################################
> aa2 <- structure(1, class = c("zooreg", "zoo"))
> dput(aa2)
structure(1, class = c("zooreg", "zoo"))
> dput(zz2)
structure(1, class = c("zooreg", "zoo"))
> identical(aa2, zz2)
[1] FALSE


> sessionInfo()
R version 2.11.1 Patched (2010-05-31 r52167)
i386-pc-mingw32

locale:
[1] LC_COLLATE=English_Canada.1252  LC_CTYPE=English_Canada.1252
[3] LC_MONETARY=English_Canada.1252 LC_NUMERIC=C
[5] LC_TIME=English_Canada.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

P.S. I also get the same thing under:

> R.version.string
[1] "R version 2.12.0 Under development (unstable) (2010-05-31 r52164)"

From ggrothendieck at gmail.com  Fri Jul  9 05:08:37 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 8 Jul 2010 23:08:37 -0400
Subject: [Rd] Strange R object
In-Reply-To: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
References: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
Message-ID: <AANLkTinOrfavWMbq986wXpsgC-ESN5nzdtheUth46JvA@mail.gmail.com>

The attachment did not work so I am trying it again. This time I am
naming the file problem.RData.txt (its an ascii save file).
-------------- next part --------------
RDA2
A
2
133889
131840
1026
1
9
3
zz2
526
1
1
1026
1
9
5
class
16
2
9
6
zooreg
9
3
zoo
254
254

From bwaynelewis at gmail.com  Fri Jul  9 06:49:29 2010
From: bwaynelewis at gmail.com (Bryan W. Lewis)
Date: Fri, 9 Jul 2010 00:49:29 -0400
Subject: [Rd] Suggestion for serialization performance improvement on Windows
Message-ID: <AANLkTimwIiK0sBwpnhQv9cPS2LJzwsVlTD9splgANzxP@mail.gmail.com>

Dear R developers,

  The slow performance of serializing to a raw vector on Windows is an
issue that has appeared in this list before. It appears to be due to
the frequent use of realloc from the resize_buffer method in
serialize.c.

I suggest a more granular, but still incremental, re-allocation of
memory. For example change near the top of resize_buffer to:

R_size_t newsize = needed + 65536 - (needed % 65536);

or some other similar small multiple of a typical system page size.

I have found this to dramatically improve performance of serialization
to raw vectors on Windows.

Best,

Bryan


From pdalgd at gmail.com  Fri Jul  9 11:09:58 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Fri, 09 Jul 2010 11:09:58 +0200
Subject: [Rd] Strange R object
In-Reply-To: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
References: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
Message-ID: <4C36E766.70106@gmail.com>

Gabor Grothendieck wrote:
> I have *** attached *** an RData file containing an R object that
> is acting strangely.
> 
> Try this in a fresh workspace. Do not load zoo or any other package.
> We load the object, zz2, from the attached RData file.  It is just
> the number 1 with the class c("zooreg", "zoo").
> 
> Now create an S3 print routine that simply prints an X when given
> an object of class "zoo".
> 
> If we use print on the object it produces an X but not if we just
> enter it at the console.  Also the object is not identical to its
> dput output.
> 
> How can such an object exist?  What is it about the object that is
> different from structure(1, class = c("zoo", "zooreg")) ?
> 

There's a bit in the SEXP structure that is supposed to be turned on
when an object has an S3 class. This is where implicit print looks,
whereas explicit print looks, er, elsewhere. Notice that

> is.object(zz2)
[1] FALSE
> class(zz2) <- class(zz2)
> zz2
X
> is.object(zz2)
[1] TRUE

Whenever the same information is stored in two ways, there is a risk of
inconsistency, so it is not too strange that you can have an ill-formed
.Rdata file (if you save zz2 back out, after the above fixup, line 11
changes from 526 to 782, corresponding to the bit being turned on).

I don't think it is the job of load() to verify object structures, since
there is no end to that task. Rather, we shouldn't create them in the
first place, but you give us no clues as to how that object got made.

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ggrothendieck at gmail.com  Fri Jul  9 12:49:53 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 9 Jul 2010 06:49:53 -0400
Subject: [Rd] Strange R object
In-Reply-To: <4C36E766.70106@gmail.com>
References: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com> 
	<4C36E766.70106@gmail.com>
Message-ID: <AANLkTimztwfyk_n0me2Jh2su8yJru6H_w8kGhgsX-XiX@mail.gmail.com>

On Fri, Jul 9, 2010 at 5:09 AM, Peter Dalgaard <pdalgd at gmail.com> wrote:
> Gabor Grothendieck wrote:
>> I have *** attached *** an RData file containing an R object that
>> is acting strangely.
>>
>> Try this in a fresh workspace. Do not load zoo or any other package.
>> We load the object, zz2, from the attached RData file. ?It is just
>> the number 1 with the class c("zooreg", "zoo").
>>
>> Now create an S3 print routine that simply prints an X when given
>> an object of class "zoo".
>>
>> If we use print on the object it produces an X but not if we just
>> enter it at the console. ?Also the object is not identical to its
>> dput output.
>>
>> How can such an object exist? ?What is it about the object that is
>> different from structure(1, class = c("zoo", "zooreg")) ?
>>
>
> There's a bit in the SEXP structure that is supposed to be turned on
> when an object has an S3 class. This is where implicit print looks,
> whereas explicit print looks, er, elsewhere. Notice that
>
>> is.object(zz2)
> [1] FALSE
>> class(zz2) <- class(zz2)
>> zz2
> X
>> is.object(zz2)
> [1] TRUE
>
> Whenever the same information is stored in two ways, there is a risk of
> inconsistency, so it is not too strange that you can have an ill-formed
> .Rdata file (if you save zz2 back out, after the above fixup, line 11
> changes from 526 to 782, corresponding to the bit being turned on).
>
> I don't think it is the job of load() to verify object structures, since
> there is no end to that task. Rather, we shouldn't create them in the
> first place, but you give us no clues as to how that object got made.
>

This was originally a large object in a program that uses a variety of
packages and it took quite a long time just to narrow it down to the
point where I had an object sufficiently small to post.  Its not even
clear at what point the object goes bad but your class(x) <- class(x)
trick helped a lot and I have now been able to recreate it in a simple
manner.

Below we create a new S3 class "X" with an Ops.X and print.X method.
We then create an object x of that class which is just 1 with a class
of "X".  When we multiply 1*x we get the bad object.  1*x and x have
the same dput output but compare as FALSE.  1*x is not printed by
print.X even though it is of class "X" while x is printed by print.X .
 If we assign 1*x to xx and use your class assignment trick (class(xx)
<- class(xx)) then xx prints as expected even though it did not prior
to the class assignment.

> Ops.X <- function(e1, e2) { print("Ops.X"); NextMethod(.Generic) }
> print.X <- function(x, ...) print("print.X")
> x <- structure(1, class = "X")
> dput(x)
structure(1, class = "X")
> dput(1*x)
[1] "Ops.X"
structure(1, class = "X")
> identical(x, 1*x)
[1] "Ops.X"
[1] FALSE
> 1*x
[1] "Ops.X"
[1] 1
attr(,"class")
[1] "X"
> x
[1] "print.X"
> xx <- 1*x
[1] "Ops.X"
> class(xx) <- class(xx)
> xx
[1] "print.X"


From renaud at mancala.cbio.uct.ac.za  Fri Jul  9 14:18:32 2010
From: renaud at mancala.cbio.uct.ac.za (Renaud Gaujoux)
Date: Fri, 09 Jul 2010 14:18:32 +0200
Subject: [Rd] Defining a method that behaves like '$'?
Message-ID: <4C371398.80603@cbio.uct.ac.za>

Hi,

is there a way to define a method say '$$' that would behave like '$' 
and allow calls like 'a$$name'?
Thanks.

Renaud

-- 
Renaud Gaujoux
Computational Biology - University of Cape Town
South Africa


 

###
UNIVERSITY OF CAPE TOWN 

This e-mail is subject to the UCT ICT policies and e-mail disclaimer published on our website at http://www.uct.ac.za/about/policies/emaildisclaimer/ or obtainable from +27 21 650 4500. This e-mail is intended only for the person(s) to whom it is addressed. If the e-mail has reached you in error, please notify the author. If you are not the intended recipient of the e-mail you may not use, disclose, copy, redirect or print the content. If this e-mail is not related to the business of UCT it is sent by the sender in the sender's individual capacity.

###


From pdalgd at gmail.com  Fri Jul  9 14:25:32 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Fri, 09 Jul 2010 14:25:32 +0200
Subject: [Rd] Strange R object
In-Reply-To: <AANLkTimztwfyk_n0me2Jh2su8yJru6H_w8kGhgsX-XiX@mail.gmail.com>
References: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
	<4C36E766.70106@gmail.com>
	<AANLkTimztwfyk_n0me2Jh2su8yJru6H_w8kGhgsX-XiX@mail.gmail.com>
Message-ID: <4C37153C.7020909@gmail.com>

Gabor Grothendieck wrote:
> On Fri, Jul 9, 2010 at 5:09 AM, Peter Dalgaard <pdalgd at gmail.com> wrote:
>> Gabor Grothendieck wrote:
>>> I have *** attached *** an RData file containing an R object that
>>> is acting strangely.
>>>
>>> Try this in a fresh workspace. Do not load zoo or any other package.
>>> We load the object, zz2, from the attached RData file.  It is just
>>> the number 1 with the class c("zooreg", "zoo").
>>>
>>> Now create an S3 print routine that simply prints an X when given
>>> an object of class "zoo".
>>>
>>> If we use print on the object it produces an X but not if we just
>>> enter it at the console.  Also the object is not identical to its
>>> dput output.
>>>
>>> How can such an object exist?  What is it about the object that is
>>> different from structure(1, class = c("zoo", "zooreg")) ?
>>>
>> There's a bit in the SEXP structure that is supposed to be turned on
>> when an object has an S3 class. This is where implicit print looks,
>> whereas explicit print looks, er, elsewhere. Notice that
>>
>>> is.object(zz2)
>> [1] FALSE
>>> class(zz2) <- class(zz2)
>>> zz2
>> X
>>> is.object(zz2)
>> [1] TRUE
>>
>> Whenever the same information is stored in two ways, there is a risk of
>> inconsistency, so it is not too strange that you can have an ill-formed
>> .Rdata file (if you save zz2 back out, after the above fixup, line 11
>> changes from 526 to 782, corresponding to the bit being turned on).
>>
>> I don't think it is the job of load() to verify object structures, since
>> there is no end to that task. Rather, we shouldn't create them in the
>> first place, but you give us no clues as to how that object got made.
>>
> 
> This was originally a large object in a program that uses a variety of
> packages and it took quite a long time just to narrow it down to the
> point where I had an object sufficiently small to post.  Its not even
> clear at what point the object goes bad but your class(x) <- class(x)
> trick helped a lot and I have now been able to recreate it in a simple
> manner.
> 
> Below we create a new S3 class "X" with an Ops.X and print.X method.
> We then create an object x of that class which is just 1 with a class
> of "X".  When we multiply 1*x we get the bad object.  1*x and x have
> the same dput output but compare as FALSE.  1*x is not printed by
> print.X even though it is of class "X" while x is printed by print.X .
>  If we assign 1*x to xx and use your class assignment trick (class(xx)
> <- class(xx)) then xx prints as expected even though it did not prior
> to the class assignment.
> 
>> Ops.X <- function(e1, e2) { print("Ops.X"); NextMethod(.Generic) }
>> print.X <- function(x, ...) print("print.X")
>> x <- structure(1, class = "X")
>> dput(x)
> structure(1, class = "X")
>> dput(1*x)
> [1] "Ops.X"
> structure(1, class = "X")
>> identical(x, 1*x)
> [1] "Ops.X"
> [1] FALSE
>> 1*x
> [1] "Ops.X"
> [1] 1
> attr(,"class")
> [1] "X"
>> x
> [1] "print.X"
>> xx <- 1*x
> [1] "Ops.X"
>> class(xx) <- class(xx)
>> xx
> [1] "print.X"

Or, to minimize it further:

> x <- structure(1, class="y")
> is.object(x)
[1] TRUE
> is.object(x*1)
[1] TRUE
> is.object(1*x)
[1] FALSE
> class(x*1)
[1] "y"
> class(1*x)
[1] "y"

Yup, that looks like a bug.

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From romain.francois at dbmail.com  Fri Jul  9 14:27:53 2010
From: romain.francois at dbmail.com (Romain Francois)
Date: Fri, 09 Jul 2010 14:27:53 +0200
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <4C371398.80603@cbio.uct.ac.za>
References: <4C371398.80603@cbio.uct.ac.za>
Message-ID: <4C3715C9.9070505@dbmail.com>


Le 09/07/10 14:18, Renaud Gaujoux a ?crit :
>
> Hi,
>
> is there a way to define a method say '$$' that would behave like '$'
> and allow calls like 'a$$name'?
> Thanks.
>
> Renaud

No. This is not grammatically valid syntax:

 > parse( text = 'a$$name' )
Erreur dans parse(text = "a$$name") : '$' inattendu(e) dans "a$$"


But you can define custom methods for $.

setClass( "Foo", representation( n = "integer" ) )
setMethod( "$", "Foo", function(x, name ){
	function( ) rnorm( x at n )
} )
foo <- new( "Foo", n = 10L )
foo$bla( )


Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/aJHNLV : Rmetrics slides
|- http://bit.ly/98Uf7u : Rcpp 0.8.1
`- http://bit.ly/c6YnCi : graph gallery collage


From murdoch.duncan at gmail.com  Fri Jul  9 14:29:57 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 09 Jul 2010 08:29:57 -0400
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <4C371398.80603@cbio.uct.ac.za>
References: <4C371398.80603@cbio.uct.ac.za>
Message-ID: <4C371645.6030204@gmail.com>

On 09/07/2010 8:18 AM, Renaud Gaujoux wrote:
> Hi,
>
> is there a way to define a method say '$$' that would behave like '$' 
> and allow calls like 'a$$name'?
No, the parser handles a fixed syntax, and that expression is not 
legal.  You could do it with

a %$$% name

using the infix operator syntax.  (I think the description in the R 
Language Definition suggests this is not legal, since $$ is not a valid 
name, but it does currently work and that's unlikely to change.)

Duncan Murdoch


From renaud at mancala.cbio.uct.ac.za  Fri Jul  9 14:49:39 2010
From: renaud at mancala.cbio.uct.ac.za (Renaud Gaujoux)
Date: Fri, 09 Jul 2010 14:49:39 +0200
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <4C371645.6030204@gmail.com>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
Message-ID: <4C371AE3.9060801@cbio.uct.ac.za>

Alright.
Maybe the symbol I chose was not appropriate. I tried ':' to be able to 
do 'a:name' with 'a' a S4 object.
I get the following error:
Error in genericForPrimitive(f) :
   methods may not be defined for primitive function ":" in this version 
of R

Does there exist any symbol that would be suitable for the job?
Thanks

-- 
Renaud Gaujoux
Computational Biology - University of Cape Town
South Africa


On 09/07/2010 14:29, Duncan Murdoch wrote:
> On 09/07/2010 8:18 AM, Renaud Gaujoux wrote:
>> Hi,
>>
>> is there a way to define a method say '$$' that would behave like '$' 
>> and allow calls like 'a$$name'?
> No, the parser handles a fixed syntax, and that expression is not 
> legal.  You could do it with
>
> a %$$% name
>
> using the infix operator syntax.  (I think the description in the R 
> Language Definition suggests this is not legal, since $$ is not a 
> valid name, but it does currently work and that's unlikely to change.)
>
> Duncan Murdoch

 

###
UNIVERSITY OF CAPE TOWN 

This e-mail is subject to the UCT ICT policies and e-mail disclaimer published on our website at http://www.uct.ac.za/about/policies/emaildisclaimer/ or obtainable from +27 21 650 4500. This e-mail is intended only for the person(s) to whom it is addressed. If the e-mail has reached you in error, please notify the author. If you are not the intended recipient of the e-mail you may not use, disclose, copy, redirect or print the content. If this e-mail is not related to the business of UCT it is sent by the sender in the sender's individual capacity.

###


From marc_schwartz at me.com  Fri Jul  9 14:58:51 2010
From: marc_schwartz at me.com (Marc Schwartz)
Date: Fri, 09 Jul 2010 07:58:51 -0500
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <4C371AE3.9060801@cbio.uct.ac.za>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
	<4C371AE3.9060801@cbio.uct.ac.za>
Message-ID: <8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>

You were, in effect, trying to overload the ":" operator, which is of course for defining sequences.

If you are using S4 methods, what is wrong with using the default "@" as the extraction syntax (eg. a at name) to get at slots?

See ?"@" and ?slot

HTH,

Marc Schwartz

On Jul 9, 2010, at 7:49 AM, Renaud Gaujoux wrote:

> Alright.
> Maybe the symbol I chose was not appropriate. I tried ':' to be able to do 'a:name' with 'a' a S4 object.
> I get the following error:
> Error in genericForPrimitive(f) :
>  methods may not be defined for primitive function ":" in this version of R
> 
> Does there exist any symbol that would be suitable for the job?
> Thanks
> 
> -- 
> Renaud Gaujoux
> Computational Biology - University of Cape Town
> South Africa
> 
> 
> On 09/07/2010 14:29, Duncan Murdoch wrote:
>> On 09/07/2010 8:18 AM, Renaud Gaujoux wrote:
>>> Hi,
>>> 
>>> is there a way to define a method say '$$' that would behave like '$' and allow calls like 'a$$name'?
>> No, the parser handles a fixed syntax, and that expression is not legal.  You could do it with
>> 
>> a %$$% name
>> 
>> using the infix operator syntax.  (I think the description in the R Language Definition suggests this is not legal, since $$ is not a valid name, but it does currently work and that's unlikely to change.)
>> 
>> Duncan Murdoch


From renaud at mancala.cbio.uct.ac.za  Fri Jul  9 15:10:08 2010
From: renaud at mancala.cbio.uct.ac.za (Renaud Gaujoux)
Date: Fri, 09 Jul 2010 15:10:08 +0200
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
	<4C371AE3.9060801@cbio.uct.ac.za>
	<8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>
Message-ID: <4C371FB0.9040700@cbio.uct.ac.za>

I do not want to access the slot itself but its content: a:toto would be 
a at slot1[['toto']].
The thing is that I would like to have two different methods: '$' (that 
I already have) and another one to define, ideally that behaves like '$'.
So in brief:
- a:toto would be for a at slot1[['toto']]
- a$tata would be for a at slot2[['tata']]

But apparently it might not be possible.

-- 
Renaud Gaujoux
Computational Biology - University of Cape Town
South Africa


On 09/07/2010 14:58, Marc Schwartz wrote:
> You were, in effect, trying to overload the ":" operator, which is of course for defining sequences.
>
> If you are using S4 methods, what is wrong with using the default "@" as the extraction syntax (eg. a at name) to get at slots?
>
> See ?"@" and ?slot
>
> HTH,
>
> Marc Schwartz
>
> On Jul 9, 2010, at 7:49 AM, Renaud Gaujoux wrote:
>
>    
>> Alright.
>> Maybe the symbol I chose was not appropriate. I tried ':' to be able to do 'a:name' with 'a' a S4 object.
>> I get the following error:
>> Error in genericForPrimitive(f) :
>>   methods may not be defined for primitive function ":" in this version of R
>>
>> Does there exist any symbol that would be suitable for the job?
>> Thanks
>>
>> -- 
>> Renaud Gaujoux
>> Computational Biology - University of Cape Town
>> South Africa
>>
>>
>> On 09/07/2010 14:29, Duncan Murdoch wrote:
>>      
>>> On 09/07/2010 8:18 AM, Renaud Gaujoux wrote:
>>>        
>>>> Hi,
>>>>
>>>> is there a way to define a method say '$$' that would behave like '$' and allow calls like 'a$$name'?
>>>>          
>>> No, the parser handles a fixed syntax, and that expression is not legal.  You could do it with
>>>
>>> a %$$% name
>>>
>>> using the infix operator syntax.  (I think the description in the R Language Definition suggests this is not legal, since $$ is not a valid name, but it does currently work and that's unlikely to change.)
>>>
>>> Duncan Murdoch
>>>        
>    

 

###
UNIVERSITY OF CAPE TOWN 

This e-mail is subject to the UCT ICT policies and e-mail disclaimer published on our website at http://www.uct.ac.za/about/policies/emaildisclaimer/ or obtainable from +27 21 650 4500. This e-mail is intended only for the person(s) to whom it is addressed. If the e-mail has reached you in error, please notify the author. If you are not the intended recipient of the e-mail you may not use, disclose, copy, redirect or print the content. If this e-mail is not related to the business of UCT it is sent by the sender in the sender's individual capacity.

###


From marc_schwartz at me.com  Fri Jul  9 15:52:56 2010
From: marc_schwartz at me.com (Marc Schwartz)
Date: Fri, 09 Jul 2010 08:52:56 -0500
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <4C371FB0.9040700@cbio.uct.ac.za>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
	<4C371AE3.9060801@cbio.uct.ac.za>
	<8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>
	<4C371FB0.9040700@cbio.uct.ac.za>
Message-ID: <C9D4442C-E56E-43D6-B165-A6228F40B98B@me.com>

I am certainly not an expert in S4 and know enough to be dangerous.

That being said, I used setMethod() as Romain had done. I would defer to others with greater experience as to the pros and cons, including the risk of confusion, but here is one approach, extending the example in ?slot:

setClass("track", representation(x = "numeric", y = "numeric", z = "list"))

myTrack <- new("track", x = -4:4, y = exp(-4:4), z = list(A = 1:5, B = 7:12))

setMethod( "$", "track", function(x, name){
	slot(x, "z")[[name]]
})


> myTrack
An object of class "track"
Slot "x":
[1] -4 -3 -2 -1  0  1  2  3  4

Slot "y":
[1]  0.01831564  0.04978707  0.13533528  0.36787944  1.00000000
[6]  2.71828183  7.38905610 20.08553692 54.59815003

Slot "z":
$A
[1] 1 2 3 4 5

$B
[1]  7  8  9 10 11 12



> myTrack at z
$A
[1] 1 2 3 4 5

$B
[1]  7  8  9 10 11 12



# Default
> myTrack at z$A
[1] 1 2 3 4 5

> myTrack at z$B
[1]  7  8  9 10 11 12



# Use the new '$' method
> myTrack$A
[1] 1 2 3 4 5

> myTrack$B
[1]  7  8  9 10 11 12


Not sure if that gets you something along the lines of what you wanted, but perhaps it is helpful.

Marc



On Jul 9, 2010, at 8:10 AM, Renaud Gaujoux wrote:

> I do not want to access the slot itself but its content: a:toto would be a at slot1[['toto']].
> The thing is that I would like to have two different methods: '$' (that I already have) and another one to define, ideally that behaves like '$'.
> So in brief:
> - a:toto would be for a at slot1[['toto']]
> - a$tata would be for a at slot2[['tata']]
> 
> But apparently it might not be possible.
> 
> -- 
> Renaud Gaujoux
> Computational Biology - University of Cape Town
> South Africa
> 
> 
> On 09/07/2010 14:58, Marc Schwartz wrote:
>> You were, in effect, trying to overload the ":" operator, which is of course for defining sequences.
>> 
>> If you are using S4 methods, what is wrong with using the default "@" as the extraction syntax (eg. a at name) to get at slots?
>> 
>> See ?"@" and ?slot
>> 
>> HTH,
>> 
>> Marc Schwartz
>> 
>> On Jul 9, 2010, at 7:49 AM, Renaud Gaujoux wrote:
>> 
>>   
>>> Alright.
>>> Maybe the symbol I chose was not appropriate. I tried ':' to be able to do 'a:name' with 'a' a S4 object.
>>> I get the following error:
>>> Error in genericForPrimitive(f) :
>>>  methods may not be defined for primitive function ":" in this version of R
>>> 
>>> Does there exist any symbol that would be suitable for the job?
>>> Thanks
>>> 
>>> -- 
>>> Renaud Gaujoux
>>> Computational Biology - University of Cape Town
>>> South Africa
>>> 
>>> 
>>> On 09/07/2010 14:29, Duncan Murdoch wrote:
>>>     
>>>> On 09/07/2010 8:18 AM, Renaud Gaujoux wrote:
>>>>       
>>>>> Hi,
>>>>> 
>>>>> is there a way to define a method say '$$' that would behave like '$' and allow calls like 'a$$name'?
>>>>>         
>>>> No, the parser handles a fixed syntax, and that expression is not legal.  You could do it with
>>>> 
>>>> a %$$% name
>>>> 
>>>> using the infix operator syntax.  (I think the description in the R Language Definition suggests this is not legal, since $$ is not a valid name, but it does currently work and that's unlikely to change.)
>>>> 
>>>> Duncan Murdoch
>>>>       
>>


From therneau at mayo.edu  Fri Jul  9 16:55:40 2010
From: therneau at mayo.edu (Therneau, Terry M., Ph.D.)
Date: Fri, 9 Jul 2010 09:55:40 -0500
Subject: [Rd] Mysterious behavior
In-Reply-To: <mailman.23.1278669608.14475.r-devel@r-project.org>
References: <mailman.23.1278669608.14475.r-devel@r-project.org>
Message-ID: <5DBE21404FF5E54C826BE1040C2CD031C919E1@msgebe52.mfad.mfroot.org>

I had trouble with some tests for the survival suite last night that I
cannot explain. 

Framework: Ubuntu Linux, R2.11.  
   For testing survival I have a separate directory and Makefile.  I
pull everything into the local .RData, no packages, library, or
namespace.  (It's easier to add test modifications to a routine in a
chain of calls).  
   
   A test of survreg + psline would fail because splines is not
automatically loaded in this scenario.  In my console window type
	> library(splines)
      > fit <- survreg(Surv(time, status) ~ ph.ecog + spline(age),
data=lung)
as the first 2 lines a a new session (the lung data is also saved)
and up would pop an error message about having <2.10 version of
survival.  And it is true that I had such a thing in my ~/RLib.  But
there is no mention of either the local or the system survival library
when I type search(), and .Autoloaded is NULL. 

  I'm mystified as to how R decided to use that library, and what it was
trying to pull from it.  I removed it from ~/Rlib and the message went
away, but now I'm not so sure that this was a good idea.  Is something
now being automatically snatched out of the standard survival library?
If so that compromises the integrity of my testbed.  How do I find out?

Terry Therneau


From murdoch.duncan at gmail.com  Fri Jul  9 17:22:48 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 09 Jul 2010 11:22:48 -0400
Subject: [Rd] Mysterious behavior
In-Reply-To: <5DBE21404FF5E54C826BE1040C2CD031C919E1@msgebe52.mfad.mfroot.org>
References: <mailman.23.1278669608.14475.r-devel@r-project.org>
	<5DBE21404FF5E54C826BE1040C2CD031C919E1@msgebe52.mfad.mfroot.org>
Message-ID: <4C373EC8.9070206@gmail.com>

On 09/07/2010 10:55 AM, Therneau, Terry M., Ph.D. wrote:
> I had trouble with some tests for the survival suite last night that I
> cannot explain. 
>
> Framework: Ubuntu Linux, R2.11.  
>    For testing survival I have a separate directory and Makefile.  I
> pull everything into the local .RData, no packages, library, or
> namespace.  (It's easier to add test modifications to a routine in a
> chain of calls).  
>    
>    A test of survreg + psline would fail because splines is not
> automatically loaded in this scenario.  In my console window type
> 	> library(splines)
>       > fit <- survreg(Surv(time, status) ~ ph.ecog + spline(age),
> data=lung)
> as the first 2 lines a a new session (the lung data is also saved)
> and up would pop an error message about having <2.10 version of
> survival.  And it is true that I had such a thing in my ~/RLib.  But
> there is no mention of either the local or the system survival library
> when I type search(), and .Autoloaded is NULL. 
>   
Could you show us the result of .libPaths(), search(), searchpaths() and 
sessionInfo()? 

Duncan Murdoch

>   I'm mystified as to how R decided to use that library, and what it was
> trying to pull from it.  I removed it from ~/Rlib and the message went
> away, but now I'm not so sure that this was a good idea.  Is something
> now being automatically snatched out of the standard survival library?
> If so that compromises the integrity of my testbed.  How do I find out?
>
> Terry Therneau
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From deepayan.sarkar at gmail.com  Fri Jul  9 18:41:53 2010
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Fri, 9 Jul 2010 09:41:53 -0700
Subject: [Rd] Strange R object
In-Reply-To: <4C37153C.7020909@gmail.com>
References: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
	<4C36E766.70106@gmail.com>
	<AANLkTimztwfyk_n0me2Jh2su8yJru6H_w8kGhgsX-XiX@mail.gmail.com>
	<4C37153C.7020909@gmail.com>
Message-ID: <AANLkTinurU89JH0yIjZfYxVo2IN2p8EMoeJ2aXRIJCT3@mail.gmail.com>

On Fri, Jul 9, 2010 at 5:25 AM, Peter Dalgaard <pdalgd at gmail.com> wrote:
> Gabor Grothendieck wrote:
>> On Fri, Jul 9, 2010 at 5:09 AM, Peter Dalgaard <pdalgd at gmail.com> wrote:
>>> Gabor Grothendieck wrote:
>>>> I have *** attached *** an RData file containing an R object that
>>>> is acting strangely.
>>>>
>>>> Try this in a fresh workspace. Do not load zoo or any other package.
>>>> We load the object, zz2, from the attached RData file. ?It is just
>>>> the number 1 with the class c("zooreg", "zoo").
>>>>
>>>> Now create an S3 print routine that simply prints an X when given
>>>> an object of class "zoo".
>>>>
>>>> If we use print on the object it produces an X but not if we just
>>>> enter it at the console. ?Also the object is not identical to its
>>>> dput output.
>>>>
>>>> How can such an object exist? ?What is it about the object that is
>>>> different from structure(1, class = c("zoo", "zooreg")) ?
>>>>
>>> There's a bit in the SEXP structure that is supposed to be turned on
>>> when an object has an S3 class. This is where implicit print looks,
>>> whereas explicit print looks, er, elsewhere. Notice that
>>>
>>>> is.object(zz2)
>>> [1] FALSE
>>>> class(zz2) <- class(zz2)
>>>> zz2
>>> X
>>>> is.object(zz2)
>>> [1] TRUE
>>>
>>> Whenever the same information is stored in two ways, there is a risk of
>>> inconsistency, so it is not too strange that you can have an ill-formed
>>> .Rdata file (if you save zz2 back out, after the above fixup, line 11
>>> changes from 526 to 782, corresponding to the bit being turned on).
>>>
>>> I don't think it is the job of load() to verify object structures, since
>>> there is no end to that task. Rather, we shouldn't create them in the
>>> first place, but you give us no clues as to how that object got made.
>>>
>>
>> This was originally a large object in a program that uses a variety of
>> packages and it took quite a long time just to narrow it down to the
>> point where I had an object sufficiently small to post. ?Its not even
>> clear at what point the object goes bad but your class(x) <- class(x)
>> trick helped a lot and I have now been able to recreate it in a simple
>> manner.
>>
>> Below we create a new S3 class "X" with an Ops.X and print.X method.
>> We then create an object x of that class which is just 1 with a class
>> of "X". ?When we multiply 1*x we get the bad object. ?1*x and x have
>> the same dput output but compare as FALSE. ?1*x is not printed by
>> print.X even though it is of class "X" while x is printed by print.X .
>> ?If we assign 1*x to xx and use your class assignment trick (class(xx)
>> <- class(xx)) then xx prints as expected even though it did not prior
>> to the class assignment.
>>
>>> Ops.X <- function(e1, e2) { print("Ops.X"); NextMethod(.Generic) }
>>> print.X <- function(x, ...) print("print.X")
>>> x <- structure(1, class = "X")
>>> dput(x)
>> structure(1, class = "X")
>>> dput(1*x)
>> [1] "Ops.X"
>> structure(1, class = "X")
>>> identical(x, 1*x)
>> [1] "Ops.X"
>> [1] FALSE
>>> 1*x
>> [1] "Ops.X"
>> [1] 1
>> attr(,"class")
>> [1] "X"
>>> x
>> [1] "print.X"
>>> xx <- 1*x
>> [1] "Ops.X"
>>> class(xx) <- class(xx)
>>> xx
>> [1] "print.X"
>
> Or, to minimize it further:
>
>> x <- structure(1, class="y")
>> is.object(x)
> [1] TRUE
>> is.object(x*1)
> [1] TRUE
>> is.object(1*x)
> [1] FALSE
>> class(x*1)
> [1] "y"
>> class(1*x)
> [1] "y"
>
> Yup, that looks like a bug.

I recently came across the following surprising behaviour which turns
out to be the same issue. I had been meaning to ask for an
explanation.

> x <- 1:20
> class(x)
[1] "integer"
> is.object(x)
[1] FALSE
> print.integer <- function(x) print(x %% 5)
> print(x)
 [1] 1 2 3 4 0 1 2 3 4 0 1 2 3 4 0 1 2 3 4 0
> x
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20

-Deepayan


From simon.urbanek at r-project.org  Fri Jul  9 19:02:40 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 9 Jul 2010 13:02:40 -0400
Subject: [Rd] Strange R object
In-Reply-To: <AANLkTinurU89JH0yIjZfYxVo2IN2p8EMoeJ2aXRIJCT3@mail.gmail.com>
References: <AANLkTilgSg20eTTO-hgJCR_rUwXxnwy1BVG3ddI-Fl2Z@mail.gmail.com>
	<4C36E766.70106@gmail.com>
	<AANLkTimztwfyk_n0me2Jh2su8yJru6H_w8kGhgsX-XiX@mail.gmail.com>
	<4C37153C.7020909@gmail.com>
	<AANLkTinurU89JH0yIjZfYxVo2IN2p8EMoeJ2aXRIJCT3@mail.gmail.com>
Message-ID: <0A49716E-85D0-4074-9237-9086E2C5AC44@r-project.org>


On Jul 9, 2010, at 12:41 PM, Deepayan Sarkar wrote:

> On Fri, Jul 9, 2010 at 5:25 AM, Peter Dalgaard <pdalgd at gmail.com> wrote:
>> Gabor Grothendieck wrote:
>>> On Fri, Jul 9, 2010 at 5:09 AM, Peter Dalgaard <pdalgd at gmail.com> wrote:
>>>> Gabor Grothendieck wrote:
>>>>> I have *** attached *** an RData file containing an R object that
>>>>> is acting strangely.
>>>>> 
>>>>> Try this in a fresh workspace. Do not load zoo or any other package.
>>>>> We load the object, zz2, from the attached RData file.  It is just
>>>>> the number 1 with the class c("zooreg", "zoo").
>>>>> 
>>>>> Now create an S3 print routine that simply prints an X when given
>>>>> an object of class "zoo".
>>>>> 
>>>>> If we use print on the object it produces an X but not if we just
>>>>> enter it at the console.  Also the object is not identical to its
>>>>> dput output.
>>>>> 
>>>>> How can such an object exist?  What is it about the object that is
>>>>> different from structure(1, class = c("zoo", "zooreg")) ?
>>>>> 
>>>> There's a bit in the SEXP structure that is supposed to be turned on
>>>> when an object has an S3 class. This is where implicit print looks,
>>>> whereas explicit print looks, er, elsewhere. Notice that
>>>> 
>>>>> is.object(zz2)
>>>> [1] FALSE
>>>>> class(zz2) <- class(zz2)
>>>>> zz2
>>>> X
>>>>> is.object(zz2)
>>>> [1] TRUE
>>>> 
>>>> Whenever the same information is stored in two ways, there is a risk of
>>>> inconsistency, so it is not too strange that you can have an ill-formed
>>>> .Rdata file (if you save zz2 back out, after the above fixup, line 11
>>>> changes from 526 to 782, corresponding to the bit being turned on).
>>>> 
>>>> I don't think it is the job of load() to verify object structures, since
>>>> there is no end to that task. Rather, we shouldn't create them in the
>>>> first place, but you give us no clues as to how that object got made.
>>>> 
>>> 
>>> This was originally a large object in a program that uses a variety of
>>> packages and it took quite a long time just to narrow it down to the
>>> point where I had an object sufficiently small to post.  Its not even
>>> clear at what point the object goes bad but your class(x) <- class(x)
>>> trick helped a lot and I have now been able to recreate it in a simple
>>> manner.
>>> 
>>> Below we create a new S3 class "X" with an Ops.X and print.X method.
>>> We then create an object x of that class which is just 1 with a class
>>> of "X".  When we multiply 1*x we get the bad object.  1*x and x have
>>> the same dput output but compare as FALSE.  1*x is not printed by
>>> print.X even though it is of class "X" while x is printed by print.X .
>>>  If we assign 1*x to xx and use your class assignment trick (class(xx)
>>> <- class(xx)) then xx prints as expected even though it did not prior
>>> to the class assignment.
>>> 
>>>> Ops.X <- function(e1, e2) { print("Ops.X"); NextMethod(.Generic) }
>>>> print.X <- function(x, ...) print("print.X")
>>>> x <- structure(1, class = "X")
>>>> dput(x)
>>> structure(1, class = "X")
>>>> dput(1*x)
>>> [1] "Ops.X"
>>> structure(1, class = "X")
>>>> identical(x, 1*x)
>>> [1] "Ops.X"
>>> [1] FALSE
>>>> 1*x
>>> [1] "Ops.X"
>>> [1] 1
>>> attr(,"class")
>>> [1] "X"
>>>> x
>>> [1] "print.X"
>>>> xx <- 1*x
>>> [1] "Ops.X"
>>>> class(xx) <- class(xx)
>>>> xx
>>> [1] "print.X"
>> 
>> Or, to minimize it further:
>> 
>>> x <- structure(1, class="y")
>>> is.object(x)
>> [1] TRUE
>>> is.object(x*1)
>> [1] TRUE
>>> is.object(1*x)
>> [1] FALSE
>>> class(x*1)
>> [1] "y"
>>> class(1*x)
>> [1] "y"
>> 
>> Yup, that looks like a bug.
> 
> I recently came across the following surprising behaviour which turns
> out to be the same issue. I had been meaning to ask for an
> explanation.
> 
>> x <- 1:20
>> class(x)
> [1] "integer"
>> is.object(x)
> [1] FALSE
>> print.integer <- function(x) print(x %% 5)
>> print(x)
> [1] 1 2 3 4 0 1 2 3 4 0 1 2 3 4 0 1 2 3 4 0
>> x
> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> 


... that is an entirely different issue. x is still not an object because it doesn't have any explicit S3 class so it has nothing in common with the case discussed. This is about P in REPL which uses PrintValueEnv which is turn dispatches to print() only for objects (see main and print).

Cheers,
Simon


From djsamperi at gmail.com  Fri Jul  9 20:38:06 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 9 Jul 2010 14:38:06 -0400
Subject: [Rd] Telling Windows how to find DLL's from R?
Message-ID: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100709/762084ff/attachment.pl>

From murdoch.duncan at gmail.com  Fri Jul  9 21:48:38 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 09 Jul 2010 15:48:38 -0400
Subject: [Rd] Telling Windows how to find DLL's from R?
In-Reply-To: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>
References: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>
Message-ID: <4C377D16.1070702@gmail.com>

On 09/07/2010 2:38 PM, Dominick Samperi wrote:
> Is it possible to set Windows' search path from within R, or
> to tell Windows how to find a DLL in some other way from
> R? Specifically, if a package DLL depends on another DLL
> the normal requirement is that the second DLL be in the
> search path so Windows can find it (there are other tricks,
> but they apply at the Windows level, not at the R level).
>   


I haven't tried this, but can't you use Sys.setenv() to change the PATH 
to what you want?  Presumably you'll want to change it back afterwards.

Duncan Murdoch


From mtmorgan at fhcrc.org  Sat Jul 10 00:08:31 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 09 Jul 2010 15:08:31 -0700
Subject: [Rd] Telling Windows how to find DLL's from R?
In-Reply-To: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>
References: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>
Message-ID: <4C379DDF.3010303@fhcrc.org>

On 07/09/2010 11:38 AM, Dominick Samperi wrote:
> Is it possible to set Windows' search path from within R, or
> to tell Windows how to find a DLL in some other way from
> R? Specifically, if a package DLL depends on another DLL
> the normal requirement is that the second DLL be in the
> search path so Windows can find it (there are other tricks,
> but they apply at the Windows level, not at the R level).

This thread

  https://stat.ethz.ch/pipermail/r-devel/2008-January/047961.html

might be relevant, especially the DLLpath argument to dyn.load.

Martin

> 
> Thanks,
> Dominick
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From djsamperi at gmail.com  Sat Jul 10 00:10:44 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 9 Jul 2010 18:10:44 -0400
Subject: [Rd] Telling Windows how to find DLL's from R?
In-Reply-To: <4C377D16.1070702@gmail.com>
References: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>
	<4C377D16.1070702@gmail.com>
Message-ID: <AANLkTin2pz4ZR8Xi7FfatfYMA0wO5-ad0rXekYtcQsN9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100709/ad2d5999/attachment.pl>

From djsamperi at gmail.com  Sat Jul 10 00:42:40 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 9 Jul 2010 18:42:40 -0400
Subject: [Rd] Telling Windows how to find DLL's from R?
In-Reply-To: <AANLkTin2pz4ZR8Xi7FfatfYMA0wO5-ad0rXekYtcQsN9@mail.gmail.com>
References: <AANLkTinfuTBV0iS8tK5vDoAQy4c2xWzLeGFA2OE5cLLH@mail.gmail.com>
	<4C377D16.1070702@gmail.com>
	<AANLkTin2pz4ZR8Xi7FfatfYMA0wO5-ad0rXekYtcQsN9@mail.gmail.com>
Message-ID: <AANLkTilBBKyd3JGsGJJ_WAxEt0csqcR5Invn4Uu_m0Zk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100709/6bf03e3f/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Jul 10 14:24:36 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 10 Jul 2010 13:24:36 +0100
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <4C371FB0.9040700@cbio.uct.ac.za>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
	<4C371AE3.9060801@cbio.uct.ac.za>
	<8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>
	<4C371FB0.9040700@cbio.uct.ac.za>
Message-ID: <AANLkTimRISCE4AjmCThITuF9qYaUyzuvhaSottcYXxuK@mail.gmail.com>

On Fri, Jul 9, 2010 at 2:10 PM, Renaud Gaujoux
<renaud at mancala.cbio.uct.ac.za> wrote:
> I do not want to access the slot itself but its content: a:toto would be
> a at slot1[['toto']].
> The thing is that I would like to have two different methods: '$' (that I
> already have) and another one to define, ideally that behaves like '$'.
> So in brief:
> - a:toto would be for a at slot1[['toto']]
> - a$tata would be for a at slot2[['tata']]
>
> But apparently it might not be possible.
>

 Even if possible, definitely not desirable. As already mentioned, a:b
is the sequence a to b (as in 0:10), so it's going to look weird to
anyone who hasn't noticed your definition. Also, it looks fairly
meaningless. By which I mean there's no obvious reason why a colon
should do what you want it to do. There's also no obvious reason why a
dollar sign does what it does (whats it got to do with dollars?) but
we've had it for 20 years so we're stuck with it.

 Write a method for your objects and force your users to do a bit more
typing as a trade-off for legibility:

 slot1(a,"toto")

 is a lot more readable than a:toto (assuming you replace 'slot1' with
something meaningful).

 Remember, code is most likely to be written once, and read many times
- so make it easy for readers!

Barry


From marc_schwartz at me.com  Sat Jul 10 17:29:21 2010
From: marc_schwartz at me.com (Marc Schwartz)
Date: Sat, 10 Jul 2010 10:29:21 -0500
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <AANLkTimRISCE4AjmCThITuF9qYaUyzuvhaSottcYXxuK@mail.gmail.com>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
	<4C371AE3.9060801@cbio.uct.ac.za>
	<8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>
	<4C371FB0.9040700@cbio.uct.ac.za>
	<AANLkTimRISCE4AjmCThITuF9qYaUyzuvhaSottcYXxuK@mail.gmail.com>
Message-ID: <ED711666-E051-4D94-95D1-CB40B5DC5D65@me.com>

On Jul 10, 2010, at 7:24 AM, Barry Rowlingson wrote:

> On Fri, Jul 9, 2010 at 2:10 PM, Renaud Gaujoux
> <renaud at mancala.cbio.uct.ac.za> wrote:
>> I do not want to access the slot itself but its content: a:toto would be
>> a at slot1[['toto']].
>> The thing is that I would like to have two different methods: '$' (that I
>> already have) and another one to define, ideally that behaves like '$'.
>> So in brief:
>> - a:toto would be for a at slot1[['toto']]
>> - a$tata would be for a at slot2[['tata']]
>> 
>> But apparently it might not be possible.
>> 
> 
> Even if possible, definitely not desirable. As already mentioned, a:b
> is the sequence a to b (as in 0:10), so it's going to look weird to
> anyone who hasn't noticed your definition. Also, it looks fairly
> meaningless. By which I mean there's no obvious reason why a colon
> should do what you want it to do. There's also no obvious reason why a
> dollar sign does what it does (whats it got to do with dollars?) but
> we've had it for 20 years so we're stuck with it.
> 
> Write a method for your objects and force your users to do a bit more
> typing as a trade-off for legibility:
> 
> slot1(a,"toto")
> 
> is a lot more readable than a:toto (assuming you replace 'slot1' with
> something meaningful).
> 
> Remember, code is most likely to be written once, and read many times
> - so make it easy for readers!


Just to throw in another $0.02, in hindsight, not fully understanding the context of Renaud's original query, this may be a situation where implementing relevant extractor functions would make sense. 

Consider functions such as coef(), effects(), fitted() etc. for regression models. These allow you and your users to have functions that return components of your object class without being concerned about the internal structure of your object. Importantly, you and your users will not be affected by future changes to your object structure that you may find you have to implement over time. You simply modify the extractor functions as required when the internal structure of your class changes, so that they can be used post-change, without breaking existing code.

So for example:

  toto(a)

would return a at slot1[['toto']] and

  tata(a)

would return a at slot2[['tata']].

Food for thought.

Marc


From edugarpor at gmail.com  Sat Jul 10 19:31:03 2010
From: edugarpor at gmail.com (=?ISO-8859-1?Q?Eduardo_Garc=EDa?=)
Date: Sat, 10 Jul 2010 19:31:03 +0200
Subject: [Rd] Set the number of threads using openmp with .C
Message-ID: <AANLkTikbNGO9fDEArAl-QgMvYkIwRqNqe7eox0WVsIKN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100710/1c9b744a/attachment.pl>

From edd at debian.org  Sat Jul 10 20:01:39 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 10 Jul 2010 13:01:39 -0500
Subject: [Rd] Set the number of threads using openmp with .C
In-Reply-To: <AANLkTikbNGO9fDEArAl-QgMvYkIwRqNqe7eox0WVsIKN@mail.gmail.com>
References: <AANLkTikbNGO9fDEArAl-QgMvYkIwRqNqe7eox0WVsIKN@mail.gmail.com>
Message-ID: <19512.46467.80330.279994@ron.nulle.part>


Eduardo,

On 10 July 2010 at 19:31, Eduardo Garc?a wrote:
| Hi everybody! Could somebody help me with the following?
| 
| I'm trying to run a simple Hello World code in openmp using .C function. The
| C code i have is:
| 
|  #include <omp.h>
|  #include <stdio.h>
|  #include <R.h>
| 
|  void hello_omp(int *n) {
|    int th_id, nthreads;
|    omp_set_num_threads(*n);
|    #pragma omp parallel private(th_id)
|    {
|      th_id = omp_get_thread_num();
|      Rprintf("Hello World from thread %d\n", th_id);
|      #pragma omp barrier
|      if ( th_id == 0 ) {
|        nthreads = omp_get_num_threads();
|        Rprintf("There are %d threads\n",nthreads);
|      }
|    }
| }
| 
| Where n is the number of threads that i want.
| 
| I compite it with "R CMD SHLIB hello_openmp_R.c -fopenmp" and when I try to
| run it in R using:
| 
| dyn.load("hello_openmp_R.so")
| hello_omp=function(n){.C("hello_omp",as.integer(n))}
| hello_omp(3)
| hello_omp(2)
| 
| Only 1 thread is been used, instead of 3 and 2:
| 
| > hello_omp(3)
| Hello World from thread 0
| There are 1 threads
| [[1]]
| [1] 3
| 
| 
| > hello_omp(2)
| Hello World from thread 0
| There are 1 threads
| [[1]]
| [1] 2
| 
| I also tried to set OMP_NUM_THREADS=3 in the Konsole with "export
| OMP_NUM_THREADS=3", in the .c file directory, but it seems that R don't
| recognize it when calls .C
| 
| I am using R version 2.10.1 in Ubuntu 9.10 - Karmic Koala, but i'm newbie in
| Linux.
| 
| Thanks a lot in advance for your help !*

You were almost there, but your compile instructions were wrong.  You must
pass -fopenmp to gcc. Which you tried, alas wrongly, and then overlooked the
warnings (and I called your file eduardo.c here) :

   gcc -std=gnu99 -I/usr/share/R/include      -fpic  -O3 -Wall -pipe  -c eduardo.c -o eduardo.o
   eduardo.c: In function ?hello_omp?:
   eduardo.c:7: warning: ignoring #pragma omp parallel
   eduardo.c:11: warning: ignoring #pragma omp barrier

One way of passing argument to gcc via 'R CMF foo' is to to use the
PKG_CPPFLAGS and PKG_LIBS arguments.  The following shell script builds and
runs the code:

   #!/bin/sh

   PKG_CPPFLAGS="-fopenmp" \
   PKG_LIBS="-lgomp" \
   R CMD SHLIB eduardo.c 

   cat <<EOF | R --silent --no-save
   dyn.load("eduardo.so")
   hello_omp=function(n){.C("hello_omp",as.integer(n))}
   hello_omp(3)
   hello_omp(2)
   EOF

and this generates the following output:

   edd at max:/tmp$ ./eduardo.sh 
   gcc -std=gnu99 -I/usr/share/R/include -fopenmp     -fpic  -O3 -Wall -pipe  -c eduardo.c -o eduardo.o
   gcc -std=gnu99 -shared -o eduardo.so eduardo.o -lgomp -L/usr/lib64/R/lib -lR
   > dyn.load("eduardo.so")
   > hello_omp=function(n){.C("hello_omp",as.integer(n))}
   > hello_omp(3)
   Hello World from thread 0
   Hello World from thread 2
   Hello World from thread 1
   There are 3 threads
   [[1]]
   [1] 3

   > hello_omp(2)
   Hello World from thread 0
   Hello World from thread 1
   There are 2 threads
   [[1]]
   [1] 2

   > 
   edd at max:/tmp$ 

Have a look at the CRAN package 'inline' which allows you to compile, load,
link such short code snippets much more easily.

Lastly, one word of caution. R is famously single-threaded. You may get
yourself into trouble with OpenMP unless you set locks rather carefully.
There is of course the famous example of Luke Tierney's pnmath (at
http://www.stat.uiowa.edu/~luke/R/experimental/) so there is also some scope
for using this.

Hope this helps.

-- 
  Regards, Dirk


From edd at debian.org  Sat Jul 10 20:10:18 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 10 Jul 2010 13:10:18 -0500
Subject: [Rd] Set the number of threads using openmp with .C
In-Reply-To: <19512.46467.80330.279994@ron.nulle.part>
References: <AANLkTikbNGO9fDEArAl-QgMvYkIwRqNqe7eox0WVsIKN@mail.gmail.com>
	<19512.46467.80330.279994@ron.nulle.part>
Message-ID: <19512.46986.437728.953109@ron.nulle.part>


On 10 July 2010 at 13:01, Dirk Eddelbuettel wrote:
| 
| Eduardo,
| 
| On 10 July 2010 at 19:31, Eduardo Garc?a wrote:
| | Hi everybody! Could somebody help me with the following?
| | 
| | I'm trying to run a simple Hello World code in openmp using .C function. The
| | C code i have is:
| | 
| |  #include <omp.h>
| |  #include <stdio.h>
| |  #include <R.h>
| | 
| |  void hello_omp(int *n) {
| |    int th_id, nthreads;
| |    omp_set_num_threads(*n);
| |    #pragma omp parallel private(th_id)
| |    {
| |      th_id = omp_get_thread_num();
| |      Rprintf("Hello World from thread %d\n", th_id);
| |      #pragma omp barrier
| |      if ( th_id == 0 ) {
| |        nthreads = omp_get_num_threads();
| |        Rprintf("There are %d threads\n",nthreads);
| |      }
| |    }
| | }
| | 
| | Where n is the number of threads that i want.
| | 
| | I compite it with "R CMD SHLIB hello_openmp_R.c -fopenmp" and when I try to
| | run it in R using:
| | 
| | dyn.load("hello_openmp_R.so")
| | hello_omp=function(n){.C("hello_omp",as.integer(n))}
| | hello_omp(3)
| | hello_omp(2)
| | 
| | Only 1 thread is been used, instead of 3 and 2:
| | 
| | > hello_omp(3)
| | Hello World from thread 0
| | There are 1 threads
| | [[1]]
| | [1] 3
| | 
| | 
| | > hello_omp(2)
| | Hello World from thread 0
| | There are 1 threads
| | [[1]]
| | [1] 2
| | 
| | I also tried to set OMP_NUM_THREADS=3 in the Konsole with "export
| | OMP_NUM_THREADS=3", in the .c file directory, but it seems that R don't
| | recognize it when calls .C
| | 
| | I am using R version 2.10.1 in Ubuntu 9.10 - Karmic Koala, but i'm newbie in
| | Linux.
| | 
| | Thanks a lot in advance for your help !*
| 
| You were almost there, but your compile instructions were wrong.  You must
| pass -fopenmp to gcc. Which you tried, alas wrongly, and then overlooked the
| warnings (and I called your file eduardo.c here) :
| 
|    gcc -std=gnu99 -I/usr/share/R/include      -fpic  -O3 -Wall -pipe  -c eduardo.c -o eduardo.o
|    eduardo.c: In function ?hello_omp?:
|    eduardo.c:7: warning: ignoring #pragma omp parallel
|    eduardo.c:11: warning: ignoring #pragma omp barrier
| 
| One way of passing argument to gcc via 'R CMF foo' is to to use the
| PKG_CPPFLAGS and PKG_LIBS arguments.  The following shell script builds and
| runs the code:
| 
|    #!/bin/sh
| 
|    PKG_CPPFLAGS="-fopenmp" \
|    PKG_LIBS="-lgomp" \
|    R CMD SHLIB eduardo.c 
| 
|    cat <<EOF | R --silent --no-save
|    dyn.load("eduardo.so")
|    hello_omp=function(n){.C("hello_omp",as.integer(n))}
|    hello_omp(3)
|    hello_omp(2)
|    EOF
| 
| and this generates the following output:
| 
|    edd at max:/tmp$ ./eduardo.sh 
|    gcc -std=gnu99 -I/usr/share/R/include -fopenmp     -fpic  -O3 -Wall -pipe  -c eduardo.c -o eduardo.o
|    gcc -std=gnu99 -shared -o eduardo.so eduardo.o -lgomp -L/usr/lib64/R/lib -lR
|    > dyn.load("eduardo.so")
|    > hello_omp=function(n){.C("hello_omp",as.integer(n))}
|    > hello_omp(3)
|    Hello World from thread 0
|    Hello World from thread 2
|    Hello World from thread 1
|    There are 3 threads
|    [[1]]
|    [1] 3
| 
|    > hello_omp(2)
|    Hello World from thread 0
|    Hello World from thread 1
|    There are 2 threads
|    [[1]]
|    [1] 2
| 
|    > 
|    edd at max:/tmp$ 
| 
| Have a look at the CRAN package 'inline' which allows you to compile, load,
| link such short code snippets much more easily.
| 
| Lastly, one word of caution. R is famously single-threaded. You may get
| yourself into trouble with OpenMP unless you set locks rather carefully.
| There is of course the famous example of Luke Tierney's pnmath (at
| http://www.stat.uiowa.edu/~luke/R/experimental/) so there is also some scope
| for using this.

PS:  Using PKG_CFLAGS is slightly better style; the outcome is the same. See
e.g. src/Makevars and src/Makevars.win in the pnmath package referenced
above.   

D.

| 
| Hope this helps.
| 
| -- 
|   Regards, Dirk
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
  Regards, Dirk


From pauljohn32 at gmail.com  Sat Jul 10 20:33:39 2010
From: pauljohn32 at gmail.com (Paul Johnson)
Date: Sat, 10 Jul 2010 13:33:39 -0500
Subject: [Rd] Large discrepancies in the same object being saved to
	.RData
In-Reply-To: <4C346F1A.8060302@gmail.com>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
	<4C346F1A.8060302@gmail.com>
Message-ID: <AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>

On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>
>> Hi developers,
>>
>>
>>
>> After some investigation I have found there can be large discrepancies in
>> the same object being saved as an external "xx.RData" file. The immediate
>> repercussion of this is the possible increased size of your .RData workspace
>> for no apparent reason.
>>
>>
>>
> I haven't worked through your example, but in general the way that local
> objects get captured is when part of the return value includes an
> environment.

Hi, can I ask a follow up question?

Is there a tool to browse *.Rdata files without loading them into R?

In HDF5 (a data storage format we use sometimes), there is a CLI
program "h5dump" that will spit out line-by-line all the contents of a
storage entity.  It will literally track through all the metadata, all
the vectors of scores, etc.  I've found that handy to "see what's
really  in there" in cases like the one that OP asked about.
Sometimes, we find that there are things that are "in there" by
mistake, as Duncan describes, and then we can try to figure why they
are in there.

pj


-- 
Paul E. Johnson
Professor, Political Science
1541 Lilac Lane, Room 504
University of Kansas


From murdoch.duncan at gmail.com  Sun Jul 11 02:36:20 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 10 Jul 2010 20:36:20 -0400
Subject: [Rd] Large discrepancies in the same object being saved to
	.RData
In-Reply-To: <AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>	<4C346F1A.8060302@gmail.com>
	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
Message-ID: <4C391204.3040601@gmail.com>

On 10/07/2010 2:33 PM, Paul Johnson wrote:
> On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>   
>> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>     
>>> Hi developers,
>>>
>>>
>>>
>>> After some investigation I have found there can be large discrepancies in
>>> the same object being saved as an external "xx.RData" file. The immediate
>>> repercussion of this is the possible increased size of your .RData workspace
>>> for no apparent reason.
>>>
>>>
>>>
>>>       
>> I haven't worked through your example, but in general the way that local
>> objects get captured is when part of the return value includes an
>> environment.
>>     
>
> Hi, can I ask a follow up question?
>
> Is there a tool to browse *.Rdata files without loading them into R?
>   

I don't know of one.  You can load the whole file into an empty 
environment, but then you lose information about "where did it come from"?

Duncan Murdoch
> In HDF5 (a data storage format we use sometimes), there is a CLI
> program "h5dump" that will spit out line-by-line all the contents of a
> storage entity.  It will literally track through all the metadata, all
> the vectors of scores, etc.  I've found that handy to "see what's
> really  in there" in cases like the one that OP asked about.
> Sometimes, we find that there are things that are "in there" by
> mistake, as Duncan describes, and then we can try to figure why they
> are in there.
>
> pj
>
>
>


From Bill.Venables at csiro.au  Sun Jul 11 03:39:54 2010
From: Bill.Venables at csiro.au (Bill.Venables at csiro.au)
Date: Sun, 11 Jul 2010 11:39:54 +1000
Subject: [Rd] Large discrepancies in the same object being saved
	to	.RData
In-Reply-To: <4C391204.3040601@gmail.com>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
	<4C346F1A.8060302@gmail.com>
	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
	<4C391204.3040601@gmail.com>
Message-ID: <1BDAE2969943D540934EE8B4EF68F95FB26EB6634F@EXNSW-MBX03.nexus.csiro.au>

I'm still a bit puzzled by the original question.  I don't think it
has much to do with .RData files and their sizes.  For me the puzzle
comes much earlier.  Here is an example of what I mean using a little
session

> usedVcells <- function() gc()["Vcells", "used"]
> usedVcells()        ### the base load
[1] 96345

### Now look at what happens when a function returns a formula as the
### value, with a big item floating around in the function closure:

> f0 <- function() {
+ junk <- rnorm(10000000)
+ y ~ x
+ }
> v0 <- f0()
> usedVcells()   ### much bigger than base, why?
[1] 10096355
> v0             ### no obvious envirnoment
y ~ x
> object.size(v0)  ### so far, no clue given where
                   ### the extra Vcells are located.
372 bytes

### Does v0 have an enclosing environment?

> environment(v0)             ### yep.
<environment: 0x021cc538>
> ls(envir = environment(v0)) ### as expected, there's the junk
[1] "junk"
> rm(junk, envir = environment(v0))  ### this does the trick.
> usedVcells()
[1] 96355

### Now consider a second example where the object
### is not a formula, but contains one.

> f1 <- function() {
+ junk <- rnorm(10000000)
+ x <- 1:3
+ y <- rnorm(3)
+ lm(y ~ x)
+ }

> v1 <- f1()
> usedVcells()  ### as might have been expected.
[1] 10096455

### in this case, though, there is no 
### (obvious) enclosing environment

> environment(v1)  
NULL
> object.size(v1)  ### so where are the junk Vcells located?
7744 bytes
> ls(envir = environment(v1))  ### clearly wil not work
Error in ls(envir = environment(v1)) : invalid 'envir' argument

> rm(v1)     ### removing the object does clear out the junk.
> usedVcells()
[1] 96366
> 

And in this second case, as noted by Julian Taylor, if you save() the
object the .RData file is also huge.  There is an environment attached
to the object somewhere, but it appears to be occluded and entirely
inaccessible.  (I have poked around the object components trying to
find the thing but without success.)

Have I missed something?

Bill Venables.

-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
Sent: Sunday, 11 July 2010 10:36 AM
To: Paul Johnson
Cc: r-devel at r-project.org
Subject: Re: [Rd] Large discrepancies in the same object being saved to .RData

On 10/07/2010 2:33 PM, Paul Johnson wrote:
> On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>   
>> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>     
>>> Hi developers,
>>>
>>>
>>>
>>> After some investigation I have found there can be large discrepancies in
>>> the same object being saved as an external "xx.RData" file. The immediate
>>> repercussion of this is the possible increased size of your .RData workspace
>>> for no apparent reason.
>>>
>>>
>>>
>>>       
>> I haven't worked through your example, but in general the way that local
>> objects get captured is when part of the return value includes an
>> environment.
>>     
>
> Hi, can I ask a follow up question?
>
> Is there a tool to browse *.Rdata files without loading them into R?
>   

I don't know of one.  You can load the whole file into an empty 
environment, but then you lose information about "where did it come from"?

Duncan Murdoch
> In HDF5 (a data storage format we use sometimes), there is a CLI
> program "h5dump" that will spit out line-by-line all the contents of a
> storage entity.  It will literally track through all the metadata, all
> the vectors of scores, etc.  I've found that handy to "see what's
> really  in there" in cases like the one that OP asked about.
> Sometimes, we find that there are things that are "in there" by
> mistake, as Duncan describes, and then we can try to figure why they
> are in there.
>
> pj
>
>
>

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From Bill.Venables at csiro.au  Sun Jul 11 04:10:05 2010
From: Bill.Venables at csiro.au (Bill.Venables at csiro.au)
Date: Sun, 11 Jul 2010 12:10:05 +1000
Subject: [Rd] Large discrepancies in the same object being saved
	to	.RData
In-Reply-To: <1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
	<4C346F1A.8060302@gmail.com>
	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
	<4C391204.3040601@gmail.com>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>
Message-ID: <1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>

Well, I have answered one of my questions below.  The hidden
environment is attached to the 'terms' component of v1.

To see this 

> lapply(v1, environment)
$coefficients
NULL

$residuals
NULL

$effects
NULL

$rank
NULL

$fitted.values
NULL

$assign
NULL

$qr
NULL

$df.residual
NULL

$xlevels
NULL

$call
NULL

$terms
<environment: 0x021b9e18>

$model
NULL

> rm(junk, envir = with(v1, environment(terms)))
> usedVcells()
[1] 96532
>  

This is still a bit of a trap for young (and old!) players...

I think the main point in my mind is why is it that object.size()
excludes enclosing environments in its reckonings?

Bill Venables.

-----Original Message-----
From: Venables, Bill (CMIS, Cleveland) 
Sent: Sunday, 11 July 2010 11:40 AM
To: 'Duncan Murdoch'; 'Paul Johnson'
Cc: 'r-devel at r-project.org'; Taylor, Julian (CMIS, Waite Campus)
Subject: RE: [Rd] Large discrepancies in the same object being saved to .RData

I'm still a bit puzzled by the original question.  I don't think it
has much to do with .RData files and their sizes.  For me the puzzle
comes much earlier.  Here is an example of what I mean using a little
session

> usedVcells <- function() gc()["Vcells", "used"]
> usedVcells()        ### the base load
[1] 96345

### Now look at what happens when a function returns a formula as the
### value, with a big item floating around in the function closure:

> f0 <- function() {
+ junk <- rnorm(10000000)
+ y ~ x
+ }
> v0 <- f0()
> usedVcells()   ### much bigger than base, why?
[1] 10096355
> v0             ### no obvious envirnoment
y ~ x
> object.size(v0)  ### so far, no clue given where
                   ### the extra Vcells are located.
372 bytes

### Does v0 have an enclosing environment?

> environment(v0)             ### yep.
<environment: 0x021cc538>
> ls(envir = environment(v0)) ### as expected, there's the junk
[1] "junk"
> rm(junk, envir = environment(v0))  ### this does the trick.
> usedVcells()
[1] 96355

### Now consider a second example where the object
### is not a formula, but contains one.

> f1 <- function() {
+ junk <- rnorm(10000000)
+ x <- 1:3
+ y <- rnorm(3)
+ lm(y ~ x)
+ }

> v1 <- f1()
> usedVcells()  ### as might have been expected.
[1] 10096455

### in this case, though, there is no 
### (obvious) enclosing environment

> environment(v1)  
NULL
> object.size(v1)  ### so where are the junk Vcells located?
7744 bytes
> ls(envir = environment(v1))  ### clearly wil not work
Error in ls(envir = environment(v1)) : invalid 'envir' argument

> rm(v1)     ### removing the object does clear out the junk.
> usedVcells()
[1] 96366
> 

And in this second case, as noted by Julian Taylor, if you save() the
object the .RData file is also huge.  There is an environment attached
to the object somewhere, but it appears to be occluded and entirely
inaccessible.  (I have poked around the object components trying to
find the thing but without success.)

Have I missed something?

Bill Venables.

-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
Sent: Sunday, 11 July 2010 10:36 AM
To: Paul Johnson
Cc: r-devel at r-project.org
Subject: Re: [Rd] Large discrepancies in the same object being saved to .RData

On 10/07/2010 2:33 PM, Paul Johnson wrote:
> On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>   
>> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>     
>>> Hi developers,
>>>
>>>
>>>
>>> After some investigation I have found there can be large discrepancies in
>>> the same object being saved as an external "xx.RData" file. The immediate
>>> repercussion of this is the possible increased size of your .RData workspace
>>> for no apparent reason.
>>>
>>>
>>>
>>>       
>> I haven't worked through your example, but in general the way that local
>> objects get captured is when part of the return value includes an
>> environment.
>>     
>
> Hi, can I ask a follow up question?
>
> Is there a tool to browse *.Rdata files without loading them into R?
>   

I don't know of one.  You can load the whole file into an empty 
environment, but then you lose information about "where did it come from"?

Duncan Murdoch
> In HDF5 (a data storage format we use sometimes), there is a CLI
> program "h5dump" that will spit out line-by-line all the contents of a
> storage entity.  It will literally track through all the metadata, all
> the vectors of scores, etc.  I've found that handy to "see what's
> really  in there" in cases like the one that OP asked about.
> Sometimes, we find that there are things that are "in there" by
> mistake, as Duncan describes, and then we can try to figure why they
> are in there.
>
> pj
>
>
>

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Sun Jul 11 06:12:53 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 11 Jul 2010 00:12:53 -0400
Subject: [Rd] Large discrepancies in the same object being saved to
	.RData
In-Reply-To: <1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>	<4C346F1A.8060302@gmail.com>	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
	<4C391204.3040601@gmail.com>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>
Message-ID: <4C3944C5.7010506@gmail.com>

On 10/07/2010 10:10 PM, Bill.Venables at csiro.au wrote:
> Well, I have answered one of my questions below.  The hidden
> environment is attached to the 'terms' component of v1.
>
> To see this 
>
>   
>> lapply(v1, environment)
>>     
> $coefficients
> NULL
>
> $residuals
> NULL
>
> $effects
> NULL
>
> $rank
> NULL
>
> $fitted.values
> NULL
>
> $assign
> NULL
>
> $qr
> NULL
>
> $df.residual
> NULL
>
> $xlevels
> NULL
>
> $call
> NULL
>
> $terms
> <environment: 0x021b9e18>
>
> $model
> NULL
>
>   
>> rm(junk, envir = with(v1, environment(terms)))
>> usedVcells()
>>     
> [1] 96532
>   
>>  
>>     
>
> This is still a bit of a trap for young (and old!) players...
>
> I think the main point in my mind is why is it that object.size()
> excludes enclosing environments in its reckonings?
>   

I think the idea is that the environment is not part of the object, it 
is just referenced by the object. In fact, there are at least two 
references to the environment in your second example:

environment(v1$terms)

and

attr(v1$terms, ".Environment")

both refer to it. So you can't just add the size of an environment every 
time you come across it, you would need to keep track of whether it had 
already been counted or not. So as ?object.size says,

"Associated space (e.g. the environment of a function and what the
pointer in a ?EXTPTRSXP? points to) is not included in the
calculation."
> If you really want to know how much space an object will take when saved, probably the only reliable way is to save the object and look at how much space the file takes.
>   

Duncan Murdoch

> Bill Venables.
>
> -----Original Message-----
> From: Venables, Bill (CMIS, Cleveland) 
> Sent: Sunday, 11 July 2010 11:40 AM
> To: 'Duncan Murdoch'; 'Paul Johnson'
> Cc: 'r-devel at r-project.org'; Taylor, Julian (CMIS, Waite Campus)
> Subject: RE: [Rd] Large discrepancies in the same object being saved to .RData
>
> I'm still a bit puzzled by the original question.  I don't think it
> has much to do with .RData files and their sizes.  For me the puzzle
> comes much earlier.  Here is an example of what I mean using a little
> session
>
>   
>> usedVcells <- function() gc()["Vcells", "used"]
>> usedVcells()        ### the base load
>>     
> [1] 96345
>
> ### Now look at what happens when a function returns a formula as the
> ### value, with a big item floating around in the function closure:
>
>   
>> f0 <- function() {
>>     
> + junk <- rnorm(10000000)
> + y ~ x
> + }
>   
>> v0 <- f0()
>> usedVcells()   ### much bigger than base, why?
>>     
> [1] 10096355
>   
>> v0             ### no obvious envirnoment
>>     
> y ~ x
>   
>> object.size(v0)  ### so far, no clue given where
>>     
>                    ### the extra Vcells are located.
> 372 bytes
>
> ### Does v0 have an enclosing environment?
>
>   
>> environment(v0)             ### yep.
>>     
> <environment: 0x021cc538>
>   
>> ls(envir = environment(v0)) ### as expected, there's the junk
>>     
> [1] "junk"
>   
>> rm(junk, envir = environment(v0))  ### this does the trick.
>> usedVcells()
>>     
> [1] 96355
>
> ### Now consider a second example where the object
> ### is not a formula, but contains one.
>
>   
>> f1 <- function() {
>>     
> + junk <- rnorm(10000000)
> + x <- 1:3
> + y <- rnorm(3)
> + lm(y ~ x)
> + }
>
>   
>> v1 <- f1()
>> usedVcells()  ### as might have been expected.
>>     
> [1] 10096455
>
> ### in this case, though, there is no 
> ### (obvious) enclosing environment
>
>   
>> environment(v1)  
>>     
> NULL
>   
>> object.size(v1)  ### so where are the junk Vcells located?
>>     
> 7744 bytes
>   
>> ls(envir = environment(v1))  ### clearly wil not work
>>     
> Error in ls(envir = environment(v1)) : invalid 'envir' argument
>
>   
>> rm(v1)     ### removing the object does clear out the junk.
>> usedVcells()
>>     
> [1] 96366
>   
>
> And in this second case, as noted by Julian Taylor, if you save() the
> object the .RData file is also huge.  There is an environment attached
> to the object somewhere, but it appears to be occluded and entirely
> inaccessible.  (I have poked around the object components trying to
> find the thing but without success.)
>
> Have I missed something?
>
> Bill Venables.
>
> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
> Sent: Sunday, 11 July 2010 10:36 AM
> To: Paul Johnson
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Large discrepancies in the same object being saved to .RData
>
> On 10/07/2010 2:33 PM, Paul Johnson wrote:
>   
>> On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>   
>>     
>>> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>>     
>>>       
>>>> Hi developers,
>>>>
>>>>
>>>>
>>>> After some investigation I have found there can be large discrepancies in
>>>> the same object being saved as an external "xx.RData" file. The immediate
>>>> repercussion of this is the possible increased size of your .RData workspace
>>>> for no apparent reason.
>>>>
>>>>
>>>>
>>>>       
>>>>         
>>> I haven't worked through your example, but in general the way that local
>>> objects get captured is when part of the return value includes an
>>> environment.
>>>     
>>>       
>> Hi, can I ask a follow up question?
>>
>> Is there a tool to browse *.Rdata files without loading them into R?
>>   
>>     
>
> I don't know of one.  You can load the whole file into an empty 
> environment, but then you lose information about "where did it come from"?
>
> Duncan Murdoch
>   
>> In HDF5 (a data storage format we use sometimes), there is a CLI
>> program "h5dump" that will spit out line-by-line all the contents of a
>> storage entity.  It will literally track through all the metadata, all
>> the vectors of scores, etc.  I've found that handy to "see what's
>> really  in there" in cases like the one that OP asked about.
>> Sometimes, we find that there are things that are "in there" by
>> mistake, as Duncan describes, and then we can try to figure why they
>> are in there.
>>
>> pj
>>
>>
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From john.maindonald at anu.edu.au  Sun Jul 11 10:50:14 2010
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Sun, 11 Jul 2010 18:50:14 +1000
Subject: [Rd] "Undocumented code objects" message from missing alias
Message-ID: <2CF6F91A-3A9A-4427-8E3B-3C20026FAF67@anu.edu.au>

If I omit the \alias{houseprices} from the second line of a data
documentation file houseprices.Rd, R CMD check gives the warning message:

"
Undocumented code objects:
 houseprices
All user-level objects in a package should have documentation entries.
See the chapter 'Writing R documentation files' in manual 'Writing R
Extensions'.
"

I can build the package without error, but the help file for houseprices
is missing.  It would be good to have a message that gives a more
direct indication of what is wrong.

Running R CMD check on the directory at 
http://www.maths.anu.edu.au/~johnm/r/packages/testpkg
demonstrates the point.

John Maindonald             email: john.maindonald at anu.edu.au
phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
Centre for Mathematics & Its Applications, Room 1194,
John Dedman Mathematical Sciences Building (Building 27)
Australian National University, Canberra ACT 0200.
http://www.maths.anu.edu.au/~johnm


From taplate at gmail.com  Sun Jul 11 17:08:44 2010
From: taplate at gmail.com (Tony Plate)
Date: Sun, 11 Jul 2010 11:08:44 -0400
Subject: [Rd] Large discrepancies in the same object being
	saved	to	.RData
In-Reply-To: <1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>	<4C346F1A.8060302@gmail.com>	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>	<4C391204.3040601@gmail.com>	<1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>
Message-ID: <4C39DE7C.8060802@acm.org>

Another way of seeing the environments referenced in an object is using 
str(), e.g.:

 > f1 <- function() {
+ junk <- rnorm(10000000)
+ x <- 1:3
+ y <- rnorm(3)
+ lm(y ~ x)
+ }
 > v1 <- f1()
 > object.size(f1)
1636 bytes
 > grep("Environment", capture.output(str(v1)), value=TRUE)
[1] "  .. ..- attr(*, \".Environment\")=<environment: 0x01f11a30> "
[2] "  .. .. ..- attr(*, \".Environment\")=<environment: 0x01f11a30> "
 >

-- Tony Plate

On 7/10/2010 10:10 PM, Bill.Venables at csiro.au wrote:
> Well, I have answered one of my questions below.  The hidden
> environment is attached to the 'terms' component of v1.
>
> To see this
>
>    
>> lapply(v1, environment)
>>      
> $coefficients
> NULL
>
> $residuals
> NULL
>
> $effects
> NULL
>
> $rank
> NULL
>
> $fitted.values
> NULL
>
> $assign
> NULL
>
> $qr
> NULL
>
> $df.residual
> NULL
>
> $xlevels
> NULL
>
> $call
> NULL
>
> $terms
> <environment: 0x021b9e18>
>
> $model
> NULL
>
>    
>> rm(junk, envir = with(v1, environment(terms)))
>> usedVcells()
>>      
> [1] 96532
>    
>>
>>      
> This is still a bit of a trap for young (and old!) players...
>
> I think the main point in my mind is why is it that object.size()
> excludes enclosing environments in its reckonings?
>
> Bill Venables.
>
> -----Original Message-----
> From: Venables, Bill (CMIS, Cleveland)
> Sent: Sunday, 11 July 2010 11:40 AM
> To: 'Duncan Murdoch'; 'Paul Johnson'
> Cc: 'r-devel at r-project.org'; Taylor, Julian (CMIS, Waite Campus)
> Subject: RE: [Rd] Large discrepancies in the same object being saved to .RData
>
> I'm still a bit puzzled by the original question.  I don't think it
> has much to do with .RData files and their sizes.  For me the puzzle
> comes much earlier.  Here is an example of what I mean using a little
> session
>
>    
>> usedVcells<- function() gc()["Vcells", "used"]
>> usedVcells()        ### the base load
>>      
> [1] 96345
>
> ### Now look at what happens when a function returns a formula as the
> ### value, with a big item floating around in the function closure:
>
>    
>> f0<- function() {
>>      
> + junk<- rnorm(10000000)
> + y ~ x
> + }
>    
>> v0<- f0()
>> usedVcells()   ### much bigger than base, why?
>>      
> [1] 10096355
>    
>> v0             ### no obvious envirnoment
>>      
> y ~ x
>    
>> object.size(v0)  ### so far, no clue given where
>>      
>                     ### the extra Vcells are located.
> 372 bytes
>
> ### Does v0 have an enclosing environment?
>
>    
>> environment(v0)             ### yep.
>>      
> <environment: 0x021cc538>
>    
>> ls(envir = environment(v0)) ### as expected, there's the junk
>>      
> [1] "junk"
>    
>> rm(junk, envir = environment(v0))  ### this does the trick.
>> usedVcells()
>>      
> [1] 96355
>
> ### Now consider a second example where the object
> ### is not a formula, but contains one.
>
>    
>> f1<- function() {
>>      
> + junk<- rnorm(10000000)
> + x<- 1:3
> + y<- rnorm(3)
> + lm(y ~ x)
> + }
>
>    
>> v1<- f1()
>> usedVcells()  ### as might have been expected.
>>      
> [1] 10096455
>
> ### in this case, though, there is no
> ### (obvious) enclosing environment
>
>    
>> environment(v1)
>>      
> NULL
>    
>> object.size(v1)  ### so where are the junk Vcells located?
>>      
> 7744 bytes
>    
>> ls(envir = environment(v1))  ### clearly wil not work
>>      
> Error in ls(envir = environment(v1)) : invalid 'envir' argument
>
>    
>> rm(v1)     ### removing the object does clear out the junk.
>> usedVcells()
>>      
> [1] 96366
>    
>>      
> And in this second case, as noted by Julian Taylor, if you save() the
> object the .RData file is also huge.  There is an environment attached
> to the object somewhere, but it appears to be occluded and entirely
> inaccessible.  (I have poked around the object components trying to
> find the thing but without success.)
>
> Have I missed something?
>
> Bill Venables.
>
> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
> Sent: Sunday, 11 July 2010 10:36 AM
> To: Paul Johnson
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Large discrepancies in the same object being saved to .RData
>
> On 10/07/2010 2:33 PM, Paul Johnson wrote:
>    
>> On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch<murdoch.duncan at gmail.com>  wrote:
>>
>>      
>>> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>>
>>>        
>>>> Hi developers,
>>>>
>>>>
>>>>
>>>> After some investigation I have found there can be large discrepancies in
>>>> the same object being saved as an external "xx.RData" file. The immediate
>>>> repercussion of this is the possible increased size of your .RData workspace
>>>> for no apparent reason.
>>>>
>>>>
>>>>
>>>>
>>>>          
>>> I haven't worked through your example, but in general the way that local
>>> objects get captured is when part of the return value includes an
>>> environment.
>>>
>>>        
>> Hi, can I ask a follow up question?
>>
>> Is there a tool to browse *.Rdata files without loading them into R?
>>
>>      
> I don't know of one.  You can load the whole file into an empty
> environment, but then you lose information about "where did it come from"?
>
> Duncan Murdoch
>    
>> In HDF5 (a data storage format we use sometimes), there is a CLI
>> program "h5dump" that will spit out line-by-line all the contents of a
>> storage entity.  It will literally track through all the metadata, all
>> the vectors of scores, etc.  I've found that handy to "see what's
>> really  in there" in cases like the one that OP asked about.
>> Sometimes, we find that there are things that are "in there" by
>> mistake, as Duncan describes, and then we can try to figure why they
>> are in there.
>>
>> pj
>>
>>
>>
>>      
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>


From ripley at stats.ox.ac.uk  Sun Jul 11 19:30:20 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 11 Jul 2010 18:30:20 +0100 (BST)
Subject: [Rd] Large discrepancies in the same object being saved to
 .RData
In-Reply-To: <4C39DE7C.8060802@acm.org>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
	<4C346F1A.8060302@gmail.com>
	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
	<4C391204.3040601@gmail.com>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>
	<4C39DE7C.8060802@acm.org>
Message-ID: <alpine.LFD.2.00.1007111715220.20108@gannet.stats.ox.ac.uk>

On Sun, 11 Jul 2010, Tony Plate wrote:

> Another way of seeing the environments referenced in an object is using 
> str(), e.g.:
>
>> f1 <- function() {
> + junk <- rnorm(10000000)
> + x <- 1:3
> + y <- rnorm(3)
> + lm(y ~ x)
> + }
>> v1 <- f1()
>> object.size(f1)
> 1636 bytes
>> grep("Environment", capture.output(str(v1)), value=TRUE)
> [1] "  .. ..- attr(*, \".Environment\")=<environment: 0x01f11a30> "
> [2] "  .. .. ..- attr(*, \".Environment\")=<environment: 0x01f11a30> "

'Some of the environments in a few cases': remember environments have 
environments (and so on), and that namespaces and packages are also 
environments.  So we need to know about the environment of 
environment(v1$terms), which also gets saved (either as a reference or 
as an environment, depending on what it is).

And this approach does not work for many of the commonest cases:

> f <- function() {
+ x <- pi
+ g <- function() print(x)
+ return(g)
+ }
> g <- f()
> str(g)
function ()
  - attr(*, "source")= chr "function() print(x)"
> ls(environment(g))
[1] "g" "x"

In fact I think it works only for formulae.

> -- Tony Plate
>
> On 7/10/2010 10:10 PM, Bill.Venables at csiro.au wrote:
>> Well, I have answered one of my questions below.  The hidden
>> environment is attached to the 'terms' component of v1.

Well, not really hidden.  A terms component is a formula (see 
?terms.object), and a formula has an environment just as a closure 
does.  In neither case does the print() method tell you about it -- 
but ?formula does.

>> To see this
>>
>> 
>>> lapply(v1, environment)
>>> 
>> $coefficients
>> NULL
>> 
>> $residuals
>> NULL
>> 
>> $effects
>> NULL
>> 
>> $rank
>> NULL
>> 
>> $fitted.values
>> NULL
>> 
>> $assign
>> NULL
>> 
>> $qr
>> NULL
>> 
>> $df.residual
>> NULL
>> 
>> $xlevels
>> NULL
>> 
>> $call
>> NULL
>> 
>> $terms
>> <environment: 0x021b9e18>
>> 
>> $model
>> NULL
>>
>> 
>>> rm(junk, envir = with(v1, environment(terms)))
>>> usedVcells()
>>> 
>> [1] 96532
>> 
>>>
>>> 
>> This is still a bit of a trap for young (and old!) players...
>> 
>> I think the main point in my mind is why is it that object.size()
>> excludes enclosing environments in its reckonings?
>> 
>> Bill Venables.
>> 
>> -----Original Message-----
>> From: Venables, Bill (CMIS, Cleveland)
>> Sent: Sunday, 11 July 2010 11:40 AM
>> To: 'Duncan Murdoch'; 'Paul Johnson'
>> Cc: 'r-devel at r-project.org'; Taylor, Julian (CMIS, Waite Campus)
>> Subject: RE: [Rd] Large discrepancies in the same object being saved to 
>> .RData
>> 
>> I'm still a bit puzzled by the original question.  I don't think it
>> has much to do with .RData files and their sizes.  For me the puzzle
>> comes much earlier.  Here is an example of what I mean using a little
>> session
>>
>> 
>>> usedVcells<- function() gc()["Vcells", "used"]
>>> usedVcells()        ### the base load
>>> 
>> [1] 96345
>> 
>> ### Now look at what happens when a function returns a formula as the
>> ### value, with a big item floating around in the function closure:
>>
>> 
>>> f0<- function() {
>>> 
>> + junk<- rnorm(10000000)
>> + y ~ x
>> + }
>> 
>>> v0<- f0()
>>> usedVcells()   ### much bigger than base, why?
>>> 
>> [1] 10096355
>> 
>>> v0             ### no obvious envirnoment
>>> 
>> y ~ x
>> 
>>> object.size(v0)  ### so far, no clue given where
>>>
>>                     ### the extra Vcells are located.
>> 372 bytes
>> 
>> ### Does v0 have an enclosing environment?
>>
>> 
>>> environment(v0)             ### yep.
>>> 
>> <environment: 0x021cc538>
>> 
>>> ls(envir = environment(v0)) ### as expected, there's the junk
>>> 
>> [1] "junk"
>> 
>>> rm(junk, envir = environment(v0))  ### this does the trick.
>>> usedVcells()
>>> 
>> [1] 96355
>> 
>> ### Now consider a second example where the object
>> ### is not a formula, but contains one.
>>
>> 
>>> f1<- function() {
>>> 
>> + junk<- rnorm(10000000)
>> + x<- 1:3
>> + y<- rnorm(3)
>> + lm(y ~ x)
>> + }
>>
>> 
>>> v1<- f1()
>>> usedVcells()  ### as might have been expected.
>>> 
>> [1] 10096455
>> 
>> ### in this case, though, there is no
>> ### (obvious) enclosing environment
>>
>> 
>>> environment(v1)
>>> 
>> NULL
>> 
>>> object.size(v1)  ### so where are the junk Vcells located?
>>> 
>> 7744 bytes
>> 
>>> ls(envir = environment(v1))  ### clearly wil not work
>>> 
>> Error in ls(envir = environment(v1)) : invalid 'envir' argument
>>
>> 
>>> rm(v1)     ### removing the object does clear out the junk.
>>> usedVcells()
>>> 
>> [1] 96366
>>
>>> 
>> And in this second case, as noted by Julian Taylor, if you save() the
>> object the .RData file is also huge.  There is an environment attached
>> to the object somewhere, but it appears to be occluded and entirely
>> inaccessible.  (I have poked around the object components trying to
>> find the thing but without success.)
>> 
>> Have I missed something?
>> 
>> Bill Venables.
>> 
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] 
>> On Behalf Of Duncan Murdoch
>> Sent: Sunday, 11 July 2010 10:36 AM
>> To: Paul Johnson
>> Cc: r-devel at r-project.org
>> Subject: Re: [Rd] Large discrepancies in the same object being saved to 
>> .RData
>> 
>> On 10/07/2010 2:33 PM, Paul Johnson wrote:
>> 
>>> On Wed, Jul 7, 2010 at 7:12 AM, Duncan Murdoch<murdoch.duncan at gmail.com> 
>>> wrote:
>>>
>>> 
>>>> On 06/07/2010 9:04 PM, Julian.Taylor at csiro.au wrote:
>>>>
>>>> 
>>>>> Hi developers,
>>>>> 
>>>>> 
>>>>> 
>>>>> After some investigation I have found there can be large discrepancies 
>>>>> in
>>>>> the same object being saved as an external "xx.RData" file. The 
>>>>> immediate
>>>>> repercussion of this is the possible increased size of your .RData 
>>>>> workspace
>>>>> for no apparent reason.
>>>>> 
>>>>> 
>>>>> 
>>>>>
>>>>> 
>>>> I haven't worked through your example, but in general the way that local
>>>> objects get captured is when part of the return value includes an
>>>> environment.
>>>>
>>>> 
>>> Hi, can I ask a follow up question?
>>> 
>>> Is there a tool to browse *.Rdata files without loading them into R?
>>>
>>> 
>> I don't know of one.  You can load the whole file into an empty
>> environment, but then you lose information about "where did it come from"?
>> 
>> Duncan Murdoch
>> 
>>> In HDF5 (a data storage format we use sometimes), there is a CLI
>>> program "h5dump" that will spit out line-by-line all the contents of a
>>> storage entity.  It will literally track through all the metadata, all
>>> the vectors of scores, etc.  I've found that handy to "see what's
>>> really  in there" in cases like the one that OP asked about.
>>> Sometimes, we find that there are things that are "in there" by
>>> mistake, as Duncan describes, and then we can try to figure why they
>>> are in there.
>>> 
>>> pj
>>> 
>>> 
>>>
>>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>> 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From djsamperi at gmail.com  Sun Jul 11 20:48:06 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Sun, 11 Jul 2010 14:48:06 -0400
Subject: [Rd] LinkingTo and C++
In-Reply-To: <01F75CF2-FA06-420B-A4DD-6776197B1E2B@r-project.org>
References: <4B73C916.4090705@r-enthusiasts.com>
	<01F75CF2-FA06-420B-A4DD-6776197B1E2B@r-project.org>
Message-ID: <AANLkTikvnk4vpX8U_cg2YBWEm1ySHTMHvNpYIJeld2Cv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100711/997212c0/attachment.pl>

From murdoch.duncan at gmail.com  Sun Jul 11 23:25:45 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 11 Jul 2010 17:25:45 -0400
Subject: [Rd] Large discrepancies in the same object being saved to
	.RData
In-Reply-To: <alpine.LFD.2.00.1007111715220.20108@gannet.stats.ox.ac.uk>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>	<4C346F1A.8060302@gmail.com>	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>	<4C391204.3040601@gmail.com>	<1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>	<1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>	<4C39DE7C.8060802@acm.org>
	<alpine.LFD.2.00.1007111715220.20108@gannet.stats.ox.ac.uk>
Message-ID: <4C3A36D9.3010400@gmail.com>

On 11/07/2010 1:30 PM, Prof Brian Ripley wrote:
> On Sun, 11 Jul 2010, Tony Plate wrote:
> 
>> Another way of seeing the environments referenced in an object is using 
>> str(), e.g.:
>>
>>> f1 <- function() {
>> + junk <- rnorm(10000000)
>> + x <- 1:3
>> + y <- rnorm(3)
>> + lm(y ~ x)
>> + }
>>> v1 <- f1()
>>> object.size(f1)
>> 1636 bytes
>>> grep("Environment", capture.output(str(v1)), value=TRUE)
>> [1] "  .. ..- attr(*, \".Environment\")=<environment: 0x01f11a30> "
>> [2] "  .. .. ..- attr(*, \".Environment\")=<environment: 0x01f11a30> "
> 
> 'Some of the environments in a few cases': remember environments have 
> environments (and so on), and that namespaces and packages are also 
> environments.  So we need to know about the environment of 
> environment(v1$terms), which also gets saved (either as a reference or 
> as an environment, depending on what it is).
> 
> And this approach does not work for many of the commonest cases:
> 
>> f <- function() {
> + x <- pi
> + g <- function() print(x)
> + return(g)
> + }
>> g <- f()
>> str(g)
> function ()
>   - attr(*, "source")= chr "function() print(x)"
>> ls(environment(g))
> [1] "g" "x"
> 
> In fact I think it works only for formulae.
> 
>> -- Tony Plate
>>
>> On 7/10/2010 10:10 PM, Bill.Venables at csiro.au wrote:
>>> Well, I have answered one of my questions below.  The hidden
>>> environment is attached to the 'terms' component of v1.
> 
> Well, not really hidden.  A terms component is a formula (see 
> ?terms.object), and a formula has an environment just as a closure 
> does.  In neither case does the print() method tell you about it -- 
> but ?formula does.
> 

I've just changed the default print method for formulas to display the 
environment if it is not globalenv(), which is the rule used for 
closures as well.  So now in R-devel:

 > as.formula("y ~ x")
y ~ x

as before, but

 > as.formula("y ~ x", env=new.env())
y ~ x
<environment: 01f83400>

Duncan Murdoch


From ajferg06 at comcast.net  Mon Jul 12 02:56:56 2010
From: ajferg06 at comcast.net (Aaron J. Ferguson)
Date: Sun, 11 Jul 2010 20:56:56 -0400
Subject: [Rd] Saving an R program as C Code
Message-ID: <AANLkTinzgoxYT6coW53dpvQDO3RuWTvc-MFvKPZIfmCN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100711/0301bcdf/attachment.pl>

From chiefmurphy at gmail.com  Mon Jul 12 06:08:01 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Sun, 11 Jul 2010 21:08:01 -0700
Subject: [Rd] S4 class extends "data.frame", getDataPart sees "list"
Message-ID: <AANLkTikacvePDIi3H2ubxxjjIIvJKT7E7xSH373NCvpE@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100711/30c3e016/attachment.pl>

From lux-integ at btconnect.com  Mon Jul 12 11:29:30 2010
From: lux-integ at btconnect.com (lI)
Date: Mon, 12 Jul 2010 10:29:30 +0100
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib' prefix
Message-ID: <201007121029.30870.lux-integ@btconnect.com>

Greetings,

I have a computer with the following setup:
1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2 
2)R-2.11.1    

I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
lpthread -latlas  -lfptf77blas" 
--with-lapack="-llapack -lcblas"  ). 
(( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )

Prior to compiling R-2.11.1
sh conigure --help   gave  options including  the following
SHLIB_LD         command for linking shared libraries 
                which contain object files  from a C or Fortran compiler only                              
SHLIB_LDFLAGS   special flags used by SHLIB_LD
SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD                               
SHLIB_FCD   command for linking shared libraries which contain object files 
              from the Fortran 95 compiler                                    
SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD 


I did not know what to set for these   and accepted whatever the defaults 
were.  I ended up with shared-libraries which are  as  follows:-

$R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib' 
and the following shared-libraries  without the 'lib' prefix.

$R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
$R_HOME/library/cluster/libs/cluster.so
$R_HOME/library/foreign/libs/foreign.so
$R_HOME/library/grDevices/libs/grDevices.so
$R_HOME/library/grid/libs/grid.so
$R_HOME/library/KernSmooth/libs/KernSmooth.so
$R_HOME/library/lattice/libs/lattice.so
$R_HOME/library/MASS/libs/MASS.so
$R_HOME/library/Matrix/libs/Matrix.so
$R_HOME/library/methods/libs/methods.so
$R_HOME/library/mgcv/libs/mgcv.so
$R_HOME/library/nlme/libs/nlme.so
$R_HOME/library/nnet/libs/nnet.so
$R_HOME/library/rpart/libs/rpart.so
$R_HOME/library/spatial/libs/spatial.so
$R_HOME/library/splines/libs/splines.so
$R_HOME/library/stats/libs/stats.so
$R_HOME/library/survival/libs/survival.so
$R_HOME/library/tools/libs/tools.so


In linux builds   the linker usually looks for libs with the 'lib'  prefix.  In 
this installation  all the libraries   
---in $R_HOME/modules
---in $R_HOME/library/patha/to/whatevr

do not have the   'lib' prefix.  

QUESTION:
A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS    
SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these result 
in  so libs with the 'lib' prefix?
B) If all of A) is negative what is there to be done to    to enable 
generation   libraries in $R_HOME/modules $R_HOME/library/~  with the 'lib' 
prefix?


suggestions welcomed.

luxInteg


From maechler at stat.math.ethz.ch  Mon Jul 12 11:48:46 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 12 Jul 2010 11:48:46 +0200
Subject: [Rd] Large discrepancies in the same object being saved
	to	.RData
In-Reply-To: <4C3A36D9.3010400@gmail.com>
References: <62C82B39B8A85E4B95A18F7F7B852F87057236625D@exvic-mbx03.nexus.csiro.au>
	<4C346F1A.8060302@gmail.com>
	<AANLkTimUSBF4mQpc7ZC0kovoBTUiSgwPIiM_acr9ds2H@mail.gmail.com>
	<4C391204.3040601@gmail.com>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB6E6D3@EXNSW-MBX03.nexus.csiro.au>
	<1BDAE2969943D540934EE8B4EF68F95FB26EB66350@EXNSW-MBX03.nexus.csiro.au>
	<4C39DE7C.8060802@acm.org>
	<alpine.LFD.2.00.1007111715220.20108@gannet.stats.ox.ac.uk>
	<4C3A36D9.3010400@gmail.com>
Message-ID: <19514.58622.757461.570952@lynne.math.ethz.ch>

>>>>> "DM" == Duncan Murdoch <murdoch.duncan at gmail.com>
>>>>>     on Sun, 11 Jul 2010 17:25:45 -0400 writes:

    DM> On 11/07/2010 1:30 PM, Prof Brian Ripley wrote:

    [........................]

    >>> On 7/10/2010 10:10 PM, Bill.Venables at csiro.au wrote:
    >>>> Well, I have answered one of my questions below.  The hidden
    >>>> environment is attached to the 'terms' component of v1.

    >> Well, not really hidden.  A terms component is a formula
    >> (see ?terms.object), and a formula has an environment
    >> just as a closure does.  In neither case does the print()
    >> method tell you about it -- but ?formula does.

    DM> I've just changed the default print method for formulas to display the 
    DM> environment if it is not globalenv(), which is the rule used for 
    DM> closures as well.  So now in R-devel:

    >> as.formula("y ~ x")
    DM> y ~ x

    DM> as before, but

    >> as.formula("y ~ x", env=new.env())
    DM> y ~ x
    DM> <environment: 01f83400>

I see that our print.formula() actually has not truely fulfilled
our own rule about print methods:

?print   has
 > Description:
 > 
 >      ?print? prints its argument and returns it _invisibly_ 
 >      ..........

Further, I completely agree that it's good to mention the
environment, however, it can be a nuisance when it's part of a
larger print(.) method, so I'd like allowing to suppress that
and hence I've committed the current

print.formula <- function(x, showEnv = !identical(e, .GlobalEnv), ...)
{
    e <- environment(.x <- x) ## return(.) original x
    attr(x, ".Environment") <- NULL
    print.default(unclass(x), ...)
    if (showEnv) print(e)
    invisible(.x)
}

--
Martin Maechler, ETH Zurich


From lux-integ at btconnect.com  Mon Jul 12 12:07:23 2010
From: lux-integ at btconnect.com (lI)
Date: Mon, 12 Jul 2010 11:07:23 +0100
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib'
	prefix//update
In-Reply-To: <201007121029.30870.lux-integ@btconnect.com>
References: <201007121029.30870.lux-integ@btconnect.com>
Message-ID: <201007121107.23287.lux-integ@btconnect.com>

On Monday 12 July 2010 10:29:30 lI wrote:
> Greetings,
> 
> I have a computer with the following setup:
> 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2
> 2)R-2.11.1
> 
> I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
> lpthread -latlas  -lfptf77blas"
> --with-lapack="-llapack -lcblas"  ).
> (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )
> 
> Prior to compiling R-2.11.1
> sh conigure --help   gave  options including  the following
> SHLIB_LD         command for linking shared libraries
>                 which contain object files  from a C or Fortran compiler
>  only SHLIB_LDFLAGS   special flags used by SHLIB_LD
> SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD
> SHLIB_FCD   command for linking shared libraries which contain object files
>               from the Fortran 95 compiler
> SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD
> 
> 
> I did not know what to set for these   and accepted whatever the defaults
> were.  I ended up with shared-libraries which are  as  follows:-
> 
> $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib'
> and the following shared-libraries  without the 'lib' prefix.
> 
> $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
> $R_HOME/library/cluster/libs/cluster.so
> $R_HOME/library/foreign/libs/foreign.so
> $R_HOME/library/grDevices/libs/grDevices.so
> $R_HOME/library/grid/libs/grid.so
> $R_HOME/library/KernSmooth/libs/KernSmooth.so
> $R_HOME/library/lattice/libs/lattice.so
> $R_HOME/library/MASS/libs/MASS.so
> $R_HOME/library/Matrix/libs/Matrix.so
> $R_HOME/library/methods/libs/methods.so
> $R_HOME/library/mgcv/libs/mgcv.so
> $R_HOME/library/nlme/libs/nlme.so
> $R_HOME/library/nnet/libs/nnet.so
> $R_HOME/library/rpart/libs/rpart.so
> $R_HOME/library/spatial/libs/spatial.so
> $R_HOME/library/splines/libs/splines.so
> $R_HOME/library/stats/libs/stats.so
> $R_HOME/library/survival/libs/survival.so
> $R_HOME/library/tools/libs/tools.so
> 
> 
> In linux builds   the linker usually looks for libs with the 'lib'  prefix.
>   In this installation  all the libraries
> ---in $R_HOME/modules
> ---in $R_HOME/library/patha/to/whatevr
> 
> do not have the   'lib' prefix.
> 
> QUESTION:
> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
>  result in  so libs with the 'lib' prefix?
> B) If all of A) is negative what is there to be done to    to enable
> generation   libraries in $R_HOME/modules $R_HOME/library/~  with the 'lib'
> prefix?
> 

I forgot to add     my configure/make  options.  These were:-
########################
export BUILD64="-m64"
sh configure \
CC="gcc $BUILD64" \
CXX="g++ $BUILD64" \
F77="gfortran  $BUILD64" \
FC="gfortran  $BUILD64" \
JAVA_HOME=$JAVA_HOME \
LIBnn=lib64 \
CPPFLAGS="-I$ATLAS_HOME/include -I/opt/acml4.4.0/gfortran64_mp/include  -
I/opt/acml4.4.0/gfortran64/include -I/usr/local/numerics/include" \
LDFLAGS="-L$ATLAS_HOME/lib  -L/opt/acml4.4.0/gfortran64_mp/lib -
L/usr/local/numerics/lib -L/usr/lib" \
--prefix=/opt/TEST/R-2.11.1 \
--x-includes=$XORG_PREFIX/include \
--x-libraries=$XORG_PREFIX/lib \
--with-tcl-config=/usr/lib  \
--with-tk-config=/usr/lib \
--with-system-zlib=/usr  \
--with-system-bzlib=/usr \
--with-system-pcre=/usr  \
--with-x  \
--with-libpth-prefix=/usr \
--with-libintl-prefix=/usr \
--with-blas="-lpthread -latlas  -lfptf77blas" \
--with-lapack="-llapack -lcblas" \
--enable-R-shlib \
--enable-BLAS-shlib 
################

The sources  compiled trouble-free.   with  'make'  as normal user.
I then ran  'make install' as  super-user  and int installed in the prefix as 
set..

A reply to the following questions would be much appreciateed:-
QUESTION:
 A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
 SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
  result in  so libs with the 'lib' prefix?
 B) If all of A) is negative what is there to be done to   enable
 generation  of  shared-libraries in $R_HOME/modules/ and  $R_HOME/library/~  
directories/sub-directories  with the 'lib'    prefix?


sincerely
luxInteg


From renaud at mancala.cbio.uct.ac.za  Mon Jul 12 12:35:50 2010
From: renaud at mancala.cbio.uct.ac.za (Renaud Gaujoux)
Date: Mon, 12 Jul 2010 12:35:50 +0200
Subject: [Rd] Defining a method that behaves like '$'?
In-Reply-To: <ED711666-E051-4D94-95D1-CB40B5DC5D65@me.com>
References: <4C371398.80603@cbio.uct.ac.za> <4C371645.6030204@gmail.com>
	<4C371AE3.9060801@cbio.uct.ac.za>
	<8D37932C-62F7-44C0-BAFA-9A77ABADE59F@me.com>
	<4C371FB0.9040700@cbio.uct.ac.za>
	<AANLkTimRISCE4AjmCThITuF9qYaUyzuvhaSottcYXxuK@mail.gmail.com>
	<ED711666-E051-4D94-95D1-CB40B5DC5D65@me.com>
Message-ID: <4C3AF006.2050507@cbio.uct.ac.za>

Thanks all.
Just to clarify a bit my intention with another '$'-like function. It 
was due to the nice features of '$':
- it hides the internal implementation
- it is known by most users so no extra brain-memory is required
- it is quick and simple to write, which I think is actually very 
important as R code is often written repeatedly over and over
- it allows for auto-completion
- it allows dynamic structures in the sense that one can allow the user 
to add its own 'members' which are accessible through the same 
interface: 'a$custom.member', 'a$builtin.member'.

I will try to work out a solution from all the suggestions I got from 
the list.
Thanks again to all.

Renaud.

-- 
Renaud Gaujoux
Computational Biology - University of Cape Town
South Africa


On 10/07/2010 17:29, Marc Schwartz wrote:
> On Jul 10, 2010, at 7:24 AM, Barry Rowlingson wrote:
>
>    
>> On Fri, Jul 9, 2010 at 2:10 PM, Renaud Gaujoux
>> <renaud at mancala.cbio.uct.ac.za>  wrote:
>>      
>>> I do not want to access the slot itself but its content: a:toto would be
>>> a at slot1[['toto']].
>>> The thing is that I would like to have two different methods: '$' (that I
>>> already have) and another one to define, ideally that behaves like '$'.
>>> So in brief:
>>> - a:toto would be for a at slot1[['toto']]
>>> - a$tata would be for a at slot2[['tata']]
>>>
>>> But apparently it might not be possible.
>>>
>>>        
>> Even if possible, definitely not desirable. As already mentioned, a:b
>> is the sequence a to b (as in 0:10), so it's going to look weird to
>> anyone who hasn't noticed your definition. Also, it looks fairly
>> meaningless. By which I mean there's no obvious reason why a colon
>> should do what you want it to do. There's also no obvious reason why a
>> dollar sign does what it does (whats it got to do with dollars?) but
>> we've had it for 20 years so we're stuck with it.
>>
>> Write a method for your objects and force your users to do a bit more
>> typing as a trade-off for legibility:
>>
>> slot1(a,"toto")
>>
>> is a lot more readable than a:toto (assuming you replace 'slot1' with
>> something meaningful).
>>
>> Remember, code is most likely to be written once, and read many times
>> - so make it easy for readers!
>>      
>
> Just to throw in another $0.02, in hindsight, not fully understanding the context of Renaud's original query, this may be a situation where implementing relevant extractor functions would make sense.
>
> Consider functions such as coef(), effects(), fitted() etc. for regression models. These allow you and your users to have functions that return components of your object class without being concerned about the internal structure of your object. Importantly, you and your users will not be affected by future changes to your object structure that you may find you have to implement over time. You simply modify the extractor functions as required when the internal structure of your class changes, so that they can be used post-change, without breaking existing code.
>
> So for example:
>
>    toto(a)
>
> would return a at slot1[['toto']] and
>
>    tata(a)
>
> would return a at slot2[['tata']].
>
> Food for thought.
>
> Marc
>
>    

 

###
UNIVERSITY OF CAPE TOWN 

This e-mail is subject to the UCT ICT policies and e-mail disclaimer published on our website at http://www.uct.ac.za/about/policies/emaildisclaimer/ or obtainable from +27 21 650 4500. This e-mail is intended only for the person(s) to whom it is addressed. If the e-mail has reached you in error, please notify the author. If you are not the intended recipient of the e-mail you may not use, disclose, copy, redirect or print the content. If this e-mail is not related to the business of UCT it is sent by the sender in the sender's individual capacity.

###


From therneau at mayo.edu  Mon Jul 12 15:44:21 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Mon, 12 Jul 2010 08:44:21 -0500
Subject: [Rd] Large discrepancies in the same object being saved to
	.RData
In-Reply-To: <mailman.17.1278928806.10324.r-devel@r-project.org>
References: <mailman.17.1278928806.10324.r-devel@r-project.org>
Message-ID: <1278942261.12038.23.camel@punchbuggy>

 I only wish to add a request for further documentation of hidden
environments, their consequences, and how to turn them off.  Perhaps a
page in the Extending R guide, and a suggestion for book authors.

  I was bitten by this with the coxph frailty functions.  They are
called during the model frame creation and create a matrix object with
various small attached functions as attributes.  In creating the 'x'
columns they have to deal with factors and can create a huge transient
temporary matrix while doing so; something that will never be needed
again.  A user was exceeding disk quotas when he saved a model fit.

  As someone with years of experience with functional languages (which S
once was), I wasn't used to the idea that one would have to take
explicit --- and mysterious --- steps to make local variables go away.
This discussion has revealed that the hidden rules causing local
variables to be kept are more complex than I thought.  Perhaps a "don't
save environments" option to save could be added to help mere mortals
get rid of all this stuff in the attic (with its secret staircase)?

[[Soapbox on]] Environments have proven useful for many things, and
certainly aren't going away.  But to quote the bard "Oh what tangled
webs we weave, when first we practice to decieve."

Terry Therneau


From simon.urbanek at r-project.org  Mon Jul 12 17:44:39 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 12 Jul 2010 11:44:39 -0400
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib' prefix
In-Reply-To: <201007121029.30870.lux-integ@btconnect.com>
References: <201007121029.30870.lux-integ@btconnect.com>
Message-ID: <3C90606D-A657-4067-B5E9-255AB4CFAD7A@r-project.org>


On Jul 12, 2010, at 5:29 AM, lI wrote:

> Greetings,
> 
> I have a computer with the following setup:
> 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2 
> 2)R-2.11.1    
> 
> I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
> lpthread -latlas  -lfptf77blas" 
> --with-lapack="-llapack -lcblas"  ). 
> (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )
> 
> Prior to compiling R-2.11.1
> sh conigure --help   gave  options including  the following
> SHLIB_LD         command for linking shared libraries 
>                which contain object files  from a C or Fortran compiler only                              
> SHLIB_LDFLAGS   special flags used by SHLIB_LD
> SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD                               
> SHLIB_FCD   command for linking shared libraries which contain object files 
>              from the Fortran 95 compiler                                    
> SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD 
> 
> 
> I did not know what to set for these   and accepted whatever the defaults 
> were.  I ended up with shared-libraries which are  as  follows:-
> 
> $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib' 
> and the following shared-libraries  without the 'lib' prefix.
> 

Those are not shared libraries - they are shared objects loaded by R dynamically.

Cheers,
Simon



> $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
> $R_HOME/library/cluster/libs/cluster.so
> $R_HOME/library/foreign/libs/foreign.so
> $R_HOME/library/grDevices/libs/grDevices.so
> $R_HOME/library/grid/libs/grid.so
> $R_HOME/library/KernSmooth/libs/KernSmooth.so
> $R_HOME/library/lattice/libs/lattice.so
> $R_HOME/library/MASS/libs/MASS.so
> $R_HOME/library/Matrix/libs/Matrix.so
> $R_HOME/library/methods/libs/methods.so
> $R_HOME/library/mgcv/libs/mgcv.so
> $R_HOME/library/nlme/libs/nlme.so
> $R_HOME/library/nnet/libs/nnet.so
> $R_HOME/library/rpart/libs/rpart.so
> $R_HOME/library/spatial/libs/spatial.so
> $R_HOME/library/splines/libs/splines.so
> $R_HOME/library/stats/libs/stats.so
> $R_HOME/library/survival/libs/survival.so
> $R_HOME/library/tools/libs/tools.so
> 
> 
> In linux builds   the linker usually looks for libs with the 'lib'  prefix.  In 
> this installation  all the libraries   
> ---in $R_HOME/modules
> ---in $R_HOME/library/patha/to/whatevr
> 
> do not have the   'lib' prefix.  
> 
> QUESTION:
> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS    
> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these result 
> in  so libs with the 'lib' prefix?
> B) If all of A) is negative what is there to be done to    to enable 
> generation   libraries in $R_HOME/modules $R_HOME/library/~  with the 'lib' 
> prefix?
> 
> 
> suggestions welcomed.
> 
> luxInteg
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From lux-integ at btconnect.com  Mon Jul 12 20:50:55 2010
From: lux-integ at btconnect.com (lI)
Date: Mon, 12 Jul 2010 19:50:55 +0100
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib'
	prefix//update
In-Reply-To: <201007121107.23287.lux-integ@btconnect.com>
References: <201007121029.30870.lux-integ@btconnect.com>
	<201007121107.23287.lux-integ@btconnect.com>
Message-ID: <201007121950.55739.lux-integ@btconnect.com>

On Monday 12 July 2010 11:07:23 lI wrote:
> On Monday 12 July 2010 10:29:30 lI wrote:
> > Greetings,
> >
> > I have a computer with the following setup:
> > 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2
> > 2)R-2.11.1
> >
> > I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
> > lpthread -latlas  -lfptf77blas"
> > --with-lapack="-llapack -lcblas"  ).
> > (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )
> >
> > Prior to compiling R-2.11.1
> > sh conigure --help   gave  options including  the following
> > SHLIB_LD         command for linking shared libraries
> >                 which contain object files  from a C or Fortran compiler
> >  only SHLIB_LDFLAGS   special flags used by SHLIB_LD
> > SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD
> > SHLIB_FCD   command for linking shared libraries which contain object
> > files from the Fortran 95 compiler
> > SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD
> >
> >
> > I did not know what to set for these   and accepted whatever the defaults
> > were.  I ended up with shared-libraries which are  as  follows:-
> >
> > $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib'
> > and the following shared-libraries  without the 'lib' prefix.
> >
> > $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
> > $R_HOME/library/cluster/libs/cluster.so
> > $R_HOME/library/foreign/libs/foreign.so
> > $R_HOME/library/grDevices/libs/grDevices.so
> > $R_HOME/library/grid/libs/grid.so
> > $R_HOME/library/KernSmooth/libs/KernSmooth.so
> > $R_HOME/library/lattice/libs/lattice.so
> > $R_HOME/library/MASS/libs/MASS.so
> > $R_HOME/library/Matrix/libs/Matrix.so
> > $R_HOME/library/methods/libs/methods.so
> > $R_HOME/library/mgcv/libs/mgcv.so
> > $R_HOME/library/nlme/libs/nlme.so
> > $R_HOME/library/nnet/libs/nnet.so
> > $R_HOME/library/rpart/libs/rpart.so
> > $R_HOME/library/spatial/libs/spatial.so
> > $R_HOME/library/splines/libs/splines.so
> > $R_HOME/library/stats/libs/stats.so
> > $R_HOME/library/survival/libs/survival.so
> > $R_HOME/library/tools/libs/tools.so
> >
> >
> > In linux builds   the linker usually looks for libs with the 'lib' 
> > prefix. In this installation  all the libraries
> > ---in $R_HOME/modules
> > ---in $R_HOME/library/patha/to/whatevr
> >
> > do not have the   'lib' prefix.
> >
> > QUESTION:
> > A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
> > SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
> >  result in  so libs with the 'lib' prefix?
> > B) If all of A) is negative what is there to be done to    to enable
> > generation   libraries in $R_HOME/modules $R_HOME/library/~  with the
> > 'lib' prefix?
> 
> I forgot to add     my configure/make  options.  These were:-
> ########################
> export BUILD64="-m64"
> sh configure \
> CC="gcc $BUILD64" \
> CXX="g++ $BUILD64" \
> F77="gfortran  $BUILD64" \
> FC="gfortran  $BUILD64" \
> JAVA_HOME=$JAVA_HOME \
> LIBnn=lib64 \
> CPPFLAGS="-I$ATLAS_HOME/include -I/opt/acml4.4.0/gfortran64_mp/include  -
> I/opt/acml4.4.0/gfortran64/include -I/usr/local/numerics/include" \
> LDFLAGS="-L$ATLAS_HOME/lib  -L/opt/acml4.4.0/gfortran64_mp/lib -
> L/usr/local/numerics/lib -L/usr/lib" \
> --prefix=/opt/TEST/R-2.11.1 \
> --x-includes=$XORG_PREFIX/include \
> --x-libraries=$XORG_PREFIX/lib \
> --with-tcl-config=/usr/lib  \
> --with-tk-config=/usr/lib \
> --with-system-zlib=/usr  \
> --with-system-bzlib=/usr \
> --with-system-pcre=/usr  \
> --with-x  \
> --with-libpth-prefix=/usr \
> --with-libintl-prefix=/usr \
> --with-blas="-lpthread -latlas  -lfptf77blas" \
> --with-lapack="-llapack -lcblas" \
> --enable-R-shlib \
> --enable-BLAS-shlib
> ################
> 
> The sources  compiled trouble-free.   with  'make'  as normal user.
> I then ran  'make install' as  super-user  and int installed in the prefix
>  as set..
> 
> A reply to the following questions would be much appreciateed:-
> QUESTION:
>  A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
>  SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
>   result in  so libs with the 'lib' prefix?
>  B) If all of A) is negative what is there to be done to   enable
>  generation  of  shared-libraries in $R_HOME/modules/ and 
>  $R_HOME/library/~ directories/sub-directories  with the 'lib'    prefix?
> 
> 
thanks everyone for the help in clarifying what were share-libraries  and 
otherwise.

As stated above I used two switches
 --enable-R-shlib \
 --enable-BLAS-shlib
in the   configure options of the downloaded R-2.11.1 source  prior to 
compilation.

I am compiling  R-2.11.1   as  an optional dependency of kdeedu-4.4.5.    This 
asks for R-shlib   )which I noticed it is disable by the default  in the 
configure script.)

After compile and install of R-2.11.1,  I am only able to start R from the 
command  line when I   move the generated libRblas.so to libRblas.soDUFF and 
symlink libacml.so    to libRblas.so  and update $R_HOME/etc/ldpaths  
accordingly.  I am unable to start R  with the compiled-in  $R_HOME/libR.so 
and  $R_HOME/libRblas.so.

QUESTIONS:
A) How  does one  start R with the  the generated  libR.so and libRblas.so? 
B) is the generated  libR.so  interchangable with libRblas.so  (i.e. R library 
without blas   enhanced algebra  capabilities?)


advice   welcomed


From edugarpor at gmail.com  Mon Jul 12 21:42:07 2010
From: edugarpor at gmail.com (=?ISO-8859-1?Q?Eduardo_Garc=EDa?=)
Date: Mon, 12 Jul 2010 21:42:07 +0200
Subject: [Rd] How to use mpi.allreduce() in Rmpi?
In-Reply-To: <AANLkTimMhTUfowmqCf9DUdil0OvOpQakEUPpSdzVYKvF@mail.gmail.com>
References: <AANLkTimMhTUfowmqCf9DUdil0OvOpQakEUPpSdzVYKvF@mail.gmail.com>
Message-ID: <AANLkTikoLTBtZgkWmx_FJBtMSYlfsUfy1RWx0JzOF5GN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100712/f1f9ec83/attachment.pl>

From simon.urbanek at r-project.org  Mon Jul 12 21:52:15 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 12 Jul 2010 15:52:15 -0400
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib'
	prefix//update
In-Reply-To: <201007121950.55739.lux-integ@btconnect.com>
References: <201007121029.30870.lux-integ@btconnect.com>
	<201007121107.23287.lux-integ@btconnect.com>
	<201007121950.55739.lux-integ@btconnect.com>
Message-ID: <0B33AEC1-7E7C-42DC-A2CD-187A64DB8680@r-project.org>


On Jul 12, 2010, at 2:50 PM, lI wrote:

> On Monday 12 July 2010 11:07:23 lI wrote:
>> On Monday 12 July 2010 10:29:30 lI wrote:
>>> Greetings,
>>> 
>>> I have a computer with the following setup:
>>> 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2
>>> 2)R-2.11.1
>>> 
>>> I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
>>> lpthread -latlas  -lfptf77blas"
>>> --with-lapack="-llapack -lcblas"  ).
>>> (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )
>>> 
>>> Prior to compiling R-2.11.1
>>> sh conigure --help   gave  options including  the following
>>> SHLIB_LD         command for linking shared libraries
>>>                which contain object files  from a C or Fortran compiler
>>> only SHLIB_LDFLAGS   special flags used by SHLIB_LD
>>> SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD
>>> SHLIB_FCD   command for linking shared libraries which contain object
>>> files from the Fortran 95 compiler
>>> SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD
>>> 
>>> 
>>> I did not know what to set for these   and accepted whatever the defaults
>>> were.  I ended up with shared-libraries which are  as  follows:-
>>> 
>>> $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib'
>>> and the following shared-libraries  without the 'lib' prefix.
>>> 
>>> $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
>>> $R_HOME/library/cluster/libs/cluster.so
>>> $R_HOME/library/foreign/libs/foreign.so
>>> $R_HOME/library/grDevices/libs/grDevices.so
>>> $R_HOME/library/grid/libs/grid.so
>>> $R_HOME/library/KernSmooth/libs/KernSmooth.so
>>> $R_HOME/library/lattice/libs/lattice.so
>>> $R_HOME/library/MASS/libs/MASS.so
>>> $R_HOME/library/Matrix/libs/Matrix.so
>>> $R_HOME/library/methods/libs/methods.so
>>> $R_HOME/library/mgcv/libs/mgcv.so
>>> $R_HOME/library/nlme/libs/nlme.so
>>> $R_HOME/library/nnet/libs/nnet.so
>>> $R_HOME/library/rpart/libs/rpart.so
>>> $R_HOME/library/spatial/libs/spatial.so
>>> $R_HOME/library/splines/libs/splines.so
>>> $R_HOME/library/stats/libs/stats.so
>>> $R_HOME/library/survival/libs/survival.so
>>> $R_HOME/library/tools/libs/tools.so
>>> 
>>> 
>>> In linux builds   the linker usually looks for libs with the 'lib' 
>>> prefix. In this installation  all the libraries
>>> ---in $R_HOME/modules
>>> ---in $R_HOME/library/patha/to/whatevr
>>> 
>>> do not have the   'lib' prefix.
>>> 
>>> QUESTION:
>>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
>>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
>>> result in  so libs with the 'lib' prefix?
>>> B) If all of A) is negative what is there to be done to    to enable
>>> generation   libraries in $R_HOME/modules $R_HOME/library/~  with the
>>> 'lib' prefix?
>> 
>> I forgot to add     my configure/make  options.  These were:-
>> ########################
>> export BUILD64="-m64"
>> sh configure \
>> CC="gcc $BUILD64" \
>> CXX="g++ $BUILD64" \
>> F77="gfortran  $BUILD64" \
>> FC="gfortran  $BUILD64" \
>> JAVA_HOME=$JAVA_HOME \
>> LIBnn=lib64 \
>> CPPFLAGS="-I$ATLAS_HOME/include -I/opt/acml4.4.0/gfortran64_mp/include  -
>> I/opt/acml4.4.0/gfortran64/include -I/usr/local/numerics/include" \
>> LDFLAGS="-L$ATLAS_HOME/lib  -L/opt/acml4.4.0/gfortran64_mp/lib -
>> L/usr/local/numerics/lib -L/usr/lib" \
>> --prefix=/opt/TEST/R-2.11.1 \
>> --x-includes=$XORG_PREFIX/include \
>> --x-libraries=$XORG_PREFIX/lib \
>> --with-tcl-config=/usr/lib  \
>> --with-tk-config=/usr/lib \
>> --with-system-zlib=/usr  \
>> --with-system-bzlib=/usr \
>> --with-system-pcre=/usr  \
>> --with-x  \
>> --with-libpth-prefix=/usr \
>> --with-libintl-prefix=/usr \
>> --with-blas="-lpthread -latlas  -lfptf77blas" \
>> --with-lapack="-llapack -lcblas" \
>> --enable-R-shlib \
>> --enable-BLAS-shlib
>> ################
>> 
>> The sources  compiled trouble-free.   with  'make'  as normal user.
>> I then ran  'make install' as  super-user  and int installed in the prefix
>> as set..
>> 
>> A reply to the following questions would be much appreciateed:-
>> QUESTION:
>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
>>  result in  so libs with the 'lib' prefix?
>> B) If all of A) is negative what is there to be done to   enable
>> generation  of  shared-libraries in $R_HOME/modules/ and 
>> $R_HOME/library/~ directories/sub-directories  with the 'lib'    prefix?
>> 
>> 
> thanks everyone for the help in clarifying what were share-libraries  and 
> otherwise.
> 
> As stated above I used two switches
> --enable-R-shlib \
> --enable-BLAS-shlib
> in the   configure options of the downloaded R-2.11.1 source  prior to 
> compilation.
> 
> I am compiling  R-2.11.1   as  an optional dependency of kdeedu-4.4.5.    This 
> asks for R-shlib   )which I noticed it is disable by the default  in the 
> configure script.)
> 
> After compile and install of R-2.11.1,  I am only able to start R from the 
> command  line

How are you starting it? The R start script does setup everything so that you should never touch anything inside.


> when I   move the generated libRblas.so to libRblas.soDUFF and 
> symlink libacml.so    to libRblas.so  and update $R_HOME/etc/ldpaths  
> accordingly.  I am unable to start R  with the compiled-in  $R_HOME/libR.so 
> and  $R_HOME/libRblas.so.
> 
> QUESTIONS:
> A) How  does one  start R with the  the generated  libR.so and libRblas.so? 

bin/R


> B) is the generated  libR.so  interchangable with libRblas.so  (i.e. R library 
> without blas   enhanced algebra  capabilities?)
> 

No - those are two entirely different libraries. The libRblas can be interchanged with a suitably complete BLAS implementation, but please do read the manuals for details.

Cheers,
Simon


From cstrato at aon.at  Mon Jul 12 22:45:43 2010
From: cstrato at aon.at (cstrato)
Date: Mon, 12 Jul 2010 22:45:43 +0200
Subject: [Rd] Severe memory problem using split()
Message-ID: <4C3B7EF7.6080301@aon.at>

Dear all,

With great interest I followed the discussion:
https://stat.ethz.ch/pipermail/r-devel/2010-July/057901.html
since I have currently a similar problem:

In a new R session (using xterm) I am importing a simple table 
"Hu6800_ann.txt" which has a size of 754KB only:

 > ann <- read.delim("Hu6800_ann.txt")
 > dim(ann)
[1] 7129   11


When I call "object.size(ann)" the estimated memory used to store "ann" 
is already 2MB:

 > object.size(ann)
2034784 bytes


Now I call "split()" and check the estimated memory used which turns out 
to be 3.3GB:

 > u2p  <- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
 > object.size(u2p)
3323768120 bytes

During the R session I am running "top" in another xterm and can see 
that the memory usage of R increases to about 550MB RSIZE.


Now I do:

 > object.size(unlist(u2p))
894056 bytes

It takes about 3 minutes to complete this call and the memory usage of R 
increases to about 1.3GB RSIZE. Furthermore, during evaluation of this 
function the free RAM of my Mac decreases to less than 8MB free PhysMem, 
until it needs to swap memory. When finished, free PhysMem is 734MB but 
the size of R increased to 577MB RSIZE.

Doing "split(ann[,"ProbesetID"],ann[,"UNIT_ID"],drop=TRUE)" did not 
change the object.size, only processing was faster and it did use less 
memory on my Mac.

Do you have any idea what the reason for this behavior is?
Why is the size of list "u2p" so large?
Do I make any mistake?


Here is my sessionInfo on a MacBook Pro with 2GB RAM:

 > sessionInfo()
R version 2.11.1 (2010-05-31)
x86_64-apple-darwin9.8.0

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Best regards
Christian
_._._._._._._._._._._._._._._._._._
C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
V.i.e.n.n.a           A.u.s.t.r.i.a
e.m.a.i.l:        cstrato at aon.at
_._._._._._._._._._._._._._._._._._


From hpages at fhcrc.org  Mon Jul 12 22:51:16 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 12 Jul 2010 13:51:16 -0700
Subject: [Rd] Strange issues with new R-based 'R CMD build' and 'R CMD
 check' scripts on Windows
Message-ID: <4C3B8044.6000306@fhcrc.org>

Hi,

Kind of related to the new R-based 'R CMD build' script being
sometimes confused on Windows (as reported here a couple of weeks
ago https://stat.ethz.ch/pipermail/r-devel/2010-June/057759.html),
I also started to observe that the new R-based 'R CMD check' script
gets also confused sometimes on Windows in a random way.

It seems that sometimes (maybe 1% of the times) running 'R CMD check'
is actually running another script, not the 'check' script, e.g.,
here
 
http://bioconductor.org/checkResults/2.7/bioc-LATEST/geneplotter/gewurz-checksrc.html
the output of the command looks like if 'R CMD build' was run instead
of 'R CMD check'.

Here
 
http://bioconductor.org/checkResults/2.7/bioc-LATEST/lumi/gewurz-checksrc.html
it looks like if 'R CMD Rd2txt' was run.

Same here
 
http://bioconductor.org/checkResults/2.7/bioc-LATEST/HTqPCR/liverpool-checksrc.html
and here
 
http://bioconductor.org/checkResults/2.7/bioc-LATEST/iterativeBMAsurv/liverpool-checksrc.html

Like with the new R-based 'R CMD build' script, the problem seems
to happen randomly for a couple of packages every day. It seems to
affect our 2 Windows build machines, 32-bit and 64-bit. Both are
using R-2.12.0 (2010-07-06 r52464).

Cheers,
H.


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mtmorgan at fhcrc.org  Mon Jul 12 23:44:00 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 12 Jul 2010 14:44:00 -0700
Subject: [Rd] Severe memory problem using split()
In-Reply-To: <4C3B7EF7.6080301@aon.at>
References: <4C3B7EF7.6080301@aon.at>
Message-ID: <4C3B8CA0.9060508@fhcrc.org>

On 07/12/2010 01:45 PM, cstrato wrote:
> Dear all,
> 
> With great interest I followed the discussion:
> https://stat.ethz.ch/pipermail/r-devel/2010-July/057901.html
> since I have currently a similar problem:
> 
> In a new R session (using xterm) I am importing a simple table
> "Hu6800_ann.txt" which has a size of 754KB only:
> 
>> ann <- read.delim("Hu6800_ann.txt")
>> dim(ann)
> [1] 7129   11
> 
> 
> When I call "object.size(ann)" the estimated memory used to store "ann"
> is already 2MB:
> 
>> object.size(ann)
> 2034784 bytes
> 
> 
> Now I call "split()" and check the estimated memory used which turns out
> to be 3.3GB:
> 
>> u2p  <- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
>> object.size(u2p)
> 3323768120 bytes

I guess things improve with stringsAsFactors=FALSE in read.delim?

Martin

> 
> During the R session I am running "top" in another xterm and can see
> that the memory usage of R increases to about 550MB RSIZE.
> 
> 
> Now I do:
> 
>> object.size(unlist(u2p))
> 894056 bytes
> 
> It takes about 3 minutes to complete this call and the memory usage of R
> increases to about 1.3GB RSIZE. Furthermore, during evaluation of this
> function the free RAM of my Mac decreases to less than 8MB free PhysMem,
> until it needs to swap memory. When finished, free PhysMem is 734MB but
> the size of R increased to 577MB RSIZE.
> 
> Doing "split(ann[,"ProbesetID"],ann[,"UNIT_ID"],drop=TRUE)" did not
> change the object.size, only processing was faster and it did use less
> memory on my Mac.
> 
> Do you have any idea what the reason for this behavior is?
> Why is the size of list "u2p" so large?
> Do I make any mistake?
> 
> 
> Here is my sessionInfo on a MacBook Pro with 2GB RAM:
> 
>> sessionInfo()
> R version 2.11.1 (2010-05-31)
> x86_64-apple-darwin9.8.0
> 
> locale:
> [1] C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> Best regards
> Christian
> _._._._._._._._._._._._._._._._._._
> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
> V.i.e.n.n.a           A.u.s.t.r.i.a
> e.m.a.i.l:        cstrato at aon.at
> _._._._._._._._._._._._._._._._._._
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From cstrato at aon.at  Tue Jul 13 00:00:14 2010
From: cstrato at aon.at (cstrato)
Date: Tue, 13 Jul 2010 00:00:14 +0200
Subject: [Rd] Severe memory problem using split()
In-Reply-To: <4C3B8CA0.9060508@fhcrc.org>
References: <4C3B7EF7.6080301@aon.at> <4C3B8CA0.9060508@fhcrc.org>
Message-ID: <4C3B906E.1030004@aon.at>

Dear Martin,

Thank you, you are right, now I get:

 > ann <- read.delim("Hu6800_ann.txt", stringsAsFactors=FALSE)
 > object.size(ann)
2035952 bytes
 > u2p  <- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
 > object.size(u2p)
1207368 bytes
 > object.size(unlist(u2p))
865176 bytes

Nevertheless, a size of 1.2MB for a list representing 2 of 11 columns of 
a table of size 754KB seems still to be pretty large?

Best regards
Christian


On 7/12/10 11:44 PM, Martin Morgan wrote:
> On 07/12/2010 01:45 PM, cstrato wrote:
>> Dear all,
>>
>> With great interest I followed the discussion:
>> https://stat.ethz.ch/pipermail/r-devel/2010-July/057901.html
>> since I have currently a similar problem:
>>
>> In a new R session (using xterm) I am importing a simple table
>> "Hu6800_ann.txt" which has a size of 754KB only:
>>
>>> ann<- read.delim("Hu6800_ann.txt")
>>> dim(ann)
>> [1] 7129   11
>>
>>
>> When I call "object.size(ann)" the estimated memory used to store "ann"
>> is already 2MB:
>>
>>> object.size(ann)
>> 2034784 bytes
>>
>>
>> Now I call "split()" and check the estimated memory used which turns out
>> to be 3.3GB:
>>
>>> u2p<- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
>>> object.size(u2p)
>> 3323768120 bytes
>
> I guess things improve with stringsAsFactors=FALSE in read.delim?
>
> Martin
>
>>
>> During the R session I am running "top" in another xterm and can see
>> that the memory usage of R increases to about 550MB RSIZE.
>>
>>
>> Now I do:
>>
>>> object.size(unlist(u2p))
>> 894056 bytes
>>
>> It takes about 3 minutes to complete this call and the memory usage of R
>> increases to about 1.3GB RSIZE. Furthermore, during evaluation of this
>> function the free RAM of my Mac decreases to less than 8MB free PhysMem,
>> until it needs to swap memory. When finished, free PhysMem is 734MB but
>> the size of R increased to 577MB RSIZE.
>>
>> Doing "split(ann[,"ProbesetID"],ann[,"UNIT_ID"],drop=TRUE)" did not
>> change the object.size, only processing was faster and it did use less
>> memory on my Mac.
>>
>> Do you have any idea what the reason for this behavior is?
>> Why is the size of list "u2p" so large?
>> Do I make any mistake?
>>
>>
>> Here is my sessionInfo on a MacBook Pro with 2GB RAM:
>>
>>> sessionInfo()
>> R version 2.11.1 (2010-05-31)
>> x86_64-apple-darwin9.8.0
>>
>> locale:
>> [1] C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> Best regards
>> Christian
>> _._._._._._._._._._._._._._._._._._
>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>> V.i.e.n.n.a           A.u.s.t.r.i.a
>> e.m.a.i.l:        cstrato at aon.at
>> _._._._._._._._._._._._._._._._._._
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From lux-integ at btconnect.com  Mon Jul 12 23:59:14 2010
From: lux-integ at btconnect.com (lI)
Date: Mon, 12 Jul 2010 22:59:14 +0100
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib'
	prefix//update
In-Reply-To: <0B33AEC1-7E7C-42DC-A2CD-187A64DB8680@r-project.org>
References: <201007121029.30870.lux-integ@btconnect.com>
	<201007121950.55739.lux-integ@btconnect.com>
	<0B33AEC1-7E7C-42DC-A2CD-187A64DB8680@r-project.org>
Message-ID: <201007122259.14529.lux-integ@btconnect.com>

On Monday 12 July 2010 20:52:15 Simon Urbanek wrote:
> On Jul 12, 2010, at 2:50 PM, lI wrote:
> > On Monday 12 July 2010 11:07:23 lI wrote:
> >> On Monday 12 July 2010 10:29:30 lI wrote:
> >>> Greetings,
> >>>
> >>> I have a computer with the following setup:
> >>> 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2
> >>> 2)R-2.11.1
> >>>
> >>> I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
> >>> lpthread -latlas  -lfptf77blas"
> >>> --with-lapack="-llapack -lcblas"  ).
> >>> (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )
> >>>
> >>> Prior to compiling R-2.11.1
> >>> sh conigure --help   gave  options including  the following
> >>> SHLIB_LD         command for linking shared libraries
> >>>                which contain object files  from a C or Fortran compiler
> >>> only SHLIB_LDFLAGS   special flags used by SHLIB_LD
> >>> SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD
> >>> SHLIB_FCD   command for linking shared libraries which contain object
> >>> files from the Fortran 95 compiler
> >>> SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD
> >>>
> >>>
> >>> I did not know what to set for these   and accepted whatever the
> >>> defaults were.  I ended up with shared-libraries which are  as 
> >>> follows:-
> >>>
> >>> $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib'
> >>> and the following shared-libraries  without the 'lib' prefix.
> >>>
> >>> $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
> >>> $R_HOME/library/cluster/libs/cluster.so
> >>> $R_HOME/library/foreign/libs/foreign.so
> >>> $R_HOME/library/grDevices/libs/grDevices.so
> >>> $R_HOME/library/grid/libs/grid.so
> >>> $R_HOME/library/KernSmooth/libs/KernSmooth.so
> >>> $R_HOME/library/lattice/libs/lattice.so
> >>> $R_HOME/library/MASS/libs/MASS.so
> >>> $R_HOME/library/Matrix/libs/Matrix.so
> >>> $R_HOME/library/methods/libs/methods.so
> >>> $R_HOME/library/mgcv/libs/mgcv.so
> >>> $R_HOME/library/nlme/libs/nlme.so
> >>> $R_HOME/library/nnet/libs/nnet.so
> >>> $R_HOME/library/rpart/libs/rpart.so
> >>> $R_HOME/library/spatial/libs/spatial.so
> >>> $R_HOME/library/splines/libs/splines.so
> >>> $R_HOME/library/stats/libs/stats.so
> >>> $R_HOME/library/survival/libs/survival.so
> >>> $R_HOME/library/tools/libs/tools.so
> >>>
> >>>
> >>> In linux builds   the linker usually looks for libs with the 'lib'
> >>> prefix. In this installation  all the libraries
> >>> ---in $R_HOME/modules
> >>> ---in $R_HOME/library/patha/to/whatevr
> >>>
> >>> do not have the   'lib' prefix.
> >>>
> >>> QUESTION:
> >>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
> >>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
> >>> result in  so libs with the 'lib' prefix?
> >>> B) If all of A) is negative what is there to be done to    to enable
> >>> generation   libraries in $R_HOME/modules $R_HOME/library/~  with the
> >>> 'lib' prefix?
> >>
> >> I forgot to add     my configure/make  options.  These were:-
> >> ########################
> >> export BUILD64="-m64"
> >> sh configure \
> >> CC="gcc $BUILD64" \
> >> CXX="g++ $BUILD64" \
> >> F77="gfortran  $BUILD64" \
> >> FC="gfortran  $BUILD64" \
> >> JAVA_HOME=$JAVA_HOME \
> >> LIBnn=lib64 \
> >> CPPFLAGS="-I$ATLAS_HOME/include -I/opt/acml4.4.0/gfortran64_mp/include 
> >> - I/opt/acml4.4.0/gfortran64/include -I/usr/local/numerics/include" \
> >> LDFLAGS="-L$ATLAS_HOME/lib  -L/opt/acml4.4.0/gfortran64_mp/lib -
> >> L/usr/local/numerics/lib -L/usr/lib" \
> >> --prefix=/opt/TEST/R-2.11.1 \
> >> --x-includes=$XORG_PREFIX/include \
> >> --x-libraries=$XORG_PREFIX/lib \
> >> --with-tcl-config=/usr/lib  \
> >> --with-tk-config=/usr/lib \
> >> --with-system-zlib=/usr  \
> >> --with-system-bzlib=/usr \
> >> --with-system-pcre=/usr  \
> >> --with-x  \
> >> --with-libpth-prefix=/usr \
> >> --with-libintl-prefix=/usr \
> >> --with-blas="-lpthread -latlas  -lfptf77blas" \
> >> --with-lapack="-llapack -lcblas" \
> >> --enable-R-shlib \
> >> --enable-BLAS-shlib
> >> ################
> >>
> >> The sources  compiled trouble-free.   with  'make'  as normal user.
> >> I then ran  'make install' as  super-user  and int installed in the
> >> prefix as set..
> >>
> >> A reply to the following questions would be much appreciateed:-
> >> QUESTION:
> >> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
> >> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
> >>  result in  so libs with the 'lib' prefix?
> >> B) If all of A) is negative what is there to be done to   enable
> >> generation  of  shared-libraries in $R_HOME/modules/ and
> >> $R_HOME/library/~ directories/sub-directories  with the 'lib'    prefix?
> >
> > thanks everyone for the help in clarifying what were share-libraries  and
> > otherwise.
> >
> > As stated above I used two switches
> > --enable-R-shlib \
> > --enable-BLAS-shlib
> > in the   configure options of the downloaded R-2.11.1 source  prior to
> > compilation.
> >
> > I am compiling  R-2.11.1   as  an optional dependency of kdeedu-4.4.5.   
> > This asks for R-shlib   )which I noticed it is disable by the default  in
> > the configure script.)
> >
> > After compile and install of R-2.11.1,  I am only able to start R from
> > the command  line
> 
> How are you starting it? The R start script does setup everything so that
>  you should never touch anything inside.
> 
> > when I   move the generated libRblas.so to libRblas.soDUFF and
> > symlink libacml.so    to libRblas.so  and update $R_HOME/etc/ldpaths
> > accordingly.  I am unable to start R  with the compiled-in 
> > $R_HOME/libR.so and  $R_HOME/libRblas.so.
> >
> > QUESTIONS:
> > A) How  does one  start R with the  the generated  libR.so and
> > libRblas.so?
> 
> bin/R
> 
> > B) is the generated  libR.so  interchangable with libRblas.so  (i.e. R
> > library without blas   enhanced algebra  capabilities?)
> 
> No - those are two entirely different libraries. The libRblas can be
>  interchanged with a suitably complete BLAS implementation, but please do
>  read the manuals for details.
> 
> Cheers,
> Simon
> 

Thanks to you for your help.  Following your guidance,  kdeedu-4.4.5  now 
builds successfully against R-2.11.1.   However when I    edit ~/etc/ldpaths 
with  the line

export LD_LIBRARY_PATH=path/to/acml/lib:$LD_LIBRARY_PATH

R fails to start.  it only starts when   the above point to $R_HOME/lib. (nb I 
have  a symbolic link of libacml.so  to libRblas.so
any ideas?


From mtmorgan at fhcrc.org  Tue Jul 13 00:31:46 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 12 Jul 2010 15:31:46 -0700
Subject: [Rd] Severe memory problem using split()
In-Reply-To: <4C3B906E.1030004@aon.at>
References: <4C3B7EF7.6080301@aon.at> <4C3B8CA0.9060508@fhcrc.org>
	<4C3B906E.1030004@aon.at>
Message-ID: <4C3B97D2.8060204@fhcrc.org>

On 07/12/2010 03:00 PM, cstrato wrote:
> Dear Martin,
> 
> Thank you, you are right, now I get:
> 
>> ann <- read.delim("Hu6800_ann.txt", stringsAsFactors=FALSE)
>> object.size(ann)
> 2035952 bytes
>> u2p  <- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
>> object.size(u2p)
> 1207368 bytes
>> object.size(unlist(u2p))
> 865176 bytes
> 
> Nevertheless, a size of 1.2MB for a list representing 2 of 11 columns of

but it's a list of length(unique(ann[["UNIT_ID"]]))) elements, each of
which has a pointer to the element, a pointer to the name of the
element, and the element data itself. I'd guess it adds up in a
non-mysterious way. For a sense of it (and maybe only understandable if
you have a working understanding of how R represents data) see, e.g.,

> .Internal(inspect(list(x=1,y=2)))
@1a4c538 19 VECSXP g0c2 [ATT] (len=2, tl=0)
  @191cad8 14 REALSXP g0c1 [] (len=1, tl=0) 1
  @191caa8 14 REALSXP g0c1 [] (len=1, tl=0) 2
ATTRIB:
  @16fc8d8 02 LISTSXP g0c0 []
    TAG: @60cf18 01 SYMSXP g0c0 [MARK,NAM(2),gp=0x4000] "names"
    @1a4c500 16 STRSXP g0c2 [] (len=2, tl=0)
      @674e88 09 CHARSXP g0c1 [MARK,gp=0x21] "x"
      @728c38 09 CHARSXP g0c1 [MARK,gp=0x21] "y"

Martin

> a table of size 754KB seems still to be pretty large?
> 
> Best regards
> Christian
> 
> 
> On 7/12/10 11:44 PM, Martin Morgan wrote:
>> On 07/12/2010 01:45 PM, cstrato wrote:
>>> Dear all,
>>>
>>> With great interest I followed the discussion:
>>> https://stat.ethz.ch/pipermail/r-devel/2010-July/057901.html
>>> since I have currently a similar problem:
>>>
>>> In a new R session (using xterm) I am importing a simple table
>>> "Hu6800_ann.txt" which has a size of 754KB only:
>>>
>>>> ann<- read.delim("Hu6800_ann.txt")
>>>> dim(ann)
>>> [1] 7129   11
>>>
>>>
>>> When I call "object.size(ann)" the estimated memory used to store "ann"
>>> is already 2MB:
>>>
>>>> object.size(ann)
>>> 2034784 bytes
>>>
>>>
>>> Now I call "split()" and check the estimated memory used which turns out
>>> to be 3.3GB:
>>>
>>>> u2p<- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
>>>> object.size(u2p)
>>> 3323768120 bytes
>>
>> I guess things improve with stringsAsFactors=FALSE in read.delim?
>>
>> Martin
>>
>>>
>>> During the R session I am running "top" in another xterm and can see
>>> that the memory usage of R increases to about 550MB RSIZE.
>>>
>>>
>>> Now I do:
>>>
>>>> object.size(unlist(u2p))
>>> 894056 bytes
>>>
>>> It takes about 3 minutes to complete this call and the memory usage of R
>>> increases to about 1.3GB RSIZE. Furthermore, during evaluation of this
>>> function the free RAM of my Mac decreases to less than 8MB free PhysMem,
>>> until it needs to swap memory. When finished, free PhysMem is 734MB but
>>> the size of R increased to 577MB RSIZE.
>>>
>>> Doing "split(ann[,"ProbesetID"],ann[,"UNIT_ID"],drop=TRUE)" did not
>>> change the object.size, only processing was faster and it did use less
>>> memory on my Mac.
>>>
>>> Do you have any idea what the reason for this behavior is?
>>> Why is the size of list "u2p" so large?
>>> Do I make any mistake?
>>>
>>>
>>> Here is my sessionInfo on a MacBook Pro with 2GB RAM:
>>>
>>>> sessionInfo()
>>> R version 2.11.1 (2010-05-31)
>>> x86_64-apple-darwin9.8.0
>>>
>>> locale:
>>> [1] C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> Best regards
>>> Christian
>>> _._._._._._._._._._._._._._._._._._
>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>> e.m.a.i.l:        cstrato at aon.at
>>> _._._._._._._._._._._._._._._._._._
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From simon.urbanek at r-project.org  Tue Jul 13 00:51:55 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 12 Jul 2010 18:51:55 -0400
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib'
	prefix//update
In-Reply-To: <201007122259.14529.lux-integ@btconnect.com>
References: <201007121029.30870.lux-integ@btconnect.com>
	<201007121950.55739.lux-integ@btconnect.com>
	<0B33AEC1-7E7C-42DC-A2CD-187A64DB8680@r-project.org>
	<201007122259.14529.lux-integ@btconnect.com>
Message-ID: <BD117118-7B3B-461D-96E5-AC979C36AD40@r-project.org>


On Jul 12, 2010, at 5:59 PM, lI wrote:

> On Monday 12 July 2010 20:52:15 Simon Urbanek wrote:
>> On Jul 12, 2010, at 2:50 PM, lI wrote:
>>> On Monday 12 July 2010 11:07:23 lI wrote:
>>>> On Monday 12 July 2010 10:29:30 lI wrote:
>>>>> Greetings,
>>>>> 
>>>>> I have a computer with the following setup:
>>>>> 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2
>>>>> 2)R-2.11.1
>>>>> 
>>>>> I compiled R with BLAS and lapack  using the switched  ( --with-blas="-
>>>>> lpthread -latlas  -lfptf77blas"
>>>>> --with-lapack="-llapack -lcblas"  ).
>>>>> (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra) )
>>>>> 
>>>>> Prior to compiling R-2.11.1
>>>>> sh conigure --help   gave  options including  the following
>>>>> SHLIB_LD         command for linking shared libraries
>>>>>               which contain object files  from a C or Fortran compiler
>>>>> only SHLIB_LDFLAGS   special flags used by SHLIB_LD
>>>>> SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD
>>>>> SHLIB_FCD   command for linking shared libraries which contain object
>>>>> files from the Fortran 95 compiler
>>>>> SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD
>>>>> 
>>>>> 
>>>>> I did not know what to set for these   and accepted whatever the
>>>>> defaults were.  I ended up with shared-libraries which are  as 
>>>>> follows:-
>>>>> 
>>>>> $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix 'lib'
>>>>> and the following shared-libraries  without the 'lib' prefix.
>>>>> 
>>>>> $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
>>>>> $R_HOME/library/cluster/libs/cluster.so
>>>>> $R_HOME/library/foreign/libs/foreign.so
>>>>> $R_HOME/library/grDevices/libs/grDevices.so
>>>>> $R_HOME/library/grid/libs/grid.so
>>>>> $R_HOME/library/KernSmooth/libs/KernSmooth.so
>>>>> $R_HOME/library/lattice/libs/lattice.so
>>>>> $R_HOME/library/MASS/libs/MASS.so
>>>>> $R_HOME/library/Matrix/libs/Matrix.so
>>>>> $R_HOME/library/methods/libs/methods.so
>>>>> $R_HOME/library/mgcv/libs/mgcv.so
>>>>> $R_HOME/library/nlme/libs/nlme.so
>>>>> $R_HOME/library/nnet/libs/nnet.so
>>>>> $R_HOME/library/rpart/libs/rpart.so
>>>>> $R_HOME/library/spatial/libs/spatial.so
>>>>> $R_HOME/library/splines/libs/splines.so
>>>>> $R_HOME/library/stats/libs/stats.so
>>>>> $R_HOME/library/survival/libs/survival.so
>>>>> $R_HOME/library/tools/libs/tools.so
>>>>> 
>>>>> 
>>>>> In linux builds   the linker usually looks for libs with the 'lib'
>>>>> prefix. In this installation  all the libraries
>>>>> ---in $R_HOME/modules
>>>>> ---in $R_HOME/library/patha/to/whatevr
>>>>> 
>>>>> do not have the   'lib' prefix.
>>>>> 
>>>>> QUESTION:
>>>>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
>>>>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
>>>>> result in  so libs with the 'lib' prefix?
>>>>> B) If all of A) is negative what is there to be done to    to enable
>>>>> generation   libraries in $R_HOME/modules $R_HOME/library/~  with the
>>>>> 'lib' prefix?
>>>> 
>>>> I forgot to add     my configure/make  options.  These were:-
>>>> ########################
>>>> export BUILD64="-m64"
>>>> sh configure \
>>>> CC="gcc $BUILD64" \
>>>> CXX="g++ $BUILD64" \
>>>> F77="gfortran  $BUILD64" \
>>>> FC="gfortran  $BUILD64" \
>>>> JAVA_HOME=$JAVA_HOME \
>>>> LIBnn=lib64 \
>>>> CPPFLAGS="-I$ATLAS_HOME/include -I/opt/acml4.4.0/gfortran64_mp/include 
>>>> - I/opt/acml4.4.0/gfortran64/include -I/usr/local/numerics/include" \
>>>> LDFLAGS="-L$ATLAS_HOME/lib  -L/opt/acml4.4.0/gfortran64_mp/lib -
>>>> L/usr/local/numerics/lib -L/usr/lib" \
>>>> --prefix=/opt/TEST/R-2.11.1 \
>>>> --x-includes=$XORG_PREFIX/include \
>>>> --x-libraries=$XORG_PREFIX/lib \
>>>> --with-tcl-config=/usr/lib  \
>>>> --with-tk-config=/usr/lib \
>>>> --with-system-zlib=/usr  \
>>>> --with-system-bzlib=/usr \
>>>> --with-system-pcre=/usr  \
>>>> --with-x  \
>>>> --with-libpth-prefix=/usr \
>>>> --with-libintl-prefix=/usr \
>>>> --with-blas="-lpthread -latlas  -lfptf77blas" \
>>>> --with-lapack="-llapack -lcblas" \
>>>> --enable-R-shlib \
>>>> --enable-BLAS-shlib
>>>> ################
>>>> 
>>>> The sources  compiled trouble-free.   with  'make'  as normal user.
>>>> I then ran  'make install' as  super-user  and int installed in the
>>>> prefix as set..
>>>> 
>>>> A reply to the following questions would be much appreciateed:-
>>>> QUESTION:
>>>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
>>>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
>>>> result in  so libs with the 'lib' prefix?
>>>> B) If all of A) is negative what is there to be done to   enable
>>>> generation  of  shared-libraries in $R_HOME/modules/ and
>>>> $R_HOME/library/~ directories/sub-directories  with the 'lib'    prefix?
>>> 
>>> thanks everyone for the help in clarifying what were share-libraries  and
>>> otherwise.
>>> 
>>> As stated above I used two switches
>>> --enable-R-shlib \
>>> --enable-BLAS-shlib
>>> in the   configure options of the downloaded R-2.11.1 source  prior to
>>> compilation.
>>> 
>>> I am compiling  R-2.11.1   as  an optional dependency of kdeedu-4.4.5.   
>>> This asks for R-shlib   )which I noticed it is disable by the default  in
>>> the configure script.)
>>> 
>>> After compile and install of R-2.11.1,  I am only able to start R from
>>> the command  line
>> 
>> How are you starting it? The R start script does setup everything so that
>> you should never touch anything inside.
>> 
>>> when I   move the generated libRblas.so to libRblas.soDUFF and
>>> symlink libacml.so    to libRblas.so  and update $R_HOME/etc/ldpaths
>>> accordingly.  I am unable to start R  with the compiled-in 
>>> $R_HOME/libR.so and  $R_HOME/libRblas.so.
>>> 
>>> QUESTIONS:
>>> A) How  does one  start R with the  the generated  libR.so and
>>> libRblas.so?
>> 
>> bin/R
>> 
>>> B) is the generated  libR.so  interchangable with libRblas.so  (i.e. R
>>> library without blas   enhanced algebra  capabilities?)
>> 
>> No - those are two entirely different libraries. The libRblas can be
>> interchanged with a suitably complete BLAS implementation, but please do
>> read the manuals for details.
>> 
>> Cheers,
>> Simon
>> 
> 
> Thanks to you for your help.  Following your guidance,  kdeedu-4.4.5  now 
> builds successfully against R-2.11.1.   However when I    edit ~/etc/ldpaths 
> with  the line
> 
> export LD_LIBRARY_PATH=path/to/acml/lib:$LD_LIBRARY_PATH
> 
> R fails to start.

Of course as you should expect. Why would you edit? It has nothing to do with BLAS ...

Also did you read the manual? It explicitly covers your case ... 

Cheers,
Simon


>  it only starts when   the above point to $R_HOME/lib. (nb I 
> have  a symbolic link of libacml.so  to libRblas.so
> any ideas?
> 
> 


From lux-integ at btconnect.com  Tue Jul 13 02:28:15 2010
From: lux-integ at btconnect.com (lI)
Date: Tue, 13 Jul 2010 01:28:15 +0100
Subject: [Rd] R-2.11.1 build and 'so' libraries withouth the 'lib'
	prefix//update
In-Reply-To: <BD117118-7B3B-461D-96E5-AC979C36AD40@r-project.org>
References: <201007121029.30870.lux-integ@btconnect.com>
	<201007122259.14529.lux-integ@btconnect.com>
	<BD117118-7B3B-461D-96E5-AC979C36AD40@r-project.org>
Message-ID: <201007130128.15372.lux-integ@btconnect.com>

On Monday 12 July 2010 23:51:55 Simon Urbanek wrote:
> On Jul 12, 2010, at 5:59 PM, lI wrote:
> > On Monday 12 July 2010 20:52:15 Simon Urbanek wrote:
> >> On Jul 12, 2010, at 2:50 PM, lI wrote:
> >>> On Monday 12 July 2010 11:07:23 lI wrote:
> >>>> On Monday 12 July 2010 10:29:30 lI wrote:
> >>>>> Greetings,
> >>>>>
> >>>>> I have a computer with the following setup:
> >>>>> 1)cblfs (pure 64-bit (amd64) linux), kernel2.6.34 gcc4.4.2
> >>>>> 2)R-2.11.1
> >>>>>
> >>>>> I compiled R with BLAS and lapack  using the switched  (
> >>>>> --with-blas="- lpthread -latlas  -lfptf77blas"
> >>>>> --with-lapack="-llapack -lcblas"  ).
> >>>>> (( http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra)
> >>>>> )
> >>>>>
> >>>>> Prior to compiling R-2.11.1
> >>>>> sh conigure --help   gave  options including  the following
> >>>>> SHLIB_LD         command for linking shared libraries
> >>>>>               which contain object files  from a C or Fortran
> >>>>> compiler only SHLIB_LDFLAGS   special flags used by SHLIB_LD
> >>>>> SHLIB_CXXLDFLAGS   special flags used by SHLIB_CXXLD
> >>>>> SHLIB_FCD   command for linking shared libraries which contain object
> >>>>> files from the Fortran 95 compiler
> >>>>> SHLIB_FCLDFLAGS  special flags used by SHLIB_FCLD
> >>>>>
> >>>>>
> >>>>> I did not know what to set for these   and accepted whatever the
> >>>>> defaults were.  I ended up with shared-libraries which are  as
> >>>>> follows:-
> >>>>>
> >>>>> $R_HOME/lib/{libRblas.so,libRlapack.so  }  i.e. with   the prefix
> >>>>> 'lib' and the following shared-libraries  without the 'lib' prefix.
> >>>>>
> >>>>> $R_HOME/modules/{R_X11.so,internet.so,lapack.so,vfonts.so }
> >>>>> $R_HOME/library/cluster/libs/cluster.so
> >>>>> $R_HOME/library/foreign/libs/foreign.so
> >>>>> $R_HOME/library/grDevices/libs/grDevices.so
> >>>>> $R_HOME/library/grid/libs/grid.so
> >>>>> $R_HOME/library/KernSmooth/libs/KernSmooth.so
> >>>>> $R_HOME/library/lattice/libs/lattice.so
> >>>>> $R_HOME/library/MASS/libs/MASS.so
> >>>>> $R_HOME/library/Matrix/libs/Matrix.so
> >>>>> $R_HOME/library/methods/libs/methods.so
> >>>>> $R_HOME/library/mgcv/libs/mgcv.so
> >>>>> $R_HOME/library/nlme/libs/nlme.so
> >>>>> $R_HOME/library/nnet/libs/nnet.so
> >>>>> $R_HOME/library/rpart/libs/rpart.so
> >>>>> $R_HOME/library/spatial/libs/spatial.so
> >>>>> $R_HOME/library/splines/libs/splines.so
> >>>>> $R_HOME/library/stats/libs/stats.so
> >>>>> $R_HOME/library/survival/libs/survival.so
> >>>>> $R_HOME/library/tools/libs/tools.so
> >>>>>
> >>>>>
> >>>>> In linux builds   the linker usually looks for libs with the 'lib'
> >>>>> prefix. In this installation  all the libraries
> >>>>> ---in $R_HOME/modules
> >>>>> ---in $R_HOME/library/patha/to/whatevr
> >>>>>
> >>>>> do not have the   'lib' prefix.
> >>>>>
> >>>>> QUESTION:
> >>>>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
> >>>>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
> >>>>> result in  so libs with the 'lib' prefix?
> >>>>> B) If all of A) is negative what is there to be done to    to enable
> >>>>> generation   libraries in $R_HOME/modules $R_HOME/library/~  with the
> >>>>> 'lib' prefix?
> >>>>
> >>>> I forgot to add     my configure/make  options.  These were:-
> >>>> ########################
> >>>> export BUILD64="-m64"
> >>>> sh configure \
> >>>> CC="gcc $BUILD64" \
> >>>> CXX="g++ $BUILD64" \
> >>>> F77="gfortran  $BUILD64" \
> >>>> FC="gfortran  $BUILD64" \
> >>>> JAVA_HOME=$JAVA_HOME \
> >>>> LIBnn=lib64 \
> >>>> CPPFLAGS="-I$ATLAS_HOME/include -I/opt/acml4.4.0/gfortran64_mp/include
> >>>> - I/opt/acml4.4.0/gfortran64/include -I/usr/local/numerics/include" \
> >>>> LDFLAGS="-L$ATLAS_HOME/lib  -L/opt/acml4.4.0/gfortran64_mp/lib -
> >>>> L/usr/local/numerics/lib -L/usr/lib" \
> >>>> --prefix=/opt/TEST/R-2.11.1 \
> >>>> --x-includes=$XORG_PREFIX/include \
> >>>> --x-libraries=$XORG_PREFIX/lib \
> >>>> --with-tcl-config=/usr/lib  \
> >>>> --with-tk-config=/usr/lib \
> >>>> --with-system-zlib=/usr  \
> >>>> --with-system-bzlib=/usr \
> >>>> --with-system-pcre=/usr  \
> >>>> --with-x  \
> >>>> --with-libpth-prefix=/usr \
> >>>> --with-libintl-prefix=/usr \
> >>>> --with-blas="-lpthread -latlas  -lfptf77blas" \
> >>>> --with-lapack="-llapack -lcblas" \
> >>>> --enable-R-shlib \
> >>>> --enable-BLAS-shlib
> >>>> ################
> >>>>
> >>>> The sources  compiled trouble-free.   with  'make'  as normal user.
> >>>> I then ran  'make install' as  super-user  and int installed in the
> >>>> prefix as set..
> >>>>
> >>>> A reply to the following questions would be much appreciateed:-
> >>>> QUESTION:
> >>>> A) does any on list know   SHLIB_LD   SHLIB_LDFLAGS  SHLIB_CXXLDFLAGS
> >>>> SHLIB_FCD   SHLIB_FCLDFLAGS    settings for compiling R  and do these
> >>>> result in  so libs with the 'lib' prefix?
> >>>> B) If all of A) is negative what is there to be done to   enable
> >>>> generation  of  shared-libraries in $R_HOME/modules/ and
> >>>> $R_HOME/library/~ directories/sub-directories  with the 'lib'   
> >>>> prefix?
> >>>
> >>> thanks everyone for the help in clarifying what were share-libraries 
> >>> and otherwise.
> >>>
> >>> As stated above I used two switches
> >>> --enable-R-shlib \
> >>> --enable-BLAS-shlib
> >>> in the   configure options of the downloaded R-2.11.1 source  prior to
> >>> compilation.
> >>>
> >>> I am compiling  R-2.11.1   as  an optional dependency of kdeedu-4.4.5.
> >>> This asks for R-shlib   )which I noticed it is disable by the default 
> >>> in the configure script.)
> >>>
> >>> After compile and install of R-2.11.1,  I am only able to start R from
> >>> the command  line
> >>
> >> How are you starting it? The R start script does setup everything so
> >> that you should never touch anything inside.
> >>
> >>> when I   move the generated libRblas.so to libRblas.soDUFF and
> >>> symlink libacml.so    to libRblas.so  and update $R_HOME/etc/ldpaths
> >>> accordingly.  I am unable to start R  with the compiled-in
> >>> $R_HOME/libR.so and  $R_HOME/libRblas.so.
> >>>
> >>> QUESTIONS:
> >>> A) How  does one  start R with the  the generated  libR.so and
> >>> libRblas.so?
> >>
> >> bin/R
> >>
> >>> B) is the generated  libR.so  interchangable with libRblas.so  (i.e. R
> >>> library without blas   enhanced algebra  capabilities?)
> >>
> >> No - those are two entirely different libraries. The libRblas can be
> >> interchanged with a suitably complete BLAS implementation, but please do
> >> read the manuals for details.
> >>
> >> Cheers,
> >> Simon
> >
> > Thanks to you for your help.  Following your guidance,  kdeedu-4.4.5  now
> > builds successfully against R-2.11.1.   However when I    edit
> > ~/etc/ldpaths with  the line
> >
> > export LD_LIBRARY_PATH=path/to/acml/lib:$LD_LIBRARY_PATH
> >
> > R fails to start.
> 
> Of course as you should expect. Why would you edit? It has nothing to do
>  with BLAS ...
I hope I  did mention there was a symbolic link of libRblas.so  to  libacml.so
 (as recommended by the manual)
> Also did you read the manual? It explicitly covers your case ...
yes I did  here
http://cran.r-project.org/doc/manuals/R-admin.html#Linear-algebra)
> Cheers,
> Simon
> 
> >  it only starts when   the above point to $R_HOME/lib. (nb I
> > have  a symbolic link of libacml.so  to libRblas.so
> > any ideas?
>


From thomas.baier at logicals.com  Tue Jul 13 11:51:44 2010
From: thomas.baier at logicals.com (Thomas Baier)
Date: Tue, 13 Jul 2010 11:51:44 +0200
Subject: [Rd] Telling Windows how to find DLL's from R?
Message-ID: <E058F0C11D63DF11B559000C29F5CF530B85BA@exchange-server.ow.ks>

Dominick,

Dominick Samperi wrote:
> On Fri, Jul 9, 2010 at 3:48 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com>wrote: 
> 
>> On 09/07/2010 2:38 PM, Dominick Samperi wrote:
>> 
>>> Is it possible to set Windows' search path from within R, or to tell 
>>> Windows how to find a DLL in some other way from R? Specifically, if 
>>> a package DLL depends on another DLL the normal requirement is that 
>>> the second DLL be in the search path so Windows can find it (there 
>>> are other tricks, but they apply at the Windows level, not at the R 
>>> level).
>>> 
>>> 
>> 
>> 
>> I haven't tried this, but can't you use Sys.setenv() to change the 
>> PATH to what you want?  Presumably you'll want to change it back 
>> afterwards.
>> 
> 
> Thanks, good suggestion, but it does not seem to work. If PATH is 
> updated in this way the change is local to the current process, not to 
> the top-level Windows process, so a subsequent
> dyn.load('foo.dll') will fail if foo.dll depends on bar.dll, unless 
> bar.dll is placed in the search path for the top-level shell. Seems 
> like this needs to be done as part of system startup outside of R.
> 
> On the other hand, if foo.dll is the package library for package foo, 
> and if foo depends on package bar, then there is no need to place 
> bar.dll in the top-level search path. R takes care of this (more
> typical) situation.   

there is another Windows "feature" which will do the trick for you without
modifying the search path. Windows normally only loads DLLs once, so this
means if you first load the dependent DLL (manually, e.g. using dyn.load())
then the already loaded DLL will be used instead of trying to load one from
path.

E.g. in your example:

	dyn.load("mypath/bar.dll")
	dyn.load("foo.dll")

will work, as bar.dll (a dependency of foo.dll) is already loaded.

Thomas


From steve at squaregoldfish.co.uk  Tue Jul 13 14:05:22 2010
From: steve at squaregoldfish.co.uk (Steve Jones)
Date: Tue, 13 Jul 2010 13:05:22 +0100
Subject: [Rd] Bug in acf function?
Message-ID: <4C3C5682.7020900@squaregoldfish.co.uk>

I'm using R-2.9.1, so forgive me if this has already been resolved.

One element of the object returned from the acf function is n.used,
described in the man page as "The number of observations in the time
series".

However, I've noticed that this value is set to nrow(x) via the sampleT
variable, i.e. the number of rows in the passed-in series. This forces
an assumption that all rows of the series contain values.

Since it's possible to calculate an acf from an incomplete series by
passing 'na.action=na.pass', I would suggest that the value of n.used in
this instance should be set to 'sum(!is.na(series))'.

This has knock-on effects too: the plot produced by the acf function
includes a horizontal line showing the threshold of statistical
significance, which is dependent on the number of measurements in the
series:

qnorm((1 + 0.95)/2)/sqrt(corr$n.used)

For a given set of time series of fixed length, the threshold is
therefore constant regardless of the number of valid measurements in the
series, which I believe to be incorrect.

As a side note, I also think that this significance threshold should be
returned as part of the output of the acf function - as it stands, the
value is shown in a plot but there's no way to actually get the value.

Steve.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100713/ee2384d7/attachment.bin>

From jmc at r-project.org  Tue Jul 13 14:57:25 2010
From: jmc at r-project.org (John Chambers)
Date: Tue, 13 Jul 2010 05:57:25 -0700
Subject: [Rd] S4 class extends "data.frame", getDataPart sees "list"
In-Reply-To: <AANLkTikacvePDIi3H2ubxxjjIIvJKT7E7xSH373NCvpE@mail.gmail.com>
References: <AANLkTikacvePDIi3H2ubxxjjIIvJKT7E7xSH373NCvpE@mail.gmail.com>
Message-ID: <4C3C62B5.70807@r-project.org>

On 7/11/10 9:08 PM, Daniel Murphy wrote:
> R-Devel:
>
> When I get the data part of an S4 class that contains="data.frame", it gives
> me a list, even when the "data.frame" is the S4 version:
>
>> d<-data.frame(x=1:3)
>> isS4(d)
> [1] FALSE                           # of course
>> dS4<-new("data.frame",d)
>> isS4(dS4)
> [1] TRUE                            # ok
>> class(dS4)
> [1] "data.frame"                   # good
> attr(,"package")
> [1] "methods"
>> setClass("A", representation(label="character"), contains="data.frame")
> [1] "A"
>> a<-new("A",dS4, label="myFrame")
>> getDataPart(a)
> [[1]]                                  # oh?
> [1] 1 2 3
>
>> class(a at .Data)
> [1] "list"                           # hmm
>> names(a)
> [1] "x"                             # sure, that makes sense
>> a
> Object of class "A"
>    x
> 1 1
> 2 2
> 3 3
> Slot "label":
> [1] "myFrame"
>
>
> Was I wrong to have expected the "data part" of 'a' to be a "data.frame"?

Yes.  Also, there is a clue in the documentation for getDataPart: 
"rarely suitable to be called directly"
The data part, aka "data slot", generally does not have a class (S4 or S3).

You are probably looking for S3Part():

 > setClass("myFrame", contains = "data.frame")
[1] "myFrame"
 > z = new("myFrame", data.frame(x=1:3))
 > z
Object of class "myFrame"
   x
1 1
2 2
3 3
 > S3Part(z)
Object of class "data.frame"
   x
1 1
2 2
3 3
 > S3Part(z, strictS3 = TRUE)
   x
1 1
2 2
3 3



>
> Thanks.
>
> Dan Murphy
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From chiefmurphy at gmail.com  Tue Jul 13 17:43:06 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Tue, 13 Jul 2010 08:43:06 -0700
Subject: [Rd] S4 class extends "data.frame", getDataPart sees "list"
In-Reply-To: <4C3C62B5.70807@r-project.org>
References: <AANLkTikacvePDIi3H2ubxxjjIIvJKT7E7xSH373NCvpE@mail.gmail.com>
	<4C3C62B5.70807@r-project.org>
Message-ID: <AANLkTikSmFgnPFzsqeaYaqYftZlr-CLl-st3HFyZu7ED@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100713/e7974439/attachment.pl>

From jmc at r-project.org  Tue Jul 13 18:11:21 2010
From: jmc at r-project.org (John Chambers)
Date: Tue, 13 Jul 2010 09:11:21 -0700
Subject: [Rd] S4 class extends "data.frame", getDataPart sees "list"
In-Reply-To: <AANLkTikSmFgnPFzsqeaYaqYftZlr-CLl-st3HFyZu7ED@mail.gmail.com>
References: <AANLkTikacvePDIi3H2ubxxjjIIvJKT7E7xSH373NCvpE@mail.gmail.com>	<4C3C62B5.70807@r-project.org>
	<AANLkTikSmFgnPFzsqeaYaqYftZlr-CLl-st3HFyZu7ED@mail.gmail.com>
Message-ID: <4C3C9029.7020805@r-project.org>


On 7/13/10 8:43 AM, Daniel Murphy wrote:
> Thank you. For "getDataPart" I was following (my interpretation of)
> advice from the documentation for "Classes": The functions |getDataPart
> <http://127.0.0.1:15455/library/methods/help/getDataPart>| and
> |setDataPart <http://127.0.0.1:15455/library/methods/help/setDataPart>|
> are a cleaner, but essentially equivalent way to deal with the data part.
> I interpreted "cleaner" to mean "preferred." From your reply, John, it
> sounds like I should go back to the object at .Data construct.

No, that's not the distinction.  Preferred for what, is the question. In 
order for a class to extend a basic type, it has to have that type. 
Then the .Data "slot" is a sort of fiction needed for the metadata.
(Because of some "features" of R implementation, it's not quite that 
simple.  Matrices act like a basic type, and some types, such as 
"environment" require a second kludge.)


If you really want that slot, the advice holds, but only because there 
is no actual ".Data" slot (i.e., attribute).

But you weren't talking about that at all.  In fact (just to contradict 
my previous mail) you probably wanted to turn your object into a 
data.frame.  If so, best to say so:

 > as(z, "data.frame")
Object of class "data.frame"
   x
1 1
2 2
3 3

and, for that matter:

 > as(z, "list")
[[1]]
[1] 1 2 3

> -Dan
> On Tue, Jul 13, 2010 at 5:57 AM, John Chambers <jmc at r-project.org
> <mailto:jmc at r-project.org>> wrote:
>
>     On 7/11/10 9:08 PM, Daniel Murphy wrote:
>
>         R-Devel:
>
>         When I get the data part of an S4 class that
>         contains="data.frame", it gives
>         me a list, even when the "data.frame" is the S4 version:
>
>             d<-data.frame(x=1:3)
>             isS4(d)
>
>         [1] FALSE                           # of course
>
>             dS4<-new("data.frame",d)
>             isS4(dS4)
>
>         [1] TRUE                            # ok
>
>             class(dS4)
>
>         [1] "data.frame"                   # good
>         attr(,"package")
>         [1] "methods"
>
>             setClass("A", representation(label="character"),
>             contains="data.frame")
>
>         [1] "A"
>
>             a<-new("A",dS4, label="myFrame")
>             getDataPart(a)
>
>         [[1]]                                  # oh?
>         [1] 1 2 3
>
>             class(a at .Data)
>
>         [1] "list"                           # hmm
>
>             names(a)
>
>         [1] "x"                             # sure, that makes sense
>
>             a
>
>         Object of class "A"
>            x
>         1 1
>         2 2
>         3 3
>         Slot "label":
>         [1] "myFrame"
>
>
>         Was I wrong to have expected the "data part" of 'a' to be a
>         "data.frame"?
>
>
>     Yes.  Also, there is a clue in the documentation for getDataPart:
>     "rarely suitable to be called directly"
>     The data part, aka "data slot", generally does not have a class (S4
>     or S3).
>
>     You are probably looking for S3Part():
>
>      > setClass("myFrame", contains = "data.frame")
>     [1] "myFrame"
>      > z = new("myFrame", data.frame(x=1:3))
>      > z
>     Object of class "myFrame"
>
>       x
>     1 1
>     2 2
>     3 3
>      > S3Part(z)
>     Object of class "data.frame"
>
>       x
>     1 1
>     2 2
>     3 3
>      > S3Part(z, strictS3 = TRUE)
>
>       x
>     1 1
>     2 2
>     3 3
>
>
>
>
>         Thanks.
>
>         Dan Murphy
>
>                 [[alternative HTML version deleted]]
>
>         ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From chiefmurphy at gmail.com  Tue Jul 13 20:42:18 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Tue, 13 Jul 2010 11:42:18 -0700
Subject: [Rd] S4 class extends "data.frame", getDataPart sees "list"
In-Reply-To: <4C3C9029.7020805@r-project.org>
References: <AANLkTikacvePDIi3H2ubxxjjIIvJKT7E7xSH373NCvpE@mail.gmail.com>
	<4C3C62B5.70807@r-project.org>
	<AANLkTikSmFgnPFzsqeaYaqYftZlr-CLl-st3HFyZu7ED@mail.gmail.com>
	<4C3C9029.7020805@r-project.org>
Message-ID: <AANLkTimy6ZqfnMfOydn38H4aSeSX0WNj738I-_G_MvNJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100713/cd3f15d7/attachment.pl>

From cstrato at aon.at  Tue Jul 13 21:05:27 2010
From: cstrato at aon.at (cstrato)
Date: Tue, 13 Jul 2010 21:05:27 +0200
Subject: [Rd] Severe memory problem using split()
In-Reply-To: <4C3B97D2.8060204@fhcrc.org>
References: <4C3B7EF7.6080301@aon.at> <4C3B8CA0.9060508@fhcrc.org>
	<4C3B906E.1030004@aon.at> <4C3B97D2.8060204@fhcrc.org>
Message-ID: <4C3CB8F7.6020408@aon.at>

Dear Martin,

Thank you for this explanation.

Best regards
Christian


On 7/13/10 12:31 AM, Martin Morgan wrote:
> On 07/12/2010 03:00 PM, cstrato wrote:
>> Dear Martin,
>>
>> Thank you, you are right, now I get:
>>
>>> ann<- read.delim("Hu6800_ann.txt", stringsAsFactors=FALSE)
>>> object.size(ann)
>> 2035952 bytes
>>> u2p<- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
>>> object.size(u2p)
>> 1207368 bytes
>>> object.size(unlist(u2p))
>> 865176 bytes
>>
>> Nevertheless, a size of 1.2MB for a list representing 2 of 11 columns of
>
> but it's a list of length(unique(ann[["UNIT_ID"]]))) elements, each of
> which has a pointer to the element, a pointer to the name of the
> element, and the element data itself. I'd guess it adds up in a
> non-mysterious way. For a sense of it (and maybe only understandable if
> you have a working understanding of how R represents data) see, e.g.,
>
>> .Internal(inspect(list(x=1,y=2)))
> @1a4c538 19 VECSXP g0c2 [ATT] (len=2, tl=0)
>    @191cad8 14 REALSXP g0c1 [] (len=1, tl=0) 1
>    @191caa8 14 REALSXP g0c1 [] (len=1, tl=0) 2
> ATTRIB:
>    @16fc8d8 02 LISTSXP g0c0 []
>      TAG: @60cf18 01 SYMSXP g0c0 [MARK,NAM(2),gp=0x4000] "names"
>      @1a4c500 16 STRSXP g0c2 [] (len=2, tl=0)
>        @674e88 09 CHARSXP g0c1 [MARK,gp=0x21] "x"
>        @728c38 09 CHARSXP g0c1 [MARK,gp=0x21] "y"
>
> Martin
>
>> a table of size 754KB seems still to be pretty large?
>>
>> Best regards
>> Christian
>>
>>
>> On 7/12/10 11:44 PM, Martin Morgan wrote:
>>> On 07/12/2010 01:45 PM, cstrato wrote:
>>>> Dear all,
>>>>
>>>> With great interest I followed the discussion:
>>>> https://stat.ethz.ch/pipermail/r-devel/2010-July/057901.html
>>>> since I have currently a similar problem:
>>>>
>>>> In a new R session (using xterm) I am importing a simple table
>>>> "Hu6800_ann.txt" which has a size of 754KB only:
>>>>
>>>>> ann<- read.delim("Hu6800_ann.txt")
>>>>> dim(ann)
>>>> [1] 7129   11
>>>>
>>>>
>>>> When I call "object.size(ann)" the estimated memory used to store "ann"
>>>> is already 2MB:
>>>>
>>>>> object.size(ann)
>>>> 2034784 bytes
>>>>
>>>>
>>>> Now I call "split()" and check the estimated memory used which turns out
>>>> to be 3.3GB:
>>>>
>>>>> u2p<- split(ann[,"ProbesetID"],ann[,"UNIT_ID"])
>>>>> object.size(u2p)
>>>> 3323768120 bytes
>>>
>>> I guess things improve with stringsAsFactors=FALSE in read.delim?
>>>
>>> Martin
>>>
>>>>
>>>> During the R session I am running "top" in another xterm and can see
>>>> that the memory usage of R increases to about 550MB RSIZE.
>>>>
>>>>
>>>> Now I do:
>>>>
>>>>> object.size(unlist(u2p))
>>>> 894056 bytes
>>>>
>>>> It takes about 3 minutes to complete this call and the memory usage of R
>>>> increases to about 1.3GB RSIZE. Furthermore, during evaluation of this
>>>> function the free RAM of my Mac decreases to less than 8MB free PhysMem,
>>>> until it needs to swap memory. When finished, free PhysMem is 734MB but
>>>> the size of R increased to 577MB RSIZE.
>>>>
>>>> Doing "split(ann[,"ProbesetID"],ann[,"UNIT_ID"],drop=TRUE)" did not
>>>> change the object.size, only processing was faster and it did use less
>>>> memory on my Mac.
>>>>
>>>> Do you have any idea what the reason for this behavior is?
>>>> Why is the size of list "u2p" so large?
>>>> Do I make any mistake?
>>>>
>>>>
>>>> Here is my sessionInfo on a MacBook Pro with 2GB RAM:
>>>>
>>>>> sessionInfo()
>>>> R version 2.11.1 (2010-05-31)
>>>> x86_64-apple-darwin9.8.0
>>>>
>>>> locale:
>>>> [1] C
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>> Best regards
>>>> Christian
>>>> _._._._._._._._._._._._._._._._._._
>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>> e.m.a.i.l:        cstrato at aon.at
>>>> _._._._._._._._._._._._._._._._._._
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>
>


From jfox at mcmaster.ca  Tue Jul 13 23:02:57 2010
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 13 Jul 2010 17:02:57 -0400
Subject: [Rd] Building a custom Windows installer
Message-ID: <006601cb22ce$c583fd00$508bf700$@ca>

Dear r-devel list members,

It's been several years since I last built a custom Windows installer for R,
and despite my notes and the instructions in Sections 3.1.7 and D.4 of the R
Installation and Administration Manual, I've run into a problem, receiving
the following error message:

----------- snip -----------

C:\R\src\R-2.11.1\src\gnuwin32\installer>make myR IMAGEDIR=c:/temp/R-2.11.1
MDISDI=1
Makefile:3: ../MkRules: No such file or directory
make: ../fixed/rwver.pl: Command not found
make: ../fixed/rwver.pl: Command not found
make: ../fixed/rwver.pl: Command not found
make: ../fixed/rwver.pl: Command not found
make: *** No rule to make target `../MkRules'.  Stop.

----------- snip -----------

My path looks like this:

----------- snip -----------

C:\R\src\R-2.11.1\src\gnuwin32\installer>set path
Path=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\Program
Files\Commo
n Files\Microsoft Shared\Windows Live;C:\GTK\bin;C:\Program
Files\Insightful\spl
us80\;C:\Program Files\ActiveState Komodo Edit
4\;.;c:\R\R-2.11.1\bin;C:\progra~
1\miktex~1.7\miktex\bin;c:\progra~1\htmlhe~1;C:\Windows\system32;C:\Windows;
C:\W
indows\System32\Wbem;C:\Program Files\Common Files\Roxio
Shared\DLLShared\;C:\Pr
ogram Files\GnuWin32\bin;C:\Program Files\CollabNet Subversion;C:\Program
Files\
MySQL\MySQL Server 5.1\bin;C:\Program Files\SAS\Shared
Files\Formats;C:\Program
Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
Fil
es\Smart Projects\IsoBuster;C:\Program Files\MiKTeX
2.7\miktex\bin\;C:\Program F
iles\QuickTime\QTSystem\;C:\Program Files\Common Files\Microsoft
Shared\Windows
Live;C:\Program Files\SSH Communications Security\SSH Secure
Shell;C:\Program Fi
les\Bibtex2html;C:\Graphviz2.20\bin
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC

----------- snip -----------

The directory c:/temp/R-2.11.1 contains a complete customized installation
of R, while C:\R\src\R-2.11.1 contains the unpacked R sources. This is on a
Windows Vista system. I've updated Rtools to version 2.11.  I can supply
more information, but I'm not sure what's relevant. 

I don't think that I should have to place a MkRules file in the gnuwin32
directory, but I tried copying each the MkRules.dist and MkRules.rules files
there in turn to MkRules. Neither worked; I apparently got farther copying
MkRules.rules to MkRules, but eventually got another error:

----------- snip -----------

C:\R\src\R-2.11.1\src\gnuwin32\installer>make myR IMAGEDIR=c:/temp/R-2.11.1
MDISDI=1
echo "make.packages.html(.Library)" | c:/temp/R-2.11.1/bin/rterm --vanilla
--sla
ve LC_COLLATE=C
Making packages.html ... done
adding MD5 checksums
perl JRins.pl R-2.11.1 c:/temp/R-2.11.1 1 1 0 R-core
"/iscc" R.iss > myR.log
/iscc: not found
make: *** [myR] Error 127 

----------- snip -----------

Any help would be appreciated.

John

--------------------------------
John Fox
Senator William McMaster 
  Professor of Social Statistics
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
web: socserv.mcmaster.ca/jfox


From hb at stat.berkeley.edu  Wed Jul 14 07:53:18 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 14 Jul 2010 07:53:18 +0200
Subject: [Rd] Suggestion for serialization performance improvement on
	Windows
In-Reply-To: <AANLkTimwIiK0sBwpnhQv9cPS2LJzwsVlTD9splgANzxP@mail.gmail.com>
References: <AANLkTimwIiK0sBwpnhQv9cPS2LJzwsVlTD9splgANzxP@mail.gmail.com>
Message-ID: <AANLkTinMrKHaB0NcmxOHgcRaKp7ttlemkCEbIzbCWWUQ@mail.gmail.com>

On Fri, Jul 9, 2010 at 6:49 AM, Bryan W. Lewis <bwaynelewis at gmail.com> wrote:
> Dear R developers,
>
> ?The slow performance of serializing to a raw vector on Windows is an
> issue that has appeared in this list before.

My guess is that you are referring to:

[Rd] serialize() to via temporary file is heaps faster than doing it
directly (on Windows), 2008-07-24
http://tolstoy.newcastle.edu.au/R/e4/devel/08/07/2355.html

If so, that thread show how unnecessarily slow (5 mins instead of 5
secs) it is on Windows.

> It appears to be due to
> the frequent use of realloc from the resize_buffer method in
> serialize.c.
>
> I suggest a more granular, but still incremental, re-allocation of
> memory. For example change near the top of resize_buffer to:
>
> R_size_t newsize = needed + 65536 - (needed % 65536);
>
> or some other similar small multiple of a typical system page size.
>
> I have found this to dramatically improve performance of serialization
> to raw vectors on Windows.

I second this update, which seems to make serialize(...,
connection=NULL) useful in Windows.

Thxs,

Henrik

>
> Best,
>
> Bryan
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Wed Jul 14 09:14:54 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Jul 2010 08:14:54 +0100 (BST)
Subject: [Rd] Building a custom Windows installer
In-Reply-To: <006601cb22ce$c583fd00$508bf700$@ca>
References: <006601cb22ce$c583fd00$508bf700$@ca>
Message-ID: <alpine.LFD.2.00.1007140753030.26326@gannet.stats.ox.ac.uk>

John,

It is not clear to me what you actually did (and I am also assuming 
this is 32-bit R), but I surmise that you did not build R in your 
source directory.  One of the first steps in doing so is to make 
src/gnuwin32/MkRules. (You are also likely to need to customize the 
file, possibly via a MkRules.local, to set ISDIR.)

I've done a quick check, and in R 2.11.x AFAICS all that is needed is

cd R_SOURCES/src/gnuwin32
make MkRules
cd installer
make myR IMAGEDIR=e:/temp/R-2.11.1 MDISDI=1

However, in 2.12.0 you will need to make R completely in the sources, 
as R is used for scripting.

Brian

On Tue, 13 Jul 2010, John Fox wrote:

> Dear r-devel list members,
>
> It's been several years since I last built a custom Windows installer for R,
> and despite my notes and the instructions in Sections 3.1.7 and D.4 of the R
> Installation and Administration Manual, I've run into a problem, receiving
> the following error message:
>
> ----------- snip -----------
>
> C:\R\src\R-2.11.1\src\gnuwin32\installer>make myR IMAGEDIR=c:/temp/R-2.11.1
> MDISDI=1
> Makefile:3: ../MkRules: No such file or directory
> make: ../fixed/rwver.pl: Command not found
> make: ../fixed/rwver.pl: Command not found
> make: ../fixed/rwver.pl: Command not found
> make: ../fixed/rwver.pl: Command not found
> make: *** No rule to make target `../MkRules'.  Stop.
>
> ----------- snip -----------
>
> My path looks like this:
>
> ----------- snip -----------
>
> C:\R\src\R-2.11.1\src\gnuwin32\installer>set path
> Path=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\Program
> Files\Commo
> n Files\Microsoft Shared\Windows Live;C:\GTK\bin;C:\Program
> Files\Insightful\spl
> us80\;C:\Program Files\ActiveState Komodo Edit
> 4\;.;c:\R\R-2.11.1\bin;C:\progra~
> 1\miktex~1.7\miktex\bin;c:\progra~1\htmlhe~1;C:\Windows\system32;C:\Windows;
> C:\W
> indows\System32\Wbem;C:\Program Files\Common Files\Roxio
> Shared\DLLShared\;C:\Pr
> ogram Files\GnuWin32\bin;C:\Program Files\CollabNet Subversion;C:\Program
> Files\
> MySQL\MySQL Server 5.1\bin;C:\Program Files\SAS\Shared
> Files\Formats;C:\Program
> Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
> Fil
> es\Smart Projects\IsoBuster;C:\Program Files\MiKTeX
> 2.7\miktex\bin\;C:\Program F
> iles\QuickTime\QTSystem\;C:\Program Files\Common Files\Microsoft
> Shared\Windows
> Live;C:\Program Files\SSH Communications Security\SSH Secure
> Shell;C:\Program Fi
> les\Bibtex2html;C:\Graphviz2.20\bin
> PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
>
> ----------- snip -----------
>
> The directory c:/temp/R-2.11.1 contains a complete customized installation
> of R, while C:\R\src\R-2.11.1 contains the unpacked R sources. This is on a
> Windows Vista system. I've updated Rtools to version 2.11.  I can supply
> more information, but I'm not sure what's relevant.
>
> I don't think that I should have to place a MkRules file in the gnuwin32
> directory, but I tried copying each the MkRules.dist and MkRules.rules files
> there in turn to MkRules. Neither worked; I apparently got farther copying
> MkRules.rules to MkRules, but eventually got another error:
>
> ----------- snip -----------
>
> C:\R\src\R-2.11.1\src\gnuwin32\installer>make myR IMAGEDIR=c:/temp/R-2.11.1
> MDISDI=1
> echo "make.packages.html(.Library)" | c:/temp/R-2.11.1/bin/rterm --vanilla
> --sla
> ve LC_COLLATE=C
> Making packages.html ... done
> adding MD5 checksums
> perl JRins.pl R-2.11.1 c:/temp/R-2.11.1 1 1 0 R-core
> "/iscc" R.iss > myR.log
> /iscc: not found
> make: *** [myR] Error 127
>
> ----------- snip -----------
>
> Any help would be appreciated.
>
> John
>
> --------------------------------
> John Fox
> Senator William McMaster
>  Professor of Social Statistics
> Department of Sociology
> McMaster University
> Hamilton, Ontario, Canada
> web: socserv.mcmaster.ca/jfox
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From nicebread at gmx.net  Wed Jul 14 12:00:22 2010
From: nicebread at gmx.net (=?iso-8859-1?Q?Felix_Sch=F6nbrodt?=)
Date: Wed, 14 Jul 2010 12:00:22 +0200
Subject: [Rd] Precompiled vignette on CRAN
Message-ID: <24C0C54B-4688-49AA-833A-7A247E2014E3@gmx.net>

Hello,

my package passes R CMD check without any warnings on my local machine (Mac OS), as well as on Uwe Ligges' Winbuilder. On RForge, however, we sometimes run into problems building the Sweave vignettes.

Now here's my question: is it necessary for a CRAN submission that the Sweave vignettes can be compiled on CRAN, or is it possible to provide the (locally compiled) pdf vignette to be included in the package?

Best,
Felix

From jfox at mcmaster.ca  Wed Jul 14 14:30:42 2010
From: jfox at mcmaster.ca (John Fox)
Date: Wed, 14 Jul 2010 08:30:42 -0400
Subject: [Rd] Building a custom Windows installer
In-Reply-To: <alpine.LFD.2.00.1007140753030.26326@gannet.stats.ox.ac.uk>
References: <006601cb22ce$c583fd00$508bf700$@ca>
	<alpine.LFD.2.00.1007140753030.26326@gannet.stats.ox.ac.uk>
Message-ID: <002401cb2350$5ff52bd0$1fdf8370$@ca>

Dear Brian,

> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Sent: July-14-10 3:15 AM
> To: John Fox
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Building a custom Windows installer
> 
> John,
> 
> It is not clear to me what you actually did (and I am also assuming
> this is 32-bit R), but I surmise that you did not build R in your
> source directory. 

Yes, that's right. It wasn't clear to me from the manual that it was
necessary to build R (or as it turns out, just MkRules) when using IMAGEDIR.
I guess that this has changed since I last built a custom installer, or my
notes were incomplete.

> One of the first steps in doing so is to make
> src/gnuwin32/MkRules. (You are also likely to need to customize the
> file, possibly via a MkRules.local, to set ISDIR.)

Not necessary in my case, since Inno Setup is in the default location.

> 
> I've done a quick check, and in R 2.11.x AFAICS all that is needed is
> 
> cd R_SOURCES/src/gnuwin32
> make MkRules
> cd installer
> make myR IMAGEDIR=e:/temp/R-2.11.1 MDISDI=1

Yes, this works fine for me as well.

Thank you very much.

John

> 
> However, in 2.12.0 you will need to make R completely in the sources,
> as R is used for scripting.
> 
> Brian
> 
> On Tue, 13 Jul 2010, John Fox wrote:
> 
> > Dear r-devel list members,
> >
> > It's been several years since I last built a custom Windows installer
for
> R,
> > and despite my notes and the instructions in Sections 3.1.7 and D.4 of
the
> R
> > Installation and Administration Manual, I've run into a problem,
receiving
> > the following error message:
> >
> > ----------- snip -----------
> >
> > C:\R\src\R-2.11.1\src\gnuwin32\installer>make myR
IMAGEDIR=c:/temp/R-2.11.1
> > MDISDI=1
> > Makefile:3: ../MkRules: No such file or directory
> > make: ../fixed/rwver.pl: Command not found
> > make: ../fixed/rwver.pl: Command not found
> > make: ../fixed/rwver.pl: Command not found
> > make: ../fixed/rwver.pl: Command not found
> > make: *** No rule to make target `../MkRules'.  Stop.
> >
> > ----------- snip -----------
> >
> > My path looks like this:
> >
> > ----------- snip -----------
> >
> > C:\R\src\R-2.11.1\src\gnuwin32\installer>set path
> > Path=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\Program
> > Files\Commo
> > n Files\Microsoft Shared\Windows Live;C:\GTK\bin;C:\Program
> > Files\Insightful\spl
> > us80\;C:\Program Files\ActiveState Komodo Edit
> > 4\;.;c:\R\R-2.11.1\bin;C:\progra~
> >
>
1\miktex~1.7\miktex\bin;c:\progra~1\htmlhe~1;C:\Windows\system32;C:\Windows;
> > C:\W
> > indows\System32\Wbem;C:\Program Files\Common Files\Roxio
> > Shared\DLLShared\;C:\Pr
> > ogram Files\GnuWin32\bin;C:\Program Files\CollabNet
Subversion;C:\Program
> > Files\
> > MySQL\MySQL Server 5.1\bin;C:\Program Files\SAS\Shared
> > Files\Formats;C:\Program
> >
>
Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
> > Fil
> > es\Smart Projects\IsoBuster;C:\Program Files\MiKTeX
> > 2.7\miktex\bin\;C:\Program F
> > iles\QuickTime\QTSystem\;C:\Program Files\Common Files\Microsoft
> > Shared\Windows
> > Live;C:\Program Files\SSH Communications Security\SSH Secure
> > Shell;C:\Program Fi
> > les\Bibtex2html;C:\Graphviz2.20\bin
> > PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
> >
> > ----------- snip -----------
> >
> > The directory c:/temp/R-2.11.1 contains a complete customized
installation
> > of R, while C:\R\src\R-2.11.1 contains the unpacked R sources. This is
on a
> > Windows Vista system. I've updated Rtools to version 2.11.  I can supply
> > more information, but I'm not sure what's relevant.
> >
> > I don't think that I should have to place a MkRules file in the gnuwin32
> > directory, but I tried copying each the MkRules.dist and MkRules.rules
> files
> > there in turn to MkRules. Neither worked; I apparently got farther
copying
> > MkRules.rules to MkRules, but eventually got another error:
> >
> > ----------- snip -----------
> >
> > C:\R\src\R-2.11.1\src\gnuwin32\installer>make myR
IMAGEDIR=c:/temp/R-2.11.1
> > MDISDI=1
> > echo "make.packages.html(.Library)" | c:/temp/R-2.11.1/bin/rterm
--vanilla
> > --sla
> > ve LC_COLLATE=C
> > Making packages.html ... done
> > adding MD5 checksums
> > perl JRins.pl R-2.11.1 c:/temp/R-2.11.1 1 1 0 R-core
> > "/iscc" R.iss > myR.log
> > /iscc: not found
> > make: *** [myR] Error 127
> >
> > ----------- snip -----------
> >
> > Any help would be appreciated.
> >
> > John
> >
> > --------------------------------
> > John Fox
> > Senator William McMaster
> >  Professor of Social Statistics
> > Department of Sociology
> > McMaster University
> > Hamilton, Ontario, Canada
> > web: socserv.mcmaster.ca/jfox
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Jul 14 22:04:37 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Jul 2010 21:04:37 +0100 (BST)
Subject: [Rd] Precompiled vignette on CRAN
In-Reply-To: <24C0C54B-4688-49AA-833A-7A247E2014E3@gmx.net>
References: <24C0C54B-4688-49AA-833A-7A247E2014E3@gmx.net>
Message-ID: <alpine.LFD.2.00.1007141140530.10475@localhost>

On Wed, 14 Jul 2010, Felix Sch?nbrodt wrote:

> Hello,
>
> my package passes R CMD check without any warnings on my local 
> machine (Mac OS), as well as on Uwe Ligges' Winbuilder. On RForge, 
> however, we sometimes run into problems building the Sweave 
> vignettes.

Just 'problems' is not helpful.

> Now here's my question: is it necessary for a CRAN submission that 
> the Sweave vignettes can be compiled on CRAN, or is it possible to 
> provide the (locally compiled) pdf vignette to be included in the 
> package?

This really is a question to ask the CRAN gatekeepers, but people are 
on vacation right now, so I've give some indication of my 
understanding.

What does 'compiled' mean here?  (Run through LaTeX?  Run the R code?) 
There are examples on CRAN of packages which cannot re-make their 
vignettes without external files (e.g. LaTeX style files), or take 
hours (literally) to run the code.  The source package should contain 
the PDF versions of the vignettes as made by the author.

There is relevant advice in 'Writing R Extensions'.

What the people who do the CRAN package checks do get unhappy about 
are packages which fail running the R code in their vignettes, since 
this often indicates a problem in the package which is not exercised 
by the examples nor tests.  This gives a warning, as you will see in 
quite a few CRAN package checks.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From simon.urbanek at r-project.org  Wed Jul 14 23:08:53 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 14 Jul 2010 17:08:53 -0400
Subject: [Rd] Precompiled vignette on CRAN
In-Reply-To: <alpine.LFD.2.00.1007141140530.10475@localhost>
References: <24C0C54B-4688-49AA-833A-7A247E2014E3@gmx.net>
	<alpine.LFD.2.00.1007141140530.10475@localhost>
Message-ID: <5BE729F0-8380-41ED-8C99-DDFBCF17925B@r-project.org>

On Jul 14, 2010, at 4:04 PM, Prof Brian Ripley wrote:

> On Wed, 14 Jul 2010, Felix Sch?nbrodt wrote:
> 
>> Hello,
>> 
>> my package passes R CMD check without any warnings on my local machine (Mac OS), as well as on Uwe Ligges' Winbuilder. On RForge, however, we sometimes run into problems building the Sweave vignettes.
> 
> Just 'problems' is not helpful.
> 

FWIW I think it was a red herring - after bugfixes to the package and installing (unstated*) dependencies it works (possibly use of require instead of library in the vignette might help - I don't know what the best practice is).


>> Now here's my question: is it necessary for a CRAN submission that the Sweave vignettes can be compiled on CRAN, or is it possible to provide the (locally compiled) pdf vignette to be included in the package?
> 
> This really is a question to ask the CRAN gatekeepers, but people are on vacation right now, so I've give some indication of my understanding.
> 
> What does 'compiled' mean here?  (Run through LaTeX?  Run the R code?) There are examples on CRAN of packages which cannot re-make their vignettes without external files (e.g. LaTeX style files), or take hours (literally) to run the code.  The source package should contain the PDF versions of the vignettes as made by the author.
> 
> There is relevant advice in 'Writing R Extensions'.
> 
> What the people who do the CRAN package checks do get unhappy about are packages which fail running the R code in their vignettes, since this often indicates a problem in the package which is not exercised by the examples nor tests.  This gives a warning, as you will see in quite a few CRAN package checks.
> 

In the case of TripleR R CMD check failed (i.e. error code != 0) because of the vignette.

Cheers,
Simon

* - which reminds me -- what is the correct place to list vignette dependencies? "Suggests:" ?

R CMD check simply fails in the vignette build when vignetts use unstated dependencies [via library()] - there is no explicit warning/error by check itself.


From mtmorgan at fhcrc.org  Wed Jul 14 23:12:38 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Wed, 14 Jul 2010 14:12:38 -0700
Subject: [Rd] Precompiled vignette on CRAN
In-Reply-To: <alpine.LFD.2.00.1007141140530.10475@localhost>
References: <24C0C54B-4688-49AA-833A-7A247E2014E3@gmx.net>
	<alpine.LFD.2.00.1007141140530.10475@localhost>
Message-ID: <4C3E2846.6080400@fhcrc.org>

On 07/14/2010 01:04 PM, Prof Brian Ripley wrote:
> On Wed, 14 Jul 2010, Felix Sch?nbrodt wrote:
> 
>> Hello,
>>
>> my package passes R CMD check without any warnings on my local machine
>> (Mac OS), as well as on Uwe Ligges' Winbuilder. On RForge, however, we
>> sometimes run into problems building the Sweave vignettes.
> 
> Just 'problems' is not helpful.
> 
>> Now here's my question: is it necessary for a CRAN submission that the
>> Sweave vignettes can be compiled on CRAN, or is it possible to provide
>> the (locally compiled) pdf vignette to be included in the package?
> 
> This really is a question to ask the CRAN gatekeepers, but people are on
> vacation right now, so I've give some indication of my understanding.
> 
> What does 'compiled' mean here?  (Run through LaTeX?  Run the R code?)
> There are examples on CRAN of packages which cannot re-make their
> vignettes without external files (e.g. LaTeX style files), or take hours
> (literally) to run the code.  The source package should contain the PDF
> versions of the vignettes as made by the author.
> 
> There is relevant advice in 'Writing R Extensions'.

While on this topic, how are non-Sweave files to be made accessible to
browseVignettes() and help(package=...)?

At one point 00Index.dcf files could be used to influence index
creation, and Writing R Extensions indicates that an inst/doc/index.html
file can also be used. The 00Index.dcf approach seems better (no need
for the user to track the appropriate html structure of R's help pages),
but regardless it seems 00Index.dcf is ignored (stronger than 'no longer
necessary' in Writing R Extensions) and index.html does not influence
what is displayed by help(package='...') or browseVignettes().

I'm basing this on the 'limma' package (which seems to have tried to be
a good citizen, with 00Index.dcf and index.html files) and running R in
a console with

> getOption('help_type')
NULL
> sessionInfo()
R version 2.12.0 Under development (unstable) (2010-07-14 r52526)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] limma_3.5.12

Martin


> 
> What the people who do the CRAN package checks do get unhappy about are
> packages which fail running the R code in their vignettes, since this
> often indicates a problem in the package which is not exercised by the
> examples nor tests.  This gives a warning, as you will see in quite a
> few CRAN package checks.
> 
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From hpages at fhcrc.org  Thu Jul 15 10:12:10 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 15 Jul 2010 01:12:10 -0700
Subject: [Rd] Very slow subsetting by name
Message-ID: <4C3EC2DA.80303@fhcrc.org>

Hi,

I'm subsetting a named vector using character indices.
My vector of indices (or keys) is 10x longer than the vector
I'm subsetting. All my keys are distinct and only 10% of them
are valid (i.e. match a name of the vector being subsetted).
It is surprisingly slow:

x1 <- 1:1000
names(x1) <- paste("a", x1, sep="")
keys <- sample(c(names(x1), paste("b", 1:9000, sep="")))
 > system.time(y1 <- x1[keys])
    user  system elapsed
   0.410   0.000   0.416

x2 <- 1:2000
names(x2) <- paste("a", x2, sep="")
keys <- sample(c(names(x2), paste("b", 1:18000, sep="")))
 > system.time(y2 <- x2[keys])
    user  system elapsed
   1.730   0.000   1.736

x3 <- 1:4000
names(x3) <- paste("a", x3, sep="")
keys <- sample(c(names(x3), paste("b", 1:36000, sep="")))
 > system.time(y3 <- x3[keys])
    user  system elapsed
   8.900   0.010   9.227

x4 <- 1:8000
names(x4) <- paste("a", x4, sep="")
keys <- sample(c(names(x4), paste("b", 1:72000, sep="")))
 > system.time(y4 <- x4[keys])
    user  system elapsed
130.390   0.000 132.316

And it's apparently worse than quadratic in time!

I'm wondering why this subsetting by name is so slow since it
seems it could be implemented with x4[match(keys, names(x4))],
which is very fast: only 0.012s!

This is with R-2.11.0 and R-2.12.0.

Thanks,
H.


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mtmorgan at fhcrc.org  Thu Jul 15 17:38:53 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 15 Jul 2010 08:38:53 -0700
Subject: [Rd] Very slow subsetting by name
In-Reply-To: <4C3EC2DA.80303@fhcrc.org>
References: <4C3EC2DA.80303@fhcrc.org>
Message-ID: <4C3F2B8D.6030403@fhcrc.org>

On 07/15/2010 01:12 AM, Herv? Pag?s wrote:
> Hi,
> 
> I'm subsetting a named vector using character indices.
> My vector of indices (or keys) is 10x longer than the vector
> I'm subsetting. All my keys are distinct and only 10% of them
> are valid (i.e. match a name of the vector being subsetted).
> It is surprisingly slow:
> 
> x1 <- 1:1000
> names(x1) <- paste("a", x1, sep="")
> keys <- sample(c(names(x1), paste("b", 1:9000, sep="")))
>> system.time(y1 <- x1[keys])
>    user  system elapsed
>   0.410   0.000   0.416
> 
> x2 <- 1:2000
> names(x2) <- paste("a", x2, sep="")
> keys <- sample(c(names(x2), paste("b", 1:18000, sep="")))
>> system.time(y2 <- x2[keys])
>    user  system elapsed
>   1.730   0.000   1.736

For what its worth, I think this comes about in the loop starting at
subscript.c:538, which seems to be there to allow [<-,*,character to
extend a vector with new named elements

> x=c(a=1)
> x["b"] = 2
> x
a b
1 2

It seems to be irrelevant (?) for sub-setting per se (though by analogy
one might expect x["c"] to return a length-1 vector NA with name "c",
whereas it returns a vector with names NA).

Seems like the O(n^2) loop through NonNullStringMatch could be replaced
by look-ups into a hash, or an additional argument could be propagated
to stringSubscript to exit early when names aren't required. Or the call
to makeSubscript at subset.c:164 could instead be made to matchE in
unique.c.

Martin

> 
> x3 <- 1:4000
> names(x3) <- paste("a", x3, sep="")
> keys <- sample(c(names(x3), paste("b", 1:36000, sep="")))
>> system.time(y3 <- x3[keys])
>    user  system elapsed
>   8.900   0.010   9.227
> 
> x4 <- 1:8000
> names(x4) <- paste("a", x4, sep="")
> keys <- sample(c(names(x4), paste("b", 1:72000, sep="")))
>> system.time(y4 <- x4[keys])
>    user  system elapsed
> 130.390   0.000 132.316
> 
> And it's apparently worse than quadratic in time!
> 
> I'm wondering why this subsetting by name is so slow since it
> seems it could be implemented with x4[match(keys, names(x4))],
> which is very fast: only 0.012s!
> 
> This is with R-2.11.0 and R-2.12.0.
> 
> Thanks,
> H.
> 
> 


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From mtmorgan at fhcrc.org  Thu Jul 15 20:16:14 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 15 Jul 2010 11:16:14 -0700
Subject: [Rd] Very slow subsetting by name
In-Reply-To: <4C3F2B8D.6030403@fhcrc.org>
References: <4C3EC2DA.80303@fhcrc.org> <4C3F2B8D.6030403@fhcrc.org>
Message-ID: <4C3F506E.50708@fhcrc.org>

On 07/15/2010 08:38 AM, Martin Morgan wrote:
> On 07/15/2010 01:12 AM, Herv? Pag?s wrote:
>> Hi,
>>
>> I'm subsetting a named vector using character indices.
>> My vector of indices (or keys) is 10x longer than the vector
>> I'm subsetting. All my keys are distinct and only 10% of them
>> are valid (i.e. match a name of the vector being subsetted).
>> It is surprisingly slow:
>>
>> x1 <- 1:1000
>> names(x1) <- paste("a", x1, sep="")
>> keys <- sample(c(names(x1), paste("b", 1:9000, sep="")))
>>> system.time(y1 <- x1[keys])
>>    user  system elapsed
>>   0.410   0.000   0.416
>>
>> x2 <- 1:2000
>> names(x2) <- paste("a", x2, sep="")
>> keys <- sample(c(names(x2), paste("b", 1:18000, sep="")))
>>> system.time(y2 <- x2[keys])
>>    user  system elapsed
>>   1.730   0.000   1.736
> 
> For what its worth, I think this comes about in the loop starting at
> subscript.c:538, which seems to be there to allow [<-,*,character to
> extend a vector with new named elements
> 
>> x=c(a=1)
>> x["b"] = 2
>> x
> a b
> 1 2
> 
> It seems to be irrelevant (?) for sub-setting per se (though by analogy
> one might expect x["c"] to return a length-1 vector NA with name "c",
> whereas it returns a vector with names NA).
> 
> Seems like the O(n^2) loop through NonNullStringMatch could be replaced
> by look-ups into a hash, or an additional argument could be propagated

this passes make check and does

> x4 <- 1:8000
> names(x4) <- paste("a", x4, sep="")
> keys <- sample(c(names(x4), paste("b", 1:72000, sep="")))
> system.time(y4 <- x4[keys])
   user  system elapsed
  0.092   0.000   0.093
> identical(y4, x4[match(keys, names(x4))])
[1] TRUE

but uses some additional memory.

Martin

Index: src/main/subscript.c
===================================================================
--- src/main/subscript.c	(revision 52526)
+++ src/main/subscript.c	(working copy)
@@ -535,15 +535,17 @@
     }


+    SEXP sindx = PROTECT(match(s, s, 0)); /* first match */
     for (i = 0; i < ns; i++) {
 	sub = INTEGER(indx)[i];
 	if (sub == 0) {
-	    for (j = 0 ; j < i ; j++)
-		if (NonNullStringMatch(STRING_ELT(s, i), STRING_ELT(s, j))) {
-		    sub = INTEGER(indx)[j];
-		    SET_VECTOR_ELT(indexnames, i, STRING_ELT(s, j));
-		    break;
-		}
+            j = INTEGER(sindx)[i] - 1;
+            if (NA_STRING != STRING_ELT(s, j) &&
+                R_NilValue != STRING_ELT(s, j))
+            {
+                sub = INTEGER(indx)[j];
+                SET_VECTOR_ELT(indexnames, i, STRING_ELT(s, j));
+            }
 	}
 	if (sub == 0) {
 	    if (!canstretch) {
@@ -561,7 +563,7 @@
 	setAttrib(indx, R_UseNamesSymbol, indexnames);
     if (canstretch)
 	*stretch = extra;
-    UNPROTECT(4);
+    UNPROTECT(5);
     return indx;
 }

> to stringSubscript to exit early when names aren't required. Or the call
> to makeSubscript at subset.c:164 could instead be made to matchE in
> unique.c.
> 
> Martin
> 
>>
>> x3 <- 1:4000
>> names(x3) <- paste("a", x3, sep="")
>> keys <- sample(c(names(x3), paste("b", 1:36000, sep="")))
>>> system.time(y3 <- x3[keys])
>>    user  system elapsed
>>   8.900   0.010   9.227
>>
>> x4 <- 1:8000
>> names(x4) <- paste("a", x4, sep="")
>> keys <- sample(c(names(x4), paste("b", 1:72000, sep="")))
>>> system.time(y4 <- x4[keys])
>>    user  system elapsed
>> 130.390   0.000 132.316
>>
>> And it's apparently worse than quadratic in time!
>>
>> I'm wondering why this subsetting by name is so slow since it
>> seems it could be implemented with x4[match(keys, names(x4))],
>> which is very fast: only 0.012s!
>>
>> This is with R-2.11.0 and R-2.12.0.
>>
>> Thanks,
>> H.
>>
>>
> 
> 


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From jon.clayden at gmail.com  Fri Jul 16 14:08:37 2010
From: jon.clayden at gmail.com (Jon Clayden)
Date: Fri, 16 Jul 2010 13:08:37 +0100
Subject: [Rd] Creating an environment with attributes in a package
Message-ID: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>

Dear all,

I am trying to create an environment object with additional attributes, viz.

Foo <- structure(new.env(), name="Foo")

Doing this in a standard session works fine: I get the environment
with attr(,"name") set as expected. But if the same code appears
inside a package source file, I get just the plain environment with no
attributes set. Using a non-environment object works as I would expect
within the package (i.e. the attributes remain).

I've looked through the documentation for reasons for this, and the
only thing I've found is the mention in the language definition that
"assigning attributes to an environment can lead to surprises". I'm
not sure if this is one of the surprises that the author(s) had in
mind! Could someone tell me whether this is expected, please?

All the best,
Jon

--
Jonathan D Clayden, PhD
Lecturer in Neuroimaging and Biophysics
Radiology and Physics Unit
UCL Institute of Child Health
30 Guilford Street
LONDON  WC1N 1EH
United Kingdom

t | +44 (0)20 7905 2708
f | +44 (0)20 7905 2358
w | www.homepages.ucl.ac.uk/~sejjjd2/
w | www.diffusion-mri.org.uk/people/1


From ggrothendieck at gmail.com  Fri Jul 16 14:15:17 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 16 Jul 2010 08:15:17 -0400
Subject: [Rd] Creating an environment with attributes in a package
In-Reply-To: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>
References: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>
Message-ID: <AANLkTilW8Q60qjUPXAOlFOIdd2ZS7xZsQLUTXmSmY8tp@mail.gmail.com>

On Fri, Jul 16, 2010 at 8:08 AM, Jon Clayden <jon.clayden at gmail.com> wrote:
> Dear all,
>
> I am trying to create an environment object with additional attributes, viz.
>
> Foo <- structure(new.env(), name="Foo")
>
> Doing this in a standard session works fine: I get the environment
> with attr(,"name") set as expected. But if the same code appears
> inside a package source file, I get just the plain environment with no
> attributes set. Using a non-environment object works as I would expect
> within the package (i.e. the attributes remain).
>
> I've looked through the documentation for reasons for this, and the
> only thing I've found is the mention in the language definition that
> "assigning attributes to an environment can lead to surprises". I'm
> not sure if this is one of the surprises that the author(s) had in
> mind! Could someone tell me whether this is expected, please?
>
> All the best,
> Jon

I had documented a few problems I found in R here:

   http://r-proto.googlecode.com

and you might want to go over them.  The item you mention is discussed
in #1 there.  This was written some time ago and there may have been
relevant changes to R since then so it would be a good idea to double
check everything with the current version of R.


From ggrothendieck at gmail.com  Fri Jul 16 14:16:38 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 16 Jul 2010 08:16:38 -0400
Subject: [Rd] Creating an environment with attributes in a package
In-Reply-To: <AANLkTilW8Q60qjUPXAOlFOIdd2ZS7xZsQLUTXmSmY8tp@mail.gmail.com>
References: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com> 
	<AANLkTilW8Q60qjUPXAOlFOIdd2ZS7xZsQLUTXmSmY8tp@mail.gmail.com>
Message-ID: <AANLkTinuEyq9MjER7cHCY1Xn5TcOsZazQImuCXSjxvxp@mail.gmail.com>

On Fri, Jul 16, 2010 at 8:15 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Fri, Jul 16, 2010 at 8:08 AM, Jon Clayden <jon.clayden at gmail.com> wrote:
>> Dear all,
>>
>> I am trying to create an environment object with additional attributes, viz.
>>
>> Foo <- structure(new.env(), name="Foo")
>>
>> Doing this in a standard session works fine: I get the environment
>> with attr(,"name") set as expected. But if the same code appears
>> inside a package source file, I get just the plain environment with no
>> attributes set. Using a non-environment object works as I would expect
>> within the package (i.e. the attributes remain).
>>
>> I've looked through the documentation for reasons for this, and the
>> only thing I've found is the mention in the language definition that
>> "assigning attributes to an environment can lead to surprises". I'm
>> not sure if this is one of the surprises that the author(s) had in
>> mind! Could someone tell me whether this is expected, please?
>>
>> All the best,
>> Jon
>
> I had documented a few problems I found in R here:
>
> ? http://r-proto.googlecode.com
>
> and you might want to go over them. ?The item you mention is discussed
> in #1 there. ?This was written some time ago and there may have been
> relevant changes to R since then so it would be a good idea to double
> check everything with the current version of R.
>

Here is a link directly to the part of that page that deals with R problems:

http://code.google.com/p/r-proto/#Avoiding_R_Bugs


From hadley at rice.edu  Fri Jul 16 14:32:38 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 16 Jul 2010 14:32:38 +0200
Subject: [Rd] Creating an environment with attributes in a package
In-Reply-To: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>
References: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>
Message-ID: <AANLkTinfhXQJCXuUSERSUfyBuncOZZdjLDnVDtPP-28a@mail.gmail.com>

On Fri, Jul 16, 2010 at 2:08 PM, Jon Clayden <jon.clayden at gmail.com> wrote:
> Dear all,
>
> I am trying to create an environment object with additional attributes, viz.
>
> Foo <- structure(new.env(), name="Foo")
>
> Doing this in a standard session works fine: I get the environment
> with attr(,"name") set as expected. But if the same code appears
> inside a package source file, I get just the plain environment with no
> attributes set. Using a non-environment object works as I would expect
> within the package (i.e. the attributes remain).
>
> I've looked through the documentation for reasons for this, and the
> only thing I've found is the mention in the language definition that
> "assigning attributes to an environment can lead to surprises". I'm
> not sure if this is one of the surprises that the author(s) had in
> mind! Could someone tell me whether this is expected, please?

You'll be much less surprised if you do:

Foo <- structure(list(new.env()), name="Foo")

Attributes on reference objects are also passed by reference, and
surprises will result.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From jon.clayden at gmail.com  Fri Jul 16 14:51:39 2010
From: jon.clayden at gmail.com (Jon Clayden)
Date: Fri, 16 Jul 2010 13:51:39 +0100
Subject: [Rd] Creating an environment with attributes in a package
In-Reply-To: <AANLkTinfhXQJCXuUSERSUfyBuncOZZdjLDnVDtPP-28a@mail.gmail.com>
References: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>
	<AANLkTinfhXQJCXuUSERSUfyBuncOZZdjLDnVDtPP-28a@mail.gmail.com>
Message-ID: <AANLkTimX45rQ_VXDNp5Vs0zkb7dMRv2_hOwRatS5GdOI@mail.gmail.com>

On 16 July 2010 13:32, Hadley Wickham <hadley at rice.edu> wrote:
> On Fri, Jul 16, 2010 at 2:08 PM, Jon Clayden <jon.clayden at gmail.com> wrote:
>> Dear all,
>>
>> I am trying to create an environment object with additional attributes, viz.
>>
>> Foo <- structure(new.env(), name="Foo")
>>
>> Doing this in a standard session works fine: I get the environment
>> with attr(,"name") set as expected. But if the same code appears
>> inside a package source file, I get just the plain environment with no
>> attributes set. Using a non-environment object works as I would expect
>> within the package (i.e. the attributes remain).
>>
>> I've looked through the documentation for reasons for this, and the
>> only thing I've found is the mention in the language definition that
>> "assigning attributes to an environment can lead to surprises". I'm
>> not sure if this is one of the surprises that the author(s) had in
>> mind! Could someone tell me whether this is expected, please?
>
> You'll be much less surprised if you do:
>
> Foo <- structure(list(new.env()), name="Foo")
>
> Attributes on reference objects are also passed by reference, and
> surprises will result.

Ah, it's good to know the core reason for the "surprises"! Sounds like
the best thing is to refactor things as you suggest.

Many thanks for all the responses.

Regards,
Jon


From jmc at r-project.org  Fri Jul 16 18:47:26 2010
From: jmc at r-project.org (John Chambers)
Date: Fri, 16 Jul 2010 09:47:26 -0700
Subject: [Rd] Creating an environment with attributes in a package
In-Reply-To: <AANLkTimX45rQ_VXDNp5Vs0zkb7dMRv2_hOwRatS5GdOI@mail.gmail.com>
References: <AANLkTin3LINSssOpwJtqsUsW1Mt-1PH8h9eIiW7H4xny@mail.gmail.com>	<AANLkTinfhXQJCXuUSERSUfyBuncOZZdjLDnVDtPP-28a@mail.gmail.com>
	<AANLkTimX45rQ_VXDNp5Vs0zkb7dMRv2_hOwRatS5GdOI@mail.gmail.com>
Message-ID: <4C408D1E.8040902@r-project.org>

Note that S4 classes extend "environment" and other reference types, by 
using a hidden slot.  You can then add other slots.  So, with some extra 
work:

 > setClass("myEnv", contains = "environment",
+ representation(myName = "character"))
[1] "myEnv"
 > Foo <- new("myEnv", myName = "Foo")
 > Foo
An object of class "myEnv"
<environment: 0x101a3a580>
Slot "myName":
[1] "Foo"

There are a few holes in the implementation as of R 2.11.1, which are 
being filled in r-devel.  Partly to support some new applications for 
extensions of environments, which I hope to commit today (stay tuned to 
this list).


On 7/16/10 5:51 AM, Jon Clayden wrote:
> On 16 July 2010 13:32, Hadley Wickham<hadley at rice.edu>  wrote:
>> On Fri, Jul 16, 2010 at 2:08 PM, Jon Clayden<jon.clayden at gmail.com>  wrote:
>>> Dear all,
>>>
>>> I am trying to create an environment object with additional attributes, viz.
>>>
>>> Foo<- structure(new.env(), name="Foo")
>>>
>>> Doing this in a standard session works fine: I get the environment
>>> with attr(,"name") set as expected. But if the same code appears
>>> inside a package source file, I get just the plain environment with no
>>> attributes set. Using a non-environment object works as I would expect
>>> within the package (i.e. the attributes remain).
>>>
>>> I've looked through the documentation for reasons for this, and the
>>> only thing I've found is the mention in the language definition that
>>> "assigning attributes to an environment can lead to surprises". I'm
>>> not sure if this is one of the surprises that the author(s) had in
>>> mind! Could someone tell me whether this is expected, please?
>>
>> You'll be much less surprised if you do:
>>
>> Foo<- structure(list(new.env()), name="Foo")
>>
>> Attributes on reference objects are also passed by reference, and
>> surprises will result.
>
> Ah, it's good to know the core reason for the "surprises"! Sounds like
> the best thing is to refactor things as you suggest.
>
> Many thanks for all the responses.
>
> Regards,
> Jon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jmc at r-project.org  Fri Jul 16 19:40:24 2010
From: jmc at r-project.org (John Chambers)
Date: Fri, 16 Jul 2010 10:40:24 -0700
Subject: [Rd] Inserting and testing revised functions in a package
Message-ID: <4C409988.2070208@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100716/adb15cb2/attachment.pl>

From smckinney at bccrc.ca  Sat Jul 17 03:27:39 2010
From: smckinney at bccrc.ca (Steven McKinney)
Date: Fri, 16 Jul 2010 18:27:39 -0700
Subject: [Rd] [R] RMySQL package on 64bit R for Windows
In-Reply-To: <4427_1279316187_1279316187_1279310395704-2291892.post@n4.nabble.com>
References: <11c37188.6c874a4f.4c0f837c.c46db@o2.pl>
	<4427_1279316187_1279316187_1279310395704-2291892.post@n4.nabble.com>
Message-ID: <DCE81E14EB74504B971DAD4D2DB0356B06160D854C@crcmail4.BCCRC.CA>

I think this is a question for R-devel so I'm
cross-posting there with apologies.

I've just acquired a Windows 7 64-bit box and
also will need RMySQL eventually.

Is there any information about issues involved
with compiling RMySQL for Windows 64-bit?


Steven McKinney
Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre



> -----Original Message-----
> From: r-help-bounces at r-project.org [mailto:r-help-bounces at r-project.org] On Behalf Of abeSRT
> Sent: July-16-10 1:00 PM
> To: r-help at r-project.org
> Subject: Re: [R] RMySQL package on 64bit R for Windows
> 
> 
> Did you ever find a solution for this?
> --
> View this message in context: http://r.789695.n4.nabble.com/RMySQL-package-on-64bit-R-for-Windows-
> tp2248726p2291892.html
> Sent from the R help mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ripley at stats.ox.ac.uk  Sat Jul 17 08:05:33 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 17 Jul 2010 07:05:33 +0100 (BST)
Subject: [Rd] [R] RMySQL package on 64bit R for Windows
In-Reply-To: <DCE81E14EB74504B971DAD4D2DB0356B06160D854C@crcmail4.BCCRC.CA>
References: <11c37188.6c874a4f.4c0f837c.c46db@o2.pl>
	<4427_1279316187_1279316187_1279310395704-2291892.post@n4.nabble.com>
	<DCE81E14EB74504B971DAD4D2DB0356B06160D854C@crcmail4.BCCRC.CA>
Message-ID: <alpine.LFD.2.00.1007170700390.26367@gannet.stats.ox.ac.uk>

Please don't post to multiple lists (it is regarded as discourteous, 
at the least)!  R-sig-db (which you did not post to) would have been 
appropriate, after asking the maintainer (see the posting guide).

On Fri, 16 Jul 2010, Steven McKinney wrote:

> I think this is a question for R-devel so I'm
> cross-posting there with apologies.
>
> I've just acquired a Windows 7 64-bit box and
> also will need RMySQL eventually.
>
> Is there any information about issues involved
> with compiling RMySQL for Windows 64-bit?

Yes, ask the maintainer, whom I have provided with patches (and I 
gather is working on a suitable update).


>
> Steven McKinney
> Statistician
> Molecular Oncology and Breast Cancer Program
> British Columbia Cancer Research Centre
>
>
>
>> -----Original Message-----
>> From: r-help-bounces at r-project.org [mailto:r-help-bounces at r-project.org] On Behalf Of abeSRT
>> Sent: July-16-10 1:00 PM
>> To: r-help at r-project.org
>> Subject: Re: [R] RMySQL package on 64bit R for Windows
>>
>>
>> Did you ever find a solution for this?
>> --
>> View this message in context: http://r.789695.n4.nabble.com/RMySQL-package-on-64bit-R-for-Windows-
>> tp2248726p2291892.html
>> Sent from the R help mailing list archive at Nabble.com.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From leoe at optusnet.com.au  Fri Jul 16 11:32:24 2010
From: leoe at optusnet.com.au (Leo Evangelista)
Date: Fri, 16 Jul 2010 19:32:24 +1000
Subject: [Rd] re ading SPSS .sav files (PR#13509)
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAAEIjcaFhyj1IlO8uK/5I2jfCgAAAEAAAAHartAjQ9nZPuRu+xIZ2uB8BAAAAAA==@optusnet.com.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100716/c2911ca3/attachment.pl>

From this.is.mvw at gmail.com  Sat Jul 17 01:24:53 2010
From: this.is.mvw at gmail.com (Mike Williamson)
Date: Fri, 16 Jul 2010 16:24:53 -0700
Subject: [Rd] garbage collection & memory leaks in 'R', it seems...
Message-ID: <AANLkTikMqpyyCKq_6WXxG6F70zd2YsZQyjWZPxDFzIK4@mail.gmail.com>

Hello developers,

    I noticed that if I am running 'R', type "rm(list=objects())" and
"gc()", 'R' will still be consuming (a lot) more memory than when I then
close 'R' and re-open it.  In my ignorance, I'm presuming this is something
in 'R' where it doesn't really do a great job of garbage collection... at
least not nearly as well as Windows or unix can do garbage collection.
    Am I right?  If so, is there any better way to "clean up" the memory
that 'R' is using?  I have a script that runs a fairly large job, and I
cannot keep it going on its own in a convenient way because of these
remnants of garbage that pile up and eventually leave so little memory
remaining that the script crashes.

    I have attached a screen shot of the "system performance" screen on the
64-bit windows machine (with 64-bit 'R') that I am using.  I labeled
portions of it before closing 'R' and after re-opening it (loading up the
same saved image) to show the large difference in memory being consumed.
Below are the details of my version of 'R'.  Thanks for any help!!

                                Thanks,
                                        Mike


R version:  Win-64bit version, 2.11.1  (the machine I'm using has 20 GB of
memory, so that's my memory limit since it's 64 bit version)
packages:  see below...



             Package        Version
brew         "brew"         "1.0-3"
colorspace   "colorspace"   "1.0-1"
corpcor      "corpcor"      "1.5.6"
digest       "digest"       "0.4.2"
fdrtool      "fdrtool"      "1.2.6"
GeneCycle    "GeneCycle"    "1.1.1"
ggplot2      "ggplot2"      "0.8.7"
longitudinal "longitudinal" "1.1.5"
MASS         "MASS"         "7.3-6"
plyr         "plyr"         "0.1.9"
proto        "proto"        "0.3-8"
qvalue       "qvalue"       "1.22.0"
R.methodsS3  "R.methodsS3"  "1.2.0"
R.oo         "R.oo"         "1.7.3"
R.utils      "R.utils"      "1.4.3"
randomForest "randomForest" "4.5-35"
RColorBrewer "RColorBrewer" "1.0-2"
reshape      "reshape"      "0.8.3"
RODBC        "RODBC"        "1.3-1"
sos          "sos"          "1.3-0"
base         "base"         "2.11.1"
boot         "boot"         "1.2-42"
class        "class"        "7.3-2"
cluster      "cluster"      "1.12.3"
codetools    "codetools"    "0.2-2"
datasets     "datasets"     "2.11.1"
foreign      "foreign"      "0.8-40"
graphics     "graphics"     "2.11.1"
grDevices    "grDevices"    "2.11.1"
grid         "grid"         "2.11.1"
KernSmooth   "KernSmooth"   "2.23-3"
lattice      "lattice"      "0.18-8"
MASS         "MASS"         "7.3-6"
Matrix       "Matrix"       "0.999375-39"
methods      "methods"      "2.11.1"
mgcv         "mgcv"         "1.6-2"
nlme         "nlme"         "3.1-96"
nnet         "nnet"         "7.3-1"
rpart        "rpart"        "3.1-46"
spatial      "spatial"      "7.3-2"
splines      "splines"      "2.11.1"
stats        "stats"        "2.11.1"
stats4       "stats4"       "2.11.1"
survival     "survival"     "2.35-8"
tcltk        "tcltk"        "2.11.1"
tools        "tools"        "2.11.1"
utils        "utils"        "2.11.1"




"Telescopes and bathyscaphes and sonar probes of Scottish lakes,
Tacoma Narrows bridge collapse explained with abstract phase-space maps,
Some x-ray slides, a music score, Minard's Napoleanic war:
The most exciting frontier is charting what's already here."
  -- xkcd

--
Help protect Wikipedia. Donate now:
http://wikimediafoundation.org/wiki/Support_Wikipedia/en
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Capture.PNG
Type: image/png
Size: 89304 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100716/37ffea0c/attachment.png>

From pdalgd at gmail.com  Sat Jul 17 10:12:19 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Sat, 17 Jul 2010 10:12:19 +0200
Subject: [Rd] re ading SPSS .sav files (PR#13509)
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAAEIjcaFhyj1IlO8uK/5I2jfCgAAAEAAAAHartAjQ9nZPuRu+xIZ2uB8BAAAAAA==@optusnet.com.au>
References: <!&!AAAAAAAAAAAYAAAAAAAAAEIjcaFhyj1IlO8uK/5I2jfCgAAAEAAAAHartAjQ9nZPuRu+xIZ2uB8BAAAAAA==@optusnet.com.au>
Message-ID: <4C4165E3.3000704@gmail.com>

Leo Evangelista wrote:
> Sir/Madam,
> 
>  
> 
> Installed in my computer is the Version 2.9.1(2009-06-26)  of R. I have a
> SPSS.sav file produced by SPSS Version 17.
> 
>  
> 
>  
> 
>> install.('foreign')
> 
>> library(foreign)
> 
>  
> 
> <- read.spss("f:/sme.sav",use.value.labels=FALSE)
> 
> Warning message:
> 
> In read.spss("f:/sme.sav", use.value.labels = FALSE) :
> 
>   f:/sme.sav: Unrecognized record type 7, subtype 18 encountered in system
> file
> 
>  
> 
> I have tried so may times running some conditions I think may have caused
> these errors to recur(including re-installing the R).
> 
>  
> 
> I am at my wit's end on how to make the read.spss work. Please help!

It's a warning, not an error. Did you not get a result returned from
read.spss(...) ??

(This is hardly R-devel material, and your R is a year out of date.)

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From pdalgd at gmail.com  Sat Jul 17 11:11:40 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Sat, 17 Jul 2010 11:11:40 +0200
Subject: [Rd] garbage collection & memory leaks in 'R', it seems...
In-Reply-To: <AANLkTikMqpyyCKq_6WXxG6F70zd2YsZQyjWZPxDFzIK4@mail.gmail.com>
References: <AANLkTikMqpyyCKq_6WXxG6F70zd2YsZQyjWZPxDFzIK4@mail.gmail.com>
Message-ID: <4C4173CC.4080806@gmail.com>

Mike Williamson wrote:
> Hello developers,
> 
>     I noticed that if I am running 'R', type "rm(list=objects())" and
> "gc()", 'R' will still be consuming (a lot) more memory than when I then
> close 'R' and re-open it.  In my ignorance, I'm presuming this is something
> in 'R' where it doesn't really do a great job of garbage collection... at
> least not nearly as well as Windows or unix can do garbage collection.
>     Am I right?  If so, is there any better way to "clean up" the memory
> that 'R' is using?  I have a script that runs a fairly large job, and I
> cannot keep it going on its own in a convenient way because of these
> remnants of garbage that pile up and eventually leave so little memory
> remaining that the script crashes.

In a word, no, R is not particularly bad at GC. The internal gc() does a
rather good job of finding unused objects as you can see from its
returned report. Whether that memory is returned to the OS is a matter
of the C-level services (malloc/free) that R's allocation routines use.

As far as I recall, Windows free() just never returns memory to the OS.
In general, whether it can be done at all depends on which part of the
"heap" you have freed since you have to free from the end of it. (I.e.,
 having a tiny object sitting at the end of the heap will force the
entire range to be kept in memory.)

R itself will allocate from freed-up areas of the heap as long as it can
find a space that is big enough. However, there is always a tendency for
memory to fragmentize so that you eventually have a pattern of many
small objects with not-quite-big-enough holes between them.

These issues affect most languages that do significant amounts of object
allocation and destruction. You should not really compare it to OS level
memory management because that's a different kettle of fish. In
particular, user programs like R relies on having all objects mapped to
a single linear address space, whereas the OS "just" needs to create a
set of per-process virtual address spaces and has hardware help to do so.


-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From nicebread at gmx.net  Sat Jul 17 13:17:11 2010
From: nicebread at gmx.net (=?iso-8859-1?Q?Felix_Sch=F6nbrodt?=)
Date: Sat, 17 Jul 2010 13:17:11 +0200
Subject: [Rd] Precompiled vignette on CRAN
In-Reply-To: <5BE729F0-8380-41ED-8C99-DDFBCF17925B@r-project.org>
References: <24C0C54B-4688-49AA-833A-7A247E2014E3@gmx.net>
	<alpine.LFD.2.00.1007141140530.10475@localhost>
	<5BE729F0-8380-41ED-8C99-DDFBCF17925B@r-project.org>
Message-ID: <3C6696B2-0AD1-4DD0-92C4-7DA9D44861B1@gmx.net>

Thanks for your help on this topic.
In fact, one of the vignettes needs hours to run some simulations; hence I'm going to provide the pdf for CRAN.
> 
> * - which reminds me -- what is the correct place to list vignette dependencies? "Suggests:" ?

I now added a 

%\VignetteDepends{lme4}

statement to the vignette.

Best,
Felix


From simon.urbanek at r-project.org  Sat Jul 17 21:49:08 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 17 Jul 2010 15:49:08 -0400
Subject: [Rd] bug in identical()? [Was: [R-sig-ME] Failure to load lme4 on
	Mac]
In-Reply-To: <4C416EBE.4080204@zeno.co.nz>
References: <C8207D43.4236%mcmahons@si.edu>
	<4BFB0AE0.3090803@zeno.co.nz>	<loom.20100715T175631-148@post.gmane.org>	<AANLkTim4iUokYQZvcL99rhTQkHqIQ5wuESMAGCPu7qGe@mail.gmail.com>	<AANLkTil72csO0XA3-ZghXw62RUp9gMr-Df1Kx8Bi_Iq2@mail.gmail.com>	<AANLkTik15uc4QqaIxcwkhAd4HjpzCQ60MuKqiFDJyJnS@mail.gmail.com>	<08AD950F-C3DB-4E23-868B-0EFD94833014@anu.edu.au>	<AANLkTil7OZ91zRrGf3licxyYQTdgO7QFfLr5CJoyqPc5@mail.gmail.com>	<4C3F9E01.9050804@zeno.co.nz>	<AANLkTimy0SevCeJ87YhFis_fQg-S1ixMwaZF2Bk2K-Jq@mail.gmail.com>	<E1F79CC7-DB81-4916-B847-10C6C02DF2A8@r-project.org>	<loom.20100716T153900-860@post.gmane.org>	<19520.33619.18880.815822@lynne.math.ethz.ch>	<20100717070706.70fg8lchcskskgo0@imp.inserm.fr>
	<7E3C1A13-65AE-4E6F-9EB6-1EEB2B1677C0@anu.edu.au>
	<4C416EBE.4080204@zeno.co.nz>
Message-ID: <D32F4A20-8620-4C43-A316-33CD816ACCF9@r-project.org>

Daniel,

thanks for the test case. I did run it in valgrind but nothing showed up, however ... 

I'm starting to have a suspicion that this has something to do with identical() - look at this:

> identical(M1,M2)
[1] FALSE
> all(serialize(M1,NULL)==serialize(M2,NULL))
[1] TRUE
> identical(unserialize(serialize(M1,NULL)),unserialize(serialize(M2,NULL)))
[1] FALSE
> identical(unserialize(serialize(M1,NULL)),unserialize(serialize(M1,NULL)))
[1] FALSE

So I think this may be a bug in identical() mainly because of the last one. I'll need to take identical() apart to see where it fails ... I'm CCing this to R-devel as the current issue seems more like an R issue so more eyes can have a look ...

Cheers,
Simon


[FWIW this is tested in today's R-devel (with valgrind level 2) on x86_64 OS X 10.6.4 with lme4 from CRAN and Matrix form R-devel Recommended]


On Jul 17, 2010, at 4:50 AM, Daniel Myall wrote:

> I've done some further testing (R 2.11.1) and the issue is not limited to Leopard.
> 
> Using the test:
> 
> library(lme4)
> y <- (1:20)*pi
> x <- (1:20)^2
> group <- gl(2,10)
> for (i in 1:10) {
>  M1 <- lmer (y ~     x + (    x | group))
>  M2 <- lmer (y ~     x + (    x | group))
>  print(identical(M1,M2))
> }
> 
> For CRAN lme4 and Matrix:
> 
> 32 bit on Leopard: R CMD check fails; different results (on most runs)
> 32 bit on Snow Leopard: R CMD check passes; different results (on some runs).
> 64 bit on Snow Leopard: R CMD check passes; identical results
> 
> For SVN version of Matrix with CRAN lme4:
> 
> 32 bit on Snow Leopard: different results (on all runs).
> 64 bit on Snow Leopard: different results (on all runs)
> 
> For SVN version of Matrix with SVN lme4a:
> 
> 32 bit on Snow Leopard: different results (on all runs).
> 64 bit on Snow Leopard: identical results
> 
> I couldn't reproduce on Linux 32/64bit. Is it time to jump into valgrind to try and find the cause?
> 
> Cheers,
> Daniel
> 
> 
> 
> On 17/07/10 5:51 PM, John Maindonald wrote:
>> In principle, maybe a Snow Leopard version might be posted
>> as an alternative, if someone can provide one.  But I take it
>> that the issue is now a bit wider than tests that fail on Leopard
>> vs passing on Snow Leopard?
>>   
> 
> 


From simon.urbanek at r-project.org  Sat Jul 17 22:23:24 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 17 Jul 2010 16:23:24 -0400
Subject: [Rd] bug in identical()? [Was: [R-sig-ME] Failure to load lme4
	on Mac]
In-Reply-To: <D32F4A20-8620-4C43-A316-33CD816ACCF9@r-project.org>
References: <C8207D43.4236%mcmahons@si.edu>
	<4BFB0AE0.3090803@zeno.co.nz>	<loom.20100715T175631-148@post.gmane.org>	<AANLkTim4iUokYQZvcL99rhTQkHqIQ5wuESMAGCPu7qGe@mail.gmail.com>	<AANLkTil72csO0XA3-ZghXw62RUp9gMr-Df1Kx8Bi_Iq2@mail.gmail.com>	<AANLkTik15uc4QqaIxcwkhAd4HjpzCQ60MuKqiFDJyJnS@mail.gmail.com>	<08AD950F-C3DB-4E23-868B-0EFD94833014@anu.edu.au>	<AANLkTil7OZ91zRrGf3licxyYQTdgO7QFfLr5CJoyqPc5@mail.gmail.com>	<4C3F9E01.9050804@zeno.co.nz>	<AANLkTimy0SevCeJ87YhFis_fQg-S1ixMwaZF2Bk2K-Jq@mail.gmail.com>	<E1F79CC7-DB81-4916-B847-10C6C02DF2A8@r-project.org>	<loom.20100716T153900-860@post.gmane.org>	<19520.33619.18880.815822@lynne.math.ethz.ch>	<20100717070706.70fg8lchcskskgo0@imp.inserm.fr>
	<7E3C1A13-65AE-4E6F-9EB6-1EEB2B1677C0@anu.edu.au>
	<4C416EBE.4080204@zeno.co.nz>
	<D32F4A20-8620-4C43-A316-33CD816ACCF9@r-project.org>
Message-ID: <270A5F5A-081B-4310-B269-4795713260BA@r-project.org>

Ok, I think I found the issue. I'm not sure why this varies by platform but the mismatch is due to the @env slot. Two environments are only identical if it is *the* same environment (i.e. the same pointer). However, M1 and M2 have different environments. The content of those environments is identical, but that is irrelevant as it's not the same pointer. Hence identical(M1, M2) fails (and serialize comparison succeeds as it cares only about the content).

So the short story is don't use identical() to compare the models (unless you remove @env first). The long story raises the question whether identical() should really return FALSE for environments like
> identical(new.env(),new.env())
[1] FALSE
I can see arguments both ways but for the purposes of comparing values there should be an option that the above is TRUE.

To be honest I don't see why this has not shown up on other platforms as that is a global issue... (I hope this is the full story - I didn't try all the combinations to see if setting @env to the same environment will appease identical() for all the models)

Cheers,
Simon


On Jul 17, 2010, at 3:49 PM, Simon Urbanek wrote:

> Daniel,
> 
> thanks for the test case. I did run it in valgrind but nothing showed up, however ... 
> 
> I'm starting to have a suspicion that this has something to do with identical() - look at this:
> 
>> identical(M1,M2)
> [1] FALSE
>> all(serialize(M1,NULL)==serialize(M2,NULL))
> [1] TRUE
>> identical(unserialize(serialize(M1,NULL)),unserialize(serialize(M2,NULL)))
> [1] FALSE
>> identical(unserialize(serialize(M1,NULL)),unserialize(serialize(M1,NULL)))
> [1] FALSE
> 
> So I think this may be a bug in identical() mainly because of the last one. I'll need to take identical() apart to see where it fails ... I'm CCing this to R-devel as the current issue seems more like an R issue so more eyes can have a look ...
> 
> Cheers,
> Simon
> 
> 
> [FWIW this is tested in today's R-devel (with valgrind level 2) on x86_64 OS X 10.6.4 with lme4 from CRAN and Matrix form R-devel Recommended]
> 
> 
> On Jul 17, 2010, at 4:50 AM, Daniel Myall wrote:
> 
>> I've done some further testing (R 2.11.1) and the issue is not limited to Leopard.
>> 
>> Using the test:
>> 
>> library(lme4)
>> y <- (1:20)*pi
>> x <- (1:20)^2
>> group <- gl(2,10)
>> for (i in 1:10) {
>> M1 <- lmer (y ~     x + (    x | group))
>> M2 <- lmer (y ~     x + (    x | group))
>> print(identical(M1,M2))
>> }
>> 
>> For CRAN lme4 and Matrix:
>> 
>> 32 bit on Leopard: R CMD check fails; different results (on most runs)
>> 32 bit on Snow Leopard: R CMD check passes; different results (on some runs).
>> 64 bit on Snow Leopard: R CMD check passes; identical results
>> 
>> For SVN version of Matrix with CRAN lme4:
>> 
>> 32 bit on Snow Leopard: different results (on all runs).
>> 64 bit on Snow Leopard: different results (on all runs)
>> 
>> For SVN version of Matrix with SVN lme4a:
>> 
>> 32 bit on Snow Leopard: different results (on all runs).
>> 64 bit on Snow Leopard: identical results
>> 
>> I couldn't reproduce on Linux 32/64bit. Is it time to jump into valgrind to try and find the cause?
>> 
>> Cheers,
>> Daniel
>> 
>> 
>> 
>> On 17/07/10 5:51 PM, John Maindonald wrote:
>>> In principle, maybe a Snow Leopard version might be posted
>>> as an alternative, if someone can provide one.  But I take it
>>> that the issue is now a bit wider than tests that fail on Leopard
>>> vs passing on Snow Leopard?
>>> 
>> 
>> 
> 


From mk2391 at hotmail.com  Mon Jul 19 16:58:35 2010
From: mk2391 at hotmail.com (Martin Kerr)
Date: Mon, 19 Jul 2010 15:58:35 +0100
Subject: [Rd] Non-blocking Eval
Message-ID: <COL117-W11775CC4DBBCB41511CEA7C0BF0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100719/c53849d5/attachment.pl>

From simon.urbanek at r-project.org  Mon Jul 19 17:34:29 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 19 Jul 2010 11:34:29 -0400
Subject: [Rd] Non-blocking Eval
In-Reply-To: <COL117-W11775CC4DBBCB41511CEA7C0BF0@phx.gbl>
References: <COL117-W11775CC4DBBCB41511CEA7C0BF0@phx.gbl>
Message-ID: <A84E66CA-9A25-4991-8533-208FE241AC9E@r-project.org>

On Jul 19, 2010, at 10:58 AM, Martin Kerr wrote:

> 
> Hello,
> I'm currently working with the C++ version of the Rserve Client as part of a student project.
> Is there an implementation of a non-blocking interface to Rserve in C++? I can find one via the Java JRI but no equivalent in C++.

(Please note that stats-rosuda-devel is the correct list for this.)

I'm not quite sure what you mean, because in JRI there is idleEval() which is non-blocking in the sense that it doesn't do anything if R is busy but that doesn't apply to Rserve as by definition R cannot be busy there. There is no non-blocking interface to JRI - all calls are synchronous.

If your question is whether you can start an evaluation in Rserve and not wait for the result then there is CMD_detachedVoidEval in Rserve, but the C++ client only implements a subset of the API which does not include that -- however, it is trivial to implement (just send a request with CMD_detachedVoidEval as there is nothing to decode).

Cheers,
Simon


From guxiaobo1982 at gmail.com  Tue Jul 20 07:20:27 2010
From: guxiaobo1982 at gmail.com (Amber)
Date: Tue, 20 Jul 2010 13:20:27 +0800
Subject: [Rd] Building rattle on Solaris 10u7 X86
Message-ID: <AANLkTinr5ZT4MCiMJsLZJ9cBuGePB5oGf38JDQ5I8-74@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100720/642d1b34/attachment.pl>

From ripley at stats.ox.ac.uk  Tue Jul 20 08:07:57 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 20 Jul 2010 07:07:57 +0100 (BST)
Subject: [Rd] Building rattle on Solaris 10u7 X86
In-Reply-To: <AANLkTinr5ZT4MCiMJsLZJ9cBuGePB5oGf38JDQ5I8-74@mail.gmail.com>
References: <AANLkTinr5ZT4MCiMJsLZJ9cBuGePB5oGf38JDQ5I8-74@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007200641520.4168@gannet.stats.ox.ac.uk>

Our experience is

- the X11 installation on Solaris is too old for these packages.  We 
use the one from OpenCSW (see the R-admin manual).  cairographics in 
particular has moved on a lot since the 2005 release of Solaris 10 
(cairo reached version 1.0 after that).

- we failed to build RGtk2 with the SunStudio compiler, and had to use 
gcc.

Note that nothing in this message is about 'building rattle' (your 
subject line): it is about installing packages rattle's GUI depends 
on.  Let me warn you that rattle doesn't just depend on RGtk2, it 
depends on RGtk2 built with libglade2 support: which is optional and 
not installed by default on Solaris (and often not elsewhere).

Note that in R terminolgy (see Writing R Extensions), building a 
package (R CMD build) is not the same thing as installing one (R CMD 
INSTALL).

On Tue, 20 Jul 2010, Amber wrote:

> We have tried to build rattle on Solaris 10 X86 platform, and the results
> are :
> 1.       Package XML and pmml can be built.
> 2.       Package RGtk2 can be built but can?t be installed because the
> installer can?t find GTK on Solaris, but it seems GTK has been preinstalled
> on Solaris 10, but I don?t know how to configure it.
> 3.       There are errors when building the cairoDevice package , the error
> message is
> -bash-3.00$ R CMD INSTALL cairoDevice
> * installing to library '/opt/R/R2-11-1/lib/R/library'
> * installing *source* package 'cairoDevice' ...
> checking for pkg-config... pkg-config
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> /opt/sunstudio12.1/bin/cc  -xc99=all -I/opt/R/R2-11-1/lib/R/include
> -I/usr/include/gtk-2.0 -I/usr/lib/gtk-2.0/include -I/usr/include/atk-1.0
> -I/usr/include/pango-1.0 -I/usr/openwin/include -I/usr/sfw/include
> -I/usr/sfw/include/freetype2 -I/usr/include/glib-2.0
> -I/usr/lib/glib-2.0/include   -g -I/opt/R/R2-11-1/include -I/usr/sfw/include
> -I/opt/sfw/include -I/usr/openwin/share/include    -KPIC  -xO3 -c
> cairoDevice.c -o cairoDevice.o
> "cairoDevice.h", line 3: cannot find include file: <cairo.h>

[Lots of consequences omitted.]

> 4.       The vcd and colorspace package seem dependent on each other.

Not much idea what that means.  You need to install colorspace before 
vcd, but colorspace depends on nothing else.  It 'Suggests' vcd, but 
that is not the same as 'Depends'.  install.packages() will sort 
this out for you.

> Do you have any idear  bout this.
>
> Xiaobo.Gu
>
> 	[[alternative HTML version deleted]]

Please do study the posting guide: people who send HTML demonstrate 
that they have not done so.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Jul 20 12:45:31 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 20 Jul 2010 11:45:31 +0100 (BST)
Subject: [Rd] Suggestion for serialization performance improvement on
 Windows
In-Reply-To: <AANLkTimwIiK0sBwpnhQv9cPS2LJzwsVlTD9splgANzxP@mail.gmail.com>
References: <AANLkTimwIiK0sBwpnhQv9cPS2LJzwsVlTD9splgANzxP@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007090921010.26547@gannet.stats.ox.ac.uk>

On Fri, 9 Jul 2010, Bryan W. Lewis wrote:

> Dear R developers,
>
>  The slow performance of serializing to a raw vector on Windows is an
> issue that has appeared in this list before. It appears to be due to

References?

> the frequent use of realloc from the resize_buffer method in
> serialize.c.
>
> I suggest a more granular, but still incremental, re-allocation of
> memory. For example change near the top of resize_buffer to:
>
> R_size_t newsize = needed + 65536 - (needed % 65536);
>
> or some other similar small multiple of a typical system page size.

for some definition of 'small multiple'

> I have found this to dramatically improve performance of serialization
> to raw vectors on Windows.

However, I didn't and you presented no evidence.  On HB's 2008 example 
your idea achieved for me a speedup of about 3x.  A much better 
speedup (15x) was achieved by switching serialize.c to use the 
alternative malloc used by memory.c, and using a much larger page size 
(e.g. 1Mb) was better still.  But changing the re-allocation strategy 
resulted in a 150x speed up, to levels comparable to decent operating 
systems like Linux and Solaris with the existing code.

(In case it matters, I was using x64 Windows 7.)

Ideally you would have

- given references for your claims

- given examples for why this was too slow for you

- specified an exact patch with performance comparisons for your examples

- given your credentials (see the comment about 'good manners' in the 
R posting guide).  It is very likely that we would not have been able 
to use any patch you supplied without such credentials.

So please test R-devel, and if there is still a problem reply with all 
the details omitted here.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mk2391 at hotmail.com  Tue Jul 20 14:10:05 2010
From: mk2391 at hotmail.com (Martin Kerr)
Date: Tue, 20 Jul 2010 13:10:05 +0100
Subject: [Rd] Non-blocking Eval
In-Reply-To: <A84E66CA-9A25-4991-8533-208FE241AC9E@r-project.org>
References: <COL117-W11775CC4DBBCB41511CEA7C0BF0@phx.gbl>,
	<A84E66CA-9A25-4991-8533-208FE241AC9E@r-project.org>
Message-ID: <COL117-W30C37D77057267045E331EC0A00@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100720/0b98503b/attachment.pl>

From guxiaobo1982 at gmail.com  Tue Jul 20 15:08:45 2010
From: guxiaobo1982 at gmail.com (=?utf-8?B?6aG+5bCP5rOi?=)
Date: Tue, 20 Jul 2010 21:08:45 +0800
Subject: [Rd] Package ff building error on solaris x64 10u7
Message-ID: <002301cb280c$b28ee960$17acbc20$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100720/3b4a935e/attachment.pl>

From ripley at stats.ox.ac.uk  Tue Jul 20 16:20:21 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 20 Jul 2010 15:20:21 +0100 (BST)
Subject: [Rd] Package ff building error on solaris x64 10u7
In-Reply-To: <002301cb280c$b28ee960$17acbc20$@com>
References: <002301cb280c$b28ee960$17acbc20$@com>
Message-ID: <alpine.LFD.2.00.1007201508130.30652@gannet.stats.ox.ac.uk>

This is a known problem, reported to the maintainer months ago.  Try

http://www.stats.ox.ac.uk/pub/RWin/GPLcompliance/ff_2.1-2.1.tar.gz

[You will be able to see which 100+ packages fail on Solaris from the 
CRAN package check pages.]

And please try to send properly formatted text messages: we really 
don't want to read double-spaced output.

On Tue, 20 Jul 2010, ??? wrote:

> Hi again,
>
>         I am trying to building ff on solaris x64 10u7, and failed 
> with the following result:
>
>
>
> -bash-3.00$ R CMD INSTALL ff
>
> * installing to library '/opt/R/R2-11-1/lib/R/library'
>
> * installing *source* package 'ff' ...
>
> checking for gcc... /opt/sunstudio12.1/bin/cc -m64
>
> checking for C compiler default output file name... a.out
>
> checking whether the C compiler works... yes
>
> checking whether we are cross compiling... no
>
> checking for suffix of executables...
>
> checking for suffix of object files... o
>
> checking whether we are using the GNU C compiler... no
>
> checking whether /opt/sunstudio12.1/bin/cc -m64 accepts -g... yes
>
> checking for /opt/sunstudio12.1/bin/cc -m64 option to accept ISO C89... none needed
>
> checking how to run the C preprocessor... /opt/sunstudio12.1/bin/cc -m64 -E
>
> checking for grep that handles long lines and -e... /usr/sfw/bin/ggrep
>
> checking for egrep... /usr/sfw/bin/ggrep -E
>
> checking for ANSI C header files... yes
>
> checking for sys/types.h... yes
>
> checking for sys/stat.h... yes
>
> checking for stdlib.h... yes
>
> checking for string.h... yes
>
> checking for memory.h... yes
>
> checking for strings.h... yes
>
> checking for inttypes.h... yes
>
> checking for stdint.h... yes
>
> checking for unistd.h... yes
>
> checking sys/vfs.h usability... yes
>
> checking sys/vfs.h presence... yes
>
> checking for sys/vfs.h... yes
>
> checking sys/mman.h usability... yes
>
> checking sys/mman.h presence... yes
>
> checking for sys/mman.h... yes
>
> checking sys/file.h usability... yes
>
> checking sys/file.h presence... yes
>
> checking for sys/file.h... yes
>
> checking for sys/stat.h... (cached) yes
>
> checking for unistd.h... (cached) yes
>
> checking fcntl.h usability... yes
>
> checking fcntl.h presence... yes
>
> checking for fcntl.h... yes
>
> checking sys/param.h usability... yes
>
> checking sys/param.h presence... yes
>
> checking for sys/param.h... yes
>
> checking sys/mount.h usability... yes
>
> checking sys/mount.h presence... yes
>
> checking for sys/mount.h... yes
>
> checking for struct statfs.f_iosize... no
>
> checking sys/statfs.h usability... yes
>
> checking sys/statfs.h presence... yes
>
> checking for sys/statfs.h... yes
>
> checking for struct statfs.f_iosize... (cached) no
>
> checking sys/statvfs.h usability... yes
>
> checking sys/statvfs.h presence... yes
>
> checking for sys/statvfs.h... yes
>
> checking for off_t... yes
>
> checking for size_t... yes
>
> checking for special C compiler options needed for large files... no
>
> checking for _FILE_OFFSET_BITS value needed for large files... no
>
> checking for _LARGEFILE_SOURCE value needed for large files... no
>
> checking for fseeko... yes
>
> configure: creating ./config.status
>
> config.status: creating src/ac_config.h
>
> ** libs
>
> /opt/sunstudio12.1/bin/CC -m64 -lCrun -I/opt/R/R2-11-1/lib/R/include  -I/opt/R/R2-11-1/include -I/usr/sfw/include -I/opt/sfw/include -I/usr/openwin/share/include    -KPIC  -xO3 -c Error.cpp -o Error.o
>
> /opt/sunstudio12.1/bin/CC -m64 -lCrun -I/opt/R/R2-11-1/lib/R/include  -I/opt/R/R2-11-1/include -I/usr/sfw/include -I/opt/sfw/include -I/usr/openwin/share/include    -KPIC  -xO3 -c FSInfo_statfs.cpp -o FSInfo_statfs.o
>
> "FSInfo_statfs.cpp", line 50: Error: Could not find a match for statfs(const char*, statfs*) needed in ff::getFSInfo(const char*, ff::FSInfo&).
>
> "FSInfo_statfs.cpp", line 52: Error: f_bavail is not a member of statfs.
>
> "FSInfo_statfs.cpp", line 53: Warning: The variable sfs has not yet been assigned a value.
>
> 2 Error(s) and 1 Warning(s) detected.
>
> *** Error code 2
>
> make: Fatal error: Command failed for target `FSInfo_statfs.o'
>
> ERROR: compilation failed for package 'ff'
>
> * removing '/opt/R/R2-11-1/lib/R/library/ff'
>
> -bash-3.00$
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From guxiaobo1982 at gmail.com  Tue Jul 20 17:01:35 2010
From: guxiaobo1982 at gmail.com (=?utf-8?B?6aG+5bCP5rOi?=)
Date: Tue, 20 Jul 2010 23:01:35 +0800
Subject: [Rd] Building rattle on Solaris 10u7 X86
In-Reply-To: <alpine.LFD.2.00.1007200641520.4168@gannet.stats.ox.ac.uk>
References: <AANLkTinr5ZT4MCiMJsLZJ9cBuGePB5oGf38JDQ5I8-74@mail.gmail.com>
	<alpine.LFD.2.00.1007200641520.4168@gannet.stats.ox.ac.uk>
Message-ID: <003301cb281c$773c7fc0$65b57f40$@com>

Hi Professor Brian Ripley,
	Thanks for your help,

>>Our experience is
>>
>>- the X11 installation on Solaris is too old for these packages.  We
>>use the one from OpenCSW (see the R-admin manual).  cairographics in
>>particular has moved on a lot since the 2005 release of Solaris 10
>>(cairo reached version 1.0 after that).

Do you suggest to use the new X11 from OpenCSW to replace the one shipped with Solaris, and do you have any procedural guides.


>>- we failed to build RGtk2 with the SunStudio compiler, and had to use
>>gcc.

I used SunStudio building R, do we need to use the same compiler for both R and Packages?
I followed the guides in https://www.initworks.com/wiki/pages/viewpage.action?pageId=6521038 to build R with SunStudio, is there some similar guides when using gcc?



>>Note that nothing in this message is about 'building rattle' (your
>>subject line): it is about installing packages rattle's GUI depends
>>on.  Let me warn you that rattle doesn't just depend on RGtk2, it
>>depends on RGtk2 built with libglade2 support: which is optional and
>>not installed by default on Solaris (and often not elsewhere).


Yes, I am trying to install the packages which are dependent by Rattle, and RGtk2 is the first one.

>>Note that in R terminolgy (see Writing R Extensions), building a
>>package (R CMD build) is not the same thing as installing one (R CMD
>>INSTALL).

Actually I am new to R, and don't really know the differences between building and installing packages. The R CMD INSTALL command just can install packages from source code.

Xiaobo Gu


From Thorn.Thaler at rdls.nestle.com  Tue Jul 20 17:18:36 2010
From: Thorn.Thaler at rdls.nestle.com (Thaler, Thorn, LAUSANNE,
	Applied Mathematics)
Date: Tue, 20 Jul 2010 17:18:36 +0200
Subject: [Rd] Telling R CMD check where to find libraries
Message-ID: <F54EF8F1B477CF448729593FE421F6463B43D9@HQVEVE0032.nestle.com>

Hello everybody,

Currently I'm developing a library, which uses some functions from
another package (namely plotrix). Consequently, I listed this dependency
in the DESCRIPTION file. When I try to run "R CMD check mypackage", the
check fails, for the library plotrix cannot be found on the system. As
far as I understood "R CMD check" uses --vanilla implicitly, thus, no
startup files are read. Hence, plotrix cannot be found by "R CMD check",
since it is only installed locally (I've no admin privileges on this
machine) and the path to the library is given in .Rprofile, which in
turn is not read by "R CMD check".

If I provide the flag "-l /path/to/site/libs", it works as expected but
with the side effect that the test installation is carried out in this
directory as well, which I do not like either (this directory should
contain only stable packages and not packages which are still under
construction). So which possibilities do I have?

BR

Thorn


From this.is.mvw at gmail.com  Tue Jul 20 20:15:36 2010
From: this.is.mvw at gmail.com (Mike Williamson)
Date: Tue, 20 Jul 2010 11:15:36 -0700
Subject: [Rd] garbage collection & memory leaks in 'R', it seems...
In-Reply-To: <4C4173CC.4080806@gmail.com>
References: <AANLkTikMqpyyCKq_6WXxG6F70zd2YsZQyjWZPxDFzIK4@mail.gmail.com>
	<4C4173CC.4080806@gmail.com>
Message-ID: <AANLkTilMAMpz8udRp7oDweC_QkLdfDS7mfwitq326a6l@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100720/9acf6a7d/attachment.pl>

From simon.urbanek at r-project.org  Tue Jul 20 20:45:06 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 20 Jul 2010 14:45:06 -0400
Subject: [Rd] Non-blocking Eval
In-Reply-To: <COL117-W30C37D77057267045E331EC0A00@phx.gbl>
References: <COL117-W11775CC4DBBCB41511CEA7C0BF0@phx.gbl>,
	<A84E66CA-9A25-4991-8533-208FE241AC9E@r-project.org>
	<COL117-W30C37D77057267045E331EC0A00@phx.gbl>
Message-ID: <7A0A6598-EA8F-4AC8-A0AF-86307E63F4FE@r-project.org>

Martin,

On Jul 20, 2010, at 8:10 AM, Martin Kerr wrote:

> 
> Sorry I phrased that badly.
> What I'm trying to do is asynchronously add data to R, i.e. a program will periodically dump some readings to the Rserver and then later on another program will run some analysis scripts on them.

That is an entirely different concept - the Rserve control commands (CMD_ctrlEval and CMD_ctrlSource) allow you to do that:  evaluate code in the master server process. All subsequent clients are then working on the updated data.

However, there is no support for control commands in the C++ client so following the same directions you'd have to add it (this time there is truly no data in the response as it is asynchronous so sending the request is sufficient).


> I have managed to add the data via CMD_detachedVoidEval as you suggested. 
> How exactly do I go about attaching to the session again? I know it involves some form of session key that comes back from the detach call, but what from does it take? And how do I use this? 

The detach command will return a 32-byte session key which you use with the attach command. It is opaque to the application. However, this is a whole different story - the assumption was that you only need asynchronous evaluation so you would actually quit R in the client once detached. The session support (detach/attach) is for a different use - if you start a long computation but don't want to wait for the result and only come back later to collect the result.

Cheers,
Simon

PS: please continue the discussion on stat-rosuda-devel as that is the correct place.


> Thanks AgainMartin
>> Subject: Re: [Rd] Non-blocking Eval
>> From: simon.urbanek at r-project.org
>> Date: Mon, 19 Jul 2010 11:34:29 -0400
>> CC: r-devel at r-project.org
>> To: mk2391 at hotmail.com
>> 
>> On Jul 19, 2010, at 10:58 AM, Martin Kerr wrote:
>> 
>>> 
>>> Hello,
>>> I'm currently working with the C++ version of the Rserve Client as part of a student project.
>>> Is there an implementation of a non-blocking interface to Rserve in C++? I can find one via the Java JRI but no equivalent in C++.
>> 
>> (Please note that stats-rosuda-devel is the correct list for this.)
>> 
>> I'm not quite sure what you mean, because in JRI there is idleEval() which is non-blocking in the sense that it doesn't do anything if R is busy but that doesn't apply to Rserve as by definition R cannot be busy there. There is no non-blocking interface to JRI - all calls are synchronous.
>> 
>> If your question is whether you can start an evaluation in Rserve and not wait for the result then there is CMD_detachedVoidEval in Rserve, but the C++ client only implements a subset of the API which does not include that -- however, it is trivial to implement (just send a request with CMD_detachedVoidEval as there is nothing to decode).
>> 
>> Cheers,
>> Simon
>> 
> 		 	   		  
> _________________________________________________________________
> 
> Do you have a story that started on Hotmail? Tell us now
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From chiefmurphy at gmail.com  Tue Jul 20 22:41:36 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Tue, 20 Jul 2010 13:41:36 -0700
Subject: [Rd] Extract callNextMethod "array" calls "matrix"?
Message-ID: <AANLkTinK5QfKH22WxpFwTiQfuqYI2RbUk4zrxkaPvpNo@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100720/86272300/attachment.pl>

From hpages at fhcrc.org  Wed Jul 21 03:01:29 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Tue, 20 Jul 2010 18:01:29 -0700
Subject: [Rd] new bug in install.packages()
Message-ID: <4C4646E9.8070609@fhcrc.org>

Hi,

install.packages() seems to be broken in latest R-devel snapshot
(2010-07-19 r52561) if you are using an
R/R.version$platform-library/x.y directory.

   > .libPaths()
   [1] "/home/hpages/R/x86_64-unknown-linux-gnu-library/2.12"
   [2] "/home/hpages/R-2.12/library"

   > install.packages("car")
   Error in sprintf(gettext(fmt, domain = domain), ...) : too few arguments

Looks like the problem is in these lines (lines 194-197 in
file src/library/utils/R/packages2.R):

   lib <- .libPaths()[1L]
   if (length(.libPaths()) > 1L)
       message(gettextf("Installing package(s) into %s\n(as %s is 
unspecified)",
               sQuote(lib)), domain = NA)

Cheers,
H.


 > sessionInfo()
R version 2.12.0 Under development (unstable) (2010-07-19 r52561)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.utf8       LC_NUMERIC=C
  [3] LC_TIME=en_US.utf8        LC_COLLATE=en_US.utf8
  [5] LC_MONETARY=C             LC_MESSAGES=en_US.utf8
  [7] LC_PAPER=en_US.utf8       LC_NAME=C
  [9] LC_ADDRESS=C              LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_2.12.0


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From Mark.Bravington at csiro.au  Wed Jul 21 04:20:43 2010
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Wed, 21 Jul 2010 12:20:43 +1000
Subject: [Rd] broken link to new features in R-devel: no NEWS file
In-Reply-To: <4C4646E9.8070609@fhcrc.org>
References: <4C4646E9.8070609@fhcrc.org>
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>

Hi

The link from CRAN to "new features in R-devel" hasn't been working for a few days. Specifically, there is no NEWS file in https://svn.r-project.org/R/trunk/, though there is an ONEWS.

The link is in the "Source code for all platforms" subwindow, where it says:

Daily snapshots of current patched and development versions are available here. Please read about <<new features and bug fixes>> before filing corresponding feature requests or bug reports.

Mark

-- 
Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623


From guxiaobo1982 at gmail.com  Wed Jul 21 04:29:56 2010
From: guxiaobo1982 at gmail.com (Amber)
Date: Wed, 21 Jul 2010 10:29:56 +0800
Subject: [Rd] Package RPostgreSQL_0.1-6.tar.gz has been checked and built
In-Reply-To: <002d01cb2818$6e1eceb0$4a5c6c10$@com>
References: <01cb16cf$Blat.v2.2.2$55d1481c@mail.statistik.tu-dortmund.de>
	<4C28B85C.1050607@statistik.tu-dortmund.de>
	<19496.49354.156481.596016@ron.nulle.part>
	<001f01cb267f$01cd3980$0567ac80$@com>
	<19523.2200.166910.321430@ron.nulle.part>
	<002001cb2688$86b35ae0$941a10a0$@com>
	<AANLkTilYxpRzPZF2-owfBlGBCNvJGVlAMQjmeRKurpcT@mail.gmail.com>
	<19525.33881.163305.49208@max.nulle.part>
	<002d01cb2818$6e1eceb0$4a5c6c10$@com>
Message-ID: <AANLkTimy0Zplv-TKPg8UVVVBxtG2C_GbhQ24ektgMBxC@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/52864bc6/attachment.pl>

From guxiaobo1982 at gmail.com  Wed Jul 21 04:45:41 2010
From: guxiaobo1982 at gmail.com (Amber)
Date: Wed, 21 Jul 2010 10:45:41 +0800
Subject: [Rd] Package ff building error on solaris x64 10u7
In-Reply-To: <alpine.LFD.2.00.1007201508130.30652@gannet.stats.ox.ac.uk>
References: <002301cb280c$b28ee960$17acbc20$@com>
	<alpine.LFD.2.00.1007201508130.30652@gannet.stats.ox.ac.uk>
Message-ID: <AANLkTimET6p1L1B4ig2y1-pz_63PwGPj4Jfevz1AGQTy@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/351cebcd/attachment.pl>

From ggrothendieck at gmail.com  Wed Jul 21 06:46:42 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 21 Jul 2010 00:46:42 -0400
Subject: [Rd] broken link to new features in R-devel: no NEWS file
In-Reply-To: <62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>
References: <4C4646E9.8070609@fhcrc.org>
	<62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>
Message-ID: <AANLkTilkjPzjKx6AKMvdIkuwY5tfCFXZ1AhD08z2fxN7@mail.gmail.com>

On Tue, Jul 20, 2010 at 10:20 PM,  <Mark.Bravington at csiro.au> wrote:
> Hi
>
> The link from CRAN to "new features in R-devel" hasn't been working for a few days. Specifically, there is no NEWS file in https://svn.r-project.org/R/trunk/, though there is an ONEWS.
>
> The link is in the "Source code for all platforms" subwindow, where it says:
>
> Daily snapshots of current patched and development versions are available here. Please read about <<new features and bug fixes>> before filing corresponding feature requests or bug reports.
>

It seems now to be at:

https://svn.r-project.org/R/trunk/doc/NEWS.Rd


From ripley at stats.ox.ac.uk  Wed Jul 21 08:27:58 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Jul 2010 07:27:58 +0100 (BST)
Subject: [Rd] broken link to new features in R-devel: no NEWS file
In-Reply-To: <62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>
References: <4C4646E9.8070609@fhcrc.org>
	<62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>
Message-ID: <alpine.LFD.2.00.1007210722070.8753@gannet.stats.ox.ac.uk>

Please report problems with websites to the webmaster: no one else can 
handle them.  I believe that for CRAN the appropriate address is
cran-admin at r-project.org.

On Wed, 21 Jul 2010, Mark.Bravington at csiro.au wrote:

> Hi
>
> The link from CRAN to "new features in R-devel" hasn't been working for a few days. Specifically, there is no NEWS file in https://svn.r-project.org/R/trunk/, though there is an ONEWS.
>
> The link is in the "Source code for all platforms" subwindow, where it says:
>
> Daily snapshots of current patched and development versions are available here. Please read about <<new features and bug fixes>> before filing corresponding feature requests or bug reports.
>
> Mark
>
> -- 
> Mark Bravington
> CSIRO Mathematical & Information Sciences
> Marine Laboratory
> Castray Esplanade
> Hobart 7001
> TAS
>
> ph (+61) 3 6232 5118
> fax (+61) 3 6232 5012
> mob (+61) 438 315 623
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Jul 21 09:04:27 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Jul 2010 08:04:27 +0100 (BST)
Subject: [Rd] Package RPostgreSQL_0.1-6.tar.gz has been checked and built
In-Reply-To: <AANLkTimy0Zplv-TKPg8UVVVBxtG2C_GbhQ24ektgMBxC@mail.gmail.com>
References: <01cb16cf$Blat.v2.2.2$55d1481c@mail.statistik.tu-dortmund.de>
	<4C28B85C.1050607@statistik.tu-dortmund.de>
	<19496.49354.156481.596016@ron.nulle.part>
	<001f01cb267f$01cd3980$0567ac80$@com>
	<19523.2200.166910.321430@ron.nulle.part>
	<002001cb2688$86b35ae0$941a10a0$@com>
	<AANLkTilYxpRzPZF2-owfBlGBCNvJGVlAMQjmeRKurpcT@mail.gmail.com>
	<19525.33881.163305.49208@max.nulle.part>
	<002d01cb2818$6e1eceb0$4a5c6c10$@com>
	<AANLkTimy0Zplv-TKPg8UVVVBxtG2C_GbhQ24ektgMBxC@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007210729420.8753@gannet.stats.ox.ac.uk>

AFAIK, you simply need to put the path to the correct pg_config first 
in your path -- depending how the PostgreSQL installation was done you 
may also need to ensure that its libraries are in your 
LD_LIBRARY_PATH.

Given that this is the third query you have sent to the R lists about 
contributed packages, I think you should consider if you really need 
64-bit R.  32-bit R is simpler to get working on most platforms, 
including Solaris, especially with external software.  I am presuming 
(from the 'bin/amd64') that this is an Opteron/Xeon system, and there 
64-bit software is problematic simply because gcc does not seem to 
work well. (Most often the 'particular errors' are not with Solaris 
but with non-standard conformant code written assuming gcc extensions 
or laxities -- for which the fix is often to use gcc.)

And BTW, you keep on saying 'Solaris 10u7 X64' and I've no idea what 
that is.  The 'at a minimum' information asked for in the posting 
guide will give a correct description.  Solaris has come for 
many years as a 32/64-bit OS, and there is i386 Solaris and Sparc 
Solaris.

On Wed, 21 Jul 2010, Amber wrote:

> Hi Dirk
>       I think there are problems with pg_config, the configure script of
> RPostgreSQL checks for pg_config and got ??checking for pg_config...
> /usr/bin/pg_config??. In Solaris 10u7 X64, three versions of PostgreSQL are
> installed, there are in /usr/postgres/8.2(8.2.9) and
> /usr/postgres/8.3(8.3.3), the corresponding bin files are in
> /usr/postgres/<version>/bin and /usr/postgres/<version>/bin/amd64, and the
> libraries in /usr/bin is 8.1.11 and it seems a 32bit one, and I can??t find
> the 64bit version bins for 8.1.11.
> I'll try uninstall 8.1.11 and install 8.2.9, and my question is how to let
> RPostgreSQL configure script find the 64bit pg_config.
>
>
> Xiaobo Gu
>
> On Tue, Jul 20, 2010 at 10:32 PM, ?????? <guxiaobo1982 at gmail.com> wrote:
>
>> Hi Dirk,
>>
>> I think this discussion should help :
>> http://stackoverflow.com/questions/1836333/how-can-i-compile-64-bit-postgres-bindings-for-perl-on-solaris,
>> are there environment variables I can set to point to 64bit libraries, or I
>> can set the 64bit libraries path /usr/local/psql/lib before /usr/lib, I'll
>> let you know the results tomorrow.
>>
>>
>>
>>
>>
>> Xiaobo.Gu
>>
>> -----Original Message-----
>> From: Dirk Eddelbuettel [mailto:edd at debian.org]
>> Sent: Tuesday, July 20, 2010 7:11 PM
>> To: Amber
>> Cc: Dirk Eddelbuettel; Uwe Ligges
>>  Subject: Re: Package RPostgreSQL_0.1-6.tar.gz has been checked and built
>>
>>
>> Hi Amber,
>>
>> I'm at the useR conference with imperfect connectivity adn can't help much.
>> I
>> also noticed that Solaris often comes up with particular errors -- see Prof
>> Ripley's response to your Rattle query.
>>
>> RPostgresql may be easy to get built, but you may have to adapt
>> configure.in.
>>
>> On 20 July 2010 at 14:08, Amber wrote:
>> | Hi Dirk,
>> | There are problems building RPostgreSQL on 64bit solaris,
>> | The server has preinstalled PostgreSQL 8.1 client and server binaries ,
>> and
>> | we also installed Greenplum SNE 3.3.5.0 server and client installed, but
>> the
>> | postgres user, which I used to build R and RPostgreSQL can't see
>> Greenplum
>> | binaries, the error messages are:
>> |
>> | -bash-3.00$ R CMD INSTALL RPostgreSQL
>> | * installing to library '/opt/R/R2-11-1/lib/R/library'
>> | * installing *source* package 'RPostgreSQL' ...
>> | checking for gcc... /opt/sunstudio12.1/bin/cc -m64
>> | checking for C compiler default output file name... a.out
>> | checking whether the C compiler works... yes
>> | checking whether we are cross compiling... no
>> | checking for suffix of executables...
>> | checking for suffix of object files... o
>> | checking whether we are using the GNU C compiler... no
>> | checking whether /opt/sunstudio12.1/bin/cc -m64 accepts -g... yes
>> | checking for /opt/sunstudio12.1/bin/cc -m64 option to accept ISO C89...
>> none
>> | needed
>> | checking for pg_config... /usr/bin/pg_config
>> | checking for "/usr/include/pgsql/libpq-fe.h"... yes
>>
>> Good!
>>
>> | configure: creating ./config.status
>> | config.status: creating src/Makevars
>> | ** libs
>> | /opt/sunstudio12.1/bin/cc -m64 -xc99=all -G -L/opt/R/R2-11-1/lib
>> | -L/usr/sfw/lib/amd64 -L/usr/lib/amd64 -L/opt/sfw/lib -o RPostgreSQL.so
>> | RS-DBI.o RS-PostgreSQL.o -L/usr/lib -lpq
>> | ld: fatal: file /usr/lib/libpq.so: wrong ELF class: ELFCLASS32
>> | ld: fatal: File processing errors. No output written to RPostgreSQL.so
>>
>> The linker complained about bad objkect files. Looks like you have a wrong
>> or
>> mismatched Pg library.  We'd have to fix that first before RPostgreSQL can
>> be
>> built.
>>
>> Also ask Greenplum if they can help. At least they get paid for this :)
>>
>> Dirk
>>
>> | *** Error code 1
>> | The following command caused the error:
>> | if test  "zRS-DBI.o RS-PostgreSQL.o" != "z"; then \
>> |   echo /opt/sunstudio12.1/bin/cc -m64 -xc99=all -G -L/opt/R/R2-11-1/lib
>> | -L/usr/sfw/lib/amd64 -L/usr/lib/amd64 -L/opt/sfw/lib -o RPostgreSQL.so
>> | RS-DBI.o RS-PostgreSQL.o -L/usr/lib -lpq  ; \
>> |   /opt/sunstudio12.1/bin/cc -m64 -xc99=all -G -L/opt/R/R2-11-1/lib
>> | -L/usr/sfw/lib/amd64 -L/usr/lib/amd64 -L/opt/sfw/lib -o RPostgreSQL.so
>> | RS-DBI.o RS-PostgreSQL.o -L/usr/lib -lpq  ; \
>> | fi
>> | make: Fatal error: Command failed for target `RPostgreSQL.so'
>> | ERROR: compilation failed for package 'RPostgreSQL'
>> | * removing '/opt/R/R2-11-1/lib/R/library/RPostgreSQL
>> |
>> | On Sun, Jul 18, 2010 at 10:50 PM, ?????? <guxiaobo1982 at gmail.com> wrote:
>> |
>> | > Hi,
>> | >        I have successfully built and installed DBI and RPostgreSQL on
>> 32bit
>> | > Solaris, and will repeat in on our 64bit production server tomorrow,
>> I'll
>> | > let you know the results.
>> | >
>> | > We still waiting for the building toolset for win64 to mature.
>> | >
>> | > Xiaobo.Gu
>> | >
>> | >
>> | > -----Original Message-----
>> | > From: Dirk Eddelbuettel [mailto:edd at debian.org]
>> | >  Sent: Sunday, July 18, 2010 9:59 PM
>> | > To: ??????
>> | > Cc: 'Dirk Eddelbuettel'; 'Uwe Ligges'
>> | > Subject: RE: Package RPostgreSQL_0.1-6.tar.gz has been checked and
>> built
>> | >
>> | >
>> | > Hi again,
>> | >
>> | > On 18 July 2010 at 21:41, ?????? wrote:
>> | > | Hi Dirk,
>> | > |       We have tested RPostgreSQL against 64bit RODBC both on the same
>> | > 64bit Windows Server.
>> | > |
>> | > | The Environments are as following:
>> | > |
>> | > | Case 1: 32bit R 2.11.1, 32bit RPostgreSQL,
>> | > | data <- dbGetQuery(con, "select * from optest.colana limit 50000")
>> | > | It takes about 1.5 minute to run
>> | > |
>> | > | Case2: 64bit R 2.11.1, 64bit RODBC, and 64bit DataDirect ODBC to
>> | > Greenplum
>> | > | data <- sqlQuery(con, "select * from optest.colana limit 50000")
>> | > | It runs for at least 10 minutes and still running when I kill the
>> whole R
>> | > process
>> | >
>> | > That's pretty shocking!
>> | >
>> | > | It yields out that RPostgres have great performance advantages, we
>> will
>> | > try to build RPostgreSQL on 64bit Solaris 10 u7 platform next.
>> | >
>> | > Keeping the comparison 'apples to apples' could you build Postgresql on
>> | > Windows 64, so that you could build RPostgreSQL against it?
>> | >
>> | > Dirk
>> | >
>> | > | Xiaobo.Gu
>> | > |
>> | > | -----Original Message-----
>> | > | From: Dirk Eddelbuettel [mailto:edd at debian.org]
>> | > | Sent: Monday, June 28, 2010 11:34 PM
>> | > | To: Uwe Ligges
>> | > | Cc: edd at debian.org; ?????????3??
>> | > | Subject: Re: Package RPostgreSQL_0.1-6.tar.gz has been checked and
>> built
>> | > |
>> | > |
>> | > | Uwe,
>> | > |
>> | > | On 28 June 2010 at 16:57, Uwe Ligges wrote:
>> | > | | Dirk,
>> | > | |
>> | > | | da ist derzeit kein 64-bit PostgreSQL auf winbuilder.
>> | > |
>> | > | I know that -- but it wasn't me but someone who really badly wants
>> this
>> | > on
>> | > | Windows and is seemingly in several threads on the R lists as well as
>> in
>> | > my
>> | > | inbox and who didn't edit the DESCRIPTION file before uploading this.
>> | > |
>> | > | Tschoe,  Dirk
>> | > |
>> | > | |
>> | > | | Gruss,
>> | > | | Uwe
>> | > | |
>> | > | |
>> | > | |
>> | > | | On 28.06.2010 16:36, Uwe.Ligges at R-Project.org wrote:
>> | > | | > Dear package maintainer,
>> | > | | >
>> | > | | > this notification has been generated automatically.
>> | > | | > Your package RPostgreSQL_0.1-6.tar.gz has been built (if working)
>> and
>> | > checked for Windows.
>> | > | | > Please check the log files and (if working) the binary package
>> at:
>> | > | | > http://win-builder.r-project.org/HLQti73j3Y90
>> | > | | > The files will be removed after roughly 72 hours.
>> | > | | > Installation time in seconds: 2
>> | > | | > Check time in seconds: 43
>> | > | | > Check result: ERROR
>> | > | | > R version 2.11.1 (2010-05-31) (64-bit)
>> | > | | >
>> | > | | > All the best,
>> | > | | > Uwe Ligges
>> | > | | > (CRAN maintainer of binary packages for Windows)
>> | > | | >
>> | > |
>> | > | --
>> | > |   Regards, Dirk
>> | > |
>> | >
>> | > --
>> | >  Regards, Dirk
>> | >
>> | >
>>
>> --
>> Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com
>>
>>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From tcs76.geo at yahoo.com  Wed Jul 21 02:05:38 2010
From: tcs76.geo at yahoo.com (Chuen Tan)
Date: Tue, 20 Jul 2010 17:05:38 -0700 (PDT)
Subject: [Rd] Possible reasons for segmentation fault
In-Reply-To: <bxbrpfsbgwp9m3au31b7dq5syy03xh.14462995462.4420@mta903.em.linkedin.com>
Message-ID: <461019.45910.qm@web52508.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100720/33e5084e/attachment.pl>

From ripley at stats.ox.ac.uk  Wed Jul 21 10:43:25 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Jul 2010 09:43:25 +0100 (BST)
Subject: [Rd] Possible reasons for segmentation fault
In-Reply-To: <461019.45910.qm@web52508.mail.re2.yahoo.com>
References: <461019.45910.qm@web52508.mail.re2.yahoo.com>
Message-ID: <alpine.LFD.2.00.1007210936470.32647@gannet.stats.ox.ac.uk>

On Tue, 20 Jul 2010, Chuen Tan wrote:

> Hi,
>
> I have a written a C code for R and used R CMD SHLIB to compile it.
> However, it returns segmentation fault on some 64 bits machines.

What is 'it'?  I presume you may mean trying to use the compiled code 
in R, but what you wrote suggests SHLIB segfaulted -- this almost 
always indicates a compiler bug.

> What are some of the potential reasons for this?

User error - the scope is vast.

> Thanks for the help/advice on the matter.

Read the posting guide (as you sent HTML, we know you haven't -- and 
if you had you would know that we need to know what platform you use) 
and then 'Writing R Extensions' chapter 4.

> Best regards,
> stan
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From guxiaobo1982 at gmail.com  Wed Jul 21 10:43:28 2010
From: guxiaobo1982 at gmail.com (Amber)
Date: Wed, 21 Jul 2010 16:43:28 +0800
Subject: [Rd] Package RPostgreSQL_0.1-6.tar.gz has been checked and built
In-Reply-To: <alpine.LFD.2.00.1007210729420.8753@gannet.stats.ox.ac.uk>
References: <01cb16cf$Blat.v2.2.2$55d1481c@mail.statistik.tu-dortmund.de>
	<4C28B85C.1050607@statistik.tu-dortmund.de>
	<19496.49354.156481.596016@ron.nulle.part>
	<001f01cb267f$01cd3980$0567ac80$@com>
	<19523.2200.166910.321430@ron.nulle.part>
	<002001cb2688$86b35ae0$941a10a0$@com>
	<AANLkTilYxpRzPZF2-owfBlGBCNvJGVlAMQjmeRKurpcT@mail.gmail.com>
	<19525.33881.163305.49208@max.nulle.part>
	<002d01cb2818$6e1eceb0$4a5c6c10$@com>
	<AANLkTimy0Zplv-TKPg8UVVVBxtG2C_GbhQ24ektgMBxC@mail.gmail.com>
	<alpine.LFD.2.00.1007210729420.8753@gannet.stats.ox.ac.uk>
Message-ID: <AANLkTinlbzfOT5ck_yBr2Fs4JX0sJc09mP4mtjODNUsU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/229efdc6/attachment.pl>

From osklyar at ahl.com  Wed Jul 21 11:36:59 2010
From: osklyar at ahl.com (Sklyar, Oleg (London))
Date: Wed, 21 Jul 2010 10:36:59 +0100
Subject: [Rd] Bug: broken exception handling in S4 methods
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430662B360@mildnpexmb01.maninvestments.ad.man.com>

Hi all:

we have noticed for quite a while that certain errors cannot be handled
by R try, tryCatch etc blocks, but it was fairly difficult to understand
what were the conditions for this incorrect behaviour. Finally I stabbed
across a very understandable case, which is outlined in the (runnable)
example below. 

The main message is: wrapping an S4 method call in a try block will not
help if an error occurs in evaluating an argument to such a call; this
works just fine for function calls (as opposed to S4 methods)

The particular example is a result of trying to write a unit test for a
constructor of a class object which should fail under certain
conditions. This failure obviously need to be caught for the unit test
to proceed. However, it is a general problem with handling some
exceptions in R.

# Consider a simple class MyClassA, which is derived from numeric and
for which 
# we define a constructor (in form of a method). On its own this class
works nicely 
# and so does exception handling of it:

setClass("MyClassA",
    contains = "numeric",
    validity = function(object)
    {
        stopifnot(object[1] == object[2])
        TRUE
    }
)


setGeneric("MyClassA", function(x) standardGeneric("MyClassA"))

setMethod("MyClassA",
    signature(x = "numeric"),
    function(x)
    {
        new("MyClassA", x)
    }
)

## OK
er = try({ MyClassA(c(1,2)) })

## OK (error in constructor)
er = try({ MyClassA(c(1,2)) })

## OK (error evaluating argument to a function)
er = try({ sin(MyClassA(c(1,2))) })


# Now consider we define MyClassB that has MyClassA in a slot 
# and we define a constructor that takes such objects:


setClassUnion("MyClassAOrNULL", c("MyClassA", "NULL"))

setClass("MyClassB",
    representation(
        ca = "MyClassAOrNULL"
    ),
    prototype(ca = NULL)
)

setGeneric("MyClassB", function(x) standardGeneric("MyClassB"))

setMethod("MyClassB",
    signature(x = "MyClassA"),
    function(x)
    {
        new("MyClassB", ca = x)
    }
)

## OK
b = MyClassB(MyClassA(c(1,1)))

## FAILS (error evaluating argument to a method)
er = try({ MyClassB(MyClassA(c(1,2))) })

# As you see the last error cannot be handled


# Moreover. If we define a function and a method as function(x) x then 
# the function can be handled by try, yet the method cannot:

f = function(x) x

setGeneric("g", function(x) standardGeneric("g"))
setMethod("g", "MyClassA", function(x) x)

## OK (error evaluating argument to a function)
er = try({ f(MyClassA(c(1,2))) })

## FAILS (error evaluating argument to a method)
er = try({ g(MyClassA(c(1,2))) })



> sessionInfo()
R version 2.11.0 Patched (2010-05-05 r51914) 
x86_64-unknown-linux-gnu 

locale:
 [1] LC_CTYPE=en_GB       LC_NUMERIC=C         LC_TIME=en_GB
LC_COLLATE=en_GB    
 [5] LC_MONETARY=C        LC_MESSAGES=en_GB    LC_PAPER=en_GB
LC_NAME=C           
 [9] LC_ADDRESS=C         LC_TELEPHONE=C       LC_MEASUREMENT=en_GB
LC_IDENTIFICATION=C 

attached base packages:
[1] splines   stats     graphics  utils     datasets  grDevices methods
base     


Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3803
osklyar at ahl.com

**********************************************************************
 Please consider the environment before printing this email or its attachments.
The contents of this email are for the named addressees ...{{dropped:19}}


From therneau at mayo.edu  Wed Jul 21 14:20:46 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Wed, 21 Jul 2010 07:20:46 -0500
Subject: [Rd] Table vs unique
Message-ID: <1279714846.30463.29.camel@punchbuggy>

A bug in the survival routines was reported to me today.  The root cause
is a difference between table, unique, and sort.

> temp <- rep(c(1, sqrt(2)^2, 2), 1:3)
> unique(temp)
[1] 1 2 2
> table(temp)
temp
1 2 
1 5 

  I'm using 2.10 on Linux, the user reported from 2.9 on Windows.  

1. Minor issue: I think the root rounding occurs in factor.  I didn't
see any discussion of this in the help page, perhaps something should be
added.

2. The error popped up in summary.survfit but the root cause is an
inconsistent survfit object.  The survfit routine uses sort and unique
to create the unique survival times and most of the output, but table to
count them for another component.  
  Lumping the two versions of "2.0000...." together is the preferable
output.  I think the best solution will be to preprocess the time
variable so that the three operators are consistent.

	as.numeric(as.character(as.factor(time))) ?

Rather ugly.  But most importantly what is a guarranteed construct that
would ensure consistency?  Should we use a rounding level that is more
or less equivalent to all.equal()?

 The solution will have to be incorporated into survfit, coxph, ...
perhaps a dozen places in the survival suite so I'd like to get it right
the first time.

Terry T


From florian.bw at gmail.com  Wed Jul 21 14:24:28 2010
From: florian.bw at gmail.com (Florian Breitwieser)
Date: Wed, 21 Jul 2010 14:24:28 +0200
Subject: [Rd] =?windows-1252?q?=22Use_of_=91=2EC=92_for_C++_is_now_depreca?=
	=?windows-1252?q?ted_and_will_be_removed_in_R_2=2E12=2E0=22?=
Message-ID: <AANLkTimReZHcXn2gNcX8A2rCIcQKVmQD49krAt9Cp0EO@mail.gmail.com>

Hi,

I am writing a R package and having a bit of trouble to have the C++
code working.

I was planing using the .C interface function, however I found the
comment (Use of ?.C? for C++ is now deprecated and will be removed in
R 2.12.0.) in the R-exts manual.

So this interface function should not be used anymore - .Call() or
Rcpp instead? What is the reason for the deprecation?

Thanks,
Florian


From ripley at stats.ox.ac.uk  Wed Jul 21 15:11:00 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Jul 2010 14:11:00 +0100 (BST)
Subject: [Rd]
	=?iso-8859-7?q?=22Use_of_=A1=2EC=A2_for_C++_is_now_deprecate?=
	=?iso-8859-7?q?d_and_will_be_removed_in_R_2=2E12=2E0=22?=
In-Reply-To: <AANLkTimReZHcXn2gNcX8A2rCIcQKVmQD49krAt9Cp0EO@mail.gmail.com>
References: <AANLkTimReZHcXn2gNcX8A2rCIcQKVmQD49krAt9Cp0EO@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007211403130.12833@gannet.stats.ox.ac.uk>

Please don't pick things out of context.  It does not say .C() is 
deprecated and it is not talking about R code: it says

There are default variables and rules for this (determined when R is 
configured and recorded in R_HOME/etcR_ARCH/Makeconf), providing 
support for C, C++, FORTRAN 77, Fortran 9x, Objective C and Objective 
C++ with associated extensions .c, .cc  or .cpp, .f, .f90 or .f95, 
.m, and .mm or .M, respectively. We recommend using .h  for headers, 
also for C++ or Fortran 9x include files. (Use of .C for C++ is now 
deprecated and will be removed in R 2.12.0.)

You missed 'associated extensions', and that the NEWS file says

     o	Use of file extension .C for C++ code in packages is now
 	deprecated: it has caused problems for some 'make's on
 	case-insensitive file systems (although it currently works
 	with the recommended toolkits).


On Wed, 21 Jul 2010, Florian Breitwieser wrote:

> Hi,
>
> I am writing a R package and having a bit of trouble to have the C++
> code working.
>
> I was planing using the .C interface function, however I found the
> comment (Use of ?.C? for C++ is now deprecated and will be removed in
> R 2.12.0.) in the R-exts manual.
>
> So this interface function should not be used anymore - .Call() or
> Rcpp instead? What is the reason for the deprecation?
>
> Thanks,
> Florian
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Jul 21 15:54:32 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Jul 2010 14:54:32 +0100 (BST)
Subject: [Rd] Table vs unique
In-Reply-To: <1279714846.30463.29.camel@punchbuggy>
References: <1279714846.30463.29.camel@punchbuggy>
Message-ID: <alpine.LFD.2.00.1007211449080.26100@gannet.stats.ox.ac.uk>

I believe this is a misdiagnosis: the 'rounding' is done by 
as.character (as the help for argument 'levels' in ?factor does say) 
and ?as.character has a full explanation (and is linked from the 
relevant part of ?factor).

as.numeric(as.character()) should do the trick.

On Wed, 21 Jul 2010, Terry Therneau wrote:

> A bug in the survival routines was reported to me today.  The root cause
> is a difference between table, unique, and sort.
>
>> temp <- rep(c(1, sqrt(2)^2, 2), 1:3)
>> unique(temp)
> [1] 1 2 2
>> table(temp)
> temp
> 1 2
> 1 5
>
>  I'm using 2.10 on Linux, the user reported from 2.9 on Windows.
>
> 1. Minor issue: I think the root rounding occurs in factor.  I didn't
> see any discussion of this in the help page, perhaps something should be
> added.
>
> 2. The error popped up in summary.survfit but the root cause is an
> inconsistent survfit object.  The survfit routine uses sort and unique
> to create the unique survival times and most of the output, but table to
> count them for another component.
>  Lumping the two versions of "2.0000...." together is the preferable
> output.  I think the best solution will be to preprocess the time
> variable so that the three operators are consistent.
>
> 	as.numeric(as.character(as.factor(time))) ?
>
> Rather ugly.  But most importantly what is a guarranteed construct that
> would ensure consistency?  Should we use a rounding level that is more
> or less equivalent to all.equal()?
>
> The solution will have to be incorporated into survfit, coxph, ...
> perhaps a dozen places in the survival suite so I'd like to get it right
> the first time.
>
> Terry T
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bokov at uthscsa.edu  Wed Jul 21 16:36:57 2010
From: bokov at uthscsa.edu (Alex Bokov)
Date: Wed, 21 Jul 2010 09:36:57 -0500
Subject: [Rd] tcltk resizing when using tkgrid for layout
Message-ID: <4C470609.5090601@uthscsa.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/b3c33ede/attachment.pl>

From djvanderlaan at gmail.com  Wed Jul 21 16:43:12 2010
From: djvanderlaan at gmail.com (Jan van der Laan)
Date: Wed, 21 Jul 2010 16:43:12 +0200
Subject: [Rd] Plot window does not update in embedded code
Message-ID: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>

Dear list,

I am trying to embed R into a C++ program. After some tinkering,
reading the documentation and browsing the source code I have this
more or less working. A very very condensed and very simplified
version of the code is included below.

The program can create plots. However, after the plot is initially
drawn it is no longer updated. When scaling or updating the plot the
window becomes blank, and the window also doesn't want to close. I
suspect that my R_ReadConsole routine is the problem. This routine
waits for user input and returns this (which I thought it should). It
seems that this causes the event loop that updates the windows to also
be on hold. I did have a look at 'Rstd_ReadConsole' in
'src/unix/sys-std.c', but I can't figure out what exactly happens in
this routine.

How do I ensure that the windows keep being updated?

Presently I am working under Linux. However, I also want to be able to
run my code under windows, so I hope there is a cross-platform
solution. Thanks in advance.

Regards,

Jan van der Laan


===== The example code =====
#include <iostream>
#include <iomanip>
#include <string>

static void R_WriteConsoleEx (const char *buf, int buflen, int otype) {
  std::string output(buf, buflen);
  std::cout << output;
}

static void R_WriteConsole (const char *buf, int buflen) {
  R_WriteConsoleEx(buf, buflen, 0);
}

static int R_ReadConsole (const char *prompt, unsigned char *buf, int
buflen, int hist) {
  std::cout << prompt;
  std::string input;
  std::cin >> input;
  for (unsigned int i = 0; i < input.length(); ++i) {
    buf[i] = input[i];
    buf[i+1] = '\n';
    buf[i+2] = '\0';
    if ((int)i >= buflen-3) break;
  }
  return input.length();
}

extern "C" {
#define  R_INTERFACE_PTRS
#include <Rinterface.h>
int Rf_initialize_R(int ac, char **av); /* in ../unix/system.c */
extern int R_running_as_main_program;   /* in ../unix/system.c */
}

int main(int ac, char **av)
{
  R_running_as_main_program = 1;
  Rf_initialize_R(ac, av);
  ptr_R_WriteConsoleEx = &R_WriteConsoleEx;
  ptr_R_WriteConsole = &R_WriteConsole;
  ptr_R_ReadConsole = &R_ReadConsole;
  R_Outputfile = NULL;
  R_Consolefile = NULL;
  Rf_mainloop(); /* does not return */
  return 0;
}


From bokov at uthscsa.edu  Wed Jul 21 17:50:39 2010
From: bokov at uthscsa.edu (Alex Bokov)
Date: Wed, 21 Jul 2010 10:50:39 -0500
Subject: [Rd] tcltk resizing when using tkgrid for layout
In-Reply-To: <4C470609.5090601@uthscsa.edu>
References: <4C470609.5090601@uthscsa.edu>
Message-ID: <4C47174F.2000804@uthscsa.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/053e7fff/attachment.pl>

From jmc at r-project.org  Wed Jul 21 17:58:14 2010
From: jmc at r-project.org (John Chambers)
Date: Wed, 21 Jul 2010 08:58:14 -0700
Subject: [Rd] Extract callNextMethod "array" calls "matrix"?
In-Reply-To: <AANLkTinK5QfKH22WxpFwTiQfuqYI2RbUk4zrxkaPvpNo@mail.gmail.com>
References: <AANLkTinK5QfKH22WxpFwTiQfuqYI2RbUk4zrxkaPvpNo@mail.gmail.com>
Message-ID: <4C471916.6060104@r-project.org>

There does indeed seem to be a bug in the C code that implements 
callNextMethod, with the effect of adding a spurious index to calls to 
the primitive `[` code with more than 2 subscripts.

The message "incorrect number of dimensions" is telling the truth, the 
primitive code gets 4 subscripts instead of 3 (note the "x[i = i, j = j, 
NULL, ...]" in the error message).

Given the time of year, meetings, and the obscurity of this piece of 
code, the bug won't likely be fixed soon, so any workaround that avoids 
the use of callNextMethod on `[` with 3 or more subscripts is a good idea.

On 7/20/10 1:41 PM, Daniel Murphy wrote:
> I have a class that extends array and my method for "[" stops with an error:
>
>> setClass("A", contains="array")
> [1] "A"
>> setMethod("[", "A", function(x, i, j, ..., drop = TRUE) new("A",
> callNextMethod()))
> [1] "["
>> a<-new("A",array(1:12,c(4,3,1)))
>> a
> An object of class "A"
> , , 1
>
>       [,1] [,2] [,3]
> [1,]    1    5    9
> [2,]    2    6   10
> [3,]    3    7   11
> [4,]    4    8   12
>
>> a[1:2,2:3,1]
> Error in x[i = i, j = j, NULL, ...] : incorrect number of dimensions
> Error in callNextMethod() : error in evaluating a 'primitive' next method
>>
>
> A similar error does not occur when extending a matrix:
>> setClass("M", contains="matrix")
> [1] "M"
>> setMethod("[", "M", function(x, i, j, ..., drop = TRUE) new("M",
> callNextMethod()))
> [1] "["
>> a<-new("M",matrix(1:12,4,3))
>> a[1:2,2:3]
> An object of class "M"
>       [,1] [,2]
> [1,]    5    9
> [2,]    6   10
>>
>
> Is there a problem with my method definition for the array-extending class?
>
> My work-around is as follows:
>> setMethod("[", "A", function(x, i, j, ..., drop = TRUE) new("A",
> `[`(as(x,"array"), i=i, j=j, ..., drop=drop)))
> [1] "["
>> a[1:2,2:3,1]
> An object of class "A"
>       [,1] [,2]
> [1,]    5    9
> [2,]    6   10
>>
>
> Cheers,
> Dan
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From chiefmurphy at gmail.com  Wed Jul 21 18:06:43 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Wed, 21 Jul 2010 09:06:43 -0700
Subject: [Rd] Extract callNextMethod "array" calls "matrix"?
In-Reply-To: <4C471916.6060104@r-project.org>
References: <AANLkTinK5QfKH22WxpFwTiQfuqYI2RbUk4zrxkaPvpNo@mail.gmail.com>
	<4C471916.6060104@r-project.org>
Message-ID: <AANLkTikZf8FnzX7iHv1WQSb_AnT05HW0Fb77w5iAUyv9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/82116b87/attachment.pl>

From thomas.friedrichsmeier at ruhr-uni-bochum.de  Wed Jul 21 21:45:39 2010
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 21 Jul 2010 21:45:39 +0200
Subject: [Rd] Plot window does not update in embedded code
In-Reply-To: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
References: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
Message-ID: <201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>

Hi,

On Wednesday 21 July 2010, Jan van der Laan wrote:
> How do I ensure that the windows keep being updated?

in RKWard we run the following periodically during idle phases:


// this basically copied from R's unix/sys-std.c (Rstd_ReadConsole)
#ifndef Q_WS_WIN
	for (;;) {
		fd_set *what;
		what = R_checkActivityEx(R_wait_usec > 0 ? R_wait_usec : 50, 1, 
Rf_onintr);
		R_runHandlers(R_InputHandlers, what);
		if (what == NULL) break;
	}
	/* This seems to be needed to make Rcmdr react to events. Has this always 
been the case? It was commented out for a long time, without anybody noticing. 
*/
	R_PolledEvents ();
#else
	R_ProcessEvents();
#endif


Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100721/c1088344/attachment.bin>

From simon.urbanek at r-project.org  Wed Jul 21 22:28:02 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 21 Jul 2010 16:28:02 -0400
Subject: [Rd] Plot window does not update in embedded code
In-Reply-To: <201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
	<201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <666FFFC7-DA21-4EFE-80D2-B83F481D42B9@r-project.org>

Use
R_CheckUserInterrupt()

The code below is very fragile and unix-specific.

Cheers,
Simon




On Jul 21, 2010, at 3:45 PM, Thomas Friedrichsmeier wrote:

> Hi,
> 
> On Wednesday 21 July 2010, Jan van der Laan wrote:
>> How do I ensure that the windows keep being updated?
> 
> in RKWard we run the following periodically during idle phases:
> 
> 
> // this basically copied from R's unix/sys-std.c (Rstd_ReadConsole)
> #ifndef Q_WS_WIN
> 	for (;;) {
> 		fd_set *what;
> 		what = R_checkActivityEx(R_wait_usec > 0 ? R_wait_usec : 50, 1, 
> Rf_onintr);
> 		R_runHandlers(R_InputHandlers, what);
> 		if (what == NULL) break;
> 	}
> 	/* This seems to be needed to make Rcmdr react to events. Has this always 
> been the case? It was commented out for a long time, without anybody noticing. 
> */
> 	R_PolledEvents ();
> #else
> 	R_ProcessEvents();
> #endif
> 
> 
> Regards
> Thomas
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Wed Jul 21 22:52:15 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 21 Jul 2010 16:52:15 -0400
Subject: [Rd] Plot window does not update in embedded code
In-Reply-To: <666FFFC7-DA21-4EFE-80D2-B83F481D42B9@r-project.org>
References: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
	<201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<666FFFC7-DA21-4EFE-80D2-B83F481D42B9@r-project.org>
Message-ID: <9A7974C8-BC2F-4D3C-B67C-730710419614@r-project.org>


On Jul 21, 2010, at 4:28 PM, Simon Urbanek wrote:

> Use
> R_CheckUserInterrupt()
> 

Actually, the above is true but assumes that you're running R's REPL and not your own R_ReadConsole (it will work even in your ReadConsole but unix handlers are not run in that case so only some events will work).


> The code below is very fragile and unix-specific.
> 

That is true, too, but even after R_ProcessEvenrts refactorization the handlers are still-unix specific so I stand corrected and you still have to run handlers manually (note that you don't need PolledEvents anymore since they are part of the handlers).

Cheers,
Simon


>> 
>> On Wednesday 21 July 2010, Jan van der Laan wrote:
>>> How do I ensure that the windows keep being updated?
>> 
>> in RKWard we run the following periodically during idle phases:
>> 
>> 
>> // this basically copied from R's unix/sys-std.c (Rstd_ReadConsole)
>> #ifndef Q_WS_WIN
>> 	for (;;) {
>> 		fd_set *what;
>> 		what = R_checkActivityEx(R_wait_usec > 0 ? R_wait_usec : 50, 1, 
>> Rf_onintr);
>> 		R_runHandlers(R_InputHandlers, what);
>> 		if (what == NULL) break;
>> 	}
>> 	/* This seems to be needed to make Rcmdr react to events. Has this always 
>> been the case? It was commented out for a long time, without anybody noticing. 
>> */
>> 	R_PolledEvents ();
>> #else
>> 	R_ProcessEvents();
>> #endif
>> 
>> 
>> Regards
>> Thomas
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From maechler at stat.math.ethz.ch  Wed Jul 21 23:22:36 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 21 Jul 2010 23:22:36 +0200
Subject: [Rd] broken link to new features in R-devel: no NEWS file
In-Reply-To: <alpine.LFD.2.00.1007210722070.8753@gannet.stats.ox.ac.uk>
References: <4C4646E9.8070609@fhcrc.org>
	<62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>
	<alpine.LFD.2.00.1007210722070.8753@gannet.stats.ox.ac.uk>
Message-ID: <19527.25884.609829.905646@stat.math.ethz.ch>

>>>>> Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>     on Wed, 21 Jul 2010 07:27:58 +0100 (BST) writes:

    > Please report problems with websites to the webmaster: no
    > one else can handle them.  I believe that for CRAN the
    > appropriate address is cran-admin at r-project.org.

In addition, please let me note that one of the very oldest
"website"s for R *developement*  has been

http://stat.ethz.ch/R-manual/  (used to be called  "R-alpha")

it contains manuals of both "R patched" and "R manual" 
*and* direct links to the "NEWS" of both.

One reason, I have not advertized this very long-living (and
daily updated) web page is that it's really about *NON RELEASED* 
versions of R.

Martin Maechler, ETH ZUrich

    > On Wed, 21 Jul 2010, Mark.Bravington at csiro.au wrote:

    >> Hi
    >> 
    >> The link from CRAN to "new features in R-devel" hasn't
    >> been working for a few days. Specifically, there is no
    >> NEWS file in https://svn.r-project.org/R/trunk/, though
    >> there is an ONEWS.
    >> 
    >> The link is in the "Source code for all platforms"
    >> subwindow, where it says:
    >> 
    >> Daily snapshots of current patched and development
    >> versions are available here. Please read about <<new
    >> features and bug fixes>> before filing corresponding
    >> feature requests or bug reports.
    >> 
    >> Mark
    >> 
    >> -- 
    >> Mark Bravington CSIRO Mathematical & Information Sciences
    >> Marine Laboratory Castray Esplanade Hobart 7001 TAS
    >> 
    >> ph (+61) 3 6232 5118 fax (+61) 3 6232 5012 mob (+61) 438
    >> 315 623
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 

    > -- 
    > Brian D. Ripley,                  ripley at stats.ox.ac.uk
    > Professor of Applied Statistics,
    > http://www.stats.ox.ac.uk/~ripley/ University of Oxford,
    > Tel: +44 1865 272861 (self) 1 South Parks Road, +44 1865
    > 272866 (PA) Oxford OX1 3TG, UK Fax: +44 1865 272595

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From jmc at r-project.org  Thu Jul 22 01:45:14 2010
From: jmc at r-project.org (John Chambers)
Date: Wed, 21 Jul 2010 16:45:14 -0700
Subject: [Rd] Bug: broken exception handling in S4 methods
In-Reply-To: <1A68FCB28DE72F4BA3B967E6506CCE430662B360@mildnpexmb01.maninvestments.ad.man.com>
References: <1A68FCB28DE72F4BA3B967E6506CCE430662B360@mildnpexmb01.maninvestments.ad.man.com>
Message-ID: <4C47868A.5010702@r-project.org>

The problem in this example is (plausibly) that the argument evaluation 
code in method selection itself uses an internal C-level version of 
try(), overriding the user's setting.

If this is the bug, I'll have to defer to more expert advice on whether, 
and if so how, the code can adjust for the current exception handling. 
(There don't seem to be many uses of this R_try() mechanism.)


On 7/21/10 2:36 AM, Sklyar, Oleg (London) wrote:
> Hi all:
>
> we have noticed for quite a while that certain errors cannot be handled
> by R try, tryCatch etc blocks, but it was fairly difficult to understand
> what were the conditions for this incorrect behaviour. Finally I stabbed
> across a very understandable case, which is outlined in the (runnable)
> example below.
>
> The main message is: wrapping an S4 method call in a try block will not
> help if an error occurs in evaluating an argument to such a call; this
> works just fine for function calls (as opposed to S4 methods)
>
> The particular example is a result of trying to write a unit test for a
> constructor of a class object which should fail under certain
> conditions. This failure obviously need to be caught for the unit test
> to proceed. However, it is a general problem with handling some
> exceptions in R.
>
> # Consider a simple class MyClassA, which is derived from numeric and
> for which
> # we define a constructor (in form of a method). On its own this class
> works nicely
> # and so does exception handling of it:
>
> setClass("MyClassA",
>      contains = "numeric",
>      validity = function(object)
>      {
>          stopifnot(object[1] == object[2])
>          TRUE
>      }
> )
>
>
> setGeneric("MyClassA", function(x) standardGeneric("MyClassA"))
>
> setMethod("MyClassA",
>      signature(x = "numeric"),
>      function(x)
>      {
>          new("MyClassA", x)
>      }
> )
>
> ## OK
> er = try({ MyClassA(c(1,2)) })
>
> ## OK (error in constructor)
> er = try({ MyClassA(c(1,2)) })
>
> ## OK (error evaluating argument to a function)
> er = try({ sin(MyClassA(c(1,2))) })
>
>
> # Now consider we define MyClassB that has MyClassA in a slot
> # and we define a constructor that takes such objects:
>
>
> setClassUnion("MyClassAOrNULL", c("MyClassA", "NULL"))
>
> setClass("MyClassB",
>      representation(
>          ca = "MyClassAOrNULL"
>      ),
>      prototype(ca = NULL)
> )
>
> setGeneric("MyClassB", function(x) standardGeneric("MyClassB"))
>
> setMethod("MyClassB",
>      signature(x = "MyClassA"),
>      function(x)
>      {
>          new("MyClassB", ca = x)
>      }
> )
>
> ## OK
> b = MyClassB(MyClassA(c(1,1)))
>
> ## FAILS (error evaluating argument to a method)
> er = try({ MyClassB(MyClassA(c(1,2))) })
>
> # As you see the last error cannot be handled
>
>
> # Moreover. If we define a function and a method as function(x) x then
> # the function can be handled by try, yet the method cannot:
>
> f = function(x) x
>
> setGeneric("g", function(x) standardGeneric("g"))
> setMethod("g", "MyClassA", function(x) x)
>
> ## OK (error evaluating argument to a function)
> er = try({ f(MyClassA(c(1,2))) })
>
> ## FAILS (error evaluating argument to a method)
> er = try({ g(MyClassA(c(1,2))) })
>
>
>
>> sessionInfo()
> R version 2.11.0 Patched (2010-05-05 r51914)
> x86_64-unknown-linux-gnu
>
> locale:
>   [1] LC_CTYPE=en_GB       LC_NUMERIC=C         LC_TIME=en_GB
> LC_COLLATE=en_GB
>   [5] LC_MONETARY=C        LC_MESSAGES=en_GB    LC_PAPER=en_GB
> LC_NAME=C
>   [9] LC_ADDRESS=C         LC_TELEPHONE=C       LC_MEASUREMENT=en_GB
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] splines   stats     graphics  utils     datasets  grDevices methods
> base
>
>
> Dr Oleg Sklyar
> Research Technologist
> AHL / Man Investments Ltd
> +44 (0)20 7144 3803
> osklyar at ahl.com
>
> **********************************************************************
>   Please consider the environment before printing this email or its attachments.
> The contents of this email are for the named addressees ...{{dropped:19}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From friedrich.leisch at stat.uni-muenchen.de  Thu Jul 22 01:52:28 2010
From: friedrich.leisch at stat.uni-muenchen.de (friedrich.leisch at stat.uni-muenchen.de)
Date: Thu, 22 Jul 2010 01:52:28 +0200 (CEST)
Subject: [Rd] broken link to new features in R-devel: no NEWS file
In-Reply-To: <19527.25884.609829.905646@stat.math.ethz.ch>
References: <4C4646E9.8070609@fhcrc.org>
	<62C82B39B8A85E4B95A18F7F7B852F870574B18170@exvic-mbx03.nexus.csiro.au>
	<alpine.LFD.2.00.1007210722070.8753@gannet.stats.ox.ac.uk>
	<19527.25884.609829.905646@stat.math.ethz.ch>
Message-ID: <43930.67.91.130.66.1279756348.squirrel@webmail.lrz-muenchen.de>

>>>>>> Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>>     on Wed, 21 Jul 2010 07:27:58 +0100 (BST) writes:
>
>     > Please report problems with websites to the webmaster: no
>     > one else can handle them.  I believe that for CRAN the
>     > appropriate address is cran-admin at r-project.org.
>
> In addition, please let me note that one of the very oldest
> "website"s for R *developement*  has been
>
> http://stat.ethz.ch/R-manual/  (used to be called  "R-alpha")
>
> it contains manuals of both "R patched" and "R manual"
> *and* direct links to the "NEWS" of both.
>

Original problem now fixed on CRAN.

Best,
Fritz


From yi.wang at unsw.edu.au  Thu Jul 22 01:57:52 2010
From: yi.wang at unsw.edu.au (Yi (Alice) Wang)
Date: Thu, 22 Jul 2010 09:57:52 +1000
Subject: [Rd]
	=?windows-1252?q?=22Use_of_=91=2EC=92_for_C++_is_now_depreca?=
	=?windows-1252?q?ted_and_will_be_removed_in_R_2=2E12=2E0=22?=
In-Reply-To: <AANLkTimReZHcXn2gNcX8A2rCIcQKVmQD49krAt9Cp0EO@mail.gmail.com>
References: <AANLkTimReZHcXn2gNcX8A2rCIcQKVmQD49krAt9Cp0EO@mail.gmail.com>
Message-ID: <AANLkTikG1Hpwog2tbE1lw0Hc8lt8Ri4xu60dks9DubZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100722/be6d68dc/attachment.pl>

From djvanderlaan at gmail.com  Thu Jul 22 09:31:41 2010
From: djvanderlaan at gmail.com (Jan van der Laan)
Date: Thu, 22 Jul 2010 09:31:41 +0200
Subject: [Rd] Plot window does not update in embedded code
In-Reply-To: <9A7974C8-BC2F-4D3C-B67C-730710419614@r-project.org>
References: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
	<201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<666FFFC7-DA21-4EFE-80D2-B83F481D42B9@r-project.org>
	<9A7974C8-BC2F-4D3C-B67C-730710419614@r-project.org>
Message-ID: <AANLkTim7ya982V1w1jgvbAZMohzeywlrqGRifr7n4bLD@mail.gmail.com>

Thomas, Simon,

Thank you for your answers. I will have a look at the code Thomas gave
me and probably also have another look at src/unix/sys-std.c. I'll get
back when I have this working, or, more likely, when I can't get this
to work.

As for the example code. I know it is very fragile. I tried to make a
minimal complete example that showed the problem without having to
attach hundreds of lines of code that nobody will read. However, what
parts are unix specific? Is it the int Rf_initialize_R and
R_running_as_main_program? What non os specific options do I have?

Again thank you for your answers.

Regards,

Jan

On Wed, Jul 21, 2010 at 10:52 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On Jul 21, 2010, at 4:28 PM, Simon Urbanek wrote:
>
>> Use
>> R_CheckUserInterrupt()
>>
>
> Actually, the above is true but assumes that you're running R's REPL and not your own R_ReadConsole (it will work even in your ReadConsole but unix handlers are not run in that case so only some events will work).
>
>
>> The code below is very fragile and unix-specific.
>>
>
> That is true, too, but even after R_ProcessEvenrts refactorization the handlers are still-unix specific so I stand corrected and you still have to run handlers manually (note that you don't need PolledEvents anymore since they are part of the handlers).
>
> Cheers,
> Simon
>
>
>>>
>>> On Wednesday 21 July 2010, Jan van der Laan wrote:
>>>> How do I ensure that the windows keep being updated?
>>>
>>> in RKWard we run the following periodically during idle phases:
>>>
>>>
>>> // this basically copied from R's unix/sys-std.c (Rstd_ReadConsole)
>>> #ifndef Q_WS_WIN
>>> ? ? ?for (;;) {
>>> ? ? ? ? ? ? ?fd_set *what;
>>> ? ? ? ? ? ? ?what = R_checkActivityEx(R_wait_usec > 0 ? R_wait_usec : 50, 1,
>>> Rf_onintr);
>>> ? ? ? ? ? ? ?R_runHandlers(R_InputHandlers, what);
>>> ? ? ? ? ? ? ?if (what == NULL) break;
>>> ? ? ?}
>>> ? ? ?/* This seems to be needed to make Rcmdr react to events. Has this always
>>> been the case? It was commented out for a long time, without anybody noticing.
>>> */
>>> ? ? ?R_PolledEvents ();
>>> #else
>>> ? ? ?R_ProcessEvents();
>>> #endif
>>>
>>>
>>> Regards
>>> Thomas
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From etheber at gmx.de  Thu Jul 22 13:56:26 2010
From: etheber at gmx.de (Thomas Etheber)
Date: Thu, 22 Jul 2010 13:56:26 +0200
Subject: [Rd] Visibility of methods in different namespaces
Message-ID: <4C4831EA.5000908@gmx.de>

Hey folks,

I read plenty of material and started to write some new R-packages, but 
actually I am looking for a solution of the following problem. Perhaps 
it's a beginners question for creating packages, but I wasn't able to 
track it down yet. Hopefully you can provide me with a solution or at 
least some adequate readings.

I have a package say it's called "AAA" with an S4-object say it's called 
"aObject". On the other hand I have a package "BBB" with an S4-object 
called "bObject".
Both objects want to provide the same method to outside users, the 
method is called "calculateModel" and they were implemented in the 
package using the following S3 notation:

Package AAA:
---------------
calculateModel <- function( object, ...) { UseMethod( "calculateModel") }
calculateModel.aObject <- function( object, ..., 
someAdditionalParameters ) { bla bla }

Package BBB:
---------------
calculateModel <- function( object, ...) { UseMethod( "calculateModel") }
calculateModel.bObject <- function( object, ..., 
someAdditionalParameters ) { bla bla }


In the NAMESPACE file of package AAA and package BBB, I registered the 
methods using:

Package AAA:
---------------
S3method( "calculateModel", "aObject" )
export( "calculateModel"  )

Package BBB:
---------------
S3method( "calculateModel", "bObject" )
export( "calculateModel"  )

Everything works fine, when I load only one of the packages. But if I 
load both packages together, one of the calculateModel methods 
disappears and is no longer visible, which results in an error.

What am I missing?

Thanks!
Thomas


From simon.urbanek at r-project.org  Thu Jul 22 16:06:56 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 22 Jul 2010 10:06:56 -0400
Subject: [Rd] Plot window does not update in embedded code
In-Reply-To: <AANLkTim7ya982V1w1jgvbAZMohzeywlrqGRifr7n4bLD@mail.gmail.com>
References: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
	<201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<666FFFC7-DA21-4EFE-80D2-B83F481D42B9@r-project.org>
	<9A7974C8-BC2F-4D3C-B67C-730710419614@r-project.org>
	<AANLkTim7ya982V1w1jgvbAZMohzeywlrqGRifr7n4bLD@mail.gmail.com>
Message-ID: <8D9C1681-68C5-4C70-8ACB-783C49E24E40@r-project.org>


On Jul 22, 2010, at 3:31 AM, Jan van der Laan wrote:

> Thomas, Simon,
> 
> Thank you for your answers. I will have a look at the code Thomas gave
> me and probably also have another look at src/unix/sys-std.c. I'll get
> back when I have this working, or, more likely, when I can't get this
> to work.
> 
> As for the example code. I know it is very fragile. I tried to make a
> minimal complete example that showed the problem without having to
> attach hundreds of lines of code that nobody will read. However, what
> parts are unix specific? Is it the int Rf_initialize_R and
> R_running_as_main_program? What non os specific options do I have?
> 

I was talking about the snippet Thomas sent - not your code - yours was nicely minimalistic. The issue with running the handlers by hand is that it's unix-only. But as I corrected in my second e-mail - it is the way to go right now since there is no alternative at the moment (again, you may get away with simply calling R_CheckUserInterrupt() but some devices may be using input handlers in which case it is not sufficient). The fact that you can check handlers manually is a good thing but it may be worth considering providing an API call like R_idle(int timeoutMillis) that does the job across all platforms.

Cheers,
Simon



> Again thank you for your answers.
> 
> Regards,
> 
> Jan
> 
> On Wed, Jul 21, 2010 at 10:52 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>> 
>> On Jul 21, 2010, at 4:28 PM, Simon Urbanek wrote:
>> 
>>> Use
>>> R_CheckUserInterrupt()
>>> 
>> 
>> Actually, the above is true but assumes that you're running R's REPL and not your own R_ReadConsole (it will work even in your ReadConsole but unix handlers are not run in that case so only some events will work).
>> 
>> 
>>> The code below is very fragile and unix-specific.
>>> 
>> 
>> That is true, too, but even after R_ProcessEvenrts refactorization the handlers are still-unix specific so I stand corrected and you still have to run handlers manually (note that you don't need PolledEvents anymore since they are part of the handlers).
>> 
>> Cheers,
>> Simon
>> 
>> 
>>>> 
>>>> On Wednesday 21 July 2010, Jan van der Laan wrote:
>>>>> How do I ensure that the windows keep being updated?
>>>> 
>>>> in RKWard we run the following periodically during idle phases:
>>>> 
>>>> 
>>>> // this basically copied from R's unix/sys-std.c (Rstd_ReadConsole)
>>>> #ifndef Q_WS_WIN
>>>>      for (;;) {
>>>>              fd_set *what;
>>>>              what = R_checkActivityEx(R_wait_usec > 0 ? R_wait_usec : 50, 1,
>>>> Rf_onintr);
>>>>              R_runHandlers(R_InputHandlers, what);
>>>>              if (what == NULL) break;
>>>>      }
>>>>      /* This seems to be needed to make Rcmdr react to events. Has this always
>>>> been the case? It was commented out for a long time, without anybody noticing.
>>>> */
>>>>      R_PolledEvents ();
>>>> #else
>>>>      R_ProcessEvents();
>>>> #endif
>>>> 
>>>> 
>>>> Regards
>>>> Thomas
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> 


From gb at stat.umu.se  Thu Jul 22 22:54:21 2010
From: gb at stat.umu.se (=?ISO-8859-1?Q?G=F6ran_Brostr=F6m?=)
Date: Thu, 22 Jul 2010 22:54:21 +0200
Subject: [Rd] Table vs unique
In-Reply-To: <alpine.LFD.2.00.1007211449080.26100@gannet.stats.ox.ac.uk>
References: <1279714846.30463.29.camel@punchbuggy>
	<alpine.LFD.2.00.1007211449080.26100@gannet.stats.ox.ac.uk>
Message-ID: <4C48AFFD.9010103@stat.umu.se>

On 07/21/2010 03:54 PM, Prof Brian Ripley wrote:
> I believe this is a misdiagnosis: the 'rounding' is done by
> as.character (as the help for argument 'levels' in ?factor does say)
> and ?as.character has a full explanation (and is linked from the
> relevant part of ?factor).
>
> as.numeric(as.character()) should do the trick.

Or

temp <- signif(temp, digits = 15)

which seems to be much faster.

G?ran B.

>
> On Wed, 21 Jul 2010, Terry Therneau wrote:
>
>> A bug in the survival routines was reported to me today.  The root cause
>> is a difference between table, unique, and sort.
>>
>>> temp<- rep(c(1, sqrt(2)^2, 2), 1:3)
>>> unique(temp)
>> [1] 1 2 2
>>> table(temp)
>> temp
>> 1 2
>> 1 5
>>
>>   I'm using 2.10 on Linux, the user reported from 2.9 on Windows.
>>
>> 1. Minor issue: I think the root rounding occurs in factor.  I didn't
>> see any discussion of this in the help page, perhaps something should be
>> added.
>>
>> 2. The error popped up in summary.survfit but the root cause is an
>> inconsistent survfit object.  The survfit routine uses sort and unique
>> to create the unique survival times and most of the output, but table to
>> count them for another component.
>>   Lumping the two versions of "2.0000...." together is the preferable
>> output.  I think the best solution will be to preprocess the time
>> variable so that the three operators are consistent.
>>
>> 	as.numeric(as.character(as.factor(time))) ?
>>
>> Rather ugly.  But most importantly what is a guarranteed construct that
>> would ensure consistency?  Should we use a rounding level that is more
>> or less equivalent to all.equal()?
>>
>> The solution will have to be incorporated into survfit, coxph, ...
>> perhaps a dozen places in the survival suite so I'd like to get it right
>> the first time.
>>
>> Terry T
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From therneau at mayo.edu  Thu Jul 22 23:30:03 2010
From: therneau at mayo.edu (Therneau, Terry M., Ph.D.)
Date: Thu, 22 Jul 2010 16:30:03 -0500
Subject: [Rd] Table vs unique
In-Reply-To: <4C48AFFD.9010103@stat.umu.se>
References: <1279714846.30463.29.camel@punchbuggy>
	<alpine.LFD.2.00.1007211449080.26100@gannet.stats.ox.ac.uk>
	<4C48AFFD.9010103@stat.umu.se>
Message-ID: <5DBE21404FF5E54C826BE1040C2CD031C91A26@msgebe52.mfad.mfroot.org>


 Thanks to both Brian and Goran for the suggestions.  I've now added the following
to the code: 

    # Round the survival times just a little.  Otherwise unique() and
    #  table() can give a different list of unique times, and both are
    #  used in the subsequent routines.  A test case with times of
    #  sqrt(2)^2 and 2 revealed this issue.  Normally double.digits is
    #  53 in base 2, which leads to 15 decimal digits.
    digits <- floor((.Machine$double.digits -1) * 
                    logb(.Machine$double.base,10)) #base 10 digits
    Y[,1] <- signif(Y[,1], digits)
    if (ncol(Y)==3) Y[,2] <- signif(Y[,2],digits)

It will migrate to CRAN in due course.
   Terry T 

-----Original Message-----
From: G?ran Brostr?m [mailto:gb at stat.umu.se] 
Sent: Thursday, July 22, 2010 3:54 PM
To: Prof Brian Ripley
Cc: Therneau, Terry M., Ph.D.; r-devel at r-project.org
Subject: Re: [Rd] Table vs unique

On 07/21/2010 03:54 PM, Prof Brian Ripley wrote:
> I believe this is a misdiagnosis: the 'rounding' is done by
> as.character (as the help for argument 'levels' in ?factor does say)
> and ?as.character has a full explanation (and is linked from the
> relevant part of ?factor).
>
> as.numeric(as.character()) should do the trick.

Or

temp <- signif(temp, digits = 15)

which seems to be much faster.

G?ran B.

>
> On Wed, 21 Jul 2010, Terry Therneau wrote:
>
>> A bug in the survival routines was reported to me today.  The root cause
>> is a difference between table, unique, and sort.
>>
>>> temp<- rep(c(1, sqrt(2)^2, 2), 1:3)
>>> unique(temp)
>> [1] 1 2 2
>>> table(temp)
>> temp
>> 1 2
>> 1 5
>>
>>   I'm using 2.10 on Linux, the user reported from 2.9 on Windows.
>>
>> 1. Minor issue: I think the root rounding occurs in factor.  I didn't
>> see any discussion of this in the help page, perhaps something should be
>> added.
>>
>> 2. The error popped up in summary.survfit but the root cause is an
>> inconsistent survfit object.  The survfit routine uses sort and unique
>> to create the unique survival times and most of the output, but table to
>> count them for another component.
>>   Lumping the two versions of "2.0000...." together is the preferable
>> output.  I think the best solution will be to preprocess the time
>> variable so that the three operators are consistent.
>>
>> 	as.numeric(as.character(as.factor(time))) ?
>>
>> Rather ugly.  But most importantly what is a guarranteed construct that
>> would ensure consistency?  Should we use a rounding level that is more
>> or less equivalent to all.equal()?
>>
>> The solution will have to be incorporated into survfit, coxph, ...
>> perhaps a dozen places in the survival suite so I'd like to get it right
>> the first time.
>>
>> Terry T
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From cbeleites at units.it  Fri Jul 23 15:18:15 2010
From: cbeleites at units.it (Claudia Beleites)
Date: Fri, 23 Jul 2010 15:18:15 +0200
Subject: [Rd] suggestion for sweep help page
Message-ID: <4C499697.30301@units.it>

Dear all,

I stumbled over the fact that sweep in fact calls FUN with appropriate arrays.
I used to think of it as apply-like to call a function with n-dimensional and 
n-1-dimensional arguments.

I suggest to put a sentence like:

sweep appropriately repeats STATS, and calls FUN with two arrays of the same size.

into the help page to clarify what input FUN should expect.


Claudia



-- 
Claudia Beleites
Dipartimento dei Materiali e delle Risorse Naturali
Universit? degli Studi di Trieste
Via Alfonso Valerio 6/a
I-34127 Trieste

phone: +39 0 40 5 58-37 68
email: cbeleites at units.it


From john_hendrickx at yahoo.com  Sat Jul 24 15:02:14 2010
From: john_hendrickx at yahoo.com (John Hendrickx)
Date: Sat, 24 Jul 2010 06:02:14 -0700 (PDT)
Subject: [Rd] R CMD check - "there is no package called"
Message-ID: <26588.7403.qm@web51804.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100724/c44e4c7b/attachment.pl>

From paul_roebuck at comcast.net  Fri Jul 23 20:46:08 2010
From: paul_roebuck at comcast.net (Paul Roebuck)
Date: Fri, 23 Jul 2010 13:46:08 -0500
Subject: [Rd] Recover source from LazyLoaded installation
Message-ID: <F249B587-EEC5-43CE-9A8A-81E0F1221F64@comcast.net>

Is there a means of recovering the source from a package with LazyLoad = true? Package is Windows 2.9.1 pure R but have no access to original. In R directory, I see <pkgname>, 
<pkgname>.rd[bx], <sysdata>.rd[bx]. Attempting this on OS X 10.6 with R-2.11.1 if it matters.

Sent from my iPhone

From skranz at uni-bonn.de  Sun Jul 25 15:04:22 2010
From: skranz at uni-bonn.de (Sebastian Kranz)
Date: Sun, 25 Jul 2010 15:04:22 +0200
Subject: [Rd] Redefine NROW and NCOL to be compatible with nrow and ncol for
 S3 classes with own dim function?
Message-ID: <4C4C3656.1000604@uni-bonn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100725/5baed9bf/attachment.pl>

From simon.urbanek at r-project.org  Mon Jul 26 02:00:34 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 25 Jul 2010 20:00:34 -0400
Subject: [Rd] R CMD check - "there is no package called"
In-Reply-To: <26588.7403.qm@web51804.mail.re2.yahoo.com>
References: <26588.7403.qm@web51804.mail.re2.yahoo.com>
Message-ID: <0FAAC3FE-862C-4B80-B322-B1957503DDB0@r-project.org>


On Jul 24, 2010, at 9:02 AM, John Hendrickx wrote:

> I'm trying to update my "perturb" package to get rid of some small warning 
> messages. The examples in "perturb" use the "Duncan" dataset from the "car" 
> package and I have "car" installed in R. But when I run "R CMD check", I get an 
> error message 
> 
> 
>> require("car")
> Loading required package: car
> Warning in library(package, lib.loc = lib.loc, character.only = TRUE, 
> logical.return = TRUE,  :
>  there is no package called 'car'
>> data(Duncan)
> Warning in data(Duncan) : data set 'Duncan' not found
> 
> This is very strange, the example works fine if I just run it in R. This is the 
> example from the perturb.rd file:
> 
>  \examples{
> require("car")
> data(Duncan)
> attach(Duncan)
> m1<-lm(prestige~income+education)
> ...
> 
> I'm using R 2.11.1 under Ubuntu 10.04. Perhaps the problem is related to the 
> packages being installed in my home directory. I've create an ~/.Renviron file 
> with 
> 
> R_LIBS_USER="/home/john/lib/R/library"
> 
> I've also tried creating an environment variable "export 
> R_LIBRARY_DIR=/home/john/lib/R/library/" before running R CMD check.

The correct name is R_LIBS

Cheers,
Simon


> That made 
> no difference. Can anyone point me in the right direction? Do I have to install 
> packages in R_HOME?
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From simon.urbanek at r-project.org  Mon Jul 26 02:03:12 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 25 Jul 2010 20:03:12 -0400
Subject: [Rd] Recover source from LazyLoaded installation
In-Reply-To: <F249B587-EEC5-43CE-9A8A-81E0F1221F64@comcast.net>
References: <F249B587-EEC5-43CE-9A8A-81E0F1221F64@comcast.net>
Message-ID: <81B3C76D-F06A-492A-A3BB-009149D69724@r-project.org>


On Jul 23, 2010, at 2:46 PM, Paul Roebuck wrote:

> Is there a means of recovering the source from a package with LazyLoad = true? Package is Windows 2.9.1 pure R but have no access to original. In R directory, I see <pkgname>, 
> <pkgname>.rd[bx], <sysdata>.rd[bx]. Attempting this on OS X 10.6 with R-2.11.1 if it matters.
> 

?lazyLoad

Cheers,
Simon


From ripley at stats.ox.ac.uk  Mon Jul 26 08:58:37 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 26 Jul 2010 07:58:37 +0100 (BST)
Subject: [Rd] Toolchains for x64 Windows
Message-ID: <alpine.LFD.2.00.1007220734540.31062@gannet.stats.ox.ac.uk>

The MinGW-w64 project, whose toolchains we use for 64-bit Windows, 
have made some changes to their conventions *and* removed all the 
older binary builds from their site.  The current toolchains are not 
suitable for use with R 2.11.x, and I've re-packaged an older version 
(which is) as 
http://www.stats.ox.ac.uk/pub/Rtools/oldWin64toolchain.zip

The most critical change is to no longer have an additional leading 
underscore on symbols, and we will adopt that convention for R 2.12.0. 
R-devel is now set up by default to use it: if you have been building 
R-devel with an older toolchain you will need to start afresh with the 
new one, a snapshot of which is at
http://www.stats.ox.ac.uk/pub/Rtools/Win64No_toolchain.zip

The currently recommended tools are (as ever) documented in the 
R-admin manual for the version of R you use.

Static and import libraries (but fortunately not DLLs) are 
incompatible across these changes.  Only a very few binary packages 
(e.g. Rcpp [*]) contain these, but quite a few are built using import 
libraries for external software, and either need the import libraries 
recompiled or to be converted to link directly to DLLs.  (These 
include RCurl RGtk2 cairoDevice hdf5 lossDev png rjags.)  The 
libraries we use for CRAN packages have all been recompiled: these are 
available under

old: http://www.stats.ox.ac.uk/pub/Rtools/goodies/Win64/
new: http://www.stats.ox.ac.uk/pub/Rtools/goodies/Win64No_/

Uwe Ligges does not yet have a build service for R-devel on 
win-builder: it is hoped to have such a service within the next month 
using 32/64-bit builds, the 64-bit part using the new toolchain.

Note that the underscore convention is not the only thing which has 
changed: gcc 4.5.x is used (rather than 4.4.4) and there are extensive 
changes to the headers.  Some of these also necessitate changes to 
packages.

[*] This means that if you use Rcpp the advice is to install from 
sources yourself Rcpp and any packages using it if you are using 
R-devel on Windows.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hb at stat.berkeley.edu  Mon Jul 26 11:15:33 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 26 Jul 2010 11:15:33 +0200
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>
Message-ID: <AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>

Just FYI: Problem remains (on same system) with "R version 2.12.0
Under development (unstable) (2010-07-21 r52590)":

Problem signature:
  Problem Event Name:	APPCRASH
  Application Name:	R.exe
  Application Version:	2.120.52590.0
  Application Timestamp:	4c471362
  Fault Module Name:	R.exe
  Fault Module Version:	2.120.52590.0
  Fault Module Timestamp:	4c471362
  Exception Code:	c0000005
  Exception Offset:	0000240e
  OS Version:	6.0.6002.2.2.0.256.6
  Locale ID:	1033
  Additional Information 1:	8772
  Additional Information 2:	9431192a7274b0ee769861df31ecee58
  Additional Information 3:	f768
  Additional Information 4:	930d06d3f6aed4162dca7601993082f5

Anyone knows if there anything else I can do to provide more debug
information on this?

/Henrik

On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu> wrote:
> Using the latest developers version of R [2.12.0 Under development
> (unstable) (2010-05-21 r52061)], R.exe crashes:
>
> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>
> with Windows reporting:
>
> Problem signature:
> ?Problem Event Name: ? APPCRASH
> ?Application Name: ? ? R.exe
> ?Application Version: ?2.120.52061.0
> ?Application Timestamp: ? ? ? ?4bf638bd
> ?Fault Module Name: ? ?R.exe
> ?Fault Module Version: 2.120.52061.0
> ?Fault Module Timestamp: ? ? ? 4bf638bd
> ?Exception Code: ? ? ? c0000005
> ?Exception Offset: ? ? 00001d94
> ?OS Version: ? 6.0.6002.2.2.0.256.6
> ?Locale ID: ? ?1033
> ?Additional Information 1: ? ? 1c1d
> ?Additional Information 2: ? ? e064c795479179a5f08d19e37de8915e
> ?Additional Information 3: ? ? 50ea
> ?Additional Information 4: ? ? 02a385f4f3dcffff3301c3a9d270f946
>
> same occurs when calling:
>
> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
>
> However,
>
> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
> -e "sessionInfo()"
>
> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> Copyright (C) 2010 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> ?Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>> sessionInfo()
> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> i386-pc-mingw32
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>


From murdoch.duncan at gmail.com  Mon Jul 26 13:30:48 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 26 Jul 2010 07:30:48 -0400
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>
	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>
Message-ID: <4C4D71E8.4090600@gmail.com>

On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
> Just FYI: Problem remains (on same system) with "R version 2.12.0
> Under development (unstable) (2010-07-21 r52590)":
> 
> Problem signature:
>   Problem Event Name:	APPCRASH
>   Application Name:	R.exe
>   Application Version:	2.120.52590.0
>   Application Timestamp:	4c471362
>   Fault Module Name:	R.exe
>   Fault Module Version:	2.120.52590.0
>   Fault Module Timestamp:	4c471362
>   Exception Code:	c0000005
>   Exception Offset:	0000240e
>   OS Version:	6.0.6002.2.2.0.256.6

What is your OS? I don't know the MS numbering scheme...

Duncan Murdoch

>   Locale ID:	1033
>   Additional Information 1:	8772
>   Additional Information 2:	9431192a7274b0ee769861df31ecee58
>   Additional Information 3:	f768
>   Additional Information 4:	930d06d3f6aed4162dca7601993082f5
> 
> Anyone knows if there anything else I can do to provide more debug
> information on this?
> 
> /Henrik
> 
> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu> wrote:
>> Using the latest developers version of R [2.12.0 Under development
>> (unstable) (2010-05-21 r52061)], R.exe crashes:
>>
>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>>
>> with Windows reporting:
>>
>> Problem signature:
>>  Problem Event Name:   APPCRASH
>>  Application Name:     R.exe
>>  Application Version:  2.120.52061.0
>>  Application Timestamp:        4bf638bd
>>  Fault Module Name:    R.exe
>>  Fault Module Version: 2.120.52061.0
>>  Fault Module Timestamp:       4bf638bd
>>  Exception Code:       c0000005
>>  Exception Offset:     00001d94
>>  OS Version:   6.0.6002.2.2.0.256.6
>>  Locale ID:    1033
>>  Additional Information 1:     1c1d
>>  Additional Information 2:     e064c795479179a5f08d19e37de8915e
>>  Additional Information 3:     50ea
>>  Additional Information 4:     02a385f4f3dcffff3301c3a9d270f946
>>
>> same occurs when calling:
>>
>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
>>
>> However,
>>
>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
>> -e "sessionInfo()"
>>
>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>> Copyright (C) 2010 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>> Platform: i386-pc-mingw32/i386 (32-bit)
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>>  Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>> sessionInfo()
>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>> i386-pc-mingw32
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hb at stat.berkeley.edu  Mon Jul 26 16:25:57 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 26 Jul 2010 16:25:57 +0200
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <4C4D71E8.4090600@gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>
	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>
	<4C4D71E8.4090600@gmail.com>
Message-ID: <AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>

Shame on me; I put important only in the subject line.

It's Windows Vista Business 32-bit (Service Pack 2) English with the
latest updates.

/Henrik

On Mon, Jul 26, 2010 at 1:30 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
>>
>> Just FYI: Problem remains (on same system) with "R version 2.12.0
>> Under development (unstable) (2010-07-21 r52590)":
>>
>> Problem signature:
>> ?Problem Event Name: ? APPCRASH
>> ?Application Name: ? ? R.exe
>> ?Application Version: ?2.120.52590.0
>> ?Application Timestamp: ? ? ? ?4c471362
>> ?Fault Module Name: ? ?R.exe
>> ?Fault Module Version: 2.120.52590.0
>> ?Fault Module Timestamp: ? ? ? 4c471362
>> ?Exception Code: ? ? ? c0000005
>> ?Exception Offset: ? ? 0000240e
>> ?OS Version: ? 6.0.6002.2.2.0.256.6
>
> What is your OS? I don't know the MS numbering scheme...
>
> Duncan Murdoch
>
>> ?Locale ID: ? ?1033
>> ?Additional Information 1: ? ? 8772
>> ?Additional Information 2: ? ? 9431192a7274b0ee769861df31ecee58
>> ?Additional Information 3: ? ? f768
>> ?Additional Information 4: ? ? 930d06d3f6aed4162dca7601993082f5
>>
>> Anyone knows if there anything else I can do to provide more debug
>> information on this?
>>
>> /Henrik
>>
>> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu>
>> wrote:
>>>
>>> Using the latest developers version of R [2.12.0 Under development
>>> (unstable) (2010-05-21 r52061)], R.exe crashes:
>>>
>>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>>>
>>> with Windows reporting:
>>>
>>> Problem signature:
>>> ?Problem Event Name: ? APPCRASH
>>> ?Application Name: ? ? R.exe
>>> ?Application Version: ?2.120.52061.0
>>> ?Application Timestamp: ? ? ? ?4bf638bd
>>> ?Fault Module Name: ? ?R.exe
>>> ?Fault Module Version: 2.120.52061.0
>>> ?Fault Module Timestamp: ? ? ? 4bf638bd
>>> ?Exception Code: ? ? ? c0000005
>>> ?Exception Offset: ? ? 00001d94
>>> ?OS Version: ? 6.0.6002.2.2.0.256.6
>>> ?Locale ID: ? ?1033
>>> ?Additional Information 1: ? ? 1c1d
>>> ?Additional Information 2: ? ? e064c795479179a5f08d19e37de8915e
>>> ?Additional Information 3: ? ? 50ea
>>> ?Additional Information 4: ? ? 02a385f4f3dcffff3301c3a9d270f946
>>>
>>> same occurs when calling:
>>>
>>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
>>>
>>> However,
>>>
>>>
>>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
>>> -e "sessionInfo()"
>>>
>>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>>> Copyright (C) 2010 The R Foundation for Statistical Computing
>>> ISBN 3-900051-07-0
>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>>
>>> ?Natural language support but running in an English locale
>>>
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>>
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for an HTML browser interface to help.
>>> Type 'q()' to quit R.
>>>
>>>> sessionInfo()
>>>
>>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>>> i386-pc-mingw32
>>>
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252
>>> [2] LC_CTYPE=English_United States.1252
>>> [3] LC_MONETARY=English_United States.1252
>>> [4] LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch.duncan at gmail.com  Mon Jul 26 17:20:49 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 26 Jul 2010 11:20:49 -0400
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>	<4C4D71E8.4090600@gmail.com>
	<AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>
Message-ID: <4C4DA7D1.9050001@gmail.com>

On 26/07/2010 10:25 AM, Henrik Bengtsson wrote:
> Shame on me; I put important only in the subject line.
>
> It's Windows Vista Business 32-bit (Service Pack 2) English with the
> latest updates.
>   

Oops, didn't notice that.  I don't have a Vista machine to test on.  I 
don't see the crash on a slightly newer build of R on XP SP3 or Windows 7.

If you know of a debugger that can dump a stack trace at the time of the 
crash, that would be helpful information.  (We used to use Dr. Watson 
for this, but I don't think it works in Vista/Win 7.  I've heard of 
something called "userdump", but never tried it.)

Duncan Murdoch
> /Henrik
>
> On Mon, Jul 26, 2010 at 1:30 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
> > On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
> >>
> >> Just FYI: Problem remains (on same system) with "R version 2.12.0
> >> Under development (unstable) (2010-07-21 r52590)":
> >>
> >> Problem signature:
> >>  Problem Event Name:   APPCRASH
> >>  Application Name:     R.exe
> >>  Application Version:  2.120.52590.0
> >>  Application Timestamp:        4c471362
> >>  Fault Module Name:    R.exe
> >>  Fault Module Version: 2.120.52590.0
> >>  Fault Module Timestamp:       4c471362
> >>  Exception Code:       c0000005
> >>  Exception Offset:     0000240e
> >>  OS Version:   6.0.6002.2.2.0.256.6
> >
> > What is your OS? I don't know the MS numbering scheme...
> >
> > Duncan Murdoch
> >
> >>  Locale ID:    1033
> >>  Additional Information 1:     8772
> >>  Additional Information 2:     9431192a7274b0ee769861df31ecee58
> >>  Additional Information 3:     f768
> >>  Additional Information 4:     930d06d3f6aed4162dca7601993082f5
> >>
> >> Anyone knows if there anything else I can do to provide more debug
> >> information on this?
> >>
> >> /Henrik
> >>
> >> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu>
> >> wrote:
> >>>
> >>> Using the latest developers version of R [2.12.0 Under development
> >>> (unstable) (2010-05-21 r52061)], R.exe crashes:
> >>>
> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
> >>>
> >>> with Windows reporting:
> >>>
> >>> Problem signature:
> >>>  Problem Event Name:   APPCRASH
> >>>  Application Name:     R.exe
> >>>  Application Version:  2.120.52061.0
> >>>  Application Timestamp:        4bf638bd
> >>>  Fault Module Name:    R.exe
> >>>  Fault Module Version: 2.120.52061.0
> >>>  Fault Module Timestamp:       4bf638bd
> >>>  Exception Code:       c0000005
> >>>  Exception Offset:     00001d94
> >>>  OS Version:   6.0.6002.2.2.0.256.6
> >>>  Locale ID:    1033
> >>>  Additional Information 1:     1c1d
> >>>  Additional Information 2:     e064c795479179a5f08d19e37de8915e
> >>>  Additional Information 3:     50ea
> >>>  Additional Information 4:     02a385f4f3dcffff3301c3a9d270f946
> >>>
> >>> same occurs when calling:
> >>>
> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
> >>>
> >>> However,
> >>>
> >>>
> >>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
> >>> -e "sessionInfo()"
> >>>
> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> >>> Copyright (C) 2010 The R Foundation for Statistical Computing
> >>> ISBN 3-900051-07-0
> >>> Platform: i386-pc-mingw32/i386 (32-bit)
> >>>
> >>> R is free software and comes with ABSOLUTELY NO WARRANTY.
> >>> You are welcome to redistribute it under certain conditions.
> >>> Type 'license()' or 'licence()' for distribution details.
> >>>
> >>>  Natural language support but running in an English locale
> >>>
> >>> R is a collaborative project with many contributors.
> >>> Type 'contributors()' for more information and
> >>> 'citation()' on how to cite R or R packages in publications.
> >>>
> >>> Type 'demo()' for some demos, 'help()' for on-line help, or
> >>> 'help.start()' for an HTML browser interface to help.
> >>> Type 'q()' to quit R.
> >>>
> >>>> sessionInfo()
> >>>
> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> >>> i386-pc-mingw32
> >>>
> >>> locale:
> >>> [1] LC_COLLATE=English_United States.1252
> >>> [2] LC_CTYPE=English_United States.1252
> >>> [3] LC_MONETARY=English_United States.1252
> >>> [4] LC_NUMERIC=C
> >>> [5] LC_TIME=English_United States.1252
> >>>
> >>> attached base packages:
> >>> [1] stats     graphics  grDevices utils     datasets  methods   base
> >>>
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
>


From rrichte2 at fh-lausitz.de  Mon Jul 26 21:49:00 2010
From: rrichte2 at fh-lausitz.de (rrichte2 at fh-lausitz.de)
Date: Mon, 26 Jul 2010 21:49:00 +0200
Subject: [Rd]  HowTo get callback on destroy of grDevices::windows()
Message-ID: <4C4DE6AC.7050904@fh-lausitz.de>

  I'm build with the usage of the tcltk/tcltk2 package a gui which is

started with rscript.exe. At this gui the user is able to open and close
plot windows.

Now I'm looking for a way that a r function is called when a
grDevices::windows window is closed.
Is there a way to attach a callback function or so, which would be
triggert if the user click at close of the grDevices::window?

My workarround is to check continues the open windows with the tcl
command after, but it's no good workarround.

thanks
roland


From paul_roebuck at comcast.net  Mon Jul 26 11:03:28 2010
From: paul_roebuck at comcast.net (Paul Roebuck)
Date: Mon, 26 Jul 2010 04:03:28 -0500
Subject: [Rd] Recover source from LazyLoaded installation
In-Reply-To: <81B3C76D-F06A-492A-A3BB-009149D69724@r-project.org>
References: <F249B587-EEC5-43CE-9A8A-81E0F1221F64@comcast.net>
	<81B3C76D-F06A-492A-A3BB-009149D69724@r-project.org>
Message-ID: <11903DAF-31E4-42B3-8073-528C37E77BD5@comcast.net>

I had already tried that but can't get past this:
Error: package was built before R 2.10.0: please re-install it

Sent from my iPhone

On Jul 25, 2010, at 7:03 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> 
> On Jul 23, 2010, at 2:46 PM, Paul Roebuck wrote:
> 
>> Is there a means of recovering the source from a package with LazyLoad = true? Package is Windows 2.9.1 pure R but have no access to original. In R directory, I see <pkgname>, 
>> <pkgname>.rd[bx], <sysdata>.rd[bx]. Attempting this on OS X 10.6 with R-2.11.1 if it matters.
>> 
> 
> ?lazyLoad
> 
> Cheers,
> Simon
> 
> 


From ripley at stats.ox.ac.uk  Tue Jul 27 15:26:31 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 27 Jul 2010 14:26:31 +0100 (BST)
Subject: [Rd] Recover source from LazyLoaded installation
In-Reply-To: <11903DAF-31E4-42B3-8073-528C37E77BD5@comcast.net>
References: <F249B587-EEC5-43CE-9A8A-81E0F1221F64@comcast.net>
	<81B3C76D-F06A-492A-A3BB-009149D69724@r-project.org>
	<11903DAF-31E4-42B3-8073-528C37E77BD5@comcast.net>
Message-ID: <alpine.LFD.2.00.1007271415460.17544@gannet.stats.ox.ac.uk>

On Mon, 26 Jul 2010, Paul Roebuck wrote:

> I had already tried that but can't get past this:
> Error: package was built before R 2.10.0: please re-install it

He said use lazyLoad, not library.  It works for me:

env <- new.env()
lazyLoad('R/foo', envir = env)
dump(ls(env, all=TRUE), "foo.R", envir=env)

and BTW this is not going to work if S4 objects are involved and if 
the package had a namespace you'll need the NAMESPACE file (or try to 
recover that from the metadata).

>
> Sent from my iPhone
>
> On Jul 25, 2010, at 7:03 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>
>>
>> On Jul 23, 2010, at 2:46 PM, Paul Roebuck wrote:
>>
>>> Is there a means of recovering the source from a package with 
>>> LazyLoad = true? Package is Windows 2.9.1 pure R but have no 
>>> access to original. In R directory, I see <pkgname>, 
>>> <pkgname>.rd[bx], <sysdata>.rd[bx]. Attempting this on OS X 10.6 
>>> with R-2.11.1 if it matters.
>>>
>>
>> ?lazyLoad
>>
>> Cheers,
>> Simon
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From djsamperi at gmail.com  Tue Jul 27 15:56:23 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Tue, 27 Jul 2010 09:56:23 -0400
Subject: [Rd] CRAN updates?
Message-ID: <AANLkTimtRXqkrQJXqoZrERYRg71ofAw4nCyv9-eo2Cw=@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100727/63033cfc/attachment.pl>

From wdunlap at tibco.com  Tue Jul 27 20:48:56 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Tue, 27 Jul 2010 11:48:56 -0700
Subject: [Rd] problem with zero-weighted observations in predict.lm?
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>

In modelling functions some people like to use
a weight of 0 to drop an observation instead of
using a subset value of FALSE.  E.g.,
  weights=c(0,1,1,...)
instead of
  subset=c(FALSE, TRUE, TRUE, ...)
to drop the first observation.

lm() and summary.lm() appear to treat these in the
same way, decrementing the number of degrees of
freedom for each dropped observation.  However,
predict.lm() does not treat them the same.  It
doesn't seem to diminish the df to account for the
0-weighted observations.   E.g., the last printout
from the following script is as follows, where
predw is the prediction from the fit that used
0-weights and preds is from using FALSE's in the
subset argument.  Is this difference proper?

 predw                        preds                       
 $fit                         $fit                        
        fit      lwr      upr        fit      lwr      upr
 1 1.544302 1.389254 1.699350 1 1.544302 1.194879 1.893724
 2 1.935504 1.719482 2.151526 2 1.935504 1.448667 2.422341
                                                          
 $se.fit                      $se.fit                     
          1          2                1         2         
 0.06723657 0.09367810        0.1097969 0.1529757         
                                                          
 $df                          $df                         
 [1] 8                        [1] 3                       
                                                          
 $residual.scale              $residual.scale             
 [1] 0.1031362                [1] 0.1684207                

### start of script ###
data <- data.frame(x=1:10, y=log(1:10))
fitw <- lm(data=data, y~x, weights=as.numeric(x<=5))
fits <- lm(data=data, y~x, subset=x<=5)
fitw$df.residual  == 3 && fits$df.residual == 3 # TRUE
identical(coef(fitw), coef(fits)) # TRUE

sumw <- summary(fitw)
sums <- summary(fits)
identical(sumw$df, sums$df) # TRUE

predw <- predict(fitw, interval="confidence",
         se.fit=TRUE, newdata=data.frame(x=c(4.5,5.5)))
preds <- predict(fits, interval="confidence",
         se.fit=TRUE, newdata=data.frame(x=c(4.5,5.5)))
all.equal(predw, preds) # lots of differences

sideBySide <- function (a, b, argNames)
{
    # print objects a and b side by side
    oldWidth <- options(width = getOption("width")/2 - 4)
    on.exit(options(oldWidth))
    if (missing(argNames)) {
        argNames <- c(deparse(substitute(a))[1],
                      deparse(substitute(b))[1])
    }
    pa <- capture.output(print(a))
    pb <- capture.output(print(b))
    nlines <- max(length(pa), length(pb))
    length(pa) <- nlines
    length(pb) <- nlines
    pb[is.na(pb)] <- ""
    pa[is.na(pa)] <- ""
    retval <- cbind(pa, pb, deparse.level = 0)
    dimnames(retval) <- list(rep("",nrow(retval)), argNames)
    noquote(retval)
}

# lwr, upr, se.fit, df, residual.scale differ
sideBySide(predw, preds)

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 


From simon.urbanek at r-project.org  Tue Jul 27 22:15:09 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 27 Jul 2010 16:15:09 -0400
Subject: [Rd] CRAN updates?
In-Reply-To: <AANLkTimtRXqkrQJXqoZrERYRg71ofAw4nCyv9-eo2Cw=@mail.gmail.com>
References: <AANLkTimtRXqkrQJXqoZrERYRg71ofAw4nCyv9-eo2Cw=@mail.gmail.com>
Message-ID: <CA7FC08F-14E2-41DE-8C55-D8B6C75A0DD5@r-project.org>


On Jul 27, 2010, at 9:56 AM, Dominick Samperi wrote:

> It appears that after a package is updated the CRAN binaries for some OS's
> are built
> automatically and shortly after the update, while other OS's are not updated
> for
> some time (weeks in some cases).
> 
> Is the process automated or is it partially manual for some OS's (like
> Windows/w64
> and Mac OS X)?
> 

It is automated on Mac OS X (currently R builds start at midnight and package builds at 2am ET).

Cheers,
Simon

PS: If you see delays (i.e. the check result is not available more than two days after the package is available on CRAN) it's a good idea to contact the corresponding binary maintainer (for OS X it's me) since things can break (packages can run mad and external servers can die).


From pdalgd at gmail.com  Tue Jul 27 22:27:43 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Tue, 27 Jul 2010 22:27:43 +0200
Subject: [Rd] problem with zero-weighted observations in predict.lm?
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
References: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
Message-ID: <4C4F413F.5020901@gmail.com>

William Dunlap wrote:
> In modelling functions some people like to use
> a weight of 0 to drop an observation instead of
> using a subset value of FALSE.  E.g.,
>   weights=c(0,1,1,...)
> instead of
>   subset=c(FALSE, TRUE, TRUE, ...)
> to drop the first observation.
> 
> lm() and summary.lm() appear to treat these in the
> same way, decrementing the number of degrees of
> freedom for each dropped observation.  However,
> predict.lm() does not treat them the same.  It
> doesn't seem to diminish the df to account for the
> 0-weighted observations.   E.g., the last printout
> from the following script is as follows, where
> predw is the prediction from the fit that used
> 0-weights and preds is from using FALSE's in the
> subset argument.  Is this difference proper?

Nice catch.

The issue is that the subset fit and the zero-weighted fit are not
completely the same. Notice that the residuals vector has different
length in the two analyses. With a simplified setup:

> length(lm(y~1,weights=w)$residuals)
[1] 10
> length(lm(y~1,subset=-1)$residuals)
[1] 9
> w
 [1] 0 1 1 1 1 1 1 1 1 1

This in turn is what confuses predict.lm because it gets n and residual
df from length(object$residuals). summary.lm() uses NROW(Qr$qr), and I
suppose that predict.lm should follow suit.




> 
>  predw                        preds                       
>  $fit                         $fit                        
>         fit      lwr      upr        fit      lwr      upr
>  1 1.544302 1.389254 1.699350 1 1.544302 1.194879 1.893724
>  2 1.935504 1.719482 2.151526 2 1.935504 1.448667 2.422341
>                                                           
>  $se.fit                      $se.fit                     
>           1          2                1         2         
>  0.06723657 0.09367810        0.1097969 0.1529757         
>                                                           
>  $df                          $df                         
>  [1] 8                        [1] 3                       
>                                                           
>  $residual.scale              $residual.scale             
>  [1] 0.1031362                [1] 0.1684207                
> 
> ### start of script ###
> data <- data.frame(x=1:10, y=log(1:10))
> fitw <- lm(data=data, y~x, weights=as.numeric(x<=5))
> fits <- lm(data=data, y~x, subset=x<=5)
> fitw$df.residual  == 3 && fits$df.residual == 3 # TRUE
> identical(coef(fitw), coef(fits)) # TRUE
> 
> sumw <- summary(fitw)
> sums <- summary(fits)
> identical(sumw$df, sums$df) # TRUE
> 
> predw <- predict(fitw, interval="confidence",
>          se.fit=TRUE, newdata=data.frame(x=c(4.5,5.5)))
> preds <- predict(fits, interval="confidence",
>          se.fit=TRUE, newdata=data.frame(x=c(4.5,5.5)))
> all.equal(predw, preds) # lots of differences
> 
> sideBySide <- function (a, b, argNames)
> {
>     # print objects a and b side by side
>     oldWidth <- options(width = getOption("width")/2 - 4)
>     on.exit(options(oldWidth))
>     if (missing(argNames)) {
>         argNames <- c(deparse(substitute(a))[1],
>                       deparse(substitute(b))[1])
>     }
>     pa <- capture.output(print(a))
>     pb <- capture.output(print(b))
>     nlines <- max(length(pa), length(pb))
>     length(pa) <- nlines
>     length(pb) <- nlines
>     pb[is.na(pb)] <- ""
>     pa[is.na(pa)] <- ""
>     retval <- cbind(pa, pb, deparse.level = 0)
>     dimnames(retval) <- list(rep("",nrow(retval)), argNames)
>     noquote(retval)
> }
> 
> # lwr, upr, se.fit, df, residual.scale differ
> sideBySide(predw, preds)
> 
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From Thorn.Thaler at rdls.nestle.com  Wed Jul 28 11:12:51 2010
From: Thorn.Thaler at rdls.nestle.com (Thaler, Thorn, LAUSANNE,
	Applied Mathematics)
Date: Wed, 28 Jul 2010 11:12:51 +0200
Subject: [Rd] nlme: augPred.lme for factor covariates
Message-ID: <F54EF8F1B477CF448729593FE421F6463DA100@HQVEVE0032.nestle.com>

Hi everybody,

as you may be aware the function augPred.lme does not work as soon as
the covariate is a factor. The problem lies in the line

newprimary <- seq(from = minimum, to = maximum, length.out = length.out)

which does not make sense for factors. I think augPred.lme can be useful
for models with a factor covariate as well. Thus, I propose to change
the code to:

augPred.lme <- function (object, primary = NULL, minimum = min(primary),
maximum = max(primary), 
    length.out = 51, level = Q, newprim = NULL, ...) 
{
    data <- eval(object$call$data)
    if (!inherits(data, "data.frame")) {
        stop(paste("Data in", substitute(object), "call must evaluate to
a data frame"))
    }
    if (is.null(primary)) {
        if (!inherits(data, "groupedData")) {
            stop(paste(sys.call()[[1]], "without \"primary\" can only be
used with fits of groupedData objects"))
        }
        primary <- getCovariate(data)
        prName <- deparse(getCovariateFormula(data)[[2]])
    }
    else {
        primary <- asOneSidedFormula(primary)[[2]]
        prName <- deparse(primary)
        primary <- eval(primary, data)
    }
    # allow for non numeric covariates #
    if (!is.null(newprim)) {
        newprimary <- newprim
    } else if (is.numeric(primary)) {
    	  newprimary <- seq(from = minimum, to = maximum, length.out =
length.out)
    } else {
        warning("'primary' is not numeric. Provide either 'newprim' or
use a numeric primary")
        newprimary <- primary
    }
[...]

The function now takes an additional parameter newprim. The user thus
can explicitly specify the values based on which the prediction should
be made. Additionally, if the user does not provide newprim and the
primary is not a numeric a warning is issued and the predictions are
based on the original values.

Any feedback appreciated.

BR, Thorn


From j.hadfield at ed.ac.uk  Tue Jul 27 22:37:09 2010
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 27 Jul 2010 21:37:09 +0100
Subject: [Rd] R CMD build wiped my computer
Message-ID: <20100727213709.q1q0u1fm4ooo880s@www.staffmail.ed.ac.uk>

Hi,

I ran R (version 2.9.0) CMD build under root in Fedora (9). When it  
tried to remove "junk files" it removed EVERYTHING in my local  
account! (See below).

Can anyone tell me what happened, and even more importantly if I can I  
restore what was lost.

Panickingly,

Jarrod

[jarrod at localhost AManal]$ R CMD build MCMCglmm_2.05
* checking for file 'MCMCglmm_2.05/DESCRIPTION' ... OK
* preparing 'MCMCglmm_2.05':
* checking DESCRIPTION meta-information ... OK
* cleaning src
* installing the package to re-build vignettes
* Installing *source* package ?MCMCglmm? ...
** libs
g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
-Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
--param=ssp-buffer-size=4 -m64 -mtune=generic -c MCMCglmm.cc -o  
MCMCglmm.o
MCMCglmm.cc: In function ?void MCMCglmm(double*, double*, double*,  
int*, int*, int*, int*, int*, int*, double*, int*, int*, double*,  
int*, int*, double*, double*, int*, int*, int*, int*, int*, int*,  
int*, int*, int*, int*, double*, double*, double*, int*, int*, int*,  
int*, double*, double*, double*, int*, double*, bool*, double*,  
double*, int*, int*, int*, int*, int*, double*, int*, int*, int*,  
double*, double*, double*, int*, int*, double*, int*, int*, int*,  
int*, double*, double*, double*, double*)?:
MCMCglmm.cc:228: warning: ?pvLS? may be used uninitialized in this function
MCMCglmm.cc:227: warning: ?pvLL? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?Lrv? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?pmuL? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?pvL? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?LambdaX? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?bv_tmp? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?bv? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?A? may be used uninitialized in this function
MCMCglmm.cc:86: warning: ?dimG? may be used uninitialized in this function
MCMCglmm.cc:228: warning: ?AlphainvS? may be used uninitialized in  
this function
MCMCglmm.cc:227: warning: ?AlphainvL? may be used uninitialized in  
this function
MCMCglmm.cc:225: warning: ?alphalocation_tmp? may be used  
uninitialized in this function
MCMCglmm.cc:225: warning: ?alphalocation? may be used uninitialized in  
this function
MCMCglmm.cc:225: warning: ?alphazstar? may be used uninitialized in  
this function
MCMCglmm.cc:225: warning: ?alphapred? may be used uninitialized in  
this function
MCMCglmm.cc:225: warning: ?alphaastar? may be used uninitialized in  
this function
MCMCglmm.cc:225: warning: ?muAlpha? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?Alphainv? may be used uninitialized in this  
function
MCMCglmm.cc:225: warning: ?tXalpha? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?Xalpha? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?linky_orig? may be used uninitialized in  
this function
MCMCglmm.cc:228: warning: ?tYKrinvYS? may be used uninitialized in  
this function
MCMCglmm.cc:228: warning: ?LambdaS? may be used uninitialized in this function
MCMCglmm.cc:227: warning: ?tYKrinvYL? may be used uninitialized in  
this function
MCMCglmm.cc:227: warning: ?LambdaLU? may be used uninitialized in this  
function
MCMCglmm.cc:225: warning: ?tYKrinvY? may be used uninitialized in this  
function
MCMCglmm.cc:225: warning: ?tYKrinv? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?ILY? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?tY? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?Y? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?I? may be used uninitialized in this function
MCMCglmm.cc:228: warning: ?alphaS? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?alphaMME? may be used uninitialized in this  
function
MCMCglmm.cc:225: warning: ?alphaM? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?XtmKRinv? may be used uninitialized in this  
function
MCMCglmm.cc:227: warning: ?alphaL? may be used uninitialized in this function
MCMCglmm.cc:227: warning: ?L? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?alphaastar_tmp? may be used uninitialized  
in this function
MCMCglmm.cc:225: warning: ?dev? may be used uninitialized in this function
MCMCglmm.cc:225: warning: ?astar_tmp? may be used uninitialized in  
this function
MCMCglmm.cc:225: warning: ?Worig? may be used uninitialized in this function
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_add.c -o cs_add.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_addR.c -o cs_addR.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_amd.c -o cs_amd.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_cbind.c -o cs_cbind.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_chol.c -o cs_chol.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_cholsol.c -o cs_cholsol.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_compress.c -o cs_compress.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_counts.c -o cs_counts.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_cov2cor.c -o cs_cov2cor.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_cumsum.c -o cs_cumsum.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_dcmvnorm.c -o cs_dcmvnorm.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_dfs.c -o cs_dfs.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_directsum.c -o cs_directsum.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_directsumupdate.c -o cs_directsumupdate.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_dmperm.c -o cs_dmperm.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_dmvnorm.c -o cs_dmvnorm.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_droptol.c -o cs_droptol.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_dropzeros.c -o cs_dropzeros.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_dupl.c -o cs_dupl.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_entry.c -o cs_entry.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_ereach.c -o cs_ereach.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_etree.c -o cs_etree.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_fkeep.c -o cs_fkeep.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_gaxpy.c -o cs_gaxpy.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_happly.c -o cs_happly.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_house.c -o cs_house.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_inv.c -o cs_inv.o
cs_inv.c: In function ?cs_inv?:
cs_inv.c:9: warning: ?irow? may be used uninitialized in this function
cs_inv.c:9: warning: ?icol? may be used uninitialized in this function
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_invR.c -o cs_invR.o
cs_invR.c: In function ?cs_invR?:
cs_invR.c:9: warning: ?irow? may be used uninitialized in this function
cs_invR.c:9: warning: ?icol? may be used uninitialized in this function
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_ipvec.c -o cs_ipvec.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_kroneckerA.c -o cs_kroneckerA.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_kroneckerAupdate.c -o cs_kroneckerAupdate.o
cs_kroneckerAupdate.c: In function ?cs_kroneckerAupdate?:
cs_kroneckerAupdate.c:5: warning: unused variable ?Cp?
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_kroneckerH.c -o cs_kroneckerH.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_kroneckerI.c -o cs_kroneckerI.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_kroneckerIupdate.c -o cs_kroneckerIupdate.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_leaf.c -o cs_leaf.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_load.c -o cs_load.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_lsolve.c -o cs_lsolve.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_ltsolve.c -o cs_ltsolve.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_lu.c -o cs_lu.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_lusol.c -o cs_lusol.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_malloc.c -o cs_malloc.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_maxtrans.c -o cs_maxtrans.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_multiply.c -o cs_multiply.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_norm.c -o cs_norm.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_omega.c -o cs_omega.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_omegaupdate.c -o cs_omegaupdate.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_permute.c -o cs_permute.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_pinv.c -o cs_pinv.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_post.c -o cs_post.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_print.c -o cs_print.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_pvec.c -o cs_pvec.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_qr.c -o cs_qr.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_qrsol.c -o cs_qrsol.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_rCinvwishart.c -o cs_rCinvwishart.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_rR.c -o cs_rR.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_randperm.c -o cs_randperm.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_reach.c -o cs_reach.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_rinvwishart.c -o cs_rinvwishart.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_rwishart.c -o cs_rwishart.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_scatter.c -o cs_scatter.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_scc.c -o cs_scc.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_schol.c -o cs_schol.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_sortdv.c -o cs_sortdv.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_spsolve.c -o cs_spsolve.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_sqr.c -o cs_sqr.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_symperm.c -o cs_symperm.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_tdfs.c -o cs_tdfs.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_tmultiplyupdate.c -o cs_tmultiplyupdate.o
cs_tmultiplyupdate.c: In function ?cs_tmultiplyupdate?:
cs_tmultiplyupdate.c:16: warning: unused variable ?Cx?
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_transpose.c -o cs_transpose.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_updown.c -o cs_updown.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_usolve.c -o cs_usolve.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_util.c -o cs_util.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
cs_utsolve.c -o cs_utsolve.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
dcutopints.c -o dcutopints.o
g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
-Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
--param=ssp-buffer-size=4 -m64 -mtune=generic -c inverseA.cc -o  
inverseA.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
lpzF.c -o lpzF.o
g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
-Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
--param=ssp-buffer-size=4 -m64 -mtune=generic -c rIW.cc -o rIW.o
g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
-Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
--param=ssp-buffer-size=4 -m64 -mtune=generic -c rbv.cc -o rbv.o
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
-fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
rtnorm.c -o rtnorm.o
g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
-Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
--param=ssp-buffer-size=4 -m64 -mtune=generic -c rtnormR.cc -o rtnormR.o
g++ -m64 -shared -L/usr/local/lib64 -o MCMCglmm.so MCMCglmm.o cs_add.o  
cs_addR.o cs_amd.o cs_cbind.o cs_chol.o cs_cholsol.o cs_compress.o  
cs_counts.o cs_cov2cor.o cs_cumsum.o cs_dcmvnorm.o cs_dfs.o  
cs_directsum.o cs_directsumupdate.o cs_dmperm.o cs_dmvnorm.o  
cs_droptol.o cs_dropzeros.o cs_dupl.o cs_entry.o cs_ereach.o  
cs_etree.o cs_fkeep.o cs_gaxpy.o cs_happly.o cs_house.o cs_inv.o  
cs_invR.o cs_ipvec.o cs_kroneckerA.o cs_kroneckerAupdate.o  
cs_kroneckerH.o cs_kroneckerI.o cs_kroneckerIupdate.o cs_leaf.o  
cs_load.o cs_lsolve.o cs_ltsolve.o cs_lu.o cs_lusol.o cs_malloc.o  
cs_maxtrans.o cs_multiply.o cs_norm.o cs_omega.o cs_omegaupdate.o  
cs_permute.o cs_pinv.o cs_post.o cs_print.o cs_pvec.o cs_qr.o  
cs_qrsol.o cs_rCinvwishart.o cs_rR.o cs_randperm.o cs_reach.o  
cs_rinvwishart.o cs_rwishart.o cs_scatter.o cs_scc.o cs_schol.o  
cs_sortdv.o cs_spsolve.o cs_sqr.o cs_symperm.o cs_tdfs.o  
cs_tmultiplyupdate.o cs_transpose.o cs_updown.o cs_usolve.o cs_util.o  
cs_utsolve.o dcutopints.o inverseA.o lpzF.o rIW.o rbv.o rtnorm.o  
rtnormR.o -L/usr/lib64/R/lib -lR
** R
** data
** inst
** preparing package for lazy loading
Loading required package: lattice

Attaching package: 'Matrix'


	The following object(s) are masked from package:tensorA :

	 norm


	The following object(s) are masked from package:stats :

	 contr.SAS,
	 contr.helmert,
	 contr.poly,
	 contr.sum,
	 contr.treatment,
	 xtabs


	The following object(s) are masked from package:base :

	 rcond

** help
*** installing help indices
  >>> Building/Updating help pages for package 'MCMCglmm'
      Formats: text html latex example
   BTdata                            text    html    latex
   BTped                             text    html    latex
   Ddivergence                       text    html    latex   example
   Dexpressions                      text    html    latex
   Dtensor                           text    html    latex   example
   KPPM                              text    html    latex   example
   MCMCglmm                          text    html    latex   example
   MCMCglmmPackage                   text    html    latex
   PlodiaPO                          text    html    latex
   PlodiaR                           text    html    latex
   PlodiaRB                          text    html    latex
   Ptensor                           text    html    latex   example
   SShorns                           text    html    latex
   Tri2M                             text    html    latex   example
   at.level                          text    html    latex   example
   at.set                            text    html    latex   example
   commutation                       text    html    latex   example
   evalDtensor                       text    html    latex   example
   inverseA                          text    html    latex   example
   knorm                             text    html    latex   example
   krzanowski.test                   text    html    latex   example
   kunif                             text    html    latex   example
   leg                               text    html    latex   example
   list2bdiag                        text    html    latex   example
   mult.memb                         text    html    latex   example
   plot.MCMCglmm                     text    html    latex
   plotsubspace                      text    html    latex   example
   posterior.cor                     text    html    latex   example
   posterior.evals                   text    html    latex   example
   posterior.mode                    text    html    latex   example
   predict.MCMCglmm                  text    html    latex
   prunePed                          text    html    latex
   rIW                               text    html    latex   example
   rbv                               text    html    latex   example
   residuals.MCMCglmm                text    html    latex
   rtnorm                            text    html    latex   example
   sir                               text    html    latex   example
   sm2asreml                         text    html    latex   example
   spl                               text    html    latex   example
   summary.MCMCglmm                  text    html    latex
** building package indices ...
* DONE (MCMCglmm)
* creating vignettes ... OK
* cleaning src
* removing junk files
unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
~
unlink MCMCglmm_2.05/R/.DS_Store
unlink MCMCglmm_2.05/R/prunePed.R
unlink MCMCglmm_2.05/R/commutation.R~
unlink MCMCglmm_2.05/R/rtnorm.R~
unlink MCMCglmm_2.05/R/KPPM.R~
unlink MCMCglmm_2.05/R/cs_inversion.c~
unlink MCMCglmm_2.05/R/posterior.cor.R
unlink MCMCglmm_2.05/R/Ddivergence.R~
unlink MCMCglmm_2.05/R/posterior.evals.R
unlink MCMCglmm_2.05/R/rbv.R~
unlink MCMCglmm_2.05/R/rbv.R
unlink MCMCglmm_2.05/R/plot.prior.R~
unlink MCMCglmm_2.05/R/predict.MCMCglmm.R
unlink MCMCglmm_2.05/R/sm2asreml.R~
unlink MCMCglmm_2.05/R/Lweib.R~
unlink MCMCglmm_2.05/R/plot.MCMCglmm.R
unlink MCMCglmm_2.05/R/krzanowski.test.R
unlink MCMCglmm_2.05/R/Fdivergence.R~
unlink MCMCglmm_2.05/R/sir.R~
unlink MCMCglmm_2.05/R/summary.MCMCglmm.R
unlink MCMCglmm_2.05/R/mult.memb.R
unlink MCMCglmm_2.05/R/predict.MCMCglmm.R~
unlink MCMCglmm_2.05/R/KPPM.R
unlink MCMCglmm_2.05/R/spl.R
unlink MCMCglmm_2.05/R/Dtensor.R
unlink MCMCglmm_2.05/R/Ptensor.R
unlink MCMCglmm_2.05/R/kunif.R
unlink MCMCglmm_2.05/R/residuals.MCMCglmm.R
unlink MCMCglmm_2.05/R/mult.memb.R~
unlink MCMCglmm_2.05/R/knorm.R
unlink MCMCglmm_2.05/R/MCMCglmm.R~
unlink MCMCglmm_2.05/R/MCMCglmm.R
unlink MCMCglmm_2.05/R/SimL.R~
unlink MCMCglmm_2.05/R/list2bdiag.R
unlink MCMCglmm_2.05/R/mterms.R~
unlink MCMCglmm_2.05/R/prunePed.R~
unlink MCMCglmm_2.05/R/sm2asreml.R
unlink MCMCglmm_2.05/R/plotsubspace.R
unlink MCMCglmm_2.05/R/plot.MCMCglmm.R~
unlink MCMCglmm_2.05/R/residuals.MCMCglmm.R~
unlink MCMCglmm_2.05/R/Ecor.R~
unlink MCMCglmm_2.05/R/commutation.R
unlink MCMCglmm_2.05/R/getVCV.R~
unlink MCMCglmm_2.05/R/asreml.R~
unlink MCMCglmm_2.05/R/pretty.R~
unlink MCMCglmm_2.05/R/sir.R
unlink MCMCglmm_2.05/R/rIW.R
unlink MCMCglmm_2.05/R/split.direct.sum.R~
unlink MCMCglmm_2.05/R/Tri2M.R
unlink MCMCglmm_2.05/R/find.componets.R~
unlink MCMCglmm_2.05/R/inverseA.R
unlink MCMCglmm_2.05/R/MCMCam.R~
unlink MCMCglmm_2.05/R/inverseAnonC.R~
unlink MCMCglmm_2.05/R/posterior.mode.R
unlink MCMCglmm_2.05/R/path.R~
unlink MCMCglmm_2.05/R/rIW.R~
unlink MCMCglmm_2.05/R/knorm.R~
unlink MCMCglmm_2.05/R/Dtensor.R~
unlink MCMCglmm_2.05/R/buildZ.R~
unlink MCMCglmm_2.05/R/plotsubspace.R~
unlink MCMCglmm_2.05/R/posterior.mode.R~
unlink MCMCglmm_2.05/R/posterior.cor.R~
unlink MCMCglmm_2.05/R/split.direct.sum.R
unlink MCMCglmm_2.05/R/residuals (copy).MCMCglmm.R~
unlink MCMCglmm_2.05/R/Dexpressions.R~
unlink MCMCglmm_2.05/R/Ddivergence.R
unlink MCMCglmm_2.05/R/spl.R~
unlink MCMCglmm_2.05/R/Dexpressions.R
unlink MCMCglmm_2.05/R/mterms.R
unlink MCMCglmm_2.05/R/rtnorm.R
unlink MCMCglmm_2.05/R/inverseA.R~
unlink MCMCglmm_2.05/R/find.components.R~
unlink MCMCglmm_2.05/R/posterior.evals.R~
unlink MCMCglmm_2.05/R/multmemb.R~
unlink MCMCglmm_2.05/R/SStest.R~
unlink MCMCglmm_2.05/R/plotprior.R~
unlink MCMCglmm_2.05/R/find.components.R
unlink MCMCglmm_2.05/R/MCMCgompSInt.R~
unlink MCMCglmm_2.05/R/dcmvnorm.R~
unlink MCMCglmm_2.05/R/summary.MCMCglmm.R~
unlink MCMCglmm_2.05/R/buildZ.R
rmdir MCMCglmm_2.05/R
cannot remove directory for /home/jarrod/mnt/shared: Permission denied  
at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/mnt/scieng1: Permission  
denied at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/mnt: Directory not empty at  
/usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/.gvfs: Device or resource  
busy at /usr/lib64/R/bin/build line 263
cannot make child directory read-write-exec for  
/home/jarrod/.local/share/Trash/files/MasterBayes_2.2.4.Rcheck:  
Operation not permitted at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/.local/share/Trash/files:  
Directory not empty at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/.local/share/Trash: Directory  
not empty at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/.local/share: Directory not  
empty at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod/.local: Directory not empty  
at /usr/lib64/R/bin/build line 263
cannot remove directory for /home/jarrod: Permission denied at  
/usr/lib64/R/bin/build line 263
* checking for LF line-endings in source and make files
* checking for empty or unneeded directories
* building 'MCMCglmm_2.05.tar.gz'
tar: /home/jarrod/Work/AManal/MCMCglmm_2.05.tar: Cannot open: No such  
file or directory
tar: Error is not recoverable: exiting now
gzip: /home/jarrod/Work/AManal/MCMCglmm_2.05.tar: No such file or directory
cannot remove path when cwd is /tmp/Rbuild93379662 for  
/tmp/Rbuild93379662:  at /usr/lib64/R/bin/build line 433


-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From maechler at stat.math.ethz.ch  Wed Jul 28 12:41:18 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 28 Jul 2010 12:41:18 +0200
Subject: [Rd] R CMD build wiped my computer
In-Reply-To: <20100727213709.q1q0u1fm4ooo880s@www.staffmail.ed.ac.uk>
References: <20100727213709.q1q0u1fm4ooo880s@www.staffmail.ed.ac.uk>
Message-ID: <19536.2382.89915.942133@cmath-5.math.ethz.ch>

>>>>> Jarrod Hadfield <j.hadfield at ed.ac.uk>
>>>>>     on Tue, 27 Jul 2010 21:37:09 +0100 writes:

    > Hi, I ran R (version 2.9.0) CMD build under root in
    > Fedora (9). When it tried to remove "junk files" it
    > removed EVERYTHING in my local account! (See below).

    > Can anyone tell me what happened, 

the culprit may lay here:
    >> * removing junk files
    >> unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
    >> ~

where it seems that someone (you?) have added a newline
in the filname, so instead of
 'residuals.MCMCglmm.R~'
you got

 'residuals.MCMCglmm.R
~'

and the unlink / rm  command interpreted '~' as your home
directory.

But I can hardly believe it.
This seems explanation seems a bit doubtful to me.. ...

    > and even more importantly if I can I restore what was lost.

well, you just get it from the backup. You do daily backups, do
you?

Regards,
Martin Maechler, ETH Zurich

    > Panickingly,

    > Jarrod

    > [jarrod at localhost AManal]$ R CMD build MCMCglmm_2.05
    > * checking for file 'MCMCglmm_2.05/DESCRIPTION' ... OK
    > * preparing 'MCMCglmm_2.05':
    > * checking DESCRIPTION meta-information ... OK
    > * cleaning src
    > * installing the package to re-build vignettes
    > * Installing *source* package ?MCMCglmm? ...
    > ** libs
    > g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
    > -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
    > --param=ssp-buffer-size=4 -m64 -mtune=generic -c MCMCglmm.cc -o  
    > MCMCglmm.o
    > MCMCglmm.cc: In function ?void MCMCglmm(double*, double*, double*,  
    > int*, int*, int*, int*, int*, int*, double*, int*, int*, double*,  
    > int*, int*, double*, double*, int*, int*, int*, int*, int*, int*,  
    > int*, int*, int*, int*, double*, double*, double*, int*, int*, int*,  
    > int*, double*, double*, double*, int*, double*, bool*, double*,  
    > double*, int*, int*, int*, int*, int*, double*, int*, int*, int*,  
    > double*, double*, double*, int*, int*, double*, int*, int*, int*,  
    > int*, double*, double*, double*, double*)?:
    > MCMCglmm.cc:228: warning: ?pvLS? may be used uninitialized in this function
    > MCMCglmm.cc:227: warning: ?pvLL? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?Lrv? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?pmuL? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?pvL? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?LambdaX? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?bv_tmp? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?bv? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?A? may be used uninitialized in this function
    > MCMCglmm.cc:86: warning: ?dimG? may be used uninitialized in this function
    > MCMCglmm.cc:228: warning: ?AlphainvS? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:227: warning: ?AlphainvL? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:225: warning: ?alphalocation_tmp? may be used  
    > uninitialized in this function
    > MCMCglmm.cc:225: warning: ?alphalocation? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:225: warning: ?alphazstar? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:225: warning: ?alphapred? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:225: warning: ?alphaastar? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:225: warning: ?muAlpha? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?Alphainv? may be used uninitialized in this  
    > function
    > MCMCglmm.cc:225: warning: ?tXalpha? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?Xalpha? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?linky_orig? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:228: warning: ?tYKrinvYS? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:228: warning: ?LambdaS? may be used uninitialized in this function
    > MCMCglmm.cc:227: warning: ?tYKrinvYL? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:227: warning: ?LambdaLU? may be used uninitialized in this  
    > function
    > MCMCglmm.cc:225: warning: ?tYKrinvY? may be used uninitialized in this  
    > function
    > MCMCglmm.cc:225: warning: ?tYKrinv? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?ILY? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?tY? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?Y? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?I? may be used uninitialized in this function
    > MCMCglmm.cc:228: warning: ?alphaS? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?alphaMME? may be used uninitialized in this  
    > function
    > MCMCglmm.cc:225: warning: ?alphaM? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?XtmKRinv? may be used uninitialized in this  
    > function
    > MCMCglmm.cc:227: warning: ?alphaL? may be used uninitialized in this function
    > MCMCglmm.cc:227: warning: ?L? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?alphaastar_tmp? may be used uninitialized  
    > in this function
    > MCMCglmm.cc:225: warning: ?dev? may be used uninitialized in this function
    > MCMCglmm.cc:225: warning: ?astar_tmp? may be used uninitialized in  
    > this function
    > MCMCglmm.cc:225: warning: ?Worig? may be used uninitialized in this function
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_add.c -o cs_add.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_addR.c -o cs_addR.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_amd.c -o cs_amd.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_cbind.c -o cs_cbind.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_chol.c -o cs_chol.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_cholsol.c -o cs_cholsol.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_compress.c -o cs_compress.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_counts.c -o cs_counts.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_cov2cor.c -o cs_cov2cor.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_cumsum.c -o cs_cumsum.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_dcmvnorm.c -o cs_dcmvnorm.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_dfs.c -o cs_dfs.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_directsum.c -o cs_directsum.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_directsumupdate.c -o cs_directsumupdate.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_dmperm.c -o cs_dmperm.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_dmvnorm.c -o cs_dmvnorm.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_droptol.c -o cs_droptol.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_dropzeros.c -o cs_dropzeros.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_dupl.c -o cs_dupl.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_entry.c -o cs_entry.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_ereach.c -o cs_ereach.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_etree.c -o cs_etree.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_fkeep.c -o cs_fkeep.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_gaxpy.c -o cs_gaxpy.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_happly.c -o cs_happly.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_house.c -o cs_house.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_inv.c -o cs_inv.o
    > cs_inv.c: In function ?cs_inv?:
    > cs_inv.c:9: warning: ?irow? may be used uninitialized in this function
    > cs_inv.c:9: warning: ?icol? may be used uninitialized in this function
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_invR.c -o cs_invR.o
    > cs_invR.c: In function ?cs_invR?:
    > cs_invR.c:9: warning: ?irow? may be used uninitialized in this function
    > cs_invR.c:9: warning: ?icol? may be used uninitialized in this function
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_ipvec.c -o cs_ipvec.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_kroneckerA.c -o cs_kroneckerA.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_kroneckerAupdate.c -o cs_kroneckerAupdate.o
    > cs_kroneckerAupdate.c: In function ?cs_kroneckerAupdate?:
    > cs_kroneckerAupdate.c:5: warning: unused variable ?Cp?
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_kroneckerH.c -o cs_kroneckerH.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_kroneckerI.c -o cs_kroneckerI.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_kroneckerIupdate.c -o cs_kroneckerIupdate.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_leaf.c -o cs_leaf.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_load.c -o cs_load.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_lsolve.c -o cs_lsolve.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_ltsolve.c -o cs_ltsolve.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_lu.c -o cs_lu.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_lusol.c -o cs_lusol.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_malloc.c -o cs_malloc.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_maxtrans.c -o cs_maxtrans.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_multiply.c -o cs_multiply.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_norm.c -o cs_norm.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_omega.c -o cs_omega.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_omegaupdate.c -o cs_omegaupdate.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_permute.c -o cs_permute.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_pinv.c -o cs_pinv.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_post.c -o cs_post.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_print.c -o cs_print.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_pvec.c -o cs_pvec.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_qr.c -o cs_qr.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_qrsol.c -o cs_qrsol.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_rCinvwishart.c -o cs_rCinvwishart.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_rR.c -o cs_rR.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_randperm.c -o cs_randperm.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_reach.c -o cs_reach.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_rinvwishart.c -o cs_rinvwishart.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_rwishart.c -o cs_rwishart.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_scatter.c -o cs_scatter.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_scc.c -o cs_scc.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_schol.c -o cs_schol.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_sortdv.c -o cs_sortdv.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_spsolve.c -o cs_spsolve.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_sqr.c -o cs_sqr.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_symperm.c -o cs_symperm.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_tdfs.c -o cs_tdfs.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_tmultiplyupdate.c -o cs_tmultiplyupdate.o
    > cs_tmultiplyupdate.c: In function ?cs_tmultiplyupdate?:
    > cs_tmultiplyupdate.c:16: warning: unused variable ?Cx?
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_transpose.c -o cs_transpose.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_updown.c -o cs_updown.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_usolve.c -o cs_usolve.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_util.c -o cs_util.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > cs_utsolve.c -o cs_utsolve.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > dcutopints.c -o dcutopints.o
    > g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
    > -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
    > --param=ssp-buffer-size=4 -m64 -mtune=generic -c inverseA.cc -o  
    > inverseA.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > lpzF.c -o lpzF.o
    > g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
    > -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
    > --param=ssp-buffer-size=4 -m64 -mtune=generic -c rIW.cc -o rIW.o
    > g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
    > -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
    > --param=ssp-buffer-size=4 -m64 -mtune=generic -c rbv.cc -o rbv.o
    > gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic   
    > -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions  
    > -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c  
    > rtnorm.c -o rtnorm.o
    > g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g -pipe  
    > -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector  
    > --param=ssp-buffer-size=4 -m64 -mtune=generic -c rtnormR.cc -o rtnormR.o
    > g++ -m64 -shared -L/usr/local/lib64 -o MCMCglmm.so MCMCglmm.o cs_add.o  
    > cs_addR.o cs_amd.o cs_cbind.o cs_chol.o cs_cholsol.o cs_compress.o  
    > cs_counts.o cs_cov2cor.o cs_cumsum.o cs_dcmvnorm.o cs_dfs.o  
    > cs_directsum.o cs_directsumupdate.o cs_dmperm.o cs_dmvnorm.o  
    > cs_droptol.o cs_dropzeros.o cs_dupl.o cs_entry.o cs_ereach.o  
    > cs_etree.o cs_fkeep.o cs_gaxpy.o cs_happly.o cs_house.o cs_inv.o  
    > cs_invR.o cs_ipvec.o cs_kroneckerA.o cs_kroneckerAupdate.o  
    > cs_kroneckerH.o cs_kroneckerI.o cs_kroneckerIupdate.o cs_leaf.o  
    > cs_load.o cs_lsolve.o cs_ltsolve.o cs_lu.o cs_lusol.o cs_malloc.o  
    > cs_maxtrans.o cs_multiply.o cs_norm.o cs_omega.o cs_omegaupdate.o  
    > cs_permute.o cs_pinv.o cs_post.o cs_print.o cs_pvec.o cs_qr.o  
    > cs_qrsol.o cs_rCinvwishart.o cs_rR.o cs_randperm.o cs_reach.o  
    > cs_rinvwishart.o cs_rwishart.o cs_scatter.o cs_scc.o cs_schol.o  
    > cs_sortdv.o cs_spsolve.o cs_sqr.o cs_symperm.o cs_tdfs.o  
    > cs_tmultiplyupdate.o cs_transpose.o cs_updown.o cs_usolve.o cs_util.o  
    > cs_utsolve.o dcutopints.o inverseA.o lpzF.o rIW.o rbv.o rtnorm.o  
    > rtnormR.o -L/usr/lib64/R/lib -lR
    > ** R
    > ** data
    > ** inst
    > ** preparing package for lazy loading
    > Loading required package: lattice

    > Attaching package: 'Matrix'


    > The following object(s) are masked from package:tensorA :

    > norm


    > The following object(s) are masked from package:stats :

    > contr.SAS,
    > contr.helmert,
    > contr.poly,
    > contr.sum,
    > contr.treatment,
    > xtabs


    > The following object(s) are masked from package:base :

    > rcond

    > ** help
    > *** installing help indices
    >>>> Building/Updating help pages for package 'MCMCglmm'
    > Formats: text html latex example
    > BTdata                            text    html    latex
    > BTped                             text    html    latex
    > Ddivergence                       text    html    latex   example
    > Dexpressions                      text    html    latex
    > Dtensor                           text    html    latex   example
    > KPPM                              text    html    latex   example
    > MCMCglmm                          text    html    latex   example
    > MCMCglmmPackage                   text    html    latex
    > PlodiaPO                          text    html    latex
    > PlodiaR                           text    html    latex
    > PlodiaRB                          text    html    latex
    > Ptensor                           text    html    latex   example
    > SShorns                           text    html    latex
    > Tri2M                             text    html    latex   example
    > at.level                          text    html    latex   example
    > at.set                            text    html    latex   example
    > commutation                       text    html    latex   example
    > evalDtensor                       text    html    latex   example
    > inverseA                          text    html    latex   example
    > knorm                             text    html    latex   example
    > krzanowski.test                   text    html    latex   example
    > kunif                             text    html    latex   example
    > leg                               text    html    latex   example
    > list2bdiag                        text    html    latex   example
    > mult.memb                         text    html    latex   example
    > plot.MCMCglmm                     text    html    latex
    > plotsubspace                      text    html    latex   example
    > posterior.cor                     text    html    latex   example
    > posterior.evals                   text    html    latex   example
    > posterior.mode                    text    html    latex   example
    > predict.MCMCglmm                  text    html    latex
    > prunePed                          text    html    latex
    > rIW                               text    html    latex   example
    > rbv                               text    html    latex   example
    > residuals.MCMCglmm                text    html    latex
    > rtnorm                            text    html    latex   example
    > sir                               text    html    latex   example
    > sm2asreml                         text    html    latex   example
    > spl                               text    html    latex   example
    > summary.MCMCglmm                  text    html    latex
    > ** building package indices ...
    > * DONE (MCMCglmm)
    > * creating vignettes ... OK
    > * cleaning src
    > * removing junk files
    > unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
    > ~
    > unlink MCMCglmm_2.05/R/.DS_Store
    > unlink MCMCglmm_2.05/R/prunePed.R
    > unlink MCMCglmm_2.05/R/commutation.R~
    > unlink MCMCglmm_2.05/R/rtnorm.R~
    > unlink MCMCglmm_2.05/R/KPPM.R~
    > unlink MCMCglmm_2.05/R/cs_inversion.c~
    > unlink MCMCglmm_2.05/R/posterior.cor.R
    > unlink MCMCglmm_2.05/R/Ddivergence.R~
    > unlink MCMCglmm_2.05/R/posterior.evals.R
    > unlink MCMCglmm_2.05/R/rbv.R~
    > unlink MCMCglmm_2.05/R/rbv.R
    > unlink MCMCglmm_2.05/R/plot.prior.R~
    > unlink MCMCglmm_2.05/R/predict.MCMCglmm.R
    > unlink MCMCglmm_2.05/R/sm2asreml.R~
    > unlink MCMCglmm_2.05/R/Lweib.R~
    > unlink MCMCglmm_2.05/R/plot.MCMCglmm.R
    > unlink MCMCglmm_2.05/R/krzanowski.test.R
    > unlink MCMCglmm_2.05/R/Fdivergence.R~
    > unlink MCMCglmm_2.05/R/sir.R~
    > unlink MCMCglmm_2.05/R/summary.MCMCglmm.R
    > unlink MCMCglmm_2.05/R/mult.memb.R
    > unlink MCMCglmm_2.05/R/predict.MCMCglmm.R~
    > unlink MCMCglmm_2.05/R/KPPM.R
    > unlink MCMCglmm_2.05/R/spl.R
    > unlink MCMCglmm_2.05/R/Dtensor.R
    > unlink MCMCglmm_2.05/R/Ptensor.R
    > unlink MCMCglmm_2.05/R/kunif.R
    > unlink MCMCglmm_2.05/R/residuals.MCMCglmm.R
    > unlink MCMCglmm_2.05/R/mult.memb.R~
    > unlink MCMCglmm_2.05/R/knorm.R
    > unlink MCMCglmm_2.05/R/MCMCglmm.R~
    > unlink MCMCglmm_2.05/R/MCMCglmm.R
    > unlink MCMCglmm_2.05/R/SimL.R~
    > unlink MCMCglmm_2.05/R/list2bdiag.R
    > unlink MCMCglmm_2.05/R/mterms.R~
    > unlink MCMCglmm_2.05/R/prunePed.R~
    > unlink MCMCglmm_2.05/R/sm2asreml.R
    > unlink MCMCglmm_2.05/R/plotsubspace.R
    > unlink MCMCglmm_2.05/R/plot.MCMCglmm.R~
    > unlink MCMCglmm_2.05/R/residuals.MCMCglmm.R~
    > unlink MCMCglmm_2.05/R/Ecor.R~
    > unlink MCMCglmm_2.05/R/commutation.R
    > unlink MCMCglmm_2.05/R/getVCV.R~
    > unlink MCMCglmm_2.05/R/asreml.R~
    > unlink MCMCglmm_2.05/R/pretty.R~
    > unlink MCMCglmm_2.05/R/sir.R
    > unlink MCMCglmm_2.05/R/rIW.R
    > unlink MCMCglmm_2.05/R/split.direct.sum.R~
    > unlink MCMCglmm_2.05/R/Tri2M.R
    > unlink MCMCglmm_2.05/R/find.componets.R~
    > unlink MCMCglmm_2.05/R/inverseA.R
    > unlink MCMCglmm_2.05/R/MCMCam.R~
    > unlink MCMCglmm_2.05/R/inverseAnonC.R~
    > unlink MCMCglmm_2.05/R/posterior.mode.R
    > unlink MCMCglmm_2.05/R/path.R~
    > unlink MCMCglmm_2.05/R/rIW.R~
    > unlink MCMCglmm_2.05/R/knorm.R~
    > unlink MCMCglmm_2.05/R/Dtensor.R~
    > unlink MCMCglmm_2.05/R/buildZ.R~
    > unlink MCMCglmm_2.05/R/plotsubspace.R~
    > unlink MCMCglmm_2.05/R/posterior.mode.R~
    > unlink MCMCglmm_2.05/R/posterior.cor.R~
    > unlink MCMCglmm_2.05/R/split.direct.sum.R
    > unlink MCMCglmm_2.05/R/residuals (copy).MCMCglmm.R~
    > unlink MCMCglmm_2.05/R/Dexpressions.R~
    > unlink MCMCglmm_2.05/R/Ddivergence.R
    > unlink MCMCglmm_2.05/R/spl.R~
    > unlink MCMCglmm_2.05/R/Dexpressions.R
    > unlink MCMCglmm_2.05/R/mterms.R
    > unlink MCMCglmm_2.05/R/rtnorm.R
    > unlink MCMCglmm_2.05/R/inverseA.R~
    > unlink MCMCglmm_2.05/R/find.components.R~
    > unlink MCMCglmm_2.05/R/posterior.evals.R~
    > unlink MCMCglmm_2.05/R/multmemb.R~
    > unlink MCMCglmm_2.05/R/SStest.R~
    > unlink MCMCglmm_2.05/R/plotprior.R~
    > unlink MCMCglmm_2.05/R/find.components.R
    > unlink MCMCglmm_2.05/R/MCMCgompSInt.R~
    > unlink MCMCglmm_2.05/R/dcmvnorm.R~
    > unlink MCMCglmm_2.05/R/summary.MCMCglmm.R~
    > unlink MCMCglmm_2.05/R/buildZ.R
    > rmdir MCMCglmm_2.05/R
    > cannot remove directory for /home/jarrod/mnt/shared: Permission denied  
    > at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/mnt/scieng1: Permission  
    > denied at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/mnt: Directory not empty at  
    > /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/.gvfs: Device or resource  
    > busy at /usr/lib64/R/bin/build line 263
    > cannot make child directory read-write-exec for  
    > /home/jarrod/.local/share/Trash/files/MasterBayes_2.2.4.Rcheck:  
    > Operation not permitted at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/.local/share/Trash/files:  
    > Directory not empty at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/.local/share/Trash: Directory  
    > not empty at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/.local/share: Directory not  
    > empty at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod/.local: Directory not empty  
    > at /usr/lib64/R/bin/build line 263
    > cannot remove directory for /home/jarrod: Permission denied at  
    > /usr/lib64/R/bin/build line 263
    > * checking for LF line-endings in source and make files
    > * checking for empty or unneeded directories
    > * building 'MCMCglmm_2.05.tar.gz'
    > tar: /home/jarrod/Work/AManal/MCMCglmm_2.05.tar: Cannot open: No such  
    > file or directory
    > tar: Error is not recoverable: exiting now
    > gzip: /home/jarrod/Work/AManal/MCMCglmm_2.05.tar: No such file or directory
    > cannot remove path when cwd is /tmp/Rbuild93379662 for  
    > /tmp/Rbuild93379662:  at /usr/lib64/R/bin/build line 433


    > -- 
    > The University of Edinburgh is a charitable body, registered in
    > Scotland, with registration number SC005336.

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From j.hadfield at ed.ac.uk  Wed Jul 28 12:53:31 2010
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Wed, 28 Jul 2010 11:53:31 +0100
Subject: [Rd] R CMD build wiped my computer
In-Reply-To: <19536.2382.89915.942133@cmath-5.math.ethz.ch>
References: <20100727213709.q1q0u1fm4ooo880s@www.staffmail.ed.ac.uk>
	<19536.2382.89915.942133@cmath-5.math.ethz.ch>
Message-ID: <95B255F9-5BA6-45C4-97B7-FC5D62E28002@ed.ac.uk>

Hi Martin,

I think this is the most likely reason given that the name in the  
DESCRIPTION file does NOT have a version number. Even so, it is very  
easy to misname a file and then delete it/change its name (as I've  
done here) and I hope current versions of R would not cause this  
problem. Perhaps Fedora should not use ~ as its back up file suffixes?

Cheers,

Jarrod





On 28 Jul 2010, at 11:41, Martin Maechler wrote:

>>>>>> Jarrod Hadfield <j.hadfield at ed.ac.uk>
>>>>>>    on Tue, 27 Jul 2010 21:37:09 +0100 writes:
>
>> Hi, I ran R (version 2.9.0) CMD build under root in
>> Fedora (9). When it tried to remove "junk files" it
>> removed EVERYTHING in my local account! (See below).
>
>> Can anyone tell me what happened,
>
> the culprit may lay here:
>>> * removing junk files
>>> unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
>>> ~
>
> where it seems that someone (you?) have added a newline
> in the filname, so instead of
> 'residuals.MCMCglmm.R~'
> you got
>
> 'residuals.MCMCglmm.R
> ~'
>
> and the unlink / rm  command interpreted '~' as your home
> directory.
>
> But I can hardly believe it.
> This seems explanation seems a bit doubtful to me.. ...
>
>> and even more importantly if I can I restore what was lost.
>
> well, you just get it from the backup. You do daily backups, do
> you?
>
> Regards,
> Martin Maechler, ETH Zurich
>
>> Panickingly,
>
>> Jarrod
>
>> [jarrod at localhost AManal]$ R CMD build MCMCglmm_2.05
>> * checking for file 'MCMCglmm_2.05/DESCRIPTION' ... OK
>> * preparing 'MCMCglmm_2.05':
>> * checking DESCRIPTION meta-information ... OK
>> * cleaning src
>> * installing the package to re-build vignettes
>> * Installing *source* package ?MCMCglmm? ...
>> ** libs
>> g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g - 
>> pipe
>> -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic -c MCMCglmm.cc -o
>> MCMCglmm.o
>> MCMCglmm.cc: In function ?void MCMCglmm(double*, double*, double*,
>> int*, int*, int*, int*, int*, int*, double*, int*, int*, double*,
>> int*, int*, double*, double*, int*, int*, int*, int*, int*, int*,
>> int*, int*, int*, int*, double*, double*, double*, int*, int*, int*,
>> int*, double*, double*, double*, int*, double*, bool*, double*,
>> double*, int*, int*, int*, int*, int*, double*, int*, int*, int*,
>> double*, double*, double*, int*, int*, double*, int*, int*, int*,
>> int*, double*, double*, double*, double*)?:
>> MCMCglmm.cc:228: warning: ?pvLS? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:227: warning: ?pvLL? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?Lrv? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?pmuL? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?pvL? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?LambdaX? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?bv_tmp? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?bv? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?A? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:86: warning: ?dimG? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:228: warning: ?AlphainvS? may be used uninitialized in
>> this function
>> MCMCglmm.cc:227: warning: ?AlphainvL? may be used uninitialized in
>> this function
>> MCMCglmm.cc:225: warning: ?alphalocation_tmp? may be used
>> uninitialized in this function
>> MCMCglmm.cc:225: warning: ?alphalocation? may be used uninitialized  
>> in
>> this function
>> MCMCglmm.cc:225: warning: ?alphazstar? may be used uninitialized in
>> this function
>> MCMCglmm.cc:225: warning: ?alphapred? may be used uninitialized in
>> this function
>> MCMCglmm.cc:225: warning: ?alphaastar? may be used uninitialized in
>> this function
>> MCMCglmm.cc:225: warning: ?muAlpha? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?Alphainv? may be used uninitialized in  
>> this
>> function
>> MCMCglmm.cc:225: warning: ?tXalpha? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?Xalpha? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?linky_orig? may be used uninitialized in
>> this function
>> MCMCglmm.cc:228: warning: ?tYKrinvYS? may be used uninitialized in
>> this function
>> MCMCglmm.cc:228: warning: ?LambdaS? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:227: warning: ?tYKrinvYL? may be used uninitialized in
>> this function
>> MCMCglmm.cc:227: warning: ?LambdaLU? may be used uninitialized in  
>> this
>> function
>> MCMCglmm.cc:225: warning: ?tYKrinvY? may be used uninitialized in  
>> this
>> function
>> MCMCglmm.cc:225: warning: ?tYKrinv? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?ILY? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?tY? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?Y? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?I? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:228: warning: ?alphaS? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?alphaMME? may be used uninitialized in  
>> this
>> function
>> MCMCglmm.cc:225: warning: ?alphaM? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:225: warning: ?XtmKRinv? may be used uninitialized in  
>> this
>> function
>> MCMCglmm.cc:227: warning: ?alphaL? may be used uninitialized in  
>> this function
>> MCMCglmm.cc:227: warning: ?L? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?alphaastar_tmp? may be used uninitialized
>> in this function
>> MCMCglmm.cc:225: warning: ?dev? may be used uninitialized in this  
>> function
>> MCMCglmm.cc:225: warning: ?astar_tmp? may be used uninitialized in
>> this function
>> MCMCglmm.cc:225: warning: ?Worig? may be used uninitialized in this  
>> function
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_add.c -o cs_add.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_addR.c -o cs_addR.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_amd.c -o cs_amd.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_cbind.c -o cs_cbind.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_chol.c -o cs_chol.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_cholsol.c -o cs_cholsol.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_compress.c -o cs_compress.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_counts.c -o cs_counts.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_cov2cor.c -o cs_cov2cor.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_cumsum.c -o cs_cumsum.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_dcmvnorm.c -o cs_dcmvnorm.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_dfs.c -o cs_dfs.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_directsum.c -o cs_directsum.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_directsumupdate.c -o cs_directsumupdate.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_dmperm.c -o cs_dmperm.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_dmvnorm.c -o cs_dmvnorm.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_droptol.c -o cs_droptol.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_dropzeros.c -o cs_dropzeros.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_dupl.c -o cs_dupl.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_entry.c -o cs_entry.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_ereach.c -o cs_ereach.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_etree.c -o cs_etree.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_fkeep.c -o cs_fkeep.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_gaxpy.c -o cs_gaxpy.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_happly.c -o cs_happly.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_house.c -o cs_house.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_inv.c -o cs_inv.o
>> cs_inv.c: In function ?cs_inv?:
>> cs_inv.c:9: warning: ?irow? may be used uninitialized in this  
>> function
>> cs_inv.c:9: warning: ?icol? may be used uninitialized in this  
>> function
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_invR.c -o cs_invR.o
>> cs_invR.c: In function ?cs_invR?:
>> cs_invR.c:9: warning: ?irow? may be used uninitialized in this  
>> function
>> cs_invR.c:9: warning: ?icol? may be used uninitialized in this  
>> function
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_ipvec.c -o cs_ipvec.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_kroneckerA.c -o cs_kroneckerA.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_kroneckerAupdate.c -o cs_kroneckerAupdate.o
>> cs_kroneckerAupdate.c: In function ?cs_kroneckerAupdate?:
>> cs_kroneckerAupdate.c:5: warning: unused variable ?Cp?
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_kroneckerH.c -o cs_kroneckerH.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_kroneckerI.c -o cs_kroneckerI.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_kroneckerIupdate.c -o cs_kroneckerIupdate.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_leaf.c -o cs_leaf.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_load.c -o cs_load.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_lsolve.c -o cs_lsolve.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_ltsolve.c -o cs_ltsolve.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_lu.c -o cs_lu.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_lusol.c -o cs_lusol.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_malloc.c -o cs_malloc.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_maxtrans.c -o cs_maxtrans.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_multiply.c -o cs_multiply.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_norm.c -o cs_norm.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_omega.c -o cs_omega.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_omegaupdate.c -o cs_omegaupdate.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_permute.c -o cs_permute.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_pinv.c -o cs_pinv.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_post.c -o cs_post.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_print.c -o cs_print.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_pvec.c -o cs_pvec.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_qr.c -o cs_qr.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_qrsol.c -o cs_qrsol.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_rCinvwishart.c -o cs_rCinvwishart.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_rR.c -o cs_rR.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_randperm.c -o cs_randperm.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_reach.c -o cs_reach.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_rinvwishart.c -o cs_rinvwishart.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_rwishart.c -o cs_rwishart.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_scatter.c -o cs_scatter.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_scc.c -o cs_scc.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_schol.c -o cs_schol.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_sortdv.c -o cs_sortdv.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_spsolve.c -o cs_spsolve.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_sqr.c -o cs_sqr.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_symperm.c -o cs_symperm.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_tdfs.c -o cs_tdfs.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_tmultiplyupdate.c -o cs_tmultiplyupdate.o
>> cs_tmultiplyupdate.c: In function ?cs_tmultiplyupdate?:
>> cs_tmultiplyupdate.c:16: warning: unused variable ?Cx?
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_transpose.c -o cs_transpose.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_updown.c -o cs_updown.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_usolve.c -o cs_usolve.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_util.c -o cs_util.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> cs_utsolve.c -o cs_utsolve.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> dcutopints.c -o dcutopints.o
>> g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g - 
>> pipe
>> -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic -c inverseA.cc -o
>> inverseA.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> lpzF.c -o lpzF.o
>> g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g - 
>> pipe
>> -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic -c rIW.cc -o rIW.o
>> g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g - 
>> pipe
>> -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic -c rbv.cc -o rbv.o
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic
>> -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
>> -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -c
>> rtnorm.c -o rtnorm.o
>> g++ -m64 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g - 
>> pipe
>> -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic -c rtnormR.cc -o  
>> rtnormR.o
>> g++ -m64 -shared -L/usr/local/lib64 -o MCMCglmm.so MCMCglmm.o  
>> cs_add.o
>> cs_addR.o cs_amd.o cs_cbind.o cs_chol.o cs_cholsol.o cs_compress.o
>> cs_counts.o cs_cov2cor.o cs_cumsum.o cs_dcmvnorm.o cs_dfs.o
>> cs_directsum.o cs_directsumupdate.o cs_dmperm.o cs_dmvnorm.o
>> cs_droptol.o cs_dropzeros.o cs_dupl.o cs_entry.o cs_ereach.o
>> cs_etree.o cs_fkeep.o cs_gaxpy.o cs_happly.o cs_house.o cs_inv.o
>> cs_invR.o cs_ipvec.o cs_kroneckerA.o cs_kroneckerAupdate.o
>> cs_kroneckerH.o cs_kroneckerI.o cs_kroneckerIupdate.o cs_leaf.o
>> cs_load.o cs_lsolve.o cs_ltsolve.o cs_lu.o cs_lusol.o cs_malloc.o
>> cs_maxtrans.o cs_multiply.o cs_norm.o cs_omega.o cs_omegaupdate.o
>> cs_permute.o cs_pinv.o cs_post.o cs_print.o cs_pvec.o cs_qr.o
>> cs_qrsol.o cs_rCinvwishart.o cs_rR.o cs_randperm.o cs_reach.o
>> cs_rinvwishart.o cs_rwishart.o cs_scatter.o cs_scc.o cs_schol.o
>> cs_sortdv.o cs_spsolve.o cs_sqr.o cs_symperm.o cs_tdfs.o
>> cs_tmultiplyupdate.o cs_transpose.o cs_updown.o cs_usolve.o cs_util.o
>> cs_utsolve.o dcutopints.o inverseA.o lpzF.o rIW.o rbv.o rtnorm.o
>> rtnormR.o -L/usr/lib64/R/lib -lR
>> ** R
>> ** data
>> ** inst
>> ** preparing package for lazy loading
>> Loading required package: lattice
>
>> Attaching package: 'Matrix'
>
>
>> The following object(s) are masked from package:tensorA :
>
>> norm
>
>
>> The following object(s) are masked from package:stats :
>
>> contr.SAS,
>> contr.helmert,
>> contr.poly,
>> contr.sum,
>> contr.treatment,
>> xtabs
>
>
>> The following object(s) are masked from package:base :
>
>> rcond
>
>> ** help
>> *** installing help indices
>>>>> Building/Updating help pages for package 'MCMCglmm'
>> Formats: text html latex example
>> BTdata                            text    html    latex
>> BTped                             text    html    latex
>> Ddivergence                       text    html    latex   example
>> Dexpressions                      text    html    latex
>> Dtensor                           text    html    latex   example
>> KPPM                              text    html    latex   example
>> MCMCglmm                          text    html    latex   example
>> MCMCglmmPackage                   text    html    latex
>> PlodiaPO                          text    html    latex
>> PlodiaR                           text    html    latex
>> PlodiaRB                          text    html    latex
>> Ptensor                           text    html    latex   example
>> SShorns                           text    html    latex
>> Tri2M                             text    html    latex   example
>> at.level                          text    html    latex   example
>> at.set                            text    html    latex   example
>> commutation                       text    html    latex   example
>> evalDtensor                       text    html    latex   example
>> inverseA                          text    html    latex   example
>> knorm                             text    html    latex   example
>> krzanowski.test                   text    html    latex   example
>> kunif                             text    html    latex   example
>> leg                               text    html    latex   example
>> list2bdiag                        text    html    latex   example
>> mult.memb                         text    html    latex   example
>> plot.MCMCglmm                     text    html    latex
>> plotsubspace                      text    html    latex   example
>> posterior.cor                     text    html    latex   example
>> posterior.evals                   text    html    latex   example
>> posterior.mode                    text    html    latex   example
>> predict.MCMCglmm                  text    html    latex
>> prunePed                          text    html    latex
>> rIW                               text    html    latex   example
>> rbv                               text    html    latex   example
>> residuals.MCMCglmm                text    html    latex
>> rtnorm                            text    html    latex   example
>> sir                               text    html    latex   example
>> sm2asreml                         text    html    latex   example
>> spl                               text    html    latex   example
>> summary.MCMCglmm                  text    html    latex
>> ** building package indices ...
>> * DONE (MCMCglmm)
>> * creating vignettes ... OK
>> * cleaning src
>> * removing junk files
>> unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
>> ~
>> unlink MCMCglmm_2.05/R/.DS_Store
>> unlink MCMCglmm_2.05/R/prunePed.R
>> unlink MCMCglmm_2.05/R/commutation.R~
>> unlink MCMCglmm_2.05/R/rtnorm.R~
>> unlink MCMCglmm_2.05/R/KPPM.R~
>> unlink MCMCglmm_2.05/R/cs_inversion.c~
>> unlink MCMCglmm_2.05/R/posterior.cor.R
>> unlink MCMCglmm_2.05/R/Ddivergence.R~
>> unlink MCMCglmm_2.05/R/posterior.evals.R
>> unlink MCMCglmm_2.05/R/rbv.R~
>> unlink MCMCglmm_2.05/R/rbv.R
>> unlink MCMCglmm_2.05/R/plot.prior.R~
>> unlink MCMCglmm_2.05/R/predict.MCMCglmm.R
>> unlink MCMCglmm_2.05/R/sm2asreml.R~
>> unlink MCMCglmm_2.05/R/Lweib.R~
>> unlink MCMCglmm_2.05/R/plot.MCMCglmm.R
>> unlink MCMCglmm_2.05/R/krzanowski.test.R
>> unlink MCMCglmm_2.05/R/Fdivergence.R~
>> unlink MCMCglmm_2.05/R/sir.R~
>> unlink MCMCglmm_2.05/R/summary.MCMCglmm.R
>> unlink MCMCglmm_2.05/R/mult.memb.R
>> unlink MCMCglmm_2.05/R/predict.MCMCglmm.R~
>> unlink MCMCglmm_2.05/R/KPPM.R
>> unlink MCMCglmm_2.05/R/spl.R
>> unlink MCMCglmm_2.05/R/Dtensor.R
>> unlink MCMCglmm_2.05/R/Ptensor.R
>> unlink MCMCglmm_2.05/R/kunif.R
>> unlink MCMCglmm_2.05/R/residuals.MCMCglmm.R
>> unlink MCMCglmm_2.05/R/mult.memb.R~
>> unlink MCMCglmm_2.05/R/knorm.R
>> unlink MCMCglmm_2.05/R/MCMCglmm.R~
>> unlink MCMCglmm_2.05/R/MCMCglmm.R
>> unlink MCMCglmm_2.05/R/SimL.R~
>> unlink MCMCglmm_2.05/R/list2bdiag.R
>> unlink MCMCglmm_2.05/R/mterms.R~
>> unlink MCMCglmm_2.05/R/prunePed.R~
>> unlink MCMCglmm_2.05/R/sm2asreml.R
>> unlink MCMCglmm_2.05/R/plotsubspace.R
>> unlink MCMCglmm_2.05/R/plot.MCMCglmm.R~
>> unlink MCMCglmm_2.05/R/residuals.MCMCglmm.R~
>> unlink MCMCglmm_2.05/R/Ecor.R~
>> unlink MCMCglmm_2.05/R/commutation.R
>> unlink MCMCglmm_2.05/R/getVCV.R~
>> unlink MCMCglmm_2.05/R/asreml.R~
>> unlink MCMCglmm_2.05/R/pretty.R~
>> unlink MCMCglmm_2.05/R/sir.R
>> unlink MCMCglmm_2.05/R/rIW.R
>> unlink MCMCglmm_2.05/R/split.direct.sum.R~
>> unlink MCMCglmm_2.05/R/Tri2M.R
>> unlink MCMCglmm_2.05/R/find.componets.R~
>> unlink MCMCglmm_2.05/R/inverseA.R
>> unlink MCMCglmm_2.05/R/MCMCam.R~
>> unlink MCMCglmm_2.05/R/inverseAnonC.R~
>> unlink MCMCglmm_2.05/R/posterior.mode.R
>> unlink MCMCglmm_2.05/R/path.R~
>> unlink MCMCglmm_2.05/R/rIW.R~
>> unlink MCMCglmm_2.05/R/knorm.R~
>> unlink MCMCglmm_2.05/R/Dtensor.R~
>> unlink MCMCglmm_2.05/R/buildZ.R~
>> unlink MCMCglmm_2.05/R/plotsubspace.R~
>> unlink MCMCglmm_2.05/R/posterior.mode.R~
>> unlink MCMCglmm_2.05/R/posterior.cor.R~
>> unlink MCMCglmm_2.05/R/split.direct.sum.R
>> unlink MCMCglmm_2.05/R/residuals (copy).MCMCglmm.R~
>> unlink MCMCglmm_2.05/R/Dexpressions.R~
>> unlink MCMCglmm_2.05/R/Ddivergence.R
>> unlink MCMCglmm_2.05/R/spl.R~
>> unlink MCMCglmm_2.05/R/Dexpressions.R
>> unlink MCMCglmm_2.05/R/mterms.R
>> unlink MCMCglmm_2.05/R/rtnorm.R
>> unlink MCMCglmm_2.05/R/inverseA.R~
>> unlink MCMCglmm_2.05/R/find.components.R~
>> unlink MCMCglmm_2.05/R/posterior.evals.R~
>> unlink MCMCglmm_2.05/R/multmemb.R~
>> unlink MCMCglmm_2.05/R/SStest.R~
>> unlink MCMCglmm_2.05/R/plotprior.R~
>> unlink MCMCglmm_2.05/R/find.components.R
>> unlink MCMCglmm_2.05/R/MCMCgompSInt.R~
>> unlink MCMCglmm_2.05/R/dcmvnorm.R~
>> unlink MCMCglmm_2.05/R/summary.MCMCglmm.R~
>> unlink MCMCglmm_2.05/R/buildZ.R
>> rmdir MCMCglmm_2.05/R
>> cannot remove directory for /home/jarrod/mnt/shared: Permission  
>> denied
>> at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/mnt/scieng1: Permission
>> denied at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/mnt: Directory not empty at
>> /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/.gvfs: Device or resource
>> busy at /usr/lib64/R/bin/build line 263
>> cannot make child directory read-write-exec for
>> /home/jarrod/.local/share/Trash/files/MasterBayes_2.2.4.Rcheck:
>> Operation not permitted at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/.local/share/Trash/files:
>> Directory not empty at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/.local/share/Trash:  
>> Directory
>> not empty at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/.local/share: Directory not
>> empty at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod/.local: Directory not empty
>> at /usr/lib64/R/bin/build line 263
>> cannot remove directory for /home/jarrod: Permission denied at
>> /usr/lib64/R/bin/build line 263
>> * checking for LF line-endings in source and make files
>> * checking for empty or unneeded directories
>> * building 'MCMCglmm_2.05.tar.gz'
>> tar: /home/jarrod/Work/AManal/MCMCglmm_2.05.tar: Cannot open: No such
>> file or directory
>> tar: Error is not recoverable: exiting now
>> gzip: /home/jarrod/Work/AManal/MCMCglmm_2.05.tar: No such file or  
>> directory
>> cannot remove path when cwd is /tmp/Rbuild93379662 for
>> /tmp/Rbuild93379662:  at /usr/lib64/R/bin/build line 433
>
>
>> -- 
>> The University of Edinburgh is a charitable body, registered in
>> Scotland, with registration number SC005336.
>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From djvanderlaan at gmail.com  Wed Jul 28 13:43:17 2010
From: djvanderlaan at gmail.com (Jan van der Laan)
Date: Wed, 28 Jul 2010 13:43:17 +0200
Subject: [Rd] Plot window does not update in embedded code
In-Reply-To: <8D9C1681-68C5-4C70-8ACB-783C49E24E40@r-project.org>
References: <AANLkTilIxmc9rrIs2NXLna_wXzQPLFH4tDHK-FOgk3gZ@mail.gmail.com>
	<201007212145.44130.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<666FFFC7-DA21-4EFE-80D2-B83F481D42B9@r-project.org>
	<9A7974C8-BC2F-4D3C-B67C-730710419614@r-project.org>
	<AANLkTim7ya982V1w1jgvbAZMohzeywlrqGRifr7n4bLD@mail.gmail.com>
	<8D9C1681-68C5-4C70-8ACB-783C49E24E40@r-project.org>
Message-ID: <AANLkTin90cAT0x6WXwERZWSO8JFSUAA_HqvMb0QJ0cCO@mail.gmail.com>

Took a while to find enough time to have a good look at this, but I
have this working now. I am using the for-loop calling the handlers.
Using only R_CheckUserInterrupt() did not work. It was a bit of work
to track down all of the function declarations in R's source.

Thanks!

Regards,
Jan



On Thu, Jul 22, 2010 at 4:06 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On Jul 22, 2010, at 3:31 AM, Jan van der Laan wrote:
>
>> Thomas, Simon,
>>
>> Thank you for your answers. I will have a look at the code Thomas gave
>> me and probably also have another look at src/unix/sys-std.c. I'll get
>> back when I have this working, or, more likely, when I can't get this
>> to work.
>>
>> As for the example code. I know it is very fragile. I tried to make a
>> minimal complete example that showed the problem without having to
>> attach hundreds of lines of code that nobody will read. However, what
>> parts are unix specific? Is it the int Rf_initialize_R and
>> R_running_as_main_program? What non os specific options do I have?
>>
>
> I was talking about the snippet Thomas sent - not your code - yours was nicely minimalistic. The issue with running the handlers by hand is that it's unix-only. But as I corrected in my second e-mail - it is the way to go right now since there is no alternative at the moment (again, you may get away with simply calling R_CheckUserInterrupt() but some devices may be using input handlers in which case it is not sufficient). The fact that you can check handlers manually is a good thing but it may be worth considering providing an API call like R_idle(int timeoutMillis) that does the job across all platforms.
>
> Cheers,
> Simon
>
>
>
>> Again thank you for your answers.
>>
>> Regards,
>>
>> Jan
>>
>> On Wed, Jul 21, 2010 at 10:52 PM, Simon Urbanek
>> <simon.urbanek at r-project.org> wrote:
>>>
>>> On Jul 21, 2010, at 4:28 PM, Simon Urbanek wrote:
>>>
>>>> Use
>>>> R_CheckUserInterrupt()
>>>>
>>>
>>> Actually, the above is true but assumes that you're running R's REPL and not your own R_ReadConsole (it will work even in your ReadConsole but unix handlers are not run in that case so only some events will work).
>>>
>>>
>>>> The code below is very fragile and unix-specific.
>>>>
>>>
>>> That is true, too, but even after R_ProcessEvenrts refactorization the handlers are still-unix specific so I stand corrected and you still have to run handlers manually (note that you don't need PolledEvents anymore since they are part of the handlers).
>>>
>>> Cheers,
>>> Simon
>>>
>>>
>>>>>
>>>>> On Wednesday 21 July 2010, Jan van der Laan wrote:
>>>>>> How do I ensure that the windows keep being updated?
>>>>>
>>>>> in RKWard we run the following periodically during idle phases:
>>>>>
>>>>>
>>>>> // this basically copied from R's unix/sys-std.c (Rstd_ReadConsole)
>>>>> #ifndef Q_WS_WIN
>>>>> ? ? ?for (;;) {
>>>>> ? ? ? ? ? ? ?fd_set *what;
>>>>> ? ? ? ? ? ? ?what = R_checkActivityEx(R_wait_usec > 0 ? R_wait_usec : 50, 1,
>>>>> Rf_onintr);
>>>>> ? ? ? ? ? ? ?R_runHandlers(R_InputHandlers, what);
>>>>> ? ? ? ? ? ? ?if (what == NULL) break;
>>>>> ? ? ?}
>>>>> ? ? ?/* This seems to be needed to make Rcmdr react to events. Has this always
>>>>> been the case? It was commented out for a long time, without anybody noticing.
>>>>> */
>>>>> ? ? ?R_PolledEvents ();
>>>>> #else
>>>>> ? ? ?R_ProcessEvents();
>>>>> #endif
>>>>>
>>>>>
>>>>> Regards
>>>>> Thomas
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>
>


From hb at stat.berkeley.edu  Wed Jul 28 15:37:25 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 28 Jul 2010 15:37:25 +0200
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <4C4DA7D1.9050001@gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>
	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>
	<4C4D71E8.4090600@gmail.com>
	<AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>
	<4C4DA7D1.9050001@gmail.com>
Message-ID: <AANLkTik3BC6+7C3BMmwTcU_4QCSQFw33HrFK8beYfssD@mail.gmail.com>

Hi,

by pure luck, I discovered that it has to do with the number of
characters (or similar) in the Windows system environment variable
'PATH'.  I used a custom PATH when it crashed.  When I tried to a
plain/fresh Command prompt, the PATH is shorter and then R.exe doesn't
crash.  This is that working PATH:

C:\Program Files\Common Files\Microsoft Shared\Windows
Live;c:\Rtools212\bin;c:\Rtools212\perl\bin;c:\Rtools212\MinGW\bin;c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\PROGRA~1\GTK2-R~1\bin;C:\Program
Files\MiKTeX 2.7\miktex\bin;c:\program
files\imagemagick-6.4.2-q16;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Program
Files\Common Files\Lenovo;C:\Program
Files\ThinkPad\ConnectUtilities;C:\Program Files\Lenovo\Client
Security Solution;C:\Program Files\Microsoft SQL
Server\90\Tools\binn\;C:\Program Files\GTK2-Runtime\lib;C:\Program
Files\aspell\bin;C:\Program
Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
Files\QuickTime\QTSystem\;C:\Program Files\Common Files\DivX
Shared\;C:\Program Files\SlikSvn\bin\;C:\Program
Files\ThinkPad\ConnectUtilities\;C:\Program
Files\TortoiseSVN\bin;C:\Program Files\Common Files\Microsoft
Shared\Windows Live;C:\Program Files\SSH Communications Security\SSH
Secure Shell;C:\Users\hb\bin

Starting with this PATH and making it longer and longer I can
eventually reproduce the crash again.  It occurs when my PATH is ~1182
characters long:

path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
path C:/1234567890/1234567/;%PATH%
echo %PATH% | wc
"%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"

If I make it a few characters shorter, R.exe starts, but when I do
quit() it crashes.

Note that there is no problem with Rterm.exe.

Thanks

/Henrik

PS. I've installed Microsoft Debug Diagnostic Tool v1.1 and tried to
get something useful out of it without much success.  If the above
PATH troubleshooting is not enough, I'll spend more time trying to
figure out how that tool works.


On Mon, Jul 26, 2010 at 5:20 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 26/07/2010 10:25 AM, Henrik Bengtsson wrote:
>>
>> Shame on me; I put important only in the subject line.
>>
>> It's Windows Vista Business 32-bit (Service Pack 2) English with the
>> latest updates.
>>
>
> Oops, didn't notice that. ?I don't have a Vista machine to test on. ?I don't see the crash on a slightly newer build of R on XP SP3 or Windows 7.
>
> If you know of a debugger that can dump a stack trace at the time of the crash, that would be helpful information. ?(We used to use Dr. Watson for this, but I don't think it works in Vista/Win 7. ?I've heard of something called "userdump", but never tried it.)
>
> Duncan Murdoch
>>
>> /Henrik
>>
>> On Mon, Jul 26, 2010 at 1:30 PM, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>> > On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
>> >>
>> >> Just FYI: Problem remains (on same system) with "R version 2.12.0
>> >> Under development (unstable) (2010-07-21 r52590)":
>> >>
>> >> Problem signature:
>> >> ?Problem Event Name: ? APPCRASH
>> >> ?Application Name: ? ? R.exe
>> >> ?Application Version: ?2.120.52590.0
>> >> ?Application Timestamp: ? ? ? ?4c471362
>> >> ?Fault Module Name: ? ?R.exe
>> >> ?Fault Module Version: 2.120.52590.0
>> >> ?Fault Module Timestamp: ? ? ? 4c471362
>> >> ?Exception Code: ? ? ? c0000005
>> >> ?Exception Offset: ? ? 0000240e
>> >> ?OS Version: ? 6.0.6002.2.2.0.256.6
>> >
>> > What is your OS? I don't know the MS numbering scheme...
>> >
>> > Duncan Murdoch
>> >
>> >> ?Locale ID: ? ?1033
>> >> ?Additional Information 1: ? ? 8772
>> >> ?Additional Information 2: ? ? 9431192a7274b0ee769861df31ecee58
>> >> ?Additional Information 3: ? ? f768
>> >> ?Additional Information 4: ? ? 930d06d3f6aed4162dca7601993082f5
>> >>
>> >> Anyone knows if there anything else I can do to provide more debug
>> >> information on this?
>> >>
>> >> /Henrik
>> >>
>> >> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu>
>> >> wrote:
>> >>>
>> >>> Using the latest developers version of R [2.12.0 Under development
>> >>> (unstable) (2010-05-21 r52061)], R.exe crashes:
>> >>>
>> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>> >>>
>> >>> with Windows reporting:
>> >>>
>> >>> Problem signature:
>> >>> ?Problem Event Name: ? APPCRASH
>> >>> ?Application Name: ? ? R.exe
>> >>> ?Application Version: ?2.120.52061.0
>> >>> ?Application Timestamp: ? ? ? ?4bf638bd
>> >>> ?Fault Module Name: ? ?R.exe
>> >>> ?Fault Module Version: 2.120.52061.0
>> >>> ?Fault Module Timestamp: ? ? ? 4bf638bd
>> >>> ?Exception Code: ? ? ? c0000005
>> >>> ?Exception Offset: ? ? 00001d94
>> >>> ?OS Version: ? 6.0.6002.2.2.0.256.6
>> >>> ?Locale ID: ? ?1033
>> >>> ?Additional Information 1: ? ? 1c1d
>> >>> ?Additional Information 2: ? ? e064c795479179a5f08d19e37de8915e
>> >>> ?Additional Information 3: ? ? 50ea
>> >>> ?Additional Information 4: ? ? 02a385f4f3dcffff3301c3a9d270f946
>> >>>
>> >>> same occurs when calling:
>> >>>
>> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
>> >>>
>> >>> However,
>> >>>
>> >>>
>> >>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
>> >>> -e "sessionInfo()"
>> >>>
>> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>> >>> Copyright (C) 2010 The R Foundation for Statistical Computing
>> >>> ISBN 3-900051-07-0
>> >>> Platform: i386-pc-mingw32/i386 (32-bit)
>> >>>
>> >>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> >>> You are welcome to redistribute it under certain conditions.
>> >>> Type 'license()' or 'licence()' for distribution details.
>> >>>
>> >>> ?Natural language support but running in an English locale
>> >>>
>> >>> R is a collaborative project with many contributors.
>> >>> Type 'contributors()' for more information and
>> >>> 'citation()' on how to cite R or R packages in publications.
>> >>>
>> >>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> >>> 'help.start()' for an HTML browser interface to help.
>> >>> Type 'q()' to quit R.
>> >>>
>> >>>> sessionInfo()
>> >>>
>> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>> >>> i386-pc-mingw32
>> >>>
>> >>> locale:
>> >>> [1] LC_COLLATE=English_United States.1252
>> >>> [2] LC_CTYPE=English_United States.1252
>> >>> [3] LC_MONETARY=English_United States.1252
>> >>> [4] LC_NUMERIC=C
>> >>> [5] LC_TIME=English_United States.1252
>> >>>
>> >>> attached base packages:
>> >>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>> >>>
>> >>
>> >> ______________________________________________
>> >> R-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>> >
>>
>
>


From murdoch.duncan at gmail.com  Wed Jul 28 17:06:09 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 28 Jul 2010 11:06:09 -0400
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <AANLkTik3BC6+7C3BMmwTcU_4QCSQFw33HrFK8beYfssD@mail.gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>	<4C4D71E8.4090600@gmail.com>	<AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>	<4C4DA7D1.9050001@gmail.com>
	<AANLkTik3BC6+7C3BMmwTcU_4QCSQFw33HrFK8beYfssD@mail.gmail.com>
Message-ID: <4C504761.9030103@gmail.com>

On 28/07/2010 9:37 AM, Henrik Bengtsson wrote:
> Hi,
>
> by pure luck, I discovered that it has to do with the number of
> characters (or similar) in the Windows system environment variable
> 'PATH'.  I used a custom PATH when it crashed.  When I tried to a
> plain/fresh Command prompt, the PATH is shorter and then R.exe doesn't
> crash.  This is that working PATH:
>   

Thanks, I can reproduce it now.  Should be fixable.

Duncan Murdoch
> C:\Program Files\Common Files\Microsoft Shared\Windows
> Live;c:\Rtools212\bin;c:\Rtools212\perl\bin;c:\Rtools212\MinGW\bin;c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\PROGRA~1\GTK2-R~1\bin;C:\Program
> Files\MiKTeX 2.7\miktex\bin;c:\program
> files\imagemagick-6.4.2-q16;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Program
> Files\Common Files\Lenovo;C:\Program
> Files\ThinkPad\ConnectUtilities;C:\Program Files\Lenovo\Client
> Security Solution;C:\Program Files\Microsoft SQL
> Server\90\Tools\binn\;C:\Program Files\GTK2-Runtime\lib;C:\Program
> Files\aspell\bin;C:\Program
> Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
> Files\QuickTime\QTSystem\;C:\Program Files\Common Files\DivX
> Shared\;C:\Program Files\SlikSvn\bin\;C:\Program
> Files\ThinkPad\ConnectUtilities\;C:\Program
> Files\TortoiseSVN\bin;C:\Program Files\Common Files\Microsoft
> Shared\Windows Live;C:\Program Files\SSH Communications Security\SSH
> Secure Shell;C:\Users\hb\bin
>
> Starting with this PATH and making it longer and longer I can
> eventually reproduce the crash again.  It occurs when my PATH is ~1182
> characters long:
>
> path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
> path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
> path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
> path C:/1234567890/1234567/;%PATH%
> echo %PATH% | wc
> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>
> If I make it a few characters shorter, R.exe starts, but when I do
> quit() it crashes.
>
> Note that there is no problem with Rterm.exe.
>
> Thanks
>
> /Henrik
>
> PS. I've installed Microsoft Debug Diagnostic Tool v1.1 and tried to
> get something useful out of it without much success.  If the above
> PATH troubleshooting is not enough, I'll spend more time trying to
> figure out how that tool works.
>
>
> On Mon, Jul 26, 2010 at 5:20 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
> > On 26/07/2010 10:25 AM, Henrik Bengtsson wrote:
> >>
> >> Shame on me; I put important only in the subject line.
> >>
> >> It's Windows Vista Business 32-bit (Service Pack 2) English with the
> >> latest updates.
> >>
> >
> > Oops, didn't notice that.  I don't have a Vista machine to test on.  I don't see the crash on a slightly newer build of R on XP SP3 or Windows 7.
> >
> > If you know of a debugger that can dump a stack trace at the time of the crash, that would be helpful information.  (We used to use Dr. Watson for this, but I don't think it works in Vista/Win 7.  I've heard of something called "userdump", but never tried it.)
> >
> > Duncan Murdoch
> >>
> >> /Henrik
> >>
> >> On Mon, Jul 26, 2010 at 1:30 PM, Duncan Murdoch
> >> <murdoch.duncan at gmail.com> wrote:
> >> > On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
> >> >>
> >> >> Just FYI: Problem remains (on same system) with "R version 2.12.0
> >> >> Under development (unstable) (2010-07-21 r52590)":
> >> >>
> >> >> Problem signature:
> >> >>  Problem Event Name:   APPCRASH
> >> >>  Application Name:     R.exe
> >> >>  Application Version:  2.120.52590.0
> >> >>  Application Timestamp:        4c471362
> >> >>  Fault Module Name:    R.exe
> >> >>  Fault Module Version: 2.120.52590.0
> >> >>  Fault Module Timestamp:       4c471362
> >> >>  Exception Code:       c0000005
> >> >>  Exception Offset:     0000240e
> >> >>  OS Version:   6.0.6002.2.2.0.256.6
> >> >
> >> > What is your OS? I don't know the MS numbering scheme...
> >> >
> >> > Duncan Murdoch
> >> >
> >> >>  Locale ID:    1033
> >> >>  Additional Information 1:     8772
> >> >>  Additional Information 2:     9431192a7274b0ee769861df31ecee58
> >> >>  Additional Information 3:     f768
> >> >>  Additional Information 4:     930d06d3f6aed4162dca7601993082f5
> >> >>
> >> >> Anyone knows if there anything else I can do to provide more debug
> >> >> information on this?
> >> >>
> >> >> /Henrik
> >> >>
> >> >> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu>
> >> >> wrote:
> >> >>>
> >> >>> Using the latest developers version of R [2.12.0 Under development
> >> >>> (unstable) (2010-05-21 r52061)], R.exe crashes:
> >> >>>
> >> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
> >> >>>
> >> >>> with Windows reporting:
> >> >>>
> >> >>> Problem signature:
> >> >>>  Problem Event Name:   APPCRASH
> >> >>>  Application Name:     R.exe
> >> >>>  Application Version:  2.120.52061.0
> >> >>>  Application Timestamp:        4bf638bd
> >> >>>  Fault Module Name:    R.exe
> >> >>>  Fault Module Version: 2.120.52061.0
> >> >>>  Fault Module Timestamp:       4bf638bd
> >> >>>  Exception Code:       c0000005
> >> >>>  Exception Offset:     00001d94
> >> >>>  OS Version:   6.0.6002.2.2.0.256.6
> >> >>>  Locale ID:    1033
> >> >>>  Additional Information 1:     1c1d
> >> >>>  Additional Information 2:     e064c795479179a5f08d19e37de8915e
> >> >>>  Additional Information 3:     50ea
> >> >>>  Additional Information 4:     02a385f4f3dcffff3301c3a9d270f946
> >> >>>
> >> >>> same occurs when calling:
> >> >>>
> >> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
> >> >>>
> >> >>> However,
> >> >>>
> >> >>>
> >> >>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
> >> >>> -e "sessionInfo()"
> >> >>>
> >> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> >> >>> Copyright (C) 2010 The R Foundation for Statistical Computing
> >> >>> ISBN 3-900051-07-0
> >> >>> Platform: i386-pc-mingw32/i386 (32-bit)
> >> >>>
> >> >>> R is free software and comes with ABSOLUTELY NO WARRANTY.
> >> >>> You are welcome to redistribute it under certain conditions.
> >> >>> Type 'license()' or 'licence()' for distribution details.
> >> >>>
> >> >>>  Natural language support but running in an English locale
> >> >>>
> >> >>> R is a collaborative project with many contributors.
> >> >>> Type 'contributors()' for more information and
> >> >>> 'citation()' on how to cite R or R packages in publications.
> >> >>>
> >> >>> Type 'demo()' for some demos, 'help()' for on-line help, or
> >> >>> 'help.start()' for an HTML browser interface to help.
> >> >>> Type 'q()' to quit R.
> >> >>>
> >> >>>> sessionInfo()
> >> >>>
> >> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> >> >>> i386-pc-mingw32
> >> >>>
> >> >>> locale:
> >> >>> [1] LC_COLLATE=English_United States.1252
> >> >>> [2] LC_CTYPE=English_United States.1252
> >> >>> [3] LC_MONETARY=English_United States.1252
> >> >>> [4] LC_NUMERIC=C
> >> >>> [5] LC_TIME=English_United States.1252
> >> >>>
> >> >>> attached base packages:
> >> >>> [1] stats     graphics  grDevices utils     datasets  methods   base
> >> >>>
> >> >>
> >> >> ______________________________________________
> >> >> R-devel at r-project.org mailing list
> >> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >
> >> >
> >>
> >
> >
>


From murdoch.duncan at gmail.com  Wed Jul 28 18:24:25 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 28 Jul 2010 12:24:25 -0400
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <4C504761.9030103@gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>	<4C4D71E8.4090600@gmail.com>	<AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>	<4C4DA7D1.9050001@gmail.com>
	<AANLkTik3BC6+7C3BMmwTcU_4QCSQFw33HrFK8beYfssD@mail.gmail.com>
	<4C504761.9030103@gmail.com>
Message-ID: <4C5059B9.6090105@gmail.com>

On 28/07/2010 11:06 AM, Duncan Murdoch wrote:
> On 28/07/2010 9:37 AM, Henrik Bengtsson wrote:
> > Hi,
> >
> > by pure luck, I discovered that it has to do with the number of
> > characters (or similar) in the Windows system environment variable
> > 'PATH'.  I used a custom PATH when it crashed.  When I tried to a
> > plain/fresh Command prompt, the PATH is shorter and then R.exe doesn't
> > crash.  This is that working PATH:
> >   
>
> Thanks, I can reproduce it now.  Should be fixable.
>   

Yes, it was a buffer overflow.  I'll commit a change soon.

This only affected R-devel, not the current release.

Duncan Murdoch
> Duncan Murdoch
> > C:\Program Files\Common Files\Microsoft Shared\Windows
> > Live;c:\Rtools212\bin;c:\Rtools212\perl\bin;c:\Rtools212\MinGW\bin;c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\PROGRA~1\GTK2-R~1\bin;C:\Program
> > Files\MiKTeX 2.7\miktex\bin;c:\program
> > files\imagemagick-6.4.2-q16;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Program
> > Files\Common Files\Lenovo;C:\Program
> > Files\ThinkPad\ConnectUtilities;C:\Program Files\Lenovo\Client
> > Security Solution;C:\Program Files\Microsoft SQL
> > Server\90\Tools\binn\;C:\Program Files\GTK2-Runtime\lib;C:\Program
> > Files\aspell\bin;C:\Program
> > Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
> > Files\QuickTime\QTSystem\;C:\Program Files\Common Files\DivX
> > Shared\;C:\Program Files\SlikSvn\bin\;C:\Program
> > Files\ThinkPad\ConnectUtilities\;C:\Program
> > Files\TortoiseSVN\bin;C:\Program Files\Common Files\Microsoft
> > Shared\Windows Live;C:\Program Files\SSH Communications Security\SSH
> > Secure Shell;C:\Users\hb\bin
> >
> > Starting with this PATH and making it longer and longer I can
> > eventually reproduce the crash again.  It occurs when my PATH is ~1182
> > characters long:
> >
> > path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
> > path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
> > path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
> > path C:/1234567890/1234567/;%PATH%
> > echo %PATH% | wc
> > "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
> >
> > If I make it a few characters shorter, R.exe starts, but when I do
> > quit() it crashes.
> >
> > Note that there is no problem with Rterm.exe.
> >
> > Thanks
> >
> > /Henrik
> >
> > PS. I've installed Microsoft Debug Diagnostic Tool v1.1 and tried to
> > get something useful out of it without much success.  If the above
> > PATH troubleshooting is not enough, I'll spend more time trying to
> > figure out how that tool works.
> >
> >
> > On Mon, Jul 26, 2010 at 5:20 PM, Duncan Murdoch
> > <murdoch.duncan at gmail.com> wrote:
> > > On 26/07/2010 10:25 AM, Henrik Bengtsson wrote:
> > >>
> > >> Shame on me; I put important only in the subject line.
> > >>
> > >> It's Windows Vista Business 32-bit (Service Pack 2) English with the
> > >> latest updates.
> > >>
> > >
> > > Oops, didn't notice that.  I don't have a Vista machine to test on.  I don't see the crash on a slightly newer build of R on XP SP3 or Windows 7.
> > >
> > > If you know of a debugger that can dump a stack trace at the time of the crash, that would be helpful information.  (We used to use Dr. Watson for this, but I don't think it works in Vista/Win 7.  I've heard of something called "userdump", but never tried it.)
> > >
> > > Duncan Murdoch
> > >>
> > >> /Henrik
> > >>
> > >> On Mon, Jul 26, 2010 at 1:30 PM, Duncan Murdoch
> > >> <murdoch.duncan at gmail.com> wrote:
> > >> > On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
> > >> >>
> > >> >> Just FYI: Problem remains (on same system) with "R version 2.12.0
> > >> >> Under development (unstable) (2010-07-21 r52590)":
> > >> >>
> > >> >> Problem signature:
> > >> >>  Problem Event Name:   APPCRASH
> > >> >>  Application Name:     R.exe
> > >> >>  Application Version:  2.120.52590.0
> > >> >>  Application Timestamp:        4c471362
> > >> >>  Fault Module Name:    R.exe
> > >> >>  Fault Module Version: 2.120.52590.0
> > >> >>  Fault Module Timestamp:       4c471362
> > >> >>  Exception Code:       c0000005
> > >> >>  Exception Offset:     0000240e
> > >> >>  OS Version:   6.0.6002.2.2.0.256.6
> > >> >
> > >> > What is your OS? I don't know the MS numbering scheme...
> > >> >
> > >> > Duncan Murdoch
> > >> >
> > >> >>  Locale ID:    1033
> > >> >>  Additional Information 1:     8772
> > >> >>  Additional Information 2:     9431192a7274b0ee769861df31ecee58
> > >> >>  Additional Information 3:     f768
> > >> >>  Additional Information 4:     930d06d3f6aed4162dca7601993082f5
> > >> >>
> > >> >> Anyone knows if there anything else I can do to provide more debug
> > >> >> information on this?
> > >> >>
> > >> >> /Henrik
> > >> >>
> > >> >> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson <hb at stat.berkeley.edu>
> > >> >> wrote:
> > >> >>>
> > >> >>> Using the latest developers version of R [2.12.0 Under development
> > >> >>> (unstable) (2010-05-21 r52061)], R.exe crashes:
> > >> >>>
> > >> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
> > >> >>>
> > >> >>> with Windows reporting:
> > >> >>>
> > >> >>> Problem signature:
> > >> >>>  Problem Event Name:   APPCRASH
> > >> >>>  Application Name:     R.exe
> > >> >>>  Application Version:  2.120.52061.0
> > >> >>>  Application Timestamp:        4bf638bd
> > >> >>>  Fault Module Name:    R.exe
> > >> >>>  Fault Module Version: 2.120.52061.0
> > >> >>>  Fault Module Timestamp:       4bf638bd
> > >> >>>  Exception Code:       c0000005
> > >> >>>  Exception Offset:     00001d94
> > >> >>>  OS Version:   6.0.6002.2.2.0.256.6
> > >> >>>  Locale ID:    1033
> > >> >>>  Additional Information 1:     1c1d
> > >> >>>  Additional Information 2:     e064c795479179a5f08d19e37de8915e
> > >> >>>  Additional Information 3:     50ea
> > >> >>>  Additional Information 4:     02a385f4f3dcffff3301c3a9d270f946
> > >> >>>
> > >> >>> same occurs when calling:
> > >> >>>
> > >> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
> > >> >>>
> > >> >>> However,
> > >> >>>
> > >> >>>
> > >> >>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
> > >> >>> -e "sessionInfo()"
> > >> >>>
> > >> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> > >> >>> Copyright (C) 2010 The R Foundation for Statistical Computing
> > >> >>> ISBN 3-900051-07-0
> > >> >>> Platform: i386-pc-mingw32/i386 (32-bit)
> > >> >>>
> > >> >>> R is free software and comes with ABSOLUTELY NO WARRANTY.
> > >> >>> You are welcome to redistribute it under certain conditions.
> > >> >>> Type 'license()' or 'licence()' for distribution details.
> > >> >>>
> > >> >>>  Natural language support but running in an English locale
> > >> >>>
> > >> >>> R is a collaborative project with many contributors.
> > >> >>> Type 'contributors()' for more information and
> > >> >>> 'citation()' on how to cite R or R packages in publications.
> > >> >>>
> > >> >>> Type 'demo()' for some demos, 'help()' for on-line help, or
> > >> >>> 'help.start()' for an HTML browser interface to help.
> > >> >>> Type 'q()' to quit R.
> > >> >>>
> > >> >>>> sessionInfo()
> > >> >>>
> > >> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
> > >> >>> i386-pc-mingw32
> > >> >>>
> > >> >>> locale:
> > >> >>> [1] LC_COLLATE=English_United States.1252
> > >> >>> [2] LC_CTYPE=English_United States.1252
> > >> >>> [3] LC_MONETARY=English_United States.1252
> > >> >>> [4] LC_NUMERIC=C
> > >> >>> [5] LC_TIME=English_United States.1252
> > >> >>>
> > >> >>> attached base packages:
> > >> >>> [1] stats     graphics  grDevices utils     datasets  methods   base
> > >> >>>
> > >> >>
> > >> >> ______________________________________________
> > >> >> R-devel at r-project.org mailing list
> > >> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> > >> >
> > >> >
> > >>
> > >
> > >
> >   
>
>


From hb at stat.berkeley.edu  Wed Jul 28 19:25:04 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 28 Jul 2010 19:25:04 +0200
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
In-Reply-To: <4C5059B9.6090105@gmail.com>
References: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>
	<AANLkTimnY9GbqTPMGeTK8PYTXzGviGvRXFL6J7j7+82W@mail.gmail.com>
	<4C4D71E8.4090600@gmail.com>
	<AANLkTimV7RdMGehp4gq07GFc7FYadYunT-cKgktXY2st@mail.gmail.com>
	<4C4DA7D1.9050001@gmail.com>
	<AANLkTik3BC6+7C3BMmwTcU_4QCSQFw33HrFK8beYfssD@mail.gmail.com>
	<4C504761.9030103@gmail.com> <4C5059B9.6090105@gmail.com>
Message-ID: <AANLkTim8ByMZokTdGWjqwLXPiVD0-esQ1YNWqCkR_5G+@mail.gmail.com>

On Wed, Jul 28, 2010 at 6:24 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 28/07/2010 11:06 AM, Duncan Murdoch wrote:
>>
>> On 28/07/2010 9:37 AM, Henrik Bengtsson wrote:
>> > Hi,
>> >
>> > by pure luck, I discovered that it has to do with the number of
>> > characters (or similar) in the Windows system environment variable
>> > 'PATH'. ?I used a custom PATH when it crashed. ?When I tried to a
>> > plain/fresh Command prompt, the PATH is shorter and then R.exe doesn't
>> > crash. ?This is that working PATH:
>> >
>> Thanks, I can reproduce it now. ?Should be fixable.
>>
>
> Yes, it was a buffer overflow. ?I'll commit a change soon.

Duncan, thanks for fixing.

/Henrik

>
> This only affected R-devel, not the current release.
>
> Duncan Murdoch
>>
>> Duncan Murdoch
>> > C:\Program Files\Common Files\Microsoft Shared\Windows
>> >
>> > Live;c:\Rtools212\bin;c:\Rtools212\perl\bin;c:\Rtools212\MinGW\bin;c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\PROGRA~1\GTK2-R~1\bin;C:\Program
>> > Files\MiKTeX 2.7\miktex\bin;c:\program
>> >
>> > files\imagemagick-6.4.2-q16;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Program
>> > Files\Common Files\Lenovo;C:\Program
>> > Files\ThinkPad\ConnectUtilities;C:\Program Files\Lenovo\Client
>> > Security Solution;C:\Program Files\Microsoft SQL
>> > Server\90\Tools\binn\;C:\Program Files\GTK2-Runtime\lib;C:\Program
>> > Files\aspell\bin;C:\Program
>> >
>> > Files\TortoiseSVN\bin;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program
>> > Files\QuickTime\QTSystem\;C:\Program Files\Common Files\DivX
>> > Shared\;C:\Program Files\SlikSvn\bin\;C:\Program
>> > Files\ThinkPad\ConnectUtilities\;C:\Program
>> > Files\TortoiseSVN\bin;C:\Program Files\Common Files\Microsoft
>> > Shared\Windows Live;C:\Program Files\SSH Communications Security\SSH
>> > Secure Shell;C:\Users\hb\bin
>> >
>> > Starting with this PATH and making it longer and longer I can
>> > eventually reproduce the crash again. ?It occurs when my PATH is ~1182
>> > characters long:
>> >
>> > path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
>> > path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
>> > path C:/1234567890/1234567890/1234567890/1234567890/1234567890/;%PATH%
>> > path C:/1234567890/1234567/;%PATH%
>> > echo %PATH% | wc
>> > "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>> >
>> > If I make it a few characters shorter, R.exe starts, but when I do
>> > quit() it crashes.
>> >
>> > Note that there is no problem with Rterm.exe.
>> >
>> > Thanks
>> >
>> > /Henrik
>> >
>> > PS. I've installed Microsoft Debug Diagnostic Tool v1.1 and tried to
>> > get something useful out of it without much success. ?If the above
>> > PATH troubleshooting is not enough, I'll spend more time trying to
>> > figure out how that tool works.
>> >
>> >
>> > On Mon, Jul 26, 2010 at 5:20 PM, Duncan Murdoch
>> > <murdoch.duncan at gmail.com> wrote:
>> > > On 26/07/2010 10:25 AM, Henrik Bengtsson wrote:
>> > >>
>> > >> Shame on me; I put important only in the subject line.
>> > >>
>> > >> It's Windows Vista Business 32-bit (Service Pack 2) English with the
>> > >> latest updates.
>> > >>
>> > >
>> > > Oops, didn't notice that. ?I don't have a Vista machine to test on. ?I
>> > > don't see the crash on a slightly newer build of R on XP SP3 or Windows 7.
>> > >
>> > > If you know of a debugger that can dump a stack trace at the time of
>> > > the crash, that would be helpful information. ?(We used to use Dr. Watson
>> > > for this, but I don't think it works in Vista/Win 7. ?I've heard of
>> > > something called "userdump", but never tried it.)
>> > >
>> > > Duncan Murdoch
>> > >>
>> > >> /Henrik
>> > >>
>> > >> On Mon, Jul 26, 2010 at 1:30 PM, Duncan Murdoch
>> > >> <murdoch.duncan at gmail.com> wrote:
>> > >> > On 26/07/2010 5:15 AM, Henrik Bengtsson wrote:
>> > >> >>
>> > >> >> Just FYI: Problem remains (on same system) with "R version 2.12.0
>> > >> >> Under development (unstable) (2010-07-21 r52590)":
>> > >> >>
>> > >> >> Problem signature:
>> > >> >> ?Problem Event Name: ? APPCRASH
>> > >> >> ?Application Name: ? ? R.exe
>> > >> >> ?Application Version: ?2.120.52590.0
>> > >> >> ?Application Timestamp: ? ? ? ?4c471362
>> > >> >> ?Fault Module Name: ? ?R.exe
>> > >> >> ?Fault Module Version: 2.120.52590.0
>> > >> >> ?Fault Module Timestamp: ? ? ? 4c471362
>> > >> >> ?Exception Code: ? ? ? c0000005
>> > >> >> ?Exception Offset: ? ? 0000240e
>> > >> >> ?OS Version: ? 6.0.6002.2.2.0.256.6
>> > >> >
>> > >> > What is your OS? I don't know the MS numbering scheme...
>> > >> >
>> > >> > Duncan Murdoch
>> > >> >
>> > >> >> ?Locale ID: ? ?1033
>> > >> >> ?Additional Information 1: ? ? 8772
>> > >> >> ?Additional Information 2: ? ? 9431192a7274b0ee769861df31ecee58
>> > >> >> ?Additional Information 3: ? ? f768
>> > >> >> ?Additional Information 4: ? ? 930d06d3f6aed4162dca7601993082f5
>> > >> >>
>> > >> >> Anyone knows if there anything else I can do to provide more debug
>> > >> >> information on this?
>> > >> >>
>> > >> >> /Henrik
>> > >> >>
>> > >> >> On Sat, May 22, 2010 at 10:37 AM, Henrik Bengtsson
>> > >> >> <hb at stat.berkeley.edu>
>> > >> >> wrote:
>> > >> >>>
>> > >> >>> Using the latest developers version of R [2.12.0 Under
>> > >> >>> development
>> > >> >>> (unstable) (2010-05-21 r52061)], R.exe crashes:
>> > >> >>>
>> > >> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"
>> > >> >>>
>> > >> >>> with Windows reporting:
>> > >> >>>
>> > >> >>> Problem signature:
>> > >> >>> ?Problem Event Name: ? APPCRASH
>> > >> >>> ?Application Name: ? ? R.exe
>> > >> >>> ?Application Version: ?2.120.52061.0
>> > >> >>> ?Application Timestamp: ? ? ? ?4bf638bd
>> > >> >>> ?Fault Module Name: ? ?R.exe
>> > >> >>> ?Fault Module Version: 2.120.52061.0
>> > >> >>> ?Fault Module Timestamp: ? ? ? 4bf638bd
>> > >> >>> ?Exception Code: ? ? ? c0000005
>> > >> >>> ?Exception Offset: ? ? 00001d94
>> > >> >>> ?OS Version: ? 6.0.6002.2.2.0.256.6
>> > >> >>> ?Locale ID: ? ?1033
>> > >> >>> ?Additional Information 1: ? ? 1c1d
>> > >> >>> ?Additional Information 2: ? ? e064c795479179a5f08d19e37de8915e
>> > >> >>> ?Additional Information 3: ? ? 50ea
>> > >> >>> ?Additional Information 4: ? ? 02a385f4f3dcffff3301c3a9d270f946
>> > >> >>>
>> > >> >>> same occurs when calling:
>> > >> >>>
>> > >> >>> "%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"
>> > >> >>>
>> > >> >>> However,
>> > >> >>>
>> > >> >>>
>> > >> >>>
>> > >> >>> C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
>> > >> >>> -e "sessionInfo()"
>> > >> >>>
>> > >> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>> > >> >>> Copyright (C) 2010 The R Foundation for Statistical Computing
>> > >> >>> ISBN 3-900051-07-0
>> > >> >>> Platform: i386-pc-mingw32/i386 (32-bit)
>> > >> >>>
>> > >> >>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> > >> >>> You are welcome to redistribute it under certain conditions.
>> > >> >>> Type 'license()' or 'licence()' for distribution details.
>> > >> >>>
>> > >> >>> ?Natural language support but running in an English locale
>> > >> >>>
>> > >> >>> R is a collaborative project with many contributors.
>> > >> >>> Type 'contributors()' for more information and
>> > >> >>> 'citation()' on how to cite R or R packages in publications.
>> > >> >>>
>> > >> >>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> > >> >>> 'help.start()' for an HTML browser interface to help.
>> > >> >>> Type 'q()' to quit R.
>> > >> >>>
>> > >> >>>> sessionInfo()
>> > >> >>>
>> > >> >>> R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
>> > >> >>> i386-pc-mingw32
>> > >> >>>
>> > >> >>> locale:
>> > >> >>> [1] LC_COLLATE=English_United States.1252
>> > >> >>> [2] LC_CTYPE=English_United States.1252
>> > >> >>> [3] LC_MONETARY=English_United States.1252
>> > >> >>> [4] LC_NUMERIC=C
>> > >> >>> [5] LC_TIME=English_United States.1252
>> > >> >>>
>> > >> >>> attached base packages:
>> > >> >>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods
>> > >> >>> base
>> > >> >>>
>> > >> >>
>> > >> >> ______________________________________________
>> > >> >> R-devel at r-project.org mailing list
>> > >> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> > >> >
>> > >> >
>> > >>
>> > >
>> > >
>> >
>>
>
>


From pdalgd at gmail.com  Thu Jul 29 08:10:59 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Thu, 29 Jul 2010 08:10:59 +0200
Subject: [Rd] problem with zero-weighted observations in predict.lm?
In-Reply-To: <4C4F413F.5020901@gmail.com>
References: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
	<4C4F413F.5020901@gmail.com>
Message-ID: <4C511B73.2070504@gmail.com>

Peter Dalgaard wrote:
> William Dunlap wrote:
>> In modelling functions some people like to use
>> a weight of 0 to drop an observation instead of
>> using a subset value of FALSE.  E.g.,
>>   weights=c(0,1,1,...)
>> instead of
>>   subset=c(FALSE, TRUE, TRUE, ...)
>> to drop the first observation.
>>
>> lm() and summary.lm() appear to treat these in the
>> same way, decrementing the number of degrees of
>> freedom for each dropped observation.  However,
>> predict.lm() does not treat them the same.  It
>> doesn't seem to diminish the df to account for the
>> 0-weighted observations.   E.g., the last printout
>> from the following script is as follows, where
>> predw is the prediction from the fit that used
>> 0-weights and preds is from using FALSE's in the
>> subset argument.  Is this difference proper?
> 
> Nice catch.
> 
> The issue is that the subset fit and the zero-weighted fit are not
> completely the same. Notice that the residuals vector has different
> length in the two analyses. With a simplified setup:
> 
>> length(lm(y~1,weights=w)$residuals)
> [1] 10
>> length(lm(y~1,subset=-1)$residuals)
> [1] 9
>> w
>  [1] 0 1 1 1 1 1 1 1 1 1
> 
> This in turn is what confuses predict.lm because it gets n and residual
> df from length(object$residuals). summary.lm() uses NROW(Qr$qr), and I
> suppose that predict.lm should follow suit.
> 

...and then when I went to fix it, I found that the actual line in the
sources (stats/R/lm.R) reads

 27442     ripley     n <- length(object$residuals) # NROW(object$qr$qr)

so it's been like that since December 2003. I wonder if Brian remembers
what the point was? (27442 was the restructuring into the stats package,
so it might not actually be Brian's code).

-pd


-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ripley at stats.ox.ac.uk  Thu Jul 29 08:34:26 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 29 Jul 2010 07:34:26 +0100 (BST)
Subject: [Rd] problem with zero-weighted observations in predict.lm?
In-Reply-To: <4C511B73.2070504@gmail.com>
References: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
	<4C4F413F.5020901@gmail.com> <4C511B73.2070504@gmail.com>
Message-ID: <alpine.LFD.2.00.1007290714420.32203@gannet.stats.ox.ac.uk>

On Thu, 29 Jul 2010, Peter Dalgaard wrote:

> Peter Dalgaard wrote:
>> William Dunlap wrote:
>>> In modelling functions some people like to use
>>> a weight of 0 to drop an observation instead of
>>> using a subset value of FALSE.  E.g.,
>>>   weights=c(0,1,1,...)
>>> instead of
>>>   subset=c(FALSE, TRUE, TRUE, ...)
>>> to drop the first observation.
>>>
>>> lm() and summary.lm() appear to treat these in the
>>> same way, decrementing the number of degrees of
>>> freedom for each dropped observation.  However,
>>> predict.lm() does not treat them the same.  It
>>> doesn't seem to diminish the df to account for the
>>> 0-weighted observations.   E.g., the last printout
>>> from the following script is as follows, where
>>> predw is the prediction from the fit that used
>>> 0-weights and preds is from using FALSE's in the
>>> subset argument.  Is this difference proper?
>>
>> Nice catch.
>>
>> The issue is that the subset fit and the zero-weighted fit are not
>> completely the same. Notice that the residuals vector has different
>> length in the two analyses. With a simplified setup:
>>
>>> length(lm(y~1,weights=w)$residuals)
>> [1] 10
>>> length(lm(y~1,subset=-1)$residuals)
>> [1] 9
>>> w
>>  [1] 0 1 1 1 1 1 1 1 1 1
>>
>> This in turn is what confuses predict.lm because it gets n and residual
>> df from length(object$residuals). summary.lm() uses NROW(Qr$qr), and I
>> suppose that predict.lm should follow suit.
>>
>
> ...and then when I went to fix it, I found that the actual line in the
> sources (stats/R/lm.R) reads
>
> 27442     ripley     n <- length(object$residuals) # NROW(object$qr$qr)
>
> so it's been like that since December 2003. I wonder if Brian remembers
> what the point was? (27442 was the restructuring into the stats package,
> so it might not actually be Brian's code).

At least that wasn't the point of change: the code was the same in R 
1.8.1 (pre-split).

I think you will find that 'n' is used in several ways in predict.lm, 
and since NA-handling was introduced in R 1.8.0 they may differ in 
value.  So the safest route seems to be to change just 'n' in

 		df <- n - p


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pdalgd at gmail.com  Thu Jul 29 09:43:41 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Thu, 29 Jul 2010 09:43:41 +0200
Subject: [Rd] problem with zero-weighted observations in predict.lm?
In-Reply-To: <alpine.LFD.2.00.1007290714420.32203@gannet.stats.ox.ac.uk>
References: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
	<4C4F413F.5020901@gmail.com> <4C511B73.2070504@gmail.com>
	<alpine.LFD.2.00.1007290714420.32203@gannet.stats.ox.ac.uk>
Message-ID: <4C51312D.5050200@gmail.com>

Prof Brian Ripley wrote:

> 
> I think you will find that 'n' is used in several ways in predict.lm, 
> and since NA-handling was introduced in R 1.8.0 they may differ in 
> value.  So the safest route seems to be to change just 'n' in
> 
>  		df <- n - p

Yes, that seems to fix things. Will commit to R-devel shortly.

-p

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From pdalgd at gmail.com  Thu Jul 29 10:11:53 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Thu, 29 Jul 2010 10:11:53 +0200
Subject: [Rd] problem with zero-weighted observations in predict.lm?
In-Reply-To: <4C51312D.5050200@gmail.com>
References: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
	<4C4F413F.5020901@gmail.com> <4C511B73.2070504@gmail.com>
	<alpine.LFD.2.00.1007290714420.32203@gannet.stats.ox.ac.uk>
	<4C51312D.5050200@gmail.com>
Message-ID: <4C5137C9.2040305@gmail.com>

Peter Dalgaard wrote:
> Prof Brian Ripley wrote:
> 
>> I think you will find that 'n' is used in several ways in predict.lm, 
>> and since NA-handling was introduced in R 1.8.0 they may differ in 
>> value.  So the safest route seems to be to change just 'n' in
>>
>>  		df <- n - p
> 
> Yes, that seems to fix things. Will commit to R-devel shortly.
> 
> -p
> 

Spoke too soon, it fixes Bill's case, but breaks one of the regression
tests!

In fact this goes deeper, summary.lm special-cases the same zero-rank
case by using length(residuals), so it also miscalculates with zero weights:

> fit <- lm(y~0,weights=c(0,rep(1,9)))
> summary(fit)

Call:
lm(formula = y ~ 0, weights = c(0, rep(1, 9)))

Residuals:
     Min       1Q   Median       3Q      Max
-1.95428 -1.40571 -0.42378 -0.05795  1.05518

No Coefficients

Residual standard error: 1.119 on 10 degrees of freedom

----

Hum. lm() actually returns df.residual, AFAICS in all cases, now why
don't we just use that throughout????


-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From Ray.Brownrigg at ecs.vuw.ac.nz  Thu Jul 29 02:10:49 2010
From: Ray.Brownrigg at ecs.vuw.ac.nz (Ray Brownrigg)
Date: Thu, 29 Jul 2010 12:10:49 +1200
Subject: [Rd] R CMD build wiped my computer (from R-help)
In-Reply-To: <201007291020.48419.Ray.Brownrigg@ecs.vuw.ac.nz>
References: <20100727213709.q1q0u1fm4ooo880s@www.staffmail.ed.ac.uk>
	<4C5048DB.3040108@gmail.com>
	<201007291020.48419.Ray.Brownrigg@ecs.vuw.ac.nz>
Message-ID: <201007291210.49277.Ray.Brownrigg@ecs.vuw.ac.nz>

NOTE: Now submitted to R-devel, as this seems more appropriate.

I may have spoken too soon about this having been fixed. (see below).

If I create another "unusual but not 'invalid'" filename in the R subdirectory, the 
behaviour is different from that reported below, and is similar to the original poster's 
output (the third "unlink" command, where "xyz" was "~"):

circa>  ls -al RColorBrewer/R
total 140
-rwxr-xr-x  1 ray  ecs  43988 Apr 17  2005    ColorBrewer.R~*
-rw-r--r--  1 ray  ecs      0 Jul 29 09:57    residuals.MCMCglmm.R?xyz
drwxr-xr-x  2 ray  ecs   4096 Jul 29 12:02 ./
drwxr-xr-x  5 ray  ecs   4096 Jul 29 11:49 ../
-rwxr-xr-x  1 ray  ecs  43988 Jul 29 09:57 ColorBrewer.R*
-rwxr-xr-x  1 ray  ecs  43988 Apr 17  2005 ColorBrewer.R~*
-rw-r--r--  1 ray  ecs      0 Jul 29 09:58 residuals.MCMCglmm.R
circa>
circa>
circa>  R CMD build RColorBrewer
* checking for file 'RColorBrewer/DESCRIPTION' ... OK
* preparing 'RColorBrewer':
* checking DESCRIPTION meta-information ... OK
* checking whether 'INDEX' is up-to-date ... NO
* use '--force' to overwrite the existing 'INDEX'
* removing junk files
unlink RColorBrewer/R/   ColorBrewer.R~
unlink RColorBrewer/R/ColorBrewer.R
unlink RColorBrewer/R/   residuals.MCMCglmm.R
xyz
unlink RColorBrewer/R/residuals.MCMCglmm.R
unlink RColorBrewer/R/ColorBrewer.R~
rmdir RColorBrewer/R
* checking for LF line-endings in source and make files
* checking for empty or unneeded directories
* building 'RColorBrewer_1.0-3.tar.gz'

circa>

Ray Brownrigg

On Thu, 29 Jul 2010, Ray Brownrigg wrote:
> On Thu, 29 Jul 2010, Duncan Murdoch wrote:
> > On 28/07/2010 10:01 AM, Jarrod Hadfield wrote:
> > > Hi Marc,
> > >
> > > Thanks for the info on recovery - most of it can pieced together from
> > > backups but a quick, cheap and easy method of recovery would have been
> > > nicer.
> > >
> > > My main concern is that this could happen again and that the "bug" is
> > > not limited to R 2.9. I would think that an accidental carriage return
> > > at the end of a file name (even a temporary one) would be a reasonably
> > > common phenomenon (I'm surprised I hadn't done it before).
> >
> > If you can put together a recipe to reproduce the problem (or a less
> > extreme version of R deleting files it shouldn't), we'll certainly fix
> > it.  But so far all we've got are guesses about what might have gone
> > wrong, and I don't think anyone has been able to reproduce the problem
> > on current R.
>
> Duncan:
>
> It looks to me like it has already been fixed, if indeed that was the
> problem.  In R-2.10.1, I tried to reproduce the problem (using
> RColorBrewer, since that was the smallest package I have a local copy of),
> and the build produced this:
>
> * removing junk files
> * excluding invalid files from 'RColorBrewer'
> Subdirectory 'R' contains invalid file names:
>   residuals.MCMCglmm.R xyz
>
> where the space shown between the "R" and the "xyz" was a newline
> character. [I didn't dare try using a "~" :-)]
>
> Ray Brownrigg
>
> > Duncan Murdoch
> >
> > > Cheers,
> > >
> > > Jarrod
> > >
> > > On 28 Jul 2010, at 14:04, Marc Schwartz wrote:
> > > > Jarrod,
> > > >
> > > > Noting your exchange with Martin, Martin brings up a point that
> > > > certainly I missed, which is that somehow the tilde ('~') character
> > > > got into the chain of events. As Martin noted, on Linuxen/Unixen
> > > > (including OSX), the tilde, when used in the context of file name
> > > > globbing, refers to your home directory. Thus, a command such as:
> > > >
> > > >  ls ~
> > > >
> > > > will list the files in your home directory. Similarly:
> > > >
> > > >  rm ~
> > > >
> > > > will remove the files there as well. If the -rf argument is added,
> > > > then the deletion becomes recursive through that directory tree,
> > > > which appears to be the case here.
> > > >
> > > > I am unclear, as Martin appears to be, as to the steps that caused
> > > > this to happen. That may yet be related in some fashion to Duncan's
> > > > hypothesis.
> > > >
> > > > That being said, the use of the tilde character as a suffix to
> > > > denote that a file is a backup version, is not limited to Fedora or
> > > > Linux, for that matter. It is quite common for many text editors
> > > > (eg. Emacs) to use this. As a result, it is also common for many
> > > > applications to ignore files that have a tilde suffix.
> > > >
> > > > Based upon your follow up posts to the original thread, it would
> > > > seem that you do not have any backups. The default ext3 file system
> > > > that is used on modern Linuxen, by design, makes it a bit more
> > > > difficult to recover deleted files. This is due to the unlinking of
> > > > file metadata at the file system data structure level, as opposed to
> > > > simply marking the file as deleted in the directory structures, as
> > > > happens on Windows.
> > > >
> > > > There is a utility called ext3undel
> > > > (http://projects.izzysoft.de/trac/ext3undel ), which is a wrapper of
> > > > sorts to other undelete utilities such as PhotoRec and foremost. I
> > > > have not used it/them, so cannot speak from personal experience. Thus
> > > > it would be a good idea to engage in some reviews of the
> > > > documentation and perhaps other online resources before proceeding.
> > > > The other
> > > > consideration is the Catch-22 of not copying anything new to your
> > > > existing HD, for fear of overwriting the lost files with new data. So
> > > > you would need to consider an approach of downloading these utilities
> > > > via another computer and then running them on the computer in
> > > > question from other media, such as a CD/DVD or USB HD.
> > > >
> > > > A more expensive option would be to use a professional data recovery
> > > > service, where you would have to consider the cost of recovery
> > > > versus your lost time. One option would be Kroll OnTrack UK
> > > > (http://www.ontrackdatarecovery.co.uk/ ). I happen to live about a
> > > > quarter mile from their world HQ here in a suburb of Minneapolis. I
> > > > have not used them myself, but others that I know have, with good
> > > > success. Again, this comes at a
> > > > potentially substantial monetary cost.
> > > >
> > > > The key is that if you have any hope to recover the deleted files,
> > > > you not copy anything new onto the hard drive in the mean time.
> > > > Doing so will decrease the possibility of file recovery to near 0.
> > > >
> > > > As Duncan noted, there is great empathy with your situation. We have
> > > > all gone through this at one time or another. In my case, it was
> > > > perhaps 20+ years ago, but as a result, I am quite anal retentive
> > > > about having backups, which I have done for some time on my systems,
> > > > hourly.
> > > >
> > > > HTH,
> > > >
> > > > Marc Schwartz
> > > >
> > > > On Jul 28, 2010, at 5:55 AM, Jarrod Hadfield wrote:
> > > >> Hi Martin,
> > > >>
> > > >> I think this is the most likely reason given that the name in the
> > > >> DESCRIPTION file does NOT have a version number. Even so, it is
> > > >> very easy to misname a file and then delete it/change its name (as
> > > >> I've done here) and I hope current versions of R would not cause
> > > >> this problem. Perhaps Fedora should not use ~ as its back up file
> > > >> suffixes?
> > > >>
> > > >> Cheers,
> > > >>
> > > >> Jarrod
> > > >>
> > > >> On 28 Jul 2010, at 11:41, Martin Maechler wrote:
> > > >>>>>>>> Jarrod Hadfield <j.hadfield at ed.ac.uk>
> > > >>>>>>>>  on Tue, 27 Jul 2010 21:37:09 +0100 writes:
> > > >>>>
> > > >>>> Hi, I ran R (version 2.9.0) CMD build under root in
> > > >>>> Fedora (9). When it tried to remove "junk files" it
> > > >>>> removed EVERYTHING in my local account! (See below).
> > > >>>>
> > > >>>> Can anyone tell me what happened,
> > > >>>
> > > >>> the culprit may lay here:
> > > >>>>> * removing junk files
> > > >>>>> unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
> > > >>>>> ~
> > > >>>
> > > >>> where it seems that someone (you?) have added a newline
> > > >>> in the filname, so instead of
> > > >>> 'residuals.MCMCglmm.R~'
> > > >>> you got
> > > >>>
> > > >>> 'residuals.MCMCglmm.R
> > > >>> ~'
> > > >>>
> > > >>> and the unlink / rm  command interpreted '~' as your home
> > > >>> directory.
> > > >>>
> > > >>> But I can hardly believe it.
> > > >>> This seems explanation seems a bit doubtful to me.. ...
> > > >>>
> > > >>>> and even more importantly if I can I restore what was lost.
> > > >>>
> > > >>> well, you just get it from the backup. You do daily backups, do
> > > >>> you?
> > > >>>
> > > >>> Regards,
> > > >>> Martin Maechler, ETH Zurich
> >
> > ______________________________________________
> > R-help at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html and provide commented,
> > minimal, self-contained, reproducible code.


From ligges at statistik.tu-dortmund.de  Thu Jul 29 13:43:29 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 29 Jul 2010 13:43:29 +0200
Subject: [Rd] CRAN updates?
In-Reply-To: <CA7FC08F-14E2-41DE-8C55-D8B6C75A0DD5@r-project.org>
References: <AANLkTimtRXqkrQJXqoZrERYRg71ofAw4nCyv9-eo2Cw=@mail.gmail.com>
	<CA7FC08F-14E2-41DE-8C55-D8B6C75A0DD5@r-project.org>
Message-ID: <4C516961.2010504@statistik.tu-dortmund.de>



On 27.07.2010 22:15, Simon Urbanek wrote:
>
> On Jul 27, 2010, at 9:56 AM, Dominick Samperi wrote:
>
>> It appears that after a package is updated the CRAN binaries for some OS's
>> are built
>> automatically and shortly after the update, while other OS's are not updated
>> for
>> some time (weeks in some cases).
>>
>> Is the process automated or is it partially manual for some OS's (like
>> Windows/w64
>> and Mac OS X)?
>>
>
> It is automated on Mac OS X (currently R builds start at midnight and package builds at 2am ET).


... as well as automated under all flavours for/of Windows.

Uwe



> Cheers,
> Simon
>
> PS: If you see delays (i.e. the check result is not available more than two days after the package is available on CRAN) it's a good idea to contact the corresponding binary maintainer (for OS X it's me) since things can break (packages can run mad and external servers can die).
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Thu Jul 29 13:50:01 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 29 Jul 2010 13:50:01 +0200
Subject: [Rd] R CMD check - "there is no package called"
In-Reply-To: <0FAAC3FE-862C-4B80-B322-B1957503DDB0@r-project.org>
References: <26588.7403.qm@web51804.mail.re2.yahoo.com>
	<0FAAC3FE-862C-4B80-B322-B1957503DDB0@r-project.org>
Message-ID: <4C516AE9.9090607@statistik.tu-dortmund.de>



On 26.07.2010 02:00, Simon Urbanek wrote:
>
> On Jul 24, 2010, at 9:02 AM, John Hendrickx wrote:
>
>> I'm trying to update my "perturb" package to get rid of some small warning
>> messages. The examples in "perturb" use the "Duncan" dataset from the "car"
>> package and I have "car" installed in R. But when I run "R CMD check", I get an
>> error message
>>
>>
>>> require("car")
>> Loading required package: car
>> Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
>> logical.return = TRUE,  :
>>   there is no package called 'car'
>>> data(Duncan)
>> Warning in data(Duncan) : data set 'Duncan' not found
>>
>> This is very strange, the example works fine if I just run it in R. This is the
>> example from the perturb.rd file:
>>
>>   \examples{
>> require("car")
>> data(Duncan)
>> attach(Duncan)
>> m1<-lm(prestige~income+education)
>> ...
>>
>> I'm using R 2.11.1 under Ubuntu 10.04. Perhaps the problem is related to the
>> packages being installed in my home directory. I've create an ~/.Renviron file
>> with
>>
>> R_LIBS_USER="/home/john/lib/R/library"
>>
>> I've also tried creating an environment variable "export
>> R_LIBRARY_DIR=/home/john/lib/R/library/" before running R CMD check.
>
> The correct name is R_LIBS


... and from "Writing R Extensions":

Note: R CMD check and R CMD build run R with '--vanilla', so none of the 
user's startup files are read. If you need R_LIBS set (to find packages 
in a non-standard library) you will need to set it in the environment.

Uwe




> Cheers,
> Simon
>
>
>> That made
>> no difference. Can anyone point me in the right direction? Do I have to install
>> packages in R_HOME?
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Thu Jul 29 13:58:20 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 29 Jul 2010 07:58:20 -0400
Subject: [Rd] R CMD build wiped my computer (from R-help)
In-Reply-To: <201007291210.49277.Ray.Brownrigg@ecs.vuw.ac.nz>
References: <20100727213709.q1q0u1fm4ooo880s@www.staffmail.ed.ac.uk>	<4C5048DB.3040108@gmail.com>	<201007291020.48419.Ray.Brownrigg@ecs.vuw.ac.nz>
	<201007291210.49277.Ray.Brownrigg@ecs.vuw.ac.nz>
Message-ID: <4C516CDC.9040606@gmail.com>

On 28/07/2010 8:10 PM, Ray Brownrigg wrote:
> NOTE: Now submitted to R-devel, as this seems more appropriate.
> 
> I may have spoken too soon about this having been fixed. (see below).
> 
> If I create another "unusual but not 'invalid'" filename in the R subdirectory, the 
> behaviour is different from that reported below, and is similar to the original poster's 
> output (the third "unlink" command, where "xyz" was "~"):
> 
> circa>  ls -al RColorBrewer/R
> total 140
> -rwxr-xr-x  1 ray  ecs  43988 Apr 17  2005    ColorBrewer.R~*
> -rw-r--r--  1 ray  ecs      0 Jul 29 09:57    residuals.MCMCglmm.R?xyz

Ray clarified to me that this filename was "residuals.MCMCglmm.R" 
preceded by 3 spaces and followed by a carriage return and "xyz".

> drwxr-xr-x  2 ray  ecs   4096 Jul 29 12:02 ./
> drwxr-xr-x  5 ray  ecs   4096 Jul 29 11:49 ../
> -rwxr-xr-x  1 ray  ecs  43988 Jul 29 09:57 ColorBrewer.R*
> -rwxr-xr-x  1 ray  ecs  43988 Apr 17  2005 ColorBrewer.R~*
> -rw-r--r--  1 ray  ecs      0 Jul 29 09:58 residuals.MCMCglmm.R
> circa>
> circa>
> circa>  R CMD build RColorBrewer
> * checking for file 'RColorBrewer/DESCRIPTION' ... OK
> * preparing 'RColorBrewer':
> * checking DESCRIPTION meta-information ... OK
> * checking whether 'INDEX' is up-to-date ... NO
> * use '--force' to overwrite the existing 'INDEX'
> * removing junk files
> unlink RColorBrewer/R/   ColorBrewer.R~
> unlink RColorBrewer/R/ColorBrewer.R
> unlink RColorBrewer/R/   residuals.MCMCglmm.R
> xyz

That certainly looks bad.  I can't reproduce it on Windows; it doesn't 
allow that filename.  So I'll have to leave this for a Unix-alike user.

Duncan Murdoch

> unlink RColorBrewer/R/residuals.MCMCglmm.R
> unlink RColorBrewer/R/ColorBrewer.R~
> rmdir RColorBrewer/R
> * checking for LF line-endings in source and make files
> * checking for empty or unneeded directories
> * building 'RColorBrewer_1.0-3.tar.gz'
> 
> circa>
> 
> Ray Brownrigg
> 
> On Thu, 29 Jul 2010, Ray Brownrigg wrote:
>> On Thu, 29 Jul 2010, Duncan Murdoch wrote:
>>> On 28/07/2010 10:01 AM, Jarrod Hadfield wrote:
>>>> Hi Marc,
>>>>
>>>> Thanks for the info on recovery - most of it can pieced together from
>>>> backups but a quick, cheap and easy method of recovery would have been
>>>> nicer.
>>>>
>>>> My main concern is that this could happen again and that the "bug" is
>>>> not limited to R 2.9. I would think that an accidental carriage return
>>>> at the end of a file name (even a temporary one) would be a reasonably
>>>> common phenomenon (I'm surprised I hadn't done it before).
>>> If you can put together a recipe to reproduce the problem (or a less
>>> extreme version of R deleting files it shouldn't), we'll certainly fix
>>> it.  But so far all we've got are guesses about what might have gone
>>> wrong, and I don't think anyone has been able to reproduce the problem
>>> on current R.
>> Duncan:
>>
>> It looks to me like it has already been fixed, if indeed that was the
>> problem.  In R-2.10.1, I tried to reproduce the problem (using
>> RColorBrewer, since that was the smallest package I have a local copy of),
>> and the build produced this:
>>
>> * removing junk files
>> * excluding invalid files from 'RColorBrewer'
>> Subdirectory 'R' contains invalid file names:
>>   residuals.MCMCglmm.R xyz
>>
>> where the space shown between the "R" and the "xyz" was a newline
>> character. [I didn't dare try using a "~" :-)]
>>
>> Ray Brownrigg
>>
>>> Duncan Murdoch
>>>
>>>> Cheers,
>>>>
>>>> Jarrod
>>>>
>>>> On 28 Jul 2010, at 14:04, Marc Schwartz wrote:
>>>>> Jarrod,
>>>>>
>>>>> Noting your exchange with Martin, Martin brings up a point that
>>>>> certainly I missed, which is that somehow the tilde ('~') character
>>>>> got into the chain of events. As Martin noted, on Linuxen/Unixen
>>>>> (including OSX), the tilde, when used in the context of file name
>>>>> globbing, refers to your home directory. Thus, a command such as:
>>>>>
>>>>>  ls ~
>>>>>
>>>>> will list the files in your home directory. Similarly:
>>>>>
>>>>>  rm ~
>>>>>
>>>>> will remove the files there as well. If the -rf argument is added,
>>>>> then the deletion becomes recursive through that directory tree,
>>>>> which appears to be the case here.
>>>>>
>>>>> I am unclear, as Martin appears to be, as to the steps that caused
>>>>> this to happen. That may yet be related in some fashion to Duncan's
>>>>> hypothesis.
>>>>>
>>>>> That being said, the use of the tilde character as a suffix to
>>>>> denote that a file is a backup version, is not limited to Fedora or
>>>>> Linux, for that matter. It is quite common for many text editors
>>>>> (eg. Emacs) to use this. As a result, it is also common for many
>>>>> applications to ignore files that have a tilde suffix.
>>>>>
>>>>> Based upon your follow up posts to the original thread, it would
>>>>> seem that you do not have any backups. The default ext3 file system
>>>>> that is used on modern Linuxen, by design, makes it a bit more
>>>>> difficult to recover deleted files. This is due to the unlinking of
>>>>> file metadata at the file system data structure level, as opposed to
>>>>> simply marking the file as deleted in the directory structures, as
>>>>> happens on Windows.
>>>>>
>>>>> There is a utility called ext3undel
>>>>> (http://projects.izzysoft.de/trac/ext3undel ), which is a wrapper of
>>>>> sorts to other undelete utilities such as PhotoRec and foremost. I
>>>>> have not used it/them, so cannot speak from personal experience. Thus
>>>>> it would be a good idea to engage in some reviews of the
>>>>> documentation and perhaps other online resources before proceeding.
>>>>> The other
>>>>> consideration is the Catch-22 of not copying anything new to your
>>>>> existing HD, for fear of overwriting the lost files with new data. So
>>>>> you would need to consider an approach of downloading these utilities
>>>>> via another computer and then running them on the computer in
>>>>> question from other media, such as a CD/DVD or USB HD.
>>>>>
>>>>> A more expensive option would be to use a professional data recovery
>>>>> service, where you would have to consider the cost of recovery
>>>>> versus your lost time. One option would be Kroll OnTrack UK
>>>>> (http://www.ontrackdatarecovery.co.uk/ ). I happen to live about a
>>>>> quarter mile from their world HQ here in a suburb of Minneapolis. I
>>>>> have not used them myself, but others that I know have, with good
>>>>> success. Again, this comes at a
>>>>> potentially substantial monetary cost.
>>>>>
>>>>> The key is that if you have any hope to recover the deleted files,
>>>>> you not copy anything new onto the hard drive in the mean time.
>>>>> Doing so will decrease the possibility of file recovery to near 0.
>>>>>
>>>>> As Duncan noted, there is great empathy with your situation. We have
>>>>> all gone through this at one time or another. In my case, it was
>>>>> perhaps 20+ years ago, but as a result, I am quite anal retentive
>>>>> about having backups, which I have done for some time on my systems,
>>>>> hourly.
>>>>>
>>>>> HTH,
>>>>>
>>>>> Marc Schwartz
>>>>>
>>>>> On Jul 28, 2010, at 5:55 AM, Jarrod Hadfield wrote:
>>>>>> Hi Martin,
>>>>>>
>>>>>> I think this is the most likely reason given that the name in the
>>>>>> DESCRIPTION file does NOT have a version number. Even so, it is
>>>>>> very easy to misname a file and then delete it/change its name (as
>>>>>> I've done here) and I hope current versions of R would not cause
>>>>>> this problem. Perhaps Fedora should not use ~ as its back up file
>>>>>> suffixes?
>>>>>>
>>>>>> Cheers,
>>>>>>
>>>>>> Jarrod
>>>>>>
>>>>>> On 28 Jul 2010, at 11:41, Martin Maechler wrote:
>>>>>>>>>>>> Jarrod Hadfield <j.hadfield at ed.ac.uk>
>>>>>>>>>>>>  on Tue, 27 Jul 2010 21:37:09 +0100 writes:
>>>>>>>> Hi, I ran R (version 2.9.0) CMD build under root in
>>>>>>>> Fedora (9). When it tried to remove "junk files" it
>>>>>>>> removed EVERYTHING in my local account! (See below).
>>>>>>>>
>>>>>>>> Can anyone tell me what happened,
>>>>>>> the culprit may lay here:
>>>>>>>>> * removing junk files
>>>>>>>>> unlink MCMCglmm_2.05/R/   residuals.MCMCglmm.R
>>>>>>>>> ~
>>>>>>> where it seems that someone (you?) have added a newline
>>>>>>> in the filname, so instead of
>>>>>>> 'residuals.MCMCglmm.R~'
>>>>>>> you got
>>>>>>>
>>>>>>> 'residuals.MCMCglmm.R
>>>>>>> ~'
>>>>>>>
>>>>>>> and the unlink / rm  command interpreted '~' as your home
>>>>>>> directory.
>>>>>>>
>>>>>>> But I can hardly believe it.
>>>>>>> This seems explanation seems a bit doubtful to me.. ...
>>>>>>>
>>>>>>>> and even more importantly if I can I restore what was lost.
>>>>>>> well, you just get it from the backup. You do daily backups, do
>>>>>>> you?
>>>>>>>
>>>>>>> Regards,
>>>>>>> Martin Maechler, ETH Zurich
>>> ______________________________________________
>>> R-help at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html and provide commented,
>>> minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Thu Jul 29 14:20:19 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 29 Jul 2010 14:20:19 +0200
Subject: [Rd] Telling R CMD check where to find libraries
In-Reply-To: <F54EF8F1B477CF448729593FE421F6463B43D9@HQVEVE0032.nestle.com>
References: <F54EF8F1B477CF448729593FE421F6463B43D9@HQVEVE0032.nestle.com>
Message-ID: <4C517203.9060109@statistik.tu-dortmund.de>



On 20.07.2010 17:18, Thaler, Thorn, LAUSANNE, Applied Mathematics wrote:
> Hello everybody,
>
> Currently I'm developing a library, which uses some functions from
> another package (namely plotrix). Consequently, I listed this dependency
> in the DESCRIPTION file. When I try to run "R CMD check mypackage", the
> check fails, for the library plotrix cannot be found on the system. As
> far as I understood "R CMD check" uses --vanilla implicitly, thus, no
> startup files are read. Hence, plotrix cannot be found by "R CMD check",
> since it is only installed locally (I've no admin privileges on this
> machine) and the path to the library is given in .Rprofile, which in
> turn is not read by "R CMD check".
>
> If I provide the flag "-l /path/to/site/libs", it works as expected but
> with the side effect that the test installation is carried out in this
> directory as well, which I do not like either (this directory should
> contain only stable packages and not packages which are still under
> construction). So which possibilities do I have?


Set the environment variable  R_LIBS  to point to that library.

Uwe Ligges


> BR
>
> Thorn
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From pdalgd at gmail.com  Thu Jul 29 16:19:10 2010
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 29 Jul 2010 16:19:10 +0200
Subject: [Rd] problem with zero-weighted observations in predict.lm?
In-Reply-To: <4C5137C9.2040305@gmail.com>
References: <77EB52C6DD32BA4D87471DCD70C8D700033DFEBC@NA-PA-VBE03.na.tibco.com>
	<4C4F413F.5020901@gmail.com> <4C511B73.2070504@gmail.com>
	<alpine.LFD.2.00.1007290714420.32203@gannet.stats.ox.ac.uk>
	<4C51312D.5050200@gmail.com> <4C5137C9.2040305@gmail.com>
Message-ID: <F7B2B0F8-FF97-4071-9597-BE8474BAC729@gmail.com>

I believe that I now has this nailed down (a couple of further issues raised their head). Committed to r-devel.

-pd


On Jul 29, 2010, at 10:11 AM, Peter Dalgaard wrote:

> Peter Dalgaard wrote:
>> Prof Brian Ripley wrote:
>> 
>>> I think you will find that 'n' is used in several ways in predict.lm, 
>>> and since NA-handling was introduced in R 1.8.0 they may differ in 
>>> value.  So the safest route seems to be to change just 'n' in
>>> 
>>> 		df <- n - p
>> 
>> Yes, that seems to fix things. Will commit to R-devel shortly.
>> 
>> -p
>> 
> 
> Spoke too soon, it fixes Bill's case, but breaks one of the regression
> tests!
> 
> In fact this goes deeper, summary.lm special-cases the same zero-rank
> case by using length(residuals), so it also miscalculates with zero weights:
> 
>> fit <- lm(y~0,weights=c(0,rep(1,9)))
>> summary(fit)
> 
> Call:
> lm(formula = y ~ 0, weights = c(0, rep(1, 9)))
> 
> Residuals:
>     Min       1Q   Median       3Q      Max
> -1.95428 -1.40571 -0.42378 -0.05795  1.05518
> 
> No Coefficients
> 
> Residual standard error: 1.119 on 10 degrees of freedom
> 
> ----
> 
> Hum. lm() actually returns df.residual, AFAICS in all cases, now why
> don't we just use that throughout????
> 
> 
> -- 
> Peter Dalgaard
> Center for Statistics, Copenhagen Business School
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From lachmann at eva.mpg.de  Thu Jul 29 21:31:28 2010
From: lachmann at eva.mpg.de (Michael Lachmann)
Date: Thu, 29 Jul 2010 21:31:28 +0200
Subject: [Rd] Using 'dimname names' in aperm() and apply()
Message-ID: <AANLkTim-ojUA-d7f5uGGS=+UbL6jAkED2GEP=X9pZpwr@mail.gmail.com>

I think that the "dimname names" of tables and arrays could make
aperm() and apply() (and probably some other functions) easier to use.
(dimname names are, for example, created by table() )

The use would be something like:
--
x <-table( from=sample(3,100,rep=T), to=sample(5,100,rep=T))
trans <- x / apply(x,"from",sum)

y <- aperm( trans, c("from","to") )
z <- aperm(y, c("to","from") )

res <-apply( y, "to", sum)
--

This makes the array much easier to handle than having to keep track
which dimension currently means what.

For aperm and apply, the change seems very simple - one new function,
and an additional line in each.
----------
dimnum.from.dimnamename <- function(A, dimensions)
{

  if( is.character(dimensions) ) {
    n <- names(dimnames(A))
    if( !is.null(n) ) {
        dimnum <- seq( along=n)
        names(dimnum) <-  n
        dimensions <- dimnum[dimensions]
      }
  }
  dimensions
}



aperm <- function (a, perm, resize = TRUE)
{
    if (missing(perm))
        perm <- integer(0L)
    perm <- dimnum.from.dimnamename( a, perm) # this line was added to aperm
    .Internal(aperm(a, perm, resize))
}

apply <-  function (X, MARGIN, FUN, ...)
{
    FUN <- match.fun(FUN)
    d <- dim(X)
    dl <- length(d)
    if (dl == 0L)
        stop("dim(X) must have a positive length")
    ds <- 1L:dl
    if (length(oldClass(X)))
        X <- if (dl == 2)
            as.matrix(X)
        else as.array(X)
    d <- dim(X)
    dn <- dimnames(X)


    MARGIN <- dimnum.from.dimnamename( X,MARGIN ) # this line was added to apply

    s.call <- ds[-MARGIN]
    s.ans <- ds[MARGIN]
    d.call <- d[-MARGIN]
    d.ans <- d[MARGIN]
    dn.call <- dn[-MARGIN]
    dn.ans <- dn[MARGIN]
    d2 <- prod(d.ans)
    if (d2 == 0L) {
        newX <- array(vector(typeof(X), 1L), dim = c(prod(d.call),
            1L))
        ans <- FUN(if (length(d.call) < 2L)
            newX[, 1]
        else array(newX[, 1L], d.call, dn.call), ...)
        return(if (is.null(ans)) ans else if (length(d.ans) <
            2L) ans[1L][-1L] else array(ans, d.ans, dn.ans))
    }
    newX <- aperm(X, c(s.call, s.ans))
    dim(newX) <- c(prod(d.call), d2)
    ans <- vector("list", d2)
    if (length(d.call) < 2L) {
        if (length(dn.call))
            dimnames(newX) <- c(dn.call, list(NULL))
        for (i in 1L:d2) {
            tmp <- FUN(newX[, i], ...)
            if (!is.null(tmp))
                ans[[i]] <- tmp
        }
    }
    else for (i in 1L:d2) {
        tmp <- FUN(array(newX[, i], d.call, dn.call), ...)
        if (!is.null(tmp))
            ans[[i]] <- tmp
    }
    ans.list <- is.recursive(ans[[1L]])
    l.ans <- length(ans[[1L]])
    ans.names <- names(ans[[1L]])
    if (!ans.list)
        ans.list <- any(unlist(lapply(ans, length)) != l.ans)
    if (!ans.list && length(ans.names)) {
        all.same <- sapply(ans, function(x) identical(names(x),
            ans.names))
        if (!all(all.same))
            ans.names <- NULL
    }
    len.a <- if (ans.list)
        d2
    else length(ans <- unlist(ans, recursive = FALSE))
    if (length(MARGIN) == 1L && len.a == d2) {
        names(ans) <- if (length(dn.ans[[1L]]))
            dn.ans[[1L]]
        return(ans)
    }
    if (len.a == d2)
        return(array(ans, d.ans, dn.ans))
    if (len.a && len.a%%d2 == 0L) {
        if (is.null(dn.ans))
            dn.ans <- vector(mode = "list", length(d.ans))
        dn.ans <- c(list(ans.names), dn.ans)
        return(array(ans, c(len.a%/%d2, d.ans), if (!all(sapply(dn.ans,
            is.null))) dn.ans))
    }
    return(ans)
}
----------

Thanks,

Michael


--
Michael Lachmann, Max Planck institute of evolutionary anthropology
Deutscher Platz. 6, 04103 Leipzig, Germany
Tel: +49-341-3550521, Fax: +49-341-3550555


From ripley at stats.ox.ac.uk  Thu Jul 29 23:35:58 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 29 Jul 2010 22:35:58 +0100 (BST)
Subject: [Rd] Using 'dimname names' in aperm() and apply()
In-Reply-To: <AANLkTim-ojUA-d7f5uGGS=+UbL6jAkED2GEP=X9pZpwr@mail.gmail.com>
References: <AANLkTim-ojUA-d7f5uGGS=+UbL6jAkED2GEP=X9pZpwr@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1007292052180.20108@gannet.stats.ox.ac.uk>

It's not that simple. These are base functions so

- adding utility functions to base is undesirable
- efficiency matters
- any change (including adding a function!) needs corresponding
   documentation.
- this needs much better error checking.
- dimnum.from.dimnamename is rather inefficient: a simple call to
   match() will do the job.  (And we do have seq_along !)

I've been tidying up aperm(), and there this is as simple to do at C 
level (and more efficient).  For apply(), something like

     if (is.character(MARGIN)) {
         if(is.null(dnn <- names(dn)))
            stop("'X' must have named dimnames")
         MARGIN <- match(MARGIN, dnn)
         if (any(is.na(MARGIN)))
             stop("not all elements of 'perm' are names of dimensions")
     }


Thanks for the suggestions: a version will appear in R-devel in due 
course.

On Thu, 29 Jul 2010, Michael Lachmann wrote:

> I think that the "dimname names" of tables and arrays could make
> aperm() and apply() (and probably some other functions) easier to use.
> (dimname names are, for example, created by table() )
>
> The use would be something like:
> --
> x <-table( from=sample(3,100,rep=T), to=sample(5,100,rep=T))
> trans <- x / apply(x,"from",sum)

Here for efficiency use rowSums() ....

> y <- aperm( trans, c("from","to") )
> z <- aperm(y, c("to","from") )
>
> res <-apply( y, "to", sum)
> --
>
> This makes the array much easier to handle than having to keep track
> which dimension currently means what.
>
> For aperm and apply, the change seems very simple - one new function,
> and an additional line in each.
> ----------
> dimnum.from.dimnamename <- function(A, dimensions)
> {
>
>  if( is.character(dimensions) ) {
>    n <- names(dimnames(A))
>    if( !is.null(n) ) {
>        dimnum <- seq( along=n)
>        names(dimnum) <-  n
>        dimensions <- dimnum[dimensions]
>      }
>  }
>  dimensions
> }
>
>
>
> aperm <- function (a, perm, resize = TRUE)
> {
>    if (missing(perm))
>        perm <- integer(0L)
>    perm <- dimnum.from.dimnamename( a, perm) # this line was added to aperm
>    .Internal(aperm(a, perm, resize))
> }
>
> apply <-  function (X, MARGIN, FUN, ...)
> {
>    FUN <- match.fun(FUN)
>    d <- dim(X)
>    dl <- length(d)
>    if (dl == 0L)
>        stop("dim(X) must have a positive length")
>    ds <- 1L:dl
>    if (length(oldClass(X)))
>        X <- if (dl == 2)
>            as.matrix(X)
>        else as.array(X)
>    d <- dim(X)
>    dn <- dimnames(X)
>
>
>    MARGIN <- dimnum.from.dimnamename( X,MARGIN ) # this line was added to apply
>
>    s.call <- ds[-MARGIN]
>    s.ans <- ds[MARGIN]
>    d.call <- d[-MARGIN]
>    d.ans <- d[MARGIN]
>    dn.call <- dn[-MARGIN]
>    dn.ans <- dn[MARGIN]
>    d2 <- prod(d.ans)
>    if (d2 == 0L) {
>        newX <- array(vector(typeof(X), 1L), dim = c(prod(d.call),
>            1L))
>        ans <- FUN(if (length(d.call) < 2L)
>            newX[, 1]
>        else array(newX[, 1L], d.call, dn.call), ...)
>        return(if (is.null(ans)) ans else if (length(d.ans) <
>            2L) ans[1L][-1L] else array(ans, d.ans, dn.ans))
>    }
>    newX <- aperm(X, c(s.call, s.ans))
>    dim(newX) <- c(prod(d.call), d2)
>    ans <- vector("list", d2)
>    if (length(d.call) < 2L) {
>        if (length(dn.call))
>            dimnames(newX) <- c(dn.call, list(NULL))
>        for (i in 1L:d2) {
>            tmp <- FUN(newX[, i], ...)
>            if (!is.null(tmp))
>                ans[[i]] <- tmp
>        }
>    }
>    else for (i in 1L:d2) {
>        tmp <- FUN(array(newX[, i], d.call, dn.call), ...)
>        if (!is.null(tmp))
>            ans[[i]] <- tmp
>    }
>    ans.list <- is.recursive(ans[[1L]])
>    l.ans <- length(ans[[1L]])
>    ans.names <- names(ans[[1L]])
>    if (!ans.list)
>        ans.list <- any(unlist(lapply(ans, length)) != l.ans)
>    if (!ans.list && length(ans.names)) {
>        all.same <- sapply(ans, function(x) identical(names(x),
>            ans.names))
>        if (!all(all.same))
>            ans.names <- NULL
>    }
>    len.a <- if (ans.list)
>        d2
>    else length(ans <- unlist(ans, recursive = FALSE))
>    if (length(MARGIN) == 1L && len.a == d2) {
>        names(ans) <- if (length(dn.ans[[1L]]))
>            dn.ans[[1L]]
>        return(ans)
>    }
>    if (len.a == d2)
>        return(array(ans, d.ans, dn.ans))
>    if (len.a && len.a%%d2 == 0L) {
>        if (is.null(dn.ans))
>            dn.ans <- vector(mode = "list", length(d.ans))
>        dn.ans <- c(list(ans.names), dn.ans)
>        return(array(ans, c(len.a%/%d2, d.ans), if (!all(sapply(dn.ans,
>            is.null))) dn.ans))
>    }
>    return(ans)
> }
> ----------
>
> Thanks,
>
> Michael
>
>
> --
> Michael Lachmann, Max Planck institute of evolutionary anthropology
> Deutscher Platz. 6, 04103 Leipzig, Germany
> Tel: +49-341-3550521, Fax: +49-341-3550555
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From waanders at gmail.com  Thu Jul 29 16:41:34 2010
From: waanders at gmail.com (waanders)
Date: Thu, 29 Jul 2010 07:41:34 -0700 (PDT)
Subject: [Rd] RODBC sqlSave not all columns
Message-ID: <1280414494400-2306570.post@n4.nabble.com>


Hello,

How can I make sqlSave only to write a subset of columns.

I've a (MS-Access) table with columns A, B, C en D and if I send a sqlSave
command with a data frame with columns A, B en D I get the message:

Error in odbcUpdate(channel, query, mydata, coldata[m, ], test = test,  : 
  missing columns in 'data'
Calls: sqlSave -> sqlwrite -> odbcUpdate

(The columns in my table are all defined optional)

I can add a dummy column to my data frame with name C and value NA and
sqlSave will be happy, but is there another way to do this? Arguments to
sqlSave? I can't find them in the documentation.

Regards.
-- 
View this message in context: http://r.789695.n4.nabble.com/RODBC-sqlSave-not-all-columns-tp2306570p2306570.html
Sent from the R devel mailing list archive at Nabble.com.


From p.murrell at auckland.ac.nz  Fri Jul 30 05:45:47 2010
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Fri, 30 Jul 2010 15:45:47 +1200
Subject: [Rd] HowTo get callback on destroy of grDevices::windows()
In-Reply-To: <4C4DE6AC.7050904@fh-lausitz.de>
References: <4C4DE6AC.7050904@fh-lausitz.de>
Message-ID: <4C524AEB.2060806@auckland.ac.nz>

Hi

On 27/07/2010 7:49 a.m., rrichte2 at fh-lausitz.de wrote:
>    I'm build with the usage of the tcltk/tcltk2 package a gui which is
>
> started with rscript.exe. At this gui the user is able to open and close
> plot windows.
>
> Now I'm looking for a way that a r function is called when a
> grDevices::windows window is closed.
> Is there a way to attach a callback function or so, which would be
> triggert if the user click at close of the grDevices::window?
>
> My workarround is to check continues the open windows with the tcl
> command after, but it's no good workarround.

I don't think this is possible with standard R graphics devices.  Have 
you taken a look at the 'tkrplot' package; if you produce a tcltk window 
with an R graphics device embedded, instead of opening/closing raw R 
graphics devices, perhaps you could gain more control over the 
opening/closing of the window (?)

Paul

> thanks
> roland
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From rksh1 at cam.ac.uk  Fri Jul 30 11:35:28 2010
From: rksh1 at cam.ac.uk (Robin Hankin)
Date: Fri, 30 Jul 2010 10:35:28 +0100
Subject: [Rd] transpose of complex matrices in R
Message-ID: <4C529CE0.2070408@cam.ac.uk>

Hello everybody

When one is working with complex matrices, "transpose"  very nearly 
always means
*Hermitian* transpose, that is, A[i,j] <- Conj(A[j,i]).
One often writes A^* for the Hermitian transpose.

I have only once seen a  "real-life" case
where transposition does not occur simultaneously with complex conjugation.
And I'm not 100% sure that that wasn't a mistake.

Matlab and Octave sort of recognize this, as "A'" means the  Hermitian 
transpose of "A".

In R, this issue makes t(), crossprod(), and tcrossprod() pretty much 
useless to me.

OK, so what to do?  I have several options:

1.  define functions myt(), and mycrossprod() to get round the problem:
myt <- function(x){t(Conj(x))}

2.  Try to redefine t.default():

  t.default <- function(x){if(is.complex(x)){return(base::t(Conj(x)))} 
else {return(base::t(x))}}
(This fails because of infinite recursion, but I don't quite understand 
why).

3.  Try to define a t.complex() function:
t.complex <- function(x){t(Conj(x))}
(also fails because of recursion)

4. Try a kludgy workaround:
   t.complex <- function(x){t(Re(x)) - 1i*t(Im(x))}


Solution 1 is not good because it's easy to forget to use myt() rather 
than t()
and it does not seem to be  good OO practice.

As Martin Maechler points out, solution 2 (even if it worked as desired)
would break the code of everyone who writes a myt() function.

Solution 3 fails and solution 4 is kludgy and inefficient.

Does anyone have any better ideas?




-- 
Robin K. S. Hankin
Uncertainty Analyst
University of Cambridge
19 Silver Street
Cambridge CB3 9EP
01223-764877


From pdalgd at gmail.com  Fri Jul 30 12:01:07 2010
From: pdalgd at gmail.com (peter dalgaard)
Date: Fri, 30 Jul 2010 12:01:07 +0200
Subject: [Rd] transpose of complex matrices in R
In-Reply-To: <4C529CE0.2070408@cam.ac.uk>
References: <4C529CE0.2070408@cam.ac.uk>
Message-ID: <63F351C0-3D20-4F41-B4E2-C21017DA345C@gmail.com>


On Jul 30, 2010, at 11:35 AM, Robin Hankin wrote:

> Hello everybody
> 
> When one is working with complex matrices, "transpose"  very nearly always means
> *Hermitian* transpose, that is, A[i,j] <- Conj(A[j,i]).
> One often writes A^* for the Hermitian transpose.
> 
> I have only once seen a  "real-life" case
> where transposition does not occur simultaneously with complex conjugation.
> And I'm not 100% sure that that wasn't a mistake.
> 
> Matlab and Octave sort of recognize this, as "A'" means the  Hermitian transpose of "A".
> 
> In R, this issue makes t(), crossprod(), and tcrossprod() pretty much useless to me.
> 
> OK, so what to do?  I have several options:
> 
> 1.  define functions myt(), and mycrossprod() to get round the problem:
> myt <- function(x){t(Conj(x))}
> 
> 2.  Try to redefine t.default():
> 
> t.default <- function(x){if(is.complex(x)){return(base::t(Conj(x)))} else {return(base::t(x))}}
> (This fails because of infinite recursion, but I don't quite understand why).
> 
> 3.  Try to define a t.complex() function:
> t.complex <- function(x){t(Conj(x))}
> (also fails because of recursion)
> 
> 4. Try a kludgy workaround:
>  t.complex <- function(x){t(Re(x)) - 1i*t(Im(x))}
> 
> 
> Solution 1 is not good because it's easy to forget to use myt() rather than t()
> and it does not seem to be  good OO practice.
> 
> As Martin Maechler points out, solution 2 (even if it worked as desired)
> would break the code of everyone who writes a myt() function.
> 
> Solution 3 fails and solution 4 is kludgy and inefficient.
> 
> Does anyone have any better ideas?

What's wrong with 

> t.complex <- function(x) t.default(Conj(x))
> M <- matrix(rnorm(4)+1i*rnorm(4),2)
> M
                     [,1]                  [,2]
[1,] 0.9907631-0.6927544i -0.0079213-1.1038222i
[2,] 1.2076160+0.4397778i  0.5926077-0.2140982i
> t(M)
                      [,1]                 [,2]
[1,]  0.9907631+0.6927544i 1.2076160-0.4397778i
[2,] -0.0079213+1.1038222i 0.5926077+0.2140982i

It's not going to help with the cross products though.

As a general matter, in my book, transpose is transpose and the other thing is called "adjoint". So another option is to use adj(A) for what you call myt(A), and then just remember to transcribe A^* to adj(A). 

I forget whether the cross products A^*A and AA^* have any special names in abstract linear algebra/functional analysis.

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From murdoch.duncan at gmail.com  Fri Jul 30 12:13:26 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 30 Jul 2010 06:13:26 -0400
Subject: [Rd] transpose of complex matrices in R
In-Reply-To: <4C529CE0.2070408@cam.ac.uk>
References: <4C529CE0.2070408@cam.ac.uk>
Message-ID: <4C52A5C6.7080209@gmail.com>

Robin Hankin wrote:
> Hello everybody
>
> When one is working with complex matrices, "transpose"  very nearly 
> always means
> *Hermitian* transpose, that is, A[i,j] <- Conj(A[j,i]).
> One often writes A^* for the Hermitian transpose.
>
> I have only once seen a  "real-life" case
> where transposition does not occur simultaneously with complex conjugation.
> And I'm not 100% sure that that wasn't a mistake.
>
> Matlab and Octave sort of recognize this, as "A'" means the  Hermitian 
> transpose of "A".
>
> In R, this issue makes t(), crossprod(), and tcrossprod() pretty much 
> useless to me.
>
> OK, so what to do?  I have several options:
>
> 1.  define functions myt(), and mycrossprod() to get round the problem:
> myt <- function(x){t(Conj(x))}
>
> 2.  Try to redefine t.default():
>
>   t.default <- function(x){if(is.complex(x)){return(base::t(Conj(x)))} 
> else {return(base::t(x))}}
> (This fails because of infinite recursion, but I don't quite understand 
> why).
>   

You should call base::t.default, not base::t.  Then this will work.  The 
same solution fixes the one below, though you won't even need the base:: 
prefix on t.default.

Duncan Murdoch

> 3.  Try to define a t.complex() function:
> t.complex <- function(x){t(Conj(x))}
> (also fails because of recursion)
>
> 4. Try a kludgy workaround:
>    t.complex <- function(x){t(Re(x)) - 1i*t(Im(x))}
>
>
> Solution 1 is not good because it's easy to forget to use myt() rather 
> than t()
> and it does not seem to be  good OO practice.
>
> As Martin Maechler points out, solution 2 (even if it worked as desired)
> would break the code of everyone who writes a myt() function.
>
> Solution 3 fails and solution 4 is kludgy and inefficient.
>
> Does anyone have any better ideas?
>
>
>
>
>


From rksh1 at cam.ac.uk  Fri Jul 30 12:38:51 2010
From: rksh1 at cam.ac.uk (Robin Hankin)
Date: Fri, 30 Jul 2010 11:38:51 +0100
Subject: [Rd] transpose of complex matrices in R
In-Reply-To: <63F351C0-3D20-4F41-B4E2-C21017DA345C@gmail.com>
References: <4C529CE0.2070408@cam.ac.uk>
	<63F351C0-3D20-4F41-B4E2-C21017DA345C@gmail.com>
Message-ID: <4C52ABBB.2090102@cam.ac.uk>

Hello Peter

thanks for this.


On 07/30/2010 11:01 AM, peter dalgaard wrote:
>
> What's wrong with
>
>    
>> t.complex<- function(x) t.default(Conj(x))
>> M<- matrix(rnorm(4)+1i*rnorm(4),2)
>> M
>>      
>
> It's not going to help with the cross products though.
>
> As a general matter, in my book, transpose is transpose and the other thing is called "adjoint". So another option is to use adj(A) for what you call myt(A), and then just remember to transcribe A^* to adj(A).
>
>    

That's a good way to think about it.   Perhaps this is one case where 
thinking too literally
in terms of OO-style programming [ie wanting to overload t()] is harmful.

I didn't realize until an email just now that octave has a transpose() 
function which does *not*
take the complex conjugate.   You live and learn!

> I forget whether the cross products A^*A and AA^* have any special names in abstract linear algebra/functional analysis.
>
>    

Well they sort of do.  I'd call A^*  %*% A an inner product, or possibly 
an Hermitian inner product.

Would it hurt to redefine crossprod(A,B) to mean t(Conj(A)) %*% B   and 
tcrossprod(A,B) to A %*% t(Conj(B))?

(we could include an optional  'Hermitian' argument to crossprod() in 
the complex case, defaulting to TRUE?)


rksh













-- 
Robin K. S. Hankin
Uncertainty Analyst
University of Cambridge
19 Silver Street
Cambridge CB3 9EP
01223-764877


From nashjc at uottawa.ca  Fri Jul 30 17:39:41 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Fri, 30 Jul 2010 11:39:41 -0400
Subject: [Rd]  transpose of complex matrices in R
In-Reply-To: <mailman.25.1280484008.6114.r-devel@r-project.org>
References: <mailman.25.1280484008.6114.r-devel@r-project.org>
Message-ID: <4C52F23D.30803@uottawa.ca>

> When one is working with complex matrices, "transpose"  very nearly
> always means
> *Hermitian* transpose, that is, A[i,j] <- Conj(A[j,i]).
> One often writes A^* for the Hermitian transpose.


I believe that I have actually (many years ago) used a true complex transpose, but I agree 
that one more often needs the conjugate transpose. I would not be in favour of changing 
t() because I feel transpose means transpose -- certainly where there are non-square 
matrices. But I'd be in favour of adding a conjt() (or some similar function) that does 
the conjugate transpose efficiently.

JN


From olafm at statistik.tu-dortmund.de  Fri Jul 30 12:01:22 2010
From: olafm at statistik.tu-dortmund.de (Olaf Mersmann)
Date: Fri, 30 Jul 2010 12:01:22 +0200
Subject: [Rd] transpose of complex matrices in R
In-Reply-To: <4C529CE0.2070408@cam.ac.uk>
References: <4C529CE0.2070408@cam.ac.uk>
Message-ID: <55722628-0C98-45BC-AFC7-95132F92E2EB@statistik.tu-dortmund.de>

Hi,

On 30.07.2010, at 11:35, Robin Hankin wrote:
> 3.  Try to define a t.complex() function:
> t.complex <- function(x){t(Conj(x))}
> (also fails because of recursion)

Try this version:

  t.complex <- function(x) {
    xx <- Conj(x)
    .Internal(t.default(xx))
  }

You get infinite recursion in your example because you keep dispatching on the (complex) result of Conj(x) in t(Conj(x)). I'm not sure if the use of .Internal in user code is sanctioned but it does work for me.

Cheers,
Olaf


From wdunlap at tibco.com  Fri Jul 30 21:58:33 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 30 Jul 2010 12:58:33 -0700
Subject: [Rd] transpose of complex matrices in R
In-Reply-To: <55722628-0C98-45BC-AFC7-95132F92E2EB@statistik.tu-dortmund.de>
References: <4C529CE0.2070408@cam.ac.uk>
	<55722628-0C98-45BC-AFC7-95132F92E2EB@statistik.tu-dortmund.de>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700033E06B0@NA-PA-VBE03.na.tibco.com>

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Olaf Mersmann
> Sent: Friday, July 30, 2010 3:01 AM
> To: Robin Hankin
> Cc: R-devel at r-project.org; Martin Maechler
> Subject: Re: [Rd] transpose of complex matrices in R
> 
> Hi,
> 
> On 30.07.2010, at 11:35, Robin Hankin wrote:
> > 3.  Try to define a t.complex() function:
> > t.complex <- function(x){t(Conj(x))}
> > (also fails because of recursion)

The NextMethod() function exists to avoid
this sort of infinite recursion in S3 methods.
E.g.,
   t.complex <- function(x)NextMethod(Conj(x))
or
   t.complex<-function(x)Conj(NextMethod(x))
would do what you wanted.

Using NextMethod means you cannot call this as
   t.complex(nonComplexMatrix)
but I think that is generally a good thing.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 
> 
> Try this version:
> 
>   t.complex <- function(x) {
>     xx <- Conj(x)
>     .Internal(t.default(xx))
>   }
> 
> You get infinite recursion in your example because you keep 
> dispatching on the (complex) result of Conj(x) in t(Conj(x)). 
> I'm not sure if the use of .Internal in user code is 
> sanctioned but it does work for me.
> 
> Cheers,
> Olaf
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


