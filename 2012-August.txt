From pdalgd at gmail.com  Wed Aug  1 15:39:47 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 1 Aug 2012 15:39:47 +0200
Subject: [Rd] Numerics behind splineDesign
In-Reply-To: <CACk-te3ERmEVe2f2YqU8t5iFSVj0E9a4RGDTudDvGiAUyUQUtg@mail.gmail.com>
References: <CAPJVwB=ppJ=SOs9k0p5ZHqGdnk8L1MZMBUbCSQ6oH5Zd5Pwpig@mail.gmail.com>
	<loom.20120731T152127-870@post.gmane.org>
	<CACk-te3ERmEVe2f2YqU8t5iFSVj0E9a4RGDTudDvGiAUyUQUtg@mail.gmail.com>
Message-ID: <D7CCBAE0-4D80-436D-8594-17EDF691A75A@gmail.com>


On Jul 31, 2012, at 15:46 , Bert Gunter wrote:

> Well, I would first check the references given in the Help file!.
> That's what they're for, no?  Hastie's book is likely to more complete
> on the algebra, I think.
> 
> You might also be interested in the relevant chapters of Friedman,
> Hastie, et. al "The Elements of Statistical Learning Theory," which
> might be a gentler exposition of the math.
> 
> Of course, the code (or a suitable exposition of it, which may not
> exist) is the ultimate reference.

Also check out the various web resources (Google for basis spline or B-spline). I don't recall the white book chapter, but it might be a little short on the algebraic details. Another Google point is "de Boor".  


> 
> -- Bert
> 
> On Tue, Jul 31, 2012 at 6:25 AM, Ben Bolker <bbolker at gmail.com> wrote:
>> Nathaniel Smith <njs <at> pobox.com> writes:
>> 
>>> I find myself needing to be able to reproduce the spline bases that R
>>> computes when using ns() and bs() -- but without using R. Before I go
>>> diving headfirst into the C code in
>>> ./src/library/splines/src/splines.c, are there any simpler references
>>> anyone might recommend?
>> 
>> [snip]
>> 
>>  Some of this stuff *might* be in the "White Book" (Statistical
>> Models in S, ed Chambers & Hastie (esp. chapter 7?)
>> 
>>  Ben Bolker
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> 
> -- 
> 
> Bert Gunter
> Genentech Nonclinical Biostatistics
> 
> Internal Contact Info:
> Phone: 467-7374
> Website:
> http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From damien.georges2 at gmail.com  Wed Aug  1 16:10:59 2012
From: damien.georges2 at gmail.com (Damien Georges)
Date: Wed, 01 Aug 2012 16:10:59 +0200
Subject: [Rd] Package index help file question.
In-Reply-To: <50166052.2080907@gmail.com>
References: <50166052.2080907@gmail.com>
Message-ID: <501938F3.9040300@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120801/eba4b1b1/attachment.pl>

From tlumley at uw.edu  Wed Aug  1 17:12:51 2012
From: tlumley at uw.edu (Thomas Lumley)
Date: Wed, 1 Aug 2012 08:12:51 -0700
Subject: [Rd] confusion over S3/S4 importing
In-Reply-To: <50169631.6020709@ufl.edu>
References: <50169631.6020709@ufl.edu>
Message-ID: <CAJ55+dJJt26yrRNn_cv762EbCMJcM0-NQqnTmvg_W0uhvmv_7w@mail.gmail.com>

On Mon, Jul 30, 2012 at 7:12 AM, Ben Bolker <bbolker at gmail.com> wrote:
>
>   Can anyone help me figure out the right way to import a method that is
> defined as S3 in one package and S4 in another?
>
>   Specifically:
>
>  profile() is defined as an S3 method in the stats package:
>
> function (fitted, ...)
> UseMethod("profile")
> <bytecode: 0xa4cd6e8>
> <environment: namespace:stats>
>
>  In stats4 it is defined as an S4 method:
>
>  stats4:::profile
> standardGeneric for "profile" defined from package "stats"
>
> function (fitted, ...)
> standardGeneric("profile")
> <environment: 0xa59a364>
>
>    In the bbmle package I want to define it as an S4 method:
>
>   setMethod("profile", "mle2", function (...) {...})
>
>   In the NAMESPACE file for bbmle I have
>
>  importFrom(stats4,profile)
>
>   However, in R 2.14.2 (which is I am currently trying to fix: I would
> like to try to allow for backward compatibility), I get
>
> library(bbmle)
> example(mle2) ## to create some fitted objects
> profile(fit)
> Error in UseMethod("profile") :
>   no applicable method for 'profile' applied to an object of class "mle2"
>
>  whereas stats4::profile(fit) works fine.
>
>   -- a similar issue occurs for coef.
>
>   I would have thought that importFrom() would allow package code to
> find the 'stats4' version of profile (and coef) before it found the
> 'stats' versions , but that doesn't seem to be the case.
>
>   Just for kicks I tried
>
> import(stats4)
>
>   which leads to warning messages but no improvements.
>
> If I add an explicit Depends: on stats4 that fixes the problem. I may be
> forced to do that, but I thought it was supposed to be a last resort and
> that I was *supposed* to be able to fix my problems by proper use of
> imports.

'Imports' won't be enough -- the whole point of a generic is that it's
visible to the user, which doesn't happen with imports.

   -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From njs at pobox.com  Wed Aug  1 17:36:02 2012
From: njs at pobox.com (Nathaniel Smith)
Date: Wed, 1 Aug 2012 16:36:02 +0100
Subject: [Rd] Numerics behind splineDesign
In-Reply-To: <D7CCBAE0-4D80-436D-8594-17EDF691A75A@gmail.com>
References: <CAPJVwB=ppJ=SOs9k0p5ZHqGdnk8L1MZMBUbCSQ6oH5Zd5Pwpig@mail.gmail.com>
	<loom.20120731T152127-870@post.gmane.org>
	<CACk-te3ERmEVe2f2YqU8t5iFSVj0E9a4RGDTudDvGiAUyUQUtg@mail.gmail.com>
	<D7CCBAE0-4D80-436D-8594-17EDF691A75A@gmail.com>
Message-ID: <CAPJVwBnB6-=V7PMejU0qe9WG1YLn1d3gDGFQd-timyYEwkdZkQ@mail.gmail.com>

Thanks everyone for the suggestions.

On Wed, Aug 1, 2012 at 2:39 PM, peter dalgaard <pdalgd at gmail.com> wrote:
>
> On Jul 31, 2012, at 15:46 , Bert Gunter wrote:
>
>> Well, I would first check the references given in the Help file!.
>> That's what they're for, no?  Hastie's book is likely to more complete
>> on the algebra, I think.

How embarrassing... the help files do cite the white book (only), and
I did check it of course, but it has no more details on how the basis
functions are computed than does the help file itself, and so I must
have forgotten about it when writing my email. Still, my apologies for
the confusion.

I'm not sure what you mean by "Hastie's book", though?

>> You might also be interested in the relevant chapters of Friedman,
>> Hastie, et. al "The Elements of Statistical Learning Theory," which
>> might be a gentler exposition of the math.
>>
>> Of course, the code (or a suitable exposition of it, which may not
>> exist) is the ultimate reference.
>
> Also check out the various web resources (Google for basis spline or B-spline). I don't recall the white book chapter, but it might be a little short on the algebraic details. Another Google point is "de Boor".

And indeed, it looks like the appendix to chapter 5 of Hastie,
Tibshirani, and Friedman (2008) has a short description of the de Boor
algorithm. Excellent. For the archives, this seems to be enough to
exactly implement spline.des/splineDesign, and if anyone else is
working in Python then it turns out that there is a more-or-less
undocumented implementation of this algorithm in
scipy.interpolate.splev.

Now I just have to grovel over the R code in ns() and bs() to figure
out how exactly they pick knots and handle boundary conditions, plus
there is some code that I don't understand in ns() that uses qr() to
postprocess the output from spline.des. I assume this is involved
somehow in imposing the boundary conditions...

Thanks again everyone for your help,
-- Nathaniel


From pdalgd at gmail.com  Wed Aug  1 18:17:26 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 1 Aug 2012 18:17:26 +0200
Subject: [Rd] Numerics behind splineDesign
In-Reply-To: <CACk-te2bWUuvngQ6JiQ-QR0K+Dx4Mwh33pL-qB0d5o+EKgVz_g@mail.gmail.com>
References: <CAPJVwB=ppJ=SOs9k0p5ZHqGdnk8L1MZMBUbCSQ6oH5Zd5Pwpig@mail.gmail.com>
	<loom.20120731T152127-870@post.gmane.org>
	<CACk-te3ERmEVe2f2YqU8t5iFSVj0E9a4RGDTudDvGiAUyUQUtg@mail.gmail.com>
	<D7CCBAE0-4D80-436D-8594-17EDF691A75A@gmail.com>
	<CAPJVwBnB6-=V7PMejU0qe9WG1YLn1d3gDGFQd-timyYEwkdZkQ@mail.gmail.com>
	<CACk-te2bWUuvngQ6JiQ-QR0K+Dx4Mwh33pL-qB0d5o+EKgVz_g@mail.gmail.com>
Message-ID: <A3E04834-EEDA-4579-A776-70D19D958243@gmail.com>


On Aug 1, 2012, at 18:03 , Bert Gunter wrote:

> Inline...
> 
> On Wed, Aug 1, 2012 at 8:36 AM, Nathaniel Smith <njs at pobox.com> wrote:
>> Thanks everyone for the suggestions.
>> 
>> On Wed, Aug 1, 2012 at 2:39 PM, peter dalgaard <pdalgd at gmail.com> wrote:
>>> 
>>> On Jul 31, 2012, at 15:46 , Bert Gunter wrote:
>>> 
>>>> Well, I would first check the references given in the Help file!.
>>>> That's what they're for, no?  Hastie's book is likely to more complete
>>>> on the algebra, I think.
>> 
>> How embarrassing... the help files do cite the white book (only), and
>> I did check it of course, but it has no more details on how the basis
>> functions are computed than does the help file itself, and so I must
>> have forgotten about it when writing my email. Still, my apologies for
>> the confusion.
>> 
>> I'm not sure what you mean by "Hastie's book", though?
> 
> Ummm...  The following appears in the  ?bs man page. Why do you not
> see it? Are you perhaps being too "hasty" in your reading (heh-heh)?
> 
> References
> 
> Hastie, T. J. (1992) Generalized additive models. Chapter 7 of
> Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth
> & Brooks/Cole.

It's not Hastie's book, though.... It's his chapter in a book edited by Chambers and Hastie. 


-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From murdoch.duncan at gmail.com  Wed Aug  1 19:00:31 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 01 Aug 2012 13:00:31 -0400
Subject: [Rd] Package index help file question.
In-Reply-To: <501938F3.9040300@gmail.com>
References: <50166052.2080907@gmail.com> <501938F3.9040300@gmail.com>
Message-ID: <501960AF.9070809@gmail.com>

On 01/08/2012 10:10 AM, Damien Georges wrote:
> Dear R developers,
>
> I come to you because nobody was able to answer the following request yet.
>
> I'm developing a release of BIOMOD package called biomod2
> ( https://r-forge.r-project.org/R/?group_id=302).
>
> I'm writing my package helps files and I'm not really satisfied by the
> visual results.
>
> I would like to make subsections in the  package "function help index" file.
>
> I would like for example to put all S4 object documentation link
> together, then all the getters & setters functions.. and so on..
>
> Do you know if it's possible to do it?
> Is it possible to define by myself the html/00index.html file that will
> be use to build my package index file?
>
> If it's not possible, how could I add the alphabetic subsections that
> exists in most of packages index help files without raising the 100
> functions' help files?

There isn't any support for either of those things, but R is open 
source, so you might be able to do it.

The HTML index is created when the package is installed by the 
tools:::.writePkgIndices function, and is displayed by the tools:::httpd 
function.  You could modify either of those to either install or to just 
display something different.  Or more simply, you could write your own 
file and replace the 00Index.html file after your package is installed.

Duncan Murdoch


From lux-integ at btconnect.com  Thu Aug  2 10:33:12 2012
From: lux-integ at btconnect.com (luxInteg)
Date: Thu, 2 Aug 2012 09:33:12 +0100
Subject: [Rd] help with install.packages
Message-ID: <201208020933.12733.lux-integ@btconnect.com>

Greetings,

I am trying to use install.packages  obtained from here
http://stat.ethz.ch/R-manual/R-devel/library/utils/html/install.packages.html
My computer has these
OS: 64-bit blfs linux R2.15.1

#------------
A) I did the following:-

export DIR=/home/stats/R-2.15.0_runTEST190712A
export DEST=/home/stats/Rtester
cd $DEST

${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz, ${DEST}, repos = 
getOption("NULL"),
                 contriburl = contrib.url(NULL, type),
                 internal, available = NULL, destdir = ${DEST},
                 dependencies = NA, type = getOption("pkgType"),
                 configure.args = getOption("configure.args"),
                 configure.vars = getOption("configure.vars"),
                 clean = FALSE, Ncpus = getOption("2", 1L),
                 libs_only = FALSE, INSTALL_opts,--verbose)

and this is the result

stats [ ~ ]# export DIR=/home/stats/R-2.15.0_runTEST190712A
stats [ ~ ]# export DEST=/home/stats/Rtester
stats [ ~ ]# cd $DEST
stats [ ~/Rtester ]# 
stats [ ~/Rtester ]# ${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz, 
${DEST}, repos = getOption("NULL"),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]#                  contriburl = contrib.url(NULL, type),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]#                  internal, available = NULL, destdir = 
${DEST},
bash: internal,: command not found
stats [ ~/Rtester ]#                  dependencies = NA, type = 
getOption("pkgType"),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]#                  configure.args = 
getOption("configure.args"),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]#                  configure.vars = 
getOption("configure.vars"),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]#                  clean = FALSE, Ncpus = getOption("2", 
1L),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]#                  libs_only = FALSE, INSTALL_opts,--
verbose)


B)  I then did  it like so
export DIR=/home/stats/R-2.15.0_runTEST190712A
export DEST=/home/stats/Rtester
cd $DEST

${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz, ${DEST}, repos = 
getOption("NULL"),
contriburl = contrib.url(NULL, type),
method, available = NULL, destdir = ${DEST,
dependencies = NA, type = getOption("source"),
clean = FALSE, Ncpus = getOption("2", 1L),
libs_only = FALSE, INSTALL_opts, --verbose )

And this results:-

stats [ ~/Rtester ]# export DIR=/home/stats/R-2.15.0_runTEST190712A
stats [ ~/Rtester ]# export DEST=/home/stats/Rtester
stats [ ~/Rtester ]# cd $DEST
stats [ ~/Rtester ]# 
stats [ ~/Rtester ]# ${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz, 
${DEST}, repos = getOption("NULL"),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]# contriburl = contrib.url(NULL, type),
bash: syntax error near unexpected token `('
stats [ ~/Rtester ]# method, available = NULL, destdir = ${DEST,
> dependencies = NA, type = getOption("source"),
> configure.args = getOption("configure.args"),
> configure.vars = getOption("configure.vars"),
> clean = FALSE, Ncpus = getOption("2", 1L),
> libs_only = FALSE, INSTALL_opts, --verbose )

#-----------------------

advice would be appreciated

sincerely
luxInteg


From lux-integ at btconnect.com  Thu Aug  2 10:32:50 2012
From: lux-integ at btconnect.com (luxInteg)
Date: Thu, 2 Aug 2012 09:32:50 +0100
Subject: [Rd] INDEX   rdb and rdx files
Message-ID: <201208020932.50198.lux-integ@btconnect.com>

Greetings,


My computer has these
OS: 64-bit blfs linux R2.15.1

If one has  downloaded a tarball for example MASS.tar.ga and unzip it

Are there R commands to generate the following?:-

a) the INDEX file 
b) 'R' files   such as MASS.rdb and  MASS.rdx

advice would be appreciated

sincerely
luxInteg


From pdalgd at gmail.com  Thu Aug  2 10:39:18 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 2 Aug 2012 10:39:18 +0200
Subject: [Rd] INDEX   rdb and rdx files
In-Reply-To: <201208020932.50198.lux-integ@btconnect.com>
References: <201208020932.50198.lux-integ@btconnect.com>
Message-ID: <7687F163-C0D1-4E37-870A-B6CDEC461F6C@gmail.com>


On Aug 2, 2012, at 10:32 , luxInteg wrote:

> Greetings,
> 
> 
> My computer has these
> OS: 64-bit blfs linux R2.15.1
> 
> If one has  downloaded a tarball for example MASS.tar.ga and unzip it
> 
> Are there R commands to generate the following?:-
> 
> a) the INDEX file 
> b) 'R' files   such as MASS.rdb and  MASS.rdx
> 
> advice would be appreciated

I think you need to read the Installation and Administration manual:

http://cran.r-project.org/manuals.html

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From lux-integ at btconnect.com  Thu Aug  2 11:22:13 2012
From: lux-integ at btconnect.com (luxInteg)
Date: Thu, 2 Aug 2012 10:22:13 +0100
Subject: [Rd] INDEX   rdb and rdx files
In-Reply-To: <7687F163-C0D1-4E37-870A-B6CDEC461F6C@gmail.com>
References: <201208020932.50198.lux-integ@btconnect.com>
	<7687F163-C0D1-4E37-870A-B6CDEC461F6C@gmail.com>
Message-ID: <201208021022.13552.lux-integ@btconnect.com>

On Thursday 02 August 2012 09:39:18 peter dalgaard wrote:

> I think you need to read the Installation and Administration manual:
> 
> http://cran.r-project.org/manuals.html

thanks
but if you mean this
http://cran.r-project.org/doc/manuals/R-admin.html#Installation

I have studied it  and I have not seen anything pretaining to using R on the 
command line to generat INDEX files. nor  rdb/rdx files

The closest  I came was an email to a list in 2006  which discussed  the 
latter
https://stat.ethz.ch/pipermail/r-devel/2006-September/042700.html

and  this from 2003 pretaining to INDEX files
https://stat.ethz.ch/pipermail/r-help/2003-October/040862.html

So I am still unclear IF  one downloads an archived package and UNPACK it; if 
there are THEN  options to pass to R to generate INDEX files and  rdb/rdx 
files.

Are there?

sincerely
luxInteg


From ligges at statistik.tu-dortmund.de  Thu Aug  2 11:54:11 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 02 Aug 2012 11:54:11 +0200
Subject: [Rd] help with install.packages
In-Reply-To: <201208020933.12733.lux-integ@btconnect.com>
References: <201208020933.12733.lux-integ@btconnect.com>
Message-ID: <501A4E43.5000500@statistik.tu-dortmund.de>



On 02.08.2012 10:33, luxInteg wrote:
> Greetings,
>
> I am trying to use install.packages  obtained from here
> http://stat.ethz.ch/R-manual/R-devel/library/utils/html/install.packages.html
> My computer has these
> OS: 64-bit blfs linux R2.15.1
>
> #------------
> A) I did the following:-
>
> export DIR=/home/stats/R-2.15.0_runTEST190712A
> export DEST=/home/stats/Rtester
> cd $DEST
>
> ${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz, ${DEST}, repos =
> getOption("NULL"),
>                   contriburl = contrib.url(NULL, type),
>                   internal, available = NULL, destdir = ${DEST},
>                   dependencies = NA, type = getOption("pkgType"),
>                   configure.args = getOption("configure.args"),
>                   configure.vars = getOption("configure.vars"),
>                   clean = FALSE, Ncpus = getOption("2", 1L),
>                   libs_only = FALSE, INSTALL_opts,--verbose)
>
> and this is the result
>
> stats [ ~ ]# export DIR=/home/stats/R-2.15.0_runTEST190712A
> stats [ ~ ]# export DEST=/home/stats/Rtester
> stats [ ~ ]# cd $DEST
> stats [ ~/Rtester ]#
> stats [ ~/Rtester ]# ${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz,
> ${DEST}, repos = getOption("NULL"),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]#                  contriburl = contrib.url(NULL, type),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]#                  internal, available = NULL, destdir =
> ${DEST},
> bash: internal,: command not found
> stats [ ~/Rtester ]#                  dependencies = NA, type =
> getOption("pkgType"),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]#                  configure.args =
> getOption("configure.args"),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]#                  configure.vars =
> getOption("configure.vars"),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]#                  clean = FALSE, Ncpus = getOption("2",
> 1L),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]#                  libs_only = FALSE, INSTALL_opts,--
> verbose)
>
>
> B)  I then did  it like so
> export DIR=/home/stats/R-2.15.0_runTEST190712A
> export DEST=/home/stats/Rtester
> cd $DEST
>
> ${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz, ${DEST}, repos =
> getOption("NULL"),
> contriburl = contrib.url(NULL, type),
> method, available = NULL, destdir = ${DEST,
> dependencies = NA, type = getOption("source"),
> clean = FALSE, Ncpus = getOption("2", 1L),
> libs_only = FALSE, INSTALL_opts, --verbose )
>
> And this results:-
>
> stats [ ~/Rtester ]# export DIR=/home/stats/R-2.15.0_runTEST190712A
> stats [ ~/Rtester ]# export DEST=/home/stats/Rtester
> stats [ ~/Rtester ]# cd $DEST
> stats [ ~/Rtester ]#
> stats [ ~/Rtester ]# ${DIR}/bin/R install.packages(MASS_7.3-17.tar.gz,
> ${DEST}, repos = getOption("NULL"),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]# contriburl = contrib.url(NULL, type),
> bash: syntax error near unexpected token `('
> stats [ ~/Rtester ]# method, available = NULL, destdir = ${DEST,
>> dependencies = NA, type = getOption("source"),
>> configure.args = getOption("configure.args"),
>> configure.vars = getOption("configure.vars"),
>> clean = FALSE, Ncpus = getOption("2", 1L),
>> libs_only = FALSE, INSTALL_opts, --verbose )
>
> #-----------------------
>
> advice would be appreciated


Please ask basic questions on R-help and do not misuse R-devel.
And following the posting guide of R-help, you had probably read the 
documentation and found that install.packages() is to be called in R 
rather than on the shell of your operating system.

Best,
Uwe Ligges






>
> sincerely
> luxInteg
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From gunter.berton at gene.com  Wed Aug  1 18:03:06 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Wed, 1 Aug 2012 09:03:06 -0700
Subject: [Rd] Numerics behind splineDesign
In-Reply-To: <CAPJVwBnB6-=V7PMejU0qe9WG1YLn1d3gDGFQd-timyYEwkdZkQ@mail.gmail.com>
References: <CAPJVwB=ppJ=SOs9k0p5ZHqGdnk8L1MZMBUbCSQ6oH5Zd5Pwpig@mail.gmail.com>
	<loom.20120731T152127-870@post.gmane.org>
	<CACk-te3ERmEVe2f2YqU8t5iFSVj0E9a4RGDTudDvGiAUyUQUtg@mail.gmail.com>
	<D7CCBAE0-4D80-436D-8594-17EDF691A75A@gmail.com>
	<CAPJVwBnB6-=V7PMejU0qe9WG1YLn1d3gDGFQd-timyYEwkdZkQ@mail.gmail.com>
Message-ID: <CACk-te2bWUuvngQ6JiQ-QR0K+Dx4Mwh33pL-qB0d5o+EKgVz_g@mail.gmail.com>

Inline...

On Wed, Aug 1, 2012 at 8:36 AM, Nathaniel Smith <njs at pobox.com> wrote:
> Thanks everyone for the suggestions.
>
> On Wed, Aug 1, 2012 at 2:39 PM, peter dalgaard <pdalgd at gmail.com> wrote:
>>
>> On Jul 31, 2012, at 15:46 , Bert Gunter wrote:
>>
>>> Well, I would first check the references given in the Help file!.
>>> That's what they're for, no?  Hastie's book is likely to more complete
>>> on the algebra, I think.
>
> How embarrassing... the help files do cite the white book (only), and
> I did check it of course, but it has no more details on how the basis
> functions are computed than does the help file itself, and so I must
> have forgotten about it when writing my email. Still, my apologies for
> the confusion.
>
> I'm not sure what you mean by "Hastie's book", though?

Ummm...  The following appears in the  ?bs man page. Why do you not
see it? Are you perhaps being too "hasty" in your reading (heh-heh)?

References

Hastie, T. J. (1992) Generalized additive models. Chapter 7 of
Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth
& Brooks/Cole.

-- Bert
>
>>> You might also be interested in the relevant chapters of Friedman,
>>> Hastie, et. al "The Elements of Statistical Learning Theory," which
>>> might be a gentler exposition of the math.
>>>
>>> Of course, the code (or a suitable exposition of it, which may not
>>> exist) is the ultimate reference.
>>
>> Also check out the various web resources (Google for basis spline or B-spline). I don't recall the white book chapter, but it might be a little short on the algebraic details. Another Google point is "de Boor".
>
> And indeed, it looks like the appendix to chapter 5 of Hastie,
> Tibshirani, and Friedman (2008) has a short description of the de Boor
> algorithm. Excellent. For the archives, this seems to be enough to
> exactly implement spline.des/splineDesign, and if anyone else is
> working in Python then it turns out that there is a more-or-less
> undocumented implementation of this algorithm in
> scipy.interpolate.splev.
>
> Now I just have to grovel over the R code in ns() and bs() to figure
> out how exactly they pick knots and handle boundary conditions, plus
> there is some code that I don't understand in ns() that uses qr() to
> postprocess the output from spline.des. I assume this is involved
> somehow in imposing the boundary conditions...
>
> Thanks again everyone for your help,
> -- Nathaniel



-- 

Bert Gunter
Genentech Nonclinical Biostatistics

Internal Contact Info:
Phone: 467-7374
Website:
http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm


From gunter.berton at gene.com  Wed Aug  1 18:51:16 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Wed, 1 Aug 2012 09:51:16 -0700
Subject: [Rd] Numerics behind splineDesign
In-Reply-To: <A3E04834-EEDA-4579-A776-70D19D958243@gmail.com>
References: <CAPJVwB=ppJ=SOs9k0p5ZHqGdnk8L1MZMBUbCSQ6oH5Zd5Pwpig@mail.gmail.com>
	<loom.20120731T152127-870@post.gmane.org>
	<CACk-te3ERmEVe2f2YqU8t5iFSVj0E9a4RGDTudDvGiAUyUQUtg@mail.gmail.com>
	<D7CCBAE0-4D80-436D-8594-17EDF691A75A@gmail.com>
	<CAPJVwBnB6-=V7PMejU0qe9WG1YLn1d3gDGFQd-timyYEwkdZkQ@mail.gmail.com>
	<CACk-te2bWUuvngQ6JiQ-QR0K+Dx4Mwh33pL-qB0d5o+EKgVz_g@mail.gmail.com>
	<A3E04834-EEDA-4579-A776-70D19D958243@gmail.com>
Message-ID: <CACk-te2gDxDH-MnkeEHtTAOTRyaQciX310BTfZKED_DqGXDpbg@mail.gmail.com>

Thanks Peter.

So it was I who was being too "hasty." (heh-heh).*

-- Bert

*Yes, it was bad once. So twice makes it ... what, pathetic?


On Wed, Aug 1, 2012 at 9:17 AM, peter dalgaard <pdalgd at gmail.com> wrote:
>
> On Aug 1, 2012, at 18:03 , Bert Gunter wrote:
>
>> Inline...
>>
>> On Wed, Aug 1, 2012 at 8:36 AM, Nathaniel Smith <njs at pobox.com> wrote:
>>> Thanks everyone for the suggestions.
>>>
>>> On Wed, Aug 1, 2012 at 2:39 PM, peter dalgaard <pdalgd at gmail.com> wrote:
>>>>
>>>> On Jul 31, 2012, at 15:46 , Bert Gunter wrote:
>>>>
>>>>> Well, I would first check the references given in the Help file!.
>>>>> That's what they're for, no?  Hastie's book is likely to more complete
>>>>> on the algebra, I think.
>>>
>>> How embarrassing... the help files do cite the white book (only), and
>>> I did check it of course, but it has no more details on how the basis
>>> functions are computed than does the help file itself, and so I must
>>> have forgotten about it when writing my email. Still, my apologies for
>>> the confusion.
>>>
>>> I'm not sure what you mean by "Hastie's book", though?
>>
>> Ummm...  The following appears in the  ?bs man page. Why do you not
>> see it? Are you perhaps being too "hasty" in your reading (heh-heh)?
>>
>> References
>>
>> Hastie, T. J. (1992) Generalized additive models. Chapter 7 of
>> Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth
>> & Brooks/Cole.
>
> It's not Hastie's book, though.... It's his chapter in a book edited by Chambers and Hastie.
>
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
>
>
>
>
>
>
>



-- 

Bert Gunter
Genentech Nonclinical Biostatistics

Internal Contact Info:
Phone: 467-7374
Website:
http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm


From pdalgd at gmail.com  Thu Aug  2 14:16:41 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 2 Aug 2012 14:16:41 +0200
Subject: [Rd] INDEX   rdb and rdx files
In-Reply-To: <201208021022.13552.lux-integ@btconnect.com>
References: <201208020932.50198.lux-integ@btconnect.com>
	<7687F163-C0D1-4E37-870A-B6CDEC461F6C@gmail.com>
	<201208021022.13552.lux-integ@btconnect.com>
Message-ID: <1192CBDA-024F-4CFF-8DF3-0D322A8C14C0@gmail.com>


On Aug 2, 2012, at 11:22 , luxInteg wrote:

> On Thursday 02 August 2012 09:39:18 peter dalgaard wrote:
> 
>> I think you need to read the Installation and Administration manual:
>> 
>> http://cran.r-project.org/manuals.html
> 
> thanks
> but if you mean this
> http://cran.r-project.org/doc/manuals/R-admin.html#Installation

Yes, chapter 6. Do pay attention to the difference between R command-line usage and shell commands, though.


-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From therneau at mayo.edu  Thu Aug  2 15:09:38 2012
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 02 Aug 2012 08:09:38 -0500
Subject: [Rd] Rd] Numerics behind splineDesign
In-Reply-To: <mailman.25.1343901607.15222.r-devel@r-project.org>
References: <mailman.25.1343901607.15222.r-devel@r-project.org>
Message-ID: <501A7C12.90407@mayo.edu>



On 08/02/2012 05:00 AM, r-devel-request at r-project.org wrote:
> Now I just have to grovel over the R code in ns() and bs() to figure
> out how exactly they pick knots and handle boundary conditions, plus
> there is some code that I don't understand in ns() that uses qr() to
> postprocess the output from spline.des. I assume this is involved
> somehow in imposing the boundary conditions...
>
> Thanks again everyone for your help,
> -- Nathaniel
The ns and bs function post-process the spline bases to get an 
orthagonal basis matrix, this is the use of qr.  I think this causes 
much more grief than it is worth, for the sake of a small increase in 
numeric stability.  For instance when you plot the spline bases, they 
don't look anything like the basis functions one would expect.  (Perhaps 
my background in numerical analysis was a hindrance here, since I know 
something about splines and thus have an expectation).

Terry Therneau


From njs at pobox.com  Thu Aug  2 16:11:59 2012
From: njs at pobox.com (Nathaniel Smith)
Date: Thu, 2 Aug 2012 15:11:59 +0100
Subject: [Rd] Rd] Numerics behind splineDesign
In-Reply-To: <501A7C12.90407@mayo.edu>
References: <mailman.25.1343901607.15222.r-devel@r-project.org>
	<501A7C12.90407@mayo.edu>
Message-ID: <CAPJVwB=zaJayKcWcd6CBzxwPKi1R73JojsZAJ5=6g3hYEOGi_A@mail.gmail.com>

On Thu, Aug 2, 2012 at 2:09 PM, Terry Therneau <therneau at mayo.edu> wrote:
>
>
> On 08/02/2012 05:00 AM, r-devel-request at r-project.org wrote:
>>
>> Now I just have to grovel over the R code in ns() and bs() to figure
>> out how exactly they pick knots and handle boundary conditions, plus
>> there is some code that I don't understand in ns() that uses qr() to
>> postprocess the output from spline.des. I assume this is involved
>> somehow in imposing the boundary conditions...
>>
>> Thanks again everyone for your help,
>> -- Nathaniel
>
> The ns and bs function post-process the spline bases to get an orthagonal
> basis matrix, this is the use of qr.  I think this causes much more grief
> than it is worth, for the sake of a small increase in numeric stability.
> For instance when you plot the spline bases, they don't look anything like
> the basis functions one would expect.  (Perhaps my background in numerical
> analysis was a hindrance here, since I know something about splines and thus
> have an expectation).

You know, the white book does claim that S orthogonalizes the spline
basis functions, but R doesn't seem to actually do that:

> crossprod(bs(1:10, 4, intercept=TRUE))
           1         2         3          4
1 1.84104162 0.6154211 0.2570069 0.06430817
2 0.61542109 0.7710207 0.5787736 0.25700689
3 0.25700689 0.5787736 0.7710207 0.61542109
4 0.06430817 0.2570069 0.6154211 1.84104162
> crossprod(ns(1:10, 4, intercept=TRUE))
           1         2           3           4
1  1.0659929 0.5314089  0.37125505 -0.17838443
2  0.5314089 1.0681360  0.23122018  0.14422236
3  0.3712550 0.2312202  1.30226657 -0.03809082
4 -0.1783844 0.1442224 -0.03809082  1.10144173

and they look quite reasonable when plotted to me.

ns is doing something more complicated; I think it's computing the
second derivatives of each basis function at the position of the
boundary knots, and then using that to somehow transform the original
basis. Since the key feature of ns is that the returned basis has a
zero second derivative at the boundary knots, I'm sure this makes
sense if one stares at it for long enough.

-n


From wdunlap at tibco.com  Thu Aug  2 18:59:17 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 2 Aug 2012 16:59:17 +0000
Subject: [Rd] Rd] Numerics behind splineDesign
In-Reply-To: <501A7C12.90407@mayo.edu>
References: <mailman.25.1343901607.15222.r-devel@r-project.org>
	<501A7C12.90407@mayo.edu>
Message-ID: <E66794E69CFDE04D9A70842786030B932E063C@PA-MBX01.na.tibco.com>

If R's bs() and ns() are like S+'s (they do give very similar results* and
S+'s were written by Doug Bates), then bs() does not do any linear algebra
(like qr()) on splineDesign's output. bs() needs to come up with a default
set of knots (if the user didn't supply them), combine the Boundary.knots
(repeated ord times) and knots into one vector to pass to splineDesign,
and, if there are any x's outside of range(Boundary.knots), treat them specially.
 
ns() needs to project  splineDesign's basis functions onto the subspace
of functions whose 2nd derivatives are zero at the endpoints.  The projection
can be done with qr() and friends (S+ uses qr()).

(If you want basis functions for a periodic spline you could use a similar procedure
to project to the subspace of functions whose first and second derivatives
match at the upper and lower Boundary.knots.)

* The only difference between the R and S+ versions of bs() that I've noticed
is in how they deal with the x's that are outside of range(Boundary.knots).
S+ extrapolates with cubics both above and below that range while R extrapolates
with a cubic below the range and with a quadratic above the range.  I don't know
what the rationale for this is.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf
> Of Terry Therneau
> Sent: Thursday, August 02, 2012 6:10 AM
> To: r-devel at r-project.org; Nathaniel Smith
> Subject: Re: [Rd] Rd] Numerics behind splineDesign
> 
> 
> 
> On 08/02/2012 05:00 AM, r-devel-request at r-project.org wrote:
> > Now I just have to grovel over the R code in ns() and bs() to figure
> > out how exactly they pick knots and handle boundary conditions, plus
> > there is some code that I don't understand in ns() that uses qr() to
> > postprocess the output from spline.des. I assume this is involved
> > somehow in imposing the boundary conditions...
> >
> > Thanks again everyone for your help,
> > -- Nathaniel
> The ns and bs function post-process the spline bases to get an
> orthagonal basis matrix, this is the use of qr.  I think this causes
> much more grief than it is worth, for the sake of a small increase in
> numeric stability.  For instance when you plot the spline bases, they
> don't look anything like the basis functions one would expect.  (Perhaps
> my background in numerical analysis was a hindrance here, since I know
> something about splines and thus have an expectation).
> 
> Terry Therneau
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From therneau at mayo.edu  Thu Aug  2 19:26:08 2012
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 02 Aug 2012 12:26:08 -0500
Subject: [Rd] Rd] Numerics behind splineDesign
In-Reply-To: <E66794E69CFDE04D9A70842786030B932E063C@PA-MBX01.na.tibco.com>
References: <mailman.25.1343901607.15222.r-devel@r-project.org>
	<501A7C12.90407@mayo.edu>
	<E66794E69CFDE04D9A70842786030B932E063C@PA-MBX01.na.tibco.com>
Message-ID: <501AB830.5000909@mayo.edu>

Clearly, I got it wrong.
Thanks to others for the clearer and correct message.
Terry T

On 08/02/2012 11:59 AM, William Dunlap wrote:
> If R's bs() and ns() are like S+'s (they do give very similar results* and
> S+'s were written by Doug Bates), then bs() does not do any linear algebra
> (like qr()) on splineDesign's output. bs() needs to come up with a default
> set of knots (if the user didn't supply them), combine the Boundary.knots
> (repeated ord times) and knots into one vector to pass to splineDesign,
> and, if there are any x's outside of range(Boundary.knots), treat them specially.
>
> ns() needs to project  splineDesign's basis functions onto the subspace
> of functions whose 2nd derivatives are zero at the endpoints.  The projection
> can be done with qr() and friends (S+ uses qr()).
>
> (If you want basis functions for a periodic spline you could use a similar procedure
> to project to the subspace of functions whose first and second derivatives
> match at the upper and lower Boundary.knots.)
>
> * The only difference between the R and S+ versions of bs() that I've noticed
> is in how they deal with the x's that are outside of range(Boundary.knots).
> S+ extrapolates with cubics both above and below that range while R extrapolates
> with a cubic below the range and with a quadratic above the range.  I don't know
> what the rationale for this is.
>
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com
>
>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf
>> Of Terry Therneau
>> Sent: Thursday, August 02, 2012 6:10 AM
>> To: r-devel at r-project.org; Nathaniel Smith
>> Subject: Re: [Rd] Rd] Numerics behind splineDesign
>>
>>
>>
>> On 08/02/2012 05:00 AM, r-devel-request at r-project.org wrote:
>>> Now I just have to grovel over the R code in ns() and bs() to figure
>>> out how exactly they pick knots and handle boundary conditions, plus
>>> there is some code that I don't understand in ns() that uses qr() to
>>> postprocess the output from spline.des. I assume this is involved
>>> somehow in imposing the boundary conditions...
>>>
>>> Thanks again everyone for your help,
>>> -- Nathaniel
>> The ns and bs function post-process the spline bases to get an
>> orthagonal basis matrix, this is the use of qr.  I think this causes
>> much more grief than it is worth, for the sake of a small increase in
>> numeric stability.  For instance when you plot the spline bases, they
>> don't look anything like the basis functions one would expect.  (Perhaps
>> my background in numerical analysis was a hindrance here, since I know
>> something about splines and thus have an expectation).
>>
>> Terry Therneau
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From hpages at fhcrc.org  Sat Aug  4 01:18:55 2012
From: hpages at fhcrc.org (=?windows-1252?Q?Herv=E9_Pag=E8s?=)
Date: Fri, 03 Aug 2012 16:18:55 -0700
Subject: [Rd] Interaction between callNextMethod() and selectMethod()
Message-ID: <501C5C5F.6050900@fhcrc.org>

Hi,

Strange things happen. Here is a simple example:

   > setClass("A", contains="integer")
   > setMethod("as.matrix", "A", function(x, ...) t(callNextMethod()))
   Creating a generic function for ?as.matrix? from package ?base? in 
the global environment
   [1] "as.matrix"
   > a <- new("A", 1:3)
   > as.matrix(a)
        [,1] [,2] [,3]
   [1,]    1    2    3

Everything fine so far. But:

   > selectMethod("as.matrix", "A")(a)
   Error in callNextMethod() :
     c("a call to callNextMethod() appears in a call to 
\"selectMethod\", but the call does not seem to come from either a 
generic function or another 'callNextMethod'", "a call to 
callNextMethod() appears in a call to \"as.matrix\", but the call does 
not seem to come from either a generic function or another 
'callNextMethod'", "a call to callNextMethod() appears in a call to 
\"A\", but the call does not seem to come from either a generic function 
or another 'callNextMethod'")
   In addition: Warning message:
   In if (is.na(i)) { :
     the condition has length > 1 and only the first element will be used

2 things about this:

(1) Sure callNextMethod() needs some context in order to know what to
     do but it seems that the MethodDefinition object returned by
     selectMethod() carries that context i.e. it seems to contain
     all the information that callNextMethod() would need (name of the
     generic and defined signature) to actually work:

       > mymethod <- selectMethod("as.matrix", "A")
       > class(mymethod)
       [1] "MethodDefinition"
       attr(,"package")
       [1] "methods"
       > mymethod at generic
       [1] "as.matrix"
       attr(,"package")
       [1] "base"
       > mymethod at defined
       An object of class "signature"
         x
       "A"

(2) If for whatever reason callNextMethod() really needs to fail, could
     the error handling be fixed so it produces the same output as:

     > mymethod(a)
     Error in callNextMethod() :
       a call to callNextMethod() appears in a call to "mymethod", but 
the call does not seem to come from either a generic function or another 
'callNextMethod'

Thanks!
H.

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fhcrc.org  Sat Aug  4 01:24:50 2012
From: hpages at fhcrc.org (=?windows-1252?Q?Herv=E9_Pag=E8s?=)
Date: Fri, 03 Aug 2012 16:24:50 -0700
Subject: [Rd] Interaction between callNextMethod() and selectMethod()
In-Reply-To: <501C5C5F.6050900@fhcrc.org>
References: <501C5C5F.6050900@fhcrc.org>
Message-ID: <501C5DC2.4040400@fhcrc.org>

FWIW, here is my sessionInfo:

   > sessionInfo()
   R Under development (unstable) (2012-07-25 r59963)
   Platform: x86_64-unknown-linux-gnu (64-bit)

   locale:
    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
    [7] LC_PAPER=C                 LC_NAME=C
    [9] LC_ADDRESS=C               LC_TELEPHONE=C
   [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

   attached base packages:
   [1] stats     graphics  grDevices utils     datasets  methods   base

BTW, it's funny that the VERSION file in the R source tree says:

   hpages at latitude:~/src/R-2.16.r59963$ cat VERSION
   2.16.0 Under development (unstable)
   ^^^^^^

H.

On 08/03/2012 04:18 PM, Herv? Pag?s wrote:
> Hi,
>
> Strange things happen. Here is a simple example:
>
>    > setClass("A", contains="integer")
>    > setMethod("as.matrix", "A", function(x, ...) t(callNextMethod()))
>    Creating a generic function for ?as.matrix? from package ?base? in
> the global environment
>    [1] "as.matrix"
>    > a <- new("A", 1:3)
>    > as.matrix(a)
>         [,1] [,2] [,3]
>    [1,]    1    2    3
>
> Everything fine so far. But:
>
>    > selectMethod("as.matrix", "A")(a)
>    Error in callNextMethod() :
>      c("a call to callNextMethod() appears in a call to
> \"selectMethod\", but the call does not seem to come from either a
> generic function or another 'callNextMethod'", "a call to
> callNextMethod() appears in a call to \"as.matrix\", but the call does
> not seem to come from either a generic function or another
> 'callNextMethod'", "a call to callNextMethod() appears in a call to
> \"A\", but the call does not seem to come from either a generic function
> or another 'callNextMethod'")
>    In addition: Warning message:
>    In if (is.na(i)) { :
>      the condition has length > 1 and only the first element will be used
>
> 2 things about this:
>
> (1) Sure callNextMethod() needs some context in order to know what to
>      do but it seems that the MethodDefinition object returned by
>      selectMethod() carries that context i.e. it seems to contain
>      all the information that callNextMethod() would need (name of the
>      generic and defined signature) to actually work:
>
>        > mymethod <- selectMethod("as.matrix", "A")
>        > class(mymethod)
>        [1] "MethodDefinition"
>        attr(,"package")
>        [1] "methods"
>        > mymethod at generic
>        [1] "as.matrix"
>        attr(,"package")
>        [1] "base"
>        > mymethod at defined
>        An object of class "signature"
>          x
>        "A"
>
> (2) If for whatever reason callNextMethod() really needs to fail, could
>      the error handling be fixed so it produces the same output as:
>
>      > mymethod(a)
>      Error in callNextMethod() :
>        a call to callNextMethod() appears in a call to "mymethod", but
> the call does not seem to come from either a generic function or another
> 'callNextMethod'
>
> Thanks!
> H.
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From pdalgd at gmail.com  Sat Aug  4 08:44:23 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Sat, 4 Aug 2012 08:44:23 +0200
Subject: [Rd] Interaction between callNextMethod() and selectMethod()
In-Reply-To: <501C5DC2.4040400@fhcrc.org>
References: <501C5C5F.6050900@fhcrc.org> <501C5DC2.4040400@fhcrc.org>
Message-ID: <718A77A6-4F74-4DD1-84F8-AC45AA8642D3@gmail.com>


On Aug 4, 2012, at 01:24 , Herv? Pag?s wrote:

> BTW, it's funny that the VERSION file in the R source tree says:
> 
>  hpages at latitude:~/src/R-2.16.r59963$ cat VERSION
>  2.16.0 Under development (unstable)
>  ^^^^^^

What's funny about that? We no longer display the number on startup and at some point we may not even use it for an actual release, but there needs to be a number to test "R >= 2.14.0"-style dependencies and such. 

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ripley at stats.ox.ac.uk  Sat Aug  4 22:07:47 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 04 Aug 2012 21:07:47 +0100
Subject: [Rd] Problem in vignette packaging of Sweave in utils package
In-Reply-To: <CAErODj_bN3xec_6HGGPi1ZFrXt486BttOEzO0JxVGmZu2H9GvQ@mail.gmail.com>
References: <CAErODj_9n7cjy5iPkjr-GOocL23hnJwX2QCYSd+4zJfgu0SUpA@mail.gmail.com>
	<4FF82AD0.1020605@gmail.com>
	<CAErODj9Xu=TcHnEzQj6Auq9CO6cEAbvQeW9RTS3j=g60F-BnBA@mail.gmail.com>
	<5012ABB3.3020300@gmail.com>
	<CAErODj_bN3xec_6HGGPi1ZFrXt486BttOEzO0JxVGmZu2H9GvQ@mail.gmail.com>
Message-ID: <501D8113.4090403@stats.ox.ac.uk>

I believe the issue is actually quite simple: you need to run

make vignettes

when building from a tarball if you want the tangled vignettes and the 
indices.

I'll make that automatic after more testing.

On 27/07/2012 21:55, Paul Johnson wrote:
> On Fri, Jul 27, 2012 at 9:54 AM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>> On 12-07-27 1:23 AM, Paul Johnson wrote:
>>>
>>> New help request below
>>>
>>> On Sat, Jul 7, 2012 at 7:25 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
>>> wrote:
>>>>
>>>> On 12-07-03 1:21 PM, Paul Johnson wrote:
>>>>>
>>>>>
>>>>> In ?Sweave, it refers to Sweave User Manual. In the doc folder of
>>>>> utils package, I see "Sweave.pdf".
>>>>>
>>>>> However, I can't find it from within R
>>>>>
>>>>>
>>>>>> vignette("Sweave User Manual")
>>>>>
>>>>>
>>>>> Warning message:
>>>>> vignette ?Sweave User Manual? not found
>>>>
>>>>
>>>>
>>>> Turns out there was a bug in the code to install from tarballs, so base
>>>> package vignettes weren't fully installed.  I've fixed it; installs from
>>>> R-patched or R-devel revisions after 59750 should be okay.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>
>>>
>>> Thanks, Duncan
>>>
>>> Can I ask you to check this one again?
>>
>>
>> Sorry, I can't help with this.  If you build from svn or from a tarball,
>> then I could help, but someone else produces the rpms, and I don't have
>> access to a Linux system to try them.
>>
>> Duncan Murdoch
>>
>>
>
> Sorry I was unclear. I did build from R-patched tarball, from here:
>
> ftp://ftp.stat.math.ethz.ch/Software/R/R-patched_2012-07-25.tar.gz
>
> I get the same result whether I build that into an RPM or if I build
> and install the "old fashioned" way (configure, make, make install).
> The Sweave pdf is created, but not found inside R.
>
> I just re-ran the compilation in an Emacs shell and you can see
> everything that goes on:
>
> http://pj.freefaculty.org/misc/R-patched-build-20120725.txt
>
> As you will see, I run into problems with pdf creation in
>
> make pdf
>
> dealing with refman. I think that links back to the ancient tetex
> toolkit and the lack of incolsolata font.  If that is the reason R
> can't find the vignette, I would be glad to know.
>
> I do get the Sweave.pdf vignette created, just not indexed.
>
> pj
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hpages at fhcrc.org  Sun Aug  5 03:49:49 2012
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Sat, 04 Aug 2012 18:49:49 -0700
Subject: [Rd] Interaction between callNextMethod() and selectMethod()
In-Reply-To: <718A77A6-4F74-4DD1-84F8-AC45AA8642D3@gmail.com>
References: <501C5C5F.6050900@fhcrc.org> <501C5DC2.4040400@fhcrc.org>
	<718A77A6-4F74-4DD1-84F8-AC45AA8642D3@gmail.com>
Message-ID: <501DD13D.7020906@fhcrc.org>

On 08/03/2012 11:44 PM, peter dalgaard wrote:
>
> On Aug 4, 2012, at 01:24 , Herv? Pag?s wrote:
>
>> BTW, it's funny that the VERSION file in the R source tree says:
>>
>>   hpages at latitude:~/src/R-2.16.r59963$ cat VERSION
>>   2.16.0 Under development (unstable)
>>   ^^^^^^
>
> What's funny about that? We no longer display the number on startup and at some point we may not even use it for an actual release, but there needs to be a number to test "R >= 2.14.0"-style dependencies and such.
>

What's funny is that even if we try to pretend that the version
number doesn't matter, it actually does matter. Not only for
"R >= 2.14.0"-style dependencies and such, but also for human communication:

- Can't install that package!
- Works for me. What version of R are you using?
- "Unsuffered Consequences"
- I'm using "Roasted Marshmallows", you should upgrade to
   that one.
- I'm confused I thought I was running the latest.
- No "Roasted Marshmallows" is the latest.
- Are you sure? How do you know?

etc, etc...

It reminds me of Mozilla plans to hide Firefox version:

   https://bugzilla.mozilla.org/show_bug.cgi?id=678775

AFAIK they finally abandoned it :-)

H.

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From simon.urbanek at r-project.org  Sun Aug  5 04:16:52 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 4 Aug 2012 22:16:52 -0400
Subject: [Rd] Interaction between callNextMethod() and selectMethod()
In-Reply-To: <501DD13D.7020906@fhcrc.org>
References: <501C5C5F.6050900@fhcrc.org> <501C5DC2.4040400@fhcrc.org>
	<718A77A6-4F74-4DD1-84F8-AC45AA8642D3@gmail.com>
	<501DD13D.7020906@fhcrc.org>
Message-ID: <747B827C-FB62-4B34-B4EE-5B3C006F659C@r-project.org>


On Aug 4, 2012, at 9:49 PM, Herv? Pag?s wrote:

> On 08/03/2012 11:44 PM, peter dalgaard wrote:
>> 
>> On Aug 4, 2012, at 01:24 , Herv? Pag?s wrote:
>> 
>>> BTW, it's funny that the VERSION file in the R source tree says:
>>> 
>>>  hpages at latitude:~/src/R-2.16.r59963$ cat VERSION
>>>  2.16.0 Under development (unstable)
>>>  ^^^^^^
>> 
>> What's funny about that? We no longer display the number on startup and at some point we may not even use it for an actual release, but there needs to be a number to test "R >= 2.14.0"-style dependencies and such.
>> 
> 
> What's funny is that even if we try to pretend that the version
> number doesn't matter, it actually does matter. Not only for
> "R >= 2.14.0"-style dependencies and such, but also for human communication:
> 
> - Can't install that package!
> - Works for me. What version of R are you using?
> - "Unsuffered Consequences"
> - I'm using "Roasted Marshmallows", you should upgrade to
>  that one.
> - I'm confused I thought I was running the latest.
> - No "Roasted Marshmallows" is the latest.
> - Are you sure? How do you know?
> 
> etc, etc...
> 
> It reminds me of Mozilla plans to hide Firefox version:
> 
>  https://bugzilla.mozilla.org/show_bug.cgi?id=678775
> 
> AFAIK they finally abandoned it :-)
> 

I agree. Currently R-devel doesn't show the version number and that makes sense for two reasons: let's say today R-devel's internal version is 2.16.0 but such release doesn't exist yet so you can't call R-devel that in any case that may be referenced later (because then there will be 2.16.0 release at some point which is different from the R-devel that was referred to). Also we don't know for sure if the next release will be 2.16.0 or let's say 3.0.0.

That said, I was surprised that Peter said "for an actual release" (I'm not sure he meant it in the way you interpreted it, though) - I think it's slightly annoying that R.version.string in R-devel doesn't contain the version number (because it makes it slightly more complicated to get the version number in scripts), but not having it or showing it for releases would certainly be fatal but I did not see any reason or discussion about such a move.

Cheers,
Simon


From rhurlin at gwdg.de  Sun Aug  5 09:53:02 2012
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Sun, 05 Aug 2012 09:53:02 +0200
Subject: [Rd] Daily snapshots of sources do not work?
Message-ID: <501E265E.3060606@gwdg.de>

For some days now there had been no more daily snapshots on

ftp://ftp.stat.math.ethz.ch/Software/R/ .

The latest sources are from 07/26/2012. I think this is not indented?


From ripley at stats.ox.ac.uk  Sun Aug  5 10:24:12 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 05 Aug 2012 09:24:12 +0100
Subject: [Rd] Daily snapshots of sources do not work?
In-Reply-To: <501E265E.3060606@gwdg.de>
References: <501E265E.3060606@gwdg.de>
Message-ID: <501E2DAC.6000003@stats.ox.ac.uk>

On 05/08/2012 08:53, Rainer Hurling wrote:
> For some days now there had been no more daily snapshots on
>
> ftp://ftp.stat.math.ethz.ch/Software/R/ .
>
> The latest sources are from 07/26/2012. I think this is not indented?

Whatever '07/26/2012' means!

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

Yes, we know.  But:

- only people at that site can deal with this
- people do have vacations, and things do break in their absence

At least we should thank Martin Maechler and colleagues that this does 
work well over 99% of the time.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pdalgd at gmail.com  Sun Aug  5 10:33:33 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Sun, 5 Aug 2012 10:33:33 +0200
Subject: [Rd] Interaction between callNextMethod() and selectMethod()
In-Reply-To: <747B827C-FB62-4B34-B4EE-5B3C006F659C@r-project.org>
References: <501C5C5F.6050900@fhcrc.org> <501C5DC2.4040400@fhcrc.org>
	<718A77A6-4F74-4DD1-84F8-AC45AA8642D3@gmail.com>
	<501DD13D.7020906@fhcrc.org>
	<747B827C-FB62-4B34-B4EE-5B3C006F659C@r-project.org>
Message-ID: <BFAFDE5D-4E24-4710-A9E3-E11E002B7D01@gmail.com>


On Aug 5, 2012, at 04:16 , Simon Urbanek wrote:

> 
> On Aug 4, 2012, at 9:49 PM, Herv? Pag?s wrote:
> 
>> On 08/03/2012 11:44 PM, peter dalgaard wrote:
>>> 
>>> On Aug 4, 2012, at 01:24 , Herv? Pag?s wrote:
>>> 
>>>> BTW, it's funny that the VERSION file in the R source tree says:
>>>> 
>>>> hpages at latitude:~/src/R-2.16.r59963$ cat VERSION
>>>> 2.16.0 Under development (unstable)
>>>> ^^^^^^
>>> 
>>> What's funny about that? We no longer display the number on startup and at some point we may not even use it for an actual release, but there needs to be a number to test "R >= 2.14.0"-style dependencies and such.
>>> 
>> 
>> What's funny is that even if we try to pretend that the version
>> number doesn't matter, it actually does matter. Not only for
>> "R >= 2.14.0"-style dependencies and such, but also for human communication:
>> 
>> - Can't install that package!
>> - Works for me. What version of R are you using?
>> - "Unsuffered Consequences"
>> - I'm using "Roasted Marshmallows", you should upgrade to
>> that one.
>> - I'm confused I thought I was running the latest.
>> - No "Roasted Marshmallows" is the latest.
>> - Are you sure? How do you know?
>> 
>> etc, etc...
>> 
>> It reminds me of Mozilla plans to hide Firefox version:
>> 
>> https://bugzilla.mozilla.org/show_bug.cgi?id=678775
>> 
>> AFAIK they finally abandoned it :-)
>> 
> 
> I agree. Currently R-devel doesn't show the version number and that makes sense for two reasons: let's say today R-devel's internal version is 2.16.0 but such release doesn't exist yet so you can't call R-devel that in any case that may be referenced later (because then there will be 2.16.0 release at some point which is different from the R-devel that was referred to). Also we don't know for sure if the next release will be 2.16.0 or let's say 3.0.0.
> 
> That said, I was surprised that Peter said "for an actual release" (I'm not sure he meant it in the way you interpreted it, though) - I think it's slightly annoying that R.version.string in R-devel doesn't contain the version number (because it makes it slightly more complicated to get the version number in scripts), but not having it or showing it for releases would certainly be fatal but I did not see any reason or discussion about such a move.

"Actual release" meant exactly what you say: There's no 2.16.0 release yet, and (in principle) the next one might be 3.0.0. 

The number is there, though. For one thing, install.packages() would break without it. We just do not show it so that people will not mistake it for a release code. (Simon: You don't want to parse R.version.string, the information is already in the other fields of R.version.)

R-devel is not a release (and neither is R-patched, for that matter), There is no way in which it is reasonable to call R-devel "the latest R" etc. What it is is a snapshot of the current sources; it is not intended for production use. Do so and you'll suffer the consequences... It is by definition unstable: It may happen that someone forgets to add a new file while modifying another so that R no longer builds for anyone except himself -- we don't need 100 bug reports on "R 2.16.0" on that account. Or there can be platform issues or unexpected CRAN repercussions. 

Notice that since R-devel and R-patched are constantly changing, the formal version number is insufficient to identify the set of sources, and we need the Subversion revision number to identify the exact set of sources.  

For basically the converse reasons, R (source) releases can not be changed retroactively. So until the next release, bug fixes go to R-patched or R-devel, which is why we ask people to at least check those versions (or just their NEWS files) before submitting bugs.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From lawrence.michael at gene.com  Sun Aug  5 18:00:36 2012
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Sun, 5 Aug 2012 09:00:36 -0700
Subject: [Rd] setting invalid fields on reference classes sometimes allowed
Message-ID: <CAOQ5Nye6czTGueraiCFY8m9=KpY5wM8X23zCs4Nq2crsPLuO=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120805/71505a3b/attachment.pl>

From jmc at r-project.org  Mon Aug  6 00:54:43 2012
From: jmc at r-project.org (John Chambers)
Date: Sun, 05 Aug 2012 15:54:43 -0700
Subject: [Rd] setting invalid fields on reference classes sometimes
	allowed
In-Reply-To: <CAOQ5Nye6czTGueraiCFY8m9=KpY5wM8X23zCs4Nq2crsPLuO=g@mail.gmail.com>
References: <CAOQ5Nye6czTGueraiCFY8m9=KpY5wM8X23zCs4Nq2crsPLuO=g@mail.gmail.com>
Message-ID: <501EF9B3.7000706@r-project.org>

This doesn't seem to have anything to do with reference classes but 
rather is deep in  the evaluator.  At least when set up in the simple 
form of your example, the $<- method is never called.

For example:

>  Foo <- setRefClass("Foo")
> foo <- Foo$new()
> find("$<-")
[1] "package:base"
> debug(base::`$<-`)
> foo$a <- 1

Other variants on this seem still not to call the replacement function, 
and therefore not to dispatch the correct method.

I haven't had a chance to debug this at the required grubby level, but 
my guess is that the problem comes from base::`$<-` being a primitive, 
and not thinking it needs to check for methods.

Various kludgey workarounds will get the evaluator's attention and fix 
things.

> trace("$<-", sig = "Foo", browser)
Tracing specified method for function "$<-" in package "base"
[1] "$<-"
> untrace("$<-", sig = "Foo")
Untracing specified method for function "$<-" in package "base"
> foo$a <- 1
Error in envRefSetField(x, what, refObjectClass(x), selfEnv, value) :
   "a" is not a field in class "Foo"


Sigh.
   John

On 8/5/12 9:00 AM, Michael Lawrence wrote:
> I've found that reference class objects tend to behave like plain old
> environments wrt field access, unless a method on e.g. $<- is explicitly
> defined.
>
> Here is a code snippet:
>
> library(methods)
>
> Foo <- setRefClass("Foo")
> foo <- Foo$new()
> foo$a <- 2 # why does this succeed? not a valid field!
> ## set a silly $<- method
> setReplaceMethod("$", "Foo", function(x, name, value) {
>    callNextMethod(x, "b", value)})
>
> foo$b <- 3
>
>
> At first, we can set the non-existent field "a" without any error (I don't
> think this is the intended behavior). Then we set a silly override on $<-
> and things start to behave as expected:
>
> Error in envRefSetField(x, what, refObjectClass(x), selfEnv, value) :
>    "b" is not a field in class "Foo"
>
> What am I doing wrong?
>
> Thanks,
> Michael
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From mtmorgan at fhcrc.org  Mon Aug  6 01:31:47 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 05 Aug 2012 16:31:47 -0700
Subject: [Rd] setMethod sometimes fails to set package slot when signature
 has trailing 'ANY'
Message-ID: <501F0263.8050700@fhcrc.org>

after this

   setClass("A")

   setGeneric("bar", function(x, y) standardGeneric("bar"))
   setMethod(bar, signature(x="A", y="A"), function(x, y) {})
   setMethod(bar, signature(x="A", y="ANY"), function(x, y) {})

the method for signature c("A", "A") contains package information

 > str(getMethod(bar, c("A", "A")))
Formal class 'MethodDefinition' [package "methods"] with 4 slots
   ..@ .Data  :function (x, y)
   ..@ target :Formal class 'signature' [package "methods"] with 3 slots
   .. .. ..@ .Data  : chr [1:2] "A" "A"
   .. .. ..@ names  : chr [1:2] "x" "y"
   .. .. ..@ package: chr [1:2] ".GlobalEnv" ".GlobalEnv"
   ..@ defined:Formal class 'signature' [package "methods"] with 3 slots
   .. .. ..@ .Data  : chr [1:2] "A" "A"
   .. .. ..@ names  : chr [1:2] "x" "y"
   .. .. ..@ package: chr [1:2] ".GlobalEnv" ".GlobalEnv"
   ..@ generic: atomic [1:1] bar
   .. ..- attr(*, "package")= chr ".GlobalEnv"

but the method for signature c("A", "ANY") does not

 > str(getMethod(bar, c("A", "ANY")))
Formal class 'MethodDefinition' [package "methods"] with 4 slots
   ..@ .Data  :function (x, y)
   ..@ target :Formal class 'signature' [package "methods"] with 3 slots
   .. .. ..@ .Data  : chr [1:2] "A" "ANY"
   .. .. ..@ names  : chr [1:2] "x" "y"
   .. .. ..@ package: chr [1:2] "" ""
   ..@ defined:Formal class 'signature' [package "methods"] with 3 slots
   .. .. ..@ .Data  : chr [1:2] "A" "ANY"
   .. .. ..@ names  : chr [1:2] "x" "y"
   .. .. ..@ package: chr [1:2] "" ""
   ..@ generic: atomic [1:1] bar
   .. ..- attr(*, "package")= chr ".GlobalEnv"

This does not occur when the order of setMethod calls is reversed. The 
reason is that the package information added when 
methods/R/Methods.R:552 calls matchSignature are stripped (because 
matchSignature returns a vector with trailing 'ANY' classes removed) by 
the call to .matchSigLength at line 603.

The context for this is the thread starting at

https://stat.ethz.ch/pipermail/bioconductor/2012-August/047241.html

where a complicated package dependency and attempt to redefine an 
existing method leads to

Error : package slot missing from signature for generic 'sampleNames<-'
and classes LumiBatch, ANY
cannot use with duplicate class names (the package may need to be 
re-installed)

Martin
-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From ruipbarradas at sapo.pt  Mon Aug  6 12:09:53 2012
From: ruipbarradas at sapo.pt (Rui Barradas)
Date: Mon, 06 Aug 2012 11:09:53 +0100
Subject: [Rd] Windows 7 and .libPaths()
Message-ID: <501F97F1.70401@sapo.pt>

Hello,

I'm having some trouble trying to set the .libPaths() on Windows 7, 
R-2.15.0 and R-2.15.1. The environment variables R_LIBS and R_LIBS_USER 
are set according to the help page for .libPaths() and the Rprofile.site 
file has the default setting, as shown below. R-2.14.1 recognizes the 
lib paths but not R-2.15. Is this a bug or am I doing something wrong?
(I've also tried with R-2.12.0 and R-2.13.0 and it works as documented 
but I only show here the output for R-2.14.1, R-2.15.0 and R-2.15.1)

First, the Windows settings.

Microsoft Windows [Vers?o 6.1.7601]
Copyright (c) 2009 Microsoft Corporation. Todos os direitos reservados.

C:\Users\Rui>echo %R_LIBS%
C:/PROGRA~1/R/win-library;

C:\Users\Rui>echo %R_LIBS_USER%
C:/PROGRA~1/R/win-library;C:/PROGRA~1/R/win-library/%v;

Then, file Rprofile.site .

# set libPath to win-library
.libPaths(new="C:PROGRA~1/R/win-library")
.libPaths(new=paste("C:PROGRA~1/R/win-library", 
paste(R.version$major,as.integer(R.version$minor),sep='.'), sep="/"))

Finally, three R sessions.

#--------- R-2.14.1

 > .libPaths()
[1] "C:/Program Files/R/win-library"      "C:/Program 
Files/R/win-library/2.14"
[3] "C:/Program Files/R/R-2.14.1/library"
 >
 > sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=Portuguese_Portugal.1252 LC_CTYPE=Portuguese_Portugal.1252
[3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C
[5] LC_TIME=Portuguese_Portugal.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

#--------- R-2.15.0

 > .libPaths()
[1] "C:/Program Files/R/R-2.15.0/library"
 >
 > sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=Portuguese_Portugal.1252 LC_CTYPE=Portuguese_Portugal.1252
[3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C
[5] LC_TIME=Portuguese_Portugal.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

#--------- R-2.15.1

 > .libPaths()
[1] "C:/Program Files/R/R-2.15.1/library"
 >
 > sessionInfo()
R version 2.15.1 (2012-06-22)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=Portuguese_Portugal.1252 LC_CTYPE=Portuguese_Portugal.1252
[3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C
[5] LC_TIME=Portuguese_Portugal.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods base

loaded via a namespace (and not attached):
[1] fortunes_1.5-0


Rui Barradas


From murdoch.duncan at gmail.com  Mon Aug  6 14:12:55 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 06 Aug 2012 08:12:55 -0400
Subject: [Rd] Windows 7 and .libPaths()
In-Reply-To: <501F97F1.70401@sapo.pt>
References: <501F97F1.70401@sapo.pt>
Message-ID: <501FB4C7.5060900@gmail.com>

On 12-08-06 6:09 AM, Rui Barradas wrote:
> Hello,
>
> I'm having some trouble trying to set the .libPaths() on Windows 7,
> R-2.15.0 and R-2.15.1. The environment variables R_LIBS and R_LIBS_USER
> are set according to the help page for .libPaths() and the Rprofile.site
> file has the default setting, as shown below. R-2.14.1 recognizes the
> lib paths but not R-2.15. Is this a bug or am I doing something wrong?

There's at least one typo below, but besides that, it's hard to tell. 
Do the directories you're trying to set exist?  More inline.

> (I've also tried with R-2.12.0 and R-2.13.0 and it works as documented
> but I only show here the output for R-2.14.1, R-2.15.0 and R-2.15.1)
>
> First, the Windows settings.
>
> Microsoft Windows [Vers?o 6.1.7601]
> Copyright (c) 2009 Microsoft Corporation. Todos os direitos reservados.
>
> C:\Users\Rui>echo %R_LIBS%
> C:/PROGRA~1/R/win-library;

I don't think the terminal semicolon is needed, though it shouldn't 
cause a problem.

>
> C:\Users\Rui>echo %R_LIBS_USER%
> C:/PROGRA~1/R/win-library;C:/PROGRA~1/R/win-library/%v;

Does C:/PROGRA~1/R/win-library exist?  Does 
C:/PROGRA~1/R/win-library/2.5 exist?  Does 
normalizePath("C:/PROGRA~1/R/win-library", winslash="/") give a 
directory that exists?

>
> Then, file Rprofile.site .
>
> # set libPath to win-library
> .libPaths(new="C:PROGRA~1/R/win-library")
> .libPaths(new=paste("C:PROGRA~1/R/win-library",
> paste(R.version$major,as.integer(R.version$minor),sep='.'), sep="/"))

These lines have the typo:  it should be C:/PROGRA~1, not C:PROGRA~1.

>
> Finally, three R sessions.
>
> #--------- R-2.14.1
>
>   > .libPaths()
> [1] "C:/Program Files/R/win-library"      "C:/Program
> Files/R/win-library/2.14"
> [3] "C:/Program Files/R/R-2.14.1/library"
>   >
>   > sessionInfo()
> R version 2.14.1 (2011-12-22)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=Portuguese_Portugal.1252 LC_CTYPE=Portuguese_Portugal.1252
> [3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C
> [5] LC_TIME=Portuguese_Portugal.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> #--------- R-2.15.0
>
>   > .libPaths()
> [1] "C:/Program Files/R/R-2.15.0/library"
>   >
>   > sessionInfo()
> R version 2.15.0 (2012-03-30)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=Portuguese_Portugal.1252 LC_CTYPE=Portuguese_Portugal.1252
> [3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C
> [5] LC_TIME=Portuguese_Portugal.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> #--------- R-2.15.1
>
>   > .libPaths()
> [1] "C:/Program Files/R/R-2.15.1/library"
>   >
>   > sessionInfo()
> R version 2.15.1 (2012-06-22)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=Portuguese_Portugal.1252 LC_CTYPE=Portuguese_Portugal.1252
> [3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C
> [5] LC_TIME=Portuguese_Portugal.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods base
>
> loaded via a namespace (and not attached):
> [1] fortunes_1.5-0
>
>
> Rui Barradas
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ruipbarradas at sapo.pt  Mon Aug  6 15:00:41 2012
From: ruipbarradas at sapo.pt (Rui Barradas)
Date: Mon, 06 Aug 2012 14:00:41 +0100
Subject: [Rd] Windows 7 and .libPaths()
In-Reply-To: <501FB4C7.5060900@gmail.com>
References: <501F97F1.70401@sapo.pt> <501FB4C7.5060900@gmail.com>
Message-ID: <501FBFF9.3070103@sapo.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120806/56c0e869/attachment.pl>

From lorenz at usgs.gov  Mon Aug  6 15:09:35 2012
From: lorenz at usgs.gov (David L Lorenz)
Date: Mon, 6 Aug 2012 08:09:35 -0500
Subject: [Rd] virus and malicious code
In-Reply-To: <501FB4C7.5060900@gmail.com>
References: <501F97F1.70401@sapo.pt> <501FB4C7.5060900@gmail.com>
Message-ID: <OFA8C58BA5.52EECD43-ON86257A52.0047FB11-86257A52.00484A5A@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120806/f4291dc1/attachment.pl>

From ligges at statistik.tu-dortmund.de  Mon Aug  6 15:39:06 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 06 Aug 2012 15:39:06 +0200
Subject: [Rd] virus and malicious code
In-Reply-To: <OFA8C58BA5.52EECD43-ON86257A52.0047FB11-86257A52.00484A5A@usgs.gov>
References: <501F97F1.70401@sapo.pt> <501FB4C7.5060900@gmail.com>
	<OFA8C58BA5.52EECD43-ON86257A52.0047FB11-86257A52.00484A5A@usgs.gov>
Message-ID: <501FC8FA.8000703@statistik.tu-dortmund.de>



On 06.08.2012 15:09, David L Lorenz wrote:
> Hi,
>    A question has come up within a user group about the possibility of
> viruses or other malicious code being embedded within any package served
> from CRAN. How much checking is done to guard against this?

Of course, CRAN cannot guarantee that packages are free of malicious 
code, otherwise manual inspection of the code of almost 4000 packages 
with dozens of updates and new submissions a day would be necessary.

CRAN does some checks on the precompiled binaries for viruses, but again 
cannot give guarantees. Please use the normal precautions with 
downloaded executables.


Best,
Uwe Ligges



> I do not
> expect any kind of response about picking up R code from any other source,
> like gitHub. Thanks.


> Dave
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mike.lwrnc at gmail.com  Tue Aug  7 00:01:17 2012
From: mike.lwrnc at gmail.com (Mike Lawrence)
Date: Mon, 6 Aug 2012 19:01:17 -0300
Subject: [Rd] Straight-quotes for usage and examples sections in PDF docs?
Message-ID: <CAB+QPJB=otd+Pa=c9g42RDHrtGHGXzjPHoud+CZ-sXmo4-Oz0A@mail.gmail.com>

Is there any way to ensure that quotation marks are left as straight
quotes and not converted to curly quotes in the \usage and \examples
sections when the pdf versions of the docs are created?


From rshane at basexvi.com  Mon Aug  6 15:30:33 2012
From: rshane at basexvi.com ([R]andall)
Date: Mon, 6 Aug 2012 06:30:33 -0700 (PDT)
Subject: [Rd] Defining Version in R Package
Message-ID: <1344259833393-4639281.post@n4.nabble.com>

Hello Liste[R]s,

I defined a version in a recent package using the following entries:

DESCRIPTION FILE:
/Depends: R(>= 2.14.2), rjson, RgoogleMaps/

*.rd FILE: (which I was under the impression is the package version, not the
R requirement)
/\details{
\tabular{ll}{
Package: \tab geoPlot\cr
Type: \tab Package\cr
Version: \tab 2.0\cr
Date: \tab 2012-07-24\cr
License: \tab GPL-2\cr
}/

When I try to install the package, I get the following error:
/Warning message:
package ?geoPlot? is not available (for R version 2.15.1) /

Obviously, I have missed something?  Can someone point me in the right
direction?

Thanks.



--
View this message in context: http://r.789695.n4.nabble.com/Defining-Version-in-R-Package-tp4639281.html
Sent from the R devel mailing list archive at Nabble.com.


From gunter.berton at gene.com  Mon Aug  6 16:31:43 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Mon, 6 Aug 2012 07:31:43 -0700
Subject: [Rd] virus and malicious code
In-Reply-To: <501FC8FA.8000703@statistik.tu-dortmund.de>
References: <501F97F1.70401@sapo.pt> <501FB4C7.5060900@gmail.com>
	<OFA8C58BA5.52EECD43-ON86257A52.0047FB11-86257A52.00484A5A@usgs.gov>
	<501FC8FA.8000703@statistik.tu-dortmund.de>
Message-ID: <CACk-te0EYkFouaQim0Vbp-F_+vAKVN5WtZshwbfOin67zR0jWQ@mail.gmail.com>

... and note additionally, as per section 1.5.3, "Windows External
Software" of the "Writing R Extensions" manual:

"Note that CRAN does not accept submissions of precompiled binaries
due to security
concerns,and does not allow binary executables in source packages."

-- Cheers,
Bert

On Mon, Aug 6, 2012 at 6:39 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> On 06.08.2012 15:09, David L Lorenz wrote:
>>
>> Hi,
>>    A question has come up within a user group about the possibility of
>> viruses or other malicious code being embedded within any package served
>> from CRAN. How much checking is done to guard against this?
>
>
> Of course, CRAN cannot guarantee that packages are free of malicious code,
> otherwise manual inspection of the code of almost 4000 packages with dozens
> of updates and new submissions a day would be necessary.
>
> CRAN does some checks on the precompiled binaries for viruses, but again
> cannot give guarantees. Please use the normal precautions with downloaded
> executables.
>
>
> Best,
> Uwe Ligges
>
>
>
>> I do not
>> expect any kind of response about picking up R code from any other source,
>> like gitHub. Thanks.
>
>
>
>> Dave
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 

Bert Gunter
Genentech Nonclinical Biostatistics

Internal Contact Info:
Phone: 467-7374
Website:
http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm


From dtenenba at fhcrc.org  Tue Aug  7 02:17:29 2012
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Mon, 6 Aug 2012 17:17:29 -0700
Subject: [Rd] Straight-quotes for usage and examples sections in PDF
	docs?
In-Reply-To: <CAB+QPJB=otd+Pa=c9g42RDHrtGHGXzjPHoud+CZ-sXmo4-Oz0A@mail.gmail.com>
References: <CAB+QPJB=otd+Pa=c9g42RDHrtGHGXzjPHoud+CZ-sXmo4-Oz0A@mail.gmail.com>
Message-ID: <CAF42j22kGOemO0wKz0ug7La=_6sjhNr=f8jn9JfsFCxyBymTWQ@mail.gmail.com>

On Mon, Aug 6, 2012 at 3:01 PM, Mike Lawrence <mike.lwrnc at gmail.com> wrote:
> Is there any way to ensure that quotation marks are left as straight
> quotes and not converted to curly quotes in the \usage and \examples
> sections when the pdf versions of the docs are created?
>

Perhaps if the R session that builds the package has this option set:
options('useFancyQuotes' = FALSE)

I'm not sure what the context is, so I don't know if you'll be able to
control this in every case.

Dan


> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Tue Aug  7 11:09:03 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 07 Aug 2012 11:09:03 +0200
Subject: [Rd] Defining Version in R Package
In-Reply-To: <1344259833393-4639281.post@n4.nabble.com>
References: <1344259833393-4639281.post@n4.nabble.com>
Message-ID: <5020DB2F.8080001@statistik.tu-dortmund.de>



On 06.08.2012 15:30, [R]andall wrote:
> Hello Liste[R]s,
>
> I defined a version in a recent package using the following entries:
>
> DESCRIPTION FILE:
> /Depends: R(>= 2.14.2), rjson, RgoogleMaps/
>
> *.rd FILE: (which I was under the impression is the package version, not the
> R requirement)
> /\details{
> \tabular{ll}{
> Package: \tab geoPlot\cr
> Type: \tab Package\cr
> Version: \tab 2.0\cr
> Date: \tab 2012-07-24\cr
> License: \tab GPL-2\cr
> }/
>
> When I try to install the package, I get the following error:
> /Warning message:
> package ?geoPlot? is not available (for R version 2.15.1) /
>
> Obviously, I have missed something?  Can someone point me in the right
> direction?


Nothing for R-devel, actually. This is more an R-help question.
You provide insufficient information, but let me guess you are running 
Windows: The Windows binary package for the R-2.15.x versions of R is 
not yet available on CRAN. You can expect it to appear on the master 
within 72 hours.

Best,
Uwe Ligges








> Thanks.
>
>
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Defining-Version-in-R-Package-tp4639281.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mtmorgan at fhcrc.org  Wed Aug  8 01:00:10 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 07 Aug 2012 16:00:10 -0700
Subject: [Rd] setMethod sometimes fails to set package slot when
 signature has trailing 'ANY'
In-Reply-To: <50218C0F.5050101@stat.stanford.edu>
References: <501F0263.8050700@fhcrc.org> <50218C0F.5050101@stat.stanford.edu>
Message-ID: <50219DFA.2060103@fhcrc.org>

On 08/07/2012 02:43 PM, John Chambers wrote:
> Good catch.  This should have been fixed in r-devel, revision 60192.  If
> nothing bad results in other tests, we'll port it to the current patched
> version.

Thank you for the fix. Martin

>
> Thanks,
>    John
>
> On 8/5/12 4:31 PM, Martin Morgan wrote:
>> after this
>>
>>   setClass("A")
>>
>>   setGeneric("bar", function(x, y) standardGeneric("bar"))
>>   setMethod(bar, signature(x="A", y="A"), function(x, y) {})
>>   setMethod(bar, signature(x="A", y="ANY"), function(x, y) {})
>>
>> the method for signature c("A", "A") contains package information
>>
>> > str(getMethod(bar, c("A", "A")))
>> Formal class 'MethodDefinition' [package "methods"] with 4 slots
>>   ..@ .Data  :function (x, y)
>>   ..@ target :Formal class 'signature' [package "methods"] with 3 slots
>>   .. .. ..@ .Data  : chr [1:2] "A" "A"
>>   .. .. ..@ names  : chr [1:2] "x" "y"
>>   .. .. ..@ package: chr [1:2] ".GlobalEnv" ".GlobalEnv"
>>   ..@ defined:Formal class 'signature' [package "methods"] with 3 slots
>>   .. .. ..@ .Data  : chr [1:2] "A" "A"
>>   .. .. ..@ names  : chr [1:2] "x" "y"
>>   .. .. ..@ package: chr [1:2] ".GlobalEnv" ".GlobalEnv"
>>   ..@ generic: atomic [1:1] bar
>>   .. ..- attr(*, "package")= chr ".GlobalEnv"
>>
>> but the method for signature c("A", "ANY") does not
>>
>> > str(getMethod(bar, c("A", "ANY")))
>> Formal class 'MethodDefinition' [package "methods"] with 4 slots
>>   ..@ .Data  :function (x, y)
>>   ..@ target :Formal class 'signature' [package "methods"] with 3 slots
>>   .. .. ..@ .Data  : chr [1:2] "A" "ANY"
>>   .. .. ..@ names  : chr [1:2] "x" "y"
>>   .. .. ..@ package: chr [1:2] "" ""
>>   ..@ defined:Formal class 'signature' [package "methods"] with 3 slots
>>   .. .. ..@ .Data  : chr [1:2] "A" "ANY"
>>   .. .. ..@ names  : chr [1:2] "x" "y"
>>   .. .. ..@ package: chr [1:2] "" ""
>>   ..@ generic: atomic [1:1] bar
>>   .. ..- attr(*, "package")= chr ".GlobalEnv"
>>
>> This does not occur when the order of setMethod calls is reversed. The
>> reason is that the package information added when
>> methods/R/Methods.R:552 calls matchSignature are stripped (because
>> matchSignature returns a vector with trailing 'ANY' classes removed)
>> by the call to .matchSigLength at line 603.
>>
>> The context for this is the thread starting at
>>
>> https://stat.ethz.ch/pipermail/bioconductor/2012-August/047241.html
>>
>> where a complicated package dependency and attempt to redefine an
>> existing method leads to
>>
>> Error : package slot missing from signature for generic 'sampleNames<-'
>> and classes LumiBatch, ANY
>> cannot use with duplicate class names (the package may need to be
>> re-installed)
>>
>> Martin
>


-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From jmc at r-project.org  Wed Aug  8 10:51:47 2012
From: jmc at r-project.org (John Chambers)
Date: Wed, 08 Aug 2012 01:51:47 -0700
Subject: [Rd] setMethod sometimes fails to set package slot when
 signature has trailing 'ANY'
In-Reply-To: <501F0263.8050700@fhcrc.org>
References: <501F0263.8050700@fhcrc.org>
Message-ID: <502228A3.20303@r-project.org>

Good catch.  This should have been fixed in r-devel, revision 60192.  If 
nothing bad results in other tests, we'll port it to the current patched 
version.

Thanks,
   John

On 8/5/12 4:31 PM, Martin Morgan wrote:
> after this
>
>   setClass("A")
>
>   setGeneric("bar", function(x, y) standardGeneric("bar"))
>   setMethod(bar, signature(x="A", y="A"), function(x, y) {})
>   setMethod(bar, signature(x="A", y="ANY"), function(x, y) {})
>
> the method for signature c("A", "A") contains package information
>
> > str(getMethod(bar, c("A", "A")))
> Formal class 'MethodDefinition' [package "methods"] with 4 slots
>   ..@ .Data  :function (x, y)
>   ..@ target :Formal class 'signature' [package "methods"] with 3 slots
>   .. .. ..@ .Data  : chr [1:2] "A" "A"
>   .. .. ..@ names  : chr [1:2] "x" "y"
>   .. .. ..@ package: chr [1:2] ".GlobalEnv" ".GlobalEnv"
>   ..@ defined:Formal class 'signature' [package "methods"] with 3 slots
>   .. .. ..@ .Data  : chr [1:2] "A" "A"
>   .. .. ..@ names  : chr [1:2] "x" "y"
>   .. .. ..@ package: chr [1:2] ".GlobalEnv" ".GlobalEnv"
>   ..@ generic: atomic [1:1] bar
>   .. ..- attr(*, "package")= chr ".GlobalEnv"
>
> but the method for signature c("A", "ANY") does not
>
> > str(getMethod(bar, c("A", "ANY")))
> Formal class 'MethodDefinition' [package "methods"] with 4 slots
>   ..@ .Data  :function (x, y)
>   ..@ target :Formal class 'signature' [package "methods"] with 3 slots
>   .. .. ..@ .Data  : chr [1:2] "A" "ANY"
>   .. .. ..@ names  : chr [1:2] "x" "y"
>   .. .. ..@ package: chr [1:2] "" ""
>   ..@ defined:Formal class 'signature' [package "methods"] with 3 slots
>   .. .. ..@ .Data  : chr [1:2] "A" "ANY"
>   .. .. ..@ names  : chr [1:2] "x" "y"
>   .. .. ..@ package: chr [1:2] "" ""
>   ..@ generic: atomic [1:1] bar
>   .. ..- attr(*, "package")= chr ".GlobalEnv"
>
> This does not occur when the order of setMethod calls is reversed. The
> reason is that the package information added when
> methods/R/Methods.R:552 calls matchSignature are stripped (because
> matchSignature returns a vector with trailing 'ANY' classes removed)
> by the call to .matchSigLength at line 603.
>
> The context for this is the thread starting at
>
> https://stat.ethz.ch/pipermail/bioconductor/2012-August/047241.html
>
> where a complicated package dependency and attempt to redefine an
> existing method leads to
>
> Error : package slot missing from signature for generic 'sampleNames<-'
> and classes LumiBatch, ANY
> cannot use with duplicate class names (the package may need to be
> re-installed)
>
> Martin


From ripley at stats.ox.ac.uk  Wed Aug  8 13:13:15 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 08 Aug 2012 12:13:15 +0100
Subject: [Rd] Straight-quotes for usage and examples sections in PDF
	docs?
In-Reply-To: <CAB+QPJB=otd+Pa=c9g42RDHrtGHGXzjPHoud+CZ-sXmo4-Oz0A@mail.gmail.com>
References: <CAB+QPJB=otd+Pa=c9g42RDHrtGHGXzjPHoud+CZ-sXmo4-Oz0A@mail.gmail.com>
Message-ID: <502249CB.7030904@stats.ox.ac.uk>

On 06/08/12 23:01, Mike Lawrence wrote:
> Is there any way to ensure that quotation marks are left as straight
> quotes and not converted to curly quotes in the \usage and \examples
> sections when the pdf versions of the docs are created?

They are not converted ... so there cannot be a way.

In standard terminology 'quotation marks' are ASCII/Unicode " , and that 
is what is in the PDF files (in so far as we can guess what you mean 
without an explicit example).  I have no idea what 'straight quotes' and 
'curly quotes' are in your lexicon, but how even ASCII characters are 
rendered depends on the fonts used.

The R pdf manuals by default use inconsolata, where quotation marks are 
somewhat italic.   We knew that when selecting inconsolata, but it was 
the best compromise of the feasible choices.  Chose something else it 
you prefer a different compromise.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From baptiste.auguie at gmail.com  Wed Aug  8 23:02:30 2012
From: baptiste.auguie at gmail.com (baptiste auguie)
Date: Wed, 8 Aug 2012 14:02:30 -0700
Subject: [Rd] Straight-quotes for usage and examples sections in PDF
	docs?
In-Reply-To: <502249CB.7030904@stats.ox.ac.uk>
References: <CAB+QPJB=otd+Pa=c9g42RDHrtGHGXzjPHoud+CZ-sXmo4-Oz0A@mail.gmail.com>
	<502249CB.7030904@stats.ox.ac.uk>
Message-ID: <CANLFJPpCPZdO3Qyvx=ZpV2nwCy68W7ubm0FLVKourvtkrmqA+w@mail.gmail.com>

There's a trivial variation named Inconsolata-dz,
http://nodnod.net/2009/feb/12/adding-straight-single-and-double-quotes-inconsola/
which I've used happily with XeTeX; maybe R can use it in place of the
original if you rename it Inconsolata, but that would presumably be
against the font licence.

baptiste

On 8 August 2012 04:13, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> On 06/08/12 23:01, Mike Lawrence wrote:
>>
>> Is there any way to ensure that quotation marks are left as straight
>> quotes and not converted to curly quotes in the \usage and \examples
>> sections when the pdf versions of the docs are created?
>
>
> They are not converted ... so there cannot be a way.
>
> In standard terminology 'quotation marks' are ASCII/Unicode " , and that is
> what is in the PDF files (in so far as we can guess what you mean without an
> explicit example).  I have no idea what 'straight quotes' and 'curly quotes'
> are in your lexicon, but how even ASCII characters are rendered depends on
> the fonts used.
>
> The R pdf manuals by default use inconsolata, where quotation marks are
> somewhat italic.   We knew that when selecting inconsolata, but it was the
> best compromise of the feasible choices.  Chose something else it you prefer
> a different compromise.
>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From warrencp at umich.edu  Wed Aug  8 22:59:29 2012
From: warrencp at umich.edu (Chris Warren)
Date: Wed, 8 Aug 2012 20:59:29 +0000
Subject: [Rd] Inserting and testing revised functions in a package
References: <4C409988.2070208@r-project.org>
Message-ID: <loom.20120808T223723-762@post.gmane.org>

Thanks, that was helpful in finding a bug in a library I was using, but now I'd
like to run the original code (the revised code is unable to access some of the
functions in the package, apparently, but I think I can work around it by
running and checking the original function). 

How can I recover the original function?  I tried using  
insertSource("SourceFileWithOriginalFunctionCode.R", package = "Package",
functions = "functionOfInterest")

but I run into the same inability to access some the package functions used by
the function.

I also tried reloading but got 

"The following object(s) are masked _by_ ?.GlobalEnv?:

    probtrans"



Thanks for your help,
Chris


From aeber at allstate.com  Thu Aug  9 01:55:37 2012
From: aeber at allstate.com (Eberle, Anthony)
Date: Wed, 8 Aug 2012 18:55:37 -0500
Subject: [Rd] Performance issues with R2.15.1 built from source on Solaris?
Message-ID: <EA3EDB50F845354B8279DA646268AC6F014463C6@a0775-xpo0006-s.ad.allstate.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120808/dabc53fa/attachment.pl>

From murdoch.duncan at gmail.com  Thu Aug  9 14:08:03 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 9 Aug 2012 08:08:03 -0400
Subject: [Rd] Inserting and testing revised functions in a package
In-Reply-To: <loom.20120808T223723-762@post.gmane.org>
References: <4C409988.2070208@r-project.org>
	<loom.20120808T223723-762@post.gmane.org>
Message-ID: <5023A823.8080606@gmail.com>

On 12-08-08 4:59 PM, Chris Warren wrote:
> Thanks, that was helpful in finding a bug in a library I was using, but now I'd
> like to run the original code (the revised code is unable to access some of the
> functions in the package, apparently, but I think I can work around it by
> running and checking the original function).
>
> How can I recover the original function?  I tried using
> insertSource("SourceFileWithOriginalFunctionCode.R", package = "Package",
> functions = "functionOfInterest")
>
> but I run into the same inability to access some the package functions used by
> the function.
>
> I also tried reloading but got
>
> "The following object(s) are masked _by_ ?.GlobalEnv?:
>
>      probtrans"
>
>
>

When you reply to a message that is more than 2 years old, it's helpful 
to give some context.

Generally the reason a function can't see things in a package is because 
its environment is wrong.  Since all functions in a package normally use 
the same environment, a simple fix is to put

environment(newfoo) <- environment(oldbar)

to copy the assignment of an unchanged function oldbar from the package 
to the new function you are trying to work with.

But the general way to "recover the original function" is just to 
restart R and attach the package.

Duncan Murdoch


From radford at cs.toronto.edu  Fri Aug 10 16:48:49 2012
From: radford at cs.toronto.edu (Radford Neal)
Date: Fri, 10 Aug 2012 10:48:49 -0400
Subject: [Rd] Performance issues with R2.15.1 built from source on Solaris
In-Reply-To: <mailman.15.1344592805.9704.r-devel@r-project.org>
References: <mailman.15.1344592805.9704.r-devel@r-project.org>
Message-ID: <20120810144849.GB4641@cs.toronto.edu>

Is this a SPARC system?  On at least some SPARC systems, the "long double" 
type in C is implemented very slowly in software, and it seems that it is 
used for the sums done when calculating standard deviations with "sd".

   Radford Neal


> Date: Wed, 8 Aug 2012 18:55:37 -0500
> From: "Eberle, Anthony" <aeber at allstate.com>
> To: <r-devel at r-project.org>
> Subject: [Rd] Performance issues with R2.15.1 built from source on
> 	Solaris?

> I have a question about building R (2.15.1) from source on a Solaris 10
> 64bit virtual server with 2 cores and 16GB memory that is running on an
> Oracle T4 server.  Based on several tests I have done this configuration
> has been several orders of magnitude slower than any other configuration
> I've tested.  
> 
> A simple test of some code to calculate the standard deviation 10000
> times (simple code to consume resources) takes on average 121.498
> seconds on the Solaris server where the next worst system (Redhat Linux)
> takes 1.567 seconds:


From aeber at allstate.com  Fri Aug 10 18:50:04 2012
From: aeber at allstate.com (Eberle, Anthony)
Date: Fri, 10 Aug 2012 11:50:04 -0500
Subject: [Rd] Performance issues with R2.15.1 built from source on
	Solaris
In-Reply-To: <20120810144849.GB4641@cs.toronto.edu>
References: <mailman.15.1344592805.9704.r-devel@r-project.org>
	<20120810144849.GB4641@cs.toronto.edu>
Message-ID: <EA3EDB50F845354B8279DA646268AC6F014465F5@a0775-xpo0006-s.ad.allstate.com>

Yes, the T4 physical host that the zone is configured on is SPARC.  Are
you saying that this is a function of the hardware or would possibly
updating to a newer version of gcc help?  I'm actually going to see if I
can build a newer version of gcc anyway just to eliminate that variable.

I picked the "sd" and "R-Benchmark" tests as I am new to R and
functioning more as an administrator than a modeler or statistical
engineer.  I too have seen that some operations do perform better on
certain systems than others.  This makes sense as I know different
hardware and CPU's are better at some things than others.  However I'm
not familiar enough with R yet to know what the functions are doing
under the hood and which would be more performing on what hardware.

However I will try to check into the specs for the T4 and see if
anything is mentioned about the "long double" or something along these
lines.  Thanks.

Anthony

-----Original Message-----
From: r-devel-bounces at r-project.org
[mailto:r-devel-bounces at r-project.org] On Behalf Of Radford Neal
Sent: Friday, August 10, 2012 9:49 AM
To: r-devel at r-project.org
Subject: [Rd] Performance issues with R2.15.1 built from source on
Solaris

Is this a SPARC system?  On at least some SPARC systems, the "long
double" 
type in C is implemented very slowly in software, and it seems that it
is used for the sums done when calculating standard deviations with
"sd".

   Radford Neal


> Date: Wed, 8 Aug 2012 18:55:37 -0500
> From: "Eberle, Anthony" <aeber at allstate.com>
> To: <r-devel at r-project.org>
> Subject: [Rd] Performance issues with R2.15.1 built from source on
> 	Solaris?

> I have a question about building R (2.15.1) from source on a Solaris 
> 10 64bit virtual server with 2 cores and 16GB memory that is running 
> on an Oracle T4 server.  Based on several tests I have done this 
> configuration has been several orders of magnitude slower than any 
> other configuration I've tested.
> 
> A simple test of some code to calculate the standard deviation 10000 
> times (simple code to consume resources) takes on average 121.498 
> seconds on the Solaris server where the next worst system (Redhat 
> Linux) takes 1.567 seconds:

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From mtmorgan at fhcrc.org  Fri Aug 10 22:08:03 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 10 Aug 2012 13:08:03 -0700
Subject: [Rd] [R] debug vs regular mode
In-Reply-To: <8D7C3107-1C92-4F2B-8BCB-7C505095F3A0@gmail.com>
References: <50244E49.5000908@med.umich.edu>
	<81A9521D-15DA-4F07-A68E-21A1AF643053@comcast.net>
	<2145D1BE-BC07-4CF1-B23E-C27F7264E732@gmail.com>
	<502489CF.5060402@med.umich.edu> <50250BE4.7000704@gmail.com>
	<50250FE0.3050506@med.umich.edu> <50252D1F.3060003@gmail.com>
	<50254A16.8010009@med.umich.edu>
	<8D7C3107-1C92-4F2B-8BCB-7C505095F3A0@gmail.com>
Message-ID: <50256A23.6070904@fhcrc.org>

On 08/10/2012 12:04 PM, peter dalgaard wrote:
> Not to spoil your fun, but this is getting a bit off-topic for R-help. If you wish to continue the debugging process in public, I think you should move to R-devel.
>
> Also, it sounds like the problem is in the glmulti package, so you might want to involve its maintainer at some point.



actually valgrind complains a lot about rJava, though that can be 
confusing; the example reproduces, so amenable to investigation. glmulti 
doesn't have C code and the only unusual dependency is rJava

 > sessionInfo()
R version 2.15.1 Patched (2012-06-22 r59603)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
[1] en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] glmulti_1.0.4 rJava_0.9-3


Here's the stack trace starting a little below the top

#21190 0x00007ffff78b3b88 in Rf_usemethod (generic=0x9f0c80 "terms", 
obj=0xbcd040, call=0xbf6fb0, args=0x604d18, rho=0xbd9e70, 
callrho=0xbf88e8, defrho=0x1a873f0,
     ans=0x7fffffffb1a8) at 
/home/mtmorgan/src/R-2-15-branch/src/main/objects.c:339
339		    *ans = applyMethod(t, sxp, matchedarg, rho, newrho);
(gdb)
#21189 0x00007ffff78b3009 in applyMethod (call=0xbca188, op=0xbf67f0, 
args=0xbdad30, rho=0xbd9e70, newrho=0xbca118) at 
/home/mtmorgan/src/R-2-15-branch/src/main/objects.c:125
125		ans = applyClosure(call, op, args, rho, newrho);
(gdb)
#21188 0x00007ffff784c574 in Rf_applyClosure (call=0xbca188, 
op=0xbf67f0, arglist=0xbdad30, rho=0xbd9e70, suppliedenv=0xbca118)
     at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:859
859		PROTECT(tmp = eval(body, newrho));
(gdb)
#21187 0x00007ffff784b4b5 in Rf_eval (e=0xbf52e0, rho=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
(gdb)
#21186 0x00007ffff784e12d in do_begin (call=0xbf52e0, op=0x610710, 
args=0xbee388, rho=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1413
1413		    s = eval(CAR(args), rho);
(gdb)
#21185 0x00007ffff784b4b5 in Rf_eval (e=0xbee3c0, rho=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
(gdb)
#21184 0x00007ffff784ef32 in do_set (call=0xbee3c0, op=0x610908, 
args=0xbedbc8, rho=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1715
1715		    s = eval(CADR(args), rho);
(gdb)
#21183 0x00007ffff784b4b5 in Rf_eval (e=0xbedc70, rho=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
(gdb)
#21182 0x00007ffff78b2979 in do_internal (call=0xbedc70, op=0x611620, 
args=0xbc9518, env=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/names.c:1228
1228	    ans = PRIMFUN(INTERNAL(fun)) (s, INTERNAL(fun), args, env);
(gdb)
#21181 0x00007ffff78acdea in do_termsform (call=0xbedf48, op=0x6329f0, 
args=0xbc9518, rho=0xbc8f30) at 
/home/mtmorgan/src/R-2-15-branch/src/main/model.c:838
838	    PROTECT(formula = EncodeVars(CAR(args)));
(gdb)
#21180 0x00007ffff78ac4e6 in EncodeVars (formula=0xbcd040) at 
/home/mtmorgan/src/R-2-15-branch/src/main/model.c:629
629			return EncodeVars(CADDR(formula));
(gdb)
#21179 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd2a8) at 
/home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
641		    return CrossTerms(CADR(formula), CADDR(formula));
(gdb)
#21178 0x00007ffff78abafb in CrossTerms (left=0xbcd318, right=0xd7e338) 
at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:459
459	    PROTECT(left = EncodeVars(left));
(gdb)
#21177 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd318) at 
/home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
641		    return CrossTerms(CADR(formula), CADDR(formula));
(gdb)
#21176 0x00007ffff78abc24 in CrossTerms (left=0xbc5558, right=0x16b6e78) 
at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:471
471	    return TrimRepeats(left);
(gdb)
#21175 0x00007ffff78ab934 in TrimRepeats (list=0xbc5558) at 
/home/mtmorgan/src/R-2-15-branch/src/main/model.c:404
404	    SETCDR(list, TrimRepeats(StripTerm(CAR(list), CDR(list))));
(gdb)
#21174 0x00007ffff78ab88d in StripTerm (term=0x121c1d8, list=0xbc5590) 
at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:385
385	    tail = StripTerm(term, CDR(list));

and so on down to the bottom

valgrind says this

==14352== Invalid write of size 4
==14352==    at 0xD4BC2BD: ???
==14352==    by 0xD4AC437: ???
==14352==    by 0xBDE21AE: JavaCalls::call_helper(JavaValue*, 
methodHandle*, JavaCallArguments*, Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDE1A44: JavaCalls::call(JavaValue*, methodHandle, 
JavaCallArguments*, Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDA5A7E: 
instanceKlass::call_class_initializer_impl(instanceKlassHandle, Thread*) 
(in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDA5AF9: 
instanceKlass::call_class_initializer(Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDA5CF1: 
instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDA5FB2: 
instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xC0BDB8D: Threads::create_vm(JavaVMInitArgs*, bool*) 
(in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==    by 0xBE00509: JNI_CreateJavaVM (in 
/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
==14352==  Address 0x7feff31e0 is not stack'd, malloc'd or (recently) free'd


> -pd
>
> On Aug 10, 2012, at 19:51 , Zhang, Peng wrote:
>
>> Thanks! It is interesting that Windows has pointed the problem to Java.
>> So it is probable that how I did my debug led me to the wrong direction.
>>
>> Since I was unsure how to debug S4 class, I copied the source implement
>> R function from glmulti package into my testing program.
>>
>> The segmentation fault will appear when I step to "neotete =
>> terms(as.formula(paste("h~",paste(preds, collapse="*"))))". That is why
>> I have asked my initial question on the board.
>>
>> The more interesting thing is that if I don't run library(glmulti), but
>> just the following lines, I won't have problem when I stepped to that
>> terms function.
>>
>> I am totally lost. It is not clear to me how to debug S4 class.
>>
>> Best,
>> Peng
>>
>> ### beginning
>> library(glmulti)
>>
>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol = 50)))
>>
>> glmulti =
>> function(y, xr, data, exclude, name, intercept, marginality , bunch,
>> chunk, chunks,
>>          level, minsize, maxsize, minK, maxK,
>> method,crit,confsetsize,popsize,mutrate,
>>          sexrate,imm, plotty,  report, deltaM, deltaB, conseq,
>> fitfunction, resumefile, includeobjects, ...) {
>>      if (missing(data))
>>          tete = terms(y)
>>      else
>>          tete = terms(y, data=data)
>>      oo = attr(tete,"order")
>>      dep = as.character(attr(tete,"variables"))[2]
>>      int = attr(tete,"intercept")
>>      preds = as.character(attr(tete,"variables"))[-(1:2)]
>>      if (level==2 && max(oo)>1) {
>>          # get all possible interactions
>>          interac = attr(tete,"term.labels")[oo==2]
>>          neotete = terms(as.formula(paste("h~",paste(preds, collapse="*"))))
>>          neointerac= attr(neotete,"term.labels")[attr(neotete,"order")==2]
>>          # get exclusions
>>          for (i in interac)
>>              neointerac=neointerac[neointerac!=i]
>>          # same for main effects
>>          mama = attr(tete,"term.labels")[oo==1]
>>          exma = preds
>>          for (j in mama)
>>              exma = exma[exma!=j]
>>          exma = c(exma,neointerac)
>>      } else {
>>          preds = attr(tete,"term.labels")[oo==1]
>>          exma=c(1)
>>      }
>>      call = match.call()
>>      call[[match("y", names(call))]] = dep
>>      call[[length(names(call))+1]] = preds
>>      names(call)[length(names(call))] ="xr"
>>          call[[length(names(call))+1]] = exma
>>      names(call)[length(names(call))] ="exclude"
>>
>>      if (missing(data)) {
>>          call[[length(names(call))+1]] = environment(y)
>>          names(call)[length(names(call))] ="data"
>>      }
>>      eval(call)
>> }
>>
>> debug(glmulti)
>>
>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>> xr=NULL, data = testdata, level = 2)
>> ###end
>>
>> On 08/10/2012 11:47 AM, Henric (Nilsson) Winell wrote:
>>> On 2012-08-10 15:42, Zhang, Peng wrote:
>>>
>>>> You are right. I am running Arch Linux. However, I obtained a
>>>> segmentation directly, so didn't know where to find the bug??
>>>>
>>>>> library("glmulti")
>>>> Loading required package: rJava
>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>> = 50)))
>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>> data= testdata, level = 2)
>>>> Segmentation fault
>>>>
>>>> Is this information "Error in .jnew("glmulti/ModelGenerator", y,
>>>> jarray(xc), .jarray(xq),  : java.lang.ArrayIndexOutOfBoundsException:
>>>> 15" only in Windows, or did you see it under Fedora as well?
>>>
>>> Windows only.  Fedora just returned "Segmentation fault".
>>>
>>>
>>> //Henric
>>>
>>>
>>>
>>>>
>>>> Thank you!
>>>>
>>>> Peng
>>>>
>>>> BTW:
>>>>
>>>> $ uname -a
>>>> Linux Precision 3.4.7-1-ARCH #1 SMP PREEMPT Sun Jul 29 22:02:56 CEST
>>>> 2012 x86_64 GNU/Linux
>>>>
>>>>> sessionInfo()
>>>> R version 2.15.1 (2012-06-22)
>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>>
>>>> locale:
>>>>    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>    [7] LC_PAPER=C                 LC_NAME=C
>>>>    [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>
>>>>
>>>> On 08/10/2012 09:25 AM, Henric (Nilsson) Winell wrote:
>>>>> On 2012-08-10 06:10, Zhang, Peng wrote:
>>>>>
>>>>>> Thanks to both for your reply.
>>>>>>
>>>>>> library(glmulti)
>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>> = 50)))
>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>> data
>>>>>> = testdata, level = 2)
>>>>>>
>>>>>> This is reproducible to get a segmentation fault.
>>>>>
>>>>> There's some information missing here, notably the output from
>>>>> 'sessionInfo()', but I guess this is under GNU/Linux.  I can confirm a
>>>>> seg. fault under Fedora FC17 x86_64.
>>>>>
>>>>> Under Windows 7 64-bit, however, we get some further info:
>>>>>
>>>>>> library("glmulti")
>>>>> Loading required package: rJava
>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>> = 50)))
>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>> data
>>>>> + = testdata, level = 2)
>>>>> Initialization...
>>>>> Error in .jnew("glmulti/ModelGenerator", y, .jarray(xc),
>>>>> .jarray(xq),  :
>>>>>    java.lang.ArrayIndexOutOfBoundsException: 15
>>>>>>
>>>>>> sessionInfo()
>>>>> R version 2.15.1 Patched (2012-08-06 r60178)
>>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>>>
>>>>> locale:
>>>>> [1] LC_COLLATE=Swedish_Sweden.1252 LC_CTYPE=Swedish_Sweden.1252
>>>>> [3] LC_MONETARY=Swedish_Sweden.1252 LC_NUMERIC=C
>>>>> [5] LC_TIME=Swedish_Sweden.1252
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>
>>>>> other attached packages:
>>>>> [1] glmulti_1.0.4 rJava_0.9-3
>>>>>>
>>>>>
>>>>> So, this doesn't seem to be a bug in R and is thus likely to need the
>>>>> attention of the 'glmulti' package's maintainer.
>>>>>
>>>>>
>>>>> HTH,
>>>>> Henric
>>>>>
>>>>>
>>>>>
>>>>>> But I have troubles to
>>>>>> extract the exact information from this S4 class to make a simpler
>>>>>> example because of my limited knowledge on S4 class. The author of the
>>>>>> package is busy at the moment, and does not have time to look into it.
>>>>>>
>>>>>> Peng
>>>>>>
>>>>>> On 08/09/2012 10:25 PM, R. Michael Weylandt
>>>>>> <michael.weylandt at gmail.com>
>>>>>> wrote:
>>>>>>>
>>>>>>> On Aug 9, 2012, at 9:14 PM, David Winsemius <dwinsemius at comcast.net>
>>>>>>> wrote:
>>>>>>>
>>>>>>>> On Aug 9, 2012, at 4:56 PM, Zhang, Peng wrote:
>>>>>>>>
>>>>>>>>> Dear all,
>>>>>>>>>
>>>>>>>>> I had a R segmentation fault, and then invoked debug mode and ran
>>>>>>>>> step
>>>>>>>>> by step.
>>>>>>>>
>>>>>>>>> 2. Why does the same function behave differently under debug and
>>>>>>>>> regular
>>>>>>>>> mode?
>>>>>>>> I cannot help you there.
>>>>>>>>
>>>>>>> Though a reproducible segfault is certainly worth a bug report if
>>>>>>> you can do so, in debug or regular modes.
>>>>>>>
>>>>>>> You may wish to search stackoverflow for tips on how to make a great
>>>>>>> reproducible example in R.
>>>>>>>
>>>>>>> Michael
>>>>>> **********************************************************
>>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>>> not be used for urgent or sensitive issues
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>
>>>>>
>>>> **********************************************************
>>>> Electronic Mail is not secure, may not be read every day, and should
>>>> not be used for urgent or sensitive issues
>>>>
>>>>
>>>
>> **********************************************************
>> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues
>>
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From simon.urbanek at r-project.org  Fri Aug 10 23:16:39 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 10 Aug 2012 17:16:39 -0400
Subject: [Rd] [R] debug vs regular mode
In-Reply-To: <50256A23.6070904@fhcrc.org>
References: <50244E49.5000908@med.umich.edu>
	<81A9521D-15DA-4F07-A68E-21A1AF643053@comcast.net>
	<2145D1BE-BC07-4CF1-B23E-C27F7264E732@gmail.com>
	<502489CF.5060402@med.umich.edu> <50250BE4.7000704@gmail.com>
	<50250FE0.3050506@med.umich.edu> <50252D1F.3060003@gmail.com>
	<50254A16.8010009@med.umich.edu>
	<8D7C3107-1C92-4F2B-8BCB-7C505095F3A0@gmail.com>
	<50256A23.6070904@fhcrc.org>
Message-ID: <B74E89CC-D854-4851-8447-32FD411FFDBD@r-project.org>


On Aug 10, 2012, at 4:08 PM, Martin Morgan wrote:

> On 08/10/2012 12:04 PM, peter dalgaard wrote:
>> Not to spoil your fun, but this is getting a bit off-topic for R-help. If you wish to continue the debugging process in public, I think you should move to R-devel.
>> 
>> Also, it sounds like the problem is in the glmulti package, so you might want to involve its maintainer at some point.
> 
> 
> 
> actually valgrind complains a lot about rJava, though that can be confusing; the example reproduces, so amenable to investigation. glmulti doesn't have C code and the only unusual dependency is rJava
> 


Actually, this crashes is vanilla R (given low enough stack limit, e.g. ulimit -s 1024) - simply try

terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16"))

which is what the code below runs. The problem is that it causes a very deep recursion so depending on the stack it will fail (interestingly, it will segfault in the call to R_CheckStack which is paradoxical :)). I think the proper fix would be to use iteration in StripTerm instead of recursion ...

Cheers,
Simon

FWIW Java is in general not easily traceable through valgrind, unfortunately, because it uses a lot of dirty tricks like JIT and other things. There are some hints in the valgrind FAQ 3.4, though.


> > sessionInfo()
> R version 2.15.1 Patched (2012-06-22 r59603)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> locale:
> [1] en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] glmulti_1.0.4 rJava_0.9-3
> 
> 
> Here's the stack trace starting a little below the top
> 
> #21190 0x00007ffff78b3b88 in Rf_usemethod (generic=0x9f0c80 "terms", obj=0xbcd040, call=0xbf6fb0, args=0x604d18, rho=0xbd9e70, callrho=0xbf88e8, defrho=0x1a873f0,
>    ans=0x7fffffffb1a8) at /home/mtmorgan/src/R-2-15-branch/src/main/objects.c:339
> 339		    *ans = applyMethod(t, sxp, matchedarg, rho, newrho);
> (gdb)
> #21189 0x00007ffff78b3009 in applyMethod (call=0xbca188, op=0xbf67f0, args=0xbdad30, rho=0xbd9e70, newrho=0xbca118) at /home/mtmorgan/src/R-2-15-branch/src/main/objects.c:125
> 125		ans = applyClosure(call, op, args, rho, newrho);
> (gdb)
> #21188 0x00007ffff784c574 in Rf_applyClosure (call=0xbca188, op=0xbf67f0, arglist=0xbdad30, rho=0xbd9e70, suppliedenv=0xbca118)
>    at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:859
> 859		PROTECT(tmp = eval(body, newrho));
> (gdb)
> #21187 0x00007ffff784b4b5 in Rf_eval (e=0xbf52e0, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
> (gdb)
> #21186 0x00007ffff784e12d in do_begin (call=0xbf52e0, op=0x610710, args=0xbee388, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1413
> 1413		    s = eval(CAR(args), rho);
> (gdb)
> #21185 0x00007ffff784b4b5 in Rf_eval (e=0xbee3c0, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
> (gdb)
> #21184 0x00007ffff784ef32 in do_set (call=0xbee3c0, op=0x610908, args=0xbedbc8, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1715
> 1715		    s = eval(CADR(args), rho);
> (gdb)
> #21183 0x00007ffff784b4b5 in Rf_eval (e=0xbedc70, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
> (gdb)
> #21182 0x00007ffff78b2979 in do_internal (call=0xbedc70, op=0x611620, args=0xbc9518, env=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/names.c:1228
> 1228	    ans = PRIMFUN(INTERNAL(fun)) (s, INTERNAL(fun), args, env);
> (gdb)
> #21181 0x00007ffff78acdea in do_termsform (call=0xbedf48, op=0x6329f0, args=0xbc9518, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:838
> 838	    PROTECT(formula = EncodeVars(CAR(args)));
> (gdb)
> #21180 0x00007ffff78ac4e6 in EncodeVars (formula=0xbcd040) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:629
> 629			return EncodeVars(CADDR(formula));
> (gdb)
> #21179 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd2a8) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
> 641		    return CrossTerms(CADR(formula), CADDR(formula));
> (gdb)
> #21178 0x00007ffff78abafb in CrossTerms (left=0xbcd318, right=0xd7e338) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:459
> 459	    PROTECT(left = EncodeVars(left));
> (gdb)
> #21177 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd318) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
> 641		    return CrossTerms(CADR(formula), CADDR(formula));
> (gdb)
> #21176 0x00007ffff78abc24 in CrossTerms (left=0xbc5558, right=0x16b6e78) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:471
> 471	    return TrimRepeats(left);
> (gdb)
> #21175 0x00007ffff78ab934 in TrimRepeats (list=0xbc5558) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:404
> 404	    SETCDR(list, TrimRepeats(StripTerm(CAR(list), CDR(list))));
> (gdb)
> #21174 0x00007ffff78ab88d in StripTerm (term=0x121c1d8, list=0xbc5590) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:385
> 385	    tail = StripTerm(term, CDR(list));
> 
> and so on down to the bottom
> 
> valgrind says this
> 
> ==14352== Invalid write of size 4
> ==14352==    at 0xD4BC2BD: ???
> ==14352==    by 0xD4AC437: ???
> ==14352==    by 0xBDE21AE: JavaCalls::call_helper(JavaValue*, methodHandle*, JavaCallArguments*, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDE1A44: JavaCalls::call(JavaValue*, methodHandle, JavaCallArguments*, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDA5A7E: instanceKlass::call_class_initializer_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDA5AF9: instanceKlass::call_class_initializer(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDA5CF1: instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDA5FB2: instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xC0BDB8D: Threads::create_vm(JavaVMInitArgs*, bool*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==    by 0xBE00509: JNI_CreateJavaVM (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
> ==14352==  Address 0x7feff31e0 is not stack'd, malloc'd or (recently) free'd
> 
> 
>> -pd
>> 
>> On Aug 10, 2012, at 19:51 , Zhang, Peng wrote:
>> 
>>> Thanks! It is interesting that Windows has pointed the problem to Java.
>>> So it is probable that how I did my debug led me to the wrong direction.
>>> 
>>> Since I was unsure how to debug S4 class, I copied the source implement
>>> R function from glmulti package into my testing program.
>>> 
>>> The segmentation fault will appear when I step to "neotete =
>>> terms(as.formula(paste("h~",paste(preds, collapse="*"))))". That is why
>>> I have asked my initial question on the board.
>>> 
>>> The more interesting thing is that if I don't run library(glmulti), but
>>> just the following lines, I won't have problem when I stepped to that
>>> terms function.
>>> 
>>> I am totally lost. It is not clear to me how to debug S4 class.
>>> 
>>> Best,
>>> Peng
>>> 
>>> ### beginning
>>> library(glmulti)
>>> 
>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol = 50)))
>>> 
>>> glmulti =
>>> function(y, xr, data, exclude, name, intercept, marginality , bunch,
>>> chunk, chunks,
>>>         level, minsize, maxsize, minK, maxK,
>>> method,crit,confsetsize,popsize,mutrate,
>>>         sexrate,imm, plotty,  report, deltaM, deltaB, conseq,
>>> fitfunction, resumefile, includeobjects, ...) {
>>>     if (missing(data))
>>>         tete = terms(y)
>>>     else
>>>         tete = terms(y, data=data)
>>>     oo = attr(tete,"order")
>>>     dep = as.character(attr(tete,"variables"))[2]
>>>     int = attr(tete,"intercept")
>>>     preds = as.character(attr(tete,"variables"))[-(1:2)]
>>>     if (level==2 && max(oo)>1) {
>>>         # get all possible interactions
>>>         interac = attr(tete,"term.labels")[oo==2]
>>>         neotete = terms(as.formula(paste("h~",paste(preds, collapse="*"))))
>>>         neointerac= attr(neotete,"term.labels")[attr(neotete,"order")==2]
>>>         # get exclusions
>>>         for (i in interac)
>>>             neointerac=neointerac[neointerac!=i]
>>>         # same for main effects
>>>         mama = attr(tete,"term.labels")[oo==1]
>>>         exma = preds
>>>         for (j in mama)
>>>             exma = exma[exma!=j]
>>>         exma = c(exma,neointerac)
>>>     } else {
>>>         preds = attr(tete,"term.labels")[oo==1]
>>>         exma=c(1)
>>>     }
>>>     call = match.call()
>>>     call[[match("y", names(call))]] = dep
>>>     call[[length(names(call))+1]] = preds
>>>     names(call)[length(names(call))] ="xr"
>>>         call[[length(names(call))+1]] = exma
>>>     names(call)[length(names(call))] ="exclude"
>>> 
>>>     if (missing(data)) {
>>>         call[[length(names(call))+1]] = environment(y)
>>>         names(call)[length(names(call))] ="data"
>>>     }
>>>     eval(call)
>>> }
>>> 
>>> debug(glmulti)
>>> 
>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>> xr=NULL, data = testdata, level = 2)
>>> ###end
>>> 
>>> On 08/10/2012 11:47 AM, Henric (Nilsson) Winell wrote:
>>>> On 2012-08-10 15:42, Zhang, Peng wrote:
>>>> 
>>>>> You are right. I am running Arch Linux. However, I obtained a
>>>>> segmentation directly, so didn't know where to find the bug??
>>>>> 
>>>>>> library("glmulti")
>>>>> Loading required package: rJava
>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>> = 50)))
>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>> data= testdata, level = 2)
>>>>> Segmentation fault
>>>>> 
>>>>> Is this information "Error in .jnew("glmulti/ModelGenerator", y,
>>>>> jarray(xc), .jarray(xq),  : java.lang.ArrayIndexOutOfBoundsException:
>>>>> 15" only in Windows, or did you see it under Fedora as well?
>>>> 
>>>> Windows only.  Fedora just returned "Segmentation fault".
>>>> 
>>>> 
>>>> //Henric
>>>> 
>>>> 
>>>> 
>>>>> 
>>>>> Thank you!
>>>>> 
>>>>> Peng
>>>>> 
>>>>> BTW:
>>>>> 
>>>>> $ uname -a
>>>>> Linux Precision 3.4.7-1-ARCH #1 SMP PREEMPT Sun Jul 29 22:02:56 CEST
>>>>> 2012 x86_64 GNU/Linux
>>>>> 
>>>>>> sessionInfo()
>>>>> R version 2.15.1 (2012-06-22)
>>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>>> 
>>>>> locale:
>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>   [7] LC_PAPER=C                 LC_NAME=C
>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>> 
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>> 
>>>>> 
>>>>> On 08/10/2012 09:25 AM, Henric (Nilsson) Winell wrote:
>>>>>> On 2012-08-10 06:10, Zhang, Peng wrote:
>>>>>> 
>>>>>>> Thanks to both for your reply.
>>>>>>> 
>>>>>>> library(glmulti)
>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>>> = 50)))
>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>>> data
>>>>>>> = testdata, level = 2)
>>>>>>> 
>>>>>>> This is reproducible to get a segmentation fault.
>>>>>> 
>>>>>> There's some information missing here, notably the output from
>>>>>> 'sessionInfo()', but I guess this is under GNU/Linux.  I can confirm a
>>>>>> seg. fault under Fedora FC17 x86_64.
>>>>>> 
>>>>>> Under Windows 7 64-bit, however, we get some further info:
>>>>>> 
>>>>>>> library("glmulti")
>>>>>> Loading required package: rJava
>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>> = 50)))
>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>> data
>>>>>> + = testdata, level = 2)
>>>>>> Initialization...
>>>>>> Error in .jnew("glmulti/ModelGenerator", y, .jarray(xc),
>>>>>> .jarray(xq),  :
>>>>>>   java.lang.ArrayIndexOutOfBoundsException: 15
>>>>>>> 
>>>>>>> sessionInfo()
>>>>>> R version 2.15.1 Patched (2012-08-06 r60178)
>>>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>>>> 
>>>>>> locale:
>>>>>> [1] LC_COLLATE=Swedish_Sweden.1252 LC_CTYPE=Swedish_Sweden.1252
>>>>>> [3] LC_MONETARY=Swedish_Sweden.1252 LC_NUMERIC=C
>>>>>> [5] LC_TIME=Swedish_Sweden.1252
>>>>>> 
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>> 
>>>>>> other attached packages:
>>>>>> [1] glmulti_1.0.4 rJava_0.9-3
>>>>>>> 
>>>>>> 
>>>>>> So, this doesn't seem to be a bug in R and is thus likely to need the
>>>>>> attention of the 'glmulti' package's maintainer.
>>>>>> 
>>>>>> 
>>>>>> HTH,
>>>>>> Henric
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>>> But I have troubles to
>>>>>>> extract the exact information from this S4 class to make a simpler
>>>>>>> example because of my limited knowledge on S4 class. The author of the
>>>>>>> package is busy at the moment, and does not have time to look into it.
>>>>>>> 
>>>>>>> Peng
>>>>>>> 
>>>>>>> On 08/09/2012 10:25 PM, R. Michael Weylandt
>>>>>>> <michael.weylandt at gmail.com>
>>>>>>> wrote:
>>>>>>>> 
>>>>>>>> On Aug 9, 2012, at 9:14 PM, David Winsemius <dwinsemius at comcast.net>
>>>>>>>> wrote:
>>>>>>>> 
>>>>>>>>> On Aug 9, 2012, at 4:56 PM, Zhang, Peng wrote:
>>>>>>>>> 
>>>>>>>>>> Dear all,
>>>>>>>>>> 
>>>>>>>>>> I had a R segmentation fault, and then invoked debug mode and ran
>>>>>>>>>> step
>>>>>>>>>> by step.
>>>>>>>>> 
>>>>>>>>>> 2. Why does the same function behave differently under debug and
>>>>>>>>>> regular
>>>>>>>>>> mode?
>>>>>>>>> I cannot help you there.
>>>>>>>>> 
>>>>>>>> Though a reproducible segfault is certainly worth a bug report if
>>>>>>>> you can do so, in debug or regular modes.
>>>>>>>> 
>>>>>>>> You may wish to search stackoverflow for tips on how to make a great
>>>>>>>> reproducible example in R.
>>>>>>>> 
>>>>>>>> Michael
>>>>>>> **********************************************************
>>>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>>>> not be used for urgent or sensitive issues
>>>>>>> 
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>> 
>>>>>> 
>>>>> **********************************************************
>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>> not be used for urgent or sensitive issues
>>>>> 
>>>>> 
>>>> 
>>> **********************************************************
>>> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues
>>> 
>>> ______________________________________________
>>> R-help at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> 
> 
> 
> -- 
> Computational Biology / Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N.
> PO Box 19024 Seattle, WA 98109
> 
> Location: Arnold Building M1 B861
> Phone: (206) 667-2793
> 
> 


From pczhang at med.umich.edu  Sat Aug 11 01:08:44 2012
From: pczhang at med.umich.edu (Zhang, Peng)
Date: Fri, 10 Aug 2012 23:08:44 +0000
Subject: [Rd] [R] debug vs regular mode
In-Reply-To: <B74E89CC-D854-4851-8447-32FD411FFDBD@r-project.org>
References: <50244E49.5000908@med.umich.edu>
	<81A9521D-15DA-4F07-A68E-21A1AF643053@comcast.net>
	<2145D1BE-BC07-4CF1-B23E-C27F7264E732@gmail.com>
	<502489CF.5060402@med.umich.edu> <50250BE4.7000704@gmail.com>
	<50250FE0.3050506@med.umich.edu> <50252D1F.3060003@gmail.com>
	<50254A16.8010009@med.umich.edu>
	<8D7C3107-1C92-4F2B-8BCB-7C505095F3A0@gmail.com>
	<50256A23.6070904@fhcrc.org>
	<B74E89CC-D854-4851-8447-32FD411FFDBD@r-project.org>
Message-ID: <5025947C.3030402@med.umich.edu>

Hi Simon,

That could be the explanation. Is it possible to know stack limit for 
different scenarios? For example, if one simply wrap

terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16")) in test = function() { terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16"))
  }

It won't cause the problem in the debug mode. Only in the bug report I filed https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=15013 it becomes the problem.

Knowing the limit for different running environment: R vinila, different debug modes, would help to understand it.

Best,
Peng

On 08/10/2012 05:16 PM, Simon Urbanek wrote:
> On Aug 10, 2012, at 4:08 PM, Martin Morgan wrote:
>
>> On 08/10/2012 12:04 PM, peter dalgaard wrote:
>>> Not to spoil your fun, but this is getting a bit off-topic for R-help. If you wish to continue the debugging process in public, I think you should move to R-devel.
>>>
>>> Also, it sounds like the problem is in the glmulti package, so you might want to involve its maintainer at some point.
>>
>>
>> actually valgrind complains a lot about rJava, though that can be confusing; the example reproduces, so amenable to investigation. glmulti doesn't have C code and the only unusual dependency is rJava
>>
>
> Actually, this crashes is vanilla R (given low enough stack limit, e.g. ulimit -s 1024) - simply try
>
> terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16"))
>
> which is what the code below runs. The problem is that it causes a very deep recursion so depending on the stack it will fail (interestingly, it will segfault in the call to R_CheckStack which is paradoxical :)). I think the proper fix would be to use iteration in StripTerm instead of recursion ...
>
> Cheers,
> Simon
>
> FWIW Java is in general not easily traceable through valgrind, unfortunately, because it uses a lot of dirty tricks like JIT and other things. There are some hints in the valgrind FAQ 3.4, though.
>
>
>>> sessionInfo()
>> R version 2.15.1 Patched (2012-06-22 r59603)
>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>
>> locale:
>> [1] en_US.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] glmulti_1.0.4 rJava_0.9-3
>>
>>
>> Here's the stack trace starting a little below the top
>>
>> #21190 0x00007ffff78b3b88 in Rf_usemethod (generic=0x9f0c80 "terms", obj=0xbcd040, call=0xbf6fb0, args=0x604d18, rho=0xbd9e70, callrho=0xbf88e8, defrho=0x1a873f0,
>>     ans=0x7fffffffb1a8) at /home/mtmorgan/src/R-2-15-branch/src/main/objects.c:339
>> 339		    *ans = applyMethod(t, sxp, matchedarg, rho, newrho);
>> (gdb)
>> #21189 0x00007ffff78b3009 in applyMethod (call=0xbca188, op=0xbf67f0, args=0xbdad30, rho=0xbd9e70, newrho=0xbca118) at /home/mtmorgan/src/R-2-15-branch/src/main/objects.c:125
>> 125		ans = applyClosure(call, op, args, rho, newrho);
>> (gdb)
>> #21188 0x00007ffff784c574 in Rf_applyClosure (call=0xbca188, op=0xbf67f0, arglist=0xbdad30, rho=0xbd9e70, suppliedenv=0xbca118)
>>     at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:859
>> 859		PROTECT(tmp = eval(body, newrho));
>> (gdb)
>> #21187 0x00007ffff784b4b5 in Rf_eval (e=0xbf52e0, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
>> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
>> (gdb)
>> #21186 0x00007ffff784e12d in do_begin (call=0xbf52e0, op=0x610710, args=0xbee388, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1413
>> 1413		    s = eval(CAR(args), rho);
>> (gdb)
>> #21185 0x00007ffff784b4b5 in Rf_eval (e=0xbee3c0, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
>> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
>> (gdb)
>> #21184 0x00007ffff784ef32 in do_set (call=0xbee3c0, op=0x610908, args=0xbedbc8, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1715
>> 1715		    s = eval(CADR(args), rho);
>> (gdb)
>> #21183 0x00007ffff784b4b5 in Rf_eval (e=0xbedc70, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
>> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
>> (gdb)
>> #21182 0x00007ffff78b2979 in do_internal (call=0xbedc70, op=0x611620, args=0xbc9518, env=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/names.c:1228
>> 1228	    ans = PRIMFUN(INTERNAL(fun)) (s, INTERNAL(fun), args, env);
>> (gdb)
>> #21181 0x00007ffff78acdea in do_termsform (call=0xbedf48, op=0x6329f0, args=0xbc9518, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:838
>> 838	    PROTECT(formula = EncodeVars(CAR(args)));
>> (gdb)
>> #21180 0x00007ffff78ac4e6 in EncodeVars (formula=0xbcd040) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:629
>> 629			return EncodeVars(CADDR(formula));
>> (gdb)
>> #21179 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd2a8) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
>> 641		    return CrossTerms(CADR(formula), CADDR(formula));
>> (gdb)
>> #21178 0x00007ffff78abafb in CrossTerms (left=0xbcd318, right=0xd7e338) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:459
>> 459	    PROTECT(left = EncodeVars(left));
>> (gdb)
>> #21177 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd318) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
>> 641		    return CrossTerms(CADR(formula), CADDR(formula));
>> (gdb)
>> #21176 0x00007ffff78abc24 in CrossTerms (left=0xbc5558, right=0x16b6e78) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:471
>> 471	    return TrimRepeats(left);
>> (gdb)
>> #21175 0x00007ffff78ab934 in TrimRepeats (list=0xbc5558) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:404
>> 404	    SETCDR(list, TrimRepeats(StripTerm(CAR(list), CDR(list))));
>> (gdb)
>> #21174 0x00007ffff78ab88d in StripTerm (term=0x121c1d8, list=0xbc5590) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:385
>> 385	    tail = StripTerm(term, CDR(list));
>>
>> and so on down to the bottom
>>
>> valgrind says this
>>
>> ==14352== Invalid write of size 4
>> ==14352==    at 0xD4BC2BD: ???
>> ==14352==    by 0xD4AC437: ???
>> ==14352==    by 0xBDE21AE: JavaCalls::call_helper(JavaValue*, methodHandle*, JavaCallArguments*, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDE1A44: JavaCalls::call(JavaValue*, methodHandle, JavaCallArguments*, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDA5A7E: instanceKlass::call_class_initializer_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDA5AF9: instanceKlass::call_class_initializer(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDA5CF1: instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDA5FB2: instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xC0BDB8D: Threads::create_vm(JavaVMInitArgs*, bool*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==    by 0xBE00509: JNI_CreateJavaVM (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>> ==14352==  Address 0x7feff31e0 is not stack'd, malloc'd or (recently) free'd
>>
>>
>>> -pd
>>>
>>> On Aug 10, 2012, at 19:51 , Zhang, Peng wrote:
>>>
>>>> Thanks! It is interesting that Windows has pointed the problem to Java.
>>>> So it is probable that how I did my debug led me to the wrong direction.
>>>>
>>>> Since I was unsure how to debug S4 class, I copied the source implement
>>>> R function from glmulti package into my testing program.
>>>>
>>>> The segmentation fault will appear when I step to "neotete =
>>>> terms(as.formula(paste("h~",paste(preds, collapse="*"))))". That is why
>>>> I have asked my initial question on the board.
>>>>
>>>> The more interesting thing is that if I don't run library(glmulti), but
>>>> just the following lines, I won't have problem when I stepped to that
>>>> terms function.
>>>>
>>>> I am totally lost. It is not clear to me how to debug S4 class.
>>>>
>>>> Best,
>>>> Peng
>>>>
>>>> ### beginning
>>>> library(glmulti)
>>>>
>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol = 50)))
>>>>
>>>> glmulti =
>>>> function(y, xr, data, exclude, name, intercept, marginality , bunch,
>>>> chunk, chunks,
>>>>          level, minsize, maxsize, minK, maxK,
>>>> method,crit,confsetsize,popsize,mutrate,
>>>>          sexrate,imm, plotty,  report, deltaM, deltaB, conseq,
>>>> fitfunction, resumefile, includeobjects, ...) {
>>>>      if (missing(data))
>>>>          tete = terms(y)
>>>>      else
>>>>          tete = terms(y, data=data)
>>>>      oo = attr(tete,"order")
>>>>      dep = as.character(attr(tete,"variables"))[2]
>>>>      int = attr(tete,"intercept")
>>>>      preds = as.character(attr(tete,"variables"))[-(1:2)]
>>>>      if (level==2 && max(oo)>1) {
>>>>          # get all possible interactions
>>>>          interac = attr(tete,"term.labels")[oo==2]
>>>>          neotete = terms(as.formula(paste("h~",paste(preds, collapse="*"))))
>>>>          neointerac= attr(neotete,"term.labels")[attr(neotete,"order")==2]
>>>>          # get exclusions
>>>>          for (i in interac)
>>>>              neointerac=neointerac[neointerac!=i]
>>>>          # same for main effects
>>>>          mama = attr(tete,"term.labels")[oo==1]
>>>>          exma = preds
>>>>          for (j in mama)
>>>>              exma = exma[exma!=j]
>>>>          exma = c(exma,neointerac)
>>>>      } else {
>>>>          preds = attr(tete,"term.labels")[oo==1]
>>>>          exma=c(1)
>>>>      }
>>>>      call = match.call()
>>>>      call[[match("y", names(call))]] = dep
>>>>      call[[length(names(call))+1]] = preds
>>>>      names(call)[length(names(call))] ="xr"
>>>>          call[[length(names(call))+1]] = exma
>>>>      names(call)[length(names(call))] ="exclude"
>>>>
>>>>      if (missing(data)) {
>>>>          call[[length(names(call))+1]] = environment(y)
>>>>          names(call)[length(names(call))] ="data"
>>>>      }
>>>>      eval(call)
>>>> }
>>>>
>>>> debug(glmulti)
>>>>
>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>> xr=NULL, data = testdata, level = 2)
>>>> ###end
>>>>
>>>> On 08/10/2012 11:47 AM, Henric (Nilsson) Winell wrote:
>>>>> On 2012-08-10 15:42, Zhang, Peng wrote:
>>>>>
>>>>>> You are right. I am running Arch Linux. However, I obtained a
>>>>>> segmentation directly, so didn't know where to find the bug??
>>>>>>
>>>>>>> library("glmulti")
>>>>>> Loading required package: rJava
>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>> = 50)))
>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>> data= testdata, level = 2)
>>>>>> Segmentation fault
>>>>>>
>>>>>> Is this information "Error in .jnew("glmulti/ModelGenerator", y,
>>>>>> jarray(xc), .jarray(xq),  : java.lang.ArrayIndexOutOfBoundsException:
>>>>>> 15" only in Windows, or did you see it under Fedora as well?
>>>>> Windows only.  Fedora just returned "Segmentation fault".
>>>>>
>>>>>
>>>>> //Henric
>>>>>
>>>>>
>>>>>
>>>>>> Thank you!
>>>>>>
>>>>>> Peng
>>>>>>
>>>>>> BTW:
>>>>>>
>>>>>> $ uname -a
>>>>>> Linux Precision 3.4.7-1-ARCH #1 SMP PREEMPT Sun Jul 29 22:02:56 CEST
>>>>>> 2012 x86_64 GNU/Linux
>>>>>>
>>>>>>> sessionInfo()
>>>>>> R version 2.15.1 (2012-06-22)
>>>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>>>>
>>>>>> locale:
>>>>>>    [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>    [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>    [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>    [7] LC_PAPER=C                 LC_NAME=C
>>>>>>    [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>>
>>>>>>
>>>>>> On 08/10/2012 09:25 AM, Henric (Nilsson) Winell wrote:
>>>>>>> On 2012-08-10 06:10, Zhang, Peng wrote:
>>>>>>>
>>>>>>>> Thanks to both for your reply.
>>>>>>>>
>>>>>>>> library(glmulti)
>>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>>>> = 50)))
>>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>>>> data
>>>>>>>> = testdata, level = 2)
>>>>>>>>
>>>>>>>> This is reproducible to get a segmentation fault.
>>>>>>> There's some information missing here, notably the output from
>>>>>>> 'sessionInfo()', but I guess this is under GNU/Linux.  I can confirm a
>>>>>>> seg. fault under Fedora FC17 x86_64.
>>>>>>>
>>>>>>> Under Windows 7 64-bit, however, we get some further info:
>>>>>>>
>>>>>>>> library("glmulti")
>>>>>>> Loading required package: rJava
>>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>>> = 50)))
>>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>>> data
>>>>>>> + = testdata, level = 2)
>>>>>>> Initialization...
>>>>>>> Error in .jnew("glmulti/ModelGenerator", y, .jarray(xc),
>>>>>>> .jarray(xq),  :
>>>>>>>    java.lang.ArrayIndexOutOfBoundsException: 15
>>>>>>>> sessionInfo()
>>>>>>> R version 2.15.1 Patched (2012-08-06 r60178)
>>>>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>>>>>
>>>>>>> locale:
>>>>>>> [1] LC_COLLATE=Swedish_Sweden.1252 LC_CTYPE=Swedish_Sweden.1252
>>>>>>> [3] LC_MONETARY=Swedish_Sweden.1252 LC_NUMERIC=C
>>>>>>> [5] LC_TIME=Swedish_Sweden.1252
>>>>>>>
>>>>>>> attached base packages:
>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>>>
>>>>>>> other attached packages:
>>>>>>> [1] glmulti_1.0.4 rJava_0.9-3
>>>>>>> So, this doesn't seem to be a bug in R and is thus likely to need the
>>>>>>> attention of the 'glmulti' package's maintainer.
>>>>>>>
>>>>>>>
>>>>>>> HTH,
>>>>>>> Henric
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> But I have troubles to
>>>>>>>> extract the exact information from this S4 class to make a simpler
>>>>>>>> example because of my limited knowledge on S4 class. The author of the
>>>>>>>> package is busy at the moment, and does not have time to look into it.
>>>>>>>>
>>>>>>>> Peng
>>>>>>>>
>>>>>>>> On 08/09/2012 10:25 PM, R. Michael Weylandt
>>>>>>>> <michael.weylandt at gmail.com>
>>>>>>>> wrote:
>>>>>>>>> On Aug 9, 2012, at 9:14 PM, David Winsemius <dwinsemius at comcast.net>
>>>>>>>>> wrote:
>>>>>>>>>
>>>>>>>>>> On Aug 9, 2012, at 4:56 PM, Zhang, Peng wrote:
>>>>>>>>>>
>>>>>>>>>>> Dear all,
>>>>>>>>>>>
>>>>>>>>>>> I had a R segmentation fault, and then invoked debug mode and ran
>>>>>>>>>>> step
>>>>>>>>>>> by step.
>>>>>>>>>>> 2. Why does the same function behave differently under debug and
>>>>>>>>>>> regular
>>>>>>>>>>> mode?
>>>>>>>>>> I cannot help you there.
>>>>>>>>>>
>>>>>>>>> Though a reproducible segfault is certainly worth a bug report if
>>>>>>>>> you can do so, in debug or regular modes.
>>>>>>>>>
>>>>>>>>> You may wish to search stackoverflow for tips on how to make a great
>>>>>>>>> reproducible example in R.
>>>>>>>>>
>>>>>>>>> Michael
>>>>>>>> **********************************************************
>>>>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>>>>> not be used for urgent or sensitive issues
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>
>>>>>> **********************************************************
>>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>>> not be used for urgent or sensitive issues
>>>>>>
>>>>>>
>>>> **********************************************************
>>>> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -- 
>> Computational Biology / Fred Hutchinson Cancer Research Center
>> 1100 Fairview Ave. N.
>> PO Box 19024 Seattle, WA 98109
>>
>> Location: Arnold Building M1 B861
>> Phone: (206) 667-2793
>>
>>
**********************************************************
Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues 


From simon.urbanek at r-project.org  Sat Aug 11 03:45:17 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 10 Aug 2012 21:45:17 -0400
Subject: [Rd] [R] debug vs regular mode
In-Reply-To: <5025947C.3030402@med.umich.edu>
References: <50244E49.5000908@med.umich.edu>
	<81A9521D-15DA-4F07-A68E-21A1AF643053@comcast.net>
	<2145D1BE-BC07-4CF1-B23E-C27F7264E732@gmail.com>
	<502489CF.5060402@med.umich.edu> <50250BE4.7000704@gmail.com>
	<50250FE0.3050506@med.umich.edu> <50252D1F.3060003@gmail.com>
	<50254A16.8010009@med.umich.edu>
	<8D7C3107-1C92-4F2B-8BCB-7C505095F3A0@gmail.com>
	<50256A23.6070904@fhcrc.org>
	<B74E89CC-D854-4851-8447-32FD411FFDBD@r-project.org>
	<5025947C.3030402@med.umich.edu>
Message-ID: <07E764D2-CF0A-4494-AE6B-2627D679115C@r-project.org>


On Aug 10, 2012, at 7:08 PM, Zhang, Peng wrote:

> Hi Simon,
> 
> That could be the explanation. Is it possible to know stack limit for 
> different scenarios?

The limit is the same - what changes is the stack usage (how deep you are at that point). Note, however, that it's irrelevant since the new code in R-devel doesn't use the stack anymore.

Cheers,
Simon


> For example, if one simply wrap
> 
> terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16")) in test = function() { terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16"))
>  }
> 
> It won't cause the problem in the debug mode. Only in the bug report I filed https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=15013 it becomes the problem.
> 
> Knowing the limit for different running environment: R vinila, different debug modes, would help to understand it.
> 
> Best,
> Peng
> 
> On 08/10/2012 05:16 PM, Simon Urbanek wrote:
>> On Aug 10, 2012, at 4:08 PM, Martin Morgan wrote:
>> 
>>> On 08/10/2012 12:04 PM, peter dalgaard wrote:
>>>> Not to spoil your fun, but this is getting a bit off-topic for R-help. If you wish to continue the debugging process in public, I think you should move to R-devel.
>>>> 
>>>> Also, it sounds like the problem is in the glmulti package, so you might want to involve its maintainer at some point.
>>> 
>>> 
>>> actually valgrind complains a lot about rJava, though that can be confusing; the example reproduces, so amenable to investigation. glmulti doesn't have C code and the only unusual dependency is rJava
>>> 
>> 
>> Actually, this crashes is vanilla R (given low enough stack limit, e.g. ulimit -s 1024) - simply try
>> 
>> terms(as.formula("h~ X1*X2*X3*X4*X5*X6*X7*X8*X9*X10*X11*X12*X13*X14*X15*X16"))
>> 
>> which is what the code below runs. The problem is that it causes a very deep recursion so depending on the stack it will fail (interestingly, it will segfault in the call to R_CheckStack which is paradoxical :)). I think the proper fix would be to use iteration in StripTerm instead of recursion ...
>> 
>> Cheers,
>> Simon
>> 
>> FWIW Java is in general not easily traceable through valgrind, unfortunately, because it uses a lot of dirty tricks like JIT and other things. There are some hints in the valgrind FAQ 3.4, though.
>> 
>> 
>>>> sessionInfo()
>>> R version 2.15.1 Patched (2012-06-22 r59603)
>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>> 
>>> locale:
>>> [1] en_US.UTF-8
>>> 
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> 
>>> other attached packages:
>>> [1] glmulti_1.0.4 rJava_0.9-3
>>> 
>>> 
>>> Here's the stack trace starting a little below the top
>>> 
>>> #21190 0x00007ffff78b3b88 in Rf_usemethod (generic=0x9f0c80 "terms", obj=0xbcd040, call=0xbf6fb0, args=0x604d18, rho=0xbd9e70, callrho=0xbf88e8, defrho=0x1a873f0,
>>>    ans=0x7fffffffb1a8) at /home/mtmorgan/src/R-2-15-branch/src/main/objects.c:339
>>> 339		    *ans = applyMethod(t, sxp, matchedarg, rho, newrho);
>>> (gdb)
>>> #21189 0x00007ffff78b3009 in applyMethod (call=0xbca188, op=0xbf67f0, args=0xbdad30, rho=0xbd9e70, newrho=0xbca118) at /home/mtmorgan/src/R-2-15-branch/src/main/objects.c:125
>>> 125		ans = applyClosure(call, op, args, rho, newrho);
>>> (gdb)
>>> #21188 0x00007ffff784c574 in Rf_applyClosure (call=0xbca188, op=0xbf67f0, arglist=0xbdad30, rho=0xbd9e70, suppliedenv=0xbca118)
>>>    at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:859
>>> 859		PROTECT(tmp = eval(body, newrho));
>>> (gdb)
>>> #21187 0x00007ffff784b4b5 in Rf_eval (e=0xbf52e0, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
>>> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
>>> (gdb)
>>> #21186 0x00007ffff784e12d in do_begin (call=0xbf52e0, op=0x610710, args=0xbee388, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1413
>>> 1413		    s = eval(CAR(args), rho);
>>> (gdb)
>>> #21185 0x00007ffff784b4b5 in Rf_eval (e=0xbee3c0, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
>>> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
>>> (gdb)
>>> #21184 0x00007ffff784ef32 in do_set (call=0xbee3c0, op=0x610908, args=0xbedbc8, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:1715
>>> 1715		    s = eval(CADR(args), rho);
>>> (gdb)
>>> #21183 0x00007ffff784b4b5 in Rf_eval (e=0xbedc70, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/eval.c:466
>>> 466		    tmp = PRIMFUN(op) (e, op, CDR(e), rho);
>>> (gdb)
>>> #21182 0x00007ffff78b2979 in do_internal (call=0xbedc70, op=0x611620, args=0xbc9518, env=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/names.c:1228
>>> 1228	    ans = PRIMFUN(INTERNAL(fun)) (s, INTERNAL(fun), args, env);
>>> (gdb)
>>> #21181 0x00007ffff78acdea in do_termsform (call=0xbedf48, op=0x6329f0, args=0xbc9518, rho=0xbc8f30) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:838
>>> 838	    PROTECT(formula = EncodeVars(CAR(args)));
>>> (gdb)
>>> #21180 0x00007ffff78ac4e6 in EncodeVars (formula=0xbcd040) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:629
>>> 629			return EncodeVars(CADDR(formula));
>>> (gdb)
>>> #21179 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd2a8) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
>>> 641		    return CrossTerms(CADR(formula), CADDR(formula));
>>> (gdb)
>>> #21178 0x00007ffff78abafb in CrossTerms (left=0xbcd318, right=0xd7e338) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:459
>>> 459	    PROTECT(left = EncodeVars(left));
>>> (gdb)
>>> #21177 0x00007ffff78ac5c5 in EncodeVars (formula=0xbcd318) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:641
>>> 641		    return CrossTerms(CADR(formula), CADDR(formula));
>>> (gdb)
>>> #21176 0x00007ffff78abc24 in CrossTerms (left=0xbc5558, right=0x16b6e78) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:471
>>> 471	    return TrimRepeats(left);
>>> (gdb)
>>> #21175 0x00007ffff78ab934 in TrimRepeats (list=0xbc5558) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:404
>>> 404	    SETCDR(list, TrimRepeats(StripTerm(CAR(list), CDR(list))));
>>> (gdb)
>>> #21174 0x00007ffff78ab88d in StripTerm (term=0x121c1d8, list=0xbc5590) at /home/mtmorgan/src/R-2-15-branch/src/main/model.c:385
>>> 385	    tail = StripTerm(term, CDR(list));
>>> 
>>> and so on down to the bottom
>>> 
>>> valgrind says this
>>> 
>>> ==14352== Invalid write of size 4
>>> ==14352==    at 0xD4BC2BD: ???
>>> ==14352==    by 0xD4AC437: ???
>>> ==14352==    by 0xBDE21AE: JavaCalls::call_helper(JavaValue*, methodHandle*, JavaCallArguments*, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDE1A44: JavaCalls::call(JavaValue*, methodHandle, JavaCallArguments*, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDA5A7E: instanceKlass::call_class_initializer_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDA5AF9: instanceKlass::call_class_initializer(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDA5CF1: instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDA5FB2: instanceKlass::initialize_impl(instanceKlassHandle, Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBDA6168: instanceKlass::initialize(Thread*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xC0BDB8D: Threads::create_vm(JavaVMInitArgs*, bool*) (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==    by 0xBE00509: JNI_CreateJavaVM (in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so)
>>> ==14352==  Address 0x7feff31e0 is not stack'd, malloc'd or (recently) free'd
>>> 
>>> 
>>>> -pd
>>>> 
>>>> On Aug 10, 2012, at 19:51 , Zhang, Peng wrote:
>>>> 
>>>>> Thanks! It is interesting that Windows has pointed the problem to Java.
>>>>> So it is probable that how I did my debug led me to the wrong direction.
>>>>> 
>>>>> Since I was unsure how to debug S4 class, I copied the source implement
>>>>> R function from glmulti package into my testing program.
>>>>> 
>>>>> The segmentation fault will appear when I step to "neotete =
>>>>> terms(as.formula(paste("h~",paste(preds, collapse="*"))))". That is why
>>>>> I have asked my initial question on the board.
>>>>> 
>>>>> The more interesting thing is that if I don't run library(glmulti), but
>>>>> just the following lines, I won't have problem when I stepped to that
>>>>> terms function.
>>>>> 
>>>>> I am totally lost. It is not clear to me how to debug S4 class.
>>>>> 
>>>>> Best,
>>>>> Peng
>>>>> 
>>>>> ### beginning
>>>>> library(glmulti)
>>>>> 
>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol = 50)))
>>>>> 
>>>>> glmulti =
>>>>> function(y, xr, data, exclude, name, intercept, marginality , bunch,
>>>>> chunk, chunks,
>>>>>         level, minsize, maxsize, minK, maxK,
>>>>> method,crit,confsetsize,popsize,mutrate,
>>>>>         sexrate,imm, plotty,  report, deltaM, deltaB, conseq,
>>>>> fitfunction, resumefile, includeobjects, ...) {
>>>>>     if (missing(data))
>>>>>         tete = terms(y)
>>>>>     else
>>>>>         tete = terms(y, data=data)
>>>>>     oo = attr(tete,"order")
>>>>>     dep = as.character(attr(tete,"variables"))[2]
>>>>>     int = attr(tete,"intercept")
>>>>>     preds = as.character(attr(tete,"variables"))[-(1:2)]
>>>>>     if (level==2 && max(oo)>1) {
>>>>>         # get all possible interactions
>>>>>         interac = attr(tete,"term.labels")[oo==2]
>>>>>         neotete = terms(as.formula(paste("h~",paste(preds, collapse="*"))))
>>>>>         neointerac= attr(neotete,"term.labels")[attr(neotete,"order")==2]
>>>>>         # get exclusions
>>>>>         for (i in interac)
>>>>>             neointerac=neointerac[neointerac!=i]
>>>>>         # same for main effects
>>>>>         mama = attr(tete,"term.labels")[oo==1]
>>>>>         exma = preds
>>>>>         for (j in mama)
>>>>>             exma = exma[exma!=j]
>>>>>         exma = c(exma,neointerac)
>>>>>     } else {
>>>>>         preds = attr(tete,"term.labels")[oo==1]
>>>>>         exma=c(1)
>>>>>     }
>>>>>     call = match.call()
>>>>>     call[[match("y", names(call))]] = dep
>>>>>     call[[length(names(call))+1]] = preds
>>>>>     names(call)[length(names(call))] ="xr"
>>>>>         call[[length(names(call))+1]] = exma
>>>>>     names(call)[length(names(call))] ="exclude"
>>>>> 
>>>>>     if (missing(data)) {
>>>>>         call[[length(names(call))+1]] = environment(y)
>>>>>         names(call)[length(names(call))] ="data"
>>>>>     }
>>>>>     eval(call)
>>>>> }
>>>>> 
>>>>> debug(glmulti)
>>>>> 
>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>> xr=NULL, data = testdata, level = 2)
>>>>> ###end
>>>>> 
>>>>> On 08/10/2012 11:47 AM, Henric (Nilsson) Winell wrote:
>>>>>> On 2012-08-10 15:42, Zhang, Peng wrote:
>>>>>> 
>>>>>>> You are right. I am running Arch Linux. However, I obtained a
>>>>>>> segmentation directly, so didn't know where to find the bug??
>>>>>>> 
>>>>>>>> library("glmulti")
>>>>>>> Loading required package: rJava
>>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>>> = 50)))
>>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>>> data= testdata, level = 2)
>>>>>>> Segmentation fault
>>>>>>> 
>>>>>>> Is this information "Error in .jnew("glmulti/ModelGenerator", y,
>>>>>>> jarray(xc), .jarray(xq),  : java.lang.ArrayIndexOutOfBoundsException:
>>>>>>> 15" only in Windows, or did you see it under Fedora as well?
>>>>>> Windows only.  Fedora just returned "Segmentation fault".
>>>>>> 
>>>>>> 
>>>>>> //Henric
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>>> Thank you!
>>>>>>> 
>>>>>>> Peng
>>>>>>> 
>>>>>>> BTW:
>>>>>>> 
>>>>>>> $ uname -a
>>>>>>> Linux Precision 3.4.7-1-ARCH #1 SMP PREEMPT Sun Jul 29 22:02:56 CEST
>>>>>>> 2012 x86_64 GNU/Linux
>>>>>>> 
>>>>>>>> sessionInfo()
>>>>>>> R version 2.15.1 (2012-06-22)
>>>>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>>>>> 
>>>>>>> locale:
>>>>>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>>>>   [7] LC_PAPER=C                 LC_NAME=C
>>>>>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>> 
>>>>>>> attached base packages:
>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>>> 
>>>>>>> 
>>>>>>> On 08/10/2012 09:25 AM, Henric (Nilsson) Winell wrote:
>>>>>>>> On 2012-08-10 06:10, Zhang, Peng wrote:
>>>>>>>> 
>>>>>>>>> Thanks to both for your reply.
>>>>>>>>> 
>>>>>>>>> library(glmulti)
>>>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>>>>> = 50)))
>>>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>>>>> data
>>>>>>>>> = testdata, level = 2)
>>>>>>>>> 
>>>>>>>>> This is reproducible to get a segmentation fault.
>>>>>>>> There's some information missing here, notably the output from
>>>>>>>> 'sessionInfo()', but I guess this is under GNU/Linux.  I can confirm a
>>>>>>>> seg. fault under Fedora FC17 x86_64.
>>>>>>>> 
>>>>>>>> Under Windows 7 64-bit, however, we get some further info:
>>>>>>>> 
>>>>>>>>> library("glmulti")
>>>>>>>> Loading required package: rJava
>>>>>>>>> testdata = cbind(Y=rnorm(100), data.frame(matrix(rnorm(100*50), ncol
>>>>>>>> = 50)))
>>>>>>>>> glmulti(Y~(X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15)*X16,
>>>>>>>> data
>>>>>>>> + = testdata, level = 2)
>>>>>>>> Initialization...
>>>>>>>> Error in .jnew("glmulti/ModelGenerator", y, .jarray(xc),
>>>>>>>> .jarray(xq),  :
>>>>>>>>   java.lang.ArrayIndexOutOfBoundsException: 15
>>>>>>>>> sessionInfo()
>>>>>>>> R version 2.15.1 Patched (2012-08-06 r60178)
>>>>>>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>>>>>>> 
>>>>>>>> locale:
>>>>>>>> [1] LC_COLLATE=Swedish_Sweden.1252 LC_CTYPE=Swedish_Sweden.1252
>>>>>>>> [3] LC_MONETARY=Swedish_Sweden.1252 LC_NUMERIC=C
>>>>>>>> [5] LC_TIME=Swedish_Sweden.1252
>>>>>>>> 
>>>>>>>> attached base packages:
>>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods base
>>>>>>>> 
>>>>>>>> other attached packages:
>>>>>>>> [1] glmulti_1.0.4 rJava_0.9-3
>>>>>>>> So, this doesn't seem to be a bug in R and is thus likely to need the
>>>>>>>> attention of the 'glmulti' package's maintainer.
>>>>>>>> 
>>>>>>>> 
>>>>>>>> HTH,
>>>>>>>> Henric
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>>> But I have troubles to
>>>>>>>>> extract the exact information from this S4 class to make a simpler
>>>>>>>>> example because of my limited knowledge on S4 class. The author of the
>>>>>>>>> package is busy at the moment, and does not have time to look into it.
>>>>>>>>> 
>>>>>>>>> Peng
>>>>>>>>> 
>>>>>>>>> On 08/09/2012 10:25 PM, R. Michael Weylandt
>>>>>>>>> <michael.weylandt at gmail.com>
>>>>>>>>> wrote:
>>>>>>>>>> On Aug 9, 2012, at 9:14 PM, David Winsemius <dwinsemius at comcast.net>
>>>>>>>>>> wrote:
>>>>>>>>>> 
>>>>>>>>>>> On Aug 9, 2012, at 4:56 PM, Zhang, Peng wrote:
>>>>>>>>>>> 
>>>>>>>>>>>> Dear all,
>>>>>>>>>>>> 
>>>>>>>>>>>> I had a R segmentation fault, and then invoked debug mode and ran
>>>>>>>>>>>> step
>>>>>>>>>>>> by step.
>>>>>>>>>>>> 2. Why does the same function behave differently under debug and
>>>>>>>>>>>> regular
>>>>>>>>>>>> mode?
>>>>>>>>>>> I cannot help you there.
>>>>>>>>>>> 
>>>>>>>>>> Though a reproducible segfault is certainly worth a bug report if
>>>>>>>>>> you can do so, in debug or regular modes.
>>>>>>>>>> 
>>>>>>>>>> You may wish to search stackoverflow for tips on how to make a great
>>>>>>>>>> reproducible example in R.
>>>>>>>>>> 
>>>>>>>>>> Michael
>>>>>>>>> **********************************************************
>>>>>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>>>>>> not be used for urgent or sensitive issues
>>>>>>>>> 
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>> 
>>>>>>> **********************************************************
>>>>>>> Electronic Mail is not secure, may not be read every day, and should
>>>>>>> not be used for urgent or sensitive issues
>>>>>>> 
>>>>>>> 
>>>>> **********************************************************
>>>>> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues
>>>>> 
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>> 
>>> -- 
>>> Computational Biology / Fred Hutchinson Cancer Research Center
>>> 1100 Fairview Ave. N.
>>> PO Box 19024 Seattle, WA 98109
>>> 
>>> Location: Arnold Building M1 B861
>>> Phone: (206) 667-2793
>>> 
>>> 
> **********************************************************
> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues 
> 
> 


From ripley at stats.ox.ac.uk  Sat Aug 11 07:57:31 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 11 Aug 2012 06:57:31 +0100
Subject: [Rd] Performance issues with R2.15.1 built from source on
	Solaris
In-Reply-To: <EA3EDB50F845354B8279DA646268AC6F014465F5@a0775-xpo0006-s.ad.allstate.com>
References: <mailman.15.1344592805.9704.r-devel@r-project.org>
	<20120810144849.GB4641@cs.toronto.edu>
	<EA3EDB50F845354B8279DA646268AC6F014465F5@a0775-xpo0006-s.ad.allstate.com>
Message-ID: <5025F44B.8090108@stats.ox.ac.uk>

On 10/08/2012 17:50, Eberle, Anthony wrote:
> Yes, the T4 physical host that the zone is configured on is SPARC.  Are
> you saying that this is a function of the hardware or would possibly
> updating to a newer version of gcc help?  I'm actually going to see if I
> can build a newer version of gcc anyway just to eliminate that variable.

It is a function of the hardware.

You will likely do better (I do on a T2) with the native compiler 
(Solaris Studio) than any version of gcc on Sparc, but things involving 
long doubles are going to be slow.  However, they are a very small part 
of a typical mix of R work (if e.g. what CRAN packages do is typical).

In any case, I would suggest using a recent version of gcc, as R-patched 
does not compile with gcc3/g77: we have finally required a more modern 
Fortran (and there are C things like inlining that require more C99 
compliance than gcc3 has).


> I picked the "sd" and "R-Benchmark" tests as I am new to R and
> functioning more as an administrator than a modeler or statistical
> engineer.  I too have seen that some operations do perform better on
> certain systems than others.  This makes sense as I know different
> hardware and CPU's are better at some things than others.  However I'm
> not familiar enough with R yet to know what the functions are doing
> under the hood and which would be more performing on what hardware.
>
> However I will try to check into the specs for the T4 and see if
> anything is mentioned about the "long double" or something along these
> lines.  Thanks.
>
> Anthony
>
> -----Original Message-----
> From: r-devel-bounces at r-project.org
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Radford Neal
> Sent: Friday, August 10, 2012 9:49 AM
> To: r-devel at r-project.org
> Subject: [Rd] Performance issues with R2.15.1 built from source on
> Solaris
>
> Is this a SPARC system?  On at least some SPARC systems, the "long
> double"
> type in C is implemented very slowly in software, and it seems that it
> is used for the sums done when calculating standard deviations with
> "sd".
>
>     Radford Neal
>
>
>> Date: Wed, 8 Aug 2012 18:55:37 -0500
>> From: "Eberle, Anthony" <aeber at allstate.com>
>> To: <r-devel at r-project.org>
>> Subject: [Rd] Performance issues with R2.15.1 built from source on
>> 	Solaris?
>
>> I have a question about building R (2.15.1) from source on a Solaris
>> 10 64bit virtual server with 2 cores and 16GB memory that is running
>> on an Oracle T4 server.  Based on several tests I have done this
>> configuration has been several orders of magnitude slower than any
>> other configuration I've tested.
>>
>> A simple test of some code to calculate the standard deviation 10000
>> times (simple code to consume resources) takes on average 121.498
>> seconds on the Solaris server where the next worst system (Redhat
>> Linux) takes 1.567 seconds:
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From HodgessE at uhd.edu  Sun Aug 12 20:45:14 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 12 Aug 2012 13:45:14 -0500
Subject: [Rd] trouble compiling R-patched from source on Windows 64 bit
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF595BF@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120812/4cebfa92/attachment.pl>

From ripley at stats.ox.ac.uk  Mon Aug 13 07:59:01 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Aug 2012 06:59:01 +0100
Subject: [Rd] trouble compiling R-patched from source on Windows 64 bit
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF595BF@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF595BF@BALI.uhd.campus>
Message-ID: <502897A5.5010206@stats.ox.ac.uk>

On 12/08/2012 19:45, Hodgess, Erin wrote:
> Hello!
>
> I'm trying to install R-patched from source on a Windows 64 bit laptop.

See the comments:
skipping incompatible ./libRblas.dll.a when searching for -lRblas

You are using the wrong compilers: 4.5.2 is not for recent R.

> I have installed R-tools 2.16 and set up the jpeg, tiff, and libpng files

Check your path and the settings in MkRules.local.

> Here is the output:
>
> c:\R64\R-patched\src\gnuwin32>make all recommended
> make all recommended
> make[1]: `MkRules' is up to date.
> make[4]: Nothing to be done for `svnonly'.
> installing C headers
> make[2]: Nothing to be done for `all'.
> make[2]: `libRblas.dll.a' is up to date.
> make[5]: Nothing to be done for `svnonly'.
> installing C headers
> make --no-print-directory -C ../extra/intl CFLAGS='-O3 -Wall -pedantic -mtune=core2' -f Makefile.win
> make --no-print-directory -C ../appl CFLAGS='-O3 -Wall -pedantic -mtune=core2' FFLAGS='-O3 -mtune=core2' -f Makefile.win
> make --no-print-directory -C ../nmath CFLAGS='-O3 -Wall -pedantic -mtune=core2' FFLAGS='-O3 -mtune=core2' -f Makefile.win
> make --no-print-directory -C ../main CFLAGS='-O3 -Wall -pedantic -mtune=core2' FFLAGS='-O3 -mtune=core2' malloc-DEFS='-DLEA_MALLOC' -f Makefile.win
> make --no-print-directory -C ./getline CFLAGS='-O3 -Wall -pedantic -mtune=core2'
> make[4]: `gl.a' is up to date.
> make -f Makefile.win makeMakedeps
> make -f Makefile.win libpcre.a
> make[5]: `libpcre.a' is up to date.
> make[4]: Nothing to be done for `all'.
> make -f Makefile.win makeMakedeps
> make -f Makefile.win libtre.a
> make[5]: `libtre.a' is up to date.
> make[4]: Nothing to be done for `all'.
> make[5]: `stamp' is up to date.
> make[5]: `liblzma.a' is up to date.
> x86_64-w64-mingw32-gcc -std=gnu99  -shared -s -mwindows -o R.dll R.def console.o dataentry.o dynload.o edit.o editor.o embeddedR.o extra.o opt.o pager.o preferences.o psignal.o rhome.o rt_complete.o rui.o run.o shext.o sys-win32.o system.o dos_wglob.o malloc.o ../main/libmain.a ../appl/libappl.a ../nmath/libnmath.a getline/gl.a ../extra/xdr/libxdr.a ../extra/pcre/libpcre.a ../extra/bzip2/libbz2.a ../extra/intl/libintl.a ../extra/trio/libtrio.a ../extra/tzone/libtz.a ../extra/tre/libtre.a ../extra/xz/liblzma.a dllversion.o  -L. -lgfortran -lRblas -L../../bin/x64 -lRzlib -lRgraphapp -lRiconv -lcomctl32 -lversion
> c:/rtools/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/4.5.2/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible ./libRblas.dll.a when searching for -lRblas
> c:/rtools/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/4.5.2/../../../../x86_64-w64-mingw32/bin/ld.exe: skipping incompatible ./libRblas.dll.a when searching for -lRblas
> c:/rtools/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/4.5.2/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lRblas
> collect2: ld returned 1 exit status
> make[3]: *** [R.dll] Error 1
> make[2]: *** [../../bin/x64/R.dll] Error 2
> make[1]: *** [rbuild] Error 2
> make: *** [all] Error 2
>
> c:\R64\R-patched\src\gnuwin32>
>
> Does this make sense, please?
>
> Thanks in advance for any help.
>
> Sincerely,
> Erin
>
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pmarandy at gmail.com  Mon Aug 13 05:45:32 2012
From: pmarandy at gmail.com (nobody)
Date: Sun, 12 Aug 2012 23:45:32 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
Message-ID: <20120813034532.GA17328@wall.e>

hello,

i am trying to build R on alpine/gentoo with uclibc and it fails with the following
error msg:

connections.c: In function 'Rconn_fgetc':
connections.c:3184:11: error: expected identifier before '(' token
connections.c:3186:15: error: expected identifier before '(' token
make[3]: *** [connections.o] Error 1

here is the whole build log :http://bpaste.net/show/39955/
any idea?

i've *walked* back the versions down to 2.14.1 and i still get exact same
error msg.
there are some patches applied but none of them touches connections.c, i
think. in any case i can provide the patches if need be.

thanks


From simon.urbanek at r-project.org  Mon Aug 13 16:49:26 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 13 Aug 2012 10:49:26 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <20120813034532.GA17328@wall.e>
References: <20120813034532.GA17328@wall.e>
Message-ID: <BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>


On Aug 12, 2012, at 11:45 PM, nobody wrote:

> hello,
> 
> i am trying to build R on alpine/gentoo with uclibc and it fails with the following
> error msg:
> 
> connections.c: In function 'Rconn_fgetc':
> connections.c:3184:11: error: expected identifier before '(' token
> connections.c:3186:15: error: expected identifier before '(' token
> make[3]: *** [connections.o] Error 1
> 
> here is the whole build log :http://bpaste.net/show/39955/
> any idea?
> 

I suspect that your runtime/libc is defining fgetc as a macro which breaks any code that uses it as an identifier. Ideally, your runtime should be fixed to use a proper function, but you could probably work around it with something like

static char * fix_fgets(char *s, int n, FILE *stream) { return fgets(s, n, stream); }
#undef fgets
static char * fgets(char *s, int n, FILE *stream) { return fix_fgets(s, n, stream); }

Cheers,
Simon



> i've *walked* back the versions down to 2.14.1 and i still get exact same
> error msg.
> there are some patches applied but none of them touches connections.c, i
> think. in any case i can provide the patches if need be.
> 
> thanks
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From simon.urbanek at r-project.org  Tue Aug 14 01:45:42 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 13 Aug 2012 19:45:42 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <20120813182240.GA30033@wall.e>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
	<20120813182240.GA30033@wall.e>
Message-ID: <C2608402-2E0B-4488-B828-3B02B3077E26@r-project.org>


On Aug 13, 2012, at 2:22 PM, nobody wrote:

> On Mon, Aug 13, 2012 at 10:49:26AM -0400, Simon Urbanek wrote:
>> I suspect that your runtime/libc is defining fgetc as a macro which breaks any code that uses it as an identifier. Ideally, your runtime should be fixed to use a proper function, but you could probably work around it with something like
>> 
>> static char * fix_fgets(char *s, int n, FILE *stream) { return fgets(s, n, stream); }
>> #undef fgets
>> static char * fgets(char *s, int n, FILE *stream) { return fix_fgets(s, n, stream); }
>> 
>> Cheers,
>> Simon
> 
> like this? :http://bpaste.net/show/40047/
> if so, then i get this err msg:
> connections.c:385:15: error: static declaration of 'fgets' follows non-static declaration
> /usr/include/stdio.h:544:14: note: previous declaration of 'fgets' was here
> connections.c: In function 'Rconn_fgetc':
> connections.c:3192:11: error: expected identifier before '(' token
> connections.c:3194:15: error: expected identifier before '(' token
> 
> and here is how it's declared in stdio.h on my system:
> 
> /* Get a newline-terminated string of finite length from STREAM.
> 
>   This function is a possible cancellation point and therefore not
>   marked with __THROW.  */
> extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream)
>     __wur;
> 
> 

Ouch - never mind then - try simply #undef fgets in that case but since I don't have access to the system you have I can't really give you much better advice :/

From darwinskernel at gmail.com  Mon Aug 13 20:22:40 2012
From: darwinskernel at gmail.com (nobody)
Date: Mon, 13 Aug 2012 14:22:40 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
Message-ID: <20120813182240.GA30033@wall.e>

On Mon, Aug 13, 2012 at 10:49:26AM -0400, Simon Urbanek wrote:
> I suspect that your runtime/libc is defining fgetc as a macro which breaks any code that uses it as an identifier. Ideally, your runtime should be fixed to use a proper function, but you could probably work around it with something like
> 
> static char * fix_fgets(char *s, int n, FILE *stream) { return fgets(s, n, stream); }
> #undef fgets
> static char * fgets(char *s, int n, FILE *stream) { return fix_fgets(s, n, stream); }
> 
> Cheers,
> Simon

like this? :http://bpaste.net/show/40047/
if so, then i get this err msg:
connections.c:385:15: error: static declaration of 'fgets' follows non-static declaration
/usr/include/stdio.h:544:14: note: previous declaration of 'fgets' was here
connections.c: In function 'Rconn_fgetc':
connections.c:3192:11: error: expected identifier before '(' token
connections.c:3194:15: error: expected identifier before '(' token

and here is how it's declared in stdio.h on my system:

/* Get a newline-terminated string of finite length from STREAM.

   This function is a possible cancellation point and therefore not
   marked with __THROW.  */
extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream)
     __wur;


From pdalgd at gmail.com  Tue Aug 14 13:48:44 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 14 Aug 2012 13:48:44 +0200
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <20120813182240.GA30033@wall.e>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
	<20120813182240.GA30033@wall.e>
Message-ID: <5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>


On Aug 13, 2012, at 20:22 , nobody wrote:

> On Mon, Aug 13, 2012 at 10:49:26AM -0400, Simon Urbanek wrote:
>> I suspect that your runtime/libc is defining fgetc as a macro which breaks any code that uses it as an identifier. Ideally, your runtime should be fixed to use a proper function, but you could probably work around it with something like
>> 
>> static char * fix_fgets(char *s, int n, FILE *stream) { return fgets(s, n, stream); }
>> #undef fgets
>> static char * fgets(char *s, int n, FILE *stream) { return fix_fgets(s, n, stream); }
>> 
>> Cheers,
>> Simon
> 
> like this? :http://bpaste.net/show/40047/
> if so, then i get this err msg:
> connections.c:385:15: error: static declaration of 'fgets' follows non-static declaration
> /usr/include/stdio.h:544:14: note: previous declaration of 'fgets' was here
> connections.c: In function 'Rconn_fgetc':
> connections.c:3192:11: error: expected identifier before '(' token
> connections.c:3194:15: error: expected identifier before '(' token
> 
> and here is how it's declared in stdio.h on my system:
> 
> /* Get a newline-terminated string of finite length from STREAM.
> 
>   This function is a possible cancellation point and therefore not
>   marked with __THROW.  */
> extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream)
>     __wur;


Perhaps I'm confused, but how did either of you expect to fix a problem with fgetc by modifying fgets???

-- 
Peter Dalgaard, Professor
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From simon.urbanek at r-project.org  Tue Aug 14 14:18:25 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 14 Aug 2012 08:18:25 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
	<20120813182240.GA30033@wall.e>
	<5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>
Message-ID: <B0F4FADC-6694-41B2-900C-25B26C8DD68E@r-project.org>

Ouch - typo, misread ...

Sent from my iPhone

On Aug 14, 2012, at 7:48 AM, peter dalgaard <pdalgd at gmail.com> wrote:

> 
> On Aug 13, 2012, at 20:22 , nobody wrote:
> 
>> On Mon, Aug 13, 2012 at 10:49:26AM -0400, Simon Urbanek wrote:
>>> I suspect that your runtime/libc is defining fgetc as a macro which breaks any code that uses it as an identifier. Ideally, your runtime should be fixed to use a proper function, but you could probably work around it with something like
>>> 
>>> static char * fix_fgets(char *s, int n, FILE *stream) { return fgets(s, n, stream); }
>>> #undef fgets
>>> static char * fgets(char *s, int n, FILE *stream) { return fix_fgets(s, n, stream); }
>>> 
>>> Cheers,
>>> Simon
>> 
>> like this? :http://bpaste.net/show/40047/
>> if so, then i get this err msg:
>> connections.c:385:15: error: static declaration of 'fgets' follows non-static declaration
>> /usr/include/stdio.h:544:14: note: previous declaration of 'fgets' was here
>> connections.c: In function 'Rconn_fgetc':
>> connections.c:3192:11: error: expected identifier before '(' token
>> connections.c:3194:15: error: expected identifier before '(' token
>> 
>> and here is how it's declared in stdio.h on my system:
>> 
>> /* Get a newline-terminated string of finite length from STREAM.
>> 
>>  This function is a possible cancellation point and therefore not
>>  marked with __THROW.  */
>> extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream)
>>    __wur;
> 
> 
> Perhaps I'm confused, but how did either of you expect to fix a problem with fgetc by modifying fgets???
> 
> -- 
> Peter Dalgaard, Professor
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> 
> 


From darwinskernel at gmail.com  Tue Aug 14 16:19:55 2012
From: darwinskernel at gmail.com (nobody)
Date: Tue, 14 Aug 2012 10:19:55 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
	<20120813182240.GA30033@wall.e>
	<5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>
Message-ID: <20120814141955.GA492@wall.e>

On Tue, Aug 14, 2012 at 01:48:44PM +0200, peter dalgaard wrote:
> 
> Perhaps I'm confused, but how did either of you expect to fix a problem with fgetc by modifying fgets???
> 
> -- 
> Peter Dalgaard, Professor
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

i'm not well versed in C. do know how to fix this? or, as i gather, this
is not something trivial and it has to be fixed uclibc upstream?


From simon.urbanek at r-project.org  Tue Aug 14 16:32:22 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 14 Aug 2012 10:32:22 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <20120814141955.GA492@wall.e>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
	<20120813182240.GA30033@wall.e>
	<5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>
	<20120814141955.GA492@wall.e>
Message-ID: <6C27D1E7-D934-40AF-9EDE-24F8F3BE8DAD@r-project.org>


On Aug 14, 2012, at 10:19 AM, nobody wrote:

> On Tue, Aug 14, 2012 at 01:48:44PM +0200, peter dalgaard wrote:
>> 
>> Perhaps I'm confused, but how did either of you expect to fix a problem with fgetc by modifying fgets???
>> 
>> -- 
>> Peter Dalgaard, Professor
>> Center for Statistics, Copenhagen Business School
>> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>> Phone: (+45)38153501
>> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> 
> i'm not well versed in C. do know how to fix this? or, as i gather, this
> is not something trivial and it has to be fixed uclibc upstream?
> 

What Peter is saying that my fix was useless because I was talking about fgetc but fixed fgets: P
So the fix attempt should have been

static int fix_fgetc(FILE *stream) { return fgetc(stream); }
#undef fgetc
static int fgetc(FILE *stream) { return fix_fgetc(stream); }

It should still be fixed upstream because I don't think POSIX allows fgetc to be a macro.

Cheers,
Simon


From claudia.beleites at ipht-jena.de  Tue Aug 14 19:00:11 2012
From: claudia.beleites at ipht-jena.de (Claudia Beleites)
Date: Tue, 14 Aug 2012 19:00:11 +0200
Subject: [Rd] as.numeric and as.character with locale using comma as
	separator
Message-ID: <502A841B.9090307@ipht-jena.de>

Dear all,

summary:

My LC_NUMERIC is changed from C to de_DE by library (qtbase).
[which shouldn't happen according to the warning when setting it back
manually].
I posted an issue at their github repository, but maybe the behaviour is
a bit more of general interest.

However, if LC_NUMERIC is changed, as.character () uses the decimal
separator that belongs to LC_NUMERIC (and not options ()$OutDec as I
supposed).
as.double () (= as.numeric ()) doesn't, though.

That causes trouble with constructs like
as.numeric (as.character (x))

long version:

as.character seems to take into account my locale (de_DE) which uses
comma as decimal separator:

> x <- rnorm (3)
> x
[1] -0,004238328 -0,919358537 -1,654543297
> as.character(x)
[1] "-0,00423832753479965" "-0,919358536523751"   "-1,65454329680873"

whereas as.numeric () doesn't:

> as.numeric (as.character(x))
[1] NA NA NA
Warnmeldung:
NAs durch Umwandlung erzeugt

> as.numeric (gsub (",", ".", as.character(x)))
[1] -0,004238328 -0,919358537 -1,654543297


I did not see any mention in the help of as.numeric nor as.character of
this.

Note also the output of example (as.character):
> example (as.character)

as.chr> form <- y ~ a + b + c

as.chr> as.character(form)  ## length 3
[1] "~"         "y"         "a + b + c"

as.chr> deparse(form)       ## like the input
[1] "y ~ a + b + c"

as.chr> a0 <- 11/999          # has a repeating decimal representation

as.chr> (a1 <- as.character(a0))
[1] "0,011011011011011"

as.chr> format(a0, digits=16) # shows one more digit
[1] "0,01101101101101101"

as.chr> a2 <- as.numeric(a1)

as.chr> a2 - a0               # normally around -1e-17
[1] NA

as.chr> as.character(a2)      # normally different from a1
[1] NA

as.chr> print(c(a0, a2), digits = 16)
[1] 0,01101101101101101                  NA
Warnmeldung:
In eval(expr, envir, enclos) : NAs durch Umwandlung erzeugt

*session info*
> sessionInfo ()
R version 2.15.1 (2012-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
[1] de_DE.UTF-8

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] Hmisc_3.9-3      survival_2.36-14 plumbr_0.6.6     cranvas_0.8
[5] maps_2.2-6       scales_0.2.1     qtpaint_0.9.0    qtbase_1.0.5
[9] idendro_1.0

loaded via a namespace (and not attached):
 [1] cluster_1.14.2         colorspace_1.1-1       dichromat_1.2-4
 [4] grid_2.15.1            labeling_0.1           lattice_0.20-6
 [7] munsell_0.3            objectProperties_0.6.5 objectSignals_0.10.2
[10] plyr_1.7.1             RColorBrewer_1.0-5     SearchTrees_0.5.1
[13] stringr_0.6            tools_2.15.1           tourr_0.5.2


Note that

> options ()$OutDec
[1] "."

In fresh R sessions I have

locale:
 [1] LC_CTYPE=de_DE.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=de_DE.UTF-8        LC_COLLATE=de_DE.UTF-8
 [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=de_DE.UTF-8
 [7] LC_PAPER=C                 LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C

It seems qtbase is the culprit:

> x
[1] -0.2290188 -0.1884703  0.2507179
> library (qtbase)
> x
[1] -0,2290188 -0,1884703  0,2507179



After setting the numeric locale back to C:
> Sys.setlocale ("LC_NUMERIC", "C")
[1] "C"
Warnmeldung:
In Sys.setlocale("LC_NUMERIC", "C") :
  das Setzen von 'LC_NUMERIC' kann bewirken, dass R sich komisch benimmt

as.numeric (as.character (x)) works as supposed (also output has decimal
points again)


Best,

Claudia





-- 
Claudia Beleites
Spectroscopy/Imaging
Institute of Photonic Technology
Albert-Einstein-Str. 9
07745 Jena
Germany

email: claudia.beleites at ipht-jena.de
phone: +49 3641 206-133
fax:   +49 2641 206-399


From hadley at rice.edu  Tue Aug 14 22:30:26 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 14 Aug 2012 15:30:26 -0500
Subject: [Rd] chown, chgrp?
Message-ID: <CABdHhvHAOr1LmAQU2yadiZbykSmKDxyFtaDVAbeWnwhyVOCb8Q@mail.gmail.com>

Hi all,

Is there an R wrapper for chown/chgrp (a la Sys.chmod)?  I couldn't
find one with a few minutes of searching, but it seems like a curious
omission.

Thanks,

Hadley

-- 
Assistant Professor
Department of Statistics / Rice University
http://had.co.nz/


From darwinskernel at gmail.com  Wed Aug 15 03:11:19 2012
From: darwinskernel at gmail.com (nobody)
Date: Tue, 14 Aug 2012 21:11:19 -0400
Subject: [Rd] compile fails with x86_64-alpine-linux-uclibc-gcc
In-Reply-To: <6C27D1E7-D934-40AF-9EDE-24F8F3BE8DAD@r-project.org>
References: <20120813034532.GA17328@wall.e>
	<BE73D35E-4A05-4CCF-99DD-CB6715ECF9CF@r-project.org>
	<20120813182240.GA30033@wall.e>
	<5B4175AF-5EFE-45DE-9727-991C45FA891A@gmail.com>
	<20120814141955.GA492@wall.e>
	<6C27D1E7-D934-40AF-9EDE-24F8F3BE8DAD@r-project.org>
Message-ID: <20120815011118.GA6388@wall.e>

On Tue, Aug 14, 2012 at 10:32:22AM -0400, Simon Urbanek wrote:
> 
> On Aug 14, 2012, at 10:19 AM, nobody wrote:
> 
> > On Tue, Aug 14, 2012 at 01:48:44PM +0200, peter dalgaard wrote:
> >> 
> >> Perhaps I'm confused, but how did either of you expect to fix a problem with fgetc by modifying fgets???
> >> 
> >> -- 
> >> Peter Dalgaard, Professor
> >> Center for Statistics, Copenhagen Business School
> >> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> >> Phone: (+45)38153501
> >> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> > 
> > i'm not well versed in C. do know how to fix this? or, as i gather, this
> > is not something trivial and it has to be fixed uclibc upstream?
> > 
> 
> What Peter is saying that my fix was useless because I was talking about fgetc but fixed fgets: P
> So the fix attempt should have been
> 
> static int fix_fgetc(FILE *stream) { return fgetc(stream); }
> #undef fgetc
> static int fgetc(FILE *stream) { return fix_fgetc(stream); }
> 
> It should still be fixed upstream because I don't think POSIX allows fgetc to be a macro.
> 
> Cheers,
> Simon

thanks, 's:^static:extern:' and it works, well sort of. now compilation
gets stuck (waited 3 hours) here:

make[6]: Entering directory `/dev/shm/portage/dev-lang/R-2.15.1/work/R-2.15.1/src/library/tools/src'
mkdir -p -- ../../../../library/tools/libs
make[6]: Leaving directory `/dev/shm/portage/dev-lang/R-2.15.1/work/R-2.15.1/src/library/tools/src'
make[5]: Leaving directory `/dev/shm/portage/dev-lang/R-2.15.1/work/R-2.15.1/src/library/tools/src'
make[4]: Leaving directory `/dev/shm/portage/dev-lang/R-2.15.1/work/R-2.15.1/src/library/tools'

it's apparently running:
/dev/shm/portage/dev-lang/R-2.15.1/work/R-2.15.1/bin/exec/R --vinalla --slave
with 100% cpu usage! i don't what it's doing to be honest :) any idea?

p.s.: i'm attaching the patch to this for the curious, hope it helps.
-------------- next part --------------
--- src/main/connections.c.orig	2012-08-14 11:47:47.105203896 -0400
+++ src/main/connections.c	2012-08-14 11:50:49.103928599 -0400
@@ -378,6 +378,16 @@
     return res;
 }
 
+#ifdef __UCLIBC__
+	extern int fix_fgetc(FILE *stream) {
+		return fgetc(stream);
+		}
+	#undef fgetc
+	extern int fgetc(FILE *stream) {
+		return fix_fgetc(stream);
+		}
+#endif
+
 int dummy_fgetc(Rconnection con)
 {
     int c;

From b.rowlingson at lancaster.ac.uk  Wed Aug 15 09:49:04 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 15 Aug 2012 08:49:04 +0100
Subject: [Rd] chown, chgrp?
In-Reply-To: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
References: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>

On Tue, Aug 14, 2012 at 9:30 PM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> Is there an R wrapper for chown/chgrp (a la Sys.chmod)?  I couldn't
> find one with a few minutes of searching, but it seems like a curious
> omission.

 A recursive grep of an R-dev source tree I had lying around couldn't
find one in a few seconds.

 I'm not sure its a 'curious' omission, since its something normal
users[1] can't do, and who runs R as root?

Barry

[1] Or at least normal normal users. There might be special normal
users with certain chown permissions...


From Karline.Soetaert at nioz.nl  Wed Aug 15 12:25:20 2012
From: Karline.Soetaert at nioz.nl (Karline Soetaert)
Date: Wed, 15 Aug 2012 10:25:20 +0000
Subject: [Rd] question concerning par("plt") and par("mar")
Message-ID: <16E8A83CA5AB9D4DB5601EADCE4042ADF5B1DA@HYDRA.nioz.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120815/77b097a3/attachment.pl>

From simon.urbanek at r-project.org  Wed Aug 15 15:47:44 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 15 Aug 2012 09:47:44 -0400
Subject: [Rd] chown, chgrp?
In-Reply-To: <CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>
References: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
	<CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>
Message-ID: <AF022C38-127C-4B50-A45F-290100D88088@r-project.org>


On Aug 15, 2012, at 3:49 AM, Barry Rowlingson <B.Rowlingson at lancaster.ac.uk> wrote:

> On Tue, Aug 14, 2012 at 9:30 PM, Hadley Wickham <hadley at rice.edu> wrote:
>> Hi all,
>> 
>> Is there an R wrapper for chown/chgrp (a la Sys.chmod)?  I couldn't
>> find one with a few minutes of searching, but it seems like a curious
>> omission.
> 
> A recursive grep of an R-dev source tree I had lying around couldn't
> find one in a few seconds.
> 
> I'm not sure its a 'curious' omission, since its something normal
> users[1] can't do, and who runs R as root?
> 
> Barry
> 
> [1] Or at least normal normal users. There might be special normal
> users with certain chown permissions...
> 

... and moreover with the increasing adoption of ACL on unix and non-existence of uid/gid on Windows this is more an archaic curiosity so I don't think it makes sense to add it at this point.

Cheers,
Simon


From chiefmurphy at gmail.com  Wed Aug 15 16:54:04 2012
From: chiefmurphy at gmail.com (Dan Murphy)
Date: Wed, 15 Aug 2012 07:54:04 -0700
Subject: [Rd] Build from Source fails on Loading required package Matrix
Message-ID: <CAHgH9_Gj9VfLY+2OVgnfzHUhSAL6_f7FRc_Da4Bjc54dTd9bpA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120815/fcaf3591/attachment.pl>

From simon.urbanek at r-project.org  Wed Aug 15 17:04:15 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 15 Aug 2012 11:04:15 -0400
Subject: [Rd] Build from Source fails on Loading required package Matrix
In-Reply-To: <CAHgH9_Gj9VfLY+2OVgnfzHUhSAL6_f7FRc_Da4Bjc54dTd9bpA@mail.gmail.com>
References: <CAHgH9_Gj9VfLY+2OVgnfzHUhSAL6_f7FRc_Da4Bjc54dTd9bpA@mail.gmail.com>
Message-ID: <E33FE84A-D342-4B8B-83FB-C281E10AAAC2@r-project.org>

Dan,

On Aug 15, 2012, at 10:54 AM, Dan Murphy <chiefmurphy at gmail.com> wrote:

> Hello:
> 
> I am building R 2.15.1 from source on a Windows 7 machine with the x64
> toolset, MixTeX, and InnoSetup per
> http://cran.r-project.org/bin/windows/Rtools/. I obtained the source for
> 2.15.1 via svn from https://svn.r-project.org/R/branches/R-2-15-branch/.

Did you also rsync the recommended packages? They are not in the SVN. If in doubt, use released source tar balls.

Cheers,
Simon



> This is my first try building R from source. The build seems to go far,
> then terminates with "undefined exports: .M.classEnv" from the Matrix
> package, I believe. Here are the last few lines of the build session
> 
> Creating a generic function for 'qr.resid' from package 'base' in package
> 'Matrix'
> Creating a generic function for 'qr.fitted' from package 'base' in package
> 'Matrix'
> ** help
> *** installing help indices
> ** building package indices
> Loading required package: Matrix
> Error in namespaceExport(ns, exports) : undefined exports: .M.classEnv
> Error : require(Matrix) is not TRUE
> ERROR: installing package indices failed
> * removing 'C:/Users/Dan/Documents/R-2.15.1/library/Matrix'
> make[1]: *** [Matrix.ts] Error 1
> make: *** [recommended] Error 2
> 
> Perhaps there are special settings I should be making in MkRules.local? My
> only modification was MULTI = 64.
> 
> Thanks in advance for your help.
> 
> Dan Murphy
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From chiefmurphy at gmail.com  Wed Aug 15 17:53:36 2012
From: chiefmurphy at gmail.com (Dan Murphy)
Date: Wed, 15 Aug 2012 08:53:36 -0700
Subject: [Rd] Build from Source fails on Loading required package Matrix
In-Reply-To: <E33FE84A-D342-4B8B-83FB-C281E10AAAC2@r-project.org>
References: <CAHgH9_Gj9VfLY+2OVgnfzHUhSAL6_f7FRc_Da4Bjc54dTd9bpA@mail.gmail.com>
	<E33FE84A-D342-4B8B-83FB-C281E10AAAC2@r-project.org>
Message-ID: <CAHgH9_FbbUz2oz6a9a4FspZLZTNrLf81aHcm4Ra18_sLUX_gDw@mail.gmail.com>

On Wed, Aug 15, 2012 at 8:04 AM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> Dan,
>
> On Aug 15, 2012, at 10:54 AM, Dan Murphy <chiefmurphy at gmail.com> wrote:
>
> > Hello:
> >
> > I am building R 2.15.1 from source on a Windows 7 machine with the x64
> > toolset, MixTeX, and InnoSetup per
> > http://cran.r-project.org/bin/windows/Rtools/. I obtained the source for
> > 2.15.1 via svn from https://svn.r-project.org/R/branches/R-2-15-branch/.
>
> Did you also rsync the recommended packages? They are not in the SVN. If
> in doubt, use released source tar balls.
>
> Cheers,
> Simon
>
Thanks, Simon. I should have mentioned that as well. Yes, I did "make
rsync-recommended" per Chapter 3 of the manual and that worked without
error.

I first inadvertently had tried to build the 2.16 version in /trunk
and got that "undefined exports" error, then switched to the
/R-2-15-branch when I realized /trunk held the development version.

In between the two svn checkouts, I had tried the source tar ball at
the link  R-2.15.1.tar.gz. That terminated much sooner in the build,
which I thought could have resulted from me using 7-Zip on the tar
ball (lacking a windows version of your tar), so I went back to the
subversion checkout method.

>
>
> > This is my first try building R from source. The build seems to go far,
> > then terminates with "undefined exports: .M.classEnv" from the Matrix
> > package, I believe. Here are the last few lines of the build session
> >
> > Creating a generic function for 'qr.resid' from package 'base' in
> > package
> > 'Matrix'
> > Creating a generic function for 'qr.fitted' from package 'base' in
> > package
> > 'Matrix'
> > ** help
> > *** installing help indices
> > ** building package indices
> > Loading required package: Matrix
> > Error in namespaceExport(ns, exports) : undefined exports: .M.classEnv
> > Error : require(Matrix) is not TRUE
> > ERROR: installing package indices failed
> > * removing 'C:/Users/Dan/Documents/R-2.15.1/library/Matrix'
> > make[1]: *** [Matrix.ts] Error 1
> > make: *** [recommended] Error 2
> >
> > Perhaps there are special settings I should be making in MkRules.local?
> > My
> > only modification was MULTI = 64.
> >
> > Thanks in advance for your help.
> >
> > Dan Murphy
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
>


From b.rowlingson at lancaster.ac.uk  Wed Aug 15 17:56:30 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 15 Aug 2012 16:56:30 +0100
Subject: [Rd] chown, chgrp?
In-Reply-To: <415bee7f03374ec289c9ccb6c354aa7c@EX-1-HT0.lancs.local>
References: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
	<CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>
	<415bee7f03374ec289c9ccb6c354aa7c@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>

On Wed, Aug 15, 2012 at 2:47 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:

>
> ... and moreover with the increasing adoption of ACL on unix and non-existence of uid/gid on Windows this is more an archaic curiosity so I don't think it makes sense to add it at this point.
>

 It does however raise the question, "What is Hadley up to now?" :)

Barry


From gregory.warnes at novartis.com  Wed Aug 15 18:01:09 2012
From: gregory.warnes at novartis.com (Warnes, Gregory)
Date: Wed, 15 Aug 2012 16:01:09 +0000
Subject: [Rd] chown, chgrp?
In-Reply-To: <CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>
Message-ID: <0CAEE2B1235DF643B0F5E1EAE1487B5309439C93@023-CH1MPN1-043.023d.mgd.msft.net>


setgid, at least, can be useful for non-root users who wish to share files
with folks in a different group than is their default...


-- 
Gregory Warnes, Ph.D.
Sr. Expert Modeler
Modeling and Simulation
CA Phone: +1 617 871-8498
gregory.warnes at novartis.com







On 8/15/12 11:56 AM, "Barry Rowlingson" <b.rowlingson at lancaster.ac.uk>
wrote:

>On Wed, Aug 15, 2012 at 2:47 PM, Simon Urbanek
><simon.urbanek at r-project.org> wrote:
>
>>
>> ... and moreover with the increasing adoption of ACL on unix and
>>non-existence of uid/gid on Windows this is more an archaic curiosity so
>>I don't think it makes sense to add it at this point.
>>
>
> It does however raise the question, "What is Hadley up to now?" :)
>
>Barry
>
>______________________________________________
>R-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Wed Aug 15 18:06:16 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 15 Aug 2012 18:06:16 +0200
Subject: [Rd] Build from Source fails on Loading required package Matrix
In-Reply-To: <CAHgH9_FbbUz2oz6a9a4FspZLZTNrLf81aHcm4Ra18_sLUX_gDw@mail.gmail.com>
References: <CAHgH9_Gj9VfLY+2OVgnfzHUhSAL6_f7FRc_Da4Bjc54dTd9bpA@mail.gmail.com>
	<E33FE84A-D342-4B8B-83FB-C281E10AAAC2@r-project.org>
	<CAHgH9_FbbUz2oz6a9a4FspZLZTNrLf81aHcm4Ra18_sLUX_gDw@mail.gmail.com>
Message-ID: <502BC8F8.30400@statistik.tu-dortmund.de>



On 15.08.2012 17:53, Dan Murphy wrote:
> On Wed, Aug 15, 2012 at 8:04 AM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>>
>> Dan,
>>
>> On Aug 15, 2012, at 10:54 AM, Dan Murphy <chiefmurphy at gmail.com> wrote:
>>
>>> Hello:
>>>
>>> I am building R 2.15.1 from source on a Windows 7 machine with the x64
>>> toolset, MixTeX, and InnoSetup per
>>> http://cran.r-project.org/bin/windows/Rtools/. I obtained the source for
>>> 2.15.1 via svn from https://svn.r-project.org/R/branches/R-2-15-branch/.
>>
>> Did you also rsync the recommended packages? They are not in the SVN. If
>> in doubt, use released source tar balls.
>>
>> Cheers,
>> Simon
>>
> Thanks, Simon. I should have mentioned that as well. Yes, I did "make
> rsync-recommended" per Chapter 3 of the manual and that worked without
> error.
>
> I first inadvertently had tried to build the 2.16 version in /trunk
> and got that "undefined exports" error, then switched to the
> /R-2-15-branch when I realized /trunk held the development version.
>
> In between the two svn checkouts, I had tried the source tar ball at
> the link  R-2.15.1.tar.gz. That terminated much sooner in the build,
> which I thought could have resulted from me using 7-Zip on the tar
> ball (lacking a windows version of your tar), so I went back to the
> subversion checkout method.

Please read the R Installation and Administration manual that explains 
how to set up your environment under Windows to build R yourself and 
what tools are needed. Note that a binary is available from CRAN.

Uwe Ligges


>
>>
>>
>>> This is my first try building R from source. The build seems to go far,
>>> then terminates with "undefined exports: .M.classEnv" from the Matrix
>>> package, I believe. Here are the last few lines of the build session
>>>
>>> Creating a generic function for 'qr.resid' from package 'base' in
>>> package
>>> 'Matrix'
>>> Creating a generic function for 'qr.fitted' from package 'base' in
>>> package
>>> 'Matrix'
>>> ** help
>>> *** installing help indices
>>> ** building package indices
>>> Loading required package: Matrix
>>> Error in namespaceExport(ns, exports) : undefined exports: .M.classEnv
>>> Error : require(Matrix) is not TRUE
>>> ERROR: installing package indices failed
>>> * removing 'C:/Users/Dan/Documents/R-2.15.1/library/Matrix'
>>> make[1]: *** [Matrix.ts] Error 1
>>> make: *** [recommended] Error 2
>>>
>>> Perhaps there are special settings I should be making in MkRules.local?
>>> My
>>> only modification was MULTI = 64.
>>>
>>> Thanks in advance for your help.
>>>
>>> Dan Murphy
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From pdalgd at gmail.com  Wed Aug 15 19:38:17 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 15 Aug 2012 19:38:17 +0200
Subject: [Rd] chown, chgrp?
In-Reply-To: <CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>
References: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
	<CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>
	<415bee7f03374ec289c9ccb6c354aa7c@EX-1-HT0.lancs.local>
	<CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>
Message-ID: <8AF89154-2B1E-4D57-B8E6-BDF855939CD3@gmail.com>


On Aug 15, 2012, at 17:56 , Barry Rowlingson wrote:

> On Wed, Aug 15, 2012 at 2:47 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
> 
>> 
>> ... and moreover with the increasing adoption of ACL on unix and non-existence of uid/gid on Windows this is more an archaic curiosity so I don't think it makes sense to add it at this point.
>> 
> 
> It does however raise the question, "What is Hadley up to now?" :)

Aiming for the fortune file again, Barry?

Anyways, since it is not portable anyway, what was ever wrong with 

system(sprintf("chown %s %s", foo, bar)

?

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From jeff.a.ryan at gmail.com  Wed Aug 15 21:36:17 2012
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 15 Aug 2012 14:36:17 -0500
Subject: [Rd] chown, chgrp?
In-Reply-To: <CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>
References: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
	<CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>
	<415bee7f03374ec289c9ccb6c354aa7c@EX-1-HT0.lancs.local>
	<CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>
Message-ID: <CABDUZc_KwuJubAw77+JbLNLTeDt=BLzZeb3xCg7zVPyAB8-hOA@mail.gmail.com>

library(pwned)?

On Wed, Aug 15, 2012 at 10:56 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Wed, Aug 15, 2012 at 2:47 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>
>>
>> ... and moreover with the increasing adoption of ACL on unix and non-existence of uid/gid on Windows this is more an archaic curiosity so I don't think it makes sense to add it at this point.
>>
>
>  It does however raise the question, "What is Hadley up to now?" :)
>
> Barry
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From rmh at temple.edu  Thu Aug 16 05:05:32 2012
From: rmh at temple.edu (Richard M. Heiberger)
Date: Wed, 15 Aug 2012 23:05:32 -0400
Subject: [Rd] warning in lattice key function
Message-ID: <CAGx1TMC_L9OV4SjYvnvoGJ2F-6+MhkD8eZ5eTbmQgQ5UMQY69w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120815/c9f16f44/attachment.pl>

From ripley at stats.ox.ac.uk  Thu Aug 16 07:59:58 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Aug 2012 06:59:58 +0100
Subject: [Rd] warning in lattice key function
In-Reply-To: <CAGx1TMC_L9OV4SjYvnvoGJ2F-6+MhkD8eZ5eTbmQgQ5UMQY69w@mail.gmail.com>
References: <CAGx1TMC_L9OV4SjYvnvoGJ2F-6+MhkD8eZ5eTbmQgQ5UMQY69w@mail.gmail.com>
Message-ID: <502C8C5E.40609@stats.ox.ac.uk>

This is not the address for the maintainer of package 'lattice': what 
did he say when you asked him (see the posting guide)?

(Because I reported it some weeks back, I know he agrees it is a bug in 
lattice and will be fixed in the next release.)

On 16/08/2012 04:05, Richard M. Heiberger wrote:
> ## this example shows a problem in key.
> tmp <- data.frame(y=rnorm(10), g=rep(ordered(c("A","B")), 5))
> bwplot(y ~ g, data=tmp,
>         key=list(
>           text=list(c("A","B"), col=c("blue","red")),
>           points=list(pch=c(17, 16), col=c("blue","red")),
>           space="top", columns=2, border=TRUE,
>           title="Treatment", cex.title=.9
>           )
>         )
> ## The example works without warning messages in 2.15.1.
> ## I first detected the problem in
> ##### R Under development (unstable) (2012-07-24 r59961) ## windows
> ##### R Under development (unstable) (2012-08-02 r60091) ## macintosh
> ## The problem still exists in
> ## R Under development (unstable) (2012-08-13 r60245) -- "Unsuffered
> Consequences"
> ## downloaded from lib.stat.cmu.edu Wed Aug 15 2012 11PM EST
>
>
>> tmp <- data.frame(y=rnorm(10), g=rep(ordered(c("A","B")), 5))
>> bwplot(y ~ g, data=tmp,
> +        key=list(
> +          text=list(c("A","B"), col=c("blue","red")),
> +          points=list(pch=c(17, 16), col=c("blue","red")),
> +          space="top", columns=2, border=TRUE,
> +          title="Treatment", cex.title=.9
> +          )
> +        )
> Warning messages:
> 1: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 2: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 3: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 4: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 5: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
>> version
>                 _
> platform       i386-w64-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status         Under development (unstable)
> major          2
> minor          16.0
> year           2012
> month          08
> day            13
> svn rev        60245
> language       R
> version.string R Under development (unstable) (2012-08-13 r60245)
> nickname       Unsuffered Consequences
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From chiefmurphy at gmail.com  Thu Aug 16 17:52:14 2012
From: chiefmurphy at gmail.com (Dan Murphy)
Date: Thu, 16 Aug 2012 08:52:14 -0700
Subject: [Rd] Build from Source fails on Loading required package Matrix
In-Reply-To: <502BC8F8.30400@statistik.tu-dortmund.de>
References: <CAHgH9_Gj9VfLY+2OVgnfzHUhSAL6_f7FRc_Da4Bjc54dTd9bpA@mail.gmail.com>
	<E33FE84A-D342-4B8B-83FB-C281E10AAAC2@r-project.org>
	<CAHgH9_FbbUz2oz6a9a4FspZLZTNrLf81aHcm4Ra18_sLUX_gDw@mail.gmail.com>
	<502BC8F8.30400@statistik.tu-dortmund.de>
Message-ID: <CAHgH9_EVF49evup=XBbWthP1o5vh17Oo-++rM-d-H-Q96z5F_Q@mail.gmail.com>

Uwe:

Thanks to your gentle nudge I reread the manual and learned that your
preferred version of tar is installed by Rtools. After a little glitch
and a July 2 R-help post about a missing file in the tarball, I was
able to build the patched version of 2.15.1. The work y'all do is
beyond words. In case anyone is interested in the steps I took, here
they are:

Building R-2.15.1 64-bit from Source on Windows

?R_Admin? will refer to the R Installation and Administration manual.

Getting the Tools
Per Appendix D of R_Admin I downloaded and installed Rtools215.exe
from the link at the beginning of that appendix, MiKTeX, and Inno. The
installation of RTools automatically set the system version of the
PATH variable so that the necessary folders for building R are given
in the preferred order. On my machine the RTools were placed in the
C:\RTools folder. Per section 3.1.1 of R_Admin, RTools also installed
?extra files? in C:\R and C:\R64 ?- more below.

Getting the Source
The 2.15.1 tarball on CRAN?s home has an issue with a missing file
(per R-help post on 2012-07-02) so I got the most recent patched
version per the instructions of section 1.2 of R_Admin by clicking on
last night?s ?R-patched?? link at the indicated ftp site. I made a
directory in C:\Program Files called R-2.15.1 ?- my Windows id has
Administrator privileges ?- and placed the tarball into that folder.

Unpacking
I used Rtools' tar to unpack the tarball by opening a command window
with Administrator privileges (right click, Run as Administrator),
navigating to C:\Program Files\R-2.15.1, and then running tar on the
tarball with the ?--no-same-owner? option per section 3.1.2 of
R_Admin. tar automatically created an R-patched subdirectory within
C:\Program Files\R-2.15.1 and placed all the files there. Thus, R_HOME
in R_Admin was equivalent to C:\Program Files\R 2.15.1\R patched for
this build.

Getting the Tools (continued): ?the extra files?
Per the last two bullets of R_Admin section 3.1.2, I copied the \Tcl
subdirectory from C:\R64 (because I?m building the 64-bit version) to
C:\Program Files\R-2.15.1\R-patched and copied the three folders in
C:\R64\src\gnuwin32\bitmap to the directory C:\Program
Files\R-2.15.1\R-patched\src\gnuwin32\bitmap.

MkRules.local
Per R_Admin 3.1.3, I made a copy of MkRules.dist and made the following changes
MkRules.dist	  MkRules.local
MULTI = 	  MULTI = 64
# JPEGDIR	  JPEGDIR
# PNGDIR	  PNGDIR
# TIFFDIR	  TIFFDIR

Building the core files
My C:\Temp directory can be written to by almost everyone, so, per
section 3.1.3, in the still open command window I set the TMPDIR
variable to that folder by SET TMPDIR=C:\Temp. Then ?make all
recommended? ran without error. C:\Program
Files\R-2.15.1\R-patched\bin\x64\Rgui.exe worked.

Thanks again!
Dan

On Wed, Aug 15, 2012 at 9:06 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> On 15.08.2012 17:53, Dan Murphy wrote:
>>
>> On Wed, Aug 15, 2012 at 8:04 AM, Simon Urbanek
>> <simon.urbanek at r-project.org> wrote:
>>>
>>>
>>> Dan,
>>>
>>> On Aug 15, 2012, at 10:54 AM, Dan Murphy <chiefmurphy at gmail.com> wrote:
>>>
>>>> Hello:
>>>>
>>>> I am building R 2.15.1 from source on a Windows 7 machine with the x64
>>>> toolset, MixTeX, and InnoSetup per
>>>> http://cran.r-project.org/bin/windows/Rtools/. I obtained the source for
>>>> 2.15.1 via svn from https://svn.r-project.org/R/branches/R-2-15-branch/.
>>>
>>>
>>> Did you also rsync the recommended packages? They are not in the SVN. If
>>> in doubt, use released source tar balls.
>>>
>>> Cheers,
>>> Simon
>>>
>> Thanks, Simon. I should have mentioned that as well. Yes, I did "make
>> rsync-recommended" per Chapter 3 of the manual and that worked without
>> error.
>>
>> I first inadvertently had tried to build the 2.16 version in /trunk
>> and got that "undefined exports" error, then switched to the
>> /R-2-15-branch when I realized /trunk held the development version.
>>
>> In between the two svn checkouts, I had tried the source tar ball at
>> the link  R-2.15.1.tar.gz. That terminated much sooner in the build,
>> which I thought could have resulted from me using 7-Zip on the tar
>> ball (lacking a windows version of your tar), so I went back to the
>> subversion checkout method.
>
>
> Please read the R Installation and Administration manual that explains how
> to set up your environment under Windows to build R yourself and what tools
> are needed. Note that a binary is available from CRAN.
>
> Uwe Ligges
>
>
>
>>
>>>
>>>
>>>> This is my first try building R from source. The build seems to go far,
>>>> then terminates with "undefined exports: .M.classEnv" from the Matrix
>>>> package, I believe. Here are the last few lines of the build session
>>>>
>>>> Creating a generic function for 'qr.resid' from package 'base' in
>>>> package
>>>> 'Matrix'
>>>> Creating a generic function for 'qr.fitted' from package 'base' in
>>>> package
>>>> 'Matrix'
>>>> ** help
>>>> *** installing help indices
>>>> ** building package indices
>>>> Loading required package: Matrix
>>>> Error in namespaceExport(ns, exports) : undefined exports: .M.classEnv
>>>> Error : require(Matrix) is not TRUE
>>>> ERROR: installing package indices failed
>>>> * removing 'C:/Users/Dan/Documents/R-2.15.1/library/Matrix'
>>>> make[1]: *** [Matrix.ts] Error 1
>>>> make: *** [recommended] Error 2
>>>>
>>>> Perhaps there are special settings I should be making in MkRules.local?
>>>> My
>>>> only modification was MULTI = 64.
>>>>
>>>> Thanks in advance for your help.
>>>>
>>>> Dan Murphy
>>>>
>>>>        [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From ripley at stats.ox.ac.uk  Thu Aug 16 18:37:02 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Aug 2012 17:37:02 +0100
Subject: [Rd] chown, chgrp?
In-Reply-To: <8AF89154-2B1E-4D57-B8E6-BDF855939CD3@gmail.com>
References: <5030f2bade32483bb1b6d34284a54dc9@EX-1-HT0.lancs.local>
	<CANVKczNxodiW2YUiebV4w=KWMXBSEN22OkF1N5_mXASX-WDqMg@mail.gmail.com>
	<415bee7f03374ec289c9ccb6c354aa7c@EX-1-HT0.lancs.local>
	<CANVKczMzNRif2xU2KtsPHFe7hzRrS6QX+rAYL+6KmMv14Yw0jQ@mail.gmail.com>
	<8AF89154-2B1E-4D57-B8E6-BDF855939CD3@gmail.com>
Message-ID: <502D21AE.9030406@stats.ox.ac.uk>

On 15/08/2012 18:38, peter dalgaard wrote:
>
> On Aug 15, 2012, at 17:56 , Barry Rowlingson wrote:
>
>> On Wed, Aug 15, 2012 at 2:47 PM, Simon Urbanek
>> <simon.urbanek at r-project.org> wrote:
>>
>>>
>>> ... and moreover with the increasing adoption of ACL on unix and non-existence of uid/gid on Windows this is more an archaic curiosity so I don't think it makes sense to add it at this point.
>>>
>>
>> It does however raise the question, "What is Hadley up to now?" :)
>
> Aiming for the fortune file again, Barry?
>
> Anyways, since it is not portable anyway, what was ever wrong with
>
> system(sprintf("chown %s %s", foo, bar)
>
> ?

Yes, that is the point. I added Sys.chmod because R's own scripts needed 
something portable (both to Windows, and later in the handling of umask 
where POSIX allows some wiggle room).  We've never needed chown/chgrp.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From moshersteven at gmail.com  Thu Aug 16 23:08:09 2012
From: moshersteven at gmail.com (steven mosher)
Date: Thu, 16 Aug 2012 14:08:09 -0700
Subject: [Rd] Compressing data for package builds
Message-ID: <CAFFLneTpp4kjRjuA21ORyo649vycgwJt81BDXDAFLRm5vE7p_Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120816/76d7a3d2/attachment.pl>

From simon.urbanek at r-project.org  Fri Aug 17 02:48:16 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 16 Aug 2012 20:48:16 -0400
Subject: [Rd] Compressing data for package builds
In-Reply-To: <CAFFLneTpp4kjRjuA21ORyo649vycgwJt81BDXDAFLRm5vE7p_Q@mail.gmail.com>
References: <CAFFLneTpp4kjRjuA21ORyo649vycgwJt81BDXDAFLRm5vE7p_Q@mail.gmail.com>
Message-ID: <19D68B47-B1D5-422F-A86E-00147521B40B@r-project.org>


On Aug 16, 2012, at 5:08 PM, steven mosher wrote:

> Hi,
> 
> I have two  .rda files that I need to include in a package.  I've placed
> them both in a data directory
> after  save()  the are around  150Kb  each.
> 
> When I try to check the package I get the following warning
> 
> Warning: large data file(s) saved inefficiently:
>                size ASCII compress
>  zagoskin.rda 137Kb FALSE     none
> 
>  Note: significantly better compression could be obtained
>        by using R CMD build --resave-data
>               old_size new_size compress
>  modpoll.rda     124Kb     78Kb       xz
>  zagoskin.rda    137Kb      6Kb    bzip2
> 
> Both of these files modpoll.rda and zagoskin.rda  have already been
> compressed from megabytes down to Kb.
> 
> Also,, the  instructions    "R CMD build --resave-data"  doesnt do anything
> that I can see so I must be using it wrong.

R CMD build is how you preferably should be creating your package tar ball, so you simply add the --resave-data argument to your already existing R CMD build call which creates the tar ball from your source directory. So can you elaborate on "doesn't do anything I can see"? In what sense? No output? No compression?

Cheers,
Simon


> Is there a piece of the puzzle I am missing or instructions better than
> these: I tried  LazyDataCompression and my
> data.rdb is 90Kb.
> 
> "Package *tools* has a couple of functions to help with data images:
> checkRdaFiles reports on the way the image was saved, and resaveRdaFiles will
> re-save with a different type of compression, including choosing the best
> type for that particular image.
> 
> Some packages using ?LazyData? will benefit from using a form of
> compression other than gzip in the installed lazy-loading database. This
> can be selected by the --data-compress option to R CMD INSTALL or by using
> the ?LazyDataCompression? field in the DESCRIPTION file. Useful values are
> bzip2, xz and the default, gzip. The only way to discover which is best is
> to try them all and look at the size of the pkgname/data/Rdata.rdb file."
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From moshersteven at gmail.com  Fri Aug 17 07:24:16 2012
From: moshersteven at gmail.com (steven mosher)
Date: Thu, 16 Aug 2012 22:24:16 -0700
Subject: [Rd] Compressing data for package builds
In-Reply-To: <19D68B47-B1D5-422F-A86E-00147521B40B@r-project.org>
References: <CAFFLneTpp4kjRjuA21ORyo649vycgwJt81BDXDAFLRm5vE7p_Q@mail.gmail.com>
	<19D68B47-B1D5-422F-A86E-00147521B40B@r-project.org>
Message-ID: <CAFFLneSCun2cHV7K6x-ccrHnXbWqJRTB_p3O9eLY_7iWKbGhOg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120816/60ad73c5/attachment.pl>

From ligges at statistik.tu-dortmund.de  Fri Aug 17 12:01:33 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 17 Aug 2012 12:01:33 +0200
Subject: [Rd] Compressing data for package builds
In-Reply-To: <CAFFLneSCun2cHV7K6x-ccrHnXbWqJRTB_p3O9eLY_7iWKbGhOg@mail.gmail.com>
References: <CAFFLneTpp4kjRjuA21ORyo649vycgwJt81BDXDAFLRm5vE7p_Q@mail.gmail.com>
	<19D68B47-B1D5-422F-A86E-00147521B40B@r-project.org>
	<CAFFLneSCun2cHV7K6x-ccrHnXbWqJRTB_p3O9eLY_7iWKbGhOg@mail.gmail.com>
Message-ID: <502E167D.3020402@statistik.tu-dortmund.de>



On 17.08.2012 07:24, steven mosher wrote:
> " R CMD build is how you preferably should be creating your package tar
> ball, so you simply add the --resave-data argument to your already existing
> R CMD build call which creates the tar ball from your source directory. So
> can you elaborate on "doesn't do anything I can see"? In what sense? No
> output? No compression? "
>
> my tarball builds with   > R CDM build mattools
>
> where mattools is the name of the package. and I get a warning on R CMD
> check.
>
> Things I tried
>
> R CMD build --resave-data
> R CMD build mattools --resave-data
> R CMD build --resave-data mattools
>
> The first does nothing, the second fails on unknown options and the third
> fails on unknown options. So I  found the help for R CMD
>
> Now that I figured out how to display help for  R CMD build  I see that
>
> --resave-data   must include a specification of the type of compression
>
> --resave-data="best"   for example
>
> I ran that.  and got the same error indicating that the   rda file had not
> been compressed.
>
>   checking data for non-ASCII characters ... OK
> * checking data for ASCII and uncompressed saves ... WARNING
>    Warning: large data file(s) saved inefficiently:
>                  size ASCII compress
>    zagoskin.rda 137Kb FALSE     none
>
>    Note: significantly better compression could be obtained
>          by using R CMD build --resave-data
>                 old_size new_size compress
>    modpoll.rda     124Kb     78Kb       xz
>    zagoskin.rda    137Kb      6Kb    bzip2
>
> Building under windows so I wonder if I am missing a system file required
> to do the compression.



Are you checking the tarball (as recommended) or the source dir? The 
compressed versions are in the tarball. The source dir is not changed.

Uwe Liges






>
> On Thu, Aug 16, 2012 at 5:48 PM, Simon Urbanek
> <simon.urbanek at r-project.org>wrote:
>
>>
>> On Aug 16, 2012, at 5:08 PM, steven mosher wrote:
>>
>>> Hi,
>>>
>>> I have two  .rda files that I need to include in a package.  I've placed
>>> them both in a data directory
>>> after  save()  the are around  150Kb  each.
>>>
>>> When I try to check the package I get the following warning
>>>
>>> Warning: large data file(s) saved inefficiently:
>>>                 size ASCII compress
>>>   zagoskin.rda 137Kb FALSE     none
>>>
>>>   Note: significantly better compression could be obtained
>>>         by using R CMD build --resave-data
>>>                old_size new_size compress
>>>   modpoll.rda     124Kb     78Kb       xz
>>>   zagoskin.rda    137Kb      6Kb    bzip2
>>>
>>> Both of these files modpoll.rda and zagoskin.rda  have already been
>>> compressed from megabytes down to Kb.
>>>
>>> Also,, the  instructions    "R CMD build --resave-data"  doesnt do
>> anything
>>> that I can see so I must be using it wrong.
>>
>> R CMD build is how you preferably should be creating your package tar
>> ball, so you simply add the --resave-data argument to your already existing
>> R CMD build call which creates the tar ball from your source directory. So
>> can you elaborate on "doesn't do anything I can see"? In what sense? No
>> output? No compression?
>>
>> Cheers,
>> Simon
>>
>>
>>> Is there a piece of the puzzle I am missing or instructions better than
>>> these: I tried  LazyDataCompression and my
>>> data.rdb is 90Kb.
>>>
>>> "Package *tools* has a couple of functions to help with data images:
>>> checkRdaFiles reports on the way the image was saved, and resaveRdaFiles
>> will
>>> re-save with a different type of compression, including choosing the best
>>> type for that particular image.
>>>
>>> Some packages using ?LazyData? will benefit from using a form of
>>> compression other than gzip in the installed lazy-loading database. This
>>> can be selected by the --data-compress option to R CMD INSTALL or by
>> using
>>> the ?LazyDataCompression? field in the DESCRIPTION file. Useful values
>> are
>>> bzip2, xz and the default, gzip. The only way to discover which is best
>> is
>>> to try them all and look at the size of the pkgname/data/Rdata.rdb file."
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> 	[[alternative HTML version deleted]]
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From erika.cule05 at imperial.ac.uk  Fri Aug 17 11:11:44 2012
From: erika.cule05 at imperial.ac.uk (Cule, Erika)
Date: Fri, 17 Aug 2012 09:11:44 +0000
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
Message-ID: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>

I have written an R package which contains C source code (in the directory pkg/src). 

Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.

To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.

At what stage will installation fail for the end user if they don't have GSL installed? 

I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?

Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled). 

I hope that this is clear, and am happy to post my code if it would be useful.

Many thanks in advance.

Erika

---

Erika Cule
PhD student in Statistical Genetics
Imperial College London
Department of Epidemiology and Public Health
erika.cule05 at imperial.ac.uk
http://occamstypewriter.org/erikacule/


From ligges at statistik.tu-dortmund.de  Fri Aug 17 13:35:45 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 17 Aug 2012 13:35:45 +0200
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
Message-ID: <502E2C91.6050206@statistik.tu-dortmund.de>



On 17.08.2012 11:11, Cule, Erika wrote:
> I have written an R package which contains C source code (in the directory pkg/src).
>
> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>
> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>
> At what stage will installation fail for the end user if they don't have GSL installed?
>
> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?

Yes, you have to work around the installation steps that compile and 
link your C sources and then the call to dynload the shared library in R.

It is porbably easier to use the gsl library via the gsl package, given 
it ptovides the gsl functionality you are using. In that case, you just 
need to suggest the gsl package an load it for the one function on 
demand only.

Best,
Uwe ligges


> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>
> I hope that this is clear, and am happy to post my code if it would be useful.
>
> Many thanks in advance.
>
> Erika
>
> ---
>
> Erika Cule
> PhD student in Statistical Genetics
> Imperial College London
> Department of Epidemiology and Public Health
> erika.cule05 at imperial.ac.uk
> http://occamstypewriter.org/erikacule/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From erika.cule05 at imperial.ac.uk  Fri Aug 17 13:44:29 2012
From: erika.cule05 at imperial.ac.uk (Cule, Erika)
Date: Fri, 17 Aug 2012 11:44:29 +0000
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <502E2C91.6050206@statistik.tu-dortmund.de>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E2C91.6050206@statistik.tu-dortmund.de>
Message-ID: <2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>

Thanks Uwe

I am not quite sure I understand.

To clarify, do you mean writing my R functions as something like:

functionRequiringGsl <- function(arg1, arg2) 
{
	if(require(gsl))
	{
		## Some functions that use GSL 
		## called using .C()
	} else {
		stop("GSL not available")
	}
}

If so, I still don't understand what happens when I compile the package if GSL is not installed on the computer, as there will still be C code in the src directory.

Thanks again

Erika


On 17 Aug 2012, at 12:35, Uwe Ligges wrote:

> 
> 
> On 17.08.2012 11:11, Cule, Erika wrote:
>> I have written an R package which contains C source code (in the directory pkg/src).
>> 
>> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>> 
>> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>> 
>> At what stage will installation fail for the end user if they don't have GSL installed?
>> 
>> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?
> 
> Yes, you have to work around the installation steps that compile and link your C sources and then the call to dynload the shared library in R.
> 
> It is porbably easier to use the gsl library via the gsl package, given it ptovides the gsl functionality you are using. In that case, you just need to suggest the gsl package an load it for the one function on demand only.
> 
> Best,
> Uwe ligges
> 
> 
>> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>> 
>> I hope that this is clear, and am happy to post my code if it would be useful.
>> 
>> Many thanks in advance.
>> 
>> Erika
>> 
>> ---
>> 
>> Erika Cule
>> PhD student in Statistical Genetics
>> Imperial College London
>> Department of Epidemiology and Public Health
>> erika.cule05 at imperial.ac.uk
>> http://occamstypewriter.org/erikacule/
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 


From ligges at statistik.tu-dortmund.de  Fri Aug 17 13:47:58 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 17 Aug 2012 13:47:58 +0200
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E2C91.6050206@statistik.tu-dortmund.de>
	<2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
Message-ID: <502E2F6E.7060301@statistik.tu-dortmund.de>



On 17.08.2012 13:44, Cule, Erika wrote:
> Thanks Uwe
>
> I am not quite sure I understand.
>
> To clarify, do you mean writing my R functions as something like:
>
> functionRequiringGsl <- function(arg1, arg2)
> {
> 	if(require(gsl))
> 	{
> 		## Some functions that use GSL
> 		## called using .C()
> 	} else {
> 		stop("GSL not available")
> 	}
> }
>
> If so, I still don't understand what happens when I compile the package if GSL is not installed on the computer, as there will still be C code in the src directory.

Yes, I meant such a function. If GSL is not available, this function 
will give an ERROR, but the rest of the package works.

Uwe Ligges


> Thanks again
>
> Erika
>
>
> On 17 Aug 2012, at 12:35, Uwe Ligges wrote:
>
>>
>>
>> On 17.08.2012 11:11, Cule, Erika wrote:
>>> I have written an R package which contains C source code (in the directory pkg/src).
>>>
>>> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>>>
>>> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>>>
>>> At what stage will installation fail for the end user if they don't have GSL installed?
>>>
>>> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?
>>
>> Yes, you have to work around the installation steps that compile and link your C sources and then the call to dynload the shared library in R.
>>
>> It is porbably easier to use the gsl library via the gsl package, given it ptovides the gsl functionality you are using. In that case, you just need to suggest the gsl package an load it for the one function on demand only.
>>
>> Best,
>> Uwe ligges
>>
>>
>>> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>>>
>>> I hope that this is clear, and am happy to post my code if it would be useful.
>>>
>>> Many thanks in advance.
>>>
>>> Erika
>>>
>>> ---
>>>
>>> Erika Cule
>>> PhD student in Statistical Genetics
>>> Imperial College London
>>> Department of Epidemiology and Public Health
>>> erika.cule05 at imperial.ac.uk
>>> http://occamstypewriter.org/erikacule/
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>


From erika.cule05 at imperial.ac.uk  Fri Aug 17 13:49:50 2012
From: erika.cule05 at imperial.ac.uk (Cule, Erika)
Date: Fri, 17 Aug 2012 11:49:50 +0000
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <502E2F6E.7060301@statistik.tu-dortmund.de>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E2C91.6050206@statistik.tu-dortmund.de>
	<2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
	<502E2F6E.7060301@statistik.tu-dortmund.de>
Message-ID: <2402B639CA718D40875055AF9BC9EE1013E51505@icexch-m4.ic.ac.uk>

But will package compilation fail if GSL is not installed? 

(There are files in the src directory that are needed for the code to run)

On 17 Aug 2012, at 12:47, Uwe Ligges wrote:

> 
> 
> On 17.08.2012 13:44, Cule, Erika wrote:
>> Thanks Uwe
>> 
>> I am not quite sure I understand.
>> 
>> To clarify, do you mean writing my R functions as something like:
>> 
>> functionRequiringGsl <- function(arg1, arg2)
>> {
>> 	if(require(gsl))
>> 	{
>> 		## Some functions that use GSL
>> 		## called using .C()
>> 	} else {
>> 		stop("GSL not available")
>> 	}
>> }
>> 
>> If so, I still don't understand what happens when I compile the package if GSL is not installed on the computer, as there will still be C code in the src directory.
> 
> Yes, I meant such a function. If GSL is not available, this function will give an ERROR, but the rest of the package works.
> 
> Uwe Ligges
> 
> 
>> Thanks again
>> 
>> Erika
>> 
>> 
>> On 17 Aug 2012, at 12:35, Uwe Ligges wrote:
>> 
>>> 
>>> 
>>> On 17.08.2012 11:11, Cule, Erika wrote:
>>>> I have written an R package which contains C source code (in the directory pkg/src).
>>>> 
>>>> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>>>> 
>>>> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>>>> 
>>>> At what stage will installation fail for the end user if they don't have GSL installed?
>>>> 
>>>> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?
>>> 
>>> Yes, you have to work around the installation steps that compile and link your C sources and then the call to dynload the shared library in R.
>>> 
>>> It is porbably easier to use the gsl library via the gsl package, given it ptovides the gsl functionality you are using. In that case, you just need to suggest the gsl package an load it for the one function on demand only.
>>> 
>>> Best,
>>> Uwe ligges
>>> 
>>> 
>>>> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>>>> 
>>>> I hope that this is clear, and am happy to post my code if it would be useful.
>>>> 
>>>> Many thanks in advance.
>>>> 
>>>> Erika
>>>> 
>>>> ---
>>>> 
>>>> Erika Cule
>>>> PhD student in Statistical Genetics
>>>> Imperial College London
>>>> Department of Epidemiology and Public Health
>>>> erika.cule05 at imperial.ac.uk
>>>> http://occamstypewriter.org/erikacule/
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>> 


From ligges at statistik.tu-dortmund.de  Fri Aug 17 13:51:35 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 17 Aug 2012 13:51:35 +0200
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <2402B639CA718D40875055AF9BC9EE1013E51505@icexch-m4.ic.ac.uk>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E2C91.6050206@statistik.tu-dortmund.de>
	<2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
	<502E2F6E.7060301@statistik.tu-dortmund.de>
	<2402B639CA718D40875055AF9BC9EE1013E51505@icexch-m4.ic.ac.uk>
Message-ID: <502E3047.6090806@statistik.tu-dortmund.de>



On 17.08.2012 13:49, Cule, Erika wrote:
> But will package compilation fail if GSL is not installed?

No, not this way: since the gsl package can be in the Suggests now 
(rather than the Depends).

Best,
Uwe Ligges


>
> (There are files in the src directory that are needed for the code to run)
>
> On 17 Aug 2012, at 12:47, Uwe Ligges wrote:
>
>>
>>
>> On 17.08.2012 13:44, Cule, Erika wrote:
>>> Thanks Uwe
>>>
>>> I am not quite sure I understand.
>>>
>>> To clarify, do you mean writing my R functions as something like:
>>>
>>> functionRequiringGsl <- function(arg1, arg2)
>>> {
>>> 	if(require(gsl))
>>> 	{
>>> 		## Some functions that use GSL
>>> 		## called using .C()
>>> 	} else {
>>> 		stop("GSL not available")
>>> 	}
>>> }
>>>
>>> If so, I still don't understand what happens when I compile the package if GSL is not installed on the computer, as there will still be C code in the src directory.
>>
>> Yes, I meant such a function. If GSL is not available, this function will give an ERROR, but the rest of the package works.
>>
>> Uwe Ligges
>>
>>
>>> Thanks again
>>>
>>> Erika
>>>
>>>
>>> On 17 Aug 2012, at 12:35, Uwe Ligges wrote:
>>>
>>>>
>>>>
>>>> On 17.08.2012 11:11, Cule, Erika wrote:
>>>>> I have written an R package which contains C source code (in the directory pkg/src).
>>>>>
>>>>> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>>>>>
>>>>> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>>>>>
>>>>> At what stage will installation fail for the end user if they don't have GSL installed?
>>>>>
>>>>> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?
>>>>
>>>> Yes, you have to work around the installation steps that compile and link your C sources and then the call to dynload the shared library in R.
>>>>
>>>> It is porbably easier to use the gsl library via the gsl package, given it ptovides the gsl functionality you are using. In that case, you just need to suggest the gsl package an load it for the one function on demand only.
>>>>
>>>> Best,
>>>> Uwe ligges
>>>>
>>>>
>>>>> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>>>>>
>>>>> I hope that this is clear, and am happy to post my code if it would be useful.
>>>>>
>>>>> Many thanks in advance.
>>>>>
>>>>> Erika
>>>>>
>>>>> ---
>>>>>
>>>>> Erika Cule
>>>>> PhD student in Statistical Genetics
>>>>> Imperial College London
>>>>> Department of Epidemiology and Public Health
>>>>> erika.cule05 at imperial.ac.uk
>>>>> http://occamstypewriter.org/erikacule/
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>
>


From ripley at stats.ox.ac.uk  Fri Aug 17 13:58:18 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 17 Aug 2012 12:58:18 +0100
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
Message-ID: <502E31DA.5070803@stats.ox.ac.uk>

What you have not told us is your platform (but it was Mac OS X the 
other day).  The answers are different if you are doing source installs 
or binary installs and if the latter, by platform.

If you are doing source installs on the machine to be used, configure 
should adjust the install accordingly.

If you transfer a binary install done without GSL to another machine 
with GSL, the installed package will have the GSL functions disabled.

If you transfer a binary install done with GSL to a machine without, it 
depends.  As both Windows and OS X binary builds use a static libgsl, 
they will be fine and the package will have working GSL-based functions. 
  In other cases with dynamic linking the package may fail to load or 
attempts to use the GSL-based functions may crash the R session.



On 17/08/2012 10:11, Cule, Erika wrote:
> I have written an R package which contains C source code (in the directory pkg/src).
>
> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>
> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>
> At what stage will installation fail for the end user if they don't have GSL installed?
>
> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?
>
> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>
> I hope that this is clear, and am happy to post my code if it would be useful.
>
> Many thanks in advance.
>
> Erika
>
> ---
>
> Erika Cule
> PhD student in Statistical Genetics
> Imperial College London
> Department of Epidemiology and Public Health
> erika.cule05 at imperial.ac.uk
> http://occamstypewriter.org/erikacule/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Fri Aug 17 14:04:36 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 17 Aug 2012 07:04:36 -0500
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E2C91.6050206@statistik.tu-dortmund.de>
	<2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
Message-ID: <20526.13140.317362.955544@max.nulle.part>


On 17 August 2012 at 11:44, Cule, Erika wrote:
| If so, I still don't understand what happens when I compile the package if GSL is not installed on the computer, as there will still be C code in the src directory.

That is precisely the use case for autoconf et al.

You test if something (here GSL) is available (and there are macros and
examples for in many places) and then define a header file variable such as
I_HAVE_FOUND_GSL as 1 or 0, say.  In your C code, you then use something like

   #if I_HAVE_FOUND_GSL == 1

       some code

   #endif 

Now your code compiles in both cases.

Alternatively, you just depend on the GSL. Many packages on CRAN do, and the
Windows build infrastructure provides it.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From erika.cule05 at imperial.ac.uk  Fri Aug 17 14:07:22 2012
From: erika.cule05 at imperial.ac.uk (Cule, Erika)
Date: Fri, 17 Aug 2012 12:07:22 +0000
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <20526.13140.317362.955544@max.nulle.part>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E2C91.6050206@statistik.tu-dortmund.de>
	<2402B639CA718D40875055AF9BC9EE1013E514B2@icexch-m4.ic.ac.uk>
	<20526.13140.317362.955544@max.nulle.part>
Message-ID: <2402B639CA718D40875055AF9BC9EE1013E516DD@icexch-m4.ic.ac.uk>

Ah I see! Had not thought of that solution.

(This is the first time I have tried to use autoconf and configure)

Many thanks.

Erika

On 17 Aug 2012, at 13:04, Dirk Eddelbuettel wrote:

> 
> On 17 August 2012 at 11:44, Cule, Erika wrote:
> | If so, I still don't understand what happens when I compile the package if GSL is not installed on the computer, as there will still be C code in the src directory.
> 
> That is precisely the use case for autoconf et al.
> 
> You test if something (here GSL) is available (and there are macros and
> examples for in many places) and then define a header file variable such as
> I_HAVE_FOUND_GSL as 1 or 0, say.  In your C code, you then use something like
> 
>   #if I_HAVE_FOUND_GSL == 1
> 
>       some code
> 
>   #endif 
> 
> Now your code compiles in both cases.
> 
> Alternatively, you just depend on the GSL. Many packages on CRAN do, and the
> Windows build infrastructure provides it.
> 
> Dirk
> 
> -- 
> Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com  


From erika.cule05 at imperial.ac.uk  Fri Aug 17 14:09:07 2012
From: erika.cule05 at imperial.ac.uk (Cule, Erika)
Date: Fri, 17 Aug 2012 12:09:07 +0000
Subject: [Rd] R package compilation: files in src directory should be
 ignored if C library is not available
In-Reply-To: <502E31DA.5070803@stats.ox.ac.uk>
References: <2402B639CA718D40875055AF9BC9EE1013E50C60@icexch-m4.ic.ac.uk>
	<502E31DA.5070803@stats.ox.ac.uk>
Message-ID: <2402B639CA718D40875055AF9BC9EE1013E516FD@icexch-m4.ic.ac.uk>

Thank you, that is very helpful.

On 17 Aug 2012, at 12:58, Prof Brian Ripley wrote:

> What you have not told us is your platform (but it was Mac OS X the other day).  The answers are different if you are doing source installs or binary installs and if the latter, by platform.

Apologies for omitting to tell you the platform. I didn't know that it makes a difference, and was thinking about how to make the code portable for submission to CRAN.

> 
> If you are doing source installs on the machine to be used, configure should adjust the install accordingly.

Dirk just told me how to do that in another message. 

> 
> If you transfer a binary install done without GSL to another machine with GSL, the installed package will have the GSL functions disabled.
> 
> If you transfer a binary install done with GSL to a machine without, it depends.  As both Windows and OS X binary builds use a static libgsl, they will be fine and the package will have working GSL-based functions.  In other cases with dynamic linking the package may fail to load or attempts to use the GSL-based functions may crash the R session.
> 

That is useful to know because I was wondering how I was going to make my code portable for Windows users. As I understand, when R binaries are built for windows GSL is on the computer that builds them so Windows binaries should work. (Dirk just confirmed this.) 

Many thanks to Prof Ripley, Dirk Eddelbuettel and Uwe Ligges for helping me with this. 

Erika

> 
> 
> On 17/08/2012 10:11, Cule, Erika wrote:
>> I have written an R package which contains C source code (in the directory pkg/src).
>> 
>> Only a subset of the functions in the pkg/R directory contain a .C() call to the functions in the pkg/src directory. The rest of the package will still work and be useful without the functions containing a .C() call.
>> 
>> To compile the code in pkg/src requires the GSL library. This is detailed in the SystemRequirements line of the DESCRIPTION file and the Makevars file directs the compiler to LIB_GSL.
>> 
>> At what stage will installation fail for the end user if they don't have GSL installed?
>> 
>> I have used Autoconf and configure, following the example in 1.2 of "Writing R Extensions" and the configure.ac file in the R package gsl, to detect whether the GSL library is installed on the computer and disable the R functions if the GSL library is not found (by using a TRUE/FALSE pattern substitution, as in the example in "Writing R Extensions"). If GSL is not available, will the package now install on another users machine with these functions disabled? Or upon installation will the installer try to install the code in pkg/src and fail because the libraries are not available?
>> 
>> Is there a practical way to test this? Both of the computers I have access to have GSL available, and installation works whether I set HAVE_GSL=TRUE or HAVE_GSL=FALSE (although in the latter case the corresponding R functions are disabled).
>> 
>> I hope that this is clear, and am happy to post my code if it would be useful.
>> 
>> Many thanks in advance.
>> 
>> Erika
>> 
>> ---
>> 
>> Erika Cule
>> PhD student in Statistical Genetics
>> Imperial College London
>> Department of Epidemiology and Public Health
>> erika.cule05 at imperial.ac.uk
>> http://occamstypewriter.org/erikacule/
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mtmorgan at fhcrc.org  Fri Aug 17 22:24:30 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 17 Aug 2012 13:24:30 -0700
Subject: [Rd] data() documentation ambiguous about loaded versus attached
	packages?
Message-ID: <502EA87E.2070905@fhcrc.org>

Under ?data

  package: a character vector giving the package(s) to look in for data
           sets, or 'NULL'.

           By default, all packages in the search path are used, then
           the 'data' subdirectory (if present) of the current working
           directory.

which I think is accurate -- packages have to be attached for their data 
to be found; being loaded (as when PkgB Imports: PkgA) is not 
sufficient. Later we have

      If 'lib.loc' and 'package' are both 'NULL' (the default), the data
      sets are searched for in all the currently loaded packages then in
      the 'data' directory (if any) of the current working directory.

which I think is incorrect ('currently attached packages') and

      If 'lib.loc = NULL' but 'package' is specified as a character
      vector, the specified package(s) are searched for first amongst
      loaded packages and then in the default library/ies (see
      '.libPaths').

which I'm unsure of -- probably 'amongst attached packages'.

FWIW most Bioconductor packages that use data() in function calls 
currently do so without specifying 'package', and without specifying an 
'envir' argument (hence overwriting user objects in the global environment).

 > R.version.string
[1] "R Under development (unstable) (2012-08-17 r60296)"

Martin
-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From moshersteven at gmail.com  Fri Aug 17 22:32:18 2012
From: moshersteven at gmail.com (steven mosher)
Date: Fri, 17 Aug 2012 13:32:18 -0700
Subject: [Rd] Compressing data for package builds
In-Reply-To: <502E167D.3020402@statistik.tu-dortmund.de>
References: <CAFFLneTpp4kjRjuA21ORyo649vycgwJt81BDXDAFLRm5vE7p_Q@mail.gmail.com>
	<19D68B47-B1D5-422F-A86E-00147521B40B@r-project.org>
	<CAFFLneSCun2cHV7K6x-ccrHnXbWqJRTB_p3O9eLY_7iWKbGhOg@mail.gmail.com>
	<502E167D.3020402@statistik.tu-dortmund.de>
Message-ID: <CAFFLneQY4fG0=MPTLDt+tKiMRufSpVX1K3814kkcH2MBn9aYFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120817/63159ea8/attachment.pl>

From maechler at stat.math.ethz.ch  Sat Aug 18 17:03:28 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 18 Aug 2012 17:03:28 +0200
Subject: [Rd] Quiz: How to get a "named column" from a data frame
Message-ID: <20527.44736.486888.854733@stat.math.ethz.ch>

Today, I was looking for an elegant (and efficient) way
to get a named (atomic) vector by selecting one column of a data frame.
Of course, the vector names must be the rownames of the data frame.

Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
wondering if there are obvious better ones, and
also if this should not become more idiomatic (hence "R-devel"):

Consider this toy example, where the dataframe already has only
one column :

> nv <- c(a=1, d=17, e=101); nv
  a   d   e 
  1  17 101 

> df <- as.data.frame(cbind(VAR = nv)); df
  VAR
a   1
d  17
e 101

Now how, can I get 'nv' back from 'df' ?   I.e., how to get

> identical(nv, .......)
[1] TRUE

where ...... only uses 'df' (and no non-standard R packages)?

As said, I know a simple solution (*), but I'm sure it is not
obvious to most R users and probably not even to the majority of
R-devel readers... OTOH, people like Bill Dunlap will not take
long to provide it or a better one.

(*) In my solution, the above '.......' consists of 17 letters.
I'll post it later today (CEST time) ... or confirm
that someone else has done so.

Martin


From josh.m.ulrich at gmail.com  Sat Aug 18 17:16:09 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 18 Aug 2012 10:16:09 -0500
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <20527.44736.486888.854733@stat.math.ethz.ch>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
Message-ID: <CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>

I don't know if this is better, but it's the most obvious/shortest I
could come up with.  Transpose the data.frame column to a 'row' vector
and drop the dimensions.

R> identical(nv, drop(t(df)))
[1] TRUE

Best,
--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> Today, I was looking for an elegant (and efficient) way
> to get a named (atomic) vector by selecting one column of a data frame.
> Of course, the vector names must be the rownames of the data frame.
>
> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
> wondering if there are obvious better ones, and
> also if this should not become more idiomatic (hence "R-devel"):
>
> Consider this toy example, where the dataframe already has only
> one column :
>
>> nv <- c(a=1, d=17, e=101); nv
>   a   d   e
>   1  17 101
>
>> df <- as.data.frame(cbind(VAR = nv)); df
>   VAR
> a   1
> d  17
> e 101
>
> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>
>> identical(nv, .......)
> [1] TRUE
>
> where ...... only uses 'df' (and no non-standard R packages)?
>
> As said, I know a simple solution (*), but I'm sure it is not
> obvious to most R users and probably not even to the majority of
> R-devel readers... OTOH, people like Bill Dunlap will not take
> long to provide it or a better one.
>
> (*) In my solution, the above '.......' consists of 17 letters.
> I'll post it later today (CEST time) ... or confirm
> that someone else has done so.
>
> Martin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ruipbarradas at sapo.pt  Sat Aug 18 18:01:18 2012
From: ruipbarradas at sapo.pt (Rui Barradas)
Date: Sat, 18 Aug 2012 17:01:18 +0100
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
Message-ID: <502FBC4E.50800@sapo.pt>

Hello,

A bit more general

nv <- c(a=1, d=17, e=101); nv
nv2 <- c(a="a", d="d", e="e")
df2 <- data.frame(VAR = nv, CHAR = nv2); df2

identical( nv, drop(t( df2[1] )) )   # TRUE
identical( nv, drop(t( df2[[1]] )) ) # FALSE

Rui Barradas

Em 18-08-2012 16:16, Joshua Ulrich escreveu:
> I don't know if this is better, but it's the most obvious/shortest I
> could come up with.  Transpose the data.frame column to a 'row' vector
> and drop the dimensions.
>
> R> identical(nv, drop(t(df)))
> [1] TRUE
>
> Best,
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
>
>
> On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
>> Today, I was looking for an elegant (and efficient) way
>> to get a named (atomic) vector by selecting one column of a data frame.
>> Of course, the vector names must be the rownames of the data frame.
>>
>> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>> wondering if there are obvious better ones, and
>> also if this should not become more idiomatic (hence "R-devel"):
>>
>> Consider this toy example, where the dataframe already has only
>> one column :
>>
>>> nv <- c(a=1, d=17, e=101); nv
>>    a   d   e
>>    1  17 101
>>
>>> df <- as.data.frame(cbind(VAR = nv)); df
>>    VAR
>> a   1
>> d  17
>> e 101
>>
>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>
>>> identical(nv, .......)
>> [1] TRUE
>>
>> where ...... only uses 'df' (and no non-standard R packages)?
>>
>> As said, I know a simple solution (*), but I'm sure it is not
>> obvious to most R users and probably not even to the majority of
>> R-devel readers... OTOH, people like Bill Dunlap will not take
>> long to provide it or a better one.
>>
>> (*) In my solution, the above '.......' consists of 17 letters.
>> I'll post it later today (CEST time) ... or confirm
>> that someone else has done so.
>>
>> Martin
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mtmorgan at fhcrc.org  Sat Aug 18 18:05:55 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sat, 18 Aug 2012 09:05:55 -0700
Subject: [Rd] mccollect does not return named,
	ordered results when wait=FALSE
Message-ID: <502FBD63.3080102@fhcrc.org>

?mccollect say

      'mccollect' returns any results that are available in a list.  The
      results will have the same order as the specified jobs.  If there
      are multiple jobs and a job has a name it will be used to name the
      result, otherwise its process ID will be used.  If none of the
      specified children are still running, it returns 'NULL'.

which does not seem to be true when wait=FALSE

 > sleeper = function(i) mcparallel({ Sys.sleep(i); i }, i)
 > p = lapply(1:2, sleeper); Sys.sleep(2); mccollect(p, wait=FALSE)
[[1]]
[1] 2

[[2]]
[1] 1

 > p = lapply(1:2, sleeper); Sys.sleep(2); mccollect(p, wait=TRUE)
$`1`
[1] 1

$`2`
[1] 2

It would be programmatically convenient if mccollect returned a list 
equal in length to it's first argument (except when all tasks are 
complete), e.g., a length 2 named list with second element NULL rather than

 > p = lapply(1:2, sleeper); Sys.sleep(1); mccollect(p, wait=FALSE)
[[1]]
[1] 1


 > sessionInfo()
R Under development (unstable) (2012-08-18 r60311)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] BiocInstaller_1.5.12

loaded via a namespace (and not attached):
[1] tools_2.16.0

-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From maechler at stat.math.ethz.ch  Sat Aug 18 18:20:51 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 18 Aug 2012 18:20:51 +0200
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAJLQA-6huzGgtWhb4h9hqm3ZBctQW97EexYMNXK-+6UsAzERdw@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAJLQA-6huzGgtWhb4h9hqm3ZBctQW97EexYMNXK-+6UsAzERdw@mail.gmail.com>
Message-ID: <CAPRP4-cvBERVf1SOVE1ODy7Hh-GbQWbQjgF8636zotLLreeuNA@mail.gmail.com>

On Sat, Aug 18, 2012 at 5:14 PM, Christian Brechb?hler .... wrote:
> On Sat, Aug 18, 2012 at 11:03 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
>>
>> Today, I was looking for an elegant (and efficient) way
>> to get a named (atomic) vector by selecting one column of a data frame.
>> Of course, the vector names must be the rownames of the data frame.
>>
>> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>> wondering if there are obvious better ones, and
>> also if this should not become more idiomatic (hence "R-devel"):
>>
>> Consider this toy example, where the dataframe already has only
>> one column :
>>
>> > nv <- c(a=1, d=17, e=101); nv
>>   a   d   e
>>   1  17 101
>>
>> > df <- as.data.frame(cbind(VAR = nv)); df
>>   VAR
>> a   1
>> d  17
>> e 101
>>
>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>
>> > identical(nv, .......)
>> [1] TRUE
>>
>> where ...... only uses 'df' (and no non-standard R packages)?
>
>
>> identical(nv, df[,1])
> [1] TRUE
>
>> In my solution, the above '.......' consists of 17 letters.
>
>
> I count 6 in mine

But it is not a solution in a current version of R!
though it's still interesting that   df[,1]  worked in some incantation of R.

What's your sessionInfo()?
Martin

>
> /Christian


From maechler at stat.math.ethz.ch  Sat Aug 18 18:33:36 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 18 Aug 2012 18:33:36 +0200
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
Message-ID: <20527.50144.797572.795413@stat.math.ethz.ch>

>>>>> Joshua Ulrich <josh.m.ulrich at gmail.com>
>>>>>     on Sat, 18 Aug 2012 10:16:09 -0500 writes:

    > I don't know if this is better, but it's the most obvious/shortest I
    > could come up with.  Transpose the data.frame column to a 'row' vector
    > and drop the dimensions.

    R> identical(nv, drop(t(df)))
    > [1] TRUE

Yes, that's definitely shorter,
congratulations!

One gotta is that I'd want a solution that also works when the
df has more columns than just one...

Your idea to use  t(.) is nice and "perfect" insofar as it
coerces the data frame to a matrix, and that's really the clue:

Where as  df[,1]  is losing the names,  
the matrix indexing is not.
So your solution can be changed into

     t(df)[1,]

which is even shorter...
and slightly less efficient, at least conceptually, than mine, which has
been

   as.matrix(df)[,1]

Now, the remaining question is:  Shouldn't there be something
more natural to achieve that?
(There is not, currently, AFAIK).

Martin


    > Best,
    > --
    > Joshua Ulrich  |  about.me/joshuaulrich
    > FOSS Trading  |  www.fosstrading.com


    > On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
    > <maechler at stat.math.ethz.ch> wrote:
    >> Today, I was looking for an elegant (and efficient) way to get a named
    >> (atomic) vector by selecting one column of a data frame.  Of course,
    >> the vector names must be the rownames of the data frame.
    >> 
    >> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
    >> wondering if there are obvious better ones, and also if this should
    >> not become more idiomatic (hence "R-devel"):
    >> 
    >> Consider this toy example, where the dataframe already has only one
    >> column :
    >> 
    >>> nv <- c(a=1, d=17, e=101); nv
    >> a   d   e
    >> 1  17 101
    >> 
    >>> df <- as.data.frame(cbind(VAR = nv)); df
    >> VAR
    >> a   1
    >> d  17
    >> e 101
    >> 
    >> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
    >> 
    >>> identical(nv, .......)
    >> [1] TRUE
    >> 
    >> where ...... only uses 'df' (and no non-standard R packages)?
    >> 
    >> As said, I know a simple solution (*), but I'm sure it is not
    >> obvious to most R users and probably not even to the majority of
    >> R-devel readers... OTOH, people like Bill Dunlap will not take
    >> long to provide it or a better one.
    >> 
    >> (*) In my solution, the above '.......' consists of 17 letters.
    >> I'll post it later today (CEST time) ... or confirm
    >> that someone else has done so.
    >> 
    >> Martin
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel


From jwiley.psych at gmail.com  Sat Aug 18 19:27:04 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Sat, 18 Aug 2012 10:27:04 -0700
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <20527.50144.797572.795413@stat.math.ethz.ch>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
	<20527.50144.797572.795413@stat.math.ethz.ch>
Message-ID: <CANz9Z_Jw2A_rkNidVhFbTmOFFV5+TUd9SLASDMq7GSi4nB26mQ@mail.gmail.com>

On Sat, Aug 18, 2012 at 9:33 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Joshua Ulrich <josh.m.ulrich at gmail.com>
>>>>>>     on Sat, 18 Aug 2012 10:16:09 -0500 writes:
>
>     > I don't know if this is better, but it's the most obvious/shortest I
>     > could come up with.  Transpose the data.frame column to a 'row' vector
>     > and drop the dimensions.
>
>     R> identical(nv, drop(t(df)))
>     > [1] TRUE
>
> Yes, that's definitely shorter,
> congratulations!
>
> One gotta is that I'd want a solution that also works when the
> df has more columns than just one...
>
> Your idea to use  t(.) is nice and "perfect" insofar as it
> coerces the data frame to a matrix, and that's really the clue:
>
> Where as  df[,1]  is losing the names,
> the matrix indexing is not.
> So your solution can be changed into
>
>      t(df)[1,]
>
> which is even shorter...
> and slightly less efficient, at least conceptually, than mine, which has
> been
>
>    as.matrix(df)[,1]
>
> Now, the remaining question is:  Shouldn't there be something
> more natural to achieve that?
> (There is not, currently, AFAIK).

Perhaps a data frame method for as.vector?

as.vector.data.frame <- function(x, ...) as.matrix(x)[,1]
as.vector(df[1])

or an additional argument to `[.data.frame` like keep.names, which
defaults to FALSE to maintain current behavior but can optionally be
TRUE.

Cheers,

Josh

>
> Martin
>
>
>     > Best,
>     > --
>     > Joshua Ulrich  |  about.me/joshuaulrich
>     > FOSS Trading  |  www.fosstrading.com
>
>
>     > On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
>     > <maechler at stat.math.ethz.ch> wrote:
>     >> Today, I was looking for an elegant (and efficient) way to get a named
>     >> (atomic) vector by selecting one column of a data frame.  Of course,
>     >> the vector names must be the rownames of the data frame.
>     >>
>     >> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>     >> wondering if there are obvious better ones, and also if this should
>     >> not become more idiomatic (hence "R-devel"):
>     >>
>     >> Consider this toy example, where the dataframe already has only one
>     >> column :
>     >>
>     >>> nv <- c(a=1, d=17, e=101); nv
>     >> a   d   e
>     >> 1  17 101
>     >>
>     >>> df <- as.data.frame(cbind(VAR = nv)); df
>     >> VAR
>     >> a   1
>     >> d  17
>     >> e 101
>     >>
>     >> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>     >>
>     >>> identical(nv, .......)
>     >> [1] TRUE
>     >>
>     >> where ...... only uses 'df' (and no non-standard R packages)?
>     >>
>     >> As said, I know a simple solution (*), but I'm sure it is not
>     >> obvious to most R users and probably not even to the majority of
>     >> R-devel readers... OTOH, people like Bill Dunlap will not take
>     >> long to provide it or a better one.
>     >>
>     >> (*) In my solution, the above '.......' consists of 17 letters.
>     >> I'll post it later today (CEST time) ... or confirm
>     >> that someone else has done so.
>     >>
>     >> Martin
>     >>
>     >> ______________________________________________
>     >> R-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From brechbuehler at gmail.com  Sat Aug 18 20:13:20 2012
From: brechbuehler at gmail.com (=?ISO-8859-1?Q?Christian_Brechb=FChler?=)
Date: Sat, 18 Aug 2012 14:13:20 -0400
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAPRP4-cvBERVf1SOVE1ODy7Hh-GbQWbQjgF8636zotLLreeuNA@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAJLQA-6huzGgtWhb4h9hqm3ZBctQW97EexYMNXK-+6UsAzERdw@mail.gmail.com>
	<CAPRP4-cvBERVf1SOVE1ODy7Hh-GbQWbQjgF8636zotLLreeuNA@mail.gmail.com>
Message-ID: <CAJLQA-4qk6WMm1y7dksHFTD_yTiajFPaTXa7WaWxsf1w-PjJ9g@mail.gmail.com>

On 8/18/12, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> On Sat, Aug 18, 2012 at 5:14 PM, Christian Brechb?hler .... wrote:
>> On Sat, Aug 18, 2012 at 11:03 AM, Martin Maechler
>> <maechler at stat.math.ethz.ch> wrote:

>>> Consider this toy example, where the dataframe already has only
>>> one column :
>>>
>>> > nv <- c(a=1, d=17, e=101); nv
>>>   a   d   e
>>>   1  17 101
>>>
>>> > df <- as.data.frame(cbind(VAR = nv)); df
>>>   VAR
>>> a   1
>>> d  17
>>> e 101
>>>
>>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>>
>>> > identical(nv, .......)
>>> [1] TRUE
>>>
>>> where ...... only uses 'df' (and no non-standard R packages)?
>>
>>
>>> identical(nv, df[,1])
>> [1] TRUE

> But it is not a solution in a current version of R!
> though it's still interesting that   df[,1]  worked in some incantation of
> R.

My mistake!  We disliked some quirks of indexing, so we've long had
our own patch for "[.data.frame" in place, which I used inadvertently.
 In essence, it does this:

    result <- base::"[.data.frame"(df,,1, drop=F)
    if (drop && length(ncol(result) > 0) && ncol(result)==1) {
          save.names <- dimnames(result)[[1]]
          result <- result[[1]]
          names(result) <- save.names
    }

That obviously violated your constraint "no non-standard R packages".
I apologize.

Still, maybe the behavior of getting the named column would be
desirable in general?

/Christian


From winstonchang1 at gmail.com  Sat Aug 18 20:54:09 2012
From: winstonchang1 at gmail.com (Winston Chang)
Date: Sat, 18 Aug 2012 13:54:09 -0500
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <20527.44736.486888.854733@stat.math.ethz.ch>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
Message-ID: <CAFOpNVG2kvn486qe5=8m_wPa7gjA4N1aMg8LiLFrq1_mfuQA_g@mail.gmail.com>

This isn't super-concise, but has the virtue of being clear:

nv <- c(a=1, d=17, e=101)
df <- as.data.frame(cbind(VAR = nv))

identical(nv, setNames(df$VAR, rownames(df)))
# TRUE


It seems to be more efficient than the other methods as well:

f1 <- function() setNames(df$VAR, rownames(df))
f2 <- function() t(df)[1,]
f3 <- function() as.matrix(df)[,1]

r <- microbenchmark(f1(), f2(), f3(), times=1000)
r
# Unit: microseconds
#   expr    min      lq median      uq      max
# 1 f1() 14.589 17.0315 18.608 19.3220   89.388
# 2 f2() 68.057 70.8735 72.240 75.8065 3707.012
# 3 f3() 58.153 61.2600 62.521 65.0380  238.483

-Winston



On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> Today, I was looking for an elegant (and efficient) way
> to get a named (atomic) vector by selecting one column of a data frame.
> Of course, the vector names must be the rownames of the data frame.
>
> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
> wondering if there are obvious better ones, and
> also if this should not become more idiomatic (hence "R-devel"):
>
> Consider this toy example, where the dataframe already has only
> one column :
>
>> nv <- c(a=1, d=17, e=101); nv
>   a   d   e
>   1  17 101
>
>> df <- as.data.frame(cbind(VAR = nv)); df
>   VAR
> a   1
> d  17
> e 101
>
> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>
>> identical(nv, .......)
> [1] TRUE
>
> where ...... only uses 'df' (and no non-standard R packages)?
>
> As said, I know a simple solution (*), but I'm sure it is not
> obvious to most R users and probably not even to the majority of
> R-devel readers... OTOH, people like Bill Dunlap will not take
> long to provide it or a better one.
>
> (*) In my solution, the above '.......' consists of 17 letters.
> I'll post it later today (CEST time) ... or confirm
> that someone else has done so.
>
> Martin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hadley at rice.edu  Sat Aug 18 21:11:15 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Sat, 18 Aug 2012 14:11:15 -0500
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <20527.44736.486888.854733@stat.math.ethz.ch>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
Message-ID: <CABdHhvGdep+5V3W5jsuCh_YLPYXQWCtYh+-mY_Ktzaiq5xXCrw@mail.gmail.com>

On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> Today, I was looking for an elegant (and efficient) way
> to get a named (atomic) vector by selecting one column of a data frame.
> Of course, the vector names must be the rownames of the data frame.
>
> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
> wondering if there are obvious better ones, and
> also if this should not become more idiomatic (hence "R-devel"):
>
> Consider this toy example, where the dataframe already has only
> one column :
>
>> nv <- c(a=1, d=17, e=101); nv
>   a   d   e
>   1  17 101
>
>> df <- as.data.frame(cbind(VAR = nv)); df
>   VAR
> a   1
> d  17
> e 101
>
> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>
>> identical(nv, .......)
> [1] TRUE
>
> where ...... only uses 'df' (and no non-standard R packages)?
>
> As said, I know a simple solution (*), but I'm sure it is not
> obvious to most R users and probably not even to the majority of
> R-devel readers... OTOH, people like Bill Dunlap will not take
> long to provide it or a better one.

But aren't you making life difficult for yourself by not using I ?

df <- data.frame(VAR = I(nv))
str(df[[1]])

(which isn't quite identically because it now has the AsIs class)

Hadley

-- 
Assistant Professor
Department of Statistics / Rice University
http://had.co.nz/


From wdunlap at tibco.com  Sat Aug 18 23:56:13 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Sat, 18 Aug 2012 21:56:13 +0000
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAFOpNVG2kvn486qe5=8m_wPa7gjA4N1aMg8LiLFrq1_mfuQA_g@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAFOpNVG2kvn486qe5=8m_wPa7gjA4N1aMg8LiLFrq1_mfuQA_g@mail.gmail.com>
Message-ID: <E66794E69CFDE04D9A70842786030B93307CAF@PA-MBX01.na.tibco.com>

That would have been essentially my suggestion as well.  I prefer its clarity
(and speed).  I didn't know if you wanted your solution to also apply
to matrices embedded in data.frames.  In S+ rownames<-() works on vectors
(because it calls the generic rowId<-()) so the following works:
  > f4 <- function(df, column) { tmp <- df[[column]] ; rownames(tmp) <- rownames(df) ; tmp}
  > nv <- c(a=1,d=17,e=101)
  > df <- data.frame(VAR=nv, Two=3^(1:3))
  > f4(df, 2)
   a d  e 
   3 9 27
  > df$Matrix <- matrix(1001:1006, ncol=2, nrow=3)
  > f4(df, "Matrix")
    [,1] [,2] 
  a 1001 1004
  d 1002 1005
  e 1003 1006

I forget if R has something like rowIds() (it is to names and rownames as
NROW is to length and nrow).

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf
> Of Winston Chang
> Sent: Saturday, August 18, 2012 11:54 AM
> To: Martin Maechler
> Cc: R. Devel List
> Subject: Re: [Rd] Quiz: How to get a "named column" from a data frame
> 
> This isn't super-concise, but has the virtue of being clear:
> 
> nv <- c(a=1, d=17, e=101)
> df <- as.data.frame(cbind(VAR = nv))
> 
> identical(nv, setNames(df$VAR, rownames(df)))
> # TRUE
> 
> 
> It seems to be more efficient than the other methods as well:
> 
> f1 <- function() setNames(df$VAR, rownames(df))
> f2 <- function() t(df)[1,]
> f3 <- function() as.matrix(df)[,1]
> 
> r <- microbenchmark(f1(), f2(), f3(), times=1000)
> r
> # Unit: microseconds
> #   expr    min      lq median      uq      max
> # 1 f1() 14.589 17.0315 18.608 19.3220   89.388
> # 2 f2() 68.057 70.8735 72.240 75.8065 3707.012
> # 3 f3() 58.153 61.2600 62.521 65.0380  238.483
> 
> -Winston
> 
> 
> 
> On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
> > Today, I was looking for an elegant (and efficient) way
> > to get a named (atomic) vector by selecting one column of a data frame.
> > Of course, the vector names must be the rownames of the data frame.
> >
> > Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
> > wondering if there are obvious better ones, and
> > also if this should not become more idiomatic (hence "R-devel"):
> >
> > Consider this toy example, where the dataframe already has only
> > one column :
> >
> >> nv <- c(a=1, d=17, e=101); nv
> >   a   d   e
> >   1  17 101
> >
> >> df <- as.data.frame(cbind(VAR = nv)); df
> >   VAR
> > a   1
> > d  17
> > e 101
> >
> > Now how, can I get 'nv' back from 'df' ?   I.e., how to get
> >
> >> identical(nv, .......)
> > [1] TRUE
> >
> > where ...... only uses 'df' (and no non-standard R packages)?
> >
> > As said, I know a simple solution (*), but I'm sure it is not
> > obvious to most R users and probably not even to the majority of
> > R-devel readers... OTOH, people like Bill Dunlap will not take
> > long to provide it or a better one.
> >
> > (*) In my solution, the above '.......' consists of 17 letters.
> > I'll post it later today (CEST time) ... or confirm
> > that someone else has done so.
> >
> > Martin
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From gunter.berton at gene.com  Sat Aug 18 18:14:41 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Sat, 18 Aug 2012 09:14:41 -0700
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
Message-ID: <CACk-te0rAsXz_n2GmpY7s3O01Q90B58Te=niLWZ1EHMacmQ8mQ@mail.gmail.com>

Or to expand just a hair on Joshua's suggestion, is the following what you want:

> x <- 1:10
> names(x) <- letters[1:10]
> x
 a  b  c  d  e  f  g  h  i  j
 1  2  3  4  5  6  7  8  9 10
> df <- data.frame(x=x,y=LETTERS[1:10],row.names=names(x))
> df
   x y
a  1 A
b  2 B
c  3 C
d  4 D
e  5 E
f  6 F
g  7 G
h  8 H
i  9 I
j 10 J
> y <- t(df[,1,drop=FALSE])[1,]
> y
 a  b  c  d  e  f  g  h  i  j
 1  2  3  4  5  6  7  8  9 10
> identical(x,y)
[1] TRUE

Cheers,
Bert


On Sat, Aug 18, 2012 at 8:16 AM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> I don't know if this is better, but it's the most obvious/shortest I
> could come up with.  Transpose the data.frame column to a 'row' vector
> and drop the dimensions.
>
> R> identical(nv, drop(t(df)))
> [1] TRUE
>
> Best,
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
>
>
> On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
>> Today, I was looking for an elegant (and efficient) way
>> to get a named (atomic) vector by selecting one column of a data frame.
>> Of course, the vector names must be the rownames of the data frame.
>>
>> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>> wondering if there are obvious better ones, and
>> also if this should not become more idiomatic (hence "R-devel"):
>>
>> Consider this toy example, where the dataframe already has only
>> one column :
>>
>>> nv <- c(a=1, d=17, e=101); nv
>>   a   d   e
>>   1  17 101
>>
>>> df <- as.data.frame(cbind(VAR = nv)); df
>>   VAR
>> a   1
>> d  17
>> e 101
>>
>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>
>>> identical(nv, .......)
>> [1] TRUE
>>
>> where ...... only uses 'df' (and no non-standard R packages)?
>>
>> As said, I know a simple solution (*), but I'm sure it is not
>> obvious to most R users and probably not even to the majority of
>> R-devel readers... OTOH, people like Bill Dunlap will not take
>> long to provide it or a better one.
>>
>> (*) In my solution, the above '.......' consists of 17 letters.
>> I'll post it later today (CEST time) ... or confirm
>> that someone else has done so.
>>
>> Martin
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 

Bert Gunter
Genentech Nonclinical Biostatistics

Internal Contact Info:
Phone: 467-7374
Website:
http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm


From gunter.berton at gene.com  Sat Aug 18 18:37:19 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Sat, 18 Aug 2012 09:37:19 -0700
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <502FBC4E.50800@sapo.pt>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
	<502FBC4E.50800@sapo.pt>
Message-ID: <CACk-te3LQC=nGoPdLDq-_oi1xz8-9HXRprd2=pjUOn8Uy5h+0A@mail.gmail.com>

Yes, but either

drop(t(df[,1,drop=TRUE]))

or

t(df[,1,drop=TRUE])[1,]

does work. My minimal effort to check timings found that the first
version was a hair faster.

-- Bert

On Sat, Aug 18, 2012 at 9:01 AM, Rui Barradas <ruipbarradas at sapo.pt> wrote:
> Hello,
>
> A bit more general
>
> nv <- c(a=1, d=17, e=101); nv
> nv2 <- c(a="a", d="d", e="e")
> df2 <- data.frame(VAR = nv, CHAR = nv2); df2
>
> identical( nv, drop(t( df2[1] )) )   # TRUE
> identical( nv, drop(t( df2[[1]] )) ) # FALSE
>
> Rui Barradas
>
> Em 18-08-2012 16:16, Joshua Ulrich escreveu:
>>
>> I don't know if this is better, but it's the most obvious/shortest I
>> could come up with.  Transpose the data.frame column to a 'row' vector
>> and drop the dimensions.
>>
>> R> identical(nv, drop(t(df)))
>> [1] TRUE
>>
>> Best,
>> --
>> Joshua Ulrich  |  about.me/joshuaulrich
>> FOSS Trading  |  www.fosstrading.com
>>
>>
>> On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
>> <maechler at stat.math.ethz.ch> wrote:
>>>
>>> Today, I was looking for an elegant (and efficient) way
>>> to get a named (atomic) vector by selecting one column of a data frame.
>>> Of course, the vector names must be the rownames of the data frame.
>>>
>>> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>>> wondering if there are obvious better ones, and
>>> also if this should not become more idiomatic (hence "R-devel"):
>>>
>>> Consider this toy example, where the dataframe already has only
>>> one column :
>>>
>>>> nv <- c(a=1, d=17, e=101); nv
>>>
>>>    a   d   e
>>>    1  17 101
>>>
>>>> df <- as.data.frame(cbind(VAR = nv)); df
>>>
>>>    VAR
>>> a   1
>>> d  17
>>> e 101
>>>
>>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>>
>>>> identical(nv, .......)
>>>
>>> [1] TRUE
>>>
>>> where ...... only uses 'df' (and no non-standard R packages)?
>>>
>>> As said, I know a simple solution (*), but I'm sure it is not
>>> obvious to most R users and probably not even to the majority of
>>> R-devel readers... OTOH, people like Bill Dunlap will not take
>>> long to provide it or a better one.
>>>
>>> (*) In my solution, the above '.......' consists of 17 letters.
>>> I'll post it later today (CEST time) ... or confirm
>>> that someone else has done so.
>>>
>>> Martin
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 

Bert Gunter
Genentech Nonclinical Biostatistics

Internal Contact Info:
Phone: 467-7374
Website:
http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm


From gunter.berton at gene.com  Sat Aug 18 18:39:02 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Sat, 18 Aug 2012 09:39:02 -0700
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CACk-te3LQC=nGoPdLDq-_oi1xz8-9HXRprd2=pjUOn8Uy5h+0A@mail.gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
	<502FBC4E.50800@sapo.pt>
	<CACk-te3LQC=nGoPdLDq-_oi1xz8-9HXRprd2=pjUOn8Uy5h+0A@mail.gmail.com>
Message-ID: <CACk-te2OQLfbPD2kR5JaCYn22eYJq4H44QpOrwtkbkuwYFpRfA@mail.gmail.com>

Sorry! -- Change that to drop = FALSE  !

 drop(t(df[,1,drop=FALSE]))
 t(df[,1,drop=FALSE])[1,]

-- Bert

On Sat, Aug 18, 2012 at 9:37 AM, Bert Gunter <bgunter at gene.com> wrote:
> Yes, but either
>
> drop(t(df[,1,drop=TRUE]))
>
> or
>
> t(df[,1,drop=TRUE])[1,]
>
> does work. My minimal effort to check timings found that the first
> version was a hair faster.
>
> -- Bert
>
> On Sat, Aug 18, 2012 at 9:01 AM, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>> Hello,
>>
>> A bit more general
>>
>> nv <- c(a=1, d=17, e=101); nv
>> nv2 <- c(a="a", d="d", e="e")
>> df2 <- data.frame(VAR = nv, CHAR = nv2); df2
>>
>> identical( nv, drop(t( df2[1] )) )   # TRUE
>> identical( nv, drop(t( df2[[1]] )) ) # FALSE
>>
>> Rui Barradas
>>
>> Em 18-08-2012 16:16, Joshua Ulrich escreveu:
>>>
>>> I don't know if this is better, but it's the most obvious/shortest I
>>> could come up with.  Transpose the data.frame column to a 'row' vector
>>> and drop the dimensions.
>>>
>>> R> identical(nv, drop(t(df)))
>>> [1] TRUE
>>>
>>> Best,
>>> --
>>> Joshua Ulrich  |  about.me/joshuaulrich
>>> FOSS Trading  |  www.fosstrading.com
>>>
>>>
>>> On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
>>> <maechler at stat.math.ethz.ch> wrote:
>>>>
>>>> Today, I was looking for an elegant (and efficient) way
>>>> to get a named (atomic) vector by selecting one column of a data frame.
>>>> Of course, the vector names must be the rownames of the data frame.
>>>>
>>>> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>>>> wondering if there are obvious better ones, and
>>>> also if this should not become more idiomatic (hence "R-devel"):
>>>>
>>>> Consider this toy example, where the dataframe already has only
>>>> one column :
>>>>
>>>>> nv <- c(a=1, d=17, e=101); nv
>>>>
>>>>    a   d   e
>>>>    1  17 101
>>>>
>>>>> df <- as.data.frame(cbind(VAR = nv)); df
>>>>
>>>>    VAR
>>>> a   1
>>>> d  17
>>>> e 101
>>>>
>>>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>>>
>>>>> identical(nv, .......)
>>>>
>>>> [1] TRUE
>>>>
>>>> where ...... only uses 'df' (and no non-standard R packages)?
>>>>
>>>> As said, I know a simple solution (*), but I'm sure it is not
>>>> obvious to most R users and probably not even to the majority of
>>>> R-devel readers... OTOH, people like Bill Dunlap will not take
>>>> long to provide it or a better one.
>>>>
>>>> (*) In my solution, the above '.......' consists of 17 letters.
>>>> I'll post it later today (CEST time) ... or confirm
>>>> that someone else has done so.
>>>>
>>>> Martin
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
> --
>
> Bert Gunter
> Genentech Nonclinical Biostatistics
>
> Internal Contact Info:
> Phone: 467-7374
> Website:
> http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm



-- 

Bert Gunter
Genentech Nonclinical Biostatistics

Internal Contact Info:
Phone: 467-7374
Website:
http://pharmadevelopment.roche.com/index/pdb/pdb-functional-groups/pdb-biostatistics/pdb-ncb-home.htm


From JRMHosking at gmail.com  Sat Aug 18 21:28:30 2012
From: JRMHosking at gmail.com (J. R. M. Hosking)
Date: Sat, 18 Aug 2012 15:28:30 -0400
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <20527.44736.486888.854733@stat.math.ethz.ch>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
Message-ID: <k0oqd3$tnm$1@ger.gmane.org>

On 2012-08-18 11:03, Martin Maechler wrote:
> Today, I was looking for an elegant (and efficient) way
> to get a named (atomic) vector by selecting one column of a data frame.
> Of course, the vector names must be the rownames of the data frame.
>
> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
> wondering if there are obvious better ones, and
> also if this should not become more idiomatic (hence "R-devel"):
>
> Consider this toy example, where the dataframe already has only
> one column :
>
>> nv<- c(a=1, d=17, e=101); nv
>    a   d   e
>    1  17 101
>
>> df<- as.data.frame(cbind(VAR = nv)); df
>    VAR
> a   1
> d  17
> e 101
>
> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>
>> identical(nv, .......)
> [1] TRUE
>
> where ...... only uses 'df' (and no non-standard R packages)?
>
> As said, I know a simple solution (*), but I'm sure it is not
> obvious to most R users and probably not even to the majority of
> R-devel readers... OTOH, people like Bill Dunlap will not take
> long to provide it or a better one.
>
> (*) In my solution, the above '.......' consists of 17 letters.
> I'll post it later today (CEST time) ... or confirm
> that someone else has done so.
>
> Martin

For this purpose my private function library has a function withnames():

withnames(): Extract from data frame as a named vector

Description: Extracts data from a data frame; if the result is a vector
(i.e. we extracted a single column and did not specify 'drop=FALSE')
it is assigned names derived from the row names of the data frame.

Usage: withnames(expr)

Arguments: expr: R expression.

Details: 'expr' is evaluated in an environment in which the extractor
functions '$.data.frame', '[.data.frame', and '[[.data.frame' are
replaced by versions that attach the data frame's row names to an
extracted vector.

Value: 'expr', evaluated as described above.

## Code

withnames<-function(expr) {
   eval(substitute(expr),
   list(
     `[.data.frame` = function(x,i,...) {
       out<-x[i,...]
       if (is.null(dim(out))) names(out)<-row.names(x)[i]
       return(out)},
     `[[.data.frame` = function(x,...) {
       out<-x[[...]]
       if (is.null(dim(out))) names(out)<-row.names(x)
       return(out)},
     `$.data.frame` = function(x,name) {
       out<-x[[name, exact=FALSE]]
       if (is.null(dim(out))) names(out)<-row.names(x)
       return(out)}
     ),
   enclos=parent.frame())
}

## Examples

dd <- data.frame(aa=1:6, bb=letters[c(1,3,2,3,3,1)],
   row.names=LETTERS[1:6])
dd
dd$aa                          # Unnamed vector
withnames(dd$aa)               # Named vector
withnames(dd[["aa"]])          # Named vector
withnames(dd[2:4,"aa"])        # Named vector
withnames(dd$bb)               # Factor with names
withnames(outer(dd$a,dd$a))    # Both dimensions have names

## But now I am looking for a version that will play nicely with with():

withnames(with(dd, aa))  # No names!
with(dd, withnames(aa))  # No names!


From atp at piskorski.com  Mon Aug 20 00:00:54 2012
From: atp at piskorski.com (Andrew Piskorski)
Date: Sun, 19 Aug 2012 18:00:54 -0400
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <CAJLQA-4qk6WMm1y7dksHFTD_yTiajFPaTXa7WaWxsf1w-PjJ9g@mail.gmail.com>
References: <CAJLQA-4qk6WMm1y7dksHFTD_yTiajFPaTXa7WaWxsf1w-PjJ9g@mail.gmail.com>
Message-ID: <20120819220054.GA84573@piskorski.com>

On Sat, Aug 18, 2012 at 02:13:20PM -0400, Christian Brechb?hler wrote:
> On 8/18/12, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> > On Sat, Aug 18, 2012 at 5:14 PM, Christian Brechb?hler .... wrote:
> >> On Sat, Aug 18, 2012 at 11:03 AM, Martin Maechler
> >> <maechler at stat.math.ethz.ch> wrote:
> 
> >>> Consider this toy example, where the dataframe already has only
> >>> one column :
> >>>
> >>> > nv <- c(a=1, d=17, e=101); nv
> >>>   a   d   e
> >>>   1  17 101
> >>>
> >>> > df <- as.data.frame(cbind(VAR = nv)); df
> >>>   VAR
> >>> a   1
> >>> d  17
> >>> e 101
> >>>
> >>> Now how, can I get 'nv' back from 'df' ?   I.e., how to get

> >>> identical(nv, df[,1])
> >> [1] TRUE
> 
> > But it is not a solution in a current version of R!
> > though it's still interesting that   df[,1]  worked in some incantation of
> > R.
> 
> My mistake!  We disliked some quirks of indexing, so we've long had
> our own patch for "[.data.frame" in place, which I used inadvertently.

As I understand it, when when doing 'df[,1]' on a data frame, Bell
Labs S and all versions of S-Plus prior to 3.4 always retained the
data frame's row names as the names on the result vector.  'df[,1]'
gave you a named vector identical to your 'nv' above.  Then in 1996
with S-Plus 3.4, Insightful broke that behavior, after which 'df[,1]'
returned a vector without any names.  I believe R copied that
late-1990s S-Plus behavior, but I don't know why exactly.

When subscripting objects, R sometimes retains the object's dimnames
as names in the result, and sometimes not, which I find frustrating.
Personally, I think it would make much more sense if subscripting
ALWAYS retained any names it could, and worked as similarly as
possible across data frames, matrices, arrays, vectors, etc.  After
all, explicitly dropping names afterwards is trivial, while adding
them back on is not.

Back on 2005-10-19 with R 2.2.0, I gave a simple test of 15 cases; 4
of them dropped names during subscripting, the other 11 preseved them.
That's towards the end of the discussion here:

  https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=8192

Contrary to the initial tone of my old 2005 "bug" report, current R
subscripting behavior is of course NOT a bug, as AFAIK it's working as
the R Core Team intended.  However, I definitely consider the current
behavior a design infelicity.

Just now on stock R 2.15.1 (with --vanilla), I ran an updated version
of those same simple tests.  Of 22 subscripting test cases, 7 lose
names and 15 preserve them.  (If anyone's interested in the specific
tests, I can send them, or try to append them to that old 8192 feature
request.)

For what it's worth, at work, for years we ran various versions of
pre-namespace R using some ugly patches of "[" and "[.data.frame" to
force name retention during subscripting.  Since we were not using
namespaces at all, those "keep names" subscripting hacks were
affecting ALL R code we ran, not just our own custom code which needed
and expected the names to be retained.  Yet perhaps surprisingly, I
don't think I ever ran into a single case where the forced retention
of names broke any code.  We of course ran only a tiny sample of the
huge amount of code on CRAN, but that experience suggests that most R
code which expects un-named objects doesn't mind at all if names are
present.

If anyone would genuinely like to add an option for name-preserving
subscripting to R, I'm willing to work on it, so please do let me know
your thoughts.  So far though, I've never dug into the guts of the
.Primitive("[") and "[.data.frame" functions to see how/why they
sometimes keep and sometime discard names during subscripting.

-- 
Andrew Piskorski <atp at piskorski.com>


From dadler at uni-goettingen.de  Mon Aug 20 11:05:10 2012
From: dadler at uni-goettingen.de (Daniel Adler)
Date: Mon, 20 Aug 2012 11:05:10 +0200
Subject: [Rd] rdyncall fears removal from CRAN
References: <20120814090906.31F128144A@gannet.stats.ox.ac.uk>
Message-ID: <F0DD11BC-94E6-486A-9E25-9379D2B6BBE4@uni-goettingen.de>

Dear R Core and CRAN Team,

I received a warning that the rdyncall package [1] will be archived and removed from the main CRAN distribution at 7th of September
if I can not get rid of .Internal calls.

> From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
> Subject: Use of .Internal in CRAN package rdyncall
> Date: August 14, 2012 11:09:06 AM GMT+02:00
> To: dadler at uni-goettingen.de
> 
> R CMD check has been warning about the use of .Internal in packages
> for several months now, in R-release since 2.15.0.  We have decided
> that it will not be allowed at all in the next release of R (not least
> because the work on long vectors means we need to move
> argument-checking code between internal code and the R wrapper).
> 
> So can we please have a package update without .Internal calls by
> September 7 (or the package will be archived).  You should also check
> the R-devel CRAN check pages at
> http://cran.r-project.org/web/checks/check_results_<pkg>.html (replace
> <pkg> by the name of your package) for any other issues that need to
> be addressed.


The use of .Internal in rdyncall was due to a missing interface for namespace object management.
Since the main task of this package is to offer an alternative FFI *AND* a catalog of ready-to-use bindings to
popular C libraries (across platforms) and interface for attach/remove of namespace objects was required.
The current implementation uses a small snippet of code "makeNamespace" from src/library/base/R/namespace.R and we have to make a 
call to .Internal(registerNamespace).

A request was made on the mailing list in the past:

https://stat.ethz.ch/pipermail/r-devel/2011-December/062839.html

Since the deadline is very soon, I emphasize and repeat my request for an R programming interface to namespace objects
and I please you for advices to go about this issue.

Are there any other plans for opening the interface to namespace management?

The namespace creation function 'makeNamespace' is currently defined in a local scope to another function 
making it not accessible from the outside.
'registerNamespace' is a functionality only available via '.Internal'.
So what is 'good pratice' for opening access to this - another wrapper in 'base' that calls '.Internal' ?

It would be very sad if rdyncall is dropped from CRAN since more and more package authors are using it for different applications.
For those that need more detail, there is an article on R Journal (http://journal.r-project.org/archive/2012-1/RJournal_2012-1_Adler.pdf)

Any help, comment and advice is very appreciated.

Thank you
- Daniel

Begin forwarded message:

> 
> 
> The CRAN team


From winstonchang1 at gmail.com  Mon Aug 20 16:58:54 2012
From: winstonchang1 at gmail.com (Winston Chang)
Date: Mon, 20 Aug 2012 09:58:54 -0500
Subject: [Rd] rdyncall fears removal from CRAN
In-Reply-To: <F0DD11BC-94E6-486A-9E25-9379D2B6BBE4@uni-goettingen.de>
References: <20120814090906.31F128144A@gannet.stats.ox.ac.uk>
	<F0DD11BC-94E6-486A-9E25-9379D2B6BBE4@uni-goettingen.de>
Message-ID: <CAFOpNVHbgq+aKS2WGF_Pf_BXSR1H11ucaMAFVJ4+EBtR8VNePw@mail.gmail.com>

On Mon, Aug 20, 2012 at 4:05 AM, Daniel Adler <dadler at uni-goettingen.de> wrote:
> Dear R Core and CRAN Team,
>
> I received a warning that the rdyncall package [1] will be archived and removed from the main CRAN distribution at 7th of September
> if I can not get rid of .Internal calls.
>
>> From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
>> Subject: Use of .Internal in CRAN package rdyncall
>> Date: August 14, 2012 11:09:06 AM GMT+02:00
>> To: dadler at uni-goettingen.de
>>
>> R CMD check has been warning about the use of .Internal in packages
>> for several months now, in R-release since 2.15.0.  We have decided
>> that it will not be allowed at all in the next release of R (not least
>> because the work on long vectors means we need to move
>> argument-checking code between internal code and the R wrapper).
>>
>> So can we please have a package update without .Internal calls by
>> September 7 (or the package will be archived).  You should also check
>> the R-devel CRAN check pages at
>> http://cran.r-project.org/web/checks/check_results_<pkg>.html (replace
>> <pkg> by the name of your package) for any other issues that need to
>> be addressed.
>
>
> The use of .Internal in rdyncall was due to a missing interface for namespace object management.
> Since the main task of this package is to offer an alternative FFI *AND* a catalog of ready-to-use bindings to
> popular C libraries (across platforms) and interface for attach/remove of namespace objects was required.
> The current implementation uses a small snippet of code "makeNamespace" from src/library/base/R/namespace.R and we have to make a
> call to .Internal(registerNamespace).
>
> A request was made on the mailing list in the past:
>
> https://stat.ethz.ch/pipermail/r-devel/2011-December/062839.html
>
> Since the deadline is very soon, I emphasize and repeat my request for an R programming interface to namespace objects
> and I please you for advices to go about this issue.
>
> Are there any other plans for opening the interface to namespace management?
>
> The namespace creation function 'makeNamespace' is currently defined in a local scope to another function
> making it not accessible from the outside.
> 'registerNamespace' is a functionality only available via '.Internal'.
> So what is 'good pratice' for opening access to this - another wrapper in 'base' that calls '.Internal' ?
>
> It would be very sad if rdyncall is dropped from CRAN since more and more package authors are using it for different applications.
> For those that need more detail, there is an article on R Journal (http://journal.r-project.org/archive/2012-1/RJournal_2012-1_Adler.pdf)
>
> Any help, comment and advice is very appreciated.
>
> Thank you
> - Daniel
>

This is also very relevant for devtools. There have been some recent
changes to the in-development version of devtools, so that it loads
development packages into a namespace. Previously, it didn't use
namespaces, but now that it does, it much more closely approximates
normal package loading behavior.

It now uses the internal functions registerNamespace and
unregisterNamespace. Is there a workaround to do these things without
using the internal functions?

-Winston


From hadley at rice.edu  Mon Aug 20 17:09:51 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 20 Aug 2012 10:09:51 -0500
Subject: [Rd] rdyncall fears removal from CRAN
In-Reply-To: <CAFOpNVHbgq+aKS2WGF_Pf_BXSR1H11ucaMAFVJ4+EBtR8VNePw@mail.gmail.com>
References: <20120814090906.31F128144A@gannet.stats.ox.ac.uk>
	<F0DD11BC-94E6-486A-9E25-9379D2B6BBE4@uni-goettingen.de>
	<CAFOpNVHbgq+aKS2WGF_Pf_BXSR1H11ucaMAFVJ4+EBtR8VNePw@mail.gmail.com>
Message-ID: <CABdHhvEbFzKTybO=tr8gSFfBxm1KuHrcya1OMGqi6RT9Jo3UXA@mail.gmail.com>

> This is also very relevant for devtools. There have been some recent
> changes to the in-development version of devtools, so that it loads
> development packages into a namespace. Previously, it didn't use
> namespaces, but now that it does, it much more closely approximates
> normal package loading behavior.
>
> It now uses the internal functions registerNamespace and
> unregisterNamespace. Is there a workaround to do these things without
> using the internal functions?

We're very aware that using these internal functions ties us to a
specific version of R, and that they may change at any point in the
future and break our code. That's an acceptable trade-off - using
these internal functions gives us capabilities that makes fixing the
code in the future worthwhile.

A minimal change to R that would satisfy our needs (and I suspect
Daniel's) would be to move makeNamespace into the base package (i.e.
up out of the function it is currently contained in), and to create R
wrapper functions for registerNamespace and unregisterNamespace.  They
wouldn't even need to be exported - we know what we're doing is
dangerous.

If that solution isn't acceptable, we'd also be very happy to work
with any R-core member to help develop a public facing API for
namespace manipulation, including providing tests for common use
cases.

Please let us know what we can do to help!

Hadley

-- 
Assistant Professor
Department of Statistics / Rice University
http://had.co.nz/


From peter.vorpahl at uni-potsdam.de  Tue Aug 21 01:10:25 2012
From: peter.vorpahl at uni-potsdam.de (Peter Vorpahl)
Date: Tue, 21 Aug 2012 01:10:25 +0200
Subject: [Rd] Problem with initializiing R main loop under Windows
 (R.dll-version: 2.15.1)
Message-ID: <5032C3E1.9010604@uni-potsdam.de>

Dear R-developers,
even though I may not be the first one to encounter the problem 
described below, I would really appreciate some help or a link to a 
forum where this topic is being discussed. Probably I am simply 
misinformed on the usage of structRstart but see for youselve.
I did check multiple forums and the whole internet on the topic without 
success.
I am using the shared library version of R under Windows and my 
application is intended to provide a two-way interaction with R.

The code snippet, I use to initialize and start the repl is:

     void RServer::run()
     {

         // If we have no GUI frontend running, don't init the R-server
         if (!connectToGui()) return;

         // set the start time
         R_setStartTime();

         // Definel callback handler struct
         structRstart RParams;
         R_DefParams (&RParams);
         RParams.R_Quiet        = FALSE; //
         RParams.R_Interactive  = TRUE;
         RParams.R_Verbose      = FALSE;
         RParams.R_Slave        = FALSE;
         RParams.RestoreAction  = SA_RESTORE;
         RParams.SaveAction     = SA_NOSAVE;
         RParams.rhome          = get_R_HOME ();
         RParams.home           = getRUser ();
         RParams.CharacterMode  = LinkDLL; // RGui;
         RParams.ShowMessage    = RShowMessage;
         RParams.ReadConsole    = RReadConsoleWin;
         RParams.WriteConsoleEx = RWriteConsoleEx;
         RParams.WriteConsole   = 0;
         RParams.CallBack       = RDoProcessEvents;
         RParams.YesNoCancel    = RAskYesNoCancel;
         RParams.Busy           = RBusy;

         // Install own handlers
         R_SetParams(&RParams);

         // flush the console input buffer
         // call to WINAPI: clears all that's in stdin
         FlushConsoleInputBuffer(GetStdHandle(STD_INPUT_HANDLE));

         // Fake a command line
         int argc = 2;
         char* argv[2] = { qstrdup ("--no-save"), qstrdup 
("--no-restore") };

         // redirect the BREAK signal to own handler
         signal(SIGBREAK, pi_onintr);

         // set the arguments in R
         R_set_command_line_arguments (argc, argv);

         // Here, the main initialization of R is performed
         setup_Rmainloop ();

         // Init the IO buffer and the global context
         R_ReplDLLinit();

         // if I use the following instead, no problem occurs on error 
in evaluation:
         // run_Rmainloop ();

         while ((_state== Connected || _state == Running) && 
R_ReplDLLdo1() > 0) {
             Pi::msleep(5); // to keep the processor cool
         };

         // Usually we don't get here on q()

         R_RunExitFinalizers();

         Rf_KillAllDevices();

     }

This, however is mostly adapted from 'writing R extensions'. 
Nonetheless, this way I receive an abnormal program termination whenever 
an error occurs in the evaluation of code returned from 
'RReadConsoleWin'. I'm pretty sure that there is no problem in my code, 
since,  if I use 'run_Rmainloop ()' instead, everyting works fine but I 
have no control on the exit of the program. This implies that my program 
would not be able to do proper clean up at end.
I would really appreciate some help here.
Yours sincerely,
Peter

-- 
Institute of Earth and Environmental Sciences, University of Potsdam
Karl-Liebknecht-Str. 24/25 (House 12), 14476 Potsdam, Germany
office: +49 331 977 2469
mobile: +49 173 3732867
e-mail: peter.vorpahl at uni-potsdam.de


From lawrence.michael at gene.com  Tue Aug 21 14:25:39 2012
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 21 Aug 2012 05:25:39 -0700
Subject: [Rd] callNextMethod and "..." issue
Message-ID: <CAOQ5NyfQAdLcDG2bTs_JZbkfYiyUE+56dfs93+B8m4wk9ZYOfA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120821/5c06ee6d/attachment.pl>

From mtmorgan at fhcrc.org  Tue Aug 21 15:50:51 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 21 Aug 2012 06:50:51 -0700
Subject: [Rd] parLapply fails to detect default cluster?
Message-ID: <5033923B.1050107@fhcrc.org>

invoking parLapply without a cluster fails to find a previously 
registered cluster

 > library(parallel)
 > setDefaultCluster(makePSOCKcluster(2))
 > parLapply(X=1:2, fun=function(...) {})
Error in cut.default(i, breaks) : invalid number of intervals

This is because in parLapply length(cl) is determined before 
defaultCluster(cl) is called. By inspection, this appears to be true of 
other high-level functions, but ironically not of parApply.

In defaultCluster, t would also be helpful to check that the detected 
cluster, user-supplied or other, is a valid cluster.

diff attached.

Martin
-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793
-------------- next part --------------
A non-text attachment was scrubbed...
Name: defaultCluster.diff
Type: text/x-patch
Size: 2190 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120821/50679d0b/attachment.bin>

From pchausse at uwaterloo.ca  Tue Aug 21 16:58:11 2012
From: pchausse at uwaterloo.ca (Pierre Chausse)
Date: Tue, 21 Aug 2012 10:58:11 -0400
Subject: [Rd] GPU Computing
Message-ID: <5033A203.5070807@mailservices.uwaterloo.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120821/bd8e948a/attachment.pl>

From matloff at cs.ucdavis.edu  Tue Aug 21 23:10:44 2012
From: matloff at cs.ucdavis.edu (Norm Matloff)
Date: Tue, 21 Aug 2012 14:10:44 -0700
Subject: [Rd] GPU Computing
Message-ID: <20120821211044.GA14319@laura>

Oops, sent to the wrong list (again), sorry.

Date: Tue, 21 Aug 2012 13:54:48 -0700
From: Norm Matloff <matloff at cs.ucdavis.edu>
To: r-sig-hpc at r-project.org
Subject: Re: [R-sig-hpc] GPU Computing

Peter Chausse wrote:

> I am looking for a function similar to mclapply() that would work with
> GPU cores. I have looked at all possible packages related to GPU...

The short answer is no.

Functions like mclapply() work on, say a quad core machine, by setting
up new invocations of R to run on each of the four CPU cores.  What you
have in mind would mean having R run on each of the GPU cores.  This is
not possible, for a variety of reasons (R needs a terminal shell, it
needs I/O etc.).

To have R take advantage of GPUs, one must write C/C++ (or FORTRAN)
code.  Currently packages that do this are very limited.  See the
relevant CRAN Task View, at

http://cran.r-project.org/web/views/HighPerformanceComputing.html

You might also take a look at my Rth package, at

http://heather.cs.ucdavis.edu/~matloff/rth.html 

Norm Matloff


From asaguiar at spsconsultoria.com  Wed Aug 22 05:08:34 2012
From: asaguiar at spsconsultoria.com (Alexandre Aguiar)
Date: Wed, 22 Aug 2012 00:08:34 -0300
Subject: [Rd] fmod() is used for %%?
Message-ID: <201208220008.40998@spsconsultoria.com>

Hi,

Is the standard C math function fmod() used for R module operations? Could 
not find it in the sources.

Thanks.

-- 


Alexandre

--
Alexandre Santos Aguiar, MD, SCT

gpg public key: mailto:gpgkey at asaguiar.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120822/52b30a89/attachment.bin>

From ripley at stats.ox.ac.uk  Wed Aug 22 07:06:34 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 22 Aug 2012 06:06:34 +0100
Subject: [Rd] fmod() is used for %%?
In-Reply-To: <201208220008.40998@spsconsultoria.com>
References: <201208220008.40998@spsconsultoria.com>
Message-ID: <503468DA.5080204@stats.ox.ac.uk>

On 22/08/2012 04:08, Alexandre Aguiar wrote:
> Hi,
>
> Is the standard C math function fmod() used for R module operations? Could
> not find it in the sources.

No.  See src/main/arithmetic.c .


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Tue Aug 21 21:34:13 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 21 Aug 2012 15:34:13 -0400
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <20527.50144.797572.795413@stat.math.ethz.ch>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
	<20527.50144.797572.795413@stat.math.ethz.ch>
Message-ID: <5033E2B5.8000308@gmail.com>

On 12-08-18 12:33 PM, Martin Maechler wrote:
>>>>>> Joshua Ulrich <josh.m.ulrich at gmail.com>
>>>>>>      on Sat, 18 Aug 2012 10:16:09 -0500 writes:
>
>      > I don't know if this is better, but it's the most obvious/shortest I
>      > could come up with.  Transpose the data.frame column to a 'row' vector
>      > and drop the dimensions.
>
>      R> identical(nv, drop(t(df)))
>      > [1] TRUE
>
> Yes, that's definitely shorter,
> congratulations!
>
> One gotta is that I'd want a solution that also works when the
> df has more columns than just one...
>
> Your idea to use  t(.) is nice and "perfect" insofar as it
> coerces the data frame to a matrix, and that's really the clue:
>
> Where as  df[,1]  is losing the names,
> the matrix indexing is not.
> So your solution can be changed into
>
>       t(df)[1,]
>
> which is even shorter...
> and slightly less efficient, at least conceptually, than mine, which has
> been
>
>     as.matrix(df)[,1]
>
> Now, the remaining question is:  Shouldn't there be something
> more natural to achieve that?
> (There is not, currently, AFAIK).

I've been offline, so I'm a bit late to this game, but the examples 
above fail when df contains a character column as well as the desired 
one, because everything gets coerced to a character matrix.  You need to 
select the column first, then convert to a matrix, e.g.

drop(t(df[,1,drop=FALSE]))

Duncan Murdoch

>
> Martin
>
>
>      > Best,
>      > --
>      > Joshua Ulrich  |  about.me/joshuaulrich
>      > FOSS Trading  |  www.fosstrading.com
>
>
>      > On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
>      > <maechler at stat.math.ethz.ch> wrote:
>      >> Today, I was looking for an elegant (and efficient) way to get a named
>      >> (atomic) vector by selecting one column of a data frame.  Of course,
>      >> the vector names must be the rownames of the data frame.
>      >>
>      >> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but was
>      >> wondering if there are obvious better ones, and also if this should
>      >> not become more idiomatic (hence "R-devel"):
>      >>
>      >> Consider this toy example, where the dataframe already has only one
>      >> column :
>      >>
>      >>> nv <- c(a=1, d=17, e=101); nv
>      >> a   d   e
>      >> 1  17 101
>      >>
>      >>> df <- as.data.frame(cbind(VAR = nv)); df
>      >> VAR
>      >> a   1
>      >> d  17
>      >> e 101
>      >>
>      >> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>      >>
>      >>> identical(nv, .......)
>      >> [1] TRUE
>      >>
>      >> where ...... only uses 'df' (and no non-standard R packages)?
>      >>
>      >> As said, I know a simple solution (*), but I'm sure it is not
>      >> obvious to most R users and probably not even to the majority of
>      >> R-devel readers... OTOH, people like Bill Dunlap will not take
>      >> long to provide it or a better one.
>      >>
>      >> (*) In my solution, the above '.......' consists of 17 letters.
>      >> I'll post it later today (CEST time) ... or confirm
>      >> that someone else has done so.
>      >>
>      >> Martin
>      >>
>      >> ______________________________________________
>      >> R-devel at r-project.org mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From josh.m.ulrich at gmail.com  Wed Aug 22 16:15:00 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 22 Aug 2012 09:15:00 -0500
Subject: [Rd] Quiz: How to get a "named column" from a data frame
In-Reply-To: <5033E2B5.8000308@gmail.com>
References: <20527.44736.486888.854733@stat.math.ethz.ch>
	<CAPPM_gRmc+VE3ZGJ3TzTn6m4qb4ToUq30X0USATmmEjxq3u4dA@mail.gmail.com>
	<20527.50144.797572.795413@stat.math.ethz.ch>
	<5033E2B5.8000308@gmail.com>
Message-ID: <CAPPM_gSOvpTxvCU3n7C_+TedAkG0j-_tMtZgwbg64Sk1qhFq0w@mail.gmail.com>

On Tue, Aug 21, 2012 at 2:34 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 12-08-18 12:33 PM, Martin Maechler wrote:
>>>>>>>
>>>>>>> Joshua Ulrich <josh.m.ulrich at gmail.com>
>>>>>>>      on Sat, 18 Aug 2012 10:16:09 -0500 writes:
>>
>>
>>      > I don't know if this is better, but it's the most obvious/shortest
>> I
>>      > could come up with.  Transpose the data.frame column to a 'row'
>> vector
>>      > and drop the dimensions.
>>
>>      R> identical(nv, drop(t(df)))
>>      > [1] TRUE
>>
>> Yes, that's definitely shorter,
>> congratulations!
>>
>> One gotta is that I'd want a solution that also works when the
>> df has more columns than just one...
>>
>> Your idea to use  t(.) is nice and "perfect" insofar as it
>> coerces the data frame to a matrix, and that's really the clue:
>>
>> Where as  df[,1]  is losing the names,
>> the matrix indexing is not.
>> So your solution can be changed into
>>
>>       t(df)[1,]
>>
>> which is even shorter...
>> and slightly less efficient, at least conceptually, than mine, which has
>> been
>>
>>     as.matrix(df)[,1]
>>
>> Now, the remaining question is:  Shouldn't there be something
>> more natural to achieve that?
>> (There is not, currently, AFAIK).
>
>
> I've been offline, so I'm a bit late to this game, but the examples above
> fail when df contains a character column as well as the desired one, because
> everything gets coerced to a character matrix.  You need to select the
> column first, then convert to a matrix, e.g.
>
> drop(t(df[,1,drop=FALSE]))
>

That's true, but I was assuming a one-column data.frame, which can be
achieved via:
df <- data.frame(VAR=nv,CHAR=letters[1:3],stringsAsFactors=FALSE)
drop(t(df[1]))

That said, I prefer the setNames() solution for its efficiency.

Best,
Josh

> Duncan Murdoch
>
>
>>
>> Martin
>>
>>
>>      > Best,
>>      > --
>>      > Joshua Ulrich  |  about.me/joshuaulrich
>>      > FOSS Trading  |  www.fosstrading.com
>>
>>
>>      > On Sat, Aug 18, 2012 at 10:03 AM, Martin Maechler
>>      > <maechler at stat.math.ethz.ch> wrote:
>>      >> Today, I was looking for an elegant (and efficient) way to get a
>> named
>>      >> (atomic) vector by selecting one column of a data frame.  Of
>> course,
>>      >> the vector names must be the rownames of the data frame.
>>      >>
>>      >> Ok, here is the quiz, I know one quite "cute"/"slick" answer, but
>> was
>>      >> wondering if there are obvious better ones, and also if this
>> should
>>      >> not become more idiomatic (hence "R-devel"):
>>      >>
>>      >> Consider this toy example, where the dataframe already has only
>> one
>>      >> column :
>>      >>
>>      >>> nv <- c(a=1, d=17, e=101); nv
>>      >> a   d   e
>>      >> 1  17 101
>>      >>
>>      >>> df <- as.data.frame(cbind(VAR = nv)); df
>>      >> VAR
>>      >> a   1
>>      >> d  17
>>      >> e 101
>>      >>
>>      >> Now how, can I get 'nv' back from 'df' ?   I.e., how to get
>>      >>
>>      >>> identical(nv, .......)
>>      >> [1] TRUE
>>      >>
>>      >> where ...... only uses 'df' (and no non-standard R packages)?
>>      >>
>>      >> As said, I know a simple solution (*), but I'm sure it is not
>>      >> obvious to most R users and probably not even to the majority of
>>      >> R-devel readers... OTOH, people like Bill Dunlap will not take
>>      >> long to provide it or a better one.
>>      >>
>>      >> (*) In my solution, the above '.......' consists of 17 letters.
>>      >> I'll post it later today (CEST time) ... or confirm
>>      >> that someone else has done so.
>>      >>
>>      >> Martin
>>      >>
>>      >> ______________________________________________
>>      >> R-devel at r-project.org mailing list
>>      >> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From josh.m.ulrich at gmail.com  Wed Aug 22 19:35:51 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 22 Aug 2012 12:35:51 -0500
Subject: [Rd] Suggestion for "Writing R Extensions"
Message-ID: <CAPPM_gSvsq+EgfLmj_MiYpwuZu=m+HomiwfR0ttOhrKd8YY5bw@mail.gmail.com>

Hi,

Early in Chapter 1, the manual states:
"A computing environment including a number of tools is assumed; the
"R Installation and Administration" manual describes what is needed.
Under a Unix-alike most of the tools are likely to be present by
default, but Microsoft Windows may require careful setup."

Would it make sense to add links and/or mention the relevant
appendices (A and D) of "R Installation and Administration"?

Best,
--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From oliver at first.in-berlin.de  Wed Aug 22 21:58:35 2012
From: oliver at first.in-berlin.de (Oliver Bandel)
Date: Wed, 22 Aug 2012 21:58:35 +0200
Subject: [Rd] Suggestion for "Writing R Extensions"
In-Reply-To: <CAPPM_gSvsq+EgfLmj_MiYpwuZu=m+HomiwfR0ttOhrKd8YY5bw@mail.gmail.com>
References: <CAPPM_gSvsq+EgfLmj_MiYpwuZu=m+HomiwfR0ttOhrKd8YY5bw@mail.gmail.com>
Message-ID: <20120822215835.18623mj5l6bmlwiz@webmail.in-berlin.de>

Hello,


Zitat von "Joshua Ulrich" <josh.m.ulrich at gmail.com> (Wed, 22 Aug 2012  
12:35:51 -0500)

[...]
> Would it make sense to add links and/or mention the relevant
> appendices (A and D) of "R Installation and Administration"?
[...]

I do not understad, what your question is all about.

Maybe you should be more verbose.

Do you want to make the document better,
or do you have questions on how to understand
what it talks about?


Ciao,
    Oliver


From josh.m.ulrich at gmail.com  Wed Aug 22 22:13:39 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 22 Aug 2012 15:13:39 -0500
Subject: [Rd] Suggestion for "Writing R Extensions"
In-Reply-To: <20120822215835.18623mj5l6bmlwiz@webmail.in-berlin.de>
References: <CAPPM_gSvsq+EgfLmj_MiYpwuZu=m+HomiwfR0ttOhrKd8YY5bw@mail.gmail.com>
	<20120822215835.18623mj5l6bmlwiz@webmail.in-berlin.de>
Message-ID: <CAPPM_gShH=C+ygotDweYHdZRg9J44A3ucstcmFf92KkzxrPTPA@mail.gmail.com>

On Wed, Aug 22, 2012 at 2:58 PM, Oliver Bandel
<oliver at first.in-berlin.de> wrote:
> Hello,
>
>
> Zitat von "Joshua Ulrich" <josh.m.ulrich at gmail.com> (Wed, 22 Aug 2012
> 12:35:51 -0500)
>
> [...]
>
>> Would it make sense to add links and/or mention the relevant
>> appendices (A and D) of "R Installation and Administration"?
>
> [...]
>
> I do not understad, what your question is all about.
>
> Maybe you should be more verbose.
>
> Do you want to make the document better,
> or do you have questions on how to understand
> what it talks about?
>
The sentences I quoted, which you removed from the thread, point the
reader to "R Installation and Administration".  Rather than point the
reader to the entire manual, I suggest pointing them to the relevant
appendices (A and D) of "R Installation and Administration".

>
> Ciao,
>    Oliver
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From deepayan.sarkar at gmail.com  Thu Aug 23 16:57:44 2012
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Thu, 23 Aug 2012 20:27:44 +0530
Subject: [Rd] warning in lattice key function
In-Reply-To: <CAGx1TMC_L9OV4SjYvnvoGJ2F-6+MhkD8eZ5eTbmQgQ5UMQY69w@mail.gmail.com>
References: <CAGx1TMC_L9OV4SjYvnvoGJ2F-6+MhkD8eZ5eTbmQgQ5UMQY69w@mail.gmail.com>
Message-ID: <CADfFDC62yWfffWjjkb699h3C3WbJ9A7Qto3Tbw3M+iRmHZeSPw@mail.gmail.com>

On Thu, Aug 16, 2012 at 8:35 AM, Richard M. Heiberger <rmh at temple.edu> wrote:
> ## this example shows a problem in key.
> tmp <- data.frame(y=rnorm(10), g=rep(ordered(c("A","B")), 5))
> bwplot(y ~ g, data=tmp,
>        key=list(
>          text=list(c("A","B"), col=c("blue","red")),
>          points=list(pch=c(17, 16), col=c("blue","red")),
>          space="top", columns=2, border=TRUE,
>          title="Treatment", cex.title=.9
>          )
>        )
> ## The example works without warning messages in 2.15.1.

Thanks for the report. This is due to rep(NULL, length.out=...) now
giving a warning.

As Prof Ripley has mentioned, a similar bug was fixed elsewhere, but
this one still persists. I haven't yet found an easy way of fixing all
of these, so if you find more instances, please report them to me (or
file a bug at https://r-forge.r-project.org/tracker/?func=browse&group_id=638&atid=2567),
and I'll take a look as soon as possible.

-Deepayan


> ## I first detected the problem in
> ##### R Under development (unstable) (2012-07-24 r59961) ## windows
> ##### R Under development (unstable) (2012-08-02 r60091) ## macintosh
> ## The problem still exists in
> ## R Under development (unstable) (2012-08-13 r60245) -- "Unsuffered
> Consequences"
> ## downloaded from lib.stat.cmu.edu Wed Aug 15 2012 11PM EST
>
>
>> tmp <- data.frame(y=rnorm(10), g=rep(ordered(c("A","B")), 5))
>> bwplot(y ~ g, data=tmp,
> +        key=list(
> +          text=list(c("A","B"), col=c("blue","red")),
> +          points=list(pch=c(17, 16), col=c("blue","red")),
> +          space="top", columns=2, border=TRUE,
> +          title="Treatment", cex.title=.9
> +          )
> +        )
> Warning messages:
> 1: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 2: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 3: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 4: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
> 5: In FUN(X[[9L]], ...) : 'x' is NULL so the result will be NULL
>> version
>                _
> platform       i386-w64-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status         Under development (unstable)
> major          2
> minor          16.0
> year           2012
> month          08
> day            13
> svn rev        60245
> language       R
> version.string R Under development (unstable) (2012-08-13 r60245)
> nickname       Unsuffered Consequences
>>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hb at biostat.ucsf.edu  Thu Aug 23 20:54:33 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 23 Aug 2012 11:54:33 -0700
Subject: [Rd] Milestone: 4000 packages on CRAN
Message-ID: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>

Today (2012-08-23) on CRAN [1]:

"Currently, the CRAN package repository features 4001 available packages."

These packages are maintained by approximately 2350 different folks.

Previous milestones:

2011-05-12: 3,000 packages [1]
2009-10-04: 2,000 packages [2]
2007-04-12: 1,000 packages [3]
2004-10-01:    500 packages [4]
2003-04-01:    250 packages [4]

[1] http://cran.r-project.org/web/packages/
[2] https://stat.ethz.ch/pipermail/r-devel/2009-October/055049.html
[3] https://stat.ethz.ch/pipermail/r-devel/2007-April/045359.html
[4] My private in-house data.
[5] http://cran.r-project.org/web/checks/check_summary_by_maintainer.html

/Henrik

PS. This count includes only packages on CRAN.  There are more
packages elsewhere.


From edd at debian.org  Thu Aug 23 21:30:12 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 23 Aug 2012 14:30:12 -0500
Subject: [Rd] Milestone: 4000 packages on CRAN
In-Reply-To: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
References: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
Message-ID: <20534.33988.849383.692946@max.nulle.part>


R-release:

edd at max:~$ r -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
[1] 3988
edd at max:~$ 

R-devel (version as of a few days ago):

edd at max:~$ ~/bin/Rscript-devel.sh -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
[1] 3988
edd at max:~$ 

There is a bug somewhere if another count gives 4001.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From ripley at stats.ox.ac.uk  Thu Aug 23 21:42:37 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 23 Aug 2012 20:42:37 +0100
Subject: [Rd] Milestone: 4000 packages on CRAN
In-Reply-To: <20534.33988.849383.692946@max.nulle.part>
References: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
	<20534.33988.849383.692946@max.nulle.part>
Message-ID: <503687AD.3040107@stats.ox.ac.uk>

On 23/08/2012 20:30, Dirk Eddelbuettel wrote:
>
> R-release:
>
> edd at max:~$ r -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
> [1] 3988
> edd at max:~$
>
> R-devel (version as of a few days ago):
>
> edd at max:~$ ~/bin/Rscript-devel.sh -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
> [1] 3988
> edd at max:~$
>
> There is a bug somewhere if another count gives 4001.

Hint: available.packages() has filters, so you are not seeing the 
Windows-only packages.

Note too that the number of packages on CRAN is not monotone: packages 
get added, packages get withdrawn/archived, sometimes 10s at a time.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Thu Aug 23 22:01:41 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 23 Aug 2012 15:01:41 -0500
Subject: [Rd] Milestone: 4000 packages on CRAN
In-Reply-To: <503687AD.3040107@stats.ox.ac.uk>
References: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
	<20534.33988.849383.692946@max.nulle.part>
	<503687AD.3040107@stats.ox.ac.uk>
Message-ID: <20534.35877.77471.880193@max.nulle.part>


On 23 August 2012 at 20:42, Prof Brian Ripley wrote:
| On 23/08/2012 20:30, Dirk Eddelbuettel wrote:
| >
| > R-release:
| >
| > edd at max:~$ r -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
| > [1] 3988
| > edd at max:~$
| >
| > R-devel (version as of a few days ago):
| >
| > edd at max:~$ ~/bin/Rscript-devel.sh -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
| > [1] 3988
| > edd at max:~$
| >
| > There is a bug somewhere if another count gives 4001.
| 
| Hint: available.packages() has filters, so you are not seeing the 
| Windows-only packages.

But should I not get all via a default type of 'source' as I am on Linux?
 
| Note too that the number of packages on CRAN is not monotone: packages 
| get added, packages get withdrawn/archived, sometimes 10s at a time.

  http://dirk.eddelbuettel.com/cranberries/cran/new/		## New pkgs

  http://dirk.eddelbuettel.com/cranberries/cran/removed/	## Rm'ed pkg

  http://dirk.eddelbuettel.com/cranberries/cran/updated/	## Updates

as well as the overall

  http://dirk.eddelbuettel.com/cranberries/

Today was pretty entertaining with package mRMRe added as 'new' only to be
removed a few hours later.  Fun times...

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From ripley at stats.ox.ac.uk  Thu Aug 23 22:19:07 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 23 Aug 2012 21:19:07 +0100
Subject: [Rd] Milestone: 4000 packages on CRAN
In-Reply-To: <20534.35877.77471.880193@max.nulle.part>
References: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
	<20534.33988.849383.692946@max.nulle.part>
	<503687AD.3040107@stats.ox.ac.uk>
	<20534.35877.77471.880193@max.nulle.part>
Message-ID: <5036903B.6010102@stats.ox.ac.uk>

On 23/08/2012 21:01, Dirk Eddelbuettel wrote:
>
> On 23 August 2012 at 20:42, Prof Brian Ripley wrote:
> | On 23/08/2012 20:30, Dirk Eddelbuettel wrote:
> | >
> | > R-release:
> | >
> | > edd at max:~$ r -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
> | > [1] 3988
> | > edd at max:~$
> | >
> | > R-devel (version as of a few days ago):
> | >
> | > edd at max:~$ ~/bin/Rscript-devel.sh -e 'AP <- available.packages(contrib.url("http://cran.r-project.org")); print(dim(AP)[1])'
> | > [1] 3988
> | > edd at max:~$
> | >
> | > There is a bug somewhere if another count gives 4001.
> |
> | Hint: available.packages() has filters, so you are not seeing the
> | Windows-only packages.
>
> But should I not get all via a default type of 'source' as I am on Linux?

No.  Amongst the default filters is

      ?"OS_type"? exclude packages whose OS requirement is incompatible
           with this version of R: that is exclude Windows-only packages
           on a Unix-alike platform and _vice versa_.

 > nrow(available.packages())
[1] 3988
 > nrow(available.packages(filter=list()))
[1] 4001


>
> | Note too that the number of packages on CRAN is not monotone: packages
> | get added, packages get withdrawn/archived, sometimes 10s at a time.
>
>    http://dirk.eddelbuettel.com/cranberries/cran/new/		## New pkgs
>
>    http://dirk.eddelbuettel.com/cranberries/cran/removed/	## Rm'ed pkg

You mean archived ...

>    http://dirk.eddelbuettel.com/cranberries/cran/updated/	## Updates
>
> as well as the overall
>
>    http://dirk.eddelbuettel.com/cranberries/
>
> Today was pretty entertaining with package mRMRe added as 'new' only to be
> removed a few hours later.  Fun times...

Not true: it was archived in less than 1 hour.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From benjamin.hofner at imbe.med.uni-erlangen.de  Fri Aug 24 11:50:26 2012
From: benjamin.hofner at imbe.med.uni-erlangen.de (Benjamin Hofner)
Date: Fri, 24 Aug 2012 11:50:26 +0200
Subject: [Rd] Suggestion: Specify default of "pch" in the manual
Message-ID: <50374E62.9010800@imbe.med.uni-erlangen.de>

Both, in the manuals for par() and points() I could not find a note on 
the default value of "pch". I think it would be rather helpful to add a 
note that the default is 1 (in both manuals). This would, for example, 
help users that want to draw a legend.

And yes, I know that one can obtain the default by inspecting par() but 
I think for many users (especially beginneRs) this is not the first 
place to look for such information but the manual is.

    Benjamin


From S.Ellison at LGCGroup.com  Fri Aug 24 12:32:18 2012
From: S.Ellison at LGCGroup.com (S Ellison)
Date: Fri, 24 Aug 2012 11:32:18 +0100
Subject: [Rd] Milestone: 4000 packages on CRAN
In-Reply-To: <5036903B.6010102@stats.ox.ac.uk>
References: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
	<20534.33988.849383.692946@max.nulle.part>	<503687AD.3040107@stats.ox.ac.uk>
	<20534.35877.77471.880193@max.nulle.part>
	<5036903B.6010102@stats.ox.ac.uk>
Message-ID: <A4E5A0B016B8CB41A485FC629B633CED46954312F2@GOLD.corp.lgc-group.com>

 

> -----Original Message-----
> > | > There is a bug somewhere if another count gives 4001.
> > |
> > | Hint: available.packages() has filters, so you are not seeing the 
> > | Windows-only packages.
.....
>       '"OS_type"' exclude packages whose OS requirement is 
> incompatible  with this version of R: that is exclude 
> Windows-only packages on a Unix-alike platform and _vice versa_.
>
> >
> > | Note too that the number of packages on CRAN is not monotone: 
> > | packages get added, packages get withdrawn/archived, 
> sometimes 10s at a time.

... from which we deduce* that even the combination of the world's best statisticians and a system entirely under their control does not guarantee an unambiguous count.

Anyone out there still think statistics are easy?

Even so, 4000 plus or minus a few says a great deal for the R project's impact 

S Ellison

*with limited accuracy but some entertainment

*******************************************************************
This email and any attachments are confidential. Any use...{{dropped:8}}


From c-w.hoffmann at sunrise.ch  Fri Aug 24 12:20:13 2012
From: c-w.hoffmann at sunrise.ch (Christian Hoffmann)
Date: Fri, 24 Aug 2012 12:20:13 +0200
Subject: [Rd] Fwd: Re: Package cwhmisc and problems
In-Reply-To: <50372066.4080807@stats.ox.ac.uk>
References: <50372066.4080807@stats.ox.ac.uk>
Message-ID: <5037555D.2010608@sunrise.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/f6d3bbd7/attachment.pl>

From lxh37 at psu.edu  Fri Aug 24 15:06:02 2012
From: lxh37 at psu.edu (LIYING HUANG)
Date: Fri, 24 Aug 2012 09:06:02 -0400 (EDT)
Subject: [Rd] include dll in R-package
In-Reply-To: <730750050.940776.1345812742149.JavaMail.root@psu.edu>
Message-ID: <1443238259.954908.1345813562745.JavaMail.root@psu.edu>


Hi,

We have several projects in the center done by researchers over years
in Fortran, there are copy right issues etc to prevent us from
giving away the source codes, but a lot of social scientist are 
interested to use the program. We tried to use dlls to make plugins 
(available in our website) in various statistics platforms 
(SAS, STATA and R) to make it available to general public.

We used to be able to build R package using dll on version R-2.7.0,
, but failed to build with newer R version with the same source. 
Any help is greatly appreciated. 

When I try to build R package for newer version of R, I could build 
to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz", 
I got error message as:

* using log directory 'D:/project/LCCA/lcca.Rcheck'
* using R version 2.15.1 (2012-06-22)
* using platform: i386-pc-mingw32 (32-bit)
* using session charset: ISO8859-1
* checking for file 'lcca/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'lcca' version '1.0.0'
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... WARNING
Found the following executable file(s):
  libs/lcca.dll
Source packages should not contain undeclared executable files.
See section 'Package structure' in the 'Writing R Extensions' manual.
* checking whether package 'lcca' can be installed ... ERROR
Installation failed.
See 'D:/project/LCCA/lcca.Rcheck/00install.out' for details.
 
and the message in 00install.out is:

* installing *source* package 'lcca' ...
** R
** data
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded
Error in library.dynam(lib, package, package.lib) : 
  DLL 'lcca' not found: maybe not installed for this architecture?
Error: loading failed
Execution halted
ERROR: loading failed
* removing 'D:/project/LCCA/lcca.Rcheck/lcca'


Thanks a lot!
Liy


From edd at debian.org  Fri Aug 24 16:16:07 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 24 Aug 2012 09:16:07 -0500
Subject: [Rd] include dll in R-package
In-Reply-To: <1443238259.954908.1345813562745.JavaMail.root@psu.edu>
References: <730750050.940776.1345812742149.JavaMail.root@psu.edu>
	<1443238259.954908.1345813562745.JavaMail.root@psu.edu>
Message-ID: <20535.36007.219897.187579@max.nulle.part>


On 24 August 2012 at 09:06, LIYING HUANG wrote:
| We have several projects in the center done by researchers over years
| in Fortran, there are copy right issues etc to prevent us from
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
| giving away the source codes, but a lot of social scientist are 
  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
| interested to use the program. We tried to use dlls to make plugins 
| (available in our website) in various statistics platforms 
| (SAS, STATA and R) to make it available to general public.
| 
| We used to be able to build R package using dll on version R-2.7.0,
| , but failed to build with newer R version with the same source. 
| Any help is greatly appreciated. 
| 
| When I try to build R package for newer version of R, I could build 
| to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz", 
| I got error message as:
| 
| * using log directory 'D:/project/LCCA/lcca.Rcheck'
| * using R version 2.15.1 (2012-06-22)
| * using platform: i386-pc-mingw32 (32-bit)
| * using session charset: ISO8859-1
| * checking for file 'lcca/DESCRIPTION' ... OK
| * checking extension type ... Package
| * this is package 'lcca' version '1.0.0'
| * checking package namespace information ... OK
| * checking package dependencies ... OK
| * checking if this is a source package ... OK
| * checking if there is a namespace ... OK
| * checking for executable files ... WARNING
| Found the following executable file(s):
|   libs/lcca.dll
| Source packages should not contain undeclared executable files.
| See section 'Package structure' in the 'Writing R Extensions' manual.
| * checking whether package 'lcca' can be installed ... ERROR

This tells you that in order to have a proper package, you need to include
the very source code you want to hide.

This is a CRAN Policy decision enforced by current R versions (but not the
rather old version you compared against), and there is now way around it.
You could try to construct "defunct" packages lacking the DLLs and instruct
the users to get them from somewhere else, but that is at the same rather
error prone (as you will lack all the built-time checks you would have with
source code, as well as a better assurrance that compatible tools are used)
and distasteful as CRAN is about Open Source.

So your best bet may be to go back to the copyright holders....

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From kasperdanielhansen at gmail.com  Fri Aug 24 16:19:14 2012
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Fri, 24 Aug 2012 10:19:14 -0400
Subject: [Rd] include dll in R-package
In-Reply-To: <1443238259.954908.1345813562745.JavaMail.root@psu.edu>
References: <730750050.940776.1345812742149.JavaMail.root@psu.edu>
	<1443238259.954908.1345813562745.JavaMail.root@psu.edu>
Message-ID: <CAC2h7utkB1iNKMUDSWwF0iUoAeYde0Wvza7_B+ANYy5P+wviVQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/6f302c0d/attachment.pl>

From kasperdanielhansen at gmail.com  Fri Aug 24 16:21:18 2012
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Fri, 24 Aug 2012 10:21:18 -0400
Subject: [Rd] include dll in R-package
In-Reply-To: <20535.36007.219897.187579@max.nulle.part>
References: <730750050.940776.1345812742149.JavaMail.root@psu.edu>
	<1443238259.954908.1345813562745.JavaMail.root@psu.edu>
	<20535.36007.219897.187579@max.nulle.part>
Message-ID: <CAC2h7ut1dfy-Tzf+j4zs8gOe-AobGYnvapwwqXhZoDu6BLcAoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/d41a5426/attachment.pl>

From jeff.a.ryan at gmail.com  Fri Aug 24 16:28:50 2012
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 24 Aug 2012 09:28:50 -0500
Subject: [Rd] include dll in R-package
In-Reply-To: <CAC2h7ut1dfy-Tzf+j4zs8gOe-AobGYnvapwwqXhZoDu6BLcAoA@mail.gmail.com>
References: <730750050.940776.1345812742149.JavaMail.root@psu.edu>
	<1443238259.954908.1345813562745.JavaMail.root@psu.edu>
	<20535.36007.219897.187579@max.nulle.part>
	<CAC2h7ut1dfy-Tzf+j4zs8gOe-AobGYnvapwwqXhZoDu6BLcAoA@mail.gmail.com>
Message-ID: <CABDUZc8DiJssR-B+7pHvb9AMrZMjr_zG+Bi1244jXRFrS_t2wA@mail.gmail.com>

Any package can link to external DLLs.  You'll need to make that an
explicit dependency, have some configure script and distribute the
library somewhere else, but many packages on CRAN already do this.

My RBerkeley uses a user installed Oracle Berkeley DB that is linked
to at configure time, of course there are many other examples as well.

And distributing _off_ CRAN is of course a reasonable alternative.

HTH
Jeff

On Fri, Aug 24, 2012 at 9:21 AM, Kasper Daniel Hansen
<kasperdanielhansen at gmail.com> wrote:
> On Fri, Aug 24, 2012 at 10:16 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> On 24 August 2012 at 09:06, LIYING HUANG wrote:
>> | We have several projects in the center done by researchers over years
>> | in Fortran, there are copy right issues etc to prevent us from
>>                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> | giving away the source codes, but a lot of social scientist are
>>   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> | interested to use the program. We tried to use dlls to make plugins
>> | (available in our website) in various statistics platforms
>> | (SAS, STATA and R) to make it available to general public.
>> |
>> | We used to be able to build R package using dll on version R-2.7.0,
>> | , but failed to build with newer R version with the same source.
>> | Any help is greatly appreciated.
>> |
>> | When I try to build R package for newer version of R, I could build
>> | to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz",
>> | I got error message as:
>> |
>> | * using log directory 'D:/project/LCCA/lcca.Rcheck'
>> | * using R version 2.15.1 (2012-06-22)
>> | * using platform: i386-pc-mingw32 (32-bit)
>> | * using session charset: ISO8859-1
>> | * checking for file 'lcca/DESCRIPTION' ... OK
>> | * checking extension type ... Package
>> | * this is package 'lcca' version '1.0.0'
>> | * checking package namespace information ... OK
>> | * checking package dependencies ... OK
>> | * checking if this is a source package ... OK
>> | * checking if there is a namespace ... OK
>> | * checking for executable files ... WARNING
>> | Found the following executable file(s):
>> |   libs/lcca.dll
>> | Source packages should not contain undeclared executable files.
>> | See section 'Package structure' in the 'Writing R Extensions' manual.
>> | * checking whether package 'lcca' can be installed ... ERROR
>>
>> This tells you that in order to have a proper package, you need to include
>> the very source code you want to hide.
>>
>> This is a CRAN Policy decision enforced by current R versions (but not the
>> rather old version you compared against), and there is now way around it.
>> You could try to construct "defunct" packages lacking the DLLs and instruct
>> the users to get them from somewhere else, but that is at the same rather
>> error prone (as you will lack all the built-time checks you would have with
>> source code, as well as a better assurrance that compatible tools are used)
>> and distasteful as CRAN is about Open Source.
>>
>> So your best bet may be to go back to the copyright holders....
>>
>
> Dirk's comments are extremely relevant if you were hoping to host the
> package on CRAN (which you basically won't be allowed to).  You can still
> distribute it from your institutions homepage I think.
>
> Kasper
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From lorenz at usgs.gov  Fri Aug 24 19:32:44 2012
From: lorenz at usgs.gov (David L Lorenz)
Date: Fri, 24 Aug 2012 12:32:44 -0500
Subject: [Rd] misc subdirectory
Message-ID: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/c8aa4a05/attachment.pl>

From Matthias.Kohl at stamats.de  Fri Aug 24 19:51:19 2012
From: Matthias.Kohl at stamats.de (Prof. Dr. Matthias Kohl)
Date: Fri, 24 Aug 2012 19:51:19 +0200
Subject: [Rd] misc subdirectory
In-Reply-To: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>
References: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>
Message-ID: <5037BF17.8040403@stamats.de>

make "misc" a subfolder of "inst"
hth
Matthias

On 24.08.2012 19:32, David L Lorenz wrote:
>    The utils package has a misc folder, and some other packages have
> folders that are not listed in the R-extensions documentation (?data?, ?
> demo?, ?exec?, ?inst?, ?man?, ?po?, ?src?, and ?tests?). I'd like to be
> able to put some ancillary data into a misc folder, but it's mere presence
> in the source folder or source tarball (created with R CMD build) does not
> mean that it gets put into the zip file (I'm using Windoze) for the
> package.
>    How do I get an extra, nonstandard subdirectory into a package?
>    Thanks.
> Dave
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Prof. Dr. Matthias Kohl
www.stamats.de


From kasperdanielhansen at gmail.com  Fri Aug 24 19:51:40 2012
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Fri, 24 Aug 2012 13:51:40 -0400
Subject: [Rd] misc subdirectory
In-Reply-To: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>
References: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>
Message-ID: <CAC2h7uud7O_GJLoHc_1QTLPv+s2Tgrfha-qRM=2PvjpDZg9k=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/b905e479/attachment.pl>

From edd at debian.org  Fri Aug 24 19:55:03 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 24 Aug 2012 12:55:03 -0500
Subject: [Rd] misc subdirectory
In-Reply-To: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>
References: <OF89FC7AE3.4366C39D-ON86257A64.005EE8D1-86257A64.006061B4@usgs.gov>
Message-ID: <20535.49143.722467.185249@max.nulle.part>


On 24 August 2012 at 12:32, David L Lorenz wrote:
|   The utils package has a misc folder, and some other packages have 
| folders that are not listed in the R-extensions documentation (?data?, ?
| demo?, ?exec?, ?inst?, ?man?, ?po?, ?src?, and ?tests?). I'd like to be 
| able to put some ancillary data into a misc folder, but it's mere presence 
| in the source folder or source tarball (created with R CMD build) does not 
| mean that it gets put into the zip file (I'm using Windoze) for the 
| package.
|   How do I get an extra, nonstandard subdirectory into a package?

>From the 'Writing R Extensions' manual, Section 1.1.3 "Package subdirectories":

      The contents of the `inst' subdirectory will be copied recursively
   to the installation directory.  Subdirectories of `inst' should not
   interfere with those used by R (currently, `R', `data', `demo', `exec',
   `libs', `man', `help', `html' and `Meta', and earlier versions used
   `latex', `R-ex').  The copying of the `inst' happens after `src' is
   built so its `Makefile' can create files to be installed.  Prior to R
   2.12.2, the files were installed on POSIX platforms with the
   permissions in the package sources, so care should be taken to ensure
   these are not too restrictive: `R CMD build' will make suitable
   adjustments.  To exclude files from being installed, one can specify a
   list of exclude patterns in file `.Rinstignore' in the top-level source
   directory.  These patterns should be Perl-like regular expressions (see
   the help for `regexp' in R for the precise details), one per line, to
   be matched(10) against the file and directory paths, e.g.
   `doc/.*[.]png$' will exclude all PNG files in `inst/doc' based on the
   (lower-case) extension.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From proebuck at mdanderson.org  Fri Aug 24 20:16:56 2012
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Fri, 24 Aug 2012 13:16:56 -0500
Subject: [Rd] Anybody have a WABAC machine?
Message-ID: <CC5D2F48.339A1%proebuck@mdanderson.org>

What version of R did the following functions make their debut?

    packageStartupMesssage
    paste0
    sprintf

Need to update some old packages...


From proebuck at mdanderson.org  Fri Aug 24 20:23:23 2012
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Fri, 24 Aug 2012 13:23:23 -0500
Subject: [Rd] PHP escapeshellcmd() equivalent
Message-ID: <CC5D30CB.339A7%proebuck@mdanderson.org>

Not that I recall running across such, but does R natively
provide something equivalent to PHP's escapeshellcmd() function
to escape shell job control, wildcards, etc?


From brian at braverock.com  Fri Aug 24 20:31:36 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Aug 2012 13:31:36 -0500
Subject: [Rd] PHP escapeshellcmd() equivalent
In-Reply-To: <CC5D30CB.339A7%proebuck@mdanderson.org>
References: <CC5D30CB.339A7%proebuck@mdanderson.org>
Message-ID: <5037C888.7010306@braverock.com>

On 08/24/2012 01:23 PM, Roebuck,Paul L wrote:
> Not that I recall running across such, but does R natively
> provide something equivalent to PHP's escapeshellcmd() function
> to escape shell job control, wildcards, etc?

Doesn't this question belong on R-help?

It has nothing to do with R's internals or the development of R itself.


From proebuck at mdanderson.org  Fri Aug 24 20:32:15 2012
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Fri, 24 Aug 2012 13:32:15 -0500
Subject: [Rd] Suggestion: Specify default of "pch" in the manual
In-Reply-To: <50374E62.9010800@imbe.med.uni-erlangen.de>
Message-ID: <CC5D32DF.339B0%proebuck@mdanderson.org>

On 8/24/12 4:50 AM, "Benjamin Hofner"
<benjamin.hofner at imbe.med.uni-erlangen.de> wrote:

>[SNIP]
> And yes, I know that one can obtain the default by inspecting par() but
> I think for many users (especially beginneRs) this is not the first
> place to look for such information but the manual is.

Funny, my occasional reading of R-Help questions had led me to believe
that almost no one read the manuals... :)


From josh.m.ulrich at gmail.com  Fri Aug 24 21:05:09 2012
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Fri, 24 Aug 2012 14:05:09 -0500
Subject: [Rd] Anybody have a WABAC machine?
In-Reply-To: <CC5D2F48.339A1%proebuck@mdanderson.org>
References: <CC5D2F48.339A1%proebuck@mdanderson.org>
Message-ID: <CAPPM_gR9J8xW1osnmy8kKQDka+Lm3eV=QjkzNaNDcis35_aPvA@mail.gmail.com>

grep -E "packageStartupMessage|print0|sprintf" *NEWS

You need *NEWS to ensure you search NEWS, ONEWS, and OONEWS.
--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


On Fri, Aug 24, 2012 at 1:16 PM, Roebuck,Paul L <proebuck at mdanderson.org> wrote:
> What version of R did the following functions make their debut?
>
>     packageStartupMesssage
>     paste0
>     sprintf
>
> Need to update some old packages...
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From spencer.graves at prodsyse.com  Fri Aug 24 22:38:53 2012
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Fri, 24 Aug 2012 13:38:53 -0700
Subject: [Rd] CRAN check error with no example?
Message-ID: <5037E65D.3020501@prodsyse.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/8408cd39/attachment.pl>

From hb at biostat.ucsf.edu  Sat Aug 25 00:35:57 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Fri, 24 Aug 2012 15:35:57 -0700
Subject: [Rd] CRAN check error with no example?
In-Reply-To: <5037E65D.3020501@prodsyse.com>
References: <5037E65D.3020501@prodsyse.com>
Message-ID: <CAFDcVCRaPpu5rFPndrEo=fJa4Jbpe2j01Qh3pNoV5pONnsgdCw@mail.gmail.com>

For what it's worth, I got that exact same error the other day when
running R CMD check --as-cran on fda v2.2.8 and 'hyperSpec
v0.98-20120713 (out of 84 other packages) when using R Under
development (unstable) (2012-08-14 r60264) [Platform:
x86_64-w64-mingw32/x64 (64-bit)].  Those errors did not show with R
version 2.15.1 Patched (2012-08-16 r60282) [Platform:
x86_64-w64-mingw32/x64 (64-bit)].

/Henrik

On Fri, Aug 24, 2012 at 1:38 PM, Spencer Graves
<spencer.graves at prodsyse.com> wrote:
> Hello, All:
>
>
>        The CRAN checks for the "fda" package includes one error:
>
>
> The error most likely occurred in ... file.copy2
> ...
>
> Error: unprotect_ptr: pointer not found
> Execution halted
>
>
> (http://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian/fda-00check.html)
>
>
>        The help page for "file.copy2" includes "\examples" with
> everything wrapped in "\dontrun".
>
>
>        I'm unable to replicate this error.  I'm about to submit a new
> version of the fda package to CRAN, but I felt a need to ask about this
> first.
>
>
>        Thanks,
>        Spencer
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From spencer.graves at prodsyse.com  Sat Aug 25 03:57:39 2012
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Fri, 24 Aug 2012 18:57:39 -0700
Subject: [Rd] CRAN check error with no example?
In-Reply-To: <CAFDcVCRaPpu5rFPndrEo=fJa4Jbpe2j01Qh3pNoV5pONnsgdCw@mail.gmail.com>
References: <5037E65D.3020501@prodsyse.com>
	<CAFDcVCRaPpu5rFPndrEo=fJa4Jbpe2j01Qh3pNoV5pONnsgdCw@mail.gmail.com>
Message-ID: <50383113.9090401@prodsyse.com>

Hi, Henrik:


       Thanks.  That suggests I should ignore this error message. That 
was my tentative plan, but I felt a need to mention it to this group 
before I did.


       Best Wishes,
       Spencer


On 8/24/2012 3:35 PM, Henrik Bengtsson wrote:
> For what it's worth, I got that exact same error the other day when
> running R CMD check --as-cran on fda v2.2.8 and 'hyperSpec
> v0.98-20120713 (out of 84 other packages) when using R Under
> development (unstable) (2012-08-14 r60264) [Platform:
> x86_64-w64-mingw32/x64 (64-bit)].  Those errors did not show with R
> version 2.15.1 Patched (2012-08-16 r60282) [Platform:
> x86_64-w64-mingw32/x64 (64-bit)].
>
> /Henrik
>
> On Fri, Aug 24, 2012 at 1:38 PM, Spencer Graves
> <spencer.graves at prodsyse.com> wrote:
>> Hello, All:
>>
>>
>>         The CRAN checks for the "fda" package includes one error:
>>
>>
>> The error most likely occurred in ... file.copy2
>> ...
>>
>> Error: unprotect_ptr: pointer not found
>> Execution halted
>>
>>
>> (http://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian/fda-00check.html)
>>
>>
>>         The help page for "file.copy2" includes "\examples" with
>> everything wrapped in "\dontrun".
>>
>>
>>         I'm unable to replicate this error.  I'm about to submit a new
>> version of the fda package to CRAN, but I felt a need to ask about this
>> first.
>>
>>
>>         Thanks,
>>         Spencer
>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From 538280 at gmail.com  Sat Aug 25 05:57:18 2012
From: 538280 at gmail.com (Greg Snow)
Date: Fri, 24 Aug 2012 21:57:18 -0600
Subject: [Rd] Milestone: 4000 packages on CRAN
In-Reply-To: <A4E5A0B016B8CB41A485FC629B633CED46954312F2@GOLD.corp.lgc-group.com>
References: <CAFDcVCQTCfqtJP8dHS7vD+_FAz8v526wGgEWNo=3kMN2FvUQOA@mail.gmail.com>
	<20534.33988.849383.692946@max.nulle.part>
	<503687AD.3040107@stats.ox.ac.uk>
	<20534.35877.77471.880193@max.nulle.part>
	<5036903B.6010102@stats.ox.ac.uk>
	<A4E5A0B016B8CB41A485FC629B633CED46954312F2@GOLD.corp.lgc-group.com>
Message-ID: <CAFEqCdzjjsW+KfJsD4OqxH180FNGg9s7UuSsK5iBVs-2WWUOLA@mail.gmail.com>

On Fri, Aug 24, 2012 at 4:32 AM, S Ellison <S.Ellison at lgcgroup.com> wrote:
[snip]
> Anyone out there still think statistics are easy?

There are plenty of people out there that still think statistics are
easy, after all you can always stick a bunch of numbers into Excel and
get all kinds of statistics out, they are even easier if you don't
feel the need to understand them.  It is only when us darn
statisticians get involved and start asking the important questions
that things get complicated.


-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From pdalgd at gmail.com  Sat Aug 25 14:37:14 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Sat, 25 Aug 2012 14:37:14 +0200
Subject: [Rd] CRAN check error with no example?
In-Reply-To: <50383113.9090401@prodsyse.com>
References: <5037E65D.3020501@prodsyse.com>
	<CAFDcVCRaPpu5rFPndrEo=fJa4Jbpe2j01Qh3pNoV5pONnsgdCw@mail.gmail.com>
	<50383113.9090401@prodsyse.com>
Message-ID: <65EB801A-D698-4E7F-8CE5-2A87AF28E896@gmail.com>


On Aug 25, 2012, at 03:57 , Spencer Graves wrote:

> Hi, Henrik:
> 
> 
>      Thanks.  That suggests I should ignore this error message. That was my tentative plan, but I felt a need to mention it to this group before I did.

Hum, it might not be your problem, but that error message is potentially nasty. It means that something in your package or in R itself was believed to be protected from garbage collection but apparently was not. If there's a way of reproducing the error, it might be worth trying to track down the cause.

> 
> 
>      Best Wishes,
>      Spencer
> 
> 
> On 8/24/2012 3:35 PM, Henrik Bengtsson wrote:
>> For what it's worth, I got that exact same error the other day when
>> running R CMD check --as-cran on fda v2.2.8 and 'hyperSpec
>> v0.98-20120713 (out of 84 other packages) when using R Under
>> development (unstable) (2012-08-14 r60264) [Platform:
>> x86_64-w64-mingw32/x64 (64-bit)].  Those errors did not show with R
>> version 2.15.1 Patched (2012-08-16 r60282) [Platform:
>> x86_64-w64-mingw32/x64 (64-bit)].
>> 
>> /Henrik
>> 
>> On Fri, Aug 24, 2012 at 1:38 PM, Spencer Graves
>> <spencer.graves at prodsyse.com> wrote:
>>> Hello, All:
>>> 
>>> 
>>>        The CRAN checks for the "fda" package includes one error:
>>> 
>>> 
>>> The error most likely occurred in ... file.copy2
>>> ...
>>> 
>>> Error: unprotect_ptr: pointer not found
>>> Execution halted
>>> 
>>> 
>>> (http://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64-debian/fda-00check.html)
>>> 
>>> 
>>>        The help page for "file.copy2" includes "\examples" with
>>> everything wrapped in "\dontrun".
>>> 
>>> 
>>>        I'm unable to replicate this error.  I'm about to submit a new
>>> version of the fda package to CRAN, but I felt a need to ask about this
>>> first.
>>> 
>>> 
>>>        Thanks,
>>>        Spencer
>>> 
>>> 
>>>         [[alternative HTML version deleted]]
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From rkoenker at illinois.edu  Sat Aug 25 21:16:51 2012
From: rkoenker at illinois.edu (Roger Koenker)
Date: Sat, 25 Aug 2012 14:16:51 -0500
Subject: [Rd] cyclic namespace dependency detected
Message-ID: <9E76A7A6-EA16-4C4F-86DB-73700FF9236F@illinois.edu>

I'm having trouble installing my quantreg package on 

R version 2.15.1 (2012-06-22) -- "Roasted Marshmallows"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

Seems odd since the CRAN version  seems to be fine, but I'm
seeing  after compiling of the i386 and x86-64 versions and 
installing the .so files:

?.
installing to /Library/Frameworks/R.framework/Versions/2.15/Resources/library/quantreg/libs/x86_64
** R
** data
** demo
** inst
** preparing package for lazy loading
Error in loadNamespace(package, c(which.lib.loc, lib.loc)) : 
  cyclic namespace dependency detected when loading 'quantreg', already loading 'quantreg'
Error in .Fortran("srqfn", n = as.integer(n), m = as.integer(m), nnza = as.integer(nnza),  : 
  Fortran symbol name "srqfn" not in DLL for package "quantreg"
Error : unable to load R code in package 'quantreg'
ERROR: lazy loading failed for package 'quantreg'

Any suggestions would be much appreciated.

Roger

PS.  FWIW:  My NAMESPACE for the package looks like this:

useDynLib("quantreg")
import(SparseM)

# Export all names
exportPattern(".")


Roger Koenker
rkoenker at illinois.edu


From diy at stat.oregonstate.edu  Fri Aug 24 17:56:44 2012
From: diy at stat.oregonstate.edu (Yanming Di)
Date: Fri, 24 Aug 2012 08:56:44 -0700
Subject: [Rd] how to keep the documents of private functions private
Message-ID: <8CE91B9EC5614EEC8917892689AD94C0@science.oregonstate.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120824/e6458ed5/attachment.pl>

From lxh37 at psu.edu  Fri Aug 24 16:39:19 2012
From: lxh37 at psu.edu (LIYING HUANG)
Date: Fri, 24 Aug 2012 10:39:19 -0400 (EDT)
Subject: [Rd] include dll in R-package
In-Reply-To: <CAC2h7ut1dfy-Tzf+j4zs8gOe-AobGYnvapwwqXhZoDu6BLcAoA@mail.gmail.com>
Message-ID: <1061068273.1067395.1345819159812.JavaMail.root@psu.edu>


Thanks for the clarification. Just wonder if I don't host the 
package on CRAN, am I able to build a package without
source codes to distribute it from my institutions homepage?
Seems not for the newer version?

Thanks!
Liying


----- Original Message -----
From: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>
To: "Dirk Eddelbuettel" <edd at debian.org>
Cc: "LIYING HUANG" <lxh37 at psu.edu>, r-devel at r-project.org
Sent: Friday, August 24, 2012 10:21:18 AM
Subject: Re: [Rd] include dll in R-package

On Fri, Aug 24, 2012 at 10:16 AM, Dirk Eddelbuettel < edd at debian.org > wrote: 





On 24 August 2012 at 09:06, LIYING HUANG wrote: 
| We have several projects in the center done by researchers over years 
| in Fortran, there are copy right issues etc to prevent us from 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 

| giving away the source codes, but a lot of social scientist are 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 


| interested to use the program. We tried to use dlls to make plugins 
| (available in our website) in various statistics platforms 
| (SAS, STATA and R) to make it available to general public. 
| 
| We used to be able to build R package using dll on version R-2.7.0, 
| , but failed to build with newer R version with the same source. 
| Any help is greatly appreciated. 
| 
| When I try to build R package for newer version of R, I could build 
| to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz", 
| I got error message as: 
| 
| * using log directory 'D:/project/LCCA/lcca.Rcheck' 
| * using R version 2.15.1 (2012-06-22) 
| * using platform: i386-pc-mingw32 (32-bit) 
| * using session charset: ISO8859-1 
| * checking for file 'lcca/DESCRIPTION' ... OK 
| * checking extension type ... Package 
| * this is package 'lcca' version '1.0.0' 
| * checking package namespace information ... OK 
| * checking package dependencies ... OK 
| * checking if this is a source package ... OK 
| * checking if there is a namespace ... OK 
| * checking for executable files ... WARNING 
| Found the following executable file(s): 
| libs/lcca.dll 
| Source packages should not contain undeclared executable files. 
| See section 'Package structure' in the 'Writing R Extensions' manual. 
| * checking whether package 'lcca' can be installed ... ERROR 

This tells you that in order to have a proper package, you need to include 
the very source code you want to hide. 

This is a CRAN Policy decision enforced by current R versions (but not the 
rather old version you compared against), and there is now way around it. 
You could try to construct "defunct" packages lacking the DLLs and instruct 
the users to get them from somewhere else, but that is at the same rather 
error prone (as you will lack all the built-time checks you would have with 
source code, as well as a better assurrance that compatible tools are used) 
and distasteful as CRAN is about Open Source. 

So your best bet may be to go back to the copyright holders.... 



Dirk's comments are extremely relevant if you were hoping to host the package on CRAN (which you basically won't be allowed to). You can still distribute it from your institutions homepage I think. 


Kasper


From murdoch.duncan at gmail.com  Sat Aug 25 22:28:40 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 25 Aug 2012 16:28:40 -0400
Subject: [Rd] how to keep the documents of private functions private
In-Reply-To: <8CE91B9EC5614EEC8917892689AD94C0@science.oregonstate.edu>
References: <8CE91B9EC5614EEC8917892689AD94C0@science.oregonstate.edu>
Message-ID: <50393578.8090400@gmail.com>

On 12-08-24 11:56 AM, Yanming Di wrote:
> First time posting on this forum.
>
> The short version of the question is how to keep the documents of private (unexported) functions private. It seems that the documents of the private functions will be compiled into the user manual even if the corresponding functions are not exported. Is there a solution to this? I want to have documents for these functions for my own use, but I don???t want to release them to distract end users.

You can't easily do that.  Some base packages have a topic like 
?"grid-internal" where internal documentation is collected, but it is 
visible to users.

> To provide some background, a more general question is how to manage unexported (private) functions in an R package. I need to call them during the developing phase or even after the package is released (e.g., for debugging purpose or they may be needed by new functions), but I don???t want to export them (I???d like to keep the number of exported (public) functions to a minimum and present the users with only the functions that they need to know.)
>
> I know I can call private functions by packagename:::fcn(), but that seems a little bit tedious.

You could also attach the environment of an exported function (e.g. 
attach(environment(grid::unit)), to put the whole internal environment 
on the search list.  But I usually use the ::: notation.

Duncan Murdoch


>
> A solution I came up with is to prepare two NAMESPACE files and switch between them. When releasing the codes, use the thin version; when developing the package, use the version that export all functions. That works except if I have documents (Rd files) for the private functions, they will be compiled to the user manual even if the corresponding functions are not exported. Is there a solution around this? (I think I can keep two separate man folders and switch between them, but that seems a little bit tedious).
>
> Thanks.
>
> Yanming
>
>
>
> 	[[alternative HTML version deleted]]
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Sat Aug 25 22:47:16 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Sat, 25 Aug 2012 15:47:16 -0500
Subject: [Rd] how to keep the documents of private functions private
In-Reply-To: <8CE91B9EC5614EEC8917892689AD94C0@science.oregonstate.edu>
References: <8CE91B9EC5614EEC8917892689AD94C0@science.oregonstate.edu>
Message-ID: <CABdHhvHjTKMNaE+Rw4XAjMqWunZLLHvE1fEjonq2qjb-=g__Jw@mail.gmail.com>

> To provide some background, a more general question is how to manage unexported (private) functions in an R package. I need to call them during the developing phase or even after the package is released (e.g., for debugging purpose or they may be needed by new functions), but I don?t want to export them (I?d like to keep the number of exported (public) functions to a minimum and present the users with only the functions that they need to know.)

The devtools package allows you to do load_all("path/to/package"),
which simulates installing the package and then loading it (but is
much faster, at the cost of being a somewhat imperfect simulation).
Because working with unexported functions is so useful during
development, it makes all them all available.  (And the development
version allows you to choose whether or not you want them available)

I typically generate documentation with inline source comments (using
roxygen2). If I want them to be turned into Rd files and accessible to
the user I use the roxygen comments (#'). If I just want them to be
available to me (and other developers), I just use # - then they're
available in the source, but not in the man/ directory.

Hadley

-- 
Assistant Professor
Department of Statistics / Rice University
http://had.co.nz/


From hb at biostat.ucsf.edu  Sun Aug 26 01:15:51 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Sat, 25 Aug 2012 16:15:51 -0700
Subject: [Rd] include dll in R-package
In-Reply-To: <1061068273.1067395.1345819159812.JavaMail.root@psu.edu>
References: <CAC2h7ut1dfy-Tzf+j4zs8gOe-AobGYnvapwwqXhZoDu6BLcAoA@mail.gmail.com>
	<1061068273.1067395.1345819159812.JavaMail.root@psu.edu>
Message-ID: <CAFDcVCQz16VPvjMDVYyC74MRuXUbPRUA_3UONFOMfzC080pPUQ@mail.gmail.com>

On Fri, Aug 24, 2012 at 7:39 AM, LIYING HUANG <lxh37 at psu.edu> wrote:
>
> Thanks for the clarification. Just wonder if I don't host the
> package on CRAN, am I able to build a package without
> source codes to distribute it from my institutions homepage?
> Seems not for the newer version?

I think that is a valid point; R is not CRAN and CRAN is not R, but
for obvious reasons they sometimes tend to blend.

Either way, I wanna second what's already been said by others.  Try
your best to distribute as much as possible of your tools as open
source.  If there are pieces that are impossible to put under open
source, at least identify them and maybe put them in a separate
package, and make the rest open source.  On our end, doing science
with non open source/access tools is really a pain, and I know lots of
people avoiding such tools as far as possible, because you know that
one day or the other you'll pay the price of not being able to
check/validate what's really going on in your analysis.  So open
source is great...

...and to make the point, have a look at
https://svn.r-project.org/R/trunk/src/library/tools/R/check.R and
you'll see that you most likely will be able to disable those tests.
Alternatively, make sure to read 'Checking packages' in Writing R
Extensions.  It may be dense, but it is very informative and useful.
One section reads "Use R CMD check --help to obtain more information
about the usage of the R package checker. A subset of the checking
steps can be selected by adding command-line options. It also allows
customization by setting environment variables _R_CHECK_*_:, as
described in Tools: [...]."  So, check out that 'Tools' documentation,
and I think you'll find a solution.

My $.02 GFPL v1.3 comments

/Henrik

>
> Thanks!
> Liying
>
>
> ----- Original Message -----
> From: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>
> To: "Dirk Eddelbuettel" <edd at debian.org>
> Cc: "LIYING HUANG" <lxh37 at psu.edu>, r-devel at r-project.org
> Sent: Friday, August 24, 2012 10:21:18 AM
> Subject: Re: [Rd] include dll in R-package
>
> On Fri, Aug 24, 2012 at 10:16 AM, Dirk Eddelbuettel < edd at debian.org > wrote:
>
>
>
>
>
> On 24 August 2012 at 09:06, LIYING HUANG wrote:
> | We have several projects in the center done by researchers over years
> | in Fortran, there are copy right issues etc to prevent us from
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>
> | giving away the source codes, but a lot of social scientist are
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>
>
> | interested to use the program. We tried to use dlls to make plugins
> | (available in our website) in various statistics platforms
> | (SAS, STATA and R) to make it available to general public.
> |
> | We used to be able to build R package using dll on version R-2.7.0,
> | , but failed to build with newer R version with the same source.
> | Any help is greatly appreciated.
> |
> | When I try to build R package for newer version of R, I could build
> | to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz",
> | I got error message as:
> |
> | * using log directory 'D:/project/LCCA/lcca.Rcheck'
> | * using R version 2.15.1 (2012-06-22)
> | * using platform: i386-pc-mingw32 (32-bit)
> | * using session charset: ISO8859-1
> | * checking for file 'lcca/DESCRIPTION' ... OK
> | * checking extension type ... Package
> | * this is package 'lcca' version '1.0.0'
> | * checking package namespace information ... OK
> | * checking package dependencies ... OK
> | * checking if this is a source package ... OK
> | * checking if there is a namespace ... OK
> | * checking for executable files ... WARNING
> | Found the following executable file(s):
> | libs/lcca.dll
> | Source packages should not contain undeclared executable files.
> | See section 'Package structure' in the 'Writing R Extensions' manual.
> | * checking whether package 'lcca' can be installed ... ERROR
>
> This tells you that in order to have a proper package, you need to include
> the very source code you want to hide.
>
> This is a CRAN Policy decision enforced by current R versions (but not the
> rather old version you compared against), and there is now way around it.
> You could try to construct "defunct" packages lacking the DLLs and instruct
> the users to get them from somewhere else, but that is at the same rather
> error prone (as you will lack all the built-time checks you would have with
> source code, as well as a better assurrance that compatible tools are used)
> and distasteful as CRAN is about Open Source.
>
> So your best bet may be to go back to the copyright holders....
>
>
>
> Dirk's comments are extremely relevant if you were hoping to host the package on CRAN (which you basically won't be allowed to). You can still distribute it from your institutions homepage I think.
>
>
> Kasper
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From dadler at uni-goettingen.de  Sun Aug 26 13:00:05 2012
From: dadler at uni-goettingen.de (Daniel Adler)
Date: Sun, 26 Aug 2012 13:00:05 +0200
Subject: [Rd] rdyncall fears removal from CRAN
In-Reply-To: <CABdHhvEbFzKTybO=tr8gSFfBxm1KuHrcya1OMGqi6RT9Jo3UXA@mail.gmail.com>
References: <20120814090906.31F128144A@gannet.stats.ox.ac.uk>
	<F0DD11BC-94E6-486A-9E25-9379D2B6BBE4@uni-goettingen.de>
	<CAFOpNVHbgq+aKS2WGF_Pf_BXSR1H11ucaMAFVJ4+EBtR8VNePw@mail.gmail.com>
	<CABdHhvEbFzKTybO=tr8gSFfBxm1KuHrcya1OMGqi6RT9Jo3UXA@mail.gmail.com>
Message-ID: <0A8759BD-2F32-4B43-BC72-F094FD419AC1@uni-goettingen.de>

Dear R Developers,

Here is a small patch against the trunk that makes 'makeNamespace' a first-level function (not defined inside another closure)
and defines two wrapper functions to 'registerNamespace' and 'unregisterNamespace'.

http://dyncall.org/~dadler/R-trunk-public-namespace.diff

The patch does not include a manual page for now, since I would like to get a feedback on this change first --
let me know if this makes sense to you or not.

At least, from what I can say? the rdyncall package would work without using '.Internal' then -- and I do not have to apply 
'do.call' hacks to prevent the package from removal on CRAN.

Regards,
- Daniel

On Aug 20, 2012, at 5:09 PM, Hadley Wickham wrote:

>> This is also very relevant for devtools. There have been some recent
>> changes to the in-development version of devtools, so that it loads
>> development packages into a namespace. Previously, it didn't use
>> namespaces, but now that it does, it much more closely approximates
>> normal package loading behavior.
>> 
>> It now uses the internal functions registerNamespace and
>> unregisterNamespace. Is there a workaround to do these things without
>> using the internal functions?
> 
> We're very aware that using these internal functions ties us to a
> specific version of R, and that they may change at any point in the
> future and break our code. That's an acceptable trade-off - using
> these internal functions gives us capabilities that makes fixing the
> code in the future worthwhile.
> 
> A minimal change to R that would satisfy our needs (and I suspect
> Daniel's) would be to move makeNamespace into the base package (i.e.
> up out of the function it is currently contained in), and to create R
> wrapper functions for registerNamespace and unregisterNamespace.  They
> wouldn't even need to be exported - we know what we're doing is
> dangerous.
> 
> If that solution isn't acceptable, we'd also be very happy to work
> with any R-core member to help develop a public facing API for
> namespace manipulation, including providing tests for common use
> cases.
> 
> Please let us know what we can do to help!
> 
> Hadley
> 
> -- 
> Assistant Professor
> Department of Statistics / Rice University
> http://had.co.nz/


From rkoenker at uiuc.edu  Sun Aug 26 17:40:55 2012
From: rkoenker at uiuc.edu (RKoenker)
Date: Sun, 26 Aug 2012 08:40:55 -0700 (PDT)
Subject: [Rd] cyclic namespace dependency detected
In-Reply-To: <9E76A7A6-EA16-4C4F-86DB-73700FF9236F@illinois.edu>
References: <9E76A7A6-EA16-4C4F-86DB-73700FF9236F@illinois.edu>
Message-ID: <1345995655647-4641346.post@n4.nabble.com>

My apologies,  my cyclic namespace problem was due to a unintended test file
that 
invoked require(quantreg) and that I had forgotten to remove from the R
directory.
(And a corresponding failure to explore the obvious before assuming a global
conspiracy.)



--
View this message in context: http://r.789695.n4.nabble.com/cyclic-namespace-dependency-detected-tp4641312p4641346.html
Sent from the R devel mailing list archive at Nabble.com.


From lgautier at gmail.com  Sun Aug 26 18:25:15 2012
From: lgautier at gmail.com (Laurent Gautier)
Date: Sun, 26 Aug 2012 18:25:15 +0200
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
Message-ID: <503A4DEB.2090605@gmail.com>

Hi,

I just stumbled on the following apparent oddity: the package "datasets" 
does not appear to export anything out of its namespace:

 > ns_datasets <- getNamespace('datasets')
 > getNamespaceExports(ns_datasets)
character(0)

Not the case with other packages (example here with "utils"):
 > ns_utils <- getNamespace('utils')
 > head(getNamespaceExports(ns_utils))
[1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
[6] "aregexec"

Is this a temporary glitch, or is there something new and specific to 
"datasets" ?

Best,

Laurent

PS: Obligatory sessionInfo:

 > sessionInfo()
R version 2.15.1 Patched (2012-08-24 r60412)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_DK.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_DK.UTF-8        LC_COLLATE=en_DK.UTF-8
  [5] LC_MONETARY=en_DK.UTF-8    LC_MESSAGES=en_DK.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_DK.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods base

loaded via a namespace (and not attached):
[1] tcltk_2.15.1 tools_2.15.1


From edd at debian.org  Sun Aug 26 18:32:33 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 26 Aug 2012 11:32:33 -0500
Subject: [Rd] Package "datasets" not exporting anything on a
	recent	R-2.15.1-patched
In-Reply-To: <503A4DEB.2090605@gmail.com>
References: <503A4DEB.2090605@gmail.com>
Message-ID: <20538.20385.717692.171873@max.nulle.part>


On 26 August 2012 at 18:25, Laurent Gautier wrote:
| Hi,
| 
| I just stumbled on the following apparent oddity: the package "datasets" 
| does not appear to export anything out of its namespace:
| 
|  > ns_datasets <- getNamespace('datasets')
|  > getNamespaceExports(ns_datasets)
| character(0)
| 
| Not the case with other packages (example here with "utils"):
|  > ns_utils <- getNamespace('utils')
|  > head(getNamespaceExports(ns_utils))
| [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
| [6] "aregexec"
| 
| Is this a temporary glitch, or is there something new and specific to 
| "datasets" ?

Seems to be on purpose -- here is its NAMESPACE file

   # This package exports nothing (it uses lazydata)
   # exportPattern(".")

ie nuttin' gets exported. It also has no R/ directory.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From ripley at stats.ox.ac.uk  Sun Aug 26 19:03:29 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 26 Aug 2012 18:03:29 +0100
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <503A4DEB.2090605@gmail.com>
References: <503A4DEB.2090605@gmail.com>
Message-ID: <503A56E1.2080900@stats.ox.ac.uk>

On 26/08/2012 17:25, Laurent Gautier wrote:
> Hi,
>
> I just stumbled on the following apparent oddity: the package "datasets"
> does not appear to export anything out of its namespace:
>
>  > ns_datasets <- getNamespace('datasets')
>  > getNamespaceExports(ns_datasets)
> character(0)
>
> Not the case with other packages (example here with "utils"):
>  > ns_utils <- getNamespace('utils')
>  > head(getNamespaceExports(ns_utils))
> [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
> [6] "aregexec"
>
> Is this a temporary glitch, or is there something new and specific to
> "datasets" ?

Not new, been so since R 2.14.0.

The package contains no R code: the only reason it has a namespace is 
that since 2.14.0 all packages must have one.

There are other data-only packages, but not in base R.

Lazy-loaded data has not been part of the namespace for a long time: 
they are directly in the package's environment.  The reason is the 
namespace scoping rules: if the package's datasets were in its 
namespace, they would be found before any other dataset of that name by 
the package's R functions.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From lgautier at gmail.com  Sun Aug 26 19:07:42 2012
From: lgautier at gmail.com (Laurent Gautier)
Date: Sun, 26 Aug 2012 19:07:42 +0200
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <20538.20385.717692.171873@max.nulle.part>
References: <503A4DEB.2090605@gmail.com>
	<20538.20385.717692.171873@max.nulle.part>
Message-ID: <503A57DE.6050204@gmail.com>

On 2012-08-26 18:32, Dirk Eddelbuettel wrote:
> On 26 August 2012 at 18:25, Laurent Gautier wrote:
> | Hi,
> |
> | I just stumbled on the following apparent oddity: the package "datasets"
> | does not appear to export anything out of its namespace:
> |
> |  > ns_datasets <- getNamespace('datasets')
> |  > getNamespaceExports(ns_datasets)
> | character(0)
> |
> | Not the case with other packages (example here with "utils"):
> |  > ns_utils <- getNamespace('utils')
> |  > head(getNamespaceExports(ns_utils))
> | [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
> | [6] "aregexec"
> |
> | Is this a temporary glitch, or is there something new and specific to
> | "datasets" ?
>
> Seems to be on purpose -- here is its NAMESPACE file
>
>     # This package exports nothing (it uses lazydata)
>     # exportPattern(".")
>
> ie nuttin' gets exported. It also has no R/ directory.


It is a pity that things are not a little more unified and objects in 
packages can be either in R/ (be in a namespace, exported or not, always 
loaded) or in data/ (always exported, optional lazy loading).





>
> Dirk
>


From lgautier at gmail.com  Sun Aug 26 19:20:43 2012
From: lgautier at gmail.com (Laurent Gautier)
Date: Sun, 26 Aug 2012 19:20:43 +0200
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <503A56E1.2080900@stats.ox.ac.uk>
References: <503A4DEB.2090605@gmail.com> <503A56E1.2080900@stats.ox.ac.uk>
Message-ID: <503A5AEB.3050502@gmail.com>

On 2012-08-26 19:03, Prof Brian Ripley wrote:
> On 26/08/2012 17:25, Laurent Gautier wrote:
>> Hi,
>>
>> I just stumbled on the following apparent oddity: the package "datasets"
>> does not appear to export anything out of its namespace:
>>
>>  > ns_datasets <- getNamespace('datasets')
>>  > getNamespaceExports(ns_datasets)
>> character(0)
>>
>> Not the case with other packages (example here with "utils"):
>>  > ns_utils <- getNamespace('utils')
>>  > head(getNamespaceExports(ns_utils))
>> [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
>> [6] "aregexec"
>>
>> Is this a temporary glitch, or is there something new and specific to
>> "datasets" ?
>
> Not new, been so since R 2.14.0.
>
> The package contains no R code: the only reason it has a namespace is 
> that since 2.14.0 all packages must have one.
>
> There are other data-only packages, but not in base R.
>
> Lazy-loaded data has not been part of the namespace for a long time: 
> they are directly in the package's environment.  The reason is the 
> namespace scoping rules: if the package's datasets were in its 
> namespace, they would be found before any other dataset of that name 
> by the package's R functions.
>
Thanks for the quick answer and explanations. The last paragraph above 
is leaving me with the wish to understand more before I comment on it. 
Would you have an example of finding a dataset in a package's namespace 
(before a dataset with the same name in an other package further down in 
the search path) being a problem ?


Best,

Laurent


From ripley at stats.ox.ac.uk  Sun Aug 26 19:27:24 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 26 Aug 2012 18:27:24 +0100
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <503A5AEB.3050502@gmail.com>
References: <503A4DEB.2090605@gmail.com> <503A56E1.2080900@stats.ox.ac.uk>
	<503A5AEB.3050502@gmail.com>
Message-ID: <503A5C7C.3030806@stats.ox.ac.uk>

On 26/08/2012 18:20, Laurent Gautier wrote:
> On 2012-08-26 19:03, Prof Brian Ripley wrote:
>> On 26/08/2012 17:25, Laurent Gautier wrote:
>>> Hi,
>>>
>>> I just stumbled on the following apparent oddity: the package "datasets"
>>> does not appear to export anything out of its namespace:
>>>
>>>  > ns_datasets <- getNamespace('datasets')
>>>  > getNamespaceExports(ns_datasets)
>>> character(0)
>>>
>>> Not the case with other packages (example here with "utils"):
>>>  > ns_utils <- getNamespace('utils')
>>>  > head(getNamespaceExports(ns_utils))
>>> [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
>>> [6] "aregexec"
>>>
>>> Is this a temporary glitch, or is there something new and specific to
>>> "datasets" ?
>>
>> Not new, been so since R 2.14.0.
>>
>> The package contains no R code: the only reason it has a namespace is
>> that since 2.14.0 all packages must have one.
>>
>> There are other data-only packages, but not in base R.
>>
>> Lazy-loaded data has not been part of the namespace for a long time:
>> they are directly in the package's environment.  The reason is the
>> namespace scoping rules: if the package's datasets were in its
>> namespace, they would be found before any other dataset of that name
>> by the package's R functions.
>>
> Thanks for the quick answer and explanations. The last paragraph above
> is leaving me with the wish to understand more before I comment on it.
> Would you have an example of finding a dataset in a package's namespace
> (before a dataset with the same name in an other package further down in
> the search path) being a problem ?

It does not happen now, but for example MASS contains both datasets and 
analysis functions and when the datasets were in the namespace you got 
them before other datasets (e.g. modified versions) of the same name.

>
>
> Best,
>
> Laurent


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From lgautier at gmail.com  Sun Aug 26 20:01:57 2012
From: lgautier at gmail.com (Laurent Gautier)
Date: Sun, 26 Aug 2012 20:01:57 +0200
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <503A5C7C.3030806@stats.ox.ac.uk>
References: <503A4DEB.2090605@gmail.com> <503A56E1.2080900@stats.ox.ac.uk>
	<503A5AEB.3050502@gmail.com> <503A5C7C.3030806@stats.ox.ac.uk>
Message-ID: <503A6495.70309@gmail.com>

On 2012-08-26 19:27, Prof Brian Ripley wrote:
> On 26/08/2012 18:20, Laurent Gautier wrote:
>> On 2012-08-26 19:03, Prof Brian Ripley wrote:
>>> On 26/08/2012 17:25, Laurent Gautier wrote:
>>>> Hi,
>>>>
>>>> I just stumbled on the following apparent oddity: the package 
>>>> "datasets"
>>>> does not appear to export anything out of its namespace:
>>>>
>>>>  > ns_datasets <- getNamespace('datasets')
>>>>  > getNamespaceExports(ns_datasets)
>>>> character(0)
>>>>
>>>> Not the case with other packages (example here with "utils"):
>>>>  > ns_utils <- getNamespace('utils')
>>>>  > head(getNamespaceExports(ns_utils))
>>>> [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
>>>> [6] "aregexec"
>>>>
>>>> Is this a temporary glitch, or is there something new and specific to
>>>> "datasets" ?
>>>
>>> Not new, been so since R 2.14.0.
>>>
>>> The package contains no R code: the only reason it has a namespace is
>>> that since 2.14.0 all packages must have one.
>>>
>>> There are other data-only packages, but not in base R.
>>>
>>> Lazy-loaded data has not been part of the namespace for a long time:
>>> they are directly in the package's environment.  The reason is the
>>> namespace scoping rules: if the package's datasets were in its
>>> namespace, they would be found before any other dataset of that name
>>> by the package's R functions.
>>>
>> Thanks for the quick answer and explanations. The last paragraph above
>> is leaving me with the wish to understand more before I comment on it.
>> Would you have an example of finding a dataset in a package's namespace
>> (before a dataset with the same name in an other package further down in
>> the search path) being a problem ?
>
> It does not happen now, but for example MASS contains both datasets 
> and analysis functions and when the datasets were in the namespace you 
> got them before other datasets (e.g. modified versions) of the same name.

I am seeing two ways for datasets to be used:
A- as internal data for necessary to a function in a package (e.g, 
conversion tables). Not very frequent, from my limited experience.
B- as example data, used in the documentation. The most frequent usage.

For A/, the user is not expected to modify the data.
For B/, the data are typically passed to functions (to use an example 
from MASS, "huber(chem)").
I thought a bit about it, but still do no see where exactly this would 
be a problem.

An other example available in R is the vector "letters" (in base). It 
can be thought of as a dataset, yet it is
- in a namespace

 > "letters" %in% getNamespaceExports(getNamespace("base"))
[1] TRUE

- probably used in the two situations A/ and B/ above.






>
>>
>>
>> Best,
>>
>> Laurent
>
>


From ripley at stats.ox.ac.uk  Mon Aug 27 09:46:00 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 27 Aug 2012 08:46:00 +0100
Subject: [Rd] Hidden files in source packages
Message-ID: <503B25B8.3030202@stats.ox.ac.uk>

R-devel has been warning for some time about hidden files (in the Unix 
sense, starting with a period) in source packages.   We could get R CMD 
build and the CRAN incoming scripts to remove these *if* we knew that 
they were never needed.

It seems clear that

.Rapp.history
.Rhistory
.Rbuildindex.xxxxx
inst/doc/.build.timestamp

are R leftovers,

._.DS_store

is from an Apple filesystem and

.tex .log .aux .pdf .png

are junk (as file names, not extensions).

However, is there ever any reason for any of

.Renviron
.Rprofile
.Rproj.user
.backups
.cvsignore
.cproject
.directory
.dropbox
.exrc
.gdb.history
.gitattributes
.gitignore
.gitmodules
.hgignore
.hqtags
.htaccess
.latex2html-init
.project
.seed
.settings

to be in a source package tarball?  (For some of these it is not clear 
where they come from since there are multiple possible origins.)

If you know of a reason to retain any of these, please let 
CRAN at r-project.org know (with 'Hidden files' in the subject line).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bhh at xs4all.nl  Mon Aug 27 10:10:11 2012
From: bhh at xs4all.nl (Berend Hasselman)
Date: Mon, 27 Aug 2012 10:10:11 +0200
Subject: [Rd] Hidden files in source packages
In-Reply-To: <503B25B8.3030202@stats.ox.ac.uk>
References: <503B25B8.3030202@stats.ox.ac.uk>
Message-ID: <2AAE6B3C-4BF8-42E3-A83C-88D8FF06951F@xs4all.nl>


On 27-08-2012, at 09:46, Prof Brian Ripley wrote:

> R-devel has been warning for some time about hidden files (in the Unix sense, starting with a period) in source packages.   We could get R CMD build and the CRAN incoming scripts to remove these *if* we knew that they were never needed.
> 
> It seems clear that
> 
> .Rapp.history
> .Rhistory
> .Rbuildindex.xxxxx
> inst/doc/.build.timestamp
> 
> are R leftovers,
> 
> ._.DS_store
> 
> is from an Apple filesystem and
> 
> .tex .log .aux .pdf .png
> 
> are junk (as file names, not extensions).
> 
> However, is there ever any reason for any of
> 
> .Renviron
> .Rprofile
> .Rproj.user
> .backups
> .cvsignore
> .cproject
> .directory
> .dropbox
> .exrc
> .gdb.history
> .gitattributes
> .gitignore
> .gitmodules
> .hgignore
> .hqtags

Isn't that .hgtags?

> .htaccess
> .latex2html-init
> .project
> .seed
> .settings
> 
> to be in a source package tarball?  (For some of these it is not clear where they come from since there are multiple possible origins.)

You can add

.tm_properties

to this list (settings file of TextMate 2 on Mac OS X)

Berend


From ligges at statistik.tu-dortmund.de  Mon Aug 27 11:32:24 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 27 Aug 2012 11:32:24 +0200
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <503A6495.70309@gmail.com>
References: <503A4DEB.2090605@gmail.com> <503A56E1.2080900@stats.ox.ac.uk>
	<503A5AEB.3050502@gmail.com> <503A5C7C.3030806@stats.ox.ac.uk>
	<503A6495.70309@gmail.com>
Message-ID: <503B3EA8.7080104@statistik.tu-dortmund.de>



On 26.08.2012 20:01, Laurent Gautier wrote:
> On 2012-08-26 19:27, Prof Brian Ripley wrote:
>> On 26/08/2012 18:20, Laurent Gautier wrote:
>>> On 2012-08-26 19:03, Prof Brian Ripley wrote:
>>>> On 26/08/2012 17:25, Laurent Gautier wrote:
>>>>> Hi,
>>>>>
>>>>> I just stumbled on the following apparent oddity: the package
>>>>> "datasets"
>>>>> does not appear to export anything out of its namespace:
>>>>>
>>>>>  > ns_datasets <- getNamespace('datasets')
>>>>>  > getNamespaceExports(ns_datasets)
>>>>> character(0)
>>>>>
>>>>> Not the case with other packages (example here with "utils"):
>>>>>  > ns_utils <- getNamespace('utils')
>>>>>  > head(getNamespaceExports(ns_utils))
>>>>> [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
>>>>> [6] "aregexec"
>>>>>
>>>>> Is this a temporary glitch, or is there something new and specific to
>>>>> "datasets" ?
>>>>
>>>> Not new, been so since R 2.14.0.
>>>>
>>>> The package contains no R code: the only reason it has a namespace is
>>>> that since 2.14.0 all packages must have one.
>>>>
>>>> There are other data-only packages, but not in base R.
>>>>
>>>> Lazy-loaded data has not been part of the namespace for a long time:
>>>> they are directly in the package's environment.  The reason is the
>>>> namespace scoping rules: if the package's datasets were in its
>>>> namespace, they would be found before any other dataset of that name
>>>> by the package's R functions.
>>>>
>>> Thanks for the quick answer and explanations. The last paragraph above
>>> is leaving me with the wish to understand more before I comment on it.
>>> Would you have an example of finding a dataset in a package's namespace
>>> (before a dataset with the same name in an other package further down in
>>> the search path) being a problem ?
>>
>> It does not happen now, but for example MASS contains both datasets
>> and analysis functions and when the datasets were in the namespace you
>> got them before other datasets (e.g. modified versions) of the same name.
>
> I am seeing two ways for datasets to be used:
> A- as internal data for necessary to a function in a package (e.g,
> conversion tables). Not very frequent, from my limited experience.
> B- as example data, used in the documentation. The most frequent usage.
>
> For A/, the user is not expected to modify the data.

In that case, you can provide the data as an object defined within the 
/R directory, for example.


> For B/, the data are typically passed to functions (to use an example
> from MASS, "huber(chem)").

In that case, you do not want to have it in your NAMESPACE, since you 
just pass those data in a function call.

Uwe Ligges



> I thought a bit about it, but still do no see where exactly this would
> be a problem.
>
> An other example available in R is the vector "letters" (in base). It
> can be thought of as a dataset, yet it is
> - in a namespace
>
>  > "letters" %in% getNamespaceExports(getNamespace("base"))
> [1] TRUE
>
> - probably used in the two situations A/ and B/ above.
>
>
>
>
>
>
>>
>>>
>>>
>>> Best,
>>>
>>> Laurent
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From lxh37 at psu.edu  Sun Aug 26 14:50:13 2012
From: lxh37 at psu.edu (LIYING HUANG)
Date: Sun, 26 Aug 2012 08:50:13 -0400 (EDT)
Subject: [Rd] include dll in R-package
In-Reply-To: <CABDUZc8DiJssR-B+7pHvb9AMrZMjr_zG+Bi1244jXRFrS_t2wA@mail.gmail.com>
Message-ID: <543907278.1925447.1345985413153.JavaMail.root@psu.edu>


Jeff,

Thanks for the reply.

For "explicit dependency", can dll and functions be specified 
in namespace and imported by the package automatically? or
the user has to use dyn.load and is.loaded to load the dll
and functions in R? If it is the former, could you point
me to an example that I could learn? Thanks!

Liying

----- ???? -----
???: "Jeff Ryan" <jeff.a.ryan at gmail.com>
???: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>
??: r-devel at r-project.org, "Dirk Eddelbuettel" <edd at debian.org>
????: ???, 2012? 8 ? 24? ?? 10:28:50
??: Re: [Rd] include dll in R-package

Any package can link to external DLLs.  You'll need to make that an
explicit dependency, have some configure script and distribute the
library somewhere else, but many packages on CRAN already do this.

My RBerkeley uses a user installed Oracle Berkeley DB that is linked
to at configure time, of course there are many other examples as well.

And distributing _off_ CRAN is of course a reasonable alternative.

HTH
Jeff

On Fri, Aug 24, 2012 at 9:21 AM, Kasper Daniel Hansen
<kasperdanielhansen at gmail.com> wrote:
> On Fri, Aug 24, 2012 at 10:16 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> On 24 August 2012 at 09:06, LIYING HUANG wrote:
>> | We have several projects in the center done by researchers over years
>> | in Fortran, there are copy right issues etc to prevent us from
>>                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> | giving away the source codes, but a lot of social scientist are
>>   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> | interested to use the program. We tried to use dlls to make plugins
>> | (available in our website) in various statistics platforms
>> | (SAS, STATA and R) to make it available to general public.
>> |
>> | We used to be able to build R package using dll on version R-2.7.0,
>> | , but failed to build with newer R version with the same source.
>> | Any help is greatly appreciated.
>> |
>> | When I try to build R package for newer version of R, I could build
>> | to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz",
>> | I got error message as:
>> |
>> | * using log directory 'D:/project/LCCA/lcca.Rcheck'
>> | * using R version 2.15.1 (2012-06-22)
>> | * using platform: i386-pc-mingw32 (32-bit)
>> | * using session charset: ISO8859-1
>> | * checking for file 'lcca/DESCRIPTION' ... OK
>> | * checking extension type ... Package
>> | * this is package 'lcca' version '1.0.0'
>> | * checking package namespace information ... OK
>> | * checking package dependencies ... OK
>> | * checking if this is a source package ... OK
>> | * checking if there is a namespace ... OK
>> | * checking for executable files ... WARNING
>> | Found the following executable file(s):
>> |   libs/lcca.dll
>> | Source packages should not contain undeclared executable files.
>> | See section 'Package structure' in the 'Writing R Extensions' manual.
>> | * checking whether package 'lcca' can be installed ... ERROR
>>
>> This tells you that in order to have a proper package, you need to include
>> the very source code you want to hide.
>>
>> This is a CRAN Policy decision enforced by current R versions (but not the
>> rather old version you compared against), and there is now way around it.
>> You could try to construct "defunct" packages lacking the DLLs and instruct
>> the users to get them from somewhere else, but that is at the same rather
>> error prone (as you will lack all the built-time checks you would have with
>> source code, as well as a better assurrance that compatible tools are used)
>> and distasteful as CRAN is about Open Source.
>>
>> So your best bet may be to go back to the copyright holders....
>>
>
> Dirk's comments are extremely relevant if you were hoping to host the
> package on CRAN (which you basically won't be allowed to).  You can still
> distribute it from your institutions homepage I think.
>
> Kasper
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From lgautier at gmail.com  Mon Aug 27 14:45:02 2012
From: lgautier at gmail.com (Laurent Gautier)
Date: Mon, 27 Aug 2012 14:45:02 +0200
Subject: [Rd] Package "datasets" not exporting anything on a recent
	R-2.15.1-patched
In-Reply-To: <503B3EA8.7080104@statistik.tu-dortmund.de>
References: <503A4DEB.2090605@gmail.com> <503A56E1.2080900@stats.ox.ac.uk>
	<503A5AEB.3050502@gmail.com> <503A5C7C.3030806@stats.ox.ac.uk>
	<503A6495.70309@gmail.com>
	<503B3EA8.7080104@statistik.tu-dortmund.de>
Message-ID: <503B6BCE.20207@gmail.com>

On 2012-08-27 11:32, Uwe Ligges wrote:
>
>
> On 26.08.2012 20:01, Laurent Gautier wrote:
>> On 2012-08-26 19:27, Prof Brian Ripley wrote:
>>> On 26/08/2012 18:20, Laurent Gautier wrote:
>>>> On 2012-08-26 19:03, Prof Brian Ripley wrote:
>>>>> On 26/08/2012 17:25, Laurent Gautier wrote:
>>>>>> Hi,
>>>>>>
>>>>>> I just stumbled on the following apparent oddity: the package
>>>>>> "datasets"
>>>>>> does not appear to export anything out of its namespace:
>>>>>>
>>>>>>  > ns_datasets <- getNamespace('datasets')
>>>>>>  > getNamespaceExports(ns_datasets)
>>>>>> character(0)
>>>>>>
>>>>>> Not the case with other packages (example here with "utils"):
>>>>>>  > ns_utils <- getNamespace('utils')
>>>>>>  > head(getNamespaceExports(ns_utils))
>>>>>> [1] "?"            ".DollarNames" "adist"        "alarm" "apropos"
>>>>>> [6] "aregexec"
>>>>>>
>>>>>> Is this a temporary glitch, or is there something new and 
>>>>>> specific to
>>>>>> "datasets" ?
>>>>>
>>>>> Not new, been so since R 2.14.0.
>>>>>
>>>>> The package contains no R code: the only reason it has a namespace is
>>>>> that since 2.14.0 all packages must have one.
>>>>>
>>>>> There are other data-only packages, but not in base R.
>>>>>
>>>>> Lazy-loaded data has not been part of the namespace for a long time:
>>>>> they are directly in the package's environment.  The reason is the
>>>>> namespace scoping rules: if the package's datasets were in its
>>>>> namespace, they would be found before any other dataset of that name
>>>>> by the package's R functions.
>>>>>
>>>> Thanks for the quick answer and explanations. The last paragraph above
>>>> is leaving me with the wish to understand more before I comment on it.
>>>> Would you have an example of finding a dataset in a package's 
>>>> namespace
>>>> (before a dataset with the same name in an other package further 
>>>> down in
>>>> the search path) being a problem ?
>>>
>>> It does not happen now, but for example MASS contains both datasets
>>> and analysis functions and when the datasets were in the namespace you
>>> got them before other datasets (e.g. modified versions) of the same 
>>> name.
>>
>> I am seeing two ways for datasets to be used:
>> A- as internal data for necessary to a function in a package (e.g,
>> conversion tables). Not very frequent, from my limited experience.
>> B- as example data, used in the documentation. The most frequent usage.
>>
>> For A/, the user is not expected to modify the data.
>
> In that case, you can provide the data as an object defined within the 
> /R directory, for example.

Exactly. This is making us agree that datasets are indeed just objects 
in a package.

>
>
>> For B/, the data are typically passed to functions (to use an example
>> from MASS, "huber(chem)").
>
> In that case, you do not want to have it in your NAMESPACE, since you 
> just pass those data in a function call.


Yet having it in a namespace would not cause any harm, wouldn't it ?

Having it in a namespace would also have the added benefits:
- loading up a dataset will not overwrite silently any existing dataset 
currently in .GlobalEnv
- should an identical name for a dataset be found in several packages, 
one could refer to it with the "::" operator. I am aware of the argument 
"package" to the function "data()", but regret the apparent lack of 
general rule.
- should one wish to list the objects defined (and eventually exported) 
by a package the use of one function would be sufficient.

May be I am missing a fundamental point, but if my memory is correct the 
package "datasets" used to list its data objects when 
getNamespaceExports() was called.

>
> Uwe Ligges
>
>
>
>> I thought a bit about it, but still do no see where exactly this would
>> be a problem.
>>
>> An other example available in R is the vector "letters" (in base). It
>> can be thought of as a dataset, yet it is
>> - in a namespace
>>
>>  > "letters" %in% getNamespaceExports(getNamespace("base"))
>> [1] TRUE
>>
>> - probably used in the two situations A/ and B/ above.
>>
>>
>>
>>
>>
>>
>>>
>>>>
>>>>
>>>> Best,
>>>>
>>>> Laurent
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From kasperdanielhansen at gmail.com  Mon Aug 27 15:58:57 2012
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Mon, 27 Aug 2012 09:58:57 -0400
Subject: [Rd] non portable filenames
Message-ID: <CAC2h7uvNR1KPk_-0WzwDd2fAfPJu-rFcam9z=PbZoDseAoSvrg@mail.gmail.com>

I am including an external piece of software in an R package.  This
software ships with its own configure script generated by
autoconf/automake, and this script is being run as part of the package
configure script.

The package contains a file
  m4/lt~obsolete.m4
which - as far as I can see - is a standard file from the
autoconf/automake/m4 suite of programs.  A warning is generated with R
CMD check about this filename being non-portable.  Presumably because
of the "~" in the file name.  The users is referred to the 'Package
structure' part of R-exts.

Reading the manual, I do not see "~" listed in the beginning of the
paragraph where non-allowed characters are described.  Quoting:

"To ensure that file names are valid across file systems and supported
operating system platforms, the ASCII control characters as well as
the characters ?"?, ?*?, ?:?, ?/?, ?<?, ?>?, ???, ?\?, and ?|? are not
allowed in file names. In addition, files with names ?con?, ?prn?,
?aux?, ?clock$?, ?nul?, ?com1? to ?com9?, and ?lpt1? to ?lpt9? after
conversion to lower case and stripping possible ?extensions? (e.g.,
?lpt5.foo.bar?), are disallowed. Also, file names in the same
directory must not differ only by case (see the previous paragraph).
In addition, the basenames of ?.Rd? files may be used in URLs and so
must be ASCII and not contain %."

However, "~" is also not part of the next sentence where allowed
characters are listed.  Quoting

"For maximal portability filenames should only contain only ASCII
characters not excluded already (that is A-Za-z0-9._!#$%&+,;=@^(){}'[]
? we exclude space as many utilities do not accept spaces in file
paths): non-English alphabetic characters cannot be guaranteed to be
supported in all locales. It would be good practice to avoid the shell
metacharacters (){}'[]$."

To me it looks a bit like this paragraph is not self-consistent, since
"~" is not listed as one of the characters already excluded.

Now, I don't really know if "~" is portable.  But I assume that the
autoconf/automake/m4 people has thought a bit about this.  And I don't
really want to rename the file in question, as it is part of a lengthy
configure script.  So I guess my question is, is R CMD check correct
in flagging the file?  And what is recommended?  I am tempted to
ignore this warning, but I know warnings sometimes become errors.

I assume other people might be in the same situation, since the
filename originates from autoconf/automake/m4.

Kasper


From jackman at stanford.edu  Mon Aug 27 21:43:37 2012
From: jackman at stanford.edu (Simon Jackman)
Date: Mon, 27 Aug 2012 12:43:37 -0700
Subject: [Rd] very minor typo in doc for embedFonts
Message-ID: <8BDA4B6C-527F-4836-9E30-42E11D8DE67D@stanford.edu>

in the "Details" section:

"It this is unset?"

should read 

"If this is unset"

> version
               _                                           
platform       x86_64-apple-darwin9.8.0                    
arch           x86_64                                      
os             darwin9.8.0                                 
system         x86_64, darwin9.8.0                         
status         Patched                                     
major          2                                           
minor          15.1                                        
year           2012                                        
month          08                                          
day            26                                          
svn rev        60438                                       
language       R                                           
version.string R version 2.15.1 Patched (2012-08-26 r60438)
nickname       Roasted Marshmallows                        
> 


? Simon Jackman

Simon Jackman, Depts of Political Science & (by courtesy) Statistics, 
Stanford University, Stanford, CA 94305-6044, USA.
http://jackman.stanford.edu
Co-Principal Investigator, American National Election Studies
cell: +1 (650) 387 3019  fax: +1 (650) 724-9095


From murdoch.duncan at gmail.com  Mon Aug 27 22:15:16 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 27 Aug 2012 16:15:16 -0400
Subject: [Rd] very minor typo in doc for embedFonts
In-Reply-To: <8BDA4B6C-527F-4836-9E30-42E11D8DE67D@stanford.edu>
References: <8BDA4B6C-527F-4836-9E30-42E11D8DE67D@stanford.edu>
Message-ID: <503BD554.3020207@gmail.com>

On 27/08/2012 3:43 PM, Simon Jackman wrote:
> in the "Details" section:
>
> "It this is unset?"
>
> should read
>
> "If this is unset"

Thanks, will fix.

Duncan Murdoch
>
> > version
>                 _
> platform       x86_64-apple-darwin9.8.0
> arch           x86_64
> os             darwin9.8.0
> system         x86_64, darwin9.8.0
> status         Patched
> major          2
> minor          15.1
> year           2012
> month          08
> day            26
> svn rev        60438
> language       R
> version.string R version 2.15.1 Patched (2012-08-26 r60438)
> nickname       Roasted Marshmallows
> >
>
>
> ? Simon Jackman
>
> Simon Jackman, Depts of Political Science & (by courtesy) Statistics,
> Stanford University, Stanford, CA 94305-6044, USA.
> http://jackman.stanford.edu
> Co-Principal Investigator, American National Election Studies
> cell: +1 (650) 387 3019  fax: +1 (650) 724-9095
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From lxh37 at psu.edu  Tue Aug 28 01:29:35 2012
From: lxh37 at psu.edu (LIYING HUANG)
Date: Mon, 27 Aug 2012 19:29:35 -0400 (EDT)
Subject: [Rd] include dll in R-package
In-Reply-To: <CAC2h7utkB1iNKMUDSWwF0iUoAeYde0Wvza7_B+ANYy5P+wviVQ@mail.gmail.com>
Message-ID: <1184021837.3248294.1346110175472.JavaMail.root@psu.edu>


I am quite new in R, I looked at R manual- how to build R Package, 
still not very clear. Yes, it would be very helpful if I could 
download a package having Fortran source codes to look at, Do 
you know any package built with Fortran source code? Thanks!

Liy


----- ???? -----
???: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>
???: "LIYING HUANG" <lxh37 at psu.edu>
??: r-devel at r-project.org
????: ???, 2012? 8 ? 24? ?? 10:19:14
??: Re: [Rd] include dll in R-package

You need to setup a Makevars.win and at lest modify 
PKG_LIBS 
and probably 
PKG_FFLAGS 
PKG_CFLAGS 
depending on how you link to the DLL. 


I suggest downloading example packages from Bioc / CRAN to look at. 


Kasper 


On Fri, Aug 24, 2012 at 9:06 AM, LIYING HUANG < lxh37 at psu.edu > wrote: 



Hi, 

We have several projects in the center done by researchers over years 
in Fortran, there are copy right issues etc to prevent us from 
giving away the source codes, but a lot of social scientist are 
interested to use the program. We tried to use dlls to make plugins 
(available in our website) in various statistics platforms 
(SAS, STATA and R) to make it available to general public. 

We used to be able to build R package using dll on version R-2.7.0, 
, but failed to build with newer R version with the same source. 
Any help is greatly appreciated. 

When I try to build R package for newer version of R, I could build 
to get "lcca_1.0.0.tar.gz", but when I "R CMD check lcca_1.0.0.tar.gz", 
I got error message as: 

* using log directory 'D:/project/LCCA/lcca.Rcheck' 
* using R version 2.15.1 (2012-06-22) 
* using platform: i386-pc-mingw32 (32-bit) 
* using session charset: ISO8859-1 
* checking for file 'lcca/DESCRIPTION' ... OK 
* checking extension type ... Package 
* this is package 'lcca' version '1.0.0' 
* checking package namespace information ... OK 
* checking package dependencies ... OK 
* checking if this is a source package ... OK 
* checking if there is a namespace ... OK 
* checking for executable files ... WARNING 
Found the following executable file(s): 
libs/lcca.dll 
Source packages should not contain undeclared executable files. 
See section 'Package structure' in the 'Writing R Extensions' manual. 
* checking whether package 'lcca' can be installed ... ERROR 
Installation failed. 
See 'D:/project/LCCA/lcca.Rcheck/00install.out' for details. 

and the message in 00install.out is: 

* installing *source* package 'lcca' ... 
** R 
** data 
** preparing package for lazy loading 
** help 
*** installing help indices 
** building package indices 
** testing if installed package can be loaded 
Error in library.dynam(lib, package, package.lib) : 
DLL 'lcca' not found: maybe not installed for this architecture? 
Error: loading failed 
Execution halted 
ERROR: loading failed 
* removing 'D:/project/LCCA/lcca.Rcheck/lcca' 


Thanks a lot! 
Liy 

______________________________________________ 
R-devel at r-project.org mailing list 
https://stat.ethz.ch/mailman/listinfo/r-devel 


From bhh at xs4all.nl  Tue Aug 28 13:02:02 2012
From: bhh at xs4all.nl (Berend Hasselman)
Date: Tue, 28 Aug 2012 13:02:02 +0200
Subject: [Rd] include dll in R-package
In-Reply-To: <1184021837.3248294.1346110175472.JavaMail.root@psu.edu>
References: <1184021837.3248294.1346110175472.JavaMail.root@psu.edu>
Message-ID: <DDCB3450-4867-4E68-8CEA-DDCAC1D311D4@xs4all.nl>


On 28-08-2012, at 01:29, LIYING HUANG wrote:

> 
> I am quite new in R, I looked at R manual- how to build R Package, 
> still not very clear. Yes, it would be very helpful if I could 
> download a package having Fortran source codes to look at, Do 
> you know any package built with Fortran source code? Thanks!
> 

To mention a few:

deSolve
minpack.lm
nleqslv
rootSolve
xts

and probably many more.

Berend


From mtmorgan at fhcrc.org  Tue Aug 28 19:29:29 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 28 Aug 2012 10:29:29 -0700
Subject: [Rd] parLapply fails to detect default cluster?
In-Reply-To: <5033923B.1050107@fhcrc.org>
References: <5033923B.1050107@fhcrc.org>
Message-ID: <503CFFF9.1030700@fhcrc.org>

Thank you for the fix, in svn R-devel and 2-15-patched r60447, r60448. 
Martin

On 08/21/2012 06:50 AM, Martin Morgan wrote:
> invoking parLapply without a cluster fails to find a previously
> registered cluster
>
>  > library(parallel)
>  > setDefaultCluster(makePSOCKcluster(2))
>  > parLapply(X=1:2, fun=function(...) {})
> Error in cut.default(i, breaks) : invalid number of intervals
>
> This is because in parLapply length(cl) is determined before
> defaultCluster(cl) is called. By inspection, this appears to be true of
> other high-level functions, but ironically not of parApply.
>
> In defaultCluster, t would also be helpful to check that the detected
> cluster, user-supplied or other, is a valid cluster.
>
> diff attached.
>
> Martin
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From michael.weylandt at gmail.com  Tue Aug 28 19:51:27 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Tue, 28 Aug 2012 12:51:27 -0500
Subject: [Rd] Don't dput() data frames?
Message-ID: <CAAmySGMtCb9dA1=iNZ_FW8J4498q93RcPjAQFTr5cj_f7YzjPw@mail.gmail.com>

/src/main/attrib.c contains this comment in row_names_gets():

  /* This should not happen, but if a careless user dput()s a
           data frame and sources the result, it will */

which svn blame says Prof Ripley placed there in r39830 with the
commit message "correct the work of dput() on the row names of a data
frame with compact representation."

Is there a problem / better way to use the result of a hefty dput than
source()ing it? This seems to work rather robustly:

data(iris)
source(textConnection(paste0("iris2 <- ", capture.output(dput(iris)))))
identical(iris, iris2)

Cheers,
Michael


From simon.urbanek at r-project.org  Tue Aug 28 20:00:00 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 28 Aug 2012 14:00:00 -0400
Subject: [Rd] Don't dput() data frames?
In-Reply-To: <CAAmySGMtCb9dA1=iNZ_FW8J4498q93RcPjAQFTr5cj_f7YzjPw@mail.gmail.com>
References: <CAAmySGMtCb9dA1=iNZ_FW8J4498q93RcPjAQFTr5cj_f7YzjPw@mail.gmail.com>
Message-ID: <DE41AE7A-F75D-40AF-B9C9-AF70A6771489@r-project.org>


On Aug 28, 2012, at 1:51 PM, R. Michael Weylandt wrote:

> /src/main/attrib.c contains this comment in row_names_gets():
> 
>  /* This should not happen, but if a careless user dput()s a
>           data frame and sources the result, it will */
> 
> which svn blame says Prof Ripley placed there in r39830 with the
> commit message "correct the work of dput() on the row names of a data
> frame with compact representation."
> 
> Is there a problem / better way to use the result of a hefty dput than
> source()ing it?

It's pretty much the least efficient and most dangerous (as in insecure) way. That's why there is serialization instead ...

Cheers,
Simon



> This seems to work rather robustly:
> 
> data(iris)
> source(textConnection(paste0("iris2 <- ", capture.output(dput(iris)))))
> identical(iris, iris2)
> 
> Cheers,
> Michael
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From michael.weylandt at gmail.com  Tue Aug 28 20:14:56 2012
From: michael.weylandt at gmail.com (R. Michael Weylandt)
Date: Tue, 28 Aug 2012 13:14:56 -0500
Subject: [Rd] Don't dput() data frames?
In-Reply-To: <DE41AE7A-F75D-40AF-B9C9-AF70A6771489@r-project.org>
References: <CAAmySGMtCb9dA1=iNZ_FW8J4498q93RcPjAQFTr5cj_f7YzjPw@mail.gmail.com>
	<DE41AE7A-F75D-40AF-B9C9-AF70A6771489@r-project.org>
Message-ID: <CAAmySGOW1VXyn-jLXJS6xVq2VNi1BpF2ws1nnK0DmS-z4V+_Og@mail.gmail.com>

On Tue, Aug 28, 2012 at 1:00 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On Aug 28, 2012, at 1:51 PM, R. Michael Weylandt wrote:
>
>> /src/main/attrib.c contains this comment in row_names_gets():
>>
>>  /* This should not happen, but if a careless user dput()s a
>>           data frame and sources the result, it will */
>>
>> which svn blame says Prof Ripley placed there in r39830 with the
>> commit message "correct the work of dput() on the row names of a data
>> frame with compact representation."
>>
>> Is there a problem / better way to use the result of a hefty dput than
>> source()ing it?
>
> It's pretty much the least efficient and most dangerous (as in insecure) way. That's why there is serialization instead ...
>

My most common use of dput() is for sending plain text data over
r-help; would this be an official/unofficial advisement to push folks
to use

serialize(x, NULL, ascii = TRUE)

instead? At first blush that seems to be less space efficient:

sum(nchar(capture.output(dput(iris)))) # 3767

sum(nchar(serialize(iris, NULL, ascii = TRUE))) # 5922: probably even
more if we dump it properly to plain text in a copy+pasteable form

Michael

> Cheers,
> Simon
>
>
>
>> This seems to work rather robustly:
>>
>> data(iris)
>> source(textConnection(paste0("iris2 <- ", capture.output(dput(iris)))))
>> identical(iris, iris2)
>>
>> Cheers,
>> Michael
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From simon.urbanek at r-project.org  Tue Aug 28 20:27:53 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 28 Aug 2012 14:27:53 -0400
Subject: [Rd] Don't dput() data frames?
In-Reply-To: <CAAmySGOW1VXyn-jLXJS6xVq2VNi1BpF2ws1nnK0DmS-z4V+_Og@mail.gmail.com>
References: <CAAmySGMtCb9dA1=iNZ_FW8J4498q93RcPjAQFTr5cj_f7YzjPw@mail.gmail.com>
	<DE41AE7A-F75D-40AF-B9C9-AF70A6771489@r-project.org>
	<CAAmySGOW1VXyn-jLXJS6xVq2VNi1BpF2ws1nnK0DmS-z4V+_Og@mail.gmail.com>
Message-ID: <D1E02CF2-6C08-477E-B694-C9D74897E89A@r-project.org>


On Aug 28, 2012, at 2:14 PM, "R. Michael Weylandt" <michael.weylandt at gmail.com> wrote:

> On Tue, Aug 28, 2012 at 1:00 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>> 
>> On Aug 28, 2012, at 1:51 PM, R. Michael Weylandt wrote:
>> 
>>> /src/main/attrib.c contains this comment in row_names_gets():
>>> 
>>> /* This should not happen, but if a careless user dput()s a
>>>          data frame and sources the result, it will */
>>> 
>>> which svn blame says Prof Ripley placed there in r39830 with the
>>> commit message "correct the work of dput() on the row names of a data
>>> frame with compact representation."
>>> 
>>> Is there a problem / better way to use the result of a hefty dput than
>>> source()ing it?
>> 
>> It's pretty much the least efficient and most dangerous (as in insecure) way. That's why there is serialization instead ...
>> 
> 
> My most common use of dput() is for sending plain text data over
> r-help; would this be an official/unofficial advisement to push folks
> to use
> 
> serialize(x, NULL, ascii = TRUE)
> 
> instead? At first blush that seems to be less space efficient:
> 
> sum(nchar(capture.output(dput(iris)))) # 3767
> 
> sum(nchar(serialize(iris, NULL, ascii = TRUE))) # 5922: probably even
> more if we dump it properly to plain text in a copy+pasteable form
> 

No, if you want small, readable snippets you can certainly use dput(), but when you say data frame I don't imagine anything that can be sent by e-mail :). Obviously, for toy examples you don't care about performance ...

As for size efficiency:
> save(iris,file="iris.RData")
> file.info("iris.RData")$size
[1] 1100
so in base64 that would be about 1.5k - much less than any of the above.

Cheers,
Simon


> Michael
> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>>> This seems to work rather robustly:
>>> 
>>> data(iris)
>>> source(textConnection(paste0("iris2 <- ", capture.output(dput(iris)))))
>>> identical(iris, iris2)
>>> 
>>> Cheers,
>>> Michael
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>> 
> 
> 


From murdoch.duncan at gmail.com  Tue Aug 28 21:39:01 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 28 Aug 2012 15:39:01 -0400
Subject: [Rd] Fwd: Re: Package cwhmisc and problems
In-Reply-To: <5037555D.2010608@sunrise.ch>
References: <50372066.4080807@stats.ox.ac.uk> <5037555D.2010608@sunrise.ch>
Message-ID: <503D1E55.8070204@gmail.com>

I'd guess you have a syntax error in the dependencies listed in your 
DESCRIPTION file.  (It might be Depends, Suggests, or one of the others.)

Duncan Murdoch


On 12-08-24 6:20 AM, Christian Hoffmann wrote:
>
>
>
> -------- Original-Nachricht --------
> Betreff: 	Re: Package cwhmisc and problems
> Datum: 	Fri, 24 Aug 2012 07:34:14 +0100
> Von: 	Prof Brian Ripley <ripley at stats.ox.ac.uk>
> An: 	Christian Hoffmann <c-w.hoffmann at sunrise.ch>
> Kopie (CC): 	CRAN at r-project.org
>
>
>
> This is the address for CRAN submissions.  Please ask for help on R-help
> or R-devel.
>
> On 23/08/2012 20:16, Christian Hoffmann wrote:
>> Hi,
>> I have revised my package cwhmisc and want to re-submit it. One big
>> stumbling stone is the 'sudden' appearance of
>>
>> $ R CMD check /Users/hoffmann/R/cwhmisc
>> * using log directory ???/Users/hoffmann/R/cwhmisc/R/cwhmisc.Rcheck???
>> * using R version 2.15.0 (2012-03-30)
>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>> * using session charset: UTF-8
>> * checking for file ???cwhmisc/DESCRIPTION??? ... OK
>> * this is package ???cwhmisc??? version ???3.1???
>> * checking package namespace information ... OK
>> * checking package dependencies ...Fehler in if (x2 != x1) { : Fehlender
>> Wert, wo TRUE/FALSE n??tig ist
>> Ausf??hrung angehalten
>>
>> Grep-ing my source directory for '(x2 != x1)' does not find anything, so
>> I guess this is a message internal to R CMD check. Before doing a binary
>> search by moving out chunks of *.R and *.Rd files until the error
>> disappears, I beg to ask to give me a pointer to how to circumvent this
>> block. I can send you my whole source of *.R and *.Rd files if that can
>> be of any help.
>>
>> Thanks for assisting me,
>>
>> Christian Hoffmann
>>
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From erik.shilts at gmail.com  Tue Aug 28 23:48:44 2012
From: erik.shilts at gmail.com (Erik Shilts)
Date: Tue, 28 Aug 2012 17:48:44 -0400
Subject: [Rd] R package repository management tools
Message-ID: <CAAExCyKEjfyRR4z2iBvvcS53v8z9Ms4TvS+WyGkyjUr+P4JCyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120828/b19d48fd/attachment.pl>

From lxh37 at psu.edu  Wed Aug 29 05:31:36 2012
From: lxh37 at psu.edu (LIYING HUANG)
Date: Tue, 28 Aug 2012 23:31:36 -0400 (EDT)
Subject: [Rd] include dll in R-package
In-Reply-To: <DDCB3450-4867-4E68-8CEA-DDCAC1D311D4@xs4all.nl>
Message-ID: <159640230.4428504.1346211096341.JavaMail.root@psu.edu>



Thanks a lot for those examples, is there any example with Fortran
source codes which could depend on an external Fortran DLL?

Liy

----- ???? -----
???: "Berend Hasselman" <bhh at xs4all.nl>
???: "LIYING HUANG" <lxh37 at psu.edu>
??: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>, r-devel at r-project.org
????: ???, 2012? 8 ? 28? ?? 7:02:02
??: Re: [Rd] include dll in R-package


On 28-08-2012, at 01:29, LIYING HUANG wrote:

> 
> I am quite new in R, I looked at R manual- how to build R Package, 
> still not very clear. Yes, it would be very helpful if I could 
> download a package having Fortran source codes to look at, Do 
> you know any package built with Fortran source code? Thanks!
> 

To mention a few:

deSolve
minpack.lm
nleqslv
rootSolve
xts

and probably many more.

Berend


From sebastian.meyer at ifspm.uzh.ch  Tue Aug 28 23:11:40 2012
From: sebastian.meyer at ifspm.uzh.ch (sebastian.meyer at ifspm.uzh.ch)
Date: Tue, 28 Aug 2012 23:11:40 +0200
Subject: [Rd] using setOldClass() causes warning on unloadNamespace() if the
 package imports methods
Message-ID: <OF9326DE4E.68F7250E-ONC1257A68.00746C92-C1257A68.00746CB0@lotus.uzh.ch>

For the CRAN-package "surveillance", unloadNamespace("surveillance") gives the following warning message:

In FUN(X[[2L]], ...) :
  Created a package name, ?2012-08-28 22:42:37?, when none found

Similar warnings appear for the CRAN-package "solaR" and probably some other packages.

I created a dummy package (tarball is attached) to find out where this warning comes from.
Apparently, the warning is related to the package defining a virtual S4 class using setOldClass("fooS3class"). However, the crucial thing is that the warning only appears, when the methods package is imported in the NAMESPACE. There is also no warning if setClass("fooS3class") is used instead. So my question is: What would be the right way of handling S3 classes in the S4 world?

My minor second question is: Should the NAMESPACE state exportMethods(coerce) if the package defines new coerce-methods? It seems that coercion-methods defined by the package using setAs() are also visible after loading the package without explicitly exporting these. However, if one includes exportMethods(coerce) then one must also document them (as stated by R CMD check).

Thanks for any hints!

   Sebastian


PS: using
R Under development (unstable) (2012-08-28 r60472)
Platform: x86_64-unknown-linux-gnu (64-bit)


From janko.thyson.rstuff at googlemail.com  Wed Aug 29 11:25:58 2012
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Wed, 29 Aug 2012 11:25:58 +0200
Subject: [Rd] "Ambiguous" variation of default environment in `getClasses()`
 (standard function vs. formal S4 method)
Message-ID: <503DE026.6060300@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120829/92c2fdf4/attachment.pl>

From bhh at xs4all.nl  Wed Aug 29 13:19:13 2012
From: bhh at xs4all.nl (Berend Hasselman)
Date: Wed, 29 Aug 2012 13:19:13 +0200
Subject: [Rd] include dll in R-package
In-Reply-To: <159640230.4428504.1346211096341.JavaMail.root@psu.edu>
References: <159640230.4428504.1346211096341.JavaMail.root@psu.edu>
Message-ID: <3B9705D0-FA3E-4DE8-863C-A7BD1AFCD4C4@xs4all.nl>


On 29-08-2012, at 05:31, LIYING HUANG wrote:

> 
> 
> Thanks a lot for those examples, is there any example with Fortran
> source codes which could depend on an external Fortran DLL?
> 

I wouldn't know.

Berend


From ripley at stats.ox.ac.uk  Wed Aug 29 14:35:42 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 29 Aug 2012 13:35:42 +0100
Subject: [Rd] include dll in R-package
In-Reply-To: <3B9705D0-FA3E-4DE8-863C-A7BD1AFCD4C4@xs4all.nl>
References: <159640230.4428504.1346211096341.JavaMail.root@psu.edu>
	<3B9705D0-FA3E-4DE8-863C-A7BD1AFCD4C4@xs4all.nl>
Message-ID: <503E0C9E.1050502@stats.ox.ac.uk>

On 29/08/2012 12:19, Berend Hasselman wrote:
>
> On 29-08-2012, at 05:31, LIYING HUANG wrote:
>
>>
>>
>> Thanks a lot for those examples, is there any example with Fortran
>> source codes which could depend on an external Fortran DLL?
>>
>
> I wouldn't know.
>
> Berend

What does 'depend on' mean here?  (All the context has been removed, 
pace the posting guide.)

If it means 'link to', then any package which uses BLAS or LAPACK is an 
example.  But strictly you cannot link to a DLL (although you can on 
Windows, but on OS X what R calls DLL is not what OS X calls a 'dynamic 
library').

If you want to dynamically load an external DLL then

- there are no Fortran examples on CRAN
- you need to ensure that the DLL is already linked to the Fortran 
runtime (which typically Fortran DLLs are not).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hb at biostat.ucsf.edu  Wed Aug 29 21:27:53 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 29 Aug 2012 12:27:53 -0700
Subject: [Rd] Suggestion: Change default to download.file(...,
 mode="wb") ...instead of mode="w" with some bells and whistles
Message-ID: <CAFDcVCSthCJGyvvVZBnWJqYb-F4Z8ZT_YZA7E0GK1Mx5CoNYkw@mail.gmail.com>

Hi,

I keep seeing the problem where people are download binary files as
text (mode="w") when using R's download.file() for FTP/HTTP downloads.
 It often results in unnecessary troubleshooting until one concludes
that the downloaded file has been corrupted due to (what I think is)
translated newlines.  Search the r-help mailing list and you'll find
other examples of this.  This may or may not only be a problem for
Windows users.

I'd like to suggest to change the default of argument 'mode' of
download.file() to be mode="wb".  The "default" is current mode="w"
except when argument 'mode' is missing (not explicitly given),
download.file() tries to be helpful by forcing 'mode' to be "wb" for
certain filename extensions.  NB: help("download.file",
package="utils") has a paragraph on all this.  BTW, the latter seems
to be done in a case-sensitive way, such that *.zip and *.ZIP will
have different behaviors.

Wouldn't it just be safer to change the default to mode="wb"?  ...or
are there use cases that I'm overseeing - is anyone out there
intentionally using the "text" transfer mode?

/Henrik


From christian at sigg-iten.ch  Wed Aug 29 16:08:36 2012
From: christian at sigg-iten.ch (Christian Sigg)
Date: Wed, 29 Aug 2012 16:08:36 +0200
Subject: [Rd] Terminating and restarting an embedded R instance possible?
Message-ID: <BA049E17-2711-42DC-8600-A67CA4A4EE7F@sigg-iten.ch>

I am developing R functions that interface with C++ code from the OpenCV library. During  development and unit testing, I embed an R instance to prepare the environment in which the function encapsulating OpenCV code is called.

Running the unit testing suite results in starting (and later terminating) an embedded R instance for each test. This produces a series of error messages when Rf_initEmbeddedR is called for the second time. This error is reproduced by running

#include <Rembedded.h>

int main(int argc, char **argv) {
   
    Rf_initEmbeddedR(argc, argv);
    Rf_endEmbeddedR(0);
   
    Rf_initEmbeddedR(argc, argv);
    Rf_endEmbeddedR(0);
    
    return 0;
}

which outputs the following two lines

Error: bad target context--should NEVER happen;
please bug.report() [R_run_onexits]

a great number of times (this is on OS X 10.7 with Xcode 4.4.1, version 4.4.0.0.1.124936715 of the command line tools and R 2.15.1).

Debugging the above program indicates that the error happens in installFunTab(). Not knowing R internals, I can only guess that state from the first embedded instance leaks into the second instance.

Soeren Sonnenburg asked a similar question on March 5th 2009 but there was no reply. He also mentioned a bug report

http://bugs.r-project.org/cgi-bin/R/trashcan?id=12644;user=guest;selectid=12644

but that link no longer works and bug # 12644 is not in the current database.

Can the above mentioned code be made to work?

Thank you,
Christian

From simon.urbanek at r-project.org  Thu Aug 30 17:14:59 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 30 Aug 2012 11:14:59 -0400
Subject: [Rd] Terminating and restarting an embedded R instance possible?
In-Reply-To: <BA049E17-2711-42DC-8600-A67CA4A4EE7F@sigg-iten.ch>
References: <BA049E17-2711-42DC-8600-A67CA4A4EE7F@sigg-iten.ch>
Message-ID: <09421E43-1529-4061-8065-FB17219D1960@r-project.org>


On Aug 29, 2012, at 10:08 AM, Christian Sigg <christian at sigg-iten.ch> wrote:

> I am developing R functions that interface with C++ code from the OpenCV library. During  development and unit testing, I embed an R instance to prepare the environment in which the function encapsulating OpenCV code is called.
> 
> Running the unit testing suite results in starting (and later terminating) an embedded R instance for each test. This produces a series of error messages when Rf_initEmbeddedR is called for the second time.

To my best knowledge you cannot init R more than once in the same process. There are many global variables that rely on being initialized by the data segment. Supporting re-init of R would be a considerable effort as many of those are static so there is no simple way to re-set them.

Cheers,
Simon



> This error is reproduced by running
> 
> #include <Rembedded.h>
> 
> int main(int argc, char **argv) {
> 
>    Rf_initEmbeddedR(argc, argv);
>    Rf_endEmbeddedR(0);
> 
>    Rf_initEmbeddedR(argc, argv);
>    Rf_endEmbeddedR(0);
> 
>    return 0;
> }
> 
> which outputs the following two lines
> 
> Error: bad target context--should NEVER happen;
> please bug.report() [R_run_onexits]
> 
> a great number of times (this is on OS X 10.7 with Xcode 4.4.1, version 4.4.0.0.1.124936715 of the command line tools and R 2.15.1).
> 
> Debugging the above program indicates that the error happens in installFunTab(). Not knowing R internals, I can only guess that state from the first embedded instance leaks into the second instance.
> 
> Soeren Sonnenburg asked a similar question on March 5th 2009 but there was no reply. He also mentioned a bug report
> 
> http://bugs.r-project.org/cgi-bin/R/trashcan?id=12644;user=guest;selectid=12644
> 
> but that link no longer works and bug # 12644 is not in the current database.
> 
> Can the above mentioned code be made to work?
> 
> Thank you,
> Christian
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From mtmorgan at fhcrc.org  Thu Aug 30 21:39:43 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 30 Aug 2012 12:39:43 -0700
Subject: [Rd] stack overflow? was Re: [R] segfault in gplots::heatmap.2
In-Reply-To: <CAAmySGPC8bYUdv40=AKThKKURnMk_yW+3dbV05mn_GzpTmhjiQ@mail.gmail.com>
References: <87harkhm5p.fsf@med.uni-goettingen.de>
	<CAAmySGPC8bYUdv40=AKThKKURnMk_yW+3dbV05mn_GzpTmhjiQ@mail.gmail.com>
Message-ID: <503FC17F.9090902@fhcrc.org>

I think this belongs on R-devel and I'm forwarding there.

Here's a more refined example

   library("XLConnect")
   load(file="ddr.Rda")

   oV <- function(x) {
       if (is.leaf(x)) {
           return(x)
       }
       for (j in seq_along(x)) {
           b <- oV(x[[j]])
       }
       x
   }

   res <- oV(ddr)                      # segfault for me under 2.15.1
   str(ddr)                            # segfault more reliably

'ddr' is a dendrogram produced from Andreas' original object at the 
point where heatmap.2 calls 'reorder'. 'oV' is a reduced version of the 
internal function in reorder.dendrogram.

Simple changes to oV above have interesting effects, e.g., removing {} 
in the 'if' and 'for' mean that the segfault labelled at 2.15.1 does not 
occur.

Under R-devel, valgrind complains about Java (I think this is a red 
herring) and then


14604== Can't extend stack to 0x7fef03370 during signal delivery for 
thread 1:
==14604==   too small or bad protection modes

which likely indicates stack overflow.

gdb shows that we're several 1000's of calls down when the segfault occurs.

I think R overflows its stack, and that rJava just makes that more 
likely to occur. I don't really know how to investigate a stack overflow 
further.

Martin

R version 2.15.1 Patched (2012-08-26 r60438)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


 > sessionInfo()
R Under development (unstable) (2012-08-20 r60336)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


On 08/30/2012 12:04 PM, R. Michael Weylandt wrote:
> On Thu, Aug 30, 2012 at 2:30 AM, Andreas Leha
> <andreas.leha at med.uni-goettingen.de> wrote:
>> Hi all,
>>
>> I experience a segfault when calling gplots::heatmap.2(), but only when
>> certain other packages are loaded.
>>
>> I am not sure for the correct place to send this bug report.  Should I send
>> it to the package maintainers directly?  If R-help is the wrong place,
>> please feel free to direct me to the correct one.
>>
>> I am on debian (testing) linux 64 with the binary R distribution
>> from the repositories (version 2.15.1).
>>
>> Below follows a simple reproducible example causing the segfault on my
>> machine.
>> The offending dataset is quite big, so instead of posting it here I put
>> it here: https://gist.github.com/3523761.  Please put it into offending.txt to
>> make the code below working.
>>
>> This is the example.  Note, that without loading 'XLConnect' this works
>> nicely.
>> #+begin_src R
>>    library("gplots")
>>    library("XLConnect") # any of XLConnect, venneuler, xlsx case a segfault
>>
>>    offending <- dget("offending.txt")
>>    heatmap.2(x=offending)
>> #+end_src
>>
>> Interestingly, I get a segfault when loading any of c("XLConnect",
>> "venneuler", "xlsx"), which all depend on rJava.  But loading rJava on
>> its own did not produce a segfault.
>
> Hi Andreas,
>
> Thanks for the nicely reproducible example. Unfortunately, I can't
> reproduce the segfault on my Mac OS X 10.6 running R 2.15.0. I could
> only test with rJava + venneuler because xlsx and XLConnect fall
> victim to Mac's Java "infelicities." It's something of a formality,
> but are you sure you are up-to-date with your packages as well as with
> R itself. Something like
>
> update.packages(checkBuilt = TRUE)
>
> will ensure you've got the most current release of all your packages.
> (Note that I'm not sure that's the right way to do it on Debian)
>
> Do you happen to know if this happens with other versions of R? e.g.,
> 2.15.0 or the not-yet-released R-devel or R-patched (maintenance
> branch of 2.15.z which will become 2.15.2 eventually)
>
> Consequently, I'd suspect that there's something going on in the
> intersection of Java + R + Deb Testing, so three places you might seek
> more advanced help, as this is likely deeper than the day-to-day of
> this list. i) The rJava mailing list
> (http://mailman.rz.uni-augsburg.de/mailman/listinfo/stats-rosuda-devel);
> ii) the R-SIG-Debian list; iii) the R Devel list.
>
> I'm not sure which one makes the most sense to try, but I'd think the
> third should be of last resort, because it seems least likely to be a
> problem in base-R if it requires rJava being around to reproduce. The
> R-SIG-Debian list most likely has someone who can reproduce your exact
> config.
>
> Cheers,
> Michael
>
>>
>> Regards,
>> Andreas
>>
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ddr.Rda.tar
Type: application/x-tar
Size: 10240 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120830/21c615f1/attachment.tar>

From ggrothendieck at gmail.com  Thu Aug 30 21:48:01 2012
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 30 Aug 2012 15:48:01 -0400
Subject: [Rd] tcltk capability
Message-ID: <CAP01uRn1EdG0cGyzoDPwmSaK2wiUWQ3mrOY3GrjMOT2qeSCXjQ@mail.gmail.com>

There are quite a few packages that make use of tcltk and although

- most R distributions have tcltk capability
- its possible to query this via capabilities()[["tcltk"]]
- attempting to build a package that needs it on such an R
distribution will give a message letting one know

users still seem to have problems with this.

There was recently an R bug report submitted that likely stemmed from
the user having such a build of R and recently there was also an R
help post that seemed to be related to this as well.  As more and more
packages add GUI capability these incidents are bound to increase.

The best situation would be to arrange that every distribution of R
have tcltk capability but if this is difficult to arrange then I
suggest there be a message at start up similar to the existing locale
message letting the user know that the R distribution they are running
lacks tcltk capability.  Preferably the message would be somewhat
menacing so that users are encouraged to get a different distribution
of R right from the start.

This might reduce such problem reports somewhat.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From simon.urbanek at r-project.org  Thu Aug 30 21:54:25 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 30 Aug 2012 15:54:25 -0400
Subject: [Rd] stack overflow? was Re: [R] segfault in gplots::heatmap.2
In-Reply-To: <503FC17F.9090902@fhcrc.org>
References: <87harkhm5p.fsf@med.uni-goettingen.de>
	<CAAmySGPC8bYUdv40=AKThKKURnMk_yW+3dbV05mn_GzpTmhjiQ@mail.gmail.com>
	<503FC17F.9090902@fhcrc.org>
Message-ID: <E2576FF5-1B67-4E88-9448-27B835DC0359@r-project.org>


On Aug 30, 2012, at 3:39 PM, Martin Morgan <mtmorgan at fhcrc.org> wrote:

> I think this belongs on R-devel and I'm forwarding there.
> 
> Here's a more refined example
> 
>  library("XLConnect")
>  load(file="ddr.Rda")
> 
>  oV <- function(x) {
>      if (is.leaf(x)) {
>          return(x)
>      }
>      for (j in seq_along(x)) {
>          b <- oV(x[[j]])
>      }
>      x
>  }
> 
>  res <- oV(ddr)                      # segfault for me under 2.15.1
>  str(ddr)                            # segfault more reliably
> 
> 'ddr' is a dendrogram produced from Andreas' original object at the point where heatmap.2 calls 'reorder'. 'oV' is a reduced version of the internal function in reorder.dendrogram.
> 
> Simple changes to oV above have interesting effects, e.g., removing {} in the 'if' and 'for' mean that the segfault labelled at 2.15.1 does not occur.
> 
> Under R-devel, valgrind complains about Java (I think this is a red herring) and then
> 
> 
> 14604== Can't extend stack to 0x7fef03370 during signal delivery for thread 1:
> ==14604==   too small or bad protection modes
> 
> which likely indicates stack overflow.
> 
> gdb shows that we're several 1000's of calls down when the segfault occurs.
> 
> I think R overflows its stack, and that rJava just makes that more likely to occur. I don't really know how to investigate a stack overflow further.
> 

In general, the moment you load Java, stack checking is disabled, because that turns the R process into a multi-threaded application so the stack is no longer guaranteed at a fixed location. Guarding the stack is messy enough without threads, but it becomes close to impossible with threads.

If you have stack checking enabled, it gets caught:


>  str(ddr)                            # segfault more reliably
[...]
                                                                                           |--leaf "124" 
     |  |  |                                |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                        `--Error: C stack usage is too close to the limit

Cheers,
Simon



> Martin
> 
> R version 2.15.1 Patched (2012-08-26 r60438)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> 
> > sessionInfo()
> R Under development (unstable) (2012-08-20 r60336)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> 
> On 08/30/2012 12:04 PM, R. Michael Weylandt wrote:
>> On Thu, Aug 30, 2012 at 2:30 AM, Andreas Leha
>> <andreas.leha at med.uni-goettingen.de> wrote:
>>> Hi all,
>>> 
>>> I experience a segfault when calling gplots::heatmap.2(), but only when
>>> certain other packages are loaded.
>>> 
>>> I am not sure for the correct place to send this bug report.  Should I send
>>> it to the package maintainers directly?  If R-help is the wrong place,
>>> please feel free to direct me to the correct one.
>>> 
>>> I am on debian (testing) linux 64 with the binary R distribution
>>> from the repositories (version 2.15.1).
>>> 
>>> Below follows a simple reproducible example causing the segfault on my
>>> machine.
>>> The offending dataset is quite big, so instead of posting it here I put
>>> it here: https://gist.github.com/3523761.  Please put it into offending.txt to
>>> make the code below working.
>>> 
>>> This is the example.  Note, that without loading 'XLConnect' this works
>>> nicely.
>>> #+begin_src R
>>>   library("gplots")
>>>   library("XLConnect") # any of XLConnect, venneuler, xlsx case a segfault
>>> 
>>>   offending <- dget("offending.txt")
>>>   heatmap.2(x=offending)
>>> #+end_src
>>> 
>>> Interestingly, I get a segfault when loading any of c("XLConnect",
>>> "venneuler", "xlsx"), which all depend on rJava.  But loading rJava on
>>> its own did not produce a segfault.
>> 
>> Hi Andreas,
>> 
>> Thanks for the nicely reproducible example. Unfortunately, I can't
>> reproduce the segfault on my Mac OS X 10.6 running R 2.15.0. I could
>> only test with rJava + venneuler because xlsx and XLConnect fall
>> victim to Mac's Java "infelicities." It's something of a formality,
>> but are you sure you are up-to-date with your packages as well as with
>> R itself. Something like
>> 
>> update.packages(checkBuilt = TRUE)
>> 
>> will ensure you've got the most current release of all your packages.
>> (Note that I'm not sure that's the right way to do it on Debian)
>> 
>> Do you happen to know if this happens with other versions of R? e.g.,
>> 2.15.0 or the not-yet-released R-devel or R-patched (maintenance
>> branch of 2.15.z which will become 2.15.2 eventually)
>> 
>> Consequently, I'd suspect that there's something going on in the
>> intersection of Java + R + Deb Testing, so three places you might seek
>> more advanced help, as this is likely deeper than the day-to-day of
>> this list. i) The rJava mailing list
>> (http://mailman.rz.uni-augsburg.de/mailman/listinfo/stats-rosuda-devel);
>> ii) the R-SIG-Debian list; iii) the R Devel list.
>> 
>> I'm not sure which one makes the most sense to try, but I'd think the
>> third should be of last resort, because it seems least likely to be a
>> problem in base-R if it requires rJava being around to reproduce. The
>> R-SIG-Debian list most likely has someone who can reproduce your exact
>> config.
>> 
>> Cheers,
>> Michael
>> 
>>> 
>>> Regards,
>>> Andreas
>>> 
>>> ______________________________________________
>>> R-help at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>> 
> 
> 
> -- 
> Computational Biology / Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N.
> PO Box 19024 Seattle, WA 98109
> 
> Location: Arnold Building M1 B861
> Phone: (206) 667-2793
> <ddr.Rda.tar>______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hb at biostat.ucsf.edu  Thu Aug 30 22:47:26 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 30 Aug 2012 13:47:26 -0700
Subject: [Rd] non portable filenames
In-Reply-To: <CAC2h7uvNR1KPk_-0WzwDd2fAfPJu-rFcam9z=PbZoDseAoSvrg@mail.gmail.com>
References: <CAC2h7uvNR1KPk_-0WzwDd2fAfPJu-rFcam9z=PbZoDseAoSvrg@mail.gmail.com>
Message-ID: <CAFDcVCTHQRP4pJLgJkRteoB86rHQqE3xjZKzG3F35HNw2Sw0cQ@mail.gmail.com>

I think Kasper got a valid point and I'd second the idea of make R
accept tildes in filenames throughout.  AFAIK, this is also compatible
with most file systems, cf. http://en.wikipedia.org/wiki/Filename

However, there will be some potentially ambiguous cases.  For
instance, what if you have a directory named "~" in the current
directory.  If you then refer to "~" from within the current
directory, should that have high priority than the current user's home
directory?  I don't think so, because otherwise it would not be
possible to address that home directory.  This is also how R does it
now as the following example illustrates:

# Create a local "~" directory
> dir.create("./~")

# Write a file to that directory
> cat(file="./~/foo.txt", "Hello world!\n");

# Read it
> readLines("./~/foo.txt")
[1] "Hello world!"

# Try to read it without the explicit "./" path.
> readLines("~/foo.txt")
Error in file(con, "r") : cannot open the connection

The latter will try to read foo.txt in the user's home directory.

/Henrik

On Mon, Aug 27, 2012 at 6:58 AM, Kasper Daniel Hansen
<kasperdanielhansen at gmail.com> wrote:
> I am including an external piece of software in an R package.  This
> software ships with its own configure script generated by
> autoconf/automake, and this script is being run as part of the package
> configure script.
>
> The package contains a file
>   m4/lt~obsolete.m4
> which - as far as I can see - is a standard file from the
> autoconf/automake/m4 suite of programs.  A warning is generated with R
> CMD check about this filename being non-portable.  Presumably because
> of the "~" in the file name.  The users is referred to the 'Package
> structure' part of R-exts.
>
> Reading the manual, I do not see "~" listed in the beginning of the
> paragraph where non-allowed characters are described.  Quoting:
>
> "To ensure that file names are valid across file systems and supported
> operating system platforms, the ASCII control characters as well as
> the characters ?"?, ?*?, ?:?, ?/?, ?<?, ?>?, ???, ?\?, and ?|? are not
> allowed in file names. In addition, files with names ?con?, ?prn?,
> ?aux?, ?clock$?, ?nul?, ?com1? to ?com9?, and ?lpt1? to ?lpt9? after
> conversion to lower case and stripping possible ?extensions? (e.g.,
> ?lpt5.foo.bar?), are disallowed. Also, file names in the same
> directory must not differ only by case (see the previous paragraph).
> In addition, the basenames of ?.Rd? files may be used in URLs and so
> must be ASCII and not contain %."
>
> However, "~" is also not part of the next sentence where allowed
> characters are listed.  Quoting
>
> "For maximal portability filenames should only contain only ASCII
> characters not excluded already (that is A-Za-z0-9._!#$%&+,;=@^(){}'[]
> ? we exclude space as many utilities do not accept spaces in file
> paths): non-English alphabetic characters cannot be guaranteed to be
> supported in all locales. It would be good practice to avoid the shell
> metacharacters (){}'[]$."
>
> To me it looks a bit like this paragraph is not self-consistent, since
> "~" is not listed as one of the characters already excluded.
>
> Now, I don't really know if "~" is portable.  But I assume that the
> autoconf/automake/m4 people has thought a bit about this.  And I don't
> really want to rename the file in question, as it is part of a lengthy
> configure script.  So I guess my question is, is R CMD check correct
> in flagging the file?  And what is recommended?  I am tempted to
> ignore this warning, but I know warnings sometimes become errors.
>
> I assume other people might be in the same situation, since the
> filename originates from autoconf/automake/m4.
>
> Kasper
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From lxh37 at psu.edu  Thu Aug 30 17:59:29 2012
From: lxh37 at psu.edu (LIYING HUANG)
Date: Thu, 30 Aug 2012 11:59:29 -0400 (EDT)
Subject: [Rd] include dll in R-package
In-Reply-To: <DDCB3450-4867-4E68-8CEA-DDCAC1D311D4@xs4all.nl>
Message-ID: <682746281.6021774.1346342369345.JavaMail.root@psu.edu>



One very simple question, probably not appropriate to post this to rdevel list,
I put all Fortran files in src, when I do R CMD check, it tries to compile
the files by alphabetical order. I tried to modify Makevar, but no luck 
after staring at the manual for hours. It seems that I could use R CMD SHLIB 
as following to compile the codes first to get around this problem before 
doing "R CMD check", but I am curious how to specify the file compilation order 
in Makevar? Thanks!

R CMD SHLIB -o lcca.dll error_handler.f90 constants.f90

Liy

----- Original Message -----
From: "Berend Hasselman" <bhh at xs4all.nl>
To: "LIYING HUANG" <lxh37 at psu.edu>
Cc: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>, r-devel at r-project.org
Sent: Tuesday, August 28, 2012 7:02:02 AM
Subject: Re: [Rd] include dll in R-package


On 28-08-2012, at 01:29, LIYING HUANG wrote:

> 
> I am quite new in R, I looked at R manual- how to build R Package, 
> still not very clear. Yes, it would be very helpful if I could 
> download a package having Fortran source codes to look at, Do 
> you know any package built with Fortran source code? Thanks!
> 

To mention a few:

deSolve
minpack.lm
nleqslv
rootSolve
xts

and probably many more.

Berend


From ripley at stats.ox.ac.uk  Fri Aug 31 14:33:16 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 31 Aug 2012 13:33:16 +0100
Subject: [Rd] include dll in R-package
In-Reply-To: <682746281.6021774.1346342369345.JavaMail.root@psu.edu>
References: <682746281.6021774.1346342369345.JavaMail.root@psu.edu>
Message-ID: <5040AF0C.8010606@stats.ox.ac.uk>

On 30/08/2012 16:59, LIYING HUANG wrote:
>
>
> One very simple question, probably not appropriate to post this to rdevel list,
> I put all Fortran files in src, when I do R CMD check, it tries to compile
> the files by alphabetical order. I tried to modify Makevar, but no luck
> after staring at the manual for hours. It seems that I could use R CMD SHLIB
> as following to compile the codes first to get around this problem before
> doing "R CMD check", but I am curious how to specify the file compilation order
> in Makevar? Thanks!


Well, it is in the manual you stared at ....  However, for Fortran the 
order of compilation never matters.   If you have Fortran90 modules, it 
may and that is why Makefiles can have dependencies.

1) You can set OBJECTS to set the order.

2) To avoid problems with parallel makes you should set dependencies, e.g.

constants.o: error_handler.o

or more likely some module file.

Beyond that, R-devel is indeed not the place for a tutorial on Makefiles 
and compilation.

>
> R CMD SHLIB -o lcca.dll error_handler.f90 constants.f90
>
> Liy
>
> ----- Original Message -----
> From: "Berend Hasselman" <bhh at xs4all.nl>
> To: "LIYING HUANG" <lxh37 at psu.edu>
> Cc: "Kasper Daniel Hansen" <kasperdanielhansen at gmail.com>, r-devel at r-project.org
> Sent: Tuesday, August 28, 2012 7:02:02 AM
> Subject: Re: [Rd] include dll in R-package
>
>
> On 28-08-2012, at 01:29, LIYING HUANG wrote:
>
>>
>> I am quite new in R, I looked at R manual- how to build R Package,
>> still not very clear. Yes, it would be very helpful if I could
>> download a package having Fortran source codes to look at, Do
>> you know any package built with Fortran source code? Thanks!
>>
>
> To mention a few:
>
> deSolve
> minpack.lm
> nleqslv
> rootSolve
> xts
>
> and probably many more.
>
> Berend
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From damien.georges2 at gmail.com  Fri Aug 31 15:47:48 2012
From: damien.georges2 at gmail.com (Damien Georges)
Date: Fri, 31 Aug 2012 15:47:48 +0200
Subject: [Rd] Arrays Partial unserialization
Message-ID: <5040C084.1070305@gmail.com>

Hi all,

I'm working with some huge array in R and I need to load several ones to 
apply some functions that requires to have all my arrays values for each 
cell...

To make it possible, I would like to load only a part (for example 100 
cells) of all my arrays, apply my function, delete all cells loaded, 
loaded following cells and so on.

Is it possible to unserialize (or load) only a defined part of an R array ?
Do you know some tools that might help me?

Finally, I did lot of research to find the way array (and all other R 
object) are serialized into binary object, but I found nothing 
explaining really algorithms involved. If someone has some information 
on this topic, I'm interesting in.

Hoping my request is understandable,

All the best,

Damien.G


From murdoch.duncan at gmail.com  Fri Aug 31 16:41:22 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 31 Aug 2012 10:41:22 -0400
Subject: [Rd] Arrays Partial unserialization
In-Reply-To: <5040C084.1070305@gmail.com>
References: <5040C084.1070305@gmail.com>
Message-ID: <5040CD12.60205@gmail.com>

On 31/08/2012 9:47 AM, Damien Georges wrote:
> Hi all,
>
> I'm working with some huge array in R and I need to load several ones to
> apply some functions that requires to have all my arrays values for each
> cell...
>
> To make it possible, I would like to load only a part (for example 100
> cells) of all my arrays, apply my function, delete all cells loaded,
> loaded following cells and so on.
>
> Is it possible to unserialize (or load) only a defined part of an R array ?
> Do you know some tools that might help me?

I don't know of any tools to do that, but there are tools to maintain 
large objects in files, and load only parts of them at a time, e.g. the 
ff package.  Or you could simply use readBin and writeBin to do the same 
yourself.
>
> Finally, I did lot of research to find the way array (and all other R
> object) are serialized into binary object, but I found nothing
> explaining really algorithms involved. If someone has some information
> on this topic, I'm interesting in.

You can read the source for this; it is in src/main/serialize.c.

Duncan Murdoch
>
> Hoping my request is understandable,
>
> All the best,
>
> Damien.G
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From gmbecker at ucdavis.edu  Fri Aug 31 16:44:26 2012
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Fri, 31 Aug 2012 07:44:26 -0700
Subject: [Rd] Arrays Partial unserialization
In-Reply-To: <5040C084.1070305@gmail.com>
References: <5040C084.1070305@gmail.com>
Message-ID: <CADwqtCN-w_BGErdHPLwoU0sumH=ejXFCg0u8a8WCsJP21Cyhow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120831/67edbf39/attachment.pl>

From ripley at stats.ox.ac.uk  Fri Aug 31 16:51:51 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 31 Aug 2012 15:51:51 +0100
Subject: [Rd] Arrays Partial unserialization
In-Reply-To: <5040CD12.60205@gmail.com>
References: <5040C084.1070305@gmail.com> <5040CD12.60205@gmail.com>
Message-ID: <5040CF87.1020308@stats.ox.ac.uk>

On 31/08/2012 15:41, Duncan Murdoch wrote:
> On 31/08/2012 9:47 AM, Damien Georges wrote:
>> Hi all,
>>
>> I'm working with some huge array in R and I need to load several ones to
>> apply some functions that requires to have all my arrays values for each
>> cell...
>>
>> To make it possible, I would like to load only a part (for example 100
>> cells) of all my arrays, apply my function, delete all cells loaded,
>> loaded following cells and so on.
>>
>> Is it possible to unserialize (or load) only a defined part of an R
>> array ?
>> Do you know some tools that might help me?
>
> I don't know of any tools to do that, but there are tools to maintain
> large objects in files, and load only parts of them at a time, e.g. the
> ff package.  Or you could simply use readBin and writeBin to do the same
> yourself.

Serialization is essentially serial, so you can only read the serialized 
format from the beginning.  So too are the compression algorithms used 
by default.

>> Finally, I did lot of research to find the way array (and all other R
>> object) are serialized into binary object, but I found nothing
>> explaining really algorithms involved. If someone has some information
>> on this topic, I'm interesting in.
>
> You can read the source for this; it is in src/main/serialize.c.

And there is an extensive commentary in the 'R Internals' manual.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jeff.a.ryan at gmail.com  Fri Aug 31 17:01:57 2012
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 31 Aug 2012 10:01:57 -0500
Subject: [Rd] Arrays Partial unserialization
In-Reply-To: <5040CD12.60205@gmail.com>
References: <5040C084.1070305@gmail.com>
	<5040CD12.60205@gmail.com>
Message-ID: <CABDUZc8jvW2tKWu4SfkJBdL6j=oPuyW3tRQpVzJj0DQ--eC-tQ@mail.gmail.com>

There is no such tool to my knowledge, though the mmap package can do
very similar things.  In fact, it will be able to do this exactly once
I apply a contributed patch to handle endianess.

The issue is that rds files are compressed by default, so directly
reading requires uncompressing, which makes subset selection not
possible, at least to the best of my knowledge of the compression
algorithms in use. (BDR's reply after this one clarifies)

What you can do though is writeBin by column, and read in
incrementally.  Take a look at the mmap package, specifically:

example(mmap)
example(struct)
example(types)

The struct one is quite useful for data.frame like structures on disk,
including the ability to modify struct padding etc.  This one is more
row oriented, so lets you store various types in row-oriented fashion
in one file.

?mmap.csv is an example function that will also let you read csv files
directly into an 'mmap' form - and shows the 'struct' functionality.

At some point I will write an article on all of this, but the vignette
for mmap is illustrative of most of the value.

The indexing package on R-forge (as well as talks about it given by me
at useR 2010 and R/Finance 2012) may also be of use - though that is
more 'database' rather than a more simplistic sequential stepping
through data on disk.

HTH
Jeff

On Fri, Aug 31, 2012 at 9:41 AM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 31/08/2012 9:47 AM, Damien Georges wrote:
>>
>> Hi all,
>>
>> I'm working with some huge array in R and I need to load several ones to
>> apply some functions that requires to have all my arrays values for each
>> cell...
>>
>> To make it possible, I would like to load only a part (for example 100
>> cells) of all my arrays, apply my function, delete all cells loaded,
>> loaded following cells and so on.
>>
>> Is it possible to unserialize (or load) only a defined part of an R array
>> ?
>> Do you know some tools that might help me?
>
>
> I don't know of any tools to do that, but there are tools to maintain large
> objects in files, and load only parts of them at a time, e.g. the ff
> package.  Or you could simply use readBin and writeBin to do the same
> yourself.
>
>>
>> Finally, I did lot of research to find the way array (and all other R
>> object) are serialized into binary object, but I found nothing
>> explaining really algorithms involved. If someone has some information
>> on this topic, I'm interesting in.
>
>
> You can read the source for this; it is in src/main/serialize.c.
>
> Duncan Murdoch
>
>>
>> Hoping my request is understandable,
>>
>> All the best,
>>
>> Damien.G
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From gunter.berton at gene.com  Fri Aug 31 16:14:25 2012
From: gunter.berton at gene.com (Bert Gunter)
Date: Fri, 31 Aug 2012 07:14:25 -0700
Subject: [Rd] Arrays Partial unserialization
In-Reply-To: <5040C084.1070305@gmail.com>
References: <5040C084.1070305@gmail.com>
Message-ID: <CACk-te1sYSSOP5dEpWhtEesv0c2a52n_bXxcwK9GWwXfdRAMXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120831/30f27c70/attachment.pl>

