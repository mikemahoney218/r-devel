From b.rowlingson at lancaster.ac.uk  Mon Nov  1 20:20:04 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 1 Nov 2010 19:20:04 +0000
Subject: [Rd] stats, pics etc on CRAN
Message-ID: <AANLkTimnP5TBGo_Jskscd0NEs1q+QNJoA1W8bxstA1J3@mail.gmail.com>

Does anyone have some nice ways of showing what's on CRAN? A
time-series of the number of packages? A clustered graph of packages
by keyword?

I'm just after a more impressive way of saying "there's 2600 packages
on CRAN" than saying that.

Counts of lines of R and C/Fortran code would be interesting... The
CRANtastic tag cloud is quite handy... Anything else?

Barry


From ggrothendieck at gmail.com  Mon Nov  1 20:33:31 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 1 Nov 2010 15:33:31 -0400
Subject: [Rd] stats, pics etc on CRAN
In-Reply-To: <AANLkTimnP5TBGo_Jskscd0NEs1q+QNJoA1W8bxstA1J3@mail.gmail.com>
References: <AANLkTimnP5TBGo_Jskscd0NEs1q+QNJoA1W8bxstA1J3@mail.gmail.com>
Message-ID: <AANLkTi=z9H00AP-o4uXtOgf22abaQZtS68mpS=AvZrSe@mail.gmail.com>

On Mon, Nov 1, 2010 at 3:20 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> Does anyone have some nice ways of showing what's on CRAN? A
> time-series of the number of packages? A clustered graph of packages
> by keyword?
>
> I'm just after a more impressive way of saying "there's 2600 packages
> on CRAN" than saying that.
>
> Counts of lines of R and C/Fortran code would be interesting... The
> CRANtastic tag cloud is quite handy... Anything else?
>

There was an article with a graph here:

http://journal.r-project.org/archive/2009-2/RJournal_2009-2_Fox.pdf

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From atp at piskorski.com  Mon Nov  1 23:07:04 2010
From: atp at piskorski.com (Andrew Piskorski)
Date: Mon, 1 Nov 2010 18:07:04 -0400
Subject: [Rd] BLAS benchmarks on R 2.12.0
In-Reply-To: <AANLkTi=Er4FQYh-JO4eSA3PFefWdT6fuHr2S1ocwEe7t@mail.gmail.com>
References: <AANLkTi=Er4FQYh-JO4eSA3PFefWdT6fuHr2S1ocwEe7t@mail.gmail.com>
Message-ID: <20101101220704.GA96310@piskorski.com>

On Sun, Oct 31, 2010 at 12:41:24PM -0400, Michael Spiegel wrote:

> 1) Compile the reference BLAS implementation with unsafe optimizations
> and include it as a part of the OpenMx library.

If BLAS speed is important to you, why are you even trying to use the
slow reference BLAS library at all, rather than one of the faster
optimized BLAS libraries (Atlas, Goto, AMD, Intel, etc.)?

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/


From michael.m.spiegel at gmail.com  Tue Nov  2 00:43:19 2010
From: michael.m.spiegel at gmail.com (Michael Spiegel)
Date: Mon, 1 Nov 2010 19:43:19 -0400
Subject: [Rd] BLAS benchmarks on R 2.12.0
In-Reply-To: <20101101220704.GA96310@piskorski.com>
References: <AANLkTi=Er4FQYh-JO4eSA3PFefWdT6fuHr2S1ocwEe7t@mail.gmail.com>
	<20101101220704.GA96310@piskorski.com>
Message-ID: <AANLkTikpQtBKhfL14V4BmOK2WVwnqDK8F=A9oFHi1Nmj@mail.gmail.com>

Hi Andrew,

In the majority of use cases of our package, we end up doing lots and
lots of matrix operations on small matrices, as opposed to matrix
operations on large matrices.  The optimized BLAS libraries are
usually optimized for large matrices.  The reference implementation is
faster than either veclib, Atlas, or the Goto BLAS implementations,
I've tested all of them on our performance test suite.

--Michael

On Mon, Nov 1, 2010 at 6:07 PM, Andrew Piskorski <atp at piskorski.com> wrote:
> On Sun, Oct 31, 2010 at 12:41:24PM -0400, Michael Spiegel wrote:
>
>> 1) Compile the reference BLAS implementation with unsafe optimizations
>> and include it as a part of the OpenMx library.
>
> If BLAS speed is important to you, why are you even trying to use the
> slow reference BLAS library at all, rather than one of the faster
> optimized BLAS libraries (Atlas, Goto, AMD, Intel, etc.)?
>
> --
> Andrew Piskorski <atp at piskorski.com>
> http://www.piskorski.com/
>


From ronggui.huang at gmail.com  Tue Nov  2 03:16:36 2010
From: ronggui.huang at gmail.com (Wincent)
Date: Tue, 2 Nov 2010 10:16:36 +0800
Subject: [Rd] can not built a package
Message-ID: <AANLkTinL_H0cRARcw9nx4mq-f=7aesNyrCSBCkoECzHR@mail.gmail.com>

Dear all, I tried to build a package from source, and ran into a problem.

>R CMD build RQDA

* checking for file 'RQDA/DESCRIPTION' ... OK
* preparing 'RQDA':
* checking DESCRIPTION meta-information ... OK
 ERROR
copying to build directory failed

I searched and found this
http://r.789695.n4.nabble.com/tar-problem-when-using-R-CMD-build-on-Windows-td2734636.html
> SET TAR=tar --no-same-owner
>R CMD build RQDA

the same error.

The R sessionInfo is:
> sessionInfo()
R version 2.12.0 Patched (2010-10-28 r53459)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=Chinese (Simplified)_People's Republic of China.936
[2] LC_CTYPE=Chinese (Simplified)_People's Republic of China.936
[3] LC_MONETARY=Chinese (Simplified)_People's Republic of China.936
[4] LC_NUMERIC=C
[5] LC_TIME=Chinese (Simplified)_People's Republic of China.936

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


-- 
Wincent Ronggui HUANG (Ph.D.)
City University of Hong Kong
http://asrr.r-forge.r-project.org/rghuang.html


From remkoduursma at gmail.com  Tue Nov  2 05:27:30 2010
From: remkoduursma at gmail.com (Remko Duursma)
Date: Mon, 1 Nov 2010 21:27:30 -0700 (PDT)
Subject: [Rd] can not built a package
In-Reply-To: <AANLkTinL_H0cRARcw9nx4mq-f=7aesNyrCSBCkoECzHR@mail.gmail.com>
References: <AANLkTinL_H0cRARcw9nx4mq-f=7aesNyrCSBCkoECzHR@mail.gmail.com>
Message-ID: <1288672050977-3023170.post@n4.nabble.com>



This probably means you do not have Rtools installed, see here : 

http://www.murdoch-sutherland.com/Rtools/installer.html



greetings,
Remko
-- 
View this message in context: http://r.789695.n4.nabble.com/can-not-built-a-package-tp3023089p3023170.html
Sent from the R devel mailing list archive at Nabble.com.


From ronggui.huang at gmail.com  Tue Nov  2 14:51:06 2010
From: ronggui.huang at gmail.com (Wincent)
Date: Tue, 2 Nov 2010 21:51:06 +0800
Subject: [Rd] can not built a package
In-Reply-To: <1288672050977-3023170.post@n4.nabble.com>
References: <AANLkTinL_H0cRARcw9nx4mq-f=7aesNyrCSBCkoECzHR@mail.gmail.com>
	<1288672050977-3023170.post@n4.nabble.com>
Message-ID: <AANLkTik2gWs6TXQG-LnnfxKfFq+dQmha4c=Ezpk=GdmO@mail.gmail.com>

Actually, I did install Rtools212.

On 2 November 2010 12:27, Remko Duursma <remkoduursma at gmail.com> wrote:
>
>
> This probably means you do not have Rtools installed, see here :
>
> http://www.murdoch-sutherland.com/Rtools/installer.html
>
>
>
> greetings,
> Remko
> --
> View this message in context: http://r.789695.n4.nabble.com/can-not-built-a-package-tp3023089p3023170.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Wincent Ronggui HUANG (Ph.D.)
City University of Hong Kong
http://asrr.r-forge.r-project.org/rghuang.html


From dutangc at gmail.com  Tue Nov  2 16:28:11 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Tue, 2 Nov 2010 16:28:11 +0100
Subject: [Rd] on the usage of do.call
Message-ID: <AANLkTimou+OZmce9ERSQcTtitfhMO8DY=Qj6ahrkzLD6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101102/5154c6a6/attachment.pl>

From tcallawa at redhat.com  Tue Nov  2 17:53:32 2010
From: tcallawa at redhat.com (Tom "spot" Callaway)
Date: Tue, 02 Nov 2010 12:53:32 -0400
Subject: [Rd] make error for R 2.13.0 (and 2.12.0)
In-Reply-To: <4CBBF15E.6040104@gmail.com>
References: <20101018003908.GA990@cs.toronto.edu> <4CBBF15E.6040104@gmail.com>
Message-ID: <4CD0420C.40604@redhat.com>

On 10/18/2010 03:03 AM, Peter Dalgaard wrote:
> On 10/18/2010 02:39 AM, Radford Neal wrote:
>> Regarding Tengfei Yin's post about an error trying to install
>> "cluster" in 2.13.0, I have gotten an error with this package when
>> trying to install the released version of 2.12.0.  Here is the output
>> on an Ubuntu Linux system:
> 
> Hmm, g77 along with a recent gcc? It is usually gfortran on current
> linux systems. It's strange that it got past the configure step though.
> What did the configure output look like? A look at "nm cluster.so" could
> also be informative.

RHEL 4 throws the same error (RHEL 5, RHEL 6, and all current Fedora
targets (F12-F15) are fine):

* installing *source* package 'cluster' ...
** libs
make[3]: Entering directory `/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/src'
gcc -m64 -std=gnu99 -I/builddir/build/BUILD/R-2.12.0/include
-I/usr/local/include    -fpic  -O2 -g -pipe -m64 -c clara.c -o clara.o
g77 -m64   -fpic  -O2 -g -pipe -m64 -c daisy.f -o daisy.o
g77 -m64   -fpic  -O2 -g -pipe -m64 -c dysta.f -o dysta.o
gcc -m64 -std=gnu99 -I/builddir/build/BUILD/R-2.12.0/include
-I/usr/local/include    -fpic  -O2 -g -pipe -m64 -c fanny.c -o fanny.o
gcc -m64 -std=gnu99 -I/builddir/build/BUILD/R-2.12.0/include
-I/usr/local/include    -fpic  -O2 -g -pipe -m64 -c init.c -o init.o
g77 -m64   -fpic  -O2 -g -pipe -m64 -c meet.f -o meet.o
g77 -m64   -fpic  -O2 -g -pipe -m64 -c mona.f -o mona.o
gcc -m64 -std=gnu99 -I/builddir/build/BUILD/R-2.12.0/include
-I/usr/local/include    -fpic  -O2 -g -pipe -m64 -c pam.c -o pam.o
gcc -m64 -std=gnu99 -I/builddir/build/BUILD/R-2.12.0/include
-I/usr/local/include    -fpic  -O2 -g -pipe -m64 -c sildist.c -o sildist.o
gcc -m64 -std=gnu99 -I/builddir/build/BUILD/R-2.12.0/include
-I/usr/local/include    -fpic  -O2 -g -pipe -m64 -c spannel.c -o spannel.o
g77 -m64   -fpic  -O2 -g -pipe -m64 -c twins.f -o twins.o
gcc -m64 -std=gnu99 -shared -L/usr/local/lib64 -o cluster.so clara.o
daisy.o dysta.o fanny.o init.o meet.o mona.o pam.o sildist.o spannel.o
twins.o -lg2c -lm -L/builddir/build/BUILD/R-2.12.0/lib -lR
make[3]: Leaving directory `/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/src'
installing to /builddir/build/BUILD/R-2.12.0/library/cluster/libs
** R
** data
**  moving datasets to lazyload DB
** inst
** preparing package for lazy loading
** help
*** installing help indices
  converting help for package 'cluster'
    finding HTML links ... done
    agnes                                   html
    agnes.object                            html
    agriculture                             html
    animals                                 html
    bannerplot                              html
    chorSub                                 html
    clara                                   html
    clara.object                            html
    clusplot                                html
    clusplot.default                        html
Rd warning:
/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/man/clusplot.default.Rd:198:
missing file link 'cov.mve'
    clusplot.partition                      html
    cluster-internal                        html
    coef.hclust                             html
    daisy                                   html
    diana                                   html
    dissimilarity.object                    html
    ellipsoidhull                           html
Rd warning:
/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/man/ellipsoidhull.Rd:36:
missing file link 'cov.mve'
Rd warning:
/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/man/ellipsoidhull.Rd:86:
missing file link 'cov.mve'
    fanny                                   html
    fanny.object                            html
    flower                                  html
    lower.to.upper.tri.inds                 html
    mona                                    html
    mona.object                             html
    pam                                     html
    pam.object                              html
    partition.object                        html
    plantTraits                             html
    plot.agnes                              html
Rd warning:
/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/man/plot.agnes.Rd:73: missing
file link 'plot.dendrogram'
    plot.diana                              html
    plot.mona                               html
    plot.partition                          html
    pltree                                  html
    pltree.twins                            html
    pluton                                  html
    predict.ellipsoid                       html
    print.agnes                             html
    print.clara                             html
    print.diana                             html
    print.dissimilarity                     html
Rd warning:
/tmp/RtmpbbtMdO/R.INSTALL5ad6c5f4/cluster/man/print.dissimilarity.Rd:27:
missing file link 'print.dist'
    print.fanny                             html
    print.mona                              html
    print.pam                               html
    ruspini                                 html
    silhouette                              html
    sizeDiss                                html
    summary.agnes                           html
    summary.clara                           html
    summary.diana                           html
    summary.mona                            html
    summary.pam                             html
    twins.object                            html
    volume.ellipsoid                        html
    votes.repub                             html
    xclara                                  html
** building package indices ...
** testing if installed package can be loaded
Error in dyn.load(file, DLLpath = DLLpath, ...) :
  unable to load shared object
'/builddir/build/BUILD/R-2.12.0/library/cluster/libs/cluster.so':
  /builddir/build/BUILD/R-2.12.0/library/cluster/libs/cluster.so:
undefined symbol: cl_daisy_
ERROR: loading failed
* removing '/builddir/build/BUILD/R-2.12.0/library/cluster'
make[2]: Leaving directory
`/builddir/build/BUILD/R-2.12.0/src/library/Recommended'
make[1]: Leaving directory
`/builddir/build/BUILD/R-2.12.0/src/library/Recommended'

******
Full build log is here:
http://koji.fedoraproject.org/koji/getfile?taskID=2571563&name=build.log

Default gcc in RHEL 4 is 3.4.6-10, which has g77 rather than gfortran.
It looks like this code no longer compiles properly with g77.

Thankfully, RHEL 4 also includes a copy of gcc 4.1, so I should be able
to work around this by using that instead.

~spot


From nashjc at uottawa.ca  Tue Nov  2 19:33:17 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Tue, 02 Nov 2010 14:33:17 -0400
Subject: [Rd] BLAS benchmarks on R 2.12.0 and related performance issues
In-Reply-To: <mailman.27.1288695608.14163.r-devel@r-project.org>
References: <mailman.27.1288695608.14163.r-devel@r-project.org>
Message-ID: <4CD0596D.2050006@uottawa.ca>

This thread pointed out that the "plain vanilla" library for linear algebra outperformed
the fancy ones for the original poster -- and he had mentioned this, but still got "you
ought to ...." advice that was inappropriate and ignored his stated experience.

I've been surprised sometimes myself with performance results, and I'm now getting wary of
making pronouncements.

I always thought statistics was about using data sensibly to uncover truths. This is a
case where we can actually get the data pretty easily. Perhaps the R posting guide needs
an addition to say "When discussing performance, you really should present some data and
not just speculation."

Ultimately we need good performance benchmarks. They are difficult to set up properly and
tedious to run. Maybe a good subject for a Google Summer of Code project for next year or
some undergraduate projects.

JN


From shotwelm at musc.edu  Tue Nov  2 20:08:47 2010
From: shotwelm at musc.edu (Matt Shotwell)
Date: Tue, 02 Nov 2010 15:08:47 -0400
Subject: [Rd] on the usage of do.call
In-Reply-To: <AANLkTimou+OZmce9ERSQcTtitfhMO8DY=Qj6ahrkzLD6@mail.gmail.com>
References: <AANLkTimou+OZmce9ERSQcTtitfhMO8DY=Qj6ahrkzLD6@mail.gmail.com>
Message-ID: <1288724927.1631.183.camel@matt-laptop>

On Tue, 2010-11-02 at 11:28 -0400, Christophe Dutang wrote:
> Hello all,
> 
> I don't know if it is possible, but I would like to use do.call in C code in
> my package. The function do.call is defined as
> > do.call
> function (what, args, quote = FALSE, envir = parent.frame())
> {
>     if (!is.list(args))
>         stop("second argument must be a list")
>     if (quote) {
>         enquote <- function(x) as.call(list(as.name("quote"),
>             x))
>         args <- lapply(args, enquote)
>     }
>     .Internal(do.call(what, args, envir))
> }
> <environment: namespace:base>
> >
> 
> In <src>/main/names.c, the function do.call is linked to the C function
> do_docall (line 499). (.Internal calls the good function line 1194.)
> 
> And the do_docall function is defined in <src>/main/coerce.c line 2217 and
> declared as
>   SEXP attribute_hidden do_docall(SEXP call, SEXP op, SEXP args, SEXP rho)
> in Internal.h.

The 'attribute_hidden' declaration indicates do_docall was not intended
for use by package developers. That's also why it's not part of the
installed headers. See 'Writing R Extensions', the section titled
'Controlling Visibility'.

> The problem is that I do not guess the exact meaning of theses arguments,
> and the header file Internal.h is not found when included in my C file.

I'm not sure there are any biolerplate descriptions of this common
prototype. The are some hints in "R Internals" chapter 2 and the source
file /src/main/names.c.

> As this header is not listed in R-exts.pdf section 6.17, I think I cannot
> use the do_docall function.
> 
> Does anyone face this problem? or have an idea on how to solve it?

Some ideas, in good-to-bad order:

1. look for a solution not involving do.call
2. modularize your C code, such that do.call may be used at R level
3. use call() at R level, pass result + envir to C code for later eval()
4. emulate do_docall in custom C code

> Thanks in advance
> 
> 
> Christophe
> 
> 
> 

-- 
Matthew S. Shotwell
Graduate Student 
Division of Biostatistics and Epidemiology
Medical University of South Carolina


From murdoch.duncan at gmail.com  Tue Nov  2 20:18:13 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 02 Nov 2010 15:18:13 -0400
Subject: [Rd] on the usage of do.call
In-Reply-To: <AANLkTimou+OZmce9ERSQcTtitfhMO8DY=Qj6ahrkzLD6@mail.gmail.com>
References: <AANLkTimou+OZmce9ERSQcTtitfhMO8DY=Qj6ahrkzLD6@mail.gmail.com>
Message-ID: <4CD063F5.4040207@gmail.com>

On 02/11/2010 11:28 AM, Christophe Dutang wrote:
> Hello all,
>
> I don't know if it is possible, but I would like to use do.call in C code in
> my package. The function do.call is defined as
> >  do.call
> function (what, args, quote = FALSE, envir = parent.frame())
> {
>      if (!is.list(args))
>          stop("second argument must be a list")
>      if (quote) {
>          enquote<- function(x) as.call(list(as.name("quote"),
>              x))
>          args<- lapply(args, enquote)
>      }
>      .Internal(do.call(what, args, envir))
> }
> <environment: namespace:base>
> >
>
> In<src>/main/names.c, the function do.call is linked to the C function
> do_docall (line 499). (.Internal calls the good function line 1194.)
>
> And the do_docall function is defined in<src>/main/coerce.c line 2217 and
> declared as
>    SEXP attribute_hidden do_docall(SEXP call, SEXP op, SEXP args, SEXP rho)
> in Internal.h.
>
> The problem is that I do not guess the exact meaning of theses arguments,
> and the header file Internal.h is not found when included in my C file.
>
> As this header is not listed in R-exts.pdf section 6.17, I think I cannot
> use the do_docall function.
>
> Does anyone face this problem? or have an idea on how to solve it?

You would rarely want to use do.call from C.  You should use eval().  
See the examples in the Writing R Extensions manual, in the section 
"Evaluating R expressions from C".

Duncan Murdoch


From stefanML at collocations.de  Tue Nov  2 22:11:55 2010
From: stefanML at collocations.de (Stefan Evert)
Date: Tue, 2 Nov 2010 22:11:55 +0100
Subject: [Rd] BLAS benchmarks on R 2.12.0 and related performance issues
In-Reply-To: <4CD0596D.2050006@uottawa.ca>
References: <mailman.27.1288695608.14163.r-devel@r-project.org>
	<4CD0596D.2050006@uottawa.ca>
Message-ID: <C34D1A15-39D1-41B1-9A2E-5131411B44B0@collocations.de>


On 2 Nov 2010, at 19:33, Prof. John C Nash wrote:

> Ultimately we need good performance benchmarks. They are difficult to set up properly and
> tedious to run. Maybe a good subject for a Google Summer of Code project for next year or
> some undergraduate projects.

Seconded and thirded!

Stefan


From hb at biostat.ucsf.edu  Tue Nov  2 23:53:20 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Tue, 2 Nov 2010 15:53:20 -0700
Subject: [Rd] inst/ and hidden files/directories, especially inst/.svn/?
Message-ID: <AANLkTi=Dc82yWMvXi=pYDqrsW0=Amk=vd2Rt9KFRuSpk@mail.gmail.com>

In Section 'Package subdirectories' of 'Writing R Extensions',  it
says about the inst/ directory that:

"The contents of the inst subdirectory will be copied recursively to
the installation directory (except perhaps hidden files with names
starting with ?.?)."

Indeed, on Windows with R v2.12.0 patched (2010-11-01 r53513) and R
v2.13.0 devel (2010-11-01 r53513), if you have:

foo/inst/bar/.bar/foo.txt

that subdirectory .bar/ will be included in the *.tar.gz and *.zip
builds.  However, .svn/ is as in:

foo/inst/bar/.svn/foo.txt

is only included in the *.zip file, not the *.tar.gz file.

Is this expected?  The "perhaps" in the documentation indicates that.

/Henrik


From dutangc at gmail.com  Wed Nov  3 09:44:44 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Wed, 3 Nov 2010 09:44:44 +0100
Subject: [Rd] on the usage of do.call
In-Reply-To: <4CD063F5.4040207@gmail.com>
References: <AANLkTimou+OZmce9ERSQcTtitfhMO8DY=Qj6ahrkzLD6@mail.gmail.com>
	<4CD063F5.4040207@gmail.com>
Message-ID: <AANLkTi=pxxed0ELaHPms9ea5tX7QQKm0aRJ4DdJ=5oKZ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101103/e83804f4/attachment.pl>

From simon.urbanek at r-project.org  Wed Nov  3 11:31:42 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 3 Nov 2010 11:31:42 +0100
Subject: [Rd] [R-SIG-Mac] BLAS benchmarks on R 2.12.0
In-Reply-To: <AANLkTin8kMKzdXxJfv_Ov8OVOb_o3657zCnrVZFj+g4f@mail.gmail.com>
References: <AANLkTi=Er4FQYh-JO4eSA3PFefWdT6fuHr2S1ocwEe7t@mail.gmail.com>
	<AANLkTin8kMKzdXxJfv_Ov8OVOb_o3657zCnrVZFj+g4f@mail.gmail.com>
Message-ID: <1D6FA6F3-E146-4E1B-B68E-6AEF7D9AA063@r-project.org>


On Nov 3, 2010, at 12:07 AM, Michael Spiegel wrote:

> I would like to apologize for cross-posting this message.  But I
> realized that one of my questions may be more appropriate for the
> SIG-Mac mailing list rather than the R-devel mailing list.  You may
> wish to ignore the other parts of the email.  My question is the
> following:
> 
> "I can't seem to reproduce the speed of the 2.11.1 reference BLAS
> library.  What compiler, which version of the compiler, and what flags
> are used when an [OS X] R binary is distributed? My test machine is a
> Mac Pro, so 32-bit x86 architecture."
> 

The current build flags for i386 are listed in
https://svn.r-project.org/R-dev-web/trunk/QA/Simon/R-build/conf.leopard-i386

They did not change recently so they were the same for 2.11.1. The compiler used is gcc-4.2 from Xcode 3.1.4 (R is built on OS X 10.5.8) with the corresponding Fortran form the tools page.

More below.


> 
> ---------- Forwarded message ----------
> From: Michael Spiegel <michael.m.spiegel at gmail.com>
> Date: Sun, Oct 31, 2010 at 12:41 PM
> Subject: BLAS benchmarks on R 2.12.0
> To: r-devel at stat.math.ethz.ch
> Cc: OpenMx Developers <openmx-developers at list.mail.virginia.edu>
> 
> 
> Hi,
> 
> I saw on the mailing list and in the NEWS file that some unsafe math
> transformations were disabled for the reference BLAS implementation
> that is used in R.  We have a set of performance tests for the OpenMx
> library, and some of the tests have a x3-10 slowdown in R 2.12.0
> versus 2.11.1.  When I copy the shared library libRblas.0.dylib from
> the 2.11.1 installation into the 2.12.0 installation, the slowdown
> goes away.  It seems reasonable that BLAS should conform to IEEE
> requirements.  For the purposes of our library, we are considering two
> options but I need some advice on both choices:
> 
> 1) Compile the reference BLAS implementation with unsafe optimizations
> and include it as a part of the OpenMx library.  I can't seem to
> reproduce the speed of the 2.11.1 reference BLAS library.  What
> compiler, which version of the compiler, and what flags are used when
> an R binary is distributed? My test machine is a Mac Pro, that may
> change the answer.
> 
> 2) Is there any support for adding a libRblas.unsafe.dylib shared
> library in the R installation, much like libRblas.veclib.dylib is
> currently included in OS X binaries? Then we could just change the
> OpenMx shared library to use the unsafe library when we give it to
> users.  We currently change the OpenMx shared library to use the
> reference blas implementation, because it is faster than the veclib
> implementation for small matrices.
> 

Although it would be possible technically, it would mean to include Rblas built by a different version of R which doesn't sound right (the flags are set by configure so there is no easy way to reproduce it in the current R without manual intervention). However, I'm considering adding some alternatives (such as ATLAS for example) in the build and a tool to change the BLAS used - possibly as a separate package.

To get back to your problem - did you try the single threaded ATLAS for your problem? The optimizations are not necessarily just for large matrices - in fact ATLAS has several paths depending on the size of the problem. (I'm traveling at the moment so can't run any tests)

However, as John pointed out it is pretty much impossible to get a general solution because any benchmarks are very limited to a certain problem and size yet the mechanisms involved are far more complex (and as I was pointing out for the recently discussed speed patches - seeming clear optimization to increase speed can in reality be slower that the untouched code depending on compilers, flags and architecture).

Cheers,
Simon


From aysun.cetinyurek at ulg.ac.be  Wed Nov  3 13:20:28 2010
From: aysun.cetinyurek at ulg.ac.be (aysun.cetinyurek at ulg.ac.be)
Date: Wed, 3 Nov 2010 13:20:28 +0100 (CET)
Subject: [Rd] Calling C in R in Windows 64 bit
Message-ID: <2098458241.10945.1288786828198.JavaMail.root@serv223.segi.ulg.ac.be>

Dear developers,

I am trying to run some C/ Fortran code in R. Although I have experience with that in Windows (Vista) 32 bit, I could not succeed in 64 bit. I downloaded the following:
- R 2.12.0
- Rtools 212
- miktex 2.9
- inno setup 5

-Afterwards, I changed the path as:
?C:\Program Files\R\R-2.12.0\bin;C:\Rtools\bin;C:\Rtools\MinGW64\bin;C:\Program Files\HTML Help Workshop;C:\Program Files (x86)\CodeBlocks\bin;C:\Program Files\Insight\bin;C:\Rtools\perl\bin;C:\Program Files (x86)\MiKTeX 2.9\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\Broadcom\Broadcom 802.11\Driver;?

- started Command Prompt and checked the path by typing 'path'
- then I typed

'x86_64-w64-mingw32-gcc -c COXPHmatprod24delta.c -o COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include"'

the above command produced the file with .o extension. 

-Afterwards I typed 
'x86_64-w64-mingw32-gcc -shared -o COXPHmatprod24delta.dll COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include" -L"C:\Program Files\R\R-2.12.0\bin" ?lR'

it produces the error: 
'x86_64-w64-mingw32-gcc: -lR: No such file or directory'

-The problem here is that it does not produce .dll file. I cannot find the solution to that although I tried for 2 days.   



--Alternatively I tried ?R CMD SHLIB COXPHmatprod24delta.c? and it produces the error:
'cygwin warning:
  MS-DOS style path detected: C:/PROGRA~1/R/R-212~1.0/etc/i386/Makeconf
  Preferred POSIX equivalent is: /cygdrive/c/PROGRA~1/R/R-212~1.0/etc/i386/Makec
onf
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
nm: not found
gcc -shared -s -static-libgcc -o COXPHmatprod24delta.dll tmp.def COXPHmatprod24d
elta.o -LC:/PROGRA~1/R/R-212~1.0/bin/i386 -lR
gcc: not found'

Every comment is appreciated. Many thanks in advance.

Sincerely Yours,

Aysun Cetinyurek

Services de Statistique
Institut de Math?matique (B37)
Grande Traverse, 12
B4000 Li?ge
Belgique

 


From friendly at yorku.ca  Wed Nov  3 14:44:46 2010
From: friendly at yorku.ca (Michael Friendly)
Date: Wed, 03 Nov 2010 09:44:46 -0400
Subject: [Rd] R package BibTex entries: looking for a more general solution
Message-ID: <4CD1674E.6070807@yorku.ca>

== Summary ==
* Problem: BibTeX entries extracted from R packages via citation() 
require too much manual editing to be
of general use.
* Proposal: Date: fields should be made mandatory in package DESCRIPTION 
files, perhaps
beginning with warnings from R CMD check
* Proposal: Package authors should be encouraged to use a (new) 
Contributors: field in the DESCRIPTION file
rather than packing all information into the Author: field, which at 
present cannot often be parsed by BibTeX.
* Files: All test files referred to here can be found at

http://euclid.psych.yorku.ca/SCS/Private/Rbibs/

== Details ==
Around 16 Dec. 2009, I queried R-help about automating the extraction of 
citation()s from R packages. The stimulus
was that some journals, notably JSS, now require a reference and 
citation of every R package mentioned,
and it is a pain to create these manually, no less maintain them for 
current versions.

The result of that query was a function, Rpackage.bibs() by Achim 
Zeileis that I have been using ever since.
Code in: http://euclid.psych.yorku.ca/SCS/Private/Rbibs/Rpackages.bib.R
On one current system I get the following:

 > Rpackage.bibs(file="Rpackages-R.2.11.1.bib")
Converted 230 of 230 package citations to BibTex
Results written to file Rpackages-R.2.11.1.bib
Warning messages:
1: In citation(x) :
no date field in DESCRIPTION file of package 'codetools'
2: In citation(x) :
no date field in DESCRIPTION file of package 'gridBase'
3: In citation(x) : no date field in DESCRIPTION file of package 'iplots'
 >
See:
http://euclid.psych.yorku.ca/SCS/Private/Rbibs/Rpkg-test.pdf
for the result of processing this .bib file with latex/bibtex using the 
jss.bst bibliography style

I'm writing to R-Devel because the DESCRIPTION and inst/CITATION files 
in R packages provide the
basic data used in citation() and any methods based on this, and yet the 
information in these files is
often insufficient to generate well-formed BibTeX entries for use in 
vignettes and publications.

One easy case is illustrated above, where 3 packages have no Date: field 
so the BibTeX gets no
year = {},
and references get printed as Murrell, P (????) for gridBase. (In my 
original test under R 2.9.1, there where
~ 20 such warnings.) Thus, I propose that Date: be a required field in 
DESCRIPTION files, and
R CMD check complain if this is not found.

The more difficult case has to do with the Author: field in the 
DESCRIPTION file (when no CITATION file is present)
People can write whatever they want here, and the result looks sort of 
OK when printed by citation(), but confuses
BibTeX mightly. One example:

 > citation("akima")
To cite package ?akima? in publications use:

Fortran code by H. Akima R port by Albrecht Gebhardt aspline function
by Thomas Petzoldt <petzoldt at rcs.urz.tu-dresden.de> enhancements and
corrections by Martin Maechler (2009). akima: Interpolation of
irregularly spaced data. R package version 0.5-4.
http://CRAN.R-project.org/package=akima

A BibTeX entry for LaTeX users is

@Manual{,
title = {akima: Interpolation of irregularly spaced data},
author = {Fortran code by H. Akima R port by Albrecht Gebhardt aspline 
function by Thomas Petzoldt <petzoldt at rcs.urz.tu-dresden.de> 
enhancements and corrections by Martin Maechler},
year = {2009},
note = {R package version 0.5-4},
url = {http://CRAN.R-project.org/package=akima},
}

ATTENTION: This citation information has been auto-generated from the
package DESCRIPTION file and may need manual editing, see
?help("citation")? .
 >

Yes, the ATTENTION note does say that manual editing may be necessary, 
but I think a worthy goal would be
to try to reduce the need for this.

One simple way to do that would be to support an extra Contributions: 
field in the DESCRIPTION file,
so that Authors: can be more cleanly separated for the purpose of 
creating well-structured BibTeX.
Perhaps others have better ideas.

-Michael

-- 
Michael Friendly     Email: friendly AT yorku DOT ca
Professor, Psychology Dept.
York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
4700 Keele Street    Web:http://www.datavis.ca
Toronto, ONT  M3J 1P3 CANADA


From xie at yihui.name  Wed Nov  3 15:18:15 2010
From: xie at yihui.name (Yihui Xie)
Date: Wed, 3 Nov 2010 09:18:15 -0500
Subject: [Rd] R package BibTex entries: looking for a more general
	solution
In-Reply-To: <4CD1674E.6070807@yorku.ca>
References: <4CD1674E.6070807@yorku.ca>
Message-ID: <AANLkTi=BLhrrteP7H6aHvXp1w2mUjVMmndttKRTe11mB@mail.gmail.com>

I strongly support this proposal! I also find it inconvenient to cite
some R packages and really do not like edit the BibTeX entries
manually.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Wed, Nov 3, 2010 at 8:44 AM, Michael Friendly <friendly at yorku.ca> wrote:
> == Summary ==
> * Problem: BibTeX entries extracted from R packages via citation() require
> too much manual editing to be
> of general use.
> * Proposal: Date: fields should be made mandatory in package DESCRIPTION
> files, perhaps
> beginning with warnings from R CMD check
> * Proposal: Package authors should be encouraged to use a (new)
> Contributors: field in the DESCRIPTION file
> rather than packing all information into the Author: field, which at present
> cannot often be parsed by BibTeX.
> * Files: All test files referred to here can be found at
>
> http://euclid.psych.yorku.ca/SCS/Private/Rbibs/
>
> == Details ==
> Around 16 Dec. 2009, I queried R-help about automating the extraction of
> citation()s from R packages. The stimulus
> was that some journals, notably JSS, now require a reference and citation of
> every R package mentioned,
> and it is a pain to create these manually, no less maintain them for current
> versions.
>
> The result of that query was a function, Rpackage.bibs() by Achim Zeileis
> that I have been using ever since.
> Code in: http://euclid.psych.yorku.ca/SCS/Private/Rbibs/Rpackages.bib.R
> On one current system I get the following:
>
>> Rpackage.bibs(file="Rpackages-R.2.11.1.bib")
> Converted 230 of 230 package citations to BibTex
> Results written to file Rpackages-R.2.11.1.bib
> Warning messages:
> 1: In citation(x) :
> no date field in DESCRIPTION file of package 'codetools'
> 2: In citation(x) :
> no date field in DESCRIPTION file of package 'gridBase'
> 3: In citation(x) : no date field in DESCRIPTION file of package 'iplots'
>>
> See:
> http://euclid.psych.yorku.ca/SCS/Private/Rbibs/Rpkg-test.pdf
> for the result of processing this .bib file with latex/bibtex using the
> jss.bst bibliography style
>
> I'm writing to R-Devel because the DESCRIPTION and inst/CITATION files in R
> packages provide the
> basic data used in citation() and any methods based on this, and yet the
> information in these files is
> often insufficient to generate well-formed BibTeX entries for use in
> vignettes and publications.
>
> One easy case is illustrated above, where 3 packages have no Date: field so
> the BibTeX gets no
> year = {},
> and references get printed as Murrell, P (????) for gridBase. (In my
> original test under R 2.9.1, there where
> ~ 20 such warnings.) Thus, I propose that Date: be a required field in
> DESCRIPTION files, and
> R CMD check complain if this is not found.
>
> The more difficult case has to do with the Author: field in the DESCRIPTION
> file (when no CITATION file is present)
> People can write whatever they want here, and the result looks sort of OK
> when printed by citation(), but confuses
> BibTeX mightly. One example:
>
>> citation("akima")
> To cite package ?akima? in publications use:
>
> Fortran code by H. Akima R port by Albrecht Gebhardt aspline function
> by Thomas Petzoldt <petzoldt at rcs.urz.tu-dresden.de> enhancements and
> corrections by Martin Maechler (2009). akima: Interpolation of
> irregularly spaced data. R package version 0.5-4.
> http://CRAN.R-project.org/package=akima
>
> A BibTeX entry for LaTeX users is
>
> @Manual{,
> title = {akima: Interpolation of irregularly spaced data},
> author = {Fortran code by H. Akima R port by Albrecht Gebhardt aspline
> function by Thomas Petzoldt <petzoldt at rcs.urz.tu-dresden.de> enhancements
> and corrections by Martin Maechler},
> year = {2009},
> note = {R package version 0.5-4},
> url = {http://CRAN.R-project.org/package=akima},
> }
>
> ATTENTION: This citation information has been auto-generated from the
> package DESCRIPTION file and may need manual editing, see
> ?help("citation")? .
>>
>
> Yes, the ATTENTION note does say that manual editing may be necessary, but I
> think a worthy goal would be
> to try to reduce the need for this.
>
> One simple way to do that would be to support an extra Contributions: field
> in the DESCRIPTION file,
> so that Authors: can be more cleanly separated for the purpose of creating
> well-structured BibTeX.
> Perhaps others have better ideas.
>
> -Michael
>
> --
> Michael Friendly ? ? Email: friendly AT yorku DOT ca
> Professor, Psychology Dept.
> York University ? ? ?Voice: 416 736-5115 x66249 Fax: 416 736-5814
> 4700 Keele Street ? ?Web:http://www.datavis.ca
> Toronto, ONT ?M3J 1P3 CANADA
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hb at biostat.ucsf.edu  Wed Nov  3 17:43:42 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 3 Nov 2010 09:43:42 -0700
Subject: [Rd] Calling C in R in Windows 64 bit
In-Reply-To: <2098458241.10945.1288786828198.JavaMail.root@serv223.segi.ulg.ac.be>
References: <2098458241.10945.1288786828198.JavaMail.root@serv223.segi.ulg.ac.be>
Message-ID: <AANLkTi=08+L9Ecksz5ed0j6fjV8cePMYnHG7gWrTbap6@mail.gmail.com>

Is the dash in "?lR" really a dash?  Shouldn't it be "-lR" so it is
interpreted as a flag/option?!

My $.02

/H

On Wed, Nov 3, 2010 at 5:20 AM,  <aysun.cetinyurek at ulg.ac.be> wrote:
> Dear developers,
>
> I am trying to run some C/ Fortran code in R. Although I have experience with that in Windows (Vista) 32 bit, I could not succeed in 64 bit. I downloaded the following:
> - R 2.12.0
> - Rtools 212
> - miktex 2.9
> - inno setup 5
>
> -Afterwards, I changed the path as:
> ?C:\Program Files\R\R-2.12.0\bin;C:\Rtools\bin;C:\Rtools\MinGW64\bin;C:\Program Files\HTML Help Workshop;C:\Program Files (x86)\CodeBlocks\bin;C:\Program Files\Insight\bin;C:\Rtools\perl\bin;C:\Program Files (x86)\MiKTeX 2.9\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\Broadcom\Broadcom 802.11\Driver;?
>
> - started Command Prompt and checked the path by typing 'path'
> - then I typed
>
> 'x86_64-w64-mingw32-gcc -c COXPHmatprod24delta.c -o COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include"'
>
> the above command produced the file with .o extension.
>
> -Afterwards I typed
> 'x86_64-w64-mingw32-gcc -shared -o COXPHmatprod24delta.dll COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include" -L"C:\Program Files\R\R-2.12.0\bin" ?lR'
>
> it produces the error:
> 'x86_64-w64-mingw32-gcc: -lR: No such file or directory'
>
> -The problem here is that it does not produce .dll file. I cannot find the solution to that although I tried for 2 days.
>
>
>
> --Alternatively I tried ?R CMD SHLIB COXPHmatprod24delta.c? and it produces the error:
> 'cygwin warning:
> ?MS-DOS style path detected: C:/PROGRA~1/R/R-212~1.0/etc/i386/Makeconf
> ?Preferred POSIX equivalent is: /cygdrive/c/PROGRA~1/R/R-212~1.0/etc/i386/Makec
> onf
> ?CYGWIN environment variable option "nodosfilewarning" turns off this warning.
> ?Consult the user's guide for more details about POSIX paths:
> ? ?http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
> nm: not found
> gcc -shared -s -static-libgcc -o COXPHmatprod24delta.dll tmp.def COXPHmatprod24d
> elta.o -LC:/PROGRA~1/R/R-212~1.0/bin/i386 -lR
> gcc: not found'
>
> Every comment is appreciated. Many thanks in advance.
>
> Sincerely Yours,
>
> Aysun Cetinyurek
>
> Services de Statistique
> Institut de Math?matique (B37)
> Grande Traverse, 12
> B4000 Li?ge
> Belgique
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Wed Nov  3 17:50:48 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 03 Nov 2010 17:50:48 +0100
Subject: [Rd] inst/ and hidden files/directories, especially inst/.svn/?
In-Reply-To: <AANLkTi=Dc82yWMvXi=pYDqrsW0=Amk=vd2Rt9KFRuSpk@mail.gmail.com>
References: <AANLkTi=Dc82yWMvXi=pYDqrsW0=Amk=vd2Rt9KFRuSpk@mail.gmail.com>
Message-ID: <4CD192E8.2010700@statistik.tu-dortmund.de>

Yes, ".svn" is special cased.

Uwe Ligges


On 02.11.2010 23:53, Henrik Bengtsson wrote:
> In Section 'Package subdirectories' of 'Writing R Extensions',  it
> says about the inst/ directory that:
>
> "The contents of the inst subdirectory will be copied recursively to
> the installation directory (except perhaps hidden files with names
> starting with ?.?)."
>
> Indeed, on Windows with R v2.12.0 patched (2010-11-01 r53513) and R
> v2.13.0 devel (2010-11-01 r53513), if you have:
>
> foo/inst/bar/.bar/foo.txt
>
> that subdirectory .bar/ will be included in the *.tar.gz and *.zip
> builds.  However, .svn/ is as in:
>
> foo/inst/bar/.svn/foo.txt
>
> is only included in the *.zip file, not the *.tar.gz file.
>
> Is this expected?  The "perhaps" in the documentation indicates that.
>
> /Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hb at biostat.ucsf.edu  Wed Nov  3 18:54:18 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 3 Nov 2010 10:54:18 -0700
Subject: [Rd] Using sample() to sample one value from a single value?
Message-ID: <AANLkTimG49W9Dy+e02ijreGyKXYLLX8_VYRb8SeOHefW@mail.gmail.com>

Hi, consider this one as an FYI, or a seed for further discussion.

I am aware that many traps on sample() have been reported over the
years.  I know that these are also documents in help("sample").  Still
I got bitten by this while writing

sample(units, size=length(units));

where 'units' is an index (positive integer) vector.  It works in all
cases as expected (=I expect) expect for length(units) == 1.  I know,
it is well known.  However, it got to make me wonder if it is possible
to use sample() to draw a single value from a set containing only one
value.  I don't think so, unless you draw from a value that is <= 1.

For instance, you can sample from c(10,10) by doing:

> sample(rep(10, times=2), size=2);
[1] 10 10

but you cannot sample from c(10) by doing:

> sample(rep(10, times=1), size=1);
[1] 9

unless you sample from a value <= 1, e.g.

sample(rep(0.31, times=1), size=1);
[1] 0.31

sample(rep(-10, times=1), size=1);
[1] -10

Note also the related issue of sampling from a double vector of length 1, e.g.

> sample(rep(1.2, times=2), size=2);
[1] 1.2 1.2
> sample(rep(1.2, times=1), size=1);
[1] 1

I the latter case 1.2 is coerced to an integer.

All of the above makes sense when one study the code of sample(), but
sample() is indeed dangerous, e.g. imagine how many bootstrap
estimates out there quietly gets incorrect.


In order to cover all cases of length(units), including one, a solution is:

sampleFrom <- function(x, size=length(x), ...) {
  n <- length(x);
  if (n == 1L) {
    res <- x;
  } else {
    res <- sample(x, size=size, ...);
  }
  res;
} # sampleFrom()

> sampleFrom(rep(10, times=2), size=2);
[1] 10 10

> sampleFrom(rep(10, times=1), size=1);
[1] 10

> sampleFrom(rep(0.31, times=1), size=1);
[1] 0.31

> sampleFrom(rep(-10, times=1), size=1);
[1] -10

> sampleFrom(rep(1.2, times=2), size=2);
[1] 1.2 1.2

> sampleFrom(rep(1.2, times=1), size=1);
[1] 1.2


I want to add sampleFrom() to the wishlist of functions to be
available in default R.  Alternatively, one can add an argument
'sampleFrom=FALSE' to the existing sample() function.  Eventually such
an argument can be made TRUE by default.

/Henrik


From wwwhsd at gmail.com  Wed Nov  3 19:02:57 2010
From: wwwhsd at gmail.com (Henrique Dallazuanna)
Date: Wed, 3 Nov 2010 16:02:57 -0200
Subject: [Rd] Using sample() to sample one value from a single value?
In-Reply-To: <AANLkTimG49W9Dy+e02ijreGyKXYLLX8_VYRb8SeOHefW@mail.gmail.com>
References: <AANLkTimG49W9Dy+e02ijreGyKXYLLX8_VYRb8SeOHefW@mail.gmail.com>
Message-ID: <AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101103/00ddaa9e/attachment.pl>

From hb at biostat.ucsf.edu  Wed Nov  3 19:07:51 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 3 Nov 2010 11:07:51 -0700
Subject: [Rd] Using sample() to sample one value from a single value?
In-Reply-To: <AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>
References: <AANLkTimG49W9Dy+e02ijreGyKXYLLX8_VYRb8SeOHefW@mail.gmail.com>
	<AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>
Message-ID: <AANLkTi=0=4BZJPHhiiA-XizbC8a37Tt4D-BSQhHdNMmB@mail.gmail.com>

On Wed, Nov 3, 2010 at 11:02 AM, Henrique Dallazuanna <wwwhsd at gmail.com> wrote:
> The resample function in the example section from sample help page does it
> or not?

Yes, I just noticed that one [at the very end of the example in
help("sample")].  So, maybe resample() should be a function available
in R?

/Henrik

>
> On Wed, Nov 3, 2010 at 3:54 PM, Henrik Bengtsson <hb at biostat.ucsf.edu>wrote:
>
>> Hi, consider this one as an FYI, or a seed for further discussion.
>>
>> I am aware that many traps on sample() have been reported over the
>> years. ?I know that these are also documents in help("sample"). ?Still
>> I got bitten by this while writing
>>
>> sample(units, size=length(units));
>>
>> where 'units' is an index (positive integer) vector. ?It works in all
>> cases as expected (=I expect) expect for length(units) == 1. ?I know,
>> it is well known. ?However, it got to make me wonder if it is possible
>> to use sample() to draw a single value from a set containing only one
>> value. ?I don't think so, unless you draw from a value that is <= 1.
>>
>> For instance, you can sample from c(10,10) by doing:
>>
>> > sample(rep(10, times=2), size=2);
>> [1] 10 10
>>
>> but you cannot sample from c(10) by doing:
>>
>> > sample(rep(10, times=1), size=1);
>> [1] 9
>>
>> unless you sample from a value <= 1, e.g.
>>
>> sample(rep(0.31, times=1), size=1);
>> [1] 0.31
>>
>> sample(rep(-10, times=1), size=1);
>> [1] -10
>>
>> Note also the related issue of sampling from a double vector of length 1,
>> e.g.
>>
>> > sample(rep(1.2, times=2), size=2);
>> [1] 1.2 1.2
>> > sample(rep(1.2, times=1), size=1);
>> [1] 1
>>
>> I the latter case 1.2 is coerced to an integer.
>>
>> All of the above makes sense when one study the code of sample(), but
>> sample() is indeed dangerous, e.g. imagine how many bootstrap
>> estimates out there quietly gets incorrect.
>>
>>
>> In order to cover all cases of length(units), including one, a solution is:
>>
>> sampleFrom <- function(x, size=length(x), ...) {
>> ?n <- length(x);
>> ?if (n == 1L) {
>> ? ?res <- x;
>> ?} else {
>> ? ?res <- sample(x, size=size, ...);
>> ?}
>> ?res;
>> } # sampleFrom()
>>
>> > sampleFrom(rep(10, times=2), size=2);
>> [1] 10 10
>>
>> > sampleFrom(rep(10, times=1), size=1);
>> [1] 10
>>
>> > sampleFrom(rep(0.31, times=1), size=1);
>> [1] 0.31
>>
>> > sampleFrom(rep(-10, times=1), size=1);
>> [1] -10
>>
>> > sampleFrom(rep(1.2, times=2), size=2);
>> [1] 1.2 1.2
>>
>> > sampleFrom(rep(1.2, times=1), size=1);
>> [1] 1.2
>>
>>
>> I want to add sampleFrom() to the wishlist of functions to be
>> available in default R. ?Alternatively, one can add an argument
>> 'sampleFrom=FALSE' to the existing sample() function. ?Eventually such
>> an argument can be made TRUE by default.
>>
>> /Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> --
> Henrique Dallazuanna
> Curitiba-Paran?-Brasil
> 25? 25' 40" S 49? 16' 22" O
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From friendly at yorku.ca  Wed Nov  3 19:15:26 2010
From: friendly at yorku.ca (Michael Friendly)
Date: Wed, 03 Nov 2010 14:15:26 -0400
Subject: [Rd] R package BibTex entries: looking for a more general
	solution
In-Reply-To: <002701cb7b65$5a516c30$0ef44490$@ca>
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
Message-ID: <4CD1A6BE.3020801@yorku.ca>


On 11/3/2010 10:42 AM, John Fox wrote:
> Hi Michael,
>
> FWIW, I've added a CITATION file to the car package on R-Forge.
>
When I composed a CITATION file for the heplots package, I had to root 
around in R/library to find something to
use as a template.  The main reason for doing this was to have 
citation("heplots") also provide a reference to
the theory paper on which this was based, and which should also be cited 
by users of the package.

  "Writing R Extensions", 1.10 gives a simple example of a CITATION 
file, but even this is somewhat daunting for a
package author, and thus is generally ignored.

This would all be easier, and could evolve over time if there was a 
function, e.g., prompt.citation(package)
in utils that would write a basic CITATION file from a package 
DESCRIPTION, that a package author could
easily edit and then include in the package.

I can imagine it working something like:

 > prompt.citation("fubar")
A CITATION file for the fubar package was automatically generated from 
the package DESCRIPTION
file.  Please edit this file and move it to the appropriate directory, 
inst/ in the package tree.
Warning: no Date: field provided in the package DESCRIPTION
Warning: Authors: field does not appear to be a list of names joined 
with 'and'

Providing something like this would obviate my suggestions to impose 
restrictions on DESCRIPTION
files, and seems more in line with the way R packages and documentation 
have developed.

-Michael



-- 
Michael Friendly     Email: friendly AT yorku DOT ca
Professor, Psychology Dept.
York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
4700 Keele Street    Web:   http://www.datavis.ca
Toronto, ONT  M3J 1P3 CANADA


From hb at biostat.ucsf.edu  Wed Nov  3 19:19:47 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 3 Nov 2010 11:19:47 -0700
Subject: [Rd] Using sample() to sample one value from a single value?
In-Reply-To: <AANLkTi=0=4BZJPHhiiA-XizbC8a37Tt4D-BSQhHdNMmB@mail.gmail.com>
References: <AANLkTimG49W9Dy+e02ijreGyKXYLLX8_VYRb8SeOHefW@mail.gmail.com>
	<AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>
	<AANLkTi=0=4BZJPHhiiA-XizbC8a37Tt4D-BSQhHdNMmB@mail.gmail.com>
Message-ID: <AANLkTi=zDXTiTpJ0YoDP77xR4nH+ASAQbgTp8tXqtmer@mail.gmail.com>

On Wed, Nov 3, 2010 at 11:07 AM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
> On Wed, Nov 3, 2010 at 11:02 AM, Henrique Dallazuanna <wwwhsd at gmail.com> wrote:
>> The resample function in the example section from sample help page does it
>> or not?
>
> Yes, I just noticed that one [at the very end of the example in
> help("sample")]. ?So, maybe resample() should be a function available
> in R?

So for completeness, this has also be discussed in R-devel thread
'[patch] add is.set parameter to sample()' started on 2010-03-23, cf.
http://www.mail-archive.com/r-devel at r-project.org/msg19998.html.

/Henrik

>
> /Henrik
>
>>
>> On Wed, Nov 3, 2010 at 3:54 PM, Henrik Bengtsson <hb at biostat.ucsf.edu>wrote:
>>
>>> Hi, consider this one as an FYI, or a seed for further discussion.
>>>
>>> I am aware that many traps on sample() have been reported over the
>>> years. ?I know that these are also documents in help("sample"). ?Still
>>> I got bitten by this while writing
>>>
>>> sample(units, size=length(units));
>>>
>>> where 'units' is an index (positive integer) vector. ?It works in all
>>> cases as expected (=I expect) expect for length(units) == 1. ?I know,
>>> it is well known. ?However, it got to make me wonder if it is possible
>>> to use sample() to draw a single value from a set containing only one
>>> value. ?I don't think so, unless you draw from a value that is <= 1.
>>>
>>> For instance, you can sample from c(10,10) by doing:
>>>
>>> > sample(rep(10, times=2), size=2);
>>> [1] 10 10
>>>
>>> but you cannot sample from c(10) by doing:
>>>
>>> > sample(rep(10, times=1), size=1);
>>> [1] 9
>>>
>>> unless you sample from a value <= 1, e.g.
>>>
>>> sample(rep(0.31, times=1), size=1);
>>> [1] 0.31
>>>
>>> sample(rep(-10, times=1), size=1);
>>> [1] -10
>>>
>>> Note also the related issue of sampling from a double vector of length 1,
>>> e.g.
>>>
>>> > sample(rep(1.2, times=2), size=2);
>>> [1] 1.2 1.2
>>> > sample(rep(1.2, times=1), size=1);
>>> [1] 1
>>>
>>> I the latter case 1.2 is coerced to an integer.
>>>
>>> All of the above makes sense when one study the code of sample(), but
>>> sample() is indeed dangerous, e.g. imagine how many bootstrap
>>> estimates out there quietly gets incorrect.
>>>
>>>
>>> In order to cover all cases of length(units), including one, a solution is:
>>>
>>> sampleFrom <- function(x, size=length(x), ...) {
>>> ?n <- length(x);
>>> ?if (n == 1L) {
>>> ? ?res <- x;
>>> ?} else {
>>> ? ?res <- sample(x, size=size, ...);
>>> ?}
>>> ?res;
>>> } # sampleFrom()
>>>
>>> > sampleFrom(rep(10, times=2), size=2);
>>> [1] 10 10
>>>
>>> > sampleFrom(rep(10, times=1), size=1);
>>> [1] 10
>>>
>>> > sampleFrom(rep(0.31, times=1), size=1);
>>> [1] 0.31
>>>
>>> > sampleFrom(rep(-10, times=1), size=1);
>>> [1] -10
>>>
>>> > sampleFrom(rep(1.2, times=2), size=2);
>>> [1] 1.2 1.2
>>>
>>> > sampleFrom(rep(1.2, times=1), size=1);
>>> [1] 1.2
>>>
>>>
>>> I want to add sampleFrom() to the wishlist of functions to be
>>> available in default R. ?Alternatively, one can add an argument
>>> 'sampleFrom=FALSE' to the existing sample() function. ?Eventually such
>>> an argument can be made TRUE by default.
>>>
>>> /Henrik
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>> --
>> Henrique Dallazuanna
>> Curitiba-Paran?-Brasil
>> 25? 25' 40" S 49? 16' 22" O
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From hb at biostat.ucsf.edu  Wed Nov  3 19:26:09 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 3 Nov 2010 11:26:09 -0700
Subject: [Rd] inst/ and hidden files/directories, especially inst/.svn/?
In-Reply-To: <4CD192E8.2010700@statistik.tu-dortmund.de>
References: <AANLkTi=Dc82yWMvXi=pYDqrsW0=Amk=vd2Rt9KFRuSpk@mail.gmail.com>
	<4CD192E8.2010700@statistik.tu-dortmund.de>
Message-ID: <AANLkTikYJYdfw93OaTGMz_=he04YkHjNrvBNLo9c8VXs@mail.gmail.com>

On Wed, Nov 3, 2010 at 9:50 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
> Yes, ".svn" is special cased.

Good.

Note that it does not seem to be the case for the *.zip archive, only
for the *.tar.gz archive, as I showed.

/H

>
> Uwe Ligges
>
>
> On 02.11.2010 23:53, Henrik Bengtsson wrote:
>>
>> In Section 'Package subdirectories' of 'Writing R Extensions', ?it
>> says about the inst/ directory that:
>>
>> "The contents of the inst subdirectory will be copied recursively to
>> the installation directory (except perhaps hidden files with names
>> starting with ?.?)."
>>
>> Indeed, on Windows with R v2.12.0 patched (2010-11-01 r53513) and R
>> v2.13.0 devel (2010-11-01 r53513), if you have:
>>
>> foo/inst/bar/.bar/foo.txt
>>
>> that subdirectory .bar/ will be included in the *.tar.gz and *.zip
>> builds. ?However, .svn/ is as in:
>>
>> foo/inst/bar/.svn/foo.txt
>>
>> is only included in the *.zip file, not the *.tar.gz file.
>>
>> Is this expected? ?The "perhaps" in the documentation indicates that.
>>
>> /Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Kurt.Hornik at wu.ac.at  Wed Nov  3 20:38:38 2010
From: Kurt.Hornik at wu.ac.at (Kurt Hornik)
Date: Wed, 3 Nov 2010 20:38:38 +0100
Subject: [Rd] R package BibTex entries: looking for a more general
	solution
In-Reply-To: <4CD1674E.6070807@yorku.ca>
References: <4CD1674E.6070807@yorku.ca>
Message-ID: <19665.47678.297183.625448@fangorn.hornik.net>

>>>>> Michael Friendly writes:

Thanks for the suggestions. In fact, we are currently working on this
issue. A lot of improvements have already been done, see ?person and
?bibentry for R 2.12.0 or later, especially the details and examples
sections. Some more work still needs to be done, though. We will write a
primer that introduces the new features when all of them are available.

Best
-k

> == Summary ==
> * Problem: BibTeX entries extracted from R packages via citation() 
> require too much manual editing to be
> of general use.
> * Proposal: Date: fields should be made mandatory in package DESCRIPTION 
> files, perhaps
> beginning with warnings from R CMD check
> * Proposal: Package authors should be encouraged to use a (new) 
> Contributors: field in the DESCRIPTION file
> rather than packing all information into the Author: field, which at 
> present cannot often be parsed by BibTeX.
> * Files: All test files referred to here can be found at

> http://euclid.psych.yorku.ca/SCS/Private/Rbibs/

> == Details ==
> Around 16 Dec. 2009, I queried R-help about automating the extraction of 
> citation()s from R packages. The stimulus
> was that some journals, notably JSS, now require a reference and 
> citation of every R package mentioned,
> and it is a pain to create these manually, no less maintain them for 
> current versions.

> The result of that query was a function, Rpackage.bibs() by Achim 
> Zeileis that I have been using ever since.
> Code in: http://euclid.psych.yorku.ca/SCS/Private/Rbibs/Rpackages.bib.R
> On one current system I get the following:

>> Rpackage.bibs(file="Rpackages-R.2.11.1.bib")
> Converted 230 of 230 package citations to BibTex
> Results written to file Rpackages-R.2.11.1.bib
> Warning messages:
> 1: In citation(x) :
> no date field in DESCRIPTION file of package 'codetools'
> 2: In citation(x) :
> no date field in DESCRIPTION file of package 'gridBase'
> 3: In citation(x) : no date field in DESCRIPTION file of package 'iplots'
>> 
> See:
> http://euclid.psych.yorku.ca/SCS/Private/Rbibs/Rpkg-test.pdf
> for the result of processing this .bib file with latex/bibtex using the 
> jss.bst bibliography style

> I'm writing to R-Devel because the DESCRIPTION and inst/CITATION files 
> in R packages provide the
> basic data used in citation() and any methods based on this, and yet the 
> information in these files is
> often insufficient to generate well-formed BibTeX entries for use in 
> vignettes and publications.

> One easy case is illustrated above, where 3 packages have no Date: field 
> so the BibTeX gets no
> year = {},
> and references get printed as Murrell, P (????) for gridBase. (In my 
> original test under R 2.9.1, there where
> ~ 20 such warnings.) Thus, I propose that Date: be a required field in 
> DESCRIPTION files, and
> R CMD check complain if this is not found.

> The more difficult case has to do with the Author: field in the 
> DESCRIPTION file (when no CITATION file is present)
> People can write whatever they want here, and the result looks sort of 
> OK when printed by citation(), but confuses
> BibTeX mightly. One example:

>> citation("akima")
> To cite package ?akima? in publications use:

> Fortran code by H. Akima R port by Albrecht Gebhardt aspline function
> by Thomas Petzoldt <petzoldt at rcs.urz.tu-dresden.de> enhancements and
> corrections by Martin Maechler (2009). akima: Interpolation of
> irregularly spaced data. R package version 0.5-4.
> http://CRAN.R-project.org/package=akima

> A BibTeX entry for LaTeX users is

> @Manual{,
> title = {akima: Interpolation of irregularly spaced data},
> author = {Fortran code by H. Akima R port by Albrecht Gebhardt aspline 
> function by Thomas Petzoldt <petzoldt at rcs.urz.tu-dresden.de> 
> enhancements and corrections by Martin Maechler},
> year = {2009},
> note = {R package version 0.5-4},
> url = {http://CRAN.R-project.org/package=akima},
> }

> ATTENTION: This citation information has been auto-generated from the
> package DESCRIPTION file and may need manual editing, see
> ?help("citation")? .
>> 

> Yes, the ATTENTION note does say that manual editing may be necessary, 
> but I think a worthy goal would be
> to try to reduce the need for this.

> One simple way to do that would be to support an extra Contributions: 
> field in the DESCRIPTION file,
> so that Authors: can be more cleanly separated for the purpose of 
> creating well-structured BibTeX.
> Perhaps others have better ideas.

> -Michael

> -- 
> Michael Friendly     Email: friendly AT yorku DOT ca
> Professor, Psychology Dept.
> York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
> 4700 Keele Street    Web:http://www.datavis.ca
> Toronto, ONT  M3J 1P3 CANADA

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From therneau at mayo.edu  Wed Nov  3 21:31:47 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Wed, 03 Nov 2010 15:31:47 -0500
Subject: [Rd] model.frame problem
Message-ID: <1288816307.6148.10.camel@punchbuggy>

 A few weeks ago I reported a problem with model.frame, whose root lay
in a formula expression "....+ ratetable(x1=x1, x2=x2, ....x100=x100)"
that was really long and caused model.frame to fail.  Brian had some
indefinite ideas on what might need to change in the base code to handle
it.

  In survival_2.36-1 the bit of code that generated the offending
expression has been changed (mostly for other reasons).  The problem
case in question no longer is generated.  If fixing this issue was on
anyone's list of things to do, feel free to drop the priority to zero. 
(You could still generate this with just exactly the right call to
pyears, but I'll be boarding up that final door in 2.36-2.)

Terry Therneau


From ripley at stats.ox.ac.uk  Wed Nov  3 21:38:20 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Nov 2010 20:38:20 +0000 (GMT)
Subject: [Rd] model.frame problem
In-Reply-To: <1288816307.6148.10.camel@punchbuggy>
References: <1288816307.6148.10.camel@punchbuggy>
Message-ID: <alpine.LFD.2.00.1011032034050.2549@gannet.stats.ox.ac.uk>

It is already fixed, in three steps:

R-2.12.0:

     ? model.frame had an unstated 500 byte limit on variable names.
       (Example reported by Terry Therneau.)

R-patched:

     ? The data.frame method of format failed if a column name was
       longer than 256 bytes (the maximum length allowed for an R name).

R-devel:

     ? The previously almost undocumented limit of 256 bytes on a symbol
       name has been raised to 10,000 bytes (a sanity check).  Long
       symbol names can sometimes occur when deparsing expressions (for
       example, in model.frame).



On Wed, 3 Nov 2010, Terry Therneau wrote:

> A few weeks ago I reported a problem with model.frame, whose root lay
> in a formula expression "....+ ratetable(x1=x1, x2=x2, ....x100=x100)"
> that was really long and caused model.frame to fail.  Brian had some
> indefinite ideas on what might need to change in the base code to handle
> it.
>
>  In survival_2.36-1 the bit of code that generated the offending
> expression has been changed (mostly for other reasons).  The problem
> case in question no longer is generated.  If fixing this issue was on
> anyone's list of things to do, feel free to drop the priority to zero.
> (You could still generate this with just exactly the right call to
> pyears, but I'll be boarding up that final door in 2.36-2.)
>
> Terry Therneau
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From michael.m.spiegel at gmail.com  Wed Nov  3 23:49:52 2010
From: michael.m.spiegel at gmail.com (Michael Spiegel)
Date: Wed, 3 Nov 2010 18:49:52 -0400
Subject: [Rd] [R-SIG-Mac] BLAS benchmarks on R 2.12.0
In-Reply-To: <8E5A112D-6CF5-4CE4-B701-511406354798@r-project.org>
References: <AANLkTi=Er4FQYh-JO4eSA3PFefWdT6fuHr2S1ocwEe7t@mail.gmail.com>
	<AANLkTin8kMKzdXxJfv_Ov8OVOb_o3657zCnrVZFj+g4f@mail.gmail.com>
	<1D6FA6F3-E146-4E1B-B68E-6AEF7D9AA063@r-project.org>
	<AANLkTi=0X3S+pH-_WaGQdTyr+AoL40ew5yFB+8VOps9S@mail.gmail.com>
	<8E5A112D-6CF5-4CE4-B701-511406354798@r-project.org>
Message-ID: <AANLkTimKL=T=nKW2PwyAGMFJeLZAjwfSuMKTbE5gCmLW@mail.gmail.com>

My apologies.  I finally noticed that the source files in
src/extra/blas had changed.  I had been looking at the diff file for a
few days, until I remembered that the "c" at the beginning of a line
signifies the line as a comment.  OK, so the game plan for our
specific R package will be to take the reference BLAS source from
2.11.1 and stick it in our package.  Thanks to Simon and everyone else
for all their help.

On Wed, Nov 3, 2010 at 12:29 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>> ?I have one small follow-up question. ?I thought the compilation flags for building src/extra/blas had changed from version 2.12.0 to 2.11.1. ?But you suggest maybe they haven't changed?
>>
>
> I did not change anything as far as the configure flags go.
>
> Cheers,
> Simon
>


From simon.urbanek at r-project.org  Thu Nov  4 01:17:18 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 4 Nov 2010 01:17:18 +0100
Subject: [Rd] Calling C in R in Windows 64 bit
In-Reply-To: <2098458241.10945.1288786828198.JavaMail.root@serv223.segi.ulg.ac.be>
References: <2098458241.10945.1288786828198.JavaMail.root@serv223.segi.ulg.ac.be>
Message-ID: <63E83206-D5AF-40FB-9C02-24FE0E1177C5@r-project.org>


On Nov 3, 2010, at 1:20 PM, aysun.cetinyurek at ulg.ac.be wrote:

> Dear developers,
> 
> I am trying to run some C/ Fortran code in R. Although I have experience with that in Windows (Vista) 32 bit, I could not succeed in 64 bit. I downloaded the following:
> - R 2.12.0
> - Rtools 212
> - miktex 2.9
> - inno setup 5
> 
> -Afterwards, I changed the path as:
> ?C:\Program Files\R\R-2.12.0\bin;C:\Rtools\bin;C:\Rtools\MinGW64\bin;C:\Program Files\HTML Help Workshop;C:\Program Files (x86)\CodeBlocks\bin;C:\Program Files\Insight\bin;C:\Rtools\perl\bin;C:\Program Files (x86)\MiKTeX 2.9\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\Broadcom\Broadcom 802.11\Driver;?
> 
> - started Command Prompt and checked the path by typing 'path'
> - then I typed
> 
> 'x86_64-w64-mingw32-gcc -c COXPHmatprod24delta.c -o COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include"'
> 
> the above command produced the file with .o extension. 
> 
> -Afterwards I typed 
> 'x86_64-w64-mingw32-gcc -shared -o COXPHmatprod24delta.dll COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include" -L"C:\Program Files\R\R-2.12.0\bin" ?lR'
> 
> it produces the error: 
> 'x86_64-w64-mingw32-gcc: -lR: No such file or directory'
> 
> -The problem here is that it does not produce .dll file. I cannot find the solution to that although I tried for 2 days.   
> 

Well, you are pointing -L to the wrong path (it's missing the architecture - in your case x64), so it's no wonder. What you really want is  R --arch x64 CMD SHLIB


> --Alternatively I tried ?R CMD SHLIB COXPHmatprod24delta.c? and it produces the error:
> 'cygwin warning:
>  MS-DOS style path detected: C:/PROGRA~1/R/R-212~1.0/etc/i386/Makeconf
>  Preferred POSIX equivalent is: /cygdrive/c/PROGRA~1/R/R-212~1.0/etc/i386/Makec
> onf
>  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
>  Consult the user's guide for more details about POSIX paths:
>    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
> nm: not found
> gcc -shared -s -static-libgcc -o COXPHmatprod24delta.dll tmp.def COXPHmatprod24d
> elta.o -LC:/PROGRA~1/R/R-212~1.0/bin/i386 -lR
> gcc: not found'
> 

You are compiling 32-bit and you don't have the tools installed. If you meant to use 64-bit you want to use R --arch x64 CMD SHLIB instead.

Cheers,
Simon


> Every comment is appreciated. Many thanks in advance.
> 
> Sincerely Yours,
> 
> Aysun Cetinyurek
> 
> Services de Statistique
> Institut de Math?matique (B37)
> Grande Traverse, 12
> B4000 Li?ge
> Belgique
> 
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From janko.thyson at ku-eichstaett.de  Thu Nov  4 01:50:08 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 4 Nov 2010 01:50:08 +0100
Subject: [Rd] Roxygen: @example tag does not work for me
Message-ID: <003a01cb7bba$3aa841b0$aff8c510$@thyson@ku-eichstaett.de>

Dear list,

 

somehow I can't get the Roxygen tag "@example" to work for me.

 

My "Roxygen-Header" of a script containing, say, a function looks like this:

 

#' My header

#' 

#' My description

#' 

#' @param a Blabla.

#' @param b Blabla.

#' @return \code{TRUE}. 

#' @callGraphPrimitives

#' @references

#' \url{http://www.something.org /}

#' @author Janko Thyson \email{my.email@@something.com}

#' @example tests/foo.R

#' @seealso \code{\link{some.other.function}}

Foo <- function(a, b){cat("Doing nothing useful.")} 

 

I thought that @example would take the R code in "tests/foo.R" (this file
also exists) and append it to the .Rd-file. However, there is no
\examples{...} section in my roxygen-processed .Rd-file after running
roxygenize(). It just seems as if @example is just neglected. Should I put
the file in another directory? 

 

The basic thing I'm trying to do is to have the "unit tests" for my
functions organized in separate scripts and then plug in some of their
content as examples in the .Rd-files (this should be accomplished by using
in-source documentation ? la Roxygen ? thus something like "@example"
pointing to such a script file would be very neat). I'd definitely like to
get around to "manually" specifying examples via the other tag "@examples"
as they will most likely lead to "out-of-sync" situations regarding the unit
test files. Any ideas?

 

Thanks a lot!

Janko

 


From baptiste.auguie at googlemail.com  Thu Nov  4 07:43:23 2010
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Thu, 4 Nov 2010 07:43:23 +0100
Subject: [Rd] Roxygen: @example tag does not work for me
In-Reply-To: <5495425330153933958@unknownmsgid>
References: <5495425330153933958@unknownmsgid>
Message-ID: <AANLkTikOwzWkyfSCwXOd5FYFeMYNeYnjv6CFNYA-qt_4@mail.gmail.com>

Hi,

I think you could achieve this using the brew package. Define a
function that reads your external example file, and have brew insert
the resulting string in your script, which can then be processed by
roxygen.

I'm curious to hear other suggestions, but I doubt it could work
out-of-the-box like you intended.

HTH,

baptiste

On 4 November 2010 01:50, Janko Thyson <janko.thyson at ku-eichstaett.de> wrote:
> Dear list,
>
>
>
> somehow I can't get the Roxygen tag "@example" to work for me.
>
>
>
> My "Roxygen-Header" of a script containing, say, a function looks like this:
>
>
>
> #' My header
>
> #'
>
> #' My description
>
> #'
>
> #' @param a Blabla.
>
> #' @param b Blabla.
>
> #' @return \code{TRUE}.
>
> #' @callGraphPrimitives
>
> #' @references
>
> #' \url{http://www.something.org /}
>
> #' @author Janko Thyson \email{my.email@@something.com}
>
> #' @example tests/foo.R
>
> #' @seealso \code{\link{some.other.function}}
>
> Foo <- function(a, b){cat("Doing nothing useful.")}
>
>
>
> I thought that @example would take the R code in "tests/foo.R" (this file
> also exists) and append it to the .Rd-file. However, there is no
> \examples{...} section in my roxygen-processed .Rd-file after running
> roxygenize(). It just seems as if @example is just neglected. Should I put
> the file in another directory?
>
>
>
> The basic thing I'm trying to do is to have the "unit tests" for my
> functions organized in separate scripts and then plug in some of their
> content as examples in the .Rd-files (this should be accomplished by using
> in-source documentation ? la Roxygen ? thus something like "@example"
> pointing to such a script file would be very neat). I'd definitely like to
> get around to "manually" specifying examples via the other tag "@examples"
> as they will most likely lead to "out-of-sync" situations regarding the unit
> test files. Any ideas?
>
>
>
> Thanks a lot!
>
> Janko
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ripley at stats.ox.ac.uk  Thu Nov  4 07:44:25 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 4 Nov 2010 06:44:25 +0000 (GMT)
Subject: [Rd] Calling C in R in Windows 64 bit
In-Reply-To: <63E83206-D5AF-40FB-9C02-24FE0E1177C5@r-project.org>
References: <2098458241.10945.1288786828198.JavaMail.root@serv223.segi.ulg.ac.be>
	<63E83206-D5AF-40FB-9C02-24FE0E1177C5@r-project.org>
Message-ID: <alpine.LFD.2.00.1011040641020.24342@gannet.stats.ox.ac.uk>

More simply, he wants to set his paths as described in the CHANGES 
file and R-admin manual, to

C:\Program Files\R\R-2.12.0\bin\x64

and so on.  C:\Program Files\R\R-2.12.0\bin\R is only provided for 
some backwards compatibilty (as the CHANGES file says) and may not be 
retained in future versions.

On Thu, 4 Nov 2010, Simon Urbanek wrote:

>
> On Nov 3, 2010, at 1:20 PM, aysun.cetinyurek at ulg.ac.be wrote:
>
>> Dear developers,
>>
>> I am trying to run some C/ Fortran code in R. Although I have experience with that in Windows (Vista) 32 bit, I could not succeed in 64 bit. I downloaded the following:
>> - R 2.12.0
>> - Rtools 212
>> - miktex 2.9
>> - inno setup 5
>>
>> -Afterwards, I changed the path as:
>> ?C:\Program Files\R\R-2.12.0\bin;C:\Rtools\bin;C:\Rtools\MinGW64\bin;C:\Program Files\HTML Help Workshop;C:\Program Files (x86)\CodeBlocks\bin;C:\Program Files\Insight\bin;C:\Rtools\perl\bin;C:\Program Files (x86)\MiKTeX 2.9\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\Broadcom\Broadcom 802.11\Driver;?
>>
>> - started Command Prompt and checked the path by typing 'path'
>> - then I typed
>>
>> 'x86_64-w64-mingw32-gcc -c COXPHmatprod24delta.c -o COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include"'
>>
>> the above command produced the file with .o extension.
>>
>> -Afterwards I typed
>> 'x86_64-w64-mingw32-gcc -shared -o COXPHmatprod24delta.dll COXPHmatprod24delta.o -I"C:\Program Files\R\R-2.12.0\include" -L"C:\Program Files\R\R-2.12.0\bin" ?lR'
>>
>> it produces the error:
>> 'x86_64-w64-mingw32-gcc: -lR: No such file or directory'
>>
>> -The problem here is that it does not produce .dll file. I cannot find the solution to that although I tried for 2 days.
>>
>
> Well, you are pointing -L to the wrong path (it's missing the architecture - in your case x64), so it's no wonder. What you really want is  R --arch x64 CMD SHLIB
>
>
>> --Alternatively I tried ?R CMD SHLIB COXPHmatprod24delta.c? and it produces the error:
>> 'cygwin warning:
>>  MS-DOS style path detected: C:/PROGRA~1/R/R-212~1.0/etc/i386/Makeconf
>>  Preferred POSIX equivalent is: /cygdrive/c/PROGRA~1/R/R-212~1.0/etc/i386/Makec
>> onf
>>  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
>>  Consult the user's guide for more details about POSIX paths:
>>    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
>> nm: not found
>> gcc -shared -s -static-libgcc -o COXPHmatprod24delta.dll tmp.def COXPHmatprod24d
>> elta.o -LC:/PROGRA~1/R/R-212~1.0/bin/i386 -lR
>> gcc: not found'
>>
>
> You are compiling 32-bit and you don't have the tools installed. If 
> you meant to use 64-bit you want to use R --arch x64 CMD SHLIB 
> instead.
>
> Cheers,
> Simon
>
>
>> Every comment is appreciated. Many thanks in advance.
>>
>> Sincerely Yours,
>>
>> Aysun Cetinyurek
>>
>> Services de Statistique
>> Institut de Math?matique (B37)
>> Grande Traverse, 12
>> B4000 Li?ge
>> Belgique
>>
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ted.harding at wlandres.net  Thu Nov  4 10:08:42 2010
From: ted.harding at wlandres.net ( (Ted Harding))
Date: Thu, 04 Nov 2010 09:08:42 -0000 (GMT)
Subject: [Rd] [R] Logical vectors
In-Reply-To: <Pine.SOC.4.64.1011040951510.18770@solcom.hrz.uni-giessen.de>
Message-ID: <XFMail.101104090842.ted.harding@wlandres.net>

On 04-Nov-10 08:56:42, Gerrit Eichner wrote:
> On Thu, 4 Nov 2010, Stephen Liu wrote:
> [snip]
>> In;
>>
>> 2.4 Logical vectors
>> http://cran.r-project.org/doc/manuals/R-intro.html#R-and-statistics
>>
>> It states:-
>>
>> The logical operators are <, <=, >, >=, == for exact equality and !=
>> for inequality ........
>>
>>>    # exact equality
>> !=   # inequality
> 
> [snip]
> 
> 
> Hello, Stephen,
> in my understanding of the sentence
> 
> "The logical operators are <, <=, >, >=, == for exact equality and !=
> for inequality ........"
> 
> the phrase "exact equality" refers to the operator "==", i. e. to the
> last element "==" in the enumeration (<, <=, >, >=, ==), and not to its
> first.
> 
>   Regards  --  Gerrit

This indicates that the sentence can be mis-read. It should be
cured by a small change in punctuation (hence I copy to R-devel):

  The logical operators are <, <=, >, >=; == for exact equality;
  and != for inequality ........

Hoping this helps!
Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <ted.harding at wlandres.net>
Fax-to-email: +44 (0)870 094 0861
Date: 04-Nov-10                                       Time: 09:08:37
------------------------------ XFMail ------------------------------


From ligges at statistik.tu-dortmund.de  Thu Nov  4 10:29:22 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 04 Nov 2010 10:29:22 +0100
Subject: [Rd] inst/ and hidden files/directories, especially inst/.svn/?
In-Reply-To: <AANLkTikYJYdfw93OaTGMz_=he04YkHjNrvBNLo9c8VXs@mail.gmail.com>
References: <AANLkTi=Dc82yWMvXi=pYDqrsW0=Amk=vd2Rt9KFRuSpk@mail.gmail.com>	<4CD192E8.2010700@statistik.tu-dortmund.de>
	<AANLkTikYJYdfw93OaTGMz_=he04YkHjNrvBNLo9c8VXs@mail.gmail.com>
Message-ID: <4CD27CF2.90602@statistik.tu-dortmund.de>



On 03.11.2010 19:26, Henrik Bengtsson wrote:
> On Wed, Nov 3, 2010 at 9:50 AM, Uwe Ligges
> <ligges at statistik.tu-dortmund.de>  wrote:
>> Yes, ".svn" is special cased.
>
> Good.
>
> Note that it does not seem to be the case for the *.zip archive, only
> for the *.tar.gz archive, as I showed.


Henrik,

I do not see how it can go at all into a zip archive if the recommended 
way of creating Windows binaries is used: Please create Windows binary 
packages by running  R CMD INSTALL --build  on the tarball.

Best wishes,
Uwe



> /H
>
>>
>> Uwe Ligges
>>
>>
>> On 02.11.2010 23:53, Henrik Bengtsson wrote:
>>>
>>> In Section 'Package subdirectories' of 'Writing R Extensions',  it
>>> says about the inst/ directory that:
>>>
>>> "The contents of the inst subdirectory will be copied recursively to
>>> the installation directory (except perhaps hidden files with names
>>> starting with ?.?)."
>>>
>>> Indeed, on Windows with R v2.12.0 patched (2010-11-01 r53513) and R
>>> v2.13.0 devel (2010-11-01 r53513), if you have:
>>>
>>> foo/inst/bar/.bar/foo.txt
>>>
>>> that subdirectory .bar/ will be included in the *.tar.gz and *.zip
>>> builds.  However, .svn/ is as in:
>>>
>>> foo/inst/bar/.svn/foo.txt
>>>
>>> is only included in the *.zip file, not the *.tar.gz file.
>>>
>>> Is this expected?  The "perhaps" in the documentation indicates that.
>>>
>>> /Henrik
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From janko.thyson at ku-eichstaett.de  Thu Nov  4 11:03:54 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 4 Nov 2010 11:03:54 +0100
Subject: [Rd] Roxygen: @example tag does not work for me
In-Reply-To: <AANLkTikOwzWkyfSCwXOd5FYFeMYNeYnjv6CFNYA-qt_4@mail.gmail.com>
References: <5495425330153933958@unknownmsgid>
	<AANLkTikOwzWkyfSCwXOd5FYFeMYNeYnjv6CFNYA-qt_4@mail.gmail.com>
Message-ID: <001501cb7c07$96f3da90$c4db8fb0$@thyson@ku-eichstaett.de>

> -----Urspr?ngliche Nachricht-----
> Von: baptiste auguie [mailto:baptiste.auguie at googlemail.com]
> Gesendet: Donnerstag, 4. November 2010 07:43
> An: Janko Thyson
> Cc: r-devel at r-project. org
> Betreff: Re: [Rd] Roxygen: @example tag does not work for me
> 
> Hi,
> 
> I think you could achieve this using the brew package. Define a
> function that reads your external example file, and have brew insert
> the resulting string in your script, which can then be processed by
> roxygen.
> 
> I'm curious to hear other suggestions, but I doubt it could work
> out-of-the-box like you intended.
> 
> HTH,
> 
> baptiste

Thanks a lot for the suggestion, I will have a look at brew.
But I still think that "@example" is meant to do what I'm trying to do
out-of-the box. At least it says so in the Roxygen manual (p. 19) and I
found such a Roxygen line in the tutorial given at user! 2010
(http://roxygen.org/useR/roxygen-part-1.pdf, p. 25). Did anyone of you use
"@example" yet?

Cheers,
Janko

> 
> On 4 November 2010 01:50, Janko Thyson <janko.thyson at ku-eichstaett.de>
> wrote:
> > Dear list,
> >
> >
> >
> > somehow I can't get the Roxygen tag "@example" to work for me.
> >
> >
> >
> > My "Roxygen-Header" of a script containing, say, a function looks
> like this:
> >
> >
> >
> > #' My header
> >
> > #'
> >
> > #' My description
> >
> > #'
> >
> > #' @param a Blabla.
> >
> > #' @param b Blabla.
> >
> > #' @return \code{TRUE}.
> >
> > #' @callGraphPrimitives
> >
> > #' @references
> >
> > #' \url{http://www.something.org /}
> >
> > #' @author Janko Thyson \email{my.email@@something.com}
> >
> > #' @example tests/foo.R
> >
> > #' @seealso \code{\link{some.other.function}}
> >
> > Foo <- function(a, b){cat("Doing nothing useful.")}
> >
> >
> >
> > I thought that @example would take the R code in "tests/foo.R" (this
> file
> > also exists) and append it to the .Rd-file. However, there is no
> > \examples{...} section in my roxygen-processed .Rd-file after running
> > roxygenize(). It just seems as if @example is just neglected. Should
> I put
> > the file in another directory?
> >
> >
> >
> > The basic thing I'm trying to do is to have the "unit tests" for my
> > functions organized in separate scripts and then plug in some of
> their
> > content as examples in the .Rd-files (this should be accomplished by
> using
> > in-source documentation ? la Roxygen ? thus something like "@example"
> > pointing to such a script file would be very neat). I'd definitely
> like to
> > get around to "manually" specifying examples via the other tag
> "@examples"
> > as they will most likely lead to "out-of-sync" situations regarding
> the unit
> > test files. Any ideas?
> >
> >
> >
> > Thanks a lot!
> >
> > Janko
> >
> >
> >
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >


From satimis at yahoo.com  Thu Nov  4 10:39:32 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Thu, 4 Nov 2010 02:39:32 -0700 (PDT)
Subject: [Rd] [R] Logical vectors
In-Reply-To: <XFMail.101104090842.ted.harding@wlandres.net>
References: <XFMail.101104090842.ted.harding@wlandres.net>
Message-ID: <557131.88390.qm@web113210.mail.gq1.yahoo.com>

Hi Ted,

Thanks for your advice and the correction on the document concerned.

B.R.
Stephen L



----- Original Message ----
From: "ted.harding at wlandres.net" <ted.harding at wlandres.net>
To: r-help at r-project.org
Cc: Stephen Liu <satimis at yahoo.com>; R-Devel <r-devel at stat.math.ethz.ch>
Sent: Thu, November 4, 2010 5:08:42 PM
Subject: Re: [R] Logical vectors

On 04-Nov-10 08:56:42, Gerrit Eichner wrote:
> On Thu, 4 Nov 2010, Stephen Liu wrote:
> [snip]
>> In;
>>
>> 2.4 Logical vectors
>> http://cran.r-project.org/doc/manuals/R-intro.html#R-and-statistics
>>
>> It states:-
>>
>> The logical operators are <, <=, >, >=, == for exact equality and !=
>> for inequality ........
>>
>>>    # exact equality
>> !=   # inequality
> 
> [snip]
> 
> 
> Hello, Stephen,
> in my understanding of the sentence
> 
> "The logical operators are <, <=, >, >=, == for exact equality and !=
> for inequality ........"
> 
> the phrase "exact equality" refers to the operator "==", i. e. to the
> last element "==" in the enumeration (<, <=, >, >=, ==), and not to its
> first.
> 
>   Regards  --  Gerrit

This indicates that the sentence can be mis-read. It should be
cured by a small change in punctuation (hence I copy to R-devel):

  The logical operators are <, <=, >, >=; == for exact equality;
  and != for inequality ........

Hoping this helps!
Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <ted.harding at wlandres.net>
Fax-to-email: +44 (0)870 094 0861
Date: 04-Nov-10                                       Time: 09:08:37
------------------------------ XFMail ------------------------------




From janko.thyson at ku-eichstaett.de  Thu Nov  4 14:14:01 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 4 Nov 2010 14:14:01 +0100
Subject: [Rd] [Roxygen-devel] Roxygen: @example tag does not work for me
In-Reply-To: <AANLkTikarnCXvftebnXCJ0BuUOvFWj4PiPAkUpJA_UmY@mail.gmail.com>
References: <AANLkTikarnCXvftebnXCJ0BuUOvFWj4PiPAkUpJA_UmY@mail.gmail.com>
Message-ID: <003501cb7c22$25f61e50$71e25af0$@thyson@ku-eichstaett.de>


> -----Urspr?ngliche Nachricht-----
> Von: roxygen-devel-bounces at lists.r-forge.r-project.org [mailto:roxygen-
> devel-bounces at lists.r-forge.r-project.org] Im Auftrag von Vinh Nguyen
> Gesendet: Donnerstag, 4. November 2010 04:04
> An: roxygen-devel at r-forge.wu-wien.ac.at
> Betreff: Re: [Roxygen-devel] Roxygen: @example tag does not work for me
> 
> Try @examples (with an 's'):
> 
> #' @examples
> #' my R code
> #' my R code

Hi Vinh,

thanks for the reply. What you suggest works just fine. It's not the thing
I'm looking for, though, since it means I have to "hard code" my examples to
the actual script. That's exactly what I'm trying to get around. And there
is this ominous "@example" tag that should get the job done, I just don't
get how ;-)

Thanks for your comment though!

Regards, Janko

> 
> I'm not sure if placing a relative path (tests/foo.R) would work...try
> placing the actual code in the documentation chunk.
> _______________________________________________
> Roxygen-devel mailing list
> Roxygen-devel at lists.r-forge.r-project.org
> https://lists.r-forge.r-project.org/cgi-bin/mailman/listinfo/roxygen-
> devel


From timhesterberg at gmail.com  Thu Nov  4 15:42:52 2010
From: timhesterberg at gmail.com (Tim Hesterberg)
Date: Thu, 04 Nov 2010 07:42:52 -0700
Subject: [Rd] Using sample() to sample one value from a single	value?
In-Reply-To: <AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>
	(message from Henrique Dallazuanna on Wed, 3 Nov 2010 16:02:57 -0200)
References: <AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>
Message-ID: <yajf1v71i1zn.fsf@dhcp-172-19-7-145.mtv.corp.google.com>

On Wed, Nov 3, 2010 at 3:54 PM, Henrik Bengtsson <hb at biostat.ucsf.edu>wrote:

> Hi, consider this one as an FYI, or a seed for further discussion.
>
> I am aware that many traps on sample() have been reported over the
> years.  I know that these are also documents in help("sample").  Still
> I got bitten by this while writing
>...
> All of the above makes sense when one study the code of sample(), but
> sample() is indeed dangerous, e.g. imagine how many bootstrap
> estimates out there quietly gets incorrect.

Nonparametric bootstrapping from a sample of size 1 is <always> incorrect.
If you draw a single observation from a sample of size 1, you get that
same observation back.  This implies zero sampling variability, which
is wrong.  If this single sample represents one stratum or sample in
a larger problem, this would contribute zero variability to the overall
result, again wrong.

In general, the ordinary bootstrap underestimates variability in
small samples.  For a sample mean, the ordinary bootstrap corresponds
to using an estimate of variance equal to (1/n) sum((x - mean(x))^2),
instead of a divisor of n-1.  In stratified and multi-sample applications
the downward bias is similarly (n-1)/n.

Three remedies are:
* draw bootstrap samples of size n-1
* "bootknife" sampling - omit one observation (a jackknife sample), then
  draw a bootstrap sample of size n from that
* bootstrap from a kernel density estimate, with kernel covariance equal
  to empirical covariance (with divisor n-1) / n.
The latter two are described in 
Hesterberg, Tim C. (2004), Unbiasing the Bootstrap-Bootknife Sampling vs. Smoothing, Proceedings of the Section on Statistics and the Environment, American Statistical Association, 2924-2930.
http://home.comcast.net/~timhesterberg/articles/JSM04-bootknife.pdf

All three are undefined for samples of size 1.  You need to go to some
other bootstrap, e.g. a parametric bootstrap with variability estimated
from other data.

Tim Hesterberg


From vqnguyen at uci.edu  Thu Nov  4 17:14:38 2010
From: vqnguyen at uci.edu (Vinh Nguyen)
Date: Thu, 4 Nov 2010 09:14:38 -0700
Subject: [Rd] [Roxygen-devel] Roxygen: @example tag does not work for me
In-Reply-To: <4680497819169548415@unknownmsgid>
References: <AANLkTikarnCXvftebnXCJ0BuUOvFWj4PiPAkUpJA_UmY@mail.gmail.com>
	<4680497819169548415@unknownmsgid>
Message-ID: <AANLkTinpqq0UTf0geWjM6qS8_pHXyUBZ3R8qdMom1AG8@mail.gmail.com>

I didn't know @example path/to/file.R was available until you
mentioned the UseR! 2010 presentation.  If that's the case, I'm going
to guess that you have to specify use.Rd2=TRUE in roxygenize(), as
I've found most of the new features mentioned in that presentation to
require it.


On Thu, Nov 4, 2010 at 6:14 AM, Janko Thyson
<janko.thyson at ku-eichstaett.de> wrote:
>
> Hi Vinh,
>
> thanks for the reply. What you suggest works just fine. It's not the thing
> I'm looking for, though, since it means I have to "hard code" my examples to
> the actual script. That's exactly what I'm trying to get around. And there
> is this ominous "@example" tag that should get the job done, I just don't
> get how ;-)
>
> Thanks for your comment though!
>
> Regards, Janko
>


From janko.thyson at ku-eichstaett.de  Thu Nov  4 18:49:12 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 4 Nov 2010 18:49:12 +0100
Subject: [Rd] [Roxygen-devel] Roxygen: @example tag does not work for me
In-Reply-To: <AANLkTinpqq0UTf0geWjM6qS8_pHXyUBZ3R8qdMom1AG8@mail.gmail.com>
References: <AANLkTikarnCXvftebnXCJ0BuUOvFWj4PiPAkUpJA_UmY@mail.gmail.com>
	<4680497819169548415@unknownmsgid>
	<AANLkTinpqq0UTf0geWjM6qS8_pHXyUBZ3R8qdMom1AG8@mail.gmail.com>
Message-ID: <004201cb7c48$96f7c1a0$c4e744e0$@thyson@ku-eichstaett.de>

> -----Urspr?ngliche Nachricht-----
> Von: Vinh Nguyen [mailto:vqnguyen at uci.edu]
> Gesendet: Donnerstag, 4. November 2010 17:15
> An: Janko Thyson
> Cc: r-devel at r-project. org
> Betreff: Re: [Roxygen-devel] Roxygen: @example tag does not work for me
> 
> I didn't know @example path/to/file.R was available until you
> mentioned the UseR! 2010 presentation.  If that's the case, I'm going
> to guess that you have to specify use.Rd2=TRUE in roxygenize(), as
> I've found most of the new features mentioned in that presentation to
> require it.
> 

Unfortunately, use.Rd2=TRUE also doesn't seem to work. 

> 
> On Thu, Nov 4, 2010 at 6:14 AM, Janko Thyson
> <janko.thyson at ku-eichstaett.de> wrote:
> >
> > Hi Vinh,
> >
> > thanks for the reply. What you suggest works just fine. It's not the
> thing
> > I'm looking for, though, since it means I have to "hard code" my
> examples to
> > the actual script. That's exactly what I'm trying to get around. And
> there
> > is this ominous "@example" tag that should get the job done, I just
> don't
> > get how ;-)
> >
> > Thanks for your comment though!
> >
> > Regards, Janko
> >


From hb at biostat.ucsf.edu  Thu Nov  4 18:59:25 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 4 Nov 2010 10:59:25 -0700
Subject: [Rd] inst/ and hidden files/directories, especially inst/.svn/?
In-Reply-To: <4CD27CF2.90602@statistik.tu-dortmund.de>
References: <AANLkTi=Dc82yWMvXi=pYDqrsW0=Amk=vd2Rt9KFRuSpk@mail.gmail.com>
	<4CD192E8.2010700@statistik.tu-dortmund.de>
	<AANLkTikYJYdfw93OaTGMz_=he04YkHjNrvBNLo9c8VXs@mail.gmail.com>
	<4CD27CF2.90602@statistik.tu-dortmund.de>
Message-ID: <AANLkTin32WWwMH=O369LP_frEPQA6EAOKxdZQ+B2Yk4C@mail.gmail.com>

2010/11/4 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>
> On 03.11.2010 19:26, Henrik Bengtsson wrote:
>>
>> On Wed, Nov 3, 2010 at 9:50 AM, Uwe Ligges
>> <ligges at statistik.tu-dortmund.de> ?wrote:
>>>
>>> Yes, ".svn" is special cased.
>>
>> Good.
>>
>> Note that it does not seem to be the case for the *.zip archive, only
>> for the *.tar.gz archive, as I showed.
>
>
> Henrik,
>
> I do not see how it can go at all into a zip archive if the recommended way
> of creating Windows binaries is used: Please create Windows binary packages
> by running ?R CMD INSTALL --build ?on the tarball.

Thanks Uwe,

all these years I've always build my binaries using

R CMD build <pkg>

where <pkg> is the directory containing the package source (a copy of it).

In Section 'Building packages' of 'Writing R Extensions' it does indeed say:

"R CMD build can also build pre-compiled version of packages for
binary distributions, but R CMD INSTALL --build is preferred (and is
considerably more flexible)."

However, the inconsistency between the two approach in dealing with
.svn/ subdirectories remains.  However however, I now see that in the
R v2.13.0 devel (2010-11-01 r53513) version of the documentation it
says:

"Note that prior to R 2.13.0, R CMD build did some cleaning in the
supplied source directory, but this was undocumented and is no longer
done."

whereas in R v2.12.0 patched (2010-11-01 r53513) it says (with grammar hiccups):

"R CMD build currently does some cleaning in the supplied source
directory, but this was will no longer happen in R"

Someone is certainly ahead of me ;)

/Henrik

>
> Best wishes,
> Uwe
>
>
>
>> /H
>>
>>>
>>> Uwe Ligges
>>>
>>>
>>> On 02.11.2010 23:53, Henrik Bengtsson wrote:
>>>>
>>>> In Section 'Package subdirectories' of 'Writing R Extensions', ?it
>>>> says about the inst/ directory that:
>>>>
>>>> "The contents of the inst subdirectory will be copied recursively to
>>>> the installation directory (except perhaps hidden files with names
>>>> starting with ?.?)."
>>>>
>>>> Indeed, on Windows with R v2.12.0 patched (2010-11-01 r53513) and R
>>>> v2.13.0 devel (2010-11-01 r53513), if you have:
>>>>
>>>> foo/inst/bar/.bar/foo.txt
>>>>
>>>> that subdirectory .bar/ will be included in the *.tar.gz and *.zip
>>>> builds. ?However, .svn/ is as in:
>>>>
>>>> foo/inst/bar/.svn/foo.txt
>>>>
>>>> is only included in the *.zip file, not the *.tar.gz file.
>>>>
>>>> Is this expected? ?The "perhaps" in the documentation indicates that.
>>>>
>>>> /Henrik
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>


From hb at biostat.ucsf.edu  Thu Nov  4 18:59:31 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 4 Nov 2010 10:59:31 -0700
Subject: [Rd] Using sample() to sample one value from a single value?
In-Reply-To: <yajf1v71i1zn.fsf@dhcp-172-19-7-145.mtv.corp.google.com>
References: <AANLkTik5oiqjRKjZ-=tVtaamyp27KGvg8JG0GJ23d8Bo@mail.gmail.com>
	<yajf1v71i1zn.fsf@dhcp-172-19-7-145.mtv.corp.google.com>
Message-ID: <AANLkTikJp_bVPzjN9g-PnnG-6D_wxOa9j4kN3urC5PEC@mail.gmail.com>

Hi.

On Thu, Nov 4, 2010 at 7:42 AM, Tim Hesterberg <timhesterberg at gmail.com> wrote:
> On Wed, Nov 3, 2010 at 3:54 PM, Henrik Bengtsson <hb at biostat.ucsf.edu>wrote:
>
>> Hi, consider this one as an FYI, or a seed for further discussion.
>>
>> I am aware that many traps on sample() have been reported over the
>> years. ?I know that these are also documents in help("sample"). ?Still
>> I got bitten by this while writing
>>...
>> All of the above makes sense when one study the code of sample(), but
>> sample() is indeed dangerous, e.g. imagine how many bootstrap
>> estimates out there quietly gets incorrect.
>
> Nonparametric bootstrapping from a sample of size 1 is <always> incorrect.
> If you draw a single observation from a sample of size 1, you get that
> same observation back. ?This implies zero sampling variability, which
> is wrong. ?If this single sample represents one stratum or sample in
> a larger problem, this would contribute zero variability to the overall
> result, again wrong.
>
> In general, the ordinary bootstrap underestimates variability in
> small samples. ?For a sample mean, the ordinary bootstrap corresponds
> to using an estimate of variance equal to (1/n) sum((x - mean(x))^2),
> instead of a divisor of n-1. ?In stratified and multi-sample applications
> the downward bias is similarly (n-1)/n.
>
> Three remedies are:
> * draw bootstrap samples of size n-1
> * "bootknife" sampling - omit one observation (a jackknife sample), then
> ?draw a bootstrap sample of size n from that
> * bootstrap from a kernel density estimate, with kernel covariance equal
> ?to empirical covariance (with divisor n-1) / n.
> The latter two are described in
> Hesterberg, Tim C. (2004), Unbiasing the Bootstrap-Bootknife Sampling vs.
> Smoothing, Proceedings of the Section on Statistics and the Environment,
> American Statistical Association, 2924-2930.
> http://home.comcast.net/~timhesterberg/articles/JSM04-bootknife.pdf
>
> All three are undefined for samples of size 1. ?You need to go to some
> other bootstrap, e.g. a parametric bootstrap with variability estimated
> from other data.

I had a feeling that I was going to be bitten by that attention
grabber on bootstrapping. Worse it may be misleading to some.  But
honestly, thank you Tim for pointing this out and so clearly
explaining it all.

/Henrik

>
> Tim Hesterberg
>
>


From hadley at rice.edu  Thu Nov  4 19:00:10 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 4 Nov 2010 18:00:10 +0000
Subject: [Rd] Roxygen: @example tag does not work for me
In-Reply-To: <5495425330153933958@unknownmsgid>
References: <5495425330153933958@unknownmsgid>
Message-ID: <AANLkTinmQPaLiPTGY7fEg3jGE3FQRcubq9_1rjn4_va-@mail.gmail.com>

> I thought that @example would take the R code in "tests/foo.R" (this file
> also exists) and append it to the .Rd-file. However, there is no
> \examples{...} section in my roxygen-processed .Rd-file after running
> roxygenize(). It just seems as if @example is just neglected. Should I put
> the file in another directory?

I would suspect that the path would be relative to either man/ or R/ -
so you probably want ../tests/...

But including your unit tests as examples seems like a pretty odd
thing to do - they do serve rather different purposes.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From janko.thyson at ku-eichstaett.de  Thu Nov  4 19:12:39 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 4 Nov 2010 19:12:39 +0100
Subject: [Rd] Roxygen: @example tag does not work for me
In-Reply-To: <AANLkTinmQPaLiPTGY7fEg3jGE3FQRcubq9_1rjn4_va-@mail.gmail.com>
References: <5495425330153933958@unknownmsgid>
	<AANLkTinmQPaLiPTGY7fEg3jGE3FQRcubq9_1rjn4_va-@mail.gmail.com>
Message-ID: <004301cb7c4b$de0d5c00$9a281400$@thyson@ku-eichstaett.de>

> -----Urspr?ngliche Nachricht-----
> Von: h.wickham at gmail.com [mailto:h.wickham at gmail.com] Im Auftrag von
> Hadley Wickham
> Gesendet: Donnerstag, 4. November 2010 19:00
> An: Janko Thyson
> Cc: r-devel at r-project. org
> Betreff: Re: [Rd] Roxygen: @example tag does not work for me
> 
> > I thought that @example would take the R code in "tests/foo.R" (this
> file
> > also exists) and append it to the .Rd-file. However, there is no
> > \examples{...} section in my roxygen-processed .Rd-file after running
> > roxygenize(). It just seems as if @example is just neglected. Should
> I put
> > the file in another directory?
> 
> I would suspect that the path would be relative to either man/ or R/ -
> so you probably want ../tests/...

Thanks, I'll try that.

> But including your unit tests as examples seems like a pretty odd
> thing to do - they do serve rather different purposes.

Sure. Don't know if "unit test" is a bit of an overkill name for my stuff.
But I usually do poor man's testing of my functions in a script where I call
the function with different settings. And I thought about tagging some parts
of those scripts that qualify as good examples, have a routine that picks up
those tagged sections and writes it to, say, "/inst/examples/foo.R". I could
also create scripts that only feature good example code and use "@example
.../inst/examples/foo.R" on it. No luck with that @example in general yet,
though.

I also tried appending the example code directly to the respective
post-roxygenized .Rd-file in the man directory (write "\examples{
<example_code>}"), but that doesn't get me anywhere either. Hitting "?foo"
after the package has been build and installed does show the examples then,
but the formatting is totally wrong (i.e. no "Examples" section header but
just dumped right after the Note section etc.). I'm kinda out of clues now.

Thanks for your comments though.

Cheers,
Janko
 
> Hadley
> 
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/


From maechler at stat.math.ethz.ch  Fri Nov  5 10:16:44 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 5 Nov 2010 10:16:44 +0100
Subject: [Rd] Documentation of option 'help.ports' not in help("options")
In-Reply-To: <AANLkTin0f_qrpjKH9PSaAZD6FQ7UkegY7-xVKRUryfs+@mail.gmail.com>
References: <AANLkTin0f_qrpjKH9PSaAZD6FQ7UkegY7-xVKRUryfs+@mail.gmail.com>
Message-ID: <19667.52092.695704.157501@lynne.math.ethz.ch>

>>>>> Henrik Bengtsson <hb at stat.berkeley.edu>
>>>>>     on Wed, 27 Oct 2010 12:54:15 -0700 writes:

    > FYI,
    > the option 'help.ports' is not document under help("options").  Should
    > it?  
yes, for completeness' sake; I've added it besides the other
help.<foobar> options.

    > It is documented under help("startDynamicHelp", package="tools").

    > This is for for R v2.13.0dev and Rv2.12.0.

Thank you, Henrik, for the notice.
Martin


From jhibschman at gmail.com  Fri Nov  5 12:59:07 2010
From: jhibschman at gmail.com (Johann Hibschman)
Date: Fri, 05 Nov 2010 06:59:07 -0500
Subject: [Rd] make error for R 2.13.0 (and 2.12.0)
References: <20101018003908.GA990@cs.toronto.edu> <4CBBF15E.6040104@gmail.com>
	<4CD0420C.40604@redhat.com>
Message-ID: <u1o8w18t20k.fsf@lx-chrateresearch01.citadelgroup.com>

"Tom \"spot\" Callaway" <tcallawa at redhat.com> writes:

> Full build log is here:
> http://koji.fedoraproject.org/koji/getfile?taskID=2571563&name=build.log
>
> Default gcc in RHEL 4 is 3.4.6-10, which has g77 rather than gfortran.
> It looks like this code no longer compiles properly with g77.
>
> Thankfully, RHEL 4 also includes a copy of gcc 4.1, so I should be able
> to work around this by using that instead.

Did you have any luck with this?  I'm also stuck on RHEL 4, also facing
that same error, but I've not been able to find gfortran anywhere on the
system.

Thanks,
Johann


From jeffrey.horner at gmail.com  Fri Nov  5 15:49:57 2010
From: jeffrey.horner at gmail.com (Jeffrey Horner)
Date: Fri, 5 Nov 2010 09:49:57 -0500
Subject: [Rd] Will PrintWarnings remain non static?
In-Reply-To: <AANLkTin9ufq=90ifN8jsSuJUey0_cBehOAuKOWiAvi6b@mail.gmail.com>
References: <AANLkTin9ufq=90ifN8jsSuJUey0_cBehOAuKOWiAvi6b@mail.gmail.com>
Message-ID: <AANLkTineQkJNx4gz-NGjtOyAHRnYizjM7AgNHXQ08XSf@mail.gmail.com>

Anyone have comments on this? PrintWarnings would be nice to utilize
for those embedding R.

Thanks,

Jeff

On Fri, Oct 1, 2010 at 4:49 PM, Jeffrey Horner <jeffrey.horner at gmail.com> wrote:
> Hi,
>
> The C function PrintWarnings is currently not in the C API, but it is
> declared non static in the svn trunk as of revision 53110 . As this is
> the only function that creates the last.warning object used by the R
> function warnings(), I think it would be useful for programs that
> embed R to be able to call it.
>
> So, will it remain non static, that is callable although it's not
> declared in the public C API?
>
> Thanks,
>
> Jeff
>



-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Fri Nov  5 16:44:11 2010
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 5 Nov 2010 16:44:11 +0100
Subject: [Rd] Will PrintWarnings remain non static?
In-Reply-To: <AANLkTineQkJNx4gz-NGjtOyAHRnYizjM7AgNHXQ08XSf@mail.gmail.com>
References: <AANLkTin9ufq=90ifN8jsSuJUey0_cBehOAuKOWiAvi6b@mail.gmail.com>
	<AANLkTineQkJNx4gz-NGjtOyAHRnYizjM7AgNHXQ08XSf@mail.gmail.com>
Message-ID: <201011051644.15003.thomas.friedrichsmeier@ruhr-uni-bochum.de>

On Friday 05 November 2010, Jeffrey Horner wrote:
> Anyone have comments on this? PrintWarnings would be nice to utilize
> for those embedding R.

I had missed your previous post.

Rf_PrintWarnings is pretty useful when embedding R, indeed. We do use it in 
RKWard. So I would certainly appreciate if it could be promoted into the 
public C API.

Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101105/8deaaf3f/attachment.bin>

From jgarcia at ija.csic.es  Fri Nov  5 22:22:27 2010
From: jgarcia at ija.csic.es (jgarcia at ija.csic.es)
Date: Fri, 5 Nov 2010 22:22:27 +0100 (CET)
Subject: [Rd] Bug in read.table?
In-Reply-To: <4CD1A6BE.3020801@yorku.ca>
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
Message-ID: <1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>

Hi,

I'm writting to this list as I'm puzzled about the behaviour of
read.table(). It is hard to believe that there is a bug in this utils'
function, but for my:

R version 2.12.0 alpha (2010-09-28 r53056)

I'm using scan and read.table to read a number of files, which are as:

---

Project:     Murta Sonda
Program:     GrafNav Version 8.30.1007
Profile:     javier
Source:      GPS Epochs(Combined)
ProcessInfo: Run (1) by Unknown on 11/04/2010 at 19:05:17

Datum:       WGS84, (processing datum)
Master 1:    Name LaMurta, Status ENABLED
             Antenna height 2.066 m, to L1-PC (NOV702GG, MeasDist 1.980 m
to mark/ARP)
             Position 37 49 38.15069, -1 12 27.55445, 368.197 m (WGS84,
Ellipsoidal hgt)
Remote:      Antenna height 1.781 m, to L1-PC (NOV702GG, MeasDist 1.695 m
to mark/ARP)
UTC Offset:  15 s
Local time:  +2.0 h, CEST [Central European Savings Time]
Geoid:       EGM2008-World.wpg (Absolute correction)

      Latitude      Longitude LonTextLoTextLongitudTextL
LatTextLaTextLatitudeTextL        H-Ell        H-MSL LocalUTCDa   
LocalUTC
         (Deg)          (Deg) (DeMi   (Sec)  (DeMi   (Sec)           (m)  
       (m)      (DMY)       (HMS)
 37.8275120694  -1.2077972583 001?12'28.07013"W 037?49'39.04345"N     
368.998      318.059 25/10/2010    16:59:00
 37.8275121083  -1.2077974806 001?12'28.07093"W 037?49'39.04359"N     
368.994      318.055 25/10/2010    16:59:15
 37.8275118539  -1.2077974338 001?12'28.07076"W 037?49'39.04267"N     
368.997      318.058 25/10/2010    16:59:30
 37.8275119923  -1.2077974626 001?12'28.07087"W 037?49'39.04317"N     
368.998      318.060 25/10/2010    16:59:45
 37.8275323099  -1.2078075891 001?12'28.10732"W 037?49'39.11632"N     
368.869      317.930 25/10/2010    17:00:00
 37.8275323374  -1.2078077002 001?12'28.10772"W 037?49'39.11641"N     
368.866      317.927 25/10/2010    17:00:15
 37.8275325076  -1.2078075314 001?12'28.10711"W 037?49'39.11703"N     
368.859      317.920 25/10/2010    17:00:30
 37.8275325306  -1.2078075056 001?12'28.10702"W 037?49'39.11711"N     
368.861      317.922 25/10/2010    17:00:45
 37.8275323639  -1.2078075917 001?12'28.10733"W 037?49'39.11651"N     
368.853      317.914 25/10/2010    17:01:00
 37.8275326222  -1.2078076861 001?12'28.10767"W 037?49'39.11744"N     
368.857      317.918 25/10/2010    17:01:15
---

with a number of different records for each file.

To read the data I'm using:

---
 dat.names <- scan(file.path("path_and_filename"),
                   what="character",
                   skip = 16, nlines=1)
 if(length(dat.names) != 8){
    stop("Input file seems to be wrong!")}

 dat <- read.table(file.path("path_and_filename),
                   header=FALSE, col.names=dat.names,
                   skip = 18, as.is=TRUE, blank.lines.skip=FALSE)
---
and systematically, I'm obtaining a number of repeated records at the
starting of the input table (6 in this example). It is easily seen by
looking at the field "LocalUTC":

> dat
   Latitude Longitude LonTextLoTextLongitudTextL
LatTextLaTextLatitudeTextL   H.Ell   H.MSL LocalUTCDa LocalUTC
1  37.82753 -1.207808          001?12'28.10732"W         
037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
2  37.82753 -1.207808          001?12'28.10772"W         
037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
3  37.82753 -1.207808          001?12'28.10711"W         
037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
4  37.82753 -1.207808          001?12'28.10702"W         
037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
5  37.82753 -1.207808          001?12'28.10733"W         
037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
6  37.82753 -1.207808          001?12'28.10767"W         
037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
7  37.82751 -1.207797          001?12'28.07013"W         
037?49'39.04345"N 368.998 318.059 25/10/2010 16:59:00
8  37.82751 -1.207797          001?12'28.07093"W         
037?49'39.04359"N 368.994 318.055 25/10/2010 16:59:15
9  37.82751 -1.207797          001?12'28.07076"W         
037?49'39.04267"N 368.997 318.058 25/10/2010 16:59:30
10 37.82751 -1.207797          001?12'28.07087"W         
037?49'39.04317"N 368.998 318.060 25/10/2010 16:59:45
11 37.82753 -1.207808          001?12'28.10732"W         
037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
12 37.82753 -1.207808          001?12'28.10772"W         
037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
13 37.82753 -1.207808          001?12'28.10711"W         
037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
14 37.82753 -1.207808          001?12'28.10702"W         
037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
15 37.82753 -1.207808          001?12'28.10733"W         
037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
16 37.82753 -1.207808          001?12'28.10767"W         
037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15

Thanks,

Javier
---


From cberry at tajo.ucsd.edu  Sat Nov  6 01:17:57 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Fri, 5 Nov 2010 17:17:57 -0700
Subject: [Rd] Bug in read.table?
In-Reply-To: <1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
Message-ID: <Pine.LNX.4.64.1011051710470.5601@tajo.ucsd.edu>

On Fri, 5 Nov 2010, jgarcia at ija.csic.es wrote:

> Hi,
>
> I'm writting to this list as I'm puzzled about the behaviour of
> read.table(). It is hard to believe that there is a bug in this utils'
> function, but for my:
>
> R version 2.12.0 alpha (2010-09-28 r53056)
>
> I'm using scan and read.table to read a number of files, which are as:
>

There are line wraps here, so we can't just cut-and-paste.


> ---
>
> Project:     Murta Sonda
> Program:     GrafNav Version 8.30.1007
> Profile:     javier
> Source:      GPS Epochs(Combined)
> ProcessInfo: Run (1) by Unknown on 11/04/2010 at 19:05:17
>
> Datum:       WGS84, (processing datum)
> Master 1:    Name LaMurta, Status ENABLED
>             Antenna height 2.066 m, to L1-PC (NOV702GG, MeasDist 1.980 m
> to mark/ARP)
>             Position 37 49 38.15069, -1 12 27.55445, 368.197 m (WGS84,
> Ellipsoidal hgt)
> Remote:      Antenna height 1.781 m, to L1-PC (NOV702GG, MeasDist 1.695 m
> to mark/ARP)
> UTC Offset:  15 s
> Local time:  +2.0 h, CEST [Central European Savings Time]
> Geoid:       EGM2008-World.wpg (Absolute correction)
>
>      Latitude      Longitude LonTextLoTextLongitudTextL
> LatTextLaTextLatitudeTextL        H-Ell        H-MSL LocalUTCDa
> LocalUTC
>         (Deg)          (Deg) (DeMi   (Sec)  (DeMi   (Sec)           (m)
>       (m)      (DMY)       (HMS)
> 37.8275120694  -1.2077972583 001?12'28.07013"W 037?49'39.04345"N
> 368.998      318.059 25/10/2010    16:59:00
> 37.8275121083  -1.2077974806 001?12'28.07093"W 037?49'39.04359"N
> 368.994      318.055 25/10/2010    16:59:15
> 37.8275118539  -1.2077974338 001?12'28.07076"W 037?49'39.04267"N
> 368.997      318.058 25/10/2010    16:59:30
> 37.8275119923  -1.2077974626 001?12'28.07087"W 037?49'39.04317"N
> 368.998      318.060 25/10/2010    16:59:45
> 37.8275323099  -1.2078075891 001?12'28.10732"W 037?49'39.11632"N
> 368.869      317.930 25/10/2010    17:00:00
> 37.8275323374  -1.2078077002 001?12'28.10772"W 037?49'39.11641"N
> 368.866      317.927 25/10/2010    17:00:15
> 37.8275325076  -1.2078075314 001?12'28.10711"W 037?49'39.11703"N
> 368.859      317.920 25/10/2010    17:00:30
> 37.8275325306  -1.2078075056 001?12'28.10702"W 037?49'39.11711"N
> 368.861      317.922 25/10/2010    17:00:45
> 37.8275323639  -1.2078075917 001?12'28.10733"W 037?49'39.11651"N
> 368.853      317.914 25/10/2010    17:01:00
> 37.8275326222  -1.2078076861 001?12'28.10767"W 037?49'39.11744"N
> 368.857      317.918 25/10/2010    17:01:15
> ---
>

Uh, what about those quotes??

Using quote = '' yields 'dat' sans duplicates.

I'll leave it to others to decide if this is a bug.


> with a number of different records for each file.
>
> To read the data I'm using:
>
> ---
> dat.names <- scan(file.path("path_and_filename"),
>                   what="character",
>                   skip = 16, nlines=1)
> if(length(dat.names) != 8){
>    stop("Input file seems to be wrong!")}
>
> dat <- read.table(file.path("path_and_filename),
>                   header=FALSE, col.names=dat.names,
>                   skip = 18, as.is=TRUE, blank.lines.skip=FALSE)
> ---
> and systematically, I'm obtaining a number of repeated records at the
> starting of the input table (6 in this example). It is easily seen by
> looking at the field "LocalUTC":

Or looking at duplicated(dat)

HTH,

Chuck


>
>> dat
>   Latitude Longitude LonTextLoTextLongitudTextL
> LatTextLaTextLatitudeTextL   H.Ell   H.MSL LocalUTCDa LocalUTC
> 1  37.82753 -1.207808          001?12'28.10732"W
> 037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
> 2  37.82753 -1.207808          001?12'28.10772"W
> 037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
> 3  37.82753 -1.207808          001?12'28.10711"W
> 037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
> 4  37.82753 -1.207808          001?12'28.10702"W
> 037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
> 5  37.82753 -1.207808          001?12'28.10733"W
> 037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
> 6  37.82753 -1.207808          001?12'28.10767"W
> 037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
> 7  37.82751 -1.207797          001?12'28.07013"W
> 037?49'39.04345"N 368.998 318.059 25/10/2010 16:59:00
> 8  37.82751 -1.207797          001?12'28.07093"W
> 037?49'39.04359"N 368.994 318.055 25/10/2010 16:59:15
> 9  37.82751 -1.207797          001?12'28.07076"W
> 037?49'39.04267"N 368.997 318.058 25/10/2010 16:59:30
> 10 37.82751 -1.207797          001?12'28.07087"W
> 037?49'39.04317"N 368.998 318.060 25/10/2010 16:59:45
> 11 37.82753 -1.207808          001?12'28.10732"W
> 037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
> 12 37.82753 -1.207808          001?12'28.10772"W
> 037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
> 13 37.82753 -1.207808          001?12'28.10711"W
> 037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
> 14 37.82753 -1.207808          001?12'28.10702"W
> 037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
> 15 37.82753 -1.207808          001?12'28.10733"W
> 037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
> 16 37.82753 -1.207808          001?12'28.10767"W
> 037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
>
> Thanks,
>
> Javier
> ---
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From tplate at acm.org  Sun Nov  7 17:17:37 2010
From: tplate at acm.org (Tony Plate)
Date: Sun, 07 Nov 2010 11:17:37 -0500
Subject: [Rd] Bug in read.table?
In-Reply-To: <1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
References: <4CD1674E.6070807@yorku.ca>
	<002701cb7b65$5a516c30$0ef44490$@ca>	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
Message-ID: <4CD6D121.1020402@acm.org>

The problem has to do with the quote characters in the data (R is probably interpreting the 'minutes' and 'seconds' as delimiter characters).

With a smaller data file, I can reproduce the strange behavior.

read.table() can read the data correctly if given quote="" to disable the interpretation of quote chars.

Contents of tmp2.txt:
  37.8275120694  -1.2077972583 001?12'28.07013"W 037?49'39.04345"N
  37.8275121083  -1.2077974806 001?12'28.07093"W 037?49'39.04359"N
  37.8275118539  -1.2077974338 001?12'28.07076"W 037?49'39.04267"N
  37.8275119923  -1.2077974626 001?12'28.07087"W 037?49'39.04317"N


 > read.table(file.path("tmp2.txt"), header=FALSE, as.is=TRUE)
         V1        V2                V3                V4
1 37.82751 -1.207797 001?12'28.07076"W 037?49'39.04267"N
2 37.82751 -1.207797 001?12'28.07087"W 037?49'39.04317"N
3 37.82751 -1.207797 001?12'28.07013"W 037?49'39.04345"N
4 37.82751 -1.207797 001?12'28.07093"W 037?49'39.04359"N
5 37.82751 -1.207797 001?12'28.07076"W 037?49'39.04267"N
6 37.82751 -1.207797 001?12'28.07087"W 037?49'39.04317"N
Warning message:
In read.table(file.path("tmp2.txt"), header = FALSE, as.is = TRUE) :
   incomplete final line found by readTableHeader on 'tmp2.txt'
 > read.table(file.path("tmp2.txt"), header=FALSE, as.is=TRUE, quote="")
         V1        V2                V3                V4
1 37.82751 -1.207797 001?12'28.07013"W 037?49'39.04345"N
2 37.82751 -1.207797 001?12'28.07093"W 037?49'39.04359"N
3 37.82751 -1.207797 001?12'28.07076"W 037?49'39.04267"N
4 37.82751 -1.207797 001?12'28.07087"W 037?49'39.04317"N
 >

The docs for read.table() direct the reader to the docs for scan() regarding the behavior with embedded quote chars.  The behavior of read.table() on this data with the default quote chars is puzzling though.

-- Tony Plate

On 11/5/2010 5:22 PM, jgarcia at ija.csic.es wrote:
> Hi,
>
> I'm writting to this list as I'm puzzled about the behaviour of
> read.table(). It is hard to believe that there is a bug in this utils'
> function, but for my:
>
> R version 2.12.0 alpha (2010-09-28 r53056)
>
> I'm using scan and read.table to read a number of files, which are as:
>
> ---
>
> Project:     Murta Sonda
> Program:     GrafNav Version 8.30.1007
> Profile:     javier
> Source:      GPS Epochs(Combined)
> ProcessInfo: Run (1) by Unknown on 11/04/2010 at 19:05:17
>
> Datum:       WGS84, (processing datum)
> Master 1:    Name LaMurta, Status ENABLED
>               Antenna height 2.066 m, to L1-PC (NOV702GG, MeasDist 1.980 m
> to mark/ARP)
>               Position 37 49 38.15069, -1 12 27.55445, 368.197 m (WGS84,
> Ellipsoidal hgt)
> Remote:      Antenna height 1.781 m, to L1-PC (NOV702GG, MeasDist 1.695 m
> to mark/ARP)
> UTC Offset:  15 s
> Local time:  +2.0 h, CEST [Central European Savings Time]
> Geoid:       EGM2008-World.wpg (Absolute correction)
>
>        Latitude      Longitude LonTextLoTextLongitudTextL
> LatTextLaTextLatitudeTextL        H-Ell        H-MSL LocalUTCDa
> LocalUTC
>           (Deg)          (Deg) (DeMi   (Sec)  (DeMi   (Sec)           (m)
>         (m)      (DMY)       (HMS)
>   37.8275120694  -1.2077972583 001?12'28.07013"W 037?49'39.04345"N
> 368.998      318.059 25/10/2010    16:59:00
>   37.8275121083  -1.2077974806 001?12'28.07093"W 037?49'39.04359"N
> 368.994      318.055 25/10/2010    16:59:15
>   37.8275118539  -1.2077974338 001?12'28.07076"W 037?49'39.04267"N
> 368.997      318.058 25/10/2010    16:59:30
>   37.8275119923  -1.2077974626 001?12'28.07087"W 037?49'39.04317"N
> 368.998      318.060 25/10/2010    16:59:45
>   37.8275323099  -1.2078075891 001?12'28.10732"W 037?49'39.11632"N
> 368.869      317.930 25/10/2010    17:00:00
>   37.8275323374  -1.2078077002 001?12'28.10772"W 037?49'39.11641"N
> 368.866      317.927 25/10/2010    17:00:15
>   37.8275325076  -1.2078075314 001?12'28.10711"W 037?49'39.11703"N
> 368.859      317.920 25/10/2010    17:00:30
>   37.8275325306  -1.2078075056 001?12'28.10702"W 037?49'39.11711"N
> 368.861      317.922 25/10/2010    17:00:45
>   37.8275323639  -1.2078075917 001?12'28.10733"W 037?49'39.11651"N
> 368.853      317.914 25/10/2010    17:01:00
>   37.8275326222  -1.2078076861 001?12'28.10767"W 037?49'39.11744"N
> 368.857      317.918 25/10/2010    17:01:15
> ---
>
> with a number of different records for each file.
>
> To read the data I'm using:
>
> ---
>   dat.names<- scan(file.path("path_and_filename"),
>                     what="character",
>                     skip = 16, nlines=1)
>   if(length(dat.names) != 8){
>      stop("Input file seems to be wrong!")}
>
>   dat<- read.table(file.path("path_and_filename),
>                     header=FALSE, col.names=dat.names,
>                     skip = 18, as.is=TRUE, blank.lines.skip=FALSE)
> ---
> and systematically, I'm obtaining a number of repeated records at the
> starting of the input table (6 in this example). It is easily seen by
> looking at the field "LocalUTC":
>
>> dat
>     Latitude Longitude LonTextLoTextLongitudTextL
> LatTextLaTextLatitudeTextL   H.Ell   H.MSL LocalUTCDa LocalUTC
> 1  37.82753 -1.207808          001?12'28.10732"W
> 037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
> 2  37.82753 -1.207808          001?12'28.10772"W
> 037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
> 3  37.82753 -1.207808          001?12'28.10711"W
> 037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
> 4  37.82753 -1.207808          001?12'28.10702"W
> 037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
> 5  37.82753 -1.207808          001?12'28.10733"W
> 037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
> 6  37.82753 -1.207808          001?12'28.10767"W
> 037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
> 7  37.82751 -1.207797          001?12'28.07013"W
> 037?49'39.04345"N 368.998 318.059 25/10/2010 16:59:00
> 8  37.82751 -1.207797          001?12'28.07093"W
> 037?49'39.04359"N 368.994 318.055 25/10/2010 16:59:15
> 9  37.82751 -1.207797          001?12'28.07076"W
> 037?49'39.04267"N 368.997 318.058 25/10/2010 16:59:30
> 10 37.82751 -1.207797          001?12'28.07087"W
> 037?49'39.04317"N 368.998 318.060 25/10/2010 16:59:45
> 11 37.82753 -1.207808          001?12'28.10732"W
> 037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
> 12 37.82753 -1.207808          001?12'28.10772"W
> 037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
> 13 37.82753 -1.207808          001?12'28.10711"W
> 037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
> 14 37.82753 -1.207808          001?12'28.10702"W
> 037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
> 15 37.82753 -1.207808          001?12'28.10733"W
> 037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
> 16 37.82753 -1.207808          001?12'28.10767"W
> 037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
>
> Thanks,
>
> Javier
> ---
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jgarcia at ija.csic.es  Sun Nov  7 22:56:28 2010
From: jgarcia at ija.csic.es (jgarcia at ija.csic.es)
Date: Sun, 7 Nov 2010 22:56:28 +0100 (CET)
Subject: [Rd] Bug in read.table?
In-Reply-To: <4CD6D121.1020402@acm.org>
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
	<4CD6D121.1020402@acm.org>
Message-ID: <2145.78.147.236.204.1289166988.squirrel@paleo.ija.csic.es>

Thanks. Yes, quote="" solves the problem.

I would never say, however, from the documentations, that this was causing
the duplicate records. Rather, I would have expected some kind of
warning/error message.

And, yes, I knew that, through duplicate(), R solves gracefully this
specific problem. Just thought this could be of interests for R devel.

Thanks to all,
Javier
---

The docs for read.table() direct the reader to the docs for scan()
regarding the
behavior with embedded quote chars.  The behavior of read.table() on this
data with
the default quote chars is puzzling though.


> The problem has to do with the quote characters in the data (R is probably
> interpreting the 'minutes' and 'seconds' as delimiter characters).
>
> With a smaller data file, I can reproduce the strange behavior.
>
> read.table() can read the data correctly if given quote="" to disable the
> interpretation of quote chars.
>
> Contents of tmp2.txt:
>   37.8275120694  -1.2077972583 001?12'28.07013"W 037?49'39.04345"N
>   37.8275121083  -1.2077974806 001?12'28.07093"W 037?49'39.04359"N
>   37.8275118539  -1.2077974338 001?12'28.07076"W 037?49'39.04267"N
>   37.8275119923  -1.2077974626 001?12'28.07087"W 037?49'39.04317"N
>
>
>  > read.table(file.path("tmp2.txt"), header=FALSE, as.is=TRUE)
>          V1        V2                V3                V4
> 1 37.82751 -1.207797 001?12'28.07076"W 037?49'39.04267"N
> 2 37.82751 -1.207797 001?12'28.07087"W 037?49'39.04317"N
> 3 37.82751 -1.207797 001?12'28.07013"W 037?49'39.04345"N
> 4 37.82751 -1.207797 001?12'28.07093"W 037?49'39.04359"N
> 5 37.82751 -1.207797 001?12'28.07076"W 037?49'39.04267"N
> 6 37.82751 -1.207797 001?12'28.07087"W 037?49'39.04317"N
> Warning message:
> In read.table(file.path("tmp2.txt"), header = FALSE, as.is = TRUE) :
>    incomplete final line found by readTableHeader on 'tmp2.txt'
>  > read.table(file.path("tmp2.txt"), header=FALSE, as.is=TRUE, quote="")
>          V1        V2                V3                V4
> 1 37.82751 -1.207797 001?12'28.07013"W 037?49'39.04345"N
> 2 37.82751 -1.207797 001?12'28.07093"W 037?49'39.04359"N
> 3 37.82751 -1.207797 001?12'28.07076"W 037?49'39.04267"N
> 4 37.82751 -1.207797 001?12'28.07087"W 037?49'39.04317"N
>  >
>
> The docs for read.table() direct the reader to the docs for scan()
> regarding the behavior with embedded quote chars.  The behavior of
> read.table() on this data with the default quote chars is puzzling though.
>
> -- Tony Plate
>
> On 11/5/2010 5:22 PM, jgarcia at ija.csic.es wrote:
>> Hi,
>>
>> I'm writting to this list as I'm puzzled about the behaviour of
>> read.table(). It is hard to believe that there is a bug in this utils'
>> function, but for my:
>>
>> R version 2.12.0 alpha (2010-09-28 r53056)
>>
>> I'm using scan and read.table to read a number of files, which are as:
>>
>> ---
>>
>> Project:     Murta Sonda
>> Program:     GrafNav Version 8.30.1007
>> Profile:     javier
>> Source:      GPS Epochs(Combined)
>> ProcessInfo: Run (1) by Unknown on 11/04/2010 at 19:05:17
>>
>> Datum:       WGS84, (processing datum)
>> Master 1:    Name LaMurta, Status ENABLED
>>               Antenna height 2.066 m, to L1-PC (NOV702GG, MeasDist 1.980
>> m
>> to mark/ARP)
>>               Position 37 49 38.15069, -1 12 27.55445, 368.197 m (WGS84,
>> Ellipsoidal hgt)
>> Remote:      Antenna height 1.781 m, to L1-PC (NOV702GG, MeasDist 1.695
>> m
>> to mark/ARP)
>> UTC Offset:  15 s
>> Local time:  +2.0 h, CEST [Central European Savings Time]
>> Geoid:       EGM2008-World.wpg (Absolute correction)
>>
>>        Latitude      Longitude LonTextLoTextLongitudTextL
>> LatTextLaTextLatitudeTextL        H-Ell        H-MSL LocalUTCDa
>> LocalUTC
>>           (Deg)          (Deg) (DeMi   (Sec)  (DeMi   (Sec)
>> (m)
>>         (m)      (DMY)       (HMS)
>>   37.8275120694  -1.2077972583 001?12'28.07013"W 037?49'39.04345"N
>> 368.998      318.059 25/10/2010    16:59:00
>>   37.8275121083  -1.2077974806 001?12'28.07093"W 037?49'39.04359"N
>> 368.994      318.055 25/10/2010    16:59:15
>>   37.8275118539  -1.2077974338 001?12'28.07076"W 037?49'39.04267"N
>> 368.997      318.058 25/10/2010    16:59:30
>>   37.8275119923  -1.2077974626 001?12'28.07087"W 037?49'39.04317"N
>> 368.998      318.060 25/10/2010    16:59:45
>>   37.8275323099  -1.2078075891 001?12'28.10732"W 037?49'39.11632"N
>> 368.869      317.930 25/10/2010    17:00:00
>>   37.8275323374  -1.2078077002 001?12'28.10772"W 037?49'39.11641"N
>> 368.866      317.927 25/10/2010    17:00:15
>>   37.8275325076  -1.2078075314 001?12'28.10711"W 037?49'39.11703"N
>> 368.859      317.920 25/10/2010    17:00:30
>>   37.8275325306  -1.2078075056 001?12'28.10702"W 037?49'39.11711"N
>> 368.861      317.922 25/10/2010    17:00:45
>>   37.8275323639  -1.2078075917 001?12'28.10733"W 037?49'39.11651"N
>> 368.853      317.914 25/10/2010    17:01:00
>>   37.8275326222  -1.2078076861 001?12'28.10767"W 037?49'39.11744"N
>> 368.857      317.918 25/10/2010    17:01:15
>> ---
>>
>> with a number of different records for each file.
>>
>> To read the data I'm using:
>>
>> ---
>>   dat.names<- scan(file.path("path_and_filename"),
>>                     what="character",
>>                     skip = 16, nlines=1)
>>   if(length(dat.names) != 8){
>>      stop("Input file seems to be wrong!")}
>>
>>   dat<- read.table(file.path("path_and_filename),
>>                     header=FALSE, col.names=dat.names,
>>                     skip = 18, as.is=TRUE, blank.lines.skip=FALSE)
>> ---
>> and systematically, I'm obtaining a number of repeated records at the
>> starting of the input table (6 in this example). It is easily seen by
>> looking at the field "LocalUTC":
>>
>>> dat
>>     Latitude Longitude LonTextLoTextLongitudTextL
>> LatTextLaTextLatitudeTextL   H.Ell   H.MSL LocalUTCDa LocalUTC
>> 1  37.82753 -1.207808          001?12'28.10732"W
>> 037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
>> 2  37.82753 -1.207808          001?12'28.10772"W
>> 037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
>> 3  37.82753 -1.207808          001?12'28.10711"W
>> 037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
>> 4  37.82753 -1.207808          001?12'28.10702"W
>> 037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
>> 5  37.82753 -1.207808          001?12'28.10733"W
>> 037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
>> 6  37.82753 -1.207808          001?12'28.10767"W
>> 037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
>> 7  37.82751 -1.207797          001?12'28.07013"W
>> 037?49'39.04345"N 368.998 318.059 25/10/2010 16:59:00
>> 8  37.82751 -1.207797          001?12'28.07093"W
>> 037?49'39.04359"N 368.994 318.055 25/10/2010 16:59:15
>> 9  37.82751 -1.207797          001?12'28.07076"W
>> 037?49'39.04267"N 368.997 318.058 25/10/2010 16:59:30
>> 10 37.82751 -1.207797          001?12'28.07087"W
>> 037?49'39.04317"N 368.998 318.060 25/10/2010 16:59:45
>> 11 37.82753 -1.207808          001?12'28.10732"W
>> 037?49'39.11632"N 368.869 317.930 25/10/2010 17:00:00
>> 12 37.82753 -1.207808          001?12'28.10772"W
>> 037?49'39.11641"N 368.866 317.927 25/10/2010 17:00:15
>> 13 37.82753 -1.207808          001?12'28.10711"W
>> 037?49'39.11703"N 368.859 317.920 25/10/2010 17:00:30
>> 14 37.82753 -1.207808          001?12'28.10702"W
>> 037?49'39.11711"N 368.861 317.922 25/10/2010 17:00:45
>> 15 37.82753 -1.207808          001?12'28.10733"W
>> 037?49'39.11651"N 368.853 317.914 25/10/2010 17:01:00
>> 16 37.82753 -1.207808          001?12'28.10767"W
>> 037?49'39.11744"N 368.857 317.918 25/10/2010 17:01:15
>>
>> Thanks,
>>
>> Javier
>> ---
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From bbolker at gmail.com  Sun Nov  7 23:04:12 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 7 Nov 2010 22:04:12 +0000 (UTC)
Subject: [Rd] Bug in read.table?
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
	<4CD6D121.1020402@acm.org>
	<2145.78.147.236.204.1289166988.squirrel@paleo.ija.csic.es>
Message-ID: <loom.20101107T225942-16@post.gmane.org>

 <jgarcia <at> ija.csic.es> writes:

> 
> Thanks. Yes, quote="" solves the problem.
> 
> I would never say, however, from the documentations, that this was causing
> the duplicate records. Rather, I would have expected some kind of
> warning/error message.
> 
> And, yes, I knew that, through duplicate(), R solves gracefully this
> specific problem. Just thought this could be of interests for R devel.
> 

  A bit of a meta- point here: there may indeed be a bug here
(it's the kind of obscure "corner case" that someone may not have
tested), but it's unlikely to get noted as such and fixed unless you
can come up with a clear analysis of what is happening and how the
misinterpretation of quote characters is leading to duplication of
records. (You, or someone else -- recognizing that this may be beyond
your skill level.  It might be that 'just' very careful thought
and analysis of the behavior described in the documentation would
explain this, or one might have to dig through source code in R or C.)
Problems with unescaped/unrecognized quote characters are very
common.

 Otherwise, this will likely be dismissed as a ("doctor, it hurts
when I do this"; "well then, don't do that!") sort of situation.

  Ben Bolker


From bbolker at gmail.com  Mon Nov  8 00:38:18 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 7 Nov 2010 23:38:18 +0000 (UTC)
Subject: [Rd] Bug in read.table?
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
	<4CD6D121.1020402@acm.org>
	<2145.78.147.236.204.1289166988.squirrel@paleo.ija.csic.es>
	<loom.20101107T225942-16@post.gmane.org>
Message-ID: <loom.20101108T003515-462@post.gmane.org>

Ben Bolker <bbolker <at> gmail.com> writes:

> 
>  <jgarcia <at> ija.csic.es> writes:
> 
> > 
> > Thanks. Yes, quote="" solves the problem.
> > 
> > I would never say, however, from the documentations, that this was causing
> > the duplicate records. Rather, I would have expected some kind of
> > warning/error message.
> > 
> > And, yes, I knew that, through duplicate(), R solves gracefully this
> > specific problem. Just thought this could be of interests for R devel.
> > 
> 
>   A bit of a meta- point here: there may indeed be a bug here
> (it's the kind of obscure "corner case" that someone may not have
> tested), but it's unlikely to get noted as such and fixed unless you
> can come up with a clear analysis of what is happening and how the
> misinterpretation of quote characters is leading to duplication of
> records. (You, or someone else -- recognizing that this may be beyond
> your skill level.  It might be that 'just' very careful thought
> and analysis of the behavior described in the documentation would
> explain this, or one might have to dig through source code in R or C.)
> Problems with unescaped/unrecognized quote characters are very
> common.
> 
>  Otherwise, this will likely be dismissed as a ("doctor, it hurts
> when I do this"; "well then, don't do that!") sort of situation.
> 
>   Ben Bolker

  Following up on my own point: 

    The bottom line is that the internal readTableHead() command
handles newlines within quoted strings differently from scan().

  Explanation:

a simpler file that replicates the problem is

a b'c"d"e
f g'h"i"j
k l'm"n"o 

(didn't want to try reading this from a textConnection --
escaping all the quotes properly would have driven me nuts).

 One of the first things that happens in read.table is that
the first few lines are read with readTableHead:

  lines <- .Internal(readTableHead(file, nlines, comment.char, 
       blank.lines.skip, quote, sep))

  in this case, this reads the first two lines as one line;
the single quote at pos. 4 of the first line closes on pos.
4 of the second line, preventing the first new line from
ending a line.

  R then pushes back two copies of the lines that have
been read (this is normal behavior; I don't quite follow the
logic).

  The rest of the file is read with scan(), 1 line at a time.
However, there is the discrepancy between the way
that readTableHead interprets new lines in the middle of
quoted strings (it ignores them) and the way that scan()
interprets them (it takes them as the end of the quoted string).

In particular, if the  file "tmp3.txt" is as shown above, then
the command

.Internal(readTableHead(file("tmp3.txt"),nlines=1L,"#",FALSE,quote="\"'",sep=""))

produces

[1] "a b'c\"d\"e\nf g'h\"i\"j"
 
(i.e. it grabs the first two lines, including the \n)

and 

scan(file("tmp3.txt"),nlines=1L,quote="\"'",what="")

produces

Read 2 items
[1] "a"         "b'c\"d\"e"

(it terminates the line in the middle of the string opened
by the single quote).

 I don't know what the consequences would be of changing
readTableHead to match scan()'s behavior, or how much
trouble it would be to do so.


From rpier001 at ucr.edu  Mon Nov  8 02:57:12 2010
From: rpier001 at ucr.edu (Russell Pierce)
Date: Sun, 7 Nov 2010 17:57:12 -0800
Subject: [Rd] Unexpected behavior with cat
Message-ID: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>

I am experiencing unexpected behavior with the command cat under
Window GUI builds of R version 2.12.0 (it does not seem to be an issue
in Rterm).  For example if I issue the command cat(70,"\r") I get back
text that looks like Asian characters.  If I highlight and copy that
text, it is the text I would regularly expect, e.g. the number 70 and
the prompt line.  Highlighting the text changes what is shown on the
screen, but the screen never displays the number 70.  This error is
not idiosyncratic to 70 but happens with a fairly wide range of
numbers.  Notably no error like this occurs when I use \n.  I use \r
for large simulation runs when I don't want my progress to spam the
display.

e.g.
for (i in 1:1000) {cat(i,"\r");flush.console();Sys.sleep(.100)}

sessionInfo() where I first saw the problem:
R version 2.12.0 (2010-10-15) on Windows Vista
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats???? graphics? grDevices utils???? datasets? methods?? base

Also experienced here:
R version 2.12.0 (2010-10-15) on Windows XP
R version 2.12.0 Patched (2010-11-04 r53530) on Windows Vista
R version 2.13.0 Under development (unstable) (2010-11-04 r53530) on
Windows Vista

But not here:
Not under R version 2.10.1 (2009-12-14) on Windows XP

If this is expected behavior would you please kindly explain it to me?
 I am not a member of this list, so please address replies both to my
email address and (if appropriate) the list.

Best,

Russell Pierce


From stefan.theussl at wu.ac.at  Mon Nov  8 13:59:21 2010
From: stefan.theussl at wu.ac.at (Stefan Theussl)
Date: Mon, 08 Nov 2010 13:59:21 +0100
Subject: [Rd] R-Forge Downtime
Message-ID: <4CD7F429.3090609@wu.ac.at>

To all R-Forge developers/users:

Please note the short (<30min.) R-Forge downtime today at 18:00 CET.

Details:

We need to extend disk space of the system hosting the core R-Forge
components. This will lead to a short (<30min.) downtime of R-Forge
today at 18:00 CET. This is necessary due to the unreliability of
R-Forge especially on weekends, when log files have to be copied to a
backup location. Sometimes the system got unresponsive for a couple of
hours from sunday late evening to monday morning.

We are sorry for the inconvenience caused.

Best regards,
The R-Forge Administration and Development Team


From hadley at rice.edu  Mon Nov  8 14:29:40 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 8 Nov 2010 07:29:40 -0600
Subject: [Rd] col2rgb feature request
Message-ID: <AANLkTingumGeymqP0_WVF2Nj-h0m4c-2H+j1n=124AzU@mail.gmail.com>

Small feature request for col2rgb: could it preserve missing values? Currently:

> col2rgb(NA)
      [,1]
red    255
green  255
blue   255

Which is frustrating when you're working with vectors of colors that
might include transparent colours.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From spencer.graves at structuremonitoring.com  Mon Nov  8 15:44:29 2010
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Mon, 08 Nov 2010 06:44:29 -0800
Subject: [Rd] R-Forge Downtime
In-Reply-To: <4CD7F429.3090609@wu.ac.at>
References: <4CD7F429.3090609@wu.ac.at>
Message-ID: <4CD80CCD.7070104@structuremonitoring.com>

Hi, Stefan:  Thanks for all your hard work to make R-Forge available for 
the rest of us.  Best Wishes, Spencer


On 11/8/2010 4:59 AM, Stefan Theussl wrote:
> To all R-Forge developers/users:
>
> Please note the short (<30min.) R-Forge downtime today at 18:00 CET.
>
> Details:
>
> We need to extend disk space of the system hosting the core R-Forge
> components. This will lead to a short (<30min.) downtime of R-Forge
> today at 18:00 CET. This is necessary due to the unreliability of
> R-Forge especially on weekends, when log files have to be copied to a
> backup location. Sometimes the system got unresponsive for a couple of
> hours from sunday late evening to monday morning.
>
> We are sorry for the inconvenience caused.
>
> Best regards,
> The R-Forge Administration and Development Team
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


-- 
Spencer Graves, PE, PhD
President and Chief Operating Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567


From adrian at waddell.ch  Mon Nov  8 16:41:13 2010
From: adrian at waddell.ch (Adrian Waddell)
Date: Mon, 08 Nov 2010 10:41:13 -0500
Subject: [Rd] Compiling Tcl extension C Code for an R package
Message-ID: <4CD81A19.1040109@waddell.ch>

Dear R Community,

I'm working on an R package that needs resizing of images. I try to keep
dependencies of Tcl packages as little as possible, so I implemented the
Image Scaling procedure in C as a Tcl extension found here
http://wiki.tcl.tk/25685 .

Here a temporary download link of the slightly modified source

http://www.waddell.ch/RnavGraph/imagescale_adrian_85.c

The file works with the Tcl version 8.5. I've added the gcc compile
commands I use for Linux, OSX and Windows (minGW) at the beginning of
the file.

I'm  struggling to dynamically load the extension under Windows 7. That
is i tried to use

load imgscale.dll

where under Linux and OSX I use

load ./imgscale[info sharedlibextension]

Now my Questions: does anybody know how to deal with this C extension
such that when I distribute the R-package over CRAN it will work on
every OS? This includes the question why I can not load the extension in
Windows. Is there an R package out there which uses a C extension for a
Tcl function from which I could learn how to do this?

Thanks,

Adrian


From dtenenba at fhcrc.org  Mon Nov  8 21:14:51 2010
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Mon, 8 Nov 2010 12:14:51 -0800
Subject: [Rd] incorrect DLL path for Rbitmap.dll on Windows
Message-ID: <AANLkTimT5fYqfHCu5vTe+ZV2+_p9VgNXuAuX7fRC4eyi@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101108/f6e88a84/attachment.pl>

From murdoch.duncan at gmail.com  Mon Nov  8 21:35:33 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 08 Nov 2010 15:35:33 -0500
Subject: [Rd] incorrect DLL path for Rbitmap.dll on Windows
In-Reply-To: <AANLkTimT5fYqfHCu5vTe+ZV2+_p9VgNXuAuX7fRC4eyi@mail.gmail.com>
References: <AANLkTimT5fYqfHCu5vTe+ZV2+_p9VgNXuAuX7fRC4eyi@mail.gmail.com>
Message-ID: <4CD85F15.9090005@gmail.com>

On 08/11/2010 3:14 PM, Dan Tenenbaum wrote:
> Hello,
>
> I think there is a problem in recent devel builds of R on Windows with
> various devices from the grDevices package.

Thanks, I'll look into this.

Duncan Murdoch

> For example:
>
>> capabilities()
>      jpeg      png     tiff    tcltk      X11     aqua http/ftp  sockets
>      TRUE     TRUE     TRUE     TRUE    FALSE    FALSE     TRUE     TRUE
>    libxml     fifo   cledit    iconv      NLS  profmem    cairo
>      TRUE    FALSE     TRUE     TRUE     TRUE     TRUE    FALSE
>> jpeg()
> Error in jpeg() : unable to start jpeg() device
> In addition: Warning messages:
> 1: In jpeg() : Unable to load Rbitmap.dll
> 2: In jpeg() : opening device failed
>
> In the GUI version, a dialog appears saying:
> Unable to load
> 'C:\PROGRA~1\R\R-213~1.0DE\library\grDevices\libs\Rbitmap.dll'
>
> It seems that there should be an architecture folder (i386 or x64) after
> "libs", because that is where the dll is located.
>
> Same thing happens with png(), tiff(), etc.
>
>> sessionInfo()
> R version 2.13.0 Under development (unstable) (2010-11-07 r53537)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> Thanks!
> Dan
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From amredd at gmail.com  Mon Nov  8 22:02:18 2010
From: amredd at gmail.com (Andrew Redd)
Date: Mon, 8 Nov 2010 14:02:18 -0700
Subject: [Rd] Segmentation Fault when using CUDA
Message-ID: <AANLkTimfrt+cVhL1LsKEse1tDycY6Hk282caSJqp+8WL@mail.gmail.com>

I'm developing packages with CUDA, and I'm running into a problem with
memory allocation.  Since CUDA involves memory on the GPU device it
requires that the program handle memory allocation and deallocation
separately from R.

The simplest case of allocating a char and then deallocating causes a
segmentation fault when R closes.  Not on garbage collection but only
on exit.  Is there anything in the R internals that explain why this
is happening?

The relevant C++ code is
---
void gpualloctest(){
       char * _a;
       cudaMalloc(&_a,sizeof(char));
       cudaFree(_a);
       _a=NULL;
}
--- from gpu.cu
gputest<-function(){
       cat("testing allocation on gpu\n")
       Module('test','gputest')$gpualloctest()
       cat("Test successful\n")
       cat("Collecting Garbage\n")
       gc()
       cat("done.\n")
}
--- from gputest.R

As you can see Rcpp is used to interface with the C++ code, but the
Rcpp is not the problem, but happened to be convenient to use to get
the configure scripts right for the CUDA cu files.

The results from running "valgrind Rscript testgpu.R" are linked to in
testgpu.log but do not show anything interesting.

Can anyone give any insight?

Thanks,
Andrew Redd

Links to files:
http://andrewredd.us/gputest/testgpu.R
http://andrewredd.us/gputest/testgpu.Rout
http://andrewredd.us/gputest/gputest_1.0.tar.gz
http://andrewredd.us/gputest/testgpu.log


From bbolker at gmail.com  Tue Nov  9 02:20:11 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 9 Nov 2010 01:20:11 +0000 (UTC)
Subject: [Rd] Bug in read.table?
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
	<4CD6D121.1020402@acm.org>
	<2145.78.147.236.204.1289166988.squirrel@paleo.ija.csic.es>
	<loom.20101107T225942-16@post.gmane.org>
	<loom.20101108T003515-462@post.gmane.org>
Message-ID: <loom.20101109T021750-294@post.gmane.org>

Ben Bolker <bbolker <at> gmail.com> writes:

>
>

   Can simplify this still farther:

a b'c
d e'f
g h'i


>  One of the first things that happens in read.table is that
> the first few lines are read with readTableHead:
> 
>   lines <- .Internal(readTableHead(file, nlines, comment.char, 
>        blank.lines.skip, quote, sep))
> 
  in this case, this reads the first two lines as one line;
the single quote at pos. 4 of the first line closes on pos.
4 of the second line, preventing the first new line from
ending a line.

  R then pushes back two copies of the lines that have
been read (this is normal behavior; I don't quite follow the
logic).
 
  The rest of the file is read with scan(), 1 line at a time.
However, there is the discrepancy between the way
that readTableHead interprets new lines in the middle of
quoted strings (it ignores them) and the way that scan()
interprets them (it takes them as the end of the quoted string).


From andreas at eckner.com  Mon Nov  8 23:47:31 2010
From: andreas at eckner.com (Andreas Eckner)
Date: Mon, 8 Nov 2010 17:47:31 -0500
Subject: [Rd] base::as.Date inconsistency/bug
Message-ID: <437CDD0389AD474EA376B9EFC9F2E2C8@mainuser>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101108/371abb29/attachment.pl>

From ripley at stats.ox.ac.uk  Tue Nov  9 11:00:42 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 9 Nov 2010 10:00:42 +0000 (GMT)
Subject: [Rd] base::as.Date inconsistency/bug
In-Reply-To: <437CDD0389AD474EA376B9EFC9F2E2C8@mainuser>
References: <437CDD0389AD474EA376B9EFC9F2E2C8@mainuser>
Message-ID: <alpine.LFD.2.00.1011090955230.9363@gannet.stats.ox.ac.uk>

Well, 2.11.0 is overdue for an update: see the posting guide.

You've confused the printed representation with the object.  If there 
is an issue, it is in the formatting (and hence printing) of 
fractional dates before the epoch ("1970-01-01 00:00").  As the help 
page says

      It is intended that the date should be an integer, but this is not
      enforced in the internal representation.  Fractional days will be
      ignored when printing.

and you've fallen foul of ignoring that warning.  I think it does 
actually work as documented, but it might confuse 
non-readers-of-help-pages less if it always rounded to the previous 
midnight, and R-patched now does that.

For your obsolete version of R, simply heed the warning and do not use 
fractional days.

On Mon, 8 Nov 2010, Andreas Eckner wrote:

> Dear all,
>
> I would like point out a potential bug (or at least inconsistency) in the
> way the R base package converts numeric numbers to dates. Specifically,
> consider the following two calls:
>
>> as.Date(0.5, origin="1969-12-31")
> [1] "1970-01-01"
>> as.Date(0.5, origin="1970-01-01")
> [1] "1970-01-01"
>
> As you can see, both calls produce the same output on the screen. Curiously,
> the output is NOT the same for other consecutive origins:
>
>> as.Date(0.5, origin="2009-12-31")
> [1] "2009-12-31"
>> as.Date(0.5, origin="2010-01-01")
> [1] "2010-01-01"
>
> Best regards,
> Andreas Eckner
>
>
> ----------------------
>> sessionInfo()
> R version 2.11.0 (2010-04-22)
> i386-pc-mingw32
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Tue Nov  9 16:53:20 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 09 Nov 2010 10:53:20 -0500
Subject: [Rd] incorrect DLL path for Rbitmap.dll on Windows
In-Reply-To: <AANLkTimT5fYqfHCu5vTe+ZV2+_p9VgNXuAuX7fRC4eyi@mail.gmail.com>
References: <AANLkTimT5fYqfHCu5vTe+ZV2+_p9VgNXuAuX7fRC4eyi@mail.gmail.com>
Message-ID: <4CD96E70.8050800@gmail.com>

On 08/11/2010 3:14 PM, Dan Tenenbaum wrote:
> Hello,
>
> I think there is a problem in recent devel builds of R on Windows with
> various devices from the grDevices package.

This should be fixed now, as of today's build.  Thanks for the report 
(and thanks to Brian Ripley for fixing it).

Duncan Murdoch

> For example:
>
> >  capabilities()
>      jpeg      png     tiff    tcltk      X11     aqua http/ftp  sockets
>      TRUE     TRUE     TRUE     TRUE    FALSE    FALSE     TRUE     TRUE
>    libxml     fifo   cledit    iconv      NLS  profmem    cairo
>      TRUE    FALSE     TRUE     TRUE     TRUE     TRUE    FALSE
> >  jpeg()
> Error in jpeg() : unable to start jpeg() device
> In addition: Warning messages:
> 1: In jpeg() : Unable to load Rbitmap.dll
> 2: In jpeg() : opening device failed
>
> In the GUI version, a dialog appears saying:
> Unable to load
> 'C:\PROGRA~1\R\R-213~1.0DE\library\grDevices\libs\Rbitmap.dll'
>
> It seems that there should be an architecture folder (i386 or x64) after
> "libs", because that is where the dll is located.
>
> Same thing happens with png(), tiff(), etc.
>
> >  sessionInfo()
> R version 2.13.0 Under development (unstable) (2010-11-07 r53537)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> Thanks!
> Dan
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hpages at fhcrc.org  Wed Nov 10 03:21:28 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Tue, 09 Nov 2010 18:21:28 -0800
Subject: [Rd] typo in ?eapply
Message-ID: <4CDA01A8.8050208@fhcrc.org>

Hi,

Found in ?eapply (in current R-devel):

\value{
   A named (unless \code{USE.NAMES = FALSE}) list.  Note that the order of
   the components is arbitrary for hashed environments: currently it will
   be in the order the name-value pairs were added for unhashed
                                                       ^^^^^^^^
                                                       hashed?
   environments.
}

This looks like a typo.

Thanks,
H.

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From ohri2007 at gmail.com  Wed Nov 10 09:08:38 2010
From: ohri2007 at gmail.com (Ajay Ohri)
Date: Wed, 10 Nov 2010 13:38:38 +0530
Subject: [Rd] R Applications for Force.com/ Salesforce
Message-ID: <AANLkTim++7huC6fb=fVmqcU0DDwL81CV3sD-iEhqM6A+@mail.gmail.com>

Dear List

Forgive me for the slightly off topic query

Force.com and Salesforce have many (1009) apps at
http://sites.force.com/appexchange/home  for cloud computing for
businesses, but very few forecasting and statistical simulation apps.

Example of Monte Carlo based app is here
http://sites.force.com/appexchange/listingDetail?listingId=a0N300000016cT9EAI#

These are like iPhone apps except meant for business purposes (I am
unaware if any university is offering salesforce.com integration
though google apps and amazon related research seems to be on)

Force.com uses a language called Apex  and you can see
http://wiki.developerforce.com/index.php/App_Logic and
http://wiki.developerforce.com/index.php/An_Introduction_to_Formulas
Apex is similar to R in that is OOPs

My question is are there any R packages or research in Force.com or
Salesforce.com Apps going on ( see SAS A new SAS data surveyor is
available to access data from the Customer Relationship Management
(CRM) software vendor Salesforce.com. at
http://support.sas.com/documentation/cdl/en/whatsnew/62580/HTML/default/viewer.htm#datasurveyorwhatsnew902.htm)

I am just doing research on cloud computing and R and needed this
info. Many thanks as always

Regards

Ajay Ohri
Delhi, India


Websites-
http://decisionstats.com
http://dudeofdata.com


Linkedin- www.linkedin.com/in/ajayohri


From rksh1 at cam.ac.uk  Wed Nov 10 10:53:30 2010
From: rksh1 at cam.ac.uk (Robin Hankin)
Date: Wed, 10 Nov 2010 09:53:30 +0000
Subject: [Rd] S4 package warning
Message-ID: <4CDA6B9A.6060709@cam.ac.uk>

Hello everyone.  R-2.12.0, suse linux 11.3.

I am debugging a package that uses S4 methods
and R CMD check gives the following warning:

> Warning in methods::findMethods(g, env) :
>   non-generic function 'mdm' given to findMethods()
> See the information on DESCRIPTION files in the chapter 'Creating R
> packages' of the 'Writing R Extensions' manual.

I don't see anything obvious in that part of the R-exts but
FWIW, here is my DESCRIPTION file:

> Package: multivator
> Type: Package
> Title: A multivariate emulator
> Version: 1.0-1
> Depends: R(>= 2.10.0), emulator, methods, utils
> Date: 2009-10-27
> Author: Robin K. S. Hankin
> Maintainer:  <hankin.robin_nospamAT_gmail.com>
> Description: A multivariate generalization of the emulator package
> License: GPL-2
> LazyLoad: yes


I think that the lines in question in my package are:

> setClass("mdm", # "mdm" == "multivariate design matrix"
>          representation = representation(
>            xold  = "matrix",
>            types = "factor"
>            )
>          )
>
>
> setGeneric("mdm",function(xold,types){standardGeneric("mdm")})
> setMethod("mdm",signature("matrix","factor"),function(xold, types){
>   new("mdm", xold=xold, types=types)
> } )

which appear to execute without warning on a virgin console.  In the
package, there are three
or four other S4 classes which are on the same footing as the mdm class,
but do not appear to generate a warning from R CMD check.
The same happens AFAICS on R-2.13, 53543

Can anyone advise on how to deal with the warning?

thank you

Robin




-- 
Robin K. S. Hankin
Uncertainty Analyst
University of Cambridge
19 Silver Street
Cambridge CB3 9EP
01223-764877


From spinuvit.list at gmail.com  Wed Nov 10 12:32:10 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Wed, 10 Nov 2010 12:32:10 +0100
Subject: [Rd] "[[" strips the S4 class for classes extending environment
Message-ID: <cpnaalho1mt.fsf@gmail.com>


Dear Developers,

A recently patched [[ for environment class returns a blank environment for a
children class:

setClass("myenv", contains = "environment")
#[1] "myenv"
env <- new("myenv")
class(env)
#[1] "myenv"
#attr(,"package")
#[1] ".GlobalEnv"
env[["a"]] <- 343
class(env)
[1] "environment"

It looks like not being an intended behavior.

Best, 
Vitalie.


From spinuvit.list at gmail.com  Wed Nov 10 13:49:19 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Wed, 10 Nov 2010 13:49:19 +0100
Subject: [Rd] callNextMethod fails with "$" generic
Message-ID: <cpnaalhfink.fsf@gmail.com>


Dear Developers,

callNextMethods does not work with "$"

setClass("mylist", contains = "list"):
setMethod("$",
          signature(x = "mylist"),
          function (x, name){
              cat("here:\n")
              callNextMethod()
          })

tl <- new("mylist")
tl[["x"]] <- 343

tl$x
#here:
#NULL


If I use callNextMethod(x=x, name=name)

this error is issued:

Error in function (classes, fdef, mtable)  :
  unable to find an inherited method for function "addNextMethod", for signature "function"

It must be something "$" specific. If the above is an expected behavior , how
should I call next method for "$" generic?

My info:
R version 2.12.0 Patched (2010-11-01 r53513)
Platform: i386-pc-mingw32/i386 (32-bit)

Same behavior for official R 2.12.0.

Thanks,
Vitalie.


From ripley at stats.ox.ac.uk  Wed Nov 10 14:02:46 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 10 Nov 2010 13:02:46 +0000 (GMT)
Subject: [Rd] typo in ?eapply
In-Reply-To: <4CDA01A8.8050208@fhcrc.org>
References: <4CDA01A8.8050208@fhcrc.org>
Message-ID: <alpine.LFD.2.00.1011101252270.16801@toucan.stats.ox.ac.uk>

On Tue, 9 Nov 2010, Herv? Pag?s wrote:

> Hi,
>
> Found in ?eapply (in current R-devel):
>
> \value{
>  A named (unless \code{USE.NAMES = FALSE}) list.  Note that the order of
>  the components is arbitrary for hashed environments: currently it will
>  be in the order the name-value pairs were added for unhashed
>                                                      ^^^^^^^^
>                                                      hashed?
>  environments.
> }
>
> This looks like a typo.

Only to someone who does not understand hashing.  Please try it for 
yourself:

e <- new.env(hash=TRUE)
assign("a", 1, e)
assign("ab", 2, e)
assign("abcde", 2, e)
assign("ac", 3, e)
assign("b", 4, e)
names(eapply(e, mean))

(and I get
[1] "a"     "b"     "abcde" "ab"    "ac"
)

>
> Thanks,
> H.
>
> -- 
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M2-B876
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fhcrc.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From JHZhang at mdanderson.org  Wed Nov 10 17:10:07 2010
From: JHZhang at mdanderson.org (Zhang,Jun)
Date: Wed, 10 Nov 2010 10:10:07 -0600
Subject: [Rd] FW: [R] R-2.12.0 problem on Solaris 10
Message-ID: <5685E4FBA752A441B1975A77A77CD64824DC2332AF@DCPWVMBXC1VS2.mdanderson.edu>

I used solstutio12.2 to compile a 32-bit R-2.12.0

CC="cc -xc99"
CPPFLAGS="-I/opt/csw/include" 
CFLAGS="-O -xlibmieee"
F77=f95
FFLAGS=-O4
CXX="CC -library=stlport4"
CXXFLAGS=-O
FC=f95
FCFLAGS=$FFLAGS
LDFLAGS="-L/opt/csw/lib" 
export CC CPPFLAGS CFLAGS F77 FFLAGS CXX CXXFLAGS FC FCFLAGS LDFLAGS
./configure --prefix=/apps/R-2.12.0 --with-tcl-config=/opt/csw/lib/tclConfig.sh --with-tk-config=/opt/csw/lib/tkConfig.sh --disable-nls --with-recommended-packages=no
Make
Make install
R
....
Platform: sparc-sun-solaris2.10 (32-bit)
....
> install.packages("Matrix")
....
Loading required package: Matrix

 *** caught segfault ***
address 3000000, cause 'memory not mapped'
Segmentation Fault - core dumped

The downloaded packages are in
        '/tmp/Rtmp10h8f8/downloaded_packages'
Updating HTML index of packages in '.Library'
Warning message:
In install.packages("Matrix") :
  installation of package 'Matrix' had non-zero exit status

I then removed all the optimization options and compiled again, got same results. The require(Matrix) will cause 'memory not mapped' error each time with a different address. Please help.

Jun


From hpages at fhcrc.org  Wed Nov 10 19:38:16 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 10 Nov 2010 10:38:16 -0800
Subject: [Rd] typo in ?eapply
In-Reply-To: <alpine.LFD.2.00.1011101252270.16801@toucan.stats.ox.ac.uk>
References: <4CDA01A8.8050208@fhcrc.org>
	<alpine.LFD.2.00.1011101252270.16801@toucan.stats.ox.ac.uk>
Message-ID: <4CDAE698.8070502@fhcrc.org>

On 11/10/2010 05:02 AM, Prof Brian Ripley wrote:
> On Tue, 9 Nov 2010, Herv? Pag?s wrote:
>
>> Hi,
>>
>> Found in ?eapply (in current R-devel):
>>
>> \value{
>> A named (unless \code{USE.NAMES = FALSE}) list. Note that the order of
>> the components is arbitrary for hashed environments: currently it will
>> be in the order the name-value pairs were added for unhashed
>> ^^^^^^^^
>> hashed?
>> environments.
>> }
>>
>> This looks like a typo.
>
> Only to someone who does not understand hashing. Please try it for
> yourself:
>
> e <- new.env(hash=TRUE)
> assign("a", 1, e)
> assign("ab", 2, e)
> assign("abcde", 2, e)
> assign("ac", 3, e)
> assign("b", 4, e)
> names(eapply(e, mean))
>
> (and I get
> [1] "a" "b" "abcde" "ab" "ac"
> )

The statement is about unhashed environment:

 > e <- new.env(hash=TRUE)
 > assign("b", 1L, e)
 > assign("a", 2L, e)
 > eapply(e, identity)
$a
[1] 2

$b
[1] 1

so it doesn't look like it's true either.

Thanks,
H.


>
>>
>> Thanks,
>> H.
>>
>> --
>> Herv? Pag?s
>>
>> Program in Computational Biology
>> Division of Public Health Sciences
>> Fred Hutchinson Cancer Research Center
>> 1100 Fairview Ave. N, M2-B876
>> P.O. Box 19024
>> Seattle, WA 98109-1024
>>
>> E-mail: hpages at fhcrc.org
>> Phone: (206) 667-5791
>> Fax: (206) 667-1319
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fhcrc.org  Wed Nov 10 19:42:53 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 10 Nov 2010 10:42:53 -0800
Subject: [Rd] typo in ?eapply
In-Reply-To: <4CDAE698.8070502@fhcrc.org>
References: <4CDA01A8.8050208@fhcrc.org>	<alpine.LFD.2.00.1011101252270.16801@toucan.stats.ox.ac.uk>
	<4CDAE698.8070502@fhcrc.org>
Message-ID: <4CDAE7AD.4070907@fhcrc.org>

On 11/10/2010 10:38 AM, Herv? Pag?s wrote:
> On 11/10/2010 05:02 AM, Prof Brian Ripley wrote:
>> On Tue, 9 Nov 2010, Herv? Pag?s wrote:
>>
>>> Hi,
>>>
>>> Found in ?eapply (in current R-devel):
>>>
>>> \value{
>>> A named (unless \code{USE.NAMES = FALSE}) list. Note that the order of
>>> the components is arbitrary for hashed environments: currently it will
>>> be in the order the name-value pairs were added for unhashed
>>> ^^^^^^^^
>>> hashed?
>>> environments.
>>> }
>>>
>>> This looks like a typo.
>>
>> Only to someone who does not understand hashing. Please try it for
>> yourself:
>>
>> e <- new.env(hash=TRUE)
>> assign("a", 1, e)
>> assign("ab", 2, e)
>> assign("abcde", 2, e)
>> assign("ac", 3, e)
>> assign("b", 4, e)
>> names(eapply(e, mean))
>>
>> (and I get
>> [1] "a" "b" "abcde" "ab" "ac"
>> )
>
> The statement is about unhashed environment:
>
>  > e <- new.env(hash=TRUE)
>  > assign("b", 1L, e)
>  > assign("a", 2L, e)
>  > eapply(e, identity)
> $a
> [1] 2
>
> $b
> [1] 1
>
> so it doesn't look like it's true either.

Sorry I try again:

 > e <- new.env(hash=FALSE)
 > assign("b", 1L, e)
 > assign("a", 2L, e)
 > eapply(e, identity)
$a
[1] 2

$b
[1] 1

pfffff!! Sorry for the noise... :-b

H.


>
> Thanks,
> H.
>
>
>>
>>>
>>> Thanks,
>>> H.
>>>
>>> --
>>> Herv? Pag?s
>>>
>>> Program in Computational Biology
>>> Division of Public Health Sciences
>>> Fred Hutchinson Cancer Research Center
>>> 1100 Fairview Ave. N, M2-B876
>>> P.O. Box 19024
>>> Seattle, WA 98109-1024
>>>
>>> E-mail: hpages at fhcrc.org
>>> Phone: (206) 667-5791
>>> Fax: (206) 667-1319
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fhcrc.org  Wed Nov 10 22:13:17 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 10 Nov 2010 13:13:17 -0800
Subject: [Rd] installed.packages Error: subscript out of bounds
Message-ID: <4CDB0AED.3030606@fhcrc.org>

Hi,

Today we've seen the following problem with the R-2.12 that we use
for our Windows builds:

   > installed.packages()
   Error: subscript out of bounds

After some investigation we discovered that the cause of this failure
was that 1 of the 890 packages currently installed on the machine
(Windows Server 2003 R2) had its DESCRIPTION file empty:

   E:\biocbld\bbs-2.7-bioc\R\library>ls -al DLBCL
   total 1
   drwxr-xr-x+ 1 biocbuild2 root   0 2010-11-08 14:11 .
   drwxr-xr-x+ 1 biocbuild2 root   0 2010-11-10 00:14 ..
   -rwxr-xr-x+ 1 biocbuild2 root   0 2010-11-08 14:11 DESCRIPTION
   -rwxr-xr-x+ 1 biocbuild2 root 357 2010-11-08 14:11 INDEX
   drwxr-xr-x+ 1 biocbuild2 root   0 2010-11-08 14:11 data
   drwxr-xr-x+ 1 biocbuild2 root   0 2010-11-08 14:11 help
   drwxr-xr-x+ 1 biocbuild2 root   0 2010-11-08 14:11 html

Then from R:

   > library(DLBCL)
   Error in library(DLBCL) : there is no package called 'DLBCL'
   > packageDescription("DLBCL")
   Error in packageDescription("DLBCL") :
     DESCRIPTION file of package 'DLBCL' is corrupt
   > installed.packages()
   Error: subscript out of bounds

I have no idea how this DESCRIPTION file ended up empty. I've never
seen this before. Probably a very rare race condition that would be
very hard to reproduce.

Anyway would it be possible to have installed.packages() give
a more informative error message when this happens? That would
make it behave more consistently with packageDescription().

Does something like this sound reasonable?

hpages at latitude:~/svn/R-trunk$ svn diff src/library/utils/R/packages.R
Index: src/library/utils/R/packages.R
===================================================================
--- src/library/utils/R/packages.R	(revision 53546)
+++ src/library/utils/R/packages.R	(working copy)
@@ -453,6 +453,11 @@
                      domain = NA, call. = FALSE)
              next
          }
+        if (NROW(desc) < 1L) {
+            warning(gettextf("file '%s' is corrupt", pkgpath),
+                    domain = NA, call. = FALSE)
+            next
+        }
          desc <- desc[1,]
          Rver <- strsplit(strsplit(desc["Built"], ";")[[1L]][1L],
                           "[ \t]+")[[1L]][2L]

Thanks,

H.

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From jmc4 at stanford.edu  Thu Nov 11 00:03:29 2010
From: jmc4 at stanford.edu (John Chambers)
Date: Wed, 10 Nov 2010 15:03:29 -0800
Subject: [Rd] "[[" strips the S4 class for classes extending environment
In-Reply-To: <cpnaalho1mt.fsf@gmail.com>
References: <cpnaalho1mt.fsf@gmail.com>
Message-ID: <4CDB24C1.2090108@stanford.edu>

`[[<-`, that is.  Right, the primitive code is not retaining the 
subclass information.

Should be fixed in r-devel and 2.12 patched from revision 53547.

Thanks for the catch.

On 11/10/10 3:32 AM, Vitalie S. wrote:
> Dear Developers,
>
> A recently patched [[ for environment class returns a blank environment for a
> children class:
>
> setClass("myenv", contains = "environment")
> #[1] "myenv"
> env<- new("myenv")
> class(env)
> #[1] "myenv"
> #attr(,"package")
> #[1] ".GlobalEnv"
> env[["a"]]<- 343
> class(env)
> [1] "environment"
>
> It looks like not being an intended behavior.
>
> Best,
> Vitalie.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jmc4 at stanford.edu  Thu Nov 11 01:10:26 2010
From: jmc4 at stanford.edu (John Chambers)
Date: Wed, 10 Nov 2010 16:10:26 -0800
Subject: [Rd] callNextMethod fails with "$" generic
In-Reply-To: <cpnaalhfink.fsf@gmail.com>
References: <cpnaalhfink.fsf@gmail.com>
Message-ID: <4CDB3472.1010300@stanford.edu>

The problem here is that the primitive for `$` does not use standard R 
evaluation on its second argument, so when it is selected as the next 
method the call is effectively x$name regardless of the original call.

If possible, I would avoid such cascaded calls of methods for `$`, 
precisely because of the nonstandard evaluation, which makes the 
interpretation of each level of the call ambiguous.

If this kind of code is needed, then the primitive method  should get a 
call in which the literal name is in place and the object has been 
coerced suitably.

In this example, something like

 > setMethod("$", "mylist", function(x, name) {
+     theName <- substitute(name)
+     expr <- substitute(xx$NAME, list(NAME = theName))
+     xx <- unclass(x)
+     eval(expr)
+ })
[1] "$"
 > tl <- new("mylist")
 > tl[["z"]] <- 1
 > tl$z
[1] 1

On 11/10/10 4:49 AM, Vitalie S. wrote:
> Dear Developers,
>
> callNextMethods does not work with "$"
>
> setClass("mylist", contains = "list"):
> setMethod("$",
>            signature(x = "mylist"),
>            function (x, name){
>                cat("here:\n")
>                callNextMethod()
>            })
>
> tl<- new("mylist")
> tl[["x"]]<- 343
>
> tl$x
> #here:
> #NULL
>
>
> If I use callNextMethod(x=x, name=name)
>
> this error is issued:
>
> Error in function (classes, fdef, mtable)  :
>    unable to find an inherited method for function "addNextMethod", for signature "function"
>
> It must be something "$" specific. If the above is an expected behavior , how
> should I call next method for "$" generic?
>
> My info:
> R version 2.12.0 Patched (2010-11-01 r53513)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> Same behavior for official R 2.12.0.
>
> Thanks,
> Vitalie.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From dtenenba at fhcrc.org  Thu Nov 11 03:21:21 2010
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Wed, 10 Nov 2010 18:21:21 -0800
Subject: [Rd] Problem with system2(), directing STDERR to a file
Message-ID: <AANLkTi=vzmZ=Lj+6PQ3zPquJ6opqc+dz4CkhuJEX9sMp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101110/d34db262/attachment.pl>

From keith at wehi.EDU.AU  Thu Nov 11 04:33:43 2010
From: keith at wehi.EDU.AU (Keith Satterley)
Date: Thu, 11 Nov 2010 14:33:43 +1100
Subject: [Rd] Problem with system2(), directing STDERR to a file
In-Reply-To: <AANLkTi=vzmZ=Lj+6PQ3zPquJ6opqc+dz4CkhuJEX9sMp@mail.gmail.com>
References: <AANLkTi=vzmZ=Lj+6PQ3zPquJ6opqc+dz4CkhuJEX9sMp@mail.gmail.com>
Message-ID: <4CDB6417.4010700@wehi.edu.au>

Looking at help for tempfile,

"tempfile" returns a vector of character strings which can be used as 
names for temporary files.
 
and

 For "tempfile" a character vector giving the names of possible
     (temporary) files. Note that no files are generated by "tempfile".


try a file.create(t) after tempfile()

cheers,

Keith


Dan Tenenbaum wrote:
> According to ?system2, I should be able to direct the output of STDERR to a
> file by giving the filename as a character vector to the "stderr" argument.
>
> But here is what happens.
>
> Given a ruby script test.rb (with its executable bit set):
>
> #!/usr/bin/env ruby
> STDOUT.puts "stdout"
> STDERR.puts "stderr"
>
> And the following R code:
>
>   
>> t <- tempfile()
>> res <- system2("./test.rb", stdout=TRUE, stderr=t)
>>     
> stderr
>   
>> res
>>     
> [1] "stdout"
>   
>> file.exists(t)
>>     
> [1] FALSE
>
> I would expect the file t to exist and contain "stderr", and I would expect
> not to see "stderr" in the console.
>
> Also, there is a typo in the man page - the command is listed as "system" in
> the Description instead of "system2".
>
> The reverse behavior does work correctly:
>   
>> res <- system2("./test.rb", stdout=t, stderr="")
>>     
> stderr
>   
>> file.exists(t)
>>     
> [1] TRUE
>
>
> Thanks!
> Dan
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   

______________________________________________________________________
The information in this email is confidential and intend...{{dropped:4}}


From dtenenba at fhcrc.org  Thu Nov 11 06:11:09 2010
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Wed, 10 Nov 2010 21:11:09 -0800
Subject: [Rd] Problem with system2(), directing STDERR to a file
In-Reply-To: <4CDB6417.4010700@wehi.edu.au>
References: <AANLkTi=vzmZ=Lj+6PQ3zPquJ6opqc+dz4CkhuJEX9sMp@mail.gmail.com>
	<4CDB6417.4010700@wehi.edu.au>
Message-ID: <AANLkTik93SPZ_sGWCC8PZ3-Yy6WHmV6tHOwwaOMtC5L6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101110/1657c09b/attachment.pl>

From andreas at eckner.com  Thu Nov 11 02:29:09 2010
From: andreas at eckner.com (Andreas Eckner)
Date: Wed, 10 Nov 2010 20:29:09 -0500
Subject: [Rd] Add "..." argument to generic of "median"
Message-ID: <32302052BCD64BAC95F5BE8F6C26CC9C@mainuser>

Dear developers,
 
would it be feasible to add an "..." argument to the "median" generic
function (and by extension also to "median.default")?

That would allow the implementation of "median" methods for data structures
that require optional arguments, as is already supported by the "mean"
generic function. 

Best,
Andreas


From Thorn.Thaler at rdls.nestle.com  Thu Nov 11 11:20:11 2010
From: Thorn.Thaler at rdls.nestle.com (Thaler, Thorn, LAUSANNE,
	Applied Mathematics)
Date: Thu, 11 Nov 2010 11:20:11 +0100
Subject: [Rd] Avoid warning in a foreign package (maptools) when loaded via
	depends
Message-ID: <F54EF8F1B477CF448729593FE421F64647265A@HQVEVE0032.nestle.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101111/6f7b0155/attachment.pl>

From valerop at uv.es  Thu Nov 11 12:28:16 2010
From: valerop at uv.es (Pedro Valero-Mora)
Date: Thu, 11 Nov 2010 12:28:16 +0100
Subject: [Rd] Reminder Special issue of the JSS on Graphical User Interfaces
 for R
Message-ID: <4CDBD350.70500@uv.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101111/59700b54/attachment.pl>

From phil.joubert at landg.com  Thu Nov 11 13:13:51 2010
From: phil.joubert at landg.com (evilphil)
Date: Thu, 11 Nov 2010 04:13:51 -0800 (PST)
Subject: [Rd] S4 setMethod, setGeneric and default arguments
Message-ID: <1289477631441-3037716.post@n4.nabble.com>


Hi Guys

I have defined a generic function, for which one of the arguments has a
default:

setGeneric( "getFwdRate",
              function(.Object, tenorFrom, tenorTo=tenorFrom)
standardGeneric("getFwdRate")
          )

Then I have defined a method which also has a default:

setMethod( "getFwdRate", signature(.Object="CCurveVector",
tenorFrom="numeric", tenorTo="numeric"),
              function(.Object, tenorFrom, tenorTo=tenorFrom+1) {
	[REMOVED IRRELEVANT IMPLEMENTATION
                      }
          )

However, if I call

getFwdRate(thisYC, 1)

I get "Error in function (classes, fdef, mtable)  :  unable to find an
inherited method for function "getFwdRate", for signature "CCurveVector",
"numeric", "missing" "

Is there a way that this call would match the method I've defined? Or do I
need to declare a duplicate method with signature(.Object="CCurveVector",
tenorFrom="numeric", tenorTo="missing")? In which case what is the point of
having default arguments in the method declaration?

thanks
Phil
-- 
View this message in context: http://r.789695.n4.nabble.com/S4-setMethod-setGeneric-and-default-arguments-tp3037716p3037716.html
Sent from the R devel mailing list archive at Nabble.com.


From spinuvit.list at gmail.com  Thu Nov 11 14:47:33 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Thu, 11 Nov 2010 14:47:33 +0100
Subject: [Rd] callNextMethod fails with "$" generic
References: <cpnaalhfink.fsf@gmail.com> <4CDB3472.1010300@stanford.edu>
Message-ID: <cpn1v6sezuy.fsf@gmail.com>

John Chambers <jmc4 at stanford.edu> writes:

> The problem here is that the primitive for `$` does not use standard R
> evaluation on its second argument, so when it is selected as the next method
> the call is effectively x$name regardless of the original call.
>
> If possible, I would avoid such cascaded calls of methods for `$`, precisely
> because of the nonstandard evaluation, which makes the interpretation of each
> level of the call ambiguous.
>
> If this kind of code is needed, then the primitive method  should get a call
> in which the literal name is in place and the object has been coerced
> suitably.
>
> In this example, something like
>
>> setMethod("$", "mylist", function(x, name) {
> +     theName <- substitute(name)
> +     expr <- substitute(xx$NAME, list(NAME = theName))
> +     xx <- unclass(x)
> +     eval(expr)
> + })
> [1] "$"
>> tl <- new("mylist")
>> tl[["z"]] <- 1
>> tl$z
> [1] 1

Thank you,  that helps.

>
> On 11/10/10 4:49 AM, Vitalie S. wrote:
>> Dear Developers,
>>
>> callNextMethods does not work with "$"
>>
>> setClass("mylist", contains = "list"):
>> setMethod("$",
>>            signature(x = "mylist"),
>>            function (x, name){
>>                cat("here:\n")
>>                callNextMethod()
>>            })
>>
>> tl<- new("mylist")
>> tl[["x"]]<- 343
>>
>> tl$x
>> #here:
>> #NULL
>>
>>
>> If I use callNextMethod(x=x, name=name)
>>
>> this error is issued:
>>
>> Error in function (classes, fdef, mtable)  :
>> unable to find an inherited method for function "addNextMethod", for
> signature "function"
>>
>> It must be something "$" specific. If the above is an expected behavior ,
> how
>> should I call next method for "$" generic?
>>
>> My info:
>> R version 2.12.0 Patched (2010-11-01 r53513)
>> Platform: i386-pc-mingw32/i386 (32-bit)
>>
>> Same behavior for official R 2.12.0.
>>
>> Thanks,
>> Vitalie.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel>


From therneau at mayo.edu  Thu Nov 11 21:08:59 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 11 Nov 2010 14:08:59 -0600
Subject: [Rd] Evaluation puzzle
Message-ID: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>

The survexp function can fail when called from another function.  The "why" of
this has me baffled, however.

Here is a simple test case, using a very stripped down version of survexp:

survexp.test <- function(formula, data,
        weights, subset, na.action, rmap, 
        times,  cohort=TRUE,  conditional=FALSE,
        ratetable=survexp.us, scale=1, npoints, se.fit,
        model=FALSE, x=FALSE, y=FALSE) {
    call <- match.call()
    m <- match.call(expand.dots=FALSE)
        
    # keep the first element (the call), and the following selected arguments
    m <- m[c(1, match(c('formula', 'data', 'weights', 'subset', 'na.action'),
                      names(m), nomatch=0))]
    m[[1]] <- as.name("model.frame")

    # Add in the ratetable variables
    varlist <- attr(ratetable, 'dimid')
    tform <- paste(deparse(formula), paste(varlist, collapse='+'), sep='+')
    m$formula <- tform

    print(m)
    print(ls(parent.frame()))
    mf <- eval(m, parent.frame())
    
    names(mf)
    }

Here is the test data

tdata <- data.frame(age= c(12, 24, 36)*365.25, sex=c(1,2,1),
                    year=as.Date('1953/03/10', '1960/02/23', '1978/09.22'))
tfun <- function(mydata) {
     zed <- 100 + (1:nrow(mydata)) * 20
     survexp.test(zed ~ 1, data=mydata)
     }

And the result of the exercise.

% R --vanilla
R version 2.11.0 (2010-04-22)

> library(survival)    # to pick up the survexp.us data
> tfun(tdata)
model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
[1] "mydata" "zed"   
Error in eval(expr, envir, enclos) : object 'zed' not found

-----
 Eval is being called with the expression shown and an environment that 
contains the relevant variables in that expression: zed and mydata.  Yet it
fails to find the variable zed.

 I don't see anything relevant in the manual pages for either eval or
model.frame.  I suspect that there is an invisible, undocumented, magic
argument somewhere.  


My second problem is a puzzler:

> options(error=recover)
> tfun(tdata)
model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
[1] "mydata" "zed"   
Error in eval(expr, envir, enclos) : object 'zed' not found

Enter a frame number, or 0 to exit   

1: tfun(tdata)
2: survexp.test(zed ~ 1, data = mydata)
3: eval(m, parent.frame())
4: eval(expr, envir, enclos)
5: model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
6: model.frame.default(formula = "zed ~ 1+age+sex+year", data = mydata)
7: eval(predvars, data, env)
8: eval(expr, envir, enclos)

Selection: 2
Called from: model.frame.default(formula = "zed ~ 1+age+sex+year", data = mydata)


 Why does selecting "2" result in going to frame "6"?

Terry Therneau


From ggrothendieck at gmail.com  Thu Nov 11 22:07:36 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 11 Nov 2010 16:07:36 -0500
Subject: [Rd] Evaluation puzzle
In-Reply-To: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
References: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
Message-ID: <AANLkTim4PP95Ts=wPBRs1JskyTQwM3WdFrnYgscEzAXe@mail.gmail.com>

On Thu, Nov 11, 2010 at 3:08 PM, Terry Therneau <therneau at mayo.edu> wrote:
> The survexp function can fail when called from another function. ?The "why" of
> this has me baffled, however.
>
> Here is a simple test case, using a very stripped down version of survexp:
>
> survexp.test <- function(formula, data,
> ? ? ? ?weights, subset, na.action, rmap,
> ? ? ? ?times, ?cohort=TRUE, ?conditional=FALSE,
> ? ? ? ?ratetable=survexp.us, scale=1, npoints, se.fit,
> ? ? ? ?model=FALSE, x=FALSE, y=FALSE) {
> ? ?call <- match.call()
> ? ?m <- match.call(expand.dots=FALSE)
>
> ? ?# keep the first element (the call), and the following selected arguments
> ? ?m <- m[c(1, match(c('formula', 'data', 'weights', 'subset', 'na.action'),
> ? ? ? ? ? ? ? ? ? ? ?names(m), nomatch=0))]
> ? ?m[[1]] <- as.name("model.frame")
>
> ? ?# Add in the ratetable variables
> ? ?varlist <- attr(ratetable, 'dimid')
> ? ?tform <- paste(deparse(formula), paste(varlist, collapse='+'), sep='+')

At the above statement you have lost the environment of your formula.

> ? ?m$formula <- tform

Replace this with:

m$formula <- as.formula(tform, environment(formula))



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From therneau at mayo.edu  Thu Nov 11 23:27:03 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 11 Nov 2010 16:27:03 -0600
Subject: [Rd] Evaluation puzzle
In-Reply-To: <AANLkTim4PP95Ts=wPBRs1JskyTQwM3WdFrnYgscEzAXe@mail.gmail.com>
References: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
	<AANLkTim4PP95Ts=wPBRs1JskyTQwM3WdFrnYgscEzAXe@mail.gmail.com>
Message-ID: <1289514423.29759.23.camel@punchbuggy>

Gabor wrote: 
 At the above statement you have lost the environment of your formula.

>    m$formula <- tform

Replace this with:

m$formula <- as.formula(tform, environment(formula))

----------------------
  No, I have not "lost" an environment.  I manufactured a formula which
lacked something needed, but without the necessary hint that I needed
it. But that is semantics:  A closer reread of help(model.frame) shows
that the documentation is there, I had missed it.
  
 I'm still puzzled by recover though.

Terry T.


From kevin.r.coombes at gmail.com  Thu Nov 11 23:31:35 2010
From: kevin.r.coombes at gmail.com (Kevin R. Coombes)
Date: Thu, 11 Nov 2010 16:31:35 -0600
Subject: [Rd] Evaluation puzzle
In-Reply-To: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
References: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
Message-ID: <4CDC6EC7.9080208@gmail.com>

Hi Terry,

This may not really be a complete answer, but there seems to be a 
difference in eval'ing an expression compared to eval'ing a call (even 
though both are documented in the help page for eval as working just fine).

If you insert the line
     print(eval(expression(zed), parent.frame()))
into your survexp.test function just above the existing call to "eval", 
this line works just fine.  So it's clear that an _expression_ 
containing "zed" can be evaluated, but evaluating the _call_  via the 
model.frame function fails.

I suspect that the actual evaluation problem lies in the call to
     eval(predvars, data, env)
made inside model.frame.default.   The value of "env" when this function 
is called is defined in an earlier line by
     env <- environment(formula)
Since the formula does not have an environment defined when it is passed 
in, one gets provided within the model.frame.default function.  I edited 
my version of model.frame.default to
     print(ls(env))
just before the call to
     eval(predvars, data, env)
and confirmed that "zed" is not part of that environment.

Now the manual page for formula says that "Formulas created with ~ use 
the environment in which they were created. Formulas created with 
'as.formula' use the env argument for their environment."  Since you are 
passing a character string through to model.frame, and it calls 
"as.formula" without an environment, the formula eventually gets 
evaluated in the context of the model.frame.default function without 
knowing about the environment you gave it.

I think you can fix this by explicitly creating your own 
formula+environment before calling miodel frame.  Specifically, try 
changing the line
     m$formula <- tform
to
     m$formula <- as.formula(tform, env=parent.frame())
and see if that helps.  On my machine, it at least allows
     tfun(tdata)
to run without throwing an error.

Best,
     Kevni


On 11/11/2010 2:08 PM, Terry Therneau wrote:
> The survexp function can fail when called from another function.  The "why" of
> this has me baffled, however.
>
> Here is a simple test case, using a very stripped down version of survexp:
>
> survexp.test<- function(formula, data,
>          weights, subset, na.action, rmap,
>          times,  cohort=TRUE,  conditional=FALSE,
>          ratetable=survexp.us, scale=1, npoints, se.fit,
>          model=FALSE, x=FALSE, y=FALSE) {
>      call<- match.call()
>      m<- match.call(expand.dots=FALSE)
>
>      # keep the first element (the call), and the following selected arguments
>      m<- m[c(1, match(c('formula', 'data', 'weights', 'subset', 'na.action'),
>                        names(m), nomatch=0))]
>      m[[1]]<- as.name("model.frame")
>
>      # Add in the ratetable variables
>      varlist<- attr(ratetable, 'dimid')
>      tform<- paste(deparse(formula), paste(varlist, collapse='+'), sep='+')
>      m$formula<- tform
>
>      print(m)
>      print(ls(parent.frame()))
>      mf<- eval(m, parent.frame())
>
>      names(mf)
>      }
>
> Here is the test data
>
> tdata<- data.frame(age= c(12, 24, 36)*365.25, sex=c(1,2,1),
>                      year=as.Date('1953/03/10', '1960/02/23', '1978/09.22'))
> tfun<- function(mydata) {
>       zed<- 100 + (1:nrow(mydata)) * 20
>       survexp.test(zed ~ 1, data=mydata)
>       }
>
> And the result of the exercise.
>
> % R --vanilla
> R version 2.11.0 (2010-04-22)
>
>> library(survival)    # to pick up the survexp.us data
>> tfun(tdata)
> model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
> [1] "mydata" "zed"
> Error in eval(expr, envir, enclos) : object 'zed' not found
>
> -----
>   Eval is being called with the expression shown and an environment that
> contains the relevant variables in that expression: zed and mydata.  Yet it
> fails to find the variable zed.
>
>   I don't see anything relevant in the manual pages for either eval or
> model.frame.  I suspect that there is an invisible, undocumented, magic
> argument somewhere.
>
>
> My second problem is a puzzler:
>
>> options(error=recover)
>> tfun(tdata)
> model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
> [1] "mydata" "zed"
> Error in eval(expr, envir, enclos) : object 'zed' not found
>
> Enter a frame number, or 0 to exit
>
> 1: tfun(tdata)
> 2: survexp.test(zed ~ 1, data = mydata)
> 3: eval(m, parent.frame())
> 4: eval(expr, envir, enclos)
> 5: model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
> 6: model.frame.default(formula = "zed ~ 1+age+sex+year", data = mydata)
> 7: eval(predvars, data, env)
> 8: eval(expr, envir, enclos)
>
> Selection: 2
> Called from: model.frame.default(formula = "zed ~ 1+age+sex+year", data = mydata)
>
>
>   Why does selecting "2" result in going to frame "6"?
>
> Terry Therneau
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ggrothendieck at gmail.com  Thu Nov 11 23:31:31 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 11 Nov 2010 17:31:31 -0500
Subject: [Rd] Evaluation puzzle
In-Reply-To: <1289514423.29759.23.camel@punchbuggy>
References: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
	<AANLkTim4PP95Ts=wPBRs1JskyTQwM3WdFrnYgscEzAXe@mail.gmail.com>
	<1289514423.29759.23.camel@punchbuggy>
Message-ID: <AANLkTinnifF8Yb0UiZKf4bjhZFTX-QgxCs=RJZGObUBB@mail.gmail.com>

On Thu, Nov 11, 2010 at 5:27 PM, Terry Therneau <therneau at mayo.edu> wrote:
> Gabor wrote:
> ?At the above statement you have lost the environment of your formula.
>
>> ? ?m$formula <- tform
>
> Replace this with:
>
> m$formula <- as.formula(tform, environment(formula))
>
> ----------------------
> ?No, I have not "lost" an environment. ?I manufactured a formula which

You manufactured a "character" string, not a "formula", and character
strings don't have environments.

> lacked something needed, but without the necessary hint that I needed
> it. But that is semantics: ?A closer reread of help(model.frame) shows
> that the documentation is there, I had missed it.
>
> ?I'm still puzzled by recover though.
>
> Terry T.
>
>



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From therneau at mayo.edu  Fri Nov 12 00:08:51 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 11 Nov 2010 17:08:51 -0600
Subject: [Rd] Evaluation puzzle
In-Reply-To: <4CDC6EC7.9080208@gmail.com>
References: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>
	<4CDC6EC7.9080208@gmail.com>
Message-ID: <1289516931.29759.51.camel@punchbuggy>

Kevin,
  The answer came from Gabor -- the model.frame function has a
non-standard evaluation, in that it uses the enviromnent attached to the
formula as the "enclosure" for looking up variable names.
  This is clearly documented and I somehow missed it when reading the
page.  So "reading deficit" is the true root of my query.  I scratched
my head for a couple of hours before sending for help. 

   Also a typo in my stripped down example -- I forgot the as.formula()
wrapper which is in the actual survexp function.  This added a red
herring to the discussion.

Terry T.


From pdalgd at gmail.com  Fri Nov 12 00:25:23 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Fri, 12 Nov 2010 00:25:23 +0100
Subject: [Rd] Evaluation puzzle
In-Reply-To: <1289514423.29759.23.camel@punchbuggy>
References: <201011112008.oABK8xjk025512@punchbuggy.mayo.edu>	<AANLkTim4PP95Ts=wPBRs1JskyTQwM3WdFrnYgscEzAXe@mail.gmail.com>
	<1289514423.29759.23.camel@punchbuggy>
Message-ID: <4CDC7B63.1020302@gmail.com>

On 11/11/2010 11:27 PM, Terry Therneau wrote:

>  I'm still puzzled by recover though.

It looks like a buglet. You get to the right frame (try ls()) but the
"called from" message is off by four frames.

E.g.

Selection: 1
Called from: model.frame(formula = "zed ~ 1+age+sex+year", data = mydata)
Browse[1]> ls()
[1] "mydata" "zed"
Browse[1]> tfun
function(mydata) {
     zed <- 100 + (1:nrow(mydata)) * 20
     survexp.test(zed ~ 1, data=mydata)
     }

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From hpages at fhcrc.org  Fri Nov 12 01:15:51 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 11 Nov 2010 16:15:51 -0800
Subject: [Rd] installed.packages Error: subscript out of bounds
In-Reply-To: <4CDB0AED.3030606@fhcrc.org>
References: <4CDB0AED.3030606@fhcrc.org>
Message-ID: <4CDC8737.9090006@fhcrc.org>

I can see this has been addressed, thanks!

I found a couple more issues with installed.packages().

The values returned in the Archs column don't seem to really make
sense on Unix:

   > installed.packages()[1:5, c("Version", "Archs", "Built")]
              Version   Archs           Built
   affxparser "1.22.0"  "affxparser.so" "2.12.0"
   affy       "1.28.0"  "affy.so"       "2.12.0"
   affydata   "1.11.10" NA              "2.12.0"
   affyILM    "1.2.0"   "affyILM.so"    "2.12.0"
   affyio     "1.18.0"  "affyio.so"     "2.12.0"

Also the man page for installed.packages would need to be updated to
list this new Archs column (Value section).

Thanks,
H.


On 11/10/2010 01:13 PM, Herv? Pag?s wrote:
> Hi,
>
> Today we've seen the following problem with the R-2.12 that we use
> for our Windows builds:
>
>  > installed.packages()
> Error: subscript out of bounds
>
> After some investigation we discovered that the cause of this failure
> was that 1 of the 890 packages currently installed on the machine
> (Windows Server 2003 R2) had its DESCRIPTION file empty:
>
> E:\biocbld\bbs-2.7-bioc\R\library>ls -al DLBCL
> total 1
> drwxr-xr-x+ 1 biocbuild2 root 0 2010-11-08 14:11 .
> drwxr-xr-x+ 1 biocbuild2 root 0 2010-11-10 00:14 ..
> -rwxr-xr-x+ 1 biocbuild2 root 0 2010-11-08 14:11 DESCRIPTION
> -rwxr-xr-x+ 1 biocbuild2 root 357 2010-11-08 14:11 INDEX
> drwxr-xr-x+ 1 biocbuild2 root 0 2010-11-08 14:11 data
> drwxr-xr-x+ 1 biocbuild2 root 0 2010-11-08 14:11 help
> drwxr-xr-x+ 1 biocbuild2 root 0 2010-11-08 14:11 html
>
> Then from R:
>
>  > library(DLBCL)
> Error in library(DLBCL) : there is no package called 'DLBCL'
>  > packageDescription("DLBCL")
> Error in packageDescription("DLBCL") :
> DESCRIPTION file of package 'DLBCL' is corrupt
>  > installed.packages()
> Error: subscript out of bounds
>
> I have no idea how this DESCRIPTION file ended up empty. I've never
> seen this before. Probably a very rare race condition that would be
> very hard to reproduce.
>
> Anyway would it be possible to have installed.packages() give
> a more informative error message when this happens? That would
> make it behave more consistently with packageDescription().
>
> Does something like this sound reasonable?
>
> hpages at latitude:~/svn/R-trunk$ svn diff src/library/utils/R/packages.R
> Index: src/library/utils/R/packages.R
> ===================================================================
> --- src/library/utils/R/packages.R (revision 53546)
> +++ src/library/utils/R/packages.R (working copy)
> @@ -453,6 +453,11 @@
> domain = NA, call. = FALSE)
> next
> }
> + if (NROW(desc) < 1L) {
> + warning(gettextf("file '%s' is corrupt", pkgpath),
> + domain = NA, call. = FALSE)
> + next
> + }
> desc <- desc[1,]
> Rver <- strsplit(strsplit(desc["Built"], ";")[[1L]][1L],
> "[ \t]+")[[1L]][2L]
>
> Thanks,
>
> H.
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fhcrc.org  Fri Nov 12 01:40:31 2010
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 11 Nov 2010 16:40:31 -0800
Subject: [Rd] installing dependencies: binary vs source
Message-ID: <4CDC8CFF.6080303@fhcrc.org>

Hi,

Installing from binaries on Windows:

   > install.packages("multtest")
   Warning: dependency 'Biobase' is not available
   trying URL 
'http://cran.fhcrc.org/bin/windows/contrib/2.12/multtest_2.6.0.zip'
   Content type 'application/zip' length 1645590 bytes (1.6 Mb)
   opened URL
   downloaded 1.6 Mb

   package 'multtest' successfully unpacked and MD5 sums checked

   The downloaded packages are in
 
C:\Users\biocbuild2\AppData\Local\Temp\2\RtmpPzRqzb\downloaded_packages

Note the warning that a dependency is missing. But still the package
got installed even though it won't be loadable.

Now installing from source on Windows:

   > install.packages("multtest", type="source")
   Warning: dependency 'Biobase' is not available
   trying URL 'http://cran.fhcrc.org/src/contrib/multtest_2.6.0.tar.gz'
   Content type 'application/x-gzip' length 1457444 bytes (1.4 Mb)
   opened URL
   downloaded 1.4 Mb

   ERROR: dependency 'Biobase' is not available for package 'multtest'
   * removing 'D:/biocbld/bbs-2.7-bioc/R/library/multtest'

   The downloaded packages are in
 
'C:\Users\biocbuild2\AppData\Local\Temp\2\RtmpPzRqzb\downloaded_packages'
   Warning message:
   In install.packages("multtest", type = "source") :
     installation of package 'multtest' had non-zero exit status

Note the warning *and* ERROR.

Is this the intended behavior of install.packages() when installing
from binaries?

Thanks,
H.

PS: Sorry I don't have access to an R-2.13 installation where I can
test this at the moment.

   > sessionInfo()
   R version 2.12.0 (2010-10-15)
   Platform: x86_64-pc-mingw32/x64 (64-bit)

   locale:
   [1] LC_COLLATE=English_United States.1252
   [2] LC_CTYPE=English_United States.1252
   [3] LC_MONETARY=English_United States.1252
   [4] LC_NUMERIC=C
   [5] LC_TIME=English_United States.1252

   attached base packages:
   [1] stats     graphics  grDevices utils     datasets  methods   base


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From dtenenba at fhcrc.org  Fri Nov 12 05:44:55 2010
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Thu, 11 Nov 2010 20:44:55 -0800
Subject: [Rd] Problem with system2(), directing STDERR to a file
In-Reply-To: <AANLkTik93SPZ_sGWCC8PZ3-Yy6WHmV6tHOwwaOMtC5L6@mail.gmail.com>
References: <AANLkTi=vzmZ=Lj+6PQ3zPquJ6opqc+dz4CkhuJEX9sMp@mail.gmail.com>
	<4CDB6417.4010700@wehi.edu.au>
	<AANLkTik93SPZ_sGWCC8PZ3-Yy6WHmV6tHOwwaOMtC5L6@mail.gmail.com>
Message-ID: <AANLkTikuZHMRHhpFq0RjQQTiA+k6pR+XKRTXgH+pFtAp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101111/4dff2019/attachment.pl>

From maechler at stat.math.ethz.ch  Fri Nov 12 11:14:26 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 12 Nov 2010 11:14:26 +0100
Subject: [Rd] S4 package warning
In-Reply-To: <4CDA6B9A.6060709@cam.ac.uk>
References: <4CDA6B9A.6060709@cam.ac.uk>
Message-ID: <19677.4994.66614.830107@lynne.math.ethz.ch>

>>>>> Robin Hankin <rksh1 at cam.ac.uk>
>>>>>     on Wed, 10 Nov 2010 09:53:30 +0000 writes:

    > Hello everyone.  R-2.12.0, suse linux 11.3.
    > I am debugging a package that uses S4 methods
    > and R CMD check gives the following warning:

    >> Warning in methods::findMethods(g, env) :
    >> non-generic function 'mdm' given to findMethods()
    >> See the information on DESCRIPTION files in the chapter 'Creating R
    >> packages' of the 'Writing R Extensions' manual.

    > I don't see anything obvious in that part of the R-exts but
    > FWIW, here is my DESCRIPTION file:

    >> Package: multivator
    >> Type: Package
    >> Title: A multivariate emulator
    >> Version: 1.0-1
    >> Depends: R(>= 2.10.0), emulator, methods, utils
    >> Date: 2009-10-27
    >> Author: Robin K. S. Hankin
    >> Maintainer:  <hankin.robin_nospamAT_gmail.com>
    >> Description: A multivariate generalization of the emulator package
    >> License: GPL-2
    >> LazyLoad: yes


    > I think that the lines in question in my package are:

    >> setClass("mdm", # "mdm" == "multivariate design matrix"
    >> representation = representation(
    >> xold  = "matrix",
    >> types = "factor"
    >> )
    >> )
    >> 
    >> 
    >> setGeneric("mdm",function(xold,types){standardGeneric("mdm")})
    >> setMethod("mdm",signature("matrix","factor"),function(xold, types){
    >> new("mdm", xold=xold, types=types)
    >> } )

    > which appear to execute without warning on a virgin console.  In the
    > package, there are three
    > or four other S4 classes which are on the same footing as the mdm class,
    > but do not appear to generate a warning from R CMD check.
    > The same happens AFAICS on R-2.13, 53543

    > Can anyone advise on how to deal with the warning?

It is probably simply the *order* of your R/*.R files which matters:
The setGeneric() has to come before all its setMethod()s.

A maintenance-intensive solution to the problem is to use a
'Collate:' field in your DESCRIPTION.
A much simpler approach is what we've done in the Matrix
package: use  R/AllClasses.R   and  R/AllGenerics.R
to put all setClass(.) and all setGeneric(.) calls,
respectively.
(and ensure not to use other file names that collate *before*
 'All*' in some locales).

Martin




    > thank you

    > Robin




    > -- 
    > Robin K. S. Hankin
    > Uncertainty Analyst
    > University of Cambridge
    > 19 Silver Street
    > Cambridge CB3 9EP
    > 01223-764877

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From dtenenba at fhcrc.org  Fri Nov 12 18:49:18 2010
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Fri, 12 Nov 2010 09:49:18 -0800
Subject: [Rd] Problem with system2(), directing STDERR to a file
In-Reply-To: <AANLkTikuZHMRHhpFq0RjQQTiA+k6pR+XKRTXgH+pFtAp@mail.gmail.com>
References: <AANLkTi=vzmZ=Lj+6PQ3zPquJ6opqc+dz4CkhuJEX9sMp@mail.gmail.com>
	<4CDB6417.4010700@wehi.edu.au>
	<AANLkTik93SPZ_sGWCC8PZ3-Yy6WHmV6tHOwwaOMtC5L6@mail.gmail.com>
	<AANLkTikuZHMRHhpFq0RjQQTiA+k6pR+XKRTXgH+pFtAp@mail.gmail.com>
Message-ID: <AANLkTin6Vqz9aACjhzOgdNtRrQzcTUL7hym1EkLjLOXX@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101112/dd295bbe/attachment.pl>

From amredd at gmail.com  Fri Nov 12 22:26:24 2010
From: amredd at gmail.com (Andrew Redd)
Date: Fri, 12 Nov 2010 14:26:24 -0700
Subject: [Rd] unloading compiled code.
Message-ID: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>

I have a package that I'm developing that I need to unload the
library.  Long story short I figured out that the leaving the compiled
code loaded lead to a segmentation fault, but unloading the code will
fix it.  I've read the documentation and it appears that there are
several ways to do this?  What is the popper accepted current standard
for unloading compiled code?

The options as I understand them are:
1. dyn.unload
2. library.dynam.unload
used with either
A. .Last.lib
B. .onUnload

If it makes a difference my package does use a NAMESPACE so the
package is loaded through useDynLib.

Thanks,
Andrew Redd


From ripley at stats.ox.ac.uk  Fri Nov 12 23:32:48 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Nov 2010 22:32:48 +0000 (GMT)
Subject: [Rd] unloading compiled code.
In-Reply-To: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>

On Fri, 12 Nov 2010, Andrew Redd wrote:

> I have a package that I'm developing that I need to unload the
> library.  Long story short I figured out that the leaving the compiled
> code loaded lead to a segmentation fault, but unloading the code will
> fix it.  I've read the documentation and it appears that there are
> several ways to do this?  What is the popper accepted current standard
> for unloading compiled code?

Depends how you loaded it: you basically reverse the process.

> The options as I understand them are:
> 1. dyn.unload
> 2. library.dynam.unload
> used with either
> A. .Last.lib
> B. .onUnload
>
> If it makes a difference my package does use a NAMESPACE so the
> package is loaded through useDynLib.

So you need an .onUnload action calling library.dynam.unload.

Slightly longer version: you need the DLL loaded whilst the namepace 
is in use, so it has to be in .onUnload, and useDynLib calls 
library.dynam so you need library.dynam.unload to do the housekeeping 
around dyn.unload which matches what library.dynam does around 
dyn.load.

There are quite a lot of examples to look at, including in R itself. 
MASS is one example I've just checked.

Having said all that, my experience is that unloading the DLL often 
does not help if you need to load it again (and that is why e.g. tcltk 
does not unload its DLL).

> Thanks,
> Andrew Redd
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pleyshock at gmail.com  Fri Nov 12 23:31:31 2010
From: pleyshock at gmail.com (Patrick Leyshock)
Date: Fri, 12 Nov 2010 14:31:31 -0800
Subject: [Rd] SEXPs and slots
Message-ID: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101112/01253b80/attachment.pl>

From amredd at gmail.com  Fri Nov 12 23:52:22 2010
From: amredd at gmail.com (Andrew Redd)
Date: Fri, 12 Nov 2010 15:52:22 -0700
Subject: [Rd] unloading compiled code.
In-Reply-To: <alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
Message-ID: <AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>

Perhaps you could help me make some sense of this.  Here is a printout
of my sessions.
---
toys$R -q
> library(test2)
> gpualloctest()
testing allocation on gpu
C Finished
Collecting Garbage
done.
> q()
Save workspace image? [y/n/c]: n

 *** caught segfault ***
address 0x7f12ec1add50, cause 'memory not mapped'

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 1
aborting ...
Segmentation fault
toys$R -q
> library(test2)
> gpualloctest()
testing allocation on gpu
C Finished
Collecting Garbage
done.
> library.dynam.unload('test2',system.file(package='test2'))
> q()
Save workspace image? [y/n/c]: n
toys$
---

I have a in the test2/R/zzz.R file
---
.onUnload <- function(libpath)
    library.dynam.unload("test2", libpath)
---

so the code should be unloaded.  But it appears that it is not from
errors when I explicitly unload the test2.so it does not through a
segfault.  Why would this be happening?  and how do I circumvent it.

thanks,
Andrew


On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
> On Fri, 12 Nov 2010, Andrew Redd wrote:
>
>> I have a package that I'm developing that I need to unload the
>> library. ?Long story short I figured out that the leaving the compiled
>> code loaded lead to a segmentation fault, but unloading the code will
>> fix it. ?I've read the documentation and it appears that there are
>> several ways to do this? ?What is the popper accepted current standard
>> for unloading compiled code?
>
> Depends how you loaded it: you basically reverse the process.
>
>> The options as I understand them are:
>> 1. dyn.unload
>> 2. library.dynam.unload
>> used with either
>> A. .Last.lib
>> B. .onUnload
>>
>> If it makes a difference my package does use a NAMESPACE so the
>> package is loaded through useDynLib.
>
> So you need an .onUnload action calling library.dynam.unload.
>
> Slightly longer version: you need the DLL loaded whilst the namepace is in
> use, so it has to be in .onUnload, and useDynLib calls library.dynam so you
> need library.dynam.unload to do the housekeeping around dyn.unload which
> matches what library.dynam does around dyn.load.
>
> There are quite a lot of examples to look at, including in R itself. MASS is
> one example I've just checked.
>
> Having said all that, my experience is that unloading the DLL often does not
> help if you need to load it again (and that is why e.g. tcltk does not
> unload its DLL).
>
>> Thanks,
>> Andrew Redd
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>


From mtmorgan at fhcrc.org  Sat Nov 13 01:36:56 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 12 Nov 2010 16:36:56 -0800
Subject: [Rd] SEXPs and slots
In-Reply-To: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
Message-ID: <4CDDDDA8.3040003@fhcrc.org>

On 11/12/2010 02:31 PM, Patrick Leyshock wrote:
> Hello,
> 
> I've created this class:
> 
> setClass("example",
>    representation  (
>           size = "numeric",
>           id    = "character"
>    )
> )
> 
> Suppose I create a new instance of this class:
> 
>> x <- new("example", 4, "id_value")
> 
> This creates an S4 object with two slots.  Am I correct in thinking that
> slots are "filled" by SEXPs?

Hi Patrick --

If I

> eg = new("example", size=4, id="id_value")

(note the named arguments) and take a peak at the str'ucture of eg, I see

> str(eg)
Formal class 'example' [package ".GlobalEnv"] with 2 slots
  ..@ size: num 4
  ..@ id  : chr "id_value"

so the @size slot is a numeric vector of length 1 containing the value
4. One doesn't really have to know the detailed representation, but one
can find out from

> .Internal(inspect(eg))
@df70e48 25 S4SXP g0c0 [OBJ,NAM(2),gp=0x10,ATT]
ATTRIB:
  @df70ef0 02 LISTSXP g0c0 []
    TAG: @769258 01 SYMSXP g1c0 [MARK] "size"
    @c0f6db8 14 REALSXP g0c1 [NAM(2)] (len=1, tl=0) 4
    TAG: @15b0228 01 SYMSXP g1c0 [MARK,NAM(2)] "id"
    @c0f6178 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
      @12341c80 09 CHARSXP g0c2 [gp=0x20] "id_value"
    TAG: @607ce8 01 SYMSXP g1c0 [MARK,NAM(2),gp=0x4000] "class"
    @c0f6d58 16 STRSXP g0c1 [NAM(2),ATT] (len=1, tl=0)
      @96ed08 09 CHARSXP g1c1 [MARK,gp=0x21] "example"
    ATTRIB:
      @df70fd0 02 LISTSXP g0c0 []
	TAG: @624f70 01 SYMSXP g1c0 [MARK,NAM(2)] "package"
	@c0f6d88 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
	  @67f5e0 09 CHARSXP g1c2 [MARK,gp=0x21,ATT] ".GlobalEnv"

that the 'eg' object is an S4SXP with an attribute that is a LISTSXP.
The LISTSXP has elements that are tagged with SYMSXP representing the
slot name, and values that are REALSXP (for 'size') or STRSXP (for
'id'). The LISTSXP attribute itself has an attribute, which contains
information about the package where the class is defined. With these
hints one can see through the S4 interface to the underlying implementation

> attributes(eg)
$size
[1] 4

$id
[1] "id_value"

$class
[1] "example"
attr(,"package")
[1] ".GlobalEnv"

But probably you have a specific goal in mind, and this is too much
information...

Martin

> 
> Thanks, Patrick
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From savicky at cs.cas.cz  Sat Nov 13 11:44:37 2010
From: savicky at cs.cas.cz (Petr Savicky)
Date: Sat, 13 Nov 2010 11:44:37 +0100
Subject: [Rd] opening graphics device with a given number
Message-ID: <20101113104437.GA1994@cs.cas.cz>

I am preparing a script, which uses three graphical windows for different
types of plots. Before each plot, the device can be chosen by dev.set(k)
for k = 2, 3, 4. The function dev.set(k) does not create the required
device, if it is not opened already. So, instead, i use dev.add(k)
defined as

  dev.add <- function(k)
  {
      stopifnot(k >= 2 && k <= 63)
      while (all(dev.list() != k)) {
          dev.new()
      }
      dev.set(k)
  }

If the device k was not opened, then all the devices with numbers
smaller than k, which were not opened already, are created.
Usually, i use an interval of the device numbers, but sometimes,
it could be useful to open, say, device 4, even if device 3
is not needed. Is there a way, how to open a device with a
given number without opening devices with smaller numbers?

Petr Savicky.


From hb at biostat.ucsf.edu  Sat Nov 13 14:09:56 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Sat, 13 Nov 2010 05:09:56 -0800
Subject: [Rd] opening graphics device with a given number
In-Reply-To: <20101113104437.GA1994@cs.cas.cz>
References: <20101113104437.GA1994@cs.cas.cz>
Message-ID: <AANLkTikPOQSggOfXxjsP1VgGeaFeHQ1mgtLM3-OUUwAD@mail.gmail.com>

See devSet() in R.utils, e.g.

> library("R.utils");
> graphics.off();
> devSet(6);
> devSet("myFigure");  # Also possible
> print(devList());
myFigure Device 6
       2        6
>

/Henrik

On Sat, Nov 13, 2010 at 2:44 AM, Petr Savicky <savicky at cs.cas.cz> wrote:
> I am preparing a script, which uses three graphical windows for different
> types of plots. Before each plot, the device can be chosen by dev.set(k)
> for k = 2, 3, 4. The function dev.set(k) does not create the required
> device, if it is not opened already. So, instead, i use dev.add(k)
> defined as
>
> ?dev.add <- function(k)
> ?{
> ? ? ?stopifnot(k >= 2 && k <= 63)
> ? ? ?while (all(dev.list() != k)) {
> ? ? ? ? ?dev.new()
> ? ? ?}
> ? ? ?dev.set(k)
> ?}
>
> If the device k was not opened, then all the devices with numbers
> smaller than k, which were not opened already, are created.
> Usually, i use an interval of the device numbers, but sometimes,
> it could be useful to open, say, device 4, even if device 3
> is not needed. Is there a way, how to open a device with a
> given number without opening devices with smaller numbers?
>
> Petr Savicky.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Sat Nov 13 17:49:08 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 13 Nov 2010 17:49:08 +0100
Subject: [Rd] installing dependencies: binary vs source
In-Reply-To: <4CDC8CFF.6080303@fhcrc.org>
References: <4CDC8CFF.6080303@fhcrc.org>
Message-ID: <4CDEC184.6000607@statistik.tu-dortmund.de>



On 12.11.2010 01:40, Herv? Pag?s wrote:
> Hi,
>
> Installing from binaries on Windows:
>
>  > install.packages("multtest")
> Warning: dependency 'Biobase' is not available
> trying URL
> 'http://cran.fhcrc.org/bin/windows/contrib/2.12/multtest_2.6.0.zip'
> Content type 'application/zip' length 1645590 bytes (1.6 Mb)
> opened URL
> downloaded 1.6 Mb
>
> package 'multtest' successfully unpacked and MD5 sums checked
>
> The downloaded packages are in
>
> C:\Users\biocbuild2\AppData\Local\Temp\2\RtmpPzRqzb\downloaded_packages
>
> Note the warning that a dependency is missing. But still the package
> got installed even though it won't be loadable.
>
> Now installing from source on Windows:
>
>  > install.packages("multtest", type="source")
> Warning: dependency 'Biobase' is not available
> trying URL 'http://cran.fhcrc.org/src/contrib/multtest_2.6.0.tar.gz'
> Content type 'application/x-gzip' length 1457444 bytes (1.4 Mb)
> opened URL
> downloaded 1.4 Mb
>
> ERROR: dependency 'Biobase' is not available for package 'multtest'
> * removing 'D:/biocbld/bbs-2.7-bioc/R/library/multtest'
>
> The downloaded packages are in
>
> 'C:\Users\biocbuild2\AppData\Local\Temp\2\RtmpPzRqzb\downloaded_packages'
> Warning message:
> In install.packages("multtest", type = "source") :
> installation of package 'multtest' had non-zero exit status
>
> Note the warning *and* ERROR.
>
> Is this the intended behavior of install.packages() when installing
> from binaries?


Herv?,

yes, I think so. If you ask to install a package, it is installed unless 
it cannot be installed (as it was the case since R had to load Biobase 
which was unavailable).


Best,
Uwe



> Thanks,
> H.
>
> PS: Sorry I don't have access to an R-2.13 installation where I can
> test this at the moment.
>
>  > sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
>
>


From ligges at statistik.tu-dortmund.de  Sat Nov 13 19:47:02 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 13 Nov 2010 19:47:02 +0100
Subject: [Rd] trouble compiling RMySQL (and others) for 64 bit windows.
In-Reply-To: <AANLkTinDSqVgdtt2qJ634_2QTOADQbbxiiXC-qoFrFj_@mail.gmail.com>
References: <AANLkTinDSqVgdtt2qJ634_2QTOADQbbxiiXC-qoFrFj_@mail.gmail.com>
Message-ID: <4CDEDD26.6050201@statistik.tu-dortmund.de>

I just found this obviously unanswered message:

Yes, you need Rtools installed as described in the manual "R 
Installation and Administration" which explains what to do in more 
detail. It makes sense to upgrade to R-2.12.0 if you have not already 
done so.

Best,
Uwe Ligges




On 21.09.2010 22:11, Ted Byers wrote:
> I have a 64 bit machine running 64 bit windows 7 pro, 64 bit MySQL, and 64
> bit R 2.11.1.
>
> I have also installed RTools for 64 bit windows for this version of R
> (archive name is oldWin64toolchain.zip; the install path for its contents
> is C:\RTools, if that matters).  I can open up a commandline window and
> invoke any of the programs in both bin directories (both added to the system
> path).
> There are several packages for which I could not find 64 bit binaries
> RMySQL, RPostgreSQL, RQRMlib,&c.  While I don't have time at present to
> develop ne packages for R, these packages are things I routinely use on my
> 32 bit machine (where, thankfully, all seems to be working fine).
> Therefore, my only interest is in getting or making the 64 bit binaries for
> these packages so I can duplicate on the new 64 bit machine what I had been
> doing on the old 32 bit machine.
>
> Note, I routinely develop new software using MS VS (originally v 6, and then
> VS 2005, and now vs 2010), and if I need to work up code to run on some
> flavour of unix, I use the cygwin environment.  Therefore, I have no qualms
> about compiling programs I use from source.  I just prefer not to if there
> is already a binary distribution for whatever platform I happen to be using.
>
> I began by trying to follow the instructions provided on
> http://biostat.mc.vanderbilt.edu/wiki/Main/RMySQL, and found a couple
> issues.
>
>
>
> First, there was no Renviron.site in C:/Program Files/R/R-2.11.1-x64/etc so
> I made one and placed in it the following:
>
> MYSQL_HOME=C:\PROGRA~1\MySQL\MYSQLS~1.1
>
> The full path to the installation of MySQL is: C:\Program Files\MySQL\MySQL
> Server 5.1
>
> Unlike what is said on the biostat.mc.vanderbilt.edu pages, MYSQL_HOME is
> still empty:
>
>
>> Sys.getenv('MYSQL_HOME')
> MYSQL_HOME
>          ""
> This is when I start R AFTER having made the Renviron.site file.
>
> Something I notice, though, that may have a bearing on this is that although
> Emacs finds my new Renviron.site file when I navigate to that directory, it
> does not appear in Windows Explorer.  I am wondering if Windows 7 is somehow
> blocking access to it.  If that guess is correct, the question becomes, how
> do I fix that?  If it isn't correct, what should I check?  This is not an
> insurmountable problem, though as I can always set that environment variable
> at the beginning of a session.  I do that already on other systems that are
> 32 bit clients that have to talk to 64 bit servers.  It is just mildly
> disturbing that R does not seem to know about the Renviron.site file I made
> for it.
>
> Second, I read in the instructions the following:
>
>
>> 3. *Re-start R and execute install.packages('RMySQL',type='source')* at
>> the R prompt.
>>
>> As long as you followed the above steps correctly, RMySQL<https://mail.google.com/wiki/Main/RMySQL>will install cleanly and you will be able to immediately load it and use it.
>>
> However, when I follow this instruction I get:
>> install.packages('RMySQL',type='source')
> Warning in install.packages("RMySQL", type = "source") :
>    argument 'lib' is missing: using
> 'C:\Users\Ted\Documents/R/win64-library/2.11'
> --- Please select a CRAN mirror for use in this session ---
> trying URL 'http://probability.ca/cran/src/contrib/RMySQL_0.7-5.tar.gz'
> Content type 'application/x-gzip' length 160769 bytes (157 Kb)
> opened URL
> downloaded 157 Kb
> * installing *source* package 'RMySQL' ...
> Warning in system("sh ./configure.win") : sh not found
> ERROR: configuration failed for package 'RMySQL'
> * removing 'C:/Users/Ted/Documents/R/win64-library/2.11/RMySQL'
> The downloaded packages are in
>          ?C:\Users\Ted\AppData\Local\Temp\Rtmp7xg8yb\downloaded_packages?
> Warning message:
> In install.packages("RMySQL", type = "source") :
>    installation of package 'RMySQL' had non-zero exit status
>>
>
> It is clearly failing before it could choke on the MYSQL_HOME value.  On
> reading it, it is no surprise to me that it failed to find sh as I recognize
> that as one of several unix shells.  What I don't know is how I should alter
> the instructions provided on the vanderbilt site so that the install works
> on Windows 7.  I know I have access to sh in cygwin, but I really don't want
> to confound my cygwin environment with what I use for R.
>
> While I have not used RTools before, I would assume that whatever issues I
> am presently facing would impact any package for which I need to build 64
> bit binaries for Windows 7.  So what do I need to know in order to
> effectively use RTools on compiling an arbitrary package, perhaps using
> RMySQL as an example (since that is the first one I need to compile).
>
> Thanks
>
> Ted
>
> 	[[alternative HTML version deleted]]
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From savicky at cs.cas.cz  Sat Nov 13 19:50:27 2010
From: savicky at cs.cas.cz (Petr Savicky)
Date: Sat, 13 Nov 2010 19:50:27 +0100
Subject: [Rd] opening graphics device with a given number
In-Reply-To: <AANLkTikPOQSggOfXxjsP1VgGeaFeHQ1mgtLM3-OUUwAD@mail.gmail.com>
References: <20101113104437.GA1994@cs.cas.cz>
	<AANLkTikPOQSggOfXxjsP1VgGeaFeHQ1mgtLM3-OUUwAD@mail.gmail.com>
Message-ID: <20101113185027.GA8926@cs.cas.cz>

On Sat, Nov 13, 2010 at 05:09:56AM -0800, Henrik Bengtsson wrote:
> See devSet() in R.utils, e.g.
> 
> > library("R.utils");
> > graphics.off();
> > devSet(6);
> > devSet("myFigure");  # Also possible
> > print(devList());
> myFigure Device 6
>        2        6

The function devSet() works fine and i will use it. Thank you
very much for this information.

Petr Savicky.


From kjetilbrinchmannhalvorsen at gmail.com  Sun Nov 14 00:25:03 2010
From: kjetilbrinchmannhalvorsen at gmail.com (Kjetil Halvorsen)
Date: Sat, 13 Nov 2010 20:25:03 -0300
Subject: [Rd] problem building R from svn repo
Message-ID: <AANLkTik=vyZEkNPhGCbYi1mrbrRwnTSFFzDTufJx=ig6@mail.gmail.com>

Hola!

I just changed my laptop to debian squeeze,
downloaded R devel from svn repo, as described in the manual.

Then I configured for building in a separate build dir with:

kjetil at kjetil:~/R/Rbuilddir$ sudo  ../svn/configure

--- which succeeded,  with:

R is now configured for x86_64-unknown-linux-gnu

  Source directory:          ../svn
  Installation directory:    /usr/local

  C compiler:                gcc -std=gnu99  -g -O2
  Fortran 77 compiler:       gfortran  -g -O

  C++ compiler:              g++  -g -O2
  Fortran 90/95 compiler:    gfortran -g -O
  Obj-C compiler:	

  Interfaces supported:      X11
  External libraries:        readline, ICU
  Additional capabilities:   NLS
  Options enabled:           shared BLAS, R profiling, Java

  Recommended packages:      yes

Then
sudo make

stops near the end with:

writing package indices
make[3]: Entering directory `/home/kjetil/R/Rbuilddir/src/library'
make[3]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
make[2]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
make[1]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
make[1]: Entering directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
make[2]: Entering directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
make[2]: *** No rule to make target `MASS.ts', needed by
`stamp-recommended'.  Stop.
make[2]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
make[1]: *** [recommended-packages] Error 2
make[1]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
make: *** [stamp-recommended] Error 2

--- not able to make the time-stamps!

Kjetil


From kasperdanielhansen at gmail.com  Sun Nov 14 02:18:53 2010
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Sat, 13 Nov 2010 20:18:53 -0500
Subject: [Rd] problem building R from svn repo
In-Reply-To: <AANLkTik=vyZEkNPhGCbYi1mrbrRwnTSFFzDTufJx=ig6@mail.gmail.com>
References: <AANLkTik=vyZEkNPhGCbYi1mrbrRwnTSFFzDTufJx=ig6@mail.gmail.com>
Message-ID: <AANLkTinic7jc0UE0JmMVwnrBeAmcFUh5w0sZj8B3mTZB@mail.gmail.com>

Before make'ing you need to get the recommended packages.  I do (with
your paths)
../svn/tools/sync-recommended
../svn/tools/sync-recommended

You should not run configure or make with sudo.  If you need to
install system-wide, you only need to run make install under sudo,
like
./configure
make
sudo make install

Kasper

On Sat, Nov 13, 2010 at 6:25 PM, Kjetil Halvorsen
<kjetilbrinchmannhalvorsen at gmail.com> wrote:
> Hola!
>
> I just changed my laptop to debian squeeze,
> downloaded R devel from svn repo, as described in the manual.
>
> Then I configured for building in a separate build dir with:
>
> kjetil at kjetil:~/R/Rbuilddir$ sudo ?../svn/configure
>
> --- which succeeded, ?with:
>
> R is now configured for x86_64-unknown-linux-gnu
>
> ?Source directory: ? ? ? ? ?../svn
> ?Installation directory: ? ?/usr/local
>
> ?C compiler: ? ? ? ? ? ? ? ?gcc -std=gnu99 ?-g -O2
> ?Fortran 77 compiler: ? ? ? gfortran ?-g -O
>
> ?C++ compiler: ? ? ? ? ? ? ?g++ ?-g -O2
> ?Fortran 90/95 compiler: ? ?gfortran -g -O
> ?Obj-C compiler:
>
> ?Interfaces supported: ? ? ?X11
> ?External libraries: ? ? ? ?readline, ICU
> ?Additional capabilities: ? NLS
> ?Options enabled: ? ? ? ? ? shared BLAS, R profiling, Java
>
> ?Recommended packages: ? ? ?yes
>
> Then
> sudo make
>
> stops near the end with:
>
> writing package indices
> make[3]: Entering directory `/home/kjetil/R/Rbuilddir/src/library'
> make[3]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
> make[2]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
> make[1]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
> make[1]: Entering directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
> make[2]: Entering directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
> make[2]: *** No rule to make target `MASS.ts', needed by
> `stamp-recommended'. ?Stop.
> make[2]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
> make[1]: *** [recommended-packages] Error 2
> make[1]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
> make: *** [stamp-recommended] Error 2
>
> --- not able to make the time-stamps!
>
> Kjetil
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From kjetilbrinchmannhalvorsen at gmail.com  Sun Nov 14 15:42:54 2010
From: kjetilbrinchmannhalvorsen at gmail.com (Kjetil Halvorsen)
Date: Sun, 14 Nov 2010 11:42:54 -0300
Subject: [Rd] problem building R from svn repo
In-Reply-To: <AANLkTinic7jc0UE0JmMVwnrBeAmcFUh5w0sZj8B3mTZB@mail.gmail.com>
References: <AANLkTik=vyZEkNPhGCbYi1mrbrRwnTSFFzDTufJx=ig6@mail.gmail.com>
	<AANLkTinic7jc0UE0JmMVwnrBeAmcFUh5w0sZj8B3mTZB@mail.gmail.com>
Message-ID: <AANLkTikh4JhZQWgA+RYodx657-j0VmgeGJMWmXoJJCLh@mail.gmail.com>

see below.

On Sat, Nov 13, 2010 at 10:18 PM, Kasper Daniel Hansen
<kasperdanielhansen at gmail.com> wrote:
> Before make'ing you need to get the recommended packages. ?I do (with
> your paths)
> ../svn/tools/sync-recommended
> ../svn/tools/sync-recommended
>

I did install the recommended packages.

> You should not run configure or make with sudo. ?If you need to
> install system-wide, you only need to run make install under sudo,
> like
> ./configure
> make
> sudo make install

I thougt so, and did so first. But that generated other errors!,
which was killed by using sudo.

kjetil

>
> Kasper
>
> On Sat, Nov 13, 2010 at 6:25 PM, Kjetil Halvorsen
> <kjetilbrinchmannhalvorsen at gmail.com> wrote:
>> Hola!
>>
>> I just changed my laptop to debian squeeze,
>> downloaded R devel from svn repo, as described in the manual.
>>
>> Then I configured for building in a separate build dir with:
>>
>> kjetil at kjetil:~/R/Rbuilddir$ sudo ?../svn/configure
>>
>> --- which succeeded, ?with:
>>
>> R is now configured for x86_64-unknown-linux-gnu
>>
>> ?Source directory: ? ? ? ? ?../svn
>> ?Installation directory: ? ?/usr/local
>>
>> ?C compiler: ? ? ? ? ? ? ? ?gcc -std=gnu99 ?-g -O2
>> ?Fortran 77 compiler: ? ? ? gfortran ?-g -O
>>
>> ?C++ compiler: ? ? ? ? ? ? ?g++ ?-g -O2
>> ?Fortran 90/95 compiler: ? ?gfortran -g -O
>> ?Obj-C compiler:
>>
>> ?Interfaces supported: ? ? ?X11
>> ?External libraries: ? ? ? ?readline, ICU
>> ?Additional capabilities: ? NLS
>> ?Options enabled: ? ? ? ? ? shared BLAS, R profiling, Java
>>
>> ?Recommended packages: ? ? ?yes
>>
>> Then
>> sudo make
>>
>> stops near the end with:
>>
>> writing package indices
>> make[3]: Entering directory `/home/kjetil/R/Rbuilddir/src/library'
>> make[3]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
>> make[2]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
>> make[1]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library'
>> make[1]: Entering directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
>> make[2]: Entering directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
>> make[2]: *** No rule to make target `MASS.ts', needed by
>> `stamp-recommended'. ?Stop.
>> make[2]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
>> make[1]: *** [recommended-packages] Error 2
>> make[1]: Leaving directory `/home/kjetil/R/Rbuilddir/src/library/Recommended'
>> make: *** [stamp-recommended] Error 2
>>
>> --- not able to make the time-stamps!
>>
>> Kjetil
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From rrburns at cox.net  Sun Nov 14 19:05:24 2010
From: rrburns at cox.net (Ron Burns)
Date: Sun, 14 Nov 2010 10:05:24 -0800
Subject: [Rd] LAPACK libraries improperly linked
Message-ID: <4CE024E4.6080904@cox.net>

I am not sure if this is an R development problem or not. I am starting 
with completely clean OS and and installing the latest version of R 
without trying to anything special but I am having trouble with the 
LAPACK library linking when I try to build packages that require them. 
I thought perhaps my problem may be if interest here.

I just dumped Vista off a laptop formatted the disk and installed Ubuntu 
10.10 (latest release) as the single operating system. I did all of the 
updates and then installed emacs and ess. Next I installed R by 
following the the usual instructions on the CRAN site. At this point all 
is working I am now in the process of installing the packages that I 
normally have installed. I am having a problem with the LAPACK libraries 
when installing lme4, but the problem is not unique to lme4. It is 
either a link to or missing LAPACK libs. The libs seem to be installed 
and there are links to them, but perhaps they are the wrong links. I am 
at a loss as what I am doing wrong since I have started with a 
completely clean machine and am not trying to anything special.

-------HERE is the R startup:
  <wow> (ron) R

R version 2.12.0 (2010-10-15)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i686-pc-linux-gnu (32-bit)

-------HERE is the final output from trying to install lme4:
* installing *source* package lme4 ...
** libs
gcc -I/usr/share/R/include   -I"/usr/lib/R/library/Matrix/include" 
-I"/usr/lib/R/library/stats/include"   -fpic  -std=gnu99 -O3 -pipe  -g 
-c init.c -o init.o
gcc -I/usr/share/R/include   -I"/usr/lib/R/library/Matrix/include" 
-I"/usr/lib/R/library/stats/include"   -fpic  -std=gnu99 -O3 -pipe  -g 
-c lmer.c -o lmer.o
gcc -I/usr/share/R/include   -I"/usr/lib/R/library/Matrix/include" 
-I"/usr/lib/R/library/stats/include"   -fpic  -std=gnu99 -O3 -pipe  -g 
-c local_stubs.c -o local_stubs.o
gcc -shared -o lme4.so init.o lmer.o local_stubs.o -llapack -lf77blas 
-latlas -lgfortran -lm -L/usr/lib/R/lib -lR
/usr/bin/ld: cannot find -lf77blas
/usr/bin/ld: cannot find -latlas
collect2: ld returned 1 exit status
make: *** [lme4.so] Error 1
ERROR: compilation failed for package lme4
* removing /usr/local/lib/R/site-library/lme4

---------The
/usr/bin/ld: cannot find -lf77blas
/usr/bin/ld: cannot find -latlas
errors are common to any other packages that use these libraries so it 
not an lme4 package problem.

---------BUT
[ 48 ] <wow> (ron) /usr/bin/R CMD config LAPACK_LIBS
-llapack

---------AND
<wow> (ron) dpkg -l | grep lapack
ii  liblapack-dev                        3.2.1-8 
library of linear algebra routines 3 - static version
ii  liblapack3gf                         3.2.1-8 
library of linear algebra routines 3 - shared version
[ 44 ] <wow> (ron)

--------I did see a message indicating "Also do 'ldd 
/usr/lib/R/bin/exec/R' and make sure you do _not_ have a depends on 
Rlapack.so.  ....":

[ 47 ] <wow> (ron) ldd /usr/lib/R/bin/exec/R
     linux-gate.so.1 =>  (0x00533000)
     libR.so => /usr/lib/libR.so (0x0073e000)
     libc.so.6 => /lib/libc.so.6 (0x00110000)
     libf77blas.so.3gf => /usr/lib/libf77blas.so.3gf (0x00ed4000)
     libatlas.so.3gf => /usr/lib/libatlas.so.3gf (0x0026e000)
     libgfortran.so.3 => /usr/lib/libgfortran.so.3 (0x00cca000)
     libm.so.6 => /lib/libm.so.6 (0x0065f000)
     libreadline.so.6 => /lib/libreadline.so.6 (0x00534000)
     libpcre.so.3 => /lib/libpcre.so.3 (0x00f5b000)
     liblzma.so.2 => /usr/lib/liblzma.so.2 (0x00568000)
     libz.so.1 => /lib/libz.so.1 (0x0058b000)
     libdl.so.2 => /lib/libdl.so.2 (0x005a0000)
     /lib/ld-linux.so.2 (0x00e67000)
     libcblas.so.3gf => /usr/lib/libcblas.so.3gf (0x005a4000)
     libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x005c4000)
     libpthread.so.0 => /lib/libpthread.so.0 (0x005e0000)
     libncurses.so.5 => /lib/libncurses.so.5 (0x005fa000)

[ 41 ] <wow> (ron) ls /usr/lib/libatlas*
/usr/lib/libatlas.so.3gf@
[ 42 ] <wow> (ron) ls /usr/lib/libf77blas*
/usr/lib/libf77blas.so.3gf@

-------- so these are there and linked OK and there is no Rlapack.

I am at a loss as to where to go from here.

Thank you all for your consideration.
     Ron Burns



-- 
R. R. Burns
Physicist (Retired)
Oceanside, CA


From edd at debian.org  Sun Nov 14 21:05:40 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 14 Nov 2010 14:05:40 -0600
Subject: [Rd] LAPACK libraries improperly linked
In-Reply-To: <4CE024E4.6080904@cox.net>
References: <4CE024E4.6080904@cox.net>
Message-ID: <19680.16660.738153.875648@max.nulle.part>


On 14 November 2010 at 10:05, Ron Burns wrote:
| I am not sure if this is an R development problem or not. I am starting 
| with completely clean OS and and installing the latest version of R 
| without trying to anything special but I am having trouble with the 
| LAPACK library linking when I try to build packages that require them. 
| I thought perhaps my problem may be if interest here.
| 
| I just dumped Vista off a laptop formatted the disk and installed Ubuntu 
| 10.10 (latest release) as the single operating system. I did all of the 
| updates and then installed emacs and ess. Next I installed R by 
| following the the usual instructions on the CRAN site. At this point all 
| is working I am now in the process of installing the packages that I 
| normally have installed. I am having a problem with the LAPACK libraries 
| when installing lme4, but the problem is not unique to lme4. It is 
| either a link to or missing LAPACK libs. The libs seem to be installed 
| and there are links to them, but perhaps they are the wrong links. I am 
| at a loss as what I am doing wrong since I have started with a 
| completely clean machine and am not trying to anything special.
| 
| -------HERE is the R startup:
|   <wow> (ron) R
| 
| R version 2.12.0 (2010-10-15)
| Copyright (C) 2010 The R Foundation for Statistical Computing
| ISBN 3-900051-07-0
| Platform: i686-pc-linux-gnu (32-bit)
| 
| -------HERE is the final output from trying to install lme4:
| * installing *source* package lme4 ...
| ** libs
| gcc -I/usr/share/R/include   -I"/usr/lib/R/library/Matrix/include" 
| -I"/usr/lib/R/library/stats/include"   -fpic  -std=gnu99 -O3 -pipe  -g 
| -c init.c -o init.o
| gcc -I/usr/share/R/include   -I"/usr/lib/R/library/Matrix/include" 
| -I"/usr/lib/R/library/stats/include"   -fpic  -std=gnu99 -O3 -pipe  -g 
| -c lmer.c -o lmer.o
| gcc -I/usr/share/R/include   -I"/usr/lib/R/library/Matrix/include" 
| -I"/usr/lib/R/library/stats/include"   -fpic  -std=gnu99 -O3 -pipe  -g 
| -c local_stubs.c -o local_stubs.o
| gcc -shared -o lme4.so init.o lmer.o local_stubs.o -llapack -lf77blas 
| -latlas -lgfortran -lm -L/usr/lib/R/lib -lR
| /usr/bin/ld: cannot find -lf77blas
| /usr/bin/ld: cannot find -latlas
| collect2: ld returned 1 exit status
| make: *** [lme4.so] Error 1
| ERROR: compilation failed for package lme4
| * removing /usr/local/lib/R/site-library/lme4
| 
| ---------The
| /usr/bin/ld: cannot find -lf77blas
| /usr/bin/ld: cannot find -latlas
| errors are common to any other packages that use these libraries so it 
| not an lme4 package problem.
| 
| ---------BUT
| [ 48 ] <wow> (ron) /usr/bin/R CMD config LAPACK_LIBS
| -llapack
| 
| ---------AND
| <wow> (ron) dpkg -l | grep lapack
| ii  liblapack-dev                        3.2.1-8 
| library of linear algebra routines 3 - static version
| ii  liblapack3gf                         3.2.1-8 
| library of linear algebra routines 3 - shared version
| [ 44 ] <wow> (ron)
| 
| --------I did see a message indicating "Also do 'ldd 
| /usr/lib/R/bin/exec/R' and make sure you do _not_ have a depends on 
| Rlapack.so.  ....":
| 
| [ 47 ] <wow> (ron) ldd /usr/lib/R/bin/exec/R
|      linux-gate.so.1 =>  (0x00533000)
|      libR.so => /usr/lib/libR.so (0x0073e000)
|      libc.so.6 => /lib/libc.so.6 (0x00110000)
|      libf77blas.so.3gf => /usr/lib/libf77blas.so.3gf (0x00ed4000)
|      libatlas.so.3gf => /usr/lib/libatlas.so.3gf (0x0026e000)
|      libgfortran.so.3 => /usr/lib/libgfortran.so.3 (0x00cca000)
|      libm.so.6 => /lib/libm.so.6 (0x0065f000)
|      libreadline.so.6 => /lib/libreadline.so.6 (0x00534000)
|      libpcre.so.3 => /lib/libpcre.so.3 (0x00f5b000)
|      liblzma.so.2 => /usr/lib/liblzma.so.2 (0x00568000)
|      libz.so.1 => /lib/libz.so.1 (0x0058b000)
|      libdl.so.2 => /lib/libdl.so.2 (0x005a0000)
|      /lib/ld-linux.so.2 (0x00e67000)
|      libcblas.so.3gf => /usr/lib/libcblas.so.3gf (0x005a4000)
|      libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x005c4000)
|      libpthread.so.0 => /lib/libpthread.so.0 (0x005e0000)
|      libncurses.so.5 => /lib/libncurses.so.5 (0x005fa000)
| 
| [ 41 ] <wow> (ron) ls /usr/lib/libatlas*
| /usr/lib/libatlas.so.3gf@
| [ 42 ] <wow> (ron) ls /usr/lib/libf77blas*
| /usr/lib/libf77blas.so.3gf@
| 
| -------- so these are there and linked OK and there is no Rlapack.
| 
| I am at a loss as to where to go from here.

I think you were pretty close by looking at lapack-dev and blas-dev, but you
missed atlas-dev.  Simply do

    $ sudo apt-get install r-base-dev

to install the meta-package providing R-build dependencies and you should be
set. Substitute your favourite package management front-end for apt-get here.

A nice trick is to also check build-dependencies of existing packages. As you
struggled with lme4, you could compare against the recorded Build-Depends on
the r-cran-lme4 package I maintain:

    Build-Depends: debhelper (>= 7.0.0), cdbs, r-base-dev (>= 2.12.0), \
           r-cran-matrix (>= 0.999375-31), r-cran-lattice, r-cran-nlme

That's from the most recent package lme4-0.999375-37 which you may also find
built for Ubuntu thanks to the tireless work of Vincent and Michael who port
my Debian (core) packages for R to the CRAN repositories. See the README at

    http://cran.r-project.org/bin/linux/ubuntu/

If you need further assistance, feel free to come to r-sig-debian for Debian
and Ubuntu matters.

Hth, Dirk

| 
| Thank you all for your consideration.
|      Ron Burns
| 
| 
| 
| -- 
| R. R. Burns
| Physicist (Retired)
| Oceanside, CA
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From sbbrouwer at gmail.com  Sun Nov 14 21:47:20 2010
From: sbbrouwer at gmail.com (Sietse Brouwer)
Date: Sun, 14 Nov 2010 21:47:20 +0100
Subject: [Rd] What is "R NEWS format"?
Message-ID: <AANLkTikRNgPmH_o-MPfn4ksjBZeUeOwt0j4LVAHO2Bkb@mail.gmail.com>

Dear list,

I've found a few references 'R NEWS format' (see below), but nowhere a
description of what this format *is*. Looking at examples on CRAN
didn't help, either: as far as I saw conventions were all over the
place.

5 example NEWS files (packages admittedly chosen for spread rather
than similarity)
Base: http://cran.r-project.org/src/base/NEWS
Vegan: http://cran.r-project.org/web/packages/vegan/NEWS
lme4: http://cran.r-project.org/web/packages/lme4/NEWS
plyr: http://cran.r-project.org/web/packages/plyr/NEWS
lattice: http://cran.r-project.org/web/packages/lattice/NEWS

The main reference I could find was to 'GNU news files', but that
one's more about form than contents, too.

So, the NEWS file that goes in the top of the package tree. Is there a
standard format that should be followed; or should there be one? All
answers appreciated.

Kind regards,

Sietse Brouwer

== Three references to (R's) NEWS files ==

>From "Writing R Extensions":
http://cran.r-project.org/doc/manuals/R-exts.html#Package-structure
"For the conventions for files NEWS and ChangeLog in the GNU project
see http://www.gnu.org/prep/standards/standards.html#Documentation."

Here's from the R Forge:
http://www.rforge.net/do/rf/eng/docs.html
"If a project contains a NEWS file in its repository root then it is
accessible (in beautified form) as "News" menu item. It is assumed to
be in a form similar to R's NEWS file, but any format will do."

A checkNEWS function in the 'tools' package (which I couldn't find on CRAN):
http://www.inside-r.org/r-doc/tools/checkNEWS
"Read R's ?NEWS? file or a similarly formatted one."


From rrburns at cox.net  Sun Nov 14 22:13:14 2010
From: rrburns at cox.net (Ron Burns)
Date: Sun, 14 Nov 2010 13:13:14 -0800
Subject: [Rd] LAPACK libraries improperly linked
In-Reply-To: <19680.16660.738153.875648@max.nulle.part>
References: <4CE024E4.6080904@cox.net>
	<19680.16660.738153.875648@max.nulle.part>
Message-ID: <4CE050EA.2050306@cox.net>

On 11/14/2010 12:05 PM, Dirk Eddelbuettel wrote:
>
> On 14 November 2010 at 10:05, Ron Burns wrote:
> | I am not sure if this is an R development problem or not. I am starting

> I think you were pretty close by looking at lapack-dev and blas-dev, but you
> missed atlas-dev.  Simply do
>
>      $ sudo apt-get install r-base-dev
>

Thank you for your kind and radid reply. I thought I had done that and 
if in fact I had because when I ran this just now I get a message that
"r-base-dev is already the newest version"

Regards,	
	Ron

-- 
R. R. Burns
Physicist (Retired)
Oceanside, CA


From cubranic at stat.ubc.ca  Mon Nov 15 02:12:13 2010
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Sun, 14 Nov 2010 17:12:13 -0800
Subject: [Rd] LAPACK libraries improperly linked
In-Reply-To: <4CE024E4.6080904@cox.net>
References: <4CE024E4.6080904@cox.net>
Message-ID: <201011141712.13680.cubranic@stat.ubc.ca>

On November 14, 2010 10:05:24 am Ron Burns wrote:
> [ 41 ] <wow> (ron) ls /usr/lib/libatlas*
> /usr/lib/libatlas.so.3gf@
> [ 42 ] <wow> (ron) ls /usr/lib/libf77blas*
> /usr/lib/libf77blas.so.3gf@
> 
> -------- so these are there and linked OK and there is no Rlapack.

These are soft links. Could you do an 'ls -l' and see what they are 
linked to? And if it's another link in /etc/alternatives, could you 
check its target, too? My guess is that the indirection in 
/etc/alternatives somehow went awry.

Davor


From cubranic at stat.ubc.ca  Mon Nov 15 02:15:15 2010
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Sun, 14 Nov 2010 17:15:15 -0800
Subject: [Rd] problem building R from svn repo
In-Reply-To: <AANLkTikh4JhZQWgA+RYodx657-j0VmgeGJMWmXoJJCLh@mail.gmail.com>
References: <AANLkTik=vyZEkNPhGCbYi1mrbrRwnTSFFzDTufJx=ig6@mail.gmail.com>
	<AANLkTinic7jc0UE0JmMVwnrBeAmcFUh5w0sZj8B3mTZB@mail.gmail.com>
	<AANLkTikh4JhZQWgA+RYodx657-j0VmgeGJMWmXoJJCLh@mail.gmail.com>
Message-ID: <201011141715.15354.cubranic@stat.ubc.ca>

> > You should not run configure or make with sudo.  If you need to
> > install system-wide, you only need to run make install under sudo,
> > like
> > ./configure
> > make
> > sudo make install
> 
> I thougt so, and did so first. But that generated other errors!,
> which was killed by using sudo.

Those errors were probably an indication of a deeper problem with your 
setup. Using 'sudo configure' didn't fix them, just sweep them under the 
carpet for a little while.

Davor


From cubranic at stat.ubc.ca  Mon Nov 15 02:15:15 2010
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Sun, 14 Nov 2010 17:15:15 -0800
Subject: [Rd] problem building R from svn repo
In-Reply-To: <AANLkTikh4JhZQWgA+RYodx657-j0VmgeGJMWmXoJJCLh@mail.gmail.com>
References: <AANLkTik=vyZEkNPhGCbYi1mrbrRwnTSFFzDTufJx=ig6@mail.gmail.com>
	<AANLkTinic7jc0UE0JmMVwnrBeAmcFUh5w0sZj8B3mTZB@mail.gmail.com>
	<AANLkTikh4JhZQWgA+RYodx657-j0VmgeGJMWmXoJJCLh@mail.gmail.com>
Message-ID: <201011141715.15354.cubranic@stat.ubc.ca>

> > You should not run configure or make with sudo.  If you need to
> > install system-wide, you only need to run make install under sudo,
> > like
> > ./configure
> > make
> > sudo make install
> 
> I thougt so, and did so first. But that generated other errors!,
> which was killed by using sudo.

Those errors were probably an indication of a deeper problem with your 
setup. Using 'sudo configure' didn't fix them, just sweep them under the 
carpet for a little while.

Davor


From rrburns at cox.net  Mon Nov 15 03:44:27 2010
From: rrburns at cox.net (Ron Burns)
Date: Sun, 14 Nov 2010 18:44:27 -0800
Subject: [Rd] LAPACK libraries improperly linked
In-Reply-To: <201011141712.13680.cubranic@stat.ubc.ca>
References: <4CE024E4.6080904@cox.net>
	<201011141712.13680.cubranic@stat.ubc.ca>
Message-ID: <4CE09E8B.2060001@cox.net>

Thank you for your help. With help from Dirk Eddelbuettel we found that 
I needed to explicitly install libatlas-base-dev.  After doing this 
everything worked with no further fuss.

Best Regards,
	Ron

On 11/14/2010 05:12 PM, Davor Cubranic wrote:
> On November 14, 2010 10:05:24 am Ron Burns wrote:
>> [ 41 ]<wow>  (ron) ls /usr/lib/libatlas*
>> /usr/lib/libatlas.so.3gf@
>> [ 42 ]<wow>  (ron) ls /usr/lib/libf77blas*
>> /usr/lib/libf77blas.so.3gf@
>>
>> -------- so these are there and linked OK and there is no Rlapack.
>
> These are soft links. Could you do an 'ls -l' and see what they are
> linked to? And if it's another link in /etc/alternatives, could you
> check its target, too? My guess is that the indirection in
> /etc/alternatives somehow went awry.
>
> Davor
>


-- 
R. R. Burns
Physicist (Retired)
Oceanside, CA


From andreas.borg at unimedizin-mainz.de  Mon Nov 15 11:10:52 2010
From: andreas.borg at unimedizin-mainz.de (Andreas Borg)
Date: Mon, 15 Nov 2010 11:10:52 +0100
Subject: [Rd] Package with multiple shared libraries
Message-ID: <4CE1072C.8010709@unimedizin-mainz.de>

Dear R-devel members,

I would like to compile a package with two seperate shared libraries. 
For example, in a package 'foo', a file 'bar.so' built from a distinct 
set of source files should be installed in addition to the default 
'foo.so' (or .dll on windows). Does anyone know about a way to achieve 
this without having a custom Makefile, e.g. via 'Makevars'?

Also, I'd be thankful for information on existing packages which make 
use of this or a similar customization.

Just in case anyone is interested in details: I have some C-code which 
is not intended to be loaded into R but into a SQLite database to which 
I connect via RSQLite. I would like to have these object in a seperate 
library.

Thanks and kind regards,

Andreas

-- 
Andreas Borg
Medizinische Informatik

UNIVERSIT?TSMEDIZIN
der Johannes Gutenberg-Universit?t
Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
Obere Zahlbacher Stra?e 69, 55131 Mainz
www.imbei.uni-mainz.de

Telefon +49 (0) 6131 175062
E-Mail: borg at imbei.uni-mainz.de

Diese E-Mail enth?lt vertrauliche und/oder rechtlich gesch?tzte Informationen. Wenn Sie nicht der
richtige Adressat sind oder diese E-Mail irrt?mlich erhalten haben, informieren Sie bitte sofort den
Absender und l?schen Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe
dieser Mail und der darin enthaltenen Informationen ist nicht gestattet.


From ripley at stats.ox.ac.uk  Mon Nov 15 12:02:02 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 15 Nov 2010 11:02:02 +0000 (GMT)
Subject: [Rd] Package with multiple shared libraries
In-Reply-To: <4CE1072C.8010709@unimedizin-mainz.de>
References: <4CE1072C.8010709@unimedizin-mainz.de>
Message-ID: <alpine.LFD.2.00.1011151051490.10769@gannet.stats.ox.ac.uk>

R CMD INSTALL is R code, and you can read it for yourself rather than 
asking other people to do so for you.  If you look in
tools:::.install.packages you will see

         shlib_install <- function(instdir, arch)
         {
             files <- Sys.glob(paste0("*", SHLIB_EXT))
             if (length(files)) {
             ...

so it does in general install all the *.so or *.dll's generated.  I am 
not aware of a package that does so for more than one, though.

On Mon, 15 Nov 2010, Andreas Borg wrote:

> Dear R-devel members,
>
> I would like to compile a package with two seperate shared libraries. For 
> example, in a package 'foo', a file 'bar.so' built from a distinct set of 
> source files should be installed in addition to the default 'foo.so' (or .dll 
> on windows). Does anyone know about a way to achieve this without having a 
> custom Makefile, e.g. via 'Makevars'?
>
> Also, I'd be thankful for information on existing packages which make use of 
> this or a similar customization.
>
> Just in case anyone is interested in details: I have some C-code which is not 
> intended to be loaded into R but into a SQLite database to which I connect 
> via RSQLite. I would like to have these object in a seperate library.

In which case it seems that the library should not be in the package's 
libs directory, which is intended for DSO/DLLs to be loaded into R.

If you want to do this in a public package you need to remember that 
multiple architectures are used on Mac OS and Windows.

> Thanks and kind regards,
>
> Andreas
>
> -- 
> Andreas Borg
> Medizinische Informatik
>
> UNIVERSIT?TSMEDIZIN
> der Johannes Gutenberg-Universit?t
> Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
> Obere Zahlbacher Stra?e 69, 55131 Mainz
> www.imbei.uni-mainz.de
>
> Telefon +49 (0) 6131 175062
> E-Mail: borg at imbei.uni-mainz.de

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ngkbr8es at gmail.com  Mon Nov 15 16:45:07 2010
From: ngkbr8es at gmail.com (Patrick Leyshock)
Date: Mon, 15 Nov 2010 07:45:07 -0800
Subject: [Rd] SEXPs and slots
In-Reply-To: <4CDDDDA8.3040003@fhcrc.org>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
Message-ID: <AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101115/d5704abd/attachment.pl>

From hadley at rice.edu  Mon Nov 15 17:46:42 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 15 Nov 2010 10:46:42 -0600
Subject: [Rd] SEXPs and slots
In-Reply-To: <AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
	<AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
Message-ID: <AANLkTik-03cbaasbd9+Avc8v=OqwLp8XJSzUC8cSXPiD@mail.gmail.com>

> 2. ?Any good references/resources for developing R? ?Nearly all the
> documents I've found are for programming R as a user, not as a developer. ?I
> have copies of the documentation, which are very helpful, but it'd be
> helpful to have additional resources to fill in their gaps.

The best advice I've received is to use Rcpp:
http://stackoverflow.com/questions/4106174/where-can-i-learn-to-how-to-write-c-code-to-speed-up-slow-r-functions.
 It provides a consistent api for C <-> R conversions and so is much
easier to learn.  Dirk and Romain are also churning out the
documentation, so there are lots of examples to learn from.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From edd at debian.org  Mon Nov 15 18:09:25 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 15 Nov 2010 11:09:25 -0600
Subject: [Rd] SEXPs and slots
In-Reply-To: <AANLkTik-03cbaasbd9+Avc8v=OqwLp8XJSzUC8cSXPiD@mail.gmail.com>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
	<AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
	<AANLkTik-03cbaasbd9+Avc8v=OqwLp8XJSzUC8cSXPiD@mail.gmail.com>
Message-ID: <19681.26949.516857.728680@max.nulle.part>


On 15 November 2010 at 10:46, Hadley Wickham wrote:
| > 2. ?Any good references/resources for developing R? ?Nearly all the
| > documents I've found are for programming R as a user, not as a developer. ?I
| > have copies of the documentation, which are very helpful, but it'd be
| > helpful to have additional resources to fill in their gaps.
| 
| The best advice I've received is to use Rcpp:
| http://stackoverflow.com/questions/4106174/where-can-i-learn-to-how-to-write-c-code-to-speed-up-slow-r-functions.
|  It provides a consistent api for C <-> R conversions and so is much
| easier to learn.  Dirk and Romain are also churning out the
| documentation, so there are lots of examples to learn from.

Thanks for the plug and endorsement -- we appreciate it. One correction
though:  We strive to provide seamless C++ and R integration, not C and R.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From mtmorgan at fhcrc.org  Mon Nov 15 19:01:47 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 15 Nov 2010 10:01:47 -0800
Subject: [Rd] SEXPs and slots
In-Reply-To: <AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>	<4CDDDDA8.3040003@fhcrc.org>
	<AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
Message-ID: <4CE1758B.1070600@fhcrc.org>

On 11/15/2010 07:45 AM, Patrick Leyshock wrote:
> Very helpful, thank you.
> 
> A couple other questions, please:
> 
> 1.  I've got a function written in C, named "my_c_function".  In my R
> code I call this function, passing to it an INTSXP and a STRSXP,
> respectively:
> 
>    result <- .Call("my_c_function", int_vector, str_vector)
> 
> The prototype of "my_c_function" is: 
> 
>    SEXP my_c_function(SEXP int_vec, SEXP str_vec);
> 
> Within my_c_function I am able to extract the values within the integer
> vector, e.g. I can grab the first value with these lines of code:
> 
>    int extracted_value;
>    extracted_value = *INTEGER(int_vec);
> 
> What I cannot figure out how to do is extract the value from the
> STRSXP.  I'm assuming that I can create a pointer to a character array,
> then malloc enough memory to hold the value.  Is there an analogous
> operation on "INTEGER" for STRSXPs? 

STRING_ELT(str_vec, 0)

gets the 0th component of str_vec, which is a CHARSXP, i.e., an SEXP for
a character string. The char* can be retrieved with CHAR, so the usual
paradigm is

  const char *x = CHAR(STRING_ELT(str_vec, 0));

note the const-ness of the char* -- it's not mutable, because R is
managing char * memory.

The converse action, of assigning to an element, is

  SET_STRING_ELT(str_vec, 0, mkChar("foo"));

mkChar() is creating a copy (if necessary) of "foo", managing it, and
returning a CHARSXP. Working through protection (which will likely be
your next obstacle ;) in this last example is a good exercise.

There is a parallel operation VECTOR_ELT / SET_VECTOR_ELT for lists.

> 2.  Any good references/resources for developing R?  Nearly all the
> documents I've found are for programming R as a user, not as a
> developer.  I have copies of the documentation, which are very helpful,
> but it'd be helpful to have additional resources to fill in their gaps.

Chambers, 2008, Software for Data Analysis: Programming with R chapters
11 & 12,

Gentleman, 2008, R Programming for Bioinformatics chapter 6

might be helpful, but by the time they arrive you might find that you're
most of the way through the material covered...

I guess my opinion is that Rcpp would not be useful for understanding
R's C layer, whatever its merits for 'getting the job done'.

Martin

> 
> Thank you,
> 
> Patrick
> 
> 
> On Fri, Nov 12, 2010 at 4:36 PM, Martin Morgan <mtmorgan at fhcrc.org
> <mailto:mtmorgan at fhcrc.org>> wrote:
> 
>     On 11/12/2010 02:31 PM, Patrick Leyshock wrote:
>     > Hello,
>     >
>     > I've created this class:
>     >
>     > setClass("example",
>     >    representation  (
>     >           size = "numeric",
>     >           id    = "character"
>     >    )
>     > )
>     >
>     > Suppose I create a new instance of this class:
>     >
>     >> x <- new("example", 4, "id_value")
>     >
>     > This creates an S4 object with two slots.  Am I correct in
>     thinking that
>     > slots are "filled" by SEXPs?
> 
>     Hi Patrick --
> 
>     If I
> 
>     > eg = new("example", size=4, id="id_value")
> 
>     (note the named arguments) and take a peak at the str'ucture of eg,
>     I see
> 
>     > str(eg)
>     Formal class 'example' [package ".GlobalEnv"] with 2 slots
>      ..@ size: num 4
>      ..@ id  : chr "id_value"
> 
>     so the @size slot is a numeric vector of length 1 containing the value
>     4. One doesn't really have to know the detailed representation, but one
>     can find out from
> 
>     > .Internal(inspect(eg))
>     @df70e48 25 S4SXP g0c0 [OBJ,NAM(2),gp=0x10,ATT]
>     ATTRIB:
>      @df70ef0 02 LISTSXP g0c0 []
>        TAG: @769258 01 SYMSXP g1c0 [MARK] "size"
>        @c0f6db8 14 REALSXP g0c1 [NAM(2)] (len=1, tl=0) 4
>        TAG: @15b0228 01 SYMSXP g1c0 [MARK,NAM(2)] "id"
>        @c0f6178 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
>          @12341c80 09 CHARSXP g0c2 [gp=0x20] "id_value"
>        TAG: @607ce8 01 SYMSXP g1c0 [MARK,NAM(2),gp=0x4000] "class"
>        @c0f6d58 16 STRSXP g0c1 [NAM(2),ATT] (len=1, tl=0)
>          @96ed08 09 CHARSXP g1c1 [MARK,gp=0x21] "example"
>        ATTRIB:
>          @df70fd0 02 LISTSXP g0c0 []
>            TAG: @624f70 01 SYMSXP g1c0 [MARK,NAM(2)] "package"
>            @c0f6d88 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
>              @67f5e0 09 CHARSXP g1c2 [MARK,gp=0x21,ATT] ".GlobalEnv"
> 
>     that the 'eg' object is an S4SXP with an attribute that is a LISTSXP.
>     The LISTSXP has elements that are tagged with SYMSXP representing the
>     slot name, and values that are REALSXP (for 'size') or STRSXP (for
>     'id'). The LISTSXP attribute itself has an attribute, which contains
>     information about the package where the class is defined. With these
>     hints one can see through the S4 interface to the underlying
>     implementation
> 
>     > attributes(eg)
>     $size
>     [1] 4
> 
>     $id
>     [1] "id_value"
> 
>     $class
>     [1] "example"
>     attr(,"package")
>     [1] ".GlobalEnv"
> 
>     But probably you have a specific goal in mind, and this is too much
>     information...
> 
>     Martin
> 
>     >
>     > Thanks, Patrick
>     >
>     >       [[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>     --
>     Computational Biology
>     Fred Hutchinson Cancer Research Center
>     1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109
> 
>     Location: M1-B861
>     Telephone: 206 667-2793
> 
> 


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From pleyshock at gmail.com  Mon Nov 15 21:07:05 2010
From: pleyshock at gmail.com (Patrick Leyshock)
Date: Mon, 15 Nov 2010 12:07:05 -0800
Subject: [Rd] SEXPs and slots
In-Reply-To: <4CE1758B.1070600@fhcrc.org>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
	<AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
	<4CE1758B.1070600@fhcrc.org>
Message-ID: <AANLkTi=A2qGJ3Wpnm2qQEKPyjEZZwWvq4_DA+AGXJqzq@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101115/bc6b63d6/attachment.pl>

From romain at r-enthusiasts.com  Mon Nov 15 21:15:03 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Mon, 15 Nov 2010 21:15:03 +0100
Subject: [Rd] SEXP and slots
Message-ID: <4CE194C7.30300@r-enthusiasts.com>

Hello,

Since people have whisperred about Rcpp, I'd like to play too.

> On 11/15/2010 07:45 AM, Patrick Leyshock wrote:
>> Very helpful, thank you.
>>
>> A couple other questions, please:
>>
>> 1.  I've got a function written in C, named "my_c_function".  In my R
>> code I call this function, passing to it an INTSXP and a STRSXP,
>> respectively:
>>
>>    result <- .Call("my_c_function", int_vector, str_vector)
>>
>> The prototype of "my_c_function" is:
>>
>>    SEXP my_c_function(SEXP int_vec, SEXP str_vec);
>>
>> Within my_c_function I am able to extract the values within the integer
>> vector, e.g. I can grab the first value with these lines of code:
>>
>>    int extracted_value;
>>    extracted_value = *INTEGER(int_vec);
>>
>> What I cannot figure out how to do is extract the value from the
>> STRSXP.  I'm assuming that I can create a pointer to a character array,
>> then malloc enough memory to hold the value.  Is there an analogous
>> operation on "INTEGER" for STRSXPs?
>
> STRING_ELT(str_vec, 0)
>
> gets the 0th component of str_vec, which is a CHARSXP, i.e., an SEXP for
> a character string. The char* can be retrieved with CHAR, so the usual
> paradigm is
>
>   const char *x = CHAR(STRING_ELT(str_vec, 0));
>
> note the const-ness of the char* -- it's not mutable, because R is
> managing char * memory.
>
> The converse action, of assigning to an element, is
>
>   SET_STRING_ELT(str_vec, 0, mkChar("foo"));
>
> mkChar() is creating a copy (if necessary) of "foo", managing it, and
> returning a CHARSXP. Working through protection (which will likely be
> your next obstacle ;) in this last example is a good exercise.

In Rcpp, you would wrap up the STRSXP into a CharacterVector and then 
pull things in and out using indexing:

Rcpp::CharacterVector aladdin(str_vec) ;
std::string first = aladdin[0] ;
aladdin[0] = "foobar" ;

> There is a parallel operation VECTOR_ELT / SET_VECTOR_ELT for lists.

Same thing for lists:

Rcpp::List yasmine( some_vec_sxp ) ;
double x = yasmine[0] ;
yasmine[0] = "bla" ;

>> 2.  Any good references/resources for developing R?  Nearly all the
>> documents I've found are for programming R as a user, not as a
>> developer.  I have copies of the documentation, which are very helpful,
>> but it'd be helpful to have additional resources to fill in their gaps.
>
> Chambers, 2008, Software for Data Analysis: Programming with R chapters
> 11 & 12,
>
> Gentleman, 2008, R Programming for Bioinformatics chapter 6
>
> might be helpful, but by the time they arrive you might find that you're
> most of the way through the material covered...
>
> I guess my opinion is that Rcpp would not be useful for understanding
> R's C layer, whatever its merits for 'getting the job done'.

Right, but we try to put a positive spin on this.

Rcpp hides the C API on purpose, so that users can concentrate on 
solving their problem rather than deal/fight with the C API.



Back to the original question, Rcpp also has (although it is less used) 
an Rcpp::S4 class that can be used to deal with slots. Here is a 
complete example using Rcpp and inline:

require( Rcpp)
require( inline )

setClass("example",
    representation  (
           size = "numeric",
           id    = "character"
    )
)

fx <- cxxfunction( signature(x = "example"),
'
     S4 obj(x) ;
     obj.slot( "size" ) = 10 ;
     obj.slot( "id"   ) = "foo" ;
     return obj ;
', plugin = "Rcpp" )

str( fx( new("example", size=4, id="id_value") ) )

But as Martin says, it all depends on what your goal is: getting the job 
done or learn about the internal C API.

Romain


> Martin
>
>>
>> Thank you,
>>
>> Patrick
>>
>>
>> On Fri, Nov 12, 2010 at 4:36 PM, Martin Morgan <mtmorgan <at> fhcrc.org
>> <mailto:mtmorgan <at> fhcrc.org>> wrote:
>>
>>     On 11/12/2010 02:31 PM, Patrick Leyshock wrote:
>>     > Hello,
>>     >
>>     > I've created this class:
>>     >
>>     > setClass("example",
>>     >    representation  (
>>     >           size = "numeric",
>>     >           id    = "character"
>>     >    )
>>     > )
>>     >
>>     > Suppose I create a new instance of this class:
>>     >
>>     >> x <- new("example", 4, "id_value")
>>     >
>>     > This creates an S4 object with two slots.  Am I correct in
>>     thinking that
>>     > slots are "filled" by SEXPs?
>>
>>     Hi Patrick --
>>
>>     If I
>>
>>     > eg = new("example", size=4, id="id_value")
>>
>>     (note the named arguments) and take a peak at the str'ucture of eg,
>>     I see
>>
>>     > str(eg)
>>     Formal class 'example' [package ".GlobalEnv"] with 2 slots
>>      ..@ size: num 4
>>      ..@ id  : chr "id_value"
>>
>>     so the @size slot is a numeric vector of length 1 containing the value
>>     4. One doesn't really have to know the detailed representation, but one
>>     can find out from
>>
>>     > .Internal(inspect(eg))
>>     @df70e48 25 S4SXP g0c0 [OBJ,NAM(2),gp=0x10,ATT]
>>     ATTRIB:
>>      @df70ef0 02 LISTSXP g0c0 []
>>        TAG: @769258 01 SYMSXP g1c0 [MARK] "size"
>>        @c0f6db8 14 REALSXP g0c1 [NAM(2)] (len=1, tl=0) 4
>>        TAG: @15b0228 01 SYMSXP g1c0 [MARK,NAM(2)] "id"
>>        @c0f6178 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
>>          @12341c80 09 CHARSXP g0c2 [gp=0x20] "id_value"
>>        TAG: @607ce8 01 SYMSXP g1c0 [MARK,NAM(2),gp=0x4000] "class"
>>        @c0f6d58 16 STRSXP g0c1 [NAM(2),ATT] (len=1, tl=0)
>>          @96ed08 09 CHARSXP g1c1 [MARK,gp=0x21] "example"
>>        ATTRIB:
>>          @df70fd0 02 LISTSXP g0c0 []
>>            TAG: @624f70 01 SYMSXP g1c0 [MARK,NAM(2)] "package"
>>            @c0f6d88 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
>>              @67f5e0 09 CHARSXP g1c2 [MARK,gp=0x21,ATT] ".GlobalEnv"
>>
>>     that the 'eg' object is an S4SXP with an attribute that is a LISTSXP.
>>     The LISTSXP has elements that are tagged with SYMSXP representing the
>>     slot name, and values that are REALSXP (for 'size') or STRSXP (for
>>     'id'). The LISTSXP attribute itself has an attribute, which contains
>>     information about the package where the class is defined. With these
>>     hints one can see through the S4 interface to the underlying
>>     implementation
>>
>>     > attributes(eg)
>>     $size
>>     [1] 4
>>
>>     $id
>>     [1] "id_value"
>>
>>     $class
>>     [1] "example"
>>     attr(,"package")
>>     [1] ".GlobalEnv"
>>
>>     But probably you have a specific goal in mind, and this is too much
>>     information...
>>
>>     Martin
>>
>>     >
>>     > Thanks, Patrick
>>     >
>>     >       [[alternative HTML version deleted]]
>>     >
>>     > ______________________________________________
>>     > R-devel <at> r-project.org <mailto:R-devel <at> r-project.org> mailing list
>>     > https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>     --
>>     Computational Biology
>>     Fred Hutchinson Cancer Research Center
>>     1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109
>>
>>     Location: M1-B861
>>     Telephone: 206 667-2793
>>
>>
>
> --
> Computational Biology
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109
>
> Location: M1-B861
> Telephone: 206 667-2793


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From ngkbr8es at gmail.com  Mon Nov 15 21:20:19 2010
From: ngkbr8es at gmail.com (Patrick Leyshock)
Date: Mon, 15 Nov 2010 12:20:19 -0800
Subject: [Rd] SEXPs and slots
In-Reply-To: <AANLkTi=A2qGJ3Wpnm2qQEKPyjEZZwWvq4_DA+AGXJqzq@mail.gmail.com>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
	<AANLkTi=_nmKKnGY97DSrrmSPE4j88mpfjqoiw73Bxh=t@mail.gmail.com>
	<4CE1758B.1070600@fhcrc.org>
	<AANLkTi=A2qGJ3Wpnm2qQEKPyjEZZwWvq4_DA+AGXJqzq@mail.gmail.com>
Message-ID: <AANLkTinohEvs-kg17eizH7rc-=7UnSeMg7=n_JoK8Hyy@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101115/4b6fe2d5/attachment.pl>

From janko.thyson at ku-eichstaett.de  Tue Nov 16 00:11:42 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Tue, 16 Nov 2010 00:11:42 +0100
Subject: [Rd] Create NAMESPACE file as 'package.skeleton()' would do
Message-ID: <005001cb851a$771f3950$655dabf0$@thyson@ku-eichstaett.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101116/cc7d8fcd/attachment.pl>

From hadley at rice.edu  Tue Nov 16 00:14:12 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 15 Nov 2010 17:14:12 -0600
Subject: [Rd] Create NAMESPACE file as 'package.skeleton()' would do
In-Reply-To: <550005484823155668@unknownmsgid>
References: <550005484823155668@unknownmsgid>
Message-ID: <AANLkTikp51hwKm4gk-ayGtc9ct3bC_wU8zrekmwPS2Rp@mail.gmail.com>

If you're using roxygenise, explicitly tag functions that you want to
export with @export.
Hadley

On Mon, Nov 15, 2010 at 5:11 PM, Janko Thyson
<janko.thyson at ku-eichstaett.de> wrote:
> Hi there,
>
>
>
> is there a way to create a NAMESPACE file based on Rd-files (or whatever is
> needed in order to apply the regular expression "^[[:alpha:]]+" without(!)
> resorting to package.skeleton() (as this kind of interferes with
> roxygenize() pretty often)?
>
>
>
> Thanks a lot,
>
> Janko
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From janko.thyson at ku-eichstaett.de  Tue Nov 16 00:26:34 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Tue, 16 Nov 2010 00:26:34 +0100
Subject: [Rd] R5 reference classes: how to initialize exactly?
Message-ID: <005601cb851c$8ac22970$a0467c50$@thyson@ku-eichstaett.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101116/86a4af16/attachment.pl>

From janko.thyson at ku-eichstaett.de  Tue Nov 16 00:30:28 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Tue, 16 Nov 2010 00:30:28 +0100
Subject: [Rd] R5 reference classes: how to initialize exactly?
Message-ID: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101116/86900715/attachment.pl>

From hadley at rice.edu  Tue Nov 16 00:26:47 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 15 Nov 2010 17:26:47 -0600
Subject: [Rd] Trying to understand the search path and namespaces
Message-ID: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>

Hi all,

I'm trying to understand how the search path and namespaces interact.
For example, take the devtools package which suggests the testthat
package.  Here's what the search path looks like after I load each of
those packages:

> library(devtools)
> search()
 [1] ".GlobalEnv"        "package:devtools"  "package:stats"
 [4] "package:graphics"  "package:grDevices" "package:utils"
 [7] "package:datasets"  "package:methods"   "Autoloads"
[10] "package:base"
> library(testthat)
> search()
 [1] ".GlobalEnv"        "package:testthat"  "package:devtools"
 [4] "package:stats"     "package:graphics"  "package:grDevices"
 [7] "package:utils"     "package:datasets"  "package:methods"
[10] "Autoloads"         "package:base"

My question is this: when I execute the test function in devtools
function it calls the the test_package function in the testthat
package - but that function is located higher up the search path - how
does R find it?

(I ask this question because I'm trying to simulate package loading
from within R to simplify the development cycle, but something is
missing in my knowledge of namespaces, and so I have the devel
versions of my packages can't access packages that are loaded after
they are)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hb at biostat.ucsf.edu  Tue Nov 16 01:02:19 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Mon, 15 Nov 2010 16:02:19 -0800
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
Message-ID: <AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>

On Mon, Nov 15, 2010 at 3:26 PM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> I'm trying to understand how the search path and namespaces interact.
> For example, take the devtools package which suggests the testthat
> package. ?Here's what the search path looks like after I load each of
> those packages:
>
>> library(devtools)
>> search()
> ?[1] ".GlobalEnv" ? ? ? ?"package:devtools" ?"package:stats"
> ?[4] "package:graphics" ?"package:grDevices" "package:utils"
> ?[7] "package:datasets" ?"package:methods" ? "Autoloads"
> [10] "package:base"
>> library(testthat)
>> search()
> ?[1] ".GlobalEnv" ? ? ? ?"package:testthat" ?"package:devtools"
> ?[4] "package:stats" ? ? "package:graphics" ?"package:grDevices"
> ?[7] "package:utils" ? ? "package:datasets" ?"package:methods"
> [10] "Autoloads" ? ? ? ? "package:base"
>
> My question is this: when I execute the test function in devtools
> function it calls the the test_package function in the testthat
> package - but that function is located higher up the search path - how
> does R find it?

With a small risk of being incorrect (and the chance of learning
something new), I'll give it a try:

A search for a functions/objects/... that is not in the same package
environment is done in the order that the search() path gives.  The
exception to this iff your package has a namespace, then the 'base'
package environment is always searched first (before any other
environments).  The ordering of the search is important when there
exist multiple package environments with the same function.

Is that of any help?

/Henrik

>
> (I ask this question because I'm trying to simulate package loading
> from within R to simplify the development cycle, but something is
> missing in my knowledge of namespaces, and so I have the devel
> versions of my packages can't access packages that are loaded after
> they are)
>
> Hadley
>
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Tue Nov 16 01:51:09 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 15 Nov 2010 18:51:09 -0600
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
Message-ID: <AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>

> With a small risk of being incorrect (and the chance of learning
> something new), I'll give it a try:
>
> A search for a functions/objects/... that is not in the same package
> environment is done in the order that the search() path gives. ?The
> exception to this iff your package has a namespace, then the 'base'
> package environment is always searched first (before any other
> environments). ?The ordering of the search is important when there
> exist multiple package environments with the same function.
>
> Is that of any help?

Well, that's what I thought too.  But:

parents <- function(x) {
  if (identical(x, emptyenv())) return()
  c(environmentName(x), parents(parent.env(x)))
}
> parents(as.environment("package:devtools"))
[1] "package:devtools" "package:methods"  "Autoloads"        "base"

And package:testthat isn't listed there.  (But Autoloads is suggestive...)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Tue Nov 16 01:56:17 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 15 Nov 2010 18:56:17 -0600
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
	<AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
Message-ID: <AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>

> Well, that's what I thought too. ?But:
>
> parents <- function(x) {
> ?if (identical(x, emptyenv())) return()
> ?c(environmentName(x), parents(parent.env(x)))
> }
>> parents(as.environment("package:devtools"))
> [1] "package:devtools" "package:methods" ?"Autoloads" ? ? ? ?"base"
>
> And package:testthat isn't listed there. ?(But Autoloads is suggestive...)

Hmmm, autoloads isn't it:

> parent.env(parent.env(as.environment("package:devtools")))
<environment: 0x100951f88>
attr(,"name")
[1] "Autoloads"
> ls(parent.env(parent.env(as.environment("package:devtools"))))
character(0)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From mtmorgan at fhcrc.org  Tue Nov 16 02:27:34 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 15 Nov 2010 17:27:34 -0800
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>	<AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
	<AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>
Message-ID: <4CE1DE06.9060809@fhcrc.org>

On 11/15/2010 04:56 PM, Hadley Wickham wrote:
>> Well, that's what I thought too.  But:
>>
>> parents <- function(x) {
>>  if (identical(x, emptyenv())) return()
>>  c(environmentName(x), parents(parent.env(x)))
>> }
>>> parents(as.environment("package:devtools"))
>> [1] "package:devtools" "package:methods"  "Autoloads"        "base"
>>
>> And package:testthat isn't listed there.  (But Autoloads is suggestive...)
> 
> Hmmm, autoloads isn't it:
> 
>> parent.env(parent.env(as.environment("package:devtools")))
> <environment: 0x100951f88>
> attr(,"name")
> [1] "Autoloads"
>> ls(parent.env(parent.env(as.environment("package:devtools"))))
> character(0)

1.6 of Writing R Extensions says

Note that adding a name space to a package changes the search strategy.
The package name space comes first in the search, then the imports, then
the base name space and then the normal search path.

I'm not sure of the details, but I think

  parents(getNamespace("devtools"))

will give you what you want, with the gory details in loadNamespace
makeNamespace

Martin


> 
> Hadley
> 


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From murdoch.duncan at gmail.com  Tue Nov 16 02:43:44 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 15 Nov 2010 20:43:44 -0500
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
Message-ID: <4CE1E1D0.2010200@gmail.com>

Hadley Wickham wrote:
> Hi all,
> 
> I'm trying to understand how the search path and namespaces interact.
> For example, take the devtools package which suggests the testthat
> package.  Here's what the search path looks like after I load each of
> those packages:

Luke Tierney wrote up a nice description of this a few years ago.  It's 
either on developer.r-project.org, or in an old issue of R News.

Duncan Murdoch

> 
>> library(devtools)
>> search()
>  [1] ".GlobalEnv"        "package:devtools"  "package:stats"
>  [4] "package:graphics"  "package:grDevices" "package:utils"
>  [7] "package:datasets"  "package:methods"   "Autoloads"
> [10] "package:base"
>> library(testthat)
>> search()
>  [1] ".GlobalEnv"        "package:testthat"  "package:devtools"
>  [4] "package:stats"     "package:graphics"  "package:grDevices"
>  [7] "package:utils"     "package:datasets"  "package:methods"
> [10] "Autoloads"         "package:base"
> 
> My question is this: when I execute the test function in devtools
> function it calls the the test_package function in the testthat
> package - but that function is located higher up the search path - how
> does R find it?
> 
> (I ask this question because I'm trying to simulate package loading
> from within R to simplify the development cycle, but something is
> missing in my knowledge of namespaces, and so I have the devel
> versions of my packages can't access packages that are loaded after
> they are)
> 
> Hadley
>


From hadley at rice.edu  Tue Nov 16 02:45:30 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 15 Nov 2010 19:45:30 -0600
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <4CE1DE06.9060809@fhcrc.org>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
	<AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
	<AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>
	<4CE1DE06.9060809@fhcrc.org>
Message-ID: <AANLkTi=BsP2mE8avreNMBx_P-ORcEhRB_mK0-k8fFTpq@mail.gmail.com>

> 1.6 of Writing R Extensions says
>
> Note that adding a name space to a package changes the search strategy.
> The package name space comes first in the search, then the imports, then
> the base name space and then the normal search path.
>
> I'm not sure of the details, but I think
>
> ?parents(getNamespace("devtools"))

Ah, my mistake was assuming that the package namespace and environment
were the same thing.

Interestingly the namespace is dynamic:

> parents(getNamespace("devtools"))
...
[31] "base"
> library(roxygen)
> parents(getNamespace("devtools"))
...
[31] "Autoloads"            "base"

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From markleeds2 at gmail.com  Tue Nov 16 02:54:00 2010
From: markleeds2 at gmail.com (Mark Leeds)
Date: Mon, 15 Nov 2010 20:54:00 -0500
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <4CE1E1D0.2010200@gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<4CE1E1D0.2010200@gmail.com>
Message-ID: <AANLkTinZxGQb1MHF97NAZYo7qxexbuf4BROsvKOKEeyJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101115/49c67570/attachment.pl>

From bbolker at gmail.com  Tue Nov 16 02:59:26 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 16 Nov 2010 01:59:26 +0000 (UTC)
Subject: [Rd] Bug in read.table?
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
	<4CD6D121.1020402@acm.org>
	<2145.78.147.236.204.1289166988.squirrel@paleo.ija.csic.es>
	<loom.20101107T225942-16@post.gmane.org>
	<loom.20101108T003515-462@post.gmane.org>
	<loom.20101109T021750-294@post.gmane.org>
Message-ID: <loom.20101116T025448-997@post.gmane.org>

Ben Bolker <bbolker <at> gmail.com> writes:

> 
> Ben Bolker <bbolker <at> gmail.com> writes:
> 
> >
> >
> 
>    Can simplify this still farther:
> 
> a b'c
> d e'f
> g h'i

  This example file leads to duplicate lines.
Arguably it should have behavior analogous to:

> scan(what="")
1: a b'c
3: d e'f
5: g h'i
7: Read 6 items
[1] "a"   "b'c" "d"   "e'f" "g"   "h'i"


> 
> >  One of the first things that happens in read.table is that
> > the first few lines are read with readTableHead:
> > 
> >   lines <- .Internal(readTableHead(file, nlines, comment.char, 
> >        blank.lines.skip, quote, sep))
> > 
>   in this case, this reads the first two lines as one line;
> the single quote at pos. 4 of the first line closes on pos.
> 4 of the second line, preventing the first new line from
> ending a line.
> 
>   R then pushes back two copies of the lines that have
> been read (this is normal behavior; I don't quite follow the
> logic).
> 
>   The rest of the file is read with scan(), 1 line at a time.
> However, there is the discrepancy between the way
> that readTableHead interprets new lines in the middle of
> quoted strings (it ignores them) and the way that scan()
> interprets them (it takes them as the end of the quoted string).


  Ping?
  I think this counts as a small, but real, bug. Should I go ahead
and report it as such, or would someone explain why it's not a bug?

  cheers
    Ben Bolker


From berwin at maths.uwa.edu.au  Tue Nov 16 08:59:33 2010
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue, 16 Nov 2010 15:59:33 +0800
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTi=BsP2mE8avreNMBx_P-ORcEhRB_mK0-k8fFTpq@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
	<AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
	<AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>
	<4CE1DE06.9060809@fhcrc.org>
	<AANLkTi=BsP2mE8avreNMBx_P-ORcEhRB_mK0-k8fFTpq@mail.gmail.com>
Message-ID: <20101116155933.41901966@bossiaea>

G'day Hadley,

On Mon, 15 Nov 2010 19:45:30 -0600
Hadley Wickham <hadley at rice.edu> wrote:

> > 1.6 of Writing R Extensions says
> >
> > Note that adding a name space to a package changes the search
> > strategy. The package name space comes first in the search, then
> > the imports, then the base name space and then the normal search
> > path.
> >
> > I'm not sure of the details, but I think
> >
> > ?parents(getNamespace("devtools"))
> 
> Ah, my mistake was assuming that the package namespace and environment
> were the same thing.
> 
> Interestingly the namespace is dynamic:

Not sure what you mean with this.  Section 1.6 of "Writing R
Extensions" explicitly states:

	Name spaces are @emph{sealed} once they are loaded.  Sealing
	means that imports and exports cannot be changed and that
	internal variable bindings cannot be changed.

> > parents(getNamespace("devtools"))
> ...
> [31] "base"
> > library(roxygen)
> > parents(getNamespace("devtools"))
> ...
> [31] "Autoloads"            "base"

Well, as the part of "Writing R Extensions" that Martin quoted states,
the normal search path is part of the search path used by packages with
name spaces.  So if you attach another package via library(), the
normal search path changes and, hence,
`parents(getNamespace("devtools"))' has one more location to report.

Cheers,

	Berwin


From andreas.borg at unimedizin-mainz.de  Tue Nov 16 09:20:57 2010
From: andreas.borg at unimedizin-mainz.de (Andreas Borg)
Date: Tue, 16 Nov 2010 09:20:57 +0100
Subject: [Rd] Package with multiple shared libraries
In-Reply-To: <alpine.LFD.2.00.1011151051490.10769@gannet.stats.ox.ac.uk>
References: <4CE1072C.8010709@unimedizin-mainz.de>
	<alpine.LFD.2.00.1011151051490.10769@gannet.stats.ox.ac.uk>
Message-ID: <4CE23EE9.8000303@unimedizin-mainz.de>

Thanks for your reply. Actually my problem is not how to install the 
libraries in the sense of copying them to the right place, but how to 
build more than one .so or .dll file. Anyway, I did read the code and 
found that absence of a Makefile, a single library is built from all 
source files in directory src:

                  srcs <- dir(pattern = "\\.([cfmM]|cc|cpp|f90|f95|mm)$")

                  [...]

                          has_error <- run_shlib(pkg_name, srcs,
                            instdir, "")

where the last call basically executes R CMD SHLIB on the sources.

So a custom Makefile seems the only feasible solution. Still I'd be 
thankful to know about other packages (if they exist) which create other 
than the standard library files.

Best regards,

Andreas

Prof Brian Ripley schrieb:
> R CMD INSTALL is R code, and you can read it for yourself rather than 
> asking other people to do so for you.  If you look in
> tools:::.install.packages you will see
>
>         shlib_install <- function(instdir, arch)
>         {
>             files <- Sys.glob(paste0("*", SHLIB_EXT))
>             if (length(files)) {
>             ...
>
> so it does in general install all the *.so or *.dll's generated.  I am 
> not aware of a package that does so for more than one, though.
>
> On Mon, 15 Nov 2010, Andreas Borg wrote:
>
>> Dear R-devel members,
>>
>> I would like to compile a package with two seperate shared libraries. 
>> For example, in a package 'foo', a file 'bar.so' built from a 
>> distinct set of source files should be installed in addition to the 
>> default 'foo.so' (or .dll on windows). Does anyone know about a way 
>> to achieve this without having a custom Makefile, e.g. via 'Makevars'?
>>
>> Also, I'd be thankful for information on existing packages which make 
>> use of this or a similar customization.
>>
>> Just in case anyone is interested in details: I have some C-code 
>> which is not intended to be loaded into R but into a SQLite database 
>> to which I connect via RSQLite. I would like to have these object in 
>> a seperate library.
>
> In which case it seems that the library should not be in the package's 
> libs directory, which is intended for DSO/DLLs to be loaded into R.
>
> If you want to do this in a public package you need to remember that 
> multiple architectures are used on Mac OS and Windows.
>
>> Thanks and kind regards,
>>
>> Andreas
>>
>> -- 
>> Andreas Borg
>> Medizinische Informatik
>>
>> UNIVERSIT?TSMEDIZIN
>> der Johannes Gutenberg-Universit?t
>> Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
>> Obere Zahlbacher Stra?e 69, 55131 Mainz
>> www.imbei.uni-mainz.de
>>
>> Telefon +49 (0) 6131 175062
>> E-Mail: borg at imbei.uni-mainz.de
>


-- 
Andreas Borg
Medizinische Informatik

UNIVERSIT?TSMEDIZIN
der Johannes Gutenberg-Universit?t
Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
Obere Zahlbacher Stra?e 69, 55131 Mainz
www.imbei.uni-mainz.de

Telefon +49 (0) 6131 175062
E-Mail: borg at imbei.uni-mainz.de

Diese E-Mail enth?lt vertrauliche und/oder rechtlich gesch?tzte Informationen. Wenn Sie nicht der
richtige Adressat sind oder diese E-Mail irrt?mlich erhalten haben, informieren Sie bitte sofort den
Absender und l?schen Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe
dieser Mail und der darin enthaltenen Informationen ist nicht gestattet.


From romain at r-enthusiasts.com  Tue Nov 16 10:04:23 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Tue, 16 Nov 2010 10:04:23 +0100
Subject: [Rd] SEXP and slots
In-Reply-To: <4CE194C7.30300@r-enthusiasts.com>
References: <4CE194C7.30300@r-enthusiasts.com>
Message-ID: <4CE24917.60701@r-enthusiasts.com>

Le 15/11/10 21:15, Romain Francois a ?crit :
>
> Hello,
>
> Since people have whisperred about Rcpp, I'd like to play too.
>
>> On 11/15/2010 07:45 AM, Patrick Leyshock wrote:
>>> Very helpful, thank you.
>>>
>>> A couple other questions, please:
>>>
>>> 1. I've got a function written in C, named "my_c_function". In my R
>>> code I call this function, passing to it an INTSXP and a STRSXP,
>>> respectively:
>>>
>>> result <- .Call("my_c_function", int_vector, str_vector)
>>>
>>> The prototype of "my_c_function" is:
>>>
>>> SEXP my_c_function(SEXP int_vec, SEXP str_vec);
>>>
>>> Within my_c_function I am able to extract the values within the integer
>>> vector, e.g. I can grab the first value with these lines of code:
>>>
>>> int extracted_value;
>>> extracted_value = *INTEGER(int_vec);
>>>
>>> What I cannot figure out how to do is extract the value from the
>>> STRSXP. I'm assuming that I can create a pointer to a character array,
>>> then malloc enough memory to hold the value. Is there an analogous
>>> operation on "INTEGER" for STRSXPs?
>>
>> STRING_ELT(str_vec, 0)
>>
>> gets the 0th component of str_vec, which is a CHARSXP, i.e., an SEXP for
>> a character string. The char* can be retrieved with CHAR, so the usual
>> paradigm is
>>
>> const char *x = CHAR(STRING_ELT(str_vec, 0));
>>
>> note the const-ness of the char* -- it's not mutable, because R is
>> managing char * memory.
>>
>> The converse action, of assigning to an element, is
>>
>> SET_STRING_ELT(str_vec, 0, mkChar("foo"));
>>
>> mkChar() is creating a copy (if necessary) of "foo", managing it, and
>> returning a CHARSXP. Working through protection (which will likely be
>> your next obstacle ;) in this last example is a good exercise.
>
> In Rcpp, you would wrap up the STRSXP into a CharacterVector and then
> pull things in and out using indexing:
>
> Rcpp::CharacterVector aladdin(str_vec) ;
> std::string first = aladdin[0] ;
> aladdin[0] = "foobar" ;

As it was pointed out to me offlist, the code above fails to compile. 
This is what you get when you reply to emails while watching a Woody 
Allen movie ...

Anyway, the reason for this is that the line:

std::string first = aladdin[0] ;

uses the __constructor__ of std::string and not the assignment operator. 
The code below does work :

std::string first ;
Rcpp::CharacterVector aladdin(str_vec) ;
first = aladdin[0] ;
aladdin[0] = "foobar" ;


Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From pdalgd at gmail.com  Tue Nov 16 14:04:16 2010
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 16 Nov 2010 14:04:16 +0100
Subject: [Rd] Bug in read.table?
In-Reply-To: <loom.20101116T025448-997@post.gmane.org>
References: <4CD1674E.6070807@yorku.ca> <002701cb7b65$5a516c30$0ef44490$@ca>
	<4CD1A6BE.3020801@yorku.ca>
	<1941.78.147.225.236.1288992147.squirrel@paleo.ija.csic.es>
	<4CD6D121.1020402@acm.org>
	<2145.78.147.236.204.1289166988.squirrel@paleo.ija.csic.es>
	<loom.20101107T225942-16@post.gmane.org>
	<loom.20101108T003515-462@post.gmane.org>
	<loom.20101109T021750-294@post.gmane.org>
	<loom.20101116T025448-997@post.gmane.org>
Message-ID: <95D9C788-FDEA-438C-BA19-19E8625389F0@gmail.com>


On Nov 16, 2010, at 02:59 , Ben Bolker wrote:

> Ben Bolker <bbolker <at> gmail.com> writes:
> 
>> 
>> Ben Bolker <bbolker <at> gmail.com> writes:
>> 
>>> 
>>> 
>> 
>>   Can simplify this still farther:
>> 
>> a b'c
>> d e'f
>> g h'i
> 
>  This example file leads to duplicate lines.
> Arguably it should have behavior analogous to:
> 
>> scan(what="")
> 1: a b'c
> 3: d e'f
> 5: g h'i
> 7: Read 6 items
> [1] "a"   "b'c" "d"   "e'f" "g"   "h'i"
> 
> 
>> 
>>> One of the first things that happens in read.table is that
>>> the first few lines are read with readTableHead:
>>> 
>>>  lines <- .Internal(readTableHead(file, nlines, comment.char, 
>>>       blank.lines.skip, quote, sep))
>>> 
>>  in this case, this reads the first two lines as one line;
>> the single quote at pos. 4 of the first line closes on pos.
>> 4 of the second line, preventing the first new line from
>> ending a line.
>> 
>>  R then pushes back two copies of the lines that have
>> been read (this is normal behavior; I don't quite follow the
>> logic).
>> 
>>  The rest of the file is read with scan(), 1 line at a time.
>> However, there is the discrepancy between the way
>> that readTableHead interprets new lines in the middle of
>> quoted strings (it ignores them) and the way that scan()
>> interprets them (it takes them as the end of the quoted string).
> 
> 
>  Ping?
>  I think this counts as a small, but real, bug. Should I go ahead
> and report it as such, or would someone explain why it's not a bug?
> 

I think it can be defended to file as a bug, but it is tricky to pinpoint exactly what the issue is. E.g., notice that adding a few spaces changes the behaviour of scan() considerably:

> scan(what="")
1:  a b 'c
1: d e' f
5: g h' i
8: 
Read 7 items
[1] "a"      "b"      "c\nd e" "f"      "g"      "h'"     "i"     

(I'm confused... What is it that we really want here?)

Also, as you noted originally, beware the "Well don't do that then" aspect...

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From cbeleites at units.it  Tue Nov 16 14:21:39 2010
From: cbeleites at units.it (Claudia Beleites)
Date: Tue, 16 Nov 2010 14:21:39 +0100
Subject: [Rd] Vignette Questions
Message-ID: <4CE28563.30903@units.it>

Dear List,

I recently stumbled over the possibility and need to specifiy
% \VignetteDepends{}
in my vignettes. I did not know about this, and I notice that it is not 
mentioned in the R-extensions manual section "Writing package vignettes".

I have some questions with regards to that:

- would it be possible to include into the section "Writing package 
vignettes" some hint that besides \VignetteIndexEntry also
\VignetteDepends{}
\VignetteKeywords{}
\VignettePackage{}
exist (and should be used)?
Also a link to the R-News Paper "Sweave, Part II: Package Vignettes" may 
be very helpful.

- Is the documentation of these somewhere else where I didn't find it?

- Are there more such commands?

- Is there a way to ask R CMD check to check whether all dependencies of 
the vignettes are correctly specified?
Of course, on my computer all required packages are available...

- Which dependencies should go into \VignetteDepends{}?
Only those without Priority in the packageDescription, or also 
recommended packages, or maybe even base packages?
Should I specify the package that the vignette belongs to itself?

- Related, but slightly different: is there a way to temporarily enforce 
that specified packages should not be loaded (or that only specified 
packages are allowed to be loaded)?
I have a few functions in my package that do use e.g. plotrix if it is 
available but otherwise should work in a less fancy way.
Till now I test them on an old computer where I didn't install those 
packages but that's quite a hassle.

Thank you very much for your kind help!

Claudia Beleites

--
Claudia Beleites
Dipartimento dei Materiali e delle Risorse Naturali
Universit? degli Studi di Trieste
Via Valerio 2
I-34127 Trieste
ITALY

email: cbeleites at units.it
phone: +39 (0 40) 5 58-34 68


From hadley at rice.edu  Tue Nov 16 14:35:09 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 16 Nov 2010 07:35:09 -0600
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <20101116155933.41901966@bossiaea>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
	<AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
	<AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>
	<4CE1DE06.9060809@fhcrc.org>
	<AANLkTi=BsP2mE8avreNMBx_P-ORcEhRB_mK0-k8fFTpq@mail.gmail.com>
	<20101116155933.41901966@bossiaea>
Message-ID: <AANLkTi=Hbyf3enveLQiXHr1fu1=cRu8owyMY7GG8R6VV@mail.gmail.com>

>> Ah, my mistake was assuming that the package namespace and environment
>> were the same thing.
>>
>> Interestingly the namespace is dynamic:
>
> Not sure what you mean with this. ?Section 1.6 of "Writing R
> Extensions" explicitly states:
>
> ? ? ? ?Name spaces are @emph{sealed} once they are loaded. ?Sealing
> ? ? ? ?means that imports and exports cannot be changed and that
> ? ? ? ?internal variable bindings cannot be changed.

Well, if we're going to pick nits, I meant that the parents of the
environment are dynamic.

>> > parents(getNamespace("devtools"))
>> ...
>> [31] "base"
>> > library(roxygen)
>> > parents(getNamespace("devtools"))
>> ...
>> [31] "Autoloads" ? ? ? ? ? ?"base"
>
> Well, as the part of "Writing R Extensions" that Martin quoted states,
> the normal search path is part of the search path used by packages with
> name spaces. ?So if you attach another package via library(), the
> normal search path changes and, hence,
> `parents(getNamespace("devtools"))' has one more location to report.

It's still not at all obvious how this happens - when does variable
look up use the stack of environments given by the package environment
and when does it use the stack of environments given by the namespace?

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From berwin at maths.uwa.edu.au  Tue Nov 16 15:19:41 2010
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue, 16 Nov 2010 22:19:41 +0800
Subject: [Rd] Trying to understand the search path and namespaces
In-Reply-To: <AANLkTi=Hbyf3enveLQiXHr1fu1=cRu8owyMY7GG8R6VV@mail.gmail.com>
References: <AANLkTin090pRti8dXknLKtpFmUmmvRsAz6a0V2mx5iOM@mail.gmail.com>
	<AANLkTi=3K0T7qzQnRU-Q8h3RVTDS+UQ5CmcOs4xZJYfD@mail.gmail.com>
	<AANLkTikPE5acZ6CKJeoq9RpphUJffr4W8Lm_8c7O7i08@mail.gmail.com>
	<AANLkTimckaNaUb6SjY=njVZuRSa1iJ+4entWVA2ghBxD@mail.gmail.com>
	<4CE1DE06.9060809@fhcrc.org>
	<AANLkTi=BsP2mE8avreNMBx_P-ORcEhRB_mK0-k8fFTpq@mail.gmail.com>
	<20101116155933.41901966@bossiaea>
	<AANLkTi=Hbyf3enveLQiXHr1fu1=cRu8owyMY7GG8R6VV@mail.gmail.com>
Message-ID: <20101116221941.5f7af314@absentia>

G'day Hadley,

On Tue, 16 Nov 2010 07:35:09 -0600
Hadley Wickham <hadley at rice.edu> wrote:

> > Well, as the part of "Writing R Extensions" that Martin quoted
> > states, the normal search path is part of the search path used by
> > packages with name spaces. ?So if you attach another package via
> > library(), the normal search path changes and, hence,
> > `parents(getNamespace("devtools"))' has one more location to report.
> 
> It's still not at all obvious how this happens - when does variable
> look up use the stack of environments given by the package environment
> and when does it use the stack of environments given by the namespace?

Well, if we are going to nitpick, the former presumably never
happens. :)  Section 3.5.4 "Search path" of the "R Language Definition"
might be more illuminating than quotes from "Writing R Extensions".

The first two paragraphs of that section are :

	In addition to the evaluation environment structure, @R{}
	has a search path of environments which are searched for
	variables not found elsewhere.  This is used for two things:
	packages of functions and attached user data.

	The first element of the search path is the global environment
	and the last is the base package.  An @code{Autoloads}
	environment is used for holding proxy objects that may be
	loaded on demand.  Other environments are inserted in the path
	using @code{attach} or @code{library}.

I guess this is what you refer to by "stack of environments given by the
package environment" (though it clearly isn't, if the object/variable
is not found in the evaluation environment structure [I guess Section
3.5.2 "Lexical environment" explains what this is], the search starts in
the global environment, not the environment of the package).  The third
and last paragraph of Section 3.5.4 states:

	Packages which have a @emph{namespace} have a different search
	path. When a search for an @R{} object is started from an
	object in such a package, the package itself is searched first,
	then its imports, then the base namespace and finally the
	global environment and the rest of the regular search path.
	The effect is that references to other objects in the same
	package will be resolved to the package, and objects cannot be
	masked by objects of the same name in the global environment or
	in other packages.

I hope this clarifies your remaining doubts about the process.  

Cheers,

	Berwin


From bbolker at gmail.com  Tue Nov 16 15:42:50 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 16 Nov 2010 09:42:50 -0500
Subject: [Rd] trivial typo in system.Rd
Message-ID: <4CE2986A.2070003@gmail.com>

Index: system.Rd
===================================================================
--- system.Rd	(revision 53611)
+++ system.Rd	(working copy)
@@ -181,7 +181,7 @@
     \item The most important difference is that on a Unix-alike
     \code{system} launches a shell which then runs \code{command}.  On
     Windows the command is run directly -- use \code{shell} for an
-    interface which runs \code{comamnd} \emph{via} a shell (by default
+    interface which runs \code{command} \emph{via} a shell (by default
     the Windows shell \command{cmd.exe}, which has many differences from
     the POSIX shell).


From amredd at gmail.com  Tue Nov 16 18:25:27 2010
From: amredd at gmail.com (Andrew Redd)
Date: Tue, 16 Nov 2010 10:25:27 -0700
Subject: [Rd] unloading compiled code.
In-Reply-To: <AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
	<AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
Message-ID: <AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>

Are packages unloaded on quit so that the .Last.lib or .onUnload are
called for packages?

-Andrew

On Fri, Nov 12, 2010 at 3:52 PM, Andrew Redd <amredd at gmail.com> wrote:
> Perhaps you could help me make some sense of this. ?Here is a printout
> of my sessions.
> ---
> toys$R -q
>> library(test2)
>> gpualloctest()
> testing allocation on gpu
> C Finished
> Collecting Garbage
> done.
>> q()
> Save workspace image? [y/n/c]: n
>
> ?*** caught segfault ***
> address 0x7f12ec1add50, cause 'memory not mapped'
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 1
> aborting ...
> Segmentation fault
> toys$R -q
>> library(test2)
>> gpualloctest()
> testing allocation on gpu
> C Finished
> Collecting Garbage
> done.
>> library.dynam.unload('test2',system.file(package='test2'))
>> q()
> Save workspace image? [y/n/c]: n
> toys$
> ---
>
> I have a in the test2/R/zzz.R file
> ---
> .onUnload <- function(libpath)
> ? ?library.dynam.unload("test2", libpath)
> ---
>
> so the code should be unloaded. ?But it appears that it is not from
> errors when I explicitly unload the test2.so it does not through a
> segfault. ?Why would this be happening? ?and how do I circumvent it.
>
> thanks,
> Andrew
>
>
> On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
> <ripley at stats.ox.ac.uk> wrote:
>> On Fri, 12 Nov 2010, Andrew Redd wrote:
>>
>>> I have a package that I'm developing that I need to unload the
>>> library. ?Long story short I figured out that the leaving the compiled
>>> code loaded lead to a segmentation fault, but unloading the code will
>>> fix it. ?I've read the documentation and it appears that there are
>>> several ways to do this? ?What is the popper accepted current standard
>>> for unloading compiled code?
>>
>> Depends how you loaded it: you basically reverse the process.
>>
>>> The options as I understand them are:
>>> 1. dyn.unload
>>> 2. library.dynam.unload
>>> used with either
>>> A. .Last.lib
>>> B. .onUnload
>>>
>>> If it makes a difference my package does use a NAMESPACE so the
>>> package is loaded through useDynLib.
>>
>> So you need an .onUnload action calling library.dynam.unload.
>>
>> Slightly longer version: you need the DLL loaded whilst the namepace is in
>> use, so it has to be in .onUnload, and useDynLib calls library.dynam so you
>> need library.dynam.unload to do the housekeeping around dyn.unload which
>> matches what library.dynam does around dyn.load.
>>
>> There are quite a lot of examples to look at, including in R itself. MASS is
>> one example I've just checked.
>>
>> Having said all that, my experience is that unloading the DLL often does not
>> help if you need to load it again (and that is why e.g. tcltk does not
>> unload its DLL).
>>
>>> Thanks,
>>> Andrew Redd
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>>
>


From amredd at gmail.com  Tue Nov 16 18:50:52 2010
From: amredd at gmail.com (Andrew Redd)
Date: Tue, 16 Nov 2010 10:50:52 -0700
Subject: [Rd] unloading compiled code.
In-Reply-To: <AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
	<AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
	<AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>
Message-ID: <AANLkTi=XNYb62SOScF-=rGBPFwWOCg670zDRLSEF4tw1@mail.gmail.com>

Just found in the documentation for getHook that packages are not
unloaded on quit.  How should I force a package to unload on quit?

-Andrew

On Tue, Nov 16, 2010 at 10:25 AM, Andrew Redd <amredd at gmail.com> wrote:
> Are packages unloaded on quit so that the .Last.lib or .onUnload are
> called for packages?
>
> -Andrew
>
> On Fri, Nov 12, 2010 at 3:52 PM, Andrew Redd <amredd at gmail.com> wrote:
>> Perhaps you could help me make some sense of this. ?Here is a printout
>> of my sessions.
>> ---
>> toys$R -q
>>> library(test2)
>>> gpualloctest()
>> testing allocation on gpu
>> C Finished
>> Collecting Garbage
>> done.
>>> q()
>> Save workspace image? [y/n/c]: n
>>
>> ?*** caught segfault ***
>> address 0x7f12ec1add50, cause 'memory not mapped'
>>
>> Possible actions:
>> 1: abort (with core dump, if enabled)
>> 2: normal R exit
>> 3: exit R without saving workspace
>> 4: exit R saving workspace
>> Selection: 1
>> aborting ...
>> Segmentation fault
>> toys$R -q
>>> library(test2)
>>> gpualloctest()
>> testing allocation on gpu
>> C Finished
>> Collecting Garbage
>> done.
>>> library.dynam.unload('test2',system.file(package='test2'))
>>> q()
>> Save workspace image? [y/n/c]: n
>> toys$
>> ---
>>
>> I have a in the test2/R/zzz.R file
>> ---
>> .onUnload <- function(libpath)
>> ? ?library.dynam.unload("test2", libpath)
>> ---
>>
>> so the code should be unloaded. ?But it appears that it is not from
>> errors when I explicitly unload the test2.so it does not through a
>> segfault. ?Why would this be happening? ?and how do I circumvent it.
>>
>> thanks,
>> Andrew
>>
>>
>> On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
>> <ripley at stats.ox.ac.uk> wrote:
>>> On Fri, 12 Nov 2010, Andrew Redd wrote:
>>>
>>>> I have a package that I'm developing that I need to unload the
>>>> library. ?Long story short I figured out that the leaving the compiled
>>>> code loaded lead to a segmentation fault, but unloading the code will
>>>> fix it. ?I've read the documentation and it appears that there are
>>>> several ways to do this? ?What is the popper accepted current standard
>>>> for unloading compiled code?
>>>
>>> Depends how you loaded it: you basically reverse the process.
>>>
>>>> The options as I understand them are:
>>>> 1. dyn.unload
>>>> 2. library.dynam.unload
>>>> used with either
>>>> A. .Last.lib
>>>> B. .onUnload
>>>>
>>>> If it makes a difference my package does use a NAMESPACE so the
>>>> package is loaded through useDynLib.
>>>
>>> So you need an .onUnload action calling library.dynam.unload.
>>>
>>> Slightly longer version: you need the DLL loaded whilst the namepace is in
>>> use, so it has to be in .onUnload, and useDynLib calls library.dynam so you
>>> need library.dynam.unload to do the housekeeping around dyn.unload which
>>> matches what library.dynam does around dyn.load.
>>>
>>> There are quite a lot of examples to look at, including in R itself. MASS is
>>> one example I've just checked.
>>>
>>> Having said all that, my experience is that unloading the DLL often does not
>>> help if you need to load it again (and that is why e.g. tcltk does not
>>> unload its DLL).
>>>
>>>> Thanks,
>>>> Andrew Redd
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>>>
>>
>


From cberry at tajo.ucsd.edu  Tue Nov 16 19:27:29 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Tue, 16 Nov 2010 10:27:29 -0800
Subject: [Rd] unloading compiled code.
In-Reply-To: <AANLkTi=XNYb62SOScF-=rGBPFwWOCg670zDRLSEF4tw1@mail.gmail.com>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
	<AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
	<AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>
	<AANLkTi=XNYb62SOScF-=rGBPFwWOCg670zDRLSEF4tw1@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.1011161024180.1348@tajo.ucsd.edu>

On Tue, 16 Nov 2010, Andrew Redd wrote:

> Just found in the documentation for getHook that packages are not
> unloaded on quit.  How should I force a package to unload on quit?

See

 	?q


HTH,

Chuck

>
> -Andrew
>
> On Tue, Nov 16, 2010 at 10:25 AM, Andrew Redd <amredd at gmail.com> wrote:
>> Are packages unloaded on quit so that the .Last.lib or .onUnload are
>> called for packages?
>>
>> -Andrew
>>
>> On Fri, Nov 12, 2010 at 3:52 PM, Andrew Redd <amredd at gmail.com> wrote:
>>> Perhaps you could help me make some sense of this. ?Here is a printout
>>> of my sessions.
>>> ---
>>> toys$R -q
>>>> library(test2)
>>>> gpualloctest()
>>> testing allocation on gpu
>>> C Finished
>>> Collecting Garbage
>>> done.
>>>> q()
>>> Save workspace image? [y/n/c]: n
>>>
>>> ?*** caught segfault ***
>>> address 0x7f12ec1add50, cause 'memory not mapped'
>>>
>>> Possible actions:
>>> 1: abort (with core dump, if enabled)
>>> 2: normal R exit
>>> 3: exit R without saving workspace
>>> 4: exit R saving workspace
>>> Selection: 1
>>> aborting ...
>>> Segmentation fault
>>> toys$R -q
>>>> library(test2)
>>>> gpualloctest()
>>> testing allocation on gpu
>>> C Finished
>>> Collecting Garbage
>>> done.
>>>> library.dynam.unload('test2',system.file(package='test2'))
>>>> q()
>>> Save workspace image? [y/n/c]: n
>>> toys$
>>> ---
>>>
>>> I have a in the test2/R/zzz.R file
>>> ---
>>> .onUnload <- function(libpath)
>>> ? ?library.dynam.unload("test2", libpath)
>>> ---
>>>
>>> so the code should be unloaded. ?But it appears that it is not from
>>> errors when I explicitly unload the test2.so it does not through a
>>> segfault. ?Why would this be happening? ?and how do I circumvent it.
>>>
>>> thanks,
>>> Andrew
>>>
>>>
>>> On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
>>> <ripley at stats.ox.ac.uk> wrote:
>>>> On Fri, 12 Nov 2010, Andrew Redd wrote:
>>>>
>>>>> I have a package that I'm developing that I need to unload the
>>>>> library. ?Long story short I figured out that the leaving the compiled
>>>>> code loaded lead to a segmentation fault, but unloading the code will
>>>>> fix it. ?I've read the documentation and it appears that there are
>>>>> several ways to do this? ?What is the popper accepted current standard
>>>>> for unloading compiled code?
>>>>
>>>> Depends how you loaded it: you basically reverse the process.
>>>>
>>>>> The options as I understand them are:
>>>>> 1. dyn.unload
>>>>> 2. library.dynam.unload
>>>>> used with either
>>>>> A. .Last.lib
>>>>> B. .onUnload
>>>>>
>>>>> If it makes a difference my package does use a NAMESPACE so the
>>>>> package is loaded through useDynLib.
>>>>
>>>> So you need an .onUnload action calling library.dynam.unload.
>>>>
>>>> Slightly longer version: you need the DLL loaded whilst the namepace is in
>>>> use, so it has to be in .onUnload, and useDynLib calls library.dynam so you
>>>> need library.dynam.unload to do the housekeeping around dyn.unload which
>>>> matches what library.dynam does around dyn.load.
>>>>
>>>> There are quite a lot of examples to look at, including in R itself. MASS is
>>>> one example I've just checked.
>>>>
>>>> Having said all that, my experience is that unloading the DLL often does not
>>>> help if you need to load it again (and that is why e.g. tcltk does not
>>>> unload its DLL).
>>>>
>>>>> Thanks,
>>>>> Andrew Redd
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>> --
>>>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>>>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>>>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>>>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>>>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>>>>
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From bates at stat.wisc.edu  Tue Nov 16 20:33:20 2010
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue, 16 Nov 2010 13:33:20 -0600
Subject: [Rd] [R] DBLEPR?
In-Reply-To: <4CE2D561.1050404@uottawa.ca>
References: <4CE2D561.1050404@uottawa.ca>
Message-ID: <AANLkTi=83sZXVF0fn1=czxLGcy7L-CK1yejbE3w-Dfz9@mail.gmail.com>

Reply redirected to the R-devel list.

On Tue, Nov 16, 2010 at 1:02 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
> Ravi Varadhan and I have been looking at UCMINF to try to identify why it gives occasional
> (but not reproducible) errors, seemingly on Windows only. There is some suspicion that its
> use of DBLEPR for finessing the Fortran WRITE() statements may be to blame. While I can
> find DBLEPR in Venables and Ripley, it doesn't get much mention after about 2000 in the
> archives, though it is in the R FAQ and Brian R. mentions they are in libR in a 2009 post.
> Are the xxxPR routines now deprecated (particularly for 64 bit systems) or still OK to
> use? ?If OK, can anyone point to documentation and examples?

Can you give more context?  What is UNCMINF?  Is it a package?  Is it a file?

There is a file R_SRC/src/appl/uncmin.c but it doesn't use DBLEPR
because it is C source code.  As stated in the comments

/* ../appl/uncmin.f
   -- translated by f2c (version of 1 June 1993 23:00:00).
   -- and hand edited by Saikat DebRoy
   */

/*--- The Dennis + Schnabel Minimizer -- used by R's  nlm() ---*/


From ngkbr8es at gmail.com  Tue Nov 16 20:52:48 2010
From: ngkbr8es at gmail.com (Patrick Leyshock)
Date: Tue, 16 Nov 2010 11:52:48 -0800
Subject: [Rd] SEXPs and slots
In-Reply-To: <4CDDDDA8.3040003@fhcrc.org>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
Message-ID: <AANLkTikkdi1-BwR13hpOsubpDAy3Hrg_UepvZpZDx0eU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101116/14957838/attachment.pl>

From nashjc at uottawa.ca  Tue Nov 16 21:35:03 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Tue, 16 Nov 2010 15:35:03 -0500
Subject: [Rd] DBLEPR?
Message-ID: <4CE2EAF7.5020202@uottawa.ca>

I normally see digest once per day, but got msg from Doug Bates so responding with context.

UCMINF is a package on CRAN that implements a variable metric minimizer. It does quite
well on unconstrained problems. Stig Mortensen packaged the Fortran version for R, but is
not at moment responding to emails. There's also a Matlab version. We have it in optimx
and get some occasions where it just stops if we set trace>0. Other times we can't get it
to fail. My guess is something like an undefined variable or a bad declaration of a
pointer, but C and C++ are not languages I've much experience with.

JN


From simon.urbanek at r-project.org  Tue Nov 16 21:46:29 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 16 Nov 2010 21:46:29 +0100
Subject: [Rd] SEXPs and slots
In-Reply-To: <AANLkTikkdi1-BwR13hpOsubpDAy3Hrg_UepvZpZDx0eU@mail.gmail.com>
References: <AANLkTiksZ333w8oYT2m3NrxbzHXyz=fAj9HfSpeKspTi@mail.gmail.com>
	<4CDDDDA8.3040003@fhcrc.org>
	<AANLkTikkdi1-BwR13hpOsubpDAy3Hrg_UepvZpZDx0eU@mail.gmail.com>
Message-ID: <951C4BC1-F847-4BB3-B991-85C9931D3C1B@r-project.org>


On Nov 16, 2010, at 8:52 PM, Patrick Leyshock wrote:

> Revisiting the output below:
> 
> 1.  Am I correct in thinking that the @XXXXXXX items are addresses?

yes


> 2.  What are the meanings of the gXcX items?

you should not worry about those - they are internal flags related to the garbage collector (generation and class).


> 3.  Does one ever see NAM[0]?
> 

no, if NAMED==0 the NAM(x) output is omitted, e.g.:

> .Internal(inspect(1L+1L))
@102b1bd18 13 INTSXP g0c1 [] (len=1, tl=1) 2



> Thanks, Patrick
> 
>> .Internal(inspect(eg))
>> @df70e48 25 S4SXP g0c0 [OBJ,NAM(2),gp=0x10,ATT]
>> ATTRIB:
>> @df70ef0 02 LISTSXP g0c0 []
>>   TAG: @769258 01 SYMSXP g1c0 [MARK] "size"
>>   @c0f6db8 14 REALSXP g0c1 [NAM(2)] (len=1, tl=0) 4
>>   TAG: @15b0228 01 SYMSXP g1c0 [MARK,NAM(2)] "id"
>>   @c0f6178 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
>>     @12341c80 09 CHARSXP g0c2 [gp=0x20] "id_value"
>>   TAG: @607ce8 01 SYMSXP g1c0 [MARK,NAM(2),gp=0x4000] "class"
>>   @c0f6d58 16 STRSXP g0c1 [NAM(2),ATT] (len=1, tl=0)
>>     @96ed08 09 CHARSXP g1c1 [MARK,gp=0x21] "example"
>>   ATTRIB:
>>     @df70fd0 02 LISTSXP g0c0 []
>>       TAG: @624f70 01 SYMSXP g1c0 [MARK,NAM(2)] "package"
>>       @c0f6d88 16 STRSXP g0c1 [NAM(2)] (len=1, tl=0)
>>         @67f5e0 09 CHARSXP g1c2 [MARK,gp=0x21,ATT] ".GlobalEnv"
>> 
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From amredd at gmail.com  Tue Nov 16 21:51:10 2010
From: amredd at gmail.com (Andrew Redd)
Date: Tue, 16 Nov 2010 13:51:10 -0700
Subject: [Rd] unloading compiled code.
In-Reply-To: <Pine.LNX.4.64.1011161024180.1348@tajo.ucsd.edu>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
	<AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
	<AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>
	<AANLkTi=XNYb62SOScF-=rGBPFwWOCg670zDRLSEF4tw1@mail.gmail.com>
	<Pine.LNX.4.64.1011161024180.1348@tajo.ucsd.edu>
Message-ID: <AANLkTi=PwRunS9G5buTdKUAp=M1VY7tbzu-KG-ATSGQ+@mail.gmail.com>

so should I use reg.finalizer or overwrite .Last()?  If I use
reg.finalizer, what should be the environment that I specify?  The
straight forward solution would be to have a hook .onExit that a
package could specify to make sure  that the code was unloaded before
the program terminates, that way I don't overwrite .Last if if has
another purpose.

-Andrew

On Tue, Nov 16, 2010 at 11:27 AM, Charles C. Berry <cberry at tajo.ucsd.edu> wrote:
> On Tue, 16 Nov 2010, Andrew Redd wrote:
>
>> Just found in the documentation for getHook that packages are not
>> unloaded on quit. ?How should I force a package to unload on quit?
>
> See
>
> ? ? ? ??q
>
>
> HTH,
>
> Chuck
>
>>
>> -Andrew
>>
>> On Tue, Nov 16, 2010 at 10:25 AM, Andrew Redd <amredd at gmail.com> wrote:
>>>
>>> Are packages unloaded on quit so that the .Last.lib or .onUnload are
>>> called for packages?
>>>
>>> -Andrew
>>>
>>> On Fri, Nov 12, 2010 at 3:52 PM, Andrew Redd <amredd at gmail.com> wrote:
>>>>
>>>> Perhaps you could help me make some sense of this. ?Here is a printout
>>>> of my sessions.
>>>> ---
>>>> toys$R -q
>>>>>
>>>>> library(test2)
>>>>> gpualloctest()
>>>>
>>>> testing allocation on gpu
>>>> C Finished
>>>> Collecting Garbage
>>>> done.
>>>>>
>>>>> q()
>>>>
>>>> Save workspace image? [y/n/c]: n
>>>>
>>>> ?*** caught segfault ***
>>>> address 0x7f12ec1add50, cause 'memory not mapped'
>>>>
>>>> Possible actions:
>>>> 1: abort (with core dump, if enabled)
>>>> 2: normal R exit
>>>> 3: exit R without saving workspace
>>>> 4: exit R saving workspace
>>>> Selection: 1
>>>> aborting ...
>>>> Segmentation fault
>>>> toys$R -q
>>>>>
>>>>> library(test2)
>>>>> gpualloctest()
>>>>
>>>> testing allocation on gpu
>>>> C Finished
>>>> Collecting Garbage
>>>> done.
>>>>>
>>>>> library.dynam.unload('test2',system.file(package='test2'))
>>>>> q()
>>>>
>>>> Save workspace image? [y/n/c]: n
>>>> toys$
>>>> ---
>>>>
>>>> I have a in the test2/R/zzz.R file
>>>> ---
>>>> .onUnload <- function(libpath)
>>>> ? ?library.dynam.unload("test2", libpath)
>>>> ---
>>>>
>>>> so the code should be unloaded. ?But it appears that it is not from
>>>> errors when I explicitly unload the test2.so it does not through a
>>>> segfault. ?Why would this be happening? ?and how do I circumvent it.
>>>>
>>>> thanks,
>>>> Andrew
>>>>
>>>>
>>>> On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
>>>> <ripley at stats.ox.ac.uk> wrote:
>>>>>
>>>>> On Fri, 12 Nov 2010, Andrew Redd wrote:
>>>>>
>>>>>> I have a package that I'm developing that I need to unload the
>>>>>> library. ?Long story short I figured out that the leaving the compiled
>>>>>> code loaded lead to a segmentation fault, but unloading the code will
>>>>>> fix it. ?I've read the documentation and it appears that there are
>>>>>> several ways to do this? ?What is the popper accepted current standard
>>>>>> for unloading compiled code?
>>>>>
>>>>> Depends how you loaded it: you basically reverse the process.
>>>>>
>>>>>> The options as I understand them are:
>>>>>> 1. dyn.unload
>>>>>> 2. library.dynam.unload
>>>>>> used with either
>>>>>> A. .Last.lib
>>>>>> B. .onUnload
>>>>>>
>>>>>> If it makes a difference my package does use a NAMESPACE so the
>>>>>> package is loaded through useDynLib.
>>>>>
>>>>> So you need an .onUnload action calling library.dynam.unload.
>>>>>
>>>>> Slightly longer version: you need the DLL loaded whilst the namepace is
>>>>> in
>>>>> use, so it has to be in .onUnload, and useDynLib calls library.dynam so
>>>>> you
>>>>> need library.dynam.unload to do the housekeeping around dyn.unload
>>>>> which
>>>>> matches what library.dynam does around dyn.load.
>>>>>
>>>>> There are quite a lot of examples to look at, including in R itself.
>>>>> MASS is
>>>>> one example I've just checked.
>>>>>
>>>>> Having said all that, my experience is that unloading the DLL often
>>>>> does not
>>>>> help if you need to load it again (and that is why e.g. tcltk does not
>>>>> unload its DLL).
>>>>>
>>>>>> Thanks,
>>>>>> Andrew Redd
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>> --
>>>>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>>>>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>>>>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>>>>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>>>>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>>>>>
>>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> Charles C. Berry ? ? ? ? ? ? ? ? ? ? ? ? ? ?Dept of Family/Preventive
> Medicine
> cberry at tajo.ucsd.edu ? ? ? ? ? ? ? ? ? ? ? ?UC San Diego
> http://famprevmed.ucsd.edu/faculty/cberry/ ?La Jolla, San Diego 92093-0901
>
>


From diegosaldana87 at gmail.com  Tue Nov 16 22:03:13 2010
From: diegosaldana87 at gmail.com (darfunkel)
Date: Tue, 16 Nov 2010 13:03:13 -0800 (PST)
Subject: [Rd] Plotting an agnes tree with images instead of labels?
Message-ID: <1289941393629-3045682.post@n4.nabble.com>


Hi,

I'd like to plot a tree with images of molecular structures instead of
labels (words). I think this is possible because someone who worked in my
office before I arrived did this. However I'm not sure if this person made
the image manually or plotted it only with R.

Thanks in advance for your help.
-- 
View this message in context: http://r.789695.n4.nabble.com/Plotting-an-agnes-tree-with-images-instead-of-labels-tp3045682p3045682.html
Sent from the R devel mailing list archive at Nabble.com.


From bates at stat.wisc.edu  Tue Nov 16 22:52:06 2010
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue, 16 Nov 2010 15:52:06 -0600
Subject: [Rd] DBLEPR?
In-Reply-To: <4CE2EAF7.5020202@uottawa.ca>
References: <4CE2EAF7.5020202@uottawa.ca>
Message-ID: <AANLkTimbP_BfXjzjXNqkJq7a4=Mu_rr9r6UXyTogsEfd@mail.gmail.com>

On Tue, Nov 16, 2010 at 2:35 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
> I normally see digest once per day, but got msg from Doug Bates so responding with context.

> UCMINF is a package on CRAN that implements a variable metric minimizer.

A pedant might point out that the package is called "ucminf".

> It does quite
> well on unconstrained problems. Stig Mortensen packaged the Fortran version for R, but is
> not at moment responding to emails. There's also a Matlab version. We have it in optimx
> and get some occasions where it just stops if we set trace>0. Other times we can't get it
> to fail. My guess is something like an undefined variable or a bad declaration of a
> pointer, but C and C++ are not languages I've much experience with.

Well, it doesn't work well for me because my version of gfortran (GNU
Fortran (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5) objects to the format
strings in some of the Fortran WRITE statements.

The recommended approach is to avoid all Fortran I/O including writing
to a Fortran character array.   As there are only 3 such WRITE
statements in the Fortran code it would be very simple to replace them
with calls to C functions that in turn call Rprintf.  However, it
would be best if Stig could take ownership of the modifications.


From nashjc at uottawa.ca  Tue Nov 16 23:06:08 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Tue, 16 Nov 2010 17:06:08 -0500
Subject: [Rd] DBLEPR?
In-Reply-To: <AANLkTimbP_BfXjzjXNqkJq7a4=Mu_rr9r6UXyTogsEfd@mail.gmail.com>
References: <4CE2EAF7.5020202@uottawa.ca>
	<AANLkTimbP_BfXjzjXNqkJq7a4=Mu_rr9r6UXyTogsEfd@mail.gmail.com>
Message-ID: <4CE30050.3090909@uottawa.ca>

We've tried to contact Stig since July. Possibly he changed emails.

My thought was to use Rprintf as suggested and was looking into doing that to see if our
optimx problems would go away. Will keep it as open issue while we give a bit more time
for response, and welcome input from others.

JN


On 11/16/2010 04:52 PM, Douglas Bates wrote:
> On Tue, Nov 16, 2010 at 2:35 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
>> I normally see digest once per day, but got msg from Doug Bates so responding with context.
> 
>> UCMINF is a package on CRAN that implements a variable metric minimizer.
> 
> A pedant might point out that the package is called "ucminf".
> 
>> It does quite
>> well on unconstrained problems. Stig Mortensen packaged the Fortran version for R, but is
>> not at moment responding to emails. There's also a Matlab version. We have it in optimx
>> and get some occasions where it just stops if we set trace>0. Other times we can't get it
>> to fail. My guess is something like an undefined variable or a bad declaration of a
>> pointer, but C and C++ are not languages I've much experience with.
> 
> Well, it doesn't work well for me because my version of gfortran (GNU
> Fortran (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5) objects to the format
> strings in some of the Fortran WRITE statements.
> 
> The recommended approach is to avoid all Fortran I/O including writing
> to a Fortran character array.   As there are only 3 such WRITE
> statements in the Fortran code it would be very simple to replace them
> with calls to C functions that in turn call Rprintf.  However, it
> would be best if Stig could take ownership of the modifications.


From nashjc at uottawa.ca  Tue Nov 16 23:52:42 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Tue, 16 Nov 2010 17:52:42 -0500
Subject: [Rd] DBLEPR?
In-Reply-To: <AANLkTi=uPiLv-GWGDN6O=m=o4aTA+8ASesS2VmuzkAvA@mail.gmail.com>
References: <4CE2EAF7.5020202@uottawa.ca>	<AANLkTimbP_BfXjzjXNqkJq7a4=Mu_rr9r6UXyTogsEfd@mail.gmail.com>	<4CE30050.3090909@uottawa.ca>
	<AANLkTi=uPiLv-GWGDN6O=m=o4aTA+8ASesS2VmuzkAvA@mail.gmail.com>
Message-ID: <4CE30B3A.4030109@uottawa.ca>

My reaction is leaning heavily towards "Virtuoso!" as opposed to "Show Off!".

Thanks very much.

JN


On 11/16/2010 05:39 PM, Douglas Bates wrote:
> Try this.
> 
> On Tue, Nov 16, 2010 at 4:06 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
>> We've tried to contact Stig since July. Possibly he changed emails.
>>
>> My thought was to use Rprintf as suggested and was looking into doing that to see if our
>> optimx problems would go away. Will keep it as open issue while we give a bit more time
>> for response, and welcome input from others.
>>
>> JN
>>
>>
>> On 11/16/2010 04:52 PM, Douglas Bates wrote:
>>> On Tue, Nov 16, 2010 at 2:35 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
>>>> I normally see digest once per day, but got msg from Doug Bates so responding with context.
>>>
>>>> UCMINF is a package on CRAN that implements a variable metric minimizer.
>>>
>>> A pedant might point out that the package is called "ucminf".
>>>
>>>> It does quite
>>>> well on unconstrained problems. Stig Mortensen packaged the Fortran version for R, but is
>>>> not at moment responding to emails. There's also a Matlab version. We have it in optimx
>>>> and get some occasions where it just stops if we set trace>0. Other times we can't get it
>>>> to fail. My guess is something like an undefined variable or a bad declaration of a
>>>> pointer, but C and C++ are not languages I've much experience with.
>>>
>>> Well, it doesn't work well for me because my version of gfortran (GNU
>>> Fortran (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5) objects to the format
>>> strings in some of the Fortran WRITE statements.
>>>
>>> The recommended approach is to avoid all Fortran I/O including writing
>>> to a Fortran character array.   As there are only 3 such WRITE
>>> statements in the Fortran code it would be very simple to replace them
>>> with calls to C functions that in turn call Rprintf.  However, it
>>> would be best if Stig could take ownership of the modifications.
>>


From ripley at stats.ox.ac.uk  Wed Nov 17 00:02:22 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 16 Nov 2010 23:02:22 +0000 (GMT)
Subject: [Rd] DBLEPR?
In-Reply-To: <AANLkTimbP_BfXjzjXNqkJq7a4=Mu_rr9r6UXyTogsEfd@mail.gmail.com>
References: <4CE2EAF7.5020202@uottawa.ca>
	<AANLkTimbP_BfXjzjXNqkJq7a4=Mu_rr9r6UXyTogsEfd@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011162250500.24948@gannet.stats.ox.ac.uk>

On Tue, 16 Nov 2010, Douglas Bates wrote:

> On Tue, Nov 16, 2010 at 2:35 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
>> I normally see digest once per day, but got msg from Doug Bates so responding with context.
>
>> UCMINF is a package on CRAN that implements a variable metric minimizer.
>
> A pedant might point out that the package is called "ucminf".

And the documentation for the function is under 'dblepr' in 'Writing R 
Extensions'.  There are quite a lot of uses in packages, including 
cluster, mda and tweedie.

The original message mentioned Windows.  You absolutely must avoid 
Fortran I/O on Windows: even having unused calls in your code can
cause crashes, since initializing Fortran I/O interferes with C I/O 
(the benign end of the spectrum is to reset buffers and switch line 
endings to LF from CRLF, but segfaults are not uncommon).

>
>> It does quite
>> well on unconstrained problems. Stig Mortensen packaged the Fortran version for R, but is
>> not at moment responding to emails. There's also a Matlab version. We have it in optimx
>> and get some occasions where it just stops if we set trace>0. Other times we can't get it
>> to fail. My guess is something like an undefined variable or a bad declaration of a
>> pointer, but C and C++ are not languages I've much experience with.
>
> Well, it doesn't work well for me because my version of gfortran (GNU
> Fortran (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5) objects to the format
> strings in some of the Fortran WRITE statements.
>
> The recommended approach is to avoid all Fortran I/O including writing
> to a Fortran character array.   As there are only 3 such WRITE
> statements in the Fortran code it would be very simple to replace them
> with calls to C functions that in turn call Rprintf.  However, it
> would be best if Stig could take ownership of the modifications.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From cberry at tajo.ucsd.edu  Wed Nov 17 02:34:49 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Tue, 16 Nov 2010 17:34:49 -0800
Subject: [Rd] unloading compiled code.
In-Reply-To: <AANLkTi=PwRunS9G5buTdKUAp=M1VY7tbzu-KG-ATSGQ+@mail.gmail.com>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
	<AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
	<AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>
	<AANLkTi=XNYb62SOScF-=rGBPFwWOCg670zDRLSEF4tw1@mail.gmail.com>
	<Pine.LNX.4.64.1011161024180.1348@tajo.ucsd.edu>
	<AANLkTi=PwRunS9G5buTdKUAp=M1VY7tbzu-KG-ATSGQ+@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.1011161734160.2833@tajo.ucsd.edu>

On Tue, 16 Nov 2010, Andrew Redd wrote:

> so should I use reg.finalizer or overwrite .Last()?

> .Last
Error: object '.Last' not found
>

You create your own .Last - there is nothing to overwrite.

Chuck


  If I use
> reg.finalizer, what should be the environment that I specify?  The
> straight forward solution would be to have a hook .onExit that a
> package could specify to make sure  that the code was unloaded before
> the program terminates, that way I don't overwrite .Last if if has
> another purpose.
>
> -Andrew
>
> On Tue, Nov 16, 2010 at 11:27 AM, Charles C. Berry <cberry at tajo.ucsd.edu> wrote:
>> On Tue, 16 Nov 2010, Andrew Redd wrote:
>>
>>> Just found in the documentation for getHook that packages are not
>>> unloaded on quit. ?How should I force a package to unload on quit?
>>
>> See
>>
>> ? ? ? ??q
>>
>>
>> HTH,
>>
>> Chuck
>>
>>>
>>> -Andrew
>>>
>>> On Tue, Nov 16, 2010 at 10:25 AM, Andrew Redd <amredd at gmail.com> wrote:
>>>>
>>>> Are packages unloaded on quit so that the .Last.lib or .onUnload are
>>>> called for packages?
>>>>
>>>> -Andrew
>>>>
>>>> On Fri, Nov 12, 2010 at 3:52 PM, Andrew Redd <amredd at gmail.com> wrote:
>>>>>
>>>>> Perhaps you could help me make some sense of this. ?Here is a printout
>>>>> of my sessions.
>>>>> ---
>>>>> toys$R -q
>>>>>>
>>>>>> library(test2)
>>>>>> gpualloctest()
>>>>>
>>>>> testing allocation on gpu
>>>>> C Finished
>>>>> Collecting Garbage
>>>>> done.
>>>>>>
>>>>>> q()
>>>>>
>>>>> Save workspace image? [y/n/c]: n
>>>>>
>>>>> ?*** caught segfault ***
>>>>> address 0x7f12ec1add50, cause 'memory not mapped'
>>>>>
>>>>> Possible actions:
>>>>> 1: abort (with core dump, if enabled)
>>>>> 2: normal R exit
>>>>> 3: exit R without saving workspace
>>>>> 4: exit R saving workspace
>>>>> Selection: 1
>>>>> aborting ...
>>>>> Segmentation fault
>>>>> toys$R -q
>>>>>>
>>>>>> library(test2)
>>>>>> gpualloctest()
>>>>>
>>>>> testing allocation on gpu
>>>>> C Finished
>>>>> Collecting Garbage
>>>>> done.
>>>>>>
>>>>>> library.dynam.unload('test2',system.file(package='test2'))
>>>>>> q()
>>>>>
>>>>> Save workspace image? [y/n/c]: n
>>>>> toys$
>>>>> ---
>>>>>
>>>>> I have a in the test2/R/zzz.R file
>>>>> ---
>>>>> .onUnload <- function(libpath)
>>>>> ? ?library.dynam.unload("test2", libpath)
>>>>> ---
>>>>>
>>>>> so the code should be unloaded. ?But it appears that it is not from
>>>>> errors when I explicitly unload the test2.so it does not through a
>>>>> segfault. ?Why would this be happening? ?and how do I circumvent it.
>>>>>
>>>>> thanks,
>>>>> Andrew
>>>>>
>>>>>
>>>>> On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
>>>>> <ripley at stats.ox.ac.uk> wrote:
>>>>>>
>>>>>> On Fri, 12 Nov 2010, Andrew Redd wrote:
>>>>>>
>>>>>>> I have a package that I'm developing that I need to unload the
>>>>>>> library. ?Long story short I figured out that the leaving the compiled
>>>>>>> code loaded lead to a segmentation fault, but unloading the code will
>>>>>>> fix it. ?I've read the documentation and it appears that there are
>>>>>>> several ways to do this? ?What is the popper accepted current standard
>>>>>>> for unloading compiled code?
>>>>>>
>>>>>> Depends how you loaded it: you basically reverse the process.
>>>>>>
>>>>>>> The options as I understand them are:
>>>>>>> 1. dyn.unload
>>>>>>> 2. library.dynam.unload
>>>>>>> used with either
>>>>>>> A. .Last.lib
>>>>>>> B. .onUnload
>>>>>>>
>>>>>>> If it makes a difference my package does use a NAMESPACE so the
>>>>>>> package is loaded through useDynLib.
>>>>>>
>>>>>> So you need an .onUnload action calling library.dynam.unload.
>>>>>>
>>>>>> Slightly longer version: you need the DLL loaded whilst the namepace is
>>>>>> in
>>>>>> use, so it has to be in .onUnload, and useDynLib calls library.dynam so
>>>>>> you
>>>>>> need library.dynam.unload to do the housekeeping around dyn.unload
>>>>>> which
>>>>>> matches what library.dynam does around dyn.load.
>>>>>>
>>>>>> There are quite a lot of examples to look at, including in R itself.
>>>>>> MASS is
>>>>>> one example I've just checked.
>>>>>>
>>>>>> Having said all that, my experience is that unloading the DLL often
>>>>>> does not
>>>>>> help if you need to load it again (and that is why e.g. tcltk does not
>>>>>> unload its DLL).
>>>>>>
>>>>>>> Thanks,
>>>>>>> Andrew Redd
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>
>>>>>> --
>>>>>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>>>>>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>>>>>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>>>>>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>>>>>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>>>>>>
>>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> Charles C. Berry ? ? ? ? ? ? ? ? ? ? ? ? ? ?Dept of Family/Preventive
>> Medicine
>> cberry at tajo.ucsd.edu ? ? ? ? ? ? ? ? ? ? ? ?UC San Diego
>> http://famprevmed.ucsd.edu/faculty/cberry/ ?La Jolla, San Diego 92093-0901
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From djsamperi at gmail.com  Wed Nov 17 03:21:45 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Tue, 16 Nov 2010 21:21:45 -0500
Subject: [Rd] GNU make heads-up
Message-ID: <AANLkTimUF-NiHUKBZ5LpYg+BFjZ5q-nDsUnr92a+PHkv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101116/04a2799d/attachment.pl>

From friedrich.leisch at stat.uni-muenchen.de  Wed Nov 17 11:16:00 2010
From: friedrich.leisch at stat.uni-muenchen.de (friedrich.leisch at stat.uni-muenchen.de)
Date: Wed, 17 Nov 2010 11:16:00 +0100 (CET)
Subject: [Rd] Vignette Questions
In-Reply-To: <4CE28563.30903@units.it>
References: <4CE28563.30903@units.it>
Message-ID: <45716.194.94.45.21.1289988960.squirrel@webmail.lrz.de>

> Dear List,
>
> I recently stumbled over the possibility and need to specifiy
> % \VignetteDepends{}
> in my vignettes. I did not know about this, and I notice that it is not
> mentioned in the R-extensions manual section "Writing package vignettes".
> [...]

Very strange, both Kurt Hornik and myself could have sworn that this has
been documented. But of course you are right that it currently is not and
clearly should be. I will have a shot later this week.

Best regards,
Fritz Leisch


From simon.urbanek at r-project.org  Wed Nov 17 11:34:47 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 17 Nov 2010 11:34:47 +0100
Subject: [Rd] R5 reference classes: how to initialize exactly?
In-Reply-To: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>
References: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>
Message-ID: <F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>

Just a clarification for posterity - R5 has nothing to do with the new reference classes. It's not even an official name, but informally it's a collection of ideas for an entirely new object system that can replace both S3 and S4 (not that it will but it should be seen as having the capability to do so technically). Reference classes are just an addition to S4.

Cheers,
Simon


On Nov 16, 2010, at 12:30 AM, Janko Thyson wrote:

> Sorry, I was stupid:
> 
> 
> 
> MyRefObj <- setRefClass("Blabla", .)
> 
> 
> 
> One can always get the generator object of an defined class with
> 'getRefClass()'. So:
> 
> 
> 
> g <- getRefClass("Blabla")
> 
> x <- g$new(.)
> 
> 
> 
> Regards,
> 
> Janko
> 
> 
> 
> 
> 
> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de] 
> Gesendet: Dienstag, 16. November 2010 00:27
> An: 'r-devel at r-project. org'
> Betreff: R5 reference classes: how to initialize exactly?
> 
> 
> 
> Dear List,
> 
> 
> 
> So far, I really like those new R5 classes. But what kind of puzzles me is
> that it's not just enough to define the actual reference class, I also have
> to assign it to an object (e.g. 'MyRefObj') in order to fire
> 'MyRefObj$new(.)'.
> 
> 
> 
> S4:
> 
> setClass("Blabla", .)
> 
> x <- new("Blabla")
> 
> 
> 
> R5:
> 
> MyRefObj <- setRefClass("Blabla", .)
> 
> x <- MyRefObj$new(.)
> 
> 
> 
> But then how do I define a reference class in a package that should be
> available after the package is loaded via 'library(my_pkg)' as there is no
> 'MyRefObj' at startup yet? Do I have to call the script where the definition
> lives?
> 
> 
> 
> Thanks for any comments,
> 
> Janko
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From janko.thyson at ku-eichstaett.de  Wed Nov 17 11:39:40 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 17 Nov 2010 11:39:40 +0100
Subject: [Rd] R5 reference classes: how to initialize exactly?
In-Reply-To: <F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>
References: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>
	<F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>
Message-ID: <003001cb8643$bd85bb60$38913220$@thyson@ku-eichstaett.de>

> -----Urspr?ngliche Nachricht-----
> Von: Simon Urbanek [mailto:simon.urbanek at r-project.org]
> Gesendet: Mittwoch, 17. November 2010 11:35
> An: Janko Thyson
> Cc: 'r-devel at r-project. org'
> Betreff: Re: [Rd] R5 reference classes: how to initialize exactly?
> 
> Just a clarification for posterity - R5 has nothing to do with the new
> reference classes. It's not even an official name, but informally it's a
> collection of ideas for an entirely new object system that can replace
> both S3 and S4 (not that it will but it should be seen as having the
> capability to do so technically). Reference classes are just an addition
> to S4.
> 
> Cheers,
> Simon

Thanks for that clarification. I picked that name up from the Google
TechTalks presentation of Dirk and Romain. So I refer to them as S4
reference classes in future posts?

Regards,
Janko

> 
> 
> On Nov 16, 2010, at 12:30 AM, Janko Thyson wrote:
> 
> > Sorry, I was stupid:
> >
> >
> >
> > MyRefObj <- setRefClass("Blabla", .)
> >
> >
> >
> > One can always get the generator object of an defined class with
> > 'getRefClass()'. So:
> >
> >
> >
> > g <- getRefClass("Blabla")
> >
> > x <- g$new(.)
> >
> >
> >
> > Regards,
> >
> > Janko
> >
> >
> >
> >
> >
> > Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> > Gesendet: Dienstag, 16. November 2010 00:27
> > An: 'r-devel at r-project. org'
> > Betreff: R5 reference classes: how to initialize exactly?
> >
> >
> >
> > Dear List,
> >
> >
> >
> > So far, I really like those new R5 classes. But what kind of puzzles
> me is
> > that it's not just enough to define the actual reference class, I also
> have
> > to assign it to an object (e.g. 'MyRefObj') in order to fire
> > 'MyRefObj$new(.)'.
> >
> >
> >
> > S4:
> >
> > setClass("Blabla", .)
> >
> > x <- new("Blabla")
> >
> >
> >
> > R5:
> >
> > MyRefObj <- setRefClass("Blabla", .)
> >
> > x <- MyRefObj$new(.)
> >
> >
> >
> > But then how do I define a reference class in a package that should be
> > available after the package is loaded via 'library(my_pkg)' as there
> is no
> > 'MyRefObj' at startup yet? Do I have to call the script where the
> definition
> > lives?
> >
> >
> >
> > Thanks for any comments,
> >
> > Janko
> >
> >
> >
> >
> > 	[[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >


From romain at r-enthusiasts.com  Wed Nov 17 11:48:42 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Wed, 17 Nov 2010 11:48:42 +0100
Subject: [Rd] R5 reference classes: how to initialize exactly?
In-Reply-To: <003001cb8643$bd85bb60$38913220$@thyson@ku-eichstaett.de>
References: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>	<F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>
	<003001cb8643$bd85bb60$38913220$@thyson@ku-eichstaett.de>
Message-ID: <4CE3B30A.30100@r-enthusiasts.com>

Le 17/11/10 11:39, Janko Thyson a ?crit :
>
>> -----Urspr?ngliche Nachricht-----
>> Von: Simon Urbanek [mailto:simon.urbanek at r-project.org]
>> Gesendet: Mittwoch, 17. November 2010 11:35
>> An: Janko Thyson
>> Cc: 'r-devel at r-project. org'
>> Betreff: Re: [Rd] R5 reference classes: how to initialize exactly?
>>
>> Just a clarification for posterity - R5 has nothing to do with the new
>> reference classes. It's not even an official name, but informally it's a
>> collection of ideas for an entirely new object system that can replace
>> both S3 and S4 (not that it will but it should be seen as having the
>> capability to do so technically). Reference classes are just an addition
>> to S4.
>>
>> Cheers,
>> Simon
>
> Thanks for that clarification. I picked that name up from the Google
> TechTalks presentation of Dirk and Romain. So I refer to them as S4
> reference classes in future posts?
>
> Regards,
> Janko

Sorry about that. It was meant as a sort of private joke. (we do say in 
the talk that this is not an official name).

>> On Nov 16, 2010, at 12:30 AM, Janko Thyson wrote:
>>
>>> Sorry, I was stupid:
>>>
>>>
>>>
>>> MyRefObj<- setRefClass("Blabla", .)
>>>
>>>
>>>
>>> One can always get the generator object of an defined class with
>>> 'getRefClass()'. So:
>>>
>>>
>>>
>>> g<- getRefClass("Blabla")
>>>
>>> x<- g$new(.)
>>>
>>>
>>>
>>> Regards,
>>>
>>> Janko
>>>
>>>
>>>
>>>
>>>
>>> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
>>> Gesendet: Dienstag, 16. November 2010 00:27
>>> An: 'r-devel at r-project. org'
>>> Betreff: R5 reference classes: how to initialize exactly?
>>>
>>>
>>>
>>> Dear List,
>>>
>>>
>>>
>>> So far, I really like those new R5 classes. But what kind of puzzles
>> me is
>>> that it's not just enough to define the actual reference class, I also
>> have
>>> to assign it to an object (e.g. 'MyRefObj') in order to fire
>>> 'MyRefObj$new(.)'.
>>>
>>>
>>>
>>> S4:
>>>
>>> setClass("Blabla", .)
>>>
>>> x<- new("Blabla")
>>>
>>>
>>>
>>> R5:
>>>
>>> MyRefObj<- setRefClass("Blabla", .)
>>>
>>> x<- MyRefObj$new(.)
>>>
>>>
>>>
>>> But then how do I define a reference class in a package that should be
>>> available after the package is loaded via 'library(my_pkg)' as there
>> is no
>>> 'MyRefObj' at startup yet? Do I have to call the script where the
>> definition
>>> lives?
>>>
>>>
>>>
>>> Thanks for any comments,
>>>
>>> Janko


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From janko.thyson at ku-eichstaett.de  Wed Nov 17 13:07:18 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 17 Nov 2010 13:07:18 +0100
Subject: [Rd] Reference classes: accessor functions via
	'getRefClass(...)$accessors(...)'
Message-ID: <004401cb864f$fb225260$f166f720$@thyson@ku-eichstaett.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101117/2df9cb5f/attachment.pl>

From romain at r-enthusiasts.com  Wed Nov 17 13:19:14 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Wed, 17 Nov 2010 13:19:14 +0100
Subject: [Rd] Reference classes: accessor functions
	via	'getRefClass(...)$accessors(...)'
In-Reply-To: <004401cb864f$fb225260$f166f720$@thyson@ku-eichstaett.de>
References: <004401cb864f$fb225260$f166f720$@thyson@ku-eichstaett.de>
Message-ID: <4CE3C842.4040903@r-enthusiasts.com>

Le 17/11/10 13:07, Janko Thyson a ?crit :
>
> Hi there,
>
>
>
> I'd like to choose between an "static" and "dynamic" access of a reference
> class field, say 'a'.
>
>
>
> myObj<- getRefClass("Blabla")$new()
>
>
>
> Static:                   myObj$a
>
> Dynamic:             myObj$a.get() where the function retrieves the data
> from a database (or some other location), stores it to a buffer and
> optionally updates the static field value 'a'.
>
>
>
> I've set up such a method 'a.get()' where I can actually decide between
> static and dynamic runmode (so the method also wraps the call 'myObj$a' for
> the static runmode).
>
>
>
> Now I saw that setting up such accessor methods (get/set) is already done
> for me if I use 'getRefClass("Blabla")$accessors(.)'. I just don't
> understand what exactly I have to do there, because this results in an
> error: 'getRefClass("Blabla")$accessors("a")'
>
>
>
> Can anyone point me to the correct use of 'getRefClass(.)$accessors(.)'?
>
>
>
> Thanks a lot,
>
> Janko

Hi,

fields can either be data or active binding functionss. See 
?makeActiveBinding for some example of active binding functions in their 
original context.

Here is an example of a reference class that keeps its data in a file.

require( methods )

Foo <- setRefClass( "Foo",
     fields = list(
         file = "character",
         x = function(value){
             if( missing( value ) ){
                 read.table( file )
             } else{
                 write.table( value, file = file )
             }
         }
     )
)

foo <- Foo$new( file="/tmp/iris.txt" )
foo$x <- iris
foo$x

write.table( subset( iris, Petal.Length < 2), file = "/tmp/iris.txt" )
foo$x


Does that help ?


Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From spinuvit.list at gmail.com  Wed Nov 17 13:31:37 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Wed, 17 Nov 2010 13:31:37 +0100
Subject: [Rd] Subclasses of class "call" not possible in R.
Message-ID: <cpnsjz0i11y.fsf@gmail.com>


Hello Everyone!

I am trying to extend the class "call", but keep getting errors whatever I do:

setClass("mycall", contains = "call")
#[1] "mycall"

new("mycall")
#Error in function (object)  : 
#  error in evaluating the argument 'object' in selecting a method for function
#'show'

new("mycall", quote(a+b))
#Error in .getClassFromCache(Class, where) : 
#  could not find function "<undef>"


I understand this is rarely needed, but for some special reasons I really need
the class "call" (as usually returned by quote and substitute) and not class
"expression".

Would really appreciate any workarounds.

Thanks,
Vitalie.

platform       i386-pc-mingw32                             
arch           i386                                        
os             mingw32                                     
system         i386, mingw32                               
status         Patched                                     
major          2                                           
minor          12.0                                        
year           2010                                        
month          11                                          
day            01                                          
svn rev        53513                                       
language       R                                           
version.string R version 2.12.0 Patched (2010-11-01 r53513)


From spinuvit.list at gmail.com  Wed Nov 17 13:50:52 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Wed, 17 Nov 2010 13:50:52 +0100
Subject: [Rd] Reference classes: accessor functions via
	'getRefClass(...)$accessors(...)'
In-Reply-To: <47297.2810421654$1289995693@news.gmane.org> (Janko Thyson's
	message of "Wed, 17 Nov 2010 13:07:18 +0100")
References: <47297.2810421654$1289995693@news.gmane.org>
Message-ID: <cpnoc9oi05v.fsf@gmail.com>

"Janko Thyson" <janko.thyson at ku-eichstaett.de> writes:

> Hi there,
>
> I'd like to choose between an "static" and "dynamic" access of a reference
> class field, say 'a'.
>
> myObj <- getRefClass("Blabla")$new()
>
> Static:                   myObj$a
>
> Dynamic:             myObj$a.get() where the function retrieves the data
> from a database (or some other location), stores it to a buffer and
> optionally updates the static field value 'a'.
>
> I've set up such a method 'a.get()' where I can actually decide between
> static and dynamic runmode (so the method also wraps the call 'myObj$a' for
> the static runmode).
>
> Now I saw that setting up such accessor methods (get/set) is already done
> for me if I use 'getRefClass("Blabla")$accessors(.)'. I just don't
> understand what exactly I have to do there, because this results in an
> error: 'getRefClass("Blabla")$accessors("a")'
>
> Can anyone point me to the correct use of 'getRefClass(.)$accessors(.)'?

It works for me:

X <- setRefClass("XXX", fields = list(a = "character"))
X$accessors("a")
X
# ...
# Class Methods:  
#    "callSuper", "export", "getA", "import", "initFields", "setA"
# ...

accessors() convenience method creates setA and getA functions:

x <- X$new()
x$getA
#Class method definition for method getA()
#function () 
#a
#<environment: 02a198c0>

HTH,
Vitalie.

> 
>
> Thanks a lot,
>
> Janko
>
> 	[[alternative HTML version deleted]]


From nashjc at uottawa.ca  Wed Nov 17 15:15:21 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Wed, 17 Nov 2010 09:15:21 -0500
Subject: [Rd] [R] DBLEPR?
Message-ID: <4CE3E379.2080409@uottawa.ca>

Thanks for comments from several folk, fix from Doug Bates and start to finding new email
for ucminf maintainer.

Summary of responses:

DBLEPR and its relations are briefly mentioned but with no or minimal examples in Writing
R Extensions as well as Venables and Ripley book. I should have emphasized I was
especially seeking examples, and Brian Ripley has pointed out that cluster, mda and
tweedie among others use these routines.

Fortran WRITE or PRINT routines, even if unused by code, may interfere with C output,
especially in Windows. (See R-devel post from Brian Ripley).

Doug Bates provided a different approach and code that appears to fix ucminf.

We have a lead on contacting the maintainer, who has moved, so hopefully the package can
be updated.

My conclusion from this: xxxPR routines are still usable, but likely not the best approach
for output from Fortran routines.

Once again, thanks to all.

JN


From janko.thyson at ku-eichstaett.de  Wed Nov 17 15:33:24 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 17 Nov 2010 15:33:24 +0100
Subject: [Rd] Reference classes: accessor functions via
	'getRefClass(...)$accessors(...)'
In-Reply-To: <cpnoc9oi05v.fsf@gmail.com>
References: <47297.2810421654$1289995693@news.gmane.org>
	<cpnoc9oi05v.fsf@gmail.com>
Message-ID: <006101cb8664$63e673d0$2bb35b70$@thyson@ku-eichstaett.de>

Thanks a lot for the comments! I'll give the serveral alternatives a try to
see if it gets me what I want.

Cheers, 
Janko

> -----Urspr?ngliche Nachricht-----
> Von: Vitalie S. [mailto:spinuvit.list at gmail.com]
> Gesendet: Mittwoch, 17. November 2010 13:51
> An: Janko Thyson
> Cc: 'r-devel at r-project. org'
> Betreff: Re: Reference classes: accessor functions via
> 'getRefClass(...)$accessors(...)'
> 
> "Janko Thyson" <janko.thyson at ku-eichstaett.de> writes:
> 
> > Hi there,
> >
> > I'd like to choose between an "static" and "dynamic" access of a
> reference
> > class field, say 'a'.
> >
> > myObj <- getRefClass("Blabla")$new()
> >
> > Static:                   myObj$a
> >
> > Dynamic:             myObj$a.get() where the function retrieves the
> data
> > from a database (or some other location), stores it to a buffer and
> > optionally updates the static field value 'a'.
> >
> > I've set up such a method 'a.get()' where I can actually decide
> between
> > static and dynamic runmode (so the method also wraps the call
> 'myObj$a' for
> > the static runmode).
> >
> > Now I saw that setting up such accessor methods (get/set) is already
> done
> > for me if I use 'getRefClass("Blabla")$accessors(.)'. I just don't
> > understand what exactly I have to do there, because this results in
> an
> > error: 'getRefClass("Blabla")$accessors("a")'
> >
> > Can anyone point me to the correct use of
> 'getRefClass(.)$accessors(.)'?
> 
> It works for me:
> 
> X <- setRefClass("XXX", fields = list(a = "character"))
> X$accessors("a")
> X
> # ...
> # Class Methods:
> #    "callSuper", "export", "getA", "import", "initFields", "setA"
> # ...
> 
> accessors() convenience method creates setA and getA functions:
> 
> x <- X$new()
> x$getA
> #Class method definition for method getA()
> #function ()
> #a
> #<environment: 02a198c0>
> 
> HTH,
> Vitalie.
> 
> >
> >
> > Thanks a lot,
> >
> > Janko
> >
> > 	[[alternative HTML version deleted]]


From ddickison at carnegielearning.com  Wed Nov 17 16:49:24 2010
From: ddickison at carnegielearning.com (Dickison, Daniel)
Date: Wed, 17 Nov 2010 10:49:24 -0500
Subject: [Rd] Bug in agrep computing edit distance?
Message-ID: <C90963B4.2B00%ddickison@carnegielearning.com>

I posted this yesterday to r-help and Ben Bolker suggested reposting it
here...

Dickison, Daniel <ddickison <at> carnegielearning.com> writes:

>
> The documentation for agrep says it uses the Levenshtein edit distance,
> but it seems to get this wrong in certain cases when there is a
> combination of deletions and substitutions.  For example:
>
> > agrep("abcd", "abcxyz", max.distance=1)
> [1] 1
>
> That should've been a no-match.  The edit distance between those strings
> is 3 (1 substitution, 2 deletions), but agrep matches with max.distance
>>=
> 1.
>
> I didn't find anything in the bug database, so I was wondering if somehow
> I'm misinterpreting how agrep works.  If not, should I file this in
> Bugzilla?
>

  Could you re-post this on r-devel?  It definitely sounds like
this is worth following up.  Based on a little bit of playing around,
it's quite clear that I don't understand what's going on.  The examples
show things like

agrep("lasy","lazy",max=list(sub=0))

 which makes sense, but

agrep("lasy","lazybc",max=1)
agrep("lasy","lazybc",max=0.001)
agrep("lasy","layt",max=list(all=1))

and

agrep("x",c("x","xy","xyz","xyza"),max=list(insertions=2))
agrep("x",c("x","xy","xyz","xyza"),max=list(deletions=2))
agrep("x",c("x","xy","xyz","xyza"),max=list(all=2))

  all give "1 2 3 4" ??

  this makes it clear that I really don't understand what's going on
based on the documentation.  I tried to trace into the C code
(which calls functions from the TRE regexp library) but that didn't
help much ...



Daniel  Dickison
Research Programmer
ddickison at carnegielearning.com
Toll Free: (888) 851-7094 x103
FAX: (412) 690-2444

Revolutionary Math Curricula. Revolutionary Results.

Carnegie Learning, Inc. | 437 Grant St. 20th Floor | Pittsburgh, PA 15219
www.carnegielearning.com


From jorismeys at gmail.com  Wed Nov 17 17:47:51 2010
From: jorismeys at gmail.com (Joris Meys)
Date: Wed, 17 Nov 2010 17:47:51 +0100
Subject: [Rd] Bug in agrep computing edit distance?
In-Reply-To: <C90963B4.2B00%ddickison@carnegielearning.com>
References: <C90963B4.2B00%ddickison@carnegielearning.com>
Message-ID: <AANLkTi=mUOWUPD=7PWkKMHarcHW6rb58TvWnsjEKMUho@mail.gmail.com>

It might have to do something with spaces and the interpretation of
insertions, as far as I understand the following examples :

> agrep("x",c("x","xy","xyz","xyza"),max=list(all=1))
[1] 1 2 3 4
> agrep("x    ",c("x    ","xy  ","xyz ","xyza"),max=list(all=1))
[1] 1
> agrep("xx",c("xx","xyx","xyzx","xyzax",max=list(all=1)))
[1] 1 2 3 4
> agrep("xx",c("xx","xyx","xyzx","xyzax",max=list(ins=1)))
[1] 1 2 3 4
> agrep("xx   ",c("xx   ","xyx  ","xyzx ","xyzax",max=list(all=2)))
[1] 1
> agrep("xx   ",c("xx   ","xyx  ","xyzx ","xyzax",max=list(all=3)))
[1] 1

If the sequences are made the same length in spaces, this function
gives the expected result in the second example, but it definitely
doesn't do that any more when you start playing around with
insertions. If not a bug, it definitely behaves pretty weird...

Cheers
Joris

On Wed, Nov 17, 2010 at 4:49 PM, Dickison, Daniel
<ddickison at carnegielearning.com> wrote:
> I posted this yesterday to r-help and Ben Bolker suggested reposting it
> here...
>
> Dickison, Daniel <ddickison <at> carnegielearning.com> writes:
>
>>
>> The documentation for agrep says it uses the Levenshtein edit distance,
>> but it seems to get this wrong in certain cases when there is a
>> combination of deletions and substitutions. ?For example:
>>
>> > agrep("abcd", "abcxyz", max.distance=1)
>> [1] 1
>>
>> That should've been a no-match. ?The edit distance between those strings
>> is 3 (1 substitution, 2 deletions), but agrep matches with max.distance
>>>=
>> 1.
>>
>> I didn't find anything in the bug database, so I was wondering if somehow
>> I'm misinterpreting how agrep works. ?If not, should I file this in
>> Bugzilla?
>>
>
> ?Could you re-post this on r-devel? ?It definitely sounds like
> this is worth following up. ?Based on a little bit of playing around,
> it's quite clear that I don't understand what's going on. ?The examples
> show things like
>
> agrep("lasy","lazy",max=list(sub=0))
>
> ?which makes sense, but
>
> agrep("lasy","lazybc",max=1)
> agrep("lasy","lazybc",max=0.001)
> agrep("lasy","layt",max=list(all=1))
>
> and
>
> agrep("x",c("x","xy","xyz","xyza"),max=list(insertions=2))
> agrep("x",c("x","xy","xyz","xyza"),max=list(deletions=2))
> agrep("x",c("x","xy","xyz","xyza"),max=list(all=2))
>
> ?all give "1 2 3 4" ??
>
> ?this makes it clear that I really don't understand what's going on
> based on the documentation. ?I tried to trace into the C code
> (which calls functions from the TRE regexp library) but that didn't
> help much ...
>
>
>
> Daniel ?Dickison
> Research Programmer
> ddickison at carnegielearning.com
> Toll Free: (888) 851-7094 x103
> FAX: (412) 690-2444
>
> Revolutionary Math Curricula. Revolutionary Results.
>
> Carnegie Learning, Inc. | 437 Grant St. 20th Floor | Pittsburgh, PA 15219
> www.carnegielearning.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Applied mathematics, biometrics and process control

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From janko.thyson at ku-eichstaett.de  Wed Nov 17 17:51:15 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 17 Nov 2010 17:51:15 +0100
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
Message-ID: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101117/d813e1f5/attachment.pl>

From jmc at r-project.org  Wed Nov 17 18:00:41 2010
From: jmc at r-project.org (John Chambers)
Date: Wed, 17 Nov 2010 09:00:41 -0800
Subject: [Rd] R5 reference classes: how to initialize exactly?
In-Reply-To: <F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>
References: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>
	<F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>
Message-ID: <4CE40A39.6080006@r-project.org>

On the subject of clarification, Reference Classes are not really an 
"addition" to S4.  They are a programming interface to allow OOP (i.e., 
C++ or Java-style) programming in R.

They do use some S4 tools but rely more on some valuable existing 
techniques for dealing with environments, such as active bindings.  They 
use a thin layer on top of existing R with the goal of simpler and 
clearer programming where object references and class-based methods are 
useful.

John

On 11/17/10 2:34 AM, Simon Urbanek wrote:
> Just a clarification for posterity - R5 has nothing to do with the new reference classes. It's not even an official name, but informally it's a collection of ideas for an entirely new object system that can replace both S3 and S4 (not that it will but it should be seen as having the capability to do so technically). Reference classes are just an addition to S4.
>

> Cheers,
> Simon
>
>
> On Nov 16, 2010, at 12:30 AM, Janko Thyson wrote:
>
>> Sorry, I was stupid:
>>
>>
>>
>> MyRefObj<- setRefClass("Blabla", .)
>>
>>
>>
>> One can always get the generator object of an defined class with
>> 'getRefClass()'. So:
>>
>>
>>
>> g<- getRefClass("Blabla")
>>
>> x<- g$new(.)
>>
>>
>>
>> Regards,
>>
>> Janko
>>
>>
>>
>>
>>
>> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
>> Gesendet: Dienstag, 16. November 2010 00:27
>> An: 'r-devel at r-project. org'
>> Betreff: R5 reference classes: how to initialize exactly?
>>
>>
>>
>> Dear List,
>>
>>
>>
>> So far, I really like those new R5 classes. But what kind of puzzles me is
>> that it's not just enough to define the actual reference class, I also have
>> to assign it to an object (e.g. 'MyRefObj') in order to fire
>> 'MyRefObj$new(.)'.
>>
>>
>>
>> S4:
>>
>> setClass("Blabla", .)
>>
>> x<- new("Blabla")
>>
>>
>>
>> R5:
>>
>> MyRefObj<- setRefClass("Blabla", .)
>>
>> x<- MyRefObj$new(.)
>>
>>
>>
>> But then how do I define a reference class in a package that should be
>> available after the package is loaded via 'library(my_pkg)' as there is no
>> 'MyRefObj' at startup yet? Do I have to call the script where the definition
>> lives?
>>
>>
>>
>> Thanks for any comments,
>>
>> Janko
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Wed Nov 17 18:41:36 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 17 Nov 2010 17:41:36 +0000 (GMT)
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
In-Reply-To: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>
Message-ID: <alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>

Is this on Windows?  (Please do consult the posting guide and tell us 
the 'at a minimum' information we asked for.)

If so, it seems you forget the bit about setting TMPDIR right at the 
top of the section on 'Building the core files':

   Set the environment variable @env{TMPDIR} to point to a writable
   directory, with a path specified with forward slashes and no spaces.
   (The default is @file{/tmp}, which may not be useful on Windows.)


On Wed, 17 Nov 2010, Janko Thyson wrote:

> Dear list,
>
>
>
> I've just tried to compile R 2.12.0 from source as I think I found an error
> in a C function that I would like to fix and check before I go ahead with
> posting the presumed error.
>
>
>
> I've got the R Toolset 2.12 installed and configured correctly and followed
> the Admin manual closely (including the entire bitmap stuff; exact same
> versions as in the manual). Also, all anti virus software is turned off (as
> it complained on some .exe). I have Admin rights on my box.
>
>
>
> When I run 'make all recommended' I get the following error after a while:
>
>
>
> cannot create /tmp/R5436: directory nonexistent
>
> mv: cannot stat `/tmp/R5436': No such file or directory
>
> make[3]: *** [mkR] Error 1
>
> make[2]: *** [all] Error 2
>
> make[1]: *** [R] Error 1
>
> make: *** [all] Error 2
>
>
>
> Any ideas what this is about? Seems that the compiler can't create a temp
> directory because of a missing directory.
>
>
>
> Thanks for any hints,
>
> Janko
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From janko.thyson at ku-eichstaett.de  Wed Nov 17 19:55:43 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 17 Nov 2010 19:55:43 +0100
Subject: [Rd] Reference classes: opinion on OOP design
Message-ID: <00a001cb8689$09219b30$1b64d190$@thyson@ku-eichstaett.de>

Dear list,

I'm aware that this post does not really comply with the posting guide with
respect to "providing a minimal reproducible code example". But I do hope
it's okay that I spared uninterested readers by putting that into the
attachment ;-)

The thing is that I'm not really familiar with "true" OOP as R is my first
programming language. So I wanted to ask kindly for some expert opinion on a
certain paradigm I've come up with concerning my use of class defs and
methods (S4 Reference Classes and S4 methods).

MY GOAL:
I thought it'd be neat to have Reference Class instances that can
- load data from remote places (e.g. a db, file whatever) on demand
- enable field access in a static OR dynamic way:
   o static -> regular "static" field access (or if not initialized yet:
retrieve data (optionally buffer it) -> write it to "static" field)
   o dynamic -> retrieve data (as it might have changed in the remote
location in the meantime) and optionally buffer it for later use
- enable sync of dynamic/buffer values with static field values (e.g.
whenever the difference between static and dynamic value passes threshold x
-> 
  sync static and dynamic values.
- Provide a value history (which might be useful for something ;-))
- Enable explicitly setting field values and facilitate their "writeback" to
the remote location

The instances should be flexible enough to work in an "static only" and
"dynamic only" context and should make as much use of existing functionality
(e.g. S4 classes, S4 method dispatch etc.) as possible. I do want to have
the choice if I'm carrying (possibly loads of) data with me in the fields of
my object or if I compute/get them based on some function whenever I
actually need it. For example, I'm thinking about parameter estimates that
could automatically be reestimated based on rules that take into account a
constantly changing data structure (new observations come it quite
frequently or something like that).
 
What do you think of the way I've implemented this? Does this make sense to
you or is something like this done in another (and probably more elegant
;-)) way?

THE HOMEWORK I DID
- I've looked at active bindings which are nice. But this limits me to funs
with either none or one argument if I'm not mistaken.
- I do like the idea of 'getRefClass("Blabla")$accessors(.)' setting up
get/set methods for me, but would need to customize them to my specific
needs 
  (e.g. handling the default values of method arguments etc.)

I've attached a code example and would really appreciate your comments if
you find some time.

Thanks a lot!!
Janko

From janko.thyson at ku-eichstaett.de  Wed Nov 17 20:00:36 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 17 Nov 2010 20:00:36 +0100
Subject: [Rd] WG: Reference classes: opinion on OOP design
Message-ID: <00aa01cb8689$b7e71f50$27b55df0$@thyson@ku-eichstaett.de>

Sorry, never sent an attachment before. I think my .R file didn't pass, so
I'm attaching a .txt instead.

-----Urspr?ngliche Nachricht-----
Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de] 
Gesendet: Mittwoch, 17. November 2010 19:56
An: 'r-devel at r-project. org'
Betreff: Reference classes: opinion on OOP design

Dear list,

I?m aware that this post does not really comply with the posting guide with
respect to ?providing a minimal reproducible code example?. But I do hope
it?s okay that I spared uninterested readers by putting that into the
attachment ;-)

The thing is that I?m not really familiar with ?true? OOP as R is my first
programming language. So I wanted to ask kindly for some expert opinion on a
certain paradigm I?ve come up with concerning my use of class defs and
methods (S4 Reference Classes and S4 methods).

MY GOAL:
I thought it?d be neat to have Reference Class instances that can
- load data from remote places (e.g. a db, file whatever) on demand
- enable field access in a static OR dynamic way:
   o static -> regular ?static? field access (or if not initialized yet:
retrieve data (optionally buffer it) -> write it to ?static? field)
   o dynamic -> retrieve data (as it might have changed in the remote
location in the meantime) and optionally buffer it for later use
- enable sync of dynamic/buffer values with static field values (e.g.
whenever the difference between static and dynamic value passes threshold x
-> 
  sync static and dynamic values.
- Provide a value history (which might be useful for something ;-))
- Enable explicitly setting field values and facilitate their ?writeback? to
the remote location

The instances should be flexible enough to work in an "static only" and
"dynamic only" context and should make as much use of existing functionality
(e.g. S4 classes, S4 method dispatch etc.) as possible. I do want to have
the choice if I?m carrying (possibly loads of) data with me in the fields of
my object or if I compute/get them based on some function whenever I
actually need it. For example, I'm thinking about parameter estimates that
could automatically be reestimated based on rules that take into account a
constantly changing data structure (new observations come it quite
frequently or something like that).
 
What do you think of the way I?ve implemented this? Does this make sense to
you or is something like this done in another (and probably more elegant
;-)) way?

THE HOMEWORK I DID
- I?ve looked at active bindings which are nice. But this limits me to funs
with either none or one argument if I?m not mistaken.
- I do like the idea of ?getRefClass(?Blabla?)$accessors(
)? setting up
get/set methods for me, but would need to customize them to my specific
needs 
  (e.g. handling the default values of method arguments etc.)

I?ve attached a code example and would really appreciate your comments if
you find some time.

Thanks a lot!!
Janko
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: r-devel_example.txt
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101117/ac8d2a98/attachment.txt>

From ddickison at carnegielearning.com  Wed Nov 17 20:54:44 2010
From: ddickison at carnegielearning.com (Dickison, Daniel)
Date: Wed, 17 Nov 2010 14:54:44 -0500
Subject: [Rd] Bug in agrep computing edit distance?
In-Reply-To: <AANLkTi=mUOWUPD=7PWkKMHarcHW6rb58TvWnsjEKMUho@mail.gmail.com>
Message-ID: <C9099657.2B16%ddickison@carnegielearning.com>

I downloaded and compiled the standalone TRE agrep command line program,
and I think I have a slightly better idea of what's going on.  Basically
R's agrep, like the command line tool, is matching all strings that
*contain* the pattern.  So, essentially, insertions before and after the
pattern is "free".

As far as I can tell, there isn't an option to require full-string matches
using the TRE library.  It should be possible to not use REG_LITERAL and
surround the pattern with ^ and $, but that would require escaping all
special characters in the original pattern.

Is this something worth pursuing?  (For my immediate needs I'll probably
create a separate function that passes the regex directly to TRE without
REG_LITERAL).

Daniel

On 11/17/10 11:47 AM, "Joris Meys" <jorismeys at gmail.com> wrote:

>It might have to do something with spaces and the interpretation of
>insertions, as far as I understand the following examples :
>
>> agrep("x",c("x","xy","xyz","xyza"),max=list(all=1))
>[1] 1 2 3 4
>> agrep("x    ",c("x    ","xy  ","xyz ","xyza"),max=list(all=1))
>[1] 1
>> agrep("xx",c("xx","xyx","xyzx","xyzax",max=list(all=1)))
>[1] 1 2 3 4
>> agrep("xx",c("xx","xyx","xyzx","xyzax",max=list(ins=1)))
>[1] 1 2 3 4
>> agrep("xx   ",c("xx   ","xyx  ","xyzx ","xyzax",max=list(all=2)))
>[1] 1
>> agrep("xx   ",c("xx   ","xyx  ","xyzx ","xyzax",max=list(all=3)))
>[1] 1
>
>If the sequences are made the same length in spaces, this function
>gives the expected result in the second example, but it definitely
>doesn't do that any more when you start playing around with
>insertions. If not a bug, it definitely behaves pretty weird...
>
>Cheers
>Joris
>
>On Wed, Nov 17, 2010 at 4:49 PM, Dickison, Daniel
><ddickison at carnegielearning.com> wrote:
>> I posted this yesterday to r-help and Ben Bolker suggested reposting it
>> here...
>>
>> Dickison, Daniel <ddickison <at> carnegielearning.com> writes:
>>
>>>
>>> The documentation for agrep says it uses the Levenshtein edit distance,
>>> but it seems to get this wrong in certain cases when there is a
>>> combination of deletions and substitutions.  For example:
>>>
>>> > agrep("abcd", "abcxyz", max.distance=1)
>>> [1] 1
>>>
>>> That should've been a no-match.  The edit distance between those
>>>strings
>>> is 3 (1 substitution, 2 deletions), but agrep matches with max.distance
>>>>=
>>> 1.
>>>
>>> I didn't find anything in the bug database, so I was wondering if
>>>somehow
>>> I'm misinterpreting how agrep works.  If not, should I file this in
>>> Bugzilla?
>>>
>>
>>  Could you re-post this on r-devel?  It definitely sounds like
>> this is worth following up.  Based on a little bit of playing around,
>> it's quite clear that I don't understand what's going on.  The examples
>> show things like
>>
>> agrep("lasy","lazy",max=list(sub=0))
>>
>>  which makes sense, but
>>
>> agrep("lasy","lazybc",max=1)
>> agrep("lasy","lazybc",max=0.001)
>> agrep("lasy","layt",max=list(all=1))
>>
>> and
>>
>> agrep("x",c("x","xy","xyz","xyza"),max=list(insertions=2))
>> agrep("x",c("x","xy","xyz","xyza"),max=list(deletions=2))
>> agrep("x",c("x","xy","xyz","xyza"),max=list(all=2))
>>
>>  all give "1 2 3 4" ??
>>
>>  this makes it clear that I really don't understand what's going on
>> based on the documentation.  I tried to trace into the C code
>> (which calls functions from the TRE regexp library) but that didn't
>> help much ...
>>
>>
>>
>> Daniel  Dickison
>> Research Programmer
>> ddickison at carnegielearning.com
>> Toll Free: (888) 851-7094 x103
>> FAX: (412) 690-2444
>>
>> Revolutionary Math Curricula. Revolutionary Results.
>>
>> Carnegie Learning, Inc. | 437 Grant St. 20th Floor | Pittsburgh, PA
>>15219
>> www.carnegielearning.com
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
>-- 
>Joris Meys
>Statistical consultant
>
>Ghent University
>Faculty of Bioscience Engineering
>Department of Applied mathematics, biometrics and process control
>
>tel : +32 9 264 59 87
>Joris.Meys at Ugent.be
>-------------------------------
>Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From cberry at tajo.ucsd.edu  Wed Nov 17 21:24:54 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Wed, 17 Nov 2010 12:24:54 -0800
Subject: [Rd] Bug in agrep computing edit distance?
In-Reply-To: <C9099657.2B16%ddickison@carnegielearning.com>
References: <C9099657.2B16%ddickison@carnegielearning.com>
Message-ID: <Pine.LNX.4.64.1011171219080.24382@tajo.ucsd.edu>

On Wed, 17 Nov 2010, Dickison, Daniel wrote:

> I downloaded and compiled the standalone TRE agrep command line program,
> and I think I have a slightly better idea of what's going on.  Basically
> R's agrep, like the command line tool, is matching all strings that
> *contain* the pattern.  So, essentially, insertions before and after the
> pattern is "free".
>
> As far as I can tell, there isn't an option to require full-string matches
> using the TRE library.  It should be possible to not use REG_LITERAL and
> surround the pattern with ^ and $, but that would require escaping all
> special characters in the original pattern.
>
> Is this something worth pursuing?  (For my immediate needs I'll probably
> create a separate function that passes the regex directly to TRE without
> REG_LITERAL).
>

I am joining this thread late, but I wonder if reversing agrep's 'pattern' 
and 'x' args serves the OP's need.

viz.

> sapply( c("x","xy","xyz","xyza"),
+ function(y) any( agrep( y, "x", max=list(all=1))))
     x    xy   xyz  xyza
  TRUE  TRUE FALSE FALSE


HTH,

Chuck


> Daniel
>
> On 11/17/10 11:47 AM, "Joris Meys" <jorismeys at gmail.com> wrote:
>
>> It might have to do something with spaces and the interpretation of
>> insertions, as far as I understand the following examples :
>>
>>> agrep("x",c("x","xy","xyz","xyza"),max=list(all=1))
>> [1] 1 2 3 4
>>> agrep("x    ",c("x    ","xy  ","xyz ","xyza"),max=list(all=1))
>> [1] 1
>>> agrep("xx",c("xx","xyx","xyzx","xyzax",max=list(all=1)))
>> [1] 1 2 3 4
>>> agrep("xx",c("xx","xyx","xyzx","xyzax",max=list(ins=1)))
>> [1] 1 2 3 4
>>> agrep("xx   ",c("xx   ","xyx  ","xyzx ","xyzax",max=list(all=2)))
>> [1] 1
>>> agrep("xx   ",c("xx   ","xyx  ","xyzx ","xyzax",max=list(all=3)))
>> [1] 1
>>
>> If the sequences are made the same length in spaces, this function
>> gives the expected result in the second example, but it definitely
>> doesn't do that any more when you start playing around with
>> insertions. If not a bug, it definitely behaves pretty weird...
>>
>> Cheers
>> Joris
>>
>> On Wed, Nov 17, 2010 at 4:49 PM, Dickison, Daniel
>> <ddickison at carnegielearning.com> wrote:
>>> I posted this yesterday to r-help and Ben Bolker suggested reposting it
>>> here...
>>>
>>> Dickison, Daniel <ddickison <at> carnegielearning.com> writes:
>>>
>>>>
>>>> The documentation for agrep says it uses the Levenshtein edit distance,
>>>> but it seems to get this wrong in certain cases when there is a
>>>> combination of deletions and substitutions.  For example:
>>>>
>>>>> agrep("abcd", "abcxyz", max.distance=1)
>>>> [1] 1
>>>>
>>>> That should've been a no-match.  The edit distance between those
>>>> strings
>>>> is 3 (1 substitution, 2 deletions), but agrep matches with max.distance
>>>>> =
>>>> 1.
>>>>
>>>> I didn't find anything in the bug database, so I was wondering if
>>>> somehow
>>>> I'm misinterpreting how agrep works.  If not, should I file this in
>>>> Bugzilla?
>>>>
>>>
>>>  Could you re-post this on r-devel?  It definitely sounds like
>>> this is worth following up.  Based on a little bit of playing around,
>>> it's quite clear that I don't understand what's going on.  The examples
>>> show things like
>>>
>>> agrep("lasy","lazy",max=list(sub=0))
>>>
>>>  which makes sense, but
>>>
>>> agrep("lasy","lazybc",max=1)
>>> agrep("lasy","lazybc",max=0.001)
>>> agrep("lasy","layt",max=list(all=1))
>>>
>>> and
>>>
>>> agrep("x",c("x","xy","xyz","xyza"),max=list(insertions=2))
>>> agrep("x",c("x","xy","xyz","xyza"),max=list(deletions=2))
>>> agrep("x",c("x","xy","xyz","xyza"),max=list(all=2))
>>>
>>>  all give "1 2 3 4" ??
>>>
>>>  this makes it clear that I really don't understand what's going on
>>> based on the documentation.  I tried to trace into the C code
>>> (which calls functions from the TRE regexp library) but that didn't
>>> help much ...
>>>
>>>
>>>
>>> Daniel  Dickison
>>> Research Programmer
>>> ddickison at carnegielearning.com
>>> Toll Free: (888) 851-7094 x103
>>> FAX: (412) 690-2444
>>>
>>> Revolutionary Math Curricula. Revolutionary Results.
>>>
>>> Carnegie Learning, Inc. | 437 Grant St. 20th Floor | Pittsburgh, PA
>>> 15219
>>> www.carnegielearning.com
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>> --
>> Joris Meys
>> Statistical consultant
>>
>> Ghent University
>> Faculty of Bioscience Engineering
>> Department of Applied mathematics, biometrics and process control
>>
>> tel : +32 9 264 59 87
>> Joris.Meys at Ugent.be
>> -------------------------------
>> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From ddickison at carnegielearning.com  Thu Nov 18 00:23:39 2010
From: ddickison at carnegielearning.com (Dickison, Daniel)
Date: Wed, 17 Nov 2010 18:23:39 -0500
Subject: [Rd] Bug in agrep computing edit distance?
In-Reply-To: <AANLkTimcYnOfRGAFbkrP3uEHKaQ8Q0iPcQRch69iHJa=@mail.gmail.com>
Message-ID: <C909CBCE.2B6D%ddickison@carnegielearning.com>

On 11/17/10 6:06 PM, "Joris Meys" <jorismeys at gmail.com> wrote:

>Indeed, I get it. If the pattern is "xx", it is only matched against 2
>letters at the same time. All the rest doesn't matter. But still that
>doesn't explain
>
>>agrep("ANNTCG", "ANNXXTCG", max = list(ins=3))
>integer(0)
>>agrep("ANNTCG", "ANNXTCG", max = list(ins=3))
>[1] 1
>>agrep("ANNTCG", "ANTCG", max = list(del=3))
>[1] 1
>>agrep("ANNTCG", "ATCG", max = list(del=3))
>integer(0)

It looks like R's agrep defaults max.distance$all to 0.1 if unspecified by
the argument, so that explains these examples (the first and last one have
a net distance of 2, which is > ceiling(0.1 * nchar(pattern))).

The attachment is a completely untested fix that turns the pattern into a
regex (I haven't yet succeeded in setting up an environment to compile R
from source).  Since TRE defaults to Basic POSIX regex syntax, in theory
only backslashes in the user-provided pattern need to be escaped, and \^
and \$ added to the pattern.  Hopefully somebody can review this to see if
it looks correct.

Daniel



Daniel  Dickison
Research Programmer
ddickison at carnegielearning.com
Toll Free: (888) 851-7094 x103
FAX: (412) 690-2444

Revolutionary Math Curricula. Revolutionary Results.

Carnegie Learning, Inc. | 437 Grant St. 20th Floor | Pittsburgh, PA 15219
www.carnegielearning.com


From ngkbr8es at gmail.com  Thu Nov 18 02:04:46 2010
From: ngkbr8es at gmail.com (Patrick Leyshock)
Date: Wed, 17 Nov 2010 17:04:46 -0800
Subject: [Rd] Performance monitoring tools
In-Reply-To: <AANLkTi=vYhrGqJzAeAUHm8Ds2noNfdHQzmntWEWWBfXt@mail.gmail.com>
References: <AANLkTi=vYhrGqJzAeAUHm8Ds2noNfdHQzmntWEWWBfXt@mail.gmail.com>
Message-ID: <AANLkTikdwNC4JoCvz7DUfKA8vXj+NzuOo4P=221dUfeJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101117/e5bf04e3/attachment.pl>

From brian at braverock.com  Thu Nov 18 08:47:17 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 18 Nov 2010 01:47:17 -0600
Subject: [Rd] Performance monitoring tools
In-Reply-To: <AANLkTikdwNC4JoCvz7DUfKA8vXj+NzuOo4P=221dUfeJ@mail.gmail.com>
References: <AANLkTi=vYhrGqJzAeAUHm8Ds2noNfdHQzmntWEWWBfXt@mail.gmail.com>
	<AANLkTikdwNC4JoCvz7DUfKA8vXj+NzuOo4P=221dUfeJ@mail.gmail.com>
Message-ID: <3cd217193e442071ed0ad3b8698123b6@braverock.com>

On Wed, 17 Nov 2010 17:04:46 -0800, Patrick Leyshock <ngkbr8es at gmail.com>
wrote:
> Hello,
> 
> Are there any good tools available for monitoring the performance of R?
I'm
> wanting to capture things such as time elapsed in evaluating an
expression,
> memory usage over time (or operation), and so on.
> 
> I could build my own but would like to follow established practice, if
> there is one.

Start with Chapter 3 of the "Writing R Extensions" manual
"Tidying and profiling R code"

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jorismeys at gmail.com  Thu Nov 18 10:56:56 2010
From: jorismeys at gmail.com (Joris Meys)
Date: Thu, 18 Nov 2010 10:56:56 +0100
Subject: [Rd] Bug in agrep computing edit distance?
In-Reply-To: <C909CBCE.2B6D%ddickison@carnegielearning.com>
References: <AANLkTimcYnOfRGAFbkrP3uEHKaQ8Q0iPcQRch69iHJa=@mail.gmail.com>
	<C909CBCE.2B6D%ddickison@carnegielearning.com>
Message-ID: <AANLkTik4cB7pxug6Mz75Ok0646ajVDgBY59NVcOA-kfr@mail.gmail.com>

On Thu, Nov 18, 2010 at 12:23 AM, Dickison, Daniel
<ddickison at carnegielearning.com> wrote:
> On 11/17/10 6:06 PM, "Joris Meys" <jorismeys at gmail.com> wrote:
>
> It looks like R's agrep defaults max.distance$all to 0.1 if unspecified by
> the argument, so that explains these examples (the first and last one have
> a net distance of 2, which is > ceiling(0.1 * nchar(pattern))).

Stupid I missed that. Adding all=3 solves the problem indeed. Funny
that all is not set to a more sensible value when one is set.


From janko.thyson at ku-eichstaett.de  Thu Nov 18 11:12:33 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 18 Nov 2010 11:12:33 +0100
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
In-Reply-To: <alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>
	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
Message-ID: <000601cb8709$1e0c0230$5a240690$@thyson@ku-eichstaett.de>

> -----Urspr?ngliche Nachricht-----
> Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Gesendet: Mittwoch, 17. November 2010 18:42
> An: Janko Thyson
> Cc: 'r-devel at r-project. org'
> Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> 
> Is this on Windows?  (Please do consult the posting guide and tell us
> the 'at a minimum' information we asked for.)
> 
> If so, it seems you forget the bit about setting TMPDIR right at the
> top of the section on 'Building the core files':
> 
>    Set the environment variable @env{TMPDIR} to point to a writable
>    directory, with a path specified with forward slashes and no spaces.
>    (The default is @file{/tmp}, which may not be useful on Windows.)
> 

Sorry, I always forget to provide that info.

Could you tell me where/how I have to set TMPDIR? I've looked in
MkRules.local but didn't find anything. Or is that an argument at 'make all
recommended'?

Thanks,
Janko

SYSTEM INFO:
- Windows XP SP 3
- R-2.12.0
- Eclipse 3.6.1
- StatET 0.9.x
 
> On Wed, 17 Nov 2010, Janko Thyson wrote:
> 
> > Dear list,
> >
> >
> >
> > I've just tried to compile R 2.12.0 from source as I think I found an
> error
> > in a C function that I would like to fix and check before I go ahead
> with
> > posting the presumed error.
> >
> >
> >
> > I've got the R Toolset 2.12 installed and configured correctly and
> followed
> > the Admin manual closely (including the entire bitmap stuff; exact
> same
> > versions as in the manual). Also, all anti virus software is turned
> off (as
> > it complained on some .exe). I have Admin rights on my box.
> >
> >
> >
> > When I run 'make all recommended' I get the following error after a
> while:
> >
> >
> >
> > cannot create /tmp/R5436: directory nonexistent
> >
> > mv: cannot stat `/tmp/R5436': No such file or directory
> >
> > make[3]: *** [mkR] Error 1
> >
> > make[2]: *** [all] Error 2
> >
> > make[1]: *** [R] Error 1
> >
> > make: *** [all] Error 2
> >
> >
> >
> > Any ideas what this is about? Seems that the compiler can't create a
> temp
> > directory because of a missing directory.
> >
> >
> >
> > Thanks for any hints,
> >
> > Janko
> >
> >
> > 	[[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From janko.thyson at ku-eichstaett.de  Thu Nov 18 11:40:37 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 18 Nov 2010 11:40:37 +0100
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>
	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk> 
Message-ID: <001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>

I've created a /tmp directory so I wouldn't have to change TMPDIR. So far,
so good. But now I get the error below. Anything I forgot regarding tcltk?

Thx, 
Janko

ERROR:
In file included from init.c:22:0:
tcltk.h:23:17: fatal error: tcl.h: No such file or directory
compilation terminated.
make[4]: *** [init.o] Error 1
make[3]: *** [mksrc-win] Error 1
make[2]: *** [all] Error 2
make[1]: *** [R] Error 1
make: *** [all] Error 2

SYSTEM INFO:
 - Windows XP SP 3
 - R-2.12.0
 - Eclipse 3.6.1
 - StatET 0.9.x

> -----Urspr?ngliche Nachricht-----
> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> Gesendet: Donnerstag, 18. November 2010 11:13
> An: 'Prof Brian Ripley'
> Cc: 'r-devel at r-project. org'
> Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> 
> > -----Urspr?ngliche Nachricht-----
> > Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> > Gesendet: Mittwoch, 17. November 2010 18:42
> > An: Janko Thyson
> > Cc: 'r-devel at r-project. org'
> > Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >
> > Is this on Windows?  (Please do consult the posting guide and tell us
> > the 'at a minimum' information we asked for.)
> >
> > If so, it seems you forget the bit about setting TMPDIR right at the
> > top of the section on 'Building the core files':
> >
> >    Set the environment variable @env{TMPDIR} to point to a writable
> >    directory, with a path specified with forward slashes and no
> spaces.
> >    (The default is @file{/tmp}, which may not be useful on Windows.)
> >
> 
> Sorry, I always forget to provide that info.
> 
> Could you tell me where/how I have to set TMPDIR? I've looked in
> MkRules.local but didn't find anything. Or is that an argument at 'make
> all recommended'?
> 
> Thanks,
> Janko
> 
> SYSTEM INFO:
> - Windows XP SP 3
> - R-2.12.0
> - Eclipse 3.6.1
> - StatET 0.9.x
> 
> > On Wed, 17 Nov 2010, Janko Thyson wrote:
> >
> > > Dear list,
> > >
> > >
> > >
> > > I've just tried to compile R 2.12.0 from source as I think I found
> an
> > error
> > > in a C function that I would like to fix and check before I go
> ahead
> > with
> > > posting the presumed error.
> > >
> > >
> > >
> > > I've got the R Toolset 2.12 installed and configured correctly and
> > followed
> > > the Admin manual closely (including the entire bitmap stuff; exact
> > same
> > > versions as in the manual). Also, all anti virus software is turned
> > off (as
> > > it complained on some .exe). I have Admin rights on my box.
> > >
> > >
> > >
> > > When I run 'make all recommended' I get the following error after a
> > while:
> > >
> > >
> > >
> > > cannot create /tmp/R5436: directory nonexistent
> > >
> > > mv: cannot stat `/tmp/R5436': No such file or directory
> > >
> > > make[3]: *** [mkR] Error 1
> > >
> > > make[2]: *** [all] Error 2
> > >
> > > make[1]: *** [R] Error 1
> > >
> > > make: *** [all] Error 2
> > >
> > >
> > >
> > > Any ideas what this is about? Seems that the compiler can't create
> a
> > temp
> > > directory because of a missing directory.
> > >
> > >
> > >
> > > Thanks for any hints,
> > >
> > > Janko
> > >
> > >
> > > 	[[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-devel at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-devel
> > >
> >
> > --
> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272866 (PA)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Thu Nov 18 12:54:00 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 18 Nov 2010 06:54:00 -0500
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
In-Reply-To: <001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
	<001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
Message-ID: <4CE513D8.1070600@gmail.com>

On 18/11/2010 5:40 AM, Janko Thyson wrote:
> I've created a /tmp directory so I wouldn't have to change TMPDIR. So far,
> so good. But now I get the error below. Anything I forgot regarding tcltk?

Looks as if you forgot to install it.

Duncan Murdoch

>
> Thx,
> Janko
>
> ERROR:
> In file included from init.c:22:0:
> tcltk.h:23:17: fatal error: tcl.h: No such file or directory
> compilation terminated.
> make[4]: *** [init.o] Error 1
> make[3]: *** [mksrc-win] Error 1
> make[2]: *** [all] Error 2
> make[1]: *** [R] Error 1
> make: *** [all] Error 2
>
> SYSTEM INFO:
>   - Windows XP SP 3
>   - R-2.12.0
>   - Eclipse 3.6.1
>   - StatET 0.9.x
>
>> -----Urspr?ngliche Nachricht-----
>> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
>> Gesendet: Donnerstag, 18. November 2010 11:13
>> An: 'Prof Brian Ripley'
>> Cc: 'r-devel at r-project. org'
>> Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
>>
>>> -----Urspr?ngliche Nachricht-----
>>> Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
>>> Gesendet: Mittwoch, 17. November 2010 18:42
>>> An: Janko Thyson
>>> Cc: 'r-devel at r-project. org'
>>> Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
>>>
>>> Is this on Windows?  (Please do consult the posting guide and tell us
>>> the 'at a minimum' information we asked for.)
>>>
>>> If so, it seems you forget the bit about setting TMPDIR right at the
>>> top of the section on 'Building the core files':
>>>
>>>     Set the environment variable @env{TMPDIR} to point to a writable
>>>     directory, with a path specified with forward slashes and no
>> spaces.
>>>     (The default is @file{/tmp}, which may not be useful on Windows.)
>>>
>>
>> Sorry, I always forget to provide that info.
>>
>> Could you tell me where/how I have to set TMPDIR? I've looked in
>> MkRules.local but didn't find anything. Or is that an argument at 'make
>> all recommended'?
>>
>> Thanks,
>> Janko
>>
>> SYSTEM INFO:
>> - Windows XP SP 3
>> - R-2.12.0
>> - Eclipse 3.6.1
>> - StatET 0.9.x
>>
>>> On Wed, 17 Nov 2010, Janko Thyson wrote:
>>>
>>>> Dear list,
>>>>
>>>>
>>>>
>>>> I've just tried to compile R 2.12.0 from source as I think I found
>> an
>>> error
>>>> in a C function that I would like to fix and check before I go
>> ahead
>>> with
>>>> posting the presumed error.
>>>>
>>>>
>>>>
>>>> I've got the R Toolset 2.12 installed and configured correctly and
>>> followed
>>>> the Admin manual closely (including the entire bitmap stuff; exact
>>> same
>>>> versions as in the manual). Also, all anti virus software is turned
>>> off (as
>>>> it complained on some .exe). I have Admin rights on my box.
>>>>
>>>>
>>>>
>>>> When I run 'make all recommended' I get the following error after a
>>> while:
>>>>
>>>>
>>>>
>>>> cannot create /tmp/R5436: directory nonexistent
>>>>
>>>> mv: cannot stat `/tmp/R5436': No such file or directory
>>>>
>>>> make[3]: *** [mkR] Error 1
>>>>
>>>> make[2]: *** [all] Error 2
>>>>
>>>> make[1]: *** [R] Error 1
>>>>
>>>> make: *** [all] Error 2
>>>>
>>>>
>>>>
>>>> Any ideas what this is about? Seems that the compiler can't create
>> a
>>> temp
>>>> directory because of a missing directory.
>>>>
>>>>
>>>>
>>>> Thanks for any hints,
>>>>
>>>> Janko
>>>>
>>>>
>>>> 	[[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Thu Nov 18 15:10:48 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 18 Nov 2010 15:10:48 +0100
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
In-Reply-To: <001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
	<001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
Message-ID: <4CE533E8.3020508@statistik.tu-dortmund.de>

TMPDIR is an wenvironment variable to be set in your OS, for example.

Uwe Ligges


On 18.11.2010 11:40, Janko Thyson wrote:
> I've created a /tmp directory so I wouldn't have to change TMPDIR. So far,
> so good. But now I get the error below. Anything I forgot regarding tcltk?
>
> Thx,
> Janko
>
> ERROR:
> In file included from init.c:22:0:
> tcltk.h:23:17: fatal error: tcl.h: No such file or directory
> compilation terminated.
> make[4]: *** [init.o] Error 1
> make[3]: *** [mksrc-win] Error 1
> make[2]: *** [all] Error 2
> make[1]: *** [R] Error 1
> make: *** [all] Error 2
>
> SYSTEM INFO:
>   - Windows XP SP 3
>   - R-2.12.0
>   - Eclipse 3.6.1
>   - StatET 0.9.x
>
>> -----Urspr?ngliche Nachricht-----
>> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
>> Gesendet: Donnerstag, 18. November 2010 11:13
>> An: 'Prof Brian Ripley'
>> Cc: 'r-devel at r-project. org'
>> Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
>>
>>> -----Urspr?ngliche Nachricht-----
>>> Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
>>> Gesendet: Mittwoch, 17. November 2010 18:42
>>> An: Janko Thyson
>>> Cc: 'r-devel at r-project. org'
>>> Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
>>>
>>> Is this on Windows?  (Please do consult the posting guide and tell us
>>> the 'at a minimum' information we asked for.)
>>>
>>> If so, it seems you forget the bit about setting TMPDIR right at the
>>> top of the section on 'Building the core files':
>>>
>>>     Set the environment variable @env{TMPDIR} to point to a writable
>>>     directory, with a path specified with forward slashes and no
>> spaces.
>>>     (The default is @file{/tmp}, which may not be useful on Windows.)
>>>
>>
>> Sorry, I always forget to provide that info.
>>
>> Could you tell me where/how I have to set TMPDIR? I've looked in
>> MkRules.local but didn't find anything. Or is that an argument at 'make
>> all recommended'?
>>
>> Thanks,
>> Janko
>>
>> SYSTEM INFO:
>> - Windows XP SP 3
>> - R-2.12.0
>> - Eclipse 3.6.1
>> - StatET 0.9.x
>>
>>> On Wed, 17 Nov 2010, Janko Thyson wrote:
>>>
>>>> Dear list,
>>>>
>>>>
>>>>
>>>> I've just tried to compile R 2.12.0 from source as I think I found
>> an
>>> error
>>>> in a C function that I would like to fix and check before I go
>> ahead
>>> with
>>>> posting the presumed error.
>>>>
>>>>
>>>>
>>>> I've got the R Toolset 2.12 installed and configured correctly and
>>> followed
>>>> the Admin manual closely (including the entire bitmap stuff; exact
>>> same
>>>> versions as in the manual). Also, all anti virus software is turned
>>> off (as
>>>> it complained on some .exe). I have Admin rights on my box.
>>>>
>>>>
>>>>
>>>> When I run 'make all recommended' I get the following error after a
>>> while:
>>>>
>>>>
>>>>
>>>> cannot create /tmp/R5436: directory nonexistent
>>>>
>>>> mv: cannot stat `/tmp/R5436': No such file or directory
>>>>
>>>> make[3]: *** [mkR] Error 1
>>>>
>>>> make[2]: *** [all] Error 2
>>>>
>>>> make[1]: *** [R] Error 1
>>>>
>>>> make: *** [all] Error 2
>>>>
>>>>
>>>>
>>>> Any ideas what this is about? Seems that the compiler can't create
>> a
>>> temp
>>>> directory because of a missing directory.
>>>>
>>>>
>>>>
>>>> Thanks for any hints,
>>>>
>>>> Janko
>>>>
>>>>
>>>> 	[[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From janko.thyson at ku-eichstaett.de  Thu Nov 18 16:38:26 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 18 Nov 2010 16:38:26 +0100
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
In-Reply-To: <4CE513D8.1070600@gmail.com>
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
	<001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
	<4CE513D8.1070600@gmail.com>
Message-ID: <001f01cb8736$a458d520$ed0a7f60$@thyson@ku-eichstaett.de>

Sorry, but I'm still kind of puzzled on this one ;-)

Found the Tcl/Tk section in the manual but I don't really understand where I
have to set those options. Append it to 'make all recommended'? I checked
'make --help' which didn't list any such options. Or does that refer to the
installation of Tcl/Tk itself? I downloaded and installed the binary version
of Tcl/Tk (ActiveTcl
http://downloads.activestate.com/ActiveTcl/releases/8.5.9.0/ActiveTcl8.5.9.0
.293667-win32-ix86-threaded.exe) and as far as I understand, I now need to
link that to the tcltk package of R, right? I don't know how I would install
Tcl/Tk from its sources, but if that's the better choice: could anyone drop
me the command line(s) I need to execute in order to install and link Tcl/Tk
to my R (pre-)build?

Thanks a lot, 
Janko

SECTION FROM THE MANUAL (P. 32):
A.2.1 Tcl/Tk
The tcltk package needs Tcl/Tk >= 8.4 installed: the sources are available
at http://
www.tcl.tk/. To specify the locations of the Tcl/Tk files you may need the
configuration
options
  ?--with-tcltk?
    use Tcl/Tk, or specify its library directory
  ?--with-tcl-config=TCL_CONFIG?
    specify location of ?tclConfig.sh?
    ?--with-tk-config=TK_CONFIG?
  specify location of ?tkConfig.sh?
or use the configure variables TCLTK_LIBS and TCLTK_CPPFLAGS to specify the
flags needed
for linking against the Tcl and Tk libraries and for finding the ?tcl.h? and
?tk.h? headers,
respectively. If you have both 32- and 64-bit versions of Tcl/Tk installed,
specifying the paths
to the correct config files may be necessary to avoid confusion between
them.

SYSTEM INFO:
 - Windows XP SP 3
 - R-2.12.0
 - Eclipse 3.6.1
 - StatET 0.9.x

> -----Urspr?ngliche Nachricht-----
> Von: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
> Gesendet: Donnerstag, 18. November 2010 12:54
> An: Janko Thyson
> Cc: 'r-devel at r-project. org'
> Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> 
> On 18/11/2010 5:40 AM, Janko Thyson wrote:
> > I've created a /tmp directory so I wouldn't have to change TMPDIR. So
> far,
> > so good. But now I get the error below. Anything I forgot regarding
> tcltk?
> 
> Looks as if you forgot to install it.
> 
> Duncan Murdoch
> 
> >
> > Thx,
> > Janko
> >
> > ERROR:
> > In file included from init.c:22:0:
> > tcltk.h:23:17: fatal error: tcl.h: No such file or directory
> > compilation terminated.
> > make[4]: *** [init.o] Error 1
> > make[3]: *** [mksrc-win] Error 1
> > make[2]: *** [all] Error 2
> > make[1]: *** [R] Error 1
> > make: *** [all] Error 2
> >
> > SYSTEM INFO:
> >   - Windows XP SP 3
> >   - R-2.12.0
> >   - Eclipse 3.6.1
> >   - StatET 0.9.x
> >
> >> -----Urspr?ngliche Nachricht-----
> >> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> >> Gesendet: Donnerstag, 18. November 2010 11:13
> >> An: 'Prof Brian Ripley'
> >> Cc: 'r-devel at r-project. org'
> >> Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >>
> >>> -----Urspr?ngliche Nachricht-----
> >>> Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> >>> Gesendet: Mittwoch, 17. November 2010 18:42
> >>> An: Janko Thyson
> >>> Cc: 'r-devel at r-project. org'
> >>> Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >>>
> >>> Is this on Windows?  (Please do consult the posting guide and tell
> us
> >>> the 'at a minimum' information we asked for.)
> >>>
> >>> If so, it seems you forget the bit about setting TMPDIR right at
> the
> >>> top of the section on 'Building the core files':
> >>>
> >>>     Set the environment variable @env{TMPDIR} to point to a
> writable
> >>>     directory, with a path specified with forward slashes and no
> >> spaces.
> >>>     (The default is @file{/tmp}, which may not be useful on
> Windows.)
> >>>
> >>
> >> Sorry, I always forget to provide that info.
> >>
> >> Could you tell me where/how I have to set TMPDIR? I've looked in
> >> MkRules.local but didn't find anything. Or is that an argument at
> 'make
> >> all recommended'?
> >>
> >> Thanks,
> >> Janko
> >>
> >> SYSTEM INFO:
> >> - Windows XP SP 3
> >> - R-2.12.0
> >> - Eclipse 3.6.1
> >> - StatET 0.9.x
> >>
> >>> On Wed, 17 Nov 2010, Janko Thyson wrote:
> >>>
> >>>> Dear list,
> >>>>
> >>>>
> >>>>
> >>>> I've just tried to compile R 2.12.0 from source as I think I found
> >> an
> >>> error
> >>>> in a C function that I would like to fix and check before I go
> >> ahead
> >>> with
> >>>> posting the presumed error.
> >>>>
> >>>>
> >>>>
> >>>> I've got the R Toolset 2.12 installed and configured correctly and
> >>> followed
> >>>> the Admin manual closely (including the entire bitmap stuff; exact
> >>> same
> >>>> versions as in the manual). Also, all anti virus software is
> turned
> >>> off (as
> >>>> it complained on some .exe). I have Admin rights on my box.
> >>>>
> >>>>
> >>>>
> >>>> When I run 'make all recommended' I get the following error after
> a
> >>> while:
> >>>>
> >>>>
> >>>>
> >>>> cannot create /tmp/R5436: directory nonexistent
> >>>>
> >>>> mv: cannot stat `/tmp/R5436': No such file or directory
> >>>>
> >>>> make[3]: *** [mkR] Error 1
> >>>>
> >>>> make[2]: *** [all] Error 2
> >>>>
> >>>> make[1]: *** [R] Error 1
> >>>>
> >>>> make: *** [all] Error 2
> >>>>
> >>>>
> >>>>
> >>>> Any ideas what this is about? Seems that the compiler can't create
> >> a
> >>> temp
> >>>> directory because of a missing directory.
> >>>>
> >>>>
> >>>>
> >>>> Thanks for any hints,
> >>>>
> >>>> Janko
> >>>>
> >>>>
> >>>> 	[[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>>
> >>>
> >>> --
> >>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> >>> Professor of Applied Statistics,
> http://www.stats.ox.ac.uk/~ripley/
> >>> University of Oxford,             Tel:  +44 1865 272861 (self)
> >>> 1 South Parks Road,                     +44 1865 272866 (PA)
> >>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel


From ddickison at carnegielearning.com  Thu Nov 18 16:56:57 2010
From: ddickison at carnegielearning.com (Dickison, Daniel)
Date: Thu, 18 Nov 2010 10:56:57 -0500
Subject: [Rd] Bug in agrep computing edit distance?
In-Reply-To: <C909CBCE.2B6D%ddickison@carnegielearning.com>
Message-ID: <C90AB313.2CE2%ddickison@carnegielearning.com>

A followup to this.  I got R to compile, and the following patch seems to
fix this issue (I don't think my previous attachment worked so it's pasted
inline).

There is still a quirk, where tail insertions seem to cost 1 extra and I'm
not sure why.  In the first example below, 3 and 5 should match, and in
the second, 5 should match, but they don't unless max.distance=3:

> agrep("x", c("x", "y", "ax1", "abx", "x12", "ax12", "abx1"),
>max.distance=2)
[1] 1 2 4
> agrep("ax1", c("x", "y", "ax1", "abx", "x12", "ax12", "abx1"),
>max.distance=2)
[1] 1 3 4 6 7


In any case, I think this is more in line with the documentation.  I'm
very new to hacking on R so please let me know if this isn't the right way
to submit patches...

Daniel


Index: src/library/base/R/grep.R
===================================================================
--- src/library/base/R/grep.R (revision 53625)
+++ src/library/base/R/grep.R (working copy)
@@ -93,6 +93,11 @@

     n <- nchar(pattern, "c")
     if(is.na(n)) stop("invalid multibyte string for 'pattern'")
+
+    ## make pattern match the whole string
+    pattern <- gsub("\\", "\\\\", pattern, fixed=TRUE)
+    pattern <- paste("^", pattern, "$", sep="")
+
     if(!is.list(max.distance)) {
         if(!is.numeric(max.distance) || (max.distance < 0))
             stop("'max.distance' must be non-negative")
Index: src/main/agrep.c
===================================================================
--- src/main/agrep.c (revision 53625)
+++ src/main/agrep.c (working copy)
@@ -42,7 +42,7 @@
     regex_t reg;
     regaparams_t params;
     regamatch_t match;
-    int rc, cflags = REG_NOSUB | REG_LITERAL;
+    int rc, cflags = REG_NOSUB;

     checkArity(op, args);
     pat = CAR(args); args = CDR(args);



Daniel  Dickison
Research Programmer
ddickison at carnegielearning.com
Toll Free: (888) 851-7094 x103
FAX: (412) 690-2444

Revolutionary Math Curricula. Revolutionary Results.

Carnegie Learning, Inc. | 437 Grant St. 20th Floor | Pittsburgh, PA 15219
www.carnegielearning.com


From amredd at gmail.com  Thu Nov 18 17:12:08 2010
From: amredd at gmail.com (Andrew Redd)
Date: Thu, 18 Nov 2010 09:12:08 -0700
Subject: [Rd] unloading compiled code.
In-Reply-To: <Pine.LNX.4.64.1011161734160.2833@tajo.ucsd.edu>
References: <AANLkTimR+c8r=gBPKb9-EFcUr-wCVeS6+EJSNXBH3zHz@mail.gmail.com>
	<alpine.LFD.2.00.1011122223410.32247@gannet.stats.ox.ac.uk>
	<AANLkTinDzRiHugMKOu+rje4PAXWReEJpQY8=6ZfUAJyL@mail.gmail.com>
	<AANLkTinYF2h3u9UCXV=OncSz6A1Oh_NDrF1hpOw-FTYJ@mail.gmail.com>
	<AANLkTi=XNYb62SOScF-=rGBPFwWOCg670zDRLSEF4tw1@mail.gmail.com>
	<Pine.LNX.4.64.1011161024180.1348@tajo.ucsd.edu>
	<AANLkTi=PwRunS9G5buTdKUAp=M1VY7tbzu-KG-ATSGQ+@mail.gmail.com>
	<Pine.LNX.4.64.1011161734160.2833@tajo.ucsd.edu>
Message-ID: <AANLkTikMZ6nwnA85UKkibO+dUudehVQL=12s97-7Zh7N@mail.gmail.com>

I thought I would update with what I did.  Not liking overwriting the
.Last function in case another package I decided to see if the
reg.finalizer would work.  This is what my .onLoad function look like.
---
.onLoad<-function(libname, pkgname){
	e<-emptyenv()
	library.dynam('gpuBayes',package=pkgname)
	reg.finalizer(e,function(...){unloadNamespace(pkgname)},T)
}
.onUnload<-function(libpath){
	library.dynam.unload('gpuBayes',libpath)
}
---
 This takes attaches a reg.finalizer to the empty environment with
onexit=T.  Since the empty environment will never be collected this
will only run on exit.

-Andrew

On Tue, Nov 16, 2010 at 6:34 PM, Charles C. Berry <cberry at tajo.ucsd.edu> wrote:
> On Tue, 16 Nov 2010, Andrew Redd wrote:
>
>> so should I use reg.finalizer or overwrite .Last()?
>
>> .Last
>
> Error: object '.Last' not found
>>
>
> You create your own .Last - there is nothing to overwrite.
>
> Chuck
>
>
> ?If I use
>>
>> reg.finalizer, what should be the environment that I specify? ?The
>> straight forward solution would be to have a hook .onExit that a
>> package could specify to make sure ?that the code was unloaded before
>> the program terminates, that way I don't overwrite .Last if if has
>> another purpose.
>>
>> -Andrew
>>
>> On Tue, Nov 16, 2010 at 11:27 AM, Charles C. Berry <cberry at tajo.ucsd.edu>
>> wrote:
>>>
>>> On Tue, 16 Nov 2010, Andrew Redd wrote:
>>>
>>>> Just found in the documentation for getHook that packages are not
>>>> unloaded on quit. ?How should I force a package to unload on quit?
>>>
>>> See
>>>
>>> ? ? ? ??q
>>>
>>>
>>> HTH,
>>>
>>> Chuck
>>>
>>>>
>>>> -Andrew
>>>>
>>>> On Tue, Nov 16, 2010 at 10:25 AM, Andrew Redd <amredd at gmail.com> wrote:
>>>>>
>>>>> Are packages unloaded on quit so that the .Last.lib or .onUnload are
>>>>> called for packages?
>>>>>
>>>>> -Andrew
>>>>>
>>>>> On Fri, Nov 12, 2010 at 3:52 PM, Andrew Redd <amredd at gmail.com> wrote:
>>>>>>
>>>>>> Perhaps you could help me make some sense of this. ?Here is a printout
>>>>>> of my sessions.
>>>>>> ---
>>>>>> toys$R -q
>>>>>>>
>>>>>>> library(test2)
>>>>>>> gpualloctest()
>>>>>>
>>>>>> testing allocation on gpu
>>>>>> C Finished
>>>>>> Collecting Garbage
>>>>>> done.
>>>>>>>
>>>>>>> q()
>>>>>>
>>>>>> Save workspace image? [y/n/c]: n
>>>>>>
>>>>>> ?*** caught segfault ***
>>>>>> address 0x7f12ec1add50, cause 'memory not mapped'
>>>>>>
>>>>>> Possible actions:
>>>>>> 1: abort (with core dump, if enabled)
>>>>>> 2: normal R exit
>>>>>> 3: exit R without saving workspace
>>>>>> 4: exit R saving workspace
>>>>>> Selection: 1
>>>>>> aborting ...
>>>>>> Segmentation fault
>>>>>> toys$R -q
>>>>>>>
>>>>>>> library(test2)
>>>>>>> gpualloctest()
>>>>>>
>>>>>> testing allocation on gpu
>>>>>> C Finished
>>>>>> Collecting Garbage
>>>>>> done.
>>>>>>>
>>>>>>> library.dynam.unload('test2',system.file(package='test2'))
>>>>>>> q()
>>>>>>
>>>>>> Save workspace image? [y/n/c]: n
>>>>>> toys$
>>>>>> ---
>>>>>>
>>>>>> I have a in the test2/R/zzz.R file
>>>>>> ---
>>>>>> .onUnload <- function(libpath)
>>>>>> ? ?library.dynam.unload("test2", libpath)
>>>>>> ---
>>>>>>
>>>>>> so the code should be unloaded. ?But it appears that it is not from
>>>>>> errors when I explicitly unload the test2.so it does not through a
>>>>>> segfault. ?Why would this be happening? ?and how do I circumvent it.
>>>>>>
>>>>>> thanks,
>>>>>> Andrew
>>>>>>
>>>>>>
>>>>>> On Fri, Nov 12, 2010 at 3:32 PM, Prof Brian Ripley
>>>>>> <ripley at stats.ox.ac.uk> wrote:
>>>>>>>
>>>>>>> On Fri, 12 Nov 2010, Andrew Redd wrote:
>>>>>>>
>>>>>>>> I have a package that I'm developing that I need to unload the
>>>>>>>> library. ?Long story short I figured out that the leaving the
>>>>>>>> compiled
>>>>>>>> code loaded lead to a segmentation fault, but unloading the code
>>>>>>>> will
>>>>>>>> fix it. ?I've read the documentation and it appears that there are
>>>>>>>> several ways to do this? ?What is the popper accepted current
>>>>>>>> standard
>>>>>>>> for unloading compiled code?
>>>>>>>
>>>>>>> Depends how you loaded it: you basically reverse the process.
>>>>>>>
>>>>>>>> The options as I understand them are:
>>>>>>>> 1. dyn.unload
>>>>>>>> 2. library.dynam.unload
>>>>>>>> used with either
>>>>>>>> A. .Last.lib
>>>>>>>> B. .onUnload
>>>>>>>>
>>>>>>>> If it makes a difference my package does use a NAMESPACE so the
>>>>>>>> package is loaded through useDynLib.
>>>>>>>
>>>>>>> So you need an .onUnload action calling library.dynam.unload.
>>>>>>>
>>>>>>> Slightly longer version: you need the DLL loaded whilst the namepace
>>>>>>> is
>>>>>>> in
>>>>>>> use, so it has to be in .onUnload, and useDynLib calls library.dynam
>>>>>>> so
>>>>>>> you
>>>>>>> need library.dynam.unload to do the housekeeping around dyn.unload
>>>>>>> which
>>>>>>> matches what library.dynam does around dyn.load.
>>>>>>>
>>>>>>> There are quite a lot of examples to look at, including in R itself.
>>>>>>> MASS is
>>>>>>> one example I've just checked.
>>>>>>>
>>>>>>> Having said all that, my experience is that unloading the DLL often
>>>>>>> does not
>>>>>>> help if you need to load it again (and that is why e.g. tcltk does
>>>>>>> not
>>>>>>> unload its DLL).
>>>>>>>
>>>>>>>> Thanks,
>>>>>>>> Andrew Redd
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>>>>>>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>>>>>>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>>>>>>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>>>>>>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>>>>>>>
>>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> Charles C. Berry ? ? ? ? ? ? ? ? ? ? ? ? ? ?Dept of Family/Preventive
>>> Medicine
>>> cberry at tajo.ucsd.edu ? ? ? ? ? ? ? ? ? ? ? ?UC San Diego
>>> http://famprevmed.ucsd.edu/faculty/cberry/ ?La Jolla, San Diego
>>> 92093-0901
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> Charles C. Berry ? ? ? ? ? ? ? ? ? ? ? ? ? ?Dept of Family/Preventive
> Medicine
> cberry at tajo.ucsd.edu ? ? ? ? ? ? ? ? ? ? ? ?UC San Diego
> http://famprevmed.ucsd.edu/faculty/cberry/ ?La Jolla, San Diego 92093-0901
>
>


From brad at stat.umn.edu  Thu Nov 18 17:59:45 2010
From: brad at stat.umn.edu (Brad Price)
Date: Thu, 18 Nov 2010 10:59:45 -0600
Subject: [Rd] .pkg won't fully install on my MacBook
Message-ID: <4CE55B81.8070905@stat.umn.edu>


I'm having problems downloading any .pkg file on my MacBook.  All the 
.dmg files up to 2.10.1 will download and install fine but nothing newer 
than that.  I'm attaching the the log file from my installer as and here 
are some other things about my system.  At the end of the log the 
installer continues to run not doing anything and comes up with progress 
messages.  I've let it run for over and hour and nothing of substance 
has come.  Any help would be greatly appreciated.

I'm running on Mac OS X version 10.5.8 with all apple updates in. 
My processor is 2.2 GHz Intel Core 2 Duo
Memory: 2 GB 667 MHz DDR2 SDRAM
Startup Disk is a Macintosh HD.

The computer is almost 3 years old.  It just had a new hard drive 
installed as well. 

Thanks in advance,

Brad Price


The installer log looks like:

Nov 17 21:32:39 brad-prices-macbook 
/System/Library/CoreServices/Installer.app/Contents/MacOS/Installer[1503]: 
vm_allocate: 0, 0x5800000 - 0x25800000
Nov 17 21:32:39 brad-prices-macbook 
/System/Library/CoreServices/Installer.app/Contents/MacOS/Installer[1503]: 
vm_protect: 0
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: 
@(#)PROGRAM:Install  PROJECT:Install-388
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: 
@(#)PROGRAM:Installer  PROJECT:Installer-281
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Hardware: 
MacBook3,1 @ 2.20 GHz (x 2), 2048 MB RAM
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Running OS Build: 
Mac OS X 10.5.8 (9L30)
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
PATH=/usr/bin:/bin:/usr/sbin:/sbin
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
TMPDIR=/var/folders/T5/T5IG5mukHM8ZSl0ATVbl9++++TI/-Tmp-/
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: SHELL=/bin/bash
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
HOME=/Users/bprice5
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: USER=bprice5
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: LOGNAME=bprice5
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
DISPLAY=/tmp/launch-erVkth/:0
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
SSH_AUTH_SOCK=/tmp/launch-chvFEZ/Listeners
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
Apple_PubSub_Socket_Render=/tmp/launch-8um0R6/Render
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: __LAUNCHD_FD=32
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
__CF_USER_TEXT_ENCODING=0x1F5:0:0
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
COMMAND_MODE=unix2003
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
CrashReporterRelaunched=1
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Env: 
RelaunchedApplicationBundleID=com.apple.Safari
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: R 2.12.0 for Mac OS 
X 10.5 or higher (Leopard build) Installation Log
Nov 17 21:32:39 brad-prices-macbook Installer[1503]: Opened from: 
/Users/bprice5/Downloads/R-2.12.0.pkg
Nov 17 21:32:40 brad-prices-macbook installdb[1505]: started (uid 96)
Nov 17 21:32:40 brad-prices-macbook installdb[1505]: Opened receipt 
database on '/' with schema 17.
Nov 17 21:32:47 brad-prices-macbook installdb[1505]: done. (0.006u + 0.004s)
Nov 17 21:33:51 brad-prices-macbook runner[1521]: Administrator 
authorization granted.
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: 
================================================================================
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: User picked 
Standard Install
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: Choices selected 
for installation:
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:     Upgrade: "R 
2.12.0 for Mac OS X 10.5 or higher (Leopard build)"
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:     Upgrade: "R 
2.12.0 Framework"
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:         
R-2.12.0.pkg#r.pkg : org.r-project.R.Leopard.fw.pkg : 201253317
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:     Install: "R GUI 
1.35 (32-bit)"
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:         
R-2.12.0.pkg#r-1.pkg : org.r-project.R.Leopard.GUI.pkg : 1.35
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:     Install: "R GUI 
1.35 (64-bit)"
Nov 17 21:33:51 brad-prices-macbook Installer[1503]:         
R-2.12.0.pkg#r64.pkg : org.r-project.R.Leopard.GUI64.pkg : 1.35
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: 
================================================================================
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: It took 0.00 
seconds to summarize the package selections.
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: 
-[IFDInstallController(Private) _buildInstallPlan]: location = 
file://localhost
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: 
-[IFDInstallController(Private) _buildInstallPlan]: 
file://localhost/Users/bprice5/Downloads/R-2.12.0.pkg#r.pkg
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: 
-[IFDInstallController(Private) _buildInstallPlan]: 
file://localhost/Users/bprice5/Downloads/R-2.12.0.pkg#r-1.pkg
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: 
-[IFDInstallController(Private) _buildInstallPlan]: 
file://localhost/Users/bprice5/Downloads/R-2.12.0.pkg#r64.pkg
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: _installNextPackage 
of 1
Nov 17 21:33:51 brad-prices-macbook installdb[1524]: started (uid 96)
Nov 17 21:33:51 brad-prices-macbook installdb[1524]: Opened receipt 
database on '/' with schema 17.
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: Starting installation:
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: Preparing volume 
"Macintosh HD" for installation
Nov 17 21:33:51 brad-prices-macbook Installer[1503]: Configuring volume 
"Macintosh HD"
Nov 17 21:33:52 brad-prices-macbook Installer[1503]: Preparing disk for 
local booted install.
Nov 17 21:33:52 brad-prices-macbook Installer[1503]: Free space on 
"Macintosh HD": 97.5 GB (104646410240 bytes).
Nov 17 21:33:52 brad-prices-macbook Installer[1503]: Create temporary 
directory "/private/tmp/R-2.12.0.pkg.1503BLUwP9"
Nov 17 21:33:52 brad-prices-macbook Installer[1503]: Running install actions
Nov 17 21:33:52 brad-prices-macbook Installer[1503]: Processing r:
Nov 17 21:33:52 brad-prices-macbook Installer[1503]:     Determining 
files to install
Nov 17 21:33:53 brad-prices-macbook Installer[1503]:     It took 0.55 
seconds to create the install plan for r.
Nov 17 21:33:53 brad-prices-macbook Installer[1503]:     Configuring 
deferred files
Nov 17 21:33:53 brad-prices-macbook Installer[1503]:     Determining 
obsolete files
Nov 17 21:33:54 brad-prices-macbook Installer[1503]:     Assembling 
temporary receipt
Nov 17 21:33:54 brad-prices-macbook Installer[1503]:     Performing 
pre-extraction actions
Nov 17 21:33:54 brad-prices-macbook Installer[1503]:     Removing 
obsoleted files
Nov 17 21:33:54 brad-prices-macbook Installer[1503]:     Creating 
destination path
Nov 17 21:33:54 brad-prices-macbook Installer[1503]:     Validating 
package payload
Nov 17 21:33:54 brad-prices-macbook Installer[1503]:     Starting file 
extraction
Nov 17 21:33:55 brad-prices-macbook payloadExtractor[1525]:     
Initializing new flat-package receipt.
Nov 17 21:33:55 brad-prices-macbook payloadExtractor[1525]:     
Extracting...
Nov 17 21:34:02 brad-prices-macbook payloadExtractor[1525]:     2291 of 
2291 files written in 7.93 seconds.
Nov 17 21:34:02 brad-prices-macbook payloadExtractor[1525]:     103488 
kilobytes installed at 12.7 MB/s.
Nov 17 21:34:03 brad-prices-macbook Installer[1503]:     run postupgrade 
script for r
Nov 17 21:34:08 brad-prices-macbook Installer[1503]:     Performing 
post-extraction actions
Nov 17 21:34:08 brad-prices-macbook Installer[1503]:     Finishing receipt
Nov 17 21:34:08 brad-prices-macbook runner[1521]: Extracting BOM from 
"/Users/bprice5/Downloads/R-2.12.0.pkg" to 
"/Library/Receipts/boms/org.r-project.R.Leopard.fw.pkg.bom"


From Greg.Snow at imail.org  Thu Nov 18 18:06:32 2010
From: Greg.Snow at imail.org (Greg Snow)
Date: Thu, 18 Nov 2010 10:06:32 -0700
Subject: [Rd] Plotting an agnes tree with images instead of labels?
In-Reply-To: <1289941393629-3045682.post@n4.nabble.com>
References: <1289941393629-3045682.post@n4.nabble.com>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC633EEFB5E8@LP-EXMBVS10.CO.IHC.COM>

You could use the my.symbols function in the TeachingDemos package to add the structures to the plot (once you create the plot without the default labels and find the positions to plot them at ).

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of darfunkel
> Sent: Tuesday, November 16, 2010 2:03 PM
> To: r-devel at r-project.org
> Subject: [Rd] Plotting an agnes tree with images instead of labels?
> 
> 
> Hi,
> 
> I'd like to plot a tree with images of molecular structures instead of
> labels (words). I think this is possible because someone who worked in
> my
> office before I arrived did this. However I'm not sure if this person
> made
> the image manually or plotted it only with R.
> 
> Thanks in advance for your help.
> --
> View this message in context: http://r.789695.n4.nabble.com/Plotting-
> an-agnes-tree-with-images-instead-of-labels-tp3045682p3045682.html
> Sent from the R devel mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From janko.thyson at ku-eichstaett.de  Thu Nov 18 18:40:21 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Thu, 18 Nov 2010 18:40:21 +0100
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
	<001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
	<4CE513D8.1070600@gmail.com> 
Message-ID: <000301cb8747$acab5b10$06021130$@thyson@ku-eichstaett.de>

Puh, here?s where I?m at right now:
-	I reinstalled Rtools (2.12) to C:\Rtools (full installation) left
the default for R Root dir = C:\R and R 64 root dir = C:\R64, 
-	I noticed that there?s a Tcl directory in C:\R now -> is that what I
need regarding my previous Tcl/Tk issue down the building process? Or do I
still need to install Tcl in any way?
-	I checked my Windows PATH if it exactly reflects the recommendations
in the admin manual, 
-	I set a windows environment variable TMPDIR=C:/temp

And now I?m back to my old error regarding the temp dir because it?s somehow
still set to /tmp.

cannot create /tmp/R4156: directory nonexistent
mv: cannot stat `/tmp/R4156': No such file or directory
make[3]: *** [mkR] Error 1
make[2]: *** [all] Error 2
make[1]: *** [R] Error 1
make: *** [all] Error 2

Any ideas? I?m really trying ;-)

Thanks,
Janko

##### SYSTEM INFO #####
Windows XP SP3
R 2.12.0
Eclipse 3.6.1 (Helios)
StatET 0.9.x
#####################

> -----Urspr?ngliche Nachricht-----
> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> Gesendet: Donnerstag, 18. November 2010 16:38
> An: 'Duncan Murdoch'
> Cc: 'r-devel at r-project. org'
> Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> 
> Sorry, but I'm still kind of puzzled on this one ;-)
> 
> Found the Tcl/Tk section in the manual but I don't really understand
> where I have to set those options. Append it to 'make all recommended'?
> I checked 'make --help' which didn't list any such options. Or does
> that refer to the installation of Tcl/Tk itself? I downloaded and
> installed the binary version of Tcl/Tk (ActiveTcl
> http://downloads.activestate.com/ActiveTcl/releases/8.5.9.0/ActiveTcl8.
> 5.9.0.293667-win32-ix86-threaded.exe) and as far as I understand, I now
> need to link that to the tcltk package of R, right? I don't know how I
> would install Tcl/Tk from its sources, but if that's the better choice:
> could anyone drop me the command line(s) I need to execute in order to
> install and link Tcl/Tk to my R (pre-)build?
> 
> Thanks a lot,
> Janko
> 
> SECTION FROM THE MANUAL (P. 32):
> A.2.1 Tcl/Tk
> The tcltk package needs Tcl/Tk >= 8.4 installed: the sources are
> available at http://
> www.tcl.tk/. To specify the locations of the Tcl/Tk files you may need
> the configuration
> options
>   ?--with-tcltk?
>     use Tcl/Tk, or specify its library directory
>   ?--with-tcl-config=TCL_CONFIG?
>     specify location of ?tclConfig.sh?
>     ?--with-tk-config=TK_CONFIG?
>   specify location of ?tkConfig.sh?
> or use the configure variables TCLTK_LIBS and TCLTK_CPPFLAGS to specify
> the flags needed
> for linking against the Tcl and Tk libraries and for finding the
> ?tcl.h? and ?tk.h? headers,
> respectively. If you have both 32- and 64-bit versions of Tcl/Tk
> installed, specifying the paths
> to the correct config files may be necessary to avoid confusion between
> them.
> 
> SYSTEM INFO:
>  - Windows XP SP 3
>  - R-2.12.0
>  - Eclipse 3.6.1
>  - StatET 0.9.x
> 
> > -----Urspr?ngliche Nachricht-----
> > Von: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
> > Gesendet: Donnerstag, 18. November 2010 12:54
> > An: Janko Thyson
> > Cc: 'r-devel at r-project. org'
> > Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >
> > On 18/11/2010 5:40 AM, Janko Thyson wrote:
> > > I've created a /tmp directory so I wouldn't have to change TMPDIR.
> So
> > far,
> > > so good. But now I get the error below. Anything I forgot regarding
> > tcltk?
> >
> > Looks as if you forgot to install it.
> >
> > Duncan Murdoch
> >
> > >
> > > Thx,
> > > Janko
> > >
> > > ERROR:
> > > In file included from init.c:22:0:
> > > tcltk.h:23:17: fatal error: tcl.h: No such file or directory
> > > compilation terminated.
> > > make[4]: *** [init.o] Error 1
> > > make[3]: *** [mksrc-win] Error 1
> > > make[2]: *** [all] Error 2
> > > make[1]: *** [R] Error 1
> > > make: *** [all] Error 2
> > >
> > > SYSTEM INFO:
> > >   - Windows XP SP 3
> > >   - R-2.12.0
> > >   - Eclipse 3.6.1
> > >   - StatET 0.9.x
> > >
> > >> -----Urspr?ngliche Nachricht-----
> > >> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> > >> Gesendet: Donnerstag, 18. November 2010 11:13
> > >> An: 'Prof Brian Ripley'
> > >> Cc: 'r-devel at r-project. org'
> > >> Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> > >>
> > >>> -----Urspr?ngliche Nachricht-----
> > >>> Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> > >>> Gesendet: Mittwoch, 17. November 2010 18:42
> > >>> An: Janko Thyson
> > >>> Cc: 'r-devel at r-project. org'
> > >>> Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp
> dir)
> > >>>
> > >>> Is this on Windows?  (Please do consult the posting guide and
> tell
> > us
> > >>> the 'at a minimum' information we asked for.)
> > >>>
> > >>> If so, it seems you forget the bit about setting TMPDIR right at
> > the
> > >>> top of the section on 'Building the core files':
> > >>>
> > >>>     Set the environment variable @env{TMPDIR} to point to a
> > writable
> > >>>     directory, with a path specified with forward slashes and no
> > >> spaces.
> > >>>     (The default is @file{/tmp}, which may not be useful on
> > Windows.)
> > >>>
> > >>
> > >> Sorry, I always forget to provide that info.
> > >>
> > >> Could you tell me where/how I have to set TMPDIR? I've looked in
> > >> MkRules.local but didn't find anything. Or is that an argument at
> > 'make
> > >> all recommended'?
> > >>
> > >> Thanks,
> > >> Janko
> > >>
> > >> SYSTEM INFO:
> > >> - Windows XP SP 3
> > >> - R-2.12.0
> > >> - Eclipse 3.6.1
> > >> - StatET 0.9.x
> > >>
> > >>> On Wed, 17 Nov 2010, Janko Thyson wrote:
> > >>>
> > >>>> Dear list,
> > >>>>
> > >>>>
> > >>>>
> > >>>> I've just tried to compile R 2.12.0 from source as I think I
> found
> > >> an
> > >>> error
> > >>>> in a C function that I would like to fix and check before I go
> > >> ahead
> > >>> with
> > >>>> posting the presumed error.
> > >>>>
> > >>>>
> > >>>>
> > >>>> I've got the R Toolset 2.12 installed and configured correctly
> and
> > >>> followed
> > >>>> the Admin manual closely (including the entire bitmap stuff;
> exact
> > >>> same
> > >>>> versions as in the manual). Also, all anti virus software is
> > turned
> > >>> off (as
> > >>>> it complained on some .exe). I have Admin rights on my box.
> > >>>>
> > >>>>
> > >>>>
> > >>>> When I run 'make all recommended' I get the following error
> after
> > a
> > >>> while:
> > >>>>
> > >>>>
> > >>>>
> > >>>> cannot create /tmp/R5436: directory nonexistent
> > >>>>
> > >>>> mv: cannot stat `/tmp/R5436': No such file or directory
> > >>>>
> > >>>> make[3]: *** [mkR] Error 1
> > >>>>
> > >>>> make[2]: *** [all] Error 2
> > >>>>
> > >>>> make[1]: *** [R] Error 1
> > >>>>
> > >>>> make: *** [all] Error 2
> > >>>>
> > >>>>
> > >>>>
> > >>>> Any ideas what this is about? Seems that the compiler can't
> create
> > >> a
> > >>> temp
> > >>>> directory because of a missing directory.
> > >>>>
> > >>>>
> > >>>>
> > >>>> Thanks for any hints,
> > >>>>
> > >>>> Janko
> > >>>>
> > >>>>
> > >>>> 	[[alternative HTML version deleted]]
> > >>>>
> > >>>> ______________________________________________
> > >>>> R-devel at r-project.org mailing list
> > >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> > >>>>
> > >>>
> > >>> --
> > >>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> > >>> Professor of Applied Statistics,
> > http://www.stats.ox.ac.uk/~ripley/
> > >>> University of Oxford,             Tel:  +44 1865 272861 (self)
> > >>> 1 South Parks Road,                     +44 1865 272866 (PA)
> > >>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> > >
> > > ______________________________________________
> > > R-devel at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Thu Nov 18 18:43:44 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 18 Nov 2010 12:43:44 -0500
Subject: [Rd] Compiling R 2.12.0 from source: error (temp dir)
In-Reply-To: <001f01cb8736$a458d520$ed0a7f60$@thyson@ku-eichstaett.de>
References: <009201cb8677$a5d1a040$f174e0c0$@thyson@ku-eichstaett.de>	<alpine.LFD.2.00.1011171736340.32145@toucan.stats.ox.ac.uk>
	<001301cb870d$09a16d90$1ce448b0$@thyson@ku-eichstaett.de>
	<4CE513D8.1070600@gmail.com>
	<001f01cb8736$a458d520$ed0a7f60$@thyson@ku-eichstaett.de>
Message-ID: <4CE565D0.7060806@gmail.com>

On 18/11/2010 10:38 AM, Janko Thyson wrote:
> Sorry, but I'm still kind of puzzled on this one ;-)
>
> Found the Tcl/Tk section in the manual but I don't really understand where I
> have to set those options.

The quote below is from the Unix section of the manual. You're on Windows.

Tcl/Tk is included in the Rtools installer, but you have to choose to 
install it. It looks as though you didn't, or didn't install it in the 
right place.

Duncan Murdoch



>   Append it to 'make all recommended'? I checked
> 'make --help' which didn't list any such options. Or does that refer to the
> installation of Tcl/Tk itself? I downloaded and installed the binary version
> of Tcl/Tk (ActiveTcl
> http://downloads.activestate.com/ActiveTcl/releases/8.5.9.0/ActiveTcl8.5.9.0
> .293667-win32-ix86-threaded.exe) and as far as I understand, I now need to
> link that to the tcltk package of R, right? I don't know how I would install
> Tcl/Tk from its sources, but if that's the better choice: could anyone drop
> me the command line(s) I need to execute in order to install and link Tcl/Tk
> to my R (pre-)build?
>
> Thanks a lot,
> Janko
>
> SECTION FROM THE MANUAL (P. 32):
> A.2.1 Tcl/Tk
> The tcltk package needs Tcl/Tk>= 8.4 installed: the sources are available
> at http://
> www.tcl.tk/. To specify the locations of the Tcl/Tk files you may need the
> configuration
> options
>    ?--with-tcltk?
>      use Tcl/Tk, or specify its library directory
>    ?--with-tcl-config=TCL_CONFIG?
>      specify location of ?tclConfig.sh?
>      ?--with-tk-config=TK_CONFIG?
>    specify location of ?tkConfig.sh?
> or use the configure variables TCLTK_LIBS and TCLTK_CPPFLAGS to specify the
> flags needed
> for linking against the Tcl and Tk libraries and for finding the ?tcl.h? and
> ?tk.h? headers,
> respectively. If you have both 32- and 64-bit versions of Tcl/Tk installed,
> specifying the paths
> to the correct config files may be necessary to avoid confusion between
> them.
>
> SYSTEM INFO:
>   - Windows XP SP 3
>   - R-2.12.0
>   - Eclipse 3.6.1
>   - StatET 0.9.x
>
> >  -----Urspr?ngliche Nachricht-----
> >  Von: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
> >  Gesendet: Donnerstag, 18. November 2010 12:54
> >  An: Janko Thyson
> >  Cc: 'r-devel at r-project. org'
> >  Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >
> >  On 18/11/2010 5:40 AM, Janko Thyson wrote:
> >  >  I've created a /tmp directory so I wouldn't have to change TMPDIR. So
> >  far,
> >  >  so good. But now I get the error below. Anything I forgot regarding
> >  tcltk?
> >
> >  Looks as if you forgot to install it.
> >
> >  Duncan Murdoch
> >
> >  >
> >  >  Thx,
> >  >  Janko
> >  >
> >  >  ERROR:
> >  >  In file included from init.c:22:0:
> >  >  tcltk.h:23:17: fatal error: tcl.h: No such file or directory
> >  >  compilation terminated.
> >  >  make[4]: *** [init.o] Error 1
> >  >  make[3]: *** [mksrc-win] Error 1
> >  >  make[2]: *** [all] Error 2
> >  >  make[1]: *** [R] Error 1
> >  >  make: *** [all] Error 2
> >  >
> >  >  SYSTEM INFO:
> >  >    - Windows XP SP 3
> >  >    - R-2.12.0
> >  >    - Eclipse 3.6.1
> >  >    - StatET 0.9.x
> >  >
> >  >>  -----Urspr?ngliche Nachricht-----
> >  >>  Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> >  >>  Gesendet: Donnerstag, 18. November 2010 11:13
> >  >>  An: 'Prof Brian Ripley'
> >  >>  Cc: 'r-devel at r-project. org'
> >  >>  Betreff: AW: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >  >>
> >  >>>  -----Urspr?ngliche Nachricht-----
> >  >>>  Von: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> >  >>>  Gesendet: Mittwoch, 17. November 2010 18:42
> >  >>>  An: Janko Thyson
> >  >>>  Cc: 'r-devel at r-project. org'
> >  >>>  Betreff: Re: [Rd] Compiling R 2.12.0 from source: error (temp dir)
> >  >>>
> >  >>>  Is this on Windows?  (Please do consult the posting guide and tell
> >  us
> >  >>>  the 'at a minimum' information we asked for.)
> >  >>>
> >  >>>  If so, it seems you forget the bit about setting TMPDIR right at
> >  the
> >  >>>  top of the section on 'Building the core files':
> >  >>>
> >  >>>      Set the environment variable @env{TMPDIR} to point to a
> >  writable
> >  >>>      directory, with a path specified with forward slashes and no
> >  >>  spaces.
> >  >>>      (The default is @file{/tmp}, which may not be useful on
> >  Windows.)
> >  >>>
> >  >>
> >  >>  Sorry, I always forget to provide that info.
> >  >>
> >  >>  Could you tell me where/how I have to set TMPDIR? I've looked in
> >  >>  MkRules.local but didn't find anything. Or is that an argument at
> >  'make
> >  >>  all recommended'?
> >  >>
> >  >>  Thanks,
> >  >>  Janko
> >  >>
> >  >>  SYSTEM INFO:
> >  >>  - Windows XP SP 3
> >  >>  - R-2.12.0
> >  >>  - Eclipse 3.6.1
> >  >>  - StatET 0.9.x
> >  >>
> >  >>>  On Wed, 17 Nov 2010, Janko Thyson wrote:
> >  >>>
> >  >>>>  Dear list,
> >  >>>>
> >  >>>>
> >  >>>>
> >  >>>>  I've just tried to compile R 2.12.0 from source as I think I found
> >  >>  an
> >  >>>  error
> >  >>>>  in a C function that I would like to fix and check before I go
> >  >>  ahead
> >  >>>  with
> >  >>>>  posting the presumed error.
> >  >>>>
> >  >>>>
> >  >>>>
> >  >>>>  I've got the R Toolset 2.12 installed and configured correctly and
> >  >>>  followed
> >  >>>>  the Admin manual closely (including the entire bitmap stuff; exact
> >  >>>  same
> >  >>>>  versions as in the manual). Also, all anti virus software is
> >  turned
> >  >>>  off (as
> >  >>>>  it complained on some .exe). I have Admin rights on my box.
> >  >>>>
> >  >>>>
> >  >>>>
> >  >>>>  When I run 'make all recommended' I get the following error after
> >  a
> >  >>>  while:
> >  >>>>
> >  >>>>
> >  >>>>
> >  >>>>  cannot create /tmp/R5436: directory nonexistent
> >  >>>>
> >  >>>>  mv: cannot stat `/tmp/R5436': No such file or directory
> >  >>>>
> >  >>>>  make[3]: *** [mkR] Error 1
> >  >>>>
> >  >>>>  make[2]: *** [all] Error 2
> >  >>>>
> >  >>>>  make[1]: *** [R] Error 1
> >  >>>>
> >  >>>>  make: *** [all] Error 2
> >  >>>>
> >  >>>>
> >  >>>>
> >  >>>>  Any ideas what this is about? Seems that the compiler can't create
> >  >>  a
> >  >>>  temp
> >  >>>>  directory because of a missing directory.
> >  >>>>
> >  >>>>
> >  >>>>
> >  >>>>  Thanks for any hints,
> >  >>>>
> >  >>>>  Janko
> >  >>>>
> >  >>>>
> >  >>>>  	[[alternative HTML version deleted]]
> >  >>>>
> >  >>>>  ______________________________________________
> >  >>>>  R-devel at r-project.org mailing list
> >  >>>>  https://stat.ethz.ch/mailman/listinfo/r-devel
> >  >>>>
> >  >>>
> >  >>>  --
> >  >>>  Brian D. Ripley,                  ripley at stats.ox.ac.uk
> >  >>>  Professor of Applied Statistics,
> >  http://www.stats.ox.ac.uk/~ripley/
> >  >>>  University of Oxford,             Tel:  +44 1865 272861 (self)
> >  >>>  1 South Parks Road,                     +44 1865 272866 (PA)
> >  >>>  Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >  >
> >  >  ______________________________________________
> >  >  R-devel at r-project.org mailing list
> >  >  https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From marko.robnik at fri.uni-lj.si  Fri Nov 19 16:58:40 2010
From: marko.robnik at fri.uni-lj.si (=?iso-8859-2?Q?Marko_Robnik-=A9ikonja?=)
Date: Fri, 19 Nov 2010 16:58:40 +0100
Subject: [Rd] gomp library with Rtools212
Message-ID: <001c01cb8802$a3055960$e9100c20$@fri.uni-lj.si>

Dear developers,

I am a maintainer of the CORElearn package which uses OpenMP multithreading
to speed up some computations. When producing a new release we tested the
package with the latest R 2.12.0. On Linux the package works normally. On
Windows we installed a recommended version of Rtools (Rtools212) but the
linker fails with the messages below.  

...
g++ -I"C:/Util/R/R-2.12.0/include"      -fopenmp   -O2 -Wall  -c
trutilReg.cpp -o trutilReg.o
g++ -I"C:/Util/R/R-2.12.0/include"      -fopenmp   -O2 -Wall  -c utils.cpp
-o utils.o
g++ -shared -s -static-libgcc -o CORElearn.dll tmp.def Rconvert.o Rfront.o
binarize.o binarizeReg.o binnode.o binnodeReg.o binpart.o bintree.o
bintreeReg.o c45read.o calibrate.o constrct.o constrctReg.o cost.o
dataStore.o error.o estCommon.o estOrdAttr.o estimator.o estimatorReg.o
expr.o exprReg.o frontend.o ftree.o kdtree.o mathutil.o menu.o model.o
modelReg.o mstring.o new_new.o nrutil.o options.o printUtil.o prune.o
pruneReg.o random.o regtree.o relieff.o rfRegularize.o rfUtil.o rndforest.o
rrelieff.o treenode.o treenodeReg.o trutil.o trutilReg.o utils.o -fopenmp
-LC:/Util/R/R-2.12.0/bin/i386 -lR
c:/util/rtools/mingw/bin/../lib/gcc/mingw32/4.5.0/libgomp.a(parallel.o):(.te
xt+0x19): undefined reference to `_imp__pthread_getspecific'
c:/util/rtools/mingw/bin/../lib/gcc/mingw32/4.5.0/libgomp.a(parallel.o):(.te
xt+0x7a): undefined reference to `_imp__pthread_mutex_lock'
c:/util/rtools/mingw/bin/../lib/gcc/mingw32/4.5.0/libgomp.a(parallel.o):(.te
xt+0x9a): undefined reference to `_imp__pthread_mutex_unlock'
c:/util/rtools/mingw/bin/../lib/gcc/mingw32/4.5.0/libgomp.a(parallel.o):(.te
xt+0xfa): undefined reference to `_imp__pthread_getspecific'
... 
hundreds of error messages follow...

On R 2.11.1 and 32 bit Windows the package worked fine. Since Rtools now
uses gcc 4.5.0 and libgomp-4.5.0, which do support OpenMP,  I do not know
what is wrong.
In Makevars.win I use
PKG_CXXFLAGS = -fopenmp
PKG_LIBS = -fopenmp

Suspecting that errors may be caused by a wrong underscore convention  I
experimented with the SYMPAT variable in etc/Makeconf, but without success.
My guess is that gomp library provided with Rtools212 is using a different
underscore convention as the rest of the gcc. Can you suggest some solution,
please?

Best regards,

Marko


From keithc.y.li at gmail.com  Fri Nov 19 19:40:54 2010
From: keithc.y.li at gmail.com (Keith)
Date: Fri, 19 Nov 2010 19:40:54 +0100
Subject: [Rd] JRI and error message from R_isMethodsDispatchOn
Message-ID: <4CE6C4B6.6030902@gmail.com>

Dear R users,

I have a small project written in Java and need some statical tools. 
Therefore, I used JRI (in rJava package) as an interface between R and 
Java to write some wrappers for my work. However, I received error 
message from R while I have more than one java method which wraps R:

Error in .Call("R_isMethodsDispatchOn", onOff, PACKAGE = "base") :
   Incorrect number of arguments (2), expecting 1 for R_isMethodsDispatchOn

The Java pseudo code would be like:

public class Test{
   public static void main(String[] args){
     ...
     objA.do;
     objB.do;
     ...
   }
}

Each do method actually calls R to do the job. I already know R is 
single-treaded so I implemented end method in Rengine class to shutdown 
R in each method. I thought this won't cause multi-thread problems in 
this case because I terminate/destroy each R thread before I call 
another one. But, it seems that it's still considered as 2 threads. Did 
I miss something? or probably, I have to set-up JRI server for my 
project? or other recommendations for my purpose?

R version: 2.11.1
rJava version: 0.8-4
OS: Arch Linux

Best,
Keith


From Niels.R.Hansen+lists at math.ku.dk  Fri Nov 19 21:28:03 2010
From: Niels.R.Hansen+lists at math.ku.dk (Niels Richard Hansen)
Date: Fri, 19 Nov 2010 12:28:03 -0800
Subject: [Rd] Error from sparse pattern matrix product
Message-ID: <4CE6DDD3.7000608@math.ku.dk>

Hi

The following attempt to minimize memory consumption fails.

m1 <- Matrix(c(rep(1,1000), rep(0,2000)), 1500)
m2 <- as(m1, "ngCMatrix")

Then

m1 %*% c(1,2)

produces the desired matrix product, while

m2 %*% c(1,2)

results in the error

Error in x %*% y :
   Cholmod error 'invalid xtype' at file:../MatrixOps/cholmod_sdmult.c, line 82

I might be making a wrong assumption that this should work, or another mistake, 
but the error is somewhat cryptic, and reading the help pages and listing the
methods for %*% indicate that matrix products with x of class ngCMatrix
should work. Anyway

object.size(m1)/object.size(m2)

indicates that in this case there is a 2.7-fold gain in memory consumption by
storing only the pattern in the ngCMatrix. This could potentially be quite
useful for large model matrices.

Sincerely, Niels

sessionInfo:

R version 2.12.0 (2010-10-15)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] Matrix_0.999375-45 lattice_0.19-13

loaded via a namespace (and not attached):
[1] grid_2.12.0

-- 
Niels Richard Hansen                     Web:   www.math.ku.dk/~richard	
Associate Professor                      Email: Niels.R.Hansen at math.ku.dk
Department of Mathematical Sciences             nielsrichardhansen at gmail.com
University of Copenhagen                 Skype: nielsrichardhansen.dk	
Universitetsparken 5                     Phone: +1 510 502 8161	
2100 Copenhagen ?
Denmark


From cubranic at stat.ubc.ca  Fri Nov 19 22:11:13 2010
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Fri, 19 Nov 2010 13:11:13 -0800
Subject: [Rd] gomp library with Rtools212
In-Reply-To: <001c01cb8802$a3055960$e9100c20$@fri.uni-lj.si>
References: <001c01cb8802$a3055960$e9100c20$@fri.uni-lj.si>
Message-ID: <201011191311.14009.cubranic@stat.ubc.ca>

On November 19, 2010 07:58:40 am Marko Robnik-?ikonja wrote:
> Dear developers,
> 
> I am a maintainer of the CORElearn package which uses OpenMP
> multithreading to speed up some computations. When producing a new
> release we tested the package with the latest R 2.12.0. On Linux the
> package works normally. On Windows we installed a recommended
> version of Rtools (Rtools212) but the linker fails with the messages
> below.
[...]
> Suspecting that errors may be caused by a wrong underscore convention
>  I experimented with the SYMPAT variable in etc/Makeconf, but
> without success. My guess is that gomp library provided with
> Rtools212 is using a different underscore convention as the rest of
> the gcc. Can you suggest some solution, please?

The cause is that Rtools does not include libthread, which libgomp 
depends on. I ran into the same problem as you (see the thread: 
http://article.gmane.org/gmane.comp.lang.r.devel/25764/). It didn't look 
like libthread will be allowed into RTools, so now we turn OpenMP off on 
Windows. Please let me know if you figure out a better solution.

Thanks,

Davor


From simon.urbanek at r-project.org  Sat Nov 20 08:39:43 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 20 Nov 2010 08:39:43 +0100
Subject: [Rd] JRI and error message from R_isMethodsDispatchOn
In-Reply-To: <4CE6C4B6.6030902@gmail.com>
References: <4CE6C4B6.6030902@gmail.com>
Message-ID: <00C80B8C-71DE-479B-B48F-E1C3C62818A9@r-project.org>

Keith,

On Nov 19, 2010, at 7:40 PM, Keith wrote:

> Dear R users,
> 
> I have a small project written in Java and need some statical tools. Therefore, I used JRI (in rJava package) as an interface between R and Java to write some wrappers for my work. However, I received error message from R while I have more than one java method which wraps R:
> 
> Error in .Call("R_isMethodsDispatchOn", onOff, PACKAGE = "base") :
>  Incorrect number of arguments (2), expecting 1 for R_isMethodsDispatchOn
> 
> The Java pseudo code would be like:
> 
> public class Test{
>  public static void main(String[] args){
>    ...
>    objA.do;
>    objB.do;
>    ...
>  }
> }
> 
> Each do method actually calls R to do the job. I already know R is single-treaded so I implemented end method in Rengine class to shutdown R in each method.

You cannot shutdown R short of closing the process and thus JVM, so that is not an option. In fact NOT using end will likely solve your problem - simply used one, shared instance of the REngine.


> I thought this won't cause multi-thread problems in this case because I terminate/destroy each R thread before I call another one. But, it seems that it's still considered as 2 threads. Did I miss something? or probably, I have to set-up JRI server for my project? or other recommendations for my purpose?
> 

Simply use one instance of REngine continuously - that's the only approach possible with JRI (note that the R access is synchronized so you can use the instance from different threads). If you need multiple instances, you can use Rserve - it uses the same REngine API but allows you to have arbitrarily many parallel instances.

BTW: please use stats-rosuda-devel mailing list of questions related to rJava, JRI or Rserve. It's also worth scanning the archives as those issues have been raised before.

Cheers,
Simon



> R version: 2.11.1
> rJava version: 0.8-4
> OS: Arch Linux
> 
> Best,
> Keith
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From keithc.y.li at gmail.com  Sat Nov 20 11:12:13 2010
From: keithc.y.li at gmail.com (Keith)
Date: Sat, 20 Nov 2010 11:12:13 +0100
Subject: [Rd] JRI and error message from R_isMethodsDispatchOn
In-Reply-To: <00C80B8C-71DE-479B-B48F-E1C3C62818A9@r-project.org>
References: <4CE6C4B6.6030902@gmail.com>
	<00C80B8C-71DE-479B-B48F-E1C3C62818A9@r-project.org>
Message-ID: <4CE79EFD.6030603@gmail.com>

Hello Urbanek,

Simon Urbanek wrote:
> Keith,
> 
> On Nov 19, 2010, at 7:40 PM, Keith wrote:
> 
>> Dear R users,
>>
>> I have a small project written in Java and need some statical tools. Therefore, I used JRI (in rJava package) as an interface between R and Java to write some wrappers for my work. However, I received error message from R while I have more than one java method which wraps R:
>>
>> Error in .Call("R_isMethodsDispatchOn", onOff, PACKAGE = "base") :
>>  Incorrect number of arguments (2), expecting 1 for R_isMethodsDispatchOn
>>
>> The Java pseudo code would be like:
>>
>> public class Test{
>>  public static void main(String[] args){
>>    ...
>>    objA.do;
>>    objB.do;
>>    ...
>>  }
>> }
>>
>> Each do method actually calls R to do the job. I already know R is single-treaded so I implemented end method in Rengine class to shutdown R in each method.
> 
> You cannot shutdown R short of closing the process and thus JVM, so that is not an option. In fact NOT using end will likely solve your problem - simply used one, shared instance of the REngine.
> 
> 
>> I thought this won't cause multi-thread problems in this case because I terminate/destroy each R thread before I call another one. But, it seems that it's still considered as 2 threads. Did I miss something? or probably, I have to set-up JRI server for my project? or other recommendations for my purpose?
>>
> 
> Simply use one instance of REngine continuously - that's the only approach possible with JRI (note that the R access is synchronized so you can use the instance from different threads). If you need multiple instances, you can use Rserve - it uses the same REngine API but allows you to have arbitrarily many parallel instances.
> 
> BTW: please use stats-rosuda-devel mailing list of questions related to rJava, JRI or Rserve. It's also worth scanning the archives as those issues have been raised before.
> 
> Cheers,
> Simon
> 
> 
> 
>> R version: 2.11.1
>> rJava version: 0.8-4
>> OS: Arch Linux
>>
>> Best,
>> Keith
>>
Thanks for the quick reply. It clears my confusion of using JRI. Now I 
knew the stats-rosuda-devel mailing list, and I'll raise the related 
questions/problems there next time.

Cheers,
Keith


From mark.heckmann at gmx.de  Sat Nov 20 17:12:44 2010
From: mark.heckmann at gmx.de (Mark Heckmann)
Date: Sat, 20 Nov 2010 17:12:44 +0100
Subject: [Rd] how to store package options over sessions?
Message-ID: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101120/d1e5c6f1/attachment.pl>

From edd at debian.org  Sat Nov 20 18:51:28 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 20 Nov 2010 11:51:28 -0600
Subject: [Rd] how to store package options over sessions?
In-Reply-To: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
References: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
Message-ID: <19688.2720.428557.307821@max.nulle.part>


On 20 November 2010 at 17:12, Mark Heckmann wrote:
| Hi,
| I posted this a week ago on r-help but did not get an answer. So I hope that someone here can help me:
| I want to define some options for my package the user may change.
| It would be convenient if the changes could be saved when terminating  
| an R session and recovered automatically on the next package load.
| 
| Is that possible and if yes, is the standard way to implement this?

First off:

   R> fortunes:::fortune("yoda")
   
   Evelyn Hall: I would like to know how (if) I can extract some of the
   information from the summary of my nlme.
   Simon Blomberg: This is R. There is no if. Only how.
      -- Evelyn Hall and Simon 'Yoda' Blomberg
         R-help (April 2005)
   
   R> 

Secondly, what you ask is necessarily rather OS-dependent. So of course it
can be done, but probably in way that depend on your local circumstance.

Thirdly, and to make this a little more helpful, I frequently use the RSQLite
package to cache data across sessions and invocations. For a large example,
consider the CRANberries feed (http://dirk.eddelbuettel.com/cranberries/)
which stores in SQLite what the the state of the (CRAN) world was the last it
got woken up by crontab.  I also have a few smaller ad-hoc things at work
that do similar things.

Depending on your local circumstances you may make this 'cache' of stateful
information read or read/write, make it a file on NFS or CIFS or WebDAV, make
it a database that can be read as file or over sockets and so.  

And Yoda still rules.

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From spencer.graves at structuremonitoring.com  Sat Nov 20 19:42:32 2010
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Sat, 20 Nov 2010 10:42:32 -0800
Subject: [Rd] how to store package options over sessions?
In-Reply-To: <19688.2720.428557.307821@max.nulle.part>
References: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
	<19688.2720.428557.307821@max.nulle.part>
Message-ID: <4CE81698.1050809@structuremonitoring.com>

       If you want the information to be kept within a specific working 
directory, and forgotten when the user changes the working directory, 
then you can store the results in getwd() using something like the 
following:


             save(object1toSave, object2toSave, ..., 
file="MyPackageName_saveFile.rda")


When the package is loaded, e.g., library(MyPackageName), you can use 
something like the following to restore it:


             if(length(grep("MyPackageName_saveFile.rda", 
dir()))>0)load("MyPackageName_saveFile.rda")


       I haven't tried it, but it looks like it should work AND be 
platform independent (AND would not require SQLite).


       Dirk's solution seems better if you do NOT want the saved 
information to be lost when the user executes library(MyPackageName) 
within a different working directory.


       Hope this helps.
       Spencer


On 11/20/2010 9:51 AM, Dirk Eddelbuettel wrote:
> On 20 November 2010 at 17:12, Mark Heckmann wrote:
> | Hi,
> | I posted this a week ago on r-help but did not get an answer. So I hope that someone here can help me:
> | I want to define some options for my package the user may change.
> | It would be convenient if the changes could be saved when terminating
> | an R session and recovered automatically on the next package load.
> |
> | Is that possible and if yes, is the standard way to implement this?
>
> First off:
>
>     R>  fortunes:::fortune("yoda")
>
>     Evelyn Hall: I would like to know how (if) I can extract some of the
>     information from the summary of my nlme.
>     Simon Blomberg: This is R. There is no if. Only how.
>        -- Evelyn Hall and Simon 'Yoda' Blomberg
>           R-help (April 2005)
>
>     R>
>
> Secondly, what you ask is necessarily rather OS-dependent. So of course it
> can be done, but probably in way that depend on your local circumstance.
>
> Thirdly, and to make this a little more helpful, I frequently use the RSQLite
> package to cache data across sessions and invocations. For a large example,
> consider the CRANberries feed (http://dirk.eddelbuettel.com/cranberries/)
> which stores in SQLite what the the state of the (CRAN) world was the last it
> got woken up by crontab.  I also have a few smaller ad-hoc things at work
> that do similar things.
>
> Depending on your local circumstances you may make this 'cache' of stateful
> information read or read/write, make it a file on NFS or CIFS or WebDAV, make
> it a database that can be read as file or over sockets and so.
>
> And Yoda still rules.
>
> Dirk
>


-- 
Spencer Graves, PE, PhD
President and Chief Operating Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567


From marko.robnik at fri.uni-lj.si  Sat Nov 20 20:25:11 2010
From: marko.robnik at fri.uni-lj.si (=?UTF-8?Q?Marko_Robnik-=C5=A0ikonja?=)
Date: Sat, 20 Nov 2010 20:25:11 +0100
Subject: [Rd] gomp library with Rtools212
In-Reply-To: <201011191311.14009.cubranic@stat.ubc.ca>
References: <001c01cb8802$a3055960$e9100c20$@fri.uni-lj.si>
	<201011191311.14009.cubranic@stat.ubc.ca>
Message-ID: <003a01cb88e8$a6443830$f2cca890$@fri.uni-lj.si>


> On November 19, 2010 07:58:40 am Marko Robnik-?ikonja wrote:
> > I am a maintainer of the CORElearn package which uses OpenMP
> > multithreading to speed up some computations. When producing a new
> > release we tested the package with the latest R 2.12.0. On Linux the
> > package works normally. On Windows we installed a recommended
> version of Rtools (Rtools212) but the linker fails with the messages below.
> [...]
> > Suspecting that errors may be caused by a wrong underscore convention
> > I experimented with the SYMPAT variable in etc/Makeconf, but without
> > success. My guess is that gomp library provided with
> > Rtools212 is using a different underscore convention as the rest of
> > the gcc. Can you suggest some solution, please?
> 
> On November 19, 2010 22:12 Davor Cubranic wrote:
> The cause is that Rtools does not include libthread, which libgomp depends
> on. I ran into the same problem as you (see the thread:
> http://article.gmane.org/gmane.comp.lang.r.devel/25764/). It didn't look
> like libthread will be allowed into RTools, so now we turn OpenMP off on
> Windows. Please let me know if you figure out a better solution.

Thank you, Davor for your suggestion, as well as Prof Ripley for his explanation posted to r-windows list. 
I have discovered TDM MinGW toolchain http://tdm-gcc.tdragon.net/ which does contain pthreads in both 32 and 64 bit version of the package. Using Makevars.win below I can produce both 32 and 64 bit version of the package. 

ARCH_FLAG = -m32
ifeq ($(R_ARCH),/x64)
  ARCH_FLAG = -m64
endif
PKG_CXXFLAGS = $(ARCH_FLAG) -fopenmp
PKG_LIBS = $(ARCH_FLAG) -fopenmp

As long as Rtools do not support openMP I will publish multithreaded Windows packages only on my website and diasble it on  CRAN.

Greetings, 

Marko


From lux-integ at btconnect.com  Sat Nov 20 23:35:02 2010
From: lux-integ at btconnect.com (luxInteg)
Date: Sat, 20 Nov 2010 22:35:02 +0000
Subject: [Rd] R-.12.0 atlas lapack
Message-ID: <201011202235.02520.lux-integ@btconnect.com>

Greetings,

I last  built R-2.11.1  a few months ago.  The computer was equipped with 
these:-

---cpu amd64 2 cores
---o/s cblfs 64-bit only linux kernel-2.6.32 gcc-4.4.2 jdk(1.5)-6U20? 
---bls atlas3.9.26  lapacck-3.2.1

I obtained   an installed directory of ~58Mbytes  and in the ~/lib directory 
was  libR.so (~7.8Mbytes in size) as well as libRblas.so and libRlapack.so 
(~2.9Mbytes).

I have since upgraded atlas to atlas3.9.32 and lapack to lapack-3.2.2. to 
fulfill requirements of other numeric intensive  programs I use.  Today  I 
compiled and installed    R-2.12.0   using the same settings used for R-2.11.1 
and these are my findings:- 

{The  installed directory is ~42Mbytes  and in the ~/lib directory there is 
but libR.so of only 2.9 mbytes.  There are no libRlapack.so nor libRblas.so}


I would be grateful if someone culd explain   the discrepencies   between the 
two versions of R  and what the requirements are for generating linRlapack.so  
and libRblas.so  and/or whether these have been superceded.


thanks in   advance..

sincerely
luxInteg


From janko.thyson at ku-eichstaett.de  Sun Nov 21 23:18:33 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Sun, 21 Nov 2010 23:18:33 +0100
Subject: [Rd] Ref classes: can I register fields as I register methods?
Message-ID: <005d01cb89ca$08f78770$1ae69650$@thyson@ku-eichstaett.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101121/d2532aed/attachment.pl>

From janko.thyson at ku-eichstaett.de  Mon Nov 22 00:31:25 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Mon, 22 Nov 2010 00:31:25 +0100
Subject: [Rd] reference classes: question on inheritance
Message-ID: <006301cb89d4$36afbcf0$a40f36d0$@thyson@ku-eichstaett.de>

Dear list,

I have a reference class which should act as a "generic" superclass for
other classes. I've read the respective section at ?setRefClass and put the
name of the superclass to the 'contains' argument of an example subclass
(see class defs below). Classnames are set in a way that shouldn't result in
collation issues (virtual def sourced before superclass def sourced before
subclass). Yet, this  results in the following error:

Warnmeldung:
unable to find a consistent ordering of superclasses for class "Shabubu":
order chosen is inconsistent with the superclasses of "JObject"

###### CLASS DEFS #####
setClass("JObjectVirtual")
setRefClass(
	Class="JObject",
	fields=list(
		# GENERIC FIELDS (DON'T CHANGE !!!)
		.BUFFER="environment",
		.GENESIS="environment",
		.HISTORY="environment",
		.IMAGES="environment",
		.LOGS="environment",
		.OPTS="environment",
		.PLUGINS="environment",
		.TMP="environment",
		.UID="character",
		DATA="data.frame"
		# /
	),
	contains=c("JObjectVirtual"),
 	methods=list(
		...
	)
)
setRefClass(
	Class="Shabubu",
	fields=list(
		# CUSTOM FIELDS (ADAPT TO YOUR NEEDS)
		a="numeric",
		b="character",
		c="logical",
		d="data.frame",
		e="matrix",
		f="list",
		derived.field="function"
		# /
	),
	contains=c("JObject")
)

What am I doing wrong here?

Thanks,
Janko


From janko.thyson at ku-eichstaett.de  Mon Nov 22 00:40:52 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Mon, 22 Nov 2010 00:40:52 +0100
Subject: [Rd] reference classes: question on inheritance
Message-ID: <006401cb89d5$888ad3b0$99a07b10$@thyson@ku-eichstaett.de>

Hmm, interesting: it's the virtual class that causes the trouble. If a
virtual class is a ref class, everything works fine. If it's a standard S4
class, it results in the error below.

Regards,
Janko

> -----Urspr?ngliche Nachricht-----
> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> Gesendet: Montag, 22. November 2010 00:31
> An: 'r-devel at r-project. org'
> Betreff: reference classes: question on inheritance
> 
> Dear list,
> 
> I have a reference class which should act as a ?generic? superclass for
> other classes. I?ve read the respective section at ?setRefClass and put
> the name of the superclass to the ?contains? argument of an example
> subclass (see class defs below). Classnames are set in a way that
> shouldn?t result in collation issues (virtual def sourced before
> superclass def sourced before subclass). Yet, this  results in the
> following error:
> 
> Warnmeldung:
> unable to find a consistent ordering of superclasses for class
> "Shabubu": order chosen is inconsistent with the superclasses of
> "JObject"
> 
> ###### CLASS DEFS #####
> setClass("JObjectVirtual")
> setRefClass(
> 	Class="JObject",
> 	fields=list(
> 		# GENERIC FIELDS (DON'T CHANGE !!!)
> 		.BUFFER="environment",
> 		.GENESIS="environment",
> 		.HISTORY="environment",
> 		.IMAGES="environment",
> 		.LOGS="environment",
> 		.OPTS="environment",
> 		.PLUGINS="environment",
> 		.TMP="environment",
> 		.UID="character",
> 		DATA="data.frame"
> 		# /
> 	),
> 	contains=c("JObjectVirtual"),
>  	methods=list(
> 		...
> 	)
> )
> setRefClass(
> 	Class="Shabubu",
> 	fields=list(
> 		# CUSTOM FIELDS (ADAPT TO YOUR NEEDS)
> 		a="numeric",
> 		b="character",
> 		c="logical",
> 		d="data.frame",
> 		e="matrix",
> 		f="list",
> 		derived.field="function"
> 		# /
> 	),
> 	contains=c("JObject")
> )
> 
> What am I doing wrong here?
> 
> Thanks,
> Janko


From phil.joubert at landg.com  Mon Nov 22 12:23:10 2010
From: phil.joubert at landg.com (evilphil)
Date: Mon, 22 Nov 2010 03:23:10 -0800 (PST)
Subject: [Rd] S4 setMethod, setGeneric and default arguments
In-Reply-To: <1289477631441-3037716.post@n4.nabble.com>
References: <1289477631441-3037716.post@n4.nabble.com>
Message-ID: <1290424990027-3053442.post@n4.nabble.com>


<BUMP>

anyone?
-- 
View this message in context: http://r.789695.n4.nabble.com/S4-setMethod-setGeneric-and-default-arguments-tp3037716p3053442.html
Sent from the R devel mailing list archive at Nabble.com.


From jkatta at 3cinfosystem.com  Mon Nov 22 11:04:08 2010
From: jkatta at 3cinfosystem.com (jkatta)
Date: Mon, 22 Nov 2010 02:04:08 -0800 (PST)
Subject: [Rd] Using RInside in Visual Studio 8.0 VC++.NET Program
Message-ID: <1290420248177-3053352.post@n4.nabble.com>


Hello,
 
I am trying to use Rinside package in my VC++.Net program ( using Visual
Studio 8.0 environment). I have downloaded Windows binary of RInside from
the following link
http://cran.r-project.org/web/packages/RInside/index.htm
Version of RInside - 0.2.3
 
While compiling the program , i am getting about 69 error. Some of them are
the folllowing ones. Please me in solving the following issue
 
Error 96 error C2065: '_First1' : undeclared identifier C:\Program
Files\Microsoft Visual Studio 9.0\VC\include\xlocale 875 Qdev_R1
Error 97 error C2065: '_Last1' : undeclared identifier C:\Program
Files\Microsoft Visual Studio 9.0\VC\include\xlocale 875 Qdev_R1
Error 98 error C2065: '_Count' : undeclared identifier C:\Program
Files\Microsoft Visual Studio 9.0\VC\include\xlocale 875 Qdev_R1
Error 100 error C2065: '_First1' : undeclared identifier C:\Program
Files\Microsoft Visual Studio 9.0\VC\include\xlocale 1117 Qdev_R1
Error 101 error C2065: '_Last1' : undeclared identifier C:\Program
Files\Microsoft Visual Studio 9.0\VC\include\xlocale 1117 Qdev_R1
Error 102 error C2065: '_Count' : undeclared identifier C:\Program
Files\Microsoft Visual Studio 9.0\VC\include\xlocale 1117 Qdev_R1
Error 316 error C4430: missing type specifier - int assumed. Note: C++ does
not support default-int D:\R Lib\Packages\Rcpp\include\Rcpp\Language.h 150
Qdev_R1
Error 317 error C4430: missing type specifier - int assumed. Note: C++ does
not support default-int D:\R Lib\Packages\Rcpp\include\Rcpp\Language.h 155
Qdev_R1
Error 318 error C2059: syntax error : '>' D:\R
Lib\Packages\Rcpp\include\Rcpp\Language.h 164 Qdev_R1
Error 319 error C2143: syntax error : missing ';' before '{' D:\R
Lib\Packages\Rcpp\include\Rcpp\Language.h 164 Qdev_R1
Error 320 error C2065: 'call_' : undeclared identifier D:\R
Lib\Packages\Rcpp\include\Rcpp\Language.h 166 Qdev_R1
Error 321 error C3861: 'proxy': identifier not found D:\R
Lib\Packages\Rcpp\include\Rcpp\Language.h 166 Qdev_R1
Error 322 error C2143: syntax error : missing ',' before '{' D:\R
Lib\Packages\Rcpp\include\Rcpp\Language.h 166 Qdev_R1
 
 

I also have few queries
 
1. Can  Rinside 0.2.3 be used in any specific version of C++ comiler?
2. Can I use Rinside in Visual Studio 8.0 ? . VS 8.0 is a .Net environment.
3. Do i have to do any specific compiler setting to compile RInside in my
code?
 
Thanks for your valuable input in advance.

-- 
View this message in context: http://r.789695.n4.nabble.com/Using-RInside-in-Visual-Studio-8-0-VC-NET-Program-tp3053352p3053352.html
Sent from the R devel mailing list archive at Nabble.com.


From edd at debian.org  Mon Nov 22 14:01:20 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 22 Nov 2010 07:01:20 -0600
Subject: [Rd] Using RInside in Visual Studio 8.0 VC++.NET Program
In-Reply-To: <1290420248177-3053352.post@n4.nabble.com>
References: <1290420248177-3053352.post@n4.nabble.com>
Message-ID: <19690.27040.361264.552469@max.nulle.part>


(We generally recommend that Rcpp/RInside question be sent to rcpp-devel.)

On 22 November 2010 at 02:04, jkatta wrote:
| 
| Hello,
|  
| I am trying to use Rinside package in my VC++.Net program ( using Visual
| Studio 8.0 environment). I have downloaded Windows binary of RInside from
| the following link
| http://cran.r-project.org/web/packages/RInside/index.htm
| Version of RInside - 0.2.3
|  
| While compiling the program , i am getting about 69 error. Some of them are
| the folllowing ones. Please me in solving the following issue
|  
| Error 96 error C2065: '_First1' : undeclared identifier C:\Program
| Files\Microsoft Visual Studio 9.0\VC\include\xlocale 875 Qdev_R1
| Error 97 error C2065: '_Last1' : undeclared identifier C:\Program
| Files\Microsoft Visual Studio 9.0\VC\include\xlocale 875 Qdev_R1
| Error 98 error C2065: '_Count' : undeclared identifier C:\Program
| Files\Microsoft Visual Studio 9.0\VC\include\xlocale 875 Qdev_R1
| Error 100 error C2065: '_First1' : undeclared identifier C:\Program
| Files\Microsoft Visual Studio 9.0\VC\include\xlocale 1117 Qdev_R1
| Error 101 error C2065: '_Last1' : undeclared identifier C:\Program
| Files\Microsoft Visual Studio 9.0\VC\include\xlocale 1117 Qdev_R1
| Error 102 error C2065: '_Count' : undeclared identifier C:\Program
| Files\Microsoft Visual Studio 9.0\VC\include\xlocale 1117 Qdev_R1
| Error 316 error C4430: missing type specifier - int assumed. Note: C++ does
| not support default-int D:\R Lib\Packages\Rcpp\include\Rcpp\Language.h 150
| Qdev_R1
| Error 317 error C4430: missing type specifier - int assumed. Note: C++ does
| not support default-int D:\R Lib\Packages\Rcpp\include\Rcpp\Language.h 155
| Qdev_R1
| Error 318 error C2059: syntax error : '>' D:\R
| Lib\Packages\Rcpp\include\Rcpp\Language.h 164 Qdev_R1
| Error 319 error C2143: syntax error : missing ';' before '{' D:\R
| Lib\Packages\Rcpp\include\Rcpp\Language.h 164 Qdev_R1
| Error 320 error C2065: 'call_' : undeclared identifier D:\R
| Lib\Packages\Rcpp\include\Rcpp\Language.h 166 Qdev_R1
| Error 321 error C3861: 'proxy': identifier not found D:\R
| Lib\Packages\Rcpp\include\Rcpp\Language.h 166 Qdev_R1
| Error 322 error C2143: syntax error : missing ',' before '{' D:\R
| Lib\Packages\Rcpp\include\Rcpp\Language.h 166 Qdev_R1
|  
|  
| 
| I also have few queries
|  
| 1. Can  Rinside 0.2.3 be used in any specific version of C++ comiler?
| 2. Can I use Rinside in Visual Studio 8.0 ? . VS 8.0 is a .Net environment.
| 3. Do i have to do any specific compiler setting to compile RInside in my
| code?

You overlooked this under 'Status' on the main RInside web page:

  Status

  Version 0.2.3 should build and install on just about any Linux and OS X
  system, and even on Windows machines that have the Rtools compiled by
  Duncan Murdoch as detailed in the The Windows Toolset appendix to the R
  Installation manual. *Do not* report an error if you fail to build this
  with another compiler as this is *not supported*. 

So we were pretty explicit in telling you this would not work.  And there is
also question 2.8 of the Rcpp FAQ, here is a copy&paste from the Rcpp-FAQ.pdf:

  2.8  Can I use Rcpp with Visual Studio
  
  Not a chance.

     And that is not because we are meanies but because R and Visual Studio
  simply do not get along. As Rcpp is all about extending R with C++
  interfaces, we are bound by the available toolchain. And R simply does not
  compile with Visual Studio. Go complain to its vendor if you are still
  upset.

Hope his helps.

Dirk

|  
| Thanks for your valuable input in advance.
| 
| -- 
| View this message in context: http://r.789695.n4.nabble.com/Using-RInside-in-Visual-Studio-8-0-VC-NET-Program-tp3053352p3053352.html
| Sent from the R devel mailing list archive at Nabble.com.
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From simon.urbanek at r-project.org  Mon Nov 22 17:20:16 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 22 Nov 2010 11:20:16 -0500
Subject: [Rd] how to store package options over sessions?
In-Reply-To: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
References: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
Message-ID: <A96ADCB6-6123-43F9-A7C5-0E8C39D1E910@r-project.org>

I'm not sure why it was not mentioned do far, but the most obvious solution is to create a special object in the workspace (usually a hidden environment or a list - e.g. .myPackage.options.env). One advantage is that the user has full control over whether it should be save or not as it's tied to the workspace. On load the package can look for it and use it if it is what's expected (e.g., it may be worth using a specific class).

That said, in either case I think it's important to make it optional and document it well, because leaving files or objects around when not expected is impolite to say the least.

Cheers,
Simon


On Nov 20, 2010, at 11:12 AM, Mark Heckmann wrote:

> Hi,
> I posted this a week ago on r-help but did not get an answer. So I hope that someone here can help me:
> I want to define some options for my package the user may change.
> It would be convenient if the changes could be saved when terminating  
> an R session and recovered automatically on the next package load.
> 
> Is that possible and if yes, is the standard way to implement this?
> 
> Thanks,
> Mark
> 
> ???????????????????????????????????????
> Mark Heckmann
> Dipl. Wirt.-Ing. cand. Psych.
> Celler Stra?e 27
> 28205 Bremen
> Blog: www.markheckmann.de
> R-Blog: http://ryouready.wordpress.com
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From wjlee2002 at naver.com  Mon Nov 22 17:24:04 2010
From: wjlee2002 at naver.com (=?EUC-KR?B?wMy/+MDn?=)
Date: Tue, 23 Nov 2010 01:24:04 +0900
Subject: [Rd] =?euc-kr?q?How_to_call_R_from_C?=
Message-ID: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101123/b466f777/attachment.pl>

From ggrothendieck at gmail.com  Mon Nov 22 17:34:59 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 22 Nov 2010 11:34:59 -0500
Subject: [Rd] how to store package options over sessions?
In-Reply-To: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
References: <1CD42D9B-8CD0-42E8-96DE-9F46327E8E60@gmx.de>
Message-ID: <AANLkTimxq=FRZb29kQVdo8hqzO7LvnCJEJWEviC16-0B@mail.gmail.com>

On Sat, Nov 20, 2010 at 11:12 AM, Mark Heckmann <mark.heckmann at gmx.de> wrote:
> Hi,
> I posted this a week ago on r-help but did not get an answer. So I hope that someone here can help me:
> I want to define some options for my package the user may change.
> It would be convenient if the changes could be saved when terminating
> an R session and recovered automatically on the next package load.
>
> Is that possible and if yes, is the standard way to implement this?
>

You can use options and getOptions for this.  The user can place an
options command in their .Rprofile or just enter it into their session
to override the defaults.  See ?options .  For example, in the gsubfn
package look at the engine argument:

> library(gsubfn)
Loading required package: proto
> args(gsubfn)
function (pattern, replacement, x, backref, USE.NAMES = FALSE,
    ignore.case = FALSE, engine = getOption("gsubfn.engine"),
    env = parent.frame(), ...)

The user can put an options(engine = "...whatever...") in their
.Rprofile file or can enter it interactively into R.  If not,
getOption("gsubfn.engine") returns NULL and the gsubfn package can
check whether engine was passed as a NULL and supply a default.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From mtmorgan at fhcrc.org  Mon Nov 22 17:34:28 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 22 Nov 2010 08:34:28 -0800
Subject: [Rd] S4 setMethod, setGeneric and default arguments
In-Reply-To: <1290424990027-3053442.post@n4.nabble.com>
References: <1289477631441-3037716.post@n4.nabble.com>
	<1290424990027-3053442.post@n4.nabble.com>
Message-ID: <4CEA9B94.3070407@fhcrc.org>

On 11/22/2010 03:23 AM, evilphil wrote:
> 
> <BUMP>
> 
> anyone?

Hi evilphil --

Your method signature doesn't have 'missing' for its third argument, and
hence isn't the target of dispatch when the generic is invoked with a
missing argument. I guess you'd figured that out and are really asking
whether it's consistent with the S4 design, and I think it is.

Why one might provide a default to an argument that is also dispatched
on seems like a design decision on your part. Maybe because missing
argument dispatch is a common (default) use case? Or to advertise via
the generic args what a typical value might be? But dispatch on multiple
arguments becomes complicated -- the number of combinations of possible
arguments is large, the 'next' method very difficult to reason about --
so might best be avoided if not necessary. The 'signature' argument of
setGeneric allows arguments to be included but not dispatched on.

Martin
-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From brian at braverock.com  Mon Nov 22 17:45:31 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 22 Nov 2010 10:45:31 -0600
Subject: [Rd] How to call R from C
In-Reply-To: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
References: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
Message-ID: <e92505a7d78c3633d3659c3634b70e78@braverock.com>

On Tue, 23 Nov 2010 01:24:04 +0900, ???<wjlee2002 at naver.com> wrote:
> Hi all!
> I read R Extensions manual.
> But still I am not sure how to call R functions from C.
> Would any of you give me a sample C code to show how to call R functions
-
> for instance, time series functions - from C in the embedded way of C
code?

Look at package xts, among many others, for examples (xts is one of the
time series classes that makes extensive use of C code).

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From cubranic at stat.ubc.ca  Mon Nov 22 17:54:37 2010
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Mon, 22 Nov 2010 08:54:37 -0800
Subject: [Rd] R5 reference classes: how to initialize exactly?
In-Reply-To: <003001cb8643$bd85bb60$38913220$@thyson@ku-eichstaett.de>
References: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>
	<F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>
	<003001cb8643$bd85bb60$38913220$@thyson@ku-eichstaett.de>
Message-ID: <871D8A34-EF70-4D85-939D-8F9B602B013A@stat.ubc.ca>

>> Just a clarification for posterity - R5 has nothing to do with the new
>> reference classes. It's not even an official name, but informally it's a
>> collection of ideas for an entirely new object system that can replace
>> both S3 and S4 (not that it will but it should be seen as having the
>> capability to do so technically). Reference classes are just an addition
>> to S4.
>> 
>> Cheers,
>> Simon
> 
> Thanks for that clarification. I picked that name up from the Google
> TechTalks presentation of Dirk and Romain. So I refer to them as S4
> reference classes in future posts?
> 

Or just R15S for brevity. :-)

Davor


From lux-integ at btconnect.com  Mon Nov 22 18:59:13 2010
From: lux-integ at btconnect.com (luxInteg)
Date: Mon, 22 Nov 2010 17:59:13 +0000
Subject: [Rd] R-.12.0 atlas lapack
In-Reply-To: <201011202235.02520.lux-integ@btconnect.com>
References: <201011202235.02520.lux-integ@btconnect.com>
Message-ID: <201011221759.13973.lux-integ@btconnect.com>

On Saturday 20 November 2010 22:35:02 luxInteg wrote:
> Greetings,
> 
> I last  built R-2.11.1  a few months ago.  The computer was equipped with
> these:-
> 
> ---cpu amd64 2 cores
> ---o/s cblfs 64-bit only linux kernel-2.6.32 gcc-4.4.2 jdk(1.5)-6U20?
> ---bls atlas3.9.26  lapacck-3.2.1
> 
> I obtained   an installed directory of ~58Mbytes  and in the ~/lib
> directory was  libR.so (~7.8Mbytes in size) as well as libRblas.so and
> libRlapack.so (~2.9Mbytes).
> 
> I have since upgraded atlas to atlas3.9.32 and lapack to lapack-3.2.2. to
> fulfill requirements of other numeric intensive  programs I use.  Today  I
> compiled and installed    R-2.12.0   using the same settings used for
> R-2.11.1 and these are my findings:-
> 
> {The  installed directory is ~42Mbytes  and in the ~/lib directory there is
> but libR.so of only 2.9 mbytes.  There are no libRlapack.so nor
> libRblas.so}
> 
> 
> I would be grateful if someone culd explain   the discrepencies   between
> the two versions of R  and what the requirements are for generating
> linRlapack.so and libRblas.so  and/or whether these have been superceded.
> 
> 
> thanks in   advance..

excerpt from /R-2.12.0/src/modules/lapack/README

(
The Fortran routines here are extracted from LAPACK 3.1.0, then 3.1.1
(http://www.netlib.org/lapack and mirrors).

dlapack?.f are support routines for `real' LAPACK calls
cmplx.f are support routines for LAPACK calls from complex arithmetic
routines, that are only used if COMPLEX*16 is supported by the Fortran
compiler and compatible with the Rcomplex type (guaranteed for f2c users).
Neither will not be compiled if an external LAPACK is used.

)

As I said in my original email,  I  have external atla3.9.32 and lapack-3.2.2.  
I would be grateful to know if:-

a) libRblas.so  and libRlapack.so  are now superfluouss  AND  if hey are 
b) if one  now links libR.so  to lib{atlas,lapack}.so (or .a)


From romain at r-enthusiasts.com  Mon Nov 22 18:04:28 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Mon, 22 Nov 2010 18:04:28 +0100
Subject: [Rd] How to call R from C
In-Reply-To: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
References: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
Message-ID: <4CEAA29C.5070601@r-enthusiasts.com>

Le 22/11/10 17:24, ??? a ?crit :
>
> Hi all!
> I read R Extensions manual.
> But still I am not sure how to call R functions from C.
> Would any of you give me a sample C code to show how to call R functions - for instance, time series functions - from C in the embedded way of C code?

As Brian said, there are plenty of examples to follow.

The basic idea is to create a call and evaluate it.

txt <- '
#include <R.h>
#include <Rdefines.h>

SEXP callrnorm(){
	SEXP call = PROTECT( lang2( install( "rnorm"), ScalarInteger(10) ) ) ;
	SEXP res = PROTECT( eval( call, R_GlobalEnv ) ) ;
	UNPROTECT(2) ;
	return res ;
}
'
writeLines( txt, "test.c" )
system( "R CMD SHLIB test.c" )
dyn.load( "test.so" )
.Call( "callrnorm" )



or using the inline package :

require(inline)
fx <- cfunction( , '
	SEXP call = PROTECT( lang2( install( "rnorm"), ScalarInteger(10) ) ) ;
	SEXP res = PROTECT( eval( call, R_GlobalEnv ) ) ;
	UNPROTECT(2) ;
	return res ;
' , verbose = TRUE)
fx()



And now for the Rcpp plug ;-) calling R functions is dramatically easy 
with Rcpp with the Rcpp::Function class.

require(inline)
fx <- cxxfunction( , '
	// grab the function
	Function rnorm("rnorm") ;

	// call it
	return rnorm(10, _["sd"] = 10) ;

' , plugin = "Rcpp" )
fx()


Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From brian at braverock.com  Mon Nov 22 18:09:41 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 22 Nov 2010 11:09:41 -0600
Subject: [Rd] How to call R from C
In-Reply-To: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
References: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
Message-ID: <962040c341597fd9c2edf38455726b66@braverock.com>

On Tue, 23 Nov 2010 01:24:04 +0900, ???<wjlee2002 at naver.com> wrote:
> Hi all!
> I read R Extensions manual.
> But still I am not sure how to call R functions from C.
> Would any of you give me a sample C code to show how to call R functions
-
> for instance, time series functions - from C in the embedded way of C
code?

Dirk indicates that I may have misunderstood your question.

Perhaps this will help.

http://quantitative-ecology.blogspot.com/2008/11/call-c-from-r-and-r-from-c.html

If you need further help, please provide a minimal self-contained example
of what you're trying to do.

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jmc at r-project.org  Mon Nov 22 18:25:29 2010
From: jmc at r-project.org (John Chambers)
Date: Mon, 22 Nov 2010 09:25:29 -0800
Subject: [Rd] R5 reference classes: how to initialize exactly?
In-Reply-To: <871D8A34-EF70-4D85-939D-8F9B602B013A@stat.ubc.ca>
References: <005b01cb851d$16a21d60$43e65820$@thyson@ku-eichstaett.de>	<F69C1FF5-B769-4FAB-9807-7862001C4504@r-project.org>	<003001cb8643$bd85bb60$38913220$@thyson@ku-eichstaett.de>
	<871D8A34-EF70-4D85-939D-8F9B602B013A@stat.ubc.ca>
Message-ID: <4CEAA789.409@r-project.org>

As I posted previously in this same thread, reference classes are _not_ 
an addition to S4, but provide an interface to the "classical" OOP 
programming model in R, via environments and tools for those (and, also, 
via some S4 techniques).  The current version of the Rcpp package 
illustrates how they can be used in an interface, to C++.

There has been more than enough confusion already between the S and R 
version of OOP (which I'm calling "functional classes and methods" these 
days) and the C++/Java/... version.

Please just refer to "R reference classes" or words to that effect.

John

On 11/22/10 8:54 AM, Davor Cubranic wrote:
>>> Just a clarification for posterity - R5 has nothing to do with the new
>>> reference classes. It's not even an official name, but informally it's a
>>> collection of ideas for an entirely new object system that can replace
>>> both S3 and S4 (not that it will but it should be seen as having the
>>> capability to do so technically). Reference classes are just an addition
>>> to S4.
>>>
>>> Cheers,
>>> Simon
>>
>> Thanks for that clarification. I picked that name up from the Google
>> TechTalks presentation of Dirk and Romain. So I refer to them as S4
>> reference classes in future posts?
>>
>
> Or just R15S for brevity. :-)
>
> Davor
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jmc at r-project.org  Mon Nov 22 18:37:25 2010
From: jmc at r-project.org (John Chambers)
Date: Mon, 22 Nov 2010 09:37:25 -0800
Subject: [Rd] Ref classes: can I register fields as I register methods?
In-Reply-To: <005d01cb89ca$08f78770$1ae69650$@thyson@ku-eichstaett.de>
References: <005d01cb89ca$08f78770$1ae69650$@thyson@ku-eichstaett.de>
Message-ID: <4CEAAA55.4030906@r-project.org>

Well, it's an interesting idea, and the current implementation would fit 
with it.

One catch is that it goes against any obvious notion of checking for 
valid objects (admittedly, there are some difficulties in that already 
with active bindings being used).

Another issue is that in normal R programming practice, your "template" 
class would be in a package, in a namespace, and therefore locked. 
Conceptually at least, one would not be allowed to modify that definition.

Both these issues would be solved by using subclasses for the 
extensions, which seems more in the spirit of R.  Seems like you could 
hide the subclass details from your users if you wanted to.

So, something to think about, but the use case isn't convincing yet.

John

On 11/21/10 2:18 PM, Janko Thyson wrote:
> Hi there,
>
>
>
> is it possible to register fields as you can register methods with
> getRefClass("Classname")$methods(.)?
>
>
>
> I know that you should usually give some thought on which fields you need
> and hardcode them in the class def. But I'm playing around with dynamically
> creating/extending sort of a template class that already offers basic
> functionality shared by all objects that "inherit" from that class. If I
> follow the usual inheritance paradigm I would have to actually define those
> new "subclasses" and let them inherit from the superclass (contains
> argument(, right? But can I get around that by sort of registering new
> fields? Maybe with 'initFields(.)'?
>
>
>
> Thanks for any info on that,
>
> Janko
>
>
>
> ##### SYSTEM INFO #####
>
> Windows XP SP3
>
> R 2.12.0
>
> Eclipse 3.6.1 (Helios)
>
> StatET 0.9.1
>
> #####################
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jmc at r-project.org  Mon Nov 22 18:50:37 2010
From: jmc at r-project.org (John Chambers)
Date: Mon, 22 Nov 2010 09:50:37 -0800
Subject: [Rd] reference classes: question on inheritance
In-Reply-To: <006401cb89d5$888ad3b0$99a07b10$@thyson@ku-eichstaett.de>
References: <006401cb89d5$888ad3b0$99a07b10$@thyson@ku-eichstaett.de>
Message-ID: <4CEAAD6D.1050508@r-project.org>

 >>
 >> What am I doing wrong here?

Not using a recent enough version of R probably (and not telling us what 
version you are using).

The warning (not an error) should not appear in current r-devel or 
2.12-patched. In other words, works fine for me.

John

On 11/21/10 3:40 PM, Janko Thyson wrote:
> Hmm, interesting: it's the virtual class that causes the trouble. If a
> virtual class is a ref class, everything works fine. If it's a standard S4
> class, it results in the error below.
>
> Regards,
> Janko
>
>> -----Urspr?ngliche Nachricht-----
>> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
>> Gesendet: Montag, 22. November 2010 00:31
>> An: 'r-devel at r-project. org'
>> Betreff: reference classes: question on inheritance
>>
>> Dear list,
>>
>> I have a reference class which should act as a ?generic? superclass for
>> other classes. I?ve read the respective section at ?setRefClass and put
>> the name of the superclass to the ?contains? argument of an example
>> subclass (see class defs below). Classnames are set in a way that
>> shouldn?t result in collation issues (virtual def sourced before
>> superclass def sourced before subclass). Yet, this  results in the
>> following error:
>>
>> Warnmeldung:
>> unable to find a consistent ordering of superclasses for class
>> "Shabubu": order chosen is inconsistent with the superclasses of
>> "JObject"
>>
>> ###### CLASS DEFS #####
>> setClass("JObjectVirtual")
>> setRefClass(
>> 	Class="JObject",
>> 	fields=list(
>> 		# GENERIC FIELDS (DON'T CHANGE !!!)
>> 		.BUFFER="environment",
>> 		.GENESIS="environment",
>> 		.HISTORY="environment",
>> 		.IMAGES="environment",
>> 		.LOGS="environment",
>> 		.OPTS="environment",
>> 		.PLUGINS="environment",
>> 		.TMP="environment",
>> 		.UID="character",
>> 		DATA="data.frame"
>> 		# /
>> 	),
>> 	contains=c("JObjectVirtual"),
>>   	methods=list(
>> 		...
>> 	)
>> )
>> setRefClass(
>> 	Class="Shabubu",
>> 	fields=list(
>> 		# CUSTOM FIELDS (ADAPT TO YOUR NEEDS)
>> 		a="numeric",
>> 		b="character",
>> 		c="logical",
>> 		d="data.frame",
>> 		e="matrix",
>> 		f="list",
>> 		derived.field="function"
>> 		# /
>> 	),
>> 	contains=c("JObject")
>> )
>>
>> Thanks,
>> Janko
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From tcallawa at redhat.com  Mon Nov 22 19:46:01 2010
From: tcallawa at redhat.com (Tom "spot" Callaway)
Date: Mon, 22 Nov 2010 13:46:01 -0500
Subject: [Rd] make error for R 2.13.0 (and 2.12.0)
In-Reply-To: <u1o8w18t20k.fsf@lx-chrateresearch01.citadelgroup.com>
References: <20101018003908.GA990@cs.toronto.edu>
	<4CBBF15E.6040104@gmail.com>	<4CD0420C.40604@redhat.com>
	<u1o8w18t20k.fsf@lx-chrateresearch01.citadelgroup.com>
Message-ID: <4CEABA69.1020309@redhat.com>

On 11/05/2010 07:59 AM, Johann Hibschman wrote:
> "Tom \"spot\" Callaway" <tcallawa at redhat.com> writes:
> 
>> Full build log is here:
>> http://koji.fedoraproject.org/koji/getfile?taskID=2571563&name=build.log
>>
>> Default gcc in RHEL 4 is 3.4.6-10, which has g77 rather than gfortran.
>> It looks like this code no longer compiles properly with g77.
>>
>> Thankfully, RHEL 4 also includes a copy of gcc 4.1, so I should be able
>> to work around this by using that instead.
> 
> Did you have any luck with this?  I'm also stuck on RHEL 4, also facing
> that same error, but I've not been able to find gfortran anywhere on the
> system.

Yes, I was able to get this working by installing the gcc4-gfortran and
gcc4-c++ packages on RHEL 4, and setting CC=gcc4, CXX=g++4, FC=gfortran
and F77=gfortran.

I pushed this package into EPEL (http://fedoraproject.org/wiki/EPEL), so
if you'd rather just use my builds instead of trying your own, 2.12.0 is
available now.

( For this specific update, see:
https://admin.fedoraproject.org/updates/R-2.12.0-1.el4.1 )

Thanks,

~spot


From ripley at stats.ox.ac.uk  Mon Nov 22 21:16:57 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 22 Nov 2010 20:16:57 +0000 (GMT)
Subject: [Rd] make error for R 2.13.0 (and 2.12.0)
In-Reply-To: <4CEABA69.1020309@redhat.com>
References: <20101018003908.GA990@cs.toronto.edu> <4CBBF15E.6040104@gmail.com>
	<4CD0420C.40604@redhat.com>
	<u1o8w18t20k.fsf@lx-chrateresearch01.citadelgroup.com>
	<4CEABA69.1020309@redhat.com>
Message-ID: <alpine.LFD.2.00.1011222005100.6886@gannet.stats.ox.ac.uk>

Notes:

1) We cannot reproduce this on a Solaris system using gcc/g77 3.4.6. 
(Doubled underscores are generated there by g77 and handled correctly 
in R.)  So whatever the issue really is, it is not simply that 'this 
code no longer compiles properly with g77'.

2) Package cluster has since been updated not to use underscores, so 
simply trying an R-patched tarball should solve the issue.

There may be other packages with Fortran code and underscores, so it 
would be helpful if someone with evidence of the problem could produce 
an accurate analysis and patch.

On Mon, 22 Nov 2010, Tom "spot" Callaway wrote:

> On 11/05/2010 07:59 AM, Johann Hibschman wrote:
>> "Tom \"spot\" Callaway" <tcallawa at redhat.com> writes:
>>
>>> Full build log is here:
>>> http://koji.fedoraproject.org/koji/getfile?taskID=2571563&name=build.log
>>>
>>> Default gcc in RHEL 4 is 3.4.6-10, which has g77 rather than gfortran.
>>> It looks like this code no longer compiles properly with g77.
>>>
>>> Thankfully, RHEL 4 also includes a copy of gcc 4.1, so I should be able
>>> to work around this by using that instead.
>>
>> Did you have any luck with this?  I'm also stuck on RHEL 4, also facing
>> that same error, but I've not been able to find gfortran anywhere on the
>> system.
>
> Yes, I was able to get this working by installing the gcc4-gfortran and
> gcc4-c++ packages on RHEL 4, and setting CC=gcc4, CXX=g++4, FC=gfortran
> and F77=gfortran.
>
> I pushed this package into EPEL (http://fedoraproject.org/wiki/EPEL), so
> if you'd rather just use my builds instead of trying your own, 2.12.0 is
> available now.
>
> ( For this specific update, see:
> https://admin.fedoraproject.org/updates/R-2.12.0-1.el4.1 )
>
> Thanks,
>
> ~spot
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From natemiller77 at gmail.com  Mon Nov 22 22:11:34 2010
From: natemiller77 at gmail.com (Nathan Miller)
Date: Mon, 22 Nov 2010 13:11:34 -0800
Subject: [Rd] Wait for user input with readline()
Message-ID: <AANLkTikAG_8ynt2+SP=b5WYJ2u2w5iwqit=0R_1FDsJr@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101122/4c8dcb7e/attachment.pl>

From simon.urbanek at r-project.org  Mon Nov 22 22:56:37 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 22 Nov 2010 16:56:37 -0500
Subject: [Rd] R-.12.0 atlas lapack
In-Reply-To: <201011221759.13973.lux-integ@btconnect.com>
References: <201011202235.02520.lux-integ@btconnect.com>
	<201011221759.13973.lux-integ@btconnect.com>
Message-ID: <A2F4A7D7-65A9-4316-AFC6-2B3F3B9C486E@r-project.org>


On Nov 22, 2010, at 12:59 PM, luxInteg wrote:

> On Saturday 20 November 2010 22:35:02 luxInteg wrote:
>> Greetings,
>> 
>> I last  built R-2.11.1  a few months ago.  The computer was equipped with
>> these:-
>> 
>> ---cpu amd64 2 cores
>> ---o/s cblfs 64-bit only linux kernel-2.6.32 gcc-4.4.2 jdk(1.5)-6U20?
>> ---bls atlas3.9.26  lapacck-3.2.1
>> 
>> I obtained   an installed directory of ~58Mbytes  and in the ~/lib
>> directory was  libR.so (~7.8Mbytes in size) as well as libRblas.so and
>> libRlapack.so (~2.9Mbytes).
>> 
>> I have since upgraded atlas to atlas3.9.32 and lapack to lapack-3.2.2. to
>> fulfill requirements of other numeric intensive  programs I use.  Today  I
>> compiled and installed    R-2.12.0   using the same settings used for
>> R-2.11.1 and these are my findings:-
>> 
>> {The  installed directory is ~42Mbytes  and in the ~/lib directory there is
>> but libR.so of only 2.9 mbytes.  There are no libRlapack.so nor
>> libRblas.so}
>> 
>> 
>> I would be grateful if someone culd explain   the discrepencies   between
>> the two versions of R  and what the requirements are for generating
>> linRlapack.so and libRblas.so  and/or whether these have been superceded.
>> 
>> 
>> thanks in   advance..
> 
> excerpt from /R-2.12.0/src/modules/lapack/README
> 
> (
> The Fortran routines here are extracted from LAPACK 3.1.0, then 3.1.1
> (http://www.netlib.org/lapack and mirrors).
> 
> dlapack?.f are support routines for `real' LAPACK calls
> cmplx.f are support routines for LAPACK calls from complex arithmetic
> routines, that are only used if COMPLEX*16 is supported by the Fortran
> compiler and compatible with the Rcomplex type (guaranteed for f2c users).
> Neither will not be compiled if an external LAPACK is used.
> 
> )
> 
> As I said in my original email,  I  have external atla3.9.32 and lapack-3.2.2.  
> I would be grateful to know if:-
> 
> a) libRblas.so  and libRlapack.so  are now superfluouss  AND  if hey are 

They are not superfluous - they are optional - each in a different way. libRblas is shared BLAS library - i.e., it allows you to swap the BLAS implementation without recompiling R. libRlapack is R's version of the LAPACK in case the BLAS you link against doesn't have LAPACK routines. The presence/absence of each of the above is controlled by the corresponding configure flags (and in case you use auto-detection by the availability and functionality of the BLAS you use).


> b) if one  now links libR.so  to lib{atlas,lapack}.so (or .a)
> 

You can do either -- or you can use shared BLAS - it's entirely up to you. Nothing really changed in recent R - the above applies for quite some time (ever since shared BLAS support was added) so it's very likely that any differences you see are entirely due to your setup, not due to R.

Cheers,
Simon


From janko.thyson at ku-eichstaett.de  Mon Nov 22 23:34:18 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Mon, 22 Nov 2010 23:34:18 +0100
Subject: [Rd] reference classes: question on inheritance
In-Reply-To: <4CEAAD6D.1050508@r-project.org>
References: <006401cb89d5$888ad3b0$99a07b10$@thyson@ku-eichstaett.de>
	<4CEAAD6D.1050508@r-project.org>
Message-ID: <003401cb8a95$666b9d80$3342d880$@thyson@ku-eichstaett.de>


> -----Urspr?ngliche Nachricht-----
> Von: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] Im Auftrag von John Chambers
> Gesendet: Montag, 22. November 2010 18:51
> An: r-devel at r-project.org
> Betreff: Re: [Rd] reference classes: question on inheritance
> 
>  >>
>  >> What am I doing wrong here?
> 
> Not using a recent enough version of R probably (and not telling us
> what
> version you are using).
> 
> The warning (not an error) should not appear in current r-devel or
> 2.12-patched. In other words, works fine for me.
>
> John

Thanks, I didn't even know there existed a patched build as I usually
skipped the x.x.0 versions of R.
But ref classes really seemed worth a try.

Cheers,
Janko

##### SYSTEM INFO #####
Windows XP SP3
R 2.12.0 (patched as of 2010-11-22)
Eclipse 3.6.1 (Helios)
StatET 0.9.1
#####################

> 
> On 11/21/10 3:40 PM, Janko Thyson wrote:
> > Hmm, interesting: it's the virtual class that causes the trouble. If
> a
> > virtual class is a ref class, everything works fine. If it's a
> standard S4
> > class, it results in the error below.
> >
> > Regards,
> > Janko
> >
> >> -----Urspr?ngliche Nachricht-----
> >> Von: Janko Thyson [mailto:janko.thyson at ku-eichstaett.de]
> >> Gesendet: Montag, 22. November 2010 00:31
> >> An: 'r-devel at r-project. org'
> >> Betreff: reference classes: question on inheritance
> >>
> >> Dear list,
> >>
> >> I have a reference class which should act as a ?generic? superclass
> for
> >> other classes. I?ve read the respective section at ?setRefClass and
> put
> >> the name of the superclass to the ?contains? argument of an example
> >> subclass (see class defs below). Classnames are set in a way that
> >> shouldn?t result in collation issues (virtual def sourced before
> >> superclass def sourced before subclass). Yet, this  results in the
> >> following error:
> >>
> >> Warnmeldung:
> >> unable to find a consistent ordering of superclasses for class
> >> "Shabubu": order chosen is inconsistent with the superclasses of
> >> "JObject"
> >>
> >> ###### CLASS DEFS #####
> >> setClass("JObjectVirtual")
> >> setRefClass(
> >> 	Class="JObject",
> >> 	fields=list(
> >> 		# GENERIC FIELDS (DON'T CHANGE !!!)
> >> 		.BUFFER="environment",
> >> 		.GENESIS="environment",
> >> 		.HISTORY="environment",
> >> 		.IMAGES="environment",
> >> 		.LOGS="environment",
> >> 		.OPTS="environment",
> >> 		.PLUGINS="environment",
> >> 		.TMP="environment",
> >> 		.UID="character",
> >> 		DATA="data.frame"
> >> 		# /
> >> 	),
> >> 	contains=c("JObjectVirtual"),
> >>   	methods=list(
> >> 		...
> >> 	)
> >> )
> >> setRefClass(
> >> 	Class="Shabubu",
> >> 	fields=list(
> >> 		# CUSTOM FIELDS (ADAPT TO YOUR NEEDS)
> >> 		a="numeric",
> >> 		b="character",
> >> 		c="logical",
> >> 		d="data.frame",
> >> 		e="matrix",
> >> 		f="list",
> >> 		derived.field="function"
> >> 		# /
> >> 	),
> >> 	contains=c("JObject")
> >> )
> >>
> >> Thanks,
> >> Janko
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From wjlee2002 at naver.com  Tue Nov 23 09:16:49 2010
From: wjlee2002 at naver.com (Wonjae Lee)
Date: Tue, 23 Nov 2010 00:16:49 -0800 (PST)
Subject: [Rd] How to call R from C
In-Reply-To: <962040c341597fd9c2edf38455726b66@braverock.com>
References: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
	<962040c341597fd9c2edf38455726b66@braverock.com>
Message-ID: <1290500209023-3054977.post@n4.nabble.com>


Thank you!

I tried to build a C code below, and I got a error message.
Thank you for your help in advance.

<C code>

#include "embeddedRCall.h"

int main(int argc, char *argv[])
{
    eval_R_command("print", argc, argv);
    return(0);
}
=========================================

<error message>
--------------------Configuration: Rtest - Win32 Debug--------------------
Compiling...
Rtest.c
Linking...
Rtest.obj : error LNK2001: unresolved external symbol _eval_R_command
Debug/Rtest.exe : fatal error LNK1120: 1 unresolved externals
Error executing link.exe.

Rtest.exe - 2 error(s), 0 warning(s)

-- 
View this message in context: http://r.789695.n4.nabble.com/How-to-call-R-from-C-tp3053943p3054977.html
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Tue Nov 23 13:23:44 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 23 Nov 2010 12:23:44 +0000 (GMT)
Subject: [Rd] How to call R from C
In-Reply-To: <1290500209023-3054977.post@n4.nabble.com>
References: <dd613833191d1a0251af9399334f3f51@tweb20-2.nm>
	<962040c341597fd9c2edf38455726b66@braverock.com>
	<1290500209023-3054977.post@n4.nabble.com>
Message-ID: <alpine.LFD.2.00.1011231220310.23289@toucan.stats.ox.ac.uk>

On Tue, 23 Nov 2010, Wonjae Lee wrote:

>
> Thank you!
>
> I tried to build a C code below, and I got a error message.

How?: you have not shown us the commands you used.

At a guess you are
on Windows and didn't tell us (see the posting quide)
using MSVC (not supported but may work -- just don't ask us for help)
not linking against R.dll.

There are examples in the tests/Embedding directory of the R sources 
-- and they do work on Windows.

> Thank you for your help in advance.
>
> <C code>
>
> #include "embeddedRCall.h"
>
> int main(int argc, char *argv[])
> {
>    eval_R_command("print", argc, argv);
>    return(0);
> }
> =========================================
>
> <error message>
> --------------------Configuration: Rtest - Win32 Debug--------------------
> Compiling...
> Rtest.c
> Linking...
> Rtest.obj : error LNK2001: unresolved external symbol _eval_R_command
> Debug/Rtest.exe : fatal error LNK1120: 1 unresolved externals
> Error executing link.exe.
>
> Rtest.exe - 2 error(s), 0 warning(s)
>
> -- 
> View this message in context: http://r.789695.n4.nabble.com/How-to-call-R-from-C-tp3053943p3054977.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Nov 23 13:32:29 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 23 Nov 2010 12:32:29 +0000 (GMT)
Subject: [Rd] Wait for user input with readline()
In-Reply-To: <AANLkTikAG_8ynt2+SP=b5WYJ2u2w5iwqit=0R_1FDsJr@mail.gmail.com>
References: <AANLkTikAG_8ynt2+SP=b5WYJ2u2w5iwqit=0R_1FDsJr@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011231218570.23289@toucan.stats.ox.ac.uk>

What you have not done is told us how you run the script.

On Mon, 22 Nov 2010, Nathan Miller wrote:

> Hello,
>
> I am trying write a script that includes a prompt for user input using
> readlines() and was told that folks at R-devel might be able to help.

(But this is an R-help question.)

readline() and readLines() are separate functions: there is no 
readlines().

Your script is very far from self-contained, and you haven't told us 
how you run it.   Here's a working example:

toucan% cat foo.R
cat("What is the O2 saturation in umole/L? ")
foo <- scan("stdin", 0,  n=1, quiet = TRUE)
print (foo)

toucan% Rscript foo.R
What is the O2 saturation in umole/L? 45
[1] 45


> I am running into the problem that when I run readlines() as a single line
> the prompt works perfectly, but when I try to run a block of code which
> includes the readline function, the script doesn't wait for the user input.
> I have seen this question posted before when I did a search, but I didn't
> find an suitable answer. Is there a means of ensuring that the script does
> not proceed until a value has been entered to readline(). Can I put readline
> in a function that will wait for input?

But this is all based on a false assumption: ?readline says

      In non-interactive use the result is as if the response was RETURN
      and the value is ?""?.

So you cannot usefully use readline() in what most people understand 
by 'running a script', as that is 'non-interactive use'.

> Are there other options for getting user input that allow require that the
> script wait for user input?
>
> In the code I want the user to input the value for O2sat using
> O2sat=as.numeric(readline("What is the O2 saturation in umole/L?"))
>
> The problem is that when I run this entire block of code rather than running
> individual functions, the program doesn't wait for the user input and just
> continues to the next line of code. Does anyone have a work around for this
> type of problem?
>
> Thanks for your help,
>
> Nate
>
> #################
>
>
> O2sat=as.numeric(readline("What is the O2 saturation in umole/L?"))
>
> r=function(x) {
>        deltaO2=meanblank-q[2]
>        umoleO2=(deltaO2/100)*O2sat
>    }
>
> umoleO2perL=r(minO2mean)
> umolesO2consumed=umoleO2perL*Vial_vol
> names(umoleO2consumed)="umoleO2consumed"
> O2consumed=data.frame(filenames,umoleO2consumed)
> O2consumed
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From janko.thyson at ku-eichstaett.de  Tue Nov 23 14:56:09 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Tue, 23 Nov 2010 14:56:09 +0100
Subject: [Rd] [R] Catching a RCurl error?
In-Reply-To: <1896_1290518578_4CEBC031_1896_3068534_1_AANLkTikZwZJji4PGkqDCHNsh6hxah5Nun5-qZJ73QT75@mail.gmail.com>
References: <1896_1290518578_4CEBC031_1896_3068534_1_AANLkTikZwZJji4PGkqDCHNsh6hxah5Nun5-qZJ73QT75@mail.gmail.com>
Message-ID: <002d01cb8b16$2eb2eb10$8c18c130$@thyson@ku-eichstaett.de>

> -----Urspr?ngliche Nachricht-----
> Von: r-help-bounces at r-project.org [mailto:r-help-bounces at r-project.org]
> Im Auftrag von Tal Galili
> Gesendet: Dienstag, 23. November 2010 14:18
> An: r-help at r-project.org
> Betreff: [R] Catching a RCurl error?
> 
> Hi all,
> 
> I'm running a complex script which accesses the internet, and sometimes
> it
> stops with the error:
> 
> Error in curlPerform(url = url, headerfunction = header$update, curl =
> curl,
> >  :
> 
>   Failure when receiving data from the peer
> 
> 
> Is there a way to make the script "wait" longer, or not crash when this
> error happens?
> 
> (I'm wondering if this should be done in the level of tryCatch, or by
> playing with some parameter in the RCurl options)
> 
> 
> Thanks,
> Tal

That's a question that also popped up in my work. You can definitely tune
timeouts in the options (e.g. one options of interest in that respect is
CURLOPT_TIMEOUT, which I think is lowercase in the R implementation; there
are others, too; check http://curl.haxx.se/docs/manual.html and
http://curl.haxx.se/libcurl/c/libcurl-tutorial.html). 

Generally there's a lot of stuff you can specify but I haven't found a way
yet to use some sort of an "internal error control". Putting a tryCatch() or
try() wrapper around your CURL request is nice and good, but the error of
interest usually happens "inside" (or "with") the actual request which in my
case usually freezes the routine, so control is never handed back to R -->
try() was useless for me.

If you find something in that respect I'd be also very interested in your
solution

##### SYSTEM INFO #####
Windows XP SP3
R 2.12.0 (patched as of 2010-11-22)
Eclipse 3.6.1 (Helios)
StatET 0.9.x
#####################

> 
> 
> 
> ----------------Contact
> Details:-------------------------------------------------------
> Contact me: Tal.Galili at gmail.com |  972-52-7275845
> Read me: www.talgalili.com (Hebrew) | www.biostatistics.co.il (Hebrew)
> |
> www.r-statistics.com (English)
> -----------------------------------------------------------------------
> -----------------------
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.


From hb at biostat.ucsf.edu  Tue Nov 23 15:12:18 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Tue, 23 Nov 2010 06:12:18 -0800
Subject: [Rd] Possibility for memory improvement: x <- as.vector(x)
	always(?) duplicates
Message-ID: <AANLkTi=EjhOybYAkgDjpZL6wcM2XNZxgti_eBRC7PGLU@mail.gmail.com>

Hi,

I've noticed that as.vector() always allocates a new object, e.g.

> x <- 1:10;
> x <- as.vector(x);
> tracemem(x);
[1] "<0x0000000005622db8"
> x <- as.vector(x);
tracemem[0x0000000005622db8 -> 0x0000000005622ec0]: as.vector
> x <- as.vector(x);
tracemem[0x0000000005622ec0 -> 0x0000000005622f18]: as.vector
> x <- as.vector(x);
tracemem[0x0000000005622f18 -> 0x000000000561c388]: as.vector
> x <- as.vector(x);
tracemem[0x000000000561c388 -> 0x000000000561c3e0]: as.vector
>

and so on.

This also seems to be the reason for an extra copy being created in
turning a vector into a matrix or an array, e.g.

> x <- 1:10;
> tracemem(x);
[1] "<0x000000000561c750"
> x <- matrix(x, nrow=5, ncol=2);
tracemem[0x000000000561c750 -> 0x000000000561c7a8]: as.vector matrix
>

Example of how it could work (not sure if the test with is.vector() is enough):

as.vector <- function(x, mode="any") {
  if (is.vector(x)) return(x);
  base::as.vector(x);
} # as.vector()

matrix <- base::matrix;
environment(matrix) <- globalenv();

> x <- 1:10;
> tracemem(x);
[1] "<0x0000000003965488"
> x <- matrix(x, nrow=5, ncol=2);
>

Could this be generic improvement?  Some years ago there similar
improvements where done for as.integer(), as.numeric() etc.

This is on R v2.12.0 patched (2010-11-09 r53543) and R v2.13.0 devel
(2010-11-20 r53645) on Windows 7 Ultimate.

/Henrik


From janko.thyson at ku-eichstaett.de  Tue Nov 23 22:11:47 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Tue, 23 Nov 2010 22:11:47 +0100
Subject: [Rd] Reference Classes: removing methods -> implications for
	objects/instances of that class
Message-ID: <006a01cb8b53$0b9ac570$22d05050$@thyson@ku-eichstaett.de>

Dear list,

just to make sure that I understand 'unregistering' methods for S4 reference
classes correctly:

If I registered a method and want to 'unregister' (i.e. remove) this method
again, objects/instance created of the respective class still feature the
removed method until I do an explicit reassign ('my.instance <-
getRefClass("Classname")$new()'), right? 

setRefClass("Shab", fields=list(a="numeric"))
# Register method
getRefClass("Shab")$methods(list(aSquare=function() a^2))
getRefClass("Shab")$methods()

# Create instance
shab    <- getRefClass("Shab")$new()
shab$a  <- 10
# Use method
shab$aSquare()

# Remove method
getRefClass("Shab")$methods(list(aSquare=NULL))
getRefClass("Shab")$methods() 	# Gone.
shab$aSquare() 				# Still possible

shab    <- getRefClass("Shab")$new()
shab$aSquare() 				# Not possible anymore

Is it also possible to remove a method so that all instances do not feature
the respective method anymore without having to resort to an explicit
reassign? Or is this technically not possible or not a desired feature? 

TIA,
Janko

########## SYSTEM INFO ##########
Windows XP SP3
R 2.12.0 (patched as of 2010-11-22)
Eclipse 3.6.1 (Helios)
StatET 0.9.x
###############################


From marcelodamasceno at gmail.com  Wed Nov 24 03:23:43 2010
From: marcelodamasceno at gmail.com (Marcelo Damasceno de Melo)
Date: Tue, 23 Nov 2010 18:23:43 -0800 (PST)
Subject: [Rd] Marcelo Damasceno de Melo wants to stay in touch on LinkedIn
Message-ID: <1370357023.2818544.1290565423719.JavaMail.app@ech3-cdn06.prod>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101123/70a35e50/attachment.pl>

From czucz at botanika.hu  Wed Nov 24 09:02:53 2010
From: czucz at botanika.hu (=?ISO-8859-1?B?QuFsaW50IEN6+mN6?=)
Date: Wed, 24 Nov 2010 09:02:53 +0100
Subject: [Rd] Plotting an agnes tree with images instead of labels?
In-Reply-To: <1289941393629-3045682.post@n4.nabble.com>
References: <1289941393629-3045682.post@n4.nabble.com>
Message-ID: <AANLkTikgA_c+VeSnQ=8aCtFkM2JhpX_M_y3sZ+_-ExJX@mail.gmail.com>

Hi Darfunkel,
It is not agnes, but similar plots can be achieved using ctree() and
plot.BinaryTree() in package party.
FWIW.
B?lint

--
B?lint Cz?cz
Institute of Ecology and Botany of the Hungarian Academy of Sciences
H-2163 V?cr?t?t, Alkotm?ny u. 2-4. HUNGARY
Tel: +36 28 360122/137? +36 70 7034692


On Tue, Nov 16, 2010 at 22:03, darfunkel <diegosaldana87 at gmail.com> wrote:
>
> Hi,
>
> I'd like to plot a tree with images of molecular structures instead of
> labels (words). I think this is possible because someone who worked in my
> office before I arrived did this. However I'm not sure if this person made
> the image manually or plotted it only with R.
>
> Thanks in advance for your help.
> --
> View this message in context: http://r.789695.n4.nabble.com/Plotting-an-agnes-tree-with-images-instead-of-labels-tp3045682p3045682.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From janko.thyson at ku-eichstaett.de  Wed Nov 24 10:47:40 2010
From: janko.thyson at ku-eichstaett.de (Janko Thyson)
Date: Wed, 24 Nov 2010 10:47:40 +0100
Subject: [Rd] Reference Classes: how to clone/copy instances?
Message-ID: <009601cb8bbc$a288d4e0$e79a7ea0$@thyson@ku-eichstaett.de>

Dear list,

I don't know what's the correct term for this in the OOP context, but is it
possible to "clone"/copy an instance of a reference class (say 'a') so that
I get an *autonomous* second instance 'b'? Autonomous in the sense that
changes to 'a' do not affect 'b'. 

I know that this is somewhat against the pass-by-reference paradigm, but the
motive behind this is to generalize the 'undo()' functionality described in
the example of 'setRefClass()' to entire objects: I'd like to generate
"images" of my object via a '$imageAdd()" method in order to generate a
change history of the object (images are assigned to a field '.IMAGES' of
class 'environment') that I can "load()" on demand to undo changes to my
object. 

Obviously, simply assigning 'b <- a' does not work with respect to autonomy.
Nor does exporting the object via 'b <- a$export(Class="A")'.
I thought about creating a new instance b and then defining a function that
maps the field values from a to b:

b <- getRefClass("A")$new()
fieldsMap(src=a, tgt=b)

Is there already some functionality I can use?

Thanks,
Janko

########## SYSTEM INFO ##########
Windows XP SP3
R 2.12.0 (patched as of 2010-11-22)
Eclipse 3.6.1 (Helios)
StatET 0.9.x
###############################


From daniela_recchia at yahoo.com.br  Wed Nov 24 11:02:23 2010
From: daniela_recchia at yahoo.com.br (Daniela Recchia)
Date: Wed, 24 Nov 2010 02:02:23 -0800 (PST)
Subject: [Rd] nonparametric analysis of covariance
In-Reply-To: <009601cb8bbc$a288d4e0$e79a7ea0$@thyson@ku-eichstaett.de>
References: <009601cb8bbc$a288d4e0$e79a7ea0$@thyson@ku-eichstaett.de>
Message-ID: <901017.91968.qm@web112409.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101124/a516b938/attachment.pl>

From bbolker at gmail.com  Wed Nov 24 14:41:15 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 24 Nov 2010 13:41:15 +0000 (UTC)
Subject: [Rd] nonparametric analysis of covariance
References: <009601cb8bbc$a288d4e0$e79a7ea0$@thyson@ku-eichstaett.de>
	<901017.91968.qm@web112409.mail.gq1.yahoo.com>
Message-ID: <loom.20101124T143806-333@post.gmane.org>

Daniela Recchia <daniela_recchia <at> yahoo.com.br> writes:

> I want to do a nonparametric covariance analysis and I have tried to use
>  the package "sm" function "sm.ancova" but it didn't work for me
> because I have more then one covariates (I have 18 covariates and
> 3 factors).

 [snip snip]

  Wrong list: this is a question for R-help, not R-devel. I don't know 
if they apply, but you might find something useful in the 'vegan' package
(permanova, adonis) although I don't know if they apply to your case.

  (I also hope you have a large data set, at least hundreds of data points.)

  If that doesn't work, please try your question again on R-help.

  Ben Bolker


From you at ifn-magdeburg.de  Wed Nov 24 13:06:53 2010
From: you at ifn-magdeburg.de (Wonsang You)
Date: Wed, 24 Nov 2010 04:06:53 -0800 (PST)
Subject: [Rd] installing RMySQL (PR#13633)
In-Reply-To: <20090331043011.D20E92832183@mail.pubhealth.ku.dk>
References: <20090331043011.D20E92832183@mail.pubhealth.ku.dk>
Message-ID: <1290600413141-3057139.post@n4.nabble.com>


I guess that you already solved the error in installing the R package RMySQL.
Recently, I also suffered from the same problem in Ubuntu 10.10. I would
like to report my solution.

I just installed a linux package "libmysqlclient-dev" which contains MySQL
database development files and headers. Then, I attempted to install the
RMySQL package again, and there was no error.



ankhee dutta wrote:
> 
> Full_Name: Ankhee Dutta
> Version: 2.3
> OS: LINUX
> Submission from: (NULL) (202.141.12.97)
> 
> 
> 
> 
> I have a linux system of Mandriva-2007 with R version 2.3.0 and MySQL with
> 5.0.0. I have also got DBI-R database interface version-0.1-11 installed
> on
> my Linux system.While installing RMySQL package version 0.5-11 i am 
> facing
>  problem .
> 
> while installation the error report which is coming is as follows:
> 
> 
> 
> * Installing *source* package 'RMySQL' ...
> creating cache ./config.cache
> checking how to run the C preprocessor... cc -E
> checking for compress in -lz... yes
> checking for getopt_long in -lc... yes
> checking for mysql_init in -lmysqlclient... no
> checking for mysql.h... no
> checking for mysql_init in -lmysqlclient... no
> checking for mysql_init in -lmysqlclient... no
> checking for mysql_init in -lmysqlclient... no
> checking for mysql_init in -lmysqlclient... no
> checking for mysql_init in -lmysqlclient... no
> checking for /usr/local/include/mysql/mysql.h... no
> checking for /usr/include/mysql/mysql.h... no
> checking for /usr/local/mysql/include/
> mysql/mysql.h... no
> checking for /opt/include/mysql/mysql.h... no
> checking for /include/mysql/mysql.h... no
> 
> Configuration error:
>  could not find the MySQL installation include and/or library
>  directories.  Manually specify the location of the MySQL
>  libraries and the header files and re-run R CMD INSTALL.
> 
> INSTRUCTIONS:
> 
> 1. Define and export the 2 shell variables PKG_CPPFLAGS and
>   PKG_LIBS to include the directory for header files (*.h)
>   and libraries, for example (using Bourne shell syntax):
> 
>      export PKG_CPPFLAGS="-I<MySQL-include-dir>"
>      export PKG_LIBS="-L<MySQL-lib-dir> -lmysqlclient"
> 
>   Re-run the R INSTALL command:
> 
>      R CMD INSTALL RMySQL_<version>.tar.gz
> 
> 2. Alternatively, you may pass the configure arguments
>      --with-mysql-dir=<base-dir> (distribution directory)
>   or
>      --with-mysql-inc=<base-inc> (where MySQL header files reside)
>      --with-mysql-lib=<base-lib> (where MySQL libraries reside)
>   in the call to R INSTALL --configure-args='...'
> 
>   R CMD INSTALL --configure-args='--with-mysql-dir=DIR'
> RMySQL_<version>.tar.gz
> 
> ERROR: configuration failed for package 'RMySQL'
> ** Removing '/usr/lib/R/library/RMySQL'
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-----
Wonsang You
Leibniz Institute for Neurobiology
-- 
View this message in context: http://r.789695.n4.nabble.com/installing-RMySQL-PR-13633-tp923014p3057139.html
Sent from the R devel mailing list archive at Nabble.com.


From edd at debian.org  Wed Nov 24 15:26:26 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 24 Nov 2010 08:26:26 -0600
Subject: [Rd] installing RMySQL (PR#13633)
In-Reply-To: <1290600413141-3057139.post@n4.nabble.com>
References: <20090331043011.D20E92832183@mail.pubhealth.ku.dk>
	<1290600413141-3057139.post@n4.nabble.com>
Message-ID: <19693.8338.257458.519365@max.nulle.part>


On 24 November 2010 at 04:06, Wonsang You wrote:
| 
| I guess that you already solved the error in installing the R package RMySQL.
| Recently, I also suffered from the same problem in Ubuntu 10.10. I would
| like to report my solution.
| 
| I just installed a linux package "libmysqlclient-dev" which contains MySQL
| database development files and headers. Then, I attempted to install the
| RMySQL package again, and there was no error.

What was wrong with

     sudo apt-get install r-cran-rmysql

that make you compile locally?

Dirk

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From ivo.welch at gmail.com  Wed Nov 24 17:18:48 2010
From: ivo.welch at gmail.com (ivo welch)
Date: Wed, 24 Nov 2010 11:18:48 -0500
Subject: [Rd] segfault interest?
Message-ID: <AANLkTikfV39Sj+E=GfGL1a8+M+DUgzrF_n+uGKoMPowY@mail.gmail.com>

in a long program, I ran into

?*** caught segfault ***
address 0xdc3f9b48, cause 'memory not mapped'
Traceback:
?1: rep.int(seq_len(nx), rep.int(rep.fac, nx))
?2: rep.int(rep.int(seq_len(nx), rep.int(rep.fac, nx)), orep)
?3: expand.grid(seq_len(nx), seq_len(ny))
?4: merge.data.frame(d, ss)
?5: merge(d, ss)
?6: valid.range(opt)
?7: eval.with.vis(expr, envir, enclos)
?8: eval.with.vis(ei, envir)
?9: source("fut-into-opts.R")
Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace


I am pretty sure that I can program around it (and it is probably
caused by my writing some error), but because it is replicable, I just
wanted to learn if anyone is interested.  oh---the program is pure R
code, nothing special (like linked in C code or stuff like this).  the
error occurs on OSX.  if there is interest, please email me and let me
know what would be most useful to supply.  if not, fine, too.

regards,

/iaw
----
Ivo Welch (ivo.welch at brown.edu, ivo.welch at gmail.com)


From murdoch.duncan at gmail.com  Wed Nov 24 17:26:13 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 24 Nov 2010 11:26:13 -0500
Subject: [Rd] segfault interest?
In-Reply-To: <AANLkTikfV39Sj+E=GfGL1a8+M+DUgzrF_n+uGKoMPowY@mail.gmail.com>
References: <AANLkTikfV39Sj+E=GfGL1a8+M+DUgzrF_n+uGKoMPowY@mail.gmail.com>
Message-ID: <4CED3CA5.605@gmail.com>

On 24/11/2010 11:18 AM, ivo welch wrote:
> in a long program, I ran into
>
>   *** caught segfault ***
> address 0xdc3f9b48, cause 'memory not mapped'
> Traceback:
>   1: rep.int(seq_len(nx), rep.int(rep.fac, nx))
>   2: rep.int(rep.int(seq_len(nx), rep.int(rep.fac, nx)), orep)
>   3: expand.grid(seq_len(nx), seq_len(ny))
>   4: merge.data.frame(d, ss)
>   5: merge(d, ss)
>   6: valid.range(opt)
>   7: eval.with.vis(expr, envir, enclos)
>   8: eval.with.vis(ei, envir)
>   9: source("fut-into-opts.R")
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
>
>
> I am pretty sure that I can program around it (and it is probably
> caused by my writing some error), but because it is replicable, I just
> wanted to learn if anyone is interested.  oh---the program is pure R
> code, nothing special (like linked in C code or stuff like this).  the
> error occurs on OSX.  if there is interest, please email me and let me
> know what would be most useful to supply.  if not, fine, too.

Yes, we're interested in segfaults that are due to bugs in R.  (If they 
require a contributed package to trigger them, then they are often bugs 
in the package, and you should start with the package maintainer.)

The general request is to simplify your code as much as possible, and 
submit a self-contained demo.  If we can't reproduce the bug, we are 
unlikely to be able to fix it, and might not even try.  See ?bug.report 
for details on what to include, but don't follow the instructions there 
for submission, because they're out of date:  go to 
https://bugs.r-project.org instead.

Duncan Murdoch

> regards,
>
> /iaw
> ----
> Ivo Welch (ivo.welch at brown.edu, ivo.welch at gmail.com)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ivo.welch at gmail.com  Wed Nov 24 18:12:31 2010
From: ivo.welch at gmail.com (ivo welch)
Date: Wed, 24 Nov 2010 12:12:31 -0500
Subject: [Rd] segfault interest?
In-Reply-To: <4CED3CA5.605@gmail.com>
References: <AANLkTikfV39Sj+E=GfGL1a8+M+DUgzrF_n+uGKoMPowY@mail.gmail.com>
	<4CED3CA5.605@gmail.com>
Message-ID: <AANLkTimfYVXRpOZZ5NAw=HaRuHzo6Bq_JPTYgccBZJp_@mail.gmail.com>

I just figured out what is happening.  The root drive (presumably OSX
virtual memory) becomes depleted.  The error message about "memory not
mapped" was a hint, too.  So, not really R's fault.  However, I wonder
whether R can be made to abort more gracefully, or at least trap the
error message and translate it into something more meaningful ("you
have run out of [virtual] memory when executing 'R statement' ").  of
course, this may not be possible at all.

/iaw


From ripley at stats.ox.ac.uk  Thu Nov 25 14:36:21 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 25 Nov 2010 13:36:21 +0000 (GMT)
Subject: [Rd] Unexpected behavior with \r in Rgui 2.12.0
In-Reply-To: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
References: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>

First, I don't think  cat(70,"\r")  has ever been useful in Rgui.
It outputs and then deletes a line: Rgui has never supported 
overwriting.  I think you really want cat('\r', i, sep="").

Second, in some circumstances in 2.12.0 only, some storage was 
discarded too early and so random characters might appear.  This has 
now been fixed, so please try a recent R-patched.

But the main problem was the expectation: there is nothing that I know 
of which says that '\r' works in the way it does in some (but not all) 
Unix terminals.

On Sun, 7 Nov 2010, Russell Pierce wrote:

> I am experiencing unexpected behavior with the command cat under
> Window GUI builds of R version 2.12.0 (it does not seem to be an issue
> in Rterm).  For example if I issue the command cat(70,"\r") I get back
> text that looks like Asian characters.  If I highlight and copy that
> text, it is the text I would regularly expect, e.g. the number 70 and
> the prompt line.  Highlighting the text changes what is shown on the
> screen, but the screen never displays the number 70.  This error is
> not idiosyncratic to 70 but happens with a fairly wide range of
> numbers.  Notably no error like this occurs when I use \n.  I use \r
> for large simulation runs when I don't want my progress to spam the
> display.
>
> e.g.
> for (i in 1:1000) {cat(i,"\r");flush.console();Sys.sleep(.100)}
>
> sessionInfo() where I first saw the problem:
> R version 2.12.0 (2010-10-15) on Windows Vista
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
>
> Also experienced here:
> R version 2.12.0 (2010-10-15) on Windows XP
> R version 2.12.0 Patched (2010-11-04 r53530) on Windows Vista
> R version 2.13.0 Under development (unstable) (2010-11-04 r53530) on
> Windows Vista
>
> But not here:
> Not under R version 2.10.1 (2009-12-14) on Windows XP
>
> If this is expected behavior would you please kindly explain it to me?
> I am not a member of this list, so please address replies both to my
> email address and (if appropriate) the list.
>
> Best,
>
> Russell Pierce
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jorismeys at gmail.com  Thu Nov 25 14:51:46 2010
From: jorismeys at gmail.com (Joris Meys)
Date: Thu, 25 Nov 2010 14:51:46 +0100
Subject: [Rd] Unexpected behavior with \r in Rgui 2.12.0
In-Reply-To: <alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>
References: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
	<alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>
Message-ID: <AANLkTimCZY1Di74=VCLRq81E52=ni48xZc2_Yj7v1VrR@mail.gmail.com>

I downloaded the latest patch today and the problem still persists.
AFAIK, "\r" can be useful to give a counter that stays in place, or is
there another way of doing that in a Windows environment?

Funny thing is : if you copy-paste the strange characters, you get the
correct counts, but you get the \n characters that seperate them as
well.

> for (i in 1:5) {cat(i,"\n\r");flush.console();Sys.sleep(.100)}

gives a series of funny characters. If you hover over them or select
them for copying, they change into other ones. If you copy-paste those
characters however, you get strangely enough:
> for (i in 1:5) {cat(i,"\n\r");flush.console();Sys.sleep(.100)}
1

2

3

4

5

>

which includes the \n character. I attached a screenshot of the signs
I have on my screen.

Cheers
Joris


On Thu, Nov 25, 2010 at 2:36 PM, Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
> First, I don't think ?cat(70,"\r") ?has ever been useful in Rgui.
> It outputs and then deletes a line: Rgui has never supported overwriting. ?I
> think you really want cat('\r', i, sep="").
>
> Second, in some circumstances in 2.12.0 only, some storage was discarded too
> early and so random characters might appear. ?This has now been fixed, so
> please try a recent R-patched.
>
> But the main problem was the expectation: there is nothing that I know of
> which says that '\r' works in the way it does in some (but not all) Unix
> terminals.
>
> On Sun, 7 Nov 2010, Russell Pierce wrote:
>
>> I am experiencing unexpected behavior with the command cat under
>> Window GUI builds of R version 2.12.0 (it does not seem to be an issue
>> in Rterm). ?For example if I issue the command cat(70,"\r") I get back
>> text that looks like Asian characters. ?If I highlight and copy that
>> text, it is the text I would regularly expect, e.g. the number 70 and
>> the prompt line. ?Highlighting the text changes what is shown on the
>> screen, but the screen never displays the number 70. ?This error is
>> not idiosyncratic to 70 but happens with a fairly wide range of
>> numbers. ?Notably no error like this occurs when I use \n. ?I use \r
>> for large simulation runs when I don't want my progress to spam the
>> display.
>>
>> e.g.
>> for (i in 1:1000) {cat(i,"\r");flush.console();Sys.sleep(.100)}
>>
>> sessionInfo() where I first saw the problem:
>> R version 2.12.0 (2010-10-15) on Windows Vista
>> Platform: i386-pc-mingw32/i386 (32-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
>>
>> Also experienced here:
>> R version 2.12.0 (2010-10-15) on Windows XP
>> R version 2.12.0 Patched (2010-11-04 r53530) on Windows Vista
>> R version 2.13.0 Under development (unstable) (2010-11-04 r53530) on
>> Windows Vista
>>
>> But not here:
>> Not under R version 2.10.1 (2009-12-14) on Windows XP
>>
>> If this is expected behavior would you please kindly explain it to me?
>> I am not a member of this list, so please address replies both to my
>> email address and (if appropriate) the list.
>>
>> Best,
>>
>> Russell Pierce
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Applied mathematics, biometrics and process control

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rsymbols.png
Type: image/png
Size: 6984 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101125/7628df26/attachment.png>

From jmc at r-project.org  Thu Nov 25 18:05:37 2010
From: jmc at r-project.org (John Chambers)
Date: Thu, 25 Nov 2010 09:05:37 -0800
Subject: [Rd] Reference Classes: how to clone/copy instances?
In-Reply-To: <009601cb8bbc$a288d4e0$e79a7ea0$@thyson@ku-eichstaett.de>
References: <009601cb8bbc$a288d4e0$e79a7ea0$@thyson@ku-eichstaett.de>
Message-ID: <4CEE9761.8020705@r-project.org>

No reference class method explicitly does this, but it's a natural 
utility. Some form of $copy() will be added.  It needs a shallow/deep 
option; i.e., if a field is itself a reference class object, should that 
field be cloned as well.  The full reflectance available should make a 
single method (for the "envRefClass") work generally, although classes 
with non-standard accessor functions may need to have their own method.

Any contributions or suggestions are welcome, particularly with respect 
to features from other OOP languages that should be accommodated.  Lazy 
copy would be attractive, but harder to implement.


John

On 11/24/10 1:47 AM, Janko Thyson wrote:
> Dear list,
>
> I don't know what's the correct term for this in the OOP context, but is it
> possible to "clone"/copy an instance of a reference class (say 'a') so that
> I get an *autonomous* second instance 'b'? Autonomous in the sense that
> changes to 'a' do not affect 'b'.
>
> I know that this is somewhat against the pass-by-reference paradigm, but the
> motive behind this is to generalize the 'undo()' functionality described in
> the example of 'setRefClass()' to entire objects: I'd like to generate
> "images" of my object via a '$imageAdd()" method in order to generate a
> change history of the object (images are assigned to a field '.IMAGES' of
> class 'environment') that I can "load()" on demand to undo changes to my
> object.
>
> Obviously, simply assigning 'b<- a' does not work with respect to autonomy.
> Nor does exporting the object via 'b<- a$export(Class="A")'.
> I thought about creating a new instance b and then defining a function that
> maps the field values from a to b:
>
> b<- getRefClass("A")$new()
> fieldsMap(src=a, tgt=b)
>
> Is there already some functionality I can use?
>
> Thanks,
> Janko
>
> ########## SYSTEM INFO ##########
> Windows XP SP3
> R 2.12.0 (patched as of 2010-11-22)
> Eclipse 3.6.1 (Helios)
> StatET 0.9.x
> ###############################
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From lists at revelle.net  Thu Nov 25 18:11:44 2010
From: lists at revelle.net (William Revelle)
Date: Thu, 25 Nov 2010 11:11:44 -0600
Subject: [Rd] minor typo in biplot.rd
Message-ID: <p06240807c9144816489e@[165.124.119.171]>

Dear R developers,

There is a minor typo in the documentation for biplot   (in Version 
2.12.0 as well as 2.13.0 )
"is the the dimname is NULL"  should be "if the dimname is NULL"

xlabs
A vector of character strings to label the first set of points: the 
default is to use the row dimname of x, or 1:n is the dimname is NULL.
 
if
ylabs
A vector of character strings to label the second set of points: the 
default is to use the row dimname of y, or 1:n is the dimname is NULL.
 
if
Bill


>  sessionInfo()
R version 2.13.0 Under development (unstable) (2010-11-05 r53534)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    

other attached packages:
[1] psych_1.0-93

loaded via a namespace (and not attached):
[1] tools_2.13.0
-- 
William Revelle		http://personality-project.org/revelle.html
Professor			http://personality-project.org
Department of Psychology             http://www.wcas.northwestern.edu/psych/
Northwestern University	http://www.northwestern.edu/
Use R for psychology                       http://personality-project.org/r
It is 6 minutes to midnight	http://www.thebulletin.org


From rpier001 at ucr.edu  Thu Nov 25 16:49:56 2010
From: rpier001 at ucr.edu (Russell Pierce)
Date: Thu, 25 Nov 2010 07:49:56 -0800
Subject: [Rd] Unexpected behavior with \r in Rgui 2.12.0
In-Reply-To: <AANLkTimCZY1Di74=VCLRq81E52=ni48xZc2_Yj7v1VrR@mail.gmail.com>
References: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
	<alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>
	<AANLkTimCZY1Di74=VCLRq81E52=ni48xZc2_Yj7v1VrR@mail.gmail.com>
Message-ID: <AANLkTimHe0uCjbjwsAkixJ4L9K2YYpPHchpoGq1fpRYx@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101125/afba69f4/attachment.pl>

From you at ifn-magdeburg.de  Thu Nov 25 16:55:22 2010
From: you at ifn-magdeburg.de (Wonsang You)
Date: Thu, 25 Nov 2010 16:55:22 +0100
Subject: [Rd] installing RMySQL (PR#13633)
In-Reply-To: <19693.8338.257458.519365@max.nulle.part>
References: <20090331043011.D20E92832183@mail.pubhealth.ku.dk>
	<1290600413141-3057139.post@n4.nabble.com>
	<19693.8338.257458.519365@max.nulle.part>
Message-ID: <AANLkTimJ3Fu+918CQZ6zw=XnXHvOpKqj_kJAXoam1qBT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101125/14b8d833/attachment.pl>

From hb at biostat.ucsf.edu  Thu Nov 25 19:02:31 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 25 Nov 2010 10:02:31 -0800
Subject: [Rd] Unexpected behavior with \r in Rgui 2.12.0
In-Reply-To: <AANLkTimHe0uCjbjwsAkixJ4L9K2YYpPHchpoGq1fpRYx@mail.gmail.com>
References: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
	<alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>
	<AANLkTimCZY1Di74=VCLRq81E52=ni48xZc2_Yj7v1VrR@mail.gmail.com>
	<AANLkTimHe0uCjbjwsAkixJ4L9K2YYpPHchpoGq1fpRYx@mail.gmail.com>
Message-ID: <AANLkTimC83S_pMSRgj3bNrAO9j-HbBW53EiD8y-tq+-L@mail.gmail.com>

FYI, this topic was discussed in R-help thread 'cat(), Rgui, and
support for carriage return \r...' on March 17-29, 2006:

  https://stat.ethz.ch/pipermail/r-help/2006-March/101863.html

Some modifications to Rgui's behavior was brought up and (I think)
implemented at the time.

As far as I remember, after that discussion ASCII carriage return did
indeed *move* the point/cursor to the beginning of the current line. I
remember trying it at the time, but I admit I haven't verified it in
several years now.  However, I believe that that was before Unicode
character support was introduced, and my best guess is that support
for the latter may have changed the expected behavior of carriage
return.

My $.02 on the history

/Henrik


On Thu, Nov 25, 2010 at 7:49 AM, Russell Pierce <rpier001 at ucr.edu> wrote:
> Prof. Ripley & Joris,
>
> I concur with Joris, the behavior persists in R version 2.12.0 Patched
> (2010-11-24 r53655) and ?under Windows XP. ?The current development build
> for Windows did not have an RGui at the time I wrote this.
>
> I did not realize that the functionality of "\r" to return to
> the beginning of the line in Windows was undocumented/unsupported. ??Quotes
> lists \r as carriage return without any warning that it is unsupported in
> RGui, perhaps a notice should be put in?
>
> Since "\r" is not supported, I would like to express a desire that it at
> least do something predictable. ?Certainly, it seems doubtful that
> these "strange characters" (with the copying characteristics described) is
> what a user expects. ?If "\r" is not usable under RGui perhaps it would be
> better to ignore it entirely than to parse it and return the odd output that
> I am seeing?
>
> In the RGui for Windows prior to this version "\r" returned to
> the beginning of the line without deleting the already written content.
> ?Thus cat(70,"\r") and cat("\r",70) only differed in terms of where the
> cursor was left.
>
> I started using "\r" because I had seen it in the code for txtProgressBar.
> ?The help for txtProgressBar does note that it "uses \r to return to the
> left margin ? the interpretation of carriage return is up to the terminal or
> console in which *R* is running". For Jorris' reference, in a windows
> environment there are several methods to produce keep track of progress:
> tcltk::tkProgressBar, utils::txtProgressBar , and utils::winProgressBar.
> ?None of them are as "user friendly" as cat and "\r" because you have to
> create the progress bar, increment it, then destroy it. ?If you want to
> output debugging information as well as increment a counter you need to
> tweak the title attribute as you go.
>
> Best,
>
> Russell S. Pierce
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From hb at biostat.ucsf.edu  Thu Nov 25 19:12:44 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 25 Nov 2010 10:12:44 -0800
Subject: [Rd] Unexpected behavior with \r in Rgui 2.12.0
In-Reply-To: <AANLkTimC83S_pMSRgj3bNrAO9j-HbBW53EiD8y-tq+-L@mail.gmail.com>
References: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
	<alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>
	<AANLkTimCZY1Di74=VCLRq81E52=ni48xZc2_Yj7v1VrR@mail.gmail.com>
	<AANLkTimHe0uCjbjwsAkixJ4L9K2YYpPHchpoGq1fpRYx@mail.gmail.com>
	<AANLkTimC83S_pMSRgj3bNrAO9j-HbBW53EiD8y-tq+-L@mail.gmail.com>
Message-ID: <AANLkTinuqEUfeH5_6wC9opAt8hkwwG92dPuBsGy7wOx5@mail.gmail.com>

On Thu, Nov 25, 2010 at 10:02 AM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
> FYI, this topic was discussed in R-help thread 'cat(), Rgui, and
> support for carriage return \r...' on March 17-29, 2006:
>
> ?https://stat.ethz.ch/pipermail/r-help/2006-March/101863.html
>
> Some modifications to Rgui's behavior was brought up and (I think)
> implemented at the time.
>
> As far as I remember, after that discussion ASCII carriage return did
> indeed *move* the point/cursor to the beginning of the current line. I
> remember trying it at the time, but I admit I haven't verified it in
> several years now.

[scrap]
> However, I believe that that was before Unicode
> character support was introduced, and my best guess is that support
> for the latter may have changed the expected behavior of carriage
> return.
[/scrap]

Remove that last guess of mine; know I re-read Ripley's message and
see that the displaying of odd characters was due to a bug, which was
just fixed.  It will take a couple of days before binaries of that
patched version are available on CRAN.

/Henrik

>
> My $.02 on the history
>
> /Henrik
>
>
> On Thu, Nov 25, 2010 at 7:49 AM, Russell Pierce <rpier001 at ucr.edu> wrote:
>> Prof. Ripley & Joris,
>>
>> I concur with Joris, the behavior persists in R version 2.12.0 Patched
>> (2010-11-24 r53655) and ?under Windows XP. ?The current development build
>> for Windows did not have an RGui at the time I wrote this.
>>
>> I did not realize that the functionality of "\r" to return to
>> the beginning of the line in Windows was undocumented/unsupported. ??Quotes
>> lists \r as carriage return without any warning that it is unsupported in
>> RGui, perhaps a notice should be put in?
>>
>> Since "\r" is not supported, I would like to express a desire that it at
>> least do something predictable. ?Certainly, it seems doubtful that
>> these "strange characters" (with the copying characteristics described) is
>> what a user expects. ?If "\r" is not usable under RGui perhaps it would be
>> better to ignore it entirely than to parse it and return the odd output that
>> I am seeing?
>>
>> In the RGui for Windows prior to this version "\r" returned to
>> the beginning of the line without deleting the already written content.
>> ?Thus cat(70,"\r") and cat("\r",70) only differed in terms of where the
>> cursor was left.
>>
>> I started using "\r" because I had seen it in the code for txtProgressBar.
>> ?The help for txtProgressBar does note that it "uses \r to return to the
>> left margin ? the interpretation of carriage return is up to the terminal or
>> console in which *R* is running". For Jorris' reference, in a windows
>> environment there are several methods to produce keep track of progress:
>> tcltk::tkProgressBar, utils::txtProgressBar , and utils::winProgressBar.
>> ?None of them are as "user friendly" as cat and "\r" because you have to
>> create the progress bar, increment it, then destroy it. ?If you want to
>> output debugging information as well as increment a counter you need to
>> tweak the title attribute as you go.
>>
>> Best,
>>
>> Russell S. Pierce
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From friendly at yorku.ca  Thu Nov 25 21:10:24 2010
From: friendly at yorku.ca (Michael Friendly)
Date: Thu, 25 Nov 2010 15:10:24 -0500
Subject: [Rd] Request:  kronecker to get a sep= argument
Message-ID: <4CEEC2B0.5060203@yorku.ca>

kronecker, with make.dimnames=TRUE uses a hardwired sep=":" in the line

             tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = ":")

For an application in which dimnames arise from an n-way array, where 
different dimensions have
different roles, and I would like to be able to use kronecker in the form

kronecker(A, B, make.dimnames=TRUE, sep='/')

All this requires is to change the following two lines:

kronecker <- function (X, Y, FUN = "*", make.dimnames = FALSE, sep=":" ...)
{
  ...
             tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = sep)
}


Otherwise, I have to reproduce the logic inside kronecker() in my 
application function.

-Michael

-- 
Michael Friendly     Email: friendly AT yorku DOT ca
Professor, Psychology Dept.
York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
4700 Keele Street    Web:   http://www.datavis.ca
Toronto, ONT  M3J 1P3 CANADA


From cberry at tajo.ucsd.edu  Fri Nov 26 08:14:04 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Thu, 25 Nov 2010 23:14:04 -0800
Subject: [Rd] Request:  kronecker to get a sep= argument
In-Reply-To: <4CEEC2B0.5060203@yorku.ca>
References: <4CEEC2B0.5060203@yorku.ca>
Message-ID: <Pine.LNX.4.64.1011252305130.17459@tajo.ucsd.edu>

On Thu, 25 Nov 2010, Michael Friendly wrote:

> kronecker, with make.dimnames=TRUE uses a hardwired sep=":" in the line
>
>            tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = ":")
>
> For an application in which dimnames arise from an n-way array, where 
> different dimensions have
> different roles, and I would like to be able to use kronecker in the form
>
> kronecker(A, B, make.dimnames=TRUE, sep='/')
>
> All this requires is to change the following two lines:
>
> kronecker <- function (X, Y, FUN = "*", make.dimnames = FALSE, sep=":" ...)
> {
>  ...
>            tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = sep)
> }
>
>
> Otherwise, I have to reproduce the logic inside kronecker() in my application 
> function.

Or add one line of code:

res <- kronecker(m1,m3,make.dimnames=T)
dimnames(res) <-
 	lapply( dimnames(res), sub, pattern=":", replacement="/" )

HTH,

Chuck

p.s. your suggestion could break code that others may have written like

 	kronecker( letters[1:3], diag(LETTERS[1:2]), paste, sep='*' )


>
> -Michael
>
> -- 
> Michael Friendly     Email: friendly AT yorku DOT ca
> Professor, Psychology Dept.
> York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
> 4700 Keele Street    Web:   http://www.datavis.ca
> Toronto, ONT  M3J 1P3 CANADA
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From cberry at tajo.ucsd.edu  Fri Nov 26 08:19:44 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Thu, 25 Nov 2010 23:19:44 -0800
Subject: [Rd] Request:  kronecker to get a sep= argument
In-Reply-To: <Pine.LNX.4.64.1011252305130.17459@tajo.ucsd.edu>
References: <4CEEC2B0.5060203@yorku.ca>
	<Pine.LNX.4.64.1011252305130.17459@tajo.ucsd.edu>
Message-ID: <Pine.LNX.4.64.1011252318340.17459@tajo.ucsd.edu>

On Thu, 25 Nov 2010, Charles C. Berry wrote:

> On Thu, 25 Nov 2010, Michael Friendly wrote:
>
>>  kronecker, with make.dimnames=TRUE uses a hardwired sep=":" in the line
>>
>>             tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = ":")
>>
>>  For an application in which dimnames arise from an n-way array, where
>>  different dimensions have
>>  different roles, and I would like to be able to use kronecker in the form
>>
>>  kronecker(A, B, make.dimnames=TRUE, sep='/')
>>
>>  All this requires is to change the following two lines:
>>
>>  kronecker <- function (X, Y, FUN = "*", make.dimnames = FALSE, sep=":"
>>  ...)
>>  {
>>   ...
>>             tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = sep)
>> }
>> 
>>
>>  Otherwise, I have to reproduce the logic inside kronecker() in my
>>  application function.
>
> Or add one line of code:
>
> res <- kronecker(m1,m3,make.dimnames=T)
> dimnames(res) <-
> 	 lapply( dimnames(res), sub, pattern=":", replacement="/" )
>
> HTH,
>
> Chuck
>
> p.s. your suggestion could break code that others may have written like
>
> 	kronecker( letters[1:3], diag(LETTERS[1:2]), paste, sep='*' )

make that

 	kronecker( letters[1:3], diag(LETTERS[1:2]), paste )


>
>
>>
>>  -Michael
>>
>>  --
>>  Michael Friendly     Email: friendly AT yorku DOT ca
>>  Professor, Psychology Dept.
>>  York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
>>  4700 Keele Street    Web:   http://www.datavis.ca
>>  Toronto, ONT  M3J 1P3 CANADA
>>
>>  ______________________________________________
>>  R-devel at r-project.org mailing list
>>  https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>
> Charles C. Berry                            Dept of Family/Preventive 
> Medicine
> cberry at tajo.ucsd.edu			    UC San Diego
> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From spencer.graves at structuremonitoring.com  Fri Nov 26 19:06:41 2010
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Fri, 26 Nov 2010 10:06:41 -0800
Subject: [Rd] R Tools & Vista_x64:  Problem compiling RMySQL?
Message-ID: <4CEFF731.2080605@structuremonitoring.com>

Hello:


	  What do I need to do to compile R packages (especially RMySQL) for 
the 64-bit version of R 2.12.0 under Vista_x64?


	  I upgraded to "Rtools212.exe" yesterday but immediately got errors 
from "R CMD check RMySQL_0.7-5.tar.gz".  After the first error, I 
installed it a second time, then got "undefined reference to" roughly 50 
different names beginning "mysql_";  copied below.  I see two possible 
sources for this problem:


		    (1) RTools212 may not be installed properly.


		    (2) RMySQL may be incompatible with R x64 2.12.0, especially with 
a 32-bit version of MySQL.


	  NOTE:  RMySQL worked with R2.11.1 (and MySQL 5.1.50-community server) 
before I installed R2.12.0.  I'm reasonably sure that my local 
installation of MySQL is only 32-bit.


	  What do you suggest?  I use the 32-bit version of R2.12.0?


	  Thanks,
	  Spencer
#####################################
* installing *source* package 'RMySQL' ...
checking for $MYSQL_HOME... C:/PROGRA~2/MySQL/MYSQLS~1.1/
cygwin warning:
   MS-DOS style path detected: C:/PROGRA~2/MySQL/MYSQLS~1.1/
   Preferred POSIX equivalent is: /cygdrive/c/PROGRA~2/MySQL/MYSQLS~1.1/
   CYGWIN environment variable option "nodosfilewarning" turns off this 
warning.
   Consult the user's guide for more details about POSIX paths:
     http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
** libs
Warning: this package has a non-empty 'configure.win' file,
so building only the main architecture

cygwin warning:
   MS-DOS style path detected: C:/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
   Preferred POSIX equivalent is: 
/cygdrive/c/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
   CYGWIN environment variable option "nodosfilewarning" turns off this 
warning.
   Consult the user's guide for more details about POSIX paths:
     http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include" 
-I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99 
-c RS-DBI.c -o RS-DBI.o
x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include" 
-I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99 
-c RS-MySQL.c -o RS-MySQL.o
x86_64-w64-mingw32-gcc -shared -s -static-libgcc -o RMySQL.dll tmp.def 
RS-DBI.o RS-MySQL.o C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll 
-LC:/Users/sgraves/R/R-212~1.0/bin/x64 -lR
RS-MySQL.o:RS-MySQL.c:(.text+0xb0): undefined reference to 
`mysql_more_results'
RS-MySQL.o:RS-MySQL.c:(.text+0x2c6): undefined reference to `mysql_init'
RS-MySQL.o:RS-MySQL.c:(.text+0x2d9): undefined reference to `mysql_options'
RS-MySQL.o:RS-MySQL.c:(.text+0x2ef): undefined reference to `mysql_options'
RS-MySQL.o:RS-MySQL.c:(.text+0x305): undefined reference to `mysql_options'
RS-MySQL.o:RS-MySQL.c:(.text+0x338): undefined reference to 
`mysql_real_connect'
RS-MySQL.o:RS-MySQL.c:(.text+0x399): undefined reference to `mysql_close'
RS-MySQL.o:RS-MySQL.c:(.text+0x3d1): undefined reference to `mysql_error'
RS-MySQL.o:RS-MySQL.c:(.text+0x7a2): undefined reference to `mysql_close'
RS-MySQL.o:RS-MySQL.c:(.text+0x80f): undefined reference to 
`mysql_fetch_fields'
RS-MySQL.o:RS-MySQL.c:(.text+0x823): undefined reference to 
`mysql_field_count'
RS-MySQL.o:RS-MySQL.c:(.text+0xae7): undefined reference to 
`mysql_next_result'
RS-MySQL.o:RS-MySQL.c:(.text+0xb0b): undefined reference to 
`mysql_use_result'
RS-MySQL.o:RS-MySQL.c:(.text+0xb16): undefined reference to 
`mysql_field_count'
RS-MySQL.o:RS-MySQL.c:(.text+0xbff): undefined reference to 
`mysql_affected_rows'
RS-MySQL.o:RS-MySQL.c:(.text+0xd27): undefined reference to 
`mysql_fetch_row'
RS-MySQL.o:RS-MySQL.c:(.text+0xd3d): undefined reference to 
`mysql_fetch_lengths'
RS-MySQL.o:RS-MySQL.c:(.text+0xf2e): undefined reference to `mysql_errno'
RS-MySQL.o:RS-MySQL.c:(.text+0x1093): undefined reference to `mysql_errno'
RS-MySQL.o:RS-MySQL.c:(.text+0x109e): undefined reference to `mysql_error'
RS-MySQL.o:RS-MySQL.c:(.text+0x1114): undefined reference to 
`mysql_fetch_row'
RS-MySQL.o:RS-MySQL.c:(.text+0x1121): undefined reference to 
`mysql_free_result'
RS-MySQL.o:RS-MySQL.c:(.text+0x11f0): undefined reference to `mysql_query'
RS-MySQL.o:RS-MySQL.c:(.text+0x1200): undefined reference to 
`mysql_use_result'
RS-MySQL.o:RS-MySQL.c:(.text+0x120b): undefined reference to 
`mysql_field_count'
RS-MySQL.o:RS-MySQL.c:(.text+0x128f): undefined reference to `mysql_query'
RS-MySQL.o:RS-MySQL.c:(.text+0x12ac): undefined reference to `mysql_error'
RS-MySQL.o:RS-MySQL.c:(.text+0x133c): undefined reference to 
`mysql_affected_rows'
RS-MySQL.o:RS-MySQL.c:(.text+0x1539): undefined reference to 
`mysql_get_client_info'
RS-MySQL.o:RS-MySQL.c:(.text+0x172d): undefined reference to 
`mysql_get_host_info'
RS-MySQL.o:RS-MySQL.c:(.text+0x174b): undefined reference to 
`mysql_get_server_info'
RS-MySQL.o:RS-MySQL.c:(.text+0x176d): undefined reference to 
`mysql_get_proto_info'
RS-MySQL.o:RS-MySQL.c:(.text+0x177c): undefined reference to 
`mysql_thread_id'
RS-MySQL.o:RS-MySQL.c:(.text+0x23db): undefined reference to 
`mysql_fetch_row'
RS-MySQL.o:RS-MySQL.c:(.text+0x23fd): undefined reference to `mysql_errno'
RS-MySQL.o:RS-MySQL.c:(.text+0x252a): undefined reference to 
`mysql_fetch_lengths'
RS-MySQL.o:RS-MySQL.c:(.text+0x28fd): undefined reference to 
`mysql_insert_id'
RS-MySQL.o:RS-MySQL.c:(.text+0x29cd): undefined reference to 
`mysql_real_escape_string'
RS-MySQL.o:RS-MySQL.c:(.text+0x2a7a): undefined reference to 
`mysql_get_client_info'
RS-MySQL.o:RS-MySQL.c:(.text+0x2ab8): undefined reference to 
`mysql_get_client_version'
RS-MySQL.o:RS-MySQL.c:(.text+0x2afc): undefined reference to 
`mysql_server_init'
RS-MySQL.o:RS-MySQL.c:(.text+0x2b01): undefined reference to 
`mysql_get_client_version'
RS-MySQL.o:RS-MySQL.c:(.text+0x2b29): undefined reference to 
`mysql_get_client_info'
RS-MySQL.o:RS-MySQL.c:(.text+0x2b69): undefined reference to 
`mysql_server_end'
collect2: ld returned 1 exit status
ERROR: compilation failed for package 'RMySQL'
* removing 'C:/Users/sgraves/Rpkgs/RMySQL/RMySQL.Rcheck/RMySQL'


From murdoch.duncan at gmail.com  Fri Nov 26 20:12:06 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 26 Nov 2010 14:12:06 -0500
Subject: [Rd] R Tools & Vista_x64:  Problem compiling RMySQL?
In-Reply-To: <4CEFF731.2080605@structuremonitoring.com>
References: <4CEFF731.2080605@structuremonitoring.com>
Message-ID: <4CF00686.7080601@gmail.com>

On 26/11/2010 1:06 PM, Spencer Graves wrote:
> Hello:
>
>
> 	  What do I need to do to compile R packages (especially RMySQL) for
> the 64-bit version of R 2.12.0 under Vista_x64?

The symptoms you're seeing are because the linker can't functions in

libmySQL.dll

which it is looking for in the somewhat strange path

C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll


Does that file exist?  Is it a 64 bit dll, compatible with MinGW?  Is it 
compiled under the same convention as R, where no underscores are used 
in external names?  (The latter two questions can probably be answered 
by looking at "objdump -x libmySQL.dll".  objdump.exe is distributed as 
part of the MinGW distribution in Rtools.)

Duncan Murdoch

>
> 	I upgraded to "Rtools212.exe" yesterday but immediately got errors
> from "R CMD check RMySQL_0.7-5.tar.gz".  After the first error, I
> installed it a second time, then got "undefined reference to" roughly 50
> different names beginning "mysql_";  copied below.  I see two possible
> sources for this problem:
>
>
> 		    (1) RTools212 may not be installed properly.
>
>
> 		    (2) RMySQL may be incompatible with R x64 2.12.0, especially with
> a 32-bit version of MySQL.
>
>
> 	  NOTE:  RMySQL worked with R2.11.1 (and MySQL 5.1.50-community server)
> before I installed R2.12.0.  I'm reasonably sure that my local
> installation of MySQL is only 32-bit.
>
>
> 	  What do you suggest?  I use the 32-bit version of R2.12.0?
>
>
> 	  Thanks,
> 	  Spencer
> #####################################
> * installing *source* package 'RMySQL' ...
> checking for $MYSQL_HOME... C:/PROGRA~2/MySQL/MYSQLS~1.1/
> cygwin warning:
>     MS-DOS style path detected: C:/PROGRA~2/MySQL/MYSQLS~1.1/
>     Preferred POSIX equivalent is: /cygdrive/c/PROGRA~2/MySQL/MYSQLS~1.1/
>     CYGWIN environment variable option "nodosfilewarning" turns off this
> warning.
>     Consult the user's guide for more details about POSIX paths:
>       http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
> ** libs
> Warning: this package has a non-empty 'configure.win' file,
> so building only the main architecture
>
> cygwin warning:
>     MS-DOS style path detected: C:/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
>     Preferred POSIX equivalent is:
> /cygdrive/c/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
>     CYGWIN environment variable option "nodosfilewarning" turns off this
> warning.
>     Consult the user's guide for more details about POSIX paths:
>       http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
> x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include"
> -I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99
> -c RS-DBI.c -o RS-DBI.o
> x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include"
> -I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99
> -c RS-MySQL.c -o RS-MySQL.o
> x86_64-w64-mingw32-gcc -shared -s -static-libgcc -o RMySQL.dll tmp.def
> RS-DBI.o RS-MySQL.o C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll
> -LC:/Users/sgraves/R/R-212~1.0/bin/x64 -lR
> RS-MySQL.o:RS-MySQL.c:(.text+0xb0): undefined reference to
> `mysql_more_results'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2c6): undefined reference to `mysql_init'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2d9): undefined reference to `mysql_options'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2ef): undefined reference to `mysql_options'
> RS-MySQL.o:RS-MySQL.c:(.text+0x305): undefined reference to `mysql_options'
> RS-MySQL.o:RS-MySQL.c:(.text+0x338): undefined reference to
> `mysql_real_connect'
> RS-MySQL.o:RS-MySQL.c:(.text+0x399): undefined reference to `mysql_close'
> RS-MySQL.o:RS-MySQL.c:(.text+0x3d1): undefined reference to `mysql_error'
> RS-MySQL.o:RS-MySQL.c:(.text+0x7a2): undefined reference to `mysql_close'
> RS-MySQL.o:RS-MySQL.c:(.text+0x80f): undefined reference to
> `mysql_fetch_fields'
> RS-MySQL.o:RS-MySQL.c:(.text+0x823): undefined reference to
> `mysql_field_count'
> RS-MySQL.o:RS-MySQL.c:(.text+0xae7): undefined reference to
> `mysql_next_result'
> RS-MySQL.o:RS-MySQL.c:(.text+0xb0b): undefined reference to
> `mysql_use_result'
> RS-MySQL.o:RS-MySQL.c:(.text+0xb16): undefined reference to
> `mysql_field_count'
> RS-MySQL.o:RS-MySQL.c:(.text+0xbff): undefined reference to
> `mysql_affected_rows'
> RS-MySQL.o:RS-MySQL.c:(.text+0xd27): undefined reference to
> `mysql_fetch_row'
> RS-MySQL.o:RS-MySQL.c:(.text+0xd3d): undefined reference to
> `mysql_fetch_lengths'
> RS-MySQL.o:RS-MySQL.c:(.text+0xf2e): undefined reference to `mysql_errno'
> RS-MySQL.o:RS-MySQL.c:(.text+0x1093): undefined reference to `mysql_errno'
> RS-MySQL.o:RS-MySQL.c:(.text+0x109e): undefined reference to `mysql_error'
> RS-MySQL.o:RS-MySQL.c:(.text+0x1114): undefined reference to
> `mysql_fetch_row'
> RS-MySQL.o:RS-MySQL.c:(.text+0x1121): undefined reference to
> `mysql_free_result'
> RS-MySQL.o:RS-MySQL.c:(.text+0x11f0): undefined reference to `mysql_query'
> RS-MySQL.o:RS-MySQL.c:(.text+0x1200): undefined reference to
> `mysql_use_result'
> RS-MySQL.o:RS-MySQL.c:(.text+0x120b): undefined reference to
> `mysql_field_count'
> RS-MySQL.o:RS-MySQL.c:(.text+0x128f): undefined reference to `mysql_query'
> RS-MySQL.o:RS-MySQL.c:(.text+0x12ac): undefined reference to `mysql_error'
> RS-MySQL.o:RS-MySQL.c:(.text+0x133c): undefined reference to
> `mysql_affected_rows'
> RS-MySQL.o:RS-MySQL.c:(.text+0x1539): undefined reference to
> `mysql_get_client_info'
> RS-MySQL.o:RS-MySQL.c:(.text+0x172d): undefined reference to
> `mysql_get_host_info'
> RS-MySQL.o:RS-MySQL.c:(.text+0x174b): undefined reference to
> `mysql_get_server_info'
> RS-MySQL.o:RS-MySQL.c:(.text+0x176d): undefined reference to
> `mysql_get_proto_info'
> RS-MySQL.o:RS-MySQL.c:(.text+0x177c): undefined reference to
> `mysql_thread_id'
> RS-MySQL.o:RS-MySQL.c:(.text+0x23db): undefined reference to
> `mysql_fetch_row'
> RS-MySQL.o:RS-MySQL.c:(.text+0x23fd): undefined reference to `mysql_errno'
> RS-MySQL.o:RS-MySQL.c:(.text+0x252a): undefined reference to
> `mysql_fetch_lengths'
> RS-MySQL.o:RS-MySQL.c:(.text+0x28fd): undefined reference to
> `mysql_insert_id'
> RS-MySQL.o:RS-MySQL.c:(.text+0x29cd): undefined reference to
> `mysql_real_escape_string'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2a7a): undefined reference to
> `mysql_get_client_info'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2ab8): undefined reference to
> `mysql_get_client_version'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2afc): undefined reference to
> `mysql_server_init'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2b01): undefined reference to
> `mysql_get_client_version'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2b29): undefined reference to
> `mysql_get_client_info'
> RS-MySQL.o:RS-MySQL.c:(.text+0x2b69): undefined reference to
> `mysql_server_end'
> collect2: ld returned 1 exit status
> ERROR: compilation failed for package 'RMySQL'
> * removing 'C:/Users/sgraves/Rpkgs/RMySQL/RMySQL.Rcheck/RMySQL'
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Fri Nov 26 21:44:26 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Nov 2010 20:44:26 +0000 (GMT)
Subject: [Rd] R Tools & Vista_x64:  Problem compiling RMySQL?
In-Reply-To: <4CF00686.7080601@gmail.com>
References: <4CEFF731.2080605@structuremonitoring.com>
	<4CF00686.7080601@gmail.com>
Message-ID: <alpine.LFD.2.00.1011262016290.30600@gannet.stats.ox.ac.uk>

I've removed R-sig-db.  PLEASE don't cross-post, not least because the 
R-sig-db moderator (me) ends up having to approve all the 
non-subscribed replies such as Duncan's.

On Fri, 26 Nov 2010, Duncan Murdoch wrote:

> On 26/11/2010 1:06 PM, Spencer Graves wrote:
>> Hello:
>> 
>>
>> 	  What do I need to do to compile R packages (especially RMySQL) for
>> the 64-bit version of R 2.12.0 under Vista_x64?
>
> The symptoms you're seeing are because the linker can't functions in
>
> libmySQL.dll
>
> which it is looking for in the somewhat strange path
>
> C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll
>
>
> Does that file exist?  Is it a 64 bit dll, compatible with MinGW?  Is it 
> compiled under the same convention as R, where no underscores are used in 
> external names?  (The latter two questions can probably be answered by 
> looking at "objdump -x libmySQL.dll".  objdump.exe is distributed as part of 
> the MinGW distribution in Rtools.)

For x64, you need (or at least, it is more correct to use) 
x86_64-w64-mingw32-objdump.  But I think he has pretty much told us 
that it is a 32-bit DLL.  To install RMySQL on x64 Windows you need 
the 64-bit client DLLs.  The standard MySQL installers do not allow 
you to install 32-bit and 64-bit MySQL on the same machine, but once 
you manage that, 32bit RMySQL can talk to a 64-bit MySQL server, and 
v.v.

BTW, the underscore convention does not matter for DLLs, only object 
files (.o, .a).

This does all work (I passed patches back to the maintainer so that it 
does).  I do have a bi-arch Windows install of RMySQL on my machine 
talking to a 64-bit MySQL server.  But we've had far too much 
frustration with (even very minor) MySQL version mismatches to even 
think about distributing such a build.

> Duncan Murdoch
>
>>
>> 	I upgraded to "Rtools212.exe" yesterday but immediately got errors
>> from "R CMD check RMySQL_0.7-5.tar.gz".  After the first error, I
>> installed it a second time, then got "undefined reference to" roughly 50
>> different names beginning "mysql_";  copied below.  I see two possible
>> sources for this problem:
>> 
>>
>> 		    (1) RTools212 may not be installed properly.
>> 
>>
>> 		    (2) RMySQL may be incompatible with R x64 2.12.0, 
>> especially with
>> a 32-bit version of MySQL.
>> 
>>
>> 	  NOTE:  RMySQL worked with R2.11.1 (and MySQL 5.1.50-community 
>> server)

But you failed to tell us the 'at a minimum' information we asked for 
about either version of R.  If that was i386 R, then yes, your MySQL 
is 32-bit.

>> before I installed R2.12.0.  I'm reasonably sure that my local
>> installation of MySQL is only 32-bit.
>> 
>>
>> 	  What do you suggest?  I use the 32-bit version of R2.12.0?
>> 
>>
>> 	  Thanks,
>> 	  Spencer
>> #####################################
>> * installing *source* package 'RMySQL' ...
>> checking for $MYSQL_HOME... C:/PROGRA~2/MySQL/MYSQLS~1.1/
>> cygwin warning:
>>     MS-DOS style path detected: C:/PROGRA~2/MySQL/MYSQLS~1.1/
>>     Preferred POSIX equivalent is: /cygdrive/c/PROGRA~2/MySQL/MYSQLS~1.1/
>>     CYGWIN environment variable option "nodosfilewarning" turns off this
>> warning.
>>     Consult the user's guide for more details about POSIX paths:
>>       http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
>> ** libs
>> Warning: this package has a non-empty 'configure.win' file,
>> so building only the main architecture
>> 
>> cygwin warning:
>>     MS-DOS style path detected: 
>> C:/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
>>     Preferred POSIX equivalent is:
>> /cygdrive/c/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
>>     CYGWIN environment variable option "nodosfilewarning" turns off this
>> warning.
>>     Consult the user's guide for more details about POSIX paths:
>>       http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
>> x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include"
>> -I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99
>> -c RS-DBI.c -o RS-DBI.o
>> x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include"
>> -I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99
>> -c RS-MySQL.c -o RS-MySQL.o
>> x86_64-w64-mingw32-gcc -shared -s -static-libgcc -o RMySQL.dll tmp.def
>> RS-DBI.o RS-MySQL.o C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll
>> -LC:/Users/sgraves/R/R-212~1.0/bin/x64 -lR
>> RS-MySQL.o:RS-MySQL.c:(.text+0xb0): undefined reference to
>> `mysql_more_results'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2c6): undefined reference to `mysql_init'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2d9): undefined reference to `mysql_options'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2ef): undefined reference to `mysql_options'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x305): undefined reference to `mysql_options'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x338): undefined reference to
>> `mysql_real_connect'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x399): undefined reference to `mysql_close'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x3d1): undefined reference to `mysql_error'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x7a2): undefined reference to `mysql_close'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x80f): undefined reference to
>> `mysql_fetch_fields'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x823): undefined reference to
>> `mysql_field_count'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xae7): undefined reference to
>> `mysql_next_result'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xb0b): undefined reference to
>> `mysql_use_result'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xb16): undefined reference to
>> `mysql_field_count'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xbff): undefined reference to
>> `mysql_affected_rows'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xd27): undefined reference to
>> `mysql_fetch_row'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xd3d): undefined reference to
>> `mysql_fetch_lengths'
>> RS-MySQL.o:RS-MySQL.c:(.text+0xf2e): undefined reference to `mysql_errno'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x1093): undefined reference to `mysql_errno'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x109e): undefined reference to `mysql_error'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x1114): undefined reference to
>> `mysql_fetch_row'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x1121): undefined reference to
>> `mysql_free_result'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x11f0): undefined reference to `mysql_query'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x1200): undefined reference to
>> `mysql_use_result'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x120b): undefined reference to
>> `mysql_field_count'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x128f): undefined reference to `mysql_query'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x12ac): undefined reference to `mysql_error'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x133c): undefined reference to
>> `mysql_affected_rows'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x1539): undefined reference to
>> `mysql_get_client_info'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x172d): undefined reference to
>> `mysql_get_host_info'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x174b): undefined reference to
>> `mysql_get_server_info'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x176d): undefined reference to
>> `mysql_get_proto_info'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x177c): undefined reference to
>> `mysql_thread_id'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x23db): undefined reference to
>> `mysql_fetch_row'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x23fd): undefined reference to `mysql_errno'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x252a): undefined reference to
>> `mysql_fetch_lengths'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x28fd): undefined reference to
>> `mysql_insert_id'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x29cd): undefined reference to
>> `mysql_real_escape_string'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2a7a): undefined reference to
>> `mysql_get_client_info'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2ab8): undefined reference to
>> `mysql_get_client_version'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2afc): undefined reference to
>> `mysql_server_init'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2b01): undefined reference to
>> `mysql_get_client_version'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2b29): undefined reference to
>> `mysql_get_client_info'
>> RS-MySQL.o:RS-MySQL.c:(.text+0x2b69): undefined reference to
>> `mysql_server_end'
>> collect2: ld returned 1 exit status
>> ERROR: compilation failed for package 'RMySQL'
>> * removing 'C:/Users/sgraves/Rpkgs/RMySQL/RMySQL.Rcheck/RMySQL'
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From spencer.graves at structuremonitoring.com  Fri Nov 26 22:13:11 2010
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Fri, 26 Nov 2010 13:13:11 -0800
Subject: [Rd] R Tools & Vista_x64:  Problem compiling RMySQL?
In-Reply-To: <alpine.LFD.2.00.1011262016290.30600@gannet.stats.ox.ac.uk>
References: <4CEFF731.2080605@structuremonitoring.com>
	<4CF00686.7080601@gmail.com>
	<alpine.LFD.2.00.1011262016290.30600@gannet.stats.ox.ac.uk>
Message-ID: <4CF022E7.5000402@structuremonitoring.com>

Thanks for the reminder not to cross post;  by now, I  should know better.


Thanks to Duncan for his reply, which helped convince me that I should 
compile for i386 only.  The problem seemed to disappear after I modified 
the path.


Spencer


On 11/26/2010 12:44 PM, Prof Brian Ripley wrote:
> I've removed R-sig-db.  PLEASE don't cross-post, not least because the 
> R-sig-db moderator (me) ends up having to approve all the 
> non-subscribed replies such as Duncan's.
>
> On Fri, 26 Nov 2010, Duncan Murdoch wrote:
>
>> On 26/11/2010 1:06 PM, Spencer Graves wrote:
>>> Hello:
>>>
>>>
>>>       What do I need to do to compile R packages (especially RMySQL) 
>>> for
>>> the 64-bit version of R 2.12.0 under Vista_x64?
>>
>> The symptoms you're seeing are because the linker can't functions in
>>
>> libmySQL.dll
>>
>> which it is looking for in the somewhat strange path
>>
>> C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll
>>
>>
>> Does that file exist?  Is it a 64 bit dll, compatible with MinGW?  Is 
>> it compiled under the same convention as R, where no underscores are 
>> used in external names?  (The latter two questions can probably be 
>> answered by looking at "objdump -x libmySQL.dll".  objdump.exe is 
>> distributed as part of the MinGW distribution in Rtools.)
>
> For x64, you need (or at least, it is more correct to use) 
> x86_64-w64-mingw32-objdump.  But I think he has pretty much told us 
> that it is a 32-bit DLL.  To install RMySQL on x64 Windows you need 
> the 64-bit client DLLs.  The standard MySQL installers do not allow 
> you to install 32-bit and 64-bit MySQL on the same machine, but once 
> you manage that, 32bit RMySQL can talk to a 64-bit MySQL server, and v.v.
>
> BTW, the underscore convention does not matter for DLLs, only object 
> files (.o, .a).
>
> This does all work (I passed patches back to the maintainer so that it 
> does).  I do have a bi-arch Windows install of RMySQL on my machine 
> talking to a 64-bit MySQL server.  But we've had far too much 
> frustration with (even very minor) MySQL version mismatches to even 
> think about distributing such a build.
>
>> Duncan Murdoch
>>
>>>
>>>     I upgraded to "Rtools212.exe" yesterday but immediately got errors
>>> from "R CMD check RMySQL_0.7-5.tar.gz".  After the first error, I
>>> installed it a second time, then got "undefined reference to" 
>>> roughly 50
>>> different names beginning "mysql_";  copied below.  I see two possible
>>> sources for this problem:
>>>
>>>
>>>             (1) RTools212 may not be installed properly.
>>>
>>>
>>>             (2) RMySQL may be incompatible with R x64 2.12.0, 
>>> especially with
>>> a 32-bit version of MySQL.
>>>
>>>
>>>       NOTE:  RMySQL worked with R2.11.1 (and MySQL 5.1.50-community 
>>> server)
>
> But you failed to tell us the 'at a minimum' information we asked for 
> about either version of R.  If that was i386 R, then yes, your MySQL 
> is 32-bit.
>
>>> before I installed R2.12.0.  I'm reasonably sure that my local
>>> installation of MySQL is only 32-bit.
>>>
>>>
>>>       What do you suggest?  I use the 32-bit version of R2.12.0?
>>>
>>>
>>>       Thanks,
>>>       Spencer
>>> #####################################
>>> * installing *source* package 'RMySQL' ...
>>> checking for $MYSQL_HOME... C:/PROGRA~2/MySQL/MYSQLS~1.1/
>>> cygwin warning:
>>>     MS-DOS style path detected: C:/PROGRA~2/MySQL/MYSQLS~1.1/
>>>     Preferred POSIX equivalent is: 
>>> /cygdrive/c/PROGRA~2/MySQL/MYSQLS~1.1/
>>>     CYGWIN environment variable option "nodosfilewarning" turns off 
>>> this
>>> warning.
>>>     Consult the user's guide for more details about POSIX paths:
>>>       http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
>>> ** libs
>>> Warning: this package has a non-empty 'configure.win' file,
>>> so building only the main architecture
>>>
>>> cygwin warning:
>>>     MS-DOS style path detected: 
>>> C:/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
>>>     Preferred POSIX equivalent is:
>>> /cygdrive/c/Users/sgraves/R/R-212~1.0/etc/x64/Makeconf
>>>     CYGWIN environment variable option "nodosfilewarning" turns off 
>>> this
>>> warning.
>>>     Consult the user's guide for more details about POSIX paths:
>>>       http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
>>> x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include"
>>> -I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99
>>> -c RS-DBI.c -o RS-DBI.o
>>> x86_64-w64-mingw32-gcc -I"C:/Users/sgraves/R/R-212~1.0/include"
>>> -I"C:/PROGRA~2/MySQL/MYSQLS~1.1/"/include        -O2 -Wall  -std=gnu99
>>> -c RS-MySQL.c -o RS-MySQL.o
>>> x86_64-w64-mingw32-gcc -shared -s -static-libgcc -o RMySQL.dll tmp.def
>>> RS-DBI.o RS-MySQL.o C:/PROGRA~2/MySQL/MYSQLS~1.1//bin/libmySQL.dll
>>> -LC:/Users/sgraves/R/R-212~1.0/bin/x64 -lR
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xb0): undefined reference to
>>> `mysql_more_results'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2c6): undefined reference to 
>>> `mysql_init'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2d9): undefined reference to 
>>> `mysql_options'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2ef): undefined reference to 
>>> `mysql_options'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x305): undefined reference to 
>>> `mysql_options'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x338): undefined reference to
>>> `mysql_real_connect'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x399): undefined reference to 
>>> `mysql_close'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x3d1): undefined reference to 
>>> `mysql_error'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x7a2): undefined reference to 
>>> `mysql_close'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x80f): undefined reference to
>>> `mysql_fetch_fields'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x823): undefined reference to
>>> `mysql_field_count'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xae7): undefined reference to
>>> `mysql_next_result'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xb0b): undefined reference to
>>> `mysql_use_result'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xb16): undefined reference to
>>> `mysql_field_count'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xbff): undefined reference to
>>> `mysql_affected_rows'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xd27): undefined reference to
>>> `mysql_fetch_row'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xd3d): undefined reference to
>>> `mysql_fetch_lengths'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0xf2e): undefined reference to 
>>> `mysql_errno'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x1093): undefined reference to 
>>> `mysql_errno'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x109e): undefined reference to 
>>> `mysql_error'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x1114): undefined reference to
>>> `mysql_fetch_row'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x1121): undefined reference to
>>> `mysql_free_result'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x11f0): undefined reference to 
>>> `mysql_query'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x1200): undefined reference to
>>> `mysql_use_result'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x120b): undefined reference to
>>> `mysql_field_count'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x128f): undefined reference to 
>>> `mysql_query'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x12ac): undefined reference to 
>>> `mysql_error'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x133c): undefined reference to
>>> `mysql_affected_rows'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x1539): undefined reference to
>>> `mysql_get_client_info'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x172d): undefined reference to
>>> `mysql_get_host_info'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x174b): undefined reference to
>>> `mysql_get_server_info'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x176d): undefined reference to
>>> `mysql_get_proto_info'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x177c): undefined reference to
>>> `mysql_thread_id'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x23db): undefined reference to
>>> `mysql_fetch_row'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x23fd): undefined reference to 
>>> `mysql_errno'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x252a): undefined reference to
>>> `mysql_fetch_lengths'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x28fd): undefined reference to
>>> `mysql_insert_id'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x29cd): undefined reference to
>>> `mysql_real_escape_string'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2a7a): undefined reference to
>>> `mysql_get_client_info'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2ab8): undefined reference to
>>> `mysql_get_client_version'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2afc): undefined reference to
>>> `mysql_server_init'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2b01): undefined reference to
>>> `mysql_get_client_version'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2b29): undefined reference to
>>> `mysql_get_client_info'
>>> RS-MySQL.o:RS-MySQL.c:(.text+0x2b69): undefined reference to
>>> `mysql_server_end'
>>> collect2: ld returned 1 exit status
>>> ERROR: compilation failed for package 'RMySQL'
>>> * removing 'C:/Users/sgraves/Rpkgs/RMySQL/RMySQL.Rcheck/RMySQL'
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


-- 
Spencer Graves, PE, PhD
President and Chief Operating Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567


From spinuvit.list at gmail.com  Sat Nov 27 11:13:42 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Sat, 27 Nov 2010 11:13:42 +0100
Subject: [Rd] Reference Classes: removing methods -> implications for
	objects/instances of that class
In-Reply-To: <3819.9458890178$1290546735@news.gmane.org> (Janko Thyson's
	message of "Tue, 23 Nov 2010 22:11:47 +0100")
References: <3819.9458890178$1290546735@news.gmane.org>
Message-ID: <cpn39qnm5ux.fsf@gmail.com>

"Janko Thyson" <janko.thyson at ku-eichstaett.de> writes:

> Dear list,
>
> just to make sure that I understand 'unregistering' methods for S4 reference
> classes correctly:
>
> If I registered a method and want to 'unregister' (i.e. remove) this method
> again, objects/instance created of the respective class still feature the
> removed method until I do an explicit reassign ('my.instance <-
> getRefClass("Classname")$new()'), right? 
>
> setRefClass("Shab", fields=list(a="numeric"))
> # Register method
> getRefClass("Shab")$methods(list(aSquare=function() a^2))
> getRefClass("Shab")$methods()
>
> # Create instance
> shab    <- getRefClass("Shab")$new()
> shab$a  <- 10
> # Use method
> shab$aSquare()
>
> # Remove method
> getRefClass("Shab")$methods(list(aSquare=NULL))
> getRefClass("Shab")$methods() 	# Gone.
> shab$aSquare() 				# Still possible

If I am not mistaken methods are cached in the object during the first invocation.

So, if you change the method after the method has been used with the
instance. The object will not see the change.

This can not happen with the fields though, because they can not be installed
after the generator class is defined.

>
> shab    <- getRefClass("Shab")$new()
> shab$aSquare() 				# Not possible anymore
>
> Is it also possible to remove a method so that all instances do not feature
> the respective method anymore without having to resort to an explicit
> reassign? Or is this technically not possible or not a desired feature? 
>
> TIA,
> Janko
>
> ########## SYSTEM INFO ##########
> Windows XP SP3
> R 2.12.0 (patched as of 2010-11-22)
> Eclipse 3.6.1 (Helios)
> StatET 0.9.x
> ###############################


From spinuvit.list at gmail.com  Sat Nov 27 11:58:07 2010
From: spinuvit.list at gmail.com (Vitalie S.)
Date: Sat, 27 Nov 2010 11:58:07 +0100
Subject: [Rd] Ref classes: can I register fields as I register methods?
In-Reply-To: <4CEAAA55.4030906@r-project.org> (John Chambers's message of
	"Mon, 22 Nov 2010 09:37:25 -0800")
References: <005d01cb89ca$08f78770$1ae69650$@thyson@ku-eichstaett.de>
	<4CEAAA55.4030906@r-project.org>
Message-ID: <cpny68fkp8g.fsf@gmail.com>

John Chambers <jmc at r-project.org> writes:

> Well, it's an interesting idea, and the current implementation would fit with
> it.
>
> One catch is that it goes against any obvious notion of checking for valid
> objects (admittedly, there are some difficulties in that already with active
> bindings being used).
>
> Another issue is that in normal R programming practice, your "template" class
> would be in a package, in a namespace, and therefore locked. Conceptually at
> least, one would not be allowed to modify that definition.
>
> Both these issues would be solved by using subclasses for the extensions,
> which seems more in the spirit of R.  Seems like you could hide the subclass
> details from your users if you wanted to.
>
> So, something to think about, but the use case isn't convincing yet.

Just an user opinion here.

Personally I would like to have separate interfaces for _installation_ and
_accessing_ the methods/fields. Something along the following lines.

instFields() and instMethods() would do the installation.

fields() and methods() would get or set the objects with the check for already
installed objects. For example:

fields("a","b") will return a list of fields "a" and "b", if those are installed;
error otherwise.

fields(a= 32,b= 999) will set the values of "a" and "b", if exists/ error
otherwise.

I have already implemented the above in the code required for my work, and
found it quite convenient.

Vitalie.
>
> John
>
> On 11/21/10 2:18 PM, Janko Thyson wrote:
>> Hi there,
>>
>>
>>
>> is it possible to register fields as you can register methods with
>> getRefClass("Classname")$methods(.)?
>>
>>
>>
>> I know that you should usually give some thought on which fields you need
>> and hardcode them in the class def. But I'm playing around with dynamically
>> creating/extending sort of a template class that already offers basic
>> functionality shared by all objects that "inherit" from that class. If I
>> follow the usual inheritance paradigm I would have to actually define those
>> new "subclasses" and let them inherit from the superclass (contains
>> argument(, right? But can I get around that by sort of registering new
>> fields? Maybe with 'initFields(.)'?
>>
>>
>>
>> Thanks for any info on that,
>>
>> Janko
>>
>>
>>
>> ##### SYSTEM INFO #####
>>
>> Windows XP SP3
>>
>> R 2.12.0
>>
>> Eclipse 3.6.1 (Helios)
>>
>> StatET 0.9.1
>>
>> #####################
>>
>>
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel>


From cberry at tajo.ucsd.edu  Sat Nov 27 23:58:33 2010
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Sat, 27 Nov 2010 14:58:33 -0800
Subject: [Rd] Bug in parseNamespaceFile or switch( , ... ) ?
Message-ID: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>


parseNamespaceFile() doesn't seem to detect misspelled directives. Looking 
at its code I see

 	switch(as.character(e[[1L]]),

 	<lots of args omitted here>,

 	stop(gettextf("unknown namespace directive: %s",
                 deparse(e)), call. = FALSE, domain = NA))

but this doesn't seem to function as I expect, viz. to stop with an error 
if I type a wrong directive.

Details:
> # create dummy NAMESPACE file with two bad / one good directives
> cat("blah( nada )\nblee( nil )\nexport( outDS )\n",file="NAMESPACE")
> readLines("NAMESPACE")
[1] "blah( nada )"    "blee( nil )"     "export( outDS )"
> parseNamespaceFile("",".") # now parse it
$imports
list()

$exports
[1] "outDS"

$exportPatterns
character(0)

$importClasses
list()

$importMethods
list()

$exportClasses
character(0)

$exportMethods
character(0)

$exportClassPatterns
character(0)

$dynlibs
character(0)

$nativeRoutines
list()

$S3methods
      [,1] [,2] [,3]

>

So, it picked up 'export' and ignored the other two lines.


Chuck

p.s.

> sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
>





Charles C. Berry                            Dept of Family/Preventive Medicine
cberry at tajo.ucsd.edu			    UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From murdoch.duncan at gmail.com  Sun Nov 28 00:50:55 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 27 Nov 2010 18:50:55 -0500
Subject: [Rd] Bug in parseNamespaceFile or switch( , ... ) ?
In-Reply-To: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>
References: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>
Message-ID: <4CF1995F.9020006@gmail.com>

On 27/11/2010 5:58 PM, Charles C. Berry wrote:
>
> parseNamespaceFile() doesn't seem to detect misspelled directives. Looking
> at its code I see
>
>   	switch(as.character(e[[1L]]),
>
>   	<lots of args omitted here>,
>
>   	stop(gettextf("unknown namespace directive: %s",
>                   deparse(e)), call. = FALSE, domain = NA))
>
> but this doesn't seem to function as I expect, viz. to stop with an error
> if I type a wrong directive.

You're right, there was a typo in parseNamespaceFile.  (The typo was in 
this line:

                "=", "<-" = {

This should have been

                "=" =, "<-" = {

Without the extra = sign, the "=" was taken as the default value of the 
switch, and the stop() was never reached.

Conceivably switch() should complain if it is called with more than one 
default.

Duncan Murdoch

>
> Details:
>> # create dummy NAMESPACE file with two bad / one good directives
>> cat("blah( nada )\nblee( nil )\nexport( outDS )\n",file="NAMESPACE")
>> readLines("NAMESPACE")
> [1] "blah( nada )"    "blee( nil )"     "export( outDS )"
>> parseNamespaceFile("",".") # now parse it
> $imports
> list()
>
> $exports
> [1] "outDS"
>
> $exportPatterns
> character(0)
>
> $importClasses
> list()
>
> $importMethods
> list()
>
> $exportClasses
> character(0)
>
> $exportMethods
> character(0)
>
> $exportClassPatterns
> character(0)
>
> $dynlibs
> character(0)
>
> $nativeRoutines
> list()
>
> $S3methods
>        [,1] [,2] [,3]
>
>>
>
> So, it picked up 'export' and ignored the other two lines.
>
>
> Chuck
>
> p.s.
>
>> sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>
>
>
>
>
> Charles C. Berry                            Dept of Family/Preventive Medicine
> cberry at tajo.ucsd.edu			    UC San Diego
> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Sun Nov 28 01:09:28 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 27 Nov 2010 19:09:28 -0500
Subject: [Rd] Bug in parseNamespaceFile or switch( , ... ) ?
In-Reply-To: <4CF1995F.9020006@gmail.com>
References: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>
	<4CF1995F.9020006@gmail.com>
Message-ID: <4CF19DB8.5060706@gmail.com>

On 27/11/2010 6:50 PM, Duncan Murdoch wrote:
> On 27/11/2010 5:58 PM, Charles C. Berry wrote:
>>
>> parseNamespaceFile() doesn't seem to detect misspelled directives. Looking
>> at its code I see
>>
>>    	switch(as.character(e[[1L]]),
>>
>>    	<lots of args omitted here>,
>>
>>    	stop(gettextf("unknown namespace directive: %s",
>>                    deparse(e)), call. = FALSE, domain = NA))
>>
>> but this doesn't seem to function as I expect, viz. to stop with an error
>> if I type a wrong directive.
>
> You're right, there was a typo in parseNamespaceFile.  (The typo was in
> this line:
>
>                  "=", "<-" = {
>
> This should have been
>
>                  "=" =, "<-" = {
>
> Without the extra = sign, the "=" was taken as the default value of the
> switch, and the stop() was never reached.
>
> Conceivably switch() should complain if it is called with more than one
> default.

I suspect when I fix this it's going to flush out some typos in packages 
on CRAN...

Duncan Murdoch


> Duncan Murdoch
>
>>
>> Details:
>>> # create dummy NAMESPACE file with two bad / one good directives
>>> cat("blah( nada )\nblee( nil )\nexport( outDS )\n",file="NAMESPACE")
>>> readLines("NAMESPACE")
>> [1] "blah( nada )"    "blee( nil )"     "export( outDS )"
>>> parseNamespaceFile("",".") # now parse it
>> $imports
>> list()
>>
>> $exports
>> [1] "outDS"
>>
>> $exportPatterns
>> character(0)
>>
>> $importClasses
>> list()
>>
>> $importMethods
>> list()
>>
>> $exportClasses
>> character(0)
>>
>> $exportMethods
>> character(0)
>>
>> $exportClassPatterns
>> character(0)
>>
>> $dynlibs
>> character(0)
>>
>> $nativeRoutines
>> list()
>>
>> $S3methods
>>         [,1] [,2] [,3]
>>
>>>
>>
>> So, it picked up 'export' and ignored the other two lines.
>>
>>
>> Chuck
>>
>> p.s.
>>
>>> sessionInfo()
>> R version 2.12.0 (2010-10-15)
>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>
>> locale:
>> [1] C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>
>>
>>
>>
>>
>> Charles C. Berry                            Dept of Family/Preventive Medicine
>> cberry at tajo.ucsd.edu			    UC San Diego
>> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From romain at r-enthusiasts.com  Sun Nov 28 09:45:35 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sun, 28 Nov 2010 09:45:35 +0100
Subject: [Rd] faster base::sequence
Message-ID: <4CF216AF.909@r-enthusiasts.com>

Hello,

Based on yesterday's R-help thread (help: program efficiency), and 
following Bill's suggestions, it appeared that sequence:

 > sequence
function (nvec)
unlist(lapply(nvec, seq_len))
<environment: namespace:base>

could benefit from being written in C to avoid unnecessary memory 
allocations.

I made this version using inline:

require( inline )
sequence_c <- local( {
     fx <- cfunction( signature( x = "integer"), '
         int n = length(x) ;
         int* px = INTEGER(x) ;
         int x_i, s = 0 ;
         /* error checking */
         for( int i=0; i<n; i++){
             x_i = px[i] ;
             /* this includes the check for NA */
             if( x_i <= 0 ) error( "needs non negative integer" ) ;
             s += x_i ;
         }

         SEXP res = PROTECT( allocVector( INTSXP, s ) ) ;
         int * p_res = INTEGER(res) ;
         for( int i=0; i<n; i++){
             x_i = px[i] ;
             for( int j=0; j<x_i; j++, p_res++)
                 *p_res = j+1 ;
         }
         UNPROTECT(1) ;
         return res ;
     ' )
     function( nvec ){
         fx( as.integer(nvec) )
     }
})


And here are some timings:

 > x <- 1:10000
 > system.time( a <- sequence(x ) )
utilisateur     syst?me      ?coul?
       0.191       0.108       0.298
 > system.time( b <- sequence_c(x ) )
utilisateur     syst?me      ?coul?
       0.060       0.063       0.122
 > identical( a, b )
[1] TRUE



 > system.time( for( i in 1:10000) sequence(1:10) )
utilisateur     syst?me      ?coul?
       0.119       0.000       0.119
 >
 > system.time( for( i in 1:10000) sequence_c(1:10) )
utilisateur     syst?me      ?coul?
       0.019       0.000       0.019


I would write a proper patch if someone from R-core is willing to push it.

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From ripley at stats.ox.ac.uk  Sun Nov 28 10:30:38 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Nov 2010 09:30:38 +0000 (GMT)
Subject: [Rd] faster base::sequence
In-Reply-To: <4CF216AF.909@r-enthusiasts.com>
References: <4CF216AF.909@r-enthusiasts.com>
Message-ID: <alpine.LFD.2.00.1011280925250.24961@gannet.stats.ox.ac.uk>

Is sequence used enough to warrant this?  As the help page says

      Note that ?sequence <- function(nvec) unlist(lapply(nvec,
      seq_len))? and it mainly exists in reverence to the very early
      history of R.

I regard it as unsafe to assume that NA_INTEGER will always be 
negative, and bear in mind that at some point not so far off R 
integers (or at least lengths) will need to be more than 32-bit.

On Sun, 28 Nov 2010, Romain Francois wrote:

> Hello,
>
> Based on yesterday's R-help thread (help: program efficiency), and following 
> Bill's suggestions, it appeared that sequence:
>
>> sequence
> function (nvec)
> unlist(lapply(nvec, seq_len))
> <environment: namespace:base>
>
> could benefit from being written in C to avoid unnecessary memory 
> allocations.
>
> I made this version using inline:
>
> require( inline )
> sequence_c <- local( {
>    fx <- cfunction( signature( x = "integer"), '
>        int n = length(x) ;
>        int* px = INTEGER(x) ;
>        int x_i, s = 0 ;
>        /* error checking */
>        for( int i=0; i<n; i++){
>            x_i = px[i] ;
>            /* this includes the check for NA */
>            if( x_i <= 0 ) error( "needs non negative integer" ) ;
>            s += x_i ;
>        }
>
>        SEXP res = PROTECT( allocVector( INTSXP, s ) ) ;
>        int * p_res = INTEGER(res) ;
>        for( int i=0; i<n; i++){
>            x_i = px[i] ;
>            for( int j=0; j<x_i; j++, p_res++)
>                *p_res = j+1 ;
>        }
>        UNPROTECT(1) ;
>        return res ;
>    ' )
>    function( nvec ){
>        fx( as.integer(nvec) )
>    }
> })
>
>
> And here are some timings:
>
>> x <- 1:10000
>> system.time( a <- sequence(x ) )
> utilisateur     syst?me      ?coul?
>      0.191       0.108       0.298
>> system.time( b <- sequence_c(x ) )
> utilisateur     syst?me      ?coul?
>      0.060       0.063       0.122
>> identical( a, b )
> [1] TRUE
>
>
>
>> system.time( for( i in 1:10000) sequence(1:10) )
> utilisateur     syst?me      ?coul?
>      0.119       0.000       0.119
>>
>> system.time( for( i in 1:10000) sequence_c(1:10) )
> utilisateur     syst?me      ?coul?
>      0.019       0.000       0.019
>
>
> I would write a proper patch if someone from R-core is willing to push it.
>
> Romain
>
> -- 
> Romain Francois
> Professional R Enthusiast
> +33(0) 6 28 91 30 30
> http://romainfrancois.blog.free.fr
> |- http://bit.ly/9VOd3l : ZAT! 2010
> |- http://bit.ly/c6DzuX : Impressionnism with R
> `- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From romain at r-enthusiasts.com  Sun Nov 28 10:56:47 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sun, 28 Nov 2010 10:56:47 +0100
Subject: [Rd] faster base::sequence
In-Reply-To: <alpine.LFD.2.00.1011280925250.24961@gannet.stats.ox.ac.uk>
References: <4CF216AF.909@r-enthusiasts.com>
	<alpine.LFD.2.00.1011280925250.24961@gannet.stats.ox.ac.uk>
Message-ID: <4CF2275F.8030209@r-enthusiasts.com>

Le 28/11/10 10:30, Prof Brian Ripley a ?crit :
> Is sequence used enough to warrant this? As the help page says
>
> Note that ?sequence <- function(nvec) unlist(lapply(nvec,
> seq_len))? and it mainly exists in reverence to the very early
> history of R.

I don't know. Would it be used more if it were more efficient ?

> I regard it as unsafe to assume that NA_INTEGER will always be negative,
> and bear in mind that at some point not so far off R integers (or at
> least lengths) will need to be more than 32-bit.

sure. updated and dressed up as a patch.

I've made it a .Call because I'm not really comfortable with .Internal, 
etc ...

Do you mean that I should also use something else instead of "int" and 
"int*". Is there some future proof typedef or macro for the type 
associated with INTSXP ?


> On Sun, 28 Nov 2010, Romain Francois wrote:
>
>> Hello,
>>
>> Based on yesterday's R-help thread (help: program efficiency), and
>> following Bill's suggestions, it appeared that sequence:
>>
>>> sequence
>> function (nvec)
>> unlist(lapply(nvec, seq_len))
>> <environment: namespace:base>
>>
>> could benefit from being written in C to avoid unnecessary memory
>> allocations.
>>
>> I made this version using inline:
>>
>> require( inline )
>> sequence_c <- local( {
>> fx <- cfunction( signature( x = "integer"), '
>> int n = length(x) ;
>> int* px = INTEGER(x) ;
>> int x_i, s = 0 ;
>> /* error checking */
>> for( int i=0; i<n; i++){
>> x_i = px[i] ;
>> /* this includes the check for NA */
>> if( x_i <= 0 ) error( "needs non negative integer" ) ;
>> s += x_i ;
>> }
>>
>> SEXP res = PROTECT( allocVector( INTSXP, s ) ) ;
>> int * p_res = INTEGER(res) ;
>> for( int i=0; i<n; i++){
>> x_i = px[i] ;
>> for( int j=0; j<x_i; j++, p_res++)
>> *p_res = j+1 ;
>> }
>> UNPROTECT(1) ;
>> return res ;
>> ' )
>> function( nvec ){
>> fx( as.integer(nvec) )
>> }
>> })
>>
>>
>> And here are some timings:
>>
>>> x <- 1:10000
>>> system.time( a <- sequence(x ) )
>> utilisateur syst?me ?coul?
>> 0.191 0.108 0.298
>>> system.time( b <- sequence_c(x ) )
>> utilisateur syst?me ?coul?
>> 0.060 0.063 0.122
>>> identical( a, b )
>> [1] TRUE
>>
>>
>>
>>> system.time( for( i in 1:10000) sequence(1:10) )
>> utilisateur syst?me ?coul?
>> 0.119 0.000 0.119
>>>
>>> system.time( for( i in 1:10000) sequence_c(1:10) )
>> utilisateur syst?me ?coul?
>> 0.019 0.000 0.019
>>
>>
>> I would write a proper patch if someone from R-core is willing to push
>> it.
>>
>> Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: sequence.txt
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101128/87309c20/attachment.txt>

From rpbarry at alaska.edu  Sun Nov 28 11:10:21 2010
From: rpbarry at alaska.edu (Ronald Barry)
Date: Sun, 28 Nov 2010 01:10:21 -0900
Subject: [Rd] .Rdata file in data subdirectory won't load
Message-ID: <AANLkTinN+tVh7XJtqpc521TjEnMPzxxkHaT-BWLCgrJ+@mail.gmail.com>

Greetings,
  I wanted to add a dataset to a complete R package I am working on
(the package cleanly installs and passes the R CMD check).
The data (a matrix) was saved, and the save() image dragged to the
/data folder, and is a .Rdata file.  It can be read directly using
load (see below), but now the R CMD check indicates "subdirectory data
contains no datasets" and it won't load using 'data()'.  I have read
through the R extensions manual and Leisch's tutorial, but can't find
a good hint as to what is going wrong.  I also tried this with
'polygon1'
added to the 'export' in the NAMESPACE, with no effect.

> library(latticeDensity)
> data(polygon1)
Warning message:
In data(polygon1) : data set 'polygon1' not found
> file.choose()
[1] "C:\\Documents and Settings\\Ronald Barry\\My
Documents\\latticeDensity\\data\\polygon1.Rdata"
> load( "C:\\Documents and Settings\\Ronald Barry\\My Documents\\latticeDensity\\data\\polygon1.Rdata")
> polygon1
           [,1]      [,2]
 [1,] 0.6421053 0.8132050
 [2,] 0.6845247 0.4814305
 [3,] 0.7057345 0.2858322
 [4,] 0.6696779 0.2066025
 [5,] 0.5190888 0.1892710
 [6,] 0.5445405 0.4145805
 [7,] 0.5424195 0.6275103
 [8,] 0.5233307 0.7983494
 [9,] 0.5000000 0.7983494
[10,] 0.5127258 0.5458047
[11,] 0.5042419 0.3303989
[12,] 0.4851532 0.1348006
[13,] 0.2836606 0.1843191
[14,] 0.2582090 0.3675378
[15,] 0.1733700 0.6795048
[16,] 0.3154753 0.8057772
[17,] 0.2391202 1.0162311
[18,] 0.5381775 0.9592847
[19,] 0.7333071 0.9320495
>


Thank you for any pointers.


From ripley at stats.ox.ac.uk  Sun Nov 28 11:30:02 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Nov 2010 10:30:02 +0000 (GMT)
Subject: [Rd] faster base::sequence
In-Reply-To: <4CF2275F.8030209@r-enthusiasts.com>
References: <4CF216AF.909@r-enthusiasts.com>
	<alpine.LFD.2.00.1011280925250.24961@gannet.stats.ox.ac.uk>
	<4CF2275F.8030209@r-enthusiasts.com>
Message-ID: <alpine.LFD.2.00.1011281018370.30070@gannet.stats.ox.ac.uk>

On Sun, 28 Nov 2010, Romain Francois wrote:

> Le 28/11/10 10:30, Prof Brian Ripley a ?crit :
>> Is sequence used enough to warrant this? As the help page says
>> 
>> Note that ?sequence <- function(nvec) unlist(lapply(nvec,
>> seq_len))? and it mainly exists in reverence to the very early
>> history of R.
>
> I don't know. Would it be used more if it were more efficient ?

It is for you to make a compelling case for others to do work 
(maintain changed code) for your wish.

>> I regard it as unsafe to assume that NA_INTEGER will always be negative,
>> and bear in mind that at some point not so far off R integers (or at
>> least lengths) will need to be more than 32-bit.
>
> sure. updated and dressed up as a patch.
>
> I've made it a .Call because I'm not really comfortable with .Internal, etc 
> ...

> Do you mean that I should also use something else instead of "int" and 
> "int*". Is there some future proof typedef or macro for the type associated 
> with INTSXP ?

Not yet.  I was explaining why NA_INTEGER might change.

>
>> On Sun, 28 Nov 2010, Romain Francois wrote:
>> 
>>> Hello,
>>> 
>>> Based on yesterday's R-help thread (help: program efficiency), and
>>> following Bill's suggestions, it appeared that sequence:
>>> 
>>>> sequence
>>> function (nvec)
>>> unlist(lapply(nvec, seq_len))
>>> <environment: namespace:base>
>>> 
>>> could benefit from being written in C to avoid unnecessary memory
>>> allocations.
>>> 
>>> I made this version using inline:
>>> 
>>> require( inline )
>>> sequence_c <- local( {
>>> fx <- cfunction( signature( x = "integer"), '
>>> int n = length(x) ;
>>> int* px = INTEGER(x) ;
>>> int x_i, s = 0 ;
>>> /* error checking */
>>> for( int i=0; i<n; i++){
>>> x_i = px[i] ;
>>> /* this includes the check for NA */
>>> if( x_i <= 0 ) error( "needs non negative integer" ) ;
>>> s += x_i ;
>>> }
>>> 
>>> SEXP res = PROTECT( allocVector( INTSXP, s ) ) ;
>>> int * p_res = INTEGER(res) ;
>>> for( int i=0; i<n; i++){
>>> x_i = px[i] ;
>>> for( int j=0; j<x_i; j++, p_res++)
>>> *p_res = j+1 ;
>>> }
>>> UNPROTECT(1) ;
>>> return res ;
>>> ' )
>>> function( nvec ){
>>> fx( as.integer(nvec) )
>>> }
>>> })
>>> 
>>> 
>>> And here are some timings:
>>> 
>>>> x <- 1:10000
>>>> system.time( a <- sequence(x ) )
>>> utilisateur syst?me ?coul?
>>> 0.191 0.108 0.298
>>>> system.time( b <- sequence_c(x ) )
>>> utilisateur syst?me ?coul?
>>> 0.060 0.063 0.122
>>>> identical( a, b )
>>> [1] TRUE
>>> 
>>> 
>>> 
>>>> system.time( for( i in 1:10000) sequence(1:10) )
>>> utilisateur syst?me ?coul?
>>> 0.119 0.000 0.119
>>>> 
>>>> system.time( for( i in 1:10000) sequence_c(1:10) )
>>> utilisateur syst?me ?coul?
>>> 0.019 0.000 0.019
>>> 
>>> 
>>> I would write a proper patch if someone from R-core is willing to push
>>> it.
>>> 
>>> Romain
>
> -- 
> Romain Francois
> Professional R Enthusiast
> +33(0) 6 28 91 30 30
> http://romainfrancois.blog.free.fr
> |- http://bit.ly/9VOd3l : ZAT! 2010
> |- http://bit.ly/c6DzuX : Impressionnism with R
> `- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From romain at r-enthusiasts.com  Sun Nov 28 11:44:56 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sun, 28 Nov 2010 11:44:56 +0100
Subject: [Rd] faster base::sequence
In-Reply-To: <alpine.LFD.2.00.1011281018370.30070@gannet.stats.ox.ac.uk>
References: <4CF216AF.909@r-enthusiasts.com>
	<alpine.LFD.2.00.1011280925250.24961@gannet.stats.ox.ac.uk>
	<4CF2275F.8030209@r-enthusiasts.com>
	<alpine.LFD.2.00.1011281018370.30070@gannet.stats.ox.ac.uk>
Message-ID: <4CF232A8.5030507@r-enthusiasts.com>

Le 28/11/10 11:30, Prof Brian Ripley a ?crit :
> On Sun, 28 Nov 2010, Romain Francois wrote:
>
>> Le 28/11/10 10:30, Prof Brian Ripley a ?crit :
>>> Is sequence used enough to warrant this? As the help page says
>>>
>>> Note that ?sequence <- function(nvec) unlist(lapply(nvec,
>>> seq_len))? and it mainly exists in reverence to the very early
>>> history of R.
>>
>> I don't know. Would it be used more if it were more efficient ?
>
> It is for you to make a compelling case for others to do work (maintain
> changed code) for your wish.

No trouble. The patch is there, if anyone finds it interesting or 
compelling, they will speak up I suppose.

Otherwise it is fine for me if it ends up in no man's land. I have the 
code, if I want to use it, I can squeeze it in a package.

>>> I regard it as unsafe to assume that NA_INTEGER will always be negative,
>>> and bear in mind that at some point not so far off R integers (or at
>>> least lengths) will need to be more than 32-bit.
>>
>> sure. updated and dressed up as a patch.
>>
>> I've made it a .Call because I'm not really comfortable with
>> .Internal, etc ...
>
>> Do you mean that I should also use something else instead of "int" and
>> "int*". Is there some future proof typedef or macro for the type
>> associated with INTSXP ?
>
> Not yet. I was explaining why NA_INTEGER might change.

sure. thanks for the reminder.

>>> On Sun, 28 Nov 2010, Romain Francois wrote:
>>>
>>>> Hello,
>>>>
>>>> Based on yesterday's R-help thread (help: program efficiency), and
>>>> following Bill's suggestions, it appeared that sequence:
>>>>
>>>>> sequence
>>>> function (nvec)
>>>> unlist(lapply(nvec, seq_len))
>>>> <environment: namespace:base>
>>>>
>>>> could benefit from being written in C to avoid unnecessary memory
>>>> allocations.
>>>>
>>>> I made this version using inline:
>>>>
>>>> require( inline )
>>>> sequence_c <- local( {
>>>> fx <- cfunction( signature( x = "integer"), '
>>>> int n = length(x) ;
>>>> int* px = INTEGER(x) ;
>>>> int x_i, s = 0 ;
>>>> /* error checking */
>>>> for( int i=0; i<n; i++){
>>>> x_i = px[i] ;
>>>> /* this includes the check for NA */
>>>> if( x_i <= 0 ) error( "needs non negative integer" ) ;
>>>> s += x_i ;
>>>> }
>>>>
>>>> SEXP res = PROTECT( allocVector( INTSXP, s ) ) ;
>>>> int * p_res = INTEGER(res) ;
>>>> for( int i=0; i<n; i++){
>>>> x_i = px[i] ;
>>>> for( int j=0; j<x_i; j++, p_res++)
>>>> *p_res = j+1 ;
>>>> }
>>>> UNPROTECT(1) ;
>>>> return res ;
>>>> ' )
>>>> function( nvec ){
>>>> fx( as.integer(nvec) )
>>>> }
>>>> })
>>>>
>>>>
>>>> And here are some timings:
>>>>
>>>>> x <- 1:10000
>>>>> system.time( a <- sequence(x ) )
>>>> utilisateur syst?me ?coul?
>>>> 0.191 0.108 0.298
>>>>> system.time( b <- sequence_c(x ) )
>>>> utilisateur syst?me ?coul?
>>>> 0.060 0.063 0.122
>>>>> identical( a, b )
>>>> [1] TRUE
>>>>
>>>>
>>>>
>>>>> system.time( for( i in 1:10000) sequence(1:10) )
>>>> utilisateur syst?me ?coul?
>>>> 0.119 0.000 0.119
>>>>>
>>>>> system.time( for( i in 1:10000) sequence_c(1:10) )
>>>> utilisateur syst?me ?coul?
>>>> 0.019 0.000 0.019
>>>>
>>>>
>>>> I would write a proper patch if someone from R-core is willing to push
>>>> it.
>>>>
>>>> Romain
>>
>> --
>> Romain Francois
>> Professional R Enthusiast
>> +33(0) 6 28 91 30 30
>> http://romainfrancois.blog.free.fr
>> |- http://bit.ly/9VOd3l : ZAT! 2010
>> |- http://bit.ly/c6DzuX : Impressionnism with R
>> `- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube
>>
>>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9VOd3l : ZAT! 2010
|- http://bit.ly/c6DzuX : Impressionnism with R
`- http://bit.ly/czHPM7 : Rcpp Google tech talk on youtube


From ripley at stats.ox.ac.uk  Sun Nov 28 14:27:23 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Nov 2010 13:27:23 +0000 (GMT)
Subject: [Rd] .Rdata file in data subdirectory won't load
In-Reply-To: <AANLkTinN+tVh7XJtqpc521TjEnMPzxxkHaT-BWLCgrJ+@mail.gmail.com>
References: <AANLkTinN+tVh7XJtqpc521TjEnMPzxxkHaT-BWLCgrJ+@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011281320290.9931@gannet.stats.ox.ac.uk>

It needs to be polygon1.RData, not .Rdata.  You've not actually told 
us your OS, but it looks like you imagine that R is case-insensitive 
just because Windows is.

On Sun, 28 Nov 2010, Ronald Barry wrote:

> Greetings,
>  I wanted to add a dataset to a complete R package I am working on
> (the package cleanly installs and passes the R CMD check).
> The data (a matrix) was saved, and the save() image dragged to the
> /data folder, and is a .Rdata file.  It can be read directly using
> load (see below), but now the R CMD check indicates "subdirectory data
> contains no datasets" and it won't load using 'data()'.  I have read
> through the R extensions manual and Leisch's tutorial, but can't find

Try ?data !

> a good hint as to what is going wrong.  I also tried this with
> 'polygon1'
> added to the 'export' in the NAMESPACE, with no effect.
>
>> library(latticeDensity)
>> data(polygon1)
> Warning message:
> In data(polygon1) : data set 'polygon1' not found
>> file.choose()
> [1] "C:\\Documents and Settings\\Ronald Barry\\My
> Documents\\latticeDensity\\data\\polygon1.Rdata"
>> load( "C:\\Documents and Settings\\Ronald Barry\\My Documents\\latticeDensity\\data\\polygon1.Rdata")
>> polygon1
>           [,1]      [,2]
> [1,] 0.6421053 0.8132050
> [2,] 0.6845247 0.4814305
> [3,] 0.7057345 0.2858322
> [4,] 0.6696779 0.2066025
> [5,] 0.5190888 0.1892710
> [6,] 0.5445405 0.4145805
> [7,] 0.5424195 0.6275103
> [8,] 0.5233307 0.7983494
> [9,] 0.5000000 0.7983494
> [10,] 0.5127258 0.5458047
> [11,] 0.5042419 0.3303989
> [12,] 0.4851532 0.1348006
> [13,] 0.2836606 0.1843191
> [14,] 0.2582090 0.3675378
> [15,] 0.1733700 0.6795048
> [16,] 0.3154753 0.8057772
> [17,] 0.2391202 1.0162311
> [18,] 0.5381775 0.9592847
> [19,] 0.7333071 0.9320495
>>
>
>
> Thank you for any pointers.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From kaposi.ambrus at gmail.com  Sun Nov 28 13:39:49 2010
From: kaposi.ambrus at gmail.com (Ambrus Kaposi)
Date: Sun, 28 Nov 2010 13:39:49 +0100
Subject: [Rd] package matrix dummy.cpp
Message-ID: <AANLkTikpt5e8X4RUj8Do8+CFnB6BNR59OgUzmgFCHpq8@mail.gmail.com>

Hi,

The recommended package matrix contains an empty file src/dummy.cpp
which results in using g++ instead of gcc to link Matrix.so.
What is the reason for that? Is there any difference between using g++
or gcc? (There are no other cpp files in the source)
I asked the maintainers of the package (matrix-authors at r-project.org)
3 weeks ago but haven't received any answer.
On my system (NixOS Linux distribution, http://nixos.org) I can't
compile package Matrix unless this file is deleted.

Thank you very much,
Ambrus Kaposi


From ripley at stats.ox.ac.uk  Sun Nov 28 17:00:53 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Nov 2010 16:00:53 +0000 (GMT)
Subject: [Rd] package matrix dummy.cpp
In-Reply-To: <AANLkTikpt5e8X4RUj8Do8+CFnB6BNR59OgUzmgFCHpq8@mail.gmail.com>
References: <AANLkTikpt5e8X4RUj8Do8+CFnB6BNR59OgUzmgFCHpq8@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011281557540.17922@gannet.stats.ox.ac.uk>

It is Matrix, not matrix ....

I too have corresponded with them about this.  It seems to be a legacy 
from when the package contained C++ code, and can now be deleted.

On Sun, 28 Nov 2010, Ambrus Kaposi wrote:

> Hi,
>
> The recommended package matrix contains an empty file src/dummy.cpp
> which results in using g++ instead of gcc to link Matrix.so.
> What is the reason for that? Is there any difference between using g++
> or gcc? (There are no other cpp files in the source)
> I asked the maintainers of the package (matrix-authors at r-project.org)
> 3 weeks ago but haven't received any answer.
> On my system (NixOS Linux distribution, http://nixos.org) I can't
> compile package Matrix unless this file is deleted.

Most likely you have not installed the C++ compiler (which is usually 
g++ on Linux) -- but you shouldn't need to in order to install R.

> Thank you very much,
> Ambrus Kaposi
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Sun Nov 28 18:12:47 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 28 Nov 2010 12:12:47 -0500
Subject: [Rd] switch() disallowing multiple default values Re: Bug in
 parseNamespaceFile or switch( , ... ) ?
In-Reply-To: <4CF19DB8.5060706@gmail.com>
References: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>
	<4CF1995F.9020006@gmail.com> <4CF19DB8.5060706@gmail.com>
Message-ID: <4CF28D8F.6070009@gmail.com>

I've now committed changes in R-devel and R-patched to detect cases 
where a call to switch() contains multiple unnamed alternatives.  The 
code only complains if the EXPR argument is a character string; unnamed 
alternatives are fine with numeric switching.

Adding this check turned up 3 more typos like this in the base code 
besides the one in parseNamespaceFile.  I expect it will turn up quite a 
few more in CRAN and Bioconductor packages.

Please let me know right away if you've got correct code that generates 
the warnings or errors.

Duncan Murdoch


   In R-devel they're an error, in R-patched they'll just give a warning.

On 27/11/2010 7:09 PM, Duncan Murdoch wrote:
> On 27/11/2010 6:50 PM, Duncan Murdoch wrote:
>> On 27/11/2010 5:58 PM, Charles C. Berry wrote:
>>>
>>> parseNamespaceFile() doesn't seem to detect misspelled directives. Looking
>>> at its code I see
>>>
>>>     	switch(as.character(e[[1L]]),
>>>
>>>     	<lots of args omitted here>,
>>>
>>>     	stop(gettextf("unknown namespace directive: %s",
>>>                     deparse(e)), call. = FALSE, domain = NA))
>>>
>>> but this doesn't seem to function as I expect, viz. to stop with an error
>>> if I type a wrong directive.
>>
>> You're right, there was a typo in parseNamespaceFile.  (The typo was in
>> this line:
>>
>>                   "=", "<-" = {
>>
>> This should have been
>>
>>                   "=" =, "<-" = {
>>
>> Without the extra = sign, the "=" was taken as the default value of the
>> switch, and the stop() was never reached.
>>
>> Conceivably switch() should complain if it is called with more than one
>> default.
>
> I suspect when I fix this it's going to flush out some typos in packages
> on CRAN...
>
> Duncan Murdoch
>
>
>> Duncan Murdoch
>>
>>>
>>> Details:
>>>> # create dummy NAMESPACE file with two bad / one good directives
>>>> cat("blah( nada )\nblee( nil )\nexport( outDS )\n",file="NAMESPACE")
>>>> readLines("NAMESPACE")
>>> [1] "blah( nada )"    "blee( nil )"     "export( outDS )"
>>>> parseNamespaceFile("",".") # now parse it
>>> $imports
>>> list()
>>>
>>> $exports
>>> [1] "outDS"
>>>
>>> $exportPatterns
>>> character(0)
>>>
>>> $importClasses
>>> list()
>>>
>>> $importMethods
>>> list()
>>>
>>> $exportClasses
>>> character(0)
>>>
>>> $exportMethods
>>> character(0)
>>>
>>> $exportClassPatterns
>>> character(0)
>>>
>>> $dynlibs
>>> character(0)
>>>
>>> $nativeRoutines
>>> list()
>>>
>>> $S3methods
>>>          [,1] [,2] [,3]
>>>
>>>>
>>>
>>> So, it picked up 'export' and ignored the other two lines.
>>>
>>>
>>> Chuck
>>>
>>> p.s.
>>>
>>>> sessionInfo()
>>> R version 2.12.0 (2010-10-15)
>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>>
>>> locale:
>>> [1] C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>
>>>
>>>
>>>
>>>
>>> Charles C. Berry                            Dept of Family/Preventive Medicine
>>> cberry at tajo.ucsd.edu			    UC San Diego
>>> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From ripley at stats.ox.ac.uk  Sun Nov 28 23:12:32 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Nov 2010 22:12:32 +0000 (GMT)
Subject: [Rd] switch() disallowing multiple default values Re: Bug in
 parseNamespaceFile or switch( , ... ) ?
In-Reply-To: <4CF28D8F.6070009@gmail.com>
References: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>
	<4CF1995F.9020006@gmail.com> <4CF19DB8.5060706@gmail.com>
	<4CF28D8F.6070009@gmail.com>
Message-ID: <alpine.LFD.2.00.1011282208090.27996@gannet.stats.ox.ac.uk>

On Sun, 28 Nov 2010, Duncan Murdoch wrote:

> I've now committed changes in R-devel and R-patched to detect cases where a 
> call to switch() contains multiple unnamed alternatives.  The code only 
> complains if the EXPR argument is a character string; unnamed alternatives 
> are fine with numeric switching.
>
> Adding this check turned up 3 more typos like this in the base code besides 
> the one in parseNamespaceFile.  I expect it will turn up quite a few more in 
> CRAN and Bioconductor packages.
>
> Please let me know right away if you've got correct code that generates the 
> warnings or errors.

Most of the errors seem to be of the form (here from Brobdingnag)

                    trunc  = callGeneric(as.complex(x)),,,

that is, empty arguments to switch.

>
> Duncan Murdoch
>
>
>  In R-devel they're an error, in R-patched they'll just give a warning.
>
> On 27/11/2010 7:09 PM, Duncan Murdoch wrote:
>> On 27/11/2010 6:50 PM, Duncan Murdoch wrote:
>>> On 27/11/2010 5:58 PM, Charles C. Berry wrote:
>>>> 
>>>> parseNamespaceFile() doesn't seem to detect misspelled directives. 
>>>> Looking
>>>> at its code I see
>>>>
>>>>     	switch(as.character(e[[1L]]),
>>>>
>>>>     	<lots of args omitted here>,
>>>>
>>>>     	stop(gettextf("unknown namespace directive: %s",
>>>>                     deparse(e)), call. = FALSE, domain = NA))
>>>> 
>>>> but this doesn't seem to function as I expect, viz. to stop with an error
>>>> if I type a wrong directive.
>>> 
>>> You're right, there was a typo in parseNamespaceFile.  (The typo was in
>>> this line:
>>>
>>>                   "=", "<-" = {
>>> 
>>> This should have been
>>>
>>>                   "=" =, "<-" = {
>>> 
>>> Without the extra = sign, the "=" was taken as the default value of the
>>> switch, and the stop() was never reached.
>>> 
>>> Conceivably switch() should complain if it is called with more than one
>>> default.
>> 
>> I suspect when I fix this it's going to flush out some typos in packages
>> on CRAN...
>> 
>> Duncan Murdoch
>> 
>> 
>>> Duncan Murdoch
>>> 
>>>> 
>>>> Details:
>>>>> # create dummy NAMESPACE file with two bad / one good directives
>>>>> cat("blah( nada )\nblee( nil )\nexport( outDS )\n",file="NAMESPACE")
>>>>> readLines("NAMESPACE")
>>>> [1] "blah( nada )"    "blee( nil )"     "export( outDS )"
>>>>> parseNamespaceFile("",".") # now parse it
>>>> $imports
>>>> list()
>>>> 
>>>> $exports
>>>> [1] "outDS"
>>>> 
>>>> $exportPatterns
>>>> character(0)
>>>> 
>>>> $importClasses
>>>> list()
>>>> 
>>>> $importMethods
>>>> list()
>>>> 
>>>> $exportClasses
>>>> character(0)
>>>> 
>>>> $exportMethods
>>>> character(0)
>>>> 
>>>> $exportClassPatterns
>>>> character(0)
>>>> 
>>>> $dynlibs
>>>> character(0)
>>>> 
>>>> $nativeRoutines
>>>> list()
>>>> 
>>>> $S3methods
>>>>          [,1] [,2] [,3]
>>>> 
>>>>> 
>>>> 
>>>> So, it picked up 'export' and ignored the other two lines.
>>>> 
>>>> 
>>>> Chuck
>>>> 
>>>> p.s.
>>>> 
>>>>> sessionInfo()
>>>> R version 2.12.0 (2010-10-15)
>>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>>> 
>>>> locale:
>>>> [1] C
>>>> 
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> Charles C. Berry                            Dept of Family/Preventive 
>>>> Medicine
>>>> cberry at tajo.ucsd.edu			    UC San Diego
>>>> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 
>>>> 92093-0901
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Sun Nov 28 23:54:02 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 28 Nov 2010 17:54:02 -0500
Subject: [Rd] Bug in parseNamespaceFile or switch( , ... ) ?
In-Reply-To: <4CF19DB8.5060706@gmail.com>
References: <Pine.LNX.4.64.1011271448140.23931@tajo.ucsd.edu>
	<4CF1995F.9020006@gmail.com> <4CF19DB8.5060706@gmail.com>
Message-ID: <4CF2DD8A.3080806@gmail.com>

On 27/11/2010 7:09 PM, Duncan Murdoch wrote:
> On 27/11/2010 6:50 PM, Duncan Murdoch wrote:
>> On 27/11/2010 5:58 PM, Charles C. Berry wrote:
>>>
>>> parseNamespaceFile() doesn't seem to detect misspelled directives. Looking
>>> at its code I see
>>>
>>>     	switch(as.character(e[[1L]]),
>>>
>>>     	<lots of args omitted here>,
>>>
>>>     	stop(gettextf("unknown namespace directive: %s",
>>>                     deparse(e)), call. = FALSE, domain = NA))
>>>
>>> but this doesn't seem to function as I expect, viz. to stop with an error
>>> if I type a wrong directive.
>>
>> You're right, there was a typo in parseNamespaceFile.  (The typo was in
>> this line:
>>
>>                   "=", "<-" = {
>>
>> This should have been
>>
>>                   "=" =, "<-" = {
>>
>> Without the extra = sign, the "=" was taken as the default value of the
>> switch, and the stop() was never reached.
>>
>> Conceivably switch() should complain if it is called with more than one
>> default.
>
> I suspect when I fix this it's going to flush out some typos in packages
> on CRAN...

The first fix (to parseNamespaceFile) seems to have caught around 54 
CRAN packages and 13 Bioconductor ones.  Hopefully fixing these typos 
will make the NAMESPACE function more as it was intended.

Fewer packages have been caught so far by the switch() change, but that 
one requires the switch() to actually be executed, so more will show up 
as the packages are used if their tests don't cover all of their code.

Thanks to Brian Ripley for running the tests.  I'll email the 
maintainers to let them know what's going on.

Duncan Murdoch


From D.Strbenac at garvan.org.au  Mon Nov 29 04:00:07 2010
From: D.Strbenac at garvan.org.au (Dario Strbenac)
Date: Mon, 29 Nov 2010 14:00:07 +1100 (EST)
Subject: [Rd] tar R command
Message-ID: <20101129140007.BKA35838@gimr.garvan.unsw.edu.au>

Hello,

The documentation for the tar command leads me to think there is an internal implementation when the command can't be found in the OS.

However, it doesn't seem to be the case, as I get an empty .tar file generated on a small example I made :

> dir(pattern = "jpg")
[1] "MA56237502_635.jpg"
> file.info("MA56237502_635.jpg")
                     size isdir mode               mtime               ctime               atime exe
MA56237502_635.jpg 229831 FALSE  666 2010-11-29 13:05:49 2010-11-29 13:00:36 2010-11-29 13:00:36  no
> tar("example.tar", files = dir(pattern = "jpg"))
> file.info("example.tar")
            size isdir mode               mtime               ctime               atime exe
example.tar 1024 FALSE  666 2010-11-29 13:43:29 2010-11-29 13:42:30 2010-11-29 13:42:30  no

Is this an unimplemented feature ?

> sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: x86_64-pc-mingw32/x64 (64-bit)
...                ...               ...

Thanks,
       Dario.


From hb at biostat.ucsf.edu  Mon Nov 29 05:35:47 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Sun, 28 Nov 2010 20:35:47 -0800
Subject: [Rd] tar R command
In-Reply-To: <20101129140007.BKA35838@gimr.garvan.unsw.edu.au>
References: <20101129140007.BKA35838@gimr.garvan.unsw.edu.au>
Message-ID: <AANLkTikuBEPxGCBwqauAnAoGhABshdZyCn5qQJHcJaJd@mail.gmail.com>

First, if you look carefully, then you see that argument 'files'
should specify *filepaths*, i.e. directories and not specific files.
Thus, if you for instance place your files in directory "foo/" and
then call

tar("foo.tar", files="foo/");

you would do the right thing.

HOWEVER, looking at the internals of base::tar(), it seems to be
designed for a non-Windows platform, i.e. it will not work on Windows
as it stands (more below).  A workaround that also illustrating the
problems are the following patch(es):

# PATCH for file.info() such that tar() works on Windows
tar <- utils::tar; environment(tar) <- globalenv();
file.info <- function(...) {
  fi <- base::file.info(...);
  fi[setdiff(c("uid", "gid", "uname", "grname"), names(fi))] <- NA;
  fi;
} # file.info()

Example:

dir.create("foo/");
cat(file="foo/foo.txt", rep(letters, times=100));
tar("foo.tar", files="foo/");
str(file.info("foo.tar"));

'data.frame':   1 obs. of  11 variables:
 $ size  : num 7680
 $ isdir : logi FALSE
 $ mode  :Class 'octmode'  int 438
 $ mtime : POSIXct, format: "2010-11-28 20:24:05"
 $ ctime : POSIXct, format: "2010-11-28 20:03:56"
 $ atime : POSIXct, format: "2010-11-28 20:07:40"
 $ exe   : chr "no"
 $ uid   : logi NA
 $ gid   : logi NA
 $ uname : logi NA
 $ grname: logi NA

This seems to generate a valid foo.tar file.


PROBLEMS:
Here are a few problems I have identified with tar().

PROBLEM #1:
The default for argument files=NULL is documented "to archive all
files under the current directory".  In reality it gives:

  Error in list.files(files, recursive = TRUE, all.files = TRUE,
full.names = TRUE: invalid 'directory' argument

because list.files(NULL) is invalid.  The default should instead be files=".".

PROBLEM #2:
If passing a non-existing path (argument 'files'), then tar()
generates an invalid *.tar file of size 1024 bytes (not empty as OP
say).  Better would be to assert that each of the directories
requested really exists and are directories, e.g. using
file.info()$dir.

PROBLEM #3:
tar() assumes that file.info() returns a data.frame with fields 'uid',
'gid' and 'uname'.  That is not the case for file.info() on Windows.


> sessionInfo()
R version 2.12.0 Patched (2010-11-24 r53656)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

My $0.20

/Henrik


On Sun, Nov 28, 2010 at 7:00 PM, Dario Strbenac
<D.Strbenac at garvan.org.au> wrote:
> Hello,
>
> The documentation for the tar command leads me to think there is an internal implementation when the command can't be found in the OS.
>
> However, it doesn't seem to be the case, as I get an empty .tar file generated on a small example I made :
>
>> dir(pattern = "jpg")
> [1] "MA56237502_635.jpg"
>> file.info("MA56237502_635.jpg")
> ? ? ? ? ? ? ? ? ? ? size isdir mode ? ? ? ? ? ? ? mtime ? ? ? ? ? ? ? ctime ? ? ? ? ? ? ? atime exe
> MA56237502_635.jpg 229831 FALSE ?666 2010-11-29 13:05:49 2010-11-29 13:00:36 2010-11-29 13:00:36 ?no
>> tar("example.tar", files = dir(pattern = "jpg"))
>> file.info("example.tar")
> ? ? ? ? ? ?size isdir mode ? ? ? ? ? ? ? mtime ? ? ? ? ? ? ? ctime ? ? ? ? ? ? ? atime exe
> example.tar 1024 FALSE ?666 2010-11-29 13:43:29 2010-11-29 13:42:30 2010-11-29 13:42:30 ?no
>
> Is this an unimplemented feature ?
>
>> sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
> ... ? ? ? ? ? ? ? ?... ? ? ? ? ? ? ? ...
>
> Thanks,
> ? ? ? Dario.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From maechler at stat.math.ethz.ch  Mon Nov 29 09:20:13 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 29 Nov 2010 09:20:13 +0100
Subject: [Rd] package matrix dummy.cpp
In-Reply-To: <alpine.LFD.2.00.1011281557540.17922@gannet.stats.ox.ac.uk>
References: <AANLkTikpt5e8X4RUj8Do8+CFnB6BNR59OgUzmgFCHpq8@mail.gmail.com>
	<alpine.LFD.2.00.1011281557540.17922@gannet.stats.ox.ac.uk>
Message-ID: <19699.25149.665358.910225@lynne.math.ethz.ch>

>>>>> Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>     on Sun, 28 Nov 2010 16:00:53 +0000 (GMT) writes:

    > It is Matrix, not matrix ....  
indeed!

    > I too have corresponded with them about this.  It seems to
    > be a legacy from when the package contained C++ code, and
    > can now be deleted.

yes.  Though, as Brian mentions below it's strange that you
can't compile the package (how?) with the file present.
I'd guess that this would mean you cannot (easily) install any
CRAN packages that use C++ ?
I think this will preclude you from using very fine R extensions!


    > On Sun, 28 Nov 2010, Ambrus Kaposi wrote:

    >> Hi,
    >> 
    >> The recommended package matrix contains an empty file
    >> src/dummy.cpp which results in using g++ instead of gcc
    >> to link Matrix.so.  What is the reason for that? Is there
    >> any difference between using g++ or gcc? (There are no
    >> other cpp files in the source) I asked the maintainers of
    >> the package (matrix-authors at r-project.org) 3 weeks ago
    >> but haven't received any answer.  

I apologize for that. Both Professor Doug Bates and I have been
overloaded, and so this has "slipped".

    >> On my system (NixOS
    >> Linux distribution, http://nixos.org) I can't compile
    >> package Matrix unless this file is deleted.

    > Most likely you have not installed the C++ compiler (which
    > is usually g++ on Linux) -- but you shouldn't need to in
    > order to install R.

Indeed, currently a C++ compiler for compiling/linking the R
sources should not be needed just because of dummy.cpp in
Matrix; and hence I've removed it for the next version of Matrix.
However, as said above, I strongly believe your OS / R setup
should be amended in such a way that you can also easily install
packages with C++ code.

Best regards,
Martin Maechler, ETH Zurich




    >> Thank you very much, Ambrus Kaposi


From Thierry.ONKELINX at inbo.be  Mon Nov 29 14:07:27 2010
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Mon, 29 Nov 2010 14:07:27 +0100
Subject: [Rd] Sweave choking on \\ in filename
Message-ID: <3DB16098F738284D8DBEB2FC3699163850E408@inboexch.inbo.be>

Dear all,

Sweave chokes when using "\\" in the path to the Rnw file. Using "/"
works fine. The problem is that Eclipse+StatET uses "\\" in the
filename.
And example of the error, traceback and sessionInfo are given below.

Best regards,

Thierry

> Sweave("Q:\\BMK\\cursussen\\interne_opleiding\\deelnemerslijst.Rnw",
syntax="SweaveSyntaxNoweb")
Writing to file deelnemerslijst.tex
Processing code chunks ...
 1 : echo term verbatim

Error:  chunk 1 
Error : '\B' is an unrecognized escape in character string starting
"Q:\B"
> traceback()
4: stop(msg, err, call. = FALSE)
3: RweaveTryStop(chunkexps, options)
2: driver$runcode(drobj, chunk, chunkopts)
1: Sweave("Q:\\BMK\\cursussen\\interne_opleiding\\deelnemerslijst.Rnw", 
       syntax = "SweaveSyntaxNoweb")

> sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=Dutch_Belgium.1252  LC_CTYPE=Dutch_Belgium.1252   
[3] LC_MONETARY=Dutch_Belgium.1252 LC_NUMERIC=C                  
[5] LC_TIME=Dutch_Belgium.1252    

attached base packages:
[1] grDevices datasets  splines   graphics  stats     tcltk     utils

[8] methods   base     

other attached packages:
[1] svSocket_0.9-51 TinnR_1.0.3     R2HTML_2.2      Hmisc_3.8-3    
[5] survival_2.36-1

loaded via a namespace (and not attached):
[1] cluster_1.13.2  grid_2.12.0     lattice_0.19-15 svMisc_0.9-61  
[5] tools_2.12.0   
> 
------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek
team Biometrie & Kwaliteitszorg
Gaverstraat 4
9500 Geraardsbergen
Belgium

Research Institute for Nature and Forest
team Biometrics & Quality Assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium

tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey


From kaposi.ambrus at gmail.com  Mon Nov 29 14:14:34 2010
From: kaposi.ambrus at gmail.com (Ambrus Kaposi)
Date: Mon, 29 Nov 2010 14:14:34 +0100
Subject: [Rd] package matrix dummy.cpp
In-Reply-To: <19699.25149.665358.910225@lynne.math.ethz.ch>
References: <AANLkTikpt5e8X4RUj8Do8+CFnB6BNR59OgUzmgFCHpq8@mail.gmail.com>
	<alpine.LFD.2.00.1011281557540.17922@gannet.stats.ox.ac.uk>
	<19699.25149.665358.910225@lynne.math.ethz.ch>
Message-ID: <AANLkTimvgLjYE0BqvvG-UO=k6pTuVnWuAVHZP3m4WaZm@mail.gmail.com>

Thank you for the help.

> yes. ?Though, as Brian mentions below it's strange that you
> can't compile the package (how?) with the file present.
> I'd guess that this would mean you cannot (easily) install any
> CRAN packages that use C++ ?
> I think this will preclude you from using very fine R extensions!

My g++ compiler can't handle the -lgfortran switch, while gcc can. I
think it is the fault of my Linux distribution (http://nixos.org), but
it was an easier solution to use gcc instead of g++ than fixing g++.
This probably means that I can't compile any R packages using C++ and
fortran at the same time. I will investigate further in this error.

This was the error:
g++ -shared -L/usr/local/lib -o Matrix.so CHMfactor.o Csparse.o
TMatrix_as.o Tsparse.o init.o Mutils.o chm_common.o cs.o cs_utils.o
dense.o dgCMa
trix.o dgTMatrix.o dgeMatrix.o dpoMatrix.o dppMatrix.o dsCMatrix.o
dsyMatrix.o dspMatrix.o dtCMatrix.o dtTMatrix.o dtrMatrix.o
dtpMatrix.o factor
izations.o ldense.o lgCMatrix.o sparseQR.o abIndex.o CHOLMOD.a
COLAMD.a AMD.a -L/tmp/nix-build-l8rd1zk5f2fslzm7w1zygwz376br9nlw-r-lang.drv-0/R-2.
12.0/lib -lRlapack
-L/tmp/nix-build-l8rd1zk5f2fslzm7w1zygwz376br9nlw-r-lang.drv-0/R-2.12.0/lib
-lRblas -lgfortran -lm
/nix/store/bwwd0qz5ar7afhxdb26bjglql86hcw6b-binutils-2.20/bin/ld:
cannot find -lgfortran
collect2: ld returned 1 exit status

Best regards,
Ambrus Kaposi


From ripley at stats.ox.ac.uk  Mon Nov 29 14:38:26 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 29 Nov 2010 13:38:26 +0000 (GMT)
Subject: [Rd] package matrix dummy.cpp
In-Reply-To: <AANLkTimvgLjYE0BqvvG-UO=k6pTuVnWuAVHZP3m4WaZm@mail.gmail.com>
References: <AANLkTikpt5e8X4RUj8Do8+CFnB6BNR59OgUzmgFCHpq8@mail.gmail.com>
	<alpine.LFD.2.00.1011281557540.17922@gannet.stats.ox.ac.uk>
	<19699.25149.665358.910225@lynne.math.ethz.ch>
	<AANLkTimvgLjYE0BqvvG-UO=k6pTuVnWuAVHZP3m4WaZm@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1011291330340.28978@toucan.stats.ox.ac.uk>

On Mon, 29 Nov 2010, Ambrus Kaposi wrote:

> Thank you for the help.
>
>> yes. ?Though, as Brian mentions below it's strange that you
>> can't compile the package (how?) with the file present.
>> I'd guess that this would mean you cannot (easily) install any
>> CRAN packages that use C++ ?
>> I think this will preclude you from using very fine R extensions!
>
> My g++ compiler can't handle the -lgfortran switch, while gcc can. I
> think it is the fault of my Linux distribution (http://nixos.org), but
> it was an easier solution to use gcc instead of g++ than fixing g++.
> This probably means that I can't compile any R packages using C++ and
> fortran at the same time. I will investigate further in this error.

Yes, there is no guarantee that you can mix any two languages except C 
and Fortran.

But this is not the way a Linux system is usually set up, and you may 
be able to resolve it by including the path to libgfortran in 
LD_LIBRARY_PATH, or editing FLIBS in R_HOME/etc/Makeconf to be 
something like

"-L /path/to/gfortran -rpath=/path/to/gfortran -lgfortran"

>
> This was the error:
> g++ -shared -L/usr/local/lib -o Matrix.so CHMfactor.o Csparse.o
> TMatrix_as.o Tsparse.o init.o Mutils.o chm_common.o cs.o cs_utils.o
> dense.o dgCMa
> trix.o dgTMatrix.o dgeMatrix.o dpoMatrix.o dppMatrix.o dsCMatrix.o
> dsyMatrix.o dspMatrix.o dtCMatrix.o dtTMatrix.o dtrMatrix.o
> dtpMatrix.o factor
> izations.o ldense.o lgCMatrix.o sparseQR.o abIndex.o CHOLMOD.a
> COLAMD.a AMD.a -L/tmp/nix-build-l8rd1zk5f2fslzm7w1zygwz376br9nlw-r-lang.drv-0/R-2.
> 12.0/lib -lRlapack
> -L/tmp/nix-build-l8rd1zk5f2fslzm7w1zygwz376br9nlw-r-lang.drv-0/R-2.12.0/lib
> -lRblas -lgfortran -lm
> /nix/store/bwwd0qz5ar7afhxdb26bjglql86hcw6b-binutils-2.20/bin/ld:
> cannot find -lgfortran
> collect2: ld returned 1 exit status
>
> Best regards,
> Ambrus Kaposi
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From bbolker at gmail.com  Mon Nov 29 14:59:09 2010
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 29 Nov 2010 13:59:09 +0000 (UTC)
Subject: [Rd] Request:  kronecker to get a sep= argument
References: <4CEEC2B0.5060203@yorku.ca>
	<Pine.LNX.4.64.1011252305130.17459@tajo.ucsd.edu>
	<Pine.LNX.4.64.1011252318340.17459@tajo.ucsd.edu>
Message-ID: <loom.20101129T145437-550@post.gmane.org>

Charles C. Berry <cberry <at> tajo.ucsd.edu> writes:

> 
> On Thu, 25 Nov 2010, Charles C. Berry wrote:
> 
> > On Thu, 25 Nov 2010, Michael Friendly wrote:
> >
> >>  kronecker, with make.dimnames=TRUE uses a hardwired sep=":" in the line
> >>
> >>             tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = ":")
> >>
> >>  For an application in which dimnames arise from an n-way array, where
> >>  different dimensions have
> >>  different roles, and I would like to be able to use kronecker in the form
> >>
> >>  kronecker(A, B, make.dimnames=TRUE, sep='/')
> >>
> >>  All this requires is to change the following two lines:
> >>
> >>  kronecker <- function (X, Y, FUN = "*", make.dimnames = FALSE, sep=":"
> >>  ...)
> >>  {
> >>   ...
> >>             tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = sep)
> >> }
> >> 
> >>

[snip]

> >
> > p.s. your suggestion could break code that others may have written like

[snip]

> kronecker( letters[1:3], diag(LETTERS[1:2]), paste )


  Of course, this could be fixed (if considered appropriate)

kronecker <- function (X, Y, FUN = "*", make.dimnames = FALSE, 
  name_sep=":", ...)
{
   tmp <- outer(dnx[[i]], dny[[i]], FUN = "paste", sep = name_sep)
}

  which could still break existing code in the unlikely event
that someone used a value of FUN with a 'name_sep' argument (much
less likely).  Perhaps the argument could be named .sep -- that
seems to be a standard convention in these cases for trying to
avoid previous/user-defined argument names.
  For whatever it's worth this seems like a good idea to me -- a 
small change that will increase flexibility with little cost.

  Ben Bolker


From djsamperi at gmail.com  Mon Nov 29 15:58:21 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Mon, 29 Nov 2010 09:58:21 -0500
Subject: [Rd] CRAN package archives (tar.gz) now require --no-same-owner
	under Windows?
Message-ID: <AANLkTimE7UxsP9cyNY5-Od8WZsimBwkutxqY6BVTs9D=@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101129/a56d72cb/attachment.pl>

From murdoch.duncan at gmail.com  Mon Nov 29 16:56:49 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 29 Nov 2010 10:56:49 -0500
Subject: [Rd] Sweave choking on \\ in filename
In-Reply-To: <3DB16098F738284D8DBEB2FC3699163850E408@inboexch.inbo.be>
References: <3DB16098F738284D8DBEB2FC3699163850E408@inboexch.inbo.be>
Message-ID: <4CF3CD41.1020204@gmail.com>

On 29/11/2010 8:07 AM, ONKELINX, Thierry wrote:
> Dear all,
>
> Sweave chokes when using "\\" in the path to the Rnw file. Using "/"
> works fine. The problem is that Eclipse+StatET uses "\\" in the
> filename.
> And example of the error, traceback and sessionInfo are given below.


This is fixed in R-patched.  (It would have been fixed in 2.12.0 if more 
people tested the betas...).

Duncan Murdoch

> Best regards,
>
> Thierry
>
> >  Sweave("Q:\\BMK\\cursussen\\interne_opleiding\\deelnemerslijst.Rnw",
> syntax="SweaveSyntaxNoweb")
> Writing to file deelnemerslijst.tex
> Processing code chunks ...
>   1 : echo term verbatim
>
> Error:  chunk 1
> Error : '\B' is an unrecognized escape in character string starting
> "Q:\B"
> >  traceback()
> 4: stop(msg, err, call. = FALSE)
> 3: RweaveTryStop(chunkexps, options)
> 2: driver$runcode(drobj, chunk, chunkopts)
> 1: Sweave("Q:\\BMK\\cursussen\\interne_opleiding\\deelnemerslijst.Rnw",
>         syntax = "SweaveSyntaxNoweb")
>
> >  sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=Dutch_Belgium.1252  LC_CTYPE=Dutch_Belgium.1252
> [3] LC_MONETARY=Dutch_Belgium.1252 LC_NUMERIC=C
> [5] LC_TIME=Dutch_Belgium.1252
>
> attached base packages:
> [1] grDevices datasets  splines   graphics  stats     tcltk     utils
>
> [8] methods   base
>
> other attached packages:
> [1] svSocket_0.9-51 TinnR_1.0.3     R2HTML_2.2      Hmisc_3.8-3
> [5] survival_2.36-1
>
> loaded via a namespace (and not attached):
> [1] cluster_1.13.2  grid_2.12.0     lattice_0.19-15 svMisc_0.9-61
> [5] tools_2.12.0
> >
> ------------------------------------------------------------------------
> ----
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek
> team Biometrie&  Kwaliteitszorg
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
>
> Research Institute for Nature and Forest
> team Biometrics&  Quality Assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
>
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to
> say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of
> data.
> ~ John Tukey
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kjetilbrinchmannhalvorsen at gmail.com  Tue Nov 30 01:10:13 2010
From: kjetilbrinchmannhalvorsen at gmail.com (Kjetil Halvorsen)
Date: Mon, 29 Nov 2010 21:10:13 -0300
Subject: [Rd] proposal for new flag to R CMD INSTALL
Message-ID: <AANLkTiko3NLTyhHDyTaukK65K0qLFffJTnOw08uGrYd7@mail.gmail.com>

For the purpose of helping in installing only parts of a package
(in my case, the help system), R CMD INSTALL
should accept a flag   --no-check-deps

Below is a diff for R-devel, svn revision    53672



kjetil at kjetil:~/R/R-devel/src/library/tools/R$ diff install.R.old install.R
116a117
>             "      --no-check-deps      skip test if installed depends/imports",
506c507
<             if (length(miss) > 1)
---
>             if ((length(miss) > 1) && check_deps)
510c511
<             else if (length(miss))
---
>             else if (length(miss) && check_deps)
1025a1027
>     check_deps <- TRUE
1133a1136,1137
>         } else if (a == "--no-check-deps") {
>             check_deps <- FALSE



kjetil


From hb at biostat.ucsf.edu  Tue Nov 30 07:40:22 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Mon, 29 Nov 2010 22:40:22 -0800
Subject: [Rd] Possibility for memory improvement: x <- as.vector(x)
	always(?) duplicates
In-Reply-To: <AANLkTi=EjhOybYAkgDjpZL6wcM2XNZxgti_eBRC7PGLU@mail.gmail.com>
References: <AANLkTi=EjhOybYAkgDjpZL6wcM2XNZxgti_eBRC7PGLU@mail.gmail.com>
Message-ID: <AANLkTi=nyx3qR7m_A1HiKT4WD_FV7T=wJPq5dcEU=rF5@mail.gmail.com>

FYI,

from the recent R devel NEWS file:

as.vector() and as.double() etc duplicate less when they leave the
mode unchanged but remove attributes.
as.vector(mode = "any") no longer duplicates when it does not remove
attributes. This helps memory usage in matrix() and array().

This improvement will cut down the memory allocation/garbage
collection for most of us (I would like to add "a lot").  For
instance, no more duplicated copies with the most common matrix() use
cases.

% Rerm
R version 2.13.0 Under development (unstable) (2010-11-26 r53672)
[...]
>  x <- 1:10;
> x <- as.vector(x);
> tracemem(x);
[1] "<0x00000000038e1538"
> x <- as.vector(x);
> x <- as.vector(x);
> x <- as.vector(x);

and so on.

> x <- 1:10;
> tracemem(x);
[1] "<0x00000000038e1590"
> x <- matrix(x, nrow=5, ncol=2);
> x <- as.matrix(x);
> x <- as.matrix(x);
> x <- as.matrix(x);

and so on.  Compare this with what I reported on in my previous message (below).

Browsing the SVN logs for R devel I see that Brian Ripley is the one
who has done all the great work related to this one.

Thank you!

/Henrik

On Tue, Nov 23, 2010 at 6:12 AM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
> Hi,
>
> I've noticed that as.vector() always allocates a new object, e.g.
>
>> x <- 1:10;
>> x <- as.vector(x);
>> tracemem(x);
> [1] "<0x0000000005622db8"
>> x <- as.vector(x);
> tracemem[0x0000000005622db8 -> 0x0000000005622ec0]: as.vector
>> x <- as.vector(x);
> tracemem[0x0000000005622ec0 -> 0x0000000005622f18]: as.vector
>> x <- as.vector(x);
> tracemem[0x0000000005622f18 -> 0x000000000561c388]: as.vector
>> x <- as.vector(x);
> tracemem[0x000000000561c388 -> 0x000000000561c3e0]: as.vector
>>
>
> and so on.
>
> This also seems to be the reason for an extra copy being created in
> turning a vector into a matrix or an array, e.g.
>
>> x <- 1:10;
>> tracemem(x);
> [1] "<0x000000000561c750"
>> x <- matrix(x, nrow=5, ncol=2);
> tracemem[0x000000000561c750 -> 0x000000000561c7a8]: as.vector matrix
>>
>
> Example of how it could work (not sure if the test with is.vector() is enough):
>
> as.vector <- function(x, mode="any") {
> ?if (is.vector(x)) return(x);
> ?base::as.vector(x);
> } # as.vector()
>
> matrix <- base::matrix;
> environment(matrix) <- globalenv();
>
>> x <- 1:10;
>> tracemem(x);
> [1] "<0x0000000003965488"
>> x <- matrix(x, nrow=5, ncol=2);
>>
>
> Could this be generic improvement? ?Some years ago there similar
> improvements where done for as.integer(), as.numeric() etc.
>
> This is on R v2.12.0 patched (2010-11-09 r53543) and R v2.13.0 devel
> (2010-11-20 r53645) on Windows 7 Ultimate.
>
> /Henrik
>


From keith at wehi.EDU.AU  Tue Nov 30 07:41:52 2010
From: keith at wehi.EDU.AU (Keith Satterley)
Date: Tue, 30 Nov 2010 17:41:52 +1100
Subject: [Rd] Windows Rdevel version - no Rgui.exe?
Message-ID: <4CF49CB0.3040209@wehi.edu.au>

Hi Duncan,

just noticed that after installing the Windows R-2.13.0 build there is 
no i386 directory in the R-2.13.0dev/bin directory and hence no 
Rgui.exe. Is this intentional with the devel version?

I downloaded from http://cran.ms.unimelb.edu.au/, where it says:
"This is a combined Windows 32/64 bit binary build of the 2010-11-27 
r53672 development snapshot of R (which will eventually become 
R-2.13.0).". Do you think this is an error on my part or do you see the 
same thing,

cheers,

Keith

========================
Keith Satterley
Bioinformatics Division
The Walter and Eliza Hall Institute of Medical Research
Parkville, Melbourne,
Victoria, Australia
=======================


______________________________________________________________________
The information in this email is confidential and intend...{{dropped:4}}


From hb at biostat.ucsf.edu  Tue Nov 30 08:00:36 2010
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Mon, 29 Nov 2010 23:00:36 -0800
Subject: [Rd] Unexpected behavior with \r in Rgui 2.12.0
In-Reply-To: <AANLkTinuqEUfeH5_6wC9opAt8hkwwG92dPuBsGy7wOx5@mail.gmail.com>
References: <AANLkTimEOpB+GiECjs6GiRdX7tP1_HU-kfXhvLvP66Lr@mail.gmail.com>
	<alpine.LFD.2.00.1011251327150.10688@gannet.stats.ox.ac.uk>
	<AANLkTimCZY1Di74=VCLRq81E52=ni48xZc2_Yj7v1VrR@mail.gmail.com>
	<AANLkTimHe0uCjbjwsAkixJ4L9K2YYpPHchpoGq1fpRYx@mail.gmail.com>
	<AANLkTimC83S_pMSRgj3bNrAO9j-HbBW53EiD8y-tq+-L@mail.gmail.com>
	<AANLkTinuqEUfeH5_6wC9opAt8hkwwG92dPuBsGy7wOx5@mail.gmail.com>
Message-ID: <AANLkTinRFZ5gvJjSQinKUuD419Z0jO2pkEZ-6DY4Sgft@mail.gmail.com>

This is now working. ...almost.  There seem to be some "memory"
remaining of where to put the point ("cursor") - a memory that is
related to the number of characters moving back.  Hard to explain, but
try this in Rgui (I've added the cursor):

> cat("1234\r6789")
6789> |
>     |
>     |
>     |

> cat("12345\r67890")
67890> |
>      |
>      |
>      |

> cat("\r")
> |
> |
> |

Also, maybe a wanted feature or not, but cut'n'paste contains the
complete string sent:

[BEGIN CUT'N'PASTE]
> cat("1234\r6789")
1234
6789>
> cat("12345\r67890")
12345
67890>

> for (kk in 1:10) { cat(sprintf("%02d\r", kk)) }; cat("\n");
01
02
03
04
05
06
07
08
09
10

>
[END CUT'N'PASTE]

> sessionInfo()
R version 2.13.0 Under development (unstable) (2010-11-26 r53672)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

/Henrik

(Just wanted to share these observations; not really using this feature myself).





On Thu, Nov 25, 2010 at 10:12 AM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
> On Thu, Nov 25, 2010 at 10:02 AM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
>> FYI, this topic was discussed in R-help thread 'cat(), Rgui, and
>> support for carriage return \r...' on March 17-29, 2006:
>>
>> ?https://stat.ethz.ch/pipermail/r-help/2006-March/101863.html
>>
>> Some modifications to Rgui's behavior was brought up and (I think)
>> implemented at the time.
>>
>> As far as I remember, after that discussion ASCII carriage return did
>> indeed *move* the point/cursor to the beginning of the current line. I
>> remember trying it at the time, but I admit I haven't verified it in
>> several years now.
>
> [scrap]
>> However, I believe that that was before Unicode
>> character support was introduced, and my best guess is that support
>> for the latter may have changed the expected behavior of carriage
>> return.
> [/scrap]
>
> Remove that last guess of mine; know I re-read Ripley's message and
> see that the displaying of odd characters was due to a bug, which was
> just fixed. ?It will take a couple of days before binaries of that
> patched version are available on CRAN.
>
> /Henrik
>
>>
>> My $.02 on the history
>>
>> /Henrik
>>
>>
>> On Thu, Nov 25, 2010 at 7:49 AM, Russell Pierce <rpier001 at ucr.edu> wrote:
>>> Prof. Ripley & Joris,
>>>
>>> I concur with Joris, the behavior persists in R version 2.12.0 Patched
>>> (2010-11-24 r53655) and ?under Windows XP. ?The current development build
>>> for Windows did not have an RGui at the time I wrote this.
>>>
>>> I did not realize that the functionality of "\r" to return to
>>> the beginning of the line in Windows was undocumented/unsupported. ??Quotes
>>> lists \r as carriage return without any warning that it is unsupported in
>>> RGui, perhaps a notice should be put in?
>>>
>>> Since "\r" is not supported, I would like to express a desire that it at
>>> least do something predictable. ?Certainly, it seems doubtful that
>>> these "strange characters" (with the copying characteristics described) is
>>> what a user expects. ?If "\r" is not usable under RGui perhaps it would be
>>> better to ignore it entirely than to parse it and return the odd output that
>>> I am seeing?
>>>
>>> In the RGui for Windows prior to this version "\r" returned to
>>> the beginning of the line without deleting the already written content.
>>> ?Thus cat(70,"\r") and cat("\r",70) only differed in terms of where the
>>> cursor was left.
>>>
>>> I started using "\r" because I had seen it in the code for txtProgressBar.
>>> ?The help for txtProgressBar does note that it "uses \r to return to the
>>> left margin ? the interpretation of carriage return is up to the terminal or
>>> console in which *R* is running". For Jorris' reference, in a windows
>>> environment there are several methods to produce keep track of progress:
>>> tcltk::tkProgressBar, utils::txtProgressBar , and utils::winProgressBar.
>>> ?None of them are as "user friendly" as cat and "\r" because you have to
>>> create the progress bar, increment it, then destroy it. ?If you want to
>>> output debugging information as well as increment a counter you need to
>>> tweak the title attribute as you go.
>>>
>>> Best,
>>>
>>> Russell S. Pierce
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>


From murdoch.duncan at gmail.com  Tue Nov 30 12:19:11 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Nov 2010 06:19:11 -0500
Subject: [Rd] Windows Rdevel version - no Rgui.exe?
In-Reply-To: <4CF49CB0.3040209@wehi.edu.au>
References: <4CF49CB0.3040209@wehi.edu.au>
Message-ID: <4CF4DDAF.8080302@gmail.com>

Keith Satterley wrote:
> Hi Duncan,
> 
> just noticed that after installing the Windows R-2.13.0 build there is 
> no i386 directory in the R-2.13.0dev/bin directory and hence no 
> Rgui.exe. Is this intentional with the devel version?
> 
> I downloaded from http://cran.ms.unimelb.edu.au/, where it says:
> "This is a combined Windows 32/64 bit binary build of the 2010-11-27 
> r53672 development snapshot of R (which will eventually become 
> R-2.13.0).". Do you think this is an error on my part or do you see the 
> same thing,

It may be an error in that build; I'll take a look.

Duncan Murdoch


From murdoch.duncan at gmail.com  Tue Nov 30 13:13:48 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Nov 2010 07:13:48 -0500
Subject: [Rd] Windows Rdevel version - no Rgui.exe?
In-Reply-To: <4CF49CB0.3040209@wehi.edu.au>
References: <4CF49CB0.3040209@wehi.edu.au>
Message-ID: <4CF4EA7C.3000406@gmail.com>

On 30/11/2010 1:41 AM, Keith Satterley wrote:
> Hi Duncan,
>
> just noticed that after installing the Windows R-2.13.0 build there is
> no i386 directory in the R-2.13.0dev/bin directory and hence no
> Rgui.exe. Is this intentional with the devel version?
>
> I downloaded from http://cran.ms.unimelb.edu.au/, where it says:
> "This is a combined Windows 32/64 bit binary build of the 2010-11-27
> r53672 development snapshot of R (which will eventually become
> R-2.13.0).". Do you think this is an error on my part or do you see the
> same thing,

I just downloaded a slightly newer build (r53704), and it looks okay. 
Might have been a temporary glitch.  If you see it again, please let me 
know.

Duncan Murdoch

>
> cheers,
>
> Keith
>
> ========================
> Keith Satterley
> Bioinformatics Division
> The Walter and Eliza Hall Institute of Medical Research
> Parkville, Melbourne,
> Victoria, Australia
> =======================
>
>
> ______________________________________________________________________
> The information in this email is confidential and inte...{{dropped:4}}


From pchausse at uwaterloo.ca  Tue Nov 30 18:09:34 2010
From: pchausse at uwaterloo.ca (Pierre Chausse)
Date: Tue, 30 Nov 2010 12:09:34 -0500
Subject: [Rd] stats::kernel
Message-ID: <4CF52FCE.80606@uwaterloo.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20101130/042e5ba2/attachment.pl>

From ripley at stats.ox.ac.uk  Tue Nov 30 19:08:16 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 30 Nov 2010 18:08:16 +0000 (GMT)
Subject: [Rd] stats::kernel
In-Reply-To: <4CF52FCE.80606@uwaterloo.ca>
References: <4CF52FCE.80606@uwaterloo.ca>
Message-ID: <alpine.LFD.2.00.1011301748550.22358@gannet.stats.ox.ac.uk>

What you are saying is that an undocumented default does not apply to 
your usage.  So all you need to do, surely, is to set the argument 
yourself?

Your 'correction' makes e.g. kernel("daniell") invalid.

I"ve applied a change in R-devel that means 'm' will not need to be 
supplied if 'coef' is numeric.

On Tue, 30 Nov 2010, Pierre Chausse wrote:

>  Hi,
>
> There is a small bug in the kernel() function. Everything is fine when
> we use the format:
>
> kernel("name",m,r)
>
> but if we want the first argument to be a vector, which is useful is we
> are interested in using a method not implemented in kernel(), the
> default value of m is wrong. For example, if we do:
>
> s <- rep(1/11,6)
> k <- kernel(s)
>
> we get the error message
>
> Error in kernel(s) : 'coef' does not have the correct length
>
> The problem is that the default value, which is not indicated in the
> help file,  violate the condition that length(coef) must be equal to
> (m+1). Therefore, the first line of the function, which is:
>
> function (coef, m = length(coef) + 1, r, name = "unknown")
> {
>
> should be changed to
>
> function (coef, m = length(coef) - 1, r, name = "unknown")
> {
>
> bests
>
> -- 
> *Pierre Chauss?*
> Assistant Professor
> Department of Economics
> University of Waterloo
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pchausse at uwaterloo.ca  Tue Nov 30 19:57:17 2010
From: pchausse at uwaterloo.ca (Pierre Chausse)
Date: Tue, 30 Nov 2010 13:57:17 -0500
Subject: [Rd] stats::kernel
In-Reply-To: <alpine.LFD.2.00.1011301748550.22358@gannet.stats.ox.ac.uk>
References: <4CF52FCE.80606@uwaterloo.ca>
	<alpine.LFD.2.00.1011301748550.22358@gannet.stats.ox.ac.uk>
Message-ID: <4CF5490D.5010800@uwaterloo.ca>

  Thanks.

It is true that I can set m manually. I just thought that since the 
default depended on the length of coef that it was setting it right when 
coef was a vector. Since when the coef is a name, the default is always 
2, the following modification would make the job.


kernel <- function (coef, m = ifelse(is.character(coef), 2, length(coef) 
- 1), r, name = "unknown")

best regards.


*Pierre Chausse*
Assistant Professor
Department of Economics
University of Waterloo


From proebuck at mdanderson.org  Tue Nov 30 22:16:34 2010
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Tue, 30 Nov 2010 15:16:34 -0600
Subject: [Rd] FW:  documentation for representation() typo
In-Reply-To: <C8EDD1E2.DFE4%proebuck@mdanderson.org>
Message-ID: <C91AC5D2.10373%proebuck@mdanderson.org>

This typo was never corrected. Original post from last month had incorrect
file extension on URL, accidentally injured in a drive-by edit...


<https://svn.r-project.org/R/trunk/src/library/methods/man/representation.Rd
>


50c50
<  The value of \code{representation} is just the list of arguments,
---
>  The value pf \code{representation}  is just the list of arguments, after
these have been checked


51c51
<  after these have been checked for validity.
---
>  for validity.


