From nicholas.hirschey at hotmail.com  Sat May  1 00:23:01 2010
From: nicholas.hirschey at hotmail.com (Nicholas Hirschey)
Date: Fri, 30 Apr 2010 18:23:01 -0400
Subject: [Rd] as.character() crashes R 2.11 on Win2008 x64 and Win7 64
Message-ID: <BLU0-SMTP31267DAB7A68CA152E70E8EB000@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100430/f44fe1c7/attachment.pl>

From wdunlap at tibco.com  Sat May  1 00:40:21 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 30 Apr 2010 15:40:21 -0700
Subject: [Rd] na.action(lmObject) -> NULL instead of lmObject$na.action
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70002DA5173@NA-PA-VBE03.na.tibco.com>

I think the following three calls to na.action() should
return the same thing, but the last returns NULL.

  > d <- data.frame(x=c(1,2,NA,NA,5), y=log(1:5),
row.names=LETTERS[1:5])
  > na.action(na.exclude(d))
  C D
  3 4
  attr(,"class")
  [1] "exclude"
  > na.action(model.frame(y~x, data=d, na.action=na.exclude))
  C D
  3 4
  attr(,"class")
  [1] "exclude"
  > na.action(fit <- lm(y~x, data=d, na.action=na.exclude))
  NULL

lm() returns a list component called "na.action" while
na.exclude() and model.frame() return the same thing as
an attribute called "na.action".

  > fit$na.action
  C D
  3 4
  attr(,"class")
  [1] "exclude"

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 


From murdoch.duncan at gmail.com  Sat May  1 01:23:27 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 30 Apr 2010 19:23:27 -0400
Subject: [Rd] as.character() crashes R 2.11 on Win2008 x64 and Win7 64
In-Reply-To: <BLU0-SMTP31267DAB7A68CA152E70E8EB000@phx.gbl>
References: <BLU0-SMTP31267DAB7A68CA152E70E8EB000@phx.gbl>
Message-ID: <4BDB666F.6070409@gmail.com>

On 30/04/2010 6:23 PM, Nicholas Hirschey wrote:
> Dear List,
>
>
>
> I have a Date vector, and converting to character causes R&nbsp;2.11 to&nbsp;crash on one machine running Win2008 x64 and another running Win7 x64. The code runs fine on R 2.10.
>
>
> For example,
> x &lt;-&nbsp;as.Date(rep(1:15000, 10), '1970-01-01')
> y &lt;- as.character(x)
>
>
> At this point, Rgui crashes.
>
>
> I get this using both the 32 and 64 bit 2.11.0 R builds.
>
>
> I'd appreciate any suggestions for how to eliminate these crashes (particularly with the x64 version).
>   

Use R-patched.

Duncan Murdoch
>
> Thanks,
>
> Nick
>
>
>
> The windows error log and session information is pasted below:
>
>
>
> &gt; sessionInfo()
>
> R version 2.11.0 (2010-04-22) 
>
> i386-pc-mingw32 
>
>
>
> locale:
>
> [1] LC_COLLATE=English_United States.1252 
>
> [2] LC_CTYPE=English_United States.1252   
>
> [3] LC_MONETARY=English_United States.1252
>
> [4] LC_NUMERIC=C                          
>
> [5] LC_TIME=English_United States.1252    
>
>
>
> attached base packages:
>
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>
> Log Name:      Application
>
> Source:        Application Error
>
> Date:          4/28/2010 3:00:23 PM
>
> Event ID:      1000
>
> Task Category: (100)
>
> Level:         Error
>
> Keywords:      Classic
>
> User:          N/A
>
> Computer:      
>
> Description:
>
> Faulting application name: Rgui.exe, version: 2.110.51801.0, time stamp: 0x4bd040ca
>
> Faulting module name: msvcrt.dll, version: 7.0.7600.16385, time stamp: 0x4a5bda6f
>
> Exception code: 0xc00000fd
>
> Fault offset: 0x0000a514
>
> Faulting process id: 0x29cc
>
> Faulting application start time: 0x01cae704e41e3609
>
> Faulting application path: C:\Users\hirschen\Documents\R\R-2.11.0\bin\Rgui.exe
>
> Faulting module path: C:\Windows\syswow64\msvcrt.dll
>
> Report Id: 4c17218f-52f8-11df-9214-0026b95eb365
>
> Event Xml:
>
> &lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;
>
>   &lt;System&gt;
>
>     &lt;Provider Name="Application Error" /&gt;
>
>     &lt;EventID Qualifiers="0"&gt;1000&lt;/EventID&gt;
>
>     &lt;Level&gt;2&lt;/Level&gt;
>
>     &lt;Task&gt;100&lt;/Task&gt;
>
>     &lt;Keywords&gt;0x80000000000000&lt;/Keywords&gt;
>
>     &lt;TimeCreated SystemTime="2010-04-28T19:00:23.000000000Z" /&gt;
>
>     &lt;EventRecordID&gt;3586&lt;/EventRecordID&gt;
>
>     &lt;Channel&gt;Application&lt;/Channel&gt;
>
>     &lt;Computer&gt;&lt;/Computer&gt;
>
>     &lt;Security /&gt;
>
>   &lt;/System&gt;
>
>   &lt;EventData&gt;
>
>     &lt;Data&gt;Rgui.exe&lt;/Data&gt;
>
>     &lt;Data&gt;2.110.51801.0&lt;/Data&gt;
>
>     &lt;Data&gt;4bd040ca&lt;/Data&gt;
>
>     &lt;Data&gt;msvcrt.dll&lt;/Data&gt;
>
>     &lt;Data&gt;7.0.7600.16385&lt;/Data&gt;
>
>     &lt;Data&gt;4a5bda6f&lt;/Data&gt;
>
>     &lt;Data&gt;c00000fd&lt;/Data&gt;
>
>     &lt;Data&gt;0000a514&lt;/Data&gt;
>
>     &lt;Data&gt;29cc&lt;/Data&gt;
>
>     &lt;Data&gt;01cae704e41e3609&lt;/Data&gt;
>
>     &lt;Data&gt;C:\Users\hirschen\Documents\R\R-2.11.0\bin\Rgui.exe&lt;/Data&gt;
>
>     &lt;Data&gt;C:\Windows\syswow64\msvcrt.dll&lt;/Data&gt;
>
>     &lt;Data&gt;4c17218f-52f8-11df-9214-0026b95eb365&lt;/Data&gt;
>
>   &lt;/EventData&gt;
>
> &lt;/Event&gt;
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From romain.francois at dbmail.com  Sat May  1 10:15:06 2010
From: romain.francois at dbmail.com (Romain Francois)
Date: Sat, 01 May 2010 10:15:06 +0200
Subject: [Rd] RInside & child threads
In-Reply-To: <v2oc376fef21004301032g719cbd54r29cee7c6d0df7c12@mail.gmail.com>
References: <v2oc376fef21004301032g719cbd54r29cee7c6d0df7c12@mail.gmail.com>
Message-ID: <4BDBE30A.4020701@dbmail.com>


Hi,

Thank you for your interest in RInside.

We usually engage people to use the Rcpp-devel mailing list for 
questions about RInside.

Could you prepare a small example of what you are trying to achieve and 
repost there. 
https://lists.r-forge.r-project.org/cgi-bin/mailman/listinfo/rcpp-devel

Romain

Le 30/04/10 19:32, Jaiganesh Balasubramanian a ?crit :
>
> Hi Folks,
>
> I am creating a multi-threaded C++ application that initializes RInside in
> one of the child thread.
>
> I would also like to access support interfaces like Rcpp::Environment in the
> remaining child threads, so that I could access any "R" function associated
> with the
> environment initialized.
>
> When I run my program, I always get "C Stack limit too huge" errors.
>
> I looked at the "Writing R Extensions" manual, and it pointed to
> initializing the R_CStackLimit variable to "-1", and
> that this initialization need to be made after the RInside constructor is
> called. I did that, but it still does not work.
>
> Can you please let me know how do we accomplish this task?
>
> Thanks very much,
> Jai



-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9aKDM9 : embed images in Rd documents
|- http://tr.im/OIXN : raster images and RImageJ
|- http://tr.im/OcQe : Rcpp 0.7.7


From romain.francois at dbmail.com  Sat May  1 10:15:22 2010
From: romain.francois at dbmail.com (Romain Francois)
Date: Sat, 01 May 2010 10:15:22 +0200
Subject: [Rd] RInside & child threads
In-Reply-To: <v2oc376fef21004301032g719cbd54r29cee7c6d0df7c12@mail.gmail.com>
References: <v2oc376fef21004301032g719cbd54r29cee7c6d0df7c12@mail.gmail.com>
Message-ID: <4BDBE31A.4070509@dbmail.com>


Hi,

Thank you for your interest in RInside.

We usually engage people to use the Rcpp-devel mailing list for 
questions about RInside.

Could you prepare a small example of what you are trying to achieve and 
repost there. 
https://lists.r-forge.r-project.org/cgi-bin/mailman/listinfo/rcpp-devel

Romain

Le 30/04/10 19:32, Jaiganesh Balasubramanian a ?crit :
>
> Hi Folks,
>
> I am creating a multi-threaded C++ application that initializes RInside in
> one of the child thread.
>
> I would also like to access support interfaces like Rcpp::Environment in the
> remaining child threads, so that I could access any "R" function associated
> with the
> environment initialized.
>
> When I run my program, I always get "C Stack limit too huge" errors.
>
> I looked at the "Writing R Extensions" manual, and it pointed to
> initializing the R_CStackLimit variable to "-1", and
> that this initialization need to be made after the RInside constructor is
> called. I did that, but it still does not work.
>
> Can you please let me know how do we accomplish this task?
>
> Thanks very much,
> Jai



-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9aKDM9 : embed images in Rd documents
|- http://tr.im/OIXN : raster images and RImageJ
|- http://tr.im/OcQe : Rcpp 0.7.7


From romain.francois at dbmail.com  Sat May  1 11:02:35 2010
From: romain.francois at dbmail.com (Romain Francois)
Date: Sat, 01 May 2010 11:02:35 +0200
Subject: [Rd] Memory allocation in C/C++ vs R?
In-Reply-To: <F58D45DC-69AB-43C5-B6E4-CE5C87354DBE@r-project.org>
References: <m2qd4cf43b61004292203x8265d834wb1d42c483813d55d@mail.gmail.com>	<491D8740-466D-4442-B6BE-942A9C423CD0@r-project.org>	<u2vd4cf43b61004301040jc5a99578k9b44b41e7b414b0a@mail.gmail.com>
	<F58D45DC-69AB-43C5-B6E4-CE5C87354DBE@r-project.org>
Message-ID: <4BDBEE2B.8020103@dbmail.com>


Simon,

Le 30/04/10 20:12, Simon Urbanek a ?crit :
>
> Dominick,
>
> On Apr 30, 2010, at 1:40 PM, Dominick Samperi wrote:
>
>> Just to be sure that I understand, are you suggesting that the R-safe way to do things is to not use STL, and to not use C++ memory management and exception handling? How can you leave a function in an irregular way without triggering a seg fault or something like that, in which case there is no chance for recovery anyway?
>>
>> In my experience the C++ exception stack seems to unwind properly before returning to R when there is an exception, and memory that is allocated by C++ functions seems to maintain its integrity and does not interfere with R's memory management.
>>
>> It would be helpful if you could specify what kind of interference you are referring to here between C++ exception handling and R's error handling, and why STL is dangerous and best avoided in R. I have used STL with R for a long time and have experienced no problems.
>>
>
> There are essentially two issues here that I had in mind.
>
> 1) C++ exception handling and R exceptions handling both use setjmp/longjmp with the assumption that no one else does the same. That assumption is voided when both are used so interleaving them will cause problems (you're fine if you can guarantee that they always stack but that's not always easy to achieve yet easy to miss).
>
> 2) C++ compilers assume that you cannot leave the context of a function in unusual ways. But you can, namely if an R error is raised. This affects (among others) locally allocated objects.


Thank you for these nuggets of information. It might be beneficial to 
promote them to some notes in the "Interfacing C++ code" section of WRE.



As a side note for users of Rcpp. In recent versions of Rcpp, we take 
precautions against the R error/c++ exception problem. We engage users 
to always enclose each c++ function in explicit try/catch/forward to R, 
and in Rcpp 0.8.0 (about to be released) we have macros BEGIN_RCPP / 
END_RCPP.

So foo below would become :

extern "C" SEXP foo() {
  BEGIN_RCPP
  vector <int> a;
  a.resize(-1);
  END_RCPP
  return R_NilValue;
}

We also have less invasive macros RCPP_FUNCTION_0, ..., 
RCPP_FUNCTION_65, and RCPP_FUNCTION_VOID_0, ..., so that one can write 
foo as:

RCPP_FUNCTION_VOID_0(foo){
	vector <int> a;
	a.resize(-1);
}


We also take care of the second problem, so that callbacks to R through 
the Rcpp api are enclosed in R tryCatch blocks, through our 
Evaluator::run :

SEXP Evaluator::run(SEXP expr, SEXP env) throw(eval_error) {
	SEXP call = PROTECT( Rf_lang3( Rf_install("rcpp_tryCatch") , expr, env 
) ) ;
	
    	Environment RCPP = Environment::Rcpp_namespace();
    	
	/* call the tryCatch call */
	SEXP res = PROTECT( Rf_eval( call, RCPP ) );
	
	/* was there an error ? */
	int error = LOGICAL( Rf_eval( Rf_lang1( Rf_install("errorOccured") ), 
RCPP ) )[0];
	
	if( error ){
		SEXP err_msg = PROTECT( Rf_eval(
			Rf_lang1( Rf_install("getCurrentErrorMessage")),
			RCPP ) );
		std::string message = CHAR(STRING_ELT(err_msg,0)) ;
		UNPROTECT( 3 ) ;
		throw eval_error(message) ;
	} else {
		UNPROTECT(2) ;
		return res ;
	}
     }




So when users of Rcpp do callbacs to R, like this:


Rcpp::Function rnorm( "rnorm" ) ;
rnorm( -10 ) ;

Rcpp catches the R error and c++ify it as a eval_error exception, so 
that it can be handled in terms of c++ try/catch.


This is somewhat a hack due to the lack of explicit C level api for R 
error handling. 
http://www.mail-archive.com/r-devel at r-project.org/msg19300.html



Romain

> On 1:
>
> You cannot interleave R error handling and C++ exceptions. For example if there is a chance of a C++ exception you must guarantee that the exception won't leave the R context that you are in. This is easily demonstrated because R check the consistency (see ex.1). Vice versa the consequences are not easily visible, because C++ provides no tracking, but is equally fatal. If you raise R exception from C++ it does not clean up whatever C++ exception context you were it and bypasses it. But there are even more grave consequences:
>
> On 2:
>
> If you any R error from within C++ code you'll break the assumption of C++ that it has control over the entry/exit point of a function. Take a really trivial example:
>
> void foo() {
> Object o;
> // some other code ....
> error("blah")
>
> normally, the life of o is controlled by C++ and it will correctly execute its destructor when you leave the function. However, the error call in R will cause it to bypass that, the object won't be destroyed even though it was allocated on the stack. Although it's obvious in the example above, pretty much all R API function can raise errors so the same applies to any R API call - direct or indirect. As a consequence you pretty much cannot call R API function from C++ unless you are very, very careful (don't forget that C++ does a lot of things behind your back such as initializing objects, exception contexts etc. which you technically have no control over).
>
>
> As I said in my post, you can write safe C++ code, but you have to be very careful. But the point about libraries is that you have no control over what they do, so you cannot know whether they will interact in a bad way with R or not. STL is an example where only the interface is defined, the implementations are not and vary by OS, compiler etc. This makes it pretty much impossible to use it reliably since the fact that it will work on one implementation doesn't mean that it will work on another since it is the implementation details that will bite you. (I know that we had reports of things breaking due to STL but I don't remember what implementation/OS it was)
>
> [The above issue are only the ones I was pointing out, there may be others that are not covered here].
>
> Cheers,
> Simon
>
>
>
>
> ---- R context vs C++ exception example
>
>
>> dyn.load("stl.so")
>> .Call("bar")
> something went wrong somewhere in C++...
> Warning: stack imbalance in '.Call', 2 then 4
> NULL
>
> -- what happens is that this really corrupts the R call stack since the C++ exception mechanism bypassed R's call stack so R is now is an inconsistent state. The same can be invoked vice-versa (and is more common - using error in C++ will do it) but that's harder to show because you would have to track C++ allocations to see that you're leaking objects all over the place. That is also the reason why it's hard to find unless it's too late (and things may *appear* to work for some time while they are not).
>
>
> ----stl.cc:
>
> #include<Rinternals.h>
> #include<vector>
>
> using namespace std;
>
> extern "C" SEXP foo() {
>   vector<int>  a;
>   a.resize(-1);
>   return R_NilValue;
> }
>
> extern "C" SEXP bar() {
>   try {
>     // lots of other C++ code here ...
>     eval(lang2(install(".Call"),mkString("foo")), R_GlobalEnv);
>   } catch (...) {
>     REprintf("something went wrong somewhere in C++...\n");
>   }
>   return R_NilValue;
> }
>
>> The fact that R has a C main may be problematic because C++ static
>> initializers may not be called properly, but the fact that packages are
>> usually loaded dynamically complicates this picture. The dynamic
>> library itself may take care of calling the static initializers (I'm not
>> sure about this, and this is probably OS-dependent). One possible
>> work-around would be to compile the first few lines (a stub) of
>> R main using the C++ compiler, leaving everything else as is
>> and compiled using the C compiler (at least until CXXR is widely
>> available).
>>
>> Since C++ (and STL) are very popular it would be helpful for developers
>> to have a better idea of the benefits and risks of using these tools
>> with R.
>>
>> Thanks,
>> Dominick
>>
>> On Fri, Apr 30, 2010 at 9:00 AM, Simon Urbanek
>> <simon.urbanek at r-project.org>  wrote:
>>> Brian's answer was pretty exhaustive - just one more note that is indirectly related to memory management: C++ exception handling does interfere with R's error handling (and vice versa) so in general STL is very dangerous and best avoided in R. In addition, remember that regular local object rules are broken because you are not guaranteed to leave a function the regular way so there is a high danger of leaks and inconsistencies when using C++ memory management unless you specifically account for that. That said, I have written C++ code that works in R but you have to be very, very careful and think twice about using any complex C++ libraries since they are unlikely written in R-safe way.
>>>
>>> Cheers,
>>> Simon
>>>
>>>
>>> On Apr 30, 2010, at 1:03 AM, Dominick Samperi wrote:
>>>
>>>> The R docs say that there are two methods that the C programmer can
>>>> allocate memory, one where R automatically frees the memory on
>>>> return from .C/.Call, and the other where the user takes responsibility
>>>> for freeing the storage. Both methods involve using R-provided
>>>> functions.
>>>>
>>>> What happens when the user uses the standard "new" allocator?
>>>> What about when a C++ application uses STL and that library
>>>> allocates memory? In both of these cases the R-provided functions
>>>> are not used (to my knowledge), yet I have not seen any problems.
>>>>
>>>> How is the memory that R manages and garbage collects kept
>>>> separate from the memory that is allocated on the C++ side
>>>> quite independently of what R is doing?
>>>>
>>>> Thanks,
>>>> Dominick

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9aKDM9 : embed images in Rd documents
|- http://tr.im/OIXN : raster images and RImageJ
|- http://tr.im/OcQe : Rcpp 0.7.7


From murdoch.duncan at gmail.com  Sat May  1 13:10:41 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 01 May 2010 07:10:41 -0400
Subject: [Rd] Possible bug in POSIX classes for R 2.11.0?
In-Reply-To: <EA27D7728FE1E84BB71A329047339137045E39E8@sjmail2.symmetricom.com>
References: <EA27D7728FE1E84BB71A329047339137045E39E8@sjmail2.symmetricom.com>
Message-ID: <4BDC0C31.2040109@gmail.com>

On 30/04/2010 12:46 PM, Lester Wollman wrote:
> To the R development team;
>
> I found an unusual behavior in zoo when I upgraded to R 2.11.0 - it abruptly terminated when I performed certain operations on large zoo objects.  I sent an e-mail to Achim Zeileis and he said this was a potential bug that I should report to the R development team.  The details are given below in the thread below.  Basically, I can crash R with this code:
>
> library(zoo)
> x <- runif(140000, 2009, 2010)
> x <- as.yearmon(x)
> table(x)
>
> This will not crash with a vector of size 130000.
>
> Achim got it to crash with the following code that did not use zoo:
>
> x <- rep(as.Date("1970-01-01"), 140000)
> y <- as.POSIXlt(x)
> z <- format(y, "%d")
>
> I did find a work around, so this is no longer an immediate problem for me, but it would be better if the problem didn't exist in the first place.  Thank you for your help.
>   

Have you tried R-patched?  This looks like a bug that was fixed there 
recently.  See

https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=14267

for details.

Duncan Murdoch

> Lester Wollman
> Corporate Statistician
> Symmetricom, Inc.
> Lwollman at symmetricom.com
>
>
>
> -----Original Message-----
> From: Achim Zeileis [mailto:Achim.Zeileis at uibk.ac.at] 
> Sent: Thursday, April 29, 2010 1:16 PM
> To: Lester Wollman
> Subject: Re: Unusual behavior of zoo and R2.11.0 - simple operation on large zoo object crashes R
>
> Lester,
>
> thanks for the report. The problem does not seem to be in "zoo" but in the 
> new POSIX classes and/or their their coercion from "Date".
>
> The following should reproduce your crash:
>
> x <- rep(as.Date("1970-01-01"), 140000)
> y <- as.POSIXlt(x)
> z <- format(y, "%d")
>
> The reason is probably that R-core changed the internals of all the POSIX 
> stuff. Furthermore, this problem appears to be fixed in 2.12.0 (the 
> current devel version). Maybe you can ask on R-devel whether this is a 
> know issue (my guess is that it is).
>
> Thanks for the report && best wishes,
> Z
>
> On Thu, 29 Apr 2010, Lester Wollman wrote:
>
>   
>> Achim,
>>
>>  
>>
>> I found unusual behavior, or even possibly a bug,  in zoo.  When I run the
>> code below, R crashes.  There is no error message,  R simply exits with no
>> warning.
>>
>>  
>>
>>  
>>
>> library(zoo)
>>
>> x <- runif(140000, 2009, 2010)     # Random days in 2009
>>
>> x <- as.yearmon(x)                 # This works
>>
>> table(x)                           #  This crashes. print(x) also crashes R. summary(x) does not
>>
>>
>>  
>>
>>  
>>
>> However, if I change the number of random dates to 130000, there is no
>> problem.
>>
>>  
>>
>> I have been using zoo for a few years with no problems,  including using
>> code similar to the one above.  I did just upgrade to R 2.11.0 and this is
>> my first use of zoo for a large vector since the upgrade.
>>
>>  
>>
>> I cannot tell if the problem is with zoo or R or my machine.  I tried
>> installing zoo from CRAN instead of R-Forge, but that did not help. 
>> Increasing the memory limit to 3G did not help either.
>>
>>  
>>
>> I attached relevant (and irrelevant) system information below.  I am using R
>> with Tinn-R and Tinn-R loads some packages (Hmisc, R2HTML, etc.)
>>
>>  
>>
>> Thank you for your help.
>>
>>  
>>
>>  
>>
>> Lester Wollman
>>
>> Corporate Statistician
>>
>> Symmetricom, Inc.
>>
>> lwollman at symmetricom.com
>>
>>  
>>
>>  
>>
>>  
>>
>>  
>>
>>     
>>> sessionInfo()
>>>       
>>  
>>
>> R version 2.11.0 (2010-04-22)
>>
>> i386-pc-mingw32
>>
>>  
>>
>> locale:
>>
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252    LC_MONETARY=English_United States.1252
>>
>> [4] LC_NUMERIC=C                           LC_TIME=English_United
>> States.1252   
>>
>>  
>>
>> attached base packages:
>>
>> [1] grDevices datasets  splines   graphics  stats     tcltk     utils    
>> methods   base    
>>
>>  
>>
>> other attached packages:
>>
>> [1] svSocket_0.9-48 TinnR_1.0.3     R2HTML_2.0.0    Hmisc_3.7-0    
>> survival_2.35-8
>>
>>  
>>
>> loaded via a namespace (and not attached):
>>
>> [1] cluster_1.12.3 grid_2.11.0    lattice_0.18-5 svMisc_0.9-57
>>
>>  
>>
>>  
>>
>> System Information:
>>
>> Windows XP Professional Version 2002 Service Pack 3
>>
>>  
>>
>> Computer Information:
>>
>> Dell with Intel CPU
>>
>> T2600 @ 2.16 GHz, 1G of RAM
>>
>>  
>>
>>  
>>
>>  
>>
>> zoo information
>>
>>     
>>> packageDescription("zoo")
>>>       
>> Package: zoo
>>
>> Version: 1.6-3
>>
>> Date: 2010-02-22
>>
>> Title: Z's ordered observations
>>
>> Author: Achim Zeileis, Gabor Grothendieck, Felix Andrews
>>
>> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
>>
>> Description: An S3 class with methods for totally ordered indexed
>> observations. It is particularly aimed at irregular time series of numeric
>> vectors/matrices and factors. zoo's key design goals are independence of a
>> particular index/date/time class and consistency with ts and base R by
>> providing methods to extend standard generics.
>>
>> Depends: R (>= 2.10.0), stats
>>
>> Suggests: coda, chron, DAAG, fCalendar, fSeries, fts, its, lattice,
>> strucchange, timeDate, timeSeries, tis, tseries, xts
>>
>> Imports: stats, utils, graphics, grDevices, lattice (>= 0.18-1)
>>
>> LazyLoad: yes
>>
>> License: GPL-2
>>
>> URL: http://R-Forge.R-project.org/projects/zoo/
>>
>> Repository: R-Forge
>>
>> Repository/R-Forge/Project: zoo
>>
>> Repository/R-Forge/Revision: 688
>>
>> Date/Publication: 2010-03-20 02:29:04
>>
>> Packaged: 2010-03-20 21:59:26 UTC; rforge
>>
>> Built: R 2.11.0; ; 2010-03-22 14:03:33 UTC; windows
>>
>>  
>>
>> -- File: C:/PROGRA~1/STATIS~1/R2110/library/zoo/Meta/package.rds
>>
>>
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From djsamperi at gmail.com  Sat May  1 18:07:36 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Sat, 1 May 2010 12:07:36 -0400
Subject: [Rd] Memory allocation in C/C++ vs R?
In-Reply-To: <4BDBEE2B.8020103@dbmail.com>
References: <m2qd4cf43b61004292203x8265d834wb1d42c483813d55d@mail.gmail.com>
	<491D8740-466D-4442-B6BE-942A9C423CD0@r-project.org>
	<u2vd4cf43b61004301040jc5a99578k9b44b41e7b414b0a@mail.gmail.com>
	<F58D45DC-69AB-43C5-B6E4-CE5C87354DBE@r-project.org>
	<4BDBEE2B.8020103@dbmail.com>
Message-ID: <AANLkTimPA3WjWi4TWbrnE8TtKV6r651jsPZdQWXk4b59@mail.gmail.com>

On Sat, May 1, 2010 at 5:02 AM, Romain Francois
<romain.francois at dbmail.com> wrote:
>
> Simon,
>
> Le 30/04/10 20:12, Simon Urbanek a ?crit :
> Thank you for these nuggets of information. It might be beneficial to
> promote them to some notes in the "Interfacing C++ code" section of WRE.

The manual is also missing information on R_PreserveObject() and
R_ReleaseObject(), useful but undocumented features that are
exploited in Rcpp to elininate the need for the ubiquitous
PROTECT/UNPROTECT macros.

> As a side note for users of Rcpp. In recent versions of Rcpp, we take
> precautions against the R error/c++ exception problem. We engage users to
> always enclose each c++ function in explicit try/catch/forward to R, and in
> Rcpp 0.8.0 (about to be released) we have macros BEGIN_RCPP / END_RCPP.

Good idea.

> So when users of Rcpp do callbacs to R, like this:
>
> Rcpp::Function rnorm( "rnorm" ) ;
> rnorm( -10 ) ;
>
> Rcpp catches the R error and c++ify it as a eval_error exception, so that it
> can be handled in terms of c++ try/catch.
>
> This is somewhat a hack due to the lack of explicit C level api for R error
> handling. http://www.mail-archive.com/r-devel at r-project.org/msg19300.html

Nice trick.

Given the use of undocumented features and the hacks, wouldn't it make
more sense to make Rcpp part of the R core, a kind of limited implementation
of CXXR?

With these hacks, along with a small change in the way R is built, it seems
like most of the C++ issues disappear. The change I am referring to is to
compile main.c (or a stub part of it) using C++ instead of C.

This would take care of the one remaining C++ issue: static initializers not
being called. Apparently this issue does not come up in most situations
because R links to packages that use C++ via the runtime system /
shared library mechanism, and this mechanism takes care of the
necessary static initialization. This may not work under all OS's
though, and building main.c using C++ would solve this problem.

Another advatage of building main.c using C++ is that R becomes
a C++ application (that just happens to be largely composed of C
modules). This would open more possibilities for R development
without requiring a complete refactoring as in the case of CXXR.

Dominick


From shotwelm at musc.edu  Sun May  2 22:30:51 2010
From: shotwelm at musc.edu (Matt Shotwell)
Date: Sun, 02 May 2010 16:30:51 -0400
Subject: [Rd] tty (serial) patch update
Message-ID: <1272832251.7549.63.camel@deacon>

All, 

Just an update on the tty (formerly serial) connection patch I'm working
on. Simon pointed out that a tty connection needed blocking capability
and flow control. These features are added in this patch, with
additional documentation (?tty). Hardware flow control (CTS/RTS, CD,
etc.) would be much more involved (ioctls!), and for little gain, I
think, to those of us who would use a tty connection to collect data
from / control a device with a simple UART.

I'm not sure how to proceed from here. The features available at present
in the tty connection are highly portable (i.e. to Windows). There are
other API elements that could be exposed from the termios.h header for
Linux/OS X, such as canonical mode (designed for human interaction,
block until '\n' received, recognize <del> character and other control
characters, generate interrupts), and input and output processing (e.g.
mapping '\n' to '\r' etc.), but these are definitely not portable, and
not really relevant to the purpose I had envisioned for a tty connection
(which is binary data collection, device control, and other UART
interfaces). Most of the additional features could be reproduced using
interpreted R code with little effort.

So what do you think? Stay portable and expand to Windows? Exploit the
full POSIX termios functionality? Expose connections API and write a
package instead? Forget about the whole thing?

-Matt

Current patch URLs:

http://biostatmatt.com/R/R-2.11.0-tty.patch
http://biostatmatt.com/R/R-2.11.0-tty+conf.patch
http://biostatmatt.com/archives/112


`diffstat -f0 R-2.11.0-tty.patch` :

configure.ac                        |    2 	1 +	1 -
src/include/Internal.h              |    2 	2 +	0 -
src/library/base/R/connections.R    |   11 	11 +	0 -
src/library/base/man/connections.Rd |  112 	100 +	12 -
src/main/connections.c              |  527 	527 +	0 -
src/main/names.c                    |    2 	2 +	0 -
6 files changed, 643 insertions(+), 13 deletions(-)


From chuckwhite8 at charter.net  Mon May  3 05:52:15 2010
From: chuckwhite8 at charter.net (Chuck White)
Date: Sun, 2 May 2010 23:52:15 -0400
Subject: [Rd] R 2.11.0 on RHEL5
In-Reply-To: <836E9710-B860-48B3-A827-40724B6EEFED@stat.berkeley.edu>
Message-ID: <20100502235215.JNXR7.5567018.root@mp06>

I have built lapack-3.2 and atlas3.8.3 for a RHEL5.3 VM.  The following files have been created -- libatlas (.a & .so), libcblas (.a & .so), libf77blas (.a & .so), liblapack (.a & .so), libptcblas (.a & .so), libptf77blas (.a & .so) and libstatatlas.a.

When building R 2.11.0, I would like to be able to specify --with-blas and --with-lapack (and not use the ones which come with R). What is the syntax for that? Which of these libraries should I specify?

Thanks.


From chuckwhite8 at charter.net  Mon May  3 06:02:49 2010
From: chuckwhite8 at charter.net (Chuck White)
Date: Mon, 3 May 2010 0:02:49 -0400
Subject: [Rd] R 2.11.0 on RHEL5
Message-ID: <20100503000249.YXHNQ.5567321.root@mp06>

I have built lapack-3.2 and atlas3.8.3 for a RHEL5.3 VM.  The following files have been created -- libatlas (.a & .so), libcblas (.a & .so), libf77blas (.a & .so), liblapack (.a & .so), libptcblas (.a & .so), libptf77blas (.a & .so) and libstatatlas.a.

When building R 2.11.0, I would like to be able to specify --with-blas and --with-lapack (and not use the ones which come with R). What is the syntax for that? Which of these libraries should I specify?

Thanks.


From ligges at statistik.tu-dortmund.de  Mon May  3 09:29:15 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 03 May 2010 09:29:15 +0200
Subject: [Rd] R 2.11.0 on RHEL5
In-Reply-To: <20100503000249.YXHNQ.5567321.root@mp06>
References: <20100503000249.YXHNQ.5567321.root@mp06>
Message-ID: <4BDE7B4B.3090505@statistik.tu-dortmund.de>

This is explained in detail in the manual "R Installation and 
Administration".

Best,
Uwe Ligges


On 03.05.2010 06:02, Chuck White wrote:
> I have built lapack-3.2 and atlas3.8.3 for a RHEL5.3 VM.  The following files have been created -- libatlas (.a&  .so), libcblas (.a&  .so), libf77blas (.a&  .so), liblapack (.a&  .so), libptcblas (.a&  .so), libptf77blas (.a&  .so) and libstatatlas.a.
>
> When building R 2.11.0, I would like to be able to specify --with-blas and --with-lapack (and not use the ones which come with R). What is the syntax for that? Which of these libraries should I specify?
>
> Thanks.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From b.rowlingson at lancaster.ac.uk  Tue May  4 16:30:06 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 4 May 2010 15:30:06 +0100
Subject: [Rd] automatically loading packages
Message-ID: <n2td8ad40b51005040730qb81c404aj4c1b7944bba08f08@mail.gmail.com>

If I start an R session with a previously saved .RData that has S4
objects in it, there are times when the associated package loads when
I use (or mention) the object, and times when it doesn't. For example:

 > dim(casesIn)
 NULL
 > library(sp)
 > dim(casesIn)
 [1] 726  22

 - because casesIn is a SpatialPointsDataFrame. But if I try and plot
it (starting from scratch again), it loads the sp package:

 > plot(casesIn)
 Loading required package: sp

 - and then falls over:

 Error in as.double(y) :
   cannot coerce type 'S4' to vector of type 'double'

 - which is the error you get from plot.default(casesIn).

 Trying plot(casesIn) again then works, producing a point map. Why
doesn't it work the first time?

 dim(casesIn) never triggers a library(sp) call:

 > dim(casesIn)
 NULL

 - so do it manually:

 > library(sp)
 > dim(casesIn)
 [1] 726  22

 - I guess it must depend on whether its a generic of S3 or S4 flavour
and/or the current phase of the moon.

 I can't find any information about this behaviour, and I can't think
of a good query to search for it either. I keep hitting the 'autoload'
documentation, which seems to be something completely different.

R 2.10.1 on Linux - can't see anything relevant in the latest NEWS file.

Barry


From jayemerson at gmail.com  Tue May  4 22:37:36 2010
From: jayemerson at gmail.com (Jay Emerson)
Date: Tue, 4 May 2010 16:37:36 -0400
Subject: [Rd] split() bug? Inconsistent Windows/Linux behavior.
Message-ID: <p2xd4588dec1005041337y8ad4926od55881987e5ec177@mail.gmail.com>

I didn't see anything on this in the bug reports, and a search of the
archives had lots of false positives when searching on "split" to be
helpful.

I don't view this as particularly interesting or useful, but wanted to
report it because I stumbled on it (and don't remember ever seeing
"invalid permissions" as part of a segfault).? Yes, I realize this is
a silly example that you wouldn't actually do, but... there may be
other more interesting cases with the same problem.? The following was
R-2.10.0 on Linux (with a Windows-64 2.11.0 difference to follow
below):

> data(iris)
> split(1:nrow(iris), list(iris[,1], iris[,2]))

?*** caught segfault ***
address 0x7fc806cd3d0c, cause 'invalid permissions'

Traceback:
?1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
?2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace

In contrast, R-2.11.0 in Windows-64:

> data(iris)
> split(1:nrow(iris), list(iris[,1], iris[,2]))

Traceback:
?1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
?2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
Error in split.default(1:nrow(iris), list(iris[, 1], iris[, 2])) :
? caught access violation - continue with care

However, the same commands with drop=TRUE returns something, though
the answers differ.? In Linux:

> a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
> length(a)
[1] 116

And in Windows, differing only in the extra returned element, which I
don't think should probably be part of the answer (there are no
missing values in the iris data):

> a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
> length(a)
[1] 117
> a[117]
$<NA>
[1] 16

--
John W. Emerson (Jay)
Associate Professor of Statistics
Department of Statistics
Yale University
http://www.stat.yale.edu/~jay


From shotwelm at musc.edu  Wed May  5 00:45:48 2010
From: shotwelm at musc.edu (Matt Shotwell)
Date: Tue, 04 May 2010 18:45:48 -0400
Subject: [Rd] split() bug? Inconsistent Windows/Linux behavior.
In-Reply-To: <p2xd4588dec1005041337y8ad4926od55881987e5ec177@mail.gmail.com>
References: <p2xd4588dec1005041337y8ad4926od55881987e5ec177@mail.gmail.com>
Message-ID: <1273013148.6574.15.camel@deacon>

This is odd, I think it may have something to do with this

> f <- interaction(list(iris[,1], iris[,2]))
> f[16]
[1] <NA>
> unclass(f)[16]
[1] 785
> nlevels(f)
[1] 781

Maybe do_split dereferencing beyond allocated memory?

> interaction(list(iris[,1], iris[,2]), sep="-")

does not produce <NA> at index 16

-Matt

On Tue, 2010-05-04 at 16:37 -0400, Jay Emerson wrote:
> I didn't see anything on this in the bug reports, and a search of the
> archives had lots of false positives when searching on "split" to be
> helpful.
> 
> I don't view this as particularly interesting or useful, but wanted to
> report it because I stumbled on it (and don't remember ever seeing
> "invalid permissions" as part of a segfault).  Yes, I realize this is
> a silly example that you wouldn't actually do, but... there may be
> other more interesting cases with the same problem.  The following was
> R-2.10.0 on Linux (with a Windows-64 2.11.0 difference to follow
> below):
> 
> > data(iris)
> > split(1:nrow(iris), list(iris[,1], iris[,2]))
> 
>  *** caught segfault ***
> address 0x7fc806cd3d0c, cause 'invalid permissions'
> 
> Traceback:
>  1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
>  2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> 
> In contrast, R-2.11.0 in Windows-64:
> 
> > data(iris)
> > split(1:nrow(iris), list(iris[,1], iris[,2]))
> 
> Traceback:
>  1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
>  2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
> Error in split.default(1:nrow(iris), list(iris[, 1], iris[, 2])) :
>   caught access violation - continue with care
> 
> However, the same commands with drop=TRUE returns something, though
> the answers differ.  In Linux:
> 
> > a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
> > length(a)
> [1] 116
> 
> And in Windows, differing only in the extra returned element, which I
> don't think should probably be part of the answer (there are no
> missing values in the iris data):
> 
> > a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
> > length(a)
> [1] 117
> > a[117]
> $<NA>
> [1] 16
> 
> --
> John W. Emerson (Jay)
> Associate Professor of Statistics
> Department of Statistics
> Yale University
> http://www.stat.yale.edu/~jay
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Wed May  5 02:08:47 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 04 May 2010 20:08:47 -0400
Subject: [Rd] split() bug? Inconsistent Windows/Linux behavior.
In-Reply-To: <1273013148.6574.15.camel@deacon>
References: <p2xd4588dec1005041337y8ad4926od55881987e5ec177@mail.gmail.com>
	<1273013148.6574.15.camel@deacon>
Message-ID: <4BE0B70F.9030102@gmail.com>

On 04/05/2010 6:45 PM, Matt Shotwell wrote:
> This is odd, I think it may have something to do with this
>   

Yes, it's definitely a bug in interaction() rather than split() per se.  
I'll take a look and see if I can fix it.

Duncan Murdoch
>   
>> f <- interaction(list(iris[,1], iris[,2]))
>> f[16]
>>     
> [1] <NA>
>   
>> unclass(f)[16]
>>     
> [1] 785
>   
>> nlevels(f)
>>     
> [1] 781
>
> Maybe do_split dereferencing beyond allocated memory?
>
>   
>> interaction(list(iris[,1], iris[,2]), sep="-")
>>     
>
> does not produce <NA> at index 16
>
> -Matt
>
> On Tue, 2010-05-04 at 16:37 -0400, Jay Emerson wrote:
>   
>> I didn't see anything on this in the bug reports, and a search of the
>> archives had lots of false positives when searching on "split" to be
>> helpful.
>>
>> I don't view this as particularly interesting or useful, but wanted to
>> report it because I stumbled on it (and don't remember ever seeing
>> "invalid permissions" as part of a segfault).  Yes, I realize this is
>> a silly example that you wouldn't actually do, but... there may be
>> other more interesting cases with the same problem.  The following was
>> R-2.10.0 on Linux (with a Windows-64 2.11.0 difference to follow
>> below):
>>
>>     
>>> data(iris)
>>> split(1:nrow(iris), list(iris[,1], iris[,2]))
>>>       
>>  *** caught segfault ***
>> address 0x7fc806cd3d0c, cause 'invalid permissions'
>>
>> Traceback:
>>  1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
>>  2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
>>
>> Possible actions:
>> 1: abort (with core dump, if enabled)
>> 2: normal R exit
>> 3: exit R without saving workspace
>> 4: exit R saving workspace
>>
>> In contrast, R-2.11.0 in Windows-64:
>>
>>     
>>> data(iris)
>>> split(1:nrow(iris), list(iris[,1], iris[,2]))
>>>       
>> Traceback:
>>  1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
>>  2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
>> Error in split.default(1:nrow(iris), list(iris[, 1], iris[, 2])) :
>>   caught access violation - continue with care
>>
>> However, the same commands with drop=TRUE returns something, though
>> the answers differ.  In Linux:
>>
>>     
>>> a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
>>> length(a)
>>>       
>> [1] 116
>>
>> And in Windows, differing only in the extra returned element, which I
>> don't think should probably be part of the answer (there are no
>> missing values in the iris data):
>>
>>     
>>> a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
>>> length(a)
>>>       
>> [1] 117
>>     
>>> a[117]
>>>       
>> $<NA>
>> [1] 16
>>
>> --
>> John W. Emerson (Jay)
>> Associate Professor of Statistics
>> Department of Statistics
>> Yale University
>> http://www.stat.yale.edu/~jay
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch.duncan at gmail.com  Wed May  5 03:50:42 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 04 May 2010 21:50:42 -0400
Subject: [Rd] split() bug? Inconsistent Windows/Linux behavior.
In-Reply-To: <p2xd4588dec1005041337y8ad4926od55881987e5ec177@mail.gmail.com>
References: <p2xd4588dec1005041337y8ad4926od55881987e5ec177@mail.gmail.com>
Message-ID: <4BE0CEF2.70005@gmail.com>

This is now fixed in R-devel (revision 51908), and R-patched (r51909).  
Thanks Jay for the nice reproducible example, and thanks Matt for 
localizing it to the interaction() function.

Duncan Murdoch

On 04/05/2010 4:37 PM, Jay Emerson wrote:
> I didn't see anything on this in the bug reports, and a search of the
> archives had lots of false positives when searching on "split" to be
> helpful.
>
> I don't view this as particularly interesting or useful, but wanted to
> report it because I stumbled on it (and don't remember ever seeing
> "invalid permissions" as part of a segfault).  Yes, I realize this is
> a silly example that you wouldn't actually do, but... there may be
> other more interesting cases with the same problem.  The following was
> R-2.10.0 on Linux (with a Windows-64 2.11.0 difference to follow
> below):
>
>   
>> data(iris)
>> split(1:nrow(iris), list(iris[,1], iris[,2]))
>>     
>
>  *** caught segfault ***
> address 0x7fc806cd3d0c, cause 'invalid permissions'
>
> Traceback:
>  1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
>  2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
>
> In contrast, R-2.11.0 in Windows-64:
>
>   
>> data(iris)
>> split(1:nrow(iris), list(iris[,1], iris[,2]))
>>     
>
> Traceback:
>  1: split.default(1:nrow(iris), list(iris[, 1], iris[, 2]))
>  2: split(1:nrow(iris), list(iris[, 1], iris[, 2]))
> Error in split.default(1:nrow(iris), list(iris[, 1], iris[, 2])) :
>   caught access violation - continue with care
>
> However, the same commands with drop=TRUE returns something, though
> the answers differ.  In Linux:
>
>   
>> a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
>> length(a)
>>     
> [1] 116
>
> And in Windows, differing only in the extra returned element, which I
> don't think should probably be part of the answer (there are no
> missing values in the iris data):
>
>   
>> a <- split(1:nrow(iris), list(iris[,1], iris[,2]), drop=TRUE)
>> length(a)
>>     
> [1] 117
>   
>> a[117]
>>     
> $<NA>
> [1] 16
>
> --
> John W. Emerson (Jay)
> Associate Professor of Statistics
> Department of Statistics
> Yale University
> http://www.stat.yale.edu/~jay
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From chuckwhite8 at charter.net  Wed May  5 04:52:27 2010
From: chuckwhite8 at charter.net (Chuck White)
Date: Tue, 4 May 2010 22:52:27 -0400
Subject: [Rd] R 2.11.0 on RHEL5
In-Reply-To: <4BDE7B4B.3090505@statistik.tu-dortmund.de>
Message-ID: <20100504225227.56GSE.5692750.root@mp17>

Thank you for your response. I did look in the suggested manual under A.3.1.5 Shared BLAS.

Here are my steps: compiled R using
--with-readline=yes --enable-R-shlib=yes --enable-BLAS-shlib=yes --with-x=yes --prefix=/usr/local/R-2.11.0

Compiled LAPACK first and then ATLAS using http://www.scipy.org/Installing_SciPy/Linux#head-89e1f6afaa3314d98a22c79b063cceee2cc6313c   All the .so files have been copied to /usr/lib64

In /usr/local/R-2.11.0/lib64/R/lib, I renamed the .so files for blas and lapack and linked as
libRblas.so -> /usr/local/lib64/libf77blas.so
libRlapack.so -> /usr/local/lib64/liblapack.so

R does startup OK but when I do the following:
require(nlme)
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc), data = Loblolly, fixed = Asym + R0 + lrc ~ 1, random = Asym ~ 1, start = c(Asym = 103, R0 = -8.5, lrc = -3.3)) 

I get
/usr/local/R-2.11.0/lib64/R/bin/exec/R: symbol lookup error: /usr/local/R-2.11.0/lib64/R/lib/libRblas.so: undefined symbol: ATL_dgemm
This runs just fine without using the .so files which were built with R.

Can you please help?  Thanks.

---- Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote: 
> This is explained in detail in the manual "R Installation and 
> Administration".
> 
> Best,
> Uwe Ligges
> 
> 
> On 03.05.2010 06:02, Chuck White wrote:
> > I have built lapack-3.2 and atlas3.8.3 for a RHEL5.3 VM.  The following files have been created -- libatlas (.a&  .so), libcblas (.a&  .so), libf77blas (.a&  .so), liblapack (.a&  .so), libptcblas (.a&  .so), libptf77blas (.a&  .so) and libstatatlas.a.
> >
> > When building R 2.11.0, I would like to be able to specify --with-blas and --with-lapack (and not use the ones which come with R). What is the syntax for that? Which of these libraries should I specify?
> >
> > Thanks.
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Wed May  5 11:29:21 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 05 May 2010 11:29:21 +0200
Subject: [Rd] R 2.11.0 on RHEL5
In-Reply-To: <20100504225227.56GSE.5692750.root@mp17>
References: <20100504225227.56GSE.5692750.root@mp17>
Message-ID: <4BE13A71.4070406@statistik.tu-dortmund.de>



On 05.05.2010 04:52, Chuck White wrote:
> Thank you for your response. I did look in the suggested manual under A.3.1.5 Shared BLAS.
>
> Here are my steps: compiled R using
> --with-readline=yes --enable-R-shlib=yes --enable-BLAS-shlib=yes --with-x=yes --prefix=/usr/local/R-2.11.0


Why do you want shlib support, do you really need it?
For the static case, A.3.1.1 ATLAS described the way to go.


> Compiled LAPACK first and then ATLAS using http://www.scipy.org/Installing_SciPy/Linux#head-89e1f6afaa3314d98a22c79b063cceee2cc6313c   All the .so files have been copied to /usr/lib64
>
> In /usr/local/R-2.11.0/lib64/R/lib, I renamed the .so files for blas and lapack and linked as
> libRblas.so ->  /usr/local/lib64/libf77blas.so
> libRlapack.so ->  /usr/local/lib64/liblapack.so
>
> R does startup OK but when I do the following:
> require(nlme)
> fm1<- nlme(height ~ SSasymp(age, Asym, R0, lrc), data = Loblolly, fixed = Asym + R0 + lrc ~ 1, random = Asym ~ 1, start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
>
> I get
> /usr/local/R-2.11.0/lib64/R/bin/exec/R: symbol lookup error: /usr/local/R-2.11.0/lib64/R/lib/libRblas.so: undefined symbol: ATL_dgemm
> This runs just fine without using the .so files which were built with R.


I have never before linked dynamically to ATLAS versions. ATL_dgemm is 
probably defined in one of the other libraries. I have not looked since 
I currently do not have any ATLAS left on my machines which I was more 
used to roughly 3 years ago.

Uwe Ligges




> Can you please help?  Thanks.
>
> ---- Uwe Ligges<ligges at statistik.tu-dortmund.de>  wrote:
>> This is explained in detail in the manual "R Installation and
>> Administration".
>>
>> Best,
>> Uwe Ligges
>>
>>
>> On 03.05.2010 06:02, Chuck White wrote:
>>> I have built lapack-3.2 and atlas3.8.3 for a RHEL5.3 VM.  The following files have been created -- libatlas (.a&   .so), libcblas (.a&   .so), libf77blas (.a&   .so), liblapack (.a&   .so), libptcblas (.a&   .so), libptf77blas (.a&   .so) and libstatatlas.a.
>>>
>>> When building R 2.11.0, I would like to be able to specify --with-blas and --with-lapack (and not use the ones which come with R). What is the syntax for that? Which of these libraries should I specify?
>>>
>>> Thanks.
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From chuckwhite8 at charter.net  Wed May  5 16:54:22 2010
From: chuckwhite8 at charter.net (Chuck White)
Date: Wed, 5 May 2010 10:54:22 -0400
Subject: [Rd] R 2.11.0 on RHEL5
In-Reply-To: <4BE13A71.4070406@statistik.tu-dortmund.de>
Message-ID: <20100505105422.9LWAG.5708207.root@mp18>

Thanks again for your note.  I am now compiling using:

--with-readline=yes --enable-R-shlib=yes --with-x=yes --with-blas="-llibptf77blas -lpthread -llibatlas" --prefix=/usr/local/R-2.11.0

The above configuration is creating libRlapack.so as well. Do you specify --with-lapack as well? If so, what do you set that to? Section A.3.2 states -- "Please do bear in mind that using --with-lapack is `definitely not recommended': it is provided only because it is necessary on some platforms."

Thanks.

---- Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote: 
> 
> Why do you want shlib support, do you really need it?
> For the static case, A.3.1.1 ATLAS described the way to go.
> 
> I have never before linked dynamically to ATLAS versions. ATL_dgemm is 
> probably defined in one of the other libraries. I have not looked since 
> I currently do not have any ATLAS left on my machines which I was more 
> used to roughly 3 years ago.
> 
> Uwe Ligges


From ligges at statistik.tu-dortmund.de  Wed May  5 17:14:26 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 05 May 2010 17:14:26 +0200
Subject: [Rd] R 2.11.0 on RHEL5
In-Reply-To: <20100505105422.9LWAG.5708207.root@mp18>
References: <20100505105422.9LWAG.5708207.root@mp18>
Message-ID: <4BE18B52.5000606@statistik.tu-dortmund.de>



On 05.05.2010 16:54, Chuck White wrote:
> Thanks again for your note.  I am now compiling using:
>
> --with-readline=yes --enable-R-shlib=yes --with-x=yes --with-blas="-llibptf77blas -lpthread -llibatlas" --prefix=/usr/local/R-2.11.0

Yes, that's essentially what I use (except the shlib flags).

Uwe


> The above configuration is creating libRlapack.so as well. Do you specify --with-lapack as well? If so, what do you set that to? Section A.3.2 states -- "Please do bear in mind that using --with-lapack is `definitely not recommended': it is provided only because it is necessary on some platforms."
>
> Thanks.
>
> ---- Uwe Ligges<ligges at statistik.tu-dortmund.de>  wrote:
>>
>> Why do you want shlib support, do you really need it?
>> For the static case, A.3.1.1 ATLAS described the way to go.
>>
>> I have never before linked dynamically to ATLAS versions. ATL_dgemm is
>> probably defined in one of the other libraries. I have not looked since
>> I currently do not have any ATLAS left on my machines which I was more
>> used to roughly 3 years ago.
>>
>> Uwe Ligges
>


From hadley at rice.edu  Wed May  5 17:57:03 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 5 May 2010 10:57:03 -0500
Subject: [Rd] Generate NA of specified type
Message-ID: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>

Hi all,

Is there an existing function that provides the correct type of
missing value for a given vector? e.g.

NAof(1:3) # NA_integer_
NAof(pi) # NA_real_
NAof("a") # NA_character_
NAof(T) # NA

?

Thanks,

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From taplate at gmail.com  Wed May  5 17:59:50 2010
From: taplate at gmail.com (Tony Plate)
Date: Wed, 05 May 2010 11:59:50 -0400
Subject: [Rd] Generate NA of specified type
In-Reply-To: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>
References: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>
Message-ID: <4BE195F6.70804@acm.org>

I just do as.integer(NA), as.numeric(NA), as.character(NA), etc.
-- Tony Plate

On 5/5/2010 11:57 AM, Hadley Wickham wrote:
> Hi all,
>
> Is there an existing function that provides the correct type of
> missing value for a given vector? e.g.
>
> NAof(1:3) # NA_integer_
> NAof(pi) # NA_real_
> NAof("a") # NA_character_
> NAof(T) # NA
>
> ?
>
> Thanks,
>
> Hadley
>
>


From rdpeng at gmail.com  Wed May  5 18:16:12 2010
From: rdpeng at gmail.com (Roger Peng)
Date: Wed, 5 May 2010 12:16:12 -0400
Subject: [Rd] Generate NA of specified type
In-Reply-To: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>
References: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>
Message-ID: <h2h66f3bd911005050916nf9007da5h96d64ad4430c7de2@mail.gmail.com>

What about NAof <- function(x) as(NA, class(x))?

-roger

On Wed, May 5, 2010 at 11:57 AM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> Is there an existing function that provides the correct type of
> missing value for a given vector? e.g.
>
> NAof(1:3) # NA_integer_
> NAof(pi) # NA_real_
> NAof("a") # NA_character_
> NAof(T) # NA
>
> ?
>
> Thanks,
>
> Hadley
>
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From hadley at rice.edu  Wed May  5 18:25:48 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 5 May 2010 11:25:48 -0500
Subject: [Rd] Generate NA of specified type
In-Reply-To: <h2h66f3bd911005050916nf9007da5h96d64ad4430c7de2@mail.gmail.com>
References: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com> 
	<h2h66f3bd911005050916nf9007da5h96d64ad4430c7de2@mail.gmail.com>
Message-ID: <s2nf8e6ff051005050925w4ee05f43xc052aa4141a4a71b@mail.gmail.com>

> What about NAof <- function(x) as(NA, class(x))?
>

That's pretty close, but it doesn't fail nicely for non-atomics:

> as(NA, class(Sys.Date()))
Error in as(NA, class(Sys.Date())) :
  no method or default for coercing "logical" to "Date"

vs.

> as.Date(NA)
[1] NA

But I'm probably being too fussy (especially since I didn't ask for
that in my original post ;).  I'm currently using this:

NAof <- function(x) {
  length(x) <- 1
  is.na(x) <- TRUE
  x
}

It's rather lacking in elegance :(

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From ggrothendieck at gmail.com  Wed May  5 18:41:47 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 5 May 2010 12:41:47 -0400
Subject: [Rd] Generate NA of specified type
In-Reply-To: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>
References: <h2gf8e6ff051005050857tfe7d7566m797b3abbad5f429c@mail.gmail.com>
Message-ID: <y2u971536df1005050941sbe371c85s710b5ac54ef05a14@mail.gmail.com>

Try this:

replace(x[1][], TRUE, NA)

or

replace(x[[1]][], TRUE, NA)

depending on what you want.

On Wed, May 5, 2010 at 11:57 AM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> Is there an existing function that provides the correct type of
> missing value for a given vector? e.g.
>
> NAof(1:3) # NA_integer_
> NAof(pi) # NA_real_
> NAof("a") # NA_character_
> NAof(T) # NA
>
> ?
>
> Thanks,
>
> Hadley
>
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Wed May  5 18:50:40 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 5 May 2010 11:50:40 -0500
Subject: [Rd] Simple performance enhancement for ave
Message-ID: <t2pf8e6ff051005050950ra67a0fa8k711199f28c02526e@mail.gmail.com>

n<-100000
grp1<-sample(1:750, n, replace=T)
grp2<-sample(1:750, n, replace=T)
d<-data.frame(x=rnorm(n), y=rnorm(n), grp1=grp1, grp2=grp2)

system.time(ave(d$x, d$grp1, d$grp2, FUN = mean))
#   user  system elapsed
# 19.840   0.125  19.967
system.time(ave(d$x, d$grp1, d$grp2, drop = TRUE, FUN = mean))
#  user  system elapsed
# 2.898   0.058   2.956

This is a pathological example (100,000 observations with around
90,000 groups out of ~500,000 possible), but I don't see any reason
why drop = TRUE shouldn't be the default inside ave.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From ggrothendieck at gmail.com  Wed May  5 19:53:58 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 5 May 2010 13:53:58 -0400
Subject: [Rd] R-Forge Problems
Message-ID: <l2v971536df1005051053z647b9f76u5a609a00364a6e13@mail.gmail.com>

If I go to:

http://r-forge.r-project.org/scm/?group_id=18

and click on [Browse Subversion Repository] in the box to the right it
takes me to a page that says this:

Traceback (most recent call last): File
"/usr/lib/gforge/bin//viewcvs.cgi", line 27, in import sapi
ImportError: No module named sapi

whereas I was expecting to get to the svn repository.


From jari.oksanen at oulu.fi  Wed May  5 20:21:00 2010
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Wed, 05 May 2010 21:21:00 +0300
Subject: [Rd] R-Forge Problems
In-Reply-To: <l2v971536df1005051053z647b9f76u5a609a00364a6e13@mail.gmail.com>
Message-ID: <C80791BC.E307%jari.oksanen@oulu.fi>

On 5/05/10 20:53 PM, "Gabor Grothendieck" <ggrothendieck at gmail.com> wrote:

> If I go to:
> 
> http://r-forge.r-project.org/scm/?group_id=18
> 
> and click on [Browse Subversion Repository] in the box to the right it
> takes me to a page that says this:
> 
> Traceback (most recent call last): File
> "/usr/lib/gforge/bin//viewcvs.cgi", line 27, in import sapi
> ImportError: No module named sapi
> 
> whereas I was expecting to get to the svn repository.

Gabor,

This was already queried in R-Forge site-help (May 2) and reported as bug in
R-Forge (May 3, bug #925). There has been no response to either of these
report. A News message of April 29 in R-Forge front page predicts that
browser functionality will follow "soon". So there is hope...

Cheers, Jari Oksanen


From chiefmurphy at gmail.com  Thu May  6 07:08:06 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Wed, 5 May 2010 22:08:06 -0700
Subject: [Rd] Validity glitch when contains="matrix"
Message-ID: <m2z48f8cced1005052208v7a2b57f3se54a6952fd1047ba@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100505/615a6e10/attachment.pl>

From romain at r-enthusiasts.com  Thu May  6 09:26:27 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Thu, 06 May 2010 09:26:27 +0200
Subject: [Rd] print.data.frame curiosity
Message-ID: <4BE26F23.6060401@r-enthusiasts.com>


Hello,

I made a mistake and passed stringsAsFactors to the wrong function in :

 > df <- as.data.frame( list( x = 1:3, y = c("a", "b", "c" ), 
stringsAsFactors = FALSE ) )

But then :

 > df
   x y
1 1 a
2 2 b
3 3 c

and :

 > df[["y"]]
[1] a b c
Levels: a b c
 > str( df )
'data.frame':	3 obs. of  3 variables:
  $ x               : int  1 2 3
  $ y               : Factor w/ 3 levels "a","b","c": 1 2 3
  $ stringsAsFactors: logi  FALSE FALSE FALSE


Somehow, print.data.frame does not want to print a column named 
"stringsAsFactors". (I know this is a bad name for a column, but ...)

Apparently, this line in format.data.frame is responsible for the mismatch:

x <- do.call("data.frame", rval)

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9aKDM9 : embed images in Rd documents
|- http://tr.im/OIXN : raster images and RImageJ
|- http://tr.im/OcQe : Rcpp 0.7.7


From maechler at stat.math.ethz.ch  Thu May  6 13:09:08 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 6 May 2010 13:09:08 +0200
Subject: [Rd] Validity glitch when contains="matrix"
In-Reply-To: <m2z48f8cced1005052208v7a2b57f3se54a6952fd1047ba@mail.gmail.com>
References: <m2z48f8cced1005052208v7a2b57f3se54a6952fd1047ba@mail.gmail.com>
Message-ID: <19426.41812.311331.576832@lynne.math.ethz.ch>

>>>>> Daniel Murphy <chiefmurphy at gmail.com>
>>>>>     on Wed, 5 May 2010 22:08:06 -0700 writes:

    > Sirs:
    > My validity function did not run when my class contains="matrix". But if I
    > first define the class with contains="numeric", then define it again
    > with contains="matrix", validity runs. Here's the session:

    >> f <- function(object) "BAD CLASS" # force error to
    >> setClass("A", contains="matrix", validity=f)
    > [1] "A"
    >> new("A",as.matrix(1)) # should generate a validity error, does not
    > An object of class ?A?
    > [,1]
    > [1,]    1
    >> setClass("B", contains="numeric", validity=f)
    > [1] "B"
    >> new("B",1) # generates the error
    > Error in validObject(.Object) : invalid class "B" object: BAD CLASS
    >> setClass("B", contains="matrix", validity=f)
    > [1] "B"
    >> new("B",as.matrix(1)) # generates the error
    > Error in validObject(.Object) : invalid class "B" object: BAD CLASS

The above behavior is clearly a bug.
The correct behavior *should* indeed show a validity error even
for class "A" above.
You are welcome to submit a formal bug report ..

    > On the other hand, when I define the class with "matrix" in its
    > representation, validity is called, no work-around necessary:

Yes, but that's really something different,
and I can imagine situations, where the  "contains" is very
preferable, as you get all the methods for "matrix" for free.


    >> setClass("C", representation(a="matrix"), validity=f)
    > [1] "C"
    >> new("C",a=as.matrix(1)) # error, as desired
    > Error in validObject(.Object) : invalid class "C" object: BAD CLASS

    > Should I
    > 1) always put "matrix" into the setClass representation argument instead of
    > the contains argument, or
    > 2) use contains="numeric", put the matrix's dims and dimnames attributes
    > into slots, and rely on a constructor to populate the instance?

Well, one can go the very long and "stable" way as we did in the 
Matrix package...

I'm not sure I would recommend that for you in your situation.
...
not the least because you *could* use the Matrix package if you
want to use such formal matrices with its thousands of methods.

Martin Maechler,
ETH Zurich

    > Option 2 seems most "stable".

    > Thanks,
    > Dan Murphy

    > Windows Vista, R version 2.11.0 (2010-04-22)

    > [[alternative HTML version deleted]]

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From jmc at r-project.org  Thu May  6 18:34:48 2010
From: jmc at r-project.org (John Chambers)
Date: Thu, 06 May 2010 09:34:48 -0700
Subject: [Rd] Validity glitch when contains="matrix"
In-Reply-To: <19426.41812.311331.576832@lynne.math.ethz.ch>
References: <m2z48f8cced1005052208v7a2b57f3se54a6952fd1047ba@mail.gmail.com>
	<19426.41812.311331.576832@lynne.math.ethz.ch>
Message-ID: <4BE2EFA8.9010301@r-project.org>

Re: the validity bug.  It's just as your example suggests:  the 
inherited initialize() method for "matrix" fails to call validObject(). 
  Should be easy to fix.  (Although it points out that the code should 
perhaps be reorganized so the initialize() method is not responsible for 
checking validity.)


Re: your other question:

On 5/6/10 4:09 AM, Martin Maechler wrote:
>>>>>> Daniel Murphy<chiefmurphy at gmail.com>
>>>>>>      on Wed, 5 May 2010 22:08:06 -0700 writes:
<snip>
>      >  Should I
>      >  1) always put "matrix" into the setClass representation argument instead of
>      >  the contains argument, or
>      >  2) use contains="numeric", put the matrix's dims and dimnames attributes
>      >  into slots, and rely on a constructor to populate the instance?
>

Either is possible, but if you really want your new objects to inherit 
the properties of a matrix, your initial idea of contains="matrix" is 
the natural choice for 2) (once the bug is fixed, but even before for 
most purposes). The choice is to inherit from matrix or have matrix as a 
slot (what Smalltalk called "is a" versus "has a").

The choice is as always whether you want to inherit all the methods and 
then override the ones that DON'T make sense, or put the matrix in a 
slot and write all the methods that DO make sense.

Neither choice fits all examples but "matrix" is special, because R 
treats them in a special (perhaps "weird" would apply) way:  they are 
not a class (not even an S3 class) but much code recognizes them 
internally, meaning you inherit a great deal of stuff.

If your new class of objects are supposed to act like matrices most of 
the time, the contains= version may require a lot less programming. On 
the other hand, if you planned to store the data in a non-standard way 
(as the Matrix package does) then you really don't want to inherit the 
standard methods because any you failed to override could be disastrous.


> Well, one can go the very long and "stable" way as we did in the
> Matrix package...
>
> I'm not sure I would recommend that for you in your situation.
> ...
> not the least because you *could* use the Matrix package if you
> want to use such formal matrices with its thousands of methods.
>
> Martin Maechler,
> ETH Zurich
>
>      >  Option 2 seems most "stable".
>
>      >  Thanks,
>      >  Dan Murphy
>
>      >  Windows Vista, R version 2.11.0 (2010-04-22)
>
>      >  [[alternative HTML version deleted]]
>
>      >  ______________________________________________
>      >  R-devel at r-project.org mailing list
>      >  https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From chiefmurphy at gmail.com  Thu May  6 18:49:53 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Thu, 6 May 2010 09:49:53 -0700
Subject: [Rd] Validity glitch when contains="matrix"
In-Reply-To: <4BE2EFA8.9010301@r-project.org>
References: <m2z48f8cced1005052208v7a2b57f3se54a6952fd1047ba@mail.gmail.com>
	<19426.41812.311331.576832@lynne.math.ethz.ch>
	<4BE2EFA8.9010301@r-project.org>
Message-ID: <i2t48f8cced1005060949yd6bd2e03mc7cd5c3f4e589901@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100506/7f6dff3c/attachment.pl>

From suharto_anggono at yahoo.com  Fri May  7 11:47:30 2010
From: suharto_anggono at yahoo.com (Suharto Anggono Suharto Anggono)
Date: Fri, 7 May 2010 02:47:30 -0700 (PDT)
Subject: [Rd] A fix that for 'bquote' that may work  (PR#14031)
Message-ID: <628656.88436.qm@web63406.mail.re1.yahoo.com>

--- On Fri, 6/11/09, tlumley at u.washington.edu <tlumley at u.washington.edu> wrote:

> From: tlumley at u.washington.edu <tlumley at u.washington.edu>
> Subject: Re: [Rd] A fix that for 'bquote' that may work? (PR#14031)
> To: suharto_anggono at yahoo.com
> Cc: r-devel at stat.math.ethz.ch, R-bugs at r-project.org
> Date: Friday, 6 November, 2009, 11:42 PM
> On Thu, 5 Nov 2009, suharto_anggono at yahoo.com
> wrote:
> 
> > This is a fix for 'bquote' that may work.
> > 
> > function (expr, where =3D parent.frame())=20
> > {
> >? ? unquote <- function(e) {
> >? ? ? ? if (length(e) <=3D 1 ||
> !is.language(e))=20
> >? ? ? ? ? ? e
> >? ? ? ? else if (e[[1]] =3D=3D
> as.name("."))=20
> >? ? ? ? ? ? eval(e[[2]],
> where)
> >? ? ? ? else as.call(lapply(e,
> unquote))
> >? ? }
> >? ? unquote(substitute(expr))
> > }
> 
> If you want to use bquote() on function definitions a
> better fix is
> 
> bquote <- function (expr, where = parent.frame())
> {
> ? ? unquote <- function(e) {
> ? ? ? ? if (length(e) <= 1)
> ? ? ? ? ? ? e
> ? ? ? ? else if (e[[1]] ==
> as.name("."))
> ? ? ? ? ? ? eval(e[[2]],
> where)
> ? ? ? ? else if (is.pairlist(e)){
> ? ? ? ? ? ?
> as.pairlist(lapply(e,unquote))
> ? ? ? ? }
> ? ? ? ? else as.call(lapply(e,
> unquote))
> ? ? }
> ? ? unquote(substitute(expr))
> }
> 
> since that now allows substitution into default arguments,
> eg
> ? default<-1
> ? g<-b2quote(function(x,y=.(default)) x+y )
> 
> 
> 
> ? ? ? ? -thomas
> 
> Thomas Lumley??? ???
> ??? Assoc. Professor, Biostatistics
> tlumley at u.washington.edu???
> University of Washington, Seattle
> 
> 

Thank you.

I have tried R 2.11.0. I see that the above is the definition of 'bquote' in R 2.11.0.

With the definition, 'bquote' does not substitute into default argument for function with one argument.


> default <- 1
> bquote( function(y = .(default)) y )
function(y = .(default)) y
> sessionInfo()
R version 2.11.0 (2010-04-22)
i386-pc-mingw32

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats? ???graphics? grDevices utils? ???datasets? methods???base


To make it also work for function with one argument, in the function 'unquote' in 'bquote', apparently is.pairlist(e) should be the first to be checked, before checking (length(e) <= 1), for example with this definition for 'bquote'.

function (expr, where = parent.frame())
{
    unquote <- function(e) if (is.pairlist(e))
        as.pairlist(lapply(e, unquote))
    else if (length(e) <= 1L)
        e
    else if (e[[1L]] == as.name("."))
        eval(e[[2L]], where)
    else as.call(lapply(e, unquote))
    unquote(substitute(expr))
}


There is a cosmetic problem if 'bquote' is applied to function definition with more than one line.

> fq <- bquote(
+ function() {
+ }
+ )
> f <- eval(fq)
> str(f)
function ()
 - attr(*, "source")= language? ...

The "source" attribute of the 'eval'-ed function is a language object. Normally, "source" attribute of a function is character.

One way to avoid that is by not changing non-call object (except pairlist) in 'unquote', for example by using this definition for 'bquote'.

function (expr, where = parent.frame())
{
? ? unquote <- function(e) if (is.pairlist(e))
? ? ? ? as.pairlist(lapply(e, unquote))
? ? else if (!is.call(e))
? ? ? ? e
? ? else if (e[[1L]] == as.name(".") && length(e) > 1L)
? ? ? ? eval(e[[2L]], where)
? ? else as.call(lapply(e, unquote))
? ? unquote(substitute(expr))
}

The logic of 'unquote' above can be written like this.
- Check if 'e' is a call object.
- If 'e' is not a call object, leave it as is, except if it is a pairlist.
- If 'e' is a call object, check if it is a call to '.' with argument.
If yes, 'eval' its (first) argument. If not, 'unquote' its parts.

I assume that length of a call object is at least 1.
In my last definition above for 'unquote' in 'bquote', call object of length 1 is not special-cased. That will allow 'bquote' to substitute to function name for a call to function without argument. Currently, substitution to function name only works for a call to function with argument.

> bquote
function (expr, where = parent.frame())
{
    unquote <- function(e) if (length(e) <= 1L)
        e
    else if (e[[1L]] == as.name("."))
        eval(e[[2L]], where)
    else if (is.pairlist(e))
        as.pairlist(lapply(e, unquote))
    else as.call(lapply(e, unquote))
    unquote(substitute(expr))
}
<environment: namespace:base>
> fnam <- as.name("f")
> bquote( .(fnam)() )
.(fnam)()
> bquote( .(fnam)(x) )
f(x)





From osklyar at ahl.com  Fri May  7 16:23:24 2010
From: osklyar at ahl.com (Sklyar, Oleg (London))
Date: Fri, 7 May 2010 15:23:24 +0100
Subject: [Rd] Bug in R -e "command"
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430662B0DE@mildnpexmb01.maninvestments.ad.man.com>

Hi all:

since about a month we encountered a problem with R -e command: spaces
in the "command" of R -e "command" are no more tolerated. This same
issue affects 2.11 patched (05-05-2010), 2.10.1, and current devel (at
least the one of two weeks ago).

(I skip the mid of the printouts, replaced with ...)

* R -e "message('aaa aaa')"
ARGUMENT 'aaa')' __ignored__


R version 2.11.0 Patched (2010-05-05 r51914)
Copyright (C) 2010 The R Foundation for Statistical Computing
...

> message('aaa
+ 
+ 

* /releases/R/2.10/bin/R -e "message('aaa aaa')"
ARGUMENT 'aaa')' __ignored__


R version 2.10.1 Patched (2010-03-27 r51474)
Copyright (C) 2010 The R Foundation for Statistical Computing
...

> message('aaa
+ 
+ 

WORKING OLD VERSION:

* /share/R/20090611/bin/R -e "message('aaa aaa')"

R version 2.9.0 (2009-04-17)
Copyright (C) 2009 The R Foundation for Statistical Computing
...

> message('aaa aaa')
aaa aaa
> 
> 


Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.comno more 

**********************************************************************
 Please consider the environment before printing this email or its attachments.
The contents of this email are for the named addressees ...{{dropped:19}}


From edd at debian.org  Fri May  7 16:42:36 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 7 May 2010 09:42:36 -0500
Subject: [Rd] Bug in R -e "command"
In-Reply-To: <1A68FCB28DE72F4BA3B967E6506CCE430662B0DE@mildnpexmb01.maninvestments.ad.man.com>
References: <1A68FCB28DE72F4BA3B967E6506CCE430662B0DE@mildnpexmb01.maninvestments.ad.man.com>
Message-ID: <19428.9948.270711.174164@ron.nulle.part>


On 7 May 2010 at 15:23, Sklyar, Oleg (London) wrote:
| Hi all:
| 
| since about a month we encountered a problem with R -e command: spaces
| in the "command" of R -e "command" are no more tolerated. This same
| issue affects 2.11 patched (05-05-2010), 2.10.1, and current devel (at
| least the one of two weeks ago).
| 
| (I skip the mid of the printouts, replaced with ...)
| 
| * R -e "message('aaa aaa')"
| ARGUMENT 'aaa')' __ignored__

Isn't that a shell quoting issue?  I tend to keep the apostrophe on the
outside and the double-quote on the inside:

edd at ron:~> R --slave -e 'message("aaa aaa")'
aaa aaa
edd at ron:~> r -e 'message("aaa aaa")'
aaa aaa
edd at ron:~> Rscript -e 'message("aaa aaa")'
aaa aaa

but also note

edd at ron:~> R --slave -e "message(\"aaa aaa\")"
aaa aaa
edd at ron:~> R --slave -e "message('aaa aaa')"
aaa aaa
edd at ron:~> 

so I can't even replicate your issue.  What what it's worth, the cut&paste
above came from M-x shell inside Emacs.

edd at ron:~> dpkg -l r-base-core littler bash emacs23 | tail -4
ii  bash           4.1-3          The GNU Bourne Again SHell
ii  emacs23        23.1+1-5       The GNU Emacs editor (with GTK+ user interfa
ii  littler        0.1.3-1        GNU R scripting and command-line front-end
ii  r-base-core    2.11.0-1       GNU R core of statistical computation and gr
edd at ron:~> 

| 
| 
| R version 2.11.0 Patched (2010-05-05 r51914)
| Copyright (C) 2010 The R Foundation for Statistical Computing
| ...
| 
| > message('aaa
| + 
| + 
| 
| * /releases/R/2.10/bin/R -e "message('aaa aaa')"
| ARGUMENT 'aaa')' __ignored__
| 
| 
| R version 2.10.1 Patched (2010-03-27 r51474)
| Copyright (C) 2010 The R Foundation for Statistical Computing
| ...
| 
| > message('aaa
| + 
| + 
| 
| WORKING OLD VERSION:
| 
| * /share/R/20090611/bin/R -e "message('aaa aaa')"
| 
| R version 2.9.0 (2009-04-17)
| Copyright (C) 2009 The R Foundation for Statistical Computing
| ...
| 
| > message('aaa aaa')
| aaa aaa
| > 
| > 
| 
| 
| Dr Oleg Sklyar
| Research Technologist
| AHL / Man Investments Ltd
| +44 (0)20 7144 3803
| osklyar at maninvestments.comno more 
| 
| **********************************************************************
|  Please consider the environment before printing this email or its attachments.
| The contents of this email are for the named addressees ...{{dropped:19}}
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
  Regards, Dirk


From olafm at kimberly.tako.de  Fri May  7 17:27:39 2010
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Fri, 7 May 2010 17:27:39 +0200
Subject: [Rd] Bug in memDecompress()
Message-ID: <85379D4F-4C95-49F6-A694-A995B0DAE137@kimberly.tako.de>

Dear R developers,

I have discovered a bug in the implementation of lzma decompression in memDecompress(). It is only triggered if the uncompressed size of the content is more than 3 times as large as the compressed content. Here's a simple example to reproduce it:

  n <- 200
  
  char <- paste(replicate(n, "1234567890"), collapse="")
  char.comp <- memCompress(char, type="xz")
  char.dec <- memDecompress(char.comp, type="xz", asChar=TRUE)
  nchar(char.dec) == nchar(char)

  raw <- serialize(char, connection=NULL)
  raw.comp <- memCompress(raw, type="xz")
  raw.dec <- memDecompress(raw.comp, type="xz")
  length(raw.dec) == length(raw)

  char.uns <- unserialize(raw.dec)

The root cause seems to be, that lzma_code() will return LZMA_OK even if it could not decompress the whole content. In this case strm.avail_in will be greater than zero. The following patch changes the respective if statements:

  http://www.statistik.tu-dortmund.de/~olafm/temp/memdecompress.patch

It also contains a small fix from the xz upstream for an uninitialized field in lzma_stream.

Cheers,
Olaf


From djsamperi at gmail.com  Fri May  7 21:59:46 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 7 May 2010 15:59:46 -0400
Subject: [Rd] timeSeries and optional S4 slots?
Message-ID: <j2pd4cf43b61005071259tb51c8fd8wc98423d148542092@mail.gmail.com>

Question on timeSeries and S4 classes:

Consider the following:
library(timeSeries)
data <- rnorm(5)
treg <- ts(data, frequency=4)

t1 <- timeSeries(data, as.Date('2010-04-15') + 1:5)
t2 <- as.timeSeries(treg)

Now both t1 and t2 are timeSeries objects, yet
t2 at ts is a valid slot, while t1 at ts is not.

Thus the ts slot is optional.

Sorry if I am misunderstanding the way S4 classes
work, but shouldn't a class have a well-defined set of
slots?

It appears that the "constructor" as.timeSeries() used
to create t2 results in a different kind of object from
the one used to define t1, yet the class() operator
returns the same class name ('timeSeries') in both
cases.

Thanks,
Dominick


From maiagx at gmail.com  Sun May  9 01:35:35 2010
From: maiagx at gmail.com (Charlotte Maia)
Date: Sun, 9 May 2010 11:35:35 +1200
Subject: [Rd] Sweave Feature Requests and Questions
Message-ID: <x2lb7bfe54e1005081635of51056f4v186ff8edb116cf6b@mail.gmail.com>

Hi everyone,

I would like to request the following features for Sweave:
1. The keep.source option, to respect empty lines in input.
2. The prefix.string option, to apply to all generated files, e.g. no
Rplots.pdf.
3. That Sweave, doesn't change the graphics settings for the entire
Latex Document. By default including a pdf image, should use it's
actual size, rather than making it a fixed proportion of the text
width.
4. A new option to allow generation of Serror chunks, where the R code
generates an error or a warning.

Furthermore, any help appreciated here:
1. Does anyone know how to build Sweave documents, using Make, without
starting a new instance (or multiple instances) of R, every time Make
is called?
2. Does anyone know a simple workaround to problem 3, without killing
the entire Sweave.sty file?

Furthermore, I'm temped to stop Sweave from generating all the eps
files (I saw an option for this in the Sweave documentation), however
I'm concerned it may stop others from building the document, if they
use postscript.

Then again, do enough people use postscript, to warrant such consideration?


kind regards
-- 
Charlotte Maia
http://sites.google.com/site/maiagx


From murdoch.duncan at gmail.com  Sun May  9 02:40:56 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 08 May 2010 20:40:56 -0400
Subject: [Rd] Sweave Feature Requests and Questions
In-Reply-To: <x2lb7bfe54e1005081635of51056f4v186ff8edb116cf6b@mail.gmail.com>
References: <x2lb7bfe54e1005081635of51056f4v186ff8edb116cf6b@mail.gmail.com>
Message-ID: <4BE60498.7050301@gmail.com>

Charlotte Maia wrote:
> Hi everyone,
>
> I would like to request the following features for Sweave:
> 1. The keep.source option, to respect empty lines in input.
>   

I think it's too late for that one.  keep.source was introduced in 2006, 
and there were a large number of unreasonable complaints about it -- so 
many that I'm not going near that again.

> 2. The prefix.string option, to apply to all generated files, e.g. no
> Rplots.pdf.
>   

Why do you want to keep Rplots.pdf?  I think a more reasonable request 
is not to produce it at all.

> 3. That Sweave, doesn't change the graphics settings for the entire
> Latex Document. By default including a pdf image, should use it's
> actual size, rather than making it a fixed proportion of the text
> width.
>   

I think this is an option.  Use something like

\usepackage[nogin]{Sweave}

to turn it off.

> 4. A new option to allow generation of Serror chunks, where the R code
> generates an error or a warning.
>   

That's a good idea that has been suggested before.  I think it's just a 
matter of someone doing it (or it may have been done in one of the 
Sweave add-on packages).
> Furthermore, any help appreciated here:
> 1. Does anyone know how to build Sweave documents, using Make, without
> starting a new instance (or multiple instances) of R, every time Make
> is called?
>   

I think the generic answer here is that you shouldn't be using an OS 
where starting new instances is so time consuming.  Make is designed for 
OS's where it's rather cheap to start the same program many times.   So 
maybe you should suggest to Microsoft (I'm assuming you're on Windows) 
about that fact that it is so slow at this common task?

> 2. Does anyone know a simple workaround to problem 3, without killing
> the entire Sweave.sty file?
>   

Besides the one above, you can use \setkeys{Gin}  to change the default 
size of graphics.
> Furthermore, I'm temped to stop Sweave from generating all the eps
> files (I saw an option for this in the Sweave documentation), however
> I'm concerned it may stop others from building the document, if they
> use postscript.
>
> Then again, do enough people use postscript, to warrant such consideration?
>   

I think this depends on your audience, but probably most users of a 
document written using Sweave are just going to read the PDF that you 
produced, they aren't going to process it themselves.  On the other 
hand, those eps files are handy because they allow you to work with .dvi 
files, and .dvi previewers are still smarter than .pdf previewers, for 
things like reverse search.  (Use patchDVI so reverse searches go to the 
.Rnw file, not the intermediate .tex file.)  So I leave Sweave producing 
both pdf and eps.  Disk space is cheap.

Duncan Murdoch


From A.R.Runnalls at kent.ac.uk  Sun May  9 12:37:27 2010
From: A.R.Runnalls at kent.ac.uk (Andrew Runnalls)
Date: Sun, 09 May 2010 11:37:27 +0100
Subject: [Rd] Memory allocation in C/C++ vs R?
In-Reply-To: <u2vd4cf43b61004301040jc5a99578k9b44b41e7b414b0a@mail.gmail.com>
References: <m2qd4cf43b61004292203x8265d834wb1d42c483813d55d@mail.gmail.com>	<491D8740-466D-4442-B6BE-942A9C423CD0@r-project.org>
	<u2vd4cf43b61004301040jc5a99578k9b44b41e7b414b0a@mail.gmail.com>
Message-ID: <4BE69067.10205@kent.ac.uk>

Dominick,

On 30/04/10 18:40, Dominick Samperi wrote:
> Just to be sure that I understand, are you suggesting that the R-safe way to do
> things is to not use STL, and to not use C++ memory management and
> exception handling? How can you leave a function in an irregular way without
> triggering a seg fault or something like that, in which case there is no chance
> for recovery anyway?

If you had time to try out your work with CXXR, I would be very
interested to hear your experiences.  Picking up on some of the points
already raised in this thread:

1. CXXR's main program is written in C++, so it should deal with C++
initialisation and teardown correctly.  (However, it has been so far
tested only with gcc and the Intel C++ compiler, so there are doubtless
plenty of submerged rocks still to discover.)

2. Within CXXR, all indirect flows of control are handled using C++
exceptions, and it is certainly the intention that user-supplied code
should also be free to use C++ exceptions (subject to the caution that
is always necessary in using C++ exceptions).

3. As regards memory allocation, in addition to the mechanisms available
in standard R, you can of course use standard C++ 'new' and 'delete'.
Also, objects of any C++ class that inherits directly or indirectly from
CXXR::GCNode will be looked after by CXXR's own internal garbage collection.

4. Regarding protection from garbage collection, the mechanisms of
standard R are available.  But for C++ code, the preferred approach is
to use the CXXR::GCRoot<T> and CXXR::GCStackRoot<T> smart pointers.
Basically an object of one of these types behaves like a plain T*
pointer (where T inherits from CXXR::GCNode), but whatever it points to
is protected from garbage collection - for as long as the pointer exists
and points to that object.

Let me know (offline from this list) if I can be of any help.

Andrew Runnalls


From kostas at amalou.net  Mon May 10 01:25:05 2010
From: kostas at amalou.net (Kostas Maistrelis)
Date: Mon, 10 May 2010 02:25:05 +0300
Subject: [Rd] ubuntu lucid repository
Message-ID: <20100510022505.46c4cf64@kostas-desktop>

i try to install R 2.11 to ubuntu lucid from 
http://cran.r-project.org/bin/linux/ubuntu/lucid/

but is not working 
i make a local mirror of the repo  and i made some 
directory structure changes  and  worked
(main/binary-i386/   dists)

i made a bug-report at
https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=14289
(but is not the right place, then i send this email.)

thanks.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100510/ff224d50/attachment.bin>

From maiagx at gmail.com  Mon May 10 04:31:07 2010
From: maiagx at gmail.com (Charlotte Maia)
Date: Mon, 10 May 2010 14:31:07 +1200
Subject: [Rd] Sweave Feature Requests and Questions
In-Reply-To: <4BE60498.7050301@gmail.com>
References: <x2lb7bfe54e1005081635of51056f4v186ff8edb116cf6b@mail.gmail.com>
	<4BE60498.7050301@gmail.com>
Message-ID: <v2yb7bfe54e1005091931mbb875353raaf3b9ae0a69cbcb@mail.gmail.com>

Hi Duncan, thank you for the comprehensive reply.

Firstly, though, I'm using Fedora 10.
Running Latex through Make is really fast, Sweave isn't.

I'll try [nogin] later, assuming it works, it will make my life a lot
easier, so a big thank you on that one.

On the Rplots issue, I don't want them, however Sweave produces them.
I find the task of deleting intermediate files (say for R package
vignettes) more difficult than it needs to be.


kind regards
Charlotte

On Sun, May 9, 2010 at 12:40 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> Charlotte Maia wrote:
>>
>> Hi everyone,
>>
>> I would like to request the following features for Sweave:
>> 1. The keep.source option, to respect empty lines in input.
>>
>
> I think it's too late for that one. ?keep.source was introduced in 2006, and
> there were a large number of unreasonable complaints about it -- so many
> that I'm not going near that again.
>
>> 2. The prefix.string option, to apply to all generated files, e.g. no
>> Rplots.pdf.
>>
>
> Why do you want to keep Rplots.pdf? ?I think a more reasonable request is
> not to produce it at all.
>
>> 3. That Sweave, doesn't change the graphics settings for the entire
>> Latex Document. By default including a pdf image, should use it's
>> actual size, rather than making it a fixed proportion of the text
>> width.
>>
>
> I think this is an option. ?Use something like
>
> \usepackage[nogin]{Sweave}
>
> to turn it off.
>
>> 4. A new option to allow generation of Serror chunks, where the R code
>> generates an error or a warning.
>>
>
> That's a good idea that has been suggested before. ?I think it's just a
> matter of someone doing it (or it may have been done in one of the Sweave
> add-on packages).
>>
>> Furthermore, any help appreciated here:
>> 1. Does anyone know how to build Sweave documents, using Make, without
>> starting a new instance (or multiple instances) of R, every time Make
>> is called?
>>
>
> I think the generic answer here is that you shouldn't be using an OS where
> starting new instances is so time consuming. ?Make is designed for OS's
> where it's rather cheap to start the same program many times. ? So maybe you
> should suggest to Microsoft (I'm assuming you're on Windows) about that fact
> that it is so slow at this common task?
>
>> 2. Does anyone know a simple workaround to problem 3, without killing
>> the entire Sweave.sty file?
>>
>
> Besides the one above, you can use \setkeys{Gin} ?to change the default size
> of graphics.
>>
>> Furthermore, I'm temped to stop Sweave from generating all the eps
>> files (I saw an option for this in the Sweave documentation), however
>> I'm concerned it may stop others from building the document, if they
>> use postscript.
>>
>> Then again, do enough people use postscript, to warrant such
>> consideration?
>>
>
> I think this depends on your audience, but probably most users of a document
> written using Sweave are just going to read the PDF that you produced, they
> aren't going to process it themselves. ?On the other hand, those eps files
> are handy because they allow you to work with .dvi files, and .dvi
> previewers are still smarter than .pdf previewers, for things like reverse
> search. ?(Use patchDVI so reverse searches go to the .Rnw file, not the
> intermediate .tex file.) ?So I leave Sweave producing both pdf and eps.
> ?Disk space is cheap.
>
> Duncan Murdoch
>


-- 
Charlotte Maia
http://sites.google.com/site/maiagx


From osklyar at ahl.com  Mon May 10 10:50:59 2010
From: osklyar at ahl.com (Sklyar, Oleg (London))
Date: Mon, 10 May 2010 09:50:59 +0100
Subject: [Rd] Bug in R -e "command"
In-Reply-To: <19428.9948.270711.174164@ron.nulle.part>
References: <1A68FCB28DE72F4BA3B967E6506CCE430662B0DE@mildnpexmb01.maninvestments.ad.man.com>
	<19428.9948.270711.174164@ron.nulle.part>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430662B0E1@mildnpexmb01.maninvestments.ad.man.com>

Hi Dirk, all:

your answer prompted me to look in another place, and yes I need to
withdraw the bug report: it was a problem on our side.

Thanks,
Oleg


Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.com 

> -----Original Message-----
> From: Dirk Eddelbuettel [mailto:edd at debian.org] 
> Sent: 07 May 2010 15:43
> To: Sklyar, Oleg (London)
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Bug in R -e "command"
> 
> 
> On 7 May 2010 at 15:23, Sklyar, Oleg (London) wrote:
> | Hi all:
> | 
> | since about a month we encountered a problem with R -e 
> command: spaces
> | in the "command" of R -e "command" are no more tolerated. This same
> | issue affects 2.11 patched (05-05-2010), 2.10.1, and 
> current devel (at
> | least the one of two weeks ago).
> | 
> | (I skip the mid of the printouts, replaced with ...)
> | 
> | * R -e "message('aaa aaa')"
> | ARGUMENT 'aaa')' __ignored__
> 
> Isn't that a shell quoting issue?  I tend to keep the 
> apostrophe on the
> outside and the double-quote on the inside:
> 
> edd at ron:~> R --slave -e 'message("aaa aaa")'
> aaa aaa
> edd at ron:~> r -e 'message("aaa aaa")'
> aaa aaa
> edd at ron:~> Rscript -e 'message("aaa aaa")'
> aaa aaa
> 
> but also note
> 
> edd at ron:~> R --slave -e "message(\"aaa aaa\")"
> aaa aaa
> edd at ron:~> R --slave -e "message('aaa aaa')"
> aaa aaa
> edd at ron:~> 
> 
> so I can't even replicate your issue.  What what it's worth, 
> the cut&paste
> above came from M-x shell inside Emacs.
> 
> edd at ron:~> dpkg -l r-base-core littler bash emacs23 | tail -4
> ii  bash           4.1-3          The GNU Bourne Again SHell
> ii  emacs23        23.1+1-5       The GNU Emacs editor (with 
> GTK+ user interfa
> ii  littler        0.1.3-1        GNU R scripting and 
> command-line front-end
> ii  r-base-core    2.11.0-1       GNU R core of statistical 
> computation and gr
> edd at ron:~> 
> 
> | 
> | 
> | R version 2.11.0 Patched (2010-05-05 r51914)
> | Copyright (C) 2010 The R Foundation for Statistical Computing
> | ...
> | 
> | > message('aaa
> | + 
> | + 
> | 
> | * /releases/R/2.10/bin/R -e "message('aaa aaa')"
> | ARGUMENT 'aaa')' __ignored__
> | 
> | 
> | R version 2.10.1 Patched (2010-03-27 r51474)
> | Copyright (C) 2010 The R Foundation for Statistical Computing
> | ...
> | 
> | > message('aaa
> | + 
> | + 
> | 
> | WORKING OLD VERSION:
> | 
> | * /share/R/20090611/bin/R -e "message('aaa aaa')"
> | 
> | R version 2.9.0 (2009-04-17)
> | Copyright (C) 2009 The R Foundation for Statistical Computing
> | ...
> | 
> | > message('aaa aaa')
> | aaa aaa
> | > 
> | > 
> | 
> | 
> | Dr Oleg Sklyar
> | Research Technologist
> | AHL / Man Investments Ltd
> | +44 (0)20 7144 3803
> | osklyar at maninvestments.comno more 
> | 
> | 
> **********************************************************************
> |  Please consider the environment before printing this email 
> or its attachments.
> | The contents of this email are for the named addressees 
> ...{{dropped:19}}
> | 
> | ______________________________________________
> | R-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
>   Regards, Dirk
> 

**********************************************************************
 Please consider the environment before printing this email or its attachments.
The contents of this email are for the named addressees ...{{dropped:19}}


From mike.prager at mhprager.com  Mon May 10 06:07:50 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Mon, 10 May 2010 00:07:50 -0400
Subject: [Rd] update.packages fails with directory not found
Message-ID: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>

Windows XP.  I have just updated to R 2.11.0 and then run
update.packages. In the series of updates, a few will succeed, then I
get a failure like


package 'mvtnorm' successfully unpacked and MD5 sums checked
package 'party' successfully unpacked and MD5 sums checked
package 'PBSmodelling' successfully unpacked and MD5 sums checked
Error in normalizePath(path) : 
  path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
find the file specified


Indeed, the path is missing, though it was there when I issued the
update.packages command.

???

--
Mike Prager, NC, USA


From jeffab at microsoft.com  Fri May  7 17:40:17 2010
From: jeffab at microsoft.com (Jeff Abrams)
Date: Fri, 7 May 2010 15:40:17 +0000
Subject: [Rd] Use of R in C#
Message-ID: <C3D16A4C8BD3F843860C73573C70DD952E255192@TK5EX14MBXC103.redmond.corp.microsoft.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100507/e2502060/attachment.pl>

From murdoch.duncan at gmail.com  Mon May 10 12:33:54 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 10 May 2010 06:33:54 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>
Message-ID: <4BE7E112.2030005@gmail.com>

Mike Prager wrote:
> Windows XP.  I have just updated to R 2.11.0 and then run
> update.packages. In the series of updates, a few will succeed, then I
> get a failure like
>
>
> package 'mvtnorm' successfully unpacked and MD5 sums checked
> package 'party' successfully unpacked and MD5 sums checked
> package 'PBSmodelling' successfully unpacked and MD5 sums checked
> Error in normalizePath(path) : 
>   path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
> find the file specified
>   

Is that a cut and paste of the error message?  Normally R would double 
the backslashes when displaying a string, so it looks as though you've 
somehow got a path containing the control characters \P, \R, and \L.  
Did you set the lib.loc argument when you called update.packages?

Duncan Murdoch
>
> Indeed, the path is missing, though it was there when I issued the
> update.packages command.
>
> ???
>
> --
> Mike Prager, NC, USA
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Mon May 10 13:02:00 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 10 May 2010 12:02:00 +0100 (BST)
Subject: [Rd] Use of R in C#
In-Reply-To: <C3D16A4C8BD3F843860C73573C70DD952E255192@TK5EX14MBXC103.redmond.corp.microsoft.com>
References: <C3D16A4C8BD3F843860C73573C70DD952E255192@TK5EX14MBXC103.redmond.corp.microsoft.com>
Message-ID: <alpine.LFD.2.00.1005101201010.5880@gannet.stats.ox.ac.uk>

This is not about R, but about the StatConnector project which has its 
own mailing lists.

On Fri, 7 May 2010, Jeff Abrams wrote:

> I have a C# program that requires the run of a logistic regression.  I have downloaded the R 2.11 package, and have added the following references to my code:
>
> STATCONNECTORCLNTLib;
> StatConnectorCommonLib;
> STATCONNECTORSRVLib;
>
> In my code I have:
> StatConnector scs = new STATCONNECTORSRVLib.StatConnectorClass();
> scs.Init("R");
>
> The init step returns the below error which seems to indicate a connection failure.
>
> System.Runtime.InteropServices.COMException was unhandled
>  Message="Exception from HRESULT: 0x80040013"
>  Source="Interop.STATCONNECTORSRVLib"
>  ErrorCode=-2147221485
>
> Any ideas?
>
>
> Jeff Abrams
> Research Engineer
> Auction Analytics, Microsoft
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mike.prager at mhprager.com  Mon May 10 14:28:17 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Mon, 10 May 2010 08:28:17 -0400
Subject: [Rd] update.packages fails with directory not found
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>
	<4BE7E112.2030005@gmail.com>
Message-ID: <8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>

On Mon, 10 May 2010 06:33:54 -0400, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:

>Mike Prager wrote:
>> Windows XP.  I have just updated to R 2.11.0 and then run
>> update.packages. In the series of updates, a few will succeed, then I
>> get a failure like
>>
>>
>> package 'mvtnorm' successfully unpacked and MD5 sums checked
>> package 'party' successfully unpacked and MD5 sums checked
>> package 'PBSmodelling' successfully unpacked and MD5 sums checked
>> Error in normalizePath(path) : 
>>   path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
>> find the file specified
>>   
>
>Is that a cut and paste of the error message?  Normally R would double 
>the backslashes when displaying a string, so it looks as though you've 
>somehow got a path containing the control characters \P, \R, and \L.  
>Did you set the lib.loc argument when you called update.packages?

Thank you!  Yes, it's cut and paste.  I did not set lib.loc in the
call (made through the Rgui.exe menu system), but I have the library
location defined in the environment:

R_LIBS=c:/Program Files/R/Library

I've been using this approach for several years, and it's worked
without problem until now.

MHP

>>
>> Indeed, the path is missing, though it was there when I issued the
>> update.packages command.
>>


From murdoch.duncan at gmail.com  Mon May 10 15:33:27 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 10 May 2010 09:33:27 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>	<4BE7E112.2030005@gmail.com>
	<8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
Message-ID: <4BE80B27.60507@gmail.com>

On 10/05/2010 8:28 AM, Mike Prager wrote:
> On Mon, 10 May 2010 06:33:54 -0400, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>
> >Mike Prager wrote:
> >> Windows XP.  I have just updated to R 2.11.0 and then run
> >> update.packages. In the series of updates, a few will succeed, then I
> >> get a failure like
> >>
> >>
> >> package 'mvtnorm' successfully unpacked and MD5 sums checked
> >> package 'party' successfully unpacked and MD5 sums checked
> >> package 'PBSmodelling' successfully unpacked and MD5 sums checked
> >> Error in normalizePath(path) : 
> >>   path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
> >> find the file specified
> >>   
> >
> >Is that a cut and paste of the error message?  Normally R would double 
> >the backslashes when displaying a string, so it looks as though you've 
> >somehow got a path containing the control characters \P, \R, and \L.  
> >Did you set the lib.loc argument when you called update.packages?
>
> Thank you!  Yes, it's cut and paste.  I did not set lib.loc in the
> call (made through the Rgui.exe menu system), but I have the library
> location defined in the environment:
>
> R_LIBS=c:/Program Files/R/Library
>
> I've been using this approach for several years, and it's worked
> without problem until now.
>   
I can't seem to reproduce this.  If it happens reproducibly on your 
system, could you please do the following:
print the result of installed.packages()["PBSmodelling",], .libPaths() 
and sessionInfo()?

A possible workaround is to get the names of all of your packages in the 
Library folder and install them, rather than using the update.packages() 
function.  This may fail if some of them aren't on CRAN or the other 
repositories.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Mon May 10 16:42:27 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 10 May 2010 15:42:27 +0100 (BST)
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <4BE80B27.60507@gmail.com>
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>
	<4BE7E112.2030005@gmail.com>
	<8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
	<4BE80B27.60507@gmail.com>
Message-ID: <alpine.LFD.2.00.1005101537180.15991@gannet.stats.ox.ac.uk>

On Mon, 10 May 2010, Duncan Murdoch wrote:

> On 10/05/2010 8:28 AM, Mike Prager wrote:
>> On Mon, 10 May 2010 06:33:54 -0400, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>> 
>> >Mike Prager wrote:
>> >> Windows XP.  I have just updated to R 2.11.0 and then run
>> >> update.packages. In the series of updates, a few will succeed, then I
>> >> get a failure like
>> >>
>> >>
>> >> package 'mvtnorm' successfully unpacked and MD5 sums checked
>> >> package 'party' successfully unpacked and MD5 sums checked
>> >> package 'PBSmodelling' successfully unpacked and MD5 sums checked
>> >> Error in normalizePath(path) : >>   path[1]="c:\Program 
>> Files\R\Library/PBSmodelling": The system cannot
>> >> find the file specified
>> >>   >
>> >Is that a cut and paste of the error message?  Normally R would double 
>> >the backslashes when displaying a string, so it looks as though you've 
>> >somehow got a path containing the control characters \P, \R, and \L.  >Did 
>> you set the lib.loc argument when you called update.packages?
>> 
>> Thank you!  Yes, it's cut and paste.

The message coming from C (do_normalizepath) not R.

> I did not set lib.loc in the
>> call (made through the Rgui.exe menu system), but I have the library
>> location defined in the environment:
>> 
>> R_LIBS=c:/Program Files/R/Library
>> 
>> I've been using this approach for several years, and it's worked
>> without problem until now.
>> 
> I can't seem to reproduce this.  If it happens reproducibly on your system, 
> could you please do the following:
> print the result of installed.packages()["PBSmodelling",], .libPaths() and 
> sessionInfo()?
>
> A possible workaround is to get the names of all of your packages in the 
> Library folder and install them, rather than using the update.packages() 
> function.  This may fail if some of them aren't on CRAN or the other 
> repositories.

I think he has a permissions issue on that directory. I'd remove it 
manually after a reboot, then re-install.  (Reboot because it may be 
open in some crashed process.)

I've seen this in Vista/7 several times, but of course permissions are 
more of a hindrance there.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From wdunlap at tibco.com  Mon May 10 16:42:50 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 10 May 2010 07:42:50 -0700
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com><4BE7E112.2030005@gmail.com>
	<8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70002E66CC3@NA-PA-VBE03.na.tibco.com>

Someone once suggested this error happened was
due to the Windows 'Indexing Service' (sp?) delaying
the commital of a request to rename a directory
(so a subsequent request to use the renamed directory
failed).

Was the indexing service running when this happened?

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Mike Prager
> Sent: Monday, May 10, 2010 5:28 AM
> To: r-devel at stat.math.ethz.ch
> Subject: Re: [Rd] update.packages fails with directory not found
> 
> On Mon, 10 May 2010 06:33:54 -0400, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
> 
> >Mike Prager wrote:
> >> Windows XP.  I have just updated to R 2.11.0 and then run
> >> update.packages. In the series of updates, a few will 
> succeed, then I
> >> get a failure like
> >>
> >>
> >> package 'mvtnorm' successfully unpacked and MD5 sums checked
> >> package 'party' successfully unpacked and MD5 sums checked
> >> package 'PBSmodelling' successfully unpacked and MD5 sums checked
> >> Error in normalizePath(path) : 
> >>   path[1]="c:\Program Files\R\Library/PBSmodelling": The 
> system cannot
> >> find the file specified
> >>   
> >
> >Is that a cut and paste of the error message?  Normally R 
> would double 
> >the backslashes when displaying a string, so it looks as 
> though you've 
> >somehow got a path containing the control characters \P, \R, 
> and \L.  
> >Did you set the lib.loc argument when you called update.packages?
> 
> Thank you!  Yes, it's cut and paste.  I did not set lib.loc in the
> call (made through the Rgui.exe menu system), but I have the library
> location defined in the environment:
> 
> R_LIBS=c:/Program Files/R/Library
> 
> I've been using this approach for several years, and it's worked
> without problem until now.
> 
> MHP
> 
> >>
> >> Indeed, the path is missing, though it was there when I issued the
> >> update.packages command.
> >>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From mike.prager at mhprager.com  Mon May 10 16:01:51 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Mon, 10 May 2010 10:01:51 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <4BE80B27.60507@gmail.com>
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com>	<4BE7E112.2030005@gmail.com>
	<8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
	<4BE80B27.60507@gmail.com>
Message-ID: <4BE811CF.9050604@mhprager.com>

[New material at end]

Duncan Murdoch wrote on 5/10/2010 9:33 AM:
> On 10/05/2010 8:28 AM, Mike Prager wrote:
>> On Mon, 10 May 2010 06:33:54 -0400, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>>
>> >Mike Prager wrote:
>> >> Windows XP.  I have just updated to R 2.11.0 and then run
>> >> update.packages. In the series of updates, a few will succeed, then I
>> >> get a failure like
>> >>
>> >>
>> >> package 'mvtnorm' successfully unpacked and MD5 sums checked
>> >> package 'party' successfully unpacked and MD5 sums checked
>> >> package 'PBSmodelling' successfully unpacked and MD5 sums checked
>> >> Error in normalizePath(path) : >>   path[1]="c:\Program 
>> Files\R\Library/PBSmodelling": The system cannot
>> >> find the file specified
>> >> >
>> >Is that a cut and paste of the error message?  Normally R would 
>> double >the backslashes when displaying a string, so it looks as 
>> though you've >somehow got a path containing the control characters 
>> \P, \R, and \L. >Did you set the lib.loc argument when you called 
>> update.packages?
>>
>> Thank you!  Yes, it's cut and paste.  I did not set lib.loc in the
>> call (made through the Rgui.exe menu system), but I have the library
>> location defined in the environment:
>>
>> R_LIBS=c:/Program Files/R/Library
>>
>> I've been using this approach for several years, and it's worked
>> without problem until now.
> I can't seem to reproduce this.  If it happens reproducibly on your 
> system, could you please do the following:
> print the result of installed.packages()["PBSmodelling",], .libPaths() 
> and sessionInfo()?
>
> A possible workaround is to get the names of all of your packages in 
> the Library folder and install them, rather than using the 
> update.packages() function.  This may fail if some of them aren't on 
> CRAN or the other repositories.
>

Duncan, thanks again.  At the end of this message is a session 
transcript with the things you asked.  Rather than edit out something 
that might prove important, I am sending the entire transcript.

Yes, installing rather than updating is a workaround.

One thing in the session log requires explanation. The two directories 
under .libPaths point to the same place. This is because drive D: is an 
alias, generated with the "subst" Windows command, for "c:/Program 
Files/".  I had been specifying environment variable

R_LIBS=d:/R/Library

but to eliminate that as a potential cause of the problem, I changed it to

R_LIBS=c:/Program Files/R/Library

with no change in symptoms.

I note that (as another user with the same issue pointed out to me in an 
email) there are new directories filexxxxxx (where the xxxxxx are hex 
digits) in the library location. These seem to be from the failed 
updates.  For example, file1eb26e9 has one subdirectory, PBSmodeling.

Something different now from when updates all succeeded in the past is 
that I have a large upload (to Amazon S3) running in the background. I 
can't guess whether this is part of the issue. A time-out on the 
directory rename would be a wild guess.

MHP


------- session transcript follows -----

R version 2.11.0 (2010-04-22)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

   Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Loading required package: survival
Loading required package: stats
Loading required package: utils
Loading required package: graphics
Loading required package: splines

Attaching package: 'Hmisc'

The following object(s) are masked from 'package:survival':

     untangle.specials

The following object(s) are masked from 'package:base':

     format.pval, round.POSIXt, trunc.POSIXt, units

[Previously saved workspace restored]

 > update.packages(ask='graphics')
trying URL 'http://cran.wustl.edu/bin/windows/contrib/2.11/rJava_0.8-4.zip'
Content type 'application/zip' length 571732 bytes (558 Kb)
opened URL
downloaded 558 Kb

trying URL 'http://cran.wustl.edu/bin/windows/contrib/2.11/SparseM_0.85.zip'
Content type 'application/zip' length 927538 bytes (905 Kb)
opened URL
downloaded 905 Kb

trying URL 
'http://cran.wustl.edu/bin/windows/contrib/2.11/strucchange_1.4-0.zip'
Content type 'application/zip' length 968725 bytes (946 Kb)
opened URL
downloaded 946 Kb

trying URL 
'http://cran.wustl.edu/bin/windows/contrib/2.11/svMisc_0.9-57.zip'
Content type 'application/zip' length 134502 bytes (131 Kb)
opened URL
downloaded 131 Kb

trying URL 'http://cran.wustl.edu/bin/windows/contrib/2.11/vcd_1.2-8.zip'
Content type 'application/zip' length 1179976 bytes (1.1 Mb)
opened URL
downloaded 1.1 Mb

trying URL 'http://cran.wustl.edu/bin/windows/contrib/2.11/XML_3.1-0.zip'
Content type 'application/zip' length 2347364 bytes (2.2 Mb)
opened URL
downloaded 2.2 Mb

trying URL 'http://cran.wustl.edu/bin/windows/contrib/2.11/zoo_1.6-3.zip'
Content type 'application/zip' length 1065934 bytes (1.0 Mb)
opened URL
downloaded 1.0 Mb

package 'rJava' successfully unpacked and MD5 sums checked
package 'SparseM' successfully unpacked and MD5 sums checked
Error in normalizePath(path) :
   path[1]="d:\R\Library/SparseM": The system cannot find the file specified
 > installed.packages()["SparseM",]
Error: subscript out of bounds
 > .libPaths()
[1] "d:/R/Library"                    "C:/PROGRA~1/R/R-211~1.0/library"
 > sessionInfo()
R version 2.11.0 (2010-04-22)
i386-pc-mingw32

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] grDevices datasets  splines   graphics  utils     stats     
methods   base

other attached packages:
[1] Hmisc_3.8-0     survival_2.35-8

loaded via a namespace (and not attached):
[1] cluster_1.12.3 grid_2.11.0    lattice_0.18-5 tools_2.11.0
 >


From abryant at i-review.com  Mon May 10 20:49:55 2010
From: abryant at i-review.com (Alex Bryant)
Date: Mon, 10 May 2010 14:49:55 -0400
Subject: [Rd] Build R static
Message-ID: <41A047C9B0CF8D4CBB0C8BA991086CCB0E426D0DF6@exchange07.i-review.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100510/b9a60958/attachment.pl>

From mike.prager at mhprager.com  Tue May 11 05:06:23 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Mon, 10 May 2010 23:06:23 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70002E66CC3@NA-PA-VBE03.na.tibco.com>
References: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k@4ax.com><4BE7E112.2030005@gmail.com>
	<8kufu51cu368dujtpdqgu5ckfliel4qa85@4ax.com>
	<77EB52C6DD32BA4D87471DCD70C8D70002E66CC3@NA-PA-VBE03.na.tibco.com>
Message-ID: <4BE8C9AF.3050000@mhprager.com>

Bill,

Not in my case. The Indexing Service is disabled on my PC.

MHP


William Dunlap wrote on 5/10/2010 10:42 AM:
> Someone once suggested this error happened was
> due to the Windows 'Indexing Service' (sp?) delaying
> the commital of a request to rename a directory
> (so a subsequent request to use the renamed directory
> failed).
>
> Was the indexing service running when this happened?
>
>    
>>>> package 'PBSmodelling' successfully unpacked and MD5 sums checked
>>>> Error in normalizePath(path) :
>>>>    path[1]="c:\Program Files\R\Library/PBSmodelling": The
>> system cannot
>>>> find the file specified
>>>>


From georgi.boshnakov at manchester.ac.uk  Tue May 11 12:35:23 2010
From: georgi.boshnakov at manchester.ac.uk (Georgi Boshnakov)
Date: Tue, 11 May 2010 11:35:23 +0100
Subject: [Rd] update.packages fails with directory not found
Message-ID: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>

I posted a similar problem to this list but had no response.
The full email is copied below.

In a nutshell, I traced the message to normalizePath,
which issues it. The directory does not exist because a "move/rename  
directory" command, issued at the end of the installation, failed. The  
directory you see would have been renamed to the eventual one otherwise.

Since it is the move/rename command which fails on otherwise  
(seemingly) successful installation, is it possible to try to copy the  
directory when renaming fails and, if successful, inform the user that  
a temporary directory has been left behind?


Georgi Boshnakov
Univeristy of Manchester


----------------------------------------------------------------------

Message: 1
Date: Mon, 10 May 2010 00:07:50 -0400
From: Mike Prager <mike.prager at mhprager.com>
To: r-devel at stat.math.ethz.ch
Subject: [Rd] update.packages fails with directory not found
Message-ID: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k at 4ax.com>
Content-Type: text/plain; charset=us-ascii

Windows XP.  I have just updated to R 2.11.0 and then run
update.packages. In the series of updates, a few will succeed, then I
get a failure like


package 'mvtnorm' successfully unpacked and MD5 sums checked
package 'party' successfully unpacked and MD5 sums checked
package 'PBSmodelling' successfully unpacked and MD5 sums checked
Error in normalizePath(path) :
   path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
find the file specified


Indeed, the path is missing, though it was there when I issued the
update.packages command.

???

--
Mike Prager, NC, USA



------------------------------



----- Forwarded message from georgi.boshnakov at manchester.ac.uk -----
     Date: Thu, 18 Feb 2010 10:43:11 +0000
     From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
  Subject: install.packages, normalizePath, file permissions
       To: r-devel at r-project.org

Dear developers,

I have a small but more or less well defined inquiry. Another, more  
general one for which I was not able to find information is towards  
the end of this messages. The question seems to be too technical for  
R-help, that is why I post it here.

When installing packages (Windows XP), occasionally the installation  
does not complete because, it seems, Windows locks some files. I  
normally ignore this as a minor annoyance but now I wish to ask  
students to install a number of often used packages by sourcing an R  
file and this becomes a problem.

Here is an example:

> install.packages( file.path(fp,"fgui_1.0-0.zip"     ), repos=NULL)
Warning in install.packages(file.path(fp, "fgui_1.0-0.zip"), repos = NULL) :
   argument 'lib' is missing: using 'p:/Rpack'
package 'fgui' successfully unpacked and MD5 sums checked
Error in normalizePath(path) :
   path[1]="p:\Rpack/fgui": The system cannot find the file specified


The circumstances are difficult to reproduce. For some reason, the  
system does not like "fgui" and maybe other packages. The p: drive  
above is network attached and and I have read/write access. Here is  
the result of traceback.

> traceback()
7: normalizePath(instPath)
6: sprintf(gettext(fmt, domain = domain), ...)
5: gettextf("unable to move temporary installation '%s' to '%s'",
        normalizePath(file.path(tmpDir, curPkg)), normalizePath(instPath))
4: warning(gettextf("unable to move temporary installation '%s' to '%s'",
        normalizePath(file.path(tmpDir, curPkg)), normalizePath(instPath)),
        domain = NA, call. = FALSE, immediate. = TRUE)
3: unpackPkg(pkgs[i], pkgnames[i], lib)
2: .install.winbinary(pkgs = pkgs, lib = lib, contriburl = contriburl,
        method = method, available = available, destdir = destdir,
        dependencies = dependencies, ...)
1: install.packages(file.path(fp, "fgui_1.0-0.zip"), repos = NULL)

The error seems to be thrown by the folloing chunk towards the end of  
.install.winbinary():

   ret <- file.rename(file.path(tmpDir, curPkg), instPath)
   if(!ret)
     warning(gettextf("unable to move temporary installation '%s' to '%s'",
                      normalizePath(file.path(tmpDir, curPkg)),
                      normalizePath(instPath)),
              domain = NA, call. = FALSE, immediate. = TRUE)
   ...

Apparently, renaming failed and a message is displayed.
The failure of rename.file may have left the directory specified by  
'instPath' non-existent which may cause normalizePath to fail. When  
this happens
the message printed is not that of warninig() but the one from  
normalizePath() which is uninformative for the user. Maybe an  
additional check here would be appropriate and, given that the  
installation has been basically successful at this point, even an  
attempt to copy the directory after the refusal by Windows to rename  
it? I understand of course that the developers have better things to  
do than to wrestle with the caprice of Windows.


====
Here is a more general enquiry.

I am using R in a statistics course (about 100) students in a computer  
cluster where R is installed on a server, students run WindowsXP and  
to my understanding the program is run by something called "Zen". It  
seems that if a number of students try loading packages, things become  
extremely slow and loading fails for some.

The IT services claim that R is the culprit, I am not sure and  
certainly part of the problem is related to the slow speed of the  
network, but a few problems seem to be related to permissions. I tried  
using options(timeout=N) even trying ridiculous values for N but this  
did not improve things.

I was not able to trace discussions of such issues and wonder if  
somebody has encountered similar problems.

I am about to try ask the students to install some packages in their  
area (called p: drive at this Uni) which prompted the first question  
above.

Thank you for any suggestions,
Georgi


-- 
Dr Georgi Boshnakov               tel: (+44) (0)161 306 3684
School of Mathematics             fax: (+44) (0)161 306 3669
Alan Turing Building 1.125
The University of Manchester      email: Georgi.Boshnakov at manchester.ac.uk
Oxford Road
Manchester M13 9PL
UK




----- End forwarded message -----


-- 
Dr Georgi Boshnakov               tel: (+44) (0)161 306 3684
School of Mathematics             fax: (+44) (0)161 306 3669
Alan Turing Building 1.125
The University of Manchester      email: Georgi.Boshnakov at manchester.ac.uk
Oxford Road
Manchester M13 9PL
UK


From murdoch.duncan at gmail.com  Tue May 11 13:47:38 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 11 May 2010 07:47:38 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>
Message-ID: <4BE943DA.2000000@gmail.com>

On 11/05/2010 6:35 AM, Georgi Boshnakov wrote:
> I posted a similar problem to this list but had no response.
> The full email is copied below.
>   

Thanks for reposting this.  I didn't see the original (I was travelling 
at the time).
> In a nutshell, I traced the message to normalizePath,
> which issues it. The directory does not exist because a "move/rename  
> directory" command, issued at the end of the installation, failed. The  
> directory you see would have been renamed to the eventual one otherwise.
>   

I'll change normalizePath to generate a warning rather than an error.  
This may allow processing to continue.
> Since it is the move/rename command which fails on otherwise  
> (seemingly) successful installation, is it possible to try to copy the  
> directory when renaming fails and, if successful, inform the user that  
> a temporary directory has been left behind?
>   

It was just a warning message about not moving the directory.  But the 
warning message itself triggered an error, which stopped the install.  
So maybe things will be okay if we just stop the error.

The big problem with this particular bug is that it is not reproducible 
on demand.  So I can make changes, but I have no idea if they are effective.

Duncan Murdoch
>
> Georgi Boshnakov
> Univeristy of Manchester
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 10 May 2010 00:07:50 -0400
> From: Mike Prager <mike.prager at mhprager.com>
> To: r-devel at stat.math.ethz.ch
> Subject: [Rd] update.packages fails with directory not found
> Message-ID: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k at 4ax.com>
> Content-Type: text/plain; charset=us-ascii
>
> Windows XP.  I have just updated to R 2.11.0 and then run
> update.packages. In the series of updates, a few will succeed, then I
> get a failure like
>
>
> package 'mvtnorm' successfully unpacked and MD5 sums checked
> package 'party' successfully unpacked and MD5 sums checked
> package 'PBSmodelling' successfully unpacked and MD5 sums checked
> Error in normalizePath(path) :
>    path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
> find the file specified
>
>
> Indeed, the path is missing, though it was there when I issued the
> update.packages command.
>
> ???
>
> --
> Mike Prager, NC, USA
>
>
>
> ------------------------------
>
>
>
> ----- Forwarded message from georgi.boshnakov at manchester.ac.uk -----
>      Date: Thu, 18 Feb 2010 10:43:11 +0000
>      From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
>   Subject: install.packages, normalizePath, file permissions
>        To: r-devel at r-project.org
>
> Dear developers,
>
> I have a small but more or less well defined inquiry. Another, more  
> general one for which I was not able to find information is towards  
> the end of this messages. The question seems to be too technical for  
> R-help, that is why I post it here.
>
> When installing packages (Windows XP), occasionally the installation  
> does not complete because, it seems, Windows locks some files. I  
> normally ignore this as a minor annoyance but now I wish to ask  
> students to install a number of often used packages by sourcing an R  
> file and this becomes a problem.
>
> Here is an example:
>
>   
>> install.packages( file.path(fp,"fgui_1.0-0.zip"     ), repos=NULL)
>>     
> Warning in install.packages(file.path(fp, "fgui_1.0-0.zip"), repos = NULL) :
>    argument 'lib' is missing: using 'p:/Rpack'
> package 'fgui' successfully unpacked and MD5 sums checked
> Error in normalizePath(path) :
>    path[1]="p:\Rpack/fgui": The system cannot find the file specified
>
>
> The circumstances are difficult to reproduce. For some reason, the  
> system does not like "fgui" and maybe other packages. The p: drive  
> above is network attached and and I have read/write access. Here is  
> the result of traceback.
>
>   
>> traceback()
>>     
> 7: normalizePath(instPath)
> 6: sprintf(gettext(fmt, domain = domain), ...)
> 5: gettextf("unable to move temporary installation '%s' to '%s'",
>         normalizePath(file.path(tmpDir, curPkg)), normalizePath(instPath))
> 4: warning(gettextf("unable to move temporary installation '%s' to '%s'",
>         normalizePath(file.path(tmpDir, curPkg)), normalizePath(instPath)),
>         domain = NA, call. = FALSE, immediate. = TRUE)
> 3: unpackPkg(pkgs[i], pkgnames[i], lib)
> 2: .install.winbinary(pkgs = pkgs, lib = lib, contriburl = contriburl,
>         method = method, available = available, destdir = destdir,
>         dependencies = dependencies, ...)
> 1: install.packages(file.path(fp, "fgui_1.0-0.zip"), repos = NULL)
>
> The error seems to be thrown by the folloing chunk towards the end of  
> .install.winbinary():
>
>    ret <- file.rename(file.path(tmpDir, curPkg), instPath)
>    if(!ret)
>      warning(gettextf("unable to move temporary installation '%s' to '%s'",
>                       normalizePath(file.path(tmpDir, curPkg)),
>                       normalizePath(instPath)),
>               domain = NA, call. = FALSE, immediate. = TRUE)
>    ...
>
> Apparently, renaming failed and a message is displayed.
> The failure of rename.file may have left the directory specified by  
> 'instPath' non-existent which may cause normalizePath to fail. When  
> this happens
> the message printed is not that of warninig() but the one from  
> normalizePath() which is uninformative for the user. Maybe an  
> additional check here would be appropriate and, given that the  
> installation has been basically successful at this point, even an  
> attempt to copy the directory after the refusal by Windows to rename  
> it? I understand of course that the developers have better things to  
> do than to wrestle with the caprice of Windows.
>
>
> ====
> Here is a more general enquiry.
>
> I am using R in a statistics course (about 100) students in a computer  
> cluster where R is installed on a server, students run WindowsXP and  
> to my understanding the program is run by something called "Zen". It  
> seems that if a number of students try loading packages, things become  
> extremely slow and loading fails for some.
>
> The IT services claim that R is the culprit, I am not sure and  
> certainly part of the problem is related to the slow speed of the  
> network, but a few problems seem to be related to permissions. I tried  
> using options(timeout=N) even trying ridiculous values for N but this  
> did not improve things.
>
> I was not able to trace discussions of such issues and wonder if  
> somebody has encountered similar problems.
>
> I am about to try ask the students to install some packages in their  
> area (called p: drive at this Uni) which prompted the first question  
> above.
>
> Thank you for any suggestions,
> Georgi
>
>
>


From pdalgd at gmail.com  Tue May 11 14:03:11 2010
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 11 May 2010 14:03:11 +0200
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>
Message-ID: <6EC6CCAB-5C50-41C3-B52B-1AD547C283DF@gmail.com>


On May 11, 2010, at 12:35 PM, Georgi Boshnakov wrote:

> I posted a similar problem to this list but had no response.
> The full email is copied below.

Well, things sometimes just fly by....

> 
> In a nutshell, I traced the message to normalizePath,
> which issues it. The directory does not exist because a "move/rename directory" command, issued at the end of the installation, failed. The directory you see would have been renamed to the eventual one otherwise.
> 
> Since it is the move/rename command which fails on otherwise (seemingly) successful installation, is it possible to try to copy the directory when renaming fails and, if successful, inform the user that a temporary directory has been left behind?
> 

Looks like there is a fundamental issue to solve first, anyway:

> [...much snippage...]
>  ret <- file.rename(file.path(tmpDir, curPkg), instPath)
>  if(!ret)
>    warning(gettextf("unable to move temporary installation '%s' to '%s'",
>                     normalizePath(file.path(tmpDir, curPkg)),
>                     normalizePath(instPath)),
>             domain = NA, call. = FALSE, immediate. = TRUE)
>  ...

Yes, as your analysis below more or less indicates: There is a logical problem here! If we can only normalize paths to existing files, then we can not use normalizePath in warning messages saying that we couldn't create them.

The internal issue would seem to be that do_normalizepath internally calls and checks for success of GetLongPathName or its -W version, and I expect that cannot work on paths that don't exist.  

> 
> Apparently, renaming failed and a message is displayed.
> The failure of rename.file may have left the directory specified by 'instPath' non-existent which may cause normalizePath to fail. When this happens
> the message printed is not that of warninig() but the one from normalizePath() which is uninformative for the user. Maybe an additional check here would be appropriate and, given that the installation has been basically successful at this point, even an attempt to copy the directory after the refusal by Windows to rename it? I understand of course that the developers have better things to do than to wrestle with the caprice of Windows.

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From murdoch.duncan at gmail.com  Tue May 11 17:05:45 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 11 May 2010 11:05:45 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <4BE943DA.2000000@gmail.com>
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>
	<4BE943DA.2000000@gmail.com>
Message-ID: <4BE97249.7020200@gmail.com>

I've now also committed a change to the file.rename code (on Windows) so 
that it waits for the file copy to complete before returning.  It seems 
possible that it was returning too early, so the next step of the 
install failed.

I'd appreciate it if you could check whether the problems remain in 
R-devel, revision 51980 or later.  (A build of this revision should be 
on CRAN by tomorrow, at 
http://cran.r-project.org/bin/windows/base/rdevel.html .)

Duncan Murdoch


On 11/05/2010 7:47 AM, Duncan Murdoch wrote:
> On 11/05/2010 6:35 AM, Georgi Boshnakov wrote:
> > I posted a similar problem to this list but had no response.
> > The full email is copied below.
> >   
>
> Thanks for reposting this.  I didn't see the original (I was travelling 
> at the time).
> > In a nutshell, I traced the message to normalizePath,
> > which issues it. The directory does not exist because a "move/rename  
> > directory" command, issued at the end of the installation, failed. The  
> > directory you see would have been renamed to the eventual one otherwise.
> >   
>
> I'll change normalizePath to generate a warning rather than an error.  
> This may allow processing to continue.
> > Since it is the move/rename command which fails on otherwise  
> > (seemingly) successful installation, is it possible to try to copy the  
> > directory when renaming fails and, if successful, inform the user that  
> > a temporary directory has been left behind?
> >   
>
> It was just a warning message about not moving the directory.  But the 
> warning message itself triggered an error, which stopped the install.  
> So maybe things will be okay if we just stop the error.
>
> The big problem with this particular bug is that it is not reproducible 
> on demand.  So I can make changes, but I have no idea if they are effective.
>
> Duncan Murdoch
> >
> > Georgi Boshnakov
> > Univeristy of Manchester
> >
> >
> > ----------------------------------------------------------------------
> >
> > Message: 1
> > Date: Mon, 10 May 2010 00:07:50 -0400
> > From: Mike Prager <mike.prager at mhprager.com>
> > To: r-devel at stat.math.ethz.ch
> > Subject: [Rd] update.packages fails with directory not found
> > Message-ID: <t81fu5t8gg8crt5nm3h3d3rg6bcg7lri7k at 4ax.com>
> > Content-Type: text/plain; charset=us-ascii
> >
> > Windows XP.  I have just updated to R 2.11.0 and then run
> > update.packages. In the series of updates, a few will succeed, then I
> > get a failure like
> >
> >
> > package 'mvtnorm' successfully unpacked and MD5 sums checked
> > package 'party' successfully unpacked and MD5 sums checked
> > package 'PBSmodelling' successfully unpacked and MD5 sums checked
> > Error in normalizePath(path) :
> >    path[1]="c:\Program Files\R\Library/PBSmodelling": The system cannot
> > find the file specified
> >
> >
> > Indeed, the path is missing, though it was there when I issued the
> > update.packages command.
> >
> > ???
> >
> > --
> > Mike Prager, NC, USA
> >
> >
> >
> > ------------------------------
> >
> >
> >
> > ----- Forwarded message from georgi.boshnakov at manchester.ac.uk -----
> >      Date: Thu, 18 Feb 2010 10:43:11 +0000
> >      From: Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk>
> >   Subject: install.packages, normalizePath, file permissions
> >        To: r-devel at r-project.org
> >
> > Dear developers,
> >
> > I have a small but more or less well defined inquiry. Another, more  
> > general one for which I was not able to find information is towards  
> > the end of this messages. The question seems to be too technical for  
> > R-help, that is why I post it here.
> >
> > When installing packages (Windows XP), occasionally the installation  
> > does not complete because, it seems, Windows locks some files. I  
> > normally ignore this as a minor annoyance but now I wish to ask  
> > students to install a number of often used packages by sourcing an R  
> > file and this becomes a problem.
> >
> > Here is an example:
> >
> >   
> >> install.packages( file.path(fp,"fgui_1.0-0.zip"     ), repos=NULL)
> >>     
> > Warning in install.packages(file.path(fp, "fgui_1.0-0.zip"), repos = NULL) :
> >    argument 'lib' is missing: using 'p:/Rpack'
> > package 'fgui' successfully unpacked and MD5 sums checked
> > Error in normalizePath(path) :
> >    path[1]="p:\Rpack/fgui": The system cannot find the file specified
> >
> >
> > The circumstances are difficult to reproduce. For some reason, the  
> > system does not like "fgui" and maybe other packages. The p: drive  
> > above is network attached and and I have read/write access. Here is  
> > the result of traceback.
> >
> >   
> >> traceback()
> >>     
> > 7: normalizePath(instPath)
> > 6: sprintf(gettext(fmt, domain = domain), ...)
> > 5: gettextf("unable to move temporary installation '%s' to '%s'",
> >         normalizePath(file.path(tmpDir, curPkg)), normalizePath(instPath))
> > 4: warning(gettextf("unable to move temporary installation '%s' to '%s'",
> >         normalizePath(file.path(tmpDir, curPkg)), normalizePath(instPath)),
> >         domain = NA, call. = FALSE, immediate. = TRUE)
> > 3: unpackPkg(pkgs[i], pkgnames[i], lib)
> > 2: .install.winbinary(pkgs = pkgs, lib = lib, contriburl = contriburl,
> >         method = method, available = available, destdir = destdir,
> >         dependencies = dependencies, ...)
> > 1: install.packages(file.path(fp, "fgui_1.0-0.zip"), repos = NULL)
> >
> > The error seems to be thrown by the folloing chunk towards the end of  
> > .install.winbinary():
> >
> >    ret <- file.rename(file.path(tmpDir, curPkg), instPath)
> >    if(!ret)
> >      warning(gettextf("unable to move temporary installation '%s' to '%s'",
> >                       normalizePath(file.path(tmpDir, curPkg)),
> >                       normalizePath(instPath)),
> >               domain = NA, call. = FALSE, immediate. = TRUE)
> >    ...
> >
> > Apparently, renaming failed and a message is displayed.
> > The failure of rename.file may have left the directory specified by  
> > 'instPath' non-existent which may cause normalizePath to fail. When  
> > this happens
> > the message printed is not that of warninig() but the one from  
> > normalizePath() which is uninformative for the user. Maybe an  
> > additional check here would be appropriate and, given that the  
> > installation has been basically successful at this point, even an  
> > attempt to copy the directory after the refusal by Windows to rename  
> > it? I understand of course that the developers have better things to  
> > do than to wrestle with the caprice of Windows.
> >
> >
> > ====
> > Here is a more general enquiry.
> >
> > I am using R in a statistics course (about 100) students in a computer  
> > cluster where R is installed on a server, students run WindowsXP and  
> > to my understanding the program is run by something called "Zen". It  
> > seems that if a number of students try loading packages, things become  
> > extremely slow and loading fails for some.
> >
> > The IT services claim that R is the culprit, I am not sure and  
> > certainly part of the problem is related to the slow speed of the  
> > network, but a few problems seem to be related to permissions. I tried  
> > using options(timeout=N) even trying ridiculous values for N but this  
> > did not improve things.
> >
> > I was not able to trace discussions of such issues and wonder if  
> > somebody has encountered similar problems.
> >
> > I am about to try ask the students to install some packages in their  
> > area (called p: drive at this Uni) which prompted the first question  
> > above.
> >
> > Thank you for any suggestions,
> > Georgi
> >
> >
> >   
>
>


From rdpeng at gmail.com  Tue May 11 23:20:13 2010
From: rdpeng at gmail.com (Roger Peng)
Date: Tue, 11 May 2010 17:20:13 -0400
Subject: [Rd] Sweave Feature Requests and Questions
In-Reply-To: <x2lb7bfe54e1005081635of51056f4v186ff8edb116cf6b@mail.gmail.com>
References: <x2lb7bfe54e1005081635of51056f4v186ff8edb116cf6b@mail.gmail.com>
Message-ID: <AANLkTim4Z43TI_v3VpUGSxO0T3lSu2V-rLl3OZq4fkqa@mail.gmail.com>

Hi, see below.

On Sat, May 8, 2010 at 7:35 PM, Charlotte Maia <maiagx at gmail.com> wrote:

<snip>

> Furthermore, any help appreciated here:
> 1. Does anyone know how to build Sweave documents, using Make, without
> starting a new instance (or multiple instances) of R, every time Make
> is called?

This can be worked around if you have code sections that don't change
at all, put them in a separate file and import them into the "main"
LaTeX document using '\input'. Then use the Makefile to specify the
dependencies between the LaTeX files. That way, when you run make the
first time, everything will run, but on subsequent calls to make,
Sweave will not be called as long as the code in the separate file
hasn't changed.

> 2. Does anyone know a simple workaround to problem 3, without killing
> the entire Sweave.sty file?
>
> Furthermore, I'm temped to stop Sweave from generating all the eps
> files (I saw an option for this in the Sweave documentation), however
> I'm concerned it may stop others from building the document, if they
> use postscript.
>
> Then again, do enough people use postscript, to warrant such consideration?

I don't think I've used postscript in about 8 years.

-roger

-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From mike.prager at mhprager.com  Wed May 12 00:21:01 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Tue, 11 May 2010 18:21:01 -0400
Subject: [Rd] update.packages fails with directory not found
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>
	<4BE943DA.2000000@gmail.com> <4BE97249.7020200@gmail.com>
Message-ID: <vqlju59e57vdn320hiq5r00j8brlchgoil@4ax.com>

On Tue, 11 May 2010 11:05:45 -0400, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:

>I'd appreciate it if you could check whether the problems remain in 
>R-devel, revision 51980 or later.  (A build of this revision should be 
>on CRAN by tomorrow, at 
>http://cran.r-project.org/bin/windows/base/rdevel.html .)
>
Thanks for trying to fix this. Here is a cut-and-paste [...edited]
from Rgui.exe.  Hope it helps.  MHP


R version 2.12.0 Under development (unstable) (2010-05-11 r51980)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0  [...]

  Natural language support but running in an English locale

[...]
Loading required package: survival
Loading required package: stats
Loading required package: utils
Loading required package: graphics
Loading required package: splines

Attaching package: 'Hmisc'
[...]

> update.packages(ask='graphics')
trying URL [...]
downloaded 1.0 Mb

package 'maps' successfully unpacked and MD5 sums checked
package 'rgl' successfully unpacked and MD5 sums checked
package 'rJava' successfully unpacked and MD5 sums checked
Warning: unable to move temporary installation 'c:\Program
Files\R\Library\file390c7e87\rJava' to 'c:\Program
Files\R\Library\rJava'
package 'strucchange' successfully unpacked and MD5 sums checked
package 'svMisc' successfully unpacked and MD5 sums checked
package 'tkrplot' successfully unpacked and MD5 sums checked
package 'vcd' successfully unpacked and MD5 sums checked
package 'XML' successfully unpacked and MD5 sums checked
package 'zoo' successfully unpacked and MD5 sums checked

The downloaded packages are in
        C:\Documents and Settings\mike.prager\Local
Settings\Temp\RtmpyrBgXD\downloaded_packages
Warning message:
In normalizePath(path) :
  path[1]="c:\Program Files\R\Library/rJava": The system cannot find
the file specified
> traceback()
No traceback available 
>


From murdoch.duncan at gmail.com  Wed May 12 01:03:00 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 11 May 2010 19:03:00 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <vqlju59e57vdn320hiq5r00j8brlchgoil@4ax.com>
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>	<4BE943DA.2000000@gmail.com>
	<4BE97249.7020200@gmail.com>
	<vqlju59e57vdn320hiq5r00j8brlchgoil@4ax.com>
Message-ID: <4BE9E224.40409@gmail.com>

On 11/05/2010 6:21 PM, Mike Prager wrote:
> On Tue, 11 May 2010 11:05:45 -0400, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>
>   
>> I'd appreciate it if you could check whether the problems remain in 
>> R-devel, revision 51980 or later.  (A build of this revision should be 
>> on CRAN by tomorrow, at 
>> http://cran.r-project.org/bin/windows/base/rdevel.html .)
>>
>>     
> Thanks for trying to fix this. Here is a cut-and-paste [...edited]
> from Rgui.exe.  Hope it helps.  MHP
>
>
> R version 2.12.0 Under development (unstable) (2010-05-11 r51980)
> Copyright (C) 2010 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0  [...]
>
>   Natural language support but running in an English locale
>
> [...]
> Loading required package: survival
> Loading required package: stats
> Loading required package: utils
> Loading required package: graphics
> Loading required package: splines
>
> Attaching package: 'Hmisc'
> [...]
>
>   

Was rJava among the packages loaded at the time you tried this?
>> update.packages(ask='graphics')
>>     
> trying URL [...]
> downloaded 1.0 Mb
>
> package 'maps' successfully unpacked and MD5 sums checked
> package 'rgl' successfully unpacked and MD5 sums checked
> package 'rJava' successfully unpacked and MD5 sums checked
> Warning: unable to move temporary installation 'c:\Program
> Files\R\Library\file390c7e87\rJava' to 'c:\Program
> Files\R\Library\rJava'
>   

After the install was complete, was rJava present in Library?  Was it 
updated?  Was the temporary directory file390c7e87 still present?

Duncan Murdoch

> package 'strucchange' successfully unpacked and MD5 sums checked
> package 'svMisc' successfully unpacked and MD5 sums checked
> package 'tkrplot' successfully unpacked and MD5 sums checked
> package 'vcd' successfully unpacked and MD5 sums checked
> package 'XML' successfully unpacked and MD5 sums checked
> package 'zoo' successfully unpacked and MD5 sums checked
>
> The downloaded packages are in
>         C:\Documents and Settings\mike.prager\Local
> Settings\Temp\RtmpyrBgXD\downloaded_packages
> Warning message:
> In normalizePath(path) :
>   path[1]="c:\Program Files\R\Library/rJava": The system cannot find
> the file specified
>   
>> traceback()
>>     
> No traceback available 
>   
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From wdunlap at tibco.com  Wed May 12 17:49:42 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 12 May 2010 08:49:42 -0700
Subject: [Rd] update.packages fails with directory not found
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70002E67146@NA-PA-VBE03.na.tibco.com>

Mike,
  If you have the time and can consistently reproduce
this problem you might try using Sysinternal's
Process Monitor program to capture the details of what
R and other programs were doing in that directory around
the time of the problem.
  http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx

I have not used Process Monitor, but have profitably used
the older Filemon program and Process Explorer from Sysinternals.
They act somewhat like the Linux lsof and strace programs,
tracing things at the interface between a program and the
operating system.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Mike Prager
> Sent: Tuesday, May 11, 2010 3:21 PM
> To: r-devel at stat.math.ethz.ch
> Subject: Re: [Rd] update.packages fails with directory not found
> 
> On Tue, 11 May 2010 11:05:45 -0400, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
> 
> >I'd appreciate it if you could check whether the problems remain in 
> >R-devel, revision 51980 or later.  (A build of this revision 
> should be 
> >on CRAN by tomorrow, at 
> >http://cran.r-project.org/bin/windows/base/rdevel.html .)
> >
> Thanks for trying to fix this. Here is a cut-and-paste [...edited]
> from Rgui.exe.  Hope it helps.  MHP
> 
> 
> R version 2.12.0 Under development (unstable) (2010-05-11 r51980)
> Copyright (C) 2010 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0  [...]
> 
>   Natural language support but running in an English locale
> 
> [...]
> Loading required package: survival
> Loading required package: stats
> Loading required package: utils
> Loading required package: graphics
> Loading required package: splines
> 
> Attaching package: 'Hmisc'
> [...]
> 
> > update.packages(ask='graphics')
> trying URL [...]
> downloaded 1.0 Mb
> 
> package 'maps' successfully unpacked and MD5 sums checked
> package 'rgl' successfully unpacked and MD5 sums checked
> package 'rJava' successfully unpacked and MD5 sums checked
> Warning: unable to move temporary installation 'c:\Program
> Files\R\Library\file390c7e87\rJava' to 'c:\Program
> Files\R\Library\rJava'
> package 'strucchange' successfully unpacked and MD5 sums checked
> package 'svMisc' successfully unpacked and MD5 sums checked
> package 'tkrplot' successfully unpacked and MD5 sums checked
> package 'vcd' successfully unpacked and MD5 sums checked
> package 'XML' successfully unpacked and MD5 sums checked
> package 'zoo' successfully unpacked and MD5 sums checked
> 
> The downloaded packages are in
>         C:\Documents and Settings\mike.prager\Local
> Settings\Temp\RtmpyrBgXD\downloaded_packages
> Warning message:
> In normalizePath(path) :
>   path[1]="c:\Program Files\R\Library/rJava": The system cannot find
> the file specified
> > traceback()
> No traceback available 
> >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From mike.prager at mhprager.com  Wed May 12 18:42:58 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Wed, 12 May 2010 12:42:58 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <4BE9E224.40409@gmail.com>
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>	<4BE943DA.2000000@gmail.com>
	<4BE97249.7020200@gmail.com>
	<vqlju59e57vdn320hiq5r00j8brlchgoil@4ax.com>
	<4BE9E224.40409@gmail.com>
Message-ID: <4BEADA92.4020406@mhprager.com>

Shortened a bit further. Answers to queries are at the end.  MHP

Duncan Murdoch wrote on 5/11/2010 7:03 PM:
> On 11/05/2010 6:21 PM, Mike Prager wrote:
>> On Tue, 11 May 2010 11:05:45 -0400, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>>> I'd appreciate it if you could check whether the problems remain in 
>>> R-devel, revision 51980 or later.
>> Thanks for trying to fix this. Here is a cut-and-paste [...edited]
>> from Rgui.exe.  Hope it helps.  MHP
>>
>> R version 2.12.0 Under development (unstable) (2010-05-11 r51980)
>> Copyright (C) 2010 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0  [...]
> Was rJava among the packages loaded at the time you tried this?
>>> update.packages(ask='graphics')
>> trying URL [...]
>> downloaded 1.0 Mb
>>
>> package 'rJava' successfully unpacked and MD5 sums checked
>> Warning: unable to move temporary installation 'c:\Program
>> Files\R\Library\file390c7e87\rJava' to 'c:\Program
>> Files\R\Library\rJava'
> After the install was complete, was rJava present in Library?  Was it 
> updated?  Was the temporary directory file390c7e87 still present?
[...]
> The downloaded packages are in
>>         C:\Documents and Settings\mike.prager\Local
>> Settings\Temp\RtmpyrBgXD\downloaded_packages
>> Warning message:
>> In normalizePath(path) :
>>   path[1]="c:\Program Files\R\Library/rJava": The system cannot find
>> the file specified
>
Answers:

rJava was not loaded when the update started.
After the install, rJava was no longer present in the library.
The temporary directory file390c7e87 was not present.  Checking my 
undelete program, the temp directory had existed and had contained the 
rJava package but was (and is) deleted.


From murdoch.duncan at gmail.com  Wed May 12 18:54:00 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 12 May 2010 12:54:00 -0400
Subject: [Rd] update.packages fails with directory not found
In-Reply-To: <4BEADA92.4020406@mhprager.com>
References: <20100511113523.16967kpt17eefsa3@webmail.manchester.ac.uk>	<4BE943DA.2000000@gmail.com>
	<4BE97249.7020200@gmail.com>
	<vqlju59e57vdn320hiq5r00j8brlchgoil@4ax.com>
	<4BE9E224.40409@gmail.com> <4BEADA92.4020406@mhprager.com>
Message-ID: <4BEADD28.7050507@gmail.com>

On 12/05/2010 12:42 PM, Mike Prager wrote:
> Shortened a bit further. Answers to queries are at the end.  MHP
>
> Duncan Murdoch wrote on 5/11/2010 7:03 PM:
> > On 11/05/2010 6:21 PM, Mike Prager wrote:
> >> On Tue, 11 May 2010 11:05:45 -0400, Duncan Murdoch
> >> <murdoch.duncan at gmail.com> wrote:
> >>> I'd appreciate it if you could check whether the problems remain in 
> >>> R-devel, revision 51980 or later.
> >> Thanks for trying to fix this. Here is a cut-and-paste [...edited]
> >> from Rgui.exe.  Hope it helps.  MHP
> >>
> >> R version 2.12.0 Under development (unstable) (2010-05-11 r51980)
> >> Copyright (C) 2010 The R Foundation for Statistical Computing
> >> ISBN 3-900051-07-0  [...]
> > Was rJava among the packages loaded at the time you tried this?
> >>> update.packages(ask='graphics')
> >> trying URL [...]
> >> downloaded 1.0 Mb
> >>
> >> package 'rJava' successfully unpacked and MD5 sums checked
> >> Warning: unable to move temporary installation 'c:\Program
> >> Files\R\Library\file390c7e87\rJava' to 'c:\Program
> >> Files\R\Library\rJava'
> > After the install was complete, was rJava present in Library?  Was it 
> > updated?  Was the temporary directory file390c7e87 still present?
> [...]
> > The downloaded packages are in
> >>         C:\Documents and Settings\mike.prager\Local
> >> Settings\Temp\RtmpyrBgXD\downloaded_packages
> >> Warning message:
> >> In normalizePath(path) :
> >>   path[1]="c:\Program Files\R\Library/rJava": The system cannot find
> >> the file specified
> >
> Answers:
>
> rJava was not loaded when the update started.
> After the install, rJava was no longer present in the library.
> The temporary directory file390c7e87 was not present.  Checking my 
> undelete program, the temp directory had existed and had contained the 
> rJava package but was (and is) deleted.
>
>   

I don't know what the problem is.  My current guesses:

  - Antivirus bugs.  Are you running some AV program?  Sometimes they 
interfere with other programs.
  - Permissions problems.  I don't know why rJava would have had 
different permissions than the other packages you successfully updated, 
but if it did, that could be a cause.
  - Windows bug.  R uses Windows services to move the temporary 
directory into place, and that's failing for no apparent reason. 

If you can follow Bill Dunlap's advice and monitor the process as it's 
taking place, you might be able to diagnose this, but I don't see a way 
to make any progress otherwise.

Duncan Murdoch


From jeff.a.ryan at gmail.com  Wed May 12 19:27:08 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 12 May 2010 12:27:08 -0500
Subject: [Rd] gc() reports bytes (MB) but uses notation for bits (Mb)
Message-ID: <AANLkTilqivgVtaaBNWxgG7fdYd7GoIQMhXgEu0YYdiPa@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100512/b9de027c/attachment.pl>

From bullard at stat.Berkeley.EDU  Wed May 12 20:18:16 2010
From: bullard at stat.Berkeley.EDU (James Bullard)
Date: Wed, 12 May 2010 11:18:16 -0700 (PDT)
Subject: [Rd] ranges and contiguity checking
Message-ID: <62125.66.201.56.150.1273688296.squirrel@www.stat.berkeley.edu>

Hi All,

I am interfacing to some C libraries (hdf5) and I have methods defined for
'[', these methods do hyperslab selection, however, currently I am
limiting slab selection to contiguous blocks, i.e., things defined like:
i:(i+k). I don't do any contiguity checking at this point, I just grab the
max and min of the range and them potentially do an in-memory subselection
which is what I am definitely trying to avoid. Besides using deparse, I
can't see anyway to figure out that these things (i:(i+k) and c(i, i+1,
..., i+k)) are different.

I have always liked how 1:10 was a valid expression in R (as opposed to
python where it is not by itself.), however I'd somehow like to know that
the thing was contiguous range without examining the un-evaluated
expression or worse, all(diff(i:(i+k)) == 1)

thanks, jim


From murdoch.duncan at gmail.com  Wed May 12 20:34:54 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 12 May 2010 14:34:54 -0400
Subject: [Rd] ranges and contiguity checking
In-Reply-To: <62125.66.201.56.150.1273688296.squirrel@www.stat.berkeley.edu>
References: <62125.66.201.56.150.1273688296.squirrel@www.stat.berkeley.edu>
Message-ID: <4BEAF4CE.8000203@gmail.com>

On 12/05/2010 2:18 PM, James Bullard wrote:
> Hi All,
>
> I am interfacing to some C libraries (hdf5) and I have methods defined for
> '[', these methods do hyperslab selection, however, currently I am
> limiting slab selection to contiguous blocks, i.e., things defined like:
> i:(i+k). I don't do any contiguity checking at this point, I just grab the
> max and min of the range and them potentially do an in-memory subselection
> which is what I am definitely trying to avoid. Besides using deparse, I
> can't see anyway to figure out that these things (i:(i+k) and c(i, i+1,
> ..., i+k)) are different.
>
> I have always liked how 1:10 was a valid expression in R (as opposed to
> python where it is not by itself.), however I'd somehow like to know that
> the thing was contiguous range without examining the un-evaluated
> expression or worse, all(diff(i:(i+k)) == 1)

You can implement all(diff(x) == 1) more efficiently in C, but I don't 
see how you could hope to do any better than that without putting very 
un-R-like restrictions on your code.  Do you really want to say that

A[i:(i+k)]

is legal, but

x <- i:(i+k)
A[x]

is not?  That will be very confusing for your users.  The problem is 
that objects don't remember where they came from, only arguments to 
functions do, and functions that make use of this fact mainly do it for 
decorating the output (nice labels in plots) or making error messages 
more intelligible. 

Duncan Murdoch


From wdunlap at tibco.com  Wed May 12 20:53:47 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 12 May 2010 11:53:47 -0700
Subject: [Rd] ranges and contiguity checking
In-Reply-To: <4BEAF4CE.8000203@gmail.com>
References: <62125.66.201.56.150.1273688296.squirrel@www.stat.berkeley.edu>
	<4BEAF4CE.8000203@gmail.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70002E6721F@NA-PA-VBE03.na.tibco.com>

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
> Sent: Wednesday, May 12, 2010 11:35 AM
> To: bullard at stat.berkeley.edu
> Cc: r-devel at stat.math.ethz.ch
> Subject: Re: [Rd] ranges and contiguity checking
> 
> On 12/05/2010 2:18 PM, James Bullard wrote:
> > Hi All,
> >
> > I am interfacing to some C libraries (hdf5) and I have 
> methods defined for
> > '[', these methods do hyperslab selection, however, currently I am
> > limiting slab selection to contiguous blocks, i.e., things 
> defined like:
> > i:(i+k). I don't do any contiguity checking at this point, 
> I just grab the
> > max and min of the range and them potentially do an 
> in-memory subselection
> > which is what I am definitely trying to avoid. Besides 
> using deparse, I
> > can't see anyway to figure out that these things (i:(i+k) 
> and c(i, i+1,
> > ..., i+k)) are different.
> >
> > I have always liked how 1:10 was a valid expression in R 
> (as opposed to
> > python where it is not by itself.), however I'd somehow 
> like to know that
> > the thing was contiguous range without examining the un-evaluated
> > expression or worse, all(diff(i:(i+k)) == 1)

You could define a sequence class, say 'hfcSeq'
and insist that the indices given to [.hfc are
hfcSeq objects.  E.g., instead of
    hcf[i:(i+k)]
the user would use
    hcf[hfcSeq(i,i+k)]
or
    index <- hcfSeq(i,i+k)
    hcf[index]
max, min, and range methods for hcfSeq
would just inspect one or both of its
elements.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com  

> 
> You can implement all(diff(x) == 1) more efficiently in C, 
> but I don't 
> see how you could hope to do any better than that without 
> putting very 
> un-R-like restrictions on your code.  Do you really want to say that
> 
> A[i:(i+k)]
> 
> is legal, but
> 
> x <- i:(i+k)
> A[x]
> 
> is not?  That will be very confusing for your users.  The problem is 
> that objects don't remember where they came from, only arguments to 
> functions do, and functions that make use of this fact mainly 
> do it for 
> decorating the output (nice labels in plots) or making error messages 
> more intelligible. 
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From xiaoming.gu at gmail.com  Wed May 12 22:24:27 2010
From: xiaoming.gu at gmail.com (xiaoming gu)
Date: Wed, 12 May 2010 16:24:27 -0400
Subject: [Rd] How to profile R interpreter?
Message-ID: <AANLkTimLXEPeSfyK30n03ySFWJUSj9d2cPuxK0eqiCzW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100512/f9c91c3b/attachment.pl>

From bullard at stat.Berkeley.EDU  Wed May 12 22:27:40 2010
From: bullard at stat.Berkeley.EDU (James Bullard)
Date: Wed, 12 May 2010 13:27:40 -0700 (PDT)
Subject: [Rd] ranges and contiguity checking
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70002E6721F@NA-PA-VBE03.na.tibco.com>
References: <62125.66.201.56.150.1273688296.squirrel@www.stat.berkeley.edu>
	<4BEAF4CE.8000203@gmail.com>
	<77EB52C6DD32BA4D87471DCD70C8D70002E6721F@NA-PA-VBE03.na.tibco.com>
Message-ID: <34260.66.201.56.150.1273696060.squirrel@www.stat.berkeley.edu>

>> -----Original Message-----
>> From: r-devel-bounces at r-project.org
>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch
>> Sent: Wednesday, May 12, 2010 11:35 AM
>> To: bullard at stat.berkeley.edu
>> Cc: r-devel at stat.math.ethz.ch
>> Subject: Re: [Rd] ranges and contiguity checking
>>
>> On 12/05/2010 2:18 PM, James Bullard wrote:
>> > Hi All,
>> >
>> > I am interfacing to some C libraries (hdf5) and I have
>> methods defined for
>> > '[', these methods do hyperslab selection, however, currently I am
>> > limiting slab selection to contiguous blocks, i.e., things
>> defined like:
>> > i:(i+k). I don't do any contiguity checking at this point,
>> I just grab the
>> > max and min of the range and them potentially do an
>> in-memory subselection
>> > which is what I am definitely trying to avoid. Besides
>> using deparse, I
>> > can't see anyway to figure out that these things (i:(i+k)
>> and c(i, i+1,
>> > ..., i+k)) are different.
>> >
>> > I have always liked how 1:10 was a valid expression in R
>> (as opposed to
>> > python where it is not by itself.), however I'd somehow
>> like to know that
>> > the thing was contiguous range without examining the un-evaluated
>> > expression or worse, all(diff(i:(i+k)) == 1)
>
> You could define a sequence class, say 'hfcSeq'
> and insist that the indices given to [.hfc are
> hfcSeq objects.  E.g., instead of
>     hcf[i:(i+k)]
> the user would use
>     hcf[hfcSeq(i,i+k)]
> or
>     index <- hcfSeq(i,i+k)
>     hcf[index]
> max, min, and range methods for hcfSeq
> would just inspect one or both of its
> elements.

I could do this, but I wanted it to not matter to the user whether or not
they were dealing with a HDF5Dataset or a plain-old matrix.

It seems like I cannot define methods on: ':'. If I could do that then I
could implement an immutable 'range' class which would be good, but then
I'd have to also implement: '['(matrix, range) -- which would be easy, but
still more work than I wanted to do.

I guess I was thinking that there is some inherent value in an immutable
native range type which is constant in time and memory for construction.
Then I could define methods on '['(matrix, range) and '['(matrix,
integer). I'm pretty confident this is more less what is happening in the
IRanges package in Bioconductor, but (maybe for the lack of support for
setting methods on ':') it is happening in a way that makes things very
non-transparent to a user. As it stands, I can optimize for performance by
using a IRange-type wrapper or I can optimize for code-clarity by killing
performance.

thanks again, jim





>
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com
>
>>
>> You can implement all(diff(x) == 1) more efficiently in C,
>> but I don't
>> see how you could hope to do any better than that without
>> putting very
>> un-R-like restrictions on your code.  Do you really want to say that
>>
>> A[i:(i+k)]
>>
>> is legal, but
>>
>> x <- i:(i+k)
>> A[x]
>>
>> is not?  That will be very confusing for your users.  The problem is
>> that objects don't remember where they came from, only arguments to
>> functions do, and functions that make use of this fact mainly
>> do it for
>> decorating the output (nice labels in plots) or making error messages
>> more intelligible.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From jeff.a.ryan at gmail.com  Wed May 12 22:53:05 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 12 May 2010 15:53:05 -0500
Subject: [Rd] ranges and contiguity checking
In-Reply-To: <34260.66.201.56.150.1273696060.squirrel@www.stat.berkeley.edu>
References: <62125.66.201.56.150.1273688296.squirrel@www.stat.berkeley.edu>
	<4BEAF4CE.8000203@gmail.com>
	<77EB52C6DD32BA4D87471DCD70C8D70002E6721F@NA-PA-VBE03.na.tibco.com>
	<34260.66.201.56.150.1273696060.squirrel@www.stat.berkeley.edu>
Message-ID: <AANLkTikIsP8pDskqwOXnwqQMuMogfcHrgPOXvTmo4prk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100512/4d62d484/attachment.pl>

From chuckwhite8 at charter.net  Wed May 12 23:17:17 2010
From: chuckwhite8 at charter.net (Chuck White)
Date: Wed, 12 May 2010 17:17:17 -0400
Subject: [Rd] R 2.11.0 on RHEL5 / RODBC
Message-ID: <20100512171717.H6OK1.3722893.root@mp13>

I am compiling R 2.11.0 on a RHEL5.3 box using the following settings

./configure --with-readline=yes --enable-R-shlib=yes --with-x=yes --with-blas="-llibptf77blas -lpthread -llibatlas" --prefix=/usr/local/R-2.11.0 JAVA_HOME=$JAVA_HOME CPPFLAGS="-I/usr/local/unixODBC-2.3.0/include"

I have compiled and installed unixODBC-2.3.0 (64-bit) in /usr/local and can connect to and query the database using isql.  When I try to build RODBC, I get the following error:

checking for sqlext.h... yes
checking for library containing SQLTables... no
configure: error: "no ODBC driver manager found"
ERROR: configuration failed for package ?RODBC?
* removing ?/usr/local/R-2.11.0/lib64/R/library/RODBC?

The directory /usr/local/unixODBC-2.3.0/lib has the files libodbc.so and libodbc.la, and LD_LIBRARY_PATH has /usr/local/lib64:/usr/lib64:/usr/local/unixODBC-2.3.0/lib.  Also, there is no other unixODBC version on the box. I would appreciate any help in this regard.  Thanks.


From ripley at stats.ox.ac.uk  Thu May 13 08:23:37 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 13 May 2010 07:23:37 +0100 (BST)
Subject: [Rd] R 2.11.0 on RHEL5 / RODBC
In-Reply-To: <20100512171717.H6OK1.3722893.root@mp13>
References: <20100512171717.H6OK1.3722893.root@mp13>
Message-ID: <alpine.LFD.2.00.1005130707110.20113@gannet.stats.ox.ac.uk>

On Wed, 12 May 2010, Chuck White wrote:

> I am compiling R 2.11.0 on a RHEL5.3 box using the following settings
>
> ./configure --with-readline=yes --enable-R-shlib=yes --with-x=yes --with-blas="-llibptf77blas -lpthread -llibatlas" --prefix=/usr/local/R-2.11.0 JAVA_HOME=$JAVA_HOME CPPFLAGS="-I/usr/local/unixODBC-2.3.0/include"
>
> I have compiled and installed unixODBC-2.3.0 (64-bit) in /usr/local 
> and can connect to and query the database using isql.  When I try to 
> build RODBC, I get the following error:
>
> checking for sqlext.h... yes
> checking for library containing SQLTables... no
> configure: error: "no ODBC driver manager found"
> ERROR: configuration failed for package ?RODBC?
> * removing ?/usr/local/R-2.11.0/lib64/R/library/RODBC?
>
> The directory /usr/local/unixODBC-2.3.0/lib has the files libodbc.so 
> and libodbc.la, and LD_LIBRARY_PATH has 
> /usr/local/lib64:/usr/lib64:/usr/local/unixODBC-2.3.0/lib.  Also, 
> there is no other unixODBC version on the box. I would appreciate 
> any help in this regard.  Thanks.

This is completely standard configure stuff: use

.../RODBC/configure --help

to seee the options for telling a package where the dependent 
libraries are.  It is even the reference example in 'Writing R 
Extensions'!

Does RHEL5 really not have a unixODBC (and uniODBC-devel) RPM?  They 
do make like easier for people who are out of their depth with 
software installation.

-- 

Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hb at stat.berkeley.edu  Thu May 13 09:29:11 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 13 May 2010 09:29:11 +0200
Subject: [Rd] R for Windows FAQ: Minor comment on "32- and 64-bit"
	installation paths
Message-ID: <AANLkTilXy771OtAbOa64pGCXbOm-zscFMdfv-ywZuNYN@mail.gmail.com>

In 'R for Windows FAQ' for R version 2.11.0 Patched (2010-05-11
r51982) you can read:

[2.29] Can both 32- and 64-bit R be installed on the same machine?

Obviously, only relevant if the machine is running a 64-bit version of Windows.

Yes, with a little care. For R 2.11.x they should be installed into
different directories: the installer will suggest that the 64-bit
build is installed into, say, R-2.11.0-x64 and Administrator installs
will default to different paths (e.g. C:\Program Files (x86)\R for
32-bit, C:\Program Files\R for 64-bit). The Start Menu, desktop and
quick launch icons will be named differently, and the versions can be
uninstalled independently.

Aren't those paths vice versa?

32-bit: C:\Program Files\R
64-bit: C:\Program Files (x86)\R

(I've noticed that this paragraph is not in R v2.12.0 dev).

/Henrik


From murdoch at stats.uwo.ca  Thu May 13 16:19:50 2010
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 13 May 2010 10:19:50 -0400
Subject: [Rd] Using Sweave in hostile environments
Message-ID: <4BEC0A86.4030906@stats.uwo.ca>

I'm trying to put together a poster using the LaTeX a0poster package and 
including some things from pstricks to get gradient shading, etc.

The problem is that the default environments used by Sweave don't work 
where I need them.  A simple code chunk like

<<eval=FALSE>>=
x <- 1
@

buried in a minipage within a psshadowbox gives the error

Runaway argument?
 > x <- 1 \end {Sinput} \end {Schunk} and the resulting variable would\ETC.
D:/test.tex:302: Paragraph ended before \FV@
BeginScanning was complete


Has anyone solved this problem?  One way I see that might work is to put 
the code chunk outside the environment and use SaveVerbatim to save it, 
then just put \BUseVerbatim or \LUseVerbatim in place where I need it.  
But because I'm using Sweave, I somehow need to redefine the Sinput, 
Soutput and maybe the Schunk environments to do that, and I don't see 
how to do so. 

Duncan Murdoch


From ligges at statistik.tu-dortmund.de  Thu May 13 16:21:30 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 13 May 2010 16:21:30 +0200
Subject: [Rd] R for Windows FAQ: Minor comment on "32- and
 64-bit"	installation paths
In-Reply-To: <AANLkTilXy771OtAbOa64pGCXbOm-zscFMdfv-ywZuNYN@mail.gmail.com>
References: <AANLkTilXy771OtAbOa64pGCXbOm-zscFMdfv-ywZuNYN@mail.gmail.com>
Message-ID: <4BEC0AEA.4090803@statistik.tu-dortmund.de>



On 13.05.2010 09:29, Henrik Bengtsson wrote:
> In 'R for Windows FAQ' for R version 2.11.0 Patched (2010-05-11
> r51982) you can read:
>
> [2.29] Can both 32- and 64-bit R be installed on the same machine?
>
> Obviously, only relevant if the machine is running a 64-bit version of Windows.
>
> Yes, with a little care. For R 2.11.x they should be installed into
> different directories: the installer will suggest that the 64-bit
> build is installed into, say, R-2.11.0-x64 and Administrator installs
> will default to different paths (e.g. C:\Program Files (x86)\R for
> 32-bit, C:\Program Files\R for 64-bit). The Start Menu, desktop and
> quick launch icons will be named differently, and the versions can be
> uninstalled independently.
>
> Aren't those paths vice versa?
>
> 32-bit: C:\Program Files\R
> 64-bit: C:\Program Files (x86)\R

No: This is MS decision and it is consequent: Under 64-bit Windows, the 
default is to use 64-bit Applications (hence in "Program Files") and 
32-bit applications go into "Program Files (x86)". x86 for the old 
32-bit x86 architecture.


>
> (I've noticed that this paragraph is not in R v2.12.0 dev).


Right, since it is planned to release R-2.12.0 as a bi-arch 
distribution, i.e. just one installer that contains both 32-bit and 
64-bit binaries and will (if you select to install both) install the 
binaries in subdirectories of bin/ lib/ etc.

But this is still heavily under development and the CRAN checks are not 
yet complete.

Uwe Ligges



> /Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From thmsfuller066 at gmail.com  Thu May 13 19:16:28 2010
From: thmsfuller066 at gmail.com (thmsfuller066 at gmail.com)
Date: Thu, 13 May 2010 12:16:28 -0500
Subject: [Rd] What functions are called internally in R to resolve what
	variable is referred?
Message-ID: <AANLkTimZ57TV_geRPsAGB9CEBq6iv2V91EmFPMU1awQ0@mail.gmail.com>

Hello All,

If I refer to a variable 'x', 'x' will be searched in the current
frame or the parent frame, or the parent of the parent frame, etc.,
until it is found (or not found at all)? Could you please show me what
code in R source that handles this? Is it in the C code or the R code?

Thanks,
Tom


From simon.urbanek at r-project.org  Thu May 13 20:22:58 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 13 May 2010 14:22:58 -0400
Subject: [Rd] What functions are called internally in R to resolve what
	variable is referred?
In-Reply-To: <AANLkTimZ57TV_geRPsAGB9CEBq6iv2V91EmFPMU1awQ0@mail.gmail.com>
References: <AANLkTimZ57TV_geRPsAGB9CEBq6iv2V91EmFPMU1awQ0@mail.gmail.com>
Message-ID: <CBCB3488-A73E-4D15-B69B-A1E5C54A2AE3@r-project.org>


On May 13, 2010, at 1:16 PM, thmsfuller066 at gmail.com wrote:

> Hello All,
> 
> If I refer to a variable 'x', 'x' will be searched in the current
> frame or the parent frame, or the parent of the parent frame, etc.,
> until it is found (or not found at all)? Could you please show me what
> code in R source that handles this? Is it in the C code or the R code?
> 

At R level it is done automatically during evaluation (but you can so something similar using get() function in R). Internally (in C), findVar(symbol, env) in src/main/envir.c does the job by using findVarInFrame3() recursively for parent environments. There is slight exception if you use x()   since that does a search with the restriction that x must be a function and thus uses findFun() instead.

Cheers,
Simon


From spluque at gmail.com  Thu May 13 20:37:12 2010
From: spluque at gmail.com (Sebastian P. Luque)
Date: Thu, 13 May 2010 13:37:12 -0500
Subject: [Rd] cdplot() with 'POSIXct' x
Message-ID: <8739xv642v.fsf@kolob.sebmags.homelinux.org>

Hi,

Given that cdplot() is used to produce the conditional density of a
categorical y along a numerical x, it seems natural that it could be
used with a date or time x (such as 'POSIXct').  Is this desirable?  If
so, I've created a patch that would allow this, by coercing the POSIXct
x variable to produce the density, but use the original POSIXct x to
draw the x axis.


Index: src/library/graphics/R/cdplot.R
===================================================================
--- src/library/graphics/R/cdplot.R	(revision 51984)
+++ src/library/graphics/R/cdplot.R	(working copy)
@@ -43,8 +43,8 @@
     if(!is.null(ylevels))
       y <- factor(y, levels = if(is.numeric(ylevels)) levels(y)[ylevels] else ylevels)
     x <- mf[,2]
-    if(!is.numeric(x))
-        stop("explanatory variable should be numeric")
+    if (!(is.numeric(x) || is(x, "POSIXct")))
+        stop("explanatory variable should be numeric or POSIXct")
 
     ## graphical parameters
     if(is.null(xlab)) xlab <- names(mf)[2L]
@@ -66,7 +66,8 @@
          yaxlabels = NULL, xlim = NULL, ylim = c(0, 1), ...)
 {
     ## check x and y
-    if(!is.numeric(x)) stop("explanatory variable should be numeric")
+    if (!(is.numeric(x) || is(x, "POSIXct")))
+        stop("explanatory variable should be numeric or POSIXct")
     if(!is.factor(y)) stop("dependent variable should be a factor")
     if(!is.null(ylevels))
       y <- factor(y, levels = if(is.numeric(ylevels)) levels(y)[ylevels] else ylevels)
@@ -79,10 +80,12 @@
     if(is.null(yaxlabels)) yaxlabels <- levels(y)
 
     ## unconditional density of x
-    dx <- if(is.null(from) & is.null(to))
-        stats::density(x, bw = bw, n = n, ...)
-    else
-        stats::density(x, bw = bw, from = from, to = to, n = n, ...)
+    xnum <- as.numeric(x)
+    dx <- if (is.null(from) & is.null(to)) {
+        stats::density(xnum, bw = bw, n = n, ...)
+    } else {
+        stats::density(xnum, bw = bw, from = from, to = to, n = n, ...)
+    }
     x1 <- dx$x
 
     ## setup conditional values
@@ -94,7 +97,7 @@
     rval <- list()
 
     for(i in seq_len(ny-1L)) {
-        dxi <- stats::density(x[y %in% levels(y)[seq_len(i)]], bw = dx$bw, n = n,
+        dxi <- stats::density(xnum[y %in% levels(y)[seq_len(i)]], bw = dx$bw, n = n,
                               from = min(dx$x), to = max(dx$x), ...)
         y1[i,] <- dxi$y/dx$y * yprop[i]
         rval[[i]] <- stats::approxfun(x1, y1[i,], rule = 2)
@@ -103,8 +106,8 @@
 
     ## use known ranges
     y1 <- rbind(0, y1, 1)
-    y1 <- y1[,which(x1 >= min(x) & x1 <= max(x))]
-    x1 <- x1[x1 >= min(x) & x1 <= max(x)]
+    y1 <- y1[,which(x1 >= min(xnum) & x1 <= max(xnum))]
+    x1 <- x1[x1 >= min(xnum) & x1 <= max(xnum)]
 
     if(is.null(xlim)) xlim <- range(x1)
     if(any(ylim < 0) || any(ylim > 1)) {
@@ -120,7 +123,9 @@
         for(i in seq_len(NROW(y1)-1))
             polygon(c(x1, rev(x1)), c(y1[i+1,], rev(y1[i,])), col = col[i],
                     border = border)
-        axis(1)
+        if (is(x, "POSIXct")) {
+            axis.POSIXct(1, x)
+        } else axis(1)
 
         equidist <- any(diff(y1[,1L]) < tol.ylab)
         if(equidist)


-- 
Seb


From wdunlap at tibco.com  Thu May 13 20:55:01 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 13 May 2010 11:55:01 -0700
Subject: [Rd] What functions are called internally in R to resolve
	whatvariable is referred?
In-Reply-To: <AANLkTimZ57TV_geRPsAGB9CEBq6iv2V91EmFPMU1awQ0@mail.gmail.com>
References: <AANLkTimZ57TV_geRPsAGB9CEBq6iv2V91EmFPMU1awQ0@mail.gmail.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70002F1E307@NA-PA-VBE03.na.tibco.com>


> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of 
> thmsfuller066 at gmail.com
> Sent: Thursday, May 13, 2010 10:16 AM
> To: r-devel at r-project.org
> Subject: [Rd] What functions are called internally in R to 
> resolve whatvariable is referred?
> 
> Hello All,
> 
> If I refer to a variable 'x', 'x' will be searched in the current
> frame or the parent frame, or the parent of the parent frame, etc.,
> until it is found (or not found at all)?

Be careful with your terms here.  While a function
is evaluating its 'parent frame' is the environment
of the function that called it and its 'parent environment'
is the environment in which it was defined.  R searches
though the chain of parent environments, not parent frames.

The following example shows the difference between the
parent environment and the parent frame.

  # setup
  x <- "Global x"
  f1 <- function() {
      c(x=x,
        xFromParentFrame=get("x", envir=parent.frame()),
        xFromParentEnv=get("x", envir=parent.env(environment())))
  }

  f0 <- function(i) {
     x<-paste("f0's x: i=", i, sep="")
     # Note how subf0 and f1 have identical definitions:
     # they only differ in where they were created.
     subf0 <- function ()
     {
        c(x = x,
          xFromParentFrame = get("x", envir = parent.frame()),
          xFromParentEnv = get("x", envir = parent.env(environment())))
     }
     list(subf0=subf0(), f1=f1(), FUN=subf0)
  }

  > # run the functions
  > z <- f0(17)
  > z
  $subf0
                 x xFromParentFrame   xFromParentEnv
    "f0's x: i=17"   "f0's x: i=17"   "f0's x: i=17"

  $f1
                 x xFromParentFrame   xFromParentEnv
        "Global x"   "f0's x: i=17"       "Global x"

  $FUN
  function ()
  {
      c(x = x, xFromParentFrame = get("x", envir = parent.frame()),
          xFromParentEnv = get("x", envir = parent.env(environment())))
  }
  <environment: 0x292af70>

  > z$FUN()
                 x xFromParentFrame   xFromParentEnv
    "f0's x: i=17"       "Global x"   "f0's x: i=17"

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 

> Could you please show me what
> code in R source that handles this? Is it in the C code or the R code?
>
> Thanks,
> Tom


From Achim.Zeileis at uibk.ac.at  Thu May 13 22:18:26 2010
From: Achim.Zeileis at uibk.ac.at (Achim Zeileis)
Date: Thu, 13 May 2010 22:18:26 +0200 (CEST)
Subject: [Rd] cdplot() with 'POSIXct' x
In-Reply-To: <8739xv642v.fsf@kolob.sebmags.homelinux.org>
References: <8739xv642v.fsf@kolob.sebmags.homelinux.org>
Message-ID: <alpine.DEB.2.00.1005132208160.4063@paninaro.uibk.ac.at>

On Thu, 13 May 2010, Sebastian P. Luque wrote:

> Hi,
>
> Given that cdplot() is used to produce the conditional density of a
> categorical y along a numerical x, it seems natural that it could be
> used with a date or time x (such as 'POSIXct').  Is this desirable?  If
> so, I've created a patch that would allow this, by coercing the POSIXct
> x variable to produce the density, but use the original POSIXct x to
> draw the x axis.

I don't think we should special case "POSIXct". The general question would 
be whether we allow "x" variables that can be coerced to numeric. The 
approach would be:
   - Omit all checking of the original "x".
   - Compute
       xorig <- x
       x <- as.numeric(xorig)
     and then proceed as before except for one change.
   - For drawing the axis use
       Axis(xorig, side = 1)
     rather than axis(1).

This would work for POSIXct, Date, and other classes of the same type, 
e.g., yearmon in package "zoo". Also, we could easily write time series 
methods for cdplot() and spineplot() in package "zoo".

The downside is that there is no more checking of the "x" argument and 
weird things could happen without a useful error message when users 
specify awkward x arguments.

I played around with modified versions of cdplot() and also spineplot() 
(where the new labeling is a bit more involved but based on the same 
principles) and could supply code/docs for both.

So the question is whether the more flexible code with reduced checking is 
suitable/acceptable for base R or not.

Best,
Z

>
> Index: src/library/graphics/R/cdplot.R
> ===================================================================
> --- src/library/graphics/R/cdplot.R	(revision 51984)
> +++ src/library/graphics/R/cdplot.R	(working copy)
> @@ -43,8 +43,8 @@
>     if(!is.null(ylevels))
>       y <- factor(y, levels = if(is.numeric(ylevels)) levels(y)[ylevels] else ylevels)
>     x <- mf[,2]
> -    if(!is.numeric(x))
> -        stop("explanatory variable should be numeric")
> +    if (!(is.numeric(x) || is(x, "POSIXct")))
> +        stop("explanatory variable should be numeric or POSIXct")
>
>     ## graphical parameters
>     if(is.null(xlab)) xlab <- names(mf)[2L]
> @@ -66,7 +66,8 @@
>          yaxlabels = NULL, xlim = NULL, ylim = c(0, 1), ...)
> {
>     ## check x and y
> -    if(!is.numeric(x)) stop("explanatory variable should be numeric")
> +    if (!(is.numeric(x) || is(x, "POSIXct")))
> +        stop("explanatory variable should be numeric or POSIXct")
>     if(!is.factor(y)) stop("dependent variable should be a factor")
>     if(!is.null(ylevels))
>       y <- factor(y, levels = if(is.numeric(ylevels)) levels(y)[ylevels] else ylevels)
> @@ -79,10 +80,12 @@
>     if(is.null(yaxlabels)) yaxlabels <- levels(y)
>
>     ## unconditional density of x
> -    dx <- if(is.null(from) & is.null(to))
> -        stats::density(x, bw = bw, n = n, ...)
> -    else
> -        stats::density(x, bw = bw, from = from, to = to, n = n, ...)
> +    xnum <- as.numeric(x)
> +    dx <- if (is.null(from) & is.null(to)) {
> +        stats::density(xnum, bw = bw, n = n, ...)
> +    } else {
> +        stats::density(xnum, bw = bw, from = from, to = to, n = n, ...)
> +    }
>     x1 <- dx$x
>
>     ## setup conditional values
> @@ -94,7 +97,7 @@
>     rval <- list()
>
>     for(i in seq_len(ny-1L)) {
> -        dxi <- stats::density(x[y %in% levels(y)[seq_len(i)]], bw = dx$bw, n = n,
> +        dxi <- stats::density(xnum[y %in% levels(y)[seq_len(i)]], bw = dx$bw, n = n,
>                               from = min(dx$x), to = max(dx$x), ...)
>         y1[i,] <- dxi$y/dx$y * yprop[i]
>         rval[[i]] <- stats::approxfun(x1, y1[i,], rule = 2)
> @@ -103,8 +106,8 @@
>
>     ## use known ranges
>     y1 <- rbind(0, y1, 1)
> -    y1 <- y1[,which(x1 >= min(x) & x1 <= max(x))]
> -    x1 <- x1[x1 >= min(x) & x1 <= max(x)]
> +    y1 <- y1[,which(x1 >= min(xnum) & x1 <= max(xnum))]
> +    x1 <- x1[x1 >= min(xnum) & x1 <= max(xnum)]
>
>     if(is.null(xlim)) xlim <- range(x1)
>     if(any(ylim < 0) || any(ylim > 1)) {
> @@ -120,7 +123,9 @@
>         for(i in seq_len(NROW(y1)-1))
>             polygon(c(x1, rev(x1)), c(y1[i+1,], rev(y1[i,])), col = col[i],
>                     border = border)
> -        axis(1)
> +        if (is(x, "POSIXct")) {
> +            axis.POSIXct(1, x)
> +        } else axis(1)
>
>         equidist <- any(diff(y1[,1L]) < tol.ylab)
>         if(equidist)
>
>
> -- 
> Seb
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From efreeman at berkeley.edu  Thu May 13 22:04:50 2010
From: efreeman at berkeley.edu (efreeman at berkeley.edu)
Date: Thu, 13 May 2010 13:04:50 -0700
Subject: [Rd] results of pnorm as either NaN or Inf
Message-ID: <c53bc16d255966cc62b8b7d085027628@berkeley.edu>

I stumbled across this and I am wondering if this is unexpected behavior
or if I am missing something.

> pnorm(-1.0e+307, log.p=TRUE)
[1] -Inf
> pnorm(-1.0e+308, log.p=TRUE)
[1] NaN
Warning message:
In pnorm(q, mean, sd, lower.tail, log.p) : NaNs produced
> pnorm(-1.0e+309, log.p=TRUE)
[1] -Inf

I don't know C and am not that skilled with R, so it would be hard for me
to look into the code for pnorm. If I'm not just missing something, I
thought it may be of interest.

Details:
I am using Mac OS X 10.5.8. I installed a precompiled binary version. Here
is the output from sessionInfo(), requested in the posting guide:
R version 2.11.0 (2010-04-22) 
i386-apple-darwin9.8.0 

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_2.11.0

Thank you very much,

Eric Freeman
UC Berkeley


From Ted.Harding at manchester.ac.uk  Fri May 14 01:01:31 2010
From: Ted.Harding at manchester.ac.uk ( (Ted Harding))
Date: Fri, 14 May 2010 00:01:31 +0100 (BST)
Subject: [Rd] results of pnorm as either NaN or Inf
In-Reply-To: <c53bc16d255966cc62b8b7d085027628@berkeley.edu>
Message-ID: <XFMail.100514000131.Ted.Harding@manchester.ac.uk>

On 13-May-10 20:04:50, efreeman at berkeley.edu wrote:
> I stumbled across this and I am wondering if this is unexpected
> behavior or if I am missing something.
> 
>> pnorm(-1.0e+307, log.p=TRUE)
> [1] -Inf
>> pnorm(-1.0e+308, log.p=TRUE)
> [1] NaN
> Warning message:
> In pnorm(q, mean, sd, lower.tail, log.p) : NaNs produced
>> pnorm(-1.0e+309, log.p=TRUE)
> [1] -Inf
> 
> I don't know C and am not that skilled with R, so it would be hard
> for me to look into the code for pnorm. If I'm not just missing
> something, I thought it may be of interest.
> 
> Details:
> I am using Mac OS X 10.5.8. I installed a precompiled binary version.
> Here is the output from sessionInfo(), requested in the posting guide:
> R version 2.11.0 (2010-04-22) 
> i386-apple-darwin9.8.0 
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base   
> 
> loaded via a namespace (and not attached):
> [1] tools_2.11.0
> 
> Thank you very much,
> 
> Eric Freeman
> UC Berkeley

This is probably platform-independent. I get the same results with
R on Linux. More to the point:

You are clearly "pushing the envelope" here. First, have a look
at what R makes of your inputs to pnorm():

  -1.0e+307
  # [1] -1e+307
  -1.0e+308
  # [1] -1e+308
  -1.0e+309
  # [1] -Inf


So, somewhere beteen -1e+308 and -1.0e+309. the envelope burst!
Given -1.0e+309, R returns -Inf (i.e. R can no longer represent
this internally as a finite number).

Now look at

  pnorm(-Inf,log.p=TRUE)
  # [1] -Inf

So, R knows how to give the correct answer (an exact 0, or -Inf
on the log scale) if you feed pnorm() with -Inf. So you're OK
with -1e+N where N >= 309.

For smaller powers, e.g. -1e+(200:306), these give pnorm() much
less than -1.0e+309, and presumably R's algorithm (which I haven't
studied either ... ) returns 0 for pnorm(), as it should to the
available internal accuracy.

So, up to pnorm(-1.0e+307, log.p=TRUE) = -Inf. All is as it should be.
However, at -1e+308, "the envelope is about to burst", and something
may occur within the algorithm which results in a NaN.

So there is nothing anomalous about your results except at -1e+308,
which is where R is at a critical point.

That's how I see it, anway!
Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding at manchester.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 14-May-10                                       Time: 00:01:27
------------------------------ XFMail ------------------------------


From lubrs at comcast.net  Fri May 14 04:47:52 2010
From: lubrs at comcast.net (Dave Lubbers)
Date: Thu, 13 May 2010 19:47:52 -0700 (PDT)
Subject: [Rd] where is libRmath.a & libRmath.so
Message-ID: <1273805272551-2216048.post@n4.nabble.com>


I see Rmath.h in include.  Why can't I find libRmath.a and/or libRmath.so?  
-- 
View this message in context: http://r.789695.n4.nabble.com/where-is-libRmath-a-libRmath-so-tp2216048p2216048.html
Sent from the R devel mailing list archive at Nabble.com.


From dutangc at gmail.com  Fri May 14 08:30:34 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Fri, 14 May 2010 08:30:34 +0200
Subject: [Rd] discrete-time survival model
Message-ID: <361707CE-79C4-49F2-BD94-469E5C252B7A@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100514/58016624/attachment.pl>

From ligges at statistik.tu-dortmund.de  Fri May 14 09:51:42 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 14 May 2010 09:51:42 +0200
Subject: [Rd] where is libRmath.a & libRmath.so
In-Reply-To: <1273805272551-2216048.post@n4.nabble.com>
References: <1273805272551-2216048.post@n4.nabble.com>
Message-ID: <4BED010E.1060809@statistik.tu-dortmund.de>



On 14.05.2010 04:47, Dave Lubbers wrote:
>
> I see Rmath.h in include.  Why can't I find libRmath.a and/or libRmath.so?


Since you have not compiled them yet? See the R Installation and 
Administration manual.

Uwe Ligges


From arne.henningsen at googlemail.com  Fri May 14 10:09:53 2010
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Fri, 14 May 2010 10:09:53 +0200
Subject: [Rd] Creating an S3 method when the generic function is defined in
	another (imported) package
Message-ID: <AANLkTikaiAvhirbxKVlUrPvBxxaQLGKvMd1KCE0WW9xE@mail.gmail.com>

Hi,

In one of my packages (maxLik), I would like to add an S3 method,
where the generic function (estfun) is defined in another package
(sandwich). Everything works fine if my package "Depends" on the other
package and I import the generic function "estfun" from the "sandwich"
package and define the new method in the NAMESPACE file. However, I
prefer not to load the entire other package just to use a single
generic function from it. Therefore, I replaced "Depends" by "Imports"
in the DESCRIPTION file and (re-)exported "estfun" in the NAMESPACE
file. Now "R CMD check" warns about the undocumented code object
"estfun" but I do not want to include a duplicate of the documentation
of "estfun". Do you know a better solution?

Thanks a lot,
Arne

-- 
Arne Henningsen
http://www.arne-henningsen.name


From Achim.Zeileis at uibk.ac.at  Fri May 14 10:37:54 2010
From: Achim.Zeileis at uibk.ac.at (Achim Zeileis)
Date: Fri, 14 May 2010 10:37:54 +0200 (CEST)
Subject: [Rd] Creating an S3 method when the generic function is defined
 in another (imported) package
In-Reply-To: <AANLkTikaiAvhirbxKVlUrPvBxxaQLGKvMd1KCE0WW9xE@mail.gmail.com>
References: <AANLkTikaiAvhirbxKVlUrPvBxxaQLGKvMd1KCE0WW9xE@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1005141030580.5458@paninaro.uibk.ac.at>

On Fri, 14 May 2010, Arne Henningsen wrote:

> Hi,
>
> In one of my packages (maxLik), I would like to add an S3 method,
> where the generic function (estfun) is defined in another package
> (sandwich). Everything works fine if my package "Depends" on the other
> package and I import the generic function "estfun" from the "sandwich"
> package and define the new method in the NAMESPACE file. However, I
> prefer not to load the entire other package just to use a single
> generic function from it. Therefore, I replaced "Depends" by "Imports"
> in the DESCRIPTION file and (re-)exported "estfun" in the NAMESPACE
> file. Now "R CMD check" warns about the undocumented code object
> "estfun" but I do not want to include a duplicate of the documentation
> of "estfun". Do you know a better solution?

I probably wouldn't re-export the estfun() generic. People will probably 
load "sandwich" anyway before calling estfun(), in particular if they want 
to compute the sandwich() covariance matrix.

hth,
Z

> Thanks a lot,
> Arne
>
> -- 
> Arne Henningsen
> http://www.arne-henningsen.name
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From arne.henningsen at googlemail.com  Fri May 14 10:43:50 2010
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Fri, 14 May 2010 10:43:50 +0200
Subject: [Rd] Creating an S3 method when the generic function is defined
	in another (imported) package
In-Reply-To: <alpine.DEB.2.00.1005141030580.5458@paninaro.uibk.ac.at>
References: <AANLkTikaiAvhirbxKVlUrPvBxxaQLGKvMd1KCE0WW9xE@mail.gmail.com>
	<alpine.DEB.2.00.1005141030580.5458@paninaro.uibk.ac.at>
Message-ID: <AANLkTilHBoglmh_XrpN4nAAcGDzg6rwBpOHQaijEEkpO@mail.gmail.com>

On 14 May 2010 10:37, Achim Zeileis <Achim.Zeileis at uibk.ac.at> wrote:
> On Fri, 14 May 2010, Arne Henningsen wrote:
>
>> Hi,
>>
>> In one of my packages (maxLik), I would like to add an S3 method,
>> where the generic function (estfun) is defined in another package
>> (sandwich). Everything works fine if my package "Depends" on the other
>> package and I import the generic function "estfun" from the "sandwich"
>> package and define the new method in the NAMESPACE file. However, I
>> prefer not to load the entire other package just to use a single
>> generic function from it. Therefore, I replaced "Depends" by "Imports"
>> in the DESCRIPTION file and (re-)exported "estfun" in the NAMESPACE
>> file. Now "R CMD check" warns about the undocumented code object
>> "estfun" but I do not want to include a duplicate of the documentation
>> of "estfun". Do you know a better solution?
>
> I probably wouldn't re-export the estfun() generic. People will probably
> load "sandwich" anyway before calling estfun(), in particular if they want
> to compute the sandwich() covariance matrix.

Good point!

Thanks a lot,
Arne

-- 
Arne Henningsen
http://www.arne-henningsen.name


From ripley at stats.ox.ac.uk  Fri May 14 12:50:09 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 14 May 2010 11:50:09 +0100 (BST)
Subject: [Rd] results of pnorm as either NaN or Inf
In-Reply-To: <XFMail.100514000131.Ted.Harding@manchester.ac.uk>
References: <XFMail.100514000131.Ted.Harding@manchester.ac.uk>
Message-ID: <alpine.LFD.2.00.1005141140040.26606@gannet.stats.ox.ac.uk>

The answer to pnorm(-x, log.p=TRUE) is of course about -0.5*x*x for 
large x.  So trying to compute it for -1e108 is a bit silly, both on 
your part and the C code used.  I've altered the C code not to attempt 
it for x > 1e170, which excludes the area where underflow occurs.

On Fri, 14 May 2010, Ted.Harding at manchester.ac.uk wrote:

> On 13-May-10 20:04:50, efreeman at berkeley.edu wrote:
>> I stumbled across this and I am wondering if this is unexpected
>> behavior or if I am missing something.
>>
>>> pnorm(-1.0e+307, log.p=TRUE)
>> [1] -Inf
>>> pnorm(-1.0e+308, log.p=TRUE)
>> [1] NaN
>> Warning message:
>> In pnorm(q, mean, sd, lower.tail, log.p) : NaNs produced
>>> pnorm(-1.0e+309, log.p=TRUE)
>> [1] -Inf
>>
>> I don't know C and am not that skilled with R, so it would be hard
>> for me to look into the code for pnorm. If I'm not just missing
>> something, I thought it may be of interest.
>>
>> Details:
>> I am using Mac OS X 10.5.8. I installed a precompiled binary version.
>> Here is the output from sessionInfo(), requested in the posting guide:
>> R version 2.11.0 (2010-04-22)
>> i386-apple-darwin9.8.0
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> loaded via a namespace (and not attached):
>> [1] tools_2.11.0
>>
>> Thank you very much,
>>
>> Eric Freeman
>> UC Berkeley
>
> This is probably platform-independent. I get the same results with
> R on Linux. More to the point:
>
> You are clearly "pushing the envelope" here. First, have a look
> at what R makes of your inputs to pnorm():
>
>  -1.0e+307
>  # [1] -1e+307
>  -1.0e+308
>  # [1] -1e+308
>  -1.0e+309
>  # [1] -Inf
>
>
> So, somewhere beteen -1e+308 and -1.0e+309. the envelope burst!
> Given -1.0e+309, R returns -Inf (i.e. R can no longer represent
> this internally as a finite number).
>
> Now look at
>
>  pnorm(-Inf,log.p=TRUE)
>  # [1] -Inf
>
> So, R knows how to give the correct answer (an exact 0, or -Inf
> on the log scale) if you feed pnorm() with -Inf. So you're OK
> with -1e+N where N >= 309.
>
> For smaller powers, e.g. -1e+(200:306), these give pnorm() much
> less than -1.0e+309, and presumably R's algorithm (which I haven't
> studied either ... ) returns 0 for pnorm(), as it should to the
> available internal accuracy.
>
> So, up to pnorm(-1.0e+307, log.p=TRUE) = -Inf. All is as it should be.
> However, at -1e+308, "the envelope is about to burst", and something
> may occur within the algorithm which results in a NaN.
>
> So there is nothing anomalous about your results except at -1e+308,
> which is where R is at a critical point.
>
> That's how I see it, anway!
> Ted.
>
> --------------------------------------------------------------------
> E-Mail: (Ted Harding) <Ted.Harding at manchester.ac.uk>
> Fax-to-email: +44 (0)870 094 0861
> Date: 14-May-10                                       Time: 00:01:27
> ------------------------------ XFMail ------------------------------
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Fri May 14 12:53:27 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 14 May 2010 06:53:27 -0400
Subject: [Rd] Using Sweave in hostile environments
In-Reply-To: <4BEC0A86.4030906@stats.uwo.ca>
References: <4BEC0A86.4030906@stats.uwo.ca>
Message-ID: <4BED2BA7.60309@gmail.com>

Just for the archives, a partial answer to my question:

I was unable to find a definition for the Sinput environment that would 
work, but relatively minor changes to some of the RweaveLatex functions 
cause Sweave to generate SaveVerbatim environments rather than Sinput 
environments, and that's enough to get things to work.  So the example 
below would be handled using

<<chunkname, eval=FALSE, saveVerbatim=TRUE>>=
x <- 1
@

somewhere safe, and then

\BUseVerbatim[fontshape=sl]{chunkname.in.1}

in the box.  Each piece of input or output will be saved in a separate 
verbatim piece, and they each need to be used explicitly:  you'll 
probably want to look at the .tex file to figure out the names.

This is pretty rough and I won't commit it to R, but I've attached the 
patch file (against R trunk rev 51988) in case anyone else wants to use it.

Duncan Murdoch

On 13/05/2010 10:19 AM, Duncan Murdoch wrote:
> I'm trying to put together a poster using the LaTeX a0poster package and 
> including some things from pstricks to get gradient shading, etc.
>
> The problem is that the default environments used by Sweave don't work 
> where I need them.  A simple code chunk like
>
> <<eval=FALSE>>=
> x <- 1
> @
>
> buried in a minipage within a psshadowbox gives the error
>
> Runaway argument?
>  > x <- 1 \end {Sinput} \end {Schunk} and the resulting variable would\ETC.
> D:/test.tex:302: Paragraph ended before \FV@
> BeginScanning was complete
>
>
> Has anyone solved this problem?  One way I see that might work is to put 
> the code chunk outside the environment and use SaveVerbatim to save it, 
> then just put \BUseVerbatim or \LUseVerbatim in place where I need it.  
> But because I'm using Sweave, I somehow need to redefine the Sinput, 
> Soutput and maybe the Schunk environments to do that, and I don't see 
> how to do so. 
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Sweave.patch
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100514/5bd60eac/attachment.pl>

From avraham.adler at gmail.com  Fri May 14 06:16:33 2010
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 14 May 2010 00:16:33 -0400
Subject: [Rd] Compiling R with ATLAS
Message-ID: <AANLkTin1X624rbBUEZg5GiJU6Xam79NhRRjFPqhSuuuI@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100514/64185a81/attachment.pl>

From bates at stat.wisc.edu  Fri May 14 15:00:52 2010
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri, 14 May 2010 08:00:52 -0500
Subject: [Rd] Compiling R with ATLAS
In-Reply-To: <AANLkTin1X624rbBUEZg5GiJU6Xam79NhRRjFPqhSuuuI@mail.gmail.com>
References: <AANLkTin1X624rbBUEZg5GiJU6Xam79NhRRjFPqhSuuuI@mail.gmail.com>
Message-ID: <AANLkTinXKRyabRrYK4J5Xf3h_DOkjQaN8AEtayGoFZZS@mail.gmail.com>

There is a Debian/Ubuntu specific list, R-SIG-Debian at R-project.org,
which I am cc:'ing on this reply, that is a better location for this
discussion.

It appears that you may be going about things the hard way.  There are
Ubuntu packages for atlas and for R that can handle all of this for
you.  Take a look at http://cran.r-project.org/bin/linux/ubuntu for
information on how to get started.  It will probably be much easier to
install the pre-compiled packages first and worry about compilation
for customization later.

On Thu, May 13, 2010 at 11:16 PM, Avraham Adler <avraham.adler at gmail.com> wrote:
> Hello. I know almost nothing about Linux, so I apologize if the answer to
> this is obvious.
>
> I am trying to compile R with ATLAS (successfully compiled 3.9.24 on Ubuntu
> 10.04 64 bit). I configured with:
>
> ./configure --enable-R-shlib --enable-BLAS-shlib
> --with-blas="-L/usr/local/atlas/lib -lf77blas -latlas"
> --with-lapack="-L/usr/local/atlaslib -llapack -lcblas" --with-x
>
> and I get this error (from config.log):
>
> configure:28566: checking for dgemm_ in -L/usr/local/atlas/lib -lf77blas
> -latlas
> configure:28587: gcc -std=gnu99 -o conftest -g -O2 -fpic
> -I/usr/local/include ?-L/usr/local/lib64 conftest.c -L/usr/local/atlas/lib
> -lf77blas -latlas ?-lgfortran -lm -ldl -lm ?>&5
> conftest.c: In function 'main':
> conftest.c:193: warning: implicit declaration of function 'dgemm_'
> /usr/local/atlas/lib/libf77blas.so: undefined reference to
> `atl_f77wrap_zger2u_'
> /usr/local/atlas/lib/libf77blas.so: undefined reference to
> `atl_f77wrap_cger2c_'
> /usr/local/atlas/lib/libf77blas.so: undefined reference to
> `atl_f77wrap_zger2c_'
> /usr/local/atlas/lib/libf77blas.so: undefined reference to
> `atl_f77wrap_cger2u_'
> collect2: ld returned 1 exit status
> configure:28587: $? = 1
>
> I found the following e-mail in the archives <
> http://www.mail-archive.com/r-devel at r-project.org/msg16853.html>, but it has
> a different error, and the suggestion of switching out the BLAS later does
> not seem to apply to ATLAS which requires two files, I think.
>
> Any advice would be very appreciated.
>
> Thank you.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mike.prager at mhprager.com  Fri May 14 16:02:06 2010
From: mike.prager at mhprager.com (Mike Prager)
Date: Fri, 14 May 2010 10:02:06 -0400
Subject: [Rd] update.packages fails with directory not found
References: <77EB52C6DD32BA4D87471DCD70C8D70002E67146@NA-PA-VBE03.na.tibco.com>
Message-ID: <4rlqu594am5b3ok0jnatev45p921jjhmo8@4ax.com>

Bill,

Thanks.  The problem is common but not consistent on update.  I'll
wait a few days for packages to be updated at CRAN, then try it.

Mike


On Wed, 12 May 2010 08:49:42 -0700, "William Dunlap"
<wdunlap at tibco.com> wrote:

>  If you have the time and can consistently reproduce
>this problem you might try using Sysinternal's
>Process Monitor program to capture the details of what
>R and other programs were doing in that directory around
>the time of the problem.
>  http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx


From thmsfuller066 at gmail.com  Fri May 14 16:14:48 2010
From: thmsfuller066 at gmail.com (thmsfuller066 at gmail.com)
Date: Fri, 14 May 2010 09:14:48 -0500
Subject: [Rd] Restrict access to variables in parent environment
Message-ID: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>

Hello All,

By default, a reference of a variable in a function cause R to look
for the variable in the parent environment if it is not available in
the current environment (without generating any errors or warnings).
I'm wondering if there is a way to revert this behaviors, such that it
will not look for the parent environment and will generate an error if
the variable is not available in the current environment. Is this
tuning has to be done at the C level?

-- 
Tom


From hadley at rice.edu  Fri May 14 16:20:51 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 14 May 2010 09:20:51 -0500
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
Message-ID: <AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com>

> Hello All,
>
> By default, a reference of a variable in a function cause R to look
> for the variable in the parent environment if it is not available in
> the current environment (without generating any errors or warnings).
> I'm wondering if there is a way to revert this behaviors, such that it
> will not look for the parent environment and will generate an error if
> the variable is not available in the current environment. Is this
> tuning has to be done at the C level?

Try this:
b <- 1
f <- function(a) {
  b
}

environment(f) <- baseenv()
f()

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From jeff.a.ryan at gmail.com  Fri May 14 16:29:05 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 14 May 2010 09:29:05 -0500
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
	<AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com>
Message-ID: <AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100514/35c0ffcd/attachment.pl>

From ggrothendieck at gmail.com  Fri May 14 17:10:23 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 14 May 2010 11:10:23 -0400
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com> 
	<AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com> 
	<AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>
Message-ID: <AANLkTilP5SFqjCrnvedxO5da-QHqxQxZpvU3QpETANUr@mail.gmail.com>

You can get around that by using this instead:

environment(f) <- as.environment(2)

provided it is done after you have loaded all your packages.

On Fri, May 14, 2010 at 10:29 AM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
> This isn't like a local variable though, since any function above the
> baseenv() in the search path will also not be found.
>
>> f
> function(a) { rnorm(b) }
> <environment: base>
>
>> f()
> Error in f() : could not find function "rnorm"
>
> Jeff
>
> On Fri, May 14, 2010 at 9:20 AM, Hadley Wickham <hadley at rice.edu> wrote:
>
>> > Hello All,
>> >
>> > By default, a reference of a variable in a function cause R to look
>> > for the variable in the parent environment if it is not available in
>> > the current environment (without generating any errors or warnings).
>> > I'm wondering if there is a way to revert this behaviors, such that it
>> > will not look for the parent environment and will generate an error if
>> > the variable is not available in the current environment. Is this
>> > tuning has to be done at the C level?
>>
>> Try this:
>> b <- 1
>> f <- function(a) {
>> ?b
>> }
>>
>> environment(f) <- baseenv()
>> f()
>>
>> Hadley
>>
>> --
>> Assistant Professor / Dobelman Family Junior Chair
>> Department of Statistics / Rice University
>> http://had.co.nz/
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at insightalgo.com
>
> ia: insight algorithmics
> www.insightalgo.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Fri May 14 17:14:56 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 14 May 2010 10:14:56 -0500
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTilP5SFqjCrnvedxO5da-QHqxQxZpvU3QpETANUr@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com> 
	<AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com> 
	<AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com> 
	<AANLkTilP5SFqjCrnvedxO5da-QHqxQxZpvU3QpETANUr@mail.gmail.com>
Message-ID: <AANLkTin1i_ZLnt3CHY0XfyVABZ2dhIN1Yjz4kQ4BxmMo@mail.gmail.com>

On Fri, May 14, 2010 at 10:10 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> You can get around that by using this instead:
>
> environment(f) <- as.environment(2)
>
> provided it is done after you have loaded all your packages.

Another approach is to inspect function by function:

library(codetools)
findGlobals(f, F)$variables

Hadley
-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From simon.urbanek at r-project.org  Fri May 14 17:13:46 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 14 May 2010 11:13:46 -0400
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
	<AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com>
	<AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>
Message-ID: <AA64B5C1-A3D4-48ED-AA40-CBDEF7C97073@r-project.org>


On May 14, 2010, at 10:29 AM, Jeff Ryan wrote:

> This isn't like a local variable though, since any function above the
> baseenv() in the search path will also not be found.
> 

Yes, but that is a consequence of the request and hence intended. You can always either specify the full path to the function or assign locally any functions you'll need:

> f = function(a) stats::rnorm(b)
> environment(f) <- baseenv()
> f()
Error in stats::rnorm(b) : object 'b' not found

> f = function(a) { rnorm=stats::rnorm; rnorm(b) }
> environment(f) <- baseenv()
> f()
Error in rnorm(b) : object 'b' not found

Alternatively you can use any environment up the search path hoping that those won't define further variables.

But back to the original question -- if taken literally, it's quite useless since it corresponds to using emptyenv() instead of baseenv() which means that you can't do anything:

> local(1+1,emptyenv())
Error in eval(expr, envir, enclos) : could not find function "+"


So likely the only useful(?) distinction would be to allow function lookup the regular way but change only the variable lookup to not look beyond the current environment. That is stretching it, though...

Cheers,
Simon





>> f
> function(a) { rnorm(b) }
> <environment: base>
> 
>> f()
> Error in f() : could not find function "rnorm"
> 
> Jeff
> 
> On Fri, May 14, 2010 at 9:20 AM, Hadley Wickham <hadley at rice.edu> wrote:
> 
>>> Hello All,
>>> 
>>> By default, a reference of a variable in a function cause R to look
>>> for the variable in the parent environment if it is not available in
>>> the current environment (without generating any errors or warnings).
>>> I'm wondering if there is a way to revert this behaviors, such that it
>>> will not look for the parent environment and will generate an error if
>>> the variable is not available in the current environment. Is this
>>> tuning has to be done at the C level?
>> 
>> Try this:
>> b <- 1
>> f <- function(a) {
>> b
>> }
>> 
>> environment(f) <- baseenv()
>> f()
>> 
>> Hadley
>> 
>> --
>> Assistant Professor / Dobelman Family Junior Chair
>> Department of Statistics / Rice University
>> http://had.co.nz/
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> 
> 
> -- 
> Jeffrey Ryan
> jeffrey.ryan at insightalgo.com
> 
> ia: insight algorithmics
> www.insightalgo.com
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From thmsfuller066 at gmail.com  Fri May 14 17:33:10 2010
From: thmsfuller066 at gmail.com (thmsfuller066 at gmail.com)
Date: Fri, 14 May 2010 10:33:10 -0500
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AA64B5C1-A3D4-48ED-AA40-CBDEF7C97073@r-project.org>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
	<AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com>
	<AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>
	<AA64B5C1-A3D4-48ED-AA40-CBDEF7C97073@r-project.org>
Message-ID: <AANLkTinDI_nB3lrOh9HaXmqdg3oAYFTmfWIty-z9wKc2@mail.gmail.com>

On Fri, May 14, 2010 at 10:13 AM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On May 14, 2010, at 10:29 AM, Jeff Ryan wrote:
>
>> This isn't like a local variable though, since any function above the
>> baseenv() in the search path will also not be found.
>>
>
> Yes, but that is a consequence of the request and hence intended. You can always either specify the full path to the function or assign locally any functions you'll need:
>
>> f = function(a) stats::rnorm(b)
>> environment(f) <- baseenv()
>> f()
> Error in stats::rnorm(b) : object 'b' not found
>
>> f = function(a) { rnorm=stats::rnorm; rnorm(b) }
>> environment(f) <- baseenv()
>> f()
> Error in rnorm(b) : object 'b' not found
>
> Alternatively you can use any environment up the search path hoping that those won't define further variables.
>
> But back to the original question -- if taken literally, it's quite useless since it corresponds to using emptyenv() instead of baseenv() which means that you can't do anything:
>
>> local(1+1,emptyenv())
> Error in eval(expr, envir, enclos) : could not find function "+"
>
>
> So likely the only useful(?) distinction would be to allow function lookup the regular way but change only the variable lookup to not look beyond the current environment. That is stretching it, though...

I didn't think of the corner cases. I'm OK with stats::rnorm or
stats:::rnorm. But '{' is not recognized. How to make it be
recognized?

b=1
f=function() {
  stats::rnorm(b)
}
f()
#environment(f)=base()
environment(f)=emptyenv()
f()
> Cheers,
> Simon
>
>
>
>
>
>>> f
>> function(a) { rnorm(b) }
>> <environment: base>
>>
>>> f()
>> Error in f() : could not find function "rnorm"
>>
>> Jeff
>>
>> On Fri, May 14, 2010 at 9:20 AM, Hadley Wickham <hadley at rice.edu> wrote:
>>
>>>> Hello All,
>>>>
>>>> By default, a reference of a variable in a function cause R to look
>>>> for the variable in the parent environment if it is not available in
>>>> the current environment (without generating any errors or warnings).
>>>> I'm wondering if there is a way to revert this behaviors, such that it
>>>> will not look for the parent environment and will generate an error if
>>>> the variable is not available in the current environment. Is this
>>>> tuning has to be done at the C level?
>>>
>>> Try this:
>>> b <- 1
>>> f <- function(a) {
>>> b
>>> }
>>>
>>> environment(f) <- baseenv()
>>> f()
>>>
>>> Hadley
>>>
>>> --
>>> Assistant Professor / Dobelman Family Junior Chair
>>> Department of Statistics / Rice University
>>> http://had.co.nz/
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at insightalgo.com
>>
>> ia: insight algorithmics
>> www.insightalgo.com
>>
>> ? ? ? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Tom


From efreeman at berkeley.edu  Fri May 14 17:38:28 2010
From: efreeman at berkeley.edu (efreeman at berkeley.edu)
Date: Fri, 14 May 2010 08:38:28 -0700
Subject: [Rd] results of pnorm as either NaN or Inf
In-Reply-To: <alpine.LFD.2.00.1005141140040.26606@gannet.stats.ox.ac.uk>
References: <XFMail.100514000131.Ted.Harding@manchester.ac.uk>
	<alpine.LFD.2.00.1005141140040.26606@gannet.stats.ox.ac.uk>
Message-ID: <877f267f08c7b0a81114caa1869daa9f@berkeley.edu>

Thank you for your responses. 

I presented a minimal example of the issue, but I should have explained
that this came up in the context of maximizing a log likelihood function
(with optim). I certainly agree that there would be no good reason for a
human to evaluate the function pnorm(-x, log.p=TRUE) for large x. However,
I would suggest that one may want the function to return a value of -Inf
for large x, rather than issue an error or a warning, as I'm guessing your
alteration of the C code would do. Returning a value of -Inf would allow an
optimization routine (or a pre-optimization-routine grid search) to know
that it's going into (or is currently in) the wrong region. I can
definitely see the counterargument that someone using an optimization
routine should think about the function they are optimizing more carefully,
especially given that there could be numerical issues. I think I'm not the
right person to judge, both because I don't know the programming issues nor
much about numerical optimization, but I wanted to offer a possible
argument for returning -Inf in case it hasn't already been considered, and
others can evaluate the issue. (In general, my earlier purpose was just to
point out what I thought might be an inconsistency in case people wanted to
change it. I'm not concerned about it for my own usage at all, since I can
just adjust my own programs.)

Thank you, and to all, thank you for all of your work on R.

Eric

On Fri, 14 May 2010 11:50:09 +0100 (BST), Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
> The answer to pnorm(-x, log.p=TRUE) is of course about -0.5*x*x for 
> large x.  So trying to compute it for -1e108 is a bit silly, both on 
> your part and the C code used.  I've altered the C code not to attempt 
> it for x > 1e170, which excludes the area where underflow occurs.
> 
> On Fri, 14 May 2010, Ted.Harding at manchester.ac.uk wrote:
> 
>> On 13-May-10 20:04:50, efreeman at berkeley.edu wrote:
>>> I stumbled across this and I am wondering if this is unexpected
>>> behavior or if I am missing something.
>>>
>>>> pnorm(-1.0e+307, log.p=TRUE)
>>> [1] -Inf
>>>> pnorm(-1.0e+308, log.p=TRUE)
>>> [1] NaN
>>> Warning message:
>>> In pnorm(q, mean, sd, lower.tail, log.p) : NaNs produced
>>>> pnorm(-1.0e+309, log.p=TRUE)
>>> [1] -Inf
>>>
>>> I don't know C and am not that skilled with R, so it would be hard
>>> for me to look into the code for pnorm. If I'm not just missing
>>> something, I thought it may be of interest.
>>>
>>> Details:
>>> I am using Mac OS X 10.5.8. I installed a precompiled binary version.
>>> Here is the output from sessionInfo(), requested in the posting guide:
>>> R version 2.11.0 (2010-04-22)
>>> i386-apple-darwin9.8.0
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> loaded via a namespace (and not attached):
>>> [1] tools_2.11.0
>>>
>>> Thank you very much,
>>>
>>> Eric Freeman
>>> UC Berkeley
>>
>> This is probably platform-independent. I get the same results with
>> R on Linux. More to the point:
>>
>> You are clearly "pushing the envelope" here. First, have a look
>> at what R makes of your inputs to pnorm():
>>
>>  -1.0e+307
>>  # [1] -1e+307
>>  -1.0e+308
>>  # [1] -1e+308
>>  -1.0e+309
>>  # [1] -Inf
>>
>>
>> So, somewhere beteen -1e+308 and -1.0e+309. the envelope burst!
>> Given -1.0e+309, R returns -Inf (i.e. R can no longer represent
>> this internally as a finite number).
>>
>> Now look at
>>
>>  pnorm(-Inf,log.p=TRUE)
>>  # [1] -Inf
>>
>> So, R knows how to give the correct answer (an exact 0, or -Inf
>> on the log scale) if you feed pnorm() with -Inf. So you're OK
>> with -1e+N where N >= 309.
>>
>> For smaller powers, e.g. -1e+(200:306), these give pnorm() much
>> less than -1.0e+309, and presumably R's algorithm (which I haven't
>> studied either ... ) returns 0 for pnorm(), as it should to the
>> available internal accuracy.
>>
>> So, up to pnorm(-1.0e+307, log.p=TRUE) = -Inf. All is as it should be.
>> However, at -1e+308, "the envelope is about to burst", and something
>> may occur within the algorithm which results in a NaN.
>>
>> So there is nothing anomalous about your results except at -1e+308,
>> which is where R is at a critical point.
>>
>> That's how I see it, anway!
>> Ted.
>>
>> --------------------------------------------------------------------
>> E-Mail: (Ted Harding) <Ted.Harding at manchester.ac.uk>
>> Fax-to-email: +44 (0)870 094 0861
>> Date: 14-May-10                                       Time: 00:01:27
>> ------------------------------ XFMail ------------------------------
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From avraham.adler at gmail.com  Fri May 14 18:28:09 2010
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 14 May 2010 12:28:09 -0400
Subject: [Rd] Compiling R with ATLAS
In-Reply-To: <AANLkTinXKRyabRrYK4J5Xf3h_DOkjQaN8AEtayGoFZZS@mail.gmail.com>
References: <AANLkTin1X624rbBUEZg5GiJU6Xam79NhRRjFPqhSuuuI@mail.gmail.com>
	<AANLkTinXKRyabRrYK4J5Xf3h_DOkjQaN8AEtayGoFZZS@mail.gmail.com>
Message-ID: <AANLkTikAIRULJ6wWet06_KA8nRUTmWfGLuE8276W6fPH@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100514/a50c84a7/attachment.pl>

From avraham.adler at gmail.com  Fri May 14 18:33:28 2010
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 14 May 2010 12:33:28 -0400
Subject: [Rd] Fwd:  Compiling R with ATLAS
In-Reply-To: <AANLkTikAIRULJ6wWet06_KA8nRUTmWfGLuE8276W6fPH@mail.gmail.com>
References: <AANLkTin1X624rbBUEZg5GiJU6Xam79NhRRjFPqhSuuuI@mail.gmail.com>
	<AANLkTinXKRyabRrYK4J5Xf3h_DOkjQaN8AEtayGoFZZS@mail.gmail.com>
	<AANLkTikAIRULJ6wWet06_KA8nRUTmWfGLuE8276W6fPH@mail.gmail.com>
Message-ID: <AANLkTin4ohnfrIRuX6TqWp1vemYuCS1ooNr9NGBDTIlP@mail.gmail.com>

(Resent as plain text, sorry)

Thank you.

I am doing it this way as I really do not know much about Linux, and I
would not know how to re-compile Rblas and Rlapack with the ATLAS BLAS
and tuned LAPACK after I install the precompiled packages through
synaptic. This way, ostensibly, I should be compiling it from scratch
so it should work. Also, this way, I can compile R itself with
optimization and -march=native to squeeze out whatever speed I can
from my machine.

Any advice would be very much appreciated, and thank you for pointing
me to the correct list.

--Avi


On Fri, May 14, 2010 at 9:00 AM, Douglas Bates <bates at stat.wisc.edu> wrote:
>
> There is a Debian/Ubuntu specific list, R-SIG-Debian at R-project.org,
> which I am cc:'ing on this reply, that is a better location for this
> discussion.
>
> It appears that you may be going about things the hard way. ?There are
> Ubuntu packages for atlas and for R that can handle all of this for
> you. ?Take a look at http://cran.r-project.org/bin/linux/ubuntu for
> information on how to get started. ?It will probably be much easier to
> install the pre-compiled packages first and worry about compilation
> for customization later.
>
> On Thu, May 13, 2010 at 11:16 PM, Avraham Adler <avraham.adler at gmail.com> wrote:
> > Hello. I know almost nothing about Linux, so I apologize if the answer to
> > this is obvious.
> >
> > I am trying to compile R with ATLAS (successfully compiled 3.9.24 on Ubuntu
> > 10.04 64 bit). I configured with:
> >
> > ./configure --enable-R-shlib --enable-BLAS-shlib
> > --with-blas="-L/usr/local/atlas/lib -lf77blas -latlas"
> > --with-lapack="-L/usr/local/atlaslib -llapack -lcblas" --with-x
> >
> > and I get this error (from config.log):
> >
> > configure:28566: checking for dgemm_ in -L/usr/local/atlas/lib -lf77blas
> > -latlas
> > configure:28587: gcc -std=gnu99 -o conftest -g -O2 -fpic
> > -I/usr/local/include ?-L/usr/local/lib64 conftest.c -L/usr/local/atlas/lib
> > -lf77blas -latlas ?-lgfortran -lm -ldl -lm ?>&5
> > conftest.c: In function 'main':
> > conftest.c:193: warning: implicit declaration of function 'dgemm_'
> > /usr/local/atlas/lib/libf77blas.so: undefined reference to
> > `atl_f77wrap_zger2u_'
> > /usr/local/atlas/lib/libf77blas.so: undefined reference to
> > `atl_f77wrap_cger2c_'
> > /usr/local/atlas/lib/libf77blas.so: undefined reference to
> > `atl_f77wrap_zger2c_'
> > /usr/local/atlas/lib/libf77blas.so: undefined reference to
> > `atl_f77wrap_cger2u_'
> > collect2: ld returned 1 exit status
> > configure:28587: $? = 1
> >
> > I found the following e-mail in the archives <
> > http://www.mail-archive.com/r-devel at r-project.org/msg16853.html>, but it has
> > a different error, and the suggestion of switching out the BLAS later does
> > not seem to apply to ATLAS which requires two files, I think.
> >
> > Any advice would be very appreciated.
> >
> > Thank you.
> >
> > ? ? ? ?[[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >


From wdunlap at tibco.com  Fri May 14 18:40:37 2010
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 14 May 2010 09:40:37 -0700
Subject: [Rd] [R] Subscripting a matrix-like object
In-Reply-To: <xmraas2o3vf.fsf@mralx1.rsma.frb.gov>
References: <20100514143828.10F7D8384@mralx1.rsma.frb.gov>
	<xmraas2o3vf.fsf@mralx1.rsma.frb.gov>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70002F1E4E3@NA-PA-VBE03.na.tibco.com>

> -----Original Message-----
> From: r-help-bounces at r-project.org 
> [mailto:r-help-bounces at r-project.org] On Behalf Of Jeffrey J. Hallman
> Sent: Friday, May 14, 2010 9:17 AM
> To: r-help at stat.math.ethz.ch
> Subject: Re: [R] Subscripting a matrix-like object
> 
> jhallman at frb.gov writes:
> 
> Answering my own question here, so you can ignore this unless you are
> really interested in some fairly obscure stuff.  It turns out 
> that this works:
> 
> singleIndex <- missing(j) && (length(sys.call()) == 
> length(match.call()))
> 
> since sys.call() has an element for the empty argument created by
> 
> x[i,] <- value
> 
> and match.call() does not.  But it is pretty obscure.

I was curious about this because in the version of R
I'm using (2.11.0, 2010-04-22), nargs() does distinguish
between x[i] and x[i,].  E.g., with the following
replacement function
  `[<-.foo` <- function (x, i, j, ..., value)
  {
      cat("[<-.foo: nargs=", nargs(), "\n", sep = "")
      cat("         sys.call()=", deparse(sys.call()), "\n", sep = "")
      cat("         missing(i)=", missing(i), "\n", sep = "")
      cat("         missing(j)=", missing(j), "\n", sep = "")
      x
  }
I get
  > fooObject <- structure(1:4, class="foo")
  > fooObject[1] <- 12
  [<-.foo: nargs=3
           sys.call()=`[<-.foo`(`*tmp*`, 1, value = 12)
           missing(i)=FALSE
           missing(j)=TRUE
  > fooObject[1,] <- 12
  [<-.foo: nargs=4
           sys.call()=`[<-.foo`(`*tmp*`, 1, , value = 12)
           missing(i)=FALSE
           missing(j)=TRUE
  > fooObject[,1] <- 12
  [<-.foo: nargs=4
           sys.call()=`[<-.foo`(`*tmp*`, , 1, value = 12)
           missing(i)=TRUE
           missing(j)=FALSE
  
Is this a bug in nargs() that was recently fixed?

sys.call() and especially match.call() are
fairly expensive functions to call so it would be nice
to be able to avoid them.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com  

> 
> Jeff
> 
> > I have an S3 class called "tis" (Time Indexed Series) which 
> may or may
> > not have multiple columns.  I have a function "[<-.tis" that I've
> > reproduced below.  
> >
> > My question is this: inside of "[<-.tis", how can I 
> distinguish between
> > calls of the form 
> >
> > x[i] <- someValue
> >
> > and
> >
> > x[i,] <- someValue ?
> >
> > In either case, nargs() is 3, and looking at the values 
> from sys.call()
> > and match.call() I could not tell them apart.  Am I missing 
> something?
> >
> >
> > "[<-.tis" <- function(x, i, j, ..., value){
> >   tif <- tif(x)
> >   xStart <- start(x)
> >   x <- stripTis(x)
> >   if(missing(i)){
> >     if(missing(j)) x[]   <- value
> >     else           x[,j] <- value
> >   }
> >   else {
> >     i <- i[!is.na(i)]
> >     if(is.numeric(i)){
> >       if(!is.ti(i) && couldBeTi(i, tif = tif))
> >         i <- asTi(i)
> >       if(is.ti(i)){
> >         i <- i + 1 - xStart
> >         if(any(i < 1)){
> >           newRows <- 1 - min(i)
> >           xStart <- xStart - newRows
> >           if(is.null(m <- ncol(x)))  m <- 1
> >           i <- i + newRows
> >           if(is.matrix(x))
> >             x <- rbind(matrix(NA, newRows, m), x)
> >           else
> >             x <- c(rep(NA, newRows), x)
> >         }
> >       }
> >     }
> >     else if(!is.logical(i)) stop("non-numeric, non-logical 
> row index")
> >    if(is.matrix(x)){
> >       if(any(i > nrow(x))){
> >         newRows <- max(i) - nrow(x)
> >         x <- rbind(x, matrix(NA, newRows, ncol(x)))
> >       }
> >       if(missing(j)){
> >         if(is.matrix(i))  x[i] <- value
> >         else {
> >           if(is.logical(i))
> >             x[i,] <- rep(value, length = sum(i)*ncol(x))
> >           else
> >             x[i,] <- rep(value, length = length(i)*ncol(x))
> >         }
> >       }
> >       else x[i,j] <- value
> >     }
> >     else x[i] <- value
> >   }
> >   start(x) <- xStart
> >   class(x) <- c("tis", oldClass(x))
> >   x
> > }
> >
> 
> -- 
> Jeff
> 
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From pgilbert at bank-banque-canada.ca  Fri May 14 18:50:02 2010
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 14 May 2010 12:50:02 -0400
Subject: [Rd] S4 default/missing args
Message-ID: <D611103AA7EE3B4DAE7F7D49C72B291A028B8E90@EXMAIL2.bocad.bank-banque-canada.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100514/cca05e92/attachment.pl>

From simon.urbanek at r-project.org  Fri May 14 18:56:45 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 14 May 2010 12:56:45 -0400
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTinDI_nB3lrOh9HaXmqdg3oAYFTmfWIty-z9wKc2@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
	<AANLkTinVN5_uVkOaryuBnmw5JTYWdqWRojFRdG41hC-7@mail.gmail.com>
	<AANLkTinyl2u3qXHjXcoBbWhBg8YaWlF917j_fEgj-hhO@mail.gmail.com>
	<AA64B5C1-A3D4-48ED-AA40-CBDEF7C97073@r-project.org>
	<AANLkTinDI_nB3lrOh9HaXmqdg3oAYFTmfWIty-z9wKc2@mail.gmail.com>
Message-ID: <3DA0F3AD-4EA5-4620-9A4C-65511EDEE0F7@r-project.org>


On May 14, 2010, at 11:33 AM, thmsfuller066 at gmail.com wrote:

> On Fri, May 14, 2010 at 10:13 AM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>> 
>> On May 14, 2010, at 10:29 AM, Jeff Ryan wrote:
>> 
>>> This isn't like a local variable though, since any function above the
>>> baseenv() in the search path will also not be found.
>>> 
>> 
>> Yes, but that is a consequence of the request and hence intended. You can always either specify the full path to the function or assign locally any functions you'll need:
>> 
>>> f = function(a) stats::rnorm(b)
>>> environment(f) <- baseenv()
>>> f()
>> Error in stats::rnorm(b) : object 'b' not found
>> 
>>> f = function(a) { rnorm=stats::rnorm; rnorm(b) }
>>> environment(f) <- baseenv()
>>> f()
>> Error in rnorm(b) : object 'b' not found
>> 
>> Alternatively you can use any environment up the search path hoping that those won't define further variables.
>> 
>> But back to the original question -- if taken literally, it's quite useless since it corresponds to using emptyenv() instead of baseenv() which means that you can't do anything:
>> 
>>> local(1+1,emptyenv())
>> Error in eval(expr, envir, enclos) : could not find function "+"
>> 
>> 
>> So likely the only useful(?) distinction would be to allow function lookup the regular way but change only the variable lookup to not look beyond the current environment. That is stretching it, though...
> 
> I didn't think of the corner cases. I'm OK with stats::rnorm or
> stats:::rnorm. But '{' is not recognized. How to make it be
> recognized?
> 

You either include base or (if you don't want to) you have to create functions for everything you'll need including `{` so for example:

> f=function(a) base::rnorm(b)
> environment(f)=mini.env
> mini.env=new.env(parent=emptyenv())
> import=c("{","::","+","rnorm") # add all functions you want to use
> for (fn in import) mini.env[[fn]] = get(fn)

> f=function(a) rnorm(a+b)
> environment(f)=mini.env

> f(1)
Error in rnorm(a + b) : object 'b' not found


Cheers,
Simon



> b=1
> f=function() {
>  stats::rnorm(b)
> }
> f()
> #environment(f)=base()
> environment(f)=emptyenv()
> f()
>> Cheers,
>> Simon
>> 
>> 
>> 
>> 
>> 
>>>> f
>>> function(a) { rnorm(b) }
>>> <environment: base>
>>> 
>>>> f()
>>> Error in f() : could not find function "rnorm"
>>> 
>>> Jeff
>>> 
>>> On Fri, May 14, 2010 at 9:20 AM, Hadley Wickham <hadley at rice.edu> wrote:
>>> 
>>>>> Hello All,
>>>>> 
>>>>> By default, a reference of a variable in a function cause R to look
>>>>> for the variable in the parent environment if it is not available in
>>>>> the current environment (without generating any errors or warnings).
>>>>> I'm wondering if there is a way to revert this behaviors, such that it
>>>>> will not look for the parent environment and will generate an error if
>>>>> the variable is not available in the current environment. Is this
>>>>> tuning has to be done at the C level?
>>>> 
>>>> Try this:
>>>> b <- 1
>>>> f <- function(a) {
>>>> b
>>>> }
>>>> 
>>>> environment(f) <- baseenv()
>>>> f()
>>>> 
>>>> Hadley
>>>> 
>>>> --
>>>> Assistant Professor / Dobelman Family Junior Chair
>>>> Department of Statistics / Rice University
>>>> http://had.co.nz/
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>>> 
>>> 
>>> 
>>> --
>>> Jeffrey Ryan
>>> jeffrey.ryan at insightalgo.com
>>> 
>>> ia: insight algorithmics
>>> www.insightalgo.com
>>> 
>>>       [[alternative HTML version deleted]]
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> 
> 
> -- 
> Tom
> 
> 


From murdoch.duncan at gmail.com  Fri May 14 19:53:18 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 14 May 2010 13:53:18 -0400
Subject: [Rd] Restrict access to variables in parent environment
In-Reply-To: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
References: <AANLkTine-6pPbbOKspjOxOFF7qYC56KItUn_apBUKSgy@mail.gmail.com>
Message-ID: <4BED8E0E.5040704@gmail.com>

On 14/05/2010 10:14 AM, thmsfuller066 at gmail.com wrote:
> Hello All,
>
> By default, a reference of a variable in a function cause R to look
> for the variable in the parent environment if it is not available in
> the current environment (without generating any errors or warnings).
> I'm wondering if there is a way to revert this behaviors, such that it
> will not look for the parent environment and will generate an error if
> the variable is not available in the current environment. Is this
> tuning has to be done at the C level?

You could do that by setting the environment of the function to 
emptyenv(), but it will not be pretty.  Remember that everything in R is 
an object, so you won't have access to the base level objects like +, or 
mean, or any other function.

Duncan Murdoch


From thmsfuller066 at gmail.com  Fri May 14 21:38:59 2010
From: thmsfuller066 at gmail.com (thmsfuller066 at gmail.com)
Date: Fri, 14 May 2010 14:38:59 -0500
Subject: [Rd] The parsing of '{' and a function that equal to '{'
Message-ID: <AANLkTil-jwpC1dCv3L5gYVfJFXehSokXyRyxbZLs5RfX@mail.gmail.com>

Hello All,

I tried the sample code from the help. Although '{' is assigned to
'do', the call syntaxes for 'do' and '{' are not the same ('do' has
','s, but '{' has line breaks). I guess there is a difference in
parsing the code block of 'do' and the code block of '{'. Could you
please let me know some internal details so that I can understand the
differences?

> do=get("{")
> do(x <- 3, y <- 2*x-3, 6-x-y)
[1] 0
> {
+   x <- 3
+   y <- 2*x-3
+   6-x-y
+ }
[1] 0
> x
[1] 3
> y
[1] 3
>

-- 
Tom


From simon.urbanek at r-project.org  Fri May 14 22:42:29 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 14 May 2010 16:42:29 -0400
Subject: [Rd] The parsing of '{' and a function that equal to '{'
In-Reply-To: <AANLkTil-jwpC1dCv3L5gYVfJFXehSokXyRyxbZLs5RfX@mail.gmail.com>
References: <AANLkTil-jwpC1dCv3L5gYVfJFXehSokXyRyxbZLs5RfX@mail.gmail.com>
Message-ID: <ECDC0BBD-4125-411B-881B-5E92FCEA5072@r-project.org>


On May 14, 2010, at 3:38 PM, thmsfuller066 at gmail.com wrote:

> Hello All,
> 
> I tried the sample code from the help. Although '{' is assigned to
> 'do', the call syntaxes for 'do' and '{' are not the same ('do' has
> ','s, but '{' has line breaks). I guess there is a difference in
> parsing the code block of 'do' and the code block of '{'. Could you
> please let me know some internal details so that I can understand the
> differences?
> 

{ foo; bar } 

gets parsed into

`{`(foo, bar)

as you illustrated below. You can see that in the resulting expression:

> e=parse(text="{foo; bar}")[[1]]
> attributes(e)=NULL ## remove the original sources
> e
{
    foo
    bar
}
> .Internal(inspect(e))
@102182578 06 LANGSXP g0c0 [NAM(2)] 
  @10082c9b8 01 SYMSXP g0c0 [MARK,gp=0x4000] "{"
  @100edfaa0 01 SYMSXP g0c0 [] "foo"
  @100edfc98 01 SYMSXP g0c0 [] "bar"


and in case you are not familiar with the internal representation:

> quote(`{`(foo,bar))
{
    foo
    bar
}
> .Internal(inspect(quote(`{`(foo,bar))))
@100f99868 06 LANGSXP g0c0 [] 
  @10082c9b8 01 SYMSXP g0c0 [MARK,gp=0x4000] "{"
  @100edfaa0 01 SYMSXP g0c0 [] "foo"
  @100edfc98 01 SYMSXP g0c0 [] "bar"

Cheers,
Simon




>> do=get("{")
>> do(x <- 3, y <- 2*x-3, 6-x-y)
> [1] 0
>> {
> +   x <- 3
> +   y <- 2*x-3
> +   6-x-y
> + }
> [1] 0
>> x
> [1] 3
>> y
> [1] 3
>> 
> 
> -- 
> Tom
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From lubrs at comcast.net  Fri May 14 22:52:56 2010
From: lubrs at comcast.net (Dave Lubbers)
Date: Fri, 14 May 2010 13:52:56 -0700 (PDT)
Subject: [Rd] where is libRmath.a & libRmath.so
In-Reply-To: <4BED010E.1060809@statistik.tu-dortmund.de>
References: <1273805272551-2216048.post@n4.nabble.com>
	<4BED010E.1060809@statistik.tu-dortmund.de>
Message-ID: <1273870376657-2217224.post@n4.nabble.com>


R 2.7.2 -   the manual says 
configure
make

Which is what I did.  So I did read the manual and followed the directions. 
The manual is too terse to get me there.
-- 
View this message in context: http://r.789695.n4.nabble.com/where-is-libRmath-a-libRmath-so-tp2216048p2217224.html
Sent from the R devel mailing list archive at Nabble.com.


From jmc at r-project.org  Fri May 14 22:59:02 2010
From: jmc at r-project.org (John Chambers)
Date: Fri, 14 May 2010 13:59:02 -0700
Subject: [Rd] S4 default/missing args
In-Reply-To: <D611103AA7EE3B4DAE7F7D49C72B291A028B8E90@EXMAIL2.bocad.bank-banque-canada.ca>
References: <D611103AA7EE3B4DAE7F7D49C72B291A028B8E90@EXMAIL2.bocad.bank-banque-canada.ca>
Message-ID: <4BEDB996.80004@r-project.org>

 From the documentation for setMethod():

Method definitions can have default expressions for arguments, but a 
current limitation is that the generic function must have some default 
expression for the same argument in order for the method's defaults to 
be used. <....>

(It would be nice to fix this, but would require some significant change 
to how methods are dispatched, with some possible inefficiencies.  The 
issue is that R processes formal arguments differently if there is no 
default expression.  Volunteers among the R hackers welcome, though.)

Meanwhile, if you own the generic function just give it a default, say:

setGeneric("TSdoc",
      def= function(x, con = stop("Sorry, no generic default"), ...) 
standardGeneric("TSdoc"))

John


On 5/14/10 9:50 AM, Paul Gilbert wrote:
> I am trying to understand the missing vs default value for an argument
> to an S4 method. (I'm not sure if this is a bug or my confusion.) In S3
> I can specify a default value for an argument and then both check if the
> argument was missing in the call, and use it because it takes on the
> default value. I do not seem to be able to do that in S4 as shown by
> this simplified example:
>
>
>
> setGeneric("TSdoc",
>
>     def= function(x, con, ...) standardGeneric("TSdoc"))
>
>
>
> setMethod("TSdoc",   signature(x="character", con="missing"),
>
>      definition= function(x, con=getOption("TSconnection"), ...){
>
>          if(is.null(con))
>
>             stop("con should be specified or set with
> options(TSconnection=con).")
>
>          else return('ok')} )
>
>
>
> Then when I try
>
>     TSdoc("B103")
>
> In my original problem I got
>
>     Error in is.null(con) : 'con' is missing
>
> And in the simplified example I get
>
>    Error in TSdoc("B103") :
>
>      element 1 is empty;
>
>       the part of the args list of 'is.null' being evaluated was:
>
>       (con)
>
>
>
> I'm not sure why there is a difference, but the implication is the same
> in both, the default
>
>> getOption("TSconnection")
>
> NULL
>
>
>
> Is not getting through to the is.null().  I can fix (or work around)
> this with
>
>
>
> setMethod("TSdoc",   signature(x="character", con="missing"),
>
>     definition= function(x, con,  ...){
>
>         if(is.null(con<- getOption("TSconnection")))
>
>            stop("con should be specified or set with
> options(TSconnection=con).")
>
>         else return('ok') } )
>
>
>
> TSdoc("B103")
>
> Error in TSdoc("B103") :
>
>    con should be specified or set with options(TSconnection=con).
>
>
>
> So my question is, is this a bug or do I have to adjust my programming
> style for the way missing/default arguments are handled in S4?
>
>
>
> Paul Gilbert
>
> ====================================================================================
>
> La version fran??aise suit le texte anglais.
>
> ------------------------------------------------------------------------------------
>
> This email may contain privileged and/or confidential information, and the Bank of
> Canada does not waive any related rights. Any distribution, use, or copying of this
> email or the information it contains by other than the intended recipient is
> unauthorized. If you received this email in error please delete it immediately from
> your system and notify the sender promptly by email that you have done so.
>
> ------------------------------------------------------------------------------------
>
> Le pr??sent courriel peut contenir de l'information privil??gi??e ou confidentielle.
> La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute diffusion,
> utilisation ou copie de ce courriel ou des renseignements qu'il contient par une
> personne autre que le ou les destinataires d??sign??s est interdite. Si vous recevez
> ce courriel par erreur, veuillez le supprimer imm??diatement et envoyer sans d??lai ?
> l'exp??diteur un message ??lectronique pour l'aviser que vous avez ??limin?? de votre
> ordinateur toute copie du courriel re??u.
>
> 	[[alternative HTML version deleted]]
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Fri May 14 23:14:34 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 14 May 2010 17:14:34 -0400
Subject: [Rd] where is libRmath.a & libRmath.so
In-Reply-To: <1273870376657-2217224.post@n4.nabble.com>
References: <1273805272551-2216048.post@n4.nabble.com>
	<4BED010E.1060809@statistik.tu-dortmund.de>
	<1273870376657-2217224.post@n4.nabble.com>
Message-ID: <7B73DBB2-E0D6-4A7B-9201-31BDB2845326@r-project.org>


On May 14, 2010, at 4:52 PM, Dave Lubbers wrote:

> 
> R 2.7.2 -   the manual says 
> configure
> make
> 
> Which is what I did.  So I did read the manual and followed the directions. 
> The manual is too terse to get me there.

cd src/nmath/standalone
make

Cheers,
Simon


> -- 
> View this message in context: http://r.789695.n4.nabble.com/where-is-libRmath-a-libRmath-so-tp2216048p2217224.html
> Sent from the R devel mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From edd at debian.org  Fri May 14 23:31:21 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 14 May 2010 16:31:21 -0500
Subject: [Rd] where is libRmath.a & libRmath.so
In-Reply-To: <1273870376657-2217224.post@n4.nabble.com>
References: <1273805272551-2216048.post@n4.nabble.com>
	<4BED010E.1060809@statistik.tu-dortmund.de>
	<1273870376657-2217224.post@n4.nabble.com>
Message-ID: <19437.49449.718188.124304@ron.nulle.part>


On 14 May 2010 at 13:52, Dave Lubbers wrote:
| 
| R 2.7.2 -   the manual says 
| configure
| make
| 
| Which is what I did.  So I did read the manual and followed the directions. 
| The manual is too terse to get me there.

On Debian / Ubuntu, you can also do

   sudo apt-get install r-mathlib

to install this library.

-- 
  Regards, Dirk


From murdoch.duncan at gmail.com  Fri May 14 23:41:35 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 14 May 2010 17:41:35 -0400
Subject: [Rd] where is libRmath.a & libRmath.so
In-Reply-To: <1273870376657-2217224.post@n4.nabble.com>
References: <1273805272551-2216048.post@n4.nabble.com>	<4BED010E.1060809@statistik.tu-dortmund.de>
	<1273870376657-2217224.post@n4.nabble.com>
Message-ID: <4BEDC38F.1040800@gmail.com>

On 14/05/2010 4:52 PM, Dave Lubbers wrote:
> R 2.7.2 -   the manual says 
> configure
> make
>
> Which is what I did.  So I did read the manual and followed the directions. 
> The manual is too terse to get me there.
>   

You used the wrong tense.  In referring to R 2.7.2, only past tenses are 
grammatically correct.

If you want to say "the manual *is* too terse", then you need to install 
R 2.11.0.

Duncan Murdoch


From arne.henningsen at googlemail.com  Sun May 16 22:32:35 2010
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Sun, 16 May 2010 22:32:35 +0200
Subject: [Rd] Creating an S3 method when the generic function is defined
	in another (imported) package
In-Reply-To: <alpine.DEB.2.00.1005141030580.5458@paninaro.uibk.ac.at>
References: <AANLkTikaiAvhirbxKVlUrPvBxxaQLGKvMd1KCE0WW9xE@mail.gmail.com>
	<alpine.DEB.2.00.1005141030580.5458@paninaro.uibk.ac.at>
Message-ID: <AANLkTimYaKN7nS2djCA9h62AmkyJ9U-Kz1w_lXw6t7El@mail.gmail.com>

On 14 May 2010 10:37, Achim Zeileis <Achim.Zeileis at uibk.ac.at> wrote:
> On Fri, 14 May 2010, Arne Henningsen wrote:
>> In one of my packages (maxLik), I would like to add an S3 method,
>> where the generic function (estfun) is defined in another package
>> (sandwich). Everything works fine if my package "Depends" on the other
>> package and I import the generic function "estfun" from the "sandwich"
>> package and define the new method in the NAMESPACE file. However, I
>> prefer not to load the entire other package just to use a single
>> generic function from it. Therefore, I replaced "Depends" by "Imports"
>> in the DESCRIPTION file and (re-)exported "estfun" in the NAMESPACE
>> file. Now "R CMD check" warns about the undocumented code object
>> "estfun" but I do not want to include a duplicate of the documentation
>> of "estfun". Do you know a better solution?
>
> I probably wouldn't re-export the estfun() generic. People will probably
> load "sandwich" anyway before calling estfun(), in particular if they want
> to compute the sandwich() covariance matrix.

That's certainly the best solution for this issue Thanks!
However, I have basically the same problem in another package, where
the method can be (reasonably) applied without loading the package, in
which the generic function is defined. Hence, requiring that the user
loads the other package "by hand" is no solution here. So is there a
better solution than making my package *depend* on the other package
or including a duplicate of the documentation of the generic function?

Thanks a lot,
/Arne

-- 
Arne Henningsen
http://www.arne-henningsen.name


From sahiilseth at gmail.com  Mon May 17 07:53:21 2010
From: sahiilseth at gmail.com (sahil seth)
Date: Mon, 17 May 2010 01:53:21 -0400
Subject: [Rd] R CMD check
Message-ID: <E46813A8-1C3B-4310-93BA-D1B8A19E658F@gmail.com>

Hi,
I have been finding clues on the internet to understand the reason for this warning.
The package i have made, builds, installs and works well, except for this warning when I check it:

When I run:
R CMD check mypack_1.0.tar.gz
... ... .. ..
* checking R code for possible problems ... NOTE
Found possibly global 'T' or 'F' in the following functions:
  HWE procRef readMartFile readPhase2File
.. ... .. 



I have several other functions in the package, but the warning is for this subset. 

I am trying to find a common thing within this subset, and cant figure out one to go after it.

Thanks a lot for the help.


Regards,
Sahil Seth


From pdalgd at gmail.com  Mon May 17 08:46:43 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Mon, 17 May 2010 08:46:43 +0200
Subject: [Rd] R CMD check
In-Reply-To: <E46813A8-1C3B-4310-93BA-D1B8A19E658F@gmail.com>
References: <E46813A8-1C3B-4310-93BA-D1B8A19E658F@gmail.com>
Message-ID: <4BF0E653.3000400@gmail.com>

sahil seth wrote:
> Hi,
> I have been finding clues on the internet to understand the reason for this warning.
> The package i have made, builds, installs and works well, except for this warning when I check it:
> 
> When I run:
> R CMD check mypack_1.0.tar.gz
> ... ... .. ..
> * checking R code for possible problems ... NOTE
> Found possibly global 'T' or 'F' in the following functions:
>   HWE procRef readMartFile readPhase2File
> .. ... .. 
> 
> 
> 
> I have several other functions in the package, but the warning is for this subset. 
> 
> I am trying to find a common thing within this subset, and cant figure out one to go after it.
> 
> Thanks a lot for the help.

Look for spots where you sloppily have used, say, na.rm=T instead of
na.rm=TRUE.

This kind of construction will break if something redefines T/F
globally, hence the warning. (The code checker heuristics first looks a
local definition of T or F, in which case things are fine, or at least
not wrong for this particular reason.)

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From chiefmurphy at gmail.com  Mon May 17 08:51:59 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Sun, 16 May 2010 23:51:59 -0700
Subject: [Rd] format.data.frame containing S4 class with format method
Message-ID: <AANLkTilbXPUqplMtL2TOaca-yhs-tBOjXGUmjvrVtaNk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100516/10239b25/attachment.asc>

From ripley at stats.ox.ac.uk  Mon May 17 10:14:49 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 17 May 2010 09:14:49 +0100 (BST)
Subject: [Rd] format.data.frame containing S4 class with format method
In-Reply-To: <AANLkTilbXPUqplMtL2TOaca-yhs-tBOjXGUmjvrVtaNk@mail.gmail.com>
References: <AANLkTilbXPUqplMtL2TOaca-yhs-tBOjXGUmjvrVtaNk@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.1005170857270.22041@gannet.stats.ox.ac.uk>

On Sun, 16 May 2010, Daniel Murphy wrote:

> Hi again,
>
> I must be misunderstanding something fundamental about how an S4 class
> stored in a data.frame can be persuaded to print according to a desired
> format.

Rather, you are misunderstanding something fundamental about the 
'methods' package.  It is optional, and all unqualified references to 
'generic' and 'method' in other basic packages will be to the original 
S3 concepts (and many predate the 'methods' package).

> The help page says:
>
> format.data.frame formats the data frame column by column, applying the
> appropriate method of format for each column.

So define a 'method', not an 'S4 method'.

You will see that you have defined a function format() in your 
workspace.  That does dispatch S4 methods, but the namespace scoping 
rules protect packages against such masking of base functions.

>
> Here is my class:
>> setClass("A",contains="character")
> [1] "A"
>> a <- new("A", "aaa")
>> a
> An object of class "A"
> [1] "aaa"
>
> I defined my format method to display in uppercase:
>> setMethod("format","A", function(x, ...) toupper(x))
> [1] "format"
>> format(a)
> An object of class "A"
> [1] "AAA"
>
> I looked at the S4 class definition for data.frame (getClass("data.frame"))
> which prompted me to store the instance 'a' into a data.frame as follows:
>> adf<-new("data.frame",list(a), names="a", row.names="1")
>> adf
> Object of class "data.frame"
>    a
> 1 aaa
>
> ... not upper case. The str function clearly shows that the object was
> successfully stored in the data.frame:
>> str(adf)
> 'data.frame':   1 obs. of  1 variable:
> 'data.frame':   1 obs. of  1 variable:
> Formal class 'data.frame' [package "methods"] with 4 slots
>  ..@ .Data    :List of 1
>  .. ..$ :Formal class 'A' [package ".GlobalEnv"] with 1 slots
>  .. .. .. ..@ .Data: chr "aaa"
>  ..@ names    : chr "a"
>  ..@ row.names: chr "1"
>  ..@ .S3Class : chr "data.frame"
>
> Is there another step I should be taking so that "A"'s format method is
> found and used?
>
> Thank you,
>
> Dan Murphy
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bullard at stat.Berkeley.EDU  Tue May 18 03:48:35 2010
From: bullard at stat.Berkeley.EDU (James Bullard)
Date: Mon, 17 May 2010 18:48:35 -0700 (PDT)
Subject: [Rd] difficulties with setMethod("[" and ...
Message-ID: <52612.66.201.56.150.1274147315.squirrel@www.stat.berkeley.edu>

Apologies if I am not understanding something about how things are being
handled when using S4 methods, but I have been unable to find an answer to
my problem for some time now.

Briefly, I am associating the generic '[' with a class which I wrote
(here: myExample). The underlying back-end allows me to read contiguous
slabs, e.g., 1:10, but not c(1, 10). I want to shield the user from this
infelicity, so I grab the slab and then subset in memory. The main problem
is with datasets with dim(.) > 2. In this case, the '...' argument doesn't
seem to be in a reasonable state. When it is indeed missing then it
properly reports that fact, however, when it is not missing it reports
that it is not missing, but then the call to: list(...) throws an argument
is missing exception.

I cannot imagine that this has not occurred before, so I am expecting
someone might be able to point me to some example code. I have attached
some code demonstrating my general problem ((A) and (B) below) as well as
the outline of the sub-selection code. I have to say that coding this has
proven non-trivial and any thoughts on cleaning up the mess are welcome.

As always, thanks for the help.

Jim

require(methods)

setClass('myExample', representation = representation(x = "array"))

myExample <- function(dims = c(1,2)) {
  a <- array(rnorm(prod(dims)))
  dim(a) <- dims
  obj <- new("myExample")
  obj at x <- a
  return(obj)
}

setMethod("dim", "myExample", function(x) return(dim(x at x)))

functionThatCanOnlyGrabContiguous <- function(x, m, kall) {
  kall$x <- x at x
  for (i in 1:nrow(m)) {
    kall[[i+2]] <- seq.int(m[i,1], m[i,2])
  }
  print(as.list(kall))
  return(eval(kall))
}

setMethod("[", "myExample", function(x, i, j, ..., drop = TRUE) {
  if (missing(...)){
    print("Missing!")
  }
  e <- list(...)
  m <- matrix(nrow = length(dim(x)), ncol = 2)

  if (missing(i))
    m[1,] <- c(1, dim(x)[1])
  else
    m[1,] <- range(i)

  if (length(dim(x)) > 1) {
    if (missing(j))
      m[2,] <- c(1, dim(x)[2])
    else
      m[2,] <- range(j)

    k <- 3
    while (k <= nrow(m)) {
      if (k-2 <= length(e))
        m[k,] <- range(e[[k-2]])
      else
        m[k,] <- c(1, dim(x)[k])
      k <- k + 1
    }
  }
  kall <- match.call()
  d <- functionThatCanOnlyGrabContiguous(x, m, kall)

  kall$x <- d
  if (! missing(i)) {
    kall[[3]] <- i - min(i) + 1
  }
  if (! missing(j)) {
    kall[[4]] <- j - min(j) + 1
  } else {
    if (length(dim(x)) > 1)
      kall[[4]] <- seq.int(1, dim(x)[2])
  }
  ## XXX: Have to handle remaining dimensions, but since I can't
  ## really get a clean '...' it is on hold.

  eval(kall)
})

## ############### 1-D
m <- myExample(10)
m at x[c(1,5)] == m[c(1, 5)]

## ############### 2-D
m <- myExample(c(10, 10))
m at x[c(1,5), c(1,5)] == m[c(1,5), c(1,5)]
m at x[c(5, 2),] == m[c(5,2),]

## ############### 3-D
m <- myExample(c(1,3,4))

## (A) doesn't work
m at x[1,1:2,] == m[1,1:2,]

## (B) nor does this for different reasons.
m[1,,1]
m at x[1,,1]

> sessionInfo()
R version 2.11.0 (2010-04-22)
x86_64-pc-linux-gnu

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_2.11.0


From tplate at acm.org  Tue May 18 04:51:12 2010
From: tplate at acm.org (Tony Plate)
Date: Mon, 17 May 2010 20:51:12 -0600
Subject: [Rd] difficulties with setMethod("[" and ...
In-Reply-To: <52612.66.201.56.150.1274147315.squirrel@www.stat.berkeley.edu>
References: <52612.66.201.56.150.1274147315.squirrel@www.stat.berkeley.edu>
Message-ID: <4BF200A0.7090605@acm.org>

Jim, yes, I have dealt with that particular challenge that list(...) 
throws an error for a call like f(x,,,) where the empty args match to a 
... formal argument.   Here's some fragments of code that I used to cope 
with this:

     # to find the empty anon args, must work with the unevaluated dot args
     dot.args.uneval <- match.call(expand.dots=FALSE)$...
     if (length(dot.args.uneval))
         missing.dot.args <- sapply(dot.args.uneval, function(arg) 
is.symbol(arg) && as.character(arg)=="")
     else
         missing.dot.args <- logical(0)
...
     # Now we can work with evaluated dot args.
     # Can't do dot.args <- list(...) because that will
     # stop with an error for missing args.
     dot.args <- mapply(dot.args.uneval, missing.dot.args, 
FUN=function(arg, m) if (!m) eval(arg) else NULL)

Let me know if you need any further explanation.

Several warnings:
* I was using this code with S3 generics and methods.
* There are quite possibly better ways of detecting empty unevaluated 
arguments than 'is.symbol(arg) && as.character(arg)==""'.
* You'll probably want to be careful that the eval() in the last line is 
using the appropriate environment for your application.

I didn't read your code in detail, so apologies if the above is 
off-the-point, but your verbal description of the problem and the coding 
style and comments in the "[" method for "myExample" triggered my memory.

-- Tony Plate

On 05/17/2010 07:48 PM, James Bullard wrote:
> Apologies if I am not understanding something about how things are being
> handled when using S4 methods, but I have been unable to find an answer to
> my problem for some time now.
>
> Briefly, I am associating the generic '[' with a class which I wrote
> (here: myExample). The underlying back-end allows me to read contiguous
> slabs, e.g., 1:10, but not c(1, 10). I want to shield the user from this
> infelicity, so I grab the slab and then subset in memory. The main problem
> is with datasets with dim(.)>  2. In this case, the '...' argument doesn't
> seem to be in a reasonable state. When it is indeed missing then it
> properly reports that fact, however, when it is not missing it reports
> that it is not missing, but then the call to: list(...) throws an argument
> is missing exception.
>
> I cannot imagine that this has not occurred before, so I am expecting
> someone might be able to point me to some example code. I have attached
> some code demonstrating my general problem ((A) and (B) below) as well as
> the outline of the sub-selection code. I have to say that coding this has
> proven non-trivial and any thoughts on cleaning up the mess are welcome.
>
> As always, thanks for the help.
>
> Jim
>
> require(methods)
>
> setClass('myExample', representation = representation(x = "array"))
>
> myExample<- function(dims = c(1,2)) {
>    a<- array(rnorm(prod(dims)))
>    dim(a)<- dims
>    obj<- new("myExample")
>    obj at x<- a
>    return(obj)
> }
>
> setMethod("dim", "myExample", function(x) return(dim(x at x)))
>
> functionThatCanOnlyGrabContiguous<- function(x, m, kall) {
>    kall$x<- x at x
>    for (i in 1:nrow(m)) {
>      kall[[i+2]]<- seq.int(m[i,1], m[i,2])
>    }
>    print(as.list(kall))
>    return(eval(kall))
> }
>
> setMethod("[", "myExample", function(x, i, j, ..., drop = TRUE) {
>    if (missing(...)){
>      print("Missing!")
>    }
>    e<- list(...)
>    m<- matrix(nrow = length(dim(x)), ncol = 2)
>
>    if (missing(i))
>      m[1,]<- c(1, dim(x)[1])
>    else
>      m[1,]<- range(i)
>
>    if (length(dim(x))>  1) {
>      if (missing(j))
>        m[2,]<- c(1, dim(x)[2])
>      else
>        m[2,]<- range(j)
>
>      k<- 3
>      while (k<= nrow(m)) {
>        if (k-2<= length(e))
>          m[k,]<- range(e[[k-2]])
>        else
>          m[k,]<- c(1, dim(x)[k])
>        k<- k + 1
>      }
>    }
>    kall<- match.call()
>    d<- functionThatCanOnlyGrabContiguous(x, m, kall)
>
>    kall$x<- d
>    if (! missing(i)) {
>      kall[[3]]<- i - min(i) + 1
>    }
>    if (! missing(j)) {
>      kall[[4]]<- j - min(j) + 1
>    } else {
>      if (length(dim(x))>  1)
>        kall[[4]]<- seq.int(1, dim(x)[2])
>    }
>    ## XXX: Have to handle remaining dimensions, but since I can't
>    ## really get a clean '...' it is on hold.
>
>    eval(kall)
> })
>
> ## ############### 1-D
> m<- myExample(10)
> m at x[c(1,5)] == m[c(1, 5)]
>
> ## ############### 2-D
> m<- myExample(c(10, 10))
> m at x[c(1,5), c(1,5)] == m[c(1,5), c(1,5)]
> m at x[c(5, 2),] == m[c(5,2),]
>
> ## ############### 3-D
> m<- myExample(c(1,3,4))
>
> ## (A) doesn't work
> m at x[1,1:2,] == m[1,1:2,]
>
> ## (B) nor does this for different reasons.
> m[1,,1]
> m at x[1,,1]
>
>    
>> sessionInfo()
>>      
> R version 2.11.0 (2010-04-22)
> x86_64-pc-linux-gnu
>
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>   [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tools_2.11.0
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>


From maechler at stat.math.ethz.ch  Tue May 18 10:22:03 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 18 May 2010 10:22:03 +0200
Subject: [Rd] difficulties with setMethod("[" and ...
In-Reply-To: <4BF200A0.7090605@acm.org>
References: <52612.66.201.56.150.1274147315.squirrel@www.stat.berkeley.edu>
	<4BF200A0.7090605@acm.org>
Message-ID: <19442.20011.221424.759459@lynne.math.ethz.ch>

>>>>> Tony Plate <tplate at acm.org>
>>>>>     on Mon, 17 May 2010 20:51:12 -0600 writes:

    > Jim, yes, I have dealt with that particular challenge that list(...) 
    > throws an error for a call like f(x,,,) where the empty args match to a 
    > ... formal argument.   Here's some fragments of code that I used to cope 
    > with this:

    > # to find the empty anon args, must work with the unevaluated dot args
    > dot.args.uneval <- match.call(expand.dots=FALSE)$...
    > if (length(dot.args.uneval))
    > missing.dot.args <- sapply(dot.args.uneval, function(arg) 
    > is.symbol(arg) && as.character(arg)=="")
    > else
    > missing.dot.args <- logical(0)
    > ...
    > # Now we can work with evaluated dot args.
    > # Can't do dot.args <- list(...) because that will
    > # stop with an error for missing args.
    > dot.args <- mapply(dot.args.uneval, missing.dot.args, 
    > FUN=function(arg, m) if (!m) eval(arg) else NULL)

I don't have much time at the moment, to delve into Jim's code,
nor to analyze what exactly Tony's does.

Some notes however which I deem important:

1) My experiece in writing many S4 methods for "["  -- with the
   Matrix package, but also for 'Rmpfr' -- is that you 
   really need to work  with  nargs()
   rather than with things like  length(list(...))

2) If you really want to be compatible to the very rich
   semantics of S and R subsetting, you need to spend more time
   than you anticipate.

   - negative subscripts, names, logicals
   
   - A[i]  for an array A   where i can be a vector and then the
     array is treated as if it had no dim() attribute
   - A[i]  for an array A   where i is a *matrix* with k columns
     	   where  k <- length(dim(A))  --- (k = 2 for matrices)
   - A[]
   ....

  Are you sure you would not try to use
    setClass('myExample', contains = "array", representation = ...)
  rather than your
    setClass('myExample', representation(x = "array", ...))
  ?
  You would get all the "[" (and other array methods) for free,
  and would only need to specify those methods where 'myExample'
  really differed from array-subsetting.

3) Lots of well-tested    setMethod("[", ....)  examples
   are in the sources of the Matrix package.

   There, BTW, I found it useful to use

  ## for 'i' in x[i] or A[i,] : (numeric = {double, integer})
  setClassUnion("index", members =  c("numeric", "logical", "character"))

 and then, e.g.,  a simple example method ..

  setMethod("[", signature(x = "denseMatrix", i = "index", j = "missing",
			   drop = "logical"),
	    function (x, i, j, ..., drop) {
		if((na <- nargs()) == 3)
		    r <- as(x, "matrix")[i, drop=drop]
		else if(na == 4)
		    r <- as(x, "matrix")[i, , drop=drop]
		else stop("invalid nargs()= ",na)
		if(is.null(dim(r))) r else as(r, geClass(x))
	    })
   
  The examples in the "Rmpfr" package are much less and simpler.

  To find the methods, for both, use  
      fgrep 'setMethod("["' R/*R
  if you are on a decent OS and in side the package source directory.
 
--
Martin Maechler, ETH Zurich

    > Let me know if you need any further explanation.

    > Several warnings:
    > * I was using this code with S3 generics and methods.
    > * There are quite possibly better ways of detecting empty unevaluated 
    > arguments than 'is.symbol(arg) && as.character(arg)==""'.
    > * You'll probably want to be careful that the eval() in the last line is 
    > using the appropriate environment for your application.

    > I didn't read your code in detail, so apologies if the above is 
    > off-the-point, but your verbal description of the problem and the coding 
    > style and comments in the "[" method for "myExample" triggered my memory.

    > -- Tony Plate

    > On 05/17/2010 07:48 PM, James Bullard wrote:
    >> Apologies if I am not understanding something about how things are being
    >> handled when using S4 methods, but I have been unable to find an answer to
    >> my problem for some time now.
    >> 
    >> Briefly, I am associating the generic '[' with a class which I wrote
    >> (here: myExample). The underlying back-end allows me to read contiguous
    >> slabs, e.g., 1:10, but not c(1, 10). I want to shield the user from this
    >> infelicity, so I grab the slab and then subset in memory. The main problem
    >> is with datasets with dim(.)>  2. In this case, the '...' argument doesn't
    >> seem to be in a reasonable state. When it is indeed missing then it
    >> properly reports that fact, however, when it is not missing it reports
    >> that it is not missing, but then the call to: list(...) throws an argument
    >> is missing exception.
    >> 
    >> I cannot imagine that this has not occurred before, so I am expecting
    >> someone might be able to point me to some example code. I have attached
    >> some code demonstrating my general problem ((A) and (B) below) as well as
    >> the outline of the sub-selection code. I have to say that coding this has
    >> proven non-trivial and any thoughts on cleaning up the mess are welcome.
    >> 
    >> As always, thanks for the help.
    >> 
    >> Jim
    >> 
    >> require(methods)
    >> 
    >> setClass('myExample', representation = representation(x = "array"))
    >> 
    >> myExample<- function(dims = c(1,2)) {
    >> a<- array(rnorm(prod(dims)))
    >> dim(a)<- dims
    >> obj<- new("myExample")
    >> obj at x<- a
    >> return(obj)
    >> }
    >> 
    >> setMethod("dim", "myExample", function(x) return(dim(x at x)))
    >> 
    >> functionThatCanOnlyGrabContiguous<- function(x, m, kall) {
    >> kall$x<- x at x
    >> for (i in 1:nrow(m)) {
    >> kall[[i+2]]<- seq.int(m[i,1], m[i,2])
    >> }
    >> print(as.list(kall))
    >> return(eval(kall))
    >> }
    >> 
    >> setMethod("[", "myExample", function(x, i, j, ..., drop = TRUE) {
    >> if (missing(...)){
    >> print("Missing!")
    >> }
    >> e<- list(...)
    >> m<- matrix(nrow = length(dim(x)), ncol = 2)
    >> 
    >> if (missing(i))
    >> m[1,]<- c(1, dim(x)[1])
    >> else
    >> m[1,]<- range(i)
    >> 
    >> if (length(dim(x))>  1) {
    >> if (missing(j))
    >> m[2,]<- c(1, dim(x)[2])
    >> else
    >> m[2,]<- range(j)
    >> 
    >> k<- 3
    >> while (k<= nrow(m)) {
    >> if (k-2<= length(e))
    >> m[k,]<- range(e[[k-2]])
    >> else
    >> m[k,]<- c(1, dim(x)[k])
    >> k<- k + 1
    >> }
    >> }
    >> kall<- match.call()
    >> d<- functionThatCanOnlyGrabContiguous(x, m, kall)
    >> 
    >> kall$x<- d
    >> if (! missing(i)) {
    >> kall[[3]]<- i - min(i) + 1
    >> }
    >> if (! missing(j)) {
    >> kall[[4]]<- j - min(j) + 1
    >> } else {
    >> if (length(dim(x))>  1)
    >> kall[[4]]<- seq.int(1, dim(x)[2])
    >> }
    >> ## XXX: Have to handle remaining dimensions, but since I can't
    >> ## really get a clean '...' it is on hold.
    >> 
    >> eval(kall)
    >> })
    >> 
    >> ## ############### 1-D
    >> m<- myExample(10)
    >> m at x[c(1,5)] == m[c(1, 5)]
    >> 
    >> ## ############### 2-D
    >> m<- myExample(c(10, 10))
    >> m at x[c(1,5), c(1,5)] == m[c(1,5), c(1,5)]
    >> m at x[c(5, 2),] == m[c(5,2),]
    >> 
    >> ## ############### 3-D
    >> m<- myExample(c(1,3,4))
    >> 
    >> ## (A) doesn't work
    >> m at x[1,1:2,] == m[1,1:2,]
    >> 
    >> ## (B) nor does this for different reasons.
    >> m[1,,1]
    >> m at x[1,,1]
    >> 
    >> 
    >>> sessionInfo()
    >>> 
    >> R version 2.11.0 (2010-04-22)
    >> x86_64-pc-linux-gnu
    >> 
    >> locale:
    >> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
    >> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
    >> [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
    >> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
    >> [9] LC_ADDRESS=C               LC_TELEPHONE=C
    >> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
    >> 
    >> attached base packages:
    >> [1] stats     graphics  grDevices utils     datasets  methods   base
    >> 
    >> loaded via a namespace (and not attached):
    >> [1] tools_2.11.0
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> 
    >> 

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Tue May 18 13:05:27 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 18 May 2010 13:05:27 +0200
Subject: [Rd] BIC() in "stats" {was [R-sig-ME] how to extract the BIC value}
In-Reply-To: <19442.28129.658401.419154@lynne.math.ethz.ch>
References: <755356.74318.qm@web113511.mail.gq1.yahoo.com>
	<4BF12058.1020108@sbg.ac.at>
	<AANLkTikIEd8hiz01rMDahqycM5poFIYr7ZSYFyZrlWa0@mail.gmail.com>
	<AANLkTiluh9FUnMWdfArmI7yGSUDRGmv_rngc_qztvmL5@mail.gmail.com>
	<19442.28129.658401.419154@lynne.math.ethz.ch>
Message-ID: <19442.29815.854237.706135@lynne.math.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Tue, 18 May 2010 12:37:21 +0200 writes:

>>>>> "GaGr" == Gabor Grothendieck <ggrothendieck at gmail.com>
>>>>>     on Mon, 17 May 2010 09:45:00 -0400 writes:

    GaGr> BIC seems like something that would logically go into stats in the
    GaGr> core of R, as AIC is already, and then various packages could define
    GaGr> methods for it.

    MM> Well, if you look at help(AIC):

    >> Usage:

    >> AIC(object, ..., k = 2)

    >> Arguments:

    >> object: a fitted model object, for which there exists a ?logLik?
    >> method to extract the corresponding log-likelihood, or an
    >> object inheriting from class ?logLik?.

    >> ...: optionally more fitted model objects.

    >> k: numeric, the _penalty_ per parameter to be used; the default
    >> ?k = 2? is the classical AIC.

    MM> you may note that the original authors of AIC where always
    MM> allowing the AIC() function (and its methods) to compute the BIC,
    MM> simply by using 'k = log(n)' where of course n  must be correct.

    MM> I do like the concept that BIC is just a variation of AIC and
    MM> AFAIK, AIC was really first (historically).

    MM> Typically (and with lme4), the 'n' needed is already part of the logLik()
    MM> attributes :

    >> AIC((ll <- logLik(fm1)), k = log(attr(ll,"nobs")))
    MM> REML 
    MM> 1774.786 

    MM> indeed gives the BIC (where the "REML" name may or may not be a
    MM> bit overkill)


    MM> A stats-package based  BIC function could then simply be defined as

    > BIC <- function (object, ...) UseMethod("BIC")

    > BIC.default <- function (object, ...) BIC(logLik(object), ...)

    > BIC.logLik <- function (object, ...) 
    >    AIC(object, ..., k = log(attr(object,"nobs")))

 {well, modulo the fact that "..." should really allow to do
  this for *several* models simultaneously}

In addition to that (and more replying to Doug Bates):

Given nlme's tradition of explicitly providing BIC(), and in
analogue to the S3 semantics of the AIC() methods,

- I think lme4 (and "lme4a" on R-forge) should end up having
  working  AIC() and BIC() directly for fitted models, instead of
  having to use
	 AIC(logLik(.))   and    BIC(logLik(.))

  The reason that even the first of this currently does *not*
  work is that lme4 imports AIC from "stats" but should do so
  from "stats4".
  --> I'm about to change that for 'lme4' (and 'lme4a').
    
  However, for the BIC case, ... see below


- I tend to agree with Gabor (for once! :-)  that
  basic BIC methods (S3, alas) should move from  nlme to stats.
  
  For this reason, I'm breaking the rule of "do not cross-post"
  for once, and am hereby diverting this thread to R-devel

Martin


    MM> --
    MM> Martin Maechler, ETH Zurich

    GaGr> On Mon, May 17, 2010 at 9:29 AM, Douglas Bates <bates at stat.wisc.edu> wrote:
    >>> On Mon, May 17, 2010 at 5:54 AM, Andy Fugard (Work)
    >>> <andy.fugard at sbg.ac.at> wrote:
    >>>> Greetings,
    >>>> 
    >>>> Assuming you're using lmer, here's an example which does what you need:
    >>>> 
    >>>>> (fm1 ? ?<- lmer(Reaction ~ Days + (Days|Subject), sleepstudy))
    >>>> Linear mixed model fit by REML
    >>>> Formula: Reaction ~ Days + (Days | Subject)
    >>>> ? Data: sleepstudy
    >>>> ?AIC ?BIC logLik deviance REMLdev
    >>>> ?1756 1775 -871.8 ? ? 1752 ? ?1744
    >>>> Random effects:
    >>>> ?Groups ? Name ? ? ? ?Variance Std.Dev. Corr
    >>>> ?Subject ?(Intercept) 612.092 ?24.7405
    >>>> ? ? ? ? ?Days ? ? ? ? 35.072 ? 5.9221 ?0.066
    >>>> ?Residual ? ? ? ? ? ? 654.941 ?25.5918
    >>>> Number of obs: 180, groups: Subject, 18
    >>>> 
    >>>> Fixed effects:
    >>>> ? ? ? ? ? ?Estimate Std. Error t value
    >>>> (Intercept) ?251.405 ? ? ?6.825 ? 36.84
    >>>> Days ? ? ? ? ?10.467 ? ? ?1.546 ? ?6.77
    >>>> 
    >>>> Correlation of Fixed Effects:
    >>>> ? ? (Intr)
    >>>> Days -0.138
    >>>> 
    >>>>> (fm1fit <- summary(fm1)@AICtab)
    >>>> ? ? ?AIC ? ? ?BIC ? ?logLik deviance ?REMLdev
    >>>> ?1755.628 1774.786 -871.8141 1751.986 1743.628
    >>>> 
    >>>>> fm1fit$BIC
    >>>> [1] 1774.786
    >>> 
    >>> That's one way of doing it but it relies on a particular
    >>> representation of the object returned by summary, and that is subject
    >>> to change.
    >>> 
    >>> I had thought that it would work to use
    >>> 
    >>> BIC(logLik(fm1))
    >>> 
    >>> but that doesn't because the BIC function is imported from the nlme
    >>> package but not later exported. ?The situation is rather tricky - at
    >>> one point I defined a generic for BIC in the lme4 package but that led
    >>> to conflicts when multiple packages defined different versions. ?The
    >>> order in which the packages were loaded became important in
    >>> determining which version was used.
    >>> 
    >>> We agreed to use the generic from the nlme package, which is what is
    >>> now done. ?However, I don't want to make the entire nlme package
    >>> visible when you have loaded lme4 because of resulting conflicts.
    >>> 
    >>> I can get the result as
    >>> 
    >>>> (fm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy))
    >>> Linear mixed model fit by REML
    >>> Formula: Reaction ~ Days + (Days | Subject)
    >>> ? Data: sleepstudy
    >>> ?AIC ?BIC logLik deviance REMLdev
    >>> ?1756 1775 -871.8 ? ? 1752 ? ?1744
    >>> Random effects:
    >>> ?Groups ? Name ? ? ? ?Variance Std.Dev. Corr
    >>> ?Subject ?(Intercept) 612.090 ?24.7405
    >>> ? ? ? ? ?Days ? ? ? ? 35.072 ? 5.9221 ?0.066
    >>> ?Residual ? ? ? ? ? ? 654.941 ?25.5918
    >>> Number of obs: 180, groups: Subject, 18
    >>> 
    >>> Fixed effects:
    >>> ? ? ? ? ? ?Estimate Std. Error t value
    >>> (Intercept) ?251.405 ? ? ?6.825 ? 36.84
    >>> Days ? ? ? ? ?10.467 ? ? ?1.546 ? ?6.77
    >>> 
    >>> Correlation of Fixed Effects:
    >>> ? ? (Intr)
    >>> Days -0.138
    >>>> nlme:::BIC(logLik(fm1))
    >>> ? ?REML
    >>> 1774.786
    >>> 
    >>> but that is unintuitive. ?I am not sure what the best approach is.
    >>> Perhaps Martin (or anyone else who knows namespace intricacies) can
    >>> suggest something.
    >>> 
    >>> 
    >>>> Tahira Jamil wrote:
    >>>>> Hi
    >>>>> I can extract the AIC value of a model like this
    >>>>> 
    >>>>> AIC(logLik(fm0)
    >>>>> 
    >>>>> How can I extract the BIC value if I need!
    >>>>> 
    >>>>> Cheers
    >>>>> Tahira
    >>>>> Biometris
    >>>>> Wageningen University
    >>>>> 
    >>>>> _______________________________________________
    >>>>> R-sig-mixed-models at r-project.org mailing list
    >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
    >>>> 
    >>>> 
    >>>> --
    >>>> Andy Fugard, Postdoctoral researcher, ESF LogICCC project
    >>>> "Modeling human inference within the framework of probability logic"
    >>>> Department of Psychology, University of Salzburg, Austria
    >>>> http://www.andyfugard.info
    >>>>


From kasperdanielhansen at gmail.com  Tue May 18 17:59:38 2010
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Tue, 18 May 2010 11:59:38 -0400
Subject: [Rd] 00LOCK and nfs
In-Reply-To: <4BD6F661.10409@acm.org>
References: <s2le780c0971004260815we5156859v293d5b3a6ffd9890@mail.gmail.com>
	<l2kc0177e5a1004261054k3775628fyb6c1fd154707dd91@mail.gmail.com>
	<y2le780c0971004261205i39f069dt379690211f8f8a7f@mail.gmail.com>
	<4BD6F661.10409@acm.org>
Message-ID: <AANLkTikhZwblSL_MyLTmqbsD5R61vhDa0l-o9lcw0caT@mail.gmail.com>

This is a follow-up to an old thread with kind of solution to the
00LOCK problem on NFS.

I have made a patch to install.packages to accept a new argument
  locktype = c("lock", "no-lock", "pkglock")
which is passed to R CMD INSTALL.  This addition might have
independent interest aside from the NFS problem, as it exposes
functionality from R CMD INSTALL to install.packages and the very
convenient update.packages.  Patches are at
  http://www.biostat.jhsph.edu/~khansen/packages2.R-patch
  http://www.biostat.jhsph.edu/~khansen/install.packages.Rd-patch
(patches to files in the utils package) and both
  R-devel (R version 2.12.0 Under development (unstable) (2010-05-17 r52025))
and
  R-2.11 (R version 2.11.0 Patched (2010-05-17 r52025))
passed make check-all with these two patches applied.  I thought about
adding a note describing my findings below to the details section, but
decided against it.

Regarding the 00LOCK problem.  In my testing, using the patches above
and setting locktype = "pkglock", makes it possible to deal with the
NFS problem.  Specifically, I have not been able to make
update.packages() fail midway, due to a un-removable 00LOCK file
(which is not too surprising, as I now have a per-package lock).

However, sometimes (but far less frequently than before), a
00LOCK-pkgname directory remains after update/install.packages.
Sometimes this 00LOCK-pkgname directory does not contain any .nfs*
files (!?) and sometimes it does. For this reason, I still precede any
install/update.packages with a check for the existence of a
00LOCK-pkgname directory and an attempt to remove it.

The difference between using locktype = "pkglock" and not is
specifically that without, it was possible for update.packages to fail
midway even though there were no 00LOCK* files at the start of the
update process.

Originally I hypothesized that the presence of the .nfs* files in the
00LOCK directory had to do with synchronization issues between the
file server and the compute node.  In order to approach this I tried
to insert a
  system("sleep 10")
at the beginning of
  do_cleanup
in
  tools/R/install.R
but that did not work.

Since the pkglock approach described above seems to solve this issue
for me, I have not pursued the synchronization issue further.

Kasper


From maechler at stat.math.ethz.ch  Tue May 18 18:01:50 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 18 May 2010 18:01:50 +0200
Subject: [Rd] BIC() in "stats" {was [R-sig-ME] how to extract the BIC
	value}
In-Reply-To: <19442.29815.854237.706135@lynne.math.ethz.ch>
References: <755356.74318.qm@web113511.mail.gq1.yahoo.com>
	<4BF12058.1020108@sbg.ac.at>
	<AANLkTikIEd8hiz01rMDahqycM5poFIYr7ZSYFyZrlWa0@mail.gmail.com>
	<AANLkTiluh9FUnMWdfArmI7yGSUDRGmv_rngc_qztvmL5@mail.gmail.com>
	<19442.28129.658401.419154@lynne.math.ethz.ch>
	<19442.29815.854237.706135@lynne.math.ethz.ch>
Message-ID: <19442.47598.761745.767011@lynne.math.ethz.ch>


Adding to my own statements  (below) :

>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Tue, 18 May 2010 13:05:27 +0200 writes:

>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Tue, 18 May 2010 12:37:21 +0200 writes:

>>>>> "GaGr" == Gabor Grothendieck <ggrothendieck at gmail.com>
>>>>>     on Mon, 17 May 2010 09:45:00 -0400 writes:

    GaGr> BIC seems like something that would logically go into stats in the
    GaGr> core of R, as AIC is already, and then various packages could define
    GaGr> methods for it.

    MM> Well, if you look at help(AIC):

    >>> Usage:

    >>> AIC(object, ..., k = 2)

    >>> Arguments:

    >>> object: a fitted model object, for which there exists a ?logLik?
    >>> method to extract the corresponding log-likelihood, or an
    >>> object inheriting from class ?logLik?.

    >>> ...: optionally more fitted model objects.

    >>> k: numeric, the _penalty_ per parameter to be used; the default
    >>> ?k = 2? is the classical AIC.

    MM> you may note that the original authors of AIC where always
    MM> allowing the AIC() function (and its methods) to compute the BIC,
    MM> simply by using 'k = log(n)' where of course n  must be correct.

    MM> I do like the concept that BIC is just a variation of AIC and
    MM> AFAIK, AIC was really first (historically).

    MM> Typically (and with lme4), the 'n' needed is already part of the logLik()
    MM> attributes :

    >>> AIC((ll <- logLik(fm1)), k = log(attr(ll,"nobs")))
    MM> REML 
    MM> 1774.786 

    MM> indeed gives the BIC (where the "REML" name may or may not be a
    MM> bit overkill)


    MM> A stats-package based  BIC function could then simply be defined as

    >> BIC <- function (object, ...) UseMethod("BIC")

    >> BIC.default <- function (object, ...) BIC(logLik(object), ...)

    >> BIC.logLik <- function (object, ...) 
    >> AIC(object, ..., k = log(attr(object,"nobs")))

    MM> {well, modulo the fact that "..." should really allow to do
    MM> this for *several* models simultaneously}

    MM> In addition to that (and more replying to Doug Bates):

    MM> Given nlme's tradition of explicitly providing BIC(), and in
    MM> analogue to the S3 semantics of the AIC() methods,

    MM> - I think lme4 (and "lme4a" on R-forge) should end up having
    MM> working  AIC() and BIC() directly for fitted models, instead of
    MM> having to use
    MM> AIC(logLik(.))   and    BIC(logLik(.))

    MM> The reason that even the first of this currently does *not*
    MM> work is that lme4 imports AIC from "stats" but should do so
    MM> from "stats4".
    MM> --> I'm about to change that for 'lme4' (and 'lme4a').
    
    MM> However, for the BIC case, ... see below


    MM> - I tend to agree with Gabor (for once! :-)  that
    MM> basic BIC methods (S3, alas) should move from  nlme to stats.
  
    MM> For this reason, I'm breaking the rule of "do not cross-post"
    MM> for once, and am hereby diverting this thread to R-devel

What I *did* find is that the  stats4   package has already had
all necessary BIC methods -- S4, not S3.

So for lme4 (and R-forge's "lme4a"),
I've only needed to change the NAMESPACE file to have both

  importFrom("stats4", AIC, BIC, logLik)# so S4 methods are used!

and later 

  export(AIC, BIC, 
         .....)

and also add 'stats4' to the 'Imports: ' line in DESCRIPTION.

So both (development versions of) lme4 and lme4a  now have
working AIC() and BIC(),
and I guess Doug could release a new version of lme4 (not .."a")
pretty soon.

I got private e-mail suggestions for extensive S3 methods for
AIC, BIC and logLik.  
I think these should happen more in public (i.e. here, on
R-devel), and while I still advocate that a BIC S3 generic +
simple default methods should be added (as above),
I'd be happy if others joined into the discussion,
(and possibly provided simple patches).

Martin Maechler, ETH Zurich

    GaGr> On Mon, May 17, 2010 at 9:29 AM, Douglas Bates <bates at stat.wisc.edu> wrote:
    >>>> On Mon, May 17, 2010 at 5:54 AM, Andy Fugard (Work)
    >>>> <andy.fugard at sbg.ac.at> wrote:
    >>>>> Greetings,
    >>>>> 
    >>>>> Assuming you're using lmer, here's an example which does what you need:
    >>>>> 
    >>>>>> (fm1 ? ?<- lmer(Reaction ~ Days + (Days|Subject), sleepstudy))
    >>>>> Linear mixed model fit by REML
    >>>>> Formula: Reaction ~ Days + (Days | Subject)
    >>>>> ? Data: sleepstudy
    >>>>> ?AIC ?BIC logLik deviance REMLdev
    >>>>> ?1756 1775 -871.8 ? ? 1752 ? ?1744
    >>>>> Random effects:
    >>>>> ?Groups ? Name ? ? ? ?Variance Std.Dev. Corr
    >>>>> ?Subject ?(Intercept) 612.092 ?24.7405
    >>>>> ? ? ? ? ?Days ? ? ? ? 35.072 ? 5.9221 ?0.066
    >>>>> ?Residual ? ? ? ? ? ? 654.941 ?25.5918
    >>>>> Number of obs: 180, groups: Subject, 18
    >>>>> 
    >>>>> Fixed effects:
    >>>>> ? ? ? ? ? ?Estimate Std. Error t value
    >>>>> (Intercept) ?251.405 ? ? ?6.825 ? 36.84
    >>>>> Days ? ? ? ? ?10.467 ? ? ?1.546 ? ?6.77
    >>>>> 
    >>>>> Correlation of Fixed Effects:
    >>>>> ? ? (Intr)
    >>>>> Days -0.138
    >>>>> 
    >>>>>> (fm1fit <- summary(fm1)@AICtab)
    >>>>> ? ? ?AIC ? ? ?BIC ? ?logLik deviance ?REMLdev
    >>>>> ?1755.628 1774.786 -871.8141 1751.986 1743.628
    >>>>> 
    >>>>>> fm1fit$BIC
    >>>>> [1] 1774.786
    >>>> 
    >>>> That's one way of doing it but it relies on a particular
    >>>> representation of the object returned by summary, and that is subject
    >>>> to change.
    >>>> 
    >>>> I had thought that it would work to use
    >>>> 
    >>>> BIC(logLik(fm1))
    >>>> 
    >>>> but that doesn't because the BIC function is imported from the nlme
    >>>> package but not later exported. ?The situation is rather tricky - at
    >>>> one point I defined a generic for BIC in the lme4 package but that led
    >>>> to conflicts when multiple packages defined different versions. ?The
    >>>> order in which the packages were loaded became important in
    >>>> determining which version was used.
    >>>> 
    >>>> We agreed to use the generic from the nlme package, which is what is
    >>>> now done. ?However, I don't want to make the entire nlme package
    >>>> visible when you have loaded lme4 because of resulting conflicts.
    >>>> 
    >>>> I can get the result as
    >>>> 
    >>>>> (fm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy))
    >>>> Linear mixed model fit by REML
    >>>> Formula: Reaction ~ Days + (Days | Subject)
    >>>> ? Data: sleepstudy
    >>>> ?AIC ?BIC logLik deviance REMLdev
    >>>> ?1756 1775 -871.8 ? ? 1752 ? ?1744
    >>>> Random effects:
    >>>> ?Groups ? Name ? ? ? ?Variance Std.Dev. Corr
    >>>> ?Subject ?(Intercept) 612.090 ?24.7405
    >>>> ? ? ? ? ?Days ? ? ? ? 35.072 ? 5.9221 ?0.066
    >>>> ?Residual ? ? ? ? ? ? 654.941 ?25.5918
    >>>> Number of obs: 180, groups: Subject, 18
    >>>> 
    >>>> Fixed effects:
    >>>> ? ? ? ? ? ?Estimate Std. Error t value
    >>>> (Intercept) ?251.405 ? ? ?6.825 ? 36.84
    >>>> Days ? ? ? ? ?10.467 ? ? ?1.546 ? ?6.77
    >>>> 
    >>>> Correlation of Fixed Effects:
    >>>> ? ? (Intr)
    >>>> Days -0.138
    >>>>> nlme:::BIC(logLik(fm1))
    >>>> ? ?REML
    >>>> 1774.786
    >>>> 
    >>>> but that is unintuitive. ?I am not sure what the best approach is.
    >>>> Perhaps Martin (or anyone else who knows namespace intricacies) can
    >>>> suggest something.
    >>>> 
    >>>> 
    >>>>> Tahira Jamil wrote:
    >>>>>> Hi
    >>>>>> I can extract the AIC value of a model like this
    >>>>>> 
    >>>>>> AIC(logLik(fm0)
    >>>>>> 
    >>>>>> How can I extract the BIC value if I need!
    >>>>>> 
    >>>>>> Cheers
    >>>>>> Tahira
    >>>>>> Biometris
    >>>>>> Wageningen University
    >>>>>> 
    >>>>>> _______________________________________________
    >>>>>> R-sig-mixed-models at r-project.org mailing list
    >>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
    >>>>> 
    >>>>> 
    >>>>> --
    >>>>> Andy Fugard, Postdoctoral researcher, ESF LogICCC project
    >>>>> "Modeling human inference within the framework of probability logic"
    >>>>> Department of Psychology, University of Salzburg, Austria
    >>>>> http://www.andyfugard.info
    >>>>> 

    MM> ______________________________________________
    MM> R-devel at r-project.org mailing list
    MM> https://stat.ethz.ch/mailman/listinfo/r-devel


From bullard at stat.berkeley.edu  Tue May 18 19:02:31 2010
From: bullard at stat.berkeley.edu (Jim Bullard)
Date: Tue, 18 May 2010 10:02:31 -0700
Subject: [Rd] difficulties with setMethod("[" and ...
In-Reply-To: <19442.20011.221424.759459@lynne.math.ethz.ch>
References: <52612.66.201.56.150.1274147315.squirrel@www.stat.berkeley.edu>
	<4BF200A0.7090605@acm.org>
	<19442.20011.221424.759459@lynne.math.ethz.ch>
Message-ID: <add75d669e091cba7a38e38ef47ac3ff@berkeley.edu>

On Tue, 18 May 2010 10:22:03 +0200, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Tony Plate <tplate at acm.org>
>>>>>>     on Mon, 17 May 2010 20:51:12 -0600 writes:
> 
>     > Jim, yes, I have dealt with that particular challenge that
list(...) 
>     > throws an error for a call like f(x,,,) where the empty args match
>     > to a
>     > ... formal argument.   Here's some fragments of code that I used
to
>     > cope
>     > with this:
> 
>     > # to find the empty anon args, must work with the unevaluated dot
>     > args
>     > dot.args.uneval <- match.call(expand.dots=FALSE)$...
>     > if (length(dot.args.uneval))
>     > missing.dot.args <- sapply(dot.args.uneval, function(arg) 
>     > is.symbol(arg) && as.character(arg)=="")
>     > else
>     > missing.dot.args <- logical(0)
>     > ...
>     > # Now we can work with evaluated dot args.
>     > # Can't do dot.args <- list(...) because that will
>     > # stop with an error for missing args.
>     > dot.args <- mapply(dot.args.uneval, missing.dot.args, 
>     > FUN=function(arg, m) if (!m) eval(arg) else NULL)
> 
> I don't have much time at the moment, to delve into Jim's code,
> nor to analyze what exactly Tony's does.
> 
> Some notes however which I deem important:
> 
> 1) My experiece in writing many S4 methods for "["  -- with the
>    Matrix package, but also for 'Rmpfr' -- is that you 
>    really need to work  with  nargs()
>    rather than with things like  length(list(...))
> 
> 2) If you really want to be compatible to the very rich
>    semantics of S and R subsetting, you need to spend more time
>    than you anticipate.
> 
>    - negative subscripts, names, logicals
>    
>    - A[i]  for an array A   where i can be a vector and then the
>      array is treated as if it had no dim() attribute
>    - A[i]  for an array A   where i is a *matrix* with k columns
>      	   where  k <- length(dim(A))  --- (k = 2 for matrices)
>    - A[]
>    ....
> 

I might not get all of the way, but random access and logical subsetting
seem very doable. 


>   Are you sure you would not try to use
>     setClass('myExample', contains = "array", representation = ...)
>   rather than your
>     setClass('myExample', representation(x = "array", ...))
>   ?
>   You would get all the "[" (and other array methods) for free,
>   and would only need to specify those methods where 'myExample'
>   really differed from array-subsetting.

My example is completely contrived. My back end are hdf5 files and so the
'[' method calls C functions, which at the moment grab contiguous blocks. 


> 
> 3) Lots of well-tested    setMethod("[", ....)  examples
>    are in the sources of the Matrix package.
> 
>    There, BTW, I found it useful to use
> 
>   ## for 'i' in x[i] or A[i,] : (numeric = {double, integer})
>   setClassUnion("index", members =  c("numeric", "logical",
"character"))
> 
>  and then, e.g.,  a simple example method ..
> 
>   setMethod("[", signature(x = "denseMatrix", i = "index", j =
"missing",
> 			   drop = "logical"),
> 	    function (x, i, j, ..., drop) {
> 		if((na <- nargs()) == 3)
> 		    r <- as(x, "matrix")[i, drop=drop]
> 		else if(na == 4)
> 		    r <- as(x, "matrix")[i, , drop=drop]
> 		else stop("invalid nargs()= ",na)
> 		if(is.null(dim(r))) r else as(r, geClass(x))
> 	    })
>    
>   The examples in the "Rmpfr" package are much less and simpler.
> 
>   To find the methods, for both, use  
>       fgrep 'setMethod("["' R/*R
>   if you are on a decent OS and in side the package source directory.
>  

Thanks, I had briefly scanned the matrix package - and the pointer to
nargs is extremely helpful.


thanks again, jim


> --
> Martin Maechler, ETH Zurich
> 
>     > Let me know if you need any further explanation.
> 
>     > Several warnings:
>     > * I was using this code with S3 generics and methods.
>     > * There are quite possibly better ways of detecting empty
>     > unevaluated
>     > arguments than 'is.symbol(arg) && as.character(arg)==""'.
>     > * You'll probably want to be careful that the eval() in the last
>     > line is
>     > using the appropriate environment for your application.
> 
>     > I didn't read your code in detail, so apologies if the above is 
>     > off-the-point, but your verbal description of the problem and the
>     > coding
>     > style and comments in the "[" method for "myExample" triggered my
>     > memory.
> 
>     > -- Tony Plate
> 
>     > On 05/17/2010 07:48 PM, James Bullard wrote:
>     >> Apologies if I am not understanding something about how things
are
>     >> being
>     >> handled when using S4 methods, but I have been unable to find an
>     >> answer to
>     >> my problem for some time now.
>     >> 
>     >> Briefly, I am associating the generic '[' with a class which I
wrote
>     >> (here: myExample). The underlying back-end allows me to read
>     >> contiguous
>     >> slabs, e.g., 1:10, but not c(1, 10). I want to shield the user
from
>     >> this
>     >> infelicity, so I grab the slab and then subset in memory. The
main
>     >> problem
>     >> is with datasets with dim(.)>  2. In this case, the '...'
argument
>     >> doesn't
>     >> seem to be in a reasonable state. When it is indeed missing then
it
>     >> properly reports that fact, however, when it is not missing it
>     >> reports
>     >> that it is not missing, but then the call to: list(...) throws an
>     >> argument
>     >> is missing exception.
>     >> 
>     >> I cannot imagine that this has not occurred before, so I am
>     >> expecting
>     >> someone might be able to point me to some example code. I have
>     >> attached
>     >> some code demonstrating my general problem ((A) and (B) below) as
>     >> well as
>     >> the outline of the sub-selection code. I have to say that coding
>     >> this has
>     >> proven non-trivial and any thoughts on cleaning up the mess are
>     >> welcome.
>     >> 
>     >> As always, thanks for the help.
>     >> 
>     >> Jim
>     >> 
>     >> require(methods)
>     >> 
>     >> setClass('myExample', representation = representation(x =
"array"))
>     >> 
>     >> myExample<- function(dims = c(1,2)) {
>     >> a<- array(rnorm(prod(dims)))
>     >> dim(a)<- dims
>     >> obj<- new("myExample")
>     >> obj at x<- a
>     >> return(obj)
>     >> }
>     >> 
>     >> setMethod("dim", "myExample", function(x) return(dim(x at x)))
>     >> 
>     >> functionThatCanOnlyGrabContiguous<- function(x, m, kall) {
>     >> kall$x<- x at x
>     >> for (i in 1:nrow(m)) {
>     >> kall[[i+2]]<- seq.int(m[i,1], m[i,2])
>     >> }
>     >> print(as.list(kall))
>     >> return(eval(kall))
>     >> }
>     >> 
>     >> setMethod("[", "myExample", function(x, i, j, ..., drop = TRUE) {
>     >> if (missing(...)){
>     >> print("Missing!")
>     >> }
>     >> e<- list(...)
>     >> m<- matrix(nrow = length(dim(x)), ncol = 2)
>     >> 
>     >> if (missing(i))
>     >> m[1,]<- c(1, dim(x)[1])
>     >> else
>     >> m[1,]<- range(i)
>     >> 
>     >> if (length(dim(x))>  1) {
>     >> if (missing(j))
>     >> m[2,]<- c(1, dim(x)[2])
>     >> else
>     >> m[2,]<- range(j)
>     >> 
>     >> k<- 3
>     >> while (k<= nrow(m)) {
>     >> if (k-2<= length(e))
>     >> m[k,]<- range(e[[k-2]])
>     >> else
>     >> m[k,]<- c(1, dim(x)[k])
>     >> k<- k + 1
>     >> }
>     >> }
>     >> kall<- match.call()
>     >> d<- functionThatCanOnlyGrabContiguous(x, m, kall)
>     >> 
>     >> kall$x<- d
>     >> if (! missing(i)) {
>     >> kall[[3]]<- i - min(i) + 1
>     >> }
>     >> if (! missing(j)) {
>     >> kall[[4]]<- j - min(j) + 1
>     >> } else {
>     >> if (length(dim(x))>  1)
>     >> kall[[4]]<- seq.int(1, dim(x)[2])
>     >> }
>     >> ## XXX: Have to handle remaining dimensions, but since I can't
>     >> ## really get a clean '...' it is on hold.
>     >> 
>     >> eval(kall)
>     >> })
>     >> 
>     >> ## ############### 1-D
>     >> m<- myExample(10)
>     >> m at x[c(1,5)] == m[c(1, 5)]
>     >> 
>     >> ## ############### 2-D
>     >> m<- myExample(c(10, 10))
>     >> m at x[c(1,5), c(1,5)] == m[c(1,5), c(1,5)]
>     >> m at x[c(5, 2),] == m[c(5,2),]
>     >> 
>     >> ## ############### 3-D
>     >> m<- myExample(c(1,3,4))
>     >> 
>     >> ## (A) doesn't work
>     >> m at x[1,1:2,] == m[1,1:2,]
>     >> 
>     >> ## (B) nor does this for different reasons.
>     >> m[1,,1]
>     >> m at x[1,,1]
>     >> 
>     >> 
>     >>> sessionInfo()
>     >>> 
>     >> R version 2.11.0 (2010-04-22)
>     >> x86_64-pc-linux-gnu
>     >> 
>     >> locale:
>     >> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>     >> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>     >> [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
>     >> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>     >> [9] LC_ADDRESS=C               LC_TELEPHONE=C
>     >> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>     >> 
>     >> attached base packages:
>     >> [1] stats     graphics  grDevices utils     datasets  methods  
base
>     >> 
>     >> loaded via a namespace (and not attached):
>     >> [1] tools_2.11.0
>     >> 
>     >> ______________________________________________
>     >> R-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-devel
>     >> 
>     >> 
>     >> 
> 
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Tue May 18 23:03:30 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 18 May 2010 23:03:30 +0200
Subject: [Rd] [R] avoiding reinstall already installed *package*
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70002F1EB4D@NA-PA-VBE03.na.tibco.com>
References: <AANLkTiko6-sCnmPqTMpq2f7Pcmj48bMQyiIwPi35nXhI@mail.gmail.com>
	<19442.46865.742916.387778@lynne.math.ethz.ch>
	<AANLkTil7bqxHHpPF8CqTArxQOP81h-fVA8J6WfrhY-Dr@mail.gmail.com>
	<AANLkTimbtO9SjWzkuzzA5R0E6LvwXmUPjbIKEL9iYpiv@mail.gmail.com>
	<77EB52C6DD32BA4D87471DCD70C8D70002F1EB4D@NA-PA-VBE03.na.tibco.com>
Message-ID: <AANLkTimJNSd01ufwKkFBAeY18V5hxqwF2l1oLj-3oEv0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100518/e10d0ddf/attachment.pl>

From assafgordon at gmail.com  Wed May 19 04:38:36 2010
From: assafgordon at gmail.com (Assaf Gordon)
Date: Tue, 18 May 2010 22:38:36 -0400
Subject: [Rd] R in sandbox/jail (long question)
Message-ID: <4BF34F2C.2020107@gmail.com>

Hello,

I have a setup similar to Rweb (  http://www.math.montana.edu/Rweb/ ):
I get R scripts from users and need to execute them in in a safe manner (they are executed automatically, without human inspection).

I would like to limit the user's script to reading from STDIN and writing to STDOUT/ERR.
Specifically, preventing any kind of interaction with the underlying operating system (files, sockets, system(), etc.).

I've found this old thread:
http://r.789695.n4.nabble.com/R-in-a-sandbox-jail-td921991.html
But for technical reasons I'd prefer not to setup a chroot jail.

I have written a patch that adds a "--sandbox" parameter.
When this parameter is used, the user's script can't create any kind of connection object or run "system()".

My plan is to run R like this:

cat INPUT | R --vanila --slave --sandbox --file SCRIPT.R > OUTPUT

Where 'INPUT' is my chosen input and 'SCRIPT.R' is the script submitted by the user.
If the script tries to create a conncetion or run a disabled function, an error is printed.

This is the patch:
http://cancan.cshl.edu/labmembers/gordon/files/R_2.11.0_sandbox.patch

So my questions are:
1. Would you be willing to consider this feature for inclusion ?
2. Are there any other 'dangerous' functions I need to intercept ( ".Internal" perhaps ?)

All comments and suggestions are welcomed,
thanks,
   -gordon


From felix at nfrac.org  Wed May 19 04:41:27 2010
From: felix at nfrac.org (Felix Andrews)
Date: Wed, 19 May 2010 12:41:27 +1000
Subject: [Rd] pretty.Date(): new "halfmonth" time step
Message-ID: <AANLkTikQNlbzH5crGWHOi84ItVu_p4KDl0Gch8KNekhd@mail.gmail.com>

Hi R-devel / R-core

In the new pretty() methods for Date and POSIXct
https://svn.r-project.org/R/trunk/src/library/grDevices/R/prettyDate.R
there is currently a "pretty" time step listed as "15 DSTdays"... but
this actually doesn't line up well with months.

Much better to implement directly what this is trying to do: i.e. to
have a "halfmonth" time step. This is just the union of two "monthly"
sequences, one on the 1st of each month and another on the 15th of
each month.

With this in place we have:

prettyDate(as.Date(c("2002-02-02", "2002-05-01")))
# [1] "2002-02-15" "2002-03-01" "2002-03-15" "2002-04-01" "2002-04-15"
"2002-05-01"

The proposed patch is attached.

Regards
-Felix


-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/

From murdoch.duncan at gmail.com  Wed May 19 04:50:21 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 18 May 2010 22:50:21 -0400
Subject: [Rd] R in sandbox/jail (long question)
In-Reply-To: <4BF34F2C.2020107@gmail.com>
References: <4BF34F2C.2020107@gmail.com>
Message-ID: <4BF351ED.6080006@gmail.com>

On 18/05/2010 10:38 PM, Assaf Gordon wrote:
> Hello,
>
> I have a setup similar to Rweb (  http://www.math.montana.edu/Rweb/ ):
> I get R scripts from users and need to execute them in in a safe manner (they are executed automatically, without human inspection).
>
> I would like to limit the user's script to reading from STDIN and writing to STDOUT/ERR.
> Specifically, preventing any kind of interaction with the underlying operating system (files, sockets, system(), etc.).
>
> I've found this old thread:
> http://r.789695.n4.nabble.com/R-in-a-sandbox-jail-td921991.html
> But for technical reasons I'd prefer not to setup a chroot jail.
>
> I have written a patch that adds a "--sandbox" parameter.
> When this parameter is used, the user's script can't create any kind of connection object or run "system()".
>   

That sounds too restrictive.  R uses connections internally in various 
places, with no reference to the file system.  It also uses them when 
reading its own files.  So if you stop a user from creating connections, 
you'll somehow need to distinguish between user-created ones and 
internally necessary ones:  not easy.


My plan is to run R like this:
> cat INPUT | R --vanila --slave --sandbox --file SCRIPT.R > OUTPUT
>
> Where 'INPUT' is my chosen input and 'SCRIPT.R' is the script submitted by the user.
> If the script tries to create a conncetion or run a disabled function, an error is printed.
>
> This is the patch:
> http://cancan.cshl.edu/labmembers/gordon/files/R_2.11.0_sandbox.patch
>
> So my questions are:
> 1. Would you be willing to consider this feature for inclusion ?
> 2. Are there any other 'dangerous' functions I need to intercept ( ".Internal" perhaps ?)
>   

.Internal is needed by tons of base functions.  So again, you'll need to 
distinguish where the call is coming from, and that's not easy.

Duncan Murdoch
> All comments and suggestions are welcomed,
> thanks,
>    -gordon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From abhibera at gmail.com  Wed May 19 14:21:41 2010
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 19 May 2010 17:51:41 +0530
Subject: [Rd] Why does my RPy2 program run faster on Windows?
Message-ID: <AANLkTilpKFsvkWRwpA91F5_9qPPUqfxS-zBDZbTm-z7T@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100519/f0af5197/attachment.pl>

From abhibera at gmail.com  Wed May 19 15:04:08 2010
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 19 May 2010 18:34:08 +0530
Subject: [Rd] Why does my RPy2 program run faster on Windows?
In-Reply-To: <AANLkTilpKFsvkWRwpA91F5_9qPPUqfxS-zBDZbTm-z7T@mail.gmail.com>
References: <AANLkTilpKFsvkWRwpA91F5_9qPPUqfxS-zBDZbTm-z7T@mail.gmail.com>
Message-ID: <AANLkTikz-B62AkrSGKjNez2EyZK-P6VA2vJr7w5GpEub@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100519/9ea30a57/attachment.pl>

From abhibera at gmail.com  Wed May 19 15:13:17 2010
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 19 May 2010 18:43:17 +0530
Subject: [Rd] Why does my RPy2 program run faster on Windows?
In-Reply-To: <AANLkTikz-B62AkrSGKjNez2EyZK-P6VA2vJr7w5GpEub@mail.gmail.com>
References: <AANLkTilpKFsvkWRwpA91F5_9qPPUqfxS-zBDZbTm-z7T@mail.gmail.com>
	<AANLkTikz-B62AkrSGKjNez2EyZK-P6VA2vJr7w5GpEub@mail.gmail.com>
Message-ID: <AANLkTinK5SyZG1l42VOx9s5kOXHK87HSYPE5X_Xl89X6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100519/4d78ed7a/attachment.pl>

From cgb at datanalytics.com  Wed May 19 15:19:18 2010
From: cgb at datanalytics.com (Carlos J. Gil Bellosta )
Date: Wed, 19 May 2010 15:19:18 +0200
Subject: [Rd] Why does my RPy2 program run faster on Windows?
In-Reply-To: <AANLkTikz-B62AkrSGKjNez2EyZK-P6VA2vJr7w5GpEub@mail.gmail.com>
References: <AANLkTilpKFsvkWRwpA91F5_9qPPUqfxS-zBDZbTm-z7T@mail.gmail.com>
	<AANLkTikz-B62AkrSGKjNez2EyZK-P6VA2vJr7w5GpEub@mail.gmail.com>
Message-ID: <AANLkTimJ13JJhKe7tfSnolJBE8mExDDi5aGXj-6povEX@mail.gmail.com>

Dear Abhijit,

If you think that table.CAPM is the culprit, you could run the call to
such function in R on both platforms using Rprof to check which part
of the function is producing the bottleneck.

Best regards,

Carlos J. Gil Bellosta
http://www.datanalytics.com


2010/5/19 Abhijit Bera <abhibera at gmail.com>:
> Update: it appears that the time taken isn't so much on the Data conversion.
> The maximum time taken is in CAPM calculation. :( Anyone know why the CAPM
> calculation would be faster on Windows?
>
> On Wed, May 19, 2010 at 5:51 PM, Abhijit Bera <abhibera at gmail.com> wrote:
>
>> Hi
>>
>> This is my function. It serves an HTML page after the calculations. I'm
>> connecting to a MSSQL DB using pyodbc.
>>
>> ? ? def CAPM(self,client):
>>
>> ? ? ? ? r=self.r
>>
>> ? ? ? ? cds="1590"
>> ? ? ? ? bm="20559"
>>
>> ? ? ? ? d1 = []
>> ? ? ? ? v1 = []
>> ? ? ? ? v2 = []
>>
>>
>> ? ? ? ? print"Parsing GET Params"
>>
>> ? ? ? ? params=client.g[1].split("&")
>>
>> ? ? ? ? for items in params:
>> ? ? ? ? ? ? item=items.split("=")
>>
>> ? ? ? ? ? ? if(item[0]=="cds"):
>> ? ? ? ? ? ? ? ? cds=unquote(item[1])
>> ? ? ? ? ? ? elif(item[0]=="bm"):
>> ? ? ? ? ? ? ? ? bm=unquote(item[1])
>>
>> ? ? ? ? print "cds: %s bm: %s" % (cds,bm)
>>
>> ? ? ? ? print "Fetching data"
>>
>> ? ? ? ? t3=datetime.now()
>>
>> ? ? ? ? for row in self.cursor.execute("select * from (select * from (
>> select co_code,dlyprice_date,dlyprice_close from feed_dlyprice P where
>> co_code in (%s,%s) ) DataTable PIVOT ( max(dlyprice_close) FOR co_code IN
>> ([%s],[%s]) ?)PivotTable ) a order by dlyprice_date" %(cds,bm,cds,bm)):
>> ? ? ? ? ? ? d1.append(str(row[0]))
>> ? ? ? ? ? ? v1.append(row[1])
>> ? ? ? ? ? ? v2.append(row[2])
>>
>> ? ? ? ? t4=datetime.now()
>>
>> ? ? ? ? t1=datetime.now()
>>
>> ? ? ? ? print "Calculating"
>>
>> ? ? ? ? d1.pop(0)
>> ? ? ? ? d1vec = robjects.StrVector(d1)
>> ? ? ? ? v1vec = robjects.FloatVector(v1)
>> ? ? ? ? v2vec = robjects.FloatVector(v2)
>>
>> ? ? ? ? r1 = r('Return.calculate(%s)' %v1vec.r_repr())
>> ? ? ? ? r2 = r('Return.calculate(%s)' %v2vec.r_repr())
>>
>> ? ? ? ? tl = robjects.rlc.TaggedList([r1,r2],tags=('Geo','Nifty'))
>> ? ? ? ? df = robjects.DataFrame(tl)
>>
>> ? ? ? ? ts2 = r.timeSeries(df,d1vec)
>> ? ? ? ? tsa = r.timeSeries(r1,d1vec)
>> ? ? ? ? tsb = r.timeSeries(r2,d1vec)
>>
>> ? ? ? ? robjects.globalenv["ta"] = tsa
>> ? ? ? ? robjects.globalenv["tb"] = tsb
>> ? ? ? ? robjects.globalenv["t2"] = ts2
>> ? ? ? ? a = r('table.CAPM(ta,tb)')
>>
>> ? ? ? ? t2=datetime.now()
>>
>>
>> ? ? ? ? page="<html><title>CAPM</title><body>Result:<br>%s<br>Time taken by
>> DB:%s<br>Time taken by R:%s<br>Total time elapsed:%s<br></body></html>"
>> %(str(a),str(t4-t3),str(t2-t1),str(t2-t3))
>> ? ? ? ? print "Serving page:"
>> ? ? ? ? #print page
>>
>> ? ? ? ? self.serveResource(page,"text",client)
>>
>>
>>
>> On Linux
>> Time taken by DB:0:00:00.024165
>> Time taken by R:0:00:05.572084
>> Total time elapsed:0:00:05.596288
>>
>> On Windows
>> Time taken by DB:0:00:00.112000
>> Time taken by R:0:00:02.355000
>> Total time elapsed:0:00:02.467000
>>
>> Why is there such a huge difference in the time taken by R on the two
>> platforms? Am I doing something wrong? It's my first Rpy2 code so I guess
>> it's badly written.
>>
>> I'm loading the following libraries:
>> 'PerformanceAnalytics','timeSeries','fPortfolio','fPortfolioBacktest'
>>
>> I'm using Rpy2 2.1.0 and R 2.11
>>
>> Regards
>>
>> Abhijit Bera
>>
>>
>>
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From tlumley at u.washington.edu  Wed May 19 18:48:23 2010
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed, 19 May 2010 09:48:23 -0700 (PDT)
Subject: [Rd] R in sandbox/jail (long question)
In-Reply-To: <4BF34F2C.2020107@gmail.com>
Message-ID: <alpine.LRH.2.01.1005190948230.3060@hymn31.u.washington.edu>



I think you'll find it's a bit more complicated than that.

Firstly, R --sandbox is pretty crippled, since as far as I can tell it can't load packages, since package loading uses gzfile().  This would include the 'stats' package.   If you can load packages you would need to sanitize all those packages, since they may contain functions that directly talk to the operating system (for example, the 'foreign' package does).

Also, most functions called by .C() and many called by .Call() can be made to overwrite memory they don't own, by passing invalid arguments, so the sandbox would only protect you from mistakes by the user and from incompetent attacks, but not from competent attacks.

     -thomas

On Tue, 18 May 2010, Assaf Gordon wrote:

> Hello,
>
> I have a setup similar to Rweb (  http://www.math.montana.edu/Rweb/ ):
> I get R scripts from users and need to execute them in in a safe manner (they 
> are executed automatically, without human inspection).
>
> I would like to limit the user's script to reading from STDIN and writing to 
> STDOUT/ERR.
> Specifically, preventing any kind of interaction with the underlying 
> operating system (files, sockets, system(), etc.).
>
> I've found this old thread:
> http://r.789695.n4.nabble.com/R-in-a-sandbox-jail-td921991.html
> But for technical reasons I'd prefer not to setup a chroot jail.
>
> I have written a patch that adds a "--sandbox" parameter.
> When this parameter is used, the user's script can't create any kind of 
> connection object or run "system()".
>
> My plan is to run R like this:
>
> cat INPUT | R --vanila --slave --sandbox --file SCRIPT.R > OUTPUT
>
> Where 'INPUT' is my chosen input and 'SCRIPT.R' is the script submitted by 
> the user.
> If the script tries to create a conncetion or run a disabled function, an 
> error is printed.
>
> This is the patch:
> http://cancan.cshl.edu/labmembers/gordon/files/R_2.11.0_sandbox.patch
>
> So my questions are:
> 1. Would you be willing to consider this feature for inclusion ?
> 2. Are there any other 'dangerous' functions I need to intercept ( 
> ".Internal" perhaps ?)
>
> All comments and suggestions are welcomed,
> thanks,
>  -gordon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From shotwelm at musc.edu  Wed May 19 22:26:54 2010
From: shotwelm at musc.edu (Matt Shotwell)
Date: Wed, 19 May 2010 16:26:54 -0400
Subject: [Rd] R in sandbox/jail (long question)
In-Reply-To: <4BF34F2C.2020107@gmail.com>
References: <4BF34F2C.2020107@gmail.com>
Message-ID: <1274300814.4090.60.camel@deacon>

How about some "computing on the language", something like this:
  
exprs <- parse("SCRIPT.R")
invalids <- c(".Internal", ".Primitive")
if( any( invalids %in% all.names(exprs) ) )
   stop("sandbox check failed")


I believe this would prevent evaluating any direct calls to '.Primitive'
and '.Internal'. Of course, you could extend the 'invalids' vector to
include any names. If you want to consider arguments to calls (i.e.
argument to 'file' or 'library') or something more sophisticated, check
out the functions in the codetools package, something like this:


library(codetools)

walkerCall <- function(e, w) {
  for( ee in as.list(e)) {
    if(!missing(ee)) {
      if(is.call(ee)) {

        #stop .Internal calls
        if(ee[1] == call(".Internal"))
          stop("invalid \'.Internal()\' call")

        #restrict file to STDIN
        if(ee[1] == call("file")) {
          mc <- match.call(file, ee)
          if(mc[[2]] != "stdin")
            stop("\'file()\' only valid with \'description=\"stdin\"\'")
        }

      }
      walkCode(ee, w)
    }
  }
}

walker <- makeCodeWalker(call=walkerCall, leaf=function(e,w){})
exprs <- parse("SCRIPT.R")
for( expr in exprs ) 
    walkCode(expr,walker)

I'm a little surprised this there isn't a 'sandbox' package or something
similar to this. A reverse depends check on the codetools package
indicates there is not. However, I believe there is some demand for it.

Matt Shotwell
http://biostatmatt.com


On Tue, 2010-05-18 at 22:38 -0400, Assaf Gordon wrote:
> Hello,
> 
> I have a setup similar to Rweb (  http://www.math.montana.edu/Rweb/ ):
> I get R scripts from users and need to execute them in in a safe manner (they are executed automatically, without human inspection).
> 
> I would like to limit the user's script to reading from STDIN and writing to STDOUT/ERR.
> Specifically, preventing any kind of interaction with the underlying operating system (files, sockets, system(), etc.).
> 
> I've found this old thread:
> http://r.789695.n4.nabble.com/R-in-a-sandbox-jail-td921991.html
> But for technical reasons I'd prefer not to setup a chroot jail.
> 
> I have written a patch that adds a "--sandbox" parameter.
> When this parameter is used, the user's script can't create any kind of connection object or run "system()".
> 
> My plan is to run R like this:
> 
> cat INPUT | R --vanila --slave --sandbox --file SCRIPT.R > OUTPUT
> 
> Where 'INPUT' is my chosen input and 'SCRIPT.R' is the script submitted by the user.
> If the script tries to create a conncetion or run a disabled function, an error is printed.
> 
> This is the patch:
> http://cancan.cshl.edu/labmembers/gordon/files/R_2.11.0_sandbox.patch
> 
> So my questions are:
> 1. Would you be willing to consider this feature for inclusion ?
> 2. Are there any other 'dangerous' functions I need to intercept ( ".Internal" perhaps ?)
> 
> All comments and suggestions are welcomed,
> thanks,
>    -gordon
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From chiefmurphy at gmail.com  Thu May 20 03:56:10 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Wed, 19 May 2010 18:56:10 -0700
Subject: [Rd]  pretty.Date(): new "halfmonth" time step
Message-ID: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100519/495f784b/attachment.pl>

From felix at nfrac.org  Thu May 20 04:48:26 2010
From: felix at nfrac.org (Felix Andrews)
Date: Thu, 20 May 2010 12:48:26 +1000
Subject: [Rd] pretty.Date(): new "halfmonth" time step
In-Reply-To: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>
References: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>
Message-ID: <AANLkTil4POsPLZ40AKT9Td9sO7HFyPTw5PynrT9WxDSa@mail.gmail.com>

On 20 May 2010 11:56, Daniel Murphy <chiefmurphy at gmail.com> wrote:
>>Much better to implement directly what this is trying to do: i.e. to
>>have a "halfmonth" time step. This is just the union of two "monthly"
>>sequences, one on the 1st of each month and another on the 15th of
>>each month.
>
> For some applications that might be true. But not for others. For a month
> with 31 days, there are 14 days before the 15th of the month and 16 days
> after the 15th, so, for example, March 16th (specifically noon) rather than
> March 15th would be the halfway point if you define "halfway" in terms of
> the distances to the beginning and end of the month. For a month with 30
> days -- like April -- the halfway point would be the instant between the
> 15th and the 16th of the month. Do you label that instant April 15 or April
> 16? ?(I prefer "15".) Don't get me started on February.

Dan, you are correct: the midpoint of a 30 day month is the 16th at
00:00. That instant is called the 16th according to print.POSIXt.

junstart <- as.POSIXct("2000-06-01 00:00", tz="GMT")
julstart <- as.POSIXct("2000-07-01 00:00", tz="GMT")
junstart + ((julstart - junstart) / 2)
#[1] "2000-06-16 GMT"

How embarassing...
So I think it would be better to use 16 rather than 15 for the
"halfmonth" time step.

Yes, months have variable lengths, but I think it is best to use a
consistent date (the 16th) than to calculate exact midpoints, just as
a normal monthly series has a consistent date (the 1st) and has
variable lengths.

Regards
-Felix


>
> - Dan Murphy
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From ripley at stats.ox.ac.uk  Thu May 20 08:51:09 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 20 May 2010 07:51:09 +0100 (BST)
Subject: [Rd] Use of R and Rscript in configure/Makevars in packages
Message-ID: <alpine.LFD.2.00.1005121542130.12002@gannet.stats.ox.ac.uk>

We have seen problems with a number of packages which use R/Rscript to 
run R code in configure or makefiles.

(a) You must give a full path: there need be no version of R in the 
path, and if there is it might not be the version/build of R under 
which package installation is being done.  So the general form is to 
use

${R_HOME}/bin/R

to select the right version.  And since ${R_HOME} might contain 
spaces, you need something like "${R_HOME}/bin/R".

There appear to be bare uses of Rscript in Rcpp RQuantLib bifactorial 
mvabund, of bare R in ROracle pgfSweave rcom and many more packages 
without quotes.

(b) There are further issues with platforms which use 
sub-architectures (mainly Mac OS X and R-devel Windows).  On Windows 
the architecture-dependent executables will (as from R 2.12.0) be in 
subdirectories of ${R_HOME}/bin, so the general form is to use one of

"${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe"
"${R_HOME}/bin${R_ARCH_BIN}/Rterm.exe"
"${R_HOME}/bin${R_ARCH_BIN}/Rcmd.exe"

On R-devel Windows ${R_HOME}/bin/R.exe and ${R_HOME}/bin/Rscript.exe 
do exist and are 32-bit executables whose sole task is to launch the
appropriate executable from a sub-directory.  Since process creation 
is expensive on Windows, this intermediate step is best avoided.

On Mac OS X, ${R_HOME}/bin/R is a script that launches the 
architecture-dependent executables from a subdirectory, and on CRAN 
builds ${R_HOME}/bin/Rscript is a 'fat' (multi-arch) executable, so 
the issues have been worked around (but not necessarily for user 
installs).

(c) Calling R in configure.win will typically call 32-bit R with 
R-devel Windows.  If the result needs to depend on the architecture 
(and e.g. the library dirs may well) then the work needs to be done in 
src/Makevars.win: see the R-devel 'Writing R Extensions' manual for 
how to achieve this.

(The reason is that configure.win is called once, and then 
src/Makevars.win is called for each architecture.)

BDR

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From romain at r-enthusiasts.com  Thu May 20 09:20:44 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Thu, 20 May 2010 09:20:44 +0200
Subject: [Rd] Use of R and Rscript in configure/Makevars in packages
In-Reply-To: <alpine.LFD.2.00.1005121542130.12002@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.1005121542130.12002@gannet.stats.ox.ac.uk>
Message-ID: <4BF4E2CC.7010501@r-enthusiasts.com>

Hello,

Thank you for these clear guidelines.

Given these subtleties, would it make sense to have a "configure.R" that 
would win over configure and configure.win, and have R invoking it 
correctly, as below ?

Romain

Le 20/05/10 08:51, Prof Brian Ripley a ?crit :
>
> We have seen problems with a number of packages which use R/Rscript to
> run R code in configure or makefiles.
>
> (a) You must give a full path: there need be no version of R in the
> path, and if there is it might not be the version/build of R under which
> package installation is being done. So the general form is to use
>
> ${R_HOME}/bin/R
>
> to select the right version. And since ${R_HOME} might contain spaces,
> you need something like "${R_HOME}/bin/R".
>
> There appear to be bare uses of Rscript in Rcpp RQuantLib bifactorial
> mvabund, of bare R in ROracle pgfSweave rcom and many more packages
> without quotes.
>
> (b) There are further issues with platforms which use sub-architectures
> (mainly Mac OS X and R-devel Windows). On Windows the
> architecture-dependent executables will (as from R 2.12.0) be in
> subdirectories of ${R_HOME}/bin, so the general form is to use one of
>
> "${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe"
> "${R_HOME}/bin${R_ARCH_BIN}/Rterm.exe"
> "${R_HOME}/bin${R_ARCH_BIN}/Rcmd.exe"
>
> On R-devel Windows ${R_HOME}/bin/R.exe and ${R_HOME}/bin/Rscript.exe do
> exist and are 32-bit executables whose sole task is to launch the
> appropriate executable from a sub-directory. Since process creation is
> expensive on Windows, this intermediate step is best avoided.
>
> On Mac OS X, ${R_HOME}/bin/R is a script that launches the
> architecture-dependent executables from a subdirectory, and on CRAN
> builds ${R_HOME}/bin/Rscript is a 'fat' (multi-arch) executable, so the
> issues have been worked around (but not necessarily for user installs).
>
> (c) Calling R in configure.win will typically call 32-bit R with R-devel
> Windows. If the result needs to depend on the architecture (and e.g. the
> library dirs may well) then the work needs to be done in
> src/Makevars.win: see the R-devel 'Writing R Extensions' manual for how
> to achieve this.
>
> (The reason is that configure.win is called once, and then
> src/Makevars.win is called for each architecture.)
>
> BDR
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/bklUXt : RcppArmadillo 0.2.1
|- http://bit.ly/936ck2 : Rcpp 0.8.0
`- http://bit.ly/9aKDM9 : embed images in Rd documents


From chiefmurphy at gmail.com  Thu May 20 09:38:13 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Thu, 20 May 2010 00:38:13 -0700
Subject: [Rd] pretty.Date(): new "halfmonth" time step
In-Reply-To: <AANLkTil4POsPLZ40AKT9Td9sO7HFyPTw5PynrT9WxDSa@mail.gmail.com>
References: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>
	<AANLkTil4POsPLZ40AKT9Td9sO7HFyPTw5PynrT9WxDSa@mail.gmail.com>
Message-ID: <AANLkTinYOBsbV0EAA3fkDswimYvSDzWmlW3A9qCNDFso@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100520/ec0f60a5/attachment.pl>

From ripley at stats.ox.ac.uk  Thu May 20 09:40:54 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 20 May 2010 08:40:54 +0100 (BST)
Subject: [Rd] Use of R and Rscript in configure/Makevars in packages
In-Reply-To: <4BF4E2CC.7010501@r-enthusiasts.com>
References: <alpine.LFD.2.00.1005121542130.12002@gannet.stats.ox.ac.uk>
	<4BF4E2CC.7010501@r-enthusiasts.com>
Message-ID: <alpine.LFD.2.00.1005200839150.9004@gannet.stats.ox.ac.uk>

On Thu, 20 May 2010, Romain Francois wrote:

> Hello,
>
> Thank you for these clear guidelines.
>
> Given these subtleties, would it make sense to have a "configure.R" that 
> would win over configure and configure.win, and have R invoking it correctly, 
> as below ?

Only if someone in R-core volunteers to implement it, and this would 
not solve the issue until R 2.12.0 and all the packages involved moved 
to it.

>
> Romain
>
> Le 20/05/10 08:51, Prof Brian Ripley a ?crit :
>> 
>> We have seen problems with a number of packages which use R/Rscript to
>> run R code in configure or makefiles.
>> 
>> (a) You must give a full path: there need be no version of R in the
>> path, and if there is it might not be the version/build of R under which
>> package installation is being done. So the general form is to use
>> 
>> ${R_HOME}/bin/R
>> 
>> to select the right version. And since ${R_HOME} might contain spaces,
>> you need something like "${R_HOME}/bin/R".
>> 
>> There appear to be bare uses of Rscript in Rcpp RQuantLib bifactorial
>> mvabund, of bare R in ROracle pgfSweave rcom and many more packages
>> without quotes.
>> 
>> (b) There are further issues with platforms which use sub-architectures
>> (mainly Mac OS X and R-devel Windows). On Windows the
>> architecture-dependent executables will (as from R 2.12.0) be in
>> subdirectories of ${R_HOME}/bin, so the general form is to use one of
>> 
>> "${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe"
>> "${R_HOME}/bin${R_ARCH_BIN}/Rterm.exe"
>> "${R_HOME}/bin${R_ARCH_BIN}/Rcmd.exe"
>> 
>> On R-devel Windows ${R_HOME}/bin/R.exe and ${R_HOME}/bin/Rscript.exe do
>> exist and are 32-bit executables whose sole task is to launch the
>> appropriate executable from a sub-directory. Since process creation is
>> expensive on Windows, this intermediate step is best avoided.
>> 
>> On Mac OS X, ${R_HOME}/bin/R is a script that launches the
>> architecture-dependent executables from a subdirectory, and on CRAN
>> builds ${R_HOME}/bin/Rscript is a 'fat' (multi-arch) executable, so the
>> issues have been worked around (but not necessarily for user installs).
>> 
>> (c) Calling R in configure.win will typically call 32-bit R with R-devel
>> Windows. If the result needs to depend on the architecture (and e.g. the
>> library dirs may well) then the work needs to be done in
>> src/Makevars.win: see the R-devel 'Writing R Extensions' manual for how
>> to achieve this.
>> 
>> (The reason is that configure.win is called once, and then
>> src/Makevars.win is called for each architecture.)
>> 
>> BDR
>> 
>
>
> -- 
> Romain Francois
> Professional R Enthusiast
> +33(0) 6 28 91 30 30
> http://romainfrancois.blog.free.fr
> |- http://bit.ly/bklUXt : RcppArmadillo 0.2.1
> |- http://bit.ly/936ck2 : Rcpp 0.8.0
> `- http://bit.ly/9aKDM9 : embed images in Rd documents
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From romain at r-enthusiasts.com  Thu May 20 10:03:10 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Thu, 20 May 2010 10:03:10 +0200
Subject: [Rd] Use of R and Rscript in configure/Makevars in packages
In-Reply-To: <alpine.LFD.2.00.1005200839150.9004@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.1005121542130.12002@gannet.stats.ox.ac.uk>
	<4BF4E2CC.7010501@r-enthusiasts.com>
	<alpine.LFD.2.00.1005200839150.9004@gannet.stats.ox.ac.uk>
Message-ID: <4BF4ECBE.8030208@r-enthusiasts.com>

Le 20/05/10 09:40, Prof Brian Ripley a ?crit :
> On Thu, 20 May 2010, Romain Francois wrote:
>
>> Hello,
>>
>> Thank you for these clear guidelines.
>>
>> Given these subtleties, would it make sense to have a "configure.R"
>> that would win over configure and configure.win, and have R invoking
>> it correctly, as below ?
>
> Only if someone in R-core volunteers to implement it, and this would not
> solve the issue until R 2.12.0 and all the packages involved moved to it.

Sure. This leaves plently of time to test it then.

Reading the above literally, I will not work on a patch, but I can offer 
my time to test it if someone in R-core does volunteer.

Romain

>> Romain
>>
>> Le 20/05/10 08:51, Prof Brian Ripley a ?crit :
>>>
>>> We have seen problems with a number of packages which use R/Rscript to
>>> run R code in configure or makefiles.
>>>
>>> (a) You must give a full path: there need be no version of R in the
>>> path, and if there is it might not be the version/build of R under which
>>> package installation is being done. So the general form is to use
>>>
>>> ${R_HOME}/bin/R
>>>
>>> to select the right version. And since ${R_HOME} might contain spaces,
>>> you need something like "${R_HOME}/bin/R".
>>>
>>> There appear to be bare uses of Rscript in Rcpp RQuantLib bifactorial
>>> mvabund, of bare R in ROracle pgfSweave rcom and many more packages
>>> without quotes.
>>>
>>> (b) There are further issues with platforms which use sub-architectures
>>> (mainly Mac OS X and R-devel Windows). On Windows the
>>> architecture-dependent executables will (as from R 2.12.0) be in
>>> subdirectories of ${R_HOME}/bin, so the general form is to use one of
>>>
>>> "${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe"
>>> "${R_HOME}/bin${R_ARCH_BIN}/Rterm.exe"
>>> "${R_HOME}/bin${R_ARCH_BIN}/Rcmd.exe"
>>>
>>> On R-devel Windows ${R_HOME}/bin/R.exe and ${R_HOME}/bin/Rscript.exe do
>>> exist and are 32-bit executables whose sole task is to launch the
>>> appropriate executable from a sub-directory. Since process creation is
>>> expensive on Windows, this intermediate step is best avoided.
>>>
>>> On Mac OS X, ${R_HOME}/bin/R is a script that launches the
>>> architecture-dependent executables from a subdirectory, and on CRAN
>>> builds ${R_HOME}/bin/Rscript is a 'fat' (multi-arch) executable, so the
>>> issues have been worked around (but not necessarily for user installs).
>>>
>>> (c) Calling R in configure.win will typically call 32-bit R with R-devel
>>> Windows. If the result needs to depend on the architecture (and e.g. the
>>> library dirs may well) then the work needs to be done in
>>> src/Makevars.win: see the R-devel 'Writing R Extensions' manual for how
>>> to achieve this.
>>>
>>> (The reason is that configure.win is called once, and then
>>> src/Makevars.win is called for each architecture.)
>>>
>>> BDR
>>>
>>
>>
>> --
>> Romain Francois
>> Professional R Enthusiast
>> +33(0) 6 28 91 30 30
>> http://romainfrancois.blog.free.fr
>> |- http://bit.ly/bklUXt : RcppArmadillo 0.2.1
>> |- http://bit.ly/936ck2 : Rcpp 0.8.0
>> `- http://bit.ly/9aKDM9 : embed images in Rd documents
>>
>>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/bklUXt : RcppArmadillo 0.2.1
|- http://bit.ly/936ck2 : Rcpp 0.8.0
`- http://bit.ly/9aKDM9 : embed images in Rd documents


From ggrothendieck at gmail.com  Thu May 20 13:01:35 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 20 May 2010 07:01:35 -0400
Subject: [Rd] pretty.Date(): new "halfmonth" time step
In-Reply-To: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>
References: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>
Message-ID: <AANLkTilwStAV-c2AXj8gH0Jz8zH3-071AkJOcCUj8yZJ@mail.gmail.com>

Note that in the zoo package that as.Date.yearmon has a frac= argument, e.g.

> library(zoo)
> ym <- as.yearmon("2010-01")
> as.Date(ym, frac = 0.5)
[1] "2010-01-16"


On Wed, May 19, 2010 at 9:56 PM, Daniel Murphy <chiefmurphy at gmail.com> wrote:
>>Much better to implement directly what this is trying to do: i.e. to
>>have a "halfmonth" time step. This is just the union of two "monthly"
>>sequences, one on the 1st of each month and another on the 15th of
>>each month.
>
> For some applications that might be true. But not for others. For a month
> with 31 days, there are 14 days before the 15th of the month and 16 days
> after the 15th, so, for example, March 16th (specifically noon) rather than
> March 15th would be the halfway point if you define "halfway" in terms of
> the distances to the beginning and end of the month. For a month with 30
> days -- like April -- the halfway point would be the instant between the
> 15th and the 16th of the month. Do you label that instant April 15 or April
> 16? ?(I prefer "15".) Don't get me started on February.
>
> - Dan Murphy
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From felix at nfrac.org  Thu May 20 13:14:55 2010
From: felix at nfrac.org (Felix Andrews)
Date: Thu, 20 May 2010 21:14:55 +1000
Subject: [Rd] pretty.Date(): new "halfmonth" time step
In-Reply-To: <AANLkTinYOBsbV0EAA3fkDswimYvSDzWmlW3A9qCNDFso@mail.gmail.com>
References: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com> 
	<AANLkTil4POsPLZ40AKT9Td9sO7HFyPTw5PynrT9WxDSa@mail.gmail.com> 
	<AANLkTinYOBsbV0EAA3fkDswimYvSDzWmlW3A9qCNDFso@mail.gmail.com>
Message-ID: <AANLkTim12r8v-2Ob9ggkjxMhiAG7l6wr5IXWVO4oHJUx@mail.gmail.com>

I see, an interesting perspective.

The current purpose is just to look pretty, or to follow "the
principle of least surprise", which is difficult to the extent that it
is subjective and sometimes context dependent...

Cheers
-Felix

On 20 May 2010 17:38, Daniel Murphy <chiefmurphy at gmail.com> wrote:
> Felix,
> I see your point about the "halfway" point acting like the first day of the
> month in its relativity to the ending date of the month: they're both
> variable.
> I'm an actuary. Like accountants, actuaries tend to measure "financial" time
> in months because of how the books close. But in our mathematical models
> time takes on a continuous nature. So our problem is how to build a computer
> representation of time that reflects both its continuous nature as well as
> the varying-length, "discrete" nature of financial months. I've found that a
> fixed value for a halfway point complicates actuarial calculations. It could
> serve other purposes just fine, however.
> Best regards,
> Dan
>
> On Wed, May 19, 2010 at 7:48 PM, Felix Andrews <felix at nfrac.org> wrote:
>>
>> On 20 May 2010 11:56, Daniel Murphy <chiefmurphy at gmail.com> wrote:
>> >>Much better to implement directly what this is trying to do: i.e. to
>> >>have a "halfmonth" time step. This is just the union of two "monthly"
>> >>sequences, one on the 1st of each month and another on the 15th of
>> >>each month.
>> >
>> > For some applications that might be true. But not for others. For a
>> > month
>> > with 31 days, there are 14 days before the 15th of the month and 16 days
>> > after the 15th, so, for example, March 16th (specifically noon) rather
>> > than
>> > March 15th would be the halfway point if you define "halfway" in terms
>> > of
>> > the distances to the beginning and end of the month. For a month with 30
>> > days -- like April -- the halfway point would be the instant between the
>> > 15th and the 16th of the month. Do you label that instant April 15 or
>> > April
>> > 16? ?(I prefer "15".) Don't get me started on February.
>>
>> Dan, you are correct: the midpoint of a 30 day month is the 16th at
>> 00:00. That instant is called the 16th according to print.POSIXt.
>>
>> junstart <- as.POSIXct("2000-06-01 00:00", tz="GMT")
>> julstart <- as.POSIXct("2000-07-01 00:00", tz="GMT")
>> junstart + ((julstart - junstart) / 2)
>> #[1] "2000-06-16 GMT"
>>
>> How embarassing...
>> So I think it would be better to use 16 rather than 15 for the
>> "halfmonth" time step.
>>
>> Yes, months have variable lengths, but I think it is best to use a
>> consistent date (the 16th) than to calculate exact midpoints, just as
>> a normal monthly series has a consistent date (the 1st) and has
>> variable lengths.
>>
>> Regards
>> -Felix
>>
>>
>> >
>> > - Dan Murphy
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>>
>>
>>
>> --
>> Felix Andrews / ???
>> Postdoctoral Fellow
>> Integrated Catchment Assessment and Management (iCAM) Centre
>> Fenner School of Environment and Society [Bldg 48a]
>> The Australian National University
>> Canberra ACT 0200 Australia
>> M: +61 410 400 963
>> T: + 61 2 6125 4670
>> E: felix.andrews at anu.edu.au
>> CRICOS Provider No. 00120C
>> --
>> http://www.neurofractal.org/felix/
>
>



-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From abryant at i-review.com  Thu May 20 14:50:05 2010
From: abryant at i-review.com (Alex Bryant)
Date: Thu, 20 May 2010 08:50:05 -0400
Subject: [Rd] Build R static
Message-ID: <41A047C9B0CF8D4CBB0C8BA991086CCB0E43F58F14@exchange07.i-review.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100520/3c7583a0/attachment.pl>

From chiefmurphy at gmail.com  Thu May 20 16:40:36 2010
From: chiefmurphy at gmail.com (Daniel Murphy)
Date: Thu, 20 May 2010 07:40:36 -0700
Subject: [Rd] pretty.Date(): new "halfmonth" time step
In-Reply-To: <AANLkTilwStAV-c2AXj8gH0Jz8zH3-071AkJOcCUj8yZJ@mail.gmail.com>
References: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com>
	<AANLkTilwStAV-c2AXj8gH0Jz8zH3-071AkJOcCUj8yZJ@mail.gmail.com>
Message-ID: <AANLkTiksbXFHCMW7OVSJkFSGtOzy8SMnse6MLGfLU5iW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100520/90e89a61/attachment.pl>

From ggrothendieck at gmail.com  Thu May 20 16:47:53 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 20 May 2010 10:47:53 -0400
Subject: [Rd] pretty.Date(): new "halfmonth" time step
In-Reply-To: <AANLkTiksbXFHCMW7OVSJkFSGtOzy8SMnse6MLGfLU5iW@mail.gmail.com>
References: <AANLkTim1YYlrryyI5-24VgYNVBTU-fxNe8cZlowrL86e@mail.gmail.com> 
	<AANLkTilwStAV-c2AXj8gH0Jz8zH3-071AkJOcCUj8yZJ@mail.gmail.com> 
	<AANLkTiksbXFHCMW7OVSJkFSGtOzy8SMnse6MLGfLU5iW@mail.gmail.com>
Message-ID: <AANLkTik6Dw-STNJEnmqH-DDSMtu6xlfNs0350hcgBpFr@mail.gmail.com>

Is that class publicly available?

On Thu, May 20, 2010 at 10:40 AM, Daniel Murphy <chiefmurphy at gmail.com> wrote:
> Yes. I looked at that feature of zoo. But it forced me to keep track of
> fractional months in the "Date" world. Square one. I ended up implementing a
> class under the paradigm of whole and fractional months. It allows me to do
> all my time arithmetic in ways that accountants expect. For example,
> accountants think of the close of business June 30th as being the halfway
> point of the year, but it's certainly not half the year "as the crow flies."
> -Dan
>
> On Thu, May 20, 2010 at 4:01 AM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>>
>> Note that in the zoo package that as.Date.yearmon has a frac= argument,
>> e.g.
>>
>> > library(zoo)
>> > ym <- as.yearmon("2010-01")
>> > as.Date(ym, frac = 0.5)
>> [1] "2010-01-16"
>>
>>
>> On Wed, May 19, 2010 at 9:56 PM, Daniel Murphy <chiefmurphy at gmail.com>
>> wrote:
>> >>Much better to implement directly what this is trying to do: i.e. to
>> >>have a "halfmonth" time step. This is just the union of two "monthly"
>> >>sequences, one on the 1st of each month and another on the 15th of
>> >>each month.
>> >
>> > For some applications that might be true. But not for others. For a
>> > month
>> > with 31 days, there are 14 days before the 15th of the month and 16 days
>> > after the 15th, so, for example, March 16th (specifically noon) rather
>> > than
>> > March 15th would be the halfway point if you define "halfway" in terms
>> > of
>> > the distances to the beginning and end of the month. For a month with 30
>> > days -- like April -- the halfway point would be the instant between the
>> > 15th and the 16th of the month. Do you label that instant April 15 or
>> > April
>> > 16? ?(I prefer "15".) Don't get me started on February.
>> >
>> > - Dan Murphy
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>
>


From hb at stat.berkeley.edu  Thu May 20 17:04:00 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 20 May 2010 17:04:00 +0200
Subject: [Rd] Suggestion: Add DESCRIPTION/NEWS files to the Rtools
	compilations
Message-ID: <AANLkTikUC1sjQ882TwmejwcXQrKZ1pqMenh4YJvw8COI@mail.gmail.com>

Hi,

I'd like to suggest that DESCRIPTION and/or NEWS files, or other
information revealing the version, would be added to the different
Rtools compilations (http://www.murdoch-sutherland.com/Rtools/).
Currently it's not easy to figure out which version is installed.

Another suggestion is to have Rtools install in different
subdirectories depending on version, much like how R is installed into
different directories, e.g. C:/Rtools-2.10/ and C:/Rtools-2.11dev/.
That would make it easier to setup one tool chain for R release and
one for R devel.

BTW, is there a reason (e.g. spaces in paths) for not installing
Rtools in %ProgramFiles%/R/, where R is installed?  Is it safe to have
it there?

Thanks for putting Rtools together

Henrik


From simon.urbanek at r-project.org  Thu May 20 18:50:19 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 20 May 2010 12:50:19 -0400
Subject: [Rd] Build R static
In-Reply-To: <41A047C9B0CF8D4CBB0C8BA991086CCB0E43F58F14@exchange07.i-review.com>
References: <41A047C9B0CF8D4CBB0C8BA991086CCB0E43F58F14@exchange07.i-review.com>
Message-ID: <FEA3109E-EF4D-4DDD-BAD2-2F739D11E613@r-project.org>


On May 20, 2010, at 8:50 AM, Alex Bryant wrote:

> Does anyone know if it's possible to create a static build of R?
> 

That depends heavily on the OS and tools used and has nothing to do with R itself. You'll need static versions of all libraries you depend on and compilers capable of using them (=and having static libs themselves). In addition, packages are shared libraries in R so all static libraries that can be potentially used need to be PIC-safe (which is normally not the case).

That said, your motivation doesn't seem to be relevant here, because you can simply ship dynamic libraries with R which is much easier and more efficient (since you won't be copying them over and over for each binary and package). The usual motivation for a purely static binary is to ship it as one file but since that's not possible with R (it needs packages etc.) you don't gain anything at all.

Cheers,
Simon



> Thanks,
> 
> From: Alex Bryant
> Sent: Monday, May 10, 2010 2:50 PM
> To: 'r-devel at r-project.org'
> Subject: Build R static
> 
> Hi, I am having trouble building R static on Solaris 5.10.  I have a requirement to run R within a specific user account on Solaris 5.10 and I do not have access to compilers and or shared libraries on the target machine.  I thought I could build R static ( I've build it locally on Solaris with shared libraries) and just ftp the build to the target Solaris box.  Can any help with what ./configure & Make flags need to be set for this, assuming it is possible?
> 
> Here is what my currently built ./bin/exec/R executable is using.
> 
> $ ldd R
>        libRblas.so =>   (file not found)
>        libg2c.so.0 =>   /usr/local/lib/libg2c.so.0
>        libm.so.2 =>     /usr/lib/libm.so.2
>        libreadline.so.6 =>      /usr/local/lib/libreadline.so.6
>        libcurses.so.1 =>        /usr/lib/libcurses.so.1
>        libnsl.so.1 =>   /usr/lib/libnsl.so.1
>        libsocket.so.1 =>        /usr/lib/libsocket.so.1
>        libdl.so.1 =>    /usr/lib/libdl.so.1
>        libiconv.so.2 =>         /usr/local/lib/libiconv.so.2
>        libicuuc.so.3 =>         /usr/lib/libicuuc.so.3
>        libicui18n.so.3 =>       /usr/lib/libicui18n.so.3
>        libc.so.1 =>     /usr/lib/libc.so.1
>        libgcc_s.so.1 =>         /usr/local/lib/libgcc_s.so.1
>        libmp.so.2 =>    /usr/lib/libmp.so.2
>        libmd5.so.1 =>   /usr/lib/libmd5.so.1
>        libscf.so.1 =>   /usr/lib/libscf.so.1
>        libicudata.so.3 =>       /usr/lib/libicudata.so.3
>        libpthread.so.1 =>       /usr/lib/libpthread.so.1
>        libCrun.so.1 =>  /usr/lib/libCrun.so.1
>        libdoor.so.1 =>  /usr/lib/libdoor.so.1
>        libuutil.so.1 =>         /usr/lib/libuutil.so.1
>        /platform/SUNW,Sun-Fire-280R/lib/libc_psr.so.1
>        /platform/SUNW,Sun-Fire-280R/lib/libmd5_psr.so.1
> 
> Thanks for your help,
> Alex
> 
> //************************
> // Alex Bryant
> // Software Developer
> // Integrated Clinical Systems, Inc.
> // 908-996-7208
> 
> 
> ________________________________
> Confidentiality Note: This e-mail, and any attachment to...{{dropped:13}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From murray at stokely.org  Thu May 20 20:21:12 2010
From: murray at stokely.org (Murray Stokely)
Date: Thu, 20 May 2010 11:21:12 -0700
Subject: [Rd] R in sandbox/jail (long question)
In-Reply-To: <4BF34F2C.2020107@gmail.com>
References: <4BF34F2C.2020107@gmail.com>
Message-ID: <AANLkTil2CNsEjZgIWy3pFLq92ZgXifSnDPF9aDANWQWF@mail.gmail.com>

On Tue, May 18, 2010 at 7:38 PM, Assaf Gordon <assafgordon at gmail.com> wrote:
> I've found this old thread:
> http://r.789695.n4.nabble.com/R-in-a-sandbox-jail-td921991.html
> But for technical reasons I'd prefer not to setup a chroot jail.
>

I would also point out that the state of the art in the operating
system community has moved on significantly since 1982 when chroot was
added.  BSD Jails, Solaris Zones/Containers, SELinux, etc. all provide
much more control over the system calls, network connections, and file
and device access granted to applications in different jails/zones.

These operating system capabilities solve exactly some of the problems
you are trying to solve by painstakingly modifying R, but in a more
secure and configurable manner.

             - Murray


From felix at nfrac.org  Fri May 21 02:48:00 2010
From: felix at nfrac.org (Felix Andrews)
Date: Fri, 21 May 2010 10:48:00 +1000
Subject: [Rd] pretty.Date(): changes to axis() methods?
Message-ID: <AANLkTikeI5LoFJRbqgnlvPd1fjDsPKujVfUkIoCADYAs@mail.gmail.com>

Hi all.

pretty() is now generic in R-2.12 and there are new methods for Date
and POSIXt classes.  These methods could potentially be used inside
axis.Date and axis.POSIXt (and Axis methods), although that has not
been decided yet.

The main advantage of the new method is that it is flexible, in the
sense that users can specify the desired number of ticks on an axis.
(e.g. one could easily draw, say, labelled ticks with n = 5, and then
sub-ticks with n = 15).  Of course one can do this manually but
it is not so convenient.

[[ On this issue: I don't use base graphics much, but given how
awkward it is to specify par("xaxp") / par("yaxp"), perhaps a new
axis.Date() should gain arguments 'n' and 'min.n' to pass on to
pretty(). Example given below. ]]

The current version of pretty.Date / pretty.POSIXt gives different
results in some cases to axis.Date / axis.POSIXt: the format strings
for time steps of 1 day, 12 hours and 6 hours are different; and some
different time steps are allowed, such as 10 minutes, 3 hours, 3
months... the full list of possible time steps and their current
default format strings is listed at:
http://svn.r-project.org/R/trunk/src/library/grDevices/R/prettyDate.R
The current axis.Date / axis.POSIXt code, including format strings, is
http://svn.r-project.org/R/trunk/src/library/graphics/R/datetime.R

These settings reflect my personal choices, but are somewhat
arbitrary. I would encourage R-core to make this function their own,
by choosing default format strings and time steps with which they are
comfortable. It could be made more similar to the current axis
methods. E.g. it wouldn't much bother me to remove the "15 mins" time
steps altogether, and a "20 mins" time step could be added.

Here is an example of changing the number of requested ticks on an
axis: (this example does not depend on R 2.12)

source("http://svn.r-project.org/R/trunk/src/library/grDevices/R/prettyDate.R")

times <- as.Date(c("2000-04-02", "2000-06-02"))
devAskNewPage(TRUE)

lapply(c(2,4,6,8,10,20,60), function(n) {
   plot(0:1 ~ times, type = "n", yaxt = "n", ylab = "")
   x <- par("usr")[1:2]
   text(x[1], 0.5, format(times[1]), pos = 4)
   text(x[2], 0.5, format(times[2]), pos = 2)
   text(mean(x), 0.05, "current axis.Date()")
   text(mean(x), 0.95, "proposed new pretty() axis, with")
   text(mean(x), 0.85, paste("n =", n), cex = 1.5)
   ## draw new proposed axis function at top of plot
   timelim <- par("usr")[1:2]
   mostattributes(timelim) <- attributes(times)
   at <- prettyDate(timelim, n = n)
   axis(side = 3, at = at, labels = attr(at, "labels"))
})


Here is a posible modification to axis.Date. As it calls pretty(), it
will only work in R 2.12.

axis.Date <- function(side, x = NA, at, format, labels = TRUE, n = NULL, ...)
{
    mat <- missing(at) || is.null(at)
    if(!mat) x <- as.Date(at) else x <- as.Date(x)
    range <- par("usr")[if(side %%2) 1L:2L else 3:4L]
    range[1L] <- ceiling(range[1L])
    range[2L] <- floor(range[2L])
    class(range) <- "Date"
    ## not sure why we need this (from axis.Date):
    z <- c(range, x[is.finite(x)])
    class(z) <- "Date"
    if (!mat) {
        ## tick mark locations given
        z <- x[is.finite(x)]
        if (missing(format)) format <- ""
    } else {
        ## calculate about 'n' pretty intervals
        if (is.null(n)) {
            is.x <- side %% 2 == 1
            axp <- par(if (is.x) "xaxp" else "yaxp")
            n <- abs(axp[3L])
        }
        z <- pretty(z, n = n)
        if (missing(format) && identical(labels, TRUE))
            labels <- attr(z, "labels")
    }
    keep <- z >= range[1L] & z <= range[2L]
    z <- z[keep]
    z <- sort(unique(z)); class(z) <- "Date"
    if (!is.logical(labels)) labels <- labels[keep]
    else if (identical(labels, TRUE))
	labels <- format.Date(z, format = format)
    else if (identical(labels, FALSE))
	labels <- rep("", length(z)) # suppress labelling of ticks
    axis(side, at = z, labels = labels, ...)
}

Whether to modify axis() methods is up to R-core of course, but I
thought it was worth discussing.

By the way, this new functionality is already included in lattice
0.18-5, which was released with, and depends on, R 2.11.0. (There is
one known issue: the Date method in lattice 0.18-5 can miss a tick at
one end of the axis if your local time zone is not "GMT". Also that
version does not include the new "halfmonth" time step.)

-Felix

-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From antonio.fabio at gmail.com  Fri May 21 16:59:00 2010
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Fri, 21 May 2010 16:59:00 +0200
Subject: [Rd] escaping 'comment' chars in example sections
Message-ID: <AANLkTimbtLbM2peHYs-MHsjSAvSu2Sh9ZPqXu7uKqKhp@mail.gmail.com>

Dear list,
I've noticed that, when writing examples in an Rd file, you need to
escape the '%' character, even if it is valid R code.
I can see maybe this is the intended behaviour, but I found it a bit
surprising, and leads to cryptic error messages from 'R CMD check'.
The relevant section in the "writing R extensions" manual isn't clear
on that point either.

To reproduce the behaviour I'm talking about, you can run this snippet:
##
library(tools)
Rd2ex(parse_Rd(textConnection("
\\title{a}
\\name{b}
\\examples{
'a' %in% letters
}
")))
##
You can see that everything from '%' on is dropped from the output, as
a regular Rd comment. Should this be mentioned in the manual?

cheers,
fabio.

> R.version
               _
platform       x86_64-unknown-linux-gnu
arch           x86_64
os             linux-gnu
system         x86_64, linux-gnu
status         Patched
major          2
minor          11.0
year           2010
month          05
day            19
svn rev        52043
language       R
version.string R version 2.11.0 Patched (2010-05-19 r52043)
-- 
Antonio Fabio Di Narzo, PhD.
Swiss Institute for Bioinformatics - Bioinformatics Core Facility
Office 2029, G?nopode, Quartier Sorge
CH-1015 Lausanne, Switzerland
Tel: +41 21 692 4087
Fax: +41 21 692 4065


From murdoch.duncan at gmail.com  Fri May 21 17:34:05 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 21 May 2010 11:34:05 -0400
Subject: [Rd] escaping 'comment' chars in example sections
In-Reply-To: <AANLkTimbtLbM2peHYs-MHsjSAvSu2Sh9ZPqXu7uKqKhp@mail.gmail.com>
References: <AANLkTimbtLbM2peHYs-MHsjSAvSu2Sh9ZPqXu7uKqKhp@mail.gmail.com>
Message-ID: <4BF6A7ED.2070909@gmail.com>

Antonio, Fabio Di Narzo wrote:
> Dear list,
> I've noticed that, when writing examples in an Rd file, you need to
> escape the '%' character, even if it is valid R code.
> I can see maybe this is the intended behaviour, but I found it a bit
> surprising, and leads to cryptic error messages from 'R CMD check'.
> The relevant section in the "writing R extensions" manual isn't clear
> on that point either.
>   

It says "... Comments run from a percent symbol % to the end of the line 
in all types of text (as on the first line of the load example).

Because backslashes, braces and percent symbols have special meaning, to 
enter them into text sometimes requires escapes using a backslash. In 
general balanced braces do not need to be escaped, but percent symbols 
always do. For the complete list of macros and rules for escapes, see 
?Parsing Rd files?. "

I think that is clear on percent symbols. The situation for backslashes 
and braces is more complicated, and you need to follow the link for 
those rules.

Duncan Murdoch
> To reproduce the behaviour I'm talking about, you can run this snippet:
> ##
> library(tools)
> Rd2ex(parse_Rd(textConnection("
> \\title{a}
> \\name{b}
> \\examples{
> 'a' %in% letters
> }
> ")))
> ##
> You can see that everything from '%' on is dropped from the output, as
> a regular Rd comment. Should this be mentioned in the manual?
>
> cheers,
> fabio.
>
>   
>> R.version
>>     
>                _
> platform       x86_64-unknown-linux-gnu
> arch           x86_64
> os             linux-gnu
> system         x86_64, linux-gnu
> status         Patched
> major          2
> minor          11.0
> year           2010
> month          05
> day            19
> svn rev        52043
> language       R
> version.string R version 2.11.0 Patched (2010-05-19 r52043)
>


From t.jombart at imperial.ac.uk  Fri May 21 17:34:26 2010
From: t.jombart at imperial.ac.uk (Jombart, Thibaut)
Date: Fri, 21 May 2010 16:34:26 +0100
Subject: [Rd] S4 method defined but not used
Message-ID: <0B75A6276180B546A1CA8D2B46E7580503362D5194@ICEXM3.ic.ac.uk>

Dear R developers, 

I am having a slightly weird issue with a S4 method defined in my package adegenet 1.2-4, with R 2.11.0. As far as I know, the problem is new, and the code implementing the method has not changed for more than a year and worked well so far.

The problem is the following. I define, in the package, a method "[" for the S4 class 'genind'. The method's definition is:
setMethod("[", signature(x="genind", i="ANY", j="ANY", drop="ANY"), function(x, i, j, ..., loc=NULL, treatOther=TRUE, drop=FALSE) { 
... ## code of the function
})

When sourcing the code directly from R, this method is found and used normally. However, when loading the package, the method does not seem to be "found" any longer by the dispatcher. For instance, here is an error I get:
### R code
> library(adegenet)
> data(nancycats) # nancycat is a S4 object with class 'genind'
> class(nancycats)
[1] "genind"
attr(,"package")
[1] "adegenet"
> nancycats[1]
Error in nancycats[1] : object of type 'S4' is not subsettable # "[" IS NOT USED HERE
### end R code

And still, the method is defined in the environment:
### R code
> showMethods("[", class="genind")
Function: [ (package base)
x="genind"

> findMethods("[", classes="genind")$genind
Method Definition:

function (x, i, j, ..., drop = FALSE) 
{
    .local <- function (x, i, j, ..., loc = NULL, treatOther = TRUE, 
        drop = FALSE) 
    {
        if (missing(i)) 
            i <- TRUE
        if (missing(j)) 
            j <- TRUE
        pop <- NULL

... # rest of the code of the function
### end R code

findMethods and showMethods find the method. However, getMethod doesn't:
### R code
> getMethod("[","genind")
Error in getMethod("[", "genind") : 
  No method found for function "[" and signature genind
### end R code

Now, if I just try the same thing after sourcing the code of the method manually, everything works fine. showMethods then reads:
### R code
> showMethods("[", classes="genind")
Function: [ (package base)
x="genind"
x="genind", i="ANY", j="ANY", drop="ANY"
x="genind", i="numeric", j="missing", drop="missing"
    (inherited from: x="genind", i="ANY", j="ANY", drop="ANY")
### end R code

My R version/session is:
### R code
> R.version
               _                            
platform       i686-pc-linux-gnu            
arch           i686                         
os             linux-gnu                    
system         i686, linux-gnu              
status                                      
major          2                            
minor          11.0                         
year           2010                         
month          04                           
day            22                           
svn rev        51801                        
language       R                            
version.string R version 2.11.0 (2010-04-22)

> sessionInfo()
R version 2.11.0 (2010-04-22) 
i686-pc-linux-gnu 

locale:
 [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C             
 [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8    
 [5] LC_MONETARY=C             LC_MESSAGES=en_GB.utf8   
 [7] LC_PAPER=en_GB.utf8       LC_NAME=C                
 [9] LC_ADDRESS=C              LC_TELEPHONE=C           
[11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C      

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] adegenet_1.2-4 MASS_7.3-5    

loaded via a namespace (and not attached):
[1] graph_1.26.0  phylobase_0.5 tcltk_2.11.0  tools_2.11.0 

### end R code

R was compiled from the sources. All packages are up-to-date (as of the 21 May 2010). My system is a Ubuntu 10.04 (32 bits), with kernel 2.6.31-20-generic. I could not reproduce the problem using R 2.11.0 on Windows Vista, or on Debian testing (R 2.11.0 compiled from the sources). The package adegenet does not have a namespace. The error arises whether using a field 'Collate' in DESCRIPTION, or not. I checked that the source file is indeed sourced when loading the package: it is. The method "[" is not defined by any other package for 'genind' objects.

I would be pleased to get any piece of insight, advice, or explanation for this issue. Thanks in advance for your time.

Best regards,

Thibaut Jombart.


-- 
######################################
Dr Thibaut JOMBART
MRC Centre for Outbreak Analysis and Modelling
Department of Infectious Disease Epidemiology
Imperial College - Faculty of Medicine
St Mary?s Campus
Norfolk Place
London W2 1PG
United Kingdom
Tel. : 0044 (0)20 7594 3658
t.jombart at imperial.ac.uk
http://sites.google.com/site/thibautjombart/
http://adegenet.r-forge.r-project.org/


From djsamperi at gmail.com  Fri May 21 22:35:48 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Fri, 21 May 2010 16:35:48 -0400
Subject: [Rd] dyn.load() strange behavior
Message-ID: <AANLkTilbED_tlJJV9wZd8iZDKd-7P0vPYhbKT3CzehHK@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100521/4b4e5920/attachment.pl>

From hb at stat.berkeley.edu  Sat May 22 10:37:15 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Sat, 22 May 2010 10:37:15 +0200
Subject: [Rd] R.exe crashes on R v2.12.0dev (Windows Vista)
Message-ID: <AANLkTil-qGz1b5GeI-pr1RkzASTLV3wx6Ucr5rJM99-T@mail.gmail.com>

Using the latest developers version of R [2.12.0 Under development
(unstable) (2010-05-21 r52061)], R.exe crashes:

"%ProgramFiles%/R/R-2.12.0dev/bin/i386/R.exe"

with Windows reporting:

Problem signature:
  Problem Event Name:	APPCRASH
  Application Name:	R.exe
  Application Version:	2.120.52061.0
  Application Timestamp:	4bf638bd
  Fault Module Name:	R.exe
  Fault Module Version:	2.120.52061.0
  Fault Module Timestamp:	4bf638bd
  Exception Code:	c0000005
  Exception Offset:	00001d94
  OS Version:	6.0.6002.2.2.0.256.6
  Locale ID:	1033
  Additional Information 1:	1c1d
  Additional Information 2:	e064c795479179a5f08d19e37de8915e
  Additional Information 3:	50ea
  Additional Information 4:	02a385f4f3dcffff3301c3a9d270f946

same occurs when calling:

"%ProgramFiles%/R/R-2.12.0dev/bin/R.exe"

However,

C:\Users\hb\braju.com.R\R.matlab,R-forge>"%ProgramFiles%/R/R-2.12.0dev/bin/i386/Rterm.exe"
-e "sessionInfo()"

R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i386-pc-mingw32/i386 (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> sessionInfo()
R version 2.12.0 Under development (unstable) (2010-05-21 r52061)
i386-pc-mingw32

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From erich.neuwirth at univie.ac.at  Sat May 22 16:08:10 2010
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Sat, 22 May 2010 16:08:10 +0200
Subject: [Rd] exmaple problems
Message-ID: <4BF7E54A.9060007@univie.ac.at>

I do not know if this has been reported already
(I searched the headers of the recent messages to r-devel)
It seems that 'example' in R 2.11.0 has a problem when the help file
does not contain any example.
This is what happens on R 2.11.0 on Windows XP.

> library(tools)
> example(Rdiff)
Error in file(con, "r") : cannot open the connection
In addition: Warning message:
In file(con, "r") :
  cannot open file
'C:\DOCUME~1\neuwirth\LOCALS~1\Temp\RtmpmknOJe\Rex678418be': No such
file or directory

The error does not occur when there is an example marked #Not Run:

The problem does not appear in R 2.10.1
> library(tools)
> example(Rdiff)
Warning message:
In example(Rdiff) : 'Rdiff' has a help file but no examples
>


-- 
Erich Neuwirth, University of Vienna
Faculty of Computer Science
Center for Computer Science Didactics and Learning Research
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-39902 Fax: +43-1-4277-39459


From ligges at statistik.tu-dortmund.de  Sat May 22 16:12:51 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 22 May 2010 16:12:51 +0200
Subject: [Rd] dyn.load() strange behavior
In-Reply-To: <AANLkTilbED_tlJJV9wZd8iZDKd-7P0vPYhbKT3CzehHK@mail.gmail.com>
References: <AANLkTilbED_tlJJV9wZd8iZDKd-7P0vPYhbKT3CzehHK@mail.gmail.com>
Message-ID: <4BF7E663.2040700@statistik.tu-dortmund.de>

- Does bar really dyn.load its shared library on load?
- Have you told package foo (in the DESCRIPTION) it is LinkingTo: bar ?

Uwe Ligges



On 21.05.2010 22:35, Dominick Samperi wrote:
> Hello,
>
> I am observing the following strange behavior when I try to
> load a shared library using dyn.load() under Linux...
>
> The library foo.so refers to a symbol in another package bar
> (with shared library bar.so), I get:
>
> dyn.load('foo.so') # error message because I forgot to load bar
> library(bar) # so I fix it
> dyn.load('foo.so') # works this time and everything is fine
>
> But, if restart my R session and do it "right" the second
> time there is a surprise:
>
> library(bar)
> dyn.load('foo.so') # fails
> library(bar) # just to be sure?
> dyn.load('foo.so) # fails again
> dyn.load('/usr/local/lib64/library/bar/lib/libbar.so') # just to be really
> sure?
> dyn.load('foo.so')
>
> In other words, it is possible to load foo.so, but only
> after a failed attempt. If I remember to load the required
> package bar I cannot load the depenent library foo.so.
>
> Any ideas?
>
> Thanks,
> Dominick
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From erich.neuwirth at univie.ac.at  Sat May 22 16:45:27 2010
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Sat, 22 May 2010 16:45:27 +0200
Subject: [Rd] exmaple problems
In-Reply-To: <4BF7E54A.9060007@univie.ac.at>
References: <4BF7E54A.9060007@univie.ac.at>
Message-ID: <4BF7EE07.90208@univie.ac.at>

The problem still exists in the beta of R 2.11.1 I just build from the
sources. (WinXP)

R version 2.11.1 beta (2006-00-00 r00000)


On 5/22/2010 4:08 PM, Erich Neuwirth wrote:
> I do not know if this has been reported already
> (I searched the headers of the recent messages to r-devel)
> It seems that 'example' in R 2.11.0 has a problem when the help file
> does not contain any example.
> This is what happens on R 2.11.0 on Windows XP.
> 
>> library(tools)
>> example(Rdiff)
> Error in file(con, "r") : cannot open the connection
> In addition: Warning message:
> In file(con, "r") :
>   cannot open file
> 'C:\DOCUME~1\neuwirth\LOCALS~1\Temp\RtmpmknOJe\Rex678418be': No such
> file or directory
> 
> The error does not occur when there is an example marked #Not Run:
> 
> The problem does not appear in R 2.10.1
>> library(tools)
>> example(Rdiff)
> Warning message:
> In example(Rdiff) : 'Rdiff' has a help file but no examples
>>
> 
> 

-- 
Erich Neuwirth, University of Vienna
Faculty of Computer Science
Center for Computer Science Didactics and Learning Research
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-39902 Fax: +43-1-4277-39459


From djsamperi at gmail.com  Sat May 22 18:26:25 2010
From: djsamperi at gmail.com (Dominick Samperi)
Date: Sat, 22 May 2010 12:26:25 -0400
Subject: [Rd] dyn.load() strange behavior
In-Reply-To: <4BF7E663.2040700@statistik.tu-dortmund.de>
References: <AANLkTilbED_tlJJV9wZd8iZDKd-7P0vPYhbKT3CzehHK@mail.gmail.com>
	<4BF7E663.2040700@statistik.tu-dortmund.de>
Message-ID: <AANLkTildRYKVLpkQvnYth5CpiGkuVfJGUaQoBIVg4gtI@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100522/0914b675/attachment.pl>

From mtmorgan at fhcrc.org  Sun May 23 00:24:10 2010
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sat, 22 May 2010 15:24:10 -0700
Subject: [Rd] S4 method defined but not used
In-Reply-To: <0B75A6276180B546A1CA8D2B46E7580503362D5194@ICEXM3.ic.ac.uk>
References: <0B75A6276180B546A1CA8D2B46E7580503362D5194@ICEXM3.ic.ac.uk>
Message-ID: <4BF8598A.6030707@fhcrc.org>

Hi Thibaut --

On 05/21/2010 08:34 AM, Jombart, Thibaut wrote:
> Dear R developers, 
> 
> I am having a slightly weird issue with a S4 method defined in my package adegenet 1.2-4, with R 2.11.0. As far as I know, the problem is new, and the code implementing the method has not changed for more than a year and worked well so far.
> 
> The problem is the following. I define, in the package, a method "[" for the S4 class 'genind'. The method's definition is:
> setMethod("[", signature(x="genind", i="ANY", j="ANY", drop="ANY"), function(x, i, j, ..., loc=NULL, treatOther=TRUE, drop=FALSE) { 
> ... ## code of the function
> })
> 
> When sourcing the code directly from R, this method is found and used normally. However, when loading the package, the method does not seem to be "found" any longer by the dispatcher. For instance, here is an error I get:
> ### R code
>> library(adegenet)
>> data(nancycats) # nancycat is a S4 object with class 'genind'
>> class(nancycats)
> [1] "genind"
> attr(,"package")
> [1] "adegenet"
>> nancycats[1]
> Error in nancycats[1] : object of type 'S4' is not subsettable # "[" IS NOT USED HERE
> ### end R code

For what it's worth, I can't reproduce this problem, and in a new R
session after library(adegenet) I have

> sessionInfo()
R version 2.11.0 Patched (2010-05-01 r51886)
x86_64-unknown-linux-gnu

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base

other attached packages:
[1] adegenet_1.2-4 MASS_7.3-5

which has a different set of attached / loaded packages -- maybe you are
picking up something from .RData or .Rprofile, and you need to start R
with --vanilla?

Martin



> 
> And still, the method is defined in the environment:
> ### R code
>> showMethods("[", class="genind")
> Function: [ (package base)
> x="genind"
> 
>> findMethods("[", classes="genind")$genind
> Method Definition:
> 
> function (x, i, j, ..., drop = FALSE) 
> {
>     .local <- function (x, i, j, ..., loc = NULL, treatOther = TRUE, 
>         drop = FALSE) 
>     {
>         if (missing(i)) 
>             i <- TRUE
>         if (missing(j)) 
>             j <- TRUE
>         pop <- NULL
> 
> ... # rest of the code of the function
> ### end R code
> 
> findMethods and showMethods find the method. However, getMethod doesn't:
> ### R code
>> getMethod("[","genind")
> Error in getMethod("[", "genind") : 
>   No method found for function "[" and signature genind
> ### end R code
> 
> Now, if I just try the same thing after sourcing the code of the method manually, everything works fine. showMethods then reads:
> ### R code
>> showMethods("[", classes="genind")
> Function: [ (package base)
> x="genind"
> x="genind", i="ANY", j="ANY", drop="ANY"
> x="genind", i="numeric", j="missing", drop="missing"
>     (inherited from: x="genind", i="ANY", j="ANY", drop="ANY")
> ### end R code
> 
> My R version/session is:
> ### R code
>> R.version
>                _                            
> platform       i686-pc-linux-gnu            
> arch           i686                         
> os             linux-gnu                    
> system         i686, linux-gnu              
> status                                      
> major          2                            
> minor          11.0                         
> year           2010                         
> month          04                           
> day            22                           
> svn rev        51801                        
> language       R                            
> version.string R version 2.11.0 (2010-04-22)
> 
>> sessionInfo()
> R version 2.11.0 (2010-04-22) 
> i686-pc-linux-gnu 
> 
> locale:
>  [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C             
>  [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8    
>  [5] LC_MONETARY=C             LC_MESSAGES=en_GB.utf8   
>  [7] LC_PAPER=en_GB.utf8       LC_NAME=C                
>  [9] LC_ADDRESS=C              LC_TELEPHONE=C           
> [11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C      
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> other attached packages:
> [1] adegenet_1.2-4 MASS_7.3-5    
> 
> loaded via a namespace (and not attached):
> [1] graph_1.26.0  phylobase_0.5 tcltk_2.11.0  tools_2.11.0 
> 
> ### end R code
> 
> R was compiled from the sources. All packages are up-to-date (as of the 21 May 2010). My system is a Ubuntu 10.04 (32 bits), with kernel 2.6.31-20-generic. I could not reproduce the problem using R 2.11.0 on Windows Vista, or on Debian testing (R 2.11.0 compiled from the sources). The package adegenet does not have a namespace. The error arises whether using a field 'Collate' in DESCRIPTION, or not. I checked that the source file is indeed sourced when loading the package: it is. The method "[" is not defined by any other package for 'genind' objects.
> 
> I would be pleased to get any piece of insight, advice, or explanation for this issue. Thanks in advance for your time.
> 
> Best regards,
> 
> Thibaut Jombart.
> 
> 


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From leydold at statmath.wu.ac.at  Sun May 23 16:14:55 2010
From: leydold at statmath.wu.ac.at (Josef Leydold)
Date: Sun, 23 May 2010 16:14:55 +0200
Subject: [Rd] possible bug in formals
In-Reply-To: <mailman.13.1251540004.31955.r-devel@r-project.org>
References: <mailman.13.1251540004.31955.r-devel@r-project.org>
Message-ID: <20100523141455.GA17210@zwirn.stat-math.wu.ac.at>

Hi,

I am a little bit surprised by the following output of
'formals'. Is this the intended behavior?

> f <- function(a=1,b=-1) { a+b }
> class(formals(f)$a)
[1] "numeric"
> class(formals(f)$b)
[1] "call"


Josef


-- 


-----------------------------------------------------------------------------
Josef Leydold   |  WU (Vienna University of Economics and Business)
                |  Institute for Statistics and Mathematics
-----------------------------------------------------------------------------
Augasse 2-6     |  Tel.   +43 1 31336 4695
A-1090 Vienna   |  FAX    +43 1 31336 774
European Union  |  email  josef.leydold at wu.ac.at


From ligges at statistik.tu-dortmund.de  Sun May 23 16:20:01 2010
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 23 May 2010 16:20:01 +0200
Subject: [Rd] possible bug in formals
In-Reply-To: <20100523141455.GA17210@zwirn.stat-math.wu.ac.at>
References: <mailman.13.1251540004.31955.r-devel@r-project.org>
	<20100523141455.GA17210@zwirn.stat-math.wu.ac.at>
Message-ID: <4BF93991.5090809@statistik.tu-dortmund.de>



On 23.05.2010 16:14, Josef Leydold wrote:
> Hi,
>
> I am a little bit surprised by the following output of
> 'formals'. Is this the intended behavior?
>
>> f<- function(a=1,b=-1) { a+b }
>> class(formals(f)$a)
> [1] "numeric"
>> class(formals(f)$b)
> [1] "call"
>
>
> Josef
>
>


Yes, the arguments have not yet been evaluated, hence -1 is still a 
language object.

Try to write
  f<- function(a= +1, b= -1) { a+b }
and you will find that this is a fascinating feature.

Uwe Ligges


From thmsfuller066 at gmail.com  Sun May 23 22:36:49 2010
From: thmsfuller066 at gmail.com (thmsfuller066 at gmail.com)
Date: Sun, 23 May 2010 15:36:49 -0500
Subject: [Rd] Is it possible to generate an error when a function is
	reassigned?
Message-ID: <AANLkTimFWoNjpbgagyXiMkYpKUJ_-3KHRk-BZY7a7IYB@mail.gmail.com>

Hello All,

length() is a function. If I accidentally assign something else to
length, it will give me some unexpected results.

Although the freedom to redefine any funcion maybe good in sometime,
it may be unwanted in many other cases. Is there a way to forbidden
such changes on functions?

-- 
Tom


From murdoch.duncan at gmail.com  Sun May 23 23:35:41 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 23 May 2010 17:35:41 -0400
Subject: [Rd] Is it possible to generate an error when a function is
	reassigned?
In-Reply-To: <AANLkTimFWoNjpbgagyXiMkYpKUJ_-3KHRk-BZY7a7IYB@mail.gmail.com>
References: <AANLkTimFWoNjpbgagyXiMkYpKUJ_-3KHRk-BZY7a7IYB@mail.gmail.com>
Message-ID: <4BF99FAD.9050304@gmail.com>

thmsfuller066 at gmail.com wrote:
> Hello All,
>
> length() is a function. If I accidentally assign something else to
> length, it will give me some unexpected results.
>
> Although the freedom to redefine any funcion maybe good in sometime,
> it may be unwanted in many other cases. Is there a way to forbidden
> such changes on functions?
>
>   
You aren't changing length(), you're creating a new function with the 
same name that hides the original one.  The distinction is important 
because packages with namespaces will not be affected by your error, 
it's not really as serious as you might think.

The general advice to protect yourself from mistakes like this is to 
limit how much of your code you keep in the global environment.  Keep 
your code in scripts and source them into an empty environment, or 
(better) put your code into a package and use a namespace.  If you make 
a mistake and hide an important function you'll still cause local 
problems, but you may find it easier to fix them.

Duncan Murdoch


From t.jombart at imperial.ac.uk  Mon May 24 12:07:23 2010
From: t.jombart at imperial.ac.uk (Jombart, Thibaut)
Date: Mon, 24 May 2010 11:07:23 +0100
Subject: [Rd] S4 method defined but not used
In-Reply-To: <4BF8598A.6030707@fhcrc.org>
References: <0B75A6276180B546A1CA8D2B46E7580503362D5194@ICEXM3.ic.ac.uk>,
	<4BF8598A.6030707@fhcrc.org>
Message-ID: <0B75A6276180B546A1CA8D2B46E7580503362D5198@ICEXM3.ic.ac.uk>

Dear Martin,

thanks for giving it a try. I forgot to mention I had removed the .RData, and started R without using the .Rprofile. R --vanilla did not help.

However, I made another try on another computer with the same packages, R version, and OS, and I fail to reproduce this error.

Best regards

Thibaut
 
> Hi Thibaut --
>
> For what it's worth, I can't reproduce this problem, and in a new R
> session after library(adegenet) I have
>
>> sessionInfo()
> R version 2.11.0 Patched (2010-05-01 r51886)
> x86_64-unknown-linux-gnu
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices datasets  utils     methods   base
>
> other attached packages:
> [1] adegenet_1.2-4 MASS_7.3-5
>
> which has a different set of attached / loaded packages -- maybe you are
> picking up something from .RData or .Rprofile, and you need to start R
> with --vanilla?
>
> Martin


From leydold at statmath.wu.ac.at  Mon May 24 15:44:42 2010
From: leydold at statmath.wu.ac.at (Josef Leydold)
Date: Mon, 24 May 2010 15:44:42 +0200
Subject: [Rd] possible bug in formals
In-Reply-To: <alpine.LFD.2.00.1005231547290.376@gannet.stats.ox.ac.uk>
References: <mailman.13.1251540004.31955.r-devel@r-project.org>
	<20100523141455.GA17210@zwirn.stat-math.wu.ac.at>
	<4BF93991.5090809@statistik.tu-dortmund.de>
	<alpine.LFD.2.00.1005231547290.376@gannet.stats.ox.ac.uk>
Message-ID: <20100524134442.GA18978@zwirn.stat-math.wu.ac.at>

Dear Brian and Uwe,

Thanks a lot for the clarification.
I made the naive assumption that numeric constants in R are similar to
those in C. 

Two questions still remain:

(1) when I have a function 

    f<- function(a=1,b=-1) { a+b }

    is it safe to use 

    val <- as.character(deparse(formals(f)$b))

    to obtain a string that contains the default value for
    argument "b". (Does is also work for other arguments with some 
    default of arbitrary class?)

(2) I have seen that packages like gWidget (in function ggenericwidget)
    use a statement like

    switch(class(formals(f)$b),
	numeric = { .... },
        character = { .... },
        class = { .... }, ....

    for automatically processing function arguments.
    in the case of "b=-1" this procedure obviously fails.
    (I found this behavior of 'formals' while playing around with 
    packages "gWidgets" and "fgui" from CRAN).

    Is there a safe workaround for this problem?

    That is, is there a safe function that returns class
    "numeric" for an exresion like "-1" or "-Inf"?

Josef


On Sun, May 23, 2010 at 03:52:00PM +0100, Prof Brian Ripley wrote:
> Documented too: from ?NumericConstants
> 
>       Note that a leading plus or minus is not regarded by the parser as
>       part of a numeric constant but as a unary operator applied to the
>       constant.
> 
> 
> 
> On Sun, 23 May 2010, Uwe Ligges wrote:
> 
> >
> >
> > On 23.05.2010 16:14, Josef Leydold wrote:
> >> Hi,
> >> 
> >> I am a little bit surprised by the following output of
> >> 'formals'. Is this the intended behavior?
> >> 
> >>> f<- function(a=1,b=-1) { a+b }
> >>> class(formals(f)$a)
> >> [1] "numeric"
> >>> class(formals(f)$b)
> >> [1] "call"
> >> 
> >> 
> >> Josef
> >> 
> >> 
> >
> >
> > Yes, the arguments have not yet been evaluated, hence -1 is still a language 
> > object.
> >
> > Try to write
> > f<- function(a= +1, b= -1) { a+b }
> > and you will find that this is a fascinating feature.
> >
> > Uwe Ligges
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-- 


-----------------------------------------------------------------------------
Josef Leydold   |  WU (Vienna University of Economics and Business)
                |  Institute for Statistics and Mathematics
-----------------------------------------------------------------------------
Augasse 2-6     |  Tel.   +43 1 31336 4695
A-1090 Vienna   |  FAX    +43 1 31336 774
European Union  |  email  josef.leydold at wu.ac.at
-----------------------------------------------------------------------------
Alles Unglueck kam daher, dass die Denkenden nicht mehr handeln konnten,
und die Handelnden keine Zeit mehr fanden zu denken.       (Marlen Haushofer)


From ripley at stats.ox.ac.uk  Mon May 24 16:47:38 2010
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 24 May 2010 15:47:38 +0100 (BST)
Subject: [Rd] possible bug in formals
In-Reply-To: <20100524134442.GA18978@zwirn.stat-math.wu.ac.at>
References: <mailman.13.1251540004.31955.r-devel@r-project.org>
	<20100523141455.GA17210@zwirn.stat-math.wu.ac.at>
	<4BF93991.5090809@statistik.tu-dortmund.de>
	<alpine.LFD.2.00.1005231547290.376@gannet.stats.ox.ac.uk>
	<20100524134442.GA18978@zwirn.stat-math.wu.ac.at>
Message-ID: <alpine.LFD.2.00.1005241542440.25587@gannet.stats.ox.ac.uk>

On Mon, 24 May 2010, Josef Leydold wrote:

> Dear Brian and Uwe,
>
> Thanks a lot for the clarification.
> I made the naive assumption that numeric constants in R are similar to
> those in C.
>
> Two questions still remain:
>
> (1) when I have a function
>
>    f<- function(a=1,b=-1) { a+b }
>
>    is it safe to use
>
>    val <- as.character(deparse(formals(f)$b))
>
>    to obtain a string that contains the default value for
>    argument "b". (Does is also work for other arguments with some
>    default of arbitrary class?)

But the defualt value is not character, so this cannot in general be 
done.

>
> (2) I have seen that packages like gWidget (in function ggenericwidget)
>    use a statement like
>
>    switch(class(formals(f)$b),
> 	numeric = { .... },
>        character = { .... },
>        class = { .... }, ....
>
>    for automatically processing function arguments.
>    in the case of "b=-1" this procedure obviously fails.
>    (I found this behavior of 'formals' while playing around with
>    packages "gWidgets" and "fgui" from CRAN).
>
>    Is there a safe workaround for this problem?
>
>    That is, is there a safe function that returns class
>    "numeric" for an exresion like "-1" or "-Inf"?

Why are you using class() when you seem to mean typeof()?

But the short answer is you appear to be trying to circumvent the 
language, and who really cares what the default is?  If it is used, it 
is evaluated, and then you can simply do typeof(b).  And if it is not 
used, who cares what it is?

>
> Josef
>
>
> On Sun, May 23, 2010 at 03:52:00PM +0100, Prof Brian Ripley wrote:
>> Documented too: from ?NumericConstants
>>
>>       Note that a leading plus or minus is not regarded by the parser as
>>       part of a numeric constant but as a unary operator applied to the
>>       constant.
>>
>>
>>
>> On Sun, 23 May 2010, Uwe Ligges wrote:
>>
>>>
>>>
>>> On 23.05.2010 16:14, Josef Leydold wrote:
>>>> Hi,
>>>>
>>>> I am a little bit surprised by the following output of
>>>> 'formals'. Is this the intended behavior?
>>>>
>>>>> f<- function(a=1,b=-1) { a+b }
>>>>> class(formals(f)$a)
>>>> [1] "numeric"
>>>>> class(formals(f)$b)
>>>> [1] "call"
>>>>
>>>>
>>>> Josef
>>>>
>>>>
>>>
>>>
>>> Yes, the arguments have not yet been evaluated, hence -1 is still a language
>>> object.
>>>
>>> Try to write
>>> f<- function(a= +1, b= -1) { a+b }
>>> and you will find that this is a fascinating feature.
>>>
>>> Uwe Ligges
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>
> -- 
>
>
> -----------------------------------------------------------------------------
> Josef Leydold   |  WU (Vienna University of Economics and Business)
>                |  Institute for Statistics and Mathematics
> -----------------------------------------------------------------------------
> Augasse 2-6     |  Tel.   +43 1 31336 4695
> A-1090 Vienna   |  FAX    +43 1 31336 774
> European Union  |  email  josef.leydold at wu.ac.at
> -----------------------------------------------------------------------------
> Alles Unglueck kam daher, dass die Denkenden nicht mehr handeln konnten,
> und die Handelnden keine Zeit mehr fanden zu denken.       (Marlen Haushofer)
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From source.code.devel at gmail.com  Mon May 24 20:59:13 2010
From: source.code.devel at gmail.com (Peter Holt)
Date: Mon, 24 May 2010 14:59:13 -0400
Subject: [Rd] Accessing functions from a package
Message-ID: <AANLkTikm-h6ke-Qg5bPOGxb85UifwNJrPg1dAg-8MFC6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100524/8e528a8d/attachment.pl>

From simon.urbanek at r-project.org  Tue May 25 14:13:16 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 25 May 2010 08:13:16 -0400
Subject: [Rd] Accessing functions from a package
In-Reply-To: <AANLkTikm-h6ke-Qg5bPOGxb85UifwNJrPg1dAg-8MFC6@mail.gmail.com>
References: <AANLkTikm-h6ke-Qg5bPOGxb85UifwNJrPg1dAg-8MFC6@mail.gmail.com>
Message-ID: <BFB974D2-51D7-4CC0-AF0E-177F0D97DF31@r-project.org>


On May 24, 2010, at 2:59 PM, Peter Holt wrote:

> Hi All,
> 
> I created a .R file with source code that accesses functions from a R
> package (example, fTrading).
> 
> I then run the created application in two different configurations:
> 
> 1. I started a R session, and then ran the application using the source
> ("my_application.R") command, and I measured the time the application ran.
> 
> 2. I started 2 R sessions in the same processor, and executed the same
> source ("my_application.R") command, and measured the times the application
> ran.
> 
> The times I measured for each applications in #2 was slower than the times I
> measured for the application in #1.
> 
> The application was run in a 4-core machine running Linux.
> 
> When the application ran, i used "mpstat" to look at the CPU usage. For #1,
> the CPU usage was 25%, and for #2, the CPU usage was 50%.
> 
> No other process was running in the machine.
> 
> My question is, why would #2 be slower than #1?
> 

Because you're running twice the load? Why shouldn't it? Even on multi-core machines there is overhead associated with running processes or threads in parallel (they access the same resources), so #2 is always expected to be slower. However, you failed to include any relevant details (how do you measure the time, how much slower was it, how do you start the sessions etc.) so the difference could be really anywhere.

Cheers,
Simon


From bolker at ufl.edu  Tue May 25 22:25:12 2010
From: bolker at ufl.edu (Ben Bolker)
Date: Tue, 25 May 2010 16:25:12 -0400
Subject: [Rd] warning from install.packages()
Message-ID: <4BFC3228.9010400@ufl.edu>


  Just curious: is there a particular reason why install.packages()
gives a warning in normal use when 'lib' is not specified (e.g. argument
'lib' is missing: using '/usr/local/lib/R/site-library' )?  It would
seem to me that this is normal behavior as documented (" If missing,
defaults to the first element of ?.libPaths()?.")  It's one of the most
common questions I have to answer for students during introductory R
sessions ...

  If there's not, would anyone get annoyed if I submitted a wishlist
item to have it suppressed by default?

   Ben Bolker


From alex at bedatadriven.com  Tue May 25 22:51:00 2010
From: alex at bedatadriven.com (Alexander Bertram)
Date: Tue, 25 May 2010 22:51:00 +0200
Subject: [Rd] R without dynamic libraries: anyone working on this?
Message-ID: <AANLkTim6jJK59uZTEt8nM-uZvhzSP5VX9FmkGIlCB_Fl@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100525/57252948/attachment.pl>

From jari.oksanen at oulu.fi  Tue May 25 23:10:35 2010
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Wed, 26 May 2010 00:10:35 +0300
Subject: [Rd] warning from install.packages()
In-Reply-To: <4BFC3228.9010400@ufl.edu>
Message-ID: <C822177B.EBC1%jari.oksanen@oulu.fi>

On 25/05/10 23:25 PM, "Ben Bolker" <bolker at ufl.edu> wrote:

> 
  Just curious: is there a particular reason why install.packages()
gives a
> warning in normal use when 'lib' is not specified (e.g. argument
'lib' is
> missing: using '/usr/local/lib/R/site-library' )?  It would
seem to me that
> this is normal behavior as documented (" If missing,
defaults to the first
> element of ?.libPaths()?.")

Indeed, should this be a message()?

cheers, jaz


From felix at nfrac.org  Wed May 26 02:29:19 2010
From: felix at nfrac.org (Felix Andrews)
Date: Wed, 26 May 2010 10:29:19 +1000
Subject: [Rd] SVN vs DVCS
Message-ID: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>

Hi,

Just wondering whether anyone had thought about moving the R sources
to a "distributed" version control system such as Bazaar, Git or
Mercurial. These new generation systems make it easier to work on
feature branches, allow working offline, are very fast, etc.

Some projects that have moved to Git are
Linux Kernel
Perl
Ruby on Rails
...
http://en.wikipedia.org/wiki/Git_(software)

Some projects that have moved to Bazaar (bzr) are
Ubuntu
MySQL
Inkscape
...
http://en.wikipedia.org/wiki/Bazaar_(software)

Some projects that have moved to Mercurial (hg) are
Mozilla
Octave
Python
...
http://en.wikipedia.org/wiki/Mercurial_(software)

Joel Spolky's take on it:
http://www.joelonsoftware.com/items/2010/03/17.html

Regards
-Felix

-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From felix at nfrac.org  Wed May 26 03:20:12 2010
From: felix at nfrac.org (Felix Andrews)
Date: Wed, 26 May 2010 11:20:12 +1000
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
Message-ID: <AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>

On second thoughts it is really none of my business how the R sources
are managed.
But I would encourage package developers and/or r-forge maintainers to
consider these systems.
Regards
-Felix

On 26 May 2010 10:29, Felix Andrews <felix at nfrac.org> wrote:
> Hi,
>
> Just wondering whether anyone had thought about moving the R sources
> to a "distributed" version control system such as Bazaar, Git or
> Mercurial. These new generation systems make it easier to work on
> feature branches, allow working offline, are very fast, etc.
>
> Some projects that have moved to Git are
> Linux Kernel
> Perl
> Ruby on Rails
> ...
> http://en.wikipedia.org/wiki/Git_(software)
>
> Some projects that have moved to Bazaar (bzr) are
> Ubuntu
> MySQL
> Inkscape
> ...
> http://en.wikipedia.org/wiki/Bazaar_(software)
>
> Some projects that have moved to Mercurial (hg) are
> Mozilla
> Octave
> Python
> ...
> http://en.wikipedia.org/wiki/Mercurial_(software)
>
> Joel Spolky's take on it:
> http://www.joelonsoftware.com/items/2010/03/17.html
>
> Regards
> -Felix
>
> --
> Felix Andrews / ???
> Postdoctoral Fellow
> Integrated Catchment Assessment and Management (iCAM) Centre
> Fenner School of Environment and Society [Bldg 48a]
> The Australian National University
> Canberra ACT 0200 Australia
> M: +61 410 400 963
> T: + 61 2 6125 4670
> E: felix.andrews at anu.edu.au
> CRICOS Provider No. 00120C
> --
> http://www.neurofractal.org/felix/
>



-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From maechler at stat.math.ethz.ch  Wed May 26 11:44:44 2010
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 26 May 2010 11:44:44 +0200
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
Message-ID: <19452.60812.190425.523797@lynne.math.ethz.ch>

>>>>> Felix Andrews <felix at nfrac.org>
>>>>>     on Wed, 26 May 2010 11:20:12 +1000 writes:

    > On second thoughts it is really none of my business how the R sources
    > are managed.
    > But I would encourage package developers and/or r-forge maintainers to
    > consider these systems.

Thank you, Felix, for the compilation of these alternatives.

One very relevant piece of information that you've not added,
is, how easily one could *move* from svn to such a system
(including the full history of every file with revision numbers,
 log messages, etc),
and .. for R-forge, e.g., which of these provide nice and
flexible tools (as svn does) for an automatic web interface to
inspect file histories, differences, etc.

Regards,
Martin  ( maintainer of svn.r-project.org )

    > Regards
    > -Felix

    > On 26 May 2010 10:29, Felix Andrews <felix at nfrac.org> wrote:
    >> Hi,
    >> 
    >> Just wondering whether anyone had thought about moving the R sources
    >> to a "distributed" version control system such as Bazaar, Git or
    >> Mercurial. These new generation systems make it easier to work on
    >> feature branches, allow working offline, are very fast, etc.
    >> 
    >> Some projects that have moved to Git are
    >> Linux Kernel
    >> Perl
    >> Ruby on Rails
    >> ...
    >> http://en.wikipedia.org/wiki/Git_(software)
    >> 
    >> Some projects that have moved to Bazaar (bzr) are
    >> Ubuntu
    >> MySQL
    >> Inkscape
    >> ...
    >> http://en.wikipedia.org/wiki/Bazaar_(software)
    >> 
    >> Some projects that have moved to Mercurial (hg) are
    >> Mozilla
    >> Octave
    >> Python
    >> ...
    >> http://en.wikipedia.org/wiki/Mercurial_(software)
    >> 
    >> Joel Spolky's take on it:
    >> http://www.joelonsoftware.com/items/2010/03/17.html
    >> 
    >> Regards
    >> -Felix
    >> 
    >> --
    >> Felix Andrews / ???
    >> Postdoctoral Fellow
    >> Integrated Catchment Assessment and Management (iCAM) Centre
    >> Fenner School of Environment and Society [Bldg 48a]
    >> The Australian National University
    >> Canberra ACT 0200 Australia
    >> M: +61 410 400 963
    >> T: + 61 2 6125 4670
    >> E: felix.andrews at anu.edu.au
    >> CRICOS Provider No. 00120C
    >> --
    >> http://www.neurofractal.org/felix/
    >> 



    > -- 
    > Felix Andrews / ???
    > Postdoctoral Fellow
    > Integrated Catchment Assessment and Management (iCAM) Centre
    > Fenner School of Environment and Society [Bldg 48a]
    > The Australian National University
    > Canberra ACT 0200 Australia
    > M: +61 410 400 963
    > T: + 61 2 6125 4670
    > E: felix.andrews at anu.edu.au
    > CRICOS Provider No. 00120C
    > -- 
    > http://www.neurofractal.org/felix/

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Wed May 26 11:57:38 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 26 May 2010 05:57:38 -0400
Subject: [Rd] Indexing bug?
Message-ID: <4BFCF092.2010501@gmail.com>

Is this expected behaviour?

x <- factor(c("c", "b", "a","c"))
results <- c(c=4, b=5)
results[x]

giving

 > results[x]
<NA>    b    c <NA>
  NA    5    4   NA

(i.e. it appears to give results[levels(x)]


whereas results[as.character(x)] does what I expected:

as.character(x)
results[as.character(x)]

 > as.character(x)
[1] "c" "b" "a" "c"
 > results[as.character(x)]
   c    b <NA>    c
   4    5   NA    4

Duncan Murdoch


From deepayan.sarkar at gmail.com  Wed May 26 12:33:00 2010
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Wed, 26 May 2010 16:03:00 +0530
Subject: [Rd] Indexing bug?
In-Reply-To: <4BFCF092.2010501@gmail.com>
References: <4BFCF092.2010501@gmail.com>
Message-ID: <AANLkTikyON896UMtfDea7aLiWlN97b352e82F19aWkFI@mail.gmail.com>

On Wed, May 26, 2010 at 3:27 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> Is this expected behaviour?
>
> x <- factor(c("c", "b", "a","c"))
> results <- c(c=4, b=5)
> results[x]
>
> giving
>
>> results[x]
> <NA> ? ?b ? ?c <NA>
> ?NA ? ?5 ? ?4 ? NA
>
> (i.e. it appears to give results[levels(x)]

I would say it gives

results[as.numeric(x)]

and it's not clear if that is less "expected". E.g., what happens if
results has no names? results[as.numeric(x)] would still work, but not
results[as.character(x)].

Factors have a dual nature (character labels vs numeric codes), and
when forced to choose, I think it's reasonable to choose the solution
which works more generally.

-Deepayan


>
>
> whereas results[as.character(x)] does what I expected:
>
> as.character(x)
> results[as.character(x)]
>
>> as.character(x)
> [1] "c" "b" "a" "c"
>> results[as.character(x)]
> ?c ? ?b <NA> ? ?c
> ?4 ? ?5 ? NA ? ?4
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From berwin at maths.uwa.edu.au  Wed May 26 13:12:24 2010
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Wed, 26 May 2010 19:12:24 +0800
Subject: [Rd] Indexing bug?
In-Reply-To: <4BFCF092.2010501@gmail.com>
References: <4BFCF092.2010501@gmail.com>
Message-ID: <20100526191224.787eccb0@bossiaea>

G'day Duncan,

On Wed, 26 May 2010 05:57:38 -0400
Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> Is this expected behaviour?

Yes, according to the answer that this poster

https://stat.ethz.ch/pipermail/r-devel/2008-March/048674.html

got.

Indeed, the help page of '[' states:

The index object i can be numeric, logical, character or empty.
Indexing by factors is allowed and is equivalent to indexing by the
numeric codes (see factor) and not by the character values which are
printed (for which use [as.character(i)]). 

Cheers,

	Berwin


From ggrothendieck at gmail.com  Wed May 26 13:16:23 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 26 May 2010 07:16:23 -0400
Subject: [Rd] SVN vs DVCS
In-Reply-To: <19452.60812.190425.523797@lynne.math.ethz.ch>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com> 
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com> 
	<19452.60812.190425.523797@lynne.math.ethz.ch>
Message-ID: <AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>

Note that one can also use any of the dvcs systems without actually
moving from svn by using the dvcs (or associated extension/addon) as
an svn client or by using it on an svn checkout.

On Wed, May 26, 2010 at 5:44 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Felix Andrews <felix at nfrac.org>
>>>>>> ? ? on Wed, 26 May 2010 11:20:12 +1000 writes:
>
> ? ?> On second thoughts it is really none of my business how the R sources
> ? ?> are managed.
> ? ?> But I would encourage package developers and/or r-forge maintainers to
> ? ?> consider these systems.
>
> Thank you, Felix, for the compilation of these alternatives.
>
> One very relevant piece of information that you've not added,
> is, how easily one could *move* from svn to such a system
> (including the full history of every file with revision numbers,
> ?log messages, etc),
> and .. for R-forge, e.g., which of these provide nice and
> flexible tools (as svn does) for an automatic web interface to
> inspect file histories, differences, etc.
>
> Regards,
> Martin ?( maintainer of svn.r-project.org )
>
> ? ?> Regards
> ? ?> -Felix
>
> ? ?> On 26 May 2010 10:29, Felix Andrews <felix at nfrac.org> wrote:
> ? ?>> Hi,
> ? ?>>
> ? ?>> Just wondering whether anyone had thought about moving the R sources
> ? ?>> to a "distributed" version control system such as Bazaar, Git or
> ? ?>> Mercurial. These new generation systems make it easier to work on
> ? ?>> feature branches, allow working offline, are very fast, etc.
> ? ?>>
> ? ?>> Some projects that have moved to Git are
> ? ?>> Linux Kernel
> ? ?>> Perl
> ? ?>> Ruby on Rails
> ? ?>> ...
> ? ?>> http://en.wikipedia.org/wiki/Git_(software)
> ? ?>>
> ? ?>> Some projects that have moved to Bazaar (bzr) are
> ? ?>> Ubuntu
> ? ?>> MySQL
> ? ?>> Inkscape
> ? ?>> ...
> ? ?>> http://en.wikipedia.org/wiki/Bazaar_(software)
> ? ?>>
> ? ?>> Some projects that have moved to Mercurial (hg) are
> ? ?>> Mozilla
> ? ?>> Octave
> ? ?>> Python
> ? ?>> ...
> ? ?>> http://en.wikipedia.org/wiki/Mercurial_(software)
> ? ?>>
> ? ?>> Joel Spolky's take on it:
> ? ?>> http://www.joelonsoftware.com/items/2010/03/17.html
> ? ?>>
> ? ?>> Regards
> ? ?>> -Felix


From jeff.a.ryan at gmail.com  Wed May 26 13:29:48 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 26 May 2010 06:29:48 -0500
Subject: [Rd] segfault on 2.11.0 with large POSIXct vector using as.character
Message-ID: <AANLkTinxn-L8bgYFSGxnhTu9ozIEJfH449DMH3HahGyn@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100526/3a211a41/attachment.pl>

From ggrothendieck at gmail.com  Wed May 26 13:48:05 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 26 May 2010 07:48:05 -0400
Subject: [Rd] segfault on 2.11.0 with large POSIXct vector using
	as.character
In-Reply-To: <AANLkTinxn-L8bgYFSGxnhTu9ozIEJfH449DMH3HahGyn@mail.gmail.com>
References: <AANLkTinxn-L8bgYFSGxnhTu9ozIEJfH449DMH3HahGyn@mail.gmail.com>
Message-ID: <AANLkTilfs9r49bOxgc0Sae4FltgvWHGC1MdLnf5IkUp9@mail.gmail.com>

On my Vista system there is no seg fault:

> invisible(as.character(Sys.time()+1:5e5))
> win.version()
[1] "Windows Vista (build 6002) Service Pack 2"
> R.version.string
[1] "R version 2.11.0 Patched (2010-04-26 r51822)"


On Wed, May 26, 2010 at 7:29 AM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
> Running "as.character" on a large POSIXct causes a segfault on my 2.11
> (2010-04-22) install. ?Seems to crash at around 9e4 ... on OSX and Ubuntu at
> least.
>
>> invisible(as.character(Sys.time()+1:7e4))
>> invisible(as.character(Sys.time()+1:8e4))
>> invisible(as.character(Sys.time()+1:9e4))
> Error: segfault from C stack overflow
>
>
>> invisible(as.character(Sys.time()+1:5e5))
> Error: segfault from C stack overflow
>
> Thanks,
> Jeff
>
>> sessionInfo()
> R version 2.11.0 (2010-04-22)
> x86_64-apple-darwin10.2.0
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
>
>> sessionInfo()
> R version 2.11.0 (2010-04-22)
> i486-pc-linux-gnu
>
> locale:
> ?[1] LC_CTYPE=en_US.utf8 ? ? ? LC_NUMERIC=C
> ?[3] LC_TIME=en_US.utf8 ? ? ? ?LC_COLLATE=en_US.utf8
> ?[5] LC_MONETARY=C ? ? ? ? ? ? LC_MESSAGES=en_US.utf8
> ?[7] LC_PAPER=en_US.utf8 ? ? ? LC_NAME=C
> ?[9] LC_ADDRESS=C ? ? ? ? ? ? ?LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at insightalgo.com
>
> ia: insight algorithmics
> www.insightalgo.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch.duncan at gmail.com  Wed May 26 13:50:47 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 26 May 2010 07:50:47 -0400
Subject: [Rd] Indexing bug?
In-Reply-To: <4BFCF092.2010501@gmail.com>
References: <4BFCF092.2010501@gmail.com>
Message-ID: <4BFD0B17.5020407@gmail.com>

Duncan Murdoch wrote:
> Is this expected behaviour?
>
> x <- factor(c("c", "b", "a","c"))
> results <- c(c=4, b=5)
> results[x]
>
> giving
>
>  > results[x]
> <NA>    b    c <NA>
>   NA    5    4   NA
>
> (i.e. it appears to give results[levels(x)]
>   

Thanks to all for pointing out my misinterpretation.    It's clearly not 
a bug.

Duncan Murdoch
>
> whereas results[as.character(x)] does what I expected:
>
> as.character(x)
> results[as.character(x)]
>
>  > as.character(x)
> [1] "c" "b" "a" "c"
>  > results[as.character(x)]
>    c    b <NA>    c
>    4    5   NA    4
>
> Duncan Murdoch
>


From murdoch.duncan at gmail.com  Wed May 26 14:01:41 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 26 May 2010 08:01:41 -0400
Subject: [Rd] segfault on 2.11.0 with large POSIXct vector using
	as.character
In-Reply-To: <AANLkTinxn-L8bgYFSGxnhTu9ozIEJfH449DMH3HahGyn@mail.gmail.com>
References: <AANLkTinxn-L8bgYFSGxnhTu9ozIEJfH449DMH3HahGyn@mail.gmail.com>
Message-ID: <4BFD0DA5.9070009@gmail.com>

Jeff Ryan wrote:
> Running "as.character" on a large POSIXct causes a segfault on my 2.11
> (2010-04-22) install.  Seems to crash at around 9e4 ... on OSX and Ubuntu at
> least.
>   

This has been fixed for a while in R-patched.  The 2.11.1 release on 
Monday should be fine. 

Apparently people aren't running the betas/release candidates.  You 
really should run the test versions to flush out bugs.  If you'd run the 
pre-release versions of 2.11.0, this bug would likely have been found 
before release.  The standard tests can miss things; the advantage of 
open source is there are many eyes looking for bugs.  But if those eyes 
are closed, the model doesn't work.

Duncan Murdoch
>   
>> invisible(as.character(Sys.time()+1:7e4))
>> invisible(as.character(Sys.time()+1:8e4))
>> invisible(as.character(Sys.time()+1:9e4))
>>     
> Error: segfault from C stack overflow
>
>
>   
>> invisible(as.character(Sys.time()+1:5e5))
>>     
> Error: segfault from C stack overflow
>
> Thanks,
> Jeff
>
>   
>> sessionInfo()
>>     
> R version 2.11.0 (2010-04-22)
> x86_64-apple-darwin10.2.0
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>   
>> sessionInfo()
>>     
> R version 2.11.0 (2010-04-22)
> i486-pc-linux-gnu
>
> locale:
>  [1] LC_CTYPE=en_US.utf8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.utf8        LC_COLLATE=en_US.utf8
>  [5] LC_MONETARY=C             LC_MESSAGES=en_US.utf8
>  [7] LC_PAPER=en_US.utf8       LC_NAME=C
>  [9] LC_ADDRESS=C              LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>   
>
>


From jeff.a.ryan at gmail.com  Wed May 26 15:12:20 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 26 May 2010 08:12:20 -0500
Subject: [Rd] segfault on 2.11.0 with large POSIXct vector using
	as.character
In-Reply-To: <4BFD0DA5.9070009@gmail.com>
References: <AANLkTinxn-L8bgYFSGxnhTu9ozIEJfH449DMH3HahGyn@mail.gmail.com>
	<4BFD0DA5.9070009@gmail.com>
Message-ID: <AANLkTily4ikF54UZbwWNXvOqEbRirdBQym7Ym9rHkYuO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100526/b6a478bd/attachment.pl>

From felix at nfrac.org  Wed May 26 16:01:43 2010
From: felix at nfrac.org (Felix Andrews)
Date: Thu, 27 May 2010 00:01:43 +1000
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com> 
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com> 
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
Message-ID: <AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>

I'm not necessarily advocating a migration; probably an administrative
nightmare, and everyone involved would be forced to learn new stuff...
I was just enthusing because I recently started using a DVCS for the
first time.


On 26 May 2010 21:16, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> Note that one can also use any of the dvcs systems without actually
> moving from svn by using the dvcs (or associated extension/addon) as
> an svn client or by using it on an svn checkout.

Yes, that's a very good point (although in my experience it takes a
very long time to do the initial download of the SVN repository). I'm
not an expert on these systems, but I imagine the main downside (other
than speed) of having SVN upstream is that you have to keep the
history linear, and so e.g can't collaborate on feature branches this
way. But yeah, worth a go.

>
> On Wed, May 26, 2010 at 5:44 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
>>>>>>> Felix Andrews <felix at nfrac.org>
>>>>>>> ? ? on Wed, 26 May 2010 11:20:12 +1000 writes:
>>
>> ? ?> On second thoughts it is really none of my business how the R sources
>> ? ?> are managed.
>> ? ?> But I would encourage package developers and/or r-forge maintainers to
>> ? ?> consider these systems.
>>
>> Thank you, Felix, for the compilation of these alternatives.
>>
>> One very relevant piece of information that you've not added,
>> is, how easily one could *move* from svn to such a system
>> (including the full history of every file with revision numbers,
>> ?log messages, etc),

Indeed... here is the basic process for migrating to Git
http://www.jonmaddox.com/2008/03/05/cleanly-migrate-your-subversion-repository-to-a-git-repository/
This will keep the branches, tags, full history, with SVN revision
numbers added to the log messages (if you leave off the --no-metadata
argument). However, the actual commit ids you would use in git log /
git diff / etc will not be the same as the old SVN ids. In fact git
uses hash strings rather than numbers, and bazaar uses sequential
numbering in each branch (rather than sequential numbers globally as
SVN does). Not sure about Mercurial.

>> and .. for R-forge, e.g., which of these provide nice and
>> flexible tools (as svn does) for an automatic web interface to
>> inspect file histories, differences, etc.

All have web interfaces. In fact FusionForge, which is the new name
for G-Forge, apparently supports Git, Bzr and Hg
http://fusionforge.org/
https://alioth.debian.org/scm/?group_id=30261
http://wiki.debian.org/Alioth/Hg

Other examples of web interfaces can be seen on the hosting services
GitHub.com e.g. http://github.com/hadley/ggplot2
Canonical's launchpad.net (bzr) e.g. https://launchpad.net/igraph


>>
>> Regards,
>> Martin ?( maintainer of svn.r-project.org )
>>
>> ? ?> Regards
>> ? ?> -Felix
>>
>> ? ?> On 26 May 2010 10:29, Felix Andrews <felix at nfrac.org> wrote:
>> ? ?>> Hi,
>> ? ?>>
>> ? ?>> Just wondering whether anyone had thought about moving the R sources
>> ? ?>> to a "distributed" version control system such as Bazaar, Git or
>> ? ?>> Mercurial. These new generation systems make it easier to work on
>> ? ?>> feature branches, allow working offline, are very fast, etc.
>> ? ?>>
>> ? ?>> Some projects that have moved to Git are
>> ? ?>> Linux Kernel
>> ? ?>> Perl
>> ? ?>> Ruby on Rails
>> ? ?>> ...
>> ? ?>> http://en.wikipedia.org/wiki/Git_(software)
>> ? ?>>
>> ? ?>> Some projects that have moved to Bazaar (bzr) are
>> ? ?>> Ubuntu
>> ? ?>> MySQL
>> ? ?>> Inkscape
>> ? ?>> ...
>> ? ?>> http://en.wikipedia.org/wiki/Bazaar_(software)
>> ? ?>>
>> ? ?>> Some projects that have moved to Mercurial (hg) are
>> ? ?>> Mozilla
>> ? ?>> Octave
>> ? ?>> Python
>> ? ?>> ...
>> ? ?>> http://en.wikipedia.org/wiki/Mercurial_(software)
>> ? ?>>
>> ? ?>> Joel Spolky's take on it:
>> ? ?>> http://www.joelonsoftware.com/items/2010/03/17.html
>> ? ?>>
>> ? ?>> Regards
>> ? ?>> -Felix
>



-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 4670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From simon.urbanek at r-project.org  Wed May 26 17:17:49 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 26 May 2010 11:17:49 -0400
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
Message-ID: <968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>


On May 26, 2010, at 10:01 AM, Felix Andrews wrote:

> I'm not necessarily advocating a migration; probably an administrative
> nightmare, and everyone involved would be forced to learn new stuff...
> I was just enthusing because I recently started using a DVCS for the
> first time.
> 
> 
> On 26 May 2010 21:16, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
>> Note that one can also use any of the dvcs systems without actually
>> moving from svn by using the dvcs (or associated extension/addon) as
>> an svn client or by using it on an svn checkout.
> 
> Yes, that's a very good point (although in my experience it takes a
> very long time to do the initial download of the SVN repository). I'm
> not an expert on these systems, but I imagine the main downside (other
> than speed) of having SVN upstream is that you have to keep the
> history linear,

That (non-linear history) is IMHO the biggest drawback of DVCS because that means there is no way to link a particular build to the source status and you cannot use globally valid build numbers.


> and so e.g can't collaborate on feature branches this way.

But feature branches are as easily (IMHO even more easily since you can closely monitor what others are contributing) worked on with SVN (routinely used with R) so I'm not sure what DVCS would buy you.

AFAICS the only benefit of DVCS is that if you are on a remote island without any internet connection you can accumulate multiple commits before merging them back. I can't say that I desperately need that functionality ;).

Cheers,
Simon



>> 
>> On Wed, May 26, 2010 at 5:44 AM, Martin Maechler
>> <maechler at stat.math.ethz.ch> wrote:
>>>>>>>> Felix Andrews <felix at nfrac.org>
>>>>>>>>     on Wed, 26 May 2010 11:20:12 +1000 writes:
>>> 
>>>    > On second thoughts it is really none of my business how the R sources
>>>    > are managed.
>>>    > But I would encourage package developers and/or r-forge maintainers to
>>>    > consider these systems.
>>> 
>>> Thank you, Felix, for the compilation of these alternatives.
>>> 
>>> One very relevant piece of information that you've not added,
>>> is, how easily one could *move* from svn to such a system
>>> (including the full history of every file with revision numbers,
>>>  log messages, etc),
> 
> Indeed... here is the basic process for migrating to Git
> http://www.jonmaddox.com/2008/03/05/cleanly-migrate-your-subversion-repository-to-a-git-repository/
> This will keep the branches, tags, full history, with SVN revision
> numbers added to the log messages (if you leave off the --no-metadata
> argument). However, the actual commit ids you would use in git log /
> git diff / etc will not be the same as the old SVN ids. In fact git
> uses hash strings rather than numbers, and bazaar uses sequential
> numbering in each branch (rather than sequential numbers globally as
> SVN does). Not sure about Mercurial.
> 
>>> and .. for R-forge, e.g., which of these provide nice and
>>> flexible tools (as svn does) for an automatic web interface to
>>> inspect file histories, differences, etc.
> 
> All have web interfaces. In fact FusionForge, which is the new name
> for G-Forge, apparently supports Git, Bzr and Hg
> http://fusionforge.org/
> https://alioth.debian.org/scm/?group_id=30261
> http://wiki.debian.org/Alioth/Hg
> 
> Other examples of web interfaces can be seen on the hosting services
> GitHub.com e.g. http://github.com/hadley/ggplot2
> Canonical's launchpad.net (bzr) e.g. https://launchpad.net/igraph
> 
> 
>>> 
>>> Regards,
>>> Martin  ( maintainer of svn.r-project.org )
>>> 
>>>    > Regards
>>>    > -Felix
>>> 
>>>    > On 26 May 2010 10:29, Felix Andrews <felix at nfrac.org> wrote:
>>>    >> Hi,
>>>    >>
>>>    >> Just wondering whether anyone had thought about moving the R sources
>>>    >> to a "distributed" version control system such as Bazaar, Git or
>>>    >> Mercurial. These new generation systems make it easier to work on
>>>    >> feature branches, allow working offline, are very fast, etc.
>>>    >>
>>>    >> Some projects that have moved to Git are
>>>    >> Linux Kernel
>>>    >> Perl
>>>    >> Ruby on Rails
>>>    >> ...
>>>    >> http://en.wikipedia.org/wiki/Git_(software)
>>>    >>
>>>    >> Some projects that have moved to Bazaar (bzr) are
>>>    >> Ubuntu
>>>    >> MySQL
>>>    >> Inkscape
>>>    >> ...
>>>    >> http://en.wikipedia.org/wiki/Bazaar_(software)
>>>    >>
>>>    >> Some projects that have moved to Mercurial (hg) are
>>>    >> Mozilla
>>>    >> Octave
>>>    >> Python
>>>    >> ...
>>>    >> http://en.wikipedia.org/wiki/Mercurial_(software)
>>>    >>
>>>    >> Joel Spolky's take on it:
>>>    >> http://www.joelonsoftware.com/items/2010/03/17.html
>>>    >>
>>>    >> Regards
>>>    >> -Felix
>> 
> 
> 
> 
> -- 
> Felix Andrews / ???
> Postdoctoral Fellow
> Integrated Catchment Assessment and Management (iCAM) Centre
> Fenner School of Environment and Society [Bldg 48a]
> The Australian National University
> Canberra ACT 0200 Australia
> M: +61 410 400 963
> T: + 61 2 6125 4670
> E: felix.andrews at anu.edu.au
> CRICOS Provider No. 00120C
> -- 
> http://www.neurofractal.org/felix/
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From hadley at rice.edu  Wed May 26 17:35:54 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 26 May 2010 10:35:54 -0500
Subject: [Rd] SVN vs DVCS
In-Reply-To: <968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com> 
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com> 
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com> 
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com> 
	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
Message-ID: <AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>

>> Yes, that's a very good point (although in my experience it takes a
>> very long time to do the initial download of the SVN repository). I'm
>> not an expert on these systems, but I imagine the main downside (other
>> than speed) of having SVN upstream is that you have to keep the
>> history linear,
>
> That (non-linear history) is IMHO the biggest drawback of DVCS because that means there is no way to link a particular build to the source status and you cannot use globally valid build numbers.

Git (and I'm sure the others) provides a globally unique id for each
revision.  Isn't that sufficient?

> But feature branches are as easily (IMHO even more easily since you can closely monitor what others are contributing) worked on with SVN (routinely used with R) so I'm not sure what DVCS would buy you.

Feature branches are _much_ easier with git - to the point where some
people suggest using a separate feature branch for every feature you
develop.

> AFAICS the only benefit of DVCS is that if you are on a remote island without any internet connection you can accumulate multiple commits before merging them back. I can't say that I desperately need that functionality ;).

You have never worked on an airplane or other location without
internet access?  You must have lived a very privileged life ;)

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Wed May 26 17:38:58 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 26 May 2010 10:38:58 -0500
Subject: [Rd] SVN vs DVCS
In-Reply-To: <19452.60812.190425.523797@lynne.math.ethz.ch>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com> 
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com> 
	<19452.60812.190425.523797@lynne.math.ethz.ch>
Message-ID: <AANLkTim0clxkBZgS1liyMIGUrJwX8Pb7snNlexWjEEdx@mail.gmail.com>

> and .. for R-forge, e.g., which of these provide nice and
> flexible tools (as svn does) for an automatic web interface to
> inspect file histories, differences, etc.

Every svn alternative provides tools that are as good as or better
than R-forge, with the exception of package building.  It's a real
shame that this unique component of R-forge is so closely connected to
the tools that many other sites provide.

See http://github.com/hadley/plyr for an example of the development
experience that other sites provide.  Note the absence of broken
images and broken https.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From antonio.fabio at gmail.com  Wed May 26 18:26:07 2010
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Wed, 26 May 2010 18:26:07 +0200
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
	<AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
Message-ID: <AANLkTim82TI1rk2sleaHPZ8PeQk0Ahgb9XLTxEM3ywhQ@mail.gmail.com>

2010/5/26 Hadley Wickham <hadley at rice.edu>:
>>> Yes, that's a very good point (although in my experience it takes a
>>> very long time to do the initial download of the SVN repository). I'm
>>> not an expert on these systems, but I imagine the main downside (other
>>> than speed) of having SVN upstream is that you have to keep the
>>> history linear,
>>
>> That (non-linear history) is IMHO the biggest drawback of DVCS because that means there is no way to link a particular build to the source status and you cannot use globally valid build numbers.
>
> Git (and I'm sure the others) provides a globally unique id for each
> revision. ?Isn't that sufficient?
>
>> But feature branches are as easily (IMHO even more easily since you can closely monitor what others are contributing) worked on with SVN (routinely used with R) so I'm not sure what DVCS would buy you.
>
> Feature branches are _much_ easier with git - to the point where some
> people suggest using a separate feature branch for every feature you
> develop.
>
>> AFAICS the only benefit of DVCS is that if you are on a remote island without any internet connection you can accumulate multiple commits before merging them back. I can't say that I desperately need that functionality ;).
>
> You have never worked on an airplane or other location without
> internet access? ?You must have lived a very privileged life ;)

Some people just have decent web access only at work, and if you work
on your R project like at home or on the train, you're already having
some difficulties. But please, not the airplane argument! (just
joking...).

Moreover, 'local' commits are way faster than network-based commits. I
can testify: 1microsecond vs 1second delay (or more, depending on how
crappy is your net access) *is* a big difference. On your local
machine, you end up committing much more often, with smaller and
self-contained commits, generally producing a cleaner history.

fabio.

>
> Hadley
>
>
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Antonio Fabio Di Narzo, PhD.
Swiss Institute for Bioinformatics - Bioinformatics Core Facility
Office 2029, G?nopode, Quartier Sorge
CH-1015 Lausanne, Switzerland
Tel: +41 21 692 4087
Fax: +41 21 692 4065


From simon.urbanek at r-project.org  Wed May 26 18:50:30 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 26 May 2010 12:50:30 -0400
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
	<AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
Message-ID: <59A0875B-D883-4B4B-8B7C-996A2193D1FD@r-project.org>


On May 26, 2010, at 11:35 AM, Hadley Wickham wrote:

>>> Yes, that's a very good point (although in my experience it takes a
>>> very long time to do the initial download of the SVN repository). I'm
>>> not an expert on these systems, but I imagine the main downside (other
>>> than speed) of having SVN upstream is that you have to keep the
>>> history linear,
>> 
>> That (non-linear history) is IMHO the biggest drawback of DVCS because that means there is no way to link a particular build to the source status and you cannot use globally valid build numbers.
> 
> Git (and I'm sure the others) provides a globally unique id for each
> revision.  Isn't that sufficient?
> 

No in that you cannot follow revisions. What you get are those horrible UUIDs that you can't seriously use other that in some autogenerated form (that's one of the main reasons I abandoned GIt after giving it a try).


>> But feature branches are as easily (IMHO even more easily since you can closely monitor what others are contributing) worked on with SVN (routinely used with R) so I'm not sure what DVCS would buy you.
> 
> Feature branches are _much_ easier with git - to the point where some
> people suggest using a separate feature branch for every feature you
> develop.
> 

Ok, what's different? It's trivial to create branches in SVN and trivial to merge - how is it easier in git? That may be the part I don't understand..


>> AFAICS the only benefit of DVCS is that if you are on a remote island without any internet connection you can accumulate multiple commits before merging them back. I can't say that I desperately need that functionality ;).
> 
> You have never worked on an airplane or other location without internet access?  You must have lived a very privileged life ;)
> 

Oh, you don't have internet in your airplane? ;) But seriously, yes, I have hacked stuff on airplanes but in general I'm able to get an access soon enough to have reasonable commit granularity. But yes, I do agree that it can be useful at very limited number of times (maybe once or twice so far for me), but that doesn't convince me to give up revisions and central conflict resolution which I use daily. [Note: this is my personal preference]

Cheers,
Simon


From ggrothendieck at gmail.com  Wed May 26 18:59:03 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 26 May 2010 12:59:03 -0400
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTim0clxkBZgS1liyMIGUrJwX8Pb7snNlexWjEEdx@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com> 
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com> 
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTim0clxkBZgS1liyMIGUrJwX8Pb7snNlexWjEEdx@mail.gmail.com>
Message-ID: <AANLkTilDm8Q6EXZ7DdHHcTziTvAyE884azVC6XVKF9kJ@mail.gmail.com>

On Wed, May 26, 2010 at 11:38 AM, Hadley Wickham <hadley at rice.edu> wrote:
>?It's a real
> shame that this unique component of R-forge is so closely connected to
> the tools that many other sites provide.

R-Forge does have the capability of mirroring an external subversion
repository according to section 4.2 of the R-Forge manual:
http://r-forge.r-project.org/R-Forge_Manual.pdf


From simon.urbanek at r-project.org  Wed May 26 18:58:11 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 26 May 2010 12:58:11 -0400
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTim82TI1rk2sleaHPZ8PeQk0Ahgb9XLTxEM3ywhQ@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
	<AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
	<AANLkTim82TI1rk2sleaHPZ8PeQk0Ahgb9XLTxEM3ywhQ@mail.gmail.com>
Message-ID: <CB0DB836-232C-4C9A-B68B-ED2222B184C4@r-project.org>


On May 26, 2010, at 12:26 PM, Antonio, Fabio Di Narzo wrote:

> 2010/5/26 Hadley Wickham <hadley at rice.edu>:
>>>> Yes, that's a very good point (although in my experience it takes a
>>>> very long time to do the initial download of the SVN repository). I'm
>>>> not an expert on these systems, but I imagine the main downside (other
>>>> than speed) of having SVN upstream is that you have to keep the
>>>> history linear,
>>> 
>>> That (non-linear history) is IMHO the biggest drawback of DVCS because that means there is no way to link a particular build to the source status and you cannot use globally valid build numbers.
>> 
>> Git (and I'm sure the others) provides a globally unique id for each
>> revision.  Isn't that sufficient?
>> 
>>> But feature branches are as easily (IMHO even more easily since you can closely monitor what others are contributing) worked on with SVN (routinely used with R) so I'm not sure what DVCS would buy you.
>> 
>> Feature branches are _much_ easier with git - to the point where some
>> people suggest using a separate feature branch for every feature you
>> develop.
>> 
>>> AFAICS the only benefit of DVCS is that if you are on a remote island without any internet connection you can accumulate multiple commits before merging them back. I can't say that I desperately need that functionality ;).
>> 
>> You have never worked on an airplane or other location without
>> internet access?  You must have lived a very privileged life ;)
> 
> Some people just have decent web access only at work, and if you work
> on your R project like at home or on the train, you're already having
> some difficulties. But please, not the airplane argument! (just
> joking...).
> 
> Moreover, 'local' commits are way faster than network-based commits. I
> can testify: 1microsecond vs 1second delay (or more, depending on how
> crappy is your net access) *is* a big difference. On your local
> machine, you end up committing much more often, with smaller and
> self-contained commits, generally producing a cleaner history.
> 

I disagree - I don't find commit time having any impact on what I commit. It's always a logical chunk (which is why SVN was such a great step forward from CVS). My RForge does check on commit so I don't even bother waiting for the commit to finish (waiting is just useful if I want the check result - the actual commit is pretty much instantaneous). However, with SVN you'll know immediately if someone else was working on the same issue in the meantime - with DVCS you won't (this happens in R more often that you would think). [Note: again, this is rather about personal preferences I suspect]

Cheers,
Simon


From seth at userprimary.net  Wed May 26 19:14:57 2010
From: seth at userprimary.net (Seth Falcon)
Date: Wed, 26 May 2010 10:14:57 -0700
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
Message-ID: <4BFD5711.6080003@userprimary.net>

On 5/26/10 4:16 AM, Gabor Grothendieck wrote:
> Note that one can also use any of the dvcs systems without actually
> moving from svn by using the dvcs (or associated extension/addon) as
> an svn client or by using it on an svn checkout.

FWIW, I have been using git for several years now as my vsc of choice 
and use it for all svn-backed projects (R included) via git-svn.

Some of the things I like:

- Being able to organize changes in local commits that can be revised, 
reordered, rebased prior to publishing.  Once I got in the habit of 
working this way, I simply can't imagine going back.

- Having quick access to full repository history without network 
access/delay.  Features for searching change history are more powerful 
(or easier for me to use) and I have found that useful as well.

- This may not be true any longer with more recent svn servers/clients, 
but aside form the initial repo clone, working via git-svn was 
noticeably faster than straight svn client (!) -- I think related to how 
the tools organize the working copy and how many fstat calls they make.

- I find the log reviewing functionality much better suited to reviewing 
changes.


+ seth

-- 
Seth Falcon | @sfalcon | http://userprimary.net/


From drjlove at gmail.com  Wed May 26 22:51:25 2010
From: drjlove at gmail.com (Jamie Love)
Date: Thu, 27 May 2010 08:51:25 +1200
Subject: [Rd] R 2.10 and help
Message-ID: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com>

Hi all,

I've been developing a little project for the past few months on R2.9.
The project utilises RServe to access R over at tcp/ip connection.

One feature of the project is to take R-Help and display it to the
user through my own UI. In 2.9 this worked well as all the html help
was pre-generated - I could ask R to find the help (e.g. help(plot)
would return the rd file), and then I could look up the .html file
from that.

In R 2.10 things changed dramatically for help, and now html help is
generated when requested from the rd files.

I've tried various ways to access the help as HTML since then, but
I've had no luck. I was wondering if anyone would be able to suggest
an approach where I could run 'help(plot)', and then take the
resulting .rd file and generate the necessary html help from it.

Thanks,

-- 
Jamie Love


From antonio.fabio at gmail.com  Wed May 26 22:54:58 2010
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Wed, 26 May 2010 22:54:58 +0200
Subject: [Rd] SVN vs DVCS
In-Reply-To: <CB0DB836-232C-4C9A-B68B-ED2222B184C4@r-project.org>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
	<AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
	<AANLkTim82TI1rk2sleaHPZ8PeQk0Ahgb9XLTxEM3ywhQ@mail.gmail.com>
	<CB0DB836-232C-4C9A-B68B-ED2222B184C4@r-project.org>
Message-ID: <AANLkTimV0-HAqSFzjRjE-qmiu60Ho7fRwAl4hzuSVlQm@mail.gmail.com>

2010/5/26 Simon Urbanek <simon.urbanek at r-project.org>:
>
> On May 26, 2010, at 12:26 PM, Antonio, Fabio Di Narzo wrote:
>
>> 2010/5/26 Hadley Wickham <hadley at rice.edu>:
>>>>> Yes, that's a very good point (although in my experience it takes a
>>>>> very long time to do the initial download of the SVN repository). I'm
>>>>> not an expert on these systems, but I imagine the main downside (other
>>>>> than speed) of having SVN upstream is that you have to keep the
>>>>> history linear,
>>>>
>>>> That (non-linear history) is IMHO the biggest drawback of DVCS because that means there is no way to link a particular build to the source status and you cannot use globally valid build numbers.
>>>
>>> Git (and I'm sure the others) provides a globally unique id for each
>>> revision. ?Isn't that sufficient?
>>>
>>>> But feature branches are as easily (IMHO even more easily since you can closely monitor what others are contributing) worked on with SVN (routinely used with R) so I'm not sure what DVCS would buy you.
>>>
>>> Feature branches are _much_ easier with git - to the point where some
>>> people suggest using a separate feature branch for every feature you
>>> develop.
>>>
>>>> AFAICS the only benefit of DVCS is that if you are on a remote island without any internet connection you can accumulate multiple commits before merging them back. I can't say that I desperately need that functionality ;).
>>>
>>> You have never worked on an airplane or other location without
>>> internet access? ?You must have lived a very privileged life ;)
>>
>> Some people just have decent web access only at work, and if you work
>> on your R project like at home or on the train, you're already having
>> some difficulties. But please, not the airplane argument! (just
>> joking...).
>>
>> Moreover, 'local' commits are way faster than network-based commits. I
>> can testify: 1microsecond vs 1second delay (or more, depending on how
>> crappy is your net access) *is* a big difference. On your local
>> machine, you end up committing much more often, with smaller and
>> self-contained commits, generally producing a cleaner history.
>>
>
> I disagree - I don't find commit time having any impact on what I commit. It's always a logical chunk (which is why SVN was such a great step forward from CVS). My RForge does check on commit so I don't even bother waiting for the commit to finish (waiting is just useful if I want the check result - the actual commit is pretty much instantaneous).
> However, with SVN you'll know immediately if someone else was working on the same issue in the meantime - with DVCS you won't (this happens in R more often that you would think).

You'll know immediately as long as you're connected, and that holds
for DVCS too.
Beside, people working simultaneously on the same files and needing
svn to tell them of that? And that happening often? I would hope on
better human interaction and work division, rather than svn conflicts
checks. But...
> [Note: again, this is rather about personal preferences I suspect]
indeed.

cheers,
fabio.

>
> Cheers,
> Simon
>
>



-- 
Antonio Fabio Di Narzo, PhD.
Swiss Institute for Bioinformatics - Bioinformatics Core Facility
Office 2029, G?nopode, Quartier Sorge
CH-1015 Lausanne, Switzerland
Tel: +41 21 692 4087
Fax: +41 21 692 4065


From simon.urbanek at r-project.org  Wed May 26 23:04:04 2010
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 26 May 2010 17:04:04 -0400
Subject: [Rd] R 2.10 and help
In-Reply-To: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com>
References: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com>
Message-ID: <672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>


On May 26, 2010, at 4:51 PM, Jamie Love wrote:

> Hi all,
> 
> I've been developing a little project for the past few months on R2.9.
> The project utilises RServe to access R over at tcp/ip connection.
> 
> One feature of the project is to take R-Help and display it to the
> user through my own UI. In 2.9 this worked well as all the html help
> was pre-generated - I could ask R to find the help (e.g. help(plot)
> would return the rd file), and then I could look up the .html file
> from that.
> 
> In R 2.10 things changed dramatically for help, and now html help is
> generated when requested from the rd files.
> 
> I've tried various ways to access the help as HTML since then, but
> I've had no luck. I was wondering if anyone would be able to suggest
> an approach where I could run 'help(plot)', and then take the
> resulting .rd file and generate the necessary html help from it.
> 

It's much more simple since 2.10 as you can simply use the URL (same URL as the help system uses). For examples see JGR or the Mac GUI. Or you can do the same thing that the Rhttpd server does  actually generating the html - see tools:::httpd 

Cheers,
Simon


From pdalgd at gmail.com  Thu May 27 00:38:38 2010
From: pdalgd at gmail.com (Peter Dalgaard)
Date: Thu, 27 May 2010 00:38:38 +0200
Subject: [Rd] SVN vs DVCS
In-Reply-To: <AANLkTimV0-HAqSFzjRjE-qmiu60Ho7fRwAl4hzuSVlQm@mail.gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>	<19452.60812.190425.523797@lynne.math.ethz.ch>	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>	<AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>	<AANLkTim82TI1rk2sleaHPZ8PeQk0Ahgb9XLTxEM3ywhQ@mail.gmail.com>	<CB0DB836-232C-4C9A-B68B-ED2222B184C4@r-project.org>
	<AANLkTimV0-HAqSFzjRjE-qmiu60Ho7fRwAl4hzuSVlQm@mail.gmail.com>
Message-ID: <4BFDA2EE.8070305@gmail.com>

Antonio, Fabio Di Narzo wrote:

> Beside, people working simultaneously on the same files and needing
> svn to tell them of that? And that happening often? I would hope on
> better human interaction and work division, rather than svn conflicts
> checks. But...
>> [Note: again, this is rather about personal preferences I suspect]
> indeed.

It actually happens quite often. Sometimes because two people in, say,
Canada and Oxford fix the same bug report (usually in nearly the same
way), but more typically because ALL our changes are recorded in the
same NEWS file.

Besides, SVN conflict are almost always trivial to resolve: Either a
matter of selecting one of two changes or keeping both.

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From hadley at rice.edu  Thu May 27 03:39:23 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 26 May 2010 20:39:23 -0500
Subject: [Rd] SVN vs DVCS
In-Reply-To: <4BFDA2EE.8070305@gmail.com>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<AANLkTimsIftahbfEcd8OVbzpprY6XXIGDUUoNddXxgfi@mail.gmail.com>
	<968319FE-3CD6-4520-95FE-198C31C643EF@r-project.org>
	<AANLkTiks2TYANCp53_VSPzsJGna8V_eu2_b6_zzTQOeS@mail.gmail.com>
	<AANLkTim82TI1rk2sleaHPZ8PeQk0Ahgb9XLTxEM3ywhQ@mail.gmail.com>
	<CB0DB836-232C-4C9A-B68B-ED2222B184C4@r-project.org>
	<AANLkTimV0-HAqSFzjRjE-qmiu60Ho7fRwAl4hzuSVlQm@mail.gmail.com>
	<4BFDA2EE.8070305@gmail.com>
Message-ID: <AANLkTil5R5j4E9GwnJVJntd2TObbxPH9IRmzAV1IguvF@mail.gmail.com>

On Wednesday, May 26, 2010, Peter Dalgaard <pdalgd at gmail.com> wrote:
> Antonio, Fabio Di Narzo wrote:
>
>> Beside, people working simultaneously on the same files and needing
>> svn to tell them of that? And that happening often? I would hope on
>> better human interaction and work division, rather than svn conflicts
>> checks. But...
>>> [Note: again, this is rather about personal preferences I suspect]
>> indeed.
>
> It actually happens quite often. Sometimes because two people in, say,
> Canada and Oxford fix the same bug report (usually in nearly the same
> way), but more typically because ALL our changes are recorded in the
> same NEWS file.
>
> Besides, SVN conflict are almost always trivial to resolve: Either a
> matter of selecting one of two changes or keeping both.

And that's no more difficult in git or any other dvcs.

Hadley
> --
> Peter Dalgaard
> Center for Statistics, Copenhagen Business School
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk ?Priv: PDalgd at gmail.com
>
> ______________________________________________
> R-devel at r-project.org?mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Thu May 27 05:20:48 2010
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 26 May 2010 22:20:48 -0500
Subject: [Rd] R 2.10 and help
In-Reply-To: <672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>
References: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com> 
	<672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>
Message-ID: <AANLkTilSSvQxX3-epeP7Nqr36T3UYotgJGynADqSYWIG@mail.gmail.com>

>> I've tried various ways to access the help as HTML since then, but
>> I've had no luck. I was wondering if anyone would be able to suggest
>> an approach where I could run 'help(plot)', and then take the
>> resulting .rd file and generate the necessary html help from it.
>>
>
> It's much more simple since 2.10 as you can simply use the URL (same URL as the help system uses). For examples see JGR or the Mac GUI. Or you can do the same thing that the Rhttpd server does ?actually generating the html - see tools:::httpd

Another approach along the same lines is the in progress helpr
package: http://github.com/hadley/helpr

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From drjlove at gmail.com  Thu May 27 09:48:02 2010
From: drjlove at gmail.com (Jamie Love)
Date: Thu, 27 May 2010 19:48:02 +1200
Subject: [Rd] R 2.10 and help
In-Reply-To: <672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>
References: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com>
	<672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>
Message-ID: <AANLkTikQ9NKmsXgnG-XniAwb-gZjwYPl8NP6w8RaYt5E@mail.gmail.com>

Thanks for the info,

I'm happy to use the new httpd server that serves the help files -
that'd definitely help. My difficulty with this approach is that I'm
not sure how to get the URL -

Say for example I've done help.start(),

then I do:

help(plot)

it will redirect my web browser to the plot page -

How can I stop it touching my web browser and instead return to me the URL.

I tried overriding the browseURL() function, but it seem to do nothing.

Ta


>
> It's much more simple since 2.10 as you can simply use the URL (same URL as the help system uses). For examples see JGR or the Mac GUI. Or you can do the same thing that the Rhttpd server does ?actually generating the html - see tools:::httpd
>

-- 
Jamie Love


From romain.francois at dbmail.com  Thu May 27 10:05:26 2010
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 27 May 2010 10:05:26 +0200
Subject: [Rd] R 2.10 and help
In-Reply-To: <AANLkTikQ9NKmsXgnG-XniAwb-gZjwYPl8NP6w8RaYt5E@mail.gmail.com>
References: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com>	<672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>
	<AANLkTikQ9NKmsXgnG-XniAwb-gZjwYPl8NP6w8RaYt5E@mail.gmail.com>
Message-ID: <4BFE27C6.608@dbmail.com>


Le 27/05/10 09:48, Jamie Love a ?crit :
>
> Thanks for the info,
>
> I'm happy to use the new httpd server that serves the help files -
> that'd definitely help. My difficulty with this approach is that I'm
> not sure how to get the URL -
>
> Say for example I've done help.start(),
>
> then I do:
>
> help(plot)
>
> it will redirect my web browser to the plot page -
>
> How can I stop it touching my web browser and instead return to me the URL.
>
> I tried overriding the browseURL() function, but it seem to do nothing.

Perhaps something like this:

 > options( browser = function(url, ...) print( url ) )
 > ?plot
[1] "http://127.0.0.1:9000/library/graphics/html/plot.html"

Romain

> Ta
>
>
>>
>> It's much more simple since 2.10 as you can simply use the URL (same URL as the help system uses). For examples see JGR or the Mac GUI. Or you can do the same thing that the Rhttpd server does  actually generating the html - see tools:::httpd
>>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/cork4b : highlight 0.1-8
|- http://bit.ly/bklUXt : RcppArmadillo 0.2.1

`- http://bit.ly/936ck2 : Rcpp 0.8.0


From drjlove at gmail.com  Thu May 27 10:54:50 2010
From: drjlove at gmail.com (Jamie Love)
Date: Thu, 27 May 2010 20:54:50 +1200
Subject: [Rd] R 2.10 and help
In-Reply-To: <4BFE27C6.608@dbmail.com>
References: <AANLkTinFsFJfQ84ku5xTWa0dj2lWG1WYQugG-UftAH4K@mail.gmail.com>
	<672BE353-47D1-455D-9BE6-31CC4F5352ED@r-project.org>
	<AANLkTikQ9NKmsXgnG-XniAwb-gZjwYPl8NP6w8RaYt5E@mail.gmail.com>
	<4BFE27C6.608@dbmail.com>
Message-ID: <AANLkTimikBOk4ZnEHdtROunYVlprkQ9p7kJpxOZBFIHp@mail.gmail.com>

Thanks to Romain, this is perfect -

On Thu, May 27, 2010 at 8:05 PM, Romain Francois
<romain.francois at dbmail.com> wrote:
>
> Le 27/05/10 09:48, Jamie Love a ?crit :
>>
>> Thanks for the info,
>>
>> I'm happy to use the new httpd server that serves the help files -
>> that'd definitely help. My difficulty with this approach is that I'm
>> not sure how to get the URL -
>>
>> Say for example I've done help.start(),
>>
>> then I do:
>>
>> help(plot)
>>
>> it will redirect my web browser to the plot page -
>>
>> How can I stop it touching my web browser and instead return to me the
>> URL.
>>
>> I tried overriding the browseURL() function, but it seem to do nothing.
>
> Perhaps something like this:
>
>> options( browser = function(url, ...) print( url ) )
>> ?plot
> [1] "http://127.0.0.1:9000/library/graphics/html/plot.html"
>
> Romain
>
>> Ta
>>
>>
>>>
>>> It's much more simple since 2.10 as you can simply use the URL (same URL
>>> as the help system uses). For examples see JGR or the Mac GUI. Or you can do
>>> the same thing that the Rhttpd server does ?actually generating the html -
>>> see tools:::httpd
>>>
>>
>
>
> --
> Romain Francois
> Professional R Enthusiast
> +33(0) 6 28 91 30 30
> http://romainfrancois.blog.free.fr
> |- http://bit.ly/cork4b : highlight 0.1-8
> |- http://bit.ly/bklUXt : RcppArmadillo 0.2.1
> `- http://bit.ly/936ck2 : Rcpp 0.8.0
>
>
>



-- 
Jamie Love
Looking for custom software development? Contact us at www.nsquaredsoftware.com.


From therneau at mayo.edu  Thu May 27 14:13:23 2010
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 27 May 2010 07:13:23 -0500
Subject: [Rd] SVN vs DVCS
Message-ID: <1274962403.2606.10.camel@punchbuggy>

One small technical note:
Simon said
> That (non-linear history) is IMHO the biggest drawback of DVCS because
> that means there is no way to link a particular build to the source 
> status and you cannot use globally valid build numbers.

In mercurial (Hg) a particular snapshot can be labeled with a tag, and
then referred to by that name in the future.  This problem and solution
is discussed in a tutorial on Mecurial (http://hginit.com/, section on
"repository architecture"), precisely for matching the archive state to
a software release.  I can't speak to any other DVCS package.

Terry Therneau


From sveinung84 at users.sourceforge.net  Thu May 27 16:43:24 2010
From: sveinung84 at users.sourceforge.net (Sveinung Kvilhaugsvik)
Date: Thu, 27 May 2010 16:43:24 +0200
Subject: [Rd] SVN vs DVCS
In-Reply-To: <1274962403.2606.10.camel@punchbuggy>
References: <1274962403.2606.10.camel@punchbuggy>
Message-ID: <AANLkTiksrVobnAl7Og8LuqJ_WhX8CvEaLFcv_o_MP97v@mail.gmail.com>

> In mercurial (Hg) a particular snapshot can be labeled with a tag, and
> then referred to by that name in the future.
Bazaar can tag revisions as well: http://wiki.bazaar.canonical.com/Tag
Git too: http://www.kernel.org/pub/software/scm/git/docs/git-tag.html

Sincerely
Sveinung Kvilhaugsvik


From rdpeng at gmail.com  Fri May 28 04:18:03 2010
From: rdpeng at gmail.com (Roger Peng)
Date: Thu, 27 May 2010 22:18:03 -0400
Subject: [Rd] SVN vs DVCS
In-Reply-To: <4BFD5711.6080003@userprimary.net>
References: <AANLkTikqeJ_LEosa4ett4bLPO9SD375Lz_lA88Z5sEAX@mail.gmail.com>
	<AANLkTimh6KCb-n5Onh1T5EHv60JG0zUoRSBI42uo7f29@mail.gmail.com>
	<19452.60812.190425.523797@lynne.math.ethz.ch>
	<AANLkTikCCxnNw5i-2sBYQ5gv80OBRhrucni3APUBhnDu@mail.gmail.com>
	<4BFD5711.6080003@userprimary.net>
Message-ID: <AANLkTinL6xh7lxRHTyCTzBxNSjR3eWvPXWI66DUpWwqp@mail.gmail.com>

I think the main advantage of a DVCS is that it allows many many
people to make changes to a project and to integrate those changes in
a non-insane way. Given that R as a very restricted list of people who
actually make changes to the source, it doesn't seem that something
like git or Hg would provide a major advantage. If the people on that
list are happy with SVN then there's not much else to say. However, if
it were thought that maybe we want more people submitting
patches/making changes, then perhaps it might make more sense to move
to a DVCS.

I use git for everything mainly because it's *fast* and it has much
better tools for viewing changes/patches and revision history. For
example, 'git bisect' has allowed me track down bugs that would have
been very painful for me because I'm not intimately familiar with the
entire R source code.

-roger

On Wed, May 26, 2010 at 1:14 PM, Seth Falcon <seth at userprimary.net> wrote:
> On 5/26/10 4:16 AM, Gabor Grothendieck wrote:
>>
>> Note that one can also use any of the dvcs systems without actually
>> moving from svn by using the dvcs (or associated extension/addon) as
>> an svn client or by using it on an svn checkout.
>
> FWIW, I have been using git for several years now as my vsc of choice and
> use it for all svn-backed projects (R included) via git-svn.
>
> Some of the things I like:
>
> - Being able to organize changes in local commits that can be revised,
> reordered, rebased prior to publishing. ?Once I got in the habit of working
> this way, I simply can't imagine going back.
>
> - Having quick access to full repository history without network
> access/delay. ?Features for searching change history are more powerful (or
> easier for me to use) and I have found that useful as well.
>
> - This may not be true any longer with more recent svn servers/clients, but
> aside form the initial repo clone, working via git-svn was noticeably faster
> than straight svn client (!) -- I think related to how the tools organize
> the working copy and how many fstat calls they make.
>
> - I find the log reviewing functionality much better suited to reviewing
> changes.
>
>
> + seth
>
> --
> Seth Falcon | @sfalcon | http://userprimary.net/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From romain at r-enthusiasts.com  Fri May 28 19:25:54 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Fri, 28 May 2010 19:25:54 +0200
Subject: [Rd] require( "foo (>= 2.1)" )
Message-ID: <4BFFFCA2.60201@r-enthusiasts.com>

Hello,

I often find myself writing code like :

if( require( "foo" ) && compareVersion( packageDescription( 
"foo")[["Version"]], "2.1" ) < 0 ){

	# code that uses version 2.1 of foo
} else {
	stop( "could not load version >= 2.1 of foo" )
}



Would it make sense to include something like this in require, library, 
etc ...

require( "foo (>= 2.1)" )
require( "foo", minimal.version = "2.1" )

I know we can use Depends: foo (>= 2.1) in a package DESCRIPTION file, 
but that does not work for loose dependencies, when package "bar" works 
better with "foo" but can still work fine without, or when not making a 
package.

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9CQ66r : RMetrics 2010
|- http://bit.ly/cork4b : highlight 0.1-8
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1




From romain at r-enthusiasts.com  Sat May 29 13:21:38 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sat, 29 May 2010 13:21:38 +0200
Subject: [Rd] S4 dispatch for .DollarNames (utils)
Message-ID: <4C00F8C2.4060508@r-enthusiasts.com>

Hello,

I'm trying to make .DollarNames generic and implement a method for it in 
a package. .DollarNames is the function that is now called to get 
completion possibilities.

My R code looks like this:

setGeneric( ".DollarNames" )

setClass("track",
          representation(x="numeric", y="numeric"))
## A class extending the previous, adding one more slot
setClass("trackCurve",
     representation(smooth = "numeric"),
     contains = "track")

setMethod( ".DollarNames", signature( x = "track", pattern = "character" 
), function(x, pattern){
	grep( pattern, c("foo", "bar"), value = TRUE )	
} )


and the NAMESPACE :

import( utils )
exportMethods( .DollarNames )
exportClasses( track, trackCurve )


When I load the package, I can call .DollarNames explicitely :

 > require( foo )
 > x <- new( "trackCurve", x = 1:10, y = 1:10, smooth = 1:10 )
 > .DollarNames( x, "f" )
[1] "foo"

but completion does not work :

 > x$f<TAB>
x$


What do I miss ?

I've uploaded foo here : http://addictedtor.free.fr/misc/rcpp/foo_1.0.tar.gz

Romain


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9CQ66r : RMetrics 2010
|- http://bit.ly/cork4b : highlight 0.1-8
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1




From romain at r-enthusiasts.com  Sat May 29 13:40:41 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sat, 29 May 2010 13:40:41 +0200
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <4C00F8C2.4060508@r-enthusiasts.com>
References: <4C00F8C2.4060508@r-enthusiasts.com>
Message-ID: <4C00FD39.3020707@r-enthusiasts.com>

This seems to do the trick, but it does not feel right:

.onLoad <- function( libname, pkgname ){	
	utils <- asNamespace( "utils" )
	unlockBinding( ".DollarNames", utils )
	assignInNamespace( ".DollarNames", .DollarNames, utils )
	lockBinding( ".DollarNames", utils )
}

Any better idea ?

Romain

Le 29/05/10 13:21, Romain Francois a ?crit :
>
> Hello,
>
> I'm trying to make .DollarNames generic and implement a method for it in
> a package. .DollarNames is the function that is now called to get
> completion possibilities.
>
> My R code looks like this:
>
> setGeneric( ".DollarNames" )
>
> setClass("track",
> representation(x="numeric", y="numeric"))
> ## A class extending the previous, adding one more slot
> setClass("trackCurve",
> representation(smooth = "numeric"),
> contains = "track")
>
> setMethod( ".DollarNames", signature( x = "track", pattern = "character"
> ), function(x, pattern){
> grep( pattern, c("foo", "bar"), value = TRUE )
> } )
>
>
> and the NAMESPACE :
>
> import( utils )
> exportMethods( .DollarNames )
> exportClasses( track, trackCurve )
>
>
> When I load the package, I can call .DollarNames explicitely :
>
>  > require( foo )
>  > x <- new( "trackCurve", x = 1:10, y = 1:10, smooth = 1:10 )
>  > .DollarNames( x, "f" )
> [1] "foo"
>
> but completion does not work :
>
>  > x$f<TAB>
> x$
>
>
> What do I miss ?
>
> I've uploaded foo here :
> http://addictedtor.free.fr/misc/rcpp/foo_1.0.tar.gz
>
> Romain
>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/9CQ66r : RMetrics 2010
|- http://bit.ly/cork4b : highlight 0.1-8
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1




From deepayan.sarkar at gmail.com  Sat May 29 20:23:28 2010
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Sat, 29 May 2010 11:23:28 -0700
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <4C00F8C2.4060508@r-enthusiasts.com>
References: <4C00F8C2.4060508@r-enthusiasts.com>
Message-ID: <AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>

On Sat, May 29, 2010 at 4:21 AM, Romain Francois
<romain at r-enthusiasts.com> wrote:
> Hello,
>
> I'm trying to make .DollarNames generic and implement a method for it in a
> package. .DollarNames is the function that is now called to get completion
> possibilities.
>
> My R code looks like this:
>
> setGeneric( ".DollarNames" )
>
> setClass("track",
> ? ? ? ? representation(x="numeric", y="numeric"))
> ## A class extending the previous, adding one more slot
> setClass("trackCurve",
> ? ?representation(smooth = "numeric"),
> ? ?contains = "track")
>
> setMethod( ".DollarNames", signature( x = "track", pattern = "character" ),
> function(x, pattern){
> ? ? ? ?grep( pattern, c("foo", "bar"), value = TRUE )
> } )
>
>
> and the NAMESPACE :
>
> import( utils )
> exportMethods( .DollarNames )
> exportClasses( track, trackCurve )
>
>
> When I load the package, I can call .DollarNames explicitely :
>
>> require( foo )
>> x <- new( "trackCurve", x = 1:10, y = 1:10, smooth = 1:10 )
>> .DollarNames( x, "f" )
> [1] "foo"
>
> but completion does not work :
>
>> x$f<TAB>
> x$

I guess because

> utils:::.DollarNames(x, "f")
character(0)

so the S4 generic is not being seen within the utils namespace. I
don't know what the right fix is...

-Deepayan

> What do I miss ?
>
> I've uploaded foo here : http://addictedtor.free.fr/misc/rcpp/foo_1.0.tar.gz
>
> Romain
>
>
> --
> Romain Francois
> Professional R Enthusiast
> +33(0) 6 28 91 30 30
> http://romainfrancois.blog.free.fr
> |- http://bit.ly/9CQ66r : RMetrics 2010
> |- http://bit.ly/cork4b : highlight 0.1-8
> `- http://bit.ly/bklUXt : RcppArmadillo 0.2.1
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From romain at r-enthusiasts.com  Sat May 29 21:37:07 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sat, 29 May 2010 21:37:07 +0200
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>
References: <4C00F8C2.4060508@r-enthusiasts.com>
	<AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>
Message-ID: <4C016CE3.8050403@r-enthusiasts.com>

Le 29/05/10 20:23, Deepayan Sarkar a ?crit :
> On Sat, May 29, 2010 at 4:21 AM, Romain Francois
> <romain at r-enthusiasts.com>  wrote:
>> Hello,
>>
>> I'm trying to make .DollarNames generic and implement a method for it in a
>> package. .DollarNames is the function that is now called to get completion
>> possibilities.
>>
>> My R code looks like this:
>>
>> setGeneric( ".DollarNames" )
>>
>> setClass("track",
>>          representation(x="numeric", y="numeric"))
>> ## A class extending the previous, adding one more slot
>> setClass("trackCurve",
>>     representation(smooth = "numeric"),
>>     contains = "track")
>>
>> setMethod( ".DollarNames", signature( x = "track", pattern = "character" ),
>> function(x, pattern){
>>         grep( pattern, c("foo", "bar"), value = TRUE )
>> } )
>>
>>
>> and the NAMESPACE :
>>
>> import( utils )
>> exportMethods( .DollarNames )
>> exportClasses( track, trackCurve )
>>
>>
>> When I load the package, I can call .DollarNames explicitely :
>>
>>> require( foo )
>>> x<- new( "trackCurve", x = 1:10, y = 1:10, smooth = 1:10 )
>>> .DollarNames( x, "f" )
>> [1] "foo"
>>
>> but completion does not work :
>>
>>> x$f<TAB>
>> x$
>
> I guess because
>
>> utils:::.DollarNames(x, "f")
> character(0)

yes. hence the hack I used when replying which is probably not a good 
idea, specially if two packages want it.

> so the S4 generic is not being seen within the utils namespace. I
> don't know what the right fix is...
>
> -Deepayan

Perhaps something like the attached ?

defining a generic in methods and use this one when methods dispatch is on.


>> What do I miss ?
>>
>> I've uploaded foo here : http://addictedtor.free.fr/misc/rcpp/foo_1.0.tar.gz
>>
>> Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/99bz5D : highlight 0.1-9
|- http://bit.ly/9CQ66r : RMetrics 2010
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: dollarnames.diff
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100529/beae8e39/attachment.pl>

From jmc at r-project.org  Sat May 29 23:17:18 2010
From: jmc at r-project.org (John Chambers)
Date: Sat, 29 May 2010 14:17:18 -0700
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <4C016CE3.8050403@r-enthusiasts.com>
References: <4C00F8C2.4060508@r-enthusiasts.com>	<AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>
	<4C016CE3.8050403@r-enthusiasts.com>
Message-ID: <4C01845E.5080102@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100529/14a07108/attachment.pl>

From romain at r-enthusiasts.com  Sun May 30 07:58:03 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sun, 30 May 2010 07:58:03 +0200
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <4C018406.50107@stanford.edu>
References: <4C00F8C2.4060508@r-enthusiasts.com>	<AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>
	<4C016CE3.8050403@r-enthusiasts.com> <4C018406.50107@stanford.edu>
Message-ID: <4C01FE6B.8030704@r-enthusiasts.com>

Thanks. I'll apply the nice workaround for now.

Romain

Le 29/05/10 23:15, John Chambers a ?crit :
> The idea of modifying .DollarNames to recognize S4 methods is OK, but
> the problem could arise again.
>
> It would be better to have a general solution.  The general problem as
> it seems is that an S3 generic called from within its package's
> namespace (or from some other 3rd package) will not detect S4 methods.
> In a sense, this is a natural consequence of namespace semantics and
> therefore not a bug.  We don't really want to fix up each case when it
> arises.
>
> I can see two general solutions, one a reasonable fix that could likely
> be implemented for 2.12.0, the other a slight hack added to make the
> solution work now.
>
> Both solutions start with the idea that we continue to treat the S3
> generic as an S3 generic (at least when it's called from the owning
> package's namespace).  We then define an S3 method for the S4 class.
>
> Right now, that fails to recognize S4 inheritance (that's the fix that
> should be doable for 2.12.0; most of the mechanism needed is already in
> the UseMethod implementation).
>
> The workaround/hack that *does* work now, I believe, is to insert a
> dummy S3 class into the mix and define the S3 .DollarNames method for it.
>
> Example:
>  > setOldClass("foo3")
>  > .DollarNames.foo3 <- function(x, pattern)"bar"
>  >
>  > setClass("foo", contains = "foo3", representation(x = "numeric"))
> [1] "foo"
>  >
>  > ff = new("foo")
>  >
>  > setClass("fee", contains = "foo")
> [1] "fee"
>  >
>  > fe = new("fee")
>
> Both ff$ and fe$ complete with "bar", running 2.11.0 from the command line.
>
> John
>
>
>
>
>
> On 5/29/10 12:37 PM, Romain Francois wrote:
>> Le 29/05/10 20:23, Deepayan Sarkar a ?crit :
>>> On Sat, May 29, 2010 at 4:21 AM, Romain Francois
>>> <romain at r-enthusiasts.com>  wrote:
>>>> Hello,
>>>>
>>>> I'm trying to make .DollarNames generic and implement a method for
>>>> it in a
>>>> package. .DollarNames is the function that is now called to get
>>>> completion
>>>> possibilities.
>>>>
>>>> My R code looks like this:
>>>>
>>>> setGeneric( ".DollarNames" )
>>>>
>>>> setClass("track",
>>>>          representation(x="numeric", y="numeric"))
>>>> ## A class extending the previous, adding one more slot
>>>> setClass("trackCurve",
>>>>     representation(smooth = "numeric"),
>>>>     contains = "track")
>>>>
>>>> setMethod( ".DollarNames", signature( x = "track", pattern =
>>>> "character" ),
>>>> function(x, pattern){
>>>>         grep( pattern, c("foo", "bar"), value = TRUE )
>>>> } )
>>>>
>>>>
>>>> and the NAMESPACE :
>>>>
>>>> import( utils )
>>>> exportMethods( .DollarNames )
>>>> exportClasses( track, trackCurve )
>>>>
>>>>
>>>> When I load the package, I can call .DollarNames explicitely :
>>>>
>>>>> require( foo )
>>>>> x<- new( "trackCurve", x = 1:10, y = 1:10, smooth = 1:10 )
>>>>> .DollarNames( x, "f" )
>>>> [1] "foo"
>>>>
>>>> but completion does not work :
>>>>
>>>>> x$f<TAB>
>>>> x$
>>>
>>> I guess because
>>>
>>>> utils:::.DollarNames(x, "f")
>>> character(0)
>>
>> yes. hence the hack I used when replying which is probably not a good
>> idea, specially if two packages want it.
>>
>>> so the S4 generic is not being seen within the utils namespace. I
>>> don't know what the right fix is...
>>>
>>> -Deepayan
>>
>> Perhaps something like the attached ?
>>
>> defining a generic in methods and use this one when methods dispatch
>> is on.
>>
>>
>>>> What do I miss ?
>>>>
>>>> I've uploaded foo here :
>>>> http://addictedtor.free.fr/misc/rcpp/foo_1.0.tar.gz
>>>>
>>>> Romain
>>
>>
>> ______________________________________________
>> R-devel at r-project.org  mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/99bz5D : highlight 0.1-9
|- http://bit.ly/9CQ66r : RMetrics 2010
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1




From whuber at embl.de  Sun May 30 14:49:00 2010
From: whuber at embl.de (Wolfgang Huber)
Date: Sun, 30 May 2010 14:49:00 +0200
Subject: [Rd] require( "foo (>= 2.1)" )
In-Reply-To: <4BFFFCA2.60201@r-enthusiasts.com>
References: <4BFFFCA2.60201@r-enthusiasts.com>
Message-ID: <4C025EBC.804@embl.de>

Hi Romain,

not that I have any authority here, but wouldn't your suggestion (which 
I think could be very useful) be more powerful if it were accompanied by 
a patch that could be applied to the R sources?

Best wishes
Wolfgang Huber
EMBL
http://www.embl.de/research/units/genome_biology/huber




On 28/05/10 19:25, Romain Francois wrote:
> Hello,
>
> I often find myself writing code like :
>
> if( require( "foo" ) && compareVersion( packageDescription(
> "foo")[["Version"]], "2.1" ) < 0 ){
>
> # code that uses version 2.1 of foo
> } else {
> stop( "could not load version >= 2.1 of foo" )
> }
>
>
>
> Would it make sense to include something like this in require, library,
> etc ...
>
> require( "foo (>= 2.1)" )
> require( "foo", minimal.version = "2.1" )
>
> I know we can use Depends: foo (>= 2.1) in a package DESCRIPTION file,
> but that does not work for loose dependencies, when package "bar" works
> better with "foo" but can still work fine without, or when not making a
> package.
>
> Romain
>

--


From cbeleites at units.it  Sun May 30 17:08:28 2010
From: cbeleites at units.it (Claudia Beleites)
Date: Sun, 30 May 2010 17:08:28 +0200
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <4C01845E.5080102@r-project.org>
References: <4C00F8C2.4060508@r-enthusiasts.com>	<AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>	<4C016CE3.8050403@r-enthusiasts.com>
	<4C01845E.5080102@r-project.org>
Message-ID: <httv0n$4pr$1@dough.gmane.org>

Dear all,

thank your for this discussion - I had been wondering how to get the completion 
with my S4 class, but it didn't bother me enough to dig into things.

> The workaround/hack that *does* work now, I believe, is to insert a 
> dummy S3 class into the mix and define the S3 .DollarNames method for it.
> 
> Example:
>  > setOldClass("foo3")
>  > .DollarNames.foo3 <- function(x, pattern)"bar"

My question here is: what is the dummy class needed for?

I have a few S3 methods for my S4 class (rbind.hyperSpec, cbind.hyperSpec, and 
now .DollarNames.hyperSpec). They seem to work just fine without first setting 
up a dummy S3 class that is then used in the contains of the S4 definition.
Any pitfalls with that?

Claudia



-- 
Claudia Beleites
Dipartimento dei Materiali e delle Risorse Naturali
Universit? degli Studi di Trieste
Via Alfonso Valerio 6/a
I-34127 Trieste

phone: +39 0 40 5 58-37 68
email: cbeleites at units.it


From jmc at r-project.org  Sun May 30 18:12:37 2010
From: jmc at r-project.org (John Chambers)
Date: Sun, 30 May 2010 09:12:37 -0700
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <httv0n$4pr$1@dough.gmane.org>
References: <4C00F8C2.4060508@r-enthusiasts.com>	<AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>	<4C016CE3.8050403@r-enthusiasts.com>	<4C01845E.5080102@r-project.org>
	<httv0n$4pr$1@dough.gmane.org>
Message-ID: <4C028E75.9040406@r-project.org>

Claudia,

Your S3 methods will be selected for objects from "hyperSpec", but not 
for S4 classes that inherit from that class (that have 
contains="hyperSpec" in their definition).

The S3 method dispatch has been fixed to recognize S4 classes that 
inherit from an S3 class, "foo3" in my example.

The plan is to fix that for the next release, and have S3 dispatch 
behave for all S4 objects, not just those that inherit from an S3 
class.  Meanwhile, the dummy class is needed.

On 5/30/10 8:08 AM, Claudia Beleites wrote:
> Dear all,
>
> thank your for this discussion - I had been wondering how to get the 
> completion with my S4 class, but it didn't bother me enough to dig 
> into things.
>
>> The workaround/hack that *does* work now, I believe, is to insert a 
>> dummy S3 class into the mix and define the S3 .DollarNames method for 
>> it.
>>
>> Example:
>> > setOldClass("foo3")
>> > .DollarNames.foo3 <- function(x, pattern)"bar"
>
> My question here is: what is the dummy class needed for?
>
> I have a few S3 methods for my S4 class (rbind.hyperSpec, 
> cbind.hyperSpec, and now .DollarNames.hyperSpec). They seem to work 
> just fine without first setting up a dummy S3 class that is then used 
> in the contains of the S4 definition.
> Any pitfalls with that?
>
> Claudia
>
>
>


From cbeleites at units.it  Sun May 30 18:21:18 2010
From: cbeleites at units.it (Claudia Beleites)
Date: Sun, 30 May 2010 18:21:18 +0200
Subject: [Rd] S4 dispatch for .DollarNames (utils)
In-Reply-To: <4C028E75.9040406@r-project.org>
References: <4C00F8C2.4060508@r-enthusiasts.com>	<AANLkTimkEzQ5GLpnWHJr1EuBcNBmwod81UzBFs0fXusk@mail.gmail.com>	<4C016CE3.8050403@r-enthusiasts.com>	<4C01845E.5080102@r-project.org>
	<httv0n$4pr$1@dough.gmane.org> <4C028E75.9040406@r-project.org>
Message-ID: <4C02907E.5040004@units.it>

John,

Thank your for the explanation!

Claudia


-- 
Claudia Beleites
Dipartimento dei Materiali e delle Risorse Naturali
Universit? degli Studi di Trieste
Via Alfonso Valerio 6/a
I-34127 Trieste

phone: +39 0 40 5 58-37 68
email: cbeleites at units.it


From romain at r-enthusiasts.com  Sun May 30 18:50:56 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sun, 30 May 2010 18:50:56 +0200
Subject: [Rd] require( "foo (>= 2.1)" )
In-Reply-To: <4C025EBC.804@embl.de>
References: <4BFFFCA2.60201@r-enthusiasts.com> <4C025EBC.804@embl.de>
Message-ID: <4C029770.2070707@r-enthusiasts.com>

Hi,

Sure. I could and I would provide a patch. Since this is more of a "nice 
to have", I wanted to first find out whether others would find it 
useful, and also if such a patch would have chances to get accepted by 
one of R-core members.

Sometimes patches I or others provide upfront are not accepted. I'm not 
complaining about it, it is always an opportunity to learn something ...

Romain

Le 30/05/10 14:49, Wolfgang Huber a ?crit :
>
> Hi Romain,
>
> not that I have any authority here, but wouldn't your suggestion (which
> I think could be very useful) be more powerful if it were accompanied by
> a patch that could be applied to the R sources?
>
> Best wishes
> Wolfgang Huber
> EMBL
> http://www.embl.de/research/units/genome_biology/huber
>
>
>
>
> On 28/05/10 19:25, Romain Francois wrote:
>> Hello,
>>
>> I often find myself writing code like :
>>
>> if( require( "foo" ) && compareVersion( packageDescription(
>> "foo")[["Version"]], "2.1" ) < 0 ){
>>
>> # code that uses version 2.1 of foo
>> } else {
>> stop( "could not load version >= 2.1 of foo" )
>> }
>>
>>
>>
>> Would it make sense to include something like this in require, library,
>> etc ...
>>
>> require( "foo (>= 2.1)" )
>> require( "foo", minimal.version = "2.1" )
>>
>> I know we can use Depends: foo (>= 2.1) in a package DESCRIPTION file,
>> but that does not work for loose dependencies, when package "bar" works
>> better with "foo" but can still work fine without, or when not making a
>> package.
>>
>> Romain


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/99bz5D : highlight 0.1-9
|- http://bit.ly/9CQ66r : RMetrics 2010
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1




From ggrothendieck at gmail.com  Sun May 30 21:13:59 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 30 May 2010 15:13:59 -0400
Subject: [Rd] Bug with ..0
Message-ID: <AANLkTimvfFmXKD0fQjp6786WR9FQRnvKDFMlIFT1wP-R@mail.gmail.com>

This function call returns 3 but should return 32.  ..0 has no special
significance in R as far I know yet it seems to be acting as if it
were ..1 .  Comments?

> ff <- function(..0, ...) ..0
> ff(32, 3)
[1] 3

> R.version.string
[1] "R version 2.11.0 Patched (2010-04-26 r51822)"
> win.version()
[1] "Windows Vista (build 6002) Service Pack 2"


From murdoch.duncan at gmail.com  Sun May 30 21:40:29 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 30 May 2010 15:40:29 -0400
Subject: [Rd] Bug with ..0
In-Reply-To: <AANLkTimvfFmXKD0fQjp6786WR9FQRnvKDFMlIFT1wP-R@mail.gmail.com>
References: <AANLkTimvfFmXKD0fQjp6786WR9FQRnvKDFMlIFT1wP-R@mail.gmail.com>
Message-ID: <4C02BF2D.8050205@gmail.com>

On 30/05/2010 3:13 PM, Gabor Grothendieck wrote:
> This function call returns 3 but should return 32.  ..0 has no special
> significance in R as far I know yet it seems to be acting as if it
> were ..1 .  Comments?
>   

Actually, ..0 is a reserved symbol.  (This is just barely documented in 
the R Language Defn, with more detail in R Internals.)  It stands for 
the "zeroth element of ..."  That definition makes no sense (indexing of 
... starts at 1), so we should probably generate an error when you use 
it, and perhaps when you try to redefine it by using it as an argument.  
But this is really a case of you doing something you shouldn't, and the 
error handling not slapping you on the wrist.

Duncan Murdoch
>   
>> ff <- function(..0, ...) ..0
>> ff(32, 3)
>>     
> [1] 3
>
>   
>> R.version.string
>>     
> [1] "R version 2.11.0 Patched (2010-04-26 r51822)"
>   
>> win.version()
>>     
> [1] "Windows Vista (build 6002) Service Pack 2"
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ggrothendieck at gmail.com  Sun May 30 21:44:08 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 30 May 2010 15:44:08 -0400
Subject: [Rd] Bug with ..0
In-Reply-To: <4C02BF2D.8050205@gmail.com>
References: <AANLkTimvfFmXKD0fQjp6786WR9FQRnvKDFMlIFT1wP-R@mail.gmail.com> 
	<4C02BF2D.8050205@gmail.com>
Message-ID: <AANLkTilF5UNAM8BuWff2Id07CB2GlDKklgpthUOS-Ffc@mail.gmail.com>

Note that ?Reserved lists ..1, ..2, to ..9 but does not list ..0.

Also, why is it reserved?  What is the future intended use?

On Sun, May 30, 2010 at 3:40 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 30/05/2010 3:13 PM, Gabor Grothendieck wrote:
>>
>> This function call returns 3 but should return 32. ?..0 has no special
>> significance in R as far I know yet it seems to be acting as if it
>> were ..1 . ?Comments?
>>
>
> Actually, ..0 is a reserved symbol. ?(This is just barely documented in the
> R Language Defn, with more detail in R Internals.) ?It stands for the
> "zeroth element of ..." ?That definition makes no sense (indexing of ...
> starts at 1), so we should probably generate an error when you use it, and
> perhaps when you try to redefine it by using it as an argument. ?But this is
> really a case of you doing something you shouldn't, and the error handling
> not slapping you on the wrist.
>
> Duncan Murdoch
>>
>>
>>>
>>> ff <- function(..0, ...) ..0
>>> ff(32, 3)
>>>
>>
>> [1] 3
>>
>>
>>>
>>> R.version.string
>>>
>>
>> [1] "R version 2.11.0 Patched (2010-04-26 r51822)"
>>
>>>
>>> win.version()
>>>
>>
>> [1] "Windows Vista (build 6002) Service Pack 2"
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>


From murdoch.duncan at gmail.com  Sun May 30 22:31:23 2010
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 30 May 2010 16:31:23 -0400
Subject: [Rd] Bug with ..0
In-Reply-To: <AANLkTilF5UNAM8BuWff2Id07CB2GlDKklgpthUOS-Ffc@mail.gmail.com>
References: <AANLkTimvfFmXKD0fQjp6786WR9FQRnvKDFMlIFT1wP-R@mail.gmail.com>
	<4C02BF2D.8050205@gmail.com>
	<AANLkTilF5UNAM8BuWff2Id07CB2GlDKklgpthUOS-Ffc@mail.gmail.com>
Message-ID: <4C02CB1B.2000808@gmail.com>

On 30/05/2010 3:44 PM, Gabor Grothendieck wrote:
> Note that ?Reserved lists ..1, ..2, to ..9 but does not list ..0.
>   

Which version are you looking at? Mine says "?..1?, ?..2? etc," In fact, 
the code just looks for the pattern of two dots followed by something 
that can be converted to a long; see isDDName in src/main/dstruct.c.
> Also, why is it reserved?  What is the future intended use?
>   

As far as I know, there is none. It is reserved simply because it 
follows the pattern of "..n". It would not be hard to make ..0 specially 
unreserved, but what would be the point?

Duncan Murdoch
> On Sun, May 30, 2010 at 3:40 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>   
>> On 30/05/2010 3:13 PM, Gabor Grothendieck wrote:
>>     
>>> This function call returns 3 but should return 32.  ..0 has no special
>>> significance in R as far I know yet it seems to be acting as if it
>>> were ..1 .  Comments?
>>>
>>>       
>> Actually, ..0 is a reserved symbol.  (This is just barely documented in the
>> R Language Defn, with more detail in R Internals.)  It stands for the
>> "zeroth element of ..."  That definition makes no sense (indexing of ...
>> starts at 1), so we should probably generate an error when you use it, and
>> perhaps when you try to redefine it by using it as an argument.  But this is
>> really a case of you doing something you shouldn't, and the error handling
>> not slapping you on the wrist.
>>
>> Duncan Murdoch
>>     
>>>       
>>>> ff <- function(..0, ...) ..0
>>>> ff(32, 3)
>>>>
>>>>         
>>> [1] 3
>>>
>>>
>>>       
>>>> R.version.string
>>>>
>>>>         
>>> [1] "R version 2.11.0 Patched (2010-04-26 r51822)"
>>>
>>>       
>>>> win.version()
>>>>
>>>>         
>>> [1] "Windows Vista (build 6002) Service Pack 2"
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>       
>>


From nashjc at uottawa.ca  Sun May 30 23:33:35 2010
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Sun, 30 May 2010 17:33:35 -0400
Subject: [Rd] Location of source code for readline()
Message-ID: <4C02D9AF.1060207@uottawa.ca>

A few days ago on R-help I asked about a cross-platform timeout version of readline().
Some suggestions, but only partial joy so far. I can get the Gnu bash  'read -t ...' to
work in Windows by using the 'bash -c ' construct, but then R's system() function does not
seem to allow this to pass through. Similarly a Perl and Free Pascal routine that I tried,
the latter being a single executable that did the prompt and the timeout. (I can send code
offline if anyone interested -- not fully protected against bad inputs, however.)

Now I'm wondering where the code for readline is located in the R source. I've tracked as
far as the 'do_readln' in names.c, but now want to find the actual code to see if I can
patch it, though I am a real novice in C. Suggestions welcome.

My application, FYI, is to have a script that will display something, and wait for a
keypress (for readline it seems to need the Enter key) but timeout after a preset number
of seconds. The setTimeLimit "almost" works -- but not for readline. I'm thinking of a
modified readline like readline(prompt='Do you want to continue?', timeout=6).

Note that the issue seems to be Windows. I haven't a Mac to try, but Linux can be made to
function by various methods at the top.  Sigh.

JN


From ggrothendieck at gmail.com  Mon May 31 00:20:00 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 30 May 2010 18:20:00 -0400
Subject: [Rd] Bug with ..0
In-Reply-To: <4C02CB1B.2000808@gmail.com>
References: <AANLkTimvfFmXKD0fQjp6786WR9FQRnvKDFMlIFT1wP-R@mail.gmail.com> 
	<4C02BF2D.8050205@gmail.com>
	<AANLkTilF5UNAM8BuWff2Id07CB2GlDKklgpthUOS-Ffc@mail.gmail.com> 
	<4C02CB1B.2000808@gmail.com>
Message-ID: <AANLkTimTFsZINzeqCvUKgsqs5fY1v-ud89KERG9VnEbU@mail.gmail.com>

On Sun, May 30, 2010 at 4:31 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> As far as I know, there is none. It is reserved simply because it follows
> the pattern of "..n". It would not be hard to make ..0 specially unreserved,
> but what would be the point?

Here is the case I had in mind.

The gsubfn function in the gsubfn package is like gsub except the
replacement string can be a replacement function such that it passes
the back references in the pattern as successive args to the function.
Here it would pass two args to the function represented by (.) and (.)
in the regular expression and then replace the match with the output
of the function which in this case is the sum of the digits surrounded
with angle brackets:

> gsubfn("(.)#(.)", function(...) paste0("<", as.numeric(..1) + as.numeric(..2), ">"), "1#2 3#4")
[1] "<3> <7>"

There is also an option to pass the entire match followed by the back
references to the user function.  In that case it would be nice for
the user to be able to write the user function as follows where ..0
means the entire match.  Here we replace the match with an angle
bracket, the entire match, an equal sign, the sum and an end angle
bracket:

> gsubfn("(.)#(.)", function(..0, ...) paste0("<", ..0, "=", as.numeric(..1) + as.numeric(..2), ">"), "1#2 3#4")
[1] "<1#2=3> <3#4=7>"

Note the use of ..0 to mean the entire match is in this context and
how natural it is.

To do the above the best would be if we could just use ..0 as an
ordinary variable.  Barring that we could replace all occurrences of
..0 with X..0, say, so that:

   function(..0, ...) list(..0, ..1)

would be transformed to the function

   function(X..0, ...) list(X..0, ..1)

and that could work now but that would depend on R not being changed
in the future to issue an error when a function such as f above that
uses ..0 is created.

(Although not illustrated here there is also a formula notation which
allows one to specify the function as a formula whose body is taken to
be the formula's RHS and the args are reconstructed from the RHS free
variables.   In that case the ..0 notation becomes even more useful.)


From ehlers at ucalgary.ca  Mon May 31 00:37:57 2010
From: ehlers at ucalgary.ca (Peter Ehlers)
Date: Sun, 30 May 2010 16:37:57 -0600
Subject: [Rd] Location of source code for readline()
In-Reply-To: <4C02D9AF.1060207@uottawa.ca>
References: <4C02D9AF.1060207@uottawa.ca>
Message-ID: <4C02E8C5.8080503@ucalgary.ca>

On 2010-05-30 15:33, Prof. John C Nash wrote:
> A few days ago on R-help I asked about a cross-platform timeout version of readline().
> Some suggestions, but only partial joy so far. I can get the Gnu bash  'read -t ...' to
> work in Windows by using the 'bash -c ' construct, but then R's system() function does not
> seem to allow this to pass through. Similarly a Perl and Free Pascal routine that I tried,
> the latter being a single executable that did the prompt and the timeout. (I can send code
> offline if anyone interested -- not fully protected against bad inputs, however.)
>
> Now I'm wondering where the code for readline is located in the R source. I've tracked as
> far as the 'do_readln' in names.c, but now want to find the actual code to see if I can
> patch it, though I am a real novice in C. Suggestions welcome.
>
> My application, FYI, is to have a script that will display something, and wait for a
> keypress (for readline it seems to need the Enter key) but timeout after a preset number
> of seconds. The setTimeLimit "almost" works -- but not for readline. I'm thinking of a
> modified readline like readline(prompt='Do you want to continue?', timeout=6).
>
> Note that the issue seems to be Windows. I haven't a Mac to try, but Linux can be made to
> function by various methods at the top.  Sigh.
>
> JN
>

I can't help with your project, but check scan.c for do_readln.

  -Peter Ehlers


From b.rowlingson at lancaster.ac.uk  Mon May 31 10:41:37 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 31 May 2010 09:41:37 +0100
Subject: [Rd] require( "foo (>= 2.1)" )
In-Reply-To: <4C029770.2070707@r-enthusiasts.com>
References: <4BFFFCA2.60201@r-enthusiasts.com> <4C025EBC.804@embl.de>
	<4C029770.2070707@r-enthusiasts.com>
Message-ID: <AANLkTikymtVD6zL7re88rCO8JMA3xDZv8e8AkqrrvZJi@mail.gmail.com>

On Sun, May 30, 2010 at 5:50 PM, Romain Francois
<romain at r-enthusiasts.com> wrote:
> Hi,
>
> Sure. I could and I would provide a patch. Since this is more of a "nice to
> have", I wanted to first find out whether others would find it useful, and
> also if such a patch would have chances to get accepted by one of R-core
> members.
>
> Sometimes patches I or others provide upfront are not accepted. I'm not
> complaining about it, it is always an opportunity to learn something ...
>

 For starters you could write a function called "requireVersion" that
does what you want. That would help you (since you say you often find
yourself using this paradigm) and also it would help anyone else who
does this. And since it wouldn't be a patch to R it wouldn't need
R-gods to approve it. It would also make you think about how you'd
parameterise the call - I wouldn't want to build something that had to
parse "foo (>=2.1)", for example, but having a minimum.version
argument makes more sense. Shouldn't be that difficult, you've written
most of it already!

 It might then get included in one of the packages of miscellany on
CRAN, and then maybe become core R functionality (if you sacrifice the
required animal to the R-gods, of course).

Barry


From romain at r-enthusiasts.com  Mon May 31 11:17:15 2010
From: romain at r-enthusiasts.com (Romain Francois)
Date: Mon, 31 May 2010 11:17:15 +0200
Subject: [Rd] require( "foo (>= 2.1)" )
In-Reply-To: <AANLkTikymtVD6zL7re88rCO8JMA3xDZv8e8AkqrrvZJi@mail.gmail.com>
References: <4BFFFCA2.60201@r-enthusiasts.com>
	<4C025EBC.804@embl.de>	<4C029770.2070707@r-enthusiasts.com>
	<AANLkTikymtVD6zL7re88rCO8JMA3xDZv8e8AkqrrvZJi@mail.gmail.com>
Message-ID: <4C037E9B.1050501@r-enthusiasts.com>

Le 31/05/10 10:41, Barry Rowlingson a ?crit :
>
> On Sun, May 30, 2010 at 5:50 PM, Romain Francois
> <romain at r-enthusiasts.com>  wrote:
>> Hi,
>>
>> Sure. I could and I would provide a patch. Since this is more of a "nice to
>> have", I wanted to first find out whether others would find it useful, and
>> also if such a patch would have chances to get accepted by one of R-core
>> members.
>>
>> Sometimes patches I or others provide upfront are not accepted. I'm not
>> complaining about it, it is always an opportunity to learn something ...
 >
>   For starters you could write a function called "requireVersion" that
> does what you want. That would help you (since you say you often find
> yourself using this paradigm) and also it would help anyone else who
> does this. And since it wouldn't be a patch to R it wouldn't need
> R-gods to approve it. It would also make you think about how you'd
> parameterise the call - I wouldn't want to build something that had to
> parse "foo (>=2.1)"

The code already exists, to process DESCRIPTION files with:

Depends: foo (>= 2.1)

but I think I also prefer using another argument anyway. Then there is 
also : what do you do if a lower version is found: warning, error, 
something that is parameterized y another argument, ...

> for example, but having a minimum.version
> argument makes more sense. Shouldn't be that difficult, you've written
> most of it already!
>
>   It might then get included in one of the packages of miscellany on
> CRAN, and then maybe become core R functionality (if you sacrifice the
> required animal to the R-gods, of course).
>
> Barry

The problem with another function on top of require or library is that 
it either has to copy a lot of code from library or first call library 
and then find out if the loaded version is high enough. I think it is 
better that the package is not loaded at all if the version is not good 
enough (it might load the packages it depends on for nothing, etc ...) 
which is why I think a patch to library makes more sense.



But, library or require currently don't have a ... sink so code like :

require( "foo", min.version = "2.1" )

would only work in, say R 2.12.0.


Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://bit.ly/99bz5D : highlight 0.1-9
|- http://bit.ly/9CQ66r : RMetrics 2010
`- http://bit.ly/bklUXt : RcppArmadillo 0.2.1




From hb at stat.berkeley.edu  Mon May 31 11:17:31 2010
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 31 May 2010 11:17:31 +0200
Subject: [Rd] require( "foo (>= 2.1)" )
In-Reply-To: <AANLkTikymtVD6zL7re88rCO8JMA3xDZv8e8AkqrrvZJi@mail.gmail.com>
References: <4BFFFCA2.60201@r-enthusiasts.com> <4C025EBC.804@embl.de>
	<4C029770.2070707@r-enthusiasts.com>
	<AANLkTikymtVD6zL7re88rCO8JMA3xDZv8e8AkqrrvZJi@mail.gmail.com>
Message-ID: <AANLkTikaVEXctDWlzGDEj2BINC5nhG-zMyI4VXs0jn7e@mail.gmail.com>

On Mon, May 31, 2010 at 10:41 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Sun, May 30, 2010 at 5:50 PM, Romain Francois
> <romain at r-enthusiasts.com> wrote:
>> Hi,
>>
>> Sure. I could and I would provide a patch. Since this is more of a "nice to
>> have", I wanted to first find out whether others would find it useful, and
>> also if such a patch would have chances to get accepted by one of R-core
>> members.
>>
>> Sometimes patches I or others provide upfront are not accepted. I'm not
>> complaining about it, it is always an opportunity to learn something ...
>>
>
> ?For starters you could write a function called "requireVersion" that
> does what you want. That would help you (since you say you often find
> yourself using this paradigm) and also it would help anyone else who
> does this. And since it wouldn't be a patch to R it wouldn't need
> R-gods to approve it. It would also make you think about how you'd
> parameterise the call - I wouldn't want to build something that had to
> parse "foo (>=2.1)", for example, but having a minimum.version
> argument makes more sense. Shouldn't be that difficult, you've written
> most of it already!

I agree that this would be a useful extension to have.  Exact setup of
arguments can be discussed.  I agree that only having "foo (>= 2.1)"
is not good (though probably the most flexible one).  It might be that
one want to specify a range of versions to load.

Also, consider the case where are three libraries on the .libPaths()
each having a different version of foo installed (this can happen in
shared setups), e.g.

libA/ containing foo v2.0
libB/ containing foo v2.1
libC/ containing foo v2.2

and .libPaths() contains libA, libB and libC in that order.

What should happen with:

(a) require("foo") - should it load v2.0, v2.1 or v2.2?  Today the
first one on the search path, i.e. v2.0.
(b) require("foo (>= 2.1)") - should it throw an error saying it found
v2.0 but it is not sufficient, or should it skip v2.0 and load v2.1 or
v2.2?
(c) require("foo (<= 2.1)") - should it load v2.0 or v2.1?

If require() is smart and skips insufficient versions, that is, does
not just load the first available one, then one also have to worry
about consistency to other functions such as packageDescription().

/Henrik

>
> ?It might then get included in one of the packages of miscellany on
> CRAN, and then maybe become core R functionality (if you sacrifice the
> required animal to the R-gods, of course).
>
> Barry
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From rvaradhan at jhmi.edu  Mon May 31 18:35:32 2010
From: rvaradhan at jhmi.edu (Ravi Varadhan)
Date: Mon, 31 May 2010 12:35:32 -0400
Subject: [Rd] Documentation of biplot for princomp
Message-ID: <001701cb00df$49aef1a0$dd0cd4e0$@edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20100531/e2fd83a5/attachment.pl>

From Vincent.Goulet at act.ulaval.ca  Mon May 31 23:13:16 2010
From: Vincent.Goulet at act.ulaval.ca (Vincent Goulet)
Date: Mon, 31 May 2010 17:13:16 -0400
Subject: [Rd] Suggested tidying up
Message-ID: <4C4C31FF-4FAC-41F9-87ED-F09804FD2CCB@act.ulaval.ca>

Package grDevices has a function cm() to convert from inches to centimeters. Its definition is:

cm <- function(x) 2.54*x

As far as I can tell, the function is not used anywhere in the R sources (I grepped for "cm(", "cm)" and ", cm".) I did not check for all packages on CRAN, though.

May I propose to remove this apparently useless function from the sources?

[I stubbled upon this function because my package actuar also has a cm() function that masks the one from grDevices.]


Dr. Vincent Goulet
Full Professor
?cole d'actuariat, Universit? Laval, Qu?bec 
vincent.goulet at act.ulaval.ca   http://vgoulet.act.ulaval.ca


