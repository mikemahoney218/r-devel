From bbolker at gmail.com  Mon Sep  1 20:42:37 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Sep 2014 14:42:37 -0400
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
Message-ID: <5404BE1D.2020609@mcmaster.ca>


  I apologize in advance for not having done more homework in advance,
but thought I would send this along to see if anyone else was seeing this.

  I am having some sort of ggplot2/plyr/very-recent-R-devel dependency
issues.

  Just installed

R Under development (unstable) (2014-09-01 r66509) -- "Unsuffered
Consequences"

 from source.

> packageVersion("ggplot2")
[1] ?1.0.0?
> packageVersion("plyr")
[1] ?1.8.1?

library(plyr) works

  but then I get:

library(ggplot2)
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck =
vI[[i]]) :
  namespace ?plyr? 1.8.1 is being loaded, but >= 1.7.1 is required
Error: package or namespace load failed for ?ggplot2?

  I don't remember when I most recently updated my r-devel (it was
probably a few months old); nothing in recent commits rings a bell.

  Works fine on R version 3.1.1 (except for a "ggplot2 built under
3.2.0 warning").

  Does anyone else see this or is it just something weird about my setup?

  Ben Bolker


From cboettig at gmail.com  Mon Sep  1 22:08:33 2014
From: cboettig at gmail.com (Carl Boettiger)
Date: Mon, 1 Sep 2014 13:08:33 -0700
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <5404BE1D.2020609@mcmaster.ca>
References: <5404BE1D.2020609@mcmaster.ca>
Message-ID: <CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>

Hi Ben,

Just tested this on a fresh ubuntu 14:04 sandbox by using Dirk's docker
image (
https://github.com/eddelbuettel/docker-ubuntu-r/tree/master/add-r-devel-san)
for Rdevel.

> install.packages(c("dplyr", "ggplot2"))
> library("dplyr")
> library("ggplot2")

runs fine for me (though takes a few minutes to compile everything). So it
seems you must have done something to your local environment, but not sure
what.




On Mon, Sep 1, 2014 at 11:42 AM, Ben Bolker <bbolker at gmail.com> wrote:

>
>   I apologize in advance for not having done more homework in advance,
> but thought I would send this along to see if anyone else was seeing this.
>
>   I am having some sort of ggplot2/plyr/very-recent-R-devel dependency
> issues.
>
>   Just installed
>
> R Under development (unstable) (2014-09-01 r66509) -- "Unsuffered
> Consequences"
>
>  from source.
>
> > packageVersion("ggplot2")
> [1] ?1.0.0?
> > packageVersion("plyr")
> [1] ?1.8.1?
>
> library(plyr) works
>
>   but then I get:
>
> library(ggplot2)
> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck =
> vI[[i]]) :
>   namespace ?plyr? 1.8.1 is being loaded, but >= 1.7.1 is required
> Error: package or namespace load failed for ?ggplot2?
>
>   I don't remember when I most recently updated my r-devel (it was
> probably a few months old); nothing in recent commits rings a bell.
>
>   Works fine on R version 3.1.1 (except for a "ggplot2 built under
> 3.2.0 warning").
>
>   Does anyone else see this or is it just something weird about my setup?
>
>   Ben Bolker
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Carl Boettiger
UC Santa Cruz
http://carlboettiger.info/

	[[alternative HTML version deleted]]


From bbolker at gmail.com  Mon Sep  1 22:16:09 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Sep 2014 16:16:09 -0400
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
Message-ID: <CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>

thanks -- although I think `dplyr` is a red herring; my issue is with
`plyr` (which is imported by `ggplot2` so should get installed
automatically anyway ...)


On Mon, Sep 1, 2014 at 4:08 PM, Carl Boettiger <cboettig at gmail.com> wrote:

> Hi Ben,
>
> Just tested this on a fresh ubuntu 14:04 sandbox by using Dirk's docker
> image (
> https://github.com/eddelbuettel/docker-ubuntu-r/tree/master/add-r-devel-san)
> for Rdevel.
>
> > install.packages(c("dplyr", "ggplot2"))
> > library("dplyr")
> > library("ggplot2")
>
> runs fine for me (though takes a few minutes to compile everything). So it
> seems you must have done something to your local environment, but not sure
> what.
>
>
>
>
> On Mon, Sep 1, 2014 at 11:42 AM, Ben Bolker <bbolker at gmail.com> wrote:
>
>>
>>   I apologize in advance for not having done more homework in advance,
>> but thought I would send this along to see if anyone else was seeing this.
>>
>>   I am having some sort of ggplot2/plyr/very-recent-R-devel dependency
>> issues.
>>
>>   Just installed
>>
>> R Under development (unstable) (2014-09-01 r66509) -- "Unsuffered
>> Consequences"
>>
>>  from source.
>>
>> > packageVersion("ggplot2")
>> [1] ?1.0.0?
>> > packageVersion("plyr")
>> [1] ?1.8.1?
>>
>> library(plyr) works
>>
>>   but then I get:
>>
>> library(ggplot2)
>> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck =
>> vI[[i]]) :
>>   namespace ?plyr? 1.8.1 is being loaded, but >= 1.7.1 is required
>> Error: package or namespace load failed for ?ggplot2?
>>
>>   I don't remember when I most recently updated my r-devel (it was
>> probably a few months old); nothing in recent commits rings a bell.
>>
>>   Works fine on R version 3.1.1 (except for a "ggplot2 built under
>> 3.2.0 warning").
>>
>>   Does anyone else see this or is it just something weird about my setup?
>>
>>   Ben Bolker
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> --
> Carl Boettiger
> UC Santa Cruz
> http://carlboettiger.info/
>

	[[alternative HTML version deleted]]


From titus at barik.net  Mon Sep  1 21:58:49 2014
From: titus at barik.net (Titus Barik)
Date: Mon, 01 Sep 2014 12:58:49 -0700
Subject: [Rd] Unable to compile R 3.1.3 under GCC 4.1.2 (Red Hat 4.1.2-51)
Message-ID: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>

Hi all,

I'm unable to compile R under an HPC system (which like many HPC systems
doesn't always have the latest and greatest software). The version of
GCC is 4.1.2 under CentOS 5.7. Running ./configure gives the following
output:

R is now configured for x86_64-unknown-linux-gnu
 
  Source directory:          .
  Installation directory:    /home/tbarik
 
  C compiler:                gcc -std=gnu99  -I/home/tbarik/include
  Fortran 77 compiler:       gfortran  -g -O2
 
  C++ compiler:              g++  -g -O2
  C++ 11 compiler:
  Fortran 90/95 compiler:    gfortran -g -O2
  Obj-C compiler:
 
  Interfaces supported:      X11
  External libraries:        readline
  Additional capabilities:   NLS
  Options enabled:           shared BLAS, R profiling
 
  Recommended packages:      yes

which I think looks good (at least, -std=gnu99 appears to be present).
However, when I try make, I receive the following dump during
installation of the Matrix package:

* installing *source* package 'Matrix' ...
** package 'Matrix' successfully unpacked and MD5 sums checked
** libs
make[3]: Entering directory
`/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
mpicc -I/home/tbarik/src/R-3.1.1/include -DNDEBUG -DNTIMER
-I./SuiteSparse_config -I/usr/local/incl        ude    -fpic 
-I/home/tbarik/include  -c CHMfactor.c -o CHMfactor.o
In file included from CHMfactor.h:4,
                 from CHMfactor.c:2:
Mutils.h: In function 'inv_permutation':
Mutils.h:270: error: 'for' loop initial declaration used outside C99
mode
In file included from Mutils.h:374,
                 from CHMfactor.h:4,
                 from CHMfactor.c:2:
t_sparseVector.c: In function 'dsparseVector_sub':
t_sparseVector.c:139: error: 'for' loop initial declaration used outside
C99 mode
In file included from Mutils.h:377,
                 from CHMfactor.h:4,
                 from CHMfactor.c:2:
t_sparseVector.c: In function 'isparseVector_sub':
t_sparseVector.c:139: error: 'for' loop initial declaration used outside
C99 mode
In file included from Mutils.h:380,
                 from CHMfactor.h:4,
                 from CHMfactor.c:2:
t_sparseVector.c: In function 'lsparseVector_sub':
t_sparseVector.c:139: error: 'for' loop initial declaration used outside
C99 mode
In file included from Mutils.h:383,
                 from CHMfactor.h:4,
                 from CHMfactor.c:2:
t_sparseVector.c: In function 'nsparseVector_sub':
t_sparseVector.c:139: error: 'for' loop initial declaration used outside
C99 mode
In file included from Mutils.h:386,
                 from CHMfactor.h:4,
                 from CHMfactor.c:2:
t_sparseVector.c: In function 'zsparseVector_sub':
t_sparseVector.c:139: error: 'for' loop initial declaration used outside
C99 mode
make[3]: *** [CHMfactor.o] Error 1
make[3]: Leaving directory
`/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
ERROR: compilation failed for package 'Matrix'
* removing '/home/tbarik/src/R-3.1.1/library/Matrix'
make[2]: *** [Matrix.ts] Error 1

Any advice on what to do is greatly appreciated.

Thanks,

Titus


-- 
Titus Barik, PE <titus at barik.net>


From edd at debian.org  Mon Sep  1 22:53:57 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 1 Sep 2014 15:53:57 -0500
Subject: [Rd] Unable to compile R 3.1.3 under GCC 4.1.2 (Red Hat
	4.1.2-51)
In-Reply-To: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
References: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
Message-ID: <21508.56549.437930.992739@max.nulle.part>


On 1 September 2014 at 12:58, Titus Barik wrote:
| I'm unable to compile R under an HPC system (which like many HPC systems
| doesn't always have the latest and greatest software). The version of
| GCC is 4.1.2 under CentOS 5.7.

With all due respect, that gcc release is from Feb 2007 [1].  

You are presumably not trying to stick to the corresponding R release --
which would be R 2.4.1 or R 2.5.0 as of Apr 2007.  So consider an upgrade of
other pieces of the system too, if you can.  

It is not entirely fair to expect current releases of software to work with a
toolchains from 7 1/2 years ago.

In the future, containerization will make that easier, but you are probably
also running a 2.4 kernel so ...   

All that said, I feel your pain.  But if you manage to download and configure
from a tarball for R, consider doing the same for gcc/g77/g++ and friends.

Dirk

[1] https://ftp.gnu.org/gnu/gcc/gcc-4.1.2/

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From csardi.gabor at gmail.com  Mon Sep  1 23:01:17 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 1 Sep 2014 17:01:17 -0400
Subject: [Rd] Unable to compile R 3.1.3 under GCC 4.1.2 (Red Hat
	4.1.2-51)
In-Reply-To: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
References: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
Message-ID: <CABtg=KkpRzyhhjhq10PC0e1o+0ygkFNS=qhdC8yC+xhsFuypJQ@mail.gmail.com>

Hi, see this about updating your gcc. Assuming you can do that:
https://www.centos.org/forums/viewtopic.php?t=22240

Gabor

On Mon, Sep 1, 2014 at 3:58 PM, Titus Barik <titus at barik.net> wrote:
> Hi all,
>
> I'm unable to compile R under an HPC system (which like many HPC systems
> doesn't always have the latest and greatest software). The version of
> GCC is 4.1.2 under CentOS 5.7. Running ./configure gives the following
> output:
>
> R is now configured for x86_64-unknown-linux-gnu
>
>   Source directory:          .
>   Installation directory:    /home/tbarik
>
>   C compiler:                gcc -std=gnu99  -I/home/tbarik/include
>   Fortran 77 compiler:       gfortran  -g -O2
>
>   C++ compiler:              g++  -g -O2
>   C++ 11 compiler:
>   Fortran 90/95 compiler:    gfortran -g -O2
>   Obj-C compiler:
>
>   Interfaces supported:      X11
>   External libraries:        readline
>   Additional capabilities:   NLS
>   Options enabled:           shared BLAS, R profiling
>
>   Recommended packages:      yes
>
> which I think looks good (at least, -std=gnu99 appears to be present).
> However, when I try make, I receive the following dump during
> installation of the Matrix package:
>
> * installing *source* package 'Matrix' ...
> ** package 'Matrix' successfully unpacked and MD5 sums checked
> ** libs
> make[3]: Entering directory
> `/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
> mpicc -I/home/tbarik/src/R-3.1.1/include -DNDEBUG -DNTIMER
> -I./SuiteSparse_config -I/usr/local/incl        ude    -fpic
> -I/home/tbarik/include  -c CHMfactor.c -o CHMfactor.o
> In file included from CHMfactor.h:4,
>                  from CHMfactor.c:2:
> Mutils.h: In function 'inv_permutation':
> Mutils.h:270: error: 'for' loop initial declaration used outside C99
> mode
> In file included from Mutils.h:374,
>                  from CHMfactor.h:4,
>                  from CHMfactor.c:2:
> t_sparseVector.c: In function 'dsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:377,
>                  from CHMfactor.h:4,
>                  from CHMfactor.c:2:
> t_sparseVector.c: In function 'isparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:380,
>                  from CHMfactor.h:4,
>                  from CHMfactor.c:2:
> t_sparseVector.c: In function 'lsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:383,
>                  from CHMfactor.h:4,
>                  from CHMfactor.c:2:
> t_sparseVector.c: In function 'nsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:386,
>                  from CHMfactor.h:4,
>                  from CHMfactor.c:2:
> t_sparseVector.c: In function 'zsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> make[3]: *** [CHMfactor.o] Error 1
> make[3]: Leaving directory
> `/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
> ERROR: compilation failed for package 'Matrix'
> * removing '/home/tbarik/src/R-3.1.1/library/Matrix'
> make[2]: *** [Matrix.ts] Error 1
>
> Any advice on what to do is greatly appreciated.
>
> Thanks,
>
> Titus
>
>
> --
> Titus Barik, PE <titus at barik.net>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Mon Sep  1 23:25:01 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 01 Sep 2014 22:25:01 +0100
Subject: [Rd] Unable to compile R 3.1.3 under GCC 4.1.2 (Red Hat
	4.1.2-51)
In-Reply-To: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
References: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
Message-ID: <5404E42D.5030803@stats.ox.ac.uk>

It seems you are using mpicc as your compiler for the Matrix package, 
and have not selected C99 mode for it.  I don't know how you did that: 
maybe you have CC set in your environment.  To get to that point you 
will have compiled lots of R which uses C99 features.

There is no such thing as R 3.1.3 (in the subject), but this seems to be 
R 3.1.1.


On 01/09/2014 20:58, Titus Barik wrote:
> Hi all,
>
> I'm unable to compile R under an HPC system (which like many HPC systems
> doesn't always have the latest and greatest software). The version of
> GCC is 4.1.2 under CentOS 5.7. Running ./configure gives the following
> output:
>
> R is now configured for x86_64-unknown-linux-gnu
>
>    Source directory:          .
>    Installation directory:    /home/tbarik
>
>    C compiler:                gcc -std=gnu99  -I/home/tbarik/include
>    Fortran 77 compiler:       gfortran  -g -O2
>
>    C++ compiler:              g++  -g -O2
>    C++ 11 compiler:
>    Fortran 90/95 compiler:    gfortran -g -O2
>    Obj-C compiler:
>
>    Interfaces supported:      X11
>    External libraries:        readline
>    Additional capabilities:   NLS
>    Options enabled:           shared BLAS, R profiling
>
>    Recommended packages:      yes
>
> which I think looks good (at least, -std=gnu99 appears to be present).
> However, when I try make, I receive the following dump during
> installation of the Matrix package:
>
> * installing *source* package 'Matrix' ...
> ** package 'Matrix' successfully unpacked and MD5 sums checked
> ** libs
> make[3]: Entering directory
> `/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
> mpicc -I/home/tbarik/src/R-3.1.1/include -DNDEBUG -DNTIMER
> -I./SuiteSparse_config -I/usr/local/incl        ude    -fpic
> -I/home/tbarik/include  -c CHMfactor.c -o CHMfactor.o
> In file included from CHMfactor.h:4,
>                   from CHMfactor.c:2:
> Mutils.h: In function 'inv_permutation':
> Mutils.h:270: error: 'for' loop initial declaration used outside C99
> mode
> In file included from Mutils.h:374,
>                   from CHMfactor.h:4,
>                   from CHMfactor.c:2:
> t_sparseVector.c: In function 'dsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:377,
>                   from CHMfactor.h:4,
>                   from CHMfactor.c:2:
> t_sparseVector.c: In function 'isparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:380,
>                   from CHMfactor.h:4,
>                   from CHMfactor.c:2:
> t_sparseVector.c: In function 'lsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:383,
>                   from CHMfactor.h:4,
>                   from CHMfactor.c:2:
> t_sparseVector.c: In function 'nsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> In file included from Mutils.h:386,
>                   from CHMfactor.h:4,
>                   from CHMfactor.c:2:
> t_sparseVector.c: In function 'zsparseVector_sub':
> t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> C99 mode
> make[3]: *** [CHMfactor.o] Error 1
> make[3]: Leaving directory
> `/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
> ERROR: compilation failed for package 'Matrix'
> * removing '/home/tbarik/src/R-3.1.1/library/Matrix'
> make[2]: *** [Matrix.ts] Error 1
>
> Any advice on what to do is greatly appreciated.
>
> Thanks,
>
> Titus
>
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From titus at barik.net  Tue Sep  2 00:41:00 2014
From: titus at barik.net (Titus Barik)
Date: Mon, 01 Sep 2014 15:41:00 -0700
Subject: [Rd] Unable to compile R 3.1.3 under GCC 4.1.2 (Red Hat
	4.1.2-51)
In-Reply-To: <5404E42D.5030803@stats.ox.ac.uk>
References: <1409601529.2250766.162402417.1F6401BF@webmail.messagingengine.com>
	<5404E42D.5030803@stats.ox.ac.uk>
Message-ID: <1409611260.2287563.162442261.60A1213B@webmail.messagingengine.com>

Hi,

Thanks for the replies. The version is indeed 3.1.1 (sorry about the
typo in the subject line). I was able to make progress and get R to
compile after setting --with-recommended-packages=no, since the Matrix
package was the only blocker.

I went back as far as R 2.15.3, which had the same issue.

Noticing mpicc was a good insight. I'm curious myself how it is that
mpicc is being selected. It only happens for the Matrix package; looking
through the compilation everything else is correctly using gcc -std=c99
as the output of configure suggests.

Probably what I will do is compile those recommended packages separately
as needed and ensure that they get the correct flags to ./configure when
doing so.

Thanks,

Titus

-- 
Titus Barik, PE <titus at barik.net>

On Mon, Sep 1, 2014, at 02:25 PM, Prof Brian Ripley wrote:
> It seems you are using mpicc as your compiler for the Matrix package, 
> and have not selected C99 mode for it.  I don't know how you did that: 
> maybe you have CC set in your environment.  To get to that point you 
> will have compiled lots of R which uses C99 features.
> 
> There is no such thing as R 3.1.3 (in the subject), but this seems to be 
> R 3.1.1.
> 
> 
> On 01/09/2014 20:58, Titus Barik wrote:
> > Hi all,
> >
> > I'm unable to compile R under an HPC system (which like many HPC systems
> > doesn't always have the latest and greatest software). The version of
> > GCC is 4.1.2 under CentOS 5.7. Running ./configure gives the following
> > output:
> >
> > R is now configured for x86_64-unknown-linux-gnu
> >
> >    Source directory:          .
> >    Installation directory:    /home/tbarik
> >
> >    C compiler:                gcc -std=gnu99  -I/home/tbarik/include
> >    Fortran 77 compiler:       gfortran  -g -O2
> >
> >    C++ compiler:              g++  -g -O2
> >    C++ 11 compiler:
> >    Fortran 90/95 compiler:    gfortran -g -O2
> >    Obj-C compiler:
> >
> >    Interfaces supported:      X11
> >    External libraries:        readline
> >    Additional capabilities:   NLS
> >    Options enabled:           shared BLAS, R profiling
> >
> >    Recommended packages:      yes
> >
> > which I think looks good (at least, -std=gnu99 appears to be present).
> > However, when I try make, I receive the following dump during
> > installation of the Matrix package:
> >
> > * installing *source* package 'Matrix' ...
> > ** package 'Matrix' successfully unpacked and MD5 sums checked
> > ** libs
> > make[3]: Entering directory
> > `/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
> > mpicc -I/home/tbarik/src/R-3.1.1/include -DNDEBUG -DNTIMER
> > -I./SuiteSparse_config -I/usr/local/incl        ude    -fpic
> > -I/home/tbarik/include  -c CHMfactor.c -o CHMfactor.o
> > In file included from CHMfactor.h:4,
> >                   from CHMfactor.c:2:
> > Mutils.h: In function 'inv_permutation':
> > Mutils.h:270: error: 'for' loop initial declaration used outside C99
> > mode
> > In file included from Mutils.h:374,
> >                   from CHMfactor.h:4,
> >                   from CHMfactor.c:2:
> > t_sparseVector.c: In function 'dsparseVector_sub':
> > t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> > C99 mode
> > In file included from Mutils.h:377,
> >                   from CHMfactor.h:4,
> >                   from CHMfactor.c:2:
> > t_sparseVector.c: In function 'isparseVector_sub':
> > t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> > C99 mode
> > In file included from Mutils.h:380,
> >                   from CHMfactor.h:4,
> >                   from CHMfactor.c:2:
> > t_sparseVector.c: In function 'lsparseVector_sub':
> > t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> > C99 mode
> > In file included from Mutils.h:383,
> >                   from CHMfactor.h:4,
> >                   from CHMfactor.c:2:
> > t_sparseVector.c: In function 'nsparseVector_sub':
> > t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> > C99 mode
> > In file included from Mutils.h:386,
> >                   from CHMfactor.h:4,
> >                   from CHMfactor.c:2:
> > t_sparseVector.c: In function 'zsparseVector_sub':
> > t_sparseVector.c:139: error: 'for' loop initial declaration used outside
> > C99 mode
> > make[3]: *** [CHMfactor.o] Error 1
> > make[3]: Leaving directory
> > `/state/partition1/tmp/RtmpCw7v7G/R.INSTALL3227fa892a3/Matrix/src'
> > ERROR: compilation failed for package 'Matrix'
> > * removing '/home/tbarik/src/R-3.1.1/library/Matrix'
> > make[2]: *** [Matrix.ts] Error 1
> >
> > Any advice on what to do is greatly appreciated.
> >
> > Thanks,
> >
> > Titus
> >
> >
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford
> 1 South Parks Road, Oxford OX1 3TG, UK
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From bbolker at gmail.com  Tue Sep  2 03:27:12 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Sep 2014 21:27:12 -0400
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
Message-ID: <CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>

Further losing my marbles.  I *think* this is a subtle bug in the
comparison operator for package_version objects that will be dependent on
small (platform-dependent) numerical computation differences, possibly
(???) introduced in r66259.

If I have not completely lost it (which is entirely possible), the problem
stems from the fact that floor(log(8,base=8L)) is 0 rather than 1 on my
machine, since log(8,base=8L) is slightly less than 1 rather than equal to
1.  All of the following possibly entertaining code comes from excavating
the guts of src/library/base/R/version.R : this file was changed on July 27
<
https://github.com/wch/r-source/commit/ce6732242c0757e07ebc4a5efb7d210cba6a0cfa>
, which makes me suspicious, but I don't see directly how the modifications
would have broken this.

## basic sanity-test of package version comparison
as.package_version("1.0.0")>=as.package_version("0.9.9")  ## TRUE

## the specific comparison I'm trying to make:
(e1 <- as.package_version("1.8.1"))>=(e2 <- as.package_version("1.7.1"))
## FALSE (!!!)
unclass(e1)  ## 1 8 1
unclass(e2)  ## 1 7 1

## part of the internal function operation .encode_numeric_version
intwid <- log(max(unlist(e1), unlist(e2), 1L, na.rm = TRUE), base = 8L)
## (why base 8? Tom Lehrer: "base eight is just like base ten really if
you're missing two fingers")
## I can see that we're sprintf()ing the results in octal a few lines later
...)
## 1  -- looks OK, but:

intwid-1 ## [1] -1.110223e-16
width <- floor(intwid) + 1L  ## this is the calculation that actually gets
done:
##
## 1 ## should be 2

log(8, base=8L)-1
log(8, base=8)-1
logvals <- setNames(log(2:25,base=2:25)-1,2:25)
logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2


w1 <- .encode_numeric_version(e1, width = width, maxlen = maxlen) ## "1101"
w2 <- .encode_numeric_version(e2, width = width, maxlen = maxlen) ## "171"
w1>w2  ## FALSE

w1A <- .encode_numeric_version(e1, width = 2, maxlen = maxlen) ## "011001"
w2A <- .encode_numeric_version(e2, width = 2, maxlen = maxlen) ## "010701"
w1A>w2A  ## TRUE


If I had the patience I would revert to before this SVN change and see what
happened:

=================
r66259 | hornik | 2014-07-27 15:45:29 -0400 (Sun, 27 Jul 2014) | 2 lines

Have .encode_numeric_version() pad to common length with trailing zeros.
Add [<-.numeric_version().




On Mon, Sep 1, 2014 at 4:16 PM, Ben Bolker <bbolker at gmail.com> wrote:

> thanks -- although I think `dplyr` is a red herring; my issue is with
> `plyr` (which is imported by `ggplot2` so should get installed
> automatically anyway ...)
>
>
> On Mon, Sep 1, 2014 at 4:08 PM, Carl Boettiger <cboettig at gmail.com> wrote:
>
>> Hi Ben,
>>
>> Just tested this on a fresh ubuntu 14:04 sandbox by using Dirk's docker
>> image (
>> https://github.com/eddelbuettel/docker-ubuntu-r/tree/master/add-r-devel-san)
>> for Rdevel.
>>
>> > install.packages(c("dplyr", "ggplot2"))
>> > library("dplyr")
>> > library("ggplot2")
>>
>> runs fine for me (though takes a few minutes to compile everything). So
>> it seems you must have done something to your local environment, but not
>> sure what.
>>
>>
>>
>>
>> On Mon, Sep 1, 2014 at 11:42 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>
>>>   I apologize in advance for not having done more homework in advance,
>>> but thought I would send this along to see if anyone else was seeing
>>> this.
>>>
>>>   I am having some sort of ggplot2/plyr/very-recent-R-devel dependency
>>> issues.
>>>
>>>   Just installed
>>>
>>> R Under development (unstable) (2014-09-01 r66509) -- "Unsuffered
>>> Consequences"
>>>
>>>  from source.
>>>
>>> > packageVersion("ggplot2")
>>> [1] ?1.0.0?
>>> > packageVersion("plyr")
>>> [1] ?1.8.1?
>>>
>>> library(plyr) works
>>>
>>>   but then I get:
>>>
>>> library(ggplot2)
>>> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck =
>>> vI[[i]]) :
>>>   namespace ?plyr? 1.8.1 is being loaded, but >= 1.7.1 is required
>>> Error: package or namespace load failed for ?ggplot2?
>>>
>>>   I don't remember when I most recently updated my r-devel (it was
>>> probably a few months old); nothing in recent commits rings a bell.
>>>
>>>   Works fine on R version 3.1.1 (except for a "ggplot2 built under
>>> 3.2.0 warning").
>>>
>>>   Does anyone else see this or is it just something weird about my setup?
>>>
>>>   Ben Bolker
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>> --
>> Carl Boettiger
>> UC Santa Cruz
>> http://carlboettiger.info/
>>
>
>

	[[alternative HTML version deleted]]


From bbolker at gmail.com  Tue Sep  2 03:38:05 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Sep 2014 21:38:05 -0400
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
Message-ID: <CABghstSPevfEjBmBZTeSuCRcu2eX4ZMO+NdegQTGWFAhUyrd2w@mail.gmail.com>

PS this is on i686-pc-linux-gnu (32-bit).  On x86_64-apple-darwin10.8.0,
log(8,base=8)==1 is TRUE, so I'm guessing the problem wouldn't come up.

(At this point I believe the problem occurs if (and only?) if
log(8,base==8)==1 is FALSE, *and* you try to make a comparison that
involves a package version with an 8 in it ...)



On Mon, Sep 1, 2014 at 9:27 PM, Ben Bolker <bbolker at gmail.com> wrote:

> Further losing my marbles.  I *think* this is a subtle bug in the
> comparison operator for package_version objects that will be dependent on
> small (platform-dependent) numerical computation differences, possibly
> (???) introduced in r66259.
>
> If I have not completely lost it (which is entirely possible), the problem
> stems from the fact that floor(log(8,base=8L)) is 0 rather than 1 on my
> machine, since log(8,base=8L) is slightly less than 1 rather than equal to
> 1.  All of the following possibly entertaining code comes from excavating
> the guts of src/library/base/R/version.R : this file was changed on July 27
> <
> https://github.com/wch/r-source/commit/ce6732242c0757e07ebc4a5efb7d210cba6a0cfa>
> , which makes me suspicious, but I don't see directly how the modifications
> would have broken this.
>
> ## basic sanity-test of package version comparison
> as.package_version("1.0.0")>=as.package_version("0.9.9")  ## TRUE
>
> ## the specific comparison I'm trying to make:
> (e1 <- as.package_version("1.8.1"))>=(e2 <- as.package_version("1.7.1"))
> ## FALSE (!!!)
> unclass(e1)  ## 1 8 1
> unclass(e2)  ## 1 7 1
>
> ## part of the internal function operation .encode_numeric_version
> intwid <- log(max(unlist(e1), unlist(e2), 1L, na.rm = TRUE), base = 8L)
> ## (why base 8? Tom Lehrer: "base eight is just like base ten really if
> you're missing two fingers")
> ## I can see that we're sprintf()ing the results in octal a few lines
> later ...)
> ## 1  -- looks OK, but:
>
> intwid-1 ## [1] -1.110223e-16
> width <- floor(intwid) + 1L  ## this is the calculation that actually gets
> done:
> ##
> ## 1 ## should be 2
>
> log(8, base=8L)-1
> log(8, base=8)-1
> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
>
>
> w1 <- .encode_numeric_version(e1, width = width, maxlen = maxlen) ## "1101"
> w2 <- .encode_numeric_version(e2, width = width, maxlen = maxlen) ## "171"
> w1>w2  ## FALSE
>
> w1A <- .encode_numeric_version(e1, width = 2, maxlen = maxlen) ## "011001"
> w2A <- .encode_numeric_version(e2, width = 2, maxlen = maxlen) ## "010701"
> w1A>w2A  ## TRUE
>
>
> If I had the patience I would revert to before this SVN change and see
> what happened:
>
> =================
> r66259 | hornik | 2014-07-27 15:45:29 -0400 (Sun, 27 Jul 2014) | 2 lines
>
> Have .encode_numeric_version() pad to common length with trailing zeros.
> Add [<-.numeric_version().
>
>
>
>
> On Mon, Sep 1, 2014 at 4:16 PM, Ben Bolker <bbolker at gmail.com> wrote:
>
>> thanks -- although I think `dplyr` is a red herring; my issue is with
>> `plyr` (which is imported by `ggplot2` so should get installed
>> automatically anyway ...)
>>
>>
>> On Mon, Sep 1, 2014 at 4:08 PM, Carl Boettiger <cboettig at gmail.com>
>> wrote:
>>
>>> Hi Ben,
>>>
>>> Just tested this on a fresh ubuntu 14:04 sandbox by using Dirk's docker
>>> image (
>>> https://github.com/eddelbuettel/docker-ubuntu-r/tree/master/add-r-devel-san)
>>> for Rdevel.
>>>
>>> > install.packages(c("dplyr", "ggplot2"))
>>> > library("dplyr")
>>> > library("ggplot2")
>>>
>>> runs fine for me (though takes a few minutes to compile everything). So
>>> it seems you must have done something to your local environment, but not
>>> sure what.
>>>
>>>
>>>
>>>
>>> On Mon, Sep 1, 2014 at 11:42 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>>
>>>>
>>>>   I apologize in advance for not having done more homework in advance,
>>>> but thought I would send this along to see if anyone else was seeing
>>>> this.
>>>>
>>>>   I am having some sort of ggplot2/plyr/very-recent-R-devel dependency
>>>> issues.
>>>>
>>>>   Just installed
>>>>
>>>> R Under development (unstable) (2014-09-01 r66509) -- "Unsuffered
>>>> Consequences"
>>>>
>>>>  from source.
>>>>
>>>> > packageVersion("ggplot2")
>>>> [1] ?1.0.0?
>>>> > packageVersion("plyr")
>>>> [1] ?1.8.1?
>>>>
>>>> library(plyr) works
>>>>
>>>>   but then I get:
>>>>
>>>> library(ggplot2)
>>>> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck =
>>>> vI[[i]]) :
>>>>   namespace ?plyr? 1.8.1 is being loaded, but >= 1.7.1 is required
>>>> Error: package or namespace load failed for ?ggplot2?
>>>>
>>>>   I don't remember when I most recently updated my r-devel (it was
>>>> probably a few months old); nothing in recent commits rings a bell.
>>>>
>>>>   Works fine on R version 3.1.1 (except for a "ggplot2 built under
>>>> 3.2.0 warning").
>>>>
>>>>   Does anyone else see this or is it just something weird about my
>>>> setup?
>>>>
>>>>   Ben Bolker
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>>
>>>
>>> --
>>> Carl Boettiger
>>> UC Santa Cruz
>>> http://carlboettiger.info/
>>>
>>
>>
>

	[[alternative HTML version deleted]]


From bbolker at gmail.com  Tue Sep  2 05:01:51 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Sep 2014 23:01:51 -0400
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <CABghstSPevfEjBmBZTeSuCRcu2eX4ZMO+NdegQTGWFAhUyrd2w@mail.gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
	<CABghstSPevfEjBmBZTeSuCRcu2eX4ZMO+NdegQTGWFAhUyrd2w@mail.gmail.com>
Message-ID: <CABghstS+U_H-J8+upEZyg5Joz7xJqHaLd1wwFR1mR1HY5e9u_w@mail.gmail.com>

One more correction: the relevant change seems to be

https://github.com/wch/r-source/commit/7681eefd37e7fa4da877b267c006df839303680c
or

or

r66230 | hornik | 2014-07-22 17:14:31 -0400 (Tue, 22 Jul 2014) | 2 lines

Have .encode_numeric_version() use strings of octals rather than double
precision p-adic rationals.



On Mon, Sep 1, 2014 at 9:38 PM, Ben Bolker <bbolker at gmail.com> wrote:

> PS this is on i686-pc-linux-gnu (32-bit).  On x86_64-apple-darwin10.8.0,
> log(8,base=8)==1 is TRUE, so I'm guessing the problem wouldn't come up.
>
> (At this point I believe the problem occurs if (and only?) if
> log(8,base==8)==1 is FALSE, *and* you try to make a comparison that
> involves a package version with an 8 in it ...)
>
>
>
> On Mon, Sep 1, 2014 at 9:27 PM, Ben Bolker <bbolker at gmail.com> wrote:
>
>> Further losing my marbles.  I *think* this is a subtle bug in the
>> comparison operator for package_version objects that will be dependent on
>> small (platform-dependent) numerical computation differences, possibly
>> (???) introduced in r66259.
>>
>> If I have not completely lost it (which is entirely possible), the
>> problem stems from the fact that floor(log(8,base=8L)) is 0 rather than 1
>> on my machine, since log(8,base=8L) is slightly less than 1 rather than
>> equal to 1.  All of the following possibly entertaining code comes from
>> excavating the guts of src/library/base/R/version.R : this file was changed
>> on July 27 <
>> https://github.com/wch/r-source/commit/ce6732242c0757e07ebc4a5efb7d210cba6a0cfa>
>> , which makes me suspicious, but I don't see directly how the modifications
>> would have broken this.
>>
>> ## basic sanity-test of package version comparison
>> as.package_version("1.0.0")>=as.package_version("0.9.9")  ## TRUE
>>
>> ## the specific comparison I'm trying to make:
>> (e1 <- as.package_version("1.8.1"))>=(e2 <- as.package_version("1.7.1"))
>> ## FALSE (!!!)
>> unclass(e1)  ## 1 8 1
>> unclass(e2)  ## 1 7 1
>>
>> ## part of the internal function operation .encode_numeric_version
>> intwid <- log(max(unlist(e1), unlist(e2), 1L, na.rm = TRUE), base = 8L)
>> ## (why base 8? Tom Lehrer: "base eight is just like base ten really if
>> you're missing two fingers")
>> ## I can see that we're sprintf()ing the results in octal a few lines
>> later ...)
>> ## 1  -- looks OK, but:
>>
>> intwid-1 ## [1] -1.110223e-16
>> width <- floor(intwid) + 1L  ## this is the calculation that actually
>> gets done:
>> ##
>> ## 1 ## should be 2
>>
>> log(8, base=8L)-1
>> log(8, base=8)-1
>> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
>> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
>>
>>
>> w1 <- .encode_numeric_version(e1, width = width, maxlen = maxlen) ##
>> "1101"
>> w2 <- .encode_numeric_version(e2, width = width, maxlen = maxlen) ## "171"
>> w1>w2  ## FALSE
>>
>> w1A <- .encode_numeric_version(e1, width = 2, maxlen = maxlen) ## "011001"
>> w2A <- .encode_numeric_version(e2, width = 2, maxlen = maxlen) ## "010701"
>> w1A>w2A  ## TRUE
>>
>>
>> If I had the patience I would revert to before this SVN change and see
>> what happened:
>>
>> =================
>> r66259 | hornik | 2014-07-27 15:45:29 -0400 (Sun, 27 Jul 2014) | 2 lines
>>
>> Have .encode_numeric_version() pad to common length with trailing zeros.
>> Add [<-.numeric_version().
>>
>>
>>
>>
>> On Mon, Sep 1, 2014 at 4:16 PM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>> thanks -- although I think `dplyr` is a red herring; my issue is with
>>> `plyr` (which is imported by `ggplot2` so should get installed
>>> automatically anyway ...)
>>>
>>>
>>> On Mon, Sep 1, 2014 at 4:08 PM, Carl Boettiger <cboettig at gmail.com>
>>> wrote:
>>>
>>>> Hi Ben,
>>>>
>>>> Just tested this on a fresh ubuntu 14:04 sandbox by using Dirk's docker
>>>> image (
>>>> https://github.com/eddelbuettel/docker-ubuntu-r/tree/master/add-r-devel-san)
>>>> for Rdevel.
>>>>
>>>> > install.packages(c("dplyr", "ggplot2"))
>>>> > library("dplyr")
>>>> > library("ggplot2")
>>>>
>>>> runs fine for me (though takes a few minutes to compile everything). So
>>>> it seems you must have done something to your local environment, but not
>>>> sure what.
>>>>
>>>>
>>>>
>>>>
>>>> On Mon, Sep 1, 2014 at 11:42 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>>>
>>>>>
>>>>>   I apologize in advance for not having done more homework in advance,
>>>>> but thought I would send this along to see if anyone else was seeing
>>>>> this.
>>>>>
>>>>>   I am having some sort of ggplot2/plyr/very-recent-R-devel dependency
>>>>> issues.
>>>>>
>>>>>   Just installed
>>>>>
>>>>> R Under development (unstable) (2014-09-01 r66509) -- "Unsuffered
>>>>> Consequences"
>>>>>
>>>>>  from source.
>>>>>
>>>>> > packageVersion("ggplot2")
>>>>> [1] ?1.0.0?
>>>>> > packageVersion("plyr")
>>>>> [1] ?1.8.1?
>>>>>
>>>>> library(plyr) works
>>>>>
>>>>>   but then I get:
>>>>>
>>>>> library(ggplot2)
>>>>> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck =
>>>>> vI[[i]]) :
>>>>>   namespace ?plyr? 1.8.1 is being loaded, but >= 1.7.1 is required
>>>>> Error: package or namespace load failed for ?ggplot2?
>>>>>
>>>>>   I don't remember when I most recently updated my r-devel (it was
>>>>> probably a few months old); nothing in recent commits rings a bell.
>>>>>
>>>>>   Works fine on R version 3.1.1 (except for a "ggplot2 built under
>>>>> 3.2.0 warning").
>>>>>
>>>>>   Does anyone else see this or is it just something weird about my
>>>>> setup?
>>>>>
>>>>>   Ben Bolker
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Carl Boettiger
>>>> UC Santa Cruz
>>>> http://carlboettiger.info/
>>>>
>>>
>>>
>>
>

	[[alternative HTML version deleted]]


From thomas.petzoldt at tu-dresden.de  Tue Sep  2 09:57:33 2014
From: thomas.petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Tue, 02 Sep 2014 09:57:33 +0200
Subject: [Rd] unexpected behavior of <<- in nlm (lazy?)
In-Reply-To: <639722d585d84c4cae70c22574d15188@livia.nioz.nl>
References: <93c690838fdc4504a9e1a9dbc7fb054f@livia.nioz.nl>
	<54045BD9.20101@tu-dresden.de>
	<bec9aabc3bc841ad85877275ac2eaead@livia.nioz.nl>
	<54049F5E.60309@tu-dresden.de>
	<7c5958b7f5de4b8680a3f796bf42f724@livia.nioz.nl>
	<5404A3BB.3000107@tu-dresden.de>
	<639722d585d84c4cae70c22574d15188@livia.nioz.nl>
Message-ID: <5405786D.4020801@tu-dresden.de>

Hi,

while working with closures in deSolve we have found unexpected behavior
in R 3.1.0 and R 3.1.1 and R devel, while it was still as expected in R
3.0.3. This behavior occurs also in several functions of other packages
like nls.lm from minpack.lm and even nlm in base, while some other
functions worked as expected.  See example below.

The symptom is that super assignments (<<-) of unmodified variables lead
to "references" instead of copies.

Thomas Petzoldt and Karline Soetaert



## ----------------------------------------------------------
## Unexpected behavior:

# R version 3.1.0 (2014-04-10) -- "Spring Dance"
# Platform: x86_64-redhat-linux-gnu (64-bit)
#
## AND
#
# R version 3.1.1 (2014-07-10) -- "Sock it to Me"
# Platform: x86_64-w64-mingw32/x64 (64-bit)
#
## AND
#
# R Under development (unstable) (2014-08-31 r66504) --
# "Unsuffered Consequences"
# Platform: i386-w64-mingw32/i386 (32-bit)


f <- function(x, a) {
     cat(x[1], x.old[1], x.old1[1], x.old1 == x.old, "\n")
     x.old   <<- x          # 'reference'
     x.old1  <<- x * 1      # copy
     res <- sum((x-a)^2)
     attr(res, "gradient") <- 2*(x-a)
     res
}

x.old <- x.old1 <- 0
A <- nlm(f, c(10,10), a = c(3,5))

10 0 0 TRUE
10 10 10 TRUE TRUE
10.00001 10.00001 10 FALSE TRUE
10 10 10.00001 FALSE FALSE
-4 -4 10 FALSE FALSE
3 3 -4 FALSE FALSE


## ----------------------------------------------------------
## Expected behavior:
# R version 3.0.3 (2014-03-06) -- "Warm Puppy"
# Platform: x86_64-w64-mingw32/x64 (64-bit)


f <- function(x, a) {
     cat(x[1], x.old[1], x.old1[1], x.old1 == x.old, "\n")
     x.old   <<- x          # 'reference'
     x.old1  <<- x * 1      # copy
     res <- sum((x-a)^2)
     attr(res, "gradient") <- 2*(x-a)
     res
}

x.old <- x.old1 <- 0
A <- nlm(f, c(10,10), a = c(3,5))

10 0 0 TRUE
10 10 10 TRUE TRUE
10.00001 10 10 TRUE TRUE
10 10.00001 10.00001 TRUE TRUE
-4 10 10 TRUE TRUE
3 -4 -4 TRUE TRUE


From pdalgd at gmail.com  Tue Sep  2 13:43:21 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 2 Sep 2014 13:43:21 +0200
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
Message-ID: <D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>

Impressive. Never ceases to amaze me what computers can do these days. ;-)

It's even more impressive given that we have

static double logbase(double x, double base)
{
#ifdef HAVE_LOG10
    if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
#endif
#ifdef HAVE_LOG2
    if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
#endif
    return R_log(x) / R_log(base);
}

which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....


-pd  


On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:

> log(8, base=8L)-1
> log(8, base=8)-1
> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ripley at stats.ox.ac.uk  Tue Sep  2 14:21:30 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 2 Sep 2014 13:21:30 +0100
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
Message-ID: <5405B64A.3010408@stats.ox.ac.uk>

On 02/09/2014 12:43, peter dalgaard wrote:
> Impressive. Never ceases to amaze me what computers can do these days. ;-)
>
> It's even more impressive given that we have
>
> static double logbase(double x, double base)
> {
> #ifdef HAVE_LOG10
>      if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
> #endif
> #ifdef HAVE_LOG2
>      if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
> #endif
>      return R_log(x) / R_log(base);
> }
>
> which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....

I suspect PD knows (or has known) why, but for the sake of those who are 
not much bitten by ix86 compilers ....

It's the curse of extended-precision arithmetic (and not enough 
registers).  It does

compute in an FPU register, then store z1 = R_log(x)
compute z2 = R_log(base) in the FPU
load z1 to an FPU register.
compute z1/z2

(at least at -O2 with the version of gcc whose assembler output I looked 
at).  So z1 is has a 64-bit mantissa and z2 a 53-bit one.

x86_64 has more registers, and so avoids the store.  This can be 
circumvented on i686 by compiling with -msse2, which for some reason 
Linux distros do not make the default.

floor(log2(x)/3) is more reliable (and this is the underlying reason why 
we have log10 and log2).

>
> -pd
>
>
> On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:
>
>> log(8, base=8L)-1
>> log(8, base=8)-1
>> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
>> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From maechler at stat.math.ethz.ch  Tue Sep  2 14:48:55 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 2 Sep 2014 14:48:55 +0200
Subject: [Rd] log(i, base=i) not giving 1
In-Reply-To: <D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
Message-ID: <21509.48311.450620.998931@stat.math.ethz.ch>

>>>>> peter dalgaard <pdalgd at gmail.com>
>>>>>     on Tue, 2 Sep 2014 13:43:21 +0200 writes:

    > Impressive. Never ceases to amaze me what computers can do these days. ;-)

Indeed,

    > It's even more impressive given that we have


    > static double logbase(double x, double base)
    > {
    > #ifdef HAVE_LOG10
    > if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
    > #endif
    > #ifdef HAVE_LOG2
    > if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
    > #endif
    > return R_log(x) / R_log(base);
    > }

    > which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....

Amazingly indeed, it does:  From the few platforms I can try
here, I only see the problem 
on 32 bit Linux, both an (old) ubuntu 12.04.5 and Fedora 19.

> i <- 2:99; i[log(i, base=i) != 1]
[1]  5  8 14 18 19 25 58 60 64 65 66 67 75 80 84 86 91

so '8' is not so special (as Ben suggested) and also not the
only power of two for which this happens :

> i <- 2^(1:20); i[log(i, base=i) != 1]
[1] 8    64   128  4096  8192 16384

Interestingly, it does not happen on 32-bit Windows, nor on any
64-bit version of R I've tried.
Yes, it is amazing that with computer arithmetic, we can't
even guarantee that   U / U = 1  exactly.

Is it basically free to check for x == base in there, so we
could change to

 return (x == base) ? 1. : R_log(x) / R_log(base);

?



    > On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:

    >> log(8, base=8L)-1
    >> log(8, base=8)-1
    >> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
    >> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2

    > -- 
    > Peter Dalgaard, Professor,
    > Center for Statistics, Copenhagen Business School
    > Solbjerg Plads 3, 2000 Frederiksberg, Denmark
    > Phone: (+45)38153501
    > Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From pdalgd at gmail.com  Tue Sep  2 15:11:30 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 2 Sep 2014 15:11:30 +0200
Subject: [Rd] ggplot2/plyr interaction with latest R-devel?
In-Reply-To: <5405B64A.3010408@stats.ox.ac.uk>
References: <5404BE1D.2020609@mcmaster.ca>	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
	<5405B64A.3010408@stats.ox.ac.uk>
Message-ID: <9FD66BDC-8A39-4835-AD35-7D4D648B2AAF@gmail.com>


On 02 Sep 2014, at 14:21 , Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:

> I suspect PD knows (or has known) why, but for the sake of those who are not much bitten by ix86 compilers ....
> 
> It's the curse of extended-precision arithmetic (and not enough registers).  It does
....

Let's say that he suspected something of the sort.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From bbolker at gmail.com  Tue Sep  2 23:43:17 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 2 Sep 2014 17:43:17 -0400
Subject: [Rd] log(i, base=i) not giving 1
In-Reply-To: <21509.48311.450620.998931@stat.math.ethz.ch>
References: <5404BE1D.2020609@mcmaster.ca>	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
	<21509.48311.450620.998931@stat.math.ethz.ch>
Message-ID: <540639F5.2080002@gmail.com>

On 14-09-02 08:48 AM, Martin Maechler wrote:
>>>>>> peter dalgaard <pdalgd at gmail.com>
>>>>>>     on Tue, 2 Sep 2014 13:43:21 +0200 writes:
> 
>     > Impressive. Never ceases to amaze me what computers can do these days. ;-)
> 
> Indeed,
> 
>     > It's even more impressive given that we have
> 
> 
>     > static double logbase(double x, double base)
>     > {
>     > #ifdef HAVE_LOG10
>     > if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
>     > #endif
>     > #ifdef HAVE_LOG2
>     > if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
>     > #endif
>     > return R_log(x) / R_log(base);
>     > }
> 
>     > which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....
> 
> Amazingly indeed, it does:  From the few platforms I can try
> here, I only see the problem 
> on 32 bit Linux, both an (old) ubuntu 12.04.5 and Fedora 19.
> 
>> i <- 2:99; i[log(i, base=i) != 1]
> [1]  5  8 14 18 19 25 58 60 64 65 66 67 75 80 84 86 91
> 
> so '8' is not so special (as Ben suggested) and also not the
> only power of two for which this happens :
> 
>> i <- 2^(1:20); i[log(i, base=i) != 1]
> [1] 8    64   128  4096  8192 16384
> 
> Interestingly, it does not happen on 32-bit Windows, nor on any
> 64-bit version of R I've tried.
> Yes, it is amazing that with computer arithmetic, we can't
> even guarantee that   U / U = 1  exactly.
> 
> Is it basically free to check for x == base in there, so we
> could change to
> 
>  return (x == base) ? 1. : R_log(x) / R_log(base);
> 
> ?

  Should I submit a formal bug report about this, or should I assume it
has now been sufficiently noted by R-core?

  Opinions about whether it is better to fix in logbase (according to
Martin's suggestion) or in version.R (e.g. BDR's suggestion of using
log2(x)/3 or some other way that makes the function less sensitive) or both?

  Ben Bolker


> 
> 
> 
>     > On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:
> 
>     >> log(8, base=8L)-1
>     >> log(8, base=8)-1
>     >> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
>     >> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
> 
>     > -- 
>     > Peter Dalgaard, Professor,
>     > Center for Statistics, Copenhagen Business School
>     > Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>     > Phone: (+45)38153501
>     > Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> 
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel
>


From praguewatermelon at gmail.com  Wed Sep  3 07:35:30 2014
From: praguewatermelon at gmail.com (Xiao He)
Date: Wed, 3 Sep 2014 06:35:30 +0100
Subject: [Rd] Library not loaded: /usr/local/lib/libquadmath.0.dylib
Message-ID: <CAGBzz=J6-LM7S=2L_doEL-OXgbHj_997yFFukMtNYoxKMwrxYw@mail.gmail.com>

Hi all,

I tried to load a package which includes a shared object on one of my Macs,
and I got an error message below, which suggests that the file "
libquadmath.0.dylib" is missing in the /usr/local/lib folder. On my other
Mac however, I have no problem loading the package, and the file "
libquadmath.0.dylib" is in the /usr/local/lib folder. I wonder where this
libquadmath.0.dylib file is from, and how I can install it on the computer
where it is missing. Thanks!

library(WRScpp)
Error in dyn.load(file, DLLpath = DLLpath, ...) :
  unable to load shared object
'/Library/Frameworks/R.framework/Versions/3.1/Resources/library/WRScpp/libs/WRScpp.so':

dlopen(/Library/Frameworks/R.framework/Versions/3.1/Resources/library/WRScpp/libs/WRScpp.so,
6): Library not loaded: /usr/local/lib/libquadmath.0.dylib
  Referenced from:
/Library/Frameworks/R.framework/Versions/3.1/Resources/library/WRScpp/libs/WRScpp.so
  Reason: image not found
Error: package or namespace load failed for ?WRScpp??

	[[alternative HTML version deleted]]


From ripley at stats.ox.ac.uk  Wed Sep  3 07:46:47 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 03 Sep 2014 06:46:47 +0100
Subject: [Rd] log(i, base=i) not giving 1
In-Reply-To: <540639F5.2080002@gmail.com>
References: <5404BE1D.2020609@mcmaster.ca>	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>	<21509.48311.450620.998931@stat.math.ethz.ch>
	<540639F5.2080002@gmail.com>
Message-ID: <5406AB47.3030200@stats.ox.ac.uk>

On 02/09/2014 22:43, Ben Bolker wrote:
> On 14-09-02 08:48 AM, Martin Maechler wrote:
>>>>>>> peter dalgaard <pdalgd at gmail.com>
>>>>>>>      on Tue, 2 Sep 2014 13:43:21 +0200 writes:
>>
>>      > Impressive. Never ceases to amaze me what computers can do these days. ;-)
>>
>> Indeed,
>>
>>      > It's even more impressive given that we have
>>
>>
>>      > static double logbase(double x, double base)
>>      > {
>>      > #ifdef HAVE_LOG10
>>      > if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
>>      > #endif
>>      > #ifdef HAVE_LOG2
>>      > if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
>>      > #endif
>>      > return R_log(x) / R_log(base);
>>      > }
>>
>>      > which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....
>>
>> Amazingly indeed, it does:  From the few platforms I can try
>> here, I only see the problem
>> on 32 bit Linux, both an (old) ubuntu 12.04.5 and Fedora 19.
>>
>>> i <- 2:99; i[log(i, base=i) != 1]
>> [1]  5  8 14 18 19 25 58 60 64 65 66 67 75 80 84 86 91
>>
>> so '8' is not so special (as Ben suggested) and also not the
>> only power of two for which this happens :
>>
>>> i <- 2^(1:20); i[log(i, base=i) != 1]
>> [1] 8    64   128  4096  8192 16384
>>
>> Interestingly, it does not happen on 32-bit Windows, nor on any
>> 64-bit version of R I've tried.
>> Yes, it is amazing that with computer arithmetic, we can't
>> even guarantee that   U / U = 1  exactly.
>>
>> Is it basically free to check for x == base in there, so we
>> could change to
>>
>>   return (x == base) ? 1. : R_log(x) / R_log(base);
>>
>> ?
>
>    Should I submit a formal bug report about this, or should I assume it
> has now been sufficiently noted by R-core?

It is under consideration by the author (not me).

>    Opinions about whether it is better to fix in logbase (according to
> Martin's suggestion) or in version.R (e.g. BDR's suggestion of using
> log2(x)/3 or some other way that makes the function less sensitive) or both?

Yet again, it is better to write code which does not make false 
assumptions about machine arithmetic.  Fixing one very rare case at the 
expense of speed for all others is not a good idea.

Studying http://www.validlab.com/goldberg/addendum.html is a good idea 
for those unfamiliar with the pitfalls of i86 FPUs.  It has an example 
essentially the same as this one right at the top.

Also, Ben Bolker needs to change his compiler options to ones better 
than the defaults in his unstated Linux distro.   Why anyone is using 
ix86 Linux nowadays is hard to understand when x86_64 is (on all but the 
very smallest machines) faster and more reliable.

>
>    Ben Bolker
>
>
>>
>>
>>
>>      > On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:
>>
>>      >> log(8, base=8L)-1
>>      >> log(8, base=8)-1
>>      >> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
>>      >> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
>>
>>      > --
>>      > Peter Dalgaard, Professor,
>>      > Center for Statistics, Copenhagen Business School
>>      > Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>>      > Phone: (+45)38153501
>>      > Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>>
>>      > ______________________________________________
>>      > R-devel at r-project.org mailing list
>>      > https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From ripley at stats.ox.ac.uk  Wed Sep  3 07:49:21 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 03 Sep 2014 06:49:21 +0100
Subject: [Rd] Library not loaded: /usr/local/lib/libquadmath.0.dylib
In-Reply-To: <CAGBzz=J6-LM7S=2L_doEL-OXgbHj_997yFFukMtNYoxKMwrxYw@mail.gmail.com>
References: <CAGBzz=J6-LM7S=2L_doEL-OXgbHj_997yFFukMtNYoxKMwrxYw@mail.gmail.com>
Message-ID: <5406ABE1.5090509@stats.ox.ac.uk>

Wrong list: Mac-specific question to R-sig-mac please.

On 03/09/2014 06:35, Xiao He wrote:
> Hi all,
>
> I tried to load a package which includes a shared object on one of my Macs,
> and I got an error message below, which suggests that the file "
> libquadmath.0.dylib" is missing in the /usr/local/lib folder. On my other
> Mac however, I have no problem loading the package, and the file "
> libquadmath.0.dylib" is in the /usr/local/lib folder. I wonder where this
> libquadmath.0.dylib file is from, and how I can install it on the computer
> where it is missing. Thanks!

It is part of gfortran.  See the R-admin manual for where to install 
that from on OS X (I am guessing 10.9, but you really do need to follow 
the posting guide and tell us -- and not send HTML).

>
> library(WRScpp)
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>    unable to load shared object
> '/Library/Frameworks/R.framework/Versions/3.1/Resources/library/WRScpp/libs/WRScpp.so':
>
> dlopen(/Library/Frameworks/R.framework/Versions/3.1/Resources/library/WRScpp/libs/WRScpp.so,
> 6): Library not loaded: /usr/local/lib/libquadmath.0.dylib
>    Referenced from:
> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/WRScpp/libs/WRScpp.so
>    Reason: image not found
> Error: package or namespace load failed for ?WRScpp??
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From maechler at stat.math.ethz.ch  Wed Sep  3 10:47:15 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 3 Sep 2014 10:47:15 +0200
Subject: [Rd] log(i, base=i) not giving 1
In-Reply-To: <5406AB47.3030200@stats.ox.ac.uk>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
	<21509.48311.450620.998931@stat.math.ethz.ch>
	<540639F5.2080002@gmail.com> <5406AB47.3030200@stats.ox.ac.uk>
Message-ID: <21510.54675.495343.895451@stat.math.ethz.ch>

>>>>> Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>     on Wed, 3 Sep 2014 06:46:47 +0100 writes:

    > On 02/09/2014 22:43, Ben Bolker wrote:
    >> On 14-09-02 08:48 AM, Martin Maechler wrote:
    >>>>>>>> peter dalgaard <pdalgd at gmail.com>
    >>>>>>>> on Tue, 2 Sep 2014 13:43:21 +0200 writes:
    >>> 
    >>> > Impressive. Never ceases to amaze me what computers can do these days. ;-)
    >>> 
    >>> Indeed,
    >>> 
    >>> > It's even more impressive given that we have
    >>> 
    >>> 
    >>> > static double logbase(double x, double base)
    >>> > {
    >>> > #ifdef HAVE_LOG10
    >>> > if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
    >>> > #endif
    >>> > #ifdef HAVE_LOG2
    >>> > if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
    >>> > #endif
    >>> > return R_log(x) / R_log(base);
    >>> > }
    >>> 
    >>> > which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....
    >>> 
    >>> Amazingly indeed, it does:  From the few platforms I can try
    >>> here, I only see the problem
    >>> on 32 bit Linux, both an (old) ubuntu 12.04.5 and Fedora 19.
    >>> 
    >>>> i <- 2:99; i[log(i, base=i) != 1]
    >>> [1]  5  8 14 18 19 25 58 60 64 65 66 67 75 80 84 86 91
    >>> 
    >>> so '8' is not so special (as Ben suggested) and also not the
    >>> only power of two for which this happens :
    >>> 
    >>>> i <- 2^(1:20); i[log(i, base=i) != 1]
    >>> [1] 8    64   128  4096  8192 16384
    >>> 
    >>> Interestingly, it does not happen on 32-bit Windows, nor on any
    >>> 64-bit version of R I've tried.
    >>> Yes, it is amazing that with computer arithmetic, we can't
    >>> even guarantee that   U / U = 1  exactly.
    >>> 
    >>> Is it basically free to check for x == base in there, so we
    >>> could change to
    >>> 
    >>> return (x == base) ? 1. : R_log(x) / R_log(base);
    >>> 
    >>> ?
    >> 
    >> Should I submit a formal bug report about this, or should I assume it
    >> has now been sufficiently noted by R-core?

    > It is under consideration by the author (not me).

    >> Opinions about whether it is better to fix in logbase (according to
    >> Martin's suggestion) or in version.R (e.g. BDR's suggestion of using
    >> log2(x)/3 or some other way that makes the function less sensitive) or both?

    > Yet again, it is better to write code which does not make false 
    > assumptions about machine arithmetic.  Fixing one very rare case at the 
    > expense of speed for all others is not a good idea.

Well, of course, that's why I asked about the expense. If it is
neglible, as it may well be here,  we have in other circumstances
opted for more platform-independence with very slight penalties,
e.g., when wrapping system library functions by our own.

After all, arithmetic in R *has* been somewhat more portable
between platforms than arithmetic in C (C++, Fortran,..) exactly
because of that.
For the present case, I'm not making a strong argument, and find
it ok to keep the current implementation, though possibly we
should mention the issue in the documentation then. 

    > Studying http://www.validlab.com/goldberg/addendum.html is a good idea 
    > for those unfamiliar with the pitfalls of i86 FPUs.  It has an example 
    > essentially the same as this one right at the top.

Indeed.  
OTOH, with this reasoning:

    > Also, Ben Bolker needs to change his compiler options to ones better 
    > than the defaults in his unstated Linux distro.   Why anyone is using 
    > ix86 Linux nowadays is hard to understand when x86_64 is (on all but the 
    > very smallest machines) faster and more reliable.

one could argue that the platforms where  log(i, base=i) != 1
should become much more rare in the future, and when 99.x % of
implementations provide a feature, chances are very high that user
code will make this assumption {after all, R core code just did
for a while!} in cases that are untested and occuring very rarely,
exactly the dangerous kinds of bugs.

As R code--even R packages--will continue to be written mostly by
people who do not know about possible FP pitfalls (*) and would
attribute them to their "software", i.e. in this case R in this case, 
I still see a reason for special casing, possibly even nicely
#ifdef'ed  , not causing any penalty on "-ffloat-store" or
x86_64 platforms ?

(*) Our 99.x % of R users would lack  too much background
    context to understand the problem even when urged to "learn"
    about it in some way.  They will always blame R in such cases.

Martin


    >> 
    >> Ben Bolker
    >> 
    >>> 
    >>> > On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:
    >>> 
    >>> >> log(8, base=8L)-1
    >>> >> log(8, base=8)-1
    >>> >> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
    >>> >> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
    >>> 
    >>> > --
    >>> > Peter Dalgaard, Professor,
    >>> > Center for Statistics, Copenhagen Business School
    >>> > Solbjerg Plads 3, 2000 Frederiksberg, Denmark
    >>> > Phone: (+45)38153501
    >>> > Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
    >>> 
    >>> > ______________________________________________
    >>> > R-devel at r-project.org mailing list
    >>> > https://stat.ethz.ch/mailman/listinfo/r-devel
    >>> 
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 


    > -- 
    > Brian D. Ripley,                  ripley at stats.ox.ac.uk
    > Emeritus Professor of Applied Statistics, University of Oxford
    > 1 South Parks Road, Oxford OX1 3TG, UK

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From pdalgd at gmail.com  Wed Sep  3 12:56:27 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 3 Sep 2014 12:56:27 +0200
Subject: [Rd] log(i, base=i) not giving 1
In-Reply-To: <21510.54675.495343.895451@stat.math.ethz.ch>
References: <5404BE1D.2020609@mcmaster.ca>
	<CAN_1p9ygzA+Kbb45QKqgASWE9vg11DV0=tLruSsMxWHULfYoCA@mail.gmail.com>
	<CABghstQyz36aboSegmTbKbETGnncK4oc8rc68d6uVcMbpkKOQw@mail.gmail.com>
	<CABghstQQdS1zgEBjW_cSYAY2M-M3cAQ_oUoUQRY6X80yPWLZQg@mail.gmail.com>
	<D800863A-31C6-4361-BB5C-036AD5D7C642@gmail.com>
	<21509.48311.450620.998931@stat.math.ethz.ch>
	<540639F5.2080002@gmail.com> <5406AB47.3030200@stats.ox.ac.uk>
	<21510.54675.495343.895451@stat.math.ethz.ch>
Message-ID: <6FA63BC5-55EF-4F96-8C03-A2AE1A55779C@gmail.com>

Two notes:

1) For version number comparisons, we could just add a small fuzz like floor(log(x,8)+.Machine$double.eps) and begone with the issue.

2) I did see some other spots where we use log10() to compute field widths for decimal representation of numbers. It might be good to check whether there are cases of log10(10^n) < n and if so, apply fuzz as above. (Ensuring that both (log10(10^n) + fuzz > n) and (log10(10^n-1) + fuzz < n) could get tricky, but maybe the problem just isn't there.)

-p

On 03 Sep 2014, at 10:47 , Martin Maechler <maechler at stat.math.ethz.ch> wrote:

>>>>>> Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>>    on Wed, 3 Sep 2014 06:46:47 +0100 writes:
> 
>> On 02/09/2014 22:43, Ben Bolker wrote:
>>> On 14-09-02 08:48 AM, Martin Maechler wrote:
>>>>>>>>> peter dalgaard <pdalgd at gmail.com>
>>>>>>>>> on Tue, 2 Sep 2014 13:43:21 +0200 writes:
>>>> 
>>>>> Impressive. Never ceases to amaze me what computers can do these days. ;-)
>>>> 
>>>> Indeed,
>>>> 
>>>>> It's even more impressive given that we have
>>>> 
>>>> 
>>>>> static double logbase(double x, double base)
>>>>> {
>>>>> #ifdef HAVE_LOG10
>>>>> if(base == 10) return x > 0 ? log10(x) : x < 0 ? R_NaN : R_NegInf;
>>>>> #endif
>>>>> #ifdef HAVE_LOG2
>>>>> if(base == 2) return x > 0 ? log2(x) : x < 0 ? R_NaN : R_NegInf;
>>>>> #endif
>>>>> return R_log(x) / R_log(base);
>>>>> }
>>>> 
>>>>> which, except possibly for base-10 and base-2, would seem to be quite hard to convince to return anything other than 1 if x == base....
>>>> 
>>>> Amazingly indeed, it does:  From the few platforms I can try
>>>> here, I only see the problem
>>>> on 32 bit Linux, both an (old) ubuntu 12.04.5 and Fedora 19.
>>>> 
>>>>> i <- 2:99; i[log(i, base=i) != 1]
>>>> [1]  5  8 14 18 19 25 58 60 64 65 66 67 75 80 84 86 91
>>>> 
>>>> so '8' is not so special (as Ben suggested) and also not the
>>>> only power of two for which this happens :
>>>> 
>>>>> i <- 2^(1:20); i[log(i, base=i) != 1]
>>>> [1] 8    64   128  4096  8192 16384
>>>> 
>>>> Interestingly, it does not happen on 32-bit Windows, nor on any
>>>> 64-bit version of R I've tried.
>>>> Yes, it is amazing that with computer arithmetic, we can't
>>>> even guarantee that   U / U = 1  exactly.
>>>> 
>>>> Is it basically free to check for x == base in there, so we
>>>> could change to
>>>> 
>>>> return (x == base) ? 1. : R_log(x) / R_log(base);
>>>> 
>>>> ?
>>> 
>>> Should I submit a formal bug report about this, or should I assume it
>>> has now been sufficiently noted by R-core?
> 
>> It is under consideration by the author (not me).
> 
>>> Opinions about whether it is better to fix in logbase (according to
>>> Martin's suggestion) or in version.R (e.g. BDR's suggestion of using
>>> log2(x)/3 or some other way that makes the function less sensitive) or both?
> 
>> Yet again, it is better to write code which does not make false 
>> assumptions about machine arithmetic.  Fixing one very rare case at the 
>> expense of speed for all others is not a good idea.
> 
> Well, of course, that's why I asked about the expense. If it is
> neglible, as it may well be here,  we have in other circumstances
> opted for more platform-independence with very slight penalties,
> e.g., when wrapping system library functions by our own.
> 
> After all, arithmetic in R *has* been somewhat more portable
> between platforms than arithmetic in C (C++, Fortran,..) exactly
> because of that.
> For the present case, I'm not making a strong argument, and find
> it ok to keep the current implementation, though possibly we
> should mention the issue in the documentation then. 
> 
>> Studying http://www.validlab.com/goldberg/addendum.html is a good idea 
>> for those unfamiliar with the pitfalls of i86 FPUs.  It has an example 
>> essentially the same as this one right at the top.
> 
> Indeed.  
> OTOH, with this reasoning:
> 
>> Also, Ben Bolker needs to change his compiler options to ones better 
>> than the defaults in his unstated Linux distro.   Why anyone is using 
>> ix86 Linux nowadays is hard to understand when x86_64 is (on all but the 
>> very smallest machines) faster and more reliable.
> 
> one could argue that the platforms where  log(i, base=i) != 1
> should become much more rare in the future, and when 99.x % of
> implementations provide a feature, chances are very high that user
> code will make this assumption {after all, R core code just did
> for a while!} in cases that are untested and occuring very rarely,
> exactly the dangerous kinds of bugs.
> 
> As R code--even R packages--will continue to be written mostly by
> people who do not know about possible FP pitfalls (*) and would
> attribute them to their "software", i.e. in this case R in this case, 
> I still see a reason for special casing, possibly even nicely
> #ifdef'ed  , not causing any penalty on "-ffloat-store" or
> x86_64 platforms ?
> 
> (*) Our 99.x % of R users would lack  too much background
>    context to understand the problem even when urged to "learn"
>    about it in some way.  They will always blame R in such cases.
> 
> Martin
> 
> 
>>> 
>>> Ben Bolker
>>> 
>>>> 
>>>>> On 02 Sep 2014, at 03:27 , Ben Bolker <bbolker at gmail.com> wrote:
>>>> 
>>>>>> log(8, base=8L)-1
>>>>>> log(8, base=8)-1
>>>>>> logvals <- setNames(log(2:25,base=2:25)-1,2:25)
>>>>>> logvals[logvals!=0]  ## 5,8,14,18,19,25 all == .Machine$double.eps/2
>>>> 
>>>>> --
>>>>> Peter Dalgaard, Professor,
>>>>> Center for Statistics, Copenhagen Business School
>>>>> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>>>>> Phone: (+45)38153501
>>>>> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>>>> 
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
> 
> 
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Emeritus Professor of Applied Statistics, University of Oxford
>> 1 South Parks Road, Oxford OX1 3TG, UK
> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From s.boehringer at lumc.nl  Wed Sep  3 18:41:51 2014
From: s.boehringer at lumc.nl (Stefan Boehringer)
Date: Wed, 3 Sep 2014 18:41:51 +0200
Subject: [Rd] Rcpp and dot in package name
Message-ID: <540744CF.6010909@lumc.nl>

I have run across a problem with Rcpp and trying to create a package
with a name containing a dot ('.') using Rcpp.package.skeleton. I get
the following error

RcppExports.cpp:10:25: error: expected initializer before '.' token
 RcppExport SEXP genetics.haplotype_rcpp_hello_world() {

implying that Rcpp literally uses the package name in internal function
name generation. Unfortunately, if I use an underscore ('_') instead, I get
Error : Invalid DESCRIPTION file

Malformed package name

See the information on DESCRIPTION files in section 'Creating R
packages' of the 'Writing R Extensions' manual.

Is there a workaround known?

Thanks in advance,

    Stefan

-- 
http://s-boehringer.org


From edd at debian.org  Wed Sep  3 18:51:55 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 3 Sep 2014 11:51:55 -0500
Subject: [Rd] Rcpp and dot in package name
In-Reply-To: <540744CF.6010909@lumc.nl>
References: <540744CF.6010909@lumc.nl>
Message-ID: <21511.18219.226793.452380@max.nulle.part>


Stefan,

R-devel is the wrong list. Please subscribe to rcpp-devel and ask there. 

Short tip: Don't use a dot in the name. 

See the 260+ packages depending on Rcpp listed at the bottom of eg
http://cran.rstudio.com/web/packages/Rcpp/index.html -- I essentially see no
dot there.

Regards,  Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From brian at braverock.com  Wed Sep  3 21:58:04 2014
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 03 Sep 2014 14:58:04 -0500
Subject: [Rd] timings for examples in R CMD check
Message-ID: <540772CC.3070108@braverock.com>

I'm having a very hard time making R CMD check produce a clean check on 
examples because of the timings inserted into examples by R CMD check.

I am getting a difference on every example output caused by timing 
information being inserted by 'R CMD check'.

The current 'Writing R Extensions' manual[1] states on p. 14:

    If directory tests has a subdirectory Examples containing a
    file pkg-Ex.Rout.save, this is  compared to the output file
    for running the examples when the latter are checked.
    Reference  output should be produced without having the
    --timings option set (and note that --as-cran  sets it).

As is suggested above, if I run

    R CMD check --as-cran mypkg.tar.gz

or

    R CMD check --timings mypkg.tar.gz

the my.pkg.Rcheck/mypkg-Ex.Rout file contains timing lines inserted by 
'R CMD check'

If, instead, I follow my reading of the manual, and run

R CMD check mypkg.tar.gz

the mypkg.Rcheck/mypkg-Ex.Rout file does not contain timings.  If I then 
copy the mypkg.Rcheck/mypkg-Ex.Rout file to

mypkg/tests/Examples/mypkg-Ex.Rout.save

as described by footnote 17 on the previously referenced p. 14, I would 
expect to now have no differences, as demonstrated by 'diff' or 'diff 
-bw' as used by 'R CMD check'.

To my surprise, whether I copy a version of the mypkg-Ex.Rout file with 
or without timing rows, I get differences reported for every example by 
the (spurious?) insertion of timings by R CMD check.

e.g.
8169a8549,8550
 > > base::assign(".dptime", (proc.time() - get(".ptime", pos = 
"CheckExEnv")), pos = "CheckExEnv")
 > > base::cat("textplot", base::get(".format_ptime", pos = 
'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", 
file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
8175a8557



Is this expected?

It is certainly not the behavior we had for many years, where a check of 
examples could actually be clean, producing differences only on the 
'Time elapsed:' line, which has been present for many R versions.  I 
have tried testing against a package with both the timing lines includes 
and excluded in /mypkg-Ex.Rout.save, and with R CMD check run without 
additional options, with --timings, and with --as-cran.   They produce 
equivalent check files. on their example checks.

This behavior is on R 3.1.0, 3.1.1, and R-devel.

I would assume from the documentation that there should be a way to get 
a clean check, without the timing diffs.

Advice appreciated,

Brian

Ref:
[1] http://cran.r-project.org/doc/manuals/R-exts.pdf

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From xie at yihui.name  Wed Sep  3 22:14:23 2014
From: xie at yihui.name (Yihui Xie)
Date: Wed, 3 Sep 2014 15:14:23 -0500
Subject: [Rd] timings for examples in R CMD check
In-Reply-To: <540772CC.3070108@braverock.com>
References: <540772CC.3070108@braverock.com>
Message-ID: <CANROs4cnVsCPwCJxCW+dB1pNbE7_aijSpLp-LSYv-W=53ZYYSQ@mail.gmail.com>

I did not really try it, but perhaps setting _R_CHECK_TIMINGS_=false
in your ~/.Renviron works?
http://cran.rstudio.com/doc/manuals/r-release/R-ints.html#Tools

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Web: http://yihui.name


On Wed, Sep 3, 2014 at 2:58 PM, Brian G. Peterson <brian at braverock.com> wrote:
> I'm having a very hard time making R CMD check produce a clean check on
> examples because of the timings inserted into examples by R CMD check.
>
> I am getting a difference on every example output caused by timing
> information being inserted by 'R CMD check'.
>
> The current 'Writing R Extensions' manual[1] states on p. 14:
>
>    If directory tests has a subdirectory Examples containing a
>    file pkg-Ex.Rout.save, this is  compared to the output file
>    for running the examples when the latter are checked.
>    Reference  output should be produced without having the
>    --timings option set (and note that --as-cran  sets it).
>
> As is suggested above, if I run
>
>    R CMD check --as-cran mypkg.tar.gz
>
> or
>
>    R CMD check --timings mypkg.tar.gz
>
> the my.pkg.Rcheck/mypkg-Ex.Rout file contains timing lines inserted by 'R
> CMD check'
>
> If, instead, I follow my reading of the manual, and run
>
> R CMD check mypkg.tar.gz
>
> the mypkg.Rcheck/mypkg-Ex.Rout file does not contain timings.  If I then
> copy the mypkg.Rcheck/mypkg-Ex.Rout file to
>
> mypkg/tests/Examples/mypkg-Ex.Rout.save
>
> as described by footnote 17 on the previously referenced p. 14, I would
> expect to now have no differences, as demonstrated by 'diff' or 'diff -bw'
> as used by 'R CMD check'.
>
> To my surprise, whether I copy a version of the mypkg-Ex.Rout file with or
> without timing rows, I get differences reported for every example by the
> (spurious?) insertion of timings by R CMD check.
>
> e.g.
> 8169a8549,8550
>> > base::assign(".dptime", (proc.time() - get(".ptime", pos =
>> > "CheckExEnv")), pos = "CheckExEnv")
>> > base::cat("textplot", base::get(".format_ptime", pos =
>> > 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n",
>> > file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> 8175a8557
>
>
>
> Is this expected?
>
> It is certainly not the behavior we had for many years, where a check of
> examples could actually be clean, producing differences only on the 'Time
> elapsed:' line, which has been present for many R versions.  I have tried
> testing against a package with both the timing lines includes and excluded
> in /mypkg-Ex.Rout.save, and with R CMD check run without additional options,
> with --timings, and with --as-cran.   They produce equivalent check files.
> on their example checks.
>
> This behavior is on R 3.1.0, 3.1.1, and R-devel.
>
> I would assume from the documentation that there should be a way to get a
> clean check, without the timing diffs.
>
> Advice appreciated,
>
> Brian
>
> Ref:
> [1] http://cran.r-project.org/doc/manuals/R-exts.pdf
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ucfagls at gmail.com  Wed Sep  3 22:36:41 2014
From: ucfagls at gmail.com (Gavin Simpson)
Date: Wed, 3 Sep 2014 14:36:41 -0600
Subject: [Rd] timings for examples in R CMD check
In-Reply-To: <540772CC.3070108@braverock.com>
References: <540772CC.3070108@braverock.com>
Message-ID: <CAAHES9zN07jPXFGa2ezTEC=Vq0U_Vb+3d7_mqXa2fm4CGu3j0A@mail.gmail.com>

Brian,

What you are doing is how I have always checked my packages:

1. Run R CMD check pkg_tarball.tar.gz
2. mv pkg.Rcheck/pkg-Ex.Rout pkg_sources/tests/Examples/pkg-Ex.Rout.save
3. Next R CMD check pkg_tarball.tar.gz checks against the new Example output

Are you sure you are getting the newly created pkg-Ex.Rout file and placing
it in the correct part of the package and adjusting the name
to pkg-Ex.Rout.save?

The only time I ever had a problem with this was when I inadvertently used
a .Rout file from a check with --as-cran.

G


On 3 September 2014 13:58, Brian G. Peterson <brian at braverock.com> wrote:

> I'm having a very hard time making R CMD check produce a clean check on
> examples because of the timings inserted into examples by R CMD check.
>
> I am getting a difference on every example output caused by timing
> information being inserted by 'R CMD check'.
>
> The current 'Writing R Extensions' manual[1] states on p. 14:
>
>    If directory tests has a subdirectory Examples containing a
>    file pkg-Ex.Rout.save, this is  compared to the output file
>    for running the examples when the latter are checked.
>    Reference  output should be produced without having the
>    --timings option set (and note that --as-cran  sets it).
>
> As is suggested above, if I run
>
>    R CMD check --as-cran mypkg.tar.gz
>
> or
>
>    R CMD check --timings mypkg.tar.gz
>
> the my.pkg.Rcheck/mypkg-Ex.Rout file contains timing lines inserted by 'R
> CMD check'
>
> If, instead, I follow my reading of the manual, and run
>
> R CMD check mypkg.tar.gz
>
> the mypkg.Rcheck/mypkg-Ex.Rout file does not contain timings.  If I then
> copy the mypkg.Rcheck/mypkg-Ex.Rout file to
>
> mypkg/tests/Examples/mypkg-Ex.Rout.save
>
> as described by footnote 17 on the previously referenced p. 14, I would
> expect to now have no differences, as demonstrated by 'diff' or 'diff -bw'
> as used by 'R CMD check'.
>
> To my surprise, whether I copy a version of the mypkg-Ex.Rout file with or
> without timing rows, I get differences reported for every example by the
> (spurious?) insertion of timings by R CMD check.
>
> e.g.
> 8169a8549,8550
> > > base::assign(".dptime", (proc.time() - get(".ptime", pos =
> "CheckExEnv")), pos = "CheckExEnv")
> > > base::cat("textplot", base::get(".format_ptime", pos =
> 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n",
> file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> 8175a8557
>
>
>
> Is this expected?
>
> It is certainly not the behavior we had for many years, where a check of
> examples could actually be clean, producing differences only on the 'Time
> elapsed:' line, which has been present for many R versions.  I have tried
> testing against a package with both the timing lines includes and excluded
> in /mypkg-Ex.Rout.save, and with R CMD check run without additional
> options, with --timings, and with --as-cran.   They produce equivalent
> check files. on their example checks.
>
> This behavior is on R 3.1.0, 3.1.1, and R-devel.
>
> I would assume from the documentation that there should be a way to get a
> clean check, without the timing diffs.
>
> Advice appreciated,
>
> Brian
>
> Ref:
> [1] http://cran.r-project.org/doc/manuals/R-exts.pdf
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gavin Simpson, PhD

	[[alternative HTML version deleted]]


From brian at braverock.com  Wed Sep  3 23:16:11 2014
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 03 Sep 2014 16:16:11 -0500
Subject: [Rd] timings for examples in R CMD check
In-Reply-To: <CAAHES9zN07jPXFGa2ezTEC=Vq0U_Vb+3d7_mqXa2fm4CGu3j0A@mail.gmail.com>
References: <540772CC.3070108@braverock.com>
	<CAAHES9zN07jPXFGa2ezTEC=Vq0U_Vb+3d7_mqXa2fm4CGu3j0A@mail.gmail.com>
Message-ID: <5407851B.6070108@braverock.com>

Gavin,

You were correct.  Operator error.

My tests/Examples directory contained both a

   ?PerformanceAnalytics-Ex.Rout? and a
   ?PerformanceAnalytics-Ex.Rout.save?

file.

Corrected now, and check shows

* checking examples ... OK

Thanks for the help.

Brian

On 09/03/2014 03:36 PM, Gavin Simpson wrote:
> Brian,
>
> What you are doing is how I have always checked my packages:
>
> 1. Run R CMD check pkg_tarball.tar.gz
> 2. mv pkg.Rcheck/pkg-Ex.Rout pkg_sources/tests/Examples/pkg-Ex.Rout.save
> 3. Next R CMD check pkg_tarball.tar.gz checks against the new Example output
>
> Are you sure you are getting the newly created pkg-Ex.Rout file and
> placing it in the correct part of the package and adjusting the name
> to pkg-Ex.Rout.save?
>
> The only time I ever had a problem with this was when I inadvertently
> used a .Rout file from a check with --as-cran.
>
> G
>
>
> On 3 September 2014 13:58, Brian G. Peterson <brian at braverock.com
> <mailto:brian at braverock.com>> wrote:
>
>     I'm having a very hard time making R CMD check produce a clean check
>     on examples because of the timings inserted into examples by R CMD
>     check.
>
>     I am getting a difference on every example output caused by timing
>     information being inserted by 'R CMD check'.
>
>     The current 'Writing R Extensions' manual[1] states on p. 14:
>
>         If directory tests has a subdirectory Examples containing a
>         file pkg-Ex.Rout.save, this is  compared to the output file
>         for running the examples when the latter are checked.
>         Reference  output should be produced without having the
>         --timings option set (and note that --as-cran  sets it).
>
>     As is suggested above, if I run
>
>         R CMD check --as-cran mypkg.tar.gz
>
>     or
>
>         R CMD check --timings mypkg.tar.gz
>
>     the my.pkg.Rcheck/mypkg-Ex.Rout file contains timing lines inserted
>     by 'R CMD check'
>
>     If, instead, I follow my reading of the manual, and run
>
>     R CMD check mypkg.tar.gz
>
>     the mypkg.Rcheck/mypkg-Ex.Rout file does not contain timings.  If I
>     then copy the mypkg.Rcheck/mypkg-Ex.Rout file to
>
>     mypkg/tests/Examples/mypkg-Ex.__Rout.save
>
>     as described by footnote 17 on the previously referenced p. 14, I
>     would expect to now have no differences, as demonstrated by 'diff'
>     or 'diff -bw' as used by 'R CMD check'.
>
>     To my surprise, whether I copy a version of the mypkg-Ex.Rout file
>     with or without timing rows, I get differences reported for every
>     example by the (spurious?) insertion of timings by R CMD check.
>
>     e.g.
>     8169a8549,8550
>      > > base::assign(".dptime", (proc.time() - get(".ptime", pos =
>     "CheckExEnv")), pos = "CheckExEnv")
>      > > base::cat("textplot", base::get(".format_ptime", pos =
>     'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n",
>     file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
>     8175a8557
>
>
>
>     Is this expected?
>
>     It is certainly not the behavior we had for many years, where a
>     check of examples could actually be clean, producing differences
>     only on the 'Time elapsed:' line, which has been present for many R
>     versions.  I have tried testing against a package with both the
>     timing lines includes and excluded in /mypkg-Ex.Rout.save, and with
>     R CMD check run without additional options, with --timings, and with
>     --as-cran.   They produce equivalent check files. on their example
>     checks.
>
>     This behavior is on R 3.1.0, 3.1.1, and R-devel.
>
>     I would assume from the documentation that there should be a way to
>     get a clean check, without the timing diffs.
>
>     Advice appreciated,
>
>     Brian
>
>     Ref:
>     [1] http://cran.r-project.org/doc/__manuals/R-exts.pdf
>     <http://cran.r-project.org/doc/manuals/R-exts.pdf>
>


From sven.templer at gmail.com  Thu Sep  4 01:03:28 2014
From: sven.templer at gmail.com (Sven E. Templer)
Date: Thu, 4 Sep 2014 01:03:28 +0200
Subject: [Rd] 'library(ggplot2)' R CMD check WARNING in vignette R code
Message-ID: <CAHuTOvr8n_ueLcB7Oax7X_AXvmeC0Ya+4ez1xWkaT_U3wARtXw@mail.gmail.com>

Hi,

can I claim the warning that occurs (at R CMD check --as-cran) when I
use 'library(ggplot2)' in executed vignette code as SPURIOUS (as
mentioned in the CRAN policies at section 'Submission') and (since it
is the only warning/error) get my package submission accepted? Has
anybody experience with that? Otherwise, is there a workaround to
evaluate this code (and calls to ggplot()) in a vignette for a CRAN
package?

Thank you,
Sven.


From ligges at statistik.tu-dortmund.de  Thu Sep  4 01:16:17 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 04 Sep 2014 01:16:17 +0200
Subject: [Rd] 'library(ggplot2)' R CMD check WARNING in vignette R code
In-Reply-To: <CAHuTOvr8n_ueLcB7Oax7X_AXvmeC0Ya+4ez1xWkaT_U3wARtXw@mail.gmail.com>
References: <CAHuTOvr8n_ueLcB7Oax7X_AXvmeC0Ya+4ez1xWkaT_U3wARtXw@mail.gmail.com>
Message-ID: <5407A141.4070507@statistik.tu-dortmund.de>



On 04.09.2014 01:03, Sven E. Templer wrote:
> Hi,
>
> can I claim the warning that occurs (at R CMD check --as-cran) when I
> use 'library(ggplot2)' in executed vignette code as SPURIOUS (as
> mentioned in the CRAN policies at section 'Submission') and (since it
> is the only warning/error) get my package submission accepted? Has
> anybody experience with that? Otherwise, is there a workaround to
> evaluate this code (and calls to ggplot()) in a vignette for a CRAN
> package?

We don't know what the waring is, hence hard to help. My guess is you 
forgot to declare a dependency such as "Suggestes" on ggplot2.

Best,
Uwe Ligges



>
> Thank you,
> Sven.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From sven.templer at gmail.com  Thu Sep  4 01:23:59 2014
From: sven.templer at gmail.com (Sven E. Templer)
Date: Thu, 4 Sep 2014 01:23:59 +0200
Subject: [Rd] 'library(ggplot2)' R CMD check WARNING in vignette R code
In-Reply-To: <5407A141.4070507@statistik.tu-dortmund.de>
References: <CAHuTOvr8n_ueLcB7Oax7X_AXvmeC0Ya+4ez1xWkaT_U3wARtXw@mail.gmail.com>
	<5407A141.4070507@statistik.tu-dortmund.de>
Message-ID: <CAHuTOvo9gVoLcJb7H=0R3XO8maT1x+GSKp-sYQ-U4PBM4=E9DQ@mail.gmail.com>

This guess solved the issue, thank you! Sven

On 4 September 2014 01:16, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>
>
> On 04.09.2014 01:03, Sven E. Templer wrote:
>>
>> Hi,
>>
>> can I claim the warning that occurs (at R CMD check --as-cran) when I
>> use 'library(ggplot2)' in executed vignette code as SPURIOUS (as
>> mentioned in the CRAN policies at section 'Submission') and (since it
>> is the only warning/error) get my package submission accepted? Has
>> anybody experience with that? Otherwise, is there a workaround to
>> evaluate this code (and calls to ggplot()) in a vignette for a CRAN
>> package?
>
>
> We don't know what the waring is, hence hard to help. My guess is you forgot
> to declare a dependency such as "Suggestes" on ggplot2.
>
> Best,
> Uwe Ligges
>
>
>
>>
>> Thank you,
>> Sven.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From michael.haupt at oracle.com  Thu Sep  4 17:17:16 2014
From: michael.haupt at oracle.com (Michael Haupt)
Date: Thu, 4 Sep 2014 17:17:16 +0200
Subject: [Rd] negative numerics in []
Message-ID: <2D13E3F7-A7AE-4614-959B-B48C74E60D62@oracle.com>

Hello,

I'm a bit puzzled by what looks (to me) like a discrepancy between documentation and implementation.

The documentation for [] says this about the indices: "Numeric values are coerced to integer as by as.integer (and hence truncated towards zero)."

> as.integer(-3.1)
[1] -3

Good. But:

> x <- c(1,2,3)
> x[-3.1]
[1] 1 2 3

Given the documentation, I'd have expected a result of "[1] 1 2", because -3.1 should be coerced to -3 (by virtue of as.integer).

What bit do I not get? (I'm using R 3.1.1, if that matters.)

Best,

Michael

-- 
Dr. Michael Haupt
Principal Member of Technical Staff
Phone: +49 331 200 7277, Fax: +49 331 200 7561
Oracle Labs
Oracle Deutschland B.V. & Co. KG, Schiffbauergasse 14, 14467 Potsdam, Germany


From tsantossilva at algomau.ca  Thu Sep  4 17:15:18 2014
From: tsantossilva at algomau.ca (Thalles)
Date: Thu, 4 Sep 2014 08:15:18 -0700 (PDT)
Subject: [Rd] R CMD check --as-cran does not show all error messages.
Message-ID: <1409843718542-4696489.post@n4.nabble.com>

Hello, That is my first post here and I'd like to thanks everybody in
advance.

I am writing a package with some R functions and try to submit it to CRAN.
After build and check the package a number of times, I am struggling with
the fact that the CRAN people responsible for checking  packages are
replying me with some mistakes that I just do NOT get when I do the check in
my computer. With the most recent R version, i.e. 3.1.1 and the command R
CMD check --as-cran on my package I get:

* using log directory ?/home/thalles/Music/opentraj.Rcheck?
* using R version 3.1.1 (2014-07-10)
* using platform: x86_64-pc-linux-gnu (64-bit)
* using session charset: UTF-8
* checking for file ?opentraj/DESCRIPTION? ... OK
* checking extension type ... Package
* this is package ?opentraj? version ?1.0?
* checking CRAN incoming feasibility ... NOTE
Maintainer: ?Thalles Silva <tsantossilva at algomau.ca>?
New submission
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking whether package ?opentraj? can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ...
OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking loading without being on the library search path ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of ?data? directory ... OK
* checking data for non-ASCII characters ... OK
* checking data for ASCII and uncompressed saves ... OK
* checking examples ... OK
Examples with CPU or elapsed time > 5s
                   user system elapsed
Df2SpLinesDf     67.203  0.254  67.564
Df2SpLines       36.962  0.200  37.220
PlotTraj          6.802  0.048   6.860
hytraj07.lines    5.641  0.049   5.699
hytraj07.linesDf  5.229  0.059   5.295
* checking PDF version of manual ... OK
NOTE: There was 1 note.

However, the people from CRAN claim that there is a error:

* checking R code for possible problems ... NOTE
PlotBgMap: no visible binding for global variable ?canada.map?

This function 'PlotBgMap' loads this data set ?canada.map?, that is part of
the package. And the *LazyData: yes* is set in the DESCRIPTION file. I know
that the cause of this error is because somehow, the package is not being
loaded in the NAMESPACE, but it should be there because I am using LazyData.
That is the code for the PlotBgMap function:

PlotBgMap <-function( traj, ... ) {
    hySplitProj <- CRS(proj4string(traj))
    canada <- spTransform(canada.map, hySplitProj)
    plot(canada.map, border="white", col="lightgrey", ... )
}

I'd like to know if I am missing something in the Checking process, or if I
should do anything else to fix this error. Thanks.



--
View this message in context: http://r.789695.n4.nabble.com/R-CMD-check-as-cran-does-not-show-all-error-messages-tp4696489.html
Sent from the R devel mailing list archive at Nabble.com.


From hb at biostat.ucsf.edu  Thu Sep  4 18:52:20 2014
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 4 Sep 2014 09:52:20 -0700
Subject: [Rd] negative numerics in []
In-Reply-To: <2D13E3F7-A7AE-4614-959B-B48C74E60D62@oracle.com>
References: <2D13E3F7-A7AE-4614-959B-B48C74E60D62@oracle.com>
Message-ID: <CAFDcVCQ06ns+cNfeMw+sjxi5cNogbyhABdmZw+=r46cgohuueg@mail.gmail.com>

I can reproduce this.  It seems to be happen when trying to drop the
last element, e.g.

> x <- 1:3
> x[-3.1]
[1] 1 2 3
> x[-2.1]
[1] 1 3
> x[-1.1]
[1] 2 3

> x <- 1:2
> x[-2.1]
[1] 1 2
> x[-1.1]
[1] 2

> x <- 1:4
> x[-4.1]
[1] 1 2 3
> x[-3.1]
[1] 1 2 4
> x[-2.1]
[1] 1 3 4
> x[-1.1]
[1] 2 3 4

> x <- 1
> x[-1.1]
[1] 1

My *guess* (all time I have) is that it's a bug where as.integer() is
applied only *after* (silently) dropping negative indices out of
range, e.g.

> x <- 1:4
> x[-c(1:10+0.1)]
[1] 4

Here -c(4:10+0.1) are dropped because they all > length(x).

If someone wish to track this down further, the R source is available
at https://svn.r-project.org/R/trunk/ (mirrored at
https://github.com/wch/r-source).

/Henrik

On Thu, Sep 4, 2014 at 8:17 AM, Michael Haupt <michael.haupt at oracle.com> wrote:
> Hello,
>
> I'm a bit puzzled by what looks (to me) like a discrepancy between documentation and implementation.
>
> The documentation for [] says this about the indices: "Numeric values are coerced to integer as by as.integer (and hence truncated towards zero)."
>
>> as.integer(-3.1)
> [1] -3
>
> Good. But:
>
>> x <- c(1,2,3)
>> x[-3.1]
> [1] 1 2 3
>
> Given the documentation, I'd have expected a result of "[1] 1 2", because -3.1 should be coerced to -3 (by virtue of as.integer).
>
> What bit do I not get? (I'm using R 3.1.1, if that matters.)
>
> Best,
>
> Michael
>
> --
> Dr. Michael Haupt
> Principal Member of Technical Staff
> Phone: +49 331 200 7277, Fax: +49 331 200 7561
> Oracle Labs
> Oracle Deutschland B.V. & Co. KG, Schiffbauergasse 14, 14467 Potsdam, Germany
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Thu Sep  4 19:12:30 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 04 Sep 2014 13:12:30 -0400
Subject: [Rd] negative numerics in []
In-Reply-To: <CAFDcVCQ06ns+cNfeMw+sjxi5cNogbyhABdmZw+=r46cgohuueg@mail.gmail.com>
References: <2D13E3F7-A7AE-4614-959B-B48C74E60D62@oracle.com>
	<CAFDcVCQ06ns+cNfeMw+sjxi5cNogbyhABdmZw+=r46cgohuueg@mail.gmail.com>
Message-ID: <54089D7E.10705@gmail.com>

On 04/09/2014 12:52 PM, Henrik Bengtsson wrote:
> I can reproduce this.  It seems to be happen when trying to drop the
> last element, e.g.
>
> > x <- 1:3
> > x[-3.1]
> [1] 1 2 3
> > x[-2.1]
> [1] 1 3
> > x[-1.1]
> [1] 2 3
>
> > x <- 1:2
> > x[-2.1]
> [1] 1 2
> > x[-1.1]
> [1] 2
>
> > x <- 1:4
> > x[-4.1]
> [1] 1 2 3
> > x[-3.1]
> [1] 1 2 4
> > x[-2.1]
> [1] 1 3 4
> > x[-1.1]
> [1] 2 3 4
>
> > x <- 1
> > x[-1.1]
> [1] 1
>
> My *guess* (all time I have) is that it's a bug where as.integer() is
> applied only *after* (silently) dropping negative indices out of
> range, e.g.
>
> > x <- 1:4
> > x[-c(1:10+0.1)]
> [1] 4
>
> Here -c(4:10+0.1) are dropped because they all > length(x).
>
> If someone wish to track this down further, the R source is available
> at https://svn.r-project.org/R/trunk/ (mirrored at
> https://github.com/wch/r-source).

The documentation in the R Language Definition states quite clearly that 
the truncation happens first, so this definitely looks like a bug.  It 
also states  "A negative out of bounds value for |i| [the index] causes 
an error", which is also not true, but it seems possible that a 
documentation change would be less disruptive than a code change.

Duncan Murdoch
>
> /Henrik
>
> On Thu, Sep 4, 2014 at 8:17 AM, Michael Haupt <michael.haupt at oracle.com> wrote:
> > Hello,
> >
> > I'm a bit puzzled by what looks (to me) like a discrepancy between documentation and implementation.
> >
> > The documentation for [] says this about the indices: "Numeric values are coerced to integer as by as.integer (and hence truncated towards zero)."
> >
> >> as.integer(-3.1)
> > [1] -3
> >
> > Good. But:
> >
> >> x <- c(1,2,3)
> >> x[-3.1]
> > [1] 1 2 3
> >
> > Given the documentation, I'd have expected a result of "[1] 1 2", because -3.1 should be coerced to -3 (by virtue of as.integer).
> >
> > What bit do I not get? (I'm using R 3.1.1, if that matters.)
> >
> > Best,
> >
> > Michael
> >
> > --
> > Dr. Michael Haupt
> > Principal Member of Technical Staff
> > Phone: +49 331 200 7277, Fax: +49 331 200 7561
> > Oracle Labs
> > Oracle Deutschland B.V. & Co. KG, Schiffbauergasse 14, 14467 Potsdam, Germany
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hanson at depauw.edu  Thu Sep  4 20:47:34 2014
From: hanson at depauw.edu (Bryan Hanson)
Date: Thu, 4 Sep 2014 14:47:34 -0400
Subject: [Rd] negative numerics in []
In-Reply-To: <2D13E3F7-A7AE-4614-959B-B48C74E60D62@oracle.com>
References: <2D13E3F7-A7AE-4614-959B-B48C74E60D62@oracle.com>
Message-ID: <D8E0BDA6-79F5-47C6-968C-4616D3037EAC@depauw.edu>

Just for the sake of completeness, I raised a closely related issue back in 2010 which my students discovered.

https://stat.ethz.ch/pipermail/r-help/2010-March/231788.html

Bryan

On Sep 4, 2014, at 11:17 AM, Michael Haupt <michael.haupt at oracle.com> wrote:

> Hello,
> 
> I'm a bit puzzled by what looks (to me) like a discrepancy between documentation and implementation.
> 
> The documentation for [] says this about the indices: "Numeric values are coerced to integer as by as.integer (and hence truncated towards zero)."
> 
>> as.integer(-3.1)
> [1] -3
> 
> Good. But:
> 
>> x <- c(1,2,3)
>> x[-3.1]
> [1] 1 2 3
> 
> Given the documentation, I'd have expected a result of "[1] 1 2", because -3.1 should be coerced to -3 (by virtue of as.integer).
> 
> What bit do I not get? (I'm using R 3.1.1, if that matters.)
> 
> Best,
> 
> Michael
> 
> -- 
> Dr. Michael Haupt
> Principal Member of Technical Staff
> Phone: +49 331 200 7277, Fax: +49 331 200 7561
> Oracle Labs
> Oracle Deutschland B.V. & Co. KG, Schiffbauergasse 14, 14467 Potsdam, Germany
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mikko.korpela at aalto.fi  Fri Sep  5 09:04:39 2014
From: mikko.korpela at aalto.fi (Mikko Korpela)
Date: Fri, 5 Sep 2014 10:04:39 +0300
Subject: [Rd] R CMD check --as-cran does not show all error messages.
In-Reply-To: <1409843718542-4696489.post@n4.nabble.com>
References: <1409843718542-4696489.post@n4.nabble.com>
Message-ID: <54096087.5070700@aalto.fi>

On 04.09.2014 18:15, Thalles wrote:

> I am writing a package with some R functions and try to submit it to CRAN.
> After build and check the package a number of times, I am struggling with
> the fact that the CRAN people responsible for checking  packages are
> replying me with some mistakes that I just do NOT get when I do the check in
> my computer. With the most recent R version, i.e. 3.1.1 and the command R
> CMD check --as-cran on my package I get:

(check log with no errors)

> However, the people from CRAN claim that there is a error:
> 
> * checking R code for possible problems ... NOTE
> PlotBgMap: no visible binding for global variable ?canada.map?
> 
> This function 'PlotBgMap' loads this data set ?canada.map?, that is part of
> the package. And the *LazyData: yes* is set in the DESCRIPTION file. I know
> that the cause of this error is because somehow, the package is not being
> loaded in the NAMESPACE, but it should be there because I am using LazyData.
> That is the code for the PlotBgMap function:
> 
> PlotBgMap <-function( traj, ... ) {
>     hySplitProj <- CRS(proj4string(traj))
>     canada <- spTransform(canada.map, hySplitProj)
>     plot(canada.map, border="white", col="lightgrey", ... )
> }
> 
> I'd like to know if I am missing something in the Checking process, or if I
> should do anything else to fix this error. Thanks.

It seems that this is the same issue as discussed recently on this
mailing list, with the title "no visible binding for global variable for
data sets in a package". I recommend reading the message thread.

Short story: There was a recent change to package checking in the
development version of R (R-devel). This more rigorous check is not
included in the current release version 3.1.1. You can use
opentraj::canada.map to access this particular data set, and a similar
approach for any other LazyData in your package. The :: technique was
suggested in the aforementioned message thread by professors Brian D.
Ripley and Peter Dalgaard.

Quoting "Changes in R-devel",
http://stat.ethz.ch/R-manual/R-devel/doc/html/NEWS.html

> R CMD check now by default checks code usage directly on the package
> namespace without loading and attaching the package and its suggests
> and enhances. For good practice with packages in the Suggests field,
> see ?1.1.3.1 of ?Writing R Extensions?.

The CRAN Repository Policy,
http://cran.r-project.org/web/packages/policies.html, suggests using the
most recent R-devel for package checking before submission.

-- 
Mikko Korpela
Aalto University School of Science
Department of Information and Computer Science


From ripley at stats.ox.ac.uk  Fri Sep  5 11:03:31 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 05 Sep 2014 10:03:31 +0100
Subject: [Rd] R CMD check --as-cran does not show all error messages.
In-Reply-To: <54096087.5070700@aalto.fi>
References: <1409843718542-4696489.post@n4.nabble.com>
	<54096087.5070700@aalto.fi>
Message-ID: <54097C63.9040601@stats.ox.ac.uk>

On 05/09/2014 08:04, Mikko Korpela wrote:
> On 04.09.2014 18:15, Thalles wrote:
>
>> I am writing a package with some R functions and try to submit it to CRAN.
>> After build and check the package a number of times, I am struggling with
>> the fact that the CRAN people responsible for checking  packages are
>> replying me with some mistakes that I just do NOT get when I do the check in
>> my computer. With the most recent R version, i.e. 3.1.1 and the command R
>> CMD check --as-cran on my package I get:
>
> (check log with no errors)
>
>> However, the people from CRAN claim that there is a error:
>>
>> * checking R code for possible problems ... NOTE
>> PlotBgMap: no visible binding for global variable ?canada.map?
>>
>> This function 'PlotBgMap' loads this data set ?canada.map?, that is part of
>> the package. And the *LazyData: yes* is set in the DESCRIPTION file. I know
>> that the cause of this error is because somehow, the package is not being
>> loaded in the NAMESPACE, but it should be there because I am using LazyData.
>> That is the code for the PlotBgMap function:
>>
>> PlotBgMap <-function( traj, ... ) {
>>      hySplitProj <- CRS(proj4string(traj))
>>      canada <- spTransform(canada.map, hySplitProj)
>>      plot(canada.map, border="white", col="lightgrey", ... )
>> }
>>
>> I'd like to know if I am missing something in the Checking process, or if I
>> should do anything else to fix this error. Thanks.
>
> It seems that this is the same issue as discussed recently on this
> mailing list, with the title "no visible binding for global variable for
> data sets in a package". I recommend reading the message thread.
>
> Short story: There was a recent change to package checking in the
> development version of R (R-devel). This more rigorous check is not
> included in the current release version 3.1.1. You can use
> opentraj::canada.map to access this particular data set, and a similar
> approach for any other LazyData in your package. The :: technique was
> suggested in the aforementioned message thread by professors Brian D.
> Ripley and Peter Dalgaard.
>
> Quoting "Changes in R-devel",
> http://stat.ethz.ch/R-manual/R-devel/doc/html/NEWS.html
>
>> R CMD check now by default checks code usage directly on the package
>> namespace without loading and attaching the package and its suggests
>> and enhances. For good practice with packages in the Suggests field,
>> see ?1.1.3.1 of ?Writing R Extensions?.
>
> The CRAN Repository Policy,
> http://cran.r-project.org/web/packages/policies.html, suggests using the
> most recent R-devel for package checking before submission.

It more than 'suggests':

'This should be done with the current version of R-devel ...'

That was pointed out to the original poster (multiple times) by the CRAN 
team.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From 538280 at gmail.com  Fri Sep  5 20:25:14 2014
From: 538280 at gmail.com (Greg Snow)
Date: Fri, 5 Sep 2014 12:25:14 -0600
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <53E4FDA9.70903@R-project.org>
References: <53E4FDA9.70903@R-project.org>
Message-ID: <CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>

Uwe,

Have all of these packages found new maintainers? if not, which ones
are still looking to be adopted?

thanks,

On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org> wrote:
> Dear maintainers and R-devel,
>
> Several orphaned CRAN packages are about to be archived due to outstanding
> QC problems, but have CRAN and BioC packages depending on them which would
> be broken by the archival (and hence need archiving alongside).
> Therefore we are looking for new maintainers taking over maintainership for
> one or more of the following packages:
>
> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>
> Package maintainers whose packages depend on one of these may be natural
> candidates to become new maintainers.
> Hence this messages is addressed to all these maintainers via BCC and to
> R-devel.
>
> See
>
>   <http://CRAN.R-project.org/package=R2HTML>
>   <http://CRAN.R-project.org/package=SemiPar>
>   <http://CRAN.R-project.org/package=cghseg>
>   <http://CRAN.R-project.org/package=hexbin>
>   <http://CRAN.R-project.org/package=lgtdl>
>   <http://CRAN.R-project.org/package=monreg>
>   <http://CRAN.R-project.org/package=muhaz>
>   <http://CRAN.R-project.org/package=operators>
>   <http://CRAN.R-project.org/package=pamr>
>
> for information on the QC issues and the reverse dependencies.
>
> Best wishes,
> Uwe Ligges
> (for the CRAN team)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From bbolker at gmail.com  Sat Sep  6 00:31:36 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 5 Sep 2014 18:31:36 -0400
Subject: [Rd] r wiki
Message-ID: <540A39C8.606@gmail.com>


  Does anyone happen to know the fate of the R wiki, which was formerly
maintained (I think) at www.sciviews.org (now has information about a
kids' play centre) by Philippe Grosjean (I think)?  wiki.r-project.org
redirects to http://rwiki.sciviews.org/ which gives a "404 not found" ...

  Ben Bolker


From andrezda10 at yandex.com  Sat Sep  6 01:17:49 2014
From: andrezda10 at yandex.com (=?utf-8?B?QW5kcsOpIFouIEQuIEEu?=)
Date: Fri, 5 Sep 2014 20:17:49 -0300
Subject: [Rd] r wiki
Message-ID: <6604241409959069@web8j.yandex.ru>

This does not answer you, but if you are looking for something that existed on that wiki, it may help:

https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
doku.php

And that wiki doesn't look like it had a lot of activity:
https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/


From ligges at statistik.tu-dortmund.de  Sat Sep  6 17:28:37 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 6 Sep 2014 17:28:37 +0200
Subject: [Rd] r wiki
In-Reply-To: <6604241409959069@web8j.yandex.ru>
References: <6604241409959069@web8j.yandex.ru>
Message-ID: <540B2825.40403@statistik.tu-dortmund.de>

Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.

Best,
Uwe Ligges



On 06.09.2014 01:17, Andr? Z. D. A. wrote:
> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>
> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
> doku.php
>
> And that wiki doesn't look like it had a lot of activity:
> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From radford at cs.toronto.edu  Sun Sep  7 02:25:49 2014
From: radford at cs.toronto.edu (Radford Neal)
Date: Sat, 6 Sep 2014 20:25:49 -0400
Subject: [Rd] New flag bit for serialized used by pqR
Message-ID: <20140907002549.GA29400@cs.toronto.edu>

I will shortly be releasing a new version of pqR (you can get a test
version from pqR-project.org now - scroll to the bottom of the page).
One new feature in this version requires adding a bit to the flags
written out when data is serialized.  I thought I'd let you know about
this so as to avoid any possible conflicts.

The new feature is that a few R objects are defined as constants,
which are probably put in read-only memory by the C compiler.  These
include NULL, TRUE, FALSE, NA, 0L, 1L, ... 10L, 0.0, 1.0, and the
one-element pairlists containing these.  Apart from NULL, these
constants are not guaranteed to be used for all instances of these
values, but they often are.  When data is serialized and then read
back in, I'd like for the occurrences of these constants to be
re-created as constants.  One might always use these constants when
reading in data, but I'm not doing that now because I'm not confident
that there is no code relying on certain instances of these objects
being unshared.

So I write out the constants with a flag bit saying they are
constants, and re-create them as constants only if this bit is set
(and they have constant versions in the current implementation).  Old
workspaces will never have this bit set, so nothing will be re-created
as constants (except NULL).  If a workspace with some of these
constant flag bits set is read by an old version of R, the flag bits
will just be ignored (by UnpackFlags in serialize.c), so the objects
will be restored the same as if they had been written by such an old
version.

So this should all work fine unless R Core implementations start using
this bit for something else.  (Or unless some old version of R used it
for something else - which isn't the case as far as I can tell, but
please let me know if you know of such usage.)

There are four more unused bits in the 32-bit word that is written
out, plus two more could be scrounged by storing the "type" in six
bits rather than eight, so there doesn't seem to be an immediate
shortage of bits.

The relevant declarations in serialize.c are as follows:

/*
 * Type/Flag Packing and Unpacking
 *
 * To reduce space consumption for serializing code (lots of list
 * structure) the type (at most 8 bits), several single bit flags,
 * and the sxpinfo gp field (LEVELS, 16 bits) are packed into a single
 * integer.  The integer is signed, so this shouldn't be pushed too
 * far.  It assumes at least 28 bits, but that should be no problem.
 */

#define IS_OBJECT_BIT_MASK (1 << 8)
#define HAS_ATTR_BIT_MASK (1 << 9)
#define HAS_TAG_BIT_MASK (1 << 10)
#define IS_CONSTANT_MASK (1 << 11)       /* <<--- added in pqR */
#define ENCODE_LEVELS(v) ((v) << 12)
#define DECODE_LEVELS(v) ((v) >> 12)
#define DECODE_TYPE(v) ((v) & 255)

Please let me know if you see any problem with this, or if for some
reason you'd prefer that I use one of the other four available bits
(in the top of the 32-bit word).

Regards,

    Radford Neal


From richierocks at gmail.com  Sun Sep  7 10:07:02 2014
From: richierocks at gmail.com (Richard Cotton)
Date: Sun, 7 Sep 2014 11:07:02 +0300
Subject: [Rd] normalizePath is sometimes very slow for nonexistent UNC paths
Message-ID: <CAPp_+=eZqqxg2jDK2NLtJ=ruG6NsTyUcD-A+LAmMGYP0ZyL4pA@mail.gmail.com>

I'm having an issue with occasionally slow-running calls to
normalizePath.  If the path is a non-existent UNC path, then
normalizePath sometimes takes 6 or 7 seconds to run, rather than its
usual few microseconds.  My big problem is that I can't reliably
reproduce this across machines.

The example below generates one or two slow runs out of 10000 on my
Windows machine. I haven't been able to generate slow runs on my Linux
machine, though I've had problems with slow running examples submitted
to CRAN that I suspect may be caused by this.

library(microbenchmark)
(timings <- microbenchmark(
  normalizePath("\\\\some/network/drive", mustWork = FALSE),
  times = 1e4,
  unit  = "s"
))
boxplot(timings)

Please can a few people run this code and see if they can reproduce the issue.

It isn't clear to me whether this is a bug in R or an underlying OS or
network problem.

-- 
Regards,
Richie


From ligges at statistik.tu-dortmund.de  Sun Sep  7 15:33:05 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 07 Sep 2014 15:33:05 +0200
Subject: [Rd] normalizePath is sometimes very slow for nonexistent UNC
 paths
In-Reply-To: <CAPp_+=eZqqxg2jDK2NLtJ=ruG6NsTyUcD-A+LAmMGYP0ZyL4pA@mail.gmail.com>
References: <CAPp_+=eZqqxg2jDK2NLtJ=ruG6NsTyUcD-A+LAmMGYP0ZyL4pA@mail.gmail.com>
Message-ID: <540C5E91.1030009@statistik.tu-dortmund.de>



On 07.09.2014 10:07, Richard Cotton wrote:
> I'm having an issue with occasionally slow-running calls to
> normalizePath.  If the path is a non-existent UNC path, then
> normalizePath sometimes takes 6 or 7 seconds to run, rather than its
> usual few microseconds.  My big problem is that I can't reliably
> reproduce this across machines.
>
> The example below generates one or two slow runs out of 10000 on my
> Windows machine. I haven't been able to generate slow runs on my Linux
> machine, though I've had problems with slow running examples submitted
> to CRAN that I suspect may be caused by this.
>
> library(microbenchmark)
> (timings <- microbenchmark(
>    normalizePath("\\\\some/network/drive", mustWork = FALSE),
>    times = 1e4,
>    unit  = "s"
> ))
> boxplot(timings)


It is an OS "problem": You r OS tries to find some and has to look 
around waiting for responses. Hence you run into timeouts. If the cached 
result says some does not exist, you are quick...

Best,
Uwe Ligges



> Please can a few people run this code and see if they can reproduce the issue.
>
> It isn't clear to me whether this is a bug in R or an underlying OS or
> network problem.
>


From md at sund.ku.dk  Sun Sep  7 10:22:55 2014
From: md at sund.ku.dk (Matt Denwood)
Date: Sun, 7 Sep 2014 08:22:55 +0000
Subject: [Rd] normalizePath is sometimes very slow for nonexistent UNC
 paths
In-Reply-To: <CAPp_+=eZqqxg2jDK2NLtJ=ruG6NsTyUcD-A+LAmMGYP0ZyL4pA@mail.gmail.com>
References: <CAPp_+=eZqqxg2jDK2NLtJ=ruG6NsTyUcD-A+LAmMGYP0ZyL4pA@mail.gmail.com>
Message-ID: <77A7D7A9-D0C4-4C0B-803C-9D771642A808@sund.ku.dk>

Maximum 0.02022958 seconds out of 10^6 runs for me, so no obvious problem on OS X 10.9 (Snow Leopard build).

Matt


> library(microbenchmark)
> (timings <- microbenchmark(
+  normalizePath("\\\\some/network/drive", mustWork = FALSE),
+  times = 1e6,
+  unit  = "s"
+ ))
Unit: seconds
                                                          expr       min
 normalizePath("\\\\\\\\some/network/drive", mustWork = FALSE) 8.877e-06
        lq    median       uq        max neval
 9.428e-06 9.621e-06 9.86e-06 0.02022958 1e+06

> sessionInfo()
R version 3.1.1 (2014-07-10)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] graphics  grDevices utils     datasets  stats     methods   base     

other attached packages:
[1] microbenchmark_1.3-0

> .Platform
$OS.type
[1] "unix"

$file.sep
[1] "/"

$dynlib.ext
[1] ".so"

$GUI
[1] "AQUA"

$endian
[1] "little"

$pkgType
[1] "mac.binary"

$path.sep
[1] ":"

$r_arch
[1] ""


On 07 Sep 2014, at 10:07, Richard Cotton <richierocks at gmail.com> wrote:

> I'm having an issue with occasionally slow-running calls to
> normalizePath.  If the path is a non-existent UNC path, then
> normalizePath sometimes takes 6 or 7 seconds to run, rather than its
> usual few microseconds.  My big problem is that I can't reliably
> reproduce this across machines.
> 
> The example below generates one or two slow runs out of 10000 on my
> Windows machine. I haven't been able to generate slow runs on my Linux
> machine, though I've had problems with slow running examples submitted
> to CRAN that I suspect may be caused by this.
> 
> library(microbenchmark)
> (timings <- microbenchmark(
>  normalizePath("\\\\some/network/drive", mustWork = FALSE),
>  times = 1e4,
>  unit  = "s"
> ))
> boxplot(timings)
> 
> Please can a few people run this code and see if they can reproduce the issue.
> 
> It isn't clear to me whether this is a bug in R or an underlying OS or
> network problem.
> 
> -- 
> Regards,
> Richie
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From axionator at gmail.com  Sun Sep  7 12:30:11 2014
From: axionator at gmail.com (axionator)
Date: Sun, 7 Sep 2014 12:30:11 +0200
Subject: [Rd] lbfgsb from C/C++
Message-ID: <CAGopM69bK3H+7MbOQroaMu-A8ydzOiXNY0sV+MR1ijzny_aBmA@mail.gmail.com>

Hi,

I would like to call R's lbfgsb function from my C/C++ code by including
R_ext/Applic.h and linking against libR.
Currently, I am allocating memory for x (and the other input arrays for
lbfgsb) in my C/C++ code via malloc/new. However, this gives a segmentation
fault when executing the program.
I tried to allocate x via PROTECT(x = NEW_NUMERIC(n)); x_p =
NUMERIC_POINTER(x);.
This compiles but also gives a segmentation fault.
Is there a way to use lbfgsb from C/C++ directly (without an intermediate
call of R)? Did I miss any compile flags?

Thanks

	[[alternative HTML version deleted]]


From edd at debian.org  Sun Sep  7 16:46:07 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 7 Sep 2014 09:46:07 -0500
Subject: [Rd] lbfgsb from C/C++
In-Reply-To: <CAGopM69bK3H+7MbOQroaMu-A8ydzOiXNY0sV+MR1ijzny_aBmA@mail.gmail.com>
References: <CAGopM69bK3H+7MbOQroaMu-A8ydzOiXNY0sV+MR1ijzny_aBmA@mail.gmail.com>
Message-ID: <21516.28591.514564.745946@max.nulle.part>


On 7 September 2014 at 12:30, axionator wrote:
| I would like to call R's lbfgsb function from my C/C++ code by including
| R_ext/Applic.h and linking against libR.
| Currently, I am allocating memory for x (and the other input arrays for
| lbfgsb) in my C/C++ code via malloc/new. However, this gives a segmentation
| fault when executing the program.
| I tried to allocate x via PROTECT(x = NEW_NUMERIC(n)); x_p =
| NUMERIC_POINTER(x);.
| This compiles but also gives a segmentation fault.
| Is there a way to use lbfgsb from C/C++ directly (without an intermediate
| call of R)? Did I miss any compile flags?

R is built to provide a 'language and environment', not a callable library.

There is a however an optional callable library with a (much smaller) subset
of functionality, see the section '6.16 Using these functions in your own C
code' in the 'Writing R Extension' manual.  However, the library does /not/
contain the bounded BFGS implementation you are seeking.

So you may want to look at another (open source) optmization library. NLopt
by Steven Johnson (http://ab-initio.mit.edu/wiki/index.php/NLopt) is decent
and easy to use; if you need LBFGSB there is also Jorge Nocedal's site
(http://www.ece.northwestern.edu/~nocedal/lbfgsb.html) as well as much more.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ligges at statistik.tu-dortmund.de  Sun Sep  7 18:03:30 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 07 Sep 2014 18:03:30 +0200
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
Message-ID: <540C81D2.3070307@statistik.tu-dortmund.de>



On 05.09.2014 20:25, Greg Snow wrote:
> Uwe,
>
> Have all of these packages found new maintainers? if not, which ones
> are still looking to be adopted?

Thanks for asking, the ones still looking to be adaopted are:
SemiPar cghseg monreg operators

Best,
Uwe Ligges


>
> thanks,
>
> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org> wrote:
>> Dear maintainers and R-devel,
>>
>> Several orphaned CRAN packages are about to be archived due to outstanding
>> QC problems, but have CRAN and BioC packages depending on them which would
>> be broken by the archival (and hence need archiving alongside).
>> Therefore we are looking for new maintainers taking over maintainership for
>> one or more of the following packages:
>>
>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>
>> Package maintainers whose packages depend on one of these may be natural
>> candidates to become new maintainers.
>> Hence this messages is addressed to all these maintainers via BCC and to
>> R-devel.
>>
>> See
>>
>>    <http://CRAN.R-project.org/package=R2HTML>
>>    <http://CRAN.R-project.org/package=SemiPar>
>>    <http://CRAN.R-project.org/package=cghseg>
>>    <http://CRAN.R-project.org/package=hexbin>
>>    <http://CRAN.R-project.org/package=lgtdl>
>>    <http://CRAN.R-project.org/package=monreg>
>>    <http://CRAN.R-project.org/package=muhaz>
>>    <http://CRAN.R-project.org/package=operators>
>>    <http://CRAN.R-project.org/package=pamr>
>>
>> for information on the QC issues and the reverse dependencies.
>>
>> Best wishes,
>> Uwe Ligges
>> (for the CRAN team)
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>


From romain at r-enthusiasts.com  Sun Sep  7 18:17:05 2014
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sun, 7 Sep 2014 18:17:05 +0200
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
	cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <540C81D2.3070307@statistik.tu-dortmund.de>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
Message-ID: <454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>

I'll pick up operators. 

Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a ?crit :

> 
> 
> On 05.09.2014 20:25, Greg Snow wrote:
>> Uwe,
>> 
>> Have all of these packages found new maintainers? if not, which ones
>> are still looking to be adopted?
> 
> Thanks for asking, the ones still looking to be adaopted are:
> SemiPar cghseg monreg operators
> 
> Best,
> Uwe Ligges
> 
> 
>> 
>> thanks,
>> 
>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org> wrote:
>>> Dear maintainers and R-devel,
>>> 
>>> Several orphaned CRAN packages are about to be archived due to outstanding
>>> QC problems, but have CRAN and BioC packages depending on them which would
>>> be broken by the archival (and hence need archiving alongside).
>>> Therefore we are looking for new maintainers taking over maintainership for
>>> one or more of the following packages:
>>> 
>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>> 
>>> Package maintainers whose packages depend on one of these may be natural
>>> candidates to become new maintainers.
>>> Hence this messages is addressed to all these maintainers via BCC and to
>>> R-devel.
>>> 
>>> See
>>> 
>>>   <http://CRAN.R-project.org/package=R2HTML>
>>>   <http://CRAN.R-project.org/package=SemiPar>
>>>   <http://CRAN.R-project.org/package=cghseg>
>>>   <http://CRAN.R-project.org/package=hexbin>
>>>   <http://CRAN.R-project.org/package=lgtdl>
>>>   <http://CRAN.R-project.org/package=monreg>
>>>   <http://CRAN.R-project.org/package=muhaz>
>>>   <http://CRAN.R-project.org/package=operators>
>>>   <http://CRAN.R-project.org/package=pamr>
>>> 
>>> for information on the QC issues and the reverse dependencies.
>>> 
>>> Best wishes,
>>> Uwe Ligges
>>> (for the CRAN team)
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hb at biostat.ucsf.edu  Sun Sep  7 22:15:18 2014
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Sun, 7 Sep 2014 13:15:18 -0700
Subject: [Rd] format(object.size(...), units): KB, MB, and GB instead of Kb,
 Mb, and Gb?
Message-ID: <CAFDcVCS4GW1xABXTY5Ct=-qv4GAUrJ=_7iWiBcZ1DBtBSHVLZQ@mail.gmail.com>

I cannot remember if this has already been discussed or not, and I'm a
bit worried I'm throwing off an endless debate.  If it's already
settled, no need to discuss it further.

TOPIC #1:
Shouldn't R use KB, MB and GB when reporting on sizes kilobytes,
megabytes and gigabytes?  More specifically, format() for object_size
objects (returned by object.size()) uses Kb, Mb and Gb, which AFAIK is
more often used to indicate sizes in kilobits, megabits and gigabits,
e.g.

> format(structure(2e3, class="object_size"), units="auto")
[1] "2 Kb"
> format(structure(2e6, class="object_size"), units="auto")
[1] "1.9 Mb"
> format(structure(2e9, class="object_size"), units="auto")
[1] "1.9 Gb"
> format(structure(2e12, class="object_size"), units="auto")
[1] "1862.6 Gb"

BTW, I suggest to add support for terabytes too (and maybe beyond);
we're soon/already there.


TOPIC #2:
There's also the decimal (1000^n) vs binary prefixes (1024^n)
standardization.  format() for object_size reports on 1024^n ones, cf.
utils:::format.object_size.  There are efforts to distinguish between
the two system, e.g. using KiB = 1024, MiB = 1024^2 bytes, GiB =
1024^3 bytes etc. (and KB, MB, GB for the decimal one).  However, the
KB, MB, GB is still widely used as binary prefixes when it comes to
reporting on memory and disk spaces.

The http://en.wikipedia.org/wiki/Binary_prefix page provides further
references on the above.


I don't worry to much about KiB vs KB since there is still a de facto
standard for KB etc., but to me using Kb when it should be KB seems
wrong.  Also, I have a hard time finding references to standards
suggesting Kb should be used instead of KB, but maybe I haven't looked
hard enough.

That's all.  Now, hit me back...

/Henrik


From andrezda10 at yandex.com  Sun Sep  7 23:43:10 2014
From: andrezda10 at yandex.com (=?utf-8?B?QW5kcsOpIFouIEQuIEEu?=)
Date: Sun, 07 Sep 2014 18:43:10 -0300
Subject: [Rd] format(object.size(...), units): KB, MB,
	and GB instead of Kb, Mb, and Gb?
Message-ID: <5184281410126190@web1g.yandex.ru>

Please change this. R should not confuse people with things that have some issues to be put in practice because of comercial (yes) strategies. I have been working in TI area for about 10 years. And have been studying computing related subjects for almost 15 years.

The use of KB, MB, ... as base 10 or base 2 units is confuse, a variable "standard" depending on the niche we look at. The units KiB, MiB, ... unambiguously address the issue. Flash and hard drives are sold with "16GB" meaning 16 x 1.000 x 1.000 to small profits and big confusion, just that (read Wikipedia article Henrik pointed).

The units KiB, MiB, ... exist for almost 10 years. But using "b" instead of "B" to indicate bytes is surely WRONG, very wrong! "b" is used to indicate bits, not bytes (this is IEEE standard). See http://en.wikipedia.org/wiki/Data_rate_units .

For base 10 multiples of any unit, the most reasonable thing is to follow the Metric prefixes.

See http://en.wikipedia.org/wiki/International_System_of_Units#Prefixes and http://en.wikipedia.org/wiki/Metric_prefix .

And since the computing world made the absurd choice of using the same symbols for different quantities (KB, MB), lets not make wrong and confusing things last longer. Right things, international standards, not "the facto" standards, and surely not using WRONG units, please.


From edd at debian.org  Mon Sep  8 00:05:57 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 7 Sep 2014 17:05:57 -0500
Subject: [Rd] lbfgsb from C/C++
In-Reply-To: <CAGopM6-CZq5eozcW-+FVGxcnFDv9UW2+WdHNZrZSR4nNRCgJRg@mail.gmail.com>
References: <CAGopM69bK3H+7MbOQroaMu-A8ydzOiXNY0sV+MR1ijzny_aBmA@mail.gmail.com>
	<21516.28591.514564.745946@max.nulle.part>
	<CAGopM6-CZq5eozcW-+FVGxcnFDv9UW2+WdHNZrZSR4nNRCgJRg@mail.gmail.com>
Message-ID: <21516.54981.48427.341836@max.nulle.part>


1)  Your question is no longer related to lbfgsb. It is common to start a
new thread with a new Subject: for new questions.

2)  You do not show your name or affiliation. That is generally frowned upon
around here.

3)  Your question was about RInside / Rcpp.  We prefer those questions over
on the rcpp-devel list.  Subscribe first in order to post.

4)  Your example is essentially identical to rinside_sample9.cpp for which a
patch / pull request was recently integrated.  This works with the current
sources (from Github) and the upcoming release.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From greg at warnes.net  Mon Sep  8 01:01:25 2014
From: greg at warnes.net (Gregory R. Warnes)
Date: Sun, 7 Sep 2014 19:01:25 -0400
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
	cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
Message-ID: <F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>

And I?ll pick up hexbin.

-Greg

On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com> wrote:

> I'll pick up operators. 
> 
> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a ?crit :
> 
>> 
>> 
>> On 05.09.2014 20:25, Greg Snow wrote:
>>> Uwe,
>>> 
>>> Have all of these packages found new maintainers? if not, which ones
>>> are still looking to be adopted?
>> 
>> Thanks for asking, the ones still looking to be adaopted are:
>> SemiPar cghseg monreg operators
>> 
>> Best,
>> Uwe Ligges
>> 
>> 
>>> 
>>> thanks,
>>> 
>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org> wrote:
>>>> Dear maintainers and R-devel,
>>>> 
>>>> Several orphaned CRAN packages are about to be archived due to outstanding
>>>> QC problems, but have CRAN and BioC packages depending on them which would
>>>> be broken by the archival (and hence need archiving alongside).
>>>> Therefore we are looking for new maintainers taking over maintainership for
>>>> one or more of the following packages:
>>>> 
>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>> 
>>>> Package maintainers whose packages depend on one of these may be natural
>>>> candidates to become new maintainers.
>>>> Hence this messages is addressed to all these maintainers via BCC and to
>>>> R-devel.
>>>> 
>>>> See
>>>> 
>>>>  <http://CRAN.R-project.org/package=R2HTML>
>>>>  <http://CRAN.R-project.org/package=SemiPar>
>>>>  <http://CRAN.R-project.org/package=cghseg>
>>>>  <http://CRAN.R-project.org/package=hexbin>
>>>>  <http://CRAN.R-project.org/package=lgtdl>
>>>>  <http://CRAN.R-project.org/package=monreg>
>>>>  <http://CRAN.R-project.org/package=muhaz>
>>>>  <http://CRAN.R-project.org/package=operators>
>>>>  <http://CRAN.R-project.org/package=pamr>
>>>> 
>>>> for information on the QC issues and the reverse dependencies.
>>>> 
>>>> Best wishes,
>>>> Uwe Ligges
>>>> (for the CRAN team)
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Mon Sep  8 01:03:06 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 08 Sep 2014 01:03:06 +0200
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>
Message-ID: <540CE42A.8090600@statistik.tu-dortmund.de>



On 08.09.2014 01:01, Gregory R. Warnes wrote:
> And I?ll pick up hexbin.

Err, that one has been adopted a month ago already.

open are:

SemiPar cghseg monreg


Best,
Uwe Ligges


>
> -Greg
>
> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com> wrote:
>
>> I'll pick up operators.
>>
>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a ?crit :
>>
>>>
>>>
>>> On 05.09.2014 20:25, Greg Snow wrote:
>>>> Uwe,
>>>>
>>>> Have all of these packages found new maintainers? if not, which ones
>>>> are still looking to be adopted?
>>>
>>> Thanks for asking, the ones still looking to be adaopted are:
>>> SemiPar cghseg monreg operators
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>>>
>>>> thanks,
>>>>
>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org> wrote:
>>>>> Dear maintainers and R-devel,
>>>>>
>>>>> Several orphaned CRAN packages are about to be archived due to outstanding
>>>>> QC problems, but have CRAN and BioC packages depending on them which would
>>>>> be broken by the archival (and hence need archiving alongside).
>>>>> Therefore we are looking for new maintainers taking over maintainership for
>>>>> one or more of the following packages:
>>>>>
>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>>>
>>>>> Package maintainers whose packages depend on one of these may be natural
>>>>> candidates to become new maintainers.
>>>>> Hence this messages is addressed to all these maintainers via BCC and to
>>>>> R-devel.
>>>>>
>>>>> See
>>>>>
>>>>>   <http://CRAN.R-project.org/package=R2HTML>
>>>>>   <http://CRAN.R-project.org/package=SemiPar>
>>>>>   <http://CRAN.R-project.org/package=cghseg>
>>>>>   <http://CRAN.R-project.org/package=hexbin>
>>>>>   <http://CRAN.R-project.org/package=lgtdl>
>>>>>   <http://CRAN.R-project.org/package=monreg>
>>>>>   <http://CRAN.R-project.org/package=muhaz>
>>>>>   <http://CRAN.R-project.org/package=operators>
>>>>>   <http://CRAN.R-project.org/package=pamr>
>>>>>
>>>>> for information on the QC issues and the reverse dependencies.
>>>>>
>>>>> Best wishes,
>>>>> Uwe Ligges
>>>>> (for the CRAN team)
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From skostysh at princeton.edu  Mon Sep  8 04:14:39 2014
From: skostysh at princeton.edu (Scott Kostyshak)
Date: Sun, 7 Sep 2014 22:14:39 -0400
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <540CE42A.8090600@statistik.tu-dortmund.de>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>
	<540CE42A.8090600@statistik.tu-dortmund.de>
Message-ID: <CAE3=dmdsc+_VhTo80vh_OrQs8gru+koq2rS1vOm1NcwTiH43Qg@mail.gmail.com>

On Sun, Sep 7, 2014 at 7:03 PM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> On 08.09.2014 01:01, Gregory R. Warnes wrote:
>>
>> And I?ll pick up hexbin.
>
>
> Err, that one has been adopted a month ago already.
>
> open are:
>
> SemiPar cghseg monreg

I will take monreg. Coincidentally my recent research is related.

Best,

Scott


--
Scott Kostyshak
Economics PhD Candidate
Princeton University

>
>
> Best,
> Uwe Ligges
>
>
>
>>
>> -Greg
>>
>> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com>
>> wrote:
>>
>>> I'll pick up operators.
>>>
>>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a
>>> ?crit :
>>>
>>>>
>>>>
>>>> On 05.09.2014 20:25, Greg Snow wrote:
>>>>>
>>>>> Uwe,
>>>>>
>>>>> Have all of these packages found new maintainers? if not, which ones
>>>>> are still looking to be adopted?
>>>>
>>>>
>>>> Thanks for asking, the ones still looking to be adaopted are:
>>>> SemiPar cghseg monreg operators
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>>>>
>>>>> thanks,
>>>>>
>>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org>
>>>>> wrote:
>>>>>>
>>>>>> Dear maintainers and R-devel,
>>>>>>
>>>>>> Several orphaned CRAN packages are about to be archived due to
>>>>>> outstanding
>>>>>> QC problems, but have CRAN and BioC packages depending on them which
>>>>>> would
>>>>>> be broken by the archival (and hence need archiving alongside).
>>>>>> Therefore we are looking for new maintainers taking over
>>>>>> maintainership for
>>>>>> one or more of the following packages:
>>>>>>
>>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>>>>
>>>>>> Package maintainers whose packages depend on one of these may be
>>>>>> natural
>>>>>> candidates to become new maintainers.
>>>>>> Hence this messages is addressed to all these maintainers via BCC and
>>>>>> to
>>>>>> R-devel.
>>>>>>
>>>>>> See
>>>>>>
>>>>>>   <http://CRAN.R-project.org/package=R2HTML>
>>>>>>   <http://CRAN.R-project.org/package=SemiPar>
>>>>>>   <http://CRAN.R-project.org/package=cghseg>
>>>>>>   <http://CRAN.R-project.org/package=hexbin>
>>>>>>   <http://CRAN.R-project.org/package=lgtdl>
>>>>>>   <http://CRAN.R-project.org/package=monreg>
>>>>>>   <http://CRAN.R-project.org/package=muhaz>
>>>>>>   <http://CRAN.R-project.org/package=operators>
>>>>>>   <http://CRAN.R-project.org/package=pamr>
>>>>>>
>>>>>> for information on the QC issues and the reverse dependencies.
>>>>>>
>>>>>> Best wishes,
>>>>>> Uwe Ligges
>>>>>> (for the CRAN team)
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From nashjc at uottawa.ca  Mon Sep  8 14:48:03 2014
From: nashjc at uottawa.ca (Prof J C Nash (U30A))
Date: Mon, 08 Sep 2014 08:48:03 -0400
Subject: [Rd] lbfgsb from C/C++
Message-ID: <540DA583.1080504@uottawa.ca>

I won't comment on the C/C++ option, as I'm not expert in that. However,
R users and developers should know that Nocedal et al. who developed
L-BFGS-B released an update to correct a fault in 2011. It was important
enough that an ACM TOMS article was used for the announcement.

I recently implemented a wrapper to the new Fortran code. As it is a
reverse communication code, the main task was getting rid of all the
Fortran WRITE() statements (not a happy experience!).

Maybe Dirk has ideas on how to make the wrapper more efficient and the
call from C or C++ direct for those who need that.

The code will be incorporated eventually in the optimx package, but for
now an experimental (NOTE - EXPERIMENTAL) version lbfgsb3 is up on
r-forge under the optimizer project. I'd be happy to exchange ideas
off-list on this.

Here's the reference to the TOMS announcement:

@Article{Morales:2011:FSL,
  author =       "Jos\'e Luis Morales and Jorge Nocedal",
  title =        "Remark on ``{Algorithm} 778: {L-BFGS-B}: {Fortran}
Subroutines
		  for Large-Scale Bound Constrained Optimization''",
  journal =      "{ACM} Transactions on Mathematical Software",
  accepted =     "15 April 2011",
  volume =       "38",
  number =       "1",
  month =        nov,
  URL =          "http://doi.acm.org/10.1145/2049662.2049669",
  pages =        "7:1--7:4",
  year =         "2011",
  abstract =     "
                 This remark describes an improvement and a correction
                 to Algorithm 778. It is shown that the performance of
                 the algorithm can be improved significantly by making
                 a relatively simple modification to the subspace
                 minimization phase. The correction concerns an error
                 caused by the use of routine dpmeps to estimate machine
                 precision.",
}

John Nash


From macqueen1 at llnl.gov  Mon Sep  8 18:06:21 2014
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 8 Sep 2014 16:06:21 +0000
Subject: [Rd] Problem with order() and I()
Message-ID: <D033220C.10A9C4%macqueen1@llnl.gov>

I have found that order() fails in a rather arcane circumstance, as in
this example:

> foo <- I( c('x','\265g') )
> order(foo)
Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed
> foo <-c('x','\265g')
> order(foo)
[1] 1 2



> sessionInfo()
R version 3.1.1 (2014-07-10)
Platform: x86_64-apple-darwin13.1.0 (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Thanks
-Don

p.s.
Just a little background, irrelevant unless one wonders why I?m using I()
and \265:

If I were writing new code I wouldn?t be using I(), since there are better
ways now to achieve the same end (preventing the creation of factors in
data frames), but the scripts that use it are quite old,  originally
developed in 2001.

In at least some but perhaps limited contexts, ?\265? produces the greek
letter mu, and that?s why I?m using it. And if I remember correctly, 2001
is prior to the current R support for locales and extended character sets.
Using \265 is what I could find at that time to get a mu into my output.

I came across this while checking some things; it?s not actually breaking
my scripts, so I doubt it?s due to any recent change.


-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062


From axionator at gmail.com  Sun Sep  7 18:58:49 2014
From: axionator at gmail.com (axionator)
Date: Sun, 7 Sep 2014 18:58:49 +0200
Subject: [Rd] lbfgsb from C/C++
In-Reply-To: <21516.28591.514564.745946@max.nulle.part>
References: <CAGopM69bK3H+7MbOQroaMu-A8ydzOiXNY0sV+MR1ijzny_aBmA@mail.gmail.com>
	<21516.28591.514564.745946@max.nulle.part>
Message-ID: <CAGopM6-CZq5eozcW-+FVGxcnFDv9UW2+WdHNZrZSR4nNRCgJRg@mail.gmail.com>

Ok. Another question: I wanted to use RInternal and compile the following
small test example:

#include <RInside.h>

const char* hello( std::string who ) {
        std::string result( "hello ") ;
        result += who ;
        return result.c_str() ;
}

int main(int argc, char *argv[]) {

    RInside R(argc, argv);

    R["hello"] = Rcpp::InternalFunction( &hello );
    std::string result = R.parseEval("hello('world')") ;
    std::cout << "hello( 'world') =  " << result << std::endl ;

    return 0;
}

However, I get:

In file included from
/usr/local/lib/R/site-library/Rcpp/include/Rcpp/storage/storage.h:4:0,
                 from
/usr/local/lib/R/site-library/Rcpp/include/RcppCommon.h:128,
                 from /usr/local/lib/R/site-library/Rcpp/include/Rcpp.h:27,
                 from
/usr/local/lib/R/site-library/RInside/include/RInsideCommon.h:38,
                 from
/usr/local/lib/R/site-library/RInside/include/RInside.h:26,
                 from testRInside.cpp:1:
/usr/local/lib/R/site-library/Rcpp/include/Rcpp/storage/PreserveStorage.h:
In instantiation of ?void Rcpp::PreserveStorage<CLASS>::set__(SEXP) [with
CLASS = Rcpp::InternalFunction_Impl<Rcpp::PreserveStorage>; SEXP =
SEXPREC*]?:
/usr/local/lib/R/site-library/Rcpp/include/Rcpp/InternalFunction.h:43:13:
required from ?void Rcpp::InternalFunction_Impl<StoragePolicy>::set(SEXP)
[with StoragePolicy = Rcpp::PreserveStorage; SEXP = SEXPREC*]?
/usr/local/lib/R/site-library/Rcpp/include/Rcpp/generated/InternalFunction__ctors.h:37:3:
  required from
?Rcpp::InternalFunction_Impl<StoragePolicy>::InternalFunction_Impl(OUT
(*)(U0)) [with OUT = const char*; U0 = std::basic_string<char>;
StoragePolicy = Rcpp::PreserveStorage]?
testRInside.cpp:16:49:   required from here
/usr/local/lib/R/site-library/Rcpp/include/Rcpp/storage/PreserveStorage.h:22:13:
error: ?class Rcpp::InternalFunction_Impl<Rcpp::PreserveStorage>? has no
member named ?update?

Any ideas what's going wrong?


On Sun, Sep 7, 2014 at 4:46 PM, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 7 September 2014 at 12:30, axionator wrote:
> | I would like to call R's lbfgsb function from my C/C++ code by including
> | R_ext/Applic.h and linking against libR.
> | Currently, I am allocating memory for x (and the other input arrays for
> | lbfgsb) in my C/C++ code via malloc/new. However, this gives a
> segmentation
> | fault when executing the program.
> | I tried to allocate x via PROTECT(x = NEW_NUMERIC(n)); x_p =
> | NUMERIC_POINTER(x);.
> | This compiles but also gives a segmentation fault.
> | Is there a way to use lbfgsb from C/C++ directly (without an intermediate
> | call of R)? Did I miss any compile flags?
>
> R is built to provide a 'language and environment', not a callable library.
>
> There is a however an optional callable library with a (much smaller)
> subset
> of functionality, see the section '6.16 Using these functions in your own C
> code' in the 'Writing R Extension' manual.  However, the library does /not/
> contain the bounded BFGS implementation you are seeking.
>
> So you may want to look at another (open source) optmization library. NLopt
> by Steven Johnson (http://ab-initio.mit.edu/wiki/index.php/NLopt) is
> decent
> and easy to use; if you need LBFGSB there is also Jorge Nocedal's site
> (http://www.ece.northwestern.edu/~nocedal/lbfgsb.html) as well as much
> more.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From wickedpuppy at gmail.com  Mon Sep  8 07:22:58 2014
From: wickedpuppy at gmail.com (billy am)
Date: Mon, 8 Sep 2014 13:22:58 +0800
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <CAE3=dmdsc+_VhTo80vh_OrQs8gru+koq2rS1vOm1NcwTiH43Qg@mail.gmail.com>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>
	<540CE42A.8090600@statistik.tu-dortmund.de>
	<CAE3=dmdsc+_VhTo80vh_OrQs8gru+koq2rS1vOm1NcwTiH43Qg@mail.gmail.com>
Message-ID: <CAJ_FNV5RM8VREeVTb9ujZKcm6EanyjtafeEwbmALh7=GLvucfQ@mail.gmail.com>

If no objections , I would like to volunteer for SemiPar.

Regards
Billy
On 8 Sep 2014 10:55, "Scott Kostyshak" <skostysh at princeton.edu> wrote:

> On Sun, Sep 7, 2014 at 7:03 PM, Uwe Ligges
> <ligges at statistik.tu-dortmund.de> wrote:
> >
> >
> > On 08.09.2014 01:01, Gregory R. Warnes wrote:
> >>
> >> And I?ll pick up hexbin.
> >
> >
> > Err, that one has been adopted a month ago already.
> >
> > open are:
> >
> > SemiPar cghseg monreg
>
> I will take monreg. Coincidentally my recent research is related.
>
> Best,
>
> Scott
>
>
> --
> Scott Kostyshak
> Economics PhD Candidate
> Princeton University
>
> >
> >
> > Best,
> > Uwe Ligges
> >
> >
> >
> >>
> >> -Greg
> >>
> >> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com>
> >> wrote:
> >>
> >>> I'll pick up operators.
> >>>
> >>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de>
> a
> >>> ?crit :
> >>>
> >>>>
> >>>>
> >>>> On 05.09.2014 20:25, Greg Snow wrote:
> >>>>>
> >>>>> Uwe,
> >>>>>
> >>>>> Have all of these packages found new maintainers? if not, which ones
> >>>>> are still looking to be adopted?
> >>>>
> >>>>
> >>>> Thanks for asking, the ones still looking to be adaopted are:
> >>>> SemiPar cghseg monreg operators
> >>>>
> >>>> Best,
> >>>> Uwe Ligges
> >>>>
> >>>>
> >>>>>
> >>>>> thanks,
> >>>>>
> >>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <
> Uwe.Ligges at r-project.org>
> >>>>> wrote:
> >>>>>>
> >>>>>> Dear maintainers and R-devel,
> >>>>>>
> >>>>>> Several orphaned CRAN packages are about to be archived due to
> >>>>>> outstanding
> >>>>>> QC problems, but have CRAN and BioC packages depending on them which
> >>>>>> would
> >>>>>> be broken by the archival (and hence need archiving alongside).
> >>>>>> Therefore we are looking for new maintainers taking over
> >>>>>> maintainership for
> >>>>>> one or more of the following packages:
> >>>>>>
> >>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
> >>>>>>
> >>>>>> Package maintainers whose packages depend on one of these may be
> >>>>>> natural
> >>>>>> candidates to become new maintainers.
> >>>>>> Hence this messages is addressed to all these maintainers via BCC
> and
> >>>>>> to
> >>>>>> R-devel.
> >>>>>>
> >>>>>> See
> >>>>>>
> >>>>>>   <http://CRAN.R-project.org/package=R2HTML>
> >>>>>>   <http://CRAN.R-project.org/package=SemiPar>
> >>>>>>   <http://CRAN.R-project.org/package=cghseg>
> >>>>>>   <http://CRAN.R-project.org/package=hexbin>
> >>>>>>   <http://CRAN.R-project.org/package=lgtdl>
> >>>>>>   <http://CRAN.R-project.org/package=monreg>
> >>>>>>   <http://CRAN.R-project.org/package=muhaz>
> >>>>>>   <http://CRAN.R-project.org/package=operators>
> >>>>>>   <http://CRAN.R-project.org/package=pamr>
> >>>>>>
> >>>>>> for information on the QC issues and the reverse dependencies.
> >>>>>>
> >>>>>> Best wishes,
> >>>>>> Uwe Ligges
> >>>>>> (for the CRAN team)
> >>>>>>
> >>>>>> ______________________________________________
> >>>>>> R-devel at r-project.org mailing list
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>
> >>>> ______________________________________________
> >>>> R-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >>
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From Philippe.GROSJEAN at umons.ac.be  Mon Sep  8 19:10:30 2014
From: Philippe.GROSJEAN at umons.ac.be (Philippe GROSJEAN)
Date: Mon, 8 Sep 2014 17:10:30 +0000
Subject: [Rd] r wiki
In-Reply-To: <540B2825.40403@statistik.tu-dortmund.de>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
Message-ID: <618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>

Uwe and all,

I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.

Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.

Best,

Philippe
..............................................<?}))><........
 ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
 ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
 ) ) ) ) )   Mons University, Belgium
( ( ( ( (
..............................................................

On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:

> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
> 
> Best,
> Uwe Ligges
> 
> 
> 
> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>> 
>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>> doku.php
>> 
>> And that wiki doesn't look like it had a lot of activity:
>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Mon Sep  8 21:59:54 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 8 Sep 2014 21:59:54 +0200
Subject: [Rd] r wiki
In-Reply-To: <618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
Message-ID: <540E0ABA.2010102@statistik.tu-dortmund.de>

Thank you, Philippe, for the explanation.

Yet again this shows that rather than discussing things in lots of 
messages, it is typically most helpful to ask the maintainer what is 
going on. The maintainer simply knows best...

Thanks again,
Uwe



On 08.09.2014 19:10, Philippe GROSJEAN wrote:
> Uwe and all,
>
> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>
> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>
> Best,
>
> Philippe
> ..............................................<?}))><........
>   ) ) ) ) )
> ( ( ( ( (    Prof. Philippe Grosjean
>   ) ) ) ) )
> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>   ) ) ) ) )   Mons University, Belgium
> ( ( ( ( (
> ..............................................................
>
> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>
>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>
>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>> doku.php
>>>
>>> And that wiki doesn't look like it had a lot of activity:
>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From xie at yihui.name  Mon Sep  8 22:15:45 2014
From: xie at yihui.name (Yihui Xie)
Date: Mon, 8 Sep 2014 15:15:45 -0500
Subject: [Rd] r wiki
In-Reply-To: <618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
Message-ID: <CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>

I want to make a humble suggestion: migrate the wiki to Github, and
build the pages using Jekyll+Markdown. That way, I think it will
attract more volunteers. Simply look how many pull requests that
Hadley has got for his up-coming book hosted on Github
(http://adv-r.had.co.nz): https://github.com/hadley/adv-r/pulls I have
had the experience of maintaining web servers and different wiki/CMS
systems (including Dokuwiki -- I have even written a PHP plugin for
it), and eventually I found I could not afford the time on the job of
a system admin. Now I never do that again, and I just focus on
maintaining the content. Let the professionals do the hosting and
compilation service, and my life has become so much better (no more
worries about security holes and attacks).

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Web: http://yihui.name


On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
<Philippe.GROSJEAN at umons.ac.be> wrote:
> Uwe and all,
>
> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>
> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>
> Best,
>
> Philippe
> ..............................................<?}))><........
>  ) ) ) ) )
> ( ( ( ( (    Prof. Philippe Grosjean
>  ) ) ) ) )
> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>  ) ) ) ) )   Mons University, Belgium
> ( ( ( ( (
> ..............................................................
>
> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>
>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>
>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>> doku.php
>>>
>>> And that wiki doesn't look like it had a lot of activity:
>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/


From csardi.gabor at gmail.com  Mon Sep  8 23:12:42 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 8 Sep 2014 17:12:42 -0400
Subject: [Rd] r wiki
In-Reply-To: <CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
Message-ID: <CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>

I second this suggestion.

One possible complication I see is that if you would like to run the R
code (to display its output for example), then AFAIK you cannot simply
use Jekyll on Github's side, but would need some additional
infrastructure.

It might be possible to use Travis (or some other) CI for it, and
avoid installing additional software and/or servers, but anyway, this
requires some care and effort.

If you don't want to run the code, then it is very easy, apart from
the (one-time) migration cost.

Best,
Gabor

On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie <xie at yihui.name> wrote:
> I want to make a humble suggestion: migrate the wiki to Github, and
> build the pages using Jekyll+Markdown. That way, I think it will
> attract more volunteers. Simply look how many pull requests that
> Hadley has got for his up-coming book hosted on Github
> (http://adv-r.had.co.nz): https://github.com/hadley/adv-r/pulls I have
> had the experience of maintaining web servers and different wiki/CMS
> systems (including Dokuwiki -- I have even written a PHP plugin for
> it), and eventually I found I could not afford the time on the job of
> a system admin. Now I never do that again, and I just focus on
> maintaining the content. Let the professionals do the hosting and
> compilation service, and my life has become so much better (no more
> worries about security holes and attacks).
>
> Regards,
> Yihui
> --
> Yihui Xie <xieyihui at gmail.com>
> Web: http://yihui.name
>
>
> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
> <Philippe.GROSJEAN at umons.ac.be> wrote:
>> Uwe and all,
>>
>> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>>
>> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>>
>> Best,
>>
>> Philippe
>> ..............................................<?}))><........
>>  ) ) ) ) )
>> ( ( ( ( (    Prof. Philippe Grosjean
>>  ) ) ) ) )
>> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>>  ) ) ) ) )   Mons University, Belgium
>> ( ( ( ( (
>> ..............................................................
>>
>> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>>
>>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>>
>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>>
>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>> doku.php
>>>>
>>>> And that wiki doesn't look like it had a lot of activity:
>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From deepayan.sarkar at gmail.com  Tue Sep  9 08:24:07 2014
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Tue, 9 Sep 2014 11:54:07 +0530
Subject: [Rd] [patch] Add support for editor function in edit.default
In-Reply-To: <CAE3=dmcNk_oSHdbKGjTAsCL0Kk6MDt+F-zeyn+KwG-myXUk9EQ@mail.gmail.com>
References: <CAE3=dmfOvQQPcWu8=5+_Nd-EXE8HAnywrT9g67pYfxBx0exWxQ@mail.gmail.com>
	<CAE3=dmcNk_oSHdbKGjTAsCL0Kk6MDt+F-zeyn+KwG-myXUk9EQ@mail.gmail.com>
Message-ID: <CADfFDC7p8QpFbyQvFMujxOT-E_zFGLZT3ecRgzBtuYLb1Ya8tw@mail.gmail.com>

On Sun, Aug 24, 2014 at 9:14 AM, Scott Kostyshak <skostysh at princeton.edu> wrote:
> On Tue, May 20, 2014 at 5:55 AM, Scott Kostyshak <skostysh at princeton.edu> wrote:
>> Regarding the following extract of ?options:
>>      ?editor?: a non-empty string, or a function that is called with a
>>           file path as argument.
>>
>> edit.default currently calls the function with three arguments: name,
>> file, and title. For example, running the following
>
> To be clear with what I view as problematic, note in the above that
> the documentation says the function is called with a file path as an
> argument, suggesting one argument; but in practice it is called with
> three arguments.
>
>> vimCmd <- 'vim -c "set ft=r"'
>> vimEdit <- function(file_) system(paste(vimCmd, file_))
>> options(editor = vimEdit)
>> myls <- edit(ls)
>>
>> gives "Error in editor(name, file, title) : unused arguments (file, title)".
>>
>> The attached patch changes edit.default to call the editor function
>> with just the file path. There is at least one inconsistent behavior
>> that this patch causes in its current form. It does not obey the
>> following (from ?edit):
>>      Calling ?edit()?, with no arguments, will result in the temporary
>> file being reopened for further editing.
>>
>> I see two ways to address this: (1) add a getEdFile() function to
>> utils/edit.R that calls a function getEd() defined in edit.c that
>> returns DefaultFileName; or (2) this patch could be rewritten in C in
>> a new function in edit.c.
>>
>> Is there any interest in this patch?
>> If not, would there be interest in an update of the docs, either
>> ?options (stating the possibility that if 'editor' is a function, it
>> might be called with 'name', 'file', and 'title' arguments) or ?edit
>>  ?
>
> Any interest in this patch? If not, would a patch for the
> documentation be considered?

Given that edit() itself is called with the three arguments, it seems
more general to pass them to the editor function, and I don't see the
need for a special case. You can always write your function as

vimEdit <- function(file_, ...) system(paste(vimCmd, file_))

I will clarify the documentation.

Best,
-Deepayan


From phgrosjean at sciviews.org  Tue Sep  9 08:45:14 2014
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Tue, 9 Sep 2014 08:45:14 +0200
Subject: [Rd] r wiki
In-Reply-To: <CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
Message-ID: <846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>

Yihui and G?bor,

I agree with you, and I also think that using Travis CI would be very nice. However, there are hundreds of page on the R wiki to migrate? and syntax is a little bit different than Markdown.

Of course, a solution would be to start again from scratch, but I think that those who have contributed to the R Wiki deserve more respect. Any suggestion, or idea about this?

Best, 

Philippe
On 08 Sep 2014, at 23:12, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:

> I second this suggestion.
> 
> One possible complication I see is that if you would like to run the R
> code (to display its output for example), then AFAIK you cannot simply
> use Jekyll on Github's side, but would need some additional
> infrastructure.
> 
> It might be possible to use Travis (or some other) CI for it, and
> avoid installing additional software and/or servers, but anyway, this
> requires some care and effort.
> 
> If you don't want to run the code, then it is very easy, apart from
> the (one-time) migration cost.
> 
> Best,
> Gabor
> 
> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie <xie at yihui.name> wrote:
>> I want to make a humble suggestion: migrate the wiki to Github, and
>> build the pages using Jekyll+Markdown. That way, I think it will
>> attract more volunteers. Simply look how many pull requests that
>> Hadley has got for his up-coming book hosted on Github
>> (http://adv-r.had.co.nz): https://github.com/hadley/adv-r/pulls I have
>> had the experience of maintaining web servers and different wiki/CMS
>> systems (including Dokuwiki -- I have even written a PHP plugin for
>> it), and eventually I found I could not afford the time on the job of
>> a system admin. Now I never do that again, and I just focus on
>> maintaining the content. Let the professionals do the hosting and
>> compilation service, and my life has become so much better (no more
>> worries about security holes and attacks).
>> 
>> Regards,
>> Yihui
>> --
>> Yihui Xie <xieyihui at gmail.com>
>> Web: http://yihui.name
>> 
>> 
>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
>> <Philippe.GROSJEAN at umons.ac.be> wrote:
>>> Uwe and all,
>>> 
>>> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>>> 
>>> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>>> 
>>> Best,
>>> 
>>> Philippe
>>> ..............................................<?}))><........
>>> ) ) ) ) )
>>> ( ( ( ( (    Prof. Philippe Grosjean
>>> ) ) ) ) )
>>> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>>> ) ) ) ) )   Mons University, Belgium
>>> ( ( ( ( (
>>> ..............................................................
>>> 
>>> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>>> 
>>>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>>> 
>>>> Best,
>>>> Uwe Ligges
>>>> 
>>>> 
>>>> 
>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>>> 
>>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>>> doku.php
>>>>> 
>>>>> And that wiki doesn't look like it had a lot of activity:
>>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From skostysh at princeton.edu  Tue Sep  9 09:15:47 2014
From: skostysh at princeton.edu (Scott Kostyshak)
Date: Tue, 9 Sep 2014 03:15:47 -0400
Subject: [Rd] [patch] Add support for editor function in edit.default
In-Reply-To: <CADfFDC7p8QpFbyQvFMujxOT-E_zFGLZT3ecRgzBtuYLb1Ya8tw@mail.gmail.com>
References: <CAE3=dmfOvQQPcWu8=5+_Nd-EXE8HAnywrT9g67pYfxBx0exWxQ@mail.gmail.com>
	<CAE3=dmcNk_oSHdbKGjTAsCL0Kk6MDt+F-zeyn+KwG-myXUk9EQ@mail.gmail.com>
	<CADfFDC7p8QpFbyQvFMujxOT-E_zFGLZT3ecRgzBtuYLb1Ya8tw@mail.gmail.com>
Message-ID: <CAE3=dmcAoNVCmDYSkVtOiBe_DQJPK5v0yiT3dMrCaSddujNnzA@mail.gmail.com>

On Tue, Sep 9, 2014 at 2:24 AM, Deepayan Sarkar
<deepayan.sarkar at gmail.com> wrote:
> On Sun, Aug 24, 2014 at 9:14 AM, Scott Kostyshak <skostysh at princeton.edu> wrote:
>> On Tue, May 20, 2014 at 5:55 AM, Scott Kostyshak <skostysh at princeton.edu> wrote:
>>> Regarding the following extract of ?options:
>>>      ?editor?: a non-empty string, or a function that is called with a
>>>           file path as argument.
>>>
>>> edit.default currently calls the function with three arguments: name,
>>> file, and title. For example, running the following
>>
>> To be clear with what I view as problematic, note in the above that
>> the documentation says the function is called with a file path as an
>> argument, suggesting one argument; but in practice it is called with
>> three arguments.
>>
>>> vimCmd <- 'vim -c "set ft=r"'
>>> vimEdit <- function(file_) system(paste(vimCmd, file_))
>>> options(editor = vimEdit)
>>> myls <- edit(ls)
>>>
>>> gives "Error in editor(name, file, title) : unused arguments (file, title)".
>>>
>>> The attached patch changes edit.default to call the editor function
>>> with just the file path. There is at least one inconsistent behavior
>>> that this patch causes in its current form. It does not obey the
>>> following (from ?edit):
>>>      Calling ?edit()?, with no arguments, will result in the temporary
>>> file being reopened for further editing.
>>>
>>> I see two ways to address this: (1) add a getEdFile() function to
>>> utils/edit.R that calls a function getEd() defined in edit.c that
>>> returns DefaultFileName; or (2) this patch could be rewritten in C in
>>> a new function in edit.c.
>>>
>>> Is there any interest in this patch?
>>> If not, would there be interest in an update of the docs, either
>>> ?options (stating the possibility that if 'editor' is a function, it
>>> might be called with 'name', 'file', and 'title' arguments) or ?edit
>>>  ?
>>
>> Any interest in this patch? If not, would a patch for the
>> documentation be considered?
>
> Given that edit() itself is called with the three arguments, it seems
> more general to pass them to the editor function, and I don't see the
> need for a special case. You can always write your function as
>
> vimEdit <- function(file_, ...) system(paste(vimCmd, file_))

Indeed, makes sense.

> I will clarify the documentation.

Great. Thanks a lot for taking the time to understand the issue.

Best,

Scott


--
Scott Kostyshak
Economics PhD Candidate
Princeton University


From drwolf85 at gmail.com  Tue Sep  9 09:52:47 2014
From: drwolf85 at gmail.com (Luca Sartore)
Date: Tue, 9 Sep 2014 09:52:47 +0200
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <540CE42A.8090600@statistik.tu-dortmund.de>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>
	<540CE42A.8090600@statistik.tu-dortmund.de>
Message-ID: <CAAvavh4JNsnCbuweKvEFhco13DKr3YyWMaHRCKqD2oKry0A6Zw@mail.gmail.com>

Dear all,

I will pick up monreg.

Best regards,
Luca Sartore


2014-09-08 1:03 GMT+02:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>
> On 08.09.2014 01:01, Gregory R. Warnes wrote:
>>
>> And I?ll pick up hexbin.
>
>
> Err, that one has been adopted a month ago already.
>
> open are:
>
> SemiPar cghseg monreg
>
>
> Best,
> Uwe Ligges
>
>
>>
>> -Greg
>>
>> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com>
>> wrote:
>>
>>> I'll pick up operators.
>>>
>>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a
>>> ?crit :
>>>
>>>>
>>>>
>>>> On 05.09.2014 20:25, Greg Snow wrote:
>>>>>
>>>>> Uwe,
>>>>>
>>>>> Have all of these packages found new maintainers? if not, which ones
>>>>> are still looking to be adopted?
>>>>
>>>>
>>>> Thanks for asking, the ones still looking to be adaopted are:
>>>> SemiPar cghseg monreg operators
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>>>>
>>>>> thanks,
>>>>>
>>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org>
>>>>> wrote:
>>>>>>
>>>>>> Dear maintainers and R-devel,
>>>>>>
>>>>>> Several orphaned CRAN packages are about to be archived due to
>>>>>> outstanding
>>>>>> QC problems, but have CRAN and BioC packages depending on them which
>>>>>> would
>>>>>> be broken by the archival (and hence need archiving alongside).
>>>>>> Therefore we are looking for new maintainers taking over
>>>>>> maintainership for
>>>>>> one or more of the following packages:
>>>>>>
>>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>>>>
>>>>>> Package maintainers whose packages depend on one of these may be
>>>>>> natural
>>>>>> candidates to become new maintainers.
>>>>>> Hence this messages is addressed to all these maintainers via BCC and
>>>>>> to
>>>>>> R-devel.
>>>>>>
>>>>>> See
>>>>>>
>>>>>>   <http://CRAN.R-project.org/package=R2HTML>
>>>>>>   <http://CRAN.R-project.org/package=SemiPar>
>>>>>>   <http://CRAN.R-project.org/package=cghseg>
>>>>>>   <http://CRAN.R-project.org/package=hexbin>
>>>>>>   <http://CRAN.R-project.org/package=lgtdl>
>>>>>>   <http://CRAN.R-project.org/package=monreg>
>>>>>>   <http://CRAN.R-project.org/package=muhaz>
>>>>>>   <http://CRAN.R-project.org/package=operators>
>>>>>>   <http://CRAN.R-project.org/package=pamr>
>>>>>>
>>>>>> for information on the QC issues and the reverse dependencies.
>>>>>>
>>>>>> Best wishes,
>>>>>> Uwe Ligges
>>>>>> (for the CRAN team)
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Tue Sep  9 13:39:09 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 9 Sep 2014 07:39:09 -0400
Subject: [Rd] r wiki
In-Reply-To: <846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
References: <6604241409959069@web8j.yandex.ru>	<540B2825.40403@statistik.tu-dortmund.de>	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
Message-ID: <540EE6DD.5050607@gmail.com>

On 09/09/2014, 2:45 AM, Philippe Grosjean wrote:
> Yihui and G?bor,
> 
> I agree with you, and I also think that using Travis CI would be very nice. However, there are hundreds of page on the R wiki to migrate? and syntax is a little bit different than Markdown.
> 
> Of course, a solution would be to start again from scratch, but I think that those who have contributed to the R Wiki deserve more respect. Any suggestion, or idea about this?

It's often not hard to write a simple parser for markup languages like
this, and then you can parse the original and rewrite the equivalent new
markup.  If the markup is only a "little bit" different than Markdown,
you can ignore all the similar bits, and only worry about parsing the
different parts.  (And if the parsing isn't perfect, it may be that
manual tweaking isn't so hard.)

Of course, you did also say something about being "very busy with exams
+ Master and PhD theses", so now might not be the time...

Duncan


> 
> Best, 
> 
> Philippe
> On 08 Sep 2014, at 23:12, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> 
>> I second this suggestion.
>>
>> One possible complication I see is that if you would like to run the R
>> code (to display its output for example), then AFAIK you cannot simply
>> use Jekyll on Github's side, but would need some additional
>> infrastructure.
>>
>> It might be possible to use Travis (or some other) CI for it, and
>> avoid installing additional software and/or servers, but anyway, this
>> requires some care and effort.
>>
>> If you don't want to run the code, then it is very easy, apart from
>> the (one-time) migration cost.
>>
>> Best,
>> Gabor
>>
>> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie <xie at yihui.name> wrote:
>>> I want to make a humble suggestion: migrate the wiki to Github, and
>>> build the pages using Jekyll+Markdown. That way, I think it will
>>> attract more volunteers. Simply look how many pull requests that
>>> Hadley has got for his up-coming book hosted on Github
>>> (http://adv-r.had.co.nz): https://github.com/hadley/adv-r/pulls I have
>>> had the experience of maintaining web servers and different wiki/CMS
>>> systems (including Dokuwiki -- I have even written a PHP plugin for
>>> it), and eventually I found I could not afford the time on the job of
>>> a system admin. Now I never do that again, and I just focus on
>>> maintaining the content. Let the professionals do the hosting and
>>> compilation service, and my life has become so much better (no more
>>> worries about security holes and attacks).
>>>
>>> Regards,
>>> Yihui
>>> --
>>> Yihui Xie <xieyihui at gmail.com>
>>> Web: http://yihui.name
>>>
>>>
>>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
>>> <Philippe.GROSJEAN at umons.ac.be> wrote:
>>>> Uwe and all,
>>>>
>>>> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>>>>
>>>> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>>>>
>>>> Best,
>>>>
>>>> Philippe
>>>> ..............................................<?}))><........
>>>> ) ) ) ) )
>>>> ( ( ( ( (    Prof. Philippe Grosjean
>>>> ) ) ) ) )
>>>> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>>>> ) ) ) ) )   Mons University, Belgium
>>>> ( ( ( ( (
>>>> ..............................................................
>>>>
>>>> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>>>>
>>>>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>
>>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>>>>
>>>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>>>> doku.php
>>>>>>
>>>>>> And that wiki doesn't look like it had a lot of activity:
>>>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From phgrosjean at sciviews.org  Tue Sep  9 14:14:18 2014
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Tue, 9 Sep 2014 14:14:18 +0200
Subject: [Rd] r wiki
In-Reply-To: <540EE6DD.5050607@gmail.com>
References: <6604241409959069@web8j.yandex.ru>	<540B2825.40403@statistik.tu-dortmund.de>	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
	<540EE6DD.5050607@gmail.com>
Message-ID: <EB8A4635-18D9-4F16-B976-60EABE991410@sciviews.org>


On 09 Sep 2014, at 13:39, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> On 09/09/2014, 2:45 AM, Philippe Grosjean wrote:
>> Yihui and G?bor,
>> 
>> I agree with you, and I also think that using Travis CI would be very nice. However, there are hundreds of page on the R wiki to migrate? and syntax is a little bit different than Markdown.
>> 
>> Of course, a solution would be to start again from scratch, but I think that those who have contributed to the R Wiki deserve more respect. Any suggestion, or idea about this?
> 
> It's often not hard to write a simple parser for markup languages like
> this, and then you can parse the original and rewrite the equivalent new
> markup.  If the markup is only a "little bit" different than Markdown,
> you can ignore all the similar bits, and only worry about parsing the
> different parts.  (And if the parsing isn't perfect, it may be that
> manual tweaking isn't so hard.)
> 
Yes, you are right. I have looked at Pandoc, but it only supports DokuWiki in output, not in input.


> Of course, you did also say something about being "very busy with exams
> + Master and PhD theses", so now might not be the time?
> 
Indeed,? unless there are volunteers over there to help?

Philippe

> Duncan
> 
> 
>> 
>> Best, 
>> 
>> Philippe
>> On 08 Sep 2014, at 23:12, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>> 
>>> I second this suggestion.
>>> 
>>> One possible complication I see is that if you would like to run the R
>>> code (to display its output for example), then AFAIK you cannot simply
>>> use Jekyll on Github's side, but would need some additional
>>> infrastructure.
>>> 
>>> It might be possible to use Travis (or some other) CI for it, and
>>> avoid installing additional software and/or servers, but anyway, this
>>> requires some care and effort.
>>> 
>>> If you don't want to run the code, then it is very easy, apart from
>>> the (one-time) migration cost.
>>> 
>>> Best,
>>> Gabor
>>> 
>>> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie <xie at yihui.name> wrote:
>>>> I want to make a humble suggestion: migrate the wiki to Github, and
>>>> build the pages using Jekyll+Markdown. That way, I think it will
>>>> attract more volunteers. Simply look how many pull requests that
>>>> Hadley has got for his up-coming book hosted on Github
>>>> (http://adv-r.had.co.nz): https://github.com/hadley/adv-r/pulls I have
>>>> had the experience of maintaining web servers and different wiki/CMS
>>>> systems (including Dokuwiki -- I have even written a PHP plugin for
>>>> it), and eventually I found I could not afford the time on the job of
>>>> a system admin. Now I never do that again, and I just focus on
>>>> maintaining the content. Let the professionals do the hosting and
>>>> compilation service, and my life has become so much better (no more
>>>> worries about security holes and attacks).
>>>> 
>>>> Regards,
>>>> Yihui
>>>> --
>>>> Yihui Xie <xieyihui at gmail.com>
>>>> Web: http://yihui.name
>>>> 
>>>> 
>>>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
>>>> <Philippe.GROSJEAN at umons.ac.be> wrote:
>>>>> Uwe and all,
>>>>> 
>>>>> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>>>>> 
>>>>> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>>>>> 
>>>>> Best,
>>>>> 
>>>>> Philippe
>>>>> ..............................................<?}))><........
>>>>> ) ) ) ) )
>>>>> ( ( ( ( (    Prof. Philippe Grosjean
>>>>> ) ) ) ) )
>>>>> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>>>>> ) ) ) ) )   Mons University, Belgium
>>>>> ( ( ( ( (
>>>>> ..............................................................
>>>>> 
>>>>> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>>>>> 
>>>>>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>>>>> 
>>>>>> Best,
>>>>>> Uwe Ligges
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>>>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>>>>> 
>>>>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>>>>> doku.php
>>>>>>> 
>>>>>>> And that wiki doesn't look like it had a lot of activity:
>>>>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From phgrosjean at sciviews.org  Tue Sep  9 14:16:42 2014
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Tue, 9 Sep 2014 14:16:42 +0200
Subject: [Rd] r wiki
In-Reply-To: <EB8A4635-18D9-4F16-B976-60EABE991410@sciviews.org>
References: <6604241409959069@web8j.yandex.ru>	<540B2825.40403@statistik.tu-dortmund.de>	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
	<540EE6DD.5050607@gmail.com>
	<EB8A4635-18D9-4F16-B976-60EABE991410@sciviews.org>
Message-ID: <2F932BAA-6AE4-4C07-BBF2-537539783EE4@sciviews.org>


On 09 Sep 2014, at 14:14, Philippe Grosjean <phgrosjean at sciviews.org> wrote:

> 
> On 09 Sep 2014, at 13:39, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 09/09/2014, 2:45 AM, Philippe Grosjean wrote:
>>> Yihui and G?bor,
>>> 
>>> I agree with you, and I also think that using Travis CI would be very nice. However, there are hundreds of page on the R wiki to migrate? and syntax is a little bit different than Markdown.
>>> 
>>> Of course, a solution would be to start again from scratch, but I think that those who have contributed to the R Wiki deserve more respect. Any suggestion, or idea about this?
>> 
>> It's often not hard to write a simple parser for markup languages like
>> this, and then you can parse the original and rewrite the equivalent new
>> markup.  If the markup is only a "little bit" different than Markdown,
>> you can ignore all the similar bits, and only worry about parsing the
>> different parts.  (And if the parsing isn't perfect, it may be that
>> manual tweaking isn't so hard.)
>> 
> Yes, you are right. I have looked at Pandoc, but it only supports DokuWiki in output, not in input.

Oh, by the way, I found this one: https://github.com/ludoza/DokuWiki-to-Markdown-Converter

PhG

> 
> 
>> Of course, you did also say something about being "very busy with exams
>> + Master and PhD theses", so now might not be the time?
>> 
> Indeed,? unless there are volunteers over there to help?
> 
> Philippe
> 
>> Duncan
>> 
>> 
>>> 
>>> Best, 
>>> 
>>> Philippe
>>> On 08 Sep 2014, at 23:12, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>>> 
>>>> I second this suggestion.
>>>> 
>>>> One possible complication I see is that if you would like to run the R
>>>> code (to display its output for example), then AFAIK you cannot simply
>>>> use Jekyll on Github's side, but would need some additional
>>>> infrastructure.
>>>> 
>>>> It might be possible to use Travis (or some other) CI for it, and
>>>> avoid installing additional software and/or servers, but anyway, this
>>>> requires some care and effort.
>>>> 
>>>> If you don't want to run the code, then it is very easy, apart from
>>>> the (one-time) migration cost.
>>>> 
>>>> Best,
>>>> Gabor
>>>> 
>>>> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie <xie at yihui.name> wrote:
>>>>> I want to make a humble suggestion: migrate the wiki to Github, and
>>>>> build the pages using Jekyll+Markdown. That way, I think it will
>>>>> attract more volunteers. Simply look how many pull requests that
>>>>> Hadley has got for his up-coming book hosted on Github
>>>>> (http://adv-r.had.co.nz): https://github.com/hadley/adv-r/pulls I have
>>>>> had the experience of maintaining web servers and different wiki/CMS
>>>>> systems (including Dokuwiki -- I have even written a PHP plugin for
>>>>> it), and eventually I found I could not afford the time on the job of
>>>>> a system admin. Now I never do that again, and I just focus on
>>>>> maintaining the content. Let the professionals do the hosting and
>>>>> compilation service, and my life has become so much better (no more
>>>>> worries about security holes and attacks).
>>>>> 
>>>>> Regards,
>>>>> Yihui
>>>>> --
>>>>> Yihui Xie <xieyihui at gmail.com>
>>>>> Web: http://yihui.name
>>>>> 
>>>>> 
>>>>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
>>>>> <Philippe.GROSJEAN at umons.ac.be> wrote:
>>>>>> Uwe and all,
>>>>>> 
>>>>>> I have problems with the R wiki engine. It seems that there is a systematic attack of the R wiki site that produces an overconsumption of the server's CPU, and consequently, my provider did shutdown the whole SciViews.org web site.
>>>>>> 
>>>>>> Now, it is a bad time for me to work on this (very busy with exams + Master and PhD theses). I am currently looking for an expert in CMS to look at the problem. I don't know when I will be able to solve this and reopen the R Wiki.
>>>>>> 
>>>>>> Best,
>>>>>> 
>>>>>> Philippe
>>>>>> ..............................................<?}))><........
>>>>>> ) ) ) ) )
>>>>>> ( ( ( ( (    Prof. Philippe Grosjean
>>>>>> ) ) ) ) )
>>>>>> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>>>>>> ) ) ) ) )   Mons University, Belgium
>>>>>> ( ( ( ( (
>>>>>> ..............................................................
>>>>>> 
>>>>>> On 06 Sep 2014, at 17:28, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>>>>>> 
>>>>>>> Rather than asking here, I'd ask Philippe Grosjean directly, hence CCIng.
>>>>>>> 
>>>>>>> Best,
>>>>>>> Uwe Ligges
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>>>>>> This does not answer you, but if you are looking for something that existed on that wiki, it may help:
>>>>>>>> 
>>>>>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>>>>>> doku.php
>>>>>>>> 
>>>>>>>> And that wiki doesn't look like it had a lot of activity:
>>>>>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>>>>> 
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 


From csardi.gabor at gmail.com  Tue Sep  9 14:34:51 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 9 Sep 2014 08:34:51 -0400
Subject: [Rd] r wiki
In-Reply-To: <2F932BAA-6AE4-4C07-BBF2-537539783EE4@sciviews.org>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
	<540EE6DD.5050607@gmail.com>
	<EB8A4635-18D9-4F16-B976-60EABE991410@sciviews.org>
	<2F932BAA-6AE4-4C07-BBF2-537539783EE4@sciviews.org>
Message-ID: <CABtg=KkJAvAKem_zZjaEzH9DE3wMNyiUe+7P_CyNWR4qKe2Gnw@mail.gmail.com>

[...]
>> Yes, you are right. I have looked at Pandoc, but it only supports DokuWiki in output, not in input.
>
> Oh, by the way, I found this one: https://github.com/ludoza/DokuWiki-to-Markdown-Converter
>
> PhG

An probably you can keep the full history as well:
https://github.com/hoxu/dokuwiki2git

Gabor

[...]


From maechler at stat.math.ethz.ch  Tue Sep  9 15:48:10 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 9 Sep 2014 15:48:10 +0200
Subject: [Rd] r wiki
In-Reply-To: <846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
Message-ID: <21519.1306.551292.683057@stat.math.ethz.ch>

>>>>> Philippe Grosjean <phgrosjean at sciviews.org>
>>>>>     on Tue, 9 Sep 2014 08:45:14 +0200 writes:

    > Yihui and G?bor, I agree with you, and I also think that
    > using Travis CI would be very nice. However, there are
    > hundreds of page on the R wiki to migrate? and syntax is a
    > little bit different than Markdown.

    > Of course, a solution would be to start again from
    > scratch, but I think that those who have contributed to
    > the R Wiki deserve more respect. Any suggestion, or idea
    > about this?

(and we have seen more on this thread ..)

As one contributor to the former wiki and maintainer of the
good olde mailing lists, I completely agree (with
Yihui and G?bor and you) that it's best to move it over to an
infrastructure which takes care of authentication of legitimate
users and protection from thieves burglers, spammers, and the like.  

Markdown is definitely much better for R users (given knittr and
Rmd ..), and github is currently the place to host -- and once
it ceases to be that, markdown will be easier to migrate from.

Martin

    > Best,

    > Philippe On 08 Sep 2014, at 23:12, G?bor Cs?rdi
    > <csardi.gabor at gmail.com> wrote:

    >> I second this suggestion.
    >> 
    >> One possible complication I see is that if you would like
    >> to run the R code (to display its output for example),
    >> then AFAIK you cannot simply use Jekyll on Github's side,
    >> but would need some additional infrastructure.
    >> 
    >> It might be possible to use Travis (or some other) CI for
    >> it, and avoid installing additional software and/or
    >> servers, but anyway, this requires some care and effort.
    >> 
    >> If you don't want to run the code, then it is very easy,
    >> apart from the (one-time) migration cost.
    >> 
    >> Best, Gabor
    >> 
    >> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie
    >> <xie at yihui.name> wrote:
    >>> I want to make a humble suggestion: migrate the wiki to
    >>> Github, and build the pages using Jekyll+Markdown. That
    >>> way, I think it will attract more volunteers. Simply
    >>> look how many pull requests that Hadley has got for his
    >>> up-coming book hosted on Github
    >>> (http://adv-r.had.co.nz):
    >>> https://github.com/hadley/adv-r/pulls I have had the
    >>> experience of maintaining web servers and different
    >>> wiki/CMS systems (including Dokuwiki -- I have even
    >>> written a PHP plugin for it), and eventually I found I
    >>> could not afford the time on the job of a system
    >>> admin. Now I never do that again, and I just focus on
    >>> maintaining the content. Let the professionals do the
    >>> hosting and compilation service, and my life has become
    >>> so much better (no more worries about security holes and
    >>> attacks).
    >>> 
    >>> Regards, Yihui
    >>> --
    >>> Yihui Xie <xieyihui at gmail.com> Web: http://yihui.name
    >>> 
    >>> 
    >>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
    >>> <Philippe.GROSJEAN at umons.ac.be> wrote:
    >>>> Uwe and all,
    >>>> 
    >>>> I have problems with the R wiki engine. It seems that
    >>>> there is a systematic attack of the R wiki site that
    >>>> produces an overconsumption of the server's CPU, and
    >>>> consequently, my provider did shutdown the whole
    >>>> SciViews.org web site.
    >>>> 
    >>>> Now, it is a bad time for me to work on this (very busy
    >>>> with exams + Master and PhD theses). I am currently
    >>>> looking for an expert in CMS to look at the problem. I
    >>>> don't know when I will be able to solve this and reopen
    >>>> the R Wiki.
    >>>> 
    >>>> Best,
    >>>> 
    >>>> Philippe
    >>>> ..............................................<?}))><........
    >>>> ) ) ) ) ) ( ( ( ( ( Prof. Philippe Grosjean ) ) ) ) ) (
    >>>> ( ( ( ( Numerical Ecology of Aquatic Systems ) ) ) ) )
    >>>> Mons University, Belgium ( ( ( ( (
    >>>> ..............................................................
    >>>> 
    >>>> On 06 Sep 2014, at 17:28, Uwe Ligges
    >>>> <ligges at statistik.tu-dortmund.de> wrote:
    >>>> 
    >>>>> Rather than asking here, I'd ask Philippe Grosjean
    >>>>> directly, hence CCIng.
    >>>>> 
    >>>>> Best, Uwe Ligges
    >>>>> 
    >>>>> 
    >>>>> 
    >>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>>> This does not answer you, but if you are looking for
    >>>>> something that existed on that wiki, it may help:
>>>>> 
>>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>>> doku.php
>>>>> 
>>>>> And that wiki doesn't look like it had a lot of activity:
>>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
    >>> 
    >>> ______________________________________________
    >>> R-devel at r-project.org mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Tue Sep  9 15:53:12 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 09 Sep 2014 15:53:12 +0200
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <CAAvavh4JNsnCbuweKvEFhco13DKr3YyWMaHRCKqD2oKry0A6Zw@mail.gmail.com>
References: <53E4FDA9.70903@R-project.org>	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>	<540C81D2.3070307@statistik.tu-dortmund.de>	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>	<540CE42A.8090600@statistik.tu-dortmund.de>
	<CAAvavh4JNsnCbuweKvEFhco13DKr3YyWMaHRCKqD2oKry0A6Zw@mail.gmail.com>
Message-ID: <540F0648.9040504@statistik.tu-dortmund.de>



On 09.09.2014 09:52, Luca Sartore wrote:
> Dear all,
>
> I will pick up monreg.

Please try to coordinate efforts with Scott Kostyshak  who offered the 
same thing yesterday.

Best,
Uwe Ligges



> Best regards,
> Luca Sartore
>
>
> 2014-09-08 1:03 GMT+02:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>
>>
>> On 08.09.2014 01:01, Gregory R. Warnes wrote:
>>>
>>> And I?ll pick up hexbin.
>>
>>
>> Err, that one has been adopted a month ago already.
>>
>> open are:
>>
>> SemiPar cghseg monreg
>>
>>
>> Best,
>> Uwe Ligges
>>
>>
>>>
>>> -Greg
>>>
>>> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com>
>>> wrote:
>>>
>>>> I'll pick up operators.
>>>>
>>>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a
>>>> ?crit :
>>>>
>>>>>
>>>>>
>>>>> On 05.09.2014 20:25, Greg Snow wrote:
>>>>>>
>>>>>> Uwe,
>>>>>>
>>>>>> Have all of these packages found new maintainers? if not, which ones
>>>>>> are still looking to be adopted?
>>>>>
>>>>>
>>>>> Thanks for asking, the ones still looking to be adaopted are:
>>>>> SemiPar cghseg monreg operators
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>>
>>>>>> thanks,
>>>>>>
>>>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org>
>>>>>> wrote:
>>>>>>>
>>>>>>> Dear maintainers and R-devel,
>>>>>>>
>>>>>>> Several orphaned CRAN packages are about to be archived due to
>>>>>>> outstanding
>>>>>>> QC problems, but have CRAN and BioC packages depending on them which
>>>>>>> would
>>>>>>> be broken by the archival (and hence need archiving alongside).
>>>>>>> Therefore we are looking for new maintainers taking over
>>>>>>> maintainership for
>>>>>>> one or more of the following packages:
>>>>>>>
>>>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>>>>>
>>>>>>> Package maintainers whose packages depend on one of these may be
>>>>>>> natural
>>>>>>> candidates to become new maintainers.
>>>>>>> Hence this messages is addressed to all these maintainers via BCC and
>>>>>>> to
>>>>>>> R-devel.
>>>>>>>
>>>>>>> See
>>>>>>>
>>>>>>>    <http://CRAN.R-project.org/package=R2HTML>
>>>>>>>    <http://CRAN.R-project.org/package=SemiPar>
>>>>>>>    <http://CRAN.R-project.org/package=cghseg>
>>>>>>>    <http://CRAN.R-project.org/package=hexbin>
>>>>>>>    <http://CRAN.R-project.org/package=lgtdl>
>>>>>>>    <http://CRAN.R-project.org/package=monreg>
>>>>>>>    <http://CRAN.R-project.org/package=muhaz>
>>>>>>>    <http://CRAN.R-project.org/package=operators>
>>>>>>>    <http://CRAN.R-project.org/package=pamr>
>>>>>>>
>>>>>>> for information on the QC issues and the reverse dependencies.
>>>>>>>
>>>>>>> Best wishes,
>>>>>>> Uwe Ligges
>>>>>>> (for the CRAN team)
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From maechler at stat.math.ethz.ch  Tue Sep  9 16:19:08 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 9 Sep 2014 16:19:08 +0200
Subject: [Rd] Problem with order() and I()
In-Reply-To: <D033220C.10A9C4%macqueen1@llnl.gov>
References: <D033220C.10A9C4%macqueen1@llnl.gov>
Message-ID: <21519.3164.832420.293156@stat.math.ethz.ch>

>>>>> MacQueen, Don <macqueen1 at llnl.gov>
>>>>>     on Mon, 8 Sep 2014 16:06:21 +0000 writes:

    > I have found that order() fails in a rather arcane circumstance, as in
    > this example:

    >> foo <- I( c('x','\265g') )
    >> order(foo)
    > Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed

    >> foo <-c('x','\265g')
    >> order(foo)
    > [1] 1 2

yes, this is not desirable.
order() in such cases calls xtfrm()  {as documented}
and that ends up calling rank() and then the internal  .gt()
where the bug happens because

 > I("x") > I("\xb5g")
 [1] NA

but really I think the change should happen in xtfrm.Asis(.)
which I think should drop the class also in this case.

More on this, once we have fixed it.

Thank you, Don, very much!

Martin Maechler,
ETH Zurich

    >> sessionInfo()
    > R version 3.1.1 (2014-07-10)
    > Platform: x86_64-apple-darwin13.1.0 (64-bit)

    > locale:
    > [1] C

    > attached base packages:
    > [1] stats     graphics  grDevices utils     datasets  methods   base

    > Thanks
    > -Don

    > p.s.
    > Just a little background, irrelevant unless one wonders why I?m using I()
    > and \265:

    > If I were writing new code I wouldn?t be using I(), since there are better
    > ways now to achieve the same end (preventing the creation of factors in
    > data frames), but the scripts that use it are quite old,  originally
    > developed in 2001.

    > In at least some but perhaps limited contexts, ?\265? produces the greek
    > letter mu, and that?s why I?m using it. And if I remember correctly, 2001
    > is prior to the current R support for locales and extended character sets.
    > Using \265 is what I could find at that time to get a mu into my output.

    > I came across this while checking some things; it?s not actually breaking
    > my scripts, so I doubt it?s due to any recent change.


    > -- 
    > Don MacQueen

    > Lawrence Livermore National Laboratory
    > 7000 East Ave., L-627
    > Livermore, CA 94550
    > 925-423-1062

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From csardi.gabor at gmail.com  Tue Sep  9 16:16:09 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 9 Sep 2014 10:16:09 -0400
Subject: [Rd] r wiki
In-Reply-To: <21519.1306.551292.683057@stat.math.ethz.ch>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
	<21519.1306.551292.683057@stat.math.ethz.ch>
Message-ID: <CABtg=KmxVUMGjdjCP=jKJ_J2x3gMysHsXDzrCFxcaRv0_6YGSw@mail.gmail.com>

FWIW, I have created a project for an R wiki engine @ github:
https://github.com/gaborcsardi/r-wiki-engine

The idea is that R developers and users can use this project to create
R wikis, by simply cloning it, or including it as a git submodule.

The basis will be Hadley's setup for his books; this way I'll have
something useable almost immediately. I'll try to add more wiki-ish
features, like tags, and search later.

Gabor

On Tue, Sep 9, 2014 at 9:48 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Philippe Grosjean <phgrosjean at sciviews.org>
>>>>>>     on Tue, 9 Sep 2014 08:45:14 +0200 writes:
>
>     > Yihui and G?bor, I agree with you, and I also think that
>     > using Travis CI would be very nice. However, there are
>     > hundreds of page on the R wiki to migrate? and syntax is a
>     > little bit different than Markdown.
>
>     > Of course, a solution would be to start again from
>     > scratch, but I think that those who have contributed to
>     > the R Wiki deserve more respect. Any suggestion, or idea
>     > about this?
>
> (and we have seen more on this thread ..)
>
> As one contributor to the former wiki and maintainer of the
> good olde mailing lists, I completely agree (with
> Yihui and G?bor and you) that it's best to move it over to an
> infrastructure which takes care of authentication of legitimate
> users and protection from thieves burglers, spammers, and the like.
>
> Markdown is definitely much better for R users (given knittr and
> Rmd ..), and github is currently the place to host -- and once
> it ceases to be that, markdown will be easier to migrate from.
>
> Martin
>
>     > Best,
>
>     > Philippe On 08 Sep 2014, at 23:12, G?bor Cs?rdi
>     > <csardi.gabor at gmail.com> wrote:
>
>     >> I second this suggestion.
>     >>
>     >> One possible complication I see is that if you would like
>     >> to run the R code (to display its output for example),
>     >> then AFAIK you cannot simply use Jekyll on Github's side,
>     >> but would need some additional infrastructure.
>     >>
>     >> It might be possible to use Travis (or some other) CI for
>     >> it, and avoid installing additional software and/or
>     >> servers, but anyway, this requires some care and effort.
>     >>
>     >> If you don't want to run the code, then it is very easy,
>     >> apart from the (one-time) migration cost.
>     >>
>     >> Best, Gabor
>     >>
>     >> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie
>     >> <xie at yihui.name> wrote:
>     >>> I want to make a humble suggestion: migrate the wiki to
>     >>> Github, and build the pages using Jekyll+Markdown. That
>     >>> way, I think it will attract more volunteers. Simply
>     >>> look how many pull requests that Hadley has got for his
>     >>> up-coming book hosted on Github
>     >>> (http://adv-r.had.co.nz):
>     >>> https://github.com/hadley/adv-r/pulls I have had the
>     >>> experience of maintaining web servers and different
>     >>> wiki/CMS systems (including Dokuwiki -- I have even
>     >>> written a PHP plugin for it), and eventually I found I
>     >>> could not afford the time on the job of a system
>     >>> admin. Now I never do that again, and I just focus on
>     >>> maintaining the content. Let the professionals do the
>     >>> hosting and compilation service, and my life has become
>     >>> so much better (no more worries about security holes and
>     >>> attacks).
>     >>>
>     >>> Regards, Yihui
>     >>> --
>     >>> Yihui Xie <xieyihui at gmail.com> Web: http://yihui.name
>     >>>
>     >>>
>     >>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
>     >>> <Philippe.GROSJEAN at umons.ac.be> wrote:
>     >>>> Uwe and all,
>     >>>>
>     >>>> I have problems with the R wiki engine. It seems that
>     >>>> there is a systematic attack of the R wiki site that
>     >>>> produces an overconsumption of the server's CPU, and
>     >>>> consequently, my provider did shutdown the whole
>     >>>> SciViews.org web site.
>     >>>>
>     >>>> Now, it is a bad time for me to work on this (very busy
>     >>>> with exams + Master and PhD theses). I am currently
>     >>>> looking for an expert in CMS to look at the problem. I
>     >>>> don't know when I will be able to solve this and reopen
>     >>>> the R Wiki.
>     >>>>
>     >>>> Best,
>     >>>>
>     >>>> Philippe
>     >>>> ..............................................<?}))><........
>     >>>> ) ) ) ) ) ( ( ( ( ( Prof. Philippe Grosjean ) ) ) ) ) (
>     >>>> ( ( ( ( Numerical Ecology of Aquatic Systems ) ) ) ) )
>     >>>> Mons University, Belgium ( ( ( ( (
>     >>>> ..............................................................
>     >>>>
>     >>>> On 06 Sep 2014, at 17:28, Uwe Ligges
>     >>>> <ligges at statistik.tu-dortmund.de> wrote:
>     >>>>
>     >>>>> Rather than asking here, I'd ask Philippe Grosjean
>     >>>>> directly, hence CCIng.
>     >>>>>
>     >>>>> Best, Uwe Ligges
>     >>>>>
>     >>>>>
>     >>>>>
>     >>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
>>>>>> This does not answer you, but if you are looking for
>     >>>>> something that existed on that wiki, it may help:
>>>>>>
>>>>>> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
>>>>>> doku.php
>>>>>>
>>>>>> And that wiki doesn't look like it had a lot of activity:
>>>>>> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>     >>>
>     >>> ______________________________________________
>     >>> R-devel at r-project.org mailing list
>     >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>     >>
>     >> ______________________________________________
>     >> R-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel


From pdalgd at gmail.com  Tue Sep  9 16:36:19 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 9 Sep 2014 16:36:19 +0200
Subject: [Rd] Problem with order() and I()
In-Reply-To: <21519.3164.832420.293156@stat.math.ethz.ch>
References: <D033220C.10A9C4%macqueen1@llnl.gov>
	<21519.3164.832420.293156@stat.math.ethz.ch>
Message-ID: <F975C5BF-8E58-4D84-AFEF-DE6950D1155E@gmail.com>

It's actually a little more complicated. I wrote a note, but it seems to be stuck in the outbox on my home machine (I probably forgot to click Send...). 

One important aspect is that

> "x" < "\265g"
[1] NA

which makes me wonder if the bug really is in the case that "works". It seems that it is possible to rank() character vectors that contain incomparable elements.

-pd

On 09 Sep 2014, at 16:19 , Martin Maechler <maechler at stat.math.ethz.ch> wrote:

>>>>>> MacQueen, Don <macqueen1 at llnl.gov>
>>>>>>    on Mon, 8 Sep 2014 16:06:21 +0000 writes:
> 
>> I have found that order() fails in a rather arcane circumstance, as in
>> this example:
> 
>>> foo <- I( c('x','\265g') )
>>> order(foo)
>> Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed
> 
>>> foo <-c('x','\265g')
>>> order(foo)
>> [1] 1 2
> 
> yes, this is not desirable.
> order() in such cases calls xtfrm()  {as documented}
> and that ends up calling rank() and then the internal  .gt()
> where the bug happens because
> 
>> I("x") > I("\xb5g")
> [1] NA
> 
> but really I think the change should happen in xtfrm.Asis(.)
> which I think should drop the class also in this case.
> 
> More on this, once we have fixed it.
> 
> Thank you, Don, very much!
> 
> Martin Maechler,
> ETH Zurich
> 
>>> sessionInfo()
>> R version 3.1.1 (2014-07-10)
>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
> 
>> locale:
>> [1] C
> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
>> Thanks
>> -Don
> 
>> p.s.
>> Just a little background, irrelevant unless one wonders why I?m using I()
>> and \265:
> 
>> If I were writing new code I wouldn?t be using I(), since there are better
>> ways now to achieve the same end (preventing the creation of factors in
>> data frames), but the scripts that use it are quite old,  originally
>> developed in 2001.
> 
>> In at least some but perhaps limited contexts, ?\265? produces the greek
>> letter mu, and that?s why I?m using it. And if I remember correctly, 2001
>> is prior to the current R support for locales and extended character sets.
>> Using \265 is what I could find at that time to get a mu into my output.
> 
>> I came across this while checking some things; it?s not actually breaking
>> my scripts, so I doubt it?s due to any recent change.
> 
> 
>> -- 
>> Don MacQueen
> 
>> Lawrence Livermore National Laboratory
>> 7000 East Ave., L-627
>> Livermore, CA 94550
>> 925-423-1062
> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From HodgessE at uhd.edu  Tue Sep  9 17:01:15 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 9 Sep 2014 15:01:15 +0000
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <540F0648.9040504@statistik.tu-dortmund.de>
References: <53E4FDA9.70903@R-project.org>
	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>
	<540C81D2.3070307@statistik.tu-dortmund.de>
	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>
	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>
	<540CE42A.8090600@statistik.tu-dortmund.de>
	<CAAvavh4JNsnCbuweKvEFhco13DKr3YyWMaHRCKqD2oKry0A6Zw@mail.gmail.com>,
	<540F0648.9040504@statistik.tu-dortmund.de>
Message-ID: <FF9DB805FC41CC4E95825A50F68063021AA98BE5@columbia.uhd.campus>

I'll do R2HTML, please.

Thanks,
Erin

________________________________________
From: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] on behalf of Uwe Ligges [ligges at statistik.tu-dortmund.de]
Sent: Tuesday, September 09, 2014 8:53 AM
To: Luca Sartore
Cc: CRAN at r-project.org; R-Devel
Subject: Re: [Rd] Looking for new maintainer of orphans R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr

On 09.09.2014 09:52, Luca Sartore wrote:
> Dear all,
>
> I will pick up monreg.

Please try to coordinate efforts with Scott Kostyshak  who offered the
same thing yesterday.

Best,
Uwe Ligges



> Best regards,
> Luca Sartore
>
>
> 2014-09-08 1:03 GMT+02:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>
>>
>> On 08.09.2014 01:01, Gregory R. Warnes wrote:
>>>
>>> And I?ll pick up hexbin.
>>
>>
>> Err, that one has been adopted a month ago already.
>>
>> open are:
>>
>> SemiPar cghseg monreg
>>
>>
>> Best,
>> Uwe Ligges
>>
>>
>>>
>>> -Greg
>>>
>>> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com>
>>> wrote:
>>>
>>>> I'll pick up operators.
>>>>
>>>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a
>>>> ?crit :
>>>>
>>>>>
>>>>>
>>>>> On 05.09.2014 20:25, Greg Snow wrote:
>>>>>>
>>>>>> Uwe,
>>>>>>
>>>>>> Have all of these packages found new maintainers? if not, which ones
>>>>>> are still looking to be adopted?
>>>>>
>>>>>
>>>>> Thanks for asking, the ones still looking to be adaopted are:
>>>>> SemiPar cghseg monreg operators
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>>
>>>>>> thanks,
>>>>>>
>>>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org>
>>>>>> wrote:
>>>>>>>
>>>>>>> Dear maintainers and R-devel,
>>>>>>>
>>>>>>> Several orphaned CRAN packages are about to be archived due to
>>>>>>> outstanding
>>>>>>> QC problems, but have CRAN and BioC packages depending on them which
>>>>>>> would
>>>>>>> be broken by the archival (and hence need archiving alongside).
>>>>>>> Therefore we are looking for new maintainers taking over
>>>>>>> maintainership for
>>>>>>> one or more of the following packages:
>>>>>>>
>>>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>>>>>
>>>>>>> Package maintainers whose packages depend on one of these may be
>>>>>>> natural
>>>>>>> candidates to become new maintainers.
>>>>>>> Hence this messages is addressed to all these maintainers via BCC and
>>>>>>> to
>>>>>>> R-devel.
>>>>>>>
>>>>>>> See
>>>>>>>
>>>>>>>    <http://CRAN.R-project.org/package=R2HTML>
>>>>>>>    <http://CRAN.R-project.org/package=SemiPar>
>>>>>>>    <http://CRAN.R-project.org/package=cghseg>
>>>>>>>    <http://CRAN.R-project.org/package=hexbin>
>>>>>>>    <http://CRAN.R-project.org/package=lgtdl>
>>>>>>>    <http://CRAN.R-project.org/package=monreg>
>>>>>>>    <http://CRAN.R-project.org/package=muhaz>
>>>>>>>    <http://CRAN.R-project.org/package=operators>
>>>>>>>    <http://CRAN.R-project.org/package=pamr>
>>>>>>>
>>>>>>> for information on the QC issues and the reverse dependencies.
>>>>>>>
>>>>>>> Best wishes,
>>>>>>> Uwe Ligges
>>>>>>> (for the CRAN team)
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From macqueen1 at llnl.gov  Tue Sep  9 17:08:50 2014
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Tue, 9 Sep 2014 15:08:50 +0000
Subject: [Rd] Problem with order() and I()
In-Reply-To: <21519.3164.832420.293156@stat.math.ethz.ch>
References: <21519.3164.832420.293156@stat.math.ethz.ch>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521913D1B9C1B@PRDEXMBX-08.the-lab.llnl.gov>

You are welcome.

-Don



Sent with Good (www.good.com)


-----Original Message-----
From: Martin Maechler [maechler at stat.math.ethz.ch<mailto:maechler at stat.math.ethz.ch>]
Sent: Tuesday, September 09, 2014 07:19 AM Pacific Standard Time
To: MacQueen, Don
Cc: R-devel at r-project.org
Subject: Re: [Rd] Problem with order() and I()


>>>>> MacQueen, Don <macqueen1 at llnl.gov>
>>>>>     on Mon, 8 Sep 2014 16:06:21 +0000 writes:

    > I have found that order() fails in a rather arcane circumstance, as in
    > this example:

    >> foo <- I( c('x','\265g') )
    >> order(foo)
    > Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed

    >> foo <-c('x','\265g')
    >> order(foo)
    > [1] 1 2

yes, this is not desirable.
order() in such cases calls xtfrm()  {as documented}
and that ends up calling rank() and then the internal  .gt()
where the bug happens because

 > I("x") > I("\xb5g")
 [1] NA

but really I think the change should happen in xtfrm.Asis(.)
which I think should drop the class also in this case.

More on this, once we have fixed it.

Thank you, Don, very much!

Martin Maechler,
ETH Zurich

    >> sessionInfo()
    > R version 3.1.1 (2014-07-10)
    > Platform: x86_64-apple-darwin13.1.0 (64-bit)

    > locale:
    > [1] C

    > attached base packages:
    > [1] stats     graphics  grDevices utils     datasets  methods   base

    > Thanks
    > -Don

    > p.s.
    > Just a little background, irrelevant unless one wonders why I?m using I()
    > and \265:

    > If I were writing new code I wouldn?t be using I(), since there are better
    > ways now to achieve the same end (preventing the creation of factors in
    > data frames), but the scripts that use it are quite old,  originally
    > developed in 2001.

    > In at least some but perhaps limited contexts, ?\265? produces the greek
    > letter mu, and that?s why I?m using it. And if I remember correctly, 2001
    > is prior to the current R support for locales and extended character sets.
    > Using \265 is what I could find at that time to get a mu into my output.

    > I came across this while checking some things; it?s not actually breaking
    > my scripts, so I doubt it?s due to any recent change.


    > --
    > Don MacQueen

    > Lawrence Livermore National Laboratory
    > 7000 East Ave., L-627
    > Livermore, CA 94550
    > 925-423-1062

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Tue Sep  9 17:14:01 2014
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 09 Sep 2014 17:14:01 +0200
Subject: [Rd] Looking for new maintainer of orphans R2HTML SemiPar
 cghseg hexbin lgtdl monreg muhaz operators pamr
In-Reply-To: <FF9DB805FC41CC4E95825A50F68063021AA98BE5@columbia.uhd.campus>
References: <53E4FDA9.70903@R-project.org>	<CAFEqCdxuWeHJmjibPKMqZk85aRZtsfDPyeDHU8h-GAyrsURR=g@mail.gmail.com>	<540C81D2.3070307@statistik.tu-dortmund.de>	<454D8D14-57F1-4421-921B-A60EC4FA7B8D@r-enthusiasts.com>	<F1D0A14B-1FE1-4E77-B59B-BE78ADC8C966@warnes.net>	<540CE42A.8090600@statistik.tu-dortmund.de>	<CAAvavh4JNsnCbuweKvEFhco13DKr3YyWMaHRCKqD2oKry0A6Zw@mail.gmail.com>,
	<540F0648.9040504@statistik.tu-dortmund.de>
	<FF9DB805FC41CC4E95825A50F68063021AA98BE5@columbia.uhd.campus>
Message-ID: <540F1939.8080804@statistik.tu-dortmund.de>



On 09.09.2014 17:01, Hodgess, Erin wrote:
> I'll do R2HTML, please.

Thanks, but a new version with new maintainer is on CRAN already.

Best,
Uwe Ligges


>
> Thanks,
> Erin
>
> ________________________________________
> From: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] on behalf of Uwe Ligges [ligges at statistik.tu-dortmund.de]
> Sent: Tuesday, September 09, 2014 8:53 AM
> To: Luca Sartore
> Cc: CRAN at r-project.org; R-Devel
> Subject: Re: [Rd] Looking for new maintainer of orphans R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>
> On 09.09.2014 09:52, Luca Sartore wrote:
>> Dear all,
>>
>> I will pick up monreg.
>
> Please try to coordinate efforts with Scott Kostyshak  who offered the
> same thing yesterday.
>
> Best,
> Uwe Ligges
>
>
>
>> Best regards,
>> Luca Sartore
>>
>>
>> 2014-09-08 1:03 GMT+02:00 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>>
>>>
>>> On 08.09.2014 01:01, Gregory R. Warnes wrote:
>>>>
>>>> And I?ll pick up hexbin.
>>>
>>>
>>> Err, that one has been adopted a month ago already.
>>>
>>> open are:
>>>
>>> SemiPar cghseg monreg
>>>
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>>>
>>>> -Greg
>>>>
>>>> On Sep 7, 2014, at 12:17 PM, Romain Francois <romain at r-enthusiasts.com>
>>>> wrote:
>>>>
>>>>> I'll pick up operators.
>>>>>
>>>>> Le 7 sept. 2014 ? 18:03, Uwe Ligges <ligges at statistik.tu-dortmund.de> a
>>>>> ?crit :
>>>>>
>>>>>>
>>>>>>
>>>>>> On 05.09.2014 20:25, Greg Snow wrote:
>>>>>>>
>>>>>>> Uwe,
>>>>>>>
>>>>>>> Have all of these packages found new maintainers? if not, which ones
>>>>>>> are still looking to be adopted?
>>>>>>
>>>>>>
>>>>>> Thanks for asking, the ones still looking to be adaopted are:
>>>>>> SemiPar cghseg monreg operators
>>>>>>
>>>>>> Best,
>>>>>> Uwe Ligges
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> thanks,
>>>>>>>
>>>>>>> On Fri, Aug 8, 2014 at 10:41 AM, Uwe Ligges <Uwe.Ligges at r-project.org>
>>>>>>> wrote:
>>>>>>>>
>>>>>>>> Dear maintainers and R-devel,
>>>>>>>>
>>>>>>>> Several orphaned CRAN packages are about to be archived due to
>>>>>>>> outstanding
>>>>>>>> QC problems, but have CRAN and BioC packages depending on them which
>>>>>>>> would
>>>>>>>> be broken by the archival (and hence need archiving alongside).
>>>>>>>> Therefore we are looking for new maintainers taking over
>>>>>>>> maintainership for
>>>>>>>> one or more of the following packages:
>>>>>>>>
>>>>>>>> R2HTML SemiPar cghseg hexbin lgtdl monreg muhaz operators pamr
>>>>>>>>
>>>>>>>> Package maintainers whose packages depend on one of these may be
>>>>>>>> natural
>>>>>>>> candidates to become new maintainers.
>>>>>>>> Hence this messages is addressed to all these maintainers via BCC and
>>>>>>>> to
>>>>>>>> R-devel.
>>>>>>>>
>>>>>>>> See
>>>>>>>>
>>>>>>>>     <http://CRAN.R-project.org/package=R2HTML>
>>>>>>>>     <http://CRAN.R-project.org/package=SemiPar>
>>>>>>>>     <http://CRAN.R-project.org/package=cghseg>
>>>>>>>>     <http://CRAN.R-project.org/package=hexbin>
>>>>>>>>     <http://CRAN.R-project.org/package=lgtdl>
>>>>>>>>     <http://CRAN.R-project.org/package=monreg>
>>>>>>>>     <http://CRAN.R-project.org/package=muhaz>
>>>>>>>>     <http://CRAN.R-project.org/package=operators>
>>>>>>>>     <http://CRAN.R-project.org/package=pamr>
>>>>>>>>
>>>>>>>> for information on the QC issues and the reverse dependencies.
>>>>>>>>
>>>>>>>> Best wishes,
>>>>>>>> Uwe Ligges
>>>>>>>> (for the CRAN team)
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From baptiste.auguie at gmail.com  Tue Sep  9 16:29:37 2014
From: baptiste.auguie at gmail.com (Baptiste Auguie)
Date: Tue, 9 Sep 2014 11:29:37 -0300
Subject: [Rd] r wiki
In-Reply-To: <21519.1306.551292.683057@stat.math.ethz.ch>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
	<21519.1306.551292.683057@stat.math.ethz.ch>
Message-ID: <CANLFJPpg0tGZyas0SfYT5CPgCbfH7TWhdvi4TzD0=fDG9=mUSg@mail.gmail.com>

One small technical issue currently limiting the deployment of true
reproducible wikis based on knitr + github-markdown is the lack of reverse
synchronisation between the rendered output (markdown), edited online, and
the original Rmd source. It think the combination of wiki features +
reproducible source code has great potential for community-driven
documentation (even for individual packages), but this relatively new
use-case for reproducible documents may highlight a limitation in knitr's
current framework [1].

On a more general note, and considering the positive sentiment toward
github in the R community, it might be a good time to register a
semi-official R-project organisation to regroup such initiatives,

https://help.github.com/articles/creating-a-new-organization-account

In the long-run, it would be nice to centralise some valuable resources
that have appeared independently over the years, such as the R wiki, the R
graph gallery [?], the unofficial CRAN mirror [2], the unofficial r-source
mirror [3], and probably many others I forget or don't know about.

Regards,

baptiste

[1] related discussion here: https://github.com/yihui/knitr/issues/536
[?] http://addictedtor.free.fr/graphiques/
[2] https://github.com/cran, https://github.com/metacran/
[3] https://github.com/wch/r-source

On 9 September 2014 10:48, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Philippe Grosjean <phgrosjean at sciviews.org>
> >>>>>     on Tue, 9 Sep 2014 08:45:14 +0200 writes:
>
>     > Yihui and G?bor, I agree with you, and I also think that
>     > using Travis CI would be very nice. However, there are
>     > hundreds of page on the R wiki to migrate? and syntax is a
>     > little bit different than Markdown.
>
>     > Of course, a solution would be to start again from
>     > scratch, but I think that those who have contributed to
>     > the R Wiki deserve more respect. Any suggestion, or idea
>     > about this?
>
> (and we have seen more on this thread ..)
>
> As one contributor to the former wiki and maintainer of the
> good olde mailing lists, I completely agree (with
> Yihui and G?bor and you) that it's best to move it over to an
> infrastructure which takes care of authentication of legitimate
> users and protection from thieves burglers, spammers, and the like.
>
> Markdown is definitely much better for R users (given knittr and
> Rmd ..), and github is currently the place to host -- and once
> it ceases to be that, markdown will be easier to migrate from.
>
> Martin
>
>     > Best,
>
>     > Philippe On 08 Sep 2014, at 23:12, G?bor Cs?rdi
>     > <csardi.gabor at gmail.com> wrote:
>
>     >> I second this suggestion.
>     >>
>     >> One possible complication I see is that if you would like
>     >> to run the R code (to display its output for example),
>     >> then AFAIK you cannot simply use Jekyll on Github's side,
>     >> but would need some additional infrastructure.
>     >>
>     >> It might be possible to use Travis (or some other) CI for
>     >> it, and avoid installing additional software and/or
>     >> servers, but anyway, this requires some care and effort.
>     >>
>     >> If you don't want to run the code, then it is very easy,
>     >> apart from the (one-time) migration cost.
>     >>
>     >> Best, Gabor
>     >>
>     >> On Mon, Sep 8, 2014 at 4:15 PM, Yihui Xie
>     >> <xie at yihui.name> wrote:
>     >>> I want to make a humble suggestion: migrate the wiki to
>     >>> Github, and build the pages using Jekyll+Markdown. That
>     >>> way, I think it will attract more volunteers. Simply
>     >>> look how many pull requests that Hadley has got for his
>     >>> up-coming book hosted on Github
>     >>> (http://adv-r.had.co.nz):
>     >>> https://github.com/hadley/adv-r/pulls I have had the
>     >>> experience of maintaining web servers and different
>     >>> wiki/CMS systems (including Dokuwiki -- I have even
>     >>> written a PHP plugin for it), and eventually I found I
>     >>> could not afford the time on the job of a system
>     >>> admin. Now I never do that again, and I just focus on
>     >>> maintaining the content. Let the professionals do the
>     >>> hosting and compilation service, and my life has become
>     >>> so much better (no more worries about security holes and
>     >>> attacks).
>     >>>
>     >>> Regards, Yihui
>     >>> --
>     >>> Yihui Xie <xieyihui at gmail.com> Web: http://yihui.name
>     >>>
>     >>>
>     >>> On Mon, Sep 8, 2014 at 12:10 PM, Philippe GROSJEAN
>     >>> <Philippe.GROSJEAN at umons.ac.be> wrote:
>     >>>> Uwe and all,
>     >>>>
>     >>>> I have problems with the R wiki engine. It seems that
>     >>>> there is a systematic attack of the R wiki site that
>     >>>> produces an overconsumption of the server's CPU, and
>     >>>> consequently, my provider did shutdown the whole
>     >>>> SciViews.org web site.
>     >>>>
>     >>>> Now, it is a bad time for me to work on this (very busy
>     >>>> with exams + Master and PhD theses). I am currently
>     >>>> looking for an expert in CMS to look at the problem. I
>     >>>> don't know when I will be able to solve this and reopen
>     >>>> the R Wiki.
>     >>>>
>     >>>> Best,
>     >>>>
>     >>>> Philippe
>     >>>> ..............................................<?}))><........
>     >>>> ) ) ) ) ) ( ( ( ( ( Prof. Philippe Grosjean ) ) ) ) ) (
>     >>>> ( ( ( ( Numerical Ecology of Aquatic Systems ) ) ) ) )
>     >>>> Mons University, Belgium ( ( ( ( (
>     >>>> ..............................................................
>     >>>>
>     >>>> On 06 Sep 2014, at 17:28, Uwe Ligges
>     >>>> <ligges at statistik.tu-dortmund.de> wrote:
>     >>>>
>     >>>>> Rather than asking here, I'd ask Philippe Grosjean
>     >>>>> directly, hence CCIng.
>     >>>>>
>     >>>>> Best, Uwe Ligges
>     >>>>>
>     >>>>>
>     >>>>>
>     >>>>> On 06.09.2014 01:17, Andr? Z. D. A. wrote:
> >>>>> This does not answer you, but if you are looking for
>     >>>>> something that existed on that wiki, it may help:
> >>>>>
> >>>>>
> https://web.archive.org/web/20140112055032/http://rwiki.sciviews.org/
> >>>>> doku.php
> >>>>>
> >>>>> And that wiki doesn't look like it had a lot of activity:
> >>>>>
> https://web.archive.org/web/20140301000000*/http://rwiki.sciviews.org/
>     >>>
>     >>> ______________________________________________
>     >>> R-devel at r-project.org mailing list
>     >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>     >>
>     >> ______________________________________________
>     >> R-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Tue Sep  9 18:35:38 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 9 Sep 2014 18:35:38 +0200
Subject: [Rd] Problem with order() and I()
In-Reply-To: <F975C5BF-8E58-4D84-AFEF-DE6950D1155E@gmail.com>
References: <D033220C.10A9C4%macqueen1@llnl.gov>
	<21519.3164.832420.293156@stat.math.ethz.ch>
	<F975C5BF-8E58-4D84-AFEF-DE6950D1155E@gmail.com>
Message-ID: <21519.11354.329455.593380@stat.math.ethz.ch>

>>>>> peter dalgaard <pdalgd at gmail.com>
>>>>>     on Tue, 9 Sep 2014 16:36:19 +0200 writes:

    > It's actually a little more complicated. I wrote a note, but it seems to be stuck in the outbox on my home machine (I probably forgot to click Send...). 
    > One important aspect is that

    >> "x" < "\265g"
    > [1] NA

    > which makes me wonder if the bug really is in the case that "works". It seems that it is possible to rank() character vectors that contain incomparable elements.

    > -pd

yes you are right that it is even more complicated.
In both cases, our Scollate() is involved,
(Scollate: the one where we had a discussion about making it part of the C
 level R API, which would help package authors ..)

After

  ch <- c('x','\265g')
  foo <- I(ch)

Of the four expressions,

  order(ch)
  order(foo)
  ch [1] < ch [2]
  foo[1] < foo[2]

only the first one "works", the others give NA or an error because of NA
and the first one is the only of the 4 that does not use
do_relop_dflt()

It's not even clear what we'd want (as I think  pd also alluded to):
Ideally all of these should work consistently, which because of
 "<(.,.)" returning NA in both cases,
would mean that order(ch) also should give an error as order(foo)
    {{ an error we should improve the message in any case!!}.
Big Q:  Can we afford  order(ch)  giving an error in such cases.
Pretty high chance that this will "break" much user (and probably
even package) code out there.

Still, the other solution, namely  order(foo) behaving as
order(ch) now does would correspond to the ">" giving FALSE
instead of NA, so this solution is not ok in my view.

Martin


    > On 09 Sep 2014, at 16:19 , Martin Maechler <maechler at stat.math.ethz.ch> wrote:

    >>>>>>> MacQueen, Don <macqueen1 at llnl.gov>
    >>>>>>> on Mon, 8 Sep 2014 16:06:21 +0000 writes:
    >> 
    >>> I have found that order() fails in a rather arcane circumstance, as in
    >>> this example:
    >> 
    >>>> foo <- I( c('x','\265g') )
    >>>> order(foo)
    >>> Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed
    >> 
    >>>> foo <-c('x','\265g')
    >>>> order(foo)
    >>> [1] 1 2
    >> 
    >> yes, this is not desirable.
    >> order() in such cases calls xtfrm()  {as documented}
    >> and that ends up calling rank() and then the internal  .gt()
    >> where the bug happens because
    >> 
    >>> I("x") > I("\xb5g")
    >> [1] NA
    >> 
    >> but really I think the change should happen in xtfrm.Asis(.)
    >> which I think should drop the class also in this case.
    >> 
    >> More on this, once we have fixed it.
    >> 
    >> Thank you, Don, very much!
    >> 
    >> Martin Maechler,
    >> ETH Zurich
    >> 
    >>>> sessionInfo()
    >>> R version 3.1.1 (2014-07-10)
    >>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
    >> 
    >>> locale:
    >>> [1] C
    >> 
    >>> attached base packages:
    >>> [1] stats     graphics  grDevices utils     datasets  methods   base
    >> 
    >>> Thanks
    >>> -Don
    >> 
    >>> p.s.
    >>> Just a little background, irrelevant unless one wonders why I?m using I()
    >>> and \265:
    >> 
    >>> If I were writing new code I wouldn?t be using I(), since there are better
    >>> ways now to achieve the same end (preventing the creation of factors in
    >>> data frames), but the scripts that use it are quite old,  originally
    >>> developed in 2001.
    >> 
    >>> In at least some but perhaps limited contexts, ?\265? produces the greek
    >>> letter mu, and that?s why I?m using it. And if I remember correctly, 2001
    >>> is prior to the current R support for locales and extended character sets.
    >>> Using \265 is what I could find at that time to get a mu into my output.
    >> 
    >>> I came across this while checking some things; it?s not actually breaking
    >>> my scripts, so I doubt it?s due to any recent change.
    >> 
    >> 
    >>> -- 
    >>> Don MacQueen
    >> 
    >>> Lawrence Livermore National Laboratory
    >>> 7000 East Ave., L-627
    >>> Livermore, CA 94550
    >>> 925-423-1062
    >> 
    >>> ______________________________________________
    >>> R-devel at r-project.org mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel

    > -- 
    > Peter Dalgaard, Professor,
    > Center for Statistics, Copenhagen Business School
    > Solbjerg Plads 3, 2000 Frederiksberg, Denmark
    > Phone: (+45)38153501
    > Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From csardi.gabor at gmail.com  Tue Sep  9 19:04:31 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 9 Sep 2014 13:04:31 -0400
Subject: [Rd] r wiki
In-Reply-To: <CANLFJPpg0tGZyas0SfYT5CPgCbfH7TWhdvi4TzD0=fDG9=mUSg@mail.gmail.com>
References: <6604241409959069@web8j.yandex.ru>
	<540B2825.40403@statistik.tu-dortmund.de>
	<618E9DC0-7ADA-4E6F-95CD-3551B55386B3@umons.ac.be>
	<CANROs4fk_Ve6tV0qRrqn+BeiCkpRBe8z6Q4vCXB-T79ArzNO-g@mail.gmail.com>
	<CABtg=Km5oaFJCGDKpC_5qVhCm+a_MhjnNhntnAGKQjgeBvx1Yw@mail.gmail.com>
	<846A1514-C508-46EF-978F-685C0DE3B730@sciviews.org>
	<21519.1306.551292.683057@stat.math.ethz.ch>
	<CANLFJPpg0tGZyas0SfYT5CPgCbfH7TWhdvi4TzD0=fDG9=mUSg@mail.gmail.com>
Message-ID: <CABtg=K=C8QVOQwrEF9aX00p2+vC0WyVhehm4Z8TAuqKretO-Qw@mail.gmail.com>

On Tue, Sep 9, 2014 at 10:29 AM, Baptiste Auguie
<baptiste.auguie at gmail.com> wrote:
> One small technical issue currently limiting the deployment of true
> reproducible wikis based on knitr + github-markdown is the lack of reverse
> synchronisation between the rendered output (markdown), edited online, and
> the original Rmd source.

The idea is that you would edit the (r)md file on github, e.g. like this:
https://github.com/gaborcsardi/r-wiki-engine/edit/wiki/welcome.md
You need to fork to do it, unless you are a collaborator.

If you use .md file extensions instead of .rmd, then you even get a
preview. (You can still treat the files as Rmd, of course when
building the web site.) Then, when you save your edit (and are a
collaborator), your edit will be a commit, and Travis will build the
new version of the web page.

If you are not a collaborator, then you need to submit a pull request,
and whenever this is
OK-d, the wiki and web pages will be updated.

It is not exactly a real wiki, but probably as close as you can get
with free services and without setting up a server.

Another possibility would be using the wikis Github provides, for
editing, but one would still need to build the web pages with Travis,
to run the R code, so I am not sure how much that would be better.

The good thing with this setup is, that you can switch to a dedicated
server later, as all the build tools are open-source. Then you would
get a real wiki, but the effort you need is much bigger.

Gabor


From pdalgd at gmail.com  Wed Sep 10 00:54:12 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 10 Sep 2014 00:54:12 +0200
Subject: [Rd] Problem with order() and I()
In-Reply-To: <D033220C.10A9C4%macqueen1@llnl.gov>
References: <D033220C.10A9C4%macqueen1@llnl.gov>
Message-ID: <209AB873-0394-4435-B5DD-A43A8B838297@gmail.com>

[This is the note I alluded to earlier today.]

On 08 Sep 2014, at 18:06 , MacQueen, Don <macqueen1 at llnl.gov> wrote:

> I have found that order() fails in a rather arcane circumstance, as in
> this example:
> 
>> foo <- I( c('x','\265g') )
>> order(foo)
> Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed
>> foo <-c('x','\265g')
>> order(foo)
> [1] 1 2
> 
> 

The oddity is really that it works (for some value of "works") in the unclassed case:

> foo <- I( c('x','\265g') )
> order(foo)
Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed
> foo[[1]]
[1] "x"
> foo[[2]]
[1] "\xb5g"
> foo[[1]] < foo[[2]]
[1] NA
> foo[[1]] > foo[[2]]
[1] NA


> fee <- c('x','\265g') 
> fee[[1]]
[1] "x"
> fee[[2]]
[1] "\xb5g"
> fee[[1]] < fee[[2]]
[1] NA
> fee[[1]] > fee[[2]]
[1] NA
> order(fee)
[1] 2 1

Notice that the unclassed `fee` has exactly the same issue that its elements are incomparable as `foo` does.

The thing is that xtfrm.AsIs will use elementwise comparison, whereas xtfrm.default will use rank(), which somehow manages to do something with character vectors for which the sort order is undefined:

> rank(foo)
Error in if (xi > xj) 1L else -1L : missing value where TRUE/FALSE needed
> rank(fee)
[1] 2 1

(Notice that xtfrm calls rank and vice versa, presumably without creating a loop. I gave up on sorting out the logic.)

> 
>> sessionInfo()
> R version 3.1.1 (2014-07-10)
> Platform: x86_64-apple-darwin13.1.0 (64-bit)
> 
> locale:
> [1] C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> Thanks
> -Don
> 
> p.s.
> Just a little background, irrelevant unless one wonders why I?m using I()
> and \265:
> 
> If I were writing new code I wouldn?t be using I(), since there are better
> ways now to achieve the same end (preventing the creation of factors in
> data frames), but the scripts that use it are quite old,  originally
> developed in 2001.
> 
> In at least some but perhaps limited contexts, ?\265? produces the greek
> letter mu, and that?s why I?m using it. And if I remember correctly, 2001
> is prior to the current R support for locales and extended character sets.
> Using \265 is what I could find at that time to get a mu into my output.
> 
> I came across this while checking some things; it?s not actually breaking
> my scripts, so I doubt it?s due to any recent change.
> 
> 
> -- 
> Don MacQueen
> 
> Lawrence Livermore National Laboratory
> 7000 East Ave., L-627
> Livermore, CA 94550
> 925-423-1062
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From stephanie.locke at optimumcredit.co.uk  Wed Sep 10 09:55:23 2014
From: stephanie.locke at optimumcredit.co.uk (Stephanie Locke)
Date: Wed, 10 Sep 2014 07:55:23 +0000
Subject: [Rd] How to test impact of candidate changes to package?
Message-ID: <526d73b585084eecb2b72a92ab9f74b0@DB3PR01MB252.eurprd01.prod.exchangelabs.com>

I use a package to contain simple functions that can be handled by unit tests for correctness and more complex functions that combine the simple functions with business logic.  Where there are proposals to change either the simple functions or the business logic, a sample needs to be run before the change and then after it to understand the impact of the change.

I do this currently by
1. Using Rmarkdown documents
2. Loading the package as-is
3. Getting my sample
4. Running my sample through the package as-is and outputting table of results
5. sourceing new copies of functions
6. Running my sample again and outputting table of results
7. Reloading package and sourceing different copies of functions as required

I really don't think this is a good way to do this as it risks missing downstream dependencies of the functions I'm trying to load into the global namespace to test.

Has anyone else had to do this sort of testing before on their packages? How did you do it? Am I missing an obvious package / framework that can do this?

Cheers,
Steph

--
Stephanie Locke
BI & Credit Risk Analyst




The contents of this e-mail and of any attachments transmitted with it are confidential and intended solely for the use of the individual(s) to whom they are addressed. If you are not an intended recipient or the person responsible for delivering this e-mail to the intended recipient(s), you have received this e-mail in error, and access to it by you is not authorised. You may not use, copy, distribute, disclose or rely on it or any attachment, or any part of it or any attachment in any way. If you have received this e-mail in error please notify Optimum Credit Ltd by email on webmaster at optimumcredit.co.uk or phone on 03330 143125 and then delete it.

All reasonable precautions have been taken to ensure that no viruses are present in E-mail. As we cannot accept responsibility for loss or damage arising from the use of E-mail or any attachment we recommend you subject these to your usual virus checking procedures prior to use. Any opinions expressed in this e-mail are those of the person sending it and not necessarily those of Optimum Credit Ltd.

Optimum Credit Ltd, Haywood House South, Dumfries Place, Cardiff, CF10 3GA

Authorised and regulated by the Financial Conduct Authority

Optimum Credit Ltd. Registered office: Haywood House South, Dumfries Place, Cardiff, CF10 3GA. Registered in England and Wales No. 08698121

Calls may be monitored or recorded for training, compliance and evidential purposes.


From Thierry.ONKELINX at inbo.be  Wed Sep 10 10:30:15 2014
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 10 Sep 2014 08:30:15 +0000
Subject: [Rd] How to test impact of candidate changes to package?
In-Reply-To: <526d73b585084eecb2b72a92ab9f74b0@DB3PR01MB252.eurprd01.prod.exchangelabs.com>
References: <526d73b585084eecb2b72a92ab9f74b0@DB3PR01MB252.eurprd01.prod.exchangelabs.com>
Message-ID: <AA818EAD2576BC488B4F623941DA7427F3AEA7E5@inbomail.inbo.be>

Dear Stephanie,

Have a look at the testthat package and the related article in the R Journal.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] Namens Stephanie Locke
Verzonden: woensdag 10 september 2014 9:55
Aan: r-devel at r-project.org
Onderwerp: [Rd] How to test impact of candidate changes to package?

I use a package to contain simple functions that can be handled by unit tests for correctness and more complex functions that combine the simple functions with business logic.  Where there are proposals to change either the simple functions or the business logic, a sample needs to be run before the change and then after it to understand the impact of the change.

I do this currently by
1. Using Rmarkdown documents
2. Loading the package as-is
3. Getting my sample
4. Running my sample through the package as-is and outputting table of results 5. sourceing new copies of functions 6. Running my sample again and outputting table of results 7. Reloading package and sourceing different copies of functions as required

I really don't think this is a good way to do this as it risks missing downstream dependencies of the functions I'm trying to load into the global namespace to test.

Has anyone else had to do this sort of testing before on their packages? How did you do it? Am I missing an obvious package / framework that can do this?

Cheers,
Steph

--
Stephanie Locke
BI & Credit Risk Analyst




The contents of this e-mail and of any attachments transmitted with it are confidential and intended solely for the use of the individual(s) to whom they are addressed. If you are not an intended recipient or the person responsible for delivering this e-mail to the intended recipient(s), you have received this e-mail in error, and access to it by you is not authorised. You may not use, copy, distribute, disclose or rely on it or any attachment, or any part of it or any attachment in any way. If you have received this e-mail in error please notify Optimum Credit Ltd by email on webmaster at optimumcredit.co.uk or phone on 03330 143125 and then delete it.

All reasonable precautions have been taken to ensure that no viruses are present in E-mail. As we cannot accept responsibility for loss or damage arising from the use of E-mail or any attachment we recommend you subject these to your usual virus checking procedures prior to use. Any opinions expressed in this e-mail are those of the person sending it and not necessarily those of Optimum Credit Ltd.

Optimum Credit Ltd, Haywood House South, Dumfries Place, Cardiff, CF10 3GA

Authorised and regulated by the Financial Conduct Authority

Optimum Credit Ltd. Registered office: Haywood House South, Dumfries Place, Cardiff, CF10 3GA. Registered in England and Wales No. 08698121

Calls may be monitored or recorded for training, compliance and evidential purposes.

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From stephanie.locke at optimumcredit.co.uk  Wed Sep 10 11:14:12 2014
From: stephanie.locke at optimumcredit.co.uk (Stephanie Locke)
Date: Wed, 10 Sep 2014 09:14:12 +0000
Subject: [Rd] How to test impact of candidate changes to package?
In-Reply-To: <AA818EAD2576BC488B4F623941DA7427F3AEA7E5@inbomail.inbo.be>
References: <526d73b585084eecb2b72a92ab9f74b0@DB3PR01MB252.eurprd01.prod.exchangelabs.com>
	<AA818EAD2576BC488B4F623941DA7427F3AEA7E5@inbomail.inbo.be>
Message-ID: <e476aba80ced41e0b8ed9ec181cd423f@DB3PR01MB252.eurprd01.prod.exchangelabs.com>

I have unit tests using testthat but these are typically of these types:
1) Check for correct calculation for a single set of valid inputs
2) Check for correct calculation for a larger set of valid inputs
3) Check for errors when providing incorrect inputs
4) Check for known frailties / past issues

This is more for where changes are needed to functions that apply various bits of business logic that can change over time, so there is no "one answer". A unit test (at least as I understand it) can be worked through to make sure that given inputs, the output is computationally correct. What I'd like to do is overall the impact of a potential change by testing version 1 of a function in a package for a sample, then test version 2 of a function in a package for a sample and compare the results.

My difficulties encountered so far is I'm reluctantly to manually do this change invasively by overwriting the relevant files in the R directory, and then say using devtools to load it and test it with testthat as I risk producing incorrect states of my package and potentially releasing the wrong thing.  My preference would be a non-invasive method.  Currently, where I'm trying to do this non-invasively I source a new version of the function stored in a separate directory, but some of the functions dependent on it continue to reference to the package version of the functions, this means that when I'm doing test #2 I have to load lots more functions and hope I've caught them all (or do some sort of dependency hunting programmatically).

I may be missing something about testthat, but what I'm doing now seems to be nowhere near optimal and I'd love to have a better solution.

Cheers

Stephanie Locke
BI & Credit Risk Analyst

-----Original Message-----
From: ONKELINX, Thierry [mailto:Thierry.ONKELINX at inbo.be]
Sent: 10 September 2014 09:30
To: Stephanie Locke; r-devel at r-project.org
Subject: RE: How to test impact of candidate changes to package?

Dear Stephanie,

Have a look at the testthat package and the related article in the R Journal.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] Namens Stephanie Locke
Verzonden: woensdag 10 september 2014 9:55
Aan: r-devel at r-project.org
Onderwerp: [Rd] How to test impact of candidate changes to package?

I use a package to contain simple functions that can be handled by unit tests for correctness and more complex functions that combine the simple functions with business logic.  Where there are proposals to change either the simple functions or the business logic, a sample needs to be run before the change and then after it to understand the impact of the change.

I do this currently by
1. Using Rmarkdown documents
2. Loading the package as-is
3. Getting my sample
4. Running my sample through the package as-is and outputting table of results 5. sourceing new copies of functions 6. Running my sample again and outputting table of results 7. Reloading package and sourceing different copies of functions as required

I really don't think this is a good way to do this as it risks missing downstream dependencies of the functions I'm trying to load into the global namespace to test.

Has anyone else had to do this sort of testing before on their packages? How did you do it? Am I missing an obvious package / framework that can do this?

Cheers,
Steph

--
Stephanie Locke
BI & Credit Risk Analyst




The contents of this e-mail and of any attachments transmitted with it are confidential and intended solely for the use of the individual(s) to whom they are addressed. If you are not an intended recipient or the person responsible for delivering this e-mail to the intended recipient(s), you have received this e-mail in error, and access to it by you is not authorised. You may not use, copy, distribute, disclose or rely on it or any attachment, or any part of it or any attachment in any way. If you have received this e-mail in error please notify Optimum Credit Ltd by email on webmaster at optimumcredit.co.uk or phone on 03330 143125 and then delete it.

All reasonable precautions have been taken to ensure that no viruses are present in E-mail. As we cannot accept responsibility for loss or damage arising from the use of E-mail or any attachment we recommend you subject these to your usual virus checking procedures prior to use. Any opinions expressed in this e-mail are those of the person sending it and not necessarily those of Optimum Credit Ltd.

Optimum Credit Ltd, Haywood House South, Dumfries Place, Cardiff, CF10 3GA

Authorised and regulated by the Financial Conduct Authority

Optimum Credit Ltd. Registered office: Haywood House South, Dumfries Place, Cardiff, CF10 3GA. Registered in England and Wales No. 08698121

Calls may be monitored or recorded for training, compliance and evidential purposes.

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


The contents of this e-mail and of any attachments transmitted with it are confidential and intended solely for the use of the individual(s) to whom they are addressed. If you are not an intended recipient or the person responsible for delivering this e-mail to the intended recipient(s), you have received this e-mail in error, and access to it by you is not authorised. You may not use, copy, distribute, disclose or rely on it or any attachment, or any part of it or any attachment in any way. If you have received this e-mail in error please notify Optimum Credit Ltd by email on webmaster at optimumcredit.co.uk or phone on 03330 143125 and then delete it.

All reasonable precautions have been taken to ensure that no viruses are present in E-mail. As we cannot accept responsibility for loss or damage arising from the use of E-mail or any attachment we recommend you subject these to your usual virus checking procedures prior to use. Any opinions expressed in this e-mail are those of the person sending it and not necessarily those of Optimum Credit Ltd.

Optimum Credit Ltd, Haywood House South, Dumfries Place, Cardiff, CF10 3GA

Authorised and regulated by the Financial Conduct Authority

Optimum Credit Ltd. Registered office: Haywood House South, Dumfries Place, Cardiff, CF10 3GA. Registered in England and Wales No. 08698121

Calls may be monitored or recorded for training, compliance and evidential purposes.


From kirill.mueller at ivt.baug.ethz.ch  Wed Sep 10 12:12:34 2014
From: kirill.mueller at ivt.baug.ethz.ch (=?windows-1252?Q?Kirill_M=FCller?=)
Date: Wed, 10 Sep 2014 12:12:34 +0200
Subject: [Rd] How to test impact of candidate changes to package?
In-Reply-To: <e476aba80ced41e0b8ed9ec181cd423f@DB3PR01MB252.eurprd01.prod.exchangelabs.com>
References: <526d73b585084eecb2b72a92ab9f74b0@DB3PR01MB252.eurprd01.prod.exchangelabs.com>	<AA818EAD2576BC488B4F623941DA7427F3AEA7E5@inbomail.inbo.be>
	<e476aba80ced41e0b8ed9ec181cd423f@DB3PR01MB252.eurprd01.prod.exchangelabs.com>
Message-ID: <54102412.3080404@ivt.baug.ethz.ch>

If you don't intend to keep the old business logic in the long run, 
perhaps a version control system such as Git can help you. If you use it 
in single-user mode, you can think of it as a backup system where you 
manually create each snapshot and give it a name, but it actually can do 
much more. For your use case, you can open a new *branch* where you 
implement your changes, and implement your testing logic simultaneously 
in both branches (using *merge* operations). The system handles 
switching between branches, so you can really perform invasive changes, 
and revert if you find that a particular change breaks something.

RStudio has Git support, but you probably need to use the shell to 
create a branch. On Windows or OS X the GitHub client helps you to get 
started.


Cheers

Kirill


On 09/10/2014 11:14 AM, Stephanie Locke wrote:
> I have unit tests using testthat but these are typically of these types:
> 1) Check for correct calculation for a single set of valid inputs
> 2) Check for correct calculation for a larger set of valid inputs
> 3) Check for errors when providing incorrect inputs
> 4) Check for known frailties / past issues
>
> This is more for where changes are needed to functions that apply various bits of business logic that can change over time, so there is no "one answer". A unit test (at least as I understand it) can be worked through to make sure that given inputs, the output is computationally correct. What I'd like to do is overall the impact of a potential change by testing version 1 of a function in a package for a sample, then test version 2 of a function in a package for a sample and compare the results.
>
> My difficulties encountered so far is I'm reluctantly to manually do this change invasively by overwriting the relevant files in the R directory, and then say using devtools to load it and test it with testthat as I risk producing incorrect states of my package and potentially releasing the wrong thing.  My preference would be a non-invasive method.  Currently, where I'm trying to do this non-invasively I source a new version of the function stored in a separate directory, but some of the functions dependent on it continue to reference to the package version of the functions, this means that when I'm doing test #2 I have to load lots more functions and hope I've caught them all (or do some sort of dependency hunting programmatically).
>
> I may be missing something about testthat, but what I'm doing now seems to be nowhere near optimal and I'd love to have a better solution.
>
> Cheers
>
> Stephanie Locke
> BI & Credit Risk Analyst
>
> -----Original Message-----
> From: ONKELINX, Thierry [mailto:Thierry.ONKELINX at inbo.be]
> Sent: 10 September 2014 09:30
> To: Stephanie Locke; r-devel at r-project.org
> Subject: RE: How to test impact of candidate changes to package?
>
> Dear Stephanie,
>
> Have a look at the testthat package and the related article in the R Journal.
>
> Best regards,
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> -----Oorspronkelijk bericht-----
> Van: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] Namens Stephanie Locke
> Verzonden: woensdag 10 september 2014 9:55
> Aan: r-devel at r-project.org
> Onderwerp: [Rd] How to test impact of candidate changes to package?
>
> I use a package to contain simple functions that can be handled by unit tests for correctness and more complex functions that combine the simple functions with business logic.  Where there are proposals to change either the simple functions or the business logic, a sample needs to be run before the change and then after it to understand the impact of the change.
>
> I do this currently by
> 1. Using Rmarkdown documents
> 2. Loading the package as-is
> 3. Getting my sample
> 4. Running my sample through the package as-is and outputting table of results 5. sourceing new copies of functions 6. Running my sample again and outputting table of results 7. Reloading package and sourceing different copies of functions as required
>
> I really don't think this is a good way to do this as it risks missing downstream dependencies of the functions I'm trying to load into the global namespace to test.
>
> Has anyone else had to do this sort of testing before on their packages? How did you do it? Am I missing an obvious package / framework that can do this?
>
> Cheers,
> Steph
>
> --
> Stephanie Locke
> BI & Credit Risk Analyst
>
>
>
>
> The contents of this e-mail and of any attachments transmitted with it are confidential and intended solely for the use of the individual(s) to whom they are addressed. If you are not an intended recipient or the person responsible for delivering this e-mail to the intended recipient(s), you have received this e-mail in error, and access to it by you is not authorised. You may not use, copy, distribute, disclose or rely on it or any attachment, or any part of it or any attachment in any way. If you have received this e-mail in error please notify Optimum Credit Ltd by email on webmaster at optimumcredit.co.uk or phone on 03330 143125 and then delete it.
>
> All reasonable precautions have been taken to ensure that no viruses are present in E-mail. As we cannot accept responsibility for loss or damage arising from the use of E-mail or any attachment we recommend you subject these to your usual virus checking procedures prior to use. Any opinions expressed in this e-mail are those of the person sending it and not necessarily those of Optimum Credit Ltd.
>
> Optimum Credit Ltd, Haywood House South, Dumfries Place, Cardiff, CF10 3GA
>
> Authorised and regulated by the Financial Conduct Authority
>
> Optimum Credit Ltd. Registered office: Haywood House South, Dumfries Place, Cardiff, CF10 3GA. Registered in England and Wales No. 08698121
>
> Calls may be monitored or recorded for training, compliance and evidential purposes.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
>
>
> The contents of this e-mail and of any attachments transmitted with it are confidential and intended solely for the use of the individual(s) to whom they are addressed. If you are not an intended recipient or the person responsible for delivering this e-mail to the intended recipient(s), you have received this e-mail in error, and access to it by you is not authorised. You may not use, copy, distribute, disclose or rely on it or any attachment, or any part of it or any attachment in any way. If you have received this e-mail in error please notify Optimum Credit Ltd by email on webmaster at optimumcredit.co.uk or phone on 03330 143125 and then delete it.
>
> All reasonable precautions have been taken to ensure that no viruses are present in E-mail. As we cannot accept responsibility for loss or damage arising from the use of E-mail or any attachment we recommend you subject these to your usual virus checking procedures prior to use. Any opinions expressed in this e-mail are those of the person sending it and not necessarily those of Optimum Credit Ltd.
>
> Optimum Credit Ltd, Haywood House South, Dumfries Place, Cardiff, CF10 3GA
>
> Authorised and regulated by the Financial Conduct Authority
>
> Optimum Credit Ltd. Registered office: Haywood House South, Dumfries Place, Cardiff, CF10 3GA. Registered in England and Wales No. 08698121
>
> Calls may be monitored or recorded for training, compliance and evidential purposes.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jeroen.ooms at stat.ucla.edu  Wed Sep 10 15:40:53 2014
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Wed, 10 Sep 2014 15:40:53 +0200
Subject: [Rd] CRAN form submission confirmation link
Message-ID: <CABFfbXu6tKyjoaz__zb50aFEDbxTpv1Bo1L4n9WbYzwoH7e5fg@mail.gmail.com>

There is a small problem in the CRAN submission form, which is not super
urgent but probably good to be aware of.

So I noticed that after I submitted a package, the submission was confirmed
without me actually clicking the link in the confirmation email (which
could be a potential security risk). I suspect that this happens because
many modern browsers use pre-rendering, which retrieves hyperlinks on a
page before the user actually clicks on it. This is perfectly legal because
the HTTP GET method [1] is defined to be "safe" and "idempotent", and
therefore a GET request should never change server state. And this is where
the current implementation of the confirmation page might violate HTTP.

I think the proper way to implement this would be if the link in the
confirmation email would lead to a page where the user has to click a
button which results in a POST request to confirm the submission.

[1] http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html

	[[alternative HTML version deleted]]


From pgilbert902 at gmail.com  Wed Sep 10 15:46:27 2014
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Wed, 10 Sep 2014 09:46:27 -0400
Subject: [Rd] How to test impact of candidate changes to package?
In-Reply-To: <54102412.3080404@ivt.baug.ethz.ch>
References: <526d73b585084eecb2b72a92ab9f74b0@DB3PR01MB252.eurprd01.prod.exchangelabs.com>	<AA818EAD2576BC488B4F623941DA7427F3AEA7E5@inbomail.inbo.be>	<e476aba80ced41e0b8ed9ec181cd423f@DB3PR01MB252.eurprd01.prod.exchangelabs.com>
	<54102412.3080404@ivt.baug.ethz.ch>
Message-ID: <54105633.1070000@gmail.com>



On 09/10/2014 06:12 AM, Kirill M?ller wrote:
> If you don't intend to keep the old business logic in the long run,
> perhaps a version control system such as Git can help you. If you use it
> in single-user mode, you can think of it as a backup system where you
> manually create each snapshot and give it a name, but it actually can do
> much more. For your use case, you can open a new *branch* where you
> implement your changes, and implement your testing logic simultaneously
> in both branches (using *merge* operations). The system handles
> switching between branches, so you can really perform invasive changes,
> and revert if you find that a particular change breaks something.
>...

Yes, I would strongly recommend some version control system for this, 
probably either Git or svn (Subversion). If this is all code and test 
data that you can release publicly then you might choose some public 
repository like Github or R-forge. (You will get lots of opinions about 
the relative merits of different repositories if you ask, but the main 
point is that any one of them will be better than nothing.) If part of 
your code and data cannot be released then you might check if something 
is already supported in your place of business. Chances are that it is, 
but only programmers in IT have been told about it.

On 09/10/2014 11:14 AM, Stephanie Locke wrote:
 >> ...
>> Has anyone else had to do this sort of testing before on their
>> packages? How did you do it? Am I missing an obvious package /
>> framework that can do this?

Most package maintainers would face some version of this problem, some 
simpler and some much more complicated. If you set up the tests as 
scripts in the package tests/ directory that issue stop() in the case of 
a problem, then R-forge pretty much does the checking for you on 
multiple platforms, at least when it is working properly.

It is probably more trouble than it is worth for a single package, but 
if you have several packages with inter-dependencies then you might want 
to look at the develMake framework at 
http://automater.r-forge.r-project.org/

Regards,
Paul
>>
>> Cheers,
>> Steph
>>
>> --
>> Stephanie Locke
>> BI & Credit Risk Analyst


From macqueen1 at llnl.gov  Wed Sep 10 17:19:21 2014
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Wed, 10 Sep 2014 15:19:21 +0000
Subject: [Rd] Problem with order() and I()
In-Reply-To: <21519.11354.329455.593380@stat.math.ethz.ch>
References: <D033220C.10A9C4%macqueen1@llnl.gov>
	<21519.3164.832420.293156@stat.math.ethz.ch>
	<F975C5BF-8E58-4D84-AFEF-DE6950D1155E@gmail.com>
	<21519.11354.329455.593380@stat.math.ethz.ch>
Message-ID: <D035B77D.10ADC1%macqueen1@llnl.gov>

Early on I had been wondering if deprecating I() and the AsIs class would
be a way to get the problem to go away. I imagine (based on no data at
all!) that they are rarely used. If I were writing the same code today, I
would use options(stringsAsFactors=FALSE) instead of sprinkling I() here
and there throughout my scripts.

But I see from the discussions that there?s something deeper going on.

Thanks for continuing to cc me; I find it interesting.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 9/9/14, 9:35 AM, "Martin Maechler" <maechler at stat.math.ethz.ch> wrote:

>>>>>> peter dalgaard <pdalgd at gmail.com>
>>>>>>     on Tue, 9 Sep 2014 16:36:19 +0200 writes:
>
>    > It's actually a little more complicated. I wrote a note, but it
>seems to be stuck in the outbox on my home machine (I probably forgot to
>click Send...). 
>    > One important aspect is that
>
>    >> "x" < "\265g"
>    > [1] NA
>
>    > which makes me wonder if the bug really is in the case that
>"works". It seems that it is possible to rank() character vectors that
>contain incomparable elements.
>
>    > -pd
>
>yes you are right that it is even more complicated.
>In both cases, our Scollate() is involved,
>(Scollate: the one where we had a discussion about making it part of the C
> level R API, which would help package authors ..)
>
>After
>
>  ch <- c('x','\265g')
>  foo <- I(ch)
>
>Of the four expressions,
>
>  order(ch)
>  order(foo)
>  ch [1] < ch [2]
>  foo[1] < foo[2]
>
>only the first one "works", the others give NA or an error because of NA
>and the first one is the only of the 4 that does not use
>do_relop_dflt()
>
>It's not even clear what we'd want (as I think  pd also alluded to):
>Ideally all of these should work consistently, which because of
> "<(.,.)" returning NA in both cases,
>would mean that order(ch) also should give an error as order(foo)
>    {{ an error we should improve the message in any case!!}.
>Big Q:  Can we afford  order(ch)  giving an error in such cases.
>Pretty high chance that this will "break" much user (and probably
>even package) code out there.
>
>Still, the other solution, namely  order(foo) behaving as
>order(ch) now does would correspond to the ">" giving FALSE
>instead of NA, so this solution is not ok in my view.
>
>Martin
>
>
>    > On 09 Sep 2014, at 16:19 , Martin Maechler
><maechler at stat.math.ethz.ch> wrote:
>
>    >>>>>>> MacQueen, Don <macqueen1 at llnl.gov>
>    >>>>>>> on Mon, 8 Sep 2014 16:06:21 +0000 writes:
>    >> 
>    >>> I have found that order() fails in a rather arcane circumstance,
>as in
>    >>> this example:
>    >> 
>    >>>> foo <- I( c('x','\265g') )
>    >>>> order(foo)
>    >>> Error in if (xi > xj) 1L else -1L : missing value where
>TRUE/FALSE needed
>    >> 
>    >>>> foo <-c('x','\265g')
>    >>>> order(foo)
>    >>> [1] 1 2
>    >> 
>    >> yes, this is not desirable.
>    >> order() in such cases calls xtfrm()  {as documented}
>    >> and that ends up calling rank() and then the internal  .gt()
>    >> where the bug happens because
>    >> 
>    >>> I("x") > I("\xb5g")
>    >> [1] NA
>    >> 
>    >> but really I think the change should happen in xtfrm.Asis(.)
>    >> which I think should drop the class also in this case.
>    >> 
>    >> More on this, once we have fixed it.
>    >> 
>    >> Thank you, Don, very much!
>    >> 
>    >> Martin Maechler,
>    >> ETH Zurich
>    >> 
>    >>>> sessionInfo()
>    >>> R version 3.1.1 (2014-07-10)
>    >>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>    >> 
>    >>> locale:
>    >>> [1] C
>    >> 
>    >>> attached base packages:
>    >>> [1] stats     graphics  grDevices utils     datasets  methods
>base
>    >> 
>    >>> Thanks
>    >>> -Don
>    >> 
>    >>> p.s.
>    >>> Just a little background, irrelevant unless one wonders why I?m
>using I()
>    >>> and \265:
>    >> 
>    >>> If I were writing new code I wouldn?t be using I(), since there
>are better
>    >>> ways now to achieve the same end (preventing the creation of
>factors in
>    >>> data frames), but the scripts that use it are quite old,
>originally
>    >>> developed in 2001.
>    >> 
>    >>> In at least some but perhaps limited contexts, ?\265? produces
>the greek
>    >>> letter mu, and that?s why I?m using it. And if I remember
>correctly, 2001
>    >>> is prior to the current R support for locales and extended
>character sets.
>    >>> Using \265 is what I could find at that time to get a mu into my
>output.
>    >> 
>    >>> I came across this while checking some things; it?s not actually
>breaking
>    >>> my scripts, so I doubt it?s due to any recent change.
>    >> 
>    >> 
>    >>> -- 
>    >>> Don MacQueen
>    >> 
>    >>> Lawrence Livermore National Laboratory
>    >>> 7000 East Ave., L-627
>    >>> Livermore, CA 94550
>    >>> 925-423-1062
>    >> 
>    >>> ______________________________________________
>    >>> R-devel at r-project.org mailing list
>    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>    >> 
>    >> ______________________________________________
>    >> R-devel at r-project.org mailing list
>    >> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>    > -- 
>    > Peter Dalgaard, Professor,
>    > Center for Statistics, Copenhagen Business School
>    > Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>    > Phone: (+45)38153501
>    > Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
>
>
>
>
>
>


From mtmorgan at fhcrc.org  Wed Sep 10 20:49:31 2014
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Wed, 10 Sep 2014 11:49:31 -0700
Subject: [Rd] install.packages misleads about package availability?
Message-ID: <54109D3B.6080804@fhcrc.org>

In the context of installing a Bioconductor package using our biocLite() 
function, install.packages() warns

 > install.packages("RUVSeq", repos="http://bioconductor.org/packages/2.14/bioc")
Installing package into '/home/mtmorgan/R/x86_64-unknown-linux-gnu-library/3.1-2.14'
(as 'lib' is unspecified)
Warning message:
package 'RUVSeq' is not available (for R version 3.1.1 Patched)

but really the problem is that the package is not available at the specified 
repository (it is available, for the same version of R, in the Bioc devel 
repository http://bioconductor.org/packages/3.0/bioc).

I can see the value of identifying the R version, and see that mentioning 
something about 'specified repositories' would not necessarily be helpful. Also, 
since the message is translated and our user base is international, it is 
difficult to catch and process by the biocLite() script.

Is there a revised wording that could be employed to more accurately convey the 
reason for the failure, or is this an opportunity to use the condition system?

Index: src/library/utils/R/packages2.R
===================================================================
--- src/library/utils/R/packages2.R	(revision 66562)
+++ src/library/utils/R/packages2.R	(working copy)
@@ -46,12 +46,12 @@
      p0 <- unique(pkgs)
      miss <-  !p0 %in% row.names(available)
      if(sum(miss)) {
-	warning(sprintf(ngettext(sum(miss),
-				 "package %s is not available (for %s)",
-				 "packages %s are not available (for %s)"),
-			paste(sQuote(p0[miss]), collapse=", "),
-			sub(" *\\(.*","", R.version.string)),
-                domain = NA, call. = FALSE)
+        txt <- ngettext(sum(miss), "package %s is not available (for %s)",
+                        "packages %s are not available (for %s)")
+        msg <- simpleWarning(sprintf(txt, paste(sQuote(p0[miss]), collapse=", "),
+                                     sub(" *\\(.*","", R.version.string)))
+        class(msg) <- c("packageNotAvailable", class(msg))
+	 warning(msg)
          if (sum(miss) == 1L &&
              !is.na(w <- match(tolower(p0[miss]),
                                tolower(row.names(available))))) {

-- 
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From maechler at stat.math.ethz.ch  Thu Sep 11 11:16:56 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 11 Sep 2014 11:16:56 +0200
Subject: [Rd] install.packages misleads about package availability?
In-Reply-To: <54109D3B.6080804@fhcrc.org>
References: <54109D3B.6080804@fhcrc.org>
Message-ID: <21521.26760.346920.775217@stat.math.ethz.ch>

>>>>> Martin Morgan <mtmorgan at fhcrc.org>
>>>>>     on Wed, 10 Sep 2014 11:49:31 -0700 writes:

    > In the context of installing a Bioconductor package using our biocLite() 
    > function, install.packages() warns

    >> install.packages("RUVSeq", repos="http://bioconductor.org/packages/2.14/bioc")
    > Installing package into '/home/mtmorgan/R/x86_64-unknown-linux-gnu-library/3.1-2.14'
    > (as 'lib' is unspecified)
    > Warning message:
    > package 'RUVSeq' is not available (for R version 3.1.1 Patched)

    > but really the problem is that the package is not available at the specified 
    > repository (it is available, for the same version of R, in the Bioc devel 
    > repository http://bioconductor.org/packages/3.0/bioc).

    > I can see the value of identifying the R version, and see that mentioning 
    > something about 'specified repositories' would not necessarily be helpful. Also, 
    > since the message is translated and our user base is international, it is 
    > difficult to catch and process by the biocLite() script.

    > Is there a revised wording that could be employed to more accurately convey the 
    > reason for the failure, or is this an opportunity to use the condition system?

    > Index: src/library/utils/R/packages2.R
    > ===================================================================
    > --- src/library/utils/R/packages2.R	(revision 66562)
    > +++ src/library/utils/R/packages2.R	(working copy)
    > @@ -46,12 +46,12 @@
    > p0 <- unique(pkgs)
    > miss <-  !p0 %in% row.names(available)
    > if(sum(miss)) {
    > -	warning(sprintf(ngettext(sum(miss),
    > -				 "package %s is not available (for %s)",
    > -				 "packages %s are not available (for %s)"),
    > -			paste(sQuote(p0[miss]), collapse=", "),
    > -			sub(" *\\(.*","", R.version.string)),
    > -                domain = NA, call. = FALSE)
    > +        txt <- ngettext(sum(miss), "package %s is not available (for %s)",
    > +                        "packages %s are not available (for %s)")
    > +        msg <- simpleWarning(sprintf(txt, paste(sQuote(p0[miss]), collapse=", "),
    > +                                     sub(" *\\(.*","", R.version.string)))
    > +        class(msg) <- c("packageNotAvailable", class(msg))
    > +	 warning(msg)
    > if (sum(miss) == 1L &&
    > !is.na(w <- match(tolower(p0[miss]),
    > tolower(row.names(available))))) {

Yes, I think this would be a fine example and the first one in
"base R" AFAIK of using the condition system by sub classing.

The fact that you cannot check for the warning/error message *text* in
your own tryCatch() or similar  because of internationalization
and hence translation had bitten other people before... and I am
sure is still wrongly used also in package land.. where the bug
never triggers as long as testing is done in the C or an 'en' locale.

How would your  biocLite()  be adapted to use "packageNotAvailable" ?

Martin Maechler, ETH Zurich


From anthony at ravingmantis.com  Thu Sep 11 17:47:55 2014
From: anthony at ravingmantis.com (Anthony Hennessey)
Date: Thu, 11 Sep 2014 16:47:55 +0100
Subject: [Rd] Request for an 'R CMD check' on Solaris10
Message-ID: <CANYQC9bLsC4VEVxwtEWWPrmZ=fDuaeup+fAeJ+8jPoeUtGbaPA@mail.gmail.com>

Our 'unittest' package is failing the CRAN checks for r-patched-solaris-*
Based on the Solaris and R docs we think we have a fix but our maths dept
does not have any Solaris machines and we have had no success in building a
VM with a working R.

If anyone would be willing to CMD check the attached package source on Solaris
10 with R >= 3.0.0 and post any error we would be most grateful (as we are
scheduled to be archived very soon). if we do not submit a fix).

Hopefully

Anthony H
-------------- next part --------------
A non-text attachment was scrubbed...
Name: unittest_1.0-1.tar.gz
Type: application/x-gzip
Size: 6954 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20140911/4d86a2ff/attachment.gz>

From edd at debian.org  Thu Sep 11 23:14:51 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 11 Sep 2014 16:14:51 -0500
Subject: [Rd] Request for an 'R CMD check' on Solaris10
In-Reply-To: <CANYQC9bLsC4VEVxwtEWWPrmZ=fDuaeup+fAeJ+8jPoeUtGbaPA@mail.gmail.com>
References: <CANYQC9bLsC4VEVxwtEWWPrmZ=fDuaeup+fAeJ+8jPoeUtGbaPA@mail.gmail.com>
Message-ID: <21522.4299.660951.247703@max.nulle.part>


Hi Anthony,

Sadly I do not have access to Solaris so I cannot help you. Worse yet, I am
in need of a similar issue for one of my CRAN packages.  So if someone
reaches out to you and seems eager to help some more I could do with another
small test on Solaris.  

Best of luck -- I hope someone can help you out.

Regards,  Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From csardi.gabor at gmail.com  Thu Sep 11 23:20:32 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 11 Sep 2014 17:20:32 -0400
Subject: [Rd] Request for an 'R CMD check' on Solaris10
In-Reply-To: <21522.4299.660951.247703@max.nulle.part>
References: <CANYQC9bLsC4VEVxwtEWWPrmZ=fDuaeup+fAeJ+8jPoeUtGbaPA@mail.gmail.com>
	<21522.4299.660951.247703@max.nulle.part>
Message-ID: <CABtg=KmG3bnnkUcz0ZRbSb7MWdWv1zxT5SWS+=aa_yi_nPkt3A@mail.gmail.com>

Hi Dirk and Anthony,

I have a Solaris VM with R, on an old machine of mine, but will only
have access to it tomorrow. So if nobody else can do it, I can try to
give you access to the VM tomorrow, or just run the check. I might
need to update R on it, though, AFAIR it either has 3.0.0 or 2.15.x.

Gabor

On Thu, Sep 11, 2014 at 5:14 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> Hi Anthony,
>
> Sadly I do not have access to Solaris so I cannot help you. Worse yet, I am
> in need of a similar issue for one of my CRAN packages.  So if someone
> reaches out to you and seems eager to help some more I could do with another
> small test on Solaris.
>
> Best of luck -- I hope someone can help you out.
>
> Regards,  Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From cgenolin at u-paris10.fr  Fri Sep 12 15:10:14 2014
From: cgenolin at u-paris10.fr (cgenolin)
Date: Fri, 12 Sep 2014 06:10:14 -0700 (PDT)
Subject: [Rd] Compatibility issues between Matrix and kml
Message-ID: <1410527414882-4696885.post@n4.nabble.com>

Hi the list,

I am the maintainer of the package kml. I quite often receive some email
about a specific bug. The answer is always the same, I tell people to remove
the package Matrix, and then kml works fine.

I wonder what my code is not compatible with the Matrix package. Here is a
(simplified) version of the kml code :

--- 8< ------------
library(longitudinalData)

setClass(Class="CLD", contains=c("LongData","ListPartition"))

myCld <- new("CLD",
        idAll=as.character(c(100,102,103,109,115,123)),
        idFewNA=as.character(c(100,102,103,109,115,123)),
        time=c(1,2,4,8,15), varNames="P",
        traj=matrix(c(1,2,3,1,4, 3,6,1,8,10, 1,2,1,3,2, 4,2,5,6,3,
4,3,4,4,4, 7,6,5,5,4),6),
        dimTraj=c(6,5), maxNA=3,  reverse=matrix(c(0,1),2,1)
)

setMethod("[",
     signature=signature(x="CLD", i="character", j="ANY",drop="ANY"),
     definition=function (x, i, j="missing", ..., drop = TRUE){
         x <- as(x, "LongData")
         return(x[i, j])
     }
)
# [1] "["

myCld["idAll"]
# [1] "100" "102" "103" "109" "115" "123"

--- 8< ---------------

This code works just fine, there is no error.

But if I load the package Matrix and I run the same code, I get:

--- 8< ----------------
library(Matrix)
library(longitudinalData)

setClass(Class="CLD", contains=c("LongData","ListPartition"))

myCld <- new("CLD",
        idAll=as.character(c(100,102,103,109,115,123)),
        idFewNA=as.character(c(100,102,103,109,115,123)),
        time=c(1,2,4,8,15), varNames="P",
        traj=matrix(c(1,2,3,1,4, 3,6,1,8,10, 1,2,1,3,2, 4,2,5,6,3,
4,3,4,4,4, 7,6,5,5,4),6),
        dimTraj=c(6,5), maxNA=3,  reverse=matrix(c(0,1),2,1)
)

setMethod("[",
     signature=signature(x="CLD", i="character", j="ANY",drop="ANY"),
     definition=function (x, i, j="missing", ..., drop = TRUE){
         x <- as(x, "LongData")
         return(x[i, j])
     }
)

# [1] "["

myCld["idAll"]
# Error in myCld["idAll"]:
#   Argument "j" is missing, with no default value
--- 8< ----------------

Any idea of what is going wrong?

Christophe




--
View this message in context: http://r.789695.n4.nabble.com/Compatibility-issues-between-Matrix-and-kml-tp4696885.html
Sent from the R devel mailing list archive at Nabble.com.


From pgilbert902 at gmail.com  Fri Sep 12 21:13:33 2014
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 12 Sep 2014 15:13:33 -0400
Subject: [Rd] requireNamespace() questions
Message-ID: <541345DD.1090001@gmail.com>


I am trying to follow directions at 
http://cran.r-project.org/doc/manuals/r-patched/R-exts.html#Suggested-packages 
regarding handling suggested packages with requireNamespace() rather 
than require(), and I have some questions.

1/ When I do requireNamespace() in a function is the loading of the 
namespace only effective within the function?

2/ At the link above in the manual it says "Note the use of rgl:: as 
that object would not necessarily be visible...".   When the required 
package is loading methods, will the method be found when I reference 
the generic, which is not in the package, or do I need to do something 
different?

3/ In some packages I have functions that return an object defined in 
the suggested package being required. For example, a function does 
require("zoo") and then returns a zoo object. So, to work with the 
returned object I am really expecting that zoo will be available in the 
session afterwards. Is it recommended that I just check if the package 
is available on the search path the user has set rather than use 
require() or requireNamespace()?.

Regarding checking the path without actually attaching the package to 
the search path, is there something better than "package:zoo" %in% 
search() or is that the best way?

4/ I have a function in a package that Depends on DBI and suggests 
RMySQL, RPostgreSQL, RSQLite. The function uses dbDriver() in DBI which 
uses do.call(). If I use requireNamespace() in place of require() I get

 > requireNamespace("RMySQL")
Loading required namespace: RMySQL
 > m <- dbDriver("MySQL")
Error in do.call(as.character(drvName), list(...)) :
   could not find function "MySQL"

 > require("RMySQL")
Loading required package: RMySQL
 > m <- dbDriver("MySQL")
 >

Is there a different way to handle this without altering the search path?

The function do.call() does not seem to work with an argument like
    do.call("RMySQL::MySQL", list())
even at the top level, and this situation may be more complicated when 
it is in a required package. What am I missing?

Thanks,
Paul


From h.wickham at gmail.com  Fri Sep 12 23:06:33 2014
From: h.wickham at gmail.com (Hadley Wickham)
Date: Fri, 12 Sep 2014 17:06:33 -0400
Subject: [Rd] requireNamespace() questions
In-Reply-To: <541345DD.1090001@gmail.com>
References: <541345DD.1090001@gmail.com>
Message-ID: <CABdHhvF=FhZoP5PLZa4KevAGRPmtLQfp9FLryQfWFZFNzsdwMA@mail.gmail.com>

On Fri, Sep 12, 2014 at 3:13 PM, Paul Gilbert <pgilbert902 at gmail.com> wrote:
>
> I am trying to follow directions at
> http://cran.r-project.org/doc/manuals/r-patched/R-exts.html#Suggested-packages
> regarding handling suggested packages with requireNamespace() rather than
> require(), and I have some questions.
>
> 1/ When I do requireNamespace() in a function is the loading of the
> namespace only effective within the function?

Loading the namespace is (effectively) permanent. But the only thing
loading the namespace does is trigger the .onLoad() if present; it
does not affect the search path.

> 2/ At the link above in the manual it says "Note the use of rgl:: as that
> object would not necessarily be visible...".   When the required package is
> loading methods, will the method be found when I reference the generic,
> which is not in the package, or do I need to do something different?

Method should be found correctly.

> 3/ In some packages I have functions that return an object defined in the
> suggested package being required. For example, a function does
> require("zoo") and then returns a zoo object. So, to work with the returned
> object I am really expecting that zoo will be available in the session
> afterwards. Is it recommended that I just check if the package is available
> on the search path the user has set rather than use require() or
> requireNamespace()?.

That may be a reasonable place to require(), in my opinion.

> 4/ I have a function in a package that Depends on DBI and suggests RMySQL,
> RPostgreSQL, RSQLite. The function uses dbDriver() in DBI which uses
> do.call(). If I use requireNamespace() in place of require() I get
>
>> requireNamespace("RMySQL")
> Loading required namespace: RMySQL
>> m <- dbDriver("MySQL")
> Error in do.call(as.character(drvName), list(...)) :
>   could not find function "MySQL"
>
>> require("RMySQL")
> Loading required package: RMySQL
>> m <- dbDriver("MySQL")
>>
>
> Is there a different way to handle this without altering the search path?

I think it's best to do

m <- dbConnect(RMySQL::MySQL, ...)

and avoid do.call() where possible. (I'm pretty sure it is possible,
but it may require changes to the DBI backends), many of which assume
the package to be on the search path.

do.call() probably doesn't do what you think it does:
http://rpubs.com/hadley/do-call2

Hadley

-- 
http://had.co.nz/


From jari.oksanen at oulu.fi  Sat Sep 13 07:13:37 2014
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Sat, 13 Sep 2014 05:13:37 +0000
Subject: [Rd] vegan moved to GitHub and vegan 2.2-0 is coming (are you
	ready?)
Message-ID: <4DF833D8-0EDF-4773-90EE-F2A81721A98F@oulu.fi>

Dear vegan team,

Vegan development happens now completely in github. R-Forge repository is no more in sync with github. I tried to commit all github changes to R-Forge, but a week ago I got a conflict in file and I haven't had time to resolve that conflict. You can follow vegan development and vegan discussion also without signing to github. The system seems to be completely open and does not require any user credentials (and this is good to remember when we discuss about things). The developer front page is

https://github.com/vegandevs

We have prepared for the vegan 2.2-0 release. This would be a major release that would close the gap between current development version and CRAN. I haven't set any firm date for the release, but I think R 3.2.0 will be out in October, and we should try to be concurrent with that -- in particular as the 2.0-10 in CRAN will give warnings in R check for that version.

We have now solved a couple of major issues.

- on technical side: the next R release will spit out tens of warnings for namespace issues (visibility of functions). These were solved in https://github.com/vegandevs/vegan/pull/28

- all vegan functions doing permutation are now based on Gav's permute package. This means that they can use any constrained permutation scheme of the permute package. This also concerns functions that earlier only had simple permutation. Of course, you do not need to use fancy permutation schemes, but the default is still simple permutation and this can be expressed by giving just the number of permutations on the command line. The functions using the new permutation scheme are adonis, anosim, anova.cca for CCA/RDA/dbRDA and hence also for ordistep etc., CCorA, envfit, mantel & mantel.partial, mrpp, mso, permutest.betadisper, permutest.cca, protest and simper. The change for functions is now complete, but same clean up and updating of documentation is still to be done. This is discussed in https://github.com/vegandevs/vegan/issues/31

- vegan 2.2-0 will also use parallel processing in several functions. This was already done in several functions in vegan development. The discussion on extending parallel processing to other functions was just opened in https://github.com/vegandevs/vegan/issues/36 . Currently the following functions can use parallel processing: adonis, anosim, anova.cca, mantel, mantel.partial, mrpp and simper can use it permutations, bioenv can asses several competing models in parallel, metaMDS can launch several random starts in parallel and oecosimu can use parallel processing in evaluating the statistics for null communities. If you compare this to the previous list of permutation functions, you see that the following permutation methods do not use parallel procesing: CCorA, envfit, mso, permutest.betadisper and protest. The question is if these also should be parallelized or can we leave them like they are, at least for the next release.

- A more controversial issue is that Gav suggested moving rgl-based functions away from vegan to a separate package (https://github.com/vegandevs/vegan/issues/29 ). The main reason was that rgl can cause problems in several platforms and even prevent installing vegan. Indeed, when I tested these functions, they crashed in this Mac laptop. We have now a separate vegan3d package for these functions https://github.com/vegandevs/vegan3d . In addition to ordirgl + friends, rgl.isomap and rgl.renyiaccum it also has oriplot3d package. This package has now the same functionality as these functions had in vegan, and our purpose is to release that concurrently with vegan 2.2-0. I recently suggested to remove these functions from vegan, but we haven't made that change yet so that you can express your opinion on the move. See https://github.com/vegandevs/vegan/pull/37

There are some simpler and smaller things, but you can see those if you follow github.

I have now mainly worked with my private fork of vegan and "pushed to vegan upstream" changes when they have looked more or less finished. At this stage, I have made a "pull request", and normally waited for possible comments. To get a second opinion, I have usually waited that Gav has a look at the functions and let him merge them to vegan. Sometimes there has been a long discussion before merge and we have edited the functions before the merge (e.g., https://github.com/vegandevs/vegan/pull/34 ). If changes are small and isolated bug fixes, I have pushed them directly to the vegan upstream, though. I have found this pretty good way of working in github.

Cheers, Jari Oksanen

From jari.oksanen at oulu.fi  Sat Sep 13 16:50:23 2014
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Sat, 13 Sep 2014 14:50:23 +0000
Subject: [Rd] vegan moved to GitHub and vegan 2.2-0 is coming (are
	you	ready?)
In-Reply-To: <4DF833D8-0EDF-4773-90EE-F2A81721A98F@oulu.fi>
References: <4DF833D8-0EDF-4773-90EE-F2A81721A98F@oulu.fi>
Message-ID: <B583770E-0845-4645-AA60-9C6C558DE4EE@oulu.fi>

Dear R-Devels,

My apologies for using a wrong list. Please ignore my messages. I would undo this if I only could, but what's done can't be undone (not the the first time in my life when I've learnt this).

Cheers, Jari Oksanen
On 13/09/2014, at 08:13 AM, Jari Oksanen wrote:

> Dear vegan team,
> 
> Vegan development happens now completely in github. R-Forge repository is no more in sync with github. I tried to commit all github changes to R-Forge, but a week ago I got a conflict in file and I haven't had time to resolve that conflict. You can follow vegan development and vegan discussion also without signing to github. The system seems to be completely open and does not require any user credentials (and this is good to remember when we discuss about things). The developer front page is
> 
> https://github.com/vegandevs
> 
> We have prepared for the vegan 2.2-0 release. This would be a major release that would close the gap between current development version and CRAN. I haven't set any firm date for the release, but I think R 3.2.0 will be out in October, and we should try to be concurrent with that -- in particular as the 2.0-10 in CRAN will give warnings in R check for that version.
> 
> We have now solved a couple of major issues.
> 
> - on technical side: the next R release will spit out tens of warnings for namespace issues (visibility of functions). These were solved in https://github.com/vegandevs/vegan/pull/28
> 
> - all vegan functions doing permutation are now based on Gav's permute package. This means that they can use any constrained permutation scheme of the permute package. This also concerns functions that earlier only had simple permutation. Of course, you do not need to use fancy permutation schemes, but the default is still simple permutation and this can be expressed by giving just the number of permutations on the command line. The functions using the new permutation scheme are adonis, anosim, anova.cca for CCA/RDA/dbRDA and hence also for ordistep etc., CCorA, envfit, mantel & mantel.partial, mrpp, mso, permutest.betadisper, permutest.cca, protest and simper. The change for functions is now complete, but same clean up and updating of documentation is still to be done. This is discussed in https://github.com/vegandevs/vegan/issues/31
> 
> - vegan 2.2-0 will also use parallel processing in several functions. This was already done in several functions in vegan development. The discussion on extending parallel processing to other functions was just opened in https://github.com/vegandevs/vegan/issues/36 . Currently the following functions can use parallel processing: adonis, anosim, anova.cca, mantel, mantel.partial, mrpp and simper can use it permutations, bioenv can asses several competing models in parallel, metaMDS can launch several random starts in parallel and oecosimu can use parallel processing in evaluating the statistics for null communities. If you compare this to the previous list of permutation functions, you see that the following permutation methods do not use parallel procesing: CCorA, envfit, mso, permutest.betadisper and protest. The question is if these also should be parallelized or can we leave them like they are, at least for the next release.
> 
> - A more controversial issue is that Gav suggested moving rgl-based functions away from vegan to a separate package (https://github.com/vegandevs/vegan/issues/29 ). The main reason was that rgl can cause problems in several platforms and even prevent installing vegan. Indeed, when I tested these functions, they crashed in this Mac laptop. We have now a separate vegan3d package for these functions https://github.com/vegandevs/vegan3d . In addition to ordirgl + friends, rgl.isomap and rgl.renyiaccum it also has oriplot3d package. This package has now the same functionality as these functions had in vegan, and our purpose is to release that concurrently with vegan 2.2-0. I recently suggested to remove these functions from vegan, but we haven't made that change yet so that you can express your opinion on the move. See https://github.com/vegandevs/vegan/pull/37
> 
> There are some simpler and smaller things, but you can see those if you follow github.
> 
> I have now mainly worked with my private fork of vegan and "pushed to vegan upstream" changes when they have looked more or less finished. At this stage, I have made a "pull request", and normally waited for possible comments. To get a second opinion, I have usually waited that Gav has a look at the functions and let him merge them to vegan. Sometimes there has been a long discussion before merge and we have edited the functions before the merge (e.g., https://github.com/vegandevs/vegan/pull/34 ). If changes are small and isolated bug fixes, I have pushed them directly to the vegan upstream, though. I have found this pretty good way of working in github.
> 
> Cheers, Jari Oksanen
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From andre_mikulec at hotmail.com  Mon Sep 15 23:25:49 2014
From: andre_mikulec at hotmail.com (Andre Mikulec)
Date: Mon, 15 Sep 2014 17:25:49 -0400
Subject: [Rd] Debug an R  windows (Fortran) DLL within R with gdb?
Message-ID: <BLU174-W2834A37215473FEE12D3F39CC80@phx.gbl>


Hi,?
I have a Fortran 77 subroutine (dll).

On windows XP, how ?would I 'debug it(Fortran) within R' using gdb?

This is how I made it.
----------------------

R CMD SHLIB main.f

gfortran -m32 ? ? -O3 ?-mtune=core2 -c main.f -o main.o

gcc -m32 -shared -s -static-libgcc -o main.dll tmp.def main.o -Ld:/RCompile/CRANpkg/extralibs64/local/lib/i386 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -lgfortran -LF:/ProgramFiles/R/R-3.1.1/bin/i386 -lR


Here is the contents of the file ?main.f
-----------------------------------------

? ? ? SUBROUTINE NGCD(NA, NB, NGCDO)?
? ? ? ? IA = NA
? ? ? ? IB = NB
? ? 1 ? IF (IB.NE.0) THEN
? ? ? ? ? ITEMP = IA
? ? ? ? ? IA = IB
? ? ? ? ? IB = MOD(ITEMP, IB)
? ? ? ? ? GOTO 1
? ? ? ? END IF
? ? ? ? NGCDO = IA ?
? ? ? ? RETURN
? ? ? END

Thank you,
Andre Mikulec
Andre_Mikulec at Hotmail.com


 		 	   		  

From murdoch.duncan at gmail.com  Tue Sep 16 00:05:36 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 15 Sep 2014 18:05:36 -0400
Subject: [Rd] Debug an R  windows (Fortran) DLL within R with gdb?
In-Reply-To: <BLU174-W2834A37215473FEE12D3F39CC80@phx.gbl>
References: <BLU174-W2834A37215473FEE12D3F39CC80@phx.gbl>
Message-ID: <541762B0.1050501@gmail.com>

On 15/09/2014, 5:25 PM, Andre Mikulec wrote:
> 
> Hi, 
> I have a Fortran 77 subroutine (dll).
> 
> On windows XP, how  would I 'debug it(Fortran) within R' using gdb?
> 
> This is how I made it.
> ----------------------
> 
> R CMD SHLIB main.f
> 
> gfortran -m32     -O3  -mtune=core2 -c main.f -o main.o
> 
> gcc -m32 -shared -s -static-libgcc -o main.dll tmp.def main.o -Ld:/RCompile/CRANpkg/extralibs64/local/lib/i386 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -lgfortran -LF:/ProgramFiles/R/R-3.1.1/bin/i386 -lR
> 
> 
> Here is the contents of the file  main.f
> -----------------------------------------
> 
>       SUBROUTINE NGCD(NA, NB, NGCDO) 
>         IA = NA
>         IB = NB
>     1   IF (IB.NE.0) THEN
>           ITEMP = IA
>           IA = IB
>           IB = MOD(ITEMP, IB)
>           GOTO 1
>         END IF
>         NGCDO = IA  
>         RETURN
>       END

I don't think you put in any compile options to include symbolic
information.  You need to do that.  I think the option you want is
-gdwarf-2, but I rarely use Fortran, and never use SHLIB, so I could be
wrong.  I'll assume you can figure out how to do that.

Run R under gdb using

gdb Rgui

Load your DLL.

Break to gdb using the menu entry "Misc | Break to debugger".

Set a breakpoint, e.g.

b main.f:3

to set it on line 3.  Then use c to let R continue, and make a call to
your code.  Then the usual gdb commands will work after it breaks.

Duncan Murdoch


From bbolker at gmail.com  Wed Sep 17 16:44:06 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 17 Sep 2014 10:44:06 -0400
Subject: [Rd] trivial typo in R-exts.texi
Message-ID: <54199E36.50801@gmail.com>

>From latest SVN release (66624).

 (I think I may have reported this before?)

430- at c DESCRIPTION field Maintainer
431-The mandatory @samp{Maintainer} field should give a @emph{single} name
432:followed a @emph{valid} (RFC 2822) email address in angle brackets.  It
433-should not end in a period or comma.  This field is what is reported by


"followed a" should be "followed by a", I think ...

  Ben Bolker


From bbolker at gmail.com  Wed Sep 17 17:04:38 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 17 Sep 2014 11:04:38 -0400
Subject: [Rd] issue with compiling r6
Message-ID: <5419A306.2070009@mcmaster.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

  I am painfully aware that this is most likely a problem with my
system, but I am nevertheless going to ask if anyone has any
ideas/suggestions for diagnosis and trouble-shooting.

- From a clean checkout of release 66624 on Ubuntu 12.04 (32-bit, sorry!):
gcc (Ubuntu/Linaro 4.6.4-1ubuntu1~12.04) 4.6.4

svn checkout https://svn.r-project.org/R/trunk/
tools/rsync-recommended

cd ../r-build
../r-devel/configure

R is now configured for i686-pc-linux-gnu

  Source directory:          ../r-devel
  Installation directory:    /usr/local

  C compiler:                gcc -std=gnu99  -g -O2
  Fortran 77 compiler:       gfortran  -g -O2

  C++ compiler:              g++  -g -O2
  C++ 11 compiler:           g++  -std=c++0x -g -O2
  Fortran 90/95 compiler:    gfortran -g -O2
  Obj-C compiler:	

  Interfaces supported:      X11, tcltk
  External libraries:        readline, lzma
  Additional capabilities:   PNG, JPEG, TIFF, NLS, cairo
  Options enabled:           shared BLAS, R profiling

  Capabilities skipped:      ICU
  Options not enabled:       memory profiling

make fails at:

byte-compiling 'methods'
initializing class and method definitions ...Error: .onLoad failed in
loadNamespace() for 'methods', details:
  call: new("classRepresentation")
  error: could not find function "isVirtualClass"

The only other oddity of my system/potential clue is that symbolic
links sometimes behave strangely because I am working on a VirtualBox
virtual machine with a virtual Linux filesystem layered over an HGFS
filesystem.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQEcBAEBAgAGBQJUGaMGAAoJEOCV5YRblxUHEvcIAKpNQbCRXhcOB5BhYKd5lnvZ
VLVfRQhM7rYDt9f9XFGwNigFAvA/47L9u0PDcYYVMJHLFUWObqMcsi4qfKA5y0LB
K8ZVG766HZqsLLFZVx7wzP1Ict0IcO1JudtkTSCfXXIq00lj6Dhs+6vU4HWoN6vg
rXQokhHX1cedNRKCLlXwHblN0DHZsj1EXTUSDzYJA3p1sO7KUqXmzE76+62vANKj
tLvBXk7771szHDmnD3oosLaYM0c7pEUzMJIgIg3TP+CBMVsMcrPMgVJ7zvMiWwQd
/2Qji9HBLkD6ODa29JYvn1DTXZzigF/gnG7ZBx8xN8d7rQ8v/cKY2ZNk8fg+4II=
=m0Kr
-----END PGP SIGNATURE-----


From pdalgd at gmail.com  Wed Sep 17 17:32:19 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 17 Sep 2014 17:32:19 +0200
Subject: [Rd] issue with compiling r6
In-Reply-To: <5419A306.2070009@mcmaster.ca>
References: <5419A306.2070009@mcmaster.ca>
Message-ID: <DF610537-0A50-4CE5-9739-2AA91F47CF2A@gmail.com>


On 17 Sep 2014, at 17:04 , Ben Bolker <bbolker at gmail.com> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
>  I am painfully aware that this is most likely a problem with my
> system, but I am nevertheless going to ask if anyone has any
> ideas/suggestions for diagnosis and trouble-shooting.
> 

Others have been seeing this since r66622, so I think you're just suffering the "unsuffered consequences" (unsuffered by regular users, that is; people who run development versions will suffer occasionally). Just hang on for a while. 

> - From a clean checkout of release 66624 on Ubuntu 12.04 (32-bit, sorry!):

That's _revision_ 66624, please. It is only "released" in the sense that it isn't kept secret. 

-pd

> gcc (Ubuntu/Linaro 4.6.4-1ubuntu1~12.04) 4.6.4
> 
> svn checkout https://svn.r-project.org/R/trunk/
> tools/rsync-recommended
> 
> cd ../r-build
> ../r-devel/configure
> 
> R is now configured for i686-pc-linux-gnu
> 
>  Source directory:          ../r-devel
>  Installation directory:    /usr/local
> 
>  C compiler:                gcc -std=gnu99  -g -O2
>  Fortran 77 compiler:       gfortran  -g -O2
> 
>  C++ compiler:              g++  -g -O2
>  C++ 11 compiler:           g++  -std=c++0x -g -O2
>  Fortran 90/95 compiler:    gfortran -g -O2
>  Obj-C compiler:	
> 
>  Interfaces supported:      X11, tcltk
>  External libraries:        readline, lzma
>  Additional capabilities:   PNG, JPEG, TIFF, NLS, cairo
>  Options enabled:           shared BLAS, R profiling
> 
>  Capabilities skipped:      ICU
>  Options not enabled:       memory profiling
> 
> make fails at:
> 
> byte-compiling 'methods'
> initializing class and method definitions ...Error: .onLoad failed in
> loadNamespace() for 'methods', details:
>  call: new("classRepresentation")
>  error: could not find function "isVirtualClass"
> 
> The only other oddity of my system/potential clue is that symbolic
> links sometimes behave strangely because I am working on a VirtualBox
> virtual machine with a virtual Linux filesystem layered over an HGFS
> filesystem.
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.11 (GNU/Linux)
> 
> iQEcBAEBAgAGBQJUGaMGAAoJEOCV5YRblxUHEvcIAKpNQbCRXhcOB5BhYKd5lnvZ
> VLVfRQhM7rYDt9f9XFGwNigFAvA/47L9u0PDcYYVMJHLFUWObqMcsi4qfKA5y0LB
> K8ZVG766HZqsLLFZVx7wzP1Ict0IcO1JudtkTSCfXXIq00lj6Dhs+6vU4HWoN6vg
> rXQokhHX1cedNRKCLlXwHblN0DHZsj1EXTUSDzYJA3p1sO7KUqXmzE76+62vANKj
> tLvBXk7771szHDmnD3oosLaYM0c7pEUzMJIgIg3TP+CBMVsMcrPMgVJ7zvMiWwQd
> /2Qji9HBLkD6ODa29JYvn1DTXZzigF/gnG7ZBx8xN8d7rQ8v/cKY2ZNk8fg+4II=
> =m0Kr
> -----END PGP SIGNATURE-----
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From bbolker at gmail.com  Wed Sep 17 18:56:28 2014
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 17 Sep 2014 12:56:28 -0400
Subject: [Rd] issue with compiling r6
In-Reply-To: <DF610537-0A50-4CE5-9739-2AA91F47CF2A@gmail.com>
References: <5419A306.2070009@mcmaster.ca>
	<DF610537-0A50-4CE5-9739-2AA91F47CF2A@gmail.com>
Message-ID: <5419BD3C.80205@gmail.com>

  Thanks for the information.  It's the old story -- it's only once you
finally convince yourself that the problems are always on your end and
never bugs in the other guy's (development) code that you actually
encounter bugs in the other guy's code.

  Ben Bolker

On 14-09-17 11:32 AM, peter dalgaard wrote:
> 
> On 17 Sep 2014, at 17:04 , Ben Bolker <bbolker at gmail.com> wrote:
> 
> I am painfully aware that this is most likely a problem with my 
> system, but I am nevertheless going to ask if anyone has any 
> ideas/suggestions for diagnosis and trouble-shooting.
> 
> 
>> Others have been seeing this since r66622, so I think you're just
>> suffering the "unsuffered consequences" (unsuffered by regular
>> users, that is; people who run development versions will suffer
>> occasionally). Just hang on for a while.
> 
> - From a clean checkout of release 66624 on Ubuntu 12.04 (32-bit,
> sorry!):
> 
>> That's _revision_ 66624, please. It is only "released" in the sense
>> that it isn't kept secret.
> 
>> -pd
> 
> gcc (Ubuntu/Linaro 4.6.4-1ubuntu1~12.04) 4.6.4
> 
> svn checkout https://svn.r-project.org/R/trunk/ 
> tools/rsync-recommended
> 
> cd ../r-build ../r-devel/configure
> 
> R is now configured for i686-pc-linux-gnu
> 
> Source directory:          ../r-devel Installation directory:
> /usr/local
> 
> C compiler:                gcc -std=gnu99  -g -O2 Fortran 77
> compiler:       gfortran  -g -O2
> 
> C++ compiler:              g++  -g -O2 C++ 11 compiler:           g++
> -std=c++0x -g -O2 Fortran 90/95 compiler:    gfortran -g -O2 Obj-C
> compiler:
> 
> Interfaces supported:      X11, tcltk External libraries:
> readline, lzma Additional capabilities:   PNG, JPEG, TIFF, NLS,
> cairo Options enabled:           shared BLAS, R profiling
> 
> Capabilities skipped:      ICU Options not enabled:       memory
> profiling
> 
> make fails at:
> 
> byte-compiling 'methods' initializing class and method definitions
> ...Error: .onLoad failed in loadNamespace() for 'methods', details: 
> call: new("classRepresentation") error: could not find function
> "isVirtualClass"
> 
> The only other oddity of my system/potential clue is that symbolic 
> links sometimes behave strangely because I am working on a
> VirtualBox virtual machine with a virtual Linux filesystem layered
> over an HGFS filesystem.
>> 
>> ______________________________________________ 
>> R-devel at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From sannandi at umail.iu.edu  Wed Sep 17 19:34:14 2014
From: sannandi at umail.iu.edu (Sandip Nandi)
Date: Wed, 17 Sep 2014 10:34:14 -0700
Subject: [Rd] cleanup temporary directory
Message-ID: <CAGSjAUD5TSg8gP+MqEremq7es+qNX2iUuyPMz962o=KCaKYeCg@mail.gmail.com>

Hi ,

When a R session runs , it creates a temporary directory . I am using
 R_CleanTempDir() to clean it up . It looks like its not working properly .


So what exactly is going on here is , my example is

main()

start______R______Interpreter

while(1)

{

execute R scripts  using R_parseVector  and R_tryEval . .
break;
}


R_cleanup_tempDir()
R_session_End()


So is the Rtemp directory created in every R_Tryeval call ? The R temporary
file looks like this

RtmpzgKWqU:
RtmpzieK01:
RtmpzleSGb:
RtmpzqlvWS:


Thanks,
Sandip

	[[alternative HTML version deleted]]


From htl10 at users.sourceforge.net  Thu Sep 18 02:44:29 2014
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Thu, 18 Sep 2014 01:44:29 +0100
Subject: [Rd] Regression and inconsistency of width of apostrophes in R
	vignettes
Message-ID: <1411001069.66240.YahooMailBasic@web172302.mail.ir2.yahoo.com>

My main dev machine died a well-deserved death a few weeks ago after six
and a half years of faithful service, and refused to be re-animated. A substantial
part of setting up its replacement is re-running a lot of R vignettes (mostly
for timing to establish new performance baselines) - and also
cleaning away some such vignettes generated in the past under different
versions of R.

So I noticed a regression of behavior between R 2.x and 3.x/current. The width
of apostrophes in code output was working correctly in R 2.x and is wrong in R 3.x
generated vignettes. Specifically, it affects summary(data.frame) with some columns
that contains NA's. Here is an edited example snipplet (you should view this with
fixed-width font terminal):

=================
\begin{Sinput}
> summary(some.data.frame)
\end{Sinput}
\begin{Soutput}
      P.BB             z.HWE         
 Min.   :0.00000   Min.   :-3.83163  
 1st Qu.:0.07071   1st Qu.:-0.56856  
 Median :0.26263   Median : 0.18426  
 Mean   :0.33754   Mean   : 0.06581  
 3rd Qu.:0.56566   3rd Qu.: 0.73845  
 Max.   :0.98990   Max.   : 3.73120  
                   NA's   :2         
\end{Soutput}
=================

In R 2.x generated pdf's, the ":" all lined up. In R 3.x/current generated pdf's, the "NA's"
is typesetted with a narrower apostrophe and therefore the ":" no longer line
up properly.

This is running both versions in parallel on the same system so there is no LaTeX related
issue in the rest of the system. I see Prof Ripley is the person to have changed
R Sweave's behavior in the last few years, and all the recent changes are to do with
quotes (which probably means apostophes also) I suspect the relevant change is probably
r63858 (and its equivalent r63864 in the R-3.0 branch) although I'd be happy to be
corrected. In any case, the above new behavior of summary(data.frame)
columns not lining up seems to be undesirable so I'd prefer reverting to the older
appearance, unless there is a good reason; or at least identify what
local quirks I have which results in this, if I am the only person experiencing this difference
of behavior between R 2.x and R 3.x.

------------------------------------------------------------------------
r65917 | ripley | 2014-06-11 11:46:03 +0100 (Wed, 11 Jun 2014) | 2 lines

prefer zi4.sty, use [noupquote] only with that

------------------------------------------------------------------------
r65748 | ripley | 2014-05-26 08:39:14 +0100 (Mon, 26 May 2014) | 2 lines

use [noupquote]

------------------------------------------------------------------------
r63858 | ripley | 2013-09-07 07:02:08 +0100 (Sat, 07 Sep 2013) | 3 lines

add inconsolata option to Sweave
Arrange for '' and `` to render in the same way in \code, \samp as \examples.


From dstr7320 at uni.sydney.edu.au  Thu Sep 18 04:00:06 2014
From: dstr7320 at uni.sydney.edu.au (Dario Strbenac)
Date: Thu, 18 Sep 2014 02:00:06 +0000
Subject: [Rd] Can't Find Function After requireNamespace
Message-ID: <1411005606101.35889@uni.sydney.edu.au>

I have a simple function :

f <- function()
{
  if(requireNamespace("ggplot2"))
    qplot(Sepal.Length, Petal.Length, data = iris, color = Species)
  else
    message("No graphics, just text.")
}

ggplot2 is in the Suggests field of the DESCRIPTION file. When I load the package, and run the function, I get an error :

> f()
Loading required namespace: ggplot2
Error in f() : could not find function "qplot"

I don't want all ggplot2 functions to be added to the search path, so I am not using require(ggplot2). How can I use it correctly ?

R version 3.1.1 (2014-07-10)
Platform: x86_64-unknown-linux-gnu (64-bit)

--------------------------------------
Dario Strbenac
PhD Student
University of Sydney
Camperdown NSW 2050
Australia

From simon.urbanek at r-project.org  Thu Sep 18 04:46:30 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 17 Sep 2014 22:46:30 -0400
Subject: [Rd] Can't Find Function After requireNamespace
In-Reply-To: <1411005606101.35889@uni.sydney.edu.au>
References: <1411005606101.35889@uni.sydney.edu.au>
Message-ID: <F7DA7657-4AA4-4393-9DC8-9B33EFE7E935@r-project.org>


On Sep 17, 2014, at 10:00 PM, Dario Strbenac <dstr7320 at uni.sydney.edu.au> wrote:

> I have a simple function :
> 
> f <- function()
> {
>  if(requireNamespace("ggplot2"))
>    qplot(Sepal.Length, Petal.Length, data = iris, color = Species)
>  else
>    message("No graphics, just text.")
> }
> 
> ggplot2 is in the Suggests field of the DESCRIPTION file. When I load the package, and run the function, I get an error :
> 
>> f()
> Loading required namespace: ggplot2
> Error in f() : could not find function "qplot"
> 
> I don't want all ggplot2 functions to be added to the search path, so I am not using require(ggplot2). How can I use it correctly ?
> 

ggplot2::qplot(Sepal.Length, Petal.Length, data = iris, color = Species)

Cheers,
S


> R version 3.1.1 (2014-07-10)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> --------------------------------------
> Dario Strbenac
> PhD Student
> University of Sydney
> Camperdown NSW 2050
> Australia
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From simon.urbanek at r-project.org  Thu Sep 18 04:48:37 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 17 Sep 2014 22:48:37 -0400
Subject: [Rd] Can't Find Function After requireNamespace
In-Reply-To: <F7DA7657-4AA4-4393-9DC8-9B33EFE7E935@r-project.org>
References: <1411005606101.35889@uni.sydney.edu.au>
	<F7DA7657-4AA4-4393-9DC8-9B33EFE7E935@r-project.org>
Message-ID: <C7FEF552-06A3-4CD9-9A2D-99912690D568@r-project.org>

BTW: you probably also want to use requireNamespace(..., quietly=TRUE) otherwise if sort of defeats the purpose ...

On Sep 17, 2014, at 10:46 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> 
> On Sep 17, 2014, at 10:00 PM, Dario Strbenac <dstr7320 at uni.sydney.edu.au> wrote:
> 
>> I have a simple function :
>> 
>> f <- function()
>> {
>> if(requireNamespace("ggplot2"))
>>   qplot(Sepal.Length, Petal.Length, data = iris, color = Species)
>> else
>>   message("No graphics, just text.")
>> }
>> 
>> ggplot2 is in the Suggests field of the DESCRIPTION file. When I load the package, and run the function, I get an error :
>> 
>>> f()
>> Loading required namespace: ggplot2
>> Error in f() : could not find function "qplot"
>> 
>> I don't want all ggplot2 functions to be added to the search path, so I am not using require(ggplot2). How can I use it correctly ?
>> 
> 
> ggplot2::qplot(Sepal.Length, Petal.Length, data = iris, color = Species)
> 
> Cheers,
> S
> 
> 
>> R version 3.1.1 (2014-07-10)
>> Platform: x86_64-unknown-linux-gnu (64-bit)
>> 
>> --------------------------------------
>> Dario Strbenac
>> PhD Student
>> University of Sydney
>> Camperdown NSW 2050
>> Australia
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 


From andre_mikulec at hotmail.com  Thu Sep 18 05:52:10 2014
From: andre_mikulec at hotmail.com (Andre Mikulec)
Date: Wed, 17 Sep 2014 23:52:10 -0400
Subject: [Rd] Debug an R windows (Fortran) DLL within R with gdb?
In-Reply-To: <mailman.21.1410861606.22633.r-devel@r-project.org>
References: <mailman.21.1410861606.22633.r-devel@r-project.org>
Message-ID: <BLU174-W190C61E69B2DDD0F3D36019CB70@phx.gbl>

Help,

My?Rgui.exe, main.f, main.o, and main.dll are all in the same directory.
When I try to set a breakpoint, I get this response

(gdb) b main.f:3 ? ? ? ? ? ? ??
No source file named main.f

I tried the -gdwarf-2 requirement in both the compiling and linking statements. ?This did not fix the problem.
The cygwin site recommended the -g option. ?I tried this. ?This did not fix the problem.
I did not use R CMD SHLIB ( I ran the statements manually ).

Andre Mikulec
Andre_Mikulec at Hotmail.com


----------------------------------------
> From: r-devel-request at r-project.org
> Subject: R-devel Digest, Vol 139, Issue 15
> To: r-devel at r-project.org
> Date: Tue, 16 Sep 2014 12:00:06 +0200
>
> Send R-devel mailing list submissions to
> r-devel at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> https://stat.ethz.ch/mailman/listinfo/r-devel
> or, via email, send a message with subject or body 'help' to
> r-devel-request at r-project.org
>
> You can reach the person managing the list at
> r-devel-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-devel digest..."
>
>
> Today's Topics:
>
> 1. Debug an R windows (Fortran) DLL within R with gdb?
> (Andre Mikulec)
> 2. Re: Debug an R windows (Fortran) DLL within R with gdb?
> (Duncan Murdoch)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 15 Sep 2014 17:25:49 -0400
> From: Andre Mikulec <andre_mikulec at hotmail.com>
> To: "r-devel at r-project.org" <r-devel at r-project.org>
> Subject: [Rd] Debug an R windows (Fortran) DLL within R with gdb?
> Message-ID: <BLU174-W2834A37215473FEE12D3F39CC80 at phx.gbl>
> Content-Type: text/plain; charset="iso-8859-1"
>
>
> Hi,?
> I have a Fortran 77 subroutine (dll).
>
> On windows XP, how ?would I 'debug it(Fortran) within R' using gdb?
>
> This is how I made it.
> ----------------------
>
> R CMD SHLIB main.f
>
> gfortran -m32 ? ? -O3 ?-mtune=core2 -c main.f -o main.o
>
> gcc -m32 -shared -s -static-libgcc -o main.dll tmp.def main.o -Ld:/RCompile/CRANpkg/extralibs64/local/lib/i386 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -lgfortran -LF:/ProgramFiles/R/R-3.1.1/bin/i386 -lR
>
>
> Here is the contents of the file ?main.f
> -----------------------------------------
>
> ? ? ? SUBROUTINE NGCD(NA, NB, NGCDO)?
> ? ? ? ? IA = NA
> ? ? ? ? IB = NB
> ? ? 1 ? IF (IB.NE.0) THEN
> ? ? ? ? ? ITEMP = IA
> ? ? ? ? ? IA = IB
> ? ? ? ? ? IB = MOD(ITEMP, IB)
> ? ? ? ? ? GOTO 1
> ? ? ? ? END IF
> ? ? ? ? NGCDO = IA ?
> ? ? ? ? RETURN
> ? ? ? END
>
> Thank you,
> Andre Mikulec
> Andre_Mikulec at Hotmail.com
>
>
>
>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 15 Sep 2014 18:05:36 -0400
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> To: Andre Mikulec <andre_mikulec at hotmail.com>, "r-devel at r-project.org"
> <r-devel at r-project.org>
> Subject: Re: [Rd] Debug an R windows (Fortran) DLL within R with gdb?
> Message-ID: <541762B0.1050501 at gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> On 15/09/2014, 5:25 PM, Andre Mikulec wrote:
>>
>> Hi,
>> I have a Fortran 77 subroutine (dll).
>>
>> On windows XP, how would I 'debug it(Fortran) within R' using gdb?
>>
>> This is how I made it.
>> ----------------------
>>
>> R CMD SHLIB main.f
>>
>> gfortran -m32 -O3 -mtune=core2 -c main.f -o main.o
>>
>> gcc -m32 -shared -s -static-libgcc -o main.dll tmp.def main.o -Ld:/RCompile/CRANpkg/extralibs64/local/lib/i386 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -lgfortran -LF:/ProgramFiles/R/R-3.1.1/bin/i386 -lR
>>
>>
>> Here is the contents of the file main.f
>> -----------------------------------------
>>
>> SUBROUTINE NGCD(NA, NB, NGCDO)
>> IA = NA
>> IB = NB
>> 1 IF (IB.NE.0) THEN
>> ITEMP = IA
>> IA = IB
>> IB = MOD(ITEMP, IB)
>> GOTO 1
>> END IF
>> NGCDO = IA
>> RETURN
>> END
>
> I don't think you put in any compile options to include symbolic
> information. You need to do that. I think the option you want is
> -gdwarf-2, but I rarely use Fortran, and never use SHLIB, so I could be
> wrong. I'll assume you can figure out how to do that.
>
> Run R under gdb using
>
> gdb Rgui
>
> Load your DLL.
>
> Break to gdb using the menu entry "Misc | Break to debugger".
>
> Set a breakpoint, e.g.
>
> b main.f:3
>
> to set it on line 3. Then use c to let R continue, and make a call to
> your code. Then the usual gdb commands will work after it breaks.
>
> Duncan Murdoch
>
>
>
> ------------------------------
>
> _______________________________________________
> R-devel at r-project.org mailing list DIGESTED
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> End of R-devel Digest, Vol 139, Issue 15
> ****************************************
 		 	   		  

From murdoch.duncan at gmail.com  Thu Sep 18 10:37:51 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 18 Sep 2014 04:37:51 -0400
Subject: [Rd] Debug an R windows (Fortran) DLL within R with gdb?
In-Reply-To: <BLU174-W190C61E69B2DDD0F3D36019CB70@phx.gbl>
References: <mailman.21.1410861606.22633.r-devel@r-project.org>
	<BLU174-W190C61E69B2DDD0F3D36019CB70@phx.gbl>
Message-ID: <541A99DF.2050408@gmail.com>

On 17/09/2014, 11:52 PM, Andre Mikulec wrote:
> Help,
> 
> My Rgui.exe, main.f, main.o, and main.dll are all in the same directory.
> When I try to set a breakpoint, I get this response
> 
> (gdb) b main.f:3               
> No source file named main.f
> 
> I tried the -gdwarf-2 requirement in both the compiling and linking statements.  This did not fix the problem.
> The cygwin site recommended the -g option.  I tried this.  This did not fix the problem.


This is getting to be a question about gdb, and I'm no expert on that.
I do remember there's a command "dir" which says where to find source;
perhaps that is necessary even when the working directory holds the source.


> I did not use R CMD SHLIB ( I ran the statements manually ).

I don't recommend that.  You can add options to R CMD SHLIB, but you are
likely to run into problems with R if you leave any out.

DUncan Murdoch

> 
> Andre Mikulec
> Andre_Mikulec at Hotmail.com
> 
> 
> ----------------------------------------
>> From: r-devel-request at r-project.org
>> Subject: R-devel Digest, Vol 139, Issue 15
>> To: r-devel at r-project.org
>> Date: Tue, 16 Sep 2014 12:00:06 +0200
>>
>> Send R-devel mailing list submissions to
>> r-devel at r-project.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> or, via email, send a message with subject or body 'help' to
>> r-devel-request at r-project.org
>>
>> You can reach the person managing the list at
>> r-devel-owner at r-project.org
>>
>> When replying, please edit your Subject line so it is more specific
>> than "Re: Contents of R-devel digest..."
>>
>>
>> Today's Topics:
>>
>> 1. Debug an R windows (Fortran) DLL within R with gdb?
>> (Andre Mikulec)
>> 2. Re: Debug an R windows (Fortran) DLL within R with gdb?
>> (Duncan Murdoch)
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Mon, 15 Sep 2014 17:25:49 -0400
>> From: Andre Mikulec <andre_mikulec at hotmail.com>
>> To: "r-devel at r-project.org" <r-devel at r-project.org>
>> Subject: [Rd] Debug an R windows (Fortran) DLL within R with gdb?
>> Message-ID: <BLU174-W2834A37215473FEE12D3F39CC80 at phx.gbl>
>> Content-Type: text/plain; charset="iso-8859-1"
>>
>>
>> Hi,?
>> I have a Fortran 77 subroutine (dll).
>>
>> On windows XP, how ?would I 'debug it(Fortran) within R' using gdb?
>>
>> This is how I made it.
>> ----------------------
>>
>> R CMD SHLIB main.f
>>
>> gfortran -m32 ? ? -O3 ?-mtune=core2 -c main.f -o main.o
>>
>> gcc -m32 -shared -s -static-libgcc -o main.dll tmp.def main.o -Ld:/RCompile/CRANpkg/extralibs64/local/lib/i386 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -lgfortran -LF:/ProgramFiles/R/R-3.1.1/bin/i386 -lR
>>
>>
>> Here is the contents of the file ?main.f
>> -----------------------------------------
>>
>> ? ? ? SUBROUTINE NGCD(NA, NB, NGCDO)?
>> ? ? ? ? IA = NA
>> ? ? ? ? IB = NB
>> ? ? 1 ? IF (IB.NE.0) THEN
>> ? ? ? ? ? ITEMP = IA
>> ? ? ? ? ? IA = IB
>> ? ? ? ? ? IB = MOD(ITEMP, IB)
>> ? ? ? ? ? GOTO 1
>> ? ? ? ? END IF
>> ? ? ? ? NGCDO = IA ?
>> ? ? ? ? RETURN
>> ? ? ? END
>>
>> Thank you,
>> Andre Mikulec
>> Andre_Mikulec at Hotmail.com
>>
>>
>>
>>
>>
>> ------------------------------
>>
>> Message: 2
>> Date: Mon, 15 Sep 2014 18:05:36 -0400
>> From: Duncan Murdoch <murdoch.duncan at gmail.com>
>> To: Andre Mikulec <andre_mikulec at hotmail.com>, "r-devel at r-project.org"
>> <r-devel at r-project.org>
>> Subject: Re: [Rd] Debug an R windows (Fortran) DLL within R with gdb?
>> Message-ID: <541762B0.1050501 at gmail.com>
>> Content-Type: text/plain; charset=ISO-8859-1
>>
>> On 15/09/2014, 5:25 PM, Andre Mikulec wrote:
>>>
>>> Hi,
>>> I have a Fortran 77 subroutine (dll).
>>>
>>> On windows XP, how would I 'debug it(Fortran) within R' using gdb?
>>>
>>> This is how I made it.
>>> ----------------------
>>>
>>> R CMD SHLIB main.f
>>>
>>> gfortran -m32 -O3 -mtune=core2 -c main.f -o main.o
>>>
>>> gcc -m32 -shared -s -static-libgcc -o main.dll tmp.def main.o -Ld:/RCompile/CRANpkg/extralibs64/local/lib/i386 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -lgfortran -LF:/ProgramFiles/R/R-3.1.1/bin/i386 -lR
>>>
>>>
>>> Here is the contents of the file main.f
>>> -----------------------------------------
>>>
>>> SUBROUTINE NGCD(NA, NB, NGCDO)
>>> IA = NA
>>> IB = NB
>>> 1 IF (IB.NE.0) THEN
>>> ITEMP = IA
>>> IA = IB
>>> IB = MOD(ITEMP, IB)
>>> GOTO 1
>>> END IF
>>> NGCDO = IA
>>> RETURN
>>> END
>>
>> I don't think you put in any compile options to include symbolic
>> information. You need to do that. I think the option you want is
>> -gdwarf-2, but I rarely use Fortran, and never use SHLIB, so I could be
>> wrong. I'll assume you can figure out how to do that.
>>
>> Run R under gdb using
>>
>> gdb Rgui
>>
>> Load your DLL.
>>
>> Break to gdb using the menu entry "Misc | Break to debugger".
>>
>> Set a breakpoint, e.g.
>>
>> b main.f:3
>>
>> to set it on line 3. Then use c to let R continue, and make a call to
>> your code. Then the usual gdb commands will work after it breaks.
>>
>> Duncan Murdoch
>>
>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> R-devel at r-project.org mailing list DIGESTED
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>> End of R-devel Digest, Vol 139, Issue 15
>> ****************************************
>  		 	   		  
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From tobias.setz at rmetrics.org  Thu Sep 18 17:20:13 2014
From: tobias.setz at rmetrics.org (Tobias Setz)
Date: Thu, 18 Sep 2014 17:20:13 +0200
Subject: [Rd] "no visible global function definition" using R-Devel check
	utility
Message-ID: <008c01cfd354$0b4182b0$21c48810$@rmetrics.org>

Hello All

If I check the package fAssets using R-3.1.1 (2014-07-10 under Windows) I
don't get any notes. If I do the same using R-Devel (2014-09-17 r66626 under
Windows) I get the following note:

.
assetsMeanCov: no visible binding for global variable 'scaleTau2'
.

I'll try to explain why with a minimal example. Let's have a look at the
following function:

assetsMeanCov <- function(x, method = c("cov", "MCD", "OGK"),  alpha = 1/2,
sigmamu = scaleTau2, ...) {
   if (method == "cov") {cov(x, ...)}
   if (method == " MCD") {robustbase::covMcd(x, alpha = alpha, ...)}
   if (method == " OGK") {robustbase::covOGK(x, sigmamu =
substitute(sigmamu), ...)}
}

where robustbase is mentioned under "Suggests:" within the DESCRIPTION file.
This since the function is also usable without having that package
available. R check is now complaining since it cannot find the function
'scaleTau2' defined within the packages namespace or any imported
namespaces. Which is true; since this function is defined within the
robustbase package whose namespace is not imported. Note that:

1) The function works like that if the package is built. No error or warning
if method="OGK" is used.
2) By "promoting" the package robustbase to "Imports:" within the
DESCRIPTION file and importing that function within the NAMESPACE file the
note would be gone.
3) Using "sigmamu = robustbase::scaleTau2" would solve the "problem" as
well.

I am not very much in favour to import the robustbase package since it is
not necessarily needed. Also I don't know if using the "::"  operator within
the functions arguments list is a good concept. Also since the code works
without having that. Therefore I am wondering if this new behaviour within
R-Devel (compared to R-3.1.1) is intentionally and if yes; what would be
best practice for such a setup?

Many thanks for your help and time!!
Tobias

> sessionInfo()
R version 3.1.1 (2014-07-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)


From hj at jhu.edu  Thu Sep 18 19:32:29 2014
From: hj at jhu.edu (Harris A. Jaffee)
Date: Thu, 18 Sep 2014 13:32:29 -0400
Subject: [Rd] last user argument missing from Rscript --verbose
Message-ID: <8A6E73FA-0C64-42DA-B506-01FDD7ED2204@jhu.edu>

The loop that echoes the arguments almost always stops too soon.  It apparently does that to avoid
echoing the "--args" (that had been inserted) when there are no user arguments.  However, when there
are user arguments, the next element of the 'av' array is the last argument and usually not "--args",
although it can be.

?Rscript is a little sketchy:

     ?--verbose? gives details of what ?Rscript? is doing.  Also passed
          on to R.

What is passed to R is correct, but the diagnostic is not:

 $ Rscript --verbose /dev/null 1 2
  running
  '/path_to_R --slave --no-restore --file=/dev/null --args 1'

Fixed (only tested on Mac):

 $ Rscript --verbose /dev/null 1 2
  running
  '/Library/Frameworks/R.framework/Versions/3.1/Resources/bin/R --slave --no-restore --file=/dev/null --args 1 2'

-------------- next part --------------







From jdavison at fhcrc.org  Thu Sep 18 19:48:15 2014
From: jdavison at fhcrc.org (Davison, Jerry)
Date: Thu, 18 Sep 2014 10:48:15 -0700 (PDT)
Subject: [Rd] help.start() web page contains a bad link
In-Reply-To: <247544581.2876889.1411062132649.JavaMail.root@fhcrc.org>
Message-ID: <1028173995.2877062.1411062495615.JavaMail.root@fhcrc.org>

Hi, 

At my work, the web page opened with the R command help.start() has a link "User Manuals". Activating it gives this response: 

Error in vignettes[i, "PDF"] : subscript out of bounds 

> sessionInfo() 
R version 3.1.1 (2014-07-10) 
Platform: x86_64-unknown-linux-gnu (64-bit) 

locale: 
[1] C 

attached base packages: 
[1] stats graphics grDevices utils datasets methods base 

other attached packages: 
[1] BiocInstaller_1.14.2 

loaded via a namespace (and not attached): 
[1] tools_3.1.1 


Jerry 


	[[alternative HTML version deleted]]


From bhh at xs4all.nl  Thu Sep 18 20:11:46 2014
From: bhh at xs4all.nl (Berend Hasselman)
Date: Thu, 18 Sep 2014 20:11:46 +0200
Subject: [Rd] help.start() web page contains a bad link
In-Reply-To: <1028173995.2877062.1411062495615.JavaMail.root@fhcrc.org>
References: <1028173995.2877062.1411062495615.JavaMail.root@fhcrc.org>
Message-ID: <A74C10C4-40DE-4A5E-9294-64E95E3CA130@xs4all.nl>


On 18-09-2014, at 19:48, Davison, Jerry <jdavison at fhcrc.org> wrote:

> Hi, 
> 
> At my work, the web page opened with the R command help.start() has a link "User Manuals". Activating it gives this response: 
> 
> Error in vignettes[i, "PDF"] : subscript out of bounds 
> 

Fixed in R 3.1.1 patched.

Berend

>> sessionInfo() 
> R version 3.1.1 (2014-07-10) 
> Platform: x86_64-unknown-linux-gnu (64-bit) 
> 
> locale: 
> [1] C 
> 
> attached base packages: 
> [1] stats graphics grDevices utils datasets methods base 
> 
> other attached packages: 
> [1] BiocInstaller_1.14.2 
> 
> loaded via a namespace (and not attached): 
> [1] tools_3.1.1 
> 
> 
> Jerry 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From JHZhang at mdanderson.org  Thu Sep 18 20:07:43 2014
From: JHZhang at mdanderson.org (Zhang,Jun)
Date: Thu, 18 Sep 2014 18:07:43 +0000
Subject: [Rd] formatR 1.0 caused error
Message-ID: <8EE4E2C595735A4EAEC2A3311537FE4D276D757A@DCPWPEXMBX03.mdanderson.edu>

Recently in our R 3.1.0 installation the package formatR was upgraded to version 1.0, doing my usual thing, I got the following error, and the destination html file was not generated.
What can I do if I want to stay at the current formatR version?

Jun

Error: unrecognized fields specified in html_dependency: attachment
In addition: Warning messages:
1: 'function (...)
{
    .Deprecated("tidy_source", package = "formatR")
    tidy_source(...)
}' is deprecated.
Use 'tidy_source' instead.
See help("Deprecated") and help("formatR-deprecated").
2: In tidy_source(...) :
  The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
3: 'function (...)
{
    .Deprecated("tidy_source", package = "formatR")
    tidy_source(...)
}' is deprecated.
Use 'tidy_source' instead.
See help("Deprecated") and help("formatR-deprecated").
4: In tidy_source(...) :
  The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
5: 'function (...)
{
    .Deprecated("tidy_source", package = "formatR")
    tidy_source(...)
}' is deprecated.
Use 'tidy_source' instead.
See help("Deprecated") and help("formatR-deprecated").
6: In tidy_source(...) :
  The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
> sessionInfo()
R version 3.1.0 (2014-04-10)
Platform: x86_64-unknown-linux-gnu (64-bit)


	[[alternative HTML version deleted]]


From JHZhang at mdanderson.org  Thu Sep 18 20:36:33 2014
From: JHZhang at mdanderson.org (Zhang,Jun)
Date: Thu, 18 Sep 2014 18:36:33 +0000
Subject: [Rd] formatR 1.0 caused error
In-Reply-To: <8EE4E2C595735A4EAEC2A3311537FE4D276D757A@DCPWPEXMBX03.mdanderson.edu>
References: <8EE4E2C595735A4EAEC2A3311537FE4D276D757A@DCPWPEXMBX03.mdanderson.edu>
Message-ID: <8EE4E2C595735A4EAEC2A3311537FE4D276D75AF@DCPWPEXMBX03.mdanderson.edu>

Problem solved. User library location had an older rmarkdown, removed that, so that the current rmarkdown 0.3.3 at the system library location is being used.

-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Zhang,Jun
Sent: Thursday, September 18, 2014 1:08 PM
To: r-devel at r-project.org
Subject: [Rd] formatR 1.0 caused error

Recently in our R 3.1.0 installation the package formatR was upgraded to version 1.0, doing my usual thing, I got the following error, and the destination html file was not generated.
What can I do if I want to stay at the current formatR version?

Jun

Error: unrecognized fields specified in html_dependency: attachment In addition: Warning messages:
1: 'function (...)
{
    .Deprecated("tidy_source", package = "formatR")
    tidy_source(...)
}' is deprecated.
Use 'tidy_source' instead.
See help("Deprecated") and help("formatR-deprecated").
2: In tidy_source(...) :
  The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
3: 'function (...)
{
    .Deprecated("tidy_source", package = "formatR")
    tidy_source(...)
}' is deprecated.
Use 'tidy_source' instead.
See help("Deprecated") and help("formatR-deprecated").
4: In tidy_source(...) :
  The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
5: 'function (...)
{
    .Deprecated("tidy_source", package = "formatR")
    tidy_source(...)
}' is deprecated.
Use 'tidy_source' instead.
See help("Deprecated") and help("formatR-deprecated").
6: In tidy_source(...) :
  The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
> sessionInfo()
R version 3.1.0 (2014-04-10)
Platform: x86_64-unknown-linux-gnu (64-bit)


	[[alternative HTML version deleted]]

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From xie at yihui.name  Thu Sep 18 20:38:58 2014
From: xie at yihui.name (Yihui Xie)
Date: Thu, 18 Sep 2014 13:38:58 -0500
Subject: [Rd] formatR 1.0 caused error
In-Reply-To: <8EE4E2C595735A4EAEC2A3311537FE4D276D757A@DCPWPEXMBX03.mdanderson.edu>
References: <8EE4E2C595735A4EAEC2A3311537FE4D276D757A@DCPWPEXMBX03.mdanderson.edu>
Message-ID: <CANROs4doyL_+rBfuOnNv415BYXux4qV5GpSFAs3E9LdsH_xpBw@mail.gmail.com>

Sorry, but this is a wrong list to write to. I'll reply anyway this time...

The formatR package should be irrelevant in this case -- you were
seeing warnings of deprecation. The error came from elsewhere. It is
hard to say what the problem was without a reproducible example.
Anyway, to "fix" the warnings, you can install the development version
of knitr (which I plan to release to CRAN relatively soon):

  install.packages('knitr', repos = c('http://rforge.net',
'http://cran.rstudio.com'), type = 'source')

You posted your sessionInfo() but it seems you deleted an important
part: the versions of packages, which makes it even more difficult for
others to tell what the problem could possibly be.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Web: http://yihui.name


On Thu, Sep 18, 2014 at 1:07 PM, Zhang,Jun <JHZhang at mdanderson.org> wrote:
> Recently in our R 3.1.0 installation the package formatR was upgraded to version 1.0, doing my usual thing, I got the following error, and the destination html file was not generated.
> What can I do if I want to stay at the current formatR version?
>
> Jun
>
> Error: unrecognized fields specified in html_dependency: attachment
> In addition: Warning messages:
> 1: 'function (...)
> {
>     .Deprecated("tidy_source", package = "formatR")
>     tidy_source(...)
> }' is deprecated.
> Use 'tidy_source' instead.
> See help("Deprecated") and help("formatR-deprecated").
> 2: In tidy_source(...) :
>   The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
> 3: 'function (...)
> {
>     .Deprecated("tidy_source", package = "formatR")
>     tidy_source(...)
> }' is deprecated.
> Use 'tidy_source' instead.
> See help("Deprecated") and help("formatR-deprecated").
> 4: In tidy_source(...) :
>   The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
> 5: 'function (...)
> {
>     .Deprecated("tidy_source", package = "formatR")
>     tidy_source(...)
> }' is deprecated.
> Use 'tidy_source' instead.
> See help("Deprecated") and help("formatR-deprecated").
> 6: In tidy_source(...) :
>   The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
>> sessionInfo()
> R version 3.1.0 (2014-04-10)
> Platform: x86_64-unknown-linux-gnu (64-bit)


From JHZhang at mdanderson.org  Thu Sep 18 20:58:34 2014
From: JHZhang at mdanderson.org (Zhang,Jun)
Date: Thu, 18 Sep 2014 18:58:34 +0000
Subject: [Rd] formatR 1.0 caused error
In-Reply-To: <CANROs4doyL_+rBfuOnNv415BYXux4qV5GpSFAs3E9LdsH_xpBw@mail.gmail.com>
References: <8EE4E2C595735A4EAEC2A3311537FE4D276D757A@DCPWPEXMBX03.mdanderson.edu>
	<CANROs4doyL_+rBfuOnNv415BYXux4qV5GpSFAs3E9LdsH_xpBw@mail.gmail.com>
Message-ID: <8EE4E2C595735A4EAEC2A3311537FE4D276D85F4@DCPWPEXMBX03.mdanderson.edu>

Yihui,
I installed knitr_1.6.18, and user reported no warning any more. In my other related posting I thought rmarkdown was the problem, actually there are two part of the problems. Using older version of rmarkdown caused no html file generated, which is more serious, and the warning was cleared by your development knitr.
Thanks!
Jun  

-----Original Message-----
From: xieyihui at gmail.com [mailto:xieyihui at gmail.com] On Behalf Of Yihui Xie
Sent: Thursday, September 18, 2014 1:39 PM
To: Zhang,Jun
Cc: r-devel at r-project.org
Subject: Re: [Rd] formatR 1.0 caused error

Sorry, but this is a wrong list to write to. I'll reply anyway this time...

The formatR package should be irrelevant in this case -- you were seeing warnings of deprecation. The error came from elsewhere. It is hard to say what the problem was without a reproducible example.
Anyway, to "fix" the warnings, you can install the development version of knitr (which I plan to release to CRAN relatively soon):

  install.packages('knitr', repos = c('http://rforge.net', 'http://cran.rstudio.com'), type = 'source')

You posted your sessionInfo() but it seems you deleted an important
part: the versions of packages, which makes it even more difficult for others to tell what the problem could possibly be.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Web: http://yihui.name


On Thu, Sep 18, 2014 at 1:07 PM, Zhang,Jun <JHZhang at mdanderson.org> wrote:
> Recently in our R 3.1.0 installation the package formatR was upgraded to version 1.0, doing my usual thing, I got the following error, and the destination html file was not generated.
> What can I do if I want to stay at the current formatR version?
>
> Jun
>
> Error: unrecognized fields specified in html_dependency: attachment In 
> addition: Warning messages:
> 1: 'function (...)
> {
>     .Deprecated("tidy_source", package = "formatR")
>     tidy_source(...)
> }' is deprecated.
> Use 'tidy_source' instead.
> See help("Deprecated") and help("formatR-deprecated").
> 2: In tidy_source(...) :
>   The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
> 3: 'function (...)
> {
>     .Deprecated("tidy_source", package = "formatR")
>     tidy_source(...)
> }' is deprecated.
> Use 'tidy_source' instead.
> See help("Deprecated") and help("formatR-deprecated").
> 4: In tidy_source(...) :
>   The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
> 5: 'function (...)
> {
>     .Deprecated("tidy_source", package = "formatR")
>     tidy_source(...)
> }' is deprecated.
> Use 'tidy_source' instead.
> See help("Deprecated") and help("formatR-deprecated").
> 6: In tidy_source(...) :
>   The option 'keep.blank.line' is deprecated; please use 'formatR.blank'
>> sessionInfo()
> R version 3.1.0 (2014-04-10)
> Platform: x86_64-unknown-linux-gnu (64-bit)

From maechler at stat.math.ethz.ch  Fri Sep 19 14:12:58 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 19 Sep 2014 14:12:58 +0200
Subject: [Rd] last user argument missing from Rscript --verbose
In-Reply-To: <8A6E73FA-0C64-42DA-B506-01FDD7ED2204@jhu.edu>
References: <8A6E73FA-0C64-42DA-B506-01FDD7ED2204@jhu.edu>
Message-ID: <21532.7626.215119.24473@stat.math.ethz.ch>

>>>>> Harris A Jaffee <hj at jhu.edu>
>>>>>     on Thu, 18 Sep 2014 19:32:29 +0200 writes:

(using  HTML, please don't )

   > The loop that echoes the arguments almost always stops too soon.  It
   > apparently does that to avoid
   > echoing the "--args" (that had been inserted) when there are no user
   > arguments.  However, when there
   > are user arguments, the next element of the 'av' array is the last
   > argument and usually not "--args",
   > although it can be.
   > ?Rscript is a little sketchy:
   >      `--verbose' gives details of what `Rscript' is doing.  Also passed
   >           on to R.
   > What is passed to R is correct, but the diagnostic is not:
   >  $ Rscript --verbose /dev/null 1 2
   >   running
   >   '/path_to_R --slave --no-restore --file=/dev/null --args 1'
   > Fixed (only tested on Mac):
   >  $ Rscript --verbose /dev/null 1 2
   >   running
   >   '/Library/Frameworks/R.framework/Versions/3.1/Resources/bin/R --slave
   > --no-restore --file=/dev/null --args 1 2'

You are right about the problem, also reproducible on Linux.
You mention a 'fix'.
It looks to me that is just

-	for(i = 1; i < ac-1; i++) fprintf(stderr, " %s", av[i]);
+	for(i = 1; i < ac; i++) fprintf(stderr, " %s", av[i]);

in unix/Rscript.c, right ?

BTW: If one use  -e 'commandArgs()'  instead of   /dev/null one
sees that Rscript's "lying" about the last argument is not
helpful anyway :

  Rscript --verbose -e 'commandArgs()'

  running
    '/usr/local64.sfs/app/R/R-3.1.1-inst/bin/R --slave --no-restore -e commandArgs()'

  [1] "/usr/local64.sfs/app/R/R-3.1.1-inst/bin/exec/R"
  [2] "--slave"                                       
  [3] "--no-restore"                                  
  [4] "-e"                                            
  [5] "commandArgs()"                                 
  [6] "--args"                                        

because the '--args' appears anyway and indeed *is* passed to 'R'...

A better fix would rather suppress that; but I will commit the
above change.

Martin Maechler
ETH Zurich


From skostysh at princeton.edu  Fri Sep 19 15:14:03 2014
From: skostysh at princeton.edu (Scott Kostyshak)
Date: Fri, 19 Sep 2014 09:14:03 -0400
Subject: [Rd] last user argument missing from Rscript --verbose
In-Reply-To: <21532.7626.215119.24473@stat.math.ethz.ch>
References: <8A6E73FA-0C64-42DA-B506-01FDD7ED2204@jhu.edu>
	<21532.7626.215119.24473@stat.math.ethz.ch>
Message-ID: <CAE3=dmesQDO3L-dJFKUTv8kjE5jK2Hq4Y9H5skdn6Gh81gtRug@mail.gmail.com>

On Fri, Sep 19, 2014 at 8:12 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Harris A Jaffee <hj at jhu.edu>
>>>>>>     on Thu, 18 Sep 2014 19:32:29 +0200 writes:
>
> (using  HTML, please don't )
>
>    > The loop that echoes the arguments almost always stops too soon.  It
>    > apparently does that to avoid
>    > echoing the "--args" (that had been inserted) when there are no user
>    > arguments.  However, when there
>    > are user arguments, the next element of the 'av' array is the last
>    > argument and usually not "--args",
>    > although it can be.
>    > ?Rscript is a little sketchy:
>    >      `--verbose' gives details of what `Rscript' is doing.  Also passed
>    >           on to R.
>    > What is passed to R is correct, but the diagnostic is not:
>    >  $ Rscript --verbose /dev/null 1 2
>    >   running
>    >   '/path_to_R --slave --no-restore --file=/dev/null --args 1'
>    > Fixed (only tested on Mac):
>    >  $ Rscript --verbose /dev/null 1 2
>    >   running
>    >   '/Library/Frameworks/R.framework/Versions/3.1/Resources/bin/R --slave
>    > --no-restore --file=/dev/null --args 1 2'
>
> You are right about the problem, also reproducible on Linux.
> You mention a 'fix'.
> It looks to me that is just
>
> -       for(i = 1; i < ac-1; i++) fprintf(stderr, " %s", av[i]);
> +       for(i = 1; i < ac; i++) fprintf(stderr, " %s", av[i]);
>
> in unix/Rscript.c, right ?

Yes, I suggested the same patch here:
http://r.789695.n4.nabble.com/patch-Rscript-off-by-one-error-in-output-td4693780.html

Scott

> BTW: If one use  -e 'commandArgs()'  instead of   /dev/null one
> sees that Rscript's "lying" about the last argument is not
> helpful anyway :
>
>   Rscript --verbose -e 'commandArgs()'
>
>   running
>     '/usr/local64.sfs/app/R/R-3.1.1-inst/bin/R --slave --no-restore -e commandArgs()'
>
>   [1] "/usr/local64.sfs/app/R/R-3.1.1-inst/bin/exec/R"
>   [2] "--slave"
>   [3] "--no-restore"
>   [4] "-e"
>   [5] "commandArgs()"
>   [6] "--args"
>
> because the '--args' appears anyway and indeed *is* passed to 'R'...
>
> A better fix would rather suppress that; but I will commit the
> above change.


--
Scott Kostyshak
Economics PhD Candidate
Princeton University


From skyguy94 at gmail.com  Fri Sep 19 17:37:30 2014
From: skyguy94 at gmail.com (Ritch Melton)
Date: Fri, 19 Sep 2014 10:37:30 -0500
Subject: [Rd] Pointer ownership with GECreateDevDesc/GEDestroyDevDesc
Message-ID: <CAHXt8XEbZRW=+hdF64Z_Oc+4s_VEqsa0+MnWy1b=nUcLmhmjaQ@mail.gmail.com>

According to the "R Internals" document, for a custom device, I should
create a pDevDesc structure that gets passed to GECreateDevDesc.

..elided...
pDevDesc dev;
/* Allocate and initialize the device driver data */
if (!(dev = (pDevDesc) calloc(1, sizeof(DevDesc)))) return 0;
/* or error() */
/* set up device driver or free ?dev? and error() */
gdd = GEcreateDevDesc(dev); GEaddDevice2(gdd, "dev_name");
...elided...

which indicates to me that the calling code owns the pDevDesc structure and
should be responsible for freeing it.
However, in GEdestroyDevDesc, that particular code calls free(dd->dev),
freeing the pointer.

In my case, I have a device implemented and created in a language that is
using a different allocator. The pDevDesc I pass in is not owned by R and
causes a crash on free with "dev.off()".

I thought I could mitigate the issue, by making a call to the allocator R
is using via an exported R function, such as R_alloc, but I did not see
such a function available to me.

I would like to know if I should be creating the pDevDesc via an imported
alloc routine somehow? or is there a way to prevent this code from freeing
the structure I pass in.

Blue Skies,
Ritch

	[[alternative HTML version deleted]]


From skostysh at princeton.edu  Sat Sep 20 14:53:15 2014
From: skostysh at princeton.edu (Scott Kostyshak)
Date: Sat, 20 Sep 2014 08:53:15 -0400
Subject: [Rd] [patch] Rscript off-by-one error in output
In-Reply-To: <CAE3=dmcnUbQeUmM5b7s_1Aj8H6BcQPkLam=6-nRsVAEkSwnx=w@mail.gmail.com>
References: <CAE3=dmcnUbQeUmM5b7s_1Aj8H6BcQPkLam=6-nRsVAEkSwnx=w@mail.gmail.com>
Message-ID: <CAE3=dmeAbgdvm8kKFjte9-6Y_LaKgQ-jKZ7j7DrQ4dJJusFzyA@mail.gmail.com>

On Wed, Jul 9, 2014 at 7:26 PM, Scott Kostyshak <skostysh at princeton.edu> wrote:
> Rscript eats up the last argument when reporting the command it runs:
>
> $ Rscript --verbose "/tmp/test.R" one two three
> running
>   '/usr/local/lib/R-devel/lib/R/bin/R --slave --no-restore
> --file=/tmp/test.R --args one two'
>
> With the patch below, I get the following:
>
> $ Rscript --verbose "/tmp/test.R" one two three
> running
>   '/usr/local/lib/R-devel/lib/R/bin/R --slave --no-restore
> --file=/tmp/test.R --args one two three'
>
>
> Index: src/unix/Rscript.c
> ===================================================================
> --- src/unix/Rscript.c  (revision 66100)
> +++ src/unix/Rscript.c  (working copy)
> @@ -249,7 +249,7 @@
>  #endif
>      if(verbose) {
>   fprintf(stderr, "running\n  '%s", cmd);
> - for(i = 1; i < ac-1; i++) fprintf(stderr, " %s", av[i]);
> + for(i = 1; i < ac; i++) fprintf(stderr, " %s", av[i]);
>   fprintf(stderr, "'\n\n");
>      }
>  #ifndef _WIN32
>
>
> Scott
>
>
>> sessionInfo()
> R Under development (unstable) (2014-07-08 r66100)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> --
> Scott Kostyshak
> Economics PhD Candidate
> Princeton University

For archival purposes, this was fixed at r66644.

Scott


--
Scott Kostyshak
Economics PhD Candidate
Princeton University


From hj at jhu.edu  Sun Sep 21 01:55:45 2014
From: hj at jhu.edu (Harris A. Jaffee)
Date: Sat, 20 Sep 2014 19:55:45 -0400
Subject: [Rd] last user argument missing from Rscript --verbose
In-Reply-To: <CAPRP4-eeRiPs8wp2i3t8X1bLtroTJCL4CJSnWAhqJDVj+x5Hsw@mail.gmail.com>
References: <8A6E73FA-0C64-42DA-B506-01FDD7ED2204@jhu.edu>
	<21532.7626.215119.24473@stat.math.ethz.ch>
	<CAE3=dmesQDO3L-dJFKUTv8kjE5jK2Hq4Y9H5skdn6Gh81gtRug@mail.gmail.com>
	<18372662-053A-4D6D-B3AB-78EA467CC1F3@jhu.edu>
	<CAPRP4-eeRiPs8wp2i3t8X1bLtroTJCL4CJSnWAhqJDVj+x5Hsw@mail.gmail.com>
Message-ID: <253EB04F-B3EF-4A02-A619-233C08F5CF24@jhu.edu>

Terrific, and I appreciate your thoughts and encouragement.

So, getting back on-list, I propose a backward-incompatible change, with
or without --verbose, that the --args be included in the 'av' array, and
passed to R, only if there are user arguments to follow it.  The condition
for a first argument, at the time --args is currently included, is

	(i0+1) < argc

Scott's fix, already in the devel version, solves my original complaint and
should continue to do so, as long as av[ac] continues to be the terminating
NULL.  That is, av[ac-1] is the last argument in the R command.

On Sep 20, 2014, at 4:39 PM, Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> 
> On Fri, Sep 19, 2014 at 5:26 PM, Harris A. Jaffee <hj at jhu.edu> wrote:
> I must have searched the archives badly!
> 
> I did not suggest that, exactly.  My hack was a little more complicated,
> trying to honor what seemed to be the general intent of the code.  So, I
> only conditionally echo the argument at i=ac-1 (see attached). 
> 
> ?Thank you, I understand but think it's unnecessarily complicated.
> Rather I think that the following issue should ideally be handled:
> 
> There is? ?also a more basic issue to decide, whether the "--args" should be sent to
> R when nothing follows it, but that debate should occur on-list, if at all.
> 
> ?and if that is fixed (not sending '--args' if at the end), the simple fix for verbose printing will be enough.
> 
> ?Yes, please go back on saying this on R-devel ... You did take it offline (and some say that it is not allowed to put something private suddenly back online, so I did not ...  but do not care if you do it here).?
> 
> 
> Martin
> ? 
> 
>  
> 
> On Sep 19, 2014, at 9:14 AM, Scott Kostyshak <skostysh at princeton.edu> wrote:
> 
> > On Fri, Sep 19, 2014 at 8:12 AM, Martin Maechler
> 
> > <maechler at stat.math.ethz.ch> wrote:
> >>>>>>> Harris A Jaffee <hj at jhu.edu>
> >>>>>>>    on Thu, 18 Sep 2014 19:32:29 +0200 writes:
> >> 
> >> (using  HTML, please don't )
> >> 
> >>> The loop that echoes the arguments almost always stops too soon.  It
> >>> apparently does that to avoid
> >>> echoing the "--args" (that had been inserted) when there are no user
> >>> arguments.  However, when there
> >>> are user arguments, the next element of the 'av' array is the last
> >>> argument and usually not "--args",
> >>> although it can be.
> >>> ?Rscript is a little sketchy:
> >>>     `--verbose' gives details of what `Rscript' is doing.  Also passed
> >>>          on to R.
> >>> What is passed to R is correct, but the diagnostic is not:
> >>> $ Rscript --verbose /dev/null 1 2
> >>>  running
> >>>  '/path_to_R --slave --no-restore --file=/dev/null --args 1'
> >>> Fixed (only tested on Mac):
> >>> $ Rscript --verbose /dev/null 1 2
> >>>  running
> >>>  '/Library/Frameworks/R.framework/Versions/3.1/Resources/bin/R --slave
> >>> --no-restore --file=/dev/null --args 1 2'
> >> 
> >> You are right about the problem, also reproducible on Linux.
> >> You mention a 'fix'.
> >> It looks to me that is just
> >> 
> >> -       for(i = 1; i < ac-1; i++) fprintf(stderr, " %s", av[i]);
> >> +       for(i = 1; i < ac; i++) fprintf(stderr, " %s", av[i]);
> >> 
> >> in unix/Rscript.c, right ?
> > 
> > Yes, I suggested the same patch here:
> > http://r.789695.n4.nabble.com/patch-Rscript-off-by-one-error-in-output-td4693780.html
> > 
> > Scott
> > 
> >> BTW: If one use  -e 'commandArgs()'  instead of   /dev/null one
> >> sees that Rscript's "lying" about the last argument is not
> >> helpful anyway :
> >> 
> >>  Rscript --verbose -e 'commandArgs()'
> >> 
> >>  running
> >>    '/usr/local64.sfs/app/R/R-3.1.1-inst/bin/R --slave --no-restore -e commandArgs()'
> >> 
> >>  [1] "/usr/local64.sfs/app/R/R-3.1.1-inst/bin/exec/R"
> >>  [2] "--slave"
> >>  [3] "--no-restore"
> >>  [4] "-e"
> >>  [5] "commandArgs()"
> >>  [6] "--args"
> >> 
> >> because the '--args' appears anyway and indeed *is* passed to 'R'...
> >> 
> >> A better fix would rather suppress that; but I will commit the
> >> above change.
> > 
> > 
> > --
> > Scott Kostyshak
> > Economics PhD Candidate
> > Princeton University
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From kevinushey at gmail.com  Sun Sep 21 19:06:13 2014
From: kevinushey at gmail.com (Kevin Ushey)
Date: Sun, 21 Sep 2014 10:06:13 -0700
Subject: [Rd] Bug in new behaviour for all.equal and environments?
Message-ID: <CAJXgQP0pTjOPsuEYLw+iLSi60cwGFT0cvFVSnNgwOVGTf8Eaag@mail.gmail.com>

Hi R-devel,

The following code:

    all.equal(baseenv(), baseenv())

gives the error when run in a clean R session with latest R-devel (r66650):

    kevin:~$ R --vanilla --slave -e "all.equal(baseenv(), baseenv())"
    Error in all.equal.envRefClass(target[[i]], current[[i]],
check.attributes = check.attributes,  :
      attempt to apply non-function
    Calls: all.equal ... all.equal.list -> all.equal -> all.equal.envRefClass
    Execution halted

Although I don't know if it's helpful -- it appears that packages that
include some S4 machinery will effect the outcome of this error, e.g.
if we load 'Biobase' first:

    kevin:~$ R --vanilla --slave -e
"suppressPackageStartupMessages(library(Biobase));
all.equal(baseenv(), baseenv())"
    Error in target$getClass() : object '.refClassDef' not found
    Calls: all.equal ... all.equal.list -> all.equal ->
all.equal.envRefClass -> <Anonymous>
    Execution halted

We were bumping into an error with this in Rcpp -- we used all.equal
(through RUnit) to confirm that baseenv(), and a function returning
the base environment, would return TRUE.

For completeness:

    kevin:~$ R --vanilla --slave -e "sessionInfo()"
    R Under development (unstable) (2014-09-20 r66650)
    Platform: x86_64-apple-darwin13.3.0 (64-bit)

    locale:
    [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8

    attached base packages:
    [1] stats     graphics  grDevices utils     datasets  methods   base

Thanks,
Kevin


From ruipbarradas at sapo.pt  Sun Sep 21 19:38:50 2014
From: ruipbarradas at sapo.pt (Rui Barradas)
Date: Sun, 21 Sep 2014 18:38:50 +0100
Subject: [Rd] Bug in new behaviour for all.equal and environments?
In-Reply-To: <CAJXgQP0pTjOPsuEYLw+iLSi60cwGFT0cvFVSnNgwOVGTf8Eaag@mail.gmail.com>
References: <CAJXgQP0pTjOPsuEYLw+iLSi60cwGFT0cvFVSnNgwOVGTf8Eaag@mail.gmail.com>
Message-ID: <541F0D2A.6010809@sapo.pt>

Hello,

In R 3.1.1 on Windows 7 it's ok.

 > all.equal(baseenv(), baseenv())
[1] TRUE
 > sessionInfo()
R version 3.1.1 (2014-07-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=Portuguese_Portugal.1252 
LC_CTYPE=Portuguese_Portugal.1252
[3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C 

[5] LC_TIME=Portuguese_Portugal.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Rui Barradas

Em 21-09-2014 18:06, Kevin Ushey escreveu:
> Hi R-devel,
>
> The following code:
>
>      all.equal(baseenv(), baseenv())
>
> gives the error when run in a clean R session with latest R-devel (r66650):
>
>      kevin:~$ R --vanilla --slave -e "all.equal(baseenv(), baseenv())"
>      Error in all.equal.envRefClass(target[[i]], current[[i]],
> check.attributes = check.attributes,  :
>        attempt to apply non-function
>      Calls: all.equal ... all.equal.list -> all.equal -> all.equal.envRefClass
>      Execution halted
>
> Although I don't know if it's helpful -- it appears that packages that
> include some S4 machinery will effect the outcome of this error, e.g.
> if we load 'Biobase' first:
>
>      kevin:~$ R --vanilla --slave -e
> "suppressPackageStartupMessages(library(Biobase));
> all.equal(baseenv(), baseenv())"
>      Error in target$getClass() : object '.refClassDef' not found
>      Calls: all.equal ... all.equal.list -> all.equal ->
> all.equal.envRefClass -> <Anonymous>
>      Execution halted
>
> We were bumping into an error with this in Rcpp -- we used all.equal
> (through RUnit) to confirm that baseenv(), and a function returning
> the base environment, would return TRUE.
>
> For completeness:
>
>      kevin:~$ R --vanilla --slave -e "sessionInfo()"
>      R Under development (unstable) (2014-09-20 r66650)
>      Platform: x86_64-apple-darwin13.3.0 (64-bit)
>
>      locale:
>      [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
>
>      attached base packages:
>      [1] stats     graphics  grDevices utils     datasets  methods   base
>
> Thanks,
> Kevin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From edd at debian.org  Sun Sep 21 21:16:25 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 21 Sep 2014 14:16:25 -0500
Subject: [Rd] last user argument missing from Rscript --verbose
In-Reply-To: <253EB04F-B3EF-4A02-A619-233C08F5CF24@jhu.edu>
References: <8A6E73FA-0C64-42DA-B506-01FDD7ED2204@jhu.edu>
	<21532.7626.215119.24473@stat.math.ethz.ch>
	<CAE3=dmesQDO3L-dJFKUTv8kjE5jK2Hq4Y9H5skdn6Gh81gtRug@mail.gmail.com>
	<18372662-053A-4D6D-B3AB-78EA467CC1F3@jhu.edu>
	<CAPRP4-eeRiPs8wp2i3t8X1bLtroTJCL4CJSnWAhqJDVj+x5Hsw@mail.gmail.com>
	<253EB04F-B3EF-4A02-A619-233C08F5CF24@jhu.edu>
Message-ID: <21535.9225.537032.156237@max.nulle.part>


On 20 September 2014 at 19:55, Harris A. Jaffee wrote:
| Terrific, and I appreciate your thoughts and encouragement.
| 
| So, getting back on-list, I propose a backward-incompatible change, with
| or without --verbose, that the --args be included in the 'av' array, and
| passed to R, only if there are user arguments to follow it.  The condition
| for a first argument, at the time --args is currently included, is
| 
| 	(i0+1) < argc
| 
| Scott's fix, already in the devel version, solves my original complaint and
| should continue to do so, as long as av[ac] continues to be the terminating
| NULL.  That is, av[ac-1] is the last argument in the R command.

In case you were unaware of it, r from littler (which has been around even
longer than Rscript) has always propagated its arguments into argv:

edd at max:~$ r -e'print(argv)' foo bar biz x=42
[1] "foo"  "bar"  "biz"  "x=42"
edd at max:~$ 

See http://dirk.eddelbuettel.com/code/littler.html and my blog pages on
littler at http://dirk.eddelbuettel.com/blog/code/littler/ for more about 'r'
and littler; pre-built binaries exist at CRAN for Debian and Ubuntu; and it
builds easily on a lot of other OSs.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Sun Sep 21 21:57:00 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 21 Sep 2014 15:57:00 -0400
Subject: [Rd] Bug in new behaviour for all.equal and environments?
In-Reply-To: <541F0D2A.6010809@sapo.pt>
References: <CAJXgQP0pTjOPsuEYLw+iLSi60cwGFT0cvFVSnNgwOVGTf8Eaag@mail.gmail.com>
	<541F0D2A.6010809@sapo.pt>
Message-ID: <541F2D8C.7090407@gmail.com>

On 21/09/2014, 1:38 PM, Rui Barradas wrote:
> Hello,
> 
> In R 3.1.1 on Windows 7 it's ok.
> 
>  > all.equal(baseenv(), baseenv())
> [1] TRUE
>  > sessionInfo()
> R version 3.1.1 (2014-07-10)
> Platform: x86_64-w64-mingw32/x64 (64-bit)

I'm not sure if that's really "ok", since it returns TRUE for any pair
of environments, e.g.

all.equal(baseenv(), emptyenv())

The current R-devel behaviour is temporary and certain to change.

Duncan Murdoch

> 
> locale:
> [1] LC_COLLATE=Portuguese_Portugal.1252 
> LC_CTYPE=Portuguese_Portugal.1252
> [3] LC_MONETARY=Portuguese_Portugal.1252 LC_NUMERIC=C 
> 
> [5] LC_TIME=Portuguese_Portugal.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> Rui Barradas
> 
> Em 21-09-2014 18:06, Kevin Ushey escreveu:
>> Hi R-devel,
>>
>> The following code:
>>
>>      all.equal(baseenv(), baseenv())
>>
>> gives the error when run in a clean R session with latest R-devel (r66650):
>>
>>      kevin:~$ R --vanilla --slave -e "all.equal(baseenv(), baseenv())"
>>      Error in all.equal.envRefClass(target[[i]], current[[i]],
>> check.attributes = check.attributes,  :
>>        attempt to apply non-function
>>      Calls: all.equal ... all.equal.list -> all.equal -> all.equal.envRefClass
>>      Execution halted
>>
>> Although I don't know if it's helpful -- it appears that packages that
>> include some S4 machinery will effect the outcome of this error, e.g.
>> if we load 'Biobase' first:
>>
>>      kevin:~$ R --vanilla --slave -e
>> "suppressPackageStartupMessages(library(Biobase));
>> all.equal(baseenv(), baseenv())"
>>      Error in target$getClass() : object '.refClassDef' not found
>>      Calls: all.equal ... all.equal.list -> all.equal ->
>> all.equal.envRefClass -> <Anonymous>
>>      Execution halted
>>
>> We were bumping into an error with this in Rcpp -- we used all.equal
>> (through RUnit) to confirm that baseenv(), and a function returning
>> the base environment, would return TRUE.
>>
>> For completeness:
>>
>>      kevin:~$ R --vanilla --slave -e "sessionInfo()"
>>      R Under development (unstable) (2014-09-20 r66650)
>>      Platform: x86_64-apple-darwin13.3.0 (64-bit)
>>
>>      locale:
>>      [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
>>
>>      attached base packages:
>>      [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> Thanks,
>> Kevin
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From skyguy94 at gmail.com  Mon Sep 22 17:15:33 2014
From: skyguy94 at gmail.com (Ritch Melton)
Date: Mon, 22 Sep 2014 10:15:33 -0500
Subject: [Rd] Pointer ownership with GECreateDevDesc/GEDestroyDevDesc
In-Reply-To: <CAHXt8XEbZRW=+hdF64Z_Oc+4s_VEqsa0+MnWy1b=nUcLmhmjaQ@mail.gmail.com>
References: <CAHXt8XEbZRW=+hdF64Z_Oc+4s_VEqsa0+MnWy1b=nUcLmhmjaQ@mail.gmail.com>
Message-ID: <CAHXt8XH8FAQRTDpx0z=wtoeuoqEk-XdVVSXu994M0DNLs64MSw@mail.gmail.com>

I perused the source for RStudio and noticed that they had a similar
problem. I didn't think that the GEDevDesc structure was exported, but
apparently this is a worthwhile workaround to the defect.

void GD_Close(pDevDesc dev)
{
...elided...
      // explicitly free and then null out the dev pointer of the GEDevDesc
      // This is to avoid incompatabilities between the heap we are
compiled with
      // and the heap R is compiled with (we observed this to a problem with
      // 64-bit R)
      std::free(s_pGEDevDesc->dev);
      s_pGEDevDesc->dev = NULL;

      // set GDDevDesc to NULL so we don't reference it again
      s_pGEDevDesc = NULL;
   }
}

I will

On Fri, Sep 19, 2014 at 10:37 AM, Ritch Melton <skyguy94 at gmail.com> wrote:

> According to the "R Internals" document, for a custom device, I should
> create a pDevDesc structure that gets passed to GECreateDevDesc.
>
> ..elided...
> pDevDesc dev;
> /* Allocate and initialize the device driver data */
> if (!(dev = (pDevDesc) calloc(1, sizeof(DevDesc)))) return 0;
> /* or error() */
> /* set up device driver or free ?dev? and error() */
> gdd = GEcreateDevDesc(dev); GEaddDevice2(gdd, "dev_name");
> ...elided...
>
> which indicates to me that the calling code owns the pDevDesc structure
> and should be responsible for freeing it.
> However, in GEdestroyDevDesc, that particular code calls free(dd->dev),
> freeing the pointer.
>
> In my case, I have a device implemented and created in a language that is
> using a different allocator. The pDevDesc I pass in is not owned by R and
> causes a crash on free with "dev.off()".
>
> I thought I could mitigate the issue, by making a call to the allocator R
> is using via an exported R function, such as R_alloc, but I did not see
> such a function available to me.
>
> I would like to know if I should be creating the pDevDesc via an imported
> alloc routine somehow? or is there a way to prevent this code from freeing
> the structure I pass in.
>
> Blue Skies,
> Ritch
>

	[[alternative HTML version deleted]]


From pgilbert902 at gmail.com  Mon Sep 22 17:25:57 2014
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Mon, 22 Sep 2014 11:25:57 -0400
Subject: [Rd] extra package tests directory
Message-ID: <54203F85.1090701@gmail.com>

I am trying to decide on a name for a directory where I will put some 
extra package tests. The main motivation for this is the need to limit 
the package test time on CRAN. That is, these are tests that could be in 
the tests/ directory and could be run on CRAN, but will take longer than 
CRAN likes.

Scanning through names currently being used in packages on CRAN I see a 
large number of inst/tests/ directories, but they seem to be instead of 
a tests/ directory at the top level of the package. (There are also some 
occurrences of inst/test and test/ at the top level.) I would prefer not 
to use these directories as I don't like the possible confusion over 
whether these are the standard package tests or additional ones.

The other name that is used a fair amount is inst/unitTests/ (plus 
inst/UnitTests/, plus inst/UnitTest/, plus inst/unittests).  In many 
case these seem to be run by a script in the tests/ directory using a 
unit testing framework, so they cannot easily be distinguished from the 
normal package tests/ run by CRAN.

I see also an occurrence each of inst/otherTests/ inst/testScripts/ and 
inst/test_cases.

My own preference would be inst/extraTests but no one is using that.

Have I missed anything? Does anyone have suggestions or comments? Are 
there other reasons one might want tests that are not usually run by CRAN?

Paul


From Zwang at connecticutchildrens.org  Tue Sep 23 00:33:17 2014
From: Zwang at connecticutchildrens.org (Wang, Zhu)
Date: Mon, 22 Sep 2014 22:33:17 +0000
Subject: [Rd] Replace isnan and lgamma in Fortran subroutine in R package
Message-ID: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>

Hello,

I submitted a package which used Fortran functions isnan and lgamma. However, I was told that:

isnan and lgamma are not Fortran 95 functions.

I was asked to write 'cross-platform portable code' and so should not be writing GNU extensions to Fortran.

See http://cran.r-project.org/web/checks/check_results_mpath.html, which will shortly show installation failures under Solaris.

I will appreciate advice on how to replace these two functions to avoid failure on some platforms.

Thanks in advance,

Zhu Wang



	[[alternative HTML version deleted]]


From bhh at xs4all.nl  Tue Sep 23 07:43:13 2014
From: bhh at xs4all.nl (Berend Hasselman)
Date: Tue, 23 Sep 2014 07:43:13 +0200
Subject: [Rd] Replace isnan and lgamma in Fortran subroutine in R package
In-Reply-To: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>
References: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>
Message-ID: <EB63692D-FE02-4767-A999-FDBB5A805B82@xs4all.nl>


On 23-09-2014, at 00:33, Wang, Zhu <Zwang at connecticutchildrens.org> wrote:

> Hello,
> 
> I submitted a package which used Fortran functions isnan and lgamma. However, I was told that:
> 
> isnan and lgamma are not Fortran 95 functions.
> 
> I was asked to write 'cross-platform portable code' and so should not be writing GNU extensions to Fortran.
> 
> See http://cran.r-project.org/web/checks/check_results_mpath.html, which will shortly show installation failures under Solaris.
> 
> I will appreciate advice on how to replace these two functions to avoid failure on some platforms.
> 

I don?t know about lgamma.

Instead of isnan you could use Lapack?s logical function disnan to test for NaN (it?s in lapack 3.4.2; I don?t know about earlier versions).

Another way would be to write a C function using functions provided by R to test for NaN. 
That function should be declared with F77_NAME so that it can be called from a Fortran routine.

I haven?t tried this so I don?t know if this would be foolproof or is the best way to do it..

Berend


From plummerm at iarc.fr  Tue Sep 23 14:37:59 2014
From: plummerm at iarc.fr (Martyn Plummer)
Date: Tue, 23 Sep 2014 12:37:59 +0000
Subject: [Rd] Replace isnan and lgamma in Fortran subroutine in R package
In-Reply-To: <EB63692D-FE02-4767-A999-FDBB5A805B82@xs4all.nl>
References: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>
	<EB63692D-FE02-4767-A999-FDBB5A805B82@xs4all.nl>
Message-ID: <1411475879.3567.54.camel@braque.iarc.fr>

On Tue, 2014-09-23 at 07:43 +0200, Berend Hasselman wrote:
> On 23-09-2014, at 00:33, Wang, Zhu <Zwang at connecticutchildrens.org> wrote:
> 
> > Hello,
> > 
> > I submitted a package which used Fortran functions isnan and lgamma. However, I was told that:
> > 
> > isnan and lgamma are not Fortran 95 functions.
> > 
> > I was asked to write 'cross-platform portable code' and so should not be writing GNU extensions to Fortran.
> > 
> > See http://cran.r-project.org/web/checks/check_results_mpath.html, which will shortly show installation failures under Solaris.
> > 
> > I will appreciate advice on how to replace these two functions to avoid failure on some platforms.
> > 
> 
> I don?t know about lgamma.
> 
> Instead of isnan you could use Lapack?s logical function disnan to test for NaN (it?s in lapack 3.4.2; I don?t know about earlier versions).
> 
> Another way would be to write a C function using functions provided by R to test for NaN. 
> That function should be declared with F77_NAME so that it can be called from a Fortran routine.
> 
> I haven?t tried this so I don?t know if this would be foolproof or is the best way to do it..
> 
> Berend
> 

As described by Berend (See also section 6.6 of Writing R Extensions)
you can define Fortran-callable wrappers around ISNAN and lgammafn, both
of which are provided with the C interface to R (lgammafn is declared in
Rmath.h).  Then declare these wrappers as external subroutines in your
Fortran code and call them in place of isnan and lgamma.

Martyn

From plummerm at iarc.fr  Tue Sep 23 14:39:23 2014
From: plummerm at iarc.fr (Martyn Plummer)
Date: Tue, 23 Sep 2014 12:39:23 +0000
Subject: [Rd] Replace isnan and lgamma in Fortran subroutine in R package
In-Reply-To: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>
References: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>
Message-ID: <1411475963.3567.56.camel@braque.iarc.fr>

Try this patch.
Martyn

On Mon, 2014-09-22 at 22:33 +0000, Wang, Zhu wrote:
> Hello,
> 
> I submitted a package which used Fortran functions isnan and lgamma. However, I was told that:
> 
> isnan and lgamma are not Fortran 95 functions.
> 
> I was asked to write 'cross-platform portable code' and so should not be writing GNU extensions to Fortran.
> 
> See http://cran.r-project.org/web/checks/check_results_mpath.html, which will shortly show installation failures under Solaris.
> 
> I will appreciate advice on how to replace these two functions to avoid failure on some platforms.
> 
> Thanks in advance,
> 
> Zhu Wang
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-----------------------------------------------------------------------
This message and its attachments are strictly confidential. If you are
not the intended recipient of this message, please immediately notify 
the sender and delete it. Since its integrity cannot be guaranteed, 
its content cannot involve the sender's responsibility. Any misuse, 
any disclosure or publication of its content, either whole or partial, 
is prohibited, exception made of formally approved use
-----------------------------------------------------------------------
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mpath.patch
Type: text/x-patch
Size: 2006 bytes
Desc: mpath.patch
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20140923/7ee2587f/attachment.bin>

From Zwang at connecticutchildrens.org  Tue Sep 23 16:30:51 2014
From: Zwang at connecticutchildrens.org (Wang, Zhu)
Date: Tue, 23 Sep 2014 14:30:51 +0000
Subject: [Rd] Replace isnan and lgamma in Fortran subroutine in R package
In-Reply-To: <1411475963.3567.56.camel@braque.iarc.fr>
References: <DABBA49CC8C7AA4B959D2D0FEE496D721C506A65@EXINFRCHMB1P.ccmc.local>
	<1411475963.3567.56.camel@braque.iarc.fr>
Message-ID: <DABBA49CC8C7AA4B959D2D0FEE496D721C506BBA@EXINFRCHMB1P.ccmc.local>

That patch works flawlessly.

Thanks Martyn.

Zhu

-----Original Message-----
From: Martyn Plummer [mailto:plummerm at iarc.fr] 
Sent: Tuesday, September 23, 2014 8:39 AM
To: Wang, Zhu
Cc: r-devel at r-project.org
Subject: Re: [Rd] Replace isnan and lgamma in Fortran subroutine in R package

Try this patch.
Martyn

On Mon, 2014-09-22 at 22:33 +0000, Wang, Zhu wrote:
> Hello,
> 
> I submitted a package which used Fortran functions isnan and lgamma. However, I was told that:
> 
> isnan and lgamma are not Fortran 95 functions.
> 
> I was asked to write 'cross-platform portable code' and so should not be writing GNU extensions to Fortran.
> 
> See http://cran.r-project.org/web/checks/check_results_mpath.html, which will shortly show installation failures under Solaris.
> 
> I will appreciate advice on how to replace these two functions to avoid failure on some platforms.
> 
> Thanks in advance,
> 
> Zhu Wang
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From maechler at stat.math.ethz.ch  Tue Sep 23 17:44:09 2014
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 23 Sep 2014 17:44:09 +0200
Subject: [Rd] Bug in new behaviour for all.equal and environments?
In-Reply-To: <541F2D8C.7090407@gmail.com>
References: <CAJXgQP0pTjOPsuEYLw+iLSi60cwGFT0cvFVSnNgwOVGTf8Eaag@mail.gmail.com>
	<541F0D2A.6010809@sapo.pt> <541F2D8C.7090407@gmail.com>
Message-ID: <21537.38217.646693.170257@stat.math.ethz.ch>

>>>>> Duncan Murdoch <murdoch.duncan at gmail.com>
>>>>>     on Sun, 21 Sep 2014 15:57:00 -0400 writes:

    > On 21/09/2014, 1:38 PM, Rui Barradas wrote:
    >> Hello,
    >> 
    >> In R 3.1.1 on Windows 7 it's ok.
    >> 
    >> > all.equal(baseenv(), baseenv()) [1] TRUE >
    >> sessionInfo() R version 3.1.1 (2014-07-10) Platform:
    >> x86_64-w64-mingw32/x64 (64-bit)

    > I'm not sure if that's really "ok", since it returns TRUE
    > for any pair of environments, e.g.

    > all.equal(baseenv(), emptyenv())

    > The current R-devel behaviour is temporary and certain to
    > change.

    > Duncan Murdoch

Indeed.  A bit more than an hour ago, I have committed several
changes to R-devel's behavior in dealing with objects such as 
 
 (rp <- getClass("refClass")@prototype)
 (ner <- new("envRefClass"))

both of which would not even correctly *print* in current R.
They now do in R-devel, also work with str() there, and

  all.equal(baseenv(), baseenv())

and many more cases of all.equal() with environments now work
there as well.

I still expect that creative useRs will be able to construct
cases where the new  all.equal() methods will fail, possibly
even end in an infinite loop (which is caught and leads to an
error).

Please use R-devel  svn rev >= 66668  for such experiments.

Thanking you for testing ...,
Martin Maechler
ETH Zurich



    >> [................]

    >> Rui Barradas
    >> 
    >> Em 21-09-2014 18:06, Kevin Ushey escreveu:
    >>> Hi R-devel,
    >>> 
    >>> The following code:
    >>> 
    >>> all.equal(baseenv(), baseenv())
    >>> 
    >>> gives the error when run in a clean R session with
    >>> latest R-devel (r66650):
    >>> 
    >>> kevin:~$ R --vanilla --slave -e "all.equal(baseenv(),
    >>> baseenv())" Error in all.equal.envRefClass(target[[i]],
    >>> current[[i]], check.attributes = check.attributes, :
    >>> attempt to apply non-function Calls: all.equal
    >>> ... all.equal.list -> all.equal -> all.equal.envRefClass
    >>> Execution halted
    >>> 
    >>> Although I don't know if it's helpful -- it appears that
    >>> packages that include some S4 machinery will effect the
    >>> outcome of this error, e.g.  if we load 'Biobase' first:
    >>> 
    >>> kevin:~$ R --vanilla --slave -e
    >>> "suppressPackageStartupMessages(library(Biobase));
    >>> all.equal(baseenv(), baseenv())" Error in
    >>> target$getClass() : object '.refClassDef' not found
    >>> Calls: all.equal ... all.equal.list -> all.equal ->
    >>> all.equal.envRefClass -> <Anonymous> Execution halted
    >>> 
    >>> We were bumping into an error with this in Rcpp -- we
    >>> used all.equal (through RUnit) to confirm that
    >>> baseenv(), and a function returning the base
    >>> environment, would return TRUE.
    >>> 
    >>> For completeness:
    >>> 
    >>> kevin:~$ R --vanilla --slave -e "sessionInfo()" R Under
    >>> development (unstable) (2014-09-20 r66650) Platform:
    >>> x86_64-apple-darwin13.3.0 (64-bit)
    >>> 
    >>> locale: [1]
    >>> en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
    >>> 
    >>> attached base packages: [1] stats graphics grDevices
    >>> utils datasets methods base
    >>> 
    >>> Thanks, Kevin


From kmillar at google.com  Tue Sep 23 21:20:57 2014
From: kmillar at google.com (Karl Millar)
Date: Tue, 23 Sep 2014 12:20:57 -0700
Subject: [Rd] Patch for R to fix some buffer overruns and add a missing
	PROTECT().
Message-ID: <CABz6aZdT9VNxqKwy1QuWqvP6=tfa0+j--b6GXdQTd82+hvkkAA@mail.gmail.com>

This patch is against current svn and contains three classes of fix:
   - Ensure the result is properly terminated after calls to strncpy()
   - Replace calls of sprintf() with snprintf()
   - Added a PROTECT() call in do_while which could cause memory
errors if evaluating the condition results in a warning.

Thanks,

Karl

From murdoch.duncan at gmail.com  Tue Sep 23 21:42:40 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 23 Sep 2014 15:42:40 -0400
Subject: [Rd] Patch for R to fix some buffer overruns and add a missing
 PROTECT().
In-Reply-To: <CABz6aZdT9VNxqKwy1QuWqvP6=tfa0+j--b6GXdQTd82+hvkkAA@mail.gmail.com>
References: <CABz6aZdT9VNxqKwy1QuWqvP6=tfa0+j--b6GXdQTd82+hvkkAA@mail.gmail.com>
Message-ID: <5421CD30.7090300@gmail.com>

On 23/09/2014 3:20 PM, Karl Millar wrote:
> This patch is against current svn and contains three classes of fix:
>     - Ensure the result is properly terminated after calls to strncpy()
>     - Replace calls of sprintf() with snprintf()
>     - Added a PROTECT() call in do_while which could cause memory
> errors if evaluating the condition results in a warning.

Nothing was attached.

Generally fixes like this are best sent to bugs.r-project.org, and they 
receive highest priority if accompanied by code demonstrating why they 
are needed, i.e. crashes or incorrect results in current R.  Those will 
likely be incorporated as regression tests.

Duncan Murdoch


From kmillar at google.com  Tue Sep 23 21:55:35 2014
From: kmillar at google.com (Karl Millar)
Date: Tue, 23 Sep 2014 12:55:35 -0700
Subject: [Rd] Patch for R to fix some buffer overruns and add a missing
	PROTECT().
In-Reply-To: <5421CD30.7090300@gmail.com>
References: <CABz6aZdT9VNxqKwy1QuWqvP6=tfa0+j--b6GXdQTd82+hvkkAA@mail.gmail.com>
	<5421CD30.7090300@gmail.com>
Message-ID: <CABz6aZcD4z_RJAxwRGMnfFGefh8i2_1pbJvDPqxbYX7zmLs6oQ@mail.gmail.com>

Bug submitted.  Thanks.

On Tue, Sep 23, 2014 at 12:42 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 23/09/2014 3:20 PM, Karl Millar wrote:
>>
>> This patch is against current svn and contains three classes of fix:
>>     - Ensure the result is properly terminated after calls to strncpy()
>>     - Replace calls of sprintf() with snprintf()
>>     - Added a PROTECT() call in do_while which could cause memory
>> errors if evaluating the condition results in a warning.
>
>
> Nothing was attached.
>
> Generally fixes like this are best sent to bugs.r-project.org, and they
> receive highest priority if accompanied by code demonstrating why they are
> needed, i.e. crashes or incorrect results in current R.  Those will likely
> be incorporated as regression tests.
>
> Duncan Murdoch


From paul at stat.auckland.ac.nz  Wed Sep 24 05:54:04 2014
From: paul at stat.auckland.ac.nz (Paul Murrell)
Date: Wed, 24 Sep 2014 15:54:04 +1200
Subject: [Rd] Pointer ownership with GECreateDevDesc/GEDestroyDevDesc
In-Reply-To: <CAHXt8XH8FAQRTDpx0z=wtoeuoqEk-XdVVSXu994M0DNLs64MSw@mail.gmail.com>
References: <CAHXt8XEbZRW=+hdF64Z_Oc+4s_VEqsa0+MnWy1b=nUcLmhmjaQ@mail.gmail.com>
	<CAHXt8XH8FAQRTDpx0z=wtoeuoqEk-XdVVSXu994M0DNLs64MSw@mail.gmail.com>
Message-ID: <5422405C.90208@stat.auckland.ac.nz>


This seems like the best solution (free and NULL the dev pointer in 
dev_Close(), BEFORE GEdestroyDevDesc() has a go).

I think this should be safe because dev_Close() and GEdestroyDevDesc() 
are only called in one place (so your free() should always happen before 
GEdestroyDevDesc() and your free() shouldn't happen in any other, 
potentially inappropriate, context).

Paul

On 09/23/14 03:15, Ritch Melton wrote:
> I perused the source for RStudio and noticed that they had a similar
> problem. I didn't think that the GEDevDesc structure was exported, but
> apparently this is a worthwhile workaround to the defect.
>
> void GD_Close(pDevDesc dev)
> {
> ...elided...
>        // explicitly free and then null out the dev pointer of the GEDevDesc
>        // This is to avoid incompatabilities between the heap we are
> compiled with
>        // and the heap R is compiled with (we observed this to a problem with
>        // 64-bit R)
>        std::free(s_pGEDevDesc->dev);
>        s_pGEDevDesc->dev = NULL;
>
>        // set GDDevDesc to NULL so we don't reference it again
>        s_pGEDevDesc = NULL;
>     }
> }
>
> I will
>
> On Fri, Sep 19, 2014 at 10:37 AM, Ritch Melton <skyguy94 at gmail.com> wrote:
>
>> According to the "R Internals" document, for a custom device, I should
>> create a pDevDesc structure that gets passed to GECreateDevDesc.
>>
>> ..elided...
>> pDevDesc dev;
>> /* Allocate and initialize the device driver data */
>> if (!(dev = (pDevDesc) calloc(1, sizeof(DevDesc)))) return 0;
>> /* or error() */
>> /* set up device driver or free ?dev? and error() */
>> gdd = GEcreateDevDesc(dev); GEaddDevice2(gdd, "dev_name");
>> ...elided...
>>
>> which indicates to me that the calling code owns the pDevDesc structure
>> and should be responsible for freeing it.
>> However, in GEdestroyDevDesc, that particular code calls free(dd->dev),
>> freeing the pointer.
>>
>> In my case, I have a device implemented and created in a language that is
>> using a different allocator. The pDevDesc I pass in is not owned by R and
>> causes a crash on free with "dev.off()".
>>
>> I thought I could mitigate the issue, by making a call to the allocator R
>> is using via an exported R function, such as R_alloc, but I did not see
>> such a function available to me.
>>
>> I would like to know if I should be creating the pDevDesc via an imported
>> alloc routine somehow? or is there a way to prevent this code from freeing
>> the structure I pass in.
>>
>> Blue Skies,
>> Ritch
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From kaveh.vakili at wis.kuleuven.be  Fri Sep 26 11:00:30 2014
From: kaveh.vakili at wis.kuleuven.be (kaveh)
Date: Fri, 26 Sep 2014 11:00:30 +0200
Subject: [Rd] Why is my R package still compiling with the O2 flag?
Message-ID: <54252B2E.8090108@wis.kuleuven.be>

When I install an R package with cpp codes such as rrcov via CRAN (under 
R 3.1.1, using no Makevars file and under Ubuntu 14.04 using GCC 4.8), 
the cpp code is compiled with the -o3 flag (in fact, looking at the 
Makeconf file this seem to again be the default since R 3.1.1) But when 
I install my own package via CRAN it is compiled with the -o2 flag.

My questions are what is causing my package's cpp code to be compiled in 
-o2 and how to fix this?

Here is the content of the src/Makeconf file of my package (it is fairly 
standard I believe for a package using RcppEigen):

     PKG_CXXFLAGS =  -I../inst/include -DEIGEN_DONT_PARALLELIZE 
$(SHLIB_OPENMP_CXXFLAGS)
     PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"` 
$(SHLIB_OPENMP_CXXFLAGS)
     CXX_STD = CXX11

and that of rrcov (which I m using for illustration's sake):

     PKG_LIBS=$(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)


From ripley at stats.ox.ac.uk  Fri Sep 26 11:30:39 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Sep 2014 10:30:39 +0100
Subject: [Rd] Why is my R package still compiling with the O2 flag?
In-Reply-To: <54252B2E.8090108@wis.kuleuven.be>
References: <54252B2E.8090108@wis.kuleuven.be>
Message-ID: <5425323F.1040505@stats.ox.ac.uk>

You have not given us the 'at a minimum' information required by the 
posting guide, and it is -O2 etc (not O2 and not -o2).

Also, cpp is the C pre-processor: if you mean C++, say so.

The default compiler flags are set by whoever compiled R: it is entirely 
possibly they were set differently for C++98 and C++11 (which looks 
relevant).

It seems you need to read 'R Installation and Admnistration' which has a 
comprehensive description of these flags.


On 26/09/2014 10:00, kaveh wrote:
> When I install an R package with cpp codes such as rrcov via CRAN (under
> R 3.1.1, using no Makevars file and under Ubuntu 14.04 using GCC 4.8),
> the cpp code is compiled with the -o3 flag (in fact, looking at the
> Makeconf file this seem to again be the default since R 3.1.1) But when
> I install my own package via CRAN it is compiled with the -o2 flag.
>
> My questions are what is causing my package's cpp code to be compiled in
> -o2 and how to fix this?
>
> Here is the content of the src/Makeconf file of my package (it is fairly
> standard I believe for a package using RcppEigen):
>
>      PKG_CXXFLAGS =  -I../inst/include -DEIGEN_DONT_PARALLELIZE
> $(SHLIB_OPENMP_CXXFLAGS)
>      PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"`
> $(SHLIB_OPENMP_CXXFLAGS)
>      CXX_STD = CXX11
>
> and that of rrcov (which I m using for illustration's sake):
>
>      PKG_LIBS=$(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From kaveh.vakili at wis.kuleuven.be  Fri Sep 26 11:49:46 2014
From: kaveh.vakili at wis.kuleuven.be (kaveh)
Date: Fri, 26 Sep 2014 11:49:46 +0200
Subject: [Rd] Why is my R package still compiling with the O2 flag?
In-Reply-To: <5425323F.1040505@stats.ox.ac.uk>
References: <54252B2E.8090108@wis.kuleuven.be>
	<5425323F.1040505@stats.ox.ac.uk>
Message-ID: <542536BA.2080409@wis.kuleuven.be>


Dear Prof Ripley,

Thanks for the pointer to CXX1XFLAGS: it helped me solve the problem.

As usual, thanks for your prompt and helpful answer,

Best regards,

On 2014-09-26 11:30, Prof Brian Ripley wrote:
> You have not given us the 'at a minimum' information required by the 
> posting guide, and it is -O2 etc (not O2 and not -o2).
>
> Also, cpp is the C pre-processor: if you mean C++, say so.
>
> The default compiler flags are set by whoever compiled R: it is 
> entirely possibly they were set differently for C++98 and C++11 (which 
> looks relevant).
>
> It seems you need to read 'R Installation and Admnistration' which has 
> a comprehensive description of these flags.
>
>
> On 26/09/2014 10:00, kaveh wrote:
>> When I install an R package with cpp codes such as rrcov via CRAN (under
>> R 3.1.1, using no Makevars file and under Ubuntu 14.04 using GCC 4.8),
>> the cpp code is compiled with the -o3 flag (in fact, looking at the
>> Makeconf file this seem to again be the default since R 3.1.1) But when
>> I install my own package via CRAN it is compiled with the -o2 flag.
>>
>> My questions are what is causing my package's cpp code to be compiled in
>> -o2 and how to fix this?
>>
>> Here is the content of the src/Makeconf file of my package (it is fairly
>> standard I believe for a package using RcppEigen):
>>
>>      PKG_CXXFLAGS =  -I../inst/include -DEIGEN_DONT_PARALLELIZE
>> $(SHLIB_OPENMP_CXXFLAGS)
>>      PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"`
>> $(SHLIB_OPENMP_CXXFLAGS)
>>      CXX_STD = CXX11
>>
>> and that of rrcov (which I m using for illustration's sake):
>>
>>      PKG_LIBS=$(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From mdowle at mdowle.plus.com  Sat Sep 27 17:59:09 2014
From: mdowle at mdowle.plus.com (Matt Dowle)
Date: Sat, 27 Sep 2014 16:59:09 +0100
Subject: [Rd] possible error in rdevel with --enable-strict-barrier?
Message-ID: <5426DECD.8060906@mdowle.plus.com>

Hi,

With a fresh Rdevel r66690 (yesterday 26th) in ~/R/Rtrunk I get :

~/R/Rtrunk $ ./configure CC="gcc -std=gnu99 -fsanitize=address" 
CFLAGS="-fno-omit-frame-pointer -O0 -g -Wall -pedantic -mtune=native" 
--without-recommended-packages
~/R/Rtrunk $ make clean
~/R/Rtrunk $ make

Works fine.

Now adding --enable-strict-barrier to the end :

~/R/Rtrunk $ ./configure CC="gcc -std=gnu99 -fsanitize=address" 
CFLAGS="-fno-omit-frame-pointer -O0 -g -Wall -pedantic -mtune=native" 
--without-recommended-packages --enable-strict-barrier
~/R/Rtrunk $ make clean
~/R/Rtrunk $ make
... snip ...
building package 'datasets'
make[4]: Entering directory `/home/mdowle/R/Rtrunk/src/library/datasets'
make[4]: Leaving directory `/home/mdowle/R/Rtrunk/src/library/datasets'
Error in stats::ts(t(matrix(data = c(1628.75, 1678.1, 1772.8, 2443.6,  :
   invalid time series parameters specified
Calls: <Anonymous> ... <Anonymous> -> sys.source -> eval -> eval -> 
<Anonymous>
Execution halted

I've done this with and without --enable-strict-barrier several times 
and it's repeatable, at least on my machine.

Am I doing it right?  Is it known?

~/R/Rtrunk $ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Debian 4.8.2-1' 
--with-bugurl=file:///usr/share/doc/gcc-4.8/README.Bugs 
--enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr 
--program-suffix=-4.8 --enable-shared --enable-linker-build-id 
--libexecdir=/usr/lib --without-included-gettext --enable-threads=posix 
--with-gxx-include-dir=/usr/include/c++/4.8 --libdir=/usr/lib 
--enable-nls --with-sysroot=/ --enable-clocale=gnu 
--enable-libstdcxx-debug --enable-libstdcxx-time=yes 
--enable-gnu-unique-object --enable-plugin --with-system-zlib 
--disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo 
--with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64/jre 
--enable-java-home 
--with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64 
--with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.8-amd64 
--with-arch-directory=amd64 
--with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc 
--enable-multiarch --with-arch-32=i586 --with-abi=m64 
--with-multilib-list=m32,m64,mx32 --with-tune=generic 
--enable-checking=release --build=x86_64-linux-gnu 
--host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.8.2 (Debian 4.8.2-1)

I should mention that I've also installed gcc 4.9.1 to try combining 
ASAN and UBSAN i.e. -fsanitize=undefined,address.  So it's possible that 
something in that install has upgraded a shared object somewhere else.  
In the command above I'm using just "gcc" in CC, though, not "gcc-4.9".  
The earlier snipped output confirms it is using gcc 4.8.2.

Anyway, posting here to see if it's just me or if there's really a minor 
issue with Rdevel currently.

Thanks,
Matt


From wolfgang.viechtbauer at maastrichtuniversity.nl  Sun Sep 28 14:47:15 2014
From: wolfgang.viechtbauer at maastrichtuniversity.nl (Viechtbauer Wolfgang (STAT))
Date: Sun, 28 Sep 2014 14:47:15 +0200
Subject: [Rd] Using requireNamespace() instead of require()
Message-ID: <077E31A57DA26E46AB0D493C9966AC730DCCF99AE3@UM-MAIL4112.unimaas.nl>

Suppose I have a function funcA() in package pkgA that requires function funcB() from another package pkgB under certain circumstances. Those circumstances are rare though, so I put package pkgB under 'Suggests', and use this in funcA() when those circumstances do arise:

if (require("pkgB", quietly=TRUE)) {
   pkgB::funcB(...)
} else {
   stop("Please install package 'pkgB' to do this.")
}

I understand that using requireNamespace() would be preferable and I would also prefer to do that. But funcB() depends on funcC() from pkgC that it lists under 'Depends'. So, with require("pkgB"), both namespaces (of pkgB and pkgC) are loaded and attached to the search list and things run. But with requireNamespace("pkgB"), only the namespace of pkgB is loaded, so funcC() can't be found. So, I figured, I also use requireNamespace("pkgC"), but that's not sufficient, since funcB() calls funcC() and not pkgC::funcC().

Is there any solution to this?

Best,
Wolfgang


From murdoch.duncan at gmail.com  Sun Sep 28 15:09:24 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 28 Sep 2014 09:09:24 -0400
Subject: [Rd] Using requireNamespace() instead of require()
In-Reply-To: <077E31A57DA26E46AB0D493C9966AC730DCCF99AE3@UM-MAIL4112.unimaas.nl>
References: <077E31A57DA26E46AB0D493C9966AC730DCCF99AE3@UM-MAIL4112.unimaas.nl>
Message-ID: <54280884.6050700@gmail.com>

On 28/09/2014, 8:47 AM, Viechtbauer Wolfgang (STAT) wrote:
> Suppose I have a function funcA() in package pkgA that requires function funcB() from another package pkgB under certain circumstances. Those circumstances are rare though, so I put package pkgB under 'Suggests', and use this in funcA() when those circumstances do arise:
> 
> if (require("pkgB", quietly=TRUE)) {
>    pkgB::funcB(...)
> } else {
>    stop("Please install package 'pkgB' to do this.")
> }
> 
> I understand that using requireNamespace() would be preferable and I would also prefer to do that. But funcB() depends on funcC() from pkgC that it lists under 'Depends'. So, with require("pkgB"), both namespaces (of pkgB and pkgC) are loaded and attached to the search list and things run. But with requireNamespace("pkgB"), only the namespace of pkgB is loaded, so funcC() can't be found. So, I figured, I also use requireNamespace("pkgC"), but that's not sufficient, since funcB() calls funcC() and not pkgC::funcC().
> 
> Is there any solution to this?

The solution needs to be implemented by the maintainer of pkgB.  It
probably doesn't really need pkgC on the search list, and could be
modified to import funcC or explicitly call pkgC::funcC.

If you aren't the maintainer of pkgB, and the real maintainer is
unresponsive, then you're stuck using require().

Duncan Murdoch


From ripley at stats.ox.ac.uk  Sun Sep 28 15:23:15 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Sep 2014 14:23:15 +0100
Subject: [Rd] Using requireNamespace() instead of require()
In-Reply-To: <54280884.6050700@gmail.com>
References: <077E31A57DA26E46AB0D493C9966AC730DCCF99AE3@UM-MAIL4112.unimaas.nl>
	<54280884.6050700@gmail.com>
Message-ID: <54280BC3.3070909@stats.ox.ac.uk>

On 28/09/2014 14:09, Duncan Murdoch wrote:
> On 28/09/2014, 8:47 AM, Viechtbauer Wolfgang (STAT) wrote:
>> Suppose I have a function funcA() in package pkgA that requires function funcB() from another package pkgB under certain circumstances. Those circumstances are rare though, so I put package pkgB under 'Suggests', and use this in funcA() when those circumstances do arise:
>>
>> if (require("pkgB", quietly=TRUE)) {
>>     pkgB::funcB(...)
>> } else {
>>     stop("Please install package 'pkgB' to do this.")
>> }
>>
>> I understand that using requireNamespace() would be preferable and I would also prefer to do that. But funcB() depends on funcC() from pkgC that it lists under 'Depends'. So, with require("pkgB"), both namespaces (of pkgB and pkgC) are loaded and attached to the search list and things run. But with requireNamespace("pkgB"), only the namespace of pkgB is loaded, so funcC() can't be found. So, I figured, I also use requireNamespace("pkgC"), but that's not sufficient, since funcB() calls funcC() and not pkgC::funcC().
>>
>> Is there any solution to this?
>
> The solution needs to be implemented by the maintainer of pkgB.  It
> probably doesn't really need pkgC on the search list, and could be
> modified to import funcC or explicitly call pkgC::funcC.
>
> If you aren't the maintainer of pkgB, and the real maintainer is
> unresponsive, then you're stuck using require().

I was writing something very similar, but added

'If the maintainer of pkgB does not respond you probably do not want to 
rely on his work, not least because repository admins also will not get 
a response from him.'

>
> Duncan Murdoch


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From wolfgang.viechtbauer at maastrichtuniversity.nl  Mon Sep 29 10:32:05 2014
From: wolfgang.viechtbauer at maastrichtuniversity.nl (Viechtbauer Wolfgang (STAT))
Date: Mon, 29 Sep 2014 10:32:05 +0200
Subject: [Rd] Using requireNamespace() instead of require()
In-Reply-To: <54280BC3.3070909@stats.ox.ac.uk>
References: <077E31A57DA26E46AB0D493C9966AC730DCCF99AE3@UM-MAIL4112.unimaas.nl>
	<54280884.6050700@gmail.com> <54280BC3.3070909@stats.ox.ac.uk>
Message-ID: <077E31A57DA26E46AB0D493C9966AC730DCCF99C17@UM-MAIL4112.unimaas.nl>

Thanks for the quick and clear responses. Indeed, I am not the maintainer of pkgB. And I figured that the solution lies in changes being made to pkgB. Hopefully the package author will be responsive.

Best,
Wolfgang

> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Sent: Sunday, September 28, 2014 15:23
> To: Duncan Murdoch; Viechtbauer Wolfgang (STAT); r-devel at r-project.org
> Subject: Re: [Rd] Using requireNamespace() instead of require()
> 
> On 28/09/2014 14:09, Duncan Murdoch wrote:
> > On 28/09/2014, 8:47 AM, Viechtbauer Wolfgang (STAT) wrote:
> >> Suppose I have a function funcA() in package pkgA that requires
> function funcB() from another package pkgB under certain circumstances.
> Those circumstances are rare though, so I put package pkgB under
> 'Suggests', and use this in funcA() when those circumstances do arise:
> >>
> >> if (require("pkgB", quietly=TRUE)) {
> >>     pkgB::funcB(...)
> >> } else {
> >>     stop("Please install package 'pkgB' to do this.")
> >> }
> >>
> >> I understand that using requireNamespace() would be preferable and I
> would also prefer to do that. But funcB() depends on funcC() from pkgC
> that it lists under 'Depends'. So, with require("pkgB"), both namespaces
> (of pkgB and pkgC) are loaded and attached to the search list and things
> run. But with requireNamespace("pkgB"), only the namespace of pkgB is
> loaded, so funcC() can't be found. So, I figured, I also use
> requireNamespace("pkgC"), but that's not sufficient, since funcB() calls
> funcC() and not pkgC::funcC().
> >>
> >> Is there any solution to this?
> >
> > The solution needs to be implemented by the maintainer of pkgB.  It
> > probably doesn't really need pkgC on the search list, and could be
> > modified to import funcC or explicitly call pkgC::funcC.
> >
> > If you aren't the maintainer of pkgB, and the real maintainer is
> > unresponsive, then you're stuck using require().
> 
> I was writing something very similar, but added
> 
> 'If the maintainer of pkgB does not respond you probably do not want to
> rely on his work, not least because repository admins also will not get
> a response from him.'
> 
> >
> > Duncan Murdoch
> 
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford
> 1 South Parks Road, Oxford OX1 3TG, UK


From spindler at mea.mpisoc.mpg.de  Tue Sep 30 13:00:37 2014
From: spindler at mea.mpisoc.mpg.de (Martin Spindler)
Date: Tue, 30 Sep 2014 13:00:37 +0200
Subject: [Rd] Package Rcpp: Question conerning source code of cpp files and
 related question
In-Reply-To: <trinity-5f1e01aa-b4d7-45e3-b269-f071d5626ece-1412074654721@3capp-gmx-bs52>
References: <trinity-5f1e01aa-b4d7-45e3-b269-f071d5626ece-1412074654721@3capp-gmx-bs52>
Message-ID: <542A8D55.2070700@mea.mpisoc.mpg.de>

Dear all,
I am trying to use Rcpp to write some files in C++ for use in R.
Below is an example for a cpp-file (crossp.cpp). Then I use 
 >sourceCpp("crossp.cpp") in R and the corresponding function is 
availabe in R.
Now I have to question related to this worklfow:
1) Is there a way to see the source file of the "final" cpp-file? (I 
mean is it possible to see how the //-lines are replaced and what 
soureCpp does?)
2) (Connected with the first question) Up to now, I am working in R 
Studio, but I would  prefer an IDE (e.g. NetBeans IDE). But when I 
compile the cpp-file there,  the following message shows up:
In file included from 
/R/win-library/3.0/RcppArmadillo/include/RcppArmadilloForward.h:28:0,
                  from 
/R/win-library/3.0/RcppArmadillo/include/RcppArmadillo.h:30,
                  from crossp.cpp:1:
/R/win-library/3.0/RcppArmadillo/include/RcppArmadilloConfig.h:90:35: 
fatal error: RcppArmadilloLapack.h: No such file or directory
    #include <RcppArmadilloLapack.h>
Is there an way to compile the file without sourCpp but in an IDE? What 
do I have to change?
As I am starting to work with Rcpp my question might sound silly, but 
any help and comments are highly welcome.
Thank you very much for your help in advance!
Best,
Martin
crossp.cpp:
#include <RcppArmadillo.h>
// [[Rcpp::depends(RcppArmadillo)]]
using namespace Rcpp;
using namespace arma;
//[[Rcpp::export]]
NumericMatrix crossp3(NumericMatrix Xr) {
   int n = Xr.nrow(), k = Xr.ncol();
   arma::mat X(Xr.begin(), n, k, false);
   arma::mat XXt = X.t()*X;
   return Rcpp::wrap(XXt);
}


	[[alternative HTML version deleted]]


From edd at debian.org  Tue Sep 30 13:38:37 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 30 Sep 2014 06:38:37 -0500
Subject: [Rd] Package Rcpp: Question conerning source code of cpp files
 and related question
In-Reply-To: <542A8D55.2070700@mea.mpisoc.mpg.de>
References: <trinity-5f1e01aa-b4d7-45e3-b269-f071d5626ece-1412074654721@3capp-gmx-bs52>
	<542A8D55.2070700@mea.mpisoc.mpg.de>
Message-ID: <21546.38461.713484.287226@max.nulle.part>


On 30 September 2014 at 13:00, Martin Spindler wrote:
| I am trying to use Rcpp to write some files in C++ for use in R.

Please subscribe to rcpp-devel, and post on that list.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From b.rowlingson at lancaster.ac.uk  Tue Sep 30 13:41:26 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 30 Sep 2014 12:41:26 +0100
Subject: [Rd] Intel Fortran compiler returns a -1 TRUE value
Message-ID: <CANVKczM_RkKjX_8U62Zb4BG=afNin3t=bjMb+CJKLEv6O2U-DQ@mail.gmail.com>

I have access to a cluster on which I have been supplied with R 3.1.0 which
appears to have been built using the intel compiler tools.

The following minimal Fortran file:

      subroutine truth(lind)
      logical lind
      lind = .TRUE.
      end

Compiles thusly:

arcadia> R CMD SHLIB truth.f
ifort   -fpic  -O3 -xHOST -axCORE-AVX-I -fp-model precise  -c truth.f -o
truth.o
ifort: command line warning #10212: -fp-model precise evaluates in source
precision with Fortran.
icc -std=gnu99 -shared -L/usr/local/lib64 -o truth.so truth.o -lifport
-lifcore -limf -lsvml -lm -lipgo -lirc -lpthread -lirc_s -ldl


And runs so:

 > dyn.load("truth.so")
 > z = .Fortran("truth",as.logical(TRUE))
 > z[[1]]
 [1] TRUE
 > as.numeric(z[[1]])
 [1] -1
 > z[[1]] == TRUE
 [1] FALSE
 > all(z[[1]])
 [1] TRUE
 > identical(z[[1]],TRUE)
 [1] FALSE

The value generated by Fortran's .TRUE. evaluates as "truthy" -- as in
all(z[[1]]) -- but is neither equal to nor identical to TRUE. Its numeric
conversion to -1 is most unusual, every other system I've tried converts to
+1.

So.... wrong compiler flag on build? User error - never try comparing
truthy values, as with the various flavours of NA? Or something else?

If its a compiler/config problem I'll pass it on to the cluster admin -
I've had a good look for stuff on building R on Intel compilers, nothing
stood out. I might try building R myself this afternoon but as I implied I
don't have admin on this cluster so I might have to track down a bunch of
library sources to build R from source.

If its a user error then I'll track down every instance of "if(foo==TRUE)"
and shoot it, and it would be nice to have a note in ?TRUE

Some useful info:

> sessionInfo()
R version 3.1.0 (2014-04-10)
Platform: x86_64-unknown-linux-gnu (64-bit)

arcadia> ifort -v
ifort version 13.0.0


Thanks

Barry

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Sep 30 13:53:22 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Sep 2014 07:53:22 -0400
Subject: [Rd] Intel Fortran compiler returns a -1 TRUE value
In-Reply-To: <CANVKczM_RkKjX_8U62Zb4BG=afNin3t=bjMb+CJKLEv6O2U-DQ@mail.gmail.com>
References: <CANVKczM_RkKjX_8U62Zb4BG=afNin3t=bjMb+CJKLEv6O2U-DQ@mail.gmail.com>
Message-ID: <542A99B2.7030005@gmail.com>

On 30/09/2014, 7:41 AM, Barry Rowlingson wrote:
> I have access to a cluster on which I have been supplied with R 3.1.0 which
> appears to have been built using the intel compiler tools.
> 
> The following minimal Fortran file:
> 
>       subroutine truth(lind)
>       logical lind
>       lind = .TRUE.
>       end
> 
> Compiles thusly:
> 
> arcadia> R CMD SHLIB truth.f
> ifort   -fpic  -O3 -xHOST -axCORE-AVX-I -fp-model precise  -c truth.f -o
> truth.o
> ifort: command line warning #10212: -fp-model precise evaluates in source
> precision with Fortran.
> icc -std=gnu99 -shared -L/usr/local/lib64 -o truth.so truth.o -lifport
> -lifcore -limf -lsvml -lm -lipgo -lirc -lpthread -lirc_s -ldl
> 
> 
> And runs so:
> 
>  > dyn.load("truth.so")
>  > z = .Fortran("truth",as.logical(TRUE))
>  > z[[1]]
>  [1] TRUE
>  > as.numeric(z[[1]])
>  [1] -1
>  > z[[1]] == TRUE
>  [1] FALSE
>  > all(z[[1]])
>  [1] TRUE
>  > identical(z[[1]],TRUE)
>  [1] FALSE
> 
> The value generated by Fortran's .TRUE. evaluates as "truthy" -- as in
> all(z[[1]]) -- but is neither equal to nor identical to TRUE. Its numeric
> conversion to -1 is most unusual, every other system I've tried converts to
> +1.
> 
> So.... wrong compiler flag on build? User error - never try comparing
> truthy values, as with the various flavours of NA? Or something else?
> 
> If its a compiler/config problem I'll pass it on to the cluster admin -
> I've had a good look for stuff on building R on Intel compilers, nothing
> stood out. I might try building R myself this afternoon but as I implied I
> don't have admin on this cluster so I might have to track down a bunch of
> library sources to build R from source.
> 
> If its a user error then I'll track down every instance of "if(foo==TRUE)"
> and shoot it, and it would be nice to have a note in ?TRUE
> 
> Some useful info:
> 
>> sessionInfo()
> R version 3.1.0 (2014-04-10)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> arcadia> ifort -v
> ifort version 13.0.0

This appears to be user error.  According to Writing R Extensions, the
Fortran type corresponding to R logical is INTEGER, not LOGICAL.

Duncan Murdoch


From b.rowlingson at lancaster.ac.uk  Tue Sep 30 14:39:59 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 30 Sep 2014 13:39:59 +0100
Subject: [Rd] Intel Fortran compiler returns a -1 TRUE value
In-Reply-To: <d78ed9a7be1e4540a70714bf81af0cd6@EX-0-HT0.lancs.local>
References: <CANVKczM_RkKjX_8U62Zb4BG=afNin3t=bjMb+CJKLEv6O2U-DQ@mail.gmail.com>
	<d78ed9a7be1e4540a70714bf81af0cd6@EX-0-HT0.lancs.local>
Message-ID: <CANVKczNY2JtHkf=0bcwdZOstwSBPaWCYVRWRkq3wOS7d33cjMA@mail.gmail.com>

On Tue, Sep 30, 2014 at 12:53 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

>
> This appears to be user error.  According to Writing R Extensions, the
> Fortran type corresponding to R logical is INTEGER, not LOGICAL.
>

Oh yes, a very old and long-standing user error. I assume the CRAN checks
don't check this. Has it ever been okay to pass logicals to Fortran?

 I shall inform the package maintainer....

Thanks

Barry

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Sep 30 14:59:40 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Sep 2014 08:59:40 -0400
Subject: [Rd] Intel Fortran compiler returns a -1 TRUE value
In-Reply-To: <CANVKczNY2JtHkf=0bcwdZOstwSBPaWCYVRWRkq3wOS7d33cjMA@mail.gmail.com>
References: <CANVKczM_RkKjX_8U62Zb4BG=afNin3t=bjMb+CJKLEv6O2U-DQ@mail.gmail.com>	<d78ed9a7be1e4540a70714bf81af0cd6@EX-0-HT0.lancs.local>
	<CANVKczNY2JtHkf=0bcwdZOstwSBPaWCYVRWRkq3wOS7d33cjMA@mail.gmail.com>
Message-ID: <542AA93C.8060808@gmail.com>

On 30/09/2014 8:39 AM, Barry Rowlingson wrote:
>
>
> On Tue, Sep 30, 2014 at 12:53 PM, Duncan Murdoch 
> <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
>
>
>     This appears to be user error.  According to Writing R Extensions, the
>     Fortran type corresponding to R logical is INTEGER, not LOGICAL.
>
>
> Oh yes, a very old and long-standing user error. I assume the CRAN 
> checks don't check this.

The checks can't really see that kind of thing:  they don't understand 
the external languages.  It's up to the user to follow the instructions 
in most cases.

> Has it ever been okay to pass logicals to Fortran?
>
It's okay to pass R logicals to Fortran (where they become INTEGER), 
it's just not okay to pass Fortran LOGICALs to R. The gcc Fortran 
compilers treat logicals the same as C does (i.e. 0 and 1 for FALSE and 
TRUE), but others don't, as you found out.

Duncan Murdoch

>  I shall inform the package maintainer....
>
> Thanks
>
> Barry
>


From wdunlap at tibco.com  Tue Sep 30 19:25:19 2014
From: wdunlap at tibco.com (William Dunlap)
Date: Tue, 30 Sep 2014 10:25:19 -0700
Subject: [Rd] Intel Fortran compiler returns a -1 TRUE value
In-Reply-To: <CANVKczNY2JtHkf=0bcwdZOstwSBPaWCYVRWRkq3wOS7d33cjMA@mail.gmail.com>
References: <CANVKczM_RkKjX_8U62Zb4BG=afNin3t=bjMb+CJKLEv6O2U-DQ@mail.gmail.com>
	<d78ed9a7be1e4540a70714bf81af0cd6@EX-0-HT0.lancs.local>
	<CANVKczNY2JtHkf=0bcwdZOstwSBPaWCYVRWRkq3wOS7d33cjMA@mail.gmail.com>
Message-ID: <CAF8bMcZq9LBcDfsX9oQ95qcEYKUT2s4MRzkS9DHnYgRvvPaC6g@mail.gmail.com>

In S+ and S it was valid to pass logicals to .Fortran, where they got
mapped into the
appropriate bit pattern.  (The trouble was that 'appropriate' was
compiled into the program -
so you were locked into our compiler vendor's choice).   Passing them
between Fortran
code and C code has always been a problem (as has passing character
data between them).

Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Tue, Sep 30, 2014 at 5:39 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Tue, Sep 30, 2014 at 12:53 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>>
>> This appears to be user error.  According to Writing R Extensions, the
>> Fortran type corresponding to R logical is INTEGER, not LOGICAL.
>>
>
> Oh yes, a very old and long-standing user error. I assume the CRAN checks
> don't check this. Has it ever been okay to pass logicals to Fortran?
>
>  I shall inform the package maintainer....
>
> Thanks
>
> Barry
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kevinushey at gmail.com  Tue Sep 30 20:14:48 2014
From: kevinushey at gmail.com (Kevin Ushey)
Date: Tue, 30 Sep 2014 11:14:48 -0700
Subject: [Rd] R's internal tar ignores files in sub-directories
Message-ID: <CAJXgQP2k2yStn9KNRkXj=hXd9vdRgrbHutkHZEMsvTQs1JSSVQ@mail.gmail.com>

E.g. I am seeing:

    dir <- file.path(tempdir(), "test-tar")
    dir.create(dir)
    setwd(dir)

    dir.create("foo", showWarnings = FALSE)
    file.create("foo/bar.R")

    tar("test.tar", files = "foo/bar.R")
    dir.create("untarred")
    untar("test.tar", exdir = "untarred")
    list.files("untarred", recursive = TRUE) # character(0)

As far as I can see, the documentation in `?tar` does not reflect that
R's internal `tar` expects paths to directories, not files themselves.
Although I would have preferred the files being included, or at least
a warning / error that they would be excluded.

Thanks,
Kevin

> sessionInfo()
R version 3.1.1 Patched (2014-09-27 r66695)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_3.1.1


From hj at jhu.edu  Tue Sep 30 21:28:22 2014
From: hj at jhu.edu (Harris A. Jaffee)
Date: Tue, 30 Sep 2014 15:28:22 -0400
Subject: [Rd] R's internal tar ignores files in sub-directories
In-Reply-To: <CAJXgQP2k2yStn9KNRkXj=hXd9vdRgrbHutkHZEMsvTQs1JSSVQ@mail.gmail.com>
References: <CAJXgQP2k2yStn9KNRkXj=hXd9vdRgrbHutkHZEMsvTQs1JSSVQ@mail.gmail.com>
Message-ID: <C6C78EA4-7B12-498D-953F-16ECF3F658B8@jhu.edu>

Sounds like a bug to me, at least in documentation.  I would say
that it ignores them by accident.  I doubt that skipping files is
intended.

The problem appears to be that the 'files' argument to tar() becomes
the 'path' argument to list.files(), and the spec for 'path' is not
a whole lot more illuminating.  Only the Description in ?list.files
refers to a _named directory_.

Your tar call blindly does list.files("foo/bar.R"), which is empty,
hence your undesired result, when it should only call list.files for
directories.

On Sep 30, 2014, at 2:14 PM, Kevin Ushey <kevinushey at gmail.com> wrote:

> E.g. I am seeing:
> 
>    dir <- file.path(tempdir(), "test-tar")
>    dir.create(dir)
>    setwd(dir)
> 
>    dir.create("foo", showWarnings = FALSE)
>    file.create("foo/bar.R")
> 
>    tar("test.tar", files = "foo/bar.R")
>    dir.create("untarred")
>    untar("test.tar", exdir = "untarred")
>    list.files("untarred", recursive = TRUE) # character(0)
> 
> As far as I can see, the documentation in `?tar` does not reflect that
> R's internal `tar` expects paths to directories, not files themselves.
> Although I would have preferred the files being included, or at least
> a warning / error that they would be excluded.
> 
> Thanks,
> Kevin
> 
>> sessionInfo()
> R version 3.1.1 Patched (2014-09-27 r66695)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> 
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] tools_3.1.1
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From gomez.matthieu at gmail.com  Tue Sep 30 23:20:48 2014
From: gomez.matthieu at gmail.com (Matthieu Gomez)
Date: Tue, 30 Sep 2014 17:20:48 -0400
Subject: [Rd] Shallow copies
Message-ID: <CAE2Fiwnz9RkqpPvKfU=WkgqJiLfZyH-Xw=mmzR+c6F-7BVhpQg@mail.gmail.com>

I have a question about shallow copies in R. Since R 3.1.0, subsetting
a dataframe with respect to its columns no longer result in deep
copies. This is an amazing change in my opinion. Now, subsetting a
data.frame by rows (or subsetting a matrix by columns or rows) still
does deep copies. In particular, it is my understanding that running a
command on a very large subset of rows (say "sum" or "biglm" on non
outliers observations) results in a deep copy of these rows first,
which can require twice as much the memory of the original
data.frame/matrix. If this is correct, I would be very interested to
know more on whether this behavior can/may change in future versions
of R.

Thanks a lot!,
Matthew


