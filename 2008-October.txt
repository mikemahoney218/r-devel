From weigand.stephen at gmail.com  Wed Oct  1 01:05:38 2008
From: weigand.stephen at gmail.com (Stephen Weigand)
Date: Tue, 30 Sep 2008 18:05:38 -0500
Subject: [Rd] Typo in x11.Rd
Message-ID: <bc47d3330809301605r506373cuef992667970f86be@mail.gmail.com>

Hi,

There is a double "the" in x11.Rd:

"...which is faster will depend on the the X11 connection"

Thank you,

Stephen

-- 
Rochester, Minn. USA


From murdoch at stats.uwo.ca  Wed Oct  1 12:18:38 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 01 Oct 2008 06:18:38 -0400
Subject: [Rd] Typo in x11.Rd
In-Reply-To: <bc47d3330809301605r506373cuef992667970f86be@mail.gmail.com>
References: <bc47d3330809301605r506373cuef992667970f86be@mail.gmail.com>
Message-ID: <48E34E7E.6060206@stats.uwo.ca>

On 30/09/2008 7:05 PM, Stephen Weigand wrote:
> Hi,
> 
> There is a double "the" in x11.Rd:
> 
> "...which is faster will depend on the the X11 connection"

Thanks, I'll fix that.  I noticed the same error in a few other places.
I didn't fix the recommended packages:

boot\man\boot.array.Rd(9)
boot\man\exp.tilt.Rd(72)
boot\man\glm.diag.Rd(37)
lattice\man\print.trellis.Rd(111)
mgcv\man\full.score.Rd(11)
mgcv\man\gam.models.Rd(13)
nlme\man\Phenobarb.Rd(21)

(but those might not be most current versions.)

Duncan Murdoch


From rkoenker at uiuc.edu  Thu Oct  2 00:48:35 2008
From: rkoenker at uiuc.edu (roger koenker)
Date: Wed, 1 Oct 2008 17:48:35 -0500
Subject: [Rd] p-values from a resampled reference distribution
Message-ID: <FEC673A1-84FA-485E-815A-9A9B5C9FE1E7@uiuc.edu>

I'm implementing a new testing procedure proposed by Chen, Ying, Zhang
and Zhao (Biometrika, 2008) that employs a reference distribution  
obtained
by a resampling method.  For the moment I'm using logspline to  
estimate the
reference density and then computing the p-value using plogspline.  I  
would
be interested in hearing  about other suggestions from anyone who has
looked at similar situations.


url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Champaign, IL 61820


From bolker at zoology.ufl.edu  Thu Oct  2 15:02:04 2008
From: bolker at zoology.ufl.edu (Ben Bolker)
Date: Thu, 02 Oct 2008 09:02:04 -0400
Subject: [Rd] hostingzero.net  down?
Message-ID: <48E4C64C.7090702@zoology.ufl.edu>


  It looks like the Tampa, FL mirror
(cran.hostingzero.net) is down -- I
don't know if there's anything to be
done or not.

  Ben Bolker


From vdewit at ulg.ac.be  Thu Oct  2 20:45:10 2008
From: vdewit at ulg.ac.be (vdewit at ulg.ac.be)
Date: Thu,  2 Oct 2008 20:45:10 +0200 (CEST)
Subject: [Rd] quartz device (PR#13115)
Message-ID: <20081002184510.BD5A0282C770@mail.pubhealth.ku.dk>

Dear,

The quartz device doesn't work in R version 2.7.2 (2008-08-25), on my
MacBook Pro. For example, when I just type 'demo(graphics)', the quartz
window stays empty and the clockwise time indicator keeps on running in
the R window.

What should I do to fix this bug?

Thanks in advance,

Vanessa


From ohmforever at yahoo.com.mx  Thu Oct  2 19:40:10 2008
From: ohmforever at yahoo.com.mx (ohmforever at yahoo.com.mx)
Date: Thu,  2 Oct 2008 19:40:10 +0200 (CEST)
Subject: [Rd] Data Base (PR#13114)
Message-ID: <20081002174010.0C865282C761@mail.pubhealth.ku.dk>

Full_Name: Araceli Ram?rez Grac?a
Version: 2.7
OS: Linux
Submission from: (NULL) (132.248.180.224)


I have one problems to connect one Data Base (postgres) with R


From david.stevens at stat.math.ethz.ch  Thu Oct  2 23:50:07 2008
From: david.stevens at stat.math.ethz.ch (david.stevens at stat.math.ethz.ch)
Date: Thu,  2 Oct 2008 23:50:07 +0200 (CEST)
Subject: [Rd] metafiles under windows (PR#13116)
Message-ID: <20081002215007.0D2A4282C761@mail.pubhealth.ku.dk>

Full_Name: David Stevens
Version: 2.7.0
OS: Window SP
Submission from: (NULL) (129.123.9.110)


Lately I've been copying graphics to a metafile to paste to a document. No
matter what the graphics window size, the pasted graphic only fills the upper
left 1/3 of the allocated space. How can I make it fill the space


From pego.enrico at tiscali.it  Fri Oct  3 10:05:06 2008
From: pego.enrico at tiscali.it (pego.enrico at tiscali.it)
Date: Fri,  3 Oct 2008 10:05:06 +0200 (CEST)
Subject: [Rd] A strange behaviour of file.path in Windows? (PR#13119)
Message-ID: <20081003080506.4D9A52834611@mail.pubhealth.ku.dk>

Full_Name: Enrico Pegoraro
Version: 2.7.2
OS: Windows (Vista or Xp PRO) Italian
Submission from: (NULL) (87.4.189.202)


If you send these lines of code:

outdir="c:/pippo"
file.path(outdir,"pluto.html")

R replies correctly:

[1] "c:/pippo/pluto.html"

But if you change the first steps to:

outdir=""
file.path(outdir,"pluto.html")

R replies (uncorrectly, I think)

[1] "/c:/pippo/pluto.html"

This problem influence the R2HTML package too, which, if you send a line as:

targetHtml=HTMLInitFile(outdir="",filename="htmlFile",Title ="Title")

in windows it submit an error because of file.path() error.

Thank you
Enrico


From gb at stat.umu.se  Fri Oct  3 11:32:03 2008
From: gb at stat.umu.se (=?ISO-8859-1?Q?G=F6ran_Brostr=F6m?=)
Date: Fri, 03 Oct 2008 11:32:03 +0200
Subject: [Rd] Memory crash
Message-ID: <48E5E693.7050301@stat.umu.se>

Hello,

I get a segfault when running glmmboot in my own package glmmML. Has 
happened many time before, but this time I get no hint of where in my C 
functions the error might be. I give the output below. Can this be an R 
bug? I suspect it has to do with repeated calls to 'vmmin' like this:

            for (...){
                 vmax = vmaxget();
		vmmin(*p, b, &Fmin,
		      bfun, bfun_gr, *maxit, *trace,
		      mask, abstol, reltol, nREPORT,
		      ext, &fncount, &grcount, &fail);
		vmaxset(vmax);
                 ...
            }

but I am only guessing. Any suggestions?

Ubuntu 8.04, R-2.7.2.

G?ran
-------------------------------------------------------------------
  > glmmboot(y ~ x, cluster = cluster, data = res$dat, family = 
binomial, boot = 400)

Program received signal SIGSEGV, Segmentation fault.
0x000000000041a817 in R_gc_internal (size_needed=3000) at memory.c:1317
1317	    PROCESS_NODES();
(gdb) where
#0  0x000000000041a817 in R_gc_internal (size_needed=3000) at memory.c:1317
#1  0x000000000041c31c in Rf_allocVector (type=14, length=3000)
     at memory.c:1968
#2  0x000000000052a647 in duplicate1 (s=0x20cb4a0) at duplicate.c:214
#3  0x00000000004e1775 in do_makelist (call=<value optimized out>,
     op=<value optimized out>, args=0x1e18238, rho=<value optimized out>)
     at builtin.c:645
#4  0x000000000054697a in Rf_eval (e=0x10685a0, rho=0x1c557e0) at eval.c:492
#5  0x000000000054a7ef in do_set (call=0x10684f8, op=0x936188, 
args=0x1068530,
     rho=0x1c557e0) at eval.c:1424
#6  0x0000000000546896 in Rf_eval (e=0x10684f8, rho=0x1c557e0) at eval.c:463
#7  0x00000000005474c0 in do_begin (call=0x1089ab0, op=0x936ef8,
     args=0x10684c0, rho=0x1c557e0) at eval.c:1176
#8  0x0000000000546896 in Rf_eval (e=0x1089ab0, rho=0x1c557e0) at eval.c:463
#9  0x0000000000546896 in Rf_eval (e=0x1089960, rho=0x1c557e0) at eval.c:463
#10 0x00000000005474c0 in do_begin (call=0x10fa1c0, op=0x936ef8,
     args=0x10898f0, rho=0x1c557e0) at eval.c:1176
#11 0x0000000000546896 in Rf_eval (e=0x10fa1c0, rho=0x1c557e0) at eval.c:463
#12 0x0000000000548a4c in Rf_applyClosure (call=0x13714e8, op=0x10fa4e8,
     arglist=0x1c551c0, rho=0x1e06538, suppliedenv=0x959c50) at eval.c:669
#13 0x00000000005467b8 in Rf_eval (e=0x13714e8, rho=0x1e06538) at eval.c:507
#14 0x000000000054a7ef in do_set (call=0x1371440, op=0x936188, 
args=0x1371478,
     rho=0x1e06538) at eval.c:1424
#15 0x0000000000546896 in Rf_eval (e=0x1371440, rho=0x1e06538) at eval.c:463
#16 0x00000000005474c0 in do_begin (call=0x137e938, op=0x936ef8,
     args=0x1371408, rho=0x1e06538) at eval.c:1176
#17 0x0000000000546896 in Rf_eval (e=0x137e938, rho=0x1e06538) at eval.c:463
#18 0x0000000000548a4c in Rf_applyClosure (call=0x1e05ff8, op=0x137ef08,
     arglist=0x1e060a0, rho=0x959c18, suppliedenv=0x959c50) at eval.c:669
#19 0x00000000005467b8 in Rf_eval (e=0x1e05ff8, rho=0x959c18) at eval.c:507
#20 0x0000000000416b95 in Rf_ReplIteration (rho=0x959c18, savestack=0,
     browselevel=0, state=0x7fffca277fa0) at main.c:257
#21 0x0000000000416e60 in R_ReplConsole (rho=0x959c18, savestack=0,
     browselevel=0) at main.c:306
#22 0x0000000000417140 in run_Rmainloop () at main.c:967
#23 0x0000000000414c08 in main (ac=<value optimized out>,
     av=<value optimized out>) at Rmain.c:35
#24 0x00007f10c116a1c4 in __libc_start_main () from /lib/libc.so.6
#25 0x0000000000414b29 in _start ()

-- 
G?ran Brostr?m               phone: 46 90 786 5223; 46 705 197 507
Department of Statistics     fax: 46 90 786 6614
Ume? University              email: gb at stat.umu.se
SE-90187 Ume?, Sweden        http://www.stat.umu.se/personal/goran.brostrom


From ripley at stats.ox.ac.uk  Fri Oct  3 11:46:27 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 3 Oct 2008 10:46:27 +0100 (BST)
Subject: [Rd] Memory crash
In-Reply-To: <48E5E693.7050301@stat.umu.se>
References: <48E5E693.7050301@stat.umu.se>
Message-ID: <alpine.LFD.2.00.0810031041540.11618@auk.stats.ox.ac.uk>

Very likely your C code is writing out of bounds and has corrupted R's 
memory heap.  Use the tools discussed in 'Writing R Extensions' (such as 
Valgrind) to help you track this down.

On Fri, 3 Oct 2008, G?ran Brostr?m wrote:

> Hello,
>
> I get a segfault when running glmmboot in my own package glmmML. Has happened 
> many time before, but this time I get no hint of where in my C functions the 
> error might be. I give the output below. Can this be an R bug? I suspect it 
> has to do with repeated calls to 'vmmin' like this:

Based on past experience of users blaming their tools, the probability
that R is completely innocent here is close to one.

>           for (...){
>                vmax = vmaxget();
> 		vmmin(*p, b, &Fmin,
> 		      bfun, bfun_gr, *maxit, *trace,
> 		      mask, abstol, reltol, nREPORT,
> 		      ext, &fncount, &grcount, &fail);
> 		vmaxset(vmax);
>                ...
>           }
>
> but I am only guessing. Any suggestions?
>
> Ubuntu 8.04, R-2.7.2.
>
> G?ran
> -------------------------------------------------------------------
> > glmmboot(y ~ x, cluster = cluster, data = res$dat, family = binomial, boot 
> = 400)
>
> Program received signal SIGSEGV, Segmentation fault.
> 0x000000000041a817 in R_gc_internal (size_needed=3000) at memory.c:1317
> 1317	    PROCESS_NODES();
> (gdb) where
> #0  0x000000000041a817 in R_gc_internal (size_needed=3000) at memory.c:1317
> #1  0x000000000041c31c in Rf_allocVector (type=14, length=3000)
>    at memory.c:1968
> #2  0x000000000052a647 in duplicate1 (s=0x20cb4a0) at duplicate.c:214
> #3  0x00000000004e1775 in do_makelist (call=<value optimized out>,
>    op=<value optimized out>, args=0x1e18238, rho=<value optimized out>)
>    at builtin.c:645
> #4  0x000000000054697a in Rf_eval (e=0x10685a0, rho=0x1c557e0) at eval.c:492
> #5  0x000000000054a7ef in do_set (call=0x10684f8, op=0x936188, 
> args=0x1068530,
>    rho=0x1c557e0) at eval.c:1424
> #6  0x0000000000546896 in Rf_eval (e=0x10684f8, rho=0x1c557e0) at eval.c:463
> #7  0x00000000005474c0 in do_begin (call=0x1089ab0, op=0x936ef8,
>    args=0x10684c0, rho=0x1c557e0) at eval.c:1176
> #8  0x0000000000546896 in Rf_eval (e=0x1089ab0, rho=0x1c557e0) at eval.c:463
> #9  0x0000000000546896 in Rf_eval (e=0x1089960, rho=0x1c557e0) at eval.c:463
> #10 0x00000000005474c0 in do_begin (call=0x10fa1c0, op=0x936ef8,
>    args=0x10898f0, rho=0x1c557e0) at eval.c:1176
> #11 0x0000000000546896 in Rf_eval (e=0x10fa1c0, rho=0x1c557e0) at eval.c:463
> #12 0x0000000000548a4c in Rf_applyClosure (call=0x13714e8, op=0x10fa4e8,
>    arglist=0x1c551c0, rho=0x1e06538, suppliedenv=0x959c50) at eval.c:669
> #13 0x00000000005467b8 in Rf_eval (e=0x13714e8, rho=0x1e06538) at eval.c:507
> #14 0x000000000054a7ef in do_set (call=0x1371440, op=0x936188, 
> args=0x1371478,
>    rho=0x1e06538) at eval.c:1424
> #15 0x0000000000546896 in Rf_eval (e=0x1371440, rho=0x1e06538) at eval.c:463
> #16 0x00000000005474c0 in do_begin (call=0x137e938, op=0x936ef8,
>    args=0x1371408, rho=0x1e06538) at eval.c:1176
> #17 0x0000000000546896 in Rf_eval (e=0x137e938, rho=0x1e06538) at eval.c:463
> #18 0x0000000000548a4c in Rf_applyClosure (call=0x1e05ff8, op=0x137ef08,
>    arglist=0x1e060a0, rho=0x959c18, suppliedenv=0x959c50) at eval.c:669
> #19 0x00000000005467b8 in Rf_eval (e=0x1e05ff8, rho=0x959c18) at eval.c:507
> #20 0x0000000000416b95 in Rf_ReplIteration (rho=0x959c18, savestack=0,
>    browselevel=0, state=0x7fffca277fa0) at main.c:257
> #21 0x0000000000416e60 in R_ReplConsole (rho=0x959c18, savestack=0,
>    browselevel=0) at main.c:306
> #22 0x0000000000417140 in run_Rmainloop () at main.c:967
> #23 0x0000000000414c08 in main (ac=<value optimized out>,
>    av=<value optimized out>) at Rmain.c:35
> #24 0x00007f10c116a1c4 in __libc_start_main () from /lib/libc.so.6
> #25 0x0000000000414b29 in _start ()
>
> -- 
> G?ran Brostr?m               phone: 46 90 786 5223; 46 705 197 507
> Department of Statistics     fax: 46 90 786 6614
> Ume? University              email: gb at stat.umu.se
> SE-90187 Ume?, Sweden        http://www.stat.umu.se/personal/goran.brostrom
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Richard.Cotton at hsl.gov.uk  Fri Oct  3 12:27:08 2008
From: Richard.Cotton at hsl.gov.uk (Richard.Cotton at hsl.gov.uk)
Date: Fri, 3 Oct 2008 11:27:08 +0100
Subject: [Rd] A strange behaviour of file.path in Windows? (PR#13119)
In-Reply-To: <20081003080506.4D9A52834611@hsl.gov.uk>
Message-ID: <OFCA860216.46491DB6-ON802574D7.00392230-802574D7.0039685B@hsl.gov.uk>

> If you send these lines of code:
> 
> outdir="c:/pippo"
> file.path(outdir,"pluto.html")
> 
> R replies correctly:
> 
> [1] "c:/pippo/pluto.html"
> 
> But if you change the first steps to:
> 
> outdir=""
> file.path(outdir,"pluto.html")
> 
> R replies (uncorrectly, I think)
> 
> [1] "/c:/pippo/pluto.html"

I don't get the same output as you.  Are you sure you haven't changed 
output somewhere else in your code?

outdir="c:/pippo"
file.path(outdir,"pluto.html")

[1] "c:/pippo/pluto.html"

outdir=""
file.path(outdir,"pluto.html")

[1] "/pluto.html"

This is under R2.7.2/ Win XP.

Regards,
Richie.

Mathematical Sciences Unit
HSL


------------------------------------------------------------------------
ATTENTION:

This message contains privileged and confidential inform...{{dropped:20}}


From gb at stat.umu.se  Fri Oct  3 12:52:44 2008
From: gb at stat.umu.se (=?ISO-8859-1?Q?G=F6ran_Brostr=F6m?=)
Date: Fri, 03 Oct 2008 12:52:44 +0200
Subject: [Rd] Memory crash
In-Reply-To: <alpine.LFD.2.00.0810031041540.11618@auk.stats.ox.ac.uk>
References: <48E5E693.7050301@stat.umu.se>
	<alpine.LFD.2.00.0810031041540.11618@auk.stats.ox.ac.uk>
Message-ID: <48E5F97C.4060209@stat.umu.se>

Prof Brian Ripley wrote:
> Very likely your C code is writing out of bounds and has corrupted R's 
> memory heap.  Use the tools discussed in 'Writing R Extensions' (such as 
> Valgrind) to help you track this down.

Brian, thanks a lot; I installed valgrind, and the error was promptly 
spotted (your qualified guess was correct!). A new version of glmmML 
will soon be available.

G?ran

> 
> On Fri, 3 Oct 2008, G?ran Brostr?m wrote:
> 
>> Hello,
>>
>> I get a segfault when running glmmboot in my own package glmmML. Has 
>> happened many time before, but this time I get no hint of where in my 
>> C functions the error might be. I give the output below. Can this be 
>> an R bug? I suspect it has to do with repeated calls to 'vmmin' like 
>> this:
> 
> Based on past experience of users blaming their tools, the probability
> that R is completely innocent here is close to one.
> 
>>           for (...){
>>                vmax = vmaxget();
>>         vmmin(*p, b, &Fmin,
>>               bfun, bfun_gr, *maxit, *trace,
>>               mask, abstol, reltol, nREPORT,
>>               ext, &fncount, &grcount, &fail);
>>         vmaxset(vmax);
>>                ...
>>           }
>>
>> but I am only guessing. Any suggestions?
>>
>> Ubuntu 8.04, R-2.7.2.
>>
>> G?ran
>> -------------------------------------------------------------------
>> > glmmboot(y ~ x, cluster = cluster, data = res$dat, family = 
>> binomial, boot = 400)
>>
>> Program received signal SIGSEGV, Segmentation fault.
>> 0x000000000041a817 in R_gc_internal (size_needed=3000) at memory.c:1317
>> 1317        PROCESS_NODES();
>> (gdb) where
>> #0  0x000000000041a817 in R_gc_internal (size_needed=3000) at 
>> memory.c:1317
>> #1  0x000000000041c31c in Rf_allocVector (type=14, length=3000)
>>    at memory.c:1968
>> #2  0x000000000052a647 in duplicate1 (s=0x20cb4a0) at duplicate.c:214
>> #3  0x00000000004e1775 in do_makelist (call=<value optimized out>,
>>    op=<value optimized out>, args=0x1e18238, rho=<value optimized out>)
>>    at builtin.c:645
>> #4  0x000000000054697a in Rf_eval (e=0x10685a0, rho=0x1c557e0) at 
>> eval.c:492
>> #5  0x000000000054a7ef in do_set (call=0x10684f8, op=0x936188, 
>> args=0x1068530,
>>    rho=0x1c557e0) at eval.c:1424
>> #6  0x0000000000546896 in Rf_eval (e=0x10684f8, rho=0x1c557e0) at 
>> eval.c:463
>> #7  0x00000000005474c0 in do_begin (call=0x1089ab0, op=0x936ef8,
>>    args=0x10684c0, rho=0x1c557e0) at eval.c:1176
>> #8  0x0000000000546896 in Rf_eval (e=0x1089ab0, rho=0x1c557e0) at 
>> eval.c:463
>> #9  0x0000000000546896 in Rf_eval (e=0x1089960, rho=0x1c557e0) at 
>> eval.c:463
>> #10 0x00000000005474c0 in do_begin (call=0x10fa1c0, op=0x936ef8,
>>    args=0x10898f0, rho=0x1c557e0) at eval.c:1176
>> #11 0x0000000000546896 in Rf_eval (e=0x10fa1c0, rho=0x1c557e0) at 
>> eval.c:463
>> #12 0x0000000000548a4c in Rf_applyClosure (call=0x13714e8, op=0x10fa4e8,
>>    arglist=0x1c551c0, rho=0x1e06538, suppliedenv=0x959c50) at eval.c:669
>> #13 0x00000000005467b8 in Rf_eval (e=0x13714e8, rho=0x1e06538) at 
>> eval.c:507
>> #14 0x000000000054a7ef in do_set (call=0x1371440, op=0x936188, 
>> args=0x1371478,
>>    rho=0x1e06538) at eval.c:1424
>> #15 0x0000000000546896 in Rf_eval (e=0x1371440, rho=0x1e06538) at 
>> eval.c:463
>> #16 0x00000000005474c0 in do_begin (call=0x137e938, op=0x936ef8,
>>    args=0x1371408, rho=0x1e06538) at eval.c:1176
>> #17 0x0000000000546896 in Rf_eval (e=0x137e938, rho=0x1e06538) at 
>> eval.c:463
>> #18 0x0000000000548a4c in Rf_applyClosure (call=0x1e05ff8, op=0x137ef08,
>>    arglist=0x1e060a0, rho=0x959c18, suppliedenv=0x959c50) at eval.c:669
>> #19 0x00000000005467b8 in Rf_eval (e=0x1e05ff8, rho=0x959c18) at 
>> eval.c:507
>> #20 0x0000000000416b95 in Rf_ReplIteration (rho=0x959c18, savestack=0,
>>    browselevel=0, state=0x7fffca277fa0) at main.c:257
>> #21 0x0000000000416e60 in R_ReplConsole (rho=0x959c18, savestack=0,
>>    browselevel=0) at main.c:306
>> #22 0x0000000000417140 in run_Rmainloop () at main.c:967
>> #23 0x0000000000414c08 in main (ac=<value optimized out>,
>>    av=<value optimized out>) at Rmain.c:35
>> #24 0x00007f10c116a1c4 in __libc_start_main () from /lib/libc.so.6
>> #25 0x0000000000414b29 in _start ()
>>
>> -- 
>> G?ran Brostr?m               phone: 46 90 786 5223; 46 705 197 507
>> Department of Statistics     fax: 46 90 786 6614
>> Ume? University              email: gb at stat.umu.se
>> SE-90187 Ume?, Sweden        
>> http://www.stat.umu.se/personal/goran.brostrom
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 

-- 
G?ran Brostr?m               phone: 46 90 786 5223; 46 705 197 507
Department of Statistics     fax: 46 90 786 6614
Ume? University              email: gb at stat.umu.se
SE-90187 Ume?, Sweden        http://www.stat.umu.se/personal/goran.brostrom


From ripley at stats.ox.ac.uk  Fri Oct  3 13:02:39 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 3 Oct 2008 12:02:39 +0100 (BST)
Subject: [Rd] A strange behaviour of file.path in Windows? (PR#13119)
In-Reply-To: <20081003080506.4D9A52834611@mail.pubhealth.ku.dk>
References: <20081003080506.4D9A52834611@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810031046390.11618@auk.stats.ox.ac.uk>

On Fri, 3 Oct 2008, pego.enrico at tiscali.it wrote:

> Full_Name: Enrico Pegoraro
> Version: 2.7.2
> OS: Windows (Vista or Xp PRO) Italian
> Submission from: (NULL) (87.4.189.202)
>
>
> If you send these lines of code:
>
> outdir="c:/pippo"
> file.path(outdir,"pluto.html")
>
> R replies correctly:
>
> [1] "c:/pippo/pluto.html"
>
> But if you change the first steps to:
>
> outdir=""
> file.path(outdir,"pluto.html")
>
> R replies (uncorrectly, I think)

> [1] "/c:/pippo/pluto.html"

Not for me!  I get

> outdir=""
> file.path(outdir,"pluto.html")
[1] "/pluto.html"

which is as documented, hence correct.  Furthermore, the code cannot 
possibly give your answer unless 'c:/pippo' has some special status on 
your system, and you haven't told us anything about that.

If you do

file.path("", "c:/pippo", "pluto.html")

you get what you indicate, but that is user error (an empty server/share 
specification).

>
> This problem influence the R2HTML package too, which, if you send a line as:
>
> targetHtml=HTMLInitFile(outdir="",filename="htmlFile",Title ="Title")
>
> in windows it submit an error because of file.path() error.

It will affect any such misuse of file.path, of course.  It really is not 
a good idea to use empty file path elements, especially on Windows[*]. 
If you mean the current directory, use ".".

[*] On Unix // is equivalent to /.  On Windows \\ or // may have a special 
meaning (a share) or be regarded as invalid.  A trailing  / or \ can be 
disastrous.

> Thank you
> Enrico


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ligges at statistik.tu-dortmund.de  Fri Oct  3 14:00:06 2008
From: ligges at statistik.tu-dortmund.de (ligges at statistik.tu-dortmund.de)
Date: Fri,  3 Oct 2008 14:00:06 +0200 (CEST)
Subject: [Rd] metafiles under windows (PR#13116)
Message-ID: <20081003120006.BAF2D282C761@mail.pubhealth.ku.dk>

Probably not a bug, not tested on a recent version of R, no reproducible 
code given, hence no chance for us to identify any problem.
If you have questions, please use R-help *after* reading its posting guide.

Best,
Uwe Ligges



david.stevens at stat.math.ethz.ch wrote:
> Full_Name: David Stevens
> Version: 2.7.0
> OS: Window SP
> Submission from: (NULL) (129.123.9.110)
> 
> 
> Lately I've been copying graphics to a metafile to paste to a document. No
> matter what the graphics window size, the pasted graphic only fills the upper
> left 1/3 of the allocated space. How can I make it fill the space
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From h.wickham at gmail.com  Fri Oct  3 16:14:20 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Fri, 3 Oct 2008 09:14:20 -0500
Subject: [Rd] R CMD install runs out of memory
Message-ID: <f8e6ff050810030714md269f1do51a87068bcaacee8@mail.gmail.com>

$ R CMD install ggplot2
...
  scale-usage-d1                    text    html    latex
  scale_brewer                      text    html    latex   example
perl(90227) malloc: *** mmap(size=314880000) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
Out of memory!
ERROR: building help failed for package 'ggplot2'

Any ideas?  That particular file is
http://github.com/hadley/ggplot2/tree/master/man/scale_brewer.rd, but
I can't see any reason it would be causing problems.  The whole
package is available at http://github.com/hadley/ggplot2/

Hadley

-- 
http://had.co.nz/


From murdoch at stats.uwo.ca  Fri Oct  3 16:32:10 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 03 Oct 2008 10:32:10 -0400
Subject: [Rd] R CMD install runs out of memory
In-Reply-To: <f8e6ff050810030714md269f1do51a87068bcaacee8@mail.gmail.com>
References: <f8e6ff050810030714md269f1do51a87068bcaacee8@mail.gmail.com>
Message-ID: <48E62CEA.4030907@stats.uwo.ca>

On 10/3/2008 10:14 AM, hadley wickham wrote:
> $ R CMD install ggplot2
> ...
>   scale-usage-d1                    text    html    latex
>   scale_brewer                      text    html    latex   example
> perl(90227) malloc: *** mmap(size=314880000) failed (error code=12)
> *** error: can't allocate region
> *** set a breakpoint in malloc_error_break to debug
> Out of memory!
> ERROR: building help failed for package 'ggplot2'
> 
> Any ideas?  That particular file is
> http://github.com/hadley/ggplot2/tree/master/man/scale_brewer.rd, but
> I can't see any reason it would be causing problems.  The whole
> package is available at http://github.com/hadley/ggplot2/
> 
> Hadley
> 

What OS is this, what Perl?

Duncan Murdoch


From ggrothendieck at gmail.com  Fri Oct  3 17:08:52 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 3 Oct 2008 11:08:52 -0400
Subject: [Rd] Attributes of top level environments clobbered (was Re: [R]
	possible bug in function 'var' in R 2.7.2?)
Message-ID: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com>

On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> a much better (and much less error-prone) idea would be to install
> R 2.8.0 alpha  even now.
> It will become 'beta' early next week.
>
> We are asking the R community to please install and use
> pre-release versions of R  (if you can / are allowed to)
> at least from beta onwards, and report problems you see early on
> *before* the final release.

The bug discussed in the following year-old post suggested that
the problem of clobbering attributes of top level environment objects
would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"

   https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html

The Avoiding R Bugs section of this page:

   http://r-proto.googlecode.com

has more discussion as well as a list of some other R bugs.

This can be tested by creating a package with these two files only:

---DESCRIPTION---
Package: testlazy
Version: 1.0-0
Date: 2008-10-03
Title: Test lazy loading
Author: G Grothendieck
Maintainer: G Grothendieck <ggrothendieck at gmail.com>
Description: Test lazy loading with top level objects.
Depends: proto
LazyLoad: yes
License: GPL-2
---R/testlazy.R---
TopLevel <- proto()
---

And then testing it:

library(testlazy)
class(TopLevel)

If its class is "environment" only then the class attribute was stripped.


From ligges at statistik.tu-dortmund.de  Fri Oct  3 17:12:39 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 03 Oct 2008 17:12:39 +0200
Subject: [Rd] R CMD install runs out of memory
In-Reply-To: <48E62CEA.4030907@stats.uwo.ca>
References: <f8e6ff050810030714md269f1do51a87068bcaacee8@mail.gmail.com>
	<48E62CEA.4030907@stats.uwo.ca>
Message-ID: <48E63667.3000008@statistik.tu-dortmund.de>



Duncan Murdoch wrote:
> On 10/3/2008 10:14 AM, hadley wickham wrote:
>> $ R CMD install ggplot2
>> ...
>>   scale-usage-d1                    text    html    latex
>>   scale_brewer                      text    html    latex   example
>> perl(90227) malloc: *** mmap(size=314880000) failed (error code=12)
>> *** error: can't allocate region
>> *** set a breakpoint in malloc_error_break to debug
>> Out of memory!
>> ERROR: building help failed for package 'ggplot2'
>>
>> Any ideas?  That particular file is
>> http://github.com/hadley/ggplot2/tree/master/man/scale_brewer.rd, but
>> I can't see any reason it would be causing problems.  The whole
>> package is available at http://github.com/hadley/ggplot2/
>>
>> Hadley
>>
> 
> What OS is this, what Perl?

Arbitrary.

Problem is that Hadley uses

  \code{\link{\code{\link{....}}}}

in files scale_continuous.rd and scale_date.rd

Hadley,  the line
    scale_brewer                      text    html    latex   example
shows that help for scale_brewer has been build already.

Best wishes,
Uwe


> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From luke at stat.uiowa.edu  Fri Oct  3 17:43:07 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 3 Oct 2008 10:43:07 -0500 (CDT)
Subject: [Rd] Attributes of top level environments clobbered (was Re:
 [R]	possible bug in function 'var' in R 2.7.2?)
In-Reply-To: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com>
References: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0810031033300.21595@nokomis.stat.uiowa.edu>

I will look into fixing it sometime if no one else feels like doing
it.  The environment aspect is not high priority; some other related
issues are more so (locking and active bindings as I recall).  But
even thoughs may not make it to the top of my queue any time soon.

The issue of placing attributes on environments has come up before,
many times.  It is routinely advised against.  For better or worse,
the way environments were exposed to the R level is not designed to
support this properly.  Fixing this so that attributes are supported
reliably is non-trivial, and it is hard to justify the effort given
that there are standard work-arounds (such as putting the environment
in a list and attaching attributes to the list).  An alternative way
of removing the issues associated with attributes on environments, in
line with the way NULL works, is to disable placing attributes on
environments, at least from the R level.  This option is looking
increasingly attractive.

luke

On Fri, 3 Oct 2008, Gabor Grothendieck wrote:

> On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
>> a much better (and much less error-prone) idea would be to install
>> R 2.8.0 alpha  even now.
>> It will become 'beta' early next week.
>>
>> We are asking the R community to please install and use
>> pre-release versions of R  (if you can / are allowed to)
>> at least from beta onwards, and report problems you see early on
>> *before* the final release.
>
> The bug discussed in the following year-old post suggested that
> the problem of clobbering attributes of top level environment objects
> would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
> and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"
>
>   https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html
>
> The Avoiding R Bugs section of this page:
>
>   http://r-proto.googlecode.com
>
> has more discussion as well as a list of some other R bugs.
>
> This can be tested by creating a package with these two files only:
>
> ---DESCRIPTION---
> Package: testlazy
> Version: 1.0-0
> Date: 2008-10-03
> Title: Test lazy loading
> Author: G Grothendieck
> Maintainer: G Grothendieck <ggrothendieck at gmail.com>
> Description: Test lazy loading with top level objects.
> Depends: proto
> LazyLoad: yes
> License: GPL-2
> ---R/testlazy.R---
> TopLevel <- proto()
> ---
>
> And then testing it:
>
> library(testlazy)
> class(TopLevel)
>
> If its class is "environment" only then the class attribute was stripped.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From h.wickham at gmail.com  Fri Oct  3 17:59:51 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Fri, 3 Oct 2008 10:59:51 -0500
Subject: [Rd] R CMD install runs out of memory
In-Reply-To: <48E63667.3000008@statistik.tu-dortmund.de>
References: <f8e6ff050810030714md269f1do51a87068bcaacee8@mail.gmail.com>
	<48E62CEA.4030907@stats.uwo.ca>
	<48E63667.3000008@statistik.tu-dortmund.de>
Message-ID: <f8e6ff050810030859y3f69ab0am625827c09d729a5@mail.gmail.com>

On Fri, Oct 3, 2008 at 10:12 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> Duncan Murdoch wrote:
>>
>> On 10/3/2008 10:14 AM, hadley wickham wrote:
>>>
>>> $ R CMD install ggplot2
>>> ...
>>>  scale-usage-d1                    text    html    latex
>>>  scale_brewer                      text    html    latex   example
>>> perl(90227) malloc: *** mmap(size=314880000) failed (error code=12)
>>> *** error: can't allocate region
>>> *** set a breakpoint in malloc_error_break to debug
>>> Out of memory!
>>> ERROR: building help failed for package 'ggplot2'
>>>
>>> Any ideas?  That particular file is
>>> http://github.com/hadley/ggplot2/tree/master/man/scale_brewer.rd, but
>>> I can't see any reason it would be causing problems.  The whole
>>> package is available at http://github.com/hadley/ggplot2/
>>>
>>> Hadley
>>>
>>
>> What OS is this, what Perl?
>
> Arbitrary.
>
> Problem is that Hadley uses
>
>  \code{\link{\code{\link{....}}}}
>
> in files scale_continuous.rd and scale_date.rd

Ooops!  Thanks for figuring that out.

Hadley

-- 
http://had.co.nz/


From simon.urbanek at r-project.org  Fri Oct  3 18:34:04 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 3 Oct 2008 12:34:04 -0400
Subject: [Rd] quartz device (PR#13115)
In-Reply-To: <20081002184510.BD5A0282C770@mail.pubhealth.ku.dk>
References: <20081002184510.BD5A0282C770@mail.pubhealth.ku.dk>
Message-ID: <86E4C07E-72EF-4901-AE25-E9BE81D0B782@r-project.org>


On Oct 2, 2008, at 14:45 , vdewit at ulg.ac.be wrote:

> Dear,
>
> The quartz device doesn't work in R version 2.7.2 (2008-08-25), on my
> MacBook Pro. For example, when I just type 'demo(graphics)', the  
> quartz
> window stays empty and the clockwise time indicator keeps on running  
> in
> the R window.
>
> What should I do to fix this bug?
>

First please follow the guidelines and report the issue properly  
including at the very least the output of sessionInfo() as well as the  
exactly way you run R (R.app GUI, Terminal, xterm, ...). Also note  
that demo(graphics) doesn't produce any output until you press <Enter>  
on the console. Start with a simple example like "plot(1:10)" to  
verify that there is really an issue with Quartz.

Thanks,
Simon


From ggrothendieck at gmail.com  Fri Oct  3 18:39:42 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 3 Oct 2008 12:39:42 -0400
Subject: [Rd] Attributes of top level environments clobbered (was Re:
	[R] possible bug in function 'var' in R 2.7.2?)
In-Reply-To: <alpine.LFD.2.00.0810031033300.21595@nokomis.stat.uiowa.edu>
References: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com>
	<alpine.LFD.2.00.0810031033300.21595@nokomis.stat.uiowa.edu>
Message-ID: <971536df0810030939r275f58b3s1764ac41d6b5e519@mail.gmail.com>

On Fri, Oct 3, 2008 at 11:43 AM, Luke Tierney <luke at stat.uiowa.edu> wrote:
> I will look into fixing it sometime if no one else feels like doing
> it.  The environment aspect is not high priority; some other related
> issues are more so (locking and active bindings as I recall).  But
> even thoughs may not make it to the top of my queue any time soon.
>
> The issue of placing attributes on environments has come up before,
> many times.  It is routinely advised against.  For better or worse,
> the way environments were exposed to the R level is not designed to
> support this properly.  Fixing this so that attributes are supported
> reliably is non-trivial, and it is hard to justify the effort given
> that there are standard work-arounds (such as putting the environment
> in a list and attaching attributes to the list).  An alternative way
> of removing the issues associated with attributes on environments, in
> line with the way NULL works, is to disable placing attributes on
> environments, at least from the R level.  This option is looking
> increasingly attractive.

These are not good options:

- the workaround does not allow one to inherit methods.  This
implies tediously rewriting or writing wrappers every inherited method
in any such subclass.  Its really tantamount to eliminating OO for
environments which is not a reasonable solution for a language that
is supposed to be OO.

- eliminating attributes on environments is even worse since widely
used packages such as proto, ggplot2 and other packages would suffer.
Maintaining reasonable compatiblity should be a goal of the core
development.  It would be better to document the current situation than
to make such a retrograde change.

- if time is a problem perhaps the core group needs to add resources
to reasonably address the problems in R.  Traditional economics
do not apply to an open source project.  There is no monetary cost to
adding additional developers.

>
> luke
>
> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>
>> On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
>> <maechler at stat.math.ethz.ch> wrote:
>>>
>>> a much better (and much less error-prone) idea would be to install
>>> R 2.8.0 alpha  even now.
>>> It will become 'beta' early next week.
>>>
>>> We are asking the R community to please install and use
>>> pre-release versions of R  (if you can / are allowed to)
>>> at least from beta onwards, and report problems you see early on
>>> *before* the final release.
>>
>> The bug discussed in the following year-old post suggested that
>> the problem of clobbering attributes of top level environment objects
>> would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
>> and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"
>>
>>  https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html
>>
>> The Avoiding R Bugs section of this page:
>>
>>  http://r-proto.googlecode.com
>>
>> has more discussion as well as a list of some other R bugs.
>>
>> This can be tested by creating a package with these two files only:
>>
>> ---DESCRIPTION---
>> Package: testlazy
>> Version: 1.0-0
>> Date: 2008-10-03
>> Title: Test lazy loading
>> Author: G Grothendieck
>> Maintainer: G Grothendieck <ggrothendieck at gmail.com>
>> Description: Test lazy loading with top level objects.
>> Depends: proto
>> LazyLoad: yes
>> License: GPL-2
>> ---R/testlazy.R---
>> TopLevel <- proto()
>> ---
>>
>> And then testing it:
>>
>> library(testlazy)
>> class(TopLevel)
>>
>> If its class is "environment" only then the class attribute was stripped.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Luke Tierney
> Chair, Statistics and Actuarial Science
> Ralph E. Wareham Professor of Mathematical Sciences
> University of Iowa                  Phone:             319-335-3386
> Department of Statistics and        Fax:               319-335-3017
>   Actuarial Science
> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>


From luke at stat.uiowa.edu  Fri Oct  3 18:46:35 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 3 Oct 2008 11:46:35 -0500 (CDT)
Subject: [Rd] Attributes of top level environments clobbered (was Re:
 [R] possible bug in function 'var' in R 2.7.2?)
In-Reply-To: <971536df0810030939r275f58b3s1764ac41d6b5e519@mail.gmail.com>
References: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com>
	<alpine.LFD.2.00.0810031033300.21595@nokomis.stat.uiowa.edu>
	<971536df0810030939r275f58b3s1764ac41d6b5e519@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0810031141310.21595@nokomis.stat.uiowa.edu>

On Fri, 3 Oct 2008, Gabor Grothendieck wrote:

> On Fri, Oct 3, 2008 at 11:43 AM, Luke Tierney <luke at stat.uiowa.edu> wrote:
>> I will look into fixing it sometime if no one else feels like doing
>> it.  The environment aspect is not high priority; some other related
>> issues are more so (locking and active bindings as I recall).  But
>> even thoughs may not make it to the top of my queue any time soon.
>>
>> The issue of placing attributes on environments has come up before,
>> many times.  It is routinely advised against.  For better or worse,
>> the way environments were exposed to the R level is not designed to
>> support this properly.  Fixing this so that attributes are supported
>> reliably is non-trivial, and it is hard to justify the effort given
>> that there are standard work-arounds (such as putting the environment
>> in a list and attaching attributes to the list).  An alternative way
>> of removing the issues associated with attributes on environments, in
>> line with the way NULL works, is to disable placing attributes on
>> environments, at least from the R level.  This option is looking
>> increasingly attractive.
>
> These are not good options:
>
> - the workaround does not allow one to inherit methods.  This
> implies tediously rewriting or writing wrappers every inherited method
> in any such subclass.  Its really tantamount to eliminating OO for
> environments which is not a reasonable solution for a language that
> is supposed to be OO.

It would mean sealing environments, making them final, pick your
favorite OO terminology.  Standard thing to do in many OO languages
when it is wararanted.

> - eliminating attributes on environments is even worse since widely
> used packages such as proto, ggplot2 and other packages would suffer.
> Maintaining reasonable compatiblity should be a goal of the core
> development.  It would be better to document the current situation than
> to make such a retrograde change.

The authors of proto would finally need to bite the bullet and address
this issue.  This would make proto more reliable in the end.

luke

> - if time is a problem perhaps the core group needs to add resources
> to reasonably address the problems in R.  Traditional economics
> do not apply to an open source project.  There is no monetary cost to
> adding additional developers.
>>
>> luke
>>
>> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>>
>>> On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
>>> <maechler at stat.math.ethz.ch> wrote:
>>>>
>>>> a much better (and much less error-prone) idea would be to install
>>>> R 2.8.0 alpha  even now.
>>>> It will become 'beta' early next week.
>>>>
>>>> We are asking the R community to please install and use
>>>> pre-release versions of R  (if you can / are allowed to)
>>>> at least from beta onwards, and report problems you see early on
>>>> *before* the final release.
>>>
>>> The bug discussed in the following year-old post suggested that
>>> the problem of clobbering attributes of top level environment objects
>>> would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
>>> and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"
>>>
>>>  https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html
>>>
>>> The Avoiding R Bugs section of this page:
>>>
>>>  http://r-proto.googlecode.com
>>>
>>> has more discussion as well as a list of some other R bugs.
>>>
>>> This can be tested by creating a package with these two files only:
>>>
>>> ---DESCRIPTION---
>>> Package: testlazy
>>> Version: 1.0-0
>>> Date: 2008-10-03
>>> Title: Test lazy loading
>>> Author: G Grothendieck
>>> Maintainer: G Grothendieck <ggrothendieck at gmail.com>
>>> Description: Test lazy loading with top level objects.
>>> Depends: proto
>>> LazyLoad: yes
>>> License: GPL-2
>>> ---R/testlazy.R---
>>> TopLevel <- proto()
>>> ---
>>>
>>> And then testing it:
>>>
>>> library(testlazy)
>>> class(TopLevel)
>>>
>>> If its class is "environment" only then the class attribute was stripped.
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Luke Tierney
>> Chair, Statistics and Actuarial Science
>> Ralph E. Wareham Professor of Mathematical Sciences
>> University of Iowa                  Phone:             319-335-3386
>> Department of Statistics and        Fax:               319-335-3017
>>   Actuarial Science
>> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>>
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From ggrothendieck at gmail.com  Fri Oct  3 19:25:50 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 3 Oct 2008 13:25:50 -0400
Subject: [Rd] Attributes of top level environments clobbered (was Re:
	[R] possible bug in function 'var' in R 2.7.2?)
In-Reply-To: <alpine.LFD.2.00.0810031141310.21595@nokomis.stat.uiowa.edu>
References: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com>
	<alpine.LFD.2.00.0810031033300.21595@nokomis.stat.uiowa.edu>
	<971536df0810030939r275f58b3s1764ac41d6b5e519@mail.gmail.com>
	<alpine.LFD.2.00.0810031141310.21595@nokomis.stat.uiowa.edu>
Message-ID: <971536df0810031025n119368fet471d1932ae22f72@mail.gmail.com>

On Fri, Oct 3, 2008 at 12:46 PM, Luke Tierney <luke at stat.uiowa.edu> wrote:
> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>
>> On Fri, Oct 3, 2008 at 11:43 AM, Luke Tierney <luke at stat.uiowa.edu> wrote:
>>>
>>> I will look into fixing it sometime if no one else feels like doing
>>> it.  The environment aspect is not high priority; some other related
>>> issues are more so (locking and active bindings as I recall).  But
>>> even thoughs may not make it to the top of my queue any time soon.
>>>
>>> The issue of placing attributes on environments has come up before,
>>> many times.  It is routinely advised against.  For better or worse,
>>> the way environments were exposed to the R level is not designed to
>>> support this properly.  Fixing this so that attributes are supported
>>> reliably is non-trivial, and it is hard to justify the effort given
>>> that there are standard work-arounds (such as putting the environment
>>> in a list and attaching attributes to the list).  An alternative way
>>> of removing the issues associated with attributes on environments, in
>>> line with the way NULL works, is to disable placing attributes on
>>> environments, at least from the R level.  This option is looking
>>> increasingly attractive.
>>
>> These are not good options:
>>
>> - the workaround does not allow one to inherit methods.  This
>> implies tediously rewriting or writing wrappers every inherited method
>> in any such subclass.  Its really tantamount to eliminating OO for
>> environments which is not a reasonable solution for a language that
>> is supposed to be OO.
>
> It would mean sealing environments, making them final, pick your
> favorite OO terminology.  Standard thing to do in many OO languages
> when it is wararanted.

I don't think this really addresses the problem.  The S3 model is
in principle capable of handling environments and almost does
so fully now.

>
>> - eliminating attributes on environments is even worse since widely
>> used packages such as proto, ggplot2 and other packages would suffer.
>> Maintaining reasonable compatiblity should be a goal of the core
>> development.  It would be better to document the current situation than
>> to make such a retrograde change.
>
> The authors of proto would finally need to bite the bullet and address
> this issue.  This would make proto more reliable in the end.

The fact that environment attributes get clobbered at top level
when defined in packages with lazy loading (but not outside packages
nor in packages without lazy loading) is clearly a deficiency of R,
not proto.

Furthermore, the suggstion that this deficiency in R somehow reflects
any unreliably in proto is likewise not accurate.  proto is extremely
reliable, particularly in
comparison to R.  In fact there are no known bugs in the development
version of proto and large widely used packages use proto.  (If you are aware
of any bugs let me know.) The fact that it is so solid is quite
understandable because
even if some of its code is necessarily complex the code is so short that its
readily possible to accomplish this apprent bug-free status with reasonble
effort.  Furthermore, the proto home page documents the problems -- mostly
problems with R itself, not proto.

I do appreciate the excellent R software; however, there are a few points like
those addressed on the proto home page which do need to be addressed in R
for it to be fully functional.

>
> luke
>
>> - if time is a problem perhaps the core group needs to add resources
>> to reasonably address the problems in R.  Traditional economics
>> do not apply to an open source project.  There is no monetary cost to
>> adding additional developers.
>>>
>>> luke
>>>
>>> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>>>
>>>> On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
>>>> <maechler at stat.math.ethz.ch> wrote:
>>>>>
>>>>> a much better (and much less error-prone) idea would be to install
>>>>> R 2.8.0 alpha  even now.
>>>>> It will become 'beta' early next week.
>>>>>
>>>>> We are asking the R community to please install and use
>>>>> pre-release versions of R  (if you can / are allowed to)
>>>>> at least from beta onwards, and report problems you see early on
>>>>> *before* the final release.
>>>>
>>>> The bug discussed in the following year-old post suggested that
>>>> the problem of clobbering attributes of top level environment objects
>>>> would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
>>>> and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"
>>>>
>>>>  https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html
>>>>
>>>> The Avoiding R Bugs section of this page:
>>>>
>>>>  http://r-proto.googlecode.com
>>>>
>>>> has more discussion as well as a list of some other R bugs.
>>>>
>>>> This can be tested by creating a package with these two files only:
>>>>
>>>> ---DESCRIPTION---
>>>> Package: testlazy
>>>> Version: 1.0-0
>>>> Date: 2008-10-03
>>>> Title: Test lazy loading
>>>> Author: G Grothendieck
>>>> Maintainer: G Grothendieck <ggrothendieck at gmail.com>
>>>> Description: Test lazy loading with top level objects.
>>>> Depends: proto
>>>> LazyLoad: yes
>>>> License: GPL-2
>>>> ---R/testlazy.R---
>>>> TopLevel <- proto()
>>>> ---
>>>>
>>>> And then testing it:
>>>>
>>>> library(testlazy)
>>>> class(TopLevel)
>>>>
>>>> If its class is "environment" only then the class attribute was
>>>> stripped.
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Luke Tierney
>>> Chair, Statistics and Actuarial Science
>>> Ralph E. Wareham Professor of Mathematical Sciences
>>> University of Iowa                  Phone:             319-335-3386
>>> Department of Statistics and        Fax:               319-335-3017
>>>  Actuarial Science
>>> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>>> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>>>
>>
>
> --
> Luke Tierney
> Chair, Statistics and Actuarial Science
> Ralph E. Wareham Professor of Mathematical Sciences
> University of Iowa                  Phone:             319-335-3386
> Department of Statistics and        Fax:               319-335-3017
>   Actuarial Science
> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>


From wdunlap at tibco.com  Fri Oct  3 20:01:11 2008
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 3 Oct 2008 11:01:11 -0700
Subject: [Rd] Can DESCRIPTION Maintainer: field contain general URL instead
	of only email address?
Message-ID: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>

Our firm would like to route support requests through
a website instead of using email.  However R will refuse
to install a package if DESCRIPTION's Maintainer field
does not have a valid email adress or the special value
"ORPHANED".  (The check is done with
tools:::.valid_maintainer_field_regexp.)

I imagine a typical Maintainer line for the package "foo"
might be something like
   Maintainer: Amalgamated Widget's Support Team
<http://support.amalgamatedwidgets.com/spackage?name=foo>

How much does the package system (or CRAN) depend on
the Maintainer field being an email address?  I can imagine
programs would find mailing to an address easier than
dealing with a website, but humans would have a better experience
with a well designed website.  Perhaps we could add an optional
%s field to the website so a program could post a small message.

Bill Dunlap
TIBCO Spotfire Inc.
wdunlap tibco.com 


From dutangc at gmail.com  Fri Oct  3 20:13:23 2008
From: dutangc at gmail.com (christophe dutang)
Date: Fri, 3 Oct 2008 20:13:23 +0200
Subject: [Rd] Can DESCRIPTION Maintainer: field contain general URL
	instead of only email address?
In-Reply-To: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>
References: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>
Message-ID: <c8e8cd3d0810031113t3116a1f4mfb9880c036d9b1c9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081003/f5320d13/attachment.pl>

From ligges at statistik.tu-dortmund.de  Fri Oct  3 20:32:59 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 03 Oct 2008 20:32:59 +0200
Subject: [Rd] Can DESCRIPTION Maintainer: field contain general URL
 instead of only email address?
In-Reply-To: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>
References: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>
Message-ID: <48E6655B.7040708@statistik.tu-dortmund.de>



William Dunlap wrote:
> Our firm would like to route support requests through
> a website instead of using email.  However R will refuse
> to install a package if DESCRIPTION's Maintainer field
> does not have a valid email adress or the special value
> "ORPHANED".  (The check is done with
> tools:::.valid_maintainer_field_regexp.)
> 
> I imagine a typical Maintainer line for the package "foo"
> might be something like
>    Maintainer: Amalgamated Widget's Support Team
> <http://support.amalgamatedwidgets.com/spackage?name=foo>
> 
> How much does the package system (or CRAN) depend on
> the Maintainer field being an email address?  I can imagine
> programs would find mailing to an address easier than
> dealing with a website, but humans would have a better experience
> with a well designed website.  Perhaps we could add an optional
> %s field to the website so a program could post a small message.

Bill,

as already pointed out by Christophe Dutang, there is the URL field.

CRAN maintainers rely on the e-mail address given in the package's 
Maintainer field, particularly to notify (partly automatically like I 
do) package maintainers if there packages are broken in a new version of 
R or because the packages they depend on changed.

Best wishes,
Uwe


> Bill Dunlap
> TIBCO Spotfire Inc.
> wdunlap tibco.com 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From luke at stat.uiowa.edu  Fri Oct  3 22:35:18 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 3 Oct 2008 15:35:18 -0500 (CDT)
Subject: [Rd] Attributes of top level environments clobbered (was Re:
 [R] possible bug in function 'var' in R 2.7.2?)
In-Reply-To: <971536df0810031025n119368fet471d1932ae22f72@mail.gmail.com>
References: <971536df0810030808p5be50430sd07d0825ee422f62@mail.gmail.com> 
	<alpine.LFD.2.00.0810031033300.21595@nokomis.stat.uiowa.edu> 
	<971536df0810030939r275f58b3s1764ac41d6b5e519@mail.gmail.com> 
	<alpine.LFD.2.00.0810031141310.21595@nokomis.stat.uiowa.edu>
	<971536df0810031025n119368fet471d1932ae22f72@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810031433350.14866@itasca2.wildberry.org>

On Fri, 3 Oct 2008, Gabor Grothendieck wrote:

> On Fri, Oct 3, 2008 at 12:46 PM, Luke Tierney <luke at stat.uiowa.edu> wrote:
>> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>>
>>> On Fri, Oct 3, 2008 at 11:43 AM, Luke Tierney <luke at stat.uiowa.edu> wrote:
>>>>
>>>> I will look into fixing it sometime if no one else feels like doing
>>>> it.  The environment aspect is not high priority; some other related
>>>> issues are more so (locking and active bindings as I recall).  But
>>>> even thoughs may not make it to the top of my queue any time soon.
>>>>
>>>> The issue of placing attributes on environments has come up before,
>>>> many times.  It is routinely advised against.  For better or worse,
>>>> the way environments were exposed to the R level is not designed to
>>>> support this properly.  Fixing this so that attributes are supported
>>>> reliably is non-trivial, and it is hard to justify the effort given
>>>> that there are standard work-arounds (such as putting the environment
>>>> in a list and attaching attributes to the list).  An alternative way
>>>> of removing the issues associated with attributes on environments, in
>>>> line with the way NULL works, is to disable placing attributes on
>>>> environments, at least from the R level.  This option is looking
>>>> increasingly attractive.
>>>
>>> These are not good options:
>>>
>>> - the workaround does not allow one to inherit methods.  This
>>> implies tediously rewriting or writing wrappers every inherited method
>>> in any such subclass.  Its really tantamount to eliminating OO for
>>> environments which is not a reasonable solution for a language that
>>> is supposed to be OO.
>>
>> It would mean sealing environments, making them final, pick your
>> favorite OO terminology.  Standard thing to do in many OO languages
>> when it is wararanted.
>
> I don't think this really addresses the problem.  The S3 model is
> in principle capable of handling environments and almost does
> so fully now.

Depends on your definitions.  Dispatch may work, but for me the show
stopper is unclass and related things.  Use of unclass inside code is
a fairly common idiom, and whenever an environment with a class gets
into a function that does an unclass on it, the environment ceases to
have a class.  You can argue that this should not be so but it is so,
it has been so for a long time, and it is lileky to remain so for a
long time.  To me this means that putting classes on environments is
too brittle to use in production code.  For this reason I would not use
a package that relies on doing this and would not encourage anyone
else to at this point.  I like prototype based OO, expecially for
graphics, which is why I wrote such a system for Lisp-Stat many years
ago. But using a variant of such a system in which the class can so
easily disappear seems ill-advised to me.

>>> - eliminating attributes on environments is even worse since widely
>>> used packages such as proto, ggplot2 and other packages would suffer.
>>> Maintaining reasonable compatiblity should be a goal of the core
>>> development.  It would be better to document the current situation than
>>> to make such a retrograde change.

While these packages may be widely used their authors have disregarded
repeated advice on this.  Inheritance just does not work reliably for
environments. Encapsulation does work. (One could argue that
encapsulation would be a better choice even if reliable inheritance
was available, but that is a moot point).

>>
>> The authors of proto would finally need to bite the bullet and address
>> this issue.  This would make proto more reliable in the end.
>
> The fact that environment attributes get clobbered at top level
> when defined in packages with lazy loading (but not outside packages
> nor in packages without lazy loading) is clearly a deficiency of R,
> not proto.

There is a bug in lazy loading in that some important features of
environments are not preserved.  Given that attributes on environments
are not reliable however I would argue that the fact that they are not
preserved is not particularly important.  While fixing the more
important bugs it is probably not hard to fix the attribute issue as
well (that is a conditional statement -- fixing the more imortant bugs
is going to be fairly painful, which is why it hasn't happened yet.)
Once that is done, lazy loading may "work" for proto but using
attributes on environments is still a Bad Idea given the way R works.

>
> Furthermore, the suggstion that this deficiency in R somehow reflects
> any unreliably in proto is likewise not accurate.  proto is extremely
> reliable, particularly in
> comparison to R.  In fact there are no known bugs in the development
> version of proto and large widely used packages use proto.  (If you are aware
> of any bugs let me know.) The fact that it is so solid is quite
> understandable because
> even if some of its code is necessarily complex the code is so short that its
> readily possible to accomplish this apprent bug-free status with reasonble
> effort.  Furthermore, the proto home page documents the problems -- mostly
> problems with R itself, not proto.
>
> I do appreciate the excellent R software; however, there are a few points like
> those addressed on the proto home page which do need to be addressed in R
> for it to be fully functional.

There are some interesting poins on that page that are worth looking
into.  Over time I suspect all but the current 3. will be addressed,
but 3., which is a variant on the unclass issue, is not likely to be.
You can call this a deficiency in R if you like, and I would agree in
the sense that I think it is inappropriate to allow attributes to be
set but not in a reliable way because they can be inadvertenly
removed.  We should have done this differently.  THere were/are two
choices:

     Make reference values, including environments, special in that they
     may not have attributes. This woud have been fairly easy (modulo one
     use made in decorating the frames on the search path) and could be
     done now to clean things up.

     Make R-visible environments in two parts--a wrapper that is passed by
     value like standard R objects and could have attributes, and an
     internal part that is essentially the current environment object.
     This is analogous to the way that character vectors, even of length 1,
     consist of an STRSXP wrapper containing CHARSXPs that hold the string.
     The STRSXP's are visible at the R level, the CHARSXPs are not.  This
     would have been messier to implement, and unfortunately would be very
     messy to retro-fit at this point, so it isn't likely to happen unless
     there is some other compelling reason to do so.

The bottom line is that this situation isn't likely to change any time
soon as far as I can see.  If that means that for you R will not be
"fully functional" then so be it.  Attributes on environments are not
reliable and hence it is a Bad Idea to try to use them.  This is a
feature of R as it is now, has been for a while, and will be for a
while. If you write code for language X, you can write it for
X-as-it-s or X-as-you-wish-it-to-be; but if you chose
X-as-you-wish-it-to-be and find things don't work out it's hard to
argue that the fault is with X.

luke

>
>>
>> luke
>>
>>> - if time is a problem perhaps the core group needs to add resources
>>> to reasonably address the problems in R.  Traditional economics
>>> do not apply to an open source project.  There is no monetary cost to
>>> adding additional developers.
>>>>
>>>> luke
>>>>
>>>> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>>>>
>>>>> On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
>>>>> <maechler at stat.math.ethz.ch> wrote:
>>>>>>
>>>>>> a much better (and much less error-prone) idea would be to install
>>>>>> R 2.8.0 alpha  even now.
>>>>>> It will become 'beta' early next week.
>>>>>>
>>>>>> We are asking the R community to please install and use
>>>>>> pre-release versions of R  (if you can / are allowed to)
>>>>>> at least from beta onwards, and report problems you see early on
>>>>>> *before* the final release.
>>>>>
>>>>> The bug discussed in the following year-old post suggested that
>>>>> the problem of clobbering attributes of top level environment objects
>>>>> would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
>>>>> and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"
>>>>>
>>>>>  https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html
>>>>>
>>>>> The Avoiding R Bugs section of this page:
>>>>>
>>>>>  http://r-proto.googlecode.com
>>>>>
>>>>> has more discussion as well as a list of some other R bugs.
>>>>>
>>>>> This can be tested by creating a package with these two files only:
>>>>>
>>>>> ---DESCRIPTION---
>>>>> Package: testlazy
>>>>> Version: 1.0-0
>>>>> Date: 2008-10-03
>>>>> Title: Test lazy loading
>>>>> Author: G Grothendieck
>>>>> Maintainer: G Grothendieck <ggrothendieck at gmail.com>
>>>>> Description: Test lazy loading with top level objects.
>>>>> Depends: proto
>>>>> LazyLoad: yes
>>>>> License: GPL-2
>>>>> ---R/testlazy.R---
>>>>> TopLevel <- proto()
>>>>> ---
>>>>>
>>>>> And then testing it:
>>>>>
>>>>> library(testlazy)
>>>>> class(TopLevel)
>>>>>
>>>>> If its class is "environment" only then the class attribute was
>>>>> stripped.
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>> --
>>>> Luke Tierney
>>>> Chair, Statistics and Actuarial Science
>>>> Ralph E. Wareham Professor of Mathematical Sciences
>>>> University of Iowa                  Phone:             319-335-3386
>>>> Department of Statistics and        Fax:               319-335-3017
>>>>  Actuarial Science
>>>> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>>>> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>>>>
>>>
>>
>> --
>> Luke Tierney
>> Chair, Statistics and Actuarial Science
>> Ralph E. Wareham Professor of Mathematical Sciences
>> University of Iowa                  Phone:             319-335-3386
>> Department of Statistics and        Fax:               319-335-3017
>>   Actuarial Science
>> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>>
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From khansen at stat.berkeley.edu  Fri Oct  3 23:49:17 2008
From: khansen at stat.berkeley.edu (Kasper Daniel Hansen)
Date: Fri, 3 Oct 2008 14:49:17 -0700
Subject: [Rd] Can DESCRIPTION Maintainer: field contain general URL
	instead of only email address?
In-Reply-To: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>
References: <FBFBD35F5823FD4E97ACDEBB353DD9C60CF534@NA-PA-VBE01.na.tibco.com>
Message-ID: <F5426BA5-BBBF-438E-AADC-DA62E2A2918B@stat.berkeley.edu>

Why don't you just give a company email address? Remember this email  
address is to contact the maintainer. Contacting the maintainer is not  
only done in order to request support, it could be a copy right issue,  
code re-use request etc - although I do agree that most emails are  
probably support requests.

Kasper

On Oct 3, 2008, at 11:01 , William Dunlap wrote:

> Our firm would like to route support requests through
> a website instead of using email.  However R will refuse
> to install a package if DESCRIPTION's Maintainer field
> does not have a valid email adress or the special value
> "ORPHANED".  (The check is done with
> tools:::.valid_maintainer_field_regexp.)
>
> I imagine a typical Maintainer line for the package "foo"
> might be something like
>   Maintainer: Amalgamated Widget's Support Team
> <http://support.amalgamatedwidgets.com/spackage?name=foo>
>
> How much does the package system (or CRAN) depend on
> the Maintainer field being an email address?  I can imagine
> programs would find mailing to an address easier than
> dealing with a website, but humans would have a better experience
> with a well designed website.  Perhaps we could add an optional
> %s field to the website so a program could post a small message.
>
> Bill Dunlap
> TIBCO Spotfire Inc.
> wdunlap tibco.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From shantanu9847 at hotmail.com  Sat Oct  4 00:40:35 2008
From: shantanu9847 at hotmail.com (Shantanu Unknown)
Date: Fri, 3 Oct 2008 22:40:35 +0000
Subject: [Rd] Unable to install R on CentOS 64 bit machine
Message-ID: <BAY133-W27E5EFD8BD4F6EE0FCAE05D73C0@phx.gbl>


Hi all,
I am unable to install R on CentOS5 64 bit machine.

When I do ./configure
I get the message

"checking for X... no
configure: error: --with-x=yes (default) and X11 headers/libs are not available"

from doing a websearch it seems I need to install x11-xorg. But I  could not find it when I did a yum install. 

I did  "yum list xorg-x11*" and following is what I get
Could someone tell me which is the missing X11 package I need to install for CentOS5?
Thanks a lot for any help.
Shantanu

Installed Packages
xorg-x11-apps.x86_64                     7.1-4.0.1.el5          installed       
xorg-x11-drivers.x86_64                  7.1-4.1.el5            installed       
xorg-x11-drv-acecad.x86_64               1.1.0-2.1              installed       
xorg-x11-drv-aiptek.x86_64               1.0.1-2                installed       
xorg-x11-drv-ast.x86_64                  0.81.0-3               installed       
xorg-x11-drv-ati.x86_64                  6.6.3-3.13.el5         installed       
xorg-x11-drv-calcomp.x86_64              1.1.0-1.1              installed       
xorg-x11-drv-cirrus.x86_64               1.1.0-2.fc6            installed       
xorg-x11-drv-citron.x86_64               2.2.0-1.1              installed       
xorg-x11-drv-digitaledge.x86_64          1.1.0-1.1              installed       
xorg-x11-drv-dmc.x86_64                  1.1.0-2                installed       
xorg-x11-drv-dummy.x86_64                0.2.0-2.1              installed       
xorg-x11-drv-dynapro.x86_64              1.1.0-2                installed       
xorg-x11-drv-elo2300.x86_64              1.1.0-1.1              installed       
xorg-x11-drv-elographics.x86_64          1.1.0-1.1              installed       
xorg-x11-drv-evdev.x86_64                1:1.0.0.5-3.el5        installed       
xorg-x11-drv-fbdev.x86_64                0.3.0-2                installed       
xorg-x11-drv-fpit.x86_64                 1.1.0-1.1              installed       
xorg-x11-drv-hyperpen.x86_64             1.1.0-2                installed       
xorg-x11-drv-i810.x86_64                 1.6.5-9.13.el5         installed       
xorg-x11-drv-jamstudio.x86_64            1.1.0-1.1              installed       
xorg-x11-drv-joystick.x86_64             1.1.0-1.1              installed       
xorg-x11-drv-keyboard.x86_64             1.1.0-3                installed       
xorg-x11-drv-magellan.x86_64             1.1.0-1.1              installed       
xorg-x11-drv-magictouch.x86_64           1.0.0.5-2.1            installed       
xorg-x11-drv-mga.x86_64                  1.4.2-7.el5            installed       
xorg-x11-drv-microtouch.x86_64           1.1.0-1.1              installed       
xorg-x11-drv-mouse.x86_64                1.1.1-1.1              installed       
xorg-x11-drv-mutouch.x86_64              1.1.0-2                installed       
xorg-x11-drv-nv.x86_64                   2.1.6-6.el5            installed       
xorg-x11-drv-palmax.x86_64               1.1.0-1.1              installed       
xorg-x11-drv-penmount.x86_64             1.1.0-2.1              installed       
xorg-x11-drv-s3.x86_64                   0.4.1-2.1              installed       
xorg-x11-drv-s3virge.x86_64              1.9.1-2.1              installed       
xorg-x11-drv-savage.x86_64               2.1.1-5.fc6            installed       
xorg-x11-drv-siliconmotion.x86_64        1.4.1-2.1              installed       
xorg-x11-drv-sis.x86_64                  0.9.1-7.1.el5          installed       
xorg-x11-drv-sisusb.x86_64               0.8.1-4.1              installed       
xorg-x11-drv-spaceorb.x86_64             1.1.0-1.1              installed       
xorg-x11-drv-summa.x86_64                1.1.0-1.1              installed       
xorg-x11-drv-tdfx.x86_64                 1.2.1-3.1              installed       
xorg-x11-drv-tek4957.x86_64              1.1.0-1.1              installed       
xorg-x11-drv-trident.x86_64              1.2.1-3.fc6            installed       
xorg-x11-drv-ur98.x86_64                 1.1.0-1.1              installed       
xorg-x11-drv-vesa.x86_64                 1.3.0-8.1.el5          installed       
xorg-x11-drv-vga.x86_64                  4.1.0-2.1              installed       
xorg-x11-drv-via.x86_64                  0.2.1-9                installed       
xorg-x11-drv-vmmouse.x86_64              12.4.0-2.1             installed       
xorg-x11-drv-vmware.x86_64               10.13.0-2.1            installed       
xorg-x11-drv-void.x86_64                 1.1.0-3.1              installed       
xorg-x11-drv-voodoo.x86_64               1.1.0-3.1              installed       
xorg-x11-filesystem.noarch               7.1-2.fc6              installed       
xorg-x11-font-utils.x86_64               1:7.1-2                installed       
xorg-x11-fonts-100dpi.noarch             7.1-2.1.el5            installed       
xorg-x11-fonts-75dpi.noarch              7.1-2.1.el5            installed       
xorg-x11-fonts-ISO8859-1-100dpi.noarch   7.1-2.1.el5            installed       
xorg-x11-fonts-ISO8859-1-75dpi.noarch    7.1-2.1.el5            installed       
xorg-x11-fonts-Type1.noarch              7.1-2.1.el5            installed       
xorg-x11-fonts-base.noarch               7.1-2.1.el5            installed       
xorg-x11-fonts-misc.noarch               7.1-2.1.el5            installed       
xorg-x11-fonts-truetype.noarch           7.1-2.1.el5            installed       
xorg-x11-server-Xnest.x86_64             1.1.1-48.41.el5_2.1    installed       
xorg-x11-server-Xorg.x86_64              1.1.1-48.41.el5_2.1    installed       
xorg-x11-server-Xvfb.x86_64              1.1.1-48.41.el5_2.1    installed       
xorg-x11-server-utils.x86_64             7.1-4.fc6              installed       
xorg-x11-twm.x86_64                      1:1.0.1-3.1            installed       
xorg-x11-utils.x86_64                    7.1-2.fc6              installed       
xorg-x11-xauth.x86_64                    1:1.0.1-2.1            installed       
xorg-x11-xfs.x86_64                      1:1.0.2-4              installed       
xorg-x11-xinit.x86_64                    1.0.2-15.el5           installed       
xorg-x11-xkb-utils.x86_64                1.0.2-2.1              installed       
Available Packages
xorg-x11-drv-i810.i386                   1.6.5-9.13.el5         base            
xorg-x11-drv-i810-devel.x86_64           1.6.5-9.13.el5         base            
xorg-x11-drv-i810-devel.i386             1.6.5-9.13.el5         base            
xorg-x11-drv-via.i386                    0.2.1-9                base            
xorg-x11-drv-via-devel.i386              0.2.1-9                base            
xorg-x11-drv-via-devel.x86_64            0.2.1-9                base            
xorg-x11-fonts-ISO8859-14-100dpi.noarch  7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-14-75dpi.noarch   7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-15-100dpi.noarch  7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-15-75dpi.noarch   7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-2-100dpi.noarch   7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-2-75dpi.noarch    7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-9-100dpi.noarch   7.1-2.1.el5            base            
xorg-x11-fonts-ISO8859-9-75dpi.noarch    7.1-2.1.el5            base            
xorg-x11-fonts-cyrillic.noarch           7.1-2.1.el5            base            
xorg-x11-fonts-ethiopic.noarch           7.1-2.1.el5            base            
xorg-x11-fonts-syriac.noarch             7.1-2.1.el5            base            
xorg-x11-proto-devel.x86_64              7.1-9.el5.centos       base            
xorg-x11-proto-devel.i386                7.1-9.el5.centos       base            
xorg-x11-resutils.x86_64                 7.1-2.fc6              base            
xorg-x11-server-Xdmx.x86_64              1.1.1-48.41.el5_2.1    updates         
xorg-x11-server-Xephyr.x86_64            1.1.1-48.41.el5_2.1    updates         
xorg-x11-server-randr-source.x86_64      1.1.1-48.41.el5_2.1    updates         
xorg-x11-server-sdk.x86_64               1.1.1-48.41.el5_2.1    updates         
xorg-x11-util-macros.x86_64              1.0.2-4.fc6            base            
xorg-x11-xbitmaps.x86_64                 1.0.1-4.1              base            
xorg-x11-xfs-utils.x86_64                1:1.0.2-4              base            
xorg-x11-xfwp.x86_64                     1.0.1-3.1              base            
xorg-x11-xsm.x86_64                      1.0.2-4.fc6            base            
xorg-x11-xtrans-devel.x86_64             1.0.1-1.1.fc6          base            
xorg-x11-xtrans-devel.i386               1.0.1-1.1.fc6          base 
_________________________________________________________________

 of your life.


From ripley at stats.ox.ac.uk  Sat Oct  4 09:16:28 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 4 Oct 2008 08:16:28 +0100 (BST)
Subject: [Rd] Unable to install R on CentOS 64 bit machine
In-Reply-To: <BAY133-W27E5EFD8BD4F6EE0FCAE05D73C0@phx.gbl>
References: <BAY133-W27E5EFD8BD4F6EE0FCAE05D73C0@phx.gbl>
Message-ID: <alpine.LFD.2.00.0810040813400.26585@gannet.stats.ox.ac.uk>

config.log will tell you what is missing.  But most likely it is X11 
headers/libraries in packages like libX11-devel and libXt-devel.  (Note 
that the R-admin manual does tell you this.)

Real names and proper signature blocks are preferred here.

On Fri, 3 Oct 2008, Shantanu Unknown wrote:

>
> Hi all,
> I am unable to install R on CentOS5 64 bit machine.
>
> When I do ./configure
> I get the message
>
> "checking for X... no
> configure: error: --with-x=yes (default) and X11 headers/libs are not available"
>
> from doing a websearch it seems I need to install x11-xorg. But I  could not find it when I did a yum install.
>
> I did  "yum list xorg-x11*" and following is what I get
> Could someone tell me which is the missing X11 package I need to install for CentOS5?
> Thanks a lot for any help.
> Shantanu
>
> Installed Packages
> xorg-x11-apps.x86_64                     7.1-4.0.1.el5          installed
> xorg-x11-drivers.x86_64                  7.1-4.1.el5            installed
> xorg-x11-drv-acecad.x86_64               1.1.0-2.1              installed
> xorg-x11-drv-aiptek.x86_64               1.0.1-2                installed
> xorg-x11-drv-ast.x86_64                  0.81.0-3               installed
> xorg-x11-drv-ati.x86_64                  6.6.3-3.13.el5         installed
> xorg-x11-drv-calcomp.x86_64              1.1.0-1.1              installed
> xorg-x11-drv-cirrus.x86_64               1.1.0-2.fc6            installed
> xorg-x11-drv-citron.x86_64               2.2.0-1.1              installed
> xorg-x11-drv-digitaledge.x86_64          1.1.0-1.1              installed
> xorg-x11-drv-dmc.x86_64                  1.1.0-2                installed
> xorg-x11-drv-dummy.x86_64                0.2.0-2.1              installed
> xorg-x11-drv-dynapro.x86_64              1.1.0-2                installed
> xorg-x11-drv-elo2300.x86_64              1.1.0-1.1              installed
> xorg-x11-drv-elographics.x86_64          1.1.0-1.1              installed
> xorg-x11-drv-evdev.x86_64                1:1.0.0.5-3.el5        installed
> xorg-x11-drv-fbdev.x86_64                0.3.0-2                installed
> xorg-x11-drv-fpit.x86_64                 1.1.0-1.1              installed
> xorg-x11-drv-hyperpen.x86_64             1.1.0-2                installed
> xorg-x11-drv-i810.x86_64                 1.6.5-9.13.el5         installed
> xorg-x11-drv-jamstudio.x86_64            1.1.0-1.1              installed
> xorg-x11-drv-joystick.x86_64             1.1.0-1.1              installed
> xorg-x11-drv-keyboard.x86_64             1.1.0-3                installed
> xorg-x11-drv-magellan.x86_64             1.1.0-1.1              installed
> xorg-x11-drv-magictouch.x86_64           1.0.0.5-2.1            installed
> xorg-x11-drv-mga.x86_64                  1.4.2-7.el5            installed
> xorg-x11-drv-microtouch.x86_64           1.1.0-1.1              installed
> xorg-x11-drv-mouse.x86_64                1.1.1-1.1              installed
> xorg-x11-drv-mutouch.x86_64              1.1.0-2                installed
> xorg-x11-drv-nv.x86_64                   2.1.6-6.el5            installed
> xorg-x11-drv-palmax.x86_64               1.1.0-1.1              installed
> xorg-x11-drv-penmount.x86_64             1.1.0-2.1              installed
> xorg-x11-drv-s3.x86_64                   0.4.1-2.1              installed
> xorg-x11-drv-s3virge.x86_64              1.9.1-2.1              installed
> xorg-x11-drv-savage.x86_64               2.1.1-5.fc6            installed
> xorg-x11-drv-siliconmotion.x86_64        1.4.1-2.1              installed
> xorg-x11-drv-sis.x86_64                  0.9.1-7.1.el5          installed
> xorg-x11-drv-sisusb.x86_64               0.8.1-4.1              installed
> xorg-x11-drv-spaceorb.x86_64             1.1.0-1.1              installed
> xorg-x11-drv-summa.x86_64                1.1.0-1.1              installed
> xorg-x11-drv-tdfx.x86_64                 1.2.1-3.1              installed
> xorg-x11-drv-tek4957.x86_64              1.1.0-1.1              installed
> xorg-x11-drv-trident.x86_64              1.2.1-3.fc6            installed
> xorg-x11-drv-ur98.x86_64                 1.1.0-1.1              installed
> xorg-x11-drv-vesa.x86_64                 1.3.0-8.1.el5          installed
> xorg-x11-drv-vga.x86_64                  4.1.0-2.1              installed
> xorg-x11-drv-via.x86_64                  0.2.1-9                installed
> xorg-x11-drv-vmmouse.x86_64              12.4.0-2.1             installed
> xorg-x11-drv-vmware.x86_64               10.13.0-2.1            installed
> xorg-x11-drv-void.x86_64                 1.1.0-3.1              installed
> xorg-x11-drv-voodoo.x86_64               1.1.0-3.1              installed
> xorg-x11-filesystem.noarch               7.1-2.fc6              installed
> xorg-x11-font-utils.x86_64               1:7.1-2                installed
> xorg-x11-fonts-100dpi.noarch             7.1-2.1.el5            installed
> xorg-x11-fonts-75dpi.noarch              7.1-2.1.el5            installed
> xorg-x11-fonts-ISO8859-1-100dpi.noarch   7.1-2.1.el5            installed
> xorg-x11-fonts-ISO8859-1-75dpi.noarch    7.1-2.1.el5            installed
> xorg-x11-fonts-Type1.noarch              7.1-2.1.el5            installed
> xorg-x11-fonts-base.noarch               7.1-2.1.el5            installed
> xorg-x11-fonts-misc.noarch               7.1-2.1.el5            installed
> xorg-x11-fonts-truetype.noarch           7.1-2.1.el5            installed
> xorg-x11-server-Xnest.x86_64             1.1.1-48.41.el5_2.1    installed
> xorg-x11-server-Xorg.x86_64              1.1.1-48.41.el5_2.1    installed
> xorg-x11-server-Xvfb.x86_64              1.1.1-48.41.el5_2.1    installed
> xorg-x11-server-utils.x86_64             7.1-4.fc6              installed
> xorg-x11-twm.x86_64                      1:1.0.1-3.1            installed
> xorg-x11-utils.x86_64                    7.1-2.fc6              installed
> xorg-x11-xauth.x86_64                    1:1.0.1-2.1            installed
> xorg-x11-xfs.x86_64                      1:1.0.2-4              installed
> xorg-x11-xinit.x86_64                    1.0.2-15.el5           installed
> xorg-x11-xkb-utils.x86_64                1.0.2-2.1              installed
> Available Packages
> xorg-x11-drv-i810.i386                   1.6.5-9.13.el5         base
> xorg-x11-drv-i810-devel.x86_64           1.6.5-9.13.el5         base
> xorg-x11-drv-i810-devel.i386             1.6.5-9.13.el5         base
> xorg-x11-drv-via.i386                    0.2.1-9                base
> xorg-x11-drv-via-devel.i386              0.2.1-9                base
> xorg-x11-drv-via-devel.x86_64            0.2.1-9                base
> xorg-x11-fonts-ISO8859-14-100dpi.noarch  7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-14-75dpi.noarch   7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-15-100dpi.noarch  7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-15-75dpi.noarch   7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-2-100dpi.noarch   7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-2-75dpi.noarch    7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-9-100dpi.noarch   7.1-2.1.el5            base
> xorg-x11-fonts-ISO8859-9-75dpi.noarch    7.1-2.1.el5            base
> xorg-x11-fonts-cyrillic.noarch           7.1-2.1.el5            base
> xorg-x11-fonts-ethiopic.noarch           7.1-2.1.el5            base
> xorg-x11-fonts-syriac.noarch             7.1-2.1.el5            base
> xorg-x11-proto-devel.x86_64              7.1-9.el5.centos       base
> xorg-x11-proto-devel.i386                7.1-9.el5.centos       base
> xorg-x11-resutils.x86_64                 7.1-2.fc6              base
> xorg-x11-server-Xdmx.x86_64              1.1.1-48.41.el5_2.1    updates
> xorg-x11-server-Xephyr.x86_64            1.1.1-48.41.el5_2.1    updates
> xorg-x11-server-randr-source.x86_64      1.1.1-48.41.el5_2.1    updates
> xorg-x11-server-sdk.x86_64               1.1.1-48.41.el5_2.1    updates
> xorg-x11-util-macros.x86_64              1.0.2-4.fc6            base
> xorg-x11-xbitmaps.x86_64                 1.0.1-4.1              base
> xorg-x11-xfs-utils.x86_64                1:1.0.2-4              base
> xorg-x11-xfwp.x86_64                     1.0.1-3.1              base
> xorg-x11-xsm.x86_64                      1.0.2-4.fc6            base
> xorg-x11-xtrans-devel.x86_64             1.0.1-1.1.fc6          base
> xorg-x11-xtrans-devel.i386               1.0.1-1.1.fc6          base
> _________________________________________________________________
>
> of your life.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Sat Oct  4 17:58:20 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 4 Oct 2008 11:58:20 -0400
Subject: [Rd] Attributes of top level environments clobbered (was Re:
	[R] possible bug in function 'var' in R 2.7.2?)
In-Reply-To: <1223131546.18152.29.camel@hot-spring>
References: <mailman.17.1223114404.5284.r-devel@r-project.org>
	<1223131546.18152.29.camel@hot-spring>
Message-ID: <971536df0810040858w564bbd9fp6618b54d3dcf0ccb@mail.gmail.com>

On Sat, Oct 4, 2008 at 10:45 AM, laurent <lgautier at gmail.com> wrote:
>
> On Sat, 2008-10-04 at 12:00 +0200, r-devel-request at r-project.org wrote:
>> Message: 18
>> Date: Fri, 3 Oct 2008 15:35:18 -0500 (CDT)
>> From: Luke Tierney <luke at stat.uiowa.edu>
>> Subject: Re: [Rd] Attributes of top level environments clobbered (was
>>       Re: [R] possible bug in function 'var' in R 2.7.2?)
>> To: Gabor Grothendieck <ggrothendieck at gmail.com>
>> Cc: "r-devel at r-project.org" <r-devel at r-project.org>,  Martin Maechler
>>       <maechler at stat.math.ethz.ch>
>> Message-ID: <Pine.LNX.4.64.0810031433350.14866 at itasca2.wildberry.org>
>> Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
>>
>> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>>
>> > On Fri, Oct 3, 2008 at 12:46 PM, Luke Tierney <luke at stat.uiowa.edu> wrote:
>> >> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>> >>
>> >>> On Fri, Oct 3, 2008 at 11:43 AM, Luke Tierney <luke at stat.uiowa.edu> wrote:
>> >>>>
> [...]
>> > I do appreciate the excellent R software; however, there are a few points like
>> > those addressed on the proto home page which do need to be addressed in R
>> > for it to be fully functional.
>>
>> There are some interesting poins on that page that are worth looking
>> into.  Over time I suspect all but the current 3. will be addressed,
>> but 3., which is a variant on the unclass issue, is not likely to be.
>> You can call this a deficiency in R if you like, and I would agree in
>> the sense that I think it is inappropriate to allow attributes to be
>> set but not in a reliable way because they can be inadvertenly
>> removed.  We should have done this differently.  THere were/are two
>> choices:
>>
>>      Make reference values, including environments, special in that they
>>      may not have attributes. This woud have been fairly easy (modulo one
>>      use made in decorating the frames on the search path) and could be
>>      done now to clean things up.
>>
>>      Make R-visible environments in two parts--a wrapper that is passed by
>>      value like standard R objects and could have attributes, and an
>>      internal part that is essentially the current environment object.
>>      This is analogous to the way that character vectors, even of length 1,
>>      consist of an STRSXP wrapper containing CHARSXPs that hold the string.
>>      The STRSXP's are visible at the R level, the CHARSXPs are not.  This
>>      would have been messier to implement, and unfortunately would be very
>>      messy to retro-fit at this point, so it isn't likely to happen unless
>>      there is some other compelling reason to do so.
>
> Couldn't the two options be merged into one for a start ?
>
> - Make reference values either attribute-free entities (seems important,
> as the "poor reliability" of assigning attributes to environment is
> probably not widely known), or generate warnings upon assignment of
> attributes.

Some specifics need to be added to the "poor reliability" phrase relating to
of attributed environments.  The proto package changes the class attribute
of environments (but no other attribute of environments) and proto in turn
underlies large widely used packages which likely exercise it thoroughly yet
through this experience the only places where this was noticeable were
points #1 and #3 of the Avoiding R Bugs section of the proto home page
at http://r-proto.googlecode.com

Neither of these are two points are deal breakers as

- #1 has an easy workaround (just change one line in your DESCRIPTION file) and
  if the promised fix is made even this won't be necesary,

- #3 mostly seems mostly harmless in the context of proto as the only attribute
  change is from a class of  "enviornment" to c("proto",
"environment").  Artificial
  examples can be constructed where this is a problem but substantial experience
  with it suggests that it is not a problem in practice.

(The remaining R problems listed are all related to promises, not environments.)

>
> - Create an R-level class that contains an environment ("Environment" ?,
> "envobj" ?) and implements an environment-like interface by delegation
> (somehow like your option 2. above).
> Gabor could certainly create his own class, but having this administered
> at the R-core level would have the following potential benefits:
> - Anyone with similar needs will think twice before starting to
> implement his own solution.
> - That one class can be moved to a lower level in the internals
> (C-level, with a new given SEXPTYPE) if it proves a working solution,
> and as time permits.
>
> Just a thought,

Actually, I see the main benefit of this or other approach as
providing the missing
elements of S3 support to environments thereby potentially streamlining the
implementation of every package that needs it (proto, tcltk, R.oo, ...) or more
perhaps more accurately allowing tcltk and R.oo and other such packages to
become as streamlined as proto already is.

Each of these packages could then use inheritance rather than
containment thereby
leveraging the S3 OO facilities that one really expects R to provide.

It would be important that the new class whose objects contain environments is
sufficiently indistinguishable in terms of its methods from regular
environments so that
inheritance works transparently.

I assume that if e is a new style environment then parent.env(e) can be an
old style or new style environment and in a sense all the new style
environments can be regarded as childen of the old style environment they
contain.  There is some question of what happens if parent.env(e) is deleted
in the case that its a new style environment but its contained old style
environment is not deleted.   Is it left undefined or does it revert to the
old style environment?  Implementation and performance considerations
may suggest how best to handle this.

Using these three packages as example cases may help clarify the desired
functionality here.

Another possible approach would be to only have new style environments
rather than both or possibly only expose new style environments to the user
even if both existed.  Some thought would be required to determine which
was the most desirable.

>
>
>
> L.
>
>
>
>> The bottom line is that this situation isn't likely to change any time
>> soon as far as I can see.  If that means that for you R will not be
>> "fully functional" then so be it.  Attributes on environments are not
>> reliable and hence it is a Bad Idea to try to use them.  This is a
>> feature of R as it is now, has been for a while, and will be for a
>> while. If you write code for language X, you can write it for
>> X-as-it-s or X-as-you-wish-it-to-be; but if you chose
>> X-as-you-wish-it-to-be and find things don't work out it's hard to
>> argue that the fault is with X.
>>
>> luke
>>
>> >
>> >>
>> >> luke
>> >>
>> >>> - if time is a problem perhaps the core group needs to add resources
>> >>> to reasonably address the problems in R.  Traditional economics
>> >>> do not apply to an open source project.  There is no monetary cost to
>> >>> adding additional developers.
>> >>>>
>> >>>> luke
>> >>>>
>> >>>> On Fri, 3 Oct 2008, Gabor Grothendieck wrote:
>> >>>>
>> >>>>> On Fri, Oct 3, 2008 at 3:23 AM, Martin Maechler
>> >>>>> <maechler at stat.math.ethz.ch> wrote:
>> >>>>>>
>> >>>>>> a much better (and much less error-prone) idea would be to install
>> >>>>>> R 2.8.0 alpha  even now.
>> >>>>>> It will become 'beta' early next week.
>> >>>>>>
>> >>>>>> We are asking the R community to please install and use
>> >>>>>> pre-release versions of R  (if you can / are allowed to)
>> >>>>>> at least from beta onwards, and report problems you see early on
>> >>>>>> *before* the final release.
>> >>>>>
>> >>>>> The bug discussed in the following year-old post suggested that
>> >>>>> the problem of clobbering attributes of top level environment objects
>> >>>>> would be fixed for 2.7 but its still in R version 2.7.2 (2008-08-25)"
>> >>>>> and also still in  "R version 2.8.0 alpha (2008-10-01 r46589)"
>> >>>>>
>> >>>>>  https://stat.ethz.ch/pipermail/r-devel/2007-October/047184.html
>> >>>>>
>> >>>>> The Avoiding R Bugs section of this page:
>> >>>>>
>> >>>>>  http://r-proto.googlecode.com
>> >>>>>
>> >>>>> has more discussion as well as a list of some other R bugs.
>> >>>>>
>> >>>>> This can be tested by creating a package with these two files only:
>> >>>>>
>> >>>>> ---DESCRIPTION---
>> >>>>> Package: testlazy
>> >>>>> Version: 1.0-0
>> >>>>> Date: 2008-10-03
>> >>>>> Title: Test lazy loading
>> >>>>> Author: G Grothendieck
>> >>>>> Maintainer: G Grothendieck <ggrothendieck at gmail.com>
>> >>>>> Description: Test lazy loading with top level objects.
>> >>>>> Depends: proto
>> >>>>> LazyLoad: yes
>> >>>>> License: GPL-2
>> >>>>> ---R/testlazy.R---
>> >>>>> TopLevel <- proto()
>> >>>>> ---
>> >>>>>
>> >>>>> And then testing it:
>> >>>>>
>> >>>>> library(testlazy)
>> >>>>> class(TopLevel)
>> >>>>>
>> >>>>> If its class is "environment" only then the class attribute was
>> >>>>> stripped.
>> >>>>>
>> >>>>> ______________________________________________
>> >>>>> R-devel at r-project.org mailing list
>> >>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >>>>>
>> >>>>
>> >>>> --
>> >>>> Luke Tierney
>> >>>> Chair, Statistics and Actuarial Science
>> >>>> Ralph E. Wareham Professor of Mathematical Sciences
>> >>>> University of Iowa                  Phone:             319-335-3386
>> >>>> Department of Statistics and        Fax:               319-335-3017
>> >>>>  Actuarial Science
>> >>>> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>> >>>> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>> >>>>
>> >>>
>> >>
>> >> --
>> >> Luke Tierney
>> >> Chair, Statistics and Actuarial Science
>> >> Ralph E. Wareham Professor of Mathematical Sciences
>> >> University of Iowa                  Phone:             319-335-3386
>> >> Department of Statistics and        Fax:               319-335-3017
>> >>   Actuarial Science
>> >> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>> >> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>> >>
>> >
>>
>> --
>> Luke Tierney
>> Chair, Statistics and Actuarial Science
>> Ralph E. Wareham Professor of Mathematical Sciences
>> University of Iowa                  Phone:             319-335-3386
>> Department of Statistics and        Fax:               319-335-3017
>>     Actuarial Science
>> 241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
>> Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu
>>
>>
>>
>> ------------------------------
>>
>> Message: 19
>> Date: Fri, 3 Oct 2008 14:49:17 -0700
>> From: Kasper Daniel Hansen <khansen at stat.berkeley.edu>
>> Subject: Re: [Rd] Can DESCRIPTION Maintainer: field contain general
>>       URL     instead of only email address?
>> To: William Dunlap <wdunlap at tibco.com>
>> Cc: R-devel at stat.math.ethz.ch
>> Message-ID: <F5426BA5-BBBF-438E-AADC-DA62E2A2918B at stat.berkeley.edu>
>> Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
>>
>> Why don't you just give a company email address? Remember this email
>> address is to contact the maintainer. Contacting the maintainer is not
>> only done in order to request support, it could be a copy right issue,
>> code re-use request etc - although I do agree that most emails are
>> probably support requests.
>>
>> Kasper
>>
>> On Oct 3, 2008, at 11:01 , William Dunlap wrote:
>>
>> > Our firm would like to route support requests through
>> > a website instead of using email.  However R will refuse
>> > to install a package if DESCRIPTION's Maintainer field
>> > does not have a valid email adress or the special value
>> > "ORPHANED".  (The check is done with
>> > tools:::.valid_maintainer_field_regexp.)
>> >
>> > I imagine a typical Maintainer line for the package "foo"
>> > might be something like
>> >   Maintainer: Amalgamated Widget's Support Team
>> > <http://support.amalgamatedwidgets.com/spackage?name=foo>
>> >
>> > How much does the package system (or CRAN) depend on
>> > the Maintainer field being an email address?  I can imagine
>> > programs would find mailing to an address easier than
>> > dealing with a website, but humans would have a better experience
>> > with a well designed website.  Perhaps we could add an optional
>> > %s field to the website so a program could post a small message.
>> >
>> > Bill Dunlap
>> > TIBCO Spotfire Inc.
>> > wdunlap tibco.com
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
>> ------------------------------
>>
>> Message: 20
>> Date: Fri, 3 Oct 2008 22:40:35 +0000
>> From: Shantanu Unknown <shantanu9847 at hotmail.com>
>> Subject: [Rd] Unable to install R on CentOS 64 bit machine
>> To: <r-devel at r-project.org>
>> Message-ID: <BAY133-W27E5EFD8BD4F6EE0FCAE05D73C0 at phx.gbl>
>> Content-Type: text/plain; charset="iso-8859-1"
>>
>>
>> Hi all,
>> I am unable to install R on CentOS5 64 bit machine.
>>
>> When I do ./configure
>> I get the message
>>
>> "checking for X... no
>> configure: error: --with-x=yes (default) and X11 headers/libs are not available"
>>
>> from doing a websearch it seems I need to install x11-xorg. But I  could not find it when I did a yum install.
>>
>> I did  "yum list xorg-x11*" and following is what I get
>> Could someone tell me which is the missing X11 package I need to install for CentOS5?
>> Thanks a lot for any help.
>> Shantanu
>>
>> Installed Packages
>> xorg-x11-apps.x86_64                     7.1-4.0.1.el5          installed
>> xorg-x11-drivers.x86_64                  7.1-4.1.el5            installed
>> xorg-x11-drv-acecad.x86_64               1.1.0-2.1              installed
>> xorg-x11-drv-aiptek.x86_64               1.0.1-2                installed
>> xorg-x11-drv-ast.x86_64                  0.81.0-3               installed
>> xorg-x11-drv-ati.x86_64                  6.6.3-3.13.el5         installed
>> xorg-x11-drv-calcomp.x86_64              1.1.0-1.1              installed
>> xorg-x11-drv-cirrus.x86_64               1.1.0-2.fc6            installed
>> xorg-x11-drv-citron.x86_64               2.2.0-1.1              installed
>> xorg-x11-drv-digitaledge.x86_64          1.1.0-1.1              installed
>> xorg-x11-drv-dmc.x86_64                  1.1.0-2                installed
>> xorg-x11-drv-dummy.x86_64                0.2.0-2.1              installed
>> xorg-x11-drv-dynapro.x86_64              1.1.0-2                installed
>> xorg-x11-drv-elo2300.x86_64              1.1.0-1.1              installed
>> xorg-x11-drv-elographics.x86_64          1.1.0-1.1              installed
>> xorg-x11-drv-evdev.x86_64                1:1.0.0.5-3.el5        installed
>> xorg-x11-drv-fbdev.x86_64                0.3.0-2                installed
>> xorg-x11-drv-fpit.x86_64                 1.1.0-1.1              installed
>> xorg-x11-drv-hyperpen.x86_64             1.1.0-2                installed
>> xorg-x11-drv-i810.x86_64                 1.6.5-9.13.el5         installed
>> xorg-x11-drv-jamstudio.x86_64            1.1.0-1.1              installed
>> xorg-x11-drv-joystick.x86_64             1.1.0-1.1              installed
>> xorg-x11-drv-keyboard.x86_64             1.1.0-3                installed
>> xorg-x11-drv-magellan.x86_64             1.1.0-1.1              installed
>> xorg-x11-drv-magictouch.x86_64           1.0.0.5-2.1            installed
>> xorg-x11-drv-mga.x86_64                  1.4.2-7.el5            installed
>> xorg-x11-drv-microtouch.x86_64           1.1.0-1.1              installed
>> xorg-x11-drv-mouse.x86_64                1.1.1-1.1              installed
>> xorg-x11-drv-mutouch.x86_64              1.1.0-2                installed
>> xorg-x11-drv-nv.x86_64                   2.1.6-6.el5            installed
>> xorg-x11-drv-palmax.x86_64               1.1.0-1.1              installed
>> xorg-x11-drv-penmount.x86_64             1.1.0-2.1              installed
>> xorg-x11-drv-s3.x86_64                   0.4.1-2.1              installed
>> xorg-x11-drv-s3virge.x86_64              1.9.1-2.1              installed
>> xorg-x11-drv-savage.x86_64               2.1.1-5.fc6            installed
>> xorg-x11-drv-siliconmotion.x86_64        1.4.1-2.1              installed
>> xorg-x11-drv-sis.x86_64                  0.9.1-7.1.el5          installed
>> xorg-x11-drv-sisusb.x86_64               0.8.1-4.1              installed
>> xorg-x11-drv-spaceorb.x86_64             1.1.0-1.1              installed
>> xorg-x11-drv-summa.x86_64                1.1.0-1.1              installed
>> xorg-x11-drv-tdfx.x86_64                 1.2.1-3.1              installed
>> xorg-x11-drv-tek4957.x86_64              1.1.0-1.1              installed
>> xorg-x11-drv-trident.x86_64              1.2.1-3.fc6            installed
>> xorg-x11-drv-ur98.x86_64                 1.1.0-1.1              installed
>> xorg-x11-drv-vesa.x86_64                 1.3.0-8.1.el5          installed
>> xorg-x11-drv-vga.x86_64                  4.1.0-2.1              installed
>> xorg-x11-drv-via.x86_64                  0.2.1-9                installed
>> xorg-x11-drv-vmmouse.x86_64              12.4.0-2.1             installed
>> xorg-x11-drv-vmware.x86_64               10.13.0-2.1            installed
>> xorg-x11-drv-void.x86_64                 1.1.0-3.1              installed
>> xorg-x11-drv-voodoo.x86_64               1.1.0-3.1              installed
>> xorg-x11-filesystem.noarch               7.1-2.fc6              installed
>> xorg-x11-font-utils.x86_64               1:7.1-2                installed
>> xorg-x11-fonts-100dpi.noarch             7.1-2.1.el5            installed
>> xorg-x11-fonts-75dpi.noarch              7.1-2.1.el5            installed
>> xorg-x11-fonts-ISO8859-1-100dpi.noarch   7.1-2.1.el5            installed
>> xorg-x11-fonts-ISO8859-1-75dpi.noarch    7.1-2.1.el5            installed
>> xorg-x11-fonts-Type1.noarch              7.1-2.1.el5            installed
>> xorg-x11-fonts-base.noarch               7.1-2.1.el5            installed
>> xorg-x11-fonts-misc.noarch               7.1-2.1.el5            installed
>> xorg-x11-fonts-truetype.noarch           7.1-2.1.el5            installed
>> xorg-x11-server-Xnest.x86_64             1.1.1-48.41.el5_2.1    installed
>> xorg-x11-server-Xorg.x86_64              1.1.1-48.41.el5_2.1    installed
>> xorg-x11-server-Xvfb.x86_64              1.1.1-48.41.el5_2.1    installed
>> xorg-x11-server-utils.x86_64             7.1-4.fc6              installed
>> xorg-x11-twm.x86_64                      1:1.0.1-3.1            installed
>> xorg-x11-utils.x86_64                    7.1-2.fc6              installed
>> xorg-x11-xauth.x86_64                    1:1.0.1-2.1            installed
>> xorg-x11-xfs.x86_64                      1:1.0.2-4              installed
>> xorg-x11-xinit.x86_64                    1.0.2-15.el5           installed
>> xorg-x11-xkb-utils.x86_64                1.0.2-2.1              installed
>> Available Packages
>> xorg-x11-drv-i810.i386                   1.6.5-9.13.el5         base
>> xorg-x11-drv-i810-devel.x86_64           1.6.5-9.13.el5         base
>> xorg-x11-drv-i810-devel.i386             1.6.5-9.13.el5         base
>> xorg-x11-drv-via.i386                    0.2.1-9                base
>> xorg-x11-drv-via-devel.i386              0.2.1-9                base
>> xorg-x11-drv-via-devel.x86_64            0.2.1-9                base
>> xorg-x11-fonts-ISO8859-14-100dpi.noarch  7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-14-75dpi.noarch   7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-15-100dpi.noarch  7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-15-75dpi.noarch   7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-2-100dpi.noarch   7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-2-75dpi.noarch    7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-9-100dpi.noarch   7.1-2.1.el5            base
>> xorg-x11-fonts-ISO8859-9-75dpi.noarch    7.1-2.1.el5            base
>> xorg-x11-fonts-cyrillic.noarch           7.1-2.1.el5            base
>> xorg-x11-fonts-ethiopic.noarch           7.1-2.1.el5            base
>> xorg-x11-fonts-syriac.noarch             7.1-2.1.el5            base
>> xorg-x11-proto-devel.x86_64              7.1-9.el5.centos       base
>> xorg-x11-proto-devel.i386                7.1-9.el5.centos       base
>> xorg-x11-resutils.x86_64                 7.1-2.fc6              base
>> xorg-x11-server-Xdmx.x86_64              1.1.1-48.41.el5_2.1    updates
>> xorg-x11-server-Xephyr.x86_64            1.1.1-48.41.el5_2.1    updates
>> xorg-x11-server-randr-source.x86_64      1.1.1-48.41.el5_2.1    updates
>> xorg-x11-server-sdk.x86_64               1.1.1-48.41.el5_2.1    updates
>> xorg-x11-util-macros.x86_64              1.0.2-4.fc6            base
>> xorg-x11-xbitmaps.x86_64                 1.0.1-4.1              base
>> xorg-x11-xfs-utils.x86_64                1:1.0.2-4              base
>> xorg-x11-xfwp.x86_64                     1.0.1-3.1              base
>> xorg-x11-xsm.x86_64                      1.0.2-4.fc6            base
>> xorg-x11-xtrans-devel.x86_64             1.0.1-1.1.fc6          base
>> xorg-x11-xtrans-devel.i386               1.0.1-1.1.fc6          base
>> _________________________________________________________________
>>
>>  of your life.
>>
>>
>>
>> ------------------------------
>>
>> Message: 21
>> Date: Sat, 4 Oct 2008 08:16:28 +0100 (BST)
>> From: Prof Brian Ripley <ripley at stats.ox.ac.uk>
>> Subject: Re: [Rd] Unable to install R on CentOS 64 bit machine
>> To: Shantanu Unknown <shantanu9847 at hotmail.com>
>> Cc: r-devel at r-project.org
>> Message-ID:
>>       <alpine.LFD.2.00.0810040813400.26585 at gannet.stats.ox.ac.uk>
>> Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
>>
>> config.log will tell you what is missing.  But most likely it is X11
>> headers/libraries in packages like libX11-devel and libXt-devel.  (Note
>> that the R-admin manual does tell you this.)
>>
>> Real names and proper signature blocks are preferred here.
>>
>> On Fri, 3 Oct 2008, Shantanu Unknown wrote:
>>
>> >
>> > Hi all,
>> > I am unable to install R on CentOS5 64 bit machine.
>> >
>> > When I do ./configure
>> > I get the message
>> >
>> > "checking for X... no
>> > configure: error: --with-x=yes (default) and X11 headers/libs are not available"
>> >
>> > from doing a websearch it seems I need to install x11-xorg. But I  could not find it when I did a yum install.
>> >
>> > I did  "yum list xorg-x11*" and following is what I get
>> > Could someone tell me which is the missing X11 package I need to install for CentOS5?
>> > Thanks a lot for any help.
>> > Shantanu
>> >
>> > Installed Packages
>> > xorg-x11-apps.x86_64                     7.1-4.0.1.el5          installed
>> > xorg-x11-drivers.x86_64                  7.1-4.1.el5            installed
>> > xorg-x11-drv-acecad.x86_64               1.1.0-2.1              installed
>> > xorg-x11-drv-aiptek.x86_64               1.0.1-2                installed
>> > xorg-x11-drv-ast.x86_64                  0.81.0-3               installed
>> > xorg-x11-drv-ati.x86_64                  6.6.3-3.13.el5         installed
>> > xorg-x11-drv-calcomp.x86_64              1.1.0-1.1              installed
>> > xorg-x11-drv-cirrus.x86_64               1.1.0-2.fc6            installed
>> > xorg-x11-drv-citron.x86_64               2.2.0-1.1              installed
>> > xorg-x11-drv-digitaledge.x86_64          1.1.0-1.1              installed
>> > xorg-x11-drv-dmc.x86_64                  1.1.0-2                installed
>> > xorg-x11-drv-dummy.x86_64                0.2.0-2.1              installed
>> > xorg-x11-drv-dynapro.x86_64              1.1.0-2                installed
>> > xorg-x11-drv-elo2300.x86_64              1.1.0-1.1              installed
>> > xorg-x11-drv-elographics.x86_64          1.1.0-1.1              installed
>> > xorg-x11-drv-evdev.x86_64                1:1.0.0.5-3.el5        installed
>> > xorg-x11-drv-fbdev.x86_64                0.3.0-2                installed
>> > xorg-x11-drv-fpit.x86_64                 1.1.0-1.1              installed
>> > xorg-x11-drv-hyperpen.x86_64             1.1.0-2                installed
>> > xorg-x11-drv-i810.x86_64                 1.6.5-9.13.el5         installed
>> > xorg-x11-drv-jamstudio.x86_64            1.1.0-1.1              installed
>> > xorg-x11-drv-joystick.x86_64             1.1.0-1.1              installed
>> > xorg-x11-drv-keyboard.x86_64             1.1.0-3                installed
>> > xorg-x11-drv-magellan.x86_64             1.1.0-1.1              installed
>> > xorg-x11-drv-magictouch.x86_64           1.0.0.5-2.1            installed
>> > xorg-x11-drv-mga.x86_64                  1.4.2-7.el5            installed
>> > xorg-x11-drv-microtouch.x86_64           1.1.0-1.1              installed
>> > xorg-x11-drv-mouse.x86_64                1.1.1-1.1              installed
>> > xorg-x11-drv-mutouch.x86_64              1.1.0-2                installed
>> > xorg-x11-drv-nv.x86_64                   2.1.6-6.el5            installed
>> > xorg-x11-drv-palmax.x86_64               1.1.0-1.1              installed
>> > xorg-x11-drv-penmount.x86_64             1.1.0-2.1              installed
>> > xorg-x11-drv-s3.x86_64                   0.4.1-2.1              installed
>> > xorg-x11-drv-s3virge.x86_64              1.9.1-2.1              installed
>> > xorg-x11-drv-savage.x86_64               2.1.1-5.fc6            installed
>> > xorg-x11-drv-siliconmotion.x86_64        1.4.1-2.1              installed
>> > xorg-x11-drv-sis.x86_64                  0.9.1-7.1.el5          installed
>> > xorg-x11-drv-sisusb.x86_64               0.8.1-4.1              installed
>> > xorg-x11-drv-spaceorb.x86_64             1.1.0-1.1              installed
>> > xorg-x11-drv-summa.x86_64                1.1.0-1.1              installed
>> > xorg-x11-drv-tdfx.x86_64                 1.2.1-3.1              installed
>> > xorg-x11-drv-tek4957.x86_64              1.1.0-1.1              installed
>> > xorg-x11-drv-trident.x86_64              1.2.1-3.fc6            installed
>> > xorg-x11-drv-ur98.x86_64                 1.1.0-1.1              installed
>> > xorg-x11-drv-vesa.x86_64                 1.3.0-8.1.el5          installed
>> > xorg-x11-drv-vga.x86_64                  4.1.0-2.1              installed
>> > xorg-x11-drv-via.x86_64                  0.2.1-9                installed
>> > xorg-x11-drv-vmmouse.x86_64              12.4.0-2.1             installed
>> > xorg-x11-drv-vmware.x86_64               10.13.0-2.1            installed
>> > xorg-x11-drv-void.x86_64                 1.1.0-3.1              installed
>> > xorg-x11-drv-voodoo.x86_64               1.1.0-3.1              installed
>> > xorg-x11-filesystem.noarch               7.1-2.fc6              installed
>> > xorg-x11-font-utils.x86_64               1:7.1-2                installed
>> > xorg-x11-fonts-100dpi.noarch             7.1-2.1.el5            installed
>> > xorg-x11-fonts-75dpi.noarch              7.1-2.1.el5            installed
>> > xorg-x11-fonts-ISO8859-1-100dpi.noarch   7.1-2.1.el5            installed
>> > xorg-x11-fonts-ISO8859-1-75dpi.noarch    7.1-2.1.el5            installed
>> > xorg-x11-fonts-Type1.noarch              7.1-2.1.el5            installed
>> > xorg-x11-fonts-base.noarch               7.1-2.1.el5            installed
>> > xorg-x11-fonts-misc.noarch               7.1-2.1.el5            installed
>> > xorg-x11-fonts-truetype.noarch           7.1-2.1.el5            installed
>> > xorg-x11-server-Xnest.x86_64             1.1.1-48.41.el5_2.1    installed
>> > xorg-x11-server-Xorg.x86_64              1.1.1-48.41.el5_2.1    installed
>> > xorg-x11-server-Xvfb.x86_64              1.1.1-48.41.el5_2.1    installed
>> > xorg-x11-server-utils.x86_64             7.1-4.fc6              installed
>> > xorg-x11-twm.x86_64                      1:1.0.1-3.1            installed
>> > xorg-x11-utils.x86_64                    7.1-2.fc6              installed
>> > xorg-x11-xauth.x86_64                    1:1.0.1-2.1            installed
>> > xorg-x11-xfs.x86_64                      1:1.0.2-4              installed
>> > xorg-x11-xinit.x86_64                    1.0.2-15.el5           installed
>> > xorg-x11-xkb-utils.x86_64                1.0.2-2.1              installed
>> > Available Packages
>> > xorg-x11-drv-i810.i386                   1.6.5-9.13.el5         base
>> > xorg-x11-drv-i810-devel.x86_64           1.6.5-9.13.el5         base
>> > xorg-x11-drv-i810-devel.i386             1.6.5-9.13.el5         base
>> > xorg-x11-drv-via.i386                    0.2.1-9                base
>> > xorg-x11-drv-via-devel.i386              0.2.1-9                base
>> > xorg-x11-drv-via-devel.x86_64            0.2.1-9                base
>> > xorg-x11-fonts-ISO8859-14-100dpi.noarch  7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-14-75dpi.noarch   7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-15-100dpi.noarch  7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-15-75dpi.noarch   7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-2-100dpi.noarch   7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-2-75dpi.noarch    7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-9-100dpi.noarch   7.1-2.1.el5            base
>> > xorg-x11-fonts-ISO8859-9-75dpi.noarch    7.1-2.1.el5            base
>> > xorg-x11-fonts-cyrillic.noarch           7.1-2.1.el5            base
>> > xorg-x11-fonts-ethiopic.noarch           7.1-2.1.el5            base
>> > xorg-x11-fonts-syriac.noarch             7.1-2.1.el5            base
>> > xorg-x11-proto-devel.x86_64              7.1-9.el5.centos       base
>> > xorg-x11-proto-devel.i386                7.1-9.el5.centos       base
>> > xorg-x11-resutils.x86_64                 7.1-2.fc6              base
>> > xorg-x11-server-Xdmx.x86_64              1.1.1-48.41.el5_2.1    updates
>> > xorg-x11-server-Xephyr.x86_64            1.1.1-48.41.el5_2.1    updates
>> > xorg-x11-server-randr-source.x86_64      1.1.1-48.41.el5_2.1    updates
>> > xorg-x11-server-sdk.x86_64               1.1.1-48.41.el5_2.1    updates
>> > xorg-x11-util-macros.x86_64              1.0.2-4.fc6            base
>> > xorg-x11-xbitmaps.x86_64                 1.0.1-4.1              base
>> > xorg-x11-xfs-utils.x86_64                1:1.0.2-4              base
>> > xorg-x11-xfwp.x86_64                     1.0.1-3.1              base
>> > xorg-x11-xsm.x86_64                      1.0.2-4.fc6            base
>> > xorg-x11-xtrans-devel.x86_64             1.0.1-1.1.fc6          base
>> > xorg-x11-xtrans-devel.i386               1.0.1-1.1.fc6          base
>> > _________________________________________________________________
>> >
>> > of your life.
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> R-devel at r-project.org mailing list  DIGESTED
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>> End of R-devel Digest, Vol 68, Issue 4
>> **************************************
>
>


From edd at debian.org  Sun Oct  5 23:32:23 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 5 Oct 2008 16:32:23 -0500
Subject: [Rd] doc/manual/Rfaq.css missing in R 2.8.0 (20081005) tarball
Message-ID: <18665.12903.47773.855970@ron.nulle.part>


With the standard setup unchanged from 2.7.2, I am seeing

make[3]: Leaving directory `/tmp/buildd/r-base-2.8.0~20081005/po'
make[2]: Leaving directory `/tmp/buildd/r-base-2.8.0~20081005/po'
you should 'make docs' now ...
make[2]: Entering directory `/tmp/buildd/r-base-2.8.0~20081005/doc'
make[3]: Entering directory `/tmp/buildd/r-base-2.8.0~20081005/doc/manual'
make[3]: *** No rule to make target `Rfaq.css', needed by `R-FAQ.html'.  Stop.
make[3]: Leaving directory `/tmp/buildd/r-base-2.8.0~20081005/doc/manual'
make[2]: *** [docs] Error 2

and indeed, diff'ing Makefile.in reveals a new dependency on Rfaq.css 

@@ -249,6 +258,7 @@
 R-intro.html: $(texiincludes) $(srcdir)/Rman.css
 R-ints.html: $(texiincludes) $(srcdir)/Rman.css
 R-lang.html: $(texiincludes) $(srcdir)/Rman.css
+R-FAQ.html: $(srcdir)/Rfaq.css

 info: $(OBJECTS_INFO)
 R-admin.info: $(texiincludes)

which does not seem to be included.  Consequently none of the html manuals
are made.

Simply copying Rman.css to Rfaq.css fixes the bug but may not be what was
intended in terms of markup.

Dirk

-- 
Three out of two people have difficulties with fractions.


From p.dalgaard at biostat.ku.dk  Mon Oct  6 08:26:40 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon, 06 Oct 2008 08:26:40 +0200
Subject: [Rd] doc/manual/Rfaq.css missing in R 2.8.0 (20081005) tarball
In-Reply-To: <18665.12903.47773.855970@ron.nulle.part>
References: <18665.12903.47773.855970@ron.nulle.part>
Message-ID: <48E9AFA0.5010508@biostat.ku.dk>

Dirk Eddelbuettel wrote:
> With the standard setup unchanged from 2.7.2, I am seeing
>
> make[3]: Leaving directory `/tmp/buildd/r-base-2.8.0~20081005/po'
> make[2]: Leaving directory `/tmp/buildd/r-base-2.8.0~20081005/po'
> you should 'make docs' now ...
> make[2]: Entering directory `/tmp/buildd/r-base-2.8.0~20081005/doc'
> make[3]: Entering directory `/tmp/buildd/r-base-2.8.0~20081005/doc/manual'
> make[3]: *** No rule to make target `Rfaq.css', needed by `R-FAQ.html'.  Stop.
> make[3]: Leaving directory `/tmp/buildd/r-base-2.8.0~20081005/doc/manual'
> make[2]: *** [docs] Error 2
>
> and indeed, diff'ing Makefile.in reveals a new dependency on Rfaq.css 
>
> @@ -249,6 +258,7 @@
>  R-intro.html: $(texiincludes) $(srcdir)/Rman.css
>  R-ints.html: $(texiincludes) $(srcdir)/Rman.css
>  R-lang.html: $(texiincludes) $(srcdir)/Rman.css
> +R-FAQ.html: $(srcdir)/Rfaq.css
>
>  info: $(OBJECTS_INFO)
>  R-admin.info: $(texiincludes)
>
> which does not seem to be included.  Consequently none of the html manuals
> are made.
>
> Simply copying Rman.css to Rfaq.css fixes the bug but may not be what was
> intended in terms of markup.
>
> Dirk
>
>   
Good catch. Rfaq.css was in SVN but missing from DISTFILES in 
Makefile.in. Should pop up in tomorrows tarball.

(This is why I keep telling people to use tarballs rather than SVN 
checkouts for test builds and binary distributions.)

    -p

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From Thomas.Petzoldt at tu-dresden.de  Mon Oct  6 11:46:00 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Mon, 06 Oct 2008 11:46:00 +0200
Subject: [Rd] why is \alias{anRpackage} not mandatory?
Message-ID: <48E9DE58.6070303@tu-dresden.de>

Dear R developers,

if one uses package.skeleton() to create a new package, then a file 
anRpackage.Rd with the following entries is prepared:

\name{anRpackage-package}
\alias{anRpackage-package}
\alias{anRpackage}
\docType{package}


Packages created this way have a definite entry or overview page, so:

?anRpackage

gives new users of a certain package a pointer where to start reading.

This is similar for packages which have the same name as their main 
workhorse function, e.g. zoo or nlme, but there are many packages which 
don't have an \alias{anRpackage}.

"Writing R Extensions", sec. 2.1.4 says:

"Packages may have an overview man page with an \alias pkgname-package, 
e.g. `utils-package' for the utils package, when package?pkgname will 
open that help page. If a topic named pkgname does not exist in another 
Rd file, it is helpful to use this as an additional \alias."

My question: what speaks against making this sentence more pronounced 
and why not NOTE-ing a missing package alias in the package check?


Thomas Petzoldt



-- 
Thomas Petzoldt
Technische Universitaet Dresden
Institut fuer Hydrobiologie
01062 Dresden
GERMANY

http://tu-dresden.de/Members/thomas.petzoldt


From murdoch at stats.uwo.ca  Mon Oct  6 12:35:15 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Oct 2008 06:35:15 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48E9DE58.6070303@tu-dresden.de>
References: <48E9DE58.6070303@tu-dresden.de>
Message-ID: <48E9E9E3.90905@stats.uwo.ca>

Thomas Petzoldt wrote:
> Dear R developers,
>
> if one uses package.skeleton() to create a new package, then a file 
> anRpackage.Rd with the following entries is prepared:
>
> \name{anRpackage-package}
> \alias{anRpackage-package}
> \alias{anRpackage}
> \docType{package}
>
>
> Packages created this way have a definite entry or overview page, so:
>
> ?anRpackage
>
> gives new users of a certain package a pointer where to start reading.
>
> This is similar for packages which have the same name as their main 
> workhorse function, e.g. zoo or nlme, but there are many packages which 
> don't have an \alias{anRpackage}.
>
> "Writing R Extensions", sec. 2.1.4 says:
>
> "Packages may have an overview man page with an \alias pkgname-package, 
> e.g. `utils-package' for the utils package, when package?pkgname will 
> open that help page. If a topic named pkgname does not exist in another 
> Rd file, it is helpful to use this as an additional \alias."
>
> My question: what speaks against making this sentence more pronounced 
> and why not NOTE-ing a missing package alias in the package check?
>
>   
Not everybody likes the idea of the overview man page, so when I wrote 
that I left it weak.  Some of the disadvantages:

 - there are lots of packages without one, so this would create a lot of 
work for people to add them.

 - the ones that do exist tend to include outdated information.  People 
update the DESCRIPTION file but forget to update the corresponding 
information in the overview.

 - in general there's a lot of dissatisfaction with the Rd format, so 
there's reluctance to invest any more effort in it.

It would probably be a good idea to generate one automatically if not 
provided by the author, at build or install time:  this would address 
the first point.  I've been slowly working on some fixes that address 
the second point.  (The current idea is to use Sweave-like constructs to 
import things from the DESCRIPTION file at install time.)  There's no 
way to address the third point other than providing a better format, and 
I don't see any prospect of that happening.

Duncan Murdoch


From Thomas.Petzoldt at tu-dresden.de  Mon Oct  6 14:06:00 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Mon, 06 Oct 2008 14:06:00 +0200
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48E9E9E3.90905@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
Message-ID: <48E9FF28.6060207@tu-dresden.de>

Duncan Murdoch wrote:
> Thomas Petzoldt wrote:
>> Dear R developers,
>>
>> if one uses package.skeleton() to create a new package, then a file 
>> anRpackage.Rd with the following entries is prepared:
>>
>> \name{anRpackage-package}
>> \alias{anRpackage-package}
>> \alias{anRpackage}
>> \docType{package}
>>
>>
>> Packages created this way have a definite entry or overview page, so:
>>
>> ?anRpackage
>>
>> gives new users of a certain package a pointer where to start reading.
>>
>> This is similar for packages which have the same name as their main 
>> workhorse function, e.g. zoo or nlme, but there are many packages 
>> which don't have an \alias{anRpackage}.
>>
>> "Writing R Extensions", sec. 2.1.4 says:
>>
>> "Packages may have an overview man page with an \alias 
>> pkgname-package, e.g. `utils-package' for the utils package, when 
>> package?pkgname will open that help page. If a topic named pkgname 
>> does not exist in another Rd file, it is helpful to use this as an 
>> additional \alias."
>>
>> My question: what speaks against making this sentence more pronounced 
>> and why not NOTE-ing a missing package alias in the package check?
>>
>>   
> Not everybody likes the idea of the overview man page, so when I wrote 
> that I left it weak.  Some of the disadvantages:

You speak about the disadvantages but there are, of course, obvious 
advantages. Almost all scientific papers start with an abstract, why not 
requesting one for software packages, at least for new ones?

> - there are lots of packages without one, so this would create a lot of 
> work for people to add them.

No, I don't think that this is too much work. Positively speaking, it's 
one small contribution to bring more light into the exponentially 
growing haystack.

What about starting to advertise the use of \alias{anRpackage}, i.e. a 
short article in R News and subsequently an email to the developers.

> - the ones that do exist tend to include outdated information.  People 
> update the DESCRIPTION file but forget to update the corresponding 
> information in the overview.

This is in fact a problem. Suggestions:

- propose basic style guidelines (in an R-News article)
- allow variables in .Rd files (your idea to allow "Sweave like 
constructs" may be even better). In addition to entries from 
DESCRIPTION, one can think also about importing data from CITATION and 
possibly also from other resources.

> - in general there's a lot of dissatisfaction with the Rd format, so 
> there's reluctance to invest any more effort in it.

You are right, .Rd has its limitations, but as you say, there is nothing 
better available in the moment. (BTW: I heard rumours at useR! about 
discussions on a meta documentation format? Is there any public 
information about this??)

> It would probably be a good idea to generate one automatically if not 
> provided by the author, at build or install time:  this would address 
> the first point.  

A reasonable idea -- at least if combined with a motivating request to 
package authors to provide an own one.

> I've been slowly working on some fixes that address 
> the second point.  (The current idea is to use Sweave-like constructs to 
> import things from the DESCRIPTION file at install time.)  There's no 
> way to address the third point other than providing a better format, and 
> I don't see any prospect of that happening.

So if there are no advances in that direction I see no other choice than 
using the existing mechanisms! Recently, I had several contacts with 
package authors who were not even aware about the possibility of 
providing a package information .Rd file.

> Duncan Murdoch
> 

Thanks, Thomas P.


From murdoch at stats.uwo.ca  Mon Oct  6 14:47:05 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Oct 2008 08:47:05 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48E9FF28.6060207@tu-dresden.de>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
Message-ID: <48EA08C9.7050702@stats.uwo.ca>

On 06/10/2008 8:06 AM, Thomas Petzoldt wrote:
> Duncan Murdoch wrote:
>> Thomas Petzoldt wrote:
>>> Dear R developers,
>>>
>>> if one uses package.skeleton() to create a new package, then a file 
>>> anRpackage.Rd with the following entries is prepared:
>>>
>>> \name{anRpackage-package}
>>> \alias{anRpackage-package}
>>> \alias{anRpackage}
>>> \docType{package}
>>>
>>>
>>> Packages created this way have a definite entry or overview page, so:
>>>
>>> ?anRpackage
>>>
>>> gives new users of a certain package a pointer where to start reading.
>>>
>>> This is similar for packages which have the same name as their main 
>>> workhorse function, e.g. zoo or nlme, but there are many packages 
>>> which don't have an \alias{anRpackage}.
>>>
>>> "Writing R Extensions", sec. 2.1.4 says:
>>>
>>> "Packages may have an overview man page with an \alias 
>>> pkgname-package, e.g. `utils-package' for the utils package, when 
>>> package?pkgname will open that help page. If a topic named pkgname 
>>> does not exist in another Rd file, it is helpful to use this as an 
>>> additional \alias."
>>>
>>> My question: what speaks against making this sentence more pronounced 
>>> and why not NOTE-ing a missing package alias in the package check?
>>>
>>>   
>> Not everybody likes the idea of the overview man page, so when I wrote 
>> that I left it weak.  Some of the disadvantages:
> 
> You speak about the disadvantages but there are, of course, obvious 
> advantages. Almost all scientific papers start with an abstract, why not 
> requesting one for software packages, at least for new ones?

We already require one in the DESCRIPTION file for all packages, which 
you can see with

library(help=packagename)

This is related to my first two points:  people have already done this 
work so they are reluctant to do it again, and duplicate information is 
a bad idea.

I think the R help system is too fragmented:  it's hard to discover all 
the different types of help that are already there (Rd files, 
DESCRIPTION files, vignettes, the manuals, NEWS, CHANGES, ChangeLogs, 
SVN logs, source comments, mailing lists, web pages and publications, 
...).  I think having a ?packagename man page is a good place for a 
single starting point, and I consider packages without one to be poorly 
documented.  But obviously, not everyone agrees.

>> - there are lots of packages without one, so this would create a lot of 
>> work for people to add them.
> 
> No, I don't think that this is too much work. Positively speaking, it's 
> one small contribution to bring more light into the exponentially 
> growing haystack.

I agree, and I even added these to all the packages under my control: 
but there are hundreds of package authors, and some have different 
priorities than you and me.

> What about starting to advertise the use of \alias{anRpackage}, i.e. a 
> short article in R News and subsequently an email to the developers.

I would have thought that putting this into NEWS and Writing R 
Extensions was the right way to advertise it.  If people don't read 
those, why would you think they'll read R News?  But more is better, so 
go ahead and submit an article to R News.

I don't like robot mailings, so I wouldn't appreciate an email on this. 
  I don't recommend that you send one.


> 
>> - the ones that do exist tend to include outdated information.  People 
>> update the DESCRIPTION file but forget to update the corresponding 
>> information in the overview.
> 
> This is in fact a problem. Suggestions:
> 
> - propose basic style guidelines (in an R-News article)
> - allow variables in .Rd files (your idea to allow "Sweave like 
> constructs" may be even better). In addition to entries from 
> DESCRIPTION, one can think also about importing data from CITATION and 
> possibly also from other resources.
> 
>> - in general there's a lot of dissatisfaction with the Rd format, so 
>> there's reluctance to invest any more effort in it.
> 
> You are right, .Rd has its limitations, but as you say, there is nothing 
> better available in the moment. (BTW: I heard rumours at useR! about 
> discussions on a meta documentation format? Is there any public 
> information about this??)

I first heard proposals for a replacement format at DSC 2001.  I don't 
know of anything concrete.

Duncan Murdoch

> 
>> It would probably be a good idea to generate one automatically if not 
>> provided by the author, at build or install time:  this would address 
>> the first point.  
> 
> A reasonable idea -- at least if combined with a motivating request to 
> package authors to provide an own one.
> 
>> I've been slowly working on some fixes that address 
>> the second point.  (The current idea is to use Sweave-like constructs to 
>> import things from the DESCRIPTION file at install time.)  There's no 
>> way to address the third point other than providing a better format, and 
>> I don't see any prospect of that happening.
> 
> So if there are no advances in that direction I see no other choice than 
> using the existing mechanisms! Recently, I had several contacts with 
> package authors who were not even aware about the possibility of 
> providing a package information .Rd file.
> 
>> Duncan Murdoch
>>
> 
> Thanks, Thomas P.


From h.wickham at gmail.com  Mon Oct  6 14:59:58 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Mon, 6 Oct 2008 07:59:58 -0500
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48E9FF28.6060207@tu-dresden.de>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
Message-ID: <f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>

>> - there are lots of packages without one, so this would create a lot of
>> work for people to add them.
>
> No, I don't think that this is too much work. Positively speaking, it's one
> small contribution to bring more light into the exponentially growing
> haystack.

It may not be much work for you, but I find any additional
requirements to the package format to be a real pain.  I have ~10
packages on CRAN and having to go through and add this extra
information all at once is a big hassle.  R releases tend to happen in
the middle of the US academic semester when I have a lot of other
things on my plate.

Additionally, I find that rdoc is the wrong format for lengthy
explanation and exposition - a pdf is much better - and I think that
the packages already have a abstract: the description field in
DESCRIPTION.  The main problem with vignettes at the moment is that
they must be sweave, a format which I don't really like.  I wish I
could supply my own pdf + R code file produced using whatever tools I
choose.

Hadley



-- 
http://had.co.nz/


From h.wickham at gmail.com  Mon Oct  6 15:02:17 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Mon, 6 Oct 2008 08:02:17 -0500
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48E9FF28.6060207@tu-dresden.de>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
Message-ID: <f8e6ff050810060602i29b68595u2e5cf7064475d11@mail.gmail.com>

> You are right, .Rd has its limitations, but as you say, there is nothing
> better available in the moment. (BTW: I heard rumours at useR! about
> discussions on a meta documentation format? Is there any public information
> about this??)

What do you mean by meta documentation format?  Do you mean roxygen -
http://cran.r-project.org/web/packages/roxygen ?

Hadley

-- 
http://had.co.nz/


From Thomas.Petzoldt at tu-dresden.de  Mon Oct  6 15:32:53 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Mon, 06 Oct 2008 15:32:53 +0200
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EA08C9.7050702@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de>
	<48E9E9E3.90905@stats.uwo.ca>	<48E9FF28.6060207@tu-dresden.de>
	<48EA08C9.7050702@stats.uwo.ca>
Message-ID: <48EA1385.1080501@tu-dresden.de>

Duncan Murdoch wrote:
> On 06/10/2008 8:06 AM, Thomas Petzoldt wrote:
>> Duncan Murdoch wrote:
>>> Thomas Petzoldt wrote:
>>>> Dear R developers,
>>>>
>>>> if one uses package.skeleton() to create a new package, then a file 
>>>> anRpackage.Rd with the following entries is prepared:
>>>>
>>>> \name{anRpackage-package}
>>>> \alias{anRpackage-package}
>>>> \alias{anRpackage}
>>>> \docType{package}
>>>>
>>>>
>>>> Packages created this way have a definite entry or overview page, so:
>>>>
>>>> ?anRpackage
>>>>
>>>> gives new users of a certain package a pointer where to start reading.
>>>>
>>>> This is similar for packages which have the same name as their main 
>>>> workhorse function, e.g. zoo or nlme, but there are many packages 
>>>> which don't have an \alias{anRpackage}.
>>>>
>>>> "Writing R Extensions", sec. 2.1.4 says:
>>>>
>>>> "Packages may have an overview man page with an \alias 
>>>> pkgname-package, e.g. `utils-package' for the utils package, when 
>>>> package?pkgname will open that help page. If a topic named pkgname 
>>>> does not exist in another Rd file, it is helpful to use this as an 
>>>> additional \alias."
>>>>
>>>> My question: what speaks against making this sentence more 
>>>> pronounced and why not NOTE-ing a missing package alias in the 
>>>> package check?
>>>>
>>>>   
>>> Not everybody likes the idea of the overview man page, so when I 
>>> wrote that I left it weak.  Some of the disadvantages:
>>
>> You speak about the disadvantages but there are, of course, obvious 
>> advantages. Almost all scientific papers start with an abstract, why 
>> not requesting one for software packages, at least for new ones?
> 
> We already require one in the DESCRIPTION file for all packages, which 
> you can see with
> 
> library(help=packagename)
> 
> This is related to my first two points:  people have already done this 
> work so they are reluctant to do it again, and duplicate information is 
> a bad idea.


I agree, and I also don't like duplicate inconsistent "information", but 
simply try the following:

options(htmlhelp=TRUE)
library(help="base")

The result is now displayed in text format and new users don't know how 
to proceed. I say new users, because an experienced user knows what to 
do ... and if nothing helps he makes a grep over the sources.

> I think the R help system is too fragmented:  it's hard to discover all 
> the different types of help that are already there (Rd files, 
> DESCRIPTION files, vignettes, the manuals, NEWS, CHANGES, ChangeLogs, 
> SVN logs, source comments, mailing lists, web pages and publications, 
> ...).  I think having a ?packagename man page is a good place for a 
> single starting point, and I consider packages without one to be poorly 
> documented.  But obviously, not everyone agrees.

*I* agree -- completely with the that paragraph.

>>> - there are lots of packages without one, so this would create a lot 
>>> of work for people to add them.
>>
>> No, I don't think that this is too much work. Positively speaking, 
>> it's one small contribution to bring more light into the exponentially 
>> growing haystack.
> 
> I agree, and I even added these to all the packages under my control: 
> but there are hundreds of package authors, and some have different 
> priorities than you and me.

O.K., I see, so I suggest to add an additional motivating sentence to:

http://developer.r-project.org/Rds.html

and possibly an automatism that shows (or converts) the output of

library(help="foo")

to a formatted page in the appropriate help format (e.g. html).

>> What about starting to advertise the use of \alias{anRpackage}, i.e. a 
>> short article in R News and subsequently an email to the developers.
> 
> I would have thought that putting this into NEWS and Writing R 
> Extensions was the right way to advertise it.  If people don't read 
> those, why would you think they'll read R News?  But more is better, so 
> go ahead and submit an article to R News.

People like me may read "Writing R Extensions" several times and then 
have a look into some of the most prominent packages and get insecure, 
as only few use this mechanism.

> I don't like robot mailings, so I wouldn't appreciate an email on this. 
>  I don't recommend that you send one.

Beware, not at all! But I think it was good to open this thread on 
r-devel  :-)

>>
>>> - the ones that do exist tend to include outdated information.  
>>> People update the DESCRIPTION file but forget to update the 
>>> corresponding information in the overview.
>>
>> This is in fact a problem. Suggestions:
>>
>> - propose basic style guidelines (in an R-News article)
>> - allow variables in .Rd files (your idea to allow "Sweave like 
>> constructs" may be even better). In addition to entries from 
>> DESCRIPTION, one can think also about importing data from CITATION and 
>> possibly also from other resources.
>>
>>> - in general there's a lot of dissatisfaction with the Rd format, so 
>>> there's reluctance to invest any more effort in it.
>>
>> You are right, .Rd has its limitations, but as you say, there is 
>> nothing better available in the moment. (BTW: I heard rumours at useR! 
>> about discussions on a meta documentation format? Is there any public 
>> information about this??)
> 
> I first heard proposals for a replacement format at DSC 2001.  I don't 
> know of anything concrete.
> 
> Duncan Murdoch

Not concrete. I don't even know if these rumours were related to 
something like Roxygen, extensions of a new DESCRIPTION format handling 
more automated processing on CRAN (e.g. evaluation by Taskview authors) 
or discussion about the list of keywords, but I'm sure that there are 
several points that need strategic discussion between core and "the 
developer base", including a pragmatic way to finalize conclusions.

>>
>>> It would probably be a good idea to generate one automatically if not 
>>> provided by the author, at build or install time:  this would address 
>>> the first point.  
>>
>> A reasonable idea -- at least if combined with a motivating request to 
>> package authors to provide an own one.
>>
>>> I've been slowly working on some fixes that address the second 
>>> point.  (The current idea is to use Sweave-like constructs to import 
>>> things from the DESCRIPTION file at install time.)  There's no way to 
>>> address the third point other than providing a better format, and I 
>>> don't see any prospect of that happening.
>>
>> So if there are no advances in that direction I see no other choice 
>> than using the existing mechanisms! Recently, I had several contacts 
>> with package authors who were not even aware about the possibility of 
>> providing a package information .Rd file.
>>
>>> Duncan Murdoch
>>>
>>
>> Thanks, Thomas P.
> 

Thomas P.


From Thomas.Petzoldt at tu-dresden.de  Mon Oct  6 15:42:13 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Mon, 06 Oct 2008 15:42:13 +0200
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>	
	<48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
Message-ID: <48EA15B5.8020800@tu-dresden.de>

Dear Hadley,

thank you very much for your comments.

hadley wickham wrote:
>>> - there are lots of packages without one, so this would create a lot of
>>> work for people to add them.
>> No, I don't think that this is too much work. Positively speaking, it's one
>> small contribution to bring more light into the exponentially growing
>> haystack.
> 
> It may not be much work for you, but I find any additional
> requirements to the package format to be a real pain.  I have ~10
> packages on CRAN and having to go through and add this extra
> information all at once is a big hassle.  R releases tend to happen in
> the middle of the US academic semester when I have a lot of other
> things on my plate.

O.K., but the discussion with Duncan shows:

- the required information is already available (in DESCRIPTION),
- one can think about ways to generate the page automatically for 
existing packages,
- the intro can be short and should link to other pages or PDFs,
- one should avoid doubling and inconsistency.

> Additionally, I find that rdoc is the wrong format for lengthy
> explanation and exposition - a pdf is much better - and I think that
> the packages already have a abstract: the description field in
> DESCRIPTION.  

o.k., but abstract may be (technically) in the wrong format and does not 
point to the other relevant parts of the package documentation.

> The main problem with vignettes at the moment is that
> they must be sweave, a format which I don't really like.  I wish I
> could supply my own pdf + R code file produced using whatever tools I
> choose.
>
 > Hadley

I like Sweave, and it is also possible to include your own PDFs and R 
files and then to reference them in anRpackage.Rd.

Thomas P.


From h.wickham at gmail.com  Mon Oct  6 15:55:14 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Mon, 6 Oct 2008 08:55:14 -0500
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EA15B5.8020800@tu-dresden.de>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
	<48EA15B5.8020800@tu-dresden.de>
Message-ID: <f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>

>> It may not be much work for you, but I find any additional
>> requirements to the package format to be a real pain.  I have ~10
>> packages on CRAN and having to go through and add this extra
>> information all at once is a big hassle.  R releases tend to happen in
>> the middle of the US academic semester when I have a lot of other
>> things on my plate.
>
> O.K., but the discussion with Duncan shows:
>
> - the required information is already available (in DESCRIPTION),
> - one can think about ways to generate the page automatically for existing
> packages,
> - the intro can be short and should link to other pages or PDFs,
> - one should avoid doubling and inconsistency.

I'm obviously not going to object if it's done automatically, and I
already strive to avoid doubling and inconsistency by producing most
my documentation algorithmically.  I think you are being cavalier by
not caring about the extra work you want package authors to do.

>> Additionally, I find that rdoc is the wrong format for lengthy
>> explanation and exposition - a pdf is much better - and I think that
>> the packages already have a abstract: the description field in
>> DESCRIPTION.
>
> o.k., but abstract may be (technically) in the wrong format and does not
> point to the other relevant parts of the package documentation.

Then I don't think you should call what you want an abstract.

>> The main problem with vignettes at the moment is that
>> they must be sweave, a format which I don't really like.  I wish I
>> could supply my own pdf + R code file produced using whatever tools I
>> choose.
>
> I like Sweave, and it is also possible to include your own PDFs and R files
> and then to reference them in anRpackage.Rd.

Yes, but they're not vignettes - which means they're not listed under
vignette() and it's yet another place for people to look for
documentation.

Hadley


-- 
http://had.co.nz/


From murdoch at stats.uwo.ca  Mon Oct  6 16:22:38 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Oct 2008 10:22:38 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de>
	<48E9E9E3.90905@stats.uwo.ca>	<48E9FF28.6060207@tu-dresden.de>	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
Message-ID: <48EA1F2E.1060207@stats.uwo.ca>

On 10/6/2008 9:55 AM, hadley wickham wrote:
>>> It may not be much work for you, but I find any additional
>>> requirements to the package format to be a real pain.  I have ~10
>>> packages on CRAN and having to go through and add this extra
>>> information all at once is a big hassle.  R releases tend to happen in
>>> the middle of the US academic semester when I have a lot of other
>>> things on my plate.
>>
>> O.K., but the discussion with Duncan shows:
>>
>> - the required information is already available (in DESCRIPTION),
>> - one can think about ways to generate the page automatically for existing
>> packages,
>> - the intro can be short and should link to other pages or PDFs,
>> - one should avoid doubling and inconsistency.
> 
> I'm obviously not going to object if it's done automatically, and I
> already strive to avoid doubling and inconsistency by producing most
> my documentation algorithmically.  I think you are being cavalier by
> not caring about the extra work you want package authors to do.
> 
>>> Additionally, I find that rdoc is the wrong format for lengthy
>>> explanation and exposition - a pdf is much better - and I think that
>>> the packages already have a abstract: the description field in
>>> DESCRIPTION.
>>
>> o.k., but abstract may be (technically) in the wrong format and does not
>> point to the other relevant parts of the package documentation.
> 
> Then I don't think you should call what you want an abstract.
> 
>>> The main problem with vignettes at the moment is that
>>> they must be sweave, a format which I don't really like.  I wish I
>>> could supply my own pdf + R code file produced using whatever tools I
>>> choose.
>>
>> I like Sweave, and it is also possible to include your own PDFs and R files
>> and then to reference them in anRpackage.Rd.
> 
> Yes, but they're not vignettes - which means they're not listed under
> vignette() and it's yet another place for people to look for
> documentation.

Vignettes have R code in them and a way to extract it, so it's 
misleading to call something that's just a .pdf file a vignette.  But I 
imagine there could be other ways to mix R code with documentation 
besides the existing Sweave formats.  The most obvious way to add 
another one is to write another Sweave driver.  I think it would require 
changes to the base of R to allow for Sweave drivers in packages, 
working with files that don't have extensions (R|r|S|s)(nw|tex), but in 
principle I don't see any real objection to adding that.

Duncan Murdoch


From Thomas.Petzoldt at tu-dresden.de  Mon Oct  6 16:34:57 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Mon, 06 Oct 2008 16:34:57 +0200
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de>
	<48E9E9E3.90905@stats.uwo.ca>	<48E9FF28.6060207@tu-dresden.de>	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
Message-ID: <48EA2211.4020003@tu-dresden.de>

hadley wickham wrote:
>>> It may not be much work for you, but I find any additional
>>> requirements to the package format to be a real pain.  I have ~10
>>> packages on CRAN and having to go through and add this extra
>>> information all at once is a big hassle.  R releases tend to happen in
>>> the middle of the US academic semester when I have a lot of other
>>> things on my plate.
>> O.K., but the discussion with Duncan shows:
>>
>> - the required information is already available (in DESCRIPTION),
>> - one can think about ways to generate the page automatically for existing
>> packages,
>> - the intro can be short and should link to other pages or PDFs,
>> - one should avoid doubling and inconsistency.
> 
> I'm obviously not going to object if it's done automatically, and I
> already strive to avoid doubling and inconsistency by producing most
> my documentation algorithmically.  I think you are being cavalier by
> not caring about the extra work you want package authors to do.

Sorry if my question was misunderstood this way, but I have not 
requested additional work, I simply asked "why is \alias{anRpackage} not 
mandatory?"

The answer was, that they are problems with inconsistencies that can be 
technically solved and that it may be too much work for some package 
authors with lots of packages (can also be solved with technical means), 
but that other users and developers would enjoy it to have such a 
starting point.

O.K., I agree that the suggestion of NOTE-ing a missing 
\alias{anRpackage} during package check was a bad idea (currently ;-), 
but that one can think about a combination of a technical means and an 
optional entry, analogously to the CITATION file.

> 
>>> Additionally, I find that rdoc is the wrong format for lengthy
>>> explanation and exposition - a pdf is much better - and I think that
>>> the packages already have a abstract: the description field in
>>> DESCRIPTION.
>> o.k., but abstract may be (technically) in the wrong format and does not
>> point to the other relevant parts of the package documentation.
> 
> Then I don't think you should call what you want an abstract.

Some sort of abstract, overview or, more precise, an *entry point*.

>>> The main problem with vignettes at the moment is that
>>> they must be sweave, a format which I don't really like.  I wish I
>>> could supply my own pdf + R code file produced using whatever tools I
>>> choose.
>> I like Sweave, and it is also possible to include your own PDFs and R files
>> and then to reference them in anRpackage.Rd.
> 
> Yes, but they're not vignettes - which means they're not listed under
> vignette() and it's yet another place for people to look for
> documentation.

You are right, they are not vignettes in the strict sense, but they can 
be listed in the help index of the package, the place where the majority 
of "normal R users" starts to look.


ThPe


From mwtoews at sfu.ca  Mon Oct  6 16:40:03 2008
From: mwtoews at sfu.ca (mwtoews at sfu.ca)
Date: Mon,  6 Oct 2008 16:40:03 +0200 (CEST)
Subject: [Rd] Bug with message if there is no documentation;
	R2.8alpha Win32 (PR#13131)
Message-ID: <20081006144004.59A9C282C763@mail.pubhealth.ku.dk>

In the latest R 2.8 alpha for Win32, if either of the commands are typed:
> help("erfc")
.. or ..
> ?erfc
the result is:
No documentation for 'erfc' in specified packages and libraries:
you could try '??erfc'

This should be: 'help.search("erfc")', as shown in R 2.7.2
Apologies if this has already been submitted/fixed.
-Mike

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = alpha
 major = 2
 minor = 8.0
 year = 2008
 month = 10
 day = 03
 svn rev = 46594
 language = R
 version.string = R version 2.8.0 alpha (2008-10-03 r46594)

Windows XP (build 2600) Service Pack 3

Locale:
LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices,
package:utils, package:datasets, package:methods, Autoloads, package:base


From simon.urbanek at r-project.org  Mon Oct  6 17:00:51 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 6 Oct 2008 11:00:51 -0400
Subject: [Rd] ?foo to fall back to help(package="foo") [Was: why is
	\alias{anRpackage} not mandatory?]
In-Reply-To: <48EA08C9.7050702@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de> <48EA08C9.7050702@stats.uwo.ca>
Message-ID: <E3BB2C40-8536-4F89-A9BB-2EEE92E252B2@r-project.org>


On Oct 6, 2008, at 8:47 , Duncan Murdoch wrote:

> On 06/10/2008 8:06 AM, Thomas Petzoldt wrote:
>> Duncan Murdoch wrote:
>>> Thomas Petzoldt wrote:
>>>> Dear R developers,
>>>>
>>>> if one uses package.skeleton() to create a new package, then a  
>>>> file anRpackage.Rd with the following entries is prepared:
>>>>
>>>> \name{anRpackage-package}
>>>> \alias{anRpackage-package}
>>>> \alias{anRpackage}
>>>> \docType{package}
>>>>
>>>>
>>>> Packages created this way have a definite entry or overview page,  
>>>> so:
>>>>
>>>> ?anRpackage
>>>>
>>>> gives new users of a certain package a pointer where to start  
>>>> reading.
>>>>
>>>> This is similar for packages which have the same name as their  
>>>> main workhorse function, e.g. zoo or nlme, but there are many  
>>>> packages which don't have an \alias{anRpackage}.
>>>>
>>>> "Writing R Extensions", sec. 2.1.4 says:
>>>>
>>>> "Packages may have an overview man page with an \alias pkgname- 
>>>> package, e.g. `utils-package' for the utils package, when package? 
>>>> pkgname will open that help page. If a topic named pkgname does  
>>>> not exist in another Rd file, it is helpful to use this as an  
>>>> additional \alias."
>>>>
>>>> My question: what speaks against making this sentence more  
>>>> pronounced and why not NOTE-ing a missing package alias in the  
>>>> package check?
>>>>
>>>>
>>> Not everybody likes the idea of the overview man page, so when I  
>>> wrote that I left it weak.  Some of the disadvantages:
>> You speak about the disadvantages but there are, of course, obvious  
>> advantages. Almost all scientific papers start with an abstract,  
>> why not requesting one for software packages, at least for new ones?
>
> We already require one in the DESCRIPTION file for all packages,  
> which you can see with
>
> library(help=packagename)
>

Yes, but this is way too long to write - could we add a fall-back so  
that if ?foo alias doesn't exist but package foo does then ?foo is  
equivalent to help(package="foo")? At least for the way I use help it  
would help a lot...

Cheers,
S


> This is related to my first two points:  people have already done  
> this work so they are reluctant to do it again, and duplicate  
> information is a bad idea.
>
> I think the R help system is too fragmented:  it's hard to discover  
> all the different types of help that are already there (Rd files,  
> DESCRIPTION files, vignettes, the manuals, NEWS, CHANGES,  
> ChangeLogs, SVN logs, source comments, mailing lists, web pages and  
> publications, ...).  I think having a ?packagename man page is a  
> good place for a single starting point, and I consider packages  
> without one to be poorly documented.  But obviously, not everyone  
> agrees.
>
>>> - there are lots of packages without one, so this would create a  
>>> lot of work for people to add them.
>> No, I don't think that this is too much work. Positively speaking,  
>> it's one small contribution to bring more light into the  
>> exponentially growing haystack.
>
> I agree, and I even added these to all the packages under my  
> control: but there are hundreds of package authors, and some have  
> different priorities than you and me.
>
>> What about starting to advertise the use of \alias{anRpackage},  
>> i.e. a short article in R News and subsequently an email to the  
>> developers.
>
> I would have thought that putting this into NEWS and Writing R  
> Extensions was the right way to advertise it.  If people don't read  
> those, why would you think they'll read R News?  But more is better,  
> so go ahead and submit an article to R News.
>
> I don't like robot mailings, so I wouldn't appreciate an email on  
> this.  I don't recommend that you send one.
>
>
>>> - the ones that do exist tend to include outdated information.   
>>> People update the DESCRIPTION file but forget to update the  
>>> corresponding information in the overview.
>> This is in fact a problem. Suggestions:
>> - propose basic style guidelines (in an R-News article)
>> - allow variables in .Rd files (your idea to allow "Sweave like  
>> constructs" may be even better). In addition to entries from  
>> DESCRIPTION, one can think also about importing data from CITATION  
>> and possibly also from other resources.
>>> - in general there's a lot of dissatisfaction with the Rd format,  
>>> so there's reluctance to invest any more effort in it.
>> You are right, .Rd has its limitations, but as you say, there is  
>> nothing better available in the moment. (BTW: I heard rumours at  
>> useR! about discussions on a meta documentation format? Is there  
>> any public information about this??)
>
> I first heard proposals for a replacement format at DSC 2001.  I  
> don't know of anything concrete.
>
> Duncan Murdoch
>
>>> It would probably be a good idea to generate one automatically if  
>>> not provided by the author, at build or install time:  this would  
>>> address the first point.
>> A reasonable idea -- at least if combined with a motivating request  
>> to package authors to provide an own one.
>>> I've been slowly working on some fixes that address the second  
>>> point.  (The current idea is to use Sweave-like constructs to  
>>> import things from the DESCRIPTION file at install time.)  There's  
>>> no way to address the third point other than providing a better  
>>> format, and I don't see any prospect of that happening.
>> So if there are no advances in that direction I see no other choice  
>> than using the existing mechanisms! Recently, I had several  
>> contacts with package authors who were not even aware about the  
>> possibility of providing a package information .Rd file.
>>> Duncan Murdoch
>>>
>> Thanks, Thomas P.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Mon Oct  6 17:18:33 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Oct 2008 11:18:33 -0400
Subject: [Rd] ?foo to fall back to help(package="foo") [Was: why is
 \alias{anRpackage} not mandatory?]
In-Reply-To: <E3BB2C40-8536-4F89-A9BB-2EEE92E252B2@r-project.org>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de> <48EA08C9.7050702@stats.uwo.ca>
	<E3BB2C40-8536-4F89-A9BB-2EEE92E252B2@r-project.org>
Message-ID: <48EA2C49.4090005@stats.uwo.ca>

On 10/6/2008 11:00 AM, Simon Urbanek wrote:
> On Oct 6, 2008, at 8:47 , Duncan Murdoch wrote:
> 
>> On 06/10/2008 8:06 AM, Thomas Petzoldt wrote:
>>> Duncan Murdoch wrote:
>>>> Thomas Petzoldt wrote:
>>>>> Dear R developers,
>>>>>
>>>>> if one uses package.skeleton() to create a new package, then a  
>>>>> file anRpackage.Rd with the following entries is prepared:
>>>>>
>>>>> \name{anRpackage-package}
>>>>> \alias{anRpackage-package}
>>>>> \alias{anRpackage}
>>>>> \docType{package}
>>>>>
>>>>>
>>>>> Packages created this way have a definite entry or overview page,  
>>>>> so:
>>>>>
>>>>> ?anRpackage
>>>>>
>>>>> gives new users of a certain package a pointer where to start  
>>>>> reading.
>>>>>
>>>>> This is similar for packages which have the same name as their  
>>>>> main workhorse function, e.g. zoo or nlme, but there are many  
>>>>> packages which don't have an \alias{anRpackage}.
>>>>>
>>>>> "Writing R Extensions", sec. 2.1.4 says:
>>>>>
>>>>> "Packages may have an overview man page with an \alias pkgname- 
>>>>> package, e.g. `utils-package' for the utils package, when package? 
>>>>> pkgname will open that help page. If a topic named pkgname does  
>>>>> not exist in another Rd file, it is helpful to use this as an  
>>>>> additional \alias."
>>>>>
>>>>> My question: what speaks against making this sentence more  
>>>>> pronounced and why not NOTE-ing a missing package alias in the  
>>>>> package check?
>>>>>
>>>>>
>>>> Not everybody likes the idea of the overview man page, so when I  
>>>> wrote that I left it weak.  Some of the disadvantages:
>>> You speak about the disadvantages but there are, of course, obvious  
>>> advantages. Almost all scientific papers start with an abstract,  
>>> why not requesting one for software packages, at least for new ones?
>>
>> We already require one in the DESCRIPTION file for all packages,  
>> which you can see with
>>
>> library(help=packagename)
>>
> 
> Yes, but this is way too long to write - could we add a fall-back so  
> that if ?foo alias doesn't exist but package foo does then ?foo is  
> equivalent to help(package="foo")? At least for the way I use help it  
> would help a lot...

?foo and help("foo") return an object with a class whose print method 
displays the help.  So doing this would require a new class with a 
different print method.  It seems cleaner to me to ask people to provide 
the ?foo topic within the existing system, as we do now, or to produce 
the topic automatically at install time, so it works within the existing 
system.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Mon Oct  6 17:21:40 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 6 Oct 2008 16:21:40 +0100 (BST)
Subject: [Rd] Bug with message if there is no documentation;
 R2.8alpha Win32 (PR#13131)
In-Reply-To: <20081006144004.59A9C282C763@mail.pubhealth.ku.dk>
References: <20081006144004.59A9C282C763@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810061616560.27253@gannet.stats.ox.ac.uk>

On Mon, 6 Oct 2008, mwtoews at sfu.ca wrote:

> In the latest R 2.8 alpha for Win32, if either of the commands are typed:
>> help("erfc")
> .. or ..
>> ?erfc
> the result is:
> No documentation for 'erfc' in specified packages and libraries:
> you could try '??erfc'
>
> This should be: 'help.search("erfc")', as shown in R 2.7.2

Why do you think so?  From the NEWS

     o	??topic now does help.search("topic"); variations such as
 	??pkg::topic or field??topic are also supported.

> Apologies if this has already been submitted/fixed.

Please ask on R-devel about unreleased versions of R:  from 
http://cran.r-project.org/bin/windows/base/rtest.html

   'Please don't report bugs in this version through the usual R bug
   reporting system, please report them on the r-devel mailing list.'


> -Mike
>
> --please do not edit the information below--
>
> Version:
> platform = i386-pc-mingw32
> arch = i386
> os = mingw32
> system = i386, mingw32
> status = alpha
> major = 2
> minor = 8.0
> year = 2008
> month = 10
> day = 03
> svn rev = 46594
> language = R
> version.string = R version 2.8.0 alpha (2008-10-03 r46594)
>
> Windows XP (build 2600) Service Pack 3
>
> Locale:
> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
>
> Search Path:
> .GlobalEnv, package:stats, package:graphics, package:grDevices,
> package:utils, package:datasets, package:methods, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From simon.urbanek at r-project.org  Mon Oct  6 17:29:03 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 6 Oct 2008 11:29:03 -0400
Subject: [Rd] ?foo to fall back to help(package="foo") [Was: why is
	\alias{anRpackage} not mandatory?]
In-Reply-To: <48EA2C49.4090005@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de> <48EA08C9.7050702@stats.uwo.ca>
	<E3BB2C40-8536-4F89-A9BB-2EEE92E252B2@r-project.org>
	<48EA2C49.4090005@stats.uwo.ca>
Message-ID: <D10345B1-804D-4854-AAD3-04D2CA9F965B@r-project.org>


On Oct 6, 2008, at 11:18 , Duncan Murdoch wrote:

> On 10/6/2008 11:00 AM, Simon Urbanek wrote:
>> On Oct 6, 2008, at 8:47 , Duncan Murdoch wrote:
>>> On 06/10/2008 8:06 AM, Thomas Petzoldt wrote:
>>>> Duncan Murdoch wrote:
>>>>> Thomas Petzoldt wrote:
>>>>>> Dear R developers,
>>>>>>
>>>>>> if one uses package.skeleton() to create a new package, then a   
>>>>>> file anRpackage.Rd with the following entries is prepared:
>>>>>>
>>>>>> \name{anRpackage-package}
>>>>>> \alias{anRpackage-package}
>>>>>> \alias{anRpackage}
>>>>>> \docType{package}
>>>>>>
>>>>>>
>>>>>> Packages created this way have a definite entry or overview  
>>>>>> page,  so:
>>>>>>
>>>>>> ?anRpackage
>>>>>>
>>>>>> gives new users of a certain package a pointer where to start   
>>>>>> reading.
>>>>>>
>>>>>> This is similar for packages which have the same name as their   
>>>>>> main workhorse function, e.g. zoo or nlme, but there are many   
>>>>>> packages which don't have an \alias{anRpackage}.
>>>>>>
>>>>>> "Writing R Extensions", sec. 2.1.4 says:
>>>>>>
>>>>>> "Packages may have an overview man page with an \alias pkgname-  
>>>>>> package, e.g. `utils-package' for the utils package, when  
>>>>>> package? pkgname will open that help page. If a topic named  
>>>>>> pkgname does  not exist in another Rd file, it is helpful to  
>>>>>> use this as an  additional \alias."
>>>>>>
>>>>>> My question: what speaks against making this sentence more   
>>>>>> pronounced and why not NOTE-ing a missing package alias in the   
>>>>>> package check?
>>>>>>
>>>>>>
>>>>> Not everybody likes the idea of the overview man page, so when  
>>>>> I  wrote that I left it weak.  Some of the disadvantages:
>>>> You speak about the disadvantages but there are, of course,  
>>>> obvious  advantages. Almost all scientific papers start with an  
>>>> abstract,  why not requesting one for software packages, at least  
>>>> for new ones?
>>>
>>> We already require one in the DESCRIPTION file for all packages,   
>>> which you can see with
>>>
>>> library(help=packagename)
>>>
>> Yes, but this is way too long to write - could we add a fall-back  
>> so  that if ?foo alias doesn't exist but package foo does then ?foo  
>> is  equivalent to help(package="foo")? At least for the way I use  
>> help it  would help a lot...
>
> ?foo and help("foo") return an object with a class whose print  
> method displays the help.  So doing this would require a new class  
> with a different print method.  It seems cleaner to me to ask people  
> to provide the ?foo topic within the existing system, as we do now,

... which doesn't seem to work - that's why we have the discussion ;).


> or to produce the topic automatically at install time, so it works  
> within the existing system.
>

... which if ok with me - that would fit the bill ...

Thanks,
Simon


From Greg.Snow at imail.org  Mon Oct  6 19:50:13 2008
From: Greg.Snow at imail.org (Greg.Snow at imail.org)
Date: Mon,  6 Oct 2008 19:50:13 +0200 (CEST)
Subject: [Rd] splinefun gives incorrect derivs when extrapolating to the
	left (PR#13132)
Message-ID: <20081006175013.5D145282EF48@mail.pubhealth.ku.dk>

This is a low priority bug that has been around for a while, but I came acr=
oss it again while alpha testing 2.8.

The resulting function for splinefun gives incorrect deriv values when x is=
 less than the smallest x-value used to create the function (at least in on=
e circumstance), but does the correct thing for x greater than the largest =
x-value.

Here is an example:

> x <- 1:10
> y <- sin(x)
>
> splfun <- splinefun(x,y, method=3D'natural')
>
> # these should be linear (and are)
> splfun( seq(0,1, 0.1) )
 [1] 0.5682923 0.5956102 0.6229280 0.6502459 0.6775638 0.7048816 0.7321995
 [8] 0.7595174 0.7868352 0.8141531 0.8414710
>
> # these should all be the same
> splfun( seq(0,1, 0.1), deriv=3D1 )
 [1] -0.34287807 -0.22582729 -0.12109764 -0.02868912  0.05139826  0.1191645=
1
 [7]  0.17460962  0.21773359  0.24853643  0.26701813  0.27317870
>
> # these should all be 0
> splfun( seq(0,1, 0.1), deriv=3D2 )
 [1] 1.2321135 1.1089022 0.9856908 0.8624795 0.7392681 0.6160568 0.4928454
 [8] 0.3696341 0.2464227 0.1232114 0.0000000
> splfun( seq(0,1, 0.1), deriv=3D3 )
 [1] -1.232114 -1.232114 -1.232114 -1.232114 -1.232114 -1.232114 -1.232114
 [8] -1.232114 -1.232114 -1.232114 -1.232114
>
>
> # everything works like it should on the right end
> splfun( seq(10,11, 0.1) )
 [1] -0.5440211 -0.6444546 -0.7448881 -0.8453215 -0.9457550 -1.0461885
 [7] -1.1466220 -1.2470554 -1.3474889 -1.4479224 -1.5483559
> splfun( seq(10,11, 0.1), deriv=3D1 )
 [1] -1.004335 -1.004335 -1.004335 -1.004335 -1.004335 -1.004335 -1.004335
 [8] -1.004335 -1.004335 -1.004335 -1.004335
> splfun( seq(10,11, 0.1), deriv=3D2 )
 [1] 0 0 0 0 0 0 0 0 0 0 0
> splfun( seq(10,11, 0.1), deriv=3D3 )
 [1] 0 0 0 0 0 0 0 0 0 0 0
>


--please do not edit the information below--

Version:
 platform =3D i386-pc-mingw32
 arch =3D i386
 os =3D mingw32
 system =3D i386, mingw32
 status =3D alpha
 major =3D 2
 minor =3D 8.0
 year =3D 2008
 month =3D 10
 day =3D 01
 svn rev =3D 46589
 language =3D R
 version.string =3D R version 2.8.0 alpha (2008-10-01 r46589)

Windows XP (build 2600) Service Pack 3

Locale:
LC_COLLATE=3DEnglish_United States.1252;LC_CTYPE=3DEnglish_United States.12=
52;LC_MONETARY=3DEnglish_United States.1252;LC_NUMERIC=3DC;LC_TIME=3DEnglis=
h_United States.1252

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices, package:ut=
ils, package:datasets, package:methods, Autoloads, package:base



--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


From thomas.baier at logicals.com  Tue Oct  7 09:29:43 2008
From: thomas.baier at logicals.com (Thomas Baier)
Date: Tue, 7 Oct 2008 09:29:43 +0200 
Subject: [Rd] LinkingTo on Windows
Message-ID: <405593F1A35DDD11B2B4000C29F5CF530344DE@exchange-server.ow.ks>

Dear List,

R packages may specify a "LinkingTo" attribute to specify dependencies to
the source code (mainly the header files) of other packages. 

Unfortunately, it is not possible to also have a reference to the generated
library (.dll on Windows) of the other package. So including a header file
from another package to call an (exported) function will just not help. 

I've tried to implement a workaround for my package rcom (depending on
exported functions from rscproxy) by "manually" setting the library when
linking, but unfortunately this does not work for me, when rscproxy gets
installed into a different library (not the default one). OK, I could set
the library path relative to the source drive and absolute for the standard
library, so the "R CMD check" on CRAN is passed, but I don't think this
would be a good solution. 

Of course, I could implement true dynamic binding by getting a handle to the
rscproxy.dll (which already has been loaded at the time of loading rcom) and
getting out procedure addresses, but I don't think this is a good (general
and portable) solution either. 

How can this issue be addressed? How can I solve the problem of linking to
another package's library (if possible by just using "LinkingTo")

Best regards,
Thomas Baier


From nlemeur at irisa.fr  Tue Oct  7 11:02:43 2008
From: nlemeur at irisa.fr (Nolwenn Le Meur)
Date: Tue, 07 Oct 2008 11:02:43 +0200
Subject: [Rd] Lapack: SSYEV routine
Message-ID: <48EB25B3.3000602@irisa.fr>

Hi everyone,

I am interested in using the SSYEV Lapack subroutine in a R package.  
Unfortunately I am not familiar with the all Lapack library and I was 
wondering why the routine SSYEV is not part of the R-LAPACK interface 
module.

Is there any plan to extend the R-Lapack module in the next R release?
Should I try to directly call the SSYEV routine of the external Lapack 
library from my R package?

Any help would be much appreciated.

Best wishes,
Nolwenn

-- 
Nolwenn Le Meur
IRISA - Equipe Symbiose 
Campus de Beaulieu
35042 Rennes cedex - France
Phone: +33 2 99 84 71 00
Fax: +33 2 99 84 71 71
E-mail: nlemeur at irisa.fr
Web: http://www.irisa.fr/symbiose/web/nolwenn_le_meur


From ripley at stats.ox.ac.uk  Tue Oct  7 11:38:13 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 7 Oct 2008 10:38:13 +0100 (BST)
Subject: [Rd] Lapack: SSYEV routine
In-Reply-To: <48EB25B3.3000602@irisa.fr>
References: <48EB25B3.3000602@irisa.fr>
Message-ID: <alpine.LFD.2.00.0810071035330.14309@gannet.stats.ox.ac.uk>

On Tue, 7 Oct 2008, Nolwenn Le Meur wrote:

> Hi everyone,
>
> I am interested in using the SSYEV Lapack subroutine in a R package. 
> Unfortunately I am not familiar with the all Lapack library and I was 
> wondering why the routine SSYEV is not part of the R-LAPACK interface module.

Because it is a single-precision subroutine (that is what the leading 's' 
means), and R does not use single precision.

> Is there any plan to extend the R-Lapack module in the next R release?

No, because R does not use single precision.

> Should I try to directly call the SSYEV routine of the external Lapack 
> library from my R package?

I think you should rethink why you are using single precision routines 
with R.  If you need to, you need to ship the routines you need with the 
package, as e.g. fastICA does, for there need not be any  'external Lapack 
library'.

> Any help would be much appreciated.
>
> Best wishes,
> Nolwenn
>
> -- 
> Nolwenn Le Meur
> IRISA - Equipe Symbiose Campus de Beaulieu
> 35042 Rennes cedex - France
> Phone: +33 2 99 84 71 00
> Fax: +33 2 99 84 71 71
> E-mail: nlemeur at irisa.fr
> Web: http://www.irisa.fr/symbiose/web/nolwenn_le_meur
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From berwin at maths.uwa.edu.au  Tue Oct  7 13:31:03 2008
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue, 7 Oct 2008 19:31:03 +0800
Subject: [Rd] splinefun gives incorrect derivs when extrapolating to the
 left (PR#13132)
In-Reply-To: <20081006175013.5D145282EF48@mail.pubhealth.ku.dk>
References: <20081006175013.5D145282EF48@mail.pubhealth.ku.dk>
Message-ID: <20081007193103.6aadd4c2@absentia>

G'day Greg,

On Mon,  6 Oct 2008 19:50:13 +0200 (CEST)
Greg.Snow at imail.org wrote:

> This is a low priority bug that has been around for a while, but I
> came across it again while alpha testing 2.8.

Indeed, that bug must have been around since splinefun was changed to
return a function with a deriv argument.  Looks as if the person who
produced the initial patch didn't really think through all
possibilities. ;-)
 
> The resulting function for splinefun gives incorrect deriv values
> when x is less than the smallest x-value used to create the function
> (at least in one circumstance), but does the correct thing for x
> greater than the largest x-value.

In a nutshell, splinefun calls, after some initial processing, the C
routine spline_coef to fit the desired spline.  spline_coef returns
coefficients for the following representation of the spline;
	a[i] + dx*(b[i] + dx*(c[i] + dx* d[i])
where dx := u-x[i]; i such that x[i] <= u <= x[i+1].  This would
evaluate the spline at u; the xs are the original knots.

I.e., the four coefficients returned for a knot correspond to the
polynomial to the "right" of that knot.  Hence no problem with
evaluating derivatives to the right of the largest knot.  

The routine returned by splinefun, calls the C function spline_eval to
evaluate the spline at the desired points.  If deriv > 0, then the above
representation of the polynomials that make up the splines is
differentiated within the R code to obtain the desired derivative of
the spline.  The problem is that spline_eval does not know which
derivative is evaluated and assumes that the function itself is
evaluated.  Thus, for evaluation points left of the first knot it sets
d[1] to zero (d[1] is usually not zero).  This, of course, breaks down
when derivatives are evaluated (in this case spline_eval should set
c[1], b[1] or a[1] to zero depending on whether the 1, 2 or 3
derivative is evaluated).

The solution would be to either make spline_eval aware that a
derivative is evaluated, but this would imply that that C function gets
another parameter and the changes in the C code would probably not be
very "elegant", or to have the R code of the function returned by
splinefun check whether a natural spline was fitted and is now
evaluated at points to the left of the first knot; with appropriate
actions if this happens.

The attached patch (against the current SVN version of R) implements the
latter strategy.  With this patch applied, "make check FORCE=FORCE"
passes on my machine.  The version of R that is build seems to give the
correct answer in your example:

R> x <- 1:10
R> y <- sin(x)
R> 
R> splfun <- splinefun(x,y, method='natural')
R> 
R> # these should be linear (and are)
R> splfun( seq(0,1, 0.1) )
 [1] 0.5682923 0.5956102 0.6229280 0.6502459 0.6775638 0.7048816
 [7] 0.7321995 0.7595174 0.7868352 0.8141531 0.8414710
R> 
R> # these should all be the same
R> splfun( seq(0,1, 0.1), deriv=1 )
 [1] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
 [7] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
R> 
R> # these should all be 0
R> splfun( seq(0,1, 0.1), deriv=2 )
 [1] 0 0 0 0 0 0 0 0 0 0 0
R> splfun( seq(0,1, 0.1), deriv=3 )
 [1] 0 0 0 0 0 0 0 0 0 0 0

HTH.

Cheers,
	
	Berwin

=========================== Full address =============================
Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
Dept of Statistics and Applied Probability        +65 6516 6650 (self)
Faculty of Science                          FAX : +65 6872 3919       
National University of Singapore     
6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
Singapore 117546                    http://www.stat.nus.edu.sg/~statba
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: R-patch
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081007/8f9eea45/attachment.pl>

From berwin at maths.uwa.edu.au  Tue Oct  7 13:35:04 2008
From: berwin at maths.uwa.edu.au (berwin at maths.uwa.edu.au)
Date: Tue,  7 Oct 2008 13:35:04 +0200 (CEST)
Subject: [Rd] splinefun gives incorrect derivs when extrapolating to the
	(PR#13138)
Message-ID: <20081007113505.045A72834170@mail.pubhealth.ku.dk>

--MP_/Rxf/JAvsQx5JLkhZFc9Jmn4
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

G'day Greg,

On Mon,  6 Oct 2008 19:50:13 +0200 (CEST)
Greg.Snow at imail.org wrote:

> This is a low priority bug that has been around for a while, but I
> came across it again while alpha testing 2.8.

Indeed, that bug must have been around since splinefun was changed to
return a function with a deriv argument.  Looks as if the person who
produced the initial patch didn't really think through all
possibilities. ;-)
 
> The resulting function for splinefun gives incorrect deriv values
> when x is less than the smallest x-value used to create the function
> (at least in one circumstance), but does the correct thing for x
> greater than the largest x-value.

In a nutshell, splinefun calls, after some initial processing, the C
routine spline_coef to fit the desired spline.  spline_coef returns
coefficients for the following representation of the spline;
	a[i] + dx*(b[i] + dx*(c[i] + dx* d[i])
where dx := u-x[i]; i such that x[i] <= u <= x[i+1].  This would
evaluate the spline at u; the xs are the original knots.

I.e., the four coefficients returned for a knot correspond to the
polynomial to the "right" of that knot.  Hence no problem with
evaluating derivatives to the right of the largest knot.  

The routine returned by splinefun, calls the C function spline_eval to
evaluate the spline at the desired points.  If deriv > 0, then the above
representation of the polynomials that make up the splines is
differentiated within the R code to obtain the desired derivative of
the spline.  The problem is that spline_eval does not know which
derivative is evaluated and assumes that the function itself is
evaluated.  Thus, for evaluation points left of the first knot it sets
d[1] to zero (d[1] is usually not zero).  This, of course, breaks down
when derivatives are evaluated (in this case spline_eval should set
c[1], b[1] or a[1] to zero depending on whether the 1, 2 or 3
derivative is evaluated).

The solution would be to either make spline_eval aware that a
derivative is evaluated, but this would imply that that C function gets
another parameter and the changes in the C code would probably not be
very "elegant", or to have the R code of the function returned by
splinefun check whether a natural spline was fitted and is now
evaluated at points to the left of the first knot; with appropriate
actions if this happens.

The attached patch (against the current SVN version of R) implements the
latter strategy.  With this patch applied, "make check FORCE=FORCE"
passes on my machine.  The version of R that is build seems to give the
correct answer in your example:

R> x <- 1:10
R> y <- sin(x)
R> 
R> splfun <- splinefun(x,y, method='natural')
R> 
R> # these should be linear (and are)
R> splfun( seq(0,1, 0.1) )
 [1] 0.5682923 0.5956102 0.6229280 0.6502459 0.6775638 0.7048816
 [7] 0.7321995 0.7595174 0.7868352 0.8141531 0.8414710
R> 
R> # these should all be the same
R> splfun( seq(0,1, 0.1), deriv=1 )
 [1] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
 [7] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
R> 
R> # these should all be 0
R> splfun( seq(0,1, 0.1), deriv=2 )
 [1] 0 0 0 0 0 0 0 0 0 0 0
R> splfun( seq(0,1, 0.1), deriv=3 )
 [1] 0 0 0 0 0 0 0 0 0 0 0

HTH.

Cheers,
	
	Berwin

=========================== Full address =============================
Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
Dept of Statistics and Applied Probability        +65 6516 6650 (self)
Faculty of Science                          FAX : +65 6872 3919       
National University of Singapore     
6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
Singapore 117546                    http://www.stat.nus.edu.sg/~statba

--MP_/Rxf/JAvsQx5JLkhZFc9Jmn4
Content-Type: text/plain; name=R-patch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename=R-patch

Index: src/library/stats/R/splinefun.R
===================================================================
--- src/library/stats/R/splinefun.R	(revision 46635)
+++ src/library/stats/R/splinefun.R	(working copy)
@@ -38,7 +38,6 @@
 	    y <- as.vector(tapply(y,x,ties))# as.v: drop dim & dimn.
 	    x <- sort(ux)
 	    nx <- length(x)
-	    rm(ux)
 	} else {
 	    o <- order(x)
 	    x <- x[o]
@@ -93,7 +92,7 @@
 	    d=double(nx),
 	    e=double(if(iMeth == 1) nx else 0),
 	    PACKAGE="stats")
-    rm(x,y,nx,o,method,iMeth)
+    rm(x,y,nx,ux,o,method,iMeth)
     z$e <- NULL
     function(x, deriv = 0) {
 	deriv <- as.integer(deriv)
@@ -114,18 +113,31 @@
         ##           where dx := (u[j]-x[i]); i such that x[i] <= u[j] <= x[i+1},
         ##                u[j]:= xout[j] (unless sometimes for periodic spl.)
         ##           and  d_i := d[i] unless for natural splines at left
-	.C("spline_eval",
-	   z$method,
-	   as.integer(length(x)),
-	   x=as.double(x),
-	   y=double(length(x)),
-	   z$n,
-	   z$x,
-	   z$y,
-	   z$b,
-	   z$c,
-	   z$d,
-	   PACKAGE="stats")$y
+	res <- .C("spline_eval",
+                  z$method,
+                  as.integer(length(x)),
+                  x=as.double(x),
+                  y=double(length(x)),
+                  z$n,
+                  z$x,
+                  z$y,
+                  z$b,
+                  z$c,
+                  z$d,
+                  PACKAGE="stats")$y
+
+        ## deal with points to the left of first knot if natural
+        ## splines are used  (Bug PR#13132)
+        if( deriv > 0 && z$method==2 && any(ind <- x<=z$x[1]) ){
+          dx <- z$x[1] - x[ind]
+          switch(deriv,
+                 z$c[1] <- 0,  ## values were calculated above from
+                 z$b[1] <- 0,  ## z$d[1], but ought to be zero.
+                 z$y[1] <- 0)
+          res[ind] <- with(z, y[1] + dx*b[1])
+        }
+
+        res
     }
 }
 
Index: src/library/stats/man/splinefun.Rd
===================================================================
--- src/library/stats/man/splinefun.Rd	(revision 46635)
+++ src/library/stats/man/splinefun.Rd	(working copy)
@@ -131,7 +131,7 @@
 par(op)
 
 ## Manual spline evaluation --- demo the coefficients :
-.x <- get("ux", envir = environment(f))
+.x <- splinecoef$x
 u <- seq(3,6, by = 0.25)
 (ii <- findInterval(u, .x))
 dx <- u - .x[ii]

--MP_/Rxf/JAvsQx5JLkhZFc9Jmn4--


From berwin at maths.uwa.edu.au  Tue Oct  7 13:48:27 2008
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Tue, 7 Oct 2008 19:48:27 +0800
Subject: [Rd] splinefun gives incorrect derivs when extrapolating to the
 left (PR#13132)
In-Reply-To: <20081007193103.6aadd4c2@absentia>
References: <20081006175013.5D145282EF48@mail.pubhealth.ku.dk>
	<20081007193103.6aadd4c2@absentia>
Message-ID: <20081007194827.28cec3f3@absentia>

On Tue, 7 Oct 2008 19:31:03 +0800
Berwin A Turlach <berwin at maths.uwa.edu.au> wrote:

> The attached patch (against the current SVN version of R) implements
> the latter strategy.  With this patch applied, "make check
> FORCE=FORCE" passes on my machine.  The version of R that is build
> seems to give the correct answer in your example:

Perhaps I should have thought a bit more about this.  For a natural
spline c[1] is zero, and d[1] is typically not but for evaluations
left of the first knot it should be taken as zero.  So the attached
patch solves the problem in what some might consider a more elegant
manner. :)

With the patch "make check FORCE=FORCE" works on my machine and it
also solves your example:

R> x <- 1:10
R> y <- sin(x)
R> 
R> splfun <- splinefun(x,y, method='natural')
R> 
R> # these should be linear (and are)
R> splfun( seq(0,1, 0.1) )  
 [1] 0.5682923 0.5956102 0.6229280 0.6502459 0.6775638 0.7048816
 [7] 0.7321995 0.7595174 0.7868352 0.8141531 0.8414710
R> 
R> # these should all be the same
R> splfun( seq(0,1, 0.1), deriv=1 )  
 [1] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
 [7] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
R> 
R> # these should all be 0
R> splfun( seq(0,1, 0.1), deriv=2 )
 [1] 0 0 0 0 0 0 0 0 0 0 0
R> splfun( seq(0,1, 0.1), deriv=3 )  
 [1] 0 0 0 0 0 0 0 0 0 0 0

HTH.

Cheers,
	
	Berwin

=========================== Full address =============================
Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
Dept of Statistics and Applied Probability        +65 6516 6650 (self)
Faculty of Science                          FAX : +65 6872 3919       
National University of Singapore     
6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
Singapore 117546                    http://www.stat.nus.edu.sg/~statba
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: R-patch1
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081007/b68ce66d/attachment.pl>

From berwin at maths.uwa.edu.au  Tue Oct  7 13:50:03 2008
From: berwin at maths.uwa.edu.au (berwin at maths.uwa.edu.au)
Date: Tue,  7 Oct 2008 13:50:03 +0200 (CEST)
Subject: [Rd] splinefun gives incorrect derivs when extrapolating to the
	(PR#13139)
Message-ID: <20081007115004.0B9E9282EFC2@mail.pubhealth.ku.dk>

--MP_/kvy20nVajVG/n.8m=_ZjLAX
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

On Tue, 7 Oct 2008 19:31:03 +0800
Berwin A Turlach <berwin at maths.uwa.edu.au> wrote:

> The attached patch (against the current SVN version of R) implements
> the latter strategy.  With this patch applied, "make check
> FORCE=FORCE" passes on my machine.  The version of R that is build
> seems to give the correct answer in your example:

Perhaps I should have thought a bit more about this.  For a natural
spline c[1] is zero, and d[1] is typically not but for evaluations
left of the first knot it should be taken as zero.  So the attached
patch solves the problem in what some might consider a more elegant
manner. :)

With the patch "make check FORCE=FORCE" works on my machine and it
also solves your example:

R> x <- 1:10
R> y <- sin(x)
R> 
R> splfun <- splinefun(x,y, method='natural')
R> 
R> # these should be linear (and are)
R> splfun( seq(0,1, 0.1) )  
 [1] 0.5682923 0.5956102 0.6229280 0.6502459 0.6775638 0.7048816
 [7] 0.7321995 0.7595174 0.7868352 0.8141531 0.8414710
R> 
R> # these should all be the same
R> splfun( seq(0,1, 0.1), deriv=1 )  
 [1] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
 [7] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
R> 
R> # these should all be 0
R> splfun( seq(0,1, 0.1), deriv=2 )
 [1] 0 0 0 0 0 0 0 0 0 0 0
R> splfun( seq(0,1, 0.1), deriv=3 )  
 [1] 0 0 0 0 0 0 0 0 0 0 0

HTH.

Cheers,
	
	Berwin

=========================== Full address =============================
Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
Dept of Statistics and Applied Probability        +65 6516 6650 (self)
Faculty of Science                          FAX : +65 6872 3919       
National University of Singapore     
6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
Singapore 117546                    http://www.stat.nus.edu.sg/~statba

--MP_/kvy20nVajVG/n.8m=_ZjLAX
Content-Type: text/plain; name=R-patch1
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename=R-patch1

Index: src/library/stats/R/splinefun.R
===================================================================
--- src/library/stats/R/splinefun.R	(revision 46635)
+++ src/library/stats/R/splinefun.R	(working copy)
@@ -38,7 +38,6 @@
 	    y <- as.vector(tapply(y,x,ties))# as.v: drop dim & dimn.
 	    x <- sort(ux)
 	    nx <- length(x)
-	    rm(ux)
 	} else {
 	    o <- order(x)
 	    x <- x[o]
@@ -93,7 +92,7 @@
 	    d=double(nx),
 	    e=double(if(iMeth == 1) nx else 0),
 	    PACKAGE="stats")
-    rm(x,y,nx,o,method,iMeth)
+    rm(x,y,nx,ux,o,method,iMeth)
     z$e <- NULL
     function(x, deriv = 0) {
 	deriv <- as.integer(deriv)
@@ -114,18 +113,25 @@
         ##           where dx := (u[j]-x[i]); i such that x[i] <= u[j] <= x[i+1},
         ##                u[j]:= xout[j] (unless sometimes for periodic spl.)
         ##           and  d_i := d[i] unless for natural splines at left
-	.C("spline_eval",
-	   z$method,
-	   as.integer(length(x)),
-	   x=as.double(x),
-	   y=double(length(x)),
-	   z$n,
-	   z$x,
-	   z$y,
-	   z$b,
-	   z$c,
-	   z$d,
-	   PACKAGE="stats")$y
+	res <- .C("spline_eval",
+                  z$method,
+                  as.integer(length(x)),
+                  x=as.double(x),
+                  y=double(length(x)),
+                  z$n,
+                  z$x,
+                  z$y,
+                  z$b,
+                  z$c,
+                  z$d,
+                  PACKAGE="stats")$y
+
+        ## deal with points to the left of first knot if natural
+        ## splines are used  (Bug PR#13132)
+        if( deriv > 0 && z$method==2 && any(ind <- x<=z$x[1]) )
+          res[ind] <- ifelse(deriv == 1, z$y[1], 0)
+
+        res
     }
 }
 
Index: src/library/stats/man/splinefun.Rd
===================================================================
--- src/library/stats/man/splinefun.Rd	(revision 46635)
+++ src/library/stats/man/splinefun.Rd	(working copy)
@@ -131,7 +131,7 @@
 par(op)
 
 ## Manual spline evaluation --- demo the coefficients :
-.x <- get("ux", envir = environment(f))
+.x <- splinecoef$x
 u <- seq(3,6, by = 0.25)
 (ii <- findInterval(u, .x))
 dx <- u - .x[ii]

--MP_/kvy20nVajVG/n.8m=_ZjLAX--


From statba at nus.edu.sg  Tue Oct  7 14:45:43 2008
From: statba at nus.edu.sg (Berwin A Turlach)
Date: Tue, 7 Oct 2008 20:45:43 +0800
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
Message-ID: <20081007204543.741a1b33@absentia>

G'day Hadley,

On Mon, 6 Oct 2008 08:55:14 -0500
"hadley wickham" <h.wickham at gmail.com> wrote:

> >> The main problem with vignettes at the moment is that
> >> they must be sweave, a format which I don't really like.  I wish I
> >> could supply my own pdf + R code file produced using whatever
> >> tools I choose.
> >
> > I like Sweave, and it is also possible to include your own PDFs and
> > R files and then to reference them in anRpackage.Rd.
> 
> Yes, but they're not vignettes - which means they're not listed under
> vignette() and it's yet another place for people to look for
> documentation.

Well, there is a kind of subversive way of how do use the facilities
provided to vignettes for PDFs that were created by some other
mechanism.  That was discussed sometime ago on this list.  The idea was
to create an "empty" vignette that uses the LaTeX package pdfpages to
include the existing PDF into a vignette.

Since you ended up with essentially two copies of the same PDF file,
you can use .Rbuildignore to exclude the original PDF from the build
and only distribute the PDF created from the vignette.

This trick worked really well as long as "R CMD check" was not trying
to latex the .tex file produced from the vignette (apparently since R
2.6.0 the behaviour of "R CMD check" in this respect has changed,
though the "Writing R Extension" manual was not updated to reflect
this change; which reminds me that I promised Kurt Hornik to file a
bug report about this).  What makes things worse is that with the
current TeX installation on Debian based operating system, latex hangs
if a file, from which pdfpages wants to include some (or all) pages,
does not exist.  That is "R CMD check" on such a tar.gz file hangs and
doesn't stop with an error message.

The solution that I am using at the moment is shown in the attached
file which resides in inst/doc of the lasso2 package on my machine.  On
my machine, "R CMD build" and "R CMD check" will, of course, work.
Essentially, this vignette only creates the information needed to index
it and then includes the file Manual-wo-help.pdf (which is the old help
for the S-Plus version of that package; I should really update all
this). Manual-wo-help.pdf is excluded from lasso2_x.y-z.tar.gz via an
entry in .Rbuildignore but the vignette is distributed and listed under
vignette().  And "R CMD check" on works the .tar.gz file too.

Cheers,

	Berwin

=========================== Full address =============================
Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
Dept of Statistics and Applied Probability        +65 6516 6650 (self)
Faculty of Science                          FAX : +65 6872 3919       
National University of Singapore     
6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
Singapore 117546                    http://www.stat.nus.edu.sg/~statba
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Manual-vignette.Rnw
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081007/11fbdfa9/attachment.pl>

From ggrothendieck at gmail.com  Tue Oct  7 15:11:33 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 7 Oct 2008 09:11:33 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EA1F2E.1060207@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
	<48EA1F2E.1060207@stats.uwo.ca>
Message-ID: <971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>

Some examples are:
- be able to use brew package or similar alternative in place of Sweave
- provide a pdf regardless how it was generated
without ugly workarounds and still let the user get a list of all pdf
documents in
one place, e.g.
  library(help = mypackage)
should list the vignettes and other pdfs too so its all together and
there should
be some facility similar to vignettes() to easily access them.


On Mon, Oct 6, 2008 at 10:22 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/6/2008 9:55 AM, hadley wickham wrote:
>>>>
>>>> It may not be much work for you, but I find any additional
>>>> requirements to the package format to be a real pain.  I have ~10
>>>> packages on CRAN and having to go through and add this extra
>>>> information all at once is a big hassle.  R releases tend to happen in
>>>> the middle of the US academic semester when I have a lot of other
>>>> things on my plate.
>>>
>>> O.K., but the discussion with Duncan shows:
>>>
>>> - the required information is already available (in DESCRIPTION),
>>> - one can think about ways to generate the page automatically for
>>> existing
>>> packages,
>>> - the intro can be short and should link to other pages or PDFs,
>>> - one should avoid doubling and inconsistency.
>>
>> I'm obviously not going to object if it's done automatically, and I
>> already strive to avoid doubling and inconsistency by producing most
>> my documentation algorithmically.  I think you are being cavalier by
>> not caring about the extra work you want package authors to do.
>>
>>>> Additionally, I find that rdoc is the wrong format for lengthy
>>>> explanation and exposition - a pdf is much better - and I think that
>>>> the packages already have a abstract: the description field in
>>>> DESCRIPTION.
>>>
>>> o.k., but abstract may be (technically) in the wrong format and does not
>>> point to the other relevant parts of the package documentation.
>>
>> Then I don't think you should call what you want an abstract.
>>
>>>> The main problem with vignettes at the moment is that
>>>> they must be sweave, a format which I don't really like.  I wish I
>>>> could supply my own pdf + R code file produced using whatever tools I
>>>> choose.
>>>
>>> I like Sweave, and it is also possible to include your own PDFs and R
>>> files
>>> and then to reference them in anRpackage.Rd.
>>
>> Yes, but they're not vignettes - which means they're not listed under
>> vignette() and it's yet another place for people to look for
>> documentation.
>
> Vignettes have R code in them and a way to extract it, so it's misleading to
> call something that's just a .pdf file a vignette.  But I imagine there
> could be other ways to mix R code with documentation besides the existing
> Sweave formats.  The most obvious way to add another one is to write another
> Sweave driver.  I think it would require changes to the base of R to allow
> for Sweave drivers in packages, working with files that don't have
> extensions (R|r|S|s)(nw|tex), but in principle I don't see any real
> objection to adding that.

The change I would like to see in Sweave would be the ability to include
or exclude R and latex sections based on the results of the R code. That
would allow it to be used in conditional report generation and not just
documentation.  I know there are workarounds but they are ugly and
not satisfactory in my opinion.  Also passing arguments to
R CMD Sweave would be nice.


From murdoch at stats.uwo.ca  Tue Oct  7 15:46:08 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 07 Oct 2008 09:46:08 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>	
	<48E9FF28.6060207@tu-dresden.de>	
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>	
	<48EA15B5.8020800@tu-dresden.de>	
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>	
	<48EA1F2E.1060207@stats.uwo.ca>
	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>
Message-ID: <48EB6820.1000502@stats.uwo.ca>

On 07/10/2008 9:11 AM, Gabor Grothendieck wrote:
> Some examples are:
> - be able to use brew package or similar alternative in place of Sweave
> - provide a pdf regardless how it was generated
> without ugly workarounds and still let the user get a list of all pdf
> documents in
> one place, e.g.
>   library(help = mypackage)
> should list the vignettes and other pdfs too so its all together and
> there should
> be some facility similar to vignettes() to easily access them.

The inst/doc directory can already have an index.html file to list all 
the documents there.  This will be automatically produced from the 
vignettes if it doesn't exist, but if you have other files, you can 
write it manually.

This shows up in the HTML help system.  It would be better if it showed 
up in all help formats, but there are other ways to do that, e.g. 
creating an Rd help page pointing to those files.

Duncan Murdoch


From ggrothendieck at gmail.com  Tue Oct  7 16:16:20 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 7 Oct 2008 10:16:20 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EB6820.1000502@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
	<48EA1F2E.1060207@stats.uwo.ca>
	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>
	<48EB6820.1000502@stats.uwo.ca>
Message-ID: <971536df0810070716k307336c8xda6e482d7475377e@mail.gmail.com>

On Tue, Oct 7, 2008 at 9:46 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 07/10/2008 9:11 AM, Gabor Grothendieck wrote:
>>
>> Some examples are:
>> - be able to use brew package or similar alternative in place of Sweave
>> - provide a pdf regardless how it was generated
>> without ugly workarounds and still let the user get a list of all pdf
>> documents in
>> one place, e.g.
>>  library(help = mypackage)
>> should list the vignettes and other pdfs too so its all together and
>> there should
>> be some facility similar to vignettes() to easily access them.
>
> The inst/doc directory can already have an index.html file to list all the
> documents there.  This will be automatically produced from the vignettes if
> it doesn't exist, but if you have other files, you can write it manually.
>
> This shows up in the HTML help system.  It would be better if it showed up
> in all help formats, but there are other ways to do that, e.g. creating an
> Rd help page pointing to those files.
>

That's good to know but I assume you are pointing out what is
available so we know as we still need to address the fragmentation.

In particular, CHM, not HTML, is the default help format under Windows so
having it in HTML will not be useful for most Windows users.
I generally do create a mypackage-package.Rd file but that's less
reliable for user since they can't be sure a package has one and
since its manually done it can become inconsistent more easily.

Also the pdf's should appear in auto-generated web pages of this sort:
http://cran.r-project.org/web/packages/zoo/index.html
in addition to the library(help = ...) page.

To me Sweave is ok for documentation but there is a learning curve
and it can't be used for reports that have conditional processing
(e.g. a report full of tables for which data is missing in some reports
so you want to eliminate those sections and the corresponding
text for those runs) without ugly workarounds which means those tend
to be written
in plain R.
Thus one can't  benefit from Sweave as much as desirable. Thus the one
other place that one might leverage your knowledge of Sweave over a
sufficiently
large set of tasks is unavailable.  I also find that despite Stangle
that debugging with
Sweave can be onerous at times.  What I would really like is one tool that
would do it all.  If the only time you use Sweave is when you create packages
there is  going to be a long time between usages and you are bound to forget
but if it can be used more widely it would be better.


From h.wickham at gmail.com  Tue Oct  7 16:17:53 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Tue, 7 Oct 2008 09:17:53 -0500
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EB6820.1000502@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>
	<48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
	<48EA1F2E.1060207@stats.uwo.ca>
	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>
	<48EB6820.1000502@stats.uwo.ca>
Message-ID: <f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>

> This shows up in the HTML help system.  It would be better if it showed up
> in all help formats, but there are other ways to do that, e.g. creating an
> Rd help page pointing to those files.

Or you can just link to them from your website.

I don't think you'd argue with the statement that there's already too
many different ways to find R documentation.  There are plenty of
hacks and work-arounds to jam different types of documentation in
different places, but they are just hacks and work-arounds.  My
feeling is that evolutionary modification of the documentation system
is only going to get us so far, and at some point the entire
foundations need to be rethought.

Of course, the problem is having enough time to do that, and then to
code up the solution!

Hadley

-- 
http://had.co.nz/


From murdoch at stats.uwo.ca  Tue Oct  7 16:49:03 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 07 Oct 2008 10:49:03 -0400
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de> <48E9E9E3.90905@stats.uwo.ca>	
	<48E9FF28.6060207@tu-dresden.de>	
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>	
	<48EA15B5.8020800@tu-dresden.de>	
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>	
	<48EA1F2E.1060207@stats.uwo.ca>	
	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>	
	<48EB6820.1000502@stats.uwo.ca>
	<f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>
Message-ID: <48EB76DF.1040709@stats.uwo.ca>

On 07/10/2008 10:17 AM, hadley wickham wrote:
>> This shows up in the HTML help system.  It would be better if it showed up
>> in all help formats, but there are other ways to do that, e.g. creating an
>> Rd help page pointing to those files.
> 
> Or you can just link to them from your website.
> 
> I don't think you'd argue with the statement that there's already too
> many different ways to find R documentation.  

I think that's a paraphrase of one of my earlier posts.

> There are plenty of
> hacks and work-arounds to jam different types of documentation in
> different places, but they are just hacks and work-arounds.  My
> feeling is that evolutionary modification of the documentation system
> is only going to get us so far, and at some point the entire
> foundations need to be rethought.

I don't agree with this.  Back in 2001 when this was first proposed it 
might have worked, but there's far too much inertia now to make a big 
change.  Weren't you the one who objected to a requirement for a 
foo-package help topic?  How would you like to rewrite all the help 
files for all of your packages?  (I imagine not much.  I'm certainly not 
going to do that for mine.)

I think any change we make now needs to be incremental, but there's a 
tremendous amount of friction against anything at all, and very few 
offers of support to actually do the work.

Here are things I'm currently working on, that I'd appreciate support for:

  - Formalizing the Rd format and writing a parser for it.  (The current 
parser finds errors in about 2-5% of base package man files.  Should it 
be more permissive? I would guess it will find more errors in 
contributed packages.)  Can it make changes?  I would really love to say 
that % is nothing special in an R code section in an Rd file, but there 
are lots of pages that use it as a comment, as it is documented to be.

  - Allowing macros in an Rd file.  This will give a way to avoid 
duplication of information, will allow you to include an index of 
whatever sort of files you want, generated on the fly, and will slice 
bread if you write a macro for it.

  - Source level debugging support.  Gabor mentioned that it's hard to 
debug Sweave files; this could help.


> Of course, the problem is having enough time to do that, and then to
> code up the solution!

That's the main problem.  I find the coding is much easier than the 
design, though.  I can code on my own, but the design really needs 
careful thought and criticism.  (It's easy to get shallow criticism; the 
hard thing is to get useful criticism.)  That means at least two people 
need to find time to work together on the problem, and in my experience, 
that has almost never happened with any of the problems above.  So I 
move very, very slowly on them.

Duncan Murdoch


From rgentlem at fhcrc.org  Tue Oct  7 18:01:00 2008
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Tue, 07 Oct 2008 09:01:00 -0700
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EB76DF.1040709@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de>
	<48E9E9E3.90905@stats.uwo.ca>		<48E9FF28.6060207@tu-dresden.de>		<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>		<48EA15B5.8020800@tu-dresden.de>		<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>		<48EA1F2E.1060207@stats.uwo.ca>		<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>		<48EB6820.1000502@stats.uwo.ca>	<f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>
	<48EB76DF.1040709@stats.uwo.ca>
Message-ID: <48EB87BC.8070309@fhcrc.org>

Hi,
   Not that I have time, but I suspect that there are not that many ways 
to document a package, probably only five or six variants in the wild 
and an overview function, with a name like packageOverview, would be 
relatively easy to write and would be able to extract all available 
information into a single place for a user.

An advantage of such an approach is that it can be updated, independent 
of what particular developers/packages do, leaving us free to choose our 
own manner of documentation.  Also, one could easily imaging giving 
overviews of the class structure and functions + relationships (a thread 
on r-help) could be options, as could extracting doxygen type comments. 
But, as with all things R, someone needs to actually put it together - 
the tools are all there.

best wishes
   Robert


Duncan Murdoch wrote:
> On 07/10/2008 10:17 AM, hadley wickham wrote:
>>> This shows up in the HTML help system.  It would be better if it 
>>> showed up
>>> in all help formats, but there are other ways to do that, e.g. 
>>> creating an
>>> Rd help page pointing to those files.
>>
>> Or you can just link to them from your website.
>>
>> I don't think you'd argue with the statement that there's already too
>> many different ways to find R documentation.  
> 
> I think that's a paraphrase of one of my earlier posts.
> 
>> There are plenty of
>> hacks and work-arounds to jam different types of documentation in
>> different places, but they are just hacks and work-arounds.  My
>> feeling is that evolutionary modification of the documentation system
>> is only going to get us so far, and at some point the entire
>> foundations need to be rethought.
> 
> I don't agree with this.  Back in 2001 when this was first proposed it 
> might have worked, but there's far too much inertia now to make a big 
> change.  Weren't you the one who objected to a requirement for a 
> foo-package help topic?  How would you like to rewrite all the help 
> files for all of your packages?  (I imagine not much.  I'm certainly not 
> going to do that for mine.)
> 
> I think any change we make now needs to be incremental, but there's a 
> tremendous amount of friction against anything at all, and very few 
> offers of support to actually do the work.
> 
> Here are things I'm currently working on, that I'd appreciate support for:
> 
>  - Formalizing the Rd format and writing a parser for it.  (The current 
> parser finds errors in about 2-5% of base package man files.  Should it 
> be more permissive? I would guess it will find more errors in 
> contributed packages.)  Can it make changes?  I would really love to say 
> that % is nothing special in an R code section in an Rd file, but there 
> are lots of pages that use it as a comment, as it is documented to be.
> 
>  - Allowing macros in an Rd file.  This will give a way to avoid 
> duplication of information, will allow you to include an index of 
> whatever sort of files you want, generated on the fly, and will slice 
> bread if you write a macro for it.
> 
>  - Source level debugging support.  Gabor mentioned that it's hard to 
> debug Sweave files; this could help.
> 
> 
>> Of course, the problem is having enough time to do that, and then to
>> code up the solution!
> 
> That's the main problem.  I find the coding is much easier than the 
> design, though.  I can code on my own, but the design really needs 
> careful thought and criticism.  (It's easy to get shallow criticism; the 
> hard thing is to get useful criticism.)  That means at least two people 
> need to find time to work together on the problem, and in my experience, 
> that has almost never happened with any of the problems above.  So I 
> move very, very slowly on them.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org


From h.wickham at gmail.com  Tue Oct  7 18:10:57 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Tue, 7 Oct 2008 11:10:57 -0500
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48EB76DF.1040709@stats.uwo.ca>
References: <48E9DE58.6070303@tu-dresden.de> <48E9FF28.6060207@tu-dresden.de>
	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>
	<48EA15B5.8020800@tu-dresden.de>
	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>
	<48EA1F2E.1060207@stats.uwo.ca>
	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>
	<48EB6820.1000502@stats.uwo.ca>
	<f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>
	<48EB76DF.1040709@stats.uwo.ca>
Message-ID: <f8e6ff050810070910s4cafd260o469f7b716f1d03a5@mail.gmail.com>

> I don't agree with this.  Back in 2001 when this was first proposed it might
> have worked, but there's far too much inertia now to make a big change.
>  Weren't you the one who objected to a requirement for a foo-package help
> topic?  How would you like to rewrite all the help files for all of your
> packages?  (I imagine not much.  I'm certainly not going to do that for
> mine.)

Well I'm arguing from two different positions - as a developer, I want
to minimise the amount of work I have to do get a package up and
running, and as a user I want documentation that's easy to understand.
 This makes my arguments somewhat schizophrenic ;)

Another approach would be to leverage something like Roxygen - i.e.
build a parallel documentation system where it would be possible to
play with these new ideas.  There would be no pressure for developers
to switch, except to access the nice new features enabled by the
format.

>  - Formalizing the Rd format and writing a parser for it.  (The current
> parser finds errors in about 2-5% of base package man files.  Should it be
> more permissive? I would guess it will find more errors in contributed
> packages.)  Can it make changes?  I would really love to say that % is
> nothing special in an R code section in an Rd file, but there are lots of
> pages that use it as a comment, as it is documented to be.

That would be great, and I think for the documentation parser I would
err on the side of being too restrictive - that will impose some cost
on developers, but would enable more powerful higher order tools.
Output to xml would also be useful as it would make it easier to feed
into other tools (like search applications).  I continue to be
confused about where (if anywhere) % can be used in rdoc, and where
they need to be escaped.

>  - Allowing macros in an Rd file.  This will give a way to avoid duplication
> of information, will allow you to include an index of whatever sort of files
> you want, generated on the fly, and will slice bread if you write a macro
> for it.

The more I look at my documentation, the more I think a simple macro
simple wouldn't work for me.  There is no way I could write the
documentation for ggplot2 with a set of macros - there are too many
conditionals and complicated sub-expression.  It may help for simpler
packages.

> That's the main problem.  I find the coding is much easier than the design,
> though.  I can code on my own, but the design really needs careful thought
> and criticism.  (It's easy to get shallow criticism; the hard thing is to
> get useful criticism.)  That means at least two people need to find time to
> work together on the problem, and in my experience, that has almost never
> happened with any of the problems above.  So I move very, very slowly on
> them.

I'd be happy to help, especially with my experience writing rdoc with
R and with ruby.  I also have a couple of packages in development that
currently don't have any documentation, where I'd be happy to
experiment with new ways of doing documentation (I'm currently
planning on trying out Roxygen)

Hadley

-- 
http://had.co.nz/


From duncan at wald.ucdavis.edu  Tue Oct  7 18:18:30 2008
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Tue, 07 Oct 2008 09:18:30 -0700
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <f8e6ff050810070910s4cafd260o469f7b716f1d03a5@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de>
	<48E9FF28.6060207@tu-dresden.de>	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>	<48EA15B5.8020800@tu-dresden.de>	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>	<48EA1F2E.1060207@stats.uwo.ca>	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>	<48EB6820.1000502@stats.uwo.ca>	<f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>	<48EB76DF.1040709@stats.uwo.ca>
	<f8e6ff050810070910s4cafd260o469f7b716f1d03a5@mail.gmail.com>
Message-ID: <48EB8BD6.8060205@wald.ucdavis.edu>


FWIW, I'll note that one or two of us are working on a documentation
system that uses XML and specifically extensions of Docbook to create
documentation for R objects and that transparently extends to general 
articles, vignettes, books, etc. and dynamic and interactive 
reproducible documents.  The tools are all R-based (via packages
embedding XML and XSL processors) and the expectation is that it will
provide a parallel framework in which interested researchers can 
experiment with new ideas.

  D.


hadley wickham wrote:
>> I don't agree with this.  Back in 2001 when this was first proposed it might
>> have worked, but there's far too much inertia now to make a big change.
>>  Weren't you the one who objected to a requirement for a foo-package help
>> topic?  How would you like to rewrite all the help files for all of your
>> packages?  (I imagine not much.  I'm certainly not going to do that for
>> mine.)
> 
> Well I'm arguing from two different positions - as a developer, I want
> to minimise the amount of work I have to do get a package up and
> running, and as a user I want documentation that's easy to understand.
>  This makes my arguments somewhat schizophrenic ;)
> 
> Another approach would be to leverage something like Roxygen - i.e.
> build a parallel documentation system where it would be possible to
> play with these new ideas.  There would be no pressure for developers
> to switch, except to access the nice new features enabled by the
> format.
> 
>>  - Formalizing the Rd format and writing a parser for it.  (The current
>> parser finds errors in about 2-5% of base package man files.  Should it be
>> more permissive? I would guess it will find more errors in contributed
>> packages.)  Can it make changes?  I would really love to say that % is
>> nothing special in an R code section in an Rd file, but there are lots of
>> pages that use it as a comment, as it is documented to be.
> 
> That would be great, and I think for the documentation parser I would
> err on the side of being too restrictive - that will impose some cost
> on developers, but would enable more powerful higher order tools.
> Output to xml would also be useful as it would make it easier to feed
> into other tools (like search applications).  I continue to be
> confused about where (if anywhere) % can be used in rdoc, and where
> they need to be escaped.
> 
>>  - Allowing macros in an Rd file.  This will give a way to avoid duplication
>> of information, will allow you to include an index of whatever sort of files
>> you want, generated on the fly, and will slice bread if you write a macro
>> for it.
> 
> The more I look at my documentation, the more I think a simple macro
> simple wouldn't work for me.  There is no way I could write the
> documentation for ggplot2 with a set of macros - there are too many
> conditionals and complicated sub-expression.  It may help for simpler
> packages.
> 
>> That's the main problem.  I find the coding is much easier than the design,
>> though.  I can code on my own, but the design really needs careful thought
>> and criticism.  (It's easy to get shallow criticism; the hard thing is to
>> get useful criticism.)  That means at least two people need to find time to
>> work together on the problem, and in my experience, that has almost never
>> happened with any of the problems above.  So I move very, very slowly on
>> them.
> 
> I'd be happy to help, especially with my experience writing rdoc with
> R and with ruby.  I also have a couple of packages in development that
> currently don't have any documentation, where I'd be happy to
> experiment with new ways of doing documentation (I'm currently
> planning on trying out Roxygen)
> 
> Hadley
>


From tobias.verbeke at gmail.com  Tue Oct  7 18:54:20 2008
From: tobias.verbeke at gmail.com (Tobias Verbeke)
Date: Tue, 07 Oct 2008 18:54:20 +0200
Subject: [Rd] [OT] StatET Roxygen support (was: Re: why is
 \alias{anRpackage} not mandatory?)
In-Reply-To: <f8e6ff050810070910s4cafd260o469f7b716f1d03a5@mail.gmail.com>
References: <48E9DE58.6070303@tu-dresden.de>
	<48E9FF28.6060207@tu-dresden.de>	<f8e6ff050810060559j19623c5ew8f8e3f47811088c0@mail.gmail.com>	<48EA15B5.8020800@tu-dresden.de>	<f8e6ff050810060655p25baba3bw6ab54af0ef35acfa@mail.gmail.com>	<48EA1F2E.1060207@stats.uwo.ca>	<971536df0810070611y2c31e014rf6056c763e886686@mail.gmail.com>	<48EB6820.1000502@stats.uwo.ca>	<f8e6ff050810070717w53d62eebgf4d25d76a0aa0c90@mail.gmail.com>	<48EB76DF.1040709@stats.uwo.ca>
	<f8e6ff050810070910s4cafd260o469f7b716f1d03a5@mail.gmail.com>
Message-ID: <48EB943C.40408@gmail.com>

Hi Hadley,

<snip>

> I'd be happy to help, especially with my experience writing rdoc with
> R and with ruby.  I also have a couple of packages in development that
> currently don't have any documentation, where I'd be happy to
> experiment with new ways of doing documentation (I'm currently
> planning on trying out Roxygen)

You might want to try the R-plugin for Eclipse which has full Roxygen 
support since yesterday's 0.7 release:

- appropriate highlighting of Roxygen comments and tags
- generate Roxygen templates from R function,
     class etc. definitions
- use content-assist for Roxygen editing
- make use of R CMD roxygen inside Eclipse
   (R CMD Tools)

http://lists.r-forge.r-project.org/pipermail/statet-user/2008-October/000044.html
http://www.walware.de/goto/statet

Kind regards,
Tobias


From ripley at stats.ox.ac.uk  Thu Oct  9 08:27:24 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 9 Oct 2008 07:27:24 +0100 (BST)
Subject: [Rd] (PR#13132) splinefun gives incorrect derivs when
 extrapolating to the left
In-Reply-To: <20081007194827.28cec3f3@absentia>
References: <20081006175013.5D145282EF48@mail.pubhealth.ku.dk>
	<20081007193103.6aadd4c2@absentia>
	<20081007194827.28cec3f3@absentia>
Message-ID: <alpine.LFD.2.00.0810090726380.32500@gannet.stats.ox.ac.uk>

Berwin,

Thanks, I've merged this (second version) patch into 2.8.0 beta.

Brian

On Tue, 7 Oct 2008, Berwin A Turlach wrote:

> On Tue, 7 Oct 2008 19:31:03 +0800
> Berwin A Turlach <berwin at maths.uwa.edu.au> wrote:
>
>> The attached patch (against the current SVN version of R) implements
>> the latter strategy.  With this patch applied, "make check
>> FORCE=FORCE" passes on my machine.  The version of R that is build
>> seems to give the correct answer in your example:
>
> Perhaps I should have thought a bit more about this.  For a natural
> spline c[1] is zero, and d[1] is typically not but for evaluations
> left of the first knot it should be taken as zero.  So the attached
> patch solves the problem in what some might consider a more elegant
> manner. :)
>
> With the patch "make check FORCE=FORCE" works on my machine and it
> also solves your example:
>
> R> x <- 1:10
> R> y <- sin(x)
> R>
> R> splfun <- splinefun(x,y, method='natural')
> R>
> R> # these should be linear (and are)
> R> splfun( seq(0,1, 0.1) )
> [1] 0.5682923 0.5956102 0.6229280 0.6502459 0.6775638 0.7048816
> [7] 0.7321995 0.7595174 0.7868352 0.8141531 0.8414710
> R>
> R> # these should all be the same
> R> splfun( seq(0,1, 0.1), deriv=1 )
> [1] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
> [7] 0.2731787 0.2731787 0.2731787 0.2731787 0.2731787
> R>
> R> # these should all be 0
> R> splfun( seq(0,1, 0.1), deriv=2 )
> [1] 0 0 0 0 0 0 0 0 0 0 0
> R> splfun( seq(0,1, 0.1), deriv=3 )
> [1] 0 0 0 0 0 0 0 0 0 0 0
>
> HTH.
>
> Cheers,
>
> 	Berwin
>
> =========================== Full address =============================
> Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
> Dept of Statistics and Applied Probability        +65 6516 6650 (self)
> Faculty of Science                          FAX : +65 6872 3919
> National University of Singapore
> 6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
> Singapore 117546                    http://www.stat.nus.edu.sg/~statba
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jeff.horner at vanderbilt.edu  Thu Oct  9 16:20:10 2008
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Thu, 09 Oct 2008 09:20:10 -0500
Subject: [Rd] Expose clearPushBack for connections
Message-ID: <48EE131A.7040106@vanderbilt.edu>

Hi all,

rapache relies on embedding R and assigning it's own function to 
ptr_R_ReadConsole so that users can read HTTP POST data from a request 
with readLines() with the stdin() connection. However, since stdin() is 
a non-blocking text connection, incomplete lines are silently pushed 
back onto the connection. I don't see any other way to clear the pushed 
back data other than to call .Internal(clearPushBack(stdin()) which 
works well but may be deprecated in the future.

Are there other solutions to clear the stdin() push back stack for apps 
that embed R and use their own reading routines?

Thanks,

Jeff
-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From ripley at stats.ox.ac.uk  Thu Oct  9 17:14:55 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 9 Oct 2008 16:14:55 +0100 (BST)
Subject: [Rd] LinkingTo on Windows
In-Reply-To: <405593F1A35DDD11B2B4000C29F5CF530344DE@exchange-server.ow.ks>
References: <405593F1A35DDD11B2B4000C29F5CF530344DE@exchange-server.ow.ks>
Message-ID: <alpine.LFD.2.00.0810091524590.28002@gannet.stats.ox.ac.uk>

On Tue, 7 Oct 2008, Thomas Baier wrote:

> Dear List,
>
> R packages may specify a "LinkingTo" attribute to specify dependencies to
> the source code (mainly the header files) of other packages.
>
> Unfortunately, it is not possible to also have a reference to the generated
> library (.dll on Windows) of the other package. So including a header file
> from another package to call an (exported) function will just not help.

Have you read the documentation for 'LinkingTo'?  That is not what it is 
documented to do, and it does work on Windows (as documented).

> I've tried to implement a workaround for my package rcom (depending on
> exported functions from rscproxy) by "manually" setting the library when
> linking, but unfortunately this does not work for me, when rscproxy gets
> installed into a different library (not the default one). OK, I could set
> the library path relative to the source drive and absolute for the standard
> library, so the "R CMD check" on CRAN is passed, but I don't think this
> would be a good solution.
>
> Of course, I could implement true dynamic binding by getting a handle to the
> rscproxy.dll (which already has been loaded at the time of loading rcom) and
> getting out procedure addresses, but I don't think this is a good (general
> and portable) solution either.

Well, R_GetCCallable hides all these details for you.

> How can this issue be addressed? How can I solve the problem of linking to
> another package's library (if possible by just using "LinkingTo")

Hmm, it has been addressed and there are working examples (on CRAN and 
BioC).  However, there is another approach possible on Windows _only_ that 
seems close to what you are asking for.

On Windows there are two issues, compilation and run-time.  The run-time 
issue is easy to solve using the Dllpath argument to library.dynam (and 
that is the bit that cannot be done portably across OSes).  The 
compilation-time issue can be addressed in many ways, but perhaps the 
simplest is to make in package rcom an import library for rscproxy.dll

The main problem with the CRAN version of rcom is that rproxy.h is 
missing.  If I copy that file from the 2.7.2 sources and alter 
rcom/src/Makevars to have

PKG_LIBS = -L. -lrscproxy $(ADD_LIBS) -lole32 -luuid -loleaut32 -lgdi32
DLLTOOLFLAGS=--as $(AS)

before: librscproxy.dll.a
librscproxy.dll.a: rscproxy.def

with

$ cat rcom/src/rscproxy.def
LIBRARY rscproxy.dll
EXPORTS
  ANSI2BSTR
  BDX2SEXP
  BDX2Variant at 8
  BSTR2ANSI
  R_Proxy_printf
  SEXP2BDX
  Variant2BDX at 20
  bdx_free at 4
  com_addObject
  com_createSEXP
  com_getHandle
  com_getOLECHAR
  com_getObject

this installs for me (and I always install to a non-default library).

I then removed the useDynLib call in NAMESPACE and added in .onLoad

     toRscproxy <- system.file("libs", package="rscproxy")
     library.dynam("rcom", pkg, lib, Dllpath=toRscproxy)

but I am not sure that is needed if rscproxy.dll is already loaded into 
the process.

An alternative is to run R at install time and ask it to print out 
system.file("libs", package="rscproxy"), in a similar way to finding the 
'LinkingTo' paths.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Thomas.Petzoldt at TU-Dresden.de  Fri Oct 10 08:26:14 2008
From: Thomas.Petzoldt at TU-Dresden.de (Thomas Petzoldt)
Date: Fri, 10 Oct 2008 08:26:14 +0200
Subject: [Rd] why is \alias{anRpackage} not mandatory?
In-Reply-To: <48E9DE58.6070303@tu-dresden.de>
References: <48E9DE58.6070303@tu-dresden.de>
Message-ID: <48EEF586.9090403@TU-Dresden.de>

Dear R Developers,

first of all, many thanks for the constructive discussion. My question
was related to the use of existing mechanisms that (in my opinion) would
help to make package documentation more user-friendly. I agree that
additional restrictions/requirements on packages that do not not have
explicit objectives on performance or validity have to be avoided.

Thomas Petzoldt

--------------------------------------------------------------------

Summary and Wish-list

1 A recommendation to provide a file "foo-package.Rd" and an
\alias{foo} was already given in "Writing R Extensions".

2 In order to ensure consistency between foo-package.Rd, DESCRIPTION and
other sources of information, a mechanism to use variables and/or macros
in .Rd format is desirable.

3 There may be reasons, where manual creation and maintenance of
foo-package.Rd is not wanted, i.e. work load or danger of information
inconsistency. For such cases, an automated mechanism during package
installation may be helpful.

Already existing functions like

library(help="foo")
   or
promptPackage("foo", final=TRUE)

can do the job but may require extensions (hyperlinks).

4 The standard help format on Windows .chm should also find a way to
provide hyperlinks to package vignettes (and other pdfs), either
directly in the package index (as in html) or in foo-package.Rd


From rita.antony at phoenixyork.com  Fri Oct 10 12:54:54 2008
From: rita.antony at phoenixyork.com (Rita. A)
Date: Fri, 10 Oct 2008 03:54:54 -0700 (PDT)
Subject: [Rd]  Installing ROracle in windows.. Pls help
Message-ID: <19916116.post@talk.nabble.com>


I have installed R 2.7.2 in windows, now i am trying to install R oracle... I
am using Oracle 10g. i  have downloaded the Roracle 0.5-9 sources, and i am
trying to compile it using Vc++, i found from readme files and forum that,
we need to use the makefile.win in the \src folder and nmake utility of
vc++, since i have not worked with vc++, i don't have any idea , how to use
the nmake utility, can anybody help me with the steps required in compiling
the R oracle sources please.. ? Many thanks.
-- 
View this message in context: http://www.nabble.com/Installing-ROracle-in-windows..-Pls-help-tp19916116p19916116.html
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Fri Oct 10 13:14:17 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 10 Oct 2008 12:14:17 +0100 (BST)
Subject: [Rd] Installing ROracle in windows.. Pls help
In-Reply-To: <19916116.post@talk.nabble.com>
References: <19916116.post@talk.nabble.com>
Message-ID: <alpine.LFD.2.00.0810101204230.20865@gannet.stats.ox.ac.uk>

You have already sent this to R-help, and neither that list nor this is 
the place to ask for help on VC++.

Why do you need ROracle?  Most Windows users find it much easier to access 
Oracle via RODBC, which builds out of the box and has a pre-compiled 
version on CRAN.

On Fri, 10 Oct 2008, Rita. A wrote:

>
> I have installed R 2.7.2 in windows, now i am trying to install R oracle... I
> am using Oracle 10g. i  have downloaded the Roracle 0.5-9 sources, and i am
> trying to compile it using Vc++, i found from readme files and forum that,
> we need to use the makefile.win in the \src folder and nmake utility of
> vc++, since i have not worked with vc++, i don't have any idea , how to use
> the nmake utility, can anybody help me with the steps required in compiling
> the R oracle sources please.. ? Many thanks.

Well, the sources say this is documented in ROracle/src/Makefile.win (two 
versions, in fact).  If that is over your head, I can only suggest that 
your company employs someone else to do this for you.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From peter.ruckdeschel at web.de  Fri Oct 10 20:19:25 2008
From: peter.ruckdeschel at web.de (Peter Ruckdeschel)
Date: Fri, 10 Oct 2008 20:19:25 +0200
Subject: [Rd] relative path to source files in vignette
Message-ID: <48EF9CAD.8090006@web.de>

Hi,

this may be slightly off-topic, but as you are the experts:

we have written a small vignette, in which we want to refer to
.R, .Rd source files by means of relative paths.

More specifically, we want to use TeX package "listings" to include
source code,

[which btw in the mean time works pretty well together with "fancyvrb"
so can be used
 with Sweave without problems...]

To avoid redundancy we would like to use

  \lstinputlisting[firstline=<n1>,lastline=<n2>]{<r-source-file.R>}

and to do so we somehow need path information.

This is /not/ a "listings" issue, as we might also have used
   \input{<r-source-file.R>}, only is \lstinputlisting a bit more
flexible...

Using relative paths, i.e. as the vignette resides in subfolder "inst/doc"
something like

     ../../../<mypkg>/R/<myR.R>    or   ../../../<mypkg>/man/<myRd.Rd>

does the job for  both  R CMD build   and   R CMD check ,
--- in standard configurations.

However, as you may change the location of the check folder with
the -o option of R CMD check, (and possibly other things, we have
not yet thought of ...), our solution is not quite satisfactory,
so we have been wondering whether there is a (platform-independent)
way to access the package source folder (under check) from within
TeX.

--- or if you prefer to solve it from R-side:

We would appreciate an Sweave-chunk to do the following:
+have three arguments firstline, lastline, filename
  [where filename is relative to the package source folder]
+read out the information about the path to the package
  source folder [from the env-variable?]
+with this information read in the part of the source file
  between <firstline> and <lastline>
  and places this content ---without wrapping it to
  \begin{Schunk} ... \end{Schunk}--- into the .tex file
  ---preferrably  already into a \begin{listing}\end{listing}
   environment...

Any suggestions how to resolve this?

Thank you already,
Peter


From ggrothendieck at gmail.com  Fri Oct 10 20:27:05 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 10 Oct 2008 14:27:05 -0400
Subject: [Rd] relative path to source files in vignette
In-Reply-To: <48EF9CAD.8090006@web.de>
References: <48EF9CAD.8090006@web.de>
Message-ID: <971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>

See ?system.file with the package= argument.

On Fri, Oct 10, 2008 at 2:19 PM, Peter Ruckdeschel
<peter.ruckdeschel at web.de> wrote:
> Hi,
>
> this may be slightly off-topic, but as you are the experts:
>
> we have written a small vignette, in which we want to refer to
> .R, .Rd source files by means of relative paths.
>
> More specifically, we want to use TeX package "listings" to include
> source code,
>
> [which btw in the mean time works pretty well together with "fancyvrb"
> so can be used
>  with Sweave without problems...]
>
> To avoid redundancy we would like to use
>
>  \lstinputlisting[firstline=<n1>,lastline=<n2>]{<r-source-file.R>}
>
> and to do so we somehow need path information.
>
> This is /not/ a "listings" issue, as we might also have used
>   \input{<r-source-file.R>}, only is \lstinputlisting a bit more
> flexible...
>
> Using relative paths, i.e. as the vignette resides in subfolder "inst/doc"
> something like
>
>     ../../../<mypkg>/R/<myR.R>    or   ../../../<mypkg>/man/<myRd.Rd>
>
> does the job for  both  R CMD build   and   R CMD check ,
> --- in standard configurations.
>
> However, as you may change the location of the check folder with
> the -o option of R CMD check, (and possibly other things, we have
> not yet thought of ...), our solution is not quite satisfactory,
> so we have been wondering whether there is a (platform-independent)
> way to access the package source folder (under check) from within
> TeX.
>
> --- or if you prefer to solve it from R-side:
>
> We would appreciate an Sweave-chunk to do the following:
> +have three arguments firstline, lastline, filename
>  [where filename is relative to the package source folder]
> +read out the information about the path to the package
>  source folder [from the env-variable?]
> +with this information read in the part of the source file
>  between <firstline> and <lastline>
>  and places this content ---without wrapping it to
>  \begin{Schunk} ... \end{Schunk}--- into the .tex file
>  ---preferrably  already into a \begin{listing}\end{listing}
>   environment...
>
> Any suggestions how to resolve this?
>
> Thank you already,
> Peter
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From peter.ruckdeschel at web.de  Fri Oct 10 20:48:32 2008
From: peter.ruckdeschel at web.de (Peter Ruckdeschel)
Date: Fri, 10 Oct 2008 20:48:32 +0200
Subject: [Rd] relative path to source files in vignette
In-Reply-To: <971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>
References: <48EF9CAD.8090006@web.de>
	<971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>
Message-ID: <48EFA380.8080801@web.de>

Gabor Grothendieck schrieb:
> See ?system.file with the package= argument.
>   

Thank you Gabor,

but this refers to the /installed/ package, while we are needing
path information about the not-yet-built source code of the
package during R CMD check / build.

Peter


From ggrothendieck at gmail.com  Fri Oct 10 22:34:00 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 10 Oct 2008 16:34:00 -0400
Subject: [Rd] relative path to source files in vignette
In-Reply-To: <48EFA380.8080801@web.de>
References: <48EF9CAD.8090006@web.de>
	<971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>
	<48EFA380.8080801@web.de>
Message-ID: <971536df0810101334w12014877t408732c9f12edc20@mail.gmail.com>

Try placing a copy of the files in the inst directory and then
accessing them via system.files("myfile.R", package = "mypackage")
or place them in the same directory as the Sweave file
and then access them without a directory path at all:
readLines("myfile.R")


On Fri, Oct 10, 2008 at 2:48 PM, Peter Ruckdeschel
<peter.ruckdeschel at web.de> wrote:
> Gabor Grothendieck schrieb:
>> See ?system.file with the package= argument.
>>
>
> Thank you Gabor,
>
> but this refers to the /installed/ package, while we are needing
> path information about the not-yet-built source code of the
> package during R CMD check / build.
>
> Peter
>


From peter.ruckdeschel at web.de  Sat Oct 11 01:06:17 2008
From: peter.ruckdeschel at web.de (Peter Ruckdeschel)
Date: Sat, 11 Oct 2008 01:06:17 +0200
Subject: [Rd] relative path to source files in vignette
In-Reply-To: <971536df0810101334w12014877t408732c9f12edc20@mail.gmail.com>
References: <48EF9CAD.8090006@web.de>	
	<971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>	
	<48EFA380.8080801@web.de>
	<971536df0810101334w12014877t408732c9f12edc20@mail.gmail.com>
Message-ID: <48EFDFE9.1050806@web.de>

Thanks again Gabor, for your quick reply,
> Try placing a copy of the files in the inst directory and then
> accessing them via system.files("myfile.R", package = "mypackage")
>   
you mean I should do this in an S-chunk in the .Rnw file?
I.e., running Sweave on it would then produce the copy into my Sweave file
I need?

This could indeed be an opition, but as noted in my reply to Robert, my
guess
is that in the library where you install your packages to and which is
found with
system.file(), you will no longer find the R source files but rather
some .rdb
or .rdx file. At least this is what I found --- or is there some magic trick
to get back the source files from this?

> or place them in the same directory as the Sweave file
> and then access them without a directory path at all:
> readLines("myfile.R")
>   
If I put the sources statically into the same directory as the Sweave file
(i.e. in [...]/myRsources/myPkg/inst/doc),
of course everything works fine;

The issue is that I want to "dynamically" include parts of the source
R code itself (without unnecessary static copying the source R code
due to consistency traps, when changing the R code but not
the copy)  from the R directory of the package into the Sweave
file by something like
         
  \input{[Path]/myRfile.R}

so that once I change the R code, I do not have to change
the .Rnw file.

[I do not include the whole .R file but only certain lines of it, of course]

As already said, in a standard configuration something like
\input{../../../myPkg/R/myRfile.R}  
   % goes from [...]/myRSources/myPkg/inst/src to [...]/myRSources/myPkg/R
   % in R CMD build
   % resp. from [...]/myRSources/myPkg.Rcheck/inst/src to
[...]/myRSources/myPkg/R
   % in R CMD check
does the job.

Now if I am in [...]/myRSources and say something like

R CMD build myPkg     ### still works
R CMD check myPkg -o  /yetAnotherPath/myCheck
   ## does not work as  /yetAnotherPath/myPkg/R need not be [...]/myPkg/R

So what I was looking for was something like defining an environment
variable
$myRSources (in a platform-independent way)
which may be accessed (in a platform-independent way) from
the TeX command \input{...}  --- perhaps with something like

\input{$myRSources/myPkg/R/myRfile.R}

but I cannot figure out how to do this...

Thank you once again
Peter


From ggrothendieck at gmail.com  Sat Oct 11 01:59:59 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 10 Oct 2008 19:59:59 -0400
Subject: [Rd] relative path to source files in vignette
In-Reply-To: <48EFDFE9.1050806@web.de>
References: <48EF9CAD.8090006@web.de>
	<971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>
	<48EFA380.8080801@web.de>
	<971536df0810101334w12014877t408732c9f12edc20@mail.gmail.com>
	<48EFDFE9.1050806@web.de>
Message-ID: <971536df0810101659j710b91cahdf7e4fac3b0af280@mail.gmail.com>

On Fri, Oct 10, 2008 at 7:06 PM, Peter Ruckdeschel
<peter.ruckdeschel at web.de> wrote:
> Thanks again Gabor, for your quick reply,
>> Try placing a copy of the files in the inst directory and then
>> accessing them via system.files("myfile.R", package = "mypackage")
>>
> you mean I should do this in an S-chunk in the .Rnw file?
> I.e., running Sweave on it would then produce the copy into my Sweave file
> I need?
>
> This could indeed be an opition, but as noted in my reply to Robert, my
> guess
> is that in the library where you install your packages to and which is
> found with
> system.file(), you will no longer find the R source files but rather
> some .rdb
> or .rdx file. At least this is what I found --- or is there some magic trick
> to get back the source files from this?

Yes, that is what occurs. That's why it was suggested to copy it.

>
>> or place them in the same directory as the Sweave file
>> and then access them without a directory path at all:
>> readLines("myfile.R")
>>
> If I put the sources statically into the same directory as the Sweave file
> (i.e. in [...]/myRsources/myPkg/inst/doc),
> of course everything works fine;
>
> The issue is that I want to "dynamically" include parts of the source
> R code itself (without unnecessary static copying the source R code
> due to consistency traps, when changing the R code but not
> the copy)  from the R directory of the package into the Sweave
> file by something like
>
>  \input{[Path]/myRfile.R}
>
> so that once I change the R code, I do not have to change
> the .Rnw file.
>
> [I do not include the whole .R file but only certain lines of it, of course]
>
> As already said, in a standard configuration something like
> \input{../../../myPkg/R/myRfile.R}
>   % goes from [...]/myRSources/myPkg/inst/src to [...]/myRSources/myPkg/R
>   % in R CMD build
>   % resp. from [...]/myRSources/myPkg.Rcheck/inst/src to
> [...]/myRSources/myPkg/R
>   % in R CMD check
> does the job.
>
> Now if I am in [...]/myRSources and say something like
>
> R CMD build myPkg     ### still works
> R CMD check myPkg -o  /yetAnotherPath/myCheck
>   ## does not work as  /yetAnotherPath/myPkg/R need not be [...]/myPkg/R
>
> So what I was looking for was something like defining an environment
> variable
> $myRSources (in a platform-independent way)
> which may be accessed (in a platform-independent way) from
> the TeX command \input{...}  --- perhaps with something like
>
> \input{$myRSources/myPkg/R/myRfile.R}
>
> but I cannot figure out how to do this...
>
> Thank you once again
> Peter
>
>

Perhaps you should just preprocess your Sweave files prior to the build.
The brew package could be used, for example.


From bolker at zoology.ufl.edu  Sat Oct 11 04:15:49 2008
From: bolker at zoology.ufl.edu (Ben Bolker)
Date: Fri, 10 Oct 2008 22:15:49 -0400
Subject: [Rd] problem with cut.Date/date plotting in ggplot2
Message-ID: <48F00C55.202@zoology.ufl.edu>


   I've hit a problem in ggplot2 which I can trace back to cut.Date ,
which is either a bug or (??) ggplot2 trying to do something it
shouldn't with cut.Date (although its use of cut.Date seems OK).

  Apparently any (?) call of the form

cut(as.Date("2008-07-07"),"weeks")

where the date *begins the week*, gives the error

Error in 1:(1 + max(which(breaks < maxx))) :
  result would be too long a vector
In addition: Warning message:
In max(which(breaks < maxx)) :
  no non-missing arguments to max; returning -Inf

  In particular, try:

d <- seq.Date(as.Date("2008-07-05"),as.Date("2008-07-08"),by="days")
weekdays(d)

cut(d[1],"weeks") ## OK
cut(d[2],"weeks") ## OK
cut(d[3],"weeks") ## Monday -- breaks
cut(d[4],"weeks") ## OK

cut(d[1],"weeks",start.on.monday=FALSE) ## OK
cut(d[2],"weeks",start.on.monday=FALSE) ## Sunday -- breaks
cut(d[3],"weeks",start.on.monday=FALSE) ## OK
cut(d[4],"weeks",start.on.monday=FALSE) ## OK

  The particular line that fails within cut.Date is

breaks <- breaks[1:(1 + max(which(breaks < maxx)))]

  but I haven't figured out enough about what's going on
to be able to suggest a fix ...

  cheers
    Ben Bolker

session info:

> sessionInfo()
R version 2.7.2 (2008-08-25)
i486-pc-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] splines   grid      stats     graphics  grDevices utils     datasets
[8] methods   base

other attached packages:
[1] ggplot2_0.7        MASS_7.2-44        RColorBrewer_1.0-2 proto_0.3-8

[5] reshape_0.8.1      plyr_0.1


 Here's the context in which I encountered the problem:

library(ggplot2)
tdat <- data.frame(date=seq.Date(as.Date("2008-07-07"),
                     as.Date("2008-10-10"),by="day"),
                   x=1:96)
q2 = qplot(date,x,data=tdat,geom="smooth")
print(q2+geom_point())

  I can track the problem down to a call like

floor_date(as.Date("2008-07-07"),"weeks")

and digging further in, I can narrow it down to
the issue above.


From h.wickham at gmail.com  Sat Oct 11 17:31:35 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Sat, 11 Oct 2008 10:31:35 -0500
Subject: [Rd] problem with cut.Date/date plotting in ggplot2
In-Reply-To: <48F00C55.202@zoology.ufl.edu>
References: <48F00C55.202@zoology.ufl.edu>
Message-ID: <f8e6ff050810110831p33be15c4n9a51dac5a3e3d765@mail.gmail.com>

Hi Ben,

I think is a bug with cut.Date.  I reported a similar bug (with days)
a couple of weeks ago but no one responded.

Hadley

On Fri, Oct 10, 2008 at 9:15 PM, Ben Bolker <bolker at zoology.ufl.edu> wrote:
>
>   I've hit a problem in ggplot2 which I can trace back to cut.Date ,
> which is either a bug or (??) ggplot2 trying to do something it
> shouldn't with cut.Date (although its use of cut.Date seems OK).
>
>  Apparently any (?) call of the form
>
> cut(as.Date("2008-07-07"),"weeks")
>
> where the date *begins the week*, gives the error
>
> Error in 1:(1 + max(which(breaks < maxx))) :
>  result would be too long a vector
> In addition: Warning message:
> In max(which(breaks < maxx)) :
>  no non-missing arguments to max; returning -Inf
>
>  In particular, try:
>
> d <- seq.Date(as.Date("2008-07-05"),as.Date("2008-07-08"),by="days")
> weekdays(d)
>
> cut(d[1],"weeks") ## OK
> cut(d[2],"weeks") ## OK
> cut(d[3],"weeks") ## Monday -- breaks
> cut(d[4],"weeks") ## OK
>
> cut(d[1],"weeks",start.on.monday=FALSE) ## OK
> cut(d[2],"weeks",start.on.monday=FALSE) ## Sunday -- breaks
> cut(d[3],"weeks",start.on.monday=FALSE) ## OK
> cut(d[4],"weeks",start.on.monday=FALSE) ## OK
>
>  The particular line that fails within cut.Date is
>
> breaks <- breaks[1:(1 + max(which(breaks < maxx)))]
>
>  but I haven't figured out enough about what's going on
> to be able to suggest a fix ...
>
>  cheers
>    Ben Bolker
>
> session info:
>
>> sessionInfo()
> R version 2.7.2 (2008-08-25)
> i486-pc-linux-gnu
>
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] splines   grid      stats     graphics  grDevices utils     datasets
> [8] methods   base
>
> other attached packages:
> [1] ggplot2_0.7        MASS_7.2-44        RColorBrewer_1.0-2 proto_0.3-8
>
> [5] reshape_0.8.1      plyr_0.1
>
>
>  Here's the context in which I encountered the problem:
>
> library(ggplot2)
> tdat <- data.frame(date=seq.Date(as.Date("2008-07-07"),
>                     as.Date("2008-10-10"),by="day"),
>                   x=1:96)
> q2 = qplot(date,x,data=tdat,geom="smooth")
> print(q2+geom_point())
>
>  I can track the problem down to a call like
>
> floor_date(as.Date("2008-07-07"),"weeks")
>
> and digging further in, I can narrow it down to
> the issue above.
>
>
>
>



-- 
http://had.co.nz/


From brainy at lava.net  Fri Oct 10 21:15:14 2008
From: brainy at lava.net (brainy at lava.net)
Date: Fri, 10 Oct 2008 21:15:14 +0200 (CEST)
Subject: [Rd] R project needs online capability (PR#13150)
Message-ID: <20081010191514.BC10A282C787@mail.pubhealth.ku.dk>

I did not see a contact email address for the R project at 
http://www.r-project.org, so I am using the above email address.

I would like to make a suggestion that the R project provide an online
capability similar to http://www.eskimo.com/~brainy


J. Charles "Darwin" Widdoes, www.lava.net/~brainy www.eskimo.com/~brainy


From wchen at stat.tamu.edu  Tue Oct  7 00:05:06 2008
From: wchen at stat.tamu.edu (wchen at stat.tamu.edu)
Date: Tue,  7 Oct 2008 00:05:06 +0200 (CEST)
Subject: [Rd] match() (PR#13135)
Message-ID: <20081006220506.C888B282EF48@mail.pubhealth.ku.dk>

Full_Name: Willa Chen
Version: 2.7.2
OS: Window XP
Submission from: (NULL) (128.122.182.70)




The match function does not return value properly. See an example below. 


> a<-seq(0.6,1,by=0.01)
> match(0.88,a)
[1] 29
> match(0.89,a)
[1] NA
> match(0.90,a)
[1] NA
> match(0.91,a)
[1] NA
> match(0.92,a)
[1] NA
> match(0.93,a)
[1] NA
> match(0.94,a)
[1] 35


From svga at arcor.de  Tue Oct  7 14:53:41 2008
From: svga at arcor.de (svga at arcor.de)
Date: Tue, 7 Oct 2008 14:53:41 +0200 (CEST)
Subject: [Rd] SPSS export in R package foreign
Message-ID: <11728111.1223384021659.JavaMail.ngmail@webmail14.arcor-online.net>

Hi there,

I found that ordered factors are exported as nominal variables in writeForeignSPSS (foreign package version 0.8-29), e.g:

   datafile<-tempfile()
   codefile<-tempfile()
   dat <- data.frame(ID=factor(letters[1:3]), x=1:3,
                     f=factor(LETTERS[1:3], ordered=TRUE),
                     y=1:3,
                     f2=factor(c("Bla", "AA", "GG"), ordered=TRUE),
                     f3=factor(c("gf", "th", "jk")))

   write.foreign(dat, datafile, codefile, package="SPSS")
   file.show(codefile)

Surprisingly, applying the resulting SPSS syntax, all variables  are nominal in SPSS for Windows Version 15. 

So I added the following code to "writeForeignSPSS" to preserve the type of variables:

....  
     ordinal <- sapply(df, is.ordered)
        if (any(ordinal)) {
            cat(paste("\nVARIABLE LEVEL", paste(varnames[ordinal],
                                                collapse=" "),
                      "(ORDINAL).\n"),
                file = codefile, append = TRUE)
        }
        num <- sapply(df, is.numeric)
        if (any(num)) {
            cat(paste("\nVARIABLE LEVEL", paste(varnames[num],
                                                collapse=" "),
                      "(SCALE).\n"),
                 file = codefile, append = TRUE)
        }
...

just before the last line  cat("\nEXECUTE.\n", file = codefile, append = TRUE). This works for me. Please find the modified function "writeForeignMySPSS" at the end of this email. 

Maybe this is helpful, best regards

Sven

here comes my modiefied version:

   writeForeignMySPSS <- function (df, datafile, codefile, varnames = NULL)
    {
        adQuote <-  function (x) paste("\"", x, "\"", sep = "")

        dfn <- lapply(df, function(x) if (is.factor(x))
                      as.numeric(x)
        else x)
        write.table(dfn, file = datafile, row = FALSE, col = FALSE,
                    sep = ",", quote = FALSE, na = "", eol = ",\n")
        varlabels <- names(df)
        if (is.null(varnames)) {
            varnames <- abbreviate(names(df), 8L)
            if (any(sapply(varnames, nchar) > 8L))
                stop("I cannot abbreviate the variable names to eight or fewer letters")
            if (any(varnames != varlabels))
                warning("some variable names were abbreviated")
        }
        varnames <- gsub("[^[:alnum:]_\\$@#]", "\\.", varnames)
        dl.varnames <- varnames
        if (any(chv <- sapply(df, is.character))) {
            lengths <- sapply(df[chv], function(v) max(nchar(v)))
            if (any(lengths > 255L))
                stop("Cannot handle character variables longer than 255")
            lengths <- paste("(A", lengths, ")", sep = "")
            star <- ifelse(c(FALSE, diff(which(chv) > 1)), " *",
                           " ")
            dl.varnames[chv] <- paste(star, dl.varnames[chv], lengths)
        }
        cat("DATA LIST FILE=", adQuote(datafile), " free (\",\")\n",
            file = codefile)
        cat("/", dl.varnames, " .\n\n", file = codefile, append = TRUE)
        cat("VARIABLE LABELS\n", file = codefile, append = TRUE)
        cat(paste(varnames, adQuote(varlabels), "\n"), ".\n", file = codefile,
            append = TRUE)
        factors <- sapply(df, is.factor)
        if (any(factors)) {
            cat("\nVALUE LABELS\n", file = codefile, append = TRUE)
            for (v in which(factors)) {
                cat("/\n", file = codefile, append = TRUE)
                cat(varnames[v], " \n", file = codefile, append = TRUE)
                levs <- levels(df[[v]])
                cat(paste(1:length(levs), adQuote(levs), "\n", sep = " "),
                    file = codefile, append = TRUE)
            }
            cat(".\n", file = codefile, append = TRUE)
        }
        ordinal <- sapply(df, is.ordered)
        if (any(ordinal)) {
            cat(paste("\nVARIABLE LEVEL", paste(varnames[ordinal],
                                                collapse=" "),
                      "(ORDINAL).\n"),
                file = codefile, append = TRUE)
        }
        num <- sapply(df, is.numeric)
        if (any(num)) {
            cat(paste("\nVARIABLE LEVEL", paste(varnames[num],
                                                collapse=" "),
                      "(SCALE).\n"),
                 file = codefile, append = TRUE)
        }
        cat("\nEXECUTE.\n", file = codefile, append = TRUE)
    }


From Wolfgang.Viechtbauer at STAT.unimaas.nl  Thu Oct  9 18:25:58 2008
From: Wolfgang.Viechtbauer at STAT.unimaas.nl (Viechtbauer Wolfgang (STAT))
Date: Thu, 9 Oct 2008 18:25:58 +0200
Subject: [Rd] seg.fault from nlme::gnls() {was "[R-sig-ME] GNLS Crash"}
In-Reply-To: <FBFBD35F5823FD4E97ACDEBB353DD9C608D79D@NA-PA-VBE01.na.tibco.com>
Message-ID: <329A68716B57D54E8D39FD3F8A4A84DF0EB93FB9@um-mail0136.unimaas.nl>

Hello All,

I just wanted to bring this back again to the attention of the list(s) just to see if this issue can be resolved (but I'll understand if the development of the new mixed-model functions would take precedence over this).

Best,

-- 
Wolfgang Viechtbauer
?Department of Methodology and Statistics
?University of Maastricht, The Netherlands
?http://www.wvbauer.com/



----Original Message----
From: William Dunlap [mailto:wdunlap at tibco.com]
Sent: Monday, September 29, 2008 21:03
To: Martin Maechler; Viechtbauer Wolfgang (STAT)
Cc: r-sig-mixed-models at r-project.org; R-devel at stat.math.ethz.ch
Subject: RE: [Rd] seg.fault from nlme::gnls() {was "[R-sig-ME] GNLS
Crash"} 

>  When I run this under valgrind with gctorture(TRUE) I see memory
> misuse in mat_mult (matrix.c, line 82): % R-2.8.0-dev
> --debugger=valgrind --debugger-args=--db-attach=yes ... copyright
> blah blah ...   
>> data(Orange)
>> gctorture(TRUE)
>> gnls(circumference ~ Asym/(1 + exp(-(age-xmid)/scal)) ,
> + data = Orange, correlation = corExp(form = ~1 | Tree),
> + start = c(Asym=150, xmid=750, scal=300))
> r==5894== Invalid read of size 4
> ==5894==    at 0x580268F: mult_mat (matrix.c:82)
> ==5894==    by 0x57FF1B0: corStruct_recalc (corStruct.c:70)
> ==5894==    by 0x5801F89: gnls_objective (gnls.c:100)
> ==5894==    by 0x58020FE: fit_gnls (gnls.c:152)
> ==5894==    by 0x81439A2: do_dotCode (dotcode.c:1758)
> ==5894==    by 0x8161C56: Rf_eval (eval.c:487)
> ==5894==    by 0x81637D5: do_set (eval.c:1422)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> ==5894==    by 0x816384B: do_begin (eval.c:1174)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> ==5894==    by 0x816397B: do_repeat (eval.c:1137)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> ==5894==  Address 0x4E4A8CC is 12 bytes inside a block of size 864
> free'd ==5894==    at 0x40052A3: free (vg_replace_malloc.c:233)
> ==5894==    by 0x805ACFD: R_gc_internal (memory.c:767)
> ==5894==    by 0x805B933: Rf_cons (memory.c:1755)
> ==5894==    by 0x805B98E: Rf_allocList (memory.c:2094)
> ==5894==    by 0x815AB4C: replaceCall (Rinlinedfuns.h:84)
> ==5894==    by 0x8163476: applydefine (eval.c:919)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> ==5894==    by 0x816384B: do_begin (eval.c:1174)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> ==5894==    by 0x816384B: do_begin (eval.c:1174)
> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
> 
> My copy of valgrind doesn't get along with my copy of gdb,
> so when it pops into gdb the debugger doesn't get any information
> from *.so files.  I don't have the time now to put printf statements
> into mat_mult.  
> 
> Bill Dunlap
> wdunlap tibco.com
> 
> -----Original Message-----
> From: r-devel-bounces at r-project.org
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Martin Maechler 
> Sent: Saturday, September 27, 2008 2:20 AM
> To: Viechtbauer Wolfgang (STAT)
> Cc: r-sig-mixed-models at r-project.org; R-devel at stat.math.ethz.ch
> Subject: [Rd] seg.fault from nlme::gnls() {was "[R-sig-ME] GNLS
> Crash"} 
> 
>>>>>> "VW" == Viechtbauer Wolfgang (STAT)
>>>>>>     <Wolfgang.Viechtbauer at STAT.unimaas.nl> on Fri, 26 Sep 2008
>>>>>> 18:00:19 +0200 writes: 
> 
>> Hi all, I'm trying to fit a marginal (longitudinal)
>> model with an exponential serial correlation function to
>> the Orange tree data set. However, R crashes frequently
>> when using the gnls() function. With the following
>> simple example, I was able to reproduce the problem.
> 
> 
>> gnls.exp <- gnls(circumference ~ Asym/(1 + exp(-(age-xmid)/scal)) ,
>> data = Orange, correlation = corExp(form = ~1 | Tree),
>> start = c(Asym=150, xmid=750, scal=300))
> 
> Yes, I can reproduce it (on a Linux (RHEL 5) 64bit server), using R
> 2.8.0 alpha : Use this 
> 
> for(i in 1:20)# for MM: ca. 8 to 10 times --> seg.fault try( gnls.exp
>               <- gnls(circumference ~ Asym/(1 +
>               exp(-(age-xmid)/scal)) , data = Orange, correlation =
> corExp(form = ~1 | Tree), start = c(Asym=150, xmid=750, scal=300)) )
> 
> If I run it in the debugger and then do a backtrace I see
> 
> Error in gnls(circumference ~ Asym/(1 + exp(-(age - xmid)/scal)),
>   data = Orange,  : Step halving factor reduced below minimum in NLS
> step 
> 
> [............................................................]
> [...................the same about 6 times...................]
> [............................................................] 
> 
> Error in gnls(circumference ~ Asym/(1 + exp(-(age - xmid)/scal)),
>   data = Orange,  : Step halving factor reduced below minimum in NLS
>   step Error in .makeMessage(..., domain = domain) : incorrect number
> of arguments to "<-" 
> Error in .makeMessage(..., domain = domain) :
>   incorrect number of arguments to "<-"
> 
> Program received signal SIGABRT, Aborted.
> 0x0000003294e30155 in raise () from /lib64/libc.so.6
> (gdb) bt
> #0  0x0000003294e30155 in raise () from /lib64/libc.so.6
> #1  0x0000003294e31bf0 in abort () from /lib64/libc.so.6
> #2  0x00000000004184f5 in R_gc_internal (size_needed=0)
>     at ../../../R/src/main/memory.c:761
> #3  0x000000000041b121 in Rf_cons (car=0x1b2ec088, cdr=0x1a3436d8)
>     at ../../../R/src/main/memory.c:1755
> #4  0x0000000000578472 in applydefine (call=<value optimized out>,
>     op=0x1a3617a8, args=0x1ad47590, rho=0x1b2ea428)
>     at ../../../R/src/include/Rinlinedfuns.h:153
> #5  0x0000000000575a42 in Rf_eval (e=0x1ad47558, rho=0x1b2ea428)
>     at ../../../R/src/main/eval.c:461
> #6  0x0000000000576d50 in do_begin (call=0x1ad48450, op=0x1a362518,
>     args=0x1ad47520, rho=0x1b2ea428) at
>     ../../../R/src/main/eval.c:1174 #7  0x0000000000575a42 in Rf_eval
> (e=0x1ad48450, rho=0x1b2ea428) at ../../../R/src/main/eval.c:461 #8 
>     0x0000000000578f9c in Rf_applyClosure (call=0x1b2e9958,
>     op=0x1ad48370, arglist=0x1b2e9a70, rho=0x1b690298,
> suppliedenv=0x1b2e99c8) at ../../../R/src/main/eval.c:667 #9 
>     0x00000000004285b9 in Rf_usemethod (generic=0x67e8d7 "[",
>     obj=<value optimized out>, call=<value optimized out>,
>     args=<value optimized out>, rho=0xffffffffffffffff,
>     callrho=0x1b690298, defrho=0x1a384f28, ans=0x7fffcaa8d5a8) at
>     ../../../R/src/main/objects.c:311 #10 0x0000000000576a25 in
>     Rf_DispatchOrEval (call=0x1a81d8d0, op=0x1a3622e8,
>     generic=0x67e8d7 "[", args=0x1a81d908, rho=0x1b690298,
> ans=0x7fffcaa8d5a8, dropmissing=0, argsevald=0) at
>     ../../../R/src/main/eval.c:1930 #11 0x00000000004afc40 in
> do_subset (call=0x7716, op=0x7716, args=0xffffffffffffffff,
>     rho=0x1b690298) at ../../../R/src/main/subset.c:577 #12
>     0x0000000000575a42 in Rf_eval (e=0x1a81d8d0, rho=0x1b690298) at
> ../../../R/src/main/eval.c:461 #13 0x00000000005780c7 in applydefine
>     (call=0x1a81d748, op=0x1a3617a8, args=0x6,
> rho=0xffffffffffffffff) at ../../../R/src/main/eval.c:1318 #14
> 0x0000000000575a42 in Rf_eval (e=0x1a81d748, rho=0x1b690298) at
> ../../../R/src/main/eval.c:461 #15 0x00000000005775de in do_for
> (call=0x1a81d668, op=0x1a360180, args=0x1a81d6a0, rho=0x1b690298) at
> ../../../R/src/main/eval.c:1073     
> 
> ..... and more (downto #155 for R's main(...)
> 
> This is a bug,  probably in the C code of package nlme which I guess
> corrupts memory somehere earlier, and we are seeing the effect only
> later. I'll leave this to the (memory-)debugging experts...  
> 
> Martin
> 
>> On my and one other computer, R usually crashes when calling the
>> gnls() function with this code three times in a row. I stumbled
>> across this when trying to fit this model with different starting
>> values.   
> 
>> Version information:
> 
>> platform       i386-pc-mingw32
>     ......
>> version.string R version 2.7.2 (2008-08-25)
> 
>> Can anybody help figure out what causes this problem?
> 
>> Best,
> 
>> --
>> Wolfgang Viechtbauer
>> ?Department of Methodology and Statistics
>> ?University of Maastricht, The Netherlands
>> ?http://www.wvbauer.com/


From Jerry.Lewis at biogenidec.com  Thu Oct  9 18:50:08 2008
From: Jerry.Lewis at biogenidec.com (Jerry.Lewis at biogenidec.com)
Date: Thu,  9 Oct 2008 18:50:08 +0200 (CEST)
Subject: [Rd] Incomplete documentation for Long Input Lines (PR#13147)
Message-ID: <20081009165008.D2821282C764@mail.pubhealth.ku.dk>

Full_Name: Jerry W. Lewis
Version: 2.7.2
OS: Windows XP Professional
Submission from: (NULL) (198.180.131.16)


Section 1.8 of "An Introduction to R" states "Command lines entered at the
console are limited to about 1024 bytes (not characters)" and indicates that
incomplete lines may be continued on the next line.  There appear to be unstated
additional restrictions.  For instance, in a console entered assignment
statement using the c() function, if a comma occurs in position 1023, then that
line with its continuation on the next will not be interpreted correctly.


From Jerry.Lewis at biogenidec.com  Thu Oct  9 19:20:13 2008
From: Jerry.Lewis at biogenidec.com (Jerry.Lewis at biogenidec.com)
Date: Thu,  9 Oct 2008 19:20:13 +0200 (CEST)
Subject: [Rd] solve cdf for noncentrality (PR#11527)
Message-ID: <20081009172013.74386282EFC1@mail.pubhealth.ku.dk>

Full_Name: Jerry W. Lewis
Version: 2.7.0
OS: Windows XP Professional
Submission from: (NULL) (198.180.131.16)


If you are saying that there is no need to solve for the noncentrality
parameter, please justify this amazing assertion.

If you are saying that this need is already adequately addressed in R, then
please enlighten me.


From rita.antony at phoenixyork.com  Fri Oct 10 08:07:08 2008
From: rita.antony at phoenixyork.com (Rita. A)
Date: Thu, 9 Oct 2008 23:07:08 -0700 (PDT)
Subject: [Rd]  Installing ROracle in windows.. Pls help
Message-ID: <19912525.post@talk.nabble.com>


I have installed R 2.7.2 in windows, now i am trying to install R oracle... I
am using Oracle 10g. i  have downloaded the Roracle 0.5-9 sources, and i am
trying to compile it using Vc++, i found from readme files and forum that,
we need to use the makefile.win in the \src folder and nmake utility of
vc++, since i have not worked with vc++, i don't have any idea , how to use
the nmake utility, can anybody help me with the steps required in compiling
the R oracle sources please.. ?
-- 
View this message in context: http://www.nabble.com/Installing-ROracle-in-windows..-Pls-help-tp19912525p19912525.html
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Sat Oct 11 21:24:02 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 11 Oct 2008 20:24:02 +0100 (BST)
Subject: [Rd] match() (PR#13135)
In-Reply-To: <20081006220506.C888B282EF48@mail.pubhealth.ku.dk>
References: <20081006220506.C888B282EF48@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810112022330.8667@gannet.stats.ox.ac.uk>

FAQ Q7.31 strikes again!

0.89 is not a member of seq(0.6,1,by=0.01), since 0.01 cannot be 
represented exactly in a binary computer.

On Tue, 7 Oct 2008, wchen at stat.tamu.edu wrote:

> Full_Name: Willa Chen
> Version: 2.7.2
> OS: Window XP
> Submission from: (NULL) (128.122.182.70)
>
>
>
>
> The match function does not return value properly. See an example below.
>
>
>> a<-seq(0.6,1,by=0.01)
>> match(0.88,a)
> [1] 29
>> match(0.89,a)
> [1] NA
>> match(0.90,a)
> [1] NA
>> match(0.91,a)
> [1] NA
>> match(0.92,a)
> [1] NA
>> match(0.93,a)
> [1] NA
>> match(0.94,a)
> [1] 35
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ligges at statistik.tu-dortmund.de  Sat Oct 11 21:25:17 2008
From: ligges at statistik.tu-dortmund.de (ligges at statistik.tu-dortmund.de)
Date: Sat, 11 Oct 2008 21:25:17 +0200 (CEST)
Subject: [Rd] solve cdf for noncentrality (PR#11527)
Message-ID: <20081011192517.CF8E7282C787@mail.pubhealth.ku.dk>



Jerry.Lewis at biogenidec.com wrote:
> Full_Name: Jerry W. Lewis
> Version: 2.7.0
> OS: Windows XP Professional
> Submission from: (NULL) (198.180.131.16)
> 
> 
> If you are saying that there is no need to solve for the noncentrality
> parameter, please justify this amazing assertion.

- He? What noncentrality are you talking about?
- You are reporting a bug with an outdated version of R.
- You have not followed the guide on how to report bugs in R.

Uwe Ligges


> If you are saying that this need is already adequately addressed in R, then
> please enlighten me.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Sat Oct 11 21:25:11 2008
From: ligges at statistik.tu-dortmund.de (ligges at statistik.tu-dortmund.de)
Date: Sat, 11 Oct 2008 21:25:11 +0200 (CEST)
Subject: [Rd] match() (PR#13135)
Message-ID: <20081011192511.1E50E282C787@mail.pubhealth.ku.dk>



wchen at stat.tamu.edu wrote:
> Full_Name: Willa Chen
> Version: 2.7.2
> OS: Window XP
> Submission from: (NULL) (128.122.182.70)
> 
> 
> 
> 
> The match function does not return value properly. See an example below. 
> 
> 
>> a<-seq(0.6,1,by=0.01)
>> match(0.88,a)
> [1] 29
>> match(0.89,a)
> [1] NA

This is the FAQ "Why doesn't R think these numbers are equal?", but not 
a bug at all.

Uwe Ligges



>> match(0.90,a)
> [1] NA
>> match(0.91,a)
> [1] NA
>> match(0.92,a)
> [1] NA
>> match(0.93,a)
> [1] NA
>> match(0.94,a)
> [1] 35
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Sat Oct 11 21:44:06 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 11 Oct 2008 20:44:06 +0100 (BST)
Subject: [Rd] seg.fault from nlme::gnls() {was "[R-sig-ME] GNLS Crash"}
In-Reply-To: <329A68716B57D54E8D39FD3F8A4A84DF0EB93FB9@um-mail0136.unimaas.nl>
References: <329A68716B57D54E8D39FD3F8A4A84DF0EB93FB9@um-mail0136.unimaas.nl>
Message-ID: <alpine.LFD.2.00.0810112039250.8667@gannet.stats.ox.ac.uk>

Supplying a tested patch to the current nlme sources (on this list) would 
be the most effective way to get people's attention: otherwise it will be 
very low priority.

And please don't cross-post.

On Thu, 9 Oct 2008, Viechtbauer Wolfgang (STAT) wrote:

> Hello All,
>
> I just wanted to bring this back again to the attention of the list(s) just to see if this issue can be resolved (but I'll understand if the development of the new mixed-model functions would take precedence over this).
>
> Best,
>
> -- 
> Wolfgang Viechtbauer
> ?Department of Methodology and Statistics
> ?University of Maastricht, The Netherlands
> ?http://www.wvbauer.com/
>
>
>
> ----Original Message----
> From: William Dunlap [mailto:wdunlap at tibco.com]
> Sent: Monday, September 29, 2008 21:03
> To: Martin Maechler; Viechtbauer Wolfgang (STAT)
> Cc: r-sig-mixed-models at r-project.org; R-devel at stat.math.ethz.ch
> Subject: RE: [Rd] seg.fault from nlme::gnls() {was "[R-sig-ME] GNLS
> Crash"}
>
>>  When I run this under valgrind with gctorture(TRUE) I see memory
>> misuse in mat_mult (matrix.c, line 82): % R-2.8.0-dev
>> --debugger=valgrind --debugger-args=--db-attach=yes ... copyright
>> blah blah ...
>>> data(Orange)
>>> gctorture(TRUE)
>>> gnls(circumference ~ Asym/(1 + exp(-(age-xmid)/scal)) ,
>> + data = Orange, correlation = corExp(form = ~1 | Tree),
>> + start = c(Asym=150, xmid=750, scal=300))
>> r==5894== Invalid read of size 4
>> ==5894==    at 0x580268F: mult_mat (matrix.c:82)
>> ==5894==    by 0x57FF1B0: corStruct_recalc (corStruct.c:70)
>> ==5894==    by 0x5801F89: gnls_objective (gnls.c:100)
>> ==5894==    by 0x58020FE: fit_gnls (gnls.c:152)
>> ==5894==    by 0x81439A2: do_dotCode (dotcode.c:1758)
>> ==5894==    by 0x8161C56: Rf_eval (eval.c:487)
>> ==5894==    by 0x81637D5: do_set (eval.c:1422)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>> ==5894==    by 0x816384B: do_begin (eval.c:1174)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>> ==5894==    by 0x816397B: do_repeat (eval.c:1137)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>> ==5894==  Address 0x4E4A8CC is 12 bytes inside a block of size 864
>> free'd ==5894==    at 0x40052A3: free (vg_replace_malloc.c:233)
>> ==5894==    by 0x805ACFD: R_gc_internal (memory.c:767)
>> ==5894==    by 0x805B933: Rf_cons (memory.c:1755)
>> ==5894==    by 0x805B98E: Rf_allocList (memory.c:2094)
>> ==5894==    by 0x815AB4C: replaceCall (Rinlinedfuns.h:84)
>> ==5894==    by 0x8163476: applydefine (eval.c:919)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>> ==5894==    by 0x816384B: do_begin (eval.c:1174)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>> ==5894==    by 0x816384B: do_begin (eval.c:1174)
>> ==5894==    by 0x8161B3B: Rf_eval (eval.c:461)
>>
>> My copy of valgrind doesn't get along with my copy of gdb,
>> so when it pops into gdb the debugger doesn't get any information
>> from *.so files.  I don't have the time now to put printf statements
>> into mat_mult.
>>
>> Bill Dunlap
>> wdunlap tibco.com
>>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org
>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Martin Maechler
>> Sent: Saturday, September 27, 2008 2:20 AM
>> To: Viechtbauer Wolfgang (STAT)
>> Cc: r-sig-mixed-models at r-project.org; R-devel at stat.math.ethz.ch
>> Subject: [Rd] seg.fault from nlme::gnls() {was "[R-sig-ME] GNLS
>> Crash"}
>>
>>>>>>> "VW" == Viechtbauer Wolfgang (STAT)
>>>>>>>     <Wolfgang.Viechtbauer at STAT.unimaas.nl> on Fri, 26 Sep 2008
>>>>>>> 18:00:19 +0200 writes:
>>
>>> Hi all, I'm trying to fit a marginal (longitudinal)
>>> model with an exponential serial correlation function to
>>> the Orange tree data set. However, R crashes frequently
>>> when using the gnls() function. With the following
>>> simple example, I was able to reproduce the problem.
>>
>>
>>> gnls.exp <- gnls(circumference ~ Asym/(1 + exp(-(age-xmid)/scal)) ,
>>> data = Orange, correlation = corExp(form = ~1 | Tree),
>>> start = c(Asym=150, xmid=750, scal=300))
>>
>> Yes, I can reproduce it (on a Linux (RHEL 5) 64bit server), using R
>> 2.8.0 alpha : Use this
>>
>> for(i in 1:20)# for MM: ca. 8 to 10 times --> seg.fault try( gnls.exp
>>               <- gnls(circumference ~ Asym/(1 +
>>               exp(-(age-xmid)/scal)) , data = Orange, correlation =
>> corExp(form = ~1 | Tree), start = c(Asym=150, xmid=750, scal=300)) )
>>
>> If I run it in the debugger and then do a backtrace I see
>>
>> Error in gnls(circumference ~ Asym/(1 + exp(-(age - xmid)/scal)),
>>   data = Orange,  : Step halving factor reduced below minimum in NLS
>> step
>>
>> [............................................................]
>> [...................the same about 6 times...................]
>> [............................................................]
>>
>> Error in gnls(circumference ~ Asym/(1 + exp(-(age - xmid)/scal)),
>>   data = Orange,  : Step halving factor reduced below minimum in NLS
>>   step Error in .makeMessage(..., domain = domain) : incorrect number
>> of arguments to "<-"
>> Error in .makeMessage(..., domain = domain) :
>>   incorrect number of arguments to "<-"
>>
>> Program received signal SIGABRT, Aborted.
>> 0x0000003294e30155 in raise () from /lib64/libc.so.6
>> (gdb) bt
>> #0  0x0000003294e30155 in raise () from /lib64/libc.so.6
>> #1  0x0000003294e31bf0 in abort () from /lib64/libc.so.6
>> #2  0x00000000004184f5 in R_gc_internal (size_needed=0)
>>     at ../../../R/src/main/memory.c:761
>> #3  0x000000000041b121 in Rf_cons (car=0x1b2ec088, cdr=0x1a3436d8)
>>     at ../../../R/src/main/memory.c:1755
>> #4  0x0000000000578472 in applydefine (call=<value optimized out>,
>>     op=0x1a3617a8, args=0x1ad47590, rho=0x1b2ea428)
>>     at ../../../R/src/include/Rinlinedfuns.h:153
>> #5  0x0000000000575a42 in Rf_eval (e=0x1ad47558, rho=0x1b2ea428)
>>     at ../../../R/src/main/eval.c:461
>> #6  0x0000000000576d50 in do_begin (call=0x1ad48450, op=0x1a362518,
>>     args=0x1ad47520, rho=0x1b2ea428) at
>>     ../../../R/src/main/eval.c:1174 #7  0x0000000000575a42 in Rf_eval
>> (e=0x1ad48450, rho=0x1b2ea428) at ../../../R/src/main/eval.c:461 #8
>>     0x0000000000578f9c in Rf_applyClosure (call=0x1b2e9958,
>>     op=0x1ad48370, arglist=0x1b2e9a70, rho=0x1b690298,
>> suppliedenv=0x1b2e99c8) at ../../../R/src/main/eval.c:667 #9
>>     0x00000000004285b9 in Rf_usemethod (generic=0x67e8d7 "[",
>>     obj=<value optimized out>, call=<value optimized out>,
>>     args=<value optimized out>, rho=0xffffffffffffffff,
>>     callrho=0x1b690298, defrho=0x1a384f28, ans=0x7fffcaa8d5a8) at
>>     ../../../R/src/main/objects.c:311 #10 0x0000000000576a25 in
>>     Rf_DispatchOrEval (call=0x1a81d8d0, op=0x1a3622e8,
>>     generic=0x67e8d7 "[", args=0x1a81d908, rho=0x1b690298,
>> ans=0x7fffcaa8d5a8, dropmissing=0, argsevald=0) at
>>     ../../../R/src/main/eval.c:1930 #11 0x00000000004afc40 in
>> do_subset (call=0x7716, op=0x7716, args=0xffffffffffffffff,
>>     rho=0x1b690298) at ../../../R/src/main/subset.c:577 #12
>>     0x0000000000575a42 in Rf_eval (e=0x1a81d8d0, rho=0x1b690298) at
>> ../../../R/src/main/eval.c:461 #13 0x00000000005780c7 in applydefine
>>     (call=0x1a81d748, op=0x1a3617a8, args=0x6,
>> rho=0xffffffffffffffff) at ../../../R/src/main/eval.c:1318 #14
>> 0x0000000000575a42 in Rf_eval (e=0x1a81d748, rho=0x1b690298) at
>> ../../../R/src/main/eval.c:461 #15 0x00000000005775de in do_for
>> (call=0x1a81d668, op=0x1a360180, args=0x1a81d6a0, rho=0x1b690298) at
>> ../../../R/src/main/eval.c:1073
>>
>> ..... and more (downto #155 for R's main(...)
>>
>> This is a bug,  probably in the C code of package nlme which I guess
>> corrupts memory somehere earlier, and we are seeing the effect only
>> later. I'll leave this to the (memory-)debugging experts...
>>
>> Martin
>>
>>> On my and one other computer, R usually crashes when calling the
>>> gnls() function with this code three times in a row. I stumbled
>>> across this when trying to fit this model with different starting
>>> values.
>>
>>> Version information:
>>
>>> platform       i386-pc-mingw32
>>     ......
>>> version.string R version 2.7.2 (2008-08-25)
>>
>>> Can anybody help figure out what causes this problem?
>>
>>> Best,
>>
>>> --
>>> Wolfgang Viechtbauer
>>> ?Department of Methodology and Statistics
>>> ?University of Maastricht, The Netherlands
>>> ?http://www.wvbauer.com/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From h.wickham at gmail.com  Sun Oct 12 04:24:45 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Sat, 11 Oct 2008 21:24:45 -0500
Subject: [Rd] Thin spaces
Message-ID: <f8e6ff050810111924k7d5ef9bdg4bf96075f04fa390@mail.gmail.com>

Hi all,

I'm looking at providing some nicer number formatting features for
axes in ggplot2.  One thing I would like to do is use thin spaces to
separate digits, like you can in latex.  I realise I can use unicode
spaces to do this (e.g.
http://www.cs.tut.fi/~jkorpela/chars/spaces.html), but what are the
possible pitfalls.  Is this likely to work on all graphics devices
across all platforms?

Thanks,

Hadley

-- 
http://had.co.nz/


From ripley at stats.ox.ac.uk  Sun Oct 12 08:01:06 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 12 Oct 2008 07:01:06 +0100 (BST)
Subject: [Rd] Thin spaces
In-Reply-To: <f8e6ff050810111924k7d5ef9bdg4bf96075f04fa390@mail.gmail.com>
References: <f8e6ff050810111924k7d5ef9bdg4bf96075f04fa390@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0810120636100.16557@gannet.stats.ox.ac.uk>

On Sat, 11 Oct 2008, hadley wickham wrote:

> Hi all,
>
> I'm looking at providing some nicer number formatting features for
> axes in ggplot2.  One thing I would like to do is use thin spaces to
> separate digits, like you can in latex.  I realise I can use unicode
> spaces to do this (e.g.
> http://www.cs.tut.fi/~jkorpela/chars/spaces.html), but what are the
> possible pitfalls.  Is this likely to work on all graphics devices
> across all platforms?

Unlikely to work on most devices.

They are not supported in postscript() or pdf(): neither of their 
underlying languages support Unicode, so they are restricted to basically 
one human language.

windows(), quartz() and X11() support Unicode, but in the case of X11 the 
fonts are often pretty incomplete so you need to check on the target 
machine.  A quick check on windows() suggests \u2009 is not in the 
commonly used MS fonts (as your reference says).

All it needed was a very simple experiment to answer your question.  Hint: 
try

plot(1:10); text(4, 6, "1\u{2009}2")

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From berwin at maths.uwa.edu.au  Sun Oct 12 14:19:29 2008
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Sun, 12 Oct 2008 20:19:29 +0800
Subject: [Rd] (PR#13132) splinefun gives incorrect derivs when
 extrapolating to the left
In-Reply-To: <alpine.LFD.2.00.0810090726380.32500@gannet.stats.ox.ac.uk>
References: <20081006175013.5D145282EF48@mail.pubhealth.ku.dk>
	<20081007193103.6aadd4c2@absentia>
	<20081007194827.28cec3f3@absentia>
	<alpine.LFD.2.00.0810090726380.32500@gannet.stats.ox.ac.uk>
Message-ID: <20081012201929.0a17dafb@absentia>

Dear Brian,

On Thu, 9 Oct 2008 07:27:24 +0100 (BST)
Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:

> Thanks, I've merged this (second version) patch into 2.8.0 beta.

My pleasure.  I thought it would be only fair that I fix the infelicity
in the code after having provided the initial patch that introduced
it. :)

Apologies also for not realising that the bug repository truncates
over long subject line and having thus filed two additional reports.
Will remember that in future.

Best wishes,

	Berwin


From h.wickham at gmail.com  Sun Oct 12 15:58:44 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 12 Oct 2008 08:58:44 -0500
Subject: [Rd] Thin spaces
In-Reply-To: <alpine.LFD.2.00.0810120636100.16557@gannet.stats.ox.ac.uk>
References: <f8e6ff050810111924k7d5ef9bdg4bf96075f04fa390@mail.gmail.com>
	<alpine.LFD.2.00.0810120636100.16557@gannet.stats.ox.ac.uk>
Message-ID: <f8e6ff050810120658l24e32058sf7d089df308bf797@mail.gmail.com>

On Sun, Oct 12, 2008 at 1:01 AM, Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
> On Sat, 11 Oct 2008, hadley wickham wrote:
>
>> Hi all,
>>
>> I'm looking at providing some nicer number formatting features for
>> axes in ggplot2.  One thing I would like to do is use thin spaces to
>> separate digits, like you can in latex.  I realise I can use unicode
>> spaces to do this (e.g.
>> http://www.cs.tut.fi/~jkorpela/chars/spaces.html), but what are the
>> possible pitfalls.  Is this likely to work on all graphics devices
>> across all platforms?
>
> Unlikely to work on most devices.

Thanks for the information.  I realise I could have tried the
experiment you described, but that would have only told me it didn't
work on the mac, and it wouldn't have told me if there was another way
to achieve the same effect.

I guess latex must vary the size of a standard space rather than using
a special unicode space.  This is probably not surprising given that
latex considerably predates unicode.

Thanks again for the help,

Hadley

-- 
http://had.co.nz/


From ripley at stats.ox.ac.uk  Sun Oct 12 16:43:26 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 12 Oct 2008 15:43:26 +0100 (BST)
Subject: [Rd] Thin spaces
In-Reply-To: <f8e6ff050810120658l24e32058sf7d089df308bf797@mail.gmail.com>
References: <f8e6ff050810111924k7d5ef9bdg4bf96075f04fa390@mail.gmail.com>
	<alpine.LFD.2.00.0810120636100.16557@gannet.stats.ox.ac.uk>
	<f8e6ff050810120658l24e32058sf7d089df308bf797@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0810121541330.6167@gannet.stats.ox.ac.uk>

On Sun, 12 Oct 2008, hadley wickham wrote:

> On Sun, Oct 12, 2008 at 1:01 AM, Prof Brian Ripley
> <ripley at stats.ox.ac.uk> wrote:
>> On Sat, 11 Oct 2008, hadley wickham wrote:
>>
>>> Hi all,
>>>
>>> I'm looking at providing some nicer number formatting features for
>>> axes in ggplot2.  One thing I would like to do is use thin spaces to
>>> separate digits, like you can in latex.  I realise I can use unicode
>>> spaces to do this (e.g.
>>> http://www.cs.tut.fi/~jkorpela/chars/spaces.html), but what are the
>>> possible pitfalls.  Is this likely to work on all graphics devices
>>> across all platforms?
>>
>> Unlikely to work on most devices.
>
> Thanks for the information.  I realise I could have tried the
> experiment you described, but that would have only told me it didn't
> work on the mac, and it wouldn't have told me if there was another way
> to achieve the same effect.
>
> I guess latex must vary the size of a standard space rather than using
> a special unicode space.  This is probably not surprising given that
> latex considerably predates unicode.

Yes, latex (more precisely TeX) sets words separately (and when kerning is 
involved, parts of words), with 'space' being converted into glue between 
boxes.  Most other desktop-publishing programs do the same.

>
> Thanks again for the help,
>
> Hadley
>
> -- 
> http://had.co.nz/
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Sun Oct 12 17:36:56 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 12 Oct 2008 16:36:56 +0100 (BST)
Subject: [Rd] RFC: Kerning, postscript() and pdf()
Message-ID: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>

Ei-ji Nakama has pointed out (from another Japanese user, I believe) that 
postscript() and pdf() have not been handling kerning correctly, and this 
is a request for opinions about how we should correct it.

Kerning is the adjustment of the spacing between letters from their 
natural width, so that for example 'Yo' is usually typeset with the o 
closer to the Y than 'Yl' would be.  Kerning is not very well 
standardized, so that for example R's default Helvetica and its URW clone 
(Nimbus Sans) have quite different ideas of the amount of kerning 
corrections for 'Yo'. This matters, because not many people actually see 
Helvetica when viewing R's PostScript or PDF output, but rather a similar 
face like Nimbus Sans or Arial, or in the case of Acrobat Reader, a not 
very similar face.  Kerning is only a feature of some proportionally 
spaced fonts and so not of Courier nor CJK fonts.

The current position (R <= 2.8.0) is that string widths have been 
computing using kerning from the Adobe Font Metric files for the nominal 
font, but the strings have been displayed without using kerning (at least 
in the viewers we are aware of, and the PostScript and PDF reference 
manuals mandate that behaviour, if rather obscurely).  This means that in 
strings such as 'You', the width used in the string placement differs from 
that actually displayed.

For postscript(), this doesn't have much impact, as centring or right 
justification ('hadj' in text()) is done by PostScript code and computes 
the width from the actual font used (and so copes well with font 
substitution).  It might affect the fine layout in plotmath, but using 
strings which would be kerned in annotations is not common.

For pdf() the effect is more commonly seen, as all text is set 
left-justified, and the computed width is used to centre/right-justify.

There are several things we could do:

A.  Do nothing, for back compatibility.  After all, this has been going on 
for years and no one has complained until last month.

B.  Ignore kerning, and hence change the string width computations to 
match the current display.  This is more attractive than it appears at 
first sight -- as far as I know all other devices ignore kerning, and we 
are increasingly used to seeing 'typeset' output without kerning.  It 
would be desirable when copying graphs by e.g. dev.copy2eps from devices 
that do not kern.

C.  Insert kerning corrections by splitting up strings, so e.g. 'You' is 
set as (Y)-140 kc(ou): this is what TeX engines do.

D.  Compute the position of each letter in the string and place them 
individually.

C and D would give visually identical output when the font used is exactly 
as specified, and hopefully also when a substitute font is using with the 
same glyph widths (as substituting Nimbus Sans for Helvetica, at least for 
some versions of each), but where the substitute is a poor match, C ought 
to look more elegant but line up less well.  D would produce much larger 
files than C.

We do have the option of not changing the output when there is no kerning. 
That would be by far the most common case except that some fonts 
(including Helvetica but not Nimbus Sans) kern between punctuation and a 
space, e.g. ', '.  I'm inclined to believe that most uses of ',' in R 
graphical output are not punctuation (certainly true of R's own examples), 
and also that we nowadays do not expect to see kerning involving spaces.

Ei-ji Nakama provided an implementation of C for pdf() and D for 
postscript() (thanks Ei-ji, and apologies that we did not have a chance to 
discuss the principles first).  I'm inclined to suggest that we should go 
forwards with at most two of these alternatives, and those two should be 
the same for postscript() and pdf() -- my own inclination is to B and C.

So questions:

1) Do people feel strongly that we should preserve graphical output from 
past versions of R, even when there are known bugs?  I can see the need to 
reproduce published figures, but normally this would also need using the 
same version of R.

2) Is kerning worth pursuing?

3) If so, is elegant looking output more important than exact layout?

4) If we allow kerning, should it be the default (or only) option?

To see that sometimes there can be a large effect, try in postscript() or 
pdf()

xx <- 'You You You You You You You You'
plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
abline(v=0)
text(0, 0.5, xx, adj=0)
abline(v=strwidth(xx))
x2 <- strsplit(xx, "")
w <- sapply(x2, strwidth)
abline(v=sum(w))

The leftmost of the right pair of lines is the computed width, the 
rightmost the (normal) displayed width.

Unless there are cogent reasons to bring this forward to 2.8.1, any 
changes would be as from 2.9.0.

Brian Ripley

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Sun Oct 12 17:57:40 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 12 Oct 2008 11:57:40 -0400
Subject: [Rd] RFC: Kerning, postscript() and pdf()
In-Reply-To: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
Message-ID: <48F21E74.2090109@stats.uwo.ca>

On 12/10/2008 11:36 AM, Prof Brian Ripley wrote:
> Ei-ji Nakama has pointed out (from another Japanese user, I believe) that 
> postscript() and pdf() have not been handling kerning correctly, and this 
> is a request for opinions about how we should correct it.
> 
> Kerning is the adjustment of the spacing between letters from their 
> natural width, so that for example 'Yo' is usually typeset with the o 
> closer to the Y than 'Yl' would be.  Kerning is not very well 
> standardized, so that for example R's default Helvetica and its URW clone 
> (Nimbus Sans) have quite different ideas of the amount of kerning 
> corrections for 'Yo'. This matters, because not many people actually see 
> Helvetica when viewing R's PostScript or PDF output, but rather a similar 
> face like Nimbus Sans or Arial, or in the case of Acrobat Reader, a not 
> very similar face.  Kerning is only a feature of some proportionally 
> spaced fonts and so not of Courier nor CJK fonts.
> 
> The current position (R <= 2.8.0) is that string widths have been 
> computing using kerning from the Adobe Font Metric files for the nominal 
> font, but the strings have been displayed without using kerning (at least 
> in the viewers we are aware of, and the PostScript and PDF reference 
> manuals mandate that behaviour, if rather obscurely).  This means that in 
> strings such as 'You', the width used in the string placement differs from 
> that actually displayed.
> 
> For postscript(), this doesn't have much impact, as centring or right 
> justification ('hadj' in text()) is done by PostScript code and computes 
> the width from the actual font used (and so copes well with font 
> substitution).  It might affect the fine layout in plotmath, but using 
> strings which would be kerned in annotations is not common.
> 
> For pdf() the effect is more commonly seen, as all text is set 
> left-justified, and the computed width is used to centre/right-justify.
> 
> There are several things we could do:
> 
> A.  Do nothing, for back compatibility.  After all, this has been going on 
> for years and no one has complained until last month.
> 
> B.  Ignore kerning, and hence change the string width computations to 
> match the current display.  This is more attractive than it appears at 
> first sight -- as far as I know all other devices ignore kerning, and we 
> are increasingly used to seeing 'typeset' output without kerning.  It 
> would be desirable when copying graphs by e.g. dev.copy2eps from devices 
> that do not kern.
> 
> C.  Insert kerning corrections by splitting up strings, so e.g. 'You' is 
> set as (Y)-140 kc(ou): this is what TeX engines do.
> 
> D.  Compute the position of each letter in the string and place them 
> individually.
> 
> C and D would give visually identical output when the font used is exactly 
> as specified, and hopefully also when a substitute font is using with the 
> same glyph widths (as substituting Nimbus Sans for Helvetica, at least for 
> some versions of each), but where the substitute is a poor match, C ought 
> to look more elegant but line up less well.  D would produce much larger 
> files than C.
> 
> We do have the option of not changing the output when there is no kerning. 
> That would be by far the most common case except that some fonts 
> (including Helvetica but not Nimbus Sans) kern between punctuation and a 
> space, e.g. ', '.  I'm inclined to believe that most uses of ',' in R 
> graphical output are not punctuation (certainly true of R's own examples), 
> and also that we nowadays do not expect to see kerning involving spaces.
> 
> Ei-ji Nakama provided an implementation of C for pdf() and D for 
> postscript() (thanks Ei-ji, and apologies that we did not have a chance to 
> discuss the principles first).  I'm inclined to suggest that we should go 
> forwards with at most two of these alternatives, and those two should be 
> the same for postscript() and pdf() -- my own inclination is to B and C.
> 
> So questions:
> 
> 1) Do people feel strongly that we should preserve graphical output from 
> past versions of R, even when there are known bugs?  I can see the need to 
> reproduce published figures, but normally this would also need using the 
> same version of R.


I think we can make this sort of change in 2.9.0.

> 2) Is kerning worth pursuing?


I think that is up to you and other people who might do the work; I 
don't think I'll contribute to it.

> 3) If so, is elegant looking output more important than exact layout?


I suppose it matters how bad the exact layout looks, but I think your 
comment above that exact layout will produce much larger files is of 
more concern.  We're sure to get complaints if "much larger" is 
noticeable.  Other concerns are whether text searches in .pdf or .ps 
files get confused by the difference.

> 4) If we allow kerning, should it be the default (or only) option?


If we do it, I think we should make it the default.  Whether it is 
optional depends on how much work that would be (so it is mainly up to 
the implementor).


> 
> To see that sometimes there can be a large effect, try in postscript() or 
> pdf()
> 
> xx <- 'You You You You You You You You'
> plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
> abline(v=0)
> text(0, 0.5, xx, adj=0)
> abline(v=strwidth(xx))
> x2 <- strsplit(xx, "")
> w <- sapply(x2, strwidth)
> abline(v=sum(w))
> 
> The leftmost of the right pair of lines is the computed width, the 
> rightmost the (normal) displayed width.
> 
> Unless there are cogent reasons to bring this forward to 2.8.1, any 
> changes would be as from 2.9.0.
> 
> Brian Ripley
>


From daniel.sabanesbove at campus.lmu.de  Sat Oct 11 21:41:15 2008
From: daniel.sabanesbove at campus.lmu.de (=?ISO-8859-15?Q?Daniel_Saban=E9s_Bov=E9?=)
Date: Sat, 11 Oct 2008 21:41:15 +0200
Subject: [Rd] defines in Rmath.h and R_NO_REMAP
Message-ID: <48F1015B.9010406@campus.lmu.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Hi,

I'm programming with R 2.7.2 and had some trouble including
Rmath.h for its random variates generation routines: Although
I define R_NO_REMAP (which works fine for Rinternals.h stuff),
Rmath.h defines "beta" as "Rf_beta" etc., so that my "beta" strings
get redefined as well! Is this a feature?

I found an old Rmath.h version from 2000,
which seems to obey the R_NO_REMAP flag, but the present version
only obeys the math library standalone flag and ignores R_NO_REMAP.

As a bad workaround I defined some forwarding functions and
included Rmath.h in a separate part of the code... but this is not
very beautiful.

Thanks,
Daniel
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iEYEAREKAAYFAkjxAVsACgkQnhBrrSA4m1EMsQCdGIQ/UH+E8fRtPL5fOdhW2r3/
n9cAn3sueVFTMHEY2/a5oAHH+lapA5bF
=wmwk
-----END PGP SIGNATURE-----


From ripley at stats.ox.ac.uk  Mon Oct 13 09:00:13 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Oct 2008 08:00:13 +0100 (BST)
Subject: [Rd] RFC: Kerning, postscript() and pdf()
In-Reply-To: <48F21E74.2090109@stats.uwo.ca>
References: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
	<48F21E74.2090109@stats.uwo.ca>
Message-ID: <alpine.LFD.2.00.0810130754100.3813@gannet.stats.ox.ac.uk>

Thanks for the feedback.  Two comments

- we have experimental code for all the options, so the work in 
implementing them does not differ greatly.  The long-term maintenance 
costs of having different options is a real consideration, though.
R-devel currently has the options of B (default) and C, but is work in 
progress.

- I estimate that letter-by-letter placement increases the file size for 
text strings by a factor of 6, so this would be significant in a plot with 
a lot of annotations, but not one in which points were labelled by single 
letters.

On Sun, 12 Oct 2008, Duncan Murdoch wrote:

> On 12/10/2008 11:36 AM, Prof Brian Ripley wrote:
>> Ei-ji Nakama has pointed out (from another Japanese user, I believe) that 
>> postscript() and pdf() have not been handling kerning correctly, and this 
>> is a request for opinions about how we should correct it.
>> 
>> Kerning is the adjustment of the spacing between letters from their natural 
>> width, so that for example 'Yo' is usually typeset with the o closer to the 
>> Y than 'Yl' would be.  Kerning is not very well standardized, so that for 
>> example R's default Helvetica and its URW clone (Nimbus Sans) have quite 
>> different ideas of the amount of kerning corrections for 'Yo'. This 
>> matters, because not many people actually see Helvetica when viewing R's 
>> PostScript or PDF output, but rather a similar face like Nimbus Sans or 
>> Arial, or in the case of Acrobat Reader, a not very similar face.  Kerning 
>> is only a feature of some proportionally spaced fonts and so not of Courier 
>> nor CJK fonts.
>> 
>> The current position (R <= 2.8.0) is that string widths have been computing 
>> using kerning from the Adobe Font Metric files for the nominal font, but 
>> the strings have been displayed without using kerning (at least in the 
>> viewers we are aware of, and the PostScript and PDF reference manuals 
>> mandate that behaviour, if rather obscurely).  This means that in strings 
>> such as 'You', the width used in the string placement differs from that 
>> actually displayed.
>> 
>> For postscript(), this doesn't have much impact, as centring or right 
>> justification ('hadj' in text()) is done by PostScript code and computes 
>> the width from the actual font used (and so copes well with font 
>> substitution).  It might affect the fine layout in plotmath, but using 
>> strings which would be kerned in annotations is not common.
>> 
>> For pdf() the effect is more commonly seen, as all text is set 
>> left-justified, and the computed width is used to centre/right-justify.
>> 
>> There are several things we could do:
>> 
>> A.  Do nothing, for back compatibility.  After all, this has been going on 
>> for years and no one has complained until last month.
>> 
>> B.  Ignore kerning, and hence change the string width computations to match 
>> the current display.  This is more attractive than it appears at first 
>> sight -- as far as I know all other devices ignore kerning, and we are 
>> increasingly used to seeing 'typeset' output without kerning.  It would be 
>> desirable when copying graphs by e.g. dev.copy2eps from devices that do not 
>> kern.
>> 
>> C.  Insert kerning corrections by splitting up strings, so e.g. 'You' is 
>> set as (Y)-140 kc(ou): this is what TeX engines do.
>> 
>> D.  Compute the position of each letter in the string and place them 
>> individually.
>> 
>> C and D would give visually identical output when the font used is exactly 
>> as specified, and hopefully also when a substitute font is using with the 
>> same glyph widths (as substituting Nimbus Sans for Helvetica, at least for 
>> some versions of each), but where the substitute is a poor match, C ought 
>> to look more elegant but line up less well.  D would produce much larger 
>> files than C.
>> 
>> We do have the option of not changing the output when there is no kerning. 
>> That would be by far the most common case except that some fonts (including 
>> Helvetica but not Nimbus Sans) kern between punctuation and a space, e.g. 
>> ', '.  I'm inclined to believe that most uses of ',' in R graphical output 
>> are not punctuation (certainly true of R's own examples), and also that we 
>> nowadays do not expect to see kerning involving spaces.
>> 
>> Ei-ji Nakama provided an implementation of C for pdf() and D for 
>> postscript() (thanks Ei-ji, and apologies that we did not have a chance to 
>> discuss the principles first).  I'm inclined to suggest that we should go 
>> forwards with at most two of these alternatives, and those two should be 
>> the same for postscript() and pdf() -- my own inclination is to B and C.
>> 
>> So questions:
>> 
>> 1) Do people feel strongly that we should preserve graphical output from 
>> past versions of R, even when there are known bugs?  I can see the need to 
>> reproduce published figures, but normally this would also need using the 
>> same version of R.
>
>
> I think we can make this sort of change in 2.9.0.
>
>> 2) Is kerning worth pursuing?
>
>
> I think that is up to you and other people who might do the work; I don't 
> think I'll contribute to it.
>
>> 3) If so, is elegant looking output more important than exact layout?
>
>
> I suppose it matters how bad the exact layout looks, but I think your comment 
> above that exact layout will produce much larger files is of more concern. 
> We're sure to get complaints if "much larger" is noticeable.  Other concerns 
> are whether text searches in .pdf or .ps files get confused by the 
> difference.
>
>> 4) If we allow kerning, should it be the default (or only) option?
>
>
> If we do it, I think we should make it the default.  Whether it is optional 
> depends on how much work that would be (so it is mainly up to the 
> implementor).
>
>
>> 
>> To see that sometimes there can be a large effect, try in postscript() or 
>> pdf()
>> 
>> xx <- 'You You You You You You You You'
>> plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
>> abline(v=0)
>> text(0, 0.5, xx, adj=0)
>> abline(v=strwidth(xx))
>> x2 <- strsplit(xx, "")
>> w <- sapply(x2, strwidth)
>> abline(v=sum(w))
>> 
>> The leftmost of the right pair of lines is the computed width, the 
>> rightmost the (normal) displayed width.
>> 
>> Unless there are cogent reasons to bring this forward to 2.8.1, any changes 
>> would be as from 2.9.0.
>> 
>> Brian Ripley
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Mon Oct 13 11:55:15 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Oct 2008 10:55:15 +0100 (BST)
Subject: [Rd] defines in Rmath.h and R_NO_REMAP
In-Reply-To: <48F1015B.9010406@campus.lmu.de>
References: <48F1015B.9010406@campus.lmu.de>
Message-ID: <alpine.LFD.2.00.0810121732150.10016@gannet.stats.ox.ac.uk>

If you read the 'Writing R Extensions' manual it only mentions 
R_NO_REMAP in conjuction with Rinternals.h and R_ext/Error.h.

So yes, it is intentional that it does not work for Rmath.h.  If you would 
like it to, remember we often say 'patches will be considered'.  But see 
the inline comment below.

On Sat, 11 Oct 2008, Daniel Saban?s Bov? wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA512
>
> Hi,
>
> I'm programming with R 2.7.2 and had some trouble including
> Rmath.h for its random variates generation routines: Although
> I define R_NO_REMAP (which works fine for Rinternals.h stuff),
> Rmath.h defines "beta" as "Rf_beta" etc., so that my "beta" strings
> get redefined as well! Is this a feature?
>
> I found an old Rmath.h version from 2000,
> which seems to obey the R_NO_REMAP flag, but the present version
> only obeys the math library standalone flag and ignores R_NO_REMAP.
>
> As a bad workaround I defined some forwarding functions and
> included Rmath.h in a separate part of the code... but this is not
> very beautiful.

You could just #undef beta !

> Thanks,
> Daniel
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2.0.9 (GNU/Linux)
> Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org
>
> iEYEAREKAAYFAkjxAVsACgkQnhBrrSA4m1EMsQCdGIQ/UH+E8fRtPL5fOdhW2r3/
> n9cAn3sueVFTMHEY2/a5oAHH+lapA5bF
> =wmwk
> -----END PGP SIGNATURE-----
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From daniel.sabanesbove at campus.lmu.de  Mon Oct 13 14:09:15 2008
From: daniel.sabanesbove at campus.lmu.de (=?ISO-8859-15?Q?Daniel_Saban=E9s_Bov=E9?=)
Date: Mon, 13 Oct 2008 14:09:15 +0200
Subject: [Rd] defines in Rmath.h and R_NO_REMAP
In-Reply-To: <alpine.LFD.2.00.0810121732150.10016@gannet.stats.ox.ac.uk>
References: <48F1015B.9010406@campus.lmu.de>
	<alpine.LFD.2.00.0810121732150.10016@gannet.stats.ox.ac.uk>
Message-ID: <48F33A6B.5070102@campus.lmu.de>

Dear Prof. Ripley,

thank you for the pointer to #undef;
I used it the first time now and put

// undo Rmath.h madness ;-)
#ifdef beta
#undef beta
#endif

in my (templates) header file. It works, and it is much
nicer than my forwarding functions.

Prof Brian Ripley schrieb:
> If you read the 'Writing R Extensions' manual it only mentions
R_NO_REMAP in conjuction with Rinternals.h and R_ext/Error.h.
>
> So yes, it is intentional that it does not work for Rmath.h.  If you
would like it to, remember we often say 'patches will be considered'. 
But see the inline comment below.
>
> On Sat, 11 Oct 2008, Daniel Saban?s Bov? wrote:
>
> Hi,
>
> I'm programming with R 2.7.2 and had some trouble including
> Rmath.h for its random variates generation routines: Although
> I define R_NO_REMAP (which works fine for Rinternals.h stuff),
> Rmath.h defines "beta" as "Rf_beta" etc., so that my "beta" strings
> get redefined as well! Is this a feature?
>
> I found an old Rmath.h version from 2000,
> which seems to obey the R_NO_REMAP flag, but the present version
> only obeys the math library standalone flag and ignores R_NO_REMAP.
>
> As a bad workaround I defined some forwarding functions and
> included Rmath.h in a separate part of the code... but this is not
> very beautiful.
>
> > You could just #undef beta !
>
> Thanks,
> Daniel
>>
______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From peter.ruckdeschel at web.de  Mon Oct 13 21:22:07 2008
From: peter.ruckdeschel at web.de (Peter Ruckdeschel)
Date: Mon, 13 Oct 2008 21:22:07 +0200
Subject: [Rd] Version information for S4 classes --- elementary version
	management
Message-ID: <48F39FDF.70302@web.de>

Hi,

we are about to update some class definitions in our distrXXX family
of packages, so I would be eager to know whether there are plans
in R Core to implement some version management tools for
S4 classes as described in section 7.4 in JMC's "Green Book".
In his recent book (continuing the color scheme, is it to be called
the "Yellow Book"? :-), this topic has not been taken up again, so
we are not sure whether there still is the goal to go into this direction...

We have already implemented some "individual" sort of (class) version
management in our packages, but as this issue does not only concern
our packages, some standardized proceding would be desirable.

AFAICS, in R 2.8.0, by default when save()ing/load()ing single S4
objects, the corresponding class definitions are not saved/restored
along, while they are saved() and again restored on load() by default
when producing an image by save.image(), although an existing
class definition will not be overwritten.

So when load()ing an (old) S4 object, by default there will be no
information about the class definition at save() time available.
Of course, conceptually, such information would best be stored
in the respective classRepresentation object; however, as this one
does not get save()d automatically along with an object, we might
think of alternatives.  It might at least be a compromise to store the
some version information as a special slot to every object of
any S4 class.

For S4 classes defined in packages (which should make for 
the vast majority of them), default information could be obtained
from the package version tag in the DESCRIPTION file.
The rationale behind this is that an updated class definition would
at least be traceable to one particular package version, while
on the other hand the package version string is not a "large" object.

Based on this package version information, (elementary)
version management could then be provided by means of
generic functions

getClassVersion()  [as described in the Green Book, 7.4]
conv2NewVersion() ## by default issuing an error ("Not yet defined")
isOldVersion() ## true or false; by default NA

Defining particular methods for his classes, a package maintainer
could then issue specific warnings or --- at its best --- even
provide coercing methods.

What do you think about this?

Best, Peter


From bolker at zoology.ufl.edu  Mon Oct 13 22:30:13 2008
From: bolker at zoology.ufl.edu (bolker at zoology.ufl.edu)
Date: Mon, 13 Oct 2008 22:30:13 +0200 (CEST)
Subject: [Rd] cut.Date problem when starting on first day of week (PR#13159)
Message-ID: <20081013203014.339B9282EF48@mail.pubhealth.ku.dk>

    Apparently any (?) call of the form

cut(date,"weeks")

where the date *begins the week*, gives the error

Error in 1:(1 + max(which(breaks < maxx))) :
  result would be too long a vector
In addition: Warning message:
In max(which(breaks < maxx)) :
  no non-missing arguments to max; returning -Inf

 To my surprise, this was first reported as a problem in 2006 (!)
(version 2.3.1 (!)), by Mikkel Grum:

http://finzi.psych.upenn.edu/R/Rhelp02a/archive/83122.html (17 Aug 2006)
https://stat.ethz.ch/pipermail/r-devel/2008-September/050710.html
https://stat.ethz.ch/pipermail/r-devel/2008-October/050914.html

  In particular, try:

d <- seq.Date(as.Date("2008-07-05"),as.Date("2008-07-08"),by="days")
weekdays(d)

cut(d[1],"weeks") ## OK
cut(d[2],"weeks") ## OK
cut(d[3],"weeks") ## Monday -- breaks
cut(d[4],"weeks") ## OK

cut(d[1],"weeks",start.on.monday=FALSE) ## OK
cut(d[2],"weeks",start.on.monday=FALSE) ## Sunday -- breaks
cut(d[3],"weeks",start.on.monday=FALSE) ## OK
cut(d[4],"weeks",start.on.monday=FALSE) ## OK

  The particular line that fails within cut.Date is

breaks <- breaks[1:(1 + max(which(breaks < maxx)))]

  but I haven't figured out enough about what's going on
to be able to suggest a fix ...

  cheers
    Ben Bolker


From edd at debian.org  Tue Oct 14 02:40:05 2008
From: edd at debian.org (edd at debian.org)
Date: Tue, 14 Oct 2008 02:40:05 +0200 (CEST)
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
Message-ID: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>


On 14 October 2008 at 09:39, Simon Blomberg wrote:
| Hi, is anyone else getting this error? Could this be a bug?:
| 
| > update.packages(ask=FALSE)
| Error in read.dcf(pkgpath, fields = fields) : 
|   Line starting 'unix; ...' is malformed!
| 
| > sessionInfo()
| R version 2.8.0 RC (2008-10-12 r46696) 
| x86_64-pc-linux-gnu 

Confirmed in plain R using the same package built this morning from last
night's tarball from Denmark:  Running update.packages() yields:

> update.packages()
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
Error in read.dcf(pkgpath, fields = fields) :
  Line starting 'unix; ...' is malformed!


OTOH I don't have a problem running my 'update.r' script (included in littler as
/usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
ten packages. It is equivalent to calling 

> repos <- "http://cran.r-project.org"
> lib.loc <- "/usr/local/lib/R/site-library"
> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)

and that sequence also works in plain R.  Could someone please dig into
update.packages() ? 

Dirk 

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Tue Oct 14 05:54:45 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 04:54:45 +0100 (BST)
Subject: [Rd] (PR#13159) cut.Date problem when starting on first day of
 week
In-Reply-To: <20081013203014.339B9282EF48@mail.pubhealth.ku.dk>
References: <20081013203014.339B9282EF48@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810140447130.26853@gannet.stats.ox.ac.uk>

It should be <= not < .

There is a similar problem with POSIXct (but only for times at midnight).

On Mon, 13 Oct 2008, bolker at zoology.ufl.edu wrote:

>    Apparently any (?) call of the form
>
> cut(date,"weeks")
>
> where the date *begins the week*, gives the error
>
> Error in 1:(1 + max(which(breaks < maxx))) :
>  result would be too long a vector
> In addition: Warning message:
> In max(which(breaks < maxx)) :
>  no non-missing arguments to max; returning -Inf
>
> To my surprise, this was first reported as a problem in 2006 (!)
> (version 2.3.1 (!)), by Mikkel Grum:
>
> http://finzi.psych.upenn.edu/R/Rhelp02a/archive/83122.html (17 Aug 2006)
> https://stat.ethz.ch/pipermail/r-devel/2008-September/050710.html
> https://stat.ethz.ch/pipermail/r-devel/2008-October/050914.html
>
>  In particular, try:
>
> d <- seq.Date(as.Date("2008-07-05"),as.Date("2008-07-08"),by="days")
> weekdays(d)
>
> cut(d[1],"weeks") ## OK
> cut(d[2],"weeks") ## OK
> cut(d[3],"weeks") ## Monday -- breaks
> cut(d[4],"weeks") ## OK
>
> cut(d[1],"weeks",start.on.monday=FALSE) ## OK
> cut(d[2],"weeks",start.on.monday=FALSE) ## Sunday -- breaks
> cut(d[3],"weeks",start.on.monday=FALSE) ## OK
> cut(d[4],"weeks",start.on.monday=FALSE) ## OK
>
>  The particular line that fails within cut.Date is
>
> breaks <- breaks[1:(1 + max(which(breaks < maxx)))]
>
>  but I haven't figured out enough about what's going on
> to be able to suggest a fix ...
>
>  cheers
>    Ben Bolker
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From tplate at acm.org  Tue Oct 14 07:10:41 2008
From: tplate at acm.org (Tony Plate)
Date: Mon, 13 Oct 2008 23:10:41 -0600
Subject: [Rd] dos-style line endings in .Rbuildignore result in files not
 being excluded
Message-ID: <48F429D1.6040500@acm.org>

I was trying, on a Linux system, to get a .Rbuildignore file to work.  
After far too long, I found the problem was the <CR><NL> line endings in 
the .Rbuildignore file -- I had originally created it on a Windows 
system, and emacs in Ubuntu was politely hiding that fact from me.  The 
patterns didn't work to exclude files because it was trying to match 
filenames to patterns like "NOTES.txt^M".

I don't know what the best solution to this is, but I got it working by 
putting a substitute command in the bin/build file like this:

        while(<RBUILDIGNORE>) {
            chomp;
            s/^M$//;
            push(@exclude_patterns, $_) if $_;

(When I cut and paste that code here it ends up as two separate 
characters ^ and M, but in the bin/build file it's one <CR> character.)

One could of course say it is stupid user error to have <CR>'s in the 
.Rbuildignore file, but it can happen easily, and it would nice if R 
would work with it.

Could a fix for this little problem be incorporated into R?

thanks,

Tony Plate


From spluque at gmail.com  Tue Oct 14 07:25:12 2008
From: spluque at gmail.com (Sebastian P. Luque)
Date: Tue, 14 Oct 2008 00:25:12 -0500
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
	not being excluded
References: <48F429D1.6040500@acm.org>
Message-ID: <874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>

On Mon, 13 Oct 2008 23:10:41 -0600,
Tony Plate <tplate at acm.org> wrote:

> I was trying, on a Linux system, to get a .Rbuildignore file to work.
> After far too long, I found the problem was the <CR><NL> line endings
> in the .Rbuildignore file -- I had originally created it on a Windows
> system, and emacs in Ubuntu was politely hiding that fact from me.

Are you sure? Whenever I open M$ files in Emacs under Debian I see
'(DOS)' near the left end of the modeline, which indicates that it has
^C as EOL.  This has been the case since at least 21.0.


-- 
Seb


From p.dalgaard at biostat.ku.dk  Tue Oct 14 09:40:24 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue, 14 Oct 2008 09:40:24 +0200
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
Message-ID: <48F44CE8.3080409@biostat.ku.dk>

edd at debian.org wrote:
> On 14 October 2008 at 09:39, Simon Blomberg wrote:
> | Hi, is anyone else getting this error? Could this be a bug?:
> | 
> | > update.packages(ask=FALSE)
> | Error in read.dcf(pkgpath, fields = fields) : 
> |   Line starting 'unix; ...' is malformed!
> | 
> | > sessionInfo()
> | R version 2.8.0 RC (2008-10-12 r46696) 
> | x86_64-pc-linux-gnu 
> 
> Confirmed in plain R using the same package built this morning from last
> night's tarball from Denmark:  Running update.packages() yields:
> 
>> update.packages()
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> Error in read.dcf(pkgpath, fields = fields) :
>   Line starting 'unix; ...' is malformed!
> 
> 
> OTOH I don't have a problem running my 'update.r' script (included in littler as
> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
> ten packages. It is equivalent to calling 
> 
>> repos <- "http://cran.r-project.org"
>> lib.loc <- "/usr/local/lib/R/site-library"
>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
> 
> and that sequence also works in plain R.  Could someone please dig into
> update.packages() ? 
> 
> Dirk 
> 

Hmm, some of us are wary of running update.packages() in non-production 
versions. Is the problem perhaps originating in getCRANmirors() or 
chooseCRANmirror()?

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From mar36 at psu.edu  Tue Oct 14 03:15:04 2008
From: mar36 at psu.edu (mar36 at psu.edu)
Date: Tue, 14 Oct 2008 03:15:04 +0200 (CEST)
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13162)
Message-ID: <20081014011504.4BADE282EF48@mail.pubhealth.ku.dk>



Dirk Eddelbuettel wrote:
> On 14 October 2008 at 09:39, Simon Blomberg wrote:
> | Hi, is anyone else getting this error? Could this be a bug?:
> | 
> | > update.packages(ask=FALSE)
> | Error in read.dcf(pkgpath, fields = fields) : 
> |   Line starting 'unix; ...' is malformed!
> | 
> | > sessionInfo()
> | R version 2.8.0 RC (2008-10-12 r46696) 
> | x86_64-pc-linux-gnu 
> 
> Confirmed in plain R using the same package built this morning from last
> night's tarball from Denmark:  Running update.packages() yields:
> 
>> update.packages()
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> Error in read.dcf(pkgpath, fields = fields) :
>   Line starting 'unix; ...' is malformed!

Just built hardy amd64 packages, and I do not receive this error message 
and was able to update packages with no issues.  It was R version 2.8.0 
RC (2008-10-12 r46696).  Not sure what I have done differently, just 
used the same scripts we have been using to build ubuntu packages.

Michael
-- 
Dr. Michael A. Rutter
School of Science
Penn State Erie, The Behrend College
Station Road
Erie, PA 16563
http://math.bd.psu.edu/faculty/rutter


From ripley at stats.ox.ac.uk  Tue Oct 14 11:09:15 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 10:09:15 +0100 (BST)
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <48F44CE8.3080409@biostat.ku.dk>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
	<48F44CE8.3080409@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>

On Tue, 14 Oct 2008, Peter Dalgaard wrote:

> edd at debian.org wrote:
>> On 14 October 2008 at 09:39, Simon Blomberg wrote:
>> | Hi, is anyone else getting this error? Could this be a bug?:
>> | | > update.packages(ask=FALSE)
>> | Error in read.dcf(pkgpath, fields = fields) : |   Line starting 'unix; 
>> ...' is malformed!
>> | | > sessionInfo()
>> | R version 2.8.0 RC (2008-10-12 r46696) | x86_64-pc-linux-gnu 
>> Confirmed in plain R using the same package built this morning from last
>> night's tarball from Denmark:  Running update.packages() yields:
>> 
>>> update.packages()
>> --- Please select a CRAN mirror for use in this session ---
>> Loading Tcl/Tk interface ... done
>> Error in read.dcf(pkgpath, fields = fields) :
>>   Line starting 'unix; ...' is malformed!
>> 
>> 
>> OTOH I don't have a problem running my 'update.r' script (included in 
>> littler as
>> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
>> ten packages. It is equivalent to calling 
>>> repos <- "http://cran.r-project.org"
>>> lib.loc <- "/usr/local/lib/R/site-library"
>>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
>> 
>> and that sequence also works in plain R.  Could someone please dig into
>> update.packages() ? 
>> Dirk 
>
> Hmm, some of us are wary of running update.packages() in non-production 
> versions. Is the problem perhaps originating in getCRANmirors() or 
> chooseCRANmirror()?

(Neither of those read DCF files: my expectation is that this is 
available.packages() reading a DCF file downloaded from a CRAN mirror.)

I do use update.packages() daily on pre-2.8.0 and I have not seen a 
problem.  (I keep a separate package installation for test versions.)

Can we please have some useful debugging info, e.g. the result of 
traceback() and which CRAN mirror is being used?  I suspect a problem with 
downloading PACKAGES.gz resulting in a corrupt file (possibly because it 
was corrupt on the mirror).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Tue Oct 14 13:34:27 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 14 Oct 2008 06:34:27 -0500
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
	<48F44CE8.3080409@biostat.ku.dk>
	<alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>
Message-ID: <18676.33731.948767.124281@ron.nulle.part>


On 14 October 2008 at 10:09, Prof Brian Ripley wrote:
| On Tue, 14 Oct 2008, Peter Dalgaard wrote:
| 
| > edd at debian.org wrote:
| >> On 14 October 2008 at 09:39, Simon Blomberg wrote:
| >> | Hi, is anyone else getting this error? Could this be a bug?:
| >> | | > update.packages(ask=FALSE)
| >> | Error in read.dcf(pkgpath, fields = fields) : |   Line starting 'unix; 
| >> ...' is malformed!
| >> | | > sessionInfo()
| >> | R version 2.8.0 RC (2008-10-12 r46696) | x86_64-pc-linux-gnu 
| >> Confirmed in plain R using the same package built this morning from last
| >> night's tarball from Denmark:  Running update.packages() yields:
| >> 
| >>> update.packages()
| >> --- Please select a CRAN mirror for use in this session ---
| >> Loading Tcl/Tk interface ... done
| >> Error in read.dcf(pkgpath, fields = fields) :
| >>   Line starting 'unix; ...' is malformed!
| >> 
| >> 
| >> OTOH I don't have a problem running my 'update.r' script (included in 
| >> littler as
| >> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
| >> ten packages. It is equivalent to calling 
| >>> repos <- "http://cran.r-project.org"
| >>> lib.loc <- "/usr/local/lib/R/site-library"
| >>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
| >> 
| >> and that sequence also works in plain R.  Could someone please dig into
| >> update.packages() ? 
| >> Dirk 
| >
| > Hmm, some of us are wary of running update.packages() in non-production 
| > versions. Is the problem perhaps originating in getCRANmirors() or 
| > chooseCRANmirror()?
| 
| (Neither of those read DCF files: my expectation is that this is 
| available.packages() reading a DCF file downloaded from a CRAN mirror.)
| 
| I do use update.packages() daily on pre-2.8.0 and I have not seen a 
| problem.  (I keep a separate package installation for test versions.)
| 
| Can we please have some useful debugging info, e.g. the result of 
| traceback() and which CRAN mirror is being used?  I suspect a problem with 
| downloading PACKAGES.gz resulting in a corrupt file (possibly because it 
| was corrupt on the mirror).

Quite possible. This is a fresh failure picking the 'US (MI)' mirror:

> update.packages()
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
Error in read.dcf(pkgpath, fields = fields) :
  Line starting 'unix; ...' is malformed!
> traceback()
6: read.dcf(pkgpath, fields = fields)
5: .readPkgDesc(lib, fields)
4: installed.packages(lib.loc = lib.loc)
3: NROW(instPkgs)
2: old.packages(lib.loc = lib.loc, contriburl = contriburl, method = method,
       available = available, checkBuilt = checkBuilt)
1: update.packages()
>  

But if I then re-run chooseCRANmirror() and pick Austria, it still fails:

> chooseCRANmirror()
> update.packages()
Error in read.dcf(pkgpath, fields = fields) :
  Line starting 'unix; ...' is malformed!
>   

yielding the same traceback.

Dirk

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Tue Oct 14 13:38:36 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 12:38:36 +0100 (BST)
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <18676.33731.948767.124281@ron.nulle.part>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
	<48F44CE8.3080409@biostat.ku.dk>
	<alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>
	<18676.33731.948767.124281@ron.nulle.part>
Message-ID: <alpine.LFD.2.00.0810141237240.27368@gannet.stats.ox.ac.uk>

The error is on installed.packages(): you have a faulty package installed.

On Tue, 14 Oct 2008, Dirk Eddelbuettel wrote:

>
> On 14 October 2008 at 10:09, Prof Brian Ripley wrote:
> | On Tue, 14 Oct 2008, Peter Dalgaard wrote:
> |
> | > edd at debian.org wrote:
> | >> On 14 October 2008 at 09:39, Simon Blomberg wrote:
> | >> | Hi, is anyone else getting this error? Could this be a bug?:
> | >> | | > update.packages(ask=FALSE)
> | >> | Error in read.dcf(pkgpath, fields = fields) : |   Line starting 'unix;
> | >> ...' is malformed!
> | >> | | > sessionInfo()
> | >> | R version 2.8.0 RC (2008-10-12 r46696) | x86_64-pc-linux-gnu
> | >> Confirmed in plain R using the same package built this morning from last
> | >> night's tarball from Denmark:  Running update.packages() yields:
> | >>
> | >>> update.packages()
> | >> --- Please select a CRAN mirror for use in this session ---
> | >> Loading Tcl/Tk interface ... done
> | >> Error in read.dcf(pkgpath, fields = fields) :
> | >>   Line starting 'unix; ...' is malformed!
> | >>
> | >>
> | >> OTOH I don't have a problem running my 'update.r' script (included in
> | >> littler as
> | >> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
> | >> ten packages. It is equivalent to calling
> | >>> repos <- "http://cran.r-project.org"
> | >>> lib.loc <- "/usr/local/lib/R/site-library"
> | >>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
> | >>
> | >> and that sequence also works in plain R.  Could someone please dig into
> | >> update.packages() ?
> | >> Dirk
> | >
> | > Hmm, some of us are wary of running update.packages() in non-production
> | > versions. Is the problem perhaps originating in getCRANmirors() or
> | > chooseCRANmirror()?
> |
> | (Neither of those read DCF files: my expectation is that this is
> | available.packages() reading a DCF file downloaded from a CRAN mirror.)
> |
> | I do use update.packages() daily on pre-2.8.0 and I have not seen a
> | problem.  (I keep a separate package installation for test versions.)
> |
> | Can we please have some useful debugging info, e.g. the result of
> | traceback() and which CRAN mirror is being used?  I suspect a problem with
> | downloading PACKAGES.gz resulting in a corrupt file (possibly because it
> | was corrupt on the mirror).
>
> Quite possible. This is a fresh failure picking the 'US (MI)' mirror:
>
>> update.packages()
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> Error in read.dcf(pkgpath, fields = fields) :
>  Line starting 'unix; ...' is malformed!
>> traceback()
> 6: read.dcf(pkgpath, fields = fields)
> 5: .readPkgDesc(lib, fields)
> 4: installed.packages(lib.loc = lib.loc)
> 3: NROW(instPkgs)
> 2: old.packages(lib.loc = lib.loc, contriburl = contriburl, method = method,
>       available = available, checkBuilt = checkBuilt)
> 1: update.packages()
>>
>
> But if I then re-run chooseCRANmirror() and pick Austria, it still fails:
>
>> chooseCRANmirror()
>> update.packages()
> Error in read.dcf(pkgpath, fields = fields) :
>  Line starting 'unix; ...' is malformed!
>>
>
> yielding the same traceback.
>
> Dirk
>
> -- 
> Three out of two people have difficulties with fractions.
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Oct 14 13:55:51 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 12:55:51 +0100 (BST)
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
 not being excluded
In-Reply-To: <874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>
References: <48F429D1.6040500@acm.org>
	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>
Message-ID: <alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>

On Tue, 14 Oct 2008, Sebastian P. Luque wrote:

> On Mon, 13 Oct 2008 23:10:41 -0600,
> Tony Plate <tplate at acm.org> wrote:
>
>> I was trying, on a Linux system, to get a .Rbuildignore file to work.
>> After far too long, I found the problem was the <CR><NL> line endings
>> in the .Rbuildignore file -- I had originally created it on a Windows
>> system, and emacs in Ubuntu was politely hiding that fact from me.
>
> Are you sure? Whenever I open M$ files in Emacs under Debian I see
> '(DOS)' near the left end of the modeline, which indicates that it has
> ^C as EOL.  This has been the case since at least 21.0.

^M^J, I think you mean (CRLF).

Emacs is not totally consistent about how it does this: since it tries to 
guess the file encoding it will usually indicate (DOS) on the mode line, 
but not always (and it sometimes displays the ^M's, even on Windows).

But to the point: how often do people get DOS-style files on a Unix-alike? 
You have to work pretty hard to do this, and there comes a point at which 
complicating R to workaround wrongly encoded files is not worth the 
trouble.  Let's see if anyone else reports having done this.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Tue Oct 14 14:27:45 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 14 Oct 2008 07:27:45 -0500
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <alpine.LFD.2.00.0810141237240.27368@gannet.stats.ox.ac.uk>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
	<48F44CE8.3080409@biostat.ku.dk>
	<alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>
	<18676.33731.948767.124281@ron.nulle.part>
	<alpine.LFD.2.00.0810141237240.27368@gannet.stats.ox.ac.uk>
Message-ID: <18676.36929.70542.752650@ron.nulle.part>


On 14 October 2008 at 12:38, Prof Brian Ripley wrote:
| The error is on installed.packages(): you have a faulty package installed.

Confirmed. That explains why my update.r from littler worked as it looked
only at /usr/local/lib/R/.  Being more explicit about lib.loc I get:

> update.packages(repos="http://cran.r-project.org", lib.loc="/usr/lib/R/site-library")
Error in read.dcf(pkgpath, fields = fields) : 
  Line starting 'unix; ...' is malformed!
> update.packages(repos="http://cran.r-project.org", lib.loc="/usr/lib/R/library")
boot :
 Version 1.2-33 installed in /usr/lib/R/library 
 Version 1.2-34 available at http://cran.r-project.org
Update (y/N/c)?  n
[...]
> 

But how do I find out which package this is, and why did R 2.7.2 didn't fall
over?

Dirk

| 
| On Tue, 14 Oct 2008, Dirk Eddelbuettel wrote:
| 
| >
| > On 14 October 2008 at 10:09, Prof Brian Ripley wrote:
| > | On Tue, 14 Oct 2008, Peter Dalgaard wrote:
| > |
| > | > edd at debian.org wrote:
| > | >> On 14 October 2008 at 09:39, Simon Blomberg wrote:
| > | >> | Hi, is anyone else getting this error? Could this be a bug?:
| > | >> | | > update.packages(ask=FALSE)
| > | >> | Error in read.dcf(pkgpath, fields = fields) : |   Line starting 'unix;
| > | >> ...' is malformed!
| > | >> | | > sessionInfo()
| > | >> | R version 2.8.0 RC (2008-10-12 r46696) | x86_64-pc-linux-gnu
| > | >> Confirmed in plain R using the same package built this morning from last
| > | >> night's tarball from Denmark:  Running update.packages() yields:
| > | >>
| > | >>> update.packages()
| > | >> --- Please select a CRAN mirror for use in this session ---
| > | >> Loading Tcl/Tk interface ... done
| > | >> Error in read.dcf(pkgpath, fields = fields) :
| > | >>   Line starting 'unix; ...' is malformed!
| > | >>
| > | >>
| > | >> OTOH I don't have a problem running my 'update.r' script (included in
| > | >> littler as
| > | >> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
| > | >> ten packages. It is equivalent to calling
| > | >>> repos <- "http://cran.r-project.org"
| > | >>> lib.loc <- "/usr/local/lib/R/site-library"
| > | >>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
| > | >>
| > | >> and that sequence also works in plain R.  Could someone please dig into
| > | >> update.packages() ?
| > | >> Dirk
| > | >
| > | > Hmm, some of us are wary of running update.packages() in non-production
| > | > versions. Is the problem perhaps originating in getCRANmirors() or
| > | > chooseCRANmirror()?
| > |
| > | (Neither of those read DCF files: my expectation is that this is
| > | available.packages() reading a DCF file downloaded from a CRAN mirror.)
| > |
| > | I do use update.packages() daily on pre-2.8.0 and I have not seen a
| > | problem.  (I keep a separate package installation for test versions.)
| > |
| > | Can we please have some useful debugging info, e.g. the result of
| > | traceback() and which CRAN mirror is being used?  I suspect a problem with
| > | downloading PACKAGES.gz resulting in a corrupt file (possibly because it
| > | was corrupt on the mirror).
| >
| > Quite possible. This is a fresh failure picking the 'US (MI)' mirror:
| >
| >> update.packages()
| > --- Please select a CRAN mirror for use in this session ---
| > Loading Tcl/Tk interface ... done
| > Error in read.dcf(pkgpath, fields = fields) :
| >  Line starting 'unix; ...' is malformed!
| >> traceback()
| > 6: read.dcf(pkgpath, fields = fields)
| > 5: .readPkgDesc(lib, fields)
| > 4: installed.packages(lib.loc = lib.loc)
| > 3: NROW(instPkgs)
| > 2: old.packages(lib.loc = lib.loc, contriburl = contriburl, method = method,
| >       available = available, checkBuilt = checkBuilt)
| > 1: update.packages()
| >>
| >
| > But if I then re-run chooseCRANmirror() and pick Austria, it still fails:
| >
| >> chooseCRANmirror()
| >> update.packages()
| > Error in read.dcf(pkgpath, fields = fields) :
| >  Line starting 'unix; ...' is malformed!
| >>
| >
| > yielding the same traceback.
| >
| > Dirk
| >
| > -- 
| > Three out of two people have difficulties with fractions.
| >
| 
| -- 
| Brian D. Ripley,                  ripley at stats.ox.ac.uk
| Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
| University of Oxford,             Tel:  +44 1865 272861 (self)
| 1 South Parks Road,                     +44 1865 272866 (PA)
| Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Tue Oct 14 14:32:46 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 13:32:46 +0100 (BST)
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <18676.36929.70542.752650@ron.nulle.part>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
	<48F44CE8.3080409@biostat.ku.dk>
	<alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>
	<18676.33731.948767.124281@ron.nulle.part>
	<alpine.LFD.2.00.0810141237240.27368@gannet.stats.ox.ac.uk>
	<18676.36929.70542.752650@ron.nulle.part>
Message-ID: <alpine.LFD.2.00.0810141330160.7001@gannet.stats.ox.ac.uk>

On Tue, 14 Oct 2008, Dirk Eddelbuettel wrote:

>
> On 14 October 2008 at 12:38, Prof Brian Ripley wrote:
> | The error is on installed.packages(): you have a faulty package installed.
>
> Confirmed. That explains why my update.r from littler worked as it looked
> only at /usr/local/lib/R/.  Being more explicit about lib.loc I get:
>
>> update.packages(repos="http://cran.r-project.org", lib.loc="/usr/lib/R/site-library")
> Error in read.dcf(pkgpath, fields = fields) :
>  Line starting 'unix; ...' is malformed!
>> update.packages(repos="http://cran.r-project.org", lib.loc="/usr/lib/R/library")
> boot :
> Version 1.2-33 installed in /usr/lib/R/library
> Version 1.2-34 available at http://cran.r-project.org
> Update (y/N/c)?  n
> [...]
>>
>
> But how do I find out which package this is, and why did R 2.7.2 didn't fall
> over?

Use options(error=recover), and look at pkgpath in the read.dcf call.

>
> Dirk
>
> |
> | On Tue, 14 Oct 2008, Dirk Eddelbuettel wrote:
> |
> | >
> | > On 14 October 2008 at 10:09, Prof Brian Ripley wrote:
> | > | On Tue, 14 Oct 2008, Peter Dalgaard wrote:
> | > |
> | > | > edd at debian.org wrote:
> | > | >> On 14 October 2008 at 09:39, Simon Blomberg wrote:
> | > | >> | Hi, is anyone else getting this error? Could this be a bug?:
> | > | >> | | > update.packages(ask=FALSE)
> | > | >> | Error in read.dcf(pkgpath, fields = fields) : |   Line starting 'unix;
> | > | >> ...' is malformed!
> | > | >> | | > sessionInfo()
> | > | >> | R version 2.8.0 RC (2008-10-12 r46696) | x86_64-pc-linux-gnu
> | > | >> Confirmed in plain R using the same package built this morning from last
> | > | >> night's tarball from Denmark:  Running update.packages() yields:
> | > | >>
> | > | >>> update.packages()
> | > | >> --- Please select a CRAN mirror for use in this session ---
> | > | >> Loading Tcl/Tk interface ... done
> | > | >> Error in read.dcf(pkgpath, fields = fields) :
> | > | >>   Line starting 'unix; ...' is malformed!
> | > | >>
> | > | >>
> | > | >> OTOH I don't have a problem running my 'update.r' script (included in
> | > | >> littler as
> | > | >> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
> | > | >> ten packages. It is equivalent to calling
> | > | >>> repos <- "http://cran.r-project.org"
> | > | >>> lib.loc <- "/usr/local/lib/R/site-library"
> | > | >>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
> | > | >>
> | > | >> and that sequence also works in plain R.  Could someone please dig into
> | > | >> update.packages() ?
> | > | >> Dirk
> | > | >
> | > | > Hmm, some of us are wary of running update.packages() in non-production
> | > | > versions. Is the problem perhaps originating in getCRANmirors() or
> | > | > chooseCRANmirror()?
> | > |
> | > | (Neither of those read DCF files: my expectation is that this is
> | > | available.packages() reading a DCF file downloaded from a CRAN mirror.)
> | > |
> | > | I do use update.packages() daily on pre-2.8.0 and I have not seen a
> | > | problem.  (I keep a separate package installation for test versions.)
> | > |
> | > | Can we please have some useful debugging info, e.g. the result of
> | > | traceback() and which CRAN mirror is being used?  I suspect a problem with
> | > | downloading PACKAGES.gz resulting in a corrupt file (possibly because it
> | > | was corrupt on the mirror).
> | >
> | > Quite possible. This is a fresh failure picking the 'US (MI)' mirror:
> | >
> | >> update.packages()
> | > --- Please select a CRAN mirror for use in this session ---
> | > Loading Tcl/Tk interface ... done
> | > Error in read.dcf(pkgpath, fields = fields) :
> | >  Line starting 'unix; ...' is malformed!
> | >> traceback()
> | > 6: read.dcf(pkgpath, fields = fields)
> | > 5: .readPkgDesc(lib, fields)
> | > 4: installed.packages(lib.loc = lib.loc)
> | > 3: NROW(instPkgs)
> | > 2: old.packages(lib.loc = lib.loc, contriburl = contriburl, method = method,
> | >       available = available, checkBuilt = checkBuilt)
> | > 1: update.packages()
> | >>
> | >
> | > But if I then re-run chooseCRANmirror() and pick Austria, it still fails:
> | >
> | >> chooseCRANmirror()
> | >> update.packages()
> | > Error in read.dcf(pkgpath, fields = fields) :
> | >  Line starting 'unix; ...' is malformed!
> | >>
> | >
> | > yielding the same traceback.
> | >
> | > Dirk
> | >
> | > --
> | > Three out of two people have difficulties with fractions.
> | >
> |
> | --
> | Brian D. Ripley,                  ripley at stats.ox.ac.uk
> | Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> | University of Oxford,             Tel:  +44 1865 272861 (self)
> | 1 South Parks Road,                     +44 1865 272866 (PA)
> | Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> -- 
> Three out of two people have difficulties with fractions.
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Tue Oct 14 14:40:31 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 14 Oct 2008 07:40:31 -0500
Subject: [Rd] [R-sig-Debian] problem with update.packages (PR#13161)
In-Reply-To: <18676.36929.70542.752650@ron.nulle.part>
References: <20081014004005.F12F2282EF48@mail.pubhealth.ku.dk>
	<48F44CE8.3080409@biostat.ku.dk>
	<alpine.LFD.2.00.0810140845150.20953@gannet.stats.ox.ac.uk>
	<18676.33731.948767.124281@ron.nulle.part>
	<alpine.LFD.2.00.0810141237240.27368@gannet.stats.ox.ac.uk>
	<18676.36929.70542.752650@ron.nulle.part>
Message-ID: <18676.37695.179569.496596@ron.nulle.part>


On 14 October 2008 at 07:27, Dirk Eddelbuettel wrote:
| 
| On 14 October 2008 at 12:38, Prof Brian Ripley wrote:
| | The error is on installed.packages(): you have a faulty package installed.
| 
| Confirmed. That explains why my update.r from littler worked as it looked
| only at /usr/local/lib/R/.  Being more explicit about lib.loc I get:
| 
| > update.packages(repos="http://cran.r-project.org", lib.loc="/usr/lib/R/site-library")
| Error in read.dcf(pkgpath, fields = fields) : 
|   Line starting 'unix; ...' is malformed!
| > update.packages(repos="http://cran.r-project.org", lib.loc="/usr/lib/R/library")
| boot :
|  Version 1.2-33 installed in /usr/lib/R/library 
|  Version 1.2-34 available at http://cran.r-project.org
| Update (y/N/c)?  n
| [...]
| > 
| 
| But how do I find out which package this is, and why did R 2.7.2 didn't fall
| over?

Found it -- it was the non-CRAN package 'sg' for the Shogun toolbox.

Soeren: There is a bug the in the DESCRIPTION file of shogun-r version
0.6.3-1: It needs to keep this on one line:

	Built: 2.7.1; i486-pc-linux-gnu; > .Platform[1]
	unix;

or else R's internal updates fail on R 2.8.0 onwards as reported by Simon on
r-sig-debian yesterday.

R-Core: Please close the bug report on R's side, and thanks as always to BDR
for being spot-on in the analysis.

Dirk
 
| Dirk
| 
| | 
| | On Tue, 14 Oct 2008, Dirk Eddelbuettel wrote:
| | 
| | >
| | > On 14 October 2008 at 10:09, Prof Brian Ripley wrote:
| | > | On Tue, 14 Oct 2008, Peter Dalgaard wrote:
| | > |
| | > | > edd at debian.org wrote:
| | > | >> On 14 October 2008 at 09:39, Simon Blomberg wrote:
| | > | >> | Hi, is anyone else getting this error? Could this be a bug?:
| | > | >> | | > update.packages(ask=FALSE)
| | > | >> | Error in read.dcf(pkgpath, fields = fields) : |   Line starting 'unix;
| | > | >> ...' is malformed!
| | > | >> | | > sessionInfo()
| | > | >> | R version 2.8.0 RC (2008-10-12 r46696) | x86_64-pc-linux-gnu
| | > | >> Confirmed in plain R using the same package built this morning from last
| | > | >> night's tarball from Denmark:  Running update.packages() yields:
| | > | >>
| | > | >>> update.packages()
| | > | >> --- Please select a CRAN mirror for use in this session ---
| | > | >> Loading Tcl/Tk interface ... done
| | > | >> Error in read.dcf(pkgpath, fields = fields) :
| | > | >>   Line starting 'unix; ...' is malformed!
| | > | >>
| | > | >>
| | > | >> OTOH I don't have a problem running my 'update.r' script (included in
| | > | >> littler as
| | > | >> /usr/share/doc/littler/examples/update.r) which just downloaded / upgraded
| | > | >> ten packages. It is equivalent to calling
| | > | >>> repos <- "http://cran.r-project.org"
| | > | >>> lib.loc <- "/usr/local/lib/R/site-library"
| | > | >>> update.packages(repos=repos, ask=FALSE, lib.loc=lib.loc)
| | > | >>
| | > | >> and that sequence also works in plain R.  Could someone please dig into
| | > | >> update.packages() ?
| | > | >> Dirk
| | > | >
| | > | > Hmm, some of us are wary of running update.packages() in non-production
| | > | > versions. Is the problem perhaps originating in getCRANmirors() or
| | > | > chooseCRANmirror()?
| | > |
| | > | (Neither of those read DCF files: my expectation is that this is
| | > | available.packages() reading a DCF file downloaded from a CRAN mirror.)
| | > |
| | > | I do use update.packages() daily on pre-2.8.0 and I have not seen a
| | > | problem.  (I keep a separate package installation for test versions.)
| | > |
| | > | Can we please have some useful debugging info, e.g. the result of
| | > | traceback() and which CRAN mirror is being used?  I suspect a problem with
| | > | downloading PACKAGES.gz resulting in a corrupt file (possibly because it
| | > | was corrupt on the mirror).
| | >
| | > Quite possible. This is a fresh failure picking the 'US (MI)' mirror:
| | >
| | >> update.packages()
| | > --- Please select a CRAN mirror for use in this session ---
| | > Loading Tcl/Tk interface ... done
| | > Error in read.dcf(pkgpath, fields = fields) :
| | >  Line starting 'unix; ...' is malformed!
| | >> traceback()
| | > 6: read.dcf(pkgpath, fields = fields)
| | > 5: .readPkgDesc(lib, fields)
| | > 4: installed.packages(lib.loc = lib.loc)
| | > 3: NROW(instPkgs)
| | > 2: old.packages(lib.loc = lib.loc, contriburl = contriburl, method = method,
| | >       available = available, checkBuilt = checkBuilt)
| | > 1: update.packages()
| | >>
| | >
| | > But if I then re-run chooseCRANmirror() and pick Austria, it still fails:
| | >
| | >> chooseCRANmirror()
| | >> update.packages()
| | > Error in read.dcf(pkgpath, fields = fields) :
| | >  Line starting 'unix; ...' is malformed!
| | >>
| | >
| | > yielding the same traceback.
| | >
| | > Dirk
| | >
| | > -- 
| | > Three out of two people have difficulties with fractions.
| | >
| | 
| | -- 
| | Brian D. Ripley,                  ripley at stats.ox.ac.uk
| | Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
| | University of Oxford,             Tel:  +44 1865 272861 (self)
| | 1 South Parks Road,                     +44 1865 272866 (PA)
| | Oxford OX1 3TG, UK                Fax:  +44 1865 272595
| 
| -- 
| Three out of two people have difficulties with fractions.

-- 
Three out of two people have difficulties with fractions.


From org.r-project.r-devel at pooryorick.com  Tue Oct 14 14:46:36 2008
From: org.r-project.r-devel at pooryorick.com (Nathan Coulter)
Date: Tue, 14 Oct 2008 08:46:36 -0400
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
 not being excluded
In-Reply-To: <alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
References: <48F429D1.6040500@acm.org>	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>
	<alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
Message-ID: <48F494AC.40605@pooryorick.com>

Prof Brian Ripley wrote:

 > But to the point: how often do people get DOS-style files on a
 > Unix-alike? You have to work pretty hard to do this, and there comes a
 > point at which complicating R to workaround wrongly encoded files is not
 > worth the trouble.  Let's see if anyone else reports having done this.
 >

In my experience, this is a common occurrence.  Granted, foreign line
delimiters are less common in a configuration file like .Rbuildignore, but they
have been the culprit more than once in package problems I have encountered.
think functionality like Python's universal newlines would be a big win for R.
One of the big draws in a programming language like Python is its claim to
being portable, and universal newlines are a critical part of that
functionality.  Mac-style newline delimiters are surfacing more often these
days as well, and the best place to sort this all out would be in the built-in
file manipulation functions.

-- 
Nathan Coulter
Computer Programmer


From ripley at stats.ox.ac.uk  Tue Oct 14 14:59:05 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 13:59:05 +0100 (BST)
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
 not being excluded
In-Reply-To: <48F494AC.40605@pooryorick.com>
References: <48F429D1.6040500@acm.org>
	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>
	<alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
	<48F494AC.40605@pooryorick.com>
Message-ID: <alpine.LFD.2.00.0810141356480.12697@gannet.stats.ox.ac.uk>

On Tue, 14 Oct 2008, Nathan Coulter wrote:

> Prof Brian Ripley wrote:
>
>> But to the point: how often do people get DOS-style files on a
>> Unix-alike? You have to work pretty hard to do this, and there comes a
>> point at which complicating R to workaround wrongly encoded files is not
>> worth the trouble.  Let's see if anyone else reports having done this.
>>
>
> In my experience, this is a common occurrence.  Granted, foreign line
> delimiters are less common in a configuration file like .Rbuildignore, but 
> they
> have been the culprit more than once in package problems I have encountered.
> think functionality like Python's universal newlines would be a big win for 
> R.

But R *does* have 'universal newlines' on its connections, and has for 
many years.

We are talking about a Perl script here, not R.

> One of the big draws in a programming language like Python is its claim to
> being portable, and universal newlines are a critical part of that
> functionality.  Mac-style newline delimiters are surfacing more often these
> days as well, and the best place to sort this all out would be in the 
> built-in
> file manipulation functions.
> -- 
> Nathan Coulter
> Computer Programmer
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ligges at statistik.tu-dortmund.de  Tue Oct 14 15:50:07 2008
From: ligges at statistik.tu-dortmund.de (ligges at statistik.tu-dortmund.de)
Date: Tue, 14 Oct 2008 15:50:07 +0200 (CEST)
Subject: [Rd] solve cdf for noncentrality (PR#11527)
Message-ID: <20081014135007.9316F282C768@mail.pubhealth.ku.dk>



Jerry Lewis wrote:
> R implementations of Student's t, chi-squared, F, and beta distributions 
> all support noncentrality parameters.  There is often a need (for example 
> in sample size problems) to invert the cdf to obtain the noncentrality 
> parameter given the quantile, instead of to obtain the quantile given the 
> noncentrality (as the q... functions do).  For example, in SAS, these 
> functions are called TNONCT, CNONCT, and FNONCT.
> 
> I believe that 2.7.0 was the current version when I submitted this on 27 
> May, 2008.  If it has been subsequently addressed, I can find no mention 
> of it either in the 2.7.2 Reference Manual or in today's 
> https://svn.r-project.org/R/trunk/NEWS

Thanks for the clarification. I was not aware you were citing an old bug 
report, because you had not cited anything in your message except for 
the old PR#.

Uwe Ligges




> Jerry
> 
> Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote
>> Jerry.Lewis at biogenidec.com wrote:
>>> Full_Name: Jerry W. Lewis
>>> Version: 2.7.0
>>> OS: Windows XP Professional
>>> Submission from: (NULL) (198.180.131.16)
>>>
>>>
>>> If you are saying that there is no need to solve for the noncentrality
>>> parameter, please justify this amazing assertion.
>> - He? What noncentrality are you talking about?
>> - You are reporting a bug with an outdated version of R.
>> - You have not followed the guide on how to report bugs in R.
>>
>> Uwe Ligges
>>
>>
>>> If you are saying that this need is already adequately addressed in R, 
> then
>>> please enlighten me.


From spluque at gmail.com  Tue Oct 14 16:09:32 2008
From: spluque at gmail.com (Sebastian P. Luque)
Date: Tue, 14 Oct 2008 09:09:32 -0500
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
	not being excluded
References: <48F429D1.6040500@acm.org>
	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>
	<alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
	<48F494AC.40605@pooryorick.com>
Message-ID: <87zll7l143.fsf@patagonia.sebmags.homelinux.org>

On Tue, 14 Oct 2008 08:46:36 -0400,
Nathan Coulter <org.r-project.r-devel at pooryorick.com> wrote:

> Prof Brian Ripley wrote:
>> But to the point: how often do people get DOS-style files on a
>> Unix-alike? You have to work pretty hard to do this, and there comes
>> a point at which complicating R to workaround wrongly encoded files
>> is not worth the trouble.  Let's see if anyone else reports having
>> done this.

> In my experience, this is a common occurrence.

I think so too.  Too often I get files from other people that were
encoded in different systems, so EOL can be a source of grief.  Most of
the time they are DOS (M$), so I got in the habit of using the tofromdos
tools for DOS <-> Unix EOL issues because this is a problem I'd rather
fix for the whole file system, rather than a particular task in R.


-- 
Seb


From jerry.lewis at biogenidec.com  Tue Oct 14 15:45:10 2008
From: jerry.lewis at biogenidec.com (jerry.lewis at biogenidec.com)
Date: Tue, 14 Oct 2008 15:45:10 +0200 (CEST)
Subject: [Rd] solve cdf for noncentrality (PR#11527)
Message-ID: <20081014134510.A30E5282C768@mail.pubhealth.ku.dk>

R implementations of Student's t, chi-squared, F, and beta distributions 
all support noncentrality parameters.  There is often a need (for example 
in sample size problems) to invert the cdf to obtain the noncentrality 
parameter given the quantile, instead of to obtain the quantile given the 
noncentrality (as the q... functions do).  For example, in SAS, these 
functions are called TNONCT, CNONCT, and FNONCT.

I believe that 2.7.0 was the current version when I submitted this on 27 
May, 2008.  If it has been subsequently addressed, I can find no mention 
of it either in the 2.7.2 Reference Manual or in today's 
https://svn.r-project.org/R/trunk/NEWS

Jerry

Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote
>
> Jerry.Lewis at biogenidec.com wrote:
> > Full_Name: Jerry W. Lewis
> > Version: 2.7.0
> > OS: Windows XP Professional
> > Submission from: (NULL) (198.180.131.16)
> >
> >
> > If you are saying that there is no need to solve for the noncentrality
> > parameter, please justify this amazing assertion.
>
> - He? What noncentrality are you talking about?
> - You are reporting a bug with an outdated version of R.
> - You have not followed the guide on how to report bugs in R.
>
> Uwe Ligges
>
>
> > If you are saying that this need is already adequately addressed in R, 
then
> > please enlighten me.
	[[alternative HTML version deleted]]


From tplate at acm.org  Tue Oct 14 17:39:45 2008
From: tplate at acm.org (Tony Plate)
Date: Tue, 14 Oct 2008 09:39:45 -0600
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
 not being excluded
In-Reply-To: <alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
References: <48F429D1.6040500@acm.org>	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org>
	<alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
Message-ID: <48F4BD41.1050504@acm.org>

Prof Brian Ripley wrote:
> On Tue, 14 Oct 2008, Sebastian P. Luque wrote:
>
>> On Mon, 13 Oct 2008 23:10:41 -0600,
>> Tony Plate <tplate at acm.org> wrote:
>>
>>> I was trying, on a Linux system, to get a .Rbuildignore file to work.
>>> After far too long, I found the problem was the <CR><NL> line endings
>>> in the .Rbuildignore file -- I had originally created it on a Windows
>>> system, and emacs in Ubuntu was politely hiding that fact from me.
>>
>> Are you sure? Whenever I open M$ files in Emacs under Debian I see
>> '(DOS)' near the left end of the modeline, which indicates that it has
>> ^C as EOL.  This has been the case since at least 21.0.
>
> ^M^J, I think you mean (CRLF).
>
> Emacs is not totally consistent about how it does this: since it tries 
> to guess the file encoding it will usually indicate (DOS) on the mode 
> line, but not always (and it sometimes displays the ^M's, even on 
> Windows).
>
> But to the point: how often do people get DOS-style files on a 
> Unix-alike? You have to work pretty hard to do this, and there comes a 
> point at which complicating R to workaround wrongly encoded files is 
> not worth the trouble.  Let's see if anyone else reports having done 
> this.
>
It was pretty easy for me to get these line endings -- I created the 
file in GNU Emacs under Windows, and rsync'ed the package directory to a 
Ubuntu Linux machine.  I went back and checked, and GNU Emacs under 
Ubuntu did show (DOS) in the status line of the buffer, but I never 
noticed that while I was trying to figure out why my .Rbuildignore file 
wasn't having any effect.  (I think I preferred it when Emacs would show 
^M at the end of each line in a CRLF file -- not showing that is what I 
meant by "hiding it from me".)

-- Tony Plate


From peter.ruckdeschel at web.de  Tue Oct 14 18:03:57 2008
From: peter.ruckdeschel at web.de (Peter Ruckdeschel)
Date: Tue, 14 Oct 2008 18:03:57 +0200
Subject: [Rd] relative path to source files in vignette [a solution
	somehow]
In-Reply-To: <971536df0810101659j710b91cahdf7e4fac3b0af280@mail.gmail.com>
References: <48EF9CAD.8090006@web.de>	
	<971536df0810101127n49084413pd97ec451e3040228@mail.gmail.com>	
	<48EFA380.8080801@web.de>	
	<971536df0810101334w12014877t408732c9f12edc20@mail.gmail.com>	
	<48EFDFE9.1050806@web.de>
	<971536df0810101659j710b91cahdf7e4fac3b0af280@mail.gmail.com>
Message-ID: <48F4C2ED.2080307@web.de>

Gabor Grothendieck schrieb:
> On Fri, Oct 10, 2008 at 7:06 PM, Peter Ruckdeschel
> <peter.ruckdeschel at web.de> wrote:
>   
[snip]
>> This could indeed be an option, but as noted in my reply to Robert, my
>> guess is that in the library where you install your packages to and which is
>> found with system.file(), you will no longer find the R source files but rather
>> some .rdb or .rdx file. At least this is what I found --- or is there some 
>> magic trick to get back the source files from this?
>>     
>
> Yes, that is what occurs. That's why it was suggested to copy it.
>
>
>   
Not sure whether this is helpful to anyone else out there, but
here is my solution:

I could not find a satisfactory automatic solution
%
(which should find the source folder[s] to my package[s]
 automatically and correspondingly, in R should fill string
 variables),
%
so I placed a README file into the  inst/doc folder where
I explain that to build / check / install my package[s] including
the building of the vignette, one either has to call R CMD from
the parent folder of the source folder to my package (distr)
or one has to define path(s) in a file myPATH.

In the preamble of my .Rnw file, I put

%--------------------------------------------------------------
% --- begin of code from newDistribution.Rnw in pkg distr --- %
%
<<setPath, results=tex, echo=FALSE>>=
if(file.exists("myPATH")){
   cat("\\def\\distrPATH{",readLines("myPATH")[1],"}\n",sep="")
   cat("\\def\\distrExPATH{",readLines("myPATH")[2],"}\n",sep="")
}else{
   cat("\\def\\distrPATH{../../../distr}\n",sep="")
   cat("\\def\\distrExPATH{../../../distrEx}\n",sep="")
}
@
%%%%%%%%%%%%%%%%%%%%%%%%%%%
% define \lstinputlistingWithPath to be able to work with
% path information (parameter #2)
% so syntax for \lstinputlistingWithPath
%
%    \lstinputlistingWithPath[key=value-list]{<path>}{<file>}
%
% which then calls \lstinputlisting[key=value-list]{<path>/<file>}
%(but where <path> may be a macro which is expanded)
%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\makeatletter
\def\lstinputlistingWithPath{\@ifnextchar[%
     {\@lstinputlistingWithPath}{\@lstinputlistingWithPath[]}}
\def\@lstinputlistingWithPath[#1]#2#3{%
    \def\@doLIstInput{\lstinputlisting[#1]}
    \expandafter\@doLIstInput\expandafter{#2/#3}
}
\makeatother
%
% --- end of code from newDistribution.Rnw in pkg distr --- %
%--------------------------------------------------------------

and in the .Rnw file I use

\lstinputlistingWithPath[firstline=<nn>, lastline = <nn>]%
         {\distrPATH}{R/<filename-of-myRsource>.R}

resp.

\lstinputlistingWithPath{\distrPATH}%
  {man/<filename-of-myRsource>.Rd}
 
to include some man-file.
>
> Perhaps you should just preprocess your Sweave files prior to the build.
> The brew package could be used, for example.
>   

I should have a look to it.

Thank you once again,
Peter


From osklyar at maninvestments.com  Tue Oct 14 18:12:25 2008
From: osklyar at maninvestments.com (Sklyar, Oleg (London))
Date: Tue, 14 Oct 2008 17:12:25 +0100
Subject: [Rd] POSIXlt getting sec element at 60 when converting from POSIXct
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE4303049834@mildnpexmb01.maninvestments.ad.man.com>

In some cases rounding problems lead to creation of logically incorrect
times in POSIXlt when converting from POSIXct.

## everything works fine for the following values:
x = c(1223972160.00000, 1223982660.00000, 1223994660.0000)
## adding 0s for the epoch
x = x + as.POSIXct("1970-01-01 00:00") -
as.numeric(as.POSIXct("1970-01-01 00:00"))
x
## [1] "2008-10-14 09:16:00 BST" "2008-10-14 12:11:00 BST"
## [3] "2008-10-14 15:31:00 BST"

Now, numbers that look the same but originate from some calculations
lead to the following weirdness in POSIXlt. Sorry you will not be able
to reproduce as it is impossible to reproduce the same rounding:

> as.character(as.numeric(t1))
[1] "1223972160.00000" "1223982660.00000" "1223994660.00000"
> class(t1)
[1] "POSIXt"  "POSIXct"
## here we get a second less due to rounding errors somewhere, not too
bad
> t1
[1] "2008-10-14 09:15:59 BST" "2008-10-14 12:10:59 BST"
[3] "2008-10-14 15:30:59 BST"
> t2 = as.POSIXlt(t1)
> t2  
[1] "2008-10-14 09:15:59 BST" "2008-10-14 12:10:59 BST"
[3] "2008-10-14 15:30:59 BST"

## however here we do get a real problem
> t2$sec
[1] 60 60 60
## and here as well
> format(t2, "%Y-%m-%d %H:%M:%OS3")
[1] "2008-10-14 09:15:60.000" "2008-10-14 12:10:60.000"
[3] "2008-10-14 15:30:60.000"
> format(t1, "%Y-%m-%d %H:%M:%OS3")
[1] "2008-10-14 09:15:60.000" "2008-10-14 12:10:60.000"
[3] "2008-10-14 15:30:60.000"

Everything is back to normal with applying round (we are anyway limited
to 15 digits):
> t3 = round(as.numeric(t1),5) + .origin
> t3
[1] "2008-10-14 09:16:00 BST" "2008-10-14 12:11:00 BST"
[3] "2008-10-14 15:31:00 BST"

> sessionInfo()
R version 2.9.0 Under development (unstable) (2008-09-30 r46585) 
x86_64-unknown-linux-gnu 

locale:
C

attached base packages:
[1] splines   stats     graphics  utils     datasets  grDevices methods

[8] base     

other attached packages:
[1] AHLFinance_0.1.54  AHLDBConn_0.2.3    ROracle_0.5-9      DBI_0.2-4

[5] RODBC_1.2-3        AHLNagLib_0.1.3    AHLCalendar_0.2.59
AHLBase_0.1.25    

loaded via a namespace (and not attached):
[1] tools_2.9.0

Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3107
osklyar at maninvestments.co

**********************************************************************
The contents of this email are for the named addressees ...{{dropped:19}}


From wdunlap at tibco.com  Tue Oct 14 19:26:22 2008
From: wdunlap at tibco.com (William Dunlap)
Date: Tue, 14 Oct 2008 10:26:22 -0700
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
	not being excluded
In-Reply-To: <48F4BD41.1050504@acm.org>
References: <48F429D1.6040500@acm.org>	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org><alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
	<48F4BD41.1050504@acm.org>
Message-ID: <FBFBD35F5823FD4E97ACDEBB353DD9C614800E@NA-PA-VBE01.na.tibco.com>

 
> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Tony Plate
> Sent: Tuesday, October 14, 2008 8:40 AM
> To: r-devel at stat.math.ethz.ch
> Cc: Sebastian P. Luque; Prof Brian Ripley
> Subject: Re: [Rd] dos-style line endings in .Rbuildignore 
> result in files not being excluded
... 
> It was pretty easy for me to get these line endings -- I 
> created the file in GNU Emacs under Windows, and rsync'ed the 
> package directory to a Ubuntu Linux machine.  I went back and 
> checked, and GNU Emacs under Ubuntu did show (DOS) in the 
> status line of the buffer, but I never noticed that while I 
> was trying to figure out why my .Rbuildignore file wasn't 
> having any effect.  (I think I preferred it when Emacs would 
> show ^M at the end of each line in a CRLF file -- not showing 
> that is what I meant by "hiding it from me".)

In the Splus package system INSTALL copies the whole package
directory to a temp directory before doing any other processing.
If it sees a 'text' file, as determined by the perl -T (or ! -B) file
test operators, the copied file will have local line endings.
We don't use cygwin in the Splus package system, so what the local
line ending is is clear.  (Copying the entire directory also means
we can run INSTALL on a read-only package directory and we don't
leave around *.o or *.obj files that R CMD INSTALL won't like).

Bill Dunlap
TIBCO Spotfire Inc
wdunlap tibco.com


From org.r-project.r-devel at pooryorick.com  Tue Oct 14 19:31:48 2008
From: org.r-project.r-devel at pooryorick.com (=?utf-8?Q?Nathan=20Coulter?=)
Date: Tue, 14 Oct 2008 17:31:48 +0000
Subject: [Rd]
	=?utf-8?q?dos-style_line_endings_in_=2ERbuildignore_result_i?=
	=?utf-8?q?n_files_not_being_excluded?=
Message-ID: <20081014173149.15498.qmail@s461.sureserver.com>

>  -------Original Message-------
>  From: Prof Brian Ripley <ripley at stats.ox.ac.uk>
>  Subject: Re: [Rd] dos-style line endings in .Rbuildignore result in files not being excluded
>  Sent: 2008-10-14 12:59
>  
>  On Tue, 14 Oct 2008, Nathan Coulter wrote:
>  
>  > Prof Brian Ripley wrote:
>  >
>  >> But to the point: how often do people get DOS-style files on a
>  >> Unix-alike? You have to work pretty hard to do this, and there comes a
>  >> point at which complicating R to workaround wrongly encoded files is not
>  >> worth the trouble.  Let's see if anyone else reports having done this.
>  >>
>  >
>  > In my experience, this is a common occurrence.  Granted, foreign line
>  > delimiters are less common in a configuration file like .Rbuildignore, but
>  > they
>  > have been the culprit more than once in package problems I have encountered.
>  > think functionality like Python's universal newlines would be a big win for
>  > R.
>  
>  But R *does* have 'universal newlines' on its connections, and has for
>  many years.
>  

I'm suggesting that Python might be a better choice than perl for auxiliary
scripts because these details are handled under the hood.

-- 
Nathan Coulter




>  -------Original Message-------
>  From: Prof Brian Ripley <ripley at stats.ox.ac.uk>
>  Subject: Re: [Rd] dos-style line endings in .Rbuildignore result in files not being excluded
>  Sent: 2008-10-14 12:59
>  
>  On Tue, 14 Oct 2008, Nathan Coulter wrote:
>  
>  > Prof Brian Ripley wrote:
>  >
>  >> But to the point: how often do people get DOS-style files on a
>  >> Unix-alike? You have to work pretty hard to do this, and there comes a
>  >> point at which complicating R to workaround wrongly encoded files is not
>  >> worth the trouble.??Let's see if anyone else reports having done this.
>  >>
>  >
>  > In my experience, this is a common occurrence.??Granted, foreign line
>  > delimiters are less common in a configuration file like .Rbuildignore, but
>  > they
>  > have been the culprit more than once in package problems I have encountered.
>  > think functionality like Python's universal newlines would be a big win for
>  > R.
>  
>  But R *does* have 'universal newlines' on its connections, and has for
>  many years.
>  
>  We are talking about a Perl script here, not R.
>  
>  > One of the big draws in a programming language like Python is its claim to
>  > being portable, and universal newlines are a critical part of that
>  > functionality.??Mac-style newline delimiters are surfacing more often these
>  > days as well, and the best place to sort this all out would be in the
>  > built-in
>  > file manipulation functions.
>  > --
>  > Nathan Coulter
>  > Computer Programmer
>  >
>  
>  --
>  Brian D. Ripley,??????????????????ripley at stats.ox.ac.uk
>  Professor of Applied Statistics,??http://www.stats.ox.ac.uk/~ripley/
>  University of Oxford,???????????? Tel:??+44 1865 272861 (self)
>  1 South Parks Road,???????????????????? +44 1865 272866 (PA)
>  Oxford OX1 3TG, UK????????????????Fax:??+44 1865 272595
>


From ripley at stats.ox.ac.uk  Tue Oct 14 19:38:30 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Oct 2008 18:38:30 +0100 (BST)
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
 not being excluded
In-Reply-To: <FBFBD35F5823FD4E97ACDEBB353DD9C614800E@NA-PA-VBE01.na.tibco.com>
References: <48F429D1.6040500@acm.org>
	<874p3fn3yf.fsf@patagonia.sebmags.homelinux.org><alpine.LFD.2.00.0810141248500.27617@gannet.stats.ox.ac.uk>
	<48F4BD41.1050504@acm.org>
	<FBFBD35F5823FD4E97ACDEBB353DD9C614800E@NA-PA-VBE01.na.tibco.com>
Message-ID: <alpine.LFD.2.00.0810141835510.28969@gannet.stats.ox.ac.uk>

Thanks Bill, but this is 'build'.  It is intended that INSTALL will be an 
R script in R 2.9.0 (actually, we intended it for 2.8.0 but ran out of 
time).

Our recommendation is to install from a tarball, except perhaps during 
package development. So read-only package dirs are not an issue.


On Tue, 14 Oct 2008, William Dunlap wrote:

>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org
>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Tony Plate
>> Sent: Tuesday, October 14, 2008 8:40 AM
>> To: r-devel at stat.math.ethz.ch
>> Cc: Sebastian P. Luque; Prof Brian Ripley
>> Subject: Re: [Rd] dos-style line endings in .Rbuildignore
>> result in files not being excluded
> ...
>> It was pretty easy for me to get these line endings -- I
>> created the file in GNU Emacs under Windows, and rsync'ed the
>> package directory to a Ubuntu Linux machine.  I went back and
>> checked, and GNU Emacs under Ubuntu did show (DOS) in the
>> status line of the buffer, but I never noticed that while I
>> was trying to figure out why my .Rbuildignore file wasn't
>> having any effect.  (I think I preferred it when Emacs would
>> show ^M at the end of each line in a CRLF file -- not showing
>> that is what I meant by "hiding it from me".)
>
> In the Splus package system INSTALL copies the whole package
> directory to a temp directory before doing any other processing.
> If it sees a 'text' file, as determined by the perl -T (or ! -B) file
> test operators, the copied file will have local line endings.
> We don't use cygwin in the Splus package system, so what the local
> line ending is is clear.  (Copying the entire directory also means
> we can run INSTALL on a read-only package directory and we don't
> leave around *.o or *.obj files that R CMD INSTALL won't like).
>
> Bill Dunlap
> TIBCO Spotfire Inc
> wdunlap tibco.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Oct 15 05:10:52 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Oct 2008 04:10:52 +0100 (BST)
Subject: [Rd] POSIXlt getting sec element at 60 when converting from
 POSIXct
In-Reply-To: <1A68FCB28DE72F4BA3B967E6506CCE4303049834@mildnpexmb01.maninvestments.ad.man.com>
References: <1A68FCB28DE72F4BA3B967E6506CCE4303049834@mildnpexmb01.maninvestments.ad.man.com>
Message-ID: <alpine.LFD.2.00.0810150406140.5558@gannet.stats.ox.ac.uk>

As you say, not reproducible.  Any chance that you could put a save() file 
containing t1 somewhere we can get it?

On Tue, 14 Oct 2008, Sklyar, Oleg (London) wrote:

> In some cases rounding problems lead to creation of logically incorrect
> times in POSIXlt when converting from POSIXct.
>
> ## everything works fine for the following values:
> x = c(1223972160.00000, 1223982660.00000, 1223994660.0000)
> ## adding 0s for the epoch
> x = x + as.POSIXct("1970-01-01 00:00") -
> as.numeric(as.POSIXct("1970-01-01 00:00"))
> x
> ## [1] "2008-10-14 09:16:00 BST" "2008-10-14 12:11:00 BST"
> ## [3] "2008-10-14 15:31:00 BST"
>
> Now, numbers that look the same but originate from some calculations
> lead to the following weirdness in POSIXlt. Sorry you will not be able
> to reproduce as it is impossible to reproduce the same rounding:
>
>> as.character(as.numeric(t1))
> [1] "1223972160.00000" "1223982660.00000" "1223994660.00000"
>> class(t1)
> [1] "POSIXt"  "POSIXct"
> ## here we get a second less due to rounding errors somewhere, not too
> bad
>> t1
> [1] "2008-10-14 09:15:59 BST" "2008-10-14 12:10:59 BST"
> [3] "2008-10-14 15:30:59 BST"
>> t2 = as.POSIXlt(t1)
>> t2
> [1] "2008-10-14 09:15:59 BST" "2008-10-14 12:10:59 BST"
> [3] "2008-10-14 15:30:59 BST"
>
> ## however here we do get a real problem
>> t2$sec
> [1] 60 60 60
> ## and here as well
>> format(t2, "%Y-%m-%d %H:%M:%OS3")
> [1] "2008-10-14 09:15:60.000" "2008-10-14 12:10:60.000"
> [3] "2008-10-14 15:30:60.000"
>> format(t1, "%Y-%m-%d %H:%M:%OS3")
> [1] "2008-10-14 09:15:60.000" "2008-10-14 12:10:60.000"
> [3] "2008-10-14 15:30:60.000"
>
> Everything is back to normal with applying round (we are anyway limited
> to 15 digits):
>> t3 = round(as.numeric(t1),5) + .origin
>> t3
> [1] "2008-10-14 09:16:00 BST" "2008-10-14 12:11:00 BST"
> [3] "2008-10-14 15:31:00 BST"
>
>> sessionInfo()
> R version 2.9.0 Under development (unstable) (2008-09-30 r46585)
> x86_64-unknown-linux-gnu
>
> locale:
> C
>
> attached base packages:
> [1] splines   stats     graphics  utils     datasets  grDevices methods
>
> [8] base
>
> other attached packages:
> [1] AHLFinance_0.1.54  AHLDBConn_0.2.3    ROracle_0.5-9      DBI_0.2-4
>
> [5] RODBC_1.2-3        AHLNagLib_0.1.3    AHLCalendar_0.2.59
> AHLBase_0.1.25
>
> loaded via a namespace (and not attached):
> [1] tools_2.9.0
>
> Dr Oleg Sklyar
> Research Technologist
> AHL / Man Investments Ltd
> +44 (0)20 7144 3107
> osklyar at maninvestments.co
>
> **********************************************************************
> The contents of this email are for the named addressees ...{{dropped:19}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From dleong at analogic.com  Tue Oct 14 23:30:09 2008
From: dleong at analogic.com (dleong at analogic.com)
Date: Tue, 14 Oct 2008 23:30:09 +0200 (CEST)
Subject: [Rd] fivenum accuracy (PR#13164)
Message-ID: <20081014213009.8B6C8282EFC1@mail.pubhealth.ku.dk>

Full_Name: David Leong
Version: 2.7.2
OS: Windows XP
Submission from: (NULL) (12.187.86.2)


It appears for the fivenum function, there is a strait average between two
ranked samples. This should be a linear interpolation between ranks.
For the following data set

#data
CaCO3<-c(130.8,129.9,131.5,131.2,129.5,132.7,131.5,127.8,133.7,132.2,134.8,131.7,133.9,129.8,131.4,128.8,132.7,132.8,131.4,131.3)

fivenum reports 127.80 130.35 131.45 132.70 134.80

130.35 should be 130.125. The other are correct.

For the 20 points, the rank is (20+1)/4=5.25 so the weighting factor is 0.25 not
0.5.


From chakj at stanford.edu  Wed Oct 15 00:00:03 2008
From: chakj at stanford.edu (chakj at stanford.edu)
Date: Wed, 15 Oct 2008 00:00:03 +0200 (CEST)
Subject: [Rd] R CMD config doesn't export JAVA_LD_LIBRARY_PATH (PR#13165)
Message-ID: <20081014220003.960C7282EFC1@mail.pubhealth.ku.dk>

R CMD config exports the following variables:

   JAR           Java archive tool command
   JAVA          Java interpreter command
   JAVAC         Java compiler command
   JAVAH         Java header and stub generator command
   JAVA_HOME     path to the home of Java distribution
   JAVA_LIBS     flags needed for linking against Java libraries
   JAVA_CPPFLAGS C preprocessor flags needed for compiling JNI programs

JAVA_LD_LIBRARY_PATH is defined in Makeconf, but not exported. 
Specifically, src/scripts/config includes the following line:
ok_java_vars="JAVA JAVAC JAVAH JAR JAVA_HOME JAVA_LIBS JAVA_CPPFLAGS"

This list does not include JAVA_LD_LIBRARY_PATH, with no explanation of 
why not. Providing this env variable would allow developers to use RPATH 
instead of setting the LD_LIBRARY_PATH variable by hand before running R 
extensions that use Java.

--please do not edit the information below--

Version:
  platform = x86_64-pc-linux-gnu
  arch = x86_64
  os = linux-gnu
  system = x86_64, linux-gnu
  status =
  major = 2
  minor = 7.1
  year = 2008
  month = 06
  day = 23
  svn rev = 45970
  language = R
  version.string = R version 2.7.1 (2008-06-23)

Locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

Search Path:
  .GlobalEnv, package:stats, package:graphics, package:grDevices, 
package:utils, package:datasets, package:methods, Autoloads, package:base


From prokaj at cs.elte.hu  Wed Oct 15 09:05:04 2008
From: prokaj at cs.elte.hu (prokaj at cs.elte.hu)
Date: Wed, 15 Oct 2008 09:05:04 +0200 (CEST)
Subject: [Rd] aggregate(empty data.frame) (PR#13167)
Message-ID: <20081015070504.6707E282C787@mail.pubhealth.ku.dk>

Full_Name: Vilmos Prokaj
Version: R-2..7.1
OS: Win XP
Submission from: (NULL) (157.181.227.218)


The 'aggregate' function on an empty data.frame generate an error, however it
should return according to the documentation an empty data.frame.

e.g.
z<-data.frame(a=integer(0),b=numeric(0))
aggregate(z,by=z[1],FUN=sum)

In a more realistic situation 'z' is of the form z<-zz[cond,] where cond is a
computed logical vector and zz is not empty data.frame.


From ripley at stats.ox.ac.uk  Wed Oct 15 12:04:47 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Oct 2008 11:04:47 +0100 (BST)
Subject: [Rd] (PR#13165) R CMD config doesn't export JAVA_LD_LIBRARY_PATH
In-Reply-To: <20081014220003.960C7282EFC1@mail.pubhealth.ku.dk>
References: <20081014220003.960C7282EFC1@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810151050370.23866@gannet.stats.ox.ac.uk>

The subject line is true, and as documented hence not a bug.

If this was meant to be an enhancement request, please note that the R FAQ 
said

   There is a section of the bug repository for suggestions for
   enhancements for R labelled `wishlist'.  Suggestions can be submitted
   in the same ways as bugs, but please ensure that the subject line makes
   clear that this is for the wishlist and not a bug report, for example by
   starting with `Wishlist:'.

On Wed, 15 Oct 2008, chakj at stanford.edu wrote:

> R CMD config exports the following variables:
>
>   JAR           Java archive tool command
>   JAVA          Java interpreter command
>   JAVAC         Java compiler command
>   JAVAH         Java header and stub generator command
>   JAVA_HOME     path to the home of Java distribution
>   JAVA_LIBS     flags needed for linking against Java libraries
>   JAVA_CPPFLAGS C preprocessor flags needed for compiling JNI programs
>
> JAVA_LD_LIBRARY_PATH is defined in Makeconf, but not exported.
> Specifically, src/scripts/config includes the following line:
> ok_java_vars="JAVA JAVAC JAVAH JAR JAVA_HOME JAVA_LIBS JAVA_CPPFLAGS"
>
> This list does not include JAVA_LD_LIBRARY_PATH, with no explanation of
> why not. Providing this env variable would allow developers to use RPATH
> instead of setting the LD_LIBRARY_PATH variable by hand before running R
> extensions that use Java.

What is RPATH?  Since R and R CMD set a LD_LIBRARY_PATH that includes 
JAVA_LD_LIBRARY_PATH, this makes no sense to me: the documented way is to 
run extensions via loading into R or via R CMD.

If you can make a good case for changing this, please re-submit an 
enhancement request containing that case in the form described in the FAQ, 
giving your credentials (this email is from an unnamed account and 
unsigned: we have no idea who you are).

> --please do not edit the information below--
>
> Version:
>  platform = x86_64-pc-linux-gnu
>  arch = x86_64
>  os = linux-gnu
>  system = x86_64, linux-gnu
>  status =
>  major = 2
>  minor = 7.1
>  year = 2008
>  month = 06
>  day = 23
>  svn rev = 45970
>  language = R
>  version.string = R version 2.7.1 (2008-06-23)
>
> Locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> Search Path:
>  .GlobalEnv, package:stats, package:graphics, package:grDevices,
> package:utils, package:datasets, package:methods, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Wed Oct 15 12:23:46 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 15 Oct 2008 06:23:46 -0400
Subject: [Rd] fivenum accuracy (PR#13164)
In-Reply-To: <20081014213009.8B6C8282EFC1@mail.pubhealth.ku.dk>
References: <20081014213009.8B6C8282EFC1@mail.pubhealth.ku.dk>
Message-ID: <48F5C4B2.2040308@stats.uwo.ca>

On 14/10/2008 5:30 PM, dleong at analogic.com wrote:
> Full_Name: David Leong
> Version: 2.7.2
> OS: Windows XP
> Submission from: (NULL) (12.187.86.2)
> 
> 
> It appears for the fivenum function, there is a strait average between two
> ranked samples. This should be a linear interpolation between ranks.

Not according to the documentation.  This is not a bug.

If you want quantiles, use the quantile function.  fivenum() is 
documented to give Tukey's five number summary (minimum, lower-hinge, 
median, upper-hinge, maximum).

Duncan Murdoch

> For the following data set
> 
> #data
> CaCO3<-c(130.8,129.9,131.5,131.2,129.5,132.7,131.5,127.8,133.7,132.2,134.8,131.7,133.9,129.8,131.4,128.8,132.7,132.8,131.4,131.3)
> 
> fivenum reports 127.80 130.35 131.45 132.70 134.80
> 
> 130.35 should be 130.125. The other are correct.
> 
> For the 20 points, the rank is (20+1)/4=5.25 so the weighting factor is 0.25 not
> 0.5.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Wed Oct 15 14:15:29 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Oct 2008 13:15:29 +0100 (BST)
Subject: [Rd] aggregate(empty data.frame) (PR#13167)
In-Reply-To: <20081015070504.6707E282C787@mail.pubhealth.ku.dk>
References: <20081015070504.6707E282C787@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810151249350.11137@gannet.stats.ox.ac.uk>

On Wed, 15 Oct 2008, prokaj at cs.elte.hu wrote:

> Full_Name: Vilmos Prokaj
> Version: R-2..7.1
> OS: Win XP
> Submission from: (NULL) (157.181.227.218)
>
>
> The 'aggregate' function on an empty data.frame generate an error, however it
> should return according to the documentation an empty data.frame.

Please explain that to me: I don't see it says so.

What I see is

      'aggregate.data.frame' is the data frame method.  If 'x' is not a
      data frame, it is coerced to one.  Then, each of the variables
      (columns) in 'x' is split into subsets of cases (rows) of
      identical combinations of the components of 'by', and 'FUN' is
      applied to each such subset with further arguments in '...' passed
      to it. (I.e., 'tapply(VAR, by, FUN, ..., simplify = FALSE)' is
      done for each variable 'VAR' in 'x', conveniently wrapped into one
      call to 'lapply()'.) Empty subsets are removed, and the result is
      reformatted into a data frame containing the variables in 'by' and
      'x'.

Since all the subsets are empty, there is no result to be reformatted. 
In particular the second and third columns of your example have types that 
can only be determined by running sum() and since all groups are empty, 
sum() is never run.  We can't create a data frame that would be consistent 
with that returned for one or more groups via the documented algorithm.

The error message could definitely be clearer, but I don't see an 
alternative to giving an error.

> e.g.
> z<-data.frame(a=integer(0),b=numeric(0))
> aggregate(z,by=z[1],FUN=sum)
>
> In a more realistic situation 'z' is of the form z<-zz[cond,] where cond is a
> computed logical vector and zz is not empty data.frame.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ebihallo at gmail.com  Wed Oct 15 15:30:04 2008
From: ebihallo at gmail.com (ebihallo at gmail.com)
Date: Wed, 15 Oct 2008 15:30:04 +0200 (CEST)
Subject: [Rd] error installing gtools (PR#13168)
Message-ID: <20081015133004.62C22282EF48@mail.pubhealth.ku.dk>

Full_Name: Ebi Hal
Version: R-2.7.2-1
OS: Fedora core 9
Submission from: (NULL) (129.215.170.238)


I tried to install gplots by running
R> install.packages("gplots")
but the process failed while installing "gtools" with the following error
message:

* Installing to library '/usr/lib64/R/library'
* Installing *source* package 'gtools' ...
** libs
gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g
-pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
--param=ssp-buffer-size=4 -m64 -mtune=generic -c setTCPNoDelay.c -o
setTCPNoDelay.o
setTCPNoDelay.c:1:15: error: R.h: No such file or directory
setTCPNoDelay.c:2:24: error: Rinternals.h: No such file or directory
setTCPNoDelay.c: In function ?checkStatus?:
setTCPNoDelay.c:66: warning: implicit declaration of function ?strncpy?
setTCPNoDelay.c:66: warning: incompatible implicit declaration of built-in
function ?strncpy?
setTCPNoDelay.c:72: warning: implicit declaration of function ?strerror?
setTCPNoDelay.c:72: warning: passing argument 2 of ?strncpy? makes pointer from
integer without a cast
make: *** [setTCPNoDelay.o] Error 1
ERROR: compilation failed for package 'gtools'
** Removing '/usr/lib64/R/library/gtools'

Indeed there are no such files as R.h and Rinternals.h

Any idea how can I solve this problem?

Thanks a lot,
Ebi


From plummer at iarc.fr  Wed Oct 15 18:55:03 2008
From: plummer at iarc.fr (Martyn Plummer)
Date: Wed, 15 Oct 2008 18:55:03 +0200
Subject: [Rd] error installing gtools (PR#13168)
In-Reply-To: <20081015133004.62C22282EF48@mail.pubhealth.ku.dk>
References: <20081015133004.62C22282EF48@mail.pubhealth.ku.dk>
Message-ID: <1224089703.7387.28.camel@seurat.iarc.fr>

Ebi,

You need to install the R-devel RPM, which has the header files.
If this is a bug (which it arguably is) it is a problem with the Fedora
distribution, not with R itself.

Martyn

On Wed, 2008-10-15 at 15:30 +0200, ebihallo at gmail.com wrote:
> Full_Name: Ebi Hal
> Version: R-2.7.2-1
> OS: Fedora core 9
> Submission from: (NULL) (129.215.170.238)
> 
> 
> I tried to install gplots by running
> R> install.packages("gplots")
> but the process failed while installing "gtools" with the following error
> message:
> 
> * Installing to library '/usr/lib64/R/library'
> * Installing *source* package 'gtools' ...
> ** libs
> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g
> -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
> --param=ssp-buffer-size=4 -m64 -mtune=generic -c setTCPNoDelay.c -o
> setTCPNoDelay.o
> setTCPNoDelay.c:1:15: error: R.h: No such file or directory
> setTCPNoDelay.c:2:24: error: Rinternals.h: No such file or directory
> setTCPNoDelay.c: In function ?checkStatus?:
> setTCPNoDelay.c:66: warning: implicit declaration of function ?strncpy?
> setTCPNoDelay.c:66: warning: incompatible implicit declaration of built-in
> function ?strncpy?
> setTCPNoDelay.c:72: warning: implicit declaration of function ?strerror?
> setTCPNoDelay.c:72: warning: passing argument 2 of ?strncpy? makes pointer from
> integer without a cast
> make: *** [setTCPNoDelay.o] Error 1
> ERROR: compilation failed for package 'gtools'
> ** Removing '/usr/lib64/R/library/gtools'
> 
> Indeed there are no such files as R.h and Rinternals.h
> 
> Any idea how can I solve this problem?
> 
> Thanks a lot,
> Ebi
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From ripley at stats.ox.ac.uk  Wed Oct 15 19:50:18 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Oct 2008 18:50:18 +0100 (BST)
Subject: [Rd] error installing gtools (PR#13168)
In-Reply-To: <1224089703.7387.28.camel@seurat.iarc.fr>
References: <20081015133004.62C22282EF48@mail.pubhealth.ku.dk>
	<1224089703.7387.28.camel@seurat.iarc.fr>
Message-ID: <alpine.LFD.2.00.0810151848090.20878@gannet.stats.ox.ac.uk>

R 2.8.0 at least will tell you that that you may need R-devel.rpm.

My view is that this a Fedora bug.

On Wed, 15 Oct 2008, Martyn Plummer wrote:

> Ebi,
>
> You need to install the R-devel RPM, which has the header files.
> If this is a bug (which it arguably is) it is a problem with the Fedora
> distribution, not with R itself.
>
> Martyn
>
> On Wed, 2008-10-15 at 15:30 +0200, ebihallo at gmail.com wrote:
>> Full_Name: Ebi Hal
>> Version: R-2.7.2-1
>> OS: Fedora core 9
>> Submission from: (NULL) (129.215.170.238)
>>
>>
>> I tried to install gplots by running
>> R> install.packages("gplots")
>> but the process failed while installing "gtools" with the following error
>> message:
>>
>> * Installing to library '/usr/lib64/R/library'
>> * Installing *source* package 'gtools' ...
>> ** libs
>> gcc -m64 -std=gnu99 -I/usr/include/R  -I/usr/local/include    -fpic  -O2 -g
>> -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
>> --param=ssp-buffer-size=4 -m64 -mtune=generic -c setTCPNoDelay.c -o
>> setTCPNoDelay.o
>> setTCPNoDelay.c:1:15: error: R.h: No such file or directory
>> setTCPNoDelay.c:2:24: error: Rinternals.h: No such file or directory
>> setTCPNoDelay.c: In function ?checkStatus?:
>> setTCPNoDelay.c:66: warning: implicit declaration of function ?strncpy?
>> setTCPNoDelay.c:66: warning: incompatible implicit declaration of built-in
>> function ?strncpy?
>> setTCPNoDelay.c:72: warning: implicit declaration of function ?strerror?
>> setTCPNoDelay.c:72: warning: passing argument 2 of ?strncpy? makes pointer from
>> integer without a cast
>> make: *** [setTCPNoDelay.o] Error 1
>> ERROR: compilation failed for package 'gtools'
>> ** Removing '/usr/lib64/R/library/gtools'
>>
>> Indeed there are no such files as R.h and Rinternals.h
>>
>> Any idea how can I solve this problem?
>>
>> Thanks a lot,
>> Ebi
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> -----------------------------------------------------------------------
> This message and its attachments are strictly confidenti...{{dropped:8}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From apjaworski at mmm.com  Wed Oct 15 20:41:07 2008
From: apjaworski at mmm.com (apjaworski at mmm.com)
Date: Wed, 15 Oct 2008 13:41:07 -0500
Subject: [Rd] small bug in plot.rpart?
Message-ID: <OF79F508E2.CB3BC355-ON862574E3.0065C02C-862574E3.0066A450@mmm.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081015/51124b4f/attachment.pl>

From ripley at stats.ox.ac.uk  Wed Oct 15 21:46:02 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Oct 2008 20:46:02 +0100 (BST)
Subject: [Rd] small bug in plot.rpart?
In-Reply-To: <OF79F508E2.CB3BC355-ON862574E3.0065C02C-862574E3.0066A450@mmm.com>
References: <OF79F508E2.CB3BC355-ON862574E3.0065C02C-862574E3.0066A450@mmm.com>
Message-ID: <alpine.LFD.2.00.0810152038170.23822@gannet.stats.ox.ac.uk>

>From the posting guide:

   For questions about unexpected behavior or a possible bug, you should,
   at a minimum, copy and paste the output from sessionInfo() into your
   message.

(This would have told us the rpart version number.)

   When mentioning version numbers, always use the full version number,
   e.g., `2.6.1', not just `2.6', and also mention the platform
   (Windows2000, Linux, MacOS X, with their versions).

   If the question relates to a contributed package , e.g., one downloaded
   from CRAN, try contacting the package maintainer first.

(rpart is a contributed package: see library(help="rpart").)

And from the FAQ:

   Bug reports on contributed packages should be sent first to the
   package maintainer, and only submitted to the R-bugs repository by
   package maintainers, mentioning the package in the subject line.

As the rpart maintainer I can tell you that this will be changed to use 
dev.new() in the next release, but the current release (3.1-41) is over 6 
months' old and predates development of 2.8.0.

On Wed, 15 Oct 2008, apjaworski at mmm.com wrote:

> Hi,
>
> This happens in 2.8 and 2.9.  I am posting this here because I am not sure
> if one should use bug.report for reporting bugs in unreleased versions.
>
> I was trying to run the example from the help page of plot.rpart.  I got
>
>> library(rpart)
>> fit <- rpart(Price ~ Mileage + Type + Country, cu.summary)
>> plot(fit, compress=TRUE)
> Error in get(getOption("device")) : invalid first argument
>
> This also produces a blank graphics window.  When I run the plot command
> again everything seems to work fine, so the error only occurs when the
> graphics window is not open.
>
> I use Windows XP SP2.  I just compiled the newest RC of 2.8 (R version
> 2.8.0 RC (2008-10-14 r46714)).  I ran "make fullcheck" on it and
> everything checked out fine.
>
> The same thing happens in 2.9 but it worked fine in 2.7.2.
>
> Andy
>
>
> __________________________________
> Andy Jaworski
> 518-1-01
> Process Laboratory
> 3M Corporate Research Laboratory
> -----
> E-mail: apjaworski at mmm.com
> Tel:  (651) 733-6092
> Fax:  (651) 736-3122
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Thu Oct 16 06:54:52 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Oct 2008 05:54:52 +0100 (BST)
Subject: [Rd] dos-style line endings in .Rbuildignore result in files
 not being excluded
In-Reply-To: <20081014173149.15498.qmail@s461.sureserver.com>
References: <20081014173149.15498.qmail@s461.sureserver.com>
Message-ID: <alpine.LFD.2.00.0810141838430.28969@gannet.stats.ox.ac.uk>

On Tue, 14 Oct 2008, Nathan Coulter wrote:

>>  -------Original Message-------
>>  From: Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>  Subject: Re: [Rd] dos-style line endings in .Rbuildignore result in files not being excluded
>>  Sent: 2008-10-14 12:59
>>
>>  On Tue, 14 Oct 2008, Nathan Coulter wrote:
>>
>> > Prof Brian Ripley wrote:
>> >
>> >> But to the point: how often do people get DOS-style files on a
>> >> Unix-alike? You have to work pretty hard to do this, and there comes a
>> >> point at which complicating R to workaround wrongly encoded files is not
>> >> worth the trouble.  Let's see if anyone else reports having done this.
>> >>
>> >
>> > In my experience, this is a common occurrence.  Granted, foreign line
>> > delimiters are less common in a configuration file like .Rbuildignore, but
>> > they
>> > have been the culprit more than once in package problems I have encountered.
>> > think functionality like Python's universal newlines would be a big win for
>> > R.
>>
>>  But R *does* have 'universal newlines' on its connections, and has for
>>  many years.
>>
>
> I'm suggesting that Python might be a better choice than perl for auxiliary
> scripts because these details are handled under the hood.

You've completely missed the point: R would be a better choice than 
either.

When R was first released it was slow to start up and not good at 
scripting.  But that's no longer true and the plan is to replace Perl 
scripts with R scripts.  Making the developers learn an extra scripting 
language (Python, and a most un-R-like one at that) just to get a feature 
R already has would be ludicrous.

>
> -- 
> Nathan Coulter
>
>
>
>
>>  -------Original Message-------
>>  From: Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>  Subject: Re: [Rd] dos-style line endings in .Rbuildignore result in files not being excluded
>>  Sent: 2008-10-14 12:59
>>
>>  On Tue, 14 Oct 2008, Nathan Coulter wrote:
>>
>> > Prof Brian Ripley wrote:
>> >
>> >> But to the point: how often do people get DOS-style files on a
>> >> Unix-alike? You have to work pretty hard to do this, and there comes a
>> >> point at which complicating R to workaround wrongly encoded files is not
>> >> worth the trouble.??Let's see if anyone else reports having done this.
>> >>
>> >
>> > In my experience, this is a common occurrence.??Granted, foreign line
>> > delimiters are less common in a configuration file like .Rbuildignore, but
>> > they
>> > have been the culprit more than once in package problems I have encountered.
>> > think functionality like Python's universal newlines would be a big win for
>> > R.
>>
>>  But R *does* have 'universal newlines' on its connections, and has for
>>  many years.
>>
>>  We are talking about a Perl script here, not R.
>>
>> > One of the big draws in a programming language like Python is its claim to
>> > being portable, and universal newlines are a critical part of that
>> > functionality.??Mac-style newline delimiters are surfacing more often these
>> > days as well, and the best place to sort this all out would be in the
>> > built-in
>> > file manipulation functions.
>> > --
>> > Nathan Coulter
>> > Computer Programmer
>> >
>>
>>  --
>>  Brian D. Ripley,??????????????????ripley at stats.ox.ac.uk
>>  Professor of Applied Statistics,??http://www.stats.ox.ac.uk/~ripley/
>>  University of Oxford,???????????? Tel:??+44 1865 272861 (self)
>>  1 South Parks Road,???????????????????? +44 1865 272866 (PA)
>>  Oxford OX1 3TG, UK????????????????Fax:??+44 1865 272595
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu Oct 16 11:03:11 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Oct 2008 10:03:11 +0100 (BST)
Subject: [Rd] RFC: Kerning, postscript() and pdf()
In-Reply-To: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
Message-ID: <alpine.LFD.2.00.0810161002040.13524@gannet.stats.ox.ac.uk>

I've now implemented B and C in R-devel, with C as the default.

On Sun, 12 Oct 2008, Prof Brian Ripley wrote:

> Ei-ji Nakama has pointed out (from another Japanese user, I believe) that 
> postscript() and pdf() have not been handling kerning correctly, and this is 
> a request for opinions about how we should correct it.
>
> Kerning is the adjustment of the spacing between letters from their natural 
> width, so that for example 'Yo' is usually typeset with the o closer to the Y 
> than 'Yl' would be.  Kerning is not very well standardized, so that for 
> example R's default Helvetica and its URW clone (Nimbus Sans) have quite 
> different ideas of the amount of kerning corrections for 'Yo'. This matters, 
> because not many people actually see Helvetica when viewing R's PostScript or 
> PDF output, but rather a similar face like Nimbus Sans or Arial, or in the 
> case of Acrobat Reader, a not very similar face.  Kerning is only a feature 
> of some proportionally spaced fonts and so not of Courier nor CJK fonts.
>
> The current position (R <= 2.8.0) is that string widths have been computing 
> using kerning from the Adobe Font Metric files for the nominal font, but the 
> strings have been displayed without using kerning (at least in the viewers we 
> are aware of, and the PostScript and PDF reference manuals mandate that 
> behaviour, if rather obscurely).  This means that in strings such as 'You', 
> the width used in the string placement differs from that actually displayed.
>
> For postscript(), this doesn't have much impact, as centring or right 
> justification ('hadj' in text()) is done by PostScript code and computes the 
> width from the actual font used (and so copes well with font substitution). 
> It might affect the fine layout in plotmath, but using strings which would be 
> kerned in annotations is not common.
>
> For pdf() the effect is more commonly seen, as all text is set 
> left-justified, and the computed width is used to centre/right-justify.
>
> There are several things we could do:
>
> A.  Do nothing, for back compatibility.  After all, this has been going on 
> for years and no one has complained until last month.
>
> B.  Ignore kerning, and hence change the string width computations to match 
> the current display.  This is more attractive than it appears at first sight 
> -- as far as I know all other devices ignore kerning, and we are increasingly 
> used to seeing 'typeset' output without kerning.  It would be desirable when 
> copying graphs by e.g. dev.copy2eps from devices that do not kern.
>
> C.  Insert kerning corrections by splitting up strings, so e.g. 'You' is set 
> as (Y)-140 kc(ou): this is what TeX engines do.
>
> D.  Compute the position of each letter in the string and place them 
> individually.
>
> C and D would give visually identical output when the font used is exactly as 
> specified, and hopefully also when a substitute font is using with the same 
> glyph widths (as substituting Nimbus Sans for Helvetica, at least for some 
> versions of each), but where the substitute is a poor match, C ought to look 
> more elegant but line up less well.  D would produce much larger files than 
> C.
>
> We do have the option of not changing the output when there is no kerning. 
> That would be by far the most common case except that some fonts (including 
> Helvetica but not Nimbus Sans) kern between punctuation and a space, e.g. ', 
> '.  I'm inclined to believe that most uses of ',' in R graphical output are 
> not punctuation (certainly true of R's own examples), and also that we 
> nowadays do not expect to see kerning involving spaces.
>
> Ei-ji Nakama provided an implementation of C for pdf() and D for postscript() 
> (thanks Ei-ji, and apologies that we did not have a chance to discuss the 
> principles first).  I'm inclined to suggest that we should go forwards with 
> at most two of these alternatives, and those two should be the same for 
> postscript() and pdf() -- my own inclination is to B and C.
>
> So questions:
>
> 1) Do people feel strongly that we should preserve graphical output from past 
> versions of R, even when there are known bugs?  I can see the need to 
> reproduce published figures, but normally this would also need using the same 
> version of R.
>
> 2) Is kerning worth pursuing?
>
> 3) If so, is elegant looking output more important than exact layout?
>
> 4) If we allow kerning, should it be the default (or only) option?
>
> To see that sometimes there can be a large effect, try in postscript() or 
> pdf()
>
> xx <- 'You You You You You You You You'
> plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
> abline(v=0)
> text(0, 0.5, xx, adj=0)
> abline(v=strwidth(xx))
> x2 <- strsplit(xx, "")
> w <- sapply(x2, strwidth)
> abline(v=sum(w))
>
> The leftmost of the right pair of lines is the computed width, the rightmost 
> the (normal) displayed width.
>
> Unless there are cogent reasons to bring this forward to 2.8.1, any changes 
> would be as from 2.9.0.
>
> Brian Ripley
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ken.knoblauch at inserm.fr  Thu Oct 16 16:34:30 2008
From: ken.knoblauch at inserm.fr (Kenneth Knoblauch)
Date: Thu, 16 Oct 2008 16:34:30 +0200
Subject: [Rd] packages in Depends field and NAMESPACES
Message-ID: <20081016163430.bud1wdul1c0osk8w@imp.inserm.fr>

Must packages in the Depends field of the DESCRIPTION file have
NAMESPACES?  I haven't seen this explicitly indicated anywhere.

I am writing a small package and find that when I add the abind
package to the list of the Depends field, I get an error in
R CMD check of the build.

* checking package name space information ... OK
* checking package dependencies ... ERROR
Packages required but not available:
   abind

See the information on DESCRIPTION files in the chapter 'Creating R
packages' of the 'Writing R Extensions' manual.

The abind package is installed, my package installs, builds and loads
correctly and, in general, works, even the function that uses abind.
I haven't been able to spot an error from reading the 'Writing R  
Extensions' manual, yet.  About the only thing that I have noticed  
that is different
in this package from the others in the Depends list is that it doesn't
have a NAMESPACE.

Here is my sessionInfo:

R version 2.7.2 Patched (2008-09-02 r46491)
i386-apple-darwin8.11.1

locale:
en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] CorticalGraph_0.1-2  abind_1.1-0          geometry_0.1-4
[4] rgl_0.81             scatterplot3d_0.3-27 gridBase_0.4-3

loaded via a namespace (and not attached):
[1] tools_2.7.2

Any suggestions would be appreciated.  Thank you.

Ken

-- 
Ken Knoblauch
Inserm U846
Institut Cellule Souche et Cerveau
D?partement Neurosciences Int?gratives
18 avenue du Doyen L?pine
69500 Bron
France
tel: +33 (0)4 72 91 34 77
fax: +33 (0)4 72 91 34 61
portable: +33 (0)6 84 10 64 10
http://www.sbri.fr


From Greg.Snow at imail.org  Thu Oct 16 17:56:25 2008
From: Greg.Snow at imail.org (Greg Snow)
Date: Thu, 16 Oct 2008 09:56:25 -0600
Subject: [Rd] RFC: Kerning, postscript() and pdf()
In-Reply-To: <alpine.LFD.2.00.0810161002040.13524@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
	<alpine.LFD.2.00.0810161002040.13524@gannet.stats.ox.ac.uk>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC61589D7B38@LP-EXMBVS10.CO.IHC.COM>

Prof. Ripley,

I am sure I speak for many others when I say Thank You for this and all the other great work that you do.  R is already capable of producing high quality graphics, this will just make them better.  Kerning is one of those things that generally don't get noticed unless done wrong/poorly, so I expect in the future people will look at their graphs and know that they look great, but not understand why, or the work that you put into giving them that extra quality.  So I just wanted to take this chance to say thank you (I/we probably don't say it enough).

Also Thank You to the rest of R core for all the great work.

R: Come for the price, Stay for the Quality

--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of Prof Brian Ripley
> Sent: Thursday, October 16, 2008 3:03 AM
> To: R-devel at r-project.org
> Subject: Re: [Rd] RFC: Kerning, postscript() and pdf()
>
> I've now implemented B and C in R-devel, with C as the default.
>
> On Sun, 12 Oct 2008, Prof Brian Ripley wrote:
>
> > Ei-ji Nakama has pointed out (from another Japanese user, I believe)
> that
> > postscript() and pdf() have not been handling kerning correctly, and
> this is
> > a request for opinions about how we should correct it.
> >
> > Kerning is the adjustment of the spacing between letters from their
> natural
> > width, so that for example 'Yo' is usually typeset with the o closer
> to the Y
> > than 'Yl' would be.  Kerning is not very well standardized, so that
> for
> > example R's default Helvetica and its URW clone (Nimbus Sans) have
> quite
> > different ideas of the amount of kerning corrections for 'Yo'. This
> matters,
> > because not many people actually see Helvetica when viewing R's
> PostScript or
> > PDF output, but rather a similar face like Nimbus Sans or Arial, or
> in the
> > case of Acrobat Reader, a not very similar face.  Kerning is only a
> feature
> > of some proportionally spaced fonts and so not of Courier nor CJK
> fonts.
> >
> > The current position (R <= 2.8.0) is that string widths have been
> computing
> > using kerning from the Adobe Font Metric files for the nominal font,
> but the
> > strings have been displayed without using kerning (at least in the
> viewers we
> > are aware of, and the PostScript and PDF reference manuals mandate
> that
> > behaviour, if rather obscurely).  This means that in strings such as
> 'You',
> > the width used in the string placement differs from that actually
> displayed.
> >
> > For postscript(), this doesn't have much impact, as centring or right
> > justification ('hadj' in text()) is done by PostScript code and
> computes the
> > width from the actual font used (and so copes well with font
> substitution).
> > It might affect the fine layout in plotmath, but using strings which
> would be
> > kerned in annotations is not common.
> >
> > For pdf() the effect is more commonly seen, as all text is set
> > left-justified, and the computed width is used to centre/right-
> justify.
> >
> > There are several things we could do:
> >
> > A.  Do nothing, for back compatibility.  After all, this has been
> going on
> > for years and no one has complained until last month.
> >
> > B.  Ignore kerning, and hence change the string width computations to
> match
> > the current display.  This is more attractive than it appears at
> first sight
> > -- as far as I know all other devices ignore kerning, and we are
> increasingly
> > used to seeing 'typeset' output without kerning.  It would be
> desirable when
> > copying graphs by e.g. dev.copy2eps from devices that do not kern.
> >
> > C.  Insert kerning corrections by splitting up strings, so e.g. 'You'
> is set
> > as (Y)-140 kc(ou): this is what TeX engines do.
> >
> > D.  Compute the position of each letter in the string and place them
> > individually.
> >
> > C and D would give visually identical output when the font used is
> exactly as
> > specified, and hopefully also when a substitute font is using with
> the same
> > glyph widths (as substituting Nimbus Sans for Helvetica, at least for
> some
> > versions of each), but where the substitute is a poor match, C ought
> to look
> > more elegant but line up less well.  D would produce much larger
> files than
> > C.
> >
> > We do have the option of not changing the output when there is no
> kerning.
> > That would be by far the most common case except that some fonts
> (including
> > Helvetica but not Nimbus Sans) kern between punctuation and a space,
> e.g. ',
> > '.  I'm inclined to believe that most uses of ',' in R graphical
> output are
> > not punctuation (certainly true of R's own examples), and also that
> we
> > nowadays do not expect to see kerning involving spaces.
> >
> > Ei-ji Nakama provided an implementation of C for pdf() and D for
> postscript()
> > (thanks Ei-ji, and apologies that we did not have a chance to discuss
> the
> > principles first).  I'm inclined to suggest that we should go
> forwards with
> > at most two of these alternatives, and those two should be the same
> for
> > postscript() and pdf() -- my own inclination is to B and C.
> >
> > So questions:
> >
> > 1) Do people feel strongly that we should preserve graphical output
> from past
> > versions of R, even when there are known bugs?  I can see the need to
> > reproduce published figures, but normally this would also need using
> the same
> > version of R.
> >
> > 2) Is kerning worth pursuing?
> >
> > 3) If so, is elegant looking output more important than exact layout?
> >
> > 4) If we allow kerning, should it be the default (or only) option?
> >
> > To see that sometimes there can be a large effect, try in
> postscript() or
> > pdf()
> >
> > xx <- 'You You You You You You You You'
> > plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
> > abline(v=0)
> > text(0, 0.5, xx, adj=0)
> > abline(v=strwidth(xx))
> > x2 <- strsplit(xx, "")
> > w <- sapply(x2, strwidth)
> > abline(v=sum(w))
> >
> > The leftmost of the right pair of lines is the computed width, the
> rightmost
> > the (normal) displayed width.
> >
> > Unless there are cogent reasons to bring this forward to 2.8.1, any
> changes
> > would be as from 2.9.0.
> >
> > Brian Ripley
> >
> > --
> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272866 (PA)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Thu Oct 16 18:08:31 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Oct 2008 17:08:31 +0100 (BST)
Subject: [Rd] packages in Depends field and NAMESPACES
In-Reply-To: <20081016163430.bud1wdul1c0osk8w@imp.inserm.fr>
References: <20081016163430.bud1wdul1c0osk8w@imp.inserm.fr>
Message-ID: <alpine.LFD.2.00.0810161705560.20637@gannet.stats.ox.ac.uk>

On Thu, 16 Oct 2008, Kenneth Knoblauch wrote:

> Must packages in the Depends field of the DESCRIPTION file have
> NAMESPACES?  I haven't seen this explicitly indicated anywhere.

No such requirememt.

>
> I am writing a small package and find that when I add the abind
> package to the list of the Depends field, I get an error in
> R CMD check of the build.
>
> * checking package name space information ... OK
> * checking package dependencies ... ERROR
> Packages required but not available:
> abind

I expect it is in a non-default library tree. From 'Writing R Extensions'

     Note: R CMD check and R CMD build run R with --vanilla, so none of the
     user's startup files are read. If you need R_LIBS set (to find
     packages in a non-standard library) you will need to set it in the
     environment.



> See the information on DESCRIPTION files in the chapter 'Creating R
> packages' of the 'Writing R Extensions' manual.
>
> The abind package is installed, my package installs, builds and loads
> correctly and, in general, works, even the function that uses abind.
> I haven't been able to spot an error from reading the 'Writing R Extensions' 
> manual, yet.  About the only thing that I have noticed that is different
> in this package from the others in the Depends list is that it doesn't
> have a NAMESPACE.
>
> Here is my sessionInfo:
>
> R version 2.7.2 Patched (2008-09-02 r46491)
> i386-apple-darwin8.11.1
>
> locale:
> en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] CorticalGraph_0.1-2  abind_1.1-0          geometry_0.1-4
> [4] rgl_0.81             scatterplot3d_0.3-27 gridBase_0.4-3
>
> loaded via a namespace (and not attached):
> [1] tools_2.7.2
>
> Any suggestions would be appreciated.  Thank you.
>
> Ken
>
> -- 
> Ken Knoblauch
> Inserm U846
> Institut Cellule Souche et Cerveau
> D?partement Neurosciences Int?gratives
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> http://www.sbri.fr
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hb at stat.berkeley.edu  Thu Oct 16 21:51:40 2008
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 16 Oct 2008 12:51:40 -0700
Subject: [Rd] as.list() for function:s
Message-ID: <59d7961d0810161251rc42cb42w3f4dd62bcf82010e@mail.gmail.com>

Hi, a quick comment.  I just notice that as.list() deals with
function:s the old way inside the "default" function, cf.

> as.list.default
function (x, ...)
{
    if (typeof(x) == "list")
        return(x)
    if (is.function(x))
        return(c(formals(x), list(body(x))))
    .Internal(as.vector(x, "list"))
}
<environment: namespace:base>

The following should do the same thing cleaner (and faster?):

as.list.function <- function(x, ...)
{
    c(formals(x), list(body(x)))
}

as.list.default <- function (x, ...)
{
    if (typeof(x) == "list")
        return(x)
    .Internal(as.vector(x, "list"))
}

/Henrik


From diggsb at ohsu.edu  Thu Oct 16 18:45:13 2008
From: diggsb at ohsu.edu (diggsb at ohsu.edu)
Date: Thu, 16 Oct 2008 18:45:13 +0200 (CEST)
Subject: [Rd] Wrong behavior of lines.survfit for conf.int="only" (PR#13171)
Message-ID: <20081016164513.62245282EF48@mail.pubhealth.ku.dk>

Full_Name: Brian Diggs
Version: 2.7.2 (2008-08-25)
OS: mingw32 (Windows XP Professional)
Submission from: (NULL) (137.53.146.55)


Description of problem:
The documentation of lines.survfit states that if it is called with
conf.int="only" that the confidence intervals of the survival curve will be
drawn but that the survival curve itself will not. Actual behavior is that both
the confidence intervals and the survival curve are drawn, the same as if
conf.int=TRUE.

Steps to reproduce the problem:
library(survival)
data(cancer)
km <- survfit(Surv(time,status), data=cancer)
plot(km, col=0) #lines drawn in background color, needed to set up the axes
lines(km,conf.int="only") #should draw only the confidence intervals, does draw
both

R version:
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          7.2                         
year           2008                        
month          08                          
day            25                          
svn rev        46428                       
language       R                           
version.string R version 2.7.2 (2008-08-25)

survival package version:
Version:       2.34-1
Date:          2008-03-31
Packaged:      Wed Apr 2 09:02:54 2008; hornik
Built:         R 2.7.2; i386-pc-mingw32; 2008-08-25 14:57:42; windows

system:
Microsoft Windows XP
Professional
Version 2002
Service Pack 3


From tcallawa at redhat.com  Thu Oct 16 22:38:15 2008
From: tcallawa at redhat.com (Tom "spot" Callaway)
Date: Thu, 16 Oct 2008 16:38:15 -0400
Subject: [Rd] Configure error when compiling on "sh" architecture
Message-ID: <1224189495.8216.6.camel@localhost.localdomain>

Amusingly enough, the SuperH (or sh for short) architecture isn't one of
the many I have handy, but someone seems to be porting Fedora to that
arch. They filed a bug against R, which isn't really an R bug, but is
more an inherited bug from autoconf. Specifically, the R configure
script invokes gcc(gfortran) which then passes "-little" to gas when
compiling for backward compatibility. This fails on sh, and they
proposed that it be added to the list of "flags to ignore" in configure.

See:
https://bugzilla.redhat.com/show_bug.cgi?id=464055
https://bugzilla.redhat.com/show_bug.cgi?id=456886

I've attached the same patch that is in 464055 to this email. Hopefully,
at some point before the sun explodes, that fix will end up in autoconf,
and upstreams will pick it up when they run the fixed autoconf on their
tree.

Thanks,

~tom
-------------- next part --------------
A non-text attachment was scrubbed...
Name: R-2.7.2-filter_asoption.patch
Type: text/x-patch
Size: 505 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081016/3a7457f5/attachment.bin>

From p.dalgaard at biostat.ku.dk  Fri Oct 17 00:21:32 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 17 Oct 2008 00:21:32 +0200
Subject: [Rd] Configure error when compiling on "sh" architecture
In-Reply-To: <1224189495.8216.6.camel@localhost.localdomain>
References: <1224189495.8216.6.camel@localhost.localdomain>
Message-ID: <48F7BE6C.6000300@biostat.ku.dk>

Tom "spot" Callaway wrote:
> Amusingly enough, the SuperH (or sh for short) architecture isn't one
> of the many I have handy, but someone seems to be porting Fedora to
> that arch. They filed a bug against R, which isn't really an R bug,
> but is more an inherited bug from autoconf. Specifically, the R
> configure script invokes gcc(gfortran) which then passes "-little" to
> gas when compiling for backward compatibility. This fails on sh, and
> they proposed that it be added to the list of "flags to ignore" in
> configure.
> 
> See: https://bugzilla.redhat.com/show_bug.cgi?id=464055 
> https://bugzilla.redhat.com/show_bug.cgi?id=456886
> 
> I've attached the same patch that is in 464055 to this email.
> Hopefully, at some point before the sun explodes, that fix will end
> up in autoconf, and upstreams will pick it up when they run the fixed
> autoconf on their tree.

Right. Until then, I think it needs to be fixed downstreams.

We can't fix configure upstreams because it gets rebuilt by autoconf all 
the time during our build procedures.

I suppose that we _could_ override /usr/share/auto 
conf/autoconf/fortran.m4 with a file of our own, but it
sounds like Bad Luck...

Anyways, as you probably know, we're deep in code freeze for 2.8.0 on 
Monday.

-p


> 
> Thanks,
> 
> ~tom
> 
> 
> ------------------------------------------------------------------------
> 
> 
> ______________________________________________ R-devel at r-project.org
> mailing list https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From edd at debian.org  Fri Oct 17 03:45:40 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 16 Oct 2008 20:45:40 -0500
Subject: [Rd] Minor feature request: Let 'R CMD co*nfig' tell me where the
	INCLDIR is
Message-ID: <18679.60996.613377.262315@ron.nulle.part>


On Debian / Ubuntu / ... we have [1] 

	edd at ron:~> R CMD config --cppflags
	-I/usr/share/R/include
	edd at ron:~>   

but I seem to have no way to learn 'just' the /usr/share/R/include part from
R CMD config.  It would be nice if something like

	R CMD config R_INCL_DIR 

could be added as we do have 'LIBnn'. Obviously, this is nothing we need now
before 2.8.0.  But if it could get added to R-devel, I'd appreciate it.  

[ The context is that 'R CMD INSTALL' does fewer things than a few of us
desired (as per a thread a few months ago) but seemingly nobody with the
magic powers to change this feels the same way. ]

Dirk

[1] Old and boring story of show 'arch-independent' files like headers ended
up in /usr/share omitted here.

-- 
Three out of two people have difficulties with fractions.


From logickledoug at yahoo.com  Fri Oct 17 05:22:51 2008
From: logickledoug at yahoo.com (Logickle)
Date: Thu, 16 Oct 2008 20:22:51 -0700 (PDT)
Subject: [Rd]  Excessive query time running R-RODBC against SQL Server
Message-ID: <20026479.post@talk.nabble.com>


Hi, all. I'm using RODBC to query a SQL Server 2005 database, and am
experiencing terribly slow performance. I assume I'm doing something wrong,
but I'm not doing anything fancy, so I'm stumped. 

My setup:

Core 2 Duo 2GHz, Win XP, 2GB RAM
R 2.7.1
RODBC (latest from CRAN, not sure the version - how to tell?)
SQL Server 2005
MS Access 2003
SQL Native Client ODBC driver (DSN = "HIM")
SQL Server ODBC driver (DSN = "HIMs")
MS Access ODBC driver (DSN = "HIMa")

Table (T304) being queried has ~290K rows, of which the query being run
should return ~78K.
Table being queried has 142 columns, of which all but 5 are type float. The
other 5 are nvarchar(255)
No indices or keys - one flat table
No UPDATEs, INSERTs, just SELECT

R code looks like this:

him <- odbcConnect("HIM", "CDCS", "") 
FAC <- sqlQuery(him, "Select * from T304 where f133=1")

If the DSN used points to SQL Server, the query seems to hang, though I
could see in Task Manager that the R process grows, and uses most of one
CPU. I killed R after 5 minutes of waiting. (If I use sqlFetch() instead and
specify max records as 1000, this does return but only after 1-2 minutes.)

In SQL Server itself, the same query completes after ~6 seconds.

The same data resides in an Access database, from which it was imported into
SQL Server 2005 in fact. If I use the Access DSN in my R code above, the
query takes 12-15s. 

How could a query against SQL Server be *so* much slower than against
Access, or than SQL Server by itself?

Thanks,

Doug 


-- 
View this message in context: http://www.nabble.com/Excessive-query-time-running-R-RODBC-against-SQL-Server-tp20026479p20026479.html
Sent from the R devel mailing list archive at Nabble.com.


From maechler at stat.math.ethz.ch  Fri Oct 17 10:09:42 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 17 Oct 2008 10:09:42 +0200
Subject: [Rd] Minor feature request: Let 'R CMD co*nfig' tell me where
	the INCLDIR is
In-Reply-To: <18679.60996.613377.262315@ron.nulle.part>
References: <18679.60996.613377.262315@ron.nulle.part>
Message-ID: <18680.18502.451999.351281@stat.math.ethz.ch>

>>>>> "DE" == Dirk Eddelbuettel <edd at debian.org>
>>>>>     on Thu, 16 Oct 2008 20:45:40 -0500 writes:

    DE> On Debian / Ubuntu / ... we have [1] 

    DE> edd at ron:~> R CMD config --cppflags
    DE> -I/usr/share/R/include
    DE> edd at ron:~>   

Actually, on Ubuntu 8.04 (64-bit) I get

  MM at deb2:~$ /usr/bin/R CMD config --cppflags
  -I/usr/share/R/include -I/usr/share/R/include

which has the -I<..> doubled, a slight infelicity ... 
Wonder how this came about.

  MM at deb2:~$ uname -a
  Linux deb2 2.6.24-19-generic #1 SMP Wed Jun 4 15:10:52 UTC 2008 x86_64 GNU/Linux

This is - almost surely - the r-base-core package from CRAN.

    DE> but I seem to have no way to learn 'just' the /usr/share/R/include part from
    DE> R CMD config.  It would be nice if something like

    DE> R CMD config R_INCL_DIR 

    DE> could be added as we do have 'LIBnn'. Obviously, this is nothing we need now
    DE> before 2.8.0.  But if it could get added to R-devel, I'd appreciate it.  

    DE> [ The context is that 'R CMD INSTALL' does fewer things than a few of us
    DE> desired (as per a thread a few months ago) but seemingly nobody with the
    DE> magic powers to change this feels the same way. ]

or has had time for it, at the time?
Did you get reactions from R-core at all?

Regards,
Martin

    DE> Dirk

    DE> [1] Old and boring story of show 'arch-independent' files like headers ended
    DE> up in /usr/share omitted here.


From czucz at botanika.hu  Fri Oct 17 10:32:16 2008
From: czucz at botanika.hu (=?ISO-8859-1?Q?B=E1lint_Cz=FAcz?=)
Date: Fri, 17 Oct 2008 10:32:16 +0200
Subject: [Rd] RFC: Kerning, postscript() and pdf()
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC61589D7B38@LP-EXMBVS10.CO.IHC.COM>
References: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
	<alpine.LFD.2.00.0810161002040.13524@gannet.stats.ox.ac.uk>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC61589D7B38@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <fab4bcf70810170132v3ed86e8atfb5e81a42cf3b7ce@mail.gmail.com>

Dear Prof Ripley,

FWIW, kerning problems seem to affect even European character sets, e.g.:

> pdf(); plot(0,main="?rv?zt?r? t?k?rf?r?g?p"); dev.off()

in a clean session produces some misaligned characters in the
resulting Rplots.pdf. [--> note the misplacements after the characters
? and ? (Hungarian long umlaut): intToUtf8(c(337L,369L)) ]

Otherwise I completely concur with Greg Snow, huge Thank You for
keeping on improving the marvellous capabilities of R!

Best regrads,
B?lint

--
> sessionInfo()
R version 2.6.2 (2008-02-08)
i386-pc-mingw32

locale:
LC_COLLATE=Hungarian_Hungary.1250;LC_CTYPE=Hungarian_Hungary.1250;LC_MONETARY=Hungarian_Hungary.1250;LC_NUMERIC=C;LC_TIME=Hungarian_Hungary.1250

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

[* sorry for not using the most recent R version, I hope this is still
helpful -- otherwise please ignore my comment...]

-- 
B?lint Cz?cz
Institute of Ecology and Botany of the Hungarian Academy of Sciences
H-2163 V?cr?t?t, Alkotm?ny u. 2-4. HUNGARY
Tel: +36 28 360122/157  +36 70 7034692


On Thu, Oct 16, 2008 at 5:56 PM, Greg Snow <Greg.Snow at imail.org> wrote:
> Prof. Ripley,
>
> I am sure I speak for many others when I say Thank You for this and all the other great work that you do.  R is already capable of producing high quality graphics, this will just make them better.  Kerning is one of those things that generally don't get noticed unless done wrong/poorly, so I expect in the future people will look at their graphs and know that they look great, but not understand why, or the work that you put into giving them that extra quality.  So I just wanted to take this chance to say thank you (I/we probably don't say it enough).
>
> Also Thank You to the rest of R core for all the great work.
>
> R: Come for the price, Stay for the Quality
>
> --
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
>
>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>> project.org] On Behalf Of Prof Brian Ripley
>> Sent: Thursday, October 16, 2008 3:03 AM
>> To: R-devel at r-project.org
>> Subject: Re: [Rd] RFC: Kerning, postscript() and pdf()
>>
>> I've now implemented B and C in R-devel, with C as the default.
>>
>> On Sun, 12 Oct 2008, Prof Brian Ripley wrote:
>>
>> > Ei-ji Nakama has pointed out (from another Japanese user, I believe)
>> that
>> > postscript() and pdf() have not been handling kerning correctly, and
>> this is
>> > a request for opinions about how we should correct it.
>> >
>> > Kerning is the adjustment of the spacing between letters from their
>> natural
>> > width, so that for example 'Yo' is usually typeset with the o closer
>> to the Y
>> > than 'Yl' would be.  Kerning is not very well standardized, so that
>> for
>> > example R's default Helvetica and its URW clone (Nimbus Sans) have
>> quite
>> > different ideas of the amount of kerning corrections for 'Yo'. This
>> matters,
>> > because not many people actually see Helvetica when viewing R's
>> PostScript or
>> > PDF output, but rather a similar face like Nimbus Sans or Arial, or
>> in the
>> > case of Acrobat Reader, a not very similar face.  Kerning is only a
>> feature
>> > of some proportionally spaced fonts and so not of Courier nor CJK
>> fonts.
>> >
>> > The current position (R <= 2.8.0) is that string widths have been
>> computing
>> > using kerning from the Adobe Font Metric files for the nominal font,
>> but the
>> > strings have been displayed without using kerning (at least in the
>> viewers we
>> > are aware of, and the PostScript and PDF reference manuals mandate
>> that
>> > behaviour, if rather obscurely).  This means that in strings such as
>> 'You',
>> > the width used in the string placement differs from that actually
>> displayed.
>> >
>> > For postscript(), this doesn't have much impact, as centring or right
>> > justification ('hadj' in text()) is done by PostScript code and
>> computes the
>> > width from the actual font used (and so copes well with font
>> substitution).
>> > It might affect the fine layout in plotmath, but using strings which
>> would be
>> > kerned in annotations is not common.
>> >
>> > For pdf() the effect is more commonly seen, as all text is set
>> > left-justified, and the computed width is used to centre/right-
>> justify.
>> >
>> > There are several things we could do:
>> >
>> > A.  Do nothing, for back compatibility.  After all, this has been
>> going on
>> > for years and no one has complained until last month.
>> >
>> > B.  Ignore kerning, and hence change the string width computations to
>> match
>> > the current display.  This is more attractive than it appears at
>> first sight
>> > -- as far as I know all other devices ignore kerning, and we are
>> increasingly
>> > used to seeing 'typeset' output without kerning.  It would be
>> desirable when
>> > copying graphs by e.g. dev.copy2eps from devices that do not kern.
>> >
>> > C.  Insert kerning corrections by splitting up strings, so e.g. 'You'
>> is set
>> > as (Y)-140 kc(ou): this is what TeX engines do.
>> >
>> > D.  Compute the position of each letter in the string and place them
>> > individually.
>> >
>> > C and D would give visually identical output when the font used is
>> exactly as
>> > specified, and hopefully also when a substitute font is using with
>> the same
>> > glyph widths (as substituting Nimbus Sans for Helvetica, at least for
>> some
>> > versions of each), but where the substitute is a poor match, C ought
>> to look
>> > more elegant but line up less well.  D would produce much larger
>> files than
>> > C.
>> >
>> > We do have the option of not changing the output when there is no
>> kerning.
>> > That would be by far the most common case except that some fonts
>> (including
>> > Helvetica but not Nimbus Sans) kern between punctuation and a space,
>> e.g. ',
>> > '.  I'm inclined to believe that most uses of ',' in R graphical
>> output are
>> > not punctuation (certainly true of R's own examples), and also that
>> we
>> > nowadays do not expect to see kerning involving spaces.
>> >
>> > Ei-ji Nakama provided an implementation of C for pdf() and D for
>> postscript()
>> > (thanks Ei-ji, and apologies that we did not have a chance to discuss
>> the
>> > principles first).  I'm inclined to suggest that we should go
>> forwards with
>> > at most two of these alternatives, and those two should be the same
>> for
>> > postscript() and pdf() -- my own inclination is to B and C.
>> >
>> > So questions:
>> >
>> > 1) Do people feel strongly that we should preserve graphical output
>> from past
>> > versions of R, even when there are known bugs?  I can see the need to
>> > reproduce published figures, but normally this would also need using
>> the same
>> > version of R.
>> >
>> > 2) Is kerning worth pursuing?
>> >
>> > 3) If so, is elegant looking output more important than exact layout?
>> >
>> > 4) If we allow kerning, should it be the default (or only) option?
>> >
>> > To see that sometimes there can be a large effect, try in
>> postscript() or
>> > pdf()
>> >
>> > xx <- 'You You You You You You You You'
>> > plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
>> > abline(v=0)
>> > text(0, 0.5, xx, adj=0)
>> > abline(v=strwidth(xx))
>> > x2 <- strsplit(xx, "")
>> > w <- sapply(x2, strwidth)
>> > abline(v=sum(w))
>> >
>> > The leftmost of the right pair of lines is the computed width, the
>> rightmost
>> > the (normal) displayed width.
>> >
>> > Unless there are cogent reasons to bring this forward to 2.8.1, any
>> changes
>> > would be as from 2.9.0.
>> >
>> > Brian Ripley
>> >
>> > --
>> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> > University of Oxford,             Tel:  +44 1865 272861 (self)
>> > 1 South Parks Road,                     +44 1865 272866 (PA)
>> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>> >
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From maechler at stat.math.ethz.ch  Fri Oct 17 11:27:51 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 17 Oct 2008 11:27:51 +0200
Subject: [Rd] as.list() for function:s
In-Reply-To: <59d7961d0810161251rc42cb42w3f4dd62bcf82010e@mail.gmail.com>
References: <59d7961d0810161251rc42cb42w3f4dd62bcf82010e@mail.gmail.com>
Message-ID: <18680.23191.369921.592687@stat.math.ethz.ch>

>>>>> "HenrikB" == Henrik Bengtsson <hb at stat.berkeley.edu>
>>>>>     on Thu, 16 Oct 2008 12:51:40 -0700 writes:

    HenrikB> Hi, a quick comment.  I just notice that as.list() deals with
    HenrikB> function:s the old way inside the "default" function, cf.

    >> as.list.default
    HenrikB> function (x, ...)
    HenrikB> {
    HenrikB> if (typeof(x) == "list")
    HenrikB> return(x)
    HenrikB> if (is.function(x))
    HenrikB> return(c(formals(x), list(body(x))))
    HenrikB> .Internal(as.vector(x, "list"))
    HenrikB> }
    HenrikB> <environment: namespace:base>

    HenrikB> The following should do the same thing cleaner (and faster?):

    HenrikB> as.list.function <- function(x, ...)
    HenrikB> {
    HenrikB> c(formals(x), list(body(x)))
    HenrikB> }

    HenrikB> as.list.default <- function (x, ...)
    HenrikB> {
    HenrikB> if (typeof(x) == "list")
    HenrikB> return(x)
    HenrikB> .Internal(as.vector(x, "list"))
    HenrikB> }

I don't think it will be faster, but definitely cleaner.
I've implemented (a version of) it for R-devel.

Martin


From ligges at statistik.tu-dortmund.de  Fri Oct 17 11:33:45 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 17 Oct 2008 11:33:45 +0200
Subject: [Rd] IFCS 2009; deadline: November 3, 2008
Message-ID: <48F85BF9.8040804@statistik.tu-dortmund.de>

Hi [and apologies for misusing the list for some statistical software 
related conference ads],


The IFCS 2009 (International Federation of Classification Societies) 
Conference takes place in Dresden Germany: March 13-18, 2009.

The conference and in particular its section on `Data Analysis Software' 
may be of interest to those R useRs and developeRs who are working in 
the area of clustering, classification, and related data analysis tasks.

Submission deadline for abstract is November 3, 2008

More details: http://www.ifcs2009.de/

Best wishes,
Uwe Ligges


From mark_difford at yahoo.co.uk  Fri Oct 17 13:38:43 2008
From: mark_difford at yahoo.co.uk (Mark Difford)
Date: Fri, 17 Oct 2008 04:38:43 -0700 (PDT)
Subject: [Rd] RFC: Kerning, postscript() and pdf()
In-Reply-To: <fab4bcf70810170132v3ed86e8atfb5e81a42cf3b7ce@mail.gmail.com>
References: <alpine.LFD.2.00.0810121544300.6167@gannet.stats.ox.ac.uk>
	<alpine.LFD.2.00.0810161002040.13524@gannet.stats.ox.ac.uk>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC61589D7B38@LP-EXMBVS10.CO.IHC.COM>
	<fab4bcf70810170132v3ed86e8atfb5e81a42cf3b7ce@mail.gmail.com>
Message-ID: <20031674.post@talk.nabble.com>


.... A huge thank you from me, too. Greg has said what should be said.

Every day I look at my PS and PDF output, think through the chain of effort
involved, from building the blocks to the packages that coordinate them, and
say WOW! R graphics just got better, with some fine decision making.

Regards, Mark.


B?lint Cz?cz-4 wrote:
> 
> Dear Prof Ripley,
> 
> FWIW, kerning problems seem to affect even European character sets, e.g.:
> 
>> pdf(); plot(0,main="?rv?zt?r? t?k?rf?r?g?p"); dev.off()
> 
> in a clean session produces some misaligned characters in the
> resulting Rplots.pdf. [--> note the misplacements after the characters
> ? and ? (Hungarian long umlaut): intToUtf8(c(337L,369L)) ]
> 
> Otherwise I completely concur with Greg Snow, huge Thank You for
> keeping on improving the marvellous capabilities of R!
> 
> Best regrads,
> B?lint
> 
> --
>> sessionInfo()
> R version 2.6.2 (2008-02-08)
> i386-pc-mingw32
> 
> locale:
> LC_COLLATE=Hungarian_Hungary.1250;LC_CTYPE=Hungarian_Hungary.1250;LC_MONETARY=Hungarian_Hungary.1250;LC_NUMERIC=C;LC_TIME=Hungarian_Hungary.1250
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> [* sorry for not using the most recent R version, I hope this is still
> helpful -- otherwise please ignore my comment...]
> 
> -- 
> B?lint Cz?cz
> Institute of Ecology and Botany of the Hungarian Academy of Sciences
> H-2163 V?cr?t?t, Alkotm?ny u. 2-4. HUNGARY
> Tel: +36 28 360122/157  +36 70 7034692
> 
> 
> On Thu, Oct 16, 2008 at 5:56 PM, Greg Snow <Greg.Snow at imail.org> wrote:
>> Prof. Ripley,
>>
>> I am sure I speak for many others when I say Thank You for this and all
>> the other great work that you do.  R is already capable of producing high
>> quality graphics, this will just make them better.  Kerning is one of
>> those things that generally don't get noticed unless done wrong/poorly,
>> so I expect in the future people will look at their graphs and know that
>> they look great, but not understand why, or the work that you put into
>> giving them that extra quality.  So I just wanted to take this chance to
>> say thank you (I/we probably don't say it enough).
>>
>> Also Thank You to the rest of R core for all the great work.
>>
>> R: Come for the price, Stay for the Quality
>>
>> --
>> Gregory (Greg) L. Snow Ph.D.
>> Statistical Data Center
>> Intermountain Healthcare
>> greg.snow at imail.org
>> 801.408.8111
>>
>>
>>> -----Original Message-----
>>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>>> project.org] On Behalf Of Prof Brian Ripley
>>> Sent: Thursday, October 16, 2008 3:03 AM
>>> To: R-devel at r-project.org
>>> Subject: Re: [Rd] RFC: Kerning, postscript() and pdf()
>>>
>>> I've now implemented B and C in R-devel, with C as the default.
>>>
>>> On Sun, 12 Oct 2008, Prof Brian Ripley wrote:
>>>
>>> > Ei-ji Nakama has pointed out (from another Japanese user, I believe)
>>> that
>>> > postscript() and pdf() have not been handling kerning correctly, and
>>> this is
>>> > a request for opinions about how we should correct it.
>>> >
>>> > Kerning is the adjustment of the spacing between letters from their
>>> natural
>>> > width, so that for example 'Yo' is usually typeset with the o closer
>>> to the Y
>>> > than 'Yl' would be.  Kerning is not very well standardized, so that
>>> for
>>> > example R's default Helvetica and its URW clone (Nimbus Sans) have
>>> quite
>>> > different ideas of the amount of kerning corrections for 'Yo'. This
>>> matters,
>>> > because not many people actually see Helvetica when viewing R's
>>> PostScript or
>>> > PDF output, but rather a similar face like Nimbus Sans or Arial, or
>>> in the
>>> > case of Acrobat Reader, a not very similar face.  Kerning is only a
>>> feature
>>> > of some proportionally spaced fonts and so not of Courier nor CJK
>>> fonts.
>>> >
>>> > The current position (R <= 2.8.0) is that string widths have been
>>> computing
>>> > using kerning from the Adobe Font Metric files for the nominal font,
>>> but the
>>> > strings have been displayed without using kerning (at least in the
>>> viewers we
>>> > are aware of, and the PostScript and PDF reference manuals mandate
>>> that
>>> > behaviour, if rather obscurely).  This means that in strings such as
>>> 'You',
>>> > the width used in the string placement differs from that actually
>>> displayed.
>>> >
>>> > For postscript(), this doesn't have much impact, as centring or right
>>> > justification ('hadj' in text()) is done by PostScript code and
>>> computes the
>>> > width from the actual font used (and so copes well with font
>>> substitution).
>>> > It might affect the fine layout in plotmath, but using strings which
>>> would be
>>> > kerned in annotations is not common.
>>> >
>>> > For pdf() the effect is more commonly seen, as all text is set
>>> > left-justified, and the computed width is used to centre/right-
>>> justify.
>>> >
>>> > There are several things we could do:
>>> >
>>> > A.  Do nothing, for back compatibility.  After all, this has been
>>> going on
>>> > for years and no one has complained until last month.
>>> >
>>> > B.  Ignore kerning, and hence change the string width computations to
>>> match
>>> > the current display.  This is more attractive than it appears at
>>> first sight
>>> > -- as far as I know all other devices ignore kerning, and we are
>>> increasingly
>>> > used to seeing 'typeset' output without kerning.  It would be
>>> desirable when
>>> > copying graphs by e.g. dev.copy2eps from devices that do not kern.
>>> >
>>> > C.  Insert kerning corrections by splitting up strings, so e.g. 'You'
>>> is set
>>> > as (Y)-140 kc(ou): this is what TeX engines do.
>>> >
>>> > D.  Compute the position of each letter in the string and place them
>>> > individually.
>>> >
>>> > C and D would give visually identical output when the font used is
>>> exactly as
>>> > specified, and hopefully also when a substitute font is using with
>>> the same
>>> > glyph widths (as substituting Nimbus Sans for Helvetica, at least for
>>> some
>>> > versions of each), but where the substitute is a poor match, C ought
>>> to look
>>> > more elegant but line up less well.  D would produce much larger
>>> files than
>>> > C.
>>> >
>>> > We do have the option of not changing the output when there is no
>>> kerning.
>>> > That would be by far the most common case except that some fonts
>>> (including
>>> > Helvetica but not Nimbus Sans) kern between punctuation and a space,
>>> e.g. ',
>>> > '.  I'm inclined to believe that most uses of ',' in R graphical
>>> output are
>>> > not punctuation (certainly true of R's own examples), and also that
>>> we
>>> > nowadays do not expect to see kerning involving spaces.
>>> >
>>> > Ei-ji Nakama provided an implementation of C for pdf() and D for
>>> postscript()
>>> > (thanks Ei-ji, and apologies that we did not have a chance to discuss
>>> the
>>> > principles first).  I'm inclined to suggest that we should go
>>> forwards with
>>> > at most two of these alternatives, and those two should be the same
>>> for
>>> > postscript() and pdf() -- my own inclination is to B and C.
>>> >
>>> > So questions:
>>> >
>>> > 1) Do people feel strongly that we should preserve graphical output
>>> from past
>>> > versions of R, even when there are known bugs?  I can see the need to
>>> > reproduce published figures, but normally this would also need using
>>> the same
>>> > version of R.
>>> >
>>> > 2) Is kerning worth pursuing?
>>> >
>>> > 3) If so, is elegant looking output more important than exact layout?
>>> >
>>> > 4) If we allow kerning, should it be the default (or only) option?
>>> >
>>> > To see that sometimes there can be a large effect, try in
>>> postscript() or
>>> > pdf()
>>> >
>>> > xx <- 'You You You You You You You You'
>>> > plot(0,0,xlim=c(0,1),ylim=c(0,1),type='n')
>>> > abline(v=0)
>>> > text(0, 0.5, xx, adj=0)
>>> > abline(v=strwidth(xx))
>>> > x2 <- strsplit(xx, "")
>>> > w <- sapply(x2, strwidth)
>>> > abline(v=sum(w))
>>> >
>>> > The leftmost of the right pair of lines is the computed width, the
>>> rightmost
>>> > the (normal) displayed width.
>>> >
>>> > Unless there are cogent reasons to bring this forward to 2.8.1, any
>>> changes
>>> > would be as from 2.9.0.
>>> >
>>> > Brian Ripley
>>> >
>>> > --
>>> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> > University of Oxford,             Tel:  +44 1865 272861 (self)
>>> > 1 South Parks Road,                     +44 1865 272866 (PA)
>>> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>> >
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
View this message in context: http://www.nabble.com/RFC%3A-Kerning%2C-postscript%28%29-and-pdf%28%29-tp19942727p20031674.html
Sent from the R devel mailing list archive at Nabble.com.


From weigand.stephen at gmail.com  Sat Oct 18 01:19:31 2008
From: weigand.stephen at gmail.com (Stephen Weigand)
Date: Fri, 17 Oct 2008 18:19:31 -0500
Subject: [Rd] beta symbol cut off in y axis label using jpeg/png/tiff
Message-ID: <bc47d3330810171619h7123cd1du1cc0a573956f5f4d@mail.gmail.com>

I am having trouble showing the Greek symbol "beta" correctly
in the y-axis label of bitmap plots.

Specifically, on my system the top of the "beta" symbol is cut off
using the following example:

file.jpg <- paste(tempfile(), ".jpg", sep = "")

jpeg(file.jpg, h = 3, w = 3, units = "in", res = 300, type = "Xlib")
boxplot(rnorm(10), ylab = expression(beta))
dev.off()

I have the same problem with tiff() and png(). I don't have cairo
capabilities on this system.

On another system with cairo, if I use 'type = "cairo"' the jpeg is
correct. If I use 'type = "Xlib", I get this error:

Error in title(ylab = expression(beta)) :
  X11 font -adobe-helvetica-%s-%s-*-*-%d-*-*-*-*-*-*-*, face 5 at size
12 could not be loaded

My system information is below.
----------------------

platform       sparc-sun-solaris2.10
arch           sparc
os             solaris2.10
system         sparc, solaris2.10
status
major          2
minor          7.1
year           2008
month          06
day            23
svn rev        45970
language       R
version.string R version 2.7.1 (2008-06-23)

sessionInfo:

R version 2.7.1 (2008-06-23)
sparc-sun-solaris2.10

locale:
C

attached base packages:
[1] grDevices datasets  splines   graphics  utils     stats     methods
[8] base

Capabilities:
    jpeg      png    tcltk      X11     aqua
    TRUE     TRUE     TRUE     TRUE    FALSE
http/ftp  sockets   libxml     fifo   cledit
    TRUE     TRUE     TRUE     TRUE     TRUE
   iconv      NLS  profmem    cairo
    TRUE     TRUE    FALSE    FALSE


From edd at debian.org  Sat Oct 18 17:29:12 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 18 Oct 2008 10:29:12 -0500
Subject: [Rd] Minor feature request: Let 'R CMD co*nfig' tell me where
	the INCLDIR is
In-Reply-To: <18680.18502.451999.351281@stat.math.ethz.ch>
References: <18679.60996.613377.262315@ron.nulle.part>
	<18680.18502.451999.351281@stat.math.ethz.ch>
Message-ID: <18682.200.697358.801339@ron.nulle.part>


Another one that would be nice to have is 

edd at ron:~/svn/rcpp> grep "\.so" /etc/R/Makeconf
DYLIB_EXT = .so
SHLIB_EXT = .so

in order to copy with OS X extensions programmatically in Makefiles.  But I
guess I could also source Makeconf explicitly. At least the Matrix package
does that. 

On 17 October 2008 at 10:09, Martin Maechler wrote:
|     DE> [ The context is that 'R CMD INSTALL' does fewer things than a few of us
|     DE> desired (as per a thread a few months ago) but seemingly nobody with the
|     DE> magic powers to change this feels the same way. ]
| 
| or has had time for it, at the time?
| Did you get reactions from R-core at all?

Not really, unless I missed it. Brian more-or-less dismissed it by pointing
to DESCRIPTION's 'Type: Fronted' but that still doesn't solve the issue I was
suggesting as new R CMD INSTALL functionality.  But life is short and many
things are worthy to work on so this one may have dropped to the sides for good.

Dirk

-- 
Three out of two people have difficulties with fractions.


From Ollivier.Taramasco at imag.fr  Sun Oct 19 18:56:04 2008
From: Ollivier.Taramasco at imag.fr (Ollivier TARAMASCO)
Date: Sun, 19 Oct 2008 18:56:04 +0200
Subject: [Rd] R CMD build on Vista
Message-ID: <3826A5ED11514EB2A12D5F52758A94CF@Ollivier>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081019/80296c11/attachment.asc>

From ripley at stats.ox.ac.uk  Mon Oct 20 08:51:27 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 20 Oct 2008 07:51:27 +0100 (BST)
Subject: [Rd] R CMD build on Vista
In-Reply-To: <3826A5ED11514EB2A12D5F52758A94CF@Ollivier>
References: <3826A5ED11514EB2A12D5F52758A94CF@Ollivier>
Message-ID: <alpine.LFD.2.00.0810200745410.30569@gannet.stats.ox.ac.uk>

On Sun, 19 Oct 2008, Ollivier TARAMASCO wrote:

> Hello,
>
>
>
> I have R 2.7.2 and RTools 2.8 on a vista pro computer. On my computer R CMD
> build changes the file names : all capital letters are transformed into
> lowercase letters (for instance the DESCRIPTION file is changed in
> 'description'). What can I do to correct this problem?

Use a less unreliable OS?

The copying is done in Perl, and so is out of our control.  This may 
depend on the file system, and I've not seen this (nor have others 
reported it), except on Samba-mounted file systems, about which the FAQ 
says

   Your file system must allow case-honouring long file names (as is likely
   except perhaps for some network-mounted systems).

So sorry, unless that is the explanation this is beyond our control.

>
>
>
> Tank you,
>
>
>
> Ollivier TARAMASCO
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rispoli at tigem.it  Mon Oct 20 11:43:44 2008
From: rispoli at tigem.it (Rispoli Rossella)
Date: Mon, 20 Oct 2008 11:43:44 +0200
Subject: [Rd] problem with The R/Splus--Perl Interface
Message-ID: <C4917498-6CE3-43C0-8815-3C5BFDB3BE49@tigem.it>

Hi,
I'm new to using the R/Splus--Perl Interface, and I have same problem  
to understand how to pass the structure from Perl to R. I'm trying to  
call the function 'max' on the bi-dimensional array, before I tried to  
do the same thing on the vector as follows:

@x = &R::call("seq", 1,10);
$val=&R::call("max", at x);
print "val $val \n";
and it works, after this I try to do the same things on the matrix as  
follows:

'create matrix x'
$val=&R::call("max", at t);

it's dosen't works and return me this error:
invalid 'type' (list) of argument
Caught error in R::call()

After This I tried also to create a matrix from the perl code with the  
command call ('matrix'....) as follows:
'create array t'
my @v=&R::call("matrix",\@t,2,3);
or
my @v=&R::eval("matrix(@t,2,3)");
But doesn't work.

At the end my question is: there is a mode to pass a matrix from perl  
to R, and if it dosen't exist, how can I call a R function with an bi- 
dimensional array created in Perl script using the The R/Splus--Perl  
Interface?
----------------------------------------------------------------------------
Rossella Rispoli,
Bioinformatics Core Group
Telethon Institute of Genetics and Medicine (TIGEM)
Via P. Castellino 111, 80131, Naples, Italy
Tel: +39 081 6132 498
Fax: +39 081 6132 351
Web: http://bioinformatics.tigem.it/


From ggrothendieck at gmail.com  Mon Oct 20 15:37:27 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 20 Oct 2008 09:37:27 -0400
Subject: [Rd] R CMD build on Vista
In-Reply-To: <3826A5ED11514EB2A12D5F52758A94CF@Ollivier>
References: <AckyC5KYuD3JDZRESJWhG4iDeWY3JQ==>
	<3826A5ED11514EB2A12D5F52758A94CF@Ollivier>
Message-ID: <971536df0810200637m435ce844kb38b447df66b101f@mail.gmail.com>

Check what drives you have available on your system and what file system
each uses.  Click on Start button and type in System Information and then
choose Components / Storage / Drives in the left side panel.  That will
report all your drives and their file system and other information. Try running
the build on a drive with a different file system and see if that helps.  If you
are able to remove the drive that seems to be the problem you might want
to do that to ensure that its not being used for temporary files during the
build.

On Sun, Oct 19, 2008 at 12:56 PM, Ollivier TARAMASCO
<Ollivier.Taramasco at imag.fr> wrote:
> Hello,
>
>
>
> I have R 2.7.2 and RTools 2.8 on a vista pro computer. On my computer R CMD
> build changes the file names : all capital letters are transformed into
> lowercase letters (for instance the DESCRIPTION file is changed in
> 'description'). What can I do to correct this problem?
>
>
>
> Tank you,
>
>
>
> Ollivier TARAMASCO
>
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From sheetal.raut at gmail.com  Mon Oct 20 14:20:03 2008
From: sheetal.raut at gmail.com (sheetal.raut at gmail.com)
Date: Mon, 20 Oct 2008 14:20:03 +0200 (CEST)
Subject: [Rd] R application dies of with windows (PR#13179)
Message-ID: <20081020122003.C6219282C76E@mail.pubhealth.ku.dk>

Full_Name: sheetal ganpat raut
Version: R 2.7.2
OS: windows XP
Submission from: (NULL) (59.183.4.201)


Hi,
I m trying to establish connectivity between R 2.7.2 & MySQL server 5.1. I have
succeded in retriving single data column(field) from database of  MySQL. But I m
unable to retrive whole table. Whenever I fire dbReadTable or dbGetQuery or
dbSendQuery method to retrive whole table R throws error saying R for windows
front end application has encountered a problem and need to close the
application.

I m using RMysql-0.6 and DBI 0.2-4.


From diggsb at ohsu.edu  Mon Oct 20 17:55:04 2008
From: diggsb at ohsu.edu (diggsb at ohsu.edu)
Date: Mon, 20 Oct 2008 17:55:04 +0200 (CEST)
Subject: [Rd] Wrong behavior of lines.survfit for conf.int="only"
	(PR#13180)
Message-ID: <20081020155505.22BD5283416C@mail.pubhealth.ku.dk>

SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
dGhlIGJ1Zy4gIEkgaGF2ZSBub3QgdHJpZWQgdG8gYnVpbGQgdGhlIHBhY2thZ2Ugd2l0aCB0aGlz
IGNoYW5nZSB0byB0ZXN0IGl0LCBidXQganVzdCBkZWZpbmluZyB0aGUgZnVuY3Rpb24gd2l0aCB0
aGlzIGNoYW5nZSBzZWVtcyB0byB3b3JrLg0KDQpUaGUgY29kZQ0KDQoJaWYgKGNvbmYuaW50PT0n
b25seScpIHsNCgkgICAgY29uZi5pbnQgPC0gVFJVRQ0KCSAgICBwbG90LnN1cnY8LSBUUlVFDQoJ
ICAgIH0NCg0KU2hvdWxkIGJlDQoNCglpZiAoY29uZi5pbnQ9PSdvbmx5Jykgew0KCSAgICBjb25m
LmludCA8LSBUUlVFDQoJICAgIHBsb3Quc3VydjwtIEZBTFNFDQoJICAgIH0NCg0KLS1CcmlhbiBE
aWdncw0KDQo=


From p.dalgaard at biostat.ku.dk  Mon Oct 20 18:32:51 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon, 20 Oct 2008 18:32:51 +0200
Subject: [Rd] Wrong behavior of lines.survfit for
	conf.int="only"	(PR#13180)
In-Reply-To: <20081020155505.22BD5283416C@mail.pubhealth.ku.dk>
References: <20081020155505.22BD5283416C@mail.pubhealth.ku.dk>
Message-ID: <48FCB2B3.7060807@biostat.ku.dk>

diggsb at ohsu.edu wrote:
> SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
> dGhlIGJ1Zy4gIEkgaGF2ZSBub3QgdHJpZWQgdG8gYnVpbGQgdGhlIHBhY2thZ2Ugd2l0aCB0aGlz
> IGNoYW5nZSB0byB0ZXN0IGl0LCBidXQganVzdCBkZWZpbmluZyB0aGUgZnVuY3Rpb24gd2l0aCB0
> aGlzIGNoYW5nZSBzZWVtcyB0byB3b3JrLg0KDQpUaGUgY29kZQ0KDQoJaWYgKGNvbmYuaW50PT0n
> b25seScpIHsNCgkgICAgY29uZi5pbnQgPC0gVFJVRQ0KCSAgICBwbG90LnN1cnY8LSBUUlVFDQoJ
> ICAgIH0NCg0KU2hvdWxkIGJlDQoNCglpZiAoY29uZi5pbnQ9PSdvbmx5Jykgew0KCSAgICBjb25m
> LmludCA8LSBUUlVFDQoJICAgIHBsb3Quc3VydjwtIEZBTFNFDQoJICAgIH0NCg0KLS1CcmlhbiBE
> aWdncw0KDQo=
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

Argh! Jitterbug...must...die...

[pd at titmouse2]$ base64 -d
SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
....
aWdncw0KDQo=

I downloaded the source for survival and I think I found the bug.  I 
have not tried to build the package with this change to test it, but 
just defining the function with this change seems to work.

The code

	if (conf.int=='only') {
	    conf.int <- TRUE
	    plot.surv<- TRUE
	    }

Should be

	if (conf.int=='only') {
	    conf.int <- TRUE
	    plot.surv<- FALSE
	    }

--Brian Diggs




-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From murdoch at stats.uwo.ca  Mon Oct 20 18:42:15 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 20 Oct 2008 12:42:15 -0400
Subject: [Rd] R application dies of with windows (PR#13179)
In-Reply-To: <20081020122003.C6219282C76E@mail.pubhealth.ku.dk>
References: <20081020122003.C6219282C76E@mail.pubhealth.ku.dk>
Message-ID: <48FCB4E7.6030907@stats.uwo.ca>

On 10/20/2008 8:20 AM, sheetal.raut at gmail.com wrote:
> Full_Name: sheetal ganpat raut
> Version: R 2.7.2
> OS: windows XP
> Submission from: (NULL) (59.183.4.201)
> 
> 
> Hi,
> I m trying to establish connectivity between R 2.7.2 & MySQL server 5.1. I have
> succeded in retriving single data column(field) from database of  MySQL. But I m
> unable to retrive whole table. Whenever I fire dbReadTable or dbGetQuery or
> dbSendQuery method to retrive whole table R throws error saying R for windows
> front end application has encountered a problem and need to close the
> application.
> 
> I m using RMysql-0.6 and DBI 0.2-4.

This looks like a bug with one of those contributed packages, not with 
R.  Please send your report to the maintainer.

You might find better luck using RODBC.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Mon Oct 20 19:28:30 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 20 Oct 2008 18:28:30 +0100 (BST)
Subject: [Rd] (PR#13180) Wrong behavior of lines.survfit for
 conf.int="only"
In-Reply-To: <48FCB2B3.7060807@biostat.ku.dk>
References: <20081020155505.22BD5283416C@mail.pubhealth.ku.dk>
	<48FCB2B3.7060807@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0810201826140.24959@gannet.stats.ox.ac.uk>

Note that survival is a contributed package: only the maintainer can alter 
it (or at least, if someone else does the change will get lost -- it has 
happened before).  So it is not useful to report on it on R-bugs (see the 
FAQ and the posting guide).


On Mon, 20 Oct 2008, Peter Dalgaard wrote:

> diggsb at ohsu.edu wrote:
>> SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
>> dGhlIGJ1Zy4gIEkgaGF2ZSBub3QgdHJpZWQgdG8gYnVpbGQgdGhlIHBhY2thZ2Ugd2l0aCB0aGlz
>> IGNoYW5nZSB0byB0ZXN0IGl0LCBidXQganVzdCBkZWZpbmluZyB0aGUgZnVuY3Rpb24gd2l0aCB0
>> aGlzIGNoYW5nZSBzZWVtcyB0byB3b3JrLg0KDQpUaGUgY29kZQ0KDQoJaWYgKGNvbmYuaW50PT0n
>> b25seScpIHsNCgkgICAgY29uZi5pbnQgPC0gVFJVRQ0KCSAgICBwbG90LnN1cnY8LSBUUlVFDQoJ
>> ICAgIH0NCg0KU2hvdWxkIGJlDQoNCglpZiAoY29uZi5pbnQ9PSdvbmx5Jykgew0KCSAgICBjb25m
>> LmludCA8LSBUUlVFDQoJICAgIHBsb3Quc3VydjwtIEZBTFNFDQoJICAgIH0NCg0KLS1CcmlhbiBE
>> aWdncw0KDQo=
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> Argh! Jitterbug...must...die...
>
> [pd at titmouse2]$ base64 -d
> SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
> ....
> aWdncw0KDQo=
>
> I downloaded the source for survival and I think I found the bug.  I have not 
> tried to build the package with this change to test it, but just defining the 
> function with this change seems to work.
>
> The code
>
> 	if (conf.int=='only') {
> 	    conf.int <- TRUE
> 	    plot.surv<- TRUE
> 	    }
>
> Should be
>
> 	if (conf.int=='only') {
> 	    conf.int <- TRUE
> 	    plot.surv<- FALSE
> 	    }
>
> --Brian Diggs
>
>
>
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From diggsb at ohsu.edu  Mon Oct 20 20:02:00 2008
From: diggsb at ohsu.edu (Brian Diggs)
Date: Mon, 20 Oct 2008 11:02:00 -0700
Subject: [Rd] (PR#13180) Wrong behavior of lines.survfit for
 conf.int="only"
In-Reply-To: <alpine.LFD.2.00.0810201826140.24959@gannet.stats.ox.ac.uk>
References: <20081020155505.22BD5283416C@mail.pubhealth.ku.dk>
	<48FCB2B3.7060807@biostat.ku.dk>
	<alpine.LFD.2.00.0810201826140.24959@gannet.stats.ox.ac.uk>
Message-ID: <D90C24824765F143934E4DE78009D6174DF4A7@EX-BE05.ohsu.edu>

Thank you.  I was confused because survival was a standard (recommended) package, so I thought r-bugs was the appropriate place.  I have contacted the maintainer of the package with this information.  My thanks also to Peter Dalgaard for de-base64-coding my message; I have no idea how or why it got encoded that way.  Additionally, this was meant as a follow-up to PR#13171. Both PR#13171 and PR#13180 can be considered dealt with.  Please accept my apologies for messing the process up so much.


--
Brian Diggs, Ph.D.
Senior Research Associate, Department of Surgery, Oregon Health & Science University


-----Original Message-----
From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sent: Monday, October 20, 2008 10:29 AM
To: Peter Dalgaard
Cc: Brian Diggs; R-bugs at r-project.org; r-devel at stat.math.ethz.ch
Subject: Re: [Rd] (PR#13180) Wrong behavior of lines.survfit for conf.int="only"

Note that survival is a contributed package: only the maintainer can alter 
it (or at least, if someone else does the change will get lost -- it has 
happened before).  So it is not useful to report on it on R-bugs (see the 
FAQ and the posting guide).


On Mon, 20 Oct 2008, Peter Dalgaard wrote:

> diggsb at ohsu.edu wrote:
>> SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
>> dGhlIGJ1Zy4gIEkgaGF2ZSBub3QgdHJpZWQgdG8gYnVpbGQgdGhlIHBhY2thZ2Ugd2l0aCB0aGlz
>> IGNoYW5nZSB0byB0ZXN0IGl0LCBidXQganVzdCBkZWZpbmluZyB0aGUgZnVuY3Rpb24gd2l0aCB0
>> aGlzIGNoYW5nZSBzZWVtcyB0byB3b3JrLg0KDQpUaGUgY29kZQ0KDQoJaWYgKGNvbmYuaW50PT0n
>> b25seScpIHsNCgkgICAgY29uZi5pbnQgPC0gVFJVRQ0KCSAgICBwbG90LnN1cnY8LSBUUlVFDQoJ
>> ICAgIH0NCg0KU2hvdWxkIGJlDQoNCglpZiAoY29uZi5pbnQ9PSdvbmx5Jykgew0KCSAgICBjb25m
>> LmludCA8LSBUUlVFDQoJICAgIHBsb3Quc3VydjwtIEZBTFNFDQoJICAgIH0NCg0KLS1CcmlhbiBE
>> aWdncw0KDQo=
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> Argh! Jitterbug...must...die...
>
> [pd at titmouse2]$ base64 -d
> SSBkb3dubG9hZGVkIHRoZSBzb3VyY2UgZm9yIHN1cnZpdmFsIGFuZCBJIHRoaW5rIEkgZm91bmQg
> ....
> aWdncw0KDQo=
>
> I downloaded the source for survival and I think I found the bug.  I have not 
> tried to build the package with this change to test it, but just defining the 
> function with this change seems to work.
>
> The code
>
> 	if (conf.int=='only') {
> 	    conf.int <- TRUE
> 	    plot.surv<- TRUE
> 	    }
>
> Should be
>
> 	if (conf.int=='only') {
> 	    conf.int <- TRUE
> 	    plot.surv<- FALSE
> 	    }
>
> --Brian Diggs
>
>
>
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From htl10 at users.sourceforge.net  Tue Oct 21 00:20:04 2008
From: htl10 at users.sourceforge.net (htl10 at users.sourceforge.net)
Date: Tue, 21 Oct 2008 00:20:04 +0200 (CEST)
Subject: [Rd] R CMD check scans git objects (PR#13182)
Message-ID: <20081020222004.5FC38282EFF0@mail.pubhealth.ku.dk>

Full_Name: Hin-Tak Leung
Version: 2.8.0
OS: fedora 9 x86_64 linux
Submission from: (NULL) (81.101.130.174)


I use git-svn to work with bioconductor's svn. (git is a much better
svn client than svn itself is...)

* checking for executable files ... WARNING
Found the following executable file(s):
  .git/objects/e8/727b7c57276eb0cacb322fe917be7c03c15a7e
  .git/objects/6c/d85e0c4360e3e113f5c3a202c073e0e81bdeb3
  .git/objects/55/8269a173fbc9cb3398b85b1154631f3561c21c
  .git/objects/8a/28fa6ace9693af69d612cfd0a75e049fb08c95
  .git/objects/97/32bbe4e5ef493edd528853c04265e5833481ad
  .git/objects/fe/9965422dc6293299872958907606462a1803c7
  .git/objects/61/d6af4135eb3330091e4311863023f351ce30ca
  .git/objects/e2/f219e269fd47a2e68b723ea8e6f876ef365244
  .git/objects/11/2fd211501b032091098505a2da4a4dcf2c025a

R CMD check should ignore everything under .git, just as it does with .svn and
CVS.

Should be a very easy bug to fix/enhancement to made.


From byron.ellis at gmail.com  Tue Oct 21 20:45:14 2008
From: byron.ellis at gmail.com (byron.ellis at gmail.com)
Date: Tue, 21 Oct 2008 20:45:14 +0200 (CEST)
Subject: [Rd] ---without-x option fails for R 2.8.0 (missing ;) (PR#13188)
Message-ID: <20081021184514.27B78282C787@mail.pubhealth.ku.dk>

Full_Name: Byron Ellis
Version: 2.8.0
OS: Linux
Submission from: (NULL) (64.124.65.175)


There is a missing ';' just above platform.c:1661 on the line "X11 = FALSE" that
causes compilation errors when X11 libraries are not being used.


From jfox at mcmaster.ca  Wed Oct 22 00:23:23 2008
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 21 Oct 2008 18:23:23 -0400
Subject: [Rd] R CMD INSTALL problem
Message-ID: <002d01c933cb$a16e5530$e44aff90$@ca>

Dear list members,

I've run into a problem with R CMD INSTALL under Windows Vista and R 2.8.0:

--------- snip -----------

C:\Users\John Fox\workspace>c:\R\R-2.8.0\bin\R CMD INSTALL car
installing to ''


---------- Making package car ------------
  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  installing R files
  installing inst files
  installing data files
  preparing package car for lazy loading
Warning in list.files(lib, pattern = paste("^", pkg_regexp, sep = ""), ful
s = TRUE) :
  list.files: '' is not a readable directory
Error in findpack(package, lib.loc) : there is no package called 'car'
Calls: <Anonymous> -> findpack
Execution halted
make[2]: *** [lazyload] Error 1
make[1]: *** [all] Error 2
make: *** [pkg-car] Error 2
*** Installation of car failed ***

Removing '/car'

----------- snip ------------

Apparently, the package isn't being installed to the standard library
location.

The same command works perfectly fine under R 2.7.2:

----------- snip ------------

C:\Users\John Fox\workspace>c:\R\R-2.7.2\bin\R CMD INSTALL car
installing to 'c:/R/R-2.7.2/library'


---------- Making package car ------------
  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  installing R files
  installing inst files
  installing data files
  preparing package car for lazy loading
  preparing package car for lazy data loading
  installing man source files
  installing indices
  installing help
 >>> Building/Updating help pages for package 'car'
     Formats: text html latex example chm
  Adler                             text    html    latex           chm
  Angell                            text    html    latex           chm
  Anova                             text    html    latex   example chm
  Anscombe                          text    html    latex           chm

  . . .
  
  vif                               text    html    latex   example chm
  which.names                       text    html    latex   example chm
Microsoft HTML Help Compiler 4.74.8702

Compiling c:\Users\JOHNFO~1\WORKSP~1\car\chm\car.chm


Compile time: 0 minutes, 2 seconds
80      Topics
248     Local links
3       Internet links
1       Graphic


Created c:\Users\JOHNFO~1\WORKSP~1\car\chm\car.chm, 144,998 bytes
Compression decreased file by 191,708 bytes.
  adding MD5 sums

* DONE (car)

----------- snip ------------

I see in the Windows CHANGES file that Rcmd.exe has been modified. Do I have
to set an environment variable that I didn't have to set before?

Any help would be appreciated.

John

------------------------------
John Fox, Professor
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
web: socserv.mcmaster.ca/jfox


From deepayan.sarkar at gmail.com  Wed Oct 22 01:15:35 2008
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Tue, 21 Oct 2008 16:15:35 -0700
Subject: [Rd] R CMD INSTALL problem
In-Reply-To: <002d01c933cb$a16e5530$e44aff90$@ca>
References: <002d01c933cb$a16e5530$e44aff90$@ca>
Message-ID: <eb555e660810211615x641441cra01e94179b20994@mail.gmail.com>

On Tue, Oct 21, 2008 at 3:23 PM, John Fox <jfox at mcmaster.ca> wrote:
> Dear list members,
>
> I've run into a problem with R CMD INSTALL under Windows Vista and R 2.8.0:
>
> --------- snip -----------
>
> C:\Users\John Fox\workspace>c:\R\R-2.8.0\bin\R CMD INSTALL car
> installing to ''

Not sure if this is relevant for you, but I was seeing similar
behavior on Linux, and the reason turned out to be that the INSTALL
script invokes

R_DEFAULT_PACKAGES=NULL R --no-restore --slave

which ran code in my .Rprofile, but without the usual packages
attached. In my case, this was causing an error (because of not
carefully written code in the profile) leading to an empty string for
$lib (which seems to be happening for you too).

-Deepayan


From jfox at mcmaster.ca  Wed Oct 22 02:21:06 2008
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 21 Oct 2008 20:21:06 -0400
Subject: [Rd] R CMD INSTALL problem
In-Reply-To: <eb555e660810211615x641441cra01e94179b20994@mail.gmail.com>
References: <002d01c933cb$a16e5530$e44aff90$@ca>
	<eb555e660810211615x641441cra01e94179b20994@mail.gmail.com>
Message-ID: <003201c933dc$135ec750$3a1c55f0$@ca>

Dear Deepayan,

Yes, that was it: My Rprofile.site file had initialization code in it
produced by the Tinn-R editor; removing this code solved the problem (which
didn't occur in R 2.7.2), as did enclosing it in if (interactive()){}.

Thank you very much for pointing me in the right direction.

John


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
On
> Behalf Of Deepayan Sarkar
> Sent: October-21-08 7:16 PM
> To: John Fox
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] R CMD INSTALL problem
> 
> On Tue, Oct 21, 2008 at 3:23 PM, John Fox <jfox at mcmaster.ca> wrote:
> > Dear list members,
> >
> > I've run into a problem with R CMD INSTALL under Windows Vista and R
2.8.0:
> >
> > --------- snip -----------
> >
> > C:\Users\John Fox\workspace>c:\R\R-2.8.0\bin\R CMD INSTALL car
> > installing to ''
> 
> Not sure if this is relevant for you, but I was seeing similar
> behavior on Linux, and the reason turned out to be that the INSTALL
> script invokes
> 
> R_DEFAULT_PACKAGES=NULL R --no-restore --slave
> 
> which ran code in my .Rprofile, but without the usual packages
> attached. In my case, this was causing an error (because of not
> carefully written code in the profile) leading to an empty string for
> $lib (which seems to be happening for you too).
> 
> -Deepayan
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Wed Oct 22 07:32:23 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 22 Oct 2008 06:32:23 +0100 (BST)
Subject: [Rd] ---without-x option fails for R 2.8.0 (missing ;
 ) (PR#13188)
In-Reply-To: <20081021184514.27B78282C787@mail.pubhealth.ku.dk>
References: <20081021184514.27B78282C787@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810220630290.13544@gannet.stats.ox.ac.uk>

Already fixed in R-patched.

And no one reported this in the month of alpha/beta/RC testing, so users 
who use this option need to respond to requests for help.

On Tue, 21 Oct 2008, byron.ellis at gmail.com wrote:

> Full_Name: Byron Ellis
> Version: 2.8.0
> OS: Linux
> Submission from: (NULL) (64.124.65.175)
>
>
> There is a missing ';' just above platform.c:1661 on the line "X11 = FALSE" that
> causes compilation errors when X11 libraries are not being used.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Oct 22 07:35:04 2008
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Wed, 22 Oct 2008 07:35:04 +0200 (CEST)
Subject: [Rd] ---without-x option fails for R 2.8.0 (missing ;
	) (PR#13190)
Message-ID: <20081022053504.B32A1283460E@mail.pubhealth.ku.dk>

Already fixed in R-patched.

And no one reported this in the month of alpha/beta/RC testing, so users 
who use this option need to respond to requests for help.

On Tue, 21 Oct 2008, byron.ellis at gmail.com wrote:

> Full_Name: Byron Ellis
> Version: 2.8.0
> OS: Linux
> Submission from: (NULL) (64.124.65.175)
>
>
> There is a missing ';' just above platform.c:1661 on the line "X11 = FALSE" that
> causes compilation errors when X11 libraries are not being used.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bastien.preuss at noumea.ird.nc  Wed Oct 22 08:10:03 2008
From: bastien.preuss at noumea.ird.nc (bastien.preuss at noumea.ird.nc)
Date: Wed, 22 Oct 2008 08:10:03 +0200 (CEST)
Subject: [Rd] Bug when importing datas with tcltk window (PR#13191)
Message-ID: <20081022061003.A5511283416A@mail.pubhealth.ku.dk>

Full_Name: PREUSS Bastien
Version: R version 2.6.2 (2008-02-08)
OS: mingw32
Submission from: (NULL) (193.51.249.166)


Hello,

I wrote a small function using tcltk to import my datasets.
When I use it, both the tcltk and the R windows closed themselves.
I don't understand why. What is surprising is that it doesn?t happen each time.
Most of the time I can't finish the importation of my 3 data folders, but
sometimes I am successful.

Here is my function:


require(tcltk)


import.donnees.f = function() {


####

openObservations.f = function(){
  name1<-tclvalue(tkgetOpenFile())
    if (!nchar(name1))
      tkmessageBox(message="Aucun fichier n'a ?t? s?lectionn?!")  else
      tkmessageBox(message=paste("Vous avez s?lectionn? le fichier ",name1))
  assign("fileName",name1,envir=.GlobalEnv)
}


openUnitobs.f = function(){
  name2<-tclvalue(tkgetOpenFile())
    if (!nchar(name2))
      tkmessageBox(message="Aucun fichier n'a ?t? s?lectionn?!")  else
      tkmessageBox(message=paste("Vous avez s?lectionn? le fichier ",name2))
  assign("fileName2",name2,envir=.GlobalEnv)
}


openListespeces.f = function(){
  name3<-tclvalue(tkgetOpenFile())
    if (!nchar(name3))
      tkmessageBox(message="Aucun fichier n'a ?t? s?lectionn?!")  else
      tkmessageBox(message=paste("Vous avez s?lectionn? le fichier ",name3))
  assign("fileName3",name3,envir=.GlobalEnv)
}

tt <- tktoplevel()
tkwm.title(tt,"Import des fichiers de donn?es")
button.widget <- tkbutton(tt,text="Table de donn?es d'observations              
                                      ",command=openObservations.f)
button.widget2 <- tkbutton(tt,text="Table de donn?es sur les unit?s
d'observation                             ",command=openUnitobs.f)
button.widget3 <- tkbutton(tt,text="Table de donn?es sur les esp?ces            
                                      ",command=openListespeces.f)
OK.but <- tkbutton(tt,text="               Valider               
",command=function() tkdestroy(tt))
tkpack(button.widget,button.widget2,button.widget3,OK.but)
tkfocus(tt)
tkwait.window(tt)

}


From Bernhard_Pfaff at fra.invesco.com  Wed Oct 22 12:36:39 2008
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Wed, 22 Oct 2008 11:36:39 +0100
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
Message-ID: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>

Dear list-reader,

by running the following script:

library(zoo)
sessionInfo()
search()
packageDescription("zoo")
data(EuStockMarkets)
dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
daxr <- diff(log(dax))
identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
qqnorm(coredata(daxr))
qqnorm(daxr)


qqnorm() produces an error:

> qqnorm(daxr)
Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
  Argument hat L?nge 0
Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
Ausf?hrung angehalten


However, this is not witnessed by running the script through R 2.7.2 (attached are the two output files). Incidentally, the QQ-plot is produced if one uses "qqnorm(coredata(daxr))" under R version 2.8.0. After having read both NEWS on CRAN (General and Windows specific) I still could not figure out what causes this result. The version of package zoo is the same and the results do not change if I use the zoo package built under R version 2.7.2 with R version 2.7.2 or the one that has been built under R version 2.8.0.

Any hints and enlightenment are most welcome.

Best,
Bernhard


*****************************************************************
Confidentiality Note: The information contained in this message,
and any attachments, may contain confidential and/or privileged
material. It is intended solely for the person(s) or entity to
which it is addressed. Any review, retransmission, dissemination,
or taking of any action in reliance upon this information by
persons or entities other than the intended recipient(s) is
prohibited. If you received this in error, please contact the
sender and delete the material from any computer.
*****************************************************************

From Bernhard_Pfaff at fra.invesco.com  Wed Oct 22 13:34:33 2008
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Wed, 22 Oct 2008 12:34:33 +0100
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
Message-ID: <B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>

It seems, that in my previous emails the attached output files got deleted, hence these are now copied below:

For R version 2.7.2:
====================
R version 2.7.2 (2008-08-25)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
Tippen Sie 'license()' or 'licence()' f?r Details dazu.

R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.

Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
Tippen Sie 'q()', um R zu verlassen.


Invesco colors have been created!
Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
Type: 'invcolor' to see its definition.

[Vorher gesicherter Workspace wiederhergestellt]

> library(zoo)

Attache Paket: 'zoo'


	The following object(s) are masked from package:base :

	 as.Date.numeric 

Warning message:
Paket 'zoo' wurde unter R Version 2.8.0 gebaut 
> sessionInfo()
R version 2.7.2 (2008-08-25) 
i386-pc-mingw32 

locale:
LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252

attached base packages:
[1] stats     graphics  utils     datasets  grDevices methods   base     

other attached packages:
[1] zoo_1.5-4

loaded via a namespace (and not attached):
[1] grid_2.7.2      lattice_0.17-13
> search()
 [1] ".GlobalEnv"        "package:zoo"       "package:stats"    
 [4] "package:graphics"  "package:utils"     "package:datasets" 
 [7] "package:grDevices" "package:methods"   "Autoloads"        
[10] "package:base"     
> packageDescription("zoo")
Package: zoo
Version: 1.5-4
Date: 2008-07-09
Title: Z's ordered observations
Author: Achim Zeileis, Gabor Grothendieck
Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
Description: An S3 class with methods for totally ordered indexed
        observations. It is particularly aimed at irregular time series
        of numeric vectors/matrices and factors. zoo's key design goals
        are independence of a particular index/date/time class and
        consistency with with ts and base R by providing methods to
        extend standard generics.
Depends: R (>= 2.4.1), stats
Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
        strucchange, DAAG, xts
Imports: stats, utils, graphics, grDevices, lattice
LazyLoad: yes
License: GPL-2
URL: http://R-Forge.R-project.org/projects/zoo/
Packaged: Wed Jul 9 18:28:07 2008; zeileis
Built: R 2.8.0; ; 2008-10-16 00:01:11; windows

-- File: C:/R/package/zoo/Meta/package.rds 
> data(EuStockMarkets)
> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
> daxr <- diff(log(dax))
> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
[1] TRUE
Warning messages:
1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
> qqnorm(coredata(daxr))
> qqnorm(daxr)
> 
> proc.time()
       User      System verstrichen 
       1.65        0.13        2.97 

For R version 2.8.0:
====================
 version 2.8.0 (2008-10-20)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
Tippen Sie 'license()' or 'licence()' f?r Details dazu.

R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.

Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
Tippen Sie 'q()', um R zu verlassen.


Invesco colors have been created!
Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
Type: 'invcolor' to see its definition.

[Vorher gesicherter Workspace wiederhergestellt]

> library(zoo)

Attache Paket: 'zoo'


	The following object(s) are masked from package:base :

	 as.Date.numeric 

> sessionInfo()
R version 2.8.0 (2008-10-20) 
i386-pc-mingw32 

locale:
LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252

attached base packages:
[1] stats     graphics  utils     datasets  grDevices methods   base     

other attached packages:
[1] zoo_1.5-4

loaded via a namespace (and not attached):
[1] grid_2.8.0      lattice_0.17-15
> search()
 [1] ".GlobalEnv"        "package:zoo"       "package:stats"    
 [4] "package:graphics"  "package:utils"     "package:datasets" 
 [7] "package:grDevices" "package:methods"   "Autoloads"        
[10] "package:base"     
> packageDescription("zoo")
Package: zoo
Version: 1.5-4
Date: 2008-07-09
Title: Z's ordered observations
Author: Achim Zeileis, Gabor Grothendieck
Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
Description: An S3 class with methods for totally ordered indexed
        observations. It is particularly aimed at irregular time series
        of numeric vectors/matrices and factors. zoo's key design goals
        are independence of a particular index/date/time class and
        consistency with with ts and base R by providing methods to
        extend standard generics.
Depends: R (>= 2.4.1), stats
Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
        strucchange, DAAG, xts
Imports: stats, utils, graphics, grDevices, lattice
LazyLoad: yes
License: GPL-2
URL: http://R-Forge.R-project.org/projects/zoo/
Packaged: Wed Jul 9 18:28:07 2008; zeileis
Built: R 2.8.0; ; 2008-10-16 00:01:11; windows

-- File: C:/R/package/zoo/Meta/package.rds 
> data(EuStockMarkets)
> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
> daxr <- diff(log(dax))
> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
[1] TRUE
Warning messages:
1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
> qqnorm(coredata(daxr))
> qqnorm(daxr)
Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
  Argument hat L?nge 0
Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
Ausf?hrung angehalten


>
>Dear list-reader,
>
>by running the following script:
>
>library(zoo)
>sessionInfo()
>search()
>packageDescription("zoo")
>data(EuStockMarkets)
>dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>daxr <- diff(log(dax))
>identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>qqnorm(coredata(daxr))
>qqnorm(daxr)
>
>
>qqnorm() produces an error:
>
>> qqnorm(daxr)
>Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
>  Argument hat L?nge 0
>Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
>Ausf?hrung angehalten
>
>
>However, this is not witnessed by running the script through R 
>2.7.2 (attached are the two output files). Incidentally, the 
>QQ-plot is produced if one uses "qqnorm(coredata(daxr))" under 
>R version 2.8.0. After having read both NEWS on CRAN (General 
>and Windows specific) I still could not figure out what causes 
>this result. The version of package zoo is the same and the 
>results do not change if I use the zoo package built under R 
>version 2.7.2 with R version 2.7.2 or the one that has been 
>built under R version 2.8.0.
>
>Any hints and enlightenment are most welcome.
>
>Best,
>Bernhard
>
>
>*****************************************************************
>Confidentiality Note: The information contained in this message,
>and any attachments, may contain confidential and/or privileged
>material. It is intended solely for the person(s) or entity to
>which it is addressed. Any review, retransmission, dissemination,
>or taking of any action in reliance upon this information by
>persons or entities other than the intended recipient(s) is
>prohibited. If you received this in error, please contact the
>sender and delete the material from any computer.
>*****************************************************************
>


From P.Dalgaard at biostat.ku.dk  Wed Oct 22 14:49:34 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 22 Oct 2008 14:49:34 +0200
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
Message-ID: <48FF215E.80807@biostat.ku.dk>

Pfaff, Bernhard Dr. wrote:
> It seems, that in my previous emails the attached output files got deleted, hence these are now copied below:
>
>   
(If the MIME type is wrong, then that will happen.)

Anyways, the root cause seems to be the new function .gt() which is
related to

    o   New generic function xtfrm() as an auxiliary helper for
        sort(), order() and rank().  This should return a numeric
        vector that sorts in the same way as its input.  The default
        method supports any class with ==, > and is.na() methods but
        specific methods can be much faster.

        As a side-effect, rank() will now work better on classed
        objects, although possibly rather slowly.

Here, "better" may be in the eyes of the beholder, for

> dax[3]==dax[6]
Data:
logical(0)

Index:
integer(0)

and accordingly

> rank(dax)
Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
  argument is of length zero

which is the error that you are seeing.

What to do about it is a bit dubious. Obviously, we don't want to "fix"
.gt() so that it automatically unclasses objects, and I assume that zoo
has its reasons for not wanting to compare series with different
indices. So I suppose that either the user must unclass, or zoo define
rank.zoo.

> For R version 2.7.2:
> ====================
> R version 2.7.2 (2008-08-25)
> Copyright (C) 2008 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
> Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
>
> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
> um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.
>
> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
> Tippen Sie 'q()', um R zu verlassen.
>
>
> Invesco colors have been created!
> Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
> Type: 'invcolor' to see its definition.
>
> [Vorher gesicherter Workspace wiederhergestellt]
>
>   
>> library(zoo)
>>     
>
> Attache Paket: 'zoo'
>
>
> 	The following object(s) are masked from package:base :
>
> 	 as.Date.numeric 
>
> Warning message:
> Paket 'zoo' wurde unter R Version 2.8.0 gebaut 
>   
>> sessionInfo()
>>     
> R version 2.7.2 (2008-08-25) 
> i386-pc-mingw32 
>
> locale:
> LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>
> attached base packages:
> [1] stats     graphics  utils     datasets  grDevices methods   base     
>
> other attached packages:
> [1] zoo_1.5-4
>
> loaded via a namespace (and not attached):
> [1] grid_2.7.2      lattice_0.17-13
>   
>> search()
>>     
>  [1] ".GlobalEnv"        "package:zoo"       "package:stats"    
>  [4] "package:graphics"  "package:utils"     "package:datasets" 
>  [7] "package:grDevices" "package:methods"   "Autoloads"        
> [10] "package:base"     
>   
>> packageDescription("zoo")
>>     
> Package: zoo
> Version: 1.5-4
> Date: 2008-07-09
> Title: Z's ordered observations
> Author: Achim Zeileis, Gabor Grothendieck
> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
> Description: An S3 class with methods for totally ordered indexed
>         observations. It is particularly aimed at irregular time series
>         of numeric vectors/matrices and factors. zoo's key design goals
>         are independence of a particular index/date/time class and
>         consistency with with ts and base R by providing methods to
>         extend standard generics.
> Depends: R (>= 2.4.1), stats
> Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
>         strucchange, DAAG, xts
> Imports: stats, utils, graphics, grDevices, lattice
> LazyLoad: yes
> License: GPL-2
> URL: http://R-Forge.R-project.org/projects/zoo/
> Packaged: Wed Jul 9 18:28:07 2008; zeileis
> Built: R 2.8.0; ; 2008-10-16 00:01:11; windows
>
> -- File: C:/R/package/zoo/Meta/package.rds 
>   
>> data(EuStockMarkets)
>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>> daxr <- diff(log(dax))
>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>     
> [1] TRUE
> Warning messages:
> 1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
> 2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>   
>> qqnorm(coredata(daxr))
>> qqnorm(daxr)
>>
>> proc.time()
>>     
>        User      System verstrichen 
>        1.65        0.13        2.97 
>
> For R version 2.8.0:
> ====================
>  version 2.8.0 (2008-10-20)
> Copyright (C) 2008 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
> Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
>
> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
> um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.
>
> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
> Tippen Sie 'q()', um R zu verlassen.
>
>
> Invesco colors have been created!
> Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
> Type: 'invcolor' to see its definition.
>
> [Vorher gesicherter Workspace wiederhergestellt]
>
>   
>> library(zoo)
>>     
>
> Attache Paket: 'zoo'
>
>
> 	The following object(s) are masked from package:base :
>
> 	 as.Date.numeric 
>
>   
>> sessionInfo()
>>     
> R version 2.8.0 (2008-10-20) 
> i386-pc-mingw32 
>
> locale:
> LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>
> attached base packages:
> [1] stats     graphics  utils     datasets  grDevices methods   base     
>
> other attached packages:
> [1] zoo_1.5-4
>
> loaded via a namespace (and not attached):
> [1] grid_2.8.0      lattice_0.17-15
>   
>> search()
>>     
>  [1] ".GlobalEnv"        "package:zoo"       "package:stats"    
>  [4] "package:graphics"  "package:utils"     "package:datasets" 
>  [7] "package:grDevices" "package:methods"   "Autoloads"        
> [10] "package:base"     
>   
>> packageDescription("zoo")
>>     
> Package: zoo
> Version: 1.5-4
> Date: 2008-07-09
> Title: Z's ordered observations
> Author: Achim Zeileis, Gabor Grothendieck
> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
> Description: An S3 class with methods for totally ordered indexed
>         observations. It is particularly aimed at irregular time series
>         of numeric vectors/matrices and factors. zoo's key design goals
>         are independence of a particular index/date/time class and
>         consistency with with ts and base R by providing methods to
>         extend standard generics.
> Depends: R (>= 2.4.1), stats
> Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
>         strucchange, DAAG, xts
> Imports: stats, utils, graphics, grDevices, lattice
> LazyLoad: yes
> License: GPL-2
> URL: http://R-Forge.R-project.org/projects/zoo/
> Packaged: Wed Jul 9 18:28:07 2008; zeileis
> Built: R 2.8.0; ; 2008-10-16 00:01:11; windows
>
> -- File: C:/R/package/zoo/Meta/package.rds 
>   
>> data(EuStockMarkets)
>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>> daxr <- diff(log(dax))
>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>     
> [1] TRUE
> Warning messages:
> 1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
> 2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>   
>> qqnorm(coredata(daxr))
>> qqnorm(daxr)
>>     
> Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
>   Argument hat L?nge 0
> Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
> Ausf?hrung angehalten
>
>
>   
>> Dear list-reader,
>>
>> by running the following script:
>>
>> library(zoo)
>> sessionInfo()
>> search()
>> packageDescription("zoo")
>> data(EuStockMarkets)
>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>> daxr <- diff(log(dax))
>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>> qqnorm(coredata(daxr))
>> qqnorm(daxr)
>>
>>
>> qqnorm() produces an error:
>>
>>     
>>> qqnorm(daxr)
>>>       
>> Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
>>  Argument hat L?nge 0
>> Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
>> Ausf?hrung angehalten
>>
>>
>> However, this is not witnessed by running the script through R 
>> 2.7.2 (attached are the two output files). Incidentally, the 
>> QQ-plot is produced if one uses "qqnorm(coredata(daxr))" under 
>> R version 2.8.0. After having read both NEWS on CRAN (General 
>> and Windows specific) I still could not figure out what causes 
>> this result. The version of package zoo is the same and the 
>> results do not change if I use the zoo package built under R 
>> version 2.7.2 with R version 2.7.2 or the one that has been 
>> built under R version 2.8.0.
>>
>> Any hints and enlightenment are most welcome.
>>
>> Best,
>> Bernhard
>>
>>
>> *****************************************************************
>> Confidentiality Note: The information contained in this message,
>> and any attachments, may contain confidential and/or privileged
>> material. It is intended solely for the person(s) or entity to
>> which it is addressed. Any review, retransmission, dissemination,
>> or taking of any action in reliance upon this information by
>> persons or entities other than the intended recipient(s) is
>> prohibited. If you received this in error, please contact the
>> sender and delete the material from any computer.
>> *****************************************************************
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From Bernhard_Pfaff at fra.invesco.com  Wed Oct 22 15:00:43 2008
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Wed, 22 Oct 2008 14:00:43 +0100
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <48FF215E.80807@biostat.ku.dk>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
Message-ID: <B89F0CE41D45644A97CCC93DF548C1C314C4EDBB@GBHENXMB02.corp.amvescap.net>

Dear Peter,

many thanks for your swift reply and the enlightenment; much appreciated.  
I have cc'ed Achim as the package maintainer of zoo, in case this thread should have slipt his notice. Just curious, Achim, will there be a rank.zoo() function in a future release of your package?

Best,
Bernhard


>
>Pfaff, Bernhard Dr. wrote:
>> It seems, that in my previous emails the attached output 
>files got deleted, hence these are now copied below:
>>
>>   
>(If the MIME type is wrong, then that will happen.)
>
>Anyways, the root cause seems to be the new function .gt() which is
>related to
>
>    o   New generic function xtfrm() as an auxiliary helper for
>        sort(), order() and rank().  This should return a numeric
>        vector that sorts in the same way as its input.  The default
>        method supports any class with ==, > and is.na() methods but
>        specific methods can be much faster.
>
>        As a side-effect, rank() will now work better on classed
>        objects, although possibly rather slowly.
>
>Here, "better" may be in the eyes of the beholder, for
>
>> dax[3]==dax[6]
>Data:
>logical(0)
>
>Index:
>integer(0)
>
>and accordingly
>
>> rank(dax)
>Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>  argument is of length zero
>
>which is the error that you are seeing.
>
>What to do about it is a bit dubious. Obviously, we don't want to "fix"
>.gt() so that it automatically unclasses objects, and I assume that zoo
>has its reasons for not wanting to compare series with different
>indices. So I suppose that either the user must unclass, or zoo define
>rank.zoo.
>
>> For R version 2.7.2:
>> ====================
>> R version 2.7.2 (2008-08-25)
>> Copyright (C) 2008 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
>> Sie sind eingeladen, es unter bestimmten Bedingungen weiter 
>zu verbreiten.
>> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
>>
>> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
>> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
>> um zu erfahren, wie R oder R packages in Publikationen 
>zitiert werden k?nnen.
>>
>> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line 
>Hilfe, oder
>> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
>> Tippen Sie 'q()', um R zu verlassen.
>>
>>
>> Invesco colors have been created!
>> Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
>> Type: 'invcolor' to see its definition.
>>
>> [Vorher gesicherter Workspace wiederhergestellt]
>>
>>   
>>> library(zoo)
>>>     
>>
>> Attache Paket: 'zoo'
>>
>>
>> 	The following object(s) are masked from package:base :
>>
>> 	 as.Date.numeric 
>>
>> Warning message:
>> Paket 'zoo' wurde unter R Version 2.8.0 gebaut 
>>   
>>> sessionInfo()
>>>     
>> R version 2.7.2 (2008-08-25) 
>> i386-pc-mingw32 
>>
>> locale:
>> 
>LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_
>MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>>
>> attached base packages:
>> [1] stats     graphics  utils     datasets  grDevices 
>methods   base     
>>
>> other attached packages:
>> [1] zoo_1.5-4
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.7.2      lattice_0.17-13
>>   
>>> search()
>>>     
>>  [1] ".GlobalEnv"        "package:zoo"       "package:stats"    
>>  [4] "package:graphics"  "package:utils"     "package:datasets" 
>>  [7] "package:grDevices" "package:methods"   "Autoloads"        
>> [10] "package:base"     
>>   
>>> packageDescription("zoo")
>>>     
>> Package: zoo
>> Version: 1.5-4
>> Date: 2008-07-09
>> Title: Z's ordered observations
>> Author: Achim Zeileis, Gabor Grothendieck
>> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
>> Description: An S3 class with methods for totally ordered indexed
>>         observations. It is particularly aimed at irregular 
>time series
>>         of numeric vectors/matrices and factors. zoo's key 
>design goals
>>         are independence of a particular index/date/time class and
>>         consistency with with ts and base R by providing methods to
>>         extend standard generics.
>> Depends: R (>= 2.4.1), stats
>> Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
>>         strucchange, DAAG, xts
>> Imports: stats, utils, graphics, grDevices, lattice
>> LazyLoad: yes
>> License: GPL-2
>> URL: http://R-Forge.R-project.org/projects/zoo/
>> Packaged: Wed Jul 9 18:28:07 2008; zeileis
>> Built: R 2.8.0; ; 2008-10-16 00:01:11; windows
>>
>> -- File: C:/R/package/zoo/Meta/package.rds 
>>   
>>> data(EuStockMarkets)
>>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>>> daxr <- diff(log(dax))
>>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>>     
>> [1] TRUE
>> Warning messages:
>> 1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>> 2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>>   
>>> qqnorm(coredata(daxr))
>>> qqnorm(daxr)
>>>
>>> proc.time()
>>>     
>>        User      System verstrichen 
>>        1.65        0.13        2.97 
>>
>> For R version 2.8.0:
>> ====================
>>  version 2.8.0 (2008-10-20)
>> Copyright (C) 2008 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
>> Sie sind eingeladen, es unter bestimmten Bedingungen weiter 
>zu verbreiten.
>> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
>>
>> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
>> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
>> um zu erfahren, wie R oder R packages in Publikationen 
>zitiert werden k?nnen.
>>
>> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line 
>Hilfe, oder
>> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
>> Tippen Sie 'q()', um R zu verlassen.
>>
>>
>> Invesco colors have been created!
>> Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
>> Type: 'invcolor' to see its definition.
>>
>> [Vorher gesicherter Workspace wiederhergestellt]
>>
>>   
>>> library(zoo)
>>>     
>>
>> Attache Paket: 'zoo'
>>
>>
>> 	The following object(s) are masked from package:base :
>>
>> 	 as.Date.numeric 
>>
>>   
>>> sessionInfo()
>>>     
>> R version 2.8.0 (2008-10-20) 
>> i386-pc-mingw32 
>>
>> locale:
>> 
>LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_
>MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>>
>> attached base packages:
>> [1] stats     graphics  utils     datasets  grDevices 
>methods   base     
>>
>> other attached packages:
>> [1] zoo_1.5-4
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.8.0      lattice_0.17-15
>>   
>>> search()
>>>     
>>  [1] ".GlobalEnv"        "package:zoo"       "package:stats"    
>>  [4] "package:graphics"  "package:utils"     "package:datasets" 
>>  [7] "package:grDevices" "package:methods"   "Autoloads"        
>> [10] "package:base"     
>>   
>>> packageDescription("zoo")
>>>     
>> Package: zoo
>> Version: 1.5-4
>> Date: 2008-07-09
>> Title: Z's ordered observations
>> Author: Achim Zeileis, Gabor Grothendieck
>> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
>> Description: An S3 class with methods for totally ordered indexed
>>         observations. It is particularly aimed at irregular 
>time series
>>         of numeric vectors/matrices and factors. zoo's key 
>design goals
>>         are independence of a particular index/date/time class and
>>         consistency with with ts and base R by providing methods to
>>         extend standard generics.
>> Depends: R (>= 2.4.1), stats
>> Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
>>         strucchange, DAAG, xts
>> Imports: stats, utils, graphics, grDevices, lattice
>> LazyLoad: yes
>> License: GPL-2
>> URL: http://R-Forge.R-project.org/projects/zoo/
>> Packaged: Wed Jul 9 18:28:07 2008; zeileis
>> Built: R 2.8.0; ; 2008-10-16 00:01:11; windows
>>
>> -- File: C:/R/package/zoo/Meta/package.rds 
>>   
>>> data(EuStockMarkets)
>>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>>> daxr <- diff(log(dax))
>>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>>     
>> [1] TRUE
>> Warning messages:
>> 1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>> 2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>>   
>>> qqnorm(coredata(daxr))
>>> qqnorm(daxr)
>>>     
>> Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
>>   Argument hat L?nge 0
>> Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
>> Ausf?hrung angehalten
>>
>>
>>   
>>> Dear list-reader,
>>>
>>> by running the following script:
>>>
>>> library(zoo)
>>> sessionInfo()
>>> search()
>>> packageDescription("zoo")
>>> data(EuStockMarkets)
>>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>>> daxr <- diff(log(dax))
>>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>> qqnorm(coredata(daxr))
>>> qqnorm(daxr)
>>>
>>>
>>> qqnorm() produces an error:
>>>
>>>     
>>>> qqnorm(daxr)
>>>>       
>>> Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L : 
>>>  Argument hat L?nge 0
>>> Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> 
>switch -> .gt
>>> Ausf?hrung angehalten
>>>
>>>
>>> However, this is not witnessed by running the script through R 
>>> 2.7.2 (attached are the two output files). Incidentally, the 
>>> QQ-plot is produced if one uses "qqnorm(coredata(daxr))" under 
>>> R version 2.8.0. After having read both NEWS on CRAN (General 
>>> and Windows specific) I still could not figure out what causes 
>>> this result. The version of package zoo is the same and the 
>>> results do not change if I use the zoo package built under R 
>>> version 2.7.2 with R version 2.7.2 or the one that has been 
>>> built under R version 2.8.0.
>>>
>>> Any hints and enlightenment are most welcome.
>>>
>>> Best,
>>> Bernhard
>>>
>>>
>>> *****************************************************************
>>> Confidentiality Note: The information contained in this message,
>>> and any attachments, may contain confidential and/or privileged
>>> material. It is intended solely for the person(s) or entity to
>>> which it is addressed. Any review, retransmission, dissemination,
>>> or taking of any action in reliance upon this information by
>>> persons or entities other than the intended recipient(s) is
>>> prohibited. If you received this in error, please contact the
>>> sender and delete the material from any computer.
>>> *****************************************************************
>>>
>>>     
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>   
>
>
>-- 
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  
>(+45) 35327918
>~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: 
>(+45) 35327907
>
>
>


From ggrothendieck at gmail.com  Wed Oct 22 15:21:08 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 22 Oct 2008 09:21:08 -0400
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <48FF215E.80807@biostat.ku.dk>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
Message-ID: <971536df0810220621w65286e3emc1efe749afa866b5@mail.gmail.com>

xtfrm.zoo has been added to the development version of zoo and should
address this.  It is available on R-Forge or in the meantime you can just
add this line to your code:

xtfrm.zoo <- coredata


On Wed, Oct 22, 2008 at 8:49 AM, Peter Dalgaard
<P.Dalgaard at biostat.ku.dk> wrote:
> Pfaff, Bernhard Dr. wrote:
>> It seems, that in my previous emails the attached output files got deleted, hence these are now copied below:
>>
>>
> (If the MIME type is wrong, then that will happen.)
>
> Anyways, the root cause seems to be the new function .gt() which is
> related to
>
>    o   New generic function xtfrm() as an auxiliary helper for
>        sort(), order() and rank().  This should return a numeric
>        vector that sorts in the same way as its input.  The default
>        method supports any class with ==, > and is.na() methods but
>        specific methods can be much faster.
>
>        As a side-effect, rank() will now work better on classed
>        objects, although possibly rather slowly.
>
> Here, "better" may be in the eyes of the beholder, for
>
>> dax[3]==dax[6]
> Data:
> logical(0)
>
> Index:
> integer(0)
>
> and accordingly
>
>> rank(dax)
> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>  argument is of length zero
>
> which is the error that you are seeing.
>
> What to do about it is a bit dubious. Obviously, we don't want to "fix"
> .gt() so that it automatically unclasses objects, and I assume that zoo
> has its reasons for not wanting to compare series with different
> indices. So I suppose that either the user must unclass, or zoo define
> rank.zoo.
>
>> For R version 2.7.2:
>> ====================
>> R version 2.7.2 (2008-08-25)
>> Copyright (C) 2008 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
>> Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
>> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
>>
>> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
>> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
>> um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.
>>
>> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
>> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
>> Tippen Sie 'q()', um R zu verlassen.
>>
>>
>> Invesco colors have been created!
>> Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
>> Type: 'invcolor' to see its definition.
>>
>> [Vorher gesicherter Workspace wiederhergestellt]
>>
>>
>>> library(zoo)
>>>
>>
>> Attache Paket: 'zoo'
>>
>>
>>       The following object(s) are masked from package:base :
>>
>>        as.Date.numeric
>>
>> Warning message:
>> Paket 'zoo' wurde unter R Version 2.8.0 gebaut
>>
>>> sessionInfo()
>>>
>> R version 2.7.2 (2008-08-25)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>>
>> attached base packages:
>> [1] stats     graphics  utils     datasets  grDevices methods   base
>>
>> other attached packages:
>> [1] zoo_1.5-4
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.7.2      lattice_0.17-13
>>
>>> search()
>>>
>>  [1] ".GlobalEnv"        "package:zoo"       "package:stats"
>>  [4] "package:graphics"  "package:utils"     "package:datasets"
>>  [7] "package:grDevices" "package:methods"   "Autoloads"
>> [10] "package:base"
>>
>>> packageDescription("zoo")
>>>
>> Package: zoo
>> Version: 1.5-4
>> Date: 2008-07-09
>> Title: Z's ordered observations
>> Author: Achim Zeileis, Gabor Grothendieck
>> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
>> Description: An S3 class with methods for totally ordered indexed
>>         observations. It is particularly aimed at irregular time series
>>         of numeric vectors/matrices and factors. zoo's key design goals
>>         are independence of a particular index/date/time class and
>>         consistency with with ts and base R by providing methods to
>>         extend standard generics.
>> Depends: R (>= 2.4.1), stats
>> Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
>>         strucchange, DAAG, xts
>> Imports: stats, utils, graphics, grDevices, lattice
>> LazyLoad: yes
>> License: GPL-2
>> URL: http://R-Forge.R-project.org/projects/zoo/
>> Packaged: Wed Jul 9 18:28:07 2008; zeileis
>> Built: R 2.8.0; ; 2008-10-16 00:01:11; windows
>>
>> -- File: C:/R/package/zoo/Meta/package.rds
>>
>>> data(EuStockMarkets)
>>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>>> daxr <- diff(log(dax))
>>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>>
>> [1] TRUE
>> Warning messages:
>> 1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>> 2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>>
>>> qqnorm(coredata(daxr))
>>> qqnorm(daxr)
>>>
>>> proc.time()
>>>
>>        User      System verstrichen
>>        1.65        0.13        2.97
>>
>> For R version 2.8.0:
>> ====================
>>  version 2.8.0 (2008-10-20)
>> Copyright (C) 2008 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R ist freie Software und kommt OHNE JEGLICHE GARANTIE.
>> Sie sind eingeladen, es unter bestimmten Bedingungen weiter zu verbreiten.
>> Tippen Sie 'license()' or 'licence()' f?r Details dazu.
>>
>> R ist ein Gemeinschaftsprojekt mit vielen Beitragenden.
>> Tippen Sie 'contributors()' f?r mehr Information und 'citation()',
>> um zu erfahren, wie R oder R packages in Publikationen zitiert werden k?nnen.
>>
>> Tippen Sie 'demo()' f?r einige Demos, 'help()' f?r on-line Hilfe, oder
>> 'help.start()' f?r eine HTML Browserschnittstelle zur Hilfe.
>> Tippen Sie 'q()', um R zu verlassen.
>>
>>
>> Invesco colors have been created!
>> Usage: "col = invcolor[1]", or "col = invcolor['blue']" etc.
>> Type: 'invcolor' to see its definition.
>>
>> [Vorher gesicherter Workspace wiederhergestellt]
>>
>>
>>> library(zoo)
>>>
>>
>> Attache Paket: 'zoo'
>>
>>
>>       The following object(s) are masked from package:base :
>>
>>        as.Date.numeric
>>
>>
>>> sessionInfo()
>>>
>> R version 2.8.0 (2008-10-20)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=German_Germany.1252;LC_CTYPE=German_Germany.1252;LC_MONETARY=German_Germany.1252;LC_NUMERIC=C;LC_TIME=German_Germany.1252
>>
>> attached base packages:
>> [1] stats     graphics  utils     datasets  grDevices methods   base
>>
>> other attached packages:
>> [1] zoo_1.5-4
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.8.0      lattice_0.17-15
>>
>>> search()
>>>
>>  [1] ".GlobalEnv"        "package:zoo"       "package:stats"
>>  [4] "package:graphics"  "package:utils"     "package:datasets"
>>  [7] "package:grDevices" "package:methods"   "Autoloads"
>> [10] "package:base"
>>
>>> packageDescription("zoo")
>>>
>> Package: zoo
>> Version: 1.5-4
>> Date: 2008-07-09
>> Title: Z's ordered observations
>> Author: Achim Zeileis, Gabor Grothendieck
>> Maintainer: Achim Zeileis <Achim.Zeileis at R-project.org>
>> Description: An S3 class with methods for totally ordered indexed
>>         observations. It is particularly aimed at irregular time series
>>         of numeric vectors/matrices and factors. zoo's key design goals
>>         are independence of a particular index/date/time class and
>>         consistency with with ts and base R by providing methods to
>>         extend standard generics.
>> Depends: R (>= 2.4.1), stats
>> Suggests: chron, fCalendar, fSeries, its, tseries, lattice,
>>         strucchange, DAAG, xts
>> Imports: stats, utils, graphics, grDevices, lattice
>> LazyLoad: yes
>> License: GPL-2
>> URL: http://R-Forge.R-project.org/projects/zoo/
>> Packaged: Wed Jul 9 18:28:07 2008; zeileis
>> Built: R 2.8.0; ; 2008-10-16 00:01:11; windows
>>
>> -- File: C:/R/package/zoo/Meta/package.rds
>>
>>> data(EuStockMarkets)
>>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>>> daxr <- diff(log(dax))
>>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>>
>> [1] TRUE
>> Warning messages:
>> 1: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>> 2: In qnorm(p, mean, sd, lower.tail, log.p) : NaNs wurden erzeugt
>>
>>> qqnorm(coredata(daxr))
>>> qqnorm(daxr)
>>>
>> Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>   Argument hat L?nge 0
>> Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
>> Ausf?hrung angehalten
>>
>>
>>
>>> Dear list-reader,
>>>
>>> by running the following script:
>>>
>>> library(zoo)
>>> sessionInfo()
>>> search()
>>> packageDescription("zoo")
>>> data(EuStockMarkets)
>>> dax <- as.zoo(EuStockMarkets[1:10, "DAX"])
>>> daxr <- diff(log(dax))
>>> identical(as.vector(qnorm(daxr)), qnorm(coredata(daxr)))
>>> qqnorm(coredata(daxr))
>>> qqnorm(daxr)
>>>
>>>
>>> qqnorm() produces an error:
>>>
>>>
>>>> qqnorm(daxr)
>>>>
>>> Fehler in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>  Argument hat L?nge 0
>>> Calls: qqnorm ... xtfrm.default -> as.vector -> rank -> switch -> .gt
>>> Ausf?hrung angehalten
>>>
>>>
>>> However, this is not witnessed by running the script through R
>>> 2.7.2 (attached are the two output files). Incidentally, the
>>> QQ-plot is produced if one uses "qqnorm(coredata(daxr))" under
>>> R version 2.8.0. After having read both NEWS on CRAN (General
>>> and Windows specific) I still could not figure out what causes
>>> this result. The version of package zoo is the same and the
>>> results do not change if I use the zoo package built under R
>>> version 2.7.2 with R version 2.7.2 or the one that has been
>>> built under R version 2.8.0.
>>>
>>> Any hints and enlightenment are most welcome.
>>>
>>> Best,
>>> Bernhard
>>>
>>>
>>> *****************************************************************
>>> Confidentiality Note: The information contained in this message,
>>> and any attachments, may contain confidential and/or privileged
>>> material. It is intended solely for the person(s) or entity to
>>> which it is addressed. Any review, retransmission, dissemination,
>>> or taking of any action in reliance upon this information by
>>> persons or entities other than the intended recipient(s) is
>>> prohibited. If you received this in error, please contact the
>>> sender and delete the material from any computer.
>>> *****************************************************************
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ggrothendieck at gmail.com  Wed Oct 22 18:33:49 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 22 Oct 2008 12:33:49 -0400
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <48FF215E.80807@biostat.ku.dk>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
Message-ID: <971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>

On Wed, Oct 22, 2008 at 8:49 AM, Peter Dalgaard
<P.Dalgaard at biostat.ku.dk> wrote:
> Pfaff, Bernhard Dr. wrote:
>> It seems, that in my previous emails the attached output files got deleted, hence these are now copied below:
>>
>>
> (If the MIME type is wrong, then that will happen.)
>
> Anyways, the root cause seems to be the new function .gt() which is
> related to
>
>    o   New generic function xtfrm() as an auxiliary helper for
>        sort(), order() and rank().  This should return a numeric
>        vector that sorts in the same way as its input.  The default
>        method supports any class with ==, > and is.na() methods but
>        specific methods can be much faster.
>
>        As a side-effect, rank() will now work better on classed
>        objects, although possibly rather slowly.
>
> Here, "better" may be in the eyes of the beholder, for
>
>> dax[3]==dax[6]
> Data:
> logical(0)
>
> Index:
> integer(0)
>
> and accordingly
>
>> rank(dax)
> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>  argument is of length zero
>
> which is the error that you are seeing.
>
> What to do about it is a bit dubious. Obviously, we don't want to "fix"
> .gt() so that it automatically unclasses objects, and I assume that zoo
> has its reasons for not wanting to compare series with different
> indices. So I suppose that either the user must unclass, or zoo define
> rank.zoo.

Actually qqnorm does not use rank but it does use order and with the
xtfrm.zoo method I mentioned qqnorm works with zoo; however, I think
rank needs to be fixed in R to make use of xtfrm as well since I would have
expected that supplying an xtfrm method for zoo would be sufficient to
get both order and rank to work without giving errors.  Also note that rank
is not generic.


From P.Dalgaard at biostat.ku.dk  Wed Oct 22 19:26:46 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 22 Oct 2008 19:26:46 +0200
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>	
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>	
	<48FF215E.80807@biostat.ku.dk>
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
Message-ID: <48FF6256.8080702@biostat.ku.dk>

Gabor Grothendieck wrote:
> On Wed, Oct 22, 2008 at 8:49 AM, Peter Dalgaard
> <P.Dalgaard at biostat.ku.dk> wrote:
>   
>> Pfaff, Bernhard Dr. wrote:
>>     
>>> It seems, that in my previous emails the attached output files got deleted, hence these are now copied below:
>>>
>>>
>>>       
>> (If the MIME type is wrong, then that will happen.)
>>
>> Anyways, the root cause seems to be the new function .gt() which is
>> related to
>>
>>    o   New generic function xtfrm() as an auxiliary helper for
>>        sort(), order() and rank().  This should return a numeric
>>        vector that sorts in the same way as its input.  The default
>>        method supports any class with ==, > and is.na() methods but
>>        specific methods can be much faster.
>>
>>        As a side-effect, rank() will now work better on classed
>>        objects, although possibly rather slowly.
>>
>> Here, "better" may be in the eyes of the beholder, for
>>
>>     
>>> dax[3]==dax[6]
>>>       
>> Data:
>> logical(0)
>>
>> Index:
>> integer(0)
>>
>> and accordingly
>>
>>     
>>> rank(dax)
>>>       
>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>  argument is of length zero
>>
>> which is the error that you are seeing.
>>
>> What to do about it is a bit dubious. Obviously, we don't want to "fix"
>> .gt() so that it automatically unclasses objects, and I assume that zoo
>> has its reasons for not wanting to compare series with different
>> indices. So I suppose that either the user must unclass, or zoo define
>> rank.zoo.
>>     
>
> Actually qqnorm does not use rank but it does use order and with the
> xtfrm.zoo method I mentioned qqnorm works with zoo; however, I think
> rank needs to be fixed in R to make use of xtfrm as well since I would have
> expected that supplying an xtfrm method for zoo would be sufficient to
> get both order and rank to work without giving errors.  Also note that rank
> is not generic.
>   
Notice that xtfrm.default() uses rank()....

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From ggrothendieck at gmail.com  Wed Oct 22 20:19:57 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 22 Oct 2008 14:19:57 -0400
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <48FF6256.8080702@biostat.ku.dk>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
	<48FF6256.8080702@biostat.ku.dk>
Message-ID: <971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>

Yes, I noticed that but rank is not generic.  An xtfrm.zoo
method has been added to zoo on R-Forge but rank still
fails:

> R.version.string
[1] "R version 2.8.0 Patched (2008-10-21 r46766)"
> packageDescription("zoo")$Version
[1] "1.5-3"
> library(zoo)
> # next line adds xtfrm zoo method
> xtfrm.zoo <- coredata
> z <- zoo(1:4)
> order(z) # ok
[1] 1 2 3 4
> qqnorm(z) # ok
> rank(z) # error
Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
  argument is of length zero


>>>>
>>> (If the MIME type is wrong, then that will happen.)
>>>
>>> Anyways, the root cause seems to be the new function .gt() which is
>>> related to
>>>
>>>    o   New generic function xtfrm() as an auxiliary helper for
>>>        sort(), order() and rank().  This should return a numeric
>>>        vector that sorts in the same way as its input.  The default
>>>        method supports any class with ==, > and is.na() methods but
>>>        specific methods can be much faster.
>>>
>>>        As a side-effect, rank() will now work better on classed
>>>        objects, although possibly rather slowly.
>>>
>>> Here, "better" may be in the eyes of the beholder, for
>>>
>>>
>>>> dax[3]==dax[6]
>>>>
>>> Data:
>>> logical(0)
>>>
>>> Index:
>>> integer(0)
>>>
>>> and accordingly
>>>
>>>
>>>> rank(dax)
>>>>
>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>  argument is of length zero
>>>
>>> which is the error that you are seeing.
>>>
>>> What to do about it is a bit dubious. Obviously, we don't want to "fix"
>>> .gt() so that it automatically unclasses objects, and I assume that zoo
>>> has its reasons for not wanting to compare series with different
>>> indices. So I suppose that either the user must unclass, or zoo define
>>> rank.zoo.
>>>
>>
>> Actually qqnorm does not use rank but it does use order and with the
>> xtfrm.zoo method I mentioned qqnorm works with zoo; however, I think
>> rank needs to be fixed in R to make use of xtfrm as well since I would have
>> expected that supplying an xtfrm method for zoo would be sufficient to
>> get both order and rank to work without giving errors.  Also note that rank
>> is not generic.
>>
> Notice that xtfrm.default() uses rank()....
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
>
>


From ggrothendieck at gmail.com  Wed Oct 22 21:09:25 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 22 Oct 2008 15:09:25 -0400
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
	<48FF6256.8080702@biostat.ku.dk>
	<971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>
Message-ID: <971536df0810221209x67e67bf2l1ed16e2a612db863@mail.gmail.com>

And one other point.

z <- zoo(1:4)
.gt(z, 1, 2)

fails because z[1] and z[2] are at different time points so

   z[1] == z[2]

is logical(0) because when zoo compares objects it aligns them
first.

On Wed, Oct 22, 2008 at 2:19 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> Yes, I noticed that but rank is not generic.  An xtfrm.zoo
> method has been added to zoo on R-Forge but rank still
> fails:
>
>> R.version.string
> [1] "R version 2.8.0 Patched (2008-10-21 r46766)"
>> packageDescription("zoo")$Version
> [1] "1.5-3"
>> library(zoo)
>> # next line adds xtfrm zoo method
>> xtfrm.zoo <- coredata
>> z <- zoo(1:4)
>> order(z) # ok
> [1] 1 2 3 4
>> qqnorm(z) # ok
>> rank(z) # error
> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>  argument is of length zero
>
>
>>>>>
>>>> (If the MIME type is wrong, then that will happen.)
>>>>
>>>> Anyways, the root cause seems to be the new function .gt() which is
>>>> related to
>>>>
>>>>    o   New generic function xtfrm() as an auxiliary helper for
>>>>        sort(), order() and rank().  This should return a numeric
>>>>        vector that sorts in the same way as its input.  The default
>>>>        method supports any class with ==, > and is.na() methods but
>>>>        specific methods can be much faster.
>>>>
>>>>        As a side-effect, rank() will now work better on classed
>>>>        objects, although possibly rather slowly.
>>>>
>>>> Here, "better" may be in the eyes of the beholder, for
>>>>
>>>>
>>>>> dax[3]==dax[6]
>>>>>
>>>> Data:
>>>> logical(0)
>>>>
>>>> Index:
>>>> integer(0)
>>>>
>>>> and accordingly
>>>>
>>>>
>>>>> rank(dax)
>>>>>
>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>  argument is of length zero
>>>>
>>>> which is the error that you are seeing.
>>>>
>>>> What to do about it is a bit dubious. Obviously, we don't want to "fix"
>>>> .gt() so that it automatically unclasses objects, and I assume that zoo
>>>> has its reasons for not wanting to compare series with different
>>>> indices. So I suppose that either the user must unclass, or zoo define
>>>> rank.zoo.
>>>>
>>>
>>> Actually qqnorm does not use rank but it does use order and with the
>>> xtfrm.zoo method I mentioned qqnorm works with zoo; however, I think
>>> rank needs to be fixed in R to make use of xtfrm as well since I would have
>>> expected that supplying an xtfrm method for zoo would be sufficient to
>>> get both order and rank to work without giving errors.  Also note that rank
>>> is not generic.
>>>
>> Notice that xtfrm.default() uses rank()....
>>
>> --
>>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>>
>>
>>
>


From Achim.Zeileis at R-project.org  Wed Oct 22 17:45:53 2008
From: Achim.Zeileis at R-project.org (Achim Zeileis)
Date: Wed, 22 Oct 2008 17:45:53 +0200 (CEST)
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <B89F0CE41D45644A97CCC93DF548C1C314C4EDBB@GBHENXMB02.corp.amvescap.net>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
	<B89F0CE41D45644A97CCC93DF548C1C314C4EDBB@GBHENXMB02.corp.amvescap.net>
Message-ID: <Pine.LNX.4.64.0810221737140.4024@paninaro.stat-math.wu-wien.ac.at>

On Wed, 22 Oct 2008, Pfaff, Bernhard Dr. wrote:

> Dear Peter,
>
> many thanks for your swift reply and the enlightenment; much appreciated.
> I have cc'ed Achim as the package maintainer of zoo,

...and I have added Gabor, just in case.

> in case this thread should have slipt his notice. Just curious, Achim, 
> will there be a rank.zoo() function in a future release of your package?

I'm not sure - my first reaction would be "no". With time series, there 
might be confusion between sorting/ordering/ranking with respect to the 
observations vs. with respect to the time index. To clarify that you want 
some operation with respect to the data, you can easily say
   sort(coredata(z))
etc. This is rather evocative and not that much longer to type than 
sort(z). And it would be unclear what the latter should mean exactly.

In the case of rank(z), one could argue that it is meaningful...but 
providing rank() without sort() or order() methods might again be 
confusing. My first impression would be that the cons outweigh the pros.
Z


From ifellows at ucsd.edu  Wed Oct 22 22:48:32 2008
From: ifellows at ucsd.edu (Ian Fellows)
Date: Wed, 22 Oct 2008 13:48:32 -0700
Subject: [Rd] Possible GPL Violation
Message-ID: <B3A3307C877E4E3E87A77503130815AD@gpbdmx>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081022/a4e29b93/attachment.pl>

From p.dalgaard at biostat.ku.dk  Wed Oct 22 23:03:40 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 22 Oct 2008 23:03:40 +0200
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <971536df0810221209x67e67bf2l1ed16e2a612db863@mail.gmail.com>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>	
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>	
	<48FF215E.80807@biostat.ku.dk>	
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>	
	<48FF6256.8080702@biostat.ku.dk>	
	<971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>
	<971536df0810221209x67e67bf2l1ed16e2a612db863@mail.gmail.com>
Message-ID: <48FF952C.3040809@biostat.ku.dk>

Gabor Grothendieck wrote:
> And one other point.
> 
> z <- zoo(1:4)
> .gt(z, 1, 2)
> 
> fails because z[1] and z[2] are at different time points so
> 
>    z[1] == z[2]
> 
> is logical(0) because when zoo compares objects it aligns them
> first.

Yes, that was the point that I was trying to make. Well, arguably it 
doesn't "fail", it just does what it is supposed to do. Things would 
"work" with [[ or a preceding unclass(z), but that would break 
comparisons involving, say, POSIXlt objects. So you're sort of stuck 
between a rock and a hard place.

> 
> On Wed, Oct 22, 2008 at 2:19 PM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>> Yes, I noticed that but rank is not generic.  An xtfrm.zoo
>> method has been added to zoo on R-Forge but rank still
>> fails:
>>
>>> R.version.string
>> [1] "R version 2.8.0 Patched (2008-10-21 r46766)"
>>> packageDescription("zoo")$Version
>> [1] "1.5-3"
>>> library(zoo)
>>> # next line adds xtfrm zoo method
>>> xtfrm.zoo <- coredata
>>> z <- zoo(1:4)
>>> order(z) # ok
>> [1] 1 2 3 4
>>> qqnorm(z) # ok
>>> rank(z) # error
>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>  argument is of length zero
>>
>>
>>>>> (If the MIME type is wrong, then that will happen.)
>>>>>
>>>>> Anyways, the root cause seems to be the new function .gt() which is
>>>>> related to
>>>>>
>>>>>    o   New generic function xtfrm() as an auxiliary helper for
>>>>>        sort(), order() and rank().  This should return a numeric
>>>>>        vector that sorts in the same way as its input.  The default
>>>>>        method supports any class with ==, > and is.na() methods but
>>>>>        specific methods can be much faster.
>>>>>
>>>>>        As a side-effect, rank() will now work better on classed
>>>>>        objects, although possibly rather slowly.
>>>>>
>>>>> Here, "better" may be in the eyes of the beholder, for
>>>>>
>>>>>
>>>>>> dax[3]==dax[6]
>>>>>>
>>>>> Data:
>>>>> logical(0)
>>>>>
>>>>> Index:
>>>>> integer(0)
>>>>>
>>>>> and accordingly
>>>>>
>>>>>
>>>>>> rank(dax)
>>>>>>
>>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>>  argument is of length zero
>>>>>
>>>>> which is the error that you are seeing.
>>>>>
>>>>> What to do about it is a bit dubious. Obviously, we don't want to "fix"
>>>>> .gt() so that it automatically unclasses objects, and I assume that zoo
>>>>> has its reasons for not wanting to compare series with different
>>>>> indices. So I suppose that either the user must unclass, or zoo define
>>>>> rank.zoo.
>>>>>
>>>> Actually qqnorm does not use rank but it does use order and with the
>>>> xtfrm.zoo method I mentioned qqnorm works with zoo; however, I think
>>>> rank needs to be fixed in R to make use of xtfrm as well since I would have
>>>> expected that supplying an xtfrm method for zoo would be sufficient to
>>>> get both order and rank to work without giving errors.  Also note that rank
>>>> is not generic.
>>>>
>>> Notice that xtfrm.default() uses rank()....
>>>
>>> --
>>>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
>>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>>>
>>>
>>>


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From b.rowlingson at lancaster.ac.uk  Wed Oct 22 23:17:58 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 22 Oct 2008 22:17:58 +0100
Subject: [Rd] Possible GPL Violation
In-Reply-To: <B3A3307C877E4E3E87A77503130815AD@gpbdmx>
References: <B3A3307C877E4E3E87A77503130815AD@gpbdmx>
Message-ID: <d8ad40b50810221417j617b6e0lf62fec1308156d06@mail.gmail.com>

> It seems unlikely that the functionality of this program can be separated
> from the R-packages upon which it relies, thus making them one work subject
> to GPL. Does anyone have any experience with this software/company? Any
> thoughts?

 They're not distributing R itself:

 "You must have R on your computer to use these programs.  R is
freeware and complete instructions for obtaining and installing it are
contained in ZumaStat."

 - and there's no reason why you can't distribute your own R functions
under any license you want.

 So, not a GPL violation in my opinion. Disclaimer: I am not a lawyer,
although I read some of my ex-girlfriend's contract law books...

Barry


From ifellows at ucsd.edu  Wed Oct 22 23:43:42 2008
From: ifellows at ucsd.edu (Ian Fellows)
Date: Wed, 22 Oct 2008 14:43:42 -0700
Subject: [Rd] Possible GPL Violation
In-Reply-To: <d8ad40b50810221417j617b6e0lf62fec1308156d06@mail.gmail.com>
Message-ID: <505574996E4F48D7861E71D46BAA8A71@gpbdmx>

Perhaps my understanding of GPL is lacking, but isn't this the reason that
GPL is different for LGPL? Linking to functions is allowed in the lesser
license, but not in GPL. 

>From the gpl faq:
---------------------------------------------------------------------
If a programming language interpreter is released under the GPL, does that
mean programs written to be interpreted by it must be under GPL-compatible
licenses?

    When the interpreter just interprets a language, the answer is no. The
interpreted program, to the interpreter, is just data; a free software
license like the GPL, based on copyright law, cannot limit what data you use
the interpreter on. You can run it on any data (interpreted program), any
way you like, and there are no requirements about licensing that data to
anyone.

    However, when the interpreter is extended to provide "bindings" to other
facilities (often, but not necessarily, libraries), the interpreted program
is effectively linked to the facilities it uses through these bindings. So
if these facilities are released under the GPL, the interpreted program that
uses them must be released in a GPL-compatible way. The JNI or Java Native
Interface is an example of such a binding mechanism; libraries that are
accessed in this way are linked dynamically with the Java programs that call
them. These libraries are also linked with the interpreter. If the
interpreter is linked statically with these libraries, or if it is designed
to link dynamically with these specific libraries, then it too needs to be
released in a GPL-compatible way.
-----------------------------------------------------------------------

My understanding of this is that any function can be distributed under any
terms that you wish, so long as they don't use any GPL higher level
functions (i.e. ones not directly implemented by the language). What
constitutes higher level is a little bit fuzzy to me, but I suppose that the
package Stats might qualify.

Ian

IANAL either, and I haven't read any contract law books. So please let me
know where I'm going astray (as I go astray often).




-----Original Message-----
From: b.rowlingson at googlemail.com [mailto:b.rowlingson at googlemail.com] On
Behalf Of Barry Rowlingson
Sent: Wednesday, October 22, 2008 2:18 PM
To: Ian Fellows
Cc: r-devel at r-project.org
Subject: Re: [Rd] Possible GPL Violation

> It seems unlikely that the functionality of this program can be separated
> from the R-packages upon which it relies, thus making them one work
subject
> to GPL. Does anyone have any experience with this software/company? Any
> thoughts?

 They're not distributing R itself:

 "You must have R on your computer to use these programs.  R is
freeware and complete instructions for obtaining and installing it are
contained in ZumaStat."

 - and there's no reason why you can't distribute your own R functions
under any license you want.

 So, not a GPL violation in my opinion. Disclaimer: I am not a lawyer,
although I read some of my ex-girlfriend's contract law books...

Barry


From p.dalgaard at biostat.ku.dk  Thu Oct 23 00:02:10 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 23 Oct 2008 00:02:10 +0200
Subject: [Rd] Possible GPL Violation
In-Reply-To: <B3A3307C877E4E3E87A77503130815AD@gpbdmx>
References: <B3A3307C877E4E3E87A77503130815AD@gpbdmx>
Message-ID: <48FFA2E2.8030709@biostat.ku.dk>

Ian Fellows wrote:
> Hi All,
> 
>  
> 
> I was cruising around today, and came across a company (ZumaStat) that adds
> additional statistics functionality to SPSS.
> 
>  
> 
>>From the Website:
> 
> http://www.zumastat.com/robust_statistics.htm
> 
>  
> 
> "ZumaStat provides a user friendly interface to access powerful statistical
> programs on robust statistics that are available in the computer package
> called R, which is available free.  Most of the R functions were written by
> Professor Rand Wilcox of the University of Southern California and are
> described in his three books:"
> 
>  
> 
> It seems unlikely that the functionality of this program can be separated
> from the R-packages upon which it relies, thus making them one work subject
> to GPL. Does anyone have any experience with this software/company? Any
> thoughts?

As far as I can see they are using R to run prof. Wilcox's R functions. 
This is not the same as the "robust" package. Judging from his website, 
prof. Wilcox doesn't believe in packaging nor licencing; all his 
functions are just stored in one big file. However, even if he had a GPL 
on his code, there's no telling whether he did a dual licencing deal 
with ZumaSoft. As it stands, I suspect that he's just happy with the 
exposure his books are getting.

That leaves the question of whether they might be infringing upon R 
itself. There ae some really murky legal areas around linking, plugins, 
and interfacing to GPL'd programs (when does something become a 
"derivative work"?), but I don't think this is a good case to test them out.


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From b.rowlingson at lancaster.ac.uk  Thu Oct 23 00:48:34 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 22 Oct 2008 23:48:34 +0100
Subject: [Rd] Possible GPL Violation
In-Reply-To: <505574996E4F48D7861E71D46BAA8A71@gpbdmx>
References: <d8ad40b50810221417j617b6e0lf62fec1308156d06@mail.gmail.com>
	<505574996E4F48D7861E71D46BAA8A71@gpbdmx>
Message-ID: <d8ad40b50810221548q1d2c3a18nf478dcef001b5b3c@mail.gmail.com>

2008/10/22 Ian Fellows <ifellows at ucsd.edu>:
> Perhaps my understanding of GPL is lacking, but isn't this the reason that
> GPL is different for LGPL? Linking to functions is allowed in the lesser
> license, but not in GPL.
>
> From the gpl faq:
> ---------------------------------------------------------------------
> If a programming language interpreter is released under the GPL, does that
> mean programs written to be interpreted by it must be under GPL-compatible
> licenses?
>
>    When the interpreter just interprets a language, the answer is no. The
> interpreted program, to the interpreter, is just data; a free software
> license like the GPL, based on copyright law, cannot limit what data you use
> the interpreter on. You can run it on any data (interpreted program), any
> way you like, and there are no requirements about licensing that data to
> anyone.
>
>    However, when the interpreter is extended to provide "bindings" to other
> facilities (often, but not necessarily, libraries), the interpreted program
> is effectively linked to the facilities it uses through these bindings. So
> if these facilities are released under the GPL, the interpreted program that
> uses them must be released in a GPL-compatible way. The JNI or Java Native
> Interface is an example of such a binding mechanism; libraries that are
> accessed in this way are linked dynamically with the Java programs that call
> them. These libraries are also linked with the interpreter. If the
> interpreter is linked statically with these libraries, or if it is designed
> to link dynamically with these specific libraries, then it too needs to be
> released in a GPL-compatible way.
> -----------------------------------------------------------------------
>
> My understanding of this is that any function can be distributed under any
> terms that you wish, so long as they don't use any GPL higher level
> functions (i.e. ones not directly implemented by the language). What
> constitutes higher level is a little bit fuzzy to me, but I suppose that the
> package Stats might qualify.

 I think the issue is with distributing the whole thing - R plus your
code - and what license you have to use. I can't be stopped from
releasing anything I write under whatever license I choose. So even if
I write some C code that links into R or even patches R, I can release
that C code on its own under any license I like.

 However I can't distribute that code *with R* and keep my code under
a non-GPL license. I can distribute them separately though.

 Also, I've been trying to figure out what this Robust Statistics
thing they are offering is exactly. It's not even for sale yet:

"The ZumaStat robust statistics package that interfaces with R is
offered separate from other ZumaStat programs.  The robust statistics
package is finished by I am waiting for SPSS to work out the bug
described below (in red) before I release it."

 which I fail to parse properly... But it's possible that it doesn't
contain much R code at all, and it's just data interchange between
SPSS and robust statistics functions included in R. This wouldn't make
the system a "single program".

 The law books were more interesting than the girlfriend...

Barry


From ggrothendieck at gmail.com  Thu Oct 23 02:35:34 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 22 Oct 2008 20:35:34 -0400
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <48FF952C.3040809@biostat.ku.dk>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
	<48FF6256.8080702@biostat.ku.dk>
	<971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>
	<971536df0810221209x67e67bf2l1ed16e2a612db863@mail.gmail.com>
	<48FF952C.3040809@biostat.ku.dk>
Message-ID: <971536df0810221735r475f4b06s40354351ea4fae05@mail.gmail.com>

I don't think its hopeless.  order works ok provided the underlying class
defines an xtfrm method.  I think rank should follow that route too.  Its
arguably the inconsistency between rank and order (order but not the
rank uses xtfrm) that causes the inconsistent behavior between the two.
If rank were also built on top of xtfrm then it would work as desired as
well.

On Wed, Oct 22, 2008 at 5:03 PM, Peter Dalgaard
<p.dalgaard at biostat.ku.dk> wrote:
> Gabor Grothendieck wrote:
>>
>> And one other point.
>>
>> z <- zoo(1:4)
>> .gt(z, 1, 2)
>>
>> fails because z[1] and z[2] are at different time points so
>>
>>   z[1] == z[2]
>>
>> is logical(0) because when zoo compares objects it aligns them
>> first.
>
> Yes, that was the point that I was trying to make. Well, arguably it doesn't
> "fail", it just does what it is supposed to do. Things would "work" with [[
> or a preceding unclass(z), but that would break comparisons involving, say,
> POSIXlt objects. So you're sort of stuck between a rock and a hard place.
>
>>
>> On Wed, Oct 22, 2008 at 2:19 PM, Gabor Grothendieck
>> <ggrothendieck at gmail.com> wrote:
>>>
>>> Yes, I noticed that but rank is not generic.  An xtfrm.zoo
>>> method has been added to zoo on R-Forge but rank still
>>> fails:
>>>
>>>> R.version.string
>>>
>>> [1] "R version 2.8.0 Patched (2008-10-21 r46766)"
>>>>
>>>> packageDescription("zoo")$Version
>>>
>>> [1] "1.5-3"
>>>>
>>>> library(zoo)
>>>> # next line adds xtfrm zoo method
>>>> xtfrm.zoo <- coredata
>>>> z <- zoo(1:4)
>>>> order(z) # ok
>>>
>>> [1] 1 2 3 4
>>>>
>>>> qqnorm(z) # ok
>>>> rank(z) # error
>>>
>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>  argument is of length zero
>>>
>>>
>>>>>> (If the MIME type is wrong, then that will happen.)
>>>>>>
>>>>>> Anyways, the root cause seems to be the new function .gt() which is
>>>>>> related to
>>>>>>
>>>>>>   o   New generic function xtfrm() as an auxiliary helper for
>>>>>>       sort(), order() and rank().  This should return a numeric
>>>>>>       vector that sorts in the same way as its input.  The default
>>>>>>       method supports any class with ==, > and is.na() methods but
>>>>>>       specific methods can be much faster.
>>>>>>
>>>>>>       As a side-effect, rank() will now work better on classed
>>>>>>       objects, although possibly rather slowly.
>>>>>>
>>>>>> Here, "better" may be in the eyes of the beholder, for
>>>>>>
>>>>>>
>>>>>>> dax[3]==dax[6]
>>>>>>>
>>>>>> Data:
>>>>>> logical(0)
>>>>>>
>>>>>> Index:
>>>>>> integer(0)
>>>>>>
>>>>>> and accordingly
>>>>>>
>>>>>>
>>>>>>> rank(dax)
>>>>>>>
>>>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>>>  argument is of length zero
>>>>>>
>>>>>> which is the error that you are seeing.
>>>>>>
>>>>>> What to do about it is a bit dubious. Obviously, we don't want to
>>>>>> "fix"
>>>>>> .gt() so that it automatically unclasses objects, and I assume that
>>>>>> zoo
>>>>>> has its reasons for not wanting to compare series with different
>>>>>> indices. So I suppose that either the user must unclass, or zoo define
>>>>>> rank.zoo.
>>>>>>
>>>>> Actually qqnorm does not use rank but it does use order and with the
>>>>> xtfrm.zoo method I mentioned qqnorm works with zoo; however, I think
>>>>> rank needs to be fixed in R to make use of xtfrm as well since I would
>>>>> have
>>>>> expected that supplying an xtfrm method for zoo would be sufficient to
>>>>> get both order and rank to work without giving errors.  Also note that
>>>>> rank
>>>>> is not generic.
>>>>>
>>>> Notice that xtfrm.default() uses rank()....
>>>>
>>>> --
>>>>  O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
>>>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>>>>
>>>>
>>>>
>
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>


From Bernhard_Pfaff at fra.invesco.com  Thu Oct 23 11:13:37 2008
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Thu, 23 Oct 2008 10:13:37 +0100
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <971536df0810221735r475f4b06s40354351ea4fae05@mail.gmail.com>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
	<48FF6256.8080702@biostat.ku.dk>
	<971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>
	<971536df0810221209x67e67bf2l1ed16e2a612db863@mail.gmail.com>
	<48FF952C.3040809@biostat.ku.dk>
	<971536df0810221735r475f4b06s40354351ea4fae05@mail.gmail.com>
Message-ID: <B89F0CE41D45644A97CCC93DF548C1C314C4F0F4@GBHENXMB02.corp.amvescap.net>

Dear Achim, Gabor, Jeff, Peter and remaining list-subscribers,

first, please accept my apologies for having started this thread. Given the avalanche of responses (some off-list) and the associated time stamps, some of you have almost pulled an all-nighter about this topic. I might have not have started this thread in the first place, if I would have known this.

I agree with Achim's view that a "not working for zoo objects" strategy is preferable compared to a "half-working for zoo objects" strategy.  I do not have either a problem by employing coredata(z) when necessary. Now, Gabor, you pointed out nicely that the culprit, namely that order() resides on top of xtfrm whereas rank() does not (this was voiced by you in an email to Peter and R-Devel, hence I inlucde these recipients again in this thread and the reason for doing this is also motivated by the following proposition):

You further pointed out that the problems wrt to rank and zoo-objects could be solved if rank() would, like order() does, reside on top of xtfrm. My question/proposal would then be to follow this approach, i.e. use xtfrm in rank. Now, I am not that deep into R nor an expert to judge whether this would cause problems/breaking existing R code in other instances; hence I appreciate feedback if this would be a feasible/desirable change in R-Devel.


Best,
Bernhard 

>-----Urspr?ngliche Nachricht-----
>Von: Gabor Grothendieck [mailto:ggrothendieck at gmail.com] 
>Gesendet: Donnerstag, 23. Oktober 2008 02:36
>An: Peter Dalgaard
>Cc: Pfaff, Bernhard Dr.; r-devel at stat.math.ethz.ch
>Betreff: Re: [Rd] R 2.8.0 qqnorm produces error with object of 
>class zoo?
>
>I don't think its hopeless.  order works ok provided the 
>underlying class
>defines an xtfrm method.  I think rank should follow that 
>route too.  Its
>arguably the inconsistency between rank and order (order but not the
>rank uses xtfrm) that causes the inconsistent behavior between the two.
>If rank were also built on top of xtfrm then it would work as 
>desired as
>well.
>
>On Wed, Oct 22, 2008 at 5:03 PM, Peter Dalgaard
><p.dalgaard at biostat.ku.dk> wrote:
>> Gabor Grothendieck wrote:
>>>
>>> And one other point.
>>>
>>> z <- zoo(1:4)
>>> .gt(z, 1, 2)
>>>
>>> fails because z[1] and z[2] are at different time points so
>>>
>>>   z[1] == z[2]
>>>
>>> is logical(0) because when zoo compares objects it aligns them
>>> first.
>>
>> Yes, that was the point that I was trying to make. Well, 
>arguably it doesn't
>> "fail", it just does what it is supposed to do. Things would 
>"work" with [[
>> or a preceding unclass(z), but that would break comparisons 
>involving, say,
>> POSIXlt objects. So you're sort of stuck between a rock and 
>a hard place.
>>
>>>
>>> On Wed, Oct 22, 2008 at 2:19 PM, Gabor Grothendieck
>>> <ggrothendieck at gmail.com> wrote:
>>>>
>>>> Yes, I noticed that but rank is not generic.  An xtfrm.zoo
>>>> method has been added to zoo on R-Forge but rank still
>>>> fails:
>>>>
>>>>> R.version.string
>>>>
>>>> [1] "R version 2.8.0 Patched (2008-10-21 r46766)"
>>>>>
>>>>> packageDescription("zoo")$Version
>>>>
>>>> [1] "1.5-3"
>>>>>
>>>>> library(zoo)
>>>>> # next line adds xtfrm zoo method
>>>>> xtfrm.zoo <- coredata
>>>>> z <- zoo(1:4)
>>>>> order(z) # ok
>>>>
>>>> [1] 1 2 3 4
>>>>>
>>>>> qqnorm(z) # ok
>>>>> rank(z) # error
>>>>
>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>  argument is of length zero
>>>>
>>>>
>>>>>>> (If the MIME type is wrong, then that will happen.)
>>>>>>>
>>>>>>> Anyways, the root cause seems to be the new function 
>.gt() which is
>>>>>>> related to
>>>>>>>
>>>>>>>   o   New generic function xtfrm() as an auxiliary helper for
>>>>>>>       sort(), order() and rank().  This should return a numeric
>>>>>>>       vector that sorts in the same way as its input.  
>The default
>>>>>>>       method supports any class with ==, > and is.na() 
>methods but
>>>>>>>       specific methods can be much faster.
>>>>>>>
>>>>>>>       As a side-effect, rank() will now work better on classed
>>>>>>>       objects, although possibly rather slowly.
>>>>>>>
>>>>>>> Here, "better" may be in the eyes of the beholder, for
>>>>>>>
>>>>>>>
>>>>>>>> dax[3]==dax[6]
>>>>>>>>
>>>>>>> Data:
>>>>>>> logical(0)
>>>>>>>
>>>>>>> Index:
>>>>>>> integer(0)
>>>>>>>
>>>>>>> and accordingly
>>>>>>>
>>>>>>>
>>>>>>>> rank(dax)
>>>>>>>>
>>>>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>>>>  argument is of length zero
>>>>>>>
>>>>>>> which is the error that you are seeing.
>>>>>>>
>>>>>>> What to do about it is a bit dubious. Obviously, we 
>don't want to
>>>>>>> "fix"
>>>>>>> .gt() so that it automatically unclasses objects, and I 
>assume that
>>>>>>> zoo
>>>>>>> has its reasons for not wanting to compare series with different
>>>>>>> indices. So I suppose that either the user must 
>unclass, or zoo define
>>>>>>> rank.zoo.
>>>>>>>
>>>>>> Actually qqnorm does not use rank but it does use order 
>and with the
>>>>>> xtfrm.zoo method I mentioned qqnorm works with zoo; 
>however, I think
>>>>>> rank needs to be fixed in R to make use of xtfrm as well 
>since I would
>>>>>> have
>>>>>> expected that supplying an xtfrm method for zoo would be 
>sufficient to
>>>>>> get both order and rank to work without giving errors.  
>Also note that
>>>>>> rank
>>>>>> is not generic.
>>>>>>
>>>>> Notice that xtfrm.default() uses rank()....
>>>>>
>>>>> --
>>>>>  O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>>>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>>>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  
>(+45) 35327918
>>>>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: 
>(+45) 35327907
>>>>>
>>>>>
>>>>>
>>
>>
>> --
>>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  
>(+45) 35327918
>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: 
>(+45) 35327907
>>
>
*****************************************************************
Confidentiality Note: The information contained in this ...{{dropped:10}}


From Rory.WINSTON at rbs.com  Thu Oct 23 12:38:37 2008
From: Rory.WINSTON at rbs.com (Rory.WINSTON at rbs.com)
Date: Thu, 23 Oct 2008 11:38:37 +0100
Subject: [Rd] Possible GPL Violation (Ian Fellows)
In-Reply-To: <mailman.15.1224756012.28175.r-devel@r-project.org>
References: <mailman.15.1224756012.28175.r-devel@r-project.org>
Message-ID: <F5AB27C222D4164382737207F9869F2B520324B323@LONMC01014.rbsres07.net>

<snip>The law books were more interesting than the girlfriend...</snip>

Ouch!!!

But this does raise one of the issues I have with the GPL and the GPL family of licenses - the constant confusion around what is and what is not permissible. It's a gray area (possibly deliberately so), and most coversations end up with numerous opinions being offered, all prefixed with "IANAL, but..". It's that and the perception that the GPL ismore about ideology than software that lead me to prefer BSD-type licenses for pretty much everything.

IANAL, IMHO, etc etc.

Rory


Rory Winston
RBS Global Banking & Markets
Office: +44 20 7085 4476


***********************************************************************************
The Royal Bank of Scotland plc. Registered in Scotland No 90312. Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB. 
Authorised and regulated by the Financial Services Authority 

This e-mail message is confidential and for use by the=2...{{dropped:22}}


From ggrothendieck at gmail.com  Thu Oct 23 13:16:42 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 23 Oct 2008 07:16:42 -0400
Subject: [Rd] R 2.8.0 qqnorm produces error with object of class zoo?
In-Reply-To: <B89F0CE41D45644A97CCC93DF548C1C314C4F0F4@GBHENXMB02.corp.amvescap.net>
References: <B89F0CE41D45644A97CCC93DF548C1C314C4EC88@GBHENXMB02.corp.amvescap.net>
	<B89F0CE41D45644A97CCC93DF548C1C314C4ECFB@GBHENXMB02.corp.amvescap.net>
	<48FF215E.80807@biostat.ku.dk>
	<971536df0810220933l6be9989aie61bd69c7978bd17@mail.gmail.com>
	<48FF6256.8080702@biostat.ku.dk>
	<971536df0810221119k1709874fl309a83ad41e246c4@mail.gmail.com>
	<971536df0810221209x67e67bf2l1ed16e2a612db863@mail.gmail.com>
	<48FF952C.3040809@biostat.ku.dk>
	<971536df0810221735r475f4b06s40354351ea4fae05@mail.gmail.com>
	<B89F0CE41D45644A97CCC93DF548C1C314C4F0F4@GBHENXMB02.corp.amvescap.net>
Message-ID: <971536df0810230416g4c12a6f1obaf8d68e77cc0c73@mail.gmail.com>

Based on the quote that Peter gave:

   o   New generic function xtfrm() as an auxiliary helper for
       sort(), order() and rank().  This should return a numeric
       vector that sorts in the same way as its input.  The default
       method supports any class with ==, > and is.na() methods but
       specific methods can be much faster.

       As a side-effect, rank() will now work better on classed
       objects, although possibly rather slowly.

it seems that it was the intention to have rank(x) use x only via xtfrm(x)
but that is not, in fact, how it works as defining xtfrm.zoo still
results in the
discussed error.

On Thu, Oct 23, 2008 at 5:13 AM, Pfaff, Bernhard Dr.
<Bernhard_Pfaff at fra.invesco.com> wrote:
> Dear Achim, Gabor, Jeff, Peter and remaining list-subscribers,
>
> first, please accept my apologies for having started this thread. Given the avalanche of responses (some off-list) and the associated time stamps, some of you have almost pulled an all-nighter about this topic. I might have not have started this thread in the first place, if I would have known this.
>
> I agree with Achim's view that a "not working for zoo objects" strategy is preferable compared to a "half-working for zoo objects" strategy.  I do not have either a problem by employing coredata(z) when necessary. Now, Gabor, you pointed out nicely that the culprit, namely that order() resides on top of xtfrm whereas rank() does not (this was voiced by you in an email to Peter and R-Devel, hence I inlucde these recipients again in this thread and the reason for doing this is also motivated by the following proposition):
>
> You further pointed out that the problems wrt to rank and zoo-objects could be solved if rank() would, like order() does, reside on top of xtfrm. My question/proposal would then be to follow this approach, i.e. use xtfrm in rank. Now, I am not that deep into R nor an expert to judge whether this would cause problems/breaking existing R code in other instances; hence I appreciate feedback if this would be a feasible/desirable change in R-Devel.
>
>
> Best,
> Bernhard
>
>>-----Urspr?ngliche Nachricht-----
>>Von: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
>>Gesendet: Donnerstag, 23. Oktober 2008 02:36
>>An: Peter Dalgaard
>>Cc: Pfaff, Bernhard Dr.; r-devel at stat.math.ethz.ch
>>Betreff: Re: [Rd] R 2.8.0 qqnorm produces error with object of
>>class zoo?
>>
>>I don't think its hopeless.  order works ok provided the
>>underlying class
>>defines an xtfrm method.  I think rank should follow that
>>route too.  Its
>>arguably the inconsistency between rank and order (order but not the
>>rank uses xtfrm) that causes the inconsistent behavior between the two.
>>If rank were also built on top of xtfrm then it would work as
>>desired as
>>well.
>>
>>On Wed, Oct 22, 2008 at 5:03 PM, Peter Dalgaard
>><p.dalgaard at biostat.ku.dk> wrote:
>>> Gabor Grothendieck wrote:
>>>>
>>>> And one other point.
>>>>
>>>> z <- zoo(1:4)
>>>> .gt(z, 1, 2)
>>>>
>>>> fails because z[1] and z[2] are at different time points so
>>>>
>>>>   z[1] == z[2]
>>>>
>>>> is logical(0) because when zoo compares objects it aligns them
>>>> first.
>>>
>>> Yes, that was the point that I was trying to make. Well,
>>arguably it doesn't
>>> "fail", it just does what it is supposed to do. Things would
>>"work" with [[
>>> or a preceding unclass(z), but that would break comparisons
>>involving, say,
>>> POSIXlt objects. So you're sort of stuck between a rock and
>>a hard place.
>>>
>>>>
>>>> On Wed, Oct 22, 2008 at 2:19 PM, Gabor Grothendieck
>>>> <ggrothendieck at gmail.com> wrote:
>>>>>
>>>>> Yes, I noticed that but rank is not generic.  An xtfrm.zoo
>>>>> method has been added to zoo on R-Forge but rank still
>>>>> fails:
>>>>>
>>>>>> R.version.string
>>>>>
>>>>> [1] "R version 2.8.0 Patched (2008-10-21 r46766)"
>>>>>>
>>>>>> packageDescription("zoo")$Version
>>>>>
>>>>> [1] "1.5-3"
>>>>>>
>>>>>> library(zoo)
>>>>>> # next line adds xtfrm zoo method
>>>>>> xtfrm.zoo <- coredata
>>>>>> z <- zoo(1:4)
>>>>>> order(z) # ok
>>>>>
>>>>> [1] 1 2 3 4
>>>>>>
>>>>>> qqnorm(z) # ok
>>>>>> rank(z) # error
>>>>>
>>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>>  argument is of length zero
>>>>>
>>>>>
>>>>>>>> (If the MIME type is wrong, then that will happen.)
>>>>>>>>
>>>>>>>> Anyways, the root cause seems to be the new function
>>.gt() which is
>>>>>>>> related to
>>>>>>>>
>>>>>>>>   o   New generic function xtfrm() as an auxiliary helper for
>>>>>>>>       sort(), order() and rank().  This should return a numeric
>>>>>>>>       vector that sorts in the same way as its input.
>>The default
>>>>>>>>       method supports any class with ==, > and is.na()
>>methods but
>>>>>>>>       specific methods can be much faster.
>>>>>>>>
>>>>>>>>       As a side-effect, rank() will now work better on classed
>>>>>>>>       objects, although possibly rather slowly.
>>>>>>>>
>>>>>>>> Here, "better" may be in the eyes of the beholder, for
>>>>>>>>
>>>>>>>>
>>>>>>>>> dax[3]==dax[6]
>>>>>>>>>
>>>>>>>> Data:
>>>>>>>> logical(0)
>>>>>>>>
>>>>>>>> Index:
>>>>>>>> integer(0)
>>>>>>>>
>>>>>>>> and accordingly
>>>>>>>>
>>>>>>>>
>>>>>>>>> rank(dax)
>>>>>>>>>
>>>>>>>> Error in if (xi == xj) 0L else if (xi > xj) 1L else -1L :
>>>>>>>>  argument is of length zero
>>>>>>>>
>>>>>>>> which is the error that you are seeing.
>>>>>>>>
>>>>>>>> What to do about it is a bit dubious. Obviously, we
>>don't want to
>>>>>>>> "fix"
>>>>>>>> .gt() so that it automatically unclasses objects, and I
>>assume that
>>>>>>>> zoo
>>>>>>>> has its reasons for not wanting to compare series with different
>>>>>>>> indices. So I suppose that either the user must
>>unclass, or zoo define
>>>>>>>> rank.zoo.
>>>>>>>>
>>>>>>> Actually qqnorm does not use rank but it does use order
>>and with the
>>>>>>> xtfrm.zoo method I mentioned qqnorm works with zoo;
>>however, I think
>>>>>>> rank needs to be fixed in R to make use of xtfrm as well
>>since I would
>>>>>>> have
>>>>>>> expected that supplying an xtfrm method for zoo would be
>>sufficient to
>>>>>>> get both order and rank to work without giving errors.
>>Also note that
>>>>>>> rank
>>>>>>> is not generic.
>>>>>>>
>>>>>> Notice that xtfrm.default() uses rank()....
>>>>>>
>>>>>> --
>>>>>>  O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>>>>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>>>>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:
>>(+45) 35327918
>>>>>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX:
>>(+45) 35327907
>>>>>>
>>>>>>
>>>>>>
>>>
>>>
>>> --
>>>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:
>>(+45) 35327918
>>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX:
>>(+45) 35327907
>>>
>>
> *****************************************************************
> Confidentiality Note: The information contained in this message,
> and any attachments, may contain confidential and/or privileged
> material. It is intended solely for the person(s) or entity to
> which it is addressed. Any review, retransmission, dissemination,
> or taking of any action in reliance upon this information by
> persons or entities other than the intended recipient(s) is
> prohibited. If you received this in error, please contact the
> sender and delete the material from any computer.
> *****************************************************************
>
>


From asherman at ksu.ru  Wed Oct 22 23:10:17 2008
From: asherman at ksu.ru (asherman at ksu.ru)
Date: Wed, 22 Oct 2008 23:10:17 +0200 (CEST)
Subject: [Rd] Can't open files containing russian letters in path (PR#13195)
Message-ID: <20081022211017.B9BA6282EF48@mail.pubhealth.ku.dk>

Full_Name: Arkady  Sherman
Version: 2.8.0
OS: Windows XP sp3 ntfs file system
Submission from: (NULL) (158.195.166.129)


Freshly installed version 2.7.2 works well, but 2.8.0 can't open files with
russian letters in its names. In error messages the letters are replaced with
different symbols.


From joe at novelcap.com  Thu Oct 23 16:45:04 2008
From: joe at novelcap.com (joe at novelcap.com)
Date: Thu, 23 Oct 2008 16:45:04 +0200 (CEST)
Subject: [Rd] normalizePath bug (PR#13199)
Message-ID: <20081023144504.33D9F282BEBF@mail.pubhealth.ku.dk>

Full_Name: Joseph Haykov
Version: 2.8.0
OS: Windows
Submission from: (NULL) (216.189.177.202)


normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")

returns: "\0354xl|\a&#144;\001?$v\001?y8"

instead of returning:

"C:\\Documents and Settings\\Joseph Haykov\\Local
Settings\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt"

By the way, this works correctly in version 2.6.2


From racinej at mcmaster.ca  Wed Oct 22 23:50:12 2008
From: racinej at mcmaster.ca (racinej at mcmaster.ca)
Date: Wed, 22 Oct 2008 23:50:12 +0200 (CEST)
Subject: [Rd] Potential improvement to boxplot when outline=FALSE is set?
	(PR#13196)
Message-ID: <20081022215012.81CF3282EF48@mail.pubhealth.ku.dk>

Hi.

I have recently noticed that when using boxplot with outline=FALSE, the
default ylim (xlim if horizontal=TRUE) might be improved on. The default
can result in much wasted display and hard to read plots. A simple
snippet of test code is given below that illustrates the issue along
with a suggested improvement.

Thanks ever so much for your wonderful and ongoing contributions to the
open source community.

## Demonstration code to illustrate that when outline=FALSE in
## boxplots, ylim (or xlim when horizontal=TRUE is set) might be
## better set.

set.seed(12345)
x <- rchisq(10000,df=1)
par(mfrow=c(2,1))
## Default wastes much graphics display space...
boxplot(x,outline=FALSE)
## This simple modification can rectify the situation...
ylim=c(max(min(x),quantile(x,.25)-1.5*IQR(x)),
  min(max(x),quantile(x,.75)+1.5*IQR(x)))
boxplot(x,outline=FALSE,ylim=ylim)

## End of demonstration code

Note that when using lists, the one would compute, say,
max(min(x),quantile(x,.25)-1.5*IQR(x)) for each element of the list and
take the minimum over each of these to get the lower bound for ylim
(xlim if horizontal=FALSE).

Thanks for giving this your consideration.

-- Jeff


-- 
Professor J. S. Racine         Phone:  (905) 525 9140 x 23825
Department of Economics        FAX:    (905) 521-8232
McMaster University            e-mail: racinej at mcmaster.ca
1280 Main St. W.,Hamilton,     URL:
http://www.economics.mcmaster.ca/racine/
Ontario, Canada. L8S 4M4

`The generation of random numbers is too important to be left to chance'


From murdoch at stats.uwo.ca  Thu Oct 23 19:49:42 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 23 Oct 2008 13:49:42 -0400
Subject: [Rd] normalizePath bug (PR#13199)
In-Reply-To: <20081023144504.33D9F282BEBF@mail.pubhealth.ku.dk>
References: <20081023144504.33D9F282BEBF@mail.pubhealth.ku.dk>
Message-ID: <4900B936.9030407@stats.uwo.ca>

On 10/23/2008 10:45 AM, joe at novelcap.com wrote:
> Full_Name: Joseph Haykov
> Version: 2.8.0
> OS: Windows
> Submission from: (NULL) (216.189.177.202)
> 
> 
> normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")
> 
> returns: "\0354xl|\a&#144;\001 $v\001?y8"
> 
> instead of returning:
> 
> "C:\\Documents and Settings\\Joseph Haykov\\Local
> Settings\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt"
> 
> By the way, this works correctly in version 2.6.2

I see the problem, and will look into it.  It first started failing in 
2.7.0; it's not a new bug.

But I'm not sure it's a bug, since that directory doesn't exist on my 
system, and the function is documented to give undefined results in that 
case.  Does that file exist on your system?

Duncan Murdoch


From murdoch at stats.uwo.ca  Thu Oct 23 20:24:42 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 23 Oct 2008 14:24:42 -0400
Subject: [Rd] normalizePath bug (PR#13199)
In-Reply-To: <op.ujhn9le5ict22x@laptop>
References: <20081023144504.33D9F282BEBF@mail.pubhealth.ku.dk>
	<4900B936.9030407@stats.uwo.ca> <op.ujhn9le5ict22x@laptop>
Message-ID: <4900C16A.4010609@stats.uwo.ca>

On 10/23/2008 1:59 PM, Joseph Haykov wrote:
> Actually, it's a new file that I plan on writing to, so while the  
> directory C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy exists, the  
> file file72ae2cd6.txt does not. However, this was working fine in version  
> 2.6.2. If you're saying that the reason why this doesn't work is because  
> the file does not exist, I can easily work around the issue.

That's a likely cause.  2.7.0 changed the method of normalizing the 
path, and it now relies on Windows API calls to do it.  However, up to 
2.8.0 it wasn't checking for an error return from those.  I've fixed 
that now, so your string now gives me

 > 
normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")
Error in normalizePath(path) : Unable to normalize element 1

The Windows docs don't list all possible reasons for an error return, so 
I'm not sure that's what you saw, but it does seem likely.  Please do 
let me know if creating the file is not sufficient to get it to work for 
you.

Duncan Murdoch

> 
> Best regards,
> 
> 
> Joe Haykov
> 
> 
> On Thu, 23 Oct 2008 13:49:42 -0400, Duncan Murdoch <murdoch at stats.uwo.ca>  
> wrote:
> 
>> On 10/23/2008 10:45 AM, joe at novelcap.com wrote:
>>> Full_Name: Joseph Haykov
>>> Version: 2.8.0
>>> OS: Windows
>>> Submission from: (NULL) (216.189.177.202)
>>>    
>>> normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")
>>>  returns: "\0354xl|\a&#144;\001 $v\001?y8"
>>>  instead of returning:
>>>  "C:\\Documents and Settings\\Joseph Haykov\\Local
>>> Settings\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt"
>>>  By the way, this works correctly in version 2.6.2
>>
>> I see the problem, and will look into it.  It first started failing in  
>> 2.7.0; it's not a new bug.
>>
>> But I'm not sure it's a bug, since that directory doesn't exist on my  
>> system, and the function is documented to give undefined results in that  
>> case.  Does that file exist on your system?
>>
>> Duncan Murdoch
>


From dkor at northwestern.edu  Thu Oct 23 21:26:23 2008
From: dkor at northwestern.edu (Daniel Kornhauser)
Date: Thu, 23 Oct 2008 14:26:23 -0500
Subject: [Rd] Getting the panel location of a xyplot matrix using a mouse
	click in a GDCanvas
Message-ID: <332394640810231226h518bceb8h61c0132218566a4e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081023/665365da/attachment.pl>

From deepayan.sarkar at gmail.com  Thu Oct 23 21:55:08 2008
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Thu, 23 Oct 2008 12:55:08 -0700
Subject: [Rd] Getting the panel location of a xyplot matrix using a
	mouse click in a GDCanvas
In-Reply-To: <332394640810231226h518bceb8h61c0132218566a4e@mail.gmail.com>
References: <332394640810231226h518bceb8h61c0132218566a4e@mail.gmail.com>
Message-ID: <eb555e660810231255x31d428abt22e1cb3a28a9d933@mail.gmail.com>

On Thu, Oct 23, 2008 at 12:26 PM, Daniel Kornhauser
<dkor at northwestern.edu> wrote:
> Hi:
>
> I would like to find out the panel of a xyplot matrix where a mouse clicked.
>
> I know this functionality is already bundled in trellis.focus but I can't
> use it because I am coding a stand alone application in Java using with
> GDCanvas as a graphics device.
>
> I tried calling trellis.focus from Java with:
>   re.eval("t = trellis.focus()"));
> However it did not work for an embedded GDCanvas. The above call to the
> trellis.focus() returns null no matter where I click.
>
> (Side note: the functionality must be implemented in the GDCanvas because
> trellis.focus does work correctly in JGR)
>
> I wish to handle all the user GUI events in Java to evaluate different
> commands in an Rengine.
> With a GDCanvas, it's straightforward to get the x y position of a mouse
> click with the standard e.getX() and e.getY()
> So my handler would look like:
>    public void mouseClicked(MouseEvent e) {
>        System.out.println("Clicked" + e.getX() + " " + e.getY());
>        System.out.println(re.eval("t = trellis.focus()"));
>        System.out.println(re.eval("t"));
>       // I would update the panel here ...
>    }
>
> I am only using Java because:
> - I am proficient in Java GUI programmer
> - It is multiplatform
>
> Another way of posing the question is:
> Given the coordinates from grid.location how can I find out the plane of an
> xyplot matrix where the user clicked.
>
> I have tried to figure out how to do it from code using trellis.clickFocus,
> but I have have only been playing with R for a week, so I am quite lost
> reading R code.

The approach in trellis.clickFocus should get you close. One important
point is that

clickLoc <- grid.locator("npc")

returns the location in NPC, whereas your e.getX() and e.getY() would
be in device coordinates. help(grconvertX) should tell you how to make
the conversion.

-Deepayan


From joe at novelcap.com  Thu Oct 23 19:59:35 2008
From: joe at novelcap.com (Joseph Haykov)
Date: Thu, 23 Oct 2008 13:59:35 -0400
Subject: [Rd] normalizePath bug (PR#13199)
In-Reply-To: <4900B936.9030407@stats.uwo.ca>
References: <20081023144504.33D9F282BEBF@mail.pubhealth.ku.dk>
	<4900B936.9030407@stats.uwo.ca>
Message-ID: <op.ujhn9le5ict22x@laptop>

Actually, it's a new file that I plan on writing to, so while the  
directory C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy exists, the  
file file72ae2cd6.txt does not. However, this was working fine in version  
2.6.2. If you're saying that the reason why this doesn't work is because  
the file does not exist, I can easily work around the issue.

Best regards,


Joe Haykov


On Thu, 23 Oct 2008 13:49:42 -0400, Duncan Murdoch <murdoch at stats.uwo.ca>  
wrote:

> On 10/23/2008 10:45 AM, joe at novelcap.com wrote:
>> Full_Name: Joseph Haykov
>> Version: 2.8.0
>> OS: Windows
>> Submission from: (NULL) (216.189.177.202)
>>    
>> normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")
>>  returns: "\0354xl|\a&#144;\001 $v\001?y8"
>>  instead of returning:
>>  "C:\\Documents and Settings\\Joseph Haykov\\Local
>> Settings\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt"
>>  By the way, this works correctly in version 2.6.2
>
> I see the problem, and will look into it.  It first started failing in  
> 2.7.0; it's not a new bug.
>
> But I'm not sure it's a bug, since that directory doesn't exist on my  
> system, and the function is documented to give undefined results in that  
> case.  Does that file exist on your system?
>
> Duncan Murdoch


From joe at novelcap.com  Thu Oct 23 20:32:16 2008
From: joe at novelcap.com (Joseph Haykov)
Date: Thu, 23 Oct 2008 14:32:16 -0400
Subject: [Rd] normalizePath bug (PR#13199)
In-Reply-To: <4900C16A.4010609@stats.uwo.ca>
References: <20081023144504.33D9F282BEBF@mail.pubhealth.ku.dk>
	<4900B936.9030407@stats.uwo.ca> <op.ujhn9le5ict22x@laptop>
	<4900C16A.4010609@stats.uwo.ca>
Message-ID: <op.ujhpr2qoict22x@laptop>

No, it's working fine if the file is there, and as I mentioned before, I  
can just normalize the path, and then append the file name at the end  
using the file.path function.

Thanks for your help.


On Thu, 23 Oct 2008 14:24:42 -0400, Duncan Murdoch <murdoch at stats.uwo.ca>  
wrote:

> On 10/23/2008 1:59 PM, Joseph Haykov wrote:
>> Actually, it's a new file that I plan on writing to, so while the   
>> directory C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy exists,  
>> the  file file72ae2cd6.txt does not. However, this was working fine in  
>> version  2.6.2. If you're saying that the reason why this doesn't work  
>> is because  the file does not exist, I can easily work around the issue.
>
> That's a likely cause.  2.7.0 changed the method of normalizing the  
> path, and it now relies on Windows API calls to do it.  However, up to  
> 2.8.0 it wasn't checking for an error return from those.  I've fixed  
> that now, so your string now gives me
>
>  >  
> normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")
> Error in normalizePath(path) : Unable to normalize element 1
>
> The Windows docs don't list all possible reasons for an error return, so  
> I'm not sure that's what you saw, but it does seem likely.  Please do  
> let me know if creating the file is not sufficient to get it to work for  
> you.
>
> Duncan Murdoch
>
>>  Best regards,
>>   Joe Haykov
>>   On Thu, 23 Oct 2008 13:49:42 -0400, Duncan Murdoch  
>> <murdoch at stats.uwo.ca>  wrote:
>>
>>> On 10/23/2008 10:45 AM, joe at novelcap.com wrote:
>>>> Full_Name: Joseph Haykov
>>>> Version: 2.8.0
>>>> OS: Windows
>>>> Submission from: (NULL) (216.189.177.202)
>>>>     
>>>> normalizePath("C:\\DOCUME~1\\JOSEPH~1\\LOCALS~1\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt")
>>>>  returns: "\0354xl|\a&#144;\001 $v\001?y8"
>>>>  instead of returning:
>>>>  "C:\\Documents and Settings\\Joseph Haykov\\Local
>>>> Settings\\Temp\\RtmpolZ4Vy\\file72ae2cd6.txt"
>>>>  By the way, this works correctly in version 2.6.2
>>>
>>> I see the problem, and will look into it.  It first started failing  
>>> in  2.7.0; it's not a new bug.
>>>
>>> But I'm not sure it's a bug, since that directory doesn't exist on my   
>>> system, and the function is documented to give undefined results in  
>>> that  case.  Does that file exist on your system?
>>>
>>> Duncan Murdoch
>>
>


From jpnolan at american.edu  Thu Oct 23 23:49:40 2008
From: jpnolan at american.edu (John Nolan)
Date: Thu, 23 Oct 2008 17:49:40 -0400
Subject: [Rd] RCMD SHLIB: static libraries and f77 libraries on Windows
Message-ID: <OF2313C122.BAD4A7B4-ON852574EB.00762D8A-852574EB.0077E943@american.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081023/0c7239e5/attachment.pl>

From spencer.graves at pdf.com  Fri Oct 24 02:37:19 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Thu, 23 Oct 2008 17:37:19 -0700
Subject: [Rd] Problem with "plflatex wrapper.tex"
Message-ID: <490118BF.6000107@pdf.com>

Hi, All: 

      I encountered problems running "pdflatex wrapper.tex", as 
suggested on "www.r-project.org" -> Newsletter -> (near the bottom of 
the page).  After 220 lines of seemingly successful processing, I got an 
error copied below.  I hit <enter> a few times, and the "pdflatex" 
finished, apparently successfully. 

      Comments? 
      Thanks,
      Spencer
##################################

! LaTeX Error: Something's wrong--perhaps a missing \item.

 

See the LaTeX manual or LaTeX Companion for explanation.

Type  H <return>  for immediate help.

 ...

 

l.151 ... Gentleman(1996)]{R:Ihaka+Gentleman:1996}

 

?

##################################

Complete copy of "Command Prompt" contents: 

Microsoft Windows XP [Version 5.1.2600]

(C) Copyright 1985-2001 Microsoft Corp.

 

C:\Documents and Settings\spencerg>d:

 

D:\>cd spencerg

 

D:\spencerg>cd statmtds

 

D:\spencerg\statmtds>cd R

 

D:\spencerg\statmtds\R>cd Rnews

 

D:\spencerg\statmtds\R\Rnews>pdflatex wrapper.tex

This is pdfTeX, Version 3.1415926-1.40.9 (MiKTeX 2.7)

Running pdftex...

This is pdfTeX, Version 3.1415926-1.40.9 (MiKTeX 2.7) (INITEX)

entering extended mode

("d:\Program Files\MiKTeX 2.7\tex\latex\config\pdflatex.ini"

("C:\Documents and Settings\All Users\Application 
Data\MiKTeX\2.7\tex\generic\c

onfig\pdftexconfig.tex")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\latex.ltx"

("d:\Program Files\MiKTeX 2.7\tex\latex\00miktex\texsys.cfg")

./texsys.aux found

 

 

\@currdir set to: ./.

 

 

Assuming \openin and \input

have the same search path.

 

 

Defining UNIX/DOS style filename parser.

 

catcodes, registers, compatibility for TeX 2,  parameters,

LaTeX2e <2005/12/01>

hacks, control, par, spacing, files, font encodings, lengths,

====================================

 

Local config file fonttext.cfg used

 

====================================

("d:\Program Files\MiKTeX 2.7\tex\latex\00miktex\fonttext.cfg"

("d:\Program Files\MiKTeX 2.7\tex\latex\base\fonttext.ltx"

=== Don't modify this file, use a .cfg file instead ===

 

("d:\Program Files\MiKTeX 2.7\tex\latex\base\omlenc.def")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\t1enc.def")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ot1enc.def")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\omsenc.def")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\t1cmr.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ot1cmr.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ot1cmss.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ot1cmtt.fd")))

====================================

 

Local config file fontmath.cfg used

 

====================================

("d:\Program Files\MiKTeX 2.7\tex\latex\00miktex\fontmath.cfg"

("d:\Program Files\MiKTeX 2.7\tex\latex\base\fontmath.ltx"

=== Don't modify this file, use a .cfg file instead ===

 

("d:\Program Files\MiKTeX 2.7\tex\latex\base\omlcmm.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\omscmsy.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\omxcmex.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ucmr.fd")))

====================================

 

Local config file preload.cfg used

 

=====================================

("d:\Program Files\MiKTeX 2.7\tex\latex\base\preload.cfg"

("d:\Program Files\MiKTeX 2.7\tex\latex\base\preload.ltx")) page nos., 
x-ref,

environments, center, verbatim, math definitions, boxes, title, sectioning,

contents, floats, footnotes, index, bibliography, output,

===========================================

Local configuration file hyphen.cfg used

===========================================

("d:\Program Files\MiKTeX 2.7\tex\generic\babel\hyphen.cfg"

("d:\Program Files\MiKTeX 2.7\tex\generic\hyphen\hyphen.tex")

("d:\Program Files\MiKTeX 2.7\tex\generic\hyphen\dumyhyph.tex")

("d:\Program Files\MiKTeX 2.7\tex\generic\hyphen\zerohyph.tex")

("d:\Program Files\MiKTeX 
2.7\tex\generic\hyph-utf8\loadhyph\loadhyph-de-1901.t

ex" German Hyphenation Patterns (Traditional Orthography)

("d:\Program Files\MiKTeX 2.7\tex\generic\hyphen\dehypht.tex"

German Traditional Hyphenation Patterns `dehypht' Version 3.2a <1999/03/03>

(Formerly known under the name `ghyph31' and `ghyphen'.)))

("d:\Program Files\MiKTeX 
2.7\tex\generic\hyph-utf8\loadhyph\loadhyph-de-1996.t

ex" German Hyphenation Patterns (Reformed Orthography)

("d:\Program Files\MiKTeX 2.7\tex\generic\hyphen\dehyphn.tex"

New German Hyphenation Patterns `dehyphn' Rev.31 <2001-05-07> (WaS)))

("d:\Program Files\MiKTeX 
2.7\tex\generic\dehyph-exptl\dehypht-x-2008-06-18.tex

" Using an 8-bit TeX engine.

("d:\Program Files\MiKTeX 
2.7\tex\generic\dehyph-exptl\dehypht-x-2008-06-18.pat

"

German Hyphenation Patterns (Traditional Orthography) `dehypht-x' 
2008-06-18 (W

L)))

("d:\Program Files\MiKTeX 
2.7\tex\generic\dehyph-exptl\dehyphn-x-2008-06-18.tex

" Using an 8-bit TeX engine.

("d:\Program Files\MiKTeX 
2.7\tex\generic\dehyph-exptl\dehyphn-x-2008-06-18.pat

"

German Hyphenation Patterns (Reformed Orthography, 2006) `dehyphn-x' 
2008-06-18

 (WL)))

("d:\Program Files\MiKTeX 
2.7\tex\generic\hyph-utf8\loadhyph\loadhyph-fr.tex"

EC French hyphenation patterns (V2.12, 2002/12/11)

("d:\Program Files\MiKTeX 
2.7\tex\generic\hyph-utf8\special\spechyph-ot1-fr.tex

")

("d:\Program Files\MiKTeX 
2.7\tex\generic\hyph-utf8\conversions\conv-utf8-ec.te

x") ("d:\Program Files\MiKTeX 
2.7\tex\generic\hyph-utf8\patterns\hyph-fr.tex"))

)

=================================

Applying patch file ltpatch.ltx

=================================

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ltpatch.ltx")

 ) )

Beginning to dump on file pdflatex.fmt

 (preloaded format=pdflatex 2008.10.23)

4952 strings of total length 66969

44147 memory locations dumped; current usage is 144&42160

3306 multiletter control sequences

\font\nullfont=nullfont

\font\OMX/cmex/m/n/10=cmex10

\font\tenln=line10

\font\tenlnw=linew10

\font\tencirc=lcircle10

\font\tencircw=lcirclew10

\font\OT1/cmr/m/n/5=cmr5

\font\OT1/cmr/m/n/7=cmr7

\font\OT1/cmr/m/n/10=cmr10

\font\OML/cmm/m/it/5=cmmi5

\font\OML/cmm/m/it/7=cmmi7

\font\OML/cmm/m/it/10=cmmi10

\font\OMS/cmsy/m/n/5=cmsy5

\font\OMS/cmsy/m/n/7=cmsy7

\font\OMS/cmsy/m/n/10=cmsy10

3633 words of font info for 14 preloaded fonts

14 hyphenation exceptions

Hyphenation trie of length 56225 has 1532 ops out of 35111

  88 for language 7

  411 for language 6

  408 for language 5

  235 for language 4

  207 for language 3

  2 for language 1

  181 for language 0

0 words of pdfTeX memory

0 indirect objects

No pages of output.

Transcript written on pdflatex.log.

entering extended mode

(wrapper.tex

LaTeX2e <2005/12/01>

Babel <v3.8l> and hyphenation patterns for english, dumylang, 
nohyphenation, ge

rman, ngerman, german-x-2008-06-18, ngerman-x-2008-06-18, french, loaded.

("d:\Program Files\MiKTeX 2.7\tex\latex\base\report.cls"

Document Class: report 2005/09/16 v1.4f Standard LaTeX document class

("d:\Program Files\MiKTeX 2.7\tex\latex\base\size10.clo")) (Rnews.sty

Package: `Rnews v0.3.6    <2002/06/02>'

English documentation as of <2001/10/31>

("d:\Program Files\MiKTeX 2.7\tex\latex\base\ifthen.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\tools\multicol.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\graphics\graphicx.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\graphics\keyval.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\graphics\graphics.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\graphics\trig.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\00miktex\graphics.cfg")

("d:\Program Files\MiKTeX 2.7\tex\latex\pdftex-def\pdftex.def")))

("d:\Program Files\MiKTeX 2.7\tex\latex\graphics\color.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\00miktex\color.cfg")) (fancyhdr.sty)

("d:\Program Files\MiKTeX 2.7\tex\latex\hyperref\hyperref.sty"

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\ifpdf.sty")

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\ifvtex.sty")

("d:\Program Files\MiKTeX 2.7\tex\generic\ifxetex\ifxetex.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\oberdiek\hycolor.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\oberdiek\xcolor-patch.sty"))

("d:\Program Files\MiKTeX 2.7\tex\latex\hyperref\pd1enc.def")

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\etexcmds.sty"

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\infwarerr.sty"))

("d:\Program Files\MiKTeX 2.7\tex\latex\00miktex\hyperref.cfg")

("d:\Program Files\MiKTeX 2.7\tex\latex\oberdiek\kvoptions.sty")

Implicit mode ON; LaTeX internals redefined

("d:\Program Files\MiKTeX 2.7\tex\latex\ltxmisc\url.sty")

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\bitset.sty"

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\intcalc.sty")

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\bigintcalc.sty"

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\pdftexcmds.sty")))

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\kvsetkeys.sty")

("d:\Program Files\MiKTeX 2.7\tex\generic\oberdiek\atbegshi.sty"))

*hyperref using default driver hpdftex*

("d:\Program Files\MiKTeX 2.7\tex\latex\hyperref\hpdftex.def")

("d:\Program Files\MiKTeX 2.7\tex\latex\ae\ae.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\base\fontenc.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\base\t1enc.def")

("d:\Program Files\MiKTeX 2.7\tex\latex\ae\t1aer.fd")))

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\mathpple.sty"

 

Package mathpple Warning: This package is to be regarded as obsolete.

(mathpple)                See the PSNFSS documentation.

 

) ("d:\Program Files\MiKTeX 2.7\tex\latex\base\fontenc.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\base\t1enc.def"))

("d:\Program Files\MiKTeX 2.7\tex\latex\tools\verbatim.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\base\alltt.sty")

("d:\Program Files\MiKTeX 2.7\tex\latex\amsfonts\amsfonts.sty"))

("d:\Program Files\MiKTeX 2.7\tex\latex\natbib\natbib.sty") (wrapper.aux)

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\t1ppl.fd")

("d:\Program Files\MiKTeX 2.7\tex\context\base\supp-pdf.tex"

[Loading MPS to PDF converter (version 2006.09.02).]

) ("d:\Program Files\MiKTeX 2.7\tex\latex\hyperref\nameref.sty"

("d:\Program Files\MiKTeX 2.7\tex\latex\oberdiek\refcount.sty")) 
(wrapper.out)

(wrapper.out) (template.tex

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\ot1zpple.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\omlzpple.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\omszpple.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\omxzpple.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\ae\t1aett.fd")

("d:\Program Files\MiKTeX 2.7\tex\latex\psnfss\omsppl.fd")

 

! LaTeX Error: Something's wrong--perhaps a missing \item.

 

See the LaTeX manual or LaTeX Companion for explanation.

Type  H <return>  for immediate help.

 ...

 

l.151 ... Gentleman(1996)]{R:Ihaka+Gentleman:1996}

 

?


From Mark.Bravington at csiro.au  Fri Oct 24 05:07:31 2008
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Fri, 24 Oct 2008 14:07:31 +1100
Subject: [Rd] changed behaviour of 'get' in 2.8.0: request for unchange
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A2@exvic-mbx03.nexus.csiro.au>

There is an unannounced and non-backwards-compatible change to the behaviour of 'get' in R2.8.0. 'get'ting a missing value now causes an error, whereas hitherto it's just returned a "missing" object. For example, in R2.8.0 this happens:

test> getto <- function( x) get( 'x', sys.frame(1))
test> getto()
Error in get("x", sys.frame(1)) :
  argument "x" is missing, with no default

whereas in R2.7.1 this happens:

test> getto()

test>

i.e. a "missing" object.

While I can see some reason to the change, the error always would have gotten triggered eventually if it actually mattered-- and the new behaviour is inconsistent with other extraction functions:

test> getto2 <- function(x) sys.frame(1)$x
test> getto2()

test>

and the same goes for '[['.

'mget' also returns a missing object, rather than tripping an error.

The new 'get' breaks code in packages 'mvbutils' and 'debug'. At least 54 separate functions in those packages use 'get', so there'd be a fair bit of work in checking & changing all these to 'mget'! (Not to mention the entire rest of my code body...)

Is it possible to 'get' the old behaviour back?

Mark Bravington
CSIRO Mathematics & Information Science
CSIRO Marine Lab
Hobart
Australia


From luke at stat.uiowa.edu  Fri Oct 24 12:53:06 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 24 Oct 2008 05:53:06 -0500 (CDT)
Subject: [Rd] changed behaviour of 'get' in 2.8.0: request for unchange
In-Reply-To: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A2@exvic-mbx03.nexus.csiro.au>
References: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A2@exvic-mbx03.nexus.csiro.au>
Message-ID: <Pine.LNX.4.64.0810240538130.16171@itasca2.wildberry.org>

Returning the internal R_MissingArg token was a bug.  From the svn
logs it looks like I fixed this bug back in June (so has been in
R-devel for a while) along with fixing a bug in the way system.time
used to be defined.  I no longer recall the details but suspect the
need to fix this arose in testing the fix to system.time.  The other
accessors should not retrun R_MissingArg either and will be fixed in
due course.

If your code is relying on this behavior then it would be a good idea
to have a look at your code and figure out why, as there is very
little useful that can be done with this missing arg token.  If after
that it turns out that there is a need to be able to test for whether
a binding represents a missing value then we can look into adding a
function that tests for this.  There is already sone desire to have a
way of checking whether a binding contains a delayed evaluation, so
maybe something like a function bindingStatus that returns one of
"active", "missing", "delayed" or "evaluated" makes sense.

You can use try or tryCatch to catch the error, but there is no clean
way currently to catch just this error.  Eventually we should have our
internaly signaled errors signal errors with a specific class so that
one could write something like

     tryCatch(get('x'), missingArgumentError = function(e) ...)

That is a ways off though.

Best,

luke

On Fri, 24 Oct 2008, Mark.Bravington at csiro.au wrote:

> There is an unannounced and non-backwards-compatible change to the behaviour of 'get' in R2.8.0. 'get'ting a missing value now causes an error, whereas hitherto it's just returned a "missing" object. For example, in R2.8.0 this happens:
>
> test> getto <- function( x) get( 'x', sys.frame(1))
> test> getto()
> Error in get("x", sys.frame(1)) :
>  argument "x" is missing, with no default
>
> whereas in R2.7.1 this happens:
>
> test> getto()
>
> test>
>
> i.e. a "missing" object.
>
> While I can see some reason to the change, the error always would have gotten triggered eventually if it actually mattered-- and the new behaviour is inconsistent with other extraction functions:
>
> test> getto2 <- function(x) sys.frame(1)$x
> test> getto2()
>
> test>
>
> and the same goes for '[['.
>
> 'mget' also returns a missing object, rather than tripping an error.
>
> The new 'get' breaks code in packages 'mvbutils' and 'debug'. At least 54 separate functions in those packages use 'get', so there'd be a fair bit of work in checking & changing all these to 'mget'! (Not to mention the entire rest of my code body...)
>
> Is it possible to 'get' the old behaviour back?
>
> Mark Bravington
> CSIRO Mathematics & Information Science
> CSIRO Marine Lab
> Hobart
> Australia
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From ggrothendieck at gmail.com  Fri Oct 24 13:27:21 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 24 Oct 2008 07:27:21 -0400
Subject: [Rd] changed behaviour of 'get' in 2.8.0: request for unchange
In-Reply-To: <Pine.LNX.4.64.0810240538130.16171@itasca2.wildberry.org>
References: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A2@exvic-mbx03.nexus.csiro.au>
	<Pine.LNX.4.64.0810240538130.16171@itasca2.wildberry.org>
Message-ID: <971536df0810240427m4bd50c8ake19feec865c747fd@mail.gmail.com>

On Fri, Oct 24, 2008 at 6:53 AM, Luke Tierney <luke at stat.uiowa.edu> wrote:
> There is already sone desire to have a
> way of checking whether a binding contains a delayed evaluation, so
> maybe something like a function bindingStatus that returns one of
> "active", "missing", "delayed" or "evaluated" makes sense.

The other item that might have a relationship to this
is the ability to a copy an object without evaluating it.  This can't be
done entirely in R but can be done in C code from R:
http://tolstoy.newcastle.edu.au/R/e2/devel/07/09/4444.html

For me, copying is even more important than inspecting and that seems
to be for Mark's case too.


From dkor at northwestern.edu  Fri Oct 24 18:58:19 2008
From: dkor at northwestern.edu (Daniel Kornhauser)
Date: Fri, 24 Oct 2008 11:58:19 -0500
Subject: [Rd] Getting the panel location of a xyplot matrix using a
	mouse click in a GDCanvas
In-Reply-To: <eb555e660810231255x31d428abt22e1cb3a28a9d933@mail.gmail.com>
References: <332394640810231226h518bceb8h61c0132218566a4e@mail.gmail.com>
	<eb555e660810231255x31d428abt22e1cb3a28a9d933@mail.gmail.com>
Message-ID: <332394640810240958t4d324e8bs554e17e8b4989a7e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081024/b30d55e4/attachment.pl>

From cgenolin at u-paris10.fr  Fri Oct 24 23:15:11 2008
From: cgenolin at u-paris10.fr (Christophe Genolini)
Date: Fri, 24 Oct 2008 23:15:11 +0200
Subject: [Rd] unlist change the ordered type
Message-ID: <49023ADF.2070003@u-paris10.fr>

Hi the list,

unlist respect the all the atomic type except orderd (it change of 
ordered into factor) :

### integer
class(unlist(list(1:5,1:3)))
#[1] "integer"

### numeric
class(unlist(list(1.2,3.5)))
#[1] "numeric"

### character
class(unlist(list("e","e")))
#[1] "character"

### factor
class(unlist(list(factor("e"),factor("e"))))
#[1] "factor"

### ordered
class(unlist(list(ordered("e"),ordered("e"))))
#[1] "factor"

Christophe


From droberts at montana.edu  Sat Oct 25 00:53:39 2008
From: droberts at montana.edu (Dave Roberts)
Date: Fri, 24 Oct 2008 15:53:39 -0700
Subject: [Rd] gfortran optimization problems
Message-ID: <490251F3.6050301@montana.edu>

Colleagues,

I have a routine in package labdsv that calls a FORTRAN subroutine. 
Recently, I was informed that it sometimes gives different results on a 
PC and Mac, and that the PC version is clearly wrong.  I tested it on 
linux (because I don't have a PC), and I get the same (incorrect) 
behavior as the PC.

Simply by inserting debug WRITE statements in the FORTRAN I would get 
different, and correct, results, so I assumed it was an optimization 
error.

So,

1) R CMD SHLIB duleg.f    does not work, and produces bogus code

however,

2) gfortran -c alt_duleg.f
    gcc -O -std=gnu99 -shared -L/usr/local/lib -o alt_duleg.so
         alt_duleg.o -lgfortran -lm -lgcc_s

does work (note the -O low optimization).  Otherwise the gcc command is 
identical to the one produced by R CMD SHLIB.

Has anyone else seen this?  Is there a simple way to have my package 
enforce no optimization so others don't struggle with this?  As far as I 
know the same code worked under g77.

Thanks, Dave Roberts
-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
David W. Roberts                                     office 406-994-4548
Professor and Head                                      FAX 406-994-3190
Department of Ecology                         email droberts at montana.edu
Montana State University
Bozeman, MT 59717-3460


From murdoch at stats.uwo.ca  Sat Oct 25 00:55:16 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 24 Oct 2008 18:55:16 -0400
Subject: [Rd] gfortran optimization problems
In-Reply-To: <490251F3.6050301@montana.edu>
References: <490251F3.6050301@montana.edu>
Message-ID: <49025254.10801@stats.uwo.ca>

On 24/10/2008 6:53 PM, Dave Roberts wrote:
> Colleagues,
> 
> I have a routine in package labdsv that calls a FORTRAN subroutine. 
> Recently, I was informed that it sometimes gives different results on a 
> PC and Mac, and that the PC version is clearly wrong.  I tested it on 
> linux (because I don't have a PC), and I get the same (incorrect) 
> behavior as the PC.
> 
> Simply by inserting debug WRITE statements in the FORTRAN I would get 
> different, and correct, results, so I assumed it was an optimization 
> error.
> 
> So,
> 
> 1) R CMD SHLIB duleg.f    does not work, and produces bogus code
> 
> however,
> 
> 2) gfortran -c alt_duleg.f
>     gcc -O -std=gnu99 -shared -L/usr/local/lib -o alt_duleg.so
>          alt_duleg.o -lgfortran -lm -lgcc_s
> 
> does work (note the -O low optimization).  Otherwise the gcc command is 
> identical to the one produced by R CMD SHLIB.
> 
> Has anyone else seen this?  Is there a simple way to have my package 
> enforce no optimization so others don't struggle with this?  As far as I 
> know the same code worked under g77.

I haven't heard of this before, but I think we would be very interested 
in hearing of cases where our default level of optimization produces 
incorrect results.  This could be a compiler bug, which we would want to 
work around.  It might also be an unstable algorithm, in which case you 
probably should fix it, but you might choose instead to use Makevars or 
Makefiles in your package to explicitly describe how you want it built.

Would it be possible for you to extract a minimal example that 
illustrates the bug?

Duncan Murdoch


From Mark.Bravington at csiro.au  Sat Oct 25 02:37:24 2008
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Sat, 25 Oct 2008 11:37:24 +1100
Subject: [Rd] changed behaviour of 'get' in 2.8.0: request for unchange
In-Reply-To: <971536df0810240427m4bd50c8ake19feec865c747fd@mail.gmail.com>
References: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A2@exvic-mbx03.nexus.csiro.au>
	<Pine.LNX.4.64.0810240538130.16171@itasca2.wildberry.org>,
	<971536df0810240427m4bd50c8ake19feec865c747fd@mail.gmail.com>
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A8@exvic-mbx03.nexus.csiro.au>

Thanks both

> The other item that might have a relationship to this
> is the ability to a copy an object without evaluating it.  This can't be
> done entirely in R but can be done in C code from R:
> http://tolstoy.newcastle.edu.au/R/e2/devel/07/09/4444.html

> For me, copying is even more important than inspecting and that seems
> to be for Mark's case too.


Gabor's point is spot-on for me (at least, for the first problem I ran across). I really do need to store a value (possibly an R_MissingArg token), temporarily overwrite it with some other value, then later restore it to whatever condition it was in before. There's no evaluation prior to restoration. In fact, given the context I'm doing this in, it would be good if I could also copy an active-binding or a delayed-eval *without* forcing them-- hadn't thought of that. So Gabor's copy-without-forcing would elegantly solve my (first) problem.

> If your code is relying on this behavior then it would be a good idea
> to have a look at your code and figure out why, as there is very
> little useful that can be done with this missing arg token.  If after
> that it turns out that there is a need to be able to test for whether
> a binding represents a missing value then we can look into adding a
> function that tests for this.  There is already sone desire to have a
> way of checking whether a binding contains a delayed evaluation, so
> maybe something like a function bindingStatus that returns one of
> "active", "missing", "delayed" or "evaluated" makes sense.

It would also be great to have 'bindingStatus'. One context is in the 'debug' package-- you can imagine the sort of shenanigans that goes on inside that. I've been considering re-introducing a watch window, now that there's an excellent 'SetTimeLimit' function to pre-empt problems, but I don't want to force promises or activate bindings just because an argument variable has been added to the watch list.

BTW: re the bug ("Returning the internal R_MissingArg token was a bug."). Is the bug that 'get' should force evaluation, or is it that the R_MissingArg is a "naked singularity"? I ask because presumably the token will still be "legally" available via e.g. 'formals( function(x) NULL)$x'.

NB also that there are one or two other things that can legitimately be done to a Missing object, e.g. object.size.  A number of my documentation examples were broken by the 'get' change for this kind of reason-- it was late last night when I fixed them, and I now can't remember what they all were.

Ah well. I had a nasty feeling somebody might say "we are going to fix the other accessors too" since I have just managed to use them to work around the new behaviour of 'get'. I almost didn't send the original email, for that reason...

Mark


From cberry at tajo.ucsd.edu  Sat Oct 25 07:09:40 2008
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Fri, 24 Oct 2008 22:09:40 -0700
Subject: [Rd] unlist change the ordered type
In-Reply-To: <49023ADF.2070003@u-paris10.fr>
References: <49023ADF.2070003@u-paris10.fr>
Message-ID: <Pine.LNX.4.64.0810242153130.21259@tajo.ucsd.edu>

On Fri, 24 Oct 2008, Christophe Genolini wrote:

> Hi the list,
>
> unlist respect the all the atomic type except orderd (it change of ordered 
> into factor) :
>
> ### integer
> class(unlist(list(1:5,1:3)))
> #[1] "integer"
>
> ### numeric
> class(unlist(list(1.2,3.5)))
> #[1] "numeric"
>
> ### character
> class(unlist(list("e","e")))
> #[1] "character"
>
> ### factor
> class(unlist(list(factor("e"),factor("e"))))
> #[1] "factor"
>
> ### ordered
> class(unlist(list(ordered("e"),ordered("e"))))
> #[1] "factor"

Consider

 	unlist(list(ordered(1:2),ordered(letters[1:4])))

Since one cannot deduce what ordering should apply, the best that can be 
done is to demote all arguments to factors.

This is the general case. Only in the special case in which all list 
elements are of class 'ordered' and the levels attributes are the same 
would this be sensible.

HTH,

Chuck

>
> Christophe
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

Charles C. Berry                            (858) 534-2098
                                             Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	            UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From sgiannerini at gmail.com  Sat Oct 25 12:04:05 2008
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Sat, 25 Oct 2008 12:04:05 +0200
Subject: [Rd] gfortran optimization problems
In-Reply-To: <490251F3.6050301@montana.edu>
References: <490251F3.6050301@montana.edu>
Message-ID: <3c12769c0810250304nd13de3eudce13f0ddc8fd523@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081025/b7f73dab/attachment.pl>

From Matthias.Kohl at stamats.de  Sat Oct 25 16:19:13 2008
From: Matthias.Kohl at stamats.de (Matthias Kohl)
Date: Sat, 25 Oct 2008 16:19:13 +0200
Subject: [Rd] pairwise.wilcox.test for paired samples
Message-ID: <49032AE1.3040209@stamats.de>

Dear R Core,

pairwise.wilcox.test does not handle "paired = TRUE" correctly; e.g.

set.seed(13)
x <- rnorm(20)
g <- c(rep(1, 10), rep(2, 10))
wilcox.test(x ~ g)$p.value # 0.075
pairwise.wilcox.test(x, g)$p.value # 0.075, o.k
wilcox.test(x ~ g, paired = TRUE)$p.value # 0.105
pairwise.wilcox.test(x, g, paired = TRUE)$p.value # 0.075, wrong


The line
    wilcox.test(xi, xj, ...)$p.value

should read
   wilcox.test(xi, xj, paired = paired, ...)$p.value

Best regards,
Matthias

############################
my sessionInfo:
R version 2.8.0 Patched (2008-10-23 r46779)
i686-pc-linux-gnu

locale:
LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=C;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

-- 
Dr. Matthias Kohl
www.stamats.de


From milbo at sonic.net  Sat Oct 25 16:45:06 2008
From: milbo at sonic.net (milbo at sonic.net)
Date: Sat, 25 Oct 2008 16:45:06 +0200 (CEST)
Subject: [Rd] R echoes integer literals incorrectly,
	under certain conditions (PR#13204)
Message-ID: <20081025144506.EB7B9282EFC2@mail.pubhealth.ku.dk>

Full_Name: Stephen Milborrow
Version: R 2.8.0
OS: Windows XP
Submission from: (NULL) (81.159.65.46)


Under certain conditions, R 2.8.0 incorrectly echoes integer literals without
the "L" suffix.  R 2.7.2 is ok.

To reproduce, create two files as follows:
a.R containing: source("b.R", echo=TRUE)
b.R containing: x <- 1L

Now execute: Rterm --vanilla --silent <a.R
This echoes:    x <- 1
It should echo: x <- 1L

This behaviour does not occur if you source("b.R") directly from the R command
prompt, or if you use R 2.7.2.

> sessionInfo()
R version 2.8.0 (2008-10-20) 
i386-pc-mingw32 

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
States.1252;LC_MONETARY=English_United
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base 

www.milbo.users.sonic.net


From milbo at sonic.net  Sat Oct 25 16:59:53 2008
From: milbo at sonic.net (Stephen Milborrow)
Date: Sat, 25 Oct 2008 15:59:53 +0100
Subject: [Rd] 0 ^ NaN == Inf, why?
Message-ID: <54BCF12B6BE6423DBC6CA23B9B7D5D23@dell16>

In R, 0 ^ NaN yields Inf.  I would have expected NaN or perhaps 0. Is this 
behaviour intended?

>sessionInfo()
R version 2.8.0 (2008-10-20)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Steve Milborrow
www.milbo.users.sonic.net


From murdoch at stats.uwo.ca  Sat Oct 25 17:20:53 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 25 Oct 2008 11:20:53 -0400
Subject: [Rd] R echoes integer literals incorrectly,
 under certain conditions (PR#13204)
In-Reply-To: <20081025144506.EB7B9282EFC2@mail.pubhealth.ku.dk>
References: <20081025144506.EB7B9282EFC2@mail.pubhealth.ku.dk>
Message-ID: <49033955.8050003@stats.uwo.ca>

On 25/10/2008 10:45 AM, milbo at sonic.net wrote:
> Full_Name: Stephen Milborrow
> Version: R 2.8.0
> OS: Windows XP
> Submission from: (NULL) (81.159.65.46)
> 
> 
> Under certain conditions, R 2.8.0 incorrectly echoes integer literals without
> the "L" suffix.  R 2.7.2 is ok.
> 
> To reproduce, create two files as follows:
> a.R containing: source("b.R", echo=TRUE)
> b.R containing: x <- 1L
> 
> Now execute: Rterm --vanilla --silent <a.R
> This echoes:    x <- 1
> It should echo: x <- 1L
> 
> This behaviour does not occur if you source("b.R") directly from the R command
> prompt, or if you use R 2.7.2.

It works fine for me.  Could you try changing b.R to contain a comment, e.g.

x <- # a comment
      1L

and let us know what you see in the two cases?  I'm guessing you won't 
see the comment being echoed when you source a.R because for some reason 
your system is deparsing instead of going back to the source to read it, 
but I don't know what'll happen with b.R.

Duncan Murdoch
> 
>> sessionInfo()
> R version 2.8.0 (2008-10-20) 
> i386-pc-mingw32 
> 
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base 
> 
> www.milbo.users.sonic.net
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Sat Oct 25 17:25:12 2008
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Sat, 25 Oct 2008 17:25:12 +0200 (CEST)
Subject: [Rd] R echoes integer literals incorrectly,
	under certain conditions (PR#13205)
Message-ID: <20081025152512.4C88C282EFC2@mail.pubhealth.ku.dk>

On 25/10/2008 10:45 AM, milbo at sonic.net wrote:
> Full_Name: Stephen Milborrow
> Version: R 2.8.0
> OS: Windows XP
> Submission from: (NULL) (81.159.65.46)
> 
> 
> Under certain conditions, R 2.8.0 incorrectly echoes integer literals without
> the "L" suffix.  R 2.7.2 is ok.
> 
> To reproduce, create two files as follows:
> a.R containing: source("b.R", echo=TRUE)
> b.R containing: x <- 1L
> 
> Now execute: Rterm --vanilla --silent <a.R
> This echoes:    x <- 1
> It should echo: x <- 1L
> 
> This behaviour does not occur if you source("b.R") directly from the R command
> prompt, or if you use R 2.7.2.

It works fine for me.  Could you try changing b.R to contain a comment, e.g.

x <- # a comment
      1L

and let us know what you see in the two cases?  I'm guessing you won't 
see the comment being echoed when you source a.R because for some reason 
your system is deparsing instead of going back to the source to read it, 
but I don't know what'll happen with b.R.

Duncan Murdoch
> 
>> sessionInfo()
> R version 2.8.0 (2008-10-20) 
> i386-pc-mingw32 
> 
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base 
> 
> www.milbo.users.sonic.net
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From p.dalgaard at biostat.ku.dk  Sat Oct 25 19:32:16 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat, 25 Oct 2008 19:32:16 +0200
Subject: [Rd] pairwise.wilcox.test for paired samples
In-Reply-To: <49032AE1.3040209@stamats.de>
References: <49032AE1.3040209@stamats.de>
Message-ID: <49035820.3080501@biostat.ku.dk>

Matthias Kohl wrote:
> Dear R Core,
> 
> pairwise.wilcox.test does not handle "paired = TRUE" correctly; e.g.
> 
....
> 
> The line
>    wilcox.test(xi, xj, ...)$p.value
> 
> should read
>   wilcox.test(xi, xj, paired = paired, ...)$p.value

Yes, fixed now. Thanks.

	-pd

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From jmc at r-project.org  Sat Oct 25 21:43:26 2008
From: jmc at r-project.org (John Chambers)
Date: Sat, 25 Oct 2008 15:43:26 -0400
Subject: [Rd] 0 ^ NaN == Inf, why?
In-Reply-To: <54BCF12B6BE6423DBC6CA23B9B7D5D23@dell16>
References: <54BCF12B6BE6423DBC6CA23B9B7D5D23@dell16>
Message-ID: <490376DE.101@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081025/115932a3/attachment.pl>

From jmc at r-project.org  Sat Oct 25 21:55:21 2008
From: jmc at r-project.org (John Chambers)
Date: Sat, 25 Oct 2008 15:55:21 -0400
Subject: [Rd] 0 ^ NaN == Inf, why?
In-Reply-To: <490376DE.101@r-project.org>
References: <54BCF12B6BE6423DBC6CA23B9B7D5D23@dell16>
	<490376DE.101@r-project.org>
Message-ID: <490379A9.3090903@r-project.org>

A small PS:

John Chambers wrote:
>
> Along the line, notice that both R_pow and pow give 0^0 as 1.  (Just at 
> a guess, C might give 0^-0 as Inf, but I don't know how to test that in R.)
>   
I tried a little harder, and apparently the guess is wrong.  It seems 
that pow(0, -0) is 1 in C.   Would seem better to either have pow(0,0) 
and pow(0,-0) both be NaN or else 1 and Inf, but ...
> John
>
>
>   
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From dankoc at gmail.com  Sat Oct 25 22:05:56 2008
From: dankoc at gmail.com (Charles Danko)
Date: Sat, 25 Oct 2008 16:05:56 -0400
Subject: [Rd] Dynamic linking to binary code from other packages??
Message-ID: <8adccabf0810251305o3ad8483x5de5009605fbdbe1@mail.gmail.com>

Dear R-devel,

I am writing a package that needs some C++ functions from an external
SDK (Affymetrix fusion).  The same functions are already compiled into
another package (affxparser).

Can I dynamically link to the compiled code in affxparser, rather than
re-compiling these separately into my package?

Not a lot of experience on this subject!

Thanks,
Charles


From edd at debian.org  Sat Oct 25 22:15:12 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 25 Oct 2008 15:15:12 -0500
Subject: [Rd] Dynamic linking to binary code from other packages??
In-Reply-To: <8adccabf0810251305o3ad8483x5de5009605fbdbe1@mail.gmail.com>
References: <8adccabf0810251305o3ad8483x5de5009605fbdbe1@mail.gmail.com>
Message-ID: <18691.32336.501605.415161@ron.nulle.part>


On 25 October 2008 at 16:05, Charles Danko wrote:
| Dear R-devel,
| 
| I am writing a package that needs some C++ functions from an external
| SDK (Affymetrix fusion).  The same functions are already compiled into
| another package (affxparser).
| 
| Can I dynamically link to the compiled code in affxparser, rather than
| re-compiling these separately into my package?

Yes.  Working examples are lme4 using Matrix.  This is documented in the 'R
Extensions' manual.  

| Not a lot of experience on this subject!

I don't think it is the easiest way around.  Maybe start by 'just'
recompiling and relinking.

Dirk

-- 
Three out of two people have difficulties with fractions.


From ybryukhov at gmail.com  Sat Oct 25 19:10:11 2008
From: ybryukhov at gmail.com (ybryukhov at gmail.com)
Date: Sat, 25 Oct 2008 19:10:11 +0200 (CEST)
Subject: [Rd] Compilation error when X11 is off (PR#13206)
Message-ID: <20081025171011.CC709283460D@mail.pubhealth.ku.dk>

Full_Name: Yegor Bryukhov
Version: 2.8.0
OS: Linux
Submission from: (NULL) (69.22.221.161)


in file src/platform.c line 1657 - a semi-colon is missing for the case when X11
is turned off


From Rowan.Haigh at dfo-mpo.gc.ca  Fri Oct 24 00:20:08 2008
From: Rowan.Haigh at dfo-mpo.gc.ca (Rowan.Haigh at dfo-mpo.gc.ca)
Date: Fri, 24 Oct 2008 00:20:08 +0200 (CEST)
Subject: [Rd] R CMD Rd2dvi (PR#13200)
Message-ID: <20081023222008.5AC99283416C@mail.pubhealth.ku.dk>

Hello,
I can build packages with R-2.8.0 but I cannot run the code:
R CMD Rd2dvi --pdf --no-clean <pkg_name>
=20
Error message:
.: Can't open C:/Apps/R/R280/share/sh/dcf.sh: No such file or directory
The system cannot find the path specified.
=20
The above code works fine in R-2.7.2.
=20
Comparing the bash script Rd2dvi.sh between R-2.7.2 and R-2.8.0 makes me
think that the script is incorrectly determining my system to be UNIX
rather than WINDOWS. I tried the option --os=3Dwindows without any
success.
=20
Good luck.=20
Cheers, Rowan
=20
Sys.getenv()
------------
ADMB_HOME	 C:\Apps\ADMB=09
ALLUSERSPROFILE	 C:\Documents and Settings\All Users=09
APPDATA	 C:\Documents and Settings\haighr\Application Data=09
CommonProgramFiles	 C:\Program Files\Common Files=09
COMPUTERNAME	 PAC03470=09
ComSpec	 C:\WINDOWS\system32\cmd.exe=09
DEFLOGDIR	 C:\Documents and Settings\All Users\Application
Data\McAfee\DesktopProtection=09
FP_NO_HOST_CHECK	 NO=09
GFORTRAN_STDERR_UNIT	 -1=09
GFORTRAN_STDOUT_UNIT	 -1=09
HOME	 E:\Temp\MyDocs=09
HOMEDRIVE	 C:=09
HOMEPATH	 \Documents and Settings\haighr=09
HOMESHARE	 \\pacpbsfp1\HaighR$=09
LOGONSERVER	 \\PACIOSADC1=09
NUMBER_OF_PROCESSORS	 2=09
OS	 Windows_NT=09
PATH
E:\Archive\Bat;C:\Apps\R\Rtools\bin;C:/Apps/Dev-Cpp/bin;C:\Apps\MiKTeX\m
iktex\bin;C:\Apps\R\Rtools\perl\bin;C:\Apps\R\Rtools\MinGW\bin;C:\Apps\P
ython25\Scripts;C:\Apps\Ora81\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WIND
OWS\System32\Wbem;C:\Apps\UltraEdit\=09
PATHEXT	 .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH=09
PROCESSOR_ARCHITECTURE	 x86=09
PROCESSOR_IDENTIFIER	 x86 Family 6 Model 15 Stepping 6, GenuineIntel=09
PROCESSOR_LEVEL	 6=09
PROCESSOR_REVISION	 0f06=09
ProgramFiles	 C:\Program Files=09
R_HOME	 C:\Apps\R\R280=09
R_LIBS_USER	 E:\Temp\MyDocs/R/win-library/2.8=09
R_USER	 E:\Temp\MyDocs=09
SESSIONNAME	 Console=09
SystemDrive	 C:=09
SystemRoot	 C:\WINDOWS=09
TEMP	 C:\Temp\HaighR=09
TMP	 C:\Temp\HaighR=09
USERDNSDOMAIN	 PAC.DFO-MPO.CA=09
USERDOMAIN	 PAC=09
USERNAME	 HaighR=09
USERPROFILE	 C:\Documents and Settings\haighr=09
VSEDEFLOGDIR	 C:\Documents and Settings\All Users\Application
Data\McAfee\DesktopProtection=09
windir	 C:\WINDOWS=09
=20

Rowan Haigh
Research Biologist, Groundfish Section
Marine Ecosystems & Aquaculture Division
Fisheries and Oceans Canada
Pacific Biological Station, Nanaimo, BC  V9T 6N7
Tel. +1 250-756-7123  fac simile +1 250-756-7053
Email Rowan.Haigh at dfo-mpo.gc.ca

=20

	[[alternative HTML version deleted]]


From stefan.albrecht at allianz.com  Fri Oct 24 14:30:08 2008
From: stefan.albrecht at allianz.com (stefan.albrecht at allianz.com)
Date: Fri, 24 Oct 2008 14:30:08 +0200 (CEST)
Subject: [Rd] write.csv(..., col.names = FALSE) (PR#13202)
Message-ID: <20081024123008.3E08E282C769@mail.pubhealth.ku.dk>

Full_Name: Stefan Albrecht
Version: 2.7.2 (and 2.8.0)
OS: Windows NT
Submission from: (NULL) (194.127.8.17)


Dear R Debug-Team,

in write.csv() it is not possible to set both
row.names = FALSE, col.names = FALSE
since the col.names = FALSE gets overwritten:

> write.csv
function (...) 
{
    Call <- match.call(expand.dots = TRUE)
    for (argname in c("col.names", "sep", "dec", "qmethod")) if
(!is.null(Call[[argname]])) 
        warning(gettextf("attempt to set '%s' ignored", argname), 
            domain = NA)
    rn <- eval.parent(Call$row.names)
    Call$col.names <- if (is.logical(rn) && !rn) 
        TRUE
    else NA
    Call$sep <- ","
    Call$dec <- "."
    Call$qmethod <- "double"
    Call[[1]] <- as.name("write.table")
    eval.parent(Call)
}
<environment: namespace:utils>
> 

This is not documented and should be changed, as it is an unintended reaction.

With many thanks and best regards,
Stefan


From dxc13 at health.state.ny.us  Fri Oct 24 15:52:33 2008
From: dxc13 at health.state.ny.us (dxc13)
Date: Fri, 24 Oct 2008 06:52:33 -0700 (PDT)
Subject: [Rd]  Errors in R CMD check for R 2.8.0
Message-ID: <20150565.post@talk.nabble.com>


useR's,

I get these 2 errors when I run "R CMD check" on my package, and I cannot
figure out how to get around them.  Does anyone have any ideas?  If it is of
any help, I use Windows XP.
...
* checking replacement functions .... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... NOTE
Error in inDL(x, as.logical(local), as.logical(now), ...): unable to load
shared library 'c:/Progra~1/R/R-2.8.0/library/tcltk/libs/tcltk.dll':
LoadLibrary failure: The specified procedure could not be found.

Error: .onLoad failed in 'loadNamespace' for 'tcltk'

* Checking .Rd files ... OK
....
* checking data for non-ASCII characters ... OK
* creating kzs-Ex.R ... OK
* checking examples ... ERROR
Running examples in 'kzs-Ex.R' failed.

I have no idea how to solve the first problem with references the tcltk
package and I do not know why my examples won't run.   Any help is
appreciated.

dxc13
-- 
View this message in context: http://www.nabble.com/Errors-in-R-CMD-check-for-R-2.8.0-tp20150565p20150565.html
Sent from the R devel mailing list archive at Nabble.com.


From erich.neuwirth at univie.ac.at  Sun Oct 26 14:50:34 2008
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Sun, 26 Oct 2008 14:50:34 +0100
Subject: [Rd] Possible uninstall problem on windows.
Message-ID: <490475AA.4020403@univie.ac.at>

I just uninstalled R 2.7.2 on Windows XP after having installed R 2.8.0
The uninstaller removed the String values
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\Current Version
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\InstallPath
despite the fact that they pointed to R 2.8.0
The uninstaller did not remove the key
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
(and all the values in that key)

I think the uninstaller should only remove the Current Version entry
if it points to its own version.

In a second attempt, the 2.7.2 uninstaller removed the key
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
(which is what it should do)
but it still removed the
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\Current Version
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\InstallPath
values. It should not have removed these keys.

Sometimes this does not happen, and I have not found a consistent
explanation when it happens and when not.
Sometimes also running RSetReg.exe creates a second entry like
HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
which has identical content with the first one.
The registry really looks like having 2 identical entries.

Is this something which I should file as a bug?


-- 
Erich Neuwirth, University of Vienna
Faculty of Computer Science
Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-39464 Fax: +43-1-4277-39459


From ligges at statistik.tu-dortmund.de  Sun Oct 26 14:54:40 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 26 Oct 2008 14:54:40 +0100
Subject: [Rd] Errors in R CMD check for R 2.8.0
In-Reply-To: <20150565.post@talk.nabble.com>
References: <20150565.post@talk.nabble.com>
Message-ID: <490476A0.2000502@statistik.tu-dortmund.de>



dxc13 wrote:
> useR's,
> 
> I get these 2 errors when I run "R CMD check" on my package, and I cannot
> figure out how to get around them.  Does anyone have any ideas?  If it is of
> any help, I use Windows XP.
> ...
> * checking replacement functions .... OK
> * checking foreign function calls ... OK
> * checking R code for possible problems ... NOTE
> Error in inDL(x, as.logical(local), as.logical(now), ...): unable to load
> shared library 'c:/Progra~1/R/R-2.8.0/library/tcltk/libs/tcltk.dll':
> LoadLibrary failure: The specified procedure could not be found.

Do you have tcltk installed at that location? Do you get any message 
from Windows? What happens if you type library("tcltk")?

> Error: .onLoad failed in 'loadNamespace' for 'tcltk'
> 
> * Checking .Rd files ... OK
> ....
> * checking data for non-ASCII characters ... OK
> * creating kzs-Ex.R ... OK
> * checking examples ... ERROR
> Running examples in 'kzs-Ex.R' failed.

See the log file (kzs-Ex.Rout).


Uwe Ligges


> I have no idea how to solve the first problem with references the tcltk
> package and I do not know why my examples won't run.   Any help is
> appreciated.
> 
> dxc13


From milbo at sonic.net  Sun Oct 26 15:35:50 2008
From: milbo at sonic.net (Stephen Milborrow)
Date: Sun, 26 Oct 2008 14:35:50 -0000
Subject: [Rd] 0 ^ NaN == Inf, why?
References: <54BCF12B6BE6423DBC6CA23B9B7D5D23@dell16>
	<490376DE.101@r-project.org> <490379A9.3090903@r-project.org>
Message-ID: <9506F087E32B4EC183109610CA4B4E7C@dell16>

It may be too late to make such changes now, but would it not be simpler if
R ^ and R pow (and related functions like log) when the return type is
double simply call the standard C library routine pow?  That way we would be
compatible with IEEE 754, with the fair assumption that the C library's pow
is compatible with IEEE 754 (this I believe is a fair assumption in 2008,
may not have been historically).  Having special cases in the code for x==0
etc. is unnecessarily complicated, and returning NA in some cases and NaN in
others introduces further complication. But I may be missing something.

I think this is basically what you are saying with "Other things being
equal, `^` should follow the C pow() function for numeric arguments."

When I was building my just-in-time compiler for R, I looked into some
discrepancies between R and IEEE 754.  My tests were not exhaustive because
the jit compiler in many cases uses the same C math routines as standard R,
so I didn't bother to check those for compatibility. But if you are
interested, the results are summarized in tables in the jit man page
www.milbo.users.sonic.net/ra/jit.html.

I would be prepared to sign up for doing a full test of incompatiblities 
between R math and IEEE 754, if people think time spent doing that is worth 
it.

Steve
www.milbo.users.sonic.net

----- Original Message ----- 
From: "John Chambers" <jmc at r-project.org>
To: "Stephen Milborrow" <milbo at sonic.net>
Cc: <r-devel at r-project.org>
Sent: Saturday, October 25, 2008 7:55 PM
Subject: Re: [Rd] 0 ^ NaN == Inf, why?


A small PS:

John Chambers wrote:
>
> Along the line, notice that both R_pow and pow give 0^0 as 1.  (Just at
> a guess, C might give 0^-0 as Inf, but I don't know how to test that in
> R.)
>
I tried a little harder, and apparently the guess is wrong.  It seems
that pow(0, -0) is 1 in C.   Would seem better to either have pow(0,0)
and pow(0,-0) both be NaN or else 1 and Inf, but ...
> John


----- Original Message ----- 
From: "John Chambers" <jmc at r-project.org>
To: "Stephen Milborrow" <milbo at sonic.net>
Cc: <r-devel at r-project.org>
Subject: Re: [Rd] 0 ^ NaN == Inf, why?

Stephen Milborrow wrote:
In R, 0 ^ NaN yields Inf.  I would have expected NaN or perhaps 0. Is this
behaviour intended?

Well, it certainly follows from the implementation.  In the R_pow C routine,

double R_pow(double x, double y) /* = x ^ y */
{
    if(x == 1. || y == 0.)
      return(1.);
    if(x == 0.) {
      if(y > 0.) return(0.);
      /* y < 0 */ return(R_PosInf);
    }

It does seem, however, that NaN is the logical result here, which I think
results from changing the implementation to:

    if(x == 0.) {
      if(y > 0.) return(0.);
      else if(y < 0) return(R_PosInf);
      else return(y); /* NA or NaN, we assert */
    }

Other things being equal, `^` should follow the C pow() function for numeric
arguments.  After writing pow() as an R function that calls this C function:

> pow(0,NaN)
[1] NaN
> pow(0,NA)
[1] NA
> pow(0,0)
[1] 1

The second example presumably falls out because the C function returns its
second argument if that is a NaN (which a numeric NA is, in C but not in R).
The modified code in R_pow mimics that behavior.

Along the line, notice that both R_pow and pow give 0^0 as 1.  (Just at a
guess, C might give 0^-0 as Inf, but I don't know how to test that in R.)

Other opinions?

John


From murdoch at stats.uwo.ca  Sun Oct 26 15:37:04 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 26 Oct 2008 10:37:04 -0400
Subject: [Rd] Possible uninstall problem on windows.
In-Reply-To: <490475AA.4020403@univie.ac.at>
References: <490475AA.4020403@univie.ac.at>
Message-ID: <49048090.2080400@stats.uwo.ca>

On 26/10/2008 9:50 AM, Erich Neuwirth wrote:
> I just uninstalled R 2.7.2 on Windows XP after having installed R 2.8.0
> The uninstaller removed the String values
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\Current Version
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\InstallPath
> despite the fact that they pointed to R 2.8.0
> The uninstaller did not remove the key
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
> (and all the values in that key)
> 
> I think the uninstaller should only remove the Current Version entry
> if it points to its own version.
> 
> In a second attempt, the 2.7.2 uninstaller removed the key
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
> (which is what it should do)
> but it still removed the
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\Current Version
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\InstallPath
> values. It should not have removed these keys.
> 
> Sometimes this does not happen, and I have not found a consistent
> explanation when it happens and when not.
> Sometimes also running RSetReg.exe creates a second entry like
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
> which has identical content with the first one.
> The registry really looks like having 2 identical entries.
> 
> Is this something which I should file as a bug?

The deletions look like a bug, but probably not one that will get fixed 
by us.  All of the registry entry removals are handled by the Inno Setup 
installer.  It has options to delete, or to delete if empty, but no 
option to delete if unchanged.  So our only workaround would be not to 
delete at all.  Now maybe that should be the option for Current Version 
and InstallPath; do you think so?

The duplicate entry also appears to be a bug, but if it's not 
reproducible, I wouldn't want to try to track it down.  Registry keys 
are supposed to be unique, so maybe this is a Windows bug.  You might 
want to export both keys to a file, and do a careful compare there.

Duncan Murdoch


From ggrothendieck at gmail.com  Sun Oct 26 15:47:03 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 26 Oct 2008 10:47:03 -0400
Subject: [Rd] Possible uninstall problem on windows.
In-Reply-To: <490475AA.4020403@univie.ac.at>
References: <490475AA.4020403@univie.ac.at>
Message-ID: <971536df0810260747g4bf59cffx73d6aa4cab3c93b2@mail.gmail.com>

Note that Rversions.hta in http://batchfiles.googlecode.com
is a Vista javascript script that will present you with a drop down
list based on the R registry entries (and also allow
you to change which version is current).  Its a single file with no
dependencies so just put it in your current
directory (or anywhere in your path) and enter its name at the
Windows command line to run it (or double click it from Windows
Explorer).   (There is an XP version in batchfiles 0.3-2.)

On Sun, Oct 26, 2008 at 9:50 AM, Erich Neuwirth
<erich.neuwirth at univie.ac.at> wrote:
> I just uninstalled R 2.7.2 on Windows XP after having installed R 2.8.0
> The uninstaller removed the String values
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\Current Version
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\InstallPath
> despite the fact that they pointed to R 2.8.0
> The uninstaller did not remove the key
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
> (and all the values in that key)
>
> I think the uninstaller should only remove the Current Version entry
> if it points to its own version.
>
> In a second attempt, the 2.7.2 uninstaller removed the key
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
> (which is what it should do)
> but it still removed the
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\Current Version
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\InstallPath
> values. It should not have removed these keys.
>
> Sometimes this does not happen, and I have not found a consistent
> explanation when it happens and when not.
> Sometimes also running RSetReg.exe creates a second entry like
> HKEY_LOCAL_MACHINE\SOFTWARE\R-core\R\2.7.2
> which has identical content with the first one.
> The registry really looks like having 2 identical entries.
>
> Is this something which I should file as a bug?
>
>
> --
> Erich Neuwirth, University of Vienna
> Faculty of Computer Science
> Computer Supported Didactics Working Group
> Visit our SunSITE at http://sunsite.univie.ac.at
> Phone: +43-1-4277-39464 Fax: +43-1-4277-39459
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From tcallawa at redhat.com  Sun Oct 26 17:02:00 2008
From: tcallawa at redhat.com (Tom "spot" Callaway)
Date: Sun, 26 Oct 2008 12:02:00 -0400
Subject: [Rd] HAVE_BZLIB_H not set
Message-ID: <1225036920.6677.24.camel@localhost.localdomain>

When building 2.8.0 this morning for Fedora, I noticed that it was
building the included bzlib2 source and using it rather than the system
bzip2 libraries and headers. I tracked down the reason to this section
of configure:

cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

#ifdef HAVE_BZLIB_H
#include <bzlib.h>
#endif
int main() {
    char *ver = BZ2_bzlibVersion();
    exit(strcmp(ver, "1.0.5") < 0);
}

_ACEOF

That code wasn't working at all because HAVE_BZLIB_H never gets set
anywhere, even though the configure script had found the system bzip2
bits. This patch adds it to m4/R.m4 and configure, against 2.8.0. With
the patch, R now properly detects bzip2 1.0.5 in Fedora and uses that
rather than the local copy.

~spot
-------------- next part --------------
A non-text attachment was scrubbed...
Name: R-2.8.0-HAVE_BZLIB_H.patch
Type: text/x-patch
Size: 920 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081026/0d830040/attachment.bin>

From cgenolin at u-paris10.fr  Sun Oct 26 19:35:09 2008
From: cgenolin at u-paris10.fr (cgenolin at u-paris10.fr)
Date: Sun, 26 Oct 2008 19:35:09 +0100
Subject: [Rd] unlist change the ordered type
In-Reply-To: <Pine.LNX.4.64.0810242153130.21259@tajo.ucsd.edu>
References: <49023ADF.2070003@u-paris10.fr>
	<Pine.LNX.4.64.0810242153130.21259@tajo.ucsd.edu>
Message-ID: <20081026193509.dnzy98n40004k4oc@icare.u-paris10.fr>

"Charles C. Berry" <cberry at tajo.ucsd.edu> a ??crit??:

> On Fri, 24 Oct 2008, Christophe Genolini wrote:
>
>> Hi the list,
>>
>> unlist respect the all the atomic type except orderd (it change of 
>> ordered into factor) :
>>
>> ### integer
>> class(unlist(list(1:5,1:3)))
>> #[1] "integer"
>>
>> ### numeric
>> class(unlist(list(1.2,3.5)))
>> #[1] "numeric"
>>
>> ### character
>> class(unlist(list("e","e")))
>> #[1] "character"
>>
>> ### factor
>> class(unlist(list(factor("e"),factor("e"))))
>> #[1] "factor"
>>
>> ### ordered
>> class(unlist(list(ordered("e"),ordered("e"))))
>> #[1] "factor"
>
> Consider
>
> 	unlist(list(ordered(1:2),ordered(letters[1:4])))
>
> Since one cannot deduce what ordering should apply, the best that can 
> be done is to demote all arguments to factors.
>
> This is the general case. Only in the special case in which all list 
> elements are of class 'ordered' and the levels attributes are the 
> same would this be sensible.

This "only special" case is quite common since the use of lapply on 
ordered gives such a list

Christophe


From luke at stat.uiowa.edu  Sun Oct 26 20:38:57 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Sun, 26 Oct 2008 14:38:57 -0500 (CDT)
Subject: [Rd] changed behaviour of 'get' in 2.8.0: request for unchange
In-Reply-To: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A8@exvic-mbx03.nexus.csiro.au>
References: <62C82B39B8A85E4B95A18F7F7B852F870C6FE1A2@exvic-mbx03.nexus.csiro.au>
	<Pine.LNX.4.64.0810240538130.16171@itasca2.wildberry.org>,
	<971536df0810240427m4bd50c8ake19feec865c747fd@mail.gmail.com>
	<62C82B39B8A85E4B95A18F7F7B852F870C6FE1A8@exvic-mbx03.nexus.csiro.au>
Message-ID: <alpine.LFD.2.00.0810261421010.2728@nokomis.stat.uiowa.edu>

On Sat, 25 Oct 2008, Mark.Bravington at csiro.au wrote:

> Thanks both
>
>> The other item that might have a relationship to this
>> is the ability to a copy an object without evaluating it.  This can't be
>> done entirely in R but can be done in C code from R:
>> http://tolstoy.newcastle.edu.au/R/e2/devel/07/09/4444.html
>
>> For me, copying is even more important than inspecting and that seems
>> to be for Mark's case too.
>
>
> Gabor's point is spot-on for me (at least, for the first problem I ran across). I really do need to store a value (possibly an R_MissingArg token), temporarily overwrite it with some other value, then later restore it to whatever condition it was in before. There's no evaluation prior to restoration. In fact, given the context I'm doing this in, it would be good if I could also copy an active-binding or a delayed-eval *without* forcing them-- hadn't thought of that. So Gabor's copy-without-forcing would elegantly solve my (first) problem.
>
>> If your code is relying on this behavior then it would be a good idea
>> to have a look at your code and figure out why, as there is very
>> little useful that can be done with this missing arg token.  If after
>> that it turns out that there is a need to be able to test for whether
>> a binding represents a missing value then we can look into adding a
>> function that tests for this.  There is already sone desire to have a
>> way of checking whether a binding contains a delayed evaluation, so
>> maybe something like a function bindingStatus that returns one of
>> "active", "missing", "delayed" or "evaluated" makes sense.
>
> It would also be great to have 'bindingStatus'. One context is in the 'debug' package-- you can imagine the sort of shenanigans that goes on inside that. I've been considering re-introducing a watch window, now that there's an excellent 'SetTimeLimit' function to pre-empt problems, but I don't want to force promises or activate bindings just because an argument variable has been added to the watch list.

I'll look into both -- will probably be a couple of weeks before I get
to it though.

>
> BTW: re the bug ("Returning the internal R_MissingArg token was a bug."). Is the bug that 'get' should force evaluation, or is it that the R_MissingArg is a "naked singularity"? I ask because presumably the token will still be "legally" available via e.g. 'formals( function(x) NULL)$x'.

My reading of the docs is that evaluating get('x') should be
equivalent to evaluating x (not that this is explicit but I think it
is a reasonable inference -- also, for what it is worth, this is true
in Splus).  Also the missing value token is an internal implementation
approach that we might want to change later -- the fact that it
doesn't print sensibly makes it clear that is isn't meant to be
visible.

The fact that the same tokes is used in formals with no default value
is somewhat conincidental (but helpful at the moment as it provides at
least one means of determining whether an argument has a default, but
one has to be very careful indong so).  This should also be handled
differently.  Splus seems to use a separate token but also with
somewhat peculiar behavior.  Something along the lines of returning
NULL for no default but providing a query mechanism to distinguish
really no default from a default of NULL would be cleaner, but
designing something sensible here is a bit harder so probably won't
happen soon.  In codetools and my compiler code I try to isolate
anything that depends on missing defaults in one or two functions so
there isn't much to fix if this changes.

luke

>
> NB also that there are one or two other things that can legitimately be done to a Missing object, e.g. object.size.  A number of my documentation examples were broken by the 'get' change for this kind of reason-- it was late last night when I fixed them, and I now can't remember what they all were.
>
> Ah well. I had a nasty feeling somebody might say "we are going to fix the other accessors too" since I have just managed to use them to work around the new behaviour of 'get'. I almost didn't send the original email, for that reason...
>
> Mark
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From edd at debian.org  Sun Oct 26 21:24:53 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 26 Oct 2008 15:24:53 -0500
Subject: [Rd] HAVE_BZLIB_H not set
In-Reply-To: <1225036920.6677.24.camel@localhost.localdomain>
References: <1225036920.6677.24.camel@localhost.localdomain>
Message-ID: <18692.53781.601972.88628@ron.nulle.part>


On 26 October 2008 at 12:02, "Tom \"spot\" Callaway" wrote:
| When building 2.8.0 this morning for Fedora, I noticed that it was
| building the included bzlib2 source and using it rather than the system
| bzip2 libraries and headers. I tracked down the reason to this section
| of configure:
| 
| cat >>conftest.$ac_ext <<_ACEOF
| /* end confdefs.h.  */
| 
| #ifdef HAVE_BZLIB_H
| #include <bzlib.h>
| #endif
| int main() {
|     char *ver = BZ2_bzlibVersion();
|     exit(strcmp(ver, "1.0.5") < 0);
| }
| 
| _ACEOF
| 
| That code wasn't working at all because HAVE_BZLIB_H never gets set
| anywhere, even though the configure script had found the system bzip2
| bits. This patch adds it to m4/R.m4 and configure, against 2.8.0. With
| the patch, R now properly detects bzip2 1.0.5 in Fedora and uses that
| rather than the local copy.

We had that problem in Debian with (most of ) the 2.7.* series when R thought
it needed to compile bzip2 support itself -- but it didn't before, and it
does no more since where it works in R 2.8.* and its prereleases as ...

edd at ron:~/src/debian/build-logs$ grep "whether bz" r-base_2.7.*
r-base_2.7.0-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.0.20080304-1.log:checking whether bzip2 support needs to be compiled... no
r-base_2.7.0~20080408-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.0~20080415-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.0~20080416-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.1-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.1~20080614-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.1~20080621-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.1.20080621-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.1-2.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.2-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.2~20080816-1.log:checking whether bzip2 support needs to be compiled... yes
r-base_2.7.2-2.log:checking whether bzip2 support needs to be compiled... yes
edd at ron:~/src/debian/build-logs$ grep "whether bz" r-base_2.8.*
r-base_2.8.0-1.log:checking whether bzip2 support needs to be compiled... no
r-base_2.8.0~20081005-1.log:checking whether bzip2 support needs to be compiled... no
r-base_2.8.0~20081006-1.log:checking whether bzip2 support needs to be compiled... no
r-base_2.8.0~20081013-1.log:checking whether bzip2 support needs to be compiled... no
r-base_2.8.0.20081013-1.log:checking whether bzip2 support needs to be compiled... no
edd at ron:~/src/debian/build-logs$ 

... Kurt fixed that in r-devel in mid-July and told me then that the issue was a
missing link instruction for -lbz2 in the actual test configure runs, rather
than the string comparison as I had conjectured.  

That makes me think that maybe it is not the matter of the #define you
set. But I defer to Kurt on this.

Cheers, Dirk

-- 
Three out of two people have difficulties with fractions.


From plroebuck at mdanderson.org  Mon Oct 27 05:58:33 2008
From: plroebuck at mdanderson.org (Paul Roebuck)
Date: Sun, 26 Oct 2008 23:58:33 -0500 (CDT)
Subject: [Rd] write.csv(..., col.names = FALSE) (PR#13202)
In-Reply-To: <20081024123008.3E08E282C769@mail.pubhealth.ku.dk>
References: <20081024123008.3E08E282C769@mail.pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.58.0810262349370.479523@wotan.mdacc.tmc.edu>

On Fri, 24 Oct 2008 stefan.albrecht at allianz.com wrote:

> in write.csv() it is not possible to set both
> row.names = FALSE, col.names = FALSE
> since the col.names = FALSE gets overwritten:
>
> > write.csv
> function (...)
> {
>     Call <- match.call(expand.dots = TRUE)
>     for (argname in c("col.names", "sep", "dec", "qmethod")) if
> (!is.null(Call[[argname]]))
>         warning(gettextf("attempt to set '%s' ignored", argname),
>             domain = NA)
>     rn <- eval.parent(Call$row.names)
>     Call$col.names <- if (is.logical(rn) && !rn)
>         TRUE
>     else NA
>     Call$sep <- ","
>     Call$dec <- "."
>     Call$qmethod <- "double"
>     Call[[1]] <- as.name("write.table")
>     eval.parent(Call)
> }
> <environment: namespace:utils>
> >
>
> This is not documented and should be changed, as it is
> an unintended reaction.

?write.csv

> write.csv and write.csv2 provide convenience wrappers
> for writing CSV files. They set sep, dec and qmethod,
> and col.names to NA if row.names=TRUE and TRUE otherwise.

Seems documented to me.

Note that write.csv is just a wrapper for write.table.
If you don't like the wrapper, you could always call
write.table with its arguments set just as you want.

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From plummer at iarc.fr  Mon Oct 27 11:19:05 2008
From: plummer at iarc.fr (Martyn Plummer)
Date: Mon, 27 Oct 2008 11:19:05 +0100
Subject: [Rd] HAVE_BZLIB_H not set
In-Reply-To: <18692.53781.601972.88628@ron.nulle.part>
References: <1225036920.6677.24.camel@localhost.localdomain>
	<18692.53781.601972.88628@ron.nulle.part>
Message-ID: <1225102745.16353.163.camel@seurat.iarc.fr>

That must be a different problem as this one affects both R 2.7.2 and R
2.8.0 on Fedora 9. When the header is not included, the test program
that checks the version of bzlib segfaults. 

We can fix this by using AC_CHECK_HEADERS instead of AC_CHECK_HEADER
when looking for bzlib.h, since the former macro defines the missing
variable. Checking this in now.

Martyn

On Sun, 2008-10-26 at 15:24 -0500, Dirk Eddelbuettel wrote:
> On 26 October 2008 at 12:02, "Tom \"spot\" Callaway" wrote:
> | When building 2.8.0 this morning for Fedora, I noticed that it was
> | building the included bzlib2 source and using it rather than the system
> | bzip2 libraries and headers. I tracked down the reason to this section
> | of configure:
> | 
> | cat >>conftest.$ac_ext <<_ACEOF
> | /* end confdefs.h.  */
> | 
> | #ifdef HAVE_BZLIB_H
> | #include <bzlib.h>
> | #endif
> | int main() {
> |     char *ver = BZ2_bzlibVersion();
> |     exit(strcmp(ver, "1.0.5") < 0);
> | }
> | 
> | _ACEOF
> | 
> | That code wasn't working at all because HAVE_BZLIB_H never gets set
> | anywhere, even though the configure script had found the system bzip2
> | bits. This patch adds it to m4/R.m4 and configure, against 2.8.0. With
> | the patch, R now properly detects bzip2 1.0.5 in Fedora and uses that
> | rather than the local copy.
> 
> We had that problem in Debian with (most of ) the 2.7.* series when R thought
> it needed to compile bzip2 support itself -- but it didn't before, and it
> does no more since where it works in R 2.8.* and its prereleases as ...
> 
> edd at ron:~/src/debian/build-logs$ grep "whether bz" r-base_2.7.*
> r-base_2.7.0-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.0.20080304-1.log:checking whether bzip2 support needs to be compiled... no
> r-base_2.7.0~20080408-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.0~20080415-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.0~20080416-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.1-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.1~20080614-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.1~20080621-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.1.20080621-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.1-2.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.2-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.2~20080816-1.log:checking whether bzip2 support needs to be compiled... yes
> r-base_2.7.2-2.log:checking whether bzip2 support needs to be compiled... yes
> edd at ron:~/src/debian/build-logs$ grep "whether bz" r-base_2.8.*
> r-base_2.8.0-1.log:checking whether bzip2 support needs to be compiled... no
> r-base_2.8.0~20081005-1.log:checking whether bzip2 support needs to be compiled... no
> r-base_2.8.0~20081006-1.log:checking whether bzip2 support needs to be compiled... no
> r-base_2.8.0~20081013-1.log:checking whether bzip2 support needs to be compiled... no
> r-base_2.8.0.20081013-1.log:checking whether bzip2 support needs to be compiled... no
> edd at ron:~/src/debian/build-logs$ 
> 
> ... Kurt fixed that in r-devel in mid-July and told me then that the issue was a
> missing link instruction for -lbz2 in the actual test configure runs, rather
> than the string comparison as I had conjectured.  
> 
> That makes me think that maybe it is not the matter of the #define you
> set. But I defer to Kurt on this.
> 
> Cheers, Dirk
> 

-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From jason at acm.org  Mon Oct 27 14:31:00 2008
From: jason at acm.org (Jason Riedy)
Date: Mon, 27 Oct 2008 09:31:00 -0400
Subject: [Rd] 0 ^ NaN == Inf, why?
In-Reply-To: <490379A9.3090903@r-project.org> (John Chambers's message of
	"Sat, 25 Oct 2008 15:55:21 -0400")
References: <54BCF12B6BE6423DBC6CA23B9B7D5D23@dell16>
	<490376DE.101@r-project.org> <490379A9.3090903@r-project.org>
Message-ID: <871vy2w4ff.fsf@sparse.dyndns.org>

And John Chambers writes:
> I tried a little harder, and apparently the guess is wrong.  It seems
> that pow(0, -0) is 1 in C.   Would seem better to either have pow(0,0)
> and pow(0,-0) both be NaN or else 1 and Inf, but ...

There are slides from Jim Thomas summarizing the C99 choices for
elementary functions at
  http://grouper.ieee.org/groups/754/meeting-materials/2001-07-18-c99.pdf
or in an html version in the meeting notes at
  http://grouper.ieee.org/groups/754/meeting-minutes/01-07-18.html

IIRC, pow(x, +/- 0) is taken to be 1 for all x because pow(x, 0) = 1 and
pow(x, -0) = 1/pow(x, 0) = 1/1 = 1 for all finite, numerical, non-zero
x.  The NCEG folks spent a huge effort considering mathematical reasons
and actual applications when they chose the special case values.
Disagreements over special cases are natural, alas, but they did the
best anyone really could.

Jason


From Robert.McGehee at geodecapital.com  Mon Oct 27 17:22:17 2008
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Mon, 27 Oct 2008 12:22:17 -0400
Subject: [Rd] S4 object does not commute?
Message-ID: <EEBC169715EB8C438D3C9283AF0F201C03D0BF61@MSGBOSCLM2WIN.DMN1.FMR.COM>

Hello all,
It appears that for the simplest of S4 objects, z+1 does not equal 1+z.
Presumably this is a bug, as 1+z seems to make a malformed object (at
least malformed as an input to str).
Thanks, Robert


> setClass("test", representation("vector"))
[1] "test"
> z <- new("test", 1)
> identical(z+1, 1+z)
[1] FALSE
> str(z+1)
Formal class 'test' [package ".GlobalEnv"] with 1 slots
  ..@ .Data: num 2
> str(1+z)
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Error: evaluation nested too deeply: infinite
recursion / options(expressions=)?

> R.version
               _                           
platform       x86_64-unknown-linux-gnu    
arch           x86_64                      
os             linux-gnu                   
system         x86_64, linux-gnu           
status                                     
major          2                           
minor          8.0                         
year           2008                        
month          10                          
day            20                          
svn rev        46754                       
language       R                           
version.string R version 2.8.0 (2008-10-20)


From Robert.McGehee at geodecapital.com  Mon Oct 27 17:25:07 2008
From: Robert.McGehee at geodecapital.com (Robert.McGehee at geodecapital.com)
Date: Mon, 27 Oct 2008 17:25:07 +0100 (CET)
Subject: [Rd] S4 object does not commute? (PR#13209)
Message-ID: <20081027162507.CD7BC283416A@mail.pubhealth.ku.dk>

Hello all,
It appears that for the simplest of S4 objects, z+1 does not equal 1+z.
Presumably this is a bug, as 1+z seems to make a malformed object (at
least malformed as an input to str).
Thanks, Robert


> setClass("test", representation("vector"))
[1] "test"
> z <- new("test", 1)
> identical(z+1, 1+z)
[1] FALSE
> str(z+1)
Formal class 'test' [package ".GlobalEnv"] with 1 slots
  ..@ .Data: num 2
> str(1+z)
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
Class 'test' Class 'test' Error: evaluation nested too deeply: infinite
recursion / options(expressions=3D)?

> R.version
               _                          =20
platform       x86_64-unknown-linux-gnu   =20
arch           x86_64                     =20
os             linux-gnu                  =20
system         x86_64, linux-gnu          =20
status                                    =20
major          2                          =20
minor          8.0                        =20
year           2008                       =20
month          10                         =20
day            20                         =20
svn rev        46754                      =20
language       R                          =20
version.string R version 2.8.0 (2008-10-20)


From simon.urbanek at r-project.org  Mon Oct 27 18:49:25 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 27 Oct 2008 13:49:25 -0400
Subject: [Rd] Arith ops dropping S4 bit [Was: S4 object does not commute?
	(PR#13209)]
In-Reply-To: <20081027162507.CD7BC283416A@mail.pubhealth.ku.dk>
References: <20081027162507.CD7BC283416A@mail.pubhealth.ku.dk>
Message-ID: <607768E4-A332-4AD9-8F22-F89CA88B5C61@r-project.org>


On Oct 27, 2008, at 12:25 , Robert.McGehee at geodecapital.com wrote:

> Hello all,
> It appears that for the simplest of S4 objects, z+1 does not equal  
> 1+z.
> Presumably this is a bug, as 1+z seems to make a malformed object (at
> least malformed as an input to str).

FWIW the difference is that z+1 has the S4 bit set, 1+z does not. The  
objects are otherwise identical. AFAICS the same behavior is  
reproducible with any binary arithmetic operator (i.e. non-S4 %op% S4  
will produce a result with S4 bit cleared yet valid S4 attributes).

Cheers,
S



>
>> setClass("test", representation("vector"))
> [1] "test"
>> z <- new("test", 1)
>> identical(z+1, 1+z)
> [1] FALSE
>> str(z+1)
> Formal class 'test' [package ".GlobalEnv"] with 1 slots
>  ..@ .Data: num 2
>> str(1+z)
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class  
> 'test'
> Class 'test' Class 'test' Error: evaluation nested too deeply:  
> infinite
> recursion / options(expressions=3D)?
>
>> R.version
>               _                          =20
> platform       x86_64-unknown-linux-gnu   =20
> arch           x86_64                     =20
> os             linux-gnu                  =20
> system         x86_64, linux-gnu          =20
> status                                    =20
> major          2                          =20
> minor          8.0                        =20
> year           2008                       =20
> month          10                         =20
> day            20                         =20
> svn rev        46754                      =20
> language       R                          =20
> version.string R version 2.8.0 (2008-10-20)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From dxc13 at health.state.ny.us  Sun Oct 26 18:43:42 2008
From: dxc13 at health.state.ny.us (dxc13)
Date: Sun, 26 Oct 2008 10:43:42 -0700 (PDT)
Subject: [Rd] Errors in R CMD check for R 2.8.0
In-Reply-To: <490476A0.2000502@statistik.tu-dortmund.de>
References: <20150565.post@talk.nabble.com>
	<490476A0.2000502@statistik.tu-dortmund.de>
Message-ID: <20176033.post@talk.nabble.com>


When I type library("tcltk") under R 2.8.0 I get the error message:
Loading Tcl/Tk interface ...Error in inDL(x, as.logical(local),
as.logical(now), ...) : 
  unable to load shared library
'C:/PROGRA~1/R/R-28~1.0/library/tcltk/libs/tcltk.dll':
  LoadLibrary failure:  The specified procedure could not be found.

Error : .onLoad failed in 'loadNamespace' for 'tcltk'
Error: package/namespace load failed for 'tcltk'

I do not get this error when I run R 2.7.0.  When I upgraded to R 2.8.0 I
just copied my library from 2.7.0 to the library folder of 2.8.0.  Is this
troublesome?




Uwe Ligges-3 wrote:
> 
> 
> 
> dxc13 wrote:
>> useR's,
>> 
>> I get these 2 errors when I run "R CMD check" on my package, and I cannot
>> figure out how to get around them.  Does anyone have any ideas?  If it is
>> of
>> any help, I use Windows XP.
>> ...
>> * checking replacement functions .... OK
>> * checking foreign function calls ... OK
>> * checking R code for possible problems ... NOTE
>> Error in inDL(x, as.logical(local), as.logical(now), ...): unable to load
>> shared library 'c:/Progra~1/R/R-2.8.0/library/tcltk/libs/tcltk.dll':
>> LoadLibrary failure: The specified procedure could not be found.
> 
> Do you have tcltk installed at that location? Do you get any message 
> from Windows? What happens if you type library("tcltk")?
> 
>> Error: .onLoad failed in 'loadNamespace' for 'tcltk'
>> 
>> * Checking .Rd files ... OK
>> ....
>> * checking data for non-ASCII characters ... OK
>> * creating kzs-Ex.R ... OK
>> * checking examples ... ERROR
>> Running examples in 'kzs-Ex.R' failed.
> 
> See the log file (kzs-Ex.Rout).
> 
> 
> Uwe Ligges
> 
> 
>> I have no idea how to solve the first problem with references the tcltk
>> package and I do not know why my examples won't run.   Any help is
>> appreciated.
>> 
>> dxc13
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
View this message in context: http://www.nabble.com/Errors-in-R-CMD-check-for-R-2.8.0-tp20150565p20176033.html
Sent from the R devel mailing list archive at Nabble.com.


From stefan.albrecht at apep.com  Mon Oct 27 09:18:32 2008
From: stefan.albrecht at apep.com (Albrecht, Dr. Stefan (AIM SE))
Date: Mon, 27 Oct 2008 09:18:32 +0100
Subject: [Rd]  write.csv(..., col.names = FALSE) (PR#13202)
In-Reply-To: <Pine.OSF.4.58.0810262349370.479523@wotan.mdacc.tmc.edu>
References: <20081024123008.3E08E282C769@mail.pubhealth.ku.dk>
	<Pine.OSF.4.58.0810262349370.479523@wotan.mdacc.tmc.edu>
Message-ID: <B3E803F92F909741B050C9FA4DDEDE75027B8B6C@naimucog.allianzde.rootdom.net>

Dear Paul,

Thanks for your hint to write.table(). I have already chosen this route.

Note that if  row.names = FALSE, col.names gets TRUE and not NA.
>     rn <- eval.parent(Call$row.names)
>     Call$col.names <- if (is.logical(rn) && !rn)
>         TRUE
>     else NA

This is in contradiction to your citation and not very helpful, if one wants to append data to a file.

With best regards,
Stefan

____________________________________
Dr. Stefan Albrecht, CFA
Allianz Investment Management SE
AIM-GI-ALM
K?niginstr. 28 | 80802 Munich | Germany

Phone: +49.(0)89.3800.18317
Fax: +49.(0)89.3800.818317
EMail: stefan.albrecht at allianz.com


Allianz Investment Management SE
Vorsitzender des Verwaltungsrates: Dr. Paul Achleitner
Gesch?ftsf?hrende Direktoren: Dr. Karl-Hermann Lowe, Dr. Bernd Gutting 

Sitz der Gesellschaft: M?nchen, Deutschland, Registergericht: M?nchen HRB 162748
F?r Umsatzsteuerzwecke: Ust-ID-Nr.: DE 251 168 597

-----Urspr?ngliche Nachricht-----
Von: Paul Roebuck [mailto:plroebuck at mdanderson.org] 
Gesendet: Monday, October 27, 2008 05:59
An: R Development Mailing List
Cc: Albrecht, Dr. Stefan (AIM SE)
Betreff: Re: [Rd] write.csv(..., col.names = FALSE) (PR#13202)

On Fri, 24 Oct 2008 stefan.albrecht at allianz.com wrote:

> in write.csv() it is not possible to set both
> row.names = FALSE, col.names = FALSE
> since the col.names = FALSE gets overwritten:
>
> > write.csv
> function (...)
> {
>     Call <- match.call(expand.dots = TRUE)
>     for (argname in c("col.names", "sep", "dec", "qmethod")) if
> (!is.null(Call[[argname]]))
>         warning(gettextf("attempt to set '%s' ignored", argname),
>             domain = NA)
>     rn <- eval.parent(Call$row.names)
>     Call$col.names <- if (is.logical(rn) && !rn)
>         TRUE
>     else NA
>     Call$sep <- ","
>     Call$dec <- "."
>     Call$qmethod <- "double"
>     Call[[1]] <- as.name("write.table")
>     eval.parent(Call)
> }
> <environment: namespace:utils>
> >
>
> This is not documented and should be changed, as it is
> an unintended reaction.

?write.csv

> write.csv and write.csv2 provide convenience wrappers
> for writing CSV files. They set sep, dec and qmethod,
> and col.names to NA if row.names=TRUE and TRUE otherwise.

Seems documented to me.

Note that write.csv is just a wrapper for write.table.
If you don't like the wrapper, you could always call
write.table with its arguments set just as you want.

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From janek.musek at guest.arnes.si  Mon Oct 27 20:30:10 2008
From: janek.musek at guest.arnes.si (janek.musek at guest.arnes.si)
Date: Mon, 27 Oct 2008 20:30:10 +0100 (CET)
Subject: [Rd] 2.8.0 release bugs (PR#13210)
Message-ID: <20081027193010.559D5282EFC1@mail.pubhealth.ku.dk>

Dear colleagues,

Using the last release 2.8.0 I had (for the first time since working with R)
the difficulties in transmission of some Central European letters (=B9=F0=
=E8=E6=BE)
from R editor to the console and graphic window. They appear correctly in
commands in R editor window, yet after executing ctrl R, they have been
transformed to other codes or blanks (in console and graph devices).=20=20

No such troubles have ever met using previous releases. How this can be
explained?

Thanks in advance,

Janek Musek


	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Tue Oct 28 10:07:32 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 28 Oct 2008 10:07:32 +0100
Subject: [Rd] Errors in R CMD check for R 2.8.0
In-Reply-To: <20176033.post@talk.nabble.com>
References: <20150565.post@talk.nabble.com>	<490476A0.2000502@statistik.tu-dortmund.de>
	<20176033.post@talk.nabble.com>
Message-ID: <4906D654.4020709@statistik.tu-dortmund.de>



dxc13 wrote:
> When I type library("tcltk") under R 2.8.0 I get the error message:
> Loading Tcl/Tk interface ...Error in inDL(x, as.logical(local),
> as.logical(now), ...) : 
>   unable to load shared library
> 'C:/PROGRA~1/R/R-28~1.0/library/tcltk/libs/tcltk.dll':
>   LoadLibrary failure:  The specified procedure could not be found.
> 
> Error : .onLoad failed in 'loadNamespace' for 'tcltk'
> Error: package/namespace load failed for 'tcltk'
> 
> I do not get this error when I run R 2.7.0.  When I upgraded to R 2.8.0 I
> just copied my library from 2.7.0 to the library folder of 2.8.0.  Is this
> troublesome?


Yes, it is. You may have overwritten your new tcltk installation by an 
outdated one.

You need to do now:

1. Re-intsall  R (in the same folder as before is fine)
2. run update.package(checkBuilt=TRUE)


Uwe Ligges


> 
> 
> 
> 
> Uwe Ligges-3 wrote:
>>
>>
>> dxc13 wrote:
>>> useR's,
>>>
>>> I get these 2 errors when I run "R CMD check" on my package, and I cannot
>>> figure out how to get around them.  Does anyone have any ideas?  If it is
>>> of
>>> any help, I use Windows XP.
>>> ...
>>> * checking replacement functions .... OK
>>> * checking foreign function calls ... OK
>>> * checking R code for possible problems ... NOTE
>>> Error in inDL(x, as.logical(local), as.logical(now), ...): unable to load
>>> shared library 'c:/Progra~1/R/R-2.8.0/library/tcltk/libs/tcltk.dll':
>>> LoadLibrary failure: The specified procedure could not be found.
>> Do you have tcltk installed at that location? Do you get any message 
>> from Windows? What happens if you type library("tcltk")?
>>
>>> Error: .onLoad failed in 'loadNamespace' for 'tcltk'
>>>
>>> * Checking .Rd files ... OK
>>> ....
>>> * checking data for non-ASCII characters ... OK
>>> * creating kzs-Ex.R ... OK
>>> * checking examples ... ERROR
>>> Running examples in 'kzs-Ex.R' failed.
>> See the log file (kzs-Ex.Rout).
>>
>>
>> Uwe Ligges
>>
>>
>>> I have no idea how to solve the first problem with references the tcltk
>>> package and I do not know why my examples won't run.   Any help is
>>> appreciated.
>>>
>>> dxc13
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From foylong at gmail.com  Tue Oct 28 11:26:33 2008
From: foylong at gmail.com (=?ISO-8859-1?Q?F=E1n_L=F3ng?=)
Date: Tue, 28 Oct 2008 18:26:33 +0800
Subject: [Rd] A question about the API mkchar()
Message-ID: <e936a3d0810280326x6df26d5cyd130af917b1b02c9@mail.gmail.com>

Hi guys,


I've got a question about the API mkchar(). I have met some difficulty
in parsing utf-8 string to mkchar() in R-2.7.0.



I was intending to parse an utf-8 string str_jan (some Japanese
characters such as?, whose utf-8 code is E381B5) to R API SEXP
mkChar(const char *name) , we only need to create the SEXP using the
string that we parsed.



Unfortunately, I found when parsing the variable str_jan, R will
automatically convert the str_jan according to the current locale
setting, so only in the English locale could the function work
correctly, under other locale, such as Japanese or Chinese, the string
will be convert incorrectly. As a matter of fact, those utf-8 code
already is Unicode string, and don't need to be converted at all.



I also tried to use the SEXP Rf_mkCharCE(const char *, cetype_t);,
Parsing the CE_UTF8 as the argument of cetype_t, but the result is
worse. It returned the result as ucs code, an kind of Unicode under
windows platform.



All I want to get is just a SEXP object containing the original utf-8
string, no matter what locale is set currently. Normally what can I
do?





Thanks,

Long


From ggrothendieck at gmail.com  Tue Oct 28 12:12:25 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 28 Oct 2008 07:12:25 -0400
Subject: [Rd] Errors in R CMD check for R 2.8.0
In-Reply-To: <4906D654.4020709@statistik.tu-dortmund.de>
References: <20150565.post@talk.nabble.com>
	<490476A0.2000502@statistik.tu-dortmund.de>
	<20176033.post@talk.nabble.com>
	<4906D654.4020709@statistik.tu-dortmund.de>
Message-ID: <971536df0810280412v635aa4f1u83cc820a7650572b@mail.gmail.com>

You could go to \Users\JoeDoe\Documents\R\win-library and rename
2.8 to 2.8x, say, reinstall R, grab movedir.bat from
http://batchfiles.googlecode.com
placing it in \Users\JoeDoe\Documents\R\win-library (or anywhere on
your path) and then check that it created a
\Users\JoeDoe\Documents\R\win-library\2.8
and run this in the Windows console

   cd \Users\JoeDoe\Documents\R\win-library
   movedir 2.8x 2.8

Then start R and choose Packages | Update

movedir.bat is a small batch file (with no dependencies) that can be used to
move your packages from one library to another with the safety feature that
it will not overwrite packages that are already in the target library.

On Tue, Oct 28, 2008 at 5:07 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> dxc13 wrote:
>>
>> When I type library("tcltk") under R 2.8.0 I get the error message:
>> Loading Tcl/Tk interface ...Error in inDL(x, as.logical(local),
>> as.logical(now), ...) :  unable to load shared library
>> 'C:/PROGRA~1/R/R-28~1.0/library/tcltk/libs/tcltk.dll':
>>  LoadLibrary failure:  The specified procedure could not be found.
>>
>> Error : .onLoad failed in 'loadNamespace' for 'tcltk'
>> Error: package/namespace load failed for 'tcltk'
>>
>> I do not get this error when I run R 2.7.0.  When I upgraded to R 2.8.0 I
>> just copied my library from 2.7.0 to the library folder of 2.8.0.  Is this
>> troublesome?
>
>
> Yes, it is. You may have overwritten your new tcltk installation by an
> outdated one.
>
> You need to do now:
>
> 1. Re-intsall  R (in the same folder as before is fine)
> 2. run update.package(checkBuilt=TRUE)
>
>
> Uwe Ligges
>
>
>>
>>
>>
>>
>> Uwe Ligges-3 wrote:
>>>
>>>
>>> dxc13 wrote:
>>>>
>>>> useR's,
>>>>
>>>> I get these 2 errors when I run "R CMD check" on my package, and I
>>>> cannot
>>>> figure out how to get around them.  Does anyone have any ideas?  If it
>>>> is
>>>> of
>>>> any help, I use Windows XP.
>>>> ...
>>>> * checking replacement functions .... OK
>>>> * checking foreign function calls ... OK
>>>> * checking R code for possible problems ... NOTE
>>>> Error in inDL(x, as.logical(local), as.logical(now), ...): unable to
>>>> load
>>>> shared library 'c:/Progra~1/R/R-2.8.0/library/tcltk/libs/tcltk.dll':
>>>> LoadLibrary failure: The specified procedure could not be found.
>>>
>>> Do you have tcltk installed at that location? Do you get any message from
>>> Windows? What happens if you type library("tcltk")?
>>>
>>>> Error: .onLoad failed in 'loadNamespace' for 'tcltk'
>>>>
>>>> * Checking .Rd files ... OK
>>>> ....
>>>> * checking data for non-ASCII characters ... OK
>>>> * creating kzs-Ex.R ... OK
>>>> * checking examples ... ERROR
>>>> Running examples in 'kzs-Ex.R' failed.
>>>
>>> See the log file (kzs-Ex.Rout).
>>>
>>>
>>> Uwe Ligges
>>>
>>>
>>>> I have no idea how to solve the first problem with references the tcltk
>>>> package and I do not know why my examples won't run.   Any help is
>>>> appreciated.
>>>>
>>>> dxc13
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From yohann.moreau at edf.fr  Tue Oct 28 14:10:33 2008
From: yohann.moreau at edf.fr (Yohann MOREAU)
Date: Tue, 28 Oct 2008 14:10:33 +0100
Subject: [Rd] Fixing an only one coefficient in an ARIMA model
Message-ID: <OFC91A14BC.3F21CA17-ONC12574F0.0047AF11-C12574F0.004857E6@notes.edfgdf.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081028/95021f8c/attachment.pl>

From maechler at stat.math.ethz.ch  Tue Oct 28 15:30:09 2008
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Tue, 28 Oct 2008 15:30:09 +0100 (CET)
Subject: [Rd] 2.8.0 release bugs (PR#13210)
Message-ID: <20081028143009.7EEC5282BEBF@mail.pubhealth.ku.dk>

Dear Janek,

>>>>> "jm" == janek musek <janek.musek at guest.arnes.si>
>>>>>     on Mon, 27 Oct 2008 20:30:10 +0100 (CET) writes:

    jm> Dear colleagues, Using the last release 2.8.0 I had (for
    jm> the first time since working with R) the difficulties in
    jm> transmission of some Central European letters (=B9=F0=
    jm> =E8=E6=BE) from R editor to the console and graphic
    jm> window. They appear correctly in commands in R editor
    jm> window, yet after executing ctrl R, they have been
    jm> transformed to other codes or blanks (in console and
    jm> graph devices).=20=20

    jm> No such troubles have ever met using previous
    jm> releases. How this can be explained?

I think it might be explainable (not by me though) 
once you provide more details, notably the output of 

   sessionInfo()

    jm> Thanks in advance,
    jm> Janek Musek

Regards, 
Martin Maechler, ETH Zurich


From simon.urbanek at r-project.org  Tue Oct 28 16:25:57 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 28 Oct 2008 11:25:57 -0400
Subject: [Rd] A question about the API mkchar()
In-Reply-To: <e936a3d0810280326x6df26d5cyd130af917b1b02c9@mail.gmail.com>
References: <e936a3d0810280326x6df26d5cyd130af917b1b02c9@mail.gmail.com>
Message-ID: <C704F47C-DD02-4659-8371-AFB1FFF593B1@r-project.org>

On Oct 28, 2008, at 6:26 , F?n L?ng wrote:

> Hi guys,
>

Hey guy :)


> I've got a question about the API mkchar(). I have met some  
> difficulty in parsing utf-8 string to mkchar() in R-2.7.0.
>

There is no mkchar() in R. Did you perhaps mean mkChar()?


> I was intending to parse an utf-8 string str_jan (some Japanese
> characters such as?, whose utf-8 code is E381B5

There is no such "UTF-8" code. I'm not sure if you meant Unicode, but  
that would be \u3075 (Hiragana hu) for that character. The UTF-8  
encoding of that character is a three-byte sequence 0xe3 0x81 0xb5 if  
that's what you meant.


> ) to R API SEXP
> mkChar(const char *name) , we only need to create the SEXP using the
> string that we parsed.
>
>
>
> Unfortunately, I found when parsing the variable str_jan, R will
> automatically convert the str_jan according to the current locale
> setting,

That is not true - it will be kept as-is regardless of the encoding.  
Note that mkChar(x) is equivalent to mkCharCE(x, CE_NATIVE); No  
conversion takes place when the string is created, but you have told R  
that it is in the native encoding. If that is not true (which is your  
case probably isn't), all bets are off since you're lying to R ;).


> so only in the English locale could the function work correctly,  
> under other locale, such as Japanese or Chinese, the string will be  
> convert incorrectly.

That is clearly a nonsense since the encoding has nothing to do with  
the locale language itself (Japanese, Chinese, ..). We are talking  
about the encoding (note that both English and Japanese locales can  
use UTF-8 encoding, but don't have to). I think you'll need to get the  
concepts right here - for each string you must define the encoding in  
order to be able to reproduce the unicode sequence that the string  
represents. At this point it has nothing to do with the language.


> As a matter of fact, those utf-8 code already is Unicode string, and  
> don't need to be converted at all.
>
> I also tried to use the SEXP Rf_mkCharCE(const char *, cetype_t);,  
> Parsing the CE_UTF8 as the argument of cetype_t, but the result is
> worse. It returned the result as ucs code, an kind of Unicode under  
> windows platform.
>

Well, that's exactly what you want, isn't it? The string is correctly  
flagged as UTF-8 so R is finally able to find out what exactly is  
represented by that string. However, your locale apparently doesn't  
support such characters so it cannot be displayed. If you use a locale  
that supports it, it works just fine, for example if you use local  
with SJIS encoding R will still know how to convert it from UTF-8 to  
SJIS *for display*. The actual string is not touched.

Here is a small piece of code that shows you the difference between  
native encoding and UTF8-strings:

#include <R.h>
#include <Rinternals.h>

SEXP me() {
   const char c[] = { 0xe3, 0x81, 0xb5, 0 };
   SEXP a = allocVector(STRSXP, 2);
   PROTECT(a);
   SET_STRING_ELT(a, 0, mkCharCE(c, CE_NATIVE));
   SET_STRING_ELT(a, 1, mkCharCE(c, CE_UTF8));
   UNPROTECT(1);
   return a;
}

In a UTF-8 locale it doesn't matter:

ginaz:sandbox$ LANG=ja_JP.UTF-8 R
 > .Call("me")
[1] "?" "?"

But in any other, let's say SJIS, it does:

ginaz:sandbox$ LANG=ja_JP.SJIS R
 > .Call("me")
[1] "??" "?"

Note that the first string is wrong, because we have supplied UTF-8  
encoding but the current one is SJIS. The second one is correct since  
we told R that it's UTF-8 encoded.

Finally, if the character cannot be displayed in the given encoding:

ginaz:sandbox$ LANG=en_US.US-ASCII R
 > .Call("me")
[1] "\343\201\265" "<U+3075>"

The first one is wrong again, since it's not flagged as UTF8, but the  
second one is exactly as expected - unicode 3075 which is the Hiragana  
"hu". It doesn't exist in US-ASCII so unicode designation is all you  
can display.


> All I want to get is just a SEXP object containing the original  
> utf-8 string, no matter what locale is set currently. Normally what  
> can I do?
>

mkChar(X, CE_UTF8);

Cheers,
Simon


From jmc at r-project.org  Tue Oct 28 16:50:38 2008
From: jmc at r-project.org (John Chambers)
Date: Tue, 28 Oct 2008 11:50:38 -0400
Subject: [Rd] Arith ops dropping S4 bit [Was: S4 object does not
 commute? (PR#13209)]
In-Reply-To: <607768E4-A332-4AD9-8F22-F89CA88B5C61@r-project.org>
References: <20081027162507.CD7BC283416A@mail.pubhealth.ku.dk>
	<607768E4-A332-4AD9-8F22-F89CA88B5C61@r-project.org>
Message-ID: <490734CE.3070607@r-project.org>

The asymmetry is just the symptom of a more fundamental issue: There are 
no operator methods currently defined for "vector" classes, either 
combined with each other or with a non-S4 object.

The consequence is that computations drop through to the primitive C 
code. Not a good idea, because that code does various things to objects 
with attributes, some of them bizarre and most of them not what should 
logically happen for S4 classes.

Consider two classes with slightly more content than "test":
 > setClass("test1",contains = "vector", representation(label = 
"character"))
[1] "test1"
 > setClass("test2",contains = "vector", representation(flag = "logical"))
[1] "test2"

These two classes both inherit from "vector" but are unrelated to each 
other.

What should happen for arithmetic and other operators combining these 
two classes? There's some scope for discussion, but a reasonable policy 
is that the vector parts should be used and a result returned that is a 
simple vector. What should NOT happen is that one class is retained and 
the other thrown away--that's not a meaningful interpretation of the two 
definitions here. Unfortunately, that's what does happen with the 
primitives. Example below.

We need to develop some methods for combinations of "vector" and "ANY" 
reflecting what's sensible. I'll put some first attempts on r-devel and 
we can discuss what's wanted. (May not happen right away, but hopefully 
in a week or two.)

John

---------------------

Example:

If the objects are equal in length, the left operand wins, or seems to:

 > x1 = new("test1", 1:10, label = "Something")
 > x2 = new("test2", 10:1, flag = rep(TRUE, 10))
 > x1+x2
An object of class ?test1?
[1] 11 11 11 11 11 11 11 11 11 11
Slot "label":
[1] "Something"

 > x2+x1
An object of class ?test2?
[1] 11 11 11 11 11 11 11 11 11 11
Slot "flag":
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

But in fact, it's weirder than that, because _all_ the attributes are 
retained:

 > names(attributes(x1+x2))
[1] "flag" "class" "label"
 > names(attributes(x2+x1))
[1] "label" "class" "flag"


That was with equal lengths. Otherwise, the code uses the longer 
object's attributes, including the class.

 > x11 = new("test1", 101:105,label = "Smaller")
 > x11 +x2
An object of class ?test2?
[1] 111 111 111 111 111 106 106 106 106 106
Slot "flag":
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

 > x2+x11
An object of class ?test2?
[1] 111 111 111 111 111 106 106 106 106 106
Slot "flag":
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 > names(attributes(x11+x2))
[1] "flag" "class"



Simon Urbanek wrote:
>
> On Oct 27, 2008, at 12:25 , Robert.McGehee at geodecapital.com wrote:
>
>> Hello all,
>> It appears that for the simplest of S4 objects, z+1 does not equal 1+z.
>> Presumably this is a bug, as 1+z seems to make a malformed object (at
>> least malformed as an input to str).
>
> FWIW the difference is that z+1 has the S4 bit set, 1+z does not. The 
> objects are otherwise identical. AFAICS the same behavior is 
> reproducible with any binary arithmetic operator (i.e. non-S4 %op% S4 
> will produce a result with S4 bit cleared yet valid S4 attributes).
>
> Cheers,
> S
>
>
>
>>
>>> setClass("test", representation("vector"))
>> [1] "test"
>>> z <- new("test", 1)
>>> identical(z+1, 1+z)
>> [1] FALSE
>>> str(z+1)
>> Formal class 'test' [package ".GlobalEnv"] with 1 slots
>> ..@ .Data: num 2
>>> str(1+z)
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Error: evaluation nested too deeply: infinite
>> recursion / options(expressions=3D)?
>>
>>> R.version
>> _ =20
>> platform x86_64-unknown-linux-gnu =20
>> arch x86_64 =20
>> os linux-gnu =20
>> system x86_64, linux-gnu =20
>> status =20
>> major 2 =20
>> minor 8.0 =20
>> year 2008 =20
>> month 10 =20
>> day 20 =20
>> svn rev 46754 =20
>> language R =20
>> version.string R version 2.8.0 (2008-10-20)
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jmc at r-project.org  Tue Oct 28 16:55:06 2008
From: jmc at r-project.org (jmc at r-project.org)
Date: Tue, 28 Oct 2008 16:55:06 +0100 (CET)
Subject: [Rd] Arith ops dropping S4 bit [Was: S4 object does not
	commute? (PR#13222)
Message-ID: <20081028155506.10A5B282BEBB@mail.pubhealth.ku.dk>

The asymmetry is just the symptom of a more fundamental issue: There are 
no operator methods currently defined for "vector" classes, either 
combined with each other or with a non-S4 object.

The consequence is that computations drop through to the primitive C 
code. Not a good idea, because that code does various things to objects 
with attributes, some of them bizarre and most of them not what should 
logically happen for S4 classes.

Consider two classes with slightly more content than "test":
 > setClass("test1",contains = "vector", representation(label = 
"character"))
[1] "test1"
 > setClass("test2",contains = "vector", representation(flag = "logical"))
[1] "test2"

These two classes both inherit from "vector" but are unrelated to each 
other.

What should happen for arithmetic and other operators combining these 
two classes? There's some scope for discussion, but a reasonable policy 
is that the vector parts should be used and a result returned that is a 
simple vector. What should NOT happen is that one class is retained and 
the other thrown away--that's not a meaningful interpretation of the two 
definitions here. Unfortunately, that's what does happen with the 
primitives. Example below.

We need to develop some methods for combinations of "vector" and "ANY" 
reflecting what's sensible. I'll put some first attempts on r-devel and 
we can discuss what's wanted. (May not happen right away, but hopefully 
in a week or two.)

John

---------------------

Example:

If the objects are equal in length, the left operand wins, or seems to:

 > x1 = new("test1", 1:10, label = "Something")
 > x2 = new("test2", 10:1, flag = rep(TRUE, 10))
 > x1+x2
An object of class ?test1?
[1] 11 11 11 11 11 11 11 11 11 11
Slot "label":
[1] "Something"

 > x2+x1
An object of class ?test2?
[1] 11 11 11 11 11 11 11 11 11 11
Slot "flag":
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

But in fact, it's weirder than that, because _all_ the attributes are 
retained:

 > names(attributes(x1+x2))
[1] "flag" "class" "label"
 > names(attributes(x2+x1))
[1] "label" "class" "flag"


That was with equal lengths. Otherwise, the code uses the longer 
object's attributes, including the class.

 > x11 = new("test1", 101:105,label = "Smaller")
 > x11 +x2
An object of class ?test2?
[1] 111 111 111 111 111 106 106 106 106 106
Slot "flag":
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

 > x2+x11
An object of class ?test2?
[1] 111 111 111 111 111 106 106 106 106 106
Slot "flag":
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 > names(attributes(x11+x2))
[1] "flag" "class"



Simon Urbanek wrote:
>
> On Oct 27, 2008, at 12:25 , Robert.McGehee at geodecapital.com wrote:
>
>> Hello all,
>> It appears that for the simplest of S4 objects, z+1 does not equal 1+z.
>> Presumably this is a bug, as 1+z seems to make a malformed object (at
>> least malformed as an input to str).
>
> FWIW the difference is that z+1 has the S4 bit set, 1+z does not. The 
> objects are otherwise identical. AFAICS the same behavior is 
> reproducible with any binary arithmetic operator (i.e. non-S4 %op% S4 
> will produce a result with S4 bit cleared yet valid S4 attributes).
>
> Cheers,
> S
>
>
>
>>
>>> setClass("test", representation("vector"))
>> [1] "test"
>>> z <- new("test", 1)
>>> identical(z+1, 1+z)
>> [1] FALSE
>>> str(z+1)
>> Formal class 'test' [package ".GlobalEnv"] with 1 slots
>> ..@ .Data: num 2
>>> str(1+z)
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
>> Class 'test' Class 'test' Error: evaluation nested too deeply: infinite
>> recursion / options(expressions=3D)?
>>
>>> R.version
>> _ =20
>> platform x86_64-unknown-linux-gnu =20
>> arch x86_64 =20
>> os linux-gnu =20
>> system x86_64, linux-gnu =20
>> status =20
>> major 2 =20
>> minor 8.0 =20
>> year 2008 =20
>> month 10 =20
>> day 20 =20
>> svn rev 46754 =20
>> language R =20
>> version.string R version 2.8.0 (2008-10-20)
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Greg.Snow at imail.org  Tue Oct 28 19:23:54 2008
From: Greg.Snow at imail.org (Greg Snow)
Date: Tue, 28 Oct 2008 12:23:54 -0600
Subject: [Rd] writting null (\000 or ^@) to an external text file without
 the new warning
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>

I have some functions that write an external text file for postprocessing by another program.  Some instructions to the other program need to be indicated by null values (\000 or ^@).  The function currently uses code like:

writeChar(rawToChar(as.raw(0)), con)

where con is a connection to the file.  Previous to version 2.8.0 this worked fine.  With 2.8.0 it still works, but I get a warning message about "truncating string with embedded null: '\0'" every time.  This is documented and not a bug, but I still find it annoying.

One thing I could do is to turn off all warnings before doing this, but then if there is some other warning generated, then I will miss the other warning(s).

Is there a better way to write the null to the text file? Or is there a way to suppress just this warning without suppressing any other warnings that may occur?

Thanks,

--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


From b.rowlingson at lancaster.ac.uk  Tue Oct 28 20:57:07 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 28 Oct 2008 19:57:07 +0000
Subject: [Rd] writting null (\000 or ^@) to an external text file
	without the new warning
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <d8ad40b50810281257o2fb044c3s2658cc3e5a77fd94@mail.gmail.com>

2008/10/28 Greg Snow <Greg.Snow at imail.org>:
> I have some functions that write an external text file for postprocessing by another program.  Some instructions to the other program need to be indicated by null values (\000 or ^@).  The function currently uses code like:
>
> writeChar(rawToChar(as.raw(0)), con)
>
> where con is a connection to the file.  Previous to version 2.8.0 this worked fine.  With 2.8.0 it still works, but I get a warning message about "truncating string with embedded null: '\0'" every time.  This is documented and not a bug, but I still find it annoying.
>
> One thing I could do is to turn off all warnings before doing this, but then if there is some other warning generated, then I will miss the other warning(s).
>
> Is there a better way to write the null to the text file? Or is there a way to suppress just this warning without suppressing any other warnings that may occur?

 The warning happens when you construct the string, so somehow you
have to avoid making the string. How about using writeBin with a
connection opened in binary mode:

 > con=file("test2.raw","wb")
 > writeBin(as.raw(1),con,size=1)
 > writeBin(as.raw(0),con,size=1)
 > writeBin(as.raw(0),con,size=1)
 > writeBin(as.raw(7),con,size=1)
 > close(con)
 >
Save workspace image? [y/n/c]: n

 now lets dump it:

 rowlings at fab008000006:~$ od -x test2.raw
 0000000 0001 0700
 0000004

 Which I think is correct, maybe some fiddling with endianness is needed...

Barry


From simon.urbanek at r-project.org  Tue Oct 28 22:19:35 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 28 Oct 2008 17:19:35 -0400
Subject: [Rd] writting null (\000 or ^@) to an external text file
	without the new warning
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <B8AB976F-211D-49FD-876E-A41E95CE8109@r-project.org>


On Oct 28, 2008, at 14:23 , Greg Snow wrote:

> I have some functions that write an external text file for  
> postprocessing by another program.  Some instructions to the other  
> program need to be indicated by null values (\000 or ^@).  The  
> function currently uses code like:
>
> writeChar(rawToChar(as.raw(0)), con)
>
> where con is a connection to the file.  Previous to version 2.8.0  
> this worked fine.  With 2.8.0 it still works, but I get a warning  
> message about "truncating string with embedded null: '\0'" every  
> time.  This is documented and not a bug, but I still find it annoying.
>

Well, why don't you just use
writeChar("", con)
that's what you're actually calling anyway since rawToChar(as.raw(0))  
is exactly "" as it gets truncated.

Cheers,
S



> One thing I could do is to turn off all warnings before doing this,  
> but then if there is some other warning generated, then I will miss  
> the other warning(s).
>
> Is there a better way to write the null to the text file? Or is  
> there a way to suppress just this warning without suppressing any  
> other warnings that may occur?
>
> Thanks,
>
> --
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From Greg.Snow at imail.org  Tue Oct 28 22:32:12 2008
From: Greg.Snow at imail.org (Greg Snow)
Date: Tue, 28 Oct 2008 15:32:12 -0600
Subject: [Rd] writting null (\000 or ^@) to an external text file
 without the new warning
In-Reply-To: <B8AB976F-211D-49FD-876E-A41E95CE8109@r-project.org>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>
	<B8AB976F-211D-49FD-876E-A41E95CE8109@r-project.org>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5EB06@LP-EXMBVS10.CO.IHC.COM>

Thanks, I had assumed that writeChar("",con) would write 0 bytes to the file and had seen the other construct somewhere else.  A quick test of writeChar("",con) does have the ^@ (when viewed in emacs) in the correct place, and there were no warnings, so I will change to that.

Thanks again,

--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: Simon Urbanek [mailto:simon.urbanek at r-project.org]
> Sent: Tuesday, October 28, 2008 3:20 PM
> To: Greg Snow
> Cc: R-devel at r-project.org
> Subject: Re: [Rd] writting null (\000 or ^@) to an external text file
> without the new warning
>
>
> On Oct 28, 2008, at 14:23 , Greg Snow wrote:
>
> > I have some functions that write an external text file for
> > postprocessing by another program.  Some instructions to the other
> > program need to be indicated by null values (\000 or ^@).  The
> > function currently uses code like:
> >
> > writeChar(rawToChar(as.raw(0)), con)
> >
> > where con is a connection to the file.  Previous to version 2.8.0
> > this worked fine.  With 2.8.0 it still works, but I get a warning
> > message about "truncating string with embedded null: '\0'" every
> > time.  This is documented and not a bug, but I still find it
> annoying.
> >
>
> Well, why don't you just use
> writeChar("", con)
> that's what you're actually calling anyway since rawToChar(as.raw(0))
> is exactly "" as it gets truncated.
>
> Cheers,
> S
>
>
>
> > One thing I could do is to turn off all warnings before doing this,
> > but then if there is some other warning generated, then I will miss
> > the other warning(s).
> >
> > Is there a better way to write the null to the text file? Or is
> > there a way to suppress just this warning without suppressing any
> > other warnings that may occur?
> >
> > Thanks,
> >
> > --
> > Gregory (Greg) L. Snow Ph.D.
> > Statistical Data Center
> > Intermountain Healthcare
> > greg.snow at imail.org
> > 801.408.8111
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >


From simon.urbanek at r-project.org  Tue Oct 28 23:09:51 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 28 Oct 2008 18:09:51 -0400
Subject: [Rd] writting null (\000 or ^@) to an external text file
	without the new warning
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5EB06@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5E981@LP-EXMBVS10.CO.IHC.COM>
	<B8AB976F-211D-49FD-876E-A41E95CE8109@r-project.org>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5EB06@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <D783C9DC-3B37-4AEC-B898-869896A6B330@r-project.org>


On Oct 28, 2008, at 17:32 , Greg Snow wrote:

> Thanks, I had assumed that writeChar("",con) would write 0 bytes to  
> the file and had seen the other construct somewhere else.  A quick  
> test of writeChar("",con) does have the ^@ (when viewed in emacs) in  
> the correct place, and there were no warnings, so I will change to  
> that.
>

Note that writeChar writes the string *and* EOS. writeChar("", con)  
writes nothing for the string so what you get is just the EOS which is  
one 0x00 byte. That gives you your \000. You previous construct was  
simply a noop because your output string was always irrelevant (just  
try nchar(rawToChar(as.raw(0))).

Cheers,
S


> --
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
>
>
>> -----Original Message-----
>> From: Simon Urbanek [mailto:simon.urbanek at r-project.org]
>> Sent: Tuesday, October 28, 2008 3:20 PM
>> To: Greg Snow
>> Cc: R-devel at r-project.org
>> Subject: Re: [Rd] writting null (\000 or ^@) to an external text file
>> without the new warning
>>
>>
>> On Oct 28, 2008, at 14:23 , Greg Snow wrote:
>>
>>> I have some functions that write an external text file for
>>> postprocessing by another program.  Some instructions to the other
>>> program need to be indicated by null values (\000 or ^@).  The
>>> function currently uses code like:
>>>
>>> writeChar(rawToChar(as.raw(0)), con)
>>>
>>> where con is a connection to the file.  Previous to version 2.8.0
>>> this worked fine.  With 2.8.0 it still works, but I get a warning
>>> message about "truncating string with embedded null: '\0'" every
>>> time.  This is documented and not a bug, but I still find it
>> annoying.
>>>
>>
>> Well, why don't you just use
>> writeChar("", con)
>> that's what you're actually calling anyway since rawToChar(as.raw(0))
>> is exactly "" as it gets truncated.
>>
>> Cheers,
>> S
>>
>>
>>
>>> One thing I could do is to turn off all warnings before doing this,
>>> but then if there is some other warning generated, then I will miss
>>> the other warning(s).
>>>
>>> Is there a better way to write the null to the text file? Or is
>>> there a way to suppress just this warning without suppressing any
>>> other warnings that may occur?
>>>
>>> Thanks,
>>>
>>> --
>>> Gregory (Greg) L. Snow Ph.D.
>>> Statistical Data Center
>>> Intermountain Healthcare
>>> greg.snow at imail.org
>>> 801.408.8111
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>
>


From dutangc at gmail.com  Wed Oct 29 13:14:38 2008
From: dutangc at gmail.com (christophe dutang)
Date: Wed, 29 Oct 2008 13:14:38 +0100
Subject: [Rd] percent concordant function
Message-ID: <c8e8cd3d0810290514p37e6e1ua741abe43b2baa26@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081029/fba82584/attachment.pl>

From Christian.Kohler at klinik.uni-regensburg.de  Wed Oct 29 16:51:16 2008
From: Christian.Kohler at klinik.uni-regensburg.de (Christian Kohler)
Date: Wed, 29 Oct 2008 16:51:16 +0100
Subject: [Rd] problems installing rJava with R-2.8.0
Message-ID: <49088674.6090407@klinik.uni-regensburg.de>

Dear R-developers,

I am having trouble installing rJava on R 2.8.0 / debian etch.

What goes wrong?

I am happy for every advice.

Best,
Christian



> install.packages("rJava")
Warning in install.packages("rJava") :
  argument 'lib' is missing: using
'/nfs/compdiag/package/R/lib/bioconductor/release_2.3/x86_64'
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
trying URL 'http://cran.rakanu.com/src/contrib/rJava_0.6-0.tar.gz'
Content type 'application/x-gzip' length 234704 bytes (229 Kb)
opened URL
==================================================
downloaded 229 Kb

* Installing *source* package 'rJava' ...
checking for gcc... gcc -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/wait.h that is POSIX.1 compatible... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for string.h... (cached) yes
checking sys/time.h usability... yes
checking sys/time.h presence... yes
checking for sys/time.h... yes
checking for unistd.h... (cached) yes
checking for an ANSI C-conforming const... yes
checking whether time.h and sys/time.h may both be included... yes
configure: checking whether gcc -std=gnu99 supports static inline...
yes
checking Java support in R... present:
interpreter : '/usr/lib/jvm/java-1.5.0-sun/jre/bin/java'
archiver    : '/usr/lib/jvm/java-1.5.0-sun/bin/jar'
compiler    : '/usr/lib/jvm/java-1.5.0-sun/bin/javac'
header prep.: '/usr/lib/jvm/java-1.5.0-sun/bin/javah'
cpp flags   : '-I/usr/lib/jvm/java-1.5.0-sun/include
-I/usr/lib/jvm/java-1.5.0-sun/include/linux'
java libs   :
'-L/usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/lib/amd64/server
-L/usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/lib/amd64
-L/usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/../lib/amd64
-L/usr/local/lib64 -ljvm'
checking whether JNI programs can be compiled... yes
checking JNI data types... configure: error: One or more JNI types
differ from the corresponding native type. You may need to use
non-standard compiler flags or a different compiler in order to fix this.
ERROR: configuration failed for package 'rJava'
** Removing
'/nfs/compdiag/package/R/lib/bioconductor/release_2.3/x86_64/rJava'

The downloaded packages are in
        /nfs/scratch/Rtmp/RtmpUMDzVa/downloaded_packages
Warning message:
In install.packages("rJava") :
  installation of package 'rJava' had non-zero exit status


> sessionInfo()
R version 2.8.0 (2008-10-20)
x86_64-unknown-linux-gnu

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tcltk_2.8.0 tools_2.8.0









-- 

Christian Kohler
Institute of Functional Genomics
Computational Diagnostics
University of Regensburg (BioPark I)
D-93147 Regensburg (Germany)

Tel. +49 941 943 5055
Fax  +49 941 943 5020
christian.kohler at klinik.uni-regensburg.de


From pgilbert at bank-banque-canada.ca  Wed Oct 29 17:09:37 2008
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 29 Oct 2008 12:09:37 -0400
Subject: [Rd] namespace import warning
Message-ID: <49088AC1.3080803@bank-banque-canada.ca>

When I require() some of my packages I am getting the warning

Warning message:
In namespaceImportFrom(self, asNamespace(ns)) :
  replacing previous import: show

I think this is coming from a chain of dependencies that result in the 
NAMESPACE from something (e.g. methods) being imported twice, but I 
can't figure it out, and don't really even see how to debug it. (One of 
my packages defines a method for show, but not a generic.)

Any suggestions?

Thanks,
Paul
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential in...{{dropped:26}}


From simon.urbanek at r-project.org  Wed Oct 29 17:10:17 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 29 Oct 2008 12:10:17 -0400
Subject: [Rd] problems installing rJava with R-2.8.0
In-Reply-To: <49088674.6090407@klinik.uni-regensburg.de>
References: <49088674.6090407@klinik.uni-regensburg.de>
Message-ID: <60E734B6-1D34-4C27-8C16-2E07041C07DF@r-project.org>


On Oct 29, 2008, at 11:51 , Christian Kohler wrote:

> Dear R-developers,
>
> I am having trouble installing rJava on R 2.8.0 / debian etch.
>
> What goes wrong?
>

Please send me the config.log. Also make sure you have configured R  
with Java support (sudo R CMD javareconf).

Cheers,
S


>
>> install.packages("rJava")
> Warning in install.packages("rJava") :
>  argument 'lib' is missing: using
> '/nfs/compdiag/package/R/lib/bioconductor/release_2.3/x86_64'
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> trying URL 'http://cran.rakanu.com/src/contrib/rJava_0.6-0.tar.gz'
> Content type 'application/x-gzip' length 234704 bytes (229 Kb)
> opened URL
> ==================================================
> downloaded 229 Kb
>
> * Installing *source* package 'rJava' ...
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/wait.h that is POSIX.1 compatible... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking for string.h... (cached) yes
> checking sys/time.h usability... yes
> checking sys/time.h presence... yes
> checking for sys/time.h... yes
> checking for unistd.h... (cached) yes
> checking for an ANSI C-conforming const... yes
> checking whether time.h and sys/time.h may both be included... yes
> configure: checking whether gcc -std=gnu99 supports static inline...
> yes
> checking Java support in R... present:
> interpreter : '/usr/lib/jvm/java-1.5.0-sun/jre/bin/java'
> archiver    : '/usr/lib/jvm/java-1.5.0-sun/bin/jar'
> compiler    : '/usr/lib/jvm/java-1.5.0-sun/bin/javac'
> header prep.: '/usr/lib/jvm/java-1.5.0-sun/bin/javah'
> cpp flags   : '-I/usr/lib/jvm/java-1.5.0-sun/include
> -I/usr/lib/jvm/java-1.5.0-sun/include/linux'
> java libs   :
> '-L/usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/lib/amd64/server
> -L/usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/lib/amd64
> -L/usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/../lib/amd64
> -L/usr/local/lib64 -ljvm'
> checking whether JNI programs can be compiled... yes
> checking JNI data types... configure: error: One or more JNI types
> differ from the corresponding native type. You may need to use
> non-standard compiler flags or a different compiler in order to fix  
> this.
> ERROR: configuration failed for package 'rJava'
> ** Removing
> '/nfs/compdiag/package/R/lib/bioconductor/release_2.3/x86_64/rJava'
>
> The downloaded packages are in
>        /nfs/scratch/Rtmp/RtmpUMDzVa/downloaded_packages
> Warning message:
> In install.packages("rJava") :
>  installation of package 'rJava' had non-zero exit status
>
>
>> sessionInfo()
> R version 2.8.0 (2008-10-20)
> x86_64-unknown-linux-gnu
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tcltk_2.8.0 tools_2.8.0
>
>
>
>
>
>
>
>
>
> -- 
>
> Christian Kohler
> Institute of Functional Genomics
> Computational Diagnostics
> University of Regensburg (BioPark I)
> D-93147 Regensburg (Germany)
>
> Tel. +49 941 943 5055
> Fax  +49 941 943 5020
> christian.kohler at klinik.uni-regensburg.de
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From katrina.chu at unb.ca  Wed Oct 29 15:05:05 2008
From: katrina.chu at unb.ca (katrina.chu at unb.ca)
Date: Wed, 29 Oct 2008 15:05:05 +0100 (CET)
Subject: [Rd] cochran.test {outliers} (PR#13227)
Message-ID: <20081029140505.7F00E282C787@mail.pubhealth.ku.dk>

Full_Name: Katrina Chu
Version: R 2.7.2 GUI 1.25 (5217)
OS: Mac OS X Version 10.4.11 (Tiger)
Submission from: (NULL) (131.202.107.54)


I've been using Cochran's Test to check for outlying variance.  I noticed that
the degrees of freedom that are calculated and output are incorrect.  The author
has forgotten to take into account that df=n-1 and appears to have just left
df=n.  n=# samples per treatment and in the case where n is unequal across
treatments, I believe that the average samples per treatment can be calculated,
then minus 1.


From bolker at zoology.ufl.edu  Wed Oct 29 23:09:05 2008
From: bolker at zoology.ufl.edu (Ben Bolker)
Date: Wed, 29 Oct 2008 18:09:05 -0400
Subject: [Rd] R books: self-serving question
Message-ID: <4908DF01.2080705@zoology.ufl.edu>


  thought someone here might know:

  how would I go about nominating my book
(Ecological Models and Data in R, Princeton
University Press 2008) for inclusion
in the R books page ... ?  I can supply
bibliographic data, blurb etc.  ...

  cheers
    Ben Bolker

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 252 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081029/62ee83a1/attachment.bin>

From p.dalgaard at biostat.ku.dk  Wed Oct 29 23:56:15 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 29 Oct 2008 23:56:15 +0100
Subject: [Rd] R books: self-serving question
In-Reply-To: <4908DF01.2080705@zoology.ufl.edu>
References: <4908DF01.2080705@zoology.ufl.edu>
Message-ID: <4908EA0F.90906@biostat.ku.dk>

Ben Bolker wrote:
>   thought someone here might know:
> 
>   how would I go about nominating my book
> (Ecological Models and Data in R, Princeton
> University Press 2008) for inclusion
> in the R books page ... ?  I can supply
> bibliographic data, blurb etc.  ...
> 
>   cheers
>     Ben Bolker

I think you just fill in a BibTeX entry like this one

http://www.r-project.org/doc/bib/R-books_bib.html#R:Dalgaard:2008

and send it off to ...er... well, I suppose anyone on the Core Team has 
write access, but some may be less liable to get it wrong than others. 
Most commits are by Kurt Hornik.

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From gkerns at ysu.edu  Thu Oct 30 02:28:52 2008
From: gkerns at ysu.edu (G. Jay Kerns)
Date: Wed, 29 Oct 2008 21:28:52 -0400
Subject: [Rd] R books: self-serving question
In-Reply-To: <4908EA0F.90906@biostat.ku.dk>
References: <4908DF01.2080705@zoology.ufl.edu> <4908EA0F.90906@biostat.ku.dk>
Message-ID: <a695148b0810291828v511137e9tfca9a071578d5b4f@mail.gmail.com>

Dear Ben, Peter, et al:

On Wed, Oct 29, 2008 at 6:56 PM, Peter Dalgaard
<p.dalgaard at biostat.ku.dk> wrote:
> Ben Bolker wrote:
>>
>>  thought someone here might know:
>>
>>  how would I go about nominating my book
>> (Ecological Models and Data in R, Princeton
>> University Press 2008) for inclusion
>> in the R books page ... ?  I can supply
>> bibliographic data, blurb etc.  ...
>>
>>  cheers
>>    Ben Bolker
>
> I think you just fill in a BibTeX entry like this one
>
> http://www.r-project.org/doc/bib/R-books_bib.html#R:Dalgaard:2008
>
> and send it off to ...er... well, I suppose anyone on the Core Team has
> write access, but some may be less liable to get it wrong than others. Most
> commits are by Kurt Hornik.
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>

First:  IMHO, there is nothing better than an *official* listing on
the R-Project home page.

At the same time, I got it in my mind a few months back (while working
on a Teaching Task View) that an additional good place for such
listings would be the R-Wiki:

http://wiki.r-project.org/rwiki/doku.php?id=links:books

There, books could be loosely organized by subject, author, ...
whatever.  Further, people could directly link from their book listing
to CRAN package(s) associated with the book.  The wiki is set up to do
this easily.

In this way, the responsibility for updates (new editions), listing in
appropriate category, accuracy, etc would shift more to the author,
and less to R-Core.  (not that Kurt doesn't have enough to do..  :-)

The R-Wiki syntax is easy, but not instantly obvious.  I quickly threw
together some instructions on how to add books to the Wiki:

http://www.cc.ysu.edu/~gjkerns/addRbook.pdf

I went to the link that Peter suggested above and tweaked the BibTeX
to R-Wiki-speak (they are not identical).  This is how far I got:

http://www.cc.ysu.edu/~gjkerns/bibtexModified.txt

At that point, I got busy with writing papers, new semester, new baby
on the way; time disappears.  In addition, I had some questions about
linking to commercial sites from the wiki, how to organize the
subjects, and who does(n't) want their book listed - although my guess
is that authors have a vested interest in their book being listed, and
accurately.


Any suggestions?  Good idea, bad idea?  Full speed ahead or slam on the brakes?

Best,
Jay










***************************************************
G. Jay Kerns, Ph.D.
Associate Professor
Department of Mathematics & Statistics
Youngstown State University
Youngstown, OH 44555-0002 USA
Office: 1035 Cushwa Hall
Phone: (330) 941-3310 Office (voice mail)
-3302 Department
-3170 FAX
E-mail: gkerns at ysu.edu
http://www.cc.ysu.edu/~gjkerns/

From wdunlap at tibco.com  Thu Oct 30 05:00:07 2008
From: wdunlap at tibco.com (wdunlap at tibco.com)
Date: Thu, 30 Oct 2008 05:00:07 +0100 (CET)
Subject: [Rd] row.names(data.frame(matrixWithDimnames)) depends on first
	rowname being "" or not. (PR#13230)
Message-ID: <20081030040007.CCD11282EFC1@mail.pubhealth.ku.dk>

Full_Name: Bill Dunlap
Version: R version 2.9.0 Under development (unstable) (2008-10-29 r46795) 
OS: Linux
Submission from: (NULL) (76.28.245.14)


When data.frame() is given a matrix with rownames, then the type of the output
row names depends on whether the first element of the input row names is "" or
not.   The other elements of the input row names don't affect things.  E.g.,

> data.frame(matrix(1:6, nrow=3, ncol=2, dimnames=list(c("","Row 2","Row 3"),
paste("Col",1:2))))
  Col.1 Col.2
1     1     4
2     2     5
3     3     6
> data.frame(matrix(1:6, nrow=3, ncol=2, dimnames=list(c("Row 1","","Row 3"),
paste("Col",1:2))))
      Col.1 Col.2
Row 1     1     4
          2     5
Row 3     3     6

I noticed this when converting a table of word counts (by speaker) into a
data.frame and the word "" came first in the collating sequence so the words did
not become the row names of the output.  If the "" was not first in the table
then the row names of the input were carried into the output.

I haven't had the time yet to make a fix for this, but the distinction between
row.names[1] != or == "" comes from code in data.frame() itself (not
as.data.frame.matrix):

     81         if (missing(row.names) && nrows[i] > 0L) {
     82             rowsi <- attr(xi, "row.names")
     83             if (!(rowsi[[1L]] %in% ""))
     84                 row.names <- data.row.names(row.names, rowsi,
     85                   i)
     86         }

Why is that check there?

Bill Dunlap
TIBCO Spotfire
wdunlap tibco.com


From sundar.dorai-raj at pdf.com  Thu Oct 30 06:10:05 2008
From: sundar.dorai-raj at pdf.com (sundar.dorai-raj at pdf.com)
Date: Thu, 30 Oct 2008 06:10:05 +0100 (CET)
Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
Message-ID: <20081030051005.4800E282EFC1@mail.pubhealth.ku.dk>

Full_Name: Sundar Dorai-Raj
Version: 2.8.0
OS: Windows
Submission from: (NULL) (76.220.41.126)


The following code crashes R:

library(tcltk)
tt <- tktoplevel()
tc <- tkcanvas(tt, yscrollcommand = function(...) tkset(ts, ...))

> sessionInfo()
R version 2.8.0 (2008-10-20) 
i386-pc-mingw32 

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
States.1252;LC_MONETARY=English_United
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] tcltk     stats     graphics  grDevices utils     datasets  methods  
[8] base


From felix at nfrac.org  Thu Oct 30 07:40:17 2008
From: felix at nfrac.org (Felix Andrews)
Date: Thu, 30 Oct 2008 17:40:17 +1100
Subject: [Rd] conditionally import a namespace?
Message-ID: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>

Dear R-devel,

I have a problem defining the dependencies for a package.

My package (latticist, not yet released) "Suggests" RGtk2, but
specifically does not require it. If RGtk2 is available, the user can
call a function that builds a GUI with RGtk2. However, I do not want
to attach the RGtk2 namespace, because it is irrelevant to the user
and exports about 7500 symbols.

Last time I asked a similar question to this, Professor Ripley noted
that the usual method to get around this situation is the use an
explicit package prefix to function calls (the `::` operator). But
this is not so easy with non-standard functions. Take this chunk of
code:

widg <- gtkComboBoxEntryNewText()
widg$show()
widg["width-request"] <- 100

The first call is easy to prefix, as RGtk2::gtkComboBoxEntryNewText()
but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.

While I *could* rewrite all the code to use explicit functions, I
think, the resulting code would be much less clear.

Essentially what I want to do is conditionally import the RGtk2 namespace.

Any suggestions?

Thanks
Felix

-- 
Felix Andrews / ???
http://www.neurofractal.org/felix/
3358 543D AAC6 22C2 D336  80D9 360B 72DD 3E4C F5D8


From maechler at stat.math.ethz.ch  Thu Oct 30 12:20:13 2008
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Thu, 30 Oct 2008 12:20:13 +0100 (CET)
Subject: [Rd] (PR#13209) Arith ops dropping S4 *and* 'object' bit [Was:
	...]
Message-ID: <20081030112013.2B607282EFC1@mail.pubhealth.ku.dk>

>>>>> "JMC" == John Chambers <jmc at r-project.org>
>>>>>     on Tue, 28 Oct 2008 11:50:38 -0400 writes:

    JMC> The asymmetry is just the symptom of a more fundamental
    JMC> issue: There are no operator methods currently defined
    JMC> for "vector" classes, either combined with each other
    JMC> or with a non-S4 object.

    JMC> The consequence is that computations drop through to
    JMC> the primitive C code. Not a good idea, because that
    JMC> code does various things to objects with attributes,
    JMC> some of them bizarre and most of them not what should
    JMC> logically happen for S4 classes.

    JMC> Consider two classes with slightly more content than "test":
    >> setClass("test1",contains = "vector", representation(label= "character"))
    JMC> [1] "test1"
    >> setClass("test2",contains = "vector", representation(flag = "logical"))
    JMC> [1] "test2"

    JMC> These two classes both inherit from "vector" but are unrelated to each 
    JMC> other.

    JMC> What should happen for arithmetic and other operators
    JMC> combining these two classes? There's some scope for
    JMC> discussion, but a reasonable policy is that the vector
    JMC> parts should be used and a result returned that is a
    JMC> simple vector. What should NOT happen is that one class
    JMC> is retained and the other thrown away--that's not a
    JMC> meaningful interpretation of the two definitions
    JMC> here. Unfortunately, that's what does happen with the
    JMC> primitives. Example below.

    JMC> We need to develop some methods for combinations of "vector" and "ANY" 
    JMC> reflecting what's sensible. I'll put some first attempts on r-devel and 
    JMC> we can discuss what's wanted. (May not happen right away, but hopefully 
    JMC> in a week or two.)

That sounds very good !

Note that there's a related infelicity of primitives dealing
with class-attributes that does *not* involve S4 at all.

I'm adding an extra test to str() {i.e. str.default} in order to 
get rid of the infinite recursion in the following,
but we might also consider to change the behavior of '+' here :

## str() with an "invalid object"
ob <- structure(1, class = "test") # this is fine
is.object(ob)# TRUE
ob <- 1 + ob # << this is "broken"
is.object(ob)# FALSE - hmm, ....
identical(ob, unclass(ob)) # TRUE (!!!!)  and as a consequence :
str(ob)
## infinite recursion in R <= 2.8.0

--
Martin Maechler, ETH Zurich


    JMC> ---------------------

    JMC> Example:

    JMC> If the objects are equal in length, the left operand wins, or seems to:

    >> x1 = new("test1", 1:10, label = "Something")
    >> x2 = new("test2", 10:1, flag = rep(TRUE, 10))
    >> x1+x2
    JMC> An object of class ???test1???
    JMC> [1] 11 11 11 11 11 11 11 11 11 11
    JMC> Slot "label":
    JMC> [1] "Something"

    >> x2+x1
    JMC> An object of class ???test2???
    JMC> [1] 11 11 11 11 11 11 11 11 11 11
    JMC> Slot "flag":
    JMC> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

    JMC> But in fact, it's weirder than that, because _all_ the attributes are 
    JMC> retained:

    >> names(attributes(x1+x2))
    JMC> [1] "flag" "class" "label"
    >> names(attributes(x2+x1))
    JMC> [1] "label" "class" "flag"


    JMC> That was with equal lengths. Otherwise, the code uses the longer 
    JMC> object's attributes, including the class.

    >> x11 = new("test1", 101:105,label = "Smaller")
    >> x11 +x2
    JMC> An object of class ???test2???
    JMC> [1] 111 111 111 111 111 106 106 106 106 106
    JMC> Slot "flag":
    JMC> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE

    >> x2+x11
    JMC> An object of class ???test2???
    JMC> [1] 111 111 111 111 111 106 106 106 106 106
    JMC> Slot "flag":
    JMC> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
    >> names(attributes(x11+x2))
    JMC> [1] "flag" "class"



    JMC> Simon Urbanek wrote:
    >> 
    >> On Oct 27, 2008, at 12:25 , Robert.McGehee at geodecapital.com wrote:
    >> 
    >>> Hello all,
    >>> It appears that for the simplest of S4 objects, z+1 does not equal 1+z.
    >>> Presumably this is a bug, as 1+z seems to make a malformed object (at
    >>> least malformed as an input to str).
    >> 
    >> FWIW the difference is that z+1 has the S4 bit set, 1+z does not. The 
    >> objects are otherwise identical. AFAICS the same behavior is 
    >> reproducible with any binary arithmetic operator (i.e. non-S4 %op% S4 
    >> will produce a result with S4 bit cleared yet valid S4 attributes).
    >> 
    >> Cheers,
    >> S
    >> 
    >> 
    >> 
    >>> 
    >>>> setClass("test", representation("vector"))
    >>> [1] "test"
    >>>> z <- new("test", 1)
    >>>> identical(z+1, 1+z)
    >>> [1] FALSE
    >>>> str(z+1)
    >>> Formal class 'test' [package ".GlobalEnv"] with 1 slots
    >>> ..@ .Data: num 2
    >>>> str(1+z)
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class
    >>> 'test' Class 'test' Class 'test' Class 'test' Class 'test' Class 'test'
    >>> Class 'test' Class 'test' Error: evaluation nested too deeply: infinite
    >>> recursion / options(expressions=3D)?
    >>> 
    >>>> R.version
    >>> _ =20
    >>> platform x86_64-unknown-linux-gnu =20
    >>> arch x86_64 =20
    >>> os linux-gnu =20
    >>> system x86_64, linux-gnu =20
    >>> status =20
    >>> major 2 =20
    >>> minor 8.0 =20
    >>> year 2008 =20
    >>> month 10 =20
    >>> day 20 =20
    >>> svn rev 46754 =20
    >>> language R =20
    >>> version.string R version 2.8.0 (2008-10-20)
    >>> 
    >>> ______________________________________________
    >>> R-devel at r-project.org mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>> 
    >>> 
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 

    JMC> ______________________________________________
    JMC> R-devel at r-project.org mailing list
    JMC> https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Thu Oct 30 15:15:06 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 30 Oct 2008 15:15:06 +0100
Subject: [Rd] conditionally import a namespace?
In-Reply-To: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>
References: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>
Message-ID: <18697.49514.201691.329789@stat.math.ethz.ch>

>>>>> "FA" == Felix Andrews <felix at nfrac.org>
>>>>>     on Thu, 30 Oct 2008 17:40:17 +1100 writes:

    FA> Dear R-devel,
    FA> I have a problem defining the dependencies for a package.

    FA> My package (latticist, not yet released) "Suggests" RGtk2, but
    FA> specifically does not require it. If RGtk2 is available, the user can
    FA> call a function that builds a GUI with RGtk2. However, I do not want
    FA> to attach the RGtk2 namespace, because it is irrelevant to the user
    FA> and exports about 7500 symbols.

    FA> Last time I asked a similar question to this, Professor Ripley noted
    FA> that the usual method to get around this situation is the use an
    FA> explicit package prefix to function calls (the `::` operator). But
    FA> this is not so easy with non-standard functions. Take this chunk of
    FA> code:

    FA> widg <- gtkComboBoxEntryNewText()
    FA> widg$show()
    FA> widg["width-request"] <- 100

    FA> The first call is easy to prefix, as RGtk2::gtkComboBoxEntryNewText()
    FA> but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.

indeed.

    FA> While I *could* rewrite all the code to use explicit functions, I
    FA> think, the resulting code would be much less clear.

    FA> Essentially what I want to do is conditionally import the RGtk2 namespace.
    FA> Any suggestions?

Maybe something along the line of

if(is.function(try(RGtk2::gtkComboBoxEntryNewText))) {
   library(RGtk2)
   ....
   ....
}

??

Regards,
Martin


From jeff.a.ryan at gmail.com  Thu Oct 30 15:21:23 2008
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 30 Oct 2008 09:21:23 -0500
Subject: [Rd] conditionally import a namespace?
In-Reply-To: <18697.49514.201691.329789@stat.math.ethz.ch>
References: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>
	<18697.49514.201691.329789@stat.math.ethz.ch>
Message-ID: <e8e755250810300721o6edc1797wc48d4387e14ab0ed@mail.gmail.com>

Or something along the lines of:

Suggests: RGtk2

f <- function (x, ...)
{
    stopifnot("package:RGtk2" %in% search() || require("RGtk2", quietly = TRUE))
     # do Rgtk2 stuff here
}

Jeff

On Thu, Oct 30, 2008 at 9:15 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> "FA" == Felix Andrews <felix at nfrac.org>
>>>>>>     on Thu, 30 Oct 2008 17:40:17 +1100 writes:
>
>    FA> Dear R-devel,
>    FA> I have a problem defining the dependencies for a package.
>
>    FA> My package (latticist, not yet released) "Suggests" RGtk2, but
>    FA> specifically does not require it. If RGtk2 is available, the user can
>    FA> call a function that builds a GUI with RGtk2. However, I do not want
>    FA> to attach the RGtk2 namespace, because it is irrelevant to the user
>    FA> and exports about 7500 symbols.
>
>    FA> Last time I asked a similar question to this, Professor Ripley noted
>    FA> that the usual method to get around this situation is the use an
>    FA> explicit package prefix to function calls (the `::` operator). But
>    FA> this is not so easy with non-standard functions. Take this chunk of
>    FA> code:
>
>    FA> widg <- gtkComboBoxEntryNewText()
>    FA> widg$show()
>    FA> widg["width-request"] <- 100
>
>    FA> The first call is easy to prefix, as RGtk2::gtkComboBoxEntryNewText()
>    FA> but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.
>
> indeed.
>
>    FA> While I *could* rewrite all the code to use explicit functions, I
>    FA> think, the resulting code would be much less clear.
>
>    FA> Essentially what I want to do is conditionally import the RGtk2 namespace.
>    FA> Any suggestions?
>
> Maybe something along the line of
>
> if(is.function(try(RGtk2::gtkComboBoxEntryNewText))) {
>   library(RGtk2)
>   ....
>   ....
> }
>
> ??
>
> Regards,
> Martin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Jeffrey Ryan
jeffrey.ryan at insightalgo.com

ia: insight algorithmics
www.insightalgo.com


From murdoch at stats.uwo.ca  Thu Oct 30 15:44:30 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 30 Oct 2008 10:44:30 -0400
Subject: [Rd] conditionally import a namespace?
In-Reply-To: <18697.49514.201691.329789@stat.math.ethz.ch>
References: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>
	<18697.49514.201691.329789@stat.math.ethz.ch>
Message-ID: <4909C84E.70800@stats.uwo.ca>

On 10/30/2008 10:15 AM, Martin Maechler wrote:
>>>>>> "FA" == Felix Andrews <felix at nfrac.org>
>>>>>>     on Thu, 30 Oct 2008 17:40:17 +1100 writes:
> 
>     FA> Dear R-devel,
>     FA> I have a problem defining the dependencies for a package.
> 
>     FA> My package (latticist, not yet released) "Suggests" RGtk2, but
>     FA> specifically does not require it. If RGtk2 is available, the user can
>     FA> call a function that builds a GUI with RGtk2. However, I do not want
>     FA> to attach the RGtk2 namespace, because it is irrelevant to the user
>     FA> and exports about 7500 symbols.
> 
>     FA> Last time I asked a similar question to this, Professor Ripley noted
>     FA> that the usual method to get around this situation is the use an
>     FA> explicit package prefix to function calls (the `::` operator). But
>     FA> this is not so easy with non-standard functions. Take this chunk of
>     FA> code:
> 
>     FA> widg <- gtkComboBoxEntryNewText()
>     FA> widg$show()
>     FA> widg["width-request"] <- 100
> 
>     FA> The first call is easy to prefix, as RGtk2::gtkComboBoxEntryNewText()
>     FA> but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.
> 
> indeed.
> 
>     FA> While I *could* rewrite all the code to use explicit functions, I
>     FA> think, the resulting code would be much less clear.
> 
>     FA> Essentially what I want to do is conditionally import the RGtk2 namespace.
>     FA> Any suggestions?
> 
> Maybe something along the line of
> 
> if(is.function(try(RGtk2::gtkComboBoxEntryNewText))) {
>    library(RGtk2)
>    ....
>    ....
> }
> 
> ??

I think the problem is that that puts the namespace on the user's search 
list, which is what Felix wanted to avoid.  He would like to 
import(RGtk2), but only if it exists.

There are conditionals allowed in NAMESPACE files, but I don't know if 
they are allowed to be used to control imports.  They are not well 
documented -- they were called "experimental" when introduced in 1.9.0.

If this is allowed, then something like

if( "RGtk2" %in% rownames(installed.packages()) ) {
   import(RGtk2)
}

should work.

Duncan Murdoch


From murdoch at stats.uwo.ca  Thu Oct 30 16:03:53 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 30 Oct 2008 11:03:53 -0400
Subject: [Rd] conditionally import a namespace?
In-Reply-To: <4909C84E.70800@stats.uwo.ca>
References: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>	<18697.49514.201691.329789@stat.math.ethz.ch>
	<4909C84E.70800@stats.uwo.ca>
Message-ID: <4909CCD9.2070500@stats.uwo.ca>

On 10/30/2008 10:44 AM, Duncan Murdoch wrote:
> On 10/30/2008 10:15 AM, Martin Maechler wrote:
>>>>>>> "FA" == Felix Andrews <felix at nfrac.org>
>>>>>>>     on Thu, 30 Oct 2008 17:40:17 +1100 writes:
>> 
>>     FA> Dear R-devel,
>>     FA> I have a problem defining the dependencies for a package.
>> 
>>     FA> My package (latticist, not yet released) "Suggests" RGtk2, but
>>     FA> specifically does not require it. If RGtk2 is available, the user can
>>     FA> call a function that builds a GUI with RGtk2. However, I do not want
>>     FA> to attach the RGtk2 namespace, because it is irrelevant to the user
>>     FA> and exports about 7500 symbols.
>> 
>>     FA> Last time I asked a similar question to this, Professor Ripley noted
>>     FA> that the usual method to get around this situation is the use an
>>     FA> explicit package prefix to function calls (the `::` operator). But
>>     FA> this is not so easy with non-standard functions. Take this chunk of
>>     FA> code:
>> 
>>     FA> widg <- gtkComboBoxEntryNewText()
>>     FA> widg$show()
>>     FA> widg["width-request"] <- 100
>> 
>>     FA> The first call is easy to prefix, as RGtk2::gtkComboBoxEntryNewText()
>>     FA> but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.
>> 
>> indeed.
>> 
>>     FA> While I *could* rewrite all the code to use explicit functions, I
>>     FA> think, the resulting code would be much less clear.
>> 
>>     FA> Essentially what I want to do is conditionally import the RGtk2 namespace.
>>     FA> Any suggestions?
>> 
>> Maybe something along the line of
>> 
>> if(is.function(try(RGtk2::gtkComboBoxEntryNewText))) {
>>    library(RGtk2)
>>    ....
>>    ....
>> }
>> 
>> ??
> 
> I think the problem is that that puts the namespace on the user's search 
> list, which is what Felix wanted to avoid.  He would like to 
> import(RGtk2), but only if it exists.
> 
> There are conditionals allowed in NAMESPACE files, but I don't know if 
> they are allowed to be used to control imports.  They are not well 
> documented -- they were called "experimental" when introduced in 1.9.0.
> 
> If this is allowed, then something like
> 
> if( "RGtk2" %in% rownames(installed.packages()) ) {
>    import(RGtk2)
> }
> 
> should work.

I just did a little test, and it does appear to work if you use 
utils::installed.packages in the condition.  And one clarification: 
those lines go into your NAMESPACE file, not into R code.

Duncan Murdoch


From ggrothendieck at gmail.com  Thu Oct 30 16:09:03 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 30 Oct 2008 11:09:03 -0400
Subject: [Rd] conditionally import a namespace?
In-Reply-To: <4909C84E.70800@stats.uwo.ca>
References: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>
	<18697.49514.201691.329789@stat.math.ethz.ch>
	<4909C84E.70800@stats.uwo.ca>
Message-ID: <971536df0810300809l4aa9c9easd72f3a625848ea35@mail.gmail.com>

I noticed there is also an experimental interface that can be used
from R (as opposed to the NAMESPACE file).  Can't tell from docs
whether it allows conditionals:

?.Import


On Thu, Oct 30, 2008 at 10:44 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 10/30/2008 10:15 AM, Martin Maechler wrote:
>>>>>>>
>>>>>>> "FA" == Felix Andrews <felix at nfrac.org>
>>>>>>>    on Thu, 30 Oct 2008 17:40:17 +1100 writes:
>>
>>    FA> Dear R-devel,
>>    FA> I have a problem defining the dependencies for a package.
>>
>>    FA> My package (latticist, not yet released) "Suggests" RGtk2, but
>>    FA> specifically does not require it. If RGtk2 is available, the user
>> can
>>    FA> call a function that builds a GUI with RGtk2. However, I do not
>> want
>>    FA> to attach the RGtk2 namespace, because it is irrelevant to the user
>>    FA> and exports about 7500 symbols.
>>
>>    FA> Last time I asked a similar question to this, Professor Ripley
>> noted
>>    FA> that the usual method to get around this situation is the use an
>>    FA> explicit package prefix to function calls (the `::` operator). But
>>    FA> this is not so easy with non-standard functions. Take this chunk of
>>    FA> code:
>>
>>    FA> widg <- gtkComboBoxEntryNewText()
>>    FA> widg$show()
>>    FA> widg["width-request"] <- 100
>>
>>    FA> The first call is easy to prefix, as
>> RGtk2::gtkComboBoxEntryNewText()
>>    FA> but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.
>>
>> indeed.
>>
>>    FA> While I *could* rewrite all the code to use explicit functions, I
>>    FA> think, the resulting code would be much less clear.
>>
>>    FA> Essentially what I want to do is conditionally import the RGtk2
>> namespace.
>>    FA> Any suggestions?
>>
>> Maybe something along the line of
>>
>> if(is.function(try(RGtk2::gtkComboBoxEntryNewText))) {
>>   library(RGtk2)
>>   ....
>>   ....
>> }
>>
>> ??
>
> I think the problem is that that puts the namespace on the user's search
> list, which is what Felix wanted to avoid.  He would like to import(RGtk2),
> but only if it exists.
>
> There are conditionals allowed in NAMESPACE files, but I don't know if they
> are allowed to be used to control imports.  They are not well documented --
> they were called "experimental" when introduced in 1.9.0.
>
> If this is allowed, then something like
>
> if( "RGtk2" %in% rownames(installed.packages()) ) {
>  import(RGtk2)
> }
>
> should work.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Greg.Snow at imail.org  Thu Oct 30 16:38:37 2008
From: Greg.Snow at imail.org (Greg Snow)
Date: Thu, 30 Oct 2008 09:38:37 -0600
Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
In-Reply-To: <20081030051005.4800E282EFC1@mail.pubhealth.ku.dk>
References: <20081030051005.4800E282EFC1@mail.pubhealth.ku.dk>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC6159B5F140@LP-EXMBVS10.CO.IHC.COM>

I don't know if this is the case here or not, but putting in scrollbars and scrolling can be a bit tricky.  It usually works best to create the canvas without a scroll command, then create the scrollbar(s), then use tkconfig to go back and add the scroll command to the canvas after the scrollbar has been created and placed.

Hope this helps,

--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of sundar.dorai-raj at pdf.com
> Sent: Wednesday, October 29, 2008 11:10 PM
> To: r-devel at stat.math.ethz.ch
> Cc: R-bugs at r-project.org
> Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
>
> Full_Name: Sundar Dorai-Raj
> Version: 2.8.0
> OS: Windows
> Submission from: (NULL) (76.220.41.126)
>
>
> The following code crashes R:
>
> library(tcltk)
> tt <- tktoplevel()
> tc <- tkcanvas(tt, yscrollcommand = function(...) tkset(ts, ...))
>
> > sessionInfo()
> R version 2.8.0 (2008-10-20)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Greg.Snow at imail.org  Thu Oct 30 16:40:13 2008
From: Greg.Snow at imail.org (Greg.Snow at imail.org)
Date: Thu, 30 Oct 2008 16:40:13 +0100 (CET)
Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
Message-ID: <20081030154013.A9635282BEBF@mail.pubhealth.ku.dk>

I don't know if this is the case here or not, but putting in scrollbars and=
 scrolling can be a bit tricky.  It usually works best to create the canvas=
 without a scroll command, then create the scrollbar(s), then use tkconfig =
to go back and add the scroll command to the canvas after the scrollbar has=
 been created and placed.

Hope this helps,

--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of sundar.dorai-raj at pdf.com
> Sent: Wednesday, October 29, 2008 11:10 PM
> To: r-devel at stat.math.ethz.ch
> Cc: R-bugs at r-project.org
> Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
>
> Full_Name: Sundar Dorai-Raj
> Version: 2.8.0
> OS: Windows
> Submission from: (NULL) (76.220.41.126)
>
>
> The following code crashes R:
>
> library(tcltk)
> tt <- tktoplevel()
> tc <- tkcanvas(tt, yscrollcommand =3D function(...) tkset(ts, ...))
>
> > sessionInfo()
> R version 2.8.0 (2008-10-20)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=3DEnglish_United States.1252;LC_CTYPE=3DEnglish_United
> States.1252;LC_MONETARY=3DEnglish_United
> States.1252;LC_NUMERIC=3DC;LC_TIME=3DEnglish_United States.1252
>
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Thu Oct 30 17:23:14 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 30 Oct 2008 16:23:14 +0000 (GMT)
Subject: [Rd] Fixing an only one coefficient in an ARIMA model
In-Reply-To: <OFC91A14BC.3F21CA17-ONC12574F0.0047AF11-C12574F0.004857E6@notes.edfgdf.fr>
References: <OFC91A14BC.3F21CA17-ONC12574F0.0047AF11-C12574F0.004857E6@notes.edfgdf.fr>
Message-ID: <alpine.LFD.2.00.0810301621560.9615@gannet.stats.ox.ac.uk>

On Tue, 28 Oct 2008, Yohann MOREAU wrote:

> Good afternoon,
>
> I would like fitting an ARIMA model without the first coefficient.
> For example, I want to fit an AR(3) like this :
> y[t]=a[1]*y[t-1]+a[2]*y[t-2]+a[3]*y[t-3], where a[1]=0.
> How can I specify it in the function "arima", if it is possible ?

RTFM time:

    fixed: optional numeric vector of the same length as the total
           number of parameters.  If supplied, only 'NA' entries in
           'fixed' will be varied.  'transform.pars = TRUE' will be
           overridden (with a warning) if any AR parameters are fixed.
           It may be wise to set 'transform.pars = FALSE' when fixing MA
           parameters, especially near non-invertibility.


>
> Thank you in advance.
> Yohann Moreau
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

And this is a R-help question: please do study the posting guide.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From sundar.dorai-raj at pdf.com  Thu Oct 30 17:30:38 2008
From: sundar.dorai-raj at pdf.com (Sundar Dorai-Raj)
Date: Thu, 30 Oct 2008 09:30:38 -0700
Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
In-Reply-To: <20081030154013.A9635282BEBF@mail.pubhealth.ku.dk>
References: <20081030154013.A9635282BEBF@mail.pubhealth.ku.dk>
Message-ID: <4909E12E.8000007@pdf.com>

Hi, Greg,

Thanks again for your comments. I got it to work with your suggestion:

library(tcltk)
tt <- tktoplevel()
ts <- ttkscrollbar(tt)
tc <- tkcanvas(tt)
tkconfigure(ts, command = function(...) tkyview(tc, ...))
tkconfigure(tc, yscrollcommand = function(...) tkset(ts, ...))
tkpack(tc, side = "left")
tkpack(ts, side = "right", fill = "y")

I think the bug should remain open though, because crashing R is never a 
good thing. But for now, it's not on my critical path.

Thanks,

--sundar

Greg.Snow at imail.org said the following on 10/30/2008 8:40 AM:
> I don't know if this is the case here or not, but putting in scrollbars and=
>  scrolling can be a bit tricky.  It usually works best to create the canvas=
>  without a scroll command, then create the scrollbar(s), then use tkconfig =
> to go back and add the scroll command to the canvas after the scrollbar has=
>  been created and placed.
> 
> Hope this helps,
> 
> --
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
> 
> 
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>> project.org] On Behalf Of sundar.dorai-raj at pdf.com
>> Sent: Wednesday, October 29, 2008 11:10 PM
>> To: r-devel at stat.math.ethz.ch
>> Cc: R-bugs at r-project.org
>> Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
>>
>> Full_Name: Sundar Dorai-Raj
>> Version: 2.8.0
>> OS: Windows
>> Submission from: (NULL) (76.220.41.126)
>>
>>
>> The following code crashes R:
>>
>> library(tcltk)
>> tt <- tktoplevel()
>> tc <- tkcanvas(tt, yscrollcommand =3D function(...) tkset(ts, ...))
>>
>>> sessionInfo()
>> R version 2.8.0 (2008-10-20)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=3DEnglish_United States.1252;LC_CTYPE=3DEnglish_United
>> States.1252;LC_MONETARY=3DEnglish_United
>> States.1252;LC_NUMERIC=3DC;LC_TIME=3DEnglish_United States.1252
>>
>> attached base packages:
>> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
>> [8] base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From j.skoien at geo.uu.nl  Thu Oct 30 20:08:27 2008
From: j.skoien at geo.uu.nl (Jon Olav Skoien)
Date: Thu, 30 Oct 2008 20:08:27 +0100
Subject: [Rd] Small modification of zip.file.extract in utils?
Message-ID: <490A062B.3010906@geo.uu.nl>

Dear list,

I needed to extract a zip-archive, and found zip.file.extract in utils. 
My only problem was the use of tempdir(), since I wanted to permanently 
extract the archive at a fixed location for later use. My own fix was 
simple, adding an extra parameter zipdir (without default), and within 
the function change
tmpd <- tempdir()
to
tmpd = ifelse(missing(zipdir),tempdir(),zipdir)

This modification could maybe be useful also for other users, unless 
there are some problems I am not aware of?

Cheers,
Jon


From plroebuck at mdanderson.org  Thu Oct 30 20:59:17 2008
From: plroebuck at mdanderson.org (Paul Roebuck)
Date: Thu, 30 Oct 2008 14:59:17 -0500 (CDT)
Subject: [Rd] using yscrollcommand in tkcanvas crashes R (PR#13231)
In-Reply-To: <20081030051005.4800E282EFC1@mail.pubhealth.ku.dk>
References: <20081030051005.4800E282EFC1@mail.pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.58.0810301426560.93237@wotan.mdacc.tmc.edu>

On Thu, 30 Oct 2008 sundar.dorai-raj at pdf.com wrote:

> Full_Name: Sundar Dorai-Raj
> Version: 2.8.0
> OS: Windows
> Submission from: (NULL) (76.220.41.126)
>
>
> The following code crashes R:
>
> library(tcltk)
> tt <- tktoplevel()
> tc <- tkcanvas(tt, yscrollcommand = function(...) tkset(ts, ...))
>
> > sessionInfo()
> R version 2.8.0 (2008-10-20)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> [8] base
>

Here's a portion of the code I wrote for a package that
contains a scrollable canvas, if it helps you any.


.RDEnv <- new.env(hash=TRUE)                   # Private environment

rdenv <- function() {
    return(.RDEnv)
}


scrollframe_create <- function(parent) {
    stopifnot(is.tkwin(parent))

    frame <- tkframe(parent,
                     class="ScrollFrame")
    xscroll <- tkscrollbar(frame,
                           orient="horizontal",
                           command=function(...) tkxview(vport, ...))
    yscroll <- tkscrollbar(frame,
                           orient="vertical",
                           command=function(...) tkyview(vport, ...))
    vport <- tkcanvas(frame,
                      xscrollcommand=function(...) tkset(xscroll, ...),
                      yscrollcommand=function(...) tkset(yscroll, ...))

    pady <- paste("0", tclvalue(tkwinfo.reqheight(xscroll)))
    tkpack(yscroll, side="right", fill="y", pady=pady)
    tkpack(xscroll, side="bottom", fill="x")
    tkpack(vport, side="left", fill="both", expand=TRUE)

    int.frame <- tkframe(vport,
                         borderwidth=4,
                         relief="groove")
    tkcreate(vport, "window", "0 0", anchor="nw", window=int.frame$ID)
    tkbind(int.frame, "<Configure>", function() scrollframe_resize(int.frame))

    ## Save this so items can be put in it
    assign("interior.frame", int.frame, envir=rdenv())

    return(frame)
}


scrollframe_resize <- function(iframe) {
    stopifnot(tclvalue(tkwinfo.class(iframe)) == "Frame")

    w <- tkwinfo.width(iframe)
    h <- tkwinfo.height(iframe)

    vport <- tkwinfo.parent(iframe)
    stopifnot(tclvalue(tkwinfo.class(vport)) == "Canvas")
    bbox <- tkbbox(vport, "all")

    tkconfigure(vport,
                width=w,
                height=h,
                scrollregion=bbox,
                xscrollincrement="0.1i",
                yscrollincrement="0.1i")
}


scrollframe_interior <- function() {
    return(get("interior.frame", envir=rdenv()))
}


----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From murdoch at stats.uwo.ca  Thu Oct 30 21:07:34 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 30 Oct 2008 16:07:34 -0400
Subject: [Rd] Small modification of zip.file.extract in utils?
In-Reply-To: <490A062B.3010906@geo.uu.nl>
References: <490A062B.3010906@geo.uu.nl>
Message-ID: <490A1406.7030507@stats.uwo.ca>

On 10/30/2008 3:08 PM, Jon Olav Skoien wrote:
> Dear list,
> 
> I needed to extract a zip-archive, and found zip.file.extract in utils. 
> My only problem was the use of tempdir(), since I wanted to permanently 
> extract the archive at a fixed location for later use. My own fix was 
> simple, adding an extra parameter zipdir (without default), and within 
> the function change
> tmpd <- tempdir()
> to
> tmpd = ifelse(missing(zipdir),tempdir(),zipdir)
> 
> This modification could maybe be useful also for other users, unless 
> there are some problems I am not aware of?

I won't comment on the value of the extra parameter, but the 
implementation would be simpler if you set the default for zipdir to 
tempdir(), and then just used zipdir in place of tmpd throughout.

Duncan Murdoch


From felix at nfrac.org  Fri Oct 31 08:09:52 2008
From: felix at nfrac.org (Felix Andrews)
Date: Fri, 31 Oct 2008 18:09:52 +1100
Subject: [Rd] conditionally import a namespace?
In-Reply-To: <4909CCD9.2070500@stats.uwo.ca>
References: <94730b8a0810292340t7e328096u300e4a225e669c5d@mail.gmail.com>
	<18697.49514.201691.329789@stat.math.ethz.ch>
	<4909C84E.70800@stats.uwo.ca> <4909CCD9.2070500@stats.uwo.ca>
Message-ID: <94730b8a0810310009u1a45ea18rbbe2e286c3df9b6f@mail.gmail.com>

2008/10/31 Duncan Murdoch <murdoch at stats.uwo.ca>:
> On 10/30/2008 10:44 AM, Duncan Murdoch wrote:
>>
>> On 10/30/2008 10:15 AM, Martin Maechler wrote:
>>>>>>>>
>>>>>>>> "FA" == Felix Andrews <felix at nfrac.org>
>>>>>>>>    on Thu, 30 Oct 2008 17:40:17 +1100 writes:
>>>
>>>    FA> Dear R-devel,
>>>    FA> I have a problem defining the dependencies for a package.
>>>
>>>    FA> My package (latticist, not yet released) "Suggests" RGtk2, but
>>>    FA> specifically does not require it. If RGtk2 is available, the user
>>> can
>>>    FA> call a function that builds a GUI with RGtk2. However, I do not
>>> want
>>>    FA> to attach the RGtk2 namespace, because it is irrelevant to the
>>> user
>>>    FA> and exports about 7500 symbols.
>>>
>>>    FA> Last time I asked a similar question to this, Professor Ripley
>>> noted
>>>    FA> that the usual method to get around this situation is the use an
>>>    FA> explicit package prefix to function calls (the `::` operator). But
>>>    FA> this is not so easy with non-standard functions. Take this chunk
>>> of
>>>    FA> code:
>>>
>>>    FA> widg <- gtkComboBoxEntryNewText()
>>>    FA> widg$show()
>>>    FA> widg["width-request"] <- 100
>>>
>>>    FA> The first call is easy to prefix, as
>>> RGtk2::gtkComboBoxEntryNewText()
>>>    FA> but the others, `$.RGtkObject` and `[<-.RGtkObject` are not.
>>>
>>> indeed.
>>>
>>>    FA> While I *could* rewrite all the code to use explicit functions, I
>>>    FA> think, the resulting code would be much less clear.
>>>
>>>    FA> Essentially what I want to do is conditionally import the RGtk2
>>> namespace.
>>>    FA> Any suggestions?
>>>
>>> Maybe something along the line of
>>>
>>> if(is.function(try(RGtk2::gtkComboBoxEntryNewText))) {
>>>   library(RGtk2)
>>>   ....
>>>   ....
>>> }
>>>
>>> ??
>>
>> I think the problem is that that puts the namespace on the user's search
>> list, which is what Felix wanted to avoid.  He would like to import(RGtk2),
>> but only if it exists.
>>
>> There are conditionals allowed in NAMESPACE files, but I don't know if
>> they are allowed to be used to control imports.  They are not well
>> documented -- they were called "experimental" when introduced in 1.9.0.
>>
>> If this is allowed, then something like
>>
>> if( "RGtk2" %in% rownames(installed.packages()) ) {
>>   import(RGtk2)
>> }
>>
>> should work.
>
> I just did a little test, and it does appear to work if you use
> utils::installed.packages in the condition.  And one clarification: those
> lines go into your NAMESPACE file, not into R code.

Many thanks Duncan, that is just what I wanted. The only problem now
is that it fails R CMD check:

* checking package dependencies ... ERROR
Namespace dependencies not required:
  RGtk2



>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Felix Andrews / ???
http://www.neurofractal.org/felix/
3358 543D AAC6 22C2 D336  80D9 360B 72DD 3E4C F5D8


From bircoph at list.ru  Fri Oct 31 01:10:07 2008
From: bircoph at list.ru (bircoph at list.ru)
Date: Fri, 31 Oct 2008 01:10:07 +0100 (CET)
Subject: [Rd] [BUG] [PATCH] R-2.8.0 failes to build without X support due to
	a typo (PR#13233)
Message-ID: <20081031001007.E02BD282EFC1@mail.pubhealth.ku.dk>

Full_Name: Andrew
Version: 2.8.0
OS: Linux-2.6.x
Submission from: (NULL) (78.107.248.171)


R-2.8.0 failes to build without X support due to a typo in the source code.
The following patch fixes this:

--- src/main/platform.c.orig    2008-10-31 02:59:45.000000000 +0300
+++ src/main/platform.c 2008-10-31 03:00:02.000000000 +0300
@@ -1654,7 +1654,7 @@
 # ifdef HAVE_X11
     int X11 = NA_LOGICAL;
 # else
-    int X11 = FALSE
+    int X11 = FALSE;
 # endif
 #endif


From ripley at stats.ox.ac.uk  Fri Oct 31 10:48:14 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 31 Oct 2008 09:48:14 +0000 (GMT)
Subject: [Rd] (PR#13233) [BUG] [PATCH] R-2.8.0 failes to build without X
 support due to a typo
In-Reply-To: <20081031001007.E02BD282EFC1@mail.pubhealth.ku.dk>
References: <20081031001007.E02BD282EFC1@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0810310941350.25313@gannet.stats.ox.ac.uk>

This is

-- already fixed in R-patched early last week.
-- a duplicate of PR#13188.

You were explicitly asked not to report on already fixed or already 
reported bugs -- see the FAQ.  Note too that no one reported this during 
the alpha/beta test period for 2.8.0, so responding to requests for 
testing in the future would be a good way to mitigate the annoyance of 
this unneeded report.

On Fri, 31 Oct 2008, bircoph at list.ru wrote:

> Full_Name: Andrew
> Version: 2.8.0
> OS: Linux-2.6.x
> Submission from: (NULL) (78.107.248.171)
>
>
> R-2.8.0 failes to build without X support due to a typo in the source code.
> The following patch fixes this:
>
> --- src/main/platform.c.orig    2008-10-31 02:59:45.000000000 +0300
> +++ src/main/platform.c 2008-10-31 03:00:02.000000000 +0300
> @@ -1654,7 +1654,7 @@
> # ifdef HAVE_X11
>     int X11 = NA_LOGICAL;
> # else
> -    int X11 = FALSE
> +    int X11 = FALSE;
> # endif
> #endif
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From zemlys at gmail.com  Fri Oct 31 10:35:07 2008
From: zemlys at gmail.com (zemlys at gmail.com)
Date: Fri, 31 Oct 2008 10:35:07 +0100 (CET)
Subject: [Rd] Problems with Sweave and pdf.options(encoding="ISOLatin7")
	(PR#13234)
Message-ID: <20081031093507.EF812282C76E@mail.pubhealth.ku.dk>

Hi,

Sweave for some reason does not respect encoding setting in pdf.options.
Everything is OK with ps.options. Thus when using non-default encoding
for graphs, resulting graphics eps file is correct, but  pdf file is
not. Workaround is very simple, just use latex->dvips->ps2pdf chain to
get the intended pdf document. I tried to find the explanation for this,
but I did not find anything. If this is documented behaviour, I am sorry
for the disturbance.

After Sweaving the file below, pdflatex and latex->dvips->ps2pdf will
produce different pdfs. The tex file compiled succesfully in Ubuntu
8.04, and TeXLive 2007.

Sincerely yours,

Vaidotas Zemlys

test.Rnw file: 

\documentclass[a4paper]{article}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}

\title{Problem with pdf.options}
\author{Vaidotas Zemlys}

\begin{document}
\maketitle

Note the Lithuanian letters in latex will not display correctly, you
need
additional package. This does not matter to R, since we use Unicode and
pass the
correct encoding.

\begin{center}
<<fig=TRUE,echo=TRUE>>=
pdf.options(enc="ISOLatin7")
ps.options(enc="ISOLatin7")
plot(rnorm(100),main="?
????????????????")
@
\end{center}

\end{document}




--please do not edit the information below--

Version:
 platform = i486-pc-linux-gnu
 arch = i486
 os = linux-gnu
 system = i486, linux-gnu
 status = 
 major = 2
 minor = 8.0
 year = 2008
 month = 10
 day = 20
 svn rev = 46754
 language = R
 version.string = R version 2.8.0 (2008-10-20)

Locale:
LC_CTYPE=fr_FR.UTF-8 at euro;LC_NUMERIC=C;LC_TIME=fr_FR.UTF-8 at euro;LC_COLLATE=fr_FR.UTF-8 at euro;LC_MONETARY=C;LC_MESSAGES=fr_FR.UTF-8 at euro;LC_PAPER=fr_FR.UTF-8 at euro;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=fr_FR.UTF-8 at euro;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices,
package:utils, package:datasets, package:methods, Autoloads,
package:base


From ct529 at york.ac.uk  Fri Oct 31 12:17:17 2008
From: ct529 at york.ac.uk (Corrado)
Date: Fri, 31 Oct 2008 11:17:17 +0000
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
	terminated on R 2.6.2 to 2.8.0: logging a bug?
Message-ID: <200810311117.17677.ct529@york.ac.uk>

Dear friends,

there is a serious problem with RODBC on R from 2.6.2 to 2.8.0 on a postgresql 
8.3 database.

Let's say we define an empty dsn called "test", with user "postgres" and 
password "none". We test the connection with another application, and it 
works properly.

When you call the database using RODBC, you get the following:

> odbcConnect("test","postgres","none")
*** buffer overflow detected ***: /usr/lib64/R/bin/exec/R terminated
======= Backtrace: =========
/lib64/libc.so.6(__fortify_fail+0x37)[0x2ad38a3f4157]
/lib64/libc.so.6[0x2ad38a3f27e0]
/lib64/libc.so.6[0x2ad38a3f1db9]
/lib64/libc.so.6(_IO_default_xsputn+0x8e)[0x2ad38a379b5e]
/lib64/libc.so.6(_IO_vfprintf+0x3c22)[0x2ad38a351fa2]
/lib64/libc.so.6(__vsprintf_chk+0x9d)[0x2ad38a3f1e5d]
/lib64/libc.so.6(__sprintf_chk+0x80)[0x2ad38a3f1da0]
/usr/lib64/libodbcpsql.so.2(SQLGetInfo+0x973)[0x2ad38de11013]
/usr/lib64/libodbc.so.1(SQLGetInfo+0x624)[0x2ad38c5e91a4]
/usr/lib64/R/library/RODBC/libs/RODBC.so(RODBCGetInfo+0xbb)[0x2ad38c393a9b]
/usr/lib64/R/lib/libR.so[0x2ad389c2562d]
/usr/lib64/R/lib/libR.so(Rf_eval+0x6a1)[0x2ad389c4ef31]
/usr/lib64/R/lib/libR.so[0x2ad389c51dc3]
/usr/lib64/R/lib/libR.so(Rf_eval+0x474)[0x2ad389c4ed04]
/usr/lib64/R/lib/libR.so[0x2ad389c5014c]
/usr/lib64/R/lib/libR.so(Rf_eval+0x474)[0x2ad389c4ed04]
/usr/lib64/R/lib/libR.so(Rf_applyClosure+0x2aa)[0x2ad389c5268a]
/usr/lib64/R/lib/libR.so(Rf_eval+0x38c)[0x2ad389c4ec1c]
/usr/lib64/R/lib/libR.so[0x2ad389c5014c]
/usr/lib64/R/lib/libR.so(Rf_eval+0x474)[0x2ad389c4ed04]
/usr/lib64/R/lib/libR.so(Rf_applyClosure+0x2aa)[0x2ad389c5268a]
/usr/lib64/R/lib/libR.so(Rf_eval+0x38c)[0x2ad389c4ec1c]
/usr/lib64/R/lib/libR.so(Rf_ReplIteration+0x1c3)[0x2ad389c733c3]
/usr/lib64/R/lib/libR.so(run_Rmainloop+0xd1)[0x2ad389c736d1]
/usr/lib64/R/bin/exec/R(main+0x2b)[0x4008bb]
/lib64/libc.so.6(__libc_start_main+0xf4)[0x2ad38a32a074]
/usr/lib64/R/bin/exec/R[0x400769]
======= Memory map: ========
00400000-00401000 r-xp 00000000 08:02 
815595                             /usr/lib64/R/bin/exec/R
00600000-00601000 rw-p 00000000 08:02 
815595                             /usr/lib64/R/bin/exec/R
00601000-01bf3000 rw-p 00601000 00:00 0                                  
[heap]
2ad38995c000-2ad389976000 r-xp 00000000 08:02 
2044002                    /lib64/ld-2.7.so
2ad389976000-2ad389978000 rw-p 2ad389976000 00:00 0
2ad389b75000-2ad389b76000 r--p 00019000 08:02 
2044002                    /lib64/ld-2.7.so
2ad389b76000-2ad389b77000 rw-p 0001a000 08:02 
2044002                    /lib64/ld-2.7.so
2ad389b77000-2ad389e03000 r-xp 00000000 08:02 
878425                     /usr/lib64/R/lib/libR.so
2ad389e03000-2ad38a002000 ---p 0028c000 08:02 
878425                     /usr/lib64/R/lib/libR.so
2ad38a002000-2ad38a016000 rw-p 0028b000 08:02 
878425                     /usr/lib64/R/lib/libR.so
2ad38a016000-2ad38a0af000 rw-p 2ad38a016000 00:00 0
2ad38a0af000-2ad38a0db000 r-xp 00000000 08:02 
878426                     /usr/lib64/R/lib/libRblas.so
2ad38a0db000-2ad38a2da000 ---p 0002c000 08:02 
878426                     /usr/lib64/R/lib/libRblas.so
2ad38a2da000-2ad38a2db000 rw-p 0002b000 08:02 
878426                     /usr/lib64/R/lib/libRblas.so
2ad38a2db000-2ad38a2dc000 r--p 00000000 08:02 
892499                     /usr/share/locale/en_GB.UTF-8/LC_MESSAGES/SYS_LC_MESSAGES
2ad38a2dc000-2ad38a2e3000 r--s 00000000 08:02 
654700                     /usr/lib64/gconv/gconv-modules.cache
2ad38a30b000-2ad38a30c000 rw-p 2ad38a30b000 00:00 0
2ad38a30c000-2ad38a457000 r-xp 00000000 08:02 
2044009                    /lib64/libc-2.7.so
2ad38a457000-2ad38a656000 ---p 0014b000 08:02 
2044009                    /lib64/libc-2.7.so
2ad38a656000-2ad38a65a000 r--p 0014a000 08:02 
2044009                    /lib64/libc-2.7.so
2ad38a65a000-2ad38a65b000 rw-p 0014e000 08:02 
2044009                    /lib64/libc-2.7.so
2ad38a65b000-2ad38a660000 rw-p 2ad38a65b000 00:00 0
2ad38a660000-2ad38a718000 r-xp 00000000 08:02 
2396466                    /usr/lib64/libgfortran.so.2.0.0
2ad38a718000-2ad38a917000 ---p 000b8000 08:02 
2396466                    /usr/lib64/libgfortran.so.2.0.0
2ad38a917000-2ad38a919000 rw-p 000b7000 08:02 
2396466                    /usr/lib64/libgfortran.so.2.0.0
2ad38a919000-2ad38a998000 r-xp 00000000 08:02 
2044017                    /lib64/libm-2.7.so
2ad38a998000-2ad38ab98000 ---p 0007f000 08:02 
2044017                    /lib64/libm-2.7.so
2ad38ab98000-2ad38ab99000 r--p 0007f000 08:02 
2044017                    /lib64/libm-2.7.so
2ad38ab99000-2ad38ab9a000 rw-p 00080000 08:02 
2044017                    /lib64/libm-2.7.so
2ad38ab9a000-2ad38ab9b000 rw-p 2ad38ab9a000 00:00 0
2ad38ab9b000-2ad38abd1000 r-xp 00000000 08:02 
2044184                    /lib64/libreadline.so.5.2
2ad38abd1000-2ad38add0000 ---p 00036000 08:02 
2044184                    /lib64/libreadline.so.5.2
2ad38add0000-2ad38add8000 rw-p 00035000 08:02 
2044184                    /lib64/libreadline.so.5.2
2ad38add8000-2ad38add9000 rw-p 2ad38add8000 00:00 0
2ad38add9000-2ad38ae23000 r-xp 00000000 08:02 
2044157                    /lib64/libncurses.so.5.6
2ad38ae23000-2ad38b022000 ---p 0004a000 08:02 
2044157                    /lib64/libncurses.so.5.6
2ad38b022000-2ad38b027000 rw-p 00049000 08:02 
2044157                    /lib64/libncurses.so.5.6
2ad38b027000-2ad38b04d000 r-xp 00000000 08:02 
2044050                    /lib64/libpcre.so.0.0.1
2ad38b04d000-2ad38b24c000 ---p 00026000 08:02 
2044050                    /lib64/libpcre.so.0.0.1
2ad38b24c000-2ad38b24d000 rw-p 00025000 08:02 
2044050                    /lib64/libpcre.so.0.0.1
2ad38b24d000-2ad38b24e000 rw-p 2ad38b24d000 00:00 0
2ad38b24e000-2ad38b262000 r-xp 00000000 08:02 
2044118                    /lib64/libz.so.1.2.3
2ad38b262000-2ad38b461000 ---p 00014000 08:02 
2044118                    /lib64/libz.so.1.2.3
2ad38b461000-2ad38b462000 rw-p 00013000 08:02 
2044118                    /lib64/libz.so.1.2.3
2ad38b462000-2ad38b464000 r-xp 00000000 08:02 
2044015                    /lib64/libdl-2.7.so
2ad38b464000-2ad38b664000 ---p 00002000 08:02 
2044015                    /lib64/libdl-2.7.so
2ad38b664000-2ad38b665000 r--p 00002000 08:02 
2044015                    /lib64/libdl-2.7.so
2ad38b665000-2ad38b666000 rw-p 00003000 08:02 
2044015                    /lib64/libdl-2.7.so
2ad38b666000-2ad38b668000 rw-p 2ad38b666000 00:00 0
2ad38b668000-2ad38b6a7000 r--p 00000000 08:02 
720800                     /usr/share/locale/UTF-8/LC_CTYPE
2ad38b6a7000-2ad38b78b000 r--p 00000000 08:02 
720801                     /usr/share/locale/UTF-8/LC_COLLATE
2ad38b78b000-2ad38b78c000 r--p 00000000 08:02 
892249                     /usr/share/locale/en_GB.UTF-8/LC_TIME
2ad38b78c000-2ad38b78d000 r--p 00000000 08:02 
892496                     /usr/share/locale/en_GB.UTF-8/LC_PAPER
2ad38b78d000-2ad38b78e000 r--p 00000000 08:02 
892500                     /usr/share/locale/en_GB.UTF-8/LC_MAborted
ct529 at localhost:~$                                     

OS: Mandriva 2008.1 x86_64
Postgresql: 8.3.1 (PostGIS enabled)
R: from 2.6.2 from repository to 2.8.0 repackaged

Is it my doing, or R's doing?

Best,

-- 
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From P.Dalgaard at biostat.ku.dk  Fri Oct 31 13:26:39 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 31 Oct 2008 13:26:39 +0100
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
 terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <200810311117.17677.ct529@york.ac.uk>
References: <200810311117.17677.ct529@york.ac.uk>
Message-ID: <490AF97F.4070505@biostat.ku.dk>

Corrado wrote:
> Dear friends,
> 
> there is a serious problem with RODBC on R from 2.6.2 to 2.8.0 on a postgresql 
> 8.3 database.
> 
> Let's say we define an empty dsn called "test", with user "postgres" and 
> password "none". We test the connection with another application, and it 
> works properly.
> 
> When you call the database using RODBC, you get the following:
> 
>> odbcConnect("test","postgres","none")
> *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R terminated
> ======= Backtrace: =========
> /lib64/libc.so.6(__fortify_fail+0x37)[0x2ad38a3f4157]
> /lib64/libc.so.6[0x2ad38a3f27e0]
> /lib64/libc.so.6[0x2ad38a3f1db9]
> /lib64/libc.so.6(_IO_default_xsputn+0x8e)[0x2ad38a379b5e]
> /lib64/libc.so.6(_IO_vfprintf+0x3c22)[0x2ad38a351fa2]
> /lib64/libc.so.6(__vsprintf_chk+0x9d)[0x2ad38a3f1e5d]
> /lib64/libc.so.6(__sprintf_chk+0x80)[0x2ad38a3f1da0]
> /usr/lib64/libodbcpsql.so.2(SQLGetInfo+0x973)[0x2ad38de11013]
> /usr/lib64/libodbc.so.1(SQLGetInfo+0x624)[0x2ad38c5e91a4]
> /usr/lib64/R/library/RODBC/libs/RODBC.so(RODBCGetInfo+0xbb)[0x2ad38c393a9b]

-....-
> OS: Mandriva 2008.1 x86_64
> Postgresql: 8.3.1 (PostGIS enabled)
> R: from 2.6.2 from repository to 2.8.0 repackaged
> 
> Is it my doing, or R's doing?

(R-help snipped)

It looks like that the problem is in the RODBC package, so the
maintainer of RODBC should be informed. For reproducibility, you might
need to be more explicit about how to create an "empty dsn" with postgres.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From ct529 at york.ac.uk  Fri Oct 31 13:37:10 2008
From: ct529 at york.ac.uk (Corrado)
Date: Fri, 31 Oct 2008 12:37:10 +0000
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
	terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <490AF97F.4070505@biostat.ku.dk>
References: <200810311117.17677.ct529@york.ac.uk>
	<490AF97F.4070505@biostat.ku.dk>
Message-ID: <200810311237.10402.ct529@york.ac.uk>

I apologise .... The dsn is not empty, the database the dsn connects to is 
empty!

You get the same error when connecting to a populated database.

Regards 


On Friday 31 October 2008 12:26:39 Peter Dalgaard wrote:
> Corrado wrote:
> > Dear friends,
> >
> > there is a serious problem with RODBC on R from 2.6.2 to 2.8.0 on a
> > postgresql 8.3 database.
> >
> > Let's say we define an empty dsn called "test", with user "postgres" and
> > password "none". We test the connection with another application, and it
> > works properly.
> >
> > When you call the database using RODBC, you get the following:
> >> odbcConnect("test","postgres","none")
> >
> > *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R terminated
> > ======= Backtrace: =========
> > /lib64/libc.so.6(__fortify_fail+0x37)[0x2ad38a3f4157]
> > /lib64/libc.so.6[0x2ad38a3f27e0]
> > /lib64/libc.so.6[0x2ad38a3f1db9]
> > /lib64/libc.so.6(_IO_default_xsputn+0x8e)[0x2ad38a379b5e]
> > /lib64/libc.so.6(_IO_vfprintf+0x3c22)[0x2ad38a351fa2]
> > /lib64/libc.so.6(__vsprintf_chk+0x9d)[0x2ad38a3f1e5d]
> > /lib64/libc.so.6(__sprintf_chk+0x80)[0x2ad38a3f1da0]
> > /usr/lib64/libodbcpsql.so.2(SQLGetInfo+0x973)[0x2ad38de11013]
> > /usr/lib64/libodbc.so.1(SQLGetInfo+0x624)[0x2ad38c5e91a4]
> > /usr/lib64/R/library/RODBC/libs/RODBC.so(RODBCGetInfo+0xbb)[0x2ad38c393a9
> >b]
>
> -....-
>
> > OS: Mandriva 2008.1 x86_64
> > Postgresql: 8.3.1 (PostGIS enabled)
> > R: from 2.6.2 from repository to 2.8.0 repackaged
> >
> > Is it my doing, or R's doing?
>
> (R-help snipped)
>
> It looks like that the problem is in the RODBC package, so the
> maintainer of RODBC should be informed. For reproducibility, you might
> need to be more explicit about how to create an "empty dsn" with postgres.



-- 
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From P.Dalgaard at biostat.ku.dk  Fri Oct 31 13:50:51 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 31 Oct 2008 13:50:51 +0100
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
 terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <200810311237.10402.ct529@york.ac.uk>
References: <200810311117.17677.ct529@york.ac.uk>
	<490AF97F.4070505@biostat.ku.dk>
	<200810311237.10402.ct529@york.ac.uk>
Message-ID: <490AFF2B.2020209@biostat.ku.dk>

Corrado wrote:
> I apologise .... The dsn is not empty, the database the dsn connects to is 
> empty!
> 
> You get the same error when connecting to a populated database.

Do I? I wouldn't know...

(You are _still_ not providing steps to reproduce the situation!)

The actual maintainer might know, though, so wait for him to chime in.

	-p

> 
> Regards 
> 
> 
> On Friday 31 October 2008 12:26:39 Peter Dalgaard wrote:
>> Corrado wrote:
>>> Dear friends,
>>>
>>> there is a serious problem with RODBC on R from 2.6.2 to 2.8.0 on a
>>> postgresql 8.3 database.
>>>
>>> Let's say we define an empty dsn called "test", with user "postgres" and
>>> password "none". We test the connection with another application, and it
>>> works properly.
>>>
>>> When you call the database using RODBC, you get the following:
>>>> odbcConnect("test","postgres","none")
>>> *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R terminated
>>> ======= Backtrace: =========
>>> /lib64/libc.so.6(__fortify_fail+0x37)[0x2ad38a3f4157]
>>> /lib64/libc.so.6[0x2ad38a3f27e0]
>>> /lib64/libc.so.6[0x2ad38a3f1db9]
>>> /lib64/libc.so.6(_IO_default_xsputn+0x8e)[0x2ad38a379b5e]
>>> /lib64/libc.so.6(_IO_vfprintf+0x3c22)[0x2ad38a351fa2]
>>> /lib64/libc.so.6(__vsprintf_chk+0x9d)[0x2ad38a3f1e5d]
>>> /lib64/libc.so.6(__sprintf_chk+0x80)[0x2ad38a3f1da0]
>>> /usr/lib64/libodbcpsql.so.2(SQLGetInfo+0x973)[0x2ad38de11013]
>>> /usr/lib64/libodbc.so.1(SQLGetInfo+0x624)[0x2ad38c5e91a4]
>>> /usr/lib64/R/library/RODBC/libs/RODBC.so(RODBCGetInfo+0xbb)[0x2ad38c393a9
>>> b]
>> -....-
>>
>>> OS: Mandriva 2008.1 x86_64
>>> Postgresql: 8.3.1 (PostGIS enabled)
>>> R: from 2.6.2 from repository to 2.8.0 repackaged
>>>
>>> Is it my doing, or R's doing?
>> (R-help snipped)
>>
>> It looks like that the problem is in the RODBC package, so the
>> maintainer of RODBC should be informed. For reproducibility, you might
>> need to be more explicit about how to create an "empty dsn" with postgres.
> 
> 
> 


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From ripley at stats.ox.ac.uk  Fri Oct 31 15:26:36 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 31 Oct 2008 14:26:36 +0000 (GMT)
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
 terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <490AFF2B.2020209@biostat.ku.dk>
References: <200810311117.17677.ct529@york.ac.uk>
	<490AF97F.4070505@biostat.ku.dk>
	<200810311237.10402.ct529@york.ac.uk>
	<490AFF2B.2020209@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0810311401070.17003@gannet.stats.ox.ac.uk>

On Fri, 31 Oct 2008, Peter Dalgaard wrote:

> Corrado wrote:
>> I apologise .... The dsn is not empty, the database the dsn connects to is
>> empty!
>>
>> You get the same error when connecting to a populated database.
>
> Do I? I wouldn't know...
>
> (You are _still_ not providing steps to reproduce the situation!)
>
> The actual maintainer might know, though, so wait for him to chime in.

He cannot reproduce this, on a Fedora 8 system with buffer overflow 
detection enabled and PostgreSQL 8.2.10 (the one that Fedora supplies). 
As the error is from the PostgreSQL ODBC driver, it is most likely a bug 
in that driver (and there is a long history of problems with PostgreSQL 
ODBC drivers, especially on 64-bit systems).

Note that the error is pretty clearly in /usr/lib64/libodbcpsql.so.2 
calling sprintf, and the buffer passed from RODBC has a length specified 
(correctly) in the SQLGetInfo call.  Thus using sprintf on _that_ buffer 
would of itself be an error.  So there is no evidence here of a 'serious 
problem with RODBC' (and many other people are using it on Linux systems 
with PostgreSQL, and no one else has reported any such issue).


>
> 	-p
>
>>
>> Regards
>>
>>
>> On Friday 31 October 2008 12:26:39 Peter Dalgaard wrote:
>>> Corrado wrote:
>>>> Dear friends,
>>>>
>>>> there is a serious problem with RODBC on R from 2.6.2 to 2.8.0 on a
>>>> postgresql 8.3 database.
>>>>
>>>> Let's say we define an empty dsn called "test", with user "postgres" and
>>>> password "none". We test the connection with another application, and it
>>>> works properly.
>>>>
>>>> When you call the database using RODBC, you get the following:
>>>>> odbcConnect("test","postgres","none")
>>>> *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R terminated
>>>> ======= Backtrace: =========
>>>> /lib64/libc.so.6(__fortify_fail+0x37)[0x2ad38a3f4157]
>>>> /lib64/libc.so.6[0x2ad38a3f27e0]
>>>> /lib64/libc.so.6[0x2ad38a3f1db9]
>>>> /lib64/libc.so.6(_IO_default_xsputn+0x8e)[0x2ad38a379b5e]
>>>> /lib64/libc.so.6(_IO_vfprintf+0x3c22)[0x2ad38a351fa2]
>>>> /lib64/libc.so.6(__vsprintf_chk+0x9d)[0x2ad38a3f1e5d]
>>>> /lib64/libc.so.6(__sprintf_chk+0x80)[0x2ad38a3f1da0]
>>>> /usr/lib64/libodbcpsql.so.2(SQLGetInfo+0x973)[0x2ad38de11013]
>>>> /usr/lib64/libodbc.so.1(SQLGetInfo+0x624)[0x2ad38c5e91a4]
>>>> /usr/lib64/R/library/RODBC/libs/RODBC.so(RODBCGetInfo+0xbb)[0x2ad38c393a9
>>>> b]
>>> -....-
>>>
>>>> OS: Mandriva 2008.1 x86_64
>>>> Postgresql: 8.3.1 (PostGIS enabled)
>>>> R: from 2.6.2 from repository to 2.8.0 repackaged
>>>>
>>>> Is it my doing, or R's doing?
>>> (R-help snipped)
>>>
>>> It looks like that the problem is in the RODBC package, so the
>>> maintainer of RODBC should be informed. For reproducibility, you might
>>> need to be more explicit about how to create an "empty dsn" with postgres.
>>
>>
>>
>
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From P.Dalgaard at biostat.ku.dk  Fri Oct 31 15:42:33 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 31 Oct 2008 15:42:33 +0100
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
 terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <alpine.LFD.2.00.0810311401070.17003@gannet.stats.ox.ac.uk>
References: <200810311117.17677.ct529@york.ac.uk>
	<490AF97F.4070505@biostat.ku.dk>
	<200810311237.10402.ct529@york.ac.uk>
	<490AFF2B.2020209@biostat.ku.dk>
	<alpine.LFD.2.00.0810311401070.17003@gannet.stats.ox.ac.uk>
Message-ID: <490B1959.6090305@biostat.ku.dk>

Prof Brian Ripley wrote:
> On Fri, 31 Oct 2008, Peter Dalgaard wrote:
> 
>> Corrado wrote:
>>> I apologise .... The dsn is not empty, the database the dsn connects
>>> to is
>>> empty!
>>>
>>> You get the same error when connecting to a populated database.
>>
>> Do I? I wouldn't know...
>>
>> (You are _still_ not providing steps to reproduce the situation!)
>>
>> The actual maintainer might know, though, so wait for him to chime in.
> 
> He cannot reproduce this, on a Fedora 8 system with buffer overflow
> detection enabled and PostgreSQL 8.2.10 (the one that Fedora supplies).
> As the error is from the PostgreSQL ODBC driver, it is most likely a bug
> in that driver (and there is a long history of problems with PostgreSQL
> ODBC drivers, especially on 64-bit systems).
> 
> Note that the error is pretty clearly in /usr/lib64/libodbcpsql.so.2
> calling sprintf,

Oops. I should of course have said that the problem was in RODBC or
further down the chain. Apologies.


> and the buffer passed from RODBC has a length specified
> (correctly) in the SQLGetInfo call.  Thus using sprintf on _that_ buffer
> would of itself be an error.  So there is no evidence here of a 'serious
> problem with RODBC' (and many other people are using it on Linux systems
> with PostgreSQL, and no one else has reported any such issue).



-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From ct529 at york.ac.uk  Fri Oct 31 16:09:07 2008
From: ct529 at york.ac.uk (Corrado)
Date: Fri, 31 Oct 2008 15:09:07 +0000
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
	terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <alpine.LFD.2.00.0810311401070.17003@gannet.stats.ox.ac.uk>
References: <200810311117.17677.ct529@york.ac.uk>
	<490AFF2B.2020209@biostat.ku.dk>
	<alpine.LFD.2.00.0810311401070.17003@gannet.stats.ox.ac.uk>
Message-ID: <200810311509.07280.ct529@york.ac.uk>

Dear friends,

the problem is on a postgresql 8.3.1 database on a 64 platform (the setting 
described at the bottom of the previous email).

If the problems is with the odbc driver, why do the other applications connect 
through odbc to the same databases without any problem? I do not think it is 
possible ....

I have been able to connect easily to postgresql databases using previous 
versions of RODBC (that is, before 1.2.3).

Could it be a problem with the compilation flags (CFLAGS)?

As for the steps: as user postgres create a database called test, create a 
dsn, launch R, call the library RODBC, use odbcConnect => buffer overflow. I 
thought they were already described in the original email.

Here is the odbc.ini for the dsn:

[test]
Description             = PostgreSQL
Driver          		= PostgreSQL
Trace          		 = Yes
TraceFile               = /tmp/sql.log
Database                = test
Servername              = localhost
Username                = postgres
Password                = none
Port            = 5432
ReadOnly                = No
RowVersioning           = No
ShowSystemTables                = No
ShowOidColumn           = No
FakeOidIndex            = No
ConnSettings            =


Best,
-- 
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From murdoch at stats.uwo.ca  Fri Oct 31 17:29:13 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 31 Oct 2008 12:29:13 -0400
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
 terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <200810311509.07280.ct529@york.ac.uk>
References: <200810311117.17677.ct529@york.ac.uk>	<490AFF2B.2020209@biostat.ku.dk>	<alpine.LFD.2.00.0810311401070.17003@gannet.stats.ox.ac.uk>
	<200810311509.07280.ct529@york.ac.uk>
Message-ID: <490B3259.9020200@stats.uwo.ca>

On 10/31/2008 11:09 AM, Corrado wrote:
> Dear friends,
> 
> the problem is on a postgresql 8.3.1 database on a 64 platform (the setting 
> described at the bottom of the previous email).
> 
> If the problems is with the odbc driver, why do the other applications connect 
> through odbc to the same databases without any problem? I do not think it is 
> possible ....

See Prof. Ripley's message.  RODBC is passing a buffer and buffer size 
to the ODBC driver, and that driver is overflowing the buffer.  You 
could probably hide this bug by making the buffer larger, but the real 
fix is for the driver to take account of the buffer size it is being given.

Duncan Murdoch

> 
> I have been able to connect easily to postgresql databases using previous 
> versions of RODBC (that is, before 1.2.3).
> 
> Could it be a problem with the compilation flags (CFLAGS)?
> 
> As for the steps: as user postgres create a database called test, create a 
> dsn, launch R, call the library RODBC, use odbcConnect => buffer overflow. I 
> thought they were already described in the original email.
> 
> Here is the odbc.ini for the dsn:
> 
> [test]
> Description             = PostgreSQL
> Driver          		= PostgreSQL
> Trace          		 = Yes
> TraceFile               = /tmp/sql.log
> Database                = test
> Servername              = localhost
> Username                = postgres
> Password                = none
> Port            = 5432
> ReadOnly                = No
> RowVersioning           = No
> ShowSystemTables                = No
> ShowOidColumn           = No
> FakeOidIndex            = No
> ConnSettings            =
> 
> 
> Best,


From ct529 at york.ac.uk  Fri Oct 31 17:57:58 2008
From: ct529 at york.ac.uk (Corrado)
Date: Fri, 31 Oct 2008 16:57:58 +0000
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
	terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <490B3259.9020200@stats.uwo.ca>
References: <200810311117.17677.ct529@york.ac.uk>
	<200810311509.07280.ct529@york.ac.uk>
	<490B3259.9020200@stats.uwo.ca>
Message-ID: <200810311657.58146.ct529@york.ac.uk>

On Friday 31 October 2008 16:29:13 you wrote:
> See Prof. Ripley's message.  RODBC is passing a buffer and buffer size
> to the ODBC driver, and that driver is overflowing the buffer.  You
> could probably hide this bug by making the buffer larger, but the real
> fix is for the driver to take account of the buffer size it is being given.

1) How do you make the buffer bigger? Are we talking about increasing the 
-- --param=ssp-buffer-size=4 at compilation time? would that solve the 
problem, in your opinion?

2) Why is this problem RODBC specific, if the problem is in the odbc driver? I 
do agree that RODBC passes buffer / buffer size, but why do other 
applications work and RODBC does not? If the problem was with the driver, 
then every other application linking to the same database through the same 
driver would have the same problem, unless the other applications pass the 
call (+ buffer / buffer size) in a different way. 

Please, keep in mind I am just trying to solve a problem that other people may 
have, because I am using standard installation. 

Best,
--
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From murdoch at stats.uwo.ca  Fri Oct 31 20:13:18 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 31 Oct 2008 15:13:18 -0400
Subject: [Rd] *** buffer overflow detected ***: /usr/lib64/R/bin/exec/R
 terminated on R 2.6.2 to 2.8.0: logging a bug?
In-Reply-To: <200810311657.58146.ct529@york.ac.uk>
References: <200810311117.17677.ct529@york.ac.uk>	<200810311509.07280.ct529@york.ac.uk>	<490B3259.9020200@stats.uwo.ca>
	<200810311657.58146.ct529@york.ac.uk>
Message-ID: <490B58CE.6070701@stats.uwo.ca>

On 10/31/2008 12:57 PM, Corrado wrote:
> On Friday 31 October 2008 16:29:13 you wrote:
>> See Prof. Ripley's message.  RODBC is passing a buffer and buffer size
>> to the ODBC driver, and that driver is overflowing the buffer.  You
>> could probably hide this bug by making the buffer larger, but the real
>> fix is for the driver to take account of the buffer size it is being given.
> 
> 1) How do you make the buffer bigger? Are we talking about increasing the 
> -- --param=ssp-buffer-size=4 at compilation time? would that solve the 
> problem, in your opinion?

I don't know.  I wouldn't do that.

> 
> 2) Why is this problem RODBC specific, if the problem is in the odbc driver? 

Because the other packages pass bigger buffers, or generate different 
messages?

I
> do agree that RODBC passes buffer / buffer size, but why do other 
> applications work and RODBC does not? If the problem was with the driver,
> then every other application linking to the same database through the same 
> driver would have the same problem, unless the other applications pass the 
> call (+ buffer / buffer size) in a different way. 

Or if they ask the driver to do different things, or pass a different 
size of buffer, etc.  The fact that this only occurs for RODBC suggests 
there's a problem there, but the fact that the driver is using sprintf 
on a limited size of buffer is far stronger evidence that the problem is 
in the driver.

Duncan Murdoch

> 
> Please, keep in mind I am just trying to solve a problem that other people may 
> have, because I am using standard installation. 
> 
> Best,
> --
> Corrado Topi
> 
> Global Climate Change & Biodiversity Indicators
> Area 18,Department of Biology
> University of York, York, YO10 5YW, UK
> Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


