From cdetermanjr at gmail.com  Fri Apr  1 18:40:43 2016
From: cdetermanjr at gmail.com (Charles Determan)
Date: Fri, 1 Apr 2016 11:40:43 -0500
Subject: [Rd] [R] TensorFlow in R
In-Reply-To: <CAAyVsXJdHHLABAm_T++6c3h7z=Y4n3WOWqX=NM_LuaDPP70C6A@mail.gmail.com>
References: <CAAyVsXJdHHLABAm_T++6c3h7z=Y4n3WOWqX=NM_LuaDPP70C6A@mail.gmail.com>
Message-ID: <CAKxd1KPw6x5GFyB9Dc3m6SGgRqzq=94SMmqoTxzd96F_GZQ4QQ@mail.gmail.com>

Hi Axel,

Looks like the only thing right now is rflow (
https://github.com/terrytangyuan/rflow).  It appears to simply wrap around
the python bindings.  I am not aware of any others.  Be interesting to keep
an eye on.

Regards,
Charles


On Fri, Apr 1, 2016 at 11:32 AM, Axel Urbiz <axel.urbiz at gmail.com> wrote:

> Hi All,
>
> I didn't have much success through my Google search in finding any active
> R-related projects to create a wrapper around TensorFlow in R. Anyone know
> if this is on the go?
>
> Thanks,
> Axel.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From axel.urbiz at gmail.com  Fri Apr  1 18:32:16 2016
From: axel.urbiz at gmail.com (Axel Urbiz)
Date: Fri, 1 Apr 2016 10:32:16 -0600
Subject: [Rd] TensorFlow in R
Message-ID: <CAAyVsXJdHHLABAm_T++6c3h7z=Y4n3WOWqX=NM_LuaDPP70C6A@mail.gmail.com>

Hi All,

I didn't have much success through my Google search in finding any active
R-related projects to create a wrapper around TensorFlow in R. Anyone know
if this is on the go?

Thanks,
Axel.

	[[alternative HTML version deleted]]


From bernd_bischl at gmx.net  Fri Apr  1 21:43:26 2016
From: bernd_bischl at gmx.net (Bernd Bischl)
Date: Fri, 1 Apr 2016 21:43:26 +0200
Subject: [Rd] TensorFlow in R
In-Reply-To: <CAAyVsXJdHHLABAm_T++6c3h7z=Y4n3WOWqX=NM_LuaDPP70C6A@mail.gmail.com>
References: <CAAyVsXJdHHLABAm_T++6c3h7z=Y4n3WOWqX=NM_LuaDPP70C6A@mail.gmail.com>
Message-ID: <56FECF5E.7070208@gmx.net>

Hi,

from what I know there is a current GSOC 2016 project proposal.
(but not accepted yet)

https://github.com/rstats-gsoc/gsoc2016/wiki
https://github.com/rstats-gsoc/gsoc2016/wiki/DeepLearnR-tensorFlow-Object-system-for-R


Is that of interest?

Best,

Bernd


On 01.04.2016 18:32, Axel Urbiz wrote:
> Hi All,
>
> I didn't have much success through my Google search in finding any active
> R-related projects to create a wrapper around TensorFlow in R. Anyone know
> if this is on the go?
>
> Thanks,
> Axel.
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From rdonnelly at continuum.io  Mon Apr  4 03:44:21 2016
From: rdonnelly at continuum.io (Ray Donnelly)
Date: Mon, 4 Apr 2016 02:44:21 +0100
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0 on
	windows
Message-ID: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>

Hi,

Apologies for breaking the threading on this, I've only just signed up to
the list and the last email was from September 2015.

I've started to look into building R for Windows using MSYS2 as both the
build environment and tools + libraries provider (where possible). I've
managed to get the testsuite to pass on a recent MSYS2 MinGW-w64 x86-64 GCC:
gcc.exe (Rev1, Built by MSYS2 project) 5.3.1 20160228

I've attached two patches that I needed, described below. I hope this is
the appropriate place and way to suggest patches. Comments for improvements
are very welcome.

0005-Win32-Extend-sqrt-NA_real_-hack-to-all-GCC-versions.patch
Removes the __GNUC__ <= 4 for Windows ISNAN R_sqrt hack and doesn't replace
it with any version check since I don't see any reason to second-guess when
it might be fixed. When it is fixed in MinGW-w64 we can just remove the
hack and be happy (I would hope to be able to get round to this in the next
few months).

0006-Win32-GCC-5.3-Fix-ISNAN-int-emits-UD2-insn.patch
The reason that boxplot.stats() was crashing was because when isnan() is
called with an int it emits a UD2 instruction to force a crash, so let us
just cast the input value to a double to prevent that. The code for this
can be seen here:
https://github.com/Alexpux/mingw-w64/blob/master/mingw-w64-headers/crt/math.h#L612-L622

--

Best regards,

Ray Donnelly,

Continuum Analytics Inc.

From J.Gorecki at wit.edu.pl  Sat Apr  2 14:33:06 2016
From: J.Gorecki at wit.edu.pl (=?UTF-8?B?SmFuIEfDs3JlY2tp?=)
Date: Sat, 2 Apr 2016 13:33:06 +0100
Subject: [Rd] Suggested dependencies in context of R CMD check
Message-ID: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>

Dear R team,

Are suggested dependencies mandatory in context of `R CMD check` when
using env var `_R_CHECK_FORCE_SUGGESTS_=FALSE`?

Suggested dependencies are nice because are optional.
But that feature often isn't valid when trying to run `R CMD check` on them.
I would like to use `export _R_CHECK_FORCE_SUGGESTS_=FALSE`, which
according to the comment in `tools/R/check.R`:

> The suggested packages are required for a complete check.
 Checking can be attempted without them by setting the environment
variable _R_CHECK_FORCE_SUGGESTS_ to a false value.

should be sufficient to run *check* process without installing suggested deps.
If it is not true, then how to differentiate the suggested packages
which are optional from those mandatory?
It would be helpful to have kind of `vignetteBuilder` DESCRIPTION
field called `testChecker`, so DESCRIPTION file could precisely manage
packages dependencies.
That way batch checking packages would be easier, as required dep
metadata would be at hand in description file. Batch checking pkgs
with all their suggests will simply result into testing whole CRAN.

In a single package it can be handled with `if (requireNamespace(.))
test_package(.)` for `testthat` and `knitr`, also with mocking up
`.Rout` files.

But I'm interested into canonical design of a suggested package and
`_R_CHECK_FORCE_SUGGESTS_` env var.
Is there any R core dev team recommendation/suggestion on that? and
don't you thing new field `testChecker` in DESCRIPTION could help for
batch checking pkgs? Installing all suggested packages of all reverse
dependencies doesn't scale.

Jan Gorecki


From murdoch.duncan at gmail.com  Mon Apr  4 13:29:10 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 4 Apr 2016 07:29:10 -0400
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0 on
 windows
In-Reply-To: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
Message-ID: <57025006.1090301@gmail.com>

On 03/04/2016 9:44 PM, Ray Donnelly wrote:
> Hi,
>
> Apologies for breaking the threading on this, I've only just signed up to
> the list and the last email was from September 2015.
>
> I've started to look into building R for Windows using MSYS2 as both the
> build environment and tools + libraries provider (where possible). I've
> managed to get the testsuite to pass on a recent MSYS2 MinGW-w64 x86-64 GCC:
> gcc.exe (Rev1, Built by MSYS2 project) 5.3.1 20160228
>
> I've attached two patches that I needed, described below. I hope this is
> the appropriate place and way to suggest patches. Comments for improvements
> are very welcome.

There were no patches attached, just the link to the mingw-w64 project 
on Github.

Generally the way to produce patches for R is to use svn diff on a 
checked out working copy of the trunk. On Windows, Tortoisesvn makes 
this really simple.  Then the patch will include information about the 
revision it's based on.  You then upload it to bugs.r-project.org, along 
with a description of the problem it solves, and mark it as a bug fix or 
enhancement request.

>
> 0005-Win32-Extend-sqrt-NA_real_-hack-to-all-GCC-versions.patch
> Removes the __GNUC__ <= 4 for Windows ISNAN R_sqrt hack and doesn't replace
> it with any version check since I don't see any reason to second-guess when
> it might be fixed. When it is fixed in MinGW-w64 we can just remove the
> hack and be happy (I would hope to be able to get round to this in the next
> few months).

I can see increasing the version limit when we commit to gcc 5.x, but I 
think the point of the test is to remind users of new versions to remind 
the developers that they have a bug.  If we work around it forever, it 
will never get fixed.

>
> 0006-Win32-GCC-5.3-Fix-ISNAN-int-emits-UD2-insn.patch
> The reason that boxplot.stats() was crashing was because when isnan() is
> called with an int it emits a UD2 instruction to force a crash, so let us
> just cast the input value to a double to prevent that. The code for this
> can be seen here:
> https://github.com/Alexpux/mingw-w64/blob/master/mingw-w64-headers/crt/math.h#L612-L622

This one I can't guess at without seeing the patch.

Duncan Murdoch


>
> --
>
> Best regards,
>
> Ray Donnelly,
>
> Continuum Analytics Inc.
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From h.wickham at gmail.com  Mon Apr  4 16:25:04 2016
From: h.wickham at gmail.com (Hadley Wickham)
Date: Mon, 4 Apr 2016 07:25:04 -0700
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
Message-ID: <CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>

On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl> wrote:
> Dear R team,
>
> Are suggested dependencies mandatory in context of `R CMD check` when
> using env var `_R_CHECK_FORCE_SUGGESTS_=FALSE`?
>
> Suggested dependencies are nice because are optional.
> But that feature often isn't valid when trying to run `R CMD check` on them.
> I would like to use `export _R_CHECK_FORCE_SUGGESTS_=FALSE`, which
> according to the comment in `tools/R/check.R`:
>
>> The suggested packages are required for a complete check.
>  Checking can be attempted without them by setting the environment
> variable _R_CHECK_FORCE_SUGGESTS_ to a false value.
>
> should be sufficient to run *check* process without installing suggested deps.
> If it is not true, then how to differentiate the suggested packages
> which are optional from those mandatory?
> It would be helpful to have kind of `vignetteBuilder` DESCRIPTION
> field called `testChecker`, so DESCRIPTION file could precisely manage
> packages dependencies.
> That way batch checking packages would be easier, as required dep
> metadata would be at hand in description file. Batch checking pkgs
> with all their suggests will simply result into testing whole CRAN.
>
> In a single package it can be handled with `if (requireNamespace(.))
> test_package(.)` for `testthat` and `knitr`, also with mocking up
> `.Rout` files.
>
> But I'm interested into canonical design of a suggested package and
> `_R_CHECK_FORCE_SUGGESTS_` env var.
> Is there any R core dev team recommendation/suggestion on that? and
> don't you thing new field `testChecker` in DESCRIPTION could help for
> batch checking pkgs? Installing all suggested packages of all reverse
> dependencies doesn't scale.

In principle, I believe a package should pass R CMD check if no
suggested packages are installed. However, since this is not currently
automatically checked, many packages will fail to cleanly pass R CMD
check if suggested packages are missing. In my experience, it's much
easier to simply install all dependencies of your reverse dependencies
(although this is obviously much easier when you're using a platform
with binary packages available from CRAN). I routinely do this for
hundreds to thousands of packages.

Hadley

-- 
http://hadley.nz


From gmbecker at ucdavis.edu  Mon Apr  4 17:36:44 2016
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Mon, 4 Apr 2016 08:36:44 -0700
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
	<CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
Message-ID: <CADwqtCO+OveKTDPH9mrgqeO7JA5RM3fqkv3u1Twt4H8BfOhsDg@mail.gmail.com>

Jan and Hadley,

There's also the issue of tests, vignettes, or examples requiring Suggested
packages (one of the core applications of Suggests, in fact). These are all
checked by R CMD check, so to ensure any package which should pass check
would do so without suggested packages installed would require turning all
of those checks off, which takes quite a few of the teeth out of R CMD
check (and thus the assurances granted by knowing a package passes it).
AFAIK (without going off and checking right now) you /could/ force R CMD
check to do this now with a combination of options, though, if that's
really what you want (which would allow your package to pass when
_R_CHECK_FORCE_SUGGESTS_ is set to false).

~G

On Mon, Apr 4, 2016 at 7:25 AM, Hadley Wickham <h.wickham at gmail.com> wrote:

> On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl> wrote:
> > Dear R team,
> >
> > Are suggested dependencies mandatory in context of `R CMD check` when
> > using env var `_R_CHECK_FORCE_SUGGESTS_=FALSE`?
> >
> > Suggested dependencies are nice because are optional.
> > But that feature often isn't valid when trying to run `R CMD check` on
> them.
> > I would like to use `export _R_CHECK_FORCE_SUGGESTS_=FALSE`, which
> > according to the comment in `tools/R/check.R`:
> >
> >> The suggested packages are required for a complete check.
> >  Checking can be attempted without them by setting the environment
> > variable _R_CHECK_FORCE_SUGGESTS_ to a false value.
> >
> > should be sufficient to run *check* process without installing suggested
> deps.
> > If it is not true, then how to differentiate the suggested packages
> > which are optional from those mandatory?
> > It would be helpful to have kind of `vignetteBuilder` DESCRIPTION
> > field called `testChecker`, so DESCRIPTION file could precisely manage
> > packages dependencies.
> > That way batch checking packages would be easier, as required dep
> > metadata would be at hand in description file. Batch checking pkgs
> > with all their suggests will simply result into testing whole CRAN.
> >
> > In a single package it can be handled with `if (requireNamespace(.))
> > test_package(.)` for `testthat` and `knitr`, also with mocking up
> > `.Rout` files.
> >
> > But I'm interested into canonical design of a suggested package and
> > `_R_CHECK_FORCE_SUGGESTS_` env var.
> > Is there any R core dev team recommendation/suggestion on that? and
> > don't you thing new field `testChecker` in DESCRIPTION could help for
> > batch checking pkgs? Installing all suggested packages of all reverse
> > dependencies doesn't scale.
>
> In principle, I believe a package should pass R CMD check if no
> suggested packages are installed. However, since this is not currently
> automatically checked, many packages will fail to cleanly pass R CMD
> check if suggested packages are missing. In my experience, it's much
> easier to simply install all dependencies of your reverse dependencies
> (although this is obviously much easier when you're using a platform
> with binary packages available from CRAN). I routinely do this for
> hundreds to thousands of packages.
>
> Hadley
>
> --
> http://hadley.nz
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From arunkumar.sriniv at gmail.com  Mon Apr  4 18:00:52 2016
From: arunkumar.sriniv at gmail.com (Arunkumar Srinivasan)
Date: Mon, 4 Apr 2016 18:00:52 +0200
Subject: [Rd] Understanding POSIXct creation on different OSes.
Message-ID: <CAJ=vYTENdukcF4XZpTkg=y1vFe2QJ5DNBKtCXBPBhey1auvw-A@mail.gmail.com>

Hello,

Following Dirk's post here: https://github.com/Rdatatable/data.table/issues/1619
we would like to clarify if this is the right behaviour, and if so,
the rationale behind it.

Here's the summary (thanks to Dirk and Joshua):

Sys.setenv("TZ"="America/Chicago")
dates = as.Date("2016-03-02") + (0:3)*7 # four Wednesdays
# [1] "2016-03-02" "2016-03-09" "2016-03-16" "2016-03-23"

# on OS X and Windows 10 -- expected result
as.POSIXct(as.POSIXlt(dates), tz = "America/Chicago")
# [1] "2016-03-02 CST" "2016-03-09 CST" "2016-03-16 CDT" "2016-03-23 CDT"

# On Linux (tested on Ubuntu 14.04) -- not as expected
as.POSIXct(as.POSIXlt(dates), tz = "America/Chicago")
# [1] "2016-03-02 00:00:00 CST" "2016-03-09 00:00:00 CST" "2016-03-16
01:00:00 CDT" "2016-03-23 01:00:00 CDT"

# 'isdst' attribute is identical on OS X / Windows / Ubuntu, as expected
# since dates don't have timezones, as pointed out by @JoshuaUlrich under
# issue #1619.
lt = as.POSIXlt(dates)
lt$isdst
# [1] 0 0 0 0

# However, as Dirk points out, setting isdst to -1 on Ubuntu returns
expected results
lt$isdst = -1
as.POSIXct(lt, tz = "America/Chicago")
# [1] "2016-03-02 CST" "2016-03-09 CST" "2016-03-16 CDT" "2016-03-23 CDT"

# Note that setting isdst to -1 on OS X / Windows has no effect, i.e.,
the result is always as expected.

As Dirk points out, from ?POSIXlt:
"Where possible the platform limits are detected, and outside the
limits we use our own C code. This uses the offset from GMT in
use either for 1902 (when there was no DST) or that predicted for
one of 2030 to 2037 (chosen so that the likely DST transition days
are Sundays), and uses the alternate (daylight-saving) time zone
only if ?isdst? is positive or (if ?-1?) if DST was predicted to
be in operation in the 2030s on that day."

It's not clear what this exactly means, and if it is related to the
behaviour shown above. It'd be nice to know if a) this behaviour of
non-identical result is as expected, and if so, b) can we rely on
setting 'isdst' to -1 returning the expected result always?

Thank you,
Arun.


From edd at debian.org  Mon Apr  4 19:35:59 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 4 Apr 2016 12:35:59 -0500
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
	<CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
Message-ID: <22274.42495.805158.436137@max.nulle.part>


On 4 April 2016 at 07:25, Hadley Wickham wrote:
| On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl> wrote:
| 
| In principle, I believe a package should pass R CMD check if no
| suggested packages are installed. However, since this is not currently

The relevant manual says

     The 'Suggests' field uses the same syntax as 'Depends' and lists
  packages that are not necessarily needed.  This includes packages used
  only in examples, tests or vignettes (*note Writing package
  vignettes::), and packages loaded in the body of functions.  E.g.,
  suppose an example(1) from package *foo* uses a dataset from package
  *bar*.  Then it is not necessary to have *bar* use *foo* unless one
  wants to execute all the examples/tests/vignettes: it is useful to have
  *bar*, but not necessary.  Version requirements can be specified, and
  will be used by 'R CMD check'.

and later

   * All packages that are needed(2) to successfully run 'R CMD check'
     on the package must be listed in one of 'Depends' or 'Suggests' or
     'Imports'.  Packages used to run examples or tests conditionally
     (e.g. _via_ 'if(require(PKGNAME))') should be listed in 'Suggests'
     or 'Enhances'.  (This allows checkers to ensure that all the
     packages needed for a complete check are installed.)

| automatically checked, many packages will fail to cleanly pass R CMD
| check if suggested packages are missing.

I consider that to be a bug in those 'many packages'.  It essentially takes
away the usefulness of having a Suggests: to provide a more fine-grained
dependency graph.

So I am with Jan here.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Mon Apr  4 19:56:27 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 4 Apr 2016 13:56:27 -0400
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <22274.42495.805158.436137@max.nulle.part>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
	<CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
	<22274.42495.805158.436137@max.nulle.part>
Message-ID: <5702AACB.5060308@gmail.com>

On 04/04/2016 1:35 PM, Dirk Eddelbuettel wrote:
> On 4 April 2016 at 07:25, Hadley Wickham wrote:
> | On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl> wrote:
> |
> | In principle, I believe a package should pass R CMD check if no
> | suggested packages are installed. However, since this is not currently
>
> The relevant manual says
>
>       The 'Suggests' field uses the same syntax as 'Depends' and lists
>    packages that are not necessarily needed.  This includes packages used
>    only in examples, tests or vignettes (*note Writing package
>    vignettes::), and packages loaded in the body of functions.  E.g.,
>    suppose an example(1) from package *foo* uses a dataset from package
>    *bar*.  Then it is not necessary to have *bar* use *foo* unless one
>    wants to execute all the examples/tests/vignettes: it is useful to have
>    *bar*, but not necessary.  Version requirements can be specified, and
>    will be used by 'R CMD check'.
>
> and later
>
>     * All packages that are needed(2) to successfully run 'R CMD check'
>       on the package must be listed in one of 'Depends' or 'Suggests' or
>       'Imports'.  Packages used to run examples or tests conditionally
>       (e.g. _via_ 'if(require(PKGNAME))') should be listed in 'Suggests'
>       or 'Enhances'.  (This allows checkers to ensure that all the
>       packages needed for a complete check are installed.)
>
> | automatically checked, many packages will fail to cleanly pass R CMD
> | check if suggested packages are missing.
>
> I consider that to be a bug in those 'many packages'.  It essentially takes
> away the usefulness of having a Suggests: to provide a more fine-grained
> dependency graph.
>
> So I am with Jan here.

I think I agree with Jan, but not for the reason you state.

Suggests is useful even if "R CMD check" treats it as Depends, because 
most users never need to run "R CMD check".  It allows them to use a 
subset of the functionality of a package without installing tons of 
dependencies.

I agree that packages that fail on examples when Suggested packages are 
missing are broken.  (Using if (require()) to skip particular examples 
isn't failing.)  It would be useful to be able to detect failure; I 
don't think that's easy now with "R CMD check".  That's why you should 
be able to run it with Suggested packages missing.

The ideal situation would be to be able to run all possible combinations 
of missing Suggested packages, but that's probably far too slow to be a 
default.

BTW, I'm not completely sure it needs to be possible to run vignettes 
without the Suggested packages they need.  Vignettes are allowed to 
depend on things that aren't available to all users, and adding all the 
require() tests could make them less clear.

Duncan Murdoch


From jeroen.ooms at stat.ucla.edu  Mon Apr  4 20:39:55 2016
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Mon, 4 Apr 2016 11:39:55 -0700
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0 on
	windows
In-Reply-To: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
Message-ID: <CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>

On Sun, Apr 3, 2016 at 6:44 PM, Ray Donnelly <rdonnelly at continuum.io> wrote:
> I've started to look into building R for Windows using MSYS2 as both the
> build environment and tools + libraries provider (where possible).

Thanks for your reply, and for the patches.

Last time I had a look at this (a few months ago) another problem was
that mingw-w64 v4 was giving different numeric output for some of the
tests in r-base. If I recall correctly, some eigen vectors had their
direction flipped (negative values became positive and vice versa).
Did you notice anything of this kind when running 'make check' and
'make check recommended' ? It is important to us that numeric results
are reproducible between versions of R.


From mick.jordan at oracle.com  Mon Apr  4 20:49:22 2016
From: mick.jordan at oracle.com (Mick Jordan)
Date: Mon, 4 Apr 2016 11:49:22 -0700
Subject: [Rd] debug/recover/.Internal
Message-ID: <5702B732.5050209@oracle.com>

I was surprised by difference between using options(error=browser) and 
options(error=recover) when handling an error from sys.frame that I 
assume is related to the fact that the error is thrown from the 
.Internal and the 'which' parameter to the closure isn't available.

 > options(error=browser)
 > f <- function() sys.frame(-3)
 > f()
Error in sys.frame(-3) : not that many frames on the stack
Called from: sys.frame(-3)
Browse[1]> where
where 1 at #1: sys.frame(-3)
where 2: f()

Browse[1]> print(which)
function (x, arr.ind = FALSE, useNames = TRUE)
{
     wh <- .Internal(which(x))
     if (arr.ind && !is.null(d <- dim(x)))
         arrayInd(wh, d, dimnames(x), useNames = useNames)
     else wh
}
<bytecode: 0x7fe7a43f1260>
<environment: namespace:base>

Whereas:

 > options(error=recover)
 > f()
Error in sys.frame(-3) : not that many frames on the stack

Enter a frame number, or 0 to exit

1: f()
2: #1: sys.frame(-3)

Selection: 2
Called from: top level
Browse[1]> print(which)
[1] -3
Browse[1]>


From rdonnelly at continuum.io  Mon Apr  4 21:11:16 2016
From: rdonnelly at continuum.io (Ray Donnelly)
Date: Mon, 4 Apr 2016 20:11:16 +0100
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0 on
	windows
In-Reply-To: <57025006.1090301@gmail.com>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
	<57025006.1090301@gmail.com>
Message-ID: <CAF5kcVWpMuoRvEHzwRvsBUX+VfthUF-COU2hn5S2-JuxO2yJrw@mail.gmail.com>

On Mon, Apr 4, 2016 at 12:29 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 03/04/2016 9:44 PM, Ray Donnelly wrote:
>
>> Hi,
>>
>> Apologies for breaking the threading on this, I've only just signed up to
>> the list and the last email was from September 2015.
>>
>> I've started to look into building R for Windows using MSYS2 as both the
>> build environment and tools + libraries provider (where possible). I've
>> managed to get the testsuite to pass on a recent MSYS2 MinGW-w64 x86-64
>> GCC:
>> gcc.exe (Rev1, Built by MSYS2 project) 5.3.1 20160228
>>
>> I've attached two patches that I needed, described below. I hope this is
>> the appropriate place and way to suggest patches. Comments for
>> improvements
>> are very welcome.
>>
>
> There were no patches attached, just the link to the mingw-w64 project on
> Github.
>

Ah, that's strange, they must have got stripped.


>
> Generally the way to produce patches for R is to use svn diff on a checked
> out working copy of the trunk. On Windows, Tortoisesvn makes this really
> simple.  Then the patch will include information about the revision it's
> based on.  You then upload it to bugs.r-project.org, along with a
> description of the problem it solves, and mark it as a bug fix or
> enhancement request.


Ok, I had used diffutils' diff -urN on the 3.2.4-revised release to
generate them.


>
>
>> 0005-Win32-Extend-sqrt-NA_real_-hack-to-all-GCC-versions.patch
>> Removes the __GNUC__ <= 4 for Windows ISNAN R_sqrt hack and doesn't
>> replace
>> it with any version check since I don't see any reason to second-guess
>> when
>> it might be fixed. When it is fixed in MinGW-w64 we can just remove the
>> hack and be happy (I would hope to be able to get round to this in the
>> next
>> few months).
>>
>
> I can see increasing the version limit when we commit to gcc 5.x, but I
> think the point of the test is to remind users of new versions to remind
> the developers that they have a bug.  If we work around it forever, it will
> never get fixed.


OK. Am I right in thinking that many GNU/Linux distributions already build
R with GCC > 4? The bug here lies with MinGW-w64 and not with GCC.


>
>
>> 0006-Win32-GCC-5.3-Fix-ISNAN-int-emits-UD2-insn.patch
>> The reason that boxplot.stats() was crashing was because when isnan() is
>> called with an int it emits a UD2 instruction to force a crash, so let us
>> just cast the input value to a double to prevent that. The code for this
>> can be seen here:
>>
>> https://github.com/Alexpux/mingw-w64/blob/master/mingw-w64-headers/crt/math.h#L612-L622
>>
>
> This one I can't guess at without seeing the patch.
>

Both patches modified the exact same lines in eval.c, so I will need to
regenerate it if we are dropping the first patch (and also generate it with
svn diff), but I may as well inline it since it's so simple:

--- src/main/eval.c    2016-04-03 19:46:51.025442100 +0100
+++ src/main/eval.c.new    2016-04-03 19:46:48.279325900 +0100
@@ -3624,7 +3624,7 @@
    toolchain or in our expectations, but these defines attempt to work
    around this. */
 #if (defined(_WIN32) || defined(_WIN64)) && defined(__GNUC__)
-# define R_sqrt(x) (ISNAN(x) ? x : sqrt(x))
+# define R_sqrt(x) (ISNAN((double)x) ? x : sqrt(x))
 #else
 # define R_sqrt sqrt
 #endif

But, we should fix this in MinGW-w64. It's returning a different +/-NaN
from the input NaN in contrast to all the other platforms that R runs on,
as far as I can gather. In that case, I've proposed a patch to address this
issue and if and when this makes it into a release I will send another
patch to R's Bugzilla to avoid this hack altogether if using that release
or a later version, and otherwise to use a combination of the two patches I
supplied earlier.


> Duncan Murdoch
>
>
>
>> --
>>
>> Best regards,
>>
>> Ray Donnelly,
>>
>> Continuum Analytics Inc.
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>

	[[alternative HTML version deleted]]


From rdonnelly at continuum.io  Mon Apr  4 21:13:38 2016
From: rdonnelly at continuum.io (Ray Donnelly)
Date: Mon, 4 Apr 2016 20:13:38 +0100
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0 on
	windows
In-Reply-To: <CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
	<CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
Message-ID: <CAF5kcVXPXjjTvxyGPuzPdN=7GX4w85bD5KPOhftuqj_1iJ240Q@mail.gmail.com>

On Mon, Apr 4, 2016 at 7:39 PM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu>
wrote:

> On Sun, Apr 3, 2016 at 6:44 PM, Ray Donnelly <rdonnelly at continuum.io>
> wrote:
> > I've started to look into building R for Windows using MSYS2 as both the
> > build environment and tools + libraries provider (where possible).
>
> Thanks for your reply, and for the patches.
>

No problem.


> Last time I had a look at this (a few months ago) another problem was
> that mingw-w64 v4 was giving different numeric output for some of the
> tests in r-base. If I recall correctly, some eigen vectors had their
> direction flipped (negative values became positive and vice versa).
> Did you notice anything of this kind when running 'make check' and
> 'make check recommended' ? It is important to us that numeric results
> are reproducible between versions of R.
>

I have not seen make check fail with any reports of eigenvector flip.

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Mon Apr  4 21:26:38 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 4 Apr 2016 12:26:38 -0700
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0 on
	windows
In-Reply-To: <CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
	<CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
Message-ID: <CAF8bMcaBcy8zCiRjEBVmoghDjdos=BH-Gy2+6hCqSJrpT07ruQ@mail.gmail.com>

>If I recall correctly, some eigen vectors had their
>direction flipped (negative values became positive and vice versa).
>Did you notice anything of this kind when running 'make check' and
>'make check recommended' ? It is important to us that numeric results
>are reproducible between versions of R.

I think that any code that depends on the direction
of an eigenvector should be considered broken.
It is too bad that eigen's output does not have a class
so that an all.equal method that know that the vector
direction is not relevant could be written for it


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Mon, Apr 4, 2016 at 11:39 AM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu>
wrote:

> On Sun, Apr 3, 2016 at 6:44 PM, Ray Donnelly <rdonnelly at continuum.io>
> wrote:
> > I've started to look into building R for Windows using MSYS2 as both the
> > build environment and tools + libraries provider (where possible).
>
> Thanks for your reply, and for the patches.
>
> Last time I had a look at this (a few months ago) another problem was
> that mingw-w64 v4 was giving different numeric output for some of the
> tests in r-base. If I recall correctly, some eigen vectors had their
> direction flipped (negative values became positive and vice versa).
> Did you notice anything of this kind when running 'make check' and
> 'make check recommended' ? It is important to us that numeric results
> are reproducible between versions of R.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From pgilbert902 at gmail.com  Tue Apr  5 01:12:23 2016
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Mon, 4 Apr 2016 19:12:23 -0400
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <5702AACB.5060308@gmail.com>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
	<CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
	<22274.42495.805158.436137@max.nulle.part> <5702AACB.5060308@gmail.com>
Message-ID: <5702F4D7.4000202@gmail.com>



On 04/04/2016 01:56 PM, Duncan Murdoch wrote:
> On 04/04/2016 1:35 PM, Dirk Eddelbuettel wrote:
>> On 4 April 2016 at 07:25, Hadley Wickham wrote:
>> | On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl>
>> wrote:
>> |
>> | In principle, I believe a package should pass R CMD check if no
>> | suggested packages are installed. However, since this is not currently
>>
>> The relevant manual says
>>
>>       The 'Suggests' field uses the same syntax as 'Depends' and lists
>>    packages that are not necessarily needed.  This includes packages used
>>    only in examples, tests or vignettes (*note Writing package
>>    vignettes::), and packages loaded in the body of functions.  E.g.,
>>    suppose an example(1) from package *foo* uses a dataset from package
>>    *bar*.  Then it is not necessary to have *bar* use *foo* unless one
>>    wants to execute all the examples/tests/vignettes: it is useful to
>> have
>>    *bar*, but not necessary.  Version requirements can be specified, and
>>    will be used by 'R CMD check'.
>>
>> and later
>>
>>     * All packages that are needed(2) to successfully run 'R CMD check'
>>       on the package must be listed in one of 'Depends' or 'Suggests' or
>>       'Imports'.  Packages used to run examples or tests conditionally
>>       (e.g. _via_ 'if(require(PKGNAME))') should be listed in 'Suggests'
>>       or 'Enhances'.  (This allows checkers to ensure that all the
>>       packages needed for a complete check are installed.)
>>
>> | automatically checked, many packages will fail to cleanly pass R CMD
>> | check if suggested packages are missing.
>>
>> I consider that to be a bug in those 'many packages'.  It essentially
>> takes
>> away the usefulness of having a Suggests: to provide a more fine-grained
>> dependency graph.
>>
>> So I am with Jan here.
>
> I think I agree with Jan, but not for the reason you state.
>
> Suggests is useful even if "R CMD check" treats it as Depends, because
> most users never need to run "R CMD check".  It allows them to use a
> subset of the functionality of a package without installing tons of
> dependencies.
>
> I agree that packages that fail on examples when Suggested packages are
> missing are broken.  (Using if (require()) to skip particular examples
> isn't failing.)  It would be useful to be able to detect failure; I
> don't think that's easy now with "R CMD check".  That's why you should
> be able to run it with Suggested packages missing.

Perhaps I'm confused, it would not be the first time, but I have the 
impression that some/all? of you are arguing for a different philosophy 
around R CMD check and Suggests/Depends. But the current design is not 
broken, it is working the way it has been advertised for many years now. 
It provides a fine-grained dependency graph for end users, not 
developers and testers. Being able to suggest packages for use in 
testing, when they are not needed for regular use is a good thing. A 
package failing R CMD check when the suggested packages are not 
available is not a bug, it is a feature following the rules as they have 
been designed. If you want to check a package then you need to install 
things that are needed to check it. If R CMD check skipped testing 
because suggested packages were not available then you will have many 
packages not being tested properly, that is, lots of broken packages 
passing R CMD check. (I've done this to myself sometimes using 
if(require()).) There are situations where some testing needs to be 
skipped, for example, license requirements and special databases, but 
this needs to be done carefully, and my impression is that if(require()) 
provides most of what is necessary, sometimes along with environment 
variables. Perhaps this is not elegant, but it does work and is not 
difficult.
>
> The ideal situation would be to be able to run all possible combinations
> of missing Suggested packages, but that's probably far too slow to be a
> default.

But how do you decide pass/fail when you do this? I think it will only 
pass when all the suggested packages are available?

Paul Gilbert

>
> BTW, I'm not completely sure it needs to be possible to run vignettes
> without the Suggested packages they need.  Vignettes are allowed to
> depend on things that aren't available to all users, and adding all the
> require() tests could make them less clear.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Tue Apr  5 01:01:29 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 4 Apr 2016 19:01:29 -0400
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <5702F4D7.4000202@gmail.com>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
	<CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
	<22274.42495.805158.436137@max.nulle.part> <5702AACB.5060308@gmail.com>
	<5702F4D7.4000202@gmail.com>
Message-ID: <5702F249.20007@gmail.com>

On 04/04/2016 7:12 PM, Paul Gilbert wrote:
>
>
> On 04/04/2016 01:56 PM, Duncan Murdoch wrote:
>> On 04/04/2016 1:35 PM, Dirk Eddelbuettel wrote:
>>> On 4 April 2016 at 07:25, Hadley Wickham wrote:
>>> | On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl>
>>> wrote:
>>> |
>>> | In principle, I believe a package should pass R CMD check if no
>>> | suggested packages are installed. However, since this is not currently
>>>
>>> The relevant manual says
>>>
>>>        The 'Suggests' field uses the same syntax as 'Depends' and lists
>>>     packages that are not necessarily needed.  This includes packages used
>>>     only in examples, tests or vignettes (*note Writing package
>>>     vignettes::), and packages loaded in the body of functions.  E.g.,
>>>     suppose an example(1) from package *foo* uses a dataset from package
>>>     *bar*.  Then it is not necessary to have *bar* use *foo* unless one
>>>     wants to execute all the examples/tests/vignettes: it is useful to
>>> have
>>>     *bar*, but not necessary.  Version requirements can be specified, and
>>>     will be used by 'R CMD check'.
>>>
>>> and later
>>>
>>>      * All packages that are needed(2) to successfully run 'R CMD check'
>>>        on the package must be listed in one of 'Depends' or 'Suggests' or
>>>        'Imports'.  Packages used to run examples or tests conditionally
>>>        (e.g. _via_ 'if(require(PKGNAME))') should be listed in 'Suggests'
>>>        or 'Enhances'.  (This allows checkers to ensure that all the
>>>        packages needed for a complete check are installed.)
>>>
>>> | automatically checked, many packages will fail to cleanly pass R CMD
>>> | check if suggested packages are missing.
>>>
>>> I consider that to be a bug in those 'many packages'.  It essentially
>>> takes
>>> away the usefulness of having a Suggests: to provide a more fine-grained
>>> dependency graph.
>>>
>>> So I am with Jan here.
>>
>> I think I agree with Jan, but not for the reason you state.
>>
>> Suggests is useful even if "R CMD check" treats it as Depends, because
>> most users never need to run "R CMD check".  It allows them to use a
>> subset of the functionality of a package without installing tons of
>> dependencies.
>>
>> I agree that packages that fail on examples when Suggested packages are
>> missing are broken.  (Using if (require()) to skip particular examples
>> isn't failing.)  It would be useful to be able to detect failure; I
>> don't think that's easy now with "R CMD check".  That's why you should
>> be able to run it with Suggested packages missing.
>
> Perhaps I'm confused, it would not be the first time, but I have the
> impression that some/all? of you are arguing for a different philosophy
> around R CMD check and Suggests/Depends. But the current design is not
> broken, it is working the way it has been advertised for many years now.
> It provides a fine-grained dependency graph for end users, not
> developers and testers. Being able to suggest packages for use in
> testing, when they are not needed for regular use is a good thing. A
> package failing R CMD check when the suggested packages are not
> available is not a bug, it is a feature following the rules as they have
> been designed. If you want to check a package then you need to install
> things that are needed to check it. If R CMD check skipped testing
> because suggested packages were not available then you will have many
> packages not being tested properly, that is, lots of broken packages
> passing R CMD check. (I've done this to myself sometimes using
> if(require()).) There are situations where some testing needs to be
> skipped, for example, license requirements and special databases, but
> this needs to be done carefully, and my impression is that if(require())
> provides most of what is necessary, sometimes along with environment
> variables. Perhaps this is not elegant, but it does work and is not
> difficult.
>>
>> The ideal situation would be to be able to run all possible combinations
>> of missing Suggested packages, but that's probably far too slow to be a
>> default.
>
> But how do you decide pass/fail when you do this? I think it will only
> pass when all the suggested packages are available?

Supposing all dependencies are available, there are several ways to 
decide on pass vs fail.

  - You fail if your examples generate an error.
  - If you have saved example output, you fail if it doesn't match the 
old output.
  - You fail if your tests generate an error, or have different output 
than the optional saved output.

So what if some Suggested files are not available during testing?

The "fail on error" rule would be identical if the Suggested packages 
were missing.  Output of tests and examples will likely change, so if it 
were possible to test without Suggested packages, you'd need a way to 
indicate what changes are allowed.  (But most packages don't save test 
results and don't save example output anyway.)

Duncan Murdoch


From sgiannerini at gmail.com  Tue Apr  5 15:35:30 2016
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Tue, 5 Apr 2016 15:35:30 +0200
Subject: [Rd] Under Windows,
 Rgui and Rterm crash if one tries to close the graphic device while
 identify or locator are running
Message-ID: <CANcXGixqBFipv1crwjnWre0=YykYk1VB6QVLvbf6EO1QAotHHg@mail.gmail.com>

minimal reproducible example

plot(1,1)
identify(1,1) # or locator()

now, trying to close the window by clicking on the cross of the upper
right corner causes Rgui (and Rterm) to crash.

I see the same behaviour on 2 different Windows PC (one with Win 8.1
and one with Win 10).
I did not see the problem in linux (see below)

WINDOWS **************
> sessionInfo()
R version 3.3.0 beta (2016-04-04 r70420)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 10586)

locale:
[1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
[3] LC_MONETARY=Italian_Italy.1252 LC_NUMERIC=C
[5] LC_TIME=Italian_Italy.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

> sessionInfo()
R version 3.2.2 Patched (2015-09-29 r69441)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 10240)

locale:
[1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
LC_MONETARY=Italian_Italy.1252
[4] LC_NUMERIC=C                   LC_TIME=Italian_Italy.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_3.2.2


** LINUX *****************************

> sessionInfo()
R version 3.2.0 Patched (2015-04-21 r68221)
Platform: x86_64-unknown-linux-gnu (64-bit)
Running under: openSUSE 13.2 (Harlequin) (x86_64)

locale:
 [1] LC_CTYPE=it_IT.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=it_IT.UTF-8
 [5] LC_MONETARY=it_IT.UTF-8    LC_MESSAGES=it_IT.UTF-8
 [7] LC_PAPER=it_IT.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=it_IT.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

--
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From murdoch.duncan at gmail.com  Tue Apr  5 17:23:51 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 5 Apr 2016 11:23:51 -0400
Subject: [Rd] Under Windows,
 Rgui and Rterm crash if one tries to close the graphic device while
 identify or locator are running
In-Reply-To: <CANcXGixqBFipv1crwjnWre0=YykYk1VB6QVLvbf6EO1QAotHHg@mail.gmail.com>
References: <CANcXGixqBFipv1crwjnWre0=YykYk1VB6QVLvbf6EO1QAotHHg@mail.gmail.com>
Message-ID: <5703D887.1010204@gmail.com>

Thanks, I'll track this down.

Duncan Murdoch

On 05/04/2016 9:35 AM, Simone Giannerini wrote:
> minimal reproducible example
>
> plot(1,1)
> identify(1,1) # or locator()
>
> now, trying to close the window by clicking on the cross of the upper
> right corner causes Rgui (and Rterm) to crash.
>
> I see the same behaviour on 2 different Windows PC (one with Win 8.1
> and one with Win 10).
> I did not see the problem in linux (see below)
>
> WINDOWS **************
> > sessionInfo()
> R version 3.3.0 beta (2016-04-04 r70420)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 10586)
>
> locale:
> [1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
> [3] LC_MONETARY=Italian_Italy.1252 LC_NUMERIC=C
> [5] LC_TIME=Italian_Italy.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> > sessionInfo()
> R version 3.2.2 Patched (2015-09-29 r69441)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 10240)
>
> locale:
> [1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
> LC_MONETARY=Italian_Italy.1252
> [4] LC_NUMERIC=C                   LC_TIME=Italian_Italy.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tools_3.2.2
>
>
> ** LINUX *****************************
>
> > sessionInfo()
> R version 3.2.0 Patched (2015-04-21 r68221)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> Running under: openSUSE 13.2 (Harlequin) (x86_64)
>
> locale:
>   [1] LC_CTYPE=it_IT.UTF-8       LC_NUMERIC=C
>   [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=it_IT.UTF-8
>   [5] LC_MONETARY=it_IT.UTF-8    LC_MESSAGES=it_IT.UTF-8
>   [7] LC_PAPER=it_IT.UTF-8       LC_NAME=C
>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=it_IT.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> --
> ______________________________________________________
>
> Simone Giannerini
> Dipartimento di Scienze Statistiche "Paolo Fortunati"
> Universita' di Bologna
> Via delle belle arti 41 - 40126  Bologna,  ITALY
> Tel: +39 051 2098262  Fax: +39 051 232153
> http://www2.stat.unibo.it/giannerini/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From henrik.bengtsson at gmail.com  Tue Apr  5 17:56:39 2016
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Tue, 5 Apr 2016 08:56:39 -0700
Subject: [Rd] Under Windows,
 Rgui and Rterm crash if one tries to close the graphic device while
 identify or locator are running
In-Reply-To: <5703D887.1010204@gmail.com>
References: <CANcXGixqBFipv1crwjnWre0=YykYk1VB6QVLvbf6EO1QAotHHg@mail.gmail.com>
	<5703D887.1010204@gmail.com>
Message-ID: <CAFDcVCRQHrrcFR13wAPbSxToQ4v+xGQU1tT6vsD3mu9cUavXTw@mail.gmail.com>

If of any help,

I can reproduce this (on Windows 7) back to at least R 3.0.3 but it's
not there in R 3.0.0.  (I have *not* checked with R 3.0.1 and 3.0.2
which I don't have installed).

/Henrik


On Tue, Apr 5, 2016 at 8:23 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> Thanks, I'll track this down.
>
> Duncan Murdoch
>
>
> On 05/04/2016 9:35 AM, Simone Giannerini wrote:
>>
>> minimal reproducible example
>>
>> plot(1,1)
>> identify(1,1) # or locator()
>>
>> now, trying to close the window by clicking on the cross of the upper
>> right corner causes Rgui (and Rterm) to crash.
>>
>> I see the same behaviour on 2 different Windows PC (one with Win 8.1
>> and one with Win 10).
>> I did not see the problem in linux (see below)
>>
>> WINDOWS **************
>> > sessionInfo()
>> R version 3.3.0 beta (2016-04-04 r70420)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 10 x64 (build 10586)
>>
>> locale:
>> [1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
>> [3] LC_MONETARY=Italian_Italy.1252 LC_NUMERIC=C
>> [5] LC_TIME=Italian_Italy.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> > sessionInfo()
>> R version 3.2.2 Patched (2015-09-29 r69441)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 10 x64 (build 10240)
>>
>> locale:
>> [1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
>> LC_MONETARY=Italian_Italy.1252
>> [4] LC_NUMERIC=C                   LC_TIME=Italian_Italy.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> loaded via a namespace (and not attached):
>> [1] tools_3.2.2
>>
>>
>> ** LINUX *****************************
>>
>> > sessionInfo()
>> R version 3.2.0 Patched (2015-04-21 r68221)
>> Platform: x86_64-unknown-linux-gnu (64-bit)
>> Running under: openSUSE 13.2 (Harlequin) (x86_64)
>>
>> locale:
>>   [1] LC_CTYPE=it_IT.UTF-8       LC_NUMERIC=C
>>   [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=it_IT.UTF-8
>>   [5] LC_MONETARY=it_IT.UTF-8    LC_MESSAGES=it_IT.UTF-8
>>   [7] LC_PAPER=it_IT.UTF-8       LC_NAME=C
>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=it_IT.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> --
>> ______________________________________________________
>>
>> Simone Giannerini
>> Dipartimento di Scienze Statistiche "Paolo Fortunati"
>> Universita' di Bologna
>> Via delle belle arti 41 - 40126  Bologna,  ITALY
>> Tel: +39 051 2098262  Fax: +39 051 232153
>> http://www2.stat.unibo.it/giannerini/
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Tue Apr  5 21:35:12 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 5 Apr 2016 15:35:12 -0400
Subject: [Rd] Under Windows,
 Rgui and Rterm crash if one tries to close the graphic device while
 identify or locator are running
In-Reply-To: <CAFDcVCRQHrrcFR13wAPbSxToQ4v+xGQU1tT6vsD3mu9cUavXTw@mail.gmail.com>
References: <CANcXGixqBFipv1crwjnWre0=YykYk1VB6QVLvbf6EO1QAotHHg@mail.gmail.com>
	<5703D887.1010204@gmail.com>
	<CAFDcVCRQHrrcFR13wAPbSxToQ4v+xGQU1tT6vsD3mu9cUavXTw@mail.gmail.com>
Message-ID: <57041370.7030004@gmail.com>

On 05/04/2016 11:56 AM, Henrik Bengtsson wrote:
> If of any help,
>
> I can reproduce this (on Windows 7) back to at least R 3.0.3 but it's
> not there in R 3.0.0.  (I have *not* checked with R 3.0.1 and 3.0.2
> which I don't have installed).

That doesn't necessarily mean that 3.0.0 was fine.  It's a segfault (I'd 
guess some memory being accessed after being freed), and it comes and 
goes as I add debugging print statements --- so it might have been there 
in 3.0.0 but we just got lucky and it never surfaced.

Still, it's a start, and I'll try bisecting between 3.0.0 and 3.0.3 to 
see if some change caused it, rather than just triggered it.

Duncan Murdoch

>
> /Henrik
>
>
> On Tue, Apr 5, 2016 at 8:23 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> > Thanks, I'll track this down.
> >
> > Duncan Murdoch
> >
> >
> > On 05/04/2016 9:35 AM, Simone Giannerini wrote:
> >>
> >> minimal reproducible example
> >>
> >> plot(1,1)
> >> identify(1,1) # or locator()
> >>
> >> now, trying to close the window by clicking on the cross of the upper
> >> right corner causes Rgui (and Rterm) to crash.
> >>
> >> I see the same behaviour on 2 different Windows PC (one with Win 8.1
> >> and one with Win 10).
> >> I did not see the problem in linux (see below)
> >>
> >> WINDOWS **************
> >> > sessionInfo()
> >> R version 3.3.0 beta (2016-04-04 r70420)
> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
> >> Running under: Windows 10 x64 (build 10586)
> >>
> >> locale:
> >> [1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
> >> [3] LC_MONETARY=Italian_Italy.1252 LC_NUMERIC=C
> >> [5] LC_TIME=Italian_Italy.1252
> >>
> >> attached base packages:
> >> [1] stats     graphics  grDevices utils     datasets  methods   base
> >>
> >> > sessionInfo()
> >> R version 3.2.2 Patched (2015-09-29 r69441)
> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
> >> Running under: Windows 10 x64 (build 10240)
> >>
> >> locale:
> >> [1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252
> >> LC_MONETARY=Italian_Italy.1252
> >> [4] LC_NUMERIC=C                   LC_TIME=Italian_Italy.1252
> >>
> >> attached base packages:
> >> [1] stats     graphics  grDevices utils     datasets  methods   base
> >>
> >> loaded via a namespace (and not attached):
> >> [1] tools_3.2.2
> >>
> >>
> >> ** LINUX *****************************
> >>
> >> > sessionInfo()
> >> R version 3.2.0 Patched (2015-04-21 r68221)
> >> Platform: x86_64-unknown-linux-gnu (64-bit)
> >> Running under: openSUSE 13.2 (Harlequin) (x86_64)
> >>
> >> locale:
> >>   [1] LC_CTYPE=it_IT.UTF-8       LC_NUMERIC=C
> >>   [3] LC_TIME=it_IT.UTF-8        LC_COLLATE=it_IT.UTF-8
> >>   [5] LC_MONETARY=it_IT.UTF-8    LC_MESSAGES=it_IT.UTF-8
> >>   [7] LC_PAPER=it_IT.UTF-8       LC_NAME=C
> >>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >> [11] LC_MEASUREMENT=it_IT.UTF-8 LC_IDENTIFICATION=C
> >>
> >> attached base packages:
> >> [1] stats     graphics  grDevices utils     datasets  methods   base
> >>
> >> --
> >> ______________________________________________________
> >>
> >> Simone Giannerini
> >> Dipartimento di Scienze Statistiche "Paolo Fortunati"
> >> Universita' di Bologna
> >> Via delle belle arti 41 - 40126  Bologna,  ITALY
> >> Tel: +39 051 2098262  Fax: +39 051 232153
> >> http://www2.stat.unibo.it/giannerini/
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Wed Apr  6 02:44:08 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 5 Apr 2016 20:44:08 -0400
Subject: [Rd] update.packages(checkBuilt=TRUE, ask=FALSE): possible bug
In-Reply-To: <55C3F0C7.4000306@gmail.com>
References: <CAN+Emd-n=kZCGSV6DuMPLi-UFsztywtZ3h+cVaLuPYyHFbuYaw@mail.gmail.com>
	<21FF8325-EE50-480E-9729-E0440D6587EE@gmail.com>
	<55B90580.4010207@yorku.ca> <55B91183.6000306@gmail.com>
	<CAN+Emd8f9sM-5OnWARLVxwcwVHGQrjkEATuYrp-h89DR5_c=sw@mail.gmail.com>
	<55C3F0C7.4000306@gmail.com>
Message-ID: <57045BD8.30902@gmail.com>

Jose resurrected this, and this time I reproduced it.  It's a simple bug 
to fix, just an oversight in a test in install.packages().

It'll make it into 3.3.0.

Duncan Murdoch

On 06/08/2015 7:41 PM, Duncan Murdoch wrote:
> On 06/08/2015 7:16 PM, Jose Claudio Faria wrote:
>>      I'd like to see a reproducible example before I declared it to be a
>>      bug that needs fixing.
>>
>>      Do note the news item in R-patched (soon to be R 3.2.2):
>>
>>      | - download.packages()| failed for |type| equal to either |"both"|
>>      or |"binary"|. (Reported by Dan Tenenbaum.)
>>
>>      install.packages() can call download.packages(), so this might have
>>      been fixed now.
>>
>>      Duncan Murdoch
>>
>>
>> The bug described is occurring with all recent distributions available!
>>
>> I discovery today, after install R version 3.2.2 beta (2015-08-04
>> r68843), that the bug happens when I copy my packages from old
>> distribution to the library folder (being careful not to overwrite the
>> newer ones that comes with the distribution). I've been doing this for a
>> long time.
>>
>> As are many, it would be labor-intensive (but not impossible) to find
>> those responsible for the bug. If you decide that it is necessary I can
>> go testing package by package.
>
> Without a reproducible example, I won't follow up on this.
>
> Duncan Murdoch
>


From hhoeflin at gmail.com  Wed Apr  6 12:01:59 2016
From: hhoeflin at gmail.com (Holger Hoefling)
Date: Wed, 6 Apr 2016 12:01:59 +0200
Subject: [Rd] Package manuals as html page instead of pdf
Message-ID: <CAFDswJtzrp8L-FZuHbQeT1EbuGAkLKkh+DrSPvMSyRO1BNfP9A@mail.gmail.com>

Hi,

I wanted to pose a question to the R developers that I was wondering about
for a while.

Currently, the standard way of rendering the manual of an R package on CRAN
is in the form of a pdf-file. From my perspective, this pdf-file has many
drawbacks:

- It makes the load (relatively) long
- requires at least a plug-in in a browser,
- breaks the forward-backward functionality of browser
- Does not contain reformattable text so that the monitor space cannot be
optimally used when displaying it
- Has many page breaks that require space on the monitor and need to be
skipped over
- Introduces the dependency on latex itself.

Therefore, I wanted to ask if the R core team has thought about moving away
from pdf-manuals and on to (single page) HTML manuals? I think that would
have several advantages, those being
- faster loadtimes
- could still be sent around as a single file
- Are more flexible on how the text would be displayed
- forward-backward navigation in the browser and browser full text search
would work

Of course, printing it would be slightly worse out of an HTML document than
it currently is from a pdf.

Thank you already for providing comments

Holger

	[[alternative HTML version deleted]]


From dmitri.popavenko at gmail.com  Wed Apr  6 08:42:55 2016
From: dmitri.popavenko at gmail.com (Dmitri Popavenko)
Date: Wed, 6 Apr 2016 09:42:55 +0300
Subject: [Rd] (no) circular dependency
Message-ID: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>

Hello all,

I would like to build two packages (say A and B), for two different
purposes.
Each of them need one or two functions from the other, which leads to the
problem of circular dependency.

Is there a way for package A to import a function from package B, and
package B to import a function from package A, without arriving to circular
dependency?
Other suggestions in the archive mention building a third package that both
A and B should depend on, but this seems less attractive.

I read about importFrom() into the NAMESPACE file, but I don't know how to
relate this with the information in the DESCRIPTION file (other than adding
each package to the Depends: field).

Thank you,
Dmitri

	[[alternative HTML version deleted]]


From matt.fowles at gmail.com  Tue Apr  5 17:17:30 2016
From: matt.fowles at gmail.com (Matthew Fowles Kulukundis)
Date: Tue, 5 Apr 2016 11:17:30 -0400
Subject: [Rd] [PATCH] fix CHECK_this_length in sprintf.c
Message-ID: <CAApERuYP=0VZqzi-J3cB2zmZNwxhAyR_6GLacHs4zYbjzuzkKA@mail.gmail.com>

All~

CHECK_this_length macro expands to multiple statements making it unsafe to
use in a single line `if` statement (as is happening near line 335).  This
fixes the macro using the standard `do { } while (0)` macro trick.

Matt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: r-sprintf.patch
Type: text/x-patch
Size: 758 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20160405/bbd3947a/attachment.bin>

From J.Gorecki at wit.edu.pl  Mon Apr  4 18:50:42 2016
From: J.Gorecki at wit.edu.pl (=?UTF-8?B?SmFuIEfDs3JlY2tp?=)
Date: Mon, 4 Apr 2016 17:50:42 +0100
Subject: [Rd] Suggested dependencies in context of R CMD check
In-Reply-To: <CADwqtCO+OveKTDPH9mrgqeO7JA5RM3fqkv3u1Twt4H8BfOhsDg@mail.gmail.com>
References: <CABE2sp6n5eOD4-O-kL50XT0CAo6P2K_QR+f=4A51r7drk609Gw@mail.gmail.com>
	<CABdHhvFX_24SAtgMCJ7peK6dw57LThq+gPoWKu6CFFQXgpL5yw@mail.gmail.com>
	<CADwqtCO+OveKTDPH9mrgqeO7JA5RM3fqkv3u1Twt4H8BfOhsDg@mail.gmail.com>
Message-ID: <CABE2sp4pmUffQGUxSB+hrEdJVwedcNS04eaTu8QKvzuwDUn8Lg@mail.gmail.com>

Hi Hadley and Gabriel,

What do you think about new field in DESCRIPTION?
For me it does perfect sense to have new field that lists those from
Suggested deps which are truly needed to run check. The same way as
vignetteBuilder. So couldn't be escaped with `if (requireNamespace(.))
...`, or it wouldn't make sense to test the package without them.
This field would not be needed if package author would use `if
(requireNamespace(.)) ...` for all Suggested deps used in tests.
I understand this transition would take quite a long time.

Imagine having 20 suggested deps, and only one of them used in tests.
Many of the other suggested can be tied to system level dependencies,
like databases, etc. And when you are testing rev deps you don't have
much control/knowledge over that.
Current process doesn't scale and I don't see any better way to address it.

Jan


On 4 April 2016 at 16:36, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
> Jan and Hadley,
>
> There's also the issue of tests, vignettes, or examples requiring Suggested
> packages (one of the core applications of Suggests, in fact). These are all
> checked by R CMD check, so to ensure any package which should pass check
> would do so without suggested packages installed would require turning all
> of those checks off, which takes quite a few of the teeth out of R CMD check
> (and thus the assurances granted by knowing a package passes it). AFAIK
> (without going off and checking right now) you /could/ force R CMD check to
> do this now with a combination of options, though, if that's really what you
> want (which would allow your package to pass when _R_CHECK_FORCE_SUGGESTS_
> is set to false).
>
> ~G
>
> On Mon, Apr 4, 2016 at 7:25 AM, Hadley Wickham <h.wickham at gmail.com> wrote:
>>
>> On Sat, Apr 2, 2016 at 5:33 AM, Jan G?recki <J.Gorecki at wit.edu.pl> wrote:
>> > Dear R team,
>> >
>> > Are suggested dependencies mandatory in context of `R CMD check` when
>> > using env var `_R_CHECK_FORCE_SUGGESTS_=FALSE`?
>> >
>> > Suggested dependencies are nice because are optional.
>> > But that feature often isn't valid when trying to run `R CMD check` on
>> > them.
>> > I would like to use `export _R_CHECK_FORCE_SUGGESTS_=FALSE`, which
>> > according to the comment in `tools/R/check.R`:
>> >
>> >> The suggested packages are required for a complete check.
>> >  Checking can be attempted without them by setting the environment
>> > variable _R_CHECK_FORCE_SUGGESTS_ to a false value.
>> >
>> > should be sufficient to run *check* process without installing suggested
>> > deps.
>> > If it is not true, then how to differentiate the suggested packages
>> > which are optional from those mandatory?
>> > It would be helpful to have kind of `vignetteBuilder` DESCRIPTION
>> > field called `testChecker`, so DESCRIPTION file could precisely manage
>> > packages dependencies.
>> > That way batch checking packages would be easier, as required dep
>> > metadata would be at hand in description file. Batch checking pkgs
>> > with all their suggests will simply result into testing whole CRAN.
>> >
>> > In a single package it can be handled with `if (requireNamespace(.))
>> > test_package(.)` for `testthat` and `knitr`, also with mocking up
>> > `.Rout` files.
>> >
>> > But I'm interested into canonical design of a suggested package and
>> > `_R_CHECK_FORCE_SUGGESTS_` env var.
>> > Is there any R core dev team recommendation/suggestion on that? and
>> > don't you thing new field `testChecker` in DESCRIPTION could help for
>> > batch checking pkgs? Installing all suggested packages of all reverse
>> > dependencies doesn't scale.
>>
>> In principle, I believe a package should pass R CMD check if no
>> suggested packages are installed. However, since this is not currently
>> automatically checked, many packages will fail to cleanly pass R CMD
>> check if suggested packages are missing. In my experience, it's much
>> easier to simply install all dependencies of your reverse dependencies
>> (although this is obviously much easier when you're using a platform
>> with binary packages available from CRAN). I routinely do this for
>> hundreds to thousands of packages.
>>
>> Hadley
>>
>> --
>> http://hadley.nz
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research


From thorstenr_42 at hotmail.de  Tue Apr  5 17:38:05 2016
From: thorstenr_42 at hotmail.de (Thorsten R)
Date: Tue, 5 Apr 2016 15:38:05 +0000
Subject: [Rd] Assignment operator and deep copy for calling C functions
Message-ID: <VI1PR08MB044815D26F1464F2BC630FC3899E0@VI1PR08MB0448.eurprd08.prod.outlook.com>

Hi All,

i have a problem in understanding what the assignment operator '<-'  really is doing.
If i create two numeric arrays in R and copy one into the other with '<-' and
afterwards change one array by calling a C function, both arrays are changed!

The problem I am facing can easily be seen in the following example:
(The following R code and the C function is attached and the C function can be compiled with R CMD SHLIB test.c.)

First include the c function:
    dyn.load("test.so")

Let's start with 2 arrays:
    a  <- rep(0, 5)
    b  <- rep(1, 5)

Now print the memory addresses:
    print(sprintf("a: %s    b: %s", tracemem(a), tracemem(b) ))
    [1] "a: <0x29d34e0>    b: <0x29946e0>"

oky, they are different! Now copy a into b and print again the addresses:
    b <- a
    print(sprintf("a: %s    b: %s", tracemem(a), tracemem(b) ))
    [1] "a: <0x29d34e0>    b: <0x29d34e0>"

Ugh they are the same. If I now call my C function, which writes 0,1,2,3,4 into an array of 5 doubles,
of course 'both' arrays are changed:
    .Call("test", b)
    print( cbind(a,b) )
         a b
    [1,] 0 0
    [2,] 1 1
    [3,] 2 2
    [4,] 3 3
    [5,] 4 4


If i just change one element of b instead of calling the c function, then a full copy of b is made:
    a <- rep(0, 5)
    b <- rep(1, 5)
    print(sprintf("a: %s    b: %s", tracemem(a), tracemem(b) ))
    [1] "a: <0x2994b58>    b: <0x2912ff8>"

    b <- a
    print(sprintf("a: %s    b: %s", tracemem(a), tracemem(b) ))
    [1] "a: <0x2994b58>    b: <0x2994b58>"

    b[1] <- 5
    print(sprintf("a: %s    b: %s", tracemem(a), tracemem(b) ))
    "a: <0x2994b58>    b: <0x29134d8>"

    print( cbind(a,b) )
         a b
    [1,] 0 5
    [2,] 0 0
    [3,] 0 0
    [4,] 0 0
    [5,] 0 0


So what is happening here? What is the 'right' way to ensure a deep copy before using Call?
I am currently using a for loop and copy every single element.

Thanks!

-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.c
Type: text/x-csrc
Size: 277 bytes
Desc: test.c
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20160405/12cf70a5/attachment.bin>

From plummerm at iarc.fr  Thu Apr  7 10:48:37 2016
From: plummerm at iarc.fr (Martyn Plummer)
Date: Thu, 7 Apr 2016 08:48:37 +0000
Subject: [Rd] Assignment operator and deep copy for calling C functions
In-Reply-To: <VI1PR08MB044815D26F1464F2BC630FC3899E0@VI1PR08MB0448.eurprd08.prod.outlook.com>
References: <VI1PR08MB044815D26F1464F2BC630FC3899E0@VI1PR08MB0448.eurprd08.prod.outlook.com>
Message-ID: <1460018916.26865.85.camel@iarc.fr>

This is discussed in the "Writing R Extensions" manual section?5.9.10:
Named objects and copying.

.Call does not copy its arguments and it is not safe to modify them, as
you have found, since multiple symbols may refer to the same object. If
you are going to modify an argument to .Call you should take a deep
copy with "duplicate" first, and your function should return the
modified copy.

It is probably also worth mentioning Rcpp, which provides a friendlier
interface to R than the C API. In Rcpp you use clone() to force a deep
copy.

Martyn ?


On Tue, 2016-04-05 at 15:38 +0000, Thorsten R wrote:
> Hi All,
> 
> i have a problem in understanding what the assignment operator '<-
> '??really is doing.
> If i create two numeric arrays in R and copy one into the other with
> '<-' and
> afterwards change one array by calling a C function, both arrays are
> changed!
> 
> The problem I am facing can easily be seen in the following example:
> (The following R code and the C function is attached and the C
> function can be compiled with R CMD SHLIB test.c.)
> 
> First include the c function:
> ????dyn.load("test.so")
> 
> Let's start with 2 arrays:
> ????a??<- rep(0, 5)
> ????b??<- rep(1, 5)
> 
> Now print the memory addresses:
> ????print(sprintf("a: %s????b: %s", tracemem(a), tracemem(b) ))
> ????[1] "a: <0x29d34e0>????b: <0x29946e0>"
> 
> oky, they are different! Now copy a into b and print again the
> addresses:
> ????b <- a
> ????print(sprintf("a: %s????b: %s", tracemem(a), tracemem(b) ))
> ????[1] "a: <0x29d34e0>????b: <0x29d34e0>"
> 
> Ugh they are the same. If I now call my C function, which writes
> 0,1,2,3,4 into an array of 5 doubles,
> of course 'both' arrays are changed:
> ????.Call("test", b)
> ????print( cbind(a,b) )
> ?????????a b
> ????[1,] 0 0
> ????[2,] 1 1
> ????[3,] 2 2
> ????[4,] 3 3
> ????[5,] 4 4
> 
> 
> If i just change one element of b instead of calling the c function,
> then a full copy of b is made:
> ????a <- rep(0, 5)
> ????b <- rep(1, 5)
> ????print(sprintf("a: %s????b: %s", tracemem(a), tracemem(b) ))
> ????[1] "a: <0x2994b58>????b: <0x2912ff8>"
> 
> ????b <- a
> ????print(sprintf("a: %s????b: %s", tracemem(a), tracemem(b) ))
> ????[1] "a: <0x2994b58>????b: <0x2994b58>"
> 
> ????b[1] <- 5
> ????print(sprintf("a: %s????b: %s", tracemem(a), tracemem(b) ))
> ????"a: <0x2994b58>????b: <0x29134d8>"
> 
> ????print( cbind(a,b) )
> ?????????a b
> ????[1,] 0 5
> ????[2,] 0 0
> ????[3,] 0 0
> ????[4,] 0 0
> ????[5,] 0 0
> 
> 
> So what is happening here? What is the 'right' way to ensure a deep
> copy before using Call?
> I am currently using a for loop and copy every single element.
> 
> Thanks!
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From maechler at stat.math.ethz.ch  Thu Apr  7 12:46:54 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 7 Apr 2016 12:46:54 +0200
Subject: [Rd] [PATCH] fix CHECK_this_length in sprintf.c
In-Reply-To: <CAApERuYP=0VZqzi-J3cB2zmZNwxhAyR_6GLacHs4zYbjzuzkKA@mail.gmail.com>
References: <CAApERuYP=0VZqzi-J3cB2zmZNwxhAyR_6GLacHs4zYbjzuzkKA@mail.gmail.com>
Message-ID: <22278.15006.871215.53326@stat.math.ethz.ch>

>>>>> Matthew Fowles Kulukundis <matt.fowles at gmail.com>
>>>>>     on Tue, 5 Apr 2016 11:17:30 -0400 writes:

    > All~
    > CHECK_this_length macro expands to multiple statements making it unsafe to
    > use in a single line `if` statement (as is happening near line 335).  This
    > fixes the macro using the standard `do { } while (0)` macro trick.

yes, but you forgot the closing '}' ... so you could not even
have compiled R after applying your patch.  

Also, it would be nice to contrive a minimal example where the
change makes a difference.  This  "fails" to trigger :

--------------------------------
as.double.foo <- function(x) x[FALSE]
x <- structure(3, class="foo")
as.numeric(x) # numeric(0)

sprintf("%d !", x)# "3 !"  instead of giving an error
--------------------------------

Thank you, Matt, in any case; this (with the "{" !) has now gone
into the source.

Martin

    > Matt
    > x[DELETED ATTACHMENT external: r-sprintf.patch, text/x-patch]
    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From thierry.onkelinx at inbo.be  Thu Apr  7 14:47:22 2016
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Thu, 7 Apr 2016 14:47:22 +0200
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
Message-ID: <CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>

Dear Dmitri,

If it's only a small number of functions then move them the relevant
functions for A to B so that B works without A. Then Import these functions
from B in A. Hence A depends on B but B is independent of A.

It is requires to move a lot of functions than you better create a package
C with all the common functions. Then A and B import those functions from C.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com>:

> Hello all,
>
> I would like to build two packages (say A and B), for two different
> purposes.
> Each of them need one or two functions from the other, which leads to the
> problem of circular dependency.
>
> Is there a way for package A to import a function from package B, and
> package B to import a function from package A, without arriving to circular
> dependency?
> Other suggestions in the archive mention building a third package that both
> A and B should depend on, but this seems less attractive.
>
> I read about importFrom() into the NAMESPACE file, but I don't know how to
> relate this with the information in the DESCRIPTION file (other than adding
> each package to the Depends: field).
>
> Thank you,
> Dmitri
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Thu Apr  7 17:53:42 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 7 Apr 2016 17:53:42 +0200
Subject: [Rd] [PATCH] fix CHECK_this_length in sprintf.c
In-Reply-To: <CAApERuYJ3zfLTc=H3LJkqV4Nx1U_s5=1iJE4hDH1iXbWRBaL3A@mail.gmail.com>
References: <CAApERuYP=0VZqzi-J3cB2zmZNwxhAyR_6GLacHs4zYbjzuzkKA@mail.gmail.com>
	<22278.15006.871215.53326@stat.math.ethz.ch>
	<CAApERuYJ3zfLTc=H3LJkqV4Nx1U_s5=1iJE4hDH1iXbWRBaL3A@mail.gmail.com>
Message-ID: <22278.33414.609930.108359@stat.math.ethz.ch>

>>>>> Matthew Fowles Kulukundis <matt.fowles at gmail.com>
>>>>>     on Thu, 7 Apr 2016 11:21:56 -0400 writes:

    > Martin~
    > Sorry about the bad patch.  I work on C++ at Google. We built a check for
    > clang-tidy that identifies errors of this form and discovered the error
    > here as part of our search. I am just trying to be a good citizen and
    > upstream a fix, but I must have gotten sloppy as I was doing a bunch of
    > these.

Thank you, Matt, for the extra context... indeed the sloppyness was not a
big deal..

    > Thanks for fixing it and finding the a test for it, 
    > I actually had no idea how to trigger this codepath and have never used R.

I see.  But note that you misunderstood (probably my bad
English):

I did *NOT* find a test for it (and showed a case that did not
work as test, as it does not trigger an error [remember the
macro is CHECK_..() and actually shouled produce a useful error
message in a -- yet to find -- test case.


    > If you are curious, the upstream check for clang-tidy is
    > http://reviews.llvm.org/D18766
    > You may consider running some of the other clang-tidy checks on your source
    > base, they will likely find other bugs.

Thank you!

At the moment, I'm too overloaed with other duties / todos.
But it is good, to have this available, and other R-devel
readers may want to help the R core team by finding and patching
(or at least reporting) such bugs.

Martin

    > Cheers,
    > Matt

    > On Thu, Apr 7, 2016 at 6:46 AM, Martin Maechler <maechler at stat.math.ethz.ch>
    > wrote:

    >> >>>>> Matthew Fowles Kulukundis <matt.fowles at gmail.com>
    >> >>>>>     on Tue, 5 Apr 2016 11:17:30 -0400 writes:
    >> 
    >> > All~
    >> > CHECK_this_length macro expands to multiple statements making it
    >> unsafe to
    >> > use in a single line `if` statement (as is happening near line
    >> 335).  This
    >> > fixes the macro using the standard `do { } while (0)` macro trick.
    >> 
    >> yes, but you forgot the closing '}' ... so you could not even
    >> have compiled R after applying your patch.
    >> 
    >> Also, it would be nice to contrive a minimal example where the
    >> change makes a difference.  This  "fails" to trigger :
    >> 
    >> --------------------------------
    >> as.double.foo <- function(x) x[FALSE]
    >> x <- structure(3, class="foo")
    >> as.numeric(x) # numeric(0)
    >> 
    >> sprintf("%d !", x)# "3 !"  instead of giving an error
    >> --------------------------------
    >> 
    >> Thank you, Matt, in any case; this (with the "{" !) has now gone
    >> into the source.
    >> 
    >> Martin
    >> 
    >> > Matt
    >> > x[DELETED ATTACHMENT external: r-sprintf.patch, text/x-patch]
    >> > ______________________________________________
    >> > R-devel at r-project.org mailing list
    >> > https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 

    > [[alternative HTML version deleted]]


From dmitri.popavenko at gmail.com  Thu Apr  7 22:22:57 2016
From: dmitri.popavenko at gmail.com (Dmitri Popavenko)
Date: Thu, 7 Apr 2016 23:22:57 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
Message-ID: <CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>

Hi Thierry,

Thanks for that, the trouble is functions are package specific so moving
from one package to another could be a solution, but I would rather save
that as a last resort.

As mentioned, creating a package C with all the common functions could also
be an option, but this strategy quickly inflates the number of packages on
CRAN. If no other option is possible, that could be the way but I was still
thinking about a more direct solution if possible.

Best,
Dmitri

On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <thierry.onkelinx at inbo.be>
wrote:

> Dear Dmitri,
>
> If it's only a small number of functions then move them the relevant
> functions for A to B so that B works without A. Then Import these functions
> from B in A. Hence A depends on B but B is independent of A.
>
> It is requires to move a lot of functions than you better create a package
> C with all the common functions. Then A and B import those functions from C.
>
> Best regards,
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
> Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
>
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com>:
>
>> Hello all,
>>
>> I would like to build two packages (say A and B), for two different
>> purposes.
>> Each of them need one or two functions from the other, which leads to the
>> problem of circular dependency.
>>
>> Is there a way for package A to import a function from package B, and
>> package B to import a function from package A, without arriving to
>> circular
>> dependency?
>> Other suggestions in the archive mention building a third package that
>> both
>> A and B should depend on, but this seems less attractive.
>>
>> I read about importFrom() into the NAMESPACE file, but I don't know how to
>> relate this with the information in the DESCRIPTION file (other than
>> adding
>> each package to the Depends: field).
>>
>> Thank you,
>> Dmitri
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Thu Apr  7 22:30:58 2016
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Thu, 7 Apr 2016 23:30:58 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
Message-ID: <CAJ=0CtB45b+aLoOb22wcVUzJn0oOcAmg2_8B87-PcW4xjKOc7Q@mail.gmail.com>

Hi Dmitri,

I was thinking about something similar for my packages. There might be
other (more clever) ways, but one way is to:
- make package A dependent on package B (so that the namespace of B is
automatically available when loading package A)
- make package B "Suggest" package A (not "Depend" which leads to circular
dependency), and that if I am not mistaken will lead to automatically
install package A when package B is installed
- use requireNamespace("A") inside the function(s) of package B which uses
functions of package A
- directly use A::foo() inside those functions

Didn't try this yet, but in theory it should work (I might try this
approach myself actually). I would also be curious if there are more clever
ways to deal with this.

I hope it helps,
Adrian

On Thu, Apr 7, 2016 at 11:22 PM, Dmitri Popavenko <
dmitri.popavenko at gmail.com> wrote:

> Hi Thierry,
>
> Thanks for that, the trouble is functions are package specific so moving
> from one package to another could be a solution, but I would rather save
> that as a last resort.
>
> As mentioned, creating a package C with all the common functions could also
> be an option, but this strategy quickly inflates the number of packages on
> CRAN. If no other option is possible, that could be the way but I was still
> thinking about a more direct solution if possible.
>
> Best,
> Dmitri
>
> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <thierry.onkelinx at inbo.be
> >
> wrote:
>
> > Dear Dmitri,
> >
> > If it's only a small number of functions then move them the relevant
> > functions for A to B so that B works without A. Then Import these
> functions
> > from B in A. Hence A depends on B but B is independent of A.
> >
> > It is requires to move a lot of functions than you better create a
> package
> > C with all the common functions. Then A and B import those functions
> from C.
> >
> > Best regards,
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and
> > Forest
> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> > Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> >
> > To call in the statistician after the experiment is done may be no more
> > than asking him to perform a post-mortem examination: he may be able to
> say
> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
> > The plural of anecdote is not data. ~ Roger Brinner
> > The combination of some data and an aching desire for an answer does not
> > ensure that a reasonable answer can be extracted from a given body of
> data.
> > ~ John Tukey
> >
> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com>:
> >
> >> Hello all,
> >>
> >> I would like to build two packages (say A and B), for two different
> >> purposes.
> >> Each of them need one or two functions from the other, which leads to
> the
> >> problem of circular dependency.
> >>
> >> Is there a way for package A to import a function from package B, and
> >> package B to import a function from package A, without arriving to
> >> circular
> >> dependency?
> >> Other suggestions in the archive mention building a third package that
> >> both
> >> A and B should depend on, but this seems less attractive.
> >>
> >> I read about importFrom() into the NAMESPACE file, but I don't know how
> to
> >> relate this with the information in the DESCRIPTION file (other than
> >> adding
> >> each package to the Depends: field).
> >>
> >> Thank you,
> >> Dmitri
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From mark.vanderloo at gmail.com  Thu Apr  7 22:36:50 2016
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Thu, 07 Apr 2016 20:36:50 +0000
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
Message-ID: <CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>

At the risk of stating the over-obvious: there's also the option of
creating just a single package containing all functions. None of the
functions that create the interdependencies need to be exported that way.

Btw, his question is probably better at home at the r-package-devel list.


Best,

M




On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <dmitri.popavenko at gmail.com>
wrote:

> Hi Thierry,
>
> Thanks for that, the trouble is functions are package specific so moving
> from one package to another could be a solution, but I would rather save
> that as a last resort.
>
> As mentioned, creating a package C with all the common functions could also
> be an option, but this strategy quickly inflates the number of packages on
> CRAN. If no other option is possible, that could be the way but I was still
> thinking about a more direct solution if possible.
>
> Best,
> Dmitri
>
> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <thierry.onkelinx at inbo.be
> >
> wrote:
>
> > Dear Dmitri,
> >
> > If it's only a small number of functions then move them the relevant
> > functions for A to B so that B works without A. Then Import these
> functions
> > from B in A. Hence A depends on B but B is independent of A.
> >
> > It is requires to move a lot of functions than you better create a
> package
> > C with all the common functions. Then A and B import those functions
> from C.
> >
> > Best regards,
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and
> > Forest
> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> > Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> >
> > To call in the statistician after the experiment is done may be no more
> > than asking him to perform a post-mortem examination: he may be able to
> say
> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
> > The plural of anecdote is not data. ~ Roger Brinner
> > The combination of some data and an aching desire for an answer does not
> > ensure that a reasonable answer can be extracted from a given body of
> data.
> > ~ John Tukey
> >
> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com>:
> >
> >> Hello all,
> >>
> >> I would like to build two packages (say A and B), for two different
> >> purposes.
> >> Each of them need one or two functions from the other, which leads to
> the
> >> problem of circular dependency.
> >>
> >> Is there a way for package A to import a function from package B, and
> >> package B to import a function from package A, without arriving to
> >> circular
> >> dependency?
> >> Other suggestions in the archive mention building a third package that
> >> both
> >> A and B should depend on, but this seems less attractive.
> >>
> >> I read about importFrom() into the NAMESPACE file, but I don't know how
> to
> >> relate this with the information in the DESCRIPTION file (other than
> >> adding
> >> each package to the Depends: field).
> >>
> >> Thank you,
> >> Dmitri
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Thu Apr  7 23:17:04 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 7 Apr 2016 14:17:04 -0700
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
Message-ID: <CAF8bMcYWpvOoBRVFkvRexnakvMZwS7D9bKW8BoGoR3mkHqp-uQ@mail.gmail.com>

> but this strategy quickly inflates the number of packages on CRAN.

CRAN contains 8210 packages today, so I would not worry about
adding an extra one.

Also, I think several small packages are preferable to one large one
because attaching a big one just to get the one or two functions you
want is also a waste.


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Apr 7, 2016 at 1:22 PM, Dmitri Popavenko <dmitri.popavenko at gmail.com
> wrote:

> Hi Thierry,
>
> Thanks for that, the trouble is functions are package specific so moving
> from one package to another could be a solution, but I would rather save
> that as a last resort.
>
> As mentioned, creating a package C with all the common functions could also
> be an option, but this strategy quickly inflates the number of packages on
> CRAN. If no other option is possible, that could be the way but I was still
> thinking about a more direct solution if possible.
>
> Best,
> Dmitri
>
> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <thierry.onkelinx at inbo.be
> >
> wrote:
>
> > Dear Dmitri,
> >
> > If it's only a small number of functions then move them the relevant
> > functions for A to B so that B works without A. Then Import these
> functions
> > from B in A. Hence A depends on B but B is independent of A.
> >
> > It is requires to move a lot of functions than you better create a
> package
> > C with all the common functions. Then A and B import those functions
> from C.
> >
> > Best regards,
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and
> > Forest
> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> > Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> >
> > To call in the statistician after the experiment is done may be no more
> > than asking him to perform a post-mortem examination: he may be able to
> say
> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
> > The plural of anecdote is not data. ~ Roger Brinner
> > The combination of some data and an aching desire for an answer does not
> > ensure that a reasonable answer can be extracted from a given body of
> data.
> > ~ John Tukey
> >
> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com>:
> >
> >> Hello all,
> >>
> >> I would like to build two packages (say A and B), for two different
> >> purposes.
> >> Each of them need one or two functions from the other, which leads to
> the
> >> problem of circular dependency.
> >>
> >> Is there a way for package A to import a function from package B, and
> >> package B to import a function from package A, without arriving to
> >> circular
> >> dependency?
> >> Other suggestions in the archive mention building a third package that
> >> both
> >> A and B should depend on, but this seems less attractive.
> >>
> >> I read about importFrom() into the NAMESPACE file, but I don't know how
> to
> >> relate this with the information in the DESCRIPTION file (other than
> >> adding
> >> each package to the Depends: field).
> >>
> >> Thank you,
> >> Dmitri
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From dmitri.popavenko at gmail.com  Fri Apr  8 00:15:34 2016
From: dmitri.popavenko at gmail.com (Dmitri Popavenko)
Date: Fri, 8 Apr 2016 01:15:34 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAF8bMcYWpvOoBRVFkvRexnakvMZwS7D9bKW8BoGoR3mkHqp-uQ@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAF8bMcYWpvOoBRVFkvRexnakvMZwS7D9bKW8BoGoR3mkHqp-uQ@mail.gmail.com>
Message-ID: <CAJL_pojRML2P5erDgH93XbSce6rRCQzHGUDr0WiqPGf75nMW6A@mail.gmail.com>

Hi all,

Oh right, I wasn't aware there is an r-package-devel list (probably better
suited for this question).
So I'm getting all sorts of advice, to create a big package and also better
to have multiple smaller ones. Sure, all of those are possible, just less
attractive. Adrian's suggestion might work (thanks), will have to see.

Best,
Dmitri

On Fri, Apr 8, 2016 at 12:17 AM, William Dunlap <wdunlap at tibco.com> wrote:

> > but this strategy quickly inflates the number of packages on CRAN.
>
> CRAN contains 8210 packages today, so I would not worry about
> adding an extra one.
>
> Also, I think several small packages are preferable to one large one
> because attaching a big one just to get the one or two functions you
> want is also a waste.
>
>
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
>
> On Thu, Apr 7, 2016 at 1:22 PM, Dmitri Popavenko <
> dmitri.popavenko at gmail.com> wrote:
>
>> Hi Thierry,
>>
>> Thanks for that, the trouble is functions are package specific so moving
>> from one package to another could be a solution, but I would rather save
>> that as a last resort.
>>
>> As mentioned, creating a package C with all the common functions could
>> also
>> be an option, but this strategy quickly inflates the number of packages on
>> CRAN. If no other option is possible, that could be the way but I was
>> still
>> thinking about a more direct solution if possible.
>>
>> Best,
>> Dmitri
>>
>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>> thierry.onkelinx at inbo.be>
>> wrote:
>>
>> > Dear Dmitri,
>> >
>> > If it's only a small number of functions then move them the relevant
>> > functions for A to B so that B works without A. Then Import these
>> functions
>> > from B in A. Hence A depends on B but B is independent of A.
>> >
>> > It is requires to move a lot of functions than you better create a
>> package
>> > C with all the common functions. Then A and B import those functions
>> from C.
>> >
>> > Best regards,
>> >
>> > ir. Thierry Onkelinx
>> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>> and
>> > Forest
>> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>> > Kliniekstraat 25
>> > 1070 Anderlecht
>> > Belgium
>> >
>> > To call in the statistician after the experiment is done may be no more
>> > than asking him to perform a post-mortem examination: he may be able to
>> say
>> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
>> > The plural of anecdote is not data. ~ Roger Brinner
>> > The combination of some data and an aching desire for an answer does not
>> > ensure that a reasonable answer can be extracted from a given body of
>> data.
>> > ~ John Tukey
>> >
>> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com
>> >:
>> >
>> >> Hello all,
>> >>
>> >> I would like to build two packages (say A and B), for two different
>> >> purposes.
>> >> Each of them need one or two functions from the other, which leads to
>> the
>> >> problem of circular dependency.
>> >>
>> >> Is there a way for package A to import a function from package B, and
>> >> package B to import a function from package A, without arriving to
>> >> circular
>> >> dependency?
>> >> Other suggestions in the archive mention building a third package that
>> >> both
>> >> A and B should depend on, but this seems less attractive.
>> >>
>> >> I read about importFrom() into the NAMESPACE file, but I don't know
>> how to
>> >> relate this with the information in the DESCRIPTION file (other than
>> >> adding
>> >> each package to the Depends: field).
>> >>
>> >> Thank you,
>> >> Dmitri
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> ______________________________________________
>> >> R-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >>
>> >
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>

	[[alternative HTML version deleted]]


From matt.fowles at gmail.com  Thu Apr  7 17:21:56 2016
From: matt.fowles at gmail.com (Matthew Fowles Kulukundis)
Date: Thu, 7 Apr 2016 11:21:56 -0400
Subject: [Rd] [PATCH] fix CHECK_this_length in sprintf.c
In-Reply-To: <22278.15006.871215.53326@stat.math.ethz.ch>
References: <CAApERuYP=0VZqzi-J3cB2zmZNwxhAyR_6GLacHs4zYbjzuzkKA@mail.gmail.com>
	<22278.15006.871215.53326@stat.math.ethz.ch>
Message-ID: <CAApERuYJ3zfLTc=H3LJkqV4Nx1U_s5=1iJE4hDH1iXbWRBaL3A@mail.gmail.com>

Martin~

Sorry about the bad patch.  I work on C++ at Google. We built a check for
clang-tidy that identifies errors of this form and discovered the error
here as part of our search. I am just trying to be a good citizen and
upstream a fix, but I must have gotten sloppy as I was doing a bunch of
these.

Thanks for fixing it and finding the a test for it, I actually had no idea
how to trigger this codepath and have never used R.

If you are curious, the upstream check for clang-tidy is
http://reviews.llvm.org/D18766
You may consider running some of the other clang-tidy checks on your source
base, they will likely find other bugs.

Cheers,
Matt

On Thu, Apr 7, 2016 at 6:46 AM, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Matthew Fowles Kulukundis <matt.fowles at gmail.com>
> >>>>>     on Tue, 5 Apr 2016 11:17:30 -0400 writes:
>
>     > All~
>     > CHECK_this_length macro expands to multiple statements making it
> unsafe to
>     > use in a single line `if` statement (as is happening near line
> 335).  This
>     > fixes the macro using the standard `do { } while (0)` macro trick.
>
> yes, but you forgot the closing '}' ... so you could not even
> have compiled R after applying your patch.
>
> Also, it would be nice to contrive a minimal example where the
> change makes a difference.  This  "fails" to trigger :
>
> --------------------------------
> as.double.foo <- function(x) x[FALSE]
> x <- structure(3, class="foo")
> as.numeric(x) # numeric(0)
>
> sprintf("%d !", x)# "3 !"  instead of giving an error
> --------------------------------
>
> Thank you, Matt, in any case; this (with the "{" !) has now gone
> into the source.
>
> Martin
>
>     > Matt
>     > x[DELETED ATTACHMENT external: r-sprintf.patch, text/x-patch]
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Fri Apr  8 13:59:28 2016
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Fri, 8 Apr 2016 14:59:28 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
Message-ID: <CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>

Hi Mark,

Uhm... sometimes this is not always possible.
For example I have a package QCA which produces truth tables (all
combinations of presence / absence of causal conditions), and it uses the
venn package to draw a Venn diagram.
It is debatable if one should assimilate the "venn" package into the QCA
package (other people might want Venn diagrams but not necessarily the
other QCA functions).

On the other hand, the package venn would like to use the QCA package to
demonstrate its abilities to plot Venn diagrams based on truth tables
produced by the QCA package. Both have very different purposes, yet both
use functions from each other.

So I'm with Bill Dunlap here that several smaller packages are preferable
to one larger one, but on the other hand I can't separate those functions
into a third package: the truth table production is very specific to the
QCA package, while plotting Venn diagrams is very specific to the venn
package. I don't see how to separate those functions from their main
packages and create a third one that each would depend on.

This is just an example, there could be others as well, reason for which I
am (still) looking for a solution to:
- preserve the current functionalities in packages A and B (to follow
Dmitri's original post)
- be able to use functions from each other
- yet avoid circular dependency

I hope this explains it,
Adrian


On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <mark.vanderloo at gmail.com>
wrote:

> At the risk of stating the over-obvious: there's also the option of
> creating just a single package containing all functions. None of the
> functions that create the interdependencies need to be exported that way.
>
> Btw, his question is probably better at home at the r-package-devel list.
>
>
> Best,
>
> M
>
>
>
>
> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <dmitri.popavenko at gmail.com>
> wrote:
>
>> Hi Thierry,
>>
>> Thanks for that, the trouble is functions are package specific so moving
>> from one package to another could be a solution, but I would rather save
>> that as a last resort.
>>
>> As mentioned, creating a package C with all the common functions could
>> also
>> be an option, but this strategy quickly inflates the number of packages on
>> CRAN. If no other option is possible, that could be the way but I was
>> still
>> thinking about a more direct solution if possible.
>>
>> Best,
>> Dmitri
>>
>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>> thierry.onkelinx at inbo.be>
>> wrote:
>>
>> > Dear Dmitri,
>> >
>> > If it's only a small number of functions then move them the relevant
>> > functions for A to B so that B works without A. Then Import these
>> functions
>> > from B in A. Hence A depends on B but B is independent of A.
>> >
>> > It is requires to move a lot of functions than you better create a
>> package
>> > C with all the common functions. Then A and B import those functions
>> from C.
>> >
>> > Best regards,
>> >
>> > ir. Thierry Onkelinx
>> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>> and
>> > Forest
>> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>> > Kliniekstraat 25
>> > 1070 Anderlecht
>> > Belgium
>> >
>> > To call in the statistician after the experiment is done may be no more
>> > than asking him to perform a post-mortem examination: he may be able to
>> say
>> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
>> > The plural of anecdote is not data. ~ Roger Brinner
>> > The combination of some data and an aching desire for an answer does not
>> > ensure that a reasonable answer can be extracted from a given body of
>> data.
>> > ~ John Tukey
>> >
>> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com
>> >:
>> >
>> >> Hello all,
>> >>
>> >> I would like to build two packages (say A and B), for two different
>> >> purposes.
>> >> Each of them need one or two functions from the other, which leads to
>> the
>> >> problem of circular dependency.
>> >>
>> >> Is there a way for package A to import a function from package B, and
>> >> package B to import a function from package A, without arriving to
>> >> circular
>> >> dependency?
>> >> Other suggestions in the archive mention building a third package that
>> >> both
>> >> A and B should depend on, but this seems less attractive.
>> >>
>> >> I read about importFrom() into the NAMESPACE file, but I don't know
>> how to
>> >> relate this with the information in the DESCRIPTION file (other than
>> >> adding
>> >> each package to the Depends: field).
>> >>
>> >> Thank you,
>> >> Dmitri
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> ______________________________________________
>> >> R-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >>
>> >
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From mark.vanderloo at gmail.com  Fri Apr  8 14:03:32 2016
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Fri, 08 Apr 2016 12:03:32 +0000
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
Message-ID: <CAOKDuOg93kDmgjMTPwanWgyqeUk1CESQ3dYK_QiC+FEOx8w0MA@mail.gmail.com>

Well, I'm not saying that Dmitri _should_ do it. I merely mention it as an
option that I think is worth thinking about -- it is easy to overlook the
obvious :-). Since we have no further info on the package's structure we
can't be sure..




Op vr 8 apr. 2016 om 13:59 schreef Adrian Du?a <dusa.adrian at unibuc.ro>:

> Hi Mark,
>
> Uhm... sometimes this is not always possible.
> For example I have a package QCA which produces truth tables (all
> combinations of presence / absence of causal conditions), and it uses the
> venn package to draw a Venn diagram.
> It is debatable if one should assimilate the "venn" package into the QCA
> package (other people might want Venn diagrams but not necessarily the
> other QCA functions).
>
> On the other hand, the package venn would like to use the QCA package to
> demonstrate its abilities to plot Venn diagrams based on truth tables
> produced by the QCA package. Both have very different purposes, yet both
> use functions from each other.
>
> So I'm with Bill Dunlap here that several smaller packages are preferable
> to one larger one, but on the other hand I can't separate those functions
> into a third package: the truth table production is very specific to the
> QCA package, while plotting Venn diagrams is very specific to the venn
> package. I don't see how to separate those functions from their main
> packages and create a third one that each would depend on.
>
> This is just an example, there could be others as well, reason for which I
> am (still) looking for a solution to:
> - preserve the current functionalities in packages A and B (to follow
> Dmitri's original post)
> - be able to use functions from each other
> - yet avoid circular dependency
>
> I hope this explains it,
> Adrian
>
>
> On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <
> mark.vanderloo at gmail.com> wrote:
>
>> At the risk of stating the over-obvious: there's also the option of
>> creating just a single package containing all functions. None of the
>> functions that create the interdependencies need to be exported that way.
>>
>> Btw, his question is probably better at home at the r-package-devel list.
>>
>>
>> Best,
>>
>> M
>>
>>
>>
>>
>> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <dmitri.popavenko at gmail.com>
>> wrote:
>>
>>> Hi Thierry,
>>>
>>> Thanks for that, the trouble is functions are package specific so moving
>>> from one package to another could be a solution, but I would rather save
>>> that as a last resort.
>>>
>>> As mentioned, creating a package C with all the common functions could
>>> also
>>> be an option, but this strategy quickly inflates the number of packages
>>> on
>>> CRAN. If no other option is possible, that could be the way but I was
>>> still
>>> thinking about a more direct solution if possible.
>>>
>>> Best,
>>> Dmitri
>>>
>>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>>> thierry.onkelinx at inbo.be>
>>> wrote:
>>>
>>> > Dear Dmitri,
>>> >
>>> > If it's only a small number of functions then move them the relevant
>>> > functions for A to B so that B works without A. Then Import these
>>> functions
>>> > from B in A. Hence A depends on B but B is independent of A.
>>> >
>>> > It is requires to move a lot of functions than you better create a
>>> package
>>> > C with all the common functions. Then A and B import those functions
>>> from C.
>>> >
>>> > Best regards,
>>> >
>>> > ir. Thierry Onkelinx
>>> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>>> and
>>> > Forest
>>> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>>> > Kliniekstraat 25
>>> > 1070 Anderlecht
>>> > Belgium
>>> >
>>> > To call in the statistician after the experiment is done may be no more
>>> > than asking him to perform a post-mortem examination: he may be able
>>> to say
>>> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
>>> > The plural of anecdote is not data. ~ Roger Brinner
>>> > The combination of some data and an aching desire for an answer does
>>> not
>>> > ensure that a reasonable answer can be extracted from a given body of
>>> data.
>>> > ~ John Tukey
>>> >
>>> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com
>>> >:
>>> >
>>> >> Hello all,
>>> >>
>>> >> I would like to build two packages (say A and B), for two different
>>> >> purposes.
>>> >> Each of them need one or two functions from the other, which leads to
>>> the
>>> >> problem of circular dependency.
>>> >>
>>> >> Is there a way for package A to import a function from package B, and
>>> >> package B to import a function from package A, without arriving to
>>> >> circular
>>> >> dependency?
>>> >> Other suggestions in the archive mention building a third package that
>>> >> both
>>> >> A and B should depend on, but this seems less attractive.
>>> >>
>>> >> I read about importFrom() into the NAMESPACE file, but I don't know
>>> how to
>>> >> relate this with the information in the DESCRIPTION file (other than
>>> >> adding
>>> >> each package to the Depends: field).
>>> >>
>>> >> Thank you,
>>> >> Dmitri
>>> >>
>>> >>         [[alternative HTML version deleted]]
>>> >>
>>> >> ______________________________________________
>>> >> R-devel at r-project.org mailing list
>>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> >>
>>> >
>>> >
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>
>
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr.90
> 050663 Bucharest sector 5
> Romania
>

	[[alternative HTML version deleted]]


From dmitri.popavenko at gmail.com  Fri Apr  8 16:36:10 2016
From: dmitri.popavenko at gmail.com (Dmitri Popavenko)
Date: Fri, 8 Apr 2016 17:36:10 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAOKDuOg93kDmgjMTPwanWgyqeUk1CESQ3dYK_QiC+FEOx8w0MA@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
	<CAOKDuOg93kDmgjMTPwanWgyqeUk1CESQ3dYK_QiC+FEOx8w0MA@mail.gmail.com>
Message-ID: <CAJL_pojJDwU9-e3faZTgQ2BpRAoB1MhzAVZ_7Tz4vYJ7bXkKqA@mail.gmail.com>

Thanks all, I don't know either (for the moment).
It's all in the design phase still. Generally, I would also like to keep
specific functions in specific packages, if at all possible.

On Fri, Apr 8, 2016 at 3:03 PM, Mark van der Loo <mark.vanderloo at gmail.com>
wrote:

> Well, I'm not saying that Dmitri _should_ do it. I merely mention it as an
> option that I think is worth thinking about -- it is easy to overlook the
> obvious :-). Since we have no further info on the package's structure we
> can't be sure..
>
>
>
>
> Op vr 8 apr. 2016 om 13:59 schreef Adrian Du?a <dusa.adrian at unibuc.ro>:
>
>> Hi Mark,
>>
>> Uhm... sometimes this is not always possible.
>> For example I have a package QCA which produces truth tables (all
>> combinations of presence / absence of causal conditions), and it uses the
>> venn package to draw a Venn diagram.
>> It is debatable if one should assimilate the "venn" package into the QCA
>> package (other people might want Venn diagrams but not necessarily the
>> other QCA functions).
>>
>> On the other hand, the package venn would like to use the QCA package to
>> demonstrate its abilities to plot Venn diagrams based on truth tables
>> produced by the QCA package. Both have very different purposes, yet both
>> use functions from each other.
>>
>> So I'm with Bill Dunlap here that several smaller packages are preferable
>> to one larger one, but on the other hand I can't separate those functions
>> into a third package: the truth table production is very specific to the
>> QCA package, while plotting Venn diagrams is very specific to the venn
>> package. I don't see how to separate those functions from their main
>> packages and create a third one that each would depend on.
>>
>> This is just an example, there could be others as well, reason for which
>> I am (still) looking for a solution to:
>> - preserve the current functionalities in packages A and B (to follow
>> Dmitri's original post)
>> - be able to use functions from each other
>> - yet avoid circular dependency
>>
>> I hope this explains it,
>> Adrian
>>
>>
>> On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <
>> mark.vanderloo at gmail.com> wrote:
>>
>>> At the risk of stating the over-obvious: there's also the option of
>>> creating just a single package containing all functions. None of the
>>> functions that create the interdependencies need to be exported that way.
>>>
>>> Btw, his question is probably better at home at the r-package-devel list.
>>>
>>>
>>> Best,
>>>
>>> M
>>>
>>>
>>>
>>>
>>> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <dmitri.popavenko at gmail.com>
>>> wrote:
>>>
>>>> Hi Thierry,
>>>>
>>>> Thanks for that, the trouble is functions are package specific so moving
>>>> from one package to another could be a solution, but I would rather save
>>>> that as a last resort.
>>>>
>>>> As mentioned, creating a package C with all the common functions could
>>>> also
>>>> be an option, but this strategy quickly inflates the number of packages
>>>> on
>>>> CRAN. If no other option is possible, that could be the way but I was
>>>> still
>>>> thinking about a more direct solution if possible.
>>>>
>>>> Best,
>>>> Dmitri
>>>>
>>>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>>>> thierry.onkelinx at inbo.be>
>>>> wrote:
>>>>
>>>> > Dear Dmitri,
>>>> >
>>>> > If it's only a small number of functions then move them the relevant
>>>> > functions for A to B so that B works without A. Then Import these
>>>> functions
>>>> > from B in A. Hence A depends on B but B is independent of A.
>>>> >
>>>> > It is requires to move a lot of functions than you better create a
>>>> package
>>>> > C with all the common functions. Then A and B import those functions
>>>> from C.
>>>> >
>>>> > Best regards,
>>>> >
>>>> > ir. Thierry Onkelinx
>>>> > Instituut voor natuur- en bosonderzoek / Research Institute for
>>>> Nature and
>>>> > Forest
>>>> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>>>> > Kliniekstraat 25
>>>> > 1070 Anderlecht
>>>> > Belgium
>>>> >
>>>> > To call in the statistician after the experiment is done may be no
>>>> more
>>>> > than asking him to perform a post-mortem examination: he may be able
>>>> to say
>>>> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
>>>> > The plural of anecdote is not data. ~ Roger Brinner
>>>> > The combination of some data and an aching desire for an answer does
>>>> not
>>>> > ensure that a reasonable answer can be extracted from a given body of
>>>> data.
>>>> > ~ John Tukey
>>>> >
>>>> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <
>>>> dmitri.popavenko at gmail.com>:
>>>> >
>>>> >> Hello all,
>>>> >>
>>>> >> I would like to build two packages (say A and B), for two different
>>>> >> purposes.
>>>> >> Each of them need one or two functions from the other, which leads
>>>> to the
>>>> >> problem of circular dependency.
>>>> >>
>>>> >> Is there a way for package A to import a function from package B, and
>>>> >> package B to import a function from package A, without arriving to
>>>> >> circular
>>>> >> dependency?
>>>> >> Other suggestions in the archive mention building a third package
>>>> that
>>>> >> both
>>>> >> A and B should depend on, but this seems less attractive.
>>>> >>
>>>> >> I read about importFrom() into the NAMESPACE file, but I don't know
>>>> how to
>>>> >> relate this with the information in the DESCRIPTION file (other than
>>>> >> adding
>>>> >> each package to the Depends: field).
>>>> >>
>>>> >> Thank you,
>>>> >> Dmitri
>>>> >>
>>>> >>         [[alternative HTML version deleted]]
>>>> >>
>>>> >> ______________________________________________
>>>> >> R-devel at r-project.org mailing list
>>>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> >>
>>>> >
>>>> >
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>
>>
>> --
>> Adrian Dusa
>> University of Bucharest
>> Romanian Social Data Archive
>> Soseaua Panduri nr.90
>> 050663 Bucharest sector 5
>> Romania
>>
>

	[[alternative HTML version deleted]]


From gmbecker at ucdavis.edu  Fri Apr  8 17:37:12 2016
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Fri, 8 Apr 2016 08:37:12 -0700
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJL_pojJDwU9-e3faZTgQ2BpRAoB1MhzAVZ_7Tz4vYJ7bXkKqA@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
	<CAOKDuOg93kDmgjMTPwanWgyqeUk1CESQ3dYK_QiC+FEOx8w0MA@mail.gmail.com>
	<CAJL_pojJDwU9-e3faZTgQ2BpRAoB1MhzAVZ_7Tz4vYJ7bXkKqA@mail.gmail.com>
Message-ID: <CADwqtCP9Cmo6xy1zw86=k-SZckUUM5n_0qL8HbwcG5SyRTCQrw@mail.gmail.com>

Another, perhaps slightly off the wall reframing of the 3-package
possibility:

Have packages B, a, and UserFacingA, as follows

*a* contains all the functionality in your A package that
*does not depend on B*
*B* *imports from* *a* and is essentially unchanged
*UserFacingA* *Depends* on *a* and *imports from* *B*, it implements all
functionality from your package A that *does depend on* *B*, and gets the
rest from package *a*

Users, then would only ever install or load B and UserFacingA. They
wouldn't need to care much,if at all, about package a.

~G

On Fri, Apr 8, 2016 at 7:36 AM, Dmitri Popavenko <dmitri.popavenko at gmail.com
> wrote:

> Thanks all, I don't know either (for the moment).
> It's all in the design phase still. Generally, I would also like to keep
> specific functions in specific packages, if at all possible.
>
> On Fri, Apr 8, 2016 at 3:03 PM, Mark van der Loo <mark.vanderloo at gmail.com
> >
> wrote:
>
> > Well, I'm not saying that Dmitri _should_ do it. I merely mention it as
> an
> > option that I think is worth thinking about -- it is easy to overlook the
> > obvious :-). Since we have no further info on the package's structure we
> > can't be sure..
> >
> >
> >
> >
> > Op vr 8 apr. 2016 om 13:59 schreef Adrian Du?a <dusa.adrian at unibuc.ro>:
> >
> >> Hi Mark,
> >>
> >> Uhm... sometimes this is not always possible.
> >> For example I have a package QCA which produces truth tables (all
> >> combinations of presence / absence of causal conditions), and it uses
> the
> >> venn package to draw a Venn diagram.
> >> It is debatable if one should assimilate the "venn" package into the QCA
> >> package (other people might want Venn diagrams but not necessarily the
> >> other QCA functions).
> >>
> >> On the other hand, the package venn would like to use the QCA package to
> >> demonstrate its abilities to plot Venn diagrams based on truth tables
> >> produced by the QCA package. Both have very different purposes, yet both
> >> use functions from each other.
> >>
> >> So I'm with Bill Dunlap here that several smaller packages are
> preferable
> >> to one larger one, but on the other hand I can't separate those
> functions
> >> into a third package: the truth table production is very specific to the
> >> QCA package, while plotting Venn diagrams is very specific to the venn
> >> package. I don't see how to separate those functions from their main
> >> packages and create a third one that each would depend on.
> >>
> >> This is just an example, there could be others as well, reason for which
> >> I am (still) looking for a solution to:
> >> - preserve the current functionalities in packages A and B (to follow
> >> Dmitri's original post)
> >> - be able to use functions from each other
> >> - yet avoid circular dependency
> >>
> >> I hope this explains it,
> >> Adrian
> >>
> >>
> >> On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <
> >> mark.vanderloo at gmail.com> wrote:
> >>
> >>> At the risk of stating the over-obvious: there's also the option of
> >>> creating just a single package containing all functions. None of the
> >>> functions that create the interdependencies need to be exported that
> way.
> >>>
> >>> Btw, his question is probably better at home at the r-package-devel
> list.
> >>>
> >>>
> >>> Best,
> >>>
> >>> M
> >>>
> >>>
> >>>
> >>>
> >>> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <
> dmitri.popavenko at gmail.com>
> >>> wrote:
> >>>
> >>>> Hi Thierry,
> >>>>
> >>>> Thanks for that, the trouble is functions are package specific so
> moving
> >>>> from one package to another could be a solution, but I would rather
> save
> >>>> that as a last resort.
> >>>>
> >>>> As mentioned, creating a package C with all the common functions could
> >>>> also
> >>>> be an option, but this strategy quickly inflates the number of
> packages
> >>>> on
> >>>> CRAN. If no other option is possible, that could be the way but I was
> >>>> still
> >>>> thinking about a more direct solution if possible.
> >>>>
> >>>> Best,
> >>>> Dmitri
> >>>>
> >>>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
> >>>> thierry.onkelinx at inbo.be>
> >>>> wrote:
> >>>>
> >>>> > Dear Dmitri,
> >>>> >
> >>>> > If it's only a small number of functions then move them the relevant
> >>>> > functions for A to B so that B works without A. Then Import these
> >>>> functions
> >>>> > from B in A. Hence A depends on B but B is independent of A.
> >>>> >
> >>>> > It is requires to move a lot of functions than you better create a
> >>>> package
> >>>> > C with all the common functions. Then A and B import those functions
> >>>> from C.
> >>>> >
> >>>> > Best regards,
> >>>> >
> >>>> > ir. Thierry Onkelinx
> >>>> > Instituut voor natuur- en bosonderzoek / Research Institute for
> >>>> Nature and
> >>>> > Forest
> >>>> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality
> Assurance
> >>>> > Kliniekstraat 25
> >>>> > 1070 Anderlecht
> >>>> > Belgium
> >>>> >
> >>>> > To call in the statistician after the experiment is done may be no
> >>>> more
> >>>> > than asking him to perform a post-mortem examination: he may be able
> >>>> to say
> >>>> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
> >>>> > The plural of anecdote is not data. ~ Roger Brinner
> >>>> > The combination of some data and an aching desire for an answer does
> >>>> not
> >>>> > ensure that a reasonable answer can be extracted from a given body
> of
> >>>> data.
> >>>> > ~ John Tukey
> >>>> >
> >>>> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <
> >>>> dmitri.popavenko at gmail.com>:
> >>>> >
> >>>> >> Hello all,
> >>>> >>
> >>>> >> I would like to build two packages (say A and B), for two different
> >>>> >> purposes.
> >>>> >> Each of them need one or two functions from the other, which leads
> >>>> to the
> >>>> >> problem of circular dependency.
> >>>> >>
> >>>> >> Is there a way for package A to import a function from package B,
> and
> >>>> >> package B to import a function from package A, without arriving to
> >>>> >> circular
> >>>> >> dependency?
> >>>> >> Other suggestions in the archive mention building a third package
> >>>> that
> >>>> >> both
> >>>> >> A and B should depend on, but this seems less attractive.
> >>>> >>
> >>>> >> I read about importFrom() into the NAMESPACE file, but I don't know
> >>>> how to
> >>>> >> relate this with the information in the DESCRIPTION file (other
> than
> >>>> >> adding
> >>>> >> each package to the Depends: field).
> >>>> >>
> >>>> >> Thank you,
> >>>> >> Dmitri
> >>>> >>
> >>>> >>         [[alternative HTML version deleted]]
> >>>> >>
> >>>> >> ______________________________________________
> >>>> >> R-devel at r-project.org mailing list
> >>>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>> >>
> >>>> >
> >>>> >
> >>>>
> >>>>         [[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>>
> >>>
> >>
> >>
> >> --
> >> Adrian Dusa
> >> University of Bucharest
> >> Romanian Social Data Archive
> >> Soseaua Panduri nr.90
> >> 050663 Bucharest sector 5
> >> Romania
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From suharto_anggono at yahoo.com  Fri Apr  8 18:39:47 2016
From: suharto_anggono at yahoo.com (Suharto Anggono Suharto Anggono)
Date: Fri, 8 Apr 2016 16:39:47 +0000 (UTC)
Subject: [Rd] PR# for match.arg(arg)
References: <124284635.225797.1460133587830.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <124284635.225797.1460133587830.JavaMail.yahoo@mail.yahoo.com>

In "R News", in "Changes in R 3.3.0", in "New Features", a news item is
match.arg(arg) (the one-argument case) is faster; so is sort.int(). (PR#16640)

While it was motivated by speeding up tapply, it is in a separate bug number: 16652 (https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=16652).


From greg at warnes.net  Fri Apr  8 19:04:20 2016
From: greg at warnes.net (Gregory Warnes)
Date: Fri, 8 Apr 2016 13:04:20 -0400
Subject: [Rd] (no) circular dependency
In-Reply-To: <CADwqtCP9Cmo6xy1zw86=k-SZckUUM5n_0qL8HbwcG5SyRTCQrw@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
	<CAOKDuOg93kDmgjMTPwanWgyqeUk1CESQ3dYK_QiC+FEOx8w0MA@mail.gmail.com>
	<CAJL_pojJDwU9-e3faZTgQ2BpRAoB1MhzAVZ_7Tz4vYJ7bXkKqA@mail.gmail.com>
	<CADwqtCP9Cmo6xy1zw86=k-SZckUUM5n_0qL8HbwcG5SyRTCQrw@mail.gmail.com>
Message-ID: <AE89F9A5-A0C3-4046-8A7B-617987541804@warnes.net>

A third possibility, which I use in my gtools and gdata packages, is to use soft-links to create a copy of the relevant functions from one package in the other.  I make sure these functions are *not* exported, so no conflicts are created, and the use of soft-links mean the code never gets out of sync.

-Greg

--  
Change your thoughts and you change the world.
--Dr. Norman Vincent Peale

> On Apr 8, 2016, at 11:37 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
> 
> Another, perhaps slightly off the wall reframing of the 3-package
> possibility:
> 
> Have packages B, a, and UserFacingA, as follows
> 
> *a* contains all the functionality in your A package that
> *does not depend on B*
> *B* *imports from* *a* and is essentially unchanged
> *UserFacingA* *Depends* on *a* and *imports from* *B*, it implements all
> functionality from your package A that *does depend on* *B*, and gets the
> rest from package *a*
> 
> Users, then would only ever install or load B and UserFacingA. They
> wouldn't need to care much,if at all, about package a.
> 
> ~G
> 
> On Fri, Apr 8, 2016 at 7:36 AM, Dmitri Popavenko <dmitri.popavenko at gmail.com
>> wrote:
> 
>> Thanks all, I don't know either (for the moment).
>> It's all in the design phase still. Generally, I would also like to keep
>> specific functions in specific packages, if at all possible.
>> 
>> On Fri, Apr 8, 2016 at 3:03 PM, Mark van der Loo <mark.vanderloo at gmail.com
>> wrote:
>> 
>>> Well, I'm not saying that Dmitri _should_ do it. I merely mention it as
>> an
>>> option that I think is worth thinking about -- it is easy to overlook the
>>> obvious :-). Since we have no further info on the package's structure we
>>> can't be sure..
>>> 
>>> 
>>> 
>>> 
>>> Op vr 8 apr. 2016 om 13:59 schreef Adrian Du?a <dusa.adrian at unibuc.ro>:
>>> 
>>>> Hi Mark,
>>>> 
>>>> Uhm... sometimes this is not always possible.
>>>> For example I have a package QCA which produces truth tables (all
>>>> combinations of presence / absence of causal conditions), and it uses
>> the
>>>> venn package to draw a Venn diagram.
>>>> It is debatable if one should assimilate the "venn" package into the QCA
>>>> package (other people might want Venn diagrams but not necessarily the
>>>> other QCA functions).
>>>> 
>>>> On the other hand, the package venn would like to use the QCA package to
>>>> demonstrate its abilities to plot Venn diagrams based on truth tables
>>>> produced by the QCA package. Both have very different purposes, yet both
>>>> use functions from each other.
>>>> 
>>>> So I'm with Bill Dunlap here that several smaller packages are
>> preferable
>>>> to one larger one, but on the other hand I can't separate those
>> functions
>>>> into a third package: the truth table production is very specific to the
>>>> QCA package, while plotting Venn diagrams is very specific to the venn
>>>> package. I don't see how to separate those functions from their main
>>>> packages and create a third one that each would depend on.
>>>> 
>>>> This is just an example, there could be others as well, reason for which
>>>> I am (still) looking for a solution to:
>>>> - preserve the current functionalities in packages A and B (to follow
>>>> Dmitri's original post)
>>>> - be able to use functions from each other
>>>> - yet avoid circular dependency
>>>> 
>>>> I hope this explains it,
>>>> Adrian
>>>> 
>>>> 
>>>> On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <
>>>> mark.vanderloo at gmail.com> wrote:
>>>> 
>>>>> At the risk of stating the over-obvious: there's also the option of
>>>>> creating just a single package containing all functions. None of the
>>>>> functions that create the interdependencies need to be exported that
>> way.
>>>>> 
>>>>> Btw, his question is probably better at home at the r-package-devel
>> list.
>>>>> 
>>>>> 
>>>>> Best,
>>>>> 
>>>>> M
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <
>> dmitri.popavenko at gmail.com>
>>>>> wrote:
>>>>> 
>>>>>> Hi Thierry,
>>>>>> 
>>>>>> Thanks for that, the trouble is functions are package specific so
>> moving
>>>>>> from one package to another could be a solution, but I would rather
>> save
>>>>>> that as a last resort.
>>>>>> 
>>>>>> As mentioned, creating a package C with all the common functions could
>>>>>> also
>>>>>> be an option, but this strategy quickly inflates the number of
>> packages
>>>>>> on
>>>>>> CRAN. If no other option is possible, that could be the way but I was
>>>>>> still
>>>>>> thinking about a more direct solution if possible.
>>>>>> 
>>>>>> Best,
>>>>>> Dmitri
>>>>>> 
>>>>>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>>>>>> thierry.onkelinx at inbo.be>
>>>>>> wrote:
>>>>>> 
>>>>>>> Dear Dmitri,
>>>>>>> 
>>>>>>> If it's only a small number of functions then move them the relevant
>>>>>>> functions for A to B so that B works without A. Then Import these
>>>>>> functions
>>>>>>> from B in A. Hence A depends on B but B is independent of A.
>>>>>>> 
>>>>>>> It is requires to move a lot of functions than you better create a
>>>>>> package
>>>>>>> C with all the common functions. Then A and B import those functions
>>>>>> from C.
>>>>>>> 
>>>>>>> Best regards,
>>>>>>> 
>>>>>>> ir. Thierry Onkelinx
>>>>>>> Instituut voor natuur- en bosonderzoek / Research Institute for
>>>>>> Nature and
>>>>>>> Forest
>>>>>>> team Biometrie & Kwaliteitszorg / team Biometrics & Quality
>> Assurance
>>>>>>> Kliniekstraat 25
>>>>>>> 1070 Anderlecht
>>>>>>> Belgium
>>>>>>> 
>>>>>>> To call in the statistician after the experiment is done may be no
>>>>>> more
>>>>>>> than asking him to perform a post-mortem examination: he may be able
>>>>>> to say
>>>>>>> what the experiment died of. ~ Sir Ronald Aylmer Fisher
>>>>>>> The plural of anecdote is not data. ~ Roger Brinner
>>>>>>> The combination of some data and an aching desire for an answer does
>>>>>> not
>>>>>>> ensure that a reasonable answer can be extracted from a given body
>> of
>>>>>> data.
>>>>>>> ~ John Tukey
>>>>>>> 
>>>>>>> 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <
>>>>>> dmitri.popavenko at gmail.com>:
>>>>>>> 
>>>>>>>> Hello all,
>>>>>>>> 
>>>>>>>> I would like to build two packages (say A and B), for two different
>>>>>>>> purposes.
>>>>>>>> Each of them need one or two functions from the other, which leads
>>>>>> to the
>>>>>>>> problem of circular dependency.
>>>>>>>> 
>>>>>>>> Is there a way for package A to import a function from package B,
>> and
>>>>>>>> package B to import a function from package A, without arriving to
>>>>>>>> circular
>>>>>>>> dependency?
>>>>>>>> Other suggestions in the archive mention building a third package
>>>>>> that
>>>>>>>> both
>>>>>>>> A and B should depend on, but this seems less attractive.
>>>>>>>> 
>>>>>>>> I read about importFrom() into the NAMESPACE file, but I don't know
>>>>>> how to
>>>>>>>> relate this with the information in the DESCRIPTION file (other
>> than
>>>>>>>> adding
>>>>>>>> each package to the Depends: field).
>>>>>>>> 
>>>>>>>> Thank you,
>>>>>>>> Dmitri
>>>>>>>> 
>>>>>>>>        [[alternative HTML version deleted]]
>>>>>>>> 
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>> 
>>>>>>        [[alternative HTML version deleted]]
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>>>> 
>>>> --
>>>> Adrian Dusa
>>>> University of Bucharest
>>>> Romanian Social Data Archive
>>>> Soseaua Panduri nr.90
>>>> 050663 Bucharest sector 5
>>>> Romania
>> 
>>        [[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> 
> -- 
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Fri Apr  8 19:05:47 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 8 Apr 2016 13:05:47 -0400
Subject: [Rd] Under Windows,
 Rgui and Rterm crash if one tries to close the graphic device while
 identify or locator are running
In-Reply-To: <57041370.7030004@gmail.com>
References: <CANcXGixqBFipv1crwjnWre0=YykYk1VB6QVLvbf6EO1QAotHHg@mail.gmail.com>
	<5703D887.1010204@gmail.com>
	<CAFDcVCRQHrrcFR13wAPbSxToQ4v+xGQU1tT6vsD3mu9cUavXTw@mail.gmail.com>
	<57041370.7030004@gmail.com>
Message-ID: <5707E4EB.4030108@gmail.com>

On 05/04/2016 3:35 PM, Duncan Murdoch wrote:
> On 05/04/2016 11:56 AM, Henrik Bengtsson wrote:
> > If of any help,
> >
> > I can reproduce this (on Windows 7) back to at least R 3.0.3 but it's
> > not there in R 3.0.0.  (I have *not* checked with R 3.0.1 and 3.0.2
> > which I don't have installed).
>
> That doesn't necessarily mean that 3.0.0 was fine.  It's a segfault (I'd
> guess some memory being accessed after being freed), and it comes and
> goes as I add debugging print statements --- so it might have been there
> in 3.0.0 but we just got lucky and it never surfaced.
>
> Still, it's a start, and I'll try bisecting between 3.0.0 and 3.0.3 to
> see if some change caused it, rather than just triggered it.

I've tracked this down, and I believe I have a working fix now.  The 
issue was that the bug fix for PR#14872, a similar problem on Linux, 
fixed Linux and introduced a new bug in Windows.  For future reference, 
the problem is that it is currently not safe to call error() in a 
Windows event handler.  We may try to fix that over the summer, the 
current fix just avoids doing it.

Duncan Murdoch


From dusa.adrian at unibuc.ro  Fri Apr  8 21:25:09 2016
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Fri, 8 Apr 2016 22:25:09 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <AE89F9A5-A0C3-4046-8A7B-617987541804@warnes.net>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
	<CAOKDuOg93kDmgjMTPwanWgyqeUk1CESQ3dYK_QiC+FEOx8w0MA@mail.gmail.com>
	<CAJL_pojJDwU9-e3faZTgQ2BpRAoB1MhzAVZ_7Tz4vYJ7bXkKqA@mail.gmail.com>
	<CADwqtCP9Cmo6xy1zw86=k-SZckUUM5n_0qL8HbwcG5SyRTCQrw@mail.gmail.com>
	<AE89F9A5-A0C3-4046-8A7B-617987541804@warnes.net>
Message-ID: <CAJ=0CtDGJMC7PhscyC4PBFp8_9ikFbvkiGpYECgo3T5LRJaw+A@mail.gmail.com>

Hi Greg,

That's interesting but I assume those are self-contained functions.
In my case, the truthTable() function from package QCA depends on numerous
other functions in the QCA package so I'm not sure how feasible it is to
copy everything from each package to every other package.

Best,
Adrian

On Fri, Apr 8, 2016 at 8:04 PM, Gregory Warnes <greg at warnes.net> wrote:

> A third possibility, which I use in my gtools and gdata packages, is to
> use soft-links to create a copy of the relevant functions from one package
> in the other.  I make sure these functions are *not* exported, so no
> conflicts are created, and the use of soft-links mean the code never gets
> out of sync.
>
> -Greg
>
> *--  *
> *Change your thoughts and you change the world.*
> --Dr. Norman Vincent Peale
>
> On Apr 8, 2016, at 11:37 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
>
> Another, perhaps slightly off the wall reframing of the 3-package
> possibility:
>
> Have packages B, a, and UserFacingA, as follows
>
> *a* contains all the functionality in your A package that
> *does not depend on B*
> *B* *imports from* *a* and is essentially unchanged
> *UserFacingA* *Depends* on *a* and *imports from* *B*, it implements all
> functionality from your package A that *does depend on* *B*, and gets the
> rest from package *a*
>
>
> Users, then would only ever install or load B and UserFacingA. They
> wouldn't need to care much,if at all, about package a.
>
> ~G
>
> On Fri, Apr 8, 2016 at 7:36 AM, Dmitri Popavenko <
> dmitri.popavenko at gmail.com
>
> wrote:
>
>
> Thanks all, I don't know either (for the moment).
>
> It's all in the design phase still. Generally, I would also like to keep
>
> specific functions in specific packages, if at all possible.
>
>
> On Fri, Apr 8, 2016 at 3:03 PM, Mark van der Loo <mark.vanderloo at gmail.com
>
>
> wrote:
>
>
> Well, I'm not saying that Dmitri _should_ do it. I merely mention it as
>
> an
>
> option that I think is worth thinking about -- it is easy to overlook the
>
> obvious :-). Since we have no further info on the package's structure we
>
> can't be sure..
>
>
>
>
>
> Op vr 8 apr. 2016 om 13:59 schreef Adrian Du?a <dusa.adrian at unibuc.ro>:
>
>
> Hi Mark,
>
>
> Uhm... sometimes this is not always possible.
>
> For example I have a package QCA which produces truth tables (all
>
> combinations of presence / absence of causal conditions), and it uses
>
> the
>
> venn package to draw a Venn diagram.
>
> It is debatable if one should assimilate the "venn" package into the QCA
>
> package (other people might want Venn diagrams but not necessarily the
>
> other QCA functions).
>
>
> On the other hand, the package venn would like to use the QCA package to
>
> demonstrate its abilities to plot Venn diagrams based on truth tables
>
> produced by the QCA package. Both have very different purposes, yet both
>
> use functions from each other.
>
>
> So I'm with Bill Dunlap here that several smaller packages are
>
> preferable
>
> to one larger one, but on the other hand I can't separate those
>
> functions
>
> into a third package: the truth table production is very specific to the
>
> QCA package, while plotting Venn diagrams is very specific to the venn
>
> package. I don't see how to separate those functions from their main
>
> packages and create a third one that each would depend on.
>
>
> This is just an example, there could be others as well, reason for which
>
> I am (still) looking for a solution to:
>
> - preserve the current functionalities in packages A and B (to follow
>
> Dmitri's original post)
>
> - be able to use functions from each other
>
> - yet avoid circular dependency
>
>
> I hope this explains it,
>
> Adrian
>
>
>
> On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <
>
> mark.vanderloo at gmail.com> wrote:
>
>
> At the risk of stating the over-obvious: there's also the option of
>
> creating just a single package containing all functions. None of the
>
> functions that create the interdependencies need to be exported that
>
> way.
>
>
> Btw, his question is probably better at home at the r-package-devel
>
> list.
>
>
>
> Best,
>
>
> M
>
>
>
>
>
> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <
>
> dmitri.popavenko at gmail.com>
>
> wrote:
>
>
> Hi Thierry,
>
>
> Thanks for that, the trouble is functions are package specific so
>
> moving
>
> from one package to another could be a solution, but I would rather
>
> save
>
> that as a last resort.
>
>
> As mentioned, creating a package C with all the common functions could
>
> also
>
> be an option, but this strategy quickly inflates the number of
>
> packages
>
> on
>
> CRAN. If no other option is possible, that could be the way but I was
>
> still
>
> thinking about a more direct solution if possible.
>
>
> Best,
>
> Dmitri
>
>
> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>
> thierry.onkelinx at inbo.be>
>
> wrote:
>
>
> Dear Dmitri,
>
>
> If it's only a small number of functions then move them the relevant
>
> functions for A to B so that B works without A. Then Import these
>
> functions
>
> from B in A. Hence A depends on B but B is independent of A.
>
>
> It is requires to move a lot of functions than you better create a
>
> package
>
> C with all the common functions. Then A and B import those functions
>
> from C.
>
>
> Best regards,
>
>
> ir. Thierry Onkelinx
>
> Instituut voor natuur- en bosonderzoek / Research Institute for
>
> Nature and
>
> Forest
>
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality
>
> Assurance
>
> Kliniekstraat 25
>
> 1070 Anderlecht
>
> Belgium
>
>
> To call in the statistician after the experiment is done may be no
>
> more
>
> than asking him to perform a post-mortem examination: he may be able
>
> to say
>
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data. ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does
>
> not
>
> ensure that a reasonable answer can be extracted from a given body
>
> of
>
> data.
>
> ~ John Tukey
>
>
> 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <
>
> dmitri.popavenko at gmail.com>:
>
>
> Hello all,
>
>
> I would like to build two packages (say A and B), for two different
>
> purposes.
>
> Each of them need one or two functions from the other, which leads
>
> to the
>
> problem of circular dependency.
>
>
> Is there a way for package A to import a function from package B,
>
> and
>
> package B to import a function from package A, without arriving to
>
> circular
>
> dependency?
>
> Other suggestions in the archive mention building a third package
>
> that
>
> both
>
> A and B should depend on, but this seems less attractive.
>
>
> I read about importFrom() into the NAMESPACE file, but I don't know
>
> how to
>
> relate this with the information in the DESCRIPTION file (other
>
> than
>
> adding
>
> each package to the Depends: field).
>
>
> Thank you,
>
> Dmitri
>
>
>        [[alternative HTML version deleted]]
>
>
> ______________________________________________
>
> R-devel at r-project.org mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>
>
>        [[alternative HTML version deleted]]
>
>
> ______________________________________________
>
> R-devel at r-project.org mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>
>
> --
>
> Adrian Dusa
>
> University of Bucharest
>
> Romanian Social Data Archive
>
> Soseaua Panduri nr.90
>
> 050663 Bucharest sector 5
>
> Romania
>
>
>
>
>        [[alternative HTML version deleted]]
>
>
> ______________________________________________
>
> R-devel at r-project.org mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research
>
>    [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From h.wickham at gmail.com  Fri Apr  8 21:34:48 2016
From: h.wickham at gmail.com (Hadley Wickham)
Date: Fri, 8 Apr 2016 14:34:48 -0500
Subject: [Rd] (no) circular dependency
In-Reply-To: <CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
Message-ID: <CABdHhvEtyz2f-v7=LQRHonh3h8hQS_hQ9_4E=Cve_QOT3QmmAQ@mail.gmail.com>

In that scenario, I would expect that QCA would suggest Venn and Venn
would suggest QCA. Then there's no circular dependency problem.

Hadley

On Fri, Apr 8, 2016 at 6:59 AM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:
> Hi Mark,
>
> Uhm... sometimes this is not always possible.
> For example I have a package QCA which produces truth tables (all
> combinations of presence / absence of causal conditions), and it uses the
> venn package to draw a Venn diagram.
> It is debatable if one should assimilate the "venn" package into the QCA
> package (other people might want Venn diagrams but not necessarily the
> other QCA functions).
>
> On the other hand, the package venn would like to use the QCA package to
> demonstrate its abilities to plot Venn diagrams based on truth tables
> produced by the QCA package. Both have very different purposes, yet both
> use functions from each other.
>
> So I'm with Bill Dunlap here that several smaller packages are preferable
> to one larger one, but on the other hand I can't separate those functions
> into a third package: the truth table production is very specific to the
> QCA package, while plotting Venn diagrams is very specific to the venn
> package. I don't see how to separate those functions from their main
> packages and create a third one that each would depend on.
>
> This is just an example, there could be others as well, reason for which I
> am (still) looking for a solution to:
> - preserve the current functionalities in packages A and B (to follow
> Dmitri's original post)
> - be able to use functions from each other
> - yet avoid circular dependency
>
> I hope this explains it,
> Adrian
>
>
> On Thu, Apr 7, 2016 at 11:36 PM, Mark van der Loo <mark.vanderloo at gmail.com>
> wrote:
>
>> At the risk of stating the over-obvious: there's also the option of
>> creating just a single package containing all functions. None of the
>> functions that create the interdependencies need to be exported that way.
>>
>> Btw, his question is probably better at home at the r-package-devel list.
>>
>>
>> Best,
>>
>> M
>>
>>
>>
>>
>> On Thu, Apr 7, 2016, 22:24 Dmitri Popavenko <dmitri.popavenko at gmail.com>
>> wrote:
>>
>>> Hi Thierry,
>>>
>>> Thanks for that, the trouble is functions are package specific so moving
>>> from one package to another could be a solution, but I would rather save
>>> that as a last resort.
>>>
>>> As mentioned, creating a package C with all the common functions could
>>> also
>>> be an option, but this strategy quickly inflates the number of packages on
>>> CRAN. If no other option is possible, that could be the way but I was
>>> still
>>> thinking about a more direct solution if possible.
>>>
>>> Best,
>>> Dmitri
>>>
>>> On Thu, Apr 7, 2016 at 3:47 PM, Thierry Onkelinx <
>>> thierry.onkelinx at inbo.be>
>>> wrote:
>>>
>>> > Dear Dmitri,
>>> >
>>> > If it's only a small number of functions then move them the relevant
>>> > functions for A to B so that B works without A. Then Import these
>>> functions
>>> > from B in A. Hence A depends on B but B is independent of A.
>>> >
>>> > It is requires to move a lot of functions than you better create a
>>> package
>>> > C with all the common functions. Then A and B import those functions
>>> from C.
>>> >
>>> > Best regards,
>>> >
>>> > ir. Thierry Onkelinx
>>> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>>> and
>>> > Forest
>>> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>>> > Kliniekstraat 25
>>> > 1070 Anderlecht
>>> > Belgium
>>> >
>>> > To call in the statistician after the experiment is done may be no more
>>> > than asking him to perform a post-mortem examination: he may be able to
>>> say
>>> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
>>> > The plural of anecdote is not data. ~ Roger Brinner
>>> > The combination of some data and an aching desire for an answer does not
>>> > ensure that a reasonable answer can be extracted from a given body of
>>> data.
>>> > ~ John Tukey
>>> >
>>> > 2016-04-06 8:42 GMT+02:00 Dmitri Popavenko <dmitri.popavenko at gmail.com
>>> >:
>>> >
>>> >> Hello all,
>>> >>
>>> >> I would like to build two packages (say A and B), for two different
>>> >> purposes.
>>> >> Each of them need one or two functions from the other, which leads to
>>> the
>>> >> problem of circular dependency.
>>> >>
>>> >> Is there a way for package A to import a function from package B, and
>>> >> package B to import a function from package A, without arriving to
>>> >> circular
>>> >> dependency?
>>> >> Other suggestions in the archive mention building a third package that
>>> >> both
>>> >> A and B should depend on, but this seems less attractive.
>>> >>
>>> >> I read about importFrom() into the NAMESPACE file, but I don't know
>>> how to
>>> >> relate this with the information in the DESCRIPTION file (other than
>>> >> adding
>>> >> each package to the Depends: field).
>>> >>
>>> >> Thank you,
>>> >> Dmitri
>>> >>
>>> >>         [[alternative HTML version deleted]]
>>> >>
>>> >> ______________________________________________
>>> >> R-devel at r-project.org mailing list
>>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> >>
>>> >
>>> >
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>
>
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr.90
> 050663 Bucharest sector 5
> Romania
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
http://hadley.nz


From dusa.adrian at unibuc.ro  Sat Apr  9 11:36:09 2016
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Sat, 9 Apr 2016 12:36:09 +0300
Subject: [Rd] (no) circular dependency
In-Reply-To: <CABdHhvEtyz2f-v7=LQRHonh3h8hQS_hQ9_4E=Cve_QOT3QmmAQ@mail.gmail.com>
References: <CAJL_pohRgoxg0M4kGDttQOq940riyyRrZ0Y7_w0uRHtR1b0ZOw@mail.gmail.com>
	<CAJuCY5x41vsDuHz_yeQK03W_god5ndz7GMw1H-8u379bi+RHAw@mail.gmail.com>
	<CAJL_pogb2JA1PapYYurnCQxSK1LZdwy31rmRXF4Cx71-GkEPgQ@mail.gmail.com>
	<CAOKDuOjuBTQecBj9UJ3Yo=XjkH1z2Riyb-P8Su5CfJhbCWZgEQ@mail.gmail.com>
	<CAJ=0CtB83wvrWkyVy05ZXyGfAt9hiMnU+QpD=_h7E62dUe=iPg@mail.gmail.com>
	<CABdHhvEtyz2f-v7=LQRHonh3h8hQS_hQ9_4E=Cve_QOT3QmmAQ@mail.gmail.com>
Message-ID: <CAJ=0CtC-aEHqhdGej-ER_usA1vCuDvAX6R5XO4vrpj9UgH_tJA@mail.gmail.com>

On Fri, Apr 8, 2016 at 10:34 PM, Hadley Wickham <h.wickham at gmail.com> wrote:

> In that scenario, I would expect that QCA would suggest Venn and Venn
> would suggest QCA. Then there's no circular dependency problem.
>

Right, this is exactly what I was pointing myself in the first email:

- make package A dependent on package B (so that the namespace of B is
automatically available when loading package A)
- make package B "Suggest" package A (not "Depend" which leads to circular
dependency), and that if I am not mistaken will lead to automatically
install package A when package B is installed
- use requireNamespace("A") inside the function(s) of package B which uses
functions of package A
- directly use A::foo() inside those functions

The only trouble with "Suggest" is the namespace of A is not automatically
loaded with package B (the reverse would work because package A depends on
package B).
So the only other option that I found was to make use of requireNamespace()
and use A::foo() inside the functions of B.

Or as Hadley advices, make both packages A and B suggest each other and use
requireNamespace() inside the functions of both. That would also work.

Adrian

-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From mick.jordan at oracle.com  Sat Apr  9 19:28:54 2016
From: mick.jordan at oracle.com (Mick Jordan)
Date: Sat, 9 Apr 2016 10:28:54 -0700
Subject: [Rd] Note: no visible definition
Message-ID: <57093BD6.1020509@oracle.com>

Can someone explain a message of this form from an rscript execution:

Note: no visible global function definition for 'foo'


This happens right at the start of execution. 'foo' is only executed in 
a branch of an 'if' that is not reached with the particular arguments 
passed to the script. If I source the script in a shell and run it I do 
not get the message.

Mick Jordan


	[[alternative HTML version deleted]]


From edd at debian.org  Sat Apr  9 19:54:05 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 9 Apr 2016 12:54:05 -0500
Subject: [Rd] Note: no visible definition
In-Reply-To: <57093BD6.1020509@oracle.com>
References: <57093BD6.1020509@oracle.com>
Message-ID: <22281.16829.798454.734718@max.nulle.part>


On 9 April 2016 at 10:28, Mick Jordan wrote:
| Can someone explain a message of this form from an rscript execution:
| 
| Note: no visible global function definition for 'foo'
| 
| 
| This happens right at the start of execution. 'foo' is only executed in 
| a branch of an 'if' that is not reached with the particular arguments 
| passed to the script. If I source the script in a shell and run it I do 
| not get the message.

Guess: your shell session has an object foo. It will be referenced.

Your Rscript, running from 'empty' never defines foo.  And codetools tells
you that because more often than not it is error.  Sometimes codetools gets
it wrong too, ie with you peek into data structure via evaluation tricks or
with simple with(mydataframe, columnOne).

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From mick.jordan at oracle.com  Sat Apr  9 20:55:45 2016
From: mick.jordan at oracle.com (Mick Jordan)
Date: Sat, 9 Apr 2016 11:55:45 -0700
Subject: [Rd] Note: no visible definition
In-Reply-To: <22281.16829.798454.734718@max.nulle.part>
References: <57093BD6.1020509@oracle.com>
	<22281.16829.798454.734718@max.nulle.part>
Message-ID: <57095031.5060802@oracle.com>

On 4/9/16 10:54 AM, Dirk Eddelbuettel wrote:
> On 9 April 2016 at 10:28, Mick Jordan wrote:
> | Can someone explain a message of this form from an rscript execution:
> |
> | Note: no visible global function definition for 'foo'
> |
> |
> | This happens right at the start of execution. 'foo' is only executed in
> | a branch of an 'if' that is not reached with the particular arguments
> | passed to the script. If I source the script in a shell and run it I do
> | not get the message.
>
> Guess: your shell session has an object foo. It will be referenced.
>
> Your Rscript, running from 'empty' never defines foo.  And codetools tells
> you that because more often than not it is error.  Sometimes codetools gets
> it wrong too, ie with you peek into data structure via evaluation tricks or
> with simple with(mydataframe, columnOne).
>
>
No, the symbol is acytually defined in a package that is not loaded when 
running under GnuR.  But I still don't understand what is even trying to 
find the symbol in an execution path that doesn't reference it. I'm not 
sure what you mean by codetools, but is it examining my source code 
somehow before it is executed? That would be unexpected at best.

Mick


From murdoch.duncan at gmail.com  Sat Apr  9 21:13:09 2016
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 9 Apr 2016 15:13:09 -0400
Subject: [Rd] Note: no visible definition
In-Reply-To: <57095031.5060802@oracle.com>
References: <57093BD6.1020509@oracle.com>
	<22281.16829.798454.734718@max.nulle.part>
	<57095031.5060802@oracle.com>
Message-ID: <57095445.40608@gmail.com>

On 09/04/2016 2:55 PM, Mick Jordan wrote:
> On 4/9/16 10:54 AM, Dirk Eddelbuettel wrote:
>> On 9 April 2016 at 10:28, Mick Jordan wrote:
>> | Can someone explain a message of this form from an rscript execution:
>> |
>> | Note: no visible global function definition for 'foo'
>> |
>> |
>> | This happens right at the start of execution. 'foo' is only executed in
>> | a branch of an 'if' that is not reached with the particular arguments
>> | passed to the script. If I source the script in a shell and run it I do
>> | not get the message.
>>
>> Guess: your shell session has an object foo. It will be referenced.
>>
>> Your Rscript, running from 'empty' never defines foo.  And codetools tells
>> you that because more often than not it is error.  Sometimes codetools gets
>> it wrong too, ie with you peek into data structure via evaluation tricks or
>> with simple with(mydataframe, columnOne).
>>
>>
> No, the symbol is acytually defined in a package that is not loaded when
> running under GnuR.  But I still don't understand what is even trying to
> find the symbol in an execution path that doesn't reference it. I'm not
> sure what you mean by codetools, but is it examining my source code
> somehow before it is executed? That would be unexpected at best.

That message comes from the compiler package, so presumbly you (or 
Rscript) are trying to compile something.  You can't have undefined 
references in compiled code.

Duncan Murdoch


From mick.jordan at oracle.com  Sun Apr 10 00:54:25 2016
From: mick.jordan at oracle.com (Mick Jordan)
Date: Sat, 9 Apr 2016 15:54:25 -0700
Subject: [Rd] Note: no visible definition
In-Reply-To: <57095445.40608@gmail.com>
References: <57093BD6.1020509@oracle.com>
	<22281.16829.798454.734718@max.nulle.part>
	<57095031.5060802@oracle.com> <57095445.40608@gmail.com>
Message-ID: <57098821.3030902@oracle.com>

On 4/9/16 12:13 PM, Duncan Murdoch wrote:
> On 09/04/2016 2:55 PM, Mick Jordan wrote:
>> On 4/9/16 10:54 AM, Dirk Eddelbuettel wrote:
>>> On 9 April 2016 at 10:28, Mick Jordan wrote:
>>> | Can someone explain a message of this form from an rscript execution:
>>> |
>>> | Note: no visible global function definition for 'foo'
>>> |
>>> |
>>> | This happens right at the start of execution. 'foo' is only 
>>> executed in
>>> | a branch of an 'if' that is not reached with the particular arguments
>>> | passed to the script. If I source the script in a shell and run it 
>>> I do
>>> | not get the message.
>>>
>>> Guess: your shell session has an object foo. It will be referenced.
>>>
>>> Your Rscript, running from 'empty' never defines foo.  And codetools 
>>> tells
>>> you that because more often than not it is error.  Sometimes 
>>> codetools gets
>>> it wrong too, ie with you peek into data structure via evaluation 
>>> tricks or
>>> with simple with(mydataframe, columnOne).
>>>
>>>
>> No, the symbol is acytually defined in a package that is not loaded when
>> running under GnuR.  But I still don't understand what is even trying to
>> find the symbol in an execution path that doesn't reference it. I'm not
>> sure what you mean by codetools, but is it examining my source code
>> somehow before it is executed? That would be unexpected at best.
>
> That message comes from the compiler package, so presumbly you (or 
> Rscript) are trying to compile something.  You can't have undefined 
> references in compiled code.
>
> Duncan Murdoch
>
Ah, so if the jit is enabled that would do it? we are no explicitly 
compiling anything but it turns out I was setting R_ENABLE_JIT (accidently).

Mick


From nalimilan at club.fr  Sun Apr 10 13:08:05 2016
From: nalimilan at club.fr (Milan Bouchet-Valat)
Date: Sun, 10 Apr 2016 13:08:05 +0200
Subject: [Rd] Bounds error when indexing a matrix with NA_character_
Message-ID: <1460286485.6474.11.camel@club.fr>

Hi!


I've just got a bounds error when trying to index a matrix with
NA_character_:

> y <- matrix(1:4, 2, 2, dimnames = list(A=c("a", "b"), B=c("a", "b")))
> y[NA,]
??????B
A???????a??b
? <NA> NA NA
? <NA> NA NA
> y[NA_integer_,]
?a?
?b?
NA NA?
> y[NA_character_,]
Error in y[NA_character_, ] : index out of
bounds


Yet, I would have sworn it behaves like integer NA (which apparently
isn't true since it also occurs with R 3.0). Assuming this isn't simply
a bug, what's the rationale behind this, and is it documented anywhere?
For example, ?Extract says:
> ?????When extracting, a numerical, logical or character ?NA? index
> ?????picks an unknown element and so returns ?NA? in the corresponding
> ?????element of a logical, integer, numeric, complex or character
> ?????result, and ?NULL? for a list.??(It returns ?00? for a raw
> ?????result.)

An indeed that's how it works for vectors:
> x <- c(a=1)
> x[NA_character_]
<NA>?
? NA?

The inconsistency between NA classes, and between vectors and matrices
is surprising.


Thanks for your comments.


From maechler at stat.math.ethz.ch  Mon Apr 11 09:08:47 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 11 Apr 2016 09:08:47 +0200
Subject: [Rd] Optimization bug when byte compiling with gcc 5.3.0
	on	windows
In-Reply-To: <CAF8bMcaBcy8zCiRjEBVmoghDjdos=BH-Gy2+6hCqSJrpT07ruQ@mail.gmail.com>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
	<CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
	<CAF8bMcaBcy8zCiRjEBVmoghDjdos=BH-Gy2+6hCqSJrpT07ruQ@mail.gmail.com>
Message-ID: <22283.19839.276808.98761@stat.math.ethz.ch>

>>>>> William Dunlap via R-devel <r-devel at r-project.org>
>>>>>     on Mon, 4 Apr 2016 12:26:38 -0700 writes:

    >> If I recall correctly, some eigen vectors had their
    >> direction flipped (negative values became positive and
    >> vice versa).  Did you notice anything of this kind when
    >> running 'make check' and 'make check recommended' ? It is
    >> important to us that numeric results are reproducible
    >> between versions of R.

    > I think that any code that depends on the direction of an
    > eigenvector should be considered broken.  

I agree [even though I may have fallen into that trap in some of
the regression tests I had written in the long past!].

    > It is too bad that eigen's output does not have a class so
    > that an all.equal method that know that the vector
    > direction is not relevant could be written for it

That's an interesting / neat idea.
So we could give it S3 class "eigen"  iff  only.values is not
true, which would also "solve" the slightly differently
structured result of eigen() 

Are you (or others) willing to provide a prototype for
all.equal.eigen ?

Martin

    > Bill Dunlap TIBCO Software wdunlap tibco.com

    > On Mon, Apr 4, 2016 at 11:39 AM, Jeroen Ooms
    > <jeroen.ooms at stat.ucla.edu> wrote:

    >> On Sun, Apr 3, 2016 at 6:44 PM, Ray Donnelly
    >> <rdonnelly at continuum.io> wrote: > I've started to look
    >> into building R for Windows using MSYS2 as both the >
    >> build environment and tools + libraries provider (where
    >> possible).
    >> 
    >> Thanks for your reply, and for the patches.
    >> 
    >> Last time I had a look at this (a few months ago) another
    >> problem was that mingw-w64 v4 was giving different
    >> numeric output for some of the tests in r-base. If I
    >> recall correctly, some eigen vectors had their direction
    >> flipped (negative values became positive and vice versa).
    >> Did you notice anything of this kind when running 'make
    >> check' and 'make check recommended' ? It is important to
    >> us that numeric results are reproducible between versions
    >> of R.
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 

    > 	[[alternative HTML version deleted]]

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From ravi.varadhan at jhu.edu  Mon Apr 11 14:42:35 2016
From: ravi.varadhan at jhu.edu (Ravi Varadhan)
Date: Mon, 11 Apr 2016 12:42:35 +0000
Subject: [Rd] Optimization bug when byte compiling with gcc
	5.3.0	on	windows
In-Reply-To: <22283.19839.276808.98761@stat.math.ethz.ch>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
	<CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
	<CAF8bMcaBcy8zCiRjEBVmoghDjdos=BH-Gy2+6hCqSJrpT07ruQ@mail.gmail.com>,
	<22283.19839.276808.98761@stat.math.ethz.ch>
Message-ID: <1460378536304.33286@jhu.edu>

all.equal.eigen() should also accommodate complex vectors, right?

Ravi
________________________________________
From: R-devel <r-devel-bounces at r-project.org> on behalf of Martin Maechler <maechler at stat.math.ethz.ch>
Sent: Monday, April 11, 2016 3:08 AM
To: William Dunlap
Cc: r-devel; Jeroen Ooms
Subject: Re: [Rd] Optimization bug when byte compiling with gcc 5.3.0   on      windows

>>>>> William Dunlap via R-devel <r-devel at r-project.org>
>>>>>     on Mon, 4 Apr 2016 12:26:38 -0700 writes:

    >> If I recall correctly, some eigen vectors had their
    >> direction flipped (negative values became positive and
    >> vice versa).  Did you notice anything of this kind when
    >> running 'make check' and 'make check recommended' ? It is
    >> important to us that numeric results are reproducible
    >> between versions of R.

    > I think that any code that depends on the direction of an
    > eigenvector should be considered broken.

I agree [even though I may have fallen into that trap in some of
the regression tests I had written in the long past!].

    > It is too bad that eigen's output does not have a class so
    > that an all.equal method that know that the vector
    > direction is not relevant could be written for it

That's an interesting / neat idea.
So we could give it S3 class "eigen"  iff  only.values is not
true, which would also "solve" the slightly differently
structured result of eigen()

Are you (or others) willing to provide a prototype for
all.equal.eigen ?

Martin

    > Bill Dunlap TIBCO Software wdunlap tibco.com

    > On Mon, Apr 4, 2016 at 11:39 AM, Jeroen Ooms
    > <jeroen.ooms at stat.ucla.edu> wrote:

    >> On Sun, Apr 3, 2016 at 6:44 PM, Ray Donnelly
    >> <rdonnelly at continuum.io> wrote: > I've started to look
    >> into building R for Windows using MSYS2 as both the >
    >> build environment and tools + libraries provider (where
    >> possible).
    >>
    >> Thanks for your reply, and for the patches.
    >>
    >> Last time I had a look at this (a few months ago) another
    >> problem was that mingw-w64 v4 was giving different
    >> numeric output for some of the tests in r-base. If I
    >> recall correctly, some eigen vectors had their direction
    >> flipped (negative values became positive and vice versa).
    >> Did you notice anything of this kind when running 'make
    >> check' and 'make check recommended' ? It is important to
    >> us that numeric results are reproducible between versions
    >> of R.
    >>
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>

    >   [[alternative HTML version deleted]]

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel



From maechler at stat.math.ethz.ch  Mon Apr 11 15:14:16 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 11 Apr 2016 15:14:16 +0200
Subject: [Rd] Optimization bug when byte compiling with gcc
	5.3.0	on	windows
In-Reply-To: <1460378536304.33286@jhu.edu>
References: <CAF5kcVVy6mGeQ0kQOTviR53ehOf64xQHoVGdLMKg0tzOMFDr_A@mail.gmail.com>
	<CABFfbXv4MC=Q-Crt-9Z4t-TooKqRzLSikBvxsg4fJ695zKKAug@mail.gmail.com>
	<CAF8bMcaBcy8zCiRjEBVmoghDjdos=BH-Gy2+6hCqSJrpT07ruQ@mail.gmail.com>
	<22283.19839.276808.98761@stat.math.ethz.ch>
	<1460378536304.33286@jhu.edu>
Message-ID: <22283.41768.334905.447076@stat.math.ethz.ch>

>>>>> Ravi Varadhan <ravi.varadhan at jhu.edu>
>>>>>     on Mon, 11 Apr 2016 12:42:35 +0000 writes:

    > all.equal.eigen() should also accommodate complex vectors, right?
    > Ravi

Yes, definitely.   The  ?eigen  help page does nicely mention
that in the complex the eigen vectors are even less determined,
i.e. you could multiply them by any unit length complex number
(of which only two are available in the real case:  +/- 1).

Martin

    > ________________________________________
    > From: R-devel <r-devel-bounces at r-project.org> on behalf of Martin Maechler <maechler at stat.math.ethz.ch>
    > Sent: Monday, April 11, 2016 3:08 AM
    > To: William Dunlap
    > Cc: r-devel; Jeroen Ooms
    > Subject: Re: [Rd] Optimization bug when byte compiling with gcc 5.3.0   on      windows

>>>>> William Dunlap via R-devel <r-devel at r-project.org>
>>>>>     on Mon, 4 Apr 2016 12:26:38 -0700 writes:

    >>> If I recall correctly, some eigen vectors had their
    >>> direction flipped (negative values became positive and
    >>> vice versa).  Did you notice anything of this kind when
    >>> running 'make check' and 'make check recommended' ? It is
    >>> important to us that numeric results are reproducible
    >>> between versions of R.

    >> I think that any code that depends on the direction of an
    >> eigenvector should be considered broken.

    > I agree [even though I may have fallen into that trap in some of
    > the regression tests I had written in the long past!].

    >> It is too bad that eigen's output does not have a class so
    >> that an all.equal method that know that the vector
    >> direction is not relevant could be written for it

    > That's an interesting / neat idea.
    > So we could give it S3 class "eigen"  iff  only.values is not
    > true, which would also "solve" the slightly differently
    > structured result of eigen()

    > Are you (or others) willing to provide a prototype for
    > all.equal.eigen ?

    > Martin

    >> Bill Dunlap TIBCO Software wdunlap tibco.com

    >> On Mon, Apr 4, 2016 at 11:39 AM, Jeroen Ooms
    >> <jeroen.ooms at stat.ucla.edu> wrote:

    >>> On Sun, Apr 3, 2016 at 6:44 PM, Ray Donnelly
    >>> <rdonnelly at continuum.io> wrote: > I've started to look
    >>> into building R for Windows using MSYS2 as both the >
    >>> build environment and tools + libraries provider (where
    >>> possible).
    >>> 
    >>> Thanks for your reply, and for the patches.
    >>> 
    >>> Last time I had a look at this (a few months ago) another
    >>> problem was that mingw-w64 v4 was giving different
    >>> numeric output for some of the tests in r-base. If I
    >>> recall correctly, some eigen vectors had their direction
    >>> flipped (negative values became positive and vice versa).
    >>> Did you notice anything of this kind when running 'make
    >>> check' and 'make check recommended' ? It is important to
    >>> us that numeric results are reproducible between versions
    >>> of R.


From josh.m.ulrich at gmail.com  Mon Apr 11 17:10:46 2016
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 11 Apr 2016 10:10:46 -0500
Subject: [Rd] [R-SIG-Finance] [VC++ calling R] How to create a real-time
 interactive ticking time-series chart using dygraph via RInside?
In-Reply-To: <CY1PR0201MB1818D3AEBC4F2B87B0A9C328C3940@CY1PR0201MB1818.namprd02.prod.outlook.com>
References: <CY1PR0201MB1818D3AEBC4F2B87B0A9C328C3940@CY1PR0201MB1818.namprd02.prod.outlook.com>
Message-ID: <CAPPM_gSXWwYSY+s8iwaa5G3jxM=72aGwOy3p_+aA7tidZ8qP4g@mail.gmail.com>

Please choose *one* _relevant_ mailing list.  Spamming 5 (!!!!!)
mailing lists fragments the conversation and makes things difficult
for everyone involved.

On Mon, Apr 11, 2016 at 10:03 AM, Mike Deanza <mikedeanza at outlook.com> wrote:
> Hi all,
>
>
> I am trying to figure out how to do this in R and I need your help.
>
>
> My journey started from something like the following:
>
>
> http://stackoverflow.com/questions/11365857/real-time-auto-updating-incremental-plot-in-r/1#1
>
>
> n=1000
> df=data.frame(time=1:n,y=runif(n))
> window=100
> for(i in 1:(n?\window)) {
> flush.console()
> plot(df$time,df$y,type='l',xlim=c(i,i+window))
> Sys.sleep(.09)
> }
>
>
> Then I wanted to make it nicer looking so I went to dygraph.
>
>
> And then, I would like to be able to live send tick data from within Visual C++ so I started to investigate RInside.
>
>
> Following the example code here:
>
>
> http://dirk.eddelbuettel.com/papers/useR2009RcppRInside.pdf
>
>
> I can open an RInside object in VC++, and then send some data to it, and then execute some command in it, and then get data back.
>
>
> It is really great.
>
>
> However, is there a way to have the real-time updating ticking plots to be drawn on dygraph inside RInside?
>
>
> It turns out the dygraph package tends to draw onto a browser. That makes the real-time updating pretty slow.
>
>
> Is there a way to set the dygraph to plot to a GUI window in VC++? For example, a QT or MFC GUI window?
>
>
> My working environment is Win7 64bit ,with VS 2013 and VS2015, QT 5.3 32bit.
>
>
> Could anybody please shed some lights on me?
>
>
> Thanks a lot!
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2016 | www.rinfinance.com


From neilandertal at gmail.com  Mon Apr 11 18:37:35 2016
From: neilandertal at gmail.com (Neil French Collier)
Date: Mon, 11 Apr 2016 16:37:35 +0000
Subject: [Rd] R not responding (must force quit) when saving graphic to PDF
	(bug?)
Message-ID: <CAOVghqoNkdpqtcQM6jiVSRHS2qyuavtD+jpX_9JpfVLfhEfxtA@mail.gmail.com>

Dear colleagues,

I wish to report a problem I encounter when trying to save a graphic to
file. When I produce a graphic and try to save it R becomes unresponsive
and I must force quit, and then restart R. The problem occurs when I try to
overwrite an existing graphic: for example when I made changes to the
graphic and want to save the graphic using the original file name. It only
happens when I use the menus to save files, not using script. It doesn't
happen when I save it as a new file. So, like this:

1. Make the graphic
2. Click File -> Save -> click on existing file name
3. Colour wheel appears and R is unresponsive.

Reproducible example:

x <- seq(1,10)
y <- x^2
plot(x,y, type="l") # Save as new file, all fine.

#Change plot and save as old plot file name:

plot(x,y, type="l", col=2)

# Click File -> Save
# 'Save quartz to PDF file' box opens
# Click on existing file name
# Colour wheel

Here is the sessionInfo():

R version 3.2.2 (2015-08-14)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.1 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

I'm not sure if this is worthy of reporting but I was encouraged to submit
a report. It doesn't really make a huge impact on my workflow, but it can
be annoying.

-- 
Cheers,

Neil

Neil French Collier, PhD
Faculty of Sustainability
Leuphana University L?neburg
Rotenbleicher Weg 67
21335 Lueneburg
Germany

Twitter: @foodsecbio
email: collier at leuphana.de
Google Scholar
<https://scholar.google.com.au/citations?hl=en&user=xVdc-dsAAAAJ&view_op=list_works&sortby=pubdate>
Ideas for Sustainability <https://ideas4sustainability.wordpress.com>

	[[alternative HTML version deleted]]


From whuber at embl.de  Mon Apr 11 20:41:00 2016
From: whuber at embl.de (Wolfgang Huber)
Date: Mon, 11 Apr 2016 20:41:00 +0200
Subject: [Rd] R not responding (must force quit) when saving graphic to
	PDF (bug?)
In-Reply-To: <CAOVghqoNkdpqtcQM6jiVSRHS2qyuavtD+jpX_9JpfVLfhEfxtA@mail.gmail.com>
References: <CAOVghqoNkdpqtcQM6jiVSRHS2qyuavtD+jpX_9JpfVLfhEfxtA@mail.gmail.com>
Message-ID: <72F4E33B-416F-4745-99B0-9AA6DD500261@embl.de>

Dear Neil

Have you tried with completely uninstalling your R, and reinstalling a more recent version (e.g. 3.2.4 right now).
And then the same with your operating system - OS X is currently at 10.11.4.
There is likely not much interest (or benefit) in chasing such things in obsolete versions.

And I think R-help would be the more appropriate place for this kind of question.
	Wolfgang

> On Apr 11, 2016, at 18:37 GMT+2, Neil French Collier <neilandertal at gmail.com> wrote:
> 
> Dear colleagues,
> 
> I wish to report a problem I encounter when trying to save a graphic to
> file. When I produce a graphic and try to save it R becomes unresponsive
> and I must force quit, and then restart R. The problem occurs when I try to
> overwrite an existing graphic: for example when I made changes to the
> graphic and want to save the graphic using the original file name. It only
> happens when I use the menus to save files, not using script. It doesn't
> happen when I save it as a new file. So, like this:
> 
> 1. Make the graphic
> 2. Click File -> Save -> click on existing file name
> 3. Colour wheel appears and R is unresponsive.
> 
> Reproducible example:
> 
> x <- seq(1,10)
> y <- x^2
> plot(x,y, type="l") # Save as new file, all fine.
> 
> #Change plot and save as old plot file name:
> 
> plot(x,y, type="l", col=2)
> 
> # Click File -> Save
> # 'Save quartz to PDF file' box opens
> # Click on existing file name
> # Colour wheel
> 
> Here is the sessionInfo():
> 
> R version 3.2.2 (2015-08-14)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.1 (El Capitan)
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> I'm not sure if this is worthy of reporting but I was encouraged to submit
> a report. It doesn't really make a huge impact on my workflow, but it can
> be annoying.
> 
> -- 
> Cheers,
> 
> Neil
> 
> Neil French Collier, PhD
> Faculty of Sustainability
> Leuphana University L?neburg
> Rotenbleicher Weg 67
> 21335 Lueneburg
> Germany
> 
> Twitter: @foodsecbio
> email: collier at leuphana.de
> Google Scholar
> <https://scholar.google.com.au/citations?hl=en&user=xVdc-dsAAAAJ&view_op=list_works&sortby=pubdate>
> Ideas for Sustainability <https://ideas4sustainability.wordpress.com>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

Wolfgang

Wolfgang Huber
Principal Investigator, EMBL Senior Scientist
Genome Biology Unit
European Molecular Biology Laboratory (EMBL)
Heidelberg, Germany

wolfgang.huber at embl.de
http://www.huber.embl.de


From edd at debian.org  Mon Apr 11 21:48:01 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 11 Apr 2016 14:48:01 -0500
Subject: [Rd] Understanding POSIXct creation on different OSes.
In-Reply-To: <CAJ=vYTENdukcF4XZpTkg=y1vFe2QJ5DNBKtCXBPBhey1auvw-A@mail.gmail.com>
References: <CAJ=vYTENdukcF4XZpTkg=y1vFe2QJ5DNBKtCXBPBhey1auvw-A@mail.gmail.com>
Message-ID: <22283.65393.376214.312660@max.nulle.part>


Bumping this up to the front again ... because it exhibits a difference in
behaviour of R across OSs.  Such a 'feature' may not be desirable.

On 4 April 2016 at 18:00, Arunkumar Srinivasan wrote:
| Hello,
| 
| Following Dirk's post here: https://github.com/Rdatatable/data.table/issues/1619
| we would like to clarify if this is the right behaviour, and if so,
| the rationale behind it.
| 
| Here's the summary (thanks to Dirk and Joshua):
| 
| Sys.setenv("TZ"="America/Chicago")
| dates = as.Date("2016-03-02") + (0:3)*7 # four Wednesdays
| # [1] "2016-03-02" "2016-03-09" "2016-03-16" "2016-03-23"
| 
| # on OS X and Windows 10 -- expected result
| as.POSIXct(as.POSIXlt(dates), tz = "America/Chicago")
| # [1] "2016-03-02 CST" "2016-03-09 CST" "2016-03-16 CDT" "2016-03-23 CDT"
| 
| # On Linux (tested on Ubuntu 14.04) -- not as expected
| as.POSIXct(as.POSIXlt(dates), tz = "America/Chicago")
| # [1] "2016-03-02 00:00:00 CST" "2016-03-09 00:00:00 CST" "2016-03-16
| 01:00:00 CDT" "2016-03-23 01:00:00 CDT"
|
| # 'isdst' attribute is identical on OS X / Windows / Ubuntu, as expected
| # since dates don't have timezones, as pointed out by @JoshuaUlrich under
| # issue #1619.
| lt = as.POSIXlt(dates)
| lt$isdst
| # [1] 0 0 0 0
| 
| # However, as Dirk points out, setting isdst to -1 on Ubuntu returns
| expected results
| lt$isdst = -1
| as.POSIXct(lt, tz = "America/Chicago")
| # [1] "2016-03-02 CST" "2016-03-09 CST" "2016-03-16 CDT" "2016-03-23 CDT"
| 
| # Note that setting isdst to -1 on OS X / Windows has no effect, i.e.,
| the result is always as expected.
| 
| As Dirk points out, from ?POSIXlt:
| "Where possible the platform limits are detected, and outside the
| limits we use our own C code. This uses the offset from GMT in
| use either for 1902 (when there was no DST) or that predicted for
| one of 2030 to 2037 (chosen so that the likely DST transition days
| are Sundays), and uses the alternate (daylight-saving) time zone
| only if ?isdst? is positive or (if ?-1?) if DST was predicted to
| be in operation in the 2030s on that day."
| 
| It's not clear what this exactly means, and if it is related to the
| behaviour shown above. It'd be nice to know if a) this behaviour of
| non-identical result is as expected, and if so, b) can we rely on
| setting 'isdst' to -1 returning the expected result always?

Could someone from R Core please comment, or would you prefer us to file a
bug report?

Thanks!

Dirk



| Thank you,
| Arun.
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From neilandertal at gmail.com  Mon Apr 11 23:35:51 2016
From: neilandertal at gmail.com (Neil French Collier)
Date: Mon, 11 Apr 2016 21:35:51 +0000
Subject: [Rd] R not responding (must force quit) when saving graphic to
 PDF (bug?)
In-Reply-To: <72F4E33B-416F-4745-99B0-9AA6DD500261@embl.de>
References: <CAOVghqoNkdpqtcQM6jiVSRHS2qyuavtD+jpX_9JpfVLfhEfxtA@mail.gmail.com>
	<72F4E33B-416F-4745-99B0-9AA6DD500261@embl.de>
Message-ID: <CAOVghqrOtFxJbnNwO=Ffhu2gZ_9dbFJk2ay=Wjk44c-YXBCq6A@mail.gmail.com>

Dear Wolfgang,

Thanks for your response.

No, I haven't tried doing the complete reinstallation as you suggest. If I
recall correctly, this has happened on previous occasions but like I said
in my email it's not all that disruptive to my workflow. It's more like a
'first world problem'.

I was encouraged to submit the query because I had correspondence with
someone involved with R development: "this shouldn't be happening" was the
advice I received. I use R a lot but I'm not deeply knowledgable about it's
inner workings.

To be frank, I really don't care if this is resolved. I was just trying to
help the R development group after receiving advice that it might be
important.

Again, thanks for your help.

Cheers

Neil

On Mon, Apr 11, 2016 at 6:41 PM, Wolfgang Huber <whuber at embl.de> wrote:

> Dear Neil
>
> Have you tried with completely uninstalling your R, and reinstalling a
> more recent version (e.g. 3.2.4 right now).
> And then the same with your operating system - OS X is currently at
> 10.11.4.
> There is likely not much interest (or benefit) in chasing such things in
> obsolete versions.
>
> And I think R-help would be the more appropriate place for this kind of
> question.
>         Wolfgang
>
> > On Apr 11, 2016, at 18:37 GMT+2, Neil French Collier <
> neilandertal at gmail.com> wrote:
> >
> > Dear colleagues,
> >
> > I wish to report a problem I encounter when trying to save a graphic to
> > file. When I produce a graphic and try to save it R becomes unresponsive
> > and I must force quit, and then restart R. The problem occurs when I try
> to
> > overwrite an existing graphic: for example when I made changes to the
> > graphic and want to save the graphic using the original file name. It
> only
> > happens when I use the menus to save files, not using script. It doesn't
> > happen when I save it as a new file. So, like this:
> >
> > 1. Make the graphic
> > 2. Click File -> Save -> click on existing file name
> > 3. Colour wheel appears and R is unresponsive.
> >
> > Reproducible example:
> >
> > x <- seq(1,10)
> > y <- x^2
> > plot(x,y, type="l") # Save as new file, all fine.
> >
> > #Change plot and save as old plot file name:
> >
> > plot(x,y, type="l", col=2)
> >
> > # Click File -> Save
> > # 'Save quartz to PDF file' box opens
> > # Click on existing file name
> > # Colour wheel
> >
> > Here is the sessionInfo():
> >
> > R version 3.2.2 (2015-08-14)
> > Platform: x86_64-apple-darwin13.4.0 (64-bit)
> > Running under: OS X 10.11.1 (El Capitan)
> >
> > locale:
> > [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > I'm not sure if this is worthy of reporting but I was encouraged to
> submit
> > a report. It doesn't really make a huge impact on my workflow, but it can
> > be annoying.
> >
> > --
> > Cheers,
> >
> > Neil
> >
> > Neil French Collier, PhD
> > Faculty of Sustainability
> > Leuphana University L?neburg
> > Rotenbleicher Weg 67
> > 21335 Lueneburg
> > Germany
> >
> > Twitter: @foodsecbio
> > email: collier at leuphana.de
> > Google Scholar
> > <
> https://scholar.google.com.au/citations?hl=en&user=xVdc-dsAAAAJ&view_op=list_works&sortby=pubdate
> >
> > Ideas for Sustainability <https://ideas4sustainability.wordpress.com>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> Wolfgang
>
> Wolfgang Huber
> Principal Investigator, EMBL Senior Scientist
> Genome Biology Unit
> European Molecular Biology Laboratory (EMBL)
> Heidelberg, Germany
>
> wolfgang.huber at embl.de
> http://www.huber.embl.de
>
>
>
>
>
>
>
>
>
>


-- 
Cheers,

Neil

Neil French Collier, PhD
Faculty of Sustainability
Leuphana University L?neburg
Rotenbleicher Weg 67
21335 Lueneburg
Germany

Twitter: @foodsecbio
email: collier at leuphana.de
Google Scholar
<https://scholar.google.com.au/citations?hl=en&user=xVdc-dsAAAAJ&view_op=list_works&sortby=pubdate>
Ideas for Sustainability <https://ideas4sustainability.wordpress.com>

	[[alternative HTML version deleted]]


From henrik.bengtsson at gmail.com  Tue Apr 12 01:12:04 2016
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Mon, 11 Apr 2016 16:12:04 -0700
Subject: [Rd] R not responding (must force quit) when saving graphic to
 PDF (bug?)
In-Reply-To: <CAOVghqrOtFxJbnNwO=Ffhu2gZ_9dbFJk2ay=Wjk44c-YXBCq6A@mail.gmail.com>
References: <CAOVghqoNkdpqtcQM6jiVSRHS2qyuavtD+jpX_9JpfVLfhEfxtA@mail.gmail.com>
	<72F4E33B-416F-4745-99B0-9AA6DD500261@embl.de>
	<CAOVghqrOtFxJbnNwO=Ffhu2gZ_9dbFJk2ay=Wjk44c-YXBCq6A@mail.gmail.com>
Message-ID: <CAFDcVCTMtfgDQ531uP3Lz1L1Dpn6bU2HEAvSMKRkuYte0=CGxA@mail.gmail.com>

I'm not an OS X user, but two things you might look into/help you troubleshoot:

1. Because you said it only happens when you try to overwrite an
existing PDF, could it be that there is another process holding onto
(=locking) the PDF file that you're trying to write to?  For instance,
are you viewing it at the same time?

2. What happens if you create a dummy dummy.txt file, and then try to
overwrite that (with the same name - so no *.pdf)?  Does that work/not
work?  If it works, it means there's something special with *.pdf
files.  If not, then ... ?!?.

My $.02

/Henrik

PS. I think Wolfgang's point is that few people will spent time
troubleshooting obsolete versions of R (unless they're on the same
version), meaning the chances for feedback/troubleshooting on this is
much smaller than if it could be confirmed we a more up-to-date
version of R.  Because if it does given a problem in a new version,
there is nothing really to fix.  Having said this, any feedback that
might >= 1 person is always useful.


On Mon, Apr 11, 2016 at 2:35 PM, Neil French Collier
<neilandertal at gmail.com> wrote:
> Dear Wolfgang,
>
> Thanks for your response.
>
> No, I haven't tried doing the complete reinstallation as you suggest. If I
> recall correctly, this has happened on previous occasions but like I said
> in my email it's not all that disruptive to my workflow. It's more like a
> 'first world problem'.
>
> I was encouraged to submit the query because I had correspondence with
> someone involved with R development: "this shouldn't be happening" was the
> advice I received. I use R a lot but I'm not deeply knowledgable about it's
> inner workings.
>
> To be frank, I really don't care if this is resolved. I was just trying to
> help the R development group after receiving advice that it might be
> important.
>
> Again, thanks for your help.
>
> Cheers
>
> Neil
>
> On Mon, Apr 11, 2016 at 6:41 PM, Wolfgang Huber <whuber at embl.de> wrote:
>
>> Dear Neil
>>
>> Have you tried with completely uninstalling your R, and reinstalling a
>> more recent version (e.g. 3.2.4 right now).
>> And then the same with your operating system - OS X is currently at
>> 10.11.4.
>> There is likely not much interest (or benefit) in chasing such things in
>> obsolete versions.
>>
>> And I think R-help would be the more appropriate place for this kind of
>> question.
>>         Wolfgang
>>
>> > On Apr 11, 2016, at 18:37 GMT+2, Neil French Collier <
>> neilandertal at gmail.com> wrote:
>> >
>> > Dear colleagues,
>> >
>> > I wish to report a problem I encounter when trying to save a graphic to
>> > file. When I produce a graphic and try to save it R becomes unresponsive
>> > and I must force quit, and then restart R. The problem occurs when I try
>> to
>> > overwrite an existing graphic: for example when I made changes to the
>> > graphic and want to save the graphic using the original file name. It
>> only
>> > happens when I use the menus to save files, not using script. It doesn't
>> > happen when I save it as a new file. So, like this:
>> >
>> > 1. Make the graphic
>> > 2. Click File -> Save -> click on existing file name
>> > 3. Colour wheel appears and R is unresponsive.
>> >
>> > Reproducible example:
>> >
>> > x <- seq(1,10)
>> > y <- x^2
>> > plot(x,y, type="l") # Save as new file, all fine.
>> >
>> > #Change plot and save as old plot file name:
>> >
>> > plot(x,y, type="l", col=2)
>> >
>> > # Click File -> Save
>> > # 'Save quartz to PDF file' box opens
>> > # Click on existing file name
>> > # Colour wheel
>> >
>> > Here is the sessionInfo():
>> >
>> > R version 3.2.2 (2015-08-14)
>> > Platform: x86_64-apple-darwin13.4.0 (64-bit)
>> > Running under: OS X 10.11.1 (El Capitan)
>> >
>> > locale:
>> > [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > I'm not sure if this is worthy of reporting but I was encouraged to
>> submit
>> > a report. It doesn't really make a huge impact on my workflow, but it can
>> > be annoying.
>> >
>> > --
>> > Cheers,
>> >
>> > Neil
>> >
>> > Neil French Collier, PhD
>> > Faculty of Sustainability
>> > Leuphana University L?neburg
>> > Rotenbleicher Weg 67
>> > 21335 Lueneburg
>> > Germany
>> >
>> > Twitter: @foodsecbio
>> > email: collier at leuphana.de
>> > Google Scholar
>> > <
>> https://scholar.google.com.au/citations?hl=en&user=xVdc-dsAAAAJ&view_op=list_works&sortby=pubdate
>> >
>> > Ideas for Sustainability <https://ideas4sustainability.wordpress.com>
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> Wolfgang
>>
>> Wolfgang Huber
>> Principal Investigator, EMBL Senior Scientist
>> Genome Biology Unit
>> European Molecular Biology Laboratory (EMBL)
>> Heidelberg, Germany
>>
>> wolfgang.huber at embl.de
>> http://www.huber.embl.de
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>
>
> --
> Cheers,
>
> Neil
>
> Neil French Collier, PhD
> Faculty of Sustainability
> Leuphana University L?neburg
> Rotenbleicher Weg 67
> 21335 Lueneburg
> Germany
>
> Twitter: @foodsecbio
> email: collier at leuphana.de
> Google Scholar
> <https://scholar.google.com.au/citations?hl=en&user=xVdc-dsAAAAJ&view_op=list_works&sortby=pubdate>
> Ideas for Sustainability <https://ideas4sustainability.wordpress.com>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Berwin.Turlach at gmail.com  Sun Apr 17 08:25:01 2016
From: Berwin.Turlach at gmail.com (Berwin A Turlach)
Date: Sun, 17 Apr 2016 14:25:01 +0800
Subject: [Rd] Building R-patched and R-devel fails
Message-ID: <20160417142501.5e90e27e@bossiaea>

G'day all,

probably you have noticed this by now, but I thought I ought to report
it. :)

My scripts that update the SVN sources for R-patched and R-devel, run
`tools/rsync-recommended' (for both) and then install both these
versions from scratch failed this morning.  Apparently the new version
of the recommended package `survival' depends on the recommended
package `Matrix', but the makefile does not ensure that Matrix is build
before survival.  So my log files had entries:

  [...]
  ERROR: dependency ?Matrix? is not available for package ?survival?
  * removing ?/opt/src/R-devel-build/library/survival?
  Makefile:51: recipe for target 'survival.ts' failed
  make[2]: *** [survival.ts] Error 1
  make[2]: *** Waiting for unfinished jobs....
  [...]

Presumably, in both branches, the files Makefile.in and Makefile.win in
src/library/Recommended have to be adapted to contain the following
line at the end among the "Hardcoded dependencies":

	survival.ts: Matrix.ts

Cheers,

	Berwin


From ripley at stats.ox.ac.uk  Sun Apr 17 11:01:04 2016
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 17 Apr 2016 10:01:04 +0100
Subject: [Rd] Building R-patched and R-devel fails
In-Reply-To: <20160417142501.5e90e27e@bossiaea>
References: <20160417142501.5e90e27e@bossiaea>
Message-ID: <571350D0.2050706@stats.ox.ac.uk>

On 17/04/2016 07:25, Berwin A Turlach wrote:
> G'day all,
>
> probably you have noticed this by now, but I thought I ought to report
> it. :)

Already fixed for Unix by the time this reached me.  Since that version 
of Survival has been put into 3.2 patched, that also needed its 
Makefile.in updated.

I've left Windows changes to those with a Windows build system.

>
> My scripts that update the SVN sources for R-patched and R-devel, run
> `tools/rsync-recommended' (for both) and then install both these
> versions from scratch failed this morning.  Apparently the new version
> of the recommended package `survival' depends on the recommended
> package `Matrix', but the makefile does not ensure that Matrix is build
> before survival.  So my log files had entries:
>
>    [...]
>    ERROR: dependency ?Matrix? is not available for package ?survival?
>    * removing ?/opt/src/R-devel-build/library/survival?
>    Makefile:51: recipe for target 'survival.ts' failed
>    make[2]: *** [survival.ts] Error 1
>    make[2]: *** Waiting for unfinished jobs....
>    [...]
>
> Presumably, in both branches, the files Makefile.in and Makefile.win in
> src/library/Recommended have to be adapted to contain the following
> line at the end among the "Hardcoded dependencies":
>
> 	survival.ts: Matrix.ts
>
> Cheers,
>
> 	Berwin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From rpruim at calvin.edu  Sun Apr 17 15:54:28 2016
From: rpruim at calvin.edu (Randall Pruim)
Date: Sun, 17 Apr 2016 13:54:28 +0000
Subject: [Rd] residual standard "error"
Message-ID: <37CB9E78-738E-4508-BA0C-AD4CB7B98EF4@calvin.edu>

I see that the sigma() function has recently been introduced into R 3.3.  The help for sigma() says:

Extract the estimated standard deviation of the errors, the ?residual standard deviation? (misnomed also ?residual standard error?, e.g., in summary.lm()'s output, from a fitted model.

Is there any reason not to fix the mis-naming of residual standard error now too?  Both functions are in the stats package.  It seems odd for one function in the package to point out an issue with another, especially when fixing it would only affect displayed output and not the rest of the API.

My apologies if this has been suggested before, but a search through the archives didn?t locate the discussion.

Also, there is a missing paren in the sentenced quoted from the help for sigma().

?rjp


	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Sun Apr 17 17:09:49 2016
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 17 Apr 2016 17:09:49 +0200
Subject: [Rd] Building R-patched and R-devel fails
In-Reply-To: <571350D0.2050706@stats.ox.ac.uk>
References: <20160417142501.5e90e27e@bossiaea>
	<571350D0.2050706@stats.ox.ac.uk>
Message-ID: <5713A73D.8000808@statistik.tu-dortmund.de>



On 17.04.2016 11:01, Prof Brian Ripley wrote:
> On 17/04/2016 07:25, Berwin A Turlach wrote:
>> G'day all,
>>
>> probably you have noticed this by now, but I thought I ought to report
>> it. :)
>
> Already fixed for Unix by the time this reached me.  Since that version
> of Survival has been put into 3.2 patched, that also needed its
> Makefile.in updated.
>
> I've left Windows changes to those with a Windows build system.


Done for R-devel and the 3.3 branch just in case something happens on 
other machines. At least on my machine the build happened in an 
appropriate order anyway.

Best,
Uwe

>>
>> My scripts that update the SVN sources for R-patched and R-devel, run
>> `tools/rsync-recommended' (for both) and then install both these
>> versions from scratch failed this morning.  Apparently the new version
>> of the recommended package `survival' depends on the recommended
>> package `Matrix', but the makefile does not ensure that Matrix is build
>> before survival.  So my log files had entries:
>>
>>    [...]
>>    ERROR: dependency ?Matrix? is not available for package ?survival?
>>    * removing ?/opt/src/R-devel-build/library/survival?
>>    Makefile:51: recipe for target 'survival.ts' failed
>>    make[2]: *** [survival.ts] Error 1
>>    make[2]: *** Waiting for unfinished jobs....
>>    [...]
>>
>> Presumably, in both branches, the files Makefile.in and Makefile.win in
>> src/library/Recommended have to be adapted to contain the following
>> line at the end among the "Hardcoded dependencies":
>>
>>     survival.ts: Matrix.ts
>>
>> Cheers,
>>
>>     Berwin
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>


From therneau at mayo.edu  Mon Apr 18 13:53:36 2016
From: therneau at mayo.edu (Therneau, Terry M., Ph.D.)
Date: Mon, 18 Apr 2016 06:53:36 -0500
Subject: [Rd] Survival package (was Building R-patched and R-devel fails)
Message-ID: <519743$2s32en@ironport10.mayo.edu>

Just a note FYI:  The survival package can now create predicted "probability in state" 
curves from a multi-state model, and that computation uses the exponential of a matrix.

Hence the new NAMESPACE line of "importFrom(Matrix, expm)", and the resulting dependency 
of 'survival' on 'Matrix'.  It is the only part of the package used.

Terry T.


From pdalgd at gmail.com  Mon Apr 18 15:18:48 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Mon, 18 Apr 2016 15:18:48 +0200
Subject: [Rd] Building R-patched and R-devel fails
In-Reply-To: <5713A73D.8000808@statistik.tu-dortmund.de>
References: <20160417142501.5e90e27e@bossiaea>
	<571350D0.2050706@stats.ox.ac.uk>
	<5713A73D.8000808@statistik.tu-dortmund.de>
Message-ID: <5AA9051A-44A5-45C8-87AF-F087DB4BCBE4@gmail.com>


On 17 Apr 2016, at 17:09 , Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:

> 
> 
> On 17.04.2016 11:01, Prof Brian Ripley wrote:
>> On 17/04/2016 07:25, Berwin A Turlach wrote:
>>> G'day all,
>>> 
>>> probably you have noticed this by now, but I thought I ought to report
>>> it. :)
>> 
>> Already fixed for Unix by the time this reached me.  Since that version
>> of Survival has been put into 3.2 patched, that also needed its
>> Makefile.in updated.
>> 
>> I've left Windows changes to those with a Windows build system.
> 
> 
> Done for R-devel and the 3.3 branch just in case something happens on other machines. At least on my machine the build happened in an appropriate order anyway.

Great.

In case you missed Terry's note: This dependency transpires to be due to a very recent addition addition to survival, which explains why we were never bitten by it in the past. And since M comes before s in most collations, it probably only affected parallel builds anyway. And even in that case, the outcome of race conditions is undetermined.

-pd


> 
> Best,
> Uwe
> 
>>> 
>>> My scripts that update the SVN sources for R-patched and R-devel, run
>>> `tools/rsync-recommended' (for both) and then install both these
>>> versions from scratch failed this morning.  Apparently the new version
>>> of the recommended package `survival' depends on the recommended
>>> package `Matrix', but the makefile does not ensure that Matrix is build
>>> before survival.  So my log files had entries:
>>> 
>>>   [...]
>>>   ERROR: dependency ?Matrix? is not available for package ?survival?
>>>   * removing ?/opt/src/R-devel-build/library/survival?
>>>   Makefile:51: recipe for target 'survival.ts' failed
>>>   make[2]: *** [survival.ts] Error 1
>>>   make[2]: *** Waiting for unfinished jobs....
>>>   [...]
>>> 
>>> Presumably, in both branches, the files Makefile.in and Makefile.win in
>>> src/library/Recommended have to be adapted to contain the following
>>> line at the end among the "Hardcoded dependencies":
>>> 
>>>    survival.ts: Matrix.ts
>>> 
>>> Cheers,
>>> 
>>>    Berwin
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From edd at debian.org  Mon Apr 18 20:37:01 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 18 Apr 2016 13:37:01 -0500
Subject: [Rd] Understanding POSIXct creation on different OSes.
In-Reply-To: <22283.65393.376214.312660@max.nulle.part>
References: <CAJ=vYTENdukcF4XZpTkg=y1vFe2QJ5DNBKtCXBPBhey1auvw-A@mail.gmail.com>
	<22283.65393.376214.312660@max.nulle.part>
Message-ID: <22293.10573.137366.177503@max.nulle.part>


On 11 April 2016 at 14:48, Dirk Eddelbuettel wrote:
| 
| Bumping this up to the front again ... because it exhibits a difference in
| behaviour of R across OSs.  Such a 'feature' may not be desirable.

And bumping it a second time.  If nobody replies I will carry it over to Bugzilla.

It is still a "misfeature" with behaviour which varies across OSs which is
rarely the desired outcome.  I'd still love to hear some comments.

Dirk

| 
| On 4 April 2016 at 18:00, Arunkumar Srinivasan wrote:
| | Hello,
| | 
| | Following Dirk's post here: https://github.com/Rdatatable/data.table/issues/1619
| | we would like to clarify if this is the right behaviour, and if so,
| | the rationale behind it.
| | 
| | Here's the summary (thanks to Dirk and Joshua):
| | 
| | Sys.setenv("TZ"="America/Chicago")
| | dates = as.Date("2016-03-02") + (0:3)*7 # four Wednesdays
| | # [1] "2016-03-02" "2016-03-09" "2016-03-16" "2016-03-23"
| | 
| | # on OS X and Windows 10 -- expected result
| | as.POSIXct(as.POSIXlt(dates), tz = "America/Chicago")
| | # [1] "2016-03-02 CST" "2016-03-09 CST" "2016-03-16 CDT" "2016-03-23 CDT"
| | 
| | # On Linux (tested on Ubuntu 14.04) -- not as expected
| | as.POSIXct(as.POSIXlt(dates), tz = "America/Chicago")
| | # [1] "2016-03-02 00:00:00 CST" "2016-03-09 00:00:00 CST" "2016-03-16
| | 01:00:00 CDT" "2016-03-23 01:00:00 CDT"
| |
| | # 'isdst' attribute is identical on OS X / Windows / Ubuntu, as expected
| | # since dates don't have timezones, as pointed out by @JoshuaUlrich under
| | # issue #1619.
| | lt = as.POSIXlt(dates)
| | lt$isdst
| | # [1] 0 0 0 0
| | 
| | # However, as Dirk points out, setting isdst to -1 on Ubuntu returns
| | expected results
| | lt$isdst = -1
| | as.POSIXct(lt, tz = "America/Chicago")
| | # [1] "2016-03-02 CST" "2016-03-09 CST" "2016-03-16 CDT" "2016-03-23 CDT"
| | 
| | # Note that setting isdst to -1 on OS X / Windows has no effect, i.e.,
| | the result is always as expected.
| | 
| | As Dirk points out, from ?POSIXlt:
| | "Where possible the platform limits are detected, and outside the
| | limits we use our own C code. This uses the offset from GMT in
| | use either for 1902 (when there was no DST) or that predicted for
| | one of 2030 to 2037 (chosen so that the likely DST transition days
| | are Sundays), and uses the alternate (daylight-saving) time zone
| | only if ?isdst? is positive or (if ?-1?) if DST was predicted to
| | be in operation in the 2030s on that day."
| | 
| | It's not clear what this exactly means, and if it is related to the
| | behaviour shown above. It'd be nice to know if a) this behaviour of
| | non-identical result is as expected, and if so, b) can we rely on
| | setting 'isdst' to -1 returning the expected result always?
| 
| Could someone from R Core please comment, or would you prefer us to file a
| bug report?
| 
| Thanks!
| 
| Dirk
| 
| 
| 
| | Thank you,
| | Arun.
| | 
| | ______________________________________________
| | R-devel at r-project.org mailing list
| | https://stat.ethz.ch/mailman/listinfo/r-devel
| -- 
| http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From kirill.mueller at ivt.baug.ethz.ch  Tue Apr 19 01:35:07 2016
From: kirill.mueller at ivt.baug.ethz.ch (=?UTF-8?Q?Kirill_M=c3=bcller?=)
Date: Tue, 19 Apr 2016 01:35:07 +0200
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable "extends"
 is accessible from global environment
Message-ID: <57156F2B.4000205@ivt.baug.ethz.ch>

Scenario: An S3 method is declared for an S4 base class but called for 
an instance of a derived class.

Steps to reproduce:

 > Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <- 
function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
Error in UseMethod("test", x) :
   no applicable method for 'test' applied to an object of class "lsyMatrix"
Calls: <Anonymous>
1: MatrixDispatchTest::test(Matrix::Matrix())

 > Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x); 
test.Matrix <- function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
[1] "Hi"

To me, it looks like a sanity check in line 655 of src/main/attrib.c is 
making wrong assumptions, but there might be other reasons. 
(https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)

Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.


Best regards

Kirill


From kirill.mueller at ivt.baug.ethz.ch  Tue Apr 19 01:38:08 2016
From: kirill.mueller at ivt.baug.ethz.ch (=?UTF-8?Q?Kirill_M=c3=bcller?=)
Date: Tue, 19 Apr 2016 01:38:08 +0200
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <57156F2B.4000205@ivt.baug.ethz.ch>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
Message-ID: <57156FE0.9090502@ivt.baug.ethz.ch>

Please omit "MatrixDispatchTest::" from the test scripts:

Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <- 
function(x) 'Hi'; test(Matrix::Matrix())"

Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x); 
test.Matrix <- function(x) 'Hi'; test(Matrix::Matrix())"


-Kirill


On 19.04.2016 01:35, Kirill M?ller wrote:
> Scenario: An S3 method is declared for an S4 base class but called for 
> an instance of a derived class.
>
> Steps to reproduce:
>
> > Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <- 
> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
> Error in UseMethod("test", x) :
>   no applicable method for 'test' applied to an object of class 
> "lsyMatrix"
> Calls: <Anonymous>
> 1: MatrixDispatchTest::test(Matrix::Matrix())
>
> > Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x); 
> test.Matrix <- function(x) 'Hi'; 
> MatrixDispatchTest::test(Matrix::Matrix())"
> [1] "Hi"
>
> To me, it looks like a sanity check in line 655 of src/main/attrib.c 
> is making wrong assumptions, but there might be other reasons. 
> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
>
> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>
>
> Best regards
>
> Kirill
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From lawrence.michael at gene.com  Tue Apr 19 04:10:23 2016
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Mon, 18 Apr 2016 19:10:23 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <57156F2B.4000205@ivt.baug.ethz.ch>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
Message-ID: <CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>

Right, the methods package is not attached by default when running R
with Rscript. We should probably remove that special case, as it
mostly just leads to confusion, but that won't happen immediately.

For now, the S4_extends() should probably throw an error when the
methods namespace is not loaded. And the check should be changed to
directly check whether R_MethodsNamespace has been set to something
other than the default (R_GlobalEnv). Agreed?

On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
<kirill.mueller at ivt.baug.ethz.ch> wrote:
> Scenario: An S3 method is declared for an S4 base class but called for an
> instance of a derived class.
>
> Steps to reproduce:
>
>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <-
>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
> Error in UseMethod("test", x) :
>   no applicable method for 'test' applied to an object of class "lsyMatrix"
> Calls: <Anonymous>
> 1: MatrixDispatchTest::test(Matrix::Matrix())
>
>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x);
>> test.Matrix <- function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
> [1] "Hi"
>
> To me, it looks like a sanity check in line 655 of src/main/attrib.c is
> making wrong assumptions, but there might be other reasons.
> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
>
> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>
>
> Best regards
>
> Kirill
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From kirill.mueller at ivt.baug.ethz.ch  Tue Apr 19 08:50:16 2016
From: kirill.mueller at ivt.baug.ethz.ch (=?UTF-8?Q?Kirill_M=c3=bcller?=)
Date: Tue, 19 Apr 2016 08:50:16 +0200
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
Message-ID: <5715D528.6030101@ivt.baug.ethz.ch>

Thanks for looking into it, your approach sounds good to me. See also 
R_has_methods_attached() 
(https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265).

I'm fine with Rscript not loading "methods", as long as everything works 
properly with "methods" loaded but not attached.


-Kirill


On 19.04.2016 04:10, Michael Lawrence wrote:
> Right, the methods package is not attached by default when running R
> with Rscript. We should probably remove that special case, as it
> mostly just leads to confusion, but that won't happen immediately.
>
> For now, the S4_extends() should probably throw an error when the
> methods namespace is not loaded. And the check should be changed to
> directly check whether R_MethodsNamespace has been set to something
> other than the default (R_GlobalEnv). Agreed?
>
> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> Scenario: An S3 method is declared for an S4 base class but called for an
>> instance of a derived class.
>>
>> Steps to reproduce:
>>
>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <-
>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
>> Error in UseMethod("test", x) :
>>    no applicable method for 'test' applied to an object of class "lsyMatrix"
>> Calls: <Anonymous>
>> 1: MatrixDispatchTest::test(Matrix::Matrix())
>>
>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x);
>>> test.Matrix <- function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
>> [1] "Hi"
>>
>> To me, it looks like a sanity check in line 655 of src/main/attrib.c is
>> making wrong assumptions, but there might be other reasons.
>> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
>>
>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>>
>>
>> Best regards
>>
>> Kirill
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From lawrence.michael at gene.com  Tue Apr 19 14:34:41 2016
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 19 Apr 2016 05:34:41 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <5715D528.6030101@ivt.baug.ethz.ch>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
Message-ID: <CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>

Not sure why R_has_methods_attached() exists. Maybe Martin could shed
some light on that.

On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
<kirill.mueller at ivt.baug.ethz.ch> wrote:
> Thanks for looking into it, your approach sounds good to me. See also
> R_has_methods_attached()
> (https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265).
>
> I'm fine with Rscript not loading "methods", as long as everything works
> properly with "methods" loaded but not attached.
>
>
> -Kirill
>
>
>
> On 19.04.2016 04:10, Michael Lawrence wrote:
>>
>> Right, the methods package is not attached by default when running R
>> with Rscript. We should probably remove that special case, as it
>> mostly just leads to confusion, but that won't happen immediately.
>>
>> For now, the S4_extends() should probably throw an error when the
>> methods namespace is not loaded. And the check should be changed to
>> directly check whether R_MethodsNamespace has been set to something
>> other than the default (R_GlobalEnv). Agreed?
>>
>> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
>> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>>>
>>> Scenario: An S3 method is declared for an S4 base class but called for an
>>> instance of a derived class.
>>>
>>> Steps to reproduce:
>>>
>>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <-
>>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
>>>
>>> Error in UseMethod("test", x) :
>>>    no applicable method for 'test' applied to an object of class
>>> "lsyMatrix"
>>> Calls: <Anonymous>
>>> 1: MatrixDispatchTest::test(Matrix::Matrix())
>>>
>>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x);
>>>> test.Matrix <- function(x) 'Hi';
>>>> MatrixDispatchTest::test(Matrix::Matrix())"
>>>
>>> [1] "Hi"
>>>
>>> To me, it looks like a sanity check in line 655 of src/main/attrib.c is
>>> making wrong assumptions, but there might be other reasons.
>>>
>>> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
>>>
>>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>>>
>>>
>>> Best regards
>>>
>>> Kirill
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>
>


From gmbecker at ucdavis.edu  Tue Apr 19 15:51:48 2016
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Tue, 19 Apr 2016 06:51:48 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
Message-ID: <CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>

See also .isMethodsDispatchOn, which is what trace uses to decide if the
methods package needs to be loaded.

~G

On Tue, Apr 19, 2016 at 5:34 AM, Michael Lawrence <lawrence.michael at gene.com
> wrote:

> Not sure why R_has_methods_attached() exists. Maybe Martin could shed
> some light on that.
>
> On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
> <kirill.mueller at ivt.baug.ethz.ch> wrote:
> > Thanks for looking into it, your approach sounds good to me. See also
> > R_has_methods_attached()
> > (
> https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265
> ).
> >
> > I'm fine with Rscript not loading "methods", as long as everything works
> > properly with "methods" loaded but not attached.
> >
> >
> > -Kirill
> >
> >
> >
> > On 19.04.2016 04:10, Michael Lawrence wrote:
> >>
> >> Right, the methods package is not attached by default when running R
> >> with Rscript. We should probably remove that special case, as it
> >> mostly just leads to confusion, but that won't happen immediately.
> >>
> >> For now, the S4_extends() should probably throw an error when the
> >> methods namespace is not loaded. And the check should be changed to
> >> directly check whether R_MethodsNamespace has been set to something
> >> other than the default (R_GlobalEnv). Agreed?
> >>
> >> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
> >>>
> >>> Scenario: An S3 method is declared for an S4 base class but called for
> an
> >>> instance of a derived class.
> >>>
> >>> Steps to reproduce:
> >>>
> >>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <-
> >>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
> >>>
> >>> Error in UseMethod("test", x) :
> >>>    no applicable method for 'test' applied to an object of class
> >>> "lsyMatrix"
> >>> Calls: <Anonymous>
> >>> 1: MatrixDispatchTest::test(Matrix::Matrix())
> >>>
> >>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x);
> >>>> test.Matrix <- function(x) 'Hi';
> >>>> MatrixDispatchTest::test(Matrix::Matrix())"
> >>>
> >>> [1] "Hi"
> >>>
> >>> To me, it looks like a sanity check in line 655 of src/main/attrib.c is
> >>> making wrong assumptions, but there might be other reasons.
> >>>
> >>> (
> https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656
> )
> >>>
> >>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
> >>>
> >>>
> >>> Best regards
> >>>
> >>> Kirill
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>
> >
> >
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From lawrence.michael at gene.com  Tue Apr 19 16:34:00 2016
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 19 Apr 2016 07:34:00 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
	<CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
Message-ID: <CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>

Right, R_has_methods_attached() uses that. Probably not the right
check, since it refers to S4 dispatch, while S4_extends() is used by
S3 dispatch.

Perhaps S4_extends() should force load the methods package? The above
example works after fixing the check to ensure that R_MethodsNamespace
is not R_GlobalEnv, but one could load a serialized S4 object and
expect S3 dispatch to work with Rscript.

On Tue, Apr 19, 2016 at 6:51 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
> See also .isMethodsDispatchOn, which is what trace uses to decide if the
> methods package needs to be loaded.
>
> ~G
>
> On Tue, Apr 19, 2016 at 5:34 AM, Michael Lawrence
> <lawrence.michael at gene.com> wrote:
>>
>> Not sure why R_has_methods_attached() exists. Maybe Martin could shed
>> some light on that.
>>
>> On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
>> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> > Thanks for looking into it, your approach sounds good to me. See also
>> > R_has_methods_attached()
>> >
>> > (https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265).
>> >
>> > I'm fine with Rscript not loading "methods", as long as everything works
>> > properly with "methods" loaded but not attached.
>> >
>> >
>> > -Kirill
>> >
>> >
>> >
>> > On 19.04.2016 04:10, Michael Lawrence wrote:
>> >>
>> >> Right, the methods package is not attached by default when running R
>> >> with Rscript. We should probably remove that special case, as it
>> >> mostly just leads to confusion, but that won't happen immediately.
>> >>
>> >> For now, the S4_extends() should probably throw an error when the
>> >> methods namespace is not loaded. And the check should be changed to
>> >> directly check whether R_MethodsNamespace has been set to something
>> >> other than the default (R_GlobalEnv). Agreed?
>> >>
>> >> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
>> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> >>>
>> >>> Scenario: An S3 method is declared for an S4 base class but called for
>> >>> an
>> >>> instance of a derived class.
>> >>>
>> >>> Steps to reproduce:
>> >>>
>> >>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <-
>> >>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
>> >>>
>> >>> Error in UseMethod("test", x) :
>> >>>    no applicable method for 'test' applied to an object of class
>> >>> "lsyMatrix"
>> >>> Calls: <Anonymous>
>> >>> 1: MatrixDispatchTest::test(Matrix::Matrix())
>> >>>
>> >>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x);
>> >>>> test.Matrix <- function(x) 'Hi';
>> >>>> MatrixDispatchTest::test(Matrix::Matrix())"
>> >>>
>> >>> [1] "Hi"
>> >>>
>> >>> To me, it looks like a sanity check in line 655 of src/main/attrib.c
>> >>> is
>> >>> making wrong assumptions, but there might be other reasons.
>> >>>
>> >>>
>> >>> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
>> >>>
>> >>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>> >>>
>> >>>
>> >>> Best regards
>> >>>
>> >>> Kirill
>> >>>
>> >>> ______________________________________________
>> >>> R-devel at r-project.org mailing list
>> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >>>
>> >
>> >
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research


From gmbecker at ucdavis.edu  Tue Apr 19 17:37:59 2016
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Tue, 19 Apr 2016 08:37:59 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
	<CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
	<CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>
Message-ID: <CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>

Does it make sense to be able to load an S4 object without the methods
package being attached? I'm not sure implementation-wise how easy this
would be, but it seems like any time there is an S4 object around, the
methods package should be available to deal with it.

~G

On Tue, Apr 19, 2016 at 7:34 AM, Michael Lawrence <lawrence.michael at gene.com
> wrote:

> Right, R_has_methods_attached() uses that. Probably not the right
> check, since it refers to S4 dispatch, while S4_extends() is used by
> S3 dispatch.
>
> Perhaps S4_extends() should force load the methods package? The above
> example works after fixing the check to ensure that R_MethodsNamespace
> is not R_GlobalEnv, but one could load a serialized S4 object and
> expect S3 dispatch to work with Rscript.
>
> On Tue, Apr 19, 2016 at 6:51 AM, Gabriel Becker <gmbecker at ucdavis.edu>
> wrote:
> > See also .isMethodsDispatchOn, which is what trace uses to decide if the
> > methods package needs to be loaded.
> >
> > ~G
> >
> > On Tue, Apr 19, 2016 at 5:34 AM, Michael Lawrence
> > <lawrence.michael at gene.com> wrote:
> >>
> >> Not sure why R_has_methods_attached() exists. Maybe Martin could shed
> >> some light on that.
> >>
> >> On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
> >> > Thanks for looking into it, your approach sounds good to me. See also
> >> > R_has_methods_attached()
> >> >
> >> > (
> https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265
> ).
> >> >
> >> > I'm fine with Rscript not loading "methods", as long as everything
> works
> >> > properly with "methods" loaded but not attached.
> >> >
> >> >
> >> > -Kirill
> >> >
> >> >
> >> >
> >> > On 19.04.2016 04:10, Michael Lawrence wrote:
> >> >>
> >> >> Right, the methods package is not attached by default when running R
> >> >> with Rscript. We should probably remove that special case, as it
> >> >> mostly just leads to confusion, but that won't happen immediately.
> >> >>
> >> >> For now, the S4_extends() should probably throw an error when the
> >> >> methods namespace is not loaded. And the check should be changed to
> >> >> directly check whether R_MethodsNamespace has been set to something
> >> >> other than the default (R_GlobalEnv). Agreed?
> >> >>
> >> >> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
> >> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
> >> >>>
> >> >>> Scenario: An S3 method is declared for an S4 base class but called
> for
> >> >>> an
> >> >>> instance of a derived class.
> >> >>>
> >> >>> Steps to reproduce:
> >> >>>
> >> >>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix
> <-
> >> >>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
> >> >>>
> >> >>> Error in UseMethod("test", x) :
> >> >>>    no applicable method for 'test' applied to an object of class
> >> >>> "lsyMatrix"
> >> >>> Calls: <Anonymous>
> >> >>> 1: MatrixDispatchTest::test(Matrix::Matrix())
> >> >>>
> >> >>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test',
> x);
> >> >>>> test.Matrix <- function(x) 'Hi';
> >> >>>> MatrixDispatchTest::test(Matrix::Matrix())"
> >> >>>
> >> >>> [1] "Hi"
> >> >>>
> >> >>> To me, it looks like a sanity check in line 655 of src/main/attrib.c
> >> >>> is
> >> >>> making wrong assumptions, but there might be other reasons.
> >> >>>
> >> >>>
> >> >>> (
> https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656
> )
> >> >>>
> >> >>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
> >> >>>
> >> >>>
> >> >>> Best regards
> >> >>>
> >> >>> Kirill
> >> >>>
> >> >>> ______________________________________________
> >> >>> R-devel at r-project.org mailing list
> >> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >>>
> >> >
> >> >
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> >
> >
> > --
> > Gabriel Becker, PhD
> > Associate Scientist (Bioinformatics)
> > Genentech Research
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From h.wickham at gmail.com  Tue Apr 19 18:21:20 2016
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 19 Apr 2016 11:21:20 -0500
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
	<CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
	<CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>
	<CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>
Message-ID: <CABdHhvF5K2eU5_kHhxvx++hjKEZsx7hi3j9PxW3fGZCpJ_nLuQ@mail.gmail.com>

This might be too big a change - but is it worth reconsidering the
behaviour of Rscript? Maybe the simplest fix would be simply to always
load the methods package.  (I think historically it didn't because
loading methods took a long time, but that is no longer true)

Hadley

On Tue, Apr 19, 2016 at 10:37 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
> Does it make sense to be able to load an S4 object without the methods
> package being attached? I'm not sure implementation-wise how easy this
> would be, but it seems like any time there is an S4 object around, the
> methods package should be available to deal with it.
>
> ~G
>
> On Tue, Apr 19, 2016 at 7:34 AM, Michael Lawrence <lawrence.michael at gene.com
>> wrote:
>
>> Right, R_has_methods_attached() uses that. Probably not the right
>> check, since it refers to S4 dispatch, while S4_extends() is used by
>> S3 dispatch.
>>
>> Perhaps S4_extends() should force load the methods package? The above
>> example works after fixing the check to ensure that R_MethodsNamespace
>> is not R_GlobalEnv, but one could load a serialized S4 object and
>> expect S3 dispatch to work with Rscript.
>>
>> On Tue, Apr 19, 2016 at 6:51 AM, Gabriel Becker <gmbecker at ucdavis.edu>
>> wrote:
>> > See also .isMethodsDispatchOn, which is what trace uses to decide if the
>> > methods package needs to be loaded.
>> >
>> > ~G
>> >
>> > On Tue, Apr 19, 2016 at 5:34 AM, Michael Lawrence
>> > <lawrence.michael at gene.com> wrote:
>> >>
>> >> Not sure why R_has_methods_attached() exists. Maybe Martin could shed
>> >> some light on that.
>> >>
>> >> On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
>> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> >> > Thanks for looking into it, your approach sounds good to me. See also
>> >> > R_has_methods_attached()
>> >> >
>> >> > (
>> https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265
>> ).
>> >> >
>> >> > I'm fine with Rscript not loading "methods", as long as everything
>> works
>> >> > properly with "methods" loaded but not attached.
>> >> >
>> >> >
>> >> > -Kirill
>> >> >
>> >> >
>> >> >
>> >> > On 19.04.2016 04:10, Michael Lawrence wrote:
>> >> >>
>> >> >> Right, the methods package is not attached by default when running R
>> >> >> with Rscript. We should probably remove that special case, as it
>> >> >> mostly just leads to confusion, but that won't happen immediately.
>> >> >>
>> >> >> For now, the S4_extends() should probably throw an error when the
>> >> >> methods namespace is not loaded. And the check should be changed to
>> >> >> directly check whether R_MethodsNamespace has been set to something
>> >> >> other than the default (R_GlobalEnv). Agreed?
>> >> >>
>> >> >> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
>> >> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> >> >>>
>> >> >>> Scenario: An S3 method is declared for an S4 base class but called
>> for
>> >> >>> an
>> >> >>> instance of a derived class.
>> >> >>>
>> >> >>> Steps to reproduce:
>> >> >>>
>> >> >>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix
>> <-
>> >> >>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
>> >> >>>
>> >> >>> Error in UseMethod("test", x) :
>> >> >>>    no applicable method for 'test' applied to an object of class
>> >> >>> "lsyMatrix"
>> >> >>> Calls: <Anonymous>
>> >> >>> 1: MatrixDispatchTest::test(Matrix::Matrix())
>> >> >>>
>> >> >>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test',
>> x);
>> >> >>>> test.Matrix <- function(x) 'Hi';
>> >> >>>> MatrixDispatchTest::test(Matrix::Matrix())"
>> >> >>>
>> >> >>> [1] "Hi"
>> >> >>>
>> >> >>> To me, it looks like a sanity check in line 655 of src/main/attrib.c
>> >> >>> is
>> >> >>> making wrong assumptions, but there might be other reasons.
>> >> >>>
>> >> >>>
>> >> >>> (
>> https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656
>> )
>> >> >>>
>> >> >>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>> >> >>>
>> >> >>>
>> >> >>> Best regards
>> >> >>>
>> >> >>> Kirill
>> >> >>>
>> >> >>> ______________________________________________
>> >> >>> R-devel at r-project.org mailing list
>> >> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >> >>>
>> >> >
>> >> >
>> >>
>> >> ______________________________________________
>> >> R-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>> >
>> >
>> >
>> > --
>> > Gabriel Becker, PhD
>> > Associate Scientist (Bioinformatics)
>> > Genentech Research
>>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
http://hadley.nz


From henrik.bengtsson at gmail.com  Tue Apr 19 20:10:06 2016
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Tue, 19 Apr 2016 11:10:06 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CABdHhvF5K2eU5_kHhxvx++hjKEZsx7hi3j9PxW3fGZCpJ_nLuQ@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
	<CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
	<CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>
	<CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>
	<CABdHhvF5K2eU5_kHhxvx++hjKEZsx7hi3j9PxW3fGZCpJ_nLuQ@mail.gmail.com>
Message-ID: <CAFDcVCSNH7xh1gdoHFXEEAuQgKHmC_Jf5dV6OQXBe6bgS=LTYQ@mail.gmail.com>

On Tue, Apr 19, 2016 at 9:21 AM, Hadley Wickham <h.wickham at gmail.com> wrote:
>
> This might be too big a change - but is it worth reconsidering the
> behaviour of Rscript? Maybe the simplest fix would be simply to always
> load the methods package.  (I think historically it didn't because
> loading methods took a long time, but that is no longer true)

Slightly weaker version of this wish (that would also remove
confusion): At least make R and Rscript load the same set of packages
by default.


More clarification (in case some is new to this topic):

The packages loaded by default when R and Rscript is loaded can be
controlled by environment variable 'R_DEFAULT_PACKAGES' and/or option
'defaultPackages', cf. help("Startup").  When this is empty or
undefined, the built-in defaults kick in, and it's these built-in
defaults that differ between the R and the Rscript executable:

$ R --quiet --vanilla -e "getOption('defaultPackages')"
> getOption('defaultPackages')
[1] "datasets"  "utils"     "grDevices" "graphics"  "stats"     "methods"

$ Rscript --vanilla -e "getOption('defaultPackages')"
[1] "datasets"  "utils"     "grDevices" "graphics"  "stats"

Thus, a user can enforce the same set of default packages by using:

$ export R_DEFAULT_PACKAGES=datasets,utils,grDevices,graphics,stats,methods

$ R --quiet --vanilla -e "getOption('defaultPackages')"
> getOption('defaultPackages')
[1] "datasets"  "utils"     "grDevices" "graphics"  "stats"     "methods"

$ Rscript --vanilla -e "getOption('defaultPackages')"
[1] "datasets"  "utils"     "grDevices" "graphics"  "stats"     "methods"

/Henrik

>
> Hadley
>
> On Tue, Apr 19, 2016 at 10:37 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
> > Does it make sense to be able to load an S4 object without the methods
> > package being attached? I'm not sure implementation-wise how easy this
> > would be, but it seems like any time there is an S4 object around, the
> > methods package should be available to deal with it.
> >
> > ~G
> >
> > On Tue, Apr 19, 2016 at 7:34 AM, Michael Lawrence <lawrence.michael at gene.com
> >> wrote:
> >
> >> Right, R_has_methods_attached() uses that. Probably not the right
> >> check, since it refers to S4 dispatch, while S4_extends() is used by
> >> S3 dispatch.
> >>
> >> Perhaps S4_extends() should force load the methods package? The above
> >> example works after fixing the check to ensure that R_MethodsNamespace
> >> is not R_GlobalEnv, but one could load a serialized S4 object and
> >> expect S3 dispatch to work with Rscript.
> >>
> >> On Tue, Apr 19, 2016 at 6:51 AM, Gabriel Becker <gmbecker at ucdavis.edu>
> >> wrote:
> >> > See also .isMethodsDispatchOn, which is what trace uses to decide if the
> >> > methods package needs to be loaded.
> >> >
> >> > ~G
> >> >
> >> > On Tue, Apr 19, 2016 at 5:34 AM, Michael Lawrence
> >> > <lawrence.michael at gene.com> wrote:
> >> >>
> >> >> Not sure why R_has_methods_attached() exists. Maybe Martin could shed
> >> >> some light on that.
> >> >>
> >> >> On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
> >> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
> >> >> > Thanks for looking into it, your approach sounds good to me. See also
> >> >> > R_has_methods_attached()
> >> >> >
> >> >> > (
> >> https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265
> >> ).
> >> >> >
> >> >> > I'm fine with Rscript not loading "methods", as long as everything
> >> works
> >> >> > properly with "methods" loaded but not attached.
> >> >> >
> >> >> >
> >> >> > -Kirill
> >> >> >
> >> >> >
> >> >> >
> >> >> > On 19.04.2016 04:10, Michael Lawrence wrote:
> >> >> >>
> >> >> >> Right, the methods package is not attached by default when running R
> >> >> >> with Rscript. We should probably remove that special case, as it
> >> >> >> mostly just leads to confusion, but that won't happen immediately.
> >> >> >>
> >> >> >> For now, the S4_extends() should probably throw an error when the
> >> >> >> methods namespace is not loaded. And the check should be changed to
> >> >> >> directly check whether R_MethodsNamespace has been set to something
> >> >> >> other than the default (R_GlobalEnv). Agreed?
> >> >> >>
> >> >> >> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
> >> >> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
> >> >> >>>
> >> >> >>> Scenario: An S3 method is declared for an S4 base class but called
> >> for
> >> >> >>> an
> >> >> >>> instance of a derived class.
> >> >> >>>
> >> >> >>> Steps to reproduce:
> >> >> >>>
> >> >> >>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix
> >> <-
> >> >> >>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
> >> >> >>>
> >> >> >>> Error in UseMethod("test", x) :
> >> >> >>>    no applicable method for 'test' applied to an object of class
> >> >> >>> "lsyMatrix"
> >> >> >>> Calls: <Anonymous>
> >> >> >>> 1: MatrixDispatchTest::test(Matrix::Matrix())
> >> >> >>>
> >> >> >>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test',
> >> x);
> >> >> >>>> test.Matrix <- function(x) 'Hi';
> >> >> >>>> MatrixDispatchTest::test(Matrix::Matrix())"
> >> >> >>>
> >> >> >>> [1] "Hi"
> >> >> >>>
> >> >> >>> To me, it looks like a sanity check in line 655 of src/main/attrib.c
> >> >> >>> is
> >> >> >>> making wrong assumptions, but there might be other reasons.
> >> >> >>>
> >> >> >>>
> >> >> >>> (
> >> https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656
> >> )
> >> >> >>>
> >> >> >>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
> >> >> >>>
> >> >> >>>
> >> >> >>> Best regards
> >> >> >>>
> >> >> >>> Kirill
> >> >> >>>
> >> >> >>> ______________________________________________
> >> >> >>> R-devel at r-project.org mailing list
> >> >> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >> >>>
> >> >> >
> >> >> >
> >> >>
> >> >> ______________________________________________
> >> >> R-devel at r-project.org mailing list
> >> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >
> >> >
> >> >
> >> >
> >> > --
> >> > Gabriel Becker, PhD
> >> > Associate Scientist (Bioinformatics)
> >> > Genentech Research
> >>
> >
> >
> >
> > --
> > Gabriel Becker, PhD
> > Associate Scientist (Bioinformatics)
> > Genentech Research
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
> --
> http://hadley.nz
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From edd at debian.org  Tue Apr 19 20:41:17 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 19 Apr 2016 13:41:17 -0500
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CABdHhvF5K2eU5_kHhxvx++hjKEZsx7hi3j9PxW3fGZCpJ_nLuQ@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
	<CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
	<CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>
	<CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>
	<CABdHhvF5K2eU5_kHhxvx++hjKEZsx7hi3j9PxW3fGZCpJ_nLuQ@mail.gmail.com>
Message-ID: <22294.31693.512491.43642@max.nulle.part>


On 19 April 2016 at 11:21, Hadley Wickham wrote:
| This might be too big a change - but is it worth reconsidering the
| behaviour of Rscript? Maybe the simplest fix would be simply to always
| load the methods package.  (I think historically it didn't because
| loading methods took a long time, but that is no longer true)

FWIW littler has always loaded package 'methods' at startup (because I found
this Rscript 'feature' to be too insufferable) -- and of course still starts
in about half the time as Rscript.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From lawrence.michael at gene.com  Tue Apr 19 22:23:02 2016
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 19 Apr 2016 13:23:02 -0700
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
	<CADwqtCNTFaEXauZKfgMX5tV0=b5L2N4gdCG+ZtCn2RGijo4B-w@mail.gmail.com>
	<CAOQ5NycZgF_sF6Ef90etRkEYL2-GzFGM08+Ff8RRjtURJYk=yA@mail.gmail.com>
	<CADwqtCP9Vk4U-axT0_4CiiOx0T_Ance9=L7yVz-B0RJK+bgfvA@mail.gmail.com>
Message-ID: <CAOQ5Nyf2Bb5icM3AjmiYY1YpYhweSgvDtduKySeQMQbMeUYtwg@mail.gmail.com>

Agreed about Rscript being consistent R.

For now, I'll modify S4_extends() so that it leads to S4 dispatch when
dispatch is turned on (not just when methods is attached).

On Tue, Apr 19, 2016 at 8:37 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:
> Does it make sense to be able to load an S4 object without the methods
> package being attached? I'm not sure implementation-wise how easy this would
> be, but it seems like any time there is an S4 object around, the methods
> package should be available to deal with it.
>
> ~G
>
> On Tue, Apr 19, 2016 at 7:34 AM, Michael Lawrence
> <lawrence.michael at gene.com> wrote:
>>
>> Right, R_has_methods_attached() uses that. Probably not the right
>> check, since it refers to S4 dispatch, while S4_extends() is used by
>> S3 dispatch.
>>
>> Perhaps S4_extends() should force load the methods package? The above
>> example works after fixing the check to ensure that R_MethodsNamespace
>> is not R_GlobalEnv, but one could load a serialized S4 object and
>> expect S3 dispatch to work with Rscript.
>>
>> On Tue, Apr 19, 2016 at 6:51 AM, Gabriel Becker <gmbecker at ucdavis.edu>
>> wrote:
>> > See also .isMethodsDispatchOn, which is what trace uses to decide if the
>> > methods package needs to be loaded.
>> >
>> > ~G
>> >
>> > On Tue, Apr 19, 2016 at 5:34 AM, Michael Lawrence
>> > <lawrence.michael at gene.com> wrote:
>> >>
>> >> Not sure why R_has_methods_attached() exists. Maybe Martin could shed
>> >> some light on that.
>> >>
>> >> On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
>> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> >> > Thanks for looking into it, your approach sounds good to me. See also
>> >> > R_has_methods_attached()
>> >> >
>> >> >
>> >> > (https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265).
>> >> >
>> >> > I'm fine with Rscript not loading "methods", as long as everything
>> >> > works
>> >> > properly with "methods" loaded but not attached.
>> >> >
>> >> >
>> >> > -Kirill
>> >> >
>> >> >
>> >> >
>> >> > On 19.04.2016 04:10, Michael Lawrence wrote:
>> >> >>
>> >> >> Right, the methods package is not attached by default when running R
>> >> >> with Rscript. We should probably remove that special case, as it
>> >> >> mostly just leads to confusion, but that won't happen immediately.
>> >> >>
>> >> >> For now, the S4_extends() should probably throw an error when the
>> >> >> methods namespace is not loaded. And the check should be changed to
>> >> >> directly check whether R_MethodsNamespace has been set to something
>> >> >> other than the default (R_GlobalEnv). Agreed?
>> >> >>
>> >> >> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
>> >> >> <kirill.mueller at ivt.baug.ethz.ch> wrote:
>> >> >>>
>> >> >>> Scenario: An S3 method is declared for an S4 base class but called
>> >> >>> for
>> >> >>> an
>> >> >>> instance of a derived class.
>> >> >>>
>> >> >>> Steps to reproduce:
>> >> >>>
>> >> >>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix
>> >> >>>> <-
>> >> >>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
>> >> >>>
>> >> >>> Error in UseMethod("test", x) :
>> >> >>>    no applicable method for 'test' applied to an object of class
>> >> >>> "lsyMatrix"
>> >> >>> Calls: <Anonymous>
>> >> >>> 1: MatrixDispatchTest::test(Matrix::Matrix())
>> >> >>>
>> >> >>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test',
>> >> >>>> x);
>> >> >>>> test.Matrix <- function(x) 'Hi';
>> >> >>>> MatrixDispatchTest::test(Matrix::Matrix())"
>> >> >>>
>> >> >>> [1] "Hi"
>> >> >>>
>> >> >>> To me, it looks like a sanity check in line 655 of
>> >> >>> src/main/attrib.c
>> >> >>> is
>> >> >>> making wrong assumptions, but there might be other reasons.
>> >> >>>
>> >> >>>
>> >> >>>
>> >> >>> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
>> >> >>>
>> >> >>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
>> >> >>>
>> >> >>>
>> >> >>> Best regards
>> >> >>>
>> >> >>> Kirill
>> >> >>>
>> >> >>> ______________________________________________
>> >> >>> R-devel at r-project.org mailing list
>> >> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >> >>>
>> >> >
>> >> >
>> >>
>> >> ______________________________________________
>> >> R-devel at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>> >
>> >
>> >
>> > --
>> > Gabriel Becker, PhD
>> > Associate Scientist (Bioinformatics)
>> > Genentech Research
>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research


From J.Gorecki at wit.edu.pl  Wed Apr 20 00:53:21 2016
From: J.Gorecki at wit.edu.pl (=?UTF-8?B?SmFuIEfDs3JlY2tp?=)
Date: Tue, 19 Apr 2016 23:53:21 +0100
Subject: [Rd] R-exts update for new *check* argument in R 3.3.0
Message-ID: <CABE2sp5cJk0gLOY-FT2B2XgE_U1YQxcUATt2MXKiUj7G8NE1pA@mail.gmail.com>

Hello dear dev team,

In the recent devel R-exts manual I cannot find any information about new
option `--ignore-vignettes` to `R CMD check`. I would expect it to be
mentioned somewhere in "1.4.2 Non-Sweave vignettes".

Checked on https://cran.r-project.org/doc/manuals/r-devel/R-exts.html and
https://github.com/wch/r-source/blob/trunk/doc/manual/R-exts.texi

Regards,
Jan Gorecki

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Wed Apr 20 10:35:03 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 20 Apr 2016 10:35:03 +0200
Subject: [Rd] S3 dispatch for S4 subclasses only works if variable
 "extends" is accessible from global environment
In-Reply-To: <CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
References: <57156F2B.4000205@ivt.baug.ethz.ch>
	<CAOQ5NyfK-67N6yHgdP-_Nr8=i34d7zkiR9J6OYFnCtN6_A=fjA@mail.gmail.com>
	<5715D528.6030101@ivt.baug.ethz.ch>
	<CAOQ5NyfBrX=DUVdf66g5fWeubnqNUeaT-yJYYiuQB2-MkHk1Xw@mail.gmail.com>
Message-ID: <22295.16183.799419.6428@stat.math.ethz.ch>

>>>>> Michael Lawrence <lawrence.michael at gene.com>
>>>>>     on Tue, 19 Apr 2016 05:34:41 -0700 writes:

    > Not sure why R_has_methods_attached() exists. Maybe Martin could shed
    > some light on that.

It was to support (via 'classgets' in attrib.c) a very fast

   class(.) <- "<newclass>"

for S4 objects... to be used in  setAs(......)  methods,
e.g., for the Matrix package where you have many classes with
most slots the same, and I would have wanted to be clearly
faster than calling
   new("<newclass>", x=.., y=.., z=.., u=..,v=.. ..)

But that experiment has not finalized, maybe because it was a too hackish idea.

I may have started writing that at a time where we still mostly
thought that it was not possible to have a working S4 R
"environment" where methods was only loaded but not attached.

In conclusion, you can consider R_has_methods_attached as non-existent.


    > On Mon, Apr 18, 2016 at 11:50 PM, Kirill M?ller
    > <kirill.mueller at ivt.baug.ethz.ch> wrote:
    >> Thanks for looking into it, your approach sounds good to me. See also
    >> R_has_methods_attached()
    >> (https://github.com/wch/r-source/blob/42ecf5f492a005f5398cbb4c9becd4aa5af9d05c/src/main/objects.c#L258-L265).
    >> 
    >> I'm fine with Rscript not loading "methods", as long as everything works
    >> properly with "methods" loaded but not attached.
    >> 
    >> 
    >> -Kirill
    >> 
    >> 
    >> 
    >> On 19.04.2016 04:10, Michael Lawrence wrote:
    >>> 
    >>> Right, the methods package is not attached by default when running R
    >>> with Rscript. We should probably remove that special case, as it
    >>> mostly just leads to confusion, but that won't happen immediately.
    >>> 
    >>> For now, the S4_extends() should probably throw an error when the
    >>> methods namespace is not loaded. And the check should be changed to
    >>> directly check whether R_MethodsNamespace has been set to something
    >>> other than the default (R_GlobalEnv). Agreed?
    >>> 
    >>> On Mon, Apr 18, 2016 at 4:35 PM, Kirill M?ller
    >>> <kirill.mueller at ivt.baug.ethz.ch> wrote:
    >>>> 
    >>>> Scenario: An S3 method is declared for an S4 base class but called for an
    >>>> instance of a derived class.
    >>>> 
    >>>> Steps to reproduce:
    >>>> 
    >>>>> Rscript -e "test <- function(x) UseMethod('test', x); test.Matrix <-
    >>>>> function(x) 'Hi'; MatrixDispatchTest::test(Matrix::Matrix())"
    >>>> 
    >>>> Error in UseMethod("test", x) :
    >>>> no applicable method for 'test' applied to an object of class
    >>>> "lsyMatrix"
    >>>> Calls: <Anonymous>
    >>>> 1: MatrixDispatchTest::test(Matrix::Matrix())
    >>>> 
    >>>>> Rscript -e "extends <- 42; test <- function(x) UseMethod('test', x);
    >>>>> test.Matrix <- function(x) 'Hi';
    >>>>> MatrixDispatchTest::test(Matrix::Matrix())"
    >>>> 
    >>>> [1] "Hi"
    >>>> 
    >>>> To me, it looks like a sanity check in line 655 of src/main/attrib.c is
    >>>> making wrong assumptions, but there might be other reasons.
    >>>> 
    >>>> (https://github.com/wch/r-source/blob/780021752eb83a71e2198019acf069ba8741103b/src/main/attrib.c#L655-L656)
    >>>> 
    >>>> Same behavior in R 3.2.4, R 3.2.5 and R-devel r70420.
    >>>> 
    >>>> 
    >>>> Best regards
    >>>> 
    >>>> Kirill
    >>>> 
    >>>> ______________________________________________
    >>>> R-devel at r-project.org mailing list
    >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>>> 
    >> 
    >> 

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Wed Apr 20 15:38:35 2016
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 20 Apr 2016 14:38:35 +0100
Subject: [Rd] R-exts update for new *check* argument in R 3.3.0
In-Reply-To: <CABE2sp5cJk0gLOY-FT2B2XgE_U1YQxcUATt2MXKiUj7G8NE1pA@mail.gmail.com>
References: <CABE2sp5cJk0gLOY-FT2B2XgE_U1YQxcUATt2MXKiUj7G8NE1pA@mail.gmail.com>
Message-ID: <5717865B.2060305@stats.ox.ac.uk>

On 19/04/2016 23:53, Jan G?recki wrote:
> Hello dear dev team,
>
> In the recent devel R-exts manual I cannot find any information about new
> option `--ignore-vignettes` to `R CMD check`. I would expect it to be
> mentioned somewhere in "1.4.2 Non-Sweave vignettes".

Which is a subsection of ?1.4 'Writing package vignettes', so your 
expectations are misplaced: it is nothing to do with *writing*.

> Checked on https://cran.r-project.org/doc/manuals/r-devel/R-exts.html and
> https://github.com/wch/r-source/blob/trunk/doc/manual/R-exts.texi

Where does it say that all the possible arguments to 'check' are 
documented in the manual?  It says otherwise in ?1.3.1:

'Use R CMD check --help to obtain more information about the usage of 
the R package checker.  A subset of the checking steps can be selected 
by adding command-line options.'

R CMD check --help includes

       --ignore-vignettes    skip all tests on vignettes

[This is really intended for those doing automated checking, not end users.]

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From wdunlap at tibco.com  Wed Apr 20 20:58:47 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 20 Apr 2016 11:58:47 -0700
Subject: [Rd] locked environments
Message-ID: <CAF8bMcbzg21p50PAHdFoicrGSWcY6P0=LXHRmLN8huNjGUmCbw@mail.gmail.com>

Shouldn't the following 4 ways to alter an object in a locked environment
either all work or all fail?  (All working would be nice, I think.)

   E <- new.env()
   assign("var", c(1,2,3,4), envir=E)
   lockEnvironment(E, bindings=FALSE)
   E$var[1] <- 101 ; E$var
   #[1] 101   2   3
   local(var[2] <- 102, envir=E)
   #Error in eval(expr, envir, enclos) :
   #  cannot add bindings to a locked environment
   with(E, var[3] <- 103)
   #Error in eval(expr, envir, enclos) :
   #  cannot add bindings to a locked environment
   eval(quote(var[4] <- 104), envir=E)
   #Error in eval(expr, envir, enclos) :
   #  cannot add bindings to a locked environment
   get("var", envir=E)
   #[1] 101   2   3   4


Bill Dunlap
TIBCO Software
wdunlap tibco.com

	[[alternative HTML version deleted]]


From mark.dalphin at pacificedge.co.nz  Thu Apr 21 00:50:31 2016
From: mark.dalphin at pacificedge.co.nz (Mark Dalphin)
Date: Thu, 21 Apr 2016 10:50:31 +1200
Subject: [Rd] Fresh build from source of R-3.2.5 failing "make check" under
 64-bit Ubuntu
Message-ID: <571807B7.2070603@pacificedge.co.nz>

Hi,

Let me justify building R from source. While I can obtain R built for me
under Ubuntu, I tend to build it from scratch as we use a NFS-shared
build as well as shared R libraries for all the bioinfo staff at this
company. Only one build and one set of packages to ensure uniformity
across all workstations.

My problem is that despite using a pretty standard build process, I am
failing at the "make check" step. I don't see what I might have done
that is causing the failure.

My platform is:

> uname -a
Linux littlebourne 3.13.0-85-generic #129-Ubuntu SMP Thu Mar 17 20:50:15
UTC 2016 x86_64 x86_64 x86_64 GNU/Linux

> cat /etc/issue
Ubuntu 14.04.4 LTS \n \l

I've downloaded the recent R-3.2.5 tar-gz file and gone through the
standard build, though in a non-standard location. I keep copies of the
tar-gzipped file in an "Archive" directory.

> gunzip -c Archive/R-3.2.5.tar.gz | tar xf -
> cd R-3.2.5/
> ./configure --prefix=/opt/apps/x86_64/R/R-3.2.5 LIBnn=lib
[ ... much output ...]
R is now configured for x86_64-pc-linux-gnu

  Source directory:          .
  Installation directory:    /opt/apps/x86_64/R/R-3.2.5

  C compiler:                gcc -std=gnu99  -g -O2
  Fortran 77 compiler:       gfortran  -g -O2

  C++ compiler:              g++  -g -O2
  C++ 11 compiler:           g++  -std=c++11 -g -O2
  Fortran 90/95 compiler:    gfortran -g -O2
  Obj-C compiler:         gcc -g -O2 -fobjc-exceptions

  Interfaces supported:      X11, tcltk
  External libraries:        readline, zlib, bzlib, lzma, PCRE
  Additional capabilities:   PNG, JPEG, TIFF, NLS, cairo
  Options enabled:           shared BLAS, R profiling

  Capabilities skipped:      ICU
  Options not enabled:       memory profiling

  Recommended packages:      yes

# Note: I use tcsh, not bash
> make >& make.out &
# There are no obvious errors and the 'make' proceeds finally through
some Java configuration
# and then exits with a zero status.

> make check >& make_check.out &
[ ... much output captured ...]
make[3]: Entering directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
running code in 'reg-tests-1a.R' ... OK
running code in 'reg-tests-1b.R' ... OK
running code in 'reg-tests-1c.R' ... OK
running code in 'reg-tests-2.R' ... OK
  comparing 'reg-tests-2.Rout' to './reg-tests-2.Rout.save' ... OK
running code in 'reg-examples1.R' ... OK
running code in 'reg-examples2.R' ... OK
running code in 'reg-packages.R' ...make[3]: *** [reg-packages.Rout] Error 1
make[3]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
make[2]: *** [test-Reg] Error 2
make[2]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
make: *** [check] Error 2

> cd tests
> tail -30 reg-packages.Rout.fail
*** installing help indices
** building package indices
** testing if installed package can be loaded
* DONE (pkgB)
Loading required package: pkgB
building package exNSS4 ...

installing package exNSS4 using file exNSS4_1.1.tar.gz ...
* installing *source* package 'exNSS4' ...
** R
** preparing package for lazy loading
Creating a generic function for 'plot' from package 'graphics' in
package 'exNSS4'
** help
No man pages found in package  'exNSS4'
*** installing help indices
** building package indices
** testing if installed package can be loaded
* DONE (exNSS4)
Loading required package: exNSS4
> (res <- installed.packages(lib.loc = "myLib", priority = "NA"))
      Package LibPath Version Priority Depends   Imports LinkingTo Suggests
myTst "myTst" "myLib" "1.0"   NA       "methods" NA      NA        NA     
      Enhances License                     License_is_FOSS
myTst NA       "What license is it under?" NA            
      License_restricts_use OS_type MD5sum NeedsCompilation Built 
myTst NA                    NA      NA     NA               "3.2.5"
> stopifnot(identical(res[,"Package"], setNames(,sort(c(p.lis, "myTst")))),
+       res[,"LibPath"] == "myLib")
Error: identical(res[, "Package"], setNames(, sort(c(p.lis, "myTst"))))
is not TRUE
Execution halted

> ls myLib
exNSS4  myTst  pkgA  pkgB

So, it looks like the "installed.packages()" is not correctly detecting
what is present in "myLib".

Has anyone else seen this? Has anyone got any ideas about what is going
wrong? My environment does not include R_LIBS, LD_LIBRARY, etc. The PATH
does include an older version of R, 3.1.1.

Regards,
Mark Dalphin


From kikx_francisco at hotmail.com  Thu Apr 21 10:23:32 2016
From: kikx_francisco at hotmail.com (Francisco Banha)
Date: Thu, 21 Apr 2016 09:23:32 +0100
Subject: [Rd] Benchmarks for R
Message-ID: <DUB130-W65EDC35C02A149A2468606856E0@phx.gbl>

Hello,

I'm currently working on a project where I have to make chages to the source code of R itself. By doing this it's possible that I mess something up and make R stop working correctly.
Can anyone tell me if there are some benchmarks that test the whole R language or at least the most important part of it?
Thank you.

Best regards,
Francisco
 		 	   		  
	[[alternative HTML version deleted]]


From pdalgd at gmail.com  Thu Apr 21 10:34:57 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 21 Apr 2016 10:34:57 +0200
Subject: [Rd] Benchmarks for R
In-Reply-To: <DUB130-W65EDC35C02A149A2468606856E0@phx.gbl>
References: <DUB130-W65EDC35C02A149A2468606856E0@phx.gbl>
Message-ID: <67876136-FC4A-4582-B09A-395C2E1E4A1A@gmail.com>

make check-all 

?

On 21 Apr 2016, at 10:23 , Francisco Banha <kikx_francisco at hotmail.com> wrote:

> Hello,
> 
> I'm currently working on a project where I have to make chages to the source code of R itself. By doing this it's possible that I mess something up and make R stop working correctly.
> Can anyone tell me if there are some benchmarks that test the whole R language or at least the most important part of it?
> Thank you.
> 
> Best regards,
> Francisco
> 		 	   		  
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From alberto.fernandez at urv.cat  Thu Apr 21 11:37:10 2016
From: alberto.fernandez at urv.cat (=?iso-8859-1?Q?Alberto_Fern=E1ndez_Sabater?=)
Date: Thu, 21 Apr 2016 09:37:10 +0000
Subject: [Rd] "cophenetic" function for objects of class "dendrogram"
Message-ID: <VI1PR01MB138950829C65980A4FF9CC01F56E0@VI1PR01MB1389.eurprd01.prod.exchangelabs.com>

Hello,


I have been using the "cophenetic" function for objects of class "dendrogram" and I have realised that it gives different results when it is used with objects of class "hclust". For instance, running the first example in the help file of the "cophenetic" function,


d1 <- dist(USArrests)

hc <- hclust(d1, "ave")

d2 <- cophenetic(hc)

cor(d1, d2)  # 0.7659


the result given is different to the one obtained using an object of class "dendrogram",


dendro <- as.dendrogram(hc)

d3 <- cophenetic(dendro)

cor(d1, d3)  # 0.0151


I think that it would be desirable to obtain the same result with all the "cophenetic" methods, irrespectively of the class of the object used. If this is not possible, users could be warned in the help file.


Thanks,

Alberto Fernandez


	[[alternative HTML version deleted]]


From pdalgd at gmail.com  Thu Apr 21 13:20:18 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 21 Apr 2016 13:20:18 +0200
Subject: [Rd] Fresh build from source of R-3.2.5 failing "make check"
	under 64-bit Ubuntu
In-Reply-To: <571807B7.2070603@pacificedge.co.nz>
References: <571807B7.2070603@pacificedge.co.nz>
Message-ID: <A32AC8B9-F509-4A2C-9DF8-F6E2C4199192@gmail.com>

Hmm. I don't think this has been seen by other Ubuntu users, or other Linuxen for that matter. 

You have a gratuitous use of "&", but I don't really see how that would give these symptoms, unless you accidentally run a command twice, creating a race condition between two background processes. 

More likely it is file system related, like NFS directory caching or maybe permissions, although the latter seems unlikely if one package does install properly. You might want to recheck whether  installed.packages(lib.loc = "myLib", priority = "NA") gives different results a bit later, and if not, check that the package descriptions are sane.

-pd

On 21 Apr 2016, at 00:50 , Mark Dalphin <mark.dalphin at pacificedge.co.nz> wrote:

> Hi,
> 
> Let me justify building R from source. While I can obtain R built for me
> under Ubuntu, I tend to build it from scratch as we use a NFS-shared
> build as well as shared R libraries for all the bioinfo staff at this
> company. Only one build and one set of packages to ensure uniformity
> across all workstations.
> 
> My problem is that despite using a pretty standard build process, I am
> failing at the "make check" step. I don't see what I might have done
> that is causing the failure.
> 
> My platform is:
> 
>> uname -a
> Linux littlebourne 3.13.0-85-generic #129-Ubuntu SMP Thu Mar 17 20:50:15
> UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
> 
>> cat /etc/issue
> Ubuntu 14.04.4 LTS \n \l
> 
> I've downloaded the recent R-3.2.5 tar-gz file and gone through the
> standard build, though in a non-standard location. I keep copies of the
> tar-gzipped file in an "Archive" directory.
> 
>> gunzip -c Archive/R-3.2.5.tar.gz | tar xf -
>> cd R-3.2.5/
>> ./configure --prefix=/opt/apps/x86_64/R/R-3.2.5 LIBnn=lib
> [ ... much output ...]
> R is now configured for x86_64-pc-linux-gnu
> 
>  Source directory:          .
>  Installation directory:    /opt/apps/x86_64/R/R-3.2.5
> 
>  C compiler:                gcc -std=gnu99  -g -O2
>  Fortran 77 compiler:       gfortran  -g -O2
> 
>  C++ compiler:              g++  -g -O2
>  C++ 11 compiler:           g++  -std=c++11 -g -O2
>  Fortran 90/95 compiler:    gfortran -g -O2
>  Obj-C compiler:         gcc -g -O2 -fobjc-exceptions
> 
>  Interfaces supported:      X11, tcltk
>  External libraries:        readline, zlib, bzlib, lzma, PCRE
>  Additional capabilities:   PNG, JPEG, TIFF, NLS, cairo
>  Options enabled:           shared BLAS, R profiling
> 
>  Capabilities skipped:      ICU
>  Options not enabled:       memory profiling
> 
>  Recommended packages:      yes
> 
> # Note: I use tcsh, not bash
>> make >& make.out &
> # There are no obvious errors and the 'make' proceeds finally through
> some Java configuration
> # and then exits with a zero status.
> 
>> make check >& make_check.out &
> [ ... much output captured ...]
> make[3]: Entering directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
> running code in 'reg-tests-1a.R' ... OK
> running code in 'reg-tests-1b.R' ... OK
> running code in 'reg-tests-1c.R' ... OK
> running code in 'reg-tests-2.R' ... OK
>  comparing 'reg-tests-2.Rout' to './reg-tests-2.Rout.save' ... OK
> running code in 'reg-examples1.R' ... OK
> running code in 'reg-examples2.R' ... OK
> running code in 'reg-packages.R' ...make[3]: *** [reg-packages.Rout] Error 1
> make[3]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
> make[2]: *** [test-Reg] Error 2
> make[2]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
> make[1]: *** [test-all-basics] Error 1
> make[1]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
> make: *** [check] Error 2
> 
>> cd tests
>> tail -30 reg-packages.Rout.fail
> *** installing help indices
> ** building package indices
> ** testing if installed package can be loaded
> * DONE (pkgB)
> Loading required package: pkgB
> building package exNSS4 ...
> 
> installing package exNSS4 using file exNSS4_1.1.tar.gz ...
> * installing *source* package 'exNSS4' ...
> ** R
> ** preparing package for lazy loading
> Creating a generic function for 'plot' from package 'graphics' in
> package 'exNSS4'
> ** help
> No man pages found in package  'exNSS4'
> *** installing help indices
> ** building package indices
> ** testing if installed package can be loaded
> * DONE (exNSS4)
> Loading required package: exNSS4
>> (res <- installed.packages(lib.loc = "myLib", priority = "NA"))
>      Package LibPath Version Priority Depends   Imports LinkingTo Suggests
> myTst "myTst" "myLib" "1.0"   NA       "methods" NA      NA        NA     
>      Enhances License                     License_is_FOSS
> myTst NA       "What license is it under?" NA            
>      License_restricts_use OS_type MD5sum NeedsCompilation Built 
> myTst NA                    NA      NA     NA               "3.2.5"
>> stopifnot(identical(res[,"Package"], setNames(,sort(c(p.lis, "myTst")))),
> +       res[,"LibPath"] == "myLib")
> Error: identical(res[, "Package"], setNames(, sort(c(p.lis, "myTst"))))
> is not TRUE
> Execution halted
> 
>> ls myLib
> exNSS4  myTst  pkgA  pkgB
> 
> So, it looks like the "installed.packages()" is not correctly detecting
> what is present in "myLib".
> 
> Has anyone else seen this? Has anyone got any ideas about what is going
> wrong? My environment does not include R_LIBS, LD_LIBRARY, etc. The PATH
> does include an older version of R, 3.1.1.
> 
> Regards,
> Mark Dalphin
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From wdunlap at tibco.com  Thu Apr 21 16:59:37 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 21 Apr 2016 07:59:37 -0700
Subject: [Rd] "cophenetic" function for objects of class "dendrogram"
In-Reply-To: <VI1PR01MB138950829C65980A4FF9CC01F56E0@VI1PR01MB1389.eurprd01.prod.exchangelabs.com>
References: <VI1PR01MB138950829C65980A4FF9CC01F56E0@VI1PR01MB1389.eurprd01.prod.exchangelabs.com>
Message-ID: <CAF8bMcahx7fiNhmTjW7Qpnrgoi5UbXepBce8PYtRk_ms76upfw@mail.gmail.com>

I think the results differ only in the order of the labels.  The following
function
puts the labels in a standard order and then the results are the same:

  canonicalize.dist <- function (distObject)
  {
      o <- order(labels(distObject))
      as.matrix(distObject)[o, o, drop = FALSE]
  }
  identical(canonicalize.dist(d2), canonicalize.dist(d3))
  [1] TRUE




Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Apr 21, 2016 at 2:37 AM, Alberto Fern?ndez Sabater <
alberto.fernandez at urv.cat> wrote:

> Hello,
>
>
> I have been using the "cophenetic" function for objects of class
> "dendrogram" and I have realised that it gives different results when it is
> used with objects of class "hclust". For instance, running the first
> example in the help file of the "cophenetic" function,
>
>
> d1 <- dist(USArrests)
>
> hc <- hclust(d1, "ave")
>
> d2 <- cophenetic(hc)
>
> cor(d1, d2)  # 0.7659
>
>
> the result given is different to the one obtained using an object of class
> "dendrogram",
>
>
> dendro <- as.dendrogram(hc)
>
> d3 <- cophenetic(dendro)
>
> cor(d1, d3)  # 0.0151
>
>
> I think that it would be desirable to obtain the same result with all the
> "cophenetic" methods, irrespectively of the class of the object used. If
> this is not possible, users could be warned in the help file.
>
>
> Thanks,
>
> Alberto Fernandez
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Thu Apr 21 18:38:12 2016
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 21 Apr 2016 09:38:12 -0700
Subject: [Rd] "cophenetic" function for objects of class "dendrogram"
In-Reply-To: <CAF8bMcahx7fiNhmTjW7Qpnrgoi5UbXepBce8PYtRk_ms76upfw@mail.gmail.com>
References: <VI1PR01MB138950829C65980A4FF9CC01F56E0@VI1PR01MB1389.eurprd01.prod.exchangelabs.com>
	<CAF8bMcahx7fiNhmTjW7Qpnrgoi5UbXepBce8PYtRk_ms76upfw@mail.gmail.com>
Message-ID: <CAF8bMcaRhvbsYK1nguXEf0sCo-9w4qkXK6DzC0BbkPA6epHz1g@mail.gmail.com>

Note that cophenetic.default (which works on the output of hclust(dist(X)))
uses the
row names of X as labels.  as.dendrogram.hclust does not retain those row
names
so cophenetic.dendrogram cannot use them (so it orders them based on the
topology of the dendrogram).

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Apr 21, 2016 at 7:59 AM, William Dunlap <wdunlap at tibco.com> wrote:

> I think the results differ only in the order of the labels.  The following
> function
> puts the labels in a standard order and then the results are the same:
>
>   canonicalize.dist <- function (distObject)
>   {
>       o <- order(labels(distObject))
>       as.matrix(distObject)[o, o, drop = FALSE]
>   }
>   identical(canonicalize.dist(d2), canonicalize.dist(d3))
>   [1] TRUE
>
>
>
>
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
>
> On Thu, Apr 21, 2016 at 2:37 AM, Alberto Fern?ndez Sabater <
> alberto.fernandez at urv.cat> wrote:
>
>> Hello,
>>
>>
>> I have been using the "cophenetic" function for objects of class
>> "dendrogram" and I have realised that it gives different results when it is
>> used with objects of class "hclust". For instance, running the first
>> example in the help file of the "cophenetic" function,
>>
>>
>> d1 <- dist(USArrests)
>>
>> hc <- hclust(d1, "ave")
>>
>> d2 <- cophenetic(hc)
>>
>> cor(d1, d2)  # 0.7659
>>
>>
>> the result given is different to the one obtained using an object of
>> class "dendrogram",
>>
>>
>> dendro <- as.dendrogram(hc)
>>
>> d3 <- cophenetic(dendro)
>>
>> cor(d1, d3)  # 0.0151
>>
>>
>> I think that it would be desirable to obtain the same result with all the
>> "cophenetic" methods, irrespectively of the class of the object used. If
>> this is not possible, users could be warned in the help file.
>>
>>
>> Thanks,
>>
>> Alberto Fernandez
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>

	[[alternative HTML version deleted]]


From luke-tierney at uiowa.edu  Thu Apr 21 22:34:18 2016
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Thu, 21 Apr 2016 15:34:18 -0500
Subject: [Rd] locked environments
In-Reply-To: <CAF8bMcbzg21p50PAHdFoicrGSWcY6P0=LXHRmLN8huNjGUmCbw@mail.gmail.com>
References: <CAF8bMcbzg21p50PAHdFoicrGSWcY6P0=LXHRmLN8huNjGUmCbw@mail.gmail.com>
Message-ID: <alpine.DEB.2.10.1604211531220.3865@luke-Latitude>

Ideally they should all work. What is happening is that the current
implementation of complex assignment wants to use a temporary variable
named *tmp*, which it can't when the evaluation environment is locked.
Assignments in compiled code use a different mechanism that I hope
will eventually be ported to the interpreter. Then these should all
work.

Best,

luke

On Wed, 20 Apr 2016, William Dunlap via R-devel wrote:

> Shouldn't the following 4 ways to alter an object in a locked environment
> either all work or all fail?  (All working would be nice, I think.)
>
>   E <- new.env()
>   assign("var", c(1,2,3,4), envir=E)
>   lockEnvironment(E, bindings=FALSE)
>   E$var[1] <- 101 ; E$var
>   #[1] 101   2   3
>   local(var[2] <- 102, envir=E)
>   #Error in eval(expr, envir, enclos) :
>   #  cannot add bindings to a locked environment
>   with(E, var[3] <- 103)
>   #Error in eval(expr, envir, enclos) :
>   #  cannot add bindings to a locked environment
>   eval(quote(var[4] <- 104), envir=E)
>   #Error in eval(expr, envir, enclos) :
>   #  cannot add bindings to a locked environment
>   get("var", envir=E)
>   #[1] 101   2   3   4
>
>
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From mark.dalphin at pacificedge.co.nz  Fri Apr 22 00:25:41 2016
From: mark.dalphin at pacificedge.co.nz (Mark Dalphin)
Date: Thu, 21 Apr 2016 22:25:41 +0000
Subject: [Rd] Fresh build from source of R-3.2.5 failing "make check"
 under 64-bit Ubuntu [SOLVED]
In-Reply-To: <571943ED.3010002@pacificedge.co.nz>
References: <571807B7.2070603@pacificedge.co.nz>
	<A32AC8B9-F509-4A2C-9DF8-F6E2C4199192@gmail.com>
	<5718C38C.4010305@stats.ox.ac.uk>
	<840078C9-E0FB-48CB-80C3-5C18CF276D12@gmail.com>,
	<571943ED.3010002@pacificedge.co.nz>
Message-ID: <SYXPR01MB00930EF6CA87A542FFD8640EDB6E0@SYXPR01MB0093.ausprd01.prod.outlook.com>

Testing for an NFS effect on the failure of 'make check':

Try first on /usr/local/

    9:42	cd /usr/local/src/
    9:42	sudo mkdir R
    9:43	 sudo chown mdalphin:mdalphin R
    9:43	 cd R
    9:43	 gunzip -c /opt/apps/x86_64/R/Archive/R-3.2.5.tar.gz | tar xf -
    9:43	 cd R-3.2.5/
    9:44	 ./configure --prefix=/opt/apps/x86_64/R/R-3.2.5 LIBnn=lib
    9:44	 make
    9:57	 make check

This PASSES all tests. Exit status of ZERO. 
  
Now try on NFS:

10:04	 cd /opt/apps/x86_64/R/src/
10:05	 gunzip -c /opt/apps/x86_64/R/Archive/R-3.2.5.tar.gz | tar xf -
10:06	cd R-3.2.5/
10:06	./configure --prefix=/opt/apps/x86_64/R/R-3.2.5 LIBnn=lib
10:06	make
10:14	 make check
 This FAILS (see below). Exit status of NON-ZERO:

running code in 'reg-packages.R' ...make[3]: *** [reg-packages.Rout] Error 1
make[3]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
make[2]: *** [test-Reg] Error 2
make[2]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
make: *** [check] Error 2

What might be different?

> ls -ld /opt/apps/x86_64/R/src/R-3.2.5/ /usr/local/src/R/R-3.2.5/
drwxr-xr-x 15 mdalphin mdalphin 4096 Apr 22 09:57 /opt/apps/x86_64/R/src/R-3.2.5/
drwxr-xr-x 15 mdalphin mdalphin 4096 Apr 22 09:50 /usr/local/src/R/R-3.2.5/

> mount | grep /opt/
myHost.science:/mnt/home/opt/apps on /opt/apps type nfs (rw,soft,bg,nfsvers=3,addr=XXX.XXX.XXX.XXX)

Just the NFS, I guess. This is not good, but not an R-Devel problem.

Thanks for the help.

Cheers,

Mark Dalphin PhD

Director of Bioinformatics
mark.dalphin at pacificedge.co.nz
Ph: +64 3 479 4690
Cell: +64 21 156 7625
Skype: mark.dalphin.pel

________________________________

87 St David St, PO Box 56, Dunedin, New Zealand 9016    www.pacificedgedx.com


________________________________________
From: Mark Dalphin <mark.dalphin at pacificedge.co.nz>
Sent: Friday, 22 April 2016 9:19
To: peter dalgaard; Prof Brian Ripley
Subject: Re: [Rd] Fresh build from source of R-3.2.5 failing "make check" under 64-bit Ubuntu

I have run it both ways; for the purposes of this email, it was easier
to capture both STDOUT and STDERR ( '>&') into one file and have the
process run in the background (second '&'). That way I could more
readily capture the exact commands used and not have them scroll off the
top of the screen (make's output is quite large). The exact same error
occurs when I run the 'make' command as:

    ./configure PARAMETERS
    make
    make check

It is on an NFS file system; I'll look into building on a local file
system (/usr/local/) and see if I get the same errors.

Cheers,
Mark Dalphin


On 22/04/16 00:35, peter dalgaard wrote:
> On 21 Apr 2016, at 14:11 , Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>
>> On 21/04/2016 12:20, peter dalgaard wrote:
>>> Hmm. I don't think this has been seen by other Ubuntu users, or other Linuxen for that matter.
>>>
>>> You have a gratuitous use of "&", but I don't really see how that would give these symptoms, unless you accidentally run a command twice, creating a race condition between two background processes.
>> He did say he used tcsh, for which >& is legal and far more memorable than (goes to look it up to get the order right) >foo 2>&1
> I know (old tcsh user, before bash got traction[*], in fact). It was the "&" at the end that I was talking about:
>
> make check >& make_check.out &
>
> This runs make in the background and redirects stdout/err to a file. As I said, it is most likely harmless unless you accidentally get two processes running at the same time, but I think I'd try runnning in the foreground, just in case.
>
> -pd
>
> [*] That'll be before Linux; the first versions of Slackware used bash (ash for boot disks). So... like 1991, 25 years back. Yikes!
>
>>> More likely it is file system related, like NFS directory caching or maybe permissions, although the latter seems unlikely if one package does install properly. You might want to recheck whether  installed.packages(lib.loc = "myLib", priority = "NA") gives different results a bit later, and if not, check that the package descriptions are sane.
>>>
>>> -pd
>>>
>>> On 21 Apr 2016, at 00:50 , Mark Dalphin <mark.dalphin at pacificedge.co.nz> wrote:
>>>
>>>> Hi,
>>>>
>>>> Let me justify building R from source. While I can obtain R built for me
>>>> under Ubuntu, I tend to build it from scratch as we use a NFS-shared
>>>> build as well as shared R libraries for all the bioinfo staff at this
>>>> company. Only one build and one set of packages to ensure uniformity
>>>> across all workstations.
>>>>
>>>> My problem is that despite using a pretty standard build process, I am
>>>> failing at the "make check" step. I don't see what I might have done
>>>> that is causing the failure.
>>>>
>>>> My platform is:
>>>>
>>>>> uname -a
>>>> Linux littlebourne 3.13.0-85-generic #129-Ubuntu SMP Thu Mar 17 20:50:15
>>>> UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
>>>>
>>>>> cat /etc/issue
>>>> Ubuntu 14.04.4 LTS \n \l
>>>>
>>>> I've downloaded the recent R-3.2.5 tar-gz file and gone through the
>>>> standard build, though in a non-standard location. I keep copies of the
>>>> tar-gzipped file in an "Archive" directory.
>>>>
>>>>> gunzip -c Archive/R-3.2.5.tar.gz | tar xf -
>>>>> cd R-3.2.5/
>>>>> ./configure --prefix=/opt/apps/x86_64/R/R-3.2.5 LIBnn=lib
>>>> [ ... much output ...]
>>>> R is now configured for x86_64-pc-linux-gnu
>>>>
>>>>  Source directory:          .
>>>>  Installation directory:    /opt/apps/x86_64/R/R-3.2.5
>>>>
>>>>  C compiler:                gcc -std=gnu99  -g -O2
>>>>  Fortran 77 compiler:       gfortran  -g -O2
>>>>
>>>>  C++ compiler:              g++  -g -O2
>>>>  C++ 11 compiler:           g++  -std=c++11 -g -O2
>>>>  Fortran 90/95 compiler:    gfortran -g -O2
>>>>  Obj-C compiler:         gcc -g -O2 -fobjc-exceptions
>>>>
>>>>  Interfaces supported:      X11, tcltk
>>>>  External libraries:        readline, zlib, bzlib, lzma, PCRE
>>>>  Additional capabilities:   PNG, JPEG, TIFF, NLS, cairo
>>>>  Options enabled:           shared BLAS, R profiling
>>>>
>>>>  Capabilities skipped:      ICU
>>>>  Options not enabled:       memory profiling
>>>>
>>>>  Recommended packages:      yes
>>>>
>>>> # Note: I use tcsh, not bash
>>>>> make >& make.out &
>>>> # There are no obvious errors and the 'make' proceeds finally through
>>>> some Java configuration
>>>> # and then exits with a zero status.
>>>>
>>>>> make check >& make_check.out &
>>>> [ ... much output captured ...]
>>>> make[3]: Entering directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
>>>> running code in 'reg-tests-1a.R' ... OK
>>>> running code in 'reg-tests-1b.R' ... OK
>>>> running code in 'reg-tests-1c.R' ... OK
>>>> running code in 'reg-tests-2.R' ... OK
>>>>  comparing 'reg-tests-2.Rout' to './reg-tests-2.Rout.save' ... OK
>>>> running code in 'reg-examples1.R' ... OK
>>>> running code in 'reg-examples2.R' ... OK
>>>> running code in 'reg-packages.R' ...make[3]: *** [reg-packages.Rout] Error 1
>>>> make[3]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
>>>> make[2]: *** [test-Reg] Error 2
>>>> make[2]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
>>>> make[1]: *** [test-all-basics] Error 1
>>>> make[1]: Leaving directory `/opt/apps/x86_64/R/src/R-3.2.5/tests'
>>>> make: *** [check] Error 2
>>>>
>>>>> cd tests
>>>>> tail -30 reg-packages.Rout.fail
>>>> *** installing help indices
>>>> ** building package indices
>>>> ** testing if installed package can be loaded
>>>> * DONE (pkgB)
>>>> Loading required package: pkgB
>>>> building package exNSS4 ...
>>>>
>>>> installing package exNSS4 using file exNSS4_1.1.tar.gz ...
>>>> * installing *source* package 'exNSS4' ...
>>>> ** R
>>>> ** preparing package for lazy loading
>>>> Creating a generic function for 'plot' from package 'graphics' in
>>>> package 'exNSS4'
>>>> ** help
>>>> No man pages found in package  'exNSS4'
>>>> *** installing help indices
>>>> ** building package indices
>>>> ** testing if installed package can be loaded
>>>> * DONE (exNSS4)
>>>> Loading required package: exNSS4
>>>>> (res <- installed.packages(lib.loc = "myLib", priority = "NA"))
>>>>      Package LibPath Version Priority Depends   Imports LinkingTo Suggests
>>>> myTst "myTst" "myLib" "1.0"   NA       "methods" NA      NA        NA
>>>>      Enhances License                     License_is_FOSS
>>>> myTst NA       "What license is it under?" NA
>>>>      License_restricts_use OS_type MD5sum NeedsCompilation Built
>>>> myTst NA                    NA      NA     NA               "3.2.5"
>>>>> stopifnot(identical(res[,"Package"], setNames(,sort(c(p.lis, "myTst")))),
>>>> +       res[,"LibPath"] == "myLib")
>>>> Error: identical(res[, "Package"], setNames(, sort(c(p.lis, "myTst"))))
>>>> is not TRUE
>>>> Execution halted
>>>>
>>>>> ls myLib
>>>> exNSS4  myTst  pkgA  pkgB
>>>>
>>>> So, it looks like the "installed.packages()" is not correctly detecting
>>>> what is present in "myLib".
>>>>
>>>> Has anyone else seen this? Has anyone got any ideas about what is going
>>>> wrong? My environment does not include R_LIBS, LD_LIBRARY, etc. The PATH
>>>> does include an older version of R, 3.1.1.
>>>>
>>>> Regards,
>>>> Mark Dalphin
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Emeritus Professor of Applied Statistics, University of Oxford


From pdalgd at gmail.com  Fri Apr 22 09:11:16 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Fri, 22 Apr 2016 09:11:16 +0200
Subject: [Rd] Fresh build from source of R-3.2.5 failing "make check"
	under 64-bit Ubuntu [SOLVED]
In-Reply-To: <SYXPR01MB00930EF6CA87A542FFD8640EDB6E0@SYXPR01MB0093.ausprd01.prod.outlook.com>
References: <571807B7.2070603@pacificedge.co.nz>
	<A32AC8B9-F509-4A2C-9DF8-F6E2C4199192@gmail.com>
	<5718C38C.4010305@stats.ox.ac.uk>
	<840078C9-E0FB-48CB-80C3-5C18CF276D12@gmail.com>
	<571943ED.3010002@pacificedge.co.nz>
	<SYXPR01MB00930EF6CA87A542FFD8640EDB6E0@SYXPR01MB0093.ausprd01.prod.outlook.com>
Message-ID: <3AE75DCA-DB22-487B-B51D-53F77CFB6971@gmail.com>


> On 22 Apr 2016, at 00:25 , Mark Dalphin <mark.dalphin at pacificedge.co.nz> wrote:
> 
>> 
>> mount | grep /opt/
> myHost.science:/mnt/home/opt/apps on /opt/apps type nfs (rw,soft,bg,nfsvers=3,addr=XXX.XXX.XXX.XXX)
> 
> Just the NFS, I guess. This is not good, but not an R-Devel problem.

On a hunch: Check out what the "soft" mount option does. I seem to recall some complications related to immediacy of operations.

-pd

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From tal.galili at gmail.com  Wed Apr 27 09:23:42 2016
From: tal.galili at gmail.com (Tal Galili)
Date: Wed, 27 Apr 2016 10:23:42 +0300
Subject: [Rd] "cophenetic" function for objects of class "dendrogram"
In-Reply-To: <CAF8bMcaRhvbsYK1nguXEf0sCo-9w4qkXK6DzC0BbkPA6epHz1g@mail.gmail.com>
References: <VI1PR01MB138950829C65980A4FF9CC01F56E0@VI1PR01MB1389.eurprd01.prod.exchangelabs.com>
	<CAF8bMcahx7fiNhmTjW7Qpnrgoi5UbXepBce8PYtRk_ms76upfw@mail.gmail.com>
	<CAF8bMcaRhvbsYK1nguXEf0sCo-9w4qkXK6DzC0BbkPA6epHz1g@mail.gmail.com>
Message-ID: <CANdJ3dXQyExWctMmDAaRLweqLkk4ZP5SKPCgB4KLCMDiqTr4VA@mail.gmail.com>

Hi Alberto,
Everyone in this thread are correct.
I'll just mention that if your goal was to calculate the cophenetic
correlation between dendrograms, the function cor_cophenetic from the
dendextend package can help with that (as well as other functions such as
cor_bakers_gamma tanglegram and others. See the bioinformatics paper for
more: http://bioinformatics.oxfordjournals.org/content/31/22/3718 ).

As you can see from dendextend:::cor_cophenetic.default it deals with
properly ordering the distance matrices.

With regards,
Tal


?


----------------Contact
Details:-------------------------------------------------------
Contact me: Tal.Galili at gmail.com |
Read me: www.talgalili.com (Hebrew) | www.biostatistics.co.il (Hebrew) |
www.r-statistics.com (English)
----------------------------------------------------------------------------------------------


On Thu, Apr 21, 2016 at 7:38 PM, William Dunlap via R-devel <
r-devel at r-project.org> wrote:

> Note that cophenetic.default (which works on the output of hclust(dist(X)))
> uses the
> row names of X as labels.  as.dendrogram.hclust does not retain those row
> names
> so cophenetic.dendrogram cannot use them (so it orders them based on the
> topology of the dendrogram).
>
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
>
> On Thu, Apr 21, 2016 at 7:59 AM, William Dunlap <wdunlap at tibco.com> wrote:
>
> > I think the results differ only in the order of the labels.  The
> following
> > function
> > puts the labels in a standard order and then the results are the same:
> >
> >   canonicalize.dist <- function (distObject)
> >   {
> >       o <- order(labels(distObject))
> >       as.matrix(distObject)[o, o, drop = FALSE]
> >   }
> >   identical(canonicalize.dist(d2), canonicalize.dist(d3))
> >   [1] TRUE
> >
> >
> >
> >
> > Bill Dunlap
> > TIBCO Software
> > wdunlap tibco.com
> >
> > On Thu, Apr 21, 2016 at 2:37 AM, Alberto Fern?ndez Sabater <
> > alberto.fernandez at urv.cat> wrote:
> >
> >> Hello,
> >>
> >>
> >> I have been using the "cophenetic" function for objects of class
> >> "dendrogram" and I have realised that it gives different results when
> it is
> >> used with objects of class "hclust". For instance, running the first
> >> example in the help file of the "cophenetic" function,
> >>
> >>
> >> d1 <- dist(USArrests)
> >>
> >> hc <- hclust(d1, "ave")
> >>
> >> d2 <- cophenetic(hc)
> >>
> >> cor(d1, d2)  # 0.7659
> >>
> >>
> >> the result given is different to the one obtained using an object of
> >> class "dendrogram",
> >>
> >>
> >> dendro <- as.dendrogram(hc)
> >>
> >> d3 <- cophenetic(dendro)
> >>
> >> cor(d1, d3)  # 0.0151
> >>
> >>
> >> I think that it would be desirable to obtain the same result with all
> the
> >> "cophenetic" methods, irrespectively of the class of the object used. If
> >> this is not possible, users could be warned in the help file.
> >>
> >>
> >> Thanks,
> >>
> >> Alberto Fernandez
> >>
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Thu Apr 28 10:00:00 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 28 Apr 2016 10:00:00 +0200
Subject: [Rd] residual standard "error"
In-Reply-To: <37CB9E78-738E-4508-BA0C-AD4CB7B98EF4@calvin.edu>
References: <37CB9E78-738E-4508-BA0C-AD4CB7B98EF4@calvin.edu>
Message-ID: <22305.49920.349559.710718@stat.math.ethz.ch>

>>>>> Randall Pruim <rpruim at calvin.edu>
>>>>>     on Sun, 17 Apr 2016 13:54:28 +0000 writes:

    > I see that the sigma() function has recently been introduced into R 3.3.  The help for sigma() says:
    > Extract the estimated standard deviation of the errors, the ?residual standard deviation? (misnomed also ?residual standard error?, e.g., in summary.lm()'s output, from a fitted model.

    > Is there any reason not to fix the mis-naming of residual standard error now too?  Both functions are in the stats package.  It seems odd for one function in the package to point out an issue with another, especially when fixing it would only affect displayed output and not the rest of the API.

Yes, there is a reason, believe it or not, it is called "tradition".

1) The tradition of some/many(?) statistics text books who use the same misnomer
2) The "tradition" of S+ (S, S-PLUS) before R and R ever since,
   with its output re-printed in lecture notes and other text books.
   
For that reason I did not dare to change it in print.summary.lm(),
even though I could have been one of the few to change it at a time
when are was still in its infancy and (years *before* it got to
version 1.0.0 on Feb.29, 2000).

    > My apologies if this has been suggested before, but a search through the archives didn?t locate the discussion.

    > Also, there is a missing paren in the sentenced quoted from the help for sigma().
    > ?rjp

Thank you, Randall!
I only saw that part now.... and fixed it in the sources a few minutes ago.

Martin Maechler,
ETH Zurich


From pdalgd at gmail.com  Thu Apr 28 10:19:21 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 28 Apr 2016 10:19:21 +0200
Subject: [Rd] residual standard "error"
In-Reply-To: <22305.49920.349559.710718@stat.math.ethz.ch>
References: <37CB9E78-738E-4508-BA0C-AD4CB7B98EF4@calvin.edu>
	<22305.49920.349559.710718@stat.math.ethz.ch>
Message-ID: <13393868-5414-4849-9083-4F3CDA583A8E@gmail.com>


On 28 Apr 2016, at 10:00 , Martin Maechler <maechler at stat.math.ethz.ch> wrote:

>>>>>> Randall Pruim <rpruim at calvin.edu>
>>>>>>    on Sun, 17 Apr 2016 13:54:28 +0000 writes:
> 
>> I see that the sigma() function has recently been introduced into R 3.3.  The help for sigma() says:
>> Extract the estimated standard deviation of the errors, the ?residual standard deviation? (misnomed also ?residual standard error?, e.g., in summary.lm()'s output, from a fitted model.
> 
>> Is there any reason not to fix the mis-naming of residual standard error now too?  Both functions are in the stats package.  It seems odd for one function in the package to point out an issue with another, especially when fixing it would only affect displayed output and not the rest of the API.
> 
> Yes, there is a reason, believe it or not, it is called "tradition".
> 
> 1) The tradition of some/many(?) statistics text books who use the same misnomer
> 2) The "tradition" of S+ (S, S-PLUS) before R and R ever since,
>   with its output re-printed in lecture notes and other text books.
> 
> For that reason I did not dare to change it in print.summary.lm(),
> even though I could have been one of the few to change it at a time
> when are was still in its infancy and (years *before* it got to
> version 1.0.0 on Feb.29, 2000).

You may want to Google "Standard error of the estimate" (and weep...)

-pd

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ddalthorp at usgs.gov  Fri Apr 29 01:41:28 2016
From: ddalthorp at usgs.gov (Dalthorp, Daniel)
Date: Thu, 28 Apr 2016 16:41:28 -0700
Subject: [Rd] paths for install and libraries?
Message-ID: <CAJeYpE_N+QBd9KzNaQ+vuQq7zf-_okb+SW8RjNws0finN2WWVA@mail.gmail.com>

I've written a fairly elaborate package (called "eoa") that relies on
functions from several other packages. I've built the package into a zip
file on Windows using Hadley's devtools::build(binary = T) and have sent
the zip to a couple dozen people for testing. My package installs fine, but
some people are having trouble loading it. After library(eoa), they get
something like:

Error: could not load package tcltk2

In DESCRIPTION file, I use

Depends: tcltk, tcltk2, tkrplot
Imports: actuar,
    graphics,
    gsl,
    MASS,
    Matrix,
    tensorA

If, after getting the "could not load" message, the user installs the
required packages by hand, everything works fine.

My understanding was that both the "Depends: " and the "Imports: " lines in
DESCRIPTION file direct R to automatically install required packages that
haven't been previously installed.

It doesn't appear to be working that way for me. There must be a simple
solution that I am obviously missing....

Any help would  be greatly appreciated!

-Dan

-- 
Dan Dalthorp, PhD
USGS Forest and Rangeland Ecosystem Science Center
Forest Sciences Lab, Rm 189
3200 SW Jefferson Way
Corvallis, OR 97331
ph: 541-750-0953
ddalthorp at usgs.gov

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Fri Apr 29 11:48:25 2016
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 29 Apr 2016 11:48:25 +0200
Subject: [Rd] paths for install and libraries?
In-Reply-To: <CAJeYpE_N+QBd9KzNaQ+vuQq7zf-_okb+SW8RjNws0finN2WWVA@mail.gmail.com>
References: <CAJeYpE_N+QBd9KzNaQ+vuQq7zf-_okb+SW8RjNws0finN2WWVA@mail.gmail.com>
Message-ID: <22307.11753.252718.135758@stat.math.ethz.ch>

>>>>> Dalthorp, Daniel <ddalthorp at usgs.gov>
>>>>>     on Thu, 28 Apr 2016 16:41:28 -0700 writes:

    > I've written a fairly elaborate package (called "eoa")
    > that relies on functions from several other packages. I've
    > built the package into a zip file on Windows using
    > Hadley's devtools::build(binary = T) and have sent the zip
    > to a couple dozen people for testing. My package installs
    > fine, but some people are having trouble loading it. After
    > library(eoa), they get something like:

    > Error: could not load package tcltk2

    > In DESCRIPTION file, I use

    > Depends: tcltk, tcltk2, tkrplot 
    > Imports: actuar, graphics, gsl, MASS, Matrix, tensorA

    > If, after getting the "could not load" message, the user
    > installs the required packages by hand, everything works
    > fine.

    > My understanding was that both the "Depends: " and the
    > "Imports: " lines in DESCRIPTION file direct R to
    > automatically install required packages that haven't been
    > previously installed.


All package installation happens via  install.packages(),
at least eventually.

If you look at the help page for that, it has always said that it
does not (as it cannot easily, in general!!) look at
dependencies when you do not install from a repository.

This question would clearly have belonged to R-help, not R-devel.
I'm CC ing to the help list and am asking all follow-ups to go
*only* to R-help, please.

Martin

    > It doesn't appear to be working that way for me. There
    > must be a simple solution that I am obviously missing....

    > Any help would be greatly appreciated!



    > -Dan

    > -- 
    > Dan Dalthorp, PhD USGS Forest and Rangeland Ecosystem
    > Science Center Forest Sciences Lab, Rm 189 3200 SW
    > Jefferson Way Corvallis, OR 97331 ph: 541-750-0953
    > ddalthorp at usgs.gov


From diy at stat.oregonstate.edu  Fri Apr 29 23:54:09 2016
From: diy at stat.oregonstate.edu (diy at stat.oregonstate.edu)
Date: Fri, 29 Apr 2016 14:54:09 -0700
Subject: [Rd] boxplot with formula involving two-factor levels
Message-ID: <A0910CA43C834C6FB03CE582BBA660D3@science.oregonstate.edu>

Hi,

I noticed two seemingly equivalent call to boxplot will give different plots (in the way how the combined factor levels are arranged on the x-axis): 

x = factor(rep(c("a", "b", "c"), each=2));
y = rep(factor(c("one", "two")), each=3);
r = 3;
n = r * 6;
x = rep(x, 3);
y = rep(y, 3);
z = rnorm(n);

par(mfrow=c(2,1));

## The following two seeming equivalent calls to boxplot give different results
boxplot(z~x:y);

f = x:y;
boxplot(z~f);

This is puzzling to me. Is this normal? 

Thanks!

Best,
Yanming
	[[alternative HTML version deleted]]


From edd at debian.org  Sat Apr 30 01:07:48 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 29 Apr 2016 18:07:48 -0500
Subject: [Rd] paths for install and libraries?
In-Reply-To: <CAJeYpE_N+QBd9KzNaQ+vuQq7zf-_okb+SW8RjNws0finN2WWVA@mail.gmail.com>
References: <CAJeYpE_N+QBd9KzNaQ+vuQq7zf-_okb+SW8RjNws0finN2WWVA@mail.gmail.com>
Message-ID: <22307.59716.357195.248785@max.nulle.part>


On 28 April 2016 at 16:41, Dalthorp, Daniel wrote:
| I've written a fairly elaborate package (called "eoa") that relies on
| functions from several other packages. I've built the package into a zip
| file on Windows using Hadley's devtools::build(binary = T) and have sent
| the zip to a couple dozen people for testing. My package installs fine, but
| some people are having trouble loading it. After library(eoa), they get
| something like:
| 
| Error: could not load package tcltk2
| 
| In DESCRIPTION file, I use
| 
| Depends: tcltk, tcltk2, tkrplot
| Imports: actuar,
|     graphics,
|     gsl,
|     MASS,
|     Matrix,
|     tensorA
| 
| If, after getting the "could not load" message, the user installs the
| required packages by hand, everything works fine.
| 
| My understanding was that both the "Depends: " and the "Imports: " lines in
| DESCRIPTION file direct R to automatically install required packages that
| haven't been previously installed.
| 
| It doesn't appear to be working that way for me. There must be a simple
| solution that I am obviously missing....

I think this would work if you users installed from a _repository_ rather
than a single zip file. So in a sense I feat it is a flaw in the setup you
provided.

You can build repositories, both local / private and visible / public, using
the drat package:  http://dirk.eddelbuettel.com/code/drat.html, also on CRAN.

Else, just have them execute a helper script you devise....

Dirk
 
| Any help would  be greatly appreciated!
| 
| -Dan
| 
| -- 
| Dan Dalthorp, PhD
| USGS Forest and Rangeland Ecosystem Science Center
| Forest Sciences Lab, Rm 189
| 3200 SW Jefferson Way
| Corvallis, OR 97331
| ph: 541-750-0953
| ddalthorp at usgs.gov
| 
| 	[[alternative HTML version deleted]]
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From pdalgd at gmail.com  Sat Apr 30 01:11:16 2016
From: pdalgd at gmail.com (peter dalgaard)
Date: Sat, 30 Apr 2016 01:11:16 +0200
Subject: [Rd] boxplot with formula involving two-factor levels
In-Reply-To: <A0910CA43C834C6FB03CE582BBA660D3@science.oregonstate.edu>
References: <A0910CA43C834C6FB03CE582BBA660D3@science.oregonstate.edu>
Message-ID: <1A4F3B70-0939-4A71-885C-9AFF2B92DBB7@gmail.com>


> On 29 Apr 2016, at 23:54 , diy at stat.oregonstate.edu wrote:
> 
> Hi,
> 
> I noticed two seemingly equivalent call to boxplot will give different plots (in the way how the combined factor levels are arranged on the x-axis): 
> 
> x = factor(rep(c("a", "b", "c"), each=2));
> y = rep(factor(c("one", "two")), each=3);
> r = 3;
> n = r * 6;
> x = rep(x, 3);
> y = rep(y, 3);
> z = rnorm(n);
> 
> par(mfrow=c(2,1));
> 
> ## The following two seeming equivalent calls to boxplot give different results
> boxplot(z~x:y);
> 
> f = x:y;
> boxplot(z~f);
> 
> This is puzzling to me. Is this normal? 

Normal, but a little odd. The root cause is the difference between x:y and interaction(x,y), documented on the help page for the latter.

-pd


> Thanks!
> 
> Best,
> Yanming
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


