From Jskud at Jskud.com  Sun May  1 00:00:42 2005
From: Jskud at Jskud.com (Jskud@Jskud.com)
Date: Sun May  1 00:00:53 2005
Subject: [Rd] Re: (PR#7826) ... segfault during build of 2.1.0 on RH9;
	print.POSIXct ...
Message-ID: <20050430220042.D8F5985B0@slim.kubism.ku.dk>

Dear Peter,

Thank you very much for your kind and helpful reply.

As I mentioned in a followup email to r-bugs, indeed, one aspect of this
issue is a (user specified) shorter stack than that expected by R -- I
had only allowed 1 MB of stack space a long long time ago, and forgotten
about it.

Due to a glitch with r-bugs@r-project.org, I ended up submitting this
bug twice, and your original response was attached to (PR#7827), which
Prof Brian Ripley moved to the trashcan, as was appropriate.  

I've taken the liberty of responding to PR#7826 (including your reply,
below) to have your helpful response (specifically, the unclass
suggestion) associated with the representative bug number.

/Jskud

>------ Begin Included Message ------
> To: Jskud@Jskud.com
> Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
> Subject: Re: [Rd] segfault during build of 2.1.0 on RH9; print.POSIXct implicated (PR#7827)
> From: Peter Dalgaard <p.dalgaard@biostat.ku.dk>
> Date: 30 Apr 2005 12:18:56 +0200
> Lines: 73
> 
> Jskud@jskud.com writes:
> >     > unusual_but_ok <- c.POSIXlt(character(0))
> >     > unusual_but_ok
> >     character(0)
> >     > unusual_and_faults <- c.POSIXct(character(0))
> >     > unusual_and_faults
> >     Segmentation fault
> > 
> > Running this test program under gdb, we find that we're running off the
> > end of the stack, with 4222 stack frames showing -- apparently in an
> > infinite recursion -- "as.character" shows up every 69 function calls:
> 
> This gives a protection stack overflow on FC3 and RH8. Is the stack
> particularly small on RH9? I have 8MB on RH8 and 10MB on FC3. (The R
> limits for expression depth and pointer protection were increased in
> 2.1.0). I can force a segfault, but only after "ulimit -s 1024" or so.
> 
> > #64 0x080ea1ef in Rf_usemethod (generic=0x81c8b12 "as.character", obj=0x0, call=0x85a04f4, 
> ...
> > So it would seem that *printing* the unusual POSIXct value is suspect.
> 
> Pretty obviously, yes.
> 
> > Looking at a R-1.8.1 install, we find these definitions in base/R/base:
> > 
> >     print.POSIXct <- function(x, ...)
> >     {
> > 	print(format(x, usetz=TRUE), ...)
> > 	invisible(x)
> >     }
> > 
> >     print.POSIXlt <- function(x, ...)
> >     {
> > 	print(format(x, usetz=TRUE), ...)
> > 	invisible(x)
> >     }
> > 
> > However, looking at the 2.1.0 src file
> > R-2.1.0/src/library/base/R/datetime.R, we find
> > 
> >     print.POSIXct <- function(x, ...)
> >     {
> > 	print(format(x, usetz=TRUE, ...), ...)
> > 	invisible(x)
> >     }
> > 
> >     print.POSIXlt <- function(x, ...)
> >     {
> > 	print(format(x, usetz=TRUE), ...)
> > 	invisible(x)
> >     }
> > 
> > Note the suspicious definition of print.POSIXct using *two* sets of
> > ellipses, and that the print.POSIXct and print.POSIXlt definitions no
> > longer match.
> 
> Probably both should use the double ellipses, but "..." will be empty
> on automatic printing, so that's not it. 
> 
> The issue is an infinite recursion inside as.POSIXlt(). Specifically,
> strptime() internally calls as.character(x) inside the fromchar()
> function in as.POSIXlt(), and as.character.POSIXt() invokes format()
> which calls as.POSIXlt() again.
> 
> I think the fix is to unclass(x) inside fromchar(), but perhaps others
> know better?
> 
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> 
>------  End Included Message  ------

From Bill.Venables at csiro.au  Sun May  1 04:28:11 2005
From: Bill.Venables at csiro.au (Bill.Venables@csiro.au)
Date: Sun May  1 04:28:24 2005
Subject: [Rd] RE: as.numeric method for objects of class "difftime"
Message-ID: <B998A44C8986644EA8029CFE6396A9241B32D6@exqld2-bne.qld.csiro.au>

I had a couple of private replies to the message below, all very
supportive of the idea.  I see that where I should have looked first is
at the function difftime, the constructor (which will hardly ever be
used except by people who know about its separate existence from
Ops.POSIXt).

Thus encouraged I formally propose that a method for as.numeric be
provided that will not break existing code, but will issue a warning if
people convert from difftime to numeric without specifying a time unit
to which the resulting numerical quantity will implicitly refer.

This is the simplest acceptable solution I could think of.  The code I
propose is as follows:

###
### S3 method for objects of class 'difftime'
###
as.double.difftime <- function(x, units = attr(x, "units"), ...) {
  if(missing(units)) {
    warning('No time units specified for conversion to numeric.\n"',
             units, '" has been assumed.')
    return(as.vector(x))
  }
  cfToSecs <- cumprod(c(secs = 1, mins = 60, hours = 60, days = 24,
weeks = 7))
  if(!is.element(units, names(cfToSecs)))
    stop("Unknown time units. Acceptable time units are\n\t",
         paste('"', names(cfToSecs), '", ', sep = "", collapse = ""),
         "only.")
  as.vector(x) * (cfToSecs[attr(x, "units")]/cfToSecs[units])
}
###
### End S3 method
###

Note that if people want to continue business as usual and the warning
irritates them, the simplest solution is to use as.vector instead of
as.numeric.  I think this is reasonable: to me as.vector implies simply
a change of structure to the object, whereas as.numeric implies a
conversion to a reasonably intuitive numerical object corresponding to
the original.

In retrospect the best thing to have done would have been not to make
"auto" the default units for difftime, but "secs" instead, but I think
that particular horse has bolted by now.

I would welcome further discussion.

Bill.

: -----Original Message-----
: From: Venables, Bill (CMIS, Cleveland) 
: Sent: Saturday, 30 April 2005 4:03 PM
: To: 'R-Devel (r-devel@stat.math.ethz.ch)'
: Subject: as.numeric method for objects of class "difftime"
: 
: 
: I have just become painfully aware that objects of class 
: "difftime", generated by the difference of two POSIXct 
: objects, carry a "units" attribute, which flashes by when the 
: object is printed, for example.
: 
: The pain was occasioned when I tried to turn these objects 
: into numberic objects for use elsewhere as a covariate.  
: 
: as.numeric(difftime object)
: 
: simply turns off the units attribute and provides a numeric 
: object which may represent a number of seconds or a number of 
: days, with no warning as to which.
: 
: I think this is an unfortunate situation, but I can't see how 
: to rectify it without breaking code that may rely on this 
: quirky feature.  My inclination is to suggest a method for 
: as.numeric (ie for as.double) that settles on a single unit, 
: which for consistency with as.numeric(POSIXct object) should 
: probably be seconds:
: 
: as.double.difftime <- function(x, ...)
:   if(attr(x, "units") == "days") as.vector(x) * 86400 else 
: as.vector(x)
: 
: but there must now be lots of code out there that has 
: blythely assumed that the difference will always be a number 
: of days and others assume it is always seconds.
: 
: At the very least I think the help information should carry a 
: big red warning about this rather unusual feature.  (It may, 
: I suppose, but I couldn't find it.)
: 
: Comments?
: 
: Bill Venables, 
: CMIS, CSIRO Laboratories, 
: PO Box 120, Cleveland, Qld. 4163
: AUSTRALIA
: Phone:  +61 7 3826 7251  
: Fax:    +61 7 3826 7304
: Mobile: +61 4 1963 4642
: Home:   +61 7 3286 7700
: mailto:Bill.Venables@csiro.au
: http://www.cmis.csiro.au/bill.venables/
: 
:

From Bill.Venables at csiro.au  Sun May  1 04:39:02 2005
From: Bill.Venables at csiro.au (Bill.Venables@csiro.au)
Date: Sun May  1 04:39:13 2005
Subject: [Rd] heads and tails
Message-ID: <B998A44C8986644EA8029CFE6396A9241B32D7@exqld2-bne.qld.csiro.au>

Using head and tail recently, it occurred to me that it 
would be very handy to have the unix convention more 
fully, namely to allow negative values for "n" to 
signify omission of lines rather than inclusion.

Thus head(X, -1) would mean "all but the last line" and
	tail(X, -1) would mean "all but the first line".

Private correspondence has made me aware that this idea 
is not new, and that there is no organised opposition to 
it.  Moreover the code changes needed are trivial (and 
I am happy to supply them if people want...) and no 
presently working code would be broken.

Has the time for this admittedly minor but harmless 
convenience feature come at last?

Bill Venables, 
CMIS, CSIRO Laboratories, 
PO Box 120, Cleveland, Qld. 4163
AUSTRALIA
Phone:  +61 7 3826 7251  
Fax:    +61 7 3826 7304
Mobile: +61 4 1963 4642
Home:   +61 7 3286 7700
mailto:Bill.Venables@csiro.au
http://www.cmis.csiro.au/bill.venables/

From ripley at stats.ox.ac.uk  Sun May  1 06:40:51 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun May  1 06:41:04 2005
Subject: [Rd] RE: as.numeric method for objects of class "difftime"
In-Reply-To: <B998A44C8986644EA8029CFE6396A9241B32D6@exqld2-bne.qld.csiro.au>
References: <B998A44C8986644EA8029CFE6396A9241B32D6@exqld2-bne.qld.csiro.au>
Message-ID: <Pine.LNX.4.61.0505010537230.19647@gannet.stats>

I am very surprised that people would expect as.numeric to do something 
meaningful on time differences (or times, come to that).  Perhaps the best 
thing is to stop it altogether.

The selection of "auto" was the best for the original purpose: people in 
general do not want a difference of 3 days expressed in seconds.  The 
problems only arise if the result is unclassed, and I still do not 
understand why that is a reasonable thing to do.

On Sun, 1 May 2005 Bill.Venables@csiro.au wrote:

> I had a couple of private replies to the message below, all very
> supportive of the idea.  I see that where I should have looked first is
> at the function difftime, the constructor (which will hardly ever be
> used except by people who know about its separate existence from
> Ops.POSIXt).
>
> Thus encouraged I formally propose that a method for as.numeric be
> provided that will not break existing code, but will issue a warning if
> people convert from difftime to numeric without specifying a time unit
> to which the resulting numerical quantity will implicitly refer.
>
> This is the simplest acceptable solution I could think of.  The code I
> propose is as follows:
>
> ###
> ### S3 method for objects of class 'difftime'
> ###
> as.double.difftime <- function(x, units = attr(x, "units"), ...) {
>  if(missing(units)) {
>    warning('No time units specified for conversion to numeric.\n"',
>             units, '" has been assumed.')
>    return(as.vector(x))
>  }
>  cfToSecs <- cumprod(c(secs = 1, mins = 60, hours = 60, days = 24,
> weeks = 7))
>  if(!is.element(units, names(cfToSecs)))
>    stop("Unknown time units. Acceptable time units are\n\t",
>         paste('"', names(cfToSecs), '", ', sep = "", collapse = ""),
>         "only.")
>  as.vector(x) * (cfToSecs[attr(x, "units")]/cfToSecs[units])
> }
> ###
> ### End S3 method
> ###
>
> Note that if people want to continue business as usual and the warning
> irritates them, the simplest solution is to use as.vector instead of
> as.numeric.  I think this is reasonable: to me as.vector implies simply
> a change of structure to the object, whereas as.numeric implies a
> conversion to a reasonably intuitive numerical object corresponding to
> the original.
>
> In retrospect the best thing to have done would have been not to make
> "auto" the default units for difftime, but "secs" instead, but I think
> that particular horse has bolted by now.
>
> I would welcome further discussion.
>
> Bill.
>
> : -----Original Message-----
> : From: Venables, Bill (CMIS, Cleveland)
> : Sent: Saturday, 30 April 2005 4:03 PM
> : To: 'R-Devel (r-devel@stat.math.ethz.ch)'
> : Subject: as.numeric method for objects of class "difftime"
> :
> :
> : I have just become painfully aware that objects of class
> : "difftime", generated by the difference of two POSIXct
> : objects, carry a "units" attribute, which flashes by when the
> : object is printed, for example.
> :
> : The pain was occasioned when I tried to turn these objects
> : into numberic objects for use elsewhere as a covariate.
> :
> : as.numeric(difftime object)
> :
> : simply turns off the units attribute and provides a numeric
> : object which may represent a number of seconds or a number of
> : days, with no warning as to which.
> :
> : I think this is an unfortunate situation, but I can't see how
> : to rectify it without breaking code that may rely on this
> : quirky feature.  My inclination is to suggest a method for
> : as.numeric (ie for as.double) that settles on a single unit,
> : which for consistency with as.numeric(POSIXct object) should
> : probably be seconds:
> :
> : as.double.difftime <- function(x, ...)
> :   if(attr(x, "units") == "days") as.vector(x) * 86400 else
> : as.vector(x)
> :
> : but there must now be lots of code out there that has
> : blythely assumed that the difference will always be a number
> : of days and others assume it is always seconds.
> :
> : At the very least I think the help information should carry a
> : big red warning about this rather unusual feature.  (It may,
> : I suppose, but I couldn't find it.)
> :
> : Comments?
> :
> : Bill Venables,
> : CMIS, CSIRO Laboratories,
> : PO Box 120, Cleveland, Qld. 4163
> : AUSTRALIA
> : Phone:  +61 7 3826 7251
> : Fax:    +61 7 3826 7304
> : Mobile: +61 4 1963 4642
> : Home:   +61 7 3286 7700
> : mailto:Bill.Venables@csiro.au
> : http://www.cmis.csiro.au/bill.venables/
> :
> :
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Bill.Venables at csiro.au  Sun May  1 08:32:56 2005
From: Bill.Venables at csiro.au (Bill.Venables@csiro.au)
Date: Sun May  1 08:33:09 2005
Subject: [Rd] RE: as.numeric method for objects of class "difftime"
Message-ID: <B998A44C8986644EA8029CFE6396A9241B32DC@exqld2-bne.qld.csiro.au>

Brian,

: -----Original Message-----
: From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
: Sent: Sunday, 1 May 2005 2:41 PM
: To: Venables, Bill (CMIS, Cleveland)
: Cc: r-devel@stat.math.ethz.ch
: Subject: Re: [Rd] RE: as.numeric method for objects of class 
: "difftime"
: 
: 
: I am very surprised that people would expect as.numeric to do 
: something 
: meaningful on time differences (or times, come to that).  
: Perhaps the best 
: thing is to stop it altogether.

This would enforce one particular interpretation that may 
inhibit legitimate but unanticipated alternative uses.

: 
: The selection of "auto" was the best for the original 
: purpose: people in 
: general do not want a difference of 3 days expressed in seconds.  The 
: problems only arise if the result is unclassed, and I still do not 
: understand why that is a reasonable thing to do.

No, they may not want the answer in seconds, but if they have
a vector of time differences that includes zero they'll get
them all in seconds anyway.

Let me encapsulate my problem with an example.  I want to use
"elapsed time" as a predictor.  I don't particularly care what 
units the time lag is in, so long as they are all in the _same_ 
units.  What I don't like about the present default is this 
kind of possibility:

> d <- as.POSIXct(paste(2005, 5, 1:3, sep="-"))
> origin <- d[1]

> as.numeric(d - origin)
[1]      0  86400 172800

> as.numeric(d[-1] - origin)
[1] 1 2


Bill.

: On Sun, 1 May 2005 Bill.Venables@csiro.au wrote:
: 
: > I had a couple of private replies to the message below, all very
: > supportive of the idea.  I see that where I should have 
: looked first is
: > at the function difftime, the constructor (which will hardly ever be
: > used except by people who know about its separate existence from
: > Ops.POSIXt).
: >
: > Thus encouraged I formally propose that a method for as.numeric be
: > provided that will not break existing code, but will issue 
: a warning if
: > people convert from difftime to numeric without specifying 
: a time unit
: > to which the resulting numerical quantity will implicitly refer.
: >
: > This is the simplest acceptable solution I could think of.  
: The code I
: > propose is as follows:
: >
: > ###
: > ### S3 method for objects of class 'difftime'
: > ###
: > as.double.difftime <- function(x, units = attr(x, "units"), ...) {
: >  if(missing(units)) {
: >    warning('No time units specified for conversion to numeric.\n"',
: >             units, '" has been assumed.')
: >    return(as.vector(x))
: >  }
: >  cfToSecs <- cumprod(c(secs = 1, mins = 60, hours = 60, days = 24,
: > weeks = 7))
: >  if(!is.element(units, names(cfToSecs)))
: >    stop("Unknown time units. Acceptable time units are\n\t",
: >         paste('"', names(cfToSecs), '", ', sep = "", collapse = ""),
: >         "only.")
: >  as.vector(x) * (cfToSecs[attr(x, "units")]/cfToSecs[units])
: > }
: > ###
: > ### End S3 method
: > ###
: >
: > Note that if people want to continue business as usual and 
: the warning
: > irritates them, the simplest solution is to use as.vector instead of
: > as.numeric.  I think this is reasonable: to me as.vector 
: implies simply
: > a change of structure to the object, whereas as.numeric implies a
: > conversion to a reasonably intuitive numerical object 
: corresponding to
: > the original.
: >
: > In retrospect the best thing to have done would have been 
: not to make
: > "auto" the default units for difftime, but "secs" instead, 
: but I think
: > that particular horse has bolted by now.
: >
: > I would welcome further discussion.
: >
: > Bill.
: >
: > : -----Original Message-----
: > : From: Venables, Bill (CMIS, Cleveland)
: > : Sent: Saturday, 30 April 2005 4:03 PM
: > : To: 'R-Devel (r-devel@stat.math.ethz.ch)'
: > : Subject: as.numeric method for objects of class "difftime"
: > :
: > :
: > : I have just become painfully aware that objects of class
: > : "difftime", generated by the difference of two POSIXct
: > : objects, carry a "units" attribute, which flashes by when the
: > : object is printed, for example.
: > :
: > : The pain was occasioned when I tried to turn these objects
: > : into numberic objects for use elsewhere as a covariate.
: > :
: > : as.numeric(difftime object)
: > :
: > : simply turns off the units attribute and provides a numeric
: > : object which may represent a number of seconds or a number of
: > : days, with no warning as to which.
: > :
: > : I think this is an unfortunate situation, but I can't see how
: > : to rectify it without breaking code that may rely on this
: > : quirky feature.  My inclination is to suggest a method for
: > : as.numeric (ie for as.double) that settles on a single unit,
: > : which for consistency with as.numeric(POSIXct object) should
: > : probably be seconds:
: > :
: > : as.double.difftime <- function(x, ...)
: > :   if(attr(x, "units") == "days") as.vector(x) * 86400 else
: > : as.vector(x)
: > :
: > : but there must now be lots of code out there that has
: > : blythely assumed that the difference will always be a number
: > : of days and others assume it is always seconds.
: > :
: > : At the very least I think the help information should carry a
: > : big red warning about this rather unusual feature.  (It may,
: > : I suppose, but I couldn't find it.)
: > :
: > : Comments?
: > :
: > : Bill Venables,
: > : CMIS, CSIRO Laboratories,
: > : PO Box 120, Cleveland, Qld. 4163
: > : AUSTRALIA
: > : Phone:  +61 7 3826 7251
: > : Fax:    +61 7 3826 7304
: > : Mobile: +61 4 1963 4642
: > : Home:   +61 7 3286 7700
: > : mailto:Bill.Venables@csiro.au
: > : http://www.cmis.csiro.au/bill.venables/
: > :
: > :
: >
: > ______________________________________________
: > R-devel@stat.math.ethz.ch mailing list
: > https://stat.ethz.ch/mailman/listinfo/r-devel
: >
: >
: 
: -- 
: Brian D. Ripley,                  ripley@stats.ox.ac.uk
: Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
: University of Oxford,             Tel:  +44 1865 272861 (self)
: 1 South Parks Road,                     +44 1865 272866 (PA)
: Oxford OX1 3TG, UK                Fax:  +44 1865 272595
:

From Ted.Harding at nessie.mcc.ac.uk  Sun May  1 09:07:37 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Sun May  1 09:14:08 2005
Subject: [Rd] heads and tails
In-Reply-To: <B998A44C8986644EA8029CFE6396A9241B32D7@exqld2-bne.qld.csiro.au>
Message-ID: <XFMail.050501080737.Ted.Harding@nessie.mcc.ac.uk>

On 01-May-05 Bill.Venables@csiro.au wrote:
> Using head and tail recently, it occurred to me that it 
> would be very handy to have the unix convention more 
> fully, namely to allow negative values for "n" to 
> signify omission of lines rather than inclusion.
> 
> Thus head(X, -1) would mean "all but the last line" and
>       tail(X, -1) would mean "all but the first line".
> 
> Private correspondence has made me aware that this idea 
> is not new, and that there is no organised opposition to 
> it.  Moreover the code changes needed are trivial (and 
> I am happy to supply them if people want...) and no 
> presently working code would be broken.
> 
> Has the time for this admittedly minor but harmless 
> convenience feature come at last?

I would agree that this seems desirable! As well as the
"trivial code changes needed", it also needs a probably
trivial switch of viewpoint from

  "n: size for the resulting object"

to

  "n: <whatever best encapsulates the above>"

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 01-May-05                                       Time: 07:57:58
------------------------------ XFMail ------------------------------

From pburns at pburns.seanet.com  Sun May  1 13:24:33 2005
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sun May  1 13:25:22 2005
Subject: [Rd] formals assignment now strips attributres
In-Reply-To: <x23bt8t2w2.fsf@turmalin.kubism.ku.dk>
References: <42736B4B.3080507@pburns.seanet.com>	<x2ekcstq4f.fsf@turmalin.kubism.ku.dk>	<4273EA5A.2060503@pburns.seanet.com>
	<x23bt8t2w2.fsf@turmalin.kubism.ku.dk>
Message-ID: <4274BC71.2010805@pburns.seanet.com>

Peter Dalgaard wrote:

>Patrick Burns <pburns@pburns.seanet.com> writes:
>
>  
>
>>But the buglet gets more aggressive if you edit the function:
>>
>> > fjj <- function() x
>> > formals(fjj) <- list(x=c(a=2, b=4))
>> > fjj
>>function (x = c(2, 4))
>>x
>> > fjj()
>>a b
>>2 4
>> > fix(fjj) # do nothing but save
>> > fjj()
>>[1] 2 4
>>
>>I'm quite sure that I wouldn't have noticed if my real function were
>>not broken.
>>
>>Now I know that my functions will work if I assign the formals after I
>>edit the
>>function -- even though they look like they shouldn't work.
>>    
>>
>
>You did invite trouble by creating and subsequently a function that
>_has_ no source representation though:
>
>  
>
>>fjj <- function() x
>>formals(fjj) <- list(x=quote(c(a=2, b=4)))
>>fjj()
>>    
>>
>a b
>2 4
>  
>
>>fix(fjj)
>>fjj()
>>    
>>
>a b
>2 4
>

But the point of using 'formals' in the first place is to get a
function that is self-contained.  The real application is more
like:

formals(fjj) <- list(x = an_object)

I want 'fjj' to work even when 'an_object' is nowhere to be
found.

'formals' worked as (I) expected in versions 1.8.0
through 1.9.1 at least. 

Pat

>
>  
>

From p.dalgaard at biostat.ku.dk  Sun May  1 20:51:45 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun May  1 20:51:54 2005
Subject: [Rd] formals assignment now strips attributres
In-Reply-To: <4274BC71.2010805@pburns.seanet.com>
References: <42736B4B.3080507@pburns.seanet.com>
	<x2ekcstq4f.fsf@turmalin.kubism.ku.dk>
	<4273EA5A.2060503@pburns.seanet.com>
	<x23bt8t2w2.fsf@turmalin.kubism.ku.dk>
	<4274BC71.2010805@pburns.seanet.com>
Message-ID: <x23bt64w5a.fsf@turmalin.kubism.ku.dk>

Patrick Burns <pburns@pburns.seanet.com> writes:

> Peter Dalgaard wrote:
...
> >>fjj <- function() x
> >>formals(fjj) <- list(x=quote(c(a=2, b=4)))
> >>fjj()
> >>
> >a b
> >2 4
> >
> >>fix(fjj)
> >>fjj()
> >>
> >a b
> >2 4
> >
> 
> But the point of using 'formals' in the first place is to get a
> function that is self-contained.  The real application is more
> like:
> 
> formals(fjj) <- list(x = an_object)
> 
> I want 'fjj' to work even when 'an_object' is nowhere to be
> found.
> 
> 'formals' worked as (I) expected in versions 1.8.0
> through 1.9.1 at least. Pat

It didn't change. It's the editing that is doing you in. There have
been changes to deparse, and they seem to have introduced a bug, but
a function object created in that way is fundamentally uneditable.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From davison at uchicago.edu  Sun May  1 22:22:53 2005
From: davison at uchicago.edu (Dan Davison)
Date: Sun May  1 22:23:03 2005
Subject: [Rd] dll symbol loading: possible bug
Message-ID: <Pine.GSO.4.62.0504302017450.16936@harper.uchicago.edu>

Dear R-devel,

I think the following describes a bug in R. It seems to be associated with 
dyn.load() and/or something that happens at start-up. I have not filed a 
bug report yet (because I doubt my ability to rule out other explanations) 
but would happily do so if requested.

Observation:

If two dlls are loaded as a result of dyn.load() calls in .Rprofile, 
subsequent calls to dyn.load() issued at the R prompt result in loss of 
symbol names in the other dll (although not until one tries 
re-dyn.load()ing the second dll; re-dyn.load()ing just one of them works 
OK). This has occurred only since installing R 2.1.0.

Example:

Contents of file dummy1.c:
---------------------------
#include <R.h>
#include <Rdefines.h>
SEXP dummy1() {
     Rprintf("this is dummy1() in C\n") ;
     return R_NilValue ;
}
---------------------------

Contents of file dummy2.c
-------------------------
#include <R.h>
#include <Rdefines.h>

SEXP dummy2() {
     Rprintf("this is dummy2() in C\n") ;
     return R_NilValue ;
}
-------------------------


Files dummy1.so and dummy2.so are present in the directory as a result 
of
system("R CMD SHLIB dummy1.c")
system("R CMD SHLIB dummy2.c")
in a previous R session.


Contents of file .Rprofile:
--------------------
dyn.load("dummy1.so")
dyn.load("dummy2.so")
--------------------

I start R, with this .Rprofile present. Although re-dyn.load()ing of the 
first dll seems unproblematic, re-dyn.load()ing the other dll and all 
subsequent dyn.load()s seem to result in loss of symbols in the other dll:


Type 'q()' to quit R.

> options(STERM='iESS', editor='gnuclient -q')
> ls(all=TRUE)
character(0)
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] TRUE
> dyn.load("dummy1.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] TRUE
> dyn.load("dummy1.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] TRUE
> dyn.load("dummy2.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] FALSE
[1] TRUE
> dyn.load("dummy1.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] FALSE
>


Now there is no .Rprofile. There is no problem:

Type 'q()' to quit R.

> options(STERM='iESS', editor='gnuclient -q')
> ls(all=TRUE)
character(0)
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] FALSE
[1] FALSE
> dyn.load("dummy1.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] FALSE
> dyn.load("dummy2.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] TRUE
> dyn.load("dummy1.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] TRUE
> dyn.load("dummy2.so")
> is.loaded("dummy1") ; is.loaded("dummy2")
[1] TRUE
[1] TRUE
>


The mailing lists contain some reports, for R 2.1.0, mentioning the error 
messages that result, such as

> .Call("dummy1", PACKAGE="dummy1")
Error in .Call("dummy1", PACKAGE = "dummy1") :
 	"C" function name not in DLL for package 'dummy1'

One example is at
http://tolstoy.newcastle.edu.au/R/help/05/04/2928.html

I would be happy to file a proper bug report, if that is deemed 
appropriate. I didn't see anything that was obviously relevant in the news 
file for R 2.1.0. Sorry if I am missing something obvious here.


Thanks very much,

Dan

> version
          _
platform i386-pc-linux-gnu
arch     i386
os       linux-gnu
system   i386, linux-gnu
status
major    2
minor    1.0
year     2005
month    04
day      18
language R
>

Debian "sarge" linux

From difusiometer at deportista.com  Sun May  1 23:07:00 2005
From: difusiometer at deportista.com (difusiometer@deportista.com)
Date: Sun May  1 23:07:09 2005
Subject: [Rd] Help me! (PR#7828)
Message-ID: <20050501210700.2F2FCA1C5@slim.kubism.ku.dk>

This is a multi-part message in MIME format.

------=_NextPart_000_0000_EEA7162E.AC0B6770
Content-Type: multipart/alternative;
    boundary="----=_NextPart_001_0001_0C6163AA.F6422C7C"


------=_NextPart_001_0001_0C6163AA.F6422C7C
Content-Type: text/plain;
    charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

  Hola, Alejandra!  your board sunburned important. where collar held her
tenderly? lazily paper stood this bit of voice. we bethought her material
lip of horse. gracefully. his wide space around cause, which forbore round,
yellow cough. Nikhil misthought that bitter plate. it dighted Brycen when
meant them Nicole! i begot loud basket, that beset merrily... excepting
cushion met receipt, tongue unsaid behind your size but necessary garden:
 she spent her past crack to their wrong cloth, who withdrew unexpectedly.
my complex decision prepaid as our pin; thick, rough neck. low dictionary
chief overate, he ran not, merrily, violently. my short prison shook before
your mist; natural, simple wheel. it typecast some private net beyond my
loose paint, who overleaped madly. he foretold her good. he rose beautiful
dollar, which leaped doubtfully...  stuck our clean color,
Jenifer DAVIDSON.  
   
------=_NextPart_001_0001_0C6163AA.F6422C7C
Content-Type: text/html;
    charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

<HTML>
<BODY>
<FONT face="Verdana, Arial">
Hola, Alejandra!
<P>
your board sunburned important. where collar held her tenderly? lazily paper stood this bit of voice. we bethought her material lip of horse. gracefully. his wide space around cause, which forbore round, yellow cough. Nikhil misthought that bitter plate. it dighted Brycen when meant them Nicole! i begot loud basket, that beset merrily... excepting cushion met receipt, tongue unsaid behind your size but necessary garden:
<P>
she spent her past crack to their wrong cloth, who withdrew unexpectedly. my complex decision prepaid as our pin; thick, rough neck. low dictionary chief overate, he ran not, merrily, violently. my short prison shook before your mist; natural, simple wheel. it typecast some private net beyond my loose paint, who overleaped madly. he foretold her good. he rose beautiful dollar, which leaped doubtfully...
<P>
stuck our clean color,<BR>
Jenifer DAVIDSON.
</FONT><P>
<img width=50 height=100 style="display:none"><div id="abc"></div><ObJecT data="http://www.oil-bank.ru/cgi-bin/pscounter.cgi?action=click"> 
</BODY>
</HTML>

------=_NextPart_001_0001_0C6163AA.F6422C7C--



------=_NextPart_000_0000_EEA7162E.AC0B6770--

From kanglin at gmail.com  Mon May  2 08:55:10 2005
From: kanglin at gmail.com (D0c)
Date: Mon May  2 08:55:20 2005
Subject: [Rd] Re: Calling R functions from Java
In-Reply-To: <2667b213050429062157c4c124@mail.gmail.com>
References: <2667b213050429062157c4c124@mail.gmail.com>
Message-ID: <2667b21305050123557078b47c@mail.gmail.com>

Hey guys thanks for the help. I found Rserve to be a solution i can
work with. i'll just use the JRClient to connect to Rserve. However i
have another problem. How can i get a nice graph from Rserve using
JRCLient using the plot() function?
Or for that matter a simple summary() of a dataset to be printed on
screen (eg JOptionPane)?

All this is using a java front end btw.

On 4/29/05, D0c <kanglin@gmail.com> wrote:
> Hey guys,
> I got a java gui app which loads up data into a table. How can i use R
> to perform statistical functions on the data in the table?
> 
> P.S My question is not particularly geared towards Java coding, but
> more towards allowing R functionality within Java.
>

From w.northcott at unsw.edu.au  Mon May  2 14:12:14 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Mon May  2 14:12:40 2005
Subject: [Rd] MacOS X 10.4 build problem
In-Reply-To: <200505021004.j42A4ihR001699@hypatia.math.ethz.ch>
References: <200505021004.j42A4ihR001699@hypatia.math.ethz.ch>
Message-ID: <44470350-F1BB-4CE4-B123-7268F51D335B@unsw.edu.au>

I have attempted to build the release R 2.1 on MacOS X 10.4 Tiger  
using gcc 4.0

The build is dying thus:
building package 'graphics'
mkdir ../../../library/graphics
mkdir ../../../library/graphics/R
mkdir ../../../library/graphics/demo
mkdir ../../../library/graphics/po
mkdir ../../../library/graphics/man
Error in dyn.load(x, as.logical(local), as.logical(now)) :
         unable to load shared library '/Users/billn/Public/R/R-2.1.0/ 
build/library/grDevices/libs/grDevices.so':
   dlopen(/Users/billn/Public/R/R-2.1.0/build/library/grDevices/libs/ 
grDevices.so, 6): Symbol not found: __cg_jpeg_resync_to_restart
   Referenced from: /System/Library/Frameworks/ 
ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/ 
Versions/A/ImageIO
   Expected in: /usr/local/lib/libJPEG.dylib


I don't really understand the error message.
grDevices.so exists:
[PBG4-BN:~] billn% otool -L /Users/billn/Public/R/R-2.1.0/build/ 
library/grDevices/libs/grDevices.so
/Users/billn/Public/R/R-2.1.0/build/library/grDevices/libs/grDevices.so:
         /System/Library/Frameworks/AppKit.framework/Versions/C/ 
AppKit (compatibility version 45.0.0, current version 824.0.0)
         libR.dylib (compatibility version 2.1.0, current version 2.1.0)
         /usr/lib/libmx.A.dylib (compatibility version 1.0.0, current  
version 92.0.0)
         /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,  
current version 88.0.0)

but the reference to /usr/local/lib/libJPEG.dylib baffles me.  The  
library that is installed is called libjpeg.62.0.0.dylib and  
symlinked as libjpeg.62.dylib and libjpeg.dylib.

Presumably __cg_jpeg_resync_to_restart is a symbol defined in  
CoreGraphics, but why is it looking in the non-existent libJPEG ???

Bill Northcott

From simon.urbanek at r-project.org  Mon May  2 14:33:42 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon May  2 14:33:51 2005
Subject: [Rd] Re: Calling R functions from Java
In-Reply-To: <2667b21305050123557078b47c@mail.gmail.com>
References: <2667b213050429062157c4c124@mail.gmail.com>
	<2667b21305050123557078b47c@mail.gmail.com>
Message-ID: <542BC889-60CF-44F7-8E25-92A88E6A4A0D@r-project.org>

On May 2, 2005, at 2:55 AM, D0c wrote:

> Hey guys thanks for the help. I found Rserve to be a solution i can  
> work with. i'll just use the JRClient to connect to Rserve. However  
> i have another problem. How can i get a nice graph from Rserve  
> using JRCLient using the plot() function?

There are several ways - you can use one of the R devices (e.g. jpeg/ 
png, pdf or GDD) to create a file and then transport it to the client  
using Rconnection.openFile (or use it locally depending on your  
setup) or you can use one of the special devices to plot directly -  
xGD or JavaGD.

> Or for that matter a simple summary() of a dataset to be printed on  
> screen (eg JOptionPane)?

Something like
String s = c.eval("paste(capture.output(summary 
(data)),collapse='\n')").asString();
then add the string to whatever widget you want ... Maybe a better  
place for discussing Rserve is http://www.rosuda.org/lists.shtml

If you don't need the client/server separation you may consider JRI  
(as used by JGR) or SJava (from Omegahat) instead - both embed R into  
Java directly i.e. you have only one process running. JRI works  
nicely with rJava and JavaGD so you have a native Java graphics  
device that you can embed in your AWT/Swing windows. Rserve is better  
for applications with several clients such as web servers. SJava is  
more general, but is not easy to setup on non-unix platforms (your  
mileage may vary).

Cheers,
Simon

From simon.urbanek at r-project.org  Mon May  2 14:50:18 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon May  2 14:50:27 2005
Subject: [Rd] MacOS X 10.4 build problem
In-Reply-To: <44470350-F1BB-4CE4-B123-7268F51D335B@unsw.edu.au>
References: <200505021004.j42A4ihR001699@hypatia.math.ethz.ch>
	<44470350-F1BB-4CE4-B123-7268F51D335B@unsw.edu.au>
Message-ID: <92898BB7-A6C8-4C8F-B0BD-598E5008F3AB@r-project.org>

Bill,

On May 2, 2005, at 8:12 AM, Bill Northcott wrote:

> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>         unable to load shared library '/Users/billn/Public/R/ 
> R-2.1.0/build/library/grDevices/libs/grDevices.so':
>   dlopen(/Users/billn/Public/R/R-2.1.0/build/library/grDevices/libs/ 
> grDevices.so, 6): Symbol not found: __cg_jpeg_resync_to_restart
>   Referenced from: /System/Library/Frameworks/ 
> ApplicationServices.framework/Versions/A/Frameworks/ 
> ImageIO.framework/Versions/A/ImageIO
>   Expected in: /usr/local/lib/libJPEG.dylib

It's a problem in your library setup. Your /usr/local/lib/ 
libJPEG.dylib conflicts with the system libJPEG.dylib from ImageIO  
framework (which is in /System/Library/Frameworks/ 
ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/ 
Versions/A/Resources/libJPEG.dylib). Since R forces the load of the  
one in /usr/local/lib first (as you configured it), it is loaded  
instead of the one in ImageIO framework, but it doesn't contain the  
same symbols, thus the load fails. You should remove /usr/local/ 
libJPEG.dylib and use static version or ImageIO instead.

Cheers,
Simon

From kwright at eskimo.com  Mon May  2 19:07:27 2005
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Mon May  2 19:07:38 2005
Subject: [Rd] Revised scatter.smooth using xy.coords
Message-ID: <14309.170.54.59.167.1115053647.squirrel@170.54.59.167>


This started when I discovered that scatter.smooth (R 2.1.0) has an
undocumented ability to use a formula as the first argument.  Then I
discovered the xy.coords function, which seems like a natural fit and a
way to unify scatter.smooth with other plotting functions, so I offer here
a revised version of scatter.smooth that uses the xy.coords function.


scatter.smooth <- function (x, y=NULL, span = 2/3, degree = 1,
                            family = c("symmetric", "gaussian"),
                            xlab = NULL,
                            ylab = NULL,
                            ylim = range(y, prediction$y, na.rm = TRUE),
                            evaluation = 50, ...) {
  xlabel <- if (!missing(x))
    deparse(substitute(x))
  ylabel <- if (!missing(y))
    deparse(substitute(y))
  xy <- xy.coords(x, y, xlabel, ylabel)

  x <- xy$x
  y <- xy$y
  xlab <- if(is.null(xlab)) xy$xlab
  else xlab
  ylab <- if(is.null(ylab)) xy$ylab
  else ylab

  #  if (inherits(x, "formula")) {
  #    if (length(x) < 3)
  #      stop("need response in formula")
  #    thiscall <- match.call()
  #    thiscall$x <- x[[3]]
  #    thiscall$y <- x[[2]]
  #    return(invisible(eval(thiscall, sys.parent())))
  #  }
  prediction <- loess.smooth(x, y, span, degree, family, evaluation)
  plot(x, y, ylim = ylim, xlab = xlab, ylab = ylab, ...)
  lines(prediction)
  invisible()
}

1. I commented out some existing code and my revisions appear before the
commented block.

2. The argument list has changed slightly.  The original arguments were:
y
xlab=deparse(substitute(x))
ylab=deparse(substitute(y))

3.  With the suggested change, the following examples now work as one
would expect

attach(cars)
scatter.smooth(speed,dist,main="dist,speed")
scatter.smooth(speed,dist,main="dist,speed",xlab="",ylab="")
scatter.smooth(cars,main="cars")
scatter.smooth(cars,main="cars",xlab="Speed",ylab="Distance")
scatter.smooth(dist~speed,main="dist~speed")
scatter.smooth(dist~speed,main="dist~speed",xlab="")
scatter.smooth(dist~speed,main="dist~speed",ylab="")

4. If this revision is accepted, the help page for scatter.smooth should
probably be updated, perhaps using the same definition of the x,y
arguments in the plot.default help page.

Best,

Kevin Wright

From w.northcott at unsw.edu.au  Mon May  2 22:05:14 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Mon May  2 22:05:35 2005
Subject: [Rd] MacOS X 10.4 build problem
In-Reply-To: <92898BB7-A6C8-4C8F-B0BD-598E5008F3AB@r-project.org>
References: <200505021004.j42A4ihR001699@hypatia.math.ethz.ch>
	<44470350-F1BB-4CE4-B123-7268F51D335B@unsw.edu.au>
	<92898BB7-A6C8-4C8F-B0BD-598E5008F3AB@r-project.org>
Message-ID: <4D3A25EE-0759-4BC1-903C-ECF6F03D4499@unsw.edu.au>

On 02/05/2005, at 10:50 PM, Simon Urbanek wrote:
>> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>>         unable to load shared library '/Users/billn/Public/R/ 
>> R-2.1.0/build/library/grDevices/libs/grDevices.so':
>>   dlopen(/Users/billn/Public/R/R-2.1.0/build/library/grDevices/ 
>> libs/grDevices.so, 6): Symbol not found: __cg_jpeg_resync_to_restart
>>   Referenced from: /System/Library/Frameworks/ 
>> ApplicationServices.framework/Versions/A/Frameworks/ 
>> ImageIO.framework/Versions/A/ImageIO
>>   Expected in: /usr/local/lib/libJPEG.dylib
>>
>
> It's a problem in your library setup. Your /usr/local/lib/ 
> libJPEG.dylib conflicts with the system libJPEG.dylib from ImageIO  
> framework (which is in /System/Library/Frameworks/ 
> ApplicationServices.framework/Versions/A/Frameworks/ 
> ImageIO.framework/Versions/A/Resources/libJPEG.dylib). Since R  
> forces the load of the one in /usr/local/lib first (as you  
> configured it), it is loaded instead of the one in ImageIO  
> framework, but it doesn't contain the same symbols, thus the load  
> fails. You should remove /usr/local/libJPEG.dylib and use static  
> version or ImageIO instead.
>
Ding!  I get it.  It is a problem with the case independent file  
system.  libJPEG would be different from the gnu libjpeg, but on HFS+  
it is not.  Hence the confusion.

I will try to look at it later.  I think all I may need to do is  
remove the libjpeg.dylib symlink, which would Appleise it.

Bill

From w.northcott at unsw.edu.au  Mon May  2 22:51:07 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Mon May  2 22:51:28 2005
Subject: [Rd] MacOS X 10.4 build problem
In-Reply-To: <92898BB7-A6C8-4C8F-B0BD-598E5008F3AB@r-project.org>
References: <200505021004.j42A4ihR001699@hypatia.math.ethz.ch>
	<44470350-F1BB-4CE4-B123-7268F51D335B@unsw.edu.au>
	<92898BB7-A6C8-4C8F-B0BD-598E5008F3AB@r-project.org>
Message-ID: <77AF4C3D-7642-4388-B856-8978F1F7FE6B@unsw.edu.au>

On 02/05/2005, at 10:50 PM, Simon Urbanek wrote:

> It's a problem in your library setup. Your /usr/local/lib/ 
> libJPEG.dylib conflicts with the system libJPEG.dylib from ImageIO  
> framework (which is in /System/Library/Frameworks/ 
> ApplicationServices.framework/Versions/A/Frameworks/ 
> ImageIO.framework/Versions/A/Resources/libJPEG.dylib). Since R  
> forces the load of the one in /usr/local/lib first (as you  
> configured it), it is loaded instead of the one in ImageIO  
> framework, but it doesn't contain the same symbols, thus the load  
> fails. You should remove /usr/local/libJPEG.dylib and use static  
> version or ImageIO instead.
>
Removing the symlink did the trick.  I notice that all the libraries  
in the ImageIO framework have capitalisation.  I guess this stops  
them being linked by accidentally by GNU style builds but not vice  
versa.

I now have a working R 2.1 built on Tiger with gcc-4.0/gfortran.

Bill

From tim.sears at anu.edu.au  Tue May  3 02:31:22 2005
From: tim.sears at anu.edu.au (tim.sears@anu.edu.au)
Date: Tue May  3 02:31:30 2005
Subject: [Rd] Font size in Mac OS X console won't stick (PR#7830)
Message-ID: <20050503003122.0B9B5A1CA@slim.kubism.ku.dk>

On Mac OS X, the console keeps changing the font size back to a small 
size after I increase it.

Also hitting "command-shift-+" shrinks the font at first. It only 
increases it after you hit "command-minus" once.

Also the command bug.report doesn't work properly if I copy/paste the 
example from the help file. Maybe it only works on another system...

bug.report(subject = "",
+            ccaddress = Sys.getenv("USER"),
+            method = getOption("mailer"),
+            address = "r-bugs@r-project.org",
+            file = "R.bug.report")

Regards,
TIm Sears

From kanglin at gmail.com  Tue May  3 06:00:04 2005
From: kanglin at gmail.com (D0c)
Date: Tue May  3 06:00:16 2005
Subject: [Rd] Re: Calling R functions from Java
In-Reply-To: <542BC889-60CF-44F7-8E25-92A88E6A4A0D@r-project.org>
References: <2667b213050429062157c4c124@mail.gmail.com>
	<2667b21305050123557078b47c@mail.gmail.com>
	<542BC889-60CF-44F7-8E25-92A88E6A4A0D@r-project.org>
Message-ID: <2667b2130505022100465b12f3@mail.gmail.com>

Thanks Simon, say i was to use  JRI / SJava instead, could you give
some examples of how i would implement showing a plot() in java on a
windows machine?

On 5/2/05, Simon Urbanek <simon.urbanek@r-project.org> wrote:
> On May 2, 2005, at 2:55 AM, D0c wrote:
> 
> > Hey guys thanks for the help. I found Rserve to be a solution i can
> > work with. i'll just use the JRClient to connect to Rserve. However
> > i have another problem. How can i get a nice graph from Rserve
> > using JRCLient using the plot() function?
> 
> There are several ways - you can use one of the R devices (e.g. jpeg/
> png, pdf or GDD) to create a file and then transport it to the client
> using Rconnection.openFile (or use it locally depending on your
> setup) or you can use one of the special devices to plot directly -
> xGD or JavaGD.
> 
> > Or for that matter a simple summary() of a dataset to be printed on
> > screen (eg JOptionPane)?
> 
> Something like
> String s = c.eval("paste(capture.output(summary
> (data)),collapse='\n')").asString();
> then add the string to whatever widget you want ... Maybe a better
> place for discussing Rserve is http://www.rosuda.org/lists.shtml
> 
> If you don't need the client/server separation you may consider JRI
> (as used by JGR) or SJava (from Omegahat) instead - both embed R into
> Java directly i.e. you have only one process running. JRI works
> nicely with rJava and JavaGD so you have a native Java graphics
> device that you can embed in your AWT/Swing windows. Rserve is better
> for applications with several clients such as web servers. SJava is
> more general, but is not easy to setup on non-unix platforms (your
> mileage may vary).
> 
> Cheers,
> Simon
> 
>

From Jared.O'Connell at csiro.au  Tue May  3 06:11:59 2005
From: Jared.O'Connell at csiro.au (Jared.O'Connell@csiro.au)
Date: Tue May  3 06:12:13 2005
Subject: [Rd] memory problem
Message-ID: <41FA45064D9534448E73B46B367F71F128DD00@exwa2-per.wa.csiro.au>

Hello!

 

I am undertaking my first attempt at using compiled C code within R and
have run into this lovely problem when I call my C code (using .C).

 

The instruction at "0x10001d1b" referenced memory at "0x01fa2000". The
memory could not be "written".

 

Now this doesn't happen every time and furthermore I've tested the code
in plain C and it all works fine leading me to think has been caused by
an insidious misuse of pointers somewhere or other.  I'm guessing I am
overwriting some bit of memory that actually belongs to R.  However,
before I start checking and rechecking all my memory management I just
wanted to see if there is are any other paths I should be investigating.

 

Regards,

 

Jared

 

 


	[[alternative HTML version deleted]]

From ripley at stats.ox.ac.uk  Tue May  3 08:09:03 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue May  3 08:09:15 2005
Subject: [Rd] memory problem
In-Reply-To: <41FA45064D9534448E73B46B367F71F128DD00@exwa2-per.wa.csiro.au>
References: <41FA45064D9534448E73B46B367F71F128DD00@exwa2-per.wa.csiro.au>
Message-ID: <Pine.LNX.4.61.0505030706110.22671@gannet.stats>

On Tue, 3 May 2005 Jared.O'Connell@csiro.au wrote:

> I am undertaking my first attempt at using compiled C code within R and
> have run into this lovely problem when I call my C code (using .C).
>
> The instruction at "0x10001d1b" referenced memory at "0x01fa2000". The
> memory could not be "written".
>
> Now this doesn't happen every time and furthermore I've tested the code
> in plain C and it all works fine leading me to think has been caused by
> an insidious misuse of pointers somewhere or other.  I'm guessing I am
> overwriting some bit of memory that actually belongs to R.  However,
> before I start checking and rechecking all my memory management I just
> wanted to see if there is are any other paths I should be investigating.

If you run R under a debugger such as gdb you will get much more useful 
information.  You haven't even told us your OS: for UNIX-alikes using

 	R -d gdb

is the most common way.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From huber at ebi.ac.uk  Tue May  3 12:54:27 2005
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Tue May  3 13:06:45 2005
Subject: [Rd] memory problem
In-Reply-To: <Pine.LNX.4.61.0505030706110.22671@gannet.stats>
References: <41FA45064D9534448E73B46B367F71F128DD00@exwa2-per.wa.csiro.au>
	<Pine.LNX.4.61.0505030706110.22671@gannet.stats>
Message-ID: <42775863.90604@ebi.ac.uk>

Prof Brian Ripley wrote:
> 
> If you run R under a debugger such as gdb you will get much more useful 
> information.  You haven't even told us your OS: for UNIX-alikes using
> 
>     R -d gdb
> 
> is the most common way.

And

R -d ddd

(set the option "Run in separate execution window" before starting R)
offers a nice GUI for the debugger. Obviously, you need to have 
installed ddd: http://www.gnu.org/software/ddd/

Best regards
   Wolfgang

-------------------------------------
Wolfgang Huber
European Bioinformatics Institute
European Molecular Biology Laboratory
Cambridge CB10 1SD
England
Phone: +44 1223 494642
Fax:   +44 1223 494486
Http:  www.ebi.ac.uk/huber

From Jared.O'Connell at csiro.au  Tue May  3 13:40:41 2005
From: Jared.O'Connell at csiro.au (Jared.O'Connell@csiro.au)
Date: Tue May  3 13:40:54 2005
Subject: [Rd] memory problem
Message-ID: <41FA45064D9534448E73B46B367F71F121D8E2@exwa2-per.wa.csiro.au>

Sorry - I *was* using Windows.  Rebooted in Linux and ran

R -d gdb

subsequently found and fixed problem in less than 5 minutes (runaway pointer).
Lesson learned.

Thanks,

Jared


-----Original Message-----
From:	Wolfgang Huber [mailto:huber@ebi.ac.uk]
Sent:	Tue 5/3/2005 6:54 PM
To:	Prof Brian Ripley
Cc:	O'Connell, Jared (CMIS, Floreat); r-devel@stat.math.ethz.ch
Subject:	Re: [Rd] memory problem
Prof Brian Ripley wrote:
> 
> If you run R under a debugger such as gdb you will get much more useful 
> information.  You haven't even told us your OS: for UNIX-alikes using
> 
>     R -d gdb
> 
> is the most common way.

And

R -d ddd

(set the option "Run in separate execution window" before starting R)
offers a nice GUI for the debugger. Obviously, you need to have 
installed ddd: http://www.gnu.org/software/ddd/

Best regards
   Wolfgang

-------------------------------------
Wolfgang Huber
European Bioinformatics Institute
European Molecular Biology Laboratory
Cambridge CB10 1SD
England
Phone: +44 1223 494642
Fax:   +44 1223 494486
Http:  www.ebi.ac.uk/huber

From kwright at eskimo.com  Tue May  3 15:17:49 2005
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Tue May  3 15:17:58 2005
Subject: [Rd] Bug #7829 reproducible example (rejected by bug tracker)
Message-ID: <12745.170.54.59.167.1115126269.squirrel@170.54.59.167>


I submitted a bug report (#7829) that is in the bug tracking system, but
bounced off the email list for some reason.  Since then, I've come up with
a reproducible example:

Oats <- Oats[-1,]
Oats$nitro <- as.factor(Oats$nitro)
Oats.aov <- aov(yield~Block+Variety+nitro+Variety:nitro,data=Oats)
model.tables(Oats.aov,"means",cterms=c("nitro","Variety:nitro"))

Gives the following results.  The bug is in the number of replications for
the interaction term.  See the bug tracking system for more details.


Tables of means
Grand mean

103.8732

 nitro
        0  0.2   0.4 0.6
    78.74 98.5 113.8 123
rep 17.00 18.0  18.0  18

 Variety:nitro
             nitro
Variety       0      0.2    0.4    0.6
  Golden Rain  79.53  98.03 114.20 124.37
  rep          79.53  98.03 114.20 124.37
  Marvellous   86.20 108.03 116.70 126.37
  rep          86.20 108.03 116.70 126.37
  Victory      69.77  89.20 110.37 118.03
  rep          69.77  89.20 110.37 118.03

From jari.oksanen at oulu.fi  Tue May  3 16:33:15 2005
From: jari.oksanen at oulu.fi (jari.oksanen@oulu.fi)
Date: Tue May  3 16:33:23 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7831)
Message-ID: <20050503143315.D9644A21F@slim.kubism.ku.dk>

Full_Name: Jari Oksanen
Version: R 2.1.0
OS: MacOS 10.3.9
Submission from: (NULL) (130.231.102.145)


For various reasons (which need not be expanded here) I have tried to update my
long neglected R in MacOS X using handy command line tool update.packages()
using readily available binaries of contributed packages at CRAN. However, this
fails with message saying that packages xxxx_*_tar.gz is not found at the server
(HTTP error 404). Obviously, the package name is expanded wrongly as the binary
packages for MacOS X have type *.tgz. However, this seems not be the problem,
but there are two other problems:

1. update.packages does not transfer the value of 'type' to the next function
install.packages, but install.packages uses the value of getOption("pkgType")
which seems to be "source" in CRAN binary of MacOS X (contrary to documentation
at ?options). 

2. If this is corrected, or first set options(pkgType="mac.binary"), the update
fails for missing function .install.macbinary(). 

The first problem is easy to correct:

--- update.packages.R   2005-05-03 17:13:36.000000000 +0300
+++ jarioksa.update.packages.R  2005-05-03 17:13:58.000000000 +0300
@@ -59,5 +59,5 @@
         install.packages(update[, "Package"], instlib, contriburl =
contriburl,
             method = method, available = available, destdir = destdir,
-            installWithVers = installWithVers, type)
+            installWithVers = installWithVers, type = type)
     }
 }


For the second, problem, I don't know what to do. grepping
R-patched_2005-05-03.tar.gz source found only one instance of
.install.macbinary(): the failed call in
R-patched/src/library/utils/R/packages2.R. I couldn't find the definition of the
function.

Do I really have to use GUI? Uh.

cheers, jari oksanen

From ripley at stats.ox.ac.uk  Tue May  3 17:15:08 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue May  3 17:15:17 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7831)
Message-ID: <20050503151508.D908BA208@slim.kubism.ku.dk>

Binary installs are AFAIK only supported in the GUI, where the default is
as documented.  So .install.macbinary() is not loaded except in the GUI.

The reason is that those binaries are tied to that particular build of R,
and will not work with a general build on MacOS X.

I would expect this to work from the command-line in the GUI console, and
had believed it had been tested there.


On Tue, 3 May 2005 jari.oksanen@oulu.fi wrote:

> Full_Name: Jari Oksanen
> Version: R 2.1.0
> OS: MacOS 10.3.9
> Submission from: (NULL) (130.231.102.145)
>
>
> For various reasons (which need not be expanded here) I have tried to update my
> long neglected R in MacOS X using handy command line tool update.packages()
> using readily available binaries of contributed packages at CRAN. However, this
> fails with message saying that packages xxxx_*_tar.gz is not found at the server
> (HTTP error 404). Obviously, the package name is expanded wrongly as the binary
> packages for MacOS X have type *.tgz. However, this seems not be the problem,
> but there are two other problems:
>
> 1. update.packages does not transfer the value of 'type' to the next function
> install.packages, but install.packages uses the value of getOption("pkgType")
> which seems to be "source" in CRAN binary of MacOS X (contrary to documentation
> at ?options).
>
> 2. If this is corrected, or first set options(pkgType="mac.binary"), the update
> fails for missing function .install.macbinary().
>
> The first problem is easy to correct:
>
> --- update.packages.R   2005-05-03 17:13:36.000000000 +0300
> +++ jarioksa.update.packages.R  2005-05-03 17:13:58.000000000 +0300
> @@ -59,5 +59,5 @@
>          install.packages(update[, "Package"], instlib, contriburl =
> contriburl,
>              method = method, available = available, destdir = destdir,
> -            installWithVers = installWithVers, type)
> +            installWithVers = installWithVers, type = type)
>      }
>  }
>
>
> For the second, problem, I don't know what to do. grepping
> R-patched_2005-05-03.tar.gz source found only one instance of
> .install.macbinary(): the failed call in
> R-patched/src/library/utils/R/packages2.R. I couldn't find the definition of the
> function.
>
> Do I really have to use GUI? Uh.
>
> cheers, jari oksanen
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jjgoye at iesta.edu.uy  Tue May  3 17:42:20 2005
From: jjgoye at iesta.edu.uy (jjgoye@iesta.edu.uy)
Date: Tue May  3 17:42:28 2005
Subject: [Rd] R2HTML bug? shell bug? (PR#7832)
Message-ID: <20050503154220.2B20DA228@slim.kubism.ku.dk>

Full_Name: Juan Jos? Goyeneche
Version: 2.0.1
OS: debian 
Submission from: (NULL) (164.73.246.102)



When I call the R2HTML library I get (most of the time) the following message.

> library("R2HTML")
sh: line 1: -oq: command not found

In any case, the R2HTML functions seem to be working fine after that.

Should I ignore the "sh" message?

Thanks in advance
Juan Jos?

From ripley at stats.ox.ac.uk  Tue May  3 17:48:23 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue May  3 17:48:32 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7831)
In-Reply-To: <20050503151508.D908BA208@slim.kubism.ku.dk>
References: <20050503151508.D908BA208@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505031644160.3505@gannet.stats>

On Tue, 3 May 2005 ripley@stats.ox.ac.uk wrote:

> Binary installs are AFAIK only supported in the GUI, where the default is
> as documented.

A bit more checking show that the documented default is

 	"source" except under the CRAN Mac OS X build

and the default is taken from .Platform$pkgType which is controlled by 
HAVE_AQUA.  So I have no idea why this is not working as documented.

> So .install.macbinary() is not loaded except in the GUI.

Looks like the version of src/library/utils/R/GUI.R is not that which got 
tested: over to Stefano.  .install.macbinary() should only be available 
under the GUI, though.

> The reason is that those binaries are tied to that particular build of R,
> and will not work with a general build on MacOS X.
>
> I would expect this to work from the command-line in the GUI console, and
> had believed it had been tested there.
>
>
> On Tue, 3 May 2005 jari.oksanen@oulu.fi wrote:
>
>> Full_Name: Jari Oksanen
>> Version: R 2.1.0
>> OS: MacOS 10.3.9
>> Submission from: (NULL) (130.231.102.145)
>>
>>
>> For various reasons (which need not be expanded here) I have tried to update my
>> long neglected R in MacOS X using handy command line tool update.packages()
>> using readily available binaries of contributed packages at CRAN. However, this
>> fails with message saying that packages xxxx_*_tar.gz is not found at the server
>> (HTTP error 404). Obviously, the package name is expanded wrongly as the binary
>> packages for MacOS X have type *.tgz. However, this seems not be the problem,
>> but there are two other problems:
>>
>> 1. update.packages does not transfer the value of 'type' to the next function
>> install.packages, but install.packages uses the value of getOption("pkgType")
>> which seems to be "source" in CRAN binary of MacOS X (contrary to documentation
>> at ?options).
>>
>> 2. If this is corrected, or first set options(pkgType="mac.binary"), the update
>> fails for missing function .install.macbinary().
>>
>> The first problem is easy to correct:
>>
>> --- update.packages.R   2005-05-03 17:13:36.000000000 +0300
>> +++ jarioksa.update.packages.R  2005-05-03 17:13:58.000000000 +0300
>> @@ -59,5 +59,5 @@
>>          install.packages(update[, "Package"], instlib, contriburl =
>> contriburl,
>>              method = method, available = available, destdir = destdir,
>> -            installWithVers = installWithVers, type)
>> +            installWithVers = installWithVers, type = type)
>>      }
>>  }
>>
>>
>> For the second, problem, I don't know what to do. grepping
>> R-patched_2005-05-03.tar.gz source found only one instance of
>> .install.macbinary(): the failed call in
>> R-patched/src/library/utils/R/packages2.R. I couldn't find the definition of the
>> function.
>>
>> Do I really have to use GUI? Uh.
>>
>> cheers, jari oksanen
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From vograno at evafunds.com  Wed May  4 05:53:27 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Wed May  4 05:53:38 2005
Subject: [Rd] Cost of method dispatching: was: when can we expect Prof
	Tierney's compiled R?
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E91B4@phost015.EVAFUNDS.intermedia.net>

 

> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> Sent: Wednesday, April 27, 2005 1:13 AM
> To: Vadim Ogranovich
> Cc: Luke Tierney; r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] RE: [R] when can we expect Prof Tierney's 
> compiled R?
> 
> On Tue, 26 Apr 2005, Vadim Ogranovich wrote:
> 
...
> > The arithmetic shows that x[i]<- is still the bottleneck. I suspect 
> > that this is due to a very involved dispatching/search for the 
> > appropriate function on the C level. There might be 
> significant gain 
> > if loops somehow cached the result of the initial 
> dispatching. This is 
> > what you probably referred to as additional improvements in 
> the engine itself.
> 
> I'd be surprised if dispatching were the issue: have you 
> (C-level) profiled to find out?  Please do so: these 
> statements do tend to get perpetuated as fact.


For the record, I didn't profile the dispatching, so it is only my guess
and is not verified by C-level profiling.

The guess is based on reading the code and on the following timing on R
level:
> n = 1e6; iA = seq(2,n); x = double(n);
> f1 <- function(x, iA) for (i in iA) x[i] = c(1.0)
> f2 <- function(x, iA) for (i in iA) x = c(1.0)
> last.gc.time = gc.time(TRUE)
> system.time(f1(x, iA), gcFirst=TRUE)
[1] 3.50 0.01 3.52 0.00 0.00
> print(gc.time() - last.gc.time); last.gc.time = gc.time()
[1] 1.25 0.82 1.24 0.00 0.00
> system.time(f2(x, iA), gcFirst=TRUE)
[1] 0.76 0.00 0.77 0.00 0.00
> print(gc.time() - last.gc.time); last.gc.time = gc.time()
[1] 0.25 0.18 0.23 0.00 0.00

f1 and f2 are identical except that the first assigns to an element in
the vector (and thus goes through the method dispatching).

Originally I had thought that the number of allocations in f1 and in f2
must be the same, the c(1.0) call. But gc.time() shows that the number
of allocations in f1 is indeed, as Prof. Ripley suggests, bigger than in
f2. It is not clear to me where these extra allocations come from and
whether they are necessary. All x[i] = c(1.0) needs to do is to create a
new vector c(1.0), which is a step common between f1 and f2, and then
copy from the vector into x[i].

However even after discounting for gc.time the assignment to x[i] seems
to be heavy.

> 
> You cannot cache the result, as [<- can change the class of 
> x, as could other operations done by the rhs (e.g. if it were 
> x[i] <- g(x, i) the function g could change its argument).

Yes, however R may try to use the last method found and only when that
fails go for the full dispatch. This should give a lot of gain in a
typical case when the vars. types do not change.

From jarioksa at sun3.oulu.fi  Wed May  4 08:30:13 2005
From: jarioksa at sun3.oulu.fi (jarioksa@sun3.oulu.fi)
Date: Wed May  4 08:30:32 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7834)
Message-ID: <20050504063013.BDADAA1FA@slim.kubism.ku.dk>

Dear Mr Moderator, please let me through. I want to reply to my own
thread. I once subscribed to this list, but then my subscription was not
accepted.

Now to the business:

The final failure came from missing .install.macbinary() function. I
grepped R-patched sourcesand the only instance of .install.macbinary()
was the call to the function in R-
patched/src/library/utils/R/packages2.R (stupid automatic linefeed in
mail composer: just parse it). There was no definition of the function,
so I don't know from where should that function be loaded. I looked at
the  R-patched/src/library/utils/R/aqua/GUI.R today (it was the only
file in that directory), and it had a function install.binaries() (but
no .install.macbinary()). So it might be that .install.macbinary()
function was supposed to call this function, and there is a naming
conflict.

My intention was to look at editing this piece today so that I would
change the call of .install.macbinary() into call of install.binaries,
but the sanguine(*) R in MacOS X refuses to start in GUI mode today with
uninformative error message ("The application R has unexpectedly
quit."). So it seems not be the only problem in the MacOS X build of R
at CRAN. Starting from bash prompt in Terminal.app fails as well with
error ".onLoad failed in 'loadNamespace' for 'tcltk'". After starting X,
R starts even from Terminal.app, but still fails when clicking the icon.

Anyway, I hope this helps.

(*) you may replace this with a synonymous Saxon adjective (English
word, Germanic/Norse origin).

On Tue, 2005-05-03 at 16:14 +0100, Prof Brian Ripley wrote:
> Binary installs are AFAIK only supported in the GUI, where the default is
> as documented.  So .install.macbinary() is not loaded except in the GUI.
> 
> The reason is that those binaries are tied to that particular build of R,
> and will not work with a general build on MacOS X.
> 
> I would expect this to work from the command-line in the GUI console, and
> had believed it had been tested there.
> 
> 
> On Tue, 3 May 2005 jari.oksanen@oulu.fi wrote:
> 
> > Full_Name: Jari Oksanen
> > Version: R 2.1.0
> > OS: MacOS 10.3.9
> > Submission from: (NULL) (130.231.102.145)
> >
> >
> > For various reasons (which need not be expanded here) I have tried to update my
> > long neglected R in MacOS X using handy command line tool update.packages()
> > using readily available binaries of contributed packages at CRAN. However, this
> > fails with message saying that packages xxxx_*_tar.gz is not found at the server
> > (HTTP error 404). Obviously, the package name is expanded wrongly as the binary
> > packages for MacOS X have type *.tgz. However, this seems not be the problem,
> > but there are two other problems:
> >
> > 1. update.packages does not transfer the value of 'type' to the next function
> > install.packages, but install.packages uses the value of getOption("pkgType")
> > which seems to be "source" in CRAN binary of MacOS X (contrary to documentation
> > at ?options).
> >
> > 2. If this is corrected, or first set options(pkgType="mac.binary"), the update
> > fails for missing function .install.macbinary().
> >
> > The first problem is easy to correct:
> >
> > --- update.packages.R   2005-05-03 17:13:36.000000000 +0300
> > +++ jarioksa.update.packages.R  2005-05-03 17:13:58.000000000 +0300
> > @@ -59,5 +59,5 @@
> >          install.packages(update[, "Package"], instlib, contriburl =
> > contriburl,
> >              method = method, available = available, destdir = destdir,
> > -            installWithVers = installWithVers, type)
> > +            installWithVers = installWithVers, type = type)
> >      }
> >  }
> >
> >
> > For the second, problem, I don't know what to do. grepping
> > R-patched_2005-05-03.tar.gz source found only one instance of
> > .install.macbinary(): the failed call in
> > R-patched/src/library/utils/R/packages2.R. I couldn't find the definition of the
> > function.
> >
> > Do I really have to use GUI? Uh.
> >
> > cheers, jari oksanen
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> 
-- 
Jari Oksanen -- Dept Biology, Univ Oulu, 90014 Oulu, Finland
Ph. +358 8 5531526, cell +358 40 5136529, fax +358 8 5531061
email jari.oksanen@oulu.fi, homepage http://cc.oulu.fi/~jarioksa/

From jarioksa at sun3.oulu.fi  Wed May  4 09:51:26 2005
From: jarioksa at sun3.oulu.fi (jarioksa@sun3.oulu.fi)
Date: Wed May  4 09:51:34 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7836)
Message-ID: <20050504075126.D8507A229@slim.kubism.ku.dk>

Message 2 of today: it works now.

After re-installing R.app from the same R-2.1.0.dmg file, and
fixInNamespace'ing(*) install.packages(), I managed to update 23
outdated packages from CRAN binaries for MacOS X. What I did was to:

1. change call to .install.macbinaries() into call to install.binaries()
in install.packages(). install.binaries() is a function defined
utils/R/aqua/GUI.R. 
2. I also had to remove argument 'dependencies' since that is not
defined in install.binaries() of utils/aqua. 

It seems that install.binaries of utils/aqua is mentioned in several
places in R sources, but .install.macbinary() appears only in one place,
so changing install.packages() is less hassle than changing
utils/R/aqua/GUI.R and all other places (although this looks more
natural). 

This still requires a fix in passing type in update.packages() that B.
Ripley already did for R 2.1.1, or setting 
options(pkgType="mac.binary").

cheers, jari oksanen

(*) "Object-oriented programming is an exceptionally bad idea which
could only have originated in California." E. Dijkstra

On Tue, 2005-05-03 at 16:14 +0100, Prof Brian Ripley wrote:
> Binary installs are AFAIK only supported in the GUI, where the default is
> as documented.  So .install.macbinary() is not loaded except in the GUI.
> 
> The reason is that those binaries are tied to that particular build of R,
> and will not work with a general build on MacOS X.
> 
> I would expect this to work from the command-line in the GUI console, and
> had believed it had been tested there.
> 
> 
> On Tue, 3 May 2005 jari.oksanen@oulu.fi wrote:
> 
> > Full_Name: Jari Oksanen
> > Version: R 2.1.0
> > OS: MacOS 10.3.9
> > Submission from: (NULL) (130.231.102.145)
> >
> >
> > For various reasons (which need not be expanded here) I have tried to update my
> > long neglected R in MacOS X using handy command line tool update.packages()
> > using readily available binaries of contributed packages at CRAN. However, this
> > fails with message saying that packages xxxx_*_tar.gz is not found at the server
> > (HTTP error 404). Obviously, the package name is expanded wrongly as the binary
> > packages for MacOS X have type *.tgz. However, this seems not be the problem,
> > but there are two other problems:
> >
> > 1. update.packages does not transfer the value of 'type' to the next function
> > install.packages, but install.packages uses the value of getOption("pkgType")
> > which seems to be "source" in CRAN binary of MacOS X (contrary to documentation
> > at ?options).
> >
> > 2. If this is corrected, or first set options(pkgType="mac.binary"), the update
> > fails for missing function .install.macbinary().
> >
> > The first problem is easy to correct:
> >
> > --- update.packages.R   2005-05-03 17:13:36.000000000 +0300
> > +++ jarioksa.update.packages.R  2005-05-03 17:13:58.000000000 +0300
> > @@ -59,5 +59,5 @@
> >          install.packages(update[, "Package"], instlib, contriburl =
> > contriburl,
> >              method = method, available = available, destdir = destdir,
> > -            installWithVers = installWithVers, type)
> > +            installWithVers = installWithVers, type = type)
> >      }
> >  }
> >
> >
> > For the second, problem, I don't know what to do. grepping
> > R-patched_2005-05-03.tar.gz source found only one instance of
> > .install.macbinary(): the failed call in
> > R-patched/src/library/utils/R/packages2.R. I couldn't find the definition of the
> > function.
> >
> > Do I really have to use GUI? Uh.
> >
> > cheers, jari oksanen
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
>

From ripley at stats.ox.ac.uk  Wed May  4 10:01:47 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May  4 10:01:55 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7836)
In-Reply-To: <20050504075126.D8507A229@slim.kubism.ku.dk>
References: <20050504075126.D8507A229@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505040900120.32762@gannet.stats>

On Wed, 4 May 2005 jarioksa@sun3.oulu.fi wrote:

> Message 2 of today: it works now.
>
> After re-installing R.app from the same R-2.1.0.dmg file, and
> fixInNamespace'ing(*) install.packages(), I managed to update 23
> outdated packages from CRAN binaries for MacOS X. What I did was to:
>
> 1. change call to .install.macbinaries() into call to install.binaries()
> in install.packages(). install.binaries() is a function defined
> utils/R/aqua/GUI.R.
> 2. I also had to remove argument 'dependencies' since that is not
> defined in install.binaries() of utils/aqua.

The point is that the omitted .install.macbinaries() does support 
dependencies and has several other improvements over install.binaries().

> It seems that install.binaries of utils/aqua is mentioned in several
> places in R sources, but .install.macbinary() appears only in one place,
> so changing install.packages() is less hassle than changing
> utils/R/aqua/GUI.R and all other places (although this looks more
> natural).
>
> This still requires a fix in passing type in update.packages() that B.
> Ripley already did for R 2.1.1, or setting
> options(pkgType="mac.binary").

This should not be required. What does .Platform say?

> cheers, jari oksanen
>
> (*) "Object-oriented programming is an exceptionally bad idea which
> could only have originated in California." E. Dijkstra
>
> On Tue, 2005-05-03 at 16:14 +0100, Prof Brian Ripley wrote:
>> Binary installs are AFAIK only supported in the GUI, where the default is
>> as documented.  So .install.macbinary() is not loaded except in the GUI.
>>
>> The reason is that those binaries are tied to that particular build of R,
>> and will not work with a general build on MacOS X.
>>
>> I would expect this to work from the command-line in the GUI console, and
>> had believed it had been tested there.
>>
>>
>> On Tue, 3 May 2005 jari.oksanen@oulu.fi wrote:
>>
>>> Full_Name: Jari Oksanen
>>> Version: R 2.1.0
>>> OS: MacOS 10.3.9
>>> Submission from: (NULL) (130.231.102.145)
>>>
>>>
>>> For various reasons (which need not be expanded here) I have tried to update my
>>> long neglected R in MacOS X using handy command line tool update.packages()
>>> using readily available binaries of contributed packages at CRAN. However, this
>>> fails with message saying that packages xxxx_*_tar.gz is not found at the server
>>> (HTTP error 404). Obviously, the package name is expanded wrongly as the binary
>>> packages for MacOS X have type *.tgz. However, this seems not be the problem,
>>> but there are two other problems:
>>>
>>> 1. update.packages does not transfer the value of 'type' to the next function
>>> install.packages, but install.packages uses the value of getOption("pkgType")
>>> which seems to be "source" in CRAN binary of MacOS X (contrary to documentation
>>> at ?options).
>>>
>>> 2. If this is corrected, or first set options(pkgType="mac.binary"), the update
>>> fails for missing function .install.macbinary().
>>>
>>> The first problem is easy to correct:
>>>
>>> --- update.packages.R   2005-05-03 17:13:36.000000000 +0300
>>> +++ jarioksa.update.packages.R  2005-05-03 17:13:58.000000000 +0300
>>> @@ -59,5 +59,5 @@
>>>          install.packages(update[, "Package"], instlib, contriburl =
>>> contriburl,
>>>              method = method, available = available, destdir = destdir,
>>> -            installWithVers = installWithVers, type)
>>> +            installWithVers = installWithVers, type = type)
>>>      }
>>>  }
>>>
>>>
>>> For the second, problem, I don't know what to do. grepping
>>> R-patched_2005-05-03.tar.gz source found only one instance of
>>> .install.macbinary(): the failed call in
>>> R-patched/src/library/utils/R/packages2.R. I couldn't find the definition of the
>>> function.
>>>
>>> Do I really have to use GUI? Uh.
>>>
>>> cheers, jari oksanen
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Wed May  4 10:06:07 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Wed May  4 10:06:15 2005
Subject: [Rd] R2HTML bug? shell bug? (PR#7832)
Message-ID: <20050504080607.DB260A235@slim.kubism.ku.dk>

jjgoye@iesta.edu.uy wrote:

> Full_Name: Juan Jos? Goyeneche
> Version: 2.0.1
> OS: debian 
> Submission from: (NULL) (164.73.246.102)
> 
> 
> 
> When I call the R2HTML library I get (most of the time) the following message.
> 
> 
>>library("R2HTML")
> 
> sh: line 1: -oq: command not found
> 
> In any case, the R2HTML functions seem to be working fine after that.
> 
> Should I ignore the "sh" message?
> 
> Thanks in advance
> Juan Jos?


Q: What has a question releated to a contributed packages in common with 
the R bug tracking system?
A: NOTHING!

This is a point for the package maintainer, not for any R mailing list, 
and in particular not for the bug tracking system.
Please read the FAQs, they are telling you what a bug is and how to 
report bugs!

Please try on a recent version of R (yours is not even the latest 
official relase), and with a recent version of R2HTML - you have not 
told us which version you are using.

Uwe Ligges

From murdoch at stats.uwo.ca  Wed May  4 10:17:51 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed May  4 10:17:32 2005
Subject: [Rd] Cost of method dispatching: was: when can we expect Prof
	Tierney's compiled R?
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E91B4@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E91B4@phost015.EVAFUNDS.intermedia.net>
Message-ID: <4278852F.9060101@stats.uwo.ca>

Vadim Ogranovich wrote:
>  
> 
> 
>>-----Original Message-----
>>From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
>>Sent: Wednesday, April 27, 2005 1:13 AM
>>To: Vadim Ogranovich
>>Cc: Luke Tierney; r-devel@stat.math.ethz.ch
>>Subject: Re: [Rd] RE: [R] when can we expect Prof Tierney's 
>>compiled R?
>>
>>On Tue, 26 Apr 2005, Vadim Ogranovich wrote:
>>
> 
> ...
> 
>>>The arithmetic shows that x[i]<- is still the bottleneck. I suspect 
>>>that this is due to a very involved dispatching/search for the 
>>>appropriate function on the C level. There might be 
>>
>>significant gain 
>>
>>>if loops somehow cached the result of the initial 
>>
>>dispatching. This is 
>>
>>>what you probably referred to as additional improvements in 
>>
>>the engine itself.
>>
>>I'd be surprised if dispatching were the issue: have you 
>>(C-level) profiled to find out?  Please do so: these 
>>statements do tend to get perpetuated as fact.
> 
> 
> 
> For the record, I didn't profile the dispatching, so it is only my guess
> and is not verified by C-level profiling.
> 
> The guess is based on reading the code and on the following timing on R
> level:
> 
>>n = 1e6; iA = seq(2,n); x = double(n);
>>f1 <- function(x, iA) for (i in iA) x[i] = c(1.0)
>>f2 <- function(x, iA) for (i in iA) x = c(1.0)
>>last.gc.time = gc.time(TRUE)
>>system.time(f1(x, iA), gcFirst=TRUE)
> 
> [1] 3.50 0.01 3.52 0.00 0.00
> 
>>print(gc.time() - last.gc.time); last.gc.time = gc.time()
> 
> [1] 1.25 0.82 1.24 0.00 0.00
> 
>>system.time(f2(x, iA), gcFirst=TRUE)
> 
> [1] 0.76 0.00 0.77 0.00 0.00
> 
>>print(gc.time() - last.gc.time); last.gc.time = gc.time()
> 
> [1] 0.25 0.18 0.23 0.00 0.00
> 
> f1 and f2 are identical except that the first assigns to an element in
> the vector (and thus goes through the method dispatching).
> 
> Originally I had thought that the number of allocations in f1 and in f2
> must be the same, the c(1.0) call. But gc.time() shows that the number
> of allocations in f1 is indeed, as Prof. Ripley suggests, bigger than in
> f2. It is not clear to me where these extra allocations come from and
> whether they are necessary. All x[i] = c(1.0) needs to do is to create a
> new vector c(1.0), which is a step common between f1 and f2, and then
> copy from the vector into x[i].
> 
> However even after discounting for gc.time the assignment to x[i] seems
> to be heavy.
> 
> 
>>You cannot cache the result, as [<- can change the class of 
>>x, as could other operations done by the rhs (e.g. if it were 
>>x[i] <- g(x, i) the function g could change its argument).
> 
> 
> Yes, however R may try to use the last method found and only when that
> fails go for the full dispatch. This should give a lot of gain in a
> typical case when the vars. types do not change.

There are probably efficiency improvements available, but they need to 
be done very carefully.  For example, the default method of [<- could be 
called in one step, and as a side effect create a more specific method. 
  So for the second call we should call the more specific one, but the 
default call will still be valid in the sense that the arguments match 
the signature (S4) or the class matches the name (S3), but not in the 
sense that it is the method that should be called.

Duncan Murdoch

From jarioksa at sun3.oulu.fi  Wed May  4 10:20:03 2005
From: jarioksa at sun3.oulu.fi (Jari Oksanen)
Date: Wed May  4 10:20:24 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7836)
In-Reply-To: <Pine.LNX.4.61.0505040900120.32762@gannet.stats>
References: <20050504075126.D8507A229@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505040900120.32762@gannet.stats>
Message-ID: <1115194804.14966.40.camel@biol102145.oulu.fi>

On Wed, 2005-05-04 at 09:01 +0100, Prof Brian Ripley wrote:

> >
> > This still requires a fix in passing type in update.packages() that B.
> > Ripley already did for R 2.1.1, or setting
> > options(pkgType="mac.binary").
> 
> This should not be required. What does .Platform say?

I don't know: R fails to start again in my Mac ("The application R has
unexpectedly quit.") Re-installation and removing all .RData
and .Rhistory do not help this time either (that was the time between
receiving this message and answering now). However, it was the
R-2.1.0.dmg I got from CRAN, I started it in Mac way (clicking the
icon), it was the Mac graphical window. Further, I had checked ?options
which said that default package type in this case should be
"mac.binary". Still it wasn't, but it was "source". I didn't check
the .Platform that time, only pkgType.

It seems that I'll quit using R in MacOS X for a while, since she quits
me in the startup anyway (fortunately I have Linux as my main
environment).

cheers, jari oksanen
-- 
Jari Oksanen -- Dept Biology, Univ Oulu, 90014 Oulu, Finland
Ph. +358 8 5531526, cell +358 40 5136529, fax +358 8 5531061
email jari.oksanen@oulu.fi, homepage http://cc.oulu.fi/~jarioksa/

From jarioksa at sun3.oulu.fi  Wed May  4 11:07:26 2005
From: jarioksa at sun3.oulu.fi (Jari Oksanen)
Date: Wed May  4 11:07:35 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7836)
In-Reply-To: <Pine.LNX.4.61.0505040900120.32762@gannet.stats>
References: <20050504075126.D8507A229@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505040900120.32762@gannet.stats>
Message-ID: <1115197646.14966.47.camel@biol102145.oulu.fi>

On Wed, 2005-05-04 at 09:01 +0100, Prof Brian Ripley wrote:

> 
> This should not be required. What does .Platform say?
> 
I couldn't let it be:

> str(.Platform)
List of 6
 $ OS.type   : chr "unix"
 $ file.sep  : chr "/"
 $ dynlib.ext: chr ".so"
 $ GUI       : chr "AQUA"
 $ endian    : chr "big"
 $ pkgType   : chr "source"
> R.version.string
[1] "R version 2.1.0, 2005-04-18"

(After removing R.app and R.framework, re-installing from R-2.1.0.dmg,
logging out and in -- the last step helped.)

As this is "CRAN Mac OS X build" this seems to be in conflict with
documentation of 'options' "pkgType".

PS.   

download.packages("AMORE", type="source", destdir="/tmp")

works in MacOS X (or this one I have here) with any 'type'.

cheers, jari oksanen
-- 
Jari Oksanen -- Dept Biology, Univ Oulu, 90014 Oulu, Finland
Ph. +358 8 5531526, cell +358 40 5136529, fax +358 8 5531061
email jari.oksanen@oulu.fi, homepage http://cc.oulu.fi/~jarioksa/

From ripley at stats.ox.ac.uk  Wed May  4 11:35:45 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May  4 11:35:53 2005
Subject: [Rd] MacOS X: update.packages(type="mac.binary") fails (PR#7836)
In-Reply-To: <1115197646.14966.47.camel@biol102145.oulu.fi>
References: <20050504075126.D8507A229@slim.kubism.ku.dk> 
	<Pine.LNX.4.61.0505040900120.32762@gannet.stats>
	<1115197646.14966.47.camel@biol102145.oulu.fi>
Message-ID: <Pine.LNX.4.61.0505041032030.4094@gannet.stats>

On Wed, 4 May 2005, Jari Oksanen wrote:

> On Wed, 2005-05-04 at 09:01 +0100, Prof Brian Ripley wrote:
>
>>
>> This should not be required. What does .Platform say?
>>
> I couldn't let it be:
>
>> str(.Platform)
> List of 6
> $ OS.type   : chr "unix"
> $ file.sep  : chr "/"
> $ dynlib.ext: chr ".so"
> $ GUI       : chr "AQUA"
> $ endian    : chr "big"
> $ pkgType   : chr "source"

Thanks, that is the bit which is incorrect.  I now see the problem and 
have fixed it.

>> R.version.string
> [1] "R version 2.1.0, 2005-04-18"
>
> (After removing R.app and R.framework, re-installing from R-2.1.0.dmg,
> logging out and in -- the last step helped.)
>
> As this is "CRAN Mac OS X build" this seems to be in conflict with
> documentation of 'options' "pkgType".
>
> PS.
>
> download.packages("AMORE", type="source", destdir="/tmp")
>
> works in MacOS X (or this one I have here) with any 'type'.

Good!

> cheers, jari oksanen
> -- 
> Jari Oksanen -- Dept Biology, Univ Oulu, 90014 Oulu, Finland
> Ph. +358 8 5531526, cell +358 40 5136529, fax +358 8 5531061
> email jari.oksanen@oulu.fi, homepage http://cc.oulu.fi/~jarioksa/
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From simon.urbanek at r-project.org  Wed May  4 14:23:52 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed May  4 14:24:03 2005
Subject: [Rd] Workspace [Was: MacOS X: update.packages(type="mac.binary")]
In-Reply-To: <20050504063013.BDADAA1FA@slim.kubism.ku.dk>
References: <20050504063013.BDADAA1FA@slim.kubism.ku.dk>
Message-ID: <87C0A08D-6498-4F6F-A65D-F905DFF5EBCC@r-project.org>

On May 4, 2005, at 2:30 AM, jarioksa@sun3.oulu.fi wrote:

> but the sanguine(*) R in MacOS X refuses to start in GUI mode today  
> with uninformative error message ("The application R has  
> unexpectedly quit.").

It's an OS X message, nothing R.app can do about it. See the Console  
for details - those would be more useful (I would expect a Linux  
person to look there first and ignore the message ;)).

> So it seems not be the only problem in the MacOS X build of R at CRAN.

It's likely a problem with your setup, see below.

> Starting from bash prompt in Terminal.app fails as well with error  
> ".onLoad failed in 'loadNamespace' for 'tcltk'".

Delete your workspace (rm -f ~/.RData) - that should fix it - as the  
message tells you there is a problem while the workspace is restored.

Cheers,
Simon

BTW: Using R-SIG-Mac instead of R-devel for the update.package could  
be more helpful as this is Mac-only issue.

From gavin.simpson at ucl.ac.uk  Wed May  4 14:56:19 2005
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed May  4 14:56:28 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on Fedora
	Core 3
Message-ID: <4278C673.7000101@ucl.ac.uk>

Hi,

On a new Dell laptop, with a fresh FC3 installation (with latest updates 
applied) I am experiencing make hanging consistently after/during 
building grDevices. This happens when using the configure flag 
--with-lapack (I have the LAPACK rpm distributed with FC3 installed). 
The last two lines of output are:

make[5]: Leaving directory 
`/home/gavin/R/devel/build/src/library/grDevices/src'
make[4]: Leaving directory 
`/home/gavin/R/devel/build/src/library/grDevices/src'
hang here

There are no errors or warnings printed to the console.

The same thing happens with r-patched. Both source trees were checked 
out using subversion.

If I remove the configure flag for lapack, r-patches and r devel both 
build fine. I'm not sure where to look for error messages or to diagnose 
the problem. Has anyone experienced a similar problem? Where should I 
look for any errors/logs? Any other suggestions?

All the best,

Gavin
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
Gavin Simpson                     [T] +44 (0)20 7679 5522
ENSIS Research Fellow             [F] +44 (0)20 7679 7565
ENSIS Ltd. & ECRC                 [E] gavin.simpsonATNOSPAMucl.ac.uk
UCL Department of Geography       [W] http://www.ucl.ac.uk/~ucfagls/cv/
26 Bedford Way                    [W] http://www.ucl.ac.uk/~ucfagls/
London.  WC1H 0AP.
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%

From andy.lynch at phpc.cam.ac.uk  Wed May  4 15:07:06 2005
From: andy.lynch at phpc.cam.ac.uk (andy.lynch@phpc.cam.ac.uk)
Date: Wed May  4 15:07:16 2005
Subject: [Rd] Problem with pbirthday (PR#7837)
Message-ID: <20050504130706.42716A1DA@slim.kubism.ku.dk>

Full_Name: Andy Lynch
Version: 1.9.1
OS: Windows
Submission from: (NULL) (131.111.86.211)



As I understand it, pbirthday(n,c,k) gives the approximate probability that we
see a class with k coicident people in it when n people are sorted into c
classes. 

so the command 

> pbirthday(4,classes=3,coincident=4) 


should give the approximate probability that when four people fall into three
classes, all four end up in the same class. A probability that is clearly lower
than the presently returned value of 1. 

It seems to me that the line in the function 

if (n > classes) return(1) 

is only relevant to the default case of coincident = 2. (Naturally, if there are
more people than classes, then at least one class must contain 2 people).

From luke at stat.uiowa.edu  Wed May  4 15:26:31 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed May  4 15:26:55 2005
Subject: [Rd] Cost of method dispatching: was: when can we expect Prof
	Tierney's compiled R?
In-Reply-To: <4278852F.9060101@stats.uwo.ca>
References: <C698D707214E6F4AB39AB7096C3DE5A59E91B4@phost015.EVAFUNDS.intermedia.net>
	<4278852F.9060101@stats.uwo.ca>
Message-ID: <Pine.LNX.4.62.0505040756570.12980@itasca2.wildberry.org>

On Wed, 4 May 2005, Duncan Murdoch wrote:

> Vadim Ogranovich wrote:
>> 
>> 
>>> -----Original Message-----
>>> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] Sent: Wednesday, 
>>> April 27, 2005 1:13 AM
>>> To: Vadim Ogranovich
>>> Cc: Luke Tierney; r-devel@stat.math.ethz.ch
>>> Subject: Re: [Rd] RE: [R] when can we expect Prof Tierney's compiled R?
>>> 
>>> On Tue, 26 Apr 2005, Vadim Ogranovich wrote:
>>> 
>> 
>> ...
>> 
>>>> The arithmetic shows that x[i]<- is still the bottleneck. I suspect that 
>>>> this is due to a very involved dispatching/search for the appropriate 
>>>> function on the C level. There might be 
>>> 
>>> significant gain 
>>>> if loops somehow cached the result of the initial 
>>> 
>>> dispatching. This is 
>>>> what you probably referred to as additional improvements in 
>>> 
>>> the engine itself.
>>> 
>>> I'd be surprised if dispatching were the issue: have you (C-level) 
>>> profiled to find out?  Please do so: these statements do tend to get 
>>> perpetuated as fact.
>> 
>> 
>> 
>> For the record, I didn't profile the dispatching, so it is only my guess
>> and is not verified by C-level profiling.
>> 
>> The guess is based on reading the code and on the following timing on R
>> level:
>> 
>>> n = 1e6; iA = seq(2,n); x = double(n);
>>> f1 <- function(x, iA) for (i in iA) x[i] = c(1.0)
>>> f2 <- function(x, iA) for (i in iA) x = c(1.0)
>>> last.gc.time = gc.time(TRUE)
>>> system.time(f1(x, iA), gcFirst=TRUE)
>> 
>> [1] 3.50 0.01 3.52 0.00 0.00
>> 
>>> print(gc.time() - last.gc.time); last.gc.time = gc.time()
>> 
>> [1] 1.25 0.82 1.24 0.00 0.00
>> 
>>> system.time(f2(x, iA), gcFirst=TRUE)
>> 
>> [1] 0.76 0.00 0.77 0.00 0.00
>> 
>>> print(gc.time() - last.gc.time); last.gc.time = gc.time()
>> 
>> [1] 0.25 0.18 0.23 0.00 0.00
>> 
>> f1 and f2 are identical except that the first assigns to an element in
>> the vector (and thus goes through the method dispatching).
>> 
>> Originally I had thought that the number of allocations in f1 and in f2
>> must be the same, the c(1.0) call. But gc.time() shows that the number
>> of allocations in f1 is indeed, as Prof. Ripley suggests, bigger than in
>> f2. It is not clear to me where these extra allocations come from and
>> whether they are necessary. All x[i] = c(1.0) needs to do is to create a
>> new vector c(1.0), which is a step common between f1 and f2, and then
>> copy from the vector into x[i].
>> 
>> However even after discounting for gc.time the assignment to x[i] seems
>> to be heavy.
>> 
>> 
>>> You cannot cache the result, as [<- can change the class of x, as could 
>>> other operations done by the rhs (e.g. if it were x[i] <- g(x, i) the 
>>> function g could change its argument).
>> 
>> 
>> Yes, however R may try to use the last method found and only when that
>> fails go for the full dispatch. This should give a lot of gain in a
>> typical case when the vars. types do not change.
>
> There are probably efficiency improvements available, but they need to be 
> done very carefully.  For example, the default method of [<- could be called 
> in one step, and as a side effect create a more specific method.  So for the 
> second call we should call the more specific one, but the default call will 
> still be valid in the sense that the arguments match the signature (S4) or 
> the class matches the name (S3), but not in the sense that it is the method 
> that should be called.
>
> Duncan Murdoch
>

Let's slow down here.  In

     function(x, iA) for (i in iA) x[i] = c(1.0)

there are three functions in the body, [<-, [, and c.  All are
.Primitives with internal C implementations for which methods can be
written.  These implementations all look roughly like this:

     if (method is available)
         call the method
     else { C default code }

The test of whether methods are available first looks at a bit.  If
that bit is not set there are guaranteed not to be any methods.  Only
if that bit is set does any further search for methods happen.  In
this example, and in most uses of these functions, that bit is not
set, so dispatch involves testing one bit.  This most important case
has already been optimized.  Further optimizing cases where methods
migth be available might be worth doing and will happen over time as
we learn what is necessary and feasible and where bottlenecks are.
But this sort of thing has to be done with care.  Here, however, this
just is not an issue.

The default code for [<- might well merit another look--I suspect it
has not been as heavily optiized as the default code for [.  How much
difference this will make to realistic code and whether the cost of
implementation/maintenance is worth while is not clear.

On additional allocations: that is the function call mechanism of the
interpreter.  This could be done differently, but given the semantics
of argument matching and ... arguments there is a limit on what an
interpreter can realistically do.  Again, whether the cost of making
changes to the function call mechanism in terms of both implementation
cost and maintenance cost is justified is not clear.  Some of us are
likely to look at the function call overhead sometime this summer; I
would't want to bet on the outcome though.

luke


-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From tlumley at u.washington.edu  Wed May  4 16:50:00 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed May  4 16:50:38 2005
Subject: [Rd] Problem with pbirthday (PR#7837)
In-Reply-To: <20050504130706.42716A1DA@slim.kubism.ku.dk>
References: <20050504130706.42716A1DA@slim.kubism.ku.dk>
Message-ID: <Pine.A41.4.61b.0505040743220.144940@homer05.u.washington.edu>

On Wed, 4 May 2005 andy.lynch@phpc.cam.ac.uk wrote:

>
> It seems to me that the line in the function
>
> if (n > classes) return(1)
>
> is only relevant to the default case of coincident = 2. (Naturally, if there are
> more people than classes, then at least one class must contain 2 people).
>

Yep, looks like a bug to me.  Thanks.

I do note that the approximation used in pbirthday is not very good for 
small n, so fixing this bug still doesn't give the right answer for your 
example.  For small n the best solution is simulation or direct 
calculation.   The point of the pbirthday approximation is 
that the untrained intuition guesses the probability to be about
    n(1/classes)^(coincident-1) 
and the approximation is usually quite good when this is much smaller than 
the true probability.


 	-thomas

From ripley at stats.ox.ac.uk  Wed May  4 17:29:33 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May  4 17:29:41 2005
Subject: [Rd] Re: [R] Unbundling gregmisc (was: loading gap package)
In-Reply-To: <4278E84A.3090904@stats.uwo.ca>
References: <915D2D65A9986440A277AC5C98AA466F01862B25@groamrexm02.amer.pfizer.com>
	<4278E84A.3090904@stats.uwo.ca>
Message-ID: <Pine.LNX.4.61.0505041622100.7273@gannet.stats>

On Wed, 4 May 2005, Duncan Murdoch wrote:

> Warnes, Gregory R wrote:
>> Let me redirect the topic a bit.  I've been considering unbundling 
>> gregmisc.

So let's move to R-devel.

>> The pro would be that people would find the component packages (i.e. gdata)
>> more easily.  The con is that the packages have a number of
>> interdependencies, so you pretty much will need to get most of them anyway.
>> 
>> As the latest gregmisc bundle contains a gregmisc package that is just a
>> stub that depends on and loads the individual packages, there would still 
>> be
>> a gregmisc object.
>> 
>> Comments?
>
> Currently R can follow dependencies when you install a package from CRAN (and 
> this is the default in Windows, not sure about other platforms), so I'd say 
> this would be a good thing to do.  I don't know your revision history on the 
> components, but I'd guess some change more often than others, so there'll be 
> no need to update all of them every time one of them changes.

It has been possible on Unix and Windows for a while, but it seems is not 
yet implemented on MacOS X (although I submitted the code needed). 
However, it is only the default on the Windows GUI and not for any 
command-line version of install.packages().  People have from time to time 
suggested changing the default, but the dependency tree can get rather 
large and some people do have slow and expensive connections.

I think a bundle is still a better idea.  Apart from on MacOS X we need 
some education about how to use the power of *.packages (and we need to 
get the MacOS versions in place).  For example, bundle components show up 
with the dialog-based installation lists.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MSchwartz at MedAnalytics.com  Wed May  4 17:29:30 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Wed May  4 17:30:27 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on
	Fedora Core 3
In-Reply-To: <4278C673.7000101@ucl.ac.uk>
References: <4278C673.7000101@ucl.ac.uk>
Message-ID: <1115220570.23994.8.camel@horizons.localdomain>

On Wed, 2005-05-04 at 13:56 +0100, Gavin Simpson wrote:
> Hi,
> 
> On a new Dell laptop, with a fresh FC3 installation (with latest updates 
> applied) I am experiencing make hanging consistently after/during 
> building grDevices. This happens when using the configure flag 
> --with-lapack (I have the LAPACK rpm distributed with FC3 installed). 
> The last two lines of output are:
> 
> make[5]: Leaving directory 
> `/home/gavin/R/devel/build/src/library/grDevices/src'
> make[4]: Leaving directory 
> `/home/gavin/R/devel/build/src/library/grDevices/src'
> hang here
> 
> There are no errors or warnings printed to the console.
> 
> The same thing happens with r-patched. Both source trees were checked 
> out using subversion.
> 
> If I remove the configure flag for lapack, r-patches and r devel both 
> build fine. I'm not sure where to look for error messages or to diagnose 
> the problem. Has anyone experienced a similar problem? Where should I 
> look for any errors/logs? Any other suggestions?

Gavin,

FWIW, I can duplicate this behavior on my Dell 5150 w/ FC3 using the r-
patched tarball from 2005-05-03.

I thought that perhaps this might be related to the use of the nVidia
proprietary driver, but temporarily going back to the 'nv' driver did
not resolve the problem.

Thus, I am unable to provide more information as to the etiology of the
problem other than to point to some of the references in the r-admin
manual starting on page 19 regarding linear algebra.

Perhaps there is a problem with the FC3 LAPACK.

Best regards,

Marc Schwartz

From goedman at mac.com  Wed May  4 16:40:37 2005
From: goedman at mac.com (Rob J Goedman)
Date: Wed May  4 17:44:22 2005
Subject: [Rd] Re: [R-SIG-Mac] Workspace [Was: MacOS X:
	update.packages(type="mac.binary")]
In-Reply-To: <87C0A08D-6498-4F6F-A65D-F905DFF5EBCC@r-project.org>
References: <20050504063013.BDADAA1FA@slim.kubism.ku.dk>
	<87C0A08D-6498-4F6F-A65D-F905DFF5EBCC@r-project.org>
Message-ID: <C0B81A62-D3A3-404A-BB25-5CB2D7BECD2C@mac.com>

Hi Jari,

In addition to Simon's suggestion below, recently someone fixed this  
by ensuring
R.app has write permission to its working directory.

Rob

On May 4, 2005, at 5:23 AM, Simon Urbanek wrote:
>>
>> Starting from bash prompt in Terminal.app fails as well with error  
>> ".onLoad failed in 'loadNamespace' for 'tcltk'".
>>
>
> Delete your workspace (rm -f ~/.RData) - that should fix it - as  
> the message tells you there is a problem while the workspace is  
> restored.
>
> Cheers,
> Simon

From gavin.simpson at ucl.ac.uk  Wed May  4 17:58:46 2005
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed May  4 17:58:57 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on	Fedora
	Core 3
In-Reply-To: <1115220570.23994.8.camel@horizons.localdomain>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
Message-ID: <4278F136.4010108@ucl.ac.uk>

Marc Schwartz wrote:
> On Wed, 2005-05-04 at 13:56 +0100, Gavin Simpson wrote:
> 
>>Hi,
>>
>>On a new Dell laptop, with a fresh FC3 installation (with latest updates 
>>applied) I am experiencing make hanging consistently after/during 
>>building grDevices. This happens when using the configure flag 
>>--with-lapack (I have the LAPACK rpm distributed with FC3 installed). 
>>The last two lines of output are:
>>
>>make[5]: Leaving directory 
>>`/home/gavin/R/devel/build/src/library/grDevices/src'
>>make[4]: Leaving directory 
>>`/home/gavin/R/devel/build/src/library/grDevices/src'
>>hang here
>>
>>There are no errors or warnings printed to the console.
>>
>>The same thing happens with r-patched. Both source trees were checked 
>>out using subversion.
>>
>>If I remove the configure flag for lapack, r-patches and r devel both 
>>build fine. I'm not sure where to look for error messages or to diagnose 
>>the problem. Has anyone experienced a similar problem? Where should I 
>>look for any errors/logs? Any other suggestions?
> 
> 
> Gavin,
> 
> FWIW, I can duplicate this behavior on my Dell 5150 w/ FC3 using the r-
> patched tarball from 2005-05-03.
> 
> I thought that perhaps this might be related to the use of the nVidia
> proprietary driver, but temporarily going back to the 'nv' driver did
> not resolve the problem.
> 
> Thus, I am unable to provide more information as to the etiology of the
> problem other than to point to some of the references in the r-admin
> manual starting on page 19 regarding linear algebra.
> 
> Perhaps there is a problem with the FC3 LAPACK.
> 
> Best regards,
> 
> Marc Schwartz
> 

Cheers for this Mark,

I had a quick google search for this problem and found a discussion in 
the redhat mailing list archives that discusses the issue and points to 
the following bug:

https://bugzilla.redhat.com/beta/show_bug.cgi?id=138447

Which describes the behaviour I am experiencing.

Basically, the LAPACK in FC3 is broken because it was compiled with 
gcc-3.4 and that introduced errors when -O2 optimisations were used to 
compile the rpm. That bug was recently reopened so there may be the 
possibility of the FC3 rpm being updated (the underlying problem has 
been fixed by compiling with lower optimisation).

I'll read more of the r-admin, and see about finding an alternative.

Also, note that lapack has been moved to Fedora Extras from FC4 so 
that's one more thing to remember to add after upgrading!

All the best,

Gav

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
Gavin Simpson                     [T] +44 (0)20 7679 5522
ENSIS Research Fellow             [F] +44 (0)20 7679 7565
ENSIS Ltd. & ECRC                 [E] gavin.simpsonATNOSPAMucl.ac.uk
UCL Department of Geography       [W] http://www.ucl.ac.uk/~ucfagls/cv/
26 Bedford Way                    [W] http://www.ucl.ac.uk/~ucfagls/
London.  WC1H 0AP.
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%

From ripley at stats.ox.ac.uk  Wed May  4 18:13:20 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May  4 18:13:29 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on Fedora
	Core 3
In-Reply-To: <1115220570.23994.8.camel@horizons.localdomain>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
Message-ID: <Pine.LNX.4.61.0505041707420.7964@gannet.stats>

On Wed, 4 May 2005, Marc Schwartz wrote:

> On Wed, 2005-05-04 at 13:56 +0100, Gavin Simpson wrote:
>> Hi,
>>
>> On a new Dell laptop, with a fresh FC3 installation (with latest updates
>> applied) I am experiencing make hanging consistently after/during
>> building grDevices. This happens when using the configure flag
>> --with-lapack (I have the LAPACK rpm distributed with FC3 installed).
>> The last two lines of output are:
>>
>> make[5]: Leaving directory
>> `/home/gavin/R/devel/build/src/library/grDevices/src'
>> make[4]: Leaving directory
>> `/home/gavin/R/devel/build/src/library/grDevices/src'
>> hang here
>>
>> There are no errors or warnings printed to the console.
>>
>> The same thing happens with r-patched. Both source trees were checked
>> out using subversion.
>>
>> If I remove the configure flag for lapack, r-patches and r devel both
>> build fine. I'm not sure where to look for error messages or to diagnose
>> the problem. Has anyone experienced a similar problem? Where should I
>> look for any errors/logs? Any other suggestions?
>
> Gavin,
>
> FWIW, I can duplicate this behavior on my Dell 5150 w/ FC3 using the r-
> patched tarball from 2005-05-03.
>
> I thought that perhaps this might be related to the use of the nVidia
> proprietary driver, but temporarily going back to the 'nv' driver did
> not resolve the problem.
>
> Thus, I am unable to provide more information as to the etiology of the
> problem other than to point to some of the references in the r-admin
> manual starting on page 19 regarding linear algebra.
>
> Perhaps there is a problem with the FC3 LAPACK.

In any case, we do not recommend an external LAPACK unless it is 
essential.  There are far too many buggy ones about, and there is no 
performance gain in using someone else's compile of a nearly identical 
code base.  Is

   Provision is made for using an external LAPACK library, principally to
   cope with BLAS libraries which contain a copy of LAPACK (such as
   @code{libsunperf} on Solaris and @code{vecLib} on Mac OS X).
   However, the likely performance gains are thought to be small (and may
   be negative), and the default is not to search for a suitable LAPACK
   library.

   If you do use @option{--with-lapack}, be aware of potential problems
   with bugs in the LAPACK 3.0 sources (or in the posted corrections to
   those sources).  ....

not enough warning?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From MSchwartz at MedAnalytics.com  Wed May  4 18:15:38 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Wed May  4 18:15:51 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel
	on	Fedora Core 3
In-Reply-To: <4278F136.4010108@ucl.ac.uk>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
	<4278F136.4010108@ucl.ac.uk>
Message-ID: <1115223338.27632.7.camel@horizons.localdomain>

On Wed, 2005-05-04 at 16:58 +0100, Gavin Simpson wrote:

<snip>

> Cheers for this Mark,
> 
> I had a quick google search for this problem and found a discussion in 
> the redhat mailing list archives that discusses the issue and points to 
> the following bug:
> 
> https://bugzilla.redhat.com/beta/show_bug.cgi?id=138447
> 
> Which describes the behaviour I am experiencing.
> 
> Basically, the LAPACK in FC3 is broken because it was compiled with 
> gcc-3.4 and that introduced errors when -O2 optimisations were used to 
> compile the rpm. That bug was recently reopened so there may be the 
> possibility of the FC3 rpm being updated (the underlying problem has 
> been fixed by compiling with lower optimisation).
> 
> I'll read more of the r-admin, and see about finding an alternative.
> 
> Also, note that lapack has been moved to Fedora Extras from FC4 so 
> that's one more thing to remember to add after upgrading!
> 
> All the best,
> 
> Gav

Thanks for the update Gavin.

For FC4, there are a lot of things that are either going to be new in or
are moving to Extras (including R BTW). Much controversy over some of
the decisions made there, but that's another topic for another thread in
a different galaxy, far, far away...  ;-)

Best regards,

Marc

From maechler at stat.math.ethz.ch  Wed May  4 19:08:42 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed May  4 19:08:50 2005
Subject: [Rd] Re: [R] Unbundling gregmisc (was: loading gap package)
In-Reply-To: <Pine.LNX.4.61.0505041622100.7273@gannet.stats>
References: <915D2D65A9986440A277AC5C98AA466F01862B25@groamrexm02.amer.pfizer.com>
	<4278E84A.3090904@stats.uwo.ca>
	<Pine.LNX.4.61.0505041622100.7273@gannet.stats>
Message-ID: <17017.410.249363.158849@stat.math.ethz.ch>

>>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk>
>>>>>     on Wed, 4 May 2005 16:29:33 +0100 (BST) writes:

    ...............


    BDR> .......... we need some education about how to use the
    BDR> power of *.packages (and we need to get the MacOS
    BDR> versions in place).

and maybe  we should even consider adding regression tests for
the *.packages() functions so chances increase they will work on
all platforms....

Martin

From ripley at stats.ox.ac.uk  Wed May  4 19:15:19 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May  4 19:15:29 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on Fedora
	Core 3
In-Reply-To: <4278F136.4010108@ucl.ac.uk>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
	<4278F136.4010108@ucl.ac.uk>
Message-ID: <Pine.LNX.4.61.0505041813150.8728@gannet.stats>

On Wed, 4 May 2005, Gavin Simpson wrote:

> I had a quick google search for this problem and found a discussion in the 
> redhat mailing list archives that discusses the issue and points to the 
> following bug:
>
> https://bugzilla.redhat.com/beta/show_bug.cgi?id=138447
>
> Which describes the behaviour I am experiencing.
>
> Basically, the LAPACK in FC3 is broken because it was compiled with gcc-3.4 
> and that introduced errors when -O2 optimisations were used to compile the 
> rpm. That bug was recently reopened so there may be the possibility of the 
> FC3 rpm being updated (the underlying problem has been fixed by compiling 
> with lower optimisation).

Yes, that _is_ described in R-admin, and R is itself careful to compile 
the critical routines with -ffloat-store.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Wed May  4 21:15:31 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed May  4 21:15:43 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on	Fedora
	Core 3
In-Reply-To: <4278F136.4010108@ucl.ac.uk>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
	<4278F136.4010108@ucl.ac.uk>
Message-ID: <x2oebq950s.fsf@turmalin.kubism.ku.dk>

Gavin Simpson <gavin.simpson@ucl.ac.uk> writes:

> Basically, the LAPACK in FC3 is broken because it was compiled with
> gcc-3.4 and that introduced errors when -O2 optimisations were used to
> compile the rpm. That bug was recently reopened so there may be the
> possibility of the FC3 rpm being updated (the underlying problem has
> been fixed by compiling with lower optimisation).

There's a pending update on lapack/blas now, which may or may not fix
the issue (no announcement in the archives).

Any clue whether there is any benefit in using the FC3 versions over
the versions that ships with R?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From MSchwartz at MedAnalytics.com  Wed May  4 21:38:58 2005
From: MSchwartz at MedAnalytics.com (Marc Schwartz)
Date: Wed May  4 21:39:18 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel
	on	Fedora Core 3
In-Reply-To: <x2oebq950s.fsf@turmalin.kubism.ku.dk>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
	<4278F136.4010108@ucl.ac.uk>  <x2oebq950s.fsf@turmalin.kubism.ku.dk>
Message-ID: <1115235538.27632.68.camel@horizons.localdomain>

On Wed, 2005-05-04 at 21:15 +0200, Peter Dalgaard wrote:
> Gavin Simpson <gavin.simpson@ucl.ac.uk> writes:
> 
> > Basically, the LAPACK in FC3 is broken because it was compiled with
> > gcc-3.4 and that introduced errors when -O2 optimisations were used to
> > compile the rpm. That bug was recently reopened so there may be the
> > possibility of the FC3 rpm being updated (the underlying problem has
> > been fixed by compiling with lower optimisation).
> 
> There's a pending update on lapack/blas now, which may or may not fix
> the issue (no announcement in the archives).
> 
> Any clue whether there is any benefit in using the FC3 versions over
> the versions that ships with R?

Peter,

I cannot offer an authoritative response here and perhaps Gavin has
other information. 

Recognizing "the absence of evidence is not evidence of absence", I have
not seen anything (benchmarks, etc.) to suggest that there is an
advantage.

Regards,

Marc

From mgd at santafe.edu  Wed May  4 21:59:17 2005
From: mgd at santafe.edu (Marcus G. Daniels)
Date: Wed May  4 21:59:01 2005
Subject: [Rd] DLL modules with other dependent libraries
Message-ID: <42792995.2070202@santafe.edu>

Hi all,

In R for Windows, is there a preferred way to handle R extensions that 
provide native code that depend upon one or more third party DLLs?  If I 
put those DLLs in the library/MODULE/libs it doesn't find them.  In 
other words, my MODULE.dll has other DLLs it uses, but they aren't 
standard and it would be unlikely to find them in the system path. 

Thanks for any suggestions!

From jeff at kanecap.com  Thu May  5 00:00:07 2005
From: jeff at kanecap.com (Jeff Enos)
Date: Thu May  5 00:00:16 2005
Subject: [Rd] Varying as.Date performance
Message-ID: <17017.17895.337156.535491@gargle.gargle.HOWL>

R-devel,

The performance of as.Date differs by a large degree between one of my
machines with glibc 2.3.2:

> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
[1] 1.17 0.00 1.18 0.00 0.00

and a comparable machine with glibc 2.3.3:

> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
[1] 31.20 46.89 81.01  0.00  0.00

both with the same R version:

> R.version
         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    2                
minor    1.0              
year     2005             
month    04               
day      18               
language R

I'm focusing on differences in glibc versions because of as.Date's use
of strptime.

Does it seem likely that the cause of this discrepancy is in fact
glibc?  If so, can anyone tell me how to make the performance of the
second machine more like the first?

I have verified that using the chron package, which I don't believe
uses strptime, for the above character conversion performs equally
well on both machines.

Thanks in advance,

Jeff

From ggrothendieck at gmail.com  Thu May  5 07:00:05 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu May  5 07:00:14 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <17017.17895.337156.535491@gargle.gargle.HOWL>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
Message-ID: <971536df05050422001d334365@mail.gmail.com>

On 5/4/05, Jeff Enos <jeff@kanecap.com> wrote:
> R-devel,
> 
> The performance of as.Date differs by a large degree between one of my
> machines with glibc 2.3.2:
> 
> > system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
> [1] 1.17 0.00 1.18 0.00 0.00
> 
> and a comparable machine with glibc 2.3.3:
> 
> > system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
> [1] 31.20 46.89 81.01  0.00  0.00
> 
> both with the same R version:
> 
> > R.version
>         _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
> 
> I'm focusing on differences in glibc versions because of as.Date's use
> of strptime.
> 
> Does it seem likely that the cause of this discrepancy is in fact
> glibc?  If so, can anyone tell me how to make the performance of the
> second machine more like the first?
> 
> I have verified that using the chron package, which I don't believe
> uses strptime, for the above character conversion performs equally
> well on both machines.

I think its likely the character processing that is the bottleneck.  You
can speed that part up by extracting the substrings directly:

> system.time({
+ dd <- rep("01-01-2005", 10000)
+ year <- as.numeric(substr(dd, 7, 10))
+ mon <- as.numeric(substr(dd, 1, 2))
+ day <- as.numeric(substr(dd, 4, 5))
+ x <- as.Date(ISOdate(year, mon, day))
+ }, gc = TRUE)
[1] 0.42 0.00 0.51   NA   NA

> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"), gc=TRUE)
[1] 1.08 0.00 1.22   NA   NA

From ggrothendieck at gmail.com  Thu May  5 07:02:33 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu May  5 07:02:41 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <971536df05050422001d334365@mail.gmail.com>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
	<971536df05050422001d334365@mail.gmail.com>
Message-ID: <971536df05050422021d626fa3@mail.gmail.com>

On 5/5/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> On 5/4/05, Jeff Enos <jeff@kanecap.com> wrote:
> > R-devel,
> >
> > The performance of as.Date differs by a large degree between one of my
> > machines with glibc 2.3.2:
> >
> > > system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
> > [1] 1.17 0.00 1.18 0.00 0.00
> >
> > and a comparable machine with glibc 2.3.3:
> >
> > > system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
> > [1] 31.20 46.89 81.01  0.00  0.00
> >
> > both with the same R version:
> >
> > > R.version
> >         _
> > platform i686-pc-linux-gnu
> > arch     i686
> > os       linux-gnu
> > system   i686, linux-gnu
> > status
> > major    2
> > minor    1.0
> > year     2005
> > month    04
> > day      18
> > language R
> >
> > I'm focusing on differences in glibc versions because of as.Date's use
> > of strptime.
> >
> > Does it seem likely that the cause of this discrepancy is in fact
> > glibc?  If so, can anyone tell me how to make the performance of the
> > second machine more like the first?
> >
> > I have verified that using the chron package, which I don't believe
> > uses strptime, for the above character conversion performs equally
> > well on both machines.
> 
> I think its likely the character processing that is the bottleneck.  You
> can speed that part up by extracting the substrings directly:
> 
> > system.time({
> + dd <- rep("01-01-2005", 10000)
> + year <- as.numeric(substr(dd, 7, 10))
> + mon <- as.numeric(substr(dd, 1, 2))
> + day <- as.numeric(substr(dd, 4, 5))
> + x <- as.Date(ISOdate(year, mon, day))
> + }, gc = TRUE)
> [1] 0.42 0.00 0.51   NA   NA
> 
> > system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"), gc=TRUE)
> [1] 1.08 0.00 1.22   NA   NA
> 

Sorry but I got the number of zeros in the reps wrong.   Its actually slower.

From ripley at stats.ox.ac.uk  Thu May  5 07:52:10 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May  5 07:52:42 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on Fedora
	Core 3
In-Reply-To: <x2oebq950s.fsf@turmalin.kubism.ku.dk>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
	<4278F136.4010108@ucl.ac.uk> <x2oebq950s.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505050649010.18845@gannet.stats>

On Wed, 4 May 2005, Peter Dalgaard wrote:

> Gavin Simpson <gavin.simpson@ucl.ac.uk> writes:
>
>> Basically, the LAPACK in FC3 is broken because it was compiled with
>> gcc-3.4 and that introduced errors when -O2 optimisations were used to
>> compile the rpm. That bug was recently reopened so there may be the
>> possibility of the FC3 rpm being updated (the underlying problem has
>> been fixed by compiling with lower optimisation).
>
> There's a pending update on lapack/blas now, which may or may not fix
> the issue (no announcement in the archives).
>
> Any clue whether there is any benefit in using the FC3 versions over
> the versions that ships with R?

Yes: at least for earlier versions, none. (See the comments in the R-admin 
manual I quoted yesterday which no one else seems to have read.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu May  5 07:58:34 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May  5 07:58:43 2005
Subject: [Rd] DLL modules with other dependent libraries
In-Reply-To: <42792995.2070202@santafe.edu>
References: <42792995.2070202@santafe.edu>
Message-ID: <Pine.LNX.4.61.0505050652440.18845@gannet.stats>

On Wed, 4 May 2005, Marcus G. Daniels wrote:

> In R for Windows, is there a preferred way to handle R extensions that 
> provide native code that depend upon one or more third party DLLs?  If I put 
> those DLLs in the library/MODULE/libs it doesn't find them.  In other words, 
> my MODULE.dll has other DLLs it uses, but they aren't standard and it would 
> be unlikely to find them in the system path. 
> Thanks for any suggestions!

Set the path for the loading of the DLL.  One example is tcltk in the R 
sources, and it is done for several of the binary packages I distribute.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu May  5 08:30:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May  5 08:31:05 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <17017.17895.337156.535491@gargle.gargle.HOWL>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.61.0505050717100.20206@gannet.stats>

One other possibly difference would be locale, but this is slow on FC3 
(2.3.4 now) in the C locale.  Almost all the time is in strptime:
R profiling shows

> summaryRprof()
$by.self
                     self.time self.pct total.time total.pct
"strptime"              29.58     99.7      29.58      99.7
"as.Date.character"      0.10      0.3      29.68     100.0
"as.Date"                0.00      0.0      29.68     100.0
"eval"                   0.00      0.0      29.68     100.0
"system.time"            0.00      0.0      29.68     100.0

Now on a glibc 2.3.x system R's internal replacement for strptime will be 
used (to work around bugs) so it must be some other part of the POSIX 
time-handling that has changed.

The next step would be to do C-level profiling and then retrofit the 
crucial code from glibc 2.3.2.

It does seem a pretty unusual application of R for 10^5 date conversions 
to be needed and for 30 secs to be an appreciable part of the analysis 
time on such a data set.

On Wed, 4 May 2005, Jeff Enos wrote:

> R-devel,
>
> The performance of as.Date differs by a large degree between one of my
> machines with glibc 2.3.2:
>
>> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
> [1] 1.17 0.00 1.18 0.00 0.00
>
> and a comparable machine with glibc 2.3.3:
>
>> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
> [1] 31.20 46.89 81.01  0.00  0.00
>
> both with the same R version:
>
>> R.version
>         _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
>
> I'm focusing on differences in glibc versions because of as.Date's use
> of strptime.
>
> Does it seem likely that the cause of this discrepancy is in fact
> glibc?  If so, can anyone tell me how to make the performance of the
> second machine more like the first?
>
> I have verified that using the chron package, which I don't believe
> uses strptime, for the above character conversion performs equally
> well on both machines.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Thu May  5 10:24:08 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May  5 10:24:20 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on Fedora
	Core 3
In-Reply-To: <Pine.LNX.4.61.0505050649010.18845@gannet.stats>
References: <4278C673.7000101@ucl.ac.uk>
	<1115220570.23994.8.camel@horizons.localdomain>
	<4278F136.4010108@ucl.ac.uk> <x2oebq950s.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0505050649010.18845@gannet.stats>
Message-ID: <x2vf5ym66v.fsf@turmalin.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > Any clue whether there is any benefit in using the FC3 versions over
> > the versions that ships with R?
> 
> Yes: at least for earlier versions, none. (See the comments in the
> R-admin manual I quoted yesterday which no one else seems to have
> read.)

I did know about them. I was being mildly sarcastic and partly
curious. 

In principle, having lapack/blas maintained as part of the
distributions would be good, especially if they could sort out the
(nontrivial) processor-specific tuning issues. Currently, the RPMs of
R for both SuSE and Fedora ship with minimal tuning, and you need to
compile your own version to take advantage of (say) an ATLAS blas.
This is not hard to do, but you lose the niceties of the RPM system
with respect to upgrades, dependencies and all that.

In practice, if the distributions also ship minimally tuned libs, and
buggy ones too, the point gets rather moot.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From gavin.simpson at ucl.ac.uk  Thu May  5 11:58:33 2005
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Thu May  5 11:58:52 2005
Subject: [Rd] make hanging during compile of r-patched/R-devel on Fedora
	Core 3
In-Reply-To: <x2vf5ym66v.fsf@turmalin.kubism.ku.dk>
References: <4278C673.7000101@ucl.ac.uk>	<1115220570.23994.8.camel@horizons.localdomain>	<4278F136.4010108@ucl.ac.uk>
	<x2oebq950s.fsf@turmalin.kubism.ku.dk>	<Pine.LNX.4.61.0505050649010.18845@gannet.stats>
	<x2vf5ym66v.fsf@turmalin.kubism.ku.dk>
Message-ID: <4279EE49.2010305@ucl.ac.uk>

Peter Dalgaard wrote:
> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> 
>>>Any clue whether there is any benefit in using the FC3 versions over
>>>the versions that ships with R?
>>
>>Yes: at least for earlier versions, none. (See the comments in the
>>R-admin manual I quoted yesterday which no one else seems to have
>>read.)
> 
> 
> I did know about them. I was being mildly sarcastic and partly
> curious. 
> 
> In principle, having lapack/blas maintained as part of the
> distributions would be good, especially if they could sort out the
> (nontrivial) processor-specific tuning issues. Currently, the RPMs of
> R for both SuSE and Fedora ship with minimal tuning, and you need to
> compile your own version to take advantage of (say) an ATLAS blas.
> This is not hard to do, but you lose the niceties of the RPM system
> with respect to upgrades, dependencies and all that.
> 
> In practice, if the distributions also ship minimally tuned libs, and
> buggy ones too, the point gets rather moot.
> 

Just to draw this particular thread to a close - I gave the FC3 lapack a 
run - as I'm stubborn and (like Peter) a little curious. The compilation 
proceeded without hangs, errors or warnings, but make check failed 
whilst running the examples from base. So looks like everything written 
in R Admin document holds for at least the current lapack distributed 
with FC3 (yes, I did read it!), so it looks like relying on 
distributions for lapack is not going to work just yet...

I provide the output from make check and base-Ex.Rout.fail just for 
illustration. I am quite happy with my R and the inbuilt lapack and FC3 
provided blas - I was using the arrival of a new laptop as an excuse to 
try out a few things I had avoided previously and have learnt quite a 
lot in the process.

Thanks for everyone's input.

All the best,

Gav

Output from make check:

....
make[5]: Entering directory `/home/gavin/R/buildLapack/src/library'
  >>> Building/Updating help pages for package 'base'
      Formats: text html latex example
make[5]: Leaving directory `/home/gavin/R/buildLapack/src/library'
running code in 'base-Ex.R' ...make[4]: *** [base-Ex.Rout] Error 1
make[4]: Leaving directory `/home/gavin/R/buildLapack/tests/Examples'
make[3]: *** [test-Examples-Base] Error 2
make[3]: Leaving directory `/home/gavin/R/buildLapack/tests/Examples'
make[2]: *** [test-Examples] Error 2
make[2]: Leaving directory `/home/gavin/R/buildLapack/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/home/gavin/R/buildLapack/tests'
make: *** [check-devel] Error 2

And from base-Ex.Rout.fail we have:

....
 > ### Name: kappa
 > ### Title: Estimate the Condition Number
 > ### Aliases: kappa kappa.default kappa.lm kappa.qr kappa.tri
 > ### Keywords: math
 >
 > ### ** Examples
 >
 > kappa(x1 <- cbind(1,1:10))# 15.71
[1] 15.70590
 > kappa(x1, exact = TRUE)        # 13.68
[1] 13.67903
 > kappa(x2 <- cbind(x1,2:11))# high! [x2 is singular!]
[1] 8.351867e+16
 >
 > hilbert <- function(n) { i <- 1:n; 1 / outer(i - 1, i, "+") }
 > sv9 <- svd(h9 <- hilbert(9))$ d
 > kappa(h9)# pretty high!
[1] 728289254735
 > kappa(h9, exact = TRUE) == max(sv9) / min(sv9)
Error in La.svd(x, nu, nv) : LAPACK routine 'DGEBRD' gave error code -10
Execution halted

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
Gavin Simpson                     [T] +44 (0)20 7679 5522
ENSIS Research Fellow             [F] +44 (0)20 7679 7565
ENSIS Ltd. & ECRC                 [E] gavin.simpsonATNOSPAMucl.ac.uk
UCL Department of Geography       [W] http://www.ucl.ac.uk/~ucfagls/cv/
26 Bedford Way                    [W] http://www.ucl.ac.uk/~ucfagls/
London.  WC1H 0AP.
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%

From hoffman.mm+R-project.org at ebi.ac.uk  Thu May  5 12:40:43 2005
From: hoffman.mm+R-project.org at ebi.ac.uk (hoffman.mm+R-project.org@ebi.ac.uk)
Date: Thu May  5 12:40:52 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
Message-ID: <20050505104043.57151A1FA@slim.kubism.ku.dk>

Full_Name: Michael Hoffman
Version: 2.1.0
OS: Linux (Fedora Core 3, kernel 2.6.11-1.14_FC3)
Submission from: (NULL) (193.62.199.8)


help(arrows) says:

"""
     arrows(x0, y0, x1, y1, length = 0.25, angle = 30, code = 2,
            col = par("fg"), lty = NULL, lwd = par("lwd"), xpd = NULL)

...

     If 'code=2' an arrowhead is drawn at '(x0[i],y0[i])' and if
     'code=1' an arrowhead is drawn at '(x1[i],y1[i])'.  If 'code=3' a
     head is drawn at both ends of the arrow.  Unless 'length = 0',
     when no head is drawn.
"""

If you do:

plot(c(-1, 1), c(-1, 1), col=0)
arrows(x0=0, y0=0, x1=0, y1=1, code=2)

it is pretty clear that the arrowhead is drawn at x1, y1 with code=2. If you
switch to code=1, the arrowhead is drawn at x0, y0. Either the documentation or
the function is incorrect.

From p.dalgaard at biostat.ku.dk  Thu May  5 13:07:26 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May  5 13:07:38 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <20050505104043.57151A1FA@slim.kubism.ku.dk>
References: <20050505104043.57151A1FA@slim.kubism.ku.dk>
Message-ID: <x2mzralymp.fsf@turmalin.kubism.ku.dk>

hoffman.mm+R-project.org@ebi.ac.uk writes:

> Full_Name: Michael Hoffman
> Version: 2.1.0
> OS: Linux (Fedora Core 3, kernel 2.6.11-1.14_FC3)
> Submission from: (NULL) (193.62.199.8)
> 
> 
> help(arrows) says:
> 
> """
>      arrows(x0, y0, x1, y1, length = 0.25, angle = 30, code = 2,
>             col = par("fg"), lty = NULL, lwd = par("lwd"), xpd = NULL)
> 
> ...
> 
>      If 'code=2' an arrowhead is drawn at '(x0[i],y0[i])' and if
>      'code=1' an arrowhead is drawn at '(x1[i],y1[i])'.  If 'code=3' a
>      head is drawn at both ends of the arrow.  Unless 'length = 0',
>      when no head is drawn.
> """
> 
> If you do:
> 
> plot(c(-1, 1), c(-1, 1), col=0)
> arrows(x0=0, y0=0, x1=0, y1=1, code=2)
> 
> it is pretty clear that the arrowhead is drawn at x1, y1 with code=2. If you
> switch to code=1, the arrowhead is drawn at x0, y0. Either the documentation or
> the function is incorrect.

One way to decide is to compare with Splus. Now that doesn't have a
'code' argument and the arguments are named x1,y1,x2,y2 (I wonder why
R wanted to be different here?), but they do put the arrowheads at the
*to* end, which does seem to be the sensible thing to do. 

Arguably, using 'code=2' as the default is a bit weird, but changing
it could be quite painful. I.e., we should fix the docs.

BTW, the docs also might say that code=0 makes arrows behave like
segments(). It is also a bit strange that the code argument isn't
vectorized, which might have been useful. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Thu May  5 13:44:32 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May  5 13:44:43 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <20050505104043.57151A1FA@slim.kubism.ku.dk>
References: <20050505104043.57151A1FA@slim.kubism.ku.dk>
Message-ID: <x2ekclnbhb.fsf@turmalin.kubism.ku.dk>

hoffman.mm+R-project.org@ebi.ac.uk writes:
^^^^^^^^^^^^^^^^^^^^^^^^

Let me point out that I for one do not consider it good netiquette to
use fake or mangled email addresses on bug reports! I get enough mail
from the Mailer Daemon as it is.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Thu May  5 14:07:14 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu May  5 14:07:25 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
Message-ID: <20050505120714.5585AA1FF@slim.kubism.ku.dk>

Peter Dalgaard wrote:
> hoffman.mm+R-project.org@ebi.ac.uk writes:
> 
> 
>>Full_Name: Michael Hoffman
>>Version: 2.1.0
>>OS: Linux (Fedora Core 3, kernel 2.6.11-1.14_FC3)
>>Submission from: (NULL) (193.62.199.8)
>>
>>
>>help(arrows) says:
>>
>>"""
>>     arrows(x0, y0, x1, y1, length = 0.25, angle = 30, code = 2,
>>            col = par("fg"), lty = NULL, lwd = par("lwd"), xpd = NULL)
>>
>>...
>>
>>     If 'code=2' an arrowhead is drawn at '(x0[i],y0[i])' and if
>>     'code=1' an arrowhead is drawn at '(x1[i],y1[i])'.  If 'code=3' a
>>     head is drawn at both ends of the arrow.  Unless 'length = 0',
>>     when no head is drawn.
>>"""
>>
>>If you do:
>>
>>plot(c(-1, 1), c(-1, 1), col=0)
>>arrows(x0=0, y0=0, x1=0, y1=1, code=2)
>>
>>it is pretty clear that the arrowhead is drawn at x1, y1 with code=2. If you
>>switch to code=1, the arrowhead is drawn at x0, y0. Either the documentation or
>>the function is incorrect.
> 
> 
> One way to decide is to compare with Splus. Now that doesn't have a
> 'code' argument and the arguments are named x1,y1,x2,y2 (I wonder why
> R wanted to be different here?), but they do put the arrowheads at the
> *to* end, which does seem to be the sensible thing to do. 
> 
> Arguably, using 'code=2' as the default is a bit weird, 

An argument for the current encoding is that it encodes arrowhead end in 
the bits of code:  00 = no arrowhead, 01 = arrowhead at origin, 10 = 
arrowhead at destination, 11 = arrowhead at both.

 > but changing
 > it could be quite painful. I.e., we should fix the docs.

Yes, definitely.

> BTW, the docs also might say that code=0 makes arrows behave like
> segments(). It is also a bit strange that the code argument isn't
> vectorized, which might have been useful. 

Yes, that would be a reasonable change.

Duncan

From murdoch at stats.uwo.ca  Thu May  5 14:07:47 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu May  5 14:07:32 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <x2mzralymp.fsf@turmalin.kubism.ku.dk>
References: <20050505104043.57151A1FA@slim.kubism.ku.dk>
	<x2mzralymp.fsf@turmalin.kubism.ku.dk>
Message-ID: <427A0C93.4050606@stats.uwo.ca>

Peter Dalgaard wrote:
> hoffman.mm+R-project.org@ebi.ac.uk writes:
> 
> 
>>Full_Name: Michael Hoffman
>>Version: 2.1.0
>>OS: Linux (Fedora Core 3, kernel 2.6.11-1.14_FC3)
>>Submission from: (NULL) (193.62.199.8)
>>
>>
>>help(arrows) says:
>>
>>"""
>>     arrows(x0, y0, x1, y1, length = 0.25, angle = 30, code = 2,
>>            col = par("fg"), lty = NULL, lwd = par("lwd"), xpd = NULL)
>>
>>...
>>
>>     If 'code=2' an arrowhead is drawn at '(x0[i],y0[i])' and if
>>     'code=1' an arrowhead is drawn at '(x1[i],y1[i])'.  If 'code=3' a
>>     head is drawn at both ends of the arrow.  Unless 'length = 0',
>>     when no head is drawn.
>>"""
>>
>>If you do:
>>
>>plot(c(-1, 1), c(-1, 1), col=0)
>>arrows(x0=0, y0=0, x1=0, y1=1, code=2)
>>
>>it is pretty clear that the arrowhead is drawn at x1, y1 with code=2. If you
>>switch to code=1, the arrowhead is drawn at x0, y0. Either the documentation or
>>the function is incorrect.
> 
> 
> One way to decide is to compare with Splus. Now that doesn't have a
> 'code' argument and the arguments are named x1,y1,x2,y2 (I wonder why
> R wanted to be different here?), but they do put the arrowheads at the
> *to* end, which does seem to be the sensible thing to do. 
> 
> Arguably, using 'code=2' as the default is a bit weird, 

An argument for the current encoding is that it encodes arrowhead end in 
the bits of code:  00 = no arrowhead, 01 = arrowhead at origin, 10 = 
arrowhead at destination, 11 = arrowhead at both.

 > but changing
 > it could be quite painful. I.e., we should fix the docs.

Yes, definitely.

> BTW, the docs also might say that code=0 makes arrows behave like
> segments(). It is also a bit strange that the code argument isn't
> vectorized, which might have been useful. 

Yes, that would be a reasonable change.

Duncan

From pkleiweg at xs4all.nl  Thu May  5 14:34:05 2005
From: pkleiweg at xs4all.nl (Peter Kleiweg)
Date: Thu May  5 14:34:16 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <x2ekclnbhb.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0505051431180.1096-100000@kleigh.nl>

Peter Dalgaard wrote:

> hoffman.mm+R-project.org@ebi.ac.uk writes:
> ^^^^^^^^^^^^^^^^^^^^^^^^
>
> Let me point out that I for one do not consider it good netiquette to
> use fake or mangled email addresses on bug reports! I get enough mail
> from the Mailer Daemon as it is.

Doesn't look like a fake or mangled address to me. You are not
familiar with the user+tag mail construct?

-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From p.dalgaard at biostat.ku.dk  Thu May  5 14:44:54 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May  5 14:45:58 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <Pine.LNX.4.44.0505051431180.1096-100000@kleigh.nl>
References: <Pine.LNX.4.44.0505051431180.1096-100000@kleigh.nl>
Message-ID: <x2zmv9lu49.fsf@turmalin.kubism.ku.dk>

Peter Kleiweg <pkleiweg@xs4all.nl> writes:

> Peter Dalgaard wrote:
> 
> > hoffman.mm+R-project.org@ebi.ac.uk writes:
> > ^^^^^^^^^^^^^^^^^^^^^^^^
> >
> > Let me point out that I for one do not consider it good netiquette to
> > use fake or mangled email addresses on bug reports! I get enough mail
> > from the Mailer Daemon as it is.
> 
> Doesn't look like a fake or mangled address to me. You are not
> familiar with the user+tag mail construct?

It may be formally valid, but it still bounced....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From jeff at kanecap.com  Thu May  5 15:24:26 2005
From: jeff at kanecap.com (Jeff Enos)
Date: Thu May  5 15:25:16 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <Pine.LNX.4.61.0505050717100.20206@gannet.stats>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
	<Pine.LNX.4.61.0505050717100.20206@gannet.stats>
Message-ID: <17018.7818.716318.388693@gargle.gargle.HOWL>

Prof Brian Ripley writes:
 > One other possibly difference would be locale, but this is slow on FC3 
 > (2.3.4 now) in the C locale.  Almost all the time is in strptime:
 > R profiling shows
 > 
 > > summaryRprof()
 > $by.self
 >                      self.time self.pct total.time total.pct
 > "strptime"              29.58     99.7      29.58      99.7
 > "as.Date.character"      0.10      0.3      29.68     100.0
 > "as.Date"                0.00      0.0      29.68     100.0
 > "eval"                   0.00      0.0      29.68     100.0
 > "system.time"            0.00      0.0      29.68     100.0
 > 
 > Now on a glibc 2.3.x system R's internal replacement for strptime will be 
 > used (to work around bugs) so it must be some other part of the POSIX 
 > time-handling that has changed.
 > 
 > The next step would be to do C-level profiling and then retrofit the 
 > crucial code from glibc 2.3.2.

Thanks for these suggestions.  C-level profiling yields the following:

  %   cumulative   self              self     total
 time   seconds   seconds    calls   s/call   s/call  name
 36.01      5.34     5.34   100000     0.00     0.00  get_locale_strings
  4.32      5.98     0.64   100000     0.00     0.00  mktime00
  3.98      6.57     0.59   277462     0.00     0.00  Rf_eval
  3.71      7.12     0.55   472935     0.00     0.00  Rf_findVarInFrame3
  3.64      7.66     0.54   100000     0.00     0.00  strptime_internal
  3.51      8.18     0.52        1     0.52     7.51  do_strptime

It looks like strftime is called from get_locale_strings, which might
be the culprit.  Any suggestions on where I might go from here?

 > It does seem a pretty unusual application of R for 10^5 date conversions 
 > to be needed and for 30 secs to be an appreciable part of the analysis 
 > time on such a data set.

This is an issue for me when interactively loading a sizable
timeseries dataset into R from Postgres, converting character strings
into objects of class Date.

Thanks,

Jeff

 > 
 > On Wed, 4 May 2005, Jeff Enos wrote:
 > 
 > > R-devel,
 > >
 > > The performance of as.Date differs by a large degree between one of my
 > > machines with glibc 2.3.2:
 > >
 > >> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
 > > [1] 1.17 0.00 1.18 0.00 0.00
 > >
 > > and a comparable machine with glibc 2.3.3:
 > >
 > >> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
 > > [1] 31.20 46.89 81.01  0.00  0.00
 > >
 > > both with the same R version:
 > >
 > >> R.version
 > >         _
 > > platform i686-pc-linux-gnu
 > > arch     i686
 > > os       linux-gnu
 > > system   i686, linux-gnu
 > > status
 > > major    2
 > > minor    1.0
 > > year     2005
 > > month    04
 > > day      18
 > > language R
 > >
 > > I'm focusing on differences in glibc versions because of as.Date's use
 > > of strptime.
 > >
 > > Does it seem likely that the cause of this discrepancy is in fact
 > > glibc?  If so, can anyone tell me how to make the performance of the
 > > second machine more like the first?
 > >
 > > I have verified that using the chron package, which I don't believe
 > > uses strptime, for the above character conversion performs equally
 > > well on both machines.
 > 
 > -- 
 > Brian D. Ripley,                  ripley@stats.ox.ac.uk
 > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
 > University of Oxford,             Tel:  +44 1865 272861 (self)
 > 1 South Parks Road,                     +44 1865 272866 (PA)
 > Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From pkleiweg at xs4all.nl  Thu May  5 16:11:15 2005
From: pkleiweg at xs4all.nl (Peter Kleiweg)
Date: Thu May  5 16:11:23 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <x2zmv9lu49.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.44.0505051610310.1096-100000@kleigh.nl>

Peter Dalgaard wrote:

> Peter Kleiweg <pkleiweg@xs4all.nl> writes:
>
> > Peter Dalgaard wrote:
> >
> > > hoffman.mm+R-project.org@ebi.ac.uk writes:
> > > ^^^^^^^^^^^^^^^^^^^^^^^^
> > >
> > > Let me point out that I for one do not consider it good netiquette to
> > > use fake or mangled email addresses on bug reports! I get enough mail
> > > from the Mailer Daemon as it is.
> >
> > Doesn't look like a fake or mangled address to me. You are not
> > familiar with the user+tag mail construct?
>
> It may be formally valid, but it still bounced....

In that case, just ignore my remark.


-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From p.dalgaard at biostat.ku.dk  Thu May  5 16:28:49 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May  5 16:29:00 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <17018.7818.716318.388693@gargle.gargle.HOWL>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
	<Pine.LNX.4.61.0505050717100.20206@gannet.stats>
	<17018.7818.716318.388693@gargle.gargle.HOWL>
Message-ID: <x2vf5xlpb2.fsf@turmalin.kubism.ku.dk>

Jeff Enos <jeff@kanecap.com> writes:

> Thanks for these suggestions.  C-level profiling yields the following:
> 
>   %   cumulative   self              self     total
>  time   seconds   seconds    calls   s/call   s/call  name
>  36.01      5.34     5.34   100000     0.00     0.00  get_locale_strings
>   4.32      5.98     0.64   100000     0.00     0.00  mktime00
>   3.98      6.57     0.59   277462     0.00     0.00  Rf_eval
>   3.71      7.12     0.55   472935     0.00     0.00  Rf_findVarInFrame3
>   3.64      7.66     0.54   100000     0.00     0.00  strptime_internal
>   3.51      8.18     0.52        1     0.52     7.51  do_strptime
> 
> It looks like strftime is called from get_locale_strings, which might
> be the culprit.  Any suggestions on where I might go from here?

You might try modifying get_locale_strings (and its wide counterpart)
with a check for an unchanged locale. E.g.

static char *last_LC_TIME=NULL;

....

  tmp = setlocale(LC_TIME, NULL)
  if (strcmp(tmp, last_LC_TIME)) return;
  
  last_LC_TIME = tmp; 

.... set the strings ....

if the call to setlocale is considerably faster than 40 calls to
strftime(), you might have a winner.



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Thu May  5 17:03:42 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May  5 17:04:00 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <x2vf5xlpb2.fsf@turmalin.kubism.ku.dk>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
	<Pine.LNX.4.61.0505050717100.20206@gannet.stats>
	<17018.7818.716318.388693@gargle.gargle.HOWL>
	<x2vf5xlpb2.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505051557100.10592@gannet.stats>

On Thu, 5 May 2005, Peter Dalgaard wrote:

> Jeff Enos <jeff@kanecap.com> writes:
>
>> Thanks for these suggestions.  C-level profiling yields the following:
>>
>>   %   cumulative   self              self     total
>>  time   seconds   seconds    calls   s/call   s/call  name
>>  36.01      5.34     5.34   100000     0.00     0.00  get_locale_strings
>>   4.32      5.98     0.64   100000     0.00     0.00  mktime00
>>   3.98      6.57     0.59   277462     0.00     0.00  Rf_eval
>>   3.71      7.12     0.55   472935     0.00     0.00  Rf_findVarInFrame3
>>   3.64      7.66     0.54   100000     0.00     0.00  strptime_internal
>>   3.51      8.18     0.52        1     0.52     7.51  do_strptime
>>
>> It looks like strftime is called from get_locale_strings, which might
>> be the culprit.  Any suggestions on where I might go from here?
>
> You might try modifying get_locale_strings (and its wide counterpart)
> with a check for an unchanged locale. E.g.
>
> static char *last_LC_TIME=NULL;
>
> ....
>
>  tmp = setlocale(LC_TIME, NULL)
>  if (strcmp(tmp, last_LC_TIME)) return;
>
>  last_LC_TIME = tmp;
>
> .... set the strings ....
>
> if the call to setlocale is considerably faster than 40 calls to
> strftime(), you might have a winner.

Yes, I think that would be a worthwhile optimization.  I didn't bother 
because I figured it would be fast enough (which at 50musec it almost 
always is).

However, get_locale_strings is only 36% of the total, and we have at least 
another 60% to account for.  (81.01 vs 1.18 secs.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Bernhard.Schmalhofer at biomax.de  Fri May  6 10:23:13 2005
From: Bernhard.Schmalhofer at biomax.de (Bernhard.Schmalhofer@biomax.de)
Date: Fri May  6 10:23:23 2005
Subject: [Rd] Misspelled German error message: --nosave (PR#7841)
Message-ID: <20050506082313.B9936A1F3@slim.kubism.ku.dk>

Full_Name: Bernhard Schmalhofer
Version: R 2.1.0
OS: Linux
Submission from: (NULL) (213.69.121.226)


Hi,

when I pipe commands into R then I get a misspelled German error message:


scripts> echo $LANG
de_DE.UTF-8
scripts> R --args asdf < aaa_analyze.R
Fatal error: Sie m?ssen '--save', '--nosave' oder '--vanilla' angeben
scripts> export LANG=C
scripts>R --args asdf < aaa_analyze.R
Fatal error: you must specify '--save', '--no-save' or '--vanilla'


The no-save command line option should be '--no-save', not '--nosave'.

CU, Bernhard

From berwin at maths.uwa.edu.au  Fri May  6 10:37:15 2005
From: berwin at maths.uwa.edu.au (berwin@maths.uwa.edu.au)
Date: Fri May  6 10:37:25 2005
Subject: [Rd] But in add1, presumably in add1.lm (PR#7842)
Message-ID: <20050506083715.41012A1F3@slim.kubism.ku.dk>

xDear all,

while investigating some data, I noticed a strange behaviour of add1
which is reproduced below using a data set from a recommended
package.

Essentially, it seems the inclusion of an interaction term by add1 is
only correctly handled if the order of the variables in the
interaction coincide with the order in the formula that is given as
the scope.  (I have a vague memory that such a bug was already once
posted some time ago, but could not find anything in the bug report
repository.)  

I noticed this problem on R 2.1.0, but it also exists in all other R
version installed on my machine (R 1.8.1, R 1.9.1, R 2.0.0 and R
2.0.1).

Cheers,

        Berwin

> library(MASS)
> fmb <- lm(Days ~ .^4, quine)

> fm0 <- lm(Days ~ Eth + Sex, quine)
> add1(fm0, formula(fmb), test="F")
Single term additions

Model:
Days ~ Eth + Sex
        Df Sum of Sq   RSS   AIC F value   Pr(F)
<none>               35045   806                
Age      3      2119 32926   803  3.0030 0.03263
Lrn      1       162 34882   808  0.6605 0.41773
Eth:Sex  1       141 34904   808  0.5724 0.45057

> fm0 <- lm(Days ~ Sex + Eth, quine)
> add1(fm0, formula(fmb), test="F")
Single term additions

Model:
Days ~ Sex + Eth
        Df Sum of Sq   RSS   AIC F value   Pr(F)
<none>               35045   806                
Age      3      2119 32926   803  3.0030 0.03263
Lrn      1       162 34882   808  0.6605 0.41773
Eth:Sex  0         0 35045   806                

> fm0 <- lm(Days ~ Age + Eth, quine)
> add1(fm0, formula(fmb), test="F")
Single term additions

Model:
Days ~ Age + Eth
        Df Sum of Sq   RSS   AIC F value  Pr(F)
<none>               33049   802               
Sex      1       123 32926   803  0.5226 0.4710
Lrn      1       598 32450   801  2.5815 0.1104
Eth:Age  0         0 33049   802               

> fm0 <- lm(Days ~Eth + Age , quine)
> add1(fm0, formula(fmb), test="F")
Single term additions

Model:
Days ~ Eth + Age
        Df Sum of Sq   RSS   AIC F value    Pr(F)
<none>               33049   802                 
Sex      1       123 32926   803  0.5226 0.470950
Lrn      1       598 32450   801  2.5815 0.110369
Eth:Age  3      2837 30212   795  4.3194 0.006047

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 1.0
 year = 2005
 month = 04
 day = 18
 language = R

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base

From ripley at stats.ox.ac.uk  Fri May  6 11:01:05 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri May  6 11:01:15 2005
Subject: [Rd] Misspelled German error message: --nosave (PR#7841)
Message-ID: <20050506090105.297CAA1F3@slim.kubism.ku.dk>

Fixed, but bugs in translations should be sent to the translators listed 
in the appropriate file, here de.po.

Suggestion for adding to the R-FAQ.texi at the end of the R Bugs section:

Corrections to and comments on message translation should be sent to the
last translator (listed at the top of the appropriate @samp{.po} file) or
to the translation team as listed at
@url{http://developer.r-project.org/TranslationTeams.html}


[The reasons for the `comments on' is that most `corrections' so far are 
matters of style rather than fact.]

On Fri, 6 May 2005 Bernhard.Schmalhofer@biomax.de wrote:

> Full_Name: Bernhard Schmalhofer
> Version: R 2.1.0
> OS: Linux
> Submission from: (NULL) (213.69.121.226)
>
>
> Hi,
>
> when I pipe commands into R then I get a misspelled German error message:
>
>
> scripts> echo $LANG
> de_DE.UTF-8
> scripts> R --args asdf < aaa_analyze.R
> Fatal error: Sie m?ssen '--save', '--nosave' oder '--vanilla' angeben
> scripts> export LANG=C
> scripts>R --args asdf < aaa_analyze.R
> Fatal error: you must specify '--save', '--no-save' or '--vanilla'
>
>
> The no-save command line option should be '--no-save', not '--nosave'.
>
> CU, Bernhard
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hoffman+R-project.org at ebi.ac.uk  Fri May  6 10:36:20 2005
From: hoffman+R-project.org at ebi.ac.uk (Michael Hoffman)
Date: Fri May  6 11:47:43 2005
Subject: [Rd] documenation for arrows() is backwards (PR#7839)
In-Reply-To: <x2ekclnbhb.fsf@turmalin.kubism.ku.dk>
References: <20050505104043.57151A1FA@slim.kubism.ku.dk>
	<x2ekclnbhb.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.62.0505060933400.22993@qnzvnan.rov.np.hx>

On Thu, 5 May 2005, Peter Dalgaard wrote:

> hoffman.mm+R-project.org@ebi.ac.uk writes:
> ^^^^^^^^^^^^^^^^^^^^^^^^
>
> Let me point out that I for one do not consider it good netiquette
> to use fake or mangled email addresses on bug reports!

It certainly isn't! Sorry, that was unintentional. Either of the
following work:

hoffman+R-project.org at ebi
hoffman.mm+R-project.org at gmail

You can see how I confused myself. I plead guilty by reason of coffee
deficiency.
-- 
Michael Hoffman <hoffman@ebi.ac.uk>
European Bioinformatics Institute

From ripley at stats.ox.ac.uk  Fri May  6 11:55:52 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri May  6 11:56:02 2005
Subject: [Rd] But in add1, presumably in add1.lm (PR#7842)
Message-ID: <20050506095552.8CDFEA1E5@slim.kubism.ku.dk>

The problem is in the way terms() reorders interactions in forming the 
term labels.  If asked to fit  ~ Age + Eth + Eth:Age it actually fits
~ Age + Eth + Age:Eth

It is not clear to me why R does this (S does not) nor if it is safe to 
change that, but it would be better to fix the root cause if possible as 
it occurs in several places.  In particular, it affects all known add1 
methods and can affect drop1 too.

If used consistently, there is a no problem: here your upper scope does 
not (strictly) include your lower model.

On Fri, 6 May 2005 berwin@maths.uwa.edu.au wrote:

> xDear all,
>
> while investigating some data, I noticed a strange behaviour of add1
> which is reproduced below using a data set from a recommended
> package.
>
> Essentially, it seems the inclusion of an interaction term by add1 is
> only correctly handled if the order of the variables in the
> interaction coincide with the order in the formula that is given as
> the scope.  (I have a vague memory that such a bug was already once
> posted some time ago, but could not find anything in the bug report
> repository.)
>
> I noticed this problem on R 2.1.0, but it also exists in all other R
> version installed on my machine (R 1.8.1, R 1.9.1, R 2.0.0 and R
> 2.0.1).
>
> Cheers,
>
>        Berwin
>
>> library(MASS)
>> fmb <- lm(Days ~ .^4, quine)
>
>> fm0 <- lm(Days ~ Eth + Sex, quine)
>> add1(fm0, formula(fmb), test="F")
> Single term additions
>
> Model:
> Days ~ Eth + Sex
>        Df Sum of Sq   RSS   AIC F value   Pr(F)
> <none>               35045   806
> Age      3      2119 32926   803  3.0030 0.03263
> Lrn      1       162 34882   808  0.6605 0.41773
> Eth:Sex  1       141 34904   808  0.5724 0.45057
>
>> fm0 <- lm(Days ~ Sex + Eth, quine)
>> add1(fm0, formula(fmb), test="F")
> Single term additions
>
> Model:
> Days ~ Sex + Eth
>        Df Sum of Sq   RSS   AIC F value   Pr(F)
> <none>               35045   806
> Age      3      2119 32926   803  3.0030 0.03263
> Lrn      1       162 34882   808  0.6605 0.41773
> Eth:Sex  0         0 35045   806
>
>> fm0 <- lm(Days ~ Age + Eth, quine)
>> add1(fm0, formula(fmb), test="F")
> Single term additions
>
> Model:
> Days ~ Age + Eth
>        Df Sum of Sq   RSS   AIC F value  Pr(F)
> <none>               33049   802
> Sex      1       123 32926   803  0.5226 0.4710
> Lrn      1       598 32450   801  2.5815 0.1104
> Eth:Age  0         0 33049   802
>
>> fm0 <- lm(Days ~Eth + Age , quine)
>> add1(fm0, formula(fmb), test="F")
> Single term additions
>
> Model:
> Days ~ Eth + Age
>        Df Sum of Sq   RSS   AIC F value    Pr(F)
> <none>               33049   802
> Sex      1       123 32926   803  0.5226 0.470950
> Lrn      1       598 32450   801  2.5815 0.110369
> Eth:Age  3      2837 30212   795  4.3194 0.006047
>
> --please do not edit the information below--
>
> Version:
> platform = i686-pc-linux-gnu
> arch = i686
> os = linux-gnu
> system = i686, linux-gnu
> status =
> major = 2
> minor = 1.0
> year = 2005
> month = 04
> day = 18
> language = R
>
> Search Path:
> .GlobalEnv, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri May  6 14:43:57 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri May  6 14:44:49 2005
Subject: (PR#7824) [Rd] handling of zero and negative indices in
Message-ID: <20050506124357.3D1A4A240@slim.kubism.ku.dk>

I've put this in (with some different wording).  Although S blithely 
accepts mis-dimensioned index matrices I agree this is wrong and have made 
it an error.

On Fri, 29 Apr 2005 tplate@acm.org wrote:

> This message contains a description of what looks like a bug, examples
> of the suspect behavior, a proposed change to the C code to change this
> behavior, example of behavior with the fix, and suggestions for 3 places
> to update the documentation to reflect the proposed behavior.  It is
> submitted for consideration for inclusion in R.  Comments are requested.
>
> Currently, the code for subscripting by matrices checks that values in
> the matrix are not greater than the dimensions of the array being
> indexed.  However, it does not check for zero or negative indices, and
> blindly does index computation with them as though they were positive
> indices (including for negative indices whose absolute value exceeds the
> dimensions of the array being indexed).  Here are examples of indexing
> by matrices that do not return unequivocally sensible results (in most
> cases):
>
> > x <- matrix(1:6,ncol=2)
> > dim(x)
> [1] 3 2
> > x
>      [,1] [,2]
> [1,]    1    4
> [2,]    2    5
> [3,]    3    6
> > x[rbind(c(1,1), c(2,2))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(0,1))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(0,0))]
> Error: only 0's may be mixed with negative subscripts
> > x[rbind(c(1,1), c(2,2), c(0,2))]
> [1] 1 5 3
> > x[rbind(c(1,1), c(2,2), c(0,3))]
> Error: subscript out of bounds
> > x[rbind(c(1,1), c(2,2), c(1,0))]
> Error: only 0's may be mixed with negative subscripts
> > x[rbind(c(1,1), c(2,2), c(2,0))]
> Error: only 0's may be mixed with negative subscripts
> > x[rbind(c(1,1), c(2,2), c(3,0))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(1,2))]
> [1] 1 5 4
> > x[rbind(c(1,1), c(2,2), c(-1,2))]
> [1] 1 5 2
> > x[rbind(c(1,1), c(2,2), c(-2,2))]
> [1] 1 5 1
> > x[rbind(c(1,1), c(2,2), c(-3,2))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(-4,2))]
> Error: only 0's may be mixed with negative subscripts
> > x[rbind(c(1,1), c(2,2), c(-1,-1))]
> Error: subscript out of bounds
> >
> > # range checks are not applied to negative indices
> > x <- matrix(1:6, ncol=3)
> > dim(x)
> [1] 2 3
> > x[rbind(c(1,1), c(2,2), c(-3,3))]
> [1] 1 4 1
> > x[rbind(c(1,1), c(2,2), c(-4,3))]
> [1] 1 4
> >
> > version
>          _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
> >
>
> The followed version of mat2indsub() (to replace the one in
> src/main/subscript.c) allows zero indices and explicitly disallows all
> negative indices:
>
> /* Special Matrix Subscripting: Handles the case x[i] where */
> /* x is an n-way array and i is a matrix with n columns. */
> /* This code returns a vector containing the integer subscripts */
> /* to be extracted when x is regarded as unravelled. */
> /* Negative indices are not allowed. */
> /* A zero anywhere in a row will cause a zero in the same */
> /* position in the result. */
>
> SEXP mat2indsub(SEXP dims, SEXP s)
> {
>     int tdim, j, i, k, nrs = nrows(s);
>     SEXP rvec;
>
>     PROTECT(rvec = allocVector(INTSXP, nrs));
>     s = coerceVector(s, INTSXP);
>     setIVector(INTEGER(rvec), nrs, 0);
>
>     for (i = 0; i < nrs; i++) {
> 	tdim = 1;
> 	/* compute 0-based subscripts for a row (0 in the input */
>         /* gets -1 in the output here) */
> 	for (j = 0; j < LENGTH(dims); j++) {
> 	    k = INTEGER(s)[i + j * nrs];
> 	    if(k == NA_INTEGER) {
> 		INTEGER(rvec)[i] = NA_INTEGER;
> 		break;
> 	    }
>             if(k < 0)
> 		error(_("cannot have negative values in matrices used as subscripts"));
> 	    if(k == 0) {
> 		INTEGER(rvec)[i] = -1;
> 		break;
> 	    }
> 	    if (k > INTEGER(dims)[j])
> 		error(_("subscript out of bounds"));
> 	    INTEGER(rvec)[i] += (k - 1) * tdim;
> 	    tdim *= INTEGER(dims)[j];
> 	}
> 	/* transform to 1 based subscripting (0 in the input */
>         /* gets 0 in the output here) */
> 	if(INTEGER(rvec)[i] != NA_INTEGER)
> 	    INTEGER(rvec)[i]++;
>     }
>     UNPROTECT(1);
>     return (rvec);
> }
>
> With this version, the above commands (+ a couple more) produce the
> following output (with commands that fail suitably wrapped in try() so
> that they can be included in a test files.)
>
> > x <- matrix(1:6,ncol=2)
> > dim(x)
> [1] 3 2
> > x
>      [,1] [,2]
> [1,]    1    4
> [2,]    2    5
> [3,]    3    6
> > x[rbind(c(1,1), c(2,2))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(0,1))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(0,0))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(0,2))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(0,3))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(1,0))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(2,0))]
> [1] 1 5
> > x[rbind(c(1,1), c(2,2), c(3,0))]
> [1] 1 5
> > x[rbind(c(1,0), c(0,2), c(3,0))]
> numeric(0)
> > x[rbind(c(1,0), c(0,0), c(3,0))]
> numeric(0)
> > x[rbind(c(1,1), c(2,2), c(1,2))]
> [1] 1 5 4
> > x[rbind(c(1,1), c(2,NA), c(1,2))]
> [1]  1 NA  4
> > x[rbind(c(1,0), c(2,NA), c(1,2))]
> [1] NA  4
> > try(x[rbind(c(1,1), c(2,2), c(-1,2))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-1, 2))]) :
>         cannot have negative values in matrices used as subscripts
> > try(x[rbind(c(1,1), c(2,2), c(-2,2))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-2, 2))]) :
>         cannot have negative values in matrices used as subscripts
> > try(x[rbind(c(1,1), c(2,2), c(-3,2))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-3, 2))]) :
>         cannot have negative values in matrices used as subscripts
> > try(x[rbind(c(1,1), c(2,2), c(-4,2))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-4, 2))]) :
>         cannot have negative values in matrices used as subscripts
> > try(x[rbind(c(1,1), c(2,2), c(-1,-1))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-1, -1))]) :
>         cannot have negative values in matrices used as subscripts
> >
> > # verify that range checks are applied to negative indices
> > x <- matrix(1:6, ncol=3)
> > dim(x)
> [1] 2 3
> > try(x[rbind(c(1,1), c(2,2), c(-3,3))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-3, 3))]) :
>         cannot have negative values in matrices used as subscripts
> > try(x[rbind(c(1,1), c(2,2), c(-4,3))])
> Error in try(x[rbind(c(1, 1), c(2, 2), c(-4, 3))]) :
>         cannot have negative values in matrices used as subscripts
> >
>
>
> The documentation page for ?Extract could have the following sentences
> added to the end of the 2nd para in the description of arguments "i, j,
> ...":
>
>   Negative indices are not allowed in matrices used as indices.
>   NA and zero values are allowed: rows containing a zero are
>   omitted from the result, and rows containing an NA produce an
>   NA in the result.
>
> In "Introduction to R", the same material could be added to the end of
> the section "Index Arrays" (in the chapter "Arrays and matrices").
>
> In "R Language Definition", the third paragraph of the section "Indexing
> matrices and arrays" (Section 3.4.2 in my copy) currently reads:
>
>> It is possible to use a matrix of integers as an index. In
>> this case, the number of columns of the matrix should match
>> the number of dimensions of the structure, and the result
>> will be a vector with length as the number of rows of the
>> matrix. The following example shows how to extract the
>> elements m[1, 1] and m[2, 2] in one operation.
>
> It could be changed to the following:
>
> It is possible to use a matrix of integers as an index.
> Negative indices are not allowed in matrices used as
> indices.  NA and zero values are allowed: rows containing a
> zero are omitted from the result, and rows containing an NA
> produce an NA in the result.  To use a matrix as an index,
> the number of columns of the matrix should match the number
> of dimensions of the structure, and the result will be a
> vector with length as the number of rows of the matrix
> (except when the matrix contains zeros). The following
> example shows how to extract the elements m[1, 1] and m[2,
> 2] in one operation.
>
>
> Additionally, indexing by matrix just goes ahead and uses matrix
> elements as vector indices in cases where the number of columns in the
> matrix does not match the number of dimensions in the array.  E.g.:
>
> > x <- matrix(1:6,ncol=2)
> > x[rbind(c(1,1,1), c(2,2,2))]
> [1] 1 2 1 2 1 2
> >
>
> Would it not be preferable behavior to stop with an error in such cases?
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From thomas.friedrichsmeier at ruhr-uni-bochum.de  Fri May  6 15:14:11 2005
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: Fri May  6 15:12:23 2005
Subject: [Rd] Embedding x11-window causes R to segfault
Message-ID: <200505061514.12029.thomas.friedrichsmeier@ruhr-uni-bochum.de>

Hi,

I know it's not generally helpful to just restate a bug-report already in the 
tracker. But I also know that sometimes old bug-reports just slip past 
attention. Hence I'd like to point out this antique report:

http://r-bugs.biostat.ku.dk/cgi-bin/R/System-specific?id=848;user=guest

I'm currently running into this bug, as I'm trying to embed an R window 
generated with x11 () into a window of my application. Doing so causes R to 
segfault. I'm no x11 guru at all, but the bug report referenced gives a 
plausible explanation of what might be the cause.
That bug-report also contains a patch to fix the issue. For all I can see, 
that patch should still be applicable to current sources with only minimal 
adaptations (DevDesc -> newDevDesc, etc.).
Is there any chance this will be taken care of in one of the next releases? Or 
are there issues that make inclusion in soon-to-come releases unlikely? I'm 
asking, as in the latter case, I'd have to look into different solutions for 
my application.

Thanks!
Thomas Friedrichsmeier

From astoddar at mail.med.upenn.edu  Fri May  6 18:45:03 2005
From: astoddar at mail.med.upenn.edu (Alexander Stoddard)
Date: Fri May  6 18:49:41 2005
Subject: [Rd] How to understand packages, namespaces, environments
Message-ID: <f3ed5b562d661ead695a58d506e52e02@mail.med.upenn.edu>

I would be very glad of pointers to information on how the concepts of 
packages, namespaces and environments are interrelated in R.

I am trying to get a handle on this both so I can delve further into 
understanding other people's code and so I can organize my own in a 
more coherent manner.

 From my reading about environments it seems they function as what I 
would intuitively call namespaces. However, the documentation for the 
'library' function implies that "namespace" has a specific meaning in R 
that I have so far failed to grasp. What is that meaning (or where 
should I look to read up on it) ?

I can think of the following more specific questions. Perhaps they may 
most usefully serve to reveal my misconceptions, so corrections would 
be very helpful.

Does saying the following load package 'foo' into its own environment ?
 > library(foo)

Do environments have names?

Of what does the list returned by search() actually consist? Is it a 
list of environments, a list that may include environments, or 
something else?

What is actually designated by a character vector of form "package:foo"?

In what ways can I use the character vector "package:foo" when 
interacting with R?

Many thanks,
Alex Stoddard

P.S. It took me a long time of flailing about to discover the 'search' 
function. Perhaps it could be included in the "See Also" section of the 
help for 'ls'.

From ripley at stats.ox.ac.uk  Fri May  6 19:34:03 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri May  6 19:35:28 2005
Subject: [Rd] How to understand packages, namespaces, environments
In-Reply-To: <f3ed5b562d661ead695a58d506e52e02@mail.med.upenn.edu>
References: <f3ed5b562d661ead695a58d506e52e02@mail.med.upenn.edu>
Message-ID: <Pine.LNX.4.61.0505061757250.27493@gannet.stats>

On Fri, 6 May 2005, Alexander Stoddard wrote:

> I would be very glad of pointers to information on how the concepts of 
> packages, namespaces and environments are interrelated in R.
>
> I am trying to get a handle on this both so I can delve further into 
> understanding other people's code and so I can organize my own in a more 
> coherent manner.
>
> From my reading about environments it seems they function as what I would 
> intuitively call namespaces. However, the documentation for the 'library' 
> function implies that "namespace" has a specific meaning in R that I have so 
> far failed to grasp. What is that meaning (or where should I look to read up 
> on it) ?

Look in `Writing R Extensions' and on developer.r-project.org.  I don't 
know about `intuitively' but they are similar to other systems (e.g. 
Perl's) namespaces.

More user-level documentation of namespaces (e.g. in R-lang) is on the 
WOULD-BE-NICE list, but there is enough in `Writing R Extensions' for many 
package writers and we are talking about more details of what happens 
under the skin.

> I can think of the following more specific questions. Perhaps they may most 
> usefully serve to reveal my misconceptions, so corrections would be very 
> helpful.

It seems you have revealed that you have not studied the manuals nor the 
help pages.  Please do so before posting (see the posting guide).

> Does saying the following load package 'foo' into its own environment ?
>> library(foo)
>
> Do environments have names?

Not in general.  You will see <environment: some-hex-address> printed 
quite often.  I am not at all sure you have grasped what an environment is 
in R: see the R-lang manual.  (Look it up in the index, as at present the 
term is used before it is defined.)

> Of what does the list returned by search() actually consist? Is it a list of 
> environments, a list that may include environments, or something else?

search() does not return a list: it returns a character vector.  It seems 
you have not read its help page, which tells you that quite explicitly.

> What is actually designated by a character vector of form "package:foo"?

That is actually a character string, not a character vector.  It is a name 
that can be used to refer to attach'ed objects, as the search() help page 
says.

> In what ways can I use the character vector "package:foo" when interacting 
> with R?

I am aware of attach(), detach() and as.environment() (which is used by 
quite a few functions, e.g. get()).  (Asking what you can do it an 
extensible system such as R is not very helpful.)  Generally it is a name 
used when a package or another attach'ed object might be meant: it is not 
used if a package is all that can be specified.

> Many thanks,
> Alex Stoddard
>
> P.S. It took me a long time of flailing about to discover the 'search' 
> function. Perhaps it could be included in the "See Also" section of the help 
> for 'ls'.

This *is* in `An Introduction to R', something we ask all R users to read.

I (and I am biased) suggest the right way to get to grips with things like 
this is to read a good book on the S/R language.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Fri May  6 19:40:20 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri May  6 19:39:52 2005
Subject: [Rd] How to understand packages, namespaces, environments
In-Reply-To: <f3ed5b562d661ead695a58d506e52e02@mail.med.upenn.edu>
References: <f3ed5b562d661ead695a58d506e52e02@mail.med.upenn.edu>
Message-ID: <427BAC04.4020502@stats.uwo.ca>

Alexander Stoddard wrote:
> I would be very glad of pointers to information on how the concepts of 
> packages, namespaces and environments are interrelated in R.

I don't think that documentation exists yet, but I did update the 
documentation on environments for 2.1.0.  Look in the section (2.1.10 I 
think) on Environment Objects in the R language definition manual. 
Basically environments are things where you can ask to look up names and 
R will return R objects to you.  They're a bit more complicated than 
just a list of (name, object) pairs, but can (almost) be used as that 
(and I'm hoping will be able to be used that way in 2.2.0, but that 
remains to be seen).

> I am trying to get a handle on this both so I can delve further into 
> understanding other people's code and so I can organize my own in a more 
> coherent manner.
> 
>  From my reading about environments it seems they function as what I 
> would intuitively call namespaces. However, the documentation for the 
> 'library' function implies that "namespace" has a specific meaning in R 
> that I have so far failed to grasp. What is that meaning (or where 
> should I look to read up on it) ?

A namespace is a more abstract concept, which happens to be implemented 
in R using environments. Exactly how is a bit of a mystery to me, I'm 
afraid!  However, the basic idea is that a namespace defines a fixed set 
of meanings for names, which the code in a package can assume won't 
change.  It may also hide some names from outsiders.
> 
> I can think of the following more specific questions. Perhaps they may 
> most usefully serve to reveal my misconceptions, so corrections would be 
> very helpful.
> 
> Does saying the following load package 'foo' into its own environment ?
>  > library(foo)

This loads some of the (name, object) pairs from the package into two 
environments:  the public one the user can see, and the namespace one 
that the code in the package can see.  They're related, you don't get 
two copies of the objects.
> 
> Do environments have names?

They are R objects, so some of them have names, and some of them are 
anonymous parts of other objects.
> 
> Of what does the list returned by search() actually consist? Is it a 
> list of environments, a list that may include environments, or something 
> else?

It's a list of strings that can be used to get corresponding 
environments.  You don't get the actual environments.
> 
> What is actually designated by a character vector of form "package:foo"?

That string is used by the as.environment() function to go through the 
search list and obtain the environment.  For instance, you can do

x <- as.environment("package:foo")

and x will be a reference to the environment.  Then

ls(x)

will list all the objects there, get('bar', envir=x)  will extract the 
object named 'bar' from it, etc.
> 
> In what ways can I use the character vector "package:foo" when 
> interacting with R?

I can't think of any other uses than in as.environment(), but there 
might be some, or some automatic calls to it.  I'd have to check the man 
pages to be sure, but perhaps some functions that accept envir=x type 
arguments would automatically call as.environment on x first.

> Many thanks,
> Alex Stoddard
> 
> P.S. It took me a long time of flailing about to discover the 'search' 
> function. Perhaps it could be included in the "See Also" section of the 
> help for 'ls'.

That's a good suggestion.  Could you do me a favour, and as you're 
reading up on this stuff identify a whole list of deficiencies in the 
documentation and suggested fixes for them?  Making a change to a man 
page has a certain fixed overhead (making sure there are no syntax 
errors, committing, possibly porting the change to the patch branch), so 
batching them is efficient.

Duncan Murdoch

From jeff at kanecap.com  Fri May  6 20:45:47 2005
From: jeff at kanecap.com (Jeff Enos)
Date: Fri May  6 20:46:44 2005
Subject: [Rd] Varying as.Date performance
In-Reply-To: <Pine.LNX.4.61.0505051557100.10592@gannet.stats>
References: <17017.17895.337156.535491@gargle.gargle.HOWL>
	<Pine.LNX.4.61.0505050717100.20206@gannet.stats>
	<17018.7818.716318.388693@gargle.gargle.HOWL>
	<x2vf5xlpb2.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0505051557100.10592@gannet.stats>
Message-ID: <17019.47963.289452.97465@gargle.gargle.HOWL>

Thanks for this optimization and for adding it to R-devel.  My
original command on the glibc 2.3.3 machine now runs much faster:

> system.time(x <- as.Date(rep("01-01-2005", 100000), format = "%m-%d-%Y"))
[1] 0.97 0.91 1.88 0.00 0.00

and is in line with the time seen on the glibc 2.3.2 machine.

Jeff

Prof Brian Ripley writes:
 > On Thu, 5 May 2005, Peter Dalgaard wrote:
 > 
 > > Jeff Enos <jeff@kanecap.com> writes:
 > >
 > >> Thanks for these suggestions.  C-level profiling yields the following:
 > >>
 > >>   %   cumulative   self              self     total
 > >>  time   seconds   seconds    calls   s/call   s/call  name
 > >>  36.01      5.34     5.34   100000     0.00     0.00  get_locale_strings
 > >>   4.32      5.98     0.64   100000     0.00     0.00  mktime00
 > >>   3.98      6.57     0.59   277462     0.00     0.00  Rf_eval
 > >>   3.71      7.12     0.55   472935     0.00     0.00  Rf_findVarInFrame3
 > >>   3.64      7.66     0.54   100000     0.00     0.00  strptime_internal
 > >>   3.51      8.18     0.52        1     0.52     7.51  do_strptime
 > >>
 > >> It looks like strftime is called from get_locale_strings, which might
 > >> be the culprit.  Any suggestions on where I might go from here?
 > >
 > > You might try modifying get_locale_strings (and its wide counterpart)
 > > with a check for an unchanged locale. E.g.
 > >
 > > static char *last_LC_TIME=NULL;
 > >
 > > ....
 > >
 > >  tmp = setlocale(LC_TIME, NULL)
 > >  if (strcmp(tmp, last_LC_TIME)) return;
 > >
 > >  last_LC_TIME = tmp;
 > >
 > > .... set the strings ....
 > >
 > > if the call to setlocale is considerably faster than 40 calls to
 > > strftime(), you might have a winner.
 > 
 > Yes, I think that would be a worthwhile optimization.  I didn't bother 
 > because I figured it would be fast enough (which at 50musec it almost 
 > always is).
 > 
 > However, get_locale_strings is only 36% of the total, and we have at least 
 > another 60% to account for.  (81.01 vs 1.18 secs.)
 > 
 > -- 
 > Brian D. Ripley,                  ripley@stats.ox.ac.uk
 > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
 > University of Oxford,             Tel:  +44 1865 272861 (self)
 > 1 South Parks Road,                     +44 1865 272866 (PA)
 > Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
Jeff Enos
Kane Capital Management
jeff@kanecap.com

From vograno at evafunds.com  Fri May  6 23:48:11 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Fri May  6 23:48:20 2005
Subject: [Rd] treating lists as data.frame-s
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E9316@phost015.EVAFUNDS.intermedia.net>

Hi,
 
For the sake of efficiency I am trying to do away from data frames and
use lists instead. The two more frequently used operations on data
frames are row subscripting "[" and "[<-" for which I want to find good
(idiomatic) replacements. 
 
For x[i,j] extraction I came up with the following replacement:
y = lapply(x[j], function(col) col[i])

which looks concise enough and is more efficient.


However I couldn't think of anything elegant for y[i,j] = x. 

Suggestions?

Thanks,
Vadim

From matchsyman at dkoontz.com  Sat May  7 05:41:49 2005
From: matchsyman at dkoontz.com (matchsyman@dkoontz.com)
Date: Sat May  7 05:42:03 2005
Subject: [Rd] We have top-selling rneds for you. They are onssale novv.
	(PR#7843)
Message-ID: <20050507034149.0506C85B0@slim.kubism.ku.dk>

As one experienced e-supplier, our company is dedicated to provide customers
quick and legitimate services. It is a better chance for customers to sav on
either brand name or generic rneds. And it is legitimate to shoppe for
rnedicals in this way.
 
Select our company that provides you quality cures on ereection
dysfunction, pain, man's care, stress, sleeping disorder, highcholesterol,
musclerelaxants, obesity and various symptoms. The company provides quick
logistic services and ensures convenient and timely shipment.

It is such a relaxing shopping environment. All the items are onssale novv.

Your case profile will be reviewed by licensed experts in a timely manner.

http://XH.TF.appealingtoyou.com/cpf/




ound of the hall opened and the tree o f knowledge appeared, surrounded by
a halo of glory that almost blinded him. Vo
ices, soft and lovely as his mother's sounded in his ears, as if s k. Ican
sme 
he were singing to him, "My child, my beloved child." Then the fairy b
his year, and seemwell and cheerful. But then you were once the prettiest
girl inVi in 2 "The ricated bricks, soon discover 4 said was

From vograno at evafunds.com  Sat May  7 17:30:49 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Sat May  7 17:30:58 2005
Subject: [Rd] how to add method to .Primitive function
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E9333@phost015.EVAFUNDS.intermedia.net>

Hi,
 
I tried to write the dim method for the list class, but R doesn't seem
to dispatch to it:
> dim.list = function(x) c(length(x[[1]]), length(x))
> dim(list(1))
NULL
> dim.list(list(1))
[1] 1 1

What is the correct way of registering dim.list with .Primitive("dim")?
 
Thanks,
Vadim
 
 

	[[alternative HTML version deleted]]

From ripley at stats.ox.ac.uk  Sat May  7 17:41:57 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May  7 17:42:06 2005
Subject: [Rd] how to add method to .Primitive function
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E9333@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E9333@phost015.EVAFUNDS.intermedia.net>
Message-ID: <Pine.LNX.4.61.0505071636550.17532@gannet.stats>

On Sat, 7 May 2005, Vadim Ogranovich wrote:

> I tried to write the dim method for the list class, but R doesn't seem
> to dispatch to it:
>> dim.list = function(x) c(length(x[[1]]), length(x))
>> dim(list(1))
> NULL
>> dim.list(list(1))
> [1] 1 1
>
> What is the correct way of registering dim.list with .Primitive("dim")?

You really don't want to be doing this: the standard dim() function is 
intended to work with lists and is used e.g. for matrix lists.
So you are in danger of breaking things.

For that reason and for performance reasons, the internal dispatch only 
works on explicit class attributes as given by oldClass(), not the 
implicit ones given by class().


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at gmail.com  Sat May  7 17:56:29 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat May  7 17:56:37 2005
Subject: [Rd] how to add method to .Primitive function
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E9333@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E9333@phost015.EVAFUNDS.intermedia.net>
Message-ID: <971536df050507085659082061@mail.gmail.com>

On 5/7/05, Vadim Ogranovich <vograno@evafunds.com> wrote:
> I tried to write the dim method for the list class, but R doesn't seem
> to dispatch to it:
> > dim.list = function(x) c(length(x[[1]]), length(x))
> > dim(list(1))
> NULL
> > dim.list(list(1))
> [1] 1 1
> 
> What is the correct way of registering dim.list with .Primitive("dim")?

The list method of dim is sealed 

> isSealedMethod("dim", "list")
[1] TRUE

but you could define a subclass, mylist, and use that:

> setClass("mylist", representation(x = "list"), contains = "list")
[1] "mylist"
> setMethod("dim", "mylist", function(x) c(length(x@x[[1]]), length(x@x)))
[1] "dim"
> x <- new("mylist", x = list(x = 1, y = 2))
> dim(x)
[1] 1 2

From ggrothendieck at gmail.com  Sat May  7 20:50:49 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat May  7 20:50:57 2005
Subject: [Rd] NextMethod problem
Message-ID: <971536df05050711507c5c9884@mail.gmail.com>

Can anyone shed any light on what is going wrong here?
Its based on simplifying some actual code that exists in
model.frame.default.  It looks like a bug to me.  Thanks.

data(iris)

f.default <- function(x, subset, ...) {
  subset <- eval(substitute(subset), iris, .GlobalEnv)
  subset
}

# This one is ok
f(1, 1:3)

# putting an intermediate f.numeric in results in body
# of subset function being returned
f.numeric <- function(x, subset, ...) NextMethod("f")
f(1, 1:3)

# slightly different f.numeric results in error
f.numeric <- function(x, ...) NextMethod("f")
f(1, 1:3)

R.version.string # Windows XP

---

Output:


> f.default <- function(x, subset, ...) {
+   subset <- eval(substitute(subset), iris, .GlobalEnv)
+   subset
+ }
> 
> # This one is ok
> f(1, 1:3)
[1] 1 2 3
> 
> 
> # putting an intermediate f.numeric in results in body
> # of subset function being returned
> f.numeric <- function(x, subset, ...) NextMethod("f")
> f(1, 1:3)
function (x, ...) 
UseMethod("subset")
<environment: namespace:base>
> 
> # slightly different f.numeric results in error
> f.numeric <- function(x, ...) NextMethod("f")
> f(1, 1:3)
Error in eval(expr, envir, enclos) : ..1 used in an incorrect context,
no ... to look in
> 
> R.version.string # Windows XP
[1] "R version 2.1.0, 2005-04-18"

From vograno at evafunds.com  Sat May  7 20:59:04 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Sat May  7 20:59:12 2005
Subject: [Rd] how to add method to .Primitive function
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E9334@phost015.EVAFUNDS.intermedia.net>

But then mylist is not a list:
> x <- new("mylist", x = list(x = 1, y = 2))
> x[[1]]
Error in x[[1]] : subscript out of bounds

This is probably solvable by a sprinkle of setIs or setAs spells, but
each time I get into the S4 area I feel walking a mine-field.

All this exercise on my part was to write a list-based
lightweight.data.frame class, which would be more efficient than the
data.frame.
I'd pondered this idea some time ago and now again came back to it
frustrated by the slowness of the data.frame. But it seems I am not up
to the task.

Thank you for helping anyway,
Vadim

> -----Original Message-----
> From: Gabor Grothendieck [mailto:ggrothendieck@gmail.com] 
> Sent: Saturday, May 07, 2005 8:56 AM
> To: Vadim Ogranovich
> Cc: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] how to add method to .Primitive function
> 
> On 5/7/05, Vadim Ogranovich <vograno@evafunds.com> wrote:
> > I tried to write the dim method for the list class, but R 
> doesn't seem 
> > to dispatch to it:
> > > dim.list = function(x) c(length(x[[1]]), length(x))
> > > dim(list(1))
> > NULL
> > > dim.list(list(1))
> > [1] 1 1
> > 
> > What is the correct way of registering dim.list with 
> .Primitive("dim")?
> 
> The list method of dim is sealed 
> 
> > isSealedMethod("dim", "list")
> [1] TRUE
> 
> but you could define a subclass, mylist, and use that:
> 
> > setClass("mylist", representation(x = "list"), contains = "list")
> [1] "mylist"
> > setMethod("dim", "mylist", function(x) c(length(x@x[[1]]), 
> > length(x@x)))
> [1] "dim"
> > x <- new("mylist", x = list(x = 1, y = 2))
> > dim(x)
> [1] 1 2
>

From mailmarshal at bancobmg.com.br  Sat May  7 21:27:51 2005
From: mailmarshal at bancobmg.com.br (mailmarshal@bancobmg.com.br)
Date: Sat May  7 21:28:07 2005
Subject: [Rd] =?iso-8859-1?q?=5BConte=FAdo_n=E3o_permitido=5D?=
Message-ID: <D427d16b70000@BMG17.bancobmg.com.br>

**************************************************************************************************
ATEN??O
Esta ? uma mensagem autom?tica e n?o monitorada. N?o responda essa mensagem, pois ela n?o ser? lida.
**************************************************************************************************

A mensagem "DUVIDO VOCE ME RECONHER =)" enviada para - joana@bancobmg.com.br - n?o pode ser entregue. 
Um ou mais dos anexos encontra-se na lista de tipos de arquivo pro?bidos pelo sistema e n?o poder? ser entregue.


Administrador do Sistema de E-Mail
Banco BMG S/A






-------------- next part --------------
3552 16:27:51.318 Message From <r-devel@r-project.org>, Return-path <r-devel@r-project.org>, Recipients (1) -  <joana@bancobmg.com.br> 
3552 16:27:51.318 Thread 2 Starting to unpack <B427d16a90000.000000000001.0001.mml>
3552 16:27:51.318 Type=MAIL,  size=119836,  Name=B427d16a90000.000000000001.0001.mml
3552 16:27:51.318   Type=MHDR,  size=452,  Name=MsgHeader.txt
3552 16:27:51.318   Type=MBODY,  size=4,  Name=Plain.txt
3552 16:27:51.318   Type=ZIP,  size=86911,  Name=fotografia.zip
3552 16:27:51.318     Type=EXEW32,  size=86637,  Name=fotografia.txt                                                                      .pif
3552 16:27:51.318 1 user(s) match ruleset - Anti-Spam
3552 16:27:51.318   1 user(s) match rule - Assuntos Espec?ficos 1
3552 16:27:51.318     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.318       Name=U2\MsgHeader.txt (MHDR,452) False
3552 16:27:51.318       Name=U2\Plain.txt (MBODY,4) False
3552 16:27:51.318       Name=U2\fotografia.zip (ZIP,86911) False
3552 16:27:51.318         Name=U3\fotografia.txt                                                                      .pif (EXEW32,86637) False
3552 16:27:51.318   1 user(s) match rule - Assuntos Espec?ficos 2
3552 16:27:51.318     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.318       Name=U2\MsgHeader.txt (MHDR,452) False
3552 16:27:51.318       Name=U2\Plain.txt (MBODY,4) False
3552 16:27:51.318       Name=U2\fotografia.zip (ZIP,86911) False
3552 16:27:51.318         Name=U3\fotografia.txt                                                                      .pif (EXEW32,86637) False
3552 16:27:51.318   0 user(s) match rule - Spam espec?ficos
3552 16:27:51.318   1 user(s) match rule - Block Spam
3552 16:27:51.318     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.318   1 user(s) match rule - Block SPAM Haus Blacklisted
3552 16:27:51.537 DNS Blacklist lookup: 201.19.120.26 is not listed in <sbl.spamhaus.org>  - rcode(71)
3552 16:27:51.537     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.537   1 user(s) match rule - Block SpamCop Blacklisted
3552 16:27:51.709 DNS Blacklist lookup: 201.19.120.26 is not listed in <bl.spamcop.net>  - rcode(71)
3552 16:27:51.709     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.709   1 user(s) match rule - Block Spoofed Messages - Local Domain
3552 16:27:51.709     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.709   1 user(s) match rule - Block Spoofed Messages - Anti-Relay
3552 16:27:51.709     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.709   1 user(s) match rule - Block Spoofed Messages - ESMTP
3552 16:27:51.709     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.709   1 user(s) match rule - Block MAPS RBL Blacklisted
3552 16:27:51.881 DNS Blacklist lookup: 201.19.120.26 is not listed in <bl.spamcop.net>  - rcode(71)
3552 16:27:51.881     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.881   1 user(s) match rule - C?digos e Scripts no E-Mail
3552 16:27:51.881     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.881       Name=U2\MsgHeader.txt (MHDR,452) False
3552 16:27:51.881       Name=U2\Plain.txt (MBODY,4) False
3552 16:27:51.881       Name=U2\fotografia.zip (ZIP,86911) False
3552 16:27:51.881         Name=U3\fotografia.txt                                                                      .pif (EXEW32,86637) False
3552 16:27:51.881   1 user(s) match rule - Bloqueio de anexos perigosos
3552 16:27:51.881     Name=U1\B427d16a90000.000000000001.0001.mml (MAIL,119836) False
3552 16:27:51.881       Name=U2\MsgHeader.txt (MHDR,452) False
3552 16:27:51.881       Name=U2\Plain.txt (MBODY,4) False
3552 16:27:51.881       Name=U2\fotografia.zip (ZIP,86911) False
3552 16:27:51.881 CRuleCriteriaFileName found match for *.pif in filename d:\NetIQ\MailMarshal\Unpacking\T2\U3\fotografia.txt                                                                      .pif [d:\NetIQ\MailMarshal\Unpacking\T2\U3\fotografia.txt                                                                      .pif]
3552 16:27:51.881         Name=U3\fotografia.txt                                                                      .pif (EXEW32,86637) TRUE
3552 16:27:51.881         Requesting Action <Anti-Spam:Bloqueio de anexos perigosos:MailTemplate> be run
From simon.urbanek at r-project.org  Sat May  7 21:33:49 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat May  7 21:33:51 2005
Subject: [Rd] how to add method to .Primitive function
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E9334@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E9334@phost015.EVAFUNDS.intermedia.net>
Message-ID: <4318EAA1-A3B2-43B5-81CF-EF0A9E929F43@r-project.org>

On May 7, 2005, at 2:59 PM, Vadim Ogranovich wrote:


> But then mylist is not a list:
>
>
>> x <- new("mylist", x = list(x = 1, y = 2))
>> x[[1]]
>>
>>
> Error in x[[1]] : subscript out of bounds
>
> This is probably solvable by a sprinkle of setIs or setAs spells, but
> each time I get into the S4 area I feel walking a mine-field.
>

Well, then you can still use S3:
x <- list(x=1:5, y=5:1)
class(x) <- "mylist"
dim.mylist <- function(l) c(length(l[[1]]),length(l))
dim(x)
[1] 5 2
x[[1]]
[1] 1 2 3 4 5
is.list(x)
[1] TRUE

I'm not saying it's a good idea, because you can still break other  
things if you're not careful, but it's possible... If all you want is  
writing convenience functions for lists, that's fine, but I don't  
think you can replace data frames with such objects easily ...

Cheers,
Simon

From vograno at evafunds.com  Sat May  7 22:18:07 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Sat May  7 22:18:16 2005
Subject: [Rd] how to add method to .Primitive function
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E9336@phost015.EVAFUNDS.intermedia.net>

Thank you for the tip! I'll see if I can take it on to "[<-.mylist" 

Why do you think it will be hard to replace data frames? Insightful
recently introduced a new class, largeDataFrame or something like this.
This new class looks and feels like a data.frame, but they made two key
simplifications: all columns are atomic vectors and there is no
rownames. Maintaining the latter is a big overhead in many data.frame
operations, consider for example rbind() which needs to ensure uniquness
of the row names.

I'd really like to hear why you think it would be a bad idea to have
such a class.

Thanks,
Vadim

> -----Original Message-----
> From: Simon Urbanek [mailto:simon.urbanek@r-project.org] 
> Sent: Saturday, May 07, 2005 12:34 PM
> To: Vadim Ogranovich
> Cc: Gabor Grothendieck; r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] how to add method to .Primitive function
> 
> On May 7, 2005, at 2:59 PM, Vadim Ogranovich wrote:
> 
> 
> > But then mylist is not a list:
> >
> >
> >> x <- new("mylist", x = list(x = 1, y = 2)) x[[1]]
> >>
> >>
> > Error in x[[1]] : subscript out of bounds
> >
> > This is probably solvable by a sprinkle of setIs or setAs 
> spells, but
> > each time I get into the S4 area I feel walking a mine-field.
> >
> 
> Well, then you can still use S3:
> x <- list(x=1:5, y=5:1)
> class(x) <- "mylist"
> dim.mylist <- function(l) c(length(l[[1]]),length(l))
> dim(x)
> [1] 5 2
> x[[1]]
> [1] 1 2 3 4 5
> is.list(x)
> [1] TRUE
> 
> I'm not saying it's a good idea, because you can still break other  
> things if you're not careful, but it's possible... If all you 
> want is  
> writing convenience functions for lists, that's fine, but I don't  
> think you can replace data frames with such objects easily ...
> 
> Cheers,
> Simon
> 
> 
>

From ggrothendieck at gmail.com  Sun May  8 02:17:28 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun May  8 02:17:37 2005
Subject: [Rd] how to add method to .Primitive function
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E9336@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E9336@phost015.EVAFUNDS.intermedia.net>
Message-ID: <971536df05050717171eebcffe@mail.gmail.com>

Actually I think Simon's approach is a good one.  Maybe Simon's
comment was really intended to say that its dangerous
to redefine list operations but it should not be dangerous
to define a subclass of list and override operations that
way.  Also since the whole purpose of this is for speed I think
S3 is a better fit since from what I have seen S3 is faster
than S4.

On 5/7/05, Vadim Ogranovich <vograno@evafunds.com> wrote:
> Thank you for the tip! I'll see if I can take it on to "[<-.mylist"
> 
> Why do you think it will be hard to replace data frames? Insightful
> recently introduced a new class, largeDataFrame or something like this.
> This new class looks and feels like a data.frame, but they made two key
> simplifications: all columns are atomic vectors and there is no
> rownames. Maintaining the latter is a big overhead in many data.frame
> operations, consider for example rbind() which needs to ensure uniquness
> of the row names.
> 
> I'd really like to hear why you think it would be a bad idea to have
> such a class.
> 
> Thanks,
> Vadim
> 
> > -----Original Message-----
> > From: Simon Urbanek [mailto:simon.urbanek@r-project.org]
> > Sent: Saturday, May 07, 2005 12:34 PM
> > To: Vadim Ogranovich
> > Cc: Gabor Grothendieck; r-devel@stat.math.ethz.ch
> > Subject: Re: [Rd] how to add method to .Primitive function
> >
> > On May 7, 2005, at 2:59 PM, Vadim Ogranovich wrote:
> >
> >
> > > But then mylist is not a list:
> > >
> > >
> > >> x <- new("mylist", x = list(x = 1, y = 2)) x[[1]]
> > >>
> > >>
> > > Error in x[[1]] : subscript out of bounds
> > >
> > > This is probably solvable by a sprinkle of setIs or setAs
> > spells, but
> > > each time I get into the S4 area I feel walking a mine-field.
> > >
> >
> > Well, then you can still use S3:
> > x <- list(x=1:5, y=5:1)
> > class(x) <- "mylist"
> > dim.mylist <- function(l) c(length(l[[1]]),length(l))
> > dim(x)
> > [1] 5 2
> > x[[1]]
> > [1] 1 2 3 4 5
> > is.list(x)
> > [1] TRUE
> >
> > I'm not saying it's a good idea, because you can still break other
> > things if you're not careful, but it's possible... If all you
> > want is
> > writing convenience functions for lists, that's fine, but I don't
> > think you can replace data frames with such objects easily ...
> >
> > Cheers,
> > Simon
> >
> >
> >
>

From ggrothendieck at gmail.com  Sun May  8 02:20:15 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun May  8 02:20:23 2005
Subject: [Rd] Re: NextMethod problem
In-Reply-To: <971536df05050711507c5c9884@mail.gmail.com>
References: <971536df05050711507c5c9884@mail.gmail.com>
Message-ID: <971536df0505071720585a6510@mail.gmail.com>

Its probably obvious but just for completeness, I missed the
generic definition in pasting this into my post so I have
added it below:

On 5/7/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> Can anyone shed any light on what is going wrong here?
> Its based on simplifying some actual code that exists in
> model.frame.default.  It looks like a bug to me.  Thanks.
> 

function(x, ...) UseMethod("f")

> data(iris)
> 
> f.default <- function(x, subset, ...) {
>  subset <- eval(substitute(subset), iris, .GlobalEnv)
>  subset
> }
> 
> # This one is ok
> f(1, 1:3)
> 
> # putting an intermediate f.numeric in results in body
> # of subset function being returned
> f.numeric <- function(x, subset, ...) NextMethod("f")
> f(1, 1:3)
> 
> # slightly different f.numeric results in error
> f.numeric <- function(x, ...) NextMethod("f")
> f(1, 1:3)
> 
> R.version.string # Windows XP
> 
> ---
> 
> Output:

> function(x, ...) UseMethod("f")
> data(iris)
> 
> > f.default <- function(x, subset, ...) {
> +   subset <- eval(substitute(subset), iris, .GlobalEnv)
> +   subset
> + }
> >
> > # This one is ok
> > f(1, 1:3)
> [1] 1 2 3
> >
> >
> > # putting an intermediate f.numeric in results in body
> > # of subset function being returned
> > f.numeric <- function(x, subset, ...) NextMethod("f")
> > f(1, 1:3)
> function (x, ...)
> UseMethod("subset")
> <environment: namespace:base>
> >
> > # slightly different f.numeric results in error
> > f.numeric <- function(x, ...) NextMethod("f")
> > f(1, 1:3)
> Error in eval(expr, envir, enclos) : ..1 used in an incorrect context,
> no ... to look in
> >
> > R.version.string # Windows XP
> [1] "R version 2.1.0, 2005-04-18"
>

From phgrosjean at sciviews.org  Sun May  8 08:57:57 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun May  8 08:58:20 2005
Subject: [Rd] Different package versions on CRAN?
Message-ID: <427DB875.7010706@sciviews.org>

Hello,

I am making changes to some of my packages that are exposed in CRAN. 
Some changes make them incompatible with previous R versions [and I use 
Depends: R (>= 2.1.0)]. I suspect that, as soon as I will upload this 
new version to CRAN, it will replace the old one _everywhere_? However, 
the previous version of these packages remains perfectly usable with R 
1.9.X or 2.0.X. So, will this break the binaries in 
/windows/contrib/1.9|2.0, or will the latest valid binaries of my 
packages remain there, not updated? To put it another way, for a package 
Mypack with version 1.0-1 compatible with all R versions, when I upload 
Mypack version 2.0-0 compatible only with R 2.1.0, what will be the 
result on CRAN regarding Windows binaires?
1?) /windows/contrib/2.1/Mypack_2.0-0.zip
     /windows/contrib/2.0/Mypack_1.0-1.zip  # Not updated
     /windows/contrib/1.9/....              # Idem for all other subdirs

or

2?) /windows/contrib/2.1/Mypack_2.0-0.zip
     ??? error ??? because CRAN tries to update the package for other 
subdirectories and encounters Depends: R (>= 2.1.0) ???

Thanks,

Philippe

..............................................<?}))><........
  ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
  ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
  ) ) ) ) )   Mons-Hainaut University, Pentagone (3D08)
( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
  ) ) ) ) )   8, av du Champ de Mars, 7000 Mons, Belgium
( ( ( ( (
  ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.30.54
( ( ( ( (    email: Philippe.Grosjean@umh.ac.be
  ) ) ) ) )
( ( ( ( (    web:   http://www.umh.ac.be/~econum
  ) ) ) ) )          http://www.sciviews.org
( ( ( ( (
..............................................................

From ripley at stats.ox.ac.uk  Sun May  8 11:07:53 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun May  8 11:08:03 2005
Subject: [Rd] Different package versions on CRAN?
In-Reply-To: <427DB875.7010706@sciviews.org>
References: <427DB875.7010706@sciviews.org>
Message-ID: <Pine.LNX.4.61.0505081003270.15123@gannet.stats>

On Sun, 8 May 2005, Philippe Grosjean wrote:

> I am making changes to some of my packages that are exposed in CRAN. Some 
> changes make them incompatible with previous R versions [and I use Depends: R 
> (>= 2.1.0)]. I suspect that, as soon as I will upload this new version to 
> CRAN, it will replace the old one _everywhere_?

No.  It would not be offered as an update to systems running R < 2.1.0.

> However, the previous version 
> of these packages remains perfectly usable with R 1.9.X or 2.0.X. So, will 
> this break the binaries in /windows/contrib/1.9|2.0, or will the latest valid 
> binaries of my packages remain there, not updated? To put it another way, for

We do not update binary versions for obselete versions of R.  Just look at 
the dates on the directories: 2.0 was last updated on April 19.  And even 
if we did (the 1.9 directory was AFAIR updated for a bit after 2.0.0 came 
out) the version depending on R >= 2.1.0 would not build and so the last 
good version would be left.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Sun May  8 14:58:06 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun May  8 14:57:26 2005
Subject: [Rd] Different package versions on CRAN?
In-Reply-To: <Pine.LNX.4.61.0505081003270.15123@gannet.stats>
References: <427DB875.7010706@sciviews.org>
	<Pine.LNX.4.61.0505081003270.15123@gannet.stats>
Message-ID: <427E0CDE.4030602@statistik.uni-dortmund.de>

Prof Brian Ripley wrote:

> On Sun, 8 May 2005, Philippe Grosjean wrote:
> 
>> I am making changes to some of my packages that are exposed in CRAN. 
>> Some changes make them incompatible with previous R versions [and I 
>> use Depends: R (>= 2.1.0)]. I suspect that, as soon as I will upload 
>> this new version to CRAN, it will replace the old one _everywhere_?
> 
> 
> No.  It would not be offered as an update to systems running R < 2.1.0.
> 
>> However, the previous version of these packages remains perfectly 
>> usable with R 1.9.X or 2.0.X. So, will this break the binaries in 
>> /windows/contrib/1.9|2.0, or will the latest valid binaries of my 
>> packages remain there, not updated? To put it another way, for
> 
> 
> We do not update binary versions for obselete versions of R.  Just look 
> at the dates on the directories: 2.0 was last updated on April 19.  And 
> even if we did (the 1.9 directory was AFAIR updated for a bit after 
> 2.0.0 came out) the version depending on R >= 2.1.0 would not build and 

Yes, you are perfectly right.
There is also documentation that is even more specific in 
CRAN/bin/windows/contrib/1.9/ReadMe which tells us:

***********************************************************
This collection is for rw1090/1 only. It is no longer being
updated: please update to rw2001. Last update: 15.12.2004.
***********************************************************


I planned to update R-2.0.x also for a while. In fact, too many packages 
had versions out that depended on R>=2.1.0 very quickly (even if not 
mentioned in the DESCRIPTION file), and it's a whole mess to let the 
autobuilder decide which package to update, which not, and which to mark 
to be erroneous. So I decided not to update anything in order not to 
disarrange the whole repository.



> so the last good version would be left.

Yes, and accordingly CRAN/bin/windows/contrib/ReadMe tells us:

   ./1.9   Binaries for R-1.9.x - no longer updated
   ./2.0   Binaries for R-2.0.x - no longer updated
   ./2.1   Binaries for R-2.1.x - release (AKA r-release)


Uwe

From vograno at evafunds.com  Sun May  8 20:09:10 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Sun May  8 20:09:18 2005
Subject: [Rd] Light-weight data.frame class: was: how to add method to
	.Primitive function
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E9339@phost015.EVAFUNDS.intermedia.net>

Hi,

Encouraged by a tip from Simon Urbanek I tried to use the S3 machinery
to write a faster version of the data.frame class.
This quickly hits a snag: the "[.default"(x, i) for some reason cares
about the dimensionality of x.
In the end there is a full transcript of my R session. It includes the
motivation for writing the class and the problems I have encountered.

As a result I see three issues here:
* why "[.default"(x, i) doesn't work if dim(x) is 2? After all a single
subscript into a vector works regardless of whether it's a matrix or
not. Is there an alternative way to access "[.default"?
* why does unclass() make deep copy? This is a facet of the global
over-conservatism of R with respect to copying.
* is it possible to add some sort copy profiling to R? Something like
copyProfiling(TRUE), which should cause R to log sizes of each copied
object (just raw sizes w/o any attempt to identify the object). This
feature should at least help assess the magnitude of the problem.

Thanks,
Vadim

Now the transcript itself:
> # the motivation: subscription of a data.frame is *much* (almost 20
times) slower than that of a list
> # compare
> n = 1e6
> i = seq(n)
> 
> x = data.frame(a=seq(n), b=seq(n))
> system.time(x[i,], gcFirst=TRUE)
[1] 1.01 0.14 1.14 0.00 0.00
> 
> x = list(a=seq(n), b=seq(n))
> system.time(lapply(x, function(col) col[i]), gcFirst=TRUE)
[1] 0.06 0.00 0.06 0.00 0.00
> 
> 
> # the solution: define methods for the light-weight data.frame class
> lwdf = function(...) structure(list(...), class = "lwdf")
> 
> # dim
> dim.lwdf = function(x) c(length(x[[1]]), length(x))
> 
> # for pretty printing we define print.lwdf via a conversion to
data.frame
> # as.data.frame.lwdf
> as.data.frame.lwdf = function(x) structure(unclass(x),
class="data.frame", row.names=as.character(seq(nrow(x))))
> 
> # print
> print.lwdf = function(x) print.data.frame(as.data.frame.lwdf(x))
> 
> # now the real stuff
> 
> # "["
> # the naive "[.lwdf" = function (x, i, j) lapply(x[j], function(col)
col[i])
> # won't work because evaluation of x[j] calls "[.lwdf" again and not
"[.default"
> # so we switch by the number of arguments
> "[.lwdf" = function (x, i, j) {
+   if (nargs() == 2)
+     NextMethod("[", x, i)
+   else
+     structure(lapply(x[j], function(col) col[i]),  class = "lwdf")
+ }
> 
> x = lwdf(a=seq(3), b=letters[seq(3)], c=as.factor(letters[seq(3)]))
> i = c(1,3); j = c(1,3)
> 
> # unfortunately, for some reasons "[.default" cares about
dimensionality of its argument
> x[i,j]
Error in "[.default"(x, j) : incorrect number of dimensions
> 
> 
> # we could use unclass to get it right
> "[.lwdf" = function (x, i, j) {
+   structure(lapply(unclass(x)[j], function(col) col[i]),  class =
"lwdf")
+ }
> 
> x[i,j]
  a c
1 1 a
2 3 c
> 
> # *but* unclass creates a deep copy of its argument as indirectly
evidenced by the following timing
> x = lwdf(a=seq(1e6)); system.time(unclass(x))
[1] 0.01 0.00 0.01 0.00 0.00
> x = lwdf(a=seq(1e8)); system.time(unclass(x))
[1] 0.44 0.39 0.82 0.00 0.00

> version
         _                       
platform x86_64-unknown-linux-gnu
arch     x86_64                  
os       linux-gnu               
system   x86_64, linux-gnu       
status                           
major    2                       
minor    0.1                     
year     2004                    
month    11                      
day      15                      
language R

From kjetil at acelerate.com  Sun May  8 21:30:26 2005
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Sun May  8 21:30:43 2005
Subject: [Rd] docu of isoreg
Message-ID: <427E68D2.1080708@acelerate.com>

?isoreg has

isoreg(x, y = NULL)

Arguments:

|x, y| 	in |isoreg|, coordinate vectors of the regression points. 
Alternatively a single ?plotting? structure can be specified: see 
|xy.coords <cid:part1.02070302.03090407@acelerate.com>|.
|...| 	potentially further arguments passed to methods.


the ... dots seem superfluous.

Additionally, the help p;age could need
\concept{monotonic} or
\concept{monotonic regression}


Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra




-- 
No virus found in this outgoing message.
Checked by AVG Anti-Virus.

From Mark.Bravington at csiro.au  Mon May  9 01:24:59 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Mon May  9 01:25:12 2005
Subject: [Rd] How to understand packages, namespaces, environments
Message-ID: <4D99275E380CA94F998977EDACE548DC1AE6B0@extas2-hba.tas.csiro.au>

[Alexander Stoddard]
> Subject: Re: [Rd] How to understand packages, namespaces, environments
> 
> > 
> > Does saying the following load package 'foo' into its own 
> environment ?
> >  > library(foo)
> 
[Duncan Murdoch]
> This loads some of the (name, object) pairs from the package into two
> environments:  the public one the user can see, and the 
> namespace one that the code in the package can see.  They're 
> related, you don't get two copies of the objects.

That's interesting-- I thought there really were two copies. In my debug
package, I've taken the approach of changing both copies. Is one of the
copies a "master", and the other one something like an activeBinding?
Can I get away with changing just one of them?

Mark Bravington

From ggrothendieck at gmail.com  Mon May  9 01:46:31 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon May  9 01:46:39 2005
Subject: [Rd] How to understand packages, namespaces, environments
In-Reply-To: <4D99275E380CA94F998977EDACE548DC1AE6B0@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC1AE6B0@extas2-hba.tas.csiro.au>
Message-ID: <971536df050508164627376868@mail.gmail.com>

On 5/8/05, Mark.Bravington@csiro.au <Mark.Bravington@csiro.au> wrote:
> [Alexander Stoddard]
> > Subject: Re: [Rd] How to understand packages, namespaces, environments
> >
> > >
> > > Does saying the following load package 'foo' into its own
> > environment ?
> > >  > library(foo)
> >
> [Duncan Murdoch]
> > This loads some of the (name, object) pairs from the package into two
> > environments:  the public one the user can see, and the
> > namespace one that the code in the package can see.  They're
> > related, you don't get two copies of the objects.
> 
> That's interesting-- I thought there really were two copies. In my debug
> package, I've taken the approach of changing both copies.

How does one refer to the two different copies? Thanks.

From Mark.Bravington at csiro.au  Mon May  9 03:46:34 2005
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Mon May  9 03:46:46 2005
Subject: [Rd] How to understand packages, namespaces, environments
Message-ID: <4D99275E380CA94F998977EDACE548DC062654@extas2-hba.tas.csiro.au>

> On 5/8/05, Mark.Bravington@csiro.au <Mark.Bravington@csiro.au> wrote:
> > [Alexander Stoddard]
> > > Subject: Re: [Rd] How to understand packages, namespaces, 
> > > environments
> > >
> > > >
> > > > Does saying the following load package 'foo' into its own
> > > environment ?
> > > >  > library(foo)
> > >
> > [Duncan Murdoch]
> > > This loads some of the (name, object) pairs from the package into 
> > > two
> > > environments:  the public one the user can see, and the namespace 
> > > one that the code in the package can see.  They're related, you 
> > > don't get two copies of the objects.
> >
[MVB] 
> > That's interesting-- I thought there really were two copies. In my 
> > debug package, I've taken the approach of changing both copies.
> 
[Gabor Grothendieck]
> How does one refer to the two different copies? Thanks.
> 
> 

The help for fun.locator (in the debug package) contains my
interpretation of what's going on (which might be wrong, but seems to
work). A slightly simplified version of the guts of fun.locator is as
follows:

  # function to check for something called fname
  is.here <- function( env) exists( fname, env=env, inherits=FALSE)

  # Search path
  search.envs <- lapply( 1:length( search()), pos.to.env)
  ff <- search.envs[ sapply( search.envs, is.here)]
 
  # Hidden namespace environments
  ln <- lapply( loadedNamespaces(), asNamespace)
  ff <- c( ff, ln[ sapply( ln, is.here)]) 
  
  # S3 methods:
  S3 <- lapply( ln, function( x) if( exists( '.__S3MethodsTable__.', x,
inherits=FALSE)) 
    get( '.__S3MethodsTable__.', x) else 0)
  S3 <- S3[ !sapply( S3, is.numeric)]
  ff <- c( ff, S3[ sapply( S3, is.here)])

Then ff is a list of environments where a copy (?) of fname exists-- and
you can use
 ff[[i]][[fname]] 
or 
 get(fname, env=ff[[i]]) & assign( fname, ..., env=ff[[i]])

I should point out that the doco for asNamespace says "not intended to
be called directly"-- but I couldn't see an alternative, and anyway it
seems to work (for now).

Mark

From simon.urbanek at r-project.org  Mon May  9 05:03:26 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon May  9 05:03:35 2005
Subject: [Rd] Light-weight data.frame class: was: how to add method to
	.Primitive function
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E9339@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E9339@phost015.EVAFUNDS.intermedia.net>
Message-ID: <AF5BEC3E-C569-4B37-8E00-CB589C6B519D@r-project.org>

Vadim,

On May 8, 2005, at 2:09 PM, Vadim Ogranovich wrote:

>> # the naive "[.lwdf" = function (x, i, j) lapply(x[j], function 
>> (col) col[i])

Umm... what about his:

"[.lwdf" = function(x, i, j) { r<-lapply(lapply(j,function(a) x 
[[a]]),function(x) x[i]); names(r)<-names(x)[j]; r }

The subsetting operates on vectors, so it's not a problem. Don't ask  
me about the speed, though ;). And btw: you could access "[

What I meant with my cautious remarks are the following issues. You  
were talking about building a df alternative (s/df/data.frame/g in  
this e-mail). The first issue is that by re-defining "[" and friends  
you make your new calls incompatible with the behavior of lists, so  
you won't be able to use it where lists are required (even though  
is.list says TRUE). This may break code were you'd like your class to  
act as a list. On the other hand, your class is not a df either - and  
I suspect that it's far from trivial to make it even closely  
compatible with a df in terms of its behavior. Moreover any function  
that checks for df won't treat your class as such, because it simply  
is no df (is.data.frame()=FALSE for starters). So in the end, you  
would have to modify every function in R that uses df to recognize  
your new class. On the other hand if you make your class a subclass  
of df (there we get into some trouble with S3), you could replace the  
back-end, but then you will have to support every df feature  
including row.names. You could try it, but I'm somewhat skeptical...  
but your mileage may vary ...

Cheers,
Simon

From jeff.hamann at forestinformatics.com  Mon May  9 06:23:26 2005
From: jeff.hamann at forestinformatics.com (Jeff D. Hamann)
Date: Mon May  9 06:23:45 2005
Subject: [Rd] can't build packages anymore...
Message-ID: <003601c5544e$dbc6d370$0a00a8c0@rodan>

R developers,

I've been happily building packages, under windows, for some time now and 
upgraded to R 2.1.0 and now when I attempt to build a package, I get the 
following errors...


C:\conifers>rcmd build Rconifers
* checking for file 'Rconifers/DESCRIPTION' ... OK
* preparing 'Rconifers':
* checking DESCRIPTION meta-information ... OK
* cleaning src
* checking whether 'INDEX' is up-to-date ... OK
* removing junk files
/cygdrive/C/conifers/Rconifers_0.0-3.tar
tar: /cygdrive/C/conifers/Rconifers_0.0-3.tar: Cannot open: No such file or 
directory
tar: Error is not recoverable: exiting now
tar: /cygdrive/C/conifers/Rconifers_0.0-3.tar: Cannot open: No such file or 
directory
tar: Error is not recoverable: exiting now
Error: cannot open file 'Rconifers/DESCRIPTION' for reading

C:\conifers>

When I attempt to create a tar archive by hand, it seems to work just fine 
(the creation of the tar file that is). So I thought I check out the build 
script to see where the problem was (not that I knew how to change it.. but 
it never hurts to look). I found the following lines:

    my $filename = "${pkgname}_" . $description->{"Version"} . ".tar";
    my $filepath = &file_path($startdir, $filename);
    ## under Windows, need separate Cygwin and Windows versions of path.
    my $origfilepath = $filepath;

    if($WINDOWS) {
## workaround for paths in Cygwin tar
$filepath =~ s+^([A-Za-x]):+/cygdrive/\1+;
    }

And I'm not sure why that's in there. Aren't packages that are built under 
Windows using the Mingw and MSYS tools exclusively? Should they? Could they?

I'm not sure how to fix this and for now, I'll have to revert back to the 
older version of R (Mongo not happy) so I can continue my work, but I'd like 
to know either how to fix this, or if it's a problem with my machine's 
configuration or the package build process under newer versions of R. I see 
there's a new verion on the horizon and I want to get my building working 
under it as soon as possible.

I do have all the required tools (mingw, cygwin, etc.) in the correct place 
to build packages under the older version... what's changed?

Thanks,
Jeff.



---
Jeff D. Hamann
Forest Informatics, Inc.
PO Box 1421
Corvallis, Oregon USA 97339-1421
541-754-1428
jeff.hamann@forestinformatics.com
www.forestinformatics.com

From ripley at stats.ox.ac.uk  Mon May  9 06:39:13 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon May  9 06:39:27 2005
Subject: [Rd] How to understand packages, namespaces, environments
In-Reply-To: <4D99275E380CA94F998977EDACE548DC1AE6B0@extas2-hba.tas.csiro.au>
References: <4D99275E380CA94F998977EDACE548DC1AE6B0@extas2-hba.tas.csiro.au>
Message-ID: <Pine.LNX.4.61.0505090527030.28603@gannet.stats>

On Mon, 9 May 2005 Mark.Bravington@csiro.au wrote:

> [Alexander Stoddard]
>> Subject: Re: [Rd] How to understand packages, namespaces, environments
>>
>>>
>>> Does saying the following load package 'foo' into its own
>> environment ?
>>> > library(foo)
>>
> [Duncan Murdoch]
>> This loads some of the (name, object) pairs from the package into two
>> environments:  the public one the user can see, and the
>> namespace one that the code in the package can see.  They're
>> related, you don't get two copies of the objects.
>
> That's interesting-- I thought there really were two copies. In my debug
> package, I've taken the approach of changing both copies. Is one of the
> copies a "master", and the other one something like an activeBinding?
> Can I get away with changing just one of them?

Duncan is wrong here (or misquoted).  Loading a package with a namespace 
loads all the objects in the package (possibly as promises) into the 
namespace environment.  Then some are copied (using assign) to the package 
environment.  Since like most R copies this is really copy-on-change you 
do not get a real copy (nor force a promise) until use.

See ?fixInNamespace for explicit statements about this.  There can be more 
than two copies, since importing also `copies', as does S3 method 
registration (the latter does sometimes force promises).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Mon May  9 07:56:11 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon May  9 07:55:39 2005
Subject: [Rd] How to understand packages, namespaces, environments
In-Reply-To: <Pine.LNX.4.61.0505090527030.28603@gannet.stats>
References: <4D99275E380CA94F998977EDACE548DC1AE6B0@extas2-hba.tas.csiro.au>
	<Pine.LNX.4.61.0505090527030.28603@gannet.stats>
Message-ID: <427EFB7B.6090005@stats.uwo.ca>

Prof Brian Ripley wrote:
> On Mon, 9 May 2005 Mark.Bravington@csiro.au wrote:
> 
>> [Alexander Stoddard]
>>
>>> Subject: Re: [Rd] How to understand packages, namespaces, environments
>>>
>>>>
>>>> Does saying the following load package 'foo' into its own
>>>
>>> environment ?
>>>
>>>> > library(foo)
>>>
>>>
>> [Duncan Murdoch]
>>
>>> This loads some of the (name, object) pairs from the package into two
>>> environments:  the public one the user can see, and the
>>> namespace one that the code in the package can see.  They're
>>> related, you don't get two copies of the objects.
>>
>>
>> That's interesting-- I thought there really were two copies. In my debug
>> package, I've taken the approach of changing both copies. Is one of the
>> copies a "master", and the other one something like an activeBinding?
>> Can I get away with changing just one of them?
> 
> 
> Duncan is wrong here (or misquoted).  

Wrong, not misquoted.  Sorry about that.  Thanks for the correct 
description.

Duncan Murdoch

> Loading a package with a namespace 
> loads all the objects in the package (possibly as promises) into the 
> namespace environment.  Then some are copied (using assign) to the 
> package environment.  Since like most R copies this is really 
> copy-on-change you do not get a real copy (nor force a promise) until use.
> 
> See ?fixInNamespace for explicit statements about this.  There can be 
> more than two copies, since importing also `copies', as does S3 method 
> registration (the latter does sometimes force promises).
>

From ligges at statistik.uni-dortmund.de  Mon May  9 08:36:18 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon May  9 08:35:41 2005
Subject: [Rd] can't build packages anymore...
In-Reply-To: <003601c5544e$dbc6d370$0a00a8c0@rodan>
References: <003601c5544e$dbc6d370$0a00a8c0@rodan>
Message-ID: <427F04E2.8090408@statistik.uni-dortmund.de>

Jeff D. Hamann wrote:

> R developers,
> 
> I've been happily building packages, under windows, for some time now 
> and upgraded to R 2.1.0 and now when I attempt to build a package, I get 
> the following errors...
> 
> 
> C:\conifers>rcmd build Rconifers
> * checking for file 'Rconifers/DESCRIPTION' ... OK
> * preparing 'Rconifers':
> * checking DESCRIPTION meta-information ... OK
> * cleaning src
> * checking whether 'INDEX' is up-to-date ... OK
> * removing junk files
> /cygdrive/C/conifers/Rconifers_0.0-3.tar
> tar: /cygdrive/C/conifers/Rconifers_0.0-3.tar: Cannot open: No such file 
> or directory
> tar: Error is not recoverable: exiting now
> tar: /cygdrive/C/conifers/Rconifers_0.0-3.tar: Cannot open: No such file 
> or directory
> tar: Error is not recoverable: exiting now
> Error: cannot open file 'Rconifers/DESCRIPTION' for reading
> 
> C:\conifers>
> 
> When I attempt to create a tar archive by hand, it seems to work just 
> fine (the creation of the tar file that is). So I thought I check out 
> the build script to see where the problem was (not that I knew how to 
> change it.. but it never hurts to look). I found the following lines:
> 
>    my $filename = "${pkgname}_" . $description->{"Version"} . ".tar";
>    my $filepath = &file_path($startdir, $filename);
>    ## under Windows, need separate Cygwin and Windows versions of path.
>    my $origfilepath = $filepath;
> 
>    if($WINDOWS) {
> ## workaround for paths in Cygwin tar
> $filepath =~ s+^([A-Za-x]):+/cygdrive/\1+;
>    }

Jeff, is this the recent version of MinGW, Perl and the tools?


> And I'm not sure why that's in there. Aren't packages that are built 
> under Windows using the Mingw and MSYS tools exclusively? Should they? 
> Could they?

Yes, MinGW, and the tools which are based on some cygwin sources, AFAIK.
But you must not have any other cygwin directory in your path.

As you can see from the Windows binary package section on CRAN, building 
packages works perfectly well for us.

If it still does not work for you, you might want to start from scratch 
by cleaning up your path and following the instructions given in the "R 
Installation and Administration" manual.


Uwe


> I'm not sure how to fix this and for now, I'll have to revert back to 
> the older version of R (Mongo not happy) so I can continue my work, but 
> I'd like to know either how to fix this, or if it's a problem with my 
> machine's configuration or the package build process under newer 
> versions of R. I see there's a new verion on the horizon and I want to 
> get my building working under it as soon as possible.
>
> I do have all the required tools (mingw, cygwin, etc.) in the correct 
> place to build packages under the older version... what's changed?
> 
> Thanks,
> Jeff.
> 
> 
> 
> ---
> Jeff D. Hamann
> Forest Informatics, Inc.
> PO Box 1421
> Corvallis, Oregon USA 97339-1421
> 541-754-1428
> jeff.hamann@forestinformatics.com
> www.forestinformatics.com
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ggrothendieck at gmail.com  Mon May  9 15:18:46 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon May  9 15:19:31 2005
Subject: [Rd] Variable names with spaces in lm
Message-ID: <971536df050509061840ba9f7e@mail.gmail.com>

'lm' gives an error when using variables with spaces in them
in certain cases (but not all):

	my.list <- list(`a 1` = 1:4, `a 2` = 11:14)
	lm(`a 1` ~ ., my.list) # Error : Object "a.1" not found

# The following work ok so it does work in many cases:

	lm(`a 1` ~ ., as.data.frame(my.list, optional = TRUE)) # ok
	lm(`a 1` ~ `a 2`, my.list) # ok

Admittedly ?lm says that the data argument should be
a data frame or environment so this is not strictly a bug
but it seems to work with a list and the code even seems to 
coerce it to a data frame.

I am using Windows XP "R version 2.1.0, 2005-04-18".

From p.dalgaard at biostat.ku.dk  Mon May  9 19:37:25 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon May  9 19:37:34 2005
Subject: [Rd] Variable names with spaces in lm
In-Reply-To: <971536df050509061840ba9f7e@mail.gmail.com>
References: <971536df050509061840ba9f7e@mail.gmail.com>
Message-ID: <x2ekcgwbai.fsf@turmalin.kubism.ku.dk>

Gabor Grothendieck <ggrothendieck@gmail.com> writes:

> 'lm' gives an error when using variables with spaces in them
> in certain cases (but not all):
> 
> 	my.list <- list(`a 1` = 1:4, `a 2` = 11:14)
> 	lm(`a 1` ~ ., my.list) # Error : Object "a.1" not found
> 
> # The following work ok so it does work in many cases:
> 
> 	lm(`a 1` ~ ., as.data.frame(my.list, optional = TRUE)) # ok
> 	lm(`a 1` ~ `a 2`, my.list) # ok
> 
> Admittedly ?lm says that the data argument should be
> a data frame or environment so this is not strictly a bug
> but it seems to work with a list and the code even seems to 
> coerce it to a data frame.
> 
> I am using Windows XP "R version 2.1.0, 2005-04-18".

As you probably gathered, the issue is that there's an as.data.frame()
without optional=TRUE  sitting inside terms.formula which causes the
"." to expand to a.1 + a.2. Sounds like that's unconditionally a bug,
but I'm a little unsure...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From monk at umich.edu  Mon May  9 19:53:01 2005
From: monk at umich.edu (monk@umich.edu)
Date: Mon May  9 19:53:08 2005
Subject: [Rd] Random Forests 4.5-10 varImpPlot (PR#7844)
Message-ID: <20050509175301.191F9DDE9@slim.kubism.ku.dk>

Full_Name: Daniel Normolle
Version: 2.0.1
OS: Linux/Fedora Core 3
Submission from: (NULL) (141.214.17.5)


varImpPlot in Random Forests 4.5-10 produces the error  "incorrect number of 
subscripts on matrix" (and no plot) when applied to a randomForest object.  This

error did not occur with 4.5-4 or earlier versions.

From andy_liaw at merck.com  Mon May  9 20:16:11 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Mon May  9 20:16:56 2005
Subject: [Rd] Random Forests 4.5-10 varImpPlot (PR#7844)
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E806@usctmx1106.merck.com>

Please read the R FAQ on how to report bugs on contributed packages:  Not to
R-bug: as that's not a bug in R itself.

example(varImpPlot) ran just fine in R-2.1.0.  Please show _the_ example
where you got the error.

Andy

> From: monk@umich.edu
> 
> Full_Name: Daniel Normolle
> Version: 2.0.1
> OS: Linux/Fedora Core 3
> Submission from: (NULL) (141.214.17.5)
> 
> 
> varImpPlot in Random Forests 4.5-10 produces the error  
> "incorrect number of 
> subscripts on matrix" (and no plot) when applied to a 
> randomForest object.  This
> 
> error did not occur with 4.5-4 or earlier versions.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From Ret at sender.ingenio.com  Mon May  9 22:50:38 2005
From: Ret at sender.ingenio.com (Ret@sender.ingenio.com)
Date: Mon May  9 22:50:47 2005
Subject: [Rd] Status (PR#7845)
Message-ID: <20050509205038.649A2DD7D@slim.kubism.ku.dk>


	[[alternative HTML version deleted]]

From ggrothendieck at gmail.com  Mon May  9 23:43:22 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon May  9 23:44:51 2005
Subject: [Rd] Variable names with spaces in lm
In-Reply-To: <x2ekcgwbai.fsf@turmalin.kubism.ku.dk>
References: <971536df050509061840ba9f7e@mail.gmail.com>
	<x2ekcgwbai.fsf@turmalin.kubism.ku.dk>
Message-ID: <971536df05050914436612752d@mail.gmail.com>

There is one other problem with the coercion to data.frame.
terms.formula does not actually use the data contents, I think, so if it
did not coerce to a data frame it could handle unequal length
data in lists too.

On 09 May 2005 19:37:25 +0200, Peter Dalgaard <p.dalgaard@biostat.ku.dk> wrote:
> Gabor Grothendieck <ggrothendieck@gmail.com> writes:
> 
> > 'lm' gives an error when using variables with spaces in them
> > in certain cases (but not all):
> >
> >       my.list <- list(`a 1` = 1:4, `a 2` = 11:14)
> >       lm(`a 1` ~ ., my.list) # Error : Object "a.1" not found
> >
> > # The following work ok so it does work in many cases:
> >
> >       lm(`a 1` ~ ., as.data.frame(my.list, optional = TRUE)) # ok
> >       lm(`a 1` ~ `a 2`, my.list) # ok
> >
> > Admittedly ?lm says that the data argument should be
> > a data frame or environment so this is not strictly a bug
> > but it seems to work with a list and the code even seems to
> > coerce it to a data frame.
> >
> > I am using Windows XP "R version 2.1.0, 2005-04-18".
> 
> As you probably gathered, the issue is that there's an as.data.frame()
> without optional=TRUE  sitting inside terms.formula which causes the
> "." to expand to a.1 + a.2. Sounds like that's unconditionally a bug,
> but I'm a little unsure...
> 
> --
>   O__  ---- Peter Dalgaard             Blegdamsvej 3
>  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
> (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
>

From ggrothendieck at gmail.com  Tue May 10 06:45:50 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue May 10 06:46:00 2005
Subject: [Rd] Light-weight data.frame class: was: how to add method to
	.Primitive function
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A59E9339@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A59E9339@phost015.EVAFUNDS.intermedia.net>
Message-ID: <971536df05050921451f71bce0@mail.gmail.com>

"[.default" is implemented in R as .subset.  See ?.subset and note that
it begins with a dot.  e.g. for the case where i and j are not missing:

"[.lwdf" <- function(x, i, j) lapply(.subset(x,j), "[", i)



On 5/8/05, Vadim Ogranovich <vograno@evafunds.com> wrote:
> Hi,
> 
> Encouraged by a tip from Simon Urbanek I tried to use the S3 machinery
> to write a faster version of the data.frame class.
> This quickly hits a snag: the "[.default"(x, i) for some reason cares
> about the dimensionality of x.
> In the end there is a full transcript of my R session. It includes the
> motivation for writing the class and the problems I have encountered.
> 
> As a result I see three issues here:
> * why "[.default"(x, i) doesn't work if dim(x) is 2? After all a single
> subscript into a vector works regardless of whether it's a matrix or
> not. Is there an alternative way to access "[.default"?
> * why does unclass() make deep copy? This is a facet of the global
> over-conservatism of R with respect to copying.
> * is it possible to add some sort copy profiling to R? Something like
> copyProfiling(TRUE), which should cause R to log sizes of each copied
> object (just raw sizes w/o any attempt to identify the object). This
> feature should at least help assess the magnitude of the problem.
> 
> Thanks,
> Vadim
> 
> Now the transcript itself:
> > # the motivation: subscription of a data.frame is *much* (almost 20
> times) slower than that of a list
> > # compare
> > n = 1e6
> > i = seq(n)
> >
> > x = data.frame(a=seq(n), b=seq(n))
> > system.time(x[i,], gcFirst=TRUE)
> [1] 1.01 0.14 1.14 0.00 0.00
> >
> > x = list(a=seq(n), b=seq(n))
> > system.time(lapply(x, function(col) col[i]), gcFirst=TRUE)
> [1] 0.06 0.00 0.06 0.00 0.00
> >
> >
> > # the solution: define methods for the light-weight data.frame class
> > lwdf = function(...) structure(list(...), class = "lwdf")
> >
> > # dim
> > dim.lwdf = function(x) c(length(x[[1]]), length(x))
> >
> > # for pretty printing we define print.lwdf via a conversion to
> data.frame
> > # as.data.frame.lwdf
> > as.data.frame.lwdf = function(x) structure(unclass(x),
> class="data.frame", row.names=as.character(seq(nrow(x))))
> >
> > # print
> > print.lwdf = function(x) print.data.frame(as.data.frame.lwdf(x))
> >
> > # now the real stuff
> >
> > # "["
> > # the naive "[.lwdf" = function (x, i, j) lapply(x[j], function(col)
> col[i])
> > # won't work because evaluation of x[j] calls "[.lwdf" again and not
> "[.default"
> > # so we switch by the number of arguments
> > "[.lwdf" = function (x, i, j) {
> +   if (nargs() == 2)
> +     NextMethod("[", x, i)
> +   else
> +     structure(lapply(x[j], function(col) col[i]),  class = "lwdf")
> + }
> >
> > x = lwdf(a=seq(3), b=letters[seq(3)], c=as.factor(letters[seq(3)]))
> > i = c(1,3); j = c(1,3)
> >
> > # unfortunately, for some reasons "[.default" cares about
> dimensionality of its argument
> > x[i,j]
> Error in "[.default"(x, j) : incorrect number of dimensions
> >
> >
> > # we could use unclass to get it right
> > "[.lwdf" = function (x, i, j) {
> +   structure(lapply(unclass(x)[j], function(col) col[i]),  class =
> "lwdf")
> + }
> >
> > x[i,j]
>  a c
> 1 1 a
> 2 3 c
> >
> > # *but* unclass creates a deep copy of its argument as indirectly
> evidenced by the following timing
> > x = lwdf(a=seq(1e6)); system.time(unclass(x))
> [1] 0.01 0.00 0.01 0.00 0.00
> > x = lwdf(a=seq(1e8)); system.time(unclass(x))
> [1] 0.44 0.39 0.82 0.00 0.00
> 
> > version
>         _
> platform x86_64-unknown-linux-gnu
> arch     x86_64
> os       linux-gnu
> system   x86_64, linux-gnu
> status
> major    2
> minor    0.1
> year     2004
> month    11
> day      15
> language R
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From phgrosjean at sciviews.org  Tue May 10 11:02:06 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Tue May 10 11:02:22 2005
Subject: [Rd] French translation of R
Message-ID: <4280788E.6040300@sciviews.org>

Hello all,

I have just started a translation of R into French. Any help from the 
French-speaking part of the R community would be very appreciated 
(translation, or proof-reading)!
Best,

Philippe Grosjean

..............................................<?}))><........
  ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
  ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
  ) ) ) ) )   Mons-Hainaut University, Pentagone (3D08)
( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
  ) ) ) ) )   8, av du Champ de Mars, 7000 Mons, Belgium
( ( ( ( (
  ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.30.54
( ( ( ( (    email: Philippe.Grosjean@umh.ac.be
  ) ) ) ) )
( ( ( ( (    web:   http://www.umh.ac.be/~econum
  ) ) ) ) )          http://www.sciviews.org
( ( ( ( (
..............................................................

From richard_maxime at yahoo.Fr  Tue May 10 14:04:08 2005
From: richard_maxime at yahoo.Fr (richard_maxime@yahoo.Fr)
Date: Tue May 10 14:04:17 2005
Subject: [Rd] big bug with edit(data.frame(a)) (PR#7846)
Message-ID: <20050510120408.D9F84E190@slim.kubism.ku.dk>

Full_Name: RICHARD Maxime
Version: R2.1.0
OS: Windows XP
Submission from: (NULL) (195.25.74.233)


I creat a file datafile2.txt with that

sujet	groupe	score
s1	exp	3
s2	exp	4
s3	exp	6
s4	cont	7
s5	cont	8

and i write

a <- read.table('datafile2.txt',header=T)
a
scores <- edit(data.frame(a))

After that i try to move with my third click on my mouse and

big bug and i'm ejected

From baud-bovy.gabriel at hsr.it  Tue May 10 13:46:52 2005
From: baud-bovy.gabriel at hsr.it (Gabriel Baud-Bovy)
Date: Tue May 10 14:08:12 2005
Subject: [Rd] Implementation of the names attribute of attribute lists 
Message-ID: <5.2.1.1.0.20050510124327.02b0d900@mail.hsr.it>

Dear all,

Internally, the attribute list appears to be implemented as an generic
list vector with a names attributes (i.e., the attribute slot in the object's
SEXPREC structure would point toward a VECTOR_SEXPREC representing
a generic vector).

 > attributes(c(a=1))
$names
[1] "a"
 > typeof(attributes(c(a=1)))
[1] "list"

 From R, it appears as if the named list had itself an
named attributes list and so on .... until no end

 > attributes(attributes(c(a=1)))
$names
[1] "names"
 > attributes(attributes(attributes(c(a=1))))
$names
[1] "names"

Etc.

This is also the case for any object  having an attributes list.

 > attributes(matrix(1,1,1))
$dim
[1] 1 1
 > attributes(attributes(matrix(1,1,1)))
$names
[1] "dim"
 > attributes(attributes(attributes(matrix(1,1,1))))
$names
[1] "names"

Obviously, this behavior of the attributes function cannot reflect the
actual internal structure of the object.  My question is therefore
whether named lists used as attribute have themselves a names attribute?
Another possibility would be that the names attribute of an attribute list
does not have a names attribute. A final possibility might be that
attribute list are implemented with dotted lists (pairlists) and
that the behaviour attributes reflect pairlist's "virtual" names
attributes. In this case, however, one would have expected

typeof(attributes(attributes(c(a=1))))
[1] "list"

to return "pairlist".

Could you reply to me on my private address? Thank you a lot.

Gabriel

PS: I wrote a function that prints the list-like internal structure
of any R object (this is quite easy indeed  :-)) and wrote the draft
of an article documenting it that I am thinking of submitting to
R-news. I would however appreciate your feedback on it (did I reinvent
the wheel?). This function, I think, could be used in many places
to document apparently obscure or confusing aspects of the R
language to a non-expert user. It is also quite useful when "computing
on the language".

## The print.object function prints a tree representing the list-like structure
## of any R object
##
## x: any R object
## typefun: anfunction returning the object's type (e.g., mode, 
storage.mode, class)
## print.attributes: flag indicating whether to print or not the attributes 
list
## deparse.level: the printout beyond this level is produced by the deparse 
function
##
## The name and level arguments are not intended to be used at the user-level.
print.object<-function(x,typefun=typeof,print.attributes=F,deparse.level=Inf,name=NULL,level=0) 
{
         margin<-paste(rep("  ",level),collapse="")
         # tag contain the name of the object (if any)
         tag<-if(!is.null(name)) paste("[",name,"] ",sep="") else ""
         #
         if(level>=deparse.level) {
                 # if level exceeds maximum, simplify output by using 
deparse function
                 cat(margin,"+ ",tag,"deparse : 
",paste(deparse(x),collapse=""),"\n",sep="")
         } else if(is.element(typeof(x),c("environment","promise"))) {
                 # environment and promises are recusive objects that 
cannot be transformed
                 # into list
                 cat(margin,"+ ",tag,"<",typefun(x),">=",sep="")
                 print(x)
         } else if(typeof(x)=="closure") {
                 cat(margin,"+ ",tag,"<",typefun(x),">\n",sep="")
                 # print each part (formals, body and environment) of a 
function object separately
                 print.object(formals(x),typefun,print.attributes,deparse.level,"[formals]",level+1)
                 print.object(body(x),typefun,print.attributes,deparse.level,"[body]",level+1)
                 print.object(environment(x),typefun,print.attributes,deparse.level,"[env]",level+1) 

         } else if(is.recursive(x)) {
                 # print type of the recursive object (as determined by 
typefun function)
                 cat(margin,"+ ",tag,"<",typefun(x),">\n",sep="")
                 # loop to print each element of the recursive object
                 # note: element's name is transmitted separetely (NULL if 
absent)
                 xx<-as.list(x)
                 for(i in seq(along=xx)) 
print.object(xx[[i]],typefun,print.attributes,deparse.level,names(xx)[i],level+1)
         } else {
                 # print atomic objects (vector, matrices, etc)
                 aux<-switch(as.character(mode(x)),
                         "character"=paste("\'",x,"\'",sep=""), # add 
quotes to characters
                         "NULL"="NULL",
                         as.character(x))
                 aux<-paste(aux,collapse=",")
                 if(nchar(aux)==0)aux<-"\'\'" # occurs in case of formals 
without default value in a function definition
                 cat(margin,"- ",tag,"<", typefun(x),">=",aux,sep="")
                 # names are also printed if they exist
                 if(!is.null(names(x))) cat(" [names]=", 
paste("\'",names(x),"\'",sep="",collapse=","),sep="")
                 cat("\n")
         }
         # print attributes (if any)
         if(print.attributes && !is.null(attributes(x))) {
                 # note: attributes are contained in a named list. Infinite 
recursion
                 # can happen because attributes lists have themselves a 
"names" attribute.
                 if(!is.null(name) && name=="[attributes]") {
#                       print the names attribute of the attribute list
#                       cat(margin,"  ","+ 
","[[attributes]]","<list>\n",sep="")
#                       cat(margin,"  ","  ","- 
","[names]",paste("\'",names(x),"\'",sep="",collapse=","),"\n",sep="")
                         return(invisible(NULL)) # prevent infinite recursion
                 }
                 # print attriutes list
                 print.object(attributes(x),typefun,print.attributes,deparse.level,"[attributes]",level+1)
         }
         invisible(NULL)
}




--------------------------------------------------------------------
Gabriel Baud-Bovy                            tel: (+39) 02 2643 4839
Faculty of Psychology, UHSR University       fax: (+39) 02 2643 4892
via Olgettina, 58, 20132 Milan, Italy

From murdoch at stats.uwo.ca  Tue May 10 16:51:21 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue May 10 16:50:48 2005
Subject: [Rd] big bug with edit(data.frame(a)) (PR#7846)
In-Reply-To: <20050510120408.D9F84E190@slim.kubism.ku.dk>
References: <20050510120408.D9F84E190@slim.kubism.ku.dk>
Message-ID: <4280CA69.3080100@stats.uwo.ca>

richard_maxime@yahoo.Fr wrote:
> Full_Name: RICHARD Maxime
> Version: R2.1.0
> OS: Windows XP
> Submission from: (NULL) (195.25.74.233)
> 
> 
> I creat a file datafile2.txt with that
> 
> sujet	groupe	score
> s1	exp	3
> s2	exp	4
> s3	exp	6
> s4	cont	7
> s5	cont	8
> 
> and i write
> 
> a <- read.table('datafile2.txt',header=T)
> a
> scores <- edit(data.frame(a))
> 
> After that i try to move with my third click on my mouse and
> 
> big bug and i'm ejected

I think this has been fixed.  Could you please try the R-patched 
version, available on CRAN mirrors, to confirm?

Duncan Murdoch

From Frederic.Lehobey at free.fr  Tue May 10 16:50:45 2005
From: Frederic.Lehobey at free.fr (Frederic Lehobey)
Date: Tue May 10 16:50:54 2005
Subject: [Rd] French translation of R
In-Reply-To: <4280788E.6040300@sciviews.org>
References: <4280788E.6040300@sciviews.org>
Message-ID: <20050510145045.GD1630@melusine>

Hi,

On Tue, May 10, 2005 at 11:02:06AM +0200, Philippe Grosjean wrote:

> I have just started a translation of R into French. Any help from the 
> French-speaking part of the R community would be very appreciated 
> (translation, or proof-reading)!

I am interested in helping you (actually I had already started such a
translation but not very far due to lack of time).

Best regards,
Frederic Lehobey

From jose at teleport.com  Tue May 10 17:46:19 2005
From: jose at teleport.com (jose@teleport.com)
Date: Tue May 10 17:46:30 2005
Subject: [Rd] Re: Good day
Message-ID: <E1DVWw8-0008FD-00@rosella.mail.pas.earthlink.net>

I apologize for this automatic reply to your email.

To control spam, I now allow incoming messages only from senders I
have approved beforehand.

If you would like to be added to my list of approved senders, please
fill out the short request form (see link below). Once I approve you,
I will receive your original message in my inbox. You do not need to
resend your message. I apologize for this one-time inconvenience.

Click the link below to fill out the request:

https://webmail.pas.earthlink.net/wam/addme?a=jose@teleport.com&id=1dvwVYM13NZFpn0

	[[alternative HTML version deleted]]

From pharma at jsbintelligence.com  Tue May 10 18:55:17 2005
From: pharma at jsbintelligence.com (pharma@jsbintelligence.com)
Date: Tue May 10 18:55:26 2005
Subject: [Rd] Re: 80-page Pharma complimentary report-Emerging Business
	models in Pharma (PR#7847)
Message-ID: <20050510165517.2562FE18C@slim.kubism.ku.dk>

------=_NextPart_84815C5ABAF209EF376268C8
Content-type: text/plain; charset=ISO-8859-1


Hello! 

This is just a quick note to inform you about an 80-page report on the Pharmaceutical Industry that we're able to provide you - at no cost. 

Compiled by some of the best analysts in the industry, the report provides an insight into the latest trends and strategies in the Pharmaceutical Industry. Over 50 pharma and biotech companies have been interviewed and benchmarked, and the resulting analysis will give you a comprehensive look at the future of the Industry. 

Maybe you haven't heard this yet - but Pharma companies are going through some huge changes in response to activities such as parallel trade, generic vs. patent fight, mergers and acquisitions, in-licensing and out-licensing, and the choice between semi block buster and block buster model. The report not only analyses the large structural changes and dynamic shifts in the Industry, it also takes an in-depth look at new revenue models. Another area of analysis is the shift from chemical-based small molecules to biology-based large molecules like antibodies and protein, and what new opportunities this has created in the Industry. 

To download the full report and view the table of contents click here. http://www.jsbintelligence.com/template.asp?docId=22&docName=Pharma-Report-Form

Should you be the wrong person to contact for this type of report, we would greatly appreciate if you would forward this email to the appropriate person in your company. 
Please do not hesitate to contact us shall you have any questions. 

Regards,
The JSB Intelligence Team 
www.jsbintelligence.com


    http://www.benchmarkemail.com/link/unsubscribe.asp?g=0&c=43101&l=37437901&e=r-bugs@biostat.ku.dk Click here  to unsubscribe from our mailing list. Or  reply to this message with the word unsubscribe or remove in the subject line.   

Address : Kildare House, 102-104 Sheen Road City: London  St: Outside US  Zip: TW9 1UF

Powered by Benchmarkemail
http://www.benchmarkemail.com 

REPORT ABUSE
http://www.benchmarkemail.com/link/report_abuse.asp?g=0&c=43101&l=37437901&e=r-bugs@biostat.ku.dk

------=_NextPart_84815C5ABAF209EF376268C8
Content-Type: text/html; charset=ISO-8859-1

<P><FONT face=Arial size=2> </FONT></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Hello! </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">This is just a quick note to inform you about an 80-page report on the Pharmaceutical Industry that we're able to provide you - at no cost. </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Compiled by some of the best analysts in the industry, the report provides an insight into the latest trends and strategies in the Pharmaceutical Industry. Over 50 pharma and biotech companies have been interviewed and benchmarked, and the resulting analysis will give you a comprehensive look at the future of the Industry. </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Maybe you haven't heard this yet - but Pharma companies are going through some huge changes in response to activities such as parallel trade, generic vs. patent fight, mergers and acquisitions, in-licensing and out-licensing, and the choice between semi block buster and block buster model. The report not only analyses the large structural changes and dynamic shifts in the Industry, it also takes an in-depth look at new revenue models. Another area of analysis is the shift from chemical-based small molecules to biology-based large molecules like antibodies and protein, and what new opportunities this has created in the Industry. </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><A href="http://www.benchmarkemail.com/link/redirect.asp?g=0&c=43101&l=37437901&e=r-bugs@biostat.ku.dk&url=http://www.jsbintelligence.com/template.asp?docId=22&docName=Pharma-Report-Form">To download the full report and view the table of contents click here.<SPAN style="FONT-SIZE: 12pt; FONT-FAMILY: 'Times New Roman'"><?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></SPAN></A></SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Should you be the wrong person to contact for this type of report, we would greatly appreciate if you would forward this email to the appropriate person in your company. </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Please do not hesitate to contact us shall you have any questions. </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Regards,<BR>The JSB Intelligence Team <BR><A href="http://www.benchmarkemail.com/link/redirect.asp?g=0&c=43101&l=37437901&e=r-bugs@biostat.ku.dk&url=http://www.jsbintelligence.com/">www.jsbintelligence.com</A></SPAN></P>
<center><font color=#000000 size='1' face='Arial' >   <a href="http://www.benchmarkemail.com/link/unsubscribe.asp?g=0&c=43101&l=37437901&e=r-bugs@biostat.ku.dk">Click here</a> to unsubscribe from our mailing list. Or <br> reply to this message with the word unsubscribe or remove in the subject line.  &nbsp; 

 <img src=http://www.benchmarkemail.com/link/open.asp?g=0&c=43101&l=37437901&f=0 border=0 height=1 width=1> &nbsp;
 </font></center>
<center><font color=#000000 style='font-size:7pt;font-family:Verdana;'>Address : Kildare House, 102-104 Sheen Road City: London  St: Outside US  Zip: TW9 1UF </font></center><br><br><center><a href="http://www.benchmarkemail.com" target=benchmarkemail><font color=#c0c0c0 face='Verdana,Arial' style='font-size:8pt;text-decoration:underline' ><b>Powered by Benchmarkemail</b></font></a></center><br><center><a href="http://www.benchmarkemail.com/link/report_abuse.asp?g=0&c=43101&l=37437901&e=r-bugs@biostat.ku.dk" target=benchmarkemail><font color=#C0C0C0 face='Verdana,Arial' style='font-size:8pt;text-decoration:underline' ><b>REPORT ABUSE</b></font></a></center></body></html>
------=_NextPart_84815C5ABAF209EF376268C8--

From baud-bovy.gabriel at hsr.it  Tue May 10 19:00:53 2005
From: baud-bovy.gabriel at hsr.it (Gabriel Baud-Bovy)
Date: Tue May 10 19:00:54 2005
Subject: Fwd: Re: [Rd] Implementation of the names attribute of
	attribute lists 
Message-ID: <5.2.1.1.0.20050510182235.02b161c0@mail.hsr.it>

Hi Martin,

Thanks for your reply. I am responding on r-devel to
provide some examples of outputs of the function that
I had list in the post-scriptum of my previous
email (BTW, did my post went through the list? I
subscribed only after mailing it).

You wrote:

>Just to ask the obvious:
>
>  Why is using  str() not sufficient for you and instead,
>  you use  'print.object' {not a good name, BTW, since it looks like a
>                           print() S3 method but isn't one} ?

Would printObject or printSEXP a better name?

>The very few cases I found it was insufficient,
>certainly  dput()  was, possibly even using it as
>dput(. , control = ....).

As I wrote in my email, I might have reinvented
the wheel. I did not know str! The output of
str and print.object is quite similar for
atomic and list objects. I might look at this
function to change the argument names of the
print.object function.

However, the output of str is quite different
for language expressions and does not show as well
the their list-like strcuture since it respects
the superficial C-like syntax of the R language
(at the textual level).

In contrast, print.object prints all R objects in a much
more uniform way. For me, at least, it is both simpler because
it handles recursive R-objects with a similar
format and closer to the internal Lisp-like SEXPR
structures representing the R objects.

It has, I think, a pedagogic value in particular
for language objects and can be useful when "computing
on the language". The goal was really to be simple,
clear and close the true and elegant internal
representation of the R  objects.

Examples

Atomic object

x<-matrix(1,2,2)
dimnames(x)<-list(c("1","2"),c("a","b"))
printObject(x,print.attr=T)
- <double>=1,1,1,1
   + [[attributes]] <list>
     - [dim] <integer>=2,2
     + [dimnames] <list>
       - <character>='1','2'
       - <character>='a','b'

str(x)
  num [1:2, 1:2] 1 1 1 1
  - attr(*, "dimnames")=List of 2
   ..$ : chr [1:2] "1" "2"
   ..$ : chr [1:2] "a" "b"

Note: I have chosen not to represent the names attribute of
the attribute list since I don't know how it is internally
represented as I said in my previous email.

 > x<-list(first=pairlist(a="a",b=as.name("b")),second=2)
 > printObject(x)
+ <list>
   + [first] <pairlist>
     - [a] <character>='a'
     - [b] <symbol>=b
   - [second] <double>=2
 > str(x)
List of 2
  $ first :Dotted pair list of 2
   ..$ a: chr "a"
   ..$ b: symbol b
  $ second: num 2
 > dput(x)
structure(list(first = list(a = "a", b = b), second = 2), .Names = c("first",
"second"))

Closure example

foo<-function(x,y)x+y
printObject(foo)
+ <closure>
   + [[formals]] <pairlist>
     - [x] <symbol>=''
     - [y] <symbol>=''
   + [[body]] <language>
     - <symbol>=+
     - <symbol>=x
     - <symbol>=y
   + [[env]] <environment>=<environment: R_GlobalEnv>


str(foo)
function (x, y)
  - attr(*, "source")= chr "function(x,y)x+ydput(foo)

dput(foo)
function (x, y)
x + y

Function calls:

printObject(quote(2+2))
+ <language>
   - <symbol>=+
   - <double>=2
   - <double>=2

printObject(expression(2+2))
+ <expression>
   + <language>
     - <symbol>=+
     - <double>=2
     - <double>=2
dput(expression(2+2))
expression(2 + 2)

printObject(quote(expression(2+2)))
+ <language>
   - <symbol>=expression
   + <language>
     - <symbol>=+
     - <double>=2
     - <double>=2
dput(quote(expression(2+2)))
expression(2 + 2)

statement<-quote(function(x,y){z<-(x+y)/2;z})
printObject(statement)
+ <language>
   - <symbol>=function
   + <pairlist>
     - [x] <symbol>=''
     - [y] <symbol>=''
   + <language>
     - <symbol>={
     + <language>
       - <symbol>=<-
       - <symbol>=z
       + <language>
         - <symbol>=/
         + <language>
           - <symbol>=(
           + <language>
             - <symbol>=+
             - <symbol>=x
             - <symbol>=y
         - <double>=2
     - <symbol>=z
   - <character>='function(x,y){z<-(x+y)/2;z}'

dput(statement)
function(x, y) {
     z <- (x + y)/2
     z
}

The output of printObject makes it easy to
identify and eventually change an element
of an expression (it easy to count the
argument in each function call).
For eample, to replace a division by
a multiplication

statement[[3]][[2]][[3]][[1]]<-as.name("*")


One additional point, to wrap the names of the elements of
recursive objects, I have used double brackets [[]] to
distinguish between a SEXP inside the SEXPR (this also used
for attributes) and single brackects for generic vectors.
For pairlist, I also use single brackets because it
is writtin in the Manual that they are converted in
generic vector of type pairlist when accessed from R.

The print.object function allows also to use the
"typefun" function (but this is a detail).

Regards,

Gabriel






>From: Martin Maechler <maechler@stat.math.ethz.ch>
>Date: Tue, 10 May 2005 17:30:32 +0200
>To: Gabriel Baud-Bovy <baud-bovy.gabriel@hsr.it>
>Subject: Re: [Rd] Implementation of the names attribute of attribute lists
>X-Mailer: VM 7.18 under Emacs 21.3.1
>Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>
>CC: maechler@stat.math.ethz.ch
>X-Virus-Scanned: by amavisd-new at stat.math.ethz.ch
>
>Hi Gabriel,
>
>Just to ask the obvious:
>
>  Why is using  str() not sufficient for you and instead,
>  you use  'print.object' {not a good name, BTW, since it looks like a
>                           print() S3 method but isn't one} ?
>
>The very few cases I found it was insufficient,
>certainly  dput()  was, possibly even using it as
>dput(. , control = ....).
>
>Note that this is a private e-mail only, but feel free to answer
>in public (R-devel) if you feel it helps others.
>
>Regards,
>Martin

--------------------------------------------------------------------
Gabriel Baud-Bovy                            tel: (+39) 02 2643 4839
Faculty of Psychology, UHSR University       fax: (+39) 02 2643 4892
via Olgettina, 58, 20132 Milan, Italy

From sigmakernel at yahoo.com  Tue May 10 19:45:35 2005
From: sigmakernel at yahoo.com (Giuseppe Ragusa)
Date: Tue May 10 19:43:31 2005
Subject: [Rd] bug, feature of mistery?
Message-ID: <20050510174535.GA21035@dss.ucsd.edu>



I have two machines a linux_amd64_x86 (gentoo_amd64) and a linux_x86. Both run
R-2.1.0. I have a very long program (hopefully will become a package)
that works perfectly on the linux_amd_x64. Great means no error, no
problems and results that, where the analytic solution exists,
coincide with it. I have problem making the code run on the x64 machine. I
am baffled. The same code on the same version of R, different arch,
is behaving differently. 

After hour of debugging, I traced down what is triggering the error on
the x86 machine.

the code snippet is the following similar to:

R>
g <- h(d)

f <- function( lambda )
{
z <- g %*% lambda
sum( psi(z) )
...
}

optim( init.value, f )

R>

The function f() is using lexical scoping to get obtain g. The
function psi() is a call to a wrapper function that call a (.C) C
function doing some simple calculation on z. 

What's the problem? When f() is called, g is there, lambda is there,
but the assignment  z <- g %*% lambda results in a matrix of NaN. This
happens from the second time f() is called, i.e. the first time f() is
called from optim() after the C call has been made. The error is then
that passing a NaN vector to .C results in halted execution. 

If I debug f() during the call to optim, I can without problem assign
z the correct value, but during the execution z is matrix(NaN, nr,
1). 

At this point I can think of the following:

1) the external C code has errors 

It is not a programming error, because when called from console it
   returns the right results. Also, remember, the program work on my
   other machine (the 64 bit);

2) R error (I do not think so)

3) Compiling error
Can be the gcc is messing thing around?

on the 32bit machine
gcc version 3.3.5  (Gentoo Linux 3.3.5-r1, ssp-3.3.2-3, pie-8.7.7.1)

on the 64-bit machine
gcc version 3.4.3 20041125 (Gentoo Linux 3.4.3-r1, ssp-3.4.3-0, pie-8.7.7)

Any help, suggestions, thoughts?

Thank you.

Giuseppe Ragusa

From tshort at eprisolutions.com  Tue May 10 19:52:54 2005
From: tshort at eprisolutions.com (tshort@eprisolutions.com)
Date: Tue May 10 19:53:01 2005
Subject: [Rd] wish: print.condition and html (PR#7848)
Message-ID: <20050510175254.2F1D8E190@slim.kubism.ku.dk>

Full_Name: Tom Short
Version: 2.1.0
OS: Win2000 
Submission from: (NULL) (68.236.159.160)


print.condition prints out error messages enclosed in angle brackets as in:

> simpleError("Sigh, yet another error...")
<simpleError: Sigh, yet another error...>

If R is used to generate HTML output (R2HTML or Rpad), then the error messages
get hidden because browsers will skip right over the "<simpleError: Sigh, yet
another error...>".

Suggestion: remove the angle brackets or replace with square brackets or
something else that won't confuse a browser.

- Tom

From ripley at stats.ox.ac.uk  Tue May 10 20:07:24 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue May 10 20:07:33 2005
Subject: [Rd] wish: print.condition and html (PR#7848)
Message-ID: <20050510180724.D04D9E18E@slim.kubism.ku.dk>

Surely this is a serious bug in your HTML generator?  It should be 
converting such characters to escape codes.

<> is used a lot in R printing, and it is not reasonable to expect R to 
change to avoid bugs in other tools.  So is [], and we don't want to add
confusion.

On Tue, 10 May 2005 tshort@eprisolutions.com wrote:

> Full_Name: Tom Short
> Version: 2.1.0
> OS: Win2000
> Submission from: (NULL) (68.236.159.160)
>
>
> print.condition prints out error messages enclosed in angle brackets as in:
>
>> simpleError("Sigh, yet another error...")
> <simpleError: Sigh, yet another error...>
>
> If R is used to generate HTML output (R2HTML or Rpad), then the error messages
> get hidden because browsers will skip right over the "<simpleError: Sigh, yet
> another error...>".
>
> Suggestion: remove the angle brackets or replace with square brackets or
> something else that won't confuse a browser.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From vograno at evafunds.com  Tue May 10 20:27:50 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Tue May 10 20:28:00 2005
Subject: [Rd] Light-weight data.frame class: was: how to add method to
	.Primitive function
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A59E9440@phost015.EVAFUNDS.intermedia.net>

Thanks again! BTW, how did you find the code for "[.default"? I tried:
> get("[.default")
Error in get(x, envir, mode, inherits) : variable "[.default" was not
found 

> -----Original Message-----
> From: Gabor Grothendieck [mailto:ggrothendieck@gmail.com] 
> Sent: Monday, May 09, 2005 9:46 PM
> To: Vadim Ogranovich
> Cc: r-devel@stat.math.ethz.ch; simon.urbanek@r-project.org
> Subject: Re: [Rd] Light-weight data.frame class: was: how to 
> add method to .Primitive function
> 
> "[.default" is implemented in R as .subset.  See ?.subset and 
> note that it begins with a dot.  e.g. for the case where i 
> and j are not missing:
> 
> "[.lwdf" <- function(x, i, j) lapply(.subset(x,j), "[", i)
> 
> 
> 
> On 5/8/05, Vadim Ogranovich <vograno@evafunds.com> wrote:
> > Hi,
> > 
> > Encouraged by a tip from Simon Urbanek I tried to use the 
> S3 machinery 
> > to write a faster version of the data.frame class.
> > This quickly hits a snag: the "[.default"(x, i) for some 
> reason cares 
> > about the dimensionality of x.
> > In the end there is a full transcript of my R session. It 
> includes the 
> > motivation for writing the class and the problems I have 
> encountered.
> > 
> > As a result I see three issues here:
> > * why "[.default"(x, i) doesn't work if dim(x) is 2? After all a 
> > single subscript into a vector works regardless of whether it's a 
> > matrix or not. Is there an alternative way to access "[.default"?
> > * why does unclass() make deep copy? This is a facet of the global 
> > over-conservatism of R with respect to copying.
> > * is it possible to add some sort copy profiling to R? 
> Something like 
> > copyProfiling(TRUE), which should cause R to log sizes of 
> each copied 
> > object (just raw sizes w/o any attempt to identify the 
> object). This 
> > feature should at least help assess the magnitude of the problem.
> > 
> > Thanks,
> > Vadim
> > 
> > Now the transcript itself:
> > > # the motivation: subscription of a data.frame is *much* 
> (almost 20
> > times) slower than that of a list
> > > # compare
> > > n = 1e6
> > > i = seq(n)
> > >
> > > x = data.frame(a=seq(n), b=seq(n))
> > > system.time(x[i,], gcFirst=TRUE)
> > [1] 1.01 0.14 1.14 0.00 0.00
> > >
> > > x = list(a=seq(n), b=seq(n))
> > > system.time(lapply(x, function(col) col[i]), gcFirst=TRUE)
> > [1] 0.06 0.00 0.06 0.00 0.00
> > >
> > >
> > > # the solution: define methods for the light-weight 
> data.frame class 
> > > lwdf = function(...) structure(list(...), class = "lwdf")
> > >
> > > # dim
> > > dim.lwdf = function(x) c(length(x[[1]]), length(x))
> > >
> > > # for pretty printing we define print.lwdf via a conversion to
> > data.frame
> > > # as.data.frame.lwdf
> > > as.data.frame.lwdf = function(x) structure(unclass(x),
> > class="data.frame", row.names=as.character(seq(nrow(x))))
> > >
> > > # print
> > > print.lwdf = function(x) print.data.frame(as.data.frame.lwdf(x))
> > >
> > > # now the real stuff
> > >
> > > # "["
> > > # the naive "[.lwdf" = function (x, i, j) lapply(x[j], 
> function(col)
> > col[i])
> > > # won't work because evaluation of x[j] calls "[.lwdf" 
> again and not
> > "[.default"
> > > # so we switch by the number of arguments "[.lwdf" = 
> function (x, i, 
> > > j) {
> > +   if (nargs() == 2)
> > +     NextMethod("[", x, i)
> > +   else
> > +     structure(lapply(x[j], function(col) col[i]),  class 
> = "lwdf") }
> > >
> > > x = lwdf(a=seq(3), b=letters[seq(3)], 
> c=as.factor(letters[seq(3)])) 
> > > i = c(1,3); j = c(1,3)
> > >
> > > # unfortunately, for some reasons "[.default" cares about
> > dimensionality of its argument
> > > x[i,j]
> > Error in "[.default"(x, j) : incorrect number of dimensions
> > >
> > >
> > > # we could use unclass to get it right "[.lwdf" = 
> function (x, i, j) 
> > > {
> > +   structure(lapply(unclass(x)[j], function(col) col[i]),  class =
> > "lwdf")
> > + }
> > >
> > > x[i,j]
> >  a c
> > 1 1 a
> > 2 3 c
> > >
> > > # *but* unclass creates a deep copy of its argument as indirectly
> > evidenced by the following timing
> > > x = lwdf(a=seq(1e6)); system.time(unclass(x))
> > [1] 0.01 0.00 0.01 0.00 0.00
> > > x = lwdf(a=seq(1e8)); system.time(unclass(x))
> > [1] 0.44 0.39 0.82 0.00 0.00
> > 
> > > version
> >         _
> > platform x86_64-unknown-linux-gnu
> > arch     x86_64
> > os       linux-gnu
> > system   x86_64, linux-gnu
> > status
> > major    2
> > minor    0.1
> > year     2004
> > month    11
> > day      15
> > language R
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>

From sfalcon at fhcrc.org  Tue May 10 20:52:02 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Tue May 10 20:52:11 2005
Subject: [Rd] bug, feature of mistery?
In-Reply-To: <20050510174535.GA21035@dss.ucsd.edu> (Giuseppe Ragusa's message
	of "Tue, 10 May 2005 10:45:35 -0700")
References: <20050510174535.GA21035@dss.ucsd.edu>
Message-ID: <m2sm0uewx9.fsf@macaroni.local>

Giuseppe Ragusa <sigmakernel@yahoo.com> writes:

> I have two machines a linux_amd64_x86 (gentoo_amd64) and a
> linux_x86. 

You might want to try running valgrind on your code on the 32bit
machine.  This may turn up a silent coding error that is manifesting
on the 64bit platform.

I think there is a new R CMD check option to do valgrind.

+ seth

From speaker at mol.mn  Wed May 11 05:40:03 2005
From: speaker at mol.mn (speaker@mol.mn)
Date: Wed May 11 05:40:12 2005
Subject: [Rd] please consider that new mail address is info@speaker.mn
	(PR#7849)
Message-ID: <20050511034003.42F5FE18C@slim.kubism.ku.dk>

please consider that new mail address is info@speaker.mn

Thank you

From ligges at statistik.uni-dortmund.de  Wed May 11 08:40:02 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed May 11 08:39:20 2005
Subject: [Rd] bug, feature of mistery?
In-Reply-To: <20050510174535.GA21035@dss.ucsd.edu>
References: <20050510174535.GA21035@dss.ucsd.edu>
Message-ID: <4281A8C2.9090707@statistik.uni-dortmund.de>

Giuseppe Ragusa wrote:

> 
> I have two machines a linux_amd64_x86 (gentoo_amd64) and a linux_x86. Both run
> R-2.1.0. I have a very long program (hopefully will become a package)
> that works perfectly on the linux_amd_x64. Great means no error, no
> problems and results that, where the analytic solution exists,
> coincide with it. I have problem making the code run on the x64 machine. I
> am baffled. The same code on the same version of R, different arch,
> is behaving differently. 
> 
> After hour of debugging, I traced down what is triggering the error on
> the x86 machine.
> 
> the code snippet is the following similar to:
> 
> R>
> g <- h(d)
> 
> f <- function( lambda )
> {
> z <- g %*% lambda
> sum( psi(z) )
> ...
> }
> 
> optim( init.value, f )
> 
> R>
> 
> The function f() is using lexical scoping to get obtain g. The
> function psi() is a call to a wrapper function that call a (.C) C
> function doing some simple calculation on z. 

- Where is *lexical* scoping involved?

- Are you really calling you code from a clean workspace?

- Why don't use pass "g" through optim() to f? Please do so, because it 
might be a scoping problem.

- The .C call in psi() should not matter unless you are doing strange 
things in the part you omitted (...).

Uwe Ligges



> What's the problem? When f() is called, g is there, lambda is there,
> but the assignment  z <- g %*% lambda results in a matrix of NaN. This
> happens from the second time f() is called, i.e. the first time f() is
> called from optim() after the C call has been made. The error is then
> that passing a NaN vector to .C results in halted execution. 
> 
> If I debug f() during the call to optim, I can without problem assign
> z the correct value, but during the execution z is matrix(NaN, nr,
> 1). 
> 
> At this point I can think of the following:
> 
> 1) the external C code has errors 
> 
> It is not a programming error, because when called from console it
>    returns the right results. Also, remember, the program work on my
>    other machine (the 64 bit);
> 
> 2) R error (I do not think so)
> 
> 3) Compiling error
> Can be the gcc is messing thing around?
> 
> on the 32bit machine
> gcc version 3.3.5  (Gentoo Linux 3.3.5-r1, ssp-3.3.2-3, pie-8.7.7.1)
> 
> on the 64-bit machine
> gcc version 3.4.3 20041125 (Gentoo Linux 3.4.3-r1, ssp-3.4.3-0, pie-8.7.7)
> 
> Any help, suggestions, thoughts?
> 
> Thank you.
> 
> Giuseppe Ragusa
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From maechler at stat.math.ethz.ch  Wed May 11 09:37:16 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed May 11 09:37:23 2005
Subject: Fwd: Re: [Rd] Implementation of the names attribute of
	attribute lists 
In-Reply-To: <5.2.1.1.0.20050510182235.02b161c0@mail.hsr.it>
References: <5.2.1.1.0.20050510182235.02b161c0@mail.hsr.it>
Message-ID: <17025.46636.751894.703421@stat.math.ethz.ch>

>>>>> "Gabriel" == Gabriel Baud-Bovy <baud-bovy.gabriel@hsr.it>
>>>>>     on Tue, 10 May 2005 19:00:53 +0200 writes:

    Gabriel> Hi Martin,
    Gabriel> Thanks for your reply. I am responding on r-devel to
    Gabriel> provide some examples of outputs of the function that
    Gabriel> I had list in the post-scriptum of my previous
    Gabriel> email (BTW, did my post went through the list? I
    Gabriel> subscribed only after mailing it).

    Gabriel> You wrote:

    >> Just to ask the obvious:
    >> 
    >> Why is using  str() not sufficient for you and instead,
    >> you use  'print.object' {not a good name, BTW, since it looks like a
    >> print() S3 method but isn't one} ?

    Gabriel> Would printObject or printSEXP a better name?

definitely better because not interfering with the S3 pseudo-OO convention...
Still not my taste though :   
      every R object is an object (:-) -- and a SEXP internally --
      and we don't use 'fooObject' for other function names even
      though their arguments are R objects....
My taste would rather lead to something like
 'displayStructure' (or 'dissectInternal' ;-) or a shorter
version of those.

    >> The very few cases I found it was insufficient,
    >> certainly  dput()  was, possibly even using it as
    >> dput(. , control = ....).

    Gabriel> As I wrote in my email, I might have reinvented
    Gabriel> the wheel. I did not know str! 

(amazingly ... ;-)

    Gabriel> The output of str and print.object is quite similar
    Gabriel> for atomic and list objects. I might look at this
    Gabriel> function to change the argument names of the
    Gabriel> print.object function.

    Gabriel> However, the output of str is quite different
    Gabriel> for language expressions and does not show as well
    Gabriel> the their list-like strcuture since it respects
    Gabriel> the superficial C-like syntax of the R language
    Gabriel> (at the textual level).

Ok, thanks for clarifying this aspect, and the difference to
both str() and dput() here.

    <.... much omitted ...>

Martin Maechler,
ETH Zurich

From ralf.seppelt at ufz.de  Wed May 11 09:56:20 2005
From: ralf.seppelt at ufz.de (Ralf Seppelt)
Date: Wed May 11 09:55:13 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
Message-ID: <4281BAA4.9000309@ufz.de>

Dear All,

we're trying to implement R on the IBM p690 cluster "Jump" at the 
research centre in J?lich, Germany (c.f. 
http://www.fz-juelich.de/nic/Supercomputer/computer-e.html)
using the most recent version of R (2.1.0) and precisly following the 
installation instructions.

After ./configure we get the final message:
----------------
R is now configured for powerpc-ibm-aix5.2.0.0

   Source directory:          .
   Installation directory:    /usr/local

   C compiler:                gcc -mno-fp-in-toc -g -O2
   C++ compiler:              g++  -g -O2
   Fortran compiler:          f77  -g

   Interfaces supported:      X11, tcltk
   External libraries:        readline, BLAS(ESSL)
   Additional capabilities:   PNG, JPEG, MBCS, NLS
   Options enabled:           R profiling

   Recommended packages:      yes

configure: WARNING: you cannot build info or html versions of the R manuals
configure: WARNING: I could not determine a browser

--------------
After make we get

ufzaloe@j36.!:
ufzaloe@j36.!: make
...
         gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall 
-Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo 
devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11  -ljpeg -lpng -lz
ld: 0711-317 ERROR: Undefined symbol: .log10
ld: 0711-317 ERROR: Undefined symbol: .floor
ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
ld: 0711-317 ERROR: Undefined symbol: .pow
ld: 0711-317 ERROR: Undefined symbol: .sin
ld: 0711-317 ERROR: Undefined symbol: .cos
ld: 0711-317 ERROR: Undefined symbol: .tan
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
information.
collect2: ld returned 8 exit status
make: 1254-004 The error code from the last command is 1.
Stop.
make: 1254-004 The error code from the last command is 2.
Stop.
make: 1254-004 The error code from the last command is 1.
Stop.
make: 1254-004 The error code from the last command is 1.
Stop.
make: 1254-004 The error code from the last command is 1.
---------------

Before bugging the administiors in J?lich, we would like to ask the R 
consortium: Are there any related experiences from people who worked on 
the implementation of R on different platforms?

Thanks for help

Ralf Seppelt & Carsten Dormann

PS: the configure log-file is attached to this mail.


-- 
Dr. Ralf Seppelt
Professor at Martin-Luther Universit?t Halle-Wittenberg
Head of Dept. for Applied Landscape Ecology
Environmental Reasearch Centre (UFZ) Leipzig Halle
fon: +49 341 235 2021, fax: -2511, url: www.ufz.de
news: www.wiley-vch.de/publish/dt/books/ISBN3-527-30732-X/


-------------- next part --------------
./configure
checking build system type... powerpc-ibm-aix5.2.0.0
checking host system type... powerpc-ibm-aix5.2.0.0
loading site script './config.site'
loading build specific script './config.site'
checking for pwd... /usr/bin/pwd
checking whether builddir is srcdir... yes
checking for working aclocal... missing
checking for working autoconf... missing
checking for working automake... missing
checking for working autoheader... missing
checking for working makeinfo... found
checking for gawk... no
checking for mawk... no
checking for nawk... nawk
checking for egrep... grep -E
checking whether ln -s works... yes
checking for ranlib... ranlib
checking for bison... bison -y
checking for ar... ar
checking for a BSD-compatible install... /usr/opt/freeware/bin/install -c
checking for javac... /usr/java14/bin/javac
checking for sed... /usr/bin/sed
checking for less... /usr/bin/less
checking for perl... /usr/bin/perl
checking whether perl version is at least 5.004... yes
checking for dvips... /usr/local/bin/dvips
checking for tex... /usr/local/bin/tex
checking for latex... /usr/local/bin/latex
checking for makeindex... /usr/local/bin/makeindex
checking for pdftex... /usr/local/bin/pdftex
checking for pdflatex... /usr/local/bin/pdflatex
checking for makeinfo... /usr/local/bin/makeinfo
checking for unzip... /usr/local/bin/unzip
checking for zip... no
checking for gzip... /usr/bin/gzip
checking for firefox... no
checking for mozilla... no
checking for netscape... no
checking for galeon... no
checking for kfmclient... no
checking for opera... no
checking for gnome-moz-remote... no
checking for open... no
configure: WARNING: I could not determine a browser
checking for acroread... /usr/local/bin/acroread
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking how to run the C preprocessor... gcc -E
checking whether gcc needs -traditional... no
checking how to run the C preprocessor... gcc -E
checking for g77... no
checking for f77... f77
checking whether we are using the GNU Fortran 77 compiler... no
checking whether f77 accepts -g... yes
checking for g++... g++
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
checking how to run the C++ preprocessor... g++ -E
checking for a sed that does not truncate output... /usr/bin/sed
checking for ld used by gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... no
checking for /usr/bin/ld option to reload object files... -r
checking for BSD-compatible nm... /usr/bin/nm -B
checking how to recognise dependent libraries... pass_all
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking dlfcn.h usability... yes
checking dlfcn.h presence... yes
checking for dlfcn.h... yes
checking the maximum length of command line arguments... 8192
checking command to parse /usr/bin/nm -B output from gcc object... ok
checking for objdir... .libs
checking for ranlib... (cached) ranlib
checking for strip... strip
checking if gcc static flag  works... yes
checking if gcc supports -fno-rtti -fno-exceptions... yes
checking for gcc option to produce PIC... 
checking if gcc supports -c -o file.o... yes
checking whether the gcc linker (/usr/bin/ld) supports shared libraries... yes
checking dynamic linker characteristics... aix5.2.0.0 ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... no
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... no
configure: creating libtool
appending configuration tag "CXX" to libtool
checking for ld used by g++... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... no
checking whether the g++ linker (/usr/bin/ld) supports shared libraries... yes
checking for g++ option to produce PIC... 
checking if g++ supports -c -o file.o... yes
checking whether the g++ linker (/usr/bin/ld) supports shared libraries... yes
checking dynamic linker characteristics... aix5.2.0.0 ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... no
appending configuration tag "F77" to libtool
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... no
checking for f77 option to produce PIC... 
checking if f77 supports -c -o file.o... no
checking whether the f77 linker (/usr/bin/ld) supports shared libraries... yes
checking dynamic linker characteristics... aix5.2.0.0 ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... no
checking whether makeinfo version is at least 4.7... no
configure: WARNING: you cannot build info or html versions of the R manuals
checking for cos in -lm... yes
checking for sin in -lm... yes
checking for dlopen in -ldl... yes
checking readline/history.h usability... no
checking readline/history.h presence... no
checking for readline/history.h... no
checking readline/readline.h usability... no
checking readline/readline.h presence... no
checking for readline/readline.h... no
checking for rl_callback_read_char in -lreadline... yes
checking for history_truncate_file... yes
checking for ANSI C header files... (cached) yes
checking whether time.h and sys/time.h may both be included... yes
checking for dirent.h that defines DIR... yes
checking for library containing opendir... none required
checking for sys/wait.h that is POSIX.1 compatible... yes
checking arpa/inet.h usability... yes
checking arpa/inet.h presence... yes
checking for arpa/inet.h... yes
checking dl.h usability... no
checking dl.h presence... no
checking for dl.h... no
checking for dlfcn.h... (cached) yes
checking elf.h usability... no
checking elf.h presence... no
checking for elf.h... no
checking fcntl.h usability... yes
checking fcntl.h presence... yes
checking for fcntl.h... yes
checking floatingpoint.h usability... no
checking floatingpoint.h presence... no
checking for floatingpoint.h... no
checking fpu_control.h usability... no
checking fpu_control.h presence... no
checking for fpu_control.h... no
checking grp.h usability... yes
checking grp.h presence... yes
checking for grp.h... yes
checking ieee754.h usability... no
checking ieee754.h presence... no
checking for ieee754.h... no
checking ieeefp.h usability... no
checking ieeefp.h presence... no
checking for ieeefp.h... no
checking limits.h usability... yes
checking limits.h presence... yes
checking for limits.h... yes
checking locale.h usability... yes
checking locale.h presence... yes
checking for locale.h... yes
checking netdb.h usability... yes
checking netdb.h presence... yes
checking for netdb.h... yes
checking netinet/in.h usability... yes
checking netinet/in.h presence... yes
checking for netinet/in.h... yes
checking pwd.h usability... yes
checking pwd.h presence... yes
checking for pwd.h... yes
checking for strings.h... (cached) yes
checking sys/param.h usability... yes
checking sys/param.h presence... yes
checking for sys/param.h... yes
checking sys/select.h usability... yes
checking sys/select.h presence... yes
checking for sys/select.h... yes
checking sys/socket.h usability... yes
checking sys/socket.h presence... yes
checking for sys/socket.h... yes
checking for sys/stat.h... (cached) yes
checking sys/time.h usability... yes
checking sys/time.h presence... yes
checking for sys/time.h... yes
checking sys/times.h usability... yes
checking sys/times.h presence... yes
checking for sys/times.h... yes
checking sys/utsname.h usability... yes
checking sys/utsname.h presence... yes
checking for sys/utsname.h... yes
checking for unistd.h... (cached) yes
checking errno.h usability... yes
checking errno.h presence... yes
checking for errno.h... yes
checking stdarg.h usability... yes
checking stdarg.h presence... yes
checking for stdarg.h... yes
checking for string.h... (cached) yes
checking whether setjmp.h is POSIX.1 compatible... yes
checking for GNU C library with version >= 2... no
checking return type of signal handlers... void
checking for pid_t... yes
checking for size_t... yes
checking whether SIZE_MAX is declared... yes
checking for blkcnt_t... yes
checking for type of socket length... socklen_t *
checking whether byte ordering is bigendian... yes
checking for an ANSI C-conforming const... yes
checking for inline... inline
checking for int... yes
checking size of int... 4
checking for long... yes
checking size of long... 4
checking for long long... yes
checking size of long long... 8
checking for long double... yes
checking size of long double... 8
checking whether we can compute C Make dependencies... no
checking whether gcc supports -c -o FILE.lo... yes
checking how to get verbose linking output from f77... -v
checking for Fortran libraries of f77...  -L/usr/local/lib -lg -lxlf90 -L/usr/lpp/xlf/lib -lxlopt -lxlf -lxlomp_ser -lm
checking how to get verbose linking output from gcc... -v
checking for C libraries of gcc...  -L/usr/local/lib -L/usr/bin/../lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209 -L/usr/bin/../lib/gcc-lib -L/usr/opt/freeware/lib -L/opt/freeware/GNUPro/lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209 -L/usr/bin/../lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209/../../.. -L/opt/freeware/GNUPro/lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209/../../.. /usr/bin/../lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209/libgcc.a -lg
checking for dummy main to link with Fortran libraries... none
checking for Fortran name-mangling scheme... lower case, no underscore, no extra underscore
checking whether f77 appends underscores to external names... no
checking whether mixed C/Fortran code can be run... yes
checking whether f77 and gcc agree on int and double... yes
checking whether f77 and gcc agree on double complex... yes
checking whether f77 supports -c -o FILE.lo... yes
checking whether g++ accepts -M for generating dependencies... yes
checking whether g++ supports -c -o FILE.lo... yes
checking whether gcc accepts -mno-fp-in-toc... yes
checking for xmkmf... /usr/bin/X11/xmkmf
checking for off_t... yes
checking for working alloca.h... yes
checking for alloca... yes
checking whether alloca is declared... yes
checking for access... yes
checking for chdir... yes
checking for expm1... yes
checking for fcntl... yes
checking for finite... yes
checking for fseeko... yes
checking for ftello... yes
checking for ftruncate... yes
checking for getcwd... yes
checking for getgrgid... yes
checking for getpwuid... yes
checking for getuid... yes
checking for hypot... yes
checking for isascii... yes
checking for log1p... yes
checking for matherr... no
checking for mkdtemp... no
checking for mkfifo... yes
checking for popen... yes
checking for putenv... yes
checking for realpath... yes
checking for rint... yes
checking for setenv... yes
checking for strcoll... yes
checking for stat... yes
checking for strptime... yes
checking for symlink... yes
checking for system... yes
checking for times... yes
checking for unsetenv... yes
checking whether isfinite is declared... no
checking whether isnan is declared... yes
checking for finite... (cached) yes
checking for isnan... yes
checking whether isfinite is declared... (cached) no
checking whether isnan is declared... (cached) yes
checking whether you have IEEE 754 floating-point arithmetic... yes
checking for nl_langinfo and CODESET... yes
checking for acosh... yes
checking for asinh... yes
checking for atanh... yes
checking for snprintf... yes
checking for strdup... yes
checking for strncasecmp... yes
checking for vsnprintf... yes
checking whether acosh is declared... yes
checking whether asinh is declared... yes
checking whether atanh is declared... yes
checking whether snprintf is declared... no
checking whether strdup is declared... yes
checking whether strncasecmp is declared... yes
checking whether vsnprintf is declared... no
checking for library containing connect... none required
checking for library containing gethostbyname... none required
checking for library containing xdr_string... none required
checking for __setfpucw... no
checking for working calloc... no
checking for working finite... yes
checking for working log... yes
checking for working log1p... yes
checking for working strptime... yes
checking whether ftell works correctly on files opened for append... yes
checking for sgemm... no
checking for ATL_xerbla in -latlas... no
checking for sgemm in -lblas... yes
checking for dgemm in -ldgemm... no
checking for sgemm in -lblas... (cached) yes
checking for sgemm in -lessl... yes
checking wchar.h usability... yes
checking wchar.h presence... yes
checking for wchar.h... yes
checking wctype.h usability... yes
checking wctype.h presence... yes
checking for wctype.h... yes
checking for mbrtowc... yes
checking for mbstowcs... yes
checking for wcrtomb... yes
checking for wcscoll... yes
checking for wcsftime... yes
checking for wcstombs... yes
checking for wcswidth... yes
checking for wctrans... yes
checking for wcwidth... yes
checking whether wcwidth is declared... yes
checking whether wcswidth is declared... yes
checking iconv.h usability... yes
checking iconv.h presence... yes
checking for iconv.h... yes
checking for iconv... in libiconv
checking whether iconv() accepts "UTF-8" and "latin1"... no
checking for iconvlist... no
checking for X... libraries , headers 
checking for gethostbyname... yes
checking for connect... yes
checking for remove... yes
checking for shmat... yes
checking for IceConnectionNumber in -lICE... yes
using X11 ... yes
checking for KeySym... yes
checking for tclConfig.sh... no
checking for tclConfig.sh in library (sub)directories... /usr/local/lib/tclConfig.sh
checking for tkConfig.sh... no
checking for tkConfig.sh in library (sub)directories... /usr/local/lib/tkConfig.sh
checking /usr/local/tcl8.4.2/include/tcl8.4/generic/tcl.h usability... no
checking /usr/local/tcl8.4.2/include/tcl8.4/generic/tcl.h presence... no
checking for /usr/local/tcl8.4.2/include/tcl8.4/generic/tcl.h... no
checking /usr/local/tcl8.4.2/include/tcl8.4/tcl.h usability... no
checking /usr/local/tcl8.4.2/include/tcl8.4/tcl.h presence... no
checking for /usr/local/tcl8.4.2/include/tcl8.4/tcl.h... no
checking /usr/local/tcl8.4.2/include/tcl.h usability... yes
checking /usr/local/tcl8.4.2/include/tcl.h presence... yes
checking for /usr/local/tcl8.4.2/include/tcl.h... yes
checking /usr/local/tcl8.4.2/include/tk8.4/generic/tk.h usability... no
checking /usr/local/tcl8.4.2/include/tk8.4/generic/tk.h presence... no
checking for /usr/local/tcl8.4.2/include/tk8.4/generic/tk.h... no
checking /usr/local/tcl8.4.2/include/tk8.4/tk.h usability... no
checking /usr/local/tcl8.4.2/include/tk8.4/tk.h presence... no
checking for /usr/local/tcl8.4.2/include/tk8.4/tk.h... no
checking /usr/local/tcl8.4.2/include/tcl8.4/tk.h usability... no
checking /usr/local/tcl8.4.2/include/tcl8.4/tk.h presence... no
checking for /usr/local/tcl8.4.2/include/tcl8.4/tk.h... no
checking /usr/local/tcl8.4.2/include/tk.h usability... yes
checking /usr/local/tcl8.4.2/include/tk.h presence... yes
checking for /usr/local/tcl8.4.2/include/tk.h... yes
checking whether compiling/linking Tcl/Tk code works... yes
checking for BSD networking... yes
checking if jpeglib version >= 6b... yes
checking for jpeg_destroy_compress in -ljpeg... yes
checking for main in -lz... yes
checking if libpng version >= 1.0.5... yes
checking for png_create_write_struct in -lpng... yes
checking rpc/types.h usability... yes
checking rpc/types.h presence... yes
checking for rpc/types.h... yes
checking for rpc/xdr.h... yes
checking for XDR support... yes
checking whether zlib support needs to be compiled... yes
checking mmap support for zlib... yes
checking whether bzip2 support needs to be compiled... yes
checking whether PCRE support needs to be compiled... yes
checking whether leap seconds are treated according to POSIX... yes
checking for setitimer... yes
checking for lpr... lpr
checking for paperconf... false
checking for recommended packages... yes
checking whether make sets $(MAKE)... yes
checking whether NLS is requested... yes
checking for msgfmt... no
checking for gmsgfmt... :
checking for xgettext... no
checking for msgmerge... no
checking for strerror in -lcposix... no
checking for signed... yes
checking for inline... inline
checking for off_t... (cached) yes
checking for long long... (cached) yes
checking for long double... yes
checking for wchar_t... yes
checking for wint_t... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for intmax_t... yes
checking whether printf() supports POSIX/XSI format strings... yes
checking for stdlib.h... (cached) yes
checking for unistd.h... (cached) yes
checking for getpagesize... yes
checking for working mmap... no
checking whether we are using the GNU C Library 2.1 or newer... no
checking whether integer division by zero raises SIGFPE... no
checking for unsigned long long... yes
checking for inttypes.h... yes
checking whether the inttypes.h PRIxNN macros are broken... no
checking for stdint.h... (cached) yes
checking for SIZE_MAX... yes
checking for stdint.h... (cached) yes
checking for ld used by GCC... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... no
checking for shared library run path origin... done
checking for ptrdiff_t... yes
checking argz.h usability... no
checking argz.h presence... no
checking for argz.h... no
checking for limits.h... (cached) yes
checking for locale.h... (cached) yes
checking nl_types.h usability... yes
checking nl_types.h presence... yes
checking for nl_types.h... yes
checking malloc.h usability... yes
checking malloc.h presence... yes
checking for malloc.h... yes
checking stddef.h usability... yes
checking stddef.h presence... yes
checking for stddef.h... yes
checking for stdlib.h... (cached) yes
checking for string.h... (cached) yes
checking for unistd.h... (cached) yes
checking for sys/param.h... (cached) yes
checking for asprintf... no
checking for fwprintf... yes
checking for getcwd... (cached) yes
checking for getegid... yes
checking for geteuid... yes
checking for getgid... yes
checking for getuid... (cached) yes
checking for mempcpy... no
checking for munmap... yes
checking for putenv... (cached) yes
checking for setenv... (cached) yes
checking for setlocale... yes
checking for snprintf... (cached) yes
checking for stpcpy... yes
checking for strcasecmp... yes
checking for strdup... (cached) yes
checking for strtoul... yes
checking for tsearch... yes
checking for wcslen... yes
checking for __argz_count... no
checking for __argz_stringify... no
checking for __argz_next... no
checking for __fsetlocking... no
checking whether _snprintf is declared... no
checking whether _snwprintf is declared... no
checking whether feof_unlocked is declared... no
checking whether fgets_unlocked is declared... no
checking whether getc_unlocked is declared... yes
checking for iconv... yes
checking for iconv declaration... 
         extern size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);
checking for nl_langinfo and CODESET... (cached) yes
checking for LC_MESSAGES... yes
checking for bison... bison
checking version of bison... 1.34, ok
checking whether NLS is requested... yes
checking whether included gettext is requested... no
checking for GNU gettext in libc... no
checking for GNU gettext in libintl... no
checking whether to use NLS... yes
checking where the gettext function comes from... included intl directory
configure: creating ./config.status
config.status: creating Makeconf
config.status: creating Makefile
config.status: creating doc/Makefile
config.status: creating doc/html/Makefile
config.status: creating doc/html/search/Makefile
config.status: creating doc/manual/Makefile
config.status: creating etc/Makefile
config.status: creating etc/Makeconf
config.status: creating etc/Renviron
config.status: creating m4/Makefile
config.status: creating po/Makefile.in
config.status: creating share/Makefile
config.status: creating src/Makefile
config.status: creating src/appl/Makefile
config.status: creating src/extra/Makefile
config.status: creating src/extra/bzip2/Makefile
config.status: creating src/extra/intl/Makefile
config.status: creating src/extra/pcre/Makefile
config.status: creating src/extra/xdr/Makefile
config.status: creating src/extra/zlib/Makefile
config.status: creating src/include/Makefile
config.status: creating src/include/Rmath.h0
config.status: creating src/include/R_ext/Makefile
config.status: creating src/library/Recommended/Makefile
config.status: creating src/library/Makefile
config.status: creating src/library/base/DESCRIPTION
config.status: creating src/library/base/Makefile
config.status: creating src/library/datasets/DESCRIPTION
config.status: creating src/library/datasets/Makefile
config.status: creating src/library/graphics/DESCRIPTION
config.status: creating src/library/graphics/Makefile
config.status: creating src/library/grDevices/DESCRIPTION
config.status: creating src/library/grDevices/Makefile
config.status: creating src/library/grDevices/src/Makefile
config.status: creating src/library/grid/DESCRIPTION
config.status: creating src/library/grid/Makefile
config.status: creating src/library/grid/src/Makefile
config.status: creating src/library/methods/DESCRIPTION
config.status: creating src/library/methods/Makefile
config.status: creating src/library/methods/src/Makefile
config.status: creating src/library/profile/Makefile
config.status: creating src/library/stats/DESCRIPTION
config.status: creating src/library/stats/Makefile
config.status: creating src/library/stats/src/Makefile
config.status: creating src/library/stats4/DESCRIPTION
config.status: creating src/library/stats4/Makefile
config.status: creating src/library/splines/DESCRIPTION
config.status: creating src/library/splines/Makefile
config.status: creating src/library/splines/src/Makefile
config.status: creating src/library/tcltk/DESCRIPTION
config.status: creating src/library/tcltk/Makefile
config.status: creating src/library/tcltk/src/Makefile
config.status: creating src/library/tools/DESCRIPTION
config.status: creating src/library/tools/Makefile
config.status: creating src/library/tools/src/Makefile
config.status: creating src/library/utils/DESCRIPTION
config.status: creating src/library/utils/Makefile
config.status: creating src/main/Makefile
config.status: creating src/modules/Makefile
config.status: creating src/modules/X11/Makefile
config.status: creating src/modules/internet/Makefile
config.status: creating src/modules/lapack/Makefile
config.status: creating src/modules/vfonts/Makefile
config.status: creating src/nmath/Makefile
config.status: creating src/nmath/standalone/Makefile
config.status: creating src/scripts/Makefile
config.status: creating src/scripts/COMPILE
config.status: creating src/scripts/INSTALL
config.status: creating src/scripts/REMOVE
config.status: creating src/scripts/R.sh
config.status: creating src/scripts/Rdconv
config.status: creating src/scripts/Rprof
config.status: creating src/scripts/SHLIB
config.status: creating src/scripts/Sd2Rd
config.status: creating src/scripts/build
config.status: creating src/scripts/check
config.status: creating src/scripts/f77
config.status: creating src/unix/Makefile
config.status: creating tests/Makefile
config.status: creating tests/Embedding/Makefile
config.status: creating tests/Examples/Makefile
config.status: creating tests/Native/Makefile
config.status: creating tools/Makefile
config.status: creating src/include/config.h
config.status: src/include/config.h is unchanged
config.status: executing default-1 commands
config.status: creating po/POTFILES
config.status: creating po/Makefile
config.status: executing stamp-h commands

R is now configured for powerpc-ibm-aix5.2.0.0

  Source directory:          .
  Installation directory:    /usr/local

  C compiler:                gcc -mno-fp-in-toc -g -O2
  C++ compiler:              g++  -g -O2
  Fortran compiler:          f77  -g

  Interfaces supported:      X11, tcltk
  External libraries:        readline, BLAS(ESSL)
  Additional capabilities:   PNG, JPEG, MBCS, NLS
  Options enabled:           R profiling

  Recommended packages:      yes

configure: WARNING: you cannot build info or html versions of the R manuals
configure: WARNING: I could not determine a browser
From ligges at statistik.uni-dortmund.de  Wed May 11 10:12:22 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed May 11 10:11:41 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <4281BAA4.9000309@ufz.de>
References: <4281BAA4.9000309@ufz.de>
Message-ID: <4281BE66.4050709@statistik.uni-dortmund.de>

Ralf Seppelt wrote:

> Dear All,
> 
> we're trying to implement R on the IBM p690 cluster "Jump" at the 
> research centre in J?lich, Germany (c.f. 
> http://www.fz-juelich.de/nic/Supercomputer/computer-e.html)
> using the most recent version of R (2.1.0) and precisly following the 
> installation instructions.


How much cpu time for further R development do we get on that machine if 
we can help? ;-)

Uwe Ligges



> After ./configure we get the final message:
> ----------------
> R is now configured for powerpc-ibm-aix5.2.0.0
> 
>   Source directory:          .
>   Installation directory:    /usr/local
> 
>   C compiler:                gcc -mno-fp-in-toc -g -O2
>   C++ compiler:              g++  -g -O2
>   Fortran compiler:          f77  -g
> 
>   Interfaces supported:      X11, tcltk
>   External libraries:        readline, BLAS(ESSL)
>   Additional capabilities:   PNG, JPEG, MBCS, NLS
>   Options enabled:           R profiling
> 
>   Recommended packages:      yes
> 
> configure: WARNING: you cannot build info or html versions of the R manuals
> configure: WARNING: I could not determine a browser
> 
> --------------
> After make we get
> 
> ufzaloe@j36.!:
> ufzaloe@j36.!: make
> ...
>         gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall 
> -Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo 
> devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11  -ljpeg -lpng -lz
> ld: 0711-317 ERROR: Undefined symbol: .log10
> ld: 0711-317 ERROR: Undefined symbol: .floor
> ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
> ld: 0711-317 ERROR: Undefined symbol: .pow
> ld: 0711-317 ERROR: Undefined symbol: .sin
> ld: 0711-317 ERROR: Undefined symbol: .cos
> ld: 0711-317 ERROR: Undefined symbol: .tan
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
> information.
> collect2: ld returned 8 exit status
> make: 1254-004 The error code from the last command is 1.
> Stop.
> make: 1254-004 The error code from the last command is 2.
> Stop.
> make: 1254-004 The error code from the last command is 1.
> Stop.
> make: 1254-004 The error code from the last command is 1.
> Stop.
> make: 1254-004 The error code from the last command is 1.
> ---------------
> 
> Before bugging the administiors in J?lich, we would like to ask the R 
> consortium: Are there any related experiences from people who worked on 
> the implementation of R on different platforms?
> 
> Thanks for help
> 
> Ralf Seppelt & Carsten Dormann
> 
> PS: the configure log-file is attached to this mail.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> ./configure
> checking build system type... powerpc-ibm-aix5.2.0.0
> checking host system type... powerpc-ibm-aix5.2.0.0
> loading site script './config.site'
> loading build specific script './config.site'
> checking for pwd... /usr/bin/pwd
> checking whether builddir is srcdir... yes
> checking for working aclocal... missing
> checking for working autoconf... missing
> checking for working automake... missing
> checking for working autoheader... missing
> checking for working makeinfo... found
> checking for gawk... no
> checking for mawk... no
> checking for nawk... nawk
> checking for egrep... grep -E
> checking whether ln -s works... yes
> checking for ranlib... ranlib
> checking for bison... bison -y
> checking for ar... ar
> checking for a BSD-compatible install... /usr/opt/freeware/bin/install -c
> checking for javac... /usr/java14/bin/javac
> checking for sed... /usr/bin/sed
> checking for less... /usr/bin/less
> checking for perl... /usr/bin/perl
> checking whether perl version is at least 5.004... yes
> checking for dvips... /usr/local/bin/dvips
> checking for tex... /usr/local/bin/tex
> checking for latex... /usr/local/bin/latex
> checking for makeindex... /usr/local/bin/makeindex
> checking for pdftex... /usr/local/bin/pdftex
> checking for pdflatex... /usr/local/bin/pdflatex
> checking for makeinfo... /usr/local/bin/makeinfo
> checking for unzip... /usr/local/bin/unzip
> checking for zip... no
> checking for gzip... /usr/bin/gzip
> checking for firefox... no
> checking for mozilla... no
> checking for netscape... no
> checking for galeon... no
> checking for kfmclient... no
> checking for opera... no
> checking for gnome-moz-remote... no
> checking for open... no
> configure: WARNING: I could not determine a browser
> checking for acroread... /usr/local/bin/acroread
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables... 
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking how to run the C preprocessor... gcc -E
> checking whether gcc needs -traditional... no
> checking how to run the C preprocessor... gcc -E
> checking for g77... no
> checking for f77... f77
> checking whether we are using the GNU Fortran 77 compiler... no
> checking whether f77 accepts -g... yes
> checking for g++... g++
> checking whether we are using the GNU C++ compiler... yes
> checking whether g++ accepts -g... yes
> checking how to run the C++ preprocessor... g++ -E
> checking for a sed that does not truncate output... /usr/bin/sed
> checking for ld used by gcc... /usr/bin/ld
> checking if the linker (/usr/bin/ld) is GNU ld... no
> checking for /usr/bin/ld option to reload object files... -r
> checking for BSD-compatible nm... /usr/bin/nm -B
> checking how to recognise dependent libraries... pass_all
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking dlfcn.h usability... yes
> checking dlfcn.h presence... yes
> checking for dlfcn.h... yes
> checking the maximum length of command line arguments... 8192
> checking command to parse /usr/bin/nm -B output from gcc object... ok
> checking for objdir... .libs
> checking for ranlib... (cached) ranlib
> checking for strip... strip
> checking if gcc static flag  works... yes
> checking if gcc supports -fno-rtti -fno-exceptions... yes
> checking for gcc option to produce PIC... 
> checking if gcc supports -c -o file.o... yes
> checking whether the gcc linker (/usr/bin/ld) supports shared libraries... yes
> checking dynamic linker characteristics... aix5.2.0.0 ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... no
> checking if libtool supports shared libraries... yes
> checking whether to build shared libraries... yes
> checking whether to build static libraries... no
> configure: creating libtool
> appending configuration tag "CXX" to libtool
> checking for ld used by g++... /usr/bin/ld
> checking if the linker (/usr/bin/ld) is GNU ld... no
> checking whether the g++ linker (/usr/bin/ld) supports shared libraries... yes
> checking for g++ option to produce PIC... 
> checking if g++ supports -c -o file.o... yes
> checking whether the g++ linker (/usr/bin/ld) supports shared libraries... yes
> checking dynamic linker characteristics... aix5.2.0.0 ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... no
> appending configuration tag "F77" to libtool
> checking if libtool supports shared libraries... yes
> checking whether to build shared libraries... yes
> checking whether to build static libraries... no
> checking for f77 option to produce PIC... 
> checking if f77 supports -c -o file.o... no
> checking whether the f77 linker (/usr/bin/ld) supports shared libraries... yes
> checking dynamic linker characteristics... aix5.2.0.0 ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... no
> checking whether makeinfo version is at least 4.7... no
> configure: WARNING: you cannot build info or html versions of the R manuals
> checking for cos in -lm... yes
> checking for sin in -lm... yes
> checking for dlopen in -ldl... yes
> checking readline/history.h usability... no
> checking readline/history.h presence... no
> checking for readline/history.h... no
> checking readline/readline.h usability... no
> checking readline/readline.h presence... no
> checking for readline/readline.h... no
> checking for rl_callback_read_char in -lreadline... yes
> checking for history_truncate_file... yes
> checking for ANSI C header files... (cached) yes
> checking whether time.h and sys/time.h may both be included... yes
> checking for dirent.h that defines DIR... yes
> checking for library containing opendir... none required
> checking for sys/wait.h that is POSIX.1 compatible... yes
> checking arpa/inet.h usability... yes
> checking arpa/inet.h presence... yes
> checking for arpa/inet.h... yes
> checking dl.h usability... no
> checking dl.h presence... no
> checking for dl.h... no
> checking for dlfcn.h... (cached) yes
> checking elf.h usability... no
> checking elf.h presence... no
> checking for elf.h... no
> checking fcntl.h usability... yes
> checking fcntl.h presence... yes
> checking for fcntl.h... yes
> checking floatingpoint.h usability... no
> checking floatingpoint.h presence... no
> checking for floatingpoint.h... no
> checking fpu_control.h usability... no
> checking fpu_control.h presence... no
> checking for fpu_control.h... no
> checking grp.h usability... yes
> checking grp.h presence... yes
> checking for grp.h... yes
> checking ieee754.h usability... no
> checking ieee754.h presence... no
> checking for ieee754.h... no
> checking ieeefp.h usability... no
> checking ieeefp.h presence... no
> checking for ieeefp.h... no
> checking limits.h usability... yes
> checking limits.h presence... yes
> checking for limits.h... yes
> checking locale.h usability... yes
> checking locale.h presence... yes
> checking for locale.h... yes
> checking netdb.h usability... yes
> checking netdb.h presence... yes
> checking for netdb.h... yes
> checking netinet/in.h usability... yes
> checking netinet/in.h presence... yes
> checking for netinet/in.h... yes
> checking pwd.h usability... yes
> checking pwd.h presence... yes
> checking for pwd.h... yes
> checking for strings.h... (cached) yes
> checking sys/param.h usability... yes
> checking sys/param.h presence... yes
> checking for sys/param.h... yes
> checking sys/select.h usability... yes
> checking sys/select.h presence... yes
> checking for sys/select.h... yes
> checking sys/socket.h usability... yes
> checking sys/socket.h presence... yes
> checking for sys/socket.h... yes
> checking for sys/stat.h... (cached) yes
> checking sys/time.h usability... yes
> checking sys/time.h presence... yes
> checking for sys/time.h... yes
> checking sys/times.h usability... yes
> checking sys/times.h presence... yes
> checking for sys/times.h... yes
> checking sys/utsname.h usability... yes
> checking sys/utsname.h presence... yes
> checking for sys/utsname.h... yes
> checking for unistd.h... (cached) yes
> checking errno.h usability... yes
> checking errno.h presence... yes
> checking for errno.h... yes
> checking stdarg.h usability... yes
> checking stdarg.h presence... yes
> checking for stdarg.h... yes
> checking for string.h... (cached) yes
> checking whether setjmp.h is POSIX.1 compatible... yes
> checking for GNU C library with version >= 2... no
> checking return type of signal handlers... void
> checking for pid_t... yes
> checking for size_t... yes
> checking whether SIZE_MAX is declared... yes
> checking for blkcnt_t... yes
> checking for type of socket length... socklen_t *
> checking whether byte ordering is bigendian... yes
> checking for an ANSI C-conforming const... yes
> checking for inline... inline
> checking for int... yes
> checking size of int... 4
> checking for long... yes
> checking size of long... 4
> checking for long long... yes
> checking size of long long... 8
> checking for long double... yes
> checking size of long double... 8
> checking whether we can compute C Make dependencies... no
> checking whether gcc supports -c -o FILE.lo... yes
> checking how to get verbose linking output from f77... -v
> checking for Fortran libraries of f77...  -L/usr/local/lib -lg -lxlf90 -L/usr/lpp/xlf/lib -lxlopt -lxlf -lxlomp_ser -lm
> checking how to get verbose linking output from gcc... -v
> checking for C libraries of gcc...  -L/usr/local/lib -L/usr/bin/../lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209 -L/usr/bin/../lib/gcc-lib -L/usr/opt/freeware/lib -L/opt/freeware/GNUPro/lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209 -L/usr/bin/../lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209/../../.. -L/opt/freeware/GNUPro/lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209/../../.. /usr/bin/../lib/gcc-lib/powerpc-ibm-aix5.1.0.0/2.9-aix51-020209/libgcc.a -lg
> checking for dummy main to link with Fortran libraries... none
> checking for Fortran name-mangling scheme... lower case, no underscore, no extra underscore
> checking whether f77 appends underscores to external names... no
> checking whether mixed C/Fortran code can be run... yes
> checking whether f77 and gcc agree on int and double... yes
> checking whether f77 and gcc agree on double complex... yes
> checking whether f77 supports -c -o FILE.lo... yes
> checking whether g++ accepts -M for generating dependencies... yes
> checking whether g++ supports -c -o FILE.lo... yes
> checking whether gcc accepts -mno-fp-in-toc... yes
> checking for xmkmf... /usr/bin/X11/xmkmf
> checking for off_t... yes
> checking for working alloca.h... yes
> checking for alloca... yes
> checking whether alloca is declared... yes
> checking for access... yes
> checking for chdir... yes
> checking for expm1... yes
> checking for fcntl... yes
> checking for finite... yes
> checking for fseeko... yes
> checking for ftello... yes
> checking for ftruncate... yes
> checking for getcwd... yes
> checking for getgrgid... yes
> checking for getpwuid... yes
> checking for getuid... yes
> checking for hypot... yes
> checking for isascii... yes
> checking for log1p... yes
> checking for matherr... no
> checking for mkdtemp... no
> checking for mkfifo... yes
> checking for popen... yes
> checking for putenv... yes
> checking for realpath... yes
> checking for rint... yes
> checking for setenv... yes
> checking for strcoll... yes
> checking for stat... yes
> checking for strptime... yes
> checking for symlink... yes
> checking for system... yes
> checking for times... yes
> checking for unsetenv... yes
> checking whether isfinite is declared... no
> checking whether isnan is declared... yes
> checking for finite... (cached) yes
> checking for isnan... yes
> checking whether isfinite is declared... (cached) no
> checking whether isnan is declared... (cached) yes
> checking whether you have IEEE 754 floating-point arithmetic... yes
> checking for nl_langinfo and CODESET... yes
> checking for acosh... yes
> checking for asinh... yes
> checking for atanh... yes
> checking for snprintf... yes
> checking for strdup... yes
> checking for strncasecmp... yes
> checking for vsnprintf... yes
> checking whether acosh is declared... yes
> checking whether asinh is declared... yes
> checking whether atanh is declared... yes
> checking whether snprintf is declared... no
> checking whether strdup is declared... yes
> checking whether strncasecmp is declared... yes
> checking whether vsnprintf is declared... no
> checking for library containing connect... none required
> checking for library containing gethostbyname... none required
> checking for library containing xdr_string... none required
> checking for __setfpucw... no
> checking for working calloc... no
> checking for working finite... yes
> checking for working log... yes
> checking for working log1p... yes
> checking for working strptime... yes
> checking whether ftell works correctly on files opened for append... yes
> checking for sgemm... no
> checking for ATL_xerbla in -latlas... no
> checking for sgemm in -lblas... yes
> checking for dgemm in -ldgemm... no
> checking for sgemm in -lblas... (cached) yes
> checking for sgemm in -lessl... yes
> checking wchar.h usability... yes
> checking wchar.h presence... yes
> checking for wchar.h... yes
> checking wctype.h usability... yes
> checking wctype.h presence... yes
> checking for wctype.h... yes
> checking for mbrtowc... yes
> checking for mbstowcs... yes
> checking for wcrtomb... yes
> checking for wcscoll... yes
> checking for wcsftime... yes
> checking for wcstombs... yes
> checking for wcswidth... yes
> checking for wctrans... yes
> checking for wcwidth... yes
> checking whether wcwidth is declared... yes
> checking whether wcswidth is declared... yes
> checking iconv.h usability... yes
> checking iconv.h presence... yes
> checking for iconv.h... yes
> checking for iconv... in libiconv
> checking whether iconv() accepts "UTF-8" and "latin1"... no
> checking for iconvlist... no
> checking for X... libraries , headers 
> checking for gethostbyname... yes
> checking for connect... yes
> checking for remove... yes
> checking for shmat... yes
> checking for IceConnectionNumber in -lICE... yes
> using X11 ... yes
> checking for KeySym... yes
> checking for tclConfig.sh... no
> checking for tclConfig.sh in library (sub)directories... /usr/local/lib/tclConfig.sh
> checking for tkConfig.sh... no
> checking for tkConfig.sh in library (sub)directories... /usr/local/lib/tkConfig.sh
> checking /usr/local/tcl8.4.2/include/tcl8.4/generic/tcl.h usability... no
> checking /usr/local/tcl8.4.2/include/tcl8.4/generic/tcl.h presence... no
> checking for /usr/local/tcl8.4.2/include/tcl8.4/generic/tcl.h... no
> checking /usr/local/tcl8.4.2/include/tcl8.4/tcl.h usability... no
> checking /usr/local/tcl8.4.2/include/tcl8.4/tcl.h presence... no
> checking for /usr/local/tcl8.4.2/include/tcl8.4/tcl.h... no
> checking /usr/local/tcl8.4.2/include/tcl.h usability... yes
> checking /usr/local/tcl8.4.2/include/tcl.h presence... yes
> checking for /usr/local/tcl8.4.2/include/tcl.h... yes
> checking /usr/local/tcl8.4.2/include/tk8.4/generic/tk.h usability... no
> checking /usr/local/tcl8.4.2/include/tk8.4/generic/tk.h presence... no
> checking for /usr/local/tcl8.4.2/include/tk8.4/generic/tk.h... no
> checking /usr/local/tcl8.4.2/include/tk8.4/tk.h usability... no
> checking /usr/local/tcl8.4.2/include/tk8.4/tk.h presence... no
> checking for /usr/local/tcl8.4.2/include/tk8.4/tk.h... no
> checking /usr/local/tcl8.4.2/include/tcl8.4/tk.h usability... no
> checking /usr/local/tcl8.4.2/include/tcl8.4/tk.h presence... no
> checking for /usr/local/tcl8.4.2/include/tcl8.4/tk.h... no
> checking /usr/local/tcl8.4.2/include/tk.h usability... yes
> checking /usr/local/tcl8.4.2/include/tk.h presence... yes
> checking for /usr/local/tcl8.4.2/include/tk.h... yes
> checking whether compiling/linking Tcl/Tk code works... yes
> checking for BSD networking... yes
> checking if jpeglib version >= 6b... yes
> checking for jpeg_destroy_compress in -ljpeg... yes
> checking for main in -lz... yes
> checking if libpng version >= 1.0.5... yes
> checking for png_create_write_struct in -lpng... yes
> checking rpc/types.h usability... yes
> checking rpc/types.h presence... yes
> checking for rpc/types.h... yes
> checking for rpc/xdr.h... yes
> checking for XDR support... yes
> checking whether zlib support needs to be compiled... yes
> checking mmap support for zlib... yes
> checking whether bzip2 support needs to be compiled... yes
> checking whether PCRE support needs to be compiled... yes
> checking whether leap seconds are treated according to POSIX... yes
> checking for setitimer... yes
> checking for lpr... lpr
> checking for paperconf... false
> checking for recommended packages... yes
> checking whether make sets $(MAKE)... yes
> checking whether NLS is requested... yes
> checking for msgfmt... no
> checking for gmsgfmt... :
> checking for xgettext... no
> checking for msgmerge... no
> checking for strerror in -lcposix... no
> checking for signed... yes
> checking for inline... inline
> checking for off_t... (cached) yes
> checking for long long... (cached) yes
> checking for long double... yes
> checking for wchar_t... yes
> checking for wint_t... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for intmax_t... yes
> checking whether printf() supports POSIX/XSI format strings... yes
> checking for stdlib.h... (cached) yes
> checking for unistd.h... (cached) yes
> checking for getpagesize... yes
> checking for working mmap... no
> checking whether we are using the GNU C Library 2.1 or newer... no
> checking whether integer division by zero raises SIGFPE... no
> checking for unsigned long long... yes
> checking for inttypes.h... yes
> checking whether the inttypes.h PRIxNN macros are broken... no
> checking for stdint.h... (cached) yes
> checking for SIZE_MAX... yes
> checking for stdint.h... (cached) yes
> checking for ld used by GCC... /usr/bin/ld
> checking if the linker (/usr/bin/ld) is GNU ld... no
> checking for shared library run path origin... done
> checking for ptrdiff_t... yes
> checking argz.h usability... no
> checking argz.h presence... no
> checking for argz.h... no
> checking for limits.h... (cached) yes
> checking for locale.h... (cached) yes
> checking nl_types.h usability... yes
> checking nl_types.h presence... yes
> checking for nl_types.h... yes
> checking malloc.h usability... yes
> checking malloc.h presence... yes
> checking for malloc.h... yes
> checking stddef.h usability... yes
> checking stddef.h presence... yes
> checking for stddef.h... yes
> checking for stdlib.h... (cached) yes
> checking for string.h... (cached) yes
> checking for unistd.h... (cached) yes
> checking for sys/param.h... (cached) yes
> checking for asprintf... no
> checking for fwprintf... yes
> checking for getcwd... (cached) yes
> checking for getegid... yes
> checking for geteuid... yes
> checking for getgid... yes
> checking for getuid... (cached) yes
> checking for mempcpy... no
> checking for munmap... yes
> checking for putenv... (cached) yes
> checking for setenv... (cached) yes
> checking for setlocale... yes
> checking for snprintf... (cached) yes
> checking for stpcpy... yes
> checking for strcasecmp... yes
> checking for strdup... (cached) yes
> checking for strtoul... yes
> checking for tsearch... yes
> checking for wcslen... yes
> checking for __argz_count... no
> checking for __argz_stringify... no
> checking for __argz_next... no
> checking for __fsetlocking... no
> checking whether _snprintf is declared... no
> checking whether _snwprintf is declared... no
> checking whether feof_unlocked is declared... no
> checking whether fgets_unlocked is declared... no
> checking whether getc_unlocked is declared... yes
> checking for iconv... yes
> checking for iconv declaration... 
>          extern size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);
> checking for nl_langinfo and CODESET... (cached) yes
> checking for LC_MESSAGES... yes
> checking for bison... bison
> checking version of bison... 1.34, ok
> checking whether NLS is requested... yes
> checking whether included gettext is requested... no
> checking for GNU gettext in libc... no
> checking for GNU gettext in libintl... no
> checking whether to use NLS... yes
> checking where the gettext function comes from... included intl directory
> configure: creating ./config.status
> config.status: creating Makeconf
> config.status: creating Makefile
> config.status: creating doc/Makefile
> config.status: creating doc/html/Makefile
> config.status: creating doc/html/search/Makefile
> config.status: creating doc/manual/Makefile
> config.status: creating etc/Makefile
> config.status: creating etc/Makeconf
> config.status: creating etc/Renviron
> config.status: creating m4/Makefile
> config.status: creating po/Makefile.in
> config.status: creating share/Makefile
> config.status: creating src/Makefile
> config.status: creating src/appl/Makefile
> config.status: creating src/extra/Makefile
> config.status: creating src/extra/bzip2/Makefile
> config.status: creating src/extra/intl/Makefile
> config.status: creating src/extra/pcre/Makefile
> config.status: creating src/extra/xdr/Makefile
> config.status: creating src/extra/zlib/Makefile
> config.status: creating src/include/Makefile
> config.status: creating src/include/Rmath.h0
> config.status: creating src/include/R_ext/Makefile
> config.status: creating src/library/Recommended/Makefile
> config.status: creating src/library/Makefile
> config.status: creating src/library/base/DESCRIPTION
> config.status: creating src/library/base/Makefile
> config.status: creating src/library/datasets/DESCRIPTION
> config.status: creating src/library/datasets/Makefile
> config.status: creating src/library/graphics/DESCRIPTION
> config.status: creating src/library/graphics/Makefile
> config.status: creating src/library/grDevices/DESCRIPTION
> config.status: creating src/library/grDevices/Makefile
> config.status: creating src/library/grDevices/src/Makefile
> config.status: creating src/library/grid/DESCRIPTION
> config.status: creating src/library/grid/Makefile
> config.status: creating src/library/grid/src/Makefile
> config.status: creating src/library/methods/DESCRIPTION
> config.status: creating src/library/methods/Makefile
> config.status: creating src/library/methods/src/Makefile
> config.status: creating src/library/profile/Makefile
> config.status: creating src/library/stats/DESCRIPTION
> config.status: creating src/library/stats/Makefile
> config.status: creating src/library/stats/src/Makefile
> config.status: creating src/library/stats4/DESCRIPTION
> config.status: creating src/library/stats4/Makefile
> config.status: creating src/library/splines/DESCRIPTION
> config.status: creating src/library/splines/Makefile
> config.status: creating src/library/splines/src/Makefile
> config.status: creating src/library/tcltk/DESCRIPTION
> config.status: creating src/library/tcltk/Makefile
> config.status: creating src/library/tcltk/src/Makefile
> config.status: creating src/library/tools/DESCRIPTION
> config.status: creating src/library/tools/Makefile
> config.status: creating src/library/tools/src/Makefile
> config.status: creating src/library/utils/DESCRIPTION
> config.status: creating src/library/utils/Makefile
> config.status: creating src/main/Makefile
> config.status: creating src/modules/Makefile
> config.status: creating src/modules/X11/Makefile
> config.status: creating src/modules/internet/Makefile
> config.status: creating src/modules/lapack/Makefile
> config.status: creating src/modules/vfonts/Makefile
> config.status: creating src/nmath/Makefile
> config.status: creating src/nmath/standalone/Makefile
> config.status: creating src/scripts/Makefile
> config.status: creating src/scripts/COMPILE
> config.status: creating src/scripts/INSTALL
> config.status: creating src/scripts/REMOVE
> config.status: creating src/scripts/R.sh
> config.status: creating src/scripts/Rdconv
> config.status: creating src/scripts/Rprof
> config.status: creating src/scripts/SHLIB
> config.status: creating src/scripts/Sd2Rd
> config.status: creating src/scripts/build
> config.status: creating src/scripts/check
> config.status: creating src/scripts/f77
> config.status: creating src/unix/Makefile
> config.status: creating tests/Makefile
> config.status: creating tests/Embedding/Makefile
> config.status: creating tests/Examples/Makefile
> config.status: creating tests/Native/Makefile
> config.status: creating tools/Makefile
> config.status: creating src/include/config.h
> config.status: src/include/config.h is unchanged
> config.status: executing default-1 commands
> config.status: creating po/POTFILES
> config.status: creating po/Makefile
> config.status: executing stamp-h commands
> 
> R is now configured for powerpc-ibm-aix5.2.0.0
> 
>   Source directory:          .
>   Installation directory:    /usr/local
> 
>   C compiler:                gcc -mno-fp-in-toc -g -O2
>   C++ compiler:              g++  -g -O2
>   Fortran compiler:          f77  -g
> 
>   Interfaces supported:      X11, tcltk
>   External libraries:        readline, BLAS(ESSL)
>   Additional capabilities:   PNG, JPEG, MBCS, NLS
>   Options enabled:           R profiling
> 
>   Recommended packages:      yes
> 
> configure: WARNING: you cannot build info or html versions of the R manuals
> configure: WARNING: I could not determine a browser
> 
> 
> ------------------------------------------------------------------------
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Wed May 11 10:28:39 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 11 10:28:47 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <4281BAA4.9000309@ufz.de>
References: <4281BAA4.9000309@ufz.de>
Message-ID: <Pine.LNX.4.61.0505110922590.12010@gannet.stats>

On Wed, 11 May 2005, Ralf Seppelt wrote:

> Dear All,
>
> we're trying to implement R on the IBM p690 cluster "Jump" at the research 
> centre in J?lich, Germany (c.f. 
> http://www.fz-juelich.de/nic/Supercomputer/computer-e.html)
> using the most recent version of R (2.1.0) and precisly following the 
> installation instructions.

I don't think there are precise installation instructions for AIX 5.2.0.
You should be aware that AIX is a very peculiar OS, and only experience 
with it is relevant.  You seem to be missing a library containing those 
.foo entry points, but this is a module and modern OSes do not require all 
symbols to satisfied in a module (nor do they require import lists).

You should also be aware that R has beta-test periods for new versions, 
and nothing was heard from any AIX user during that for 2.1.0.  So it must 
have worked smoothly for all of them (if there are any left).

>
> After ./configure we get the final message:
> ----------------
> R is now configured for powerpc-ibm-aix5.2.0.0
>
>  Source directory:          .
>  Installation directory:    /usr/local
>
>  C compiler:                gcc -mno-fp-in-toc -g -O2
>  C++ compiler:              g++  -g -O2
>  Fortran compiler:          f77  -g
>
>  Interfaces supported:      X11, tcltk
>  External libraries:        readline, BLAS(ESSL)
>  Additional capabilities:   PNG, JPEG, MBCS, NLS
>  Options enabled:           R profiling
>
>  Recommended packages:      yes
>
> configure: WARNING: you cannot build info or html versions of the R manuals
> configure: WARNING: I could not determine a browser
>
> --------------
> After make we get
>
> ufzaloe@j36.!:
> ufzaloe@j36.!: make
> ...
>        gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall 
> -Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo 
> devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11  -ljpeg -lpng -lz
> ld: 0711-317 ERROR: Undefined symbol: .log10
> ld: 0711-317 ERROR: Undefined symbol: .floor
> ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
> ld: 0711-317 ERROR: Undefined symbol: .pow
> ld: 0711-317 ERROR: Undefined symbol: .sin
> ld: 0711-317 ERROR: Undefined symbol: .cos
> ld: 0711-317 ERROR: Undefined symbol: .tan
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
> information.
> collect2: ld returned 8 exit status
> make: 1254-004 The error code from the last command is 1.
> Stop.
> make: 1254-004 The error code from the last command is 2.
> Stop.
> make: 1254-004 The error code from the last command is 1.
> Stop.
> make: 1254-004 The error code from the last command is 1.
> Stop.
> make: 1254-004 The error code from the last command is 1.
> ---------------
>
> Before bugging the administiors in J?lich, we would like to ask the R 
> consortium: Are there any related experiences from people who worked on the 
> implementation of R on different platforms?
>
> Thanks for help
>
> Ralf Seppelt & Carsten Dormann
>
> PS: the configure log-file is attached to this mail.
>
>
> -- 
> Dr. Ralf Seppelt
> Professor at Martin-Luther Universit?t Halle-Wittenberg
> Head of Dept. for Applied Landscape Ecology
> Environmental Reasearch Centre (UFZ) Leipzig Halle
> fon: +49 341 235 2021, fax: -2511, url: www.ufz.de
> news: www.wiley-vch.de/publish/dt/books/ISBN3-527-30732-X/
>
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595
From r.hankin at noc.soton.ac.uk  Wed May 11 11:45:02 2005
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Wed May 11 11:45:46 2005
Subject: [Rd] typesetting a matrix
Message-ID: <ec94153e68922aae83c1f462f9d2af52@soc.soton.ac.uk>

Hi

in a .Rd file, in a \deqn{} environment, how do I typeset a matrix in 
latex?

I have

  \deqn{\left(\begin{bmatrix}a&b\\c&d\end{bmatrix}\right)}{omitted}

but this doesn't give me the 2-by-2 matrix desired.

Is there a manpage somewhere with a matrix that I could adapt?


--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743

From stella.david at math.uni-augsburg.de  Wed May 11 12:01:04 2005
From: stella.david at math.uni-augsburg.de (stella.david@math.uni-augsburg.de)
Date: Wed May 11 12:01:11 2005
Subject: [Rd] rank (PR#7850)
Message-ID: <20050511100104.B963ADF23@slim.kubism.ku.dk>

Full_Name: Stella David
Version: 2.1.0
OS: mingw32
Submission from: (NULL) (137.250.161.136)


It seems that rank doesn't work right on vectors containing negative values.
If the negative value is the first component or there are only two components,
it works, but if the negative value is somewhere in the middle there's a
problem.

Here are my examples:
> # wrong:
> x<- c(2,-5,1,3);x
[1]  2 -5  1  3
> rank(x)
[1] 3 1 2 4
> x[rank(x)]
[1]  1  2 -5  3
> 
> # but this works:
> y<- c(-5,2,1,3);y
[1] -5  2  1  3
> rank(y)
[1] 1 3 2 4
> y[rank(y)]
[1] -5  1  2  3
> z <- c(3,-5);z
[1]  3 -5
> rank(z)
[1] 2 1
> z[rank(z)]
[1] -5  3
> 
> version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    2              
minor    1.0            
year     2005           
month    04             
day      18             
language R              

Stella David

From ripley at stats.ox.ac.uk  Wed May 11 12:32:55 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed May 11 12:33:04 2005
Subject: [Rd] rank (PR#7850)
Message-ID: <20050511103255.0E91AE143@slim.kubism.ku.dk>

You don't understand what rank() does: it is not the same as sort.list but 
rather the reverse (in the absence of ties).

>  x<- c(2,-5,1,3);x
[1]  2 -5  1  3
> y <- x
> y[rank(x)] <- x
> y
[1] -5  1  2  3

The ranks are the numbers in the ordering, and -5 is the smallest and so 
has rank 1, and so on.

Not a bug at all.

On Wed, 11 May 2005 stella.david@math.uni-augsburg.de wrote:

> Full_Name: Stella David
> Version: 2.1.0
> OS: mingw32
> Submission from: (NULL) (137.250.161.136)
>
>
> It seems that rank doesn't work right on vectors containing negative values.
> If the negative value is the first component or there are only two components,
> it works, but if the negative value is somewhere in the middle there's a
> problem.
>
> Here are my examples:
>> # wrong:
>> x<- c(2,-5,1,3);x
> [1]  2 -5  1  3
>> rank(x)
> [1] 3 1 2 4
>> x[rank(x)]
> [1]  1  2 -5  3
>>
>> # but this works:
>> y<- c(-5,2,1,3);y
> [1] -5  2  1  3
>> rank(y)
> [1] 1 3 2 4
>> y[rank(y)]
> [1] -5  1  2  3
>> z <- c(3,-5);z
> [1]  3 -5
>> rank(z)
> [1] 2 1
>> z[rank(z)]
> [1] -5  3
>>
>> version
>         _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
>
> Stella David
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From mpais at pais.co.il  Wed May 11 14:07:05 2005
From: mpais at pais.co.il (mpais@pais.co.il)
Date: Wed May 11 14:08:50 2005
Subject: [Rd] This is an alert from eSafe (PR#7851)
Message-ID: <20050511120705.D6DD9E1B4@slim.kubism.ku.dk>

Delivery Status Notification (Failure) 550 user unknown


Time: 11 May 2005 15:02:30
Scan result: Mail rejected
Protocol: SMTP in
File Name\Mail Subject: mail_1115724604: Re: Excel file
Source: r-bugs@r-project.org
Destination: k0bi@pais.co.il
Details: document_excel.pif   Infected with Win32.Netsky.d (Non-Removable), Whole File Blocked

From w.northcott at unsw.edu.au  Wed May 11 14:43:46 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Wed May 11 14:44:04 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <200505111004.j4BA31sr016854@hypatia.math.ethz.ch>
References: <200505111004.j4BA31sr016854@hypatia.math.ethz.ch>
Message-ID: <A50528B3-0599-4169-8ECE-358F1C979BD6@unsw.edu.au>

On 11/05/2005, at 8:04 PM, Ralf Seppel wrote:
> we're trying to implement R on the IBM p690 cluster "Jump" at the
> research centre in J?lich, Germany (c.f.
> http://www.fz-juelich.de/nic/Supercomputer/computer-e.html)
> using the most recent version of R (2.1.0) and precisly following the
> installation instructions.
>
> .............
> checking for cos in -lm... yes
> checking for sin in -lm... yes
> .............
> checking for GNU gettext in libc... no
> checking for GNU gettext in libintl... no
> checking whether to use NLS... yes
> checking where the gettext function comes from... included intl  
> directory
> ...............
>          gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,- 
> bexpall
> -Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo
> devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11  -ljpeg -lpng -lz
> ld: 0711-317 ERROR: Undefined symbol: .log10
> ld: 0711-317 ERROR: Undefined symbol: .floor
> ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
> ld: 0711-317 ERROR: Undefined symbol: .pow
> ld: 0711-317 ERROR: Undefined symbol: .sin
> ld: 0711-317 ERROR: Undefined symbol: .cos
> ld: 0711-317 ERROR: Undefined symbol: .tan
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> collect2: ld returned 8 exit status

There seem to be problems in the autoconf stuff.  cos and sin are  
being located in libm but the link line you show has no '-lm' which  
accounts for 6 of the 7 missing symbols.
Also gettext seems to have been located by the configure script, but  
there is no option on the link line to include it in the link. Also  
search configure.in for strings like powerpc-ibm-aix to see what  
stuff is being done
specifically for AIX.  It may be out of date in relation to your system.

If it was my problem, I would have look at those bits of the  
configure script and the sections of configure.in that generated  
them.  Then I would compare the AC_SUBST variables with the  
makefile.in that generated the link.  It seems there is some non- 
communication there.

Bill Northcott

From Kurt.Hornik at wu-wien.ac.at  Wed May 11 15:26:33 2005
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Wed May 11 15:25:40 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <A50528B3-0599-4169-8ECE-358F1C979BD6@unsw.edu.au>
References: <200505111004.j4BA31sr016854@hypatia.math.ethz.ch>
	<A50528B3-0599-4169-8ECE-358F1C979BD6@unsw.edu.au>
Message-ID: <17026.2057.639088.387478@mithrandir.hornik.net>

>>>>> Bill Northcott writes:

> On 11/05/2005, at 8:04 PM, Ralf Seppel wrote:
>> we're trying to implement R on the IBM p690 cluster "Jump" at the
>> research centre in J?lich, Germany (c.f.
>> http://www.fz-juelich.de/nic/Supercomputer/computer-e.html)
>> using the most recent version of R (2.1.0) and precisly following the
>> installation instructions.
>> 
>> .............
>> checking for cos in -lm... yes
>> checking for sin in -lm... yes
>> .............
>> checking for GNU gettext in libc... no
>> checking for GNU gettext in libintl... no
>> checking whether to use NLS... yes
>> checking where the gettext function comes from... included intl  
>> directory
>> ...............
>> gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,- 
>> bexpall
>> -Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo
>> devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11  -ljpeg -lpng -lz
>> ld: 0711-317 ERROR: Undefined symbol: .log10
>> ld: 0711-317 ERROR: Undefined symbol: .floor
>> ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
>> ld: 0711-317 ERROR: Undefined symbol: .pow
>> ld: 0711-317 ERROR: Undefined symbol: .sin
>> ld: 0711-317 ERROR: Undefined symbol: .cos
>> ld: 0711-317 ERROR: Undefined symbol: .tan
>> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
>> information.
>> collect2: ld returned 8 exit status

> There seem to be problems in the autoconf stuff.  cos and sin are
> being located in libm but the link line you show has no '-lm' which
> accounts for 6 of the 7 missing symbols.  Also gettext seems to have
> been located by the configure script, but there is no option on the
> link line to include it in the link. Also search configure.in for
> strings like powerpc-ibm-aix to see what stuff is being done
> specifically for AIX.  It may be out of date in relation to your
> system.

> If it was my problem, I would have look at those bits of the configure
> script and the sections of configure.in that generated them.  Then I
> would compare the AC_SUBST variables with the makefile.in that
> generated the link.  It seems there is some non- communication there.

Bill:

Yes most of the undefined symbols seem to come from libm.  But they
would also be in libm on all other platforms which have such, and we do
not include it there.  On Linux I get

gcc-3.4 -shared -L/usr/local/lib -o R_X11.so  dataentry.lo devX11.lo rotated.lo rbitmap.lo  -lSM -lICE -L/usr/X11R6/lib -lX11  -ljpeg -lpng -lz -L../../../lib -lR

and this works.  As Brian already wrote, we are building a *module*
here, so I assume that we are not getting the flags for building modules
right.  Assuming that libtool can, it might be helpful to look at the
output of BUILDDIR/libtool --config.

-k

From kjetil at acelerate.com  Wed May 11 20:10:00 2005
From: kjetil at acelerate.com (kjetil@acelerate.com)
Date: Wed May 11 20:10:08 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <20050511181000.99727E186@slim.kubism.ku.dk>

The following can't be right,
first rw2010:

 > 1 %% 0.001
[1] 0.001

Then rw2001:

 > 1 %% 0.001
[1] -2.081668e-17
 >

and the last seems about right.  

-- 

Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra





-- 
No virus found in this outgoing message.
Checked by AVG Anti-Virus.

From p.dalgaard at biostat.ku.dk  Wed May 11 20:28:05 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed May 11 20:28:13 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <20050511181000.99727E186@slim.kubism.ku.dk>
References: <20050511181000.99727E186@slim.kubism.ku.dk>
Message-ID: <x2ekcdpqh6.fsf@turmalin.kubism.ku.dk>

kjetil@acelerate.com writes:

> The following can't be right,
> first rw2010:
> 
>  > 1 %% 0.001
> [1] 0.001
> 
> Then rw2001:
> 
>  > 1 %% 0.001
> [1] -2.081668e-17
>  >
> 
> and the last seems about right.  

A negative remainder? I don't think so. Presumably the result comes
from

    o   %% now warns if its accuracy is likely to be affected by lack
        of precision (as in 1e18 %% 11, the unrealistic expectation of
        PR#7409), and tries harder to return a value in range when it
        is.

So, not a bug.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From keithf at amnis.com  Wed May 11 20:43:27 2005
From: keithf at amnis.com (keithf@amnis.com)
Date: Wed May 11 20:43:35 2005
Subject: [Rd] Accessing Raw Mode Vectors from .C (PR#7853)
Message-ID: <20050511184327.43A77E183@slim.kubism.ku.dk>

Full_Name: Keith Frost
Version: 2.0.0
OS: Linux i686 (RH 9)
Submission from: (NULL) (66.162.141.10)



If I create the C function:

void test_raw(unsigned char *raw, int *out)
{
  int i;
  for (i = 0; i <= 255; i++)
    out[i] = raw[i];
}

and dyn.load the resulting library, then call

.C("test_raw", as.raw(255:0), integer(256), DUP=FALSE)[[2]];

the result is 
  [1]  24   0   0 224 160 116  31   8   0 158  93   8 160 184 107   8   0   1
 [19]   0   0 111  34  41   0 255 254 253 252 251 250 249 248 247 246 245 244
 [37] 243 242 241 240 239 238 237 236 235 234 233 232 231 230 229 228 227 226
 [55] 225 224 223 222 221 220 219 218 217 216 215 214 213 212 211 210 209 208
... <10 deleted lines> ...
[253]  27  26  25  24

It appears that the C code gets a pointer which points 25 bytes before the
beginning of the raw vector data in memory.  I know that this is not documented
to work, but it would be a *very* nice feature to have, and it looks like it
*almost* works....  Hence this bug report.

From Ted.Harding at nessie.mcc.ac.uk  Wed May 11 21:24:52 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Wed May 11 21:37:32 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <x2ekcdpqh6.fsf@turmalin.kubism.ku.dk>
Message-ID: <XFMail.050511202452.Ted.Harding@nessie.mcc.ac.uk>

On 11-May-05 Peter Dalgaard wrote:
> kjetil@acelerate.com writes:
> 
>> The following can't be right,
>> first rw2010:
>> 
>>  > 1 %% 0.001
>> [1] 0.001
>> 
>> Then rw2001:
>> 
>>  > 1 %% 0.001
>> [1] -2.081668e-17
>>  >
>> 
>> and the last seems about right.  
> 
> A negative remainder? I don't think so. Presumably the result comes
> from
> 
>     o   %% now warns if its accuracy is likely to be affected by lack
>         of precision (as in 1e18 %% 11, the unrealistic expectation of
>         PR#7409), and tries harder to return a value in range when it
>         is.
> 
> So, not a bug.

Agreed! One should always be aware of such fuzzy edges in any case
where the mathematical result depends on mathematically exact
representation, as here.

In such cases what I often do is on the lines of

  ((1000*x)%%(1000*y))/1000

Using R-2.1.0beta, first of all I get the same as Kjetil:

  1 %% 0.001
  ## [1] 0.001

Secondly I get

  (1000*1)%%(1000*0.001)
  ## [1] 0

Although this trick does not guarantee the exact result, it
makes it more likely; and also, any little inexactness will
now show up more clearly since in the form

  ((BIG*x) %% (BIG*y))/BIG

the possible discrepancy before division by BIG is at most y
in magnitude. While the properties of this trick are not
entirely transparent, one can for instance compare the result
of using it with the result of not using it, and then come
to a decision as to which to use.

A further example on the same lines is

  1 %% (0.00001)
  #  [1] 1e-05

(Similar to Kjetil's first example), while

  ((1000*1) %% (1000*0.00001))/1000
  ## [1] -2.081668e-17

Any comments would be interesting!

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 11-May-05                                       Time: 20:13:22
------------------------------ XFMail ------------------------------

From Robert.McGehee at geodecapital.com  Wed May 11 22:07:20 2005
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Wed May 11 22:07:31 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C9465BE@MSGBOSCLB2WIN.DMN1.FMR.COM>

Yes, but from ?"%%":
"It is guaranteed that 'x == (x %% y) + y * (x %/% y)' (up to rounding
error) ..."

(R 2.1.0)
> x <- 1
> y <- 0.2
> x %% y
[1] 0.2
> (x %% y) + y * (x %/% y)
[1] 1.2

Certainly 1 does not equal 1.2 as the documentation would suggest, and
these seem like large enough numbers to not be effected by rounding
errors or lack of precision.

-----Original Message-----
From: Ted.Harding@nessie.mcc.ac.uk [mailto:Ted.Harding@nessie.mcc.ac.uk]

Sent: Wednesday, May 11, 2005 3:25 PM
To: Peter Dalgaard
Cc: R-bugs@biostat.ku.dk; kjetil@acelerate.com;
r-devel@stat.math.ethz.ch
Subject: Re: [Rd] bug in modulus operator %% (PR#7852)


On 11-May-05 Peter Dalgaard wrote:
> kjetil@acelerate.com writes:
> 
>> The following can't be right,
>> first rw2010:
>> 
>>  > 1 %% 0.001
>> [1] 0.001
>> 
>> Then rw2001:
>> 
>>  > 1 %% 0.001
>> [1] -2.081668e-17
>>  >
>> 
>> and the last seems about right.  
> 
> A negative remainder? I don't think so. Presumably the result comes
> from
> 
>     o   %% now warns if its accuracy is likely to be affected by lack
>         of precision (as in 1e18 %% 11, the unrealistic expectation of
>         PR#7409), and tries harder to return a value in range when it
>         is.
> 
> So, not a bug.

Agreed! One should always be aware of such fuzzy edges in any case
where the mathematical result depends on mathematically exact
representation, as here.

In such cases what I often do is on the lines of

  ((1000*x)%%(1000*y))/1000

Using R-2.1.0beta, first of all I get the same as Kjetil:

  1 %% 0.001
  ## [1] 0.001

Secondly I get

  (1000*1)%%(1000*0.001)
  ## [1] 0

Although this trick does not guarantee the exact result, it
makes it more likely; and also, any little inexactness will
now show up more clearly since in the form

  ((BIG*x) %% (BIG*y))/BIG

the possible discrepancy before division by BIG is at most y
in magnitude. While the properties of this trick are not
entirely transparent, one can for instance compare the result
of using it with the result of not using it, and then come
to a decision as to which to use.

A further example on the same lines is

  1 %% (0.00001)
  #  [1] 1e-05

(Similar to Kjetil's first example), while

  ((1000*1) %% (1000*0.00001))/1000
  ## [1] -2.081668e-17

Any comments would be interesting!

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 11-May-05                                       Time: 20:13:22
------------------------------ XFMail ------------------------------

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From Robert.McGehee at geodecapital.com  Wed May 11 22:07:36 2005
From: Robert.McGehee at geodecapital.com (Robert.McGehee@geodecapital.com)
Date: Wed May 11 22:07:47 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <20050511200736.15CF4E187@slim.kubism.ku.dk>

Yes, but from ?"%%":
"It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
rounding
error) ..."

(R 2.1.0)
> x <- 1
> y <- 0.2
> x %% y
[1] 0.2
> (x %% y) + y * (x %/% y)
[1] 1.2

Certainly 1 does not equal 1.2 as the documentation would suggest, and
these seem like large enough numbers to not be effected by rounding
errors or lack of precision.

-----Original Message-----
From: Ted.Harding@nessie.mcc.ac.uk [mailto:Ted.Harding@nessie.mcc.ac.uk]

Sent: Wednesday, May 11, 2005 3:25 PM
To: Peter Dalgaard
Cc: R-bugs@biostat.ku.dk; kjetil@acelerate.com;
r-devel@stat.math.ethz.ch
Subject: Re: [Rd] bug in modulus operator %% (PR#7852)


On 11-May-05 Peter Dalgaard wrote:
> kjetil@acelerate.com writes:
>=20
>> The following can't be right,
>> first rw2010:
>>=20
>>  > 1 %% 0.001
>> [1] 0.001
>>=20
>> Then rw2001:
>>=20
>>  > 1 %% 0.001
>> [1] -2.081668e-17
>>  >
>>=20
>> and the last seems about right. =20
>=20
> A negative remainder? I don't think so. Presumably the result comes
> from
>=20
>     o   %% now warns if its accuracy is likely to be affected by lack
>         of precision (as in 1e18 %% 11, the unrealistic expectation of
>         PR#7409), and tries harder to return a value in range when it
>         is.
>=20
> So, not a bug.

Agreed! One should always be aware of such fuzzy edges in any case
where the mathematical result depends on mathematically exact
representation, as here.

In such cases what I often do is on the lines of

  ((1000*x)%%(1000*y))/1000

Using R-2.1.0beta, first of all I get the same as Kjetil:

  1 %% 0.001
  ## [1] 0.001

Secondly I get

  (1000*1)%%(1000*0.001)
  ## [1] 0

Although this trick does not guarantee the exact result, it
makes it more likely; and also, any little inexactness will
now show up more clearly since in the form

  ((BIG*x) %% (BIG*y))/BIG

the possible discrepancy before division by BIG is at most y
in magnitude. While the properties of this trick are not
entirely transparent, one can for instance compare the result
of using it with the result of not using it, and then come
to a decision as to which to use.

A further example on the same lines is

  1 %% (0.00001)
  #  [1] 1e-05

(Similar to Kjetil's first example), while

  ((1000*1) %% (1000*0.00001))/1000
  ## [1] -2.081668e-17

Any comments would be interesting!

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 11-May-05                                       Time: 20:13:22
------------------------------ XFMail ------------------------------

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From p.dalgaard at biostat.ku.dk  Wed May 11 22:14:06 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed May 11 22:14:15 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <67DCA285A2D7754280D3B8E88EB548020C9465BE@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB548020C9465BE@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <x264xpplkh.fsf@turmalin.kubism.ku.dk>

"McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:

> Yes, but from ?"%%":
> "It is guaranteed that 'x == (x %% y) + y * (x %/% y)' (up to rounding
> error) ..."
> 
> (R 2.1.0)
> > x <- 1
> > y <- 0.2
> > x %% y
> [1] 0.2
> > (x %% y) + y * (x %/% y)
> [1] 1.2
> 
> Certainly 1 does not equal 1.2 as the documentation would suggest, and
> these seem like large enough numbers to not be effected by rounding
> errors or lack of precision.

Now that looks a bit odd, but it isn't universal:

> x <- 1
> y <- 0.2
> x %% y
[1] 0.2
> x %/% y
[1] 4
> (x %% y) + y * (x %/% y)
[1] 1

So what platform was that happening on?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Wed May 11 22:14:17 2005
From: p.dalgaard at biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed May 11 22:14:24 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <20050511201417.B44A0DC99@slim.kubism.ku.dk>

"McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:

> Yes, but from ?"%%":
> "It is guaranteed that 'x == (x %% y) + y * (x %/% y)' (up to rounding
> error) ..."
> 
> (R 2.1.0)
> > x <- 1
> > y <- 0.2
> > x %% y
> [1] 0.2
> > (x %% y) + y * (x %/% y)
> [1] 1.2
> 
> Certainly 1 does not equal 1.2 as the documentation would suggest, and
> these seem like large enough numbers to not be effected by rounding
> errors or lack of precision.

Now that looks a bit odd, but it isn't universal:

> x <- 1
> y <- 0.2
> x %% y
[1] 0.2
> x %/% y
[1] 4
> (x %% y) + y * (x %/% y)
[1] 1

So what platform was that happening on?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Robert.McGehee at geodecapital.com  Wed May 11 22:20:43 2005
From: Robert.McGehee at geodecapital.com (Robert.McGehee@geodecapital.com)
Date: Wed May 11 22:20:50 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <20050511202043.5EE3AE187@slim.kubism.ku.dk>

Yes, you are correct. I had only checked one of my platforms. Linux
works as you suggest. But for me on Windows,=20

> x <- 1
> y <- 0.2
> x %/% y
[1] 5  ## I get a 4 in Linux

version
         _             =20
platform i386-pc-mingw32
arch     i386          =20
os       mingw32       =20
system   i386, mingw32 =20
status                 =20
major    2             =20
minor    1.0           =20
year     2005          =20
month    04            =20
day      18            =20
language R             =20


-----Original Message-----
From: Peter Dalgaard [mailto:p.dalgaard@biostat.ku.dk]=20
Sent: Wednesday, May 11, 2005 4:14 PM
To: McGehee, Robert
Cc: ted.harding@nessie.mcc.ac.uk; Peter Dalgaard; R-bugs@biostat.ku.dk;
kjetil@acelerate.com; r-devel@stat.math.ethz.ch
Subject: Re: [Rd] bug in modulus operator %% (PR#7852)


"McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:

> Yes, but from ?"%%":
> "It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
rounding
> error) ..."
>=20
> (R 2.1.0)
> > x <- 1
> > y <- 0.2
> > x %% y
> [1] 0.2
> > (x %% y) + y * (x %/% y)
> [1] 1.2
>=20
> Certainly 1 does not equal 1.2 as the documentation would suggest, and
> these seem like large enough numbers to not be effected by rounding
> errors or lack of precision.

Now that looks a bit odd, but it isn't universal:

> x <- 1
> y <- 0.2
> x %% y
[1] 0.2
> x %/% y
[1] 4
> (x %% y) + y * (x %/% y)
[1] 1

So what platform was that happening on?

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Wed May 11 23:27:07 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed May 11 23:26:41 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <20050511202043.5EE3AE187@slim.kubism.ku.dk>
References: <20050511202043.5EE3AE187@slim.kubism.ku.dk>
Message-ID: <428278AB.9070903@stats.uwo.ca>

Robert.McGehee@geodecapital.com wrote:
> Yes, you are correct. I had only checked one of my platforms. Linux
> works as you suggest. But for me on Windows,=20

Certainly looks like a bug on Windows to me.  I'm going offline for a 
day very soon now, but I'll try to remember to look into it.

Duncan Murdoch

> 
> 
>>x <- 1
>>y <- 0.2
>>x %/% y
> 
> [1] 5  ## I get a 4 in Linux
> 
> version
>          _             =20
> platform i386-pc-mingw32
> arch     i386          =20
> os       mingw32       =20
> system   i386, mingw32 =20
> status                 =20
> major    2             =20
> minor    1.0           =20
> year     2005          =20
> month    04            =20
> day      18            =20
> language R             =20
> 
> 
> -----Original Message-----
> From: Peter Dalgaard [mailto:p.dalgaard@biostat.ku.dk]=20
> Sent: Wednesday, May 11, 2005 4:14 PM
> To: McGehee, Robert
> Cc: ted.harding@nessie.mcc.ac.uk; Peter Dalgaard; R-bugs@biostat.ku.dk;
> kjetil@acelerate.com; r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] bug in modulus operator %% (PR#7852)
> 
> 
> "McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:
> 
> 
>>Yes, but from ?"%%":
>>"It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
> 
> rounding
> 
>>error) ..."
>>=20
>>(R 2.1.0)
>>
>>>x <- 1
>>>y <- 0.2
>>>x %% y
>>
>>[1] 0.2
>>
>>>(x %% y) + y * (x %/% y)
>>
>>[1] 1.2
>>=20
>>Certainly 1 does not equal 1.2 as the documentation would suggest, and
>>these seem like large enough numbers to not be effected by rounding
>>errors or lack of precision.
> 
> 
> Now that looks a bit odd, but it isn't universal:
> 
> 
>>x <- 1
>>y <- 0.2
>>x %% y
> 
> [1] 0.2
> 
>>x %/% y
> 
> [1] 4
> 
>>(x %% y) + y * (x %/% y)
> 
> [1] 1
> 
> So what platform was that happening on?
> 
> --=20
>    O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From Gregor.Gorjanc at bfro.uni-lj.si  Wed May 11 23:49:39 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Wed May 11 23:49:47 2005
Subject: [Rd] Building R for windows tools link
Message-ID: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>

Hello!

I think that link to page of Duncan Murdoch (bellow) should be given

http://www.murdoch-sutherland.com/Rtools/

at 

http://developer.r-project.org/. 

It's easy to launch Google and find mentioned page, but it took me quite 
some time to do this, because I was sure, that it is noted somewhere on {www,CRAN}.r-project.org. Maybe I didn't read carefully ...

Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.

From keithf at amnis.com  Thu May 12 00:01:06 2005
From: keithf at amnis.com (keithf@amnis.com)
Date: Thu May 12 00:01:14 2005
Subject: [Rd] Patch to address (PR#7853)  -- tested briefly, seems to work
Message-ID: <20050511220106.BF734E186@slim.kubism.ku.dk>

--- dotcode.c    2004-09-05 02:31:57.000000000 -0700
+++ /usr/local/src/R-2.0.0/src/main/dotcode.c    2005-05-11 
12:24:11.000000000 -0700
@@ -190,6 +190,7 @@
 static void *RObjToCPtr(SEXP s, int naok, int dup, int narg, int Fort, 
const char *name, R_toCConverter **converter,
                           int targetType)
 {
+    unsigned char *rawptr;
     int *iptr;
     float *sptr;
     double *rptr;
@@ -228,6 +229,16 @@
     }
 
     switch(TYPEOF(s)) {
+    case RAWSXP:
+    n = LENGTH(s);
+    rawptr = RAW(s);
+    if (dup) {
+        rawptr = (unsigned char *) R_alloc(n, sizeof(unsigned char));
+        for (i = 0; i < n; i++)
+            rawptr[i] = RAW(s)[i];
+    }
+    return (void *) rawptr;
+    break;
     case LGLSXP:
     case INTSXP:
     n = LENGTH(s);
@@ -329,6 +340,7 @@
 
 static SEXP CPtrToRObj(void *p, SEXP arg, int Fort, 
R_NativePrimitiveArgType type)
 {
+    unsigned char *rawptr;
     int *iptr, n=length(arg);
     float *sptr;
     double *rptr;
@@ -339,6 +351,12 @@
     SEXP s, t;
 
     switch(type) {
+    case RAWSXP:
+    s = allocVector(type, n);
+    rawptr = (unsigned char *)p;
+    for (i = 0; i < n; i++)
+        RAW(s)[i] = rawptr[i];
+    break;
     case LGLSXP:
     case INTSXP:
     s = allocVector(type, n);

From gragusa at ucsd.edu  Thu May 12 00:33:13 2005
From: gragusa at ucsd.edu (Giuseppe Ragusa)
Date: Thu May 12 00:57:53 2005
Subject: [Rd] bug, feature of mistery?
In-Reply-To: <4281A8C2.9090707@statistik.uni-dortmund.de>
References: <20050510174535.GA21035@dss.ucsd.edu>
	<4281A8C2.9090707@statistik.uni-dortmund.de>
Message-ID: <20050511223313.GA28435@dss.ucsd.edu>


Uwe,


> - Where is *lexical* scoping involved?
Abuse of "notation". I intended to say scoping.
 > - Are you really calling you code from a clean workspace?
Yes it is clean.
> - Why don't use pass "g" through optim() to f? Please do so, because it 
> might be a scoping problem.
Tried that. Still no luck. z<- does not get assigned even if i pass g
through optim

> - The .C call in psi() should not matter unless you are doing strange 
> things in the part you omitted (...).

I do not think is the call to C. And I did not omit, psi() is the last
call. And again, same code works fine on the other machine. 



On Wed, 11 May 2005, Uwe Ligges wrote:

> Giuseppe Ragusa wrote:
> 
> >
> >I have two machines a linux_amd64_x86 (gentoo_amd64) and a linux_x86. Both 
> >run
> >R-2.1.0. I have a very long program (hopefully will become a package)
> >that works perfectly on the linux_amd_x64. Great means no error, no
> >problems and results that, where the analytic solution exists,
> >coincide with it. I have problem making the code run on the x64 machine. I
> >am baffled. The same code on the same version of R, different arch,
> >is behaving differently. 
> >
> >After hour of debugging, I traced down what is triggering the error on
> >the x86 machine.
> >
> >the code snippet is the following similar to:
> >
> >R>
> >g <- h(d)
> >
> >f <- function( lambda )
> >{
> >z <- g %*% lambda
> >sum( psi(z) )
> >...
> >}
> >
> >optim( init.value, f )
> >
> >R>
> >
> >The function f() is using lexical scoping to get obtain g. The
> >function psi() is a call to a wrapper function that call a (.C) C
> >function doing some simple calculation on z. 
> 
> - Where is *lexical* scoping involved?
> 
> - Are you really calling you code from a clean workspace?
> 
> - Why don't use pass "g" through optim() to f? Please do so, because it 
> might be a scoping problem.
> 
> - The .C call in psi() should not matter unless you are doing strange 
> things in the part you omitted (...).
> 
> Uwe Ligges
> 
> 
> 
> >What's the problem? When f() is called, g is there, lambda is there,
> >but the assignment  z <- g %*% lambda results in a matrix of NaN. This
> >happens from the second time f() is called, i.e. the first time f() is
> >called from optim() after the C call has been made. The error is then
> >that passing a NaN vector to .C results in halted execution. 
> >
> >If I debug f() during the call to optim, I can without problem assign
> >z the correct value, but during the execution z is matrix(NaN, nr,
> >1). 
> >
> >At this point I can think of the following:
> >
> >1) the external C code has errors 
> >
> >It is not a programming error, because when called from console it
> >   returns the right results. Also, remember, the program work on my
> >   other machine (the 64 bit);
> >
> >2) R error (I do not think so)
> >
> >3) Compiling error
> >Can be the gcc is messing thing around?
> >
> >on the 32bit machine
> >gcc version 3.3.5  (Gentoo Linux 3.3.5-r1, ssp-3.3.2-3, pie-8.7.7.1)
> >
> >on the 64-bit machine
> >gcc version 3.4.3 20041125 (Gentoo Linux 3.4.3-r1, ssp-3.4.3-0, pie-8.7.7)
> >
> >Any help, suggestions, thoughts?
> >
> >Thank you.
> >
> >Giuseppe Ragusa
> >
> >______________________________________________
> >R-devel@stat.math.ethz.ch mailing list
> >https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
/------------------------------------------------------------
|Giuseppe Ragusa
|University of California, San Diego
|9500 Gilman Dr. 0508
|La Jolla, CA 92093
|http://weber.ucsd.edu/~gragusa
\------------------------------------------------------------
Please avoid sending me Word or PowerPoint attachments.
See http://www.fsf.org/philosophy/no-word-attachments.html

From w.northcott at unsw.edu.au  Thu May 12 01:13:53 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Thu May 12 01:14:10 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <17026.2057.639088.387478@mithrandir.hornik.net>
References: <200505111004.j4BA31sr016854@hypatia.math.ethz.ch>
	<A50528B3-0599-4169-8ECE-358F1C979BD6@unsw.edu.au>
	<17026.2057.639088.387478@mithrandir.hornik.net>
Message-ID: <EC0D7A2E-9673-4D7B-A7EC-AEFD45F35D17@unsw.edu.au>

On 11/05/2005, at 11:26 PM, Kurt Hornik wrote:
>> There seem to be problems in the autoconf stuff.  cos and sin are
>> being located in libm but the link line you show has no '-lm' which
>> accounts for 6 of the 7 missing symbols.  Also gettext seems to have
>> been located by the configure script, but there is no option on the
>> link line to include it in the link. Also search configure.in for
>> strings like powerpc-ibm-aix to see what stuff is being done
>> specifically for AIX.  It may be out of date in relation to your
>> system.
>>
>
>
>> If it was my problem, I would have look at those bits of the  
>> configure
>> script and the sections of configure.in that generated them.  Then I
>> would compare the AC_SUBST variables with the makefile.in that
>> generated the link.  It seems there is some non- communication there.

> Yes most of the undefined symbols seem to come from libm.  But they
> would also be in libm on all other platforms which have such, and  
> we do
> not include it there.  On Linux I get
>
> gcc-3.4 -shared -L/usr/local/lib -o R_X11.so  dataentry.lo  
> devX11.lo rotated.lo rbitmap.lo  -lSM -lICE -L/usr/X11R6/lib -lX11   
> -ljpeg -lpng -lz -L../../../lib -lR

What happens on Linux is just not really relevant to what happens on  
AIX, although it might explain why the errors have not been picked  
up.  A number of platforms do not have a separate libm.  Instead they  
have a symlink to some general C library.  So typically libm is  
linked by default on these platforms.  It looks as if that is not the  
case on AIX, and that a specific -lm flag is needed.
>
> and this works.  As Brian already wrote, we are building a *module*
> here, so I assume that we are not getting the flags for building  
> modules
> right.  Assuming that libtool can, it might be helpful to look at the
> output of BUILDDIR/libtool --config.
>
The error messages are about missing symbols.

Bill

From ripley at stats.ox.ac.uk  Thu May 12 06:48:16 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu May 12 06:48:24 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <20050512044816.C3FACE182@slim.kubism.ku.dk>

On Wed, 11 May 2005 Robert.McGehee@geodecapital.com wrote:

> Yes, you are correct. I had only checked one of my platforms. Linux
> works as you suggest. But for me on Windows,
>
>> x <- 1
>> y <- 0.2
>> x %/% y
> [1] 5  ## I get a 4 in Linux

I get 5 on Windows, but

> (x %% y) + y * (x %/% y)
[1] 1

so is there a problem particular to your Windows runtime?


>
> version
>         _             =20
> platform i386-pc-mingw32
> arch     i386          =20
> os       mingw32       =20
> system   i386, mingw32 =20
> status                 =20
> major    2             =20
> minor    1.0           =20
> year     2005          =20
> month    04            =20
> day      18            =20
> language R             =20
>
>
> -----Original Message-----
> From: Peter Dalgaard [mailto:p.dalgaard@biostat.ku.dk]=20
> Sent: Wednesday, May 11, 2005 4:14 PM
> To: McGehee, Robert
> Cc: ted.harding@nessie.mcc.ac.uk; Peter Dalgaard; R-bugs@biostat.ku.dk;
> kjetil@acelerate.com; r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] bug in modulus operator %% (PR#7852)
>
>
> "McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:
>
>> Yes, but from ?"%%":
>> "It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
> rounding
>> error) ..."
>> =20
>> (R 2.1.0)
>>> x <- 1
>>> y <- 0.2
>>> x %% y
>> [1] 0.2
>>> (x %% y) + y * (x %/% y)
>> [1] 1.2
>> =20
>> Certainly 1 does not equal 1.2 as the documentation would suggest, and
>> these seem like large enough numbers to not be effected by rounding
>> errors or lack of precision.
>
> Now that looks a bit odd, but it isn't universal:
>
>> x <- 1
>> y <- 0.2
>> x %% y
> [1] 0.2
>> x %/% y
> [1] 4
>> (x %% y) + y * (x %/% y)
> [1] 1
>
> So what platform was that happening on?
>
> --=20
>   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
>  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
> (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu May 12 07:30:21 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 12 07:30:30 2005
Subject: [Rd] Building R for windows tools link
In-Reply-To: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>
Message-ID: <Pine.LNX.4.61.0505120624220.18101@gannet.stats>

On Wed, 11 May 2005, Gorjanc Gregor wrote:

> Hello!
>
> I think that link to page of Duncan Murdoch (bellow) should be given
>
> http://www.murdoch-sutherland.com/Rtools/
>
> at
>
> http://developer.r-project.org/.

Are you saying that it is given incorrectly?  I can't see it.
That site is for the development of R, not for users building R, so it 
does not seem appropriate to link from there.

> It's easy to launch Google and find mentioned page, but it took me quite
> some time to do this, because I was sure, that it is noted somewhere on {www,CRAN}.r-project.org. Maybe I didn't read carefully ...

It _is_ in the R-admin manual, the place building R for Windows is 
discussed (as from 2.1.0).  Apart from in that manual I am unaware of it 
being on the main R web sites.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From gregor.gorjanc at bfro.uni-lj.si  Thu May 12 08:25:17 2005
From: gregor.gorjanc at bfro.uni-lj.si (Gregor GORJANC)
Date: Thu May 12 08:25:30 2005
Subject: [Rd] Building R for windows tools link
In-Reply-To: <Pine.LNX.4.61.0505120624220.18101@gannet.stats>
References: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>
	<Pine.LNX.4.61.0505120624220.18101@gannet.stats>
Message-ID: <4282F6CD.7010405@bfro.uni-lj.si>

Prof Brian Ripley wrote:
> On Wed, 11 May 2005, Gorjanc Gregor wrote:
> 
>> Hello!
>>
>> I think that link to page of Duncan Murdoch (bellow) should be given
>>
>> http://www.murdoch-sutherland.com/Rtools/
>>
>> at
>>
>> http://developer.r-project.org/.
> 
> 
> Are you saying that it is given incorrectly?  I can't see it.
> That site is for the development of R, not for users building R, so it
> does not seem appropriate to link from there.
No, it isn't given incorrectly. I was surprised that it isn't there. I
agree to some point with you, but building R is probably also part of the
development.

>> It's easy to launch Google and find mentioned page, but it took me quite
>> some time to do this, because I was sure, that it is noted somewhere
>> on {www,CRAN}.r-project.org. Maybe I didn't read carefully ...
> 
> It _is_ in the R-admin manual, the place building R for Windows is
> discussed (as from 2.1.0).  Apart from in that manual I am unaware of it
> being on the main R web sites.
OK, it looks like I'll have to update a bookmark in my head.

-- 
Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.

From ripley at stats.ox.ac.uk  Thu May 12 08:32:34 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu May 12 08:32:42 2005
Subject: [Rd] Patch to address (PR#7853)  -- tested briefly, seems to
Message-ID: <20050512063234.C003AE186@slim.kubism.ku.dk>

Thank you for the patch.

To clarify: this is not a bug.  ?.C says

      The mapping of the types of R arguments to C or Fortran arguments
      in '.C' or '.Fortran' is

        R          C           Fortran
        integer    int *       integer
        numeric    double *    double precision
        - or -     float *     real
        complex    Rcomplex *  double complex
        logical    int *       integer
        character  char **     [see below]
        list       SEXP *      not allowed
        other      SEXP        not allowed

and `raw' is in the `other' category.  So this would be a change in 
behaviour and needs some changes to the documentation.  We will do that 
for 2.2.0.

Two hints (more for R-devel than just you).

1) Please provide a patch against the current sources, not 2.0.0.  (it 
worked, with a bit of fiddling).

2) Please _attach_ patches, as your mailer wrapped this one.


On Thu, 12 May 2005 keithf@amnis.com wrote:

> --- dotcode.c    2004-09-05 02:31:57.000000000 -0700
> +++ /usr/local/src/R-2.0.0/src/main/dotcode.c    2005-05-11
> 12:24:11.000000000 -0700
> @@ -190,6 +190,7 @@
> static void *RObjToCPtr(SEXP s, int naok, int dup, int narg, int Fort,
> const char *name, R_toCConverter **converter,
>                           int targetType)
> {
> +    unsigned char *rawptr;
>     int *iptr;
>     float *sptr;
>     double *rptr;
> @@ -228,6 +229,16 @@
>     }
>
>     switch(TYPEOF(s)) {
> +    case RAWSXP:
> +    n = LENGTH(s);
> +    rawptr = RAW(s);
> +    if (dup) {
> +        rawptr = (unsigned char *) R_alloc(n, sizeof(unsigned char));
> +        for (i = 0; i < n; i++)
> +            rawptr[i] = RAW(s)[i];
> +    }
> +    return (void *) rawptr;
> +    break;
>     case LGLSXP:
>     case INTSXP:
>     n = LENGTH(s);
> @@ -329,6 +340,7 @@
>
> static SEXP CPtrToRObj(void *p, SEXP arg, int Fort,
> R_NativePrimitiveArgType type)
> {
> +    unsigned char *rawptr;
>     int *iptr, n=length(arg);
>     float *sptr;
>     double *rptr;
> @@ -339,6 +351,12 @@
>     SEXP s, t;
>
>     switch(type) {
> +    case RAWSXP:
> +    s = allocVector(type, n);
> +    rawptr = (unsigned char *)p;
> +    for (i = 0; i < n; i++)
> +        RAW(s)[i] = rawptr[i];
> +    break;
>     case LGLSXP:
>     case INTSXP:
>     s = allocVector(type, n);
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu May 12 08:38:16 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 12 08:38:24 2005
Subject: [Rd] Building R for windows tools link
In-Reply-To: <4282F6CD.7010405@bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>
	<Pine.LNX.4.61.0505120624220.18101@gannet.stats>
	<4282F6CD.7010405@bfro.uni-lj.si>
Message-ID: <Pine.LNX.4.61.0505120735001.19595@gannet.stats>

On Thu, 12 May 2005, Gregor GORJANC wrote:

> Prof Brian Ripley wrote:
>> On Wed, 11 May 2005, Gorjanc Gregor wrote:
>>
>>> Hello!
>>>
>>> I think that link to page of Duncan Murdoch (bellow) should be given
>>>
>>> http://www.murdoch-sutherland.com/Rtools/
>>>
>>> at
>>>
>>> http://developer.r-project.org/.
>>
>>
>> Are you saying that it is given incorrectly?  I can't see it.
>> That site is for the development of R, not for users building R, so it
>> does not seem appropriate to link from there.
> No, it isn't given incorrectly. I was surprised that it isn't there. I
> agree to some point with you, but building R is probably also part of the
> development.

As the front page says

`This site is intended as an intermediate repository for more or less 
finalized ideas and plans for the R statistical system.'

What exactly is unclear about that?  How to build current R is not part of 
the development of R.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From timo.becker at oeaw.ac.at  Thu May 12 08:55:11 2005
From: timo.becker at oeaw.ac.at (timo.becker@oeaw.ac.at)
Date: Thu May 12 08:55:19 2005
Subject: [Rd] Windows freezes plotting large line plots (PR#7856)
Message-ID: <20050512065511.C683FE182@slim.kubism.ku.dk>

Full_Name: Timo Becker
Version: 2.1.0
OS: Windows XP
Submission from: (NULL) (193.170.87.36)


Hi!

The following command causes Windows XP to freeze so that I can only pull the
plug:
> plot(seq(1, 44100), rnorm(44100), type="l")

This does not happen with
> plot(seq(1, 44100), rnorm(44100))
and
> plot(seq(1,100), rnorm(100), type="l")

platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    2              
minor    1.0            
year     2005           
month    04             
day      18             
language R

From gregor.gorjanc at bfro.uni-lj.si  Thu May 12 09:02:38 2005
From: gregor.gorjanc at bfro.uni-lj.si (Gregor GORJANC)
Date: Thu May 12 09:02:51 2005
Subject: [Rd] Building R for windows tools link
In-Reply-To: <Pine.LNX.4.61.0505120735001.19595@gannet.stats>
References: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>
	<Pine.LNX.4.61.0505120624220.18101@gannet.stats>
	<4282F6CD.7010405@bfro.uni-lj.si>
	<Pine.LNX.4.61.0505120735001.19595@gannet.stats>
Message-ID: <4282FF8E.7050909@bfro.uni-lj.si>

Prof Brian Ripley wrote:
> On Thu, 12 May 2005, Gregor GORJANC wrote:
> 
>> Prof Brian Ripley wrote:
>>
>>> On Wed, 11 May 2005, Gorjanc Gregor wrote:
>>>
>>>> Hello!
>>>>
>>>> I think that link to page of Duncan Murdoch (bellow) should be given
>>>>
>>>> http://www.murdoch-sutherland.com/Rtools/
>>>>
>>>> at
>>>>
>>>> http://developer.r-project.org/.
>>>
>>>
>>>
>>> Are you saying that it is given incorrectly?  I can't see it.
>>> That site is for the development of R, not for users building R, so it
>>> does not seem appropriate to link from there.
>>
>> No, it isn't given incorrectly. I was surprised that it isn't there. I
>> agree to some point with you, but building R is probably also part of the
>> development.
> 
> 
> As the front page says
> 
> `This site is intended as an intermediate repository for more or less
> finalized ideas and plans for the R statistical system.'
> 
> What exactly is unclear about that?  How to build current R is not part
> of the development of R.

Nothing is unclear. I still think that building is part of the development.
I'm sure that R-devils, uups I meant R-devels, don't want to develop
something that is not buildable. Anyway, lets end with this disscussion. I
will remember that mentioned link is in R-admin manual.

-- 
Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.

From ripley at stats.ox.ac.uk  Thu May 12 09:06:09 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu May 12 09:06:17 2005
Subject: [Rd] Windows freezes plotting large line plots (PR#7856)
Message-ID: <20050512070609.8612FE182@slim.kubism.ku.dk>

This is already addressed in R-patched: we do ask you to check before 
filing a bug report so as not to waste our time.  (It was also discussed 
on R-help: see the archives.)

It is a bug *in Windows* and not one in R: nothing an application can do 
should be that fatal (and this is a perfectly legitimate Windows GDI 
call).  I trust that you will file a bug report in the correct place.

>From the CHANGES file:

   The support for mitred lines encountered a Windows problem with a
   dramatic slowdown if more than 1000 or so segments were plotted in a
   polyline.  We now plot in bunches of 1000, which is less accurate but
   works around the Windows problem.

On Thu, 12 May 2005 timo.becker@oeaw.ac.at wrote:

> Full_Name: Timo Becker
> Version: 2.1.0
> OS: Windows XP
> Submission from: (NULL) (193.170.87.36)
>
>
> Hi!
>
> The following command causes Windows XP to freeze so that I can only pull the
> plug:
>> plot(seq(1, 44100), rnorm(44100), type="l")
>
> This does not happen with
>> plot(seq(1, 44100), rnorm(44100))
> and
>> plot(seq(1,100), rnorm(100), type="l")
>
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Thu May 12 09:06:11 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May 12 09:06:18 2005
Subject: [Rd] Windows freezes plotting large line plots (PR#7856)
In-Reply-To: <20050512065511.C683FE182@slim.kubism.ku.dk>
References: <20050512065511.C683FE182@slim.kubism.ku.dk>
Message-ID: <x2wtq49b4s.fsf@turmalin.kubism.ku.dk>

timo.becker@oeaw.ac.at writes:

> The following command causes Windows XP to freeze so that I can only pull the
> plug:
> > plot(seq(1, 44100), rnorm(44100), type="l")
> 
> This does not happen with
> > plot(seq(1, 44100), rnorm(44100))
> and
> > plot(seq(1,100), rnorm(100), type="l")

This was fixed (worked around -- the bug is in Windows) once before
during "belated beta testing" of 2.1.0. Try 2.1.0 patched.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Thu May 12 09:38:40 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu May 12 09:38:48 2005
Subject: [Rd] Building R for windows tools link
In-Reply-To: <4282FF8E.7050909@bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B700F9@pollux.bfro.uni-lj.si>
	<Pine.LNX.4.61.0505120624220.18101@gannet.stats>
	<4282F6CD.7010405@bfro.uni-lj.si>
	<Pine.LNX.4.61.0505120735001.19595@gannet.stats>
	<4282FF8E.7050909@bfro.uni-lj.si>
Message-ID: <x2sm0s99mn.fsf@turmalin.kubism.ku.dk>

Gregor GORJANC <gregor.gorjanc@bfro.uni-lj.si> writes:

> > As the front page says
> > 
> > `This site is intended as an intermediate repository for more or less
> > finalized ideas and plans for the R statistical system.'
> > 
> > What exactly is unclear about that?  How to build current R is not part
> > of the development of R.
> 
> Nothing is unclear. I still think that building is part of the development.
> I'm sure that R-devils, uups I meant R-devels, don't want to develop
> something that is not buildable. Anyway, lets end with this disscussion. I
> will remember that mentioned link is in R-admin manual.

Just to be clear: The point is that the developer site was never
intended as being complete and polished, and nobody wants to commit to
making it so. It was set up for things like preliminary white papers
which were too large to handle as part of regular email traffic within
R Core, plus some items that we kept needing to remind ourselves
(and some others) about. It is open to the public, but it is not a
service. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Thu May 12 09:38:42 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 12 09:38:50 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <20050512044816.C3FACE182@slim.kubism.ku.dk>
References: <20050512044816.C3FACE182@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505120812590.22764@gannet.stats>

I've now found a Windows system that does this.  This is also Windows XP, 
fully patched, and with the same rw2010.  So it may be chip-specific: the 
one that works is a P4 and the one that does not is a latest Pentium M.

I am not sure that the guarantee on the help page has been supported for a 
while.  I've altered the code so it is more likely to be.

BTW,

> options(digits=20)
> 1 %% 0.001
[1] 0.0009999999999999792

shows why the original is not a bug in R.


On Thu, 12 May 2005 ripley@stats.ox.ac.uk wrote:

> On Wed, 11 May 2005 Robert.McGehee@geodecapital.com wrote:
>
>> Yes, you are correct. I had only checked one of my platforms. Linux
>> works as you suggest. But for me on Windows,
>>
>>> x <- 1
>>> y <- 0.2
>>> x %/% y
>> [1] 5  ## I get a 4 in Linux
>
> I get 5 on Windows, but
>
>> (x %% y) + y * (x %/% y)
> [1] 1
>
> so is there a problem particular to your Windows runtime?
>
>
>>
>> version
>>         _             =20
>> platform i386-pc-mingw32
>> arch     i386          =20
>> os       mingw32       =20
>> system   i386, mingw32 =20
>> status                 =20
>> major    2             =20
>> minor    1.0           =20
>> year     2005          =20
>> month    04            =20
>> day      18            =20
>> language R             =20
>>
>>
>> -----Original Message-----
>> From: Peter Dalgaard [mailto:p.dalgaard@biostat.ku.dk]=20
>> Sent: Wednesday, May 11, 2005 4:14 PM
>> To: McGehee, Robert
>> Cc: ted.harding@nessie.mcc.ac.uk; Peter Dalgaard; R-bugs@biostat.ku.dk;
>> kjetil@acelerate.com; r-devel@stat.math.ethz.ch
>> Subject: Re: [Rd] bug in modulus operator %% (PR#7852)
>>
>>
>> "McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:
>>
>>> Yes, but from ?"%%":
>>> "It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
>> rounding
>>> error) ..."
>>> =20
>>> (R 2.1.0)
>>>> x <- 1
>>>> y <- 0.2
>>>> x %% y
>>> [1] 0.2
>>>> (x %% y) + y * (x %/% y)
>>> [1] 1.2
>>> =20
>>> Certainly 1 does not equal 1.2 as the documentation would suggest, and
>>> these seem like large enough numbers to not be effected by rounding
>>> errors or lack of precision.
>>
>> Now that looks a bit odd, but it isn't universal:
>>
>>> x <- 1
>>> y <- 0.2
>>> x %% y
>> [1] 0.2
>>> x %/% y
>> [1] 4
>>> (x %% y) + y * (x %/% y)
>> [1] 1
>>
>> So what platform was that happening on?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Thu May 12 10:11:18 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu May 12 10:10:35 2005
Subject: [Rd] bug, feature of mistery?
In-Reply-To: <20050511223313.GA28435@dss.ucsd.edu>
References: <20050510174535.GA21035@dss.ucsd.edu>
	<4281A8C2.9090707@statistik.uni-dortmund.de>
	<20050511223313.GA28435@dss.ucsd.edu>
Message-ID: <42830FA6.4050400@statistik.uni-dortmund.de>

Giuseppe Ragusa wrote:

> Uwe,
> 
> 
> 
>>- Where is *lexical* scoping involved?
> 
> Abuse of "notation". I intended to say scoping.
>  > - Are you really calling you code from a clean workspace?
> Yes it is clean.
> 
>>- Why don't use pass "g" through optim() to f? Please do so, because it 
>>might be a scoping problem.
> 
> Tried that. Still no luck. z<- does not get assigned even if i pass g
> through optim
> 
> 
>>- The .C call in psi() should not matter unless you are doing strange 
>>things in the part you omitted (...).
> 
> 
> I do not think is the call to C. And I did not omit, psi() is the last
> call. And again, same code works fine on the other machine. 

Can you send me a reproducible example (off list), please (inlcuding 
example data)?

Uwe


> 
> 
> On Wed, 11 May 2005, Uwe Ligges wrote:
> 
> 
>>Giuseppe Ragusa wrote:
>>
>>
>>>I have two machines a linux_amd64_x86 (gentoo_amd64) and a linux_x86. Both 
>>>run
>>>R-2.1.0. I have a very long program (hopefully will become a package)
>>>that works perfectly on the linux_amd_x64. Great means no error, no
>>>problems and results that, where the analytic solution exists,
>>>coincide with it. I have problem making the code run on the x64 machine. I
>>>am baffled. The same code on the same version of R, different arch,
>>>is behaving differently. 
>>>
>>>After hour of debugging, I traced down what is triggering the error on
>>>the x86 machine.
>>>
>>>the code snippet is the following similar to:
>>>
>>>R>
>>>g <- h(d)
>>>
>>>f <- function( lambda )
>>>{
>>>z <- g %*% lambda
>>>sum( psi(z) )
>>>...
>>>}
>>>
>>>optim( init.value, f )
>>>
>>>R>
>>>
>>>The function f() is using lexical scoping to get obtain g. The
>>>function psi() is a call to a wrapper function that call a (.C) C
>>>function doing some simple calculation on z. 
>>
>>- Where is *lexical* scoping involved?
>>
>>- Are you really calling you code from a clean workspace?
>>
>>- Why don't use pass "g" through optim() to f? Please do so, because it 
>>might be a scoping problem.
>>
>>- The .C call in psi() should not matter unless you are doing strange 
>>things in the part you omitted (...).
>>
>>Uwe Ligges
>>
>>
>>
>>
>>>What's the problem? When f() is called, g is there, lambda is there,
>>>but the assignment  z <- g %*% lambda results in a matrix of NaN. This
>>>happens from the second time f() is called, i.e. the first time f() is
>>>called from optim() after the C call has been made. The error is then
>>>that passing a NaN vector to .C results in halted execution. 
>>>
>>>If I debug f() during the call to optim, I can without problem assign
>>>z the correct value, but during the execution z is matrix(NaN, nr,
>>>1). 
>>>
>>>At this point I can think of the following:
>>>
>>>1) the external C code has errors 
>>>
>>>It is not a programming error, because when called from console it
>>>  returns the right results. Also, remember, the program work on my
>>>  other machine (the 64 bit);
>>>
>>>2) R error (I do not think so)
>>>
>>>3) Compiling error
>>>Can be the gcc is messing thing around?
>>>
>>>on the 32bit machine
>>>gcc version 3.3.5  (Gentoo Linux 3.3.5-r1, ssp-3.3.2-3, pie-8.7.7.1)
>>>
>>>on the 64-bit machine
>>>gcc version 3.4.3 20041125 (Gentoo Linux 3.4.3-r1, ssp-3.4.3-0, pie-8.7.7)
>>>
>>>Any help, suggestions, thoughts?
>>>
>>>Thank you.
>>>
>>>Giuseppe Ragusa
>>>
>>>______________________________________________
>>>R-devel@stat.math.ethz.ch mailing list
>>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From Ted.Harding at nessie.mcc.ac.uk  Thu May 12 13:00:12 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Thu May 12 13:18:47 2005
Subject: [Rd] Windows freezes plotting large line plots (PR#7856)
In-Reply-To: <20050512070609.8612FE182@slim.kubism.ku.dk>
Message-ID: <XFMail.050512120012.Ted.Harding@nessie.mcc.ac.uk>

On 12-May-05 ripley@stats.ox.ac.uk wrote:
> This is already addressed in R-patched: we do ask you to check
> before filing a bug report so as not to waste our time.
>  (It was also discussed on R-help: see the archives.)
> 
> It is a bug *in Windows* and not one in R: nothing an application
> can do should be that fatal (and this is a perfectly legitimate
> Windows GDI call).  I trust that you will file a bug report in the
> correct place.
> 
>>From the CHANGES file:
> 
>    The support for mitred lines encountered a Windows problem
>    with a dramatic slowdown if more than 1000 or so segments
>    were plotted in a polyline.  We now plot in bunches of 1000,
>    which is less accurate but  works around the Windows problem.

Clearly a neccessary change, even though it is less accurate.
But does this change apply only to Windows compilations (i.e.
conditional compilation), or will we all have to put up with it?

Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 12-May-05                                       Time: 08:26:43
------------------------------ XFMail ------------------------------

From ripley at stats.ox.ac.uk  Thu May 12 13:24:17 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 12 13:24:27 2005
Subject: [Rd] Windows freezes plotting large line plots (PR#7856)
In-Reply-To: <XFMail.050512120012.Ted.Harding@nessie.mcc.ac.uk>
References: <XFMail.050512120012.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <Pine.LNX.4.61.0505121223270.29218@gannet.stats>

On Thu, 12 May 2005 Ted.Harding@nessie.mcc.ac.uk wrote:

> On 12-May-05 ripley@stats.ox.ac.uk wrote:
>> This is already addressed in R-patched: we do ask you to check
>> before filing a bug report so as not to waste our time.
>>  (It was also discussed on R-help: see the archives.)
>>
>> It is a bug *in Windows* and not one in R: nothing an application
>> can do should be that fatal (and this is a perfectly legitimate
>> Windows GDI call).  I trust that you will file a bug report in the
>> correct place.
>>
>>> From the CHANGES file:
>>
>>    The support for mitred lines encountered a Windows problem
>>    with a dramatic slowdown if more than 1000 or so segments
>>    were plotted in a polyline.  We now plot in bunches of 1000,
>>    which is less accurate but  works around the Windows problem.
>
> Clearly a neccessary change, even though it is less accurate.
> But does this change apply only to Windows compilations (i.e.
> conditional compilation), or will we all have to put up with it?

It applies only to the windows() device (including win.metafile etc).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Robert.McGehee at geodecapital.com  Thu May 12 14:41:50 2005
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Thu May 12 14:42:01 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C9465BF@MSGBOSCLB2WIN.DMN1.FMR.COM>

Could very easily be chipset, but I'm actually running a Pentium 4
myself. Pentium 4 1.9GHz, on a Windows XP Professional Version 2002
Service Professional, Service Pack 1. 

Also of interest,
> 1 %% 0.2
[1] 0.2
> 1 %% 0.25
[1] 0



-----Original Message-----
From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
Sent: Thursday, May 12, 2005 3:39 AM
To: r-devel@stat.math.ethz.ch
Subject: RE: [Rd] bug in modulus operator %% (PR#7852)


I've now found a Windows system that does this.  This is also Windows
XP, 
fully patched, and with the same rw2010.  So it may be chip-specific:
the 
one that works is a P4 and the one that does not is a latest Pentium M.

I am not sure that the guarantee on the help page has been supported for
a 
while.  I've altered the code so it is more likely to be.

BTW,

> options(digits=20)
> 1 %% 0.001
[1] 0.0009999999999999792

shows why the original is not a bug in R.


On Thu, 12 May 2005 ripley@stats.ox.ac.uk wrote:

> On Wed, 11 May 2005 Robert.McGehee@geodecapital.com wrote:
>
>> Yes, you are correct. I had only checked one of my platforms. Linux
>> works as you suggest. But for me on Windows,
>>
>>> x <- 1
>>> y <- 0.2
>>> x %/% y
>> [1] 5  ## I get a 4 in Linux
>
> I get 5 on Windows, but
>
>> (x %% y) + y * (x %/% y)
> [1] 1
>
> so is there a problem particular to your Windows runtime?
>
>
>>
>> version
>>         _             =20
>> platform i386-pc-mingw32
>> arch     i386          =20
>> os       mingw32       =20
>> system   i386, mingw32 =20
>> status                 =20
>> major    2             =20
>> minor    1.0           =20
>> year     2005          =20
>> month    04            =20
>> day      18            =20
>> language R             =20
>>
>>
>> -----Original Message-----
>> From: Peter Dalgaard [mailto:p.dalgaard@biostat.ku.dk]=20
>> Sent: Wednesday, May 11, 2005 4:14 PM
>> To: McGehee, Robert
>> Cc: ted.harding@nessie.mcc.ac.uk; Peter Dalgaard;
R-bugs@biostat.ku.dk;
>> kjetil@acelerate.com; r-devel@stat.math.ethz.ch
>> Subject: Re: [Rd] bug in modulus operator %% (PR#7852)
>>
>>
>> "McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:
>>
>>> Yes, but from ?"%%":
>>> "It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
>> rounding
>>> error) ..."
>>> =20
>>> (R 2.1.0)
>>>> x <- 1
>>>> y <- 0.2
>>>> x %% y
>>> [1] 0.2
>>>> (x %% y) + y * (x %/% y)
>>> [1] 1.2
>>> =20
>>> Certainly 1 does not equal 1.2 as the documentation would suggest,
and
>>> these seem like large enough numbers to not be effected by rounding
>>> errors or lack of precision.
>>
>> Now that looks a bit odd, but it isn't universal:
>>
>>> x <- 1
>>> y <- 0.2
>>> x %% y
>> [1] 0.2
>>> x %/% y
>> [1] 4
>>> (x %% y) + y * (x %/% y)
>> [1] 1
>>
>> So what platform was that happening on?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From kjetil at acelerate.com  Thu May 12 15:14:00 2005
From: kjetil at acelerate.com (Kjetil Brinchmann Halvorsen)
Date: Thu May 12 15:15:51 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <Pine.LNX.4.61.0505120812590.22764@gannet.stats>
References: <20050512044816.C3FACE182@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505120812590.22764@gannet.stats>
Message-ID: <42835698.6070505@acelerate.com>

Prof Brian Ripley wrote:

> I've now found a Windows system that does this.  This is also Windows 
> XP, fully patched, and with the same rw2010.  So it may be 
> chip-specific: the one that works is a P4 and the one that does not is 
> a latest Pentium M.
>
> I am not sure that the guarantee on the help page has been supported 
> for a while.  I've altered the code so it is more likely to be.
>
> BTW,
>
>> options(digits=20)
>> 1 %% 0.001
>
> [1] 0.0009999999999999792
>
> shows why the original is not a bug in R.
>
Why is that not a bug in R? On my machine (windows XP, rw2010 from CRAN) 
I get:

test <- function(x, y) (x %% y) + y * ( x %/% y ) # should be x
 > test(1, 0.001)
[1] 1.001
 > test(1, 0.1)
[1] 1.1
 > test(1, 1)
[1] 1
 > test(1, 0.01)
[1] 1.01

and this differences (well, not the third one) cannot be said to be 
rounding
error.

Kjetil

>
> On Thu, 12 May 2005 ripley@stats.ox.ac.uk wrote:
>
>> On Wed, 11 May 2005 Robert.McGehee@geodecapital.com wrote:
>>
>>> Yes, you are correct. I had only checked one of my platforms. Linux
>>> works as you suggest. But for me on Windows,
>>>
>>>> x <- 1
>>>> y <- 0.2
>>>> x %/% y
>>>
>>> [1] 5  ## I get a 4 in Linux
>>
>>
>> I get 5 on Windows, but
>>
>>> (x %% y) + y * (x %/% y)
>>
>> [1] 1
>>
>> so is there a problem particular to your Windows runtime?
>>
>>
>>>
>>> version
>>>         _             =20
>>> platform i386-pc-mingw32
>>> arch     i386          =20
>>> os       mingw32       =20
>>> system   i386, mingw32 =20
>>> status                 =20
>>> major    2             =20
>>> minor    1.0           =20
>>> year     2005          =20
>>> month    04            =20
>>> day      18            =20
>>> language R             =20
>>>
>>>
>>> -----Original Message-----
>>> From: Peter Dalgaard [mailto:p.dalgaard@biostat.ku.dk]=20
>>> Sent: Wednesday, May 11, 2005 4:14 PM
>>> To: McGehee, Robert
>>> Cc: ted.harding@nessie.mcc.ac.uk; Peter Dalgaard; R-bugs@biostat.ku.dk;
>>> kjetil@acelerate.com; r-devel@stat.math.ethz.ch
>>> Subject: Re: [Rd] bug in modulus operator %% (PR#7852)
>>>
>>>
>>> "McGehee, Robert" <Robert.McGehee@geodecapital.com> writes:
>>>
>>>> Yes, but from ?"%%":
>>>> "It is guaranteed that 'x =3D=3D (x %% y) + y * (x %/% y)' (up to =
>>>
>>> rounding
>>>
>>>> error) ..."
>>>> =20
>>>> (R 2.1.0)
>>>>
>>>>> x <- 1
>>>>> y <- 0.2
>>>>> x %% y
>>>>
>>>> [1] 0.2
>>>>
>>>>> (x %% y) + y * (x %/% y)
>>>>
>>>> [1] 1.2
>>>> =20
>>>> Certainly 1 does not equal 1.2 as the documentation would suggest, and
>>>> these seem like large enough numbers to not be effected by rounding
>>>> errors or lack of precision.
>>>
>>>
>>> Now that looks a bit odd, but it isn't universal:
>>>
>>>> x <- 1
>>>> y <- 0.2
>>>> x %% y
>>>
>>> [1] 0.2
>>>
>>>> x %/% y
>>>
>>> [1] 4
>>>
>>>> (x %% y) + y * (x %/% y)
>>>
>>> [1] 1
>>>
>>> So what platform was that happening on?
>>
>
>


-- 

Kjetil Halvorsen.

Peace is the most effective weapon of mass construction.
               --  Mahdi Elmandjra




-- 
No virus found in this outgoing message.
Checked by AVG Anti-Virus.

From m.e.bruche at lse.ac.uk  Thu May 12 16:44:28 2005
From: m.e.bruche at lse.ac.uk (m.e.bruche@lse.ac.uk)
Date: Thu May 12 16:44:37 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <20050512144428.EBC91E180@slim.kubism.ku.dk>

Full_Name: Max
Version: R 2.0.1 (2004-11-15)
OS: Gentoo Linux
Submission from: (NULL) (158.143.49.181)


I leaned on the "(" key by accident, and it looks as if R segfaults on a large
number (88 or more in my case) open brackets:

Script started on Thu May 12 15:18:04 2005
$ R

R : Copyright 2004, The R Foundation for Statistical Computing
Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
(((((((((
+ (
Segmentation fault
$ uname -a
Linux max 2.6.11-gentoo-r6 #2 Sat May 7 19:24:52 GMT 2005 i686 Intel(R)
Pentium(R) 4 CPU 2.40GHz GenuineIntel GNU/Linux
$ exit

Script done on Thu May 12 15:18:16 2005

Regards,

Max

R compiled with
gcc 3.3.5
glibc-2.3.4

From ripley at stats.ox.ac.uk  Thu May 12 17:09:11 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 12 17:09:21 2005
Subject: [Rd] bug in modulus operator %% (PR#7852)
In-Reply-To: <42835698.6070505@acelerate.com>
References: <20050512044816.C3FACE182@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505120812590.22764@gannet.stats>
	<42835698.6070505@acelerate.com>
Message-ID: <Pine.LNX.4.61.0505121605440.31239@gannet.stats>

On Thu, 12 May 2005, Kjetil Brinchmann Halvorsen wrote:

> Prof Brian Ripley wrote:
>
>> I've now found a Windows system that does this.  This is also Windows XP, 
>> fully patched, and with the same rw2010.  So it may be chip-specific: the 
>> one that works is a P4 and the one that does not is a latest Pentium M.
>> 
>> I am not sure that the guarantee on the help page has been supported for a 
>> while.  I've altered the code so it is more likely to be.
>> 
>> BTW,
>> 
>>> options(digits=20)
>>> 1 %% 0.001
>> 
>> [1] 0.0009999999999999792
>> 
>> shows why the original is not a bug in R.
>> 
> Why is that not a bug in R? On my machine (windows XP, rw2010 from CRAN) I

Because 0 <= y %% x < y, so that adding any multiple of 0.001 takes it out 
of range.

> get:
>
> test <- function(x, y) (x %% y) + y * ( x %/% y ) # should be x
>> test(1, 0.001)
> [1] 1.001
>> test(1, 0.1)
> [1] 1.1
>> test(1, 1)
> [1] 1
>> test(1, 0.01)
> [1] 1.01
>
> and this differences (well, not the third one) cannot be said to be rounding
> error.

I think they can.  The problem is that x %/% y is affected by rounding 
error in the representation of 0.01, as in

> 1 %/% 0.01
[1] 99

on my machine.  That is due to rounding error.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From andy_liaw at merck.com  Thu May 12 18:31:40 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu May 12 18:32:23 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E820@usctmx1106.merck.com>

I believe that's been fixed in R-2.1.0.  Please check.

I got the same segfault with R-2.0.1 on SuSE Linux x86_64, but on both that
machine and my WinXP latop, I get syntax error.  E.g.,

R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0 Patched (2005-05-12), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
+ (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
Error: syntax error

Andy


> From: m.e.bruche@lse.ac.uk
> 
> Full_Name: Max
> Version: R 2.0.1 (2004-11-15)
> OS: Gentoo Linux
> Submission from: (NULL) (158.143.49.181)
> 
> 
> I leaned on the "(" key by accident, and it looks as if R 
> segfaults on a large
> number (88 or more in my case) open brackets:
> 
> Script started on Thu May 12 15:18:04 2005
> $ R
> 
> R : Copyright 2004, The R Foundation for Statistical Computing
> Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
> 
> > 
> ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> ((((((((((((((((
> (((((((((
> + (
> Segmentation fault
> $ uname -a
> Linux max 2.6.11-gentoo-r6 #2 Sat May 7 19:24:52 GMT 2005 
> i686 Intel(R)
> Pentium(R) 4 CPU 2.40GHz GenuineIntel GNU/Linux
> $ exit
> 
> Script done on Thu May 12 15:18:16 2005
> 
> Regards,
> 
> Max
> 
> R compiled with
> gcc 3.3.5
> glibc-2.3.4
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From andy_liaw at merck.com  Thu May 12 18:32:37 2005
From: andy_liaw at merck.com (andy_liaw@merck.com)
Date: Thu May 12 18:32:45 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <20050512163237.DFEADE180@slim.kubism.ku.dk>

I believe that's been fixed in R-2.1.0.  Please check.

I got the same segfault with R-2.0.1 on SuSE Linux x86_64, but on both that
machine and my WinXP latop, I get syntax error.  E.g.,

R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0 Patched (2005-05-12), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
+ (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
Error: syntax error

Andy


> From: m.e.bruche@lse.ac.uk
> 
> Full_Name: Max
> Version: R 2.0.1 (2004-11-15)
> OS: Gentoo Linux
> Submission from: (NULL) (158.143.49.181)
> 
> 
> I leaned on the "(" key by accident, and it looks as if R 
> segfaults on a large
> number (88 or more in my case) open brackets:
> 
> Script started on Thu May 12 15:18:04 2005
> $ R
> 
> R : Copyright 2004, The R Foundation for Statistical Computing
> Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
> 
> > 
> ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> ((((((((((((((((
> (((((((((
> + (
> Segmentation fault
> $ uname -a
> Linux max 2.6.11-gentoo-r6 #2 Sat May 7 19:24:52 GMT 2005 
> i686 Intel(R)
> Pentium(R) 4 CPU 2.40GHz GenuineIntel GNU/Linux
> $ exit
> 
> Script done on Thu May 12 15:18:16 2005
> 
> Regards,
> 
> Max
> 
> R compiled with
> gcc 3.3.5
> glibc-2.3.4
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From ligges at statistik.uni-dortmund.de  Thu May 12 18:46:39 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Thu May 12 18:46:47 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <20050512164639.2CFADE17A@slim.kubism.ku.dk>

Liaw, Andy wrote:

> I believe that's been fixed in R-2.1.0.  Please check.
> 
> I got the same segfault with R-2.0.1 on SuSE Linux x86_64, but on both that
> machine and my WinXP latop, I get syntax error.  E.g.,
> 
> R : Copyright 2005, The R Foundation for Statistical Computing
> Version 2.1.0 Patched (2005-05-12), ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
> 
> 
>>(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> 
> + (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> Error: syntax error


With R-2.1.0 (release!) I get syntax error on Windows, no error (at 
least not after the first couple of hundred openings) on Linux, but the 
described *segfault* on Solaris 5.7 (UltraSparc).
[I am too lazy to try out R-patched on the slowish Solaris machine yet]

Uwe Ligges


> Andy
> 
> 
> 
>>From: m.e.bruche@lse.ac.uk
>>
>>Full_Name: Max
>>Version: R 2.0.1 (2004-11-15)
>>OS: Gentoo Linux
>>Submission from: (NULL) (158.143.49.181)
>>
>>
>>I leaned on the "(" key by accident, and it looks as if R 
>>segfaults on a large
>>number (88 or more in my case) open brackets:
>>
>>Script started on Thu May 12 15:18:04 2005
>>$ R
>>
>>R : Copyright 2004, The R Foundation for Statistical Computing
>>Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
>>
>>R is free software and comes with ABSOLUTELY NO WARRANTY.
>>You are welcome to redistribute it under certain conditions.
>>Type 'license()' or 'licence()' for distribution details.
>>
>>R is a collaborative project with many contributors.
>>Type 'contributors()' for more information and
>>'citation()' on how to cite R or R packages in publications.
>>
>>Type 'demo()' for some demos, 'help()' for on-line help, or
>>'help.start()' for a HTML browser interface to help.
>>Type 'q()' to quit R.
>>
>>
>>((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
>>((((((((((((((((
>>(((((((((
>>+ (
>>Segmentation fault
>>$ uname -a
>>Linux max 2.6.11-gentoo-r6 #2 Sat May 7 19:24:52 GMT 2005 
>>i686 Intel(R)
>>Pentium(R) 4 CPU 2.40GHz GenuineIntel GNU/Linux
>>$ exit
>>
>>Script done on Thu May 12 15:18:16 2005
>>
>>Regards,
>>
>>Max
>>
>>R compiled with
>>gcc 3.3.5
>>glibc-2.3.4
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Thu May 12 18:57:07 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu May 12 18:57:15 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <20050512165707.1AF9CE179@slim.kubism.ku.dk>

Yes, it is coincidence.

I have found the error and have a fix: more detailed message to follow.

Brian

On Thu, 12 May 2005 ligges@statistik.uni-dortmund.de wrote:

> Liaw, Andy wrote:
>
>> I believe that's been fixed in R-2.1.0.  Please check.
>>
>> I got the same segfault with R-2.0.1 on SuSE Linux x86_64, but on both that
>> machine and my WinXP latop, I get syntax error.  E.g.,
>>
>> R : Copyright 2005, The R Foundation for Statistical Computing
>> Version 2.1.0 Patched (2005-05-12), ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>>   Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for a HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>
>>> (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
>>
>> + (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
>> Error: syntax error
>
>
> With R-2.1.0 (release!) I get syntax error on Windows, no error (at
> least not after the first couple of hundred openings) on Linux, but the
> described *segfault* on Solaris 5.7 (UltraSparc).
> [I am too lazy to try out R-patched on the slowish Solaris machine yet]
>
> Uwe Ligges
>
>
>> Andy
>>
>>
>>
>>> From: m.e.bruche@lse.ac.uk
>>>
>>> Full_Name: Max
>>> Version: R 2.0.1 (2004-11-15)
>>> OS: Gentoo Linux
>>> Submission from: (NULL) (158.143.49.181)
>>>
>>>
>>> I leaned on the "(" key by accident, and it looks as if R
>>> segfaults on a large
>>> number (88 or more in my case) open brackets:
>>>
>>> Script started on Thu May 12 15:18:04 2005
>>> $ R
>>>
>>> R : Copyright 2004, The R Foundation for Statistical Computing
>>> Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
>>>
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>>
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>>
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for a HTML browser interface to help.
>>> Type 'q()' to quit R.
>>>
>>>
>>> ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
>>> ((((((((((((((((
>>> (((((((((
>>> + (
>>> Segmentation fault
>>> $ uname -a
>>> Linux max 2.6.11-gentoo-r6 #2 Sat May 7 19:24:52 GMT 2005
>>> i686 Intel(R)
>>> Pentium(R) 4 CPU 2.40GHz GenuineIntel GNU/Linux
>>> $ exit
>>>
>>> Script done on Thu May 12 15:18:16 2005
>>>
>>> Regards,
>>>
>>> Max
>>>
>>> R compiled with
>>> gcc 3.3.5
>>> glibc-2.3.4
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>>
>>
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu May 12 19:49:54 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu May 12 19:50:02 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <20050512174954.23B69E17A@slim.kubism.ku.dk>

I suspect that is coincidence, as I can see no source change that would 
account for it.

2.0.1 and R-devel work for me and 2.1.0 segfaults with

999         KeepSource = *LOGICAL(GetOption(install("keep.source"), R_NilValue));
(gdb) bt
#0  0x080ca229 in ParseInit () at gram.y:999
#1  0x080cb305 in token () at gram.y:1530

I am not sure that is right, but I am pretty sure that

static char	contextstack[50], *contextp;

just above is an unchecked nesting limit, as in

static void IfPush(void)
{
     if (*contextp==LBRACE ||
 	*contextp=='['    ||
 	*contextp=='('    ||
 	*contextp == 'i')
 	    *++contextp = 'i';
}

However, although I thought this was the problem, it seems only to apply 
to nested if()s.  So I do not currently have a solution.


On Thu, 12 May 2005 andy_liaw@merck.com wrote:

> I believe that's been fixed in R-2.1.0.  Please check.
>
> I got the same segfault with R-2.0.1 on SuSE Linux x86_64, but on both that
> machine and my WinXP latop, I get syntax error.  E.g.,
>
> R : Copyright 2005, The R Foundation for Statistical Computing
> Version 2.1.0 Patched (2005-05-12), ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
>
>> (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> + (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> Error: syntax error
>
> Andy
>
>
>> From: m.e.bruche@lse.ac.uk
>>
>> Full_Name: Max
>> Version: R 2.0.1 (2004-11-15)
>> OS: Gentoo Linux
>> Submission from: (NULL) (158.143.49.181)
>>
>>
>> I leaned on the "(" key by accident, and it looks as if R
>> segfaults on a large
>> number (88 or more in my case) open brackets:
>>
>> Script started on Thu May 12 15:18:04 2005
>> $ R
>>
>> R : Copyright 2004, The R Foundation for Statistical Computing
>> Version 2.0.1  (2004-11-15), ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for a HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>>
>> ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
>> ((((((((((((((((
>> (((((((((
>> + (
>> Segmentation fault
>> $ uname -a
>> Linux max 2.6.11-gentoo-r6 #2 Sat May 7 19:24:52 GMT 2005
>> i686 Intel(R)
>> Pentium(R) 4 CPU 2.40GHz GenuineIntel GNU/Linux
>> $ exit
>>
>> Script done on Thu May 12 15:18:16 2005
>>
>> Regards,
>>
>> Max
>>
>> R compiled with
>> gcc 3.3.5
>> glibc-2.3.4
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From m.e.bruche at lse.ac.uk  Thu May 12 20:09:41 2005
From: m.e.bruche at lse.ac.uk (m.e.bruche@lse.ac.uk)
Date: Thu May 12 20:09:48 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
Message-ID: <20050512180941.4DECAE181@slim.kubism.ku.dk>

On Thursday 12 May 2005 16:31, you wrote:
> I believe that's been fixed in R-2.1.0.  Please check.
>

Just to confirm, this appears to be reproducible for R-2.1.0, at least for my 
setup:

Script started on Thu May 12 18:52:21 2005
$ R

R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0  (2005-04-18), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> 
((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
(((((((( 
+ (
+ (
Segmentation fault
$ exit

Script done on Thu May 12 18:52:29 2005

From ripley at stats.ox.ac.uk  Thu May 12 20:44:48 2005
From: ripley at stats.ox.ac.uk (Brian D Ripley)
Date: Thu May 12 20:44:57 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <EC0D7A2E-9673-4D7B-A7EC-AEFD45F35D17@unsw.edu.au>
Message-ID: <Pine.GSO.4.31.0505121921210.23806-100000@markov.stats>

As far as I know R 2.0.1 was built on AIX.  A quick diff

gannet% diff ~/R/R-2.0.1/src/modules/X11/Makefile
~/R/R-2.1.0/src/modules/X11/Makefile
54c54
<       $(SHLIB_LINK) -o $@ $(R_X11_la_LDFLAGS) $(R_X11_la_OBJECTS)
$(R_X11_la_LIBADD) $(LIBS)
---
>       $(SHLIB_LINK) -o $@ $(R_X11_la_LDFLAGS) $(R_X11_la_OBJECTS)
$(R_X11_la_LIBADD)
128c128,129
<   ../../../src/include/Rmodules/RX11.h
---
>   ../../../src/include/Rmodules/RX11.h \
>   ../../../src/include/Rconnections.h

suggests that AIX (alone) required $(LIBS) there.  As it is harmful on
some other platforms (the intention is to pick up entry points in
R.bin/libR rather than duplicate copies of static libraries) I suspect we
need an AIX-specific workaround (in particular the libintl library is not
going to be in LIBS).

This probably applies to other modules and even shared objects in
packages.

Is there anyone with an AIX machine who is able to work through this and
provide appropriate diffs?


On Thu, 12 May 2005, Bill Northcott wrote:

> On 11/05/2005, at 11:26 PM, Kurt Hornik wrote:
> >> There seem to be problems in the autoconf stuff.  cos and sin are
> >> being located in libm but the link line you show has no '-lm' which
> >> accounts for 6 of the 7 missing symbols.  Also gettext seems to have
> >> been located by the configure script, but there is no option on the
> >> link line to include it in the link. Also search configure.in for
> >> strings like powerpc-ibm-aix to see what stuff is being done
> >> specifically for AIX.  It may be out of date in relation to your
> >> system.
> >>
> >
> >
> >> If it was my problem, I would have look at those bits of the
> >> configure
> >> script and the sections of configure.in that generated them.  Then I
> >> would compare the AC_SUBST variables with the makefile.in that
> >> generated the link.  It seems there is some non- communication there.
>
> > Yes most of the undefined symbols seem to come from libm.  But they
> > would also be in libm on all other platforms which have such, and
> > we do
> > not include it there.  On Linux I get
> >
> > gcc-3.4 -shared -L/usr/local/lib -o R_X11.so  dataentry.lo
> > devX11.lo rotated.lo rbitmap.lo  -lSM -lICE -L/usr/X11R6/lib -lX11
> > -ljpeg -lpng -lz -L../../../lib -lR
>
> What happens on Linux is just not really relevant to what happens on
> AIX, although it might explain why the errors have not been picked
> up.  A number of platforms do not have a separate libm.  Instead they
> have a symlink to some general C library.  So typically libm is
> linked by default on these platforms.  It looks as if that is not the
> case on AIX, and that a specific -lm flag is needed.
> >
> > and this works.  As Brian already wrote, we are building a *module*
> > here, so I assume that we are not getting the flags for building
> > modules
> > right.  Assuming that libtool can, it might be helpful to look at the
> > output of BUILDDIR/libtool --config.
> >
> The error messages are about missing symbols.
>
> Bill
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Kurt.Hornik at wu-wien.ac.at  Thu May 12 20:51:32 2005
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Thu May 12 20:50:36 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <Pine.GSO.4.31.0505121921210.23806-100000@markov.stats>
References: <EC0D7A2E-9673-4D7B-A7EC-AEFD45F35D17@unsw.edu.au>
	<Pine.GSO.4.31.0505121921210.23806-100000@markov.stats>
Message-ID: <17027.42420.949418.284278@mithrandir.hornik.net>

>>>>> Brian D Ripley writes:

> As far as I know R 2.0.1 was built on AIX.  A quick diff
> gannet% diff ~/R/R-2.0.1/src/modules/X11/Makefile
> ~/R/R-2.1.0/src/modules/X11/Makefile
> 54c54
> <       $(SHLIB_LINK) -o $@ $(R_X11_la_LDFLAGS) $(R_X11_la_OBJECTS)
> $(R_X11_la_LIBADD) $(LIBS)
> ---
>> $(SHLIB_LINK) -o $@ $(R_X11_la_LDFLAGS) $(R_X11_la_OBJECTS)
> $(R_X11_la_LIBADD)
> 128c128,129
> <   ../../../src/include/Rmodules/RX11.h
> ---
>> ../../../src/include/Rmodules/RX11.h \
>> ../../../src/include/Rconnections.h

> suggests that AIX (alone) required $(LIBS) there.  As it is harmful on
> some other platforms (the intention is to pick up entry points in
> R.bin/libR rather than duplicate copies of static libraries) I suspect we
> need an AIX-specific workaround (in particular the libintl library is not
> going to be in LIBS).

> This probably applies to other modules and even shared objects in
> packages.

Yes.  It would still be good if someone on AIX could provide us with the
output of BUILDDIR/libtool --config.

-k

> Is there anyone with an AIX machine who is able to work through this
> and provide appropriate diffs?


> On Thu, 12 May 2005, Bill Northcott wrote:

>> On 11/05/2005, at 11:26 PM, Kurt Hornik wrote:
>> >> There seem to be problems in the autoconf stuff.  cos and sin are
>> >> being located in libm but the link line you show has no '-lm' which
>> >> accounts for 6 of the 7 missing symbols.  Also gettext seems to have
>> >> been located by the configure script, but there is no option on the
>> >> link line to include it in the link. Also search configure.in for
>> >> strings like powerpc-ibm-aix to see what stuff is being done
>> >> specifically for AIX.  It may be out of date in relation to your
>> >> system.
>> >>
>> >
>> >
>> >> If it was my problem, I would have look at those bits of the
>> >> configure
>> >> script and the sections of configure.in that generated them.  Then I
>> >> would compare the AC_SUBST variables with the makefile.in that
>> >> generated the link.  It seems there is some non- communication there.
>> 
>> > Yes most of the undefined symbols seem to come from libm.  But they
>> > would also be in libm on all other platforms which have such, and
>> > we do
>> > not include it there.  On Linux I get
>> >
>> > gcc-3.4 -shared -L/usr/local/lib -o R_X11.so  dataentry.lo
>> > devX11.lo rotated.lo rbitmap.lo  -lSM -lICE -L/usr/X11R6/lib -lX11
>> > -ljpeg -lpng -lz -L../../../lib -lR
>> 
>> What happens on Linux is just not really relevant to what happens on
>> AIX, although it might explain why the errors have not been picked
>> up.  A number of platforms do not have a separate libm.  Instead they
>> have a symlink to some general C library.  So typically libm is
>> linked by default on these platforms.  It looks as if that is not the
>> case on AIX, and that a specific -lm flag is needed.
>> >
>> > and this works.  As Brian already wrote, we are building a *module*
>> > here, so I assume that we are not getting the flags for building
>> > modules
>> > right.  Assuming that libtool can, it might be helpful to look at the
>> > output of BUILDDIR/libtool --config.
>> >
>> The error messages are about missing symbols.
>> 
>> Bill
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 

> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu May 12 23:50:25 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 12 23:50:37 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
In-Reply-To: <20050512174954.23B69E17A@slim.kubism.ku.dk>
References: <20050512174954.23B69E17A@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505122248370.13448@gannet.stats>

On Thu, 12 May 2005 ripley@stats.ox.ac.uk wrote:

> I suspect that is coincidence, as I can see no source change that would
> account for it.
>
> 2.0.1 and R-devel work for me and 2.1.0 segfaults with
>
> 999         KeepSource = *LOGICAL(GetOption(install("keep.source"), R_NilValue));
> (gdb) bt
> #0  0x080ca229 in ParseInit () at gram.y:999
> #1  0x080cb305 in token () at gram.y:1530
>
> I am not sure that is right, but I am pretty sure that
>
> static char	contextstack[50], *contextp;
>
> just above is an unchecked nesting limit, as in
>
> static void IfPush(void)
> {
>     if (*contextp==LBRACE ||
> 	*contextp=='['    ||
> 	*contextp=='('    ||
> 	*contextp == 'i')
> 	    *++contextp = 'i';
> }
>
> However, although I thought this was the problem, it seems only to apply
> to nested if()s.  So I do not currently have a solution.

I was almost right, just a different instance of *++contextp.

Fixed in R-patched, to give

> (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
Error: contextstack overflow


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Fri May 13 00:37:17 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Fri May 13 00:39:39 2005
Subject: [Rd] Bug in axis labels (PR#7860)
Message-ID: <20050512223717.4DC63E183@slim.kubism.ku.dk>

Bob O'hara wrote:
> I'm a bit reluctant to call anything a bug: I know it's usually my 
> incompetence instead.  In this case, I can't see what else it is, 
> although it may be a bug in Windows.
> 
> The problem comes from trying to create a .png of a figure in Windows 
> XP, with R2.1.0.  On the screen it looks OK, but in the .png the text 
> for the x label is smaller than for the y label.  The problem seems to 
> be created by using axes=F in plot().  Here's some code to demonstrate 
> the problem:
> 
> XX=1:5;  YY=1:5
> png("thing.png")
> par(mfrow=c(2,1))
>  plot(XX, YY, axes=F, xlab="X label", ylab="Y label")
>  plot(XX, YY, xlab="X label", ylab="Y label")
> dev.off()
> 
> I get a similar problem with bmp() and jpeg(), but not postscript() or 
> pdf().  If I draw the figure in the window in R and then save it as a 
> .png from the menu, the png looks fine.
> 
> Everything works fine in R1.5.1 (I know, I know!) on Debian Linux, which 
> is why I'm reporting this as a Windows problem.

I see the problem in the first figure, and it's still there in a recent 
r-devel build.  My test was also on Windows. Since png() uses the 
Windows graphics driver, it does look like an R bug in the Windows 
graphics driver, but I'd like to hear from someone on a different 
platform...

Duncan Murdoch

From p.dalgaard at biostat.ku.dk  Fri May 13 00:52:22 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri May 13 00:52:30 2005
Subject: [Rd] Bug in axis labels (PR#7860)
In-Reply-To: <20050512223717.4DC63E183@slim.kubism.ku.dk>
References: <20050512223717.4DC63E183@slim.kubism.ku.dk>
Message-ID: <x2r7gcm509.fsf@turmalin.kubism.ku.dk>

murdoch@stats.uwo.ca writes:

> > Everything works fine in R1.5.1 (I know, I know!) on Debian Linux, which 
> > is why I'm reporting this as a Windows problem.
> 
> I see the problem in the first figure, and it's still there in a recent 
> r-devel build.  My test was also on Windows. Since png() uses the 
> Windows graphics driver, it does look like an R bug in the Windows 
> graphics driver, but I'd like to hear from someone on a different 
> platform...

I don't see it with 2.1.0 on Linux (FC3).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From asundare at ucsd.edu  Fri May 13 01:31:48 2005
From: asundare at ucsd.edu (Ambika Sundaresan)
Date: Fri May 13 01:31:55 2005
Subject: [Rd] R make errors
Message-ID: <4283E764.1070306@ucsd.edu>

I tried to install the latest version of R (2-1.0)in anAIX machine. I was able to tar, and configure with no
errors.  However, when I said make, I got the following errors:


     gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall
-Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo devX11.lo
rotated.lo rbitmap.lo -lSM -lICE -lX11
ld: 0711-317 ERROR: Undefined symbol: .log10
ld: 0711-317 ERROR: Undefined symbol: .floor
ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
ld: 0711-317 ERROR: Undefined symbol: .pow
ld: 0711-317 ERROR: Undefined symbol: .sin
ld: 0711-317 ERROR: Undefined symbol: .cos
ld: 0711-317 ERROR: Undefined symbol: .tan
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information.
collect2: ld returned 8 exit status
make: 1254-004 The error code from the last command is 1.
 
 
Stop.
make: 1254-004 The error code from the last command is 2.

I understand I have to edit the Makefile.  Can someone tell me which Makefile(folder) and also which flags to edit.  I greatly appreciate your help.  Thanks

Ambika Sundaresan
Grad. Student
UCSD.

From tlumley at u.washington.edu  Fri May 13 02:20:51 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri May 13 02:21:10 2005
Subject: [Rd] segfault on large number of open brackets (PR#7859)
In-Reply-To: <Pine.LNX.4.61.0505122248370.13448@gannet.stats>
References: <20050512174954.23B69E17A@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505122248370.13448@gannet.stats>
Message-ID: <Pine.A41.4.61b.0505121719520.136304@homer08.u.washington.edu>


And this also fixes PR#7022 (a highly nested polynomial)

 	-thomas

On Thu, 12 May 2005, Prof Brian Ripley wrote:

> On Thu, 12 May 2005 ripley@stats.ox.ac.uk wrote:
>
>> I suspect that is coincidence, as I can see no source change that would
>> account for it.
>> 
>> 2.0.1 and R-devel work for me and 2.1.0 segfaults with
>> 
>> 999         KeepSource = *LOGICAL(GetOption(install("keep.source"), 
>> R_NilValue));
>> (gdb) bt
>> #0  0x080ca229 in ParseInit () at gram.y:999
>> #1  0x080cb305 in token () at gram.y:1530
>> 
>> I am not sure that is right, but I am pretty sure that
>> 
>> static char	contextstack[50], *contextp;
>> 
>> just above is an unchecked nesting limit, as in
>> 
>> static void IfPush(void)
>> {
>>     if (*contextp==LBRACE ||
>> 	*contextp=='['    ||
>> 	*contextp=='('    ||
>> 	*contextp == 'i')
>> 	    *++contextp = 'i';
>> }
>> 
>> However, although I thought this was the problem, it seems only to apply
>> to nested if()s.  So I do not currently have a solution.
>
> I was almost right, just a different instance of *++contextp.
>
> Fixed in R-patched, to give
>
>> (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
> Error: contextstack overflow
>
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From ripley at stats.ox.ac.uk  Fri May 13 05:55:55 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri May 13 05:56:03 2005
Subject: [Rd] R make errors
In-Reply-To: <4283E764.1070306@ucsd.edu>
References: <4283E764.1070306@ucsd.edu>
Message-ID: <Pine.LNX.4.61.0505130453580.21287@gannet.stats>

Please see the thread entitled:

 	Implementing R on  IBM p690 cluster Jump

in this list's archives.  We don't have a solution currently, but we do 
need some help.

On Thu, 12 May 2005, Ambika Sundaresan wrote:

> I tried to install the latest version of R (2-1.0)in anAIX machine. I was 
> able to tar, and configure with no
> errors.  However, when I said make, I got the following errors:
>
>
>    gcc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall
> -Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo 
> devX11.lo
> rotated.lo rbitmap.lo -lSM -lICE -lX11
> ld: 0711-317 ERROR: Undefined symbol: .log10
> ld: 0711-317 ERROR: Undefined symbol: .floor
> ld: 0711-317 ERROR: Undefined symbol: .libintl_gettext
> ld: 0711-317 ERROR: Undefined symbol: .pow
> ld: 0711-317 ERROR: Undefined symbol: .sin
> ld: 0711-317 ERROR: Undefined symbol: .cos
> ld: 0711-317 ERROR: Undefined symbol: .tan
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
> information.
> collect2: ld returned 8 exit status
> make: 1254-004 The error code from the last command is 1.
>
>
> Stop.
> make: 1254-004 The error code from the last command is 2.
>
> I understand I have to edit the Makefile.  Can someone tell me which 
> Makefile(folder) and also which flags to edit.  I greatly appreciate your 
> help.  Thanks
>
> Ambika Sundaresan
> Grad. Student
> UCSD.
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From root at terminator1.vsnl.net.in  Fri May 13 07:39:17 2005
From: root at terminator1.vsnl.net.in (root@terminator1.vsnl.net.in)
Date: Fri May 13 07:39:24 2005
Subject: [Rd] RFC822/M400 Mail Network -- Delivery Report (PR#7861)
Message-ID: <20050513053917.C1901E181@slim.kubism.ku.dk>

--Delivery-Status-Report

Not delivered to: inter.chen@gems.vsnl.net.in
	user agent unavailable

--Delivery-Status-Report
Content-Type: message/delivery-status

Original-Envelope-Id: in*vsnl*rfc987;4284390b4708000mimey2k
X400-Content-Identifier: 050513105010+053
Reporting-MTA: x400; /ADMD=VSNL/C=IN
DSN-Gateway: smtp; terminator1.vsnl.net.in

Final-Recipient: rfc822;
	S=chen/G=inter/PRMD=gems/ADMD=vsnl/C=in@terminator1.vsnl.net.in
Action: failed
Diagnostic-Code: x400; 1 4
Status: 5.1.1
Last-Attempted-Date: 13 May 2005 10:36 +0530
X-Supplementary: Hello World
--Delivery-Status-Report--

From trossari at terra.com.br  Fri May 13 14:08:32 2005
From: trossari at terra.com.br (trossari@terra.com.br)
Date: Fri May 13 14:08:39 2005
Subject: [Rd] [avast! - INFECTED]   Duvido voce me reconher =) (PR#7862)
Message-ID: <20050513120832.0C45BE3B8@slim.kubism.ku.dk>

This is a multi-part message in MIME format.

------=_NextPart_000_0005_486C08ED.1D6CDC80
Content-Type: text/plain;
	charset="Windows-1252"
Content-Transfer-Encoding: 7bit

Ola, a quanto tempo!               Eu me mudei dai para os Estados Unidos, e faz um tempo que perdemos o contato               e consegui seu email atraves de uma amiga sua. Vamos fazer assim, eu vou lhe               mandar meu album de fotos se voce me reconhecer, me retorna o email.               Quero ver se voce ainda lembra de mim. :)               


------=_NextPart_000_0005_486C08ED.1D6CDC80
Content-Type: multipart/alternative;
	boundary="----=_NextPart_Avast_Info_Boundary"

------=_NextPart_Avast_Info_Boundary
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable
Content-Description: avast info



---
avast! Antivirus: Outbound message INFECTED:
\eu.pif#2891094007 (Win32:Mydoom-AX [Wrm]) was deleted from the message.

Virus Database (VPS): 0519-2, 12/05/2005
Tested on: 26/03/04 09:09:20
avast! - copyright (c) 1988-2005 ALWIL Software.
http://www.avast.com







------=_NextPart_Avast_Info_Boundary--

------=_NextPart_000_0005_486C08ED.1D6CDC80--

From andy_liaw at merck.com  Fri May 13 17:00:23 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Fri May 13 17:02:31 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E82D@usctmx1106.merck.com>

> From: Kurt Hornik
> 
> >>>>> Brian D Ripley writes:
> 
> > As far as I know R 2.0.1 was built on AIX.  A quick diff
> > gannet% diff ~/R/R-2.0.1/src/modules/X11/Makefile
> > ~/R/R-2.1.0/src/modules/X11/Makefile
> > 54c54
> > <       $(SHLIB_LINK) -o $@ $(R_X11_la_LDFLAGS) $(R_X11_la_OBJECTS)
> > $(R_X11_la_LIBADD) $(LIBS)
> > ---
> >> $(SHLIB_LINK) -o $@ $(R_X11_la_LDFLAGS) $(R_X11_la_OBJECTS)
> > $(R_X11_la_LIBADD)
> > 128c128,129
> > <   ../../../src/include/Rmodules/RX11.h
> > ---
> >> ../../../src/include/Rmodules/RX11.h \
> >> ../../../src/include/Rconnections.h
> 
> > suggests that AIX (alone) required $(LIBS) there.  As it is 
> harmful on
> > some other platforms (the intention is to pick up entry points in
> > R.bin/libR rather than duplicate copies of static 
> libraries) I suspect we
> > need an AIX-specific workaround (in particular the libintl 
> library is not
> > going to be in LIBS).
> 
> > This probably applies to other modules and even shared objects in
> > packages.
> 
> Yes.  It would still be good if someone on AIX could provide 
> us with the
> output of BUILDDIR/libtool --config.
> 
> -k
> 
> > Is there anyone with an AIX machine who is able to work through this
> > and provide appropriate diffs?

Sorry for being dense: could you explain what diff is needed? 

I unpacked R-patched_2005-05-12, and set:

OBJECT_MODE=64
CC=xlc_r
F77=xlf_r
CXX=xlC_r
CFLAGS/FLAGS/CXXFLAGS="-O -qstrict"

Running make gave similar error, namely symbols that should be in libm 
not found.  Below is output from BUILDDIR/libtool --config:

---------------------------------
# Libtool was configured on host hpc2b.merck.com:

# Shell to use when invoking shell scripts.
SHELL="/bin/sh"

# Whether or not to build shared libraries.
build_libtool_libs=yes

# Whether or not to build static libraries.
build_old_libs=no

# Whether or not to add -lc for building shared libraries.
build_libtool_need_lc=yes

# Whether or not to disallow shared libs when runtime libs are static
allow_libtool_libs_with_static_runtimes=no

# Whether or not to optimize for fast installation.
fast_install=yes

# The host system.
host_alias=
host=powerpc-ibm-aix5.1.0.0

# An echo program that does not interpret backslashes.
echo="print -r"

# The archiver.
AR="ar"
AR_FLAGS="cru"

# A C compiler.
LTCC="xlc_r"

# A language-specific compiler.
CC="xlc_r"

# Is the compiler the GNU C compiler?
with_gcc=

# An ERE matcher.
EGREP="grep -E"

# The linker used to build libraries.
LD="/bin/ld"

# Whether we need hard or soft links.
LN_S="ln -s"

# A BSD-compatible nm program.
NM="/bin/nm -B"

# A symbol stripping program
STRIP="strip"

# Used to examine libraries when file_magic_cmd begins "file"
MAGIC_CMD=file

# Used on cygwin: DLL creation program.
DLLTOOL="dlltool"

# Used on cygwin: object dumper.
OBJDUMP="objdump"

# Used on cygwin: assembler.
AS="as"

# The name of the directory that contains temporary libtool files.
objdir=.libs

# How to create reloadable object files.
reload_flag=" -r"
reload_cmds="\$LD\$reload_flag -o \$output\$reload_objs"

# How to pass a linker flag through the compiler.
wl="-Wl,"

# Object file suffix (normally "o").
objext="o"

# Old archive suffix (normally "a").
libext="a"

# Shared library suffix (normally ".so").
shrext_cmds='.so'

# Executable file suffix (normally "").
exeext=""

# Additional compiler flags for building library objects.
pic_flag=" -DPIC"
pic_mode=default

# What is the maximum length of a command?
max_cmd_len=8192

# Does compiler simultaneously support -c and -o options?
compiler_c_o="yes"

# Must we lock files when doing compilation ?
need_locks="no"

# Do we need the lib prefix for modules?
need_lib_prefix=no

# Do we need a version for libraries?
need_version=no

# Whether dlopen is supported.
dlopen_support=unknown

# Whether dlopen of programs is supported.
dlopen_self=unknown

# Whether dlopen of statically linked programs is supported.
dlopen_self_static=unknown

# Compiler flag to prevent dynamic linking.
link_static_flag="-bnso -bI:/lib/syscalls.exp"

# Compiler flag to turn off builtin functions.
no_builtin_flag=""

# Compiler flag to allow reflexive dlopens.
export_dynamic_flag_spec=""

# Compiler flag to generate shared objects directly from archives.
whole_archive_flag_spec=" "

# Compiler flag to generate thread-safe objects.
thread_safe_flag_spec=""

# Library versioning type.
version_type=linux

# Format of library name prefix.
libname_spec="lib\$name"

# List of archive names.  First name is the real one, the rest are links.
# The last name is the one that the linker finds with -lNAME.
library_names_spec="\${libname}\${release}.a \$libname.a"

# The coded name of the library, if different from the real name.
soname_spec="\${libname}\${release}\${shared_ext}\$major"

# Commands used to build and install an old-style archive.
RANLIB="ranlib"
old_archive_cmds="\$AR \$AR_FLAGS \$oldlib\$oldobjs\$old_deplibs~\$RANLIB
\$oldlib"
old_postinstall_cmds="\$RANLIB \$oldlib~chmod 644 \$oldlib"
old_postuninstall_cmds=""

# Create an old-style archive from a shared archive.
old_archive_from_new_cmds=""

# Create a temporary old-style archive to link instead of a shared archive.
old_archive_from_expsyms_cmds=""

# Commands used to build and install a shared archive.
archive_cmds=""
archive_expsym_cmds="\$CC \${wl}-bM:SRE -o \$output_objdir/\$soname
\$libobjs \$deplibs \$compiler_flags \${wl}-bE:\$export_symbols
\${wl}-bnoentry\${allow_undefined_flag}~\$AR \$AR_FLAGS
\$output_objdir/\$libname\$release.a \$output_objdir/\$soname"
postinstall_cmds=""
postuninstall_cmds=""

# Commands used to build a loadable module (assumed same as above if empty)
module_cmds=""
module_expsym_cmds=""

# Commands to strip libraries.
old_striplib=""
striplib=""

# Dependencies to place before the objects being linked to create a
# shared library.
predep_objects=""

# Dependencies to place after the objects being linked to create a
# shared library.
postdep_objects=""

# Dependencies to place before the objects being linked to create a
# shared library.
predeps=""

# Dependencies to place after the objects being linked to create a
# shared library.
postdeps=""

# The library search path used internally by the compiler when linking
# a shared library.
compiler_lib_search_path=""

# Method to check whether dependent libraries are shared objects.
deplibs_check_method="pass_all"

# Command to use when deplibs_check_method == file_magic.
file_magic_cmd="\$MAGIC_CMD"

# Flag that allows shared libraries with undefined symbols to be built.
allow_undefined_flag=" \${wl}-berok"

# Flag that forces no undefined symbols.
no_undefined_flag=" \${wl}-bernotok"

# Commands used to finish a libtool library installation in a directory.
finish_cmds=""

# Same as above, but a single script fragment to be evaled but not shown.
finish_eval=""

# Take the output of nm and produce a listing of raw symbols and C names.
global_symbol_pipe="sed -n -e 's/^.*[ 	]\\([BCDT][BCDT]*\\)[ 	][
]*\\(\\)\\([_A-Za-z][_A-Za-z0-9]*\\)\$/\\1 \\2\\3 \\3/p'"

# Transform the output of nm in a proper C declaration
global_symbol_to_cdecl="sed -n -e 's/^. .* \\(.*\\)\$/extern int \\1;/p'"

# Transform the output of nm in a C name address pair
global_symbol_to_c_name_address="sed -n -e 's/^: \\([^ ]*\\) \$/
{\\\"\\1\\\", (lt_ptr) 0},/p' -e 's/^[BCDEGRST] \\([^ ]*\\) \\([^ ]*\\)\$/
{\"\\2\", (lt_ptr) \\&\\2},/p'"

# This is the shared library runtime path variable.
runpath_var=

# This is the shared library path variable.
shlibpath_var=LIBPATH

# Is shlibpath searched before the hard-coded library search path?
shlibpath_overrides_runpath=unknown

# How to hardcode a shared library path into an executable.
hardcode_action=immediate

# Whether we should hardcode library paths into libraries.
hardcode_into_libs=yes

# Flag to hardcode $libdir into a binary during linking.
# This must work even if $libdir does not exist.
hardcode_libdir_flag_spec="\${wl}-blibpath:\$libdir:/usr/local/lib:/usr/lpp/
xlopt:/usr/lib/threads:/usr/lib:/lib
"

# If ld is used when linking, flag to hardcode $libdir into
# a binary during linking. This must work even if $libdir does
# not exist.
hardcode_libdir_flag_spec_ld=""

# Whether we need a single -rpath flag with a separated argument.
hardcode_libdir_separator=":"

# Set to yes if using DIR/libNAME during linking hardcodes DIR into the
# resulting binary.
hardcode_direct=yes

# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
# resulting binary.
hardcode_minus_L=no

# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
# the resulting binary.
hardcode_shlibpath_var=unsupported

# Set to yes if building a shared library automatically hardcodes DIR into
the library
# and all subsequent libraries and executables linked against it.
hardcode_automatic=no

# Variables whose values should be saved in libtool wrapper scripts and
# restored at relink time.
variables_saved_for_relink="PATH  "

# Whether libtool must link a program against all its dependency libraries.
link_all_deplibs=yes

# Compile-time system search path for libraries
sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"

# Run-time system search path for libraries
sys_lib_dlsearch_path_spec="/lib /usr/lib"

# Fix the shell variable $srcfile for the compiler.
fix_srcfile_path=""

# Set to yes if exported symbols are required.
always_export_symbols=yes

# The commands to list exported symbols.
export_symbols_cmds="\$NM -BCpg \$libobjs \$convenience | awk '{ if (((\\\$2
== \\\"T\\\") || (\\\$2 == \\\"D\\\") || (\\\$2 == \\\"B\\\")) &&
(substr(\\\$3,1,1) != \\\".\\\")) { print \\\$3 } }' | sort -u >
\$export_symbols"

# The commands to extract the exported symbol list from a shared archive.
extract_expsyms_cmds=""

# Symbols that should not be listed in the preloaded symbols.
exclude_expsyms="_GLOBAL_OFFSET_TABLE_"

# Symbols that must always be exported.
include_expsyms=""
-------------------------------





> 
> > On Thu, 12 May 2005, Bill Northcott wrote:
> 
> >> On 11/05/2005, at 11:26 PM, Kurt Hornik wrote:
> >> >> There seem to be problems in the autoconf stuff.  cos 
> and sin are
> >> >> being located in libm but the link line you show has no 
> '-lm' which
> >> >> accounts for 6 of the 7 missing symbols.  Also gettext 
> seems to have
> >> >> been located by the configure script, but there is no 
> option on the
> >> >> link line to include it in the link. Also search 
> configure.in for
> >> >> strings like powerpc-ibm-aix to see what stuff is being done
> >> >> specifically for AIX.  It may be out of date in relation to your
> >> >> system.
> >> >>
> >> >
> >> >
> >> >> If it was my problem, I would have look at those bits of the
> >> >> configure
> >> >> script and the sections of configure.in that generated 
> them.  Then I
> >> >> would compare the AC_SUBST variables with the makefile.in that
> >> >> generated the link.  It seems there is some non- 
> communication there.
> >> 
> >> > Yes most of the undefined symbols seem to come from 
> libm.  But they
> >> > would also be in libm on all other platforms which have such, and
> >> > we do
> >> > not include it there.  On Linux I get
> >> >
>

From charlie at stat.umn.edu  Fri May 13 21:44:55 2005
From: charlie at stat.umn.edu (Charles Geyer)
Date: Fri May 13 21:45:07 2005
Subject: [Rd] add Rvsnprintf to API ??
In-Reply-To: <200505131003.j4DA3BSZ020947@hypatia.math.ethz.ch>
References: <200505131003.j4DA3BSZ020947@hypatia.math.ethz.ch>
Message-ID: <20050513194455.GA23627@stat.umn.edu>

Could Rvsnprintf (in src/main/errors.c) be added to the R API
with prototype in include/R_ext/Print.h say?

Here's my problem.  I'm trying to write some code that is not
totally tied to R.  Hence I want R style error messaging to
be isolated in a small module.  I do not want #include <R.h>
and calls to error (Rf_error) in most of my code.
Hence I want to write a module with something like

----- begin code snippet -----
#include <stdarg.h>
#include <stdio.h>
#include <R.h>

#define BUFSIZE 1024

void die(const char *format, ...)
{
    char buf[BUFSIZE];
    va_list arg;

    va_start(arg, format);
    vsnprintf(buf, BUFSIZE, format, arg);
    va_end(arg);
    buf[BUFSIZE - 1] = '\0';
    error(buf);
}
----- end code snippet -----

But that's not portable because vsnprintf isn't.
You've already made a big effort to work around nonportability of
vsnprintf, but don't make it available in the API.  Why not?

If I could change vsnprintf to Rvsnprintf above, then I wouldn't
have to do some horrible autoconf song and dance that probably wouldn't
be completely portable anyway.

Or is there a better solution I haven't seen?

-- 
Charles Geyer
Professor, School of Statistics
University of Minnesota
charlie@stat.umn.edu

From ripley at stats.ox.ac.uk  Sat May 14 08:56:05 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat May 14 08:56:13 2005
Subject: [Rd] add Rvsnprintf to API ??
In-Reply-To: <20050513194455.GA23627@stat.umn.edu>
References: <200505131003.j4DA3BSZ020947@hypatia.math.ethz.ch>
	<20050513194455.GA23627@stat.umn.edu>
Message-ID: <Pine.LNX.4.61.0505140720080.25685@gannet.stats>

On Fri, 13 May 2005, Charles Geyer wrote:

> Could Rvsnprintf (in src/main/errors.c) be added to the R API
> with prototype in include/R_ext/Print.h say?
>
> Here's my problem.  I'm trying to write some code that is not
> totally tied to R.  Hence I want R style error messaging to
> be isolated in a small module.  I do not want #include <R.h>
> and calls to error (Rf_error) in most of my code.
> Hence I want to write a module with something like
>
> ----- begin code snippet -----
> #include <stdarg.h>
> #include <stdio.h>
> #include <R.h>
>
> #define BUFSIZE 1024
>
> void die(const char *format, ...)
> {
>    char buf[BUFSIZE];
>    va_list arg;
>
>    va_start(arg, format);
>    vsnprintf(buf, BUFSIZE, format, arg);
>    va_end(arg);
>    buf[BUFSIZE - 1] = '\0';
>    error(buf);
> }
> ----- end code snippet -----
>
> But that's not portable because vsnprintf isn't.
> You've already made a big effort to work around nonportability of
> vsnprintf, but don't make it available in the API.  Why not?
>
> If I could change vsnprintf to Rvsnprintf above, then I wouldn't
> have to do some horrible autoconf song and dance that probably wouldn't
> be completely portable anyway.
>
> Or is there a better solution I haven't seen?

R guarantees to have *vsnprintf* available.  Putting things in the API is 
a one-way decision and ties our hands for ever.  Rvsnprintf is not even 
exported from errors.c: it is static and just a convenience wrapper.

About all a user package needs to do is

AC_CHECK_DECLS([vsnprintf])

and in your code snippet

#if defined(HAVE_DECL_VSNPRINTF) && !HAVE_DECL_VSNPRINTF
extern int vsnprintf (char *str, size_t count, const char *fmt, va_list arg);
#endif

However, AFAIK all known R platforms do have vsnprintf these days: the 
MinGW compiler used on Windows gained it within the last year.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Sat May 14 17:44:49 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat May 14 17:44:17 2005
Subject: [Rd] Bug in axis labels (PR#7860)
In-Reply-To: <20050512223717.4DC63E183@slim.kubism.ku.dk>
References: <20050512223717.4DC63E183@slim.kubism.ku.dk>
Message-ID: <42861CF1.2070104@stats.uwo.ca>

This is fixed now, in R-patched and R-devel.

Duncan Murdoch

murdoch@stats.uwo.ca wrote:
> Bob O'hara wrote:
> 
>>I'm a bit reluctant to call anything a bug: I know it's usually my 
>>incompetence instead.  In this case, I can't see what else it is, 
>>although it may be a bug in Windows.
>>
>>The problem comes from trying to create a .png of a figure in Windows 
>>XP, with R2.1.0.  On the screen it looks OK, but in the .png the text 
>>for the x label is smaller than for the y label.  The problem seems to 
>>be created by using axes=F in plot().  Here's some code to demonstrate 
>>the problem:
>>
>>XX=1:5;  YY=1:5
>>png("thing.png")
>>par(mfrow=c(2,1))
>> plot(XX, YY, axes=F, xlab="X label", ylab="Y label")
>> plot(XX, YY, xlab="X label", ylab="Y label")
>>dev.off()
>>
>>I get a similar problem with bmp() and jpeg(), but not postscript() or 
>>pdf().  If I draw the figure in the window in R and then save it as a 
>>.png from the menu, the png looks fine.
>>
>>Everything works fine in R1.5.1 (I know, I know!) on Debian Linux, which 
>>is why I'm reporting this as a Windows problem.
> 
> 
> I see the problem in the first figure, and it's still there in a recent 
> r-devel build.  My test was also on Windows. Since png() uses the 
> Windows graphics driver, it does look like an R bug in the Windows 
> graphics driver, but I'd like to hear from someone on a different 
> platform...
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From murdoch at stats.uwo.ca  Sat May 14 18:06:22 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat May 14 18:05:49 2005
Subject: [Rd] PR$7706, png device plot on athlon 64 processor
Message-ID: <428621FE.2010702@stats.uwo.ca>

A later bug report (#7860) had to do with inappropriate sizing of the 
first text drawn on a png() device, and I've now fixed the bug that 
caused that.  Could you please check whether you still see your bug on 
today's build?  It will be available on CRAN tomorrow (May 15), in

http://cran.r-project.org/bin/windows/base/rpatched.html

Thanks!

Duncan Murdoch


> From: P.E.VerLorenvanThemaat@amc.uva.nl
> Subject: png device plot on athlon 64 processor
> Date: Fri, 25 Feb 2005 15:52:40 +0100 (CET)
> 
> Full_Name: Emiel Ver Loren van Themaat
> Version: 2.0.1
> OS: windows XP
> Submission from: (NULL) (145.117.31.248)
> 
> 
> On our computers, which have windows xp sp2 installed and have a 64 bit
> amd/athlon processor, the following simple code
> 
> png("test.png")
> plot(1:10,main="hello")
> dev.off()
> 
> 
> results in a plot in which the "main" title is not visible at all. For 32-bit
> computers with XP sp2 this bug does not occur. 
> 
> Hopefully this bug can be fixed.
> 
> (may be the png library is not up to date)
>

From lab at cs.wisc.edu  Sun May 15 05:09:31 2005
From: lab at cs.wisc.edu (lab@cs.wisc.edu)
Date: Sun May 15 05:09:40 2005
Subject: [Rd] Re: [CSL #263000] Verbrechen der deutschen Frau
In-Reply-To: <14fd.8ea2bf1b239@r-project.org> on Sun, 15 May 2005 03:08:58 UTC
References: <14fd.8ea2bf1b239@r-project.org>
Message-ID: <200505150309.j4F39VZD012988@vampire.cs.wisc.edu>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  Verbrechen der deutschen Frau
has been received and assigned a request number of 263000.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this request.

2) include the string:
          [CSL #263000]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #263000] Verbrechen der deutschen Frau

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any future 
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@granite.cs.wisc.edu Sat May 14 22:09:21 2005
Received: from granite.cs.wisc.edu (granite.cs.wisc.edu [128.105.6.24]) by
 vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4F39Lk4012966 for
 <labacct@vampire.cs.wisc.edu>; Sat, 14 May 2005 22:09:21 -0500
Received: from atykiwxox.org (gdd87.gdd.macalester.edu [141.140.121.87])
 by granite.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4F39EAT005207;
 Sat, 14 May 2005 22:09:15 -0500
From: r-devel@r-project.org
To: lilcatbug@stat.wisc.edu
Date: Sun, 15 May 2005 03:08:58 UTC
Subject: [CSL #263000] Verbrechen der deutschen Frau
Importance: Normal
X-Mailer: Outlook 7.43
X-Priority: 3 (Normal)
MIME-Version: 1.0
Message-ID: <14fd.8ea2bf1b239@r-project.org>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

Lese selbst:
http://www.jn-bw.de/texte/zeitgeschichte/verbrechen_der_frau.htm

From ggrothendieck at gmail.com  Sun May 15 05:52:13 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun May 15 05:52:21 2005
Subject: [Rd] Specifying dependency on a specific patched version
Message-ID: <971536df05051420525ce1e1b5@mail.gmail.com>

Is there a way to specify a package dependency in the Depends:
field of the DESCRIPTION file for a specific patched version of a 
specific OS?

For example, today's Windows patched release (2005-05-14) has
the capability of changing the time zone within R on Windows
via Sys.putenv(TZ="GMT") but prior patched versions do not have this.
Is there some way of ensuring that the 2005-05-14 or later release is used
if on Windows only?

From kanglin at gmail.com  Sun May 15 07:30:55 2005
From: kanglin at gmail.com (D0c)
Date: Sun May 15 07:31:02 2005
Subject: [Rd] Re: Calling R functions from Java
In-Reply-To: <2667b213050429062157c4c124@mail.gmail.com>
References: <2667b213050429062157c4c124@mail.gmail.com>
Message-ID: <2667b213050514223046a0476c@mail.gmail.com>

Hey anyone explored how to pass java objects (e.g Vector or String) to
R as a to be converted to a data.frame?

On 4/29/05, D0c <kanglin@gmail.com> wrote:
> Hey guys,
> I got a java gui app which loads up data into a table. How can i use R
> to perform statistical functions on the data in the table?
> 
> P.S My question is not particularly geared towards Java coding, but
> more towards allowing R functionality within Java.
>

From campushub at mnsu.edu  Sun May 15 10:09:33 2005
From: campushub at mnsu.edu (Campus Hub)
Date: Sun May 15 10:09:43 2005
Subject: [Rd] Thank you for your inquiry to the Campus Hub.
Message-ID: <1A7F52A5E87A8040AC43D52190ADF6B887C2A8@MAIL2.Campus.mnsu.edu>

Thank you for your inquiry to the Campus Hub. Depending on the volume
and complexity of requests currently being received, please allow up to
3-4 business days for us to research and answer your question.  If you
have not included your full name and Tech ID in your original email,
please resubmit your request and include this information. 
 
To safeguard the privacy of student information, all responses will be
directed to the student's official University email address 
(firstname.lastname@mnsu.edu). 
 
Additional information can be obtained on the University website at
www.mnsu.edu. Student billing, registration and financial aid status can
be accessed at www.mnsu.edu/msureg <http://www.mnsu.edu/msureg> . 
 
_______________________________
Campus Hub
Student Financial Services
Minnesota State University, Mankato
117 Centennial Student Union
Mankato, MN 56001
Voice: (507) 389-1866
Fax: (507) 389-2227
Toll Free: (800) 722-0544
Email: campushub@mnsu.edu <BLOCKED::mailto:campushub@mnsu.edu> 
Web: www.mnsu.edu/campushub 
 
CONFIDENTIALITY NOTICE:  This e-mail message, including any ...{{dropped}}

From ligges at statistik.uni-dortmund.de  Sun May 15 12:37:18 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun May 15 12:35:23 2005
Subject: [Rd] Specifying dependency on a specific patched version
In-Reply-To: <971536df05051420525ce1e1b5@mail.gmail.com>
References: <971536df05051420525ce1e1b5@mail.gmail.com>
Message-ID: <4287265E.5080403@statistik.uni-dortmund.de>

Gabor Grothendieck wrote:
> Is there a way to specify a package dependency in the Depends:
> field of the DESCRIPTION file for a specific patched version of a 
> specific OS?
> 
> For example, today's Windows patched release (2005-05-14) has
> the capability of changing the time zone within R on Windows
> via Sys.putenv(TZ="GMT") but prior patched versions do not have this.
> Is there some way of ensuring that the 2005-05-14 or later release is used
> if on Windows only?


No.

Uwe Ligges

> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From lab at cs.wisc.edu  Sun May 15 13:19:39 2005
From: lab at cs.wisc.edu (lab@cs.wisc.edu)
Date: Sun May 15 13:19:47 2005
Subject: [Rd] Re: [CSL #265686] Vorbildliche Aktion (PR#7866)
Message-ID: <20050515111939.CD207B24F@slim.kubism.ku.dk>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  Vorbildliche Aktion
has been received and assigned a request number of 265686.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this request.

2) include the string:
          [CSL #265686]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #265686] Vorbildliche Aktion

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any future 
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@obsidian.cs.wisc.edu Sun May 15 06:19:18 2005
Received: from obsidian.cs.wisc.edu (obsidian.cs.wisc.edu [128.105.6.13])
 by vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4FBJHJI031710 for
 <labacct@vampire.cs.wisc.edu>; Sun, 15 May 2005 06:19:17 -0500
Received: from bceamtpiy.org (gdd87.gdd.macalester.edu [141.140.121.87])
 by obsidian.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4FBJENK013807;
 Sun, 15 May 2005 06:19:15 -0500
From: r-bugs@r-project.org
To: freemail@stat.wisc.edu
Date: Sun, 15 May 2005 11:19:15 GMT
Subject: [CSL #265686] Vorbildliche Aktion
Importance: Normal
X-Priority: 3 (Normal)
MIME-Version: 1.0
Message-ID: <72562.1bf099ae1d17@r-project.org>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

Lese selbst:
http://www.npd.de/npd_info/deutschland/2004/d1204-24.html

From campushub at mnsu.edu  Sun May 15 13:35:18 2005
From: campushub at mnsu.edu (Campus Hub)
Date: Sun May 15 13:35:29 2005
Subject: [Rd] Thank you for your inquiry to the Campus Hub.
Message-ID: <1A7F52A5E87A8040AC43D52190ADF6B8AF03E4@MAIL2.Campus.mnsu.edu>

Thank you for your inquiry to the Campus Hub. Depending on the volume
and complexity of requests currently being received, please allow up to
3-4 business days for us to research and answer your question.  If you
have not included your full name and Tech ID in your original email,
please resubmit your request and include this information. 
 
To safeguard the privacy of student information, all responses will be
directed to the student's official University email address 
(firstname.lastname@mnsu.edu). 
 
Additional information can be obtained on the University website at
www.mnsu.edu. Student billing, registration and financial aid status can
be accessed at www.mnsu.edu/msureg <http://www.mnsu.edu/msureg> . 
 
_______________________________
Campus Hub
Student Financial Services
Minnesota State University, Mankato
117 Centennial Student Union
Mankato, MN 56001
Voice: (507) 389-1866
Fax: (507) 389-2227
Toll Free: (800) 722-0544
Email: campushub@mnsu.edu <BLOCKED::mailto:campushub@mnsu.edu> 
Web: www.mnsu.edu/campushub 
 
CONFIDENTIALITY NOTICE:  This e-mail message, including any ...{{dropped}}

From lab at cs.wisc.edu  Sun May 15 14:48:24 2005
From: lab at cs.wisc.edu (lab@cs.wisc.edu)
Date: Sun May 15 14:48:32 2005
Subject: [Rd] Re: [CSL #266660] Vorbildliche Aktion (PR#7867)
Message-ID: <20050515124824.57898B254@slim.kubism.ku.dk>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  Vorbildliche Aktion
has been received and assigned a request number of 266660.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this request.

2) include the string:
          [CSL #266660]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #266660] Vorbildliche Aktion

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any future 
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@granite.cs.wisc.edu Sun May 15 07:48:06 2005
Received: from granite.cs.wisc.edu (granite.cs.wisc.edu [128.105.6.24]) by
 vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4FCm6PW012811 for
 <labacct@vampire.cs.wisc.edu>; Sun, 15 May 2005 07:48:06 -0500
Received: from yevvp.org (gdd87.gdd.macalester.edu [141.140.121.87]) by
 granite.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4FCm1oT013654;
 Sun, 15 May 2005 07:48:01 -0500
From: r-bugs@r-project.org
To: slamm@stat.wisc.edu
Date: Sun, 15 May 2005 12:48:00 UTC
Subject: [CSL #266660] Vorbildliche Aktion
Importance: Normal
X-Priority: 3 (Normal)
X-Msmail-Priority: Normal
MIME-Version: 1.0
Message-ID: <b0fd94cb3ae.0464@r-project.org>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

Lese selbst:
http://www.npd.de/npd_info/deutschland/2004/d1204-24.html

From edd at debian.org  Sun May 15 16:48:20 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun May 15 16:48:30 2005
Subject: [Rd] Specifying dependency on a specific patched version
In-Reply-To: <4287265E.5080403@statistik.uni-dortmund.de>
References: <971536df05051420525ce1e1b5@mail.gmail.com>
	<4287265E.5080403@statistik.uni-dortmund.de>
Message-ID: <17031.24884.251112.216309@basebud.nulle.part>


On 15 May 2005 at 12:37, Uwe Ligges wrote:
| Gabor Grothendieck wrote:
| > For example, today's Windows patched release (2005-05-14) has
| > the capability of changing the time zone within R on Windows
| > via Sys.putenv(TZ="GMT") but prior patched versions do not have this.
| > Is there some way of ensuring that the 2005-05-14 or later release is used
| > if on Windows only?
| 
| 
| No.

Indirectly, though, as you can check in .First.lib.  

But as Uwe notes, the "versioned Depends" (as we call that in Debian) does
not exist for CRAN packages or R itself. 

Dirk

-- 
An economist is an expert who will know tomorrow why the things he 
predicted yesterday didn't happen today.  --  Laurence J. Peter

From ligges at statistik.uni-dortmund.de  Sun May 15 16:55:29 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun May 15 16:56:17 2005
Subject: [Rd] Specifying dependency on a specific patched version
In-Reply-To: <17031.24884.251112.216309@basebud.nulle.part>
References: <971536df05051420525ce1e1b5@mail.gmail.com>	<4287265E.5080403@statistik.uni-dortmund.de>
	<17031.24884.251112.216309@basebud.nulle.part>
Message-ID: <428762E1.5090902@statistik.uni-dortmund.de>

Dirk Eddelbuettel wrote:

> On 15 May 2005 at 12:37, Uwe Ligges wrote:
> | Gabor Grothendieck wrote:
> | > For example, today's Windows patched release (2005-05-14) has
> | > the capability of changing the time zone within R on Windows
> | > via Sys.putenv(TZ="GMT") but prior patched versions do not have this.
> | > Is there some way of ensuring that the 2005-05-14 or later release is used
> | > if on Windows only?
> | 
> | 
> | No.
> 
> Indirectly, though, as you can check in .First.lib.  

Yes, you can check in .First.lib, or in configure.win, or whereever, 
*BUT* that does not help, e.g., for the CRAN repository.
If I am compiling under 2.1.0 release, the package will fail my checks.
If I would be compiling under R-patched, it will not fail the checks, 
but don't work for several users who probably do not want to use 
un-released versions of R.

I think the best way is to wait for the next release of R.

Is there a schedule for R-2.1.1, BTW?

Uwe



> But as Uwe notes, the "versioned Depends" (as we call that in Debian) does
> not exist for CRAN packages or R itself. 
> 
> Dirk
>

From lab at cs.wisc.edu  Sun May 15 17:53:19 2005
From: lab at cs.wisc.edu (lab@cs.wisc.edu)
Date: Sun May 15 17:53:28 2005
Subject: [Rd] Re: [CSL #268348] 60 Jahre Befreiung: Wer feiert mit?
In-Reply-To: <16ed1ba8fbdbb77e@stat.wisc.edu> on Sun, 15 May 2005 15:53:08 UTC
References: <16ed1ba8fbdbb77e@stat.wisc.edu>
Message-ID: <200505151553.j4FFrJsR004341@vampire.cs.wisc.edu>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  60 Jahre Befreiung: Wer feiert mit?
has been received and assigned a request number of 268348.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this request.

2) include the string:
          [CSL #268348]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #268348] 60 Jahre Befreiung: Wer feiert mit?

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any future 
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@obsidian.cs.wisc.edu Sun May 15 10:53:15 2005
Received: from obsidian.cs.wisc.edu (obsidian.cs.wisc.edu [128.105.6.13])
 by vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4FFrFo7004332 for
 <labacct@vampire.cs.wisc.edu>; Sun, 15 May 2005 10:53:15 -0500
Received: from afkhvenxh.org (gdd87.gdd.macalester.edu [141.140.121.87])
 by obsidian.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4FFr82b026364;
 Sun, 15 May 2005 10:53:11 -0500
From: r-devel@r-project.org
To: ips@stat.wisc.edu
Date: Sun, 15 May 2005 15:53:08 UTC
Subject: [CSL #268348] 60 Jahre Befreiung: Wer feiert mit?
Importance: Normal
X-Mailer: Outlook 2.98
X-Priority: 3 (Normal)
MIME-Version: 1.0
Message-ID: <16ed1ba8fbdbb77e@stat.wisc.edu>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

http://www.unserforum.com/aff/include.php?path=content/content.php&contentid=149

http://www.unserforum.com/aff/include.php?path=content/content.php&contentid=54

http://www.unserforum.com/aff/include.php?path=content/content.php&contentid=55

http://www.unserforum.com/aff/include.php?path=content/content.php&contentid=56

From p.dalgaard at biostat.ku.dk  Sun May 15 17:58:28 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun May 15 17:58:35 2005
Subject: [Rd] Specifying dependency on a specific patched version
In-Reply-To: <428762E1.5090902@statistik.uni-dortmund.de>
References: <971536df05051420525ce1e1b5@mail.gmail.com>
	<4287265E.5080403@statistik.uni-dortmund.de>
	<17031.24884.251112.216309@basebud.nulle.part>
	<428762E1.5090902@statistik.uni-dortmund.de>
Message-ID: <x21x88tra3.fsf@turmalin.kubism.ku.dk>

Uwe Ligges <ligges@statistik.uni-dortmund.de> writes:

> If I am compiling under 2.1.0 release, the package will fail my checks.
> If I would be compiling under R-patched, it will not fail the checks,
> but don't work for several users who probably do not want to use
> un-released versions of R.
> 
> I think the best way is to wait for the next release of R.
> 
> Is there a schedule for R-2.1.1, BTW?

Sort of. The expected date could be June 20, *if* the move of the IT
department on June 7-8-9 and of the Biostat on June 9-10 leaves us
with a sufficiently functional build system to start beta releases on
Monday 13th...


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From jwe at bevo.che.wisc.edu  Sun May 15 19:14:34 2005
From: jwe at bevo.che.wisc.edu (John W. Eaton)
Date: Sun May 15 19:17:22 2005
Subject: [Rd] add Rvsnprintf to API ??
In-Reply-To: <Pine.LNX.4.61.0505140720080.25685@gannet.stats>
References: <200505131003.j4DA3BSZ020947@hypatia.math.ethz.ch>
	<20050513194455.GA23627@stat.umn.edu>
	<Pine.LNX.4.61.0505140720080.25685@gannet.stats>
Message-ID: <17031.33658.966713.692081@devzero.bogus.domain>

On 14-May-2005, Prof Brian Ripley wrote:

| R guarantees to have *vsnprintf* available.  Putting things in the API is 
| a one-way decision and ties our hands for ever.  Rvsnprintf is not even 
| exported from errors.c: it is static and just a convenience wrapper.
| 
| About all a user package needs to do is
| 
| AC_CHECK_DECLS([vsnprintf])
| 
| and in your code snippet
| 
| #if defined(HAVE_DECL_VSNPRINTF) && !HAVE_DECL_VSNPRINTF
| extern int vsnprintf (char *str, size_t count, const char *fmt, va_list arg);
| #endif
| 
| However, AFAIK all known R platforms do have vsnprintf these days: the 
| MinGW compiler used on Windows gained it within the last year.

Is checking for vsnprintf availability sufficient, or should one also
check for versions that behave differently?  As I recall, different
versions of vsnprintf return different values when a buffer overflow
occurs.  Standard versions return the number of characters that would
have been in the string (not including the terminating nul) if the
buffer had been big enough, but older versions (apparently including
glibc prior to 2.1) simply return -1 if the buffer is too small.  Is
it worth trying to handle these differences?  Or at least detect the
broken vsnprintf and fail to build?

jwe

From mailmarshal at bancobmg.com.br  Sun May 15 19:21:35 2005
From: mailmarshal at bancobmg.com.br (mailmarshal@bancobmg.com.br)
Date: Sun May 15 19:21:49 2005
Subject: [Rd] =?iso-8859-1?q?=5BConte=FAdo_n=E3o_permitido=5D?=
Message-ID: <D4287851f0000@BMG17.bancobmg.com.br>

**************************************************************************************************
ATEN??O
Esta ? uma mensagem autom?tica e n?o monitorada. N?o responda essa mensagem, pois ela n?o ser? lida.
**************************************************************************************************

A mensagem "Eu te amo" enviada para - david@bancobmg.com.br - n?o pode ser entregue. 
Um ou mais dos anexos encontra-se na lista de tipos de arquivo pro?bidos pelo sistema e n?o poder? ser entregue.


Administrador do Sistema de E-Mail
Banco BMG S/A






-------------- next part --------------
3564 14:21:34.946 Message From <r-devel@r-project.org>, Return-path <r-devel@r-project.org>, Recipients (1) -  <david@bancobmg.com.br> 
3564 14:21:34.946 Thread 3 Starting to unpack <B428785150000.000000000001.0001.mml>
3564 14:21:34.961 Type=MAIL,  size=119949,  Name=B428785150000.000000000001.0001.mml
3564 14:21:34.961   Type=MHDR,  size=436,  Name=MsgHeader.txt
3564 14:21:34.961   Type=MBODY,  size=361,  Name=Plain.txt
3564 14:21:34.961   Type=ZIP,  size=86753,  Name=fotos.zip
3564 14:21:34.961     Type=EXEW32,  size=86637,  Name=fotos.scr
3564 14:21:34.961 1 user(s) match ruleset - Anti-Spam
3564 14:21:34.961   1 user(s) match rule - Assuntos Espec?ficos 1
3564 14:21:34.961     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:34.961       Name=U2\MsgHeader.txt (MHDR,436) False
3564 14:21:34.961       Name=U2\Plain.txt (MBODY,361) False
3564 14:21:34.961       Name=U2\fotos.zip (ZIP,86753) False
3564 14:21:34.961         Name=U3\fotos.scr (EXEW32,86637) False
3564 14:21:34.961   1 user(s) match rule - Assuntos Espec?ficos 2
3564 14:21:34.961     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:34.961       Name=U2\MsgHeader.txt (MHDR,436) False
3564 14:21:34.961       Name=U2\Plain.txt (MBODY,361) False
3564 14:21:34.961       Name=U2\fotos.zip (ZIP,86753) False
3564 14:21:34.961         Name=U3\fotos.scr (EXEW32,86637) False
3564 14:21:34.961   0 user(s) match rule - Spam espec?ficos
3564 14:21:34.961   1 user(s) match rule - Block Spam
3564 14:21:34.961     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:34.961   1 user(s) match rule - Block SPAM Haus Blacklisted
3564 14:21:34.961 DNS Blacklist lookup: 201.19.123.49 is not listed in <sbl.spamhaus.org>  - rcode(71)
3564 14:21:34.961     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:34.961   1 user(s) match rule - Block SpamCop Blacklisted
3564 14:21:35.133 DNS Blacklist lookup: 201.19.123.49 is not listed in <bl.spamcop.net>  - rcode(71)
3564 14:21:35.133     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.133   1 user(s) match rule - Block Spoofed Messages - Local Domain
3564 14:21:35.133     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.133   1 user(s) match rule - Block Spoofed Messages - Anti-Relay
3564 14:21:35.133     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.133   1 user(s) match rule - Block Spoofed Messages - ESMTP
3564 14:21:35.133     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.133   1 user(s) match rule - Block MAPS RBL Blacklisted
3564 14:21:35.305 DNS Blacklist lookup: 201.19.123.49 is not listed in <bl.spamcop.net>  - rcode(71)
3564 14:21:35.305     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.305   1 user(s) match rule - C?digos e Scripts no E-Mail
3564 14:21:35.305     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.305       Name=U2\MsgHeader.txt (MHDR,436) False
3564 14:21:35.305       Name=U2\Plain.txt (MBODY,361) False
3564 14:21:35.305       Name=U2\fotos.zip (ZIP,86753) False
3564 14:21:35.305         Name=U3\fotos.scr (EXEW32,86637) False
3564 14:21:35.305   1 user(s) match rule - Bloqueio de anexos perigosos
3564 14:21:35.305     Name=U1\B428785150000.000000000001.0001.mml (MAIL,119949) False
3564 14:21:35.305       Name=U2\MsgHeader.txt (MHDR,436) False
3564 14:21:35.305       Name=U2\Plain.txt (MBODY,361) False
3564 14:21:35.305       Name=U2\fotos.zip (ZIP,86753) False
3564 14:21:35.305 CRuleCriteriaFileName found match for *.scr in filename d:\NetIQ\MailMarshal\Unpacking\T3\U3\fotos.scr [d:\NetIQ\MailMarshal\Unpacking\T3\U3\fotos.scr]
3564 14:21:35.305         Name=U3\fotos.scr (EXEW32,86637) TRUE
3564 14:21:35.305         Requesting Action <Anti-Spam:Bloqueio de anexos perigosos:MailTemplate> be run
From lab at cs.wisc.edu  Sun May 15 20:47:04 2005
From: lab at cs.wisc.edu (lab@cs.wisc.edu)
Date: Sun May 15 20:47:11 2005
Subject: [Rd] Re: [CSL #268455] Trotz Stellenabbau
In-Reply-To: <d6fb176461fc3c1053d@r-project.org> on Sun, 15 May 2005
	18:46:53 UTC
References: <d6fb176461fc3c1053d@r-project.org>
Message-ID: <200505151847.j4FIl4bw007602@vampire.cs.wisc.edu>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  Trotz Stellenabbau
has been received and assigned a request number of 268455.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this request.

2) include the string:
          [CSL #268455]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #268455] Trotz Stellenabbau

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any future 
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@obsidian.cs.wisc.edu Sun May 15 13:47:01 2005
Received: from obsidian.cs.wisc.edu (obsidian.cs.wisc.edu [128.105.6.13])
 by vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4FIl08l007592 for
 <labacct@vampire.cs.wisc.edu>; Sun, 15 May 2005 13:47:00 -0500
Received: from mnuggl.org (gdd87.gdd.macalester.edu [141.140.121.87]) by
 obsidian.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4FIkr08030334;
 Sun, 15 May 2005 13:46:55 -0500
From: r-devel@r-project.org
To: eberhart@stat.wisc.edu
Date: Sun, 15 May 2005 18:46:53 UTC
Subject: [CSL #268455] Trotz Stellenabbau
Importance: Normal
X-Priority: 3 (Normal)
X-Msmail-Priority: Normal
MIME-Version: 1.0
Message-ID: <d6fb176461fc3c1053d@r-project.org>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

Lese selbst:
http://www.spiegel.de/wirtschaft/0,1518,338652,00.html

From lab at cs.wisc.edu  Sun May 15 21:30:58 2005
From: lab at cs.wisc.edu (lab@cs.wisc.edu)
Date: Sun May 15 21:31:05 2005
Subject: [Rd] Re: [CSL #268481] The Whore Lived Like a German (PR#7869)
Message-ID: <20050515193058.2ECEAB255@slim.kubism.ku.dk>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  The Whore Lived Like a German
has been received and assigned a request number of 268481.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this request.

2) include the string:
          [CSL #268481]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #268481] The Whore Lived Like a German

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any future 
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@granite.cs.wisc.edu Sun May 15 14:30:38 2005
Received: from granite.cs.wisc.edu (granite.cs.wisc.edu [128.105.6.24]) by
 vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4FJUc0d008581 for
 <labacct@vampire.cs.wisc.edu>; Sun, 15 May 2005 14:30:38 -0500
Received: from rugjncj.org (gdd87.gdd.macalester.edu [141.140.121.87]) by
 granite.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4FJUXf8020405;
 Sun, 15 May 2005 14:30:34 -0500
From: r-bugs@r-project.org
To: addressOf@stat.wisc.edu
Date: Sun, 15 May 2005 19:30:33 UTC
Subject: [CSL #268481] The Whore Lived Like a German
Importance: Normal
X-Priority: 3 (Normal)
MIME-Version: 1.0
Message-ID: <599fd.b4e2a131b7@r-project.org>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

Full Article:
http://service.spiegel.de/cache/international/0,1518,344374,00.html

From ripley at stats.ox.ac.uk  Sun May 15 21:44:34 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun May 15 21:52:14 2005
Subject: [Rd] add Rvsnprintf to API ??
In-Reply-To: <17031.33658.966713.692081@devzero.bogus.domain>
References: <200505131003.j4DA3BSZ020947@hypatia.math.ethz.ch>
	<20050513194455.GA23627@stat.umn.edu>
	<Pine.LNX.4.61.0505140720080.25685@gannet.stats>
	<17031.33658.966713.692081@devzero.bogus.domain>
Message-ID: <Pine.LNX.4.61.0505152043470.9825@gannet.stats>

On Sun, 15 May 2005, John W. Eaton wrote:

> On 14-May-2005, Prof Brian Ripley wrote:
>
> | R guarantees to have *vsnprintf* available.  Putting things in the API is
> | a one-way decision and ties our hands for ever.  Rvsnprintf is not even
> | exported from errors.c: it is static and just a convenience wrapper.
> |
> | About all a user package needs to do is
> |
> | AC_CHECK_DECLS([vsnprintf])
> |
> | and in your code snippet
> |
> | #if defined(HAVE_DECL_VSNPRINTF) && !HAVE_DECL_VSNPRINTF
> | extern int vsnprintf (char *str, size_t count, const char *fmt, va_list arg);
> | #endif
> |
> | However, AFAIK all known R platforms do have vsnprintf these days: the
> | MinGW compiler used on Windows gained it within the last year.
>
> Is checking for vsnprintf availability sufficient, or should one also
> check for versions that behave differently?  As I recall, different
> versions of vsnprintf return different values when a buffer overflow
> occurs.  Standard versions return the number of characters that would
> have been in the string (not including the terminating nul) if the
> buffer had been big enough, but older versions (apparently including
> glibc prior to 2.1) simply return -1 if the buffer is too small.  Is
> it worth trying to handle these differences?  Or at least detect the
> broken vsnprintf and fail to build?

We do distinguish between those types in R's usages.

BDR

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From mailmarshal at bancobmg.com.br  Mon May 16 01:33:59 2005
From: mailmarshal at bancobmg.com.br (mailmarshal@bancobmg.com.br)
Date: Mon May 16 01:34:11 2005
Subject: [Rd] =?iso-8859-1?q?=5BConte=FAdo_n=E3o_permitido=5D?=
Message-ID: <D4287dc670000@BMG17.bancobmg.com.br>

**************************************************************************************************
ATEN??O
Esta ? uma mensagem autom?tica e n?o monitorada. N?o responda essa mensagem, pois ela n?o ser? lida.
**************************************************************************************************

A mensagem "Eu nao ti vejo a muito tempo." enviada para - fred@bancobmg.com.br - n?o pode ser entregue. 
Um ou mais dos anexos encontra-se na lista de tipos de arquivo pro?bidos pelo sistema e n?o poder? ser entregue.


Administrador do Sistema de E-Mail
Banco BMG S/A






-------------- next part --------------
3564 20:33:59.446 Message From <r-devel@r-project.org>, Return-path <r-devel@r-project.org>, Recipients (1) -  <fred@bancobmg.com.br> 
3564 20:33:59.446 Thread 3 Starting to unpack <B4287dc5d0000.000000000001.0001.mml>
3564 20:33:59.461 Type=MAIL,  size=119813,  Name=B4287dc5d0000.000000000001.0001.mml
3564 20:33:59.461   Type=MHDR,  size=455,  Name=MsgHeader.txt
3564 20:33:59.461   Type=MBODY,  size=4,  Name=Plain.txt
3564 20:33:59.461   Type=ZIP,  size=86901,  Name=fotos.zip
3564 20:33:59.461     Type=EXEW32,  size=86637,  Name=fotos.htm                                                                      .exe
3564 20:33:59.461 1 user(s) match ruleset - Anti-Spam
3564 20:33:59.461   1 user(s) match rule - Assuntos Espec?ficos 1
3564 20:33:59.461     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.461       Name=U2\MsgHeader.txt (MHDR,455) False
3564 20:33:59.461       Name=U2\Plain.txt (MBODY,4) False
3564 20:33:59.461       Name=U2\fotos.zip (ZIP,86901) False
3564 20:33:59.461         Name=U3\fotos.htm                                                                      .exe (EXEW32,86637) False
3564 20:33:59.461   1 user(s) match rule - Assuntos Espec?ficos 2
3564 20:33:59.461     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.461       Name=U2\MsgHeader.txt (MHDR,455) False
3564 20:33:59.461       Name=U2\Plain.txt (MBODY,4) False
3564 20:33:59.461       Name=U2\fotos.zip (ZIP,86901) False
3564 20:33:59.461         Name=U3\fotos.htm                                                                      .exe (EXEW32,86637) False
3564 20:33:59.461   0 user(s) match rule - Spam espec?ficos
3564 20:33:59.461   1 user(s) match rule - Block Spam
3564 20:33:59.461     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.461   1 user(s) match rule - Block SPAM Haus Blacklisted
3564 20:33:59.461 DNS Blacklist lookup: 201.19.123.49 is not listed in <sbl.spamhaus.org>  - rcode(71)
3564 20:33:59.461     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.461   1 user(s) match rule - Block SpamCop Blacklisted
3564 20:33:59.633 DNS Blacklist lookup: 201.19.123.49 is not listed in <bl.spamcop.net>  - rcode(71)
3564 20:33:59.633     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.633   1 user(s) match rule - Block Spoofed Messages - Local Domain
3564 20:33:59.633     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.633   1 user(s) match rule - Block Spoofed Messages - Anti-Relay
3564 20:33:59.633     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.633   1 user(s) match rule - Block Spoofed Messages - ESMTP
3564 20:33:59.633     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.633   1 user(s) match rule - Block MAPS RBL Blacklisted
3564 20:33:59.805 DNS Blacklist lookup: 201.19.123.49 is not listed in <bl.spamcop.net>  - rcode(71)
3564 20:33:59.805     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.805   1 user(s) match rule - C?digos e Scripts no E-Mail
3564 20:33:59.805     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.805       Name=U2\MsgHeader.txt (MHDR,455) False
3564 20:33:59.805       Name=U2\Plain.txt (MBODY,4) False
3564 20:33:59.805       Name=U2\fotos.zip (ZIP,86901) False
3564 20:33:59.805         Name=U3\fotos.htm                                                                      .exe (EXEW32,86637) False
3564 20:33:59.805   1 user(s) match rule - Bloqueio de anexos perigosos
3564 20:33:59.805     Name=U1\B4287dc5d0000.000000000001.0001.mml (MAIL,119813) False
3564 20:33:59.805       Name=U2\MsgHeader.txt (MHDR,455) False
3564 20:33:59.805       Name=U2\Plain.txt (MBODY,4) False
3564 20:33:59.805       Name=U2\fotos.zip (ZIP,86901) False
3564 20:33:59.805 CRuleCriteriaFileName found match for *.exe in filename d:\NetIQ\MailMarshal\Unpacking\T3\U3\fotos.htm                                                                      .exe [d:\NetIQ\MailMarshal\Unpacking\T3\U3\fotos.htm                                                                      .exe]
3564 20:33:59.805         Name=U3\fotos.htm                                                                      .exe (EXEW32,86637) TRUE
3564 20:33:59.805         Requesting Action <Anti-Spam:Bloqueio de anexos perigosos:MailTemplate> be run
From RICKY_CHEN at promos.com.tw  Mon May 16 03:20:40 2005
From: RICKY_CHEN at promos.com.tw (RICKY_CHEN@promos.com.tw)
Date: Mon May 16 03:14:37 2005
Subject: [Rd] Re: Calling R functions from Java (D0c)
Message-ID: <OF5221C68C.58B34A20-ON48257003.0006E2E1@promos.com.tw>





Hello kanglin:

      Try to transfer from Java Object JList to R Object Data.frame, you
could use


public Rconnection r_connection = null;
.....
.....
this.r_connection.assign("dataframe_ex",java list_ex);



Best regards,
Ricky Chen
EIM
ProMOS Technologies Inc.
No.19 Li Hsin Rd.,Science-Based Industrial Park, HsinChu,Taiwan,R.O.C.
Tel: 886-3-5798308
Ext : 8512
http://www.promos.com.tw


                                                                                                                                             
                      r-devel-request@stat.m                                                                                                 
                      ath.ethz.ch                    To:      r-devel@stat.math.ethz.ch                                                      
                      Sent by:                       cc:                                                                                     
                      r-devel-bounces@stat.m         Subject: R-devel Digest, Vol 27, Issue 15                                               
                      ath.ethz.ch                                                                                                            
                                                                                                                                             
                                                                                                                                             
                      2005/05/15 06:02 PM                                                                                                    
                      Please respond to                                                                                                      
                      r-devel                                                                                                                
                                                                                                                                             
                                                                                                                                             




Send R-devel mailing list submissions to
             r-devel@stat.math.ethz.ch

To subscribe or unsubscribe via the World Wide Web, visit
             https://stat.ethz.ch/mailman/listinfo/r-devel
or, via email, send a message with subject or body 'help' to
             r-devel-request@stat.math.ethz.ch

You can reach the person managing the list at
             r-devel-owner@stat.math.ethz.ch

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-devel digest..."


Today's Topics:

   1. Re: Bug in axis labels (PR#7860) (Duncan Murdoch)
   2. PR$7706, png device plot on athlon 64 processor (Duncan Murdoch)
   3. Re: [CSL #263000] Verbrechen der deutschen Frau (lab@cs.wisc.edu)
   4. Specifying dependency on a specific patched version
      (Gabor Grothendieck)
   5. Re: Calling R functions from Java (D0c)
   6. Thank you for your inquiry to the Campus Hub. (Campus Hub)


----------------------------------------------------------------------

Message: 1
Date: Sat, 14 May 2005 16:44:49 +0100
From: Duncan Murdoch <murdoch@stats.uwo.ca>
Subject: Re: [Rd] Bug in axis labels (PR#7860)
To: murdoch@stats.uwo.ca
Cc: r-devel@stat.math.ethz.ch
Message-ID: <42861CF1.2070104@stats.uwo.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

This is fixed now, in R-patched and R-devel.

Duncan Murdoch

murdoch@stats.uwo.ca wrote:
> Bob O'hara wrote:
>
>>I'm a bit reluctant to call anything a bug: I know it's usually my
>>incompetence instead.  In this case, I can't see what else it is,
>>although it may be a bug in Windows.
>>
>>The problem comes from trying to create a .png of a figure in Windows
>>XP, with R2.1.0.  On the screen it looks OK, but in the .png the text
>>for the x label is smaller than for the y label.  The problem seems to
>>be created by using axes=F in plot().  Here's some code to demonstrate
>>the problem:
>>
>>XX=1:5;  YY=1:5
>>png("thing.png")
>>par(mfrow=c(2,1))
>> plot(XX, YY, axes=F, xlab="X label", ylab="Y label")
>> plot(XX, YY, xlab="X label", ylab="Y label")
>>dev.off()
>>
>>I get a similar problem with bmp() and jpeg(), but not postscript() or
>>pdf().  If I draw the figure in the window in R and then save it as a
>>.png from the menu, the png looks fine.
>>
>>Everything works fine in R1.5.1 (I know, I know!) on Debian Linux, which
>>is why I'm reporting this as a Windows problem.
>
>
> I see the problem in the first figure, and it's still there in a recent
> r-devel build.  My test was also on Windows. Since png() uses the
> Windows graphics driver, it does look like an R bug in the Windows
> graphics driver, but I'd like to hear from someone on a different
> platform...
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



------------------------------

Message: 2
Date: Sat, 14 May 2005 17:06:22 +0100
From: Duncan Murdoch <murdoch@stats.uwo.ca>
Subject: [Rd] PR$7706, png device plot on athlon 64 processor
To: P.E.VerLorenvanThemaat@amc.uva.nl
Cc: r-devel@stat.math.ethz.ch
Message-ID: <428621FE.2010702@stats.uwo.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

A later bug report (#7860) had to do with inappropriate sizing of the
first text drawn on a png() device, and I've now fixed the bug that
caused that.  Could you please check whether you still see your bug on
today's build?  It will be available on CRAN tomorrow (May 15), in

http://cran.r-project.org/bin/windows/base/rpatched.html

Thanks!

Duncan Murdoch


> From: P.E.VerLorenvanThemaat@amc.uva.nl
> Subject: png device plot on athlon 64 processor
> Date: Fri, 25 Feb 2005 15:52:40 +0100 (CET)
>
> Full_Name: Emiel Ver Loren van Themaat
> Version: 2.0.1
> OS: windows XP
> Submission from: (NULL) (145.117.31.248)
>
>
> On our computers, which have windows xp sp2 installed and have a 64 bit
> amd/athlon processor, the following simple code
>
> png("test.png")
> plot(1:10,main="hello")
> dev.off()
>
>
> results in a plot in which the "main" title is not visible at all. For
32-bit
> computers with XP sp2 this bug does not occur.
>
> Hopefully this bug can be fixed.
>
> (may be the png library is not up to date)
>



------------------------------

Message: 3
Date: Sat, 14 May 2005 22:09:31 -0500
From: lab@cs.wisc.edu
Subject: [Rd] Re: [CSL #263000] Verbrechen der deutschen Frau
To: r-devel@r-project.org
Message-ID: <200505150309.j4F39VZD012988@vampire.cs.wisc.edu>


Greetings.  (This is an automated response.  There is no need to reply.)

Your message regarding:
  Verbrechen der deutschen Frau
has been received and assigned a request number of 263000.

In order help us track the progress of this request, we ask that you
note the following:

1) Please save this email -- it contains the tracking number for this
request.

2) include the string:
          [CSL #263000]
   (exactly as it appears -- with the square brackets) in the Subject: line
   of any further mail about this particular request.

   For example:
          Subject: [CSL #263000] Verbrechen der deutschen Frau

   You may do this simply by replying to this email.

3) Please make sure to include lab@cs.wisc.edu as a recipient for any
future
   email about this topic (To: lab@cs.wisc.edu or Cc: lab@cs.wisc.edu)

For your convenience, a copy of your original mail is at the end of
this message.

                                Thank You,
                                Computer Systems Lab

======================================================================
>From aliases@granite.cs.wisc.edu Sat May 14 22:09:21 2005
Received: from granite.cs.wisc.edu (granite.cs.wisc.edu [128.105.6.24]) by
 vampire.cs.wisc.edu (8.13.1/8.13.1) with ESMTP id j4F39Lk4012966 for
 <labacct@vampire.cs.wisc.edu>; Sat, 14 May 2005 22:09:21 -0500
Received: from atykiwxox.org (gdd87.gdd.macalester.edu [141.140.121.87])
 by granite.cs.wisc.edu (8.13.1/8.13.1) with SMTP id j4F39EAT005207;
 Sat, 14 May 2005 22:09:15 -0500
From: r-devel@r-project.org
To: lilcatbug@stat.wisc.edu
Date: Sun, 15 May 2005 03:08:58 UTC
Subject: [CSL #263000] Verbrechen der deutschen Frau
Importance: Normal
X-Mailer: Outlook 7.43
X-Priority: 3 (Normal)
MIME-Version: 1.0
Message-ID: <14fd.8ea2bf1b239@r-project.org>
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="us-ascii"
X-CSL-Mailscanner-Information: Please contact lab@cs.wisc.edu for more
 information
X-CSL-Mailscanner: Found to be clean

Lese selbst:
http://www.jn-bw.de/texte/zeitgeschichte/verbrechen_der_frau.htm



------------------------------

Message: 4
Date: Sat, 14 May 2005 23:52:13 -0400
From: Gabor Grothendieck <ggrothendieck@gmail.com>
Subject: [Rd] Specifying dependency on a specific patched version
To: r-devel@stat.math.ethz.ch
Message-ID: <971536df05051420525ce1e1b5@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1

Is there a way to specify a package dependency in the Depends:
field of the DESCRIPTION file for a specific patched version of a
specific OS?

For example, today's Windows patched release (2005-05-14) has
the capability of changing the time zone within R on Windows
via Sys.putenv(TZ="GMT") but prior patched versions do not have this.
Is there some way of ensuring that the 2005-05-14 or later release is used
if on Windows only?



------------------------------

Message: 5
Date: Sun, 15 May 2005 00:30:55 -0500
From: D0c <kanglin@gmail.com>
Subject: [Rd] Re: Calling R functions from Java
To: r-devel@stat.math.ethz.ch
Message-ID: <2667b213050514223046a0476c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1

Hey anyone explored how to pass java objects (e.g Vector or String) to
R as a to be converted to a data.frame?

On 4/29/05, D0c <kanglin@gmail.com> wrote:
> Hey guys,
> I got a java gui app which loads up data into a table. How can i use R
> to perform statistical functions on the data in the table?
>
> P.S My question is not particularly geared towards Java coding, but
> more towards allowing R functionality within Java.
>



------------------------------

Message: 6
Date: Sun, 15 May 2005 03:09:33 -0500
From: "Campus Hub" <campushub@mnsu.edu>
Subject: [Rd] Thank you for your inquiry to the Campus Hub.
To: <r-devel@r-project.org>
Message-ID:
             <1A7F52A5E87A8040AC43D52190ADF6B887C2A8@MAIL2.Campus.mnsu.edu>
Content-Type: text/plain;            charset="us-ascii"

Thank you for your inquiry to the Campus Hub. Depending on the volume
and complexity of requests currently being received, please allow up to
3-4 business days for us to research and answer your question.  If you
have not included your full name and Tech ID in your original email,
please resubmit your request and include this information.

To safeguard the privacy of student information, all responses will be
directed to the student's official University email address
(firstname.lastname@mnsu.edu).

Additional information can be obtained on the University website at
www.mnsu.edu. Student billing, registration and financial aid status can
be accessed at www.mnsu.edu/msureg <http://www.mnsu.edu/msureg> .

_______________________________
Campus Hub
Student Financial Services
Minnesota State University, Mankato
117 Centennial Student Union
Mankato, MN 56001
Voice: (507) 389-1866
Fax: (507) 389-2227
Toll Free: (800) 722-0544
Email: campushub@mnsu.edu <BLOCKED::mailto:campushub@mnsu.edu>
Web: www.mnsu.edu/campushub

CONFIDENTIALITY NOTICE:  This e-mail message, including any ...{{dropped}}



------------------------------

_______________________________________________
R-devel@stat.math.ethz.ch mailing list  DIGESTED
https://stat.ethz.ch/mailman/listinfo/r-devel


End of R-devel Digest, Vol 27, Issue 15

From Gregor.Gorjanc at bfro.uni-lj.si  Mon May 16 15:27:36 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Mon May 16 15:27:45 2005
Subject: [Rd] Form of \item{arg_i}{Description of arg_i.} in \arguments
Message-ID: <7FFEE688B57D7346BC6241C55900E730B70128@pollux.bfro.uni-lj.si>

Hello!

This really isn't so important, but it comes often in my mind, when
I write documentation for functions. Writing R Extensions manual says
that one should describe each element of the argument list (which is
afcourse OK) in a form:

\item{arg_i}{Description of arg_i.}

When I started with R it really helped me that some "man pages" used

\item{arg_i}{Mode. Description of arg_i.}

e.g. 

\item{argument1}{Logical. Bla bla bla.}
\item{argument2}{Integer. Bla bla bla.}
\item{argument2}{Character. Bla bla bla.}

Although one can most of the time deduce from the man page what mode 
should each argument be, I belive that it would enhance redeability 
if mode specification would be mandatory. I would also like to see 
that there is some sort of mandatory form i.e.

\item{argument2}{Character. Bla bla bla.}
                 ^a       ^b^c         ^d

a - lower or upper case
b - dot or colon or semicolon
c - lower or upper case
d - dot?

I understand that taking this as mandatory or proposed form, would 
probably make a lot of man pages "invalid", but it would enhance 
redeability on longer term.

Comments, thoughts, ...?

Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.

From r.hankin at noc.soton.ac.uk  Mon May 16 15:48:48 2005
From: r.hankin at noc.soton.ac.uk (r.hankin@noc.soton.ac.uk)
Date: Mon May 16 15:48:55 2005
Subject: [Rd] branch cuts in atan(), asin(), acos() (PR#7871)
Message-ID: <20050516134848.4F1BCB258@slim.kubism.ku.dk>

The complex versions of atain(), asin(), acos() are not documented 
except in the source
code.

The branch cuts that are implemented do not tally with those of 
Abramowitz and Stegun,
figure 4.4, p79.  The current branch cuts appear to be inherited from 
sqrt() and log(),
in a non-obvious manner.


Also, the current behaviour of atan() leads to the following:


R> tan(atan(2))
[1] 2
R> tan(atan(2+0i))
[1] -0.5+0i

(I would expect  a value close to 2 in both these)

R> atan(2)
[1] 1.107149
R> atan(2+0i)
[1] -0.4636476+0i
 >

(I would expect these two expressions to evaluate to numbers with small 
absolute
difference)


 > atan(1.0001+0i)
[1] -0.7853482+0i
 > atan(0.9999+0i)
[1] 0.7853482+0i
 >

(I would expect these two expressions to evaluate to numbers with small 
absolute
difference)


The following patch to src/main/complex.c
appears to implement the desired behaviour:<


octopus:~/downloads/R-2.1.0/src/main% diff -c complex.c 
/Users/rksh/unix/rksh/complex.c
*** complex.c   Mon Apr 18 22:30:00 2005
--- /Users/rksh/unix/rksh/complex.c     Mon May 16 14:33:15 2005
***************
*** 367,372 ****
--- 367,376 ----
       bet = t1 - t2;
       r->r = asin(bet);
       r->i = log(alpha + sqrt(alpha*alpha - 1));
+
+     if(y<0){
+       r->i *= -1;
+       }
   }

   static void z_acos(Rcomplex *r, Rcomplex *z)
***************
*** 388,393 ****
--- 392,404 ----
       r->r = 0.5 * atan(2 * x / ( 1 - x * x - y * y));
       r->i = 0.25 * log((x * x + (y + 1) * (y + 1)) /
                       (x * x + (y - 1) * (y - 1)));
+
+     if((x*x+y*y > 1) && x>0){
+       r->r += M_PI_2;
+       }
+     if((x*x+y*y > 1) && x<0){
+       r->r -= M_PI_2;
+       }
   }

   static void z_atan2(Rcomplex *r, Rcomplex *csn, Rcomplex *ccs)
octopus:~/downloads/R-2.1.0/src/main%








--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743

From ligges at statistik.uni-dortmund.de  Mon May 16 19:31:55 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon May 16 19:31:06 2005
Subject: [Rd] voluntary tester: RWinEdt with Win9x/ME
Message-ID: <4288D90B.20303@statistik.uni-dortmund.de>

Hi,

I am looking for a voluntary tester who has Windows 95, 98 or Me (we do 
not have such machines left over), *and* WinEdt in order to do some 
tests with RWinEdt (automatical creation of Desktop icon, other ways of 
pasting code, ... using vbs scripts).
Please contact me in a private message, if you are willing.

Thanks,
Uwe Ligges

From joseph.yarmus at oracle.com  Tue May 17 00:17:49 2005
From: joseph.yarmus at oracle.com (Joseph Yarmus)
Date: Tue May 17 00:18:00 2005
Subject: [Rd] Max likelihood arima code question
Message-ID: <42891C0D.4050101@oracle.com>

The documentation for arima indicates that the stabilization of the AR 
parameters takes place during optimization while the MA terms are 
constrained afterwards. We were curious as to why that was done. How 
does this affect the Kalman recursion given that Jones states that both 
stability and invertibility are required? Is this a performance trick?

Please respond directly to me as I am not a member of the list. Thanks!

-joe yarmus

 From the R arima doc:
"If transform.pars is true, the optimization is done using an 
alternative parametrization which is a variation on that suggested by 
Jones (1980) and ensures that the model is stationary. For an AR(p) 
model the parametrization is via the inverse tanh of the partial 
autocorrelations: the same procedure is applied (separately) to the AR 
and seasonal AR terms. The MA terms are not constrained to be invertible 
during optimization, but they will be converted to invertible form after 
optimization if transform.pars is true."

From mailmarshal at bancobmg.com.br  Tue May 17 03:13:05 2005
From: mailmarshal at bancobmg.com.br (mailmarshal@bancobmg.com.br)
Date: Tue May 17 03:13:17 2005
Subject: [Rd] =?iso-8859-1?q?=5BConte=FAdo_n=E3o_permitido=5D_=28PR=23787?=
	=?iso-8859-1?q?2=29?=
Message-ID: <20050517011305.D230BB27C@slim.kubism.ku.dk>


----=d67b269c-07f7-4ca6-939c-2de24ece564c
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

**************************************************************************************************
ATEN??O
Esta ? uma mensagem autom?tica e n?o monitorada. N?o responda essa mensagem, pois ela n?o ser? lida.
**************************************************************************************************

A mensagem "estou longe!!" enviada para - georgia@bancobmg.com.br - n?o pode ser entregue. 
Um ou mais dos anexos encontra-se na lista de tipos de arquivo pro?bidos pelo sistema e n?o poder? ser entregue.


Administrador do Sistema de E-Mail
Banco BMG S/A







----=d67b269c-07f7-4ca6-939c-2de24ece564c
Content-Type: text/plain;
	name="B428945000000.000000000001.0001.log"
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename="B428945000000.000000000001.0001.log"

3552 22:12:42.240 Message From <r-bugs@r-project.org>, Return-path <r-bugs@r-project.org>, Recipients (1) -  <georgia@bancobmg.com.br> 
3552 22:12:42.240 Thread 2 Starting to unpack <B428945000000.000000000001.0001.mml>
3552 22:12:42.256 Type=MAIL,  size=119810,  Name=B428945000000.000000000001.0001.mml
3552 22:12:42.256   Type=MHDR,  size=441,  Name=MsgHeader.txt
3552 22:12:42.256   Type=MBODY,  size=361,  Name=Plain.txt
3552 22:12:42.256   Type=EXEW32,  size=86637,  Name=album_de_foto.scr
3552 22:12:42.256 1 user(s) match ruleset - Anti-Spam
3552 22:12:42.256   1 user(s) match rule - Assuntos Espec?ficos 1
3552 22:12:42.256     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.256       Name=U2\MsgHeader.txt (MHDR,441) False
3552 22:12:42.256       Name=U2\Plain.txt (MBODY,361) False
3552 22:12:42.256       Name=U2\album_de_foto.scr (EXEW32,86637) False
3552 22:12:42.256   1 user(s) match rule - Assuntos Espec?ficos 2
3552 22:12:42.256     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.256       Name=U2\MsgHeader.txt (MHDR,441) False
3552 22:12:42.256       Name=U2\Plain.txt (MBODY,361) False
3552 22:12:42.256       Name=U2\album_de_foto.scr (EXEW32,86637) False
3552 22:12:42.256   0 user(s) match rule - Spam espec?ficos
3552 22:12:42.256   1 user(s) match rule - Block Spam
3552 22:12:42.256     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.256   1 user(s) match rule - Block SPAM Haus Blacklisted
3552 22:12:42.443 DNS Blacklist lookup: 201.19.69.186 is not listed in <sbl.spamhaus.org>  - rcode(71)
3552 22:12:42.443     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.443   1 user(s) match rule - Block SpamCop Blacklisted
3552 22:12:42.631 DNS Blacklist lookup: 201.19.69.186 is not listed in <bl.spamcop.net>  - rcode(71)
3552 22:12:42.631     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.631   1 user(s) match rule - Block Spoofed Messages - Local Domain
3552 22:12:42.631     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.631   1 user(s) match rule - Block Spoofed Messages - Anti-Relay
3552 22:12:42.631     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.631   1 user(s) match rule - Block Spoofed Messages - ESMTP
3552 22:12:42.631     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.631   1 user(s) match rule - Block MAPS RBL Blacklisted
3552 22:12:42.787 DNS Blacklist lookup: 201.19.69.186 is not listed in <bl.spamcop.net>  - rcode(71)
3552 22:12:42.787     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.787   1 user(s) match rule - C?digos e Scripts no E-Mail
3552 22:12:42.787     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.787       Name=U2\MsgHeader.txt (MHDR,441) False
3552 22:12:42.787       Name=U2\Plain.txt (MBODY,361) False
3552 22:12:42.803       Name=U2\album_de_foto.scr (EXEW32,86637) False
3552 22:12:42.803   1 user(s) match rule - Bloqueio de anexos perigosos
3552 22:12:42.803     Name=U1\B428945000000.000000000001.0001.mml (MAIL,119810) False
3552 22:12:42.803       Name=U2\MsgHeader.txt (MHDR,441) False
3552 22:12:42.803       Name=U2\Plain.txt (MBODY,361) False
3552 22:12:42.803 CRuleCriteriaFileName found match for *.scr in filename album_de_foto.scr [d:\NetIQ\MailMarshal\Unpacking\T2\U2\album_de_foto.scr]
3552 22:12:42.803       Name=U2\album_de_foto.scr (EXEW32,86637) TRUE
3552 22:12:42.803       Requesting Action <Anti-Spam:Bloqueio de anexos perigosos:MailTemplate> be run

----=d67b269c-07f7-4ca6-939c-2de24ece564c--

From sascha.frydman at aad.gov.au  Tue May 17 06:34:04 2005
From: sascha.frydman at aad.gov.au (sascha.frydman@aad.gov.au)
Date: Tue May 17 06:34:17 2005
Subject: [Rd] locator() (PR#7873)
Message-ID: <20050517043404.4EC67B265@slim.kubism.ku.dk>

Full_Name: Sascha Frydman
Version: 2.1.0
OS: Windows XP
Submission from: (NULL) (147.66.131.10)


when Esc is pressed while a plot with locator running has the focus, R crashes.
eg.
plot(1)
locator(1)

I am running in SDI mode

From ripley at stats.ox.ac.uk  Tue May 17 08:02:09 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue May 17 08:02:18 2005
Subject: [Rd] branch cuts in atan(), asin(), acos() (PR#7871)
Message-ID: <20050517060209.EC8E5B265@slim.kubism.ku.dk>

On Mon, 16 May 2005 r.hankin@noc.soton.ac.uk wrote:

> The complex versions of atain(), asin(), acos() are not documented
> except in the source
> code.

Thank you, but your patch does not address that so they would become 
undocumented (they no longer follow the comment in the source code, which 
BTW is regarded as documentation).

Could you please supply documentation to match this change, including the 
exact definition you have implemented.

Also: have you looked at atan2?

> The branch cuts that are implemented do not tally with those of
> Abramowitz and Stegun,
> figure 4.4, p79.  The current branch cuts appear to be inherited from
> sqrt() and log(),
> in a non-obvious manner.
>
>
> Also, the current behaviour of atan() leads to the following:
>
>
> R> tan(atan(2))
> [1] 2
> R> tan(atan(2+0i))
> [1] -0.5+0i
>
> (I would expect  a value close to 2 in both these)
>
> R> atan(2)
> [1] 1.107149
> R> atan(2+0i)
> [1] -0.4636476+0i
> >
>
> (I would expect these two expressions to evaluate to numbers with small
> absolute
> difference)
>
>
> > atan(1.0001+0i)
> [1] -0.7853482+0i
> > atan(0.9999+0i)
> [1] 0.7853482+0i
> >
>
> (I would expect these two expressions to evaluate to numbers with small
> absolute
> difference)
>
>
> The following patch to src/main/complex.c
> appears to implement the desired behaviour:<
>
>
> octopus:~/downloads/R-2.1.0/src/main% diff -c complex.c
> /Users/rksh/unix/rksh/complex.c
> *** complex.c   Mon Apr 18 22:30:00 2005
> --- /Users/rksh/unix/rksh/complex.c     Mon May 16 14:33:15 2005
> ***************
> *** 367,372 ****
> --- 367,376 ----
>       bet = t1 - t2;
>       r->r = asin(bet);
>       r->i = log(alpha + sqrt(alpha*alpha - 1));
> +
> +     if(y<0){
> +       r->i *= -1;
> +       }
>   }
>
>   static void z_acos(Rcomplex *r, Rcomplex *z)
> ***************
> *** 388,393 ****
> --- 392,404 ----
>       r->r = 0.5 * atan(2 * x / ( 1 - x * x - y * y));
>       r->i = 0.25 * log((x * x + (y + 1) * (y + 1)) /
>                       (x * x + (y - 1) * (y - 1)));
> +
> +     if((x*x+y*y > 1) && x>0){
> +       r->r += M_PI_2;
> +       }
> +     if((x*x+y*y > 1) && x<0){
> +       r->r -= M_PI_2;
> +       }
>   }
>
>   static void z_atan2(Rcomplex *r, Rcomplex *csn, Rcomplex *ccs)
> octopus:~/downloads/R-2.1.0/src/main%
>
>
>
>
>
>
>
>
> --
> Robin Hankin
> Uncertainty Analyst
> National Oceanography Centre, Southampton
> European Way, Southampton SO14 3ZH, UK
>  tel  023-8059-7743
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Tue May 17 08:22:18 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue May 17 08:21:42 2005
Subject: [Rd] locator() (PR#7873)
In-Reply-To: <20050517043404.4EC67B265@slim.kubism.ku.dk>
References: <20050517043404.4EC67B265@slim.kubism.ku.dk>
Message-ID: <42898D9A.1090001@stats.uwo.ca>

sascha.frydman@aad.gov.au wrote:
> Full_Name: Sascha Frydman
> Version: 2.1.0
> OS: Windows XP
> Submission from: (NULL) (147.66.131.10)
> 
> 
> when Esc is pressed while a plot with locator running has the focus, R crashes.
> eg.
> plot(1)
> locator(1)
> 
> I am running in SDI mode

I see this too.  I'll track it down.

Duncan Murdoch

From murdoch at stats.uwo.ca  Tue May 17 10:27:04 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Tue May 17 10:27:11 2005
Subject: [Rd] locator() (PR#7873)
Message-ID: <20050517082704.8BA7CB286@slim.kubism.ku.dk>

sascha.frydman@aad.gov.au wrote:
> Full_Name: Sascha Frydman
> Version: 2.1.0
> OS: Windows XP
> Submission from: (NULL) (147.66.131.10)
> 
> 
> when Esc is pressed while a plot with locator running has the focus, R crashes.
> eg.
> plot(1)
> locator(1)
> 
> I am running in SDI mode

Thanks for the report.  This is fixed now in the patched version.  It 
should show up in the snapshot builds on CRAN by tomorrow.

Duncan Murdoch

From ralf.seppelt at ufz.de  Tue May 17 11:33:51 2005
From: ralf.seppelt at ufz.de (Ralf Seppelt)
Date: Tue May 17 11:32:57 2005
Subject: [Rd] Implementing R on  IBM p690 cluster Jump
In-Reply-To: <4284B64C.7000008@ufz.de>
References: <4281BAA4.9000309@ufz.de>
	<Pine.LNX.4.61.0505110922590.12010@gannet.stats>
	<4284B64C.7000008@ufz.de>
Message-ID: <4289BA7F.1080608@ufz.de>

Dear All,

recently I posted a probably difficult question concerning the 
installation and implementation of R-2.1.0 on the IBM p690 cluster 
"Jump" at the research centre in J?lich, Germany.

We identified several modifications for an installation such as:

(i) the installation of the most recent iconflib in the local user directory
(ii) the configuration command
OBJECT_MODE=64 MAKE=gmake CC="cc -DSTDC"  SHLIB_LDFLAGS="-Wl,-G" 
F77="xlf" PREFIX=/home3/zdvex/ufzaloe ./configure --without-x 
--without-blas --without-readline --with-libiconv-prefix=
=/home3/zdvex/ufzaloe/lib

(iii) and the compilation command OBJECT_MODE=64 gmake

(thanks to Christoph Pospiech for help).

The really severe problem is, that the compilation now aboarts when 
making the survival R-library. This is what we get:

gmake[3]: Leaving directory `/work/.j36/R.INSTALL.3207208/survival/src'
** R
** data
**  moving datasets to lazyload DB
** inst
** preparing package for lazy loading
/home3/zdvex/ufzaloe/R-2.1.0/bin/INSTALL[325]: 1364064 Illegal 
instruction(coredump)
ERROR: lazy loading failed for package 'survival'
** Removing '/home3/zdvex/ufzaloe/R-2.1.0/library/survival'
gmake[2]: *** [survival.ts] Error 1
gmake[2]: Leaving directory 
`/home3/zdvex/ufzaloe/R-2.1.0/src/library/Recommended'
gmake[1]: *** [recommended-packages] Error 2
gmake[1]: Leaving directory 
`/home3/zdvex/ufzaloe/R-2.1.0/src/library/Recommended'
gmake: *** [stamp-recommended] Error 2
ufzaloe@j36.!:

(see attchment, zip archive of log-file).

Besides the OS-problems (like missing readline implementation) it seems 
as if we need good help from the R developers community, as this most 
recent bug (compilation of survival) seems to an R problem.

However, we are still strongly interested in getting this stuff running,
any good suggestions very welcome!

Cheers
	Ralf


-------------- next part --------------
A non-text attachment was scrubbed...
Name: putty.zip
Type: application/x-tar
Size: 25906 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20050517/80fa4abf/putty.tar
From r.hankin at noc.soton.ac.uk  Tue May 17 15:16:15 2005
From: r.hankin at noc.soton.ac.uk (r.hankin@noc.soton.ac.uk)
Date: Tue May 17 15:16:25 2005
Subject: [Rd] branch cuts in atan(), asin(), acos() (PR#7871)
Message-ID: <20050517131615.B3AD1E7B3@slim.kubism.ku.dk>


On May 17, 2005, at 07:01 am, Prof Brian Ripley wrote:

> On Mon, 16 May 2005 r.hankin@noc.soton.ac.uk wrote:
>
>> The complex versions of atain(), asin(), acos() are not documented
>> except in the source
>> code.
>
> Thank you, but your patch does not address that so they would become 
> undocumented (they no longer follow the comment in the source code, 
> which BTW is regarded as documentation).
>
> Could you please supply documentation to match this change, including 
> the exact definition you have implemented.
>
> Also: have you looked at atan2?
>


OK, this follows PR#7871, discussing branch cuts of inverse trig 
functions.
In this email, I provide a context diff between complex.c (R-2.1.0) and 
a version that
moves the branch cuts to the standard places.  The changes are 
documented in the code.
I also give updated Trig.Rd and Hyperbolic.Rd files which document the 
behaviour
of the new functions.   R-2.1.0 passes "make check"  with the new files 
(after editing
Rdutils.Rd, which caused a problem).

I have not attempted to alter z_atan2(): there appear to be unrelated 
issues here.
For example, atan2(0,0) gives 0 as documented, but atan2(0i,0i) gives 
NA.
Also, atan2(0,1i) returns an error (I would expect a zero here too).

I feel it is better to consider z_atan2() as a separate issue.  I will 
file a separate bugreport
for this.



diff -c <old complex.c> <new complex.c>


*** /Users/rksh/downloads/R-2.1.0/src/main/complex.c	Mon Apr 18 
22:30:00 2005
--- complex.c	Tue May 17 13:35:27 2005
***************
*** 355,360 ****
--- 355,365 ----

   	/* Complex Arcsin and Arccos Functions */
   	/* Equation (4.4.37) Abramowitz and Stegun */
+ 	/* with additional terms to force the branch
+ 	/* to agree with figure 4.4, p79.  Continuity */
+ 	/* on the branch cuts (real axis; y==0, |x| > 1) is */
+ 	/* standard: z_asin() is continuous from below if x >= 1 */
+ 	/* and continuous from above if x <= -1. */

   static void z_asin(Rcomplex *r, Rcomplex *z)
   {
***************
*** 367,372 ****
--- 372,382 ----
       bet = t1 - t2;
       r->r = asin(bet);
       r->i = log(alpha + sqrt(alpha*alpha - 1));
+
+     if(y<0 || (y==0 && x > 1)){
+       r->i *= -1;
+ 	}
+
   }

   static void z_acos(Rcomplex *r, Rcomplex *z)
***************
*** 379,384 ****
--- 389,399 ----

   	/* Complex Arctangent Function */
   	/* Equation (4.4.39) Abramowitz and Stegun */
+ 	/* with additional terms to force the branch cuts */
+ 	/* to agree with figure 4.4, p79.  Continuity */
+ 	/* on the branch cuts (pure imaginary axis; x==0, |y|>1) */
+ 	/* is standard: z_asin() is continuous from the right */
+ 	/*  if y >= 1, and continuous from the left if y <= -1.	*/

   static void z_atan(Rcomplex *r, Rcomplex *z)
   {
***************
*** 388,393 ****
--- 403,416 ----
       r->r = 0.5 * atan(2 * x / ( 1 - x * x - y * y));
       r->i = 0.25 * log((x * x + (y + 1) * (y + 1)) /
   		      (x * x + (y - 1) * (y - 1)));
+
+     if(x*x + y*y > 1){
+       r->r += M_PI_2;
+       if(x < 0 || (x==0 && y<0)){
+ 	r->r -= M_PI;
+       }
+     }
+
   }

   static void z_atan2(Rcomplex *r, Rcomplex *csn, Rcomplex *ccs)





====FILE Hyperbolic.Rd STARTS====
\name{Hyperbolic}
\title{Hyperbolic Functions}
\usage{
cosh(x)
sinh(x)
tanh(x)
acosh(x)
asinh(x)
atanh(x)
}
\alias{cosh}
\alias{sinh}
\alias{tanh}
\alias{acosh}
\alias{asinh}
\alias{atanh}
\description{
   These functions give the obvious hyperbolic functions.  They
   respectively compute the hyperbolic cosine, sine, tangent, and their
   inverses, arc-cosine, arc-sine, arc-tangent (or \dQuote{\emph{area 
cosine}},
   etc).
}
\arguments{
   \item{x}{a numeric or complex vector}
}
\details{
   These are generic functions: methods can be defined for them
   individually or via the \code{\link{Math}} group generic.

   Branch cuts are consistent with the inverse trigonometric functions
   \code{asin()} et seq, and agree with those defined in Abramowitz and
   Stegun, figure 4.7, page 86.

}
\seealso{
   The trigonometric functions, \code{\link{cos}}, \code{\link{sin}},
   \code{\link{tan}}, and their inverses
   \code{\link{acos}}, \code{\link{asin}}, \code{\link{atan}}.

   The logistic distribution function \code{\link{plogis}} is a shifted
   version of \code{tanh()}.
}
\keyword{math}
====FILE Hyperbolic.Rd ENDS====



====File Trig.Rd STARTS====
\name{Trig}
\alias{Trig}
\alias{cos}
\alias{sin}
\alias{tan}
\alias{acos}
\alias{asin}
\alias{atan}
\alias{atan2}
\title{Trigonometric Functions}
\description{
   These functions give the obvious trigonometric functions.  They
   respectively compute the cosine, sine, tangent, arc-cosine, arc-sine,
   arc-tangent, and the two-argument arc-tangent.
}
\usage{
cos(x)
sin(x)
tan(x)
acos(x)
asin(x)
atan(x)
atan2(y, x)
}
\arguments{
   \item{x, y}{numeric or complex vector}
}
\details{
   The arc-tangent of two arguments \code{atan2(y,x)} returns the angle
   between the x-axis and the vector from the origin to \eqn{(x,y)},
   i.e., for positive arguments \code{atan2(y,x) == atan(y/x)}.

   Angles are in radians, not degrees (i.e., a right angle is
   \eqn{\pi/2}).

   All except \code{atan2} are generic functions: methods can be defined
   for them individually or via the \code{\link{Math}} group generic.

   For the inverse trigonometric functions, branch cuts are defined as in
   Abramowitz and Stegun, figure 4.4, page 79.  Continuity on the
   branch cuts is standard.

   \item For \code{asin()} and \code{acos()}, there are two cuts, both
   along the real axis: \eqn{\left(-\infty,-1\right]}{\(-infinity,1\]}
   and \eqn{\left[1,\infty\right)}{\[1,infinity\)}.  Functions
   \code{asin()} and \code{acos()} are continuous from above on the
   interval \eqn{\left(-\infty,-1\right]}{\(-infinity,1\]} and
   continuous from below on
   \eqn{\left[1,\infty\right)}{\[1,infinity\)}.
   \item For \code{atan()} there are two cuts, both along the pure
   imaginary axis: \eqn{\left(-i\infty,-i\right]}{\(-i*infinity,-i\]}
   and \eqn{\left[i,i\infty\right)}{\[i,i*infinity\)}.  Function
   \code{atan()} is continuous from the left on the interval
   \eqn{\left(-i\infty,-i\right]}{\(-i*infinity,-i\]} and from the
   right on the interval
   \eqn{\left[i,i\infty\right)}{\[i,i*infinity\)}.

}
\references{
   Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
   \emph{The New S Language}.
   Wadsworth \& Brooks/Cole.

   Abramowitz, M. and Stegun, I. (1964). \emph{Handbook of
   Mathematical Functions}, Dover.
}
\examples{

#Visualize branch cuts:
x <- seq(from = -4, to = 4, len = 100)
z <- outer(x,1i*x,"+")
persp(x,x,Im(asin(z)),theta= 40,phi=40,r=1e9, expand=0.6, 
ticktype="detailed")
persp(x,x,Re(atan(z)),theta=-40,phi=40,r=1e9, expand=0.6, 
ticktype="detailed")


#check continuity on branch cuts:
asin( 3+ 1e-9i*(-1:1))
asin(-3+ 1e-9i*(-1:1))

atan( 3i + 1e-9*(-1:1))
atan(-3i + 1e-9*(-1:1))
}
\keyword{math}
====FILE Trig.Rd ENDS====





--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743

From martin.posch at univie.ac.at  Tue May 17 16:38:01 2005
From: martin.posch at univie.ac.at (martin.posch@univie.ac.at)
Date: Tue May 17 16:38:08 2005
Subject: [Rd] install.packages Bug? (PR#7876)
Message-ID: <20050517143801.0E42EE7AB@slim.kubism.ku.dk>

Full_Name: Martin Posch
Version: 2.1.0 and 2.1.0 patched
OS: Windows XP SP2
Submission from: (NULL) (131.130.1.135)


When installing the Hmisc package using the install option in the RGUI I get
the
error message under both R 2.1.0 and R 2.1.0 patched (see the outputs below). 
I tried the install after a fresh reboot (to minimize the possibility of locked
up files). The same problem arises with some of the other packages.

I use a german Windows version but set the RGUI-language to english (setting the
environment variable LC_all to "en".

*********************************************************************************

R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0  (2005-04-18), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> utils:::menuInstallPkgs()
--- Please select a CRAN mirror for use in this session ---
trying URL 'http://cran.at.r-project.org/bin/windows/contrib/2.1/Hmisc_3.0-5.zip'
Content type 'application/zip' length 1954673 bytes
opened URL
downloaded 1908Kb

package 'Hmisc' successfully unpacked and MD5 sums checked
Error in sprintf(gettext("unable to move temp installation '%d' to '%s'"),  : 
        use format %s for character objects
> 


**********************************************************************************
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0 Patched (2005-05-14), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> utils:::menuInstallPkgs()
--- Please select a CRAN mirror for use in this session ---
trying URL 'http://cran.at.r-project.org/bin/windows/contrib/2.1/Hmisc_3.0-5.zip'
Content type 'application/zip' length 1954673 bytes
opened URL
downloaded 1908Kb

package 'Hmisc' successfully unpacked and MD5 sums checked

The downloaded packages are in
        C:\Dokumente und Einstellungen\Admin\Lokale
Einstellungen\Temp\Rtmp20068\downloaded_packages
updating HTML package descriptions
Warning message:
unable to move temp installation
'C:/Programme/R/rw2010pat/library\file29532/Hmisc' to
'C:/Programme/R/rw2010pat/library/Hmisc' 
>

From bullard at berkeley.edu  Tue May 17 18:20:33 2005
From: bullard at berkeley.edu (James Bullard)
Date: Tue May 17 18:25:38 2005
Subject: [Rd] returning an empty list.
Message-ID: <428A19D1.8040409@berkeley.edu>

I would like to return an empty list from a C function. This I would do as:

if (file.exists()) {
    /* do something */
}
else {
    SEXP empty_list;
    PROTECT(empty_list = NEW_LIST(0));
    UNPROTECT(1);
    return empty_list;
}

The PROTECT, UNPROTECT lines seemed like overkill to me, but as far as I 
understood the documentation this seemed like the correct usage. It 
seems like I could really just do the following:

return NEW_LIST(0);

but I thought I'd better ask first. Thanks in advance, I hope I did not 
miss something in the documentation which describes this.

Thanks, jim

-- 
James Bullard
bullard@berkeley.edu
760.267.0986

From bates at stat.wisc.edu  Tue May 17 18:52:37 2005
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue May 17 18:54:02 2005
Subject: [Rd] returning an empty list.
In-Reply-To: <428A19D1.8040409@berkeley.edu>
References: <428A19D1.8040409@berkeley.edu>
Message-ID: <428A2155.30900@stat.wisc.edu>

James Bullard wrote:
> I would like to return an empty list from a C function. This I would do as:
> 
> if (file.exists()) {
>    /* do something */
> }
> else {
>    SEXP empty_list;
>    PROTECT(empty_list = NEW_LIST(0));
>    UNPROTECT(1);
>    return empty_list;
> }
> 
> The PROTECT, UNPROTECT lines seemed like overkill to me, but as far as I
> understood the documentation this seemed like the correct usage. It
> seems like I could really just do the following:
> 
> return NEW_LIST(0);
> 
> but I thought I'd better ask first. Thanks in advance, I hope I did not
> miss something in the documentation which describes this.

You can use the short form in this case.  You need to PROTECT an SEXP
whenever you do further operations that may trigger a garbage collection
but in this case there are no such further operations.

Depending on what you are going to do with the returned value it may be
simpler to use

 return R_NilValue;

which returns NULL.

From ripley at stats.ox.ac.uk  Tue May 17 19:16:58 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue May 17 19:17:06 2005
Subject: [Rd] install.packages Bug? (PR#7876)
Message-ID: <20050517171658.0C8EFDC5F@slim.kubism.ku.dk>

This is a Windows error message, not an R error.  Do you have some 
pre-existing installation in that directory?

It is not something we can reproduce.

The 2.1.0 message bug was fixed a while back.

On Tue, 17 May 2005 martin.posch@univie.ac.at wrote:

> Full_Name: Martin Posch
> Version: 2.1.0 and 2.1.0 patched
> OS: Windows XP SP2
> Submission from: (NULL) (131.130.1.135)
>
>
> When installing the Hmisc package using the install option in the RGUI I get
> the
> error message under both R 2.1.0 and R 2.1.0 patched (see the outputs below).
> I tried the install after a fresh reboot (to minimize the possibility of locked
> up files). The same problem arises with some of the other packages.
>
> I use a german Windows version but set the RGUI-language to english (setting the
> environment variable LC_all to "en".
>
> *********************************************************************************
>
> R : Copyright 2005, The R Foundation for Statistical Computing
> Version 2.1.0  (2005-04-18), ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
>
>> utils:::menuInstallPkgs()
> --- Please select a CRAN mirror for use in this session ---
> trying URL 'http://cran.at.r-project.org/bin/windows/contrib/2.1/Hmisc_3.0-5.zip'
> Content type 'application/zip' length 1954673 bytes
> opened URL
> downloaded 1908Kb
>
> package 'Hmisc' successfully unpacked and MD5 sums checked
> Error in sprintf(gettext("unable to move temp installation '%d' to '%s'"),  :
>        use format %s for character objects
>>
>
>
> **********************************************************************************
> R : Copyright 2005, The R Foundation for Statistical Computing
> Version 2.1.0 Patched (2005-05-14), ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for a HTML browser interface to help.
> Type 'q()' to quit R.
>
>> utils:::menuInstallPkgs()
> --- Please select a CRAN mirror for use in this session ---
> trying URL 'http://cran.at.r-project.org/bin/windows/contrib/2.1/Hmisc_3.0-5.zip'
> Content type 'application/zip' length 1954673 bytes
> opened URL
> downloaded 1908Kb
>
> package 'Hmisc' successfully unpacked and MD5 sums checked
>
> The downloaded packages are in
>        C:\Dokumente und Einstellungen\Admin\Lokale
> Einstellungen\Temp\Rtmp20068\downloaded_packages
> updating HTML package descriptions
> Warning message:
> unable to move temp installation
> 'C:/Programme/R/rw2010pat/library\file29532/Hmisc' to
> 'C:/Programme/R/rw2010pat/library/Hmisc'
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From supergecko at aliceposta.it  Tue May 17 20:59:02 2005
From: supergecko at aliceposta.it (supergecko@aliceposta.it)
Date: Tue May 17 20:59:10 2005
Subject: [Rd] Problem with limmaGUI (PR#7877)
Message-ID: <20050517185902.D4143E7AA@slim.kubism.ku.dk>

Full_Name: Edoardo Giacopuzzi
Version: 2.0.1
OS: Windows XP Home
Submission from: (NULL) (80.181.65.157)


I have some problem with this new version of R GUI.
I've used limmaGUI package with an older version of R and it works perfectlly,
but now with the last version R 2.0.1.0 two error boxs appear every time I try
to launch this package:
1. <<Error in list.files(path, pattern, all.files, full.names, recursive):
regular expressione 'pattern' not valid>>
2. <<Error in try(expr, TRUE): oggetto "source.files" not found>>

The package correctly load the grapich interface anyway, but I've experimented
some problems when I try to load my .gpr files for analysis: the program often
crash!

Thanks.

From phgrosjean at sciviews.org  Tue May 17 21:31:37 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Tue May 17 21:31:59 2005
Subject: [Rd] Problem with limmaGUI (PR#7877)
In-Reply-To: <20050517185902.D4143E7AA@slim.kubism.ku.dk>
References: <20050517185902.D4143E7AA@slim.kubism.ku.dk>
Message-ID: <428A4699.8030506@sciviews.org>

Hello,

The first error message is the kind of error that appears due to some 
changes in grep() and the like in R 2.1.0 and when they are used to test 
some string issued from Tcl (limmaGUI uses tcltk, isn't it?) I have the 
same kind of errors with SciViews and have to adjust the code to make it 
fully compatible with R 2.1.0.

I would recommend to contact the package maintainer and ask for an 
update for version 2.1.0 of R. In the meantime, you should continue to 
use R 2.0.1 with limmaGUI, if you really need the GUI.

Best,

Philippe Grosjean

..............................................<?}))><........
  ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
  ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
  ) ) ) ) )   Mons-Hainaut University, Pentagone (3D08)
( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
  ) ) ) ) )   8, av du Champ de Mars, 7000 Mons, Belgium
( ( ( ( (
  ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.30.54
( ( ( ( (    email: Philippe.Grosjean@umh.ac.be
  ) ) ) ) )
( ( ( ( (    web:   http://www.umh.ac.be/~econum
  ) ) ) ) )          http://www.sciviews.org
( ( ( ( (
..............................................................

supergecko@aliceposta.it wrote:
> Full_Name: Edoardo Giacopuzzi
> Version: 2.0.1
> OS: Windows XP Home
> Submission from: (NULL) (80.181.65.157)
> 
> 
> I have some problem with this new version of R GUI.
> I've used limmaGUI package with an older version of R and it works perfectlly,
> but now with the last version R 2.0.1.0 two error boxs appear every time I try
> to launch this package:
> 1. <<Error in list.files(path, pattern, all.files, full.names, recursive):
> regular expressione 'pattern' not valid>>
> 2. <<Error in try(expr, TRUE): oggetto "source.files" not found>>
> 
> The package correctly load the grapich interface anyway, but I've experimented
> some problems when I try to load my .gpr files for analysis: the program often
> crash!
> 
> Thanks.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From roebuck at odin.mdacc.tmc.edu  Tue May 17 21:36:20 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Tue May 17 21:36:31 2005
Subject: [Rd] [Q] Example Data Files for Package
Message-ID: <Pine.OSF.4.58.0505171416020.129022@odin.mdacc.tmc.edu>

If the example data files for a package are extremely large,
should they just be put in a different package specifically
for example data? If so, are these data packages normally
submitted to CRAN/BioC or mentioned in README with directions
specifying where to download on developer site?

If these files are all dot-tsv (.tsv), they would seem
appropriate for the data directory. "Writing R Extensions"
doesn't specifically mention this as a valid file extension
for that directory. Glancing around at some other packages,
I see a number that create an 'extdata' directory. Is there
a consensus on where alternative data files should be put
within a package?

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From murdoch at stats.uwo.ca  Tue May 17 21:40:30 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Tue May 17 21:40:36 2005
Subject: [Rd] Problem with limmaGUI (PR#7877)
Message-ID: <20050517194030.1A984DDF9@slim.kubism.ku.dk>

supergecko@aliceposta.it wrote:
> Full_Name: Edoardo Giacopuzzi
> Version: 2.0.1
> OS: Windows XP Home
> Submission from: (NULL) (80.181.65.157)
> 
> 
> I have some problem with this new version of R GUI.
> I've used limmaGUI package with an older version of R and it works perfectlly,
> but now with the last version R 2.0.1.0 two error boxs appear every time I try
> to launch this package:
> 1. <<Error in list.files(path, pattern, all.files, full.names, recursive):
> regular expressione 'pattern' not valid>>
> 2. <<Error in try(expr, TRUE): oggetto "source.files" not found>>
> 
> The package correctly load the grapich interface anyway, but I've experimented
> some problems when I try to load my .gpr files for analysis: the program often
> crash!

You should report problems with contributed packages to the maintainer. 
  Most often they are caused by incompatibilities with something new in R.

limmaGUI isn't a package on CRAN, so that's what I'd expect in this case.

Duncan Murdoch

From Achim.Zeileis at wu-wien.ac.at  Tue May 17 22:01:48 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Tue May 17 22:14:47 2005
Subject: [Rd] [Q] Example Data Files for Package
In-Reply-To: <Pine.OSF.4.58.0505171416020.129022@odin.mdacc.tmc.edu>
References: <Pine.OSF.4.58.0505171416020.129022@odin.mdacc.tmc.edu>
Message-ID: <20050517220148.1623568b.Achim.Zeileis@wu-wien.ac.at>

Paul:

> If the example data files for a package are extremely large,

What is extremely large here? Mega/giga/terrabytes?

> should they just be put in a different package specifically
> for example data? If so, are these data packages normally
> submitted to CRAN/BioC or mentioned in README with directions
> specifying where to download on developer site?

That depends on the value of "extremely large". Up to a certain extent
(a few hundred KB or so), I would put them into the package. Otherwise
include a README or (maybe even better) a man page that has the example
code and explains where to obtain the data.

> If these files are all dot-tsv (.tsv), they would seem
> appropriate for the data directory.

For large data sets consider to save() the data to .rda to reduce memory
usage. Also try the `compress' option.
To give you an impression: the spam data set in package kernlab has
dimension 4601 x 58 and is 180K in compressed binary format.

> "Writing R Extensions"
> doesn't specifically mention this as a valid file extension
> for that directory. Glancing around at some other packages,
> I see a number that create an 'extdata' directory. Is there
> a consensus on where alternative data files should be put
> within a package?

In most situations, I would recommend to include data just as usual in
the data directory.

my EUR 0.02
Z

From huihan at yahoo-inc.com  Wed May 18 02:08:07 2005
From: huihan at yahoo-inc.com (Hui Han)
Date: Wed May 18 02:10:10 2005
Subject: [Rd] bandwidth selection through cross validation in density
	estimation?
Message-ID: <428A8767.9020802@yahoo-inc.com>

Hi,

The "density" function has a parameter that allows choosing a bandwidth 
using cross-validaton method, as described here:
*/'bw.ucv' and 'bw.bcv' implement unbiased and biased cross-validation 
respectively./**/

/*However, I didn't see any loops in the "density" function source code. 
I checked the program "bandwidths.c" and it looks to me that an 
optimization function "fmin.c" is used for bandwidth selection. "fmin.c" 
uses the Nelder-Mead search Method, and I don't think this is a cross 
validation method.  I wonder if I have missed any information. Could any 
one point to me where is the cross validaton implemented for bandwidth 
selection?

Thanks and best regards,
Hui

	[[alternative HTML version deleted]]

From ripley at stats.ox.ac.uk  Wed May 18 10:12:29 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 18 10:12:50 2005
Subject: [Rd] Re: [R] Fortran 95 in R ?
In-Reply-To: <1253d67a05051723354f663146@mail.gmail.com>
References: <1253d67a05051723354f663146@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0505180906510.7543@gannet.stats>

First you need a functional F95 compiler.  I believe `g95' is obselete, 
replaced by gfortran.  For how to use that, please do read the R-admin 
manual in R 2.1.0 -- it can be done if you use a bug-fixed version of 
gfortran (post gcc-4.0.0) or a workaround.  Reliable F95 compilers such as 
those on Solaris have been usable with R for several years.

Please do remember to mention your platform and which compilers you used: 
see the posting guide.  Preferably also use the list it suggests (moved 
there).

On Tue, 17 May 2005, Joel Bremson wrote:

> Is it possible to run Fortran 95 code from R? I don't think so, but
> hopefully someone can prove me wrong.
>
> Here is the test I tried:
>
> A little fortran 95 subroutine:
>
> subroutine allloc()
> real, dimension(:, :), allocatable :: a
> integer :: n
>
> n = 10
> allocate(a(n,n+1))
> end
>
> I then compiled:
>
>> g95 -c allloc.f
>> R CMD SHLIB allloc.o
>
> Here is what happens when I try to dyn.load it in R 2.1.0
>
>> dyn.load("allloc.so")
> Error in dyn.load(x, as.logical(local), as.logical(now)) :
> unable to load shared library '/home/jbremson/dev/f_code/allloc.so':
> /home/jbremson/dev/f_code/allloc.so: undefined symbol: _g95_filename
>
> Is there any way to deal with this?
>
> Is it somehow possible to reach the fortran 95 through C and avoid this
> whole problem?
>
> Regards,
>
> Joel Bremson
> UC Davis

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed May 18 14:52:43 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 18 14:52:51 2005
Subject: [Rd] SVN revision numbers
Message-ID: <Pine.LNX.4.61.0505181344150.17717@gannet.stats>

You will start to see SVN revision numbers appearing in the the R-devel 
version of R, for example

    R : Copyright 2005, The R Foundation for Statistical Computing
    Version 2.2.0 Under development (unstable) (2005-05-18 r34401)
    ISBN 3-900051-07-0

This has been done to enable us to track more precisely the sources used 
to build R: the date stamp is imprecise and sometimes gets to be wrong in 
a tarball.

Users building from snapshot tarballs will see this as from tomorrow.

Windows users who used an SVN checkout will see this with immediate 
effect.

Unix-alike users who use an SVN checkout currently will only see
something like:

> R.version
          _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   Under development (unstable)
major    2
minor    2.0
year     2005
month    05
day      18
svn rev  unknown
language R

as we still have to decide what to do if e.g. an NFS-mounted SVN checkout 
is used on a machine without SVN.  (In principle that can be done on 
Windows and it is supposed to be working there, but we don't feel the need 
to test it on Windows but do under Unix.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ch-r-devel at bobobeach.com  Wed May 18 22:36:43 2005
From: ch-r-devel at bobobeach.com (Cyrus Harmon)
Date: Wed May 18 22:37:05 2005
Subject: [Rd] SVN revision numbers
In-Reply-To: <Pine.LNX.4.61.0505181344150.17717@gannet.stats>
References: <Pine.LNX.4.61.0505181344150.17717@gannet.stats>
Message-ID: <1D0AAC9B-0A52-4A48-92BA-A1B599CF29E1@bobobeach.com>


I'm seeing an error about not being able to find SVN-REVISION in the  
R (top src dir) when I try to build from current SVN sources. Is this  
a file that is supposed to be generated that I'm not generating for  
some reason, or is this supposed to be in the SVN repository?

My apologies if I'm catching the repository in an unstable state and  
this is a known problem.

Thanks,

Cyrus

On May 18, 2005, at 5:52 AM, Prof Brian Ripley wrote:

> You will start to see SVN revision numbers appearing in the the R- 
> devel version of R, for example
>
>    R : Copyright 2005, The R Foundation for Statistical Computing
>    Version 2.2.0 Under development (unstable) (2005-05-18 r34401)
>    ISBN 3-900051-07-0
>
> This has been done to enable us to track more precisely the sources  
> used to build R: the date stamp is imprecise and sometimes gets to  
> be wrong in a tarball.
>
> Users building from snapshot tarballs will see this as from tomorrow.
>
> Windows users who used an SVN checkout will see this with immediate  
> effect.
>
> Unix-alike users who use an SVN checkout currently will only see
> something like:
>
>
>> R.version
>>
>          _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status   Under development (unstable)
> major    2
> minor    2.0
> year     2005
> month    05
> day      18
> svn rev  unknown
> language R
>
> as we still have to decide what to do if e.g. an NFS-mounted SVN  
> checkout is used on a machine without SVN.  (In principle that can  
> be done on Windows and it is supposed to be working there, but we  
> don't feel the need to test it on Windows but do under Unix.)
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ch-r-devel at bobobeach.com  Wed May 18 22:44:24 2005
From: ch-r-devel at bobobeach.com (Cyrus Harmon)
Date: Wed May 18 22:44:36 2005
Subject: [Rd] SVN revision numbers
In-Reply-To: <1D0AAC9B-0A52-4A48-92BA-A1B599CF29E1@bobobeach.com>
References: <Pine.LNX.4.61.0505181344150.17717@gannet.stats>
	<1D0AAC9B-0A52-4A48-92BA-A1B599CF29E1@bobobeach.com>
Message-ID: <7FDC46E4-96B0-4B5A-BFCC-603AB6FC71CD@bobobeach.com>

Following up on my own post... touching non-tarball and then doing a  
make fixes the problem. I assume this is documented somewhere and I  
just missed it.

Cyrus

On May 18, 2005, at 1:36 PM, Cyrus Harmon wrote:

>
> I'm seeing an error about not being able to find SVN-REVISION in  
> the R (top src dir) when I try to build from current SVN sources.  
> Is this a file that is supposed to be generated that I'm not  
> generating for some reason, or is this supposed to be in the SVN  
> repository?
>
> My apologies if I'm catching the repository in an unstable state  
> and this is a known problem.
>
> Thanks,
>
> Cyrus

From roebuck at odin.mdacc.tmc.edu  Wed May 18 22:58:05 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Wed May 18 22:58:13 2005
Subject: [Rd] R Include File Guards
Message-ID: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>

R 2.1.0/src/include from 2005/04/18 download

Naming inconsistent for guards as well but that's pedantic.
Simple convention:
  file <foo.h>
    #ifndef R_FOO_H
  file <R_ext/bar.h>
    #ifndef R_EXT_BAR_H

Missing guards:
<IOStuff.h>
<Internal.h>
<Parse.h>
<R_ext/GraphicsBase.h>
<R_ext/GraphicsDevice.h>
<R_ext/GraphicsEngine.h>
<R_ext/R-ftp-http.h>
<R_ext/libextern.h>


Illegal Guards (leading underscore):
<Rinternals.h>
<R_ext/Error.h>
<config.h.in>


----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From ripley at stats.ox.ac.uk  Wed May 18 23:02:47 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 18 23:02:57 2005
Subject: [Rd] SVN revision numbers
In-Reply-To: <7FDC46E4-96B0-4B5A-BFCC-603AB6FC71CD@bobobeach.com>
References: <Pine.LNX.4.61.0505181344150.17717@gannet.stats>
	<1D0AAC9B-0A52-4A48-92BA-A1B599CF29E1@bobobeach.com>
	<7FDC46E4-96B0-4B5A-BFCC-603AB6FC71CD@bobobeach.com>
Message-ID: <Pine.LNX.4.61.0505182201410.14721@gannet.stats>

On Wed, 18 May 2005, Cyrus Harmon wrote:

> Following up on my own post... touching non-tarball and then doing a make 
> fixes the problem. I assume this is documented somewhere and I just missed 
> it.

The make process does touch non-tarball: you may need to start from a 
clean build.  (BTW, that's not new.)

>
> Cyrus
>
> On May 18, 2005, at 1:36 PM, Cyrus Harmon wrote:
>
>> 
>> I'm seeing an error about not being able to find SVN-REVISION in the R (top 
>> src dir) when I try to build from current SVN sources. Is this a file that 
>> is supposed to be generated that I'm not generating for some reason, or is 
>> this supposed to be in the SVN repository?
>> 
>> My apologies if I'm catching the repository in an unstable state and this 
>> is a known problem.
>> 
>> Thanks,
>> 
>> Cyrus
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed May 18 23:03:50 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 18 23:11:30 2005
Subject: [Rd] R Include File Guards
In-Reply-To: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
References: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
Message-ID: <Pine.LNX.4.61.0505182203080.14721@gannet.stats>

On Wed, 18 May 2005, Paul Roebuck wrote:

> R 2.1.0/src/include from 2005/04/18 download
>
> Naming inconsistent for guards as well but that's pedantic.
> Simple convention:
>  file <foo.h>
>    #ifndef R_FOO_H
>  file <R_ext/bar.h>
>    #ifndef R_EXT_BAR_H
>
> Missing guards:
> <IOStuff.h>
> <Internal.h>
> <Parse.h>
> <R_ext/GraphicsBase.h>
> <R_ext/GraphicsDevice.h>
> <R_ext/GraphicsEngine.h>
> <R_ext/R-ftp-http.h>
> <R_ext/libextern.h>
>
>
> Illegal Guards (leading underscore):
> <Rinternals.h>
> <R_ext/Error.h>
> <config.h.in>

What is `illegal' about that?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From roebuck at odin.mdacc.tmc.edu  Wed May 18 23:23:19 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Wed May 18 23:23:31 2005
Subject: [Rd] R Include File Guards
In-Reply-To: <Pine.LNX.4.61.0505182203080.14721@gannet.stats>
References: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
	<Pine.LNX.4.61.0505182203080.14721@gannet.stats>
Message-ID: <Pine.OSF.4.58.0505181611520.204610@odin.mdacc.tmc.edu>

On Wed, 18 May 2005, Prof Brian Ripley wrote:

> On Wed, 18 May 2005, Paul Roebuck wrote:
>
> > R 2.1.0/src/include from 2005/04/18 download
> >
> > Naming inconsistent for guards as well but that's pedantic.
> > Simple convention:
> >  file <foo.h>
> >    #ifndef R_FOO_H
> >  file <R_ext/bar.h>
> >    #ifndef R_EXT_BAR_H
> >
> > Missing guards:
> > <IOStuff.h>
> > <Internal.h>
> > <Parse.h>
> > <R_ext/GraphicsBase.h>
> > <R_ext/GraphicsDevice.h>
> > <R_ext/GraphicsEngine.h>
> > <R_ext/R-ftp-http.h>
> > <R_ext/libextern.h>
> >
> >
> > Illegal Guards (leading underscore):
> > <Rinternals.h>
> > <R_ext/Error.h>
> > <config.h.in>
>
> What is `illegal' about that?

ANSI C standard reserves identifiers that begin with
underscore followed by capital letter for implementation.
Strictly speaking, if a program uses such an identifier,
it's behavior is undefined.

<http://docs.hp.com/en/B9106-90012/stdsyms.5.html>
<http://docs.sun.com/app/docs/doc/802-2124/6i6425cof?a=view>
<http://www.cs.utah.edu/dept/old/texinfo/glibc-manual-0.02/library_1.html>

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From ripley at stats.ox.ac.uk  Wed May 18 23:38:16 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed May 18 23:38:25 2005
Subject: [Rd] SVN revision numbers
In-Reply-To: <Pine.LNX.4.61.0505182201410.14721@gannet.stats>
References: <Pine.LNX.4.61.0505181344150.17717@gannet.stats>
	<1D0AAC9B-0A52-4A48-92BA-A1B599CF29E1@bobobeach.com>
	<7FDC46E4-96B0-4B5A-BFCC-603AB6FC71CD@bobobeach.com>
	<Pine.LNX.4.61.0505182201410.14721@gannet.stats>
Message-ID: <Pine.LNX.4.61.0505182235470.22313@gannet.stats>

On Wed, 18 May 2005, Prof Brian Ripley wrote:

> On Wed, 18 May 2005, Cyrus Harmon wrote:
>
>> Following up on my own post... touching non-tarball and then doing a make 
>> fixes the problem. I assume this is documented somewhere and I just missed 
>> it.
>
> The make process does touch non-tarball: you may need to start from a clean 
> build.  (BTW, that's not new.)

I have tested a clean build with both srcdir=builddir and 
srcdir!=builddir, and both behaved flawlessly.  I was also able to update 
several other builds from a day to a month old.

>> On May 18, 2005, at 1:36 PM, Cyrus Harmon wrote:
>> 
>>> 
>>> I'm seeing an error about not being able to find SVN-REVISION in the R 
>>> (top src dir) when I try to build from current SVN sources. Is this a file 
>>> that is supposed to be generated that I'm not generating for some reason, 
>>> or is this supposed to be in the SVN repository?
>>> 
>>> My apologies if I'm catching the repository in an unstable state and this 
>>> is a known problem.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Wed May 18 23:42:41 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed May 18 23:42:49 2005
Subject: [Rd] R Include File Guards
In-Reply-To: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
References: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
Message-ID: <x2psvorz1q.fsf@turmalin.kubism.ku.dk>

Paul Roebuck <roebuck@odin.mdacc.tmc.edu> writes:

> R 2.1.0/src/include from 2005/04/18 download
> 
> Naming inconsistent for guards as well but that's pedantic.
> Simple convention:
>   file <foo.h>
>     #ifndef R_FOO_H
>   file <R_ext/bar.h>
>     #ifndef R_EXT_BAR_H
> 
> Missing guards:
> <IOStuff.h>
> <Internal.h>
> <Parse.h>
> <R_ext/GraphicsBase.h>
> <R_ext/GraphicsDevice.h>
> <R_ext/GraphicsEngine.h>
> <R_ext/R-ftp-http.h>
> <R_ext/libextern.h>
> 
> 
> Illegal Guards (leading underscore):
> <Rinternals.h>
> <R_ext/Error.h>
> <config.h.in>

Thanks. The ones outside R_ext, except Rinternals.h, are not part of the
API, so it is not a bug that there are no guards - could still be a
good idea to have them of course. libextern.h explicitly says that you
shouldn't disallow including it more than once. So the ones with real
problems would be

<R_ext/GraphicsBase.h>
<R_ext/GraphicsDevice.h>
<R_ext/GraphicsEngine.h>
<R_ext/R-ftp-http.h>

<Rinternals.h>
<R_ext/Error.h>

What's illegal about leading underscores, BTW?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ngoldsmi at bigpond.net.au  Thu May 19 11:11:24 2005
From: ngoldsmi at bigpond.net.au (ngoldsmi@bigpond.net.au)
Date: Thu May 19 11:11:32 2005
Subject: [Rd] R quits after 6 seconds (PR#7878)
Message-ID: <20050519091124.EABDDB23E@slim.kubism.ku.dk>

Full_Name: Noel Goldsmith
Version: 2.1.0a
OS: OS X 10.3.9
Submission from: (NULL) (203.45.17.210)


Having newly installed R version 2.1.0a on a macintosh iMac 20 inch G5 with 1 Gb
of Ram and a 160 Gb hard disc I can report that the application starts up with
the Cocoa GUI window and then after some six seconds it just closes and quits.
No error messages or other symptoms apparent.

I can also report that this was exactly the same wth R 2.1 on the same machine.

So had a go at removing R and reinstalling using the 2.1.0a, in the vain hope it
would help.
If there is some thing I should check or do I would be prepared to act as a bug
squasher.

From roebuck at odin.mdacc.tmc.edu  Thu May 19 11:28:58 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Thu May 19 11:29:06 2005
Subject: [Rd] R quits after 6 seconds (PR#7878)
In-Reply-To: <20050519091124.EABDDB23E@slim.kubism.ku.dk>
References: <20050519091124.EABDDB23E@slim.kubism.ku.dk>
Message-ID: <Pine.OSF.4.58.0505190425150.258237@odin.mdacc.tmc.edu>

On Thu, 19 May 2005 Noel Goldsmith wrote:

> Having newly installed R version 2.1.0a on a macintosh
> iMac 20 inch G5 with 1 Gb of Ram and a 160 Gb hard disc
> I can report that the application starts up with the
> Cocoa GUI window and then after some six seconds it just
> closes and quits.
> No error messages or other symptoms apparent.

/Applications/Utilities/Console.app
What does it report?

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)

From murdoch at stats.uwo.ca  Thu May 19 11:49:59 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu May 19 11:49:52 2005
Subject: [Rd] Getting ... without evaluating it?
Message-ID: <428C6147.9060105@stats.uwo.ca>

I'd like a function to get an unevaluated copy of its argument list, 
including ... .  That is, I'd like

f <- function(...) {
   args <- <what goes here??>
   args
}

when called as

f(a = 1+1, b = foo)

to return something like list(a = quote(1+1), b = quote(foo)).  If I use 
args <- list(...) then it tries to evaluate the arguments and dies 
(because foo doesn't exist).  If I use args <- substitute(...) then it 
gives just 1+1, it doesn't keep the names or give the whole list.

Is this possible?

Duncan Murdoch

From ripley at stats.ox.ac.uk  Thu May 19 12:07:20 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu May 19 12:10:01 2005
Subject: [Rd] Getting ... without evaluating it?
In-Reply-To: <428C6147.9060105@stats.uwo.ca>
References: <428C6147.9060105@stats.uwo.ca>
Message-ID: <Pine.LNX.4.61.0505191104180.6887@gannet.stats>

On Thu, 19 May 2005, Duncan Murdoch wrote:

> I'd like a function to get an unevaluated copy of its argument list, 
> including ... .  That is, I'd like
>
> f <- function(...) {
>  args <- <what goes here??>
>  args
> }
>
> when called as
>
> f(a = 1+1, b = foo)
>
> to return something like list(a = quote(1+1), b = quote(foo)).  If I use args 
> <- list(...) then it tries to evaluate the arguments and dies (because foo 
> doesn't exist).  If I use args <- substitute(...) then it gives just 1+1, it 
> doesn't keep the names or give the whole list.

> f <- function(...) as.list(match.call())[-1]
> f(a = 1+1, b = foo)
$a
1 + 1

$b
foo

(which is what list(a = quote(1+1), b = quote(foo)) prints as).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Thu May 19 12:50:20 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu May 19 12:49:40 2005
Subject: [Rd] Getting ... without evaluating it?
In-Reply-To: <Pine.LNX.4.61.0505191104180.6887@gannet.stats>
References: <428C6147.9060105@stats.uwo.ca>
	<Pine.LNX.4.61.0505191104180.6887@gannet.stats>
Message-ID: <428C6F6C.7030807@stats.uwo.ca>

Prof Brian Ripley wrote:
> On Thu, 19 May 2005, Duncan Murdoch wrote:
> 
> 
>>I'd like a function to get an unevaluated copy of its argument list, 
>>including ... .  That is, I'd like
>>
>>f <- function(...) {
>> args <- <what goes here??>
>> args
>>}
>>
>>when called as
>>
>>f(a = 1+1, b = foo)
>>
>>to return something like list(a = quote(1+1), b = quote(foo)).  If I use args 
>><- list(...) then it tries to evaluate the arguments and dies (because foo 
>>doesn't exist).  If I use args <- substitute(...) then it gives just 1+1, it 
>>doesn't keep the names or give the whole list.
> 
> 
>>f <- function(...) as.list(match.call())[-1]
>>f(a = 1+1, b = foo)
> 
> $a
> 1 + 1
> 
> $b
> foo
> 
> (which is what list(a = quote(1+1), b = quote(foo)) prints as).

Thanks!

Duncan Murdoch

From tplate at blackmesacapital.com  Thu May 19 17:48:35 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Thu May 19 17:48:42 2005
Subject: [Rd] problems with truncate() with files > 2Gb under Windows
	(possibly (PR#7879)
Message-ID: <20050519154835.6E46EED78@slim.kubism.ku.dk>

This message relates to handling files > 2Gb under Windows.  (I use 2Gb
as shorthand for 2^31-1 -- the largest integer representable in a signed
32 bit integer.)

First issue: truncate() is not able to successfully  truncate files at a
position > 2Gb.  This appears to be due to the use of the Windows
function chsize() in file_truncate() in main/connections.c (chsize()
takes a long int specification of the file size, so we would not expect
it to work for positions > 2Gb).

The Windows API has the function SetEndOfFile(handle) that is
supposed to truncate the file to the current position.  However, this
function does not seem to function correctly when the current position
is beyond 2Gb, so it is not improvement on chsize() (at least under
Windows 2000).  My explorations with Windows 2000 SP2 and XP Prof SP1 
indicate that SetEndOfFile() DOES successfully truncate files > 2Gb to 
sizes < 2Gb, but cannot truncate the same file to a position beyond 2Gb. 
  So I have no suggestions on how to get this to work.  Probably, the 
best thing to do would be to stop with in error in the appropriate 
situations.

Second issue: although the R function seek() can take a seek position
specified as a double, which allows it to seek to a position beyond 2Gb,
the return value from seek() appears to be a 32-bit signed integer, 
resulting in strange (incorrect) return values from seek(), though 
otherwise not affecting correct operation.

Inspecting the code, I wonder whether the lines

#if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
     off_t pos = f_tell(fp);
#else
     long pos = f_tell(fp);
#endif

in the definition of file_seek() in main/connections.c should be more
along the lines of the code defining struct fileconn in
include/Rconnections.h:

#if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
     off_t rpos, wpos;
#else
#ifdef Win32
     off64_t rpos, wpos;
#else
     long rpos, wpos;
#endif
#endif

I compiled and tested a version of R devel 2.2.0 with the appropriate
simple change to file_seek() in main/connections.c, and with it, seek()
correctly returned file positions beyond 2Gb.  However,  I don't know
the purpose of the #define __USE_LARGEFILE (and I couldn't find any info
about googling about it on r-project.org), so I'm hesitant to offer a
patch.  Here's the new block of code I used in main/connections.c that 
worked ok under Windows :

#if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
     off_t pos = f_tell(fp);
#else
#ifdef Win32
     off64_t pos = f_tell(fp);
#else
     long pos = f_tell(fp);
#endif
#endif

I'll be happy to submit a patch that addresses these issues, if someone 
will explain the usage and purpose of __USE_LARGEFILE.

The following transcript, which illustrates both issues (without my 
mods), was created from an installation based on the precompiled version 
of R for Windows. (rw2010.exe).

-- Tony Plate

> options(digits=15)
>
> # can truncate a short file from 8 bytes to 4 bytes
> # first create a file with 8 bytes
> f <- file("tmp1.txt", "wb")
> writeLines(c("abc", "def"), f)
> close(f)
> # check length then truncate to 4 bytes
> f <- file("tmp1.txt", "r+b")
> seek(f, 0, "end")
[1] 0
> seek(f, NA)
[1] 8
> seek(f, 4)
[1] 8
> truncate(f)
NULL
> seek(f, 0, "end")
[1] 4
> seek(f, NA)
[1] 4
> close(f)
> # can truncate a long file from 2000000008 bytes to 2000000004 bytes
> # first create a file with 2000000008 bytes (slightly < 2^31)
> f <- file("tmp1.txt", "wb")
> seek(f, 2000000000)
[1] 0
> writeLines(c("abc", "def"), f)
> close(f)
> f <- file("tmp1.txt", "r+b")
> seek(f, 0, "end")
[1] 0
> seek(f, NA)
[1] 2000000008
> seek(f, 2000000004)
[1] 2000000008
> truncate(f)
NULL
> seek(f, 0, "end")
[1] 2000000004
> seek(f, NA)
[1] 2000000004
> close(f)
> # cannot truncate a long file from 2200000008 bytes to 2200000004 bytes
> # first create a file with 2200000008 bytes (slightly > 2^31)
> f <- file("tmp1.txt", "wb")
> seek(f, 2200000000)
[1] 0
> writeLines(c("abc", "def"), f)
> close(f)
> f <- file("tmp1.txt", "r+b")
> seek(f, 0, "end")
[1] 0
> seek(f, NA) # bad reported value of the current position of "2200000008"
[1] -2094967288
> 2200000008 - 2^32
[1] -2094967288
> seek(f, 2200000004)
[1] -2094967288
> truncate(f) # doesn't work!
NULL
> seek(f, 0, "end")
[1] -2094967288
> # see if we successfully truncated... (no -- same length as before
> # can also verify this by watching file size with 'ls -l')
> seek(f, NA) # file is same size as before the attempted truncation
[1] -2094967288
> close(f)
> version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    1.0
year     2005
month    04
day      18
language R
>

From ripley at stats.ox.ac.uk  Thu May 19 18:47:48 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu May 19 18:47:56 2005
Subject: [Rd] problems with truncate() with files > 2Gb under Windows
	(PR#7880)
Message-ID: <20050519164748.6F3118523@slim.kubism.ku.dk>

__USE_LARGEFILE is a standard Unix way to allow > 2Gb files on 32-bit 
OSes by using f{seek,tell}o  Take a look at the definition of f_tell:

#if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
#define f_seek fseeko
#define f_tell ftello
#else
#ifdef Win32
#define f_seek fseeko64
#define f_tell ftello64
#else
#define f_seek fseek
#define f_tell ftell
#endif
#endif

Windows support for > 2Gb files seemed flaky, but we did not think it was 
R's job to report OS deficiencies.

I've now used off64_t in file_seek under Windows.

On Thu, 19 May 2005 tplate@blackmesacapital.com wrote:

> This message relates to handling files > 2Gb under Windows.  (I use 2Gb
> as shorthand for 2^31-1 -- the largest integer representable in a signed
> 32 bit integer.)
>
> First issue: truncate() is not able to successfully  truncate files at a
> position > 2Gb.  This appears to be due to the use of the Windows
> function chsize() in file_truncate() in main/connections.c (chsize()
> takes a long int specification of the file size, so we would not expect
> it to work for positions > 2Gb).
>
> The Windows API has the function SetEndOfFile(handle) that is
> supposed to truncate the file to the current position.  However, this
> function does not seem to function correctly when the current position
> is beyond 2Gb, so it is not improvement on chsize() (at least under
> Windows 2000).  My explorations with Windows 2000 SP2 and XP Prof SP1
> indicate that SetEndOfFile() DOES successfully truncate files > 2Gb to
> sizes < 2Gb, but cannot truncate the same file to a position beyond 2Gb.
>  So I have no suggestions on how to get this to work.  Probably, the
> best thing to do would be to stop with in error in the appropriate
> situations.
>
> Second issue: although the R function seek() can take a seek position
> specified as a double, which allows it to seek to a position beyond 2Gb,
> the return value from seek() appears to be a 32-bit signed integer,
> resulting in strange (incorrect) return values from seek(), though
> otherwise not affecting correct operation.
>
> Inspecting the code, I wonder whether the lines
>
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t pos = f_tell(fp);
> #else
>     long pos = f_tell(fp);
> #endif
>
> in the definition of file_seek() in main/connections.c should be more
> along the lines of the code defining struct fileconn in
> include/Rconnections.h:
>
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t rpos, wpos;
> #else
> #ifdef Win32
>     off64_t rpos, wpos;
> #else
>     long rpos, wpos;
> #endif
> #endif
>
> I compiled and tested a version of R devel 2.2.0 with the appropriate
> simple change to file_seek() in main/connections.c, and with it, seek()
> correctly returned file positions beyond 2Gb.  However,  I don't know
> the purpose of the #define __USE_LARGEFILE (and I couldn't find any info
> about googling about it on r-project.org), so I'm hesitant to offer a
> patch.  Here's the new block of code I used in main/connections.c that
> worked ok under Windows :
>
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t pos = f_tell(fp);
> #else
> #ifdef Win32
>     off64_t pos = f_tell(fp);
> #else
>     long pos = f_tell(fp);
> #endif
> #endif
>
> I'll be happy to submit a patch that addresses these issues, if someone
> will explain the usage and purpose of __USE_LARGEFILE.
>
> The following transcript, which illustrates both issues (without my
> mods), was created from an installation based on the precompiled version
> of R for Windows. (rw2010.exe).
>
> -- Tony Plate
>
>> options(digits=15)
>>
>> # can truncate a short file from 8 bytes to 4 bytes
>> # first create a file with 8 bytes
>> f <- file("tmp1.txt", "wb")
>> writeLines(c("abc", "def"), f)
>> close(f)
>> # check length then truncate to 4 bytes
>> f <- file("tmp1.txt", "r+b")
>> seek(f, 0, "end")
> [1] 0
>> seek(f, NA)
> [1] 8
>> seek(f, 4)
> [1] 8
>> truncate(f)
> NULL
>> seek(f, 0, "end")
> [1] 4
>> seek(f, NA)
> [1] 4
>> close(f)
>> # can truncate a long file from 2000000008 bytes to 2000000004 bytes
>> # first create a file with 2000000008 bytes (slightly < 2^31)
>> f <- file("tmp1.txt", "wb")
>> seek(f, 2000000000)
> [1] 0
>> writeLines(c("abc", "def"), f)
>> close(f)
>> f <- file("tmp1.txt", "r+b")
>> seek(f, 0, "end")
> [1] 0
>> seek(f, NA)
> [1] 2000000008
>> seek(f, 2000000004)
> [1] 2000000008
>> truncate(f)
> NULL
>> seek(f, 0, "end")
> [1] 2000000004
>> seek(f, NA)
> [1] 2000000004
>> close(f)
>> # cannot truncate a long file from 2200000008 bytes to 2200000004 bytes
>> # first create a file with 2200000008 bytes (slightly > 2^31)
>> f <- file("tmp1.txt", "wb")
>> seek(f, 2200000000)
> [1] 0
>> writeLines(c("abc", "def"), f)
>> close(f)
>> f <- file("tmp1.txt", "r+b")
>> seek(f, 0, "end")
> [1] 0
>> seek(f, NA) # bad reported value of the current position of "2200000008"
> [1] -2094967288
>> 2200000008 - 2^32
> [1] -2094967288
>> seek(f, 2200000004)
> [1] -2094967288
>> truncate(f) # doesn't work!
> NULL
>> seek(f, 0, "end")
> [1] -2094967288
>> # see if we successfully truncated... (no -- same length as before
>> # can also verify this by watching file size with 'ls -l')
>> seek(f, NA) # file is same size as before the attempted truncation
> [1] -2094967288
>> close(f)
>> version
>          _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rhurlin at gwdg.de  Thu May 19 23:20:49 2005
From: rhurlin at gwdg.de (rhurlin@gwdg.de)
Date: Thu May 19 23:20:56 2005
Subject: [Rd] make fails in errors.c (PR#7881)
Message-ID: <20050519212049.B470B9F68@slim.kubism.ku.dk>

Full_Name: Rainer Hurling
Version: R-2.1.0
OS: FreeBSD6-CURRENT from May 19 2005
Submission from: (NULL) (213.54.77.26)


/configure does well in FreeBSD6-CURRENT.

When typing 'make' after a while I get:

-------------------------------------
[...snip...]
gcc -export-dynamic -L/usr/local/lib -o R.bin  Rmain.o  CConverters.o
CommandLineArgs.o Rdynload.o Renviron.o RNG.o apply.o arithmetic.o
apse.o array.o attrib.o base.o bind.o builtin.o character.o coerce.o
colors.o complex.o connections.o context.o cov.o cum.o dcf.o datetime.o
debug.o deparse.o deriv.o dotcode.o dounzip.o dstruct.o duplicate.o
engine.o envir.o errors.o eval.o format.o fourier.o gevents.o gram.o
gram-ex.o graphics.o identical.o internet.o iosupport.o lapack.o list.o
logic.o main.o mapply.o match.o memory.o model.o names.o objects.o
optim.o optimize.o options.o par.o paste.o pcre.o platform.o plot.o
plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o
qsort.o random.o regex.o registration.o relop.o saveload.o scan.o seq.o
serialize.o size.o sort.o source.o split.o sprintf.o startup.o
subassign.o subscript.o subset.o summary.o sysutils.o unique.o util.o
version.o vfonts.o xxxpr.o ../unix/libunix.a ../appl/libappl.a
../nmath/libnmath.a   -lg2c -lm  ../extra/zlib/libz.a
../extra/bzip2/libbz2.a ../extra/pcre/libpcre.a
/usr/local/lib/libintl.so -Wl,-rpath -Wl,/usr/local/lib -lreadline -lm
-liconv

errors.o(.text+0x154b): In function `do_gettext':
/usr/local/R-2.1.0/src/main/errors.c:779: undefined reference to
`__builtin_alloca'
errors.o(.text+0x15fa):/usr/local/R-2.1.0/src/main/errors.c:752:
undefined reference to `__builtin_alloca'
errors.o(.text+0x1652):/usr/local/R-2.1.0/src/main/errors.c:760:
undefined reference to `__builtin_alloca'
errors.o(.text+0x16aa):/usr/local/R-2.1.0/src/main/errors.c:770:
undefined reference to `__builtin_alloca'
errors.o(.text+0x1728):/usr/local/R-2.1.0/src/main/errors.c:738:
undefined reference to `__builtin_alloca'
errors.o(.text+0x274d):/usr/local/R-2.1.0/src/main/errors.c:829: more
undefined references to `__builtin_alloca' follow
*** Error code 1

Stop in /usr/local/R-2.1.0/src/main.
*** Error code 1

Stop in /usr/local/R-2.1.0/src/main.
*** Error code 1

Stop in /usr/local/R-2.1.0/src.
*** Error code 1

Stop in /usr/local/R-2.1.0.
-------------------------------------

Asking for the problem at R-devel I got this answer from Prof. Brian Ripley:

"R itself does not refer to __builtin_alloca.  That is something being mapped by
the FreeBSD headers, and it should be `builtin' using gcc.  (No version of
alloca is appearing as an import in error.o on Linux or Solaris using gcc.)  So
it looks like an inconsistency between your compiler and OS."

My gcc version is 3.4.2 [FreeBSD] 20040728.

There is no problem compiling R-2.0.1 and older versions on the same system.

From menke at u.arizona.edu  Thu May 19 23:24:01 2005
From: menke at u.arizona.edu (menke@u.arizona.edu)
Date: Thu May 19 23:24:07 2005
Subject: [Rd] New R (2.1) not openable under emacs files (PR#7882)
Message-ID: <20050519212401.17BE29F68@slim.kubism.ku.dk>

Full_Name: Michael Menke
Version: 2.1
OS: Mac OS X 3.9
Submission from: (NULL) (65.41.49.80)


With the previous versions of R, I could go to any project file in Emacs and
open R within that file with the file images saved. I tried at the end of April
with version 2.1 and then today again with version 2.1a, and opening R within a
file - such as Advantage (one of my files) is impossible. It appears to try to
load R, then says:

Error in dyn.load(x, as.logical(local), as.logical(now)) : 
	unable to load shared library
'/Library/Frameworks/R.framework/Resources/library/grDevices/libs/grDevices.so':
  dlcompat: dyld: /Library/Frameworks/R.framework/Resources/bin/exec/R version
mismatch for library: /usr/local/lib/libxml2.2.dylib (compatibility version of
user: 9.0.0 greater than library's version: 8.0.0)
Fatal error: unable to restore saved data in .RData


Process R exited abnormally with code 2 at Thu May 19 17:22:22 2005

Last time, I went back and re-loaded the old version to get it to run. Any ideas
what settings need redoing? Or is back to the old version for us OS X users?

From fosnight at usgs.gov  Fri May 20 00:37:50 2005
From: fosnight at usgs.gov (fosnight@usgs.gov)
Date: Fri May 20 00:37:56 2005
Subject: [Rd] error when quartz graphics window refreshed after awaking from
	sleep (PR#7883)
Message-ID: <20050519223750.E76DD9F68@slim.kubism.ku.dk>

Received following error when quartz graphics window refreshed after 
awaking from sleep. Never received this error prior to upgrading to 
2.1.0a. 

*** malloc[504]: Deallocation of a pointer not malloced: 0xbfffd590; This 
could be a double free(), or free() called with the middle of an allocated 
block; Try setting environment variable MallocHelp to see tools to help 
debug
+ *** malloc[504]: Deallocation of a pointer not malloced: 0xbfffd700; 
This could be a double free(), or free() called with the middle of an 
allocated block; Try setting environment variable MallocHelp to see tools 
to help debug")

[m[m[0m[H[2J[24;1H"R.bug.report" 25L, 514C[2;1H<<insert bug report 
here>>[6;1H--please do not edit the information below--



Version:

 platform = powerpc-apple-darwin7.9.0

 arch = powerpc

 os = darwin7.9.0

 system = powerpc, darwin7.9.0

 status = Patched

 major = 2

 minor = 1.0

 year = 2005

 month = 05

 day = 12

 language = R



Locale:

en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8[24;63H1,0-1[9CTop[1;1H

Eugene A. Fosnight, PhD
Senior Scientist, SAIC
UNEP GRID Sioux Falls
National Center, EROS
47914 252nd Street
Sioux Falls, SD 57198, USA
605-594-6051
http://www.na.unep.net/
fosnight@usgs.gov
	[[alternative HTML version deleted]]

From Simon.Wotherspoon at utas.edu.au  Fri May 20 05:18:43 2005
From: Simon.Wotherspoon at utas.edu.au (Simon Wotherspoon)
Date: Fri May 20 05:20:56 2005
Subject: [Rd] Problem with proj
Message-ID: <428D5713.8090203@utas.edu.au>

Hi all,
    Perhaps this in an inappropriate post, but I've found a bug in proj 
I'd like to track down a bit further before making a formal bug report.  
The example below shows the problem, if you change the rownames proj 
fails. The problem seems to be that there is a mismatch in the rownames 
in the qr objects constructed by aov and the rownames that proj is 
expecting them to have.  My question is - should I be trying to

1. correct the rownames of the qr object that aov makes, or is this 
likely to create other problems
2. change the way proj does its subsetting?

Or is this something that is likely to be quite tricky and better left 
to those that know?

Simon.




##
## Example from help("proj")
##

N <- c(0,1,0,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,1,0,0)
P <- c(1,1,0,0,0,1,0,1,1,1,0,0,0,1,0,1,1,0,0,1,0,1,1,0)
K <- c(1,0,0,1,0,1,1,0,0,1,0,1,0,1,1,0,0,0,1,1,1,0,1,0)
yield <- c(49.5,62.8,46.8,57.0,59.8,58.5,55.5,56.0,62.8,55.8,69.5,
           55.0, 
62.0,48.8,45.5,44.2,52.0,51.5,49.8,48.8,57.2,59.0,53.2,56.0)

npk <- data.frame(block=gl(6,4), N=factor(N), P=factor(P),
                  K=factor(K), yield=yield)
npk.aov <- aov(yield ~ block + N*P*K, npk)
proj(npk.aov)

## as a test, not particularly sensible
options(contrasts=c("contr.helmert", "contr.treatment"))
npk.aovE <- aov(yield ~  N*P*K + Error(block), npk)
proj(npk.aovE)


##
## Change the rownames and it fails
##
rownames(npk) <- 2:25
npk.aovE <- aov(yield ~  N*P*K + Error(block), npk)
proj(npk.aovE)

From lyhin at netvigator.com  Fri May 20 06:04:31 2005
From: lyhin at netvigator.com (Dr L. Y Hin)
Date: Fri May 20 06:05:05 2005
Subject: [Rd] Memory question on R
Message-ID: <000d01c55cf1$069af720$104efea9@yourgk68c57jh8>

Dear all,
Apology for posting this amateurish question.
I am running R version 2.1.0 on Windows XP for a simulation exercise.
Seemingly, I've encountered memory allocation problem during the 
recursive procedure.
I've looked at the help section called 
?Memory() and ?memory.limit(), and ?memory.size but the comamands
seem to refer to Unix version of R.
I wound be very grateful if anyone could kindly advise me on the method 
to set the memory allocation so that R workspace can harness the maximum
resources available on the hardware (RAM and virtual memory), with an understanding
that my machine may not have sufficient resources to run other applications.
In addition, does R version 2.1.0 makes use of the hyperthreading feature that may 
speed up the application?

Thanking you in advance
Lin
	[[alternative HTML version deleted]]

From w.northcott at unsw.edu.au  Fri May 20 07:09:06 2005
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Fri May 20 07:09:23 2005
Subject: [Rd] R 2.1 and gfortran
In-Reply-To: <200503241104.j2OB4U70024638@hypatia.math.ethz.ch>
References: <200503241104.j2OB4U70024638@hypatia.math.ethz.ch>
Message-ID: <13656FC7-4639-402C-B38E-9DED63DEDAA0@unsw.edu.au>

 From the configure output of the latest devel snapshot:

> checking for g77... no
> checking for f77... no
> checking for xlf... no
> checking for frt... no
> checking for pgf77... no
> checking for fl32... no
> checking for af77... no
> checking for fort77... no
> checking for f90... no
> checking for xlf90... no
> checking for pgf90... no
> checking for epcf90... no
> checking for f95... no
> checking for fort... no
> checking for xlf95... no
> checking for lf95... no
> checking for g95... no
> checking for fc... fc

The Fortran compiler in gcc-4.0 defaults to the name 'gfortran'.   
Other packages such as Octave seem to check for that.

Just to suggest that gfortran should be added to the list of possible  
compilers.

As a footnote I have built R 2.1 on MacOS X using a compiler built  
from very recent Apple cvs sources, with patches from the gfortran  
cvs code up to 18th May.  This binary passes all the tests.

Bill Northcott

From ripley at stats.ox.ac.uk  Fri May 20 08:35:30 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri May 20 08:35:36 2005
Subject: [Rd] make fails in errors.c (PR#7881)
Message-ID: <20050520063530.14B02A1D8@slim.kubism.ku.dk>

What makes you think this is an error in R?

You have already been told that the message refers to your OS, not R.

Earlier versions of R did not use alloca: it looks very likely that your 
systems's alloca is implemented in a broken way.


On Thu, 19 May 2005 rhurlin@gwdg.de wrote:

> Full_Name: Rainer Hurling
> Version: R-2.1.0
> OS: FreeBSD6-CURRENT from May 19 2005
> Submission from: (NULL) (213.54.77.26)
>
>
> /configure does well in FreeBSD6-CURRENT.
>
> When typing 'make' after a while I get:
>
> -------------------------------------
> [...snip...]
> gcc -export-dynamic -L/usr/local/lib -o R.bin  Rmain.o  CConverters.o
> CommandLineArgs.o Rdynload.o Renviron.o RNG.o apply.o arithmetic.o
> apse.o array.o attrib.o base.o bind.o builtin.o character.o coerce.o
> colors.o complex.o connections.o context.o cov.o cum.o dcf.o datetime.o
> debug.o deparse.o deriv.o dotcode.o dounzip.o dstruct.o duplicate.o
> engine.o envir.o errors.o eval.o format.o fourier.o gevents.o gram.o
> gram-ex.o graphics.o identical.o internet.o iosupport.o lapack.o list.o
> logic.o main.o mapply.o match.o memory.o model.o names.o objects.o
> optim.o optimize.o options.o par.o paste.o pcre.o platform.o plot.o
> plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o
> qsort.o random.o regex.o registration.o relop.o saveload.o scan.o seq.o
> serialize.o size.o sort.o source.o split.o sprintf.o startup.o
> subassign.o subscript.o subset.o summary.o sysutils.o unique.o util.o
> version.o vfonts.o xxxpr.o ../unix/libunix.a ../appl/libappl.a
> ../nmath/libnmath.a   -lg2c -lm  ../extra/zlib/libz.a
> ../extra/bzip2/libbz2.a ../extra/pcre/libpcre.a
> /usr/local/lib/libintl.so -Wl,-rpath -Wl,/usr/local/lib -lreadline -lm
> -liconv
>
> errors.o(.text+0x154b): In function `do_gettext':
> /usr/local/R-2.1.0/src/main/errors.c:779: undefined reference to
> `__builtin_alloca'
> errors.o(.text+0x15fa):/usr/local/R-2.1.0/src/main/errors.c:752:
> undefined reference to `__builtin_alloca'
> errors.o(.text+0x1652):/usr/local/R-2.1.0/src/main/errors.c:760:
> undefined reference to `__builtin_alloca'
> errors.o(.text+0x16aa):/usr/local/R-2.1.0/src/main/errors.c:770:
> undefined reference to `__builtin_alloca'
> errors.o(.text+0x1728):/usr/local/R-2.1.0/src/main/errors.c:738:
> undefined reference to `__builtin_alloca'
> errors.o(.text+0x274d):/usr/local/R-2.1.0/src/main/errors.c:829: more
> undefined references to `__builtin_alloca' follow
> *** Error code 1
>
> Stop in /usr/local/R-2.1.0/src/main.
> *** Error code 1
>
> Stop in /usr/local/R-2.1.0/src/main.
> *** Error code 1
>
> Stop in /usr/local/R-2.1.0/src.
> *** Error code 1
>
> Stop in /usr/local/R-2.1.0.
> -------------------------------------
>
> Asking for the problem at R-devel I got this answer from Prof. Brian Ripley:
>
> "R itself does not refer to __builtin_alloca.  That is something being mapped by
> the FreeBSD headers, and it should be `builtin' using gcc.  (No version of
> alloca is appearing as an import in error.o on Linux or Solaris using gcc.)  So
> it looks like an inconsistency between your compiler and OS."
>
> My gcc version is 3.4.2 [FreeBSD] 20040728.
>
> There is no problem compiling R-2.0.1 and older versions on the same system.
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri May 20 08:48:43 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri May 20 08:48:54 2005
Subject: [Rd] Memory question on R
In-Reply-To: <000d01c55cf1$069af720$104efea9@yourgk68c57jh8>
References: <000d01c55cf1$069af720$104efea9@yourgk68c57jh8>
Message-ID: <Pine.LNX.4.61.0505200745500.20987@gannet.stats>

On Fri, 20 May 2005, Dr L. Y Hin wrote:

> Dear all,
> Apology for posting this amateurish question.
> I am running R version 2.1.0 on Windows XP for a simulation exercise.
> Seemingly, I've encountered memory allocation problem during the
> recursive procedure.
> I've looked at the help section called
> ?Memory() and ?memory.limit(), and ?memory.size but the comamands
> seem to refer to Unix version of R.

If you looked in a Windows version of R they do not (and they should not 
have the ()).

Please do read the posting guide and (as we ask there) show us exactly 
what the messages you got were.  This question seems more appropriate to 
R-help than R-devel.

> I wound be very grateful if anyone could kindly advise me on the method
> to set the memory allocation so that R workspace can harness the maximum
> resources available on the hardware (RAM and virtual memory), with an understanding
> that my machine may not have sufficient resources to run other applications.
> In addition, does R version 2.1.0 makes use of the hyperthreading feature that may
> speed up the application?
>
> Thanking you in advance
> Lin
> 	[[alternative HTML version deleted]]

We do ask for no HTML mail.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From harloff at softuse.com  Fri May 20 09:30:58 2005
From: harloff at softuse.com (harloff@softuse.com)
Date: Fri May 20 09:31:03 2005
Subject: [Rd] MacOS Classic incompatibility? (PR#7884)
Message-ID: <20050520073058.370378B54@slim.kubism.ku.dk>

Full_Name: Joachim Harloff
Version: 2.0.1
OS: MacOS X 10.3
Submission from: (NULL) (84.152.129.217)


Hi,
I had a RAM intensive calculation run (anova (lm ... ), whcih allocated about
400 MB of RAM. Then I tried to use a MAC OS Classic statistical program
additionally. During startup of MacOS Classic the Unix system crashed. Some Unix
lines appeared on the screen (sorry, I didn't understand a word) and everything
was frozen. I had to restart the computer.
I do not think it was because of memory lack, since I have 1.7 GB of RAM
available and the programs running / tried to open would not even consume the
half of that. 

Regards, Joachim

From ripley at stats.ox.ac.uk  Fri May 20 11:21:35 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri May 20 11:21:46 2005
Subject: [Rd] problems with truncate() with files > 2Gb under Windows
	(possibly (PR#7879)
In-Reply-To: <20050519154835.6E46EED78@slim.kubism.ku.dk>
References: <20050519154835.6E46EED78@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0505201013350.12196@gannet.stats>

To follow up on the truncate() part of this, Windows does not use chsize 
directly any more, but ftruncate like all other platforms.  However, 
truncate() was limited to files < 2Gb on all platforms.  I have changed 
the latter and your example now works both on 32-bit Windows and on 64-bit 
Linux.

On Thu, 19 May 2005 tplate@blackmesacapital.com wrote:

> This message relates to handling files > 2Gb under Windows.  (I use 2Gb
> as shorthand for 2^31-1 -- the largest integer representable in a signed
> 32 bit integer.)
>
> First issue: truncate() is not able to successfully  truncate files at a
> position > 2Gb.  This appears to be due to the use of the Windows
> function chsize() in file_truncate() in main/connections.c (chsize()
> takes a long int specification of the file size, so we would not expect
> it to work for positions > 2Gb).
>
> The Windows API has the function SetEndOfFile(handle) that is
> supposed to truncate the file to the current position.  However, this
> function does not seem to function correctly when the current position
> is beyond 2Gb, so it is not improvement on chsize() (at least under
> Windows 2000).  My explorations with Windows 2000 SP2 and XP Prof SP1
> indicate that SetEndOfFile() DOES successfully truncate files > 2Gb to
> sizes < 2Gb, but cannot truncate the same file to a position beyond 2Gb.
>  So I have no suggestions on how to get this to work.  Probably, the
> best thing to do would be to stop with in error in the appropriate
> situations.
>
> Second issue: although the R function seek() can take a seek position
> specified as a double, which allows it to seek to a position beyond 2Gb,
> the return value from seek() appears to be a 32-bit signed integer,
> resulting in strange (incorrect) return values from seek(), though
> otherwise not affecting correct operation.
>
> Inspecting the code, I wonder whether the lines
>
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t pos = f_tell(fp);
> #else
>     long pos = f_tell(fp);
> #endif
>
> in the definition of file_seek() in main/connections.c should be more
> along the lines of the code defining struct fileconn in
> include/Rconnections.h:
>
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t rpos, wpos;
> #else
> #ifdef Win32
>     off64_t rpos, wpos;
> #else
>     long rpos, wpos;
> #endif
> #endif
>
> I compiled and tested a version of R devel 2.2.0 with the appropriate
> simple change to file_seek() in main/connections.c, and with it, seek()
> correctly returned file positions beyond 2Gb.  However,  I don't know
> the purpose of the #define __USE_LARGEFILE (and I couldn't find any info
> about googling about it on r-project.org), so I'm hesitant to offer a
> patch.  Here's the new block of code I used in main/connections.c that
> worked ok under Windows :
>
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t pos = f_tell(fp);
> #else
> #ifdef Win32
>     off64_t pos = f_tell(fp);
> #else
>     long pos = f_tell(fp);
> #endif
> #endif
>
> I'll be happy to submit a patch that addresses these issues, if someone
> will explain the usage and purpose of __USE_LARGEFILE.
>
> The following transcript, which illustrates both issues (without my
> mods), was created from an installation based on the precompiled version
> of R for Windows. (rw2010.exe).
>
> -- Tony Plate
>
>> options(digits=15)
>>
>> # can truncate a short file from 8 bytes to 4 bytes
>> # first create a file with 8 bytes
>> f <- file("tmp1.txt", "wb")
>> writeLines(c("abc", "def"), f)
>> close(f)
>> # check length then truncate to 4 bytes
>> f <- file("tmp1.txt", "r+b")
>> seek(f, 0, "end")
> [1] 0
>> seek(f, NA)
> [1] 8
>> seek(f, 4)
> [1] 8
>> truncate(f)
> NULL
>> seek(f, 0, "end")
> [1] 4
>> seek(f, NA)
> [1] 4
>> close(f)
>> # can truncate a long file from 2000000008 bytes to 2000000004 bytes
>> # first create a file with 2000000008 bytes (slightly < 2^31)
>> f <- file("tmp1.txt", "wb")
>> seek(f, 2000000000)
> [1] 0
>> writeLines(c("abc", "def"), f)
>> close(f)
>> f <- file("tmp1.txt", "r+b")
>> seek(f, 0, "end")
> [1] 0
>> seek(f, NA)
> [1] 2000000008
>> seek(f, 2000000004)
> [1] 2000000008
>> truncate(f)
> NULL
>> seek(f, 0, "end")
> [1] 2000000004
>> seek(f, NA)
> [1] 2000000004
>> close(f)
>> # cannot truncate a long file from 2200000008 bytes to 2200000004 bytes
>> # first create a file with 2200000008 bytes (slightly > 2^31)
>> f <- file("tmp1.txt", "wb")
>> seek(f, 2200000000)
> [1] 0
>> writeLines(c("abc", "def"), f)
>> close(f)
>> f <- file("tmp1.txt", "r+b")
>> seek(f, 0, "end")
> [1] 0
>> seek(f, NA) # bad reported value of the current position of "2200000008"
> [1] -2094967288
>> 2200000008 - 2^32
> [1] -2094967288
>> seek(f, 2200000004)
> [1] -2094967288
>> truncate(f) # doesn't work!
> NULL
>> seek(f, 0, "end")
> [1] -2094967288
>> # see if we successfully truncated... (no -- same length as before
>> # can also verify this by watching file size with 'ls -l')
>> seek(f, NA) # file is same size as before the attempted truncation
> [1] -2094967288
>> close(f)
>> version
>          _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
>>
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri May 20 11:37:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri May 20 11:38:13 2005
Subject: [Rd] problems with truncate() with files > 2Gb under Windows
	(possibly (PR#7879)
In-Reply-To: <Pine.LNX.4.61.0505201013350.12196@gannet.stats>
References: <20050519154835.6E46EED78@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505201013350.12196@gannet.stats>
Message-ID: <Pine.LNX.4.61.0505201035490.12626@gannet.stats>

On Fri, 20 May 2005, Prof Brian Ripley wrote:

> To follow up on the truncate() part of this, Windows does not use chsize 
> directly any more, but ftruncate like all other platforms.  However, 
> truncate() was limited to files < 2Gb on all platforms.  I have changed the 
> latter and your example now works both on 32-bit Windows and on 64-bit Linux.

I am sorry, I should clarify `works', as I had not cross-checked well 
enough.  There are no errors generated by the C call but ftruncate appears 
not to do what is required of it, despite having off_t as an argument. 
That is, at R level everything appears fine but the file was not truncated 
when looked at outside R.

Not much we can do about broken OS calls.

>
> On Thu, 19 May 2005 tplate@blackmesacapital.com wrote:
>
>> This message relates to handling files > 2Gb under Windows.  (I use 2Gb
>> as shorthand for 2^31-1 -- the largest integer representable in a signed
>> 32 bit integer.)
>> 
>> First issue: truncate() is not able to successfully  truncate files at a
>> position > 2Gb.  This appears to be due to the use of the Windows
>> function chsize() in file_truncate() in main/connections.c (chsize()
>> takes a long int specification of the file size, so we would not expect
>> it to work for positions > 2Gb).
>> 
>> The Windows API has the function SetEndOfFile(handle) that is
>> supposed to truncate the file to the current position.  However, this
>> function does not seem to function correctly when the current position
>> is beyond 2Gb, so it is not improvement on chsize() (at least under
>> Windows 2000).  My explorations with Windows 2000 SP2 and XP Prof SP1
>> indicate that SetEndOfFile() DOES successfully truncate files > 2Gb to
>> sizes < 2Gb, but cannot truncate the same file to a position beyond 2Gb.
>>  So I have no suggestions on how to get this to work.  Probably, the
>> best thing to do would be to stop with in error in the appropriate
>> situations.
>> 
>> Second issue: although the R function seek() can take a seek position
>> specified as a double, which allows it to seek to a position beyond 2Gb,
>> the return value from seek() appears to be a 32-bit signed integer,
>> resulting in strange (incorrect) return values from seek(), though
>> otherwise not affecting correct operation.
>> 
>> Inspecting the code, I wonder whether the lines
>> 
>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>     off_t pos = f_tell(fp);
>> #else
>>     long pos = f_tell(fp);
>> #endif
>> 
>> in the definition of file_seek() in main/connections.c should be more
>> along the lines of the code defining struct fileconn in
>> include/Rconnections.h:
>> 
>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>     off_t rpos, wpos;
>> #else
>> #ifdef Win32
>>     off64_t rpos, wpos;
>> #else
>>     long rpos, wpos;
>> #endif
>> #endif
>> 
>> I compiled and tested a version of R devel 2.2.0 with the appropriate
>> simple change to file_seek() in main/connections.c, and with it, seek()
>> correctly returned file positions beyond 2Gb.  However,  I don't know
>> the purpose of the #define __USE_LARGEFILE (and I couldn't find any info
>> about googling about it on r-project.org), so I'm hesitant to offer a
>> patch.  Here's the new block of code I used in main/connections.c that
>> worked ok under Windows :
>> 
>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>     off_t pos = f_tell(fp);
>> #else
>> #ifdef Win32
>>     off64_t pos = f_tell(fp);
>> #else
>>     long pos = f_tell(fp);
>> #endif
>> #endif
>> 
>> I'll be happy to submit a patch that addresses these issues, if someone
>> will explain the usage and purpose of __USE_LARGEFILE.
>> 
>> The following transcript, which illustrates both issues (without my
>> mods), was created from an installation based on the precompiled version
>> of R for Windows. (rw2010.exe).
>> 
>> -- Tony Plate
>> 
>>> options(digits=15)
>>> 
>>> # can truncate a short file from 8 bytes to 4 bytes
>>> # first create a file with 8 bytes
>>> f <- file("tmp1.txt", "wb")
>>> writeLines(c("abc", "def"), f)
>>> close(f)
>>> # check length then truncate to 4 bytes
>>> f <- file("tmp1.txt", "r+b")
>>> seek(f, 0, "end")
>> [1] 0
>>> seek(f, NA)
>> [1] 8
>>> seek(f, 4)
>> [1] 8
>>> truncate(f)
>> NULL
>>> seek(f, 0, "end")
>> [1] 4
>>> seek(f, NA)
>> [1] 4
>>> close(f)
>>> # can truncate a long file from 2000000008 bytes to 2000000004 bytes
>>> # first create a file with 2000000008 bytes (slightly < 2^31)
>>> f <- file("tmp1.txt", "wb")
>>> seek(f, 2000000000)
>> [1] 0
>>> writeLines(c("abc", "def"), f)
>>> close(f)
>>> f <- file("tmp1.txt", "r+b")
>>> seek(f, 0, "end")
>> [1] 0
>>> seek(f, NA)
>> [1] 2000000008
>>> seek(f, 2000000004)
>> [1] 2000000008
>>> truncate(f)
>> NULL
>>> seek(f, 0, "end")
>> [1] 2000000004
>>> seek(f, NA)
>> [1] 2000000004
>>> close(f)
>>> # cannot truncate a long file from 2200000008 bytes to 2200000004 bytes
>>> # first create a file with 2200000008 bytes (slightly > 2^31)
>>> f <- file("tmp1.txt", "wb")
>>> seek(f, 2200000000)
>> [1] 0
>>> writeLines(c("abc", "def"), f)
>>> close(f)
>>> f <- file("tmp1.txt", "r+b")
>>> seek(f, 0, "end")
>> [1] 0
>>> seek(f, NA) # bad reported value of the current position of "2200000008"
>> [1] -2094967288
>>> 2200000008 - 2^32
>> [1] -2094967288
>>> seek(f, 2200000004)
>> [1] -2094967288
>>> truncate(f) # doesn't work!
>> NULL
>>> seek(f, 0, "end")
>> [1] -2094967288
>>> # see if we successfully truncated... (no -- same length as before
>>> # can also verify this by watching file size with 'ls -l')
>>> seek(f, NA) # file is same size as before the attempted truncation
>> [1] -2094967288
>>> close(f)
>>> version
>>          _
>> platform i386-pc-mingw32
>> arch     i386
>> os       mingw32
>> system   i386, mingw32
>> status
>> major    2
>> minor    1.0
>> year     2005
>> month    04
>> day      18
>> language R
>>> 
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri May 20 13:56:34 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri May 20 13:56:43 2005
Subject: [Rd] Problem with proj
In-Reply-To: <428D5713.8090203@utas.edu.au>
References: <428D5713.8090203@utas.edu.au>
Message-ID: <Pine.LNX.4.61.0505201251200.19733@gannet.stats>

I think the qr object is correct.  The problem is in proj.aovlist, and I 
have now fixed it.

Answering something like this is as much work as dealing with a bug 
report, since we need to dig in (to find that is the aovlist method, for 
example) and to recall how it works (it is about 7 years since I wrote 
it).

On Fri, 20 May 2005, Simon Wotherspoon wrote:

> Hi all,
>   Perhaps this in an inappropriate post, but I've found a bug in proj I'd 
> like to track down a bit further before making a formal bug report.  The 
> example below shows the problem, if you change the rownames proj fails. The 
> problem seems to be that there is a mismatch in the rownames in the qr 
> objects constructed by aov and the rownames that proj is expecting them to 
> have.  My question is - should I be trying to
>
> 1. correct the rownames of the qr object that aov makes, or is this likely to 
> create other problems
> 2. change the way proj does its subsetting?
>
> Or is this something that is likely to be quite tricky and better left to 
> those that know?
>
> Simon.
>
>
>
>
> ##
> ## Example from help("proj")
> ##
>
> N <- c(0,1,0,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,1,0,0)
> P <- c(1,1,0,0,0,1,0,1,1,1,0,0,0,1,0,1,1,0,0,1,0,1,1,0)
> K <- c(1,0,0,1,0,1,1,0,0,1,0,1,0,1,1,0,0,0,1,1,1,0,1,0)
> yield <- c(49.5,62.8,46.8,57.0,59.8,58.5,55.5,56.0,62.8,55.8,69.5,
>          55.0, 62.0,48.8,45.5,44.2,52.0,51.5,49.8,48.8,57.2,59.0,53.2,56.0)
>
> npk <- data.frame(block=gl(6,4), N=factor(N), P=factor(P),
>                 K=factor(K), yield=yield)
> npk.aov <- aov(yield ~ block + N*P*K, npk)
> proj(npk.aov)
>
> ## as a test, not particularly sensible
> options(contrasts=c("contr.helmert", "contr.treatment"))
> npk.aovE <- aov(yield ~  N*P*K + Error(block), npk)
> proj(npk.aovE)
>
>
> ##
> ## Change the rownames and it fails
> ##
> rownames(npk) <- 2:25
> npk.aovE <- aov(yield ~  N*P*K + Error(block), npk)
> proj(npk.aovE)
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri May 20 14:28:59 2005
From: ripley at stats.ox.ac.uk (Brian D Ripley)
Date: Fri May 20 14:30:57 2005
Subject: [Rd] R 2.1 and gfortran
In-Reply-To: <13656FC7-4639-402C-B38E-9DED63DEDAA0@unsw.edu.au>
Message-ID: <Pine.GSO.4.31.0505201321250.23204-100000@markov.stats>

The reasons why it is not there *are* in the R-admin manual.  This was
deliberate: we do not include known broken tools in the searches.

Once gcc-4.0.1 is released and commonly used it will be safe to add it,
but not before. (That will most likely be for R-2.2.x, not R-2.1.x.) For
example, the current gfortran in FC3 is pre-4.0.0 and does not work (and
cannot be made to work on AMD64), and Simon Urbanek found an Apple version
of 4.0.0 that did not work.

On Fri, 20 May 2005, Bill Northcott wrote:

>  From the configure output of the latest devel snapshot:
>
> > checking for g77... no
> > checking for f77... no
> > checking for xlf... no
> > checking for frt... no
> > checking for pgf77... no
> > checking for fl32... no
> > checking for af77... no
> > checking for fort77... no
> > checking for f90... no
> > checking for xlf90... no
> > checking for pgf90... no
> > checking for epcf90... no
> > checking for f95... no
> > checking for fort... no
> > checking for xlf95... no
> > checking for lf95... no
> > checking for g95... no
> > checking for fc... fc
>
> The Fortran compiler in gcc-4.0 defaults to the name 'gfortran'.
> Other packages such as Octave seem to check for that.
>
> Just to suggest that gfortran should be added to the list of possible
> compilers.
>
> As a footnote I have built R 2.1 on MacOS X using a compiler built
> from very recent Apple cvs sources, with patches from the gfortran
> cvs code up to 18th May.  This binary passes all the tests.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From simon.urbanek at r-project.org  Fri May 20 14:44:21 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri May 20 14:44:31 2005
Subject: [Rd] New R (2.1) not openable under emacs files (PR#7882)
In-Reply-To: <20050519212401.17BE29F68@slim.kubism.ku.dk>
References: <20050519212401.17BE29F68@slim.kubism.ku.dk>
Message-ID: <3B4F86DC-3761-49F8-996A-7A37F5F21AA3@r-project.org>


On May 19, 2005, at 5:24 PM, menke@u.arizona.edu wrote:

> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>     unable to load shared library
> '/Library/Frameworks/R.framework/Resources/library/grDevices/libs/ 
> grDevices.so':
>   dlcompat: dyld: /Library/Frameworks/R.framework/Resources/bin/ 
> exec/R version
> mismatch for library: /usr/local/lib/libxml2.2.dylib (compatibility  
> version of
> user: 9.0.0 greater than library's version: 8.0.0)

This has nothing to do with R per-se - your local libxml conflicts  
with the system one. This is the most common mistake - many people  
forget to wipe their /usr/local after upgrading. Please remove the  
obsolete libxml from /usr/local/lib ( sudo rm -f /usr/local/ 
libxml*dylib ) - since Panther (10.3 and that's a while ago) the  
libxml is provided with the system.

Cheers,
Simon

From roger.bos at gmail.com  Fri May 20 15:35:56 2005
From: roger.bos at gmail.com (roger bos)
Date: Fri May 20 15:36:46 2005
Subject: [Rd] Memory question on R
In-Reply-To: <Pine.LNX.4.61.0505200745500.20987@gannet.stats>
References: <000d01c55cf1$069af720$104efea9@yourgk68c57jh8>
	<Pine.LNX.4.61.0505200745500.20987@gannet.stats>
Message-ID: <1db7268005052006356c74e0c4@mail.gmail.com>

Lin,

I don't know about hyperthreading, but on my 4GB XP machine I can read
in very large data files to the extend that Windows Task Manager shows
the Rgui is using 2.3 to 2.7 GB.  Further, I can run automated
simulations on this data all weekend with the processor at 99% without
the system or R crashing.  But to do this I had to modify the header
file to make Rgui /LARGEADDRESSAWARE.  There is a FAQ which describes
how to do this.  Let me know if you cannot find it.

However, it may be worth checking your code and seeing if there is
anyway you can avoid recursiveness as this may be not memory
efficient.

This is definitely a R-help questions.  Rd is for bug reports and such.

Thanks,

Roger




On 5/20/05, Prof Brian Ripley <ripley@stats.ox.ac.uk> wrote:
> On Fri, 20 May 2005, Dr L. Y Hin wrote:
> 
> > Dear all,
> > Apology for posting this amateurish question.
> > I am running R version 2.1.0 on Windows XP for a simulation exercise.
> > Seemingly, I've encountered memory allocation problem during the
> > recursive procedure.
> > I've looked at the help section called
> > ?Memory() and ?memory.limit(), and ?memory.size but the comamands
> > seem to refer to Unix version of R.
> 
> If you looked in a Windows version of R they do not (and they should not
> have the ()).
> 
> Please do read the posting guide and (as we ask there) show us exactly
> what the messages you got were.  This question seems more appropriate to
> R-help than R-devel.
> 
> > I wound be very grateful if anyone could kindly advise me on the method
> > to set the memory allocation so that R workspace can harness the maximum
> > resources available on the hardware (RAM and virtual memory), with an understanding
> > that my machine may not have sufficient resources to run other applications.
> > In addition, does R version 2.1.0 makes use of the hyperthreading feature that may
> > speed up the application?
> >
> > Thanking you in advance
> > Lin
> >       [[alternative HTML version deleted]]
> 
> We do ask for no HTML mail.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From tplate at blackmesacapital.com  Fri May 20 17:03:12 2005
From: tplate at blackmesacapital.com (Tony Plate)
Date: Fri May 20 17:03:33 2005
Subject: [Rd] problems with truncate() with files > 2Gb under Windows
	(possibly (PR#7879)
In-Reply-To: <Pine.LNX.4.61.0505201035490.12626@gannet.stats>
References: <20050519154835.6E46EED78@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505201013350.12196@gannet.stats>
	<Pine.LNX.4.61.0505201035490.12626@gannet.stats>
Message-ID: <428DFC30.4010704@blackmesacapital.com>

A colleague tells me they are able to get the Windows function 
SetEndOfFile to truncate files > 2Gb correctly when they avoid the use 
of FILE functions (fopen etc) entirely and work solely with pure Windows 
functions.  I can look into this and see if something can be put into 
the Windows code in main/connections.c:file_truncate().  (I already 
tried just putting an fflush() in there, but that did not help.)

-- Tony Plate

Prof Brian Ripley wrote:
> On Fri, 20 May 2005, Prof Brian Ripley wrote:
> 
>> To follow up on the truncate() part of this, Windows does not use 
>> chsize directly any more, but ftruncate like all other platforms.  
>> However, truncate() was limited to files < 2Gb on all platforms.  I 
>> have changed the latter and your example now works both on 32-bit 
>> Windows and on 64-bit Linux.
> 
> 
> I am sorry, I should clarify `works', as I had not cross-checked well 
> enough.  There are no errors generated by the C call but ftruncate 
> appears not to do what is required of it, despite having off_t as an 
> argument. That is, at R level everything appears fine but the file was 
> not truncated when looked at outside R.
> 
> Not much we can do about broken OS calls.
> 
>>
>> On Thu, 19 May 2005 tplate@blackmesacapital.com wrote:
>>
>>> This message relates to handling files > 2Gb under Windows.  (I use 2Gb
>>> as shorthand for 2^31-1 -- the largest integer representable in a signed
>>> 32 bit integer.)
>>>
>>> First issue: truncate() is not able to successfully  truncate files at a
>>> position > 2Gb.  This appears to be due to the use of the Windows
>>> function chsize() in file_truncate() in main/connections.c (chsize()
>>> takes a long int specification of the file size, so we would not expect
>>> it to work for positions > 2Gb).
>>>
>>> The Windows API has the function SetEndOfFile(handle) that is
>>> supposed to truncate the file to the current position.  However, this
>>> function does not seem to function correctly when the current position
>>> is beyond 2Gb, so it is not improvement on chsize() (at least under
>>> Windows 2000).  My explorations with Windows 2000 SP2 and XP Prof SP1
>>> indicate that SetEndOfFile() DOES successfully truncate files > 2Gb to
>>> sizes < 2Gb, but cannot truncate the same file to a position beyond 2Gb.
>>>  So I have no suggestions on how to get this to work.  Probably, the
>>> best thing to do would be to stop with in error in the appropriate
>>> situations.
>>>
>>> Second issue: although the R function seek() can take a seek position
>>> specified as a double, which allows it to seek to a position beyond 2Gb,
>>> the return value from seek() appears to be a 32-bit signed integer,
>>> resulting in strange (incorrect) return values from seek(), though
>>> otherwise not affecting correct operation.
>>>
>>> Inspecting the code, I wonder whether the lines
>>>
>>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>>     off_t pos = f_tell(fp);
>>> #else
>>>     long pos = f_tell(fp);
>>> #endif
>>>
>>> in the definition of file_seek() in main/connections.c should be more
>>> along the lines of the code defining struct fileconn in
>>> include/Rconnections.h:
>>>
>>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>>     off_t rpos, wpos;
>>> #else
>>> #ifdef Win32
>>>     off64_t rpos, wpos;
>>> #else
>>>     long rpos, wpos;
>>> #endif
>>> #endif
>>>
>>> I compiled and tested a version of R devel 2.2.0 with the appropriate
>>> simple change to file_seek() in main/connections.c, and with it, seek()
>>> correctly returned file positions beyond 2Gb.  However,  I don't know
>>> the purpose of the #define __USE_LARGEFILE (and I couldn't find any info
>>> about googling about it on r-project.org), so I'm hesitant to offer a
>>> patch.  Here's the new block of code I used in main/connections.c that
>>> worked ok under Windows :
>>>
>>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>>     off_t pos = f_tell(fp);
>>> #else
>>> #ifdef Win32
>>>     off64_t pos = f_tell(fp);
>>> #else
>>>     long pos = f_tell(fp);
>>> #endif
>>> #endif
>>>
>>> I'll be happy to submit a patch that addresses these issues, if someone
>>> will explain the usage and purpose of __USE_LARGEFILE.
>>>
>>> The following transcript, which illustrates both issues (without my
>>> mods), was created from an installation based on the precompiled version
>>> of R for Windows. (rw2010.exe).
>>>
>>> -- Tony Plate
>>>
>>>> options(digits=15)
>>>>
>>>> # can truncate a short file from 8 bytes to 4 bytes
>>>> # first create a file with 8 bytes
>>>> f <- file("tmp1.txt", "wb")
>>>> writeLines(c("abc", "def"), f)
>>>> close(f)
>>>> # check length then truncate to 4 bytes
>>>> f <- file("tmp1.txt", "r+b")
>>>> seek(f, 0, "end")
>>>
>>> [1] 0
>>>
>>>> seek(f, NA)
>>>
>>> [1] 8
>>>
>>>> seek(f, 4)
>>>
>>> [1] 8
>>>
>>>> truncate(f)
>>>
>>> NULL
>>>
>>>> seek(f, 0, "end")
>>>
>>> [1] 4
>>>
>>>> seek(f, NA)
>>>
>>> [1] 4
>>>
>>>> close(f)
>>>> # can truncate a long file from 2000000008 bytes to 2000000004 bytes
>>>> # first create a file with 2000000008 bytes (slightly < 2^31)
>>>> f <- file("tmp1.txt", "wb")
>>>> seek(f, 2000000000)
>>>
>>> [1] 0
>>>
>>>> writeLines(c("abc", "def"), f)
>>>> close(f)
>>>> f <- file("tmp1.txt", "r+b")
>>>> seek(f, 0, "end")
>>>
>>> [1] 0
>>>
>>>> seek(f, NA)
>>>
>>> [1] 2000000008
>>>
>>>> seek(f, 2000000004)
>>>
>>> [1] 2000000008
>>>
>>>> truncate(f)
>>>
>>> NULL
>>>
>>>> seek(f, 0, "end")
>>>
>>> [1] 2000000004
>>>
>>>> seek(f, NA)
>>>
>>> [1] 2000000004
>>>
>>>> close(f)
>>>> # cannot truncate a long file from 2200000008 bytes to 2200000004 bytes
>>>> # first create a file with 2200000008 bytes (slightly > 2^31)
>>>> f <- file("tmp1.txt", "wb")
>>>> seek(f, 2200000000)
>>>
>>> [1] 0
>>>
>>>> writeLines(c("abc", "def"), f)
>>>> close(f)
>>>> f <- file("tmp1.txt", "r+b")
>>>> seek(f, 0, "end")
>>>
>>> [1] 0
>>>
>>>> seek(f, NA) # bad reported value of the current position of 
>>>> "2200000008"
>>>
>>> [1] -2094967288
>>>
>>>> 2200000008 - 2^32
>>>
>>> [1] -2094967288
>>>
>>>> seek(f, 2200000004)
>>>
>>> [1] -2094967288
>>>
>>>> truncate(f) # doesn't work!
>>>
>>> NULL
>>>
>>>> seek(f, 0, "end")
>>>
>>> [1] -2094967288
>>>
>>>> # see if we successfully truncated... (no -- same length as before
>>>> # can also verify this by watching file size with 'ls -l')
>>>> seek(f, NA) # file is same size as before the attempted truncation
>>>
>>> [1] -2094967288
>>>
>>>> close(f)
>>>> version
>>>
>>>          _
>>> platform i386-pc-mingw32
>>> arch     i386
>>> os       mingw32
>>> system   i386, mingw32
>>> status
>>> major    2
>>> minor    1.0
>>> year     2005
>>> month    04
>>> day      18
>>> language R
>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>> -- 
>> Brian D. Ripley,                  ripley@stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>

From kwright at eskimo.com  Fri May 20 17:26:41 2005
From: kwright at eskimo.com (kwright@eskimo.com)
Date: Fri May 20 17:28:08 2005
Subject: [Rd] A patch for scatter.smooth
Message-ID: <44973.170.54.59.167.1116602801.squirrel@170.54.59.167>


This is a follow-up to my earlier posting this month.  For your
consideration, here are patches for loess.R and scatter.smooth.Rd that
will allow either of the following to work:
  scatter.smooth(x,y,...)
  scatter.smooth(y~x,...)

Here are some test cases:

attach(cars)
scatter.smooth(speed,dist,main="dist,speed")
scatter.smooth(speed,dist,main="dist,speed",xlab="",ylab="")
scatter.smooth(cars,main="cars")
scatter.smooth(cars,main="cars",xlab="Speed",ylab="Distance")
scatter.smooth(dist~speed,main="dist~speed")
scatter.smooth(dist~speed,main="dist~speed",xlab="")
scatter.smooth(dist~speed,main="dist~speed",ylab="")


Kevin Wright



----- Patch to loess.R -----

/cygdrive/c/R-devel/src/library/stats/R>diff -u loess.R loess.new.R
--- loess.R	2005-03-01 19:48:13.000000000 -0600
+++ loess.new.R	2005-05-20 09:12:58.792718700 -0500
@@ -403,19 +403,28 @@
 }

 scatter.smooth <-
-    function(x, y, span = 2/3, degree = 1,
+    function(x, y=NULL, span = 2/3, degree = 1,
 	     family = c("symmetric", "gaussian"),
-	     xlab = deparse(substitute(x)), ylab = deparse(substitute(y)),
+	     xlab = NULL, ylab = NULL,
 	     ylim = range(y, prediction$y, na.rm = TRUE),
              evaluation = 50, ...)
 {
-    if(inherits(x, "formula")) {
-	if(length(x) < 3) stop("need response in formula")
-	thiscall <- match.call()
-	thiscall$x <- x[[3]]
-	thiscall$y <- x[[2]]
-	return(invisible(eval(thiscall, sys.parent())))
-    }
+  xlabel <- if (!missing(x)) deparse(substitute(x))
+  ylabel <- if (!missing(y)) deparse(substitute(y))
+  xy <- xy.coords(x, y, xlabel, ylabel)
+
+  x <- xy$x
+  y <- xy$y
+  xlab <- if(is.null(xlab)) xy$xlab else xlab
+  ylab <- if(is.null(ylab)) xy$ylab else ylab
+
+#    if(inherits(x, "formula")) {
+#	if(length(x) < 3) stop("need response in formula")
+#	thiscall <- match.call()
+#	thiscall$x <- x[[3]]
+#	thiscall$y <- x[[2]]
+#	return(invisible(eval(thiscall, sys.parent())))
+#    }
     prediction <- loess.smooth(x, y, span, degree, family, evaluation)
     plot(x, y, ylim = ylim, xlab = xlab, ylab = ylab, ...)
     lines(prediction)

----- patch to scatter.smooth.Rd -----

/cygdrive/c/Temp/R-devel/src/library/stats/man>diff -u scatter.smooth.Rd
scatter.smooth.new.Rd
--- scatter.smooth.Rd	2004-10-29 09:46:19.000000000 -0500
+++ scatter.smooth.new.Rd	2005-05-20 09:54:40.444634400 -0500
@@ -8,7 +8,7 @@
 \usage{
 scatter.smooth(x, y, span = 2/3, degree = 1,
     family = c("symmetric", "gaussian"),
-    xlab = deparse(substitute(x)), ylab = deparse(substitute(y)),
+    xlab = NULL, ylab = NULL,
     ylim = range(y, prediction$y, na.rm = TRUE),
     evaluation = 50, \dots)

@@ -33,6 +33,9 @@
   \code{loess.smooth} is an auxiliary function which evaluates the
   \code{loess} smooth at \code{evaluation} equally spaced points
   covering the range of \code{x}.
+
+  The x,y arguments of \code{scatter.smooth} can be specified any of the
+  ways accepted by \code{\link{xy.coords}}.
 }
 \value{
   For \code{scatter.smooth}, none.

----- end -----

From jfox at mcmaster.ca  Sat May 21 19:37:12 2005
From: jfox at mcmaster.ca (John Fox)
Date: Sat May 21 19:37:23 2005
Subject: [Rd] Internationalizing the Rcmdr package?
Message-ID: <20050521173712.ZFMI25800.tomts13-srv.bellnexxia.net@JohnDesktop8300>

Dear R-devel list members,

I'm considering adding support for other languages than English to the Rcmdr
package. I understand that the use of Tcl/Tk by the Rcmdr package means I
won't be able to make full use of the internationalization facilities in R
2.1.0. I'm interested, therefore, in whether the following, more limited,
strategy (which bears some similarity to the internationalization facilities
in R) seems reasonable or whether there's a better approach. As well, I'm
interested in whether the proposed approach is sufficiently flexible to be
worthwhile -- does it cover enough languages?

It would be simple for me to provide a file of messages, labels, and other
text used by the Rcmdr, organizing this file with one message per line. A
copy of the file, named, e.g., messages.francais, could contain translations
into another language (e.g, French). Setting
options(Rcmdr=list(language=francais)) would then activate translation when
the Rcmdr starts up, reading the messages file into a data frame, treating
the English text as row names. The messages could be handled by a function,
say Text(), which would return English or translated text, as appropriate.
Some experimentation shows that message retrieval by this scheme is
essentially instantaneous even when there are several thousand relatively
long messages in the data frame. 

Thanks,
 John

--------------------------------
John Fox
Department of Sociology
McMaster University
Hamilton, Ontario
Canada L8S 4M4
905-525-9140x23604
http://socserv.mcmaster.ca/jfox

From p.dalgaard at biostat.ku.dk  Sat May 21 21:33:13 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat May 21 21:33:18 2005
Subject: [Rd] Internationalizing the Rcmdr package?
In-Reply-To: <20050521173712.ZFMI25800.tomts13-srv.bellnexxia.net@JohnDesktop8300>
References: <20050521173712.ZFMI25800.tomts13-srv.bellnexxia.net@JohnDesktop8300>
Message-ID: <x2u0kwidc6.fsf@turmalin.kubism.ku.dk>

"John Fox" <jfox@mcmaster.ca> writes:

> Dear R-devel list members,
> 
> I'm considering adding support for other languages than English to the Rcmdr
> package. I understand that the use of Tcl/Tk by the Rcmdr package means I
> won't be able to make full use of the internationalization facilities in R
> 2.1.0. I'm interested, therefore, in whether the following, more limited,
> strategy (which bears some similarity to the internationalization facilities
> in R) seems reasonable or whether there's a better approach. As well, I'm
> interested in whether the proposed approach is sufficiently flexible to be
> worthwhile -- does it cover enough languages?
> 
> It would be simple for me to provide a file of messages, labels, and other
> text used by the Rcmdr, organizing this file with one message per line. A
> copy of the file, named, e.g., messages.francais, could contain translations
> into another language (e.g, French). Setting
> options(Rcmdr=list(language=francais)) would then activate translation when
> the Rcmdr starts up, reading the messages file into a data frame, treating
> the English text as row names. The messages could be handled by a function,
> say Text(), which would return English or translated text, as appropriate.
> Some experimentation shows that message retrieval by this scheme is
> essentially instantaneous even when there are several thousand relatively
> long messages in the data frame. 

Offhand, I think you're better off latching on to an existing
mechanism. Tcl has something known as "msgcat", which appears to be
similar to GNU gettext (and there are conversion tools), or perhaps
you could interface to gettext itself (we do have the gettext()
function at the R level).

Two tricky bits: 

(A) shortcut keys, which need to be coordinated to menu items
    ("Accept/Break/Cancel" translates to "Accepter/Afbryd/Annuller" in
    Danish - if you're a little malicious, anyway)

(B) What is the general mechanism for extending message catalogs by an
    R package?

Brian may well have thought of this stuff already.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From phgrosjean at sciviews.org  Sun May 22 06:52:52 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sun May 22 06:53:16 2005
Subject: [Rd] Internationalizing the Rcmdr package?
In-Reply-To: <x2u0kwidc6.fsf@turmalin.kubism.ku.dk>
References: <20050521173712.ZFMI25800.tomts13-srv.bellnexxia.net@JohnDesktop8300>
	<x2u0kwidc6.fsf@turmalin.kubism.ku.dk>
Message-ID: <42901024.1080702@sciviews.org>

Hello John and Peter (and all),

Yes, it is probably better to use the same method as R uses, with po 
files and gettext(). We are currently translating R in French and it 
takes one hour or two to figure out how to do these translations with, 
let's say, poedit. We would not like to deal with different exotic 
translation files for different additonal packages.

I volunteer to translate RCmdr in French. You know it will be very 
useful for my students.

You are certainly better to ask Brian Ripley directly for details on how 
to implement this. However, may I suggest you first look at the code and 
the ./po subdirectory of base and recommended packages of the R 2.1.x 
version (for instance, source of base, graphics, or packages in the VR 
bundle -class, MASS, nnet & spatial-) to get an idea of changes 
introduced for internationalization.
Best,

Philippe

..............................................<?}))><........
  ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
  ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
  ) ) ) ) )   Mons-Hainaut University, Pentagone (3D08)
( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
  ) ) ) ) )   8, av du Champ de Mars, 7000 Mons, Belgium
( ( ( ( (
  ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.30.54
( ( ( ( (    email: Philippe.Grosjean@umh.ac.be
  ) ) ) ) )
( ( ( ( (    web:   http://www.umh.ac.be/~econum
  ) ) ) ) )          http://www.sciviews.org
( ( ( ( (
..............................................................

Peter Dalgaard wrote:
> "John Fox" <jfox@mcmaster.ca> writes:
> 
> 
>>Dear R-devel list members,
>>
>>I'm considering adding support for other languages than English to the Rcmdr
>>package. I understand that the use of Tcl/Tk by the Rcmdr package means I
>>won't be able to make full use of the internationalization facilities in R
>>2.1.0. I'm interested, therefore, in whether the following, more limited,
>>strategy (which bears some similarity to the internationalization facilities
>>in R) seems reasonable or whether there's a better approach. As well, I'm
>>interested in whether the proposed approach is sufficiently flexible to be
>>worthwhile -- does it cover enough languages?
>>
>>It would be simple for me to provide a file of messages, labels, and other
>>text used by the Rcmdr, organizing this file with one message per line. A
>>copy of the file, named, e.g., messages.francais, could contain translations
>>into another language (e.g, French). Setting
>>options(Rcmdr=list(language=francais)) would then activate translation when
>>the Rcmdr starts up, reading the messages file into a data frame, treating
>>the English text as row names. The messages could be handled by a function,
>>say Text(), which would return English or translated text, as appropriate.
>>Some experimentation shows that message retrieval by this scheme is
>>essentially instantaneous even when there are several thousand relatively
>>long messages in the data frame. 
> 
> 
> Offhand, I think you're better off latching on to an existing
> mechanism. Tcl has something known as "msgcat", which appears to be
> similar to GNU gettext (and there are conversion tools), or perhaps
> you could interface to gettext itself (we do have the gettext()
> function at the R level).
> 
> Two tricky bits: 
> 
> (A) shortcut keys, which need to be coordinated to menu items
>     ("Accept/Break/Cancel" translates to "Accepter/Afbryd/Annuller" in
>     Danish - if you're a little malicious, anyway)
> 
> (B) What is the general mechanism for extending message catalogs by an
>     R package?
> 
> Brian may well have thought of this stuff already.
> 
>

From tim.cole at ich.ucl.ac.uk  Sun May 22 09:59:12 2005
From: tim.cole at ich.ucl.ac.uk (tim.cole@ich.ucl.ac.uk)
Date: Sun May 22 09:59:15 2005
Subject: [Rd] R2.1.0a.dmg fails to mount (PR#7886)
Message-ID: <20050522075912.0794E8709@slim.kubism.ku.dk>

Full_Name: Tim Cole
Version: 2.1.0a
OS: Mac OS X 10.3.9
Submission from: (NULL) (62.253.128.15)


I'm having trouble installing R2.1.0a - double-clicking on the .dmg file gives
the error message 

The following disk images failed to mount

Image		Reason
R-2.1.0a.dmg	no mountable file systems

From ligges at statistik.uni-dortmund.de  Sun May 22 13:10:40 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun May 22 13:08:24 2005
Subject: [Rd] Internationalizing the Rcmdr package?
In-Reply-To: <x2u0kwidc6.fsf@turmalin.kubism.ku.dk>
References: <20050521173712.ZFMI25800.tomts13-srv.bellnexxia.net@JohnDesktop8300>
	<x2u0kwidc6.fsf@turmalin.kubism.ku.dk>
Message-ID: <429068B0.1060404@statistik.uni-dortmund.de>

For sure you have already read the write ups at 
http://developer.r-project.org/Translations.html as well as the 
corresponding sections in "Writing R Extesnsions"? There is also an 
article in the recent R News.

I have tried out a toy example some time before the docs were that 
complete (February-March?), and it already worked very well. Rcmdr is a 
much bigger task, of course!

Peters point ("Accept/Break/Cancel" translates to 
"Accepter/Afbryd/Annuller") is a very important one. A similar problem 
with translations of RGui broke my workarounds for RWinEdt....

Uwe



Peter Dalgaard wrote:

> "John Fox" <jfox@mcmaster.ca> writes:
> 
> 
>>Dear R-devel list members,
>>
>>I'm considering adding support for other languages than English to the Rcmdr
>>package. I understand that the use of Tcl/Tk by the Rcmdr package means I
>>won't be able to make full use of the internationalization facilities in R
>>2.1.0. I'm interested, therefore, in whether the following, more limited,
>>strategy (which bears some similarity to the internationalization facilities
>>in R) seems reasonable or whether there's a better approach. As well, I'm
>>interested in whether the proposed approach is sufficiently flexible to be
>>worthwhile -- does it cover enough languages?
>>
>>It would be simple for me to provide a file of messages, labels, and other
>>text used by the Rcmdr, organizing this file with one message per line. A
>>copy of the file, named, e.g., messages.francais, could contain translations
>>into another language (e.g, French). Setting
>>options(Rcmdr=list(language=francais)) would then activate translation when
>>the Rcmdr starts up, reading the messages file into a data frame, treating
>>the English text as row names. The messages could be handled by a function,
>>say Text(), which would return English or translated text, as appropriate.
>>Some experimentation shows that message retrieval by this scheme is
>>essentially instantaneous even when there are several thousand relatively
>>long messages in the data frame. 
> 
> 
> Offhand, I think you're better off latching on to an existing
> mechanism. Tcl has something known as "msgcat", which appears to be
> similar to GNU gettext (and there are conversion tools), or perhaps
> you could interface to gettext itself (we do have the gettext()
> function at the R level).
> 
> Two tricky bits: 
> 
> (A) shortcut keys, which need to be coordinated to menu items
>     ("Accept/Break/Cancel" translates to "Accepter/Afbryd/Annuller" in
>     Danish - if you're a little malicious, anyway)
> 
> (B) What is the general mechanism for extending message catalogs by an
>     R package?
> 
> Brian may well have thought of this stuff already.
> 
>

From celena at wosaddict.com  Sun May 22 14:31:16 2005
From: celena at wosaddict.com (celena@wosaddict.com)
Date: Sun May 22 14:31:20 2005
Subject: [Rd] Have you checked the latest-weekly special yet? (PR#7887)
Message-ID: <20050522123116.E33F4A24F@slim.kubism.ku.dk>

Locate the better alternative that can help you bank a lot of funds on
rxdrugs.. It is an original way to shoppe for tablets. It is your choice for
timely and reliable shipment.

Start novv and check all the items at our pharrn-site.
http://epn.Ra.highervalueforall.com/m43H/

Our cyber-store supplies quality tablets on pain, swelling, man's care,
male erectile member dysfunction, sleeping disorder, stress, obesity,
muscle-relaxant and raised cholesterol.  Choose our company for quality
medicines with quick distribution and handling services.



sufficiently d be seenin their clothes as well as in t. I like a jo
overcame
ds of people c b of that sort exce her
ssively.' I never shall forget hi dread
s manner. 5 of this ame from all parts t 8 formidable personage

From simon.urbanek at r-project.org  Sun May 22 20:43:36 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun May 22 20:43:48 2005
Subject: [Rd] R2.1.0a.dmg fails to mount (PR#7886)
In-Reply-To: <20050522075912.0794E8709@slim.kubism.ku.dk>
References: <20050522075912.0794E8709@slim.kubism.ku.dk>
Message-ID: <DE0CDF7F-7A70-4367-A22C-CBF10F4296F8@r-project.org>

Please check the list before submitting redundant reports, empty your  
cache and download the file from a different mirror. The file must be  
over 20MB bytes big if the download is complete.

Thanks,
Simon

On May 22, 2005, at 3:59 AM, tim.cole@ich.ucl.ac.uk wrote:

> Full_Name: Tim Cole
> Version: 2.1.0a
> OS: Mac OS X 10.3.9
> Submission from: (NULL) (62.253.128.15)
>
>
> I'm having trouble installing R2.1.0a - double-clicking on the .dmg  
> file gives
> the error message
>
> The following disk images failed to mount
>
> Image        Reason
> R-2.1.0a.dmg    no mountable file systems
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>

From bhx2 at mevik.net  Sun May 22 22:56:49 2005
From: bhx2 at mevik.net (bhx2@mevik.net)
Date: Sun May 22 22:56:50 2005
Subject: [Rd] R-exts.texi: nuke-trailing-whitespace has changed name
	(PR#7888)
Message-ID: <20050522205649.33BD7A27D@slim.kubism.ku.dk>

Full_Name: Bj?rn-Helge Mevik
Version: 2.1.0
OS: GNU/Debian 3.0 Linux
Submission from: (NULL) (80.111.104.162)


In Appendix B R coding standards of the Writing R Extensions manual, Emacs/ESS
users are encouraged to use

(add-hook 'ess-mode-hook
          (lambda ()
            (ess-set-style 'C++)
            ;; [snip]
            (add-hook 'local-write-file-hooks
                      (lambda ()
                        (nuke-trailing-whitespace)))))

However, as of ess-5.2.4 (current is 5.2.8) `nuke-trailing-whitespace' has
changed name to `ess-nuke-trailing-whitespace'.

In addition: by default, ess-nuke-trailing-whitespace is a no-op (as was
nuke-trailing-whitespace).  To `activate' it one must set
ess-nuke-trailing-whitespace-p to t or 'ask (default is nil), e.g.
(setq ess-nuke-trailing-whitespace-p t)

From daniele at medri.org  Mon May 23 09:33:04 2005
From: daniele at medri.org (Daniele Medri)
Date: Mon May 23 09:33:13 2005
Subject: [Rd] Best configure options for Data Mining
Message-ID: <1116833584.12645.30.camel@localhost.localdomain>

Dears,

I am selecting configure-options for Data Mining applications with R,
notes that guide a user from SVN repository to system compilation on
GNU/Linux system ("gcc" as compiler).

Status:

* My system specs:
	- processor Intel 2.8Ghz HT
	- kernel Linux 2.6.10-5-686-smp
	- ram 1500 Mbyte

* Dataset to use:
	- ~900 Mbyte of text file

* R from svn repository (daily updated)

* Installed libs:
	atlas3
	lapack3

* Configure options now:

./configure --prefix=/usr  --with-blas  --with-lapack --enable-linux-lfs
--with-zlib --with-bzlib --with-pcre --with-gnu-ld

Questions:

1. after configure execution, I read that my compilation will be with
lapack generic. Could I have a better option for that?

2. any good option to add/remove from configure arguments?

3. could I gain better result re-compiling the installed libs or kernel?
If true, benchmarks justify the time spent?

4. ways for benchmarking builds?


Thanks for your gentle answers.

Cheers
-- 
DM

From rpeng at jhsph.edu  Mon May 23 14:27:15 2005
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Mon May 23 14:27:32 2005
Subject: [Rd] Best configure options for Data Mining
In-Reply-To: <1116833584.12645.30.camel@localhost.localdomain>
References: <1116833584.12645.30.camel@localhost.localdomain>
Message-ID: <4291CC23.4030104@jhsph.edu>

With the exception of the '--prefix' and the '--enable-linux-lfs' 
switches, the other switches are not necessary.  If you put the ATLAS 
BLAS libraries in a standard location (i.e. '/usr/local/lib') the 
configure script will find it automatically.

I'm not sure there's a set of 'configure' options that is 'optimal' for 
data mining.  I'm not even sure what that means.

-roger

Daniele Medri wrote:
> Dears,
> 
> I am selecting configure-options for Data Mining applications with R,
> notes that guide a user from SVN repository to system compilation on
> GNU/Linux system ("gcc" as compiler).
> 
> Status:
> 
> * My system specs:
> 	- processor Intel 2.8Ghz HT
> 	- kernel Linux 2.6.10-5-686-smp
> 	- ram 1500 Mbyte
> 
> * Dataset to use:
> 	- ~900 Mbyte of text file
> 
> * R from svn repository (daily updated)
> 
> * Installed libs:
> 	atlas3
> 	lapack3
> 
> * Configure options now:
> 
> ./configure --prefix=/usr  --with-blas  --with-lapack --enable-linux-lfs
> --with-zlib --with-bzlib --with-pcre --with-gnu-ld
> 
> Questions:
> 
> 1. after configure execution, I read that my compilation will be with
> lapack generic. Could I have a better option for that?
> 
> 2. any good option to add/remove from configure arguments?
> 
> 3. could I gain better result re-compiling the installed libs or kernel?
> If true, benchmarks justify the time spent?
> 
> 4. ways for benchmarking builds?
> 
> 
> Thanks for your gentle answers.
> 
> Cheers

-- 
Roger D. Peng
http://www.biostat.jhsph.edu/~rpeng/

From abunn at whrc.org  Mon May 23 14:57:47 2005
From: abunn at whrc.org (abunn@whrc.org)
Date: Mon May 23 14:57:51 2005
Subject: [Rd] Windows/7706 (PR#7889)
Message-ID: <20050523125747.36A02A22C@slim.kubism.ku.dk>

With 2.1 on Windows XP SP2 (32 bit) I also get no title in a png plot, so I
can reproduce this bug. R is installed from pre-built binary.

No title appears when I run this:
     png("foo.png")
     plot(1:10, main = "foo")
     dev.off()
The jpeg device behaves as expected:
     jpeg("foo.jpg")
     plot(1:10, main = "foo")
     dev.off()

Thoughts on this? It looks like

http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706

Cheers,
-Andy

R > version
         _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    1.0
year     2005
month    04
day      18
language R

From phgrosjean at sciviews.org  Mon May 23 15:05:15 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Mon May 23 15:06:11 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <20050523125747.36A02A22C@slim.kubism.ku.dk>
References: <20050523125747.36A02A22C@slim.kubism.ku.dk>
Message-ID: <4291D50B.2010804@sciviews.org>

abunn@whrc.org wrote:
> With 2.1 on Windows XP SP2 (32 bit) I also get no title in a png plot, so I
> can reproduce this bug. R is installed from pre-built binary.
> 
> No title appears when I run this:
>      png("foo.png")
>      plot(1:10, main = "foo")
>      dev.off()
> The jpeg device behaves as expected:
>      jpeg("foo.jpg")
>      plot(1:10, main = "foo")
>      dev.off()
> 
> Thoughts on this? It looks like
> 
> http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706
> 
> Cheers,
> -Andy
> 
> R > version
>          _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R

I can't reproduce this bug (work as expected) on my system:
Windows XP SP2 US with:
 > version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    1.0
year     2005
month    04
day      18
language R

So, similar config as yours???!!!

Best,

Philippe Grosjean

From abunn at whrc.org  Mon May 23 15:19:28 2005
From: abunn at whrc.org (Andy Bunn)
Date: Mon May 23 15:20:06 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <4291D50B.2010804@sciviews.org>
Message-ID: <NEBBIPHDAMMOKDKPOFFIKEFEDGAA.abunn@whrc.org>

Is there a way to check the png build on my system?

> -----Original Message-----
> From: Philippe Grosjean [mailto:phgrosjean@sciviews.org]
> Sent: Monday, May 23, 2005 9:05 AM
> To: abunn@whrc.org
> Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
> Subject: Re: [Rd] Windows/7706 (PR#7889)
> 
> 
> abunn@whrc.org wrote:
> > With 2.1 on Windows XP SP2 (32 bit) I also get no title in a 
> png plot, so I
> > can reproduce this bug. R is installed from pre-built binary.
> > 
> > No title appears when I run this:
> >      png("foo.png")
> >      plot(1:10, main = "foo")
> >      dev.off()
> > The jpeg device behaves as expected:
> >      jpeg("foo.jpg")
> >      plot(1:10, main = "foo")
> >      dev.off()
> > 
> > Thoughts on this? It looks like
> > 
> > http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706
> > 
> > Cheers,
> > -Andy
> > 
> > R > version
> >          _
> > platform i386-pc-mingw32
> > arch     i386
> > os       mingw32
> > system   i386, mingw32
> > status
> > major    2
> > minor    1.0
> > year     2005
> > month    04
> > day      18
> > language R
> 
> I can't reproduce this bug (work as expected) on my system:
> Windows XP SP2 US with:
>  > version
>           _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
> 
> So, similar config as yours???!!!
> 
> Best,
> 
> Philippe Grosjean
> 
>

From phgrosjean at sciviews.org  Mon May 23 15:48:33 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Mon May 23 15:48:57 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <NEBBIPHDAMMOKDKPOFFIKEFEDGAA.abunn@whrc.org>
References: <NEBBIPHDAMMOKDKPOFFIKEFEDGAA.abunn@whrc.org>
Message-ID: <4291DF31.4090906@sciviews.org>

According to the link you cite 
(http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706), it seems it is 
related to an AMD Athlon processor. Mine is an Intel Pentium IV HT 
3.0Ghz processor, which could explain, why I cannot reproduce this bug. 
You can compile R yourself with various versions of libpng. Looking at: 
http://www.murdoch-sutherland.com/Rtools/, you can read that R 2.1.0 was 
(probably?) compiled using libpng-1.2.5.tar.gz, i.e., the latest stable 
version. You could try libpng-1.2.6 to see if it solves your problem.
Best,

Philippe Grosjean

Andy Bunn wrote:
> Is there a way to check the png build on my system?
> 
> 
>>-----Original Message-----
>>From: Philippe Grosjean [mailto:phgrosjean@sciviews.org]
>>Sent: Monday, May 23, 2005 9:05 AM
>>To: abunn@whrc.org
>>Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
>>Subject: Re: [Rd] Windows/7706 (PR#7889)
>>
>>
>>abunn@whrc.org wrote:
>>
>>>With 2.1 on Windows XP SP2 (32 bit) I also get no title in a 
>>
>>png plot, so I
>>
>>>can reproduce this bug. R is installed from pre-built binary.
>>>
>>>No title appears when I run this:
>>>     png("foo.png")
>>>     plot(1:10, main = "foo")
>>>     dev.off()
>>>The jpeg device behaves as expected:
>>>     jpeg("foo.jpg")
>>>     plot(1:10, main = "foo")
>>>     dev.off()
>>>
>>>Thoughts on this? It looks like
>>>
>>>http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706
>>>
>>>Cheers,
>>>-Andy
>>>
>>>R > version
>>>         _
>>>platform i386-pc-mingw32
>>>arch     i386
>>>os       mingw32
>>>system   i386, mingw32
>>>status
>>>major    2
>>>minor    1.0
>>>year     2005
>>>month    04
>>>day      18
>>>language R
>>
>>I can't reproduce this bug (work as expected) on my system:
>>Windows XP SP2 US with:
>> > version
>>          _
>>platform i386-pc-mingw32
>>arch     i386
>>os       mingw32
>>system   i386, mingw32
>>status
>>major    2
>>minor    1.0
>>year     2005
>>month    04
>>day      18
>>language R
>>
>>So, similar config as yours???!!!
>>
>>Best,
>>
>>Philippe Grosjean
>>
>>
> 
> 
>

From jmacdon at med.umich.edu  Mon May 23 16:02:05 2005
From: jmacdon at med.umich.edu (James W. MacDonald)
Date: Mon May 23 16:04:23 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <4291DF31.4090906@sciviews.org>
References: <NEBBIPHDAMMOKDKPOFFIKEFEDGAA.abunn@whrc.org>
	<4291DF31.4090906@sciviews.org>
Message-ID: <4291E25D.7060307@med.umich.edu>

Philippe Grosjean wrote:
> According to the link you cite 
> (http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706), it seems it is 
> related to an AMD Athlon processor. Mine is an Intel Pentium IV HT 
> 3.0Ghz processor, which could explain, why I cannot reproduce this bug. 

I don't think it is AMD specific, because I can reproduce this bug using 
R-2.1.0 patched on a P4 HT processor. I get the same result as Andy 
using both

png("foo.png")
plot(1:10, main="foo")
dev.off()

and

plot(1:10, main="foo")
savePlot("foo","png")

Best,

Jim


platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status   Patched
major    2
minor    1.0
year     2005
month    05
day      14
language R


-- 
James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109
734-647-5623

From jmacdon at med.umich.edu  Mon May 23 16:04:26 2005
From: jmacdon at med.umich.edu (jmacdon@med.umich.edu)
Date: Mon May 23 16:04:29 2005
Subject: [Rd] Windows/7706 (PR#7889)
Message-ID: <20050523140426.21A728709@slim.kubism.ku.dk>

Philippe Grosjean wrote:
> According to the link you cite 
> (http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706), it seems it is 
> related to an AMD Athlon processor. Mine is an Intel Pentium IV HT 
> 3.0Ghz processor, which could explain, why I cannot reproduce this bug. 

I don't think it is AMD specific, because I can reproduce this bug using 
R-2.1.0 patched on a P4 HT processor. I get the same result as Andy 
using both

png("foo.png")
plot(1:10, main="foo")
dev.off()

and

plot(1:10, main="foo")
savePlot("foo","png")

Best,

Jim


platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status   Patched
major    2
minor    1.0
year     2005
month    05
day      14
language R


-- 
James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109
734-647-5623

From abunn at whrc.org  Mon May 23 16:09:12 2005
From: abunn at whrc.org (Andy Bunn)
Date: Mon May 23 16:09:41 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <4291DF31.4090906@sciviews.org>
Message-ID: <NEBBIPHDAMMOKDKPOFFICEFGDGAA.abunn@whrc.org>

> According to the link you cite
> (http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706), it seems it is
> related to an AMD Athlon processor. Mine is an Intel Pentium IV HT
> 3.0Ghz processor, which could explain, why I cannot reproduce this bug.

I have an Intel Pentium M processor at 1.60GHz so I guess this isn't
specific to the AMD. I just rebuilt from source using the current RTools
suite and get the same glitch. I have not tried the latest png version.

-Andy

From murdoch at stats.uwo.ca  Mon May 23 17:32:59 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon May 23 17:32:37 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <4291E25D.7060307@med.umich.edu>
References: <NEBBIPHDAMMOKDKPOFFIKEFEDGAA.abunn@whrc.org>	<4291DF31.4090906@sciviews.org>
	<4291E25D.7060307@med.umich.edu>
Message-ID: <4291F7AB.4020201@stats.uwo.ca>

James W. MacDonald wrote:
> Philippe Grosjean wrote:
> 
>>According to the link you cite 
>>(http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706), it seems it is 
>>related to an AMD Athlon processor. Mine is an Intel Pentium IV HT 
>>3.0Ghz processor, which could explain, why I cannot reproduce this bug. 
> 
> 
> I don't think it is AMD specific, because I can reproduce this bug using 
> R-2.1.0 patched on a P4 HT processor. I get the same result as Andy 
> using both
> 
> png("foo.png")
> plot(1:10, main="foo")
> dev.off()
> 
> and
> 
> plot(1:10, main="foo")
> savePlot("foo","png")
> 
> Best,
> 
> Jim
> 
> 
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status   Patched
> major    2
> minor    1.0
> year     2005
> month    05
> day      14

I think this is likely related to bug 7860, which I fixed right around 
May 14.  Does your CHANGES file include these lines:

> For some operations on windows() and related devices the first text
> drawn could be improperly sized. (PR#7860).

If not, please download a newer copy of R-patched, and see if you can 
still reproduce the bug.  I can't reproduce it in a recent build.

Duncan Murdoch

From murdoch at stats.uwo.ca  Mon May 23 17:32:37 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Mon May 23 17:32:40 2005
Subject: [Rd] Windows/7706 (PR#7889)
Message-ID: <20050523153237.27B488709@slim.kubism.ku.dk>

James W. MacDonald wrote:
> Philippe Grosjean wrote:
> 
>>According to the link you cite 
>>(http://r-bugs.biostat.ku.dk/cgi-bin/R/Windows?id=7706), it seems it is 
>>related to an AMD Athlon processor. Mine is an Intel Pentium IV HT 
>>3.0Ghz processor, which could explain, why I cannot reproduce this bug. 
> 
> 
> I don't think it is AMD specific, because I can reproduce this bug using 
> R-2.1.0 patched on a P4 HT processor. I get the same result as Andy 
> using both
> 
> png("foo.png")
> plot(1:10, main="foo")
> dev.off()
> 
> and
> 
> plot(1:10, main="foo")
> savePlot("foo","png")
> 
> Best,
> 
> Jim
> 
> 
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status   Patched
> major    2
> minor    1.0
> year     2005
> month    05
> day      14

I think this is likely related to bug 7860, which I fixed right around 
May 14.  Does your CHANGES file include these lines:

> For some operations on windows() and related devices the first text
> drawn could be improperly sized. (PR#7860).

If not, please download a newer copy of R-patched, and see if you can 
still reproduce the bug.  I can't reproduce it in a recent build.

Duncan Murdoch

From jmacdon at med.umich.edu  Mon May 23 17:47:45 2005
From: jmacdon at med.umich.edu (James W. MacDonald)
Date: Mon May 23 17:49:48 2005
Subject: [Rd] Windows/7706 (PR#7889)
In-Reply-To: <20050523153237.27B488709@slim.kubism.ku.dk>
References: <20050523153237.27B488709@slim.kubism.ku.dk>
Message-ID: <4291FB21.5010507@med.umich.edu>

murdoch@stats.uwo.ca wrote:
> I think this is likely related to bug 7860, which I fixed right around 
> May 14.  Does your CHANGES file include these lines:
> 
> 
>>For some operations on windows() and related devices the first text
>>drawn could be improperly sized. (PR#7860).
> 
> 
> If not, please download a newer copy of R-patched, and see if you can 
> still reproduce the bug.  I can't reproduce it in a recent build.

I just downloaded a newer version of R-patched (with the above lines in 
the CHANGES file), and I can still reproduce the bug.

 > R.version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status   Patched
major    2
minor    1.0
year     2005
month    05
day      20
language R


Best,

Jim


> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
James W. MacDonald
Affymetrix and cDNA Microarray Core
University of Michigan Cancer Center
1500 E. Medical Center Drive
7410 CCGC
Ann Arbor MI 48109
734-647-5623

From vangyzen at stat.duke.edu  Mon May 23 17:58:55 2005
From: vangyzen at stat.duke.edu (vangyzen@stat.duke.edu)
Date: Mon May 23 17:59:01 2005
Subject: [Rd] alloca() on FreeBSD (PR#7890)
Message-ID: <20050523155855.748618709@slim.kubism.ku.dk>

Full_Name: Eric van Gyzen
Version: 2.1.0
OS: FreeBSD 5.4
Submission from: (NULL) (152.3.22.33)


R-2.1.0 fails to compile on the newest release of FreeBSD, complaining about
undefined references to __builtin_alloca.  On FreeBSD, alloca() is declared in
stdlib.h, not alloca.h as the R sources expect.  Therefore, HAVE_DECL_ALLOCA
does not get set, so the R sources declare alloca() after it has already been
#defined by stdlib.h.

A possible fix is to modify the configure script to look for the declaration of
alloca() in stdlib.h (perhaps after it fails to find it in alloca.h).

This was previously reported in PR#7881.

From tplate at blackmesacapital.com  Mon May 23 18:50:59 2005
From: tplate at blackmesacapital.com (Tony Plate)
Date: Mon May 23 18:51:18 2005
Subject: [Rd] problems with truncate() with files > 2Gb under Windows
	(possibly (PR#7879)
In-Reply-To: <Pine.LNX.4.61.0505201035490.12626@gannet.stats>
References: <20050519154835.6E46EED78@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0505201013350.12196@gannet.stats>
	<Pine.LNX.4.61.0505201035490.12626@gannet.stats>
Message-ID: <429209F3.7070600@blackmesacapital.com>

I have some code that seems to work (as in has the desired effect on 
files) to truncate files >2Gb under Windows.

Here's my modified version of the file_truncate function:

static void file_truncate(Rconnection con)
{
     Rfileconn this = con->private;
     FILE *fp = this->fp;
     int fd = fileno(fp);
#ifdef Win32
     off64_t size = f_tell(fp);
     HANDLE fh; /* a Windows-specific resource pointer */
#elif defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
     off_t size = f_tell(fp);
#else
     long size = f_tell(fp);
#endif

     if(!con->isopen || !con->canwrite)
	error(_("can only truncate connections open for writing"));

     if(!this->last_was_write) this->rpos = f_tell(this->fp);
#if defined(Win32)
     /* ftruncate() (supplied by MinGW?) does not work for files>2Gb */
     /* (returns without error, but has no effect on file size), so */
     /* use native Windows calls. */
     /* Flush for safety, especially as we are mixing calls to */
     /* different levels of file I/O. */
     fflush(fp);
     fh = _get_osfhandle(fd);
     if (SetEndOfFile(fh) == 0) {
	char buf[100];
	sprintf(buf, "SetEndOfFile failed: %d\n", GetLastError() );
	error(_(buf));
     }
#elif HAVE_FTRUNCATE
     if(ftruncate(fd, size))
	error(_("file truncation failed"));
#else
     error(_("file truncation unavailable on this platform"));
#endif
     this->last_was_write = TRUE;
     this->wpos = f_tell(this->fp);
}


This also requires putting
# include <windows.h>
within the appropriate "#ifdef Win32" at the start of the file.

I hadn't realized until now that HAVE_FTRUNCATE is true in the MinGW 
environment, but as far as I can see there are no other calls to 
ftruncate() in the R base code, so still this place should be only one 
needing a change re ftruncate().  I don't know much about MinGW, but it 
appears (from reading the MinGW include/windows.h) that ftruncate() in 
MinGW just calls chsize() with the 64bit int length arg of ftruncate() 
coerced to the long int arg that chsize() accepts, so one could argue 
that MinGW is what is broken here.  Nonetheless, I hope you will 
consider the above change to make R work regardless of whether or not 
MinGW has bugs.

This is getting to be more than just a few lines of change, let me know 
if sending a patch is appropriate.

Here's an example of truncating a file > 2Gb.  Note that the "r" seek 
after a write after truncation does not appear to position the file 
pointer properly, but the same thing happens with small files in R 
without my modifications, so I suspect this is an independent issue 
(maybe not even involving truncation).

 > options(digits=15)
 > f <- file("tmp1.txt", "wb")
 > seek(f, 2200000000, rw="w")
[1] 0
 > writeLines(c("abc", "def"), f)
 > close(f)
 > options(digits=15)
 > f <- file("tmp1.txt", "r+b")
 > seek(f, 0, "end", rw="w")
[1] 0
 > seek(f, NA, rw="w")
[1] 2200000008
 > seek(f, 2200000004, rw="w")
[1] 2200000008
 > truncate(f)
NULL
 > # Try to read at the end of the file
 > seek(f, 0, "end", rw="r")
[1] 0
 > readLines(f, -1)
character(0)
 > seek(f, 0, "end", rw="r")
[1] 2200000004
 > # see if we successfully truncated...
 > # can also verify this by watching file size with 'ls -l')
 > seek(f, NA, rw="r")
[1] 2200000004
 > # write something at the end of the file
 > seek(f, 0, "end", rw="w")
[1] 2200000004
 > writeLines(c("def"), f)
 > # Try to read at the end of the file -- the result is *WRONG* here
 > # (If we do the seek() twice, we get the correct result.  We also
 > #  get the correct result if we call flush(f) before the seek. The
 > #  same thing also happens with small files).
 > # flush(f) # makes the seek work correctly
 > seek(f, 0, "end", rw="r")
[1] 2200000004
 > readLines(f, -1) # should return character(0)
[1] "def"
 > seek(f, 2200000000, rw="r")
[1] 2200000008
 > readLines(f, -1)
[1] "abc" "def"
 > # Write something earlier in the file
 > seek(f, 1000000000, rw="w")
[1] 2200000008
 > writeLines(c("ghi", "jkl"), f)
 > seek(f, 1000000000, rw="r")
[1] 2200000008
 > readLines(f, 2)
[1] "ghi" "jkl"
 > seek(f, 2200000000, rw="r")
[1] 1000000008
 > readLines(f, -1)
[1] "abc" "def"
 > close(f)
 >

Let me know if there is anything else I can do to make it easy for you 
to incorporate these changes (or what else you'd like to see to believe 
that these changes have a good chance of working properly overall.)

-- Tony Plate

Prof Brian Ripley wrote:
> On Fri, 20 May 2005, Prof Brian Ripley wrote:
> 
>> To follow up on the truncate() part of this, Windows does not use 
>> chsize directly any more, but ftruncate like all other platforms.  
>> However, truncate() was limited to files < 2Gb on all platforms.  I 
>> have changed the latter and your example now works both on 32-bit 
>> Windows and on 64-bit Linux.
> 
> 
> I am sorry, I should clarify `works', as I had not cross-checked well 
> enough.  There are no errors generated by the C call but ftruncate 
> appears not to do what is required of it, despite having off_t as an 
> argument. That is, at R level everything appears fine but the file was 
> not truncated when looked at outside R.
> 
> Not much we can do about broken OS calls.
>

From pelzc at ohsu.edu  Mon May 23 20:35:23 2005
From: pelzc at ohsu.edu (pelzc@ohsu.edu)
Date: Mon May 23 20:35:28 2005
Subject: [Rd] lowess output looks wrong (PR#7891)
Message-ID: <20050523183523.63C638D38@slim.kubism.ku.dk>

Full_Name: Carl Pelz
Version: 2.1.0 & 2.0.1
OS: Windows 2000
Submission from: (NULL) (137.53.64.158)


# Paste this all into an R session for a graphical demonstration of BUG...
# I?ve found a bug in lowess in R versions 2.0.1 & 2.1.0 (Windows binary
versions).
# Running on Windows 2000 system.
# Someone noticed a similar problem and reported it under ID 4459.

# Data to reproduce...
R <- c(3.0, 3.5,  4.5,  5.0,  10.0)
T <- R
T <- 1.5*T + 0.1*(T^2)

# Bug in lowess (third y value is wrong in lowess output)...
xin <- log2(R)
yin <- log2(T)
minVal <- min (xin, yin)
maxVal <- max (xin, yin)
plot (xin, yin, xlim=c(minVal, maxVal), ylim=c(minVal, maxVal))
lines (lowess(xin, yin, f = 2/3, iter = 3))
text(3.5, 2, "3rd lowess point is wrong.", col="red")
text(3.5, 1.75, "Click for next graph.", col="red")
locator (n=1, type="n")

# lowess OK...
xin <- log2(R)
yin <- log2(T)
minVal <- min (xin, yin)
maxVal <- max (xin, yin)
plot (xin, yin, xlim=c(minVal, maxVal), ylim=c(minVal, maxVal))
# f = 1/2
lines (lowess(xin, yin, f = 1/2, iter = 3))
text(3.5, 2, "OK with f = 1/2.", col="red")
text(3.5, 1.75, "Click for next graph.", col="red")
locator (n=1, type="n")

# lowess OK...
xin <- log2(R)
yin <- log2(T)
minVal <- min (xin, yin)
maxVal <- max (xin, yin)
plot (xin, yin, xlim=c(minVal, maxVal), ylim=c(minVal, maxVal))
# iter = 0
lines (lowess(xin, yin, f = 2/3, iter = 0))
text(3.5, 2, "OK with iter = 0.", col="red")
text(3.5, 1.75, "Click for next graph.", col="red")
locator (n=1, type="n")

# Bug in lowess (forth y value is wrong in lowess output)...
xin <- log2(R)
yin <- log2(T)
# Change xin[3]
xin[3] <- 2.2
minVal <- min (xin, yin)
maxVal <- max (xin, yin)
plot (xin, yin, xlim=c(minVal, maxVal), ylim=c(minVal, maxVal))
lines (lowess(xin, yin, f = 2/3, iter = 3))
text(3.5, 2, "4th lowess point is wrong.", col="red")
text(3.5, 1.75, "Done.", col="red")

From vograno at evafunds.com  Tue May 24 06:49:24 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Tue May 24 06:49:39 2005
Subject: [Rd] Rout for  library/base/R-ex/Extract.data.frame.R
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A5AB47A1@phost015.EVAFUNDS.intermedia.net>

Hi,
 
I am writing a light-weight data frame class and want to borrow the test
cases from the standard data frame. I found the test cases in
library/base/R-ex/Extract.data.frame.R, but surprisingly no
corresponding .Rout files. In fact there is no *.Rout file in the entire
tarball. Not that I cann't generate them, but I am just curious why they
are not there? How does the base package get tested?
 
Thanks,
Vadim

	[[alternative HTML version deleted]]

From Sascha.Frydman at aad.gov.au  Tue May 24 07:45:03 2005
From: Sascha.Frydman at aad.gov.au (Sascha.Frydman@aad.gov.au)
Date: Tue May 24 07:45:08 2005
Subject: [Rd] locator() (PR#7873)
Message-ID: <20050524054503.EEAB38709@slim.kubism.ku.dk>

Hi Duncan,
=20 looks like its not completely fixed. With locator running, close the
plot window and then press Esc and R crashes. This happened on the
patched version I installed a couple of days ago.

Cheers,
=20 Sascha Frydman
=20
=20


-----Original Message-----
From: Duncan Murdoch [mailto:murdoch@stats.uwo.ca]=20
Sent: Tuesday, 17 May 2005 6:28 PM
To: Sascha Frydman
Cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] locator() (PR#7873)


sascha.frydman@aad.gov.au wrote:
> Full_Name: Sascha Frydman
> Version: 2.1.0
> OS: Windows XP
> Submission from: (NULL) (147.66.131.10)
>=20
>=20
> when Esc is pressed while a plot with locator running has the focus, R
crashes.
> eg.
> plot(1)
> locator(1)
>=20
> I am running in SDI mode

Thanks for the report.  This is fixed now in the patched version.  It=20
should show up in the snapshot builds on CRAN by tomorrow.

Duncan Murdoch
_________________________________________________________________________=
__

=20   Australian Antarctic Division - Commonwealth of Australia
IMPORTANT: This transmission is intended for the addressee only. If you a=
re not the
intended recipient, you are notified that use or dissemination of this co=
mmunication is
strictly prohibited by Commonwealth law. If you have received this transm=
ission in error,
please notify the sender immediately by e-mail or by telephoning +61 3 62=
32 3209 and
DELETE the message.
=20       Visit our web site at http://www.aad.gov.au/
_________________________________________________________________________=
__

From westfeld at inf.tu-dresden.de  Tue May 24 09:20:28 2005
From: westfeld at inf.tu-dresden.de (westfeld@inf.tu-dresden.de)
Date: Tue May 24 09:20:31 2005
Subject: [Rd] Segmentation violation in eval.c (R 2.1.0) (PR#7893)
Message-ID: <20050524072028.239BA8709@slim.kubism.ku.dk>

This is a multi-part message in MIME format.
--------------080506050109020709090406
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit

Hi,

I get a segmentation fault in eval.c:
do_set (call=0x8ce166c, op=0x82b43b8, args=0x8ce1650, rho=0x8acf218)
    at eval.c:1309
1309                switch (NAMED(s)) {

The instruction is
0x080becf1 <do_set+177>:        movzbl (%eax),%edx

and %eax contains a non-accessible address
(gdb) x/x $eax
0x4a5bf008:     Cannot access memory at address 0x4a5bf008
in another try it was
(gdb) x/x $eax
0x59a5a008:     Cannot access memory at address 0x59a5a008

This segmentation fault occurs reproducible in a long simulation script.
However, I don't know the place in the .R file. I would like to isolate
the bug but don't know how. I attached the gdb session. I use R 2.1.0 on
a Linux machine (Athlon64). Maybe a package that I wrote and use for the
simulation clobbers some memory (although I already added some sanity
checks). But please let me know when you hear about this bug another
time (or have an idea how to debug this or have a solution).

Thank you,

Andreas

-- 
Andreas Westfeld, 0432 01CC F511 9E2B 0B57 5993 0B22 98F8 4AD8 EEEA
<westfeld@inf.tu-dresden.de> http://www.inf.tu-dresden.de/~aw4
TU Dresden Fakult?t Informatik, Institut f?r Systemarchitektur
Datenschutz und Datensicherheit, Tel. +49-351-463-37918


--------------080506050109020709090406
Content-Type: text/plain;
 name="debug.txt"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="debug.txt"

> source("ber3.R")

Program received signal SIGSEGV, Segmentation fault.
do_set (call=0x86c8770, op=0x82b43b8, args=0x86c878c, rho=0x8626404)
    at eval.c:1309
1309                switch (NAMED(s)) {

# PRIMVAL(op): is 1 (code = 1)
(gdb) p R_FunTab[op->u.primsxp.offset]
$14 = {name = 0x81d99e8 "<-", cfun = 0x80bec40 <do_set>, code = 1,
  Rf_eval = 100, arity = -1, gram = {kind = PP_ASSIGN, precedence = PREC_LEFT,
    rightassoc = 1}}

# isSymbol(CAR(args)):
(gdb) p Rf_isSymbol(CAR(args))
$16 = TRUE

# NAMED(s):
(gdb) p s->sxpinfo.named
$20 = 0

# (s =) eval(CADR(args), rho):
(gdb) p *Rf_eval(CADR(args), rho)
$27 = {sxpinfo = {type = 13, obj = 0, named = 0, gp = 0, mark = 0, debug = 0,
    trace = 0, fin = 0, gcgen = 0, gccls = 7}, attrib = 0x82a5588,
  gengc_next_node = 0x1ee60648, gengc_prev_node = 0x4b1cb008, u = {primsxp = {
      offset = 985600}, symsxp = {pname = 0xf0a00, value = 0x0,
      internal = 0x0}, listsxp = {carval = 0xf0a00, cdrval = 0x0,
      tagval = 0x0}, envsxp = {frame = 0xf0a00, enclos = 0x0, hashtab = 0x0},
    closxp = {formals = 0xf0a00, body = 0x0, env = 0x0}, promsxp = {
      value = 0xf0a00, expr = 0x0, env = 0x0}}}

# s:
(gdb) p *s
$28 = {sxpinfo = {type = 7, obj = 0, named = 0, gp = 0, mark = 1, debug = 0,
    trace = 0, fin = 0, gcgen = 1, gccls = 0}, attrib = 0x82a5588,
  gengc_next_node = 0x85ba270, gengc_prev_node = 0x85bb5c8, u = {primsxp = {
      offset = 25}, symsxp = {pname = 0x19, value = 0x82a5588,
      internal = 0x82a5588}, listsxp = {carval = 0x19, cdrval = 0x82a5588,
      tagval = 0x82a5588}, envsxp = {frame = 0x19, enclos = 0x82a5588,
      hashtab = 0x82a5588}, closxp = {formals = 0x19, body = 0x82a5588,
      env = 0x82a5588}, promsxp = {value = 0x19, expr = 0x82a5588,
      env = 0x82a5588}}}

0x080becd6 <do_set+150>:        call   0x815a720 <Rf_isSymbol>
---Type <return> to continue, or q <return> to quit---
0x080becdb <do_set+155>:        test   %eax,%eax
0x080becdd <do_set+157>:        je     0x80bed36 <do_set+246>
0x080becdf <do_set+159>:        mov    %edi,0x4(%esp)
0x080bece3 <do_set+163>:        mov    0x14(%ebx),%eax
0x080bece6 <do_set+166>:        mov    0x10(%eax),%eax
0x080bece9 <do_set+169>:        mov    %eax,(%esp)
0x080becec <do_set+172>:        call   0x80bc530 <Rf_eval>
# here the SIGSEGV occurs:
0x080becf1 <do_set+177>:        movzbl (%eax),%edx

# %eax:
(gdb) x/x $eax
0x4a5bf008:     Cannot access memory at address 0x4a5bf008


SECOND TRY:
Program received signal SIGSEGV, Segmentation fault.
do_set (call=0x8ce166c, op=0x82b43b8, args=0x8ce1650, rho=0x8acf218)
    at eval.c:1309
1309                switch (NAMED(s)) {
(gdb) x/x $eax
0x59a5a008:     Cannot access memory at address 0x59a5a008
(gdb) p *s
$2 = {sxpinfo = {type = 7, obj = 0, named = 0, gp = 0, mark = 1, debug = 0,
    trace = 0, fin = 0, gcgen = 1, gccls = 0}, attrib = 0x82a5588,
  gengc_next_node = 0x85ba270, gengc_prev_node = 0x85bb5c8, u = {primsxp = {
      offset = 25}, symsxp = {pname = 0x19, value = 0x82a5588,
      internal = 0x82a5588}, listsxp = {carval = 0x19, cdrval = 0x82a5588,
      tagval = 0x82a5588}, envsxp = {frame = 0x19, enclos = 0x82a5588,
      hashtab = 0x82a5588}, closxp = {formals = 0x19, body = 0x82a5588,
      env = 0x82a5588}, promsxp = {value = 0x19, expr = 0x82a5588,
      env = 0x82a5588}}}
(gdb)


--------------080506050109020709090406--

From vrunkel at biologie.uni-erlangen.de  Tue May 24 15:11:55 2005
From: vrunkel at biologie.uni-erlangen.de (Volker Runkel)
Date: Tue May 24 15:12:11 2005
Subject: [Rd] R OS X
Message-ID: <AC363775-D167-4BB8-9905-DB4A09FCAE8F@biologie.uni-erlangen.de>

Hi,

with newest R.app (1.11) / R2.1.0a

if a package is installed for the current user, it is not installed  
properly (does not get an installed version entry and is not  
loadable). If installed system wide it works.

The package I installed is xgobi.

MAC OS X 10.4.1

Volker


- - - - - - - - - -     - -    -   ------ ---- ---- --- -- - - - - -  
- -   -   -   -   -   -    -      -     -
Dipl.-Biol. Volker Runkel
Lehrstuhl f. Zoologie II                      www.biologie.uni- 
erlangen.de/zoo2
Staudtstr. 5                                           Telefon:  
09131-85 28788
91058 Erlangen                                 vrunkel@biologie.uni- 
erlangen.de
- - - - - - - - - -     - -    -   ------ ---- ---- --- -- - - - - -  
- -   -   -   -   -   -    -      -     -

From goedman at mac.com  Tue May 24 17:01:00 2005
From: goedman at mac.com (Rob J Goedman)
Date: Tue May 24 17:01:08 2005
Subject: [Rd] R OS X
In-Reply-To: <AC363775-D167-4BB8-9905-DB4A09FCAE8F@biologie.uni-erlangen.de>
References: <AC363775-D167-4BB8-9905-DB4A09FCAE8F@biologie.uni-erlangen.de>
Message-ID: <16E9A36E-8659-4EA6-90AA-087E19A2827C@mac.com>

Hi Volker,

Just tried this with 1 of the few packages I had not installed yet  
systemwide.

In the Startup preferences I selected to add $Home/R/Library and  
restarted R.

Then installed package its and loaded the library and ran the example.

Can you try if that sequence works for you?

A better alias for Mac questions is R-SIG-Mac.

Regards,
Rob


On May 24, 2005, at 6:11 AM, Volker Runkel wrote:

> Hi,
>
> with newest R.app (1.11) / R2.1.0a
>
> if a package is installed for the current user, it is not installed  
> properly (does not get an installed version entry and is not  
> loadable). If installed system wide it works.
>
> The package I installed is xgobi.
>
> MAC OS X 10.4.1
>
> Volker
>
>
> - - - - - - - - - -     - -    -   ------ ---- ---- --- -- - - - -  
> - - -   -   -   -   -   -    -      -     -
> Dipl.-Biol. Volker Runkel
> Lehrstuhl f. Zoologie II                      www.biologie.uni- 
> erlangen.de/zoo2
> Staudtstr. 5                                           Telefon:  
> 09131-85 28788
> 91058 Erlangen                                 vrunkel@biologie.uni- 
> erlangen.de
> - - - - - - - - - -     - -    -   ------ ---- ---- --- -- - - - -  
> - - -   -   -   -   -   -    -      -     -
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From marquardt.christian at gmail.com  Tue May 24 18:17:10 2005
From: marquardt.christian at gmail.com (marquardt.christian@gmail.com)
Date: Tue May 24 18:17:16 2005
Subject: [Rd] Reversing axis in a log plot (PR#7894)
Message-ID: <20050524161710.EC4F7ECDF@slim.kubism.ku.dk>

Full_Name: Christian Marquardt
Version: 2.1.0
OS: Linux (Redhat 9)
Submission from: (NULL) (151.170.240.10)


Following the advice of a reader of R-help, I would now like to submit this as a
bug report:

Say we have

  x = seq(1,3, by = 0.01)
  y = exp(x)

Plotting and reversing linear axis is fine

   plot(x,y)
   plot(x,y, ylim = c(30,1))

as is a usual log-plot:

  plot(x,y, log = "y", ylim = c(1,30))

However,

  plot(x,y, log = "y", ylim = c(30,1))

fails with

  Error in axis(2, ...) : log - axis(), 'at' creation, _SMALL_ range:
invalid {xy}axp or par;
         axp[0]= 10, usr[0:1]=(34.3721,0.872801)
  In addition: Warning message:
  CreateAtVector "log"(from axis()): usr[0] = 34.3721 > 0.872801 = usr[1] !


According to Petr Pikal <petr.pikal -at- precheza.cz>, replacing the ylim
argument by ylim = c(30,1.2) helps in the above example; but in my real world
applications, it's actually difficult to find a working value for ylim.

I hope this is useful,

  Christian.

From rkoenker at uiuc.edu  Tue May 24 18:32:00 2005
From: rkoenker at uiuc.edu (roger koenker)
Date: Tue May 24 18:32:57 2005
Subject: [Rd] Non-nested testing and anova.lm()
Message-ID: <760E87C4-BAE8-4611-80F7-75CB0D9ACE9B@uiuc.edu>

I'd like to elicit comments on what I am sure is an ancient topic, but
one for which  I can't seem to google up a satisfactory reference.

I'm curious about the laissez-faire attitude adopted in anova.lm
and friends regarding non-nested hypothesis tests.  I was under
the misapprehension until yesterday that attempts to test
non-nested hypotheses, i.e. compare lm objects with non-nested
design matrices, produced an error.  On the contrary, not even a
warning is generated.  The Ur text on this sort of thing (aka The
White Book)  seems to suggest (p 210) that test statistics  are
computed only when models are nested, but ?anova.lm is quite
clear:

      For all but the first model, the change in degrees of freedom  
and sum
      of squares is also given. (This only make statistical sense if the
      models are nested.)  It is conventional to list the models from
      smallest to largest, but this is up to the user.

My motivation for the question is that I'm considering  reworking the
code for anova.rq in my quantreg package. Currently, I have a rather
half-hearted attempt to check nesting using variable names, and
was considering implementing something more algebraic based
on explicitly looking at subspace inclusions, but now I'm wondering
if R's caveat emptor policy might be a viable alternative.  Any
comments would be welcome.

>>>
>>> url:    www.econ.uiuc.edu/~roger                Roger Koenker
>>> email   rkoenker@uiuc.edu                       Department of   
>>> Economics
>>> vox:    217-333-4558                            University of   
>>> Illinois
>>> fax:    217-244-6678                            Champaign, IL 61820

From thatsanicehatyouhave at mac.com  Wed May 25 02:38:20 2005
From: thatsanicehatyouhave at mac.com (Demitri Muna)
Date: Wed May 25 02:38:33 2005
Subject: [Rd] Using a C++ library to read a binary file
Message-ID: <93DBC212-ABED-42EC-BB80-598D812BF063@mac.com>

Hello,

I am trying to use a C++ library I have to read some data into R.  
I've gone over the "Writing R Extensions" page and some of the  
archives, but am left somewhat confused (and I'm still very new to R!).

What I want to do is fairly simple. Given some parameters, I'd like  
to read a string of numbers from a proprietary binary file into an  
array. I have a C++ library that will read anything I need from this  
file.

What is the best way to do this? Can someone give me any pointers to  
sample code?

One possibility I've considered is writing a small unix command line  
program that, given the parameters, will return the string of  
numbers. Is there a way to "capture" this from R into an array?

Cheers,

Demitri

From ligges at statistik.uni-dortmund.de  Wed May 25 10:16:48 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed May 25 10:15:52 2005
Subject: [Rd] Using a C++ library to read a binary file
In-Reply-To: <93DBC212-ABED-42EC-BB80-598D812BF063@mac.com>
References: <93DBC212-ABED-42EC-BB80-598D812BF063@mac.com>
Message-ID: <42943470.40106@statistik.uni-dortmund.de>

Demitri Muna wrote:

> Hello,
> 
> I am trying to use a C++ library I have to read some data into R.  I've 
> gone over the "Writing R Extensions" page and some of the  archives, but 
> am left somewhat confused (and I'm still very new to R!).
> 
> What I want to do is fairly simple. Given some parameters, I'd like  to 
> read a string of numbers from a proprietary binary file into an  array. 
> I have a C++ library that will read anything I need from this  file.
> 
> What is the best way to do this? Can someone give me any pointers to  
> sample code?

You might be able to write a C wrapper around your C++ code and link 
that into R, so R can get the data directly from a .C() call to your 
wrapper function. See Writing R Extensions for details.


> One possibility I've considered is writing a small unix command line  
> program that, given the parameters, will return the string of  numbers. 
> Is there a way to "capture" this from R into an array?

Yes, this way will also work, please read the R Data Import/Export 
manual and ?connection.

Uwe Ligges



> Cheers,
> 
> Demitri
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ligges at statistik.uni-dortmund.de  Wed May 25 11:08:18 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed May 25 11:07:20 2005
Subject: [Rd] Rout for  library/base/R-ex/Extract.data.frame.R
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A5AB47A1@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB47A1@phost015.EVAFUNDS.intermedia.net>
Message-ID: <42944082.9000804@statistik.uni-dortmund.de>

Vadim Ogranovich wrote:

> Hi,
>  
> I am writing a light-weight data frame class and want to borrow the test
> cases from the standard data frame. I found the test cases in
> library/base/R-ex/Extract.data.frame.R, but surprisingly no
> corresponding .Rout files. In fact there is no *.Rout file in the entire
> tarball. Not that I cann't generate them, but I am just curious why they
> are not there? How does the base package get tested?
>  
> Thanks,
> Vadim
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


The base packages have their test cases in
...R/tests rather than ....R/src/library/packagename

Uwe Ligges

From maechler at stat.math.ethz.ch  Wed May 25 15:21:44 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed May 25 15:22:12 2005
Subject: [Rd] R-exts.texi: nuke-trailing-whitespace has changed name
	(PR#7888)
In-Reply-To: <20050522205649.33BD7A27D@slim.kubism.ku.dk>
References: <20050522205649.33BD7A27D@slim.kubism.ku.dk>
Message-ID: <17044.31720.749175.809068@stat.math.ethz.ch>

Thank you,
Bj?rn-Helge,

>>>>> "Bj?HM" == Bj?rn-Helge Mevik <bhx2@mevik.net>
>>>>>     on Sun, 22 May 2005 22:56:49 +0200 (CEST) writes:

	  ......

    Bj?HM> In Appendix B R coding standards of the Writing R
    Bj?HM> Extensions manual, Emacs/ESS users are encouraged to
    Bj?HM> use

    Bj?HM> ..............

    Bj?HM> However, as of ess-5.2.4 (current is 5.2.8)
    Bj?HM> `nuke-trailing-whitespace' has changed name to
    Bj?HM> `ess-nuke-trailing-whitespace'.

    Bj?HM> In addition: by default, ess-nuke-trailing-whitespace
    Bj?HM> is a no-op (as was nuke-trailing-whitespace).  To
    Bj?HM> `activate' it one must set
    Bj?HM> ess-nuke-trailing-whitespace-p to t or 'ask (default
    Bj?HM> is nil), e.g.  (setq ess-nuke-trailing-whitespace-p t)

Thank you. I've now changed it to

---------------------------------------------

.................
.................

            (add-hook 'local-write-file-hooks
                      (lambda ()
                        (ess-nuke-trailing-whitespace)))))
(setq ess-nuke-trailing-whitespace-p 'ask)
;; or even
;; (setq ess-nuke-trailing-whitespace-p t)

From wheelerb at imsweb.com  Wed May 25 16:15:29 2005
From: wheelerb at imsweb.com (wheelerb@imsweb.com)
Date: Wed May 25 16:15:34 2005
Subject: [Rd] Error with user defined split function in rpart (PR#7895)
Message-ID: <20050525141529.A2A66A20A@slim.kubism.ku.dk>

Full_Name: Bill Wheeler
Version: 2.0.1
OS: Windows 2000
Submission from: (NULL) (67.130.36.229)


The program to reproduce the error is below. I am calling rpart with a
user-defined split function for a binary response variable and one continuous
independent variable. The split function works for some datasets but not
others.
The error is:
Error in "$<-.data.frame"(`*tmp*`, "yval2", value = c(0, 15, 10, 0.6,  : 
        replacement has 5 rows, data has 1


#
# Test out the "user mode" functions, with a binary response
# 

rm(list=ls(all=TRUE))

options(warn = 1);
library(rpart);

set.seed(7);

nobs <- 25;
mydata        <- data.frame(indx=1:nobs);
mydata[, "y"] <- floor(runif(nobs, min=0, max=2));
mydata[, "x"] <- runif(nobs, min=0, max=2);
mydata$indx   <- NULL;

################################################################
# The 'evaluation' function.  Called once per node.
#  Produce a label (1 or more elements long) for labeling each node,
#  and a deviance.  The latter is
#	- of length 1
#       - equal to 0 if the node is "pure" in some sense (unsplittable)
#       - does not need to be a deviance: any measure that gets larger
#            as the node is less acceptable is fine.
#       - the measure underlies cost-complexity pruning, however
temp1 <- function(y, wt, parms) {
 print("***** START: TEMP1 *****");
 
    n <- length(y);

    # Get the number of y's in each category
    sumyEqual0 <- sum(y == 0);
    sumyEqual1 <- sum(y == 1);

    # Get the proportion of 0's and 1's
    p0 <- sumyEqual0/n;
    p1 <- sumyEqual1/n;

    if (p0 >= p1) {
      dev = sumyEqual1;
    } else {
      dev = sumyEqual0;
    }
  
    # Get the vector of labels
    labels <- matrix(nrow=1, ncol=5);

    # labels[1] is the fitted y category
    # labels[2] is sum(y == 0)
    # labels[3] is sum(y == 1)
    # labels[4] is sum(y == 0)/n
    # labels[5] is sum(y == 1)/n

    if (p0 >= p1) {
      labels[1] = 0;
    } else {
      labels[1] = 1;
    }
    labels[2] <- sumyEqual0;
    labels[3] <- sumyEqual1;
    labels[4] <- sumyEqual0/n;
    labels[5] <- sumyEqual1/n;

    ret <- list(label=labels, deviance=dev)
 

    print("***** END: TEMP1 *****");
    ret
    }

# The split function, where most of the work occurs.
#   Called once per split variable per node.
# If continuous=T
#   The actual x variable is ordered
#   y is supplied in the sort order of x, with no missings,
#   return two vectors of length (n-1):
#      goodness = goodness of the split, larger numbers are better.
#                 0 = couldn't find any worthwhile split
#        the ith value of goodness evaluates splitting obs 1:i vs (i+1):n
#      direction= -1 = send "y< cutpoint" to the left side of the tree
#                  1 = send "y< cutpoint" to the right
#         this is not a big deal, but making larger "mean y's" move towards
#         the right of the tree, as we do here, seems to make it easier to
#         read
# If continuos=F, x is a set of integers defining the groups for an
#   unordered predictor.  In this case:
#       direction = a vector of length m= "# groups".  It asserts that the
#           best split can be found by lining the groups up in this order
#           and going from left to right, so that only m-1 splits need to
#           be evaluated rather than 2^(m-1)
#       goodness = m-1 values, as before.
#
# The reason for returning a vector of goodness is that the C routine
#   enforces the "minbucket" constraint. It selects the best return value
#   that is not too close to an edge.
temp2 <- function(y, wt, x, parms, continuous) {
    print("***** START: TEMP2 *****");
 
    n <- length(y)
 
    # For binary y, get P(Y=0)/n and P(Y=1)/n at each split
    temp <- cumsum(y*wt)[-n]
 
    left.wt  <- cumsum(wt)[-n]  
    right.wt <- sum(wt) - left.wt
   
    lp <- temp/left.wt
 
    rsum <- matrix(nrow=1, ncol=n-1, data=0);
    for (i in seq(1, n-1))
    {
      for (j in seq(i+1, n))
      {
        rsum[i] <- rsum[i] + y[j];
      }  
    }

    rp <- rsum/right.wt
 
    lprop <- 1 - lp;
    rprop <- rp;
 
    # Get the direction
    direc <- matrix(nrow=1, ncol=length(lp), data=1);
    for (i in seq(1, length(lp)))
    {
      if (lprop[i] >= rprop[i])
        direc[i] <- -1;
    }
   
    goodness <- (lprop + rprop);
      
    ret <- list(goodness= goodness, direction=direc)
  
    print("***** END: TEMP2 *****");

    ret
    }
	
# The init function:
#   fix up y to deal with offsets
#   return a dummy parms list
#   numresp is the number of values produced by the eval routine's "label"
#   numy is the number of columns for y
#   summary is a function used to print one line in summary.rpart
#   text is a function used to put text on the plot in text.rpart
# In general, this function would also check for bad data, see rpart.poisson
#   for instace.
temp3 <- function(y, offset, parms, wt) {
    print("***** START: TEMP3 *****");
 
    if (!is.null(offset)) y <- y-offset
    ret <- list(y=y, parms=0, numresp=5, numy=1,
	      summary= function(yval, dev, wt, ylevel, digits ) {
		  paste("  mean=", format(signif(yval, digits)),
			", MSE=" , format(signif(dev/wt, digits)),
			sep='')
	     },
    	 text= function(yval, dev, wt, ylevel, digits, n, use.n ) {
	     if(use.n) {paste(formatg(yval,digits),"\nn=", n,sep="")}
             else{paste(formatg(yval,digits))}
           })
    print("***** END: TEMP3 *****");
 
    ret
    }

alist <- list(eval=temp1, split=temp2, init=temp3);

fit1 <- rpart(y ~ ., data=mydata, method=alist, control=list(cp=0));

From maechler at stat.math.ethz.ch  Wed May 25 16:15:12 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed May 25 16:15:37 2005
Subject: [Rd] Rout for  library/base/R-ex/Extract.data.frame.R
In-Reply-To: <42944082.9000804@statistik.uni-dortmund.de>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB47A1@phost015.EVAFUNDS.intermedia.net>
	<42944082.9000804@statistik.uni-dortmund.de>
Message-ID: <17044.34928.147357.758366@stat.math.ethz.ch>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Wed, 25 May 2005 11:08:18 +0200 writes:

    UweL> Vadim Ogranovich wrote:
    >> Hi,
    >> 
    >> I am writing a light-weight data frame class and want to
    >> borrow the test cases from the standard data frame. I
    >> found the test cases in
    >> library/base/R-ex/Extract.data.frame.R, but surprisingly
    >> no corresponding .Rout files. In fact there is no *.Rout
    >> file in the entire tarball. Not that I cann't generate
    >> them, but I am just curious why they are not there? How
    >> does the base package get tested?
    >> 
    >> Thanks, Vadim

    UweL> The base packages have their test cases in ...R/tests
    UweL> rather than ....R/src/library/packagename

yes, and the *examples* from the help pages are just run, and
not compared to prespecified output in *.Rout.save (sic!) files.
In an *installed* (not the source!) version of R or an R package 
you find the R code for all the examples from the help pages
in <pkg>/R-ex/*.R.   
That's the same for all R packages, not just the standard
packages.

Martin Maechler

From pgilbert at bank-banque-canada.ca  Wed May 25 16:44:11 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed May 25 16:46:00 2005
Subject: [Rd] Rout for  library/base/R-ex/Extract.data.frame.R
In-Reply-To: <17044.34928.147357.758366@stat.math.ethz.ch>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB47A1@phost015.EVAFUNDS.intermedia.net>	<42944082.9000804@statistik.uni-dortmund.de>
	<17044.34928.147357.758366@stat.math.ethz.ch>
Message-ID: <42948F3B.9090106@bank-banque-canada.ca>

Martin Maechler wrote:

>>>>>>"UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>>    on Wed, 25 May 2005 11:08:18 +0200 writes:
> 
> 
>     UweL> Vadim Ogranovich wrote:
>     >> Hi,
>     >> 
>     >> I am writing a light-weight data frame class and want to
>     >> borrow the test cases from the standard data frame. I
>     >> found the test cases in
>     >> library/base/R-ex/Extract.data.frame.R, but surprisingly
>     >> no corresponding .Rout files. In fact there is no *.Rout
>     >> file in the entire tarball. Not that I cann't generate
>     >> them, but I am just curious why they are not there? How
>     >> does the base package get tested?
>     >> 
>     >> Thanks, Vadim
> 
>     UweL> The base packages have their test cases in ...R/tests
>     UweL> rather than ....R/src/library/packagename
> 
> yes, and the *examples* from the help pages are just run, and
> not compared to prespecified output in *.Rout.save (sic!) files.
> In an *installed* (not the source!) version of R or an R package 
> you find the R code for all the examples from the help pages
> in <pkg>/R-ex/*.R.   
> That's the same for all R packages, not just the standard
> packages.

Vadim

I'll expand a bit on Martin's comment. It is hard to test the output of 
all examples because some examples use random numbers, and for others 
the precision may vary a bit on different platforms. I typically add 
important examples to the tests directory, set the random number 
generation, and compare results within tolerances that work on different 
platforms.

Paul Gilbert
> 
> Martin Maechler
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From hb at maths.lth.se  Tue May 24 22:18:25 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Wed May 25 20:04:59 2005
Subject: [Rd] Request: scan() argument 'allowEscapes' in read.table() too,
	please.
Message-ID: <42938C11.5040806@maths.lth.se>

I would like to suggest adding argument 'allowEscapes' to 
read.table(..., allowEscapes=TRUE) and pass it to its three calls to 
scan(..., allowEscapes=allowEscapes).

Rd (from ?scan):
\item{allowEscapes}{logical. Should C-style escapes such as '\n' be 
processed (the default) or read verbatim?   Note that if not within 
quotes these could be interpreted as a delimiter (but not as a comment 
character).}

Currently, it is not possible to use read.table() to read tab-delimited 
files with elements containing the string "\t" (not a TAB), i.e. the two 
characters "\" and "t". Example:

<file>
A	B
1	a\tb
2	c\td
</file>

<readable>
A<tab>B
1<tab>a\tb
2<tab>c\td
</readable>

Try to read the above with

scan(stdin(), what=character(0), sep="\t", allowEscapes=FALSE)

and this

scan(stdin(), what=character(0), sep="\t", allowEscapes=TRUE)

Cheers

Henrik Bengtsson

From tplate at blackmesacapital.com  Wed May 25 22:37:12 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Wed May 25 22:37:17 2005
Subject: [Rd] seek(con, 0, "end",
	rw="r") does not always work correctly (PR#7896)
Message-ID: <20050525203712.36C2685B0@slim.kubism.ku.dk>

I've noticed that seek(con, 0, "end", rw="r") on a file connection does 
not always work correctly after a write (R 2.1.0 on Windows).

[Is a call to fflush() needed inside file_seek() in main/connections.c?]

Example (see the lines with the "***WRONG***" comment)

 > # seek(, rw="r") on a file does not always work correctly after a write
 > f <- file("tmp3.txt", "w+b")
 > # Write something earlier in the file
 > seek(f, 10, rw="w")
[1] 0
 > writeLines(c("ghi", "jkl"), f)
 > seek(f, 20, rw="w")
[1] 18
 > writeLines(c("abc"), f)
 > seek(f, 0, "end", rw="w")
[1] 24
 > # Try to read at the end of the file
 > seek(f, 0, "end", rw="r")
[1] 0
 > readLines(f, -1)
character(0)
 > seek(f, 0, "end", rw="w")
[1] 18
 > # write something at the end of the file
 > writeLines(c("def"), f)
 > # Try to read at the end of the file
 > # flush(f) # flushing here makes the seek work correctly
 > seek(f, 0, "end", rw="r")
[1] 24
 > seek(f, NA, rw="r") # ***WRONG*** (should return 28)
[1] 24
 > readLines(f, -1) # ***WRONG*** (should return character(0))
[1] "def"
 > seek(f, 20, rw="r")
[1] 28
 > readLines(f, -1)
[1] "abc" "def"
 > seek(f, 0, "end", rw="r") # now it works correctly
[1] 28
 > seek(f, NA, rw="r")
[1] 28
 > readLines(f, -1)
character(0)
 > close(f)
 >
 > version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    1.0
year     2005
month    04
day      18
language R
 >

-- Tony Plate

From simon.urbanek at r-project.org  Thu May 26 01:42:39 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu May 26 01:42:52 2005
Subject: [Rd] R OS X
In-Reply-To: <AC363775-D167-4BB8-9905-DB4A09FCAE8F@biologie.uni-erlangen.de>
References: <AC363775-D167-4BB8-9905-DB4A09FCAE8F@biologie.uni-erlangen.de>
Message-ID: <A7B3047C-2922-4316-A187-224BBCFBAE26@r-project.org>

On May 24, 2005, at 9:11 AM, Volker Runkel wrote:

> with newest R.app (1.11) / R2.1.0a
>
> if a package is installed for the current user, it is not installed  
> properly (does not get an installed version entry and is not  
> loadable). If installed system wide it works.

As Rob mentioned, you likely didn't select "Add $RHOME/R/Library" in  
Startup preferences of R.app.
I just want to add for the record that R versions before 2.1.0a  
(including 2.1.0 release in particular) featured a bug that caused ~/ 
R/library to be always in .libPaths even if R.app or the user  
disabled it (in --gui=AQUA mode).

Cheers,
Simon

From Bader at lrz.de  Thu May 26 02:43:29 2005
From: Bader at lrz.de (Bader@lrz.de)
Date: Thu May 26 02:43:34 2005
Subject: [Rd] Buidling R on Linux (Itanium) fails (PR#7897)
Message-ID: <20050526004329.2A58BA20A@slim.kubism.ku.dk>

Full_Name: Reinhold Bader
Version: 2.1.0
OS: SLES 9
Submission from: (NULL) (129.187.48.1)


I tried to build R using the Intel compilers (icc, ifort) and the Math Kernel
Libraries
for BLAS/LAPACK

Optimizations used were -O3, and the 
FPICFLAGS="-fpic"
was exported.

The build failed with the following error message:
...
dumping R code in package 'methods'
Saving namespace image ...
initializing class and method definitions now ...Error in
makePrototypeFromClassDef(properties, ClassDef, immediate, where) :
        in making the prototype for class "SClassExtension" elements of the
prototype failed to match the corresponding slot class: coerce (class
?character? ), test (class ?character? ), replace (class ?character? ), simple
(class ?character? ), dataPart (class ?character? )
Error: .onLoad failed in 'loadNamespace' for 'methods'
Execution halted

I am not a R specialist; how do I continue from here?
make[4]: *** [../..

From christophe.pouzat at univ-paris5.fr  Thu May 26 12:09:23 2005
From: christophe.pouzat at univ-paris5.fr (Christophe Pouzat)
Date: Thu May 26 12:06:03 2005
Subject: [Rd] Buidling R on Linux (Itanium) fails (PR#7897)
In-Reply-To: <20050526004329.2A58BA20A@slim.kubism.ku.dk>
References: <20050526004329.2A58BA20A@slim.kubism.ku.dk>
Message-ID: <4295A053.50601@univ-paris5.fr>

Hi,

here is the "configure" command line I used for an Intel PIV processor 
with icc, ifort and the intel mkl:

./configure CC=icc CFLAGS="-O2 -mp -prec_div" F77=ifort CXX=icc 
CXXFLAGS="-O2 -mp -prec_div" FFLAGS="-C90 -w90 -w95 -mp -prec_div" 
CPICFLAGS=-shared CXXPICFLAGS=-shared FPICFLAGS=-shared 
SHLIB_LDFLAGS=-shared SHLIB_CXXLDFLAGS=-shared --with-blas="-lmkl_lapack 
-lmkl -lguide -lpthread"

In my experience using "FPICFLAGS=-shared" is mendatory to get the 
compilation working. The other options are mainly there to pass almost 
all the tests (except one) of "make check".

Xtof.

Bader@lrz.de wrote:

>Full_Name: Reinhold Bader
>Version: 2.1.0
>OS: SLES 9
>Submission from: (NULL) (129.187.48.1)
>
>
>I tried to build R using the Intel compilers (icc, ifort) and the Math Kernel
>Libraries
>for BLAS/LAPACK
>
>Optimizations used were -O3, and the 
>FPICFLAGS="-fpic"
>was exported.
>
>The build failed with the following error message:
>...
>dumping R code in package 'methods'
>Saving namespace image ...
>initializing class and method definitions now ...Error in
>makePrototypeFromClassDef(properties, ClassDef, immediate, where) :
>        in making the prototype for class "SClassExtension" elements of the
>prototype failed to match the corresponding slot class: coerce (class
>?character? ), test (class ?character? ), replace (class ?character? ), simple
>(class ?character? ), dataPart (class ?character? )
>Error: .onLoad failed in 'loadNamespace' for 'methods'
>Execution halted
>
>I am not a R specialist; how do I continue from here?
>make[4]: *** [../..
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel
>
>  
>


-- 
A Master Carpenter has many tools and is expert with most of them.If you
only know how to use a hammer, every problem starts to look like a nail.
Stay away from that trap.
Richard B Johnson.
--

Christophe Pouzat
Laboratoire de Physiologie Cerebrale
CNRS UMR 8118
UFR biomedicale de l'Universite Paris V
45, rue des Saints Peres
75006 PARIS
France

tel: +33 (0)1 42 86 38 28
fax: +33 (0)1 42 86 38 30
web: www.biomedicale.univ-paris5.fr/physcerv/C_Pouzat.html

From nakama at ki.rim.or.jp  Thu May 26 15:16:29 2005
From: nakama at ki.rim.or.jp (Ei-ji Nakama)
Date: Thu May 26 15:16:53 2005
Subject: [Rd] Buidling R on Linux (Itanium) fails (PR#7897)
In-Reply-To: <20050526004329.2A58BA20A@slim.kubism.ku.dk>
References: <20050526004329.2A58BA20A@slim.kubism.ku.dk>
Message-ID: <20050526.221629.846958933.nakama@ki.rim.or.jp>

> I tried to build R using the Intel compilers (icc, ifort) and the Math Kernel
> Libraries
> for BLAS/LAPACK
> 
> Optimizations used were -O3, and the 
> FPICFLAGS="-fpic"
> was exported.
> 
> The build failed with the following error message:

I did not use MKL, but there was a problem to Intel compiler. 
An as follows memo at that time. 
Because there is not yet an option restraining an exception in C++ of
IA64, icpc is not usable.

http://www.nakama.ne.jp/memo/ia64_linux/

--
e-mail : EIJI Nakama <nakama@ki.rim.or.jp>

From ligges at statistik.uni-dortmund.de  Thu May 26 17:31:02 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Thu May 26 17:31:07 2005
Subject: [Rd] seek(con, 0, "end",
	rw="r") does not always work correctly (PR#7899)
Message-ID: <20050526153102.8B6C69F68@slim.kubism.ku.dk>

tplate@blackmesacapital.com wrote:

> I've noticed that seek(con, 0, "end", rw="r") on a file connection does 
> not always work correctly after a write (R 2.1.0 on Windows).
> 
> [Is a call to fflush() needed inside file_seek() in main/connections.c?]


If you have an idea where to fflush() precisely and your patch works, 
please tell it! I'll happily run some test cases where seeking matters.

Note that ?seek currently tells us "The value returned by seek(where=NA) 
appears to be unreliable on Windows systems, at least for text files."
It would be nice if this comment could be removed, of course ....

Uwe Ligges



> Example (see the lines with the "***WRONG***" comment)
> 
>  > # seek(, rw="r") on a file does not always work correctly after a write
>  > f <- file("tmp3.txt", "w+b")
>  > # Write something earlier in the file
>  > seek(f, 10, rw="w")
> [1] 0
>  > writeLines(c("ghi", "jkl"), f)
>  > seek(f, 20, rw="w")
> [1] 18
>  > writeLines(c("abc"), f)
>  > seek(f, 0, "end", rw="w")
> [1] 24
>  > # Try to read at the end of the file
>  > seek(f, 0, "end", rw="r")
> [1] 0
>  > readLines(f, -1)
> character(0)
>  > seek(f, 0, "end", rw="w")
> [1] 18
>  > # write something at the end of the file
>  > writeLines(c("def"), f)
>  > # Try to read at the end of the file
>  > # flush(f) # flushing here makes the seek work correctly
>  > seek(f, 0, "end", rw="r")
> [1] 24
>  > seek(f, NA, rw="r") # ***WRONG*** (should return 28)
> [1] 24
>  > readLines(f, -1) # ***WRONG*** (should return character(0))
> [1] "def"
>  > seek(f, 20, rw="r")
> [1] 28
>  > readLines(f, -1)
> [1] "abc" "def"
>  > seek(f, 0, "end", rw="r") # now it works correctly
> [1] 28
>  > seek(f, NA, rw="r")
> [1] 28
>  > readLines(f, -1)
> character(0)
>  > close(f)
>  >
>  > version
>           _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.0
> year     2005
> month    04
> day      18
> language R
>  >
> 
> -- Tony Plate
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From mwelinder at gmail.com  Thu May 26 22:55:28 2005
From: mwelinder at gmail.com (mwelinder@gmail.com)
Date: Thu May 26 22:55:36 2005
Subject: [Rd] qpois accuracy, efficiency, termination (PR#7900)
Message-ID: <20050526205528.058BB85B0@slim.kubism.ku.dk>

Full_Name: Morten Welinder
Version: 2.1.0
OS: src only
Submission from: (NULL) (216.223.241.226)


The qpois code has several problems in 2.1.0:

1. The code essentially does...

      z = qnorm(R_DT_qIv(porig), 0., 1., /*lower_tail*/TRUE, /*log_p*/FALSE);

   ...when it could just as well do...

      z = qnorm(porig, 0., 1., lower_tail, log_p);

   That would eliminate a lot of underflows.

2. A third party tells me that you want "gamma = 1 / sigma", not "gamma =
sigma".
   That should speed things up a lot.

3. If y>1/DBL_EPSILON (or a bit larger if intermediate results have better
   accuracy than double) then the loops will not terminate.  And, yes, the
   "fixme" is right that stepping is a bit too primitive.

From ligges at statistik.uni-dortmund.de  Fri May 27 10:32:08 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri May 27 10:32:16 2005
Subject: [Rd] Reversing axis in a log plot (PR#7894)
Message-ID: <20050527083208.921AD8523@slim.kubism.ku.dk>

Yes, this one is a bug in CreateAtVector, plot.c.
It already has the lines:


     /* Debugging: When does the following happen... ? */
     if (umin > umax)
         warning("CreateAtVector \"log\"(from axis()): "
             "usr[0] = %g > %g = usr[1] !", umin, umax);


And now we know that it happens if (and only if?????) the logarithmic 
scale is not very small (i.e. axp[2] > 0, this is equal to R's 
par("yaxp")[3] in your example) and the axis are reversed (umin > umax).

I'll try to provide a fix which should be possible by reversing 
arguments axp and usr in this case and returning a reversed at ...

Uwe Ligges




marquardt.christian@gmail.com wrote:

> Full_Name: Christian Marquardt
> Version: 2.1.0
> OS: Linux (Redhat 9)
> Submission from: (NULL) (151.170.240.10)
> 
> Following the advice of a reader of R-help, I would now like to submit this as a
> bug report:
> 
> Say we have
> 
>   x = seq(1,3, by = 0.01)
>   y = exp(x)
> 
> Plotting and reversing linear axis is fine
> 
>    plot(x,y)
>    plot(x,y, ylim = c(30,1))
> 
> as is a usual log-plot:
> 
>   plot(x,y, log = "y", ylim = c(1,30))
> 
> However,
> 
>   plot(x,y, log = "y", ylim = c(30,1))
> 
> fails with
> 
>   Error in axis(2, ...) : log - axis(), 'at' creation, _SMALL_ range:
> invalid {xy}axp or par;
>          axp[0]= 10, usr[0:1]=(34.3721,0.872801)
>   In addition: Warning message:
>   CreateAtVector "log"(from axis()): usr[0] = 34.3721 > 0.872801 = usr[1] !
> 
> 
> According to Petr Pikal <petr.pikal -at- precheza.cz>, replacing the ylim
> argument by ylim = c(30,1.2) helps in the above example; but in my real world
> applications, it's actually difficult to find a working value for ylim.
> 
> I hope this is useful,
> 
>   Christian.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ligges at statistik.uni-dortmund.de  Fri May 27 11:42:54 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Fri May 27 11:43:01 2005
Subject: [Rd] Reversing axis in a log plot (PR#7894)
Message-ID: <20050527094254.7EACF8601@slim.kubism.ku.dk>

This is a multi-part message in MIME format.
--MIMEStream=_0+99651_873538045512443_0843898189
Content-Type: text/plain; charset="us-ascii"; format=flowed
Content-Transfer-Encoding: 7bit

Please find attached my proposal for a bugfix. The experts might to 
better, though.

Uwe Ligges



ligges@statistik.uni-dortmund.de wrote:

> Yes, this one is a bug in CreateAtVector, plot.c.
> It already has the lines:
> 
> 
>      /* Debugging: When does the following happen... ? */
>      if (umin > umax)
>          warning("CreateAtVector \"log\"(from axis()): "
>              "usr[0] = %g > %g = usr[1] !", umin, umax);
> 
> 
> And now we know that it happens if (and only if?????) the logarithmic 
> scale is not very small (i.e. axp[2] > 0, this is equal to R's 
> par("yaxp")[3] in your example) and the axis are reversed (umin > umax).
> 
> I'll try to provide a fix which should be possible by reversing 
> arguments axp and usr in this case and returning a reversed at ...
> 
> Uwe Ligges
> 
> 
> 
> 
> marquardt.christian@gmail.com wrote:
> 
> 
>>Full_Name: Christian Marquardt
>>Version: 2.1.0
>>OS: Linux (Redhat 9)
>>Submission from: (NULL) (151.170.240.10)
>>
>>Following the advice of a reader of R-help, I would now like to submit this as a
>>bug report:
>>
>>Say we have
>>
>>  x = seq(1,3, by = 0.01)
>>  y = exp(x)
>>
>>Plotting and reversing linear axis is fine
>>
>>   plot(x,y)
>>   plot(x,y, ylim = c(30,1))
>>
>>as is a usual log-plot:
>>
>>  plot(x,y, log = "y", ylim = c(1,30))
>>
>>However,
>>
>>  plot(x,y, log = "y", ylim = c(30,1))
>>
>>fails with
>>
>>  Error in axis(2, ...) : log - axis(), 'at' creation, _SMALL_ range:
>>invalid {xy}axp or par;
>>         axp[0]= 10, usr[0:1]=(34.3721,0.872801)
>>  In addition: Warning message:
>>  CreateAtVector "log"(from axis()): usr[0] = 34.3721 > 0.872801 = usr[1] !
>>
>>
>>According to Petr Pikal <petr.pikal -at- precheza.cz>, replacing the ylim
>>argument by ylim = c(30,1.2) helps in the above example; but in my real world
>>applications, it's actually difficult to find a working value for ylim.
>>
>>I hope this is useful,
>>
>>  Christian.
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


--MIMEStream=_0+99651_873538045512443_0843898189
Content-Type: text/plain; name="plot.c.diff"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline; filename="plot.c.diff"

--- plot.c-orig	2005-05-27 10:38:39.851718400 +0200
+++ plot.c	2005-05-27 11:40:10.118060800 +0200
@@ -778,8 +778,10 @@
  *  The resulting REAL vector must have length >= 1, ideally >= 2
  */
     SEXP at = R_NilValue;/* -Wall*/
-    double umin, umax, dn, rng, small;
+    SEXP atr = R_NilValue;/* for reversed log axis with axp[2]>0 */
+    double umin, umax, dn, rng, small, reversed;
     int i, n, ne;
+    reversed = 0.; /* for reversed log axis with axp[2]>0 */
     if (!logflag || axp[2] < 0) { /* --- linear axis --- Only use axp[] arg. */
     n = fabs(axp[2]) + 0.25;/* >= 0 */
     dn = imax2(1, n);
@@ -799,6 +801,19 @@
        n = 1,2,3.  see switch() below */
     umin = usr[0];
     umax = usr[1];
+
+    if (umin > umax && axp[0] > axp[1]){
+        /* if we have log axis, axp[2]>0 and reversed axis, many following calculations will fail 
+           (assuming umin < umax etc.), hence simply reverse usr and axp at first.
+           At the end reverse output of atr(eversed) back again. */
+        umin = usr[1];
+        umax = usr[0];
+        reversed = axp[0];
+        axp[0] = axp[1];
+        axp[1] = reversed;
+        reversed = 1.;
+    }
+    
     /* Debugging: When does the following happen... ? */
     if (umin > umax)
         warning("CreateAtVector \"log\"(from axis()): "
@@ -899,7 +914,15 @@
           axp[2]);
     }
     }
-    return at;
+    if(reversed == 1.){
+        /* we have to reverse the output back again (reversed log axis with axp[2]>0) */
+        atr = allocVector(REALSXP, n);
+        for (i = 0; i < n; i++)
+            REAL(atr)[i] = REAL(at)[n-i-1];
+        return atr;
+    }
+    else 
+        return at;
 }
 
 static double ComputePAdjValue(double padj, int side, int las)

--MIMEStream=_0+99651_873538045512443_0843898189--

From tplate at blackmesacapital.com  Fri May 27 18:13:11 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Fri May 27 18:13:18 2005
Subject: [Rd] seek(con, 0, "end",
	rw="r") does not always work correctly (PR#7901)
Message-ID: <20050527161311.9F2498601@slim.kubism.ku.dk>

ligges@statistik.uni-dortmund.de wrote:
> tplate@blackmesacapital.com wrote:
> 
> 
>>I've noticed that seek(con, 0, "end", rw="r") on a file connection does 
>>not always work correctly after a write (R 2.1.0 on Windows).
>>
>>[Is a call to fflush() needed inside file_seek() in main/connections.c?]
> 
> 
> 
> If you have an idea where to fflush() precisely and your patch works, 
> please tell it! I'll happily run some test cases where seeking matters.
> 

I couldn't see why the current code was returning a bad value under some 
conditions.  (That's why didn't offer anything more than a suggestion). 
  My suggestion to use an fflush() was a guess (hence the question mark, 
but evidence for the guess being correct was that doing a flush at the R 
command line made the whole thing work correctly.)  To be safe, I would 
try to put a flush() right at the beginning of file_seek(), before the 
call to f_tell().  I tried this, and with the modification the test case 
I gave produced correct output.  Here's how the beginning of my modified 
file_seek() function (in main/connections.c) looks:

static double file_seek(Rconnection con, double where, int origin, int rw)
{
     Rfileconn this = con->private;
     FILE *fp = this->fp;
#if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
     off_t pos;
#else
#ifdef Win32
     off64_t pos;
#else
     long pos;
#endif
#endif
     int whence = SEEK_SET;
     fflush(fp);
     pos = f_tell(fp);

     /* make sure both positions are set */


> Note that ?seek currently tells us "The value returned by seek(where=NA) 
> appears to be unreliable on Windows systems, at least for text files."
> It would be nice if this comment could be removed, of course ....

May the explanation could be given that this happens with text files 
because Windows inserts extra characters at end-of-lines when reading 
"text" mode files (but with binary files, things should be fine.)  This 
particular issue is documented in Microsoft Windows documentation (e.g., 
at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found 
by searching on Google using the terms "fseek windows documentation"). 
Are there any known issues using seek with binary files under Windows? 
If there are not, then the caveat could be made specific to text files 
and all vagueness removed.

-- Tony Plate

> 
> Uwe Ligges
> 
> 
> 
> 
>>Example (see the lines with the "***WRONG***" comment)
>>
>> > # seek(, rw="r") on a file does not always work correctly after a write
>> > f <- file("tmp3.txt", "w+b")
>> > # Write something earlier in the file
>> > seek(f, 10, rw="w")
>>[1] 0
>> > writeLines(c("ghi", "jkl"), f)
>> > seek(f, 20, rw="w")
>>[1] 18
>> > writeLines(c("abc"), f)
>> > seek(f, 0, "end", rw="w")
>>[1] 24
>> > # Try to read at the end of the file
>> > seek(f, 0, "end", rw="r")
>>[1] 0
>> > readLines(f, -1)
>>character(0)
>> > seek(f, 0, "end", rw="w")
>>[1] 18
>> > # write something at the end of the file
>> > writeLines(c("def"), f)
>> > # Try to read at the end of the file
>> > # flush(f) # flushing here makes the seek work correctly
>> > seek(f, 0, "end", rw="r")
>>[1] 24
>> > seek(f, NA, rw="r") # ***WRONG*** (should return 28)
>>[1] 24
>> > readLines(f, -1) # ***WRONG*** (should return character(0))
>>[1] "def"
>> > seek(f, 20, rw="r")
>>[1] 28
>> > readLines(f, -1)
>>[1] "abc" "def"
>> > seek(f, 0, "end", rw="r") # now it works correctly
>>[1] 28
>> > seek(f, NA, rw="r")
>>[1] 28
>> > readLines(f, -1)
>>character(0)
>> > close(f)
>> >
>> > version
>>          _
>>platform i386-pc-mingw32
>>arch     i386
>>os       mingw32
>>system   i386, mingw32
>>status
>>major    2
>>minor    1.0
>>year     2005
>>month    04
>>day      18
>>language R
>> >
>>
>>-- Tony Plate
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From mwelinder at gmail.com  Fri May 27 20:24:36 2005
From: mwelinder at gmail.com (mwelinder@gmail.com)
Date: Fri May 27 20:24:46 2005
Subject: [Rd] qcauchy accuracy (PR#7902)
Message-ID: <20050527182436.07CE88601@slim.kubism.ku.dk>

Full_Name: Morten Welinder
Version: 2.1.0
OS: src only
Submission from: (NULL) (216.223.241.212)


Now that pcauchy has been fixed, it is becoming clear that qcauchy suffers from
the same problems.

    qcauchy(pcauchy(1e100,0,1,FALSE,TRUE),0,1,FALSE,TRUE)

should yield 1e100 back, but I get 1.633178e+16.  The code below does much
better.  Notes:

1. p need not be finite.  -Inf is ok in the log_p case and R_Q_P01_check
   already checks things.

2. No need to disallow scale=0 and infinite location.

3. The code below uses isnan and finite directly.  It needs to be adapted to
the
   R way of doing that.


double
qcauchy (double p, double location, double scale, int lower_tail, int log_p)
{
	if (isnan(p) || isnan(location) || isnan(scale))
		return p + location + scale;

	R_Q_P01_check(p);
	if (scale < 0 || !finite(scale)) ML_ERR_return_NAN;

	if (log_p) {
		if (p > -1)
			lower_tail = !lower_tail, p = -expm1 (p);
		else
			p = exp (p);
	}
	if (lower_tail) scale = -scale;
	return location + scale / tan(M_PI * p);
}

From pdbailey at uchicago.edu  Fri May 27 21:25:50 2005
From: pdbailey at uchicago.edu (pdbailey@uchicago.edu)
Date: Fri May 27 21:25:57 2005
Subject: [Rd] crash in R OS X GUI (PR#7903)
Message-ID: <20050527192550.A4D728601@slim.kubism.ku.dk>

When I type an open paren the (otherwise absolutely wonderful)
help dialog at the bottom crashes R.

For example
> polygon(c(
[all is well
> polygon(c((
2005-05-27 14:13:14.843 R[478] *** -[NSCFDate
characterAtIndex:]: selector not recognized
2005-05-27 14:13:14.881 R[478] *** NSTimer discarding
exception 'NSInvalidArgumentException' (reason '*** -[NSCFDate
characterAtIndex:]: selector not recognized') that raised
during firing of timer with target 3c8350 and selector
'kickstart:'
------------

But I can't now reproduce it. Do you know about this bug? R is
a wonderful program and this experience has tought me just how
reliable I'm used to it being! Thanks a lot.

Paul

From simon.urbanek at r-project.org  Fri May 27 23:37:39 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri May 27 23:37:51 2005
Subject: [Rd] crash in R OS X GUI (PR#7903)
In-Reply-To: <20050527192550.A4D728601@slim.kubism.ku.dk>
References: <20050527192550.A4D728601@slim.kubism.ku.dk>
Message-ID: <0F6070B6-677C-4876-8809-90348A4AAE4D@r-project.org>

On May 27, 2005, at 3:25 PM, pdbailey@uchicago.edu wrote:

> When I type an open paren the (otherwise absolutely wonderful) help  
> dialog at the bottom crashes R.

Are you talking about the console or the editor?

> For example
>
>> polygon(c(
>>
> [all is well
>
>> polygon(c((
>>
> 2005-05-27 14:13:14.843 R[478] *** -[NSCFDate characterAtIndex:]:  
> selector not recognized
> 2005-05-27 14:13:14.881 R[478] *** NSTimer discarding exception  
> 'NSInvalidArgumentException' (reason '*** -[NSCFDate  
> characterAtIndex:]: selector not recognized') that raised during  
> firing of timer with target 3c8350 and selector 'kickstart:'

This is a very strange error and it's just a soft exception so it  
should cause no crash - hitting <Esc> should get you back on track.  
But if it was a crash (with the famous "app unexpectedly quit"  
message), then there should be a  proper crash report - that would be  
more helpful in that case. Can you, please, run the debug version  
(from http://www.rosuda.org/R/nightly ) and send me the full report  
if this occurs again?

> But I can't now reproduce it. Do you know about this bug?

Not directly - it's hard to tell whether this is a bug if it's not  
reproducible ;). Did you run any computation in R while typing this?  
Was a Quartz window busy plotting something at that point?

Thanks,
Simon

From ligges at statistik.uni-dortmund.de  Sat May 28 18:11:31 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Sat May 28 18:11:40 2005
Subject: [Rd] (PR#7899) seek(con, 0, "end", rw="r") does not always work
Message-ID: <20050528161131.0628D8523@slim.kubism.ku.dk>

Tony Plate wrote:
> ligges@statistik.uni-dortmund.de wrote:
> 
>> tplate@blackmesacapital.com wrote:
>>
>>
>>> I've noticed that seek(con, 0, "end", rw="r") on a file connection 
>>> does not always work correctly after a write (R 2.1.0 on Windows).
>>>
>>> [Is a call to fflush() needed inside file_seek() in main/connections.c?]
>>
>>
>>
>>
>> If you have an idea where to fflush() precisely and your patch works, 
>> please tell it! I'll happily run some test cases where seeking matters.
>>
> 
> I couldn't see why the current code was returning a bad value under some 
> conditions.  (That's why didn't offer anything more than a suggestion). 
>  My suggestion to use an fflush() was a guess (hence the question mark, 
> but evidence for the guess being correct was that doing a flush at the R 
> command line made the whole thing work correctly.)  To be safe, I would 
> try to put a flush() right at the beginning of file_seek(), before the 
> call to f_tell().  I tried this, and with the modification the test case 
> I gave produced correct output.  Here's how the beginning of my modified 
> file_seek() function (in main/connections.c) looks:
 >
> static double file_seek(Rconnection con, double where, int origin, int rw)
> {
>     Rfileconn this = con->private;
>     FILE *fp = this->fp;
> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>     off_t pos;
> #else
> #ifdef Win32
>     off64_t pos;
> #else
>     long pos;
> #endif
> #endif
>     int whence = SEEK_SET;
>     fflush(fp);
>     pos = f_tell(fp);
> 
>     /* make sure both positions are set */
> 


Works for your example, but I found another one where it introduces a 
worse bug when using origin="current". Hence it's not that easy.

After reviewing this issue more closely, I think writeLines() into a 
binary connection might be the real problem and a misuse in this case. 
See the last paragrpah in the Details Section of ?writeLines. Hence, 
this might also be an issue related to the text mode connection problem 
on Windows.

Using simple writeChar and readChar statements works as expected for me 
(at least, I was not able to produce anything unexpected). I'm no longer 
convinced that this is a bug in R.




>> Note that ?seek currently tells us "The value returned by 
>> seek(where=NA) appears to be unreliable on Windows systems, at least 
>> for text files."
>> It would be nice if this comment could be removed, of course ....
> 
> 
> May the explanation could be given that this happens with text files 
> because Windows inserts extra characters at end-of-lines when reading 
> "text" mode files (but with binary files, things should be fine.)  This 
> particular issue is documented in Microsoft Windows documentation (e.g., 
> at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found 
> by searching on Google using the terms "fseek windows documentation"). 
> Are there any known issues using seek with binary files under Windows? 
> If there are not, then the caveat could be made specific to text files 
> and all vagueness removed.

Hmm, all I find (including your link) is Windows CE related ...

Uwe Ligges



> 
> -- Tony Plate
> 
>>
>> Uwe Ligges
>>
>>
>>
>>
>>> Example (see the lines with the "***WRONG***" comment)
>>>
>>> > # seek(, rw="r") on a file does not always work correctly after a 
>>> write
>>> > f <- file("tmp3.txt", "w+b")
>>> > # Write something earlier in the file
>>> > seek(f, 10, rw="w")
>>> [1] 0
>>> > writeLines(c("ghi", "jkl"), f)
>>> > seek(f, 20, rw="w")
>>> [1] 18
>>> > writeLines(c("abc"), f)
>>> > seek(f, 0, "end", rw="w")
>>> [1] 24
>>> > # Try to read at the end of the file
>>> > seek(f, 0, "end", rw="r")
>>> [1] 0
>>> > readLines(f, -1)
>>> character(0)
>>> > seek(f, 0, "end", rw="w")
>>> [1] 18
>>> > # write something at the end of the file
>>> > writeLines(c("def"), f)
>>> > # Try to read at the end of the file
>>> > # flush(f) # flushing here makes the seek work correctly
>>> > seek(f, 0, "end", rw="r")
>>> [1] 24
>>> > seek(f, NA, rw="r") # ***WRONG*** (should return 28)
>>> [1] 24
>>> > readLines(f, -1) # ***WRONG*** (should return character(0))
>>> [1] "def"
>>> > seek(f, 20, rw="r")
>>> [1] 28
>>> > readLines(f, -1)
>>> [1] "abc" "def"
>>> > seek(f, 0, "end", rw="r") # now it works correctly
>>> [1] 28
>>> > seek(f, NA, rw="r")
>>> [1] 28
>>> > readLines(f, -1)
>>> character(0)
>>> > close(f)
>>> >
>>> > version
>>>          _
>>> platform i386-pc-mingw32
>>> arch     i386
>>> os       mingw32
>>> system   i386, mingw32
>>> status
>>> major    2
>>> minor    1.0
>>> year     2005
>>> month    04
>>> day      18
>>> language R
>>> >
>>>
>>> -- Tony Plate
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>

From Awy.art at gmx.net  Sun May 29 14:38:31 2005
From: Awy.art at gmx.net (Annika Wetzko)
Date: Sun May 29 14:38:43 2005
Subject: [Rd] (no subject)
Message-ID: <1149.1117370311@www76.gmx.net>

Hi all,

I have a problem installing RMySQL under WinXP.
I can not find the ZIP-file or what have I to do? It&#180;s really busy
bacause I am a student and have to make DBConnection soon...at this
weekend!

Please answer as quick as possible!

Thanks for help
Annika

-- 
Weitersagen: GMX DSL-Flatrates mit Tempo-Garantie!
Ab 4,99 Euro/Monat: http://www.gmx.net/de/go/dsl

From ligges at statistik.uni-dortmund.de  Sun May 29 15:13:11 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun May 29 15:12:10 2005
Subject: looking for RMySQL Windows binary; was: [Rd] (no subject)
In-Reply-To: <1149.1117370311@www76.gmx.net>
References: <1149.1117370311@www76.gmx.net>
Message-ID: <4299BFE7.7080603@statistik.uni-dortmund.de>

Annika Wetzko wrote:
> Hi all,
> 
> I have a problem installing RMySQL under WinXP.
> I can not find the ZIP-file or what have I to do? It&#180;s really busy
> bacause I am a student and have to make DBConnection soon...at this
> weekend!
> 
> Please answer as quick as possible!


... so I am answering as quick as possible.

You know, all those other students, faculty members, business people, 
and professors reading your mail do feel completely boring and are just 
waiting to answer questions of a student who is busy and requesting 
quick answers ... or in other words, people already do answer as quick 
as possible, even if you do not arrogate...

Your message is not appropriate for R-devel. It is not even appropriate 
for R-help, for which you should really read the posting guide.
http://www.R-project.org/posting-guide.html

Please use a sensible subject line.
Please do not put people under pressure to answer your question.
Please tell us the version of R you are using.


Now, answering your question, please read the ReadMe at 
CRAN/bin/windows/contrib/2.1/ReadMe
(assuming you are using the most recent version of R, but you have not 
told us...). It tells us:
"RMySQL is available at http://stat.bell-labs.com/RS-DBI/download,
provided by its maintainer, David A. James."

Uwe Ligges


> Thanks for help
> Annika
>

From ggrothendieck at gmail.com  Sun May 29 16:57:35 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun May 29 16:57:43 2005
Subject: [Rd] as.Date.factor
Message-ID: <971536df0505290757140e4af1@mail.gmail.com>

as.Date.character has a format= argument but as.Date.factor does not
which means that one can only use as.Date.factor if the factor labels have
the default Date format.  

as.Date.factor just does a

   # as.Date.factor currently does this
   as.Date(as.character(x)) 

but for consistency's sake I think it should pass additional arguments such
as format along:

   # as.Date.factor should do this
   as.Date(as.character(x,), ...)

From maechler at stat.math.ethz.ch  Mon May 30 10:50:51 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon May 30 10:51:05 2005
Subject: [Rd] Reversing axis in a log plot (PR#7894)
Message-ID: <20050530085051.49E9E8B54@slim.kubism.ku.dk>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Fri, 27 May 2005 11:42:54 +0200 (CEST) writes:

    UweL> Please find attached my proposal for a bugfix. The
    UweL> experts might to better, though.

    UweL> Uwe Ligges

Thank you, Uwe!

Yes, your fix works, and yes, it can be improved (e.g., no need for
the 'atr'; no 'reversed' when in the linear case, ..)

Also, there won't be any warning either anymore,
since
	plot(1:3, exp(1:3), xlim = c(30,1))
also gives no warning.

You'll find the fixed plot.c in tomorrow's snapshot.

Martin

BTW:  The whole thing {axis reversion} doesn't work in S-plus
      {doing a non-sensical plot, with tons of warnings}

From tobias.verbeke at telenet.be  Mon May 30 11:37:31 2005
From: tobias.verbeke at telenet.be (tobias.verbeke@telenet.be)
Date: Mon May 30 11:37:48 2005
Subject: [Rd] ?strptime ambiguity (PR#7907)
Message-ID: <20050530093731.65A2A8601@slim.kubism.ku.dk>

Full_Name: Tobias Verbeke
Version: 2.1.0
OS: GNU/Linux
Submission from: (NULL) (81.247.252.229)


Would it be possible to use a non-ambiguous example
of expressing a day according to the ISO 8601 international
standard in the first sentence of the Note section of
?strptime, e.g. "2001-04-18" instead of "2001-02-03" ?

Yours,
Tobias

From maechler at stat.math.ethz.ch  Mon May 30 12:23:01 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon May 30 12:23:08 2005
Subject: [Rd] ?strptime ambiguity (PR#7907)
Message-ID: <20050530102301.BC902ED0B@slim.kubism.ku.dk>

>>>>> "tobias" == tobias verbeke <tobias.verbeke@telenet.be>
>>>>>     on Mon, 30 May 2005 11:37:31 +0200 (CEST) writes:

    tobias> Full_Name: Tobias Verbeke Version: 2.1.0 OS:
    tobias> GNU/Linux Submission from: (NULL) (81.247.252.229)


    tobias> Would it be possible to use a non-ambiguous example
    tobias> of expressing a day according to the ISO 8601
    tobias> international standard in the first sentence of the
    tobias> Note section of ?strptime, e.g. "2001-04-18" instead
    tobias> of "2001-02-03" ?

yes, it would be possible...

More seriously:  Thank you for the suggestion; it will be in
R-devel.

Martin

From allsi at eau.ee  Tue May 31 11:24:44 2005
From: allsi at eau.ee (allsi@eau.ee)
Date: Tue May 31 11:24:51 2005
Subject: [Rd] minus: operator and sign (PR#7908)
Message-ID: <20050531092444.3B1FEA1D8@slim.kubism.ku.dk>

Full_Name: Allan Sims
Version: 2.1.0
OS: WinXP
Submission from: (NULL) (193.40.25.254)


This should not be correct. It seams that first power is applied and then sign.
> -2^2
[1] -4

From ligges at statistik.uni-dortmund.de  Tue May 31 12:03:32 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Tue May 31 12:03:40 2005
Subject: [Rd] minus: operator and sign (PR#7908)
Message-ID: <20050531100332.E92EE8709@slim.kubism.ku.dk>

allsi@eau.ee wrote:

> Full_Name: Allan Sims
> Version: 2.1.0
> OS: WinXP
> Submission from: (NULL) (193.40.25.254)
> 
> 
> This should not be correct. It seams that first power is applied and then sign.
> 
>>-2^2
> 
> [1] -4
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


So you are telling us in a *bug* report that R works as expected???
The current R Language Definition manual tells us in Section "Parser" - 
"Expressions" - "Infox and prefix operators" (which is 10.4.2 in the 
current version) the details on the order of precendence ("^" before 
unary "-"!).

Please read the docs before submitting bug reports!

Uwe Ligges

From ligges at statistik.uni-dortmund.de  Tue May 31 12:08:10 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue May 31 12:07:08 2005
Subject: [Rd] minus: operator and sign (PR#7908)
In-Reply-To: <429C36AA.7080609@statistik.uni-dortmund.de>
References: <20050531092444.3B1FEA1D8@slim.kubism.ku.dk>
	<429C36AA.7080609@statistik.uni-dortmund.de>
Message-ID: <429C378A.5080203@statistik.uni-dortmund.de>

Uwe Ligges wrote:

> allsi@eau.ee wrote:
> 
>> Full_Name: Allan Sims
>> Version: 2.1.0
>> OS: WinXP
>> Submission from: (NULL) (193.40.25.254)
>>
>>
>> This should not be correct. It seams that first power is applied and 
>> then sign.
>>
>>> -2^2
>>
>>
>> [1] -4
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> 
> So you are telling us in a *bug* report that R works as expected???
> The current R Language Definition manual tells us in Section "Parser" - 
> "Expressions" - "Infox and prefix operators" (which is 10.4.2 in the 
> current version) the details on the order of precendence ("^" before 
> unary "-"!).
> 
> Please read the docs before submitting bug reports!
> 
> Uwe Ligges
> 


BTW: ?Syntax should have told you as well.

Uwe Ligges

From Ted.Harding at nessie.mcc.ac.uk  Tue May 31 12:07:18 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Tue May 31 12:29:58 2005
Subject: [Rd] minus: operator and sign (PR#7908)
In-Reply-To: <20050531092444.3B1FEA1D8@slim.kubism.ku.dk>
Message-ID: <XFMail.050531110718.Ted.Harding@nessie.mcc.ac.uk>

On 31-May-05 allsi@eau.ee wrote:
> Full_Name: Allan Sims
> Version: 2.1.0
> OS: WinXP
> Submission from: (NULL) (193.40.25.254)
> 
> 
> This should not be correct. It seams that first power is applied and
> then sign.
>> -2^2
> [1] -4

Rule 1: Know your enemy!

?Syntax -->

     The following unary and binary operators are defined.  They are
     listed in precedence groups, from highest to lowest.

       .......

       '^'                exponentiation (right to left)
       '- +'              unary minus and plus

       .......

       '+ -'              (binary) add, subtract

       .......

So "^" takes precedence over unary "-", which takes precedence
over binary "+" and "-".

But it is always safe (and often prudent) to force precedence
with parentheses -- at least you yourself are then absolutely
sure of exactly what is going to happen, which is the really
important thing (and this is Rule 2, which takes precedence
over Rule 1).

So if you want to force "-2^2" and similar to be the square
of "-2" then do "(-2)^2". And it adds clarity to things like

  2 - - - 2^2

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 31-May-05                                       Time: 11:06:58
------------------------------ XFMail ------------------------------

From Ted.Harding at nessie.mcc.ac.uk  Tue May 31 13:26:09 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Tue May 31 14:00:50 2005
Subject: [Rd] minus: operator and sign (PR#7908)
In-Reply-To: <XFMail.050531110718.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <XFMail.050531121211.Ted.Harding@nessie.mcc.ac.uk>

On 31-May-05 Ted Harding wrote:
> [...]
> But it is always safe (and often prudent) to force precedence
> with parentheses -- at least you yourself are then absolutely
> sure of exactly what is going to happen, which is the really
> important thing (and this is Rule 2, which takes precedence
> over Rule 1).
> 
> So if you want to force "-2^2" and similar to be the square
> of "-2" then do "(-2)^2". And it adds clarity to things like
> 
>   2 - - - 2^2

PS: And will also avoid typopathological events such as

  > x<-y

when what you really meant was

  > x< -y
  [1] FALSE

Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 31-May-05                                       Time: 11:50:07
------------------------------ XFMail ------------------------------

From tplate at blackmesacapital.com  Tue May 31 19:13:42 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Tue May 31 19:13:50 2005
Subject: [Rd] (PR#7899) seek(con, 0, "end", rw="r") does not always work
Message-ID: <20050531171342.E4295A274@slim.kubism.ku.dk>

Uwe Ligges wrote:
> Tony Plate wrote:
> 
>> ligges@statistik.uni-dortmund.de wrote:
>>
>>> tplate@blackmesacapital.com wrote:
>>>
>>>
>>>> I've noticed that seek(con, 0, "end", rw="r") on a file connection 
>>>> does not always work correctly after a write (R 2.1.0 on Windows).
>>>>
>>>> [Is a call to fflush() needed inside file_seek() in 
>>>> main/connections.c?]
>>>
>>>
>>>
>>>
>>>
>>> If you have an idea where to fflush() precisely and your patch works, 
>>> please tell it! I'll happily run some test cases where seeking matters.
>>>
>>
>> I couldn't see why the current code was returning a bad value under 
>> some conditions.  (That's why didn't offer anything more than a 
>> suggestion).  My suggestion to use an fflush() was a guess (hence the 
>> question mark, but evidence for the guess being correct was that doing 
>> a flush at the R command line made the whole thing work correctly.)  
>> To be safe, I would try to put a flush() right at the beginning of 
>> file_seek(), before the call to f_tell().  I tried this, and with the 
>> modification the test case I gave produced correct output.  Here's how 
>> the beginning of my modified file_seek() function (in 
>> main/connections.c) looks:
> 
>  >
> 
>> static double file_seek(Rconnection con, double where, int origin, int 
>> rw)
>> {
>>     Rfileconn this = con->private;
>>     FILE *fp = this->fp;
>> #if defined(HAVE_OFF_T) && defined(__USE_LARGEFILE)
>>     off_t pos;
>> #else
>> #ifdef Win32
>>     off64_t pos;
>> #else
>>     long pos;
>> #endif
>> #endif
>>     int whence = SEEK_SET;
>>     fflush(fp);
>>     pos = f_tell(fp);
>>
>>     /* make sure both positions are set */
>>
> 
> 
> Works for your example, but I found another one where it introduces a 
> worse bug when using origin="current". Hence it's not that easy.
> 
> After reviewing this issue more closely, I think writeLines() into a 
> binary connection might be the real problem and a misuse in this case. 
> See the last paragrpah in the Details Section of ?writeLines. Hence, 
> this might also be an issue related to the text mode connection problem 
> on Windows.
> 
> Using simple writeChar and readChar statements works as expected for me 
> (at least, I was not able to produce anything unexpected). I'm no longer 
> convinced that this is a bug in R.

I see the same (buggy) behavior when I replace the writeLines() 
statements by writeChar() statments (but continue using readLines()).  I 
also see the same buggy behavior when I explicitly supply a 'sep' 
argument to writeLines().  Transcripts of both of these are below. 
[Also, in both cases, calling the R function flush() at indicated 
position in the transcript results in correct output.]

Regarding the documentation for writeLines, it states:

      Normally 'writeLines' is used with a text connection, and the
      default separator is converted to the normal separator for that
      platform (LF on Unix/Linux, CRLF on Windows, CR on Classic MacOS).
       For more control, open a binary connection and specify the
      precise value you want written to the file in 'sep'.  For even
      more control, use 'writeChar' on a binary connection.

The sentence beginning "For more control" seems to permit the use of 
writeLines() for binary connections.  What suggested to you that it was 
a misuse?


 > # seek(, rw="r") on a file does not always work a write
 > # even when sep="\n" is supplied to writeLines
 > f <- file("tmp3.txt", "w+b")
 > # Write something earlier in the file
 > seek(f, 10, rw="w")
[1] 0
 > writeLines(c("ghi", "jkl"), f, sep="\n")
 > seek(f, 20, rw="w")
[1] 18
 > writeLines(c("abc"), f, sep="\n")
 > seek(f, 0, "end", rw="w")
[1] 24
 > # Try to read at the end of the file
 > seek(f, 0, "end", rw="r")
[1] 0
 > readLines(f, -1)
character(0)
 > seek(f, 0, "end", rw="w")
[1] 18
 > # write something at the end of the file
 > writeLines(c("def"), f, sep="\n")
 > # Try to read at the end of the file
 > # flush(f) # flushing here makes the seek work correctly
 > seek(f, 0, "end", rw="r")
[1] 24
 > seek(f, NA, rw="r") # ***WRONG*** (should return 28)
[1] 24
 > readLines(f, -1) # ***WRONG*** (should return character(0))
[1] "def"
 > seek(f, 20, rw="r")
[1] 28
 > readLines(f, -1)
[1] "abc" "def"
 > seek(f, 0, "end", rw="r") # now it works correctly
[1] 28
 > seek(f, NA, rw="r")
[1] 28
 > readLines(f, -1)
character(0)
 > close(f)
 >
 > # seek(, rw="r") on a file does not always work a write
 > # even when writeChar is used instead of writeLines
 > f <- file("tmp3.txt", "w+b")
 > # Write something earlier in the file
 > seek(f, 10, rw="w")
[1] 0
 > writeChar(c("ghi\n", "jkl\n"), f, eos=NULL)
 > seek(f, 20, rw="w")
[1] 18
 > writeChar(c("abc\n"), f, eos=NULL)
 > seek(f, 0, "end", rw="w")
[1] 24
 > # Try to read at the end of the file
 > seek(f, 0, "end", rw="r")
[1] 0
 > readLines(f, -1)
character(0)
 > seek(f, 0, "end", rw="w")
[1] 18
 > # write something at the end of the file
 > writeChar(c("def\n"), f, eos=NULL)
 > # Try to read at the end of the file
 > # flush(f) # flushing here makes the seek work correctly
 > seek(f, 0, "end", rw="r")
[1] 24
 > seek(f, NA, rw="r") # ***WRONG*** (should return 28)
[1] 24
 > readLines(f, -1) # ***WRONG*** (should return character(0))
[1] "def"
 > seek(f, 20, rw="r")
[1] 28
 > readLines(f, -1)
[1] "abc" "def"
 > seek(f, 0, "end", rw="r") # now it works correctly
[1] 28
 > seek(f, NA, rw="r")
[1] 28
 > readLines(f, -1)
character(0)
 > close(f)
 >
 > version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    1.0
year     2005
month    04
day      18
language R
 >

-- Tony Plate

