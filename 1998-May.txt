From Friedrich.Leisch@ci.tuwien.ac.at  Mon May  4 16:34:15 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 4 May 1998 17:34:15 +0200 (CEST)
Subject: Updated mass package on CRAN
Message-ID: <13645.57335.908351.332965@galadriel.ci.tuwien.ac.at>


Hi,

I've converted all functions etc. from V&R's MASS library to R
... everything's in mass_5.2pl005-2.tar.gz in the devel section of
CRAN. Below is the README:

**********************************************************

This is a first shot at porting the whole main section of V&R's MASS
library to R --- and only for cool people with a brave heart :-)

Porting was done using brute force and (almost) no checking, i.e.,
 *) all .q files were renamed to .R
 *) all man pages converted automatically using Sd2Rd
 *) all *.dat files renamed to .tab

For further changes see the ChangeLog.

Especially the data might not work at all ...

Anyway, I currently don't have time to do all the time consuming
checking/rewrite of man pages/..., but wanted to provide others with a
start.

And some things are working :-)

Good luck,

-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May  4 17:09:27 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 4 May 1998 12:09:27 -0400
Subject: lSM  lICE: not found
Message-ID: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>

I'm trying to compile R 0.61.3 on Solaris and I get the following error. Does
anyone know where I should find these libraries?

ld: fatal: library -lSM: not found
ld: fatal: library -lICE: not found
ld: fatal: File processing errors.  No output written to R.binary
*** Error code 1
make: Fatal error: Command failed for target `R.binary'

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May  4 17:35:50 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 May 1998 18:35:50 +0200
Subject: lSM  lICE: not found
In-Reply-To: Paul Gilbert's message of Mon, 4 May 1998 12:09:27 -0400
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>
Message-ID: <x267jmhu3d.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> 
> I'm trying to compile R 0.61.3 on Solaris and I get the following error. Does
> anyone know where I should find these libraries?
> 
> ld: fatal: library -lSM: not found
> ld: fatal: library -lICE: not found
> ld: fatal: File processing errors.  No output written to R.binary
> *** Error code 1
> make: Fatal error: Command failed for target `R.binary'
> 
> Paul Gilbert

Huh?

bash$ uname -a
SunOS stat 5.5.1 Generic_103640-05 sun4m sparc SUNW,SPARCstation-10

<output from make>
cd main; make
gcc -o R.binary arithmetic.o array.o attrib.o bind.o builtin.o
 ....
 ../lib/libunix.a ../lib/libappl.a ../lib/libmath.a -L/usr/openwin/lib
 -R/usr/openwin/lib -lX11 -lsocket -lnsl -ldl -lreadline -ltermcap -lm

..no mention of libSM or libICE.

Why is it requiring those libraries in the first place?? Are you
installing from scratch or might there be some leftovers from a
previous compile. The -lSM -lICE line seems to come from some generic
X11 stuff in configure and are not mentioned in configure.in, which I
suppose means: if R doesn't configure and compile, no other X program
does either....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@math.sc.edu  Mon May  4 18:11:19 1998
From: rossini@math.sc.edu (Anthony Rossini)
Date: 04 May 1998 13:11:19 -0400
Subject: lSM  lICE: not found
In-Reply-To: Peter Dalgaard BSA's message of "04 May 1998 18:35:50 +0200"
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk>
Message-ID: <wnc1zua2c7c.fsf@fhat.stat.sc.edu>


>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    >> I'm trying to compile R 0.61.3 on Solaris and I get the
    >> following error. Does anyone know where I should find these
    >> libraries?
    >> 
    >> ld: fatal: library -lSM: not found
    >> ld: fatal: library -lICE: not found
    >> ld: fatal: File processing errors.  No output written to R.binary
    >> *** Error code 1
    >> make: Fatal error: Command failed for target `R.binary'

    Peter> Huh?

    Peter> bash$ uname -a
    Peter> SunOS stat 5.5.1 Generic_103640-05 sun4m sparc SUNW,SPARCstation-10

    Peter> <output from make>
    Peter> cd main; make
    Peter> gcc -o R.binary arithmetic.o array.o attrib.o bind.o builtin.o
    Peter>  ....
    Peter>  ../lib/libunix.a ../lib/libappl.a ../lib/libmath.a -L/usr/openwin/lib
    Peter>  -R/usr/openwin/lib -lX11 -lsocket -lnsl -ldl -lreadline -ltermcap -lm

    Peter> ..no mention of libSM or libICE.

    Peter> Why is it requiring those libraries in the first place??
    Peter> Are you installing from scratch or might there be some
    Peter> leftovers from a previous compile. The -lSM -lICE line
    Peter> seems to come from some generic X11 stuff in configure and
    Peter> are not mentioned in configure.in, which I suppose means:
    Peter> if R doesn't configure and compile, no other X program does
    Peter> either....

To clarify Peter's point, -lICE -lSM are from the X11R6 distribution,
but last I checked, OpenWindows (which is what Sun shipped with the
2.5 distribution, I've got my hands on a machine running 2.6), uses
X11R5, which doesn't have those two libraries.

If you've got a confused X set up (like a local version of The Open
Group's (was MIT's) X11R6 build, this could be the result.

You should determine the version of X, and link accordingly.

The only other thought is that Sun "forgot" to ship the SM and ICE
libs; they did that with a different library a few OS distributions
ago (Slowaris 2.3?).

Or it might be some confusion (XlispStat's configure once had a
similar problem a long time ago).

best,
-tony
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May  4 19:02:40 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 4 May 1998 14:02:40 -0400
Subject: lSM  lICE: not found
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk> <wnc1zua2c7c.fsf@fhat.stat.sc.edu>
Message-ID: <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>

    Peter> Why is it requiring those libraries in the first place??
    Peter> Are you installing from scratch or might there be some
    Peter> leftovers from a previous compile. The -lSM -lICE line

Indeed this seems to have been the problem. I first tried to configure and make
on my new workstation with Solaris 2.6, but ran into a problem because
apparently I need a newer version of gcc. I then did a "make clean", telneted to
an older machine with Solaris 2.5.1, re-ran configure and then make. However,
this does not seem to get things clean enough - I guess configure does not
re-configure?

When I started completely clean from the tar file the problem seems to have gone
away.

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@math.sc.edu  Mon May  4 20:06:23 1998
From: rossini@math.sc.edu (Anthony Rossini)
Date: 04 May 1998 15:06:23 -0400
Subject: lSM  lICE: not found
In-Reply-To: Paul Gilbert's message of "Mon, 4 May 1998 14:02:40 -0400"
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk> <wnc1zua2c7c.fsf@fhat.stat.sc.edu> <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>
Message-ID: <wnchg35luts.fsf@fhat.stat.sc.edu>


>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> an older machine with Solaris 2.5.1, re-ran configure and
    Paul> then make. However, this does not seem to get things clean
    Paul> enough - I guess configure does not re-configure?

Not if it already built a cache (you can look for a config.cache file,
and delete it to force configure to look for everything -- I suspect
there is a command line option to configure to do the same.).  The
reason is to allow configuration of different options on the same
architecture w/o determining the architecture again.
(i.e. reconfiguring for mule and graphics support in xemacs, after you 
get new required libraries); it's a bit harder to justify for R.

best,
-tony


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May  4 22:26:42 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 May 1998 23:26:42 +0200
Subject: lSM  lICE: not found
In-Reply-To: Anthony Rossini's message of 04 May 1998 15:06:23 -0400
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>
 <x267jmhu3d.fsf@blueberry.kubism.ku.dk>
 <wnc1zua2c7c.fsf@fhat.stat.sc.edu>
 <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>
 <wnchg35luts.fsf@fhat.stat.sc.edu>
Message-ID: <x27m41wwvh.fsf@biostat.ku.dk>

Anthony Rossini <rossini@math.sc.edu> writes:

> 
> 
> >>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
> 
>     Paul> an older machine with Solaris 2.5.1, re-ran configure and
>     Paul> then make. However, this does not seem to get things clean
>     Paul> enough - I guess configure does not re-configure?
> 
> Not if it already built a cache (you can look for a config.cache file,
> and delete it to force configure to look for everything -- I suspect
> there is a command line option to configure to do the same.).  The
> reason is to allow configuration of different options on the same
> architecture w/o determining the architecture again.
> (i.e. reconfiguring for mule and graphics support in xemacs, after you 
> get new required libraries); it's a bit harder to justify for R.

make acclean
(or moreclean or distclean or realclean) does this automatically.

Should we let "make clean" do so as well? It's a single-word change,
but are there adverse side effects? Considering how rarely I do "make
clean" myself, I don't think I'd mind the extra time usage for
reconfiguration (about 16 seconds on this machine).


configure --cache-file=/dev/null 
disables caching, according to the comments in the script (not
terribly elegant in my opinion...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon May  4 23:17:14 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 May 1998 10:17:14 +1200 (NZST)
Subject: lSM  lICE: not found
Message-ID: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>

The intent of "make clean" is to remove the temporaries but leave a
complete runnable R.  It is quite useful when you have installed
versions of R.  Maybe the "make clean" / "make distclean" distinction
needs to be explicit in the "INSTALL" file.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue May  5 08:48:16 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 05 May 1998 09:48:16 +0200
Subject: lSM  lICE: not found
In-Reply-To: Ross Ihaka's message of Tue, 5 May 1998 10:17:14 +1200 (NZST)
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
Message-ID: <x290ohb1kv.fsf@biostat.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> The intent of "make clean" is to remove the temporaries but leave a
> complete runnable R.  It is quite useful when you have installed
> versions of R.  Maybe the "make clean" / "make distclean" distinction
> needs to be explicit in the "INSTALL" file.
> 
> 	Ross

This begs the question: Is anything in config.{cache,log,status}
necessary for R to run, then? (Or could it become so?) Otherwise
"acclean" *should* probably be made as part of "clean"

I know there's a lot of tradition and conventions in how to setup
makefiles, but wouldn't it be handy with a "rebuild" type target?

rebuild: realclean R

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 14:41:44 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 09:41:44 -0400
Subject: lSM  lICE: not found
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
Message-ID: <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>

Ross> The intent of "make clean" is to remove the temporaries but leave a
Ross> complete runnable R.  It is quite useful when you have installed
Ross> versions of R.  Maybe the "make clean" / "make distclean" distinction
Ross> needs to be explicit in the "INSTALL" file.

I had assumed "make clean" would leave a complete runnable R, that is my
runnable R wouldn't get messed up until I did "make" which does "install", which
can potentially mess up my running R. But I had also assumed that when I did
"make" I would be starting clean, which is not completely true it seems - at
least as far as the architecture and other stuff as determined by configure are
concerned.

I'm not sure what would be the best approach to make things easy for novices. I
don't use "make clean" very often for R and it is probably more of a utility for
developers - but I did get caught this time. My usual approach is just to delete
everything and start over with the tar file. I think, however, that anything
like "make distclean" or "make realclean" or "make acclean" is going to be even
more of a utility for developers - they all assume you are familiar with the
Makefile, or, if they are documented, that you read the documentation
(regularly, since these things change).

Probably the best thing to make it easy for novices is to have some "install" or
"setup" script which does all of the appropriate steps. This should also make
certain that everything is sufficiently clean that there won't be any mistakes.

Paul Gilbert



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Tue May  5 16:21:18 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Tue, 5 May 1998 16:21:18 +0100 (GMT+0100)
Subject: RSXNT (was R-0.61.1 compiled with ...)
In-Reply-To: <x27m4je3ju.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Apr 21, 98 02:56:37 pm
Message-ID: <19980505152118.5751.qmail@sirio.stat.unipd.it>

> >  Peter Dalgaard BSA writes:
> >  > 
> >  > Ouch! In that case, I suggest that we try to put some collective
> >  > effort into getting something working with RSXNT. The only thing that
Yesterday evening, I downloaded the last version of RSXNT. 
I just played with it half an hour but seems to work (at least under
WIN95).
Have someone tryed to compile R?
If not, I will make an attempt starting from my previous 
work with mingw32.
guido masarotto
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Tue May  5 16:24:17 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Tue, 5 May 1998 16:24:17 +0100 (GMT+0100)
Subject: lSM  lICE: not found (fwd)
Message-ID: <19980505152418.5768.qmail@sirio.stat.unipd.it>

 1) The effect of "make clean" is the "more standard". I checked
    with some programs of which I have the source installed and
    no remove config.cache with only clean.
 2) When you have config.cache and you rerun configure 
    you obtain a lot of line of the type "something (cached)".
    The meaning of this must perhaps be explained in the documentation.
    
 guido masarotto   
 
 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Tue May  5 15:44:09 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Tue, 5 May 1998 16:44:09 +0200 (MDT)
Subject: lSM  lICE: not found
In-Reply-To: <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
 <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
Message-ID: <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>

Paul Gilbert: 
 > Ross> The intent of "make clean" is to remove the temporaries but leave a
 > Ross> complete runnable R.  It is quite useful when you have installed
 > Ross> versions of R.  Maybe the "make clean" / "make distclean" distinction
 > Ross> needs to be explicit in the "INSTALL" file.
 > 
 > I had assumed "make clean" would leave a complete runnable R, that is my
 > runnable R wouldn't get messed up until I did "make" which does "install", which
 > can potentially mess up my running R. But I had also assumed that when I did
 > "make" I would be starting clean, which is not completely true it seems - at
 > least as far as the architecture and other stuff as determined by configure are
 > concerned.
 > 
 > I'm not sure what would be the best approach to make things easy for novices. I
 > don't use "make clean" very often for R and it is probably more of a utility for
 > developers - but I did get caught this time. My usual approach is just to delete
 > everything and start over with the tar file. I think, however, that anything
 > like "make distclean" or "make realclean" or "make acclean" is going to be even
 > more of a utility for developers - they all assume you are familiar with the
 > Makefile, or, if they are documented, that you read the documentation
 > (regularly, since these things change).
 > 
 > Probably the best thing to make it easy for novices is to have some "install" or
 > "setup" script which does all of the appropriate steps. This should also make
 > certain that everything is sufficiently clean that there won't be any mistakes.

I agree!

The (good!) tradition Peter Dalgaard addresses means

- "make" -- OK, we all know...

- "make clean" returns to the state after configure

- "make distclean" returns to the state before configure

- "make install" installs the whole at the standard place /usr/local
which may be redirected by "configure --prefix=..."

Everyone knows it and one may be irritated if there is another
arrangement (OK, may be I become old :-)

I allready wanted to suggest you authors to add that install target
because

- I don't like to build the whole stuff in /usr/local
- I don't like to have the R script point to any build directory
- I don't want to think about which files have to be moved to
/usr/local for the program to run correctly. The author knows that (I
hope :-)

As for R, there is no clean separation between the build stuff and the
run stuff. I would like to have it.

But anyway: Thanks for that program!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Tue May  5 15:55:39 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 5 May 1998 16:55:39 +0200 (CEST)
Subject: lSM  lICE: not found
In-Reply-To: <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
 <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
 <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>
Message-ID: <13647.10347.618706.726445@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 5 May 1998 16:44:09 +0200 (MDT),
>>>>> Hubert Palme (HP) wrote:


HP> I allready wanted to suggest you authors to add that install target
HP> because

HP> - I don't like to build the whole stuff in /usr/local
HP> - I don't like to have the R script point to any build directory
HP> - I don't want to think about which files have to be moved to
HP> /usr/local for the program to run correctly. The author knows that (I
HP> hope :-)

HP> As for R, there is no clean separation between the build stuff and th=
e
HP> run stuff. I would like to have it.

The authors also want to have it for quite some time ;-) ... meaning
it's on our TODO list for 0.62 since I can't recall when ...

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May  5 17:36:33 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 May 1998 18:36:33 +0200
Subject: make and all that..
In-Reply-To: <x290ohb1kv.fsf@biostat.ku.dk> (message from Peter Dalgaard BSA
 on 05 May 1998 09:48:16 +0200)
Message-ID: <199805051636.SAA04565@sophie.ethz.ch>


>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

     ......

    PD> I know there's a lot of tradition and conventions in how to setup
    PD> makefiles, but wouldn't it be handy with a "rebuild" type target?

    PD>		rebuild: realclean R

I like your proposition!

(and I won't be the one who writes an ./Install shell script!

 I personally think, 'make <target>' should be enough;
 however, I agree that the documentation could be improved.

 I don't expect people who don't read an ./INSTALL or ./README file
 to install or run R...
)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 18:09:35 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 13:09:35 -0400
Subject: make and all that..
References: <199805051636.SAA04565@sophie.ethz.ch>
Message-ID: <98May5.133306edt.13450@mailgate.bank-banque-canada.ca>

>I don't expect people who don't read an ./INSTALL or ./README file
> to install or run R...

And here I was just thinking how much fun it would be to burn a CD  so everyone
could just stick it in their machine and R would pop up, maybe even with a GUI
interface.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May  5 18:18:02 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 May 1998 19:18:02 +0200
Subject: make and all that..
In-Reply-To: <98May5.133306edt.13450@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 5 May 1998 13:09:35 -0400)
Message-ID: <199805051718.TAA04644@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> I don't expect people who don't read an ./INSTALL or ./README file
    >> to install or run R...

    PaulG> And here I was just thinking how much fun it would be to burn a
    PaulG> CD so everyone could just stick it in their machine and R would
    PaulG> pop up, maybe even with a GUI interface.

Paul, the above behavior ``works'' with binary distributions
	(we have at least Debian and RedHat for Linux),
but never with source code distributions.

We are following  quite a standard approach for source code distributions
having the

	1)
	  ## Edit config.site manually if you want special behavior

	2) 
	  configure
		## configure with arguments if you want....

	3)
	  make

The only thing missing is a ``proper''

	4)
	  make install

which Kurt and Fritz (;-}) will probably provide for R 0.62
which seems to be due currently for Mid-June or so.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 19:22:38 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 14:22:38 -0400
Subject: make and all that..
References: <199805051718.TAA04644@sophie.ethz.ch>
Message-ID: <98May5.144613edt.13447@mailgate.bank-banque-canada.ca>

Martin

Don't take me too seriously on this. I think you are all doing a great job and
I'm amazed at how well everything usually works in R. Besides, if I wanted to
have things automatically execute when I stick in the CD I'd probably be working
in Windows, not on Unix.

About "make install", I usually think of this as a last step, after you've
successfully made everything, to put things in the proper place for users to
have access. Maybe I'm wrong on the usual convention, but I don't think of it as
necessarily starting at the beginning. What I was suggesting with an install
script (setup may be a better name) was something that would make sure
everything was very clean and start at the beginning with configure and make.
This is not a high priority, but it also does not have to be very difficult. It
might simply be a script with lines

make extrasuperclean
configure
make
make doc
make install

or something like that. I realize this may not work for every case, but I think
it can work very well for a large percentage of the simple cases. The main
advantage of something like this is that after a while dumb users like me start
to know the install script does everything and we can just type "install". That
way developers can play with the makefile more easily and not worry too much if
the documentation is completely up-to-date, as long as the install script works
and the documentation still says "use the install script". (I've been on the
other side of this - the problem with documentation is that it's usually for a
previous version. After a while it is much easier to test that a script works
than it is to make sure the documentation is correct.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May  6 11:01:35 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 May 1998 12:01:35 +0200
Subject: min(numeric(0)) = ?   -- proposal for "S incompatible change"
Message-ID: <199805061001.MAA05776@sophie.ethz.ch>

[Same question for  max(.),  cummin(.) and cummax(.)]

In S, S-plus and R, this currently gives NA.

I wonder if it wouldn't make more sense to follow common
mathematical/logical reasoning here:

	min { empty set } = +Inf

	max { empty set } = -Inf

(For integers, these would be  INT_MAX and INT_MIN, respectively).

Maybe this is a real ``first time'':

	I am proposing a change which would lead from
	"S compatible" to  "S incompatible"

	{since I don't expect S to change, 
	 given my recent experience with my plea to change 'n %% m' 
	 (for negative n or m, the result DIFFERS, depending on
	  storage.mode = "integer" or "double" !!!)

	Note that I've spent quite a bit more thought on the "%%" issue 
	than on this one!


Comments?
Pros/ Cons?

Martin Maechler <maechler@stat.math.ethz.ch>			<><
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May  6 11:27:16 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 May 1998 12:27:16 +0200
Subject: min(numeric(0)) = ?  == SORRY:  R already has  +/- Inf
In-Reply-To: <199805061001.MAA05776@sophie.ethz.ch> (message from Martin
 Maechler on Wed, 6 May 1998 12:01:35 +0200)
Message-ID: <199805061027.MAA05825@sophie.ethz.ch>

My last message stated something wrong:

In R 0.62, we already have

    > min(numeric(0))
    [1] Inf
    > max(numeric(0))
    [1] -Inf
    > max(integer(0))
    [1] -Inf
    > min(integer(0))
    [1] Inf

The only change I'd propose is to return 'integer' if all arguments are
'integer', i.e., e.g.,
	
	min(integer(0))  would return  .Machine$int.max

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 14:17:30 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 15:17:30 +0200 (MDT)
Subject: Compiling on SGI Irix 5.3
Message-ID: <199805061317.PAA12784@wrin27.urz.uni-wuppertal.de>

Hello,

I successfully compiled 0.61.3 on SGI Irix 5.3 (CC). But there is a
syntax bug in src/graphics/graphics.c. I append a diff. Please, have a 
look wether the fix is correct! (I'm not shure :-)

Thanks for the SHELL variable in the Makefile's. Please, don't forget
about the problem with externally installed regular expression
libraries (e.g. librx). Perhaps you can improve the configure
script...

Thanks!
HP.

*** src/graphics/graphics.c.origin      Fri Mar 13 11:51:50 1998
--- src/graphics/graphics.c     Tue May  5 15:25:25 1998
***************
*** 805,812 ****
        *ndiv = nu - ns;
  
        if(*ndiv <= 0)
!         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);
!                dx=%g, unit=%3e, ismall=%1d.\n",
                 x1,x2, nd0, cell, *ndiv, ns, nu, dx, unit, (int)i_small);
  }
  
--- 805,812 ----
        *ndiv = nu - ns;
  
        if(*ndiv <= 0)
!         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);"
!                "\t\t dx=%g, unit=%3e, ismall=%1d.\n",
                 x1,x2, nd0, cell, *ndiv, ns, nu, dx, unit, (int)i_small);
  }

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 14:35:57 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 15:35:57 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
Message-ID: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>

I forgot:

"make docs" for LaTeX doesn't collect any information about the
functions. So in Man.dvi the appendix C is empty. A Bug??

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May  6 14:57:22 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 May 1998 15:57:22 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Wed, 6 May 1998 15:35:57 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
Message-ID: <x27m3zzem5.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

> 
> I forgot:
> 
> "make docs" for LaTeX doesn't collect any information about the
> functions. So in Man.dvi the appendix C is empty. A Bug??
> 

In your LaTeX setup, perhaps... No problem on Linux. Or the Makefile
is using stuff that only works with GNU make. You may have to do that
step manually.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 15:41:16 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 16:41:16 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > palme@uni-wuppertal.de (Hubert Palme) writes:
 > 
 > > 
 > > I forgot:
 > > 
 > > "make docs" for LaTeX doesn't collect any information about the
 > > functions. So in Man.dvi the appendix C is empty. A Bug??
 > > 
 > 
 > In your LaTeX setup, perhaps... No problem on Linux. Or the Makefile
 > is using stuff that only works with GNU make. You may have to do that
 > step manually.

(cd ../doc/manual; gmake Man.dvi)
gmake[2]: Entering directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
Collecting components of  pkg-base.tex ..
gmake[2]: execvp: /bin/sh: Arg list too long
gmake[2]: *** [pkg-base.tex] Error 127
gmake[2]: Leaving directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
gmake[1]: [../doc/manual/Man.dvi] Error 2 (ignored)
gmake[1]: Leaving directory `/daten/softy/software/Statistik/R/R-0.61.3/etc'

May be it's time to split this step?!?

How can I do it myself?

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May  6 16:37:31 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 May 1998 17:37:31 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Wed, 6 May 1998 16:41:16 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
Message-ID: <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

>  > > "make docs" for LaTeX doesn't collect any information about the
>  > > functions. So in Man.dvi the appendix C is empty. A Bug??
> 
> (cd ../doc/manual; gmake Man.dvi)
> gmake[2]: Entering directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
> Collecting components of  pkg-base.tex ..
> gmake[2]: execvp: /bin/sh: Arg list too long

Uh, oh... 

$ echo ../../library/base/latex/*.tex | wc
      1     325   11850

A 12K command line! I can believe that that might be a problem on some
systems.

The way to split it must be something along the lines of replacing the
last line of

pkg-base.tex: $(RLIB)/base/latex/*.tex
        @echo 'Collecting components of  $@ ..'
        @sed 's/__PKG__/base/g' Pkg-start.tex | cat - $^ Pkg-end.tex > $@

with
	@cat $(RLIB)/base/latex/[A-e]*.tex > pkg-base.1
	@cat $(RLIB)/base/latex/[f-p]*.tex > pkg-base.2
	@cat $(RLIB)/base/latex/[q-z]*.tex > pkg-base.3
        @sed 's/__PKG__/base/g' Pkg-start.tex |\
		 cat - pkg-base.[123] Pkg-end.tex > $@
	@rm pkg-base.[123]

You may need to adjust the boundaries there of course.

Another option could be


	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
		find $(RLIB)/base/latex/ -name '*.tex' -print |\
		 sort | xargs cat ;\
		 cat Pkg-end.tex) > $@

But does all relevant systems have the xargs command?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May  7 13:59:16 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 May 1998 14:59:16 +0200
Subject: R-beta: 0.61.3: Problems on DEC Unix 4.0
In-Reply-To: <Pine.OSF.3.93.980507083904.16406B-100000@alpha2-stat.sci.uni-klu.ac.at>
 (message from Albrecht Gebhardt on Thu, 7 May 1998 14:51:55 +0200 (MET
 DST))
Message-ID: <199805071259.OAA08264@sophie.ethz.ch>


>> cc: Error: graphics.c, line 808: An unexpected newline character is present
>>  in a string literal.
>>         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);
>> ---------------^
We had already Hubert Palme (SGI Irix) complaining about this and proposing
(a slightly different) patch (I prefer your patch).

This is mea culpa.
It works (w/o patch!), both with Solaris 'cc' and  'gcc'
(and isn't it ANSI C ?).

Sorry!


I just found another buglet (in 0.61.x and 0.62.snap):

    > prod(c(1:3,NA,pi),na.rm=FALSE)
    [1] NA
    > prod(c(1:3,NA,pi),na.rm=TRUE)
    R(bug): [1] NA
    S(ok) : [1] 18.84956

This is in main/summary.c  which I am patching anyway..

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May  7 14:04:49 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 May 1998 15:04:49 +0200
Subject: R-beta: 0.61.3: Problems on DEC Unix 4.0
In-Reply-To: <199805071259.OAA08264@sophie.ethz.ch> (message from Martin
 Maechler on Thu, 7 May 1998 14:59:16 +0200)
Message-ID: <199805071304.PAA08279@sophie.ethz.ch>

Sorry, I am getting old and silly and careless and .....

The  prod(.) problem  is  *NOT*  in 0.61.x !!

R-0.61.3  behaves as it should:

    > prod(c(1:3,NA,pi),na.rm=TRUE)
    [1] 18.84956
    > prod(1:3,NA,pi, na.rm=TRUE)
    [1] 18.84956
---
Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Thu May  7 14:46:11 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Thu, 7 May 1998 15:46:11 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > 
 > Uh, oh... 
 > 
 > $ echo ../../library/base/latex/*.tex | wc
 >       1     325   11850
 > 
 > A 12K command line! I can believe that that might be a problem on some
 > systems.
 > 
 > The way to split it must be something along the lines of replacing the
 > last line of
 > 
 > pkg-base.tex: $(RLIB)/base/latex/*.tex
 >         @echo 'Collecting components of  $@ ..'
 >         @sed 's/__PKG__/base/g' Pkg-start.tex | cat - $^ Pkg-end.tex > $@
 > 
 > with
 > 	@cat $(RLIB)/base/latex/[A-e]*.tex > pkg-base.1
 > 	@cat $(RLIB)/base/latex/[f-p]*.tex > pkg-base.2
 > 	@cat $(RLIB)/base/latex/[q-z]*.tex > pkg-base.3
 >         @sed 's/__PKG__/base/g' Pkg-start.tex |\
 > 		 cat - pkg-base.[123] Pkg-end.tex > $@
 > 	@rm pkg-base.[123]

This works...

 > 
 > You may need to adjust the boundaries there of course.

... without adjusting (the [x-y] boundaries I guess).

 > 
 > Another option could be
 > 
 > 
 > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
 > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
 > 		 sort | xargs cat ;\
 > 		 cat Pkg-end.tex) > $@
 > 
 > But does all relevant systems have the xargs command?

Irix does, but the first solution is better understandable :-)

Thanks!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu May  7 15:20:15 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 May 1998 16:20:15 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Thu, 7 May 1998 15:46:11 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
 <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>
Message-ID: <x24sz29n8g.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

>  > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
>  > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
>  > 		 sort | xargs cat ;\
>  > 		 cat Pkg-end.tex) > $@
>  > 
>  > But does all relevant systems have the xargs command?
> 
> Irix does, but the first solution is better understandable :-)

But the latter *never* creates too long command lines (xargs is built
to handle that). The other one has the problem that we have to guess
relevant splitting points for systems that we do not have...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Thu May  7 15:38:29 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Thu, 7 May 1998 16:38:29 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x24sz29n8g.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
 <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>
 <x24sz29n8g.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805071438.QAA19486@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > palme@uni-wuppertal.de (Hubert Palme) writes:
 > 
 > >  > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
 > >  > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
 > >  > 		 sort | xargs cat ;\
 > >  > 		 cat Pkg-end.tex) > $@
 > >  > 
 > >  > But does all relevant systems have the xargs command?
 > > 
 > > Irix does, but the first solution is better understandable :-)
 > 
 > But the latter *never* creates too long command lines (xargs is built
 > to handle that). The other one has the problem that we have to guess
 > relevant splitting points for systems that we do not have...

So you should use this.

Anyway, the user should have GNU Make installed (the Irix make doesn't
work whith this Makefile). Why not install GNU Findutils if the target
system doesn't have xargs...

But do write this into the INSTALL file!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu May  7 16:38:35 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 May 1998 17:38:35 +0200
Subject: R-beta: scripting with R?
In-Reply-To: Luke Tierney's message of Thu, 7 May 1998 10:03:50 -0500 (CDT)
References: <9805071503.AA23870@nokomis.stat.umn.edu>
Message-ID: <x2yawe851g.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> Unless I'm very much mistaken (which would not be the first time :-))
> I think you can mix console and graphics behavior under Win32 (NT and
> 95, not Win32s) in one application. So having command line options
> that choose between creating a command window or using standard
> input/output would be possible. I haven't looked into th details yet,
> but I'm pretty sure it can be done.

Yes. In particular, a console application can do graphs. But if you
want to support Win32s, you're more or less stuck with the current
model.

Another thing: if you want the windowed text interface (scrollbars!)
launched from console program, I suspect you get a dangling "DOS-box".
I've only seen link-time solutions to that one.

So it's probably easier just to make two different .exe files...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Thu May  7 17:16:17 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 7 May 1998 11:16:17 -0500 (CDT)
Subject: R-beta: scripting with R?
In-Reply-To: <x2yawe851g.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at May 7, 98 05:38:35 pm
Message-ID: <9805071616.AA23929@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Another thing: if you want the windowed text interface (scrollbars!)
> launched from console program, I suspect you get a dangling "DOS-box".
> I've only seen link-time solutions to that one.
> 

I think it may be possible to handle that with some of the console api
functions, but I'm not sure.

> So it's probably easier just to make two different .exe files...

Probably true. But it may make sense to factor it as Win32s/real Win32
rather that console/gui.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu May  7 20:22:35 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Thu, 7 May 1998 20:22:35 +0100 (GMT+0100)
Subject: R-beta: scripting with R? (and also some news on RSXNT)
In-Reply-To: <x290oe9pqv.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at May 7, 98 03:26:00 pm
Message-ID: <19980507192235.11930.qmail@sirio.stat.unipd.it>

Peter Dalgaard BSA writes:
> 
> zk@biocem.univ-bpclermont.fr (Zivan Karaman) writes:
> 
> > Does it work (and how) under Windows? (I'm using the version compiled by
> > Guido Masarotto on an NT4 machine).
> 
> Nope. With Win32 (95/NT) you have to decide whether to write a
> "console application" or a "windowed" one. Guido's is of the latter
> variety and you need the former in order to do redirections etc. 
   
   A simple solution would be to introduce a command-line option, e.g.,
   R -save/nosave -source FileName1 FileName2 .....
   with a obvious meaning, or maybe
   R -save/nosave FileName FileName1 FileName2 .....
   This seems easy to do and can be a interesting option also under
   Unix since, it is only my opinion, it provides a cleaner interface.
   Perhaps, under MSWindows or other "windowed" version, we should
   provide also a -iconic option.
   
   
> It is in fact quite easy to do a console R with the mingw32 tools and
> (probably) also with RSXNT. Start with the Unix sources and throw out
> anything that refuses to compile, such as the X11 stuff and things
> related to system() (the latter might be fakeable, but won't work out
> of the box). 

  I can confirm that it easy. This was my first attempt and in half an
  hour I have a console R working (no dynamic linking, but I 
  suppose that you can include the dynload.c from Windows).
  Anyway, I didn't keep the modified source.
  The problems with the system() stuff under MsWindows is not the
  C system() function that works but the R shell scripts (which
  of course require a Unix shell). 
  I don't know if it is already in the TODO list, but a low
  priority suggestion is to insert somewhere (CFLAGS, Platform.h
  I don't know where) a NOX11 flag.
  
  BTW, this morning, I had some time and I tried to recompile R
  (the last "stable" version, i.e., 0.61.3) with RSXNT.
  It seems to work (but I just tryed a couple of demos
  under Win95). 
  I just used my mingw32 port and the mingw32 winapi header
  and didn't try to use g77 (Ok, I tryed but it didn't work,
  I don't know why).
  I hope to put something available the next week.
  In particular, I want to try to use R.exe as a dll so that
  dynamic libraries can use R_alloc, callS ....
  I was not able to do this with egcs-mingw32 (I tryed all
  the rules that I found to build a relocable exe with the
  gnu binutils but  no one worked; suggestion?) but
  I made some tests with RSXNT (not with R, however) with
  good results. A minor problem is that the standard C stack
  is not large enough to execute all the demos. I can
  increase it but not dinamically. How can I determine a reasonable
  value?
  
  guido masarotto

  

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 20:37:42 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 15:37:42 -0400
Subject: more on library()
Message-ID: <98May11.165202edt.13485@mailgate.bank-banque-canada.ca>

The problem with multiple packages in a library that I reported a few minutes
ago seems to occur only if RLIBS ends in a ":". I was setting
RLIBS=../padi/rlib:$RLIBS and when RLIBS has no value to begin with this causes
the problem.

This is obviously not very urgent as I can get around it easily.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 20:08:14 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 15:08:14 -0400
Subject: library()
Message-ID: <98May11.165206edt.13495@mailgate.bank-banque-canada.ca>

In 0.61.3 there seems to be some problem with multiple packages. library()
recognizes them but library("name") only finds the first one. Suggestions would
be appreciated.

Paul Gilbert
_____

Version 0.61.3  (May 3, 1998)
> library()
Packages in library `/home/res/gilp/padi/pub/padi.v1beta4/R.client/rlibs':

padi            Protocol for Application/Database Interface
syskern         coding kernel for S/R and OS compatability
tframe          Time Frame coding kernel

Packages in library `/home/res4/gilp/R-versions/R-0.61.3/library':

base            The R base package
eda             Exploratory Data Analysis
mva             Classical Multivariate Analysis
stepfun         Step Functions, including Empirical Distributions
> library("padi")
> library("syskern")
Error: There is no package called `syskern'


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Mon May 11 22:13:28 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 May 1998 14:13:28 -0700 (PDT)
Subject: more on library()
In-Reply-To: <98May11.165202edt.13485@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980511141216.8317B-100000@gorn>

On Mon, 11 May 1998, Paul Gilbert wrote:

> The problem with multiple packages in a library that I reported a few minutes
> ago seems to occur only if RLIBS ends in a ":". I was setting
> RLIBS=../padi/rlib:$RLIBS and when RLIBS has no value to begin with this causes
> the problem.
> 

I can't reproduce this even when RLIBS ends in ":". I've tried in both
tcsh and bash, and on Solaris and Debian (ie /bin/sh is bash) systems.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 22:32:42 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 17:32:42 -0400
Subject: more on library() - my error
Message-ID: <98May11.173338edt.13444@mailgate.bank-banque-canada.ca>

Another stupid error on my part. I've just discovered that I managed to install
an empty library. I'm not sure how hard that is to do. I installed the source in
the location where the rlib was suppose to go. This seemed to put in place
enough of the pieces that the name and description were picked up, but the
R/padi.R file didn't get converted to R/padi.

Sorry for the false report.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May 13 08:07:09 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 May 1998 09:07:09 +0200
Subject: readline installation [Re: R-beta: ....]]
Message-ID: <199805130707.JAA10115@sophie.ethz.ch>

I think, we should give more hints on installing / using readline with R.

Maybe there could be one ASCII file
	README-readline-Installation

added to the FTP sites  *and* to R-0.61.3.tar.gz
explaining some the things  Peter Dalgaard just said on R-help.

I agree with Jan that it's a pity for non-programmer-hackers  if they won't
be able to use readline (most probably, these are the ones who will not be
using ESS [= Emacs Speaks Statistics] either!),
or even they won't even realize that there readline *was* available.

Further, for R 0.62, I think we should try quite a bit harder to
have configure searching around for the readline library and include files.
[[maybe, yet again look more closely at what octave does?]]

Martin

----------------

FYI, I got the following, yesterday, privately.

>> Date: Tue, 12 May 1998 10:28:09 +0200 (MET DST)
>> From: Jan Kutylowski <janku@ifi.uio.no>
>> To: maechler@stat.math.ethz.ch
>> CC: ajanku@ulrik.uio.nox
>> In-reply-to: message from Martin Maechler on Fri, 8 May 1998 14:40:28 +0200
>> Subject: Re: R-beta: [ajanku@ulrik.uio.no: R-0.61.3 with readline]

>> MM> This was accidentally sent to 
>> MM> R-help-owner instead of R-help  
>> 
>> thanks for forwarding it
>> 
>> MM> [why on earth ??]
>> 
>> People desperate for command line editing will do about everything to get
>> help after a local guru cannot decipher bysantine intricacies of the
>> makefiles in the current distribution. They will write to the White House,
>> contact scientology, whatever, they may even  come across an old e-mail
>> message and when they see R ... here they go.
>> 
##>> More seriously, this feature of R is so basic that it must be better
##>> documented. Current functionality of R deserves attraction from a broader
##>> range of users than those who can figure out how to modify a particular
##>> piece of one of the many makefiles.
>> 
>> I hope you will find my comment useful.
>> 
>> A. Jan Kutylowski




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 09:42:22 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 10:42:22 +0200 (MDT)
Subject: readline installation [Re: R-beta: ....]]
In-Reply-To: <199805130707.JAA10115@sophie.ethz.ch>
References: <199805130707.JAA10115@sophie.ethz.ch>
Message-ID: <199805130842.KAA20200@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > 
 > Further, for R 0.62, I think we should try quite a bit harder to
 > have configure searching around for the readline library and include files.
 > [[maybe, yet again look more closely at what octave does?]]

Another request being very important for me is to have configure
search for regexpression libraries if there are no POSIX regular
expressions on the local system. Some funktions don't work without
this and it is very hard to configure this manually!

Thamks,
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 09:43:47 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 10:43:47 +0200 (MDT)
Subject: readline installation [Re: R-beta: ....]]
In-Reply-To: <199805130707.JAA10115@sophie.ethz.ch>
References: <199805130707.JAA10115@sophie.ethz.ch>
Message-ID: <199805130843.KAA20203@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > 
 > Further, for R 0.62, I think we should try quite a bit harder to
 > have configure searching around for the readline library and include files.
 > [[maybe, yet again look more closely at what octave does?]]

Another request being very important for me is to have configure
search for regexpression libraries (such as the GNU rx library) if
there are no POSIX regular expressions on the local system. Some
funktions don't work without this and it is very hard to configure
this manually!

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 14:02:26 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 15:02:26 +0200 (MDT)
Subject: R-beta: package ported from S to R
In-Reply-To: <199805131050.MAA10416@sophie.ethz.ch>
References: <199805131030.MAA20912@wrin27.urz.uni-wuppertal.de>
 <199805131050.MAA10416@sophie.ethz.ch>
Message-ID: <199805131302.PAA21564@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > >>>>> "Hubert" == Hubert Palme <palme@uni-wuppertal.de> writes:
 > 
 >     Hubert> Hello, I'm trying to port the S package "print.display" to
 >     Hubert> R. The porting procedure seemed to work, but when I say
 >     Hubert> library(print.display) or library("print.display"), then none
 >     Hubert> of the functions is available. May be, it's because of the dot
 >     Hubert> in the package name?
 > 
 > Not really; I do have package with a "." which works..
 > 
 >     Hubert> What could have happened?
 > no idea.
 > You should send a real "log" of what you did (and the output)
 > -- but NOT to R-help, but rather to R-devel.

OK, This one I send to both, the next one only to r-devel.

 > 
 >     Hubert> The help information is available.
 > 
 >     Hubert> BTW: How can I look up wether the package is really loaded?
 > 
 > search()
 > 
 > should show you (in your case)
 > 
 > [1] ".GlobalEnv"   "package:print.display"  "Autoloads"    "package:base"
 > 		    ---------------------
 > and 
 > 	ls(pos=2)
 > 
 > would show your objects

It is strange: I jist restarted R to try out search(), but now
print.display loads! Don't know what happened... But the next step I
wanted to try was to install the package without dot. So I won't --
Thanks for this hint.

Friedrich Leisch: 
 > 
 > How and where did you install the package? Using the R INSTALL
 > mechanism or by hand? Is it in the library search path .lib.loc?

Yes and yes.

OK, hopefully it stayes loading correctly now, so I'll try to debug
it. There is an unknown function "unix". Is "system" the R
replacement? If yes: There is no "input" parameter. How can I redirect
input with "system"?

Is there also a replacement for "!" ?

Thanks a lot!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 13 17:07:00 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 May 1998 09:07:00 -0700 (PDT)
Subject: R-beta: package ported from S to R
In-Reply-To: <199805131302.PAA21564@wrin27.urz.uni-wuppertal.de>
Message-ID: <Pine.SUN.3.95.980513090201.7060A-100000@chekov>

On Wed, 13 May 1998, Hubert Palme wrote:
> 
> OK, hopefully it stayes loading correctly now, so I'll try to debug
> it. There is an unknown function "unix". Is "system" the R
> replacement? If yes: There is no "input" parameter. How can I redirect
> input with "system"?
> 
> Is there also a replacement for "!" ?
> 

The function system() replaces both of them.  There is no input=
parameter, it looks like we typically use paste() -- for example see
system.file() or help.start().

You can replace unix.shell() with system("/bin/sh") or other shell of your
choice.


Thomas Lumley
------------------------
Biostatistics		
Uni of Washington	
Box 357232		
Seattle WA 98195-7232	
------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 13 19:38:47 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 May 1998 14:38:47 -0400
Subject: all.equal
Message-ID: <98May13.144046edt.13459@mailgate.bank-banque-canada.ca>

I need the function all.equal which is in Splus but not yet in R. Below is a
first cut. Comments would be appreciated.

Paul Gilbert
_______

all.equal <- function(obj1, obj2, ...)
  {if(mode(obj1)      != mode(obj2) )      return("modes differ.")
   if(class(obj1)     != class(obj2))      return("classes differ.")
   if(! all(unlist(attributes(obj1)) == unlist(attributes(obj2))))
                                           return("attributes differ.")
   if(! all(unlist(obj1) == unlist(obj2))) return("values differ.")
   T
  }


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 13 21:01:33 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 May 1998 13:01:33 -0700 (PDT)
Subject: all.equal
In-Reply-To: <98May13.144046edt.13459@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.980513124031.7729A-100000@chekov>

On Wed, 13 May 1998, Paul Gilbert wrote:

> I need the function all.equal which is in Splus but not yet in R. Below is a
> first cut. Comments would be appreciated.
> 

I think it should return T/F rather than text.  You could have the reason
returned as an attribute or printed as a warning().

Some slight fuzziness in equality for real numbers might make this
function more useful (perhaps it should be optional/settable
eg all.equal(a,b,epsilon=100*.Machine()$double.eps) might use

	d<-a-b	
	all(abs(d)<epsilon)
or
	all(abs(d)/(abs(a)+abs(b))<epsilon)

since rounding error can creep in even with highly accurate computations.
For example, the survival4 library Examples suite has things which are
all.equal() in S-PLUS but differ by perhaps 1e-16 or so in R.

The test for equal values currently uses recycling for objects of
different lengths, so 1:5 and rep(1:5,2) are all.equal(). You would
probably want to insert a test on lengths.

Also, the current version crashes if fed objects whose components are not
comparable 
	eg a<-lm(y~x); b<-a; all.equal(a,b) gives
	Error: comparison is possible only for vector types
I don't know if this is right or not.

	-thomas


Thomas Lumley
------------------------
Biostatistics		
Uni of Washington	
Box 357232		
Seattle WA 98195-7232	
------------------------


> 
> all.equal <- function(obj1, obj2, ...)
>   {if(mode(obj1)      != mode(obj2) )      return("modes differ.")
>    if(class(obj1)     != class(obj2))      return("classes differ.")
>    if(! all(unlist(attributes(obj1)) == unlist(attributes(obj2))))
>                                            return("attributes differ.")
>    if(! all(unlist(obj1) == unlist(obj2))) return("values differ.")
>    T
>   }
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 13 22:23:40 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 May 1998 17:23:40 -0400
Subject: all.equal
References: <Pine.SUN.3.95.980513124031.7729A-100000@chekov>
Message-ID: <98May13.172537edt.13443@mailgate.bank-banque-canada.ca>

>I think it should return T/F rather than text.  You could have the reason
>returned as an attribute or printed as a warning().

I'm doing this only for compatability with Splus. In fact, the way I've used it
in my code is

   is.logical(all.equal(...))

which gives the T/F result.

I think the tolerance is a good idea. Thanks for pointing out other problems. I
just fixed one of them. I'll circulate a new version tomorrow.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 14 16:06:11 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 14 May 1998 11:06:11 -0400
Subject: all.equal - cut two, test.equal
Message-ID: <98May14.112616edt.13521@mailgate.bank-banque-canada.ca>

Below is a second cut at all.equal and also a generic function test.equal which
is intended to return a T/F value. The default method uses all.equal, which is
the reason I was looking for all.equal in the first place. Prompted by Thomas
Lumley's observation that a T/F result makes more sense I thought it would be
worthwhile to indicate what I'm really doing.

I have been using test.equal for a few  years in a fairly extensive set of tests
for my time series library. My tests never get to the all.equal part of the
default method, so I have only just noticed the absence of this function. This
approach to testing equality works very well since it allows for a class
specific definition of when things are equal. It was originally suggested to me
by John Chambers, in the context of a question I had about error trapping which,
since I'm on the subject, I will describe shortly in a separate post.

One shortcoming of the following all.equal is that numeric elements of a list
are not compared using tolerance. If anyone has a simple suggestion for
extracting the numeric parts of a list I would like to incorporate it.

Paul Gilbert
_______

test.equal <-function (obj1, obj2, ...)  UseMethod("test.equal")

 test.equal.default <-function (obj1, obj2, ...)
{ if (is.array(obj1))    test.equal.array(obj1, obj2, ...)
   else                         is.logical(all.equal(obj1, obj2, ...))
}

all.equal <- function(obj1, obj2, tolerance=100*Machine()$double.eps)
  {if(mode(obj1)      != mode(obj2) )               return("modes differ.")
   if (length(obj1) != length(obj2) )               return("lengths differ")

   if(is.null(class(obj1)) != is.null(class(obj2))) return("classes differ.")
   else if(!is.null(class(obj1))
           && any(class(obj1) != class(obj2)) )     return("classes differ.")


   if(is.null(attributes(obj1)) != is.null(attributes(obj2)))
                                                    return("attributes differ.")

   else if(!is.null(attributes(obj1))
           && any(unlist(attributes(obj1)) != unlist(attributes(obj2))))
                                                    return("attributes differ.")

   # The mode test above insures that both are numeric if one is. A shortcoming
   # here is that for a list with some numeric components, the components are
   # not compared using the tolerance test.
   if(is.numeric(obj1))
      {if (any(abs(obj1 -obj2) > tolerance))
                               return("value differences exceed tolerance.") }
   else if (! all(unlist(obj1) == unlist(obj2)))     return("values differ.")
   T
  }



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 14 16:21:56 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 14 May 1998 11:21:56 -0400
Subject: error trapping
Message-ID: <98May14.112731edt.13594@mailgate.bank-banque-canada.ca>

One thing I've found missing in S/R is the ability to test error trapping. I
have written a fairly extensive set of tests for my time series library but I
can only test that things work for cases where they are suppose to work. In
several places my code is suppose to recognize error conditions, like invalid
inputs, and make calls to stop() or warn(), but there is no automatic way to
check these in my test suite.

I really would like to be able to write a code testing program which would be
able to specify that I am about to generate a "stop" condition with a given
message, then do it, then continue, accepting that that was the right result.

This is not a high priority, but it is worth keeping on the wish list.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu May 14 16:58:13 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 May 1998 08:58:13 -0700 (PDT)
Subject: error trapping
In-Reply-To: <98May14.112731edt.13594@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980514085355.28600B-100000@gorn>

On Thu, 14 May 1998, Paul Gilbert wrote:

> One thing I've found missing in S/R is the ability to test error trapping. I
> have written a fairly extensive set of tests for my time series library but I
> can only test that things work for cases where they are suppose to work. In
> several places my code is suppose to recognize error conditions, like invalid
> inputs, and make calls to stop() or warn(), but there is no automatic way to
> check these in my test suite.
> 
> I really would like to be able to write a code testing program which would be
> able to specify that I am about to generate a "stop" condition with a given
> message, then do it, then continue, accepting that that was the right result.
> 

I have recently had another need for this.  If you are doing simulations
comparing your (wonderful) new method to someone else's (hopelessly
inferior)  old method and their S-PLUS code crashes about 5% of the time
then it gets very tedious to run several hundred samples
semi-interactively.  Trapping the error would be a lot more convenient
than trying to rewrite someone else's code to fail gracefully.

Of course in your own code you wouldn't dream of doing something like that
;-).

	-thomas




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri May 15 18:32:28 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 15 May 1998 13:32:28 -0400
Subject: couldn't find function "print.tframe"
Message-ID: <98May15.133522edt.13671@mailgate.bank-banque-canada.ca>

I have an object with an attribute "tframe" for which there is a generic method
print.tframe and also a method print.tframe.default defined in a library.
However, when I use attributes(object) I get the message

$tframe
Error: couldn't find function "print.tframe"

It's as if <primitive: attributes> is not looking through the search list?

Any suggestions? (Version 0.61.3)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sat May 16 19:04:33 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 16 May 1998 11:04:33 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <98May15.133522edt.13671@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980516105556.1303A-100000@gorn>

On Fri, 15 May 1998, Paul Gilbert wrote:

> I have an object with an attribute "tframe" for which there is a generic method
> print.tframe and also a method print.tframe.default defined in a library.
> However, when I use attributes(object) I get the message
> 
> $tframe
> Error: couldn't find function "print.tframe"
> 
> It's as if <primitive: attributes> is not looking through the search list?

It's more subtle than this.  If you  do
R> b<-1
R> class(b)<-"foo"
R> print.foo<-function(x) { print("foo\n"); NextMethod()}

Then printing b works perfectly well

R> b
foo
[1] 1
attr(,"class")
[1] "foo"

and the problem arises when you print a list containing b

R> list(b,1)
[[1]]
foo
Error: couldn't find function "print.foo"

The error happens in the NextMethod() call of print.foo(), at line 284 of
objects.c, where do_nextmethod tries to find the function that called it.

	/* set up the arglist */
	s=findFun(CAR(cptr->call), cptr->sysparent);

In the working case, cptr->sysparent is R_GlobalEnv, in the non-working
case it's R_NilValue (ie, NULL)

BTW, the gcc documentation says that if we used gcc -g3 in compiling,
some debuggers would be able to cope with macros like CAR() and TYPEOF().
Does anyone know if gcc is one of them?


Thomas Lumley
------------------------------------------------------+--------
Biostatistics		: "Never attribute to malloc(3) what  :
Uni of Washington	:  can be adequately explained by     :
Box 357232		:  incompetence"                      :
Seattle WA 98195-7232	:				      :
--------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Lumley <thomas@biostat.washington.edu>  Sat May 16 20:39:40 1998
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Sat, 16 May 1998 12:39:40 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <Pine.SOL.3.95.980516105556.1303A-100000@gorn>
Message-ID: <Pine.SOL.3.95.980516114355.1303B-100000@gorn>


Ok. The print.tframe problem appears to be as follows:

When printList has a list element that is an object it creates a call to
print() with the evaluated object and evaluates that call in the
environment R_NilValue (ie NULL).

If this object has class "foo" print.foo() is called. If there is a 
NextMethod() in print.foo, do_nextmethod  reaches back to find
the environment that print() was called from and looks for the
definition of print.foo() that applies there, in order to get the formal
arguments right.  This fails, since print() was 'called' from the NULL
environment, where print.foo() is not defined.

You can reproduce this in interpreted code by
R> b<-1              
R> class(b)<-"foo" 
R> print.foo<-function(x){cat("foo\n");NextMethod()}
R> eval(expression(print(structure(1,class="foo"))),NULL)

The question is how to find the right environment to evaluate the call,
since printList doesn't know what environment print() was called from. 
R_GlobalEnv doesn't seem right, since print.foo may not be defined there. 

One solution would be to explicitly pass the environment down, but this
takes a lot of changes, some of them to functions called from outside
print.c.  I'm looking at this but would welcome a better solution.


Thomas Lumley
------------------------------------------------------+--------
Biostatistics		: "Never attribute to malloc(3) what  :
Uni of Washington	:  can be adequately explained by     :
Box 357232		:  incompetence"                      :
Seattle WA 98195-7232	:				      :
---------------------------------------------------------------




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun May 17 11:08:18 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 May 1998 12:08:18 +0200
Subject: couldn't find function "print.tframe"
In-Reply-To: Thomas Lumley's message of Sat, 16 May 1998 12:39:40 -0700 (PDT)
References: <Pine.SOL.3.95.980516114355.1303B-100000@gorn>
Message-ID: <x2wwblryzx.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> Ok. The print.tframe problem appears to be as follows:
> 
> When printList has a list element that is an object it creates a call to
> print() with the evaluated object and evaluates that call in the
> environment R_NilValue (ie NULL).
> 
> If this object has class "foo" print.foo() is called. If there is a 
> NextMethod() in print.foo, do_nextmethod  reaches back to find
> the environment that print() was called from and looks for the
> definition of print.foo() that applies there, in order to get the formal
> arguments right.  This fails, since print() was 'called' from the NULL
> environment, where print.foo() is not defined.
> 
> You can reproduce this in interpreted code by
> R> b<-1              
> R> class(b)<-"foo" 
> R> print.foo<-function(x){cat("foo\n");NextMethod()}
> R> eval(expression(print(structure(1,class="foo"))),NULL)

Hmmmm....

Here's another aspect of the problem:

I tried creating a new print function with a call to sys.status
inserted befor the UseMethod, after previously doing a debug(print),
and:

>  eval(expression(print(structure(1,class="foo"))),NULL)
debugging in: print(structure(1, class = "foo"))
foo
Error: couldn't find function "print.foo"

So it is still calling the old print (in package:base). The new one
would have debugging turned off for one thing. (BTW: Why doesn't the
debugger stop and wait for input before doing the UseMethod call?)

In contrast,
> b
$sys.calls
$sys.calls[[1]]
print(structure(1, class = "foo"))

<...etc...>
foo
[1] 1
attr(,"class")
[1] "foo"


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sun May 17 21:26:25 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sun, 17 May 1998 13:26:25 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <x2wwblryzx.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SOL.3.95.980517132310.4388A-100000@gorn>

On 17 May 1998, Peter Dalgaard BSA wrote:

> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > 
> > 
> > Ok. The print.tframe problem appears to be as follows:
> > 
> > When printList has a list element that is an object it creates a call to
> > print() with the evaluated object and evaluates that call in the
> > environment R_NilValue (ie NULL).
> > 
> > If this object has class "foo" print.foo() is called. If there is a 
> > NextMethod() in print.foo, do_nextmethod  reaches back to find
> > the environment that print() was called from and looks for the
> > definition of print.foo() that applies there, in order to get the formal
> > arguments right.  This fails, since print() was 'called' from the NULL
> > environment, where print.foo() is not defined.
> > 
> > You can reproduce this in interpreted code by
> > R> b<-1              
> > R> class(b)<-"foo" 
> > R> print.foo<-function(x){cat("foo\n");NextMethod()}
> > R> eval(expression(print(structure(1,class="foo"))),NULL)
> 
> Hmmmm....
> 
> Here's another aspect of the problem:
> 
> I tried creating a new print function with a call to sys.status
> inserted befor the UseMethod, after previously doing a debug(print),
> and:
> 
> >  eval(expression(print(structure(1,class="foo"))),NULL)
> debugging in: print(structure(1, class = "foo"))
> foo
> Error: couldn't find function "print.foo"
> 
> So it is still calling the old print (in package:base). The new one
> would have debugging turned off for one thing. (BTW: Why doesn't the
> debugger stop and wait for input before doing the UseMethod call?)

This is for the same reason.  In environment NULL you still have access to
the system environment but not to the global environment.  Look at
	eval(expression(print),NULL)
to see that it is indeed using the old version.  Fixing the environment
would fix this too.

I think the debugger doesn't stop and wait because it has problems with
functions that don't have braces {} enclosing them.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May 18 00:27:31 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 May 1998 01:27:31 +0200
Subject: couldn't find function "print.tframe"
In-Reply-To: Thomas Lumley's message of Sun, 17 May 1998 13:26:25 -0700 (PDT)
References: <Pine.SOL.3.95.980517132310.4388A-100000@gorn>
Message-ID: <x2af8geavw.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> I think the debugger doesn't stop and wait because it has problems with
> functions that don't have braces {} enclosing them.

Oh. And here I was, thinking that it was due to some aspect of the
implementation of method dispatching...

You're absolutely right:
> f<-function(x)x
> debug(f)
> f(3)
debugging in: f(3)
exiting from: f(3)
[1] 3

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rgentlem@stat.auckland.ac.nz  Mon May 18 01:11:17 1998
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Mon, 18 May 1998 12:11:17 +1200 (NZST)
Subject: No subject
Message-ID: <199805180011.MAA22223@stat1.stat.auckland.ac.nz>


> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > I think the debugger doesn't stop and wait because it has problems with
> > functions that don't have braces {} enclosing them.
> 
> Oh. And here I was, thinking that it was due to some aspect of the
> implementation of method dispatching...
> 
> You're absolutely right:
> > f<-function(x)x
> > debug(f)
> > f(3)
> debugging in: f(3)
> exiting from: f(3)
> [1] 3
> 

  Yep, if you have a look we check the debug flag in do_begin (if an opening
  {), short functions don't have these. My recollection is that Splus puts
  one on every function but we decided not to. The debug flag is in
  the header of the actual function SEXP (look in src/include/Defn.h).
  
  Most of the behaviour of debug is in eval.c (do_while, do_for, and friends).
  
  
  robert
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon May 18 14:45:27 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 18 May 1998 15:45:27 +0200
Subject: R 0.62 ("snapshot") -- Now Search Engine in help.start()
Message-ID: <199805181345.PAA17553@sophie.ethz.ch>

You can look at it at
	http://www.stat.math.ethz.ch/R-alpha/

and clicking on  [R manual].
Besides  "Packages" and "Functions", there's know a
	"Search Engine & Keywords"
provided by Fritz Leisch (Wien).
["Keywords" are unfinished, but searching *is* useful.]

Thank you, Fritz!
-- Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon May 18 14:54:26 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 18 May 1998 15:54:26 +0200 (CEST)
Subject: R make process
Message-ID: <13664.15762.998396.781063@galadriel.ci.tuwien.ac.at>


Hi,

I've just committed a few changes to the R make process, such that we
support the standard

	./configure
	make
	make install

triple from now on. It should be included in tomorrows snapshot
sources. The default installation directory hierarchy should be
/usr/local on most systems, but this may vary.

The installation prefix can be set using

	./configure --prefix=3D...

and you can see the install dir in the status notes of configure.

R is installed into:

	$prefix/lib/R		RHOME
	$prefix/man/man1	R.1
	$prefix/bin		R Rd2txt Rdconv Rdindex Sd2Rd

Please let me know if there are any troubles on your system, currently
it is tested on Debian Linux only.

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Mon May 18 14:56:48 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Mon, 18 May 1998 15:56:48 +0200 (MDT)
Subject: get() in R and S
Message-ID: <199805181356.PAA13042@wrin27.urz.uni-wuppertal.de>

Hi there,

is there any complete list of differences between R and S? I only saw
one in the FAQ and it seems to be incomplete.

I specially want to know what the frame parameter in the S version of
get() means and and how I can replace it in R.

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Mon May 18 15:36:15 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Mon, 18 May 1998 16:36:15 +0200 (MDT)
Subject: Another compatibility problem S => R
Message-ID: <199805181436.QAA13326@wrin27.urz.uni-wuppertal.de>

Hello,

after the line 

  cat("%",as.character(as.name(match.call())), "\n%\n", file=fi, append=T)

R complains about

  Error in as.name(x) : character argument required

Is it sufficient to delete as.name()?

After doing that, R complains

  Error: comparison is possible only for vector types

Don't know which function call. Can you give me a hint how to debug
it? There seems to be a lot of patameter type incompatibilities :-(

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May 18 15:52:04 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 May 1998 16:52:04 +0200
Subject: Another compatibility problem S => R
In-Reply-To: palme@uni-wuppertal.de's message of Mon, 18 May 1998 16:36:15 +0200 (MDT)
References: <199805181436.QAA13326@wrin27.urz.uni-wuppertal.de>
Message-ID: <x2emxrbpij.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

> 
> Hello,
> 
> after the line 
> 
>   cat("%",as.character(as.name(match.call())), "\n%\n", file=fi, append=T)
> 
> R complains about
> 
>   Error in as.name(x) : character argument required

Hmm. The Splus help page says:

       as.name coerces x to an object of mode  "name".   This  is
       useful when x is of mode "character".

The whole construction seems to be doing the same as
deparse(match.call()), which works in *both* languages.

I don't think we want to become compatible in this case.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May 20 09:08:28 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 May 1998 10:08:28 +0200
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: <9805200750.AA17895@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 20 May 1998 09:50:45 +0200 (MET DST))
Message-ID: <199805200808.KAA22220@sophie.ethz.ch>

Jim,
you should ask questions like these on R-devel.
There are more proficient Linux gurus on there than me [that's why I CC:].

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> Martin, Here is an additional problem with my libraries: the
    Jim> Kalman filtering, written in Fortran, uses complex arithmetic.

    Jim> On my Red Hat 5, the f2c library is included by the -lf2c in the
    Jim> Makefile.
makes sense.

    Jim> However, my son has just installed a new version of
    Jim> Slackware and we can find no way to convince gcc to include the
All I ever hear about Slackware is that you should not use it anymore...
[I used to have a 0.99x version of Linux.. and *did* have Slackware then..]

    Jim> f2c library. (With the previous version of Slackware that he had,
    Jim> it could be tricked by placing -L/usr/lib right before -lf2c,
    Jim> something I never understood.)

-L/usr/lib  says to that -lf2c should also search for libf2c.a or .so
 in /usr/lib.
However that is standard (in Linux), so I don't understand either.

The above problem sounds like your installation is broken to some extent...

    Jim> Of course, R crashes when we run my
    Jim> programs because it does not find the complex functions.

    Jim> I remember that there was some discussion of such problems on the
    Jim> list quite a while ago. Is any solution in sight?

The new 0.62 branch of R  *REQUIRES* either a fortran compiler or f2c.
So, your problems might have resolved by then.
However, given what you tell above,  I assume that your Slackware-Linux
system has some misconfigurations that should be resolved anyway...

Martin


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 15:10:48 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 10:10:48 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <199805200808.KAA22220@sophie.ethz.ch>
Message-ID: <98May20.101620edt.13443@mailgate.bank-banque-canada.ca>

Jim

I don't think your libf2c problems are related to your installation, Slackware,
or even to Linux. I have the same trouble in RedHat and in Solaris. I think the
problem is whether it is the responsibility of a dynamically loaded .so to
knowing where libraries are, or if R.binary should know that. In my rather crude
and uninformed experimentation I could not discover a way to make my .so know
and pass along that information, so I have concluded that it must be R.binary's
responsibility.

I posted a question on this some time ago, to which Ross acknowledged there is a
problem and suggested I contact Kurt. In the end I didn't do that because I
discovered that some rather trivial changes to my fortran resulted in calls to
pow_di rather than pow_ii and this fixed my problem.

I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
that, since, as far as I know, you and I are the only ones who have been having
this difficulty. I suspect it will become more of an issue as more fortran is
ported.

Below is a copy of the exchange from my previous posting.

Paul Gilbert
________
> Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
>
> > I have a problem with my dynamically loaded code in R not finding
> > pow_ii, which for some time I thought was because library f2c is
> > not on my Sparcstation.  > > However, I have now been experiencing
> > the same problem in Linux, with all the  proper libraries in place.
> >
> > My incomplete understanding of elf and shared libraries does not
> > help, but when compiling a complete program I usually muddle through.
> > However, in the case of dynamically loading code into R, I am not
> > sure whether it is my dse.so or R which should have the knowledge
> > of where to find /usr/lib/libf2c.so*. I haven't  had much success
> > trying to configure so that that information is in dse.so. None
> > of the usual things seem to help, so I suspect R itself needs to
> > be able to find the library. If someone can explain this I would
> > very much appreciate it.

DB> One thing you can do is to check the R.binary file with "nm -g" to find
DB> out what symbols are defined in it.  On my machine R.binary includes
DB> pow_dd and pow_di but not pow_ii.

This is a general problem we need a solution to.  Recently, Kurt Hornik
has changed the configuration procedures so that fortran is located and
used to load R.  I thought this would fix this kind of problem.
(Any references to fortran things like pow_ii should be removed from the
C sources).

I'd suggest that you get in touch with Kurt directly:
        Kurt.Hornik@ci.tuwien.ac.at
to sort this out.

        Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 20 17:59:06 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 May 1998 09:59:06 -0700 (PDT)
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: <98May20.101620edt.13443@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980520095251.22293B-100000@gorn>

On Wed, 20 May 1998, Paul Gilbert wrote:


> I don't think your libf2c problems are related to your installation, Slackware,
> or even to Linux. I have the same trouble in RedHat and in Solaris. I think the
> problem is whether it is the responsibility of a dynamically loaded .so to
> knowing where libraries are, or if R.binary should know that. In my rather crude
> and uninformed experimentation I could not discover a way to make my .so know
> and pass along that information, so I have concluded that it must be R.binary's
> responsibility.
> 
<snip>
> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
> that, since, as far as I know, you and I are the only ones who have been having
> this difficulty. I suspect it will become more of an issue as more fortran is
> ported.
> 

If this is the problem it should be fixed in 0.62, since R.binary will
have to know how to find the local fortran compiler and libraries to run
itself. You can then distribute the fortran code and it will be compiled
and linked the same way as the built-in fortran. 

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May 20 19:00:56 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 20 May 1998 20:00:56 +0200
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: Martin Maechler's message of Wed, 20 May 1998 10:08:28 +0200
References: <199805200808.KAA22220@sophie.ethz.ch>
Message-ID: <x2iun0es9z.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>     Jim> On my Red Hat 5, the f2c library is included by the -lf2c in the
>     Jim> Makefile.
> makes sense.
> 
>     Jim> However, my son has just installed a new version of
>     Jim> Slackware and we can find no way to convince gcc to include the
> All I ever hear about Slackware is that you should not use it anymore...
> [I used to have a 0.99x version of Linux.. and *did* have Slackware then..]
> 
>     Jim> f2c library. (With the previous version of Slackware that he had,
>     Jim> it could be tricked by placing -L/usr/lib right before -lf2c,
>     Jim> something I never understood.)
> 
> -L/usr/lib  says to that -lf2c should also search for libf2c.a or .so
>  in /usr/lib.
> However that is standard (in Linux), so I don't understand either.

I've seen some similar cases in the distant past, apparently related
to argument order of the link command arguments. If all else fails,
one can always specify /usr/lib/libf2c.so directly. Provided that the
file is actually there, of course...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 19:17:15 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 14:17:15 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <Pine.SOL.3.95.980520095251.22293B-100000@gorn>
Message-ID: <98May20.142257edt.13457@mailgate.bank-banque-canada.ca>

<snip>
>> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of

>> that, since, as far as I know, you and I are the only ones who have been
having
>> this difficulty. I suspect it will become more of an issue as more fortran is

>> ported.

>If this is the problem it should be fixed in 0.62, since R.binary will
>have to know how to find the local fortran compiler and libraries to run
>itself. You can then distribute the fortran code and it will be compiled
>and linked the same way as the built-in fortran.

This assumes that everyone who wants to run the code has a fortran compiler, not
just f2c. This is not really a very good assumption, especially since the
current version of g77 seems to have a bug and won't compile my code. In
general, fortran compilers are much less widely available than C compilers. I
think that distributing the code as generated by f2c will help a lot of people,
but this sometimes means using libf2c. (I've even found that using gcc on the
f2c code works better in Splus than trying to use a fortran compiler.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 19:24:17 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 14:24:17 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <199805200808.KAA22220@sophie.ethz.ch> <x2iun0es9z.fsf@blueberry.kubism.ku.dk>
Message-ID: <98May20.143013edt.13459@mailgate.bank-banque-canada.ca>

>If all else fails,
>one can always specify /usr/lib/libf2c.so directly. Provided that the
>file is actually there, of course...

In fact, one cannot. At least I couldn't get it to work, and I tried many
variations on this. The problem seems to be that this provides the information
for the purposes of generating the .so file, but it gets lost somewhere when you
try to dyn.load the .so into R.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Wed May 20 19:41:46 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 20 May 1998 13:41:46 -0500
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: Paul Gilbert's message of Wed, 20 May 1998 14:17:15 -0400
References: <Pine.SOL.3.95.980520095251.22293B-100000@gorn> <98May20.142257edt.13457@mailgate.bank-banque-canada.ca>
Message-ID: <6rbtsszswl.fsf@verdi.stat.wisc.edu>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> <snip>
> >> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
> 
> >> that, since, as far as I know, you and I are the only ones who have been
> having
> >> this difficulty. I suspect it will become more of an issue as more fortran is
> 
> >> ported.
> 
> >If this is the problem it should be fixed in 0.62, since R.binary will
> >have to know how to find the local fortran compiler and libraries to run
> >itself. You can then distribute the fortran code and it will be compiled
> >and linked the same way as the built-in fortran.
> 
> This assumes that everyone who wants to run the code has a fortran compiler, not
> just f2c. This is not really a very good assumption, especially since the
> current version of g77 seems to have a bug and won't compile my code. In
> general, fortran compilers are much less widely available than C compilers. I
> think that distributing the code as generated by f2c will help a lot of people,
> but this sometimes means using libf2c. (I've even found that using gcc on the
> f2c code works better in Splus than trying to use a fortran compiler.)

But "fortran compiler" can mean something like a script that calls f2c
then calls gcc on the result.  We have one called "fort77" in the
Debian Linux distribution.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 21 16:06:55 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 21 May 1998 11:06:55 -0400
Subject: all.equal - cut three
Message-ID: <98May21.111256edt.13457@mailgate.bank-banque-canada.ca>

Below is a third cut at all.equal and the generic function test.equal which
is intended to return a T/F value. There was a suggestion that "is.equal" rather
than "test.equal" might be considered as a name. I have mixed feelings about
this. I associate the  "is" functions with inheritance rather than comparisons,
but the "equal" part of the name makes it clear. How do others feel about this?

The default method for all.equal now tries to recursively extract all numeric
elements and compare using tolerance. It also tries to do a relative comparison
rather than an absolute comparison, except for very small numbers. I hope
someone with more experience than I have will examine this part carefully!

Paul Gilbert
_______

test.equal <-function (obj1, obj2, ...)  UseMethod("test.equal")

 test.equal.default <-function (obj1, obj2, ...)
{ if (is.array(obj1))    test.equal.array(obj1, obj2, ...)
   else                         is.logical(all.equal(obj1, obj2, ...))
}


all.equal <- function(obj1, obj2,...) {UseMethod("all.equal")}

all.equal.default <- function(obj1, obj2, tolerance=.Machine$double.eps)
  {if(mode(obj1)      != mode(obj2) )               return("modes differ.")
   if (length(obj1) != length(obj2) )               return("lengths differ")

   if(is.null(class(obj1)) != is.null(class(obj2))) return("classes differ.")
   else if(!is.null(class(obj1))
           && any(class(obj1) != class(obj2)) )     return("classes differ.")


   if(is.null(attributes(obj1)) != is.null(attributes(obj2)))
                                                    return("attributes differ.")

   else if(!is.null(attributes(obj1))
           && any(unlist(attributes(obj1)) != unlist(attributes(obj2))))
                                                    return("attributes differ.")

   cull.numeric  <- function(obj, r=NULL) {
      if (is.null(obj) | (length(obj) == 0)) return(r)
      else if (is.numeric(obj)) return(c(r,obj))
      else if (is.list(obj))
           return( c(cull.numeric(obj[[1]], r), cull.numeric(obj[-1])) )
      else return(r)
     }

   z1 <- cull.numeric(obj1)
   if(! is.null(z1))
      {z2 <- cull.numeric(obj2)
       if (length(z1) != length(z2) )  return("length of numeric parts differ")
       M <- pmax(abs(z1), abs(z2))
       # next line results in absolute rather than relative comparison for
       # very small numbers.
       M[ M < 100 *tolerance] <- 1
       if (any(abs(z1 -z2) > tolerance * M))
                       return("numeric value differences exceed tolerance.")
      }
  # next comparison is really for non-numeric values but also compares
  # numeric values to the tolerance of the character representation in unlist.
   if (! all(unlist(obj1) == unlist(obj2)))     return("values differ.")
   T
  }





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri May 22 21:48:52 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 May 1998 13:48:52 -0700 (PDT)
Subject: matrix multiplication of vectors
In-Reply-To: <98May21.111256edt.13457@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980522134730.9121B-100000@gorn>


An incompatibility:
S-PLUS
> x<-1:3
>  x%*%x
     [,1] 
[1,]   14
>  x%*%t(x)
     [,1] [,2] [,3] 
[1,]    1    2    3
[2,]    2    4    6
[3,]    3    6    9

R
> x<-1:3
> x%*%x
     [,1]
[1,]   14
> x%*%t(x)
Error in x %*% t(x) : non-conformable arguments


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon May 25 23:25:24 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 26 May 1998 10:25:24 +1200 (NZST)
Subject: RFC: spline / splinefun (etc) amalgamation
Message-ID: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>

At present R has separate functions "spline" and "splinefun".  The first
of these carries out spline interpolation of a data set and returns the
interpolated values; the second returns the interpolating function itself
(approx and approxfun are similar).

I would like to combine these into a single function "spline" with
an (optional) argument which determines which kind of value is returned.
E.g.

	spline(x,y)        # return interpolated function
	spline(x,y,fun=T)  # return the interpolating function

I would also like to propose this as a standard for smoothing and
interpolating functions.  This has a couple of advantages - fewer
names to remember and, the ability to use the function form in
model fitting code ("predict" for example).

Any objections or comments?

	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue May 26 00:09:45 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 May 1998 16:09:45 -0700 (PDT)
Subject: dependencies in .so files
In-Reply-To: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.LNX.3.96.980525160616.26582A-100000@buffy>


I've been trying to get Matt Calder's S compiler to work in R using R
COMPILE and R SHLIB so it will be fairly platform-independent.  

I'm sure someone has claimed in the past that it is possible/easy to
dyn.load() two dynamic libraries and have one call functions in the other.
I can't get it to work (Red Hat 5.0/R0.61.1ish). It doesn't seem to matter
what order I load them in, they can't find each other.

Any ideas?

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue May 26 06:55:49 1998
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 26 May 1998 07:55:49 +0200 (CEST)
Subject: RFC: spline / splinefun (etc) amalgamation
In-Reply-To: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
References: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
Message-ID: <13674.22885.136914.353526@pc87.maho.magnaeu.com>

>>>>> Ross Ihaka writes:

> At present R has separate functions "spline" and "splinefun".  The first
> of these carries out spline interpolation of a data set and returns the
> interpolated values; the second returns the interpolating function itself
> (approx and approxfun are similar).

> I would like to combine these into a single function "spline" with
> an (optional) argument which determines which kind of value is returned.
> E.g.

> 	spline(x,y)        # return interpolated function
> 	spline(x,y,fun=T)  # return the interpolating function

> I would also like to propose this as a standard for smoothing and
> interpolating functions.  This has a couple of advantages - fewer
> names to remember and, the ability to use the function form in
> model fitting code ("predict" for example).

> Any objections or comments?

Perhaps
	smoothing.or.interpolating.fun(data)
should in general return the FUNCTION (more precisely, a function
object of an appropriate class), and the values would be obtained
via predict()?

-k

(May not be BBC, though ...)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May 26 07:58:52 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 26 May 1998 08:58:52 +0200
Subject: RFC: spline / splinefun (etc) amalgamation
In-Reply-To: <13674.22885.136914.353526@pc87.maho.magnaeu.com> (message from
 Kurt Hornik on Tue, 26 May 1998 07:55:49 +0200 (CEST))
Message-ID: <199805260658.IAA02570@sophie.ethz.ch>

>>>>> "KH" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Ross Ihaka writes:
    >> At present R has separate functions "spline" and "splinefun".  The
    >> first of these carries out spline interpolation of a data set and
    >> returns the interpolated values; the second returns the
    >> interpolating function itself (approx and approxfun are similar).

    >> I would like to combine these into a single function "spline" with
    >> an (optional) argument which determines which kind of value is
    >> returned.  E.g.

    >> spline(x,y) # return interpolated function spline(x,y,fun=T) #
    >> return the interpolating function

    >> I would also like to propose this as a standard for smoothing and
    >> interpolating functions.  This has a couple of advantages - fewer
    >> names to remember and, the ability to use the function form in model
    >> fitting code ("predict" for example).

    >> Any objections or comments?

Very good idea [including the "standard"!]

    KH> Perhaps smoothing.or.interpolating.fun(data) should in general
    KH> return the FUNCTION (more precisely, a function object of an
    KH> appropriate class), and the values would be obtained via predict()?

I do prefer Ross' version:

1. For a novice or average user, it is more intuitive to get a list /
   data.frame as a result by default.

2. compatibility
    KH> (May not be BBC, though ...)
   yes

3. The ($x, $y) list is simpler AND smaller (in memory).

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 13:29:05 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 13:29:05 +0100 (GMT+0100)
Subject: A problem of etiquette
Message-ID: <19980527122905.99.qmail@sirio.stat.unipd.it>

Perhaps, the question is silly. But, I prefer asking it before making a 
mistake.

I have just packed a binary distribution of R for Windows3.1/Win32s.
It is equivalent to the previous one for Win95/NT (R-0.61.3 +
many of the available packages) and it is compiled with egcs-mingw32
(GPL not a commercial compiler).

Now, in preparing the README, I put the following sentence:
-----------------------------------------------------------------------------
This distribution is not formally maintained, but I am interested 
in hearing (on r-devel and r-help) from people who have problems with it, 
although I may not be able to solve them.
-----------------------------------------------------------------------------

The etiquette question is: can I ask people to use r-devel/r-help
although I am not managing these lists?

guido m.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May 27 13:10:56 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 May 1998 14:10:56 +0200
Subject: A problem of etiquette
In-Reply-To: guido@sirio.stat.unipd.it's message of Wed, 27 May 1998 13:29:05 +0100 (GMT+0100)
References: <19980527122905.99.qmail@sirio.stat.unipd.it>
Message-ID: <x2pvgzzzfz.fsf@blueberry.kubism.ku.dk>

guido@sirio.stat.unipd.it writes:

> The etiquette question is: can I ask people to use r-devel/r-help
> although I am not managing these lists?
> 
> guido m.

Yes, of course. These fora are for anyone interested in helping with
development of R, respectively asking and answering questions about
its use. This means not just the core R but also add-on packages and -
as in your case - ports to other systems. If the lists overflow, we
can always set up a special list for R-Win, but I don't think that
will be necessary.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed May 27 13:12:14 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 27 May 1998 14:12:14 +0200 (CEST)
Subject: A problem of etiquette
In-Reply-To: <19980527122905.99.qmail@sirio.stat.unipd.it>
References: <19980527122905.99.qmail@sirio.stat.unipd.it>
Message-ID: <13676.798.218392.320599@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 27 May 1998 13:29:05 +0100 (GMT+0100),
>>>>> guido  (g) wrote:

g> Perhaps, the question is silly. But, I prefer asking it before making =
a=20
g> mistake.

g> I have just packed a binary distribution of R for Windows3.1/Win32s.
g> It is equivalent to the previous one for Win95/NT (R-0.61.3 +
g> many of the available packages) and it is compiled with egcs-mingw32
g> (GPL not a commercial compiler).

g> Now, in preparing the README, I put the following sentence:
g> ----------------------------------------------------------------------=
-------
g> This distribution is not formally maintained, but I am interested=20
g> in hearing (on r-devel and r-help) from people who have problems with =
it,=20
g> although I may not be able to solve them.
g> ----------------------------------------------------------------------=
-------

g> The etiquette question is: can I ask people to use r-devel/r-help
g> although I am not managing these lists?

I think you're being too modest ... you put a lot of effort in
preparing the binary distribution of R!

The lists are about discussing all aspects of R, including ports, etc.

Its perfectly fine to put the above statement into the README.

Best,

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@luc.ac.be  Wed May 27 15:40:32 1998
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Wed, 27 May 1998 16:40:32 +0200 (MET DST)
Subject: Problems compiling libraries with todays snapshot.
Message-ID: <9805271440.AA01439@alpha.luc.ac.be>

I am currently running Slakware V3.4 with g77 and R is a 0.62 snapshot of the 27th of May.
There appear to be linking problems with the libraries.
The error output from mva and eda can be found below.
My own libraries also have similar problems.

Errors when compiling mva:

116 /usr/local/src/R/src/library #R INSTALL mva
Warning:  package `-html' does not exist
Warning:  package `-latex' does not exist
Installing package `mva' ...
libs
ld  -o mva.so dblcen.o dist.o hclust.o
ld: warning: cannot find entry symbol _start; defaulting to 08048080
dist.o: In function `euclidean':
/usr/local/src/R/src/library/mva/src/dist.c:43: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:43: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:51: undefined reference to `realNA'
/usr/local/src/R/src/library/mva/src/dist.c:53: undefined reference to `sqrt'
dist.o: In function `maximum':
/usr/local/src/R/src/library/mva/src/dist.c:64: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:64: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:74: undefined reference to `realNA'
dist.o: In function `manhattan':
/usr/local/src/R/src/library/mva/src/dist.c:85: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:85: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:92: undefined reference to `realNA'
dist.o: In function `canberra':
/usr/local/src/R/src/library/mva/src/dist.c:105: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:105: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:112: undefined reference to `realNA'
dist.o: In function `binary':
/usr/local/src/R/src/library/mva/src/dist.c:127: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:127: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:140: undefined reference to `realNA'
dist.o: In function `dist':
/usr/local/src/R/src/library/mva/src/dist.c:169: undefined reference to `error'
make: *** [mva.so] Error 1
cp: *.so: No such file or directory

Compiling eda:

117 /usr/local/src/R/src/library #R INSTALL eda
Installing package `eda' ...
libs
ld  -o eda.so line.o smooth.o
ld: warning: cannot find entry symbol _start; defaulting to 08048080
line.o: In function `il':
/usr/local/src/R/src/library/eda/src/line.c:5: undefined reference to `floor'
line.o: In function `iu':
/usr/local/src/R/src/library/eda/src/line.c:10: undefined reference to `ceil'
line.o: In function `line':
/usr/local/src/R/src/library/eda/src/line.c:23: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:48: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:54: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:61: undefined reference to `rsort'
make: *** [eda.so] Error 1
cp: *.so: No such file or directory
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From wsimpson@uwinnipeg.ca  Wed May 27 16:10:48 1998
From: wsimpson@uwinnipeg.ca (Bill Simpson)
Date: Wed, 27 May 1998 10:10:48 -0500 (CDT)
Subject: Problems compiling libraries with todays snapshot.
In-Reply-To: <9805271440.AA01439@alpha.luc.ac.be>
Message-ID: <Pine.OSF.3.95.980527100912.8559A-100000@io.uwinnipeg.ca>

I am running 62.0 April 12 1998 under Slackware 3.4.0, and it compiled
painlessly (if that is any help at all). BTW with Slackware you've got to
make sure you've got readline library installed.  It isn't there in the
default distribution.

Bill

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 19:50:17 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 19:50:17 +0100 (GMT+0100)
Subject: dependencies in .so files
Message-ID: <19980527185017.2030.qmail@sirio.stat.unipd.it>

 Thomas Lumley writes:
 > 
 > 
 > I've been trying to get Matt Calder's S compiler to work in R using R
 > COMPILE and R SHLIB so it will be fairly platform-independent.  
 > 
 > I'm sure someone has claimed in the past that it is possible/easy to
 > dyn.load() two dynamic libraries and have one call functions in the other.
 > I can't get it to work (Red Hat 5.0/R0.61.1ish). It doesn't seem to matter
 > what order I load them in, they can't find each other.
 > 
 > Any ideas?
 
 >From the dlopen man page:
 void *dlopen (const char *filename, int flag);
 ................................................
 RTLD_GLOBAL may be or'ed with flag
 in which case the external symbols defined in the library will be
 made available to subsequently loaded libraries.
 
 So, I try: 
 1) I modify src/unix/dynload.c changing the flag of dlopen
    from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
 2) build two simple shared libraries the second calling a routine 
    in the first.
 ---------------------------a.c-------------------------------
 #include <stdio.h>
 
 void a(int *i) {
    printf("now in a.so; incrementing i\n");
    *i=*i+1;
 }
 
 --------------------------b.c--------------------------------
 #include <stdio.h>
 
 extern void a(int *i);
 
 void b(int *i) {
    printf("in b.so; calling function a in a.so; i=%d\n",*i);
    a(i);
    printf("in b.so; now i=%d\n",*i);
 }
 
 -------------------------Makefile------------------------------
 all: a.so b.so
 
 a.o: a.c
 	gcc -fPIC -c a.c
 	
 a.so: a.o
 	gcc -shared -o a.so a.o
 	
 b.o: b.c
 	gcc -fPIC -c b.c
 	
 b.so: b.o
 	gcc -shared -o b.so b.o	
 	
 -------------------------------------------------------------------------
 
 Things seems ok.
 
 -------------------------------------------------------------------------
 sirio[~/tmp/prova]% R
 
 R : Copyright 1998, Robert Gentleman and Ross Ihaka
 Version 0.61.3  (May 3, 1998)
 
 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type    "license()" for details.
 
 Type    "demo()" for some demos, "help()" for on-line help, or
         "help.start()" for a HTML browser interface to help.
 
 
 > dyn.load("a.so")
 > dyn.load("b.so")
 > y <- .C("b",as.integer(0))
 in b.so; calling function a in a.so; i=0
 now in a.so; incrementing i
 in b.so; now i=1
 > y
 [[1]]
 [1] 1           
 ----------------------------------------------------------------------------
 
 Before introducing the RTLD_GLOBAL flag:
 ----------------------------------------------------------------------------
 sirio[~/tmp/prova]% R
 
 R : Copyright 1998, Robert Gentleman and Ross Ihaka
 Version 0.61.3  (May 3, 1998)
 
 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type    "license()" for details.
 
 Type    "demo()" for some demos, "help()" for on-line help, or
         "help.start()" for a HTML browser interface to help.
 
 > dyn.load("a.so")
 > dyn.load("b.so")
 > y <- .C("b",as.integer(0))
 in b.so; calling function a in a.so; i=0
 /usr/local/src/R-0.61.3/bin/R.binary: can't resolve symbol 'a'
 sirio[~/tmp/prova]%                                             
 
 ----------------------------------------------------------------------------
 I am using R-0.61.3 under Linux 2.30.
 
 guido masarotto
 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 22:10:18 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 22:10:18 +0100 (GMT+0100)
Subject: dependencies in .so files
Message-ID: <19980527211018.2199.qmail@sirio.stat.unipd.it>

 > Luke Tierney writes:
 > 
 > guido@sirio.stat.unipd.it wrote:
 > >  So, I try: 
 > >  1) I modify src/unix/dynload.c changing the flag of dlopen
 > >     from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
 > 
 > I'm not sure this is properly and reliably supported on all UNIX
 > platforms. It doesn't seem to be in the standard Windows and Mac
 > compilers.  That is, MS VC++ and Borland C++ don't seem to let you
 > creade DLL's with undefined symbols. Watcom does seem to allow it, but
 > I'm not certain how reliable it is there.
 If I understand, under Windows , you have to follow your strategy B (recursive 
 shared libraries). 
 
 > 
 > Also you need to consider what happens at runtime if a function is
 > called and finds an unresolved symbol. On some systems a signal might
 > be sent that can be caught (HP-UX sends SIGABRT, but I'm not sure I
 > would want to catch all those), but this will need to be checked out
 > on every different system. Having any problems reported at load time
 > seems like a safer solution -- I have gone the other way and switched
 > to using RTLD_NOW for this reason (and because that seems the least
 > common denominator accross UNIX/Win32/Mac).
 I agree. This point is however indipendent from  linking a
 shared library which needs another shared library. This has
 to do with the RTLD_LAZY flag not with the RTLD_GLOBAL one. 
 In the example I used the RTLD_LAZY flag only because the current version of
 R uses it.
 The use of RTLD_NOW will also make debugging easier.
 An example was the missing routines
 problem in the locfit package (a couple of messages a month ago).
 I found out that the shared library misses a couple of routines
 compiling the package under Windows. But, under Unix, no 
 errors in building the library.
 But, if you try to use the R function which calls
 a C function with an unresolved routine you get a segmentation fault
 (or at least, I got it).
 
 > The alternative is to use the OS's ld or equivalent to create a
 > library that knows what it needs to call at link time by telling ld
 > what other shared libraries it needs; in this case
 > 
 > >  	
 > >  a.so: a.o
 > >  	gcc -shared -o a.so a.o
 > >  	
 > >  b.o: b.c
 > >  	gcc -fPIC -c b.c
 > >  	
 > >  b.so: b.o
 > >  	gcc -shared -o b.so b.o	
 > >  	
 > 
 > would change to
 > 
 > ...
 > b.so: b.o
 > 	gcc -shared -o b.so b.o	a.so
 > 
 > Mutually recursive libraries can be handled this way on most UNIX
 > systems I think; for Win32 there are some standard tricks involving
 > .def and .lib files (that I can't remember in detail but I think I
 > found them once on MS's web site) for making DLL's that are mutually
 > recursive. I haven't looked into mutual recursion on the Mac.
 > 
 Under Linux, the problem with this approach is that the dynamic
 linker (ld.so) must find a.so at runtime. I have just tried
 on the previous example but I can't load the so builded b.so in R.
 guido m.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Wed May 27 21:41:31 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 27 May 1998 15:41:31 -0500 (CDT)
Subject: dependencies in .so files
In-Reply-To: <19980527211018.2199.qmail@sirio.stat.unipd.it> from "guido@sirio.stat.unipd.it" at May 27, 98 10:10:18 pm
Message-ID: <9805272041.AA06858@nokomis.stat.umn.edu>

guido@sirio.stat.unipd.it wrote:
> 
>  > Also you need to consider what happens at runtime if a function is
>  > called and finds an unresolved symbol. On some systems a signal might
>  > be sent that can be caught (HP-UX sends SIGABRT, but I'm not sure I
>  > would want to catch all those), but this will need to be checked out
>  > on every different system. Having any problems reported at load time
>  > seems like a safer solution -- I have gone the other way and switched
>  > to using RTLD_NOW for this reason (and because that seems the least
>  > common denominator accross UNIX/Win32/Mac).
>  I agree. This point is however indipendent from  linking a
>  shared library which needs another shared library. This has
>  to do with the RTLD_LAZY flag not with the RTLD_GLOBAL one. 

Your're right -- I got those confused. GLOBAL makes the symbols in the
new library accessible to later loads, LAZY/NOW determine whether the
check for all needed symbols occurs at call or load time. I'm still
not sure though if RTLD_GLOBAL semantics are realiably implemented on
all UNIX systems. I think it's not an issue in Win32 since (except
with Watcom?) all references need to be resolved at link time.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu May 28 08:41:06 1998
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 28 May 1998 07:41:06 -0000 ()
Subject: dependencies in .so files
In-Reply-To: <19980527185017.2030.qmail@sirio.stat.unipd.it>
Message-ID: <XFMail.980528075225.plummer@iarc.fr>

This modified version of b.c in Guido's example works for me (R-0.61.3,
RedHat Linux 5.0) without modifying the R source.  R keeps an internal
table of symbols which is accessible via the R_FindSymbol function
(defined in src/unix/dynload.c), so you can use this to return a
pointer to a function in a previously loaded library.

Pardon my C if I've done something stupid here.
Martyn.

--------------------------b.c--------------------------------
#include <stdio.h>

typedef int (*DL_FUNC) ();

DL_FUNC R_FindSymbol(char *);

void b(int *i) {
    char afun[] = "a";
    DL_FUNC fun;

    printf("in b.so; calling function a in a.so; i=%d\n",*i);
    fun = R_FindSymbol(afun);
    fun(i);
    printf("in b.so; now i=%d\n",*i);
}
---------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May 28 09:50:58 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 28 May 1998 10:50:58 +0200
Subject: R manual (html version)
In-Reply-To: <D66FD155A8@main.ubishops.ca> (rvhulst@ubishops.ca)
Message-ID: <199805280850.KAA07204@sophie.ethz.ch>

>>>>> "Robert" == Robert van Hulst <rvhulst@ubishops.ca> writes:

    Robert> Martin, your R manual was VERY useful, but I cannot access it
    Robert> any more.

You mean
	http://www.stat.math.ethz.ch/R-alpha/doc/html/ ?

There was a file permission problem which is now fixed.   Sorry!

Thanks a lot for telling me!

    Robert> Could I download the whole manual? How?  Many thanks
    Robert> for your help!  --robert

The point about that manual is, that it is a *daily* updated version of the
online help about the *development* version of R, i.e, currently 0.62.

It is  *PART* of the new development version which you can get from 
	<CRAN>/src/devel/R-snapshot.tar.gz

After unpacking, you should be able to just say
	make docs
and then finally have the HTML manual netscape-accessable in

	file:<installdir>/doc/html/index.html

There is now even a java-based search engine (not yet complete) available
besides Packages and Functions:

-------------------------------------------------------------------------------
				 Reference

     Packages                    Functions          Search Engine & Keywords
-------------------------------------------------------------------------------

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu May 28 11:34:56 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Thu, 28 May 1998 11:34:56 +0100 (GMT+0100)
Subject: dependencies in .so files
In-Reply-To: <199805280827.KAA07151@sophie.ethz.ch> from "Martin Maechler" at May 28, 98 10:27:50 am
Message-ID: <19980528103456.3200.qmail@sirio.stat.unipd.it>

Martin Maechler writes:
> 
> >>>>> "Guido" == Guido Masarotto <guido@sirio.stat.unipd.it> writes:
> 
>     >> From the dlopen man page:
>     Guido> void *dlopen (const char *filename, int flag);
>     Guido> ................................................
>     Guido> RTLD_GLOBAL may be or'ed with flag
>     Guido> in which case the external symbols defined in the library will be
>     Guido> made available to subsequently loaded libraries.
>  
>     Guido> So, I try: 
>     Guido> 1) I modify src/unix/dynload.c changing the flag of dlopen
>     Guido> from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
> 
> R-core: 
> 	Shall we do this, for 0.62?  -- or even try to have "configure" find out
> 	if  RTLD_GLOBAL  is supported on the given system?
If I can give suggestions:
1) Independently from the RTLD_GLOBAL flag, I will change RTLD_LAZY to
   RTLD_NOW. As Luke T. summarized yesterday in this way a shared library
   which cannot resolve all its symbols (in R.binary or in other libraries)
   cannot be load. This give three   advantages:
   a) At least under Linux, if I call a dynamic linked routine which
      cannot resolve its dependencies, I get a segmentation fault and
      R exit. Of course, we can try to intercept this problem but
      as also Luke noted, it is difficult to be sure that all the systems 
      will trigs an  appropriate signal; in addition
   b) debugging of a shared library becomes simple; at least, we are
      sure that all the functions in the library can be called.
   c) This correspond to the standard for not Unix machine; I am
      sure for Windows but, if I remember, Luke said also for the Mac.
   Perhaps, if a library cannot be loaded, the corresponding dlerror()
   string should be used for giving to the user some information
   on why.
2) Coming to RTDL_GLOBAL; here the question is the one raised by
   Luke: portability. I suppose that the solution suggested by
   Luke (use "recursive" shared libraries)  is more portable than mine. 
   After a first failure, I was   able to run my "silly" example setting 
   the LD_LIBRARY_PATH shell variable,i.e., instructing ld.so about where 
   to search.
   

> Guido:  Have you ever looked at 0.62  (and porting it to Win32) ?
> 	(get it from <CRAN>/src/devel/R-snapshot.tar.gz)
I had no time. I downloaded a snapshot next week but I didn't make
any trial. Is the unix/system.c changed a lot? I have just looked
to it now and it seems quite similar to the 0.61.x one.

To all the R people: have a nice day.
guido m.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Andreas.Weingessel@ci.tuwien.ac.at  Thu May 28 14:25:59 1998
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 28 May 1998 15:25:59 +0200 (CEST)
Subject: performance of apply
Message-ID: <13677.26087.506888.469624@elendil.ci.tuwien.ac.at>


I noticed that apply is VERY SLOW when applied to a "large"
dimension as for example when computing the row sums of a matrix with
thousands of rows.

To demonstrate it, I did some benchmarking for different methods of
computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.

The first method (M1) I used is the normal apply command:
	y <- apply(x,1,sum)
The second method (M2) uses a for-loop for the computations, where the
memory for the resulting vector has been allocated before. That is, for
n=3D2000:
	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
The third method (M3) also uses a for-loop, but the resulting vector
is built recursively, i.e.
	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))

All computations have been made on a Pentium II 233MHz, 256MB, R
started as R -v 50. The following table shows the minimum, mean, and
maximum CPU-time in seconds as measured by system.time over 10 runs
for every computation for different values of n.

n	M1			M2		M3
2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81

That is, the computation of the sums of the rows of a 10000x10 matrix
with apply takes about 100sec on average, where a simple for-loop does
the same job in about 2sec.

The next table shows for every method the relative increase of time as
compared to the increase of the number of rows.

n	M1	M2	M3
1	 1	1	 1
2	 3.221	2.025	 2.952
3	 6.764	3.050	 6.032
4	15.247	4.075	10.175
5	23.599	5.025	15.540

You can see that the time for M2 (for-loop with memory allocated at
the beginning) increases linearly with n, which is to be expected,
whereas apply (M1) is scaling quadratically with the number of rows. M3
(for-loop, but new memory-allocation every time) is somewhere in between.


So obviously, R becomes slow, when new memory has to be allocated
repeatedly. I do not see a quick fix for apply, because apply can be
used with arbitrary functions which might yield different results for
different input data. But I think as long as memory allocation seems
to be a performance bottleneck, one should be aware of this problem,
use simple for-loops and use apply only on small data (small
dimensions) or where it is really necessary.

	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri May 29 15:05:40 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 09:05:40 -0500
Subject: performance of apply
In-Reply-To: Andreas Weingessel's message of Thu, 28 May 1998 15:25:59 +0200 (CEST)
References: <13677.26087.506888.469624@elendil.ci.tuwien.ac.at>
Message-ID: <6rlnrldvez.fsf@verdi.stat.wisc.edu>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> I noticed that apply is VERY SLOW when applied to a "large"
> dimension as for example when computing the row sums of a matrix with
> thousands of rows.
> 
> To demonstrate it, I did some benchmarking for different methods of
> computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.
> 
> The first method (M1) I used is the normal apply command:
> 	y <- apply(x,1,sum)
> The second method (M2) uses a for-loop for the computations, where the
> memory for the resulting vector has been allocated before. That is, for
> n=3D2000:
> 	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
> The third method (M3) also uses a for-loop, but the resulting vector
> is built recursively, i.e.
> 	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))
> 
> All computations have been made on a Pentium II 233MHz, 256MB, R
> started as R -v 50. The following table shows the minimum, mean, and
> maximum CPU-time in seconds as measured by system.time over 10 runs
> for every computation for different values of n.
> 
> n	M1			M2		M3
> 2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
> 4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
> 6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
> 8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
> 10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81
> 
> That is, the computation of the sums of the rows of a 10000x10 matrix
> with apply takes about 100sec on average, where a simple for-loop does
> the same job in about 2sec.

There would be at least two other methods that would be interesting to
try.  Because you are interested in the row sums I imagine by far the
fastest method would be (M4)
   y <- x %*% rep(1, ncol(x))
You may also find that (M5)
   y <- apply( t(x), 2, sum )
would be faster than M1 because of the way the R handles arrays.

We should keep in mind when looking at these tables that the maximum
time on the size 10000 case is about 2 minutes.  If the computation is
worth doing it may be worth waiting 2 minutes for the result.  I
remember the days of running S version 2 (i.e. the version before "New
S") on a Vax-11/750.  This sort of computation could take many, many
hours on the only computer in the department so relative differences
in speed for different methods were a lot more important.  One got
used to rephrasing computations in "efficient" ways.  Today I think
that clarity is usually more important than efficiency.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From wsimpson@uwinnipeg.ca  Fri May 29 15:32:52 1998
From: wsimpson@uwinnipeg.ca (Bill Simpson)
Date: Fri, 29 May 1998 09:32:52 -0500 (CDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
Message-ID: <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>

I was computing a function f(u,v) on bivariate point process data of
about 4500 points. The computation in R took about 96 hours (4 days!) on a
Pentium Pro 200 under linux with little or no other load. So I think speed
can be an issue, esp. when computing things one will eventually display
with image().

My collaborator and I wound up coding it in C and now the computation
takes 4 min (yes, 4 min vs 4 days).

Probably it could have been sped up in R but that would have taken the
same effort as coding in C, and the result would have been slower.

Bill Simpson

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Andreas.Weingessel@ci.tuwien.ac.at  Fri May 29 15:52:00 1998
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 29 May 1998 16:52:00 +0200 (CEST)
Subject: performance of apply
In-Reply-To: <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>
References: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
 <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>
Message-ID: <13678.52112.677406.807483@elendil.ci.tuwien.ac.at>



Maybe my point was not quite clear. I did not want to compute the row
sums of a certain matrix, I just wanted to demonstrate that the task
"apply a certain function to every row of a matrix" can take a very
long time, if it is done with the function "apply" which is of course
the most clear way to implement this task. I first came across this
problem when I made simulations on a data matrix with 15000 rows and
after adding one simple "apply" to my program, it suddenly seemed not to
finish at all.

If I just want make such a computation once, it might be not important
whether I wait a couple of seconds or 2 minutes or 5 minutes (as it
needs time for 15000 rows). But if I do some simulation where these
computations are repeated hundred times, there is a difference between
200 seconds or 200 minutes.

	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri May 29 16:11:04 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 10:11:04 -0500
Subject: performance of apply
In-Reply-To: Andreas Weingessel's message of Fri, 29 May 1998 16:52:00 +0200 (CEST)
References: <6rlnrldvez.fsf@verdi.stat.wisc.edu> 	<Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca> <13678.52112.677406.807483@elendil.ci.tuwien.ac.at>
Message-ID: <6rd8cxdsdz.fsf@verdi.stat.wisc.edu>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> If I just want make such a computation once, it might be not important
> whether I wait a couple of seconds or 2 minutes or 5 minutes (as it
> needs time for 15000 rows). But if I do some simulation where these
> computations are repeated hundred times, there is a difference between
> 200 seconds or 200 minutes.

I should probably have been clearer about what I was saying.  I was
indicating that some computations can be re-phrased in non-obvious
ways that are substantially faster in R.  To a numerical analyst it
would be ridiculous to use a matrix multiplication to collect row sums
because you are doing all those multiplications by 1.  However, in R/S
it is substantially faster because the looping overhear is in C not in
R.

The other issue I was trying to indicate is that efficiency has to be
measured in how long it takes to get the work done.  This includes
both thinking (and often debugging) time and computing time.  The
trade-offs between the cost of thinking and the cost of computing have
changed remarkably over the years.  I often characterize the way I see
people computing now as using a computer as a blunt instrument with
which to bludgeon the problem to death (can you say "Markov Chain
Monte Carlo"?).  In real world terms it may be more efficient to do
that than to think deeply about the computations involved and how to
speed them up.

I have probably said too much about this.  I should go back to writing
my code, which, ironically, is C code designed to speed up simulations
for a particular type of statistical model :-)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Fri May 29 16:45:53 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 29 May 1998 10:45:53 -0500 (CDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu> from "Douglas Bates" at May 29, 98 09:05:40 am
Message-ID: <9805291545.AA08154@nokomis.stat.umn.edu>

Douglas Bates wrote:
> 
> Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:
> > 
> > To demonstrate it, I did some benchmarking for different methods of
> > computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.
> > 
> > The first method (M1) I used is the normal apply command:
> > 	y <- apply(x,1,sum)
> > The second method (M2) uses a for-loop for the computations, where the
> > memory for the resulting vector has been allocated before. That is, for
> > n=3D2000:
> > 	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
> > The third method (M3) also uses a for-loop, but the resulting vector
> > is built recursively, i.e.
> > 	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))
> > 
> > All computations have been made on a Pentium II 233MHz, 256MB, R
> > started as R -v 50. The following table shows the minimum, mean, and
> > maximum CPU-time in seconds as measured by system.time over 10 runs
> > for every computation for different values of n.
> > 
> > n			M1			M2		M3
> > 2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
> > 4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
> > 6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
> > 8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
> > 10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81
> > 
> > That is, the computation of the sums of the rows of a 10000x10 matrix
> > with apply takes about 100sec on average, where a simple for-loop does
> > the same job in about 2sec.

It looks like M1 and M3 are O(n^2) but M1 is O(n). I see where that
comes from in M3, but it surprises me for M1.

luke



-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri May 29 17:04:30 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 29 May 1998 18:04:30 +0200
Subject: performance of apply
In-Reply-To: Luke Tierney's message of Fri, 29 May 1998 10:45:53 -0500 (CDT)
References: <9805291545.AA08154@nokomis.stat.umn.edu>
Message-ID: <x2af81t65t.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:


> > > That is, the computation of the sums of the rows of a 10000x10 matrix
> > > with apply takes about 100sec on average, where a simple for-loop does
> > > the same job in about 2sec.
> 
> It looks like M1 and M3 are O(n^2) but M1 is O(n). I see where that
> comes from in M3, but it surprises me for M1.

Oh, dear. Looking at apply, we have right in the middle of it:

            for (i in 1:d2) ans[[i]] <- FUN(array(newX[, i], d.call, 
                    dn.call), ...)

Assignment to the tail of a very long list... 

I think I'm beginning to understand why Ross keeps talking about
generic vectors. Either that or we need to add some low-level list
primitives to the language. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri May 29 17:14:36 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 29 May 1998 09:14:36 -0700 (PDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
Message-ID: <Pine.LNX.3.96.980529090735.23645A-100000@buffy>

On 29 May 1998, Douglas Bates wrote:

> Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:
> 
> > I noticed that apply is VERY SLOW when applied to a "large"
> > dimension as for example when computing the row sums of a matrix with
> > thousands of rows.
> > 
> 

> 
> We should keep in mind when looking at these tables that the maximum
> time on the size 10000 case is about 2 minutes.  If the computation is
> worth doing it may be worth waiting 2 minutes for the result.  I
> remember the days of running S version 2 (i.e. the version before "New
> S") on a Vax-11/750.  This sort of computation could take many, many
> hours on the only computer in the department so relative differences
> in speed for different methods were a lot more important.  One got
> used to rephrasing computations in "efficient" ways.  Today I think
> that clarity is usually more important than efficiency.

One of the really nice things about R is that you _don't_ have to use
apply to get loops to run in reasonable time, since for most non-Lisp
people for() is simpler than apply(). 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Fri May 29 22:20:39 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 30 May 1998 09:20:39 +1200 (NZST)
Subject: performance of apply
Message-ID: <199805292120.JAA14926@stat1.stat.auckland.ac.nz>

	Subject: Re: performance of apply
	From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
	Date: 29 May 1998 18:04:30 +0200
	MIME-Version: 1.0
	Content-Transfer-Encoding: 7bit

	Oh, dear. Looking at apply, we have right in the middle of it:

	            for (i in 1:d2) ans[[i]] <- FUN(array(newX[, i], d.call, 
	                    dn.call), ...)

	Assignment to the tail of a very long list... 

	I think I'm beginning to understand why Ross keeps talking about
	generic vectors. Either that or we need to add some low-level list
	primitives to the language. 


Got it in one.  To reach ans[[i]] you have to cdr down the whole list.
The subsetting code would be vastly simplified without the special
list code.  Ugliest of all is subscript manipulation for lists with
dim attributes.

[ I estimate 2 months for a fix - not that it will take that long,
  but there are some other things higher up the todo list ].

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jimrc@mathfs.math.montana.edu  Fri May 29 23:44:12 1998
From: jimrc@mathfs.math.montana.edu (Jim Robison-Cox)
Date: Fri, 29 May 1998 16:44:12 -0600 (MDT)
Subject: aov design questions
Message-ID: <Pine.ULT.3.91.980529162513.20891B-100000@mathfs.math.montana.edu>

R developers,

  I have a first attempt to make an aov function.  Eventually I want to
  build in  Error() structure, but first I am trying to get this
  presentable for balanced data with only a single stratum, just using 
  residual error.  I  am following R. M. Heiberger's Computation for the 
  Analysis of Designed Experiments, Wiley (1989)

  I a using a wrapper (aov.bal) to call the fitting function in the same 
way that lm() does a bunch of stuff and then calls lm.fit(), in fact I 
took most of the wrapper right out of lm(). I'm trying to make the aov 
object look as much as possible like an lm.object


  Several questions have come up which need discussion.

Q 1)  Is aov supposed to avoid qr decomposition and matrix inversion?
      In S it is claimed to be faster than lm() for large datasets.  Is
      that due to avoidance of qr()? 

      (My main goal is to get the Error strata working.)


Q 2)  If the speed is important, can we give up choice of contrasts used to
  set up the dummy factor variables? ( contr.treatment, contr.sum) 

   Why do I ask? 
   In pursuit of speed (we're talking nanoseconds for a reasonable size
   data set) I have forced in helmert  contrasts because their
   orthogonality makes it slick to compute. So in this version, whatever
   option(contrasts) is set will be ignored.

   I don't like making that choice for the user esp. since it gives wrong 
   answers under the default contrasts, and have thought about
   converting back into the original contrasts, but it isn't easy with
   higher-way anova models. It looks easy in VR2 p 197-204 
   (BTW I have kroenecker and ginv functions if anyone wants them)
  but I don't get it to work out nicely.  V&R show the contrast
  transformation as:
   alpha_T = ginv(C_T) %*% C_H %*% alpha_H
  where C_T is the contrast matrix for treatment contrasts, and C_H for
  Helmert contrasts. The alpha's contain only the treatment contrast 
  effects, not the mean.  This would leave the intercept estimate
   unchanged (not right).  For single factors it works to stick a 
  col.vector of 1s on the front of C_H and C_T, and include the mu.hat in 
  the alpha_H or alpha_T.  But when I get into interactions, I don't see 
  what is needed.

Q 3)  I am having a problem with keep.order. With balanced data, I know
    the effects are orthogonal, so order is not an issue, but as I move
    onto the tougher cases, I need model.matrix to preserve order, and
    it doesn't.

Q 4)  What are the $effects in lm.objects?
     For the moment I've stuck in the coefficients.

Q 5)  Any objection to passing cov.unscaled from aov to summary.aov?
    (Since I'm not using qr and can't pass R)

Feedback needed, comments are welcome.


Jim Robison-Cox                 ____________            
Department of Math Sciences    |            |           phone: (406)994-5340
2-214 Wilson Hall               \   BZN, MT |           FAX:   (406)994-1789
Montana State University         |  *_______|
Bozeman, MT 59717                 \_|         e-mail: jimrc@math.montana.edu 

#---------------------------------------------------------------------------
##  First hack at aov for balanced data

aov.bal <- function(formula, data = list(), subset, weights, na.action, 
        method = "qr", model = TRUE, keep.order=F, ...) 
{  
     mt <- terms(formula, data = data, keep.order = keep.order)
     nt <- length(attr(mt,"order")[attr(mt,"order") ==1])
     lt <- rep("contr.helmert",nt)            ## Sets helmert contrasts
     names(lt) <- attr(mt,"term.labels")[ attr(mt,"order") ==1]
     mf <- match.call()
     mf$model <- NULL
     mf[[1]] <- as.name("model.frame")
     mf <- eval(mf, sys.frame(sys.parent()))
     if (method == "model.frame") 
          return(mf)
     else if (method != "qr")  ## change for aov??
         warning(paste("method =", method, "is not supported. Using \"qr\"."))
     if (length(list(...))) 
          warning(paste("Extra arguments", deparse(substitute(...)), 
                        "are just disregarded."))
     y <- model.response(mf, "numeric")
     w <- model.weights(mf)
     if (is.empty.model(mt)) {
                z <- list(coefficients = numeric(0), residuals = y, 
                        fitted.values = 0 * y, weights = w, rank = 0, 
                        df.residual = length(y))
                class(z) <- if (is.matrix(y)) 
                        c("mlm.null", "lm.null", "mlm", "lm")
                else c("lm.null", "lm")
     }
     else {
                x <- model.matrix(mt, mf, as.list(lt))
                          # forces in contr.helmert
                z <- if (is.null(w)) {
                   aov.balanced.fit(x, y, mt)
		}
                else {
                  stop("Weighted aov not implemented, use lm")
                  #aov.balanced.wfit(x, y, mt, w)
                }
                class(z) <- c(if (is.matrix(y)) c("maov","mlm"), c("aov","lm"))
     }
     z$call <- match.call()
     z$terms <- mt
     if (model) 
         z$model <- mf
     z
}

aov.balanced.fit <- function(x,y,mod.terms,wt=NULL){
    x <- as.matrix(x); dimx <- dim(x)
    xnames <- dimnames(x)[[2]]
    y <- as.matrix(y); dimy <- dim(y)
    assn <- attr(x,"assign")
    df  <-   c(table(assn), dimy[1]- dimx[2])
    D <- diag(1/diag(t(x) %*% x))
    dimnames(D) <- list(xnames,xnames)
    coef <- as.numeric(D %*% t(x) %*%  y)
    names(coef) <- xnames
    fits <- x %*% coef
    resid <- y - fits
    eff <-  apply((t(x) * rep(coef,dimx[1]))^2,1,sum)
             ## Take each column of x (row of t(x)) times its
             ## coefficient, square the result and sum (over columns of x)
    eff <-  c(sapply( split(eff,assn), sum),   sum(resid^2))
             ## Adds them up over the factors.
    if(attr(mod.terms,"intercept") == 1) {
      eff <- eff[-1]
      df  <- df[-1]
    }
    name <- c(attr(mod.terms,"term.labels"), "Residuals")
    names(eff) <- name
    names(df)  <- name
    list(coefficients= coef, residuals = resid, effects = eff, 
         rank= dimx[2], fitted.values = fits, assign= assn,
         cov.unscaled = D, df.residual =  dimy[1] - dimx[2],
         df =  df  )
    
}

print.aov <- 
function (x, digits = max(3, .Options$digits - 3), ...) 
{  
   lenx <- length(x$df)
   tabl <- cbind(x$df,x$effects, x$effects/x$df)
   tabl <- cbind(tabl,c(tabl[1:(lenx-1),3]/tabl[lenx,3],NA))
   tabl <- cbind(tabl,1-pf(tabl[,4],tabl[,1],tabl[lenx,1]))
   dimnames(tabl) <- list(names(x$effects), c("df","SS","MS","F","P > F"))
   cat("\nAnalysis of Variance:\n\n")
   print.default(round(tabl, digits), na = "", print.gap = 2)
   cat("\n")
   invisible(x)
}


summary.aov <- function (z, correlation=F) 
{
        p <- z$rank
        p1 <- 1:p
        r <- resid(z)
        f <- fitted(z)
        n <- length(f)
        w <- weights(z)
        if (is.null(z$terms)) {
                stop("invalid 'aov' object:  no terms component")
        }
        else {
                if (is.null(w)) {
                        mss <- if (attr(z$terms, "intercept")) 
                                sum((f - mean(f))^2)
                        else sum(f^2)
                        rss <- sum(r^2)
                }
        }
        resvar <- rss/(n - p)
        se <- sqrt(resvar * diag(z$cov.unscaled))
        est <- z$coefficients
        tval <- est/se
        ans <- z[c("call", "terms")]
        ans$residuals <- as.numeric(r)
        ans$coefficients <- cbind(est, se, tval, 2 * (1 - pt(abs(tval), 
                n - p)))
        dimnames(ans$coefficients) <- list(names(z$coefficients),
                c("Estimate", "Std.Error", "t Value", "Pr(>|t|)"))
        ans$sigma <- sqrt(resvar)
        ans$df <- c(p, n - p)
        if (p != attr(z$terms, "intercept")) {
                df.int <- if (attr(z$terms, "intercept")) 
                        1
                else 0
                ans$r.squared <- mss/(mss + rss)
                #0.14 :	(n/(n-p))
                ans$adj.r.squared <- 1 - (1 - ans$r.squared) * 
                        ((n - df.int)/(n - p))
                ans$fstatistic <- c((mss/(p - df.int))/(rss/(n - 
                        p)), p - df.int, n - p)
                #0.14: ans$fstatistic <- c((mss/(p-1))/(rss/(n-p)),p-1,n-p)
                names(ans$fstatistic) <- c("value", "numdf", 
                        "dendf")
        }
        ans$cov.unscaled <- z$cov.unscaled
        if (correlation) {
                invsqrt.diag <- diag(sqrt(1/diag(z$cov.unscaled)))
                ans$correlation <-
                      invsqrt.diag %*% z$cov.unscaled %*% invsqrt.diag
                dimnames(ans$correlation) <- dimnames(z$cov.unscaled)
        }
        class(ans) <- "summary.aov"
        ans
}

print.summary.aov <- function (x, digits = max(3, .Options$digits - 3), 
                              roundfun = round, ...) 
{
        cat("\nCall:\n")
        cat(paste(deparse(x$call), sep = "\n", collapse = "\n"), 
                "\n\n", sep = "")
        resid <- x$residuals
        df <- x$df
        rdf <- df[2]
        if (rdf > 5) {
                cat("Residuals:\n")
                if (length(dim(resid)) == 2) {
                        rq <- apply(t(resid), 1, quantile)
                        dimnames(rq) <- list(c("Min", "1Q", "Median", 
                                "3Q", "Max"), dimnames(resid)[[2]])
                }
                else {
                        rq <- quantile(as.numeric(resid))
                        names(rq) <- c("Min", "1Q", "Median", 
                                "3Q", "Max")
                }
                print(rq, digits = digits, ...)
        }
        else if (rdf > 0) {
                cat("Residuals:\n")
                print(resid, digits = digits, ...)
        }
#        if (nsingular <- df[3] - df[1]) 
#                cat("\nCoefficients: (", nsingular, " not defined because of singularities)\n", 
#                        sep = "")
#        else
        cat("\nCoefficients:\n")
        print(roundfun(x$coefficients, digits = digits), quote = FALSE, 
                ...)
        cat("\nResidual standard error:", format(signif(x$sigma, 
                digits)), "on", rdf, "degrees of freedom\n")
        if (!is.null(x$fstatistic)) {
                cat("Multiple R-Squared:", format(signif(x$r.squared, 
                        digits)))
                cat(",\tAdjusted R-squared:", format(signif(x$adj.r.squared, 
                        digits)), "\n")
                cat("F-statistic:", format(signif(x$fstatistic[1], 
                        digits)), "on", x$fstatistic[2], "and", 
                        x$fstatistic[3], "degrees of freedom")
                cat(",\tp-value:", format(signif(1 - pf(x$fstatistic[1], 
                        x$fstatistic[2], x$fstatistic[3]), digits)), 
                        "\n")
        }
        correl <- x$correlation
        if (!is.null(correl)) {
                p <- dim(correl)[2]
                if (p > 1) {
                        cat("\nCorrelation of Coefficients:\n")
                        correl[!lower.tri(correl)] <- NA
                        print(correl[-1, -NCOL(correl)], digits = digits, 
                                na = "")
                }
        }
        cat("\n")
        invisible(x)
}

#-------------------------------------------------------------------------
##  Rd file:
\name{aov.bal}
\title{Function to compute analysis of variance for balanced designs}
\usage{
aov.bal(formula, data=list(), subset, weights, na.action, method="qr", model=TRUE, keep.order=F, ...)
}
%- maybe also `usage' for other functions documented here.
\alias{aov.bal}
\alias{summary.aov}
\alias{coefficients.lm}
\alias{df.residual.lm}
\alias{fitted.values.lm}
\alias{residuals.lm}
\alias{aov.balanced.fit}
\alias{print.aov}
\alias{print.summary.aov}
\keyword{regression}
%- Also NEED an `\alias' for EACH other function documented here.
\arguments{
 \item{formula}{A detailed description of the model to be fit.  See
   details under \code{\link{lm}} }
 \item{data}{ data frame contining the data to be fit. Default is
   working directory.}
 \item{subset}{Description of what rows of the data frame to use in the fit. }
 \item{na.action}{ Currently not used }
 \item{method}{Not currently used, except that method="model.frame" will
 extract the model frame only and not fit the anova.}
 \item{model}{ If true, model frame is included in the output.}
 \item{keep.order}{If true, model should be evaluated in the order
   specified by the model statement. (Doesn't work.)}
 \item{\dots}{ other arguments (not presently used) }
}
\description{
\code{aov.bal} is used to fit analysis of variance models.  Eventually it
will handle multiple strata. The generic accessor functions
\code{coefficients}, \code{fitted.values} and \code{residuals}
can be used to extract various useful features of the
value returned by \code{aov.bal}.  Currently \code{aov.bal} uses only the
Helmert contrasts and ignores the contrast functions set by
options()$contrast. 
}
\value{
\code{aov.bal} returns an object of class code\aov} which may be printed
with the \code{print.aov} or \code{summary.aov}.
  \item{coefficients}{Coefficients under the Helmert contrasts.}
  \item{residuals} {Residuals}
  \item{effects } {effects ?=? coefficients?}
  \item{rank}     
  \item{fitted.values}
  \item{assign}
  \item{var }
  \item{df.residual}
  \item{df}
  \item{call}
  \item{terms}
}
\references{ Heiberger, R. M., 1989, Computation for the Analysis of
  Designed Experiments, Wiley}
\author{ Jim Robison-Cox }
\seealso{ \code{\link{lm}},\code{\link{glm}},\code{\link{coefficients}},\code{\link{residuals}},\code{\link{fitted.values}} }

\examples{
 speed <- c(59, 69, 66, 75, 54, 65, 58, 70, 66, 77, 71, 71, 58, 65, 56,
            62, 54, 60, 52, 64, 59, 73, 60, 70)
 typists <- gl(6,4,24)
 brands  <- gl(4,1,24)
 type.aov <- aov.bal(speed ~ typists + brands)
 summary(type.aov)
}
\keyword{ regression }%-- one or more ...
\keyword{models}


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sat May 30 00:09:10 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 18:09:10 -0500
Subject: An R BOF meeting at the JSM?
Message-ID: <6raf80d695.fsf@verdi.stat.wisc.edu>

The BOF in the subject line is a "Birds Of a Feather" meeting.  This
is a chance for people who normally only get the chance to communicate
via e-mail to actually sit down and talk to each other in person.

I plan to be at the Joint Statistical Meetings in Dallas in August.
If you will be attending and would be interested in getting together
with some other R folks, please e-mail me and I will try to set
something up. Usually there is a mixer for the Statistical Computing
and Statistical Graphics sections on Monday night so that might be a
good time and place to try to meet.  I'm assuming pretty well everyone
on the R-devel group would belong to one of those sections.  If not
you could probably come anyway and just pretend you are not eating any
of the peanuts.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon May  4 16:34:15 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 4 May 1998 17:34:15 +0200 (CEST)
Subject: Updated mass package on CRAN
Message-ID: <13645.57335.908351.332965@galadriel.ci.tuwien.ac.at>


Hi,

I've converted all functions etc. from V&R's MASS library to R
... everything's in mass_5.2pl005-2.tar.gz in the devel section of
CRAN. Below is the README:

**********************************************************

This is a first shot at porting the whole main section of V&R's MASS
library to R --- and only for cool people with a brave heart :-)

Porting was done using brute force and (almost) no checking, i.e.,
 *) all .q files were renamed to .R
 *) all man pages converted automatically using Sd2Rd
 *) all *.dat files renamed to .tab

For further changes see the ChangeLog.

Especially the data might not work at all ...

Anyway, I currently don't have time to do all the time consuming
checking/rewrite of man pages/..., but wanted to provide others with a
start.

And some things are working :-)

Good luck,

-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May  4 17:09:27 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 4 May 1998 12:09:27 -0400
Subject: lSM  lICE: not found
Message-ID: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>

I'm trying to compile R 0.61.3 on Solaris and I get the following error. Does
anyone know where I should find these libraries?

ld: fatal: library -lSM: not found
ld: fatal: library -lICE: not found
ld: fatal: File processing errors.  No output written to R.binary
*** Error code 1
make: Fatal error: Command failed for target `R.binary'

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May  4 17:35:50 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 May 1998 18:35:50 +0200
Subject: lSM  lICE: not found
In-Reply-To: Paul Gilbert's message of Mon, 4 May 1998 12:09:27 -0400
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>
Message-ID: <x267jmhu3d.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> 
> I'm trying to compile R 0.61.3 on Solaris and I get the following error. Does
> anyone know where I should find these libraries?
> 
> ld: fatal: library -lSM: not found
> ld: fatal: library -lICE: not found
> ld: fatal: File processing errors.  No output written to R.binary
> *** Error code 1
> make: Fatal error: Command failed for target `R.binary'
> 
> Paul Gilbert

Huh?

bash$ uname -a
SunOS stat 5.5.1 Generic_103640-05 sun4m sparc SUNW,SPARCstation-10

<output from make>
cd main; make
gcc -o R.binary arithmetic.o array.o attrib.o bind.o builtin.o
 ....
 ../lib/libunix.a ../lib/libappl.a ../lib/libmath.a -L/usr/openwin/lib
 -R/usr/openwin/lib -lX11 -lsocket -lnsl -ldl -lreadline -ltermcap -lm

..no mention of libSM or libICE.

Why is it requiring those libraries in the first place?? Are you
installing from scratch or might there be some leftovers from a
previous compile. The -lSM -lICE line seems to come from some generic
X11 stuff in configure and are not mentioned in configure.in, which I
suppose means: if R doesn't configure and compile, no other X program
does either....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@math.sc.edu  Mon May  4 18:11:19 1998
From: rossini@math.sc.edu (Anthony Rossini)
Date: 04 May 1998 13:11:19 -0400
Subject: lSM  lICE: not found
In-Reply-To: Peter Dalgaard BSA's message of "04 May 1998 18:35:50 +0200"
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk>
Message-ID: <wnc1zua2c7c.fsf@fhat.stat.sc.edu>


>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    >> I'm trying to compile R 0.61.3 on Solaris and I get the
    >> following error. Does anyone know where I should find these
    >> libraries?
    >> 
    >> ld: fatal: library -lSM: not found
    >> ld: fatal: library -lICE: not found
    >> ld: fatal: File processing errors.  No output written to R.binary
    >> *** Error code 1
    >> make: Fatal error: Command failed for target `R.binary'

    Peter> Huh?

    Peter> bash$ uname -a
    Peter> SunOS stat 5.5.1 Generic_103640-05 sun4m sparc SUNW,SPARCstation-10

    Peter> <output from make>
    Peter> cd main; make
    Peter> gcc -o R.binary arithmetic.o array.o attrib.o bind.o builtin.o
    Peter>  ....
    Peter>  ../lib/libunix.a ../lib/libappl.a ../lib/libmath.a -L/usr/openwin/lib
    Peter>  -R/usr/openwin/lib -lX11 -lsocket -lnsl -ldl -lreadline -ltermcap -lm

    Peter> ..no mention of libSM or libICE.

    Peter> Why is it requiring those libraries in the first place??
    Peter> Are you installing from scratch or might there be some
    Peter> leftovers from a previous compile. The -lSM -lICE line
    Peter> seems to come from some generic X11 stuff in configure and
    Peter> are not mentioned in configure.in, which I suppose means:
    Peter> if R doesn't configure and compile, no other X program does
    Peter> either....

To clarify Peter's point, -lICE -lSM are from the X11R6 distribution,
but last I checked, OpenWindows (which is what Sun shipped with the
2.5 distribution, I've got my hands on a machine running 2.6), uses
X11R5, which doesn't have those two libraries.

If you've got a confused X set up (like a local version of The Open
Group's (was MIT's) X11R6 build, this could be the result.

You should determine the version of X, and link accordingly.

The only other thought is that Sun "forgot" to ship the SM and ICE
libs; they did that with a different library a few OS distributions
ago (Slowaris 2.3?).

Or it might be some confusion (XlispStat's configure once had a
similar problem a long time ago).

best,
-tony
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May  4 19:02:40 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 4 May 1998 14:02:40 -0400
Subject: lSM  lICE: not found
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk> <wnc1zua2c7c.fsf@fhat.stat.sc.edu>
Message-ID: <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>

    Peter> Why is it requiring those libraries in the first place??
    Peter> Are you installing from scratch or might there be some
    Peter> leftovers from a previous compile. The -lSM -lICE line

Indeed this seems to have been the problem. I first tried to configure and make
on my new workstation with Solaris 2.6, but ran into a problem because
apparently I need a newer version of gcc. I then did a "make clean", telneted to
an older machine with Solaris 2.5.1, re-ran configure and then make. However,
this does not seem to get things clean enough - I guess configure does not
re-configure?

When I started completely clean from the tar file the problem seems to have gone
away.

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@math.sc.edu  Mon May  4 20:06:23 1998
From: rossini@math.sc.edu (Anthony Rossini)
Date: 04 May 1998 15:06:23 -0400
Subject: lSM  lICE: not found
In-Reply-To: Paul Gilbert's message of "Mon, 4 May 1998 14:02:40 -0400"
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk> <wnc1zua2c7c.fsf@fhat.stat.sc.edu> <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>
Message-ID: <wnchg35luts.fsf@fhat.stat.sc.edu>


>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> an older machine with Solaris 2.5.1, re-ran configure and
    Paul> then make. However, this does not seem to get things clean
    Paul> enough - I guess configure does not re-configure?

Not if it already built a cache (you can look for a config.cache file,
and delete it to force configure to look for everything -- I suspect
there is a command line option to configure to do the same.).  The
reason is to allow configuration of different options on the same
architecture w/o determining the architecture again.
(i.e. reconfiguring for mule and graphics support in xemacs, after you 
get new required libraries); it's a bit harder to justify for R.

best,
-tony


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May  4 22:26:42 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 May 1998 23:26:42 +0200
Subject: lSM  lICE: not found
In-Reply-To: Anthony Rossini's message of 04 May 1998 15:06:23 -0400
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>
 <x267jmhu3d.fsf@blueberry.kubism.ku.dk>
 <wnc1zua2c7c.fsf@fhat.stat.sc.edu>
 <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>
 <wnchg35luts.fsf@fhat.stat.sc.edu>
Message-ID: <x27m41wwvh.fsf@biostat.ku.dk>

Anthony Rossini <rossini@math.sc.edu> writes:

> 
> 
> >>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
> 
>     Paul> an older machine with Solaris 2.5.1, re-ran configure and
>     Paul> then make. However, this does not seem to get things clean
>     Paul> enough - I guess configure does not re-configure?
> 
> Not if it already built a cache (you can look for a config.cache file,
> and delete it to force configure to look for everything -- I suspect
> there is a command line option to configure to do the same.).  The
> reason is to allow configuration of different options on the same
> architecture w/o determining the architecture again.
> (i.e. reconfiguring for mule and graphics support in xemacs, after you 
> get new required libraries); it's a bit harder to justify for R.

make acclean
(or moreclean or distclean or realclean) does this automatically.

Should we let "make clean" do so as well? It's a single-word change,
but are there adverse side effects? Considering how rarely I do "make
clean" myself, I don't think I'd mind the extra time usage for
reconfiguration (about 16 seconds on this machine).


configure --cache-file=/dev/null 
disables caching, according to the comments in the script (not
terribly elegant in my opinion...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon May  4 23:17:14 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 May 1998 10:17:14 +1200 (NZST)
Subject: lSM  lICE: not found
Message-ID: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>

The intent of "make clean" is to remove the temporaries but leave a
complete runnable R.  It is quite useful when you have installed
versions of R.  Maybe the "make clean" / "make distclean" distinction
needs to be explicit in the "INSTALL" file.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue May  5 08:48:16 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 05 May 1998 09:48:16 +0200
Subject: lSM  lICE: not found
In-Reply-To: Ross Ihaka's message of Tue, 5 May 1998 10:17:14 +1200 (NZST)
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
Message-ID: <x290ohb1kv.fsf@biostat.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> The intent of "make clean" is to remove the temporaries but leave a
> complete runnable R.  It is quite useful when you have installed
> versions of R.  Maybe the "make clean" / "make distclean" distinction
> needs to be explicit in the "INSTALL" file.
> 
> 	Ross

This begs the question: Is anything in config.{cache,log,status}
necessary for R to run, then? (Or could it become so?) Otherwise
"acclean" *should* probably be made as part of "clean"

I know there's a lot of tradition and conventions in how to setup
makefiles, but wouldn't it be handy with a "rebuild" type target?

rebuild: realclean R

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 14:41:44 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 09:41:44 -0400
Subject: lSM  lICE: not found
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
Message-ID: <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>

Ross> The intent of "make clean" is to remove the temporaries but leave a
Ross> complete runnable R.  It is quite useful when you have installed
Ross> versions of R.  Maybe the "make clean" / "make distclean" distinction
Ross> needs to be explicit in the "INSTALL" file.

I had assumed "make clean" would leave a complete runnable R, that is my
runnable R wouldn't get messed up until I did "make" which does "install", which
can potentially mess up my running R. But I had also assumed that when I did
"make" I would be starting clean, which is not completely true it seems - at
least as far as the architecture and other stuff as determined by configure are
concerned.

I'm not sure what would be the best approach to make things easy for novices. I
don't use "make clean" very often for R and it is probably more of a utility for
developers - but I did get caught this time. My usual approach is just to delete
everything and start over with the tar file. I think, however, that anything
like "make distclean" or "make realclean" or "make acclean" is going to be even
more of a utility for developers - they all assume you are familiar with the
Makefile, or, if they are documented, that you read the documentation
(regularly, since these things change).

Probably the best thing to make it easy for novices is to have some "install" or
"setup" script which does all of the appropriate steps. This should also make
certain that everything is sufficiently clean that there won't be any mistakes.

Paul Gilbert



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Tue May  5 16:21:18 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Tue, 5 May 1998 16:21:18 +0100 (GMT+0100)
Subject: RSXNT (was R-0.61.1 compiled with ...)
In-Reply-To: <x27m4je3ju.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Apr 21, 98 02:56:37 pm
Message-ID: <19980505152118.5751.qmail@sirio.stat.unipd.it>

> >  Peter Dalgaard BSA writes:
> >  > 
> >  > Ouch! In that case, I suggest that we try to put some collective
> >  > effort into getting something working with RSXNT. The only thing that
Yesterday evening, I downloaded the last version of RSXNT. 
I just played with it half an hour but seems to work (at least under
WIN95).
Have someone tryed to compile R?
If not, I will make an attempt starting from my previous 
work with mingw32.
guido masarotto
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Tue May  5 16:24:17 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Tue, 5 May 1998 16:24:17 +0100 (GMT+0100)
Subject: lSM  lICE: not found (fwd)
Message-ID: <19980505152418.5768.qmail@sirio.stat.unipd.it>

 1) The effect of "make clean" is the "more standard". I checked
    with some programs of which I have the source installed and
    no remove config.cache with only clean.
 2) When you have config.cache and you rerun configure 
    you obtain a lot of line of the type "something (cached)".
    The meaning of this must perhaps be explained in the documentation.
    
 guido masarotto   
 
 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Tue May  5 15:44:09 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Tue, 5 May 1998 16:44:09 +0200 (MDT)
Subject: lSM  lICE: not found
In-Reply-To: <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
 <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
Message-ID: <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>

Paul Gilbert: 
 > Ross> The intent of "make clean" is to remove the temporaries but leave a
 > Ross> complete runnable R.  It is quite useful when you have installed
 > Ross> versions of R.  Maybe the "make clean" / "make distclean" distinction
 > Ross> needs to be explicit in the "INSTALL" file.
 > 
 > I had assumed "make clean" would leave a complete runnable R, that is my
 > runnable R wouldn't get messed up until I did "make" which does "install", which
 > can potentially mess up my running R. But I had also assumed that when I did
 > "make" I would be starting clean, which is not completely true it seems - at
 > least as far as the architecture and other stuff as determined by configure are
 > concerned.
 > 
 > I'm not sure what would be the best approach to make things easy for novices. I
 > don't use "make clean" very often for R and it is probably more of a utility for
 > developers - but I did get caught this time. My usual approach is just to delete
 > everything and start over with the tar file. I think, however, that anything
 > like "make distclean" or "make realclean" or "make acclean" is going to be even
 > more of a utility for developers - they all assume you are familiar with the
 > Makefile, or, if they are documented, that you read the documentation
 > (regularly, since these things change).
 > 
 > Probably the best thing to make it easy for novices is to have some "install" or
 > "setup" script which does all of the appropriate steps. This should also make
 > certain that everything is sufficiently clean that there won't be any mistakes.

I agree!

The (good!) tradition Peter Dalgaard addresses means

- "make" -- OK, we all know...

- "make clean" returns to the state after configure

- "make distclean" returns to the state before configure

- "make install" installs the whole at the standard place /usr/local
which may be redirected by "configure --prefix=..."

Everyone knows it and one may be irritated if there is another
arrangement (OK, may be I become old :-)

I allready wanted to suggest you authors to add that install target
because

- I don't like to build the whole stuff in /usr/local
- I don't like to have the R script point to any build directory
- I don't want to think about which files have to be moved to
/usr/local for the program to run correctly. The author knows that (I
hope :-)

As for R, there is no clean separation between the build stuff and the
run stuff. I would like to have it.

But anyway: Thanks for that program!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Tue May  5 15:55:39 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 5 May 1998 16:55:39 +0200 (CEST)
Subject: lSM  lICE: not found
In-Reply-To: <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
 <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
 <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>
Message-ID: <13647.10347.618706.726445@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 5 May 1998 16:44:09 +0200 (MDT),
>>>>> Hubert Palme (HP) wrote:


HP> I allready wanted to suggest you authors to add that install target
HP> because

HP> - I don't like to build the whole stuff in /usr/local
HP> - I don't like to have the R script point to any build directory
HP> - I don't want to think about which files have to be moved to
HP> /usr/local for the program to run correctly. The author knows that (I
HP> hope :-)

HP> As for R, there is no clean separation between the build stuff and th=
e
HP> run stuff. I would like to have it.

The authors also want to have it for quite some time ;-) ... meaning
it's on our TODO list for 0.62 since I can't recall when ...

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May  5 17:36:33 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 May 1998 18:36:33 +0200
Subject: make and all that..
In-Reply-To: <x290ohb1kv.fsf@biostat.ku.dk> (message from Peter Dalgaard BSA
 on 05 May 1998 09:48:16 +0200)
Message-ID: <199805051636.SAA04565@sophie.ethz.ch>


>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

     ......

    PD> I know there's a lot of tradition and conventions in how to setup
    PD> makefiles, but wouldn't it be handy with a "rebuild" type target?

    PD>		rebuild: realclean R

I like your proposition!

(and I won't be the one who writes an ./Install shell script!

 I personally think, 'make <target>' should be enough;
 however, I agree that the documentation could be improved.

 I don't expect people who don't read an ./INSTALL or ./README file
 to install or run R...
)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 18:09:35 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 13:09:35 -0400
Subject: make and all that..
References: <199805051636.SAA04565@sophie.ethz.ch>
Message-ID: <98May5.133306edt.13450@mailgate.bank-banque-canada.ca>

>I don't expect people who don't read an ./INSTALL or ./README file
> to install or run R...

And here I was just thinking how much fun it would be to burn a CD  so everyone
could just stick it in their machine and R would pop up, maybe even with a GUI
interface.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May  5 18:18:02 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 May 1998 19:18:02 +0200
Subject: make and all that..
In-Reply-To: <98May5.133306edt.13450@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 5 May 1998 13:09:35 -0400)
Message-ID: <199805051718.TAA04644@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> I don't expect people who don't read an ./INSTALL or ./README file
    >> to install or run R...

    PaulG> And here I was just thinking how much fun it would be to burn a
    PaulG> CD so everyone could just stick it in their machine and R would
    PaulG> pop up, maybe even with a GUI interface.

Paul, the above behavior ``works'' with binary distributions
	(we have at least Debian and RedHat for Linux),
but never with source code distributions.

We are following  quite a standard approach for source code distributions
having the

	1)
	  ## Edit config.site manually if you want special behavior

	2) 
	  configure
		## configure with arguments if you want....

	3)
	  make

The only thing missing is a ``proper''

	4)
	  make install

which Kurt and Fritz (;-}) will probably provide for R 0.62
which seems to be due currently for Mid-June or so.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 19:22:38 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 14:22:38 -0400
Subject: make and all that..
References: <199805051718.TAA04644@sophie.ethz.ch>
Message-ID: <98May5.144613edt.13447@mailgate.bank-banque-canada.ca>

Martin

Don't take me too seriously on this. I think you are all doing a great job and
I'm amazed at how well everything usually works in R. Besides, if I wanted to
have things automatically execute when I stick in the CD I'd probably be working
in Windows, not on Unix.

About "make install", I usually think of this as a last step, after you've
successfully made everything, to put things in the proper place for users to
have access. Maybe I'm wrong on the usual convention, but I don't think of it as
necessarily starting at the beginning. What I was suggesting with an install
script (setup may be a better name) was something that would make sure
everything was very clean and start at the beginning with configure and make.
This is not a high priority, but it also does not have to be very difficult. It
might simply be a script with lines

make extrasuperclean
configure
make
make doc
make install

or something like that. I realize this may not work for every case, but I think
it can work very well for a large percentage of the simple cases. The main
advantage of something like this is that after a while dumb users like me start
to know the install script does everything and we can just type "install". That
way developers can play with the makefile more easily and not worry too much if
the documentation is completely up-to-date, as long as the install script works
and the documentation still says "use the install script". (I've been on the
other side of this - the problem with documentation is that it's usually for a
previous version. After a while it is much easier to test that a script works
than it is to make sure the documentation is correct.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May  6 11:01:35 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 May 1998 12:01:35 +0200
Subject: min(numeric(0)) = ?   -- proposal for "S incompatible change"
Message-ID: <199805061001.MAA05776@sophie.ethz.ch>

[Same question for  max(.),  cummin(.) and cummax(.)]

In S, S-plus and R, this currently gives NA.

I wonder if it wouldn't make more sense to follow common
mathematical/logical reasoning here:

	min { empty set } = +Inf

	max { empty set } = -Inf

(For integers, these would be  INT_MAX and INT_MIN, respectively).

Maybe this is a real ``first time'':

	I am proposing a change which would lead from
	"S compatible" to  "S incompatible"

	{since I don't expect S to change, 
	 given my recent experience with my plea to change 'n %% m' 
	 (for negative n or m, the result DIFFERS, depending on
	  storage.mode = "integer" or "double" !!!)

	Note that I've spent quite a bit more thought on the "%%" issue 
	than on this one!


Comments?
Pros/ Cons?

Martin Maechler <maechler@stat.math.ethz.ch>			<><
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May  6 11:27:16 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 May 1998 12:27:16 +0200
Subject: min(numeric(0)) = ?  == SORRY:  R already has  +/- Inf
In-Reply-To: <199805061001.MAA05776@sophie.ethz.ch> (message from Martin
 Maechler on Wed, 6 May 1998 12:01:35 +0200)
Message-ID: <199805061027.MAA05825@sophie.ethz.ch>

My last message stated something wrong:

In R 0.62, we already have

    > min(numeric(0))
    [1] Inf
    > max(numeric(0))
    [1] -Inf
    > max(integer(0))
    [1] -Inf
    > min(integer(0))
    [1] Inf

The only change I'd propose is to return 'integer' if all arguments are
'integer', i.e., e.g.,
	
	min(integer(0))  would return  .Machine$int.max

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 14:17:30 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 15:17:30 +0200 (MDT)
Subject: Compiling on SGI Irix 5.3
Message-ID: <199805061317.PAA12784@wrin27.urz.uni-wuppertal.de>

Hello,

I successfully compiled 0.61.3 on SGI Irix 5.3 (CC). But there is a
syntax bug in src/graphics/graphics.c. I append a diff. Please, have a 
look wether the fix is correct! (I'm not shure :-)

Thanks for the SHELL variable in the Makefile's. Please, don't forget
about the problem with externally installed regular expression
libraries (e.g. librx). Perhaps you can improve the configure
script...

Thanks!
HP.

*** src/graphics/graphics.c.origin      Fri Mar 13 11:51:50 1998
--- src/graphics/graphics.c     Tue May  5 15:25:25 1998
***************
*** 805,812 ****
        *ndiv = nu - ns;
  
        if(*ndiv <= 0)
!         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);
!                dx=%g, unit=%3e, ismall=%1d.\n",
                 x1,x2, nd0, cell, *ndiv, ns, nu, dx, unit, (int)i_small);
  }
  
--- 805,812 ----
        *ndiv = nu - ns;
  
        if(*ndiv <= 0)
!         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);"
!                "\t\t dx=%g, unit=%3e, ismall=%1d.\n",
                 x1,x2, nd0, cell, *ndiv, ns, nu, dx, unit, (int)i_small);
  }

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 14:35:57 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 15:35:57 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
Message-ID: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>

I forgot:

"make docs" for LaTeX doesn't collect any information about the
functions. So in Man.dvi the appendix C is empty. A Bug??

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May  6 14:57:22 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 May 1998 15:57:22 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Wed, 6 May 1998 15:35:57 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
Message-ID: <x27m3zzem5.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

> 
> I forgot:
> 
> "make docs" for LaTeX doesn't collect any information about the
> functions. So in Man.dvi the appendix C is empty. A Bug??
> 

In your LaTeX setup, perhaps... No problem on Linux. Or the Makefile
is using stuff that only works with GNU make. You may have to do that
step manually.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 15:41:16 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 16:41:16 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > palme@uni-wuppertal.de (Hubert Palme) writes:
 > 
 > > 
 > > I forgot:
 > > 
 > > "make docs" for LaTeX doesn't collect any information about the
 > > functions. So in Man.dvi the appendix C is empty. A Bug??
 > > 
 > 
 > In your LaTeX setup, perhaps... No problem on Linux. Or the Makefile
 > is using stuff that only works with GNU make. You may have to do that
 > step manually.

(cd ../doc/manual; gmake Man.dvi)
gmake[2]: Entering directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
Collecting components of  pkg-base.tex ..
gmake[2]: execvp: /bin/sh: Arg list too long
gmake[2]: *** [pkg-base.tex] Error 127
gmake[2]: Leaving directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
gmake[1]: [../doc/manual/Man.dvi] Error 2 (ignored)
gmake[1]: Leaving directory `/daten/softy/software/Statistik/R/R-0.61.3/etc'

May be it's time to split this step?!?

How can I do it myself?

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May  6 16:37:31 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 May 1998 17:37:31 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Wed, 6 May 1998 16:41:16 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
Message-ID: <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

>  > > "make docs" for LaTeX doesn't collect any information about the
>  > > functions. So in Man.dvi the appendix C is empty. A Bug??
> 
> (cd ../doc/manual; gmake Man.dvi)
> gmake[2]: Entering directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
> Collecting components of  pkg-base.tex ..
> gmake[2]: execvp: /bin/sh: Arg list too long

Uh, oh... 

$ echo ../../library/base/latex/*.tex | wc
      1     325   11850

A 12K command line! I can believe that that might be a problem on some
systems.

The way to split it must be something along the lines of replacing the
last line of

pkg-base.tex: $(RLIB)/base/latex/*.tex
        @echo 'Collecting components of  $@ ..'
        @sed 's/__PKG__/base/g' Pkg-start.tex | cat - $^ Pkg-end.tex > $@

with
	@cat $(RLIB)/base/latex/[A-e]*.tex > pkg-base.1
	@cat $(RLIB)/base/latex/[f-p]*.tex > pkg-base.2
	@cat $(RLIB)/base/latex/[q-z]*.tex > pkg-base.3
        @sed 's/__PKG__/base/g' Pkg-start.tex |\
		 cat - pkg-base.[123] Pkg-end.tex > $@
	@rm pkg-base.[123]

You may need to adjust the boundaries there of course.

Another option could be


	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
		find $(RLIB)/base/latex/ -name '*.tex' -print |\
		 sort | xargs cat ;\
		 cat Pkg-end.tex) > $@

But does all relevant systems have the xargs command?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May  7 13:59:16 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 May 1998 14:59:16 +0200
Subject: R-beta: 0.61.3: Problems on DEC Unix 4.0
In-Reply-To: <Pine.OSF.3.93.980507083904.16406B-100000@alpha2-stat.sci.uni-klu.ac.at>
 (message from Albrecht Gebhardt on Thu, 7 May 1998 14:51:55 +0200 (MET
 DST))
Message-ID: <199805071259.OAA08264@sophie.ethz.ch>


>> cc: Error: graphics.c, line 808: An unexpected newline character is present
>>  in a string literal.
>>         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);
>> ---------------^
We had already Hubert Palme (SGI Irix) complaining about this and proposing
(a slightly different) patch (I prefer your patch).

This is mea culpa.
It works (w/o patch!), both with Solaris 'cc' and  'gcc'
(and isn't it ANSI C ?).

Sorry!


I just found another buglet (in 0.61.x and 0.62.snap):

    > prod(c(1:3,NA,pi),na.rm=FALSE)
    [1] NA
    > prod(c(1:3,NA,pi),na.rm=TRUE)
    R(bug): [1] NA
    S(ok) : [1] 18.84956

This is in main/summary.c  which I am patching anyway..

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May  7 14:04:49 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 May 1998 15:04:49 +0200
Subject: R-beta: 0.61.3: Problems on DEC Unix 4.0
In-Reply-To: <199805071259.OAA08264@sophie.ethz.ch> (message from Martin
 Maechler on Thu, 7 May 1998 14:59:16 +0200)
Message-ID: <199805071304.PAA08279@sophie.ethz.ch>

Sorry, I am getting old and silly and careless and .....

The  prod(.) problem  is  *NOT*  in 0.61.x !!

R-0.61.3  behaves as it should:

    > prod(c(1:3,NA,pi),na.rm=TRUE)
    [1] 18.84956
    > prod(1:3,NA,pi, na.rm=TRUE)
    [1] 18.84956
---
Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Thu May  7 14:46:11 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Thu, 7 May 1998 15:46:11 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > 
 > Uh, oh... 
 > 
 > $ echo ../../library/base/latex/*.tex | wc
 >       1     325   11850
 > 
 > A 12K command line! I can believe that that might be a problem on some
 > systems.
 > 
 > The way to split it must be something along the lines of replacing the
 > last line of
 > 
 > pkg-base.tex: $(RLIB)/base/latex/*.tex
 >         @echo 'Collecting components of  $@ ..'
 >         @sed 's/__PKG__/base/g' Pkg-start.tex | cat - $^ Pkg-end.tex > $@
 > 
 > with
 > 	@cat $(RLIB)/base/latex/[A-e]*.tex > pkg-base.1
 > 	@cat $(RLIB)/base/latex/[f-p]*.tex > pkg-base.2
 > 	@cat $(RLIB)/base/latex/[q-z]*.tex > pkg-base.3
 >         @sed 's/__PKG__/base/g' Pkg-start.tex |\
 > 		 cat - pkg-base.[123] Pkg-end.tex > $@
 > 	@rm pkg-base.[123]

This works...

 > 
 > You may need to adjust the boundaries there of course.

... without adjusting (the [x-y] boundaries I guess).

 > 
 > Another option could be
 > 
 > 
 > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
 > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
 > 		 sort | xargs cat ;\
 > 		 cat Pkg-end.tex) > $@
 > 
 > But does all relevant systems have the xargs command?

Irix does, but the first solution is better understandable :-)

Thanks!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu May  7 15:20:15 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 May 1998 16:20:15 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Thu, 7 May 1998 15:46:11 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
 <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>
Message-ID: <x24sz29n8g.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

>  > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
>  > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
>  > 		 sort | xargs cat ;\
>  > 		 cat Pkg-end.tex) > $@
>  > 
>  > But does all relevant systems have the xargs command?
> 
> Irix does, but the first solution is better understandable :-)

But the latter *never* creates too long command lines (xargs is built
to handle that). The other one has the problem that we have to guess
relevant splitting points for systems that we do not have...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Thu May  7 15:38:29 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Thu, 7 May 1998 16:38:29 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x24sz29n8g.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
 <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>
 <x24sz29n8g.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805071438.QAA19486@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > palme@uni-wuppertal.de (Hubert Palme) writes:
 > 
 > >  > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
 > >  > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
 > >  > 		 sort | xargs cat ;\
 > >  > 		 cat Pkg-end.tex) > $@
 > >  > 
 > >  > But does all relevant systems have the xargs command?
 > > 
 > > Irix does, but the first solution is better understandable :-)
 > 
 > But the latter *never* creates too long command lines (xargs is built
 > to handle that). The other one has the problem that we have to guess
 > relevant splitting points for systems that we do not have...

So you should use this.

Anyway, the user should have GNU Make installed (the Irix make doesn't
work whith this Makefile). Why not install GNU Findutils if the target
system doesn't have xargs...

But do write this into the INSTALL file!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu May  7 16:38:35 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 May 1998 17:38:35 +0200
Subject: R-beta: scripting with R?
In-Reply-To: Luke Tierney's message of Thu, 7 May 1998 10:03:50 -0500 (CDT)
References: <9805071503.AA23870@nokomis.stat.umn.edu>
Message-ID: <x2yawe851g.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> Unless I'm very much mistaken (which would not be the first time :-))
> I think you can mix console and graphics behavior under Win32 (NT and
> 95, not Win32s) in one application. So having command line options
> that choose between creating a command window or using standard
> input/output would be possible. I haven't looked into th details yet,
> but I'm pretty sure it can be done.

Yes. In particular, a console application can do graphs. But if you
want to support Win32s, you're more or less stuck with the current
model.

Another thing: if you want the windowed text interface (scrollbars!)
launched from console program, I suspect you get a dangling "DOS-box".
I've only seen link-time solutions to that one.

So it's probably easier just to make two different .exe files...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Thu May  7 17:16:17 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 7 May 1998 11:16:17 -0500 (CDT)
Subject: R-beta: scripting with R?
In-Reply-To: <x2yawe851g.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at May 7, 98 05:38:35 pm
Message-ID: <9805071616.AA23929@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Another thing: if you want the windowed text interface (scrollbars!)
> launched from console program, I suspect you get a dangling "DOS-box".
> I've only seen link-time solutions to that one.
> 

I think it may be possible to handle that with some of the console api
functions, but I'm not sure.

> So it's probably easier just to make two different .exe files...

Probably true. But it may make sense to factor it as Win32s/real Win32
rather that console/gui.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu May  7 20:22:35 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Thu, 7 May 1998 20:22:35 +0100 (GMT+0100)
Subject: R-beta: scripting with R? (and also some news on RSXNT)
In-Reply-To: <x290oe9pqv.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at May 7, 98 03:26:00 pm
Message-ID: <19980507192235.11930.qmail@sirio.stat.unipd.it>

Peter Dalgaard BSA writes:
> 
> zk@biocem.univ-bpclermont.fr (Zivan Karaman) writes:
> 
> > Does it work (and how) under Windows? (I'm using the version compiled by
> > Guido Masarotto on an NT4 machine).
> 
> Nope. With Win32 (95/NT) you have to decide whether to write a
> "console application" or a "windowed" one. Guido's is of the latter
> variety and you need the former in order to do redirections etc. 
   
   A simple solution would be to introduce a command-line option, e.g.,
   R -save/nosave -source FileName1 FileName2 .....
   with a obvious meaning, or maybe
   R -save/nosave FileName FileName1 FileName2 .....
   This seems easy to do and can be a interesting option also under
   Unix since, it is only my opinion, it provides a cleaner interface.
   Perhaps, under MSWindows or other "windowed" version, we should
   provide also a -iconic option.
   
   
> It is in fact quite easy to do a console R with the mingw32 tools and
> (probably) also with RSXNT. Start with the Unix sources and throw out
> anything that refuses to compile, such as the X11 stuff and things
> related to system() (the latter might be fakeable, but won't work out
> of the box). 

  I can confirm that it easy. This was my first attempt and in half an
  hour I have a console R working (no dynamic linking, but I 
  suppose that you can include the dynload.c from Windows).
  Anyway, I didn't keep the modified source.
  The problems with the system() stuff under MsWindows is not the
  C system() function that works but the R shell scripts (which
  of course require a Unix shell). 
  I don't know if it is already in the TODO list, but a low
  priority suggestion is to insert somewhere (CFLAGS, Platform.h
  I don't know where) a NOX11 flag.
  
  BTW, this morning, I had some time and I tried to recompile R
  (the last "stable" version, i.e., 0.61.3) with RSXNT.
  It seems to work (but I just tryed a couple of demos
  under Win95). 
  I just used my mingw32 port and the mingw32 winapi header
  and didn't try to use g77 (Ok, I tryed but it didn't work,
  I don't know why).
  I hope to put something available the next week.
  In particular, I want to try to use R.exe as a dll so that
  dynamic libraries can use R_alloc, callS ....
  I was not able to do this with egcs-mingw32 (I tryed all
  the rules that I found to build a relocable exe with the
  gnu binutils but  no one worked; suggestion?) but
  I made some tests with RSXNT (not with R, however) with
  good results. A minor problem is that the standard C stack
  is not large enough to execute all the demos. I can
  increase it but not dinamically. How can I determine a reasonable
  value?
  
  guido masarotto

  

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 20:37:42 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 15:37:42 -0400
Subject: more on library()
Message-ID: <98May11.165202edt.13485@mailgate.bank-banque-canada.ca>

The problem with multiple packages in a library that I reported a few minutes
ago seems to occur only if RLIBS ends in a ":". I was setting
RLIBS=../padi/rlib:$RLIBS and when RLIBS has no value to begin with this causes
the problem.

This is obviously not very urgent as I can get around it easily.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 20:08:14 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 15:08:14 -0400
Subject: library()
Message-ID: <98May11.165206edt.13495@mailgate.bank-banque-canada.ca>

In 0.61.3 there seems to be some problem with multiple packages. library()
recognizes them but library("name") only finds the first one. Suggestions would
be appreciated.

Paul Gilbert
_____

Version 0.61.3  (May 3, 1998)
> library()
Packages in library `/home/res/gilp/padi/pub/padi.v1beta4/R.client/rlibs':

padi            Protocol for Application/Database Interface
syskern         coding kernel for S/R and OS compatability
tframe          Time Frame coding kernel

Packages in library `/home/res4/gilp/R-versions/R-0.61.3/library':

base            The R base package
eda             Exploratory Data Analysis
mva             Classical Multivariate Analysis
stepfun         Step Functions, including Empirical Distributions
> library("padi")
> library("syskern")
Error: There is no package called `syskern'


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Mon May 11 22:13:28 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 May 1998 14:13:28 -0700 (PDT)
Subject: more on library()
In-Reply-To: <98May11.165202edt.13485@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980511141216.8317B-100000@gorn>

On Mon, 11 May 1998, Paul Gilbert wrote:

> The problem with multiple packages in a library that I reported a few minutes
> ago seems to occur only if RLIBS ends in a ":". I was setting
> RLIBS=../padi/rlib:$RLIBS and when RLIBS has no value to begin with this causes
> the problem.
> 

I can't reproduce this even when RLIBS ends in ":". I've tried in both
tcsh and bash, and on Solaris and Debian (ie /bin/sh is bash) systems.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 22:32:42 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 17:32:42 -0400
Subject: more on library() - my error
Message-ID: <98May11.173338edt.13444@mailgate.bank-banque-canada.ca>

Another stupid error on my part. I've just discovered that I managed to install
an empty library. I'm not sure how hard that is to do. I installed the source in
the location where the rlib was suppose to go. This seemed to put in place
enough of the pieces that the name and description were picked up, but the
R/padi.R file didn't get converted to R/padi.

Sorry for the false report.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May 13 08:07:09 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 May 1998 09:07:09 +0200
Subject: readline installation [Re: R-beta: ....]]
Message-ID: <199805130707.JAA10115@sophie.ethz.ch>

I think, we should give more hints on installing / using readline with R.

Maybe there could be one ASCII file
	README-readline-Installation

added to the FTP sites  *and* to R-0.61.3.tar.gz
explaining some the things  Peter Dalgaard just said on R-help.

I agree with Jan that it's a pity for non-programmer-hackers  if they won't
be able to use readline (most probably, these are the ones who will not be
using ESS [= Emacs Speaks Statistics] either!),
or even they won't even realize that there readline *was* available.

Further, for R 0.62, I think we should try quite a bit harder to
have configure searching around for the readline library and include files.
[[maybe, yet again look more closely at what octave does?]]

Martin

----------------

FYI, I got the following, yesterday, privately.

>> Date: Tue, 12 May 1998 10:28:09 +0200 (MET DST)
>> From: Jan Kutylowski <janku@ifi.uio.no>
>> To: maechler@stat.math.ethz.ch
>> CC: ajanku@ulrik.uio.nox
>> In-reply-to: message from Martin Maechler on Fri, 8 May 1998 14:40:28 +0200
>> Subject: Re: R-beta: [ajanku@ulrik.uio.no: R-0.61.3 with readline]

>> MM> This was accidentally sent to 
>> MM> R-help-owner instead of R-help  
>> 
>> thanks for forwarding it
>> 
>> MM> [why on earth ??]
>> 
>> People desperate for command line editing will do about everything to get
>> help after a local guru cannot decipher bysantine intricacies of the
>> makefiles in the current distribution. They will write to the White House,
>> contact scientology, whatever, they may even  come across an old e-mail
>> message and when they see R ... here they go.
>> 
##>> More seriously, this feature of R is so basic that it must be better
##>> documented. Current functionality of R deserves attraction from a broader
##>> range of users than those who can figure out how to modify a particular
##>> piece of one of the many makefiles.
>> 
>> I hope you will find my comment useful.
>> 
>> A. Jan Kutylowski




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 09:42:22 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 10:42:22 +0200 (MDT)
Subject: readline installation [Re: R-beta: ....]]
In-Reply-To: <199805130707.JAA10115@sophie.ethz.ch>
References: <199805130707.JAA10115@sophie.ethz.ch>
Message-ID: <199805130842.KAA20200@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > 
 > Further, for R 0.62, I think we should try quite a bit harder to
 > have configure searching around for the readline library and include files.
 > [[maybe, yet again look more closely at what octave does?]]

Another request being very important for me is to have configure
search for regexpression libraries if there are no POSIX regular
expressions on the local system. Some funktions don't work without
this and it is very hard to configure this manually!

Thamks,
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 09:43:47 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 10:43:47 +0200 (MDT)
Subject: readline installation [Re: R-beta: ....]]
In-Reply-To: <199805130707.JAA10115@sophie.ethz.ch>
References: <199805130707.JAA10115@sophie.ethz.ch>
Message-ID: <199805130843.KAA20203@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > 
 > Further, for R 0.62, I think we should try quite a bit harder to
 > have configure searching around for the readline library and include files.
 > [[maybe, yet again look more closely at what octave does?]]

Another request being very important for me is to have configure
search for regexpression libraries (such as the GNU rx library) if
there are no POSIX regular expressions on the local system. Some
funktions don't work without this and it is very hard to configure
this manually!

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 14:02:26 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 15:02:26 +0200 (MDT)
Subject: R-beta: package ported from S to R
In-Reply-To: <199805131050.MAA10416@sophie.ethz.ch>
References: <199805131030.MAA20912@wrin27.urz.uni-wuppertal.de>
 <199805131050.MAA10416@sophie.ethz.ch>
Message-ID: <199805131302.PAA21564@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > >>>>> "Hubert" == Hubert Palme <palme@uni-wuppertal.de> writes:
 > 
 >     Hubert> Hello, I'm trying to port the S package "print.display" to
 >     Hubert> R. The porting procedure seemed to work, but when I say
 >     Hubert> library(print.display) or library("print.display"), then none
 >     Hubert> of the functions is available. May be, it's because of the dot
 >     Hubert> in the package name?
 > 
 > Not really; I do have package with a "." which works..
 > 
 >     Hubert> What could have happened?
 > no idea.
 > You should send a real "log" of what you did (and the output)
 > -- but NOT to R-help, but rather to R-devel.

OK, This one I send to both, the next one only to r-devel.

 > 
 >     Hubert> The help information is available.
 > 
 >     Hubert> BTW: How can I look up wether the package is really loaded?
 > 
 > search()
 > 
 > should show you (in your case)
 > 
 > [1] ".GlobalEnv"   "package:print.display"  "Autoloads"    "package:base"
 > 		    ---------------------
 > and 
 > 	ls(pos=2)
 > 
 > would show your objects

It is strange: I jist restarted R to try out search(), but now
print.display loads! Don't know what happened... But the next step I
wanted to try was to install the package without dot. So I won't --
Thanks for this hint.

Friedrich Leisch: 
 > 
 > How and where did you install the package? Using the R INSTALL
 > mechanism or by hand? Is it in the library search path .lib.loc?

Yes and yes.

OK, hopefully it stayes loading correctly now, so I'll try to debug
it. There is an unknown function "unix". Is "system" the R
replacement? If yes: There is no "input" parameter. How can I redirect
input with "system"?

Is there also a replacement for "!" ?

Thanks a lot!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 13 17:07:00 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 May 1998 09:07:00 -0700 (PDT)
Subject: R-beta: package ported from S to R
In-Reply-To: <199805131302.PAA21564@wrin27.urz.uni-wuppertal.de>
Message-ID: <Pine.SUN.3.95.980513090201.7060A-100000@chekov>

On Wed, 13 May 1998, Hubert Palme wrote:
> 
> OK, hopefully it stayes loading correctly now, so I'll try to debug
> it. There is an unknown function "unix". Is "system" the R
> replacement? If yes: There is no "input" parameter. How can I redirect
> input with "system"?
> 
> Is there also a replacement for "!" ?
> 

The function system() replaces both of them.  There is no input=
parameter, it looks like we typically use paste() -- for example see
system.file() or help.start().

You can replace unix.shell() with system("/bin/sh") or other shell of your
choice.


Thomas Lumley
------------------------
Biostatistics		
Uni of Washington	
Box 357232		
Seattle WA 98195-7232	
------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 13 19:38:47 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 May 1998 14:38:47 -0400
Subject: all.equal
Message-ID: <98May13.144046edt.13459@mailgate.bank-banque-canada.ca>

I need the function all.equal which is in Splus but not yet in R. Below is a
first cut. Comments would be appreciated.

Paul Gilbert
_______

all.equal <- function(obj1, obj2, ...)
  {if(mode(obj1)      != mode(obj2) )      return("modes differ.")
   if(class(obj1)     != class(obj2))      return("classes differ.")
   if(! all(unlist(attributes(obj1)) == unlist(attributes(obj2))))
                                           return("attributes differ.")
   if(! all(unlist(obj1) == unlist(obj2))) return("values differ.")
   T
  }


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 13 21:01:33 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 May 1998 13:01:33 -0700 (PDT)
Subject: all.equal
In-Reply-To: <98May13.144046edt.13459@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.980513124031.7729A-100000@chekov>

On Wed, 13 May 1998, Paul Gilbert wrote:

> I need the function all.equal which is in Splus but not yet in R. Below is a
> first cut. Comments would be appreciated.
> 

I think it should return T/F rather than text.  You could have the reason
returned as an attribute or printed as a warning().

Some slight fuzziness in equality for real numbers might make this
function more useful (perhaps it should be optional/settable
eg all.equal(a,b,epsilon=100*.Machine()$double.eps) might use

	d<-a-b	
	all(abs(d)<epsilon)
or
	all(abs(d)/(abs(a)+abs(b))<epsilon)

since rounding error can creep in even with highly accurate computations.
For example, the survival4 library Examples suite has things which are
all.equal() in S-PLUS but differ by perhaps 1e-16 or so in R.

The test for equal values currently uses recycling for objects of
different lengths, so 1:5 and rep(1:5,2) are all.equal(). You would
probably want to insert a test on lengths.

Also, the current version crashes if fed objects whose components are not
comparable 
	eg a<-lm(y~x); b<-a; all.equal(a,b) gives
	Error: comparison is possible only for vector types
I don't know if this is right or not.

	-thomas


Thomas Lumley
------------------------
Biostatistics		
Uni of Washington	
Box 357232		
Seattle WA 98195-7232	
------------------------


> 
> all.equal <- function(obj1, obj2, ...)
>   {if(mode(obj1)      != mode(obj2) )      return("modes differ.")
>    if(class(obj1)     != class(obj2))      return("classes differ.")
>    if(! all(unlist(attributes(obj1)) == unlist(attributes(obj2))))
>                                            return("attributes differ.")
>    if(! all(unlist(obj1) == unlist(obj2))) return("values differ.")
>    T
>   }
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 13 22:23:40 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 May 1998 17:23:40 -0400
Subject: all.equal
References: <Pine.SUN.3.95.980513124031.7729A-100000@chekov>
Message-ID: <98May13.172537edt.13443@mailgate.bank-banque-canada.ca>

>I think it should return T/F rather than text.  You could have the reason
>returned as an attribute or printed as a warning().

I'm doing this only for compatability with Splus. In fact, the way I've used it
in my code is

   is.logical(all.equal(...))

which gives the T/F result.

I think the tolerance is a good idea. Thanks for pointing out other problems. I
just fixed one of them. I'll circulate a new version tomorrow.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 14 16:06:11 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 14 May 1998 11:06:11 -0400
Subject: all.equal - cut two, test.equal
Message-ID: <98May14.112616edt.13521@mailgate.bank-banque-canada.ca>

Below is a second cut at all.equal and also a generic function test.equal which
is intended to return a T/F value. The default method uses all.equal, which is
the reason I was looking for all.equal in the first place. Prompted by Thomas
Lumley's observation that a T/F result makes more sense I thought it would be
worthwhile to indicate what I'm really doing.

I have been using test.equal for a few  years in a fairly extensive set of tests
for my time series library. My tests never get to the all.equal part of the
default method, so I have only just noticed the absence of this function. This
approach to testing equality works very well since it allows for a class
specific definition of when things are equal. It was originally suggested to me
by John Chambers, in the context of a question I had about error trapping which,
since I'm on the subject, I will describe shortly in a separate post.

One shortcoming of the following all.equal is that numeric elements of a list
are not compared using tolerance. If anyone has a simple suggestion for
extracting the numeric parts of a list I would like to incorporate it.

Paul Gilbert
_______

test.equal <-function (obj1, obj2, ...)  UseMethod("test.equal")

 test.equal.default <-function (obj1, obj2, ...)
{ if (is.array(obj1))    test.equal.array(obj1, obj2, ...)
   else                         is.logical(all.equal(obj1, obj2, ...))
}

all.equal <- function(obj1, obj2, tolerance=100*Machine()$double.eps)
  {if(mode(obj1)      != mode(obj2) )               return("modes differ.")
   if (length(obj1) != length(obj2) )               return("lengths differ")

   if(is.null(class(obj1)) != is.null(class(obj2))) return("classes differ.")
   else if(!is.null(class(obj1))
           && any(class(obj1) != class(obj2)) )     return("classes differ.")


   if(is.null(attributes(obj1)) != is.null(attributes(obj2)))
                                                    return("attributes differ.")

   else if(!is.null(attributes(obj1))
           && any(unlist(attributes(obj1)) != unlist(attributes(obj2))))
                                                    return("attributes differ.")

   # The mode test above insures that both are numeric if one is. A shortcoming
   # here is that for a list with some numeric components, the components are
   # not compared using the tolerance test.
   if(is.numeric(obj1))
      {if (any(abs(obj1 -obj2) > tolerance))
                               return("value differences exceed tolerance.") }
   else if (! all(unlist(obj1) == unlist(obj2)))     return("values differ.")
   T
  }



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 14 16:21:56 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 14 May 1998 11:21:56 -0400
Subject: error trapping
Message-ID: <98May14.112731edt.13594@mailgate.bank-banque-canada.ca>

One thing I've found missing in S/R is the ability to test error trapping. I
have written a fairly extensive set of tests for my time series library but I
can only test that things work for cases where they are suppose to work. In
several places my code is suppose to recognize error conditions, like invalid
inputs, and make calls to stop() or warn(), but there is no automatic way to
check these in my test suite.

I really would like to be able to write a code testing program which would be
able to specify that I am about to generate a "stop" condition with a given
message, then do it, then continue, accepting that that was the right result.

This is not a high priority, but it is worth keeping on the wish list.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu May 14 16:58:13 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 May 1998 08:58:13 -0700 (PDT)
Subject: error trapping
In-Reply-To: <98May14.112731edt.13594@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980514085355.28600B-100000@gorn>

On Thu, 14 May 1998, Paul Gilbert wrote:

> One thing I've found missing in S/R is the ability to test error trapping. I
> have written a fairly extensive set of tests for my time series library but I
> can only test that things work for cases where they are suppose to work. In
> several places my code is suppose to recognize error conditions, like invalid
> inputs, and make calls to stop() or warn(), but there is no automatic way to
> check these in my test suite.
> 
> I really would like to be able to write a code testing program which would be
> able to specify that I am about to generate a "stop" condition with a given
> message, then do it, then continue, accepting that that was the right result.
> 

I have recently had another need for this.  If you are doing simulations
comparing your (wonderful) new method to someone else's (hopelessly
inferior)  old method and their S-PLUS code crashes about 5% of the time
then it gets very tedious to run several hundred samples
semi-interactively.  Trapping the error would be a lot more convenient
than trying to rewrite someone else's code to fail gracefully.

Of course in your own code you wouldn't dream of doing something like that
;-).

	-thomas




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri May 15 18:32:28 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 15 May 1998 13:32:28 -0400
Subject: couldn't find function "print.tframe"
Message-ID: <98May15.133522edt.13671@mailgate.bank-banque-canada.ca>

I have an object with an attribute "tframe" for which there is a generic method
print.tframe and also a method print.tframe.default defined in a library.
However, when I use attributes(object) I get the message

$tframe
Error: couldn't find function "print.tframe"

It's as if <primitive: attributes> is not looking through the search list?

Any suggestions? (Version 0.61.3)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sat May 16 19:04:33 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 16 May 1998 11:04:33 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <98May15.133522edt.13671@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980516105556.1303A-100000@gorn>

On Fri, 15 May 1998, Paul Gilbert wrote:

> I have an object with an attribute "tframe" for which there is a generic method
> print.tframe and also a method print.tframe.default defined in a library.
> However, when I use attributes(object) I get the message
> 
> $tframe
> Error: couldn't find function "print.tframe"
> 
> It's as if <primitive: attributes> is not looking through the search list?

It's more subtle than this.  If you  do
R> b<-1
R> class(b)<-"foo"
R> print.foo<-function(x) { print("foo\n"); NextMethod()}

Then printing b works perfectly well

R> b
foo
[1] 1
attr(,"class")
[1] "foo"

and the problem arises when you print a list containing b

R> list(b,1)
[[1]]
foo
Error: couldn't find function "print.foo"

The error happens in the NextMethod() call of print.foo(), at line 284 of
objects.c, where do_nextmethod tries to find the function that called it.

	/* set up the arglist */
	s=findFun(CAR(cptr->call), cptr->sysparent);

In the working case, cptr->sysparent is R_GlobalEnv, in the non-working
case it's R_NilValue (ie, NULL)

BTW, the gcc documentation says that if we used gcc -g3 in compiling,
some debuggers would be able to cope with macros like CAR() and TYPEOF().
Does anyone know if gcc is one of them?


Thomas Lumley
------------------------------------------------------+--------
Biostatistics		: "Never attribute to malloc(3) what  :
Uni of Washington	:  can be adequately explained by     :
Box 357232		:  incompetence"                      :
Seattle WA 98195-7232	:				      :
--------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Lumley <thomas@biostat.washington.edu>  Sat May 16 20:39:40 1998
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Sat, 16 May 1998 12:39:40 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <Pine.SOL.3.95.980516105556.1303A-100000@gorn>
Message-ID: <Pine.SOL.3.95.980516114355.1303B-100000@gorn>


Ok. The print.tframe problem appears to be as follows:

When printList has a list element that is an object it creates a call to
print() with the evaluated object and evaluates that call in the
environment R_NilValue (ie NULL).

If this object has class "foo" print.foo() is called. If there is a 
NextMethod() in print.foo, do_nextmethod  reaches back to find
the environment that print() was called from and looks for the
definition of print.foo() that applies there, in order to get the formal
arguments right.  This fails, since print() was 'called' from the NULL
environment, where print.foo() is not defined.

You can reproduce this in interpreted code by
R> b<-1              
R> class(b)<-"foo" 
R> print.foo<-function(x){cat("foo\n");NextMethod()}
R> eval(expression(print(structure(1,class="foo"))),NULL)

The question is how to find the right environment to evaluate the call,
since printList doesn't know what environment print() was called from. 
R_GlobalEnv doesn't seem right, since print.foo may not be defined there. 

One solution would be to explicitly pass the environment down, but this
takes a lot of changes, some of them to functions called from outside
print.c.  I'm looking at this but would welcome a better solution.


Thomas Lumley
------------------------------------------------------+--------
Biostatistics		: "Never attribute to malloc(3) what  :
Uni of Washington	:  can be adequately explained by     :
Box 357232		:  incompetence"                      :
Seattle WA 98195-7232	:				      :
---------------------------------------------------------------




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun May 17 11:08:18 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 May 1998 12:08:18 +0200
Subject: couldn't find function "print.tframe"
In-Reply-To: Thomas Lumley's message of Sat, 16 May 1998 12:39:40 -0700 (PDT)
References: <Pine.SOL.3.95.980516114355.1303B-100000@gorn>
Message-ID: <x2wwblryzx.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> Ok. The print.tframe problem appears to be as follows:
> 
> When printList has a list element that is an object it creates a call to
> print() with the evaluated object and evaluates that call in the
> environment R_NilValue (ie NULL).
> 
> If this object has class "foo" print.foo() is called. If there is a 
> NextMethod() in print.foo, do_nextmethod  reaches back to find
> the environment that print() was called from and looks for the
> definition of print.foo() that applies there, in order to get the formal
> arguments right.  This fails, since print() was 'called' from the NULL
> environment, where print.foo() is not defined.
> 
> You can reproduce this in interpreted code by
> R> b<-1              
> R> class(b)<-"foo" 
> R> print.foo<-function(x){cat("foo\n");NextMethod()}
> R> eval(expression(print(structure(1,class="foo"))),NULL)

Hmmmm....

Here's another aspect of the problem:

I tried creating a new print function with a call to sys.status
inserted befor the UseMethod, after previously doing a debug(print),
and:

>  eval(expression(print(structure(1,class="foo"))),NULL)
debugging in: print(structure(1, class = "foo"))
foo
Error: couldn't find function "print.foo"

So it is still calling the old print (in package:base). The new one
would have debugging turned off for one thing. (BTW: Why doesn't the
debugger stop and wait for input before doing the UseMethod call?)

In contrast,
> b
$sys.calls
$sys.calls[[1]]
print(structure(1, class = "foo"))

<...etc...>
foo
[1] 1
attr(,"class")
[1] "foo"


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sun May 17 21:26:25 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sun, 17 May 1998 13:26:25 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <x2wwblryzx.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SOL.3.95.980517132310.4388A-100000@gorn>

On 17 May 1998, Peter Dalgaard BSA wrote:

> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > 
> > 
> > Ok. The print.tframe problem appears to be as follows:
> > 
> > When printList has a list element that is an object it creates a call to
> > print() with the evaluated object and evaluates that call in the
> > environment R_NilValue (ie NULL).
> > 
> > If this object has class "foo" print.foo() is called. If there is a 
> > NextMethod() in print.foo, do_nextmethod  reaches back to find
> > the environment that print() was called from and looks for the
> > definition of print.foo() that applies there, in order to get the formal
> > arguments right.  This fails, since print() was 'called' from the NULL
> > environment, where print.foo() is not defined.
> > 
> > You can reproduce this in interpreted code by
> > R> b<-1              
> > R> class(b)<-"foo" 
> > R> print.foo<-function(x){cat("foo\n");NextMethod()}
> > R> eval(expression(print(structure(1,class="foo"))),NULL)
> 
> Hmmmm....
> 
> Here's another aspect of the problem:
> 
> I tried creating a new print function with a call to sys.status
> inserted befor the UseMethod, after previously doing a debug(print),
> and:
> 
> >  eval(expression(print(structure(1,class="foo"))),NULL)
> debugging in: print(structure(1, class = "foo"))
> foo
> Error: couldn't find function "print.foo"
> 
> So it is still calling the old print (in package:base). The new one
> would have debugging turned off for one thing. (BTW: Why doesn't the
> debugger stop and wait for input before doing the UseMethod call?)

This is for the same reason.  In environment NULL you still have access to
the system environment but not to the global environment.  Look at
	eval(expression(print),NULL)
to see that it is indeed using the old version.  Fixing the environment
would fix this too.

I think the debugger doesn't stop and wait because it has problems with
functions that don't have braces {} enclosing them.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May 18 00:27:31 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 May 1998 01:27:31 +0200
Subject: couldn't find function "print.tframe"
In-Reply-To: Thomas Lumley's message of Sun, 17 May 1998 13:26:25 -0700 (PDT)
References: <Pine.SOL.3.95.980517132310.4388A-100000@gorn>
Message-ID: <x2af8geavw.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> I think the debugger doesn't stop and wait because it has problems with
> functions that don't have braces {} enclosing them.

Oh. And here I was, thinking that it was due to some aspect of the
implementation of method dispatching...

You're absolutely right:
> f<-function(x)x
> debug(f)
> f(3)
debugging in: f(3)
exiting from: f(3)
[1] 3

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rgentlem@stat.auckland.ac.nz  Mon May 18 01:11:17 1998
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Mon, 18 May 1998 12:11:17 +1200 (NZST)
Subject: No subject
Message-ID: <199805180011.MAA22223@stat1.stat.auckland.ac.nz>


> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > I think the debugger doesn't stop and wait because it has problems with
> > functions that don't have braces {} enclosing them.
> 
> Oh. And here I was, thinking that it was due to some aspect of the
> implementation of method dispatching...
> 
> You're absolutely right:
> > f<-function(x)x
> > debug(f)
> > f(3)
> debugging in: f(3)
> exiting from: f(3)
> [1] 3
> 

  Yep, if you have a look we check the debug flag in do_begin (if an opening
  {), short functions don't have these. My recollection is that Splus puts
  one on every function but we decided not to. The debug flag is in
  the header of the actual function SEXP (look in src/include/Defn.h).
  
  Most of the behaviour of debug is in eval.c (do_while, do_for, and friends).
  
  
  robert
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon May 18 14:45:27 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 18 May 1998 15:45:27 +0200
Subject: R 0.62 ("snapshot") -- Now Search Engine in help.start()
Message-ID: <199805181345.PAA17553@sophie.ethz.ch>

You can look at it at
	http://www.stat.math.ethz.ch/R-alpha/

and clicking on  [R manual].
Besides  "Packages" and "Functions", there's know a
	"Search Engine & Keywords"
provided by Fritz Leisch (Wien).
["Keywords" are unfinished, but searching *is* useful.]

Thank you, Fritz!
-- Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon May 18 14:54:26 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 18 May 1998 15:54:26 +0200 (CEST)
Subject: R make process
Message-ID: <13664.15762.998396.781063@galadriel.ci.tuwien.ac.at>


Hi,

I've just committed a few changes to the R make process, such that we
support the standard

	./configure
	make
	make install

triple from now on. It should be included in tomorrows snapshot
sources. The default installation directory hierarchy should be
/usr/local on most systems, but this may vary.

The installation prefix can be set using

	./configure --prefix=3D...

and you can see the install dir in the status notes of configure.

R is installed into:

	$prefix/lib/R		RHOME
	$prefix/man/man1	R.1
	$prefix/bin		R Rd2txt Rdconv Rdindex Sd2Rd

Please let me know if there are any troubles on your system, currently
it is tested on Debian Linux only.

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Mon May 18 14:56:48 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Mon, 18 May 1998 15:56:48 +0200 (MDT)
Subject: get() in R and S
Message-ID: <199805181356.PAA13042@wrin27.urz.uni-wuppertal.de>

Hi there,

is there any complete list of differences between R and S? I only saw
one in the FAQ and it seems to be incomplete.

I specially want to know what the frame parameter in the S version of
get() means and and how I can replace it in R.

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Mon May 18 15:36:15 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Mon, 18 May 1998 16:36:15 +0200 (MDT)
Subject: Another compatibility problem S => R
Message-ID: <199805181436.QAA13326@wrin27.urz.uni-wuppertal.de>

Hello,

after the line 

  cat("%",as.character(as.name(match.call())), "\n%\n", file=fi, append=T)

R complains about

  Error in as.name(x) : character argument required

Is it sufficient to delete as.name()?

After doing that, R complains

  Error: comparison is possible only for vector types

Don't know which function call. Can you give me a hint how to debug
it? There seems to be a lot of patameter type incompatibilities :-(

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May 18 15:52:04 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 May 1998 16:52:04 +0200
Subject: Another compatibility problem S => R
In-Reply-To: palme@uni-wuppertal.de's message of Mon, 18 May 1998 16:36:15 +0200 (MDT)
References: <199805181436.QAA13326@wrin27.urz.uni-wuppertal.de>
Message-ID: <x2emxrbpij.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

> 
> Hello,
> 
> after the line 
> 
>   cat("%",as.character(as.name(match.call())), "\n%\n", file=fi, append=T)
> 
> R complains about
> 
>   Error in as.name(x) : character argument required

Hmm. The Splus help page says:

       as.name coerces x to an object of mode  "name".   This  is
       useful when x is of mode "character".

The whole construction seems to be doing the same as
deparse(match.call()), which works in *both* languages.

I don't think we want to become compatible in this case.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May 20 09:08:28 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 May 1998 10:08:28 +0200
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: <9805200750.AA17895@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 20 May 1998 09:50:45 +0200 (MET DST))
Message-ID: <199805200808.KAA22220@sophie.ethz.ch>

Jim,
you should ask questions like these on R-devel.
There are more proficient Linux gurus on there than me [that's why I CC:].

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> Martin, Here is an additional problem with my libraries: the
    Jim> Kalman filtering, written in Fortran, uses complex arithmetic.

    Jim> On my Red Hat 5, the f2c library is included by the -lf2c in the
    Jim> Makefile.
makes sense.

    Jim> However, my son has just installed a new version of
    Jim> Slackware and we can find no way to convince gcc to include the
All I ever hear about Slackware is that you should not use it anymore...
[I used to have a 0.99x version of Linux.. and *did* have Slackware then..]

    Jim> f2c library. (With the previous version of Slackware that he had,
    Jim> it could be tricked by placing -L/usr/lib right before -lf2c,
    Jim> something I never understood.)

-L/usr/lib  says to that -lf2c should also search for libf2c.a or .so
 in /usr/lib.
However that is standard (in Linux), so I don't understand either.

The above problem sounds like your installation is broken to some extent...

    Jim> Of course, R crashes when we run my
    Jim> programs because it does not find the complex functions.

    Jim> I remember that there was some discussion of such problems on the
    Jim> list quite a while ago. Is any solution in sight?

The new 0.62 branch of R  *REQUIRES* either a fortran compiler or f2c.
So, your problems might have resolved by then.
However, given what you tell above,  I assume that your Slackware-Linux
system has some misconfigurations that should be resolved anyway...

Martin


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 15:10:48 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 10:10:48 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <199805200808.KAA22220@sophie.ethz.ch>
Message-ID: <98May20.101620edt.13443@mailgate.bank-banque-canada.ca>

Jim

I don't think your libf2c problems are related to your installation, Slackware,
or even to Linux. I have the same trouble in RedHat and in Solaris. I think the
problem is whether it is the responsibility of a dynamically loaded .so to
knowing where libraries are, or if R.binary should know that. In my rather crude
and uninformed experimentation I could not discover a way to make my .so know
and pass along that information, so I have concluded that it must be R.binary's
responsibility.

I posted a question on this some time ago, to which Ross acknowledged there is a
problem and suggested I contact Kurt. In the end I didn't do that because I
discovered that some rather trivial changes to my fortran resulted in calls to
pow_di rather than pow_ii and this fixed my problem.

I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
that, since, as far as I know, you and I are the only ones who have been having
this difficulty. I suspect it will become more of an issue as more fortran is
ported.

Below is a copy of the exchange from my previous posting.

Paul Gilbert
________
> Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
>
> > I have a problem with my dynamically loaded code in R not finding
> > pow_ii, which for some time I thought was because library f2c is
> > not on my Sparcstation.  > > However, I have now been experiencing
> > the same problem in Linux, with all the  proper libraries in place.
> >
> > My incomplete understanding of elf and shared libraries does not
> > help, but when compiling a complete program I usually muddle through.
> > However, in the case of dynamically loading code into R, I am not
> > sure whether it is my dse.so or R which should have the knowledge
> > of where to find /usr/lib/libf2c.so*. I haven't  had much success
> > trying to configure so that that information is in dse.so. None
> > of the usual things seem to help, so I suspect R itself needs to
> > be able to find the library. If someone can explain this I would
> > very much appreciate it.

DB> One thing you can do is to check the R.binary file with "nm -g" to find
DB> out what symbols are defined in it.  On my machine R.binary includes
DB> pow_dd and pow_di but not pow_ii.

This is a general problem we need a solution to.  Recently, Kurt Hornik
has changed the configuration procedures so that fortran is located and
used to load R.  I thought this would fix this kind of problem.
(Any references to fortran things like pow_ii should be removed from the
C sources).

I'd suggest that you get in touch with Kurt directly:
        Kurt.Hornik@ci.tuwien.ac.at
to sort this out.

        Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 20 17:59:06 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 May 1998 09:59:06 -0700 (PDT)
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: <98May20.101620edt.13443@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980520095251.22293B-100000@gorn>

On Wed, 20 May 1998, Paul Gilbert wrote:


> I don't think your libf2c problems are related to your installation, Slackware,
> or even to Linux. I have the same trouble in RedHat and in Solaris. I think the
> problem is whether it is the responsibility of a dynamically loaded .so to
> knowing where libraries are, or if R.binary should know that. In my rather crude
> and uninformed experimentation I could not discover a way to make my .so know
> and pass along that information, so I have concluded that it must be R.binary's
> responsibility.
> 
<snip>
> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
> that, since, as far as I know, you and I are the only ones who have been having
> this difficulty. I suspect it will become more of an issue as more fortran is
> ported.
> 

If this is the problem it should be fixed in 0.62, since R.binary will
have to know how to find the local fortran compiler and libraries to run
itself. You can then distribute the fortran code and it will be compiled
and linked the same way as the built-in fortran. 

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May 20 19:00:56 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 20 May 1998 20:00:56 +0200
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: Martin Maechler's message of Wed, 20 May 1998 10:08:28 +0200
References: <199805200808.KAA22220@sophie.ethz.ch>
Message-ID: <x2iun0es9z.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>     Jim> On my Red Hat 5, the f2c library is included by the -lf2c in the
>     Jim> Makefile.
> makes sense.
> 
>     Jim> However, my son has just installed a new version of
>     Jim> Slackware and we can find no way to convince gcc to include the
> All I ever hear about Slackware is that you should not use it anymore...
> [I used to have a 0.99x version of Linux.. and *did* have Slackware then..]
> 
>     Jim> f2c library. (With the previous version of Slackware that he had,
>     Jim> it could be tricked by placing -L/usr/lib right before -lf2c,
>     Jim> something I never understood.)
> 
> -L/usr/lib  says to that -lf2c should also search for libf2c.a or .so
>  in /usr/lib.
> However that is standard (in Linux), so I don't understand either.

I've seen some similar cases in the distant past, apparently related
to argument order of the link command arguments. If all else fails,
one can always specify /usr/lib/libf2c.so directly. Provided that the
file is actually there, of course...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 19:17:15 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 14:17:15 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <Pine.SOL.3.95.980520095251.22293B-100000@gorn>
Message-ID: <98May20.142257edt.13457@mailgate.bank-banque-canada.ca>

<snip>
>> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of

>> that, since, as far as I know, you and I are the only ones who have been
having
>> this difficulty. I suspect it will become more of an issue as more fortran is

>> ported.

>If this is the problem it should be fixed in 0.62, since R.binary will
>have to know how to find the local fortran compiler and libraries to run
>itself. You can then distribute the fortran code and it will be compiled
>and linked the same way as the built-in fortran.

This assumes that everyone who wants to run the code has a fortran compiler, not
just f2c. This is not really a very good assumption, especially since the
current version of g77 seems to have a bug and won't compile my code. In
general, fortran compilers are much less widely available than C compilers. I
think that distributing the code as generated by f2c will help a lot of people,
but this sometimes means using libf2c. (I've even found that using gcc on the
f2c code works better in Splus than trying to use a fortran compiler.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 19:24:17 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 14:24:17 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <199805200808.KAA22220@sophie.ethz.ch> <x2iun0es9z.fsf@blueberry.kubism.ku.dk>
Message-ID: <98May20.143013edt.13459@mailgate.bank-banque-canada.ca>

>If all else fails,
>one can always specify /usr/lib/libf2c.so directly. Provided that the
>file is actually there, of course...

In fact, one cannot. At least I couldn't get it to work, and I tried many
variations on this. The problem seems to be that this provides the information
for the purposes of generating the .so file, but it gets lost somewhere when you
try to dyn.load the .so into R.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Wed May 20 19:41:46 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 20 May 1998 13:41:46 -0500
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: Paul Gilbert's message of Wed, 20 May 1998 14:17:15 -0400
References: <Pine.SOL.3.95.980520095251.22293B-100000@gorn> <98May20.142257edt.13457@mailgate.bank-banque-canada.ca>
Message-ID: <6rbtsszswl.fsf@verdi.stat.wisc.edu>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> <snip>
> >> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
> 
> >> that, since, as far as I know, you and I are the only ones who have been
> having
> >> this difficulty. I suspect it will become more of an issue as more fortran is
> 
> >> ported.
> 
> >If this is the problem it should be fixed in 0.62, since R.binary will
> >have to know how to find the local fortran compiler and libraries to run
> >itself. You can then distribute the fortran code and it will be compiled
> >and linked the same way as the built-in fortran.
> 
> This assumes that everyone who wants to run the code has a fortran compiler, not
> just f2c. This is not really a very good assumption, especially since the
> current version of g77 seems to have a bug and won't compile my code. In
> general, fortran compilers are much less widely available than C compilers. I
> think that distributing the code as generated by f2c will help a lot of people,
> but this sometimes means using libf2c. (I've even found that using gcc on the
> f2c code works better in Splus than trying to use a fortran compiler.)

But "fortran compiler" can mean something like a script that calls f2c
then calls gcc on the result.  We have one called "fort77" in the
Debian Linux distribution.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 21 16:06:55 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 21 May 1998 11:06:55 -0400
Subject: all.equal - cut three
Message-ID: <98May21.111256edt.13457@mailgate.bank-banque-canada.ca>

Below is a third cut at all.equal and the generic function test.equal which
is intended to return a T/F value. There was a suggestion that "is.equal" rather
than "test.equal" might be considered as a name. I have mixed feelings about
this. I associate the  "is" functions with inheritance rather than comparisons,
but the "equal" part of the name makes it clear. How do others feel about this?

The default method for all.equal now tries to recursively extract all numeric
elements and compare using tolerance. It also tries to do a relative comparison
rather than an absolute comparison, except for very small numbers. I hope
someone with more experience than I have will examine this part carefully!

Paul Gilbert
_______

test.equal <-function (obj1, obj2, ...)  UseMethod("test.equal")

 test.equal.default <-function (obj1, obj2, ...)
{ if (is.array(obj1))    test.equal.array(obj1, obj2, ...)
   else                         is.logical(all.equal(obj1, obj2, ...))
}


all.equal <- function(obj1, obj2,...) {UseMethod("all.equal")}

all.equal.default <- function(obj1, obj2, tolerance=.Machine$double.eps)
  {if(mode(obj1)      != mode(obj2) )               return("modes differ.")
   if (length(obj1) != length(obj2) )               return("lengths differ")

   if(is.null(class(obj1)) != is.null(class(obj2))) return("classes differ.")
   else if(!is.null(class(obj1))
           && any(class(obj1) != class(obj2)) )     return("classes differ.")


   if(is.null(attributes(obj1)) != is.null(attributes(obj2)))
                                                    return("attributes differ.")

   else if(!is.null(attributes(obj1))
           && any(unlist(attributes(obj1)) != unlist(attributes(obj2))))
                                                    return("attributes differ.")

   cull.numeric  <- function(obj, r=NULL) {
      if (is.null(obj) | (length(obj) == 0)) return(r)
      else if (is.numeric(obj)) return(c(r,obj))
      else if (is.list(obj))
           return( c(cull.numeric(obj[[1]], r), cull.numeric(obj[-1])) )
      else return(r)
     }

   z1 <- cull.numeric(obj1)
   if(! is.null(z1))
      {z2 <- cull.numeric(obj2)
       if (length(z1) != length(z2) )  return("length of numeric parts differ")
       M <- pmax(abs(z1), abs(z2))
       # next line results in absolute rather than relative comparison for
       # very small numbers.
       M[ M < 100 *tolerance] <- 1
       if (any(abs(z1 -z2) > tolerance * M))
                       return("numeric value differences exceed tolerance.")
      }
  # next comparison is really for non-numeric values but also compares
  # numeric values to the tolerance of the character representation in unlist.
   if (! all(unlist(obj1) == unlist(obj2)))     return("values differ.")
   T
  }





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri May 22 21:48:52 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 May 1998 13:48:52 -0700 (PDT)
Subject: matrix multiplication of vectors
In-Reply-To: <98May21.111256edt.13457@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980522134730.9121B-100000@gorn>


An incompatibility:
S-PLUS
> x<-1:3
>  x%*%x
     [,1] 
[1,]   14
>  x%*%t(x)
     [,1] [,2] [,3] 
[1,]    1    2    3
[2,]    2    4    6
[3,]    3    6    9

R
> x<-1:3
> x%*%x
     [,1]
[1,]   14
> x%*%t(x)
Error in x %*% t(x) : non-conformable arguments


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon May 25 23:25:24 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 26 May 1998 10:25:24 +1200 (NZST)
Subject: RFC: spline / splinefun (etc) amalgamation
Message-ID: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>

At present R has separate functions "spline" and "splinefun".  The first
of these carries out spline interpolation of a data set and returns the
interpolated values; the second returns the interpolating function itself
(approx and approxfun are similar).

I would like to combine these into a single function "spline" with
an (optional) argument which determines which kind of value is returned.
E.g.

	spline(x,y)        # return interpolated function
	spline(x,y,fun=T)  # return the interpolating function

I would also like to propose this as a standard for smoothing and
interpolating functions.  This has a couple of advantages - fewer
names to remember and, the ability to use the function form in
model fitting code ("predict" for example).

Any objections or comments?

	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue May 26 00:09:45 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 May 1998 16:09:45 -0700 (PDT)
Subject: dependencies in .so files
In-Reply-To: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.LNX.3.96.980525160616.26582A-100000@buffy>


I've been trying to get Matt Calder's S compiler to work in R using R
COMPILE and R SHLIB so it will be fairly platform-independent.  

I'm sure someone has claimed in the past that it is possible/easy to
dyn.load() two dynamic libraries and have one call functions in the other.
I can't get it to work (Red Hat 5.0/R0.61.1ish). It doesn't seem to matter
what order I load them in, they can't find each other.

Any ideas?

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue May 26 06:55:49 1998
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 26 May 1998 07:55:49 +0200 (CEST)
Subject: RFC: spline / splinefun (etc) amalgamation
In-Reply-To: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
References: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
Message-ID: <13674.22885.136914.353526@pc87.maho.magnaeu.com>

>>>>> Ross Ihaka writes:

> At present R has separate functions "spline" and "splinefun".  The first
> of these carries out spline interpolation of a data set and returns the
> interpolated values; the second returns the interpolating function itself
> (approx and approxfun are similar).

> I would like to combine these into a single function "spline" with
> an (optional) argument which determines which kind of value is returned.
> E.g.

> 	spline(x,y)        # return interpolated function
> 	spline(x,y,fun=T)  # return the interpolating function

> I would also like to propose this as a standard for smoothing and
> interpolating functions.  This has a couple of advantages - fewer
> names to remember and, the ability to use the function form in
> model fitting code ("predict" for example).

> Any objections or comments?

Perhaps
	smoothing.or.interpolating.fun(data)
should in general return the FUNCTION (more precisely, a function
object of an appropriate class), and the values would be obtained
via predict()?

-k

(May not be BBC, though ...)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May 26 07:58:52 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 26 May 1998 08:58:52 +0200
Subject: RFC: spline / splinefun (etc) amalgamation
In-Reply-To: <13674.22885.136914.353526@pc87.maho.magnaeu.com> (message from
 Kurt Hornik on Tue, 26 May 1998 07:55:49 +0200 (CEST))
Message-ID: <199805260658.IAA02570@sophie.ethz.ch>

>>>>> "KH" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Ross Ihaka writes:
    >> At present R has separate functions "spline" and "splinefun".  The
    >> first of these carries out spline interpolation of a data set and
    >> returns the interpolated values; the second returns the
    >> interpolating function itself (approx and approxfun are similar).

    >> I would like to combine these into a single function "spline" with
    >> an (optional) argument which determines which kind of value is
    >> returned.  E.g.

    >> spline(x,y) # return interpolated function spline(x,y,fun=T) #
    >> return the interpolating function

    >> I would also like to propose this as a standard for smoothing and
    >> interpolating functions.  This has a couple of advantages - fewer
    >> names to remember and, the ability to use the function form in model
    >> fitting code ("predict" for example).

    >> Any objections or comments?

Very good idea [including the "standard"!]

    KH> Perhaps smoothing.or.interpolating.fun(data) should in general
    KH> return the FUNCTION (more precisely, a function object of an
    KH> appropriate class), and the values would be obtained via predict()?

I do prefer Ross' version:

1. For a novice or average user, it is more intuitive to get a list /
   data.frame as a result by default.

2. compatibility
    KH> (May not be BBC, though ...)
   yes

3. The ($x, $y) list is simpler AND smaller (in memory).

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 13:29:05 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 13:29:05 +0100 (GMT+0100)
Subject: A problem of etiquette
Message-ID: <19980527122905.99.qmail@sirio.stat.unipd.it>

Perhaps, the question is silly. But, I prefer asking it before making a 
mistake.

I have just packed a binary distribution of R for Windows3.1/Win32s.
It is equivalent to the previous one for Win95/NT (R-0.61.3 +
many of the available packages) and it is compiled with egcs-mingw32
(GPL not a commercial compiler).

Now, in preparing the README, I put the following sentence:
-----------------------------------------------------------------------------
This distribution is not formally maintained, but I am interested 
in hearing (on r-devel and r-help) from people who have problems with it, 
although I may not be able to solve them.
-----------------------------------------------------------------------------

The etiquette question is: can I ask people to use r-devel/r-help
although I am not managing these lists?

guido m.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May 27 13:10:56 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 May 1998 14:10:56 +0200
Subject: A problem of etiquette
In-Reply-To: guido@sirio.stat.unipd.it's message of Wed, 27 May 1998 13:29:05 +0100 (GMT+0100)
References: <19980527122905.99.qmail@sirio.stat.unipd.it>
Message-ID: <x2pvgzzzfz.fsf@blueberry.kubism.ku.dk>

guido@sirio.stat.unipd.it writes:

> The etiquette question is: can I ask people to use r-devel/r-help
> although I am not managing these lists?
> 
> guido m.

Yes, of course. These fora are for anyone interested in helping with
development of R, respectively asking and answering questions about
its use. This means not just the core R but also add-on packages and -
as in your case - ports to other systems. If the lists overflow, we
can always set up a special list for R-Win, but I don't think that
will be necessary.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed May 27 13:12:14 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 27 May 1998 14:12:14 +0200 (CEST)
Subject: A problem of etiquette
In-Reply-To: <19980527122905.99.qmail@sirio.stat.unipd.it>
References: <19980527122905.99.qmail@sirio.stat.unipd.it>
Message-ID: <13676.798.218392.320599@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 27 May 1998 13:29:05 +0100 (GMT+0100),
>>>>> guido  (g) wrote:

g> Perhaps, the question is silly. But, I prefer asking it before making =
a=20
g> mistake.

g> I have just packed a binary distribution of R for Windows3.1/Win32s.
g> It is equivalent to the previous one for Win95/NT (R-0.61.3 +
g> many of the available packages) and it is compiled with egcs-mingw32
g> (GPL not a commercial compiler).

g> Now, in preparing the README, I put the following sentence:
g> ----------------------------------------------------------------------=
-------
g> This distribution is not formally maintained, but I am interested=20
g> in hearing (on r-devel and r-help) from people who have problems with =
it,=20
g> although I may not be able to solve them.
g> ----------------------------------------------------------------------=
-------

g> The etiquette question is: can I ask people to use r-devel/r-help
g> although I am not managing these lists?

I think you're being too modest ... you put a lot of effort in
preparing the binary distribution of R!

The lists are about discussing all aspects of R, including ports, etc.

Its perfectly fine to put the above statement into the README.

Best,

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@luc.ac.be  Wed May 27 15:40:32 1998
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Wed, 27 May 1998 16:40:32 +0200 (MET DST)
Subject: Problems compiling libraries with todays snapshot.
Message-ID: <9805271440.AA01439@alpha.luc.ac.be>

I am currently running Slakware V3.4 with g77 and R is a 0.62 snapshot of the 27th of May.
There appear to be linking problems with the libraries.
The error output from mva and eda can be found below.
My own libraries also have similar problems.

Errors when compiling mva:

116 /usr/local/src/R/src/library #R INSTALL mva
Warning:  package `-html' does not exist
Warning:  package `-latex' does not exist
Installing package `mva' ...
libs
ld  -o mva.so dblcen.o dist.o hclust.o
ld: warning: cannot find entry symbol _start; defaulting to 08048080
dist.o: In function `euclidean':
/usr/local/src/R/src/library/mva/src/dist.c:43: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:43: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:51: undefined reference to `realNA'
/usr/local/src/R/src/library/mva/src/dist.c:53: undefined reference to `sqrt'
dist.o: In function `maximum':
/usr/local/src/R/src/library/mva/src/dist.c:64: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:64: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:74: undefined reference to `realNA'
dist.o: In function `manhattan':
/usr/local/src/R/src/library/mva/src/dist.c:85: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:85: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:92: undefined reference to `realNA'
dist.o: In function `canberra':
/usr/local/src/R/src/library/mva/src/dist.c:105: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:105: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:112: undefined reference to `realNA'
dist.o: In function `binary':
/usr/local/src/R/src/library/mva/src/dist.c:127: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:127: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:140: undefined reference to `realNA'
dist.o: In function `dist':
/usr/local/src/R/src/library/mva/src/dist.c:169: undefined reference to `error'
make: *** [mva.so] Error 1
cp: *.so: No such file or directory

Compiling eda:

117 /usr/local/src/R/src/library #R INSTALL eda
Installing package `eda' ...
libs
ld  -o eda.so line.o smooth.o
ld: warning: cannot find entry symbol _start; defaulting to 08048080
line.o: In function `il':
/usr/local/src/R/src/library/eda/src/line.c:5: undefined reference to `floor'
line.o: In function `iu':
/usr/local/src/R/src/library/eda/src/line.c:10: undefined reference to `ceil'
line.o: In function `line':
/usr/local/src/R/src/library/eda/src/line.c:23: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:48: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:54: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:61: undefined reference to `rsort'
make: *** [eda.so] Error 1
cp: *.so: No such file or directory
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From wsimpson@uwinnipeg.ca  Wed May 27 16:10:48 1998
From: wsimpson@uwinnipeg.ca (Bill Simpson)
Date: Wed, 27 May 1998 10:10:48 -0500 (CDT)
Subject: Problems compiling libraries with todays snapshot.
In-Reply-To: <9805271440.AA01439@alpha.luc.ac.be>
Message-ID: <Pine.OSF.3.95.980527100912.8559A-100000@io.uwinnipeg.ca>

I am running 62.0 April 12 1998 under Slackware 3.4.0, and it compiled
painlessly (if that is any help at all). BTW with Slackware you've got to
make sure you've got readline library installed.  It isn't there in the
default distribution.

Bill

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 19:50:17 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 19:50:17 +0100 (GMT+0100)
Subject: dependencies in .so files
Message-ID: <19980527185017.2030.qmail@sirio.stat.unipd.it>

 Thomas Lumley writes:
 > 
 > 
 > I've been trying to get Matt Calder's S compiler to work in R using R
 > COMPILE and R SHLIB so it will be fairly platform-independent.  
 > 
 > I'm sure someone has claimed in the past that it is possible/easy to
 > dyn.load() two dynamic libraries and have one call functions in the other.
 > I can't get it to work (Red Hat 5.0/R0.61.1ish). It doesn't seem to matter
 > what order I load them in, they can't find each other.
 > 
 > Any ideas?
 
 >From the dlopen man page:
 void *dlopen (const char *filename, int flag);
 ................................................
 RTLD_GLOBAL may be or'ed with flag
 in which case the external symbols defined in the library will be
 made available to subsequently loaded libraries.
 
 So, I try: 
 1) I modify src/unix/dynload.c changing the flag of dlopen
    from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
 2) build two simple shared libraries the second calling a routine 
    in the first.
 ---------------------------a.c-------------------------------
 #include <stdio.h>
 
 void a(int *i) {
    printf("now in a.so; incrementing i\n");
    *i=*i+1;
 }
 
 --------------------------b.c--------------------------------
 #include <stdio.h>
 
 extern void a(int *i);
 
 void b(int *i) {
    printf("in b.so; calling function a in a.so; i=%d\n",*i);
    a(i);
    printf("in b.so; now i=%d\n",*i);
 }
 
 -------------------------Makefile------------------------------
 all: a.so b.so
 
 a.o: a.c
 	gcc -fPIC -c a.c
 	
 a.so: a.o
 	gcc -shared -o a.so a.o
 	
 b.o: b.c
 	gcc -fPIC -c b.c
 	
 b.so: b.o
 	gcc -shared -o b.so b.o	
 	
 -------------------------------------------------------------------------
 
 Things seems ok.
 
 -------------------------------------------------------------------------
 sirio[~/tmp/prova]% R
 
 R : Copyright 1998, Robert Gentleman and Ross Ihaka
 Version 0.61.3  (May 3, 1998)
 
 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type    "license()" for details.
 
 Type    "demo()" for some demos, "help()" for on-line help, or
         "help.start()" for a HTML browser interface to help.
 
 
 > dyn.load("a.so")
 > dyn.load("b.so")
 > y <- .C("b",as.integer(0))
 in b.so; calling function a in a.so; i=0
 now in a.so; incrementing i
 in b.so; now i=1
 > y
 [[1]]
 [1] 1           
 ----------------------------------------------------------------------------
 
 Before introducing the RTLD_GLOBAL flag:
 ----------------------------------------------------------------------------
 sirio[~/tmp/prova]% R
 
 R : Copyright 1998, Robert Gentleman and Ross Ihaka
 Version 0.61.3  (May 3, 1998)
 
 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type    "license()" for details.
 
 Type    "demo()" for some demos, "help()" for on-line help, or
         "help.start()" for a HTML browser interface to help.
 
 > dyn.load("a.so")
 > dyn.load("b.so")
 > y <- .C("b",as.integer(0))
 in b.so; calling function a in a.so; i=0
 /usr/local/src/R-0.61.3/bin/R.binary: can't resolve symbol 'a'
 sirio[~/tmp/prova]%                                             
 
 ----------------------------------------------------------------------------
 I am using R-0.61.3 under Linux 2.30.
 
 guido masarotto
 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 22:10:18 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 22:10:18 +0100 (GMT+0100)
Subject: dependencies in .so files
Message-ID: <19980527211018.2199.qmail@sirio.stat.unipd.it>

 > Luke Tierney writes:
 > 
 > guido@sirio.stat.unipd.it wrote:
 > >  So, I try: 
 > >  1) I modify src/unix/dynload.c changing the flag of dlopen
 > >     from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
 > 
 > I'm not sure this is properly and reliably supported on all UNIX
 > platforms. It doesn't seem to be in the standard Windows and Mac
 > compilers.  That is, MS VC++ and Borland C++ don't seem to let you
 > creade DLL's with undefined symbols. Watcom does seem to allow it, but
 > I'm not certain how reliable it is there.
 If I understand, under Windows , you have to follow your strategy B (recursive 
 shared libraries). 
 
 > 
 > Also you need to consider what happens at runtime if a function is
 > called and finds an unresolved symbol. On some systems a signal might
 > be sent that can be caught (HP-UX sends SIGABRT, but I'm not sure I
 > would want to catch all those), but this will need to be checked out
 > on every different system. Having any problems reported at load time
 > seems like a safer solution -- I have gone the other way and switched
 > to using RTLD_NOW for this reason (and because that seems the least
 > common denominator accross UNIX/Win32/Mac).
 I agree. This point is however indipendent from  linking a
 shared library which needs another shared library. This has
 to do with the RTLD_LAZY flag not with the RTLD_GLOBAL one. 
 In the example I used the RTLD_LAZY flag only because the current version of
 R uses it.
 The use of RTLD_NOW will also make debugging easier.
 An example was the missing routines
 problem in the locfit package (a couple of messages a month ago).
 I found out that the shared library misses a couple of routines
 compiling the package under Windows. But, under Unix, no 
 errors in building the library.
 But, if you try to use the R function which calls
 a C function with an unresolved routine you get a segmentation fault
 (or at least, I got it).
 
 > The alternative is to use the OS's ld or equivalent to create a
 > library that knows what it needs to call at link time by telling ld
 > what other shared libraries it needs; in this case
 > 
 > >  	
 > >  a.so: a.o
 > >  	gcc -shared -o a.so a.o
 > >  	
 > >  b.o: b.c
 > >  	gcc -fPIC -c b.c
 > >  	
 > >  b.so: b.o
 > >  	gcc -shared -o b.so b.o	
 > >  	
 > 
 > would change to
 > 
 > ...
 > b.so: b.o
 > 	gcc -shared -o b.so b.o	a.so
 > 
 > Mutually recursive libraries can be handled this way on most UNIX
 > systems I think; for Win32 there are some standard tricks involving
 > .def and .lib files (that I can't remember in detail but I think I
 > found them once on MS's web site) for making DLL's that are mutually
 > recursive. I haven't looked into mutual recursion on the Mac.
 > 
 Under Linux, the problem with this approach is that the dynamic
 linker (ld.so) must find a.so at runtime. I have just tried
 on the previous example but I can't load the so builded b.so in R.
 guido m.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Wed May 27 21:41:31 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 27 May 1998 15:41:31 -0500 (CDT)
Subject: dependencies in .so files
In-Reply-To: <19980527211018.2199.qmail@sirio.stat.unipd.it> from "guido@sirio.stat.unipd.it" at May 27, 98 10:10:18 pm
Message-ID: <9805272041.AA06858@nokomis.stat.umn.edu>

guido@sirio.stat.unipd.it wrote:
> 
>  > Also you need to consider what happens at runtime if a function is
>  > called and finds an unresolved symbol. On some systems a signal might
>  > be sent that can be caught (HP-UX sends SIGABRT, but I'm not sure I
>  > would want to catch all those), but this will need to be checked out
>  > on every different system. Having any problems reported at load time
>  > seems like a safer solution -- I have gone the other way and switched
>  > to using RTLD_NOW for this reason (and because that seems the least
>  > common denominator accross UNIX/Win32/Mac).
>  I agree. This point is however indipendent from  linking a
>  shared library which needs another shared library. This has
>  to do with the RTLD_LAZY flag not with the RTLD_GLOBAL one. 

Your're right -- I got those confused. GLOBAL makes the symbols in the
new library accessible to later loads, LAZY/NOW determine whether the
check for all needed symbols occurs at call or load time. I'm still
not sure though if RTLD_GLOBAL semantics are realiably implemented on
all UNIX systems. I think it's not an issue in Win32 since (except
with Watcom?) all references need to be resolved at link time.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu May 28 08:41:06 1998
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 28 May 1998 07:41:06 -0000 ()
Subject: dependencies in .so files
In-Reply-To: <19980527185017.2030.qmail@sirio.stat.unipd.it>
Message-ID: <XFMail.980528075225.plummer@iarc.fr>

This modified version of b.c in Guido's example works for me (R-0.61.3,
RedHat Linux 5.0) without modifying the R source.  R keeps an internal
table of symbols which is accessible via the R_FindSymbol function
(defined in src/unix/dynload.c), so you can use this to return a
pointer to a function in a previously loaded library.

Pardon my C if I've done something stupid here.
Martyn.

--------------------------b.c--------------------------------
#include <stdio.h>

typedef int (*DL_FUNC) ();

DL_FUNC R_FindSymbol(char *);

void b(int *i) {
    char afun[] = "a";
    DL_FUNC fun;

    printf("in b.so; calling function a in a.so; i=%d\n",*i);
    fun = R_FindSymbol(afun);
    fun(i);
    printf("in b.so; now i=%d\n",*i);
}
---------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May 28 09:50:58 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 28 May 1998 10:50:58 +0200
Subject: R manual (html version)
In-Reply-To: <D66FD155A8@main.ubishops.ca> (rvhulst@ubishops.ca)
Message-ID: <199805280850.KAA07204@sophie.ethz.ch>

>>>>> "Robert" == Robert van Hulst <rvhulst@ubishops.ca> writes:

    Robert> Martin, your R manual was VERY useful, but I cannot access it
    Robert> any more.

You mean
	http://www.stat.math.ethz.ch/R-alpha/doc/html/ ?

There was a file permission problem which is now fixed.   Sorry!

Thanks a lot for telling me!

    Robert> Could I download the whole manual? How?  Many thanks
    Robert> for your help!  --robert

The point about that manual is, that it is a *daily* updated version of the
online help about the *development* version of R, i.e, currently 0.62.

It is  *PART* of the new development version which you can get from 
	<CRAN>/src/devel/R-snapshot.tar.gz

After unpacking, you should be able to just say
	make docs
and then finally have the HTML manual netscape-accessable in

	file:<installdir>/doc/html/index.html

There is now even a java-based search engine (not yet complete) available
besides Packages and Functions:

-------------------------------------------------------------------------------
				 Reference

     Packages                    Functions          Search Engine & Keywords
-------------------------------------------------------------------------------

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu May 28 11:34:56 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Thu, 28 May 1998 11:34:56 +0100 (GMT+0100)
Subject: dependencies in .so files
In-Reply-To: <199805280827.KAA07151@sophie.ethz.ch> from "Martin Maechler" at May 28, 98 10:27:50 am
Message-ID: <19980528103456.3200.qmail@sirio.stat.unipd.it>

Martin Maechler writes:
> 
> >>>>> "Guido" == Guido Masarotto <guido@sirio.stat.unipd.it> writes:
> 
>     >> From the dlopen man page:
>     Guido> void *dlopen (const char *filename, int flag);
>     Guido> ................................................
>     Guido> RTLD_GLOBAL may be or'ed with flag
>     Guido> in which case the external symbols defined in the library will be
>     Guido> made available to subsequently loaded libraries.
>  
>     Guido> So, I try: 
>     Guido> 1) I modify src/unix/dynload.c changing the flag of dlopen
>     Guido> from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
> 
> R-core: 
> 	Shall we do this, for 0.62?  -- or even try to have "configure" find out
> 	if  RTLD_GLOBAL  is supported on the given system?
If I can give suggestions:
1) Independently from the RTLD_GLOBAL flag, I will change RTLD_LAZY to
   RTLD_NOW. As Luke T. summarized yesterday in this way a shared library
   which cannot resolve all its symbols (in R.binary or in other libraries)
   cannot be load. This give three   advantages:
   a) At least under Linux, if I call a dynamic linked routine which
      cannot resolve its dependencies, I get a segmentation fault and
      R exit. Of course, we can try to intercept this problem but
      as also Luke noted, it is difficult to be sure that all the systems 
      will trigs an  appropriate signal; in addition
   b) debugging of a shared library becomes simple; at least, we are
      sure that all the functions in the library can be called.
   c) This correspond to the standard for not Unix machine; I am
      sure for Windows but, if I remember, Luke said also for the Mac.
   Perhaps, if a library cannot be loaded, the corresponding dlerror()
   string should be used for giving to the user some information
   on why.
2) Coming to RTDL_GLOBAL; here the question is the one raised by
   Luke: portability. I suppose that the solution suggested by
   Luke (use "recursive" shared libraries)  is more portable than mine. 
   After a first failure, I was   able to run my "silly" example setting 
   the LD_LIBRARY_PATH shell variable,i.e., instructing ld.so about where 
   to search.
   

> Guido:  Have you ever looked at 0.62  (and porting it to Win32) ?
> 	(get it from <CRAN>/src/devel/R-snapshot.tar.gz)
I had no time. I downloaded a snapshot next week but I didn't make
any trial. Is the unix/system.c changed a lot? I have just looked
to it now and it seems quite similar to the 0.61.x one.

To all the R people: have a nice day.
guido m.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Andreas.Weingessel@ci.tuwien.ac.at  Thu May 28 14:25:59 1998
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 28 May 1998 15:25:59 +0200 (CEST)
Subject: performance of apply
Message-ID: <13677.26087.506888.469624@elendil.ci.tuwien.ac.at>


I noticed that apply is VERY SLOW when applied to a "large"
dimension as for example when computing the row sums of a matrix with
thousands of rows.

To demonstrate it, I did some benchmarking for different methods of
computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.

The first method (M1) I used is the normal apply command:
	y <- apply(x,1,sum)
The second method (M2) uses a for-loop for the computations, where the
memory for the resulting vector has been allocated before. That is, for
n=3D2000:
	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
The third method (M3) also uses a for-loop, but the resulting vector
is built recursively, i.e.
	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))

All computations have been made on a Pentium II 233MHz, 256MB, R
started as R -v 50. The following table shows the minimum, mean, and
maximum CPU-time in seconds as measured by system.time over 10 runs
for every computation for different values of n.

n	M1			M2		M3
2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81

That is, the computation of the sums of the rows of a 10000x10 matrix
with apply takes about 100sec on average, where a simple for-loop does
the same job in about 2sec.

The next table shows for every method the relative increase of time as
compared to the increase of the number of rows.

n	M1	M2	M3
1	 1	1	 1
2	 3.221	2.025	 2.952
3	 6.764	3.050	 6.032
4	15.247	4.075	10.175
5	23.599	5.025	15.540

You can see that the time for M2 (for-loop with memory allocated at
the beginning) increases linearly with n, which is to be expected,
whereas apply (M1) is scaling quadratically with the number of rows. M3
(for-loop, but new memory-allocation every time) is somewhere in between.


So obviously, R becomes slow, when new memory has to be allocated
repeatedly. I do not see a quick fix for apply, because apply can be
used with arbitrary functions which might yield different results for
different input data. But I think as long as memory allocation seems
to be a performance bottleneck, one should be aware of this problem,
use simple for-loops and use apply only on small data (small
dimensions) or where it is really necessary.

	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri May 29 15:05:40 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 09:05:40 -0500
Subject: performance of apply
In-Reply-To: Andreas Weingessel's message of Thu, 28 May 1998 15:25:59 +0200 (CEST)
References: <13677.26087.506888.469624@elendil.ci.tuwien.ac.at>
Message-ID: <6rlnrldvez.fsf@verdi.stat.wisc.edu>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> I noticed that apply is VERY SLOW when applied to a "large"
> dimension as for example when computing the row sums of a matrix with
> thousands of rows.
> 
> To demonstrate it, I did some benchmarking for different methods of
> computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.
> 
> The first method (M1) I used is the normal apply command:
> 	y <- apply(x,1,sum)
> The second method (M2) uses a for-loop for the computations, where the
> memory for the resulting vector has been allocated before. That is, for
> n=3D2000:
> 	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
> The third method (M3) also uses a for-loop, but the resulting vector
> is built recursively, i.e.
> 	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))
> 
> All computations have been made on a Pentium II 233MHz, 256MB, R
> started as R -v 50. The following table shows the minimum, mean, and
> maximum CPU-time in seconds as measured by system.time over 10 runs
> for every computation for different values of n.
> 
> n	M1			M2		M3
> 2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
> 4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
> 6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
> 8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
> 10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81
> 
> That is, the computation of the sums of the rows of a 10000x10 matrix
> with apply takes about 100sec on average, where a simple for-loop does
> the same job in about 2sec.

There would be at least two other methods that would be interesting to
try.  Because you are interested in the row sums I imagine by far the
fastest method would be (M4)
   y <- x %*% rep(1, ncol(x))
You may also find that (M5)
   y <- apply( t(x), 2, sum )
would be faster than M1 because of the way the R handles arrays.

We should keep in mind when looking at these tables that the maximum
time on the size 10000 case is about 2 minutes.  If the computation is
worth doing it may be worth waiting 2 minutes for the result.  I
remember the days of running S version 2 (i.e. the version before "New
S") on a Vax-11/750.  This sort of computation could take many, many
hours on the only computer in the department so relative differences
in speed for different methods were a lot more important.  One got
used to rephrasing computations in "efficient" ways.  Today I think
that clarity is usually more important than efficiency.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From wsimpson@uwinnipeg.ca  Fri May 29 15:32:52 1998
From: wsimpson@uwinnipeg.ca (Bill Simpson)
Date: Fri, 29 May 1998 09:32:52 -0500 (CDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
Message-ID: <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>

I was computing a function f(u,v) on bivariate point process data of
about 4500 points. The computation in R took about 96 hours (4 days!) on a
Pentium Pro 200 under linux with little or no other load. So I think speed
can be an issue, esp. when computing things one will eventually display
with image().

My collaborator and I wound up coding it in C and now the computation
takes 4 min (yes, 4 min vs 4 days).

Probably it could have been sped up in R but that would have taken the
same effort as coding in C, and the result would have been slower.

Bill Simpson

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Andreas.Weingessel@ci.tuwien.ac.at  Fri May 29 15:52:00 1998
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 29 May 1998 16:52:00 +0200 (CEST)
Subject: performance of apply
In-Reply-To: <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>
References: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
 <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>
Message-ID: <13678.52112.677406.807483@elendil.ci.tuwien.ac.at>



Maybe my point was not quite clear. I did not want to compute the row
sums of a certain matrix, I just wanted to demonstrate that the task
"apply a certain function to every row of a matrix" can take a very
long time, if it is done with the function "apply" which is of course
the most clear way to implement this task. I first came across this
problem when I made simulations on a data matrix with 15000 rows and
after adding one simple "apply" to my program, it suddenly seemed not to
finish at all.

If I just want make such a computation once, it might be not important
whether I wait a couple of seconds or 2 minutes or 5 minutes (as it
needs time for 15000 rows). But if I do some simulation where these
computations are repeated hundred times, there is a difference between
200 seconds or 200 minutes.

	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri May 29 16:11:04 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 10:11:04 -0500
Subject: performance of apply
In-Reply-To: Andreas Weingessel's message of Fri, 29 May 1998 16:52:00 +0200 (CEST)
References: <6rlnrldvez.fsf@verdi.stat.wisc.edu> 	<Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca> <13678.52112.677406.807483@elendil.ci.tuwien.ac.at>
Message-ID: <6rd8cxdsdz.fsf@verdi.stat.wisc.edu>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> If I just want make such a computation once, it might be not important
> whether I wait a couple of seconds or 2 minutes or 5 minutes (as it
> needs time for 15000 rows). But if I do some simulation where these
> computations are repeated hundred times, there is a difference between
> 200 seconds or 200 minutes.

I should probably have been clearer about what I was saying.  I was
indicating that some computations can be re-phrased in non-obvious
ways that are substantially faster in R.  To a numerical analyst it
would be ridiculous to use a matrix multiplication to collect row sums
because you are doing all those multiplications by 1.  However, in R/S
it is substantially faster because the looping overhear is in C not in
R.

The other issue I was trying to indicate is that efficiency has to be
measured in how long it takes to get the work done.  This includes
both thinking (and often debugging) time and computing time.  The
trade-offs between the cost of thinking and the cost of computing have
changed remarkably over the years.  I often characterize the way I see
people computing now as using a computer as a blunt instrument with
which to bludgeon the problem to death (can you say "Markov Chain
Monte Carlo"?).  In real world terms it may be more efficient to do
that than to think deeply about the computations involved and how to
speed them up.

I have probably said too much about this.  I should go back to writing
my code, which, ironically, is C code designed to speed up simulations
for a particular type of statistical model :-)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Fri May 29 16:45:53 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 29 May 1998 10:45:53 -0500 (CDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu> from "Douglas Bates" at May 29, 98 09:05:40 am
Message-ID: <9805291545.AA08154@nokomis.stat.umn.edu>

Douglas Bates wrote:
> 
> Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:
> > 
> > To demonstrate it, I did some benchmarking for different methods of
> > computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.
> > 
> > The first method (M1) I used is the normal apply command:
> > 	y <- apply(x,1,sum)
> > The second method (M2) uses a for-loop for the computations, where the
> > memory for the resulting vector has been allocated before. That is, for
> > n=3D2000:
> > 	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
> > The third method (M3) also uses a for-loop, but the resulting vector
> > is built recursively, i.e.
> > 	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))
> > 
> > All computations have been made on a Pentium II 233MHz, 256MB, R
> > started as R -v 50. The following table shows the minimum, mean, and
> > maximum CPU-time in seconds as measured by system.time over 10 runs
> > for every computation for different values of n.
> > 
> > n			M1			M2		M3
> > 2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
> > 4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
> > 6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
> > 8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
> > 10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81
> > 
> > That is, the computation of the sums of the rows of a 10000x10 matrix
> > with apply takes about 100sec on average, where a simple for-loop does
> > the same job in about 2sec.

It looks like M1 and M3 are O(n^2) but M1 is O(n). I see where that
comes from in M3, but it surprises me for M1.

luke



-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri May 29 17:04:30 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 29 May 1998 18:04:30 +0200
Subject: performance of apply
In-Reply-To: Luke Tierney's message of Fri, 29 May 1998 10:45:53 -0500 (CDT)
References: <9805291545.AA08154@nokomis.stat.umn.edu>
Message-ID: <x2af81t65t.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:


> > > That is, the computation of the sums of the rows of a 10000x10 matrix
> > > with apply takes about 100sec on average, where a simple for-loop does
> > > the same job in about 2sec.
> 
> It looks like M1 and M3 are O(n^2) but M1 is O(n). I see where that
> comes from in M3, but it surprises me for M1.

Oh, dear. Looking at apply, we have right in the middle of it:

            for (i in 1:d2) ans[[i]] <- FUN(array(newX[, i], d.call, 
                    dn.call), ...)

Assignment to the tail of a very long list... 

I think I'm beginning to understand why Ross keeps talking about
generic vectors. Either that or we need to add some low-level list
primitives to the language. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri May 29 17:14:36 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 29 May 1998 09:14:36 -0700 (PDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
Message-ID: <Pine.LNX.3.96.980529090735.23645A-100000@buffy>

On 29 May 1998, Douglas Bates wrote:

> Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:
> 
> > I noticed that apply is VERY SLOW when applied to a "large"
> > dimension as for example when computing the row sums of a matrix with
> > thousands of rows.
> > 
> 

> 
> We should keep in mind when looking at these tables that the maximum
> time on the size 10000 case is about 2 minutes.  If the computation is
> worth doing it may be worth waiting 2 minutes for the result.  I
> remember the days of running S version 2 (i.e. the version before "New
> S") on a Vax-11/750.  This sort of computation could take many, many
> hours on the only computer in the department so relative differences
> in speed for different methods were a lot more important.  One got
> used to rephrasing computations in "efficient" ways.  Today I think
> that clarity is usually more important than efficiency.

One of the really nice things about R is that you _don't_ have to use
apply to get loops to run in reasonable time, since for most non-Lisp
people for() is simpler than apply(). 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Fri May 29 22:20:39 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 30 May 1998 09:20:39 +1200 (NZST)
Subject: performance of apply
Message-ID: <199805292120.JAA14926@stat1.stat.auckland.ac.nz>

	Subject: Re: performance of apply
	From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
	Date: 29 May 1998 18:04:30 +0200
	MIME-Version: 1.0
	Content-Transfer-Encoding: 7bit

	Oh, dear. Looking at apply, we have right in the middle of it:

	            for (i in 1:d2) ans[[i]] <- FUN(array(newX[, i], d.call, 
	                    dn.call), ...)

	Assignment to the tail of a very long list... 

	I think I'm beginning to understand why Ross keeps talking about
	generic vectors. Either that or we need to add some low-level list
	primitives to the language. 


Got it in one.  To reach ans[[i]] you have to cdr down the whole list.
The subsetting code would be vastly simplified without the special
list code.  Ugliest of all is subscript manipulation for lists with
dim attributes.

[ I estimate 2 months for a fix - not that it will take that long,
  but there are some other things higher up the todo list ].

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jimrc@mathfs.math.montana.edu  Fri May 29 23:44:12 1998
From: jimrc@mathfs.math.montana.edu (Jim Robison-Cox)
Date: Fri, 29 May 1998 16:44:12 -0600 (MDT)
Subject: aov design questions
Message-ID: <Pine.ULT.3.91.980529162513.20891B-100000@mathfs.math.montana.edu>

R developers,

  I have a first attempt to make an aov function.  Eventually I want to
  build in  Error() structure, but first I am trying to get this
  presentable for balanced data with only a single stratum, just using 
  residual error.  I  am following R. M. Heiberger's Computation for the 
  Analysis of Designed Experiments, Wiley (1989)

  I a using a wrapper (aov.bal) to call the fitting function in the same 
way that lm() does a bunch of stuff and then calls lm.fit(), in fact I 
took most of the wrapper right out of lm(). I'm trying to make the aov 
object look as much as possible like an lm.object


  Several questions have come up which need discussion.

Q 1)  Is aov supposed to avoid qr decomposition and matrix inversion?
      In S it is claimed to be faster than lm() for large datasets.  Is
      that due to avoidance of qr()? 

      (My main goal is to get the Error strata working.)


Q 2)  If the speed is important, can we give up choice of contrasts used to
  set up the dummy factor variables? ( contr.treatment, contr.sum) 

   Why do I ask? 
   In pursuit of speed (we're talking nanoseconds for a reasonable size
   data set) I have forced in helmert  contrasts because their
   orthogonality makes it slick to compute. So in this version, whatever
   option(contrasts) is set will be ignored.

   I don't like making that choice for the user esp. since it gives wrong 
   answers under the default contrasts, and have thought about
   converting back into the original contrasts, but it isn't easy with
   higher-way anova models. It looks easy in VR2 p 197-204 
   (BTW I have kroenecker and ginv functions if anyone wants them)
  but I don't get it to work out nicely.  V&R show the contrast
  transformation as:
   alpha_T = ginv(C_T) %*% C_H %*% alpha_H
  where C_T is the contrast matrix for treatment contrasts, and C_H for
  Helmert contrasts. The alpha's contain only the treatment contrast 
  effects, not the mean.  This would leave the intercept estimate
   unchanged (not right).  For single factors it works to stick a 
  col.vector of 1s on the front of C_H and C_T, and include the mu.hat in 
  the alpha_H or alpha_T.  But when I get into interactions, I don't see 
  what is needed.

Q 3)  I am having a problem with keep.order. With balanced data, I know
    the effects are orthogonal, so order is not an issue, but as I move
    onto the tougher cases, I need model.matrix to preserve order, and
    it doesn't.

Q 4)  What are the $effects in lm.objects?
     For the moment I've stuck in the coefficients.

Q 5)  Any objection to passing cov.unscaled from aov to summary.aov?
    (Since I'm not using qr and can't pass R)

Feedback needed, comments are welcome.


Jim Robison-Cox                 ____________            
Department of Math Sciences    |            |           phone: (406)994-5340
2-214 Wilson Hall               \   BZN, MT |           FAX:   (406)994-1789
Montana State University         |  *_______|
Bozeman, MT 59717                 \_|         e-mail: jimrc@math.montana.edu 

#---------------------------------------------------------------------------
##  First hack at aov for balanced data

aov.bal <- function(formula, data = list(), subset, weights, na.action, 
        method = "qr", model = TRUE, keep.order=F, ...) 
{  
     mt <- terms(formula, data = data, keep.order = keep.order)
     nt <- length(attr(mt,"order")[attr(mt,"order") ==1])
     lt <- rep("contr.helmert",nt)            ## Sets helmert contrasts
     names(lt) <- attr(mt,"term.labels")[ attr(mt,"order") ==1]
     mf <- match.call()
     mf$model <- NULL
     mf[[1]] <- as.name("model.frame")
     mf <- eval(mf, sys.frame(sys.parent()))
     if (method == "model.frame") 
          return(mf)
     else if (method != "qr")  ## change for aov??
         warning(paste("method =", method, "is not supported. Using \"qr\"."))
     if (length(list(...))) 
          warning(paste("Extra arguments", deparse(substitute(...)), 
                        "are just disregarded."))
     y <- model.response(mf, "numeric")
     w <- model.weights(mf)
     if (is.empty.model(mt)) {
                z <- list(coefficients = numeric(0), residuals = y, 
                        fitted.values = 0 * y, weights = w, rank = 0, 
                        df.residual = length(y))
                class(z) <- if (is.matrix(y)) 
                        c("mlm.null", "lm.null", "mlm", "lm")
                else c("lm.null", "lm")
     }
     else {
                x <- model.matrix(mt, mf, as.list(lt))
                          # forces in contr.helmert
                z <- if (is.null(w)) {
                   aov.balanced.fit(x, y, mt)
		}
                else {
                  stop("Weighted aov not implemented, use lm")
                  #aov.balanced.wfit(x, y, mt, w)
                }
                class(z) <- c(if (is.matrix(y)) c("maov","mlm"), c("aov","lm"))
     }
     z$call <- match.call()
     z$terms <- mt
     if (model) 
         z$model <- mf
     z
}

aov.balanced.fit <- function(x,y,mod.terms,wt=NULL){
    x <- as.matrix(x); dimx <- dim(x)
    xnames <- dimnames(x)[[2]]
    y <- as.matrix(y); dimy <- dim(y)
    assn <- attr(x,"assign")
    df  <-   c(table(assn), dimy[1]- dimx[2])
    D <- diag(1/diag(t(x) %*% x))
    dimnames(D) <- list(xnames,xnames)
    coef <- as.numeric(D %*% t(x) %*%  y)
    names(coef) <- xnames
    fits <- x %*% coef
    resid <- y - fits
    eff <-  apply((t(x) * rep(coef,dimx[1]))^2,1,sum)
             ## Take each column of x (row of t(x)) times its
             ## coefficient, square the result and sum (over columns of x)
    eff <-  c(sapply( split(eff,assn), sum),   sum(resid^2))
             ## Adds them up over the factors.
    if(attr(mod.terms,"intercept") == 1) {
      eff <- eff[-1]
      df  <- df[-1]
    }
    name <- c(attr(mod.terms,"term.labels"), "Residuals")
    names(eff) <- name
    names(df)  <- name
    list(coefficients= coef, residuals = resid, effects = eff, 
         rank= dimx[2], fitted.values = fits, assign= assn,
         cov.unscaled = D, df.residual =  dimy[1] - dimx[2],
         df =  df  )
    
}

print.aov <- 
function (x, digits = max(3, .Options$digits - 3), ...) 
{  
   lenx <- length(x$df)
   tabl <- cbind(x$df,x$effects, x$effects/x$df)
   tabl <- cbind(tabl,c(tabl[1:(lenx-1),3]/tabl[lenx,3],NA))
   tabl <- cbind(tabl,1-pf(tabl[,4],tabl[,1],tabl[lenx,1]))
   dimnames(tabl) <- list(names(x$effects), c("df","SS","MS","F","P > F"))
   cat("\nAnalysis of Variance:\n\n")
   print.default(round(tabl, digits), na = "", print.gap = 2)
   cat("\n")
   invisible(x)
}


summary.aov <- function (z, correlation=F) 
{
        p <- z$rank
        p1 <- 1:p
        r <- resid(z)
        f <- fitted(z)
        n <- length(f)
        w <- weights(z)
        if (is.null(z$terms)) {
                stop("invalid 'aov' object:  no terms component")
        }
        else {
                if (is.null(w)) {
                        mss <- if (attr(z$terms, "intercept")) 
                                sum((f - mean(f))^2)
                        else sum(f^2)
                        rss <- sum(r^2)
                }
        }
        resvar <- rss/(n - p)
        se <- sqrt(resvar * diag(z$cov.unscaled))
        est <- z$coefficients
        tval <- est/se
        ans <- z[c("call", "terms")]
        ans$residuals <- as.numeric(r)
        ans$coefficients <- cbind(est, se, tval, 2 * (1 - pt(abs(tval), 
                n - p)))
        dimnames(ans$coefficients) <- list(names(z$coefficients),
                c("Estimate", "Std.Error", "t Value", "Pr(>|t|)"))
        ans$sigma <- sqrt(resvar)
        ans$df <- c(p, n - p)
        if (p != attr(z$terms, "intercept")) {
                df.int <- if (attr(z$terms, "intercept")) 
                        1
                else 0
                ans$r.squared <- mss/(mss + rss)
                #0.14 :	(n/(n-p))
                ans$adj.r.squared <- 1 - (1 - ans$r.squared) * 
                        ((n - df.int)/(n - p))
                ans$fstatistic <- c((mss/(p - df.int))/(rss/(n - 
                        p)), p - df.int, n - p)
                #0.14: ans$fstatistic <- c((mss/(p-1))/(rss/(n-p)),p-1,n-p)
                names(ans$fstatistic) <- c("value", "numdf", 
                        "dendf")
        }
        ans$cov.unscaled <- z$cov.unscaled
        if (correlation) {
                invsqrt.diag <- diag(sqrt(1/diag(z$cov.unscaled)))
                ans$correlation <-
                      invsqrt.diag %*% z$cov.unscaled %*% invsqrt.diag
                dimnames(ans$correlation) <- dimnames(z$cov.unscaled)
        }
        class(ans) <- "summary.aov"
        ans
}

print.summary.aov <- function (x, digits = max(3, .Options$digits - 3), 
                              roundfun = round, ...) 
{
        cat("\nCall:\n")
        cat(paste(deparse(x$call), sep = "\n", collapse = "\n"), 
                "\n\n", sep = "")
        resid <- x$residuals
        df <- x$df
        rdf <- df[2]
        if (rdf > 5) {
                cat("Residuals:\n")
                if (length(dim(resid)) == 2) {
                        rq <- apply(t(resid), 1, quantile)
                        dimnames(rq) <- list(c("Min", "1Q", "Median", 
                                "3Q", "Max"), dimnames(resid)[[2]])
                }
                else {
                        rq <- quantile(as.numeric(resid))
                        names(rq) <- c("Min", "1Q", "Median", 
                                "3Q", "Max")
                }
                print(rq, digits = digits, ...)
        }
        else if (rdf > 0) {
                cat("Residuals:\n")
                print(resid, digits = digits, ...)
        }
#        if (nsingular <- df[3] - df[1]) 
#                cat("\nCoefficients: (", nsingular, " not defined because of singularities)\n", 
#                        sep = "")
#        else
        cat("\nCoefficients:\n")
        print(roundfun(x$coefficients, digits = digits), quote = FALSE, 
                ...)
        cat("\nResidual standard error:", format(signif(x$sigma, 
                digits)), "on", rdf, "degrees of freedom\n")
        if (!is.null(x$fstatistic)) {
                cat("Multiple R-Squared:", format(signif(x$r.squared, 
                        digits)))
                cat(",\tAdjusted R-squared:", format(signif(x$adj.r.squared, 
                        digits)), "\n")
                cat("F-statistic:", format(signif(x$fstatistic[1], 
                        digits)), "on", x$fstatistic[2], "and", 
                        x$fstatistic[3], "degrees of freedom")
                cat(",\tp-value:", format(signif(1 - pf(x$fstatistic[1], 
                        x$fstatistic[2], x$fstatistic[3]), digits)), 
                        "\n")
        }
        correl <- x$correlation
        if (!is.null(correl)) {
                p <- dim(correl)[2]
                if (p > 1) {
                        cat("\nCorrelation of Coefficients:\n")
                        correl[!lower.tri(correl)] <- NA
                        print(correl[-1, -NCOL(correl)], digits = digits, 
                                na = "")
                }
        }
        cat("\n")
        invisible(x)
}

#-------------------------------------------------------------------------
##  Rd file:
\name{aov.bal}
\title{Function to compute analysis of variance for balanced designs}
\usage{
aov.bal(formula, data=list(), subset, weights, na.action, method="qr", model=TRUE, keep.order=F, ...)
}
%- maybe also `usage' for other functions documented here.
\alias{aov.bal}
\alias{summary.aov}
\alias{coefficients.lm}
\alias{df.residual.lm}
\alias{fitted.values.lm}
\alias{residuals.lm}
\alias{aov.balanced.fit}
\alias{print.aov}
\alias{print.summary.aov}
\keyword{regression}
%- Also NEED an `\alias' for EACH other function documented here.
\arguments{
 \item{formula}{A detailed description of the model to be fit.  See
   details under \code{\link{lm}} }
 \item{data}{ data frame contining the data to be fit. Default is
   working directory.}
 \item{subset}{Description of what rows of the data frame to use in the fit. }
 \item{na.action}{ Currently not used }
 \item{method}{Not currently used, except that method="model.frame" will
 extract the model frame only and not fit the anova.}
 \item{model}{ If true, model frame is included in the output.}
 \item{keep.order}{If true, model should be evaluated in the order
   specified by the model statement. (Doesn't work.)}
 \item{\dots}{ other arguments (not presently used) }
}
\description{
\code{aov.bal} is used to fit analysis of variance models.  Eventually it
will handle multiple strata. The generic accessor functions
\code{coefficients}, \code{fitted.values} and \code{residuals}
can be used to extract various useful features of the
value returned by \code{aov.bal}.  Currently \code{aov.bal} uses only the
Helmert contrasts and ignores the contrast functions set by
options()$contrast. 
}
\value{
\code{aov.bal} returns an object of class code\aov} which may be printed
with the \code{print.aov} or \code{summary.aov}.
  \item{coefficients}{Coefficients under the Helmert contrasts.}
  \item{residuals} {Residuals}
  \item{effects } {effects ?=? coefficients?}
  \item{rank}     
  \item{fitted.values}
  \item{assign}
  \item{var }
  \item{df.residual}
  \item{df}
  \item{call}
  \item{terms}
}
\references{ Heiberger, R. M., 1989, Computation for the Analysis of
  Designed Experiments, Wiley}
\author{ Jim Robison-Cox }
\seealso{ \code{\link{lm}},\code{\link{glm}},\code{\link{coefficients}},\code{\link{residuals}},\code{\link{fitted.values}} }

\examples{
 speed <- c(59, 69, 66, 75, 54, 65, 58, 70, 66, 77, 71, 71, 58, 65, 56,
            62, 54, 60, 52, 64, 59, 73, 60, 70)
 typists <- gl(6,4,24)
 brands  <- gl(4,1,24)
 type.aov <- aov.bal(speed ~ typists + brands)
 summary(type.aov)
}
\keyword{ regression }%-- one or more ...
\keyword{models}


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sat May 30 00:09:10 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 18:09:10 -0500
Subject: An R BOF meeting at the JSM?
Message-ID: <6raf80d695.fsf@verdi.stat.wisc.edu>

The BOF in the subject line is a "Birds Of a Feather" meeting.  This
is a chance for people who normally only get the chance to communicate
via e-mail to actually sit down and talk to each other in person.

I plan to be at the Joint Statistical Meetings in Dallas in August.
If you will be attending and would be interested in getting together
with some other R folks, please e-mail me and I will try to set
something up. Usually there is a mixer for the Statistical Computing
and Statistical Graphics sections on Monday night so that might be a
good time and place to try to meet.  I'm assuming pretty well everyone
on the R-devel group would belong to one of those sections.  If not
you could probably come anyway and just pretend you are not eating any
of the peanuts.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon May  4 16:34:15 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 4 May 1998 17:34:15 +0200 (CEST)
Subject: Updated mass package on CRAN
Message-ID: <13645.57335.908351.332965@galadriel.ci.tuwien.ac.at>


Hi,

I've converted all functions etc. from V&R's MASS library to R
... everything's in mass_5.2pl005-2.tar.gz in the devel section of
CRAN. Below is the README:

**********************************************************

This is a first shot at porting the whole main section of V&R's MASS
library to R --- and only for cool people with a brave heart :-)

Porting was done using brute force and (almost) no checking, i.e.,
 *) all .q files were renamed to .R
 *) all man pages converted automatically using Sd2Rd
 *) all *.dat files renamed to .tab

For further changes see the ChangeLog.

Especially the data might not work at all ...

Anyway, I currently don't have time to do all the time consuming
checking/rewrite of man pages/..., but wanted to provide others with a
start.

And some things are working :-)

Good luck,

-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May  4 17:09:27 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 4 May 1998 12:09:27 -0400
Subject: lSM  lICE: not found
Message-ID: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>

I'm trying to compile R 0.61.3 on Solaris and I get the following error. Does
anyone know where I should find these libraries?

ld: fatal: library -lSM: not found
ld: fatal: library -lICE: not found
ld: fatal: File processing errors.  No output written to R.binary
*** Error code 1
make: Fatal error: Command failed for target `R.binary'

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May  4 17:35:50 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 May 1998 18:35:50 +0200
Subject: lSM  lICE: not found
In-Reply-To: Paul Gilbert's message of Mon, 4 May 1998 12:09:27 -0400
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>
Message-ID: <x267jmhu3d.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> 
> I'm trying to compile R 0.61.3 on Solaris and I get the following error. Does
> anyone know where I should find these libraries?
> 
> ld: fatal: library -lSM: not found
> ld: fatal: library -lICE: not found
> ld: fatal: File processing errors.  No output written to R.binary
> *** Error code 1
> make: Fatal error: Command failed for target `R.binary'
> 
> Paul Gilbert

Huh?

bash$ uname -a
SunOS stat 5.5.1 Generic_103640-05 sun4m sparc SUNW,SPARCstation-10

<output from make>
cd main; make
gcc -o R.binary arithmetic.o array.o attrib.o bind.o builtin.o
 ....
 ../lib/libunix.a ../lib/libappl.a ../lib/libmath.a -L/usr/openwin/lib
 -R/usr/openwin/lib -lX11 -lsocket -lnsl -ldl -lreadline -ltermcap -lm

..no mention of libSM or libICE.

Why is it requiring those libraries in the first place?? Are you
installing from scratch or might there be some leftovers from a
previous compile. The -lSM -lICE line seems to come from some generic
X11 stuff in configure and are not mentioned in configure.in, which I
suppose means: if R doesn't configure and compile, no other X program
does either....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@math.sc.edu  Mon May  4 18:11:19 1998
From: rossini@math.sc.edu (Anthony Rossini)
Date: 04 May 1998 13:11:19 -0400
Subject: lSM  lICE: not found
In-Reply-To: Peter Dalgaard BSA's message of "04 May 1998 18:35:50 +0200"
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk>
Message-ID: <wnc1zua2c7c.fsf@fhat.stat.sc.edu>


>>>>> "Peter" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    >> I'm trying to compile R 0.61.3 on Solaris and I get the
    >> following error. Does anyone know where I should find these
    >> libraries?
    >> 
    >> ld: fatal: library -lSM: not found
    >> ld: fatal: library -lICE: not found
    >> ld: fatal: File processing errors.  No output written to R.binary
    >> *** Error code 1
    >> make: Fatal error: Command failed for target `R.binary'

    Peter> Huh?

    Peter> bash$ uname -a
    Peter> SunOS stat 5.5.1 Generic_103640-05 sun4m sparc SUNW,SPARCstation-10

    Peter> <output from make>
    Peter> cd main; make
    Peter> gcc -o R.binary arithmetic.o array.o attrib.o bind.o builtin.o
    Peter>  ....
    Peter>  ../lib/libunix.a ../lib/libappl.a ../lib/libmath.a -L/usr/openwin/lib
    Peter>  -R/usr/openwin/lib -lX11 -lsocket -lnsl -ldl -lreadline -ltermcap -lm

    Peter> ..no mention of libSM or libICE.

    Peter> Why is it requiring those libraries in the first place??
    Peter> Are you installing from scratch or might there be some
    Peter> leftovers from a previous compile. The -lSM -lICE line
    Peter> seems to come from some generic X11 stuff in configure and
    Peter> are not mentioned in configure.in, which I suppose means:
    Peter> if R doesn't configure and compile, no other X program does
    Peter> either....

To clarify Peter's point, -lICE -lSM are from the X11R6 distribution,
but last I checked, OpenWindows (which is what Sun shipped with the
2.5 distribution, I've got my hands on a machine running 2.6), uses
X11R5, which doesn't have those two libraries.

If you've got a confused X set up (like a local version of The Open
Group's (was MIT's) X11R6 build, this could be the result.

You should determine the version of X, and link accordingly.

The only other thought is that Sun "forgot" to ship the SM and ICE
libs; they did that with a different library a few OS distributions
ago (Slowaris 2.3?).

Or it might be some confusion (XlispStat's configure once had a
similar problem a long time ago).

best,
-tony
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May  4 19:02:40 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 4 May 1998 14:02:40 -0400
Subject: lSM  lICE: not found
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk> <wnc1zua2c7c.fsf@fhat.stat.sc.edu>
Message-ID: <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>

    Peter> Why is it requiring those libraries in the first place??
    Peter> Are you installing from scratch or might there be some
    Peter> leftovers from a previous compile. The -lSM -lICE line

Indeed this seems to have been the problem. I first tried to configure and make
on my new workstation with Solaris 2.6, but ran into a problem because
apparently I need a newer version of gcc. I then did a "make clean", telneted to
an older machine with Solaris 2.5.1, re-ran configure and then make. However,
this does not seem to get things clean enough - I guess configure does not
re-configure?

When I started completely clean from the tar file the problem seems to have gone
away.

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@math.sc.edu  Mon May  4 20:06:23 1998
From: rossini@math.sc.edu (Anthony Rossini)
Date: 04 May 1998 15:06:23 -0400
Subject: lSM  lICE: not found
In-Reply-To: Paul Gilbert's message of "Mon, 4 May 1998 14:02:40 -0400"
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca> <x267jmhu3d.fsf@blueberry.kubism.ku.dk> <wnc1zua2c7c.fsf@fhat.stat.sc.edu> <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>
Message-ID: <wnchg35luts.fsf@fhat.stat.sc.edu>


>>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    Paul> an older machine with Solaris 2.5.1, re-ran configure and
    Paul> then make. However, this does not seem to get things clean
    Paul> enough - I guess configure does not re-configure?

Not if it already built a cache (you can look for a config.cache file,
and delete it to force configure to look for everything -- I suspect
there is a command line option to configure to do the same.).  The
reason is to allow configuration of different options on the same
architecture w/o determining the architecture again.
(i.e. reconfiguring for mule and graphics support in xemacs, after you 
get new required libraries); it's a bit harder to justify for R.

best,
-tony


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May  4 22:26:42 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 04 May 1998 23:26:42 +0200
Subject: lSM  lICE: not found
In-Reply-To: Anthony Rossini's message of 04 May 1998 15:06:23 -0400
References: <98May4.123424edt.13454@mailgate.bank-banque-canada.ca>
 <x267jmhu3d.fsf@blueberry.kubism.ku.dk>
 <wnc1zua2c7c.fsf@fhat.stat.sc.edu>
 <98May4.142542edt.13443@mailgate.bank-banque-canada.ca>
 <wnchg35luts.fsf@fhat.stat.sc.edu>
Message-ID: <x27m41wwvh.fsf@biostat.ku.dk>

Anthony Rossini <rossini@math.sc.edu> writes:

> 
> 
> >>>>> "Paul" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
> 
>     Paul> an older machine with Solaris 2.5.1, re-ran configure and
>     Paul> then make. However, this does not seem to get things clean
>     Paul> enough - I guess configure does not re-configure?
> 
> Not if it already built a cache (you can look for a config.cache file,
> and delete it to force configure to look for everything -- I suspect
> there is a command line option to configure to do the same.).  The
> reason is to allow configuration of different options on the same
> architecture w/o determining the architecture again.
> (i.e. reconfiguring for mule and graphics support in xemacs, after you 
> get new required libraries); it's a bit harder to justify for R.

make acclean
(or moreclean or distclean or realclean) does this automatically.

Should we let "make clean" do so as well? It's a single-word change,
but are there adverse side effects? Considering how rarely I do "make
clean" myself, I don't think I'd mind the extra time usage for
reconfiguration (about 16 seconds on this machine).


configure --cache-file=/dev/null 
disables caching, according to the comments in the script (not
terribly elegant in my opinion...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon May  4 23:17:14 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 5 May 1998 10:17:14 +1200 (NZST)
Subject: lSM  lICE: not found
Message-ID: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>

The intent of "make clean" is to remove the temporaries but leave a
complete runnable R.  It is quite useful when you have installed
versions of R.  Maybe the "make clean" / "make distclean" distinction
needs to be explicit in the "INSTALL" file.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue May  5 08:48:16 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 05 May 1998 09:48:16 +0200
Subject: lSM  lICE: not found
In-Reply-To: Ross Ihaka's message of Tue, 5 May 1998 10:17:14 +1200 (NZST)
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
Message-ID: <x290ohb1kv.fsf@biostat.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> The intent of "make clean" is to remove the temporaries but leave a
> complete runnable R.  It is quite useful when you have installed
> versions of R.  Maybe the "make clean" / "make distclean" distinction
> needs to be explicit in the "INSTALL" file.
> 
> 	Ross

This begs the question: Is anything in config.{cache,log,status}
necessary for R to run, then? (Or could it become so?) Otherwise
"acclean" *should* probably be made as part of "clean"

I know there's a lot of tradition and conventions in how to setup
makefiles, but wouldn't it be handy with a "rebuild" type target?

rebuild: realclean R

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 14:41:44 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 09:41:44 -0400
Subject: lSM  lICE: not found
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
Message-ID: <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>

Ross> The intent of "make clean" is to remove the temporaries but leave a
Ross> complete runnable R.  It is quite useful when you have installed
Ross> versions of R.  Maybe the "make clean" / "make distclean" distinction
Ross> needs to be explicit in the "INSTALL" file.

I had assumed "make clean" would leave a complete runnable R, that is my
runnable R wouldn't get messed up until I did "make" which does "install", which
can potentially mess up my running R. But I had also assumed that when I did
"make" I would be starting clean, which is not completely true it seems - at
least as far as the architecture and other stuff as determined by configure are
concerned.

I'm not sure what would be the best approach to make things easy for novices. I
don't use "make clean" very often for R and it is probably more of a utility for
developers - but I did get caught this time. My usual approach is just to delete
everything and start over with the tar file. I think, however, that anything
like "make distclean" or "make realclean" or "make acclean" is going to be even
more of a utility for developers - they all assume you are familiar with the
Makefile, or, if they are documented, that you read the documentation
(regularly, since these things change).

Probably the best thing to make it easy for novices is to have some "install" or
"setup" script which does all of the appropriate steps. This should also make
certain that everything is sufficiently clean that there won't be any mistakes.

Paul Gilbert



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Tue May  5 16:21:18 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Tue, 5 May 1998 16:21:18 +0100 (GMT+0100)
Subject: RSXNT (was R-0.61.1 compiled with ...)
In-Reply-To: <x27m4je3ju.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Apr 21, 98 02:56:37 pm
Message-ID: <19980505152118.5751.qmail@sirio.stat.unipd.it>

> >  Peter Dalgaard BSA writes:
> >  > 
> >  > Ouch! In that case, I suggest that we try to put some collective
> >  > effort into getting something working with RSXNT. The only thing that
Yesterday evening, I downloaded the last version of RSXNT. 
I just played with it half an hour but seems to work (at least under
WIN95).
Have someone tryed to compile R?
If not, I will make an attempt starting from my previous 
work with mingw32.
guido masarotto
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Tue May  5 16:24:17 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Tue, 5 May 1998 16:24:17 +0100 (GMT+0100)
Subject: lSM  lICE: not found (fwd)
Message-ID: <19980505152418.5768.qmail@sirio.stat.unipd.it>

 1) The effect of "make clean" is the "more standard". I checked
    with some programs of which I have the source installed and
    no remove config.cache with only clean.
 2) When you have config.cache and you rerun configure 
    you obtain a lot of line of the type "something (cached)".
    The meaning of this must perhaps be explained in the documentation.
    
 guido masarotto   
 
 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Tue May  5 15:44:09 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Tue, 5 May 1998 16:44:09 +0200 (MDT)
Subject: lSM  lICE: not found
In-Reply-To: <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
 <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
Message-ID: <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>

Paul Gilbert: 
 > Ross> The intent of "make clean" is to remove the temporaries but leave a
 > Ross> complete runnable R.  It is quite useful when you have installed
 > Ross> versions of R.  Maybe the "make clean" / "make distclean" distinction
 > Ross> needs to be explicit in the "INSTALL" file.
 > 
 > I had assumed "make clean" would leave a complete runnable R, that is my
 > runnable R wouldn't get messed up until I did "make" which does "install", which
 > can potentially mess up my running R. But I had also assumed that when I did
 > "make" I would be starting clean, which is not completely true it seems - at
 > least as far as the architecture and other stuff as determined by configure are
 > concerned.
 > 
 > I'm not sure what would be the best approach to make things easy for novices. I
 > don't use "make clean" very often for R and it is probably more of a utility for
 > developers - but I did get caught this time. My usual approach is just to delete
 > everything and start over with the tar file. I think, however, that anything
 > like "make distclean" or "make realclean" or "make acclean" is going to be even
 > more of a utility for developers - they all assume you are familiar with the
 > Makefile, or, if they are documented, that you read the documentation
 > (regularly, since these things change).
 > 
 > Probably the best thing to make it easy for novices is to have some "install" or
 > "setup" script which does all of the appropriate steps. This should also make
 > certain that everything is sufficiently clean that there won't be any mistakes.

I agree!

The (good!) tradition Peter Dalgaard addresses means

- "make" -- OK, we all know...

- "make clean" returns to the state after configure

- "make distclean" returns to the state before configure

- "make install" installs the whole at the standard place /usr/local
which may be redirected by "configure --prefix=..."

Everyone knows it and one may be irritated if there is another
arrangement (OK, may be I become old :-)

I allready wanted to suggest you authors to add that install target
because

- I don't like to build the whole stuff in /usr/local
- I don't like to have the R script point to any build directory
- I don't want to think about which files have to be moved to
/usr/local for the program to run correctly. The author knows that (I
hope :-)

As for R, there is no clean separation between the build stuff and the
run stuff. I would like to have it.

But anyway: Thanks for that program!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Tue May  5 15:55:39 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 5 May 1998 16:55:39 +0200 (CEST)
Subject: lSM  lICE: not found
In-Reply-To: <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>
References: <199805042217.KAA26841@stat1.stat.auckland.ac.nz>
 <98May5.100515edt.13450@mailgate.bank-banque-canada.ca>
 <199805051444.QAA08063@wrin27.urz.uni-wuppertal.de>
Message-ID: <13647.10347.618706.726445@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 5 May 1998 16:44:09 +0200 (MDT),
>>>>> Hubert Palme (HP) wrote:


HP> I allready wanted to suggest you authors to add that install target
HP> because

HP> - I don't like to build the whole stuff in /usr/local
HP> - I don't like to have the R script point to any build directory
HP> - I don't want to think about which files have to be moved to
HP> /usr/local for the program to run correctly. The author knows that (I
HP> hope :-)

HP> As for R, there is no clean separation between the build stuff and th=
e
HP> run stuff. I would like to have it.

The authors also want to have it for quite some time ;-) ... meaning
it's on our TODO list for 0.62 since I can't recall when ...

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May  5 17:36:33 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 May 1998 18:36:33 +0200
Subject: make and all that..
In-Reply-To: <x290ohb1kv.fsf@biostat.ku.dk> (message from Peter Dalgaard BSA
 on 05 May 1998 09:48:16 +0200)
Message-ID: <199805051636.SAA04565@sophie.ethz.ch>


>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

     ......

    PD> I know there's a lot of tradition and conventions in how to setup
    PD> makefiles, but wouldn't it be handy with a "rebuild" type target?

    PD>		rebuild: realclean R

I like your proposition!

(and I won't be the one who writes an ./Install shell script!

 I personally think, 'make <target>' should be enough;
 however, I agree that the documentation could be improved.

 I don't expect people who don't read an ./INSTALL or ./README file
 to install or run R...
)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 18:09:35 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 13:09:35 -0400
Subject: make and all that..
References: <199805051636.SAA04565@sophie.ethz.ch>
Message-ID: <98May5.133306edt.13450@mailgate.bank-banque-canada.ca>

>I don't expect people who don't read an ./INSTALL or ./README file
> to install or run R...

And here I was just thinking how much fun it would be to burn a CD  so everyone
could just stick it in their machine and R would pop up, maybe even with a GUI
interface.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May  5 18:18:02 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 5 May 1998 19:18:02 +0200
Subject: make and all that..
In-Reply-To: <98May5.133306edt.13450@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 5 May 1998 13:09:35 -0400)
Message-ID: <199805051718.TAA04644@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> I don't expect people who don't read an ./INSTALL or ./README file
    >> to install or run R...

    PaulG> And here I was just thinking how much fun it would be to burn a
    PaulG> CD so everyone could just stick it in their machine and R would
    PaulG> pop up, maybe even with a GUI interface.

Paul, the above behavior ``works'' with binary distributions
	(we have at least Debian and RedHat for Linux),
but never with source code distributions.

We are following  quite a standard approach for source code distributions
having the

	1)
	  ## Edit config.site manually if you want special behavior

	2) 
	  configure
		## configure with arguments if you want....

	3)
	  make

The only thing missing is a ``proper''

	4)
	  make install

which Kurt and Fritz (;-}) will probably provide for R 0.62
which seems to be due currently for Mid-June or so.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue May  5 19:22:38 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 5 May 1998 14:22:38 -0400
Subject: make and all that..
References: <199805051718.TAA04644@sophie.ethz.ch>
Message-ID: <98May5.144613edt.13447@mailgate.bank-banque-canada.ca>

Martin

Don't take me too seriously on this. I think you are all doing a great job and
I'm amazed at how well everything usually works in R. Besides, if I wanted to
have things automatically execute when I stick in the CD I'd probably be working
in Windows, not on Unix.

About "make install", I usually think of this as a last step, after you've
successfully made everything, to put things in the proper place for users to
have access. Maybe I'm wrong on the usual convention, but I don't think of it as
necessarily starting at the beginning. What I was suggesting with an install
script (setup may be a better name) was something that would make sure
everything was very clean and start at the beginning with configure and make.
This is not a high priority, but it also does not have to be very difficult. It
might simply be a script with lines

make extrasuperclean
configure
make
make doc
make install

or something like that. I realize this may not work for every case, but I think
it can work very well for a large percentage of the simple cases. The main
advantage of something like this is that after a while dumb users like me start
to know the install script does everything and we can just type "install". That
way developers can play with the makefile more easily and not worry too much if
the documentation is completely up-to-date, as long as the install script works
and the documentation still says "use the install script". (I've been on the
other side of this - the problem with documentation is that it's usually for a
previous version. After a while it is much easier to test that a script works
than it is to make sure the documentation is correct.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May  6 11:01:35 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 May 1998 12:01:35 +0200
Subject: min(numeric(0)) = ?   -- proposal for "S incompatible change"
Message-ID: <199805061001.MAA05776@sophie.ethz.ch>

[Same question for  max(.),  cummin(.) and cummax(.)]

In S, S-plus and R, this currently gives NA.

I wonder if it wouldn't make more sense to follow common
mathematical/logical reasoning here:

	min { empty set } = +Inf

	max { empty set } = -Inf

(For integers, these would be  INT_MAX and INT_MIN, respectively).

Maybe this is a real ``first time'':

	I am proposing a change which would lead from
	"S compatible" to  "S incompatible"

	{since I don't expect S to change, 
	 given my recent experience with my plea to change 'n %% m' 
	 (for negative n or m, the result DIFFERS, depending on
	  storage.mode = "integer" or "double" !!!)

	Note that I've spent quite a bit more thought on the "%%" issue 
	than on this one!


Comments?
Pros/ Cons?

Martin Maechler <maechler@stat.math.ethz.ch>			<><
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May  6 11:27:16 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 6 May 1998 12:27:16 +0200
Subject: min(numeric(0)) = ?  == SORRY:  R already has  +/- Inf
In-Reply-To: <199805061001.MAA05776@sophie.ethz.ch> (message from Martin
 Maechler on Wed, 6 May 1998 12:01:35 +0200)
Message-ID: <199805061027.MAA05825@sophie.ethz.ch>

My last message stated something wrong:

In R 0.62, we already have

    > min(numeric(0))
    [1] Inf
    > max(numeric(0))
    [1] -Inf
    > max(integer(0))
    [1] -Inf
    > min(integer(0))
    [1] Inf

The only change I'd propose is to return 'integer' if all arguments are
'integer', i.e., e.g.,
	
	min(integer(0))  would return  .Machine$int.max

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 14:17:30 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 15:17:30 +0200 (MDT)
Subject: Compiling on SGI Irix 5.3
Message-ID: <199805061317.PAA12784@wrin27.urz.uni-wuppertal.de>

Hello,

I successfully compiled 0.61.3 on SGI Irix 5.3 (CC). But there is a
syntax bug in src/graphics/graphics.c. I append a diff. Please, have a 
look wether the fix is correct! (I'm not shure :-)

Thanks for the SHELL variable in the Makefile's. Please, don't forget
about the problem with externally installed regular expression
libraries (e.g. librx). Perhaps you can improve the configure
script...

Thanks!
HP.

*** src/graphics/graphics.c.origin      Fri Mar 13 11:51:50 1998
--- src/graphics/graphics.c     Tue May  5 15:25:25 1998
***************
*** 805,812 ****
        *ndiv = nu - ns;
  
        if(*ndiv <= 0)
!         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);
!                dx=%g, unit=%3e, ismall=%1d.\n",
                 x1,x2, nd0, cell, *ndiv, ns, nu, dx, unit, (int)i_small);
  }
  
--- 805,812 ----
        *ndiv = nu - ns;
  
        if(*ndiv <= 0)
!         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);"
!                "\t\t dx=%g, unit=%3e, ismall=%1d.\n",
                 x1,x2, nd0, cell, *ndiv, ns, nu, dx, unit, (int)i_small);
  }

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 14:35:57 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 15:35:57 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
Message-ID: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>

I forgot:

"make docs" for LaTeX doesn't collect any information about the
functions. So in Man.dvi the appendix C is empty. A Bug??

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May  6 14:57:22 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 May 1998 15:57:22 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Wed, 6 May 1998 15:35:57 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
Message-ID: <x27m3zzem5.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

> 
> I forgot:
> 
> "make docs" for LaTeX doesn't collect any information about the
> functions. So in Man.dvi the appendix C is empty. A Bug??
> 

In your LaTeX setup, perhaps... No problem on Linux. Or the Makefile
is using stuff that only works with GNU make. You may have to do that
step manually.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May  6 15:41:16 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 6 May 1998 16:41:16 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > palme@uni-wuppertal.de (Hubert Palme) writes:
 > 
 > > 
 > > I forgot:
 > > 
 > > "make docs" for LaTeX doesn't collect any information about the
 > > functions. So in Man.dvi the appendix C is empty. A Bug??
 > > 
 > 
 > In your LaTeX setup, perhaps... No problem on Linux. Or the Makefile
 > is using stuff that only works with GNU make. You may have to do that
 > step manually.

(cd ../doc/manual; gmake Man.dvi)
gmake[2]: Entering directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
Collecting components of  pkg-base.tex ..
gmake[2]: execvp: /bin/sh: Arg list too long
gmake[2]: *** [pkg-base.tex] Error 127
gmake[2]: Leaving directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
gmake[1]: [../doc/manual/Man.dvi] Error 2 (ignored)
gmake[1]: Leaving directory `/daten/softy/software/Statistik/R/R-0.61.3/etc'

May be it's time to split this step?!?

How can I do it myself?

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May  6 16:37:31 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 May 1998 17:37:31 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Wed, 6 May 1998 16:41:16 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
Message-ID: <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

>  > > "make docs" for LaTeX doesn't collect any information about the
>  > > functions. So in Man.dvi the appendix C is empty. A Bug??
> 
> (cd ../doc/manual; gmake Man.dvi)
> gmake[2]: Entering directory `/daten/softy/software/Statistik/R/R-0.61.3/doc/manual'
> Collecting components of  pkg-base.tex ..
> gmake[2]: execvp: /bin/sh: Arg list too long

Uh, oh... 

$ echo ../../library/base/latex/*.tex | wc
      1     325   11850

A 12K command line! I can believe that that might be a problem on some
systems.

The way to split it must be something along the lines of replacing the
last line of

pkg-base.tex: $(RLIB)/base/latex/*.tex
        @echo 'Collecting components of  $@ ..'
        @sed 's/__PKG__/base/g' Pkg-start.tex | cat - $^ Pkg-end.tex > $@

with
	@cat $(RLIB)/base/latex/[A-e]*.tex > pkg-base.1
	@cat $(RLIB)/base/latex/[f-p]*.tex > pkg-base.2
	@cat $(RLIB)/base/latex/[q-z]*.tex > pkg-base.3
        @sed 's/__PKG__/base/g' Pkg-start.tex |\
		 cat - pkg-base.[123] Pkg-end.tex > $@
	@rm pkg-base.[123]

You may need to adjust the boundaries there of course.

Another option could be


	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
		find $(RLIB)/base/latex/ -name '*.tex' -print |\
		 sort | xargs cat ;\
		 cat Pkg-end.tex) > $@

But does all relevant systems have the xargs command?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May  7 13:59:16 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 May 1998 14:59:16 +0200
Subject: R-beta: 0.61.3: Problems on DEC Unix 4.0
In-Reply-To: <Pine.OSF.3.93.980507083904.16406B-100000@alpha2-stat.sci.uni-klu.ac.at>
 (message from Albrecht Gebhardt on Thu, 7 May 1998 14:51:55 +0200 (MET
 DST))
Message-ID: <199805071259.OAA08264@sophie.ethz.ch>


>> cc: Error: graphics.c, line 808: An unexpected newline character is present
>>  in a string literal.
>>         printf("Gpretty(%g,%g,%d): cell=%g, ndiv= %d <=0;\t\t(ns,nu)=(%d,%d);
>> ---------------^
We had already Hubert Palme (SGI Irix) complaining about this and proposing
(a slightly different) patch (I prefer your patch).

This is mea culpa.
It works (w/o patch!), both with Solaris 'cc' and  'gcc'
(and isn't it ANSI C ?).

Sorry!


I just found another buglet (in 0.61.x and 0.62.snap):

    > prod(c(1:3,NA,pi),na.rm=FALSE)
    [1] NA
    > prod(c(1:3,NA,pi),na.rm=TRUE)
    R(bug): [1] NA
    S(ok) : [1] 18.84956

This is in main/summary.c  which I am patching anyway..

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May  7 14:04:49 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 7 May 1998 15:04:49 +0200
Subject: R-beta: 0.61.3: Problems on DEC Unix 4.0
In-Reply-To: <199805071259.OAA08264@sophie.ethz.ch> (message from Martin
 Maechler on Thu, 7 May 1998 14:59:16 +0200)
Message-ID: <199805071304.PAA08279@sophie.ethz.ch>

Sorry, I am getting old and silly and careless and .....

The  prod(.) problem  is  *NOT*  in 0.61.x !!

R-0.61.3  behaves as it should:

    > prod(c(1:3,NA,pi),na.rm=TRUE)
    [1] 18.84956
    > prod(1:3,NA,pi, na.rm=TRUE)
    [1] 18.84956
---
Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Thu May  7 14:46:11 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Thu, 7 May 1998 15:46:11 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > 
 > Uh, oh... 
 > 
 > $ echo ../../library/base/latex/*.tex | wc
 >       1     325   11850
 > 
 > A 12K command line! I can believe that that might be a problem on some
 > systems.
 > 
 > The way to split it must be something along the lines of replacing the
 > last line of
 > 
 > pkg-base.tex: $(RLIB)/base/latex/*.tex
 >         @echo 'Collecting components of  $@ ..'
 >         @sed 's/__PKG__/base/g' Pkg-start.tex | cat - $^ Pkg-end.tex > $@
 > 
 > with
 > 	@cat $(RLIB)/base/latex/[A-e]*.tex > pkg-base.1
 > 	@cat $(RLIB)/base/latex/[f-p]*.tex > pkg-base.2
 > 	@cat $(RLIB)/base/latex/[q-z]*.tex > pkg-base.3
 >         @sed 's/__PKG__/base/g' Pkg-start.tex |\
 > 		 cat - pkg-base.[123] Pkg-end.tex > $@
 > 	@rm pkg-base.[123]

This works...

 > 
 > You may need to adjust the boundaries there of course.

... without adjusting (the [x-y] boundaries I guess).

 > 
 > Another option could be
 > 
 > 
 > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
 > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
 > 		 sort | xargs cat ;\
 > 		 cat Pkg-end.tex) > $@
 > 
 > But does all relevant systems have the xargs command?

Irix does, but the first solution is better understandable :-)

Thanks!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu May  7 15:20:15 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 May 1998 16:20:15 +0200
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: palme@uni-wuppertal.de's message of Thu, 7 May 1998 15:46:11 +0200 (MDT)
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
 <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>
Message-ID: <x24sz29n8g.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

>  > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
>  > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
>  > 		 sort | xargs cat ;\
>  > 		 cat Pkg-end.tex) > $@
>  > 
>  > But does all relevant systems have the xargs command?
> 
> Irix does, but the first solution is better understandable :-)

But the latter *never* creates too long command lines (xargs is built
to handle that). The other one has the problem that we have to guess
relevant splitting points for systems that we do not have...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Thu May  7 15:38:29 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Thu, 7 May 1998 16:38:29 +0200 (MDT)
Subject: Once more: Compiling on SGI Irix 5.3
In-Reply-To: <x24sz29n8g.fsf@blueberry.kubism.ku.dk>
References: <199805061335.PAA12940@wrin27.urz.uni-wuppertal.de>
 <x27m3zzem5.fsf@blueberry.kubism.ku.dk>
 <199805061441.QAA13559@wrin27.urz.uni-wuppertal.de>
 <x21zu7z9z8.fsf@blueberry.kubism.ku.dk>
 <199805071346.PAA19029@wrin27.urz.uni-wuppertal.de>
 <x24sz29n8g.fsf@blueberry.kubism.ku.dk>
Message-ID: <199805071438.QAA19486@wrin27.urz.uni-wuppertal.de>

Peter Dalgaard BSA: 
 > palme@uni-wuppertal.de (Hubert Palme) writes:
 > 
 > >  > 	@(sed 's/__PKG__/base/g' Pkg-start.tex; \
 > >  > 		find $(RLIB)/base/latex/ -name '*.tex' -print |\
 > >  > 		 sort | xargs cat ;\
 > >  > 		 cat Pkg-end.tex) > $@
 > >  > 
 > >  > But does all relevant systems have the xargs command?
 > > 
 > > Irix does, but the first solution is better understandable :-)
 > 
 > But the latter *never* creates too long command lines (xargs is built
 > to handle that). The other one has the problem that we have to guess
 > relevant splitting points for systems that we do not have...

So you should use this.

Anyway, the user should have GNU Make installed (the Irix make doesn't
work whith this Makefile). Why not install GNU Findutils if the target
system doesn't have xargs...

But do write this into the INSTALL file!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu May  7 16:38:35 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 May 1998 17:38:35 +0200
Subject: R-beta: scripting with R?
In-Reply-To: Luke Tierney's message of Thu, 7 May 1998 10:03:50 -0500 (CDT)
References: <9805071503.AA23870@nokomis.stat.umn.edu>
Message-ID: <x2yawe851g.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> Unless I'm very much mistaken (which would not be the first time :-))
> I think you can mix console and graphics behavior under Win32 (NT and
> 95, not Win32s) in one application. So having command line options
> that choose between creating a command window or using standard
> input/output would be possible. I haven't looked into th details yet,
> but I'm pretty sure it can be done.

Yes. In particular, a console application can do graphs. But if you
want to support Win32s, you're more or less stuck with the current
model.

Another thing: if you want the windowed text interface (scrollbars!)
launched from console program, I suspect you get a dangling "DOS-box".
I've only seen link-time solutions to that one.

So it's probably easier just to make two different .exe files...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Thu May  7 17:16:17 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Thu, 7 May 1998 11:16:17 -0500 (CDT)
Subject: R-beta: scripting with R?
In-Reply-To: <x2yawe851g.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at May 7, 98 05:38:35 pm
Message-ID: <9805071616.AA23929@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Another thing: if you want the windowed text interface (scrollbars!)
> launched from console program, I suspect you get a dangling "DOS-box".
> I've only seen link-time solutions to that one.
> 

I think it may be possible to handle that with some of the console api
functions, but I'm not sure.

> So it's probably easier just to make two different .exe files...

Probably true. But it may make sense to factor it as Win32s/real Win32
rather that console/gui.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu May  7 20:22:35 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Thu, 7 May 1998 20:22:35 +0100 (GMT+0100)
Subject: R-beta: scripting with R? (and also some news on RSXNT)
In-Reply-To: <x290oe9pqv.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at May 7, 98 03:26:00 pm
Message-ID: <19980507192235.11930.qmail@sirio.stat.unipd.it>

Peter Dalgaard BSA writes:
> 
> zk@biocem.univ-bpclermont.fr (Zivan Karaman) writes:
> 
> > Does it work (and how) under Windows? (I'm using the version compiled by
> > Guido Masarotto on an NT4 machine).
> 
> Nope. With Win32 (95/NT) you have to decide whether to write a
> "console application" or a "windowed" one. Guido's is of the latter
> variety and you need the former in order to do redirections etc. 
   
   A simple solution would be to introduce a command-line option, e.g.,
   R -save/nosave -source FileName1 FileName2 .....
   with a obvious meaning, or maybe
   R -save/nosave FileName FileName1 FileName2 .....
   This seems easy to do and can be a interesting option also under
   Unix since, it is only my opinion, it provides a cleaner interface.
   Perhaps, under MSWindows or other "windowed" version, we should
   provide also a -iconic option.
   
   
> It is in fact quite easy to do a console R with the mingw32 tools and
> (probably) also with RSXNT. Start with the Unix sources and throw out
> anything that refuses to compile, such as the X11 stuff and things
> related to system() (the latter might be fakeable, but won't work out
> of the box). 

  I can confirm that it easy. This was my first attempt and in half an
  hour I have a console R working (no dynamic linking, but I 
  suppose that you can include the dynload.c from Windows).
  Anyway, I didn't keep the modified source.
  The problems with the system() stuff under MsWindows is not the
  C system() function that works but the R shell scripts (which
  of course require a Unix shell). 
  I don't know if it is already in the TODO list, but a low
  priority suggestion is to insert somewhere (CFLAGS, Platform.h
  I don't know where) a NOX11 flag.
  
  BTW, this morning, I had some time and I tried to recompile R
  (the last "stable" version, i.e., 0.61.3) with RSXNT.
  It seems to work (but I just tryed a couple of demos
  under Win95). 
  I just used my mingw32 port and the mingw32 winapi header
  and didn't try to use g77 (Ok, I tryed but it didn't work,
  I don't know why).
  I hope to put something available the next week.
  In particular, I want to try to use R.exe as a dll so that
  dynamic libraries can use R_alloc, callS ....
  I was not able to do this with egcs-mingw32 (I tryed all
  the rules that I found to build a relocable exe with the
  gnu binutils but  no one worked; suggestion?) but
  I made some tests with RSXNT (not with R, however) with
  good results. A minor problem is that the standard C stack
  is not large enough to execute all the demos. I can
  increase it but not dinamically. How can I determine a reasonable
  value?
  
  guido masarotto

  

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 20:37:42 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 15:37:42 -0400
Subject: more on library()
Message-ID: <98May11.165202edt.13485@mailgate.bank-banque-canada.ca>

The problem with multiple packages in a library that I reported a few minutes
ago seems to occur only if RLIBS ends in a ":". I was setting
RLIBS=../padi/rlib:$RLIBS and when RLIBS has no value to begin with this causes
the problem.

This is obviously not very urgent as I can get around it easily.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 20:08:14 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 15:08:14 -0400
Subject: library()
Message-ID: <98May11.165206edt.13495@mailgate.bank-banque-canada.ca>

In 0.61.3 there seems to be some problem with multiple packages. library()
recognizes them but library("name") only finds the first one. Suggestions would
be appreciated.

Paul Gilbert
_____

Version 0.61.3  (May 3, 1998)
> library()
Packages in library `/home/res/gilp/padi/pub/padi.v1beta4/R.client/rlibs':

padi            Protocol for Application/Database Interface
syskern         coding kernel for S/R and OS compatability
tframe          Time Frame coding kernel

Packages in library `/home/res4/gilp/R-versions/R-0.61.3/library':

base            The R base package
eda             Exploratory Data Analysis
mva             Classical Multivariate Analysis
stepfun         Step Functions, including Empirical Distributions
> library("padi")
> library("syskern")
Error: There is no package called `syskern'


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Mon May 11 22:13:28 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 11 May 1998 14:13:28 -0700 (PDT)
Subject: more on library()
In-Reply-To: <98May11.165202edt.13485@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980511141216.8317B-100000@gorn>

On Mon, 11 May 1998, Paul Gilbert wrote:

> The problem with multiple packages in a library that I reported a few minutes
> ago seems to occur only if RLIBS ends in a ":". I was setting
> RLIBS=../padi/rlib:$RLIBS and when RLIBS has no value to begin with this causes
> the problem.
> 

I can't reproduce this even when RLIBS ends in ":". I've tried in both
tcsh and bash, and on Solaris and Debian (ie /bin/sh is bash) systems.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon May 11 22:32:42 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 11 May 1998 17:32:42 -0400
Subject: more on library() - my error
Message-ID: <98May11.173338edt.13444@mailgate.bank-banque-canada.ca>

Another stupid error on my part. I've just discovered that I managed to install
an empty library. I'm not sure how hard that is to do. I installed the source in
the location where the rlib was suppose to go. This seemed to put in place
enough of the pieces that the name and description were picked up, but the
R/padi.R file didn't get converted to R/padi.

Sorry for the false report.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May 13 08:07:09 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 13 May 1998 09:07:09 +0200
Subject: readline installation [Re: R-beta: ....]]
Message-ID: <199805130707.JAA10115@sophie.ethz.ch>

I think, we should give more hints on installing / using readline with R.

Maybe there could be one ASCII file
	README-readline-Installation

added to the FTP sites  *and* to R-0.61.3.tar.gz
explaining some the things  Peter Dalgaard just said on R-help.

I agree with Jan that it's a pity for non-programmer-hackers  if they won't
be able to use readline (most probably, these are the ones who will not be
using ESS [= Emacs Speaks Statistics] either!),
or even they won't even realize that there readline *was* available.

Further, for R 0.62, I think we should try quite a bit harder to
have configure searching around for the readline library and include files.
[[maybe, yet again look more closely at what octave does?]]

Martin

----------------

FYI, I got the following, yesterday, privately.

>> Date: Tue, 12 May 1998 10:28:09 +0200 (MET DST)
>> From: Jan Kutylowski <janku@ifi.uio.no>
>> To: maechler@stat.math.ethz.ch
>> CC: ajanku@ulrik.uio.nox
>> In-reply-to: message from Martin Maechler on Fri, 8 May 1998 14:40:28 +0200
>> Subject: Re: R-beta: [ajanku@ulrik.uio.no: R-0.61.3 with readline]

>> MM> This was accidentally sent to 
>> MM> R-help-owner instead of R-help  
>> 
>> thanks for forwarding it
>> 
>> MM> [why on earth ??]
>> 
>> People desperate for command line editing will do about everything to get
>> help after a local guru cannot decipher bysantine intricacies of the
>> makefiles in the current distribution. They will write to the White House,
>> contact scientology, whatever, they may even  come across an old e-mail
>> message and when they see R ... here they go.
>> 
##>> More seriously, this feature of R is so basic that it must be better
##>> documented. Current functionality of R deserves attraction from a broader
##>> range of users than those who can figure out how to modify a particular
##>> piece of one of the many makefiles.
>> 
>> I hope you will find my comment useful.
>> 
>> A. Jan Kutylowski




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 09:42:22 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 10:42:22 +0200 (MDT)
Subject: readline installation [Re: R-beta: ....]]
In-Reply-To: <199805130707.JAA10115@sophie.ethz.ch>
References: <199805130707.JAA10115@sophie.ethz.ch>
Message-ID: <199805130842.KAA20200@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > 
 > Further, for R 0.62, I think we should try quite a bit harder to
 > have configure searching around for the readline library and include files.
 > [[maybe, yet again look more closely at what octave does?]]

Another request being very important for me is to have configure
search for regexpression libraries if there are no POSIX regular
expressions on the local system. Some funktions don't work without
this and it is very hard to configure this manually!

Thamks,
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 09:43:47 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 10:43:47 +0200 (MDT)
Subject: readline installation [Re: R-beta: ....]]
In-Reply-To: <199805130707.JAA10115@sophie.ethz.ch>
References: <199805130707.JAA10115@sophie.ethz.ch>
Message-ID: <199805130843.KAA20203@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > 
 > Further, for R 0.62, I think we should try quite a bit harder to
 > have configure searching around for the readline library and include files.
 > [[maybe, yet again look more closely at what octave does?]]

Another request being very important for me is to have configure
search for regexpression libraries (such as the GNU rx library) if
there are no POSIX regular expressions on the local system. Some
funktions don't work without this and it is very hard to configure
this manually!

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Wed May 13 14:02:26 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Wed, 13 May 1998 15:02:26 +0200 (MDT)
Subject: R-beta: package ported from S to R
In-Reply-To: <199805131050.MAA10416@sophie.ethz.ch>
References: <199805131030.MAA20912@wrin27.urz.uni-wuppertal.de>
 <199805131050.MAA10416@sophie.ethz.ch>
Message-ID: <199805131302.PAA21564@wrin27.urz.uni-wuppertal.de>

Martin Maechler: 
 > >>>>> "Hubert" == Hubert Palme <palme@uni-wuppertal.de> writes:
 > 
 >     Hubert> Hello, I'm trying to port the S package "print.display" to
 >     Hubert> R. The porting procedure seemed to work, but when I say
 >     Hubert> library(print.display) or library("print.display"), then none
 >     Hubert> of the functions is available. May be, it's because of the dot
 >     Hubert> in the package name?
 > 
 > Not really; I do have package with a "." which works..
 > 
 >     Hubert> What could have happened?
 > no idea.
 > You should send a real "log" of what you did (and the output)
 > -- but NOT to R-help, but rather to R-devel.

OK, This one I send to both, the next one only to r-devel.

 > 
 >     Hubert> The help information is available.
 > 
 >     Hubert> BTW: How can I look up wether the package is really loaded?
 > 
 > search()
 > 
 > should show you (in your case)
 > 
 > [1] ".GlobalEnv"   "package:print.display"  "Autoloads"    "package:base"
 > 		    ---------------------
 > and 
 > 	ls(pos=2)
 > 
 > would show your objects

It is strange: I jist restarted R to try out search(), but now
print.display loads! Don't know what happened... But the next step I
wanted to try was to install the package without dot. So I won't --
Thanks for this hint.

Friedrich Leisch: 
 > 
 > How and where did you install the package? Using the R INSTALL
 > mechanism or by hand? Is it in the library search path .lib.loc?

Yes and yes.

OK, hopefully it stayes loading correctly now, so I'll try to debug
it. There is an unknown function "unix". Is "system" the R
replacement? If yes: There is no "input" parameter. How can I redirect
input with "system"?

Is there also a replacement for "!" ?

Thanks a lot!

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 13 17:07:00 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 May 1998 09:07:00 -0700 (PDT)
Subject: R-beta: package ported from S to R
In-Reply-To: <199805131302.PAA21564@wrin27.urz.uni-wuppertal.de>
Message-ID: <Pine.SUN.3.95.980513090201.7060A-100000@chekov>

On Wed, 13 May 1998, Hubert Palme wrote:
> 
> OK, hopefully it stayes loading correctly now, so I'll try to debug
> it. There is an unknown function "unix". Is "system" the R
> replacement? If yes: There is no "input" parameter. How can I redirect
> input with "system"?
> 
> Is there also a replacement for "!" ?
> 

The function system() replaces both of them.  There is no input=
parameter, it looks like we typically use paste() -- for example see
system.file() or help.start().

You can replace unix.shell() with system("/bin/sh") or other shell of your
choice.


Thomas Lumley
------------------------
Biostatistics		
Uni of Washington	
Box 357232		
Seattle WA 98195-7232	
------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 13 19:38:47 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 May 1998 14:38:47 -0400
Subject: all.equal
Message-ID: <98May13.144046edt.13459@mailgate.bank-banque-canada.ca>

I need the function all.equal which is in Splus but not yet in R. Below is a
first cut. Comments would be appreciated.

Paul Gilbert
_______

all.equal <- function(obj1, obj2, ...)
  {if(mode(obj1)      != mode(obj2) )      return("modes differ.")
   if(class(obj1)     != class(obj2))      return("classes differ.")
   if(! all(unlist(attributes(obj1)) == unlist(attributes(obj2))))
                                           return("attributes differ.")
   if(! all(unlist(obj1) == unlist(obj2))) return("values differ.")
   T
  }


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 13 21:01:33 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 13 May 1998 13:01:33 -0700 (PDT)
Subject: all.equal
In-Reply-To: <98May13.144046edt.13459@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.980513124031.7729A-100000@chekov>

On Wed, 13 May 1998, Paul Gilbert wrote:

> I need the function all.equal which is in Splus but not yet in R. Below is a
> first cut. Comments would be appreciated.
> 

I think it should return T/F rather than text.  You could have the reason
returned as an attribute or printed as a warning().

Some slight fuzziness in equality for real numbers might make this
function more useful (perhaps it should be optional/settable
eg all.equal(a,b,epsilon=100*.Machine()$double.eps) might use

	d<-a-b	
	all(abs(d)<epsilon)
or
	all(abs(d)/(abs(a)+abs(b))<epsilon)

since rounding error can creep in even with highly accurate computations.
For example, the survival4 library Examples suite has things which are
all.equal() in S-PLUS but differ by perhaps 1e-16 or so in R.

The test for equal values currently uses recycling for objects of
different lengths, so 1:5 and rep(1:5,2) are all.equal(). You would
probably want to insert a test on lengths.

Also, the current version crashes if fed objects whose components are not
comparable 
	eg a<-lm(y~x); b<-a; all.equal(a,b) gives
	Error: comparison is possible only for vector types
I don't know if this is right or not.

	-thomas


Thomas Lumley
------------------------
Biostatistics		
Uni of Washington	
Box 357232		
Seattle WA 98195-7232	
------------------------


> 
> all.equal <- function(obj1, obj2, ...)
>   {if(mode(obj1)      != mode(obj2) )      return("modes differ.")
>    if(class(obj1)     != class(obj2))      return("classes differ.")
>    if(! all(unlist(attributes(obj1)) == unlist(attributes(obj2))))
>                                            return("attributes differ.")
>    if(! all(unlist(obj1) == unlist(obj2))) return("values differ.")
>    T
>   }
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 13 22:23:40 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 13 May 1998 17:23:40 -0400
Subject: all.equal
References: <Pine.SUN.3.95.980513124031.7729A-100000@chekov>
Message-ID: <98May13.172537edt.13443@mailgate.bank-banque-canada.ca>

>I think it should return T/F rather than text.  You could have the reason
>returned as an attribute or printed as a warning().

I'm doing this only for compatability with Splus. In fact, the way I've used it
in my code is

   is.logical(all.equal(...))

which gives the T/F result.

I think the tolerance is a good idea. Thanks for pointing out other problems. I
just fixed one of them. I'll circulate a new version tomorrow.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 14 16:06:11 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 14 May 1998 11:06:11 -0400
Subject: all.equal - cut two, test.equal
Message-ID: <98May14.112616edt.13521@mailgate.bank-banque-canada.ca>

Below is a second cut at all.equal and also a generic function test.equal which
is intended to return a T/F value. The default method uses all.equal, which is
the reason I was looking for all.equal in the first place. Prompted by Thomas
Lumley's observation that a T/F result makes more sense I thought it would be
worthwhile to indicate what I'm really doing.

I have been using test.equal for a few  years in a fairly extensive set of tests
for my time series library. My tests never get to the all.equal part of the
default method, so I have only just noticed the absence of this function. This
approach to testing equality works very well since it allows for a class
specific definition of when things are equal. It was originally suggested to me
by John Chambers, in the context of a question I had about error trapping which,
since I'm on the subject, I will describe shortly in a separate post.

One shortcoming of the following all.equal is that numeric elements of a list
are not compared using tolerance. If anyone has a simple suggestion for
extracting the numeric parts of a list I would like to incorporate it.

Paul Gilbert
_______

test.equal <-function (obj1, obj2, ...)  UseMethod("test.equal")

 test.equal.default <-function (obj1, obj2, ...)
{ if (is.array(obj1))    test.equal.array(obj1, obj2, ...)
   else                         is.logical(all.equal(obj1, obj2, ...))
}

all.equal <- function(obj1, obj2, tolerance=100*Machine()$double.eps)
  {if(mode(obj1)      != mode(obj2) )               return("modes differ.")
   if (length(obj1) != length(obj2) )               return("lengths differ")

   if(is.null(class(obj1)) != is.null(class(obj2))) return("classes differ.")
   else if(!is.null(class(obj1))
           && any(class(obj1) != class(obj2)) )     return("classes differ.")


   if(is.null(attributes(obj1)) != is.null(attributes(obj2)))
                                                    return("attributes differ.")

   else if(!is.null(attributes(obj1))
           && any(unlist(attributes(obj1)) != unlist(attributes(obj2))))
                                                    return("attributes differ.")

   # The mode test above insures that both are numeric if one is. A shortcoming
   # here is that for a list with some numeric components, the components are
   # not compared using the tolerance test.
   if(is.numeric(obj1))
      {if (any(abs(obj1 -obj2) > tolerance))
                               return("value differences exceed tolerance.") }
   else if (! all(unlist(obj1) == unlist(obj2)))     return("values differ.")
   T
  }



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 14 16:21:56 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 14 May 1998 11:21:56 -0400
Subject: error trapping
Message-ID: <98May14.112731edt.13594@mailgate.bank-banque-canada.ca>

One thing I've found missing in S/R is the ability to test error trapping. I
have written a fairly extensive set of tests for my time series library but I
can only test that things work for cases where they are suppose to work. In
several places my code is suppose to recognize error conditions, like invalid
inputs, and make calls to stop() or warn(), but there is no automatic way to
check these in my test suite.

I really would like to be able to write a code testing program which would be
able to specify that I am about to generate a "stop" condition with a given
message, then do it, then continue, accepting that that was the right result.

This is not a high priority, but it is worth keeping on the wish list.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu May 14 16:58:13 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 14 May 1998 08:58:13 -0700 (PDT)
Subject: error trapping
In-Reply-To: <98May14.112731edt.13594@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980514085355.28600B-100000@gorn>

On Thu, 14 May 1998, Paul Gilbert wrote:

> One thing I've found missing in S/R is the ability to test error trapping. I
> have written a fairly extensive set of tests for my time series library but I
> can only test that things work for cases where they are suppose to work. In
> several places my code is suppose to recognize error conditions, like invalid
> inputs, and make calls to stop() or warn(), but there is no automatic way to
> check these in my test suite.
> 
> I really would like to be able to write a code testing program which would be
> able to specify that I am about to generate a "stop" condition with a given
> message, then do it, then continue, accepting that that was the right result.
> 

I have recently had another need for this.  If you are doing simulations
comparing your (wonderful) new method to someone else's (hopelessly
inferior)  old method and their S-PLUS code crashes about 5% of the time
then it gets very tedious to run several hundred samples
semi-interactively.  Trapping the error would be a lot more convenient
than trying to rewrite someone else's code to fail gracefully.

Of course in your own code you wouldn't dream of doing something like that
;-).

	-thomas




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri May 15 18:32:28 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 15 May 1998 13:32:28 -0400
Subject: couldn't find function "print.tframe"
Message-ID: <98May15.133522edt.13671@mailgate.bank-banque-canada.ca>

I have an object with an attribute "tframe" for which there is a generic method
print.tframe and also a method print.tframe.default defined in a library.
However, when I use attributes(object) I get the message

$tframe
Error: couldn't find function "print.tframe"

It's as if <primitive: attributes> is not looking through the search list?

Any suggestions? (Version 0.61.3)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sat May 16 19:04:33 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sat, 16 May 1998 11:04:33 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <98May15.133522edt.13671@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980516105556.1303A-100000@gorn>

On Fri, 15 May 1998, Paul Gilbert wrote:

> I have an object with an attribute "tframe" for which there is a generic method
> print.tframe and also a method print.tframe.default defined in a library.
> However, when I use attributes(object) I get the message
> 
> $tframe
> Error: couldn't find function "print.tframe"
> 
> It's as if <primitive: attributes> is not looking through the search list?

It's more subtle than this.  If you  do
R> b<-1
R> class(b)<-"foo"
R> print.foo<-function(x) { print("foo\n"); NextMethod()}

Then printing b works perfectly well

R> b
foo
[1] 1
attr(,"class")
[1] "foo"

and the problem arises when you print a list containing b

R> list(b,1)
[[1]]
foo
Error: couldn't find function "print.foo"

The error happens in the NextMethod() call of print.foo(), at line 284 of
objects.c, where do_nextmethod tries to find the function that called it.

	/* set up the arglist */
	s=findFun(CAR(cptr->call), cptr->sysparent);

In the working case, cptr->sysparent is R_GlobalEnv, in the non-working
case it's R_NilValue (ie, NULL)

BTW, the gcc documentation says that if we used gcc -g3 in compiling,
some debuggers would be able to cope with macros like CAR() and TYPEOF().
Does anyone know if gcc is one of them?


Thomas Lumley
------------------------------------------------------+--------
Biostatistics		: "Never attribute to malloc(3) what  :
Uni of Washington	:  can be adequately explained by     :
Box 357232		:  incompetence"                      :
Seattle WA 98195-7232	:				      :
--------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Lumley <thomas@biostat.washington.edu>  Sat May 16 20:39:40 1998
From: Thomas Lumley <thomas@biostat.washington.edu> (Thomas Lumley)
Date: Sat, 16 May 1998 12:39:40 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <Pine.SOL.3.95.980516105556.1303A-100000@gorn>
Message-ID: <Pine.SOL.3.95.980516114355.1303B-100000@gorn>


Ok. The print.tframe problem appears to be as follows:

When printList has a list element that is an object it creates a call to
print() with the evaluated object and evaluates that call in the
environment R_NilValue (ie NULL).

If this object has class "foo" print.foo() is called. If there is a 
NextMethod() in print.foo, do_nextmethod  reaches back to find
the environment that print() was called from and looks for the
definition of print.foo() that applies there, in order to get the formal
arguments right.  This fails, since print() was 'called' from the NULL
environment, where print.foo() is not defined.

You can reproduce this in interpreted code by
R> b<-1              
R> class(b)<-"foo" 
R> print.foo<-function(x){cat("foo\n");NextMethod()}
R> eval(expression(print(structure(1,class="foo"))),NULL)

The question is how to find the right environment to evaluate the call,
since printList doesn't know what environment print() was called from. 
R_GlobalEnv doesn't seem right, since print.foo may not be defined there. 

One solution would be to explicitly pass the environment down, but this
takes a lot of changes, some of them to functions called from outside
print.c.  I'm looking at this but would welcome a better solution.


Thomas Lumley
------------------------------------------------------+--------
Biostatistics		: "Never attribute to malloc(3) what  :
Uni of Washington	:  can be adequately explained by     :
Box 357232		:  incompetence"                      :
Seattle WA 98195-7232	:				      :
---------------------------------------------------------------




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun May 17 11:08:18 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 May 1998 12:08:18 +0200
Subject: couldn't find function "print.tframe"
In-Reply-To: Thomas Lumley's message of Sat, 16 May 1998 12:39:40 -0700 (PDT)
References: <Pine.SOL.3.95.980516114355.1303B-100000@gorn>
Message-ID: <x2wwblryzx.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> 
> 
> Ok. The print.tframe problem appears to be as follows:
> 
> When printList has a list element that is an object it creates a call to
> print() with the evaluated object and evaluates that call in the
> environment R_NilValue (ie NULL).
> 
> If this object has class "foo" print.foo() is called. If there is a 
> NextMethod() in print.foo, do_nextmethod  reaches back to find
> the environment that print() was called from and looks for the
> definition of print.foo() that applies there, in order to get the formal
> arguments right.  This fails, since print() was 'called' from the NULL
> environment, where print.foo() is not defined.
> 
> You can reproduce this in interpreted code by
> R> b<-1              
> R> class(b)<-"foo" 
> R> print.foo<-function(x){cat("foo\n");NextMethod()}
> R> eval(expression(print(structure(1,class="foo"))),NULL)

Hmmmm....

Here's another aspect of the problem:

I tried creating a new print function with a call to sys.status
inserted befor the UseMethod, after previously doing a debug(print),
and:

>  eval(expression(print(structure(1,class="foo"))),NULL)
debugging in: print(structure(1, class = "foo"))
foo
Error: couldn't find function "print.foo"

So it is still calling the old print (in package:base). The new one
would have debugging turned off for one thing. (BTW: Why doesn't the
debugger stop and wait for input before doing the UseMethod call?)

In contrast,
> b
$sys.calls
$sys.calls[[1]]
print(structure(1, class = "foo"))

<...etc...>
foo
[1] 1
attr(,"class")
[1] "foo"


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Sun May 17 21:26:25 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sun, 17 May 1998 13:26:25 -0700 (PDT)
Subject: couldn't find function "print.tframe"
In-Reply-To: <x2wwblryzx.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SOL.3.95.980517132310.4388A-100000@gorn>

On 17 May 1998, Peter Dalgaard BSA wrote:

> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > 
> > 
> > Ok. The print.tframe problem appears to be as follows:
> > 
> > When printList has a list element that is an object it creates a call to
> > print() with the evaluated object and evaluates that call in the
> > environment R_NilValue (ie NULL).
> > 
> > If this object has class "foo" print.foo() is called. If there is a 
> > NextMethod() in print.foo, do_nextmethod  reaches back to find
> > the environment that print() was called from and looks for the
> > definition of print.foo() that applies there, in order to get the formal
> > arguments right.  This fails, since print() was 'called' from the NULL
> > environment, where print.foo() is not defined.
> > 
> > You can reproduce this in interpreted code by
> > R> b<-1              
> > R> class(b)<-"foo" 
> > R> print.foo<-function(x){cat("foo\n");NextMethod()}
> > R> eval(expression(print(structure(1,class="foo"))),NULL)
> 
> Hmmmm....
> 
> Here's another aspect of the problem:
> 
> I tried creating a new print function with a call to sys.status
> inserted befor the UseMethod, after previously doing a debug(print),
> and:
> 
> >  eval(expression(print(structure(1,class="foo"))),NULL)
> debugging in: print(structure(1, class = "foo"))
> foo
> Error: couldn't find function "print.foo"
> 
> So it is still calling the old print (in package:base). The new one
> would have debugging turned off for one thing. (BTW: Why doesn't the
> debugger stop and wait for input before doing the UseMethod call?)

This is for the same reason.  In environment NULL you still have access to
the system environment but not to the global environment.  Look at
	eval(expression(print),NULL)
to see that it is indeed using the old version.  Fixing the environment
would fix this too.

I think the debugger doesn't stop and wait because it has problems with
functions that don't have braces {} enclosing them.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May 18 00:27:31 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 May 1998 01:27:31 +0200
Subject: couldn't find function "print.tframe"
In-Reply-To: Thomas Lumley's message of Sun, 17 May 1998 13:26:25 -0700 (PDT)
References: <Pine.SOL.3.95.980517132310.4388A-100000@gorn>
Message-ID: <x2af8geavw.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> I think the debugger doesn't stop and wait because it has problems with
> functions that don't have braces {} enclosing them.

Oh. And here I was, thinking that it was due to some aspect of the
implementation of method dispatching...

You're absolutely right:
> f<-function(x)x
> debug(f)
> f(3)
debugging in: f(3)
exiting from: f(3)
[1] 3

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rgentlem@stat.auckland.ac.nz  Mon May 18 01:11:17 1998
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Mon, 18 May 1998 12:11:17 +1200 (NZST)
Subject: No subject
Message-ID: <199805180011.MAA22223@stat1.stat.auckland.ac.nz>


> Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
> > I think the debugger doesn't stop and wait because it has problems with
> > functions that don't have braces {} enclosing them.
> 
> Oh. And here I was, thinking that it was due to some aspect of the
> implementation of method dispatching...
> 
> You're absolutely right:
> > f<-function(x)x
> > debug(f)
> > f(3)
> debugging in: f(3)
> exiting from: f(3)
> [1] 3
> 

  Yep, if you have a look we check the debug flag in do_begin (if an opening
  {), short functions don't have these. My recollection is that Splus puts
  one on every function but we decided not to. The debug flag is in
  the header of the actual function SEXP (look in src/include/Defn.h).
  
  Most of the behaviour of debug is in eval.c (do_while, do_for, and friends).
  
  
  robert
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon May 18 14:45:27 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 18 May 1998 15:45:27 +0200
Subject: R 0.62 ("snapshot") -- Now Search Engine in help.start()
Message-ID: <199805181345.PAA17553@sophie.ethz.ch>

You can look at it at
	http://www.stat.math.ethz.ch/R-alpha/

and clicking on  [R manual].
Besides  "Packages" and "Functions", there's know a
	"Search Engine & Keywords"
provided by Fritz Leisch (Wien).
["Keywords" are unfinished, but searching *is* useful.]

Thank you, Fritz!
-- Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon May 18 14:54:26 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 18 May 1998 15:54:26 +0200 (CEST)
Subject: R make process
Message-ID: <13664.15762.998396.781063@galadriel.ci.tuwien.ac.at>


Hi,

I've just committed a few changes to the R make process, such that we
support the standard

	./configure
	make
	make install

triple from now on. It should be included in tomorrows snapshot
sources. The default installation directory hierarchy should be
/usr/local on most systems, but this may vary.

The installation prefix can be set using

	./configure --prefix=3D...

and you can see the install dir in the status notes of configure.

R is installed into:

	$prefix/lib/R		RHOME
	$prefix/man/man1	R.1
	$prefix/bin		R Rd2txt Rdconv Rdindex Sd2Rd

Please let me know if there are any troubles on your system, currently
it is tested on Debian Linux only.

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Mon May 18 14:56:48 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Mon, 18 May 1998 15:56:48 +0200 (MDT)
Subject: get() in R and S
Message-ID: <199805181356.PAA13042@wrin27.urz.uni-wuppertal.de>

Hi there,

is there any complete list of differences between R and S? I only saw
one in the FAQ and it seems to be incomplete.

I specially want to know what the frame parameter in the S version of
get() means and and how I can replace it in R.

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From palme@uni-wuppertal.de  Mon May 18 15:36:15 1998
From: palme@uni-wuppertal.de (Hubert Palme)
Date: Mon, 18 May 1998 16:36:15 +0200 (MDT)
Subject: Another compatibility problem S => R
Message-ID: <199805181436.QAA13326@wrin27.urz.uni-wuppertal.de>

Hello,

after the line 

  cat("%",as.character(as.name(match.call())), "\n%\n", file=fi, append=T)

R complains about

  Error in as.name(x) : character argument required

Is it sufficient to delete as.name()?

After doing that, R complains

  Error: comparison is possible only for vector types

Don't know which function call. Can you give me a hint how to debug
it? There seems to be a lot of patameter type incompatibilities :-(

Thanks,

-- 
======================================================================
Hubert Palme         Bergische Universitaet-Gesamthochschule Wuppertal
                                      Computing  Center
                                      D-42097 Wuppertal
Email: palme@uni-wuppertal.de             (Germany)
http://www.hrz.uni-wuppertal.de/hrz/personen/h_palme.html
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon May 18 15:52:04 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 May 1998 16:52:04 +0200
Subject: Another compatibility problem S => R
In-Reply-To: palme@uni-wuppertal.de's message of Mon, 18 May 1998 16:36:15 +0200 (MDT)
References: <199805181436.QAA13326@wrin27.urz.uni-wuppertal.de>
Message-ID: <x2emxrbpij.fsf@blueberry.kubism.ku.dk>

palme@uni-wuppertal.de (Hubert Palme) writes:

> 
> Hello,
> 
> after the line 
> 
>   cat("%",as.character(as.name(match.call())), "\n%\n", file=fi, append=T)
> 
> R complains about
> 
>   Error in as.name(x) : character argument required

Hmm. The Splus help page says:

       as.name coerces x to an object of mode  "name".   This  is
       useful when x is of mode "character".

The whole construction seems to be doing the same as
deparse(match.call()), which works in *both* languages.

I don't think we want to become compatible in this case.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed May 20 09:08:28 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 20 May 1998 10:08:28 +0200
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: <9805200750.AA17895@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 20 May 1998 09:50:45 +0200 (MET DST))
Message-ID: <199805200808.KAA22220@sophie.ethz.ch>

Jim,
you should ask questions like these on R-devel.
There are more proficient Linux gurus on there than me [that's why I CC:].

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> Martin, Here is an additional problem with my libraries: the
    Jim> Kalman filtering, written in Fortran, uses complex arithmetic.

    Jim> On my Red Hat 5, the f2c library is included by the -lf2c in the
    Jim> Makefile.
makes sense.

    Jim> However, my son has just installed a new version of
    Jim> Slackware and we can find no way to convince gcc to include the
All I ever hear about Slackware is that you should not use it anymore...
[I used to have a 0.99x version of Linux.. and *did* have Slackware then..]

    Jim> f2c library. (With the previous version of Slackware that he had,
    Jim> it could be tricked by placing -L/usr/lib right before -lf2c,
    Jim> something I never understood.)

-L/usr/lib  says to that -lf2c should also search for libf2c.a or .so
 in /usr/lib.
However that is standard (in Linux), so I don't understand either.

The above problem sounds like your installation is broken to some extent...

    Jim> Of course, R crashes when we run my
    Jim> programs because it does not find the complex functions.

    Jim> I remember that there was some discussion of such problems on the
    Jim> list quite a while ago. Is any solution in sight?

The new 0.62 branch of R  *REQUIRES* either a fortran compiler or f2c.
So, your problems might have resolved by then.
However, given what you tell above,  I assume that your Slackware-Linux
system has some misconfigurations that should be resolved anyway...

Martin


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 15:10:48 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 10:10:48 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <199805200808.KAA22220@sophie.ethz.ch>
Message-ID: <98May20.101620edt.13443@mailgate.bank-banque-canada.ca>

Jim

I don't think your libf2c problems are related to your installation, Slackware,
or even to Linux. I have the same trouble in RedHat and in Solaris. I think the
problem is whether it is the responsibility of a dynamically loaded .so to
knowing where libraries are, or if R.binary should know that. In my rather crude
and uninformed experimentation I could not discover a way to make my .so know
and pass along that information, so I have concluded that it must be R.binary's
responsibility.

I posted a question on this some time ago, to which Ross acknowledged there is a
problem and suggested I contact Kurt. In the end I didn't do that because I
discovered that some rather trivial changes to my fortran resulted in calls to
pow_di rather than pow_ii and this fixed my problem.

I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
that, since, as far as I know, you and I are the only ones who have been having
this difficulty. I suspect it will become more of an issue as more fortran is
ported.

Below is a copy of the exchange from my previous posting.

Paul Gilbert
________
> Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:
>
> > I have a problem with my dynamically loaded code in R not finding
> > pow_ii, which for some time I thought was because library f2c is
> > not on my Sparcstation.  > > However, I have now been experiencing
> > the same problem in Linux, with all the  proper libraries in place.
> >
> > My incomplete understanding of elf and shared libraries does not
> > help, but when compiling a complete program I usually muddle through.
> > However, in the case of dynamically loading code into R, I am not
> > sure whether it is my dse.so or R which should have the knowledge
> > of where to find /usr/lib/libf2c.so*. I haven't  had much success
> > trying to configure so that that information is in dse.so. None
> > of the usual things seem to help, so I suspect R itself needs to
> > be able to find the library. If someone can explain this I would
> > very much appreciate it.

DB> One thing you can do is to check the R.binary file with "nm -g" to find
DB> out what symbols are defined in it.  On my machine R.binary includes
DB> pow_dd and pow_di but not pow_ii.

This is a general problem we need a solution to.  Recently, Kurt Hornik
has changed the configuration procedures so that fortran is located and
used to load R.  I thought this would fix this kind of problem.
(Any references to fortran things like pow_ii should be removed from the
C sources).

I'd suggest that you get in touch with Kurt directly:
        Kurt.Hornik@ci.tuwien.ac.at
to sort this out.

        Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed May 20 17:59:06 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 20 May 1998 09:59:06 -0700 (PDT)
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: <98May20.101620edt.13443@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980520095251.22293B-100000@gorn>

On Wed, 20 May 1998, Paul Gilbert wrote:


> I don't think your libf2c problems are related to your installation, Slackware,
> or even to Linux. I have the same trouble in RedHat and in Solaris. I think the
> problem is whether it is the responsibility of a dynamically loaded .so to
> knowing where libraries are, or if R.binary should know that. In my rather crude
> and uninformed experimentation I could not discover a way to make my .so know
> and pass along that information, so I have concluded that it must be R.binary's
> responsibility.
> 
<snip>
> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
> that, since, as far as I know, you and I are the only ones who have been having
> this difficulty. I suspect it will become more of an issue as more fortran is
> ported.
> 

If this is the problem it should be fixed in 0.62, since R.binary will
have to know how to find the local fortran compiler and libraries to run
itself. You can then distribute the fortran code and it will be compiled
and linked the same way as the built-in fortran. 

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May 20 19:00:56 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 20 May 1998 20:00:56 +0200
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: Martin Maechler's message of Wed, 20 May 1998 10:08:28 +0200
References: <199805200808.KAA22220@sophie.ethz.ch>
Message-ID: <x2iun0es9z.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>     Jim> On my Red Hat 5, the f2c library is included by the -lf2c in the
>     Jim> Makefile.
> makes sense.
> 
>     Jim> However, my son has just installed a new version of
>     Jim> Slackware and we can find no way to convince gcc to include the
> All I ever hear about Slackware is that you should not use it anymore...
> [I used to have a 0.99x version of Linux.. and *did* have Slackware then..]
> 
>     Jim> f2c library. (With the previous version of Slackware that he had,
>     Jim> it could be tricked by placing -L/usr/lib right before -lf2c,
>     Jim> something I never understood.)
> 
> -L/usr/lib  says to that -lf2c should also search for libf2c.a or .so
>  in /usr/lib.
> However that is standard (in Linux), so I don't understand either.

I've seen some similar cases in the distant past, apparently related
to argument order of the link command arguments. If all else fails,
one can always specify /usr/lib/libf2c.so directly. Provided that the
file is actually there, of course...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 19:17:15 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 14:17:15 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <Pine.SOL.3.95.980520095251.22293B-100000@gorn>
Message-ID: <98May20.142257edt.13457@mailgate.bank-banque-canada.ca>

<snip>
>> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of

>> that, since, as far as I know, you and I are the only ones who have been
having
>> this difficulty. I suspect it will become more of an issue as more fortran is

>> ported.

>If this is the problem it should be fixed in 0.62, since R.binary will
>have to know how to find the local fortran compiler and libraries to run
>itself. You can then distribute the fortran code and it will be compiled
>and linked the same way as the built-in fortran.

This assumes that everyone who wants to run the code has a fortran compiler, not
just f2c. This is not really a very good assumption, especially since the
current version of g77 seems to have a bug and won't compile my code. In
general, fortran compilers are much less widely available than C compilers. I
think that distributing the code as generated by f2c will help a lot of people,
but this sometimes means using libf2c. (I've even found that using gcc on the
f2c code works better in Splus than trying to use a fortran compiler.)

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed May 20 19:24:17 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 20 May 1998 14:24:17 -0400
Subject: libraries; Fortran / -lf2c / Slackware woes
References: <199805200808.KAA22220@sophie.ethz.ch> <x2iun0es9z.fsf@blueberry.kubism.ku.dk>
Message-ID: <98May20.143013edt.13459@mailgate.bank-banque-canada.ca>

>If all else fails,
>one can always specify /usr/lib/libf2c.so directly. Provided that the
>file is actually there, of course...

In fact, one cannot. At least I couldn't get it to work, and I tried many
variations on this. The problem seems to be that this provides the information
for the purposes of generating the .so file, but it gets lost somewhere when you
try to dyn.load the .so into R.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Wed May 20 19:41:46 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 20 May 1998 13:41:46 -0500
Subject: libraries; Fortran / -lf2c / Slackware woes
In-Reply-To: Paul Gilbert's message of Wed, 20 May 1998 14:17:15 -0400
References: <Pine.SOL.3.95.980520095251.22293B-100000@gorn> <98May20.142257edt.13457@mailgate.bank-banque-canada.ca>
Message-ID: <6rbtsszswl.fsf@verdi.stat.wisc.edu>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> <snip>
> >> I hope that the problem has been fixed in 0.62, but I wouldn't be too sure of
> 
> >> that, since, as far as I know, you and I are the only ones who have been
> having
> >> this difficulty. I suspect it will become more of an issue as more fortran is
> 
> >> ported.
> 
> >If this is the problem it should be fixed in 0.62, since R.binary will
> >have to know how to find the local fortran compiler and libraries to run
> >itself. You can then distribute the fortran code and it will be compiled
> >and linked the same way as the built-in fortran.
> 
> This assumes that everyone who wants to run the code has a fortran compiler, not
> just f2c. This is not really a very good assumption, especially since the
> current version of g77 seems to have a bug and won't compile my code. In
> general, fortran compilers are much less widely available than C compilers. I
> think that distributing the code as generated by f2c will help a lot of people,
> but this sometimes means using libf2c. (I've even found that using gcc on the
> f2c code works better in Splus than trying to use a fortran compiler.)

But "fortran compiler" can mean something like a script that calls f2c
then calls gcc on the result.  We have one called "fort77" in the
Debian Linux distribution.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu May 21 16:06:55 1998
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 21 May 1998 11:06:55 -0400
Subject: all.equal - cut three
Message-ID: <98May21.111256edt.13457@mailgate.bank-banque-canada.ca>

Below is a third cut at all.equal and the generic function test.equal which
is intended to return a T/F value. There was a suggestion that "is.equal" rather
than "test.equal" might be considered as a name. I have mixed feelings about
this. I associate the  "is" functions with inheritance rather than comparisons,
but the "equal" part of the name makes it clear. How do others feel about this?

The default method for all.equal now tries to recursively extract all numeric
elements and compare using tolerance. It also tries to do a relative comparison
rather than an absolute comparison, except for very small numbers. I hope
someone with more experience than I have will examine this part carefully!

Paul Gilbert
_______

test.equal <-function (obj1, obj2, ...)  UseMethod("test.equal")

 test.equal.default <-function (obj1, obj2, ...)
{ if (is.array(obj1))    test.equal.array(obj1, obj2, ...)
   else                         is.logical(all.equal(obj1, obj2, ...))
}


all.equal <- function(obj1, obj2,...) {UseMethod("all.equal")}

all.equal.default <- function(obj1, obj2, tolerance=.Machine$double.eps)
  {if(mode(obj1)      != mode(obj2) )               return("modes differ.")
   if (length(obj1) != length(obj2) )               return("lengths differ")

   if(is.null(class(obj1)) != is.null(class(obj2))) return("classes differ.")
   else if(!is.null(class(obj1))
           && any(class(obj1) != class(obj2)) )     return("classes differ.")


   if(is.null(attributes(obj1)) != is.null(attributes(obj2)))
                                                    return("attributes differ.")

   else if(!is.null(attributes(obj1))
           && any(unlist(attributes(obj1)) != unlist(attributes(obj2))))
                                                    return("attributes differ.")

   cull.numeric  <- function(obj, r=NULL) {
      if (is.null(obj) | (length(obj) == 0)) return(r)
      else if (is.numeric(obj)) return(c(r,obj))
      else if (is.list(obj))
           return( c(cull.numeric(obj[[1]], r), cull.numeric(obj[-1])) )
      else return(r)
     }

   z1 <- cull.numeric(obj1)
   if(! is.null(z1))
      {z2 <- cull.numeric(obj2)
       if (length(z1) != length(z2) )  return("length of numeric parts differ")
       M <- pmax(abs(z1), abs(z2))
       # next line results in absolute rather than relative comparison for
       # very small numbers.
       M[ M < 100 *tolerance] <- 1
       if (any(abs(z1 -z2) > tolerance * M))
                       return("numeric value differences exceed tolerance.")
      }
  # next comparison is really for non-numeric values but also compares
  # numeric values to the tolerance of the character representation in unlist.
   if (! all(unlist(obj1) == unlist(obj2)))     return("values differ.")
   T
  }





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri May 22 21:48:52 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 22 May 1998 13:48:52 -0700 (PDT)
Subject: matrix multiplication of vectors
In-Reply-To: <98May21.111256edt.13457@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SOL.3.95.980522134730.9121B-100000@gorn>


An incompatibility:
S-PLUS
> x<-1:3
>  x%*%x
     [,1] 
[1,]   14
>  x%*%t(x)
     [,1] [,2] [,3] 
[1,]    1    2    3
[2,]    2    4    6
[3,]    3    6    9

R
> x<-1:3
> x%*%x
     [,1]
[1,]   14
> x%*%t(x)
Error in x %*% t(x) : non-conformable arguments


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Mon May 25 23:25:24 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 26 May 1998 10:25:24 +1200 (NZST)
Subject: RFC: spline / splinefun (etc) amalgamation
Message-ID: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>

At present R has separate functions "spline" and "splinefun".  The first
of these carries out spline interpolation of a data set and returns the
interpolated values; the second returns the interpolating function itself
(approx and approxfun are similar).

I would like to combine these into a single function "spline" with
an (optional) argument which determines which kind of value is returned.
E.g.

	spline(x,y)        # return interpolated function
	spline(x,y,fun=T)  # return the interpolating function

I would also like to propose this as a standard for smoothing and
interpolating functions.  This has a couple of advantages - fewer
names to remember and, the ability to use the function form in
model fitting code ("predict" for example).

Any objections or comments?

	Ross

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue May 26 00:09:45 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 25 May 1998 16:09:45 -0700 (PDT)
Subject: dependencies in .so files
In-Reply-To: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.LNX.3.96.980525160616.26582A-100000@buffy>


I've been trying to get Matt Calder's S compiler to work in R using R
COMPILE and R SHLIB so it will be fairly platform-independent.  

I'm sure someone has claimed in the past that it is possible/easy to
dyn.load() two dynamic libraries and have one call functions in the other.
I can't get it to work (Red Hat 5.0/R0.61.1ish). It doesn't seem to matter
what order I load them in, they can't find each other.

Any ideas?

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue May 26 06:55:49 1998
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 26 May 1998 07:55:49 +0200 (CEST)
Subject: RFC: spline / splinefun (etc) amalgamation
In-Reply-To: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
References: <199805252225.KAA19854@stat1.stat.auckland.ac.nz>
Message-ID: <13674.22885.136914.353526@pc87.maho.magnaeu.com>

>>>>> Ross Ihaka writes:

> At present R has separate functions "spline" and "splinefun".  The first
> of these carries out spline interpolation of a data set and returns the
> interpolated values; the second returns the interpolating function itself
> (approx and approxfun are similar).

> I would like to combine these into a single function "spline" with
> an (optional) argument which determines which kind of value is returned.
> E.g.

> 	spline(x,y)        # return interpolated function
> 	spline(x,y,fun=T)  # return the interpolating function

> I would also like to propose this as a standard for smoothing and
> interpolating functions.  This has a couple of advantages - fewer
> names to remember and, the ability to use the function form in
> model fitting code ("predict" for example).

> Any objections or comments?

Perhaps
	smoothing.or.interpolating.fun(data)
should in general return the FUNCTION (more precisely, a function
object of an appropriate class), and the values would be obtained
via predict()?

-k

(May not be BBC, though ...)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue May 26 07:58:52 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 26 May 1998 08:58:52 +0200
Subject: RFC: spline / splinefun (etc) amalgamation
In-Reply-To: <13674.22885.136914.353526@pc87.maho.magnaeu.com> (message from
 Kurt Hornik on Tue, 26 May 1998 07:55:49 +0200 (CEST))
Message-ID: <199805260658.IAA02570@sophie.ethz.ch>

>>>>> "KH" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Ross Ihaka writes:
    >> At present R has separate functions "spline" and "splinefun".  The
    >> first of these carries out spline interpolation of a data set and
    >> returns the interpolated values; the second returns the
    >> interpolating function itself (approx and approxfun are similar).

    >> I would like to combine these into a single function "spline" with
    >> an (optional) argument which determines which kind of value is
    >> returned.  E.g.

    >> spline(x,y) # return interpolated function spline(x,y,fun=T) #
    >> return the interpolating function

    >> I would also like to propose this as a standard for smoothing and
    >> interpolating functions.  This has a couple of advantages - fewer
    >> names to remember and, the ability to use the function form in model
    >> fitting code ("predict" for example).

    >> Any objections or comments?

Very good idea [including the "standard"!]

    KH> Perhaps smoothing.or.interpolating.fun(data) should in general
    KH> return the FUNCTION (more precisely, a function object of an
    KH> appropriate class), and the values would be obtained via predict()?

I do prefer Ross' version:

1. For a novice or average user, it is more intuitive to get a list /
   data.frame as a result by default.

2. compatibility
    KH> (May not be BBC, though ...)
   yes

3. The ($x, $y) list is simpler AND smaller (in memory).

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 13:29:05 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 13:29:05 +0100 (GMT+0100)
Subject: A problem of etiquette
Message-ID: <19980527122905.99.qmail@sirio.stat.unipd.it>

Perhaps, the question is silly. But, I prefer asking it before making a 
mistake.

I have just packed a binary distribution of R for Windows3.1/Win32s.
It is equivalent to the previous one for Win95/NT (R-0.61.3 +
many of the available packages) and it is compiled with egcs-mingw32
(GPL not a commercial compiler).

Now, in preparing the README, I put the following sentence:
-----------------------------------------------------------------------------
This distribution is not formally maintained, but I am interested 
in hearing (on r-devel and r-help) from people who have problems with it, 
although I may not be able to solve them.
-----------------------------------------------------------------------------

The etiquette question is: can I ask people to use r-devel/r-help
although I am not managing these lists?

guido m.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed May 27 13:10:56 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 May 1998 14:10:56 +0200
Subject: A problem of etiquette
In-Reply-To: guido@sirio.stat.unipd.it's message of Wed, 27 May 1998 13:29:05 +0100 (GMT+0100)
References: <19980527122905.99.qmail@sirio.stat.unipd.it>
Message-ID: <x2pvgzzzfz.fsf@blueberry.kubism.ku.dk>

guido@sirio.stat.unipd.it writes:

> The etiquette question is: can I ask people to use r-devel/r-help
> although I am not managing these lists?
> 
> guido m.

Yes, of course. These fora are for anyone interested in helping with
development of R, respectively asking and answering questions about
its use. This means not just the core R but also add-on packages and -
as in your case - ports to other systems. If the lists overflow, we
can always set up a special list for R-Win, but I don't think that
will be necessary.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed May 27 13:12:14 1998
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 27 May 1998 14:12:14 +0200 (CEST)
Subject: A problem of etiquette
In-Reply-To: <19980527122905.99.qmail@sirio.stat.unipd.it>
References: <19980527122905.99.qmail@sirio.stat.unipd.it>
Message-ID: <13676.798.218392.320599@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 27 May 1998 13:29:05 +0100 (GMT+0100),
>>>>> guido  (g) wrote:

g> Perhaps, the question is silly. But, I prefer asking it before making =
a=20
g> mistake.

g> I have just packed a binary distribution of R for Windows3.1/Win32s.
g> It is equivalent to the previous one for Win95/NT (R-0.61.3 +
g> many of the available packages) and it is compiled with egcs-mingw32
g> (GPL not a commercial compiler).

g> Now, in preparing the README, I put the following sentence:
g> ----------------------------------------------------------------------=
-------
g> This distribution is not formally maintained, but I am interested=20
g> in hearing (on r-devel and r-help) from people who have problems with =
it,=20
g> although I may not be able to solve them.
g> ----------------------------------------------------------------------=
-------

g> The etiquette question is: can I ask people to use r-devel/r-help
g> although I am not managing these lists?

I think you're being too modest ... you put a lot of effort in
preparing the binary distribution of R!

The lists are about discussing all aspects of R, including ports, etc.

Its perfectly fine to put the above statement into the README.

Best,

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4546
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@luc.ac.be  Wed May 27 15:40:32 1998
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Wed, 27 May 1998 16:40:32 +0200 (MET DST)
Subject: Problems compiling libraries with todays snapshot.
Message-ID: <9805271440.AA01439@alpha.luc.ac.be>

I am currently running Slakware V3.4 with g77 and R is a 0.62 snapshot of the 27th of May.
There appear to be linking problems with the libraries.
The error output from mva and eda can be found below.
My own libraries also have similar problems.

Errors when compiling mva:

116 /usr/local/src/R/src/library #R INSTALL mva
Warning:  package `-html' does not exist
Warning:  package `-latex' does not exist
Installing package `mva' ...
libs
ld  -o mva.so dblcen.o dist.o hclust.o
ld: warning: cannot find entry symbol _start; defaulting to 08048080
dist.o: In function `euclidean':
/usr/local/src/R/src/library/mva/src/dist.c:43: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:43: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:51: undefined reference to `realNA'
/usr/local/src/R/src/library/mva/src/dist.c:53: undefined reference to `sqrt'
dist.o: In function `maximum':
/usr/local/src/R/src/library/mva/src/dist.c:64: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:64: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:74: undefined reference to `realNA'
dist.o: In function `manhattan':
/usr/local/src/R/src/library/mva/src/dist.c:85: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:85: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:92: undefined reference to `realNA'
dist.o: In function `canberra':
/usr/local/src/R/src/library/mva/src/dist.c:105: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:105: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:112: undefined reference to `realNA'
dist.o: In function `binary':
/usr/local/src/R/src/library/mva/src/dist.c:127: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:127: undefined reference to `isFinite'
/usr/local/src/R/src/library/mva/src/dist.c:140: undefined reference to `realNA'
dist.o: In function `dist':
/usr/local/src/R/src/library/mva/src/dist.c:169: undefined reference to `error'
make: *** [mva.so] Error 1
cp: *.so: No such file or directory

Compiling eda:

117 /usr/local/src/R/src/library #R INSTALL eda
Installing package `eda' ...
libs
ld  -o eda.so line.o smooth.o
ld: warning: cannot find entry symbol _start; defaulting to 08048080
line.o: In function `il':
/usr/local/src/R/src/library/eda/src/line.c:5: undefined reference to `floor'
line.o: In function `iu':
/usr/local/src/R/src/library/eda/src/line.c:10: undefined reference to `ceil'
line.o: In function `line':
/usr/local/src/R/src/library/eda/src/line.c:23: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:48: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:54: undefined reference to `rsort'
/usr/local/src/R/src/library/eda/src/line.c:61: undefined reference to `rsort'
make: *** [eda.so] Error 1
cp: *.so: No such file or directory
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From wsimpson@uwinnipeg.ca  Wed May 27 16:10:48 1998
From: wsimpson@uwinnipeg.ca (Bill Simpson)
Date: Wed, 27 May 1998 10:10:48 -0500 (CDT)
Subject: Problems compiling libraries with todays snapshot.
In-Reply-To: <9805271440.AA01439@alpha.luc.ac.be>
Message-ID: <Pine.OSF.3.95.980527100912.8559A-100000@io.uwinnipeg.ca>

I am running 62.0 April 12 1998 under Slackware 3.4.0, and it compiled
painlessly (if that is any help at all). BTW with Slackware you've got to
make sure you've got readline library installed.  It isn't there in the
default distribution.

Bill

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 19:50:17 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 19:50:17 +0100 (GMT+0100)
Subject: dependencies in .so files
Message-ID: <19980527185017.2030.qmail@sirio.stat.unipd.it>

 Thomas Lumley writes:
 > 
 > 
 > I've been trying to get Matt Calder's S compiler to work in R using R
 > COMPILE and R SHLIB so it will be fairly platform-independent.  
 > 
 > I'm sure someone has claimed in the past that it is possible/easy to
 > dyn.load() two dynamic libraries and have one call functions in the other.
 > I can't get it to work (Red Hat 5.0/R0.61.1ish). It doesn't seem to matter
 > what order I load them in, they can't find each other.
 > 
 > Any ideas?
 
 >From the dlopen man page:
 void *dlopen (const char *filename, int flag);
 ................................................
 RTLD_GLOBAL may be or'ed with flag
 in which case the external symbols defined in the library will be
 made available to subsequently loaded libraries.
 
 So, I try: 
 1) I modify src/unix/dynload.c changing the flag of dlopen
    from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
 2) build two simple shared libraries the second calling a routine 
    in the first.
 ---------------------------a.c-------------------------------
 #include <stdio.h>
 
 void a(int *i) {
    printf("now in a.so; incrementing i\n");
    *i=*i+1;
 }
 
 --------------------------b.c--------------------------------
 #include <stdio.h>
 
 extern void a(int *i);
 
 void b(int *i) {
    printf("in b.so; calling function a in a.so; i=%d\n",*i);
    a(i);
    printf("in b.so; now i=%d\n",*i);
 }
 
 -------------------------Makefile------------------------------
 all: a.so b.so
 
 a.o: a.c
 	gcc -fPIC -c a.c
 	
 a.so: a.o
 	gcc -shared -o a.so a.o
 	
 b.o: b.c
 	gcc -fPIC -c b.c
 	
 b.so: b.o
 	gcc -shared -o b.so b.o	
 	
 -------------------------------------------------------------------------
 
 Things seems ok.
 
 -------------------------------------------------------------------------
 sirio[~/tmp/prova]% R
 
 R : Copyright 1998, Robert Gentleman and Ross Ihaka
 Version 0.61.3  (May 3, 1998)
 
 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type    "license()" for details.
 
 Type    "demo()" for some demos, "help()" for on-line help, or
         "help.start()" for a HTML browser interface to help.
 
 
 > dyn.load("a.so")
 > dyn.load("b.so")
 > y <- .C("b",as.integer(0))
 in b.so; calling function a in a.so; i=0
 now in a.so; incrementing i
 in b.so; now i=1
 > y
 [[1]]
 [1] 1           
 ----------------------------------------------------------------------------
 
 Before introducing the RTLD_GLOBAL flag:
 ----------------------------------------------------------------------------
 sirio[~/tmp/prova]% R
 
 R : Copyright 1998, Robert Gentleman and Ross Ihaka
 Version 0.61.3  (May 3, 1998)
 
 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type    "license()" for details.
 
 Type    "demo()" for some demos, "help()" for on-line help, or
         "help.start()" for a HTML browser interface to help.
 
 > dyn.load("a.so")
 > dyn.load("b.so")
 > y <- .C("b",as.integer(0))
 in b.so; calling function a in a.so; i=0
 /usr/local/src/R-0.61.3/bin/R.binary: can't resolve symbol 'a'
 sirio[~/tmp/prova]%                                             
 
 ----------------------------------------------------------------------------
 I am using R-0.61.3 under Linux 2.30.
 
 guido masarotto
 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Wed May 27 22:10:18 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Wed, 27 May 1998 22:10:18 +0100 (GMT+0100)
Subject: dependencies in .so files
Message-ID: <19980527211018.2199.qmail@sirio.stat.unipd.it>

 > Luke Tierney writes:
 > 
 > guido@sirio.stat.unipd.it wrote:
 > >  So, I try: 
 > >  1) I modify src/unix/dynload.c changing the flag of dlopen
 > >     from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
 > 
 > I'm not sure this is properly and reliably supported on all UNIX
 > platforms. It doesn't seem to be in the standard Windows and Mac
 > compilers.  That is, MS VC++ and Borland C++ don't seem to let you
 > creade DLL's with undefined symbols. Watcom does seem to allow it, but
 > I'm not certain how reliable it is there.
 If I understand, under Windows , you have to follow your strategy B (recursive 
 shared libraries). 
 
 > 
 > Also you need to consider what happens at runtime if a function is
 > called and finds an unresolved symbol. On some systems a signal might
 > be sent that can be caught (HP-UX sends SIGABRT, but I'm not sure I
 > would want to catch all those), but this will need to be checked out
 > on every different system. Having any problems reported at load time
 > seems like a safer solution -- I have gone the other way and switched
 > to using RTLD_NOW for this reason (and because that seems the least
 > common denominator accross UNIX/Win32/Mac).
 I agree. This point is however indipendent from  linking a
 shared library which needs another shared library. This has
 to do with the RTLD_LAZY flag not with the RTLD_GLOBAL one. 
 In the example I used the RTLD_LAZY flag only because the current version of
 R uses it.
 The use of RTLD_NOW will also make debugging easier.
 An example was the missing routines
 problem in the locfit package (a couple of messages a month ago).
 I found out that the shared library misses a couple of routines
 compiling the package under Windows. But, under Unix, no 
 errors in building the library.
 But, if you try to use the R function which calls
 a C function with an unresolved routine you get a segmentation fault
 (or at least, I got it).
 
 > The alternative is to use the OS's ld or equivalent to create a
 > library that knows what it needs to call at link time by telling ld
 > what other shared libraries it needs; in this case
 > 
 > >  	
 > >  a.so: a.o
 > >  	gcc -shared -o a.so a.o
 > >  	
 > >  b.o: b.c
 > >  	gcc -fPIC -c b.c
 > >  	
 > >  b.so: b.o
 > >  	gcc -shared -o b.so b.o	
 > >  	
 > 
 > would change to
 > 
 > ...
 > b.so: b.o
 > 	gcc -shared -o b.so b.o	a.so
 > 
 > Mutually recursive libraries can be handled this way on most UNIX
 > systems I think; for Win32 there are some standard tricks involving
 > .def and .lib files (that I can't remember in detail but I think I
 > found them once on MS's web site) for making DLL's that are mutually
 > recursive. I haven't looked into mutual recursion on the Mac.
 > 
 Under Linux, the problem with this approach is that the dynamic
 linker (ld.so) must find a.so at runtime. I have just tried
 on the previous example but I can't load the so builded b.so in R.
 guido m.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Wed May 27 21:41:31 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 27 May 1998 15:41:31 -0500 (CDT)
Subject: dependencies in .so files
In-Reply-To: <19980527211018.2199.qmail@sirio.stat.unipd.it> from "guido@sirio.stat.unipd.it" at May 27, 98 10:10:18 pm
Message-ID: <9805272041.AA06858@nokomis.stat.umn.edu>

guido@sirio.stat.unipd.it wrote:
> 
>  > Also you need to consider what happens at runtime if a function is
>  > called and finds an unresolved symbol. On some systems a signal might
>  > be sent that can be caught (HP-UX sends SIGABRT, but I'm not sure I
>  > would want to catch all those), but this will need to be checked out
>  > on every different system. Having any problems reported at load time
>  > seems like a safer solution -- I have gone the other way and switched
>  > to using RTLD_NOW for this reason (and because that seems the least
>  > common denominator accross UNIX/Win32/Mac).
>  I agree. This point is however indipendent from  linking a
>  shared library which needs another shared library. This has
>  to do with the RTLD_LAZY flag not with the RTLD_GLOBAL one. 

Your're right -- I got those confused. GLOBAL makes the symbols in the
new library accessible to later loads, LAZY/NOW determine whether the
check for all needed symbols occurs at call or load time. I'm still
not sure though if RTLD_GLOBAL semantics are realiably implemented on
all UNIX systems. I think it's not an issue in Win32 since (except
with Watcom?) all references need to be resolved at link time.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Thu May 28 08:41:06 1998
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 28 May 1998 07:41:06 -0000 ()
Subject: dependencies in .so files
In-Reply-To: <19980527185017.2030.qmail@sirio.stat.unipd.it>
Message-ID: <XFMail.980528075225.plummer@iarc.fr>

This modified version of b.c in Guido's example works for me (R-0.61.3,
RedHat Linux 5.0) without modifying the R source.  R keeps an internal
table of symbols which is accessible via the R_FindSymbol function
(defined in src/unix/dynload.c), so you can use this to return a
pointer to a function in a previously loaded library.

Pardon my C if I've done something stupid here.
Martyn.

--------------------------b.c--------------------------------
#include <stdio.h>

typedef int (*DL_FUNC) ();

DL_FUNC R_FindSymbol(char *);

void b(int *i) {
    char afun[] = "a";
    DL_FUNC fun;

    printf("in b.so; calling function a in a.so; i=%d\n",*i);
    fun = R_FindSymbol(afun);
    fun(i);
    printf("in b.so; now i=%d\n",*i);
}
---------------------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu May 28 09:50:58 1998
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 28 May 1998 10:50:58 +0200
Subject: R manual (html version)
In-Reply-To: <D66FD155A8@main.ubishops.ca> (rvhulst@ubishops.ca)
Message-ID: <199805280850.KAA07204@sophie.ethz.ch>

>>>>> "Robert" == Robert van Hulst <rvhulst@ubishops.ca> writes:

    Robert> Martin, your R manual was VERY useful, but I cannot access it
    Robert> any more.

You mean
	http://www.stat.math.ethz.ch/R-alpha/doc/html/ ?

There was a file permission problem which is now fixed.   Sorry!

Thanks a lot for telling me!

    Robert> Could I download the whole manual? How?  Many thanks
    Robert> for your help!  --robert

The point about that manual is, that it is a *daily* updated version of the
online help about the *development* version of R, i.e, currently 0.62.

It is  *PART* of the new development version which you can get from 
	<CRAN>/src/devel/R-snapshot.tar.gz

After unpacking, you should be able to just say
	make docs
and then finally have the HTML manual netscape-accessable in

	file:<installdir>/doc/html/index.html

There is now even a java-based search engine (not yet complete) available
besides Packages and Functions:

-------------------------------------------------------------------------------
				 Reference

     Packages                    Functions          Search Engine & Keywords
-------------------------------------------------------------------------------

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu May 28 11:34:56 1998
From: guido@sirio.stat.unipd.it (guido@sirio.stat.unipd.it)
Date: Thu, 28 May 1998 11:34:56 +0100 (GMT+0100)
Subject: dependencies in .so files
In-Reply-To: <199805280827.KAA07151@sophie.ethz.ch> from "Martin Maechler" at May 28, 98 10:27:50 am
Message-ID: <19980528103456.3200.qmail@sirio.stat.unipd.it>

Martin Maechler writes:
> 
> >>>>> "Guido" == Guido Masarotto <guido@sirio.stat.unipd.it> writes:
> 
>     >> From the dlopen man page:
>     Guido> void *dlopen (const char *filename, int flag);
>     Guido> ................................................
>     Guido> RTLD_GLOBAL may be or'ed with flag
>     Guido> in which case the external symbols defined in the library will be
>     Guido> made available to subsequently loaded libraries.
>  
>     Guido> So, I try: 
>     Guido> 1) I modify src/unix/dynload.c changing the flag of dlopen
>     Guido> from RTLD_LAZY to (RTLD_LAZY | RTLD_GLOBAL)
> 
> R-core: 
> 	Shall we do this, for 0.62?  -- or even try to have "configure" find out
> 	if  RTLD_GLOBAL  is supported on the given system?
If I can give suggestions:
1) Independently from the RTLD_GLOBAL flag, I will change RTLD_LAZY to
   RTLD_NOW. As Luke T. summarized yesterday in this way a shared library
   which cannot resolve all its symbols (in R.binary or in other libraries)
   cannot be load. This give three   advantages:
   a) At least under Linux, if I call a dynamic linked routine which
      cannot resolve its dependencies, I get a segmentation fault and
      R exit. Of course, we can try to intercept this problem but
      as also Luke noted, it is difficult to be sure that all the systems 
      will trigs an  appropriate signal; in addition
   b) debugging of a shared library becomes simple; at least, we are
      sure that all the functions in the library can be called.
   c) This correspond to the standard for not Unix machine; I am
      sure for Windows but, if I remember, Luke said also for the Mac.
   Perhaps, if a library cannot be loaded, the corresponding dlerror()
   string should be used for giving to the user some information
   on why.
2) Coming to RTDL_GLOBAL; here the question is the one raised by
   Luke: portability. I suppose that the solution suggested by
   Luke (use "recursive" shared libraries)  is more portable than mine. 
   After a first failure, I was   able to run my "silly" example setting 
   the LD_LIBRARY_PATH shell variable,i.e., instructing ld.so about where 
   to search.
   

> Guido:  Have you ever looked at 0.62  (and porting it to Win32) ?
> 	(get it from <CRAN>/src/devel/R-snapshot.tar.gz)
I had no time. I downloaded a snapshot next week but I didn't make
any trial. Is the unix/system.c changed a lot? I have just looked
to it now and it seems quite similar to the 0.61.x one.

To all the R people: have a nice day.
guido m.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Andreas.Weingessel@ci.tuwien.ac.at  Thu May 28 14:25:59 1998
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 28 May 1998 15:25:59 +0200 (CEST)
Subject: performance of apply
Message-ID: <13677.26087.506888.469624@elendil.ci.tuwien.ac.at>


I noticed that apply is VERY SLOW when applied to a "large"
dimension as for example when computing the row sums of a matrix with
thousands of rows.

To demonstrate it, I did some benchmarking for different methods of
computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.

The first method (M1) I used is the normal apply command:
	y <- apply(x,1,sum)
The second method (M2) uses a for-loop for the computations, where the
memory for the resulting vector has been allocated before. That is, for
n=3D2000:
	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
The third method (M3) also uses a for-loop, but the resulting vector
is built recursively, i.e.
	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))

All computations have been made on a Pentium II 233MHz, 256MB, R
started as R -v 50. The following table shows the minimum, mean, and
maximum CPU-time in seconds as measured by system.time over 10 runs
for every computation for different values of n.

n	M1			M2		M3
2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81

That is, the computation of the sums of the rows of a 10000x10 matrix
with apply takes about 100sec on average, where a simple for-loop does
the same job in about 2sec.

The next table shows for every method the relative increase of time as
compared to the increase of the number of rows.

n	M1	M2	M3
1	 1	1	 1
2	 3.221	2.025	 2.952
3	 6.764	3.050	 6.032
4	15.247	4.075	10.175
5	23.599	5.025	15.540

You can see that the time for M2 (for-loop with memory allocated at
the beginning) increases linearly with n, which is to be expected,
whereas apply (M1) is scaling quadratically with the number of rows. M3
(for-loop, but new memory-allocation every time) is somewhere in between.


So obviously, R becomes slow, when new memory has to be allocated
repeatedly. I do not see a quick fix for apply, because apply can be
used with arbitrary functions which might yield different results for
different input data. But I think as long as memory allocation seems
to be a performance bottleneck, one should be aware of this problem,
use simple for-loops and use apply only on small data (small
dimensions) or where it is really necessary.

	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri May 29 15:05:40 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 09:05:40 -0500
Subject: performance of apply
In-Reply-To: Andreas Weingessel's message of Thu, 28 May 1998 15:25:59 +0200 (CEST)
References: <13677.26087.506888.469624@elendil.ci.tuwien.ac.at>
Message-ID: <6rlnrldvez.fsf@verdi.stat.wisc.edu>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> I noticed that apply is VERY SLOW when applied to a "large"
> dimension as for example when computing the row sums of a matrix with
> thousands of rows.
> 
> To demonstrate it, I did some benchmarking for different methods of
> computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.
> 
> The first method (M1) I used is the normal apply command:
> 	y <- apply(x,1,sum)
> The second method (M2) uses a for-loop for the computations, where the
> memory for the resulting vector has been allocated before. That is, for
> n=3D2000:
> 	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
> The third method (M3) also uses a for-loop, but the resulting vector
> is built recursively, i.e.
> 	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))
> 
> All computations have been made on a Pentium II 233MHz, 256MB, R
> started as R -v 50. The following table shows the minimum, mean, and
> maximum CPU-time in seconds as measured by system.time over 10 runs
> for every computation for different values of n.
> 
> n	M1			M2		M3
> 2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
> 4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
> 6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
> 8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
> 10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81
> 
> That is, the computation of the sums of the rows of a 10000x10 matrix
> with apply takes about 100sec on average, where a simple for-loop does
> the same job in about 2sec.

There would be at least two other methods that would be interesting to
try.  Because you are interested in the row sums I imagine by far the
fastest method would be (M4)
   y <- x %*% rep(1, ncol(x))
You may also find that (M5)
   y <- apply( t(x), 2, sum )
would be faster than M1 because of the way the R handles arrays.

We should keep in mind when looking at these tables that the maximum
time on the size 10000 case is about 2 minutes.  If the computation is
worth doing it may be worth waiting 2 minutes for the result.  I
remember the days of running S version 2 (i.e. the version before "New
S") on a Vax-11/750.  This sort of computation could take many, many
hours on the only computer in the department so relative differences
in speed for different methods were a lot more important.  One got
used to rephrasing computations in "efficient" ways.  Today I think
that clarity is usually more important than efficiency.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From wsimpson@uwinnipeg.ca  Fri May 29 15:32:52 1998
From: wsimpson@uwinnipeg.ca (Bill Simpson)
Date: Fri, 29 May 1998 09:32:52 -0500 (CDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
Message-ID: <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>

I was computing a function f(u,v) on bivariate point process data of
about 4500 points. The computation in R took about 96 hours (4 days!) on a
Pentium Pro 200 under linux with little or no other load. So I think speed
can be an issue, esp. when computing things one will eventually display
with image().

My collaborator and I wound up coding it in C and now the computation
takes 4 min (yes, 4 min vs 4 days).

Probably it could have been sped up in R but that would have taken the
same effort as coding in C, and the result would have been slower.

Bill Simpson

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Andreas.Weingessel@ci.tuwien.ac.at  Fri May 29 15:52:00 1998
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 29 May 1998 16:52:00 +0200 (CEST)
Subject: performance of apply
In-Reply-To: <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>
References: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
 <Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca>
Message-ID: <13678.52112.677406.807483@elendil.ci.tuwien.ac.at>



Maybe my point was not quite clear. I did not want to compute the row
sums of a certain matrix, I just wanted to demonstrate that the task
"apply a certain function to every row of a matrix" can take a very
long time, if it is done with the function "apply" which is of course
the most clear way to implement this task. I first came across this
problem when I made simulations on a data matrix with 15000 rows and
after adding one simple "apply" to my program, it suddenly seemed not to
finish at all.

If I just want make such a computation once, it might be not important
whether I wait a couple of seconds or 2 minutes or 5 minutes (as it
needs time for 15000 rows). But if I do some simulation where these
computations are repeated hundred times, there is a difference between
200 seconds or 200 minutes.

	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri May 29 16:11:04 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 10:11:04 -0500
Subject: performance of apply
In-Reply-To: Andreas Weingessel's message of Fri, 29 May 1998 16:52:00 +0200 (CEST)
References: <6rlnrldvez.fsf@verdi.stat.wisc.edu> 	<Pine.OSF.3.95.980529092504.31530A-100000@io.uwinnipeg.ca> <13678.52112.677406.807483@elendil.ci.tuwien.ac.at>
Message-ID: <6rd8cxdsdz.fsf@verdi.stat.wisc.edu>

Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:

> If I just want make such a computation once, it might be not important
> whether I wait a couple of seconds or 2 minutes or 5 minutes (as it
> needs time for 15000 rows). But if I do some simulation where these
> computations are repeated hundred times, there is a difference between
> 200 seconds or 200 minutes.

I should probably have been clearer about what I was saying.  I was
indicating that some computations can be re-phrased in non-obvious
ways that are substantially faster in R.  To a numerical analyst it
would be ridiculous to use a matrix multiplication to collect row sums
because you are doing all those multiplications by 1.  However, in R/S
it is substantially faster because the looping overhear is in C not in
R.

The other issue I was trying to indicate is that efficiency has to be
measured in how long it takes to get the work done.  This includes
both thinking (and often debugging) time and computing time.  The
trade-offs between the cost of thinking and the cost of computing have
changed remarkably over the years.  I often characterize the way I see
people computing now as using a computer as a blunt instrument with
which to bludgeon the problem to death (can you say "Markov Chain
Monte Carlo"?).  In real world terms it may be more efficient to do
that than to think deeply about the computations involved and how to
speed them up.

I have probably said too much about this.  I should go back to writing
my code, which, ironically, is C code designed to speed up simulations
for a particular type of statistical model :-)
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From luke@stat.umn.edu  Fri May 29 16:45:53 1998
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 29 May 1998 10:45:53 -0500 (CDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu> from "Douglas Bates" at May 29, 98 09:05:40 am
Message-ID: <9805291545.AA08154@nokomis.stat.umn.edu>

Douglas Bates wrote:
> 
> Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:
> > 
> > To demonstrate it, I did some benchmarking for different methods of
> > computing the row sums of an nx10 matrix with n =3D 2000, ..., 10000.
> > 
> > The first method (M1) I used is the normal apply command:
> > 	y <- apply(x,1,sum)
> > The second method (M2) uses a for-loop for the computations, where the
> > memory for the resulting vector has been allocated before. That is, for
> > n=3D2000:
> > 	z <- numeric(2000); for (i in 1:2000) z[i] <- sum(x[i,])
> > The third method (M3) also uses a for-loop, but the resulting vector
> > is built recursively, i.e.
> > 	z1 <- NULL; for (i in 1:2000) z1 <- c(z1,sum(x[i,]))
> > 
> > All computations have been made on a Pentium II 233MHz, 256MB, R
> > started as R -v 50. The following table shows the minimum, mean, and
> > maximum CPU-time in seconds as measured by system.time over 10 runs
> > for every computation for different values of n.
> > 
> > n			M1			M2		M3
> > 2000	 4.03  4.16   4.34	0.27 0.40 0.47	0.51 0.63 0.71
> > 4000	12.65 13.40  14.68	0.73 0.81 0.94	1.78 1.86 1.98
> > 6000	26.51 28.14  29.50	1.19 1.22 1.38	3.79 3.80 3.80
> > 8000	52.06 63.43  67.61	1.46 1.63 1.69	6.38 6.41 6.58
> > 10000	84.06 98.17 118.94	1.93 2.01 2.13  9.78 9.79 9.81
> > 
> > That is, the computation of the sums of the rows of a 10000x10 matrix
> > with apply takes about 100sec on average, where a simple for-loop does
> > the same job in about 2sec.

It looks like M1 and M3 are O(n^2) but M1 is O(n). I see where that
comes from in M3, but it surprises me for M1.

luke



-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri May 29 17:04:30 1998
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 29 May 1998 18:04:30 +0200
Subject: performance of apply
In-Reply-To: Luke Tierney's message of Fri, 29 May 1998 10:45:53 -0500 (CDT)
References: <9805291545.AA08154@nokomis.stat.umn.edu>
Message-ID: <x2af81t65t.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:


> > > That is, the computation of the sums of the rows of a 10000x10 matrix
> > > with apply takes about 100sec on average, where a simple for-loop does
> > > the same job in about 2sec.
> 
> It looks like M1 and M3 are O(n^2) but M1 is O(n). I see where that
> comes from in M3, but it surprises me for M1.

Oh, dear. Looking at apply, we have right in the middle of it:

            for (i in 1:d2) ans[[i]] <- FUN(array(newX[, i], d.call, 
                    dn.call), ...)

Assignment to the tail of a very long list... 

I think I'm beginning to understand why Ross keeps talking about
generic vectors. Either that or we need to add some low-level list
primitives to the language. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri May 29 17:14:36 1998
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 29 May 1998 09:14:36 -0700 (PDT)
Subject: performance of apply
In-Reply-To: <6rlnrldvez.fsf@verdi.stat.wisc.edu>
Message-ID: <Pine.LNX.3.96.980529090735.23645A-100000@buffy>

On 29 May 1998, Douglas Bates wrote:

> Andreas Weingessel <Andreas.Weingessel@ci.tuwien.ac.at> writes:
> 
> > I noticed that apply is VERY SLOW when applied to a "large"
> > dimension as for example when computing the row sums of a matrix with
> > thousands of rows.
> > 
> 

> 
> We should keep in mind when looking at these tables that the maximum
> time on the size 10000 case is about 2 minutes.  If the computation is
> worth doing it may be worth waiting 2 minutes for the result.  I
> remember the days of running S version 2 (i.e. the version before "New
> S") on a Vax-11/750.  This sort of computation could take many, many
> hours on the only computer in the department so relative differences
> in speed for different methods were a lot more important.  One got
> used to rephrasing computations in "efficient" ways.  Today I think
> that clarity is usually more important than efficiency.

One of the really nice things about R is that you _don't_ have to use
apply to get loops to run in reasonable time, since for most non-Lisp
people for() is simpler than apply(). 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Fri May 29 22:20:39 1998
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 30 May 1998 09:20:39 +1200 (NZST)
Subject: performance of apply
Message-ID: <199805292120.JAA14926@stat1.stat.auckland.ac.nz>

	Subject: Re: performance of apply
	From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
	Date: 29 May 1998 18:04:30 +0200
	MIME-Version: 1.0
	Content-Transfer-Encoding: 7bit

	Oh, dear. Looking at apply, we have right in the middle of it:

	            for (i in 1:d2) ans[[i]] <- FUN(array(newX[, i], d.call, 
	                    dn.call), ...)

	Assignment to the tail of a very long list... 

	I think I'm beginning to understand why Ross keeps talking about
	generic vectors. Either that or we need to add some low-level list
	primitives to the language. 


Got it in one.  To reach ans[[i]] you have to cdr down the whole list.
The subsetting code would be vastly simplified without the special
list code.  Ugliest of all is subscript manipulation for lists with
dim attributes.

[ I estimate 2 months for a fix - not that it will take that long,
  but there are some other things higher up the todo list ].

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jimrc@mathfs.math.montana.edu  Fri May 29 23:44:12 1998
From: jimrc@mathfs.math.montana.edu (Jim Robison-Cox)
Date: Fri, 29 May 1998 16:44:12 -0600 (MDT)
Subject: aov design questions
Message-ID: <Pine.ULT.3.91.980529162513.20891B-100000@mathfs.math.montana.edu>

R developers,

  I have a first attempt to make an aov function.  Eventually I want to
  build in  Error() structure, but first I am trying to get this
  presentable for balanced data with only a single stratum, just using 
  residual error.  I  am following R. M. Heiberger's Computation for the 
  Analysis of Designed Experiments, Wiley (1989)

  I a using a wrapper (aov.bal) to call the fitting function in the same 
way that lm() does a bunch of stuff and then calls lm.fit(), in fact I 
took most of the wrapper right out of lm(). I'm trying to make the aov 
object look as much as possible like an lm.object


  Several questions have come up which need discussion.

Q 1)  Is aov supposed to avoid qr decomposition and matrix inversion?
      In S it is claimed to be faster than lm() for large datasets.  Is
      that due to avoidance of qr()? 

      (My main goal is to get the Error strata working.)


Q 2)  If the speed is important, can we give up choice of contrasts used to
  set up the dummy factor variables? ( contr.treatment, contr.sum) 

   Why do I ask? 
   In pursuit of speed (we're talking nanoseconds for a reasonable size
   data set) I have forced in helmert  contrasts because their
   orthogonality makes it slick to compute. So in this version, whatever
   option(contrasts) is set will be ignored.

   I don't like making that choice for the user esp. since it gives wrong 
   answers under the default contrasts, and have thought about
   converting back into the original contrasts, but it isn't easy with
   higher-way anova models. It looks easy in VR2 p 197-204 
   (BTW I have kroenecker and ginv functions if anyone wants them)
  but I don't get it to work out nicely.  V&R show the contrast
  transformation as:
   alpha_T = ginv(C_T) %*% C_H %*% alpha_H
  where C_T is the contrast matrix for treatment contrasts, and C_H for
  Helmert contrasts. The alpha's contain only the treatment contrast 
  effects, not the mean.  This would leave the intercept estimate
   unchanged (not right).  For single factors it works to stick a 
  col.vector of 1s on the front of C_H and C_T, and include the mu.hat in 
  the alpha_H or alpha_T.  But when I get into interactions, I don't see 
  what is needed.

Q 3)  I am having a problem with keep.order. With balanced data, I know
    the effects are orthogonal, so order is not an issue, but as I move
    onto the tougher cases, I need model.matrix to preserve order, and
    it doesn't.

Q 4)  What are the $effects in lm.objects?
     For the moment I've stuck in the coefficients.

Q 5)  Any objection to passing cov.unscaled from aov to summary.aov?
    (Since I'm not using qr and can't pass R)

Feedback needed, comments are welcome.


Jim Robison-Cox                 ____________            
Department of Math Sciences    |            |           phone: (406)994-5340
2-214 Wilson Hall               \   BZN, MT |           FAX:   (406)994-1789
Montana State University         |  *_______|
Bozeman, MT 59717                 \_|         e-mail: jimrc@math.montana.edu 

#---------------------------------------------------------------------------
##  First hack at aov for balanced data

aov.bal <- function(formula, data = list(), subset, weights, na.action, 
        method = "qr", model = TRUE, keep.order=F, ...) 
{  
     mt <- terms(formula, data = data, keep.order = keep.order)
     nt <- length(attr(mt,"order")[attr(mt,"order") ==1])
     lt <- rep("contr.helmert",nt)            ## Sets helmert contrasts
     names(lt) <- attr(mt,"term.labels")[ attr(mt,"order") ==1]
     mf <- match.call()
     mf$model <- NULL
     mf[[1]] <- as.name("model.frame")
     mf <- eval(mf, sys.frame(sys.parent()))
     if (method == "model.frame") 
          return(mf)
     else if (method != "qr")  ## change for aov??
         warning(paste("method =", method, "is not supported. Using \"qr\"."))
     if (length(list(...))) 
          warning(paste("Extra arguments", deparse(substitute(...)), 
                        "are just disregarded."))
     y <- model.response(mf, "numeric")
     w <- model.weights(mf)
     if (is.empty.model(mt)) {
                z <- list(coefficients = numeric(0), residuals = y, 
                        fitted.values = 0 * y, weights = w, rank = 0, 
                        df.residual = length(y))
                class(z) <- if (is.matrix(y)) 
                        c("mlm.null", "lm.null", "mlm", "lm")
                else c("lm.null", "lm")
     }
     else {
                x <- model.matrix(mt, mf, as.list(lt))
                          # forces in contr.helmert
                z <- if (is.null(w)) {
                   aov.balanced.fit(x, y, mt)
		}
                else {
                  stop("Weighted aov not implemented, use lm")
                  #aov.balanced.wfit(x, y, mt, w)
                }
                class(z) <- c(if (is.matrix(y)) c("maov","mlm"), c("aov","lm"))
     }
     z$call <- match.call()
     z$terms <- mt
     if (model) 
         z$model <- mf
     z
}

aov.balanced.fit <- function(x,y,mod.terms,wt=NULL){
    x <- as.matrix(x); dimx <- dim(x)
    xnames <- dimnames(x)[[2]]
    y <- as.matrix(y); dimy <- dim(y)
    assn <- attr(x,"assign")
    df  <-   c(table(assn), dimy[1]- dimx[2])
    D <- diag(1/diag(t(x) %*% x))
    dimnames(D) <- list(xnames,xnames)
    coef <- as.numeric(D %*% t(x) %*%  y)
    names(coef) <- xnames
    fits <- x %*% coef
    resid <- y - fits
    eff <-  apply((t(x) * rep(coef,dimx[1]))^2,1,sum)
             ## Take each column of x (row of t(x)) times its
             ## coefficient, square the result and sum (over columns of x)
    eff <-  c(sapply( split(eff,assn), sum),   sum(resid^2))
             ## Adds them up over the factors.
    if(attr(mod.terms,"intercept") == 1) {
      eff <- eff[-1]
      df  <- df[-1]
    }
    name <- c(attr(mod.terms,"term.labels"), "Residuals")
    names(eff) <- name
    names(df)  <- name
    list(coefficients= coef, residuals = resid, effects = eff, 
         rank= dimx[2], fitted.values = fits, assign= assn,
         cov.unscaled = D, df.residual =  dimy[1] - dimx[2],
         df =  df  )
    
}

print.aov <- 
function (x, digits = max(3, .Options$digits - 3), ...) 
{  
   lenx <- length(x$df)
   tabl <- cbind(x$df,x$effects, x$effects/x$df)
   tabl <- cbind(tabl,c(tabl[1:(lenx-1),3]/tabl[lenx,3],NA))
   tabl <- cbind(tabl,1-pf(tabl[,4],tabl[,1],tabl[lenx,1]))
   dimnames(tabl) <- list(names(x$effects), c("df","SS","MS","F","P > F"))
   cat("\nAnalysis of Variance:\n\n")
   print.default(round(tabl, digits), na = "", print.gap = 2)
   cat("\n")
   invisible(x)
}


summary.aov <- function (z, correlation=F) 
{
        p <- z$rank
        p1 <- 1:p
        r <- resid(z)
        f <- fitted(z)
        n <- length(f)
        w <- weights(z)
        if (is.null(z$terms)) {
                stop("invalid 'aov' object:  no terms component")
        }
        else {
                if (is.null(w)) {
                        mss <- if (attr(z$terms, "intercept")) 
                                sum((f - mean(f))^2)
                        else sum(f^2)
                        rss <- sum(r^2)
                }
        }
        resvar <- rss/(n - p)
        se <- sqrt(resvar * diag(z$cov.unscaled))
        est <- z$coefficients
        tval <- est/se
        ans <- z[c("call", "terms")]
        ans$residuals <- as.numeric(r)
        ans$coefficients <- cbind(est, se, tval, 2 * (1 - pt(abs(tval), 
                n - p)))
        dimnames(ans$coefficients) <- list(names(z$coefficients),
                c("Estimate", "Std.Error", "t Value", "Pr(>|t|)"))
        ans$sigma <- sqrt(resvar)
        ans$df <- c(p, n - p)
        if (p != attr(z$terms, "intercept")) {
                df.int <- if (attr(z$terms, "intercept")) 
                        1
                else 0
                ans$r.squared <- mss/(mss + rss)
                #0.14 :	(n/(n-p))
                ans$adj.r.squared <- 1 - (1 - ans$r.squared) * 
                        ((n - df.int)/(n - p))
                ans$fstatistic <- c((mss/(p - df.int))/(rss/(n - 
                        p)), p - df.int, n - p)
                #0.14: ans$fstatistic <- c((mss/(p-1))/(rss/(n-p)),p-1,n-p)
                names(ans$fstatistic) <- c("value", "numdf", 
                        "dendf")
        }
        ans$cov.unscaled <- z$cov.unscaled
        if (correlation) {
                invsqrt.diag <- diag(sqrt(1/diag(z$cov.unscaled)))
                ans$correlation <-
                      invsqrt.diag %*% z$cov.unscaled %*% invsqrt.diag
                dimnames(ans$correlation) <- dimnames(z$cov.unscaled)
        }
        class(ans) <- "summary.aov"
        ans
}

print.summary.aov <- function (x, digits = max(3, .Options$digits - 3), 
                              roundfun = round, ...) 
{
        cat("\nCall:\n")
        cat(paste(deparse(x$call), sep = "\n", collapse = "\n"), 
                "\n\n", sep = "")
        resid <- x$residuals
        df <- x$df
        rdf <- df[2]
        if (rdf > 5) {
                cat("Residuals:\n")
                if (length(dim(resid)) == 2) {
                        rq <- apply(t(resid), 1, quantile)
                        dimnames(rq) <- list(c("Min", "1Q", "Median", 
                                "3Q", "Max"), dimnames(resid)[[2]])
                }
                else {
                        rq <- quantile(as.numeric(resid))
                        names(rq) <- c("Min", "1Q", "Median", 
                                "3Q", "Max")
                }
                print(rq, digits = digits, ...)
        }
        else if (rdf > 0) {
                cat("Residuals:\n")
                print(resid, digits = digits, ...)
        }
#        if (nsingular <- df[3] - df[1]) 
#                cat("\nCoefficients: (", nsingular, " not defined because of singularities)\n", 
#                        sep = "")
#        else
        cat("\nCoefficients:\n")
        print(roundfun(x$coefficients, digits = digits), quote = FALSE, 
                ...)
        cat("\nResidual standard error:", format(signif(x$sigma, 
                digits)), "on", rdf, "degrees of freedom\n")
        if (!is.null(x$fstatistic)) {
                cat("Multiple R-Squared:", format(signif(x$r.squared, 
                        digits)))
                cat(",\tAdjusted R-squared:", format(signif(x$adj.r.squared, 
                        digits)), "\n")
                cat("F-statistic:", format(signif(x$fstatistic[1], 
                        digits)), "on", x$fstatistic[2], "and", 
                        x$fstatistic[3], "degrees of freedom")
                cat(",\tp-value:", format(signif(1 - pf(x$fstatistic[1], 
                        x$fstatistic[2], x$fstatistic[3]), digits)), 
                        "\n")
        }
        correl <- x$correlation
        if (!is.null(correl)) {
                p <- dim(correl)[2]
                if (p > 1) {
                        cat("\nCorrelation of Coefficients:\n")
                        correl[!lower.tri(correl)] <- NA
                        print(correl[-1, -NCOL(correl)], digits = digits, 
                                na = "")
                }
        }
        cat("\n")
        invisible(x)
}

#-------------------------------------------------------------------------
##  Rd file:
\name{aov.bal}
\title{Function to compute analysis of variance for balanced designs}
\usage{
aov.bal(formula, data=list(), subset, weights, na.action, method="qr", model=TRUE, keep.order=F, ...)
}
%- maybe also `usage' for other functions documented here.
\alias{aov.bal}
\alias{summary.aov}
\alias{coefficients.lm}
\alias{df.residual.lm}
\alias{fitted.values.lm}
\alias{residuals.lm}
\alias{aov.balanced.fit}
\alias{print.aov}
\alias{print.summary.aov}
\keyword{regression}
%- Also NEED an `\alias' for EACH other function documented here.
\arguments{
 \item{formula}{A detailed description of the model to be fit.  See
   details under \code{\link{lm}} }
 \item{data}{ data frame contining the data to be fit. Default is
   working directory.}
 \item{subset}{Description of what rows of the data frame to use in the fit. }
 \item{na.action}{ Currently not used }
 \item{method}{Not currently used, except that method="model.frame" will
 extract the model frame only and not fit the anova.}
 \item{model}{ If true, model frame is included in the output.}
 \item{keep.order}{If true, model should be evaluated in the order
   specified by the model statement. (Doesn't work.)}
 \item{\dots}{ other arguments (not presently used) }
}
\description{
\code{aov.bal} is used to fit analysis of variance models.  Eventually it
will handle multiple strata. The generic accessor functions
\code{coefficients}, \code{fitted.values} and \code{residuals}
can be used to extract various useful features of the
value returned by \code{aov.bal}.  Currently \code{aov.bal} uses only the
Helmert contrasts and ignores the contrast functions set by
options()$contrast. 
}
\value{
\code{aov.bal} returns an object of class code\aov} which may be printed
with the \code{print.aov} or \code{summary.aov}.
  \item{coefficients}{Coefficients under the Helmert contrasts.}
  \item{residuals} {Residuals}
  \item{effects } {effects ?=? coefficients?}
  \item{rank}     
  \item{fitted.values}
  \item{assign}
  \item{var }
  \item{df.residual}
  \item{df}
  \item{call}
  \item{terms}
}
\references{ Heiberger, R. M., 1989, Computation for the Analysis of
  Designed Experiments, Wiley}
\author{ Jim Robison-Cox }
\seealso{ \code{\link{lm}},\code{\link{glm}},\code{\link{coefficients}},\code{\link{residuals}},\code{\link{fitted.values}} }

\examples{
 speed <- c(59, 69, 66, 75, 54, 65, 58, 70, 66, 77, 71, 71, 58, 65, 56,
            62, 54, 60, 52, 64, 59, 73, 60, 70)
 typists <- gl(6,4,24)
 brands  <- gl(4,1,24)
 type.aov <- aov.bal(speed ~ typists + brands)
 summary(type.aov)
}
\keyword{ regression }%-- one or more ...
\keyword{models}


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sat May 30 00:09:10 1998
From: bates@stat.wisc.edu (Douglas Bates)
Date: 29 May 1998 18:09:10 -0500
Subject: An R BOF meeting at the JSM?
Message-ID: <6raf80d695.fsf@verdi.stat.wisc.edu>

The BOF in the subject line is a "Birds Of a Feather" meeting.  This
is a chance for people who normally only get the chance to communicate
via e-mail to actually sit down and talk to each other in person.

I plan to be at the Joint Statistical Meetings in Dallas in August.
If you will be attending and would be interested in getting together
with some other R folks, please e-mail me and I will try to set
something up. Usually there is a mixer for the Statistical Computing
and Statistical Graphics sections on Monday night so that might be a
good time and place to try to meet.  I'm assuming pretty well everyone
on the R-devel group would belong to one of those sections.  If not
you could probably come anyway and just pretend you are not eating any
of the peanuts.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

