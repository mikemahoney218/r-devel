From SeshanV at mskcc.org  Sun May  1 00:11:47 2011
From: SeshanV at mskcc.org (SeshanV at mskcc.org)
Date: Sat, 30 Apr 2011 18:11:47 -0400
Subject: [Rd] Kendall's tau code
In-Reply-To: <19900.31123.896985.311637@stat.math.ethz.ch>
References: <3C5050149D662D4C8E41A0EC71CAE93447EBB30DAE@SMSKPEX7MBX6.MSKCC.ROOT.MSKCC.ORG>,
	<19900.31123.896985.311637@stat.math.ethz.ch>
Message-ID: <3C5050149D662D4C8E41A0EC71CAE93447EBB30DAF@SMSKPEX7MBX6.MSKCC.ROOT.MSKCC.ORG>

Feel free to contact me.

Thanks,
Venkat


________________________________________
From: Martin Maechler [maechler at stat.math.ethz.ch]
Sent: Saturday, April 30, 2011 5:05 PM
To: Seshan, Venkatraman E./Epidemiology-Biostatistics
Cc: r-devel at r-project.org
Subject: Re: [Rd] Kendall's tau code

>>>>> "S" == SeshanV  <SeshanV at mskcc.org>
>>>>>     on Sat, 30 Apr 2011 11:20:59 -0400 writes:

    > I discovered that the Kendall's tau calculation in R uses
    > all pairwise comparisons which is O(n^2) and takes a long time for
    > large vectors. I implemented a O(n*log(n)) algorithm based on
    > merge-sort. Is this of interest to be included in core R?

Yes, quite a bit of interest!

I know about the O(n^2) "feature" for quite a while, and it is
indeed a considerable problem in copula modelling which has
become an interest of mine in the recent year.

    > The code (fortran and R wrapper) is available in my package clinfun v0.9.7
    > (not exported in NAMESPACE).

Thank you! Yes, I see you've put them there quite recently.
I see the Fortran code uses modern allocate / deallocate
constructs (that I don't know).
As I think we'd want to use this in the C code which is also
underlying
        cor(*, method="kendall")
I'll eventually want a C version, not the least because we may
look into dealing with  NA 's in the same -- flexible -- way
that they are handled currently via the  'use = "..."'
argument.

I may contact you privately for more.
Thanks again,

Martin Maechler,
ETH Zurich (and R Core Team).



    >Thanks, Venkat

    > --
    > Venkatraman E. Seshan, Ph.D. | Attending Biostatistician
    > Director of Biostatistics Computer-Intensive Support Services
    > Department of Epidemiology and Biostatistics | MSKCC
    > 307 E 63rd St 3rd Floor | New York, NY 10065
    > Phone: 646-735-8126 | Fax: 646-735-0010

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel



     =====================================================================
     
     Please note that this e-mail and any files transmitted with it may be
     privileged, confidential, and protected from disclosure under 
     applicable law. If the reader of this message is not the intended 
     recipient, or an employee or agent responsible for delivering this 
     message to the intended recipient, you are hereby notified that any 
     reading, dissemination, distribution, copying, or other use of this 
     communication or any of its attachments is strictly prohibited.  If 
     you have received this communication in error, please notify the 
     sender immediately by replying to this message and deleting this 
     message, any attachments, and all copies and backups from your 
     computer.


From favorov at sensi.org  Sun May  1 01:25:08 2011
From: favorov at sensi.org (Alexander Favorov)
Date: Sat, 30 Apr 2011 19:25:08 -0400
Subject: [Rd] Bug report: R 2.14.0dev Sweave option width does not work
Message-ID: <4DBC9A54.9080707@sensi.org>

Hi!

In R 2.14.0dev (R version 2.14.0 Under development (unstable) 
(2011-04-29 r55692), Windows release 
(http://cran.r-project.org/bin/windows/base/rdevel.html), the line :

options(width=55)

in code chunk of an Rnw file has no effect on sweave's output text file.

The same thing in 2.13.0 worked.

WBR,
ALexander Favorov


From hadley at rice.edu  Sun May  1 04:54:39 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Sat, 30 Apr 2011 21:54:39 -0500
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
Message-ID: <BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>

If this message is garbled for anyone else, the original question on
stackoverflow is here:
http://stackoverflow.com/questions/5841339/using-notation-for-reference-class-methods

Hadley

On Sat, Apr 30, 2011 at 11:35 AM, Chad Goymer <chad.goymer at hotmail.co.uk> wrote:
>
> I've been trying to use methods for reference classes via the notation "[[...]]" (X[["doSomething"]] rather than X$doSomething), but it failed to work. However, I did find that if you use the usual "$" notation first, "[[...]]" can be used afterwards. The following simple example illustrates the point:
>> setRefClass("Number", + ? fields = list(+ ? ? value = "numeric"+ ? ),+ ? methods = list(+ ? ? addOne = function() {+ ? ? ? value <<- value + 1+ ? ? }+ ? )+ )> X <- new("Number", value = 1)> X[["value"]][1] 1
>> X[["addOne"]]()Error: attempt to apply non-function> class(X[["addOne"]]) # NULL[1] "NULL"
>> class(X$addOne)[1] "refMethodDef"attr(,"package")[1] "methods"
>> X[["addOne"]]()> X[["value"]][1] 2> class(X[["addOne"]])[1] "refMethodDef"attr(,"package")[1] "methods"
> Is this a bug?
> Chad Goymer
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From murdoch.duncan at gmail.com  Sun May  1 13:35:49 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 01 May 2011 07:35:49 -0400
Subject: [Rd] Bug report: R 2.14.0dev Sweave option width does not work
In-Reply-To: <4DBC9A54.9080707@sensi.org>
References: <4DBC9A54.9080707@sensi.org>
Message-ID: <4DBD4595.8070005@gmail.com>

On 30/04/11 7:25 PM, Alexander Favorov wrote:
> Hi!
>
> In R 2.14.0dev (R version 2.14.0 Under development (unstable)
> (2011-04-29 r55692), Windows release
> (http://cran.r-project.org/bin/windows/base/rdevel.html), the line :
>
> options(width=55)
>
> in code chunk of an Rnw file has no effect on sweave's output text file.
>
> The same thing in 2.13.0 worked.
>

What effect do you expect?  That would only have an effect if
   - the option value was different before that line, and
   - you printed something that would differ in the two widths.

Please put together an example to illustrate what problem you're seeing.

Duncan Murdoch


From cstrato at aon.at  Sun May  1 22:10:55 2011
From: cstrato at aon.at (cstrato)
Date: Sun, 01 May 2011 22:10:55 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DB7D0DD.6040201@statistik.tu-dortmund.de>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
Message-ID: <4DBDBE4F.8020702@aon.at>

Dear Duncan, dear Uwe,

Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a 
virtual machine, I have now done the following tests on all three 
architectures:

1, R CMD build xps:
This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as 
pdf-file. Thus R CMD build is ok.

2, R CMD check xps:
This does NOT build the vignettes as pdf-files on all three 
architectures. Or to be more precise, R-2.13.0 does no longer build the 
vignettes since with R-2.12.2 and earlier versions R did create the 
vignettes as pdf-files.

Thus the question is:
Why does R CMD check no longer create the vignettes?

Best regards
Christian


On 4/27/11 10:16 AM, Uwe Ligges wrote:
>
>
> On 26.04.2011 21:58, cstrato wrote:
>> Dear Duncan, dear Uwe,
>>
>> Just now I have re-run everything, and today xps.Rnw can be converted to
>> a vignette w/o any problems using:
>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>> b, R CMD Sweave xps.Rnw
>>
>> In both cases the vignette xps.pdf is created (maybe my Mac did not like
>> to work during eastern holidays).
>>
>> However, one issue remains:
>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files for
>> the vignettes.
>
>
> Dioes it give an error or warning? It should check the code. R CMD build
> creates the pdf files.
>
> Uwe Ligges
>
>>
>> Best regards
>> Christian
>>
>>
>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>> Thank you.
>>>>
>>>> My problem seems to be that at the moment the problem can be seen only
>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>> creating
>>>> the vignettes.
>>>
>>> Then you are definitely the one in the best position to diagnose the
>>> problem. Use the usual approach: simplify it by cutting out everything
>>> that looks unrelated. Verify that the problem still exists, then cut
>>> some more. Eventually you'll have isolated the error to a particular
>>> small snippet of code, and then you can add print() statements, or use
>>> trace(), or do whatever is necessary to see what's so special about your
>>> system.
>>>
>>> I suspect it will turn out to be an assumption in the code that is not
>>> true on your system.
>>>
>>> If the assumption is being made by code you wrote, then fix it. If it's
>>> being made by R, let us know.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> Best regards
>>>> Christian
>>>>
>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>> cstrato wrote:
>>>>>> Dear Duncan,
>>>>>>
>>>>>> Thank you for your example, however it is different since it does not
>>>>>> use x and y. What about print(x+y)?
>>>>>
>>>>> Try it.
>>>>>
>>>>>>
>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>> R-2.12.2.
>>>>>> 2, the identical code works in the examples
>>>>>> 3, this code (or a similar code) is the starting code which all users
>>>>>> of xps have to use, and there was never a problem.
>>>>>
>>>>> This might be a problem in R, or might be a problem in your code. As
>>>>> far
>>>>> as I know, it has only shown up in your code, so I'd guess that's
>>>>> where
>>>>> the problem is. In any case, you're the one in the best position to
>>>>> isolate it and debug it.
>>>>>
>>>>> If it turns out to be a problem in R, put together an example
>>>>> illustrating the problem that doesn't involve your code, and I'll
>>>>> take a
>>>>> look.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> Maybe the reason could be that my code has to import
>>>>>> - the CEL-files from the package dir
>>>>>> - the file SchemeTest3.root from the package dir
>>>>>> ??
>>>>>>
>>>>>> Best regards
>>>>>> Christian
>>>>>>
>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>> cstrato wrote:
>>>>>>>> Dear Uwe,
>>>>>>>>
>>>>>>>> Your suggestion to look at the Sweave manual helped me to solve the
>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the code
>>>>>>>> from
>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have this
>>>>>>> in a
>>>>>>> Sweave file:
>>>>>>>
>>>>>>> <<>>=
>>>>>>> x<- 1
>>>>>>> @
>>>>>>>
>>>>>>> <<>>=
>>>>>>> y<- 2
>>>>>>> @
>>>>>>>
>>>>>>> <<>>=
>>>>>>> print(x)
>>>>>>> @
>>>>>>>
>>>>>>> I will see the value of x getting printed, even though it came from
>>>>>>> two
>>>>>>> chunks earlier.
>>>>>>>
>>>>>>> I think Uwe is right: there is some bug in the code you're running.
>>>>>>> Sweave isn't the problem.
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>> Concretely, the following does not work since chunk 5 needs the
>>>>>>>> code
>>>>>>>> from chunk 3 and 4:
>>>>>>>>
>>>>>>>> ###################################################
>>>>>>>> ### chunk number 3:
>>>>>>>> ###################################################
>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>
>>>>>>>> ###################################################
>>>>>>>> ### chunk number 4:
>>>>>>>> ###################################################
>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>> "schemes",
>>>>>>>> "SchemeTest3.root"))
>>>>>>>>
>>>>>>>> ###################################################
>>>>>>>> ### chunk number 5:
>>>>>>>> ###################################################
>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>
>>>>>>>>
>>>>>>>> However, when I add "celdir" to chunk 5 then everything works since
>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from chunk 3:
>>>>>>>>
>>>>>>>> ###################################################
>>>>>>>> ### chunk number 5:
>>>>>>>> ###################################################
>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>
>>>>>>>>
>>>>>>>> Now buildVignettes() is able to create the vignettes, however R CMD
>>>>>>>> check still does not build the vignettes.
>>>>>>>>
>>>>>>>>
>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>
>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>
>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created which
>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex and
>>>>>>>> xps.pdf.
>>>>>>>>
>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory "inst/doc"
>>>>>>>> and
>>>>>>>> no vignettes are built.
>>>>>>>>
>>>>>>>> One more issue:
>>>>>>>> In contrast to my former believe R CMD INSTALL does not build the
>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>>
>>>>>>>>
>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>> Dear Uwe,
>>>>>>>>>>
>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>
>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>
>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the collection of
>>>>>>>>>>>> help
>>>>>>>>>>>> pages,
>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files does
>>>>>>>>>>>> work
>>>>>>>>>>>> for
>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>
>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem since I
>>>>>>>>>>>> see
>>>>>>>>>>>> it on
>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>> root is
>>>>>>>>>>> a bit
>>>>>>>>>>> too much effort.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>> No, until now I did not try another OS, but I will, since xps
>>>>>>>>>> has to
>>>>>>>>>> work on all three OSes.
>>>>>>>>>>
>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>
>>>>>>>>>> I showed you the output of R-2.12.2 first and then the output of
>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with the
>>>>>>>>>> same
>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>> supposed to
>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>> ...
>>>>>>>>>>>> ...
>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>
>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>> ...
>>>>>>>>>>>> ...
>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> I must admit that I have never built the vignettes manually,
>>>>>>>>>>>> and I
>>>>>>>>>>>> cannot find a hint how I can do it from the command line. Is
>>>>>>>>>>>> this
>>>>>>>>>>>> possible?
>>>>>>>>>> Is it possible to build the vignettes from the command line?
>>>>>>>>> R --help suggests there is
>>>>>>>>> R CMD Sweave .....
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>> \output is
>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> can
>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work fine with
>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>> "schemes",
>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>> "schemes",
>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>> i.e.
>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>> How objects generated in one chunk can be reused later on is
>>>>>>>>>>> explained
>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following two
>>>>>>>>>>>> chunks:
>>>>>>>>>>>>
>>>>>>>>>>>> #################################################
>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>> library(xps)
>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>> "schemes",
>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA", verbose=FALSE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> In summary it is not quite clear to me what has changed in
>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>
>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> can
>>>>>>>>>>>> not be opened
>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>> definitively
>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied path.
>>>>>>>>>>>
>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does not
>>>>>>>>>> change
>>>>>>>>>> the path, otherwise it would not work on all older versions of R.
>>>>>>>>> Right, but since something changed obviously, and you tell us the
>>>>>>>>> path
>>>>>>>>> is not a path, it might be a function used by root.scheme ....
>>>>>>>>> That's
>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>
>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the last
>>>>>>>>>>>> two
>>>>>>>>>>>> years
>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are able to
>>>>>>>>>>>> build
>>>>>>>>>>>> the
>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>> See
>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> and find that their Mac Servers are also fine with it. So maybe
>>>>>>>>>>> it is
>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>> independent
>>>>>>>>>> machines?
>>>>>>>>>>
>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>> nothing
>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>
>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>
>>>>>>>>> Uwe Ligges
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>>
>>>>>>>>>>> Best wishes,
>>>>>>>>>>> Uwe
>>>>>>>>>>>
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created the
>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer able to
>>>>>>>>>>>>>> build
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK
>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>> tried to
>>>>>>>>>>>>> build
>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>
>>>>>
>>>
>>>
>


From jmc at r-project.org  Mon May  2 00:09:37 2011
From: jmc at r-project.org (John Chambers)
Date: Sun, 01 May 2011 15:09:37 -0700
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
Message-ID: <4DBDDA21.3020809@r-project.org>

Yes, as presented on that site it makes a little more sense:

"While experimenting with the new reference classes in R I noticed some 
odd behaviour if you use the "[[ ]]" notation for methods 
(X[["doSomething"]] instead of X$doSomething). This notation works for 
fields, but I initially thought it wouldn't work for methods until I 
found that if you execute "class(X$doSomething)" you can then use "[[ 
]]" afterwards. The simple example below illustrates the point."

For reference classes, "[[" is not meant to be used either for fields or 
methods.  That it "works" at all is an artifact of the implementation 
using environments.  And arguably the failure to throw an error in that 
circumstance is a bug.

Please use the API as described in the ?ReferenceClasses documentation. 
  These are encapsulated methods, in the usual terminology, with the 
operator "$" playing the role normally assigned to "." in other languages.

A separate  but related issue:  It is possible to define S4 methods for 
reference classes, as discussed in a previous thread, arguably also an 
artifact in that a reference class is implemented as an S4 class of the 
same name.  These are functional methods, associated with a generic 
function, and so outside the encapsulation paradigm.

It would be interesting to get some experience and opinions on whether 
this is a good idea or not.  It breaks encapsulation, in that the 
behavior of the class can no longer be inferred from the class 
definition alone.  On the other hand, it is convenient and relates to 
"operator overloading" in some other languages.

John

On 4/30/11 7:54 PM, Hadley Wickham wrote:
> If this message is garbled for anyone else, the original question on
> stackoverflow is here:
> http://stackoverflow.com/questions/5841339/using-notation-for-reference-class-methods
>
> Hadley
>
> On Sat, Apr 30, 2011 at 11:35 AM, Chad Goymer<chad.goymer at hotmail.co.uk>  wrote:
>>
>> I've been trying to use methods for reference classes via the notation "[[...]]" (X[["doSomething"]] rather than X$doSomething), but it failed to work. However, I did find that if you use the usual "$" notation first, "[[...]]" can be used afterwards. The following simple example illustrates the point:
>>> setRefClass("Number", +   fields = list(+     value = "numeric"+   ),+   methods = list(+     addOne = function() {+       value<<- value + 1+     }+   )+ )>  X<- new("Number", value = 1)>  X[["value"]][1] 1
>>> X[["addOne"]]()Error: attempt to apply non-function>  class(X[["addOne"]]) # NULL[1] "NULL"
>>> class(X$addOne)[1] "refMethodDef"attr(,"package")[1] "methods"
>>> X[["addOne"]]()>  X[["value"]][1] 2>  class(X[["addOne"]])[1] "refMethodDef"attr(,"package")[1] "methods"
>> Is this a bug?
>> Chad Goymer
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>


From mtmorgan at fhcrc.org  Mon May  2 00:37:07 2011
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 01 May 2011 15:37:07 -0700
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <4DBDDA21.3020809@r-project.org>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org>
Message-ID: <4DBDE093.5080300@fhcrc.org>

On 05/01/2011 03:09 PM, John Chambers wrote:
> Yes, as presented on that site it makes a little more sense:
>
> "While experimenting with the new reference classes in R I noticed some
> odd behaviour if you use the "[[ ]]" notation for methods
> (X[["doSomething"]] instead of X$doSomething). This notation works for
> fields, but I initially thought it wouldn't work for methods until I
> found that if you execute "class(X$doSomething)" you can then use "[[
> ]]" afterwards. The simple example below illustrates the point."
>
> For reference classes, "[[" is not meant to be used either for fields or
> methods. That it "works" at all is an artifact of the implementation
> using environments. And arguably the failure to throw an error in that
> circumstance is a bug.
>
> Please use the API as described in the ?ReferenceClasses documentation.
> These are encapsulated methods, in the usual terminology, with the
> operator "$" playing the role normally assigned to "." in other languages.
>
> A separate but related issue: It is possible to define S4 methods for
> reference classes, as discussed in a previous thread, arguably also an
> artifact in that a reference class is implemented as an S4 class of the
> same name. These are functional methods, associated with a generic
> function, and so outside the encapsulation paradigm.
>
> It would be interesting to get some experience and opinions on whether
> this is a good idea or not. It breaks encapsulation, in that the
> behavior of the class can no longer be inferred from the class
> definition alone. On the other hand, it is convenient and relates to
> "operator overloading" in some other languages.

I have written 'show' methods for reference classes (is there another 
way to pretty-print them?) and S4 methods that dispatch to reference 
methods (in particular, yield(x) on connection-like classes dispatching 
to x$yield()). The latter partly to provide end-user familiarity 
(limiting need for the beleaguered user to have to learn yet another 
syntax for invoking methods, though maybe hiding hints about important 
differences in object behavior -- I am dreading the introductory class 
where one tries to explain S3, S4, and reference classes), and partly to 
provide a distinction between a 'developer' API and a user API (again 
with questionable merits).

Martin

>
> John
>
> On 4/30/11 7:54 PM, Hadley Wickham wrote:
>> If this message is garbled for anyone else, the original question on
>> stackoverflow is here:
>> http://stackoverflow.com/questions/5841339/using-notation-for-reference-class-methods
>>
>>
>> Hadley
>>
>> On Sat, Apr 30, 2011 at 11:35 AM, Chad
>> Goymer<chad.goymer at hotmail.co.uk> wrote:
>>>
>>> I've been trying to use methods for reference classes via the
>>> notation "[[...]]" (X[["doSomething"]] rather than X$doSomething),
>>> but it failed to work. However, I did find that if you use the usual
>>> "$" notation first, "[[...]]" can be used afterwards. The following
>>> simple example illustrates the point:
>>>> setRefClass("Number", + fields = list(+ value = "numeric"+ ),+
>>>> methods = list(+ addOne = function() {+ value<<- value + 1+ }+ )+ )>
>>>> X<- new("Number", value = 1)> X[["value"]][1] 1
>>>> X[["addOne"]]()Error: attempt to apply non-function>
>>>> class(X[["addOne"]]) # NULL[1] "NULL"
>>>> class(X$addOne)[1] "refMethodDef"attr(,"package")[1] "methods"
>>>> X[["addOne"]]()> X[["value"]][1] 2> class(X[["addOne"]])[1]
>>>> "refMethodDef"attr(,"package")[1] "methods"
>>> Is this a bug?
>>> Chad Goymer
>>>
>>> [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From murdoch.duncan at gmail.com  Mon May  2 01:17:10 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 01 May 2011 19:17:10 -0400
Subject: [Rd] Bug report: R 2.14.0dev Sweave option width does not work
In-Reply-To: <4DBD4595.8070005@gmail.com>
References: <4DBC9A54.9080707@sensi.org> <4DBD4595.8070005@gmail.com>
Message-ID: <4DBDE9F6.5060606@gmail.com>

On 11-05-01 7:35 AM, Duncan Murdoch wrote:
> On 30/04/11 7:25 PM, Alexander Favorov wrote:
>> Hi!
>>
>> In R 2.14.0dev (R version 2.14.0 Under development (unstable)
>> (2011-04-29 r55692), Windows release
>> (http://cran.r-project.org/bin/windows/base/rdevel.html), the line :
>>
>> options(width=55)
>>
>> in code chunk of an Rnw file has no effect on sweave's output text file.
>>
>> The same thing in 2.13.0 worked.
>>
>
> What effect do you expect?  That would only have an effect if
>     - the option value was different before that line, and
>     - you printed something that would differ in the two widths.
>
> Please put together an example to illustrate what problem you're seeing.
>
> Duncan Murdoch
>

Turned out (from a private email) that this has nothing to do with line 
breaking.  It is just that the default in 2.14.0 is keep.source=TRUE, 
whereas it was keep.source=FALSE in previous versions.  If you want the 
old behaviour, put

\SweaveOpts{keep.source=FALSE}

early in your .Rnw file.

Duncan Murdoch


From murdoch.duncan at gmail.com  Mon May  2 01:19:43 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 01 May 2011 19:19:43 -0400
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DBDBE4F.8020702@aon.at>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at>
Message-ID: <4DBDEA8F.60000@gmail.com>

On 11-05-01 4:10 PM, cstrato wrote:
> Dear Duncan, dear Uwe,
>
> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
> virtual machine, I have now done the following tests on all three
> architectures:
>
> 1, R CMD build xps:
> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
> pdf-file. Thus R CMD build is ok.
>
> 2, R CMD check xps:
> This does NOT build the vignettes as pdf-files on all three
> architectures. Or to be more precise, R-2.13.0 does no longer build the
> vignettes since with R-2.12.2 and earlier versions R did create the
> vignettes as pdf-files.
>
> Thus the question is:
> Why does R CMD check no longer create the vignettes?

Probably the answer is simply "because it doesn't".  For a truly 
reliable check, you should build the package, then check the tar.gz 
file.  Anything else is, and always has been, an approximation.

Duncan Murdoch


>
> Best regards
> Christian
>
>
> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>
>>
>> On 26.04.2011 21:58, cstrato wrote:
>>> Dear Duncan, dear Uwe,
>>>
>>> Just now I have re-run everything, and today xps.Rnw can be converted to
>>> a vignette w/o any problems using:
>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>>> b, R CMD Sweave xps.Rnw
>>>
>>> In both cases the vignette xps.pdf is created (maybe my Mac did not like
>>> to work during eastern holidays).
>>>
>>> However, one issue remains:
>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files for
>>> the vignettes.
>>
>>
>> Dioes it give an error or warning? It should check the code. R CMD build
>> creates the pdf files.
>>
>> Uwe Ligges
>>
>>>
>>> Best regards
>>> Christian
>>>
>>>
>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>> Thank you.
>>>>>
>>>>> My problem seems to be that at the moment the problem can be seen only
>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>> creating
>>>>> the vignettes.
>>>>
>>>> Then you are definitely the one in the best position to diagnose the
>>>> problem. Use the usual approach: simplify it by cutting out everything
>>>> that looks unrelated. Verify that the problem still exists, then cut
>>>> some more. Eventually you'll have isolated the error to a particular
>>>> small snippet of code, and then you can add print() statements, or use
>>>> trace(), or do whatever is necessary to see what's so special about your
>>>> system.
>>>>
>>>> I suspect it will turn out to be an assumption in the code that is not
>>>> true on your system.
>>>>
>>>> If the assumption is being made by code you wrote, then fix it. If it's
>>>> being made by R, let us know.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> Best regards
>>>>> Christian
>>>>>
>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>> cstrato wrote:
>>>>>>> Dear Duncan,
>>>>>>>
>>>>>>> Thank you for your example, however it is different since it does not
>>>>>>> use x and y. What about print(x+y)?
>>>>>>
>>>>>> Try it.
>>>>>>
>>>>>>>
>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>> R-2.12.2.
>>>>>>> 2, the identical code works in the examples
>>>>>>> 3, this code (or a similar code) is the starting code which all users
>>>>>>> of xps have to use, and there was never a problem.
>>>>>>
>>>>>> This might be a problem in R, or might be a problem in your code. As
>>>>>> far
>>>>>> as I know, it has only shown up in your code, so I'd guess that's
>>>>>> where
>>>>>> the problem is. In any case, you're the one in the best position to
>>>>>> isolate it and debug it.
>>>>>>
>>>>>> If it turns out to be a problem in R, put together an example
>>>>>> illustrating the problem that doesn't involve your code, and I'll
>>>>>> take a
>>>>>> look.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> Maybe the reason could be that my code has to import
>>>>>>> - the CEL-files from the package dir
>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>> ??
>>>>>>>
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>>
>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>> cstrato wrote:
>>>>>>>>> Dear Uwe,
>>>>>>>>>
>>>>>>>>> Your suggestion to look at the Sweave manual helped me to solve the
>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the code
>>>>>>>>> from
>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have this
>>>>>>>> in a
>>>>>>>> Sweave file:
>>>>>>>>
>>>>>>>> <<>>=
>>>>>>>> x<- 1
>>>>>>>> @
>>>>>>>>
>>>>>>>> <<>>=
>>>>>>>> y<- 2
>>>>>>>> @
>>>>>>>>
>>>>>>>> <<>>=
>>>>>>>> print(x)
>>>>>>>> @
>>>>>>>>
>>>>>>>> I will see the value of x getting printed, even though it came from
>>>>>>>> two
>>>>>>>> chunks earlier.
>>>>>>>>
>>>>>>>> I think Uwe is right: there is some bug in the code you're running.
>>>>>>>> Sweave isn't the problem.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>> Concretely, the following does not work since chunk 5 needs the
>>>>>>>>> code
>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>
>>>>>>>>> ###################################################
>>>>>>>>> ### chunk number 3:
>>>>>>>>> ###################################################
>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>
>>>>>>>>> ###################################################
>>>>>>>>> ### chunk number 4:
>>>>>>>>> ###################################################
>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>> "schemes",
>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>
>>>>>>>>> ###################################################
>>>>>>>>> ### chunk number 5:
>>>>>>>>> ###################################################
>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> However, when I add "celdir" to chunk 5 then everything works since
>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from chunk 3:
>>>>>>>>>
>>>>>>>>> ###################################################
>>>>>>>>> ### chunk number 5:
>>>>>>>>> ###################################################
>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Now buildVignettes() is able to create the vignettes, however R CMD
>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>
>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>
>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created which
>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex and
>>>>>>>>> xps.pdf.
>>>>>>>>>
>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory "inst/doc"
>>>>>>>>> and
>>>>>>>>> no vignettes are built.
>>>>>>>>>
>>>>>>>>> One more issue:
>>>>>>>>> In contrast to my former believe R CMD INSTALL does not build the
>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>
>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>
>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the collection of
>>>>>>>>>>>>> help
>>>>>>>>>>>>> pages,
>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files does
>>>>>>>>>>>>> work
>>>>>>>>>>>>> for
>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>
>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem since I
>>>>>>>>>>>>> see
>>>>>>>>>>>>> it on
>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>>> root is
>>>>>>>>>>>> a bit
>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>> No, until now I did not try another OS, but I will, since xps
>>>>>>>>>>> has to
>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>
>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>
>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the output of
>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with the
>>>>>>>>>>> same
>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>> supposed to
>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>> ...
>>>>>>>>>>>>> ...
>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>
>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>> ...
>>>>>>>>>>>>> ...
>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> I must admit that I have never built the vignettes manually,
>>>>>>>>>>>>> and I
>>>>>>>>>>>>> cannot find a hint how I can do it from the command line. Is
>>>>>>>>>>>>> this
>>>>>>>>>>>>> possible?
>>>>>>>>>>> Is it possible to build the vignettes from the command line?
>>>>>>>>>> R --help suggests there is
>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>> \output is
>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> can
>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work fine with
>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>> How objects generated in one chunk can be reused later on is
>>>>>>>>>>>> explained
>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following two
>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>
>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA", verbose=FALSE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> In summary it is not quite clear to me what has changed in
>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>
>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> can
>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>> definitively
>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied path.
>>>>>>>>>>>>
>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does not
>>>>>>>>>>> change
>>>>>>>>>>> the path, otherwise it would not work on all older versions of R.
>>>>>>>>>> Right, but since something changed obviously, and you tell us the
>>>>>>>>>> path
>>>>>>>>>> is not a path, it might be a function used by root.scheme ....
>>>>>>>>>> That's
>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>
>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the last
>>>>>>>>>>>>> two
>>>>>>>>>>>>> years
>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are able to
>>>>>>>>>>>>> build
>>>>>>>>>>>>> the
>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>> See
>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So maybe
>>>>>>>>>>>> it is
>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>>> independent
>>>>>>>>>>> machines?
>>>>>>>>>>>
>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>>> nothing
>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>
>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>
>>>>>>>>>> Uwe Ligges
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>>
>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>> Uwe
>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created the
>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer able to
>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK
>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>> build
>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>
>>>>>>
>>>>>>
>>>>
>>>>
>>


From jmc at r-project.org  Mon May  2 02:21:20 2011
From: jmc at r-project.org (John Chambers)
Date: Sun, 01 May 2011 17:21:20 -0700
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <4DBDE093.5080300@fhcrc.org>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>	<4DBDDA21.3020809@r-project.org>
	<4DBDE093.5080300@fhcrc.org>
Message-ID: <4DBDF900.1010601@r-project.org>

On 5/1/11 3:37 PM, Martin Morgan wrote:
> On 05/01/2011 03:09 PM, John Chambers wrote:
>> Yes, as presented on that site it makes a little more sense:
>>
>> "While experimenting with the new reference classes in R I noticed some
>> odd behaviour if you use the "[[ ]]" notation for methods
>> (X[["doSomething"]] instead of X$doSomething). This notation works for
>> fields, but I initially thought it wouldn't work for methods until I
>> found that if you execute "class(X$doSomething)" you can then use "[[
>> ]]" afterwards. The simple example below illustrates the point."
>>
>> For reference classes, "[[" is not meant to be used either for fields or
>> methods. That it "works" at all is an artifact of the implementation
>> using environments. And arguably the failure to throw an error in that
>> circumstance is a bug.
>>
>> Please use the API as described in the ?ReferenceClasses documentation.
>> These are encapsulated methods, in the usual terminology, with the
>> operator "$" playing the role normally assigned to "." in other
>> languages.
>>
>> A separate but related issue: It is possible to define S4 methods for
>> reference classes, as discussed in a previous thread, arguably also an
>> artifact in that a reference class is implemented as an S4 class of the
>> same name. These are functional methods, associated with a generic
>> function, and so outside the encapsulation paradigm.
>>
>> It would be interesting to get some experience and opinions on whether
>> this is a good idea or not. It breaks encapsulation, in that the
>> behavior of the class can no longer be inferred from the class
>> definition alone. On the other hand, it is convenient and relates to
>> "operator overloading" in some other languages.
>
> I have written 'show' methods for reference classes (is there another
> way to pretty-print them?) and S4 methods that dispatch to reference
> methods (in particular, yield(x) on connection-like classes dispatching
> to x$yield()). The latter partly to provide end-user familiarity
> (limiting need for the beleaguered user to have to learn yet another
> syntax for invoking methods, though maybe hiding hints about important
> differences in object behavior --

Just a comment on this point:

> I am dreading the introductory class
> where one tries to explain S3, S4, and reference classes)

Well, your "introductory" class sounds a bit advanced.  :-)

My feeling is actually anticipation more than dread.  The confusion over 
what "OOP" means in S and R has been a major hassle since S3 methods 
were introduced.  I think we have an opportunity now to clarify the 
discussion as well as introduce some useful new software and better 
inter-system interfaces.

Part of the motivation for the reference classes was to bring a general 
OOP view to R.  One can start from some essential concepts of objects 
and their properties, inheritance and class definition, as have evolved 
over a very long time.

Next, there is a fundamental choice of paradigm between "encapsulated" 
OOP as the rest of the world knows it, and "functional" OOP as practiced 
by S and R, and a few other languages.  While the two paradigms are 
quite different, there is no need to view them as opposed.  They provide 
different advantages and tend to suit different goals--very roughly, 
functional object creation and reproducible results versus persistent 
objects whose properties one would like to have evolve over time using 
their encapsulated methods.

As these remarks may suggest, I'm trying to write up this perspective in 
some detail.  To be continued ....

John

 > and partly to
 > provide a distinction between a 'developer' API and a user API (again
 > with questionable merits).
>
> Martin
>
>>
>> John
>>
>> On 4/30/11 7:54 PM, Hadley Wickham wrote:
>>> If this message is garbled for anyone else, the original question on
>>> stackoverflow is here:
>>> http://stackoverflow.com/questions/5841339/using-notation-for-reference-class-methods
>>>
>>>
>>>
>>> Hadley
>>>
>>> On Sat, Apr 30, 2011 at 11:35 AM, Chad
>>> Goymer<chad.goymer at hotmail.co.uk> wrote:
>>>>
>>>> I've been trying to use methods for reference classes via the
>>>> notation "[[...]]" (X[["doSomething"]] rather than X$doSomething),
>>>> but it failed to work. However, I did find that if you use the usual
>>>> "$" notation first, "[[...]]" can be used afterwards. The following
>>>> simple example illustrates the point:
>>>>> setRefClass("Number", + fields = list(+ value = "numeric"+ ),+
>>>>> methods = list(+ addOne = function() {+ value<<- value + 1+ }+ )+ )>
>>>>> X<- new("Number", value = 1)> X[["value"]][1] 1
>>>>> X[["addOne"]]()Error: attempt to apply non-function>
>>>>> class(X[["addOne"]]) # NULL[1] "NULL"
>>>>> class(X$addOne)[1] "refMethodDef"attr(,"package")[1] "methods"
>>>>> X[["addOne"]]()> X[["value"]][1] 2> class(X[["addOne"]])[1]
>>>>> "refMethodDef"attr(,"package")[1] "methods"
>>>> Is this a bug?
>>>> Chad Goymer
>>>>
>>>> [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From p.murrell at auckland.ac.nz  Mon May  2 05:00:10 2011
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Mon, 02 May 2011 15:00:10 +1200
Subject: [Rd] grid stringHeight
In-Reply-To: <BANLkTik0dL-oC8GzAqAJsNanZDF7LpndsA@mail.gmail.com>
References: <BANLkTik0dL-oC8GzAqAJsNanZDF7LpndsA@mail.gmail.com>
Message-ID: <4DBE1E3A.8010506@auckland.ac.nz>

Hi

This is a basic "feature" of both strheight() and stringHeight().  They 
both ignore any descenders in the text.  I cannot remember why it was 
done this way originally.  The future solution is probably to add an 
argument that allows descenders to be included in text height.

Plotmath works on bounding boxes so its behaviour is different, but of 
course that has its own problems because there is no sense of "baseline" 
for expressions.

Paul

On 27/04/2011 11:06 a.m., baptiste auguie wrote:
> Dear all,
>
> I'm puzzled by the behavior of stringHeight in the grid package.
> Consider the following test,
>
> library(grid)
>
> test<- function(lab="dog", ...){
>    g1<- textGrob(lab)
>    g2<- rectGrob(height=grobHeight(g1), width=grobWidth(g1))
>    gg<- gTree(children=gList(g1,g2), ...)
>
>    print(c("height:", convertUnit(stringHeight(lab), "mm", "y")))
>    grid.draw(gg)
> }
>
> grid.newpage()
> test()
> test(expression(dog), vp=viewport(x=0.6))
> ## notice how the dog's tail is being cut off, where
> ## expression yields a snug cage
>
> grid.newpage()
> test("aoc")
> test(expression(aoc), vp=viewport(x=0.6))
>
> It appears that stringHeight correctly calculates the height for an
> expression, but not for a basic string. I think it used to produce the
> same output for both.
>
> Best regards,
>
> baptiste
>
> sessionInfo()
> R version 2.13.0 alpha (2011-03-27 r55076)
> Platform: i386-apple-darwin9.8.0 (32-bit)
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  grid      methods
> [8] base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From ripley at stats.ox.ac.uk  Mon May  2 07:08:26 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 2 May 2011 06:08:26 +0100 (BST)
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DBDEA8F.60000@gmail.com>
References: <4DB32D9F.5010406@aon.at>
	<4DB42FB3.9090401@statistik.tu-dortmund.de>
	<4DB472F8.9060903@aon.at>
	<4DB489EC.9080301@statistik.tu-dortmund.de>
	<4DB491BE.8080104@aon.at>
	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com> <4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com> <4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com> <4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at> <4DBDEA8F.60000@gmail.com>
Message-ID: <alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>

On Sun, 1 May 2011, Duncan Murdoch wrote:

> On 11-05-01 4:10 PM, cstrato wrote:
>> Dear Duncan, dear Uwe,
>> 
>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>> virtual machine, I have now done the following tests on all three
>> architectures:
>> 
>> 1, R CMD build xps:
>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>> pdf-file. Thus R CMD build is ok.
>> 
>> 2, R CMD check xps:
>> This does NOT build the vignettes as pdf-files on all three
>> architectures. Or to be more precise, R-2.13.0 does no longer build the
>> vignettes since with R-2.12.2 and earlier versions R did create the
>> vignettes as pdf-files.
>> 
>> Thus the question is:
>> Why does R CMD check no longer create the vignettes?
>
> Probably the answer is simply "because it doesn't".  For a truly reliable 
> check, you should build the package, then check the tar.gz file.  Anything 
> else is, and always has been, an approximation.

Actually, it does.  What earlier versions never did (despite 
'cstrato's repeated delusional claims earlier) was to create the 
vignettes *in <pkg>inst/doc*.  All of them re-created (by default) 
vignettes in a working directory.  The difference is that 2.13.0 
deletes that working directory if the test was successful, whereas 
earlier versions left the results somewhere in <pkg>.Rcheck (the 
'somewhere' has varied). However, earier versions of R CMD check 
sometimes failed when R CMD build succeeded

Using Animal (a small CRAN package with one vignette).

R 2.12.2 gave

* checking package vignettes in ?inst/doc? ... WARNING
Package vignettes without corresponding PDF:
/tmp/Animal/inst/doc/Animal.Rnw

and the vignette was re-created in Animal.Rcheck/inst/doc.

R 2.13.0 gives

* checking package vignettes in ?inst/doc? ... WARNING
Package vignette(s) without corresponding PDF:
    Animal.Rnw

   Non-ASCII package vignette(s) without specified encoding:
    Animal.Rnw

* checking running R code from vignettes ... OK
* checking re-building of vignettes ... OK

and the working directory was Animal.Rcheck/vign_test .

The main reason for cleaning up is that to mimic R CMD build the 
test has to make a complete copy of the package sources, and that adds 
up: checking CRAN already takes 17GB for each flavour.


>
> Duncan Murdoch
>
>
>> 
>> Best regards
>> Christian
>> 
>> 
>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>> 
>>> 
>>> On 26.04.2011 21:58, cstrato wrote:
>>>> Dear Duncan, dear Uwe,
>>>> 
>>>> Just now I have re-run everything, and today xps.Rnw can be converted to
>>>> a vignette w/o any problems using:
>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>>>> b, R CMD Sweave xps.Rnw
>>>> 
>>>> In both cases the vignette xps.pdf is created (maybe my Mac did not like
>>>> to work during eastern holidays).
>>>> 
>>>> However, one issue remains:
>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files for
>>>> the vignettes.
>>> 
>>> 
>>> Dioes it give an error or warning? It should check the code. R CMD build
>>> creates the pdf files.
>>> 
>>> Uwe Ligges
>>> 
>>>> 
>>>> Best regards
>>>> Christian
>>>> 
>>>> 
>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>> Thank you.
>>>>>> 
>>>>>> My problem seems to be that at the moment the problem can be seen only
>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>> creating
>>>>>> the vignettes.
>>>>> 
>>>>> Then you are definitely the one in the best position to diagnose the
>>>>> problem. Use the usual approach: simplify it by cutting out everything
>>>>> that looks unrelated. Verify that the problem still exists, then cut
>>>>> some more. Eventually you'll have isolated the error to a particular
>>>>> small snippet of code, and then you can add print() statements, or use
>>>>> trace(), or do whatever is necessary to see what's so special about your
>>>>> system.
>>>>> 
>>>>> I suspect it will turn out to be an assumption in the code that is not
>>>>> true on your system.
>>>>> 
>>>>> If the assumption is being made by code you wrote, then fix it. If it's
>>>>> being made by R, let us know.
>>>>> 
>>>>> Duncan Murdoch
>>>>> 
>>>>>> 
>>>>>> Best regards
>>>>>> Christian
>>>>>> 
>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>> cstrato wrote:
>>>>>>>> Dear Duncan,
>>>>>>>> 
>>>>>>>> Thank you for your example, however it is different since it does not
>>>>>>>> use x and y. What about print(x+y)?
>>>>>>> 
>>>>>>> Try it.
>>>>>>> 
>>>>>>>> 
>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>> R-2.12.2.
>>>>>>>> 2, the identical code works in the examples
>>>>>>>> 3, this code (or a similar code) is the starting code which all users
>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>> 
>>>>>>> This might be a problem in R, or might be a problem in your code. As
>>>>>>> far
>>>>>>> as I know, it has only shown up in your code, so I'd guess that's
>>>>>>> where
>>>>>>> the problem is. In any case, you're the one in the best position to
>>>>>>> isolate it and debug it.
>>>>>>> 
>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>> illustrating the problem that doesn't involve your code, and I'll
>>>>>>> take a
>>>>>>> look.
>>>>>>> 
>>>>>>> Duncan Murdoch
>>>>>>> 
>>>>>>>> 
>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>> - the CEL-files from the package dir
>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>> ??
>>>>>>>> 
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>> 
>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>> cstrato wrote:
>>>>>>>>>> Dear Uwe,
>>>>>>>>>> 
>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to solve the
>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the code
>>>>>>>>>> from
>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have this
>>>>>>>>> in a
>>>>>>>>> Sweave file:
>>>>>>>>> 
>>>>>>>>> <<>>=
>>>>>>>>> x<- 1
>>>>>>>>> @
>>>>>>>>> 
>>>>>>>>> <<>>=
>>>>>>>>> y<- 2
>>>>>>>>> @
>>>>>>>>> 
>>>>>>>>> <<>>=
>>>>>>>>> print(x)
>>>>>>>>> @
>>>>>>>>> 
>>>>>>>>> I will see the value of x getting printed, even though it came from
>>>>>>>>> two
>>>>>>>>> chunks earlier.
>>>>>>>>> 
>>>>>>>>> I think Uwe is right: there is some bug in the code you're running.
>>>>>>>>> Sweave isn't the problem.
>>>>>>>>> 
>>>>>>>>> Duncan Murdoch
>>>>>>>>> 
>>>>>>>>>> Concretely, the following does not work since chunk 5 needs the
>>>>>>>>>> code
>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>> 
>>>>>>>>>> ###################################################
>>>>>>>>>> ### chunk number 3:
>>>>>>>>>> ###################################################
>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>> 
>>>>>>>>>> ###################################################
>>>>>>>>>> ### chunk number 4:
>>>>>>>>>> ###################################################
>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>> "schemes",
>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>> 
>>>>>>>>>> ###################################################
>>>>>>>>>> ### chunk number 5:
>>>>>>>>>> ###################################################
>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything works since
>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from chunk 3:
>>>>>>>>>> 
>>>>>>>>>> ###################################################
>>>>>>>>>> ### chunk number 5:
>>>>>>>>>> ###################################################
>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> Now buildVignettes() is able to create the vignettes, however R CMD
>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>> 
>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>> 
>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created which
>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex and
>>>>>>>>>> xps.pdf.
>>>>>>>>>> 
>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory "inst/doc"
>>>>>>>>>> and
>>>>>>>>>> no vignettes are built.
>>>>>>>>>> 
>>>>>>>>>> One more issue:
>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not build the
>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>> 
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>> 
>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the collection of
>>>>>>>>>>>>>> help
>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files does
>>>>>>>>>>>>>> work
>>>>>>>>>>>>>> for
>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem since I
>>>>>>>>>>>>>> see
>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>>>> root is
>>>>>>>>>>>>> a bit
>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>> No, until now I did not try another OS, but I will, since xps
>>>>>>>>>>>> has to
>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>> 
>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>> 
>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the output of
>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with the
>>>>>>>>>>>> same
>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> I must admit that I have never built the vignettes manually,
>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>> cannot find a hint how I can do it from the command line. Is
>>>>>>>>>>>>>> this
>>>>>>>>>>>>>> possible?
>>>>>>>>>>>> Is it possible to build the vignettes from the command line?
>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> can
>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work fine with
>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>> How objects generated in one chunk can be reused later on is
>>>>>>>>>>>>> explained
>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following two
>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA", verbose=FALSE)
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> In summary it is not quite clear to me what has changed in
>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> can
>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied path.
>>>>>>>>>>>>> 
>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does not
>>>>>>>>>>>> change
>>>>>>>>>>>> the path, otherwise it would not work on all older versions of R.
>>>>>>>>>>> Right, but since something changed obviously, and you tell us the
>>>>>>>>>>> path
>>>>>>>>>>> is not a path, it might be a function used by root.scheme ....
>>>>>>>>>>> That's
>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the last
>>>>>>>>>>>>>> two
>>>>>>>>>>>>>> years
>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are able to
>>>>>>>>>>>>>> build
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>> See
>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So maybe
>>>>>>>>>>>>> it is
>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>>>> independent
>>>>>>>>>>>> machines?
>>>>>>>>>>>> 
>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>>>> nothing
>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>> 
>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>> 
>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>> 
>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created the
>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer able to
>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK
>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>> 
>>>>> 
>>> 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From baptiste.auguie at googlemail.com  Mon May  2 08:08:11 2011
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Mon, 2 May 2011 18:08:11 +1200
Subject: [Rd] grid stringHeight
In-Reply-To: <4DBE1E3A.8010506@auckland.ac.nz>
References: <BANLkTik0dL-oC8GzAqAJsNanZDF7LpndsA@mail.gmail.com>
	<4DBE1E3A.8010506@auckland.ac.nz>
Message-ID: <BANLkTikAzqk3ZY_5=1qxDTE114h2zhKCuA@mail.gmail.com>

Hi,

I see, thanks. I incorrectly thought it used to produce the same
output in the past.
As a workaround I will wrap all strings in expression() before
evaluating the grobHeight; otherwise the calculated layout can clip
portions of the text.

Thanks,

baptiste

On 2 May 2011 15:00, Paul Murrell <p.murrell at auckland.ac.nz> wrote:
> Hi
>
> This is a basic "feature" of both strheight() and stringHeight(). ?They both
> ignore any descenders in the text. ?I cannot remember why it was done this
> way originally. ?The future solution is probably to add an argument that
> allows descenders to be included in text height.
>
> Plotmath works on bounding boxes so its behaviour is different, but of
> course that has its own problems because there is no sense of "baseline" for
> expressions.
>
> Paul
>
> On 27/04/2011 11:06 a.m., baptiste auguie wrote:
>>
>> Dear all,
>>
>> I'm puzzled by the behavior of stringHeight in the grid package.
>> Consider the following test,
>>
>> library(grid)
>>
>> test<- function(lab="dog", ...){
>> ? g1<- textGrob(lab)
>> ? g2<- rectGrob(height=grobHeight(g1), width=grobWidth(g1))
>> ? gg<- gTree(children=gList(g1,g2), ...)
>>
>> ? print(c("height:", convertUnit(stringHeight(lab), "mm", "y")))
>> ? grid.draw(gg)
>> }
>>
>> grid.newpage()
>> test()
>> test(expression(dog), vp=viewport(x=0.6))
>> ## notice how the dog's tail is being cut off, where
>> ## expression yields a snug cage
>>
>> grid.newpage()
>> test("aoc")
>> test(expression(aoc), vp=viewport(x=0.6))
>>
>> It appears that stringHeight correctly calculates the height for an
>> expression, but not for a basic string. I think it used to produce the
>> same output for both.
>>
>> Best regards,
>>
>> baptiste
>>
>> sessionInfo()
>> R version 2.13.0 alpha (2011-03-27 r55076)
>> Platform: i386-apple-darwin9.8.0 (32-bit)
>>
>> locale:
>> [1] C
>>
>> attached base packages:
>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?grid ? ? ?methods
>> [8] base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Dr Paul Murrell
> Department of Statistics
> The University of Auckland
> Private Bag 92019
> Auckland
> New Zealand
> 64 9 3737599 x85392
> paul at stat.auckland.ac.nz
> http://www.stat.auckland.ac.nz/~paul/
>


From hpages at fhcrc.org  Mon May  2 08:29:44 2011
From: hpages at fhcrc.org (=?windows-1252?Q?Herv=E9_Pag=E8s?=)
Date: Sun, 01 May 2011 23:29:44 -0700
Subject: [Rd] R CMD build processes inst/doc/Makefile only if there are
 vignette files?
In-Reply-To: <alpine.LFD.2.02.1104300630100.15222@gannet.stats.ox.ac.uk>
References: <BANLkTinYAyuKfHy74QKkqOBFfT3tiF8t5g@mail.gmail.com>
	<alpine.LFD.2.02.1103300946510.20705@gannet.stats.ox.ac.uk>
	<4DBB4191.80809@fhcrc.org>
	<alpine.LFD.2.02.1104300630100.15222@gannet.stats.ox.ac.uk>
Message-ID: <4DBE4F58.70801@fhcrc.org>

On 11-04-29 10:36 PM, Prof Brian Ripley wrote:
> On Fri, 29 Apr 2011, Herv? Pag?s wrote:
>
>> On 11-03-30 01:55 AM, Prof Brian Ripley wrote:
>>> What R CMD build (and check) does is to call tools::buildVignettes.
>>> That has been true for a while, and buildVignettes() returns if no
>>> vignettes are found. The docs are out-of-date.
>>>
>>> My view is that you are misusing inst/doc: it is intended *only* for
>>> files which are going to be installed and hence report.tex should not
>>> really be there. So you should be doing this in another source directory
>>> and copying report.pdf to inst/doc. Use configure to arrange this.
>>>
>>> Shortly vignettes to be built will be moved out of inst/doc.
>>
>> Could you please elaborate on this? I just found this in the NEWS for
>> R 2.14.0:
>>
>> o The preferred location for vignette sources is now the directory
>> ?vignettes? and not ?inst/doc?: R CMD build will now re-build
>> vignettes in ?vignettes? and copy the ?.Rnw? (etc) files and
>> the corresponding PDFs to ?inst/doc?.
>>
>> Sounds like an important move. What are the long term plans: keep
>> both inst/doc/ and vignettes/ as places for vignettes to be built?
>> Or drop inst/doc/ at some point?
>
> Drop inst/doc at some point.

May I ask when?

> It doesn't make much difference to the
> codebase: all the work is done in pkgVignettes().

Maybe but it will make a big difference from our side: about 450 BioC
packages will need to be modified.

Thanks,
H.


>
>>
>> Thanks!
>> H.
>>
>>
>>>
>>> On Tue, 29 Mar 2011, Henrik Bengtsson wrote:
>>>
>>>> Hi,
>>>>
>>>> in Section 'Writing package vignettes' of 'Writing R Extensions' it
>>>> says:
>>>>
>>>> "Whenever a Makefile is found, then R CMD build will try to run make
>>>> after the Sweave runs, so PDF manuals can be created from arbitrary
>>>> source formats (plain LaTeX files, ...). [...] Note that the make step
>>>> is executed even if there are no files in Sweave format, [...]".
>>>>
>>>> In my package, inst/doc/ file contains two files: Makefile, and
>>>> report.tex. However, when running 'Rcmd build' on Windows with R
>>>> v2.13.0 alpha (2011-03-27 r55091) I can only get 'make' to run
>>>> (process inst/doc/Makefile) if I add a inst/doc/dummy.Rnw file,
>>>> otherwise nothing happens. My Makefile contains:
>>>>
>>>> all: pdf
>>>>
>>>> pdf: report.tex
>>>> texi2dvi --pdf report.tex
>>>>
>>>> clean:
>>>> rm dummy.Rnw dummy.tex
>>>> rm *.aux *.log *.toc
>>>>
>>>> Is it really necessary to add dummy.Rnw? Am I missing something?
>>>>
>>>> /Henrik
>>>>
>>>>> sessionInfo()
>>>> R version 2.13.0 alpha (2011-03-27 r55091)
>>>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>>>
>>>> locale:
>>>> [1] LC_COLLATE=English_United States.1252
>>>> [2] LC_CTYPE=English_United States.1252
>>>> [3] LC_MONETARY=English_United States.1252
>>>> [4] LC_NUMERIC=C
>>>> [5] LC_TIME=English_United States.1252
>>>>
>>>> attached base packages:
>>>> [1] stats graphics grDevices utils datasets methods base
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] tools_2.13.0
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>
>>
>> --
>> Herv? Pag?s
>>
>> Program in Computational Biology
>> Division of Public Health Sciences
>> Fred Hutchinson Cancer Research Center
>> 1100 Fairview Ave. N, M2-B876
>> P.O. Box 19024
>> Seattle, WA 98109-1024
>>
>> E-mail: hpages at fhcrc.org
>> Phone: (206) 667-5791
>> Fax: (206) 667-1319
>>
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hadley at rice.edu  Mon May  2 15:53:45 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 2 May 2011 08:53:45 -0500
Subject: [Rd] Using substitute to access the expression related to a promise
Message-ID: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>

Hi all,

The help for delayedAssign suggests that you can use substitute to
access the expression associated with a promise, and the help for
substitute says: "If it is a promise object, i.e., a formal argument
to a function or explicitly created using ?delayedAssign()?, the
expression slot of the promise replaces the symbol.

But this doesn't seem to work:

> a <- 1
> b <- 2
> delayedAssign("x", {message("assigning..."); a + b})
> substitute(x)
x
> x
[1] 3

Is this a bug in substitute?

> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
...

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From murdoch.duncan at gmail.com  Mon May  2 16:10:26 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 02 May 2011 10:10:26 -0400
Subject: [Rd] Using substitute to access the expression related to a
	promise
In-Reply-To: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>
References: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>
Message-ID: <4DBEBB52.7050508@gmail.com>

On 02/05/2011 9:53 AM, Hadley Wickham wrote:
> Hi all,
>
> The help for delayedAssign suggests that you can use substitute to
> access the expression associated with a promise, and the help for
> substitute says: "If it is a promise object, i.e., a formal argument
> to a function or explicitly created using ?delayedAssign()?, the
> expression slot of the promise replaces the symbol.
>
> But this doesn't seem to work:
>
> >  a<- 1
> >  b<- 2
> >  delayedAssign("x", {message("assigning..."); a + b})
> >  substitute(x)
> x
> >  x
> [1] 3
>
> Is this a bug in substitute?
>

I think it is a design flaw rather than a bug:  the global environment 
is handled specially.  If you put those lines into a function you'll see 
different behaviour.  I think if you really carefully read the 
documentation you'll find it says this.

I suggested regularizing this several years ago, but there were worries 
that it would break some common usage.

Duncan Murdoch

> >  sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
> ...
>
> Hadley
>


From ggrothendieck at gmail.com  Mon May  2 16:10:54 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 2 May 2011 10:10:54 -0400
Subject: [Rd] Using substitute to access the expression related to a
	promise
In-Reply-To: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>
References: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>
Message-ID: <BANLkTi=HEXL28FhAKadD2zz63jdk7mVyaw@mail.gmail.com>

On Mon, May 2, 2011 at 9:53 AM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> The help for delayedAssign suggests that you can use substitute to
> access the expression associated with a promise, and the help for
> substitute says: "If it is a promise object, i.e., a formal argument
> to a function or explicitly created using ?delayedAssign()?, the
> expression slot of the promise replaces the symbol.
>
> But this doesn't seem to work:
>
>> a <- 1
>> b <- 2
>> delayedAssign("x", {message("assigning..."); a + b})
>> substitute(x)
> x
>> x
> [1] 3
>
> Is this a bug in substitute?
>
>> sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

It works differently if the assign environment is the global
environment or not.  This is actually mentioned on the help page for
substitute though its precise meaning may not be completely clear from
the wording.

Try this:

> e <- new.env()
> delayedAssign("x", {message("assigning..."); a + b},, e)
> substitute(x, e)
{
    message("assigning...")
    a + b
}



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ggrothendieck at gmail.com  Mon May  2 16:18:56 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 2 May 2011 10:18:56 -0400
Subject: [Rd] Using substitute to access the expression related to a
	promise
In-Reply-To: <4DBEBB52.7050508@gmail.com>
References: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>
	<4DBEBB52.7050508@gmail.com>
Message-ID: <BANLkTinNdY5ED4hUeweGOTw43TFW3DO5Xw@mail.gmail.com>

On Mon, May 2, 2011 at 10:10 AM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 02/05/2011 9:53 AM, Hadley Wickham wrote:
>>
>> Hi all,
>>
>> The help for delayedAssign suggests that you can use substitute to
>> access the expression associated with a promise, and the help for
>> substitute says: "If it is a promise object, i.e., a formal argument
>> to a function or explicitly created using ?delayedAssign()?, the
>> expression slot of the promise replaces the symbol.
>>
>> But this doesn't seem to work:
>>
>> > ?a<- 1
>> > ?b<- 2
>> > ?delayedAssign("x", {message("assigning..."); a + b})
>> > ?substitute(x)
>> x
>> > ?x
>> [1] 3
>>
>> Is this a bug in substitute?
>>
>
> I think it is a design flaw rather than a bug: ?the global environment is
> handled specially. ?If you put those lines into a function you'll see
> different behaviour. ?I think if you really carefully read the documentation
> you'll find it says this.
>
> I suggested regularizing this several years ago, but there were worries that
> it would break some common usage.
>
> Duncan Murdoch

Perhaps an argument could be added to indicate whether the global
environment was treated specially or not.  If it defaulted to the
current behavior it would still be backwardly compatible.

The other limitation that I have come across here is the asymmetry of
being able to extract the data of the promise but not the environment.
 Being able to copy a promise without evaluating it is another
operation that would be nice.   Currently one can only do these two
things at the C level.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From hadley at rice.edu  Mon May  2 16:34:28 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 2 May 2011 09:34:28 -0500
Subject: [Rd] Using substitute to access the expression related to a
	promise
In-Reply-To: <4DBEBB52.7050508@gmail.com>
References: <BANLkTi=PARrZvyvDJsH4x8GDCY7kLHm+=w@mail.gmail.com>
	<4DBEBB52.7050508@gmail.com>
Message-ID: <BANLkTimcELni6NJAoKYOj5WbqC7rx5VmtQ@mail.gmail.com>

On Mon, May 2, 2011 at 9:10 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 02/05/2011 9:53 AM, Hadley Wickham wrote:
>>
>> Hi all,
>>
>> The help for delayedAssign suggests that you can use substitute to
>> access the expression associated with a promise, and the help for
>> substitute says: "If it is a promise object, i.e., a formal argument
>> to a function or explicitly created using ?delayedAssign()?, the
>> expression slot of the promise replaces the symbol.
>>
>> But this doesn't seem to work:
>>
>> > ?a<- 1
>> > ?b<- 2
>> > ?delayedAssign("x", {message("assigning..."); a + b})
>> > ?substitute(x)
>> x
>> > ?x
>> [1] 3
>>
>> Is this a bug in substitute?
>>
>
> I think it is a design flaw rather than a bug: ?the global environment is
> handled specially. ?If you put those lines into a function you'll see
> different behaviour. ?I think if you really carefully read the documentation
> you'll find it says this.

I guess you mean this sentence: "If it is an ordinary variable, its
value is substituted, unless ?env? is ?.GlobalEnv? in which case the
symbol is left unchanged."  But I think the conditioning is confusing,
because it implies that this condition only comes into play if x is an
ordinary variable, which is not the case in my example.

Hadley



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Mon May  2 16:40:28 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 2 May 2011 09:40:28 -0500
Subject: [Rd] write.csv and match.call
Message-ID: <BANLkTikPN-vqbtTocJyqQzNCxcF=D3Kg9w@mail.gmail.com>

Hi all,

Can help me understand why write.csv manipulates a call object instead
of simply calling write.table with modified arguments? I would have
written write.csv as:

write.csv <- function (...) {
    Call <- match.call(expand.dots = TRUE)
    for (argname in c("append", "col.names", "sep", "dec", "qmethod")) {
      if (!is.null(Call[[argname]]))
        warning(gettextf("attempt to set '%s' ignored", argname),
            domain = NA)

    write.table(..., sep = ",", dec = ".", qmethod = "double")
}

The current approach breaks partial argument matching for row.names:

write.csv(mtcars, "mtcars-1.csv", row = F)
write.table(mtcars, "mtcars-2.txt", row = F)
write.csv(mtcars, "mtcars-2.csv", row.names = F)

What's the advantage of manipulating the call?

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From therneau at mayo.edu  Mon May  2 17:47:47 2011
From: therneau at mayo.edu (Terry Therneau)
Date: Mon, 02 May 2011 10:47:47 -0500
Subject: [Rd] R 2.13 segfault with range()
Message-ID: <1304351267.24611.4.camel@nemo>

Running on a shared CENTOS server

tmt711% R --vanilla

R version 2.13.0 (2011-04-13)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C              
 [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods
base     
> load('test.rda')
> y <- matrix(ifelse(tdata$dataset<=0, NA, tdata$dataset), 
+             ncol=ncol(tdata$dataset))
> dim(y)
[1] 22283    35
> range(y)

 *** caught segfault ***
address 0x2b490421f000, cause 'memory not mapped'

Traceback:
 1: range(y)

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 3

tmt712% ls -s test.rda
2664 test.rda

---------------------------------------------------------
  
  The data set is too large to attach, but I can send the test.rda file
off list.  The data is not confidential.

Terry Therneau


From janko.thyson.rstuff at googlemail.com  Mon May  2 18:03:27 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Mon, 02 May 2011 18:03:27 +0200
Subject: [Rd] Replacing '.self' with an .Rda image of '.self' from within a
	method?
Message-ID: <4DBED5CF.8030605@googlemail.com>

Dear list,

Is it possible to update or reassign '.self' with an image of '.self' 
(e.g. a locally stored .Rda file) from within a method?

I know that this might sound akward, but here's the use case:
1) Ref Class Definition
     setRefClass(Class="Test",
         fields=list(A="character", B="character"),
         methods=list(importImage=function(path){
             variable <- load(path)
             expr <- paste("assign('", variable, "',", variable, ", 
envir=.self)", sep="")
             eval(parse(text=expr))
         }
     )
2) Initialize Method Definition
     setMethod(
         f="initialize",
         signature=signature(.Object="Test"),
         definition=function(
             .Object,
             path=NULL
     ){
         obj <- callNextMethod(.Object)
         if(!is.null(path){
             obj$importImage(path=path)
         }
         return(obj)
     }
3) Intended and "Extended" Use
     Method 'importImage' was originally intended to read either an 
object of name 'A' or 'B' from a respective path and overwrite the 
respective fields in an obj of class 'Test'.
     Now I wondered how I could "reassign"/update the object of class 
'Test' itself by reading a respective .Rda image of an object of class 
'Test' from within 'obj$importImage()'.
     The way I've written 'importImage()', it did not work. Yet I wonder 
if it's possible.
4) My Workaround (but I'm looking for something more elegantly)
     In the class definition:
     [...]
     methods=list(importImage=function(path){
             variable <- load(path)
             if(variable != ".self"){
                 expr <- paste("assign('", variable, "',", variable, ", 
envir=.self)", sep="")
                 eval(parse(text=expr))
                 return(TRUE)
             } else {
                 return(.self)
             }
     })
     [...]

     In the initialize method:
     setMethod(
         f="initialize",
         signature=signature(.Object="Test"),
         definition=function(
             .Object,
             path=NULL
     ){
         obj <- callNextMethod(.Object)
         if(!is.null(path){
             rslt <- obj$importImage(path=path)
             if(!is.logical(rslt)){
                 obj <- rslt
             }
         }
         return(obj)
     }

Thanks for any comments,
Janko


From wdunlap at tibco.com  Mon May  2 20:13:25 2011
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 2 May 2011 11:13:25 -0700
Subject: [Rd] raw connections: reading does not alter current position
	pointer
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700042B926D@NA-PA-VBE03.na.tibco.com>

Am I misunderstanding rawConnections here or are
rawConnections not working right yet?  It looks
like I can use seek() to position the read pointer
but readBin does not position the read pointer past
what has just been read.

  > myRawTen <- as.raw(101:110)
  > str(myRawTen)
   raw [1:10] 65 66 67 68 ...
  > rawToChar(myRawTen)
  [1] "efghijklmn"
  > myRawTenCon <- rawConnection(myRawTen)
  > readBin(myRawTenCon, what="integer", size=2, n=1)
  [1] 26213
  > c(26213%%256, 26213%/%256)
  [1] 101 102
  > # next 2-byte integer should be 104*256 + 103 = 26727
  > readBin(myRawTenCon, what="integer", size=2, n=1)
  [1] 26213
  > # if I seek() explicitly it works
  > seek(myRawTenCon, 2)
  [1] 6
  > readBin(myRawTenCon, what="integer", size=2, n=1)
  [1] 26727
  
  > seek(myRawTenCon, 6) # look at last 4 bytes: 107:110
  [1] 0
  > # multiple reads in one call to readBin do not advance
  > # the position pointer:
  > readBin(myRawTenCon, what="integer", size=1, n=4)
  [1] 107 107 107 107

  > sessionInfo()
  R version 2.13.0 (2011-04-13)
  Platform: i386-pc-mingw32/i386 (32-bit)

  locale:
  [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252    LC_MONETARY=English_United States.1252
  [4] LC_NUMERIC=C                           LC_TIME=English_United
States.1252    

  attached base packages:
  [1] stats     graphics  grDevices utils     datasets  methods   base


  other attached packages:
  [1] lattice_0.19-23 MASS_7.3-12    

  loaded via a namespace (and not attached):
  [1] compiler_2.13.0 grid_2.13.0     tools_2.13.0   

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 


From chuck at sharpsteen.net  Mon May  2 20:32:58 2011
From: chuck at sharpsteen.net (Sharpie)
Date: Mon, 2 May 2011 11:32:58 -0700 (PDT)
Subject: [Rd] Source for bash_completion.d/R?
Message-ID: <1304361178399-3490662.post@n4.nabble.com>

Hello, I was just tweaking the R build for the Homebrew package manager and I
thought it would be nice to enable bash completion. I noticed that
Debian-based systems install `/etc/bash_completion.d/R` but could not find a
source for this file in the `etc` folder of the R source.

Is the R bash completion script publicly available somewhere so that it
could be pulled in by curl?

-----
Charlie Sharpsteen
Undergraduate-- Environmental Resources Engineering
Humboldt State University
--
View this message in context: http://r.789695.n4.nabble.com/Source-for-bash-completion-d-R-tp3490662p3490662.html
Sent from the R devel mailing list archive at Nabble.com.


From hpages at fhcrc.org  Mon May  2 20:55:08 2011
From: hpages at fhcrc.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Mon, 02 May 2011 11:55:08 -0700
Subject: [Rd] R CMD check and Suggests Packages
In-Reply-To: <20110429120016.BLP71069@gimr.garvan.unsw.edu.au>
References: <20110429120016.BLP71069@gimr.garvan.unsw.edu.au>
Message-ID: <4DBEFE0C.9090801@fhcrc.org>

Hi,

On 11-04-28 07:00 PM, Dario Strbenac wrote:
> Hello,
>
> In my description file, I have an example data package in Suggests: that I've deleted from my library to test what the user who doesn't have it will experience.
>
> However, R CMD check won't even pass my package :
>
> * checking package dependencies ... ERROR
> Package required but not available: RepitoolsExamples
           ^^^^^^^^
          confusing!

Wouldn't a message like

   Package required for full checking but not available: RepitoolsExamples

be more appropriate and avoid a confusion that we've seen
for a very long time now?

Just me 2 cents...

Cheers,
H.

>
> Why would it have to be installed, if it's only a data package, that isn't needed in any of my code ? The manual also says "In particular, large packages providing ?only? data for examples or vignettes should be listed in ?Suggests? rather than ?Depends? in order to make lean installations possible."
>
> --------------------------------------
> Dario Strbenac
> Research Assistant
> Cancer Epigenetics
> Garvan Institute of Medical Research
> Darlinghurst NSW 2010
> Australia
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hadley at rice.edu  Mon May  2 21:21:00 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 2 May 2011 14:21:00 -0500
Subject: [Rd] Capturing the expression representing the body of a function
Message-ID: <BANLkTikv5z7c-mUoNoDDsJA-_aNLWr_f+g@mail.gmail.com>

Hi all,

What's the preferred way of capturing the expression representing the
contents of a function?

* body(write.csv) gives me a braced expression
* body(write.csv)[-1] gives me a mangled call
* as.list(body(write.csv)[-1]) gives me a list of calls
* as.expression(as.list(body(write.csv)[-1])) is what I want but seems
like too much work

Any suggestions?

Thanks,

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From cstrato at aon.at  Mon May  2 21:24:20 2011
From: cstrato at aon.at (cstrato)
Date: Mon, 02 May 2011 21:24:20 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
References: <4DB32D9F.5010406@aon.at>
	<4DB42FB3.9090401@statistik.tu-dortmund.de>
	<4DB472F8.9060903@aon.at>
	<4DB489EC.9080301@statistik.tu-dortmund.de>
	<4DB491BE.8080104@aon.at>
	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at> <4DBDEA8F.60000@gmail.com>
	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
Message-ID: <4DBF04E4.8020806@aon.at>

Dear Prof. Ripley,

Thank you for your confirmation and explanation, I understand the reason 
for cleaning things up to save memory. However, it was very convenient 
to have this feature in earlier versions of R. It would be really 
helpful to have an additional option to R CMD check, e.g. 
"--no-clean-vignettes".

FYI, I did not claim "..create the vignettes *in <pkg>inst/doc*", 
instead my words were:
One interesting observation is that xps.Rcheck from R-2.12.2 contains 
the subdirectory "inst/doc" with the vignettes while xps.Rcheck from 
R-2.13.0 does not contain "inst".

Best regards
Christian
_._._._._._._._._._._._._._._._._._
C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
V.i.e.n.n.a           A.u.s.t.r.i.a
e.m.a.i.l:        cstrato at aon.at
_._._._._._._._._._._._._._._._._._


On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
> On Sun, 1 May 2011, Duncan Murdoch wrote:
>
>> On 11-05-01 4:10 PM, cstrato wrote:
>>> Dear Duncan, dear Uwe,
>>>
>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>> virtual machine, I have now done the following tests on all three
>>> architectures:
>>>
>>> 1, R CMD build xps:
>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>> pdf-file. Thus R CMD build is ok.
>>>
>>> 2, R CMD check xps:
>>> This does NOT build the vignettes as pdf-files on all three
>>> architectures. Or to be more precise, R-2.13.0 does no longer build the
>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>> vignettes as pdf-files.
>>>
>>> Thus the question is:
>>> Why does R CMD check no longer create the vignettes?
>>
>> Probably the answer is simply "because it doesn't". For a truly
>> reliable check, you should build the package, then check the tar.gz
>> file. Anything else is, and always has been, an approximation.
>
> Actually, it does. What earlier versions never did (despite 'cstrato's
> repeated delusional claims earlier) was to create the vignettes *in
> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
> working directory. The difference is that 2.13.0 deletes that working
> directory if the test was successful, whereas earlier versions left the
> results somewhere in <pkg>.Rcheck (the 'somewhere' has varied). However,
> earier versions of R CMD check sometimes failed when R CMD build succeeded
>
> Using Animal (a small CRAN package with one vignette).
>
> R 2.12.2 gave
>
> * checking package vignettes in ?inst/doc? ... WARNING
> Package vignettes without corresponding PDF:
> /tmp/Animal/inst/doc/Animal.Rnw
>
> and the vignette was re-created in Animal.Rcheck/inst/doc.
>
> R 2.13.0 gives
>
> * checking package vignettes in ?inst/doc? ... WARNING
> Package vignette(s) without corresponding PDF:
> Animal.Rnw
>
> Non-ASCII package vignette(s) without specified encoding:
> Animal.Rnw
>
> * checking running R code from vignettes ... OK
> * checking re-building of vignettes ... OK
>
> and the working directory was Animal.Rcheck/vign_test .
>
> The main reason for cleaning up is that to mimic R CMD build the test
> has to make a complete copy of the package sources, and that adds up:
> checking CRAN already takes 17GB for each flavour.
>
>
>>
>> Duncan Murdoch
>>
>>
>>>
>>> Best regards
>>> Christian
>>>
>>>
>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>
>>>>
>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>> Dear Duncan, dear Uwe,
>>>>>
>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>> converted to
>>>>> a vignette w/o any problems using:
>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>>>>> b, R CMD Sweave xps.Rnw
>>>>>
>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did not
>>>>> like
>>>>> to work during eastern holidays).
>>>>>
>>>>> However, one issue remains:
>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files for
>>>>> the vignettes.
>>>>
>>>>
>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>> build
>>>> creates the pdf files.
>>>>
>>>> Uwe Ligges
>>>>
>>>>>
>>>>> Best regards
>>>>> Christian
>>>>>
>>>>>
>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>> Thank you.
>>>>>>>
>>>>>>> My problem seems to be that at the moment the problem can be seen
>>>>>>> only
>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>> creating
>>>>>>> the vignettes.
>>>>>>
>>>>>> Then you are definitely the one in the best position to diagnose the
>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>> everything
>>>>>> that looks unrelated. Verify that the problem still exists, then cut
>>>>>> some more. Eventually you'll have isolated the error to a particular
>>>>>> small snippet of code, and then you can add print() statements, or
>>>>>> use
>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>> about your
>>>>>> system.
>>>>>>
>>>>>> I suspect it will turn out to be an assumption in the code that is
>>>>>> not
>>>>>> true on your system.
>>>>>>
>>>>>> If the assumption is being made by code you wrote, then fix it. If
>>>>>> it's
>>>>>> being made by R, let us know.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>>
>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>> cstrato wrote:
>>>>>>>>> Dear Duncan,
>>>>>>>>>
>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>> does not
>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>
>>>>>>>> Try it.
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>> R-2.12.2.
>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>> 3, this code (or a similar code) is the starting code which all
>>>>>>>>> users
>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>
>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>> code. As
>>>>>>>> far
>>>>>>>> as I know, it has only shown up in your code, so I'd guess that's
>>>>>>>> where
>>>>>>>> the problem is. In any case, you're the one in the best position to
>>>>>>>> isolate it and debug it.
>>>>>>>>
>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>> illustrating the problem that doesn't involve your code, and I'll
>>>>>>>> take a
>>>>>>>> look.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>> ??
>>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>>
>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>> cstrato wrote:
>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>
>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>> solve the
>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the code
>>>>>>>>>>> from
>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have
>>>>>>>>>> this
>>>>>>>>>> in a
>>>>>>>>>> Sweave file:
>>>>>>>>>>
>>>>>>>>>> <<>>=
>>>>>>>>>> x<- 1
>>>>>>>>>> @
>>>>>>>>>>
>>>>>>>>>> <<>>=
>>>>>>>>>> y<- 2
>>>>>>>>>> @
>>>>>>>>>>
>>>>>>>>>> <<>>=
>>>>>>>>>> print(x)
>>>>>>>>>> @
>>>>>>>>>>
>>>>>>>>>> I will see the value of x getting printed, even though it came
>>>>>>>>>> from
>>>>>>>>>> two
>>>>>>>>>> chunks earlier.
>>>>>>>>>>
>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>> running.
>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs the
>>>>>>>>>>> code
>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>
>>>>>>>>>>> ###################################################
>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>> ###################################################
>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>
>>>>>>>>>>> ###################################################
>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>> ###################################################
>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>> "schemes",
>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>
>>>>>>>>>>> ###################################################
>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>> ###################################################
>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything works
>>>>>>>>>>> since
>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>> chunk 3:
>>>>>>>>>>>
>>>>>>>>>>> ###################################################
>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>> ###################################################
>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Now buildVignettes() is able to create the vignettes, however
>>>>>>>>>>> R CMD
>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>
>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>
>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>
>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created
>>>>>>>>>>> which
>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex and
>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>
>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>> "inst/doc"
>>>>>>>>>>> and
>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>
>>>>>>>>>>> One more issue:
>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not build
>>>>>>>>>>> the
>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the collection of
>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since xps
>>>>>>>>>>>>> has to
>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>
>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>> output of
>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with
>>>>>>>>>>>>> the
>>>>>>>>>>>>> same
>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> I must admit that I have never built the vignettes manually,
>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command line. Is
>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>> Is it possible to build the vignettes from the command line?
>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>> How objects generated in one chunk can be reused later on is
>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following
>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA", verbose=FALSE)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> In summary it is not quite clear to me what has changed in
>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>
>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does not
>>>>>>>>>>>>> change
>>>>>>>>>>>>> the path, otherwise it would not work on all older versions
>>>>>>>>>>>>> of R.
>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>> us the
>>>>>>>>>>>> path
>>>>>>>>>>>> is not a path, it might be a function used by root.scheme ....
>>>>>>>>>>>> That's
>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>> See
>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>>>>> independent
>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>
>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>>>>> nothing
>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>
>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>
>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK
>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>
>>>>>>
>>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From murdoch.duncan at gmail.com  Mon May  2 22:11:21 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 02 May 2011 16:11:21 -0400
Subject: [Rd] Capturing the expression representing the body of a
	function
In-Reply-To: <BANLkTikv5z7c-mUoNoDDsJA-_aNLWr_f+g@mail.gmail.com>
References: <BANLkTikv5z7c-mUoNoDDsJA-_aNLWr_f+g@mail.gmail.com>
Message-ID: <4DBF0FE9.9010605@gmail.com>

On 02/05/2011 3:21 PM, Hadley Wickham wrote:
> Hi all,
>
> What's the preferred way of capturing the expression representing the
> contents of a function?
>
> * body(write.csv) gives me a braced expression
> * body(write.csv)[-1] gives me a mangled call
> * as.list(body(write.csv)[-1]) gives me a list of calls
> * as.expression(as.list(body(write.csv)[-1])) is what I want but seems
> like too much work
>
> Any suggestions?

The body of a function isn't an expression, it's a language object.  A 
language object is represented internally as a pairlist, while an 
expression is represented as a generic vector, i.e. the thing that 
list() gives.

Your 1st try gives you the language object.

The other ones only work when the body consists of a call to `{`, as the 
body of most complex functions does, but not for simple ones like

f <- function(x) 2*x

So I would say your question should be:  "What's the best way to 
construct an expression vector s.t. evaluating its elements in order is 
like evaluating the body of a function?"

And the answer to that is something like

body2expr <- function(f) {
   body <- body(f)
   if (typeof(body) == "language" && identical(body[[1]], quote(`{`))) 
as.expression(as.list(body[-1]))
   else as.expression(body)
}

Duncan Murdoch


From ggrothendieck at gmail.com  Mon May  2 23:16:02 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 2 May 2011 17:16:02 -0400
Subject: [Rd] Capturing the expression representing the body of a
	function
In-Reply-To: <4DBF0FE9.9010605@gmail.com>
References: <BANLkTikv5z7c-mUoNoDDsJA-_aNLWr_f+g@mail.gmail.com>
	<4DBF0FE9.9010605@gmail.com>
Message-ID: <BANLkTikGUKPBQvAsBkj+Z5cvpahzZnMxNQ@mail.gmail.com>

On Mon, May 2, 2011 at 4:11 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 02/05/2011 3:21 PM, Hadley Wickham wrote:
>>
>> Hi all,
>>
>> What's the preferred way of capturing the expression representing the
>> contents of a function?
>>
>> * body(write.csv) gives me a braced expression
>> * body(write.csv)[-1] gives me a mangled call
>> * as.list(body(write.csv)[-1]) gives me a list of calls
>> * as.expression(as.list(body(write.csv)[-1])) is what I want but seems
>> like too much work
>>
>> Any suggestions?
>
> The body of a function isn't an expression, it's a language object. ?A
> language object is represented internally as a pairlist, while an expression
> is represented as a generic vector, i.e. the thing that list() gives.
>
> Your 1st try gives you the language object.
>
> The other ones only work when the body consists of a call to `{`, as the
> body of most complex functions does, but not for simple ones like
>
> f <- function(x) 2*x
>
> So I would say your question should be: ?"What's the best way to construct
> an expression vector s.t. evaluating its elements in order is like
> evaluating the body of a function?"
>
> And the answer to that is something like
>
> body2expr <- function(f) {
> ?body <- body(f)
> ?if (typeof(body) == "language" && identical(body[[1]], quote(`{`)))
> as.expression(as.list(body[-1]))
> ?else as.expression(body)
> }
>


Also try as.expression(as.list(f)[[3]])

e.g.

> f <- function(x, y) { x + y }
> as.expression(as.list(f)[[3]])
expression({
    x + y
})
> g <- function(x, y) x + y
> as.expression(as.list(g)[[3]])
expression(x + y)




-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From hadley at rice.edu  Tue May  3 00:19:06 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Mon, 2 May 2011 17:19:06 -0500
Subject: [Rd] Capturing the expression representing the body of a
	function
In-Reply-To: <4DBF0FE9.9010605@gmail.com>
References: <BANLkTikv5z7c-mUoNoDDsJA-_aNLWr_f+g@mail.gmail.com>
	<4DBF0FE9.9010605@gmail.com>
Message-ID: <BANLkTimqhbW-iAbPy_2zR+kep-9qhAY3kg@mail.gmail.com>

> The body of a function isn't an expression, it's a language object. ?A
> language object is represented internally as a pairlist, while an expression
> is represented as a generic vector, i.e. the thing that list() gives.

That doesn't agree with the documentation of is.language which implies
a language object is "a ?name?, a ?call?, or an ?expression?", and
doesn't mention pairlist anywhere.

> Your 1st try gives you the language object.

It gives me a call, doesn't it?  And the documentation for body
implies that this special type of call is called a bracketed
expression (despite it not being an expression as defined in the
documentation for expression)

(I don't mean to be nit-picky, I'm just trying to understand what's going on)

> So I would say your question should be: ?"What's the best way to construct
> an expression vector s.t. evaluating its elements in order is like
> evaluating the body of a function?"
>
> And the answer to that is something like
>
> body2expr <- function(f) {
> ?body <- body(f)
> ?if (typeof(body) == "language" && identical(body[[1]], quote(`{`)))
> as.expression(as.list(body[-1]))
> ?else as.expression(body)
> }

Ok, thanks.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From edd at debian.org  Tue May  3 01:10:04 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 2 May 2011 18:10:04 -0500
Subject: [Rd] Source for bash_completion.d/R?
In-Reply-To: <1304361178399-3490662.post@n4.nabble.com>
References: <1304361178399-3490662.post@n4.nabble.com>
Message-ID: <19903.14796.109103.402299@max.nulle.part>


On 2 May 2011 at 11:32, Sharpie wrote:
| Hello, I was just tweaking the R build for the Homebrew package manager and I
| thought it would be nice to enable bash completion. I noticed that
| Debian-based systems install `/etc/bash_completion.d/R` but could not find a
| source for this file in the `etc` folder of the R source.

Right. This started off via a suggestion by Deepayan and a quick install via
a local-to-Debian-package-sources file, and has never moved away from that.

I am CCing Deepayan now; it may indeed be useful to commit this in the R svn
and to add it to the tarball as the feature is very, very useful if you
deplay bash completion.
 
Dirk

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com


From deepayan.sarkar at r-project.org  Tue May  3 08:49:50 2011
From: deepayan.sarkar at r-project.org (Deepayan Sarkar)
Date: Tue, 3 May 2011 12:19:50 +0530
Subject: [Rd] Source for bash_completion.d/R?
In-Reply-To: <19903.14796.109103.402299@max.nulle.part>
References: <1304361178399-3490662.post@n4.nabble.com>
	<19903.14796.109103.402299@max.nulle.part>
Message-ID: <BANLkTik2zh_o=8J7D9ACQsUJC8__nh0Vmw@mail.gmail.com>

On Tue, May 3, 2011 at 4:40 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 2 May 2011 at 11:32, Sharpie wrote:
> | Hello, I was just tweaking the R build for the Homebrew package manager and I
> | thought it would be nice to enable bash completion. I noticed that
> | Debian-based systems install `/etc/bash_completion.d/R` but could not find a
> | source for this file in the `etc` folder of the R source.
>
> Right. This started off via a suggestion by Deepayan and a quick install via
> a local-to-Debian-package-sources file, and has never moved away from that.
>
> I am CCing Deepayan now; it may indeed be useful to commit this in the R svn
> and to add it to the tarball as the feature is very, very useful if you
> deplay bash completion.

I vaguely remember a discussion on r-core where the consensus was that
this was too shell-specific to belong in the R sources.

It has been publicly available (for a long time) at

http://code.google.com/p/rcompletion/source/browse/trunk/bash_completion/R

(could use a little work now).

-Deepayan


>
> Dirk
>
> --
> Gauss once played himself in a zero-sum game and won $50.
> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com
>
>


From maechler at stat.math.ethz.ch  Tue May  3 09:43:58 2011
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 3 May 2011 09:43:58 +0200
Subject: [Rd] R CMD check and Suggests Packages
In-Reply-To: <4DBEFE0C.9090801@fhcrc.org>
References: <20110429120016.BLP71069@gimr.garvan.unsw.edu.au>
	<4DBEFE0C.9090801@fhcrc.org>
Message-ID: <19903.45630.406037.262781@stat.math.ethz.ch>

>>>>> Herv? Pag?s <hpages at fhcrc.org>
>>>>>     on Mon, 02 May 2011 11:55:08 -0700 writes:

    > Hi, On 11-04-28 07:00 PM, Dario Strbenac wrote:
    >> Hello,
    >> 
    >> In my description file, I have an example data package in
    >> Suggests: that I've deleted from my library to test what
    >> the user who doesn't have it will experience.
    >> 
    >> However, R CMD check won't even pass my package :
    >> 
    >> * checking package dependencies ... ERROR 
    >> Package required but not available: RepitoolsExamples
    >          ^^^^^^^^ confusing!

    > Wouldn't a message like

    >    Package required for full checking but not available:
    > RepitoolsExamples

    > be more appropriate and avoid a confusion that we've seen
    > for a very long time now?

Sure.  But such messages are already produced in current
versions of R, .. at least they are there in the package checking
source, see 
	format.check_package_depends()  in  
	src/library/tools/R/QC.R  
which has e.g.,

      if(length(bad <- x$suggests_but_not_installed) > 1L) {
          c(gettext("Packages suggested but not available for checking:"),
	 ....

and similar for 'Enhances' in lieu of 'Suggests'.

If Dario really uses R 2.13.0 (or newer),
and he gets the above error message for a package that is not
required but only suggested,
I think we'd need a clear, ideally simple,
reproducible example, here.

Martin


From favorov at sensi.org  Tue May  3 03:09:21 2011
From: favorov at sensi.org (Alexander Favorov)
Date: Mon, 02 May 2011 21:09:21 -0400
Subject: [Rd] Bug report: R 2.14.0dev Sweave option width does not work
In-Reply-To: <4DBDE9F6.5060606@gmail.com>
References: <4DBC9A54.9080707@sensi.org> <4DBD4595.8070005@gmail.com>
	<4DBDE9F6.5060606@gmail.com>
Message-ID: <4DBF55C1.3070102@sensi.org>

Thank you! It works.

On 01.05.2011 19:17, Duncan Murdoch wrote:
> On 11-05-01 7:35 AM, Duncan Murdoch wrote:
>> On 30/04/11 7:25 PM, Alexander Favorov wrote:
>>> Hi!
>>>
>>> In R 2.14.0dev (R version 2.14.0 Under development (unstable)
>>> (2011-04-29 r55692), Windows release
>>> (http://cran.r-project.org/bin/windows/base/rdevel.html), the line :
>>>
>>> options(width=55)
>>>
>>> in code chunk of an Rnw file has no effect on sweave's output text file.
>>>
>>> The same thing in 2.13.0 worked.
>>>
>>
>> What effect do you expect? That would only have an effect if
>> - the option value was different before that line, and
>> - you printed something that would differ in the two widths.
>>
>> Please put together an example to illustrate what problem you're seeing.
>>
>> Duncan Murdoch
>>
>
> Turned out (from a private email) that this has nothing to do with line
> breaking. It is just that the default in 2.14.0 is keep.source=TRUE,
> whereas it was keep.source=FALSE in previous versions. If you want the
> old behaviour, put
>
> \SweaveOpts{keep.source=FALSE}
>
> early in your .Rnw file.
>
> Duncan Murdoch


From rje42 at uw.edu  Tue May  3 01:59:52 2011
From: rje42 at uw.edu (Robin Evans)
Date: Mon, 2 May 2011 16:59:52 -0700
Subject: [Rd] Location of Internal Code
Message-ID: <BANLkTi=-quho_Wb0wVphqqxiEyyCJb430w@mail.gmail.com>

Hello,

This seems like a fairly elementary question, but I couldn't seem to
find the answer anywhere online.

Where can I find code which is called with .Internal? ?Specifically,
the R function colSums() calls an internal function with the same name
(I presume a C function), and I'd like to see how it works.

I've searched through the header files in R-2.x.x/include/ (Windows
version), but to no avail.

Thanks,

Robin

-- 
Robin Evans
Statistics Department
University of Washington
www.stat.washington.edu/~rje42


From andreas.borg at unimedizin-mainz.de  Tue May  3 12:35:54 2011
From: andreas.borg at unimedizin-mainz.de (Andreas Borg)
Date: Tue, 03 May 2011 12:35:54 +0200
Subject: [Rd] [R] Sweave stops when opening X11 device fails
Message-ID: <4DBFDA8A.3020901@unimedizin-mainz.de>

Hi all,

I am posting this again because I got no reply on r-help. Maybe the 
devel-list is the right place for this kind of question.

I've run into the following problem with Sweave: I frequently run Sweave
from a xterm console within an X session owned by a different user, i.e.
my colleague is logged in on this computer and I do "su" with my
username and start R and Sweave afterwards. Now, when Sweave comes to a
figure chunk, it sees that there is an X server running and tries to
show whatever I plot in that chunk on the screen, additionally to
writing a pdf file. The problem is that I am not logged into the X
session myself, and the script fails with a message saying someting like
"could not open device X11" (I have German messages, so I do not know
what the exact phrase would be in English). When I log in with putty,
where there is no X11 at all, everything works fine. Is there a way to
prevent Sweave from failing in the former case? Would this even account
as a bug? I think it would be nice if the script just kept on running
without plotting on the screen if opening X11 fails, just like it does
when no X11 is available at all.

Best regards,

Andreas

p.s.: I would be willing to dig in the code and look for a fix myself, 
but it would be great if anyone could give a hint where to look. I 
suspect "RweaveDriverRuncode" is the right place, but in what namespace 
is it?

-- 
Andreas Borg
Medizinische Informatik

UNIVERSIT?TSMEDIZIN
der Johannes Gutenberg-Universit?t
Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
Obere Zahlbacher Stra?e 69, 55131 Mainz
www.imbei.uni-mainz.de

Telefon +49 (0) 6131 175062
E-Mail: borg at imbei.uni-mainz.de

Diese E-Mail enth?lt vertrauliche und/oder rechtlich gesch?tzte 
Informationen. Wenn Sie nicht der
richtige Adressat sind oder diese E-Mail irrt?mlich erhalten haben, 
informieren Sie bitte sofort den
Absender und l?schen Sie diese Mail. Das unerlaubte Kopieren sowie die 
unbefugte Weitergabe
dieser Mail und der darin enthaltenen Informationen ist nicht gestattet.

______________________________________________
R-help at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From ligges at statistik.tu-dortmund.de  Tue May  3 13:07:50 2011
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 03 May 2011 13:07:50 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DBF04E4.8020806@aon.at>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
Message-ID: <4DBFE206.3030708@statistik.tu-dortmund.de>



On 02.05.2011 21:24, cstrato wrote:
> Dear Prof. Ripley,
>
> Thank you for your confirmation and explanation, I understand the reason
> for cleaning things up to save memory. However, it was very convenient
> to have this feature in earlier versions of R. It would be really
> helpful to have an additional option to R CMD check, e.g.
> "--no-clean-vignettes".
>
> FYI, I did not claim "..create the vignettes *in <pkg>inst/doc*",
> instead my words were:
> One interesting observation is that xps.Rcheck from R-2.12.2 contains
> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
> R-2.13.0 does not contain "inst".


But you do not need it. I do not know how often I have to mention that 
vignettes are produced by R CMD build! They are already build when 
running R CMD check. And please do not tell us about tzhe PDF version 
oif manuals which are *unrelated* to vignettes, because they are not 
built in advance and need to be checked, since they should be produced 
at user level while vignettes are built at developer level already.

Uwe Ligges


> Best regards
> Christian
> _._._._._._._._._._._._._._._._._._
> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
> V.i.e.n.n.a A.u.s.t.r.i.a
> e.m.a.i.l: cstrato at aon.at
> _._._._._._._._._._._._._._._._._._
>
>
> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>
>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>> Dear Duncan, dear Uwe,
>>>>
>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>> virtual machine, I have now done the following tests on all three
>>>> architectures:
>>>>
>>>> 1, R CMD build xps:
>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>> pdf-file. Thus R CMD build is ok.
>>>>
>>>> 2, R CMD check xps:
>>>> This does NOT build the vignettes as pdf-files on all three
>>>> architectures. Or to be more precise, R-2.13.0 does no longer build the
>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>> vignettes as pdf-files.
>>>>
>>>> Thus the question is:
>>>> Why does R CMD check no longer create the vignettes?
>>>
>>> Probably the answer is simply "because it doesn't". For a truly
>>> reliable check, you should build the package, then check the tar.gz
>>> file. Anything else is, and always has been, an approximation.
>>
>> Actually, it does. What earlier versions never did (despite 'cstrato's
>> repeated delusional claims earlier) was to create the vignettes *in
>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>> working directory. The difference is that 2.13.0 deletes that working
>> directory if the test was successful, whereas earlier versions left the
>> results somewhere in <pkg>.Rcheck (the 'somewhere' has varied). However,
>> earier versions of R CMD check sometimes failed when R CMD build
>> succeeded
>>
>> Using Animal (a small CRAN package with one vignette).
>>
>> R 2.12.2 gave
>>
>> * checking package vignettes in ?inst/doc? ... WARNING
>> Package vignettes without corresponding PDF:
>> /tmp/Animal/inst/doc/Animal.Rnw
>>
>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>
>> R 2.13.0 gives
>>
>> * checking package vignettes in ?inst/doc? ... WARNING
>> Package vignette(s) without corresponding PDF:
>> Animal.Rnw
>>
>> Non-ASCII package vignette(s) without specified encoding:
>> Animal.Rnw
>>
>> * checking running R code from vignettes ... OK
>> * checking re-building of vignettes ... OK
>>
>> and the working directory was Animal.Rcheck/vign_test .
>>
>> The main reason for cleaning up is that to mimic R CMD build the test
>> has to make a complete copy of the package sources, and that adds up:
>> checking CRAN already takes 17GB for each flavour.
>>
>>
>>>
>>> Duncan Murdoch
>>>
>>>
>>>>
>>>> Best regards
>>>> Christian
>>>>
>>>>
>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>
>>>>>
>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>> Dear Duncan, dear Uwe,
>>>>>>
>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>> converted to
>>>>>> a vignette w/o any problems using:
>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>
>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did not
>>>>>> like
>>>>>> to work during eastern holidays).
>>>>>>
>>>>>> However, one issue remains:
>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files for
>>>>>> the vignettes.
>>>>>
>>>>>
>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>> build
>>>>> creates the pdf files.
>>>>>
>>>>> Uwe Ligges
>>>>>
>>>>>>
>>>>>> Best regards
>>>>>> Christian
>>>>>>
>>>>>>
>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>> Thank you.
>>>>>>>>
>>>>>>>> My problem seems to be that at the moment the problem can be seen
>>>>>>>> only
>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>> creating
>>>>>>>> the vignettes.
>>>>>>>
>>>>>>> Then you are definitely the one in the best position to diagnose the
>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>> everything
>>>>>>> that looks unrelated. Verify that the problem still exists, then cut
>>>>>>> some more. Eventually you'll have isolated the error to a particular
>>>>>>> small snippet of code, and then you can add print() statements, or
>>>>>>> use
>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>> about your
>>>>>>> system.
>>>>>>>
>>>>>>> I suspect it will turn out to be an assumption in the code that is
>>>>>>> not
>>>>>>> true on your system.
>>>>>>>
>>>>>>> If the assumption is being made by code you wrote, then fix it. If
>>>>>>> it's
>>>>>>> being made by R, let us know.
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>>
>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>> cstrato wrote:
>>>>>>>>>> Dear Duncan,
>>>>>>>>>>
>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>> does not
>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>
>>>>>>>>> Try it.
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>> R-2.12.2.
>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>> 3, this code (or a similar code) is the starting code which all
>>>>>>>>>> users
>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>
>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>> code. As
>>>>>>>>> far
>>>>>>>>> as I know, it has only shown up in your code, so I'd guess that's
>>>>>>>>> where
>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>> position to
>>>>>>>>> isolate it and debug it.
>>>>>>>>>
>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>> illustrating the problem that doesn't involve your code, and I'll
>>>>>>>>> take a
>>>>>>>>> look.
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>> ??
>>>>>>>>>>
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>>
>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>
>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>> solve the
>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the code
>>>>>>>>>>>> from
>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have
>>>>>>>>>>> this
>>>>>>>>>>> in a
>>>>>>>>>>> Sweave file:
>>>>>>>>>>>
>>>>>>>>>>> <<>>=
>>>>>>>>>>> x<- 1
>>>>>>>>>>> @
>>>>>>>>>>>
>>>>>>>>>>> <<>>=
>>>>>>>>>>> y<- 2
>>>>>>>>>>> @
>>>>>>>>>>>
>>>>>>>>>>> <<>>=
>>>>>>>>>>> print(x)
>>>>>>>>>>> @
>>>>>>>>>>>
>>>>>>>>>>> I will see the value of x getting printed, even though it came
>>>>>>>>>>> from
>>>>>>>>>>> two
>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>
>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>> running.
>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>
>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>
>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs the
>>>>>>>>>>>> code
>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>> "schemes",
>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything works
>>>>>>>>>>>> since
>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>> ###################################################
>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes, however
>>>>>>>>>>>> R CMD
>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>
>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created
>>>>>>>>>>>> which
>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>> and
>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>
>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>> and
>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>
>>>>>>>>>>>> One more issue:
>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not build
>>>>>>>>>>>> the
>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since xps
>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> same
>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>> Is it possible to build the vignettes from the command line?
>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later on is
>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following
>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA", verbose=FALSE)
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has changed in
>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>> not
>>>>>>>>>>>>>> change
>>>>>>>>>>>>>> the path, otherwise it would not work on all older versions
>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>> us the
>>>>>>>>>>>>> path
>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme ....
>>>>>>>>>>>>> That's
>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK
>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Tue May  3 13:10:22 2011
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 03 May 2011 13:10:22 +0200
Subject: [Rd] Location of Internal Code
In-Reply-To: <BANLkTi=-quho_Wb0wVphqqxiEyyCJb430w@mail.gmail.com>
References: <BANLkTi=-quho_Wb0wVphqqxiEyyCJb430w@mail.gmail.com>
Message-ID: <4DBFE29E.10100@statistik.tu-dortmund.de>



On 03.05.2011 01:59, Robin Evans wrote:
> Hello,
>
> This seems like a fairly elementary question, but I couldn't seem to
> find the answer anywhere online.
>
> Where can I find code which is called with .Internal?  Specifically,
> the R function colSums() calls an internal function with the same name
> (I presume a C function), and I'd like to see how it works.
>
> I've searched through the header files in R-2.x.x/include/ (Windows
> version), but to no avail.

They are only used for external function to be able to link against R.

For .Internal() (for example), see ./src/main/names.c and the names they 
refer to (also in other files in ./src/main)

Uwe Ligges


>
> Thanks,
>
> Robin
>


From PDalgd at gmail.com  Tue May  3 13:19:58 2011
From: PDalgd at gmail.com (peter dalgaard)
Date: Tue, 3 May 2011 13:19:58 +0200
Subject: [Rd] [R] Sweave stops when opening X11 device fails
In-Reply-To: <4DBFDA8A.3020901@unimedizin-mainz.de>
References: <4DBFDA8A.3020901@unimedizin-mainz.de>
Message-ID: <63D70846-DC0E-44B7-83E9-6EC494E0BCEE@gmail.com>


On May 3, 2011, at 12:35 , Andreas Borg wrote:

> Hi all,
> 
> I am posting this again because I got no reply on r-help. Maybe the devel-list is the right place for this kind of question.

Actually, not an R problem at all, but try one of these...

1) get rid of the DISPLAY environment variable before starting R 

2) replace the su command with ssh -Y localhost to get the X server tunneled properly.

3) xhost +localhost  (may be a security liability)


-pd 

> 
> I've run into the following problem with Sweave: I frequently run Sweave
> from a xterm console within an X session owned by a different user, i.e.
> my colleague is logged in on this computer and I do "su" with my
> username and start R and Sweave afterwards. Now, when Sweave comes to a
> figure chunk, it sees that there is an X server running and tries to
> show whatever I plot in that chunk on the screen, additionally to
> writing a pdf file. The problem is that I am not logged into the X
> session myself, and the script fails with a message saying someting like
> "could not open device X11" (I have German messages, so I do not know
> what the exact phrase would be in English). When I log in with putty,
> where there is no X11 at all, everything works fine. Is there a way to
> prevent Sweave from failing in the former case? Would this even account
> as a bug? I think it would be nice if the script just kept on running
> without plotting on the screen if opening X11 fails, just like it does
> when no X11 is available at all.
> 
> Best regards,
> 
> Andreas
> 
> p.s.: I would be willing to dig in the code and look for a fix myself, but it would be great if anyone could give a hint where to look. I suspect "RweaveDriverRuncode" is the right place, but in what namespace is it?
> 
> -- 
> Andreas Borg
> Medizinische Informatik
> 
> UNIVERSIT?TSMEDIZIN
> der Johannes Gutenberg-Universit?t
> Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
> Obere Zahlbacher Stra?e 69, 55131 Mainz
> www.imbei.uni-mainz.de
> 
> Telefon +49 (0) 6131 175062
> E-Mail: borg at imbei.uni-mainz.de
> 
> Diese E-Mail enth?lt vertrauliche und/oder rechtlich gesch?tzte Informationen. Wenn Sie nicht der
> richtige Adressat sind oder diese E-Mail irrt?mlich erhalten haben, informieren Sie bitte sofort den
> Absender und l?schen Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe
> dieser Mail und der darin enthaltenen Informationen ist nicht gestattet.
> 
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From valentin.todorov at chello.at  Tue May  3 13:12:44 2011
From: valentin.todorov at chello.at (Valentin Todorov)
Date: Tue, 3 May 2011 13:12:44 +0200
Subject: [Rd] R CMD build - will reset the timestamps of all files in a
	package
Message-ID: <BANLkTimC_Mb3FaseNavHqWmrJ3hSKnACkA@mail.gmail.com>

Dear developers,

I wonder why (R version 2.13.0 and after) the command "R CMD build"
sets the timestamp of all files in the package to the current
date/time. This seems not to be mentioned in the list of changes. Is
there an option to avoid this?

Best regards,
Valentin


From edd at debian.org  Tue May  3 13:32:08 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 3 May 2011 06:32:08 -0500
Subject: [Rd] [R] Sweave stops when opening X11 device fails
In-Reply-To: <63D70846-DC0E-44B7-83E9-6EC494E0BCEE@gmail.com>
References: <4DBFDA8A.3020901@unimedizin-mainz.de>
	<63D70846-DC0E-44B7-83E9-6EC494E0BCEE@gmail.com>
Message-ID: <19903.59320.416101.414134@max.nulle.part>


On 3 May 2011 at 13:19, peter dalgaard wrote:
| 
| On May 3, 2011, at 12:35 , Andreas Borg wrote:
| 
| > Hi all,
| > 
| > I am posting this again because I got no reply on r-help. Maybe the devel-list is the right place for this kind of question.
| 
| Actually, not an R problem at all, but try one of these...
| 
| 1) get rid of the DISPLAY environment variable before starting R 
| 
| 2) replace the su command with ssh -Y localhost to get the X server tunneled properly.
| 
| 3) xhost +localhost  (may be a security liability)

4) If available, use the 'xvfb-run' frontend to simulate X11 in a virtual
   framebuffer. That is how the Debian packages build when a given package
   requires X11 at init or load time (here's looking at you, tcltk).

   This can be as simple as

       xvfb-run R CMD Sweave someFile.Rnw

   Debian / Ubuntu have xvfb-run available in a package 'xvfb', I suspect
   other distros do to.

Dirk 

| -pd 
| 
| > 
| > I've run into the following problem with Sweave: I frequently run Sweave
| > from a xterm console within an X session owned by a different user, i.e.
| > my colleague is logged in on this computer and I do "su" with my
| > username and start R and Sweave afterwards. Now, when Sweave comes to a
| > figure chunk, it sees that there is an X server running and tries to
| > show whatever I plot in that chunk on the screen, additionally to
| > writing a pdf file. The problem is that I am not logged into the X
| > session myself, and the script fails with a message saying someting like
| > "could not open device X11" (I have German messages, so I do not know
| > what the exact phrase would be in English). When I log in with putty,
| > where there is no X11 at all, everything works fine. Is there a way to
| > prevent Sweave from failing in the former case? Would this even account
| > as a bug? I think it would be nice if the script just kept on running
| > without plotting on the screen if opening X11 fails, just like it does
| > when no X11 is available at all.
| > 
| > Best regards,
| > 
| > Andreas
| > 
| > p.s.: I would be willing to dig in the code and look for a fix myself, but it would be great if anyone could give a hint where to look. I suspect "RweaveDriverRuncode" is the right place, but in what namespace is it?
| > 
| > -- 
| > Andreas Borg
| > Medizinische Informatik
| > 
| > UNIVERSIT?TSMEDIZIN
| > der Johannes Gutenberg-Universit?t
| > Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
| > Obere Zahlbacher Stra?e 69, 55131 Mainz
| > www.imbei.uni-mainz.de
| > 
| > Telefon +49 (0) 6131 175062
| > E-Mail: borg at imbei.uni-mainz.de
| > 
| > Diese E-Mail enth?lt vertrauliche und/oder rechtlich gesch?tzte Informationen. Wenn Sie nicht der
| > richtige Adressat sind oder diese E-Mail irrt?mlich erhalten haben, informieren Sie bitte sofort den
| > Absender und l?schen Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe
| > dieser Mail und der darin enthaltenen Informationen ist nicht gestattet.
| > 
| > ______________________________________________
| > R-help at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-help
| > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
| > and provide commented, minimal, self-contained, reproducible code.
| > 
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| 
| -- 
| Peter Dalgaard
| Center for Statistics, Copenhagen Business School
| Solbjerg Plads 3, 2000 Frederiksberg, Denmark
| Phone: (+45)38153501
| Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com


From geoffjentry at hexdump.org  Tue May  3 20:55:47 2011
From: geoffjentry at hexdump.org (Geoff Jentry)
Date: Tue, 3 May 2011 11:55:47 -0700 (PDT)
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <4DBDE093.5080300@fhcrc.org>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org> <4DBDE093.5080300@fhcrc.org>
Message-ID: <Pine.LNX.4.64.1105031153350.3175@cardinals.dreamhost.com>

On Sun, 1 May 2011, Martin Morgan wrote:
> On 05/01/2011 03:09 PM, John Chambers wrote:
>> It would be interesting to get some experience and opinions on whether
>> this is a good idea or not. It breaks encapsulation, in that the
>> behavior of the class can no longer be inferred from the class
>> definition alone. On the other hand, it is convenient and relates to
>> "operator overloading" in some other languages.
> I have written 'show' methods for reference classes (is there another way to 
> pretty-print them?) and S4 methods that dispatch to reference methods (in 
> particular, yield(x) on connection-like classes dispatching to x$yield()).

Most of my S4 method usage with reference classes has been the 'show' 
methods for the same reason that Martin states - I was unable to find 
another mechanism of pretty printing, and wanted something along those 
lines for situations such as a list of objects and how that gets rendered 
on the screen.

I've also made use of S4 methods for reference classes to help maintain 
backwards compatibility for cases where I've changed the underlying 
implementation from S4 to using reference classes - in those cases the 
ability to use S4 methods was handy but not strictly necessary.


From cstrato at aon.at  Tue May  3 21:14:47 2011
From: cstrato at aon.at (cstrato)
Date: Tue, 03 May 2011 21:14:47 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DBFE206.3030708@statistik.tu-dortmund.de>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
Message-ID: <4DC05427.7060908@aon.at>

Dear Uwe,

This is my development cycle:

First, I run R CMD check until there are no more warnings/errors. Since 
years it was very convenient that R CMD check builds the pdf-files of 
the vignettes, too, since this allowed me to correct errors in the 
manual files and the vignette files at the same time!

Afterwards I run R CMD INSTALL to install my package and do more tests 
until everything works.

As you see I do not use R CMD build, since every run takes about 5 
minutes, it overwrites my zipped source code, and I would need to unzip 
it to get access to the vignette pdf-files.

Best regards
Christian


On 5/3/11 1:07 PM, Uwe Ligges wrote:
>
>
> On 02.05.2011 21:24, cstrato wrote:
>> Dear Prof. Ripley,
>>
>> Thank you for your confirmation and explanation, I understand the reason
>> for cleaning things up to save memory. However, it was very convenient
>> to have this feature in earlier versions of R. It would be really
>> helpful to have an additional option to R CMD check, e.g.
>> "--no-clean-vignettes".
>>
>> FYI, I did not claim "..create the vignettes *in <pkg>inst/doc*",
>> instead my words were:
>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>> R-2.13.0 does not contain "inst".
>
>
> But you do not need it. I do not know how often I have to mention that
> vignettes are produced by R CMD build! They are already build when
> running R CMD check. And please do not tell us about tzhe PDF version
> oif manuals which are *unrelated* to vignettes, because they are not
> built in advance and need to be checked, since they should be produced
> at user level while vignettes are built at developer level already.
>
> Uwe Ligges
>
>
>> Best regards
>> Christian
>> _._._._._._._._._._._._._._._._._._
>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>> V.i.e.n.n.a A.u.s.t.r.i.a
>> e.m.a.i.l: cstrato at aon.at
>> _._._._._._._._._._._._._._._._._._
>>
>>
>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>
>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>> Dear Duncan, dear Uwe,
>>>>>
>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>> virtual machine, I have now done the following tests on all three
>>>>> architectures:
>>>>>
>>>>> 1, R CMD build xps:
>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>> pdf-file. Thus R CMD build is ok.
>>>>>
>>>>> 2, R CMD check xps:
>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>> the
>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>> vignettes as pdf-files.
>>>>>
>>>>> Thus the question is:
>>>>> Why does R CMD check no longer create the vignettes?
>>>>
>>>> Probably the answer is simply "because it doesn't". For a truly
>>>> reliable check, you should build the package, then check the tar.gz
>>>> file. Anything else is, and always has been, an approximation.
>>>
>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>> repeated delusional claims earlier) was to create the vignettes *in
>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>> working directory. The difference is that 2.13.0 deletes that working
>>> directory if the test was successful, whereas earlier versions left the
>>> results somewhere in <pkg>.Rcheck (the 'somewhere' has varied). However,
>>> earier versions of R CMD check sometimes failed when R CMD build
>>> succeeded
>>>
>>> Using Animal (a small CRAN package with one vignette).
>>>
>>> R 2.12.2 gave
>>>
>>> * checking package vignettes in ?inst/doc? ... WARNING
>>> Package vignettes without corresponding PDF:
>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>
>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>
>>> R 2.13.0 gives
>>>
>>> * checking package vignettes in ?inst/doc? ... WARNING
>>> Package vignette(s) without corresponding PDF:
>>> Animal.Rnw
>>>
>>> Non-ASCII package vignette(s) without specified encoding:
>>> Animal.Rnw
>>>
>>> * checking running R code from vignettes ... OK
>>> * checking re-building of vignettes ... OK
>>>
>>> and the working directory was Animal.Rcheck/vign_test .
>>>
>>> The main reason for cleaning up is that to mimic R CMD build the test
>>> has to make a complete copy of the package sources, and that adds up:
>>> checking CRAN already takes 17GB for each flavour.
>>>
>>>
>>>>
>>>> Duncan Murdoch
>>>>
>>>>
>>>>>
>>>>> Best regards
>>>>> Christian
>>>>>
>>>>>
>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>
>>>>>>
>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>
>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>> converted to
>>>>>>> a vignette w/o any problems using:
>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>
>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did not
>>>>>>> like
>>>>>>> to work during eastern holidays).
>>>>>>>
>>>>>>> However, one issue remains:
>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>> for
>>>>>>> the vignettes.
>>>>>>
>>>>>>
>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>> build
>>>>>> creates the pdf files.
>>>>>>
>>>>>> Uwe Ligges
>>>>>>
>>>>>>>
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>>
>>>>>>>
>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>> Thank you.
>>>>>>>>>
>>>>>>>>> My problem seems to be that at the moment the problem can be seen
>>>>>>>>> only
>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>> creating
>>>>>>>>> the vignettes.
>>>>>>>>
>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>> the
>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>> everything
>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>> cut
>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>> particular
>>>>>>>> small snippet of code, and then you can add print() statements, or
>>>>>>>> use
>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>> about your
>>>>>>>> system.
>>>>>>>>
>>>>>>>> I suspect it will turn out to be an assumption in the code that is
>>>>>>>> not
>>>>>>>> true on your system.
>>>>>>>>
>>>>>>>> If the assumption is being made by code you wrote, then fix it. If
>>>>>>>> it's
>>>>>>>> being made by R, let us know.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>>
>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>> cstrato wrote:
>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>
>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>> does not
>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>
>>>>>>>>>> Try it.
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>> 3, this code (or a similar code) is the starting code which all
>>>>>>>>>>> users
>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>
>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>> code. As
>>>>>>>>>> far
>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess that's
>>>>>>>>>> where
>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>> position to
>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>
>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>> illustrating the problem that doesn't involve your code, and I'll
>>>>>>>>>> take a
>>>>>>>>>> look.
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>> ??
>>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>>
>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>> solve the
>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>> code
>>>>>>>>>>>>> from
>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have
>>>>>>>>>>>> this
>>>>>>>>>>>> in a
>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>
>>>>>>>>>>>> <<>>=
>>>>>>>>>>>> x<- 1
>>>>>>>>>>>> @
>>>>>>>>>>>>
>>>>>>>>>>>> <<>>=
>>>>>>>>>>>> y<- 2
>>>>>>>>>>>> @
>>>>>>>>>>>>
>>>>>>>>>>>> <<>>=
>>>>>>>>>>>> print(x)
>>>>>>>>>>>> @
>>>>>>>>>>>>
>>>>>>>>>>>> I will see the value of x getting printed, even though it came
>>>>>>>>>>>> from
>>>>>>>>>>>> two
>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>
>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>> running.
>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>
>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>
>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>> the
>>>>>>>>>>>>> code
>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything works
>>>>>>>>>>>>> since
>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes, however
>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>
>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created
>>>>>>>>>>>>> which
>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>> and
>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>
>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>> and
>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>
>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not build
>>>>>>>>>>>>> the
>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command line?
>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following
>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has changed in
>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>> the path, otherwise it would not work on all older versions
>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>> path
>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created
>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes ... OK
>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods base
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Tue May  3 22:13:05 2011
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 03 May 2011 22:13:05 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC05427.7060908@aon.at>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
	<4DC05427.7060908@aon.at>
Message-ID: <4DC061D1.3080105@statistik.tu-dortmund.de>



On 03.05.2011 21:14, cstrato wrote:
> Dear Uwe,
>
> This is my development cycle:
>
> First, I run R CMD check until there are no more warnings/errors. Since
> years it was very convenient that R CMD check builds the pdf-files of
> the vignettes, too, since this allowed me to correct errors in the
> manual files and the vignette files at the same time!
>
> Afterwards I run R CMD INSTALL to install my package and do more tests
> until everything works.
>
> As you see I do not use R CMD build, since every run takes about 5
> minutes, it overwrites my zipped source code, and I would need to unzip
> it to get access to the vignette pdf-files.


Then this is the main problem here. The *recommended* development cycle 
from the manuals is to run

1. R CMD build in order to get a valid source tarball and clean the sources
2. R CMD INSTALL to check if your package can be installed
3. R CMD check in order to finally check your package

Running R CMD INSTALL on your source directory may pollute it, hence 
this is not recommended at all.


Best,
UWe





>
> Best regards
> Christian
>
>
> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>
>>
>> On 02.05.2011 21:24, cstrato wrote:
>>> Dear Prof. Ripley,
>>>
>>> Thank you for your confirmation and explanation, I understand the reason
>>> for cleaning things up to save memory. However, it was very convenient
>>> to have this feature in earlier versions of R. It would be really
>>> helpful to have an additional option to R CMD check, e.g.
>>> "--no-clean-vignettes".
>>>
>>> FYI, I did not claim "..create the vignettes *in <pkg>inst/doc*",
>>> instead my words were:
>>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>>> R-2.13.0 does not contain "inst".
>>
>>
>> But you do not need it. I do not know how often I have to mention that
>> vignettes are produced by R CMD build! They are already build when
>> running R CMD check. And please do not tell us about tzhe PDF version
>> oif manuals which are *unrelated* to vignettes, because they are not
>> built in advance and need to be checked, since they should be produced
>> at user level while vignettes are built at developer level already.
>>
>> Uwe Ligges
>>
>>
>>> Best regards
>>> Christian
>>> _._._._._._._._._._._._._._._._._._
>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>> e.m.a.i.l: cstrato at aon.at
>>> _._._._._._._._._._._._._._._._._._
>>>
>>>
>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>
>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>> Dear Duncan, dear Uwe,
>>>>>>
>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>>> virtual machine, I have now done the following tests on all three
>>>>>> architectures:
>>>>>>
>>>>>> 1, R CMD build xps:
>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>
>>>>>> 2, R CMD check xps:
>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>>> the
>>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>>> vignettes as pdf-files.
>>>>>>
>>>>>> Thus the question is:
>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>
>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>> reliable check, you should build the package, then check the tar.gz
>>>>> file. Anything else is, and always has been, an approximation.
>>>>
>>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>>> repeated delusional claims earlier) was to create the vignettes *in
>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>>> working directory. The difference is that 2.13.0 deletes that working
>>>> directory if the test was successful, whereas earlier versions left the
>>>> results somewhere in <pkg>.Rcheck (the 'somewhere' has varied).
>>>> However,
>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>> succeeded
>>>>
>>>> Using Animal (a small CRAN package with one vignette).
>>>>
>>>> R 2.12.2 gave
>>>>
>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>> Package vignettes without corresponding PDF:
>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>
>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>
>>>> R 2.13.0 gives
>>>>
>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>> Package vignette(s) without corresponding PDF:
>>>> Animal.Rnw
>>>>
>>>> Non-ASCII package vignette(s) without specified encoding:
>>>> Animal.Rnw
>>>>
>>>> * checking running R code from vignettes ... OK
>>>> * checking re-building of vignettes ... OK
>>>>
>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>
>>>> The main reason for cleaning up is that to mimic R CMD build the test
>>>> has to make a complete copy of the package sources, and that adds up:
>>>> checking CRAN already takes 17GB for each flavour.
>>>>
>>>>
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>
>>>>>>
>>>>>> Best regards
>>>>>> Christian
>>>>>>
>>>>>>
>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>
>>>>>>>
>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>
>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>> converted to
>>>>>>>> a vignette w/o any problems using:
>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps", quiet=F)
>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>
>>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did not
>>>>>>>> like
>>>>>>>> to work during eastern holidays).
>>>>>>>>
>>>>>>>> However, one issue remains:
>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>>> for
>>>>>>>> the vignettes.
>>>>>>>
>>>>>>>
>>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>>> build
>>>>>>> creates the pdf files.
>>>>>>>
>>>>>>> Uwe Ligges
>>>>>>>
>>>>>>>>
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>>
>>>>>>>>
>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>> Thank you.
>>>>>>>>>>
>>>>>>>>>> My problem seems to be that at the moment the problem can be seen
>>>>>>>>>> only
>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>>> creating
>>>>>>>>>> the vignettes.
>>>>>>>>>
>>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>>> the
>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>> everything
>>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>>> cut
>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>> particular
>>>>>>>>> small snippet of code, and then you can add print() statements, or
>>>>>>>>> use
>>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>>> about your
>>>>>>>>> system.
>>>>>>>>>
>>>>>>>>> I suspect it will turn out to be an assumption in the code that is
>>>>>>>>> not
>>>>>>>>> true on your system.
>>>>>>>>>
>>>>>>>>> If the assumption is being made by code you wrote, then fix it. If
>>>>>>>>> it's
>>>>>>>>> being made by R, let us know.
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>>
>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>
>>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>>> does not
>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>
>>>>>>>>>>> Try it.
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>> 3, this code (or a similar code) is the starting code which all
>>>>>>>>>>>> users
>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>
>>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>>> code. As
>>>>>>>>>>> far
>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>> that's
>>>>>>>>>>> where
>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>> position to
>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>
>>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>>> illustrating the problem that doesn't involve your code, and
>>>>>>>>>>> I'll
>>>>>>>>>>> take a
>>>>>>>>>>> look.
>>>>>>>>>>>
>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>> ??
>>>>>>>>>>>>
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>>
>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>>> code
>>>>>>>>>>>>>> from
>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I have
>>>>>>>>>>>>> this
>>>>>>>>>>>>> in a
>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>
>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>> @
>>>>>>>>>>>>>
>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>> @
>>>>>>>>>>>>>
>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>> @
>>>>>>>>>>>>>
>>>>>>>>>>>>> I will see the value of x getting printed, even though it came
>>>>>>>>>>>>> from
>>>>>>>>>>>>> two
>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>
>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>>> running.
>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>
>>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> code
>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything works
>>>>>>>>>>>>>> since
>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes, however
>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be created
>>>>>>>>>>>>>> which
>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>>> and
>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>> and
>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not build
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to run
>>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since installing
>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine with
>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>> * using log directory '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command
>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the result of
>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the following
>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older versions
>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on two
>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but then
>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always created
>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have you
>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods
>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From cstrato at aon.at  Tue May  3 22:48:03 2011
From: cstrato at aon.at (cstrato)
Date: Tue, 03 May 2011 22:48:03 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC061D1.3080105@statistik.tu-dortmund.de>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
	<4DC05427.7060908@aon.at>
	<4DC061D1.3080105@statistik.tu-dortmund.de>
Message-ID: <4DC06A03.2010205@aon.at>

Dear Uwe,

Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source code 
is not polluted.

Furthermore, I forgot to mention that finally I upload the source code 
only to the BioC svn repository. The rest is done by the BioC servers, 
including building the pdf-files for the vignettes.

Best regards
Christian


On 5/3/11 10:13 PM, Uwe Ligges wrote:
>
>
> On 03.05.2011 21:14, cstrato wrote:
>> Dear Uwe,
>>
>> This is my development cycle:
>>
>> First, I run R CMD check until there are no more warnings/errors. Since
>> years it was very convenient that R CMD check builds the pdf-files of
>> the vignettes, too, since this allowed me to correct errors in the
>> manual files and the vignette files at the same time!
>>
>> Afterwards I run R CMD INSTALL to install my package and do more tests
>> until everything works.
>>
>> As you see I do not use R CMD build, since every run takes about 5
>> minutes, it overwrites my zipped source code, and I would need to unzip
>> it to get access to the vignette pdf-files.
>
>
> Then this is the main problem here. The *recommended* development cycle
> from the manuals is to run
>
> 1. R CMD build in order to get a valid source tarball and clean the sources
> 2. R CMD INSTALL to check if your package can be installed
> 3. R CMD check in order to finally check your package
>
> Running R CMD INSTALL on your source directory may pollute it, hence
> this is not recommended at all.
>
>
> Best,
> UWe
>
>
>
>
>
>>
>> Best regards
>> Christian
>>
>>
>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>
>>>
>>> On 02.05.2011 21:24, cstrato wrote:
>>>> Dear Prof. Ripley,
>>>>
>>>> Thank you for your confirmation and explanation, I understand the
>>>> reason
>>>> for cleaning things up to save memory. However, it was very convenient
>>>> to have this feature in earlier versions of R. It would be really
>>>> helpful to have an additional option to R CMD check, e.g.
>>>> "--no-clean-vignettes".
>>>>
>>>> FYI, I did not claim "..create the vignettes *in <pkg>inst/doc*",
>>>> instead my words were:
>>>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>>>> R-2.13.0 does not contain "inst".
>>>
>>>
>>> But you do not need it. I do not know how often I have to mention that
>>> vignettes are produced by R CMD build! They are already build when
>>> running R CMD check. And please do not tell us about tzhe PDF version
>>> oif manuals which are *unrelated* to vignettes, because they are not
>>> built in advance and need to be checked, since they should be produced
>>> at user level while vignettes are built at developer level already.
>>>
>>> Uwe Ligges
>>>
>>>
>>>> Best regards
>>>> Christian
>>>> _._._._._._._._._._._._._._._._._._
>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>> e.m.a.i.l: cstrato at aon.at
>>>> _._._._._._._._._._._._._._._._._._
>>>>
>>>>
>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>
>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>
>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>>>> virtual machine, I have now done the following tests on all three
>>>>>>> architectures:
>>>>>>>
>>>>>>> 1, R CMD build xps:
>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>
>>>>>>> 2, R CMD check xps:
>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>>>> the
>>>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>>>> vignettes as pdf-files.
>>>>>>>
>>>>>>> Thus the question is:
>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>
>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>> reliable check, you should build the package, then check the tar.gz
>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>
>>>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>>>> repeated delusional claims earlier) was to create the vignettes *in
>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>>>> working directory. The difference is that 2.13.0 deletes that working
>>>>> directory if the test was successful, whereas earlier versions left
>>>>> the
>>>>> results somewhere in <pkg>.Rcheck (the 'somewhere' has varied).
>>>>> However,
>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>> succeeded
>>>>>
>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>
>>>>> R 2.12.2 gave
>>>>>
>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>> Package vignettes without corresponding PDF:
>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>
>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>
>>>>> R 2.13.0 gives
>>>>>
>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>> Package vignette(s) without corresponding PDF:
>>>>> Animal.Rnw
>>>>>
>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>> Animal.Rnw
>>>>>
>>>>> * checking running R code from vignettes ... OK
>>>>> * checking re-building of vignettes ... OK
>>>>>
>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>
>>>>> The main reason for cleaning up is that to mimic R CMD build the test
>>>>> has to make a complete copy of the package sources, and that adds up:
>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>
>>>>>
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>>
>>>>>>>
>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>
>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>> converted to
>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>> quiet=F)
>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>
>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did
>>>>>>>>> not
>>>>>>>>> like
>>>>>>>>> to work during eastern holidays).
>>>>>>>>>
>>>>>>>>> However, one issue remains:
>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>>>> for
>>>>>>>>> the vignettes.
>>>>>>>>
>>>>>>>>
>>>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>>>> build
>>>>>>>> creates the pdf files.
>>>>>>>>
>>>>>>>> Uwe Ligges
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>> Thank you.
>>>>>>>>>>>
>>>>>>>>>>> My problem seems to be that at the moment the problem can be
>>>>>>>>>>> seen
>>>>>>>>>>> only
>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>>>> creating
>>>>>>>>>>> the vignettes.
>>>>>>>>>>
>>>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>>>> the
>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>> everything
>>>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>>>> cut
>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>> particular
>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>> statements, or
>>>>>>>>>> use
>>>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>>>> about your
>>>>>>>>>> system.
>>>>>>>>>>
>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>> that is
>>>>>>>>>> not
>>>>>>>>>> true on your system.
>>>>>>>>>>
>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>> it. If
>>>>>>>>>> it's
>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>>
>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>>>> does not
>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>
>>>>>>>>>>>> Try it.
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code which
>>>>>>>>>>>>> all
>>>>>>>>>>>>> users
>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>
>>>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>>>> code. As
>>>>>>>>>>>> far
>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>>> that's
>>>>>>>>>>>> where
>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>> position to
>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>
>>>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>>>> illustrating the problem that doesn't involve your code, and
>>>>>>>>>>>> I'll
>>>>>>>>>>>> take a
>>>>>>>>>>>> look.
>>>>>>>>>>>>
>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>> ??
>>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I
>>>>>>>>>>>>>> have
>>>>>>>>>>>>>> this
>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> I will see the value of x getting printed, even though it
>>>>>>>>>>>>>> came
>>>>>>>>>>>>>> from
>>>>>>>>>>>>>> two
>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything
>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not
>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to
>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine
>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command
>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on
>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but
>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have
>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods
>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>


From simon.urbanek at r-project.org  Tue May  3 23:11:12 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 May 2011 17:11:12 -0400
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC06A03.2010205@aon.at>
References: <4DB32D9F.5010406@aon.at>
	<4DB42FB3.9090401@statistik.tu-dortmund.de>
	<4DB472F8.9060903@aon.at>
	<4DB489EC.9080301@statistik.tu-dortmund.de>
	<4DB491BE.8080104@aon.at>
	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at> <4DBDEA8F.60000@gmail.com>
	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
	<4DC05427.7060908@aon.at>
	<4DC061D1.3080105@statistik.tu-dortmund.de>
	<4DC06A03.2010205@aon.at>
Message-ID: <602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>

On May 3, 2011, at 4:48 PM, cstrato <cstrato at aon.at> wrote:

> Dear Uwe,
> 
> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source code is not polluted.
> 

But then you already used build to create the tar ball so the vignette has been built. So what is your point?

Cheers,
S


> Furthermore, I forgot to mention that finally I upload the source code only to the BioC svn repository. The rest is done by the BioC servers, including building the pdf-files for the vignettes.
> 
> Best regards
> Christian
> 
> 
> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>> 
>> 
>> On 03.05.2011 21:14, cstrato wrote:
>>> Dear Uwe,
>>> 
>>> This is my development cycle:
>>> 
>>> First, I run R CMD check until there are no more warnings/errors. Since
>>> years it was very convenient that R CMD check builds the pdf-files of
>>> the vignettes, too, since this allowed me to correct errors in the
>>> manual files and the vignette files at the same time!
>>> 
>>> Afterwards I run R CMD INSTALL to install my package and do more tests
>>> until everything works.
>>> 
>>> As you see I do not use R CMD build, since every run takes about 5
>>> minutes, it overwrites my zipped source code, and I would need to unzip
>>> it to get access to the vignette pdf-files.
>> 
>> 
>> Then this is the main problem here. The *recommended* development cycle
>> from the manuals is to run
>> 
>> 1. R CMD build in order to get a valid source tarball and clean the sources
>> 2. R CMD INSTALL to check if your package can be installed
>> 3. R CMD check in order to finally check your package
>> 
>> Running R CMD INSTALL on your source directory may pollute it, hence
>> this is not recommended at all.
>> 
>> 
>> Best,
>> UWe
>> 
>> 
>> 
>> 
>> 
>>> 
>>> Best regards
>>> Christian
>>> 
>>> 
>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>> 
>>>> 
>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>> Dear Prof. Ripley,
>>>>> 
>>>>> Thank you for your confirmation and explanation, I understand the
>>>>> reason
>>>>> for cleaning things up to save memory. However, it was very convenient
>>>>> to have this feature in earlier versions of R. It would be really
>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>> "--no-clean-vignettes".
>>>>> 
>>>>> FYI, I did not claim "..create the vignettes *in <pkg>inst/doc*",
>>>>> instead my words were:
>>>>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>>>>> R-2.13.0 does not contain "inst".
>>>> 
>>>> 
>>>> But you do not need it. I do not know how often I have to mention that
>>>> vignettes are produced by R CMD build! They are already build when
>>>> running R CMD check. And please do not tell us about tzhe PDF version
>>>> oif manuals which are *unrelated* to vignettes, because they are not
>>>> built in advance and need to be checked, since they should be produced
>>>> at user level while vignettes are built at developer level already.
>>>> 
>>>> Uwe Ligges
>>>> 
>>>> 
>>>>> Best regards
>>>>> Christian
>>>>> _._._._._._._._._._._._._._._._._._
>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>> e.m.a.i.l: cstrato at aon.at
>>>>> _._._._._._._._._._._._._._._._._._
>>>>> 
>>>>> 
>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>> 
>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>> 
>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>>>>> virtual machine, I have now done the following tests on all three
>>>>>>>> architectures:
>>>>>>>> 
>>>>>>>> 1, R CMD build xps:
>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>> 
>>>>>>>> 2, R CMD check xps:
>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>>>>> the
>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>>>>> vignettes as pdf-files.
>>>>>>>> 
>>>>>>>> Thus the question is:
>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>> 
>>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>>> reliable check, you should build the package, then check the tar.gz
>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>> 
>>>>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>>>>> repeated delusional claims earlier) was to create the vignettes *in
>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>>>>> working directory. The difference is that 2.13.0 deletes that working
>>>>>> directory if the test was successful, whereas earlier versions left
>>>>>> the
>>>>>> results somewhere in <pkg>.Rcheck (the 'somewhere' has varied).
>>>>>> However,
>>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>>> succeeded
>>>>>> 
>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>> 
>>>>>> R 2.12.2 gave
>>>>>> 
>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>> Package vignettes without corresponding PDF:
>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>> 
>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>> 
>>>>>> R 2.13.0 gives
>>>>>> 
>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>> Package vignette(s) without corresponding PDF:
>>>>>> Animal.Rnw
>>>>>> 
>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>> Animal.Rnw
>>>>>> 
>>>>>> * checking running R code from vignettes ... OK
>>>>>> * checking re-building of vignettes ... OK
>>>>>> 
>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>> 
>>>>>> The main reason for cleaning up is that to mimic R CMD build the test
>>>>>> has to make a complete copy of the package sources, and that adds up:
>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>> 
>>>>>> 
>>>>>>> 
>>>>>>> Duncan Murdoch
>>>>>>> 
>>>>>>> 
>>>>>>>> 
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>> 
>>>>>>>> 
>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>> 
>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>> converted to
>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>> quiet=F)
>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>> 
>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did
>>>>>>>>>> not
>>>>>>>>>> like
>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>> 
>>>>>>>>>> However, one issue remains:
>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>>>>> for
>>>>>>>>>> the vignettes.
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>>>>> build
>>>>>>>>> creates the pdf files.
>>>>>>>>> 
>>>>>>>>> Uwe Ligges
>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>> Thank you.
>>>>>>>>>>>> 
>>>>>>>>>>>> My problem seems to be that at the moment the problem can be
>>>>>>>>>>>> seen
>>>>>>>>>>>> only
>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>>>>> creating
>>>>>>>>>>>> the vignettes.
>>>>>>>>>>> 
>>>>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>>>>> the
>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>>> everything
>>>>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>>>>> cut
>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>> particular
>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>> statements, or
>>>>>>>>>>> use
>>>>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>>>>> about your
>>>>>>>>>>> system.
>>>>>>>>>>> 
>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>> that is
>>>>>>>>>>> not
>>>>>>>>>>> true on your system.
>>>>>>>>>>> 
>>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>>> it. If
>>>>>>>>>>> it's
>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>> 
>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>> 
>>>>>>>>>>>> 
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>> 
>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>> 
>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code which
>>>>>>>>>>>>>> all
>>>>>>>>>>>>>> users
>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>>>>> code. As
>>>>>>>>>>>>> far
>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>>>> that's
>>>>>>>>>>>>> where
>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>> position to
>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>>>>> illustrating the problem that doesn't involve your code, and
>>>>>>>>>>>>> I'll
>>>>>>>>>>>>> take a
>>>>>>>>>>>>> look.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I
>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> I will see the value of x getting printed, even though it
>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything
>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not
>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to
>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine
>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command
>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on
>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but
>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have
>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods
>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>> 
>>>>>>> 
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>> 
>>>>>> 
>>>>> 
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From cstrato at aon.at  Tue May  3 23:15:56 2011
From: cstrato at aon.at (cstrato)
Date: Tue, 03 May 2011 23:15:56 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>
References: <4DB32D9F.5010406@aon.at>
	<4DB42FB3.9090401@statistik.tu-dortmund.de>
	<4DB472F8.9060903@aon.at>
	<4DB489EC.9080301@statistik.tu-dortmund.de>
	<4DB491BE.8080104@aon.at>
	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at> <4DBDEA8F.60000@gmail.com>
	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
	<4DC05427.7060908@aon.at>
	<4DC061D1.3080105@statistik.tu-dortmund.de>
	<4DC06A03.2010205@aon.at>
	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>
Message-ID: <4DC0708C.2060708@aon.at>

No, I simply do "tar czf xps_1.13.1.tar.gz xps".

Best regards
Christian


On 5/3/11 11:11 PM, Simon Urbanek wrote:
> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at>  wrote:
> 
>> Dear Uwe,
>>
>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source code is not polluted.
>>
> 
> But then you already used build to create the tar ball so the vignette has been built. So what is your point?
> 
> Cheers,
> S
> 
> 
>> Furthermore, I forgot to mention that finally I upload the source code only to the BioC svn repository. The rest is done by the BioC servers, including building the pdf-files for the vignettes.
>>
>> Best regards
>> Christian
>>
>>
>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>
>>>
>>> On 03.05.2011 21:14, cstrato wrote:
>>>> Dear Uwe,
>>>>
>>>> This is my development cycle:
>>>>
>>>> First, I run R CMD check until there are no more warnings/errors. Since
>>>> years it was very convenient that R CMD check builds the pdf-files of
>>>> the vignettes, too, since this allowed me to correct errors in the
>>>> manual files and the vignette files at the same time!
>>>>
>>>> Afterwards I run R CMD INSTALL to install my package and do more tests
>>>> until everything works.
>>>>
>>>> As you see I do not use R CMD build, since every run takes about 5
>>>> minutes, it overwrites my zipped source code, and I would need to unzip
>>>> it to get access to the vignette pdf-files.
>>>
>>>
>>> Then this is the main problem here. The *recommended* development cycle
>>> from the manuals is to run
>>>
>>> 1. R CMD build in order to get a valid source tarball and clean the sources
>>> 2. R CMD INSTALL to check if your package can be installed
>>> 3. R CMD check in order to finally check your package
>>>
>>> Running R CMD INSTALL on your source directory may pollute it, hence
>>> this is not recommended at all.
>>>
>>>
>>> Best,
>>> UWe
>>>
>>>
>>>
>>>
>>>
>>>>
>>>> Best regards
>>>> Christian
>>>>
>>>>
>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>
>>>>>
>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>> Dear Prof. Ripley,
>>>>>>
>>>>>> Thank you for your confirmation and explanation, I understand the
>>>>>> reason
>>>>>> for cleaning things up to save memory. However, it was very convenient
>>>>>> to have this feature in earlier versions of R. It would be really
>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>> "--no-clean-vignettes".
>>>>>>
>>>>>> FYI, I did not claim "..create the vignettes *in<pkg>inst/doc*",
>>>>>> instead my words were:
>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>>>>>> R-2.13.0 does not contain "inst".
>>>>>
>>>>>
>>>>> But you do not need it. I do not know how often I have to mention that
>>>>> vignettes are produced by R CMD build! They are already build when
>>>>> running R CMD check. And please do not tell us about tzhe PDF version
>>>>> oif manuals which are *unrelated* to vignettes, because they are not
>>>>> built in advance and need to be checked, since they should be produced
>>>>> at user level while vignettes are built at developer level already.
>>>>>
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>> Best regards
>>>>>> Christian
>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>
>>>>>>
>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>
>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>
>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>>>>>> virtual machine, I have now done the following tests on all three
>>>>>>>>> architectures:
>>>>>>>>>
>>>>>>>>> 1, R CMD build xps:
>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>
>>>>>>>>> 2, R CMD check xps:
>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>>>>>> the
>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>
>>>>>>>>> Thus the question is:
>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>
>>>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>>>> reliable check, you should build the package, then check the tar.gz
>>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>>>
>>>>>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>>>>>> repeated delusional claims earlier) was to create the vignettes *in
>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>>>>>> working directory. The difference is that 2.13.0 deletes that working
>>>>>>> directory if the test was successful, whereas earlier versions left
>>>>>>> the
>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>> However,
>>>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>>>> succeeded
>>>>>>>
>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>
>>>>>>> R 2.12.2 gave
>>>>>>>
>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>> Package vignettes without corresponding PDF:
>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>
>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>
>>>>>>> R 2.13.0 gives
>>>>>>>
>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>> Animal.Rnw
>>>>>>>
>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>> Animal.Rnw
>>>>>>>
>>>>>>> * checking running R code from vignettes ... OK
>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>
>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>
>>>>>>> The main reason for cleaning up is that to mimic R CMD build the test
>>>>>>> has to make a complete copy of the package sources, and that adds up:
>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>
>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>>> converted to
>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>> quiet=F)
>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>
>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did
>>>>>>>>>>> not
>>>>>>>>>>> like
>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>
>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>>>>>> for
>>>>>>>>>>> the vignettes.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>>>>>> build
>>>>>>>>>> creates the pdf files.
>>>>>>>>>>
>>>>>>>>>> Uwe Ligges
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>
>>>>>>>>>>>>> My problem seems to be that at the moment the problem can be
>>>>>>>>>>>>> seen
>>>>>>>>>>>>> only
>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>>>>>> creating
>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>
>>>>>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>>>>>> the
>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>>>> everything
>>>>>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>>>>>> cut
>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>> particular
>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>> statements, or
>>>>>>>>>>>> use
>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>>>>>> about your
>>>>>>>>>>>> system.
>>>>>>>>>>>>
>>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>>> that is
>>>>>>>>>>>> not
>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>
>>>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>>>> it. If
>>>>>>>>>>>> it's
>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>
>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code which
>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>> far
>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>> where
>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>>>>>> illustrating the problem that doesn't involve your code, and
>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I
>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> I will see the value of x getting printed, even though it
>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything
>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not
>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to
>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine
>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command
>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>> Overfull \vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>>>>>> \output is
>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on
>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but
>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have
>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods
>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Tue May  3 23:39:26 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 3 May 2011 16:39:26 -0500
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <4DBDF900.1010601@r-project.org>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org> <4DBDE093.5080300@fhcrc.org>
	<4DBDF900.1010601@r-project.org>
Message-ID: <BANLkTik8K3kB-Y1-9jk+7HhPVdYA+=DW8w@mail.gmail.com>

> Part of the motivation for the reference classes was to bring a general OOP
> view to R. ?One can start from some essential concepts of objects and their
> properties, inheritance and class definition, as have evolved over a very
> long time.
>
> Next, there is a fundamental choice of paradigm between "encapsulated" OOP
> as the rest of the world knows it, and "functional" OOP as practiced by S
> and R, and a few other languages. ?While the two paradigms are quite
> different, there is no need to view them as opposed. ?They provide different
> advantages and tend to suit different goals--very roughly, functional object
> creation and reproducible results versus persistent objects whose properties
> one would like to have evolve over time using their encapsulated methods.

My biggest worry with the introduction of reference classes is that
many people will just stick to the style of OOP that they're familiar
with, and not bother to learn the strengths of the generic function
approach.

> As these remarks may suggest, I'm trying to write up this perspective in
> some detail.  To be continued ....

Are you familiar with "Concepts, Techniques, and Models of Computer
Programming" by van Roy and Haridi?  That's what really helped me to
understand the strengths and weaknesses of the various styles of
programming.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From simon.urbanek at r-project.org  Wed May  4 00:13:27 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 May 2011 18:13:27 -0400
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC0708C.2060708@aon.at>
References: <4DB32D9F.5010406@aon.at>
	<4DB42FB3.9090401@statistik.tu-dortmund.de>
	<4DB472F8.9060903@aon.at>
	<4DB489EC.9080301@statistik.tu-dortmund.de>
	<4DB491BE.8080104@aon.at>
	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at> <4DBDEA8F.60000@gmail.com>
	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
	<4DC05427.7060908@aon.at>
	<4DC061D1.3080105@statistik.tu-dortmund.de>
	<4DC06A03.2010205@aon.at>
	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>
	<4DC0708C.2060708@aon.at>
Message-ID: <CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>

On May 3, 2011, at 5:15 PM, cstrato wrote:

> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
> 

Well, that's your problem then, not R's. Source packages are created using R CMD build, not by manual tarring (you can do the latter if you know what you're doing, but then you can't complain about the R doing something wrong).

Cheers,
S


> 
> On 5/3/11 11:11 PM, Simon Urbanek wrote:
>> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at>  wrote:
>> 
>>> Dear Uwe,
>>> 
>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source code is not polluted.
>>> 
>> 
>> But then you already used build to create the tar ball so the vignette has been built. So what is your point?
>> 
>> Cheers,
>> S
>> 
>> 
>>> Furthermore, I forgot to mention that finally I upload the source code only to the BioC svn repository. The rest is done by the BioC servers, including building the pdf-files for the vignettes.
>>> 
>>> Best regards
>>> Christian
>>> 
>>> 
>>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>> 
>>>> 
>>>> On 03.05.2011 21:14, cstrato wrote:
>>>>> Dear Uwe,
>>>>> 
>>>>> This is my development cycle:
>>>>> 
>>>>> First, I run R CMD check until there are no more warnings/errors. Since
>>>>> years it was very convenient that R CMD check builds the pdf-files of
>>>>> the vignettes, too, since this allowed me to correct errors in the
>>>>> manual files and the vignette files at the same time!
>>>>> 
>>>>> Afterwards I run R CMD INSTALL to install my package and do more tests
>>>>> until everything works.
>>>>> 
>>>>> As you see I do not use R CMD build, since every run takes about 5
>>>>> minutes, it overwrites my zipped source code, and I would need to unzip
>>>>> it to get access to the vignette pdf-files.
>>>> 
>>>> 
>>>> Then this is the main problem here. The *recommended* development cycle
>>>> from the manuals is to run
>>>> 
>>>> 1. R CMD build in order to get a valid source tarball and clean the sources
>>>> 2. R CMD INSTALL to check if your package can be installed
>>>> 3. R CMD check in order to finally check your package
>>>> 
>>>> Running R CMD INSTALL on your source directory may pollute it, hence
>>>> this is not recommended at all.
>>>> 
>>>> 
>>>> Best,
>>>> UWe
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>>> 
>>>>> Best regards
>>>>> Christian
>>>>> 
>>>>> 
>>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>> 
>>>>>> 
>>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>>> Dear Prof. Ripley,
>>>>>>> 
>>>>>>> Thank you for your confirmation and explanation, I understand the
>>>>>>> reason
>>>>>>> for cleaning things up to save memory. However, it was very convenient
>>>>>>> to have this feature in earlier versions of R. It would be really
>>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>>> "--no-clean-vignettes".
>>>>>>> 
>>>>>>> FYI, I did not claim "..create the vignettes *in<pkg>inst/doc*",
>>>>>>> instead my words were:
>>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>>>>>>> R-2.13.0 does not contain "inst".
>>>>>> 
>>>>>> 
>>>>>> But you do not need it. I do not know how often I have to mention that
>>>>>> vignettes are produced by R CMD build! They are already build when
>>>>>> running R CMD check. And please do not tell us about tzhe PDF version
>>>>>> oif manuals which are *unrelated* to vignettes, because they are not
>>>>>> built in advance and need to be checked, since they should be produced
>>>>>> at user level while vignettes are built at developer level already.
>>>>>> 
>>>>>> Uwe Ligges
>>>>>> 
>>>>>> 
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>> 
>>>>>>> 
>>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>> 
>>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>> 
>>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>>>>>>> virtual machine, I have now done the following tests on all three
>>>>>>>>>> architectures:
>>>>>>>>>> 
>>>>>>>>>> 1, R CMD build xps:
>>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>> 
>>>>>>>>>> 2, R CMD check xps:
>>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>>>>>>> the
>>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>> 
>>>>>>>>>> Thus the question is:
>>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>> 
>>>>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>>>>> reliable check, you should build the package, then check the tar.gz
>>>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>>>> 
>>>>>>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>>>>>>> repeated delusional claims earlier) was to create the vignettes *in
>>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>>>>>>> working directory. The difference is that 2.13.0 deletes that working
>>>>>>>> directory if the test was successful, whereas earlier versions left
>>>>>>>> the
>>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>>> However,
>>>>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>>>>> succeeded
>>>>>>>> 
>>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>> 
>>>>>>>> R 2.12.2 gave
>>>>>>>> 
>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>> 
>>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>> 
>>>>>>>> R 2.13.0 gives
>>>>>>>> 
>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>> Animal.Rnw
>>>>>>>> 
>>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>>> Animal.Rnw
>>>>>>>> 
>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>> 
>>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>> 
>>>>>>>> The main reason for cleaning up is that to mimic R CMD build the test
>>>>>>>> has to make a complete copy of the package sources, and that adds up:
>>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>> 
>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> Duncan Murdoch
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>> 
>>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>>>> converted to
>>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>> 
>>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did
>>>>>>>>>>>> not
>>>>>>>>>>>> like
>>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>> 
>>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>>>>>>> for
>>>>>>>>>>>> the vignettes.
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>>>>>>> build
>>>>>>>>>>> creates the pdf files.
>>>>>>>>>>> 
>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>> 
>>>>>>>>>>>> 
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>> 
>>>>>>>>>>>> 
>>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> My problem seems to be that at the moment the problem can be
>>>>>>>>>>>>>> seen
>>>>>>>>>>>>>> only
>>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>>>>>>> creating
>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>>>>>>> the
>>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>>>>> everything
>>>>>>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>>>>>>> cut
>>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>>> particular
>>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>>> statements, or
>>>>>>>>>>>>> use
>>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>>>>>>> about your
>>>>>>>>>>>>> system.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>>>> that is
>>>>>>>>>>>>> not
>>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>>>>> it. If
>>>>>>>>>>>>> it's
>>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>> 
>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code which
>>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>>> far
>>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>>> where
>>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>>>>>>> illustrating the problem that doesn't involve your code, and
>>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I
>>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> I will see the value of x getting printed, even though it
>>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything
>>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not
>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to
>>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine
>>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command
>>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>>> Overfull ?vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>>>>>>> ?output is
>>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on
>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but
>>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have
>>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods
>>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>> 
>>>>>>>> 
>>>>>>> 
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>> 
>>>> 
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> 


From xie at yihui.name  Wed May  4 01:44:41 2011
From: xie at yihui.name (Yihui Xie)
Date: Tue, 3 May 2011 18:44:41 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and remove
 the version string in the installation dir under Windows
Message-ID: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>

Hi,

I guess this issue must have been brought forward long time ago, but I
still hope you can consider under Windows (during installation):

1. put R's bin path in the PATH variable of the system so that we can
use the commands "R" and "Rscript" more easily;

2. remove the version string like R-2.13.0 in the default installation
directory, e.g. only use a directory like C:/Program Files/R/ instead
of C:/Program Files/R/R-2.13.0/; I know many people just follow the
default setting when installing R, and this version string will often
lead to many (unnecessary) copies of R in the system and brings
difficulty to the first issue (several possible bin directories);

I'm aware of some existing efforts in overcoming the difficulty of
calling R under Windows like the R batch files project
(http://code.google.com/p/batchfiles/), but I believe this is better
to be solved in R directly.

Thanks!

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA


From D.Strbenac at garvan.org.au  Wed May  4 02:00:07 2011
From: D.Strbenac at garvan.org.au (Dario Strbenac)
Date: Wed,  4 May 2011 10:00:07 +1000 (EST)
Subject: [Rd] R CMD check and Suggests Packages
Message-ID: <20110504100007.BLQ63940@gimr.garvan.unsw.edu.au>

Hello,

>If Dario really uses R 2.13.0 (or newer),
>and he gets the above error message for a package that is not
>required but only suggested,
>I think we'd need a clear, ideally simple,
>reproducible example, here.

I was able to reproduce it. I made a new package with package.skeleton(), then added Suggests: RepitoolsExamples to the DESCRIPTION file, and the result of check was :

* using log directory /home/darstr/testPackage.Rcheck
* using R version 2.13.0 (2011-04-13)
* using platform: x86_64-unknown-linux-gnu (64-bit)
* using session charset: UTF-8
* checking for file testPackage/DESCRIPTION ... OK
* checking extension type ... Package
* this is package testPackage version 1.0
* checking package dependencies ... ERROR
Package required but not available: RepitoolsExamples
-------------- next part --------------
A non-text attachment was scrubbed...
Name: testPackage.tar.gz
Type: application/x-gzip
Size: 1260 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110504/161879f1/attachment.gz>

From ggrothendieck at gmail.com  Wed May  4 02:16:59 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 3 May 2011 20:16:59 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
Message-ID: <BANLkTimaYfqm07aJtsYiWzCChpEnq=GHAA@mail.gmail.com>

On Tue, May 3, 2011 at 7:44 PM, Yihui Xie <xie at yihui.name> wrote:
> Hi,
>
> I guess this issue must have been brought forward long time ago, but I
> still hope you can consider under Windows (during installation):
>
> 1. put R's bin path in the PATH variable of the system so that we can
> use the commands "R" and "Rscript" more easily;
>
> 2. remove the version string like R-2.13.0 in the default installation
> directory, e.g. only use a directory like C:/Program Files/R/ instead
> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
> default setting when installing R, and this version string will often
> lead to many (unnecessary) copies of R in the system and brings
> difficulty to the first issue (several possible bin directories);
>
> I'm aware of some existing efforts in overcoming the difficulty of
> calling R under Windows like the R batch files project
> (http://code.google.com/p/batchfiles/), but I believe this is better
> to be solved in R directly.
>

The above seems very awkward. If you want to do it temporarily each
time you use R its going to be MUCH slower than using batch files
since you will have to start up R and then run an R program.  To do it
permanently implies mucking with  your system settings and leaving it
in a changed state and that seems worse than the batch file approach
which requires no such permanent change.  Your (2) is unnecessary
using the batch files since they automatically find R regardless of
what you name the directory.  In other situations if you want to set
the path using R you already need to know the path to R in order to
run R in the first place and if you know the path to R in order to run
it why do you need to set the path?

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From murdoch.duncan at gmail.com  Wed May  4 03:14:50 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 03 May 2011 21:14:50 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
Message-ID: <4DC0A88A.4070908@gmail.com>

On 03/05/2011 7:44 PM, Yihui Xie wrote:
> Hi,
>
> I guess this issue must have been brought forward long time ago, but I
> still hope you can consider under Windows (during installation):
>
> 1. put R's bin path in the PATH variable of the system so that we can
> use the commands "R" and "Rscript" more easily;

Few Windows users use those commands.  The ones who do are generally 
exactly the ones who know how to edit the PATH variable themselves.

For most users (the ones who start R from the shortcut), there's no need 
to mess with the PATH variable.  Personally, I hate programs that do 
that.  And with R, it's now complicated, because there are 2 different 
directories holding executables:  bin/i386 and bin/x64.  (The bin 
directory also holds some, but that's just for back  compatibility.)
How could the installer know which of those to put in the PATH?  At 
installation time, a user isn't going to know which one he/she needs.

> 2. remove the version string like R-2.13.0 in the default installation
> directory, e.g. only use a directory like C:/Program Files/R/ instead
> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
> default setting when installing R, and this version string will often
> lead to many (unnecessary) copies of R in the system and brings
> difficulty to the first issue (several possible bin directories);

Multiple installs give you the possibility of reproducing things that 
don't work in the latest R version.  I think it's a good practice to 
keep multiple installs on your system if you have the space, and since 
disk space is cheap these days, that's not so uncommon.

Duncan Murdoch

>
> I'm aware of some existing efforts in overcoming the difficulty of
> calling R under Windows like the R batch files project
> (http://code.google.com/p/batchfiles/), but I believe this is better
> to be solved in R directly.
>
> Thanks!
>
> Regards,
> Yihui
> --
> Yihui Xie<xieyihui at gmail.com>
> Phone: 515-294-2465 Web: http://yihui.name
> Department of Statistics, Iowa State University
> 2215 Snedecor Hall, Ames, IA
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From xie at yihui.name  Wed May  4 04:58:11 2011
From: xie at yihui.name (Yihui Xie)
Date: Tue, 3 May 2011 21:58:11 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTimaYfqm07aJtsYiWzCChpEnq=GHAA@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<BANLkTimaYfqm07aJtsYiWzCChpEnq=GHAA@mail.gmail.com>
Message-ID: <BANLkTi=ou+dBsV+TGfMe9RPCY7tEC0+qsA@mail.gmail.com>

1. I understand the efforts in those batch files, but my philosophy is
to let the users go through as less steps as they can. Since it is
possible to do it in R directly, I prefer not to download those batch
files and execute commands like R.bat CMD build or Rscript.bat file.R.
This requires extra explanations to users.

2. Yes I was fully aware of the usefulness of those batch files. I was
wishing for a direct solution.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Tue, May 3, 2011 at 7:16 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Tue, May 3, 2011 at 7:44 PM, Yihui Xie <xie at yihui.name> wrote:
>> Hi,
>>
>> I guess this issue must have been brought forward long time ago, but I
>> still hope you can consider under Windows (during installation):
>>
>> 1. put R's bin path in the PATH variable of the system so that we can
>> use the commands "R" and "Rscript" more easily;
>>
>> 2. remove the version string like R-2.13.0 in the default installation
>> directory, e.g. only use a directory like C:/Program Files/R/ instead
>> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
>> default setting when installing R, and this version string will often
>> lead to many (unnecessary) copies of R in the system and brings
>> difficulty to the first issue (several possible bin directories);
>>
>> I'm aware of some existing efforts in overcoming the difficulty of
>> calling R under Windows like the R batch files project
>> (http://code.google.com/p/batchfiles/), but I believe this is better
>> to be solved in R directly.
>>
>
> The above seems very awkward. If you want to do it temporarily each
> time you use R its going to be MUCH slower than using batch files
> since you will have to start up R and then run an R program. ?To do it
> permanently implies mucking with ?your system settings and leaving it
> in a changed state and that seems worse than the batch file approach
> which requires no such permanent change. ?Your (2) is unnecessary
> using the batch files since they automatically find R regardless of
> what you name the directory. ?In other situations if you want to set
> the path using R you already need to know the path to R in order to
> run R in the first place and if you know the path to R in order to run
> it why do you need to set the path?
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>


From xie at yihui.name  Wed May  4 05:25:04 2011
From: xie at yihui.name (Yihui Xie)
Date: Tue, 3 May 2011 22:25:04 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <4DC0A88A.4070908@gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
Message-ID: <BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>

1. "Few Windows users use these commands" does not imply they are not
useful, and I have no idea how many Windows users really use them. How
do you run "R CMD build" when you build R packages under Windows? You
don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
you?

I think the reason we have to mess with the PATH variable for each
single software package is that Windows is Not Unix, so you may hate
Windows instead of a package that modifies your PATH variable.

For the choice of i386 and x64, you can let the user decide which bin
path to use. I believe the number of users who frequently switch back
and forth is fairly small.

2. Under most circumstances I just keep the latest version of R. To
maintain R code with old R versions will be more and more difficult
with new features and changes coming in. Disk space is cheap, but time
is not.

I'm talking about the default installation directory here and I'm only
wishing that the version string could be removed by default.

Anyway, I think I will go to the batch files approach if these
suggestions are going to be turned down. I just don't want to tell
other people to run Rscript.bat under Windows and Rscript under *nix.
I hope they can be consistent.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Tue, May 3, 2011 at 8:14 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 03/05/2011 7:44 PM, Yihui Xie wrote:
>>
>> Hi,
>>
>> I guess this issue must have been brought forward long time ago, but I
>> still hope you can consider under Windows (during installation):
>>
>> 1. put R's bin path in the PATH variable of the system so that we can
>> use the commands "R" and "Rscript" more easily;
>
> Few Windows users use those commands. ?The ones who do are generally exactly
> the ones who know how to edit the PATH variable themselves.
>
> For most users (the ones who start R from the shortcut), there's no need to
> mess with the PATH variable. ?Personally, I hate programs that do that. ?And
> with R, it's now complicated, because there are 2 different directories
> holding executables: ?bin/i386 and bin/x64. ?(The bin directory also holds
> some, but that's just for back ?compatibility.)
> How could the installer know which of those to put in the PATH? ?At
> installation time, a user isn't going to know which one he/she needs.
>
>> 2. remove the version string like R-2.13.0 in the default installation
>> directory, e.g. only use a directory like C:/Program Files/R/ instead
>> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
>> default setting when installing R, and this version string will often
>> lead to many (unnecessary) copies of R in the system and brings
>> difficulty to the first issue (several possible bin directories);
>
> Multiple installs give you the possibility of reproducing things that don't
> work in the latest R version. ?I think it's a good practice to keep multiple
> installs on your system if you have the space, and since disk space is cheap
> these days, that's not so uncommon.
>
> Duncan Murdoch
>
>>
>> I'm aware of some existing efforts in overcoming the difficulty of
>> calling R under Windows like the R batch files project
>> (http://code.google.com/p/batchfiles/), but I believe this is better
>> to be solved in R directly.
>>
>> Thanks!
>>
>> Regards,
>> Yihui
>> --
>> Yihui Xie<xieyihui at gmail.com>
>> Phone: 515-294-2465 Web: http://yihui.name
>> Department of Statistics, Iowa State University
>> 2215 Snedecor Hall, Ames, IA
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From simon.urbanek at r-project.org  Wed May  4 05:41:50 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 May 2011 23:41:50 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
	remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
Message-ID: <71E311C8-378A-45CA-864C-BA80C45853E8@r-project.org>


On May 3, 2011, at 11:25 PM, Yihui Xie wrote:

> 1. "Few Windows users use these commands" does not imply they are not
> useful, and I have no idea how many Windows users really use them. How
> do you run "R CMD build" when you build R packages under Windows? You
> don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
> you?
> 

Yes, of course. It's the safest way and really easy if you use a decent manager (I hope you're not typing your packages tar ball names by hand, either). Adding things to PATH on Windows (unlike unix) has the unwanted consequence that all hell breaks loose due to PATH overriding DLL locations so you really don't want to mess with it.


> I think the reason we have to mess with the PATH variable for each
> single software package is that Windows is Not Unix, so you may hate
> Windows instead of a package that modifies your PATH variable.
> 
> For the choice of i386 and x64, you can let the user decide which bin
> path to use. I believe the number of users who frequently switch back
> and forth is fairly small.
> 
> 2. Under most circumstances I just keep the latest version of R. To
> maintain R code with old R versions will be more and more difficult
> with new features and changes coming in. Disk space is cheap, but time
> is not.
> 
> I'm talking about the default installation directory here and I'm only
> wishing that the version string could be removed by default.
> 

It can be already now, so I really have no idea what you're complaining about. If that's what you want, drop the the version and keep the one unversioned directory in your PATH and Bob's your uncle.

Cheers,
Simon



> Anyway, I think I will go to the batch files approach if these
> suggestions are going to be turned down. I just don't want to tell
> other people to run Rscript.bat under Windows and Rscript under *nix.
> I hope they can be consistent.
> 
> Regards,
> Yihui
> --
> Yihui Xie <xieyihui at gmail.com>
> Phone: 515-294-2465 Web: http://yihui.name
> Department of Statistics, Iowa State University
> 2215 Snedecor Hall, Ames, IA
> 
> 
> 
> On Tue, May 3, 2011 at 8:14 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> On 03/05/2011 7:44 PM, Yihui Xie wrote:
>>> 
>>> Hi,
>>> 
>>> I guess this issue must have been brought forward long time ago, but I
>>> still hope you can consider under Windows (during installation):
>>> 
>>> 1. put R's bin path in the PATH variable of the system so that we can
>>> use the commands "R" and "Rscript" more easily;
>> 
>> Few Windows users use those commands.  The ones who do are generally exactly
>> the ones who know how to edit the PATH variable themselves.
>> 
>> For most users (the ones who start R from the shortcut), there's no need to
>> mess with the PATH variable.  Personally, I hate programs that do that.  And
>> with R, it's now complicated, because there are 2 different directories
>> holding executables:  bin/i386 and bin/x64.  (The bin directory also holds
>> some, but that's just for back  compatibility.)
>> How could the installer know which of those to put in the PATH?  At
>> installation time, a user isn't going to know which one he/she needs.
>> 
>>> 2. remove the version string like R-2.13.0 in the default installation
>>> directory, e.g. only use a directory like C:/Program Files/R/ instead
>>> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
>>> default setting when installing R, and this version string will often
>>> lead to many (unnecessary) copies of R in the system and brings
>>> difficulty to the first issue (several possible bin directories);
>> 
>> Multiple installs give you the possibility of reproducing things that don't
>> work in the latest R version.  I think it's a good practice to keep multiple
>> installs on your system if you have the space, and since disk space is cheap
>> these days, that's not so uncommon.
>> 
>> Duncan Murdoch
>> 
>>> 
>>> I'm aware of some existing efforts in overcoming the difficulty of
>>> calling R under Windows like the R batch files project
>>> (http://code.google.com/p/batchfiles/), but I believe this is better
>>> to be solved in R directly.
>>> 
>>> Thanks!
>>> 
>>> Regards,
>>> Yihui
>>> --
>>> Yihui Xie<xieyihui at gmail.com>
>>> Phone: 515-294-2465 Web: http://yihui.name
>>> Department of Statistics, Iowa State University
>>> 2215 Snedecor Hall, Ames, IA
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From xie at yihui.name  Wed May  4 06:00:16 2011
From: xie at yihui.name (Yihui Xie)
Date: Tue, 3 May 2011 23:00:16 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <71E311C8-378A-45CA-864C-BA80C45853E8@r-project.org>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<71E311C8-378A-45CA-864C-BA80C45853E8@r-project.org>
Message-ID: <BANLkTikVqfgza_E=U-B1U90AkPCJbSm0qQ@mail.gmail.com>

Well, it seems I still have not make myself clear enough: I myself do
not have any questions here -- I know all the solutions, and I just do
not want to (1) explain to people again and again what is the PATH
variable under Windows (2) have to think where is R when I want to run
R as a command.

So you all believe Windows people had better double click the shortcut
on the desktop and work from that RGui? e.g. use Sweave() instead of R
CMD Sweave?

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Tue, May 3, 2011 at 10:41 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On May 3, 2011, at 11:25 PM, Yihui Xie wrote:
>
>> 1. "Few Windows users use these commands" does not imply they are not
>> useful, and I have no idea how many Windows users really use them. How
>> do you run "R CMD build" when you build R packages under Windows? You
>> don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
>> you?
>>
>
> Yes, of course. It's the safest way and really easy if you use a decent manager (I hope you're not typing your packages tar ball names by hand, either). Adding things to PATH on Windows (unlike unix) has the unwanted consequence that all hell breaks loose due to PATH overriding DLL locations so you really don't want to mess with it.
>
>
>> I think the reason we have to mess with the PATH variable for each
>> single software package is that Windows is Not Unix, so you may hate
>> Windows instead of a package that modifies your PATH variable.
>>
>> For the choice of i386 and x64, you can let the user decide which bin
>> path to use. I believe the number of users who frequently switch back
>> and forth is fairly small.
>>
>> 2. Under most circumstances I just keep the latest version of R. To
>> maintain R code with old R versions will be more and more difficult
>> with new features and changes coming in. Disk space is cheap, but time
>> is not.
>>
>> I'm talking about the default installation directory here and I'm only
>> wishing that the version string could be removed by default.
>>
>
> It can be already now, so I really have no idea what you're complaining about. If that's what you want, drop the the version and keep the one unversioned directory in your PATH and Bob's your uncle.
>
> Cheers,
> Simon
>
>
>
>> Anyway, I think I will go to the batch files approach if these
>> suggestions are going to be turned down. I just don't want to tell
>> other people to run Rscript.bat under Windows and Rscript under *nix.
>> I hope they can be consistent.
>>
>> Regards,
>> Yihui
>> --
>> Yihui Xie <xieyihui at gmail.com>
>> Phone: 515-294-2465 Web: http://yihui.name
>> Department of Statistics, Iowa State University
>> 2215 Snedecor Hall, Ames, IA
>>
>>
>>
>> On Tue, May 3, 2011 at 8:14 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> On 03/05/2011 7:44 PM, Yihui Xie wrote:
>>>>
>>>> Hi,
>>>>
>>>> I guess this issue must have been brought forward long time ago, but I
>>>> still hope you can consider under Windows (during installation):
>>>>
>>>> 1. put R's bin path in the PATH variable of the system so that we can
>>>> use the commands "R" and "Rscript" more easily;
>>>
>>> Few Windows users use those commands. ?The ones who do are generally exactly
>>> the ones who know how to edit the PATH variable themselves.
>>>
>>> For most users (the ones who start R from the shortcut), there's no need to
>>> mess with the PATH variable. ?Personally, I hate programs that do that. ?And
>>> with R, it's now complicated, because there are 2 different directories
>>> holding executables: ?bin/i386 and bin/x64. ?(The bin directory also holds
>>> some, but that's just for back ?compatibility.)
>>> How could the installer know which of those to put in the PATH? ?At
>>> installation time, a user isn't going to know which one he/she needs.
>>>
>>>> 2. remove the version string like R-2.13.0 in the default installation
>>>> directory, e.g. only use a directory like C:/Program Files/R/ instead
>>>> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
>>>> default setting when installing R, and this version string will often
>>>> lead to many (unnecessary) copies of R in the system and brings
>>>> difficulty to the first issue (several possible bin directories);
>>>
>>> Multiple installs give you the possibility of reproducing things that don't
>>> work in the latest R version. ?I think it's a good practice to keep multiple
>>> installs on your system if you have the space, and since disk space is cheap
>>> these days, that's not so uncommon.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> I'm aware of some existing efforts in overcoming the difficulty of
>>>> calling R under Windows like the R batch files project
>>>> (http://code.google.com/p/batchfiles/), but I believe this is better
>>>> to be solved in R directly.
>>>>
>>>> Thanks!
>>>>
>>>> Regards,
>>>> Yihui
>>>> --
>>>> Yihui Xie<xieyihui at gmail.com>
>>>> Phone: 515-294-2465 Web: http://yihui.name
>>>> Department of Statistics, Iowa State University
>>>> 2215 Snedecor Hall, Ames, IA
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
>


From ggrothendieck at gmail.com  Wed May  4 06:41:15 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 00:41:15 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
Message-ID: <BANLkTinA=r_qGjX4SkysRbDL7VEQruvSdg@mail.gmail.com>

On Tue, May 3, 2011 at 7:44 PM, Yihui Xie <xie at yihui.name> wrote:
> Hi,
>
> I guess this issue must have been brought forward long time ago, but I
> still hope you can consider under Windows (during installation):
>
> 1. put R's bin path in the PATH variable of the system so that we can
> use the commands "R" and "Rscript" more easily;
>
> 2. remove the version string like R-2.13.0 in the default installation
> directory, e.g. only use a directory like C:/Program Files/R/ instead
> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
> default setting when installing R, and this version string will often
> lead to many (unnecessary) copies of R in the system and brings
> difficulty to the first issue (several possible bin directories);
>
> I'm aware of some existing efforts in overcoming the difficulty of
> calling R under Windows like the R batch files project
> (http://code.google.com/p/batchfiles/), but I believe this is better
> to be solved in R directly.
>

Although I have some misgivings about this just to be sure we have all
based covered I have placed an R package called cmd in the batchfiles
download area (go to http://batchfiles.googlecode.com and click on
download tab).

Install the package and then every time you wish to use R.exe,
Rscript.exe, etc. start up R and run

library(cmd)
cmd32() # or cmd64()

and it will spawn a Windows console session with the appropriate path
variable set.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From xie at yihui.name  Wed May  4 07:04:04 2011
From: xie at yihui.name (Yihui Xie)
Date: Wed, 4 May 2011 00:04:04 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTinA=r_qGjX4SkysRbDL7VEQruvSdg@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<BANLkTinA=r_qGjX4SkysRbDL7VEQruvSdg@mail.gmail.com>
Message-ID: <BANLkTim=c4F=XGnuxgFxuB3xc=LkL5Y=mQ@mail.gmail.com>

Thanks! But I'm sorry this is not what I wanted. I just hope we can
call R as a command like we do under *nix -- this will make it easier
for *other* software packages to find R.

BTW, for the cmd package: if we were "evil" enough, we can directly
execute this in R to permanently set the PATH variable:

  system(paste('setx PATH "', normalizePath(R.home('bin')), ';',
Sys.getenv('PATH'), '"', sep = ''))

Nobody will feel comfortable with it, though.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Tue, May 3, 2011 at 11:41 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:

>
> Although I have some misgivings about this just to be sure we have all
> based covered I have placed an R package called cmd in the batchfiles
> download area (go to http://batchfiles.googlecode.com and click on
> download tab).
>
> Install the package and then every time you wish to use R.exe,
> Rscript.exe, etc. start up R and run
>
> library(cmd)
> cmd32() # or cmd64()
>
> and it will spawn a Windows console session with the appropriate path
> variable set.
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>


From tlumley at uw.edu  Wed May  4 07:26:54 2011
From: tlumley at uw.edu (Thomas Lumley)
Date: Wed, 4 May 2011 17:26:54 +1200
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
Message-ID: <BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>

On Wed, May 4, 2011 at 3:25 PM, Yihui Xie <xie at yihui.name> wrote:
> 1. "Few Windows users use these commands" does not imply they are not
> useful, and I have no idea how many Windows users really use them. How
> do you run "R CMD build" when you build R packages under Windows? You
> don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
> you?
>
> I think the reason we have to mess with the PATH variable for each
> single software package is that Windows is Not Unix, so you may hate
> Windows instead of a package that modifies your PATH variable.
>
> For the choice of i386 and x64, you can let the user decide which bin
> path to use. I believe the number of users who frequently switch back
> and forth is fairly small.
>
> 2. Under most circumstances I just keep the latest version of R. To
> maintain R code with old R versions will be more and more difficult
> with new features and changes coming in. Disk space is cheap, but time
> is not.
>

I keep old versions for basically the same reasons you don't -- that
is, I have analyses that ran under the old versions, and I can be sure
they will give the same answer a year later if I keep the old
versions. This isn't so much because of changes in R as because of
changes in packages.

   -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From ggrothendieck at gmail.com  Wed May  4 07:28:10 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 01:28:10 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTim=c4F=XGnuxgFxuB3xc=LkL5Y=mQ@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<BANLkTinA=r_qGjX4SkysRbDL7VEQruvSdg@mail.gmail.com>
	<BANLkTim=c4F=XGnuxgFxuB3xc=LkL5Y=mQ@mail.gmail.com>
Message-ID: <BANLkTikfu0WhJUmN2RddB9pOT-2jdQPm-A@mail.gmail.com>

On Wed, May 4, 2011 at 1:04 AM, Yihui Xie <xie at yihui.name> wrote:
> Thanks! But I'm sorry this is not what I wanted. I just hope we can
> call R as a command like we do under *nix -- this will make it easier
> for *other* software packages to find R.

You asked for an R program that gives the ability to run R.exe,
Rscript.exe, etc. from the command line and that indeed is what it
enables in the spawned session.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ronggui.huang at gmail.com  Wed May  4 07:46:13 2011
From: ronggui.huang at gmail.com (Wincent)
Date: Wed, 4 May 2011 13:46:13 +0800
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
Message-ID: <BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>

I also prefer to keep the old versions.

Sometimes, I have spent time to set up the system with older version
and don't want to update to the latest (e.g. the new RGtk2 needs
updated GTk2 as well) because the older still works and I don't need
the new features.

Regards
Ronggui

On 4 May 2011 13:26, Thomas Lumley <tlumley at uw.edu> wrote:
> On Wed, May 4, 2011 at 3:25 PM, Yihui Xie <xie at yihui.name> wrote:
>> 1. "Few Windows users use these commands" does not imply they are not
>> useful, and I have no idea how many Windows users really use them. How
>> do you run "R CMD build" when you build R packages under Windows? You
>> don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
>> you?
>>
>> I think the reason we have to mess with the PATH variable for each
>> single software package is that Windows is Not Unix, so you may hate
>> Windows instead of a package that modifies your PATH variable.
>>
>> For the choice of i386 and x64, you can let the user decide which bin
>> path to use. I believe the number of users who frequently switch back
>> and forth is fairly small.
>>
>> 2. Under most circumstances I just keep the latest version of R. To
>> maintain R code with old R versions will be more and more difficult
>> with new features and changes coming in. Disk space is cheap, but time
>> is not.
>>
>
> I keep old versions for basically the same reasons you don't -- that
> is, I have analyses that ran under the old versions, and I can be sure
> they will give the same answer a year later if I keep the old
> versions. This isn't so much because of changes in R as because of
> changes in packages.
>
> ? -thomas
>
> --
> Thomas Lumley
> Professor of Biostatistics
> University of Auckland
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Wincent Ronggui HUANG
Sociology Department of Fudan University
PhD of City University of Hong Kong
http://asrr.r-forge.r-project.org/rghuang.html


From maechler at stat.math.ethz.ch  Wed May  4 09:02:20 2011
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 4 May 2011 09:02:20 +0200
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
Message-ID: <19904.63996.415478.695901@stat.math.ethz.ch>

>>>>> Wincent  <ronggui.huang at gmail.com>
>>>>>     on Wed, 4 May 2011 13:46:13 +0800 writes:

    > I also prefer to keep the old versions.  Sometimes, I have
    > spent time to set up the system with older version and
    > don't want to update to the latest (e.g. the new RGtk2
    > needs updated GTk2 as well) because the older still works
    > and I don't need the new features.

Well....  Thomas gave good reasons to keep old versions of R
*IN ADDITION* to the latest R version.
Exactly *because* that is so easy, it makes very much sense to
update to the newest version:

Use the latest R, and if you really have doubts, quickly run the
same R code in the older R version that is still available.

Note to Yihui Xie:  I agree 100% with the other R core members 
(Duncan, Simon, Thomas) who already explained why it is *GOOD*
to install R in version-named directories by default.

BTW: If you use ESS (Emacs Speaks Statistics) on Windows,
it now automatically(*) finds all versions of R
(* well, less generally, probably than Gabor's batch files; IIRC,
 we assume that the R versions were installed in the default place),
and provides them, both the 32bit and 64bit versions, in the ESS
menu, or via 
  M-x R- [Tab completion]
Very nice, very useful in my eyes.

Martin 

    > Regards Ronggui

    > On 4 May 2011 13:26, Thomas Lumley <tlumley at uw.edu> wrote:
    >> On Wed, May 4, 2011 at 3:25 PM, Yihui Xie
    >> <xie at yihui.name> wrote:
    >>> 1. "Few Windows users use these commands" does not imply
    >>> they are not useful, and I have no idea how many Windows
    >>> users really use them. How do you run "R CMD build" when
    >>> you build R packages under Windows? You don't write
    >>> "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build",
    >>> do you?
    >>> 
    >>> I think the reason we have to mess with the PATH
    >>> variable for each single software package is that
    >>> Windows is Not Unix, so you may hate Windows instead of
    >>> a package that modifies your PATH variable.
    >>> 
    >>> For the choice of i386 and x64, you can let the user
    >>> decide which bin path to use. I believe the number of
    >>> users who frequently switch back and forth is fairly
    >>> small.
    >>> 
    >>> 2. Under most circumstances I just keep the latest
    >>> version of R. To maintain R code with old R versions
    >>> will be more and more difficult with new features and
    >>> changes coming in. Disk space is cheap, but time is not.
    >>> 
    >> 
> I keep old versions for basically the same reasons you don't
    >> -- that is, I have analyses that ran under the old
    >> versions, and I can be sure they will give the same
    >> answer a year later if I keep the old versions. This
    >> isn't so much because of changes in R as because of
    >> changes in packages.
    >> 
    >> ? -thomas
    >> 
    >> --
    >> Thomas Lumley Professor of Biostatistics University of
    >> Auckland
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 



-- 
Wincent Ronggui HUANG
    > Sociology Department of Fudan University PhD of City
    > University of Hong Kong
    > http://asrr.r-forge.r-project.org/rghuang.html

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Wed May  4 09:44:14 2011
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 4 May 2011 09:44:14 +0200
Subject: [Rd] R CMD check and Suggests Packages
In-Reply-To: <20110504100007.BLQ63940@gimr.garvan.unsw.edu.au>
References: <20110504100007.BLQ63940@gimr.garvan.unsw.edu.au>
Message-ID: <19905.974.420336.422465@stat.math.ethz.ch>

>>>>> Dario Strbenac <D.Strbenac at garvan.org.au>
>>>>>     on Wed, 4 May 2011 10:00:07 +1000 writes:

    > Hello,
    >> If Dario really uses R 2.13.0 (or newer),
    >> and he gets the above error message for a package that is not
    >> required but only suggested,
    >> I think we'd need a clear, ideally simple,
    >> reproducible example, here.

    > I was able to reproduce it. I made a new package with package.skeleton(), then added Suggests: RepitoolsExamples to the DESCRIPTION file, and the result of check was :

    > * using log directory /home/darstr/testPackage.Rcheck
    > * using R version 2.13.0 (2011-04-13)
    > * using platform: x86_64-unknown-linux-gnu (64-bit)
    > * using session charset: UTF-8
    > * checking for file testPackage/DESCRIPTION ... OK
    > * checking extension type ... Package
    > * this is package testPackage version 1.0
    > * checking package dependencies ... ERROR
    > Package required but not available: RepitoolsExamples

Thank you, Dario.

For exactly this, I get the correct

* checking package dependencies ... NOTE
Vorgeschlagenes, aber nicht zur ?berpr?fung verf?gbares Paket: aPackageNotFoundTypically

(I changed the line in 'DESCRIPTION' to
----------------------------------------
Suggests: aPackageNotFoundTypically
----------------------------------------

which is exactly the 'de' translation for
the one I mentioned earlier in this thread:
      c(gettextf("Package suggested but not available for checking: %s", bad),
    
I'm appending the slightly modified version of your testPackage.tar.gz
which only gives one 'NOTE' (see above) and no warning in  
'R CMD check'...
......
aah .. but when I rerun it as "Joe Average" user, instead of
myself, I get your

* checking package dependencies ... ERROR
Package required but not available: aPackageNotFoundTypically

.... dig dig...
....
I see, it's because in a file I source in ~/.bashrc I have
   export _R_CHECK_FORCE_SUGGESTS_=false
which of course is what Brian and Simon alluded to when they
told you you could turn off the behavior ...

Ok, so we have finally converged....

I think I agree with Herv?: If a user has not set the
magic environment variable he should get an ERROR instead of a NOTE
but the error *message* should be the correct one.

Ok, so thanks to Dario and Herve for persevering...
Martin


From D.Strbenac at garvan.org.au  Wed May  4 10:00:10 2011
From: D.Strbenac at garvan.org.au (Dario Strbenac)
Date: Wed,  4 May 2011 18:00:10 +1000 (EST)
Subject: [Rd] R CMD check and Suggests Packages
In-Reply-To: <19905.974.420336.422465@stat.math.ethz.ch>
References: <20110504100007.BLQ63940@gimr.garvan.unsw.edu.au>
	<19905.974.420336.422465@stat.math.ethz.ch>
Message-ID: <20110504180010.BLQ75583@gimr.garvan.unsw.edu.au>

---- Original message ----
>Date: Wed, 4 May 2011 09:44:14 +0200
>From: Martin Maechler <maechler at stat.math.ethz.ch>  
>Subject: Re: [Rd] R CMD check and Suggests Packages  
>To: <D.Strbenac at garvan.org.au>
>Cc: Martin Maechler <maechler at stat.math.ethz.ch>, Herv? Pag?s <hpages at fhcrc.org>, <r-devel at r-project.org>

>   export _R_CHECK_FORCE_SUGGESTS_=false

Curiously, that option isn't found in the current R-exts manual, but is clearly described in a search engine result to a page of the archived 2.5.0 (2007-04-23) version of the R-exts manual (http://pinard.progiciels-bpi.ca/libR/doc/manual/R-exts.html).

From murdoch.duncan at gmail.com  Wed May  4 14:11:39 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 04 May 2011 08:11:39 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
Message-ID: <4DC1427B.40507@gmail.com>

On 11-05-03 11:25 PM, Yihui Xie wrote:
> 1. "Few Windows users use these commands" does not imply they are not
> useful, and I have no idea how many Windows users really use them. How
> do you run "R CMD build" when you build R packages under Windows? You
> don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
> you?

I have unusual needs, because I use 2 or 3 different versions of R every 
day.  But if you're interested, the way I do it is to set up shell 
commands that reset the PATH appropriate to the version of R I want to 
use.

A more usual user who always wants to use just one version from the 
command line could modify the PATH appropriately.  I don't object to 
that, I just object to having R do it to unsuspecting users, because as 
Simon said, messing with the PATH can cause problems, and it's difficult 
for the R installer to know if messing with yours will cause trouble for 
you.

In another message you asked about using Sweave.  I almost never use 
Sweave() in R or "R CMD Sweave" at the command line; I have an 
appropriate command configured into my editors, and I run it from there. 
  The PATH does not need to be involved.


> I think the reason we have to mess with the PATH variable for each
> single software package is that Windows is Not Unix, so you may hate
> Windows instead of a package that modifies your PATH variable.
>
> For the choice of i386 and x64, you can let the user decide which bin
> path to use. I believe the number of users who frequently switch back
> and forth is fairly small.

I already pointed out why that is inappropriate for a lot of users.

Duncan Murdoch

>
> 2. Under most circumstances I just keep the latest version of R. To
> maintain R code with old R versions will be more and more difficult
> with new features and changes coming in. Disk space is cheap, but time
> is not.
>
> I'm talking about the default installation directory here and I'm only
> wishing that the version string could be removed by default.
>
> Anyway, I think I will go to the batch files approach if these
> suggestions are going to be turned down. I just don't want to tell
> other people to run Rscript.bat under Windows and Rscript under *nix.
> I hope they can be consistent.
>
> Regards,
> Yihui
> --
> Yihui Xie<xieyihui at gmail.com>
> Phone: 515-294-2465 Web: http://yihui.name
> Department of Statistics, Iowa State University
> 2215 Snedecor Hall, Ames, IA
>
>
>
> On Tue, May 3, 2011 at 8:14 PM, Duncan Murdoch<murdoch.duncan at gmail.com>  wrote:
>> On 03/05/2011 7:44 PM, Yihui Xie wrote:
>>>
>>> Hi,
>>>
>>> I guess this issue must have been brought forward long time ago, but I
>>> still hope you can consider under Windows (during installation):
>>>
>>> 1. put R's bin path in the PATH variable of the system so that we can
>>> use the commands "R" and "Rscript" more easily;
>>
>> Few Windows users use those commands.  The ones who do are generally exactly
>> the ones who know how to edit the PATH variable themselves.
>>
>> For most users (the ones who start R from the shortcut), there's no need to
>> mess with the PATH variable.  Personally, I hate programs that do that.  And
>> with R, it's now complicated, because there are 2 different directories
>> holding executables:  bin/i386 and bin/x64.  (The bin directory also holds
>> some, but that's just for back  compatibility.)
>> How could the installer know which of those to put in the PATH?  At
>> installation time, a user isn't going to know which one he/she needs.
>>
>>> 2. remove the version string like R-2.13.0 in the default installation
>>> directory, e.g. only use a directory like C:/Program Files/R/ instead
>>> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
>>> default setting when installing R, and this version string will often
>>> lead to many (unnecessary) copies of R in the system and brings
>>> difficulty to the first issue (several possible bin directories);
>>
>> Multiple installs give you the possibility of reproducing things that don't
>> work in the latest R version.  I think it's a good practice to keep multiple
>> installs on your system if you have the space, and since disk space is cheap
>> these days, that's not so uncommon.
>>
>> Duncan Murdoch
>>
>>>
>>> I'm aware of some existing efforts in overcoming the difficulty of
>>> calling R under Windows like the R batch files project
>>> (http://code.google.com/p/batchfiles/), but I believe this is better
>>> to be solved in R directly.
>>>
>>> Thanks!
>>>
>>> Regards,
>>> Yihui
>>> --
>>> Yihui Xie<xieyihui at gmail.com>
>>> Phone: 515-294-2465 Web: http://yihui.name
>>> Department of Statistics, Iowa State University
>>> 2215 Snedecor Hall, Ames, IA
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


From hadley at rice.edu  Wed May  4 14:26:24 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 07:26:24 -0500
Subject: [Rd] Recursive objects
Message-ID: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>

Hi all,

Does anyone have a comprehensive list of recursive-type objects in R?
is.recursive defines them as by exclusion: "most types of objects are
regarded as recursive, except for  vector types, ?NULL? and symbols
(as given by ?as.name?)."  I think this that means recursive objects
are:

 * lists
 * pairlists
 * calls
 * expressions

Did I miss anything?

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From Frank.Technow at uni-hohenheim.de  Wed May  4 10:49:28 2011
From: Frank.Technow at uni-hohenheim.de (Frank Technow)
Date: Wed, 04 May 2011 10:49:28 +0200
Subject: [Rd] proposal for package that creates the isomarginal family of
 two-way contingency tables
Message-ID: <4DC11318.4040403@uni-hohenheim.de>

Hello,

I developed R code to create the isomarginal family of two-way 
contingency tables.
The isomarginal family are all possible tables given fixed margins. It 
is needed for computing exact test statistics for two-way contingency 
tables in frequentist statistics. I need it for computing a 
normalization constant in a Bayesian model.

I think my code can be useful for others as well so I would like to 
publish it as a package, but only if it is not implemented yet. I know 
that there is the function "r2dtable" in "base", but it creates the 
tables randomly, so that some members of the family appear many times, 
some others not at all (exept n is extremely large). Then there is the 
function "permatfull" in package "vegan", but it apparently just uses 
"r2dtable" (from the documentation).


Currently my code covers only the case where the number of rows is fixed 
to two (with arbitrary number of columns). This makes the implementation 
allot easier, but is of course a limitation.

However, most two-way table problems have a structure with multiple 
categories in one margin but a binary variable in the other. For example 
survival yes or no, sex female or male, or in my field, plant genomics, 
where most of the data is from homozygous lines, genotype AA or BB.

To state my question: Is the code worth publishing?


My code is based on the algorithm in:

Greslin (2003)
Counting and enumerating frequency tables with given margins
Statistica & Applicazioni


I would also be interested in suggestions on how to test it.

For now I used:

unique(r2dtable(n,r,c))

as a reference, but to create the whole family in this way requires a 
huge "n", even for tables of modest dimensions and counts. For example: 
the family of a table with dimensions 2x5,
"r = c(8,100)" and "c = c(1,2,2,98,5)", "r" and "c" being the row and 
column margins, has 103 members (from my code). Trying to find it with:

unique(r2dtable(n,r,c))

eats up more than 16Gb of memory!

Thanks in advance,

Frank











-- 
Frank Technow
University of Hohenheim
350 Institute of Plant Breeding, Seed Sciences, and Population Genetics
70593 Stuttgart/Germany
Phone: 0049 711 459 23544
e-mail: Frank.Technow at uni-hohenheim.de or Frank.Technow at gmx.net


From vioravis at gmail.com  Wed May  4 14:26:49 2011
From: vioravis at gmail.com (vioravis)
Date: Wed, 4 May 2011 05:26:49 -0700 (PDT)
Subject: [Rd] Error in .Fortran Call
Message-ID: <1304512008660-3495319.post@n4.nabble.com>

I have the following FORTRAN code converted to a DLL:

! my_xmean.f90
!
! FUNCTIONS/SUBROUTINES exported from my_function.dll:
! my_function - subroutine
!
subroutine my_xmean(X,N,XMEAN) 

! Expose subroutine my_function to users of this DLL
!
!DEC$ ATTRIBUTES DLLEXPORT,C,REFERENCE,ALIAS:'my_xmean_'::my_xmean 

! Body of my_function

DOUBLE PRECISION X(N)

XMEAN=0D0
DO J=1,N
XMEAN=XMEAN+X(J)
END DO
XMEAN=XMEAN/N
RETURN 
end subroutine my_xmean



When I call this DLL from R, it gets loaded properly but the values of XMEAN
calcualted are way off:


x <- 1:6

> .Fortran("my_xmean",as.double(X),as.integer(length(X)),double(1))

[[1]]
[1] 1 2 3 4 5 6

[[2]]
[1] 6

$xmean
[1] 5.336073e-315

Can someone please let me what is causing this huge difference??? Thank you.

Ravi



--
View this message in context: http://r.789695.n4.nabble.com/Error-in-Fortran-Call-tp3495319p3495319.html
Sent from the R devel mailing list archive at Nabble.com.


From lebatsnok at gmail.com  Wed May  4 14:35:57 2011
From: lebatsnok at gmail.com (Kenn Konstabel)
Date: Wed, 4 May 2011 15:35:57 +0300
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
Message-ID: <BANLkTinFth1CD5bQ9rHhGCdpprkpziEeOA@mail.gmail.com>

On Wed, May 4, 2011 at 3:26 PM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> Does anyone have a comprehensive list of recursive-type objects in R?
> is.recursive defines them as by exclusion: "most types of objects are
> regarded as recursive, except for ?vector types, ?NULL? and symbols
> (as given by ?as.name?)." ?I think this that means recursive objects
> are:
>
> ?* lists
> ?* pairlists
> ?* calls
> ?* expressions

is.recursive(environment())
# [1] TRUE

>
> Did I miss anything?
>
> Hadley
>
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Wed May  4 14:38:29 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 07:38:29 -0500
Subject: [Rd] Capturing the complete unevaluated expression corresponding to
 function (body + formals)
Message-ID: <BANLkTikYQ-E44a1bD3zVi75Y0cAfRooSsQ@mail.gmail.com>

Hi all,

Is there any way to capture the complete unevaluated expression
corresponding to a function?  I want the equivalent of

x <- quote(function(x) x = 3)

But captured after the function is created.  Body and formals each
captures a part, but is there a built in way to get the whole thing?

f <- function(x) x = 3
y <- call("function", formals(f), body(f), attr(f, "source"))
identical(x, y)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From PDalgd at gmail.com  Wed May  4 14:49:00 2011
From: PDalgd at gmail.com (peter dalgaard)
Date: Wed, 4 May 2011 14:49:00 +0200
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTinFth1CD5bQ9rHhGCdpprkpziEeOA@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<BANLkTinFth1CD5bQ9rHhGCdpprkpziEeOA@mail.gmail.com>
Message-ID: <A71FB14E-DCCD-4003-8790-F44CC7637B3B@gmail.com>


On May 4, 2011, at 14:35 , Kenn Konstabel wrote:

> On Wed, May 4, 2011 at 3:26 PM, Hadley Wickham <hadley at rice.edu> wrote:
>> Hi all,
>> 
>> Does anyone have a comprehensive list of recursive-type objects in R?
>> is.recursive defines them as by exclusion: "most types of objects are
>> regarded as recursive, except for  vector types, ?NULL? and symbols
>> (as given by ?as.name?)."  I think this that means recursive objects
>> are:
>> 
>>  * lists
>>  * pairlists
>>  * calls
>>  * expressions
> 
> is.recursive(environment())
> # [1] TRUE


Closures:

> is.recursive(ls)
[1] TRUE


> 
>> 
>> Did I miss anything?
>> 
>> Hadley
>> 
>> --
>> Assistant Professor / Dobelman Family Junior Chair
>> Department of Statistics / Rice University
>> http://had.co.nz/
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From hadley at rice.edu  Wed May  4 14:54:31 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 07:54:31 -0500
Subject: [Rd] Recursive objects
In-Reply-To: <A71FB14E-DCCD-4003-8790-F44CC7637B3B@gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<BANLkTinFth1CD5bQ9rHhGCdpprkpziEeOA@mail.gmail.com>
	<A71FB14E-DCCD-4003-8790-F44CC7637B3B@gmail.com>
Message-ID: <BANLkTinEQrVQeAr5pkfeZy-SQGMj1LF=Lg@mail.gmail.com>

Thanks to you both for reminding me about those important recursive objects!
Hadley

On Wed, May 4, 2011 at 7:49 AM, peter dalgaard <PDalgd at gmail.com> wrote:
>
> On May 4, 2011, at 14:35 , Kenn Konstabel wrote:
>
>> On Wed, May 4, 2011 at 3:26 PM, Hadley Wickham <hadley at rice.edu> wrote:
>>> Hi all,
>>>
>>> Does anyone have a comprehensive list of recursive-type objects in R?
>>> is.recursive defines them as by exclusion: "most types of objects are
>>> regarded as recursive, except for ?vector types, ?NULL? and symbols
>>> (as given by ?as.name?)." ?I think this that means recursive objects
>>> are:
>>>
>>> ?* lists
>>> ?* pairlists
>>> ?* calls
>>> ?* expressions
>>
>> is.recursive(environment())
>> # [1] TRUE
>
>
> Closures:
>
>> is.recursive(ls)
> [1] TRUE
>
>
>>
>>>
>>> Did I miss anything?
>>>
>>> Hadley
>>>
>>> --
>>> Assistant Professor / Dobelman Family Junior Chair
>>> Department of Statistics / Rice University
>>> http://had.co.nz/
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Peter Dalgaard
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk ?Priv: PDalgd at gmail.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From murdoch.duncan at gmail.com  Wed May  4 14:58:22 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 04 May 2011 08:58:22 -0400
Subject: [Rd] Error in .Fortran Call
In-Reply-To: <1304512008660-3495319.post@n4.nabble.com>
References: <1304512008660-3495319.post@n4.nabble.com>
Message-ID: <4DC14D6E.1000602@gmail.com>

On 04/05/2011 8:26 AM, vioravis wrote:
> I have the following FORTRAN code converted to a DLL:
>
> ! my_xmean.f90
> !
> ! FUNCTIONS/SUBROUTINES exported from my_function.dll:
> ! my_function - subroutine
> !
> subroutine my_xmean(X,N,XMEAN)
>
> ! Expose subroutine my_function to users of this DLL
> !
> !DEC$ ATTRIBUTES DLLEXPORT,C,REFERENCE,ALIAS:'my_xmean_'::my_xmean
>
> ! Body of my_function
>
> DOUBLE PRECISION X(N)
>
> XMEAN=0D0
> DO J=1,N
> XMEAN=XMEAN+X(J)
> END DO
> XMEAN=XMEAN/N
> RETURN
> end subroutine my_xmean
>
>
>
> When I call this DLL from R, it gets loaded properly but the values of XMEAN
> calcualted are way off:
>
>
> x<- 1:6
>
> >  .Fortran("my_xmean",as.double(X),as.integer(length(X)),double(1))
>
> [[1]]
> [1] 1 2 3 4 5 6
>
> [[2]]
> [1] 6
>
> $xmean
> [1] 5.336073e-315
>
> Can someone please let me what is causing this huge difference??? Thank you.

I don't see a declaration of its type in the Fortran code, so it 
probably defaulted to REAL, not DOUBLE PRECISION.

Duncan Murdoch


From sgiannerini at gmail.com  Wed May  4 15:00:13 2011
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Wed, 4 May 2011 15:00:13 +0200
Subject: [Rd] Error in .Fortran Call
In-Reply-To: <1304512008660-3495319.post@n4.nabble.com>
References: <1304512008660-3495319.post@n4.nabble.com>
Message-ID: <BANLkTikGtQrf-0p1adebABP94oHhLkc-yw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110504/f647b026/attachment.pl>

From luke-tierney at uiowa.edu  Wed May  4 15:06:13 2011
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Wed, 4 May 2011 08:06:13 -0500
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1105040752190.4973@luke-inspiron>

I never use is.recursive/is.atomic because the definition they use for
an object to be recursive doesn't usually coincide with what I am
interested in. (If you want to know what that definition is you can
look at the source code, coerce.c:1790.) In computing on the language I
would want one notion where pretty much only calls are recursive in
the sense of having componets that need to be recursed into (you can
see how that is handled in the byte code compiler which is in the
sources as a noweb file). At the internal level, for example in the
GC, _every_ object is recursive in the sence of needing to be checked
for pointers to other objects, because of the attribute field.

There have been discussions of this previeously -- you might search
the archive.

Best,

luke

On Wed, 4 May 2011, Hadley Wickham wrote:

> Hi all,
>
> Does anyone have a comprehensive list of recursive-type objects in R?
> is.recursive defines them as by exclusion: "most types of objects are
> regarded as recursive, except for  vector types, ?NULL? and symbols
> (as given by ?as.name?)."  I think this that means recursive objects
> are:
>
> * lists
> * pairlists
> * calls
> * expressions
>
> Did I miss anything?
>
> Hadley
>
>

-- 
Luke Tierney
Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From murdoch.duncan at gmail.com  Wed May  4 15:07:36 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 04 May 2011 09:07:36 -0400
Subject: [Rd] Capturing the complete unevaluated expression
 corresponding to function (body + formals)
In-Reply-To: <BANLkTikYQ-E44a1bD3zVi75Y0cAfRooSsQ@mail.gmail.com>
References: <BANLkTikYQ-E44a1bD3zVi75Y0cAfRooSsQ@mail.gmail.com>
Message-ID: <4DC14F98.7090303@gmail.com>

On 04/05/2011 8:38 AM, Hadley Wickham wrote:
> Hi all,
>
> Is there any way to capture the complete unevaluated expression
> corresponding to a function?  I want the equivalent of
>
> x<- quote(function(x) x = 3)
>
> But captured after the function is created.  Body and formals each
> captures a part, but is there a built in way to get the whole thing?

Internally, "function" is a function that produces a closure object.  
After you call it and the function is created, the inputs are gone, all 
you have is the result.  But you can reconstruct it as you did below, 
because "function" basically just glues the parts together (and adds an 
environment as well).

Duncan Murdoch
> f<- function(x) x = 3
> y<- call("function", formals(f), body(f), attr(f, "source"))
> identical(x, y)
>
> Hadley
>


From jon.clayden at gmail.com  Wed May  4 15:09:58 2011
From: jon.clayden at gmail.com (Jon Clayden)
Date: Wed, 4 May 2011 14:09:58 +0100
Subject: [Rd] General "nil" reference class object
Message-ID: <BANLkTik===MTEceVouu=P3v3yamC6T8U0w@mail.gmail.com>

Dear John and others,

I've been wondering about whether there's any way to indicate a "nil"
reference class object, which will represent "no value", and be tested
for, but not fail the internal type checking. NULL is the obvious
choice (or seems so to me), but can only be used if an explicit class
union is created:

> Foo <- setRefClass("Foo")
> Bar <- setRefClass("Bar", fields=list(foo="Foo"))
> Bar$new(foo=NULL)
Error in as(value, "Foo") :
  no method or default for coercing "NULL" to "Foo"
> setClassUnion("FooOrNull", c("Foo","NULL"))
[1] "FooOrNull"
> Bar <- setRefClass("Bar", fields=list(foo="FooOrNull"))
> Bar$new(foo=NULL)
An object of class "Bar"
<environment: 0x10392c4a0>
> is.null(Bar$new(foo=NULL)$foo)
[1] TRUE

Other languages allow things like "MyClass object = null", and it
seems to me that it would be helpful to have a value which will always
give TRUE for "is(object,<AnyReferenceClassName>)", but will
specifically indicate a nil reference. One possible ad-hoc solution is
to define the "empty" object of a base class to be "nil" (see below),
but it seems like it would be better to have a value specifically
designed for this purpose.

> nilObject <- Foo$new()
> is.nilObject <- function (x) identical(x,nilObject)
> Bar <- setRefClass("Bar", fields=list(foo="Foo"), methods=list(
+ initialize=function (foo=nilObject) { initFields(foo=foo) }))
> is.nilObject(Bar$new()$foo)
[1] TRUE

Is there already something like this that I'm not aware of? If not,
would it be possible and generally desirable to create it?

All the best,
Jon


--
Jonathan D Clayden, PhD
Lecturer in Neuroimaging and Biophysics
Imaging and Biophysics Unit
UCL Institute of Child Health
30 Guilford Street
LONDON  WC1N 1EH
United Kingdom


From hadley at rice.edu  Wed May  4 15:21:39 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 08:21:39 -0500
Subject: [Rd] Recursive objects
In-Reply-To: <alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
Message-ID: <BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>

> I never use is.recursive/is.atomic because the definition they use for
> an object to be recursive doesn't usually coincide with what I am
> interested in. (If you want to know what that definition is you can
> look at the source code, coerce.c:1790.) In computing on the language I
> would want one notion where pretty much only calls are recursive in
> the sense of having componets that need to be recursed into (you can
> see how that is handled in the byte code compiler which is in the
> sources as a noweb file). At the internal level, for example in the
> GC, _every_ object is recursive in the sence of needing to be checked
> for pointers to other objects, because of the attribute field.

Thanks Luke, I'll check those references out.

> There have been discussions of this previeously -- you might search
> the archive.

Any hints as to what to search for?

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From b.rowlingson at lancaster.ac.uk  Wed May  4 15:24:58 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 4 May 2011 14:24:58 +0100
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
	<BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>
Message-ID: <BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>

On Wed, May 4, 2011 at 2:21 PM, Hadley Wickham <hadley at rice.edu> wrote:

> Any hints as to what to search for?

 For recursive objects, search for recursive objects.

Barry


From hadley at rice.edu  Wed May  4 15:30:08 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 08:30:08 -0500
Subject: [Rd] Capturing the complete unevaluated expression
 corresponding to function (body + formals)
In-Reply-To: <4DC14F98.7090303@gmail.com>
References: <BANLkTikYQ-E44a1bD3zVi75Y0cAfRooSsQ@mail.gmail.com>
	<4DC14F98.7090303@gmail.com>
Message-ID: <BANLkTi=-ZMKHG1TrpDQBh=ZNozFZuLGvbA@mail.gmail.com>

On Wed, May 4, 2011 at 8:07 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 04/05/2011 8:38 AM, Hadley Wickham wrote:
>>
>> Hi all,
>>
>> Is there any way to capture the complete unevaluated expression
>> corresponding to a function? ?I want the equivalent of
>>
>> x<- quote(function(x) x = 3)
>>
>> But captured after the function is created. ?Body and formals each
>> captures a part, but is there a built in way to get the whole thing?
>
> Internally, "function" is a function that produces a closure object. ?After
> you call it and the function is created, the inputs are gone, all you have
> is the result. ?But you can reconstruct it as you did below, because
> "function" basically just glues the parts together (and adds an environment
> as well).

Ok, I was getting confused because it looks like deparse and print(f,
useSource = F) can print the whole thing. But looking at the source, I
see that they reconstruct the function from the formals and the body
too.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Wed May  4 15:34:43 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 08:34:43 -0500
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
	<BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>
	<BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
Message-ID: <BANLkTikaHfOtXBd8OLDHq15BEJo2BvQ8Hw@mail.gmail.com>

On Wed, May 4, 2011 at 8:24 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Wed, May 4, 2011 at 2:21 PM, Hadley Wickham <hadley at rice.edu> wrote:
>
>> Any hints as to what to search for?
>
> ?For recursive objects, search for recursive objects.

Well, I was hoping Luke was meaning discussions about computing on the
language more generally...

Searching for recursive objects (with an admittedly quick skimming on
titles), didn't seem to find anything relevant, except that it was me
who suggested the wording "Most types of objects are regarded as
recursive, except for atomic vector types, ?NULL? and symbols (as
given by ?as.name?)"

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From simon.urbanek at r-project.org  Wed May  4 15:37:58 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 4 May 2011 09:37:58 -0400
Subject: [Rd] R CMD check and Suggests Packages
In-Reply-To: <20110504180010.BLQ75583@gimr.garvan.unsw.edu.au>
References: <20110504100007.BLQ63940@gimr.garvan.unsw.edu.au>
	<19905.974.420336.422465@stat.math.ethz.ch>
	<20110504180010.BLQ75583@gimr.garvan.unsw.edu.au>
Message-ID: <B77E7D8F-8D10-4669-AF5B-BBC98E1F1307@r-project.org>

In current R it is described in R-ints instead:

http://r.research.att.com/man/R-ints.html#Tools

But don't ask me about the rationale. That said, you can search all manuals in Google by simply using

foo site:http://r.research.att.com/man/

where "foo" is your query

Cheers,
S




On May 4, 2011, at 4:00 AM, Dario Strbenac wrote:

> ---- Original message ----
>> Date: Wed, 4 May 2011 09:44:14 +0200
>> From: Martin Maechler <maechler at stat.math.ethz.ch>  
>> Subject: Re: [Rd] R CMD check and Suggests Packages  
>> To: <D.Strbenac at garvan.org.au>
>> Cc: Martin Maechler <maechler at stat.math.ethz.ch>, Herv? Pag?s <hpages at fhcrc.org>, <r-devel at r-project.org>
> 
>>  export _R_CHECK_FORCE_SUGGESTS_=false
> 
> Curiously, that option isn't found in the current R-exts manual, but is clearly described in a search engine result to a page of the archived 2.5.0 (2007-04-23) version of the R-exts manual (http://pinard.progiciels-bpi.ca/libR/doc/manual/R-exts.html).
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hadley at rice.edu  Wed May  4 16:29:21 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 09:29:21 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
Message-ID: <BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>

I thought I might bring this up again - it now seems like Curry would
be a natural fit with Reduce, Filter, Find, Map, Negate and Position.
Any chance we might see this in a future version of R?

Hadley

On Thu, Nov 1, 2007 at 2:00 PM, Byron Ellis <byron.ellis at gmail.com> wrote:
> Hi all (especially R-core) I suppose,
>
> With the introduction of the new functional programming functions into
> base I thought I'd ask for a Curry() function. I use a simple one that
> looks this:
>
> Curry = function(FUN,...) { .orig = list(...);function(...)
> do.call(FUN,c(.orig,list(...))) }
>
> This comes in really handy when using say, heatmap():
>
> heatmap(mydata,hclustfun=Curry(hclust,method="average"))
>
> or other functions where there are ... arguments, but it's not clear
> where they should end up.
>
> --
> Byron Ellis (byron.ellis at gmail.com)
> "Oook" -- The Librarian
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From ggrothendieck at gmail.com  Wed May  4 16:34:37 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 10:34:37 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <4DC1427B.40507@gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<4DC1427B.40507@gmail.com>
Message-ID: <BANLkTikeShcjDpy+tV487Ci0ocD8QhK-Kw@mail.gmail.com>

On Wed, May 4, 2011 at 8:11 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 11-05-03 11:25 PM, Yihui Xie wrote:
>>
>> 1. "Few Windows users use these commands" does not imply they are not
>> useful, and I have no idea how many Windows users really use them. How
>> do you run "R CMD build" when you build R packages under Windows? You
>> don't write "C:/Program Files/R/R-2.13.0/bin/i386/R.exe CMD build", do
>> you?
>
> I have unusual needs, because I use 2 or 3 different versions of R every
> day. ?But if you're interested, the way I do it is to set up shell commands
> that reset the PATH appropriate to the version of R I want to use.
>
> A more usual user who always wants to use just one version from the command
> line could modify the PATH appropriately. ?I don't object to that, I just
> object to having R do it to unsuspecting users, because as Simon said,
> messing with the PATH can cause problems, and it's difficult for the R
> installer to know if messing with yours will cause trouble for you.
>
> In another message you asked about using Sweave. ?I almost never use
> Sweave() in R or "R CMD Sweave" at the command line; I have an appropriate
> command configured into my editors, and I run it from there. ?The PATH does
> not need to be involved.
>
>
>> I think the reason we have to mess with the PATH variable for each
>> single software package is that Windows is Not Unix, so you may hate
>> Windows instead of a package that modifies your PATH variable.
>>
>> For the choice of i386 and x64, you can let the user decide which bin
>> path to use. I believe the number of users who frequently switch back
>> and forth is fairly small.
>
> I already pointed out why that is inappropriate for a lot of users.

The batchfiles handle this using Rversions.bat.  Without arguments it
lists the available R versions and with an argument it makes that the
current version of R so that Rgui.bat, R.bat, invoke that version.
Rversions.bat works by running the appropriate RSetReg.exe utility
(which is a utility that is included in every R distribution).

Of course if you just want to run a specific version of Rgui each
version has a separate icon on the desktop so one can select the
version of interest that way too.

I personally keep about half a dozen back versions of R for the
reasons others have mentioned and these would include one R-13.x
version, one R-12.x version, etc.  I literally use x in the name since
only the most recent version in any such series is stored. That is,
when a new R-2.13.x comes out I just install it over the existing
R-2.13.x:

 Directory of C:\Program Files\R

31/03/2010  02:37 PM    <DIR>          R-2.10.x
01/06/2010  01:03 PM    <DIR>          R-2.11.x
22/03/2011  03:25 PM    <DIR>          R-2.12.x
26/04/2011  01:45 PM    <DIR>          R-2.13.x



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From rvaradhan at jhmi.edu  Wed May  4 16:40:16 2011
From: rvaradhan at jhmi.edu (Ravi Varadhan)
Date: Wed, 4 May 2011 10:40:16 -0400
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
Message-ID: <79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>

I too would like this (being an Indian!).

Here is an example that came up just yesterday with regards to solving a quadrature problem using the "cubature" package.  The adaptIntegrate function does not allow additional arguments via ...

Uwe suggested a work around, but `Curry' would solve it nicely (and it also tastes better!):

Curry = function(FUN,...) { 
.orig = list(...)
function(...) do.call(FUN,c(.orig, list(...))) 
}

require(cubature)

f <- function(x, a) cos(2*pi*x*a)  # a simple test function

# this works
a <- 0.2
adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2)

# but this doesn't work
rm(a)
adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2, a=0.2)


# Use of Curry
adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)

Best,
Ravi.

-------------------------------------------------------
Ravi Varadhan, Ph.D.
Assistant Professor,
Division of Geriatric Medicine and Gerontology School of Medicine Johns Hopkins University

Ph. (410) 502-2619
email: rvaradhan at jhmi.edu


-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Hadley Wickham
Sent: Wednesday, May 04, 2011 10:29 AM
To: Byron Ellis
Cc: R Development Mailing List
Subject: Re: [Rd] Curry: proposed new functional programming, er, function.

I thought I might bring this up again - it now seems like Curry would
be a natural fit with Reduce, Filter, Find, Map, Negate and Position.
Any chance we might see this in a future version of R?

Hadley

On Thu, Nov 1, 2007 at 2:00 PM, Byron Ellis <byron.ellis at gmail.com> wrote:
> Hi all (especially R-core) I suppose,
>
> With the introduction of the new functional programming functions into
> base I thought I'd ask for a Curry() function. I use a simple one that
> looks this:
>
> Curry = function(FUN,...) { .orig = list(...);function(...)
> do.call(FUN,c(.orig,list(...))) }
>
> This comes in really handy when using say, heatmap():
>
> heatmap(mydata,hclustfun=Curry(hclust,method="average"))
>
> or other functions where there are ... arguments, but it's not clear
> where they should end up.
>
> --
> Byron Ellis (byron.ellis at gmail.com)
> "Oook" -- The Librarian
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From mdsumner at gmail.com  Wed May  4 16:53:37 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 5 May 2011 00:53:37 +1000
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
	<BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>
	<BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
Message-ID: <BANLkTimk8z03byMBv5ZKT0kS8AV7gSTL8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110505/f8cd50eb/attachment.pl>

From r.ted.byers at gmail.com  Wed May  4 16:53:11 2011
From: r.ted.byers at gmail.com (Ted Byers)
Date: Wed, 4 May 2011 10:53:11 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
	remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikeShcjDpy+tV487Ci0ocD8QhK-Kw@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<4DC1427B.40507@gmail.com>
	<BANLkTikeShcjDpy+tV487Ci0ocD8QhK-Kw@mail.gmail.com>
Message-ID: <065b01cc0a6a$fdd2bf00$f9783d00$@gmail.com>

> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of Gabor Grothendieck
> Sent: May-04-11 10:35 AM
> To: Duncan Murdoch
> Cc: R-devel
> Subject: Re: [Rd] Wishlist: write R's bin path to the PATH variable and
remove
> the version string in the installation dir under Windows
> 
> [snip]
> I personally keep about half a dozen back versions of R for the reasons
> others have mentioned and these would include one R-13.x version, one R-
> 12.x version, etc.  I literally use x in the name since only the most
recent
> version in any such series is stored. That is, when a new R-2.13.x comes
out I
> just install it over the existing
> R-2.13.x:
> 
>  Directory of C:\Program Files\R
> 
> 31/03/2010  02:37 PM    <DIR>          R-2.10.x
> 01/06/2010  01:03 PM    <DIR>          R-2.11.x
> 22/03/2011  03:25 PM    <DIR>          R-2.12.x
> 26/04/2011  01:45 PM    <DIR>          R-2.13.x
> 
> 
Do you keep  the RTools version specific to each version of R installed too?
If so, how do you manage that so that each version of R finds the right
version of RTools when it needs it?  

I don't use RTools much, but I need it to install some fo the packages I use
from source since there are no binary distributions for them (for 64 bit
Windows).  I don't typically keep any more than two versions of R on my
machine at any one time, but I don't remove an older version until I have
verified that my R scripts work fine in the latest release.  So usually
there is only one version on my machine, but there will be two for a short
while after a new release.  But, my normal practice, as I describe here,
would be disrupted if R's installer wrote R's bin path to my system path (in
fact, I hate that for any software I use, even though in some cases there's
no way to avoid it).

Thanks

Ted


From murdoch.duncan at gmail.com  Wed May  4 16:56:23 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 4 May 2011 10:56:23 -0400
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
Message-ID: <4DC16917.5090206@gmail.com>

On 04/05/2011 10:40 AM, Ravi Varadhan wrote:
> I too would like this (being an Indian!).
>
> Here is an example that came up just yesterday with regards to solving a quadrature problem using the "cubature" package.  The adaptIntegrate function does not allow additional arguments via ...
>
> Uwe suggested a work around, but `Curry' would solve it nicely (and it also tastes better!):
>
> Curry = function(FUN,...) {
> .orig = list(...)
> function(...) do.call(FUN,c(.orig, list(...)))
> }
>
> require(cubature)
>
> f<- function(x, a) cos(2*pi*x*a)  # a simple test function
>
> # this works
> a<- 0.2
> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2)
>
> # but this doesn't work
> rm(a)
> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2, a=0.2)
>
>
> # Use of Curry
> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)

Two objections:

1.  I don't see how that is preferable to

adaptIntegrate(function(x) f(x, a=0.2), lower=0, upper=2)

2.  There seems to be confusion about what currying means.  The 
Wikipedia page <http://en.wikipedia.org/wiki/Currying> indicates that 
the function Curry() defined above is really doing "partial function 
application", not currying.  I'm in no position to judge whether Byron 
got it right or Wikipedia did, but this suggests to me that the name 
"Curry" is inappropriate, since at least some people who know what 
currying is would not guess that it does what it does.

Duncan Murdoch

> Best,
> Ravi.
>
> -------------------------------------------------------
> Ravi Varadhan, Ph.D.
> Assistant Professor,
> Division of Geriatric Medicine and Gerontology School of Medicine Johns Hopkins University
>
> Ph. (410) 502-2619
> email: rvaradhan at jhmi.edu
>
>
> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Hadley Wickham
> Sent: Wednesday, May 04, 2011 10:29 AM
> To: Byron Ellis
> Cc: R Development Mailing List
> Subject: Re: [Rd] Curry: proposed new functional programming, er, function.
>
> I thought I might bring this up again - it now seems like Curry would
> be a natural fit with Reduce, Filter, Find, Map, Negate and Position.
> Any chance we might see this in a future version of R?
>
> Hadley
>
> On Thu, Nov 1, 2007 at 2:00 PM, Byron Ellis<byron.ellis at gmail.com>  wrote:
> >  Hi all (especially R-core) I suppose,
> >
> >  With the introduction of the new functional programming functions into
> >  base I thought I'd ask for a Curry() function. I use a simple one that
> >  looks this:
> >
> >  Curry = function(FUN,...) { .orig = list(...);function(...)
> >  do.call(FUN,c(.orig,list(...))) }
> >
> >  This comes in really handy when using say, heatmap():
> >
> >  heatmap(mydata,hclustfun=Curry(hclust,method="average"))
> >
> >  or other functions where there are ... arguments, but it's not clear
> >  where they should end up.
> >
> >  --
> >  Byron Ellis (byron.ellis at gmail.com)
> >  "Oook" -- The Librarian
> >
> >  ______________________________________________
> >  R-devel at r-project.org mailing list
> >  https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>
>
>


From ggrothendieck at gmail.com  Wed May  4 16:59:17 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 10:59:17 -0400
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
Message-ID: <BANLkTi=Nd7XEdr4GrOL_ULQchmnKq2stGg@mail.gmail.com>

On Wed, May 4, 2011 at 10:40 AM, Ravi Varadhan <rvaradhan at jhmi.edu> wrote:
> I too would like this (being an Indian!).
>
> Here is an example that came up just yesterday with regards to solving a quadrature problem using the "cubature" package. ?The adaptIntegrate function does not allow additional arguments via ...
>
> Uwe suggested a work around, but `Curry' would solve it nicely (and it also tastes better!):
>
> Curry = function(FUN,...) {
> .orig = list(...)
> function(...) do.call(FUN,c(.orig, list(...)))
> }
>
> require(cubature)
>
> f <- function(x, a) cos(2*pi*x*a) ?# a simple test function
>
> # this works
> a <- 0.2
> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2)
>
> # but this doesn't work
> rm(a)
> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2, a=0.2)
>
>
> # Use of Curry
> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)
>

Here is another approach. If we preface any function with gsubfn's fn$
then it will turn formulas (subject to certain rules to determine
which to pay attention to) into functions.

1. Here it is applied to the cubature example

> library(cubature)
> library(gsubfn)
Loading required package: proto
>
> fn$adaptIntegrate(~ f(x, 0.2), lower=0, upper=2)
$integral
[1] 0.4677446

$error
[1] 1.247382e-14

$functionEvaluations
[1] 15

$returnCode
[1] 0


2. and here is the heatmap example redone.  The example line is to
compute x so that the code is self contained:

library(gsubfn)
example(heatmap)

fn$heatmap(x, hclustfun = ~ hclust(x, method="average"))

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From luke-tierney at uiowa.edu  Wed May  4 17:14:26 2011
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Wed, 4 May 2011 10:14:26 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
Message-ID: <alpine.DEB.2.00.1105041012020.4973@luke-inspiron>

On Wed, 4 May 2011, Ravi Varadhan wrote:

> I too would like this (being an Indian!).

I would not.

> Here is an example that came up just yesterday with regards to solving a quadrature problem using the "cubature" package.  The adaptIntegrate function does not allow additional arguments via ...
>
> Uwe suggested a work around, but `Curry' would solve it nicely (and it also tastes better!):
>
> Curry = function(FUN,...) {
> .orig = list(...)
> function(...) do.call(FUN,c(.orig, list(...)))
> }

This has quite different behavior with respect to evaluation/lazy
evaluation than an analogous anonymous function. In addition, do.call
has some fairly strange aspect so it with respect to how it intereacts
with sys.xyz functions, and does not do what you want in many cases I
care about when quote = FALSE, as is the default.  Adding this would
create more problems than is solves.

> require(cubature)
>
> f <- function(x, a) cos(2*pi*x*a)  # a simple test function
>
> # this works
> a <- 0.2
> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2)

Yes -- as do a number of other variations.

> # but this doesn't work
> rm(a)
> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2, a=0.2)

Of course not -- why would anyone think it would?

>
>
> # Use of Curry
> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)

The _concept_ of currying is useful, and maybe more can be done to
provide guidance and education on how to do it, but adding a function
that sometimes works and somesimes does surprising things is not the
way to go.

Best,

luke

>
> Best,
> Ravi.
>
> -------------------------------------------------------
> Ravi Varadhan, Ph.D.
> Assistant Professor,
> Division of Geriatric Medicine and Gerontology School of Medicine Johns Hopkins University
>
> Ph. (410) 502-2619
> email: rvaradhan at jhmi.edu
>
>
> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Hadley Wickham
> Sent: Wednesday, May 04, 2011 10:29 AM
> To: Byron Ellis
> Cc: R Development Mailing List
> Subject: Re: [Rd] Curry: proposed new functional programming, er, function.
>
> I thought I might bring this up again - it now seems like Curry would
> be a natural fit with Reduce, Filter, Find, Map, Negate and Position.
> Any chance we might see this in a future version of R?
>
> Hadley
>
> On Thu, Nov 1, 2007 at 2:00 PM, Byron Ellis <byron.ellis at gmail.com> wrote:
>> Hi all (especially R-core) I suppose,
>>
>> With the introduction of the new functional programming functions into
>> base I thought I'd ask for a Curry() function. I use a simple one that
>> looks this:
>>
>> Curry = function(FUN,...) { .orig = list(...);function(...)
>> do.call(FUN,c(.orig,list(...))) }
>>
>> This comes in really handy when using say, heatmap():
>>
>> heatmap(mydata,hclustfun=Curry(hclust,method="average"))
>>
>> or other functions where there are ... arguments, but it's not clear
>> where they should end up.
>>
>> --
>> Byron Ellis (byron.ellis at gmail.com)
>> "Oook" -- The Librarian
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
>

-- 
Luke Tierney
Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From xie at yihui.name  Wed May  4 17:15:13 2011
From: xie at yihui.name (Yihui Xie)
Date: Wed, 4 May 2011 10:15:13 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikfu0WhJUmN2RddB9pOT-2jdQPm-A@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<BANLkTinA=r_qGjX4SkysRbDL7VEQruvSdg@mail.gmail.com>
	<BANLkTim=c4F=XGnuxgFxuB3xc=LkL5Y=mQ@mail.gmail.com>
	<BANLkTikfu0WhJUmN2RddB9pOT-2jdQPm-A@mail.gmail.com>
Message-ID: <BANLkTimmCKHUv82EUdTBuAqRa=XsiK=qoA@mail.gmail.com>

If I am already able to open R, there is no need to post the request
here. I want to be able to run R without knowing where it is from
another software package. Your batch files fit in this purpose, and
the only problem is it is a little bit slower since it takes time to
look for R in the system via several approaches.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Wed, May 4, 2011 at 12:28 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Wed, May 4, 2011 at 1:04 AM, Yihui Xie <xie at yihui.name> wrote:
>> Thanks! But I'm sorry this is not what I wanted. I just hope we can
>> call R as a command like we do under *nix -- this will make it easier
>> for *other* software packages to find R.
>
> You asked for an R program that gives the ability to run R.exe,
> Rscript.exe, etc. from the command line and that indeed is what it
> enables in the spawned session.
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>


From ggrothendieck at gmail.com  Wed May  4 17:21:50 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 11:21:50 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTimmCKHUv82EUdTBuAqRa=XsiK=qoA@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<BANLkTinA=r_qGjX4SkysRbDL7VEQruvSdg@mail.gmail.com>
	<BANLkTim=c4F=XGnuxgFxuB3xc=LkL5Y=mQ@mail.gmail.com>
	<BANLkTikfu0WhJUmN2RddB9pOT-2jdQPm-A@mail.gmail.com>
	<BANLkTimmCKHUv82EUdTBuAqRa=XsiK=qoA@mail.gmail.com>
Message-ID: <BANLkTimQ+EqitJoO6zsf=iT7XT56G5HtOQ@mail.gmail.com>

On Wed, May 4, 2011 at 11:15 AM, Yihui Xie <xie at yihui.name> wrote:
> If I am already able to open R, there is no need to post the request
> here. I want to be able to run R without knowing where it is from
> another software package. Your batch files fit in this purpose, and
> the only problem is it is a little bit slower since it takes time to
> look for R in the system via several approaches.
>

Not on my laptop (which is not particularly powerful).   Rgui.bat
brings up R nearly instantaneously.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From ggrothendieck at gmail.com  Wed May  4 17:27:24 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 11:27:24 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <065b01cc0a6a$fdd2bf00$f9783d00$@gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<4DC1427B.40507@gmail.com>
	<BANLkTikeShcjDpy+tV487Ci0ocD8QhK-Kw@mail.gmail.com>
	<065b01cc0a6a$fdd2bf00$f9783d00$@gmail.com>
Message-ID: <BANLkTi=f25vvkkxQhxpGmKZ59o==ihCdYA@mail.gmail.com>

On Wed, May 4, 2011 at 10:53 AM, Ted Byers <r.ted.byers at gmail.com> wrote:
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>> project.org] On Behalf Of Gabor Grothendieck
>> Sent: May-04-11 10:35 AM
>> To: Duncan Murdoch
>> Cc: R-devel
>> Subject: Re: [Rd] Wishlist: write R's bin path to the PATH variable and
> remove
>> the version string in the installation dir under Windows
>>
>> [snip]
>> I personally keep about half a dozen back versions of R for the reasons
>> others have mentioned and these would include one R-13.x version, one R-
>> 12.x version, etc. ?I literally use x in the name since only the most
> recent
>> version in any such series is stored. That is, when a new R-2.13.x comes
> out I
>> just install it over the existing
>> R-2.13.x:
>>
>> ?Directory of C:\Program Files\R
>>
>> 31/03/2010 02:37 PM ? ?<DIR> ? ? ? ? ?R-2.10.x
>> 01/06/2010 ?01:03 PM ? ?<DIR> ? ? ? ? ?R-2.11.x
>> 22/03/2011 ?03:25 PM ? ?<DIR> ? ? ? ? ?R-2.12.x
>> 26/04/2011 01:45 PM ? ?<DIR> ? ? ? ? ?R-2.13.x
>>
>>
> Do you keep ?the RTools version specific to each version of R installed too?
> If so, how do you manage that so that each version of R finds the right
> version of RTools when it needs it?
>
> I don't use RTools much, but I need it to install some fo the packages I use
> from source since there are no binary distributions for them (for 64 bit
> Windows). ?I don't typically keep any more than two versions of R on my
> machine at any one time, but I don't remove an older version until I have
> verified that my R scripts work fine in the latest release. ?So usually
> there is only one version on my machine, but there will be two for a short
> while after a new release. ?But, my normal practice, as I describe here,
> would be disrupted if R's installer wrote R's bin path to my system path (in
> fact, I hate that for any software I use, even though in some cases there's
> no way to avoid it).
>
> Thanks
>
> Ted
>
>

Typically I do my development on the latest version of R so I only
need one version of Rtools.  The older versions of R are just for
checking older software.  There is a program RtoolsVersion.bat in the
batchfiles that will tell you which  version of Rtools you have (which
it finds by first looking in the registry and if not found there looks
for an R_TOOLS environment variable and if still not found looks for
C:\Rtools):

C:\tmp2>RtoolsVersion
RtoolsVersion.bat: Rtools found at: c:\Rtools
Rtools version 2.13.0.1901

(There is also Rtools.bat that will temporarily add Rtools to your
path (although if you use Rcmd.bat, R.bat, etc. then they can find
Rtools without it being on the path so mostly one does not need to use
Rtools.bat).

If people wanted to have multiple versions of Rtools, Rtools would
ideally have a tool similar to R's own RSetReg.exe .  Another
possibility would be to turn Rtools into an R package so that R's
library mechanism handled the versioning.

Regarding permanently putting R on the path, I agree that it would be
annoying having R permanently there and for that reason the batchfiles
do not do that.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From xie at yihui.name  Wed May  4 17:38:55 2011
From: xie at yihui.name (Yihui Xie)
Date: Wed, 4 May 2011 10:38:55 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
Message-ID: <BANLkTinEstmnfdox0YwW5Vpqwcbu0vmSGA@mail.gmail.com>

In terms of a personal use, that is absolutely fine. From the
perspective of a developer, you cannot stop a user from upgrading to
newer versions. Perhaps it is a matter of personal taste; I'm worried
more about adapting to latest versions than maintaining old versions.
If the new versions works fine, I will remove all the old versions. I
have never run into troubles in which I have no choice but to use the
old version of R.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Wed, May 4, 2011 at 12:46 AM, Wincent <ronggui.huang at gmail.com> wrote:
> I also prefer to keep the old versions.
>
> Sometimes, I have spent time to set up the system with older version
> and don't want to update to the latest (e.g. the new RGtk2 needs
> updated GTk2 as well) because the older still works and I don't need
> the new features.
>
> Regards
> Ronggui
>


From Greg.Snow at imail.org  Wed May  4 17:46:40 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Wed, 4 May 2011 09:46:40 -0600
Subject: [Rd] tkrplot not working in R 2.13.0
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>

The tkrplot package is not working in version 2.13.0 for windows.  I contacted the maintainer who unfortunately does not have easy access to a windows computer and says that it is working on the other platforms.

I traced the problem down to the line in the .First.lib function:

.Tcl(paste("load", file, "Rplot"))

With file being "C:/Program Files/R/R-2.13.0/library/tkrplot/libs/i386/tkrplot.dll" on my system.  I did check that the file exists and it can even be loaded using dyn.load, but when running the .Tcl command by hand it produces the following error:

Error in structure(.External("dotTcl", ..., PACKAGE = "tcltk"), class = "tclObj") : 
  [tcl] could not find interpreter "Rplot".

It works in previous versions of R, so I am guessing that this is due to some change in R, or the tcl with R 2.13.0, or how tkrplot was compiled under the new R, or possibly something else.

Does anyone else have any insights?



> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] tcltk     stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] TeachingDemos_2.7 tkrplot_0.0-19   

loaded via a namespace (and not attached):
[1] tools_2.13.0

Thanks,

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


From hadley at rice.edu  Wed May  4 17:53:33 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 10:53:33 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <alpine.DEB.2.00.1105041012020.4973@luke-inspiron>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<alpine.DEB.2.00.1105041012020.4973@luke-inspiron>
Message-ID: <BANLkTinSwtgGKDPLxc6o6RmKOpP1zEv2VA@mail.gmail.com>

>> # Use of Curry
>> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)
>
> The _concept_ of currying is useful, and maybe more can be done to
> provide guidance and education on how to do it, but adding a function
> that sometimes works and somesimes does surprising things is not the
> way to go.

What about an alternative approach?

    Curry <- function(FUN, ...) {
      args <- match.call(expand.dots = FALSE)$...
      args$... <- as.name("...")

      curry_call <- as.call(c(list(as.name("FUN")), args))
      function(...) {
        eval(curry_call)
      }
    }

Or maybe

    Curry <- function(FUN, ...) {
      args <- match.call(expand.dots = FALSE)$...
      args$... <- as.name("...")

      curry_call <- as.call(c(list(as.name("FUN")), args))
      eval(bquote(function(...) .(curry_call)))
    }


I think this is pretty close to what you'd get if you made an
anonymous function (but I'm probably missing something)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Wed May  4 18:00:40 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 11:00:40 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <4DC16917.5090206@gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
Message-ID: <BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>

>> # Use of Curry
>> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)
>
> Two objections:
>
> 1. ?I don't see how that is preferable to
>
> adaptIntegrate(function(x) f(x, a=0.2), lower=0, upper=2)

It's less typing?

A more helpful use is when you have a list of functions:

    funs <- list(
      sum = sum,
      mean = mean,
      median = median
    )

with Curry function you can do :

    funs2 <- lapply(funs, Curry, na.rm = TRUE)

as opposed to

    funs2 <- list(
      sum = function(x, ...) sum(x, ..., na.rm = TRUE),
      mean = function(x, ...) mean(x, ..., na.rm = TRUE),
      median = function(x, ...) median(x, ..., na.rm = TRUE)
    )

> 2. ?There seems to be confusion about what currying means. ?The Wikipedia
> page <http://en.wikipedia.org/wiki/Currying> indicates that the function
> Curry() defined above is really doing "partial function application", not
> currying. ?I'm in no position to judge whether Byron got it right or
> Wikipedia did, but this suggests to me that the name "Curry" is
> inappropriate, since at least some people who know what currying is would
> not guess that it does what it does.

I'm not completely sure that discussion is canonical: wikipedia citing
a blog post does not a precedent make.  I agree the distinction is
sensible, but I think the partial function application sense of
currying is standard enough that it would cause much confusion. We are
not claiming that R has low-level currying, we're creating a function
to simulate a useful property of currying.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From xie at yihui.name  Wed May  4 18:00:55 2011
From: xie at yihui.name (Yihui Xie)
Date: Wed, 4 May 2011 11:00:55 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <19904.63996.415478.695901@stat.math.ethz.ch>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
	<19904.63996.415478.695901@stat.math.ethz.ch>
Message-ID: <BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>

My suggestion was to mimic *nix systems: put the executable binaries
in the same place *by default* (e.g. /usr/bin/ or /usr/local/bin). Why
isn't the default bin path for R under *nix something like
/usr/bin/R-2.13.0/? If the users want to install multiple versions,
they still have the choice to install them elsewhere. I'm not denying
the possible necessity of having multiple versions in a system. In my
opinion, the default values should be set according to probabilities:
is it more likely for a user to use multiple versions or a single
version of R? Of course, all of you are developers and the former
probability might be higher, but I don't think many users will run the
script A with R 2.12.1 and script B with R 2.13.0. The most typical
situation I have seen is, (Windows) people install R and will forget
to update it forever. I often have to urge our IT admin to update R in
our department from a version released long long ago. You may argue my
samples are not representative. Anyway, I can accept the default
version string if nobody agrees with me.

I do use Emacs every day. It's nice, I totally agree.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Wed, May 4, 2011 at 2:02 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> Note to Yihui Xie: ?I agree 100% with the other R core members
> (Duncan, Simon, Thomas) who already explained why it is *GOOD*
> to install R in version-named directories by default.
>
> BTW: If you use ESS (Emacs Speaks Statistics) on Windows,
> it now automatically(*) finds all versions of R
> (* well, less generally, probably than Gabor's batch files; IIRC,
> ?we assume that the R versions were installed in the default place),
> and provides them, both the 32bit and 64bit versions, in the ESS
> menu, or via
> ?M-x R- [Tab completion]
> Very nice, very useful in my eyes.
>
> Martin
>


From jmc at r-project.org  Wed May  4 18:17:35 2011
From: jmc at r-project.org (John Chambers)
Date: Wed, 04 May 2011 09:17:35 -0700
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <BANLkTik8K3kB-Y1-9jk+7HhPVdYA+=DW8w@mail.gmail.com>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org> <4DBDE093.5080300@fhcrc.org>
	<4DBDF900.1010601@r-project.org>
	<BANLkTik8K3kB-Y1-9jk+7HhPVdYA+=DW8w@mail.gmail.com>
Message-ID: <4DC17C1F.4050504@r-project.org>

On 5/3/11 2:39 PM, Hadley Wickham wrote:
>> Part of the motivation for the reference classes was to bring a general OOP
>> view to R.  One can start from some essential concepts of objects and their
>> properties, inheritance and class definition, as have evolved over a very
>> long time.
>>
>> Next, there is a fundamental choice of paradigm between "encapsulated" OOP
>> as the rest of the world knows it, and "functional" OOP as practiced by S
>> and R, and a few other languages.  While the two paradigms are quite
>> different, there is no need to view them as opposed.  They provide different
>> advantages and tend to suit different goals--very roughly, functional object
>> creation and reproducible results versus persistent objects whose properties
>> one would like to have evolve over time using their encapsulated methods.
>
> My biggest worry with the introduction of reference classes is that
> many people will just stick to the style of OOP that they're familiar
> with, and not bother to learn the strengths of the generic function
> approach.

Well, that says that presenting the choices well is important.  Agreed.

But the alternative is (and has been) for people from the "other" OOP 
background to hack something using the functional S4/S3 paradigm and 
then complain when it doesn't behave as expected. Not really preferable.

>
>> As these remarks may suggest, I'm trying to write up this perspective in
>> some detail.  To be continued ....
>
> Are you familiar with "Concepts, Techniques, and Models of Computer
> Programming" by van Roy and Haridi?  That's what really helped me to
> understand the strengths and weaknesses of the various styles of
> programming.

Thanks, I wasn't.  Yes, interesting similar distinction between 
functional and "type" decomposition.  An important associated aspect for 
us is the distinction between reference objects and "ordinary" R 
objects, not AFAICS conveyed by their more abstract treatment.

John
>
> Hadley
>


From hadley at rice.edu  Wed May  4 18:19:15 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 11:19:15 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <BANLkTinSwtgGKDPLxc6o6RmKOpP1zEv2VA@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<alpine.DEB.2.00.1105041012020.4973@luke-inspiron>
	<BANLkTinSwtgGKDPLxc6o6RmKOpP1zEv2VA@mail.gmail.com>
Message-ID: <BANLkTi=zr-eSQVu2mb2BG1axTBbSS0xx_g@mail.gmail.com>

> Or maybe
>
> ? ?Curry <- function(FUN, ...) {
> ? ? ?args <- match.call(expand.dots = FALSE)$...
> ? ? ?args$... <- as.name("...")
>
> ? ? ?curry_call <- as.call(c(list(as.name("FUN")), args))
> ? ? ?eval(bquote(function(...) .(curry_call)))
> ? ?}

Or one more approach:

    Curry <- function(FUN, ...) {
      args <- match.call(expand.dots = FALSE)$...
      args$... <- as.name("...")

      curry_call <- as.call(c(list(as.name("FUN")), args))
      eval(call("function", as.pairlist(alist(... = )), curry_call))
    }

I'm not sure if there's a canonical way of programmatically creating functions.

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Wed May  4 18:24:18 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 11:24:18 -0500
Subject: [Rd] Reference Classes: Accessing methods via [[...]], bug?
In-Reply-To: <4DC17C1F.4050504@r-project.org>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org> <4DBDE093.5080300@fhcrc.org>
	<4DBDF900.1010601@r-project.org>
	<BANLkTik8K3kB-Y1-9jk+7HhPVdYA+=DW8w@mail.gmail.com>
	<4DC17C1F.4050504@r-project.org>
Message-ID: <BANLkTimquWB+LNJtg_AjWGrbqx0Z+beaWQ@mail.gmail.com>

>> Are you familiar with "Concepts, Techniques, and Models of Computer
>> Programming" by van Roy and Haridi? ?That's what really helped me to
>> understand the strengths and weaknesses of the various styles of
>> programming.
>
> Thanks, I wasn't. ?Yes, interesting similar distinction between functional
> and "type" decomposition. ?An important associated aspect for us is the
> distinction between reference objects and "ordinary" R objects, not AFAICS
> conveyed by their more abstract treatment.

Another discussion I found useful was in SICP:
http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-17.html#%_sec_2.4.3

I really like the metaphor of method dispatch as a table with types in
the columns and operations in the rows - then you can think of generic
functions oo as being row-based, and class based oo as column-based.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From jmc at r-project.org  Wed May  4 18:27:57 2011
From: jmc at r-project.org (John Chambers)
Date: Wed, 04 May 2011 09:27:57 -0700
Subject: [Rd] General "nil" reference class object
In-Reply-To: <BANLkTik===MTEceVouu=P3v3yamC6T8U0w@mail.gmail.com>
References: <BANLkTik===MTEceVouu=P3v3yamC6T8U0w@mail.gmail.com>
Message-ID: <4DC17E8D.4020407@r-project.org>

Interesting idea.

One approach would be to test against the _environment_ of the prototype 
object in the class definition.  Since the initialize method for a 
reference class must call new.env(), one knows that a real object from 
the class has a different environment.  Using that fact one could have 
functions
   nullObject(Class)
to get the null, and
   isNullObject(x)
to test.

My feeling is that this approach is better for R than having one single 
nil object, because nullObject(Class) would still be a valid object from 
the class.

Something to mull over.
   John


On 5/4/11 6:09 AM, Jon Clayden wrote:
> Dear John and others,
>
> I've been wondering about whether there's any way to indicate a "nil"
> reference class object, which will represent "no value", and be tested
> for, but not fail the internal type checking. NULL is the obvious
> choice (or seems so to me), but can only be used if an explicit class
> union is created:
>
>> Foo<- setRefClass("Foo")
>> Bar<- setRefClass("Bar", fields=list(foo="Foo"))
>> Bar$new(foo=NULL)
> Error in as(value, "Foo") :
>    no method or default for coercing "NULL" to "Foo"
>> setClassUnion("FooOrNull", c("Foo","NULL"))
> [1] "FooOrNull"
>> Bar<- setRefClass("Bar", fields=list(foo="FooOrNull"))
>> Bar$new(foo=NULL)
> An object of class "Bar"
> <environment: 0x10392c4a0>
>> is.null(Bar$new(foo=NULL)$foo)
> [1] TRUE
>
> Other languages allow things like "MyClass object = null", and it
> seems to me that it would be helpful to have a value which will always
> give TRUE for "is(object,<AnyReferenceClassName>)", but will
> specifically indicate a nil reference. One possible ad-hoc solution is
> to define the "empty" object of a base class to be "nil" (see below),
> but it seems like it would be better to have a value specifically
> designed for this purpose.
>
>> nilObject<- Foo$new()
>> is.nilObject<- function (x) identical(x,nilObject)
>> Bar<- setRefClass("Bar", fields=list(foo="Foo"), methods=list(
> + initialize=function (foo=nilObject) { initFields(foo=foo) }))
>> is.nilObject(Bar$new()$foo)
> [1] TRUE
>
> Is there already something like this that I'm not aware of? If not,
> would it be possible and generally desirable to create it?
>
> All the best,
> Jon
>
>
> --
> Jonathan D Clayden, PhD
> Lecturer in Neuroimaging and Biophysics
> Imaging and Biophysics Unit
> UCL Institute of Child Health
> 30 Guilford Street
> LONDON  WC1N 1EH
> United Kingdom
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jmc at r-project.org  Wed May  4 18:35:24 2011
From: jmc at r-project.org (John Chambers)
Date: Wed, 04 May 2011 09:35:24 -0700
Subject: [Rd] Reference Classes: (Was:  Accessing methods via [[...]],
 bug?)
In-Reply-To: <BANLkTimquWB+LNJtg_AjWGrbqx0Z+beaWQ@mail.gmail.com>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org> <4DBDE093.5080300@fhcrc.org>
	<4DBDF900.1010601@r-project.org>
	<BANLkTik8K3kB-Y1-9jk+7HhPVdYA+=DW8w@mail.gmail.com>
	<4DC17C1F.4050504@r-project.org>
	<BANLkTimquWB+LNJtg_AjWGrbqx0Z+beaWQ@mail.gmail.com>
Message-ID: <4DC1804C.80706@r-project.org>

On 5/4/11 9:24 AM, Hadley Wickham wrote:
>>> Are you familiar with "Concepts, Techniques, and Models of Computer
>>> Programming" by van Roy and Haridi?  That's what really helped me to
>>> understand the strengths and weaknesses of the various styles of
>>> programming.
>>
>> Thanks, I wasn't.  Yes, interesting similar distinction between functional
>> and "type" decomposition.  An important associated aspect for us is the
>> distinction between reference objects and "ordinary" R objects, not AFAICS
>> conveyed by their more abstract treatment.
>
> Another discussion I found useful was in SICP:
> http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-17.html#%_sec_2.4.3
>
> I really like the metaphor of method dispatch as a table with types in
> the columns and operations in the rows - then you can think of generic
> functions oo as being row-based, and class based oo as column-based.

Except that functional method dispatch with multiple dispatch is 
dispatched on a K-tple of classes if the generic function has K 
arguments in its signature.

This is not a trivial distinction because it means that a method can 
depend on more than one class definition, so it's not just a matter of 
distributing the same information in different ways, but a fundamentally 
more complicated structure for functional OOP (for better and/or for worse).

John

>
> Hadley
>


From ripley at stats.ox.ac.uk  Wed May  4 18:34:59 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 4 May 2011 17:34:59 +0100 (BST)
Subject: [Rd] tkrplot not working in R 2.13.0
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <alpine.LFD.2.02.1105041727260.23753@auk.stats.ox.ac.uk>

What example are you trying? The code in ?trkplot works for me.

However, it looks to me like that piece of advice in the rw-FAQ about 
no spaces in your path has come back to bite you (I of course do not 
have such spaces).  I think this should be

.Tcl(paste("load", shQuote(file), "Rplot"))

or some such.

On Wed, 4 May 2011, Greg Snow wrote:

> The tkrplot package is not working in version 2.13.0 for windows.  I contacted the maintainer who unfortunately does not have easy access to a windows computer and says that it is working on the other platforms.
>
> I traced the problem down to the line in the .First.lib function:
>
> .Tcl(paste("load", file, "Rplot"))
>
> With file being "C:/Program Files/R/R-2.13.0/library/tkrplot/libs/i386/tkrplot.dll" on my system.  I did check that the file exists and it can even be loaded using dyn.load, but when running the .Tcl command by hand it produces the following error:
>
> Error in structure(.External("dotTcl", ..., PACKAGE = "tcltk"), class = "tclObj") :
>  [tcl] could not find interpreter "Rplot".
>
> It works in previous versions of R, so I am guessing that this is 
> due to some change in R, or the tcl with R 2.13.0, or how tkrplot 
> was compiled under the new R, or possibly something else.
>
> Does anyone else have any insights?
>
>
>
>> sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] TeachingDemos_2.7 tkrplot_0.0-19
>
> loaded via a namespace (and not attached):
> [1] tools_2.13.0
>
> Thanks,
>
> -- 
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ligges at statistik.tu-dortmund.de  Wed May  4 18:43:02 2011
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 04 May 2011 18:43:02 +0200
Subject: [Rd] tkrplot not working in R 2.13.0
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <4DC18216.8000304@statistik.tu-dortmund.de>



On 04.05.2011 17:46, Greg Snow wrote:
> The tkrplot package is not working in version 2.13.0 for windows.  I contacted the maintainer who unfortunately does not have easy access to a windows computer and says that it is working on the other platforms.

Greg,

if he had access (like I do) he'd said it works for him. At least it 
does for me (under Windows Server 2008 and XP) and it also passes the 
CRAN checks under Windows, see e.g.
http://www.r-project.org/nosvn/R.check/r-release-windows-ix86+x86_64/tkrplot-00check.html

You may want to elaborate why you think it does not work and provide us 
with what you typed in R and what the actual error message is.

Uwe Ligges



>
> I traced the problem down to the line in the .First.lib function:
>
> .Tcl(paste("load", file, "Rplot"))
>
> With file being "C:/Program Files/R/R-2.13.0/library/tkrplot/libs/i386/tkrplot.dll" on my system.  I did check that the file exists and it can even be loaded using dyn.load, but when running the .Tcl command by hand it produces the following error:
>
> Error in structure(.External("dotTcl", ..., PACKAGE = "tcltk"), class = "tclObj") :
>    [tcl] could not find interpreter "Rplot".
>
> It works in previous versions of R, so I am guessing that this is due to some change in R, or the tcl with R 2.13.0, or how tkrplot was compiled under the new R, or possibly something else.
>
> Does anyone else have any insights?
>
>
>
>> sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] TeachingDemos_2.7 tkrplot_0.0-19
>
> loaded via a namespace (and not attached):
> [1] tools_2.13.0
>
> Thanks,
>


From hadley at rice.edu  Wed May  4 18:50:25 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 4 May 2011 11:50:25 -0500
Subject: [Rd] Reference Classes: (Was: Accessing methods via [[...]],
	bug?)
In-Reply-To: <4DC1804C.80706@r-project.org>
References: <SNT131-w42BCCDD218A68509A634CFB99D0@phx.gbl>
	<BANLkTi=GvhhFmDT1=8sf0j6cM8Tsx3QJ9Q@mail.gmail.com>
	<4DBDDA21.3020809@r-project.org> <4DBDE093.5080300@fhcrc.org>
	<4DBDF900.1010601@r-project.org>
	<BANLkTik8K3kB-Y1-9jk+7HhPVdYA+=DW8w@mail.gmail.com>
	<4DC17C1F.4050504@r-project.org>
	<BANLkTimquWB+LNJtg_AjWGrbqx0Z+beaWQ@mail.gmail.com>
	<4DC1804C.80706@r-project.org>
Message-ID: <BANLkTik=12+9OB8g+R6KAHia99qwTDNHkw@mail.gmail.com>

On Wed, May 4, 2011 at 11:35 AM, John Chambers <jmc at r-project.org> wrote:
> On 5/4/11 9:24 AM, Hadley Wickham wrote:
>>>>
>>>> Are you familiar with "Concepts, Techniques, and Models of Computer
>>>> Programming" by van Roy and Haridi? ?That's what really helped me to
>>>> understand the strengths and weaknesses of the various styles of
>>>> programming.
>>>
>>> Thanks, I wasn't. ?Yes, interesting similar distinction between
>>> functional
>>> and "type" decomposition. ?An important associated aspect for us is the
>>> distinction between reference objects and "ordinary" R objects, not
>>> AFAICS
>>> conveyed by their more abstract treatment.
>>
>> Another discussion I found useful was in SICP:
>> http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-17.html#%_sec_2.4.3
>>
>> I really like the metaphor of method dispatch as a table with types in
>> the columns and operations in the rows - then you can think of generic
>> functions oo as being row-based, and class based oo as column-based.
>
> Except that functional method dispatch with multiple dispatch is dispatched
> on a K-tple of classes if the generic function has K arguments in its
> signature.
>
> This is not a trivial distinction because it means that a method can depend
> on more than one class definition, so it's not just a matter of distributing
> the same information in different ways, but a fundamentally more complicated
> structure for functional OOP (for better and/or for worse).

Yes, the metaphor breaks down fairly quickly, but it really helped me
to understand the types of problems where generic functions are
useful, and how methods are used in fundamentally different ways in
the different styles.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From chuck at sharpsteen.net  Wed May  4 19:11:17 2011
From: chuck at sharpsteen.net (Sharpie)
Date: Wed, 4 May 2011 10:11:17 -0700 (PDT)
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
Message-ID: <1304529077324-3496226.post@n4.nabble.com>


Byron Ellis-2 wrote:
> 
> Hi all (especially R-core) I suppose,
> 
> With the introduction of the new functional programming functions into
> base I thought I'd ask for a Curry() function. I use a simple one that
> looks this:
> 
> Curry = function(FUN,...) { .orig = list(...);function(...)
> do.call(FUN,c(.orig,list(...))) }
> 
> ...
> 
> 

I would like to see this as well---it is one of the functional programming
constructs I really miss in R after playing with languages like Haskell.

Currently, the only Curry implementation I know of is in the roxygen package
which is kind of a weird dependency to install just for this one function.

-Charlie

-----
Charlie Sharpsteen
Undergraduate-- Environmental Resources Engineering
Humboldt State University
--
View this message in context: http://r.789695.n4.nabble.com/Curry-proposed-new-functional-programming-er-function-tp917654p3496226.html
Sent from the R devel mailing list archive at Nabble.com.


From ggrothendieck at gmail.com  Wed May  4 19:18:06 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 4 May 2011 13:18:06 -0400
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <1304529077324-3496226.post@n4.nabble.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<1304529077324-3496226.post@n4.nabble.com>
Message-ID: <BANLkTimEpJ6hpSZ5sac3f2un52s77zfDoA@mail.gmail.com>

On Wed, May 4, 2011 at 1:11 PM, Sharpie <chuck at sharpsteen.net> wrote:
> Currently, the only Curry implementation I know of is in the roxygen package
> which is kind of a weird dependency to install just for this one function.
>

Not entirely comparable but the proto package supports currying of
proto arguments. For example, p$ls returns an
"instantiatedProtoMethod" which is an S3 subclass of "function" that
is like the original method but with the first argument filled in:

> library(proto)
> p <- proto(x = 1)
> p$ls()
[1] "x"


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From Greg.Snow at imail.org  Wed May  4 19:26:23 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Wed, 4 May 2011 11:26:23 -0600
Subject: [Rd] tkrplot not working in R 2.13.0
In-Reply-To: <alpine.LFD.2.02.1105041727260.23753@auk.stats.ox.ac.uk>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
	<alpine.LFD.2.02.1105041727260.23753@auk.stats.ox.ac.uk>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F0AB@LP-EXMBVS10.CO.IHC.COM>

It looks like the spaces in the path is the problem, when I run the line below with shQuote then everything starts working and all is right with the world again.

Thanks,

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Sent: Wednesday, May 04, 2011 10:35 AM
> To: Greg Snow
> Cc: R Devel List
> Subject: Re: [Rd] tkrplot not working in R 2.13.0
> 
> What example are you trying? The code in ?trkplot works for me.
> 
> However, it looks to me like that piece of advice in the rw-FAQ about
> no spaces in your path has come back to bite you (I of course do not
> have such spaces).  I think this should be
> 
> .Tcl(paste("load", shQuote(file), "Rplot"))
> 
> or some such.
> 
> On Wed, 4 May 2011, Greg Snow wrote:
> 
> > The tkrplot package is not working in version 2.13.0 for windows.  I
> contacted the maintainer who unfortunately does not have easy access to
> a windows computer and says that it is working on the other platforms.
> >
> > I traced the problem down to the line in the .First.lib function:
> >
> > .Tcl(paste("load", file, "Rplot"))
> >
> > With file being "C:/Program Files/R/R-
> 2.13.0/library/tkrplot/libs/i386/tkrplot.dll" on my system.  I did
> check that the file exists and it can even be loaded using dyn.load,
> but when running the .Tcl command by hand it produces the following
> error:
> >
> > Error in structure(.External("dotTcl", ..., PACKAGE = "tcltk"), class
> = "tclObj") :
> >  [tcl] could not find interpreter "Rplot".
> >
> > It works in previous versions of R, so I am guessing that this is
> > due to some change in R, or the tcl with R 2.13.0, or how tkrplot
> > was compiled under the new R, or possibly something else.
> >
> > Does anyone else have any insights?
> >
> >
> >
> >> sessionInfo()
> > R version 2.13.0 (2011-04-13)
> > Platform: i386-pc-mingw32/i386 (32-bit)
> >
> > locale:
> > [1] LC_COLLATE=English_United States.1252
> > [2] LC_CTYPE=English_United States.1252
> > [3] LC_MONETARY=English_United States.1252
> > [4] LC_NUMERIC=C
> > [5] LC_TIME=English_United States.1252
> >
> > attached base packages:
> > [1] tcltk     stats     graphics  grDevices utils     datasets
> methods
> > [8] base
> >
> > other attached packages:
> > [1] TeachingDemos_2.7 tkrplot_0.0-19
> >
> > loaded via a namespace (and not attached):
> > [1] tools_2.13.0
> >
> > Thanks,
> >
> > --
> > Gregory (Greg) L. Snow Ph.D.
> > Statistical Data Center
> > Intermountain Healthcare
> > greg.snow at imail.org
> > 801.408.8111
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pdalgd at gmail.com  Wed May  4 19:43:03 2011
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 4 May 2011 19:43:03 +0200
Subject: [Rd] tkrplot not working in R 2.13.0
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F0AB@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
	<alpine.LFD.2.02.1105041727260.23753@auk.stats.ox.ac.uk>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F0AB@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <18E2E529-683E-464E-9839-E2E713A259B9@gmail.com>


On May 4, 2011, at 19:26 , Greg Snow wrote:

> It looks like the spaces in the path is the problem, when I run the line below with shQuote then everything starts working and all is right with the world again.

Just for fun, see if it also works with

tcl("load", file, "Rplot")

(.Tcl(paste(....)) is just *so* turn of the millennium, and particularly vulnerable to "quoting hell" effects.)


> 
> Thanks,
> 
> -- 
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at imail.org
> 801.408.8111
> 
> 
>> -----Original Message-----
>> From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
>> Sent: Wednesday, May 04, 2011 10:35 AM
>> To: Greg Snow
>> Cc: R Devel List
>> Subject: Re: [Rd] tkrplot not working in R 2.13.0
>> 
>> What example are you trying? The code in ?trkplot works for me.
>> 
>> However, it looks to me like that piece of advice in the rw-FAQ about
>> no spaces in your path has come back to bite you (I of course do not
>> have such spaces).  I think this should be
>> 
>> .Tcl(paste("load", shQuote(file), "Rplot"))
>> 
>> or some such.
>> 
>> On Wed, 4 May 2011, Greg Snow wrote:
>> 
>>> The tkrplot package is not working in version 2.13.0 for windows.  I
>> contacted the maintainer who unfortunately does not have easy access to
>> a windows computer and says that it is working on the other platforms.
>>> 
>>> I traced the problem down to the line in the .First.lib function:
>>> 
>>> .Tcl(paste("load", file, "Rplot"))
>>> 
>>> With file being "C:/Program Files/R/R-
>> 2.13.0/library/tkrplot/libs/i386/tkrplot.dll" on my system.  I did
>> check that the file exists and it can even be loaded using dyn.load,
>> but when running the .Tcl command by hand it produces the following
>> error:
>>> 
>>> Error in structure(.External("dotTcl", ..., PACKAGE = "tcltk"), class
>> = "tclObj") :
>>> [tcl] could not find interpreter "Rplot".
>>> 
>>> It works in previous versions of R, so I am guessing that this is
>>> due to some change in R, or the tcl with R 2.13.0, or how tkrplot
>>> was compiled under the new R, or possibly something else.
>>> 
>>> Does anyone else have any insights?
>>> 
>>> 
>>> 
>>>> sessionInfo()
>>> R version 2.13.0 (2011-04-13)
>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>> 
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252
>>> [2] LC_CTYPE=English_United States.1252
>>> [3] LC_MONETARY=English_United States.1252
>>> [4] LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>> 
>>> attached base packages:
>>> [1] tcltk     stats     graphics  grDevices utils     datasets
>> methods
>>> [8] base
>>> 
>>> other attached packages:
>>> [1] TeachingDemos_2.7 tkrplot_0.0-19
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] tools_2.13.0
>>> 
>>> Thanks,
>>> 
>>> --
>>> Gregory (Greg) L. Snow Ph.D.
>>> Statistical Data Center
>>> Intermountain Healthcare
>>> greg.snow at imail.org
>>> 801.408.8111
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From simon.urbanek at r-project.org  Wed May  4 19:55:31 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 4 May 2011 13:55:31 -0400
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
	remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
	<19904.63996.415478.695901@stat.math.ethz.ch>
	<BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>
Message-ID: <B9218D41-237E-44DF-A2F5-A93614014434@r-project.org>

On May 4, 2011, at 12:00 PM, Yihui Xie wrote:

> My suggestion was to mimic *nix systems: put the executable binaries in the same place *by default* (e.g. /usr/bin/ or /usr/local/bin).

Except that there is not such thing on Windows! The closest to that is the "system" folder which is off limits for applications.


> Why isn't the default bin path for R under *nix something like /usr/bin/R-2.13.0/?

It is on some unices (and most system-wide installations in practice) - but that's beside the point. Unix has a well-defined FHS so regardless where you install R you can always put a symlink into /usr/bin or /usr/local/bin. Windows has no such conventions so Gabor's solution is pretty much what you claim to want (and note that in unix you're exactly running a batch script with its rhome embedded to start R!). Even on unix you don't mess with PATH to select the R version to use.


> If the users want to install multiple versions,
> they still have the choice to install them elsewhere. I'm not denying
> the possible necessity of having multiple versions in a system. In my
> opinion, the default values should be set according to probabilities:
> is it more likely for a user to use multiple versions or a single
> version of R? Of course, all of you are developers and the former
> probability might be higher, but I don't think many users will run the
> script A with R 2.12.1 and script B with R 2.13.0. The most typical
> situation I have seen is, (Windows) people install R and will forget
> to update it forever. I often have to urge our IT admin to update R in
> our department from a version released long long ago. You may argue my
> samples are not representative. Anyway, I can accept the default
> version string if nobody agrees with me.
> 

Cheers,
S


> I do use Emacs every day. It's nice, I totally agree.
> 
> Regards,
> Yihui
> --
> Yihui Xie <xieyihui at gmail.com>
> Phone: 515-294-2465 Web: http://yihui.name
> Department of Statistics, Iowa State University
> 2215 Snedecor Hall, Ames, IA
> 
> 
> 
> On Wed, May 4, 2011 at 2:02 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
>> Note to Yihui Xie:  I agree 100% with the other R core members
>> (Duncan, Simon, Thomas) who already explained why it is *GOOD*
>> to install R in version-named directories by default.
>> 
>> BTW: If you use ESS (Emacs Speaks Statistics) on Windows,
>> it now automatically(*) finds all versions of R
>> (* well, less generally, probably than Gabor's batch files; IIRC,
>>  we assume that the R versions were installed in the default place),
>> and provides them, both the 32bit and 64bit versions, in the ESS
>> menu, or via
>>  M-x R- [Tab completion]
>> Very nice, very useful in my eyes.
>> 
>> Martin
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From Greg.Snow at imail.org  Wed May  4 20:27:30 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Wed, 4 May 2011 12:27:30 -0600
Subject: [Rd] tkrplot not working in R 2.13.0
In-Reply-To: <18E2E529-683E-464E-9839-E2E713A259B9@gmail.com>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
	<alpine.LFD.2.02.1105041727260.23753@auk.stats.ox.ac.uk>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F0AB@LP-EXMBVS10.CO.IHC.COM>
	<18E2E529-683E-464E-9839-E2E713A259B9@gmail.com>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F113@LP-EXMBVS10.CO.IHC.COM>

That works as well, I will suggest it to Luke for the package to use.

Thanks,

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: peter dalgaard [mailto:pdalgd at gmail.com]
> Sent: Wednesday, May 04, 2011 11:43 AM
> To: Greg Snow
> Cc: Prof Brian Ripley; R Devel List
> Subject: Re: [Rd] tkrplot not working in R 2.13.0
> 
> 
> On May 4, 2011, at 19:26 , Greg Snow wrote:
> 
> > It looks like the spaces in the path is the problem, when I run the
> line below with shQuote then everything starts working and all is right
> with the world again.
> 
> Just for fun, see if it also works with
> 
> tcl("load", file, "Rplot")
> 
> (.Tcl(paste(....)) is just *so* turn of the millennium, and
> particularly vulnerable to "quoting hell" effects.)
> 
> 
> >
> > Thanks,
> >
> > --
> > Gregory (Greg) L. Snow Ph.D.
> > Statistical Data Center
> > Intermountain Healthcare
> > greg.snow at imail.org
> > 801.408.8111
> >
> >
> >> -----Original Message-----
> >> From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> >> Sent: Wednesday, May 04, 2011 10:35 AM
> >> To: Greg Snow
> >> Cc: R Devel List
> >> Subject: Re: [Rd] tkrplot not working in R 2.13.0
> >>
> >> What example are you trying? The code in ?trkplot works for me.
> >>
> >> However, it looks to me like that piece of advice in the rw-FAQ
> about
> >> no spaces in your path has come back to bite you (I of course do not
> >> have such spaces).  I think this should be
> >>
> >> .Tcl(paste("load", shQuote(file), "Rplot"))
> >>
> >> or some such.
> >>
> >> On Wed, 4 May 2011, Greg Snow wrote:
> >>
> >>> The tkrplot package is not working in version 2.13.0 for windows.
> I
> >> contacted the maintainer who unfortunately does not have easy access
> to
> >> a windows computer and says that it is working on the other
> platforms.
> >>>
> >>> I traced the problem down to the line in the .First.lib function:
> >>>
> >>> .Tcl(paste("load", file, "Rplot"))
> >>>
> >>> With file being "C:/Program Files/R/R-
> >> 2.13.0/library/tkrplot/libs/i386/tkrplot.dll" on my system.  I did
> >> check that the file exists and it can even be loaded using dyn.load,
> >> but when running the .Tcl command by hand it produces the following
> >> error:
> >>>
> >>> Error in structure(.External("dotTcl", ..., PACKAGE = "tcltk"),
> class
> >> = "tclObj") :
> >>> [tcl] could not find interpreter "Rplot".
> >>>
> >>> It works in previous versions of R, so I am guessing that this is
> >>> due to some change in R, or the tcl with R 2.13.0, or how tkrplot
> >>> was compiled under the new R, or possibly something else.
> >>>
> >>> Does anyone else have any insights?
> >>>
> >>>
> >>>
> >>>> sessionInfo()
> >>> R version 2.13.0 (2011-04-13)
> >>> Platform: i386-pc-mingw32/i386 (32-bit)
> >>>
> >>> locale:
> >>> [1] LC_COLLATE=English_United States.1252
> >>> [2] LC_CTYPE=English_United States.1252
> >>> [3] LC_MONETARY=English_United States.1252
> >>> [4] LC_NUMERIC=C
> >>> [5] LC_TIME=English_United States.1252
> >>>
> >>> attached base packages:
> >>> [1] tcltk     stats     graphics  grDevices utils     datasets
> >> methods
> >>> [8] base
> >>>
> >>> other attached packages:
> >>> [1] TeachingDemos_2.7 tkrplot_0.0-19
> >>>
> >>> loaded via a namespace (and not attached):
> >>> [1] tools_2.13.0
> >>>
> >>> Thanks,
> >>>
> >>> --
> >>> Gregory (Greg) L. Snow Ph.D.
> >>> Statistical Data Center
> >>> Intermountain Healthcare
> >>> greg.snow at imail.org
> >>> 801.408.8111
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>
> >>
> >> --
> >> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> >> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> >> University of Oxford,             Tel:  +44 1865 272861 (self)
> >> 1 South Parks Road,                     +44 1865 272866 (PA)
> >> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> --
> Peter Dalgaard
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From kevin.r.coombes at gmail.com  Wed May  4 20:33:10 2011
From: kevin.r.coombes at gmail.com (Kevin R. Coombes)
Date: Wed, 04 May 2011 13:33:10 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>	<4DC0A88A.4070908@gmail.com>	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>	<19904.63996.415478.695901@stat.math.ethz.ch>
	<BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>
Message-ID: <4DC19BE6.10805@gmail.com>

There are plenty of good reasons for non-developers to run different 
versions of R.  For instance, I care a lot about reproducibility. With 
every new release of R, lots of things change.  With every new release 
of the packages I use, lots of things change.  All of my analyses are 
performed using Sweave, and every report includes a call to sessionInfo 
so that the versions are recorded in the final report.  If I have to go 
back and tweak something in a report (say, to regenerate a figure in a 
format more suitable for publication), I do not want the rest of the 
analysis to change.  So I have to run the correct (possibly older) 
version of R.  All of the stat analysts that we train follow the same 
practice.

As a result, I am strongly opposed to an installation that automatically 
mucks with the path to R.

     Kevin

On 5/4/2011 11:00 AM, Yihui Xie wrote:
> My suggestion was to mimic *nix systems: put the executable binaries
> in the same place *by default* (e.g. /usr/bin/ or /usr/local/bin). Why
> isn't the default bin path for R under *nix something like
> /usr/bin/R-2.13.0/? If the users want to install multiple versions,
> they still have the choice to install them elsewhere. I'm not denying
> the possible necessity of having multiple versions in a system. In my
> opinion, the default values should be set according to probabilities:
> is it more likely for a user to use multiple versions or a single
> version of R? Of course, all of you are developers and the former
> probability might be higher, but I don't think many users will run the
> script A with R 2.12.1 and script B with R 2.13.0. The most typical
> situation I have seen is, (Windows) people install R and will forget
> to update it forever. I often have to urge our IT admin to update R in
> our department from a version released long long ago. You may argue my
> samples are not representative. Anyway, I can accept the default
> version string if nobody agrees with me.
>
> I do use Emacs every day. It's nice, I totally agree.
>
> Regards,
> Yihui
> --
> Yihui Xie<xieyihui at gmail.com>
> Phone: 515-294-2465 Web: http://yihui.name
> Department of Statistics, Iowa State University
> 2215 Snedecor Hall, Ames, IA


From vioravis at gmail.com  Wed May  4 16:40:28 2011
From: vioravis at gmail.com (vioravis)
Date: Wed, 4 May 2011 07:40:28 -0700 (PDT)
Subject: [Rd] Error in .Fortran Call
In-Reply-To: <BANLkTikGtQrf-0p1adebABP94oHhLkc-yw@mail.gmail.com>
References: <1304512008660-3495319.post@n4.nabble.com>
	<BANLkTikGtQrf-0p1adebABP94oHhLkc-yw@mail.gmail.com>
Message-ID: <1304520028666-3495777.post@n4.nabble.com>

Thanks a lot. I will try the recommended changes.

Ravi

--
View this message in context: http://r.789695.n4.nabble.com/Error-in-Fortran-Call-tp3495319p3495777.html
Sent from the R devel mailing list archive at Nabble.com.


From hpages at fhcrc.org  Wed May  4 21:00:17 2011
From: hpages at fhcrc.org (=?windows-1252?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 04 May 2011 12:00:17 -0700
Subject: [Rd] R CMD check and Suggests Packages
In-Reply-To: <19903.45630.406037.262781@stat.math.ethz.ch>
References: <20110429120016.BLP71069@gimr.garvan.unsw.edu.au>	<4DBEFE0C.9090801@fhcrc.org>
	<19903.45630.406037.262781@stat.math.ethz.ch>
Message-ID: <4DC1A241.9050106@fhcrc.org>

On 11-05-03 12:43 AM, Martin Maechler wrote:
>>>>>> Herv? Pag?s<hpages at fhcrc.org>
>>>>>>      on Mon, 02 May 2011 11:55:08 -0700 writes:
>
>      >  Hi, On 11-04-28 07:00 PM, Dario Strbenac wrote:
>      >>  Hello,
>      >>
>      >>  In my description file, I have an example data package in
>      >>  Suggests: that I've deleted from my library to test what
>      >>  the user who doesn't have it will experience.
>      >>
>      >>  However, R CMD check won't even pass my package :
>      >>
>      >>  * checking package dependencies ... ERROR
>      >>  Package required but not available: RepitoolsExamples
>      >           ^^^^^^^^ confusing!
>
>      >  Wouldn't a message like
>
>      >     Package required for full checking but not available:
>      >  RepitoolsExamples
>
>      >  be more appropriate and avoid a confusion that we've seen
>      >  for a very long time now?
>
> Sure.  But such messages are already produced in current
> versions of R,

Not for me. For example, picking up a CRAN package with a
Suggests field:

   http://cran.fhcrc.org/web/packages/AICcmodavg/index.html

Then, after downloading the source tarball:

   hpages at latitude:~/Downloads$ R-2.13 CMD check AICcmodavg_1.15.tar.gz
   * using log directory ?/home/hpages/Downloads/AICcmodavg.Rcheck?
   * using R version 2.13.0 (2011-04-13)
   * using platform: x86_64-unknown-linux-gnu (64-bit)
   * using session charset: UTF-8
   * checking for file ?AICcmodavg/DESCRIPTION? ... OK
   * checking extension type ... Package
   * this is package ?AICcmodavg? version ?1.15?
   * checking package dependencies ... ERROR
   Package required but not available: lme4

   See the information on DESCRIPTION files in the chapter 'Creating R
   packages' of the 'Writing R Extensions' manual.

Cheers,
H.


> .. at least they are there in the package checking
> source, see
> 	format.check_package_depends()  in
> 	src/library/tools/R/QC.R
> which has e.g.,
>
>        if(length(bad<- x$suggests_but_not_installed)>  1L) {
>            c(gettext("Packages suggested but not available for checking:"),
> 	 ....
>
> and similar for 'Enhances' in lieu of 'Suggests'.
>
> If Dario really uses R 2.13.0 (or newer),
> and he gets the above error message for a package that is not
> required but only suggested,
> I think we'd need a clear, ideally simple,
> reproducible example, here.
>
> Martin
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From chuck at sharpsteen.net  Wed May  4 21:17:48 2011
From: chuck at sharpsteen.net (Sharpie)
Date: Wed, 4 May 2011 12:17:48 -0700 (PDT)
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
Message-ID: <1304536668296-3496533.post@n4.nabble.com>


Yihui Xie-2 wrote:
> 
> Hi,
> 
> I guess this issue must have been brought forward long time ago, but I
> still hope you can consider under Windows (during installation):
> 
> 1. put R's bin path in the PATH variable of the system so that we can
> use the commands "R" and "Rscript" more easily;
> 

On one hand it certainly would be nice to have this as an option similar to
what the RTools installer does. For the 32/64 bit decision, perhaps
RHOME/bin could be placed on the PATH and bin/R.exe turned into a bin/R.bat
that calls bin/i386/R.exe, bin/x64/R.exe depending on the Windows
architecture.

On the other hand, the grizzled developer in me is saying "this is a
teaching moment. If someone is using a programming language they should know
what an environment variable is and how to set it".  Admittingly, setting
environment variables is a PITA on Windows compared to UNIX. Here's a great
freeware tool I have found that makes it so much easier:

  http://www.rapidee.com

Another issue is that many Windows machines are locked down in such a way
that environment variables cannot be set permanently. To deal with this, I
carry a USB stick that has R installed on it and a batch script that
`setx`es environment variables for me. Combined with an `autorun.inf`
script, this basically lets me plug my USB stick into a Windows machine and
get to work without worrying about how careful the sysadmin was when they
set up the tools I like to use (or if they even bothered to include the
tools I like to use).

A good video tutorial for setting up autorun.inf from Tinkernut.com:

  http://www.youtube.com/watch?v=lFlgddjOPpw

Some of the things in that video are outdated and the overall goal is to
show how they could be used for nefarious purposes, but the part about
converting a `.bat` script to a `.exe` binary and setting up an autorun.inf
to execute the result is solid. Combine with MikTeX Portable and you should
be able to Sweave from anywhere.



Yihui Xie-2 wrote:
> 
> 2. remove the version string like R-2.13.0 in the default installation
> directory, e.g. only use a directory like C:/Program Files/R/ instead
> of C:/Program Files/R/R-2.13.0/; I know many people just follow the
> default setting when installing R, and this version string will often
> lead to many (unnecessary) copies of R in the system and brings
> difficulty to the first issue (several possible bin directories);
> 
> I'm aware of some existing efforts in overcoming the difficulty of
> calling R under Windows like the R batch files project
> (http://code.google.com/p/batchfiles/), but I believe this is better
> to be solved in R directly.
> 

As a package developer I rather like this---I can have multiple versions of
R installed and easily set up my testsuite such that it loops through each
one and executes the tests.

-Charlie


-----
Charlie Sharpsteen
Undergraduate-- Environmental Resources Engineering
Humboldt State University
--
View this message in context: http://r.789695.n4.nabble.com/Wishlist-write-R-s-bin-path-to-the-PATH-variable-and-remove-the-version-string-in-the-installation-ds-tp3493922p3496533.html
Sent from the R devel mailing list archive at Nabble.com.


From janko.thyson.rstuff at googlemail.com  Wed May  4 21:39:47 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Wed, 04 May 2011 21:39:47 +0200
Subject: [Rd] Reference Classes: replacing '.self' with an .Rda image of
 '.self' from within a method? (was replacing '.self' with an .Rda image of
 '.self' from within a method?)
Message-ID: <4DC1AB83.4030404@googlemail.com>

Sorry guys,

but I chose a really stupid name before (no "reference classes").

Hope it's okay to re-post.

Cheers,
Janko

 >>> ORIGINAL MESSAGE <<<

Dear list,

Is it possible to update or reassign '.self' with an image of '.self' 
(e.g. a locally stored .Rda file) from within a method?

I know that this might sound akward, but here's the use case:
1) Ref Class Definition
     setRefClass(Class="Test",
         fields=list(A="character", B="character"),
         methods=list(importImage=function(path){
             variable <- load(path)
             expr <- paste("assign('", variable, "',", variable, ", 
envir=.self)", sep="")
             eval(parse(text=expr))
         }
     )
2) Initialize Method Definition
     setMethod(
         f="initialize",
         signature=signature(.Object="Test"),
         definition=function(
             .Object,
             path=NULL
     ){
         obj <- callNextMethod(.Object)
         if(!is.null(path){
             obj$importImage(path=path)
         }
         return(obj)
     }
3) Intended and "Extended" Use
     Method 'importImage' was originally intended to read either an 
object of name 'A' or 'B' from a respective path and overwrite the 
respective fields in an obj of class 'Test'.
     Now I wondered how I could "reassign"/update the object of class 
'Test' itself by reading a respective .Rda image of an object of class 
'Test' from within 'obj$importImage()'.
     The way I've written 'importImage()', it did not work. Yet I wonder 
if it's possible.
4) My Workaround (but I'm looking for something more elegantly)
     In the class definition:
     [...]
     methods=list(importImage=function(path){
             variable <- load(path)
             if(variable != ".self"){
                 expr <- paste("assign('", variable, "',", variable, ", 
envir=.self)", sep="")
                 eval(parse(text=expr))
                 return(TRUE)
             } else {
                 return(.self)
             }
     })
     [...]

     In the initialize method:
     setMethod(
         f="initialize",
         signature=signature(.Object="Test"),
         definition=function(
             .Object,
             path=NULL
     ){
         obj <- callNextMethod(.Object)
         if(!is.null(path){
             rslt <- obj$importImage(path=path)
             if(!is.logical(rslt)){
                 obj <- rslt
             }
         }
         return(obj)
     }

Thanks for any comments,
Janko


From cstrato at aon.at  Wed May  4 22:02:05 2011
From: cstrato at aon.at (cstrato)
Date: Wed, 04 May 2011 22:02:05 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>
References: <4DB32D9F.5010406@aon.at>
	<4DB42FB3.9090401@statistik.tu-dortmund.de>
	<4DB472F8.9060903@aon.at>
	<4DB489EC.9080301@statistik.tu-dortmund.de>
	<4DB491BE.8080104@aon.at>
	<4DB57E7A.1080507@statistik.tu-dortmund.de>
	<4DB5AFD4.9020303@aon.at> <4DB5B6B0.90607@gmail.com>
	<4DB5C286.40306@aon.at> <4DB5C38D.6030400@gmail.com>
	<4DB5C87C.5040905@aon.at> <4DB5CBFD.6050508@gmail.com>
	<4DB723F9.7090800@aon.at>
	<4DB7D0DD.6040201@statistik.tu-dortmund.de>
	<4DBDBE4F.8020702@aon.at> <4DBDEA8F.60000@gmail.com>
	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>
	<4DBF04E4.8020806@aon.at>
	<4DBFE206.3030708@statistik.tu-dortmund.de>
	<4DC05427.7060908@aon.at>
	<4DC061D1.3080105@statistik.tu-dortmund.de>
	<4DC06A03.2010205@aon.at>
	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>
	<4DC0708C.2060708@aon.at>
	<CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>
Message-ID: <4DC1B0BD.6030509@aon.at>

Dear Simon,

I did not complain about the R doing something wrong. I only wanted to 
know why, after all these years, R CMD check does suddenly no longer 
build the pdf-files of the vignettes. I also think that this is a legal 
question.

Let me compare the times spent:

1, the "official" development cycle:
- R CMD build:   5 minutes
- R CMD INSTALL: 3 minutes
- R CMD check:   6 minutes

2, my own development cycle:
- manual tarring: 2 seconds
- R CMD check:    6 minutes

This means spending 14 minutes vs 6 minutes. If I assume that in one 
evening I have to make 10 corrections this would mean 140 minutes vs 60 
minutes, i.e. the official development cycle would take 1 hr and 20 min 
longer than my own development cycle. This is time I do not have.

Best regards
Christian


On 5/4/11 12:13 AM, Simon Urbanek wrote:
> On May 3, 2011, at 5:15 PM, cstrato wrote:
>
>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>
>
> Well, that's your problem then, not R's. Source packages are created using R CMD build, not by manual tarring (you can do the latter if you know what you're doing, but then you can't complain about the R doing something wrong).
>
> Cheers,
> S
>
>
>>
>> On 5/3/11 11:11 PM, Simon Urbanek wrote:
>>> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at>   wrote:
>>>
>>>> Dear Uwe,
>>>>
>>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source code is not polluted.
>>>>
>>>
>>> But then you already used build to create the tar ball so the vignette has been built. So what is your point?
>>>
>>> Cheers,
>>> S
>>>
>>>
>>>> Furthermore, I forgot to mention that finally I upload the source code only to the BioC svn repository. The rest is done by the BioC servers, including building the pdf-files for the vignettes.
>>>>
>>>> Best regards
>>>> Christian
>>>>
>>>>
>>>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>>>
>>>>>
>>>>> On 03.05.2011 21:14, cstrato wrote:
>>>>>> Dear Uwe,
>>>>>>
>>>>>> This is my development cycle:
>>>>>>
>>>>>> First, I run R CMD check until there are no more warnings/errors. Since
>>>>>> years it was very convenient that R CMD check builds the pdf-files of
>>>>>> the vignettes, too, since this allowed me to correct errors in the
>>>>>> manual files and the vignette files at the same time!
>>>>>>
>>>>>> Afterwards I run R CMD INSTALL to install my package and do more tests
>>>>>> until everything works.
>>>>>>
>>>>>> As you see I do not use R CMD build, since every run takes about 5
>>>>>> minutes, it overwrites my zipped source code, and I would need to unzip
>>>>>> it to get access to the vignette pdf-files.
>>>>>
>>>>>
>>>>> Then this is the main problem here. The *recommended* development cycle
>>>>> from the manuals is to run
>>>>>
>>>>> 1. R CMD build in order to get a valid source tarball and clean the sources
>>>>> 2. R CMD INSTALL to check if your package can be installed
>>>>> 3. R CMD check in order to finally check your package
>>>>>
>>>>> Running R CMD INSTALL on your source directory may pollute it, hence
>>>>> this is not recommended at all.
>>>>>
>>>>>
>>>>> Best,
>>>>> UWe
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>>
>>>>>> Best regards
>>>>>> Christian
>>>>>>
>>>>>>
>>>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>>>
>>>>>>>
>>>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>>>> Dear Prof. Ripley,
>>>>>>>>
>>>>>>>> Thank you for your confirmation and explanation, I understand the
>>>>>>>> reason
>>>>>>>> for cleaning things up to save memory. However, it was very convenient
>>>>>>>> to have this feature in earlier versions of R. It would be really
>>>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>>>> "--no-clean-vignettes".
>>>>>>>>
>>>>>>>> FYI, I did not claim "..create the vignettes *in<pkg>inst/doc*",
>>>>>>>> instead my words were:
>>>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2 contains
>>>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck from
>>>>>>>> R-2.13.0 does not contain "inst".
>>>>>>>
>>>>>>>
>>>>>>> But you do not need it. I do not know how often I have to mention that
>>>>>>> vignettes are produced by R CMD build! They are already build when
>>>>>>> running R CMD check. And please do not tell us about tzhe PDF version
>>>>>>> oif manuals which are *unrelated* to vignettes, because they are not
>>>>>>> built in advance and need to be checked, since they should be produced
>>>>>>> at user level while vignettes are built at developer level already.
>>>>>>>
>>>>>>> Uwe Ligges
>>>>>>>
>>>>>>>
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>
>>>>>>>>
>>>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>>>
>>>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>
>>>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my Mac in a
>>>>>>>>>>> virtual machine, I have now done the following tests on all three
>>>>>>>>>>> architectures:
>>>>>>>>>>>
>>>>>>>>>>> 1, R CMD build xps:
>>>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all vignettes as
>>>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>>>
>>>>>>>>>>> 2, R CMD check xps:
>>>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no longer build
>>>>>>>>>>> the
>>>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did create the
>>>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>>>
>>>>>>>>>>> Thus the question is:
>>>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>>>
>>>>>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>>>>>> reliable check, you should build the package, then check the tar.gz
>>>>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>>>>>
>>>>>>>>> Actually, it does. What earlier versions never did (despite 'cstrato's
>>>>>>>>> repeated delusional claims earlier) was to create the vignettes *in
>>>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes in a
>>>>>>>>> working directory. The difference is that 2.13.0 deletes that working
>>>>>>>>> directory if the test was successful, whereas earlier versions left
>>>>>>>>> the
>>>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>>>> However,
>>>>>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>>>>>> succeeded
>>>>>>>>>
>>>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>>>
>>>>>>>>> R 2.12.2 gave
>>>>>>>>>
>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>>>
>>>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>>>
>>>>>>>>> R 2.13.0 gives
>>>>>>>>>
>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>> Animal.Rnw
>>>>>>>>>
>>>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>>>> Animal.Rnw
>>>>>>>>>
>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>
>>>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>>>
>>>>>>>>> The main reason for cleaning up is that to mimic R CMD build the test
>>>>>>>>> has to make a complete copy of the package sources, and that adds up:
>>>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>>>>> converted to
>>>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my Mac did
>>>>>>>>>>>>> not
>>>>>>>>>>>>> like
>>>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>>>
>>>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any pdf files
>>>>>>>>>>>>> for
>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Dioes it give an error or warning? It should check the code. R CMD
>>>>>>>>>>>> build
>>>>>>>>>>>> creates the pdf files.
>>>>>>>>>>>>
>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> My problem seems to be that at the moment the problem can be
>>>>>>>>>>>>>>> seen
>>>>>>>>>>>>>>> only
>>>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no problems
>>>>>>>>>>>>>>> creating
>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Then you are definitely the one in the best position to diagnose
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>> that looks unrelated. Verify that the problem still exists, then
>>>>>>>>>>>>>> cut
>>>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>>>> particular
>>>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>>>> statements, or
>>>>>>>>>>>>>> use
>>>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so special
>>>>>>>>>>>>>> about your
>>>>>>>>>>>>>> system.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>>>>> that is
>>>>>>>>>>>>>> not
>>>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>>>>>> it. If
>>>>>>>>>>>>>> it's
>>>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Thank you for your example, however it is different since it
>>>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my code, since:
>>>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with R-2.6.0 till
>>>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code which
>>>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in your
>>>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>>>> far
>>>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>>>> where
>>>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an example
>>>>>>>>>>>>>>>> illustrating the problem that doesn't involve your code, and
>>>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped me to
>>>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can use the
>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong. If I
>>>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> I will see the value of x getting printed, even though it
>>>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code you're
>>>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk 5 needs
>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> scheme.test3<- root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything
>>>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not from
>>>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3, "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also xps.tex
>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not
>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I have to
>>>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the usual case?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating pdf-files
>>>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific problem
>>>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I will, since
>>>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then the
>>>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same machine
>>>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD build is
>>>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but now I get:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the command
>>>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0 I get:
>>>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>>>> Overfull ?vbox (21.68121pt too high) has occurred while
>>>>>>>>>>>>>>>>>>>>>>> ?output is
>>>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>>>> Error: Could not create file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which work
>>>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line defining
>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused later
>>>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>>>> is not clear to me since "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the supplied
>>>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean. root.scheme does
>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and you tell
>>>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by root.scheme
>>>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work for the
>>>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor servers are
>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine with it. So
>>>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted, but on
>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted, but
>>>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no longer
>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following output:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes? Have
>>>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated to the
>>>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets methods
>>>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0 IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>
>


From luke-tierney at uiowa.edu  Wed May  4 22:45:16 2011
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Wed, 4 May 2011 15:45:16 -0500
Subject: [Rd] tkrplot not working in R 2.13.0
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F113@LP-EXMBVS10.CO.IHC.COM>
References: <B37C0A15B8FB3C468B5BC7EBC7DA14CC634738EFF5@LP-EXMBVS10.CO.IHC.COM>
	<alpine.LFD.2.02.1105041727260.23753@auk.stats.ox.ac.uk>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F0AB@LP-EXMBVS10.CO.IHC.COM>
	<18E2E529-683E-464E-9839-E2E713A259B9@gmail.com>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC634738F113@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <alpine.DEB.2.00.1105041544560.4973@luke-inspiron>

Thanks -- new version on its way to CRAN.

luke

On Wed, 4 May 2011, Greg Snow wrote:

> That works as well, I will suggest it to Luke for the package to use.
>
> Thanks,
>
>

-- 
Luke Tierney
Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From rvaradhan at jhmi.edu  Wed May  4 23:26:52 2011
From: rvaradhan at jhmi.edu (Ravi Varadhan)
Date: Wed, 4 May 2011 17:26:52 -0400
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
	<BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>
Message-ID: <79F23BA7BB084E4FA01A8B93904CD02CF669FAA4D7@WIGGUMVS.win.ad.jhu.edu>

Thanks, Hadley.  This (i.e., different ways to prepare curry) is quite instructive to me.

Best,
Ravi.

-------------------------------------------------------
Ravi Varadhan, Ph.D.
Assistant Professor,
Division of Geriatric Medicine and Gerontology School of Medicine Johns Hopkins University

Ph. (410) 502-2619
email: rvaradhan at jhmi.edu


-----Original Message-----
From: h.wickham at gmail.com [mailto:h.wickham at gmail.com] On Behalf Of Hadley Wickham
Sent: Wednesday, May 04, 2011 12:01 PM
To: Duncan Murdoch
Cc: Ravi Varadhan; Byron Ellis; R Development Mailing List
Subject: Re: [Rd] Curry: proposed new functional programming, er, function.

>> # Use of Curry
>> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)
>
> Two objections:
>
> 1. ?I don't see how that is preferable to
>
> adaptIntegrate(function(x) f(x, a=0.2), lower=0, upper=2)

It's less typing?

A more helpful use is when you have a list of functions:

    funs <- list(
      sum = sum,
      mean = mean,
      median = median
    )

with Curry function you can do :

    funs2 <- lapply(funs, Curry, na.rm = TRUE)

as opposed to

    funs2 <- list(
      sum = function(x, ...) sum(x, ..., na.rm = TRUE),
      mean = function(x, ...) mean(x, ..., na.rm = TRUE),
      median = function(x, ...) median(x, ..., na.rm = TRUE)
    )

> 2. ?There seems to be confusion about what currying means. ?The Wikipedia
> page <http://en.wikipedia.org/wiki/Currying> indicates that the function
> Curry() defined above is really doing "partial function application", not
> currying. ?I'm in no position to judge whether Byron got it right or
> Wikipedia did, but this suggests to me that the name "Curry" is
> inappropriate, since at least some people who know what currying is would
> not guess that it does what it does.

I'm not completely sure that discussion is canonical: wikipedia citing
a blog post does not a precedent make.  I agree the distinction is
sensible, but I think the partial function application sense of
currying is standard enough that it would cause much confusion. We are
not claiming that R has low-level currying, we're creating a function
to simulate a useful property of currying.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From jmc at r-project.org  Wed May  4 23:46:38 2011
From: jmc at r-project.org (John Chambers)
Date: Wed, 04 May 2011 14:46:38 -0700
Subject: [Rd] Reference Classes: replacing '.self' with an .Rda image of
 '.self' from within a method? (was replacing '.self' with an .Rda image of
 '.self' from within a method?)
In-Reply-To: <4DC1AB83.4030404@googlemail.com>
References: <4DC1AB83.4030404@googlemail.com>
Message-ID: <4DC1C93E.1040709@r-project.org>

It makes no sense to replace the .self field:  that field is initialized 
to be a reference to the object.  If you change it, it's no longer that 
reference.

There are many things wrong with your example, so it's better to take a 
very simple version:

 > mkTest <- setRefClass("test",fields = list(a = "numeric"))
 > x <- mkTest$new(a=1:10)

Now suppose we replace the .self field with another one:
 > y <- mkTest$new(a = 11:20)
 > x$.self <- y$.self

At this point x is messed up and does not correspond to the .self field:

 > x$a
  [1]  1  2  3  4  5  6  7  8  9 10
 > x$.self$a
  [1] 11 12 13 14 15 16 17 18 19 20

The same problem results no matter how you change the field.  The only 
difference with a method is that you do get a warning message.

 > pseudoSelf <- as.environment(list(a = 5))
 > x$.self <- pseudoSelf
 > x$a
  [1]  1  2  3  4  5  6  7  8  9 10
 > x$.self$a
[1] 5
 > mkTest$methods(screwup = function(newSelf) .self <<- newSelf)
Warning message:
In .checkFieldsInMethod(def, fieldNames, allMethods) :
   Non-local assignment to non-field names (possibly misspelled?)
     .self <<- newSelf
( in method "screwup" for class "test")
 > x <- mkTest$new(a=1:10)
 > x$screwup(pseudoSelf)
 > x$a
  [1]  1  2  3  4  5  6  7  8  9 10
 > x$.self$a
[1] 5

We need to make the .self field read-only.


On 5/4/11 12:39 PM, Janko Thyson wrote:
> Sorry guys,
>
> but I chose a really stupid name before (no "reference classes").
>
> Hope it's okay to re-post.
>
> Cheers,
> Janko
>
>  >>> ORIGINAL MESSAGE <<<
>
> Dear list,
>
> Is it possible to update or reassign '.self' with an image of '.self'
> (e.g. a locally stored .Rda file) from within a method?
>
> I know that this might sound akward, but here's the use case:
> 1) Ref Class Definition
> setRefClass(Class="Test",
> fields=list(A="character", B="character"),
> methods=list(importImage=function(path){
> variable <- load(path)
> expr <- paste("assign('", variable, "',", variable, ", envir=.self)",
> sep="")
> eval(parse(text=expr))
> }
> )
> 2) Initialize Method Definition
> setMethod(
> f="initialize",
> signature=signature(.Object="Test"),
> definition=function(
> .Object,
> path=NULL
> ){
> obj <- callNextMethod(.Object)
> if(!is.null(path){
> obj$importImage(path=path)
> }
> return(obj)
> }
> 3) Intended and "Extended" Use
> Method 'importImage' was originally intended to read either an object of
> name 'A' or 'B' from a respective path and overwrite the respective
> fields in an obj of class 'Test'.
> Now I wondered how I could "reassign"/update the object of class 'Test'
> itself by reading a respective .Rda image of an object of class 'Test'
> from within 'obj$importImage()'.
> The way I've written 'importImage()', it did not work. Yet I wonder if
> it's possible.
> 4) My Workaround (but I'm looking for something more elegantly)
> In the class definition:
> [...]
> methods=list(importImage=function(path){
> variable <- load(path)
> if(variable != ".self"){
> expr <- paste("assign('", variable, "',", variable, ", envir=.self)",
> sep="")
> eval(parse(text=expr))
> return(TRUE)
> } else {
> return(.self)
> }
> })
> [...]
>
> In the initialize method:
> setMethod(
> f="initialize",
> signature=signature(.Object="Test"),
> definition=function(
> .Object,
> path=NULL
> ){
> obj <- callNextMethod(.Object)
> if(!is.null(path){
> rslt <- obj$importImage(path=path)
> if(!is.logical(rslt)){
> obj <- rslt
> }
> }
> return(obj)
> }
>
> Thanks for any comments,
> Janko
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From baptiste.auguie at googlemail.com  Thu May  5 00:15:13 2011
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Thu, 5 May 2011 10:15:13 +1200
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <4DC16917.5090206@gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
Message-ID: <BANLkTi=KGzG-dEMNMo2hF4BUG3wUmbDpuQ@mail.gmail.com>

Hi,

On 5 May 2011 02:56, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 04/05/2011 10:40 AM, Ravi Varadhan wrote:
>>
>> I too would like this (being an Indian!).
>>
>> Here is an example that came up just yesterday with regards to solving a
>> quadrature problem using the "cubature" package. ?The adaptIntegrate
>> function does not allow additional arguments via ...
>>
>> Uwe suggested a work around, but `Curry' would solve it nicely (and it
>> also tastes better!):
>>
>> Curry = function(FUN,...) {
>> .orig = list(...)
>> function(...) do.call(FUN,c(.orig, list(...)))
>> }
>>
>> require(cubature)
>>
>> f<- function(x, a) cos(2*pi*x*a) ?# a simple test function
>>
>> # this works
>> a<- 0.2
>> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2)
>>
>> # but this doesn't work
>> rm(a)
>> adaptIntegrate(function(x, argA=a) f(x, a=argA), lower=0, upper=2, a=0.2)
>>
>>
>> # Use of Curry
>> adaptIntegrate(Curry(f, a=0.2), lower=0, upper=2)
>
> Two objections:
>
> 1. ?I don't see how that is preferable to
>
> adaptIntegrate(function(x) f(x, a=0.2), lower=0, upper=2)

In this particular case I don't think it is. The reason I proposed it
yesterday for the cubature example was that in some cases it can make
the code more concise and clearer in my opinion. This is the case when
you override a considerable number of arguments in a function.

Consider this,

read.table2 = Curry(read.table, header = TRUE, na.strings = "9999",
    colClasses = "numeric", nrows = 23)

vs

read.table2 = function(..., header = TRUE, na.strings = "9999",
    colClasses = "numeric", nrows = 23)
{
     read.table(header = header, na.strings = na.strings,
       colClasses = colClasses, nrows = nrows, ...)
}

Whether or not this should be called curry, I have no idea. In any
case it seems like a useful function to have in a base package,
regardless of its implementation details.

baptiste


>
> 2. ?There seems to be confusion about what currying means. ?The Wikipedia
> page <http://en.wikipedia.org/wiki/Currying> indicates that the function
> Curry() defined above is really doing "partial function application", not
> currying. ?I'm in no position to judge whether Byron got it right or
> Wikipedia did, but this suggests to me that the name "Curry" is
> inappropriate, since at least some people who know what currying is would
> not guess that it does what it does.
>
> Duncan Murdoch
>
>> Best,
>> Ravi.
>>
>> -------------------------------------------------------
>> Ravi Varadhan, Ph.D.
>> Assistant Professor,
>> Division of Geriatric Medicine and Gerontology School of Medicine Johns
>> Hopkins University
>>
>> Ph. (410) 502-2619
>> email: rvaradhan at jhmi.edu
>>
>>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
>> On Behalf Of Hadley Wickham
>> Sent: Wednesday, May 04, 2011 10:29 AM
>> To: Byron Ellis
>> Cc: R Development Mailing List
>> Subject: Re: [Rd] Curry: proposed new functional programming, er,
>> function.
>>
>> I thought I might bring this up again - it now seems like Curry would
>> be a natural fit with Reduce, Filter, Find, Map, Negate and Position.
>> Any chance we might see this in a future version of R?
>>
>> Hadley
>>
>> On Thu, Nov 1, 2007 at 2:00 PM, Byron Ellis<byron.ellis at gmail.com> ?wrote:
>> > ?Hi all (especially R-core) I suppose,
>> >
>> > ?With the introduction of the new functional programming functions into
>> > ?base I thought I'd ask for a Curry() function. I use a simple one that
>> > ?looks this:
>> >
>> > ?Curry = function(FUN,...) { .orig = list(...);function(...)
>> > ?do.call(FUN,c(.orig,list(...))) }
>> >
>> > ?This comes in really handy when using say, heatmap():
>> >
>> > ?heatmap(mydata,hclustfun=Curry(hclust,method="average"))
>> >
>> > ?or other functions where there are ... arguments, but it's not clear
>> > ?where they should end up.
>> >
>> > ?--
>> > ?Byron Ellis (byron.ellis at gmail.com)
>> > ?"Oook" -- The Librarian
>> >
>> > ?______________________________________________
>> > ?R-devel at r-project.org mailing list
>> > ?https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>>
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From xie at yihui.name  Thu May  5 04:16:36 2011
From: xie at yihui.name (Yihui Xie)
Date: Wed, 4 May 2011 21:16:36 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <4DC19BE6.10805@gmail.com>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
	<19904.63996.415478.695901@stat.math.ethz.ch>
	<BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>
	<4DC19BE6.10805@gmail.com>
Message-ID: <BANLkTimq2gS3DSbUKHWgPvDMhKfEH7uXyQ@mail.gmail.com>

First, you are still able to install multiple versions of R to any
places that you want -- I was suggesting a default place to install R
under Windows. If you remember the process of installing R under
Windows, there is a step in which you can choose where to install R.

Second, to modify the PATH variable won't affect reproducibility. It
seems people have got a wrong impression that after the PATH variable
is modified, we are forced to use the single version of R under the
PATH. You are still free to use any versions of R. The only effect is
that if you run R as a command, it will be the version which is under
the PATH. Do you run your Sweave documents via "R CMD Sweave"? If not,
this will not affect you.

If people are really uncomfortable with the PATH variable being
modified, we can make this *optional* just like what Rtools does. If
we are so worried about all these kinds of problems, do we need to
worry about Rtools as well?

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Wed, May 4, 2011 at 1:33 PM, Kevin R. Coombes
<kevin.r.coombes at gmail.com> wrote:
> There are plenty of good reasons for non-developers to run different
> versions of R. ?For instance, I care a lot about reproducibility. With every
> new release of R, lots of things change. ?With every new release of the
> packages I use, lots of things change. ?All of my analyses are performed
> using Sweave, and every report includes a call to sessionInfo so that the
> versions are recorded in the final report. ?If I have to go back and tweak
> something in a report (say, to regenerate a figure in a format more suitable
> for publication), I do not want the rest of the analysis to change. ?So I
> have to run the correct (possibly older) version of R. ?All of the stat
> analysts that we train follow the same practice.
>
> As a result, I am strongly opposed to an installation that automatically
> mucks with the path to R.
>
> ? ?Kevin
>
> On 5/4/2011 11:00 AM, Yihui Xie wrote:
>>
>> My suggestion was to mimic *nix systems: put the executable binaries
>> in the same place *by default* (e.g. /usr/bin/ or /usr/local/bin). Why
>> isn't the default bin path for R under *nix something like
>> /usr/bin/R-2.13.0/? If the users want to install multiple versions,
>> they still have the choice to install them elsewhere. I'm not denying
>> the possible necessity of having multiple versions in a system. In my
>> opinion, the default values should be set according to probabilities:
>> is it more likely for a user to use multiple versions or a single
>> version of R? Of course, all of you are developers and the former
>> probability might be higher, but I don't think many users will run the
>> script A with R 2.12.1 and script B with R 2.13.0. The most typical
>> situation I have seen is, (Windows) people install R and will forget
>> to update it forever. I often have to urge our IT admin to update R in
>> our department from a version released long long ago. You may argue my
>> samples are not representative. Anyway, I can accept the default
>> version string if nobody agrees with me.
>>
>> I do use Emacs every day. It's nice, I totally agree.
>>
>> Regards,
>> Yihui
>> --
>> Yihui Xie<xieyihui at gmail.com>
>> Phone: 515-294-2465 Web: http://yihui.name
>> Department of Statistics, Iowa State University
>> 2215 Snedecor Hall, Ames, IA
>


From xie at yihui.name  Thu May  5 04:28:24 2011
From: xie at yihui.name (Yihui Xie)
Date: Wed, 4 May 2011 21:28:24 -0500
Subject: [Rd] Wishlist: write R's bin path to the PATH variable and
 remove the version string in the installation dir under Windows
In-Reply-To: <B9218D41-237E-44DF-A2F5-A93614014434@r-project.org>
References: <BANLkTikkAsmfmyspnVF_8kXPb-4WuB4now@mail.gmail.com>
	<4DC0A88A.4070908@gmail.com>
	<BANLkTikqoxO9+5iPH9_1D0-HKVxsQG15Hw@mail.gmail.com>
	<BANLkTi=xMs8TVSpT3_SG5d7=o=YCo_TePw@mail.gmail.com>
	<BANLkTimZiR8FN3aR9T1sdzPiOjbduqWp8A@mail.gmail.com>
	<19904.63996.415478.695901@stat.math.ethz.ch>
	<BANLkTimY+2LCh9HN3mBTnndz9uqhpF5JMg@mail.gmail.com>
	<B9218D41-237E-44DF-A2F5-A93614014434@r-project.org>
Message-ID: <BANLkTikn_30PWWfuLBj65kM6hA6coKdzJg@mail.gmail.com>

1. I know there is not such a thing; that why I said "mimic" and "the
same place" ("***/R/bin" instead of "***/R/R-x.x.x/bin").

2. Yes, I never mess with the PATH variable under *nix, because R is
installed to /usr/local/bin/ (or /usr/bin/) *by default*, which is
already in the PATH variable. Otherwise extra efforts will be required
to run R as a single letter R -- this is what I wish we were able to
do under Windows.

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Wed, May 4, 2011 at 12:55 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
> On May 4, 2011, at 12:00 PM, Yihui Xie wrote:
>
>> My suggestion was to mimic *nix systems: put the executable binaries in the same place *by default* (e.g. /usr/bin/ or /usr/local/bin).
>
> Except that there is not such thing on Windows! The closest to that is the "system" folder which is off limits for applications.
>
>
>> Why isn't the default bin path for R under *nix something like /usr/bin/R-2.13.0/?
>
> It is on some unices (and most system-wide installations in practice) - but that's beside the point. Unix has a well-defined FHS so regardless where you install R you can always put a symlink into /usr/bin or /usr/local/bin. Windows has no such conventions so Gabor's solution is pretty much what you claim to want (and note that in unix you're exactly running a batch script with its rhome embedded to start R!). Even on unix you don't mess with PATH to select the R version to use.
>


From mada.jlu at hotmail.com  Thu May  5 11:28:34 2011
From: mada.jlu at hotmail.com (dma)
Date: Thu, 5 May 2011 02:28:34 -0700 (PDT)
Subject: [Rd] what's R save terminal flag?
Message-ID: <1304587714439-3497940.post@n4.nabble.com>

When I save a R object through RConnection, how to determine when the data is
end in the RConnction's other side?

I print the data as integer. It seams the data was end with -2. Is there any
official document about that?

Thanks Dma


--
View this message in context: http://r.789695.n4.nabble.com/what-s-R-save-terminal-flag-tp3497940p3497940.html
Sent from the R devel mailing list archive at Nabble.com.


From hadley at rice.edu  Thu May  5 15:11:23 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 5 May 2011 08:11:23 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <79F23BA7BB084E4FA01A8B93904CD02CF669FAA4D7@WIGGUMVS.win.ad.jhu.edu>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
	<BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4D7@WIGGUMVS.win.ad.jhu.edu>
Message-ID: <BANLkTikvfsyZaW4wDB8sA-Z7G-rMQ+11Tg@mail.gmail.com>

> Thanks, Hadley. ?This (i.e., different ways to prepare curry) is quite instructive to me.

The following update makes the generated function look a little nicer
if you pass in the name of a function:

    Curry <- function(FUN, ...) {
      args <- match.call(expand.dots = FALSE)$...
      args$... <- as.name("...")

      if (is.name(FUN)) {
        fname <- FUN
      } else if (is.character(FUN)) {
        fname <- as.name(FUN)
      } else {
        fname <- as.name("FUN")
      }
      curry_call <- as.call(c(list(fname), args))
      eval(call("function", as.pairlist(alist(... = )), curry_call))
    }

And it seems to work ok in terms of preserving evaluation (I can't how
it could be any different to making the anonymous function yourself,
unless I've missed something subtle with environments and scoping)

> hadley <- 1:10
> plothadley <- Curry("plot", x = hadley)
> plothadley
function (...)
plot(x = hadley, ... = ...)
<environment: 0x1031d7c00>
> plothadley()
> plothadley(runif(10))

The only (minor) problem is that I couldn't figure out how to
construct the interior call to yield plot(x = hadley, ...)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Thu May  5 15:25:19 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 5 May 2011 08:25:19 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <BANLkTikvfsyZaW4wDB8sA-Z7G-rMQ+11Tg@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
	<BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4D7@WIGGUMVS.win.ad.jhu.edu>
	<BANLkTikvfsyZaW4wDB8sA-Z7G-rMQ+11Tg@mail.gmail.com>
Message-ID: <BANLkTikGcviLYfFska4vkf5GpuCpmKTdJw@mail.gmail.com>

> And it seems to work ok in terms of preserving evaluation (I can't how
> it could be any different to making the anonymous function yourself,
> unless I've missed something subtle with environments and scoping)

Which indeed I have.  Hmmm, need to think about this more.

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Thu May  5 15:32:14 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 5 May 2011 08:32:14 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <BANLkTikGcviLYfFska4vkf5GpuCpmKTdJw@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
	<BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4D7@WIGGUMVS.win.ad.jhu.edu>
	<BANLkTikvfsyZaW4wDB8sA-Z7G-rMQ+11Tg@mail.gmail.com>
	<BANLkTikGcviLYfFska4vkf5GpuCpmKTdJw@mail.gmail.com>
Message-ID: <BANLkTik-1s+Af541ZkM+mDVkjRx94WM_4w@mail.gmail.com>

On Thu, May 5, 2011 at 8:25 AM, Hadley Wickham <hadley at rice.edu> wrote:
>> And it seems to work ok in terms of preserving evaluation (I can't how
>> it could be any different to making the anonymous function yourself,
>> unless I've missed something subtle with environments and scoping)
>
> Which indeed I have. ?Hmmm, need to think about this more.

Ok, next version.  To follow the usual rules of function scope, we
need to make sure the environment of the function is set to the
environment in which it is created.

    Curry <- function(FUN, ...) {
      args <- match.call(expand.dots = FALSE)$...
      args$... <- as.name("...")

      env <- parent.frame()

      if (is.name(FUN)) {
        fname <- FUN
      } else if (is.character(FUN)) {
        fname <- as.name(FUN)
      } else if (is.function(FUN)){
        fname <- as.name("FUN")
        env$FUN <- FUN
      } else {
        stop("FUN not function or name of function")
      }
      curry_call <- as.call(c(list(fname), args))

      f <- eval(call("function", as.pairlist(alist(... = )), curry_call))
      environment(f) <- env
      f
    }

But I've probably forgotten something else.  Hopefully Luke will chime
in if I'm proceeding down a path that can never be made to work
completely correctly.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From bbolker at gmail.com  Thu May  5 15:42:33 2011
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 5 May 2011 13:42:33 +0000
Subject: [Rd] what's R save terminal flag?
References: <1304587714439-3497940.post@n4.nabble.com>
Message-ID: <loom.20110505T154107-879@post.gmane.org>

dma <mada.jlu <at> hotmail.com> writes:

> 
> When I save a R object through RConnection, how to determine when the data is
> end in the RConnction's other side?
> 
> I print the data as integer. It seams the data was end with -2. Is there any
> official document about that?
> 
> Thanks Dma
> 

  Please pick *either* r-help *or* Stack Overflow to post your question:
don't cross-post. 
(<http://stackoverflow.com/questions/5895356/whats-r-save-terminal-flag>)

  As always, reproducible examples are helpful: please see the R-help
posting guide.

  cheers
    Ben Bolker


From ggrothendieck at gmail.com  Thu May  5 15:56:27 2011
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 5 May 2011 09:56:27 -0400
Subject: [Rd] Curry: proposed new functional programming, er, function.
In-Reply-To: <BANLkTik-1s+Af541ZkM+mDVkjRx94WM_4w@mail.gmail.com>
References: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>
	<BANLkTi=jud5hhis5y-veQKZHzSYYoPqnBw@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4C9@WIGGUMVS.win.ad.jhu.edu>
	<4DC16917.5090206@gmail.com>
	<BANLkTikuy3OP8j5aymKuE_zmHtYLCkBZWg@mail.gmail.com>
	<79F23BA7BB084E4FA01A8B93904CD02CF669FAA4D7@WIGGUMVS.win.ad.jhu.edu>
	<BANLkTikvfsyZaW4wDB8sA-Z7G-rMQ+11Tg@mail.gmail.com>
	<BANLkTikGcviLYfFska4vkf5GpuCpmKTdJw@mail.gmail.com>
	<BANLkTik-1s+Af541ZkM+mDVkjRx94WM_4w@mail.gmail.com>
Message-ID: <BANLkTi=D4yC8SUZe+aNarn3VivHFGHCC_g@mail.gmail.com>

On Thu, May 5, 2011 at 9:32 AM, Hadley Wickham <hadley at rice.edu> wrote:
> On Thu, May 5, 2011 at 8:25 AM, Hadley Wickham <hadley at rice.edu> wrote:
>>> And it seems to work ok in terms of preserving evaluation (I can't how
>>> it could be any different to making the anonymous function yourself,
>>> unless I've missed something subtle with environments and scoping)
>>
>> Which indeed I have. ?Hmmm, need to think about this more.
>
> Ok, next version. ?To follow the usual rules of function scope, we
> need to make sure the environment of the function is set to the
> environment in which it is created.
>
> ? ?Curry <- function(FUN, ...) {
> ? ? ?args <- match.call(expand.dots = FALSE)$...
> ? ? ?args$... <- as.name("...")
>
> ? ? ?env <- parent.frame()
>
> ? ? ?if (is.name(FUN)) {
> ? ? ? ?fname <- FUN
> ? ? ?} else if (is.character(FUN)) {
> ? ? ? ?fname <- as.name(FUN)
> ? ? ?} else if (is.function(FUN)){
> ? ? ? ?fname <- as.name("FUN")
> ? ? ? ?env$FUN <- FUN
> ? ? ?} else {
> ? ? ? ?stop("FUN not function or name of function")
> ? ? ?}
> ? ? ?curry_call <- as.call(c(list(fname), args))
>
> ? ? ?f <- eval(call("function", as.pairlist(alist(... = )), curry_call))
> ? ? ?environment(f) <- env
> ? ? ?f
> ? ?}
>
> But I've probably forgotten something else. ?Hopefully Luke will chime
> in if I'm proceeding down a path that can never be made to work
> completely correctly.
>

There is some question of whether it should default to the current
environment or the original function's environment.  If the curried
function were regarded as part of a new object whose environment is
the current environment then having the current environment (i.e.  the
object's environment) makes sense but if its regarded purely as an
operation on the original function then the original function's
environment makes more sense.  In any case, an envir= argument to
allow the user to specify it would be desirable.  Perhaps it could
specify the environment to assign (or if a logical or keyword were
specified it would indicate which of the two possibilities just
mentioned to use to make the common choices easy to specify).


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From detlef.steuer at hsu-hamburg.de  Thu May  5 16:50:42 2011
From: detlef.steuer at hsu-hamburg.de (Detlef Steuer)
Date: Thu, 5 May 2011 16:50:42 +0200
Subject: [Rd] problem with location of libraries 64-bit (opensuse)
Message-ID: <20110505165042.24ab4348@gaia.hsu-hh.de>

Dear list, 

there seems to be a problem with the standard location of R?s 64-bit libs
at least under openSUSE.

I had two user questions regarding the compilation of rpy2 for 64-bit systems.
Personally I don`t know rpy2 but maybe someone on this list can decide if
the mistake lies on R`s side or on rpy2?s side or in between.

R-devel is installed in these cases, I asked. Latest R-base or R-patched is used.

The following problem occurs (user report):

-----------------------
> Python 2.7 (r27:82500, Aug 07 2010, 16:54:59) [GCC] on linux2
> Type "help", "copyright", "credits" or "license" for more information.  
> >>> import rpy2.robjects as robjects  
> Traceback (most recent call last):
> File "<stdin>", line 1, in <module>
> File "/usr/local/lib64/python2.7/site-packages/rpy2/robjects/__init__.py",
> line 12, in <module> import rpy2.rinterface as rinterface
> File
> "/usr/local/lib64/python2.7/site-packages/rpy2/rinterface/__init__.py",
> line 66, in <module> from rpy2.rinterface.rinterface import *
> ImportError: /usr/lib64/R/lib/libRlapack.so: undefined symbol:
> _gfortran_concat_string
----------------------


So there are difficulties with  lapack/fortran libs.

An older version of apparently the same error can be found here:
http://www.mail-archive.com/animov at faunalia.it/msg00311.html

Another user reported the following:

----
After installing the R devel version with Yast on the 11.4 64 system there  
was a link at this location :

/usr/lib64/libRlapack.so

and the actual file was here :

/usr/lib64/R/lib/libRlapack.so


I compiled R from source :

./configure --prefix=/usr --enable-R-shlib
make
make install

The make install step did not copy the new *.so files to /usr/lib64/R/lib
therefore I manually copied the new libRlapack.so , libR.so and libRblas.so

After that the python rpy2 library loaded and all was ok.

I hope this will help you to identify this issue .
------

Because he had to manually copy over libs after installing from source maybe 
there is an easy improvement on the side of R`s installation routines? Some ldconfig call missing or something? 
Or is this an opensuse specific problem?

Any hint appreciated.

Detlef
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110505/ad6ce876/attachment.bin>

From simon.urbanek at r-project.org  Thu May  5 17:16:46 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 5 May 2011 11:16:46 -0400
Subject: [Rd] problem with location of libraries 64-bit (opensuse)
In-Reply-To: <20110505165042.24ab4348@gaia.hsu-hh.de>
References: <20110505165042.24ab4348@gaia.hsu-hh.de>
Message-ID: <6BEF8C75-BC37-4CD6-8F98-4822BDA38DA0@r-project.org>

Detlef,

On May 5, 2011, at 10:50 AM, Detlef Steuer wrote:

> Dear list, 
> 
> there seems to be a problem with the standard location of R?s 64-bit libs
> at least under openSUSE.
> 
> I had two user questions regarding the compilation of rpy2 for 64-bit systems.
> Personally I don`t know rpy2 but maybe someone on this list can decide if
> the mistake lies on R`s side or on rpy2?s side or in between.
> 
> R-devel is installed in these cases, I asked. Latest R-base or R-patched is used.
> 
> The following problem occurs (user report):
> 
> -----------------------
>> Python 2.7 (r27:82500, Aug 07 2010, 16:54:59) [GCC] on linux2
>> Type "help", "copyright", "credits" or "license" for more information.  
>>>>> import rpy2.robjects as robjects  
>> Traceback (most recent call last):
>> File "<stdin>", line 1, in <module>
>> File "/usr/local/lib64/python2.7/site-packages/rpy2/robjects/__init__.py",
>> line 12, in <module> import rpy2.rinterface as rinterface
>> File
>> "/usr/local/lib64/python2.7/site-packages/rpy2/rinterface/__init__.py",
>> line 66, in <module> from rpy2.rinterface.rinterface import *
>> ImportError: /usr/lib64/R/lib/libRlapack.so: undefined symbol:
>> _gfortran_concat_string
> ----------------------
> 
> 
> So there are difficulties with  lapack/fortran libs.
> 

Yes, libgfortran is not loaded. You'll have to look at ldd output to see why - see further down.


> An older version of apparently the same error can be found here:
> http://www.mail-archive.com/animov at faunalia.it/msg00311.html
> 
> Another user reported the following:
> 
> ----
> After installing the R devel version with Yast on the 11.4 64 system there  
> was a link at this location :
> 
> /usr/lib64/libRlapack.so
> 
> and the actual file was here :
> 
> /usr/lib64/R/lib/libRlapack.so
> 
> 
> I compiled R from source :
> 
> ./configure --prefix=/usr --enable-R-shlib
> make
> make install
> 
> The make install step did not copy the new *.so files to /usr/lib64/R/lib
> therefore I manually copied the new libRlapack.so , libR.so and libRblas.so
> 
> After that the python rpy2 library loaded and all was ok.
> 
> I hope this will help you to identify this issue .

This shows that rpy2 doesn't setup up the environment correctly (see the R script for the necessary settings). libR* are NOT supposed to the in /usr/lib64 - it is a bad hack and very dangerous (programs may pick the incorrect R libraries). Given that the setup is already messed up it's hard to tell what causes the gfortran problem. I don't have any SuSE around (they all died out long time ago) but to illustrate how things are supposed to work let's have a look at Debian (R installed from sources):

Inside R/lib there are the internal R libraries, again, they are NOT supposed to be at the system level:
urbanek at ix:/usr/local/R/2.13/lib/amd64$ ls libR*
libRblas.so  libRlapack.so  libR.so

so use ldd to see what they load:

urbanek at ix:/usr/local/R/2.13/lib/amd64$ ldd libRlapack.so 
	linux-vdso.so.1 =>  (0x00007fff602fa000)
	libRblas.so => not found
	libgomp.so.1 => /usr/lib/libgomp.so.1 (0x00007fbc5c3b4000)
	libpthread.so.0 => /lib/libpthread.so.0 (0x00007fbc5c197000)
	libc.so.6 => /lib/libc.so.6 (0x00007fbc5be36000)
	librt.so.1 => /lib/librt.so.1 (0x00007fbc5bc2e000)
	/lib64/ld-linux-x86-64.so.2 (0x00007fbc5c94d000)

urbanek at ix:/usr/local/R/2.13/lib/amd64$ ldd libRblas.so 
	linux-vdso.so.1 =>  (0x00007fff27bff000)
	libgfortran.so.3 => /usr/lib/libgfortran.so.3 (0x00007f9662988000)
	libm.so.6 => /lib/libm.so.6 (0x00007f9662706000)
	libgomp.so.1 => /usr/lib/libgomp.so.1 (0x00007f96624f8000)
	libpthread.so.0 => /lib/libpthread.so.0 (0x00007f96622dc000)
	libc.so.6 => /lib/libc.so.6 (0x00007f9661f7b000)
	librt.so.1 => /lib/librt.so.1 (0x00007f9661d72000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f9662eb1000)

so as you see, lapack links to blas which in turn links to gfortran. So if you load lapack you'll get gfortran vis blas. In your setup you are missing the link to gfortran for one reason or another. So check your setup with ldd to see why. I think it's highly likely that rpy2 is to blame, because R itself would not run if the fault would be in R.

Cheers,
Simon


> ------
> 
> Because he had to manually copy over libs after installing from source maybe 
> there is an easy improvement on the side of R`s installation routines? Some ldconfig call missing or something? 
> Or is this an opensuse specific problem?
> 
> Any hint appreciated.
> 
> Detlef
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From arthur.charpentier at gmail.com  Thu May  5 20:31:59 2011
From: arthur.charpentier at gmail.com (Arthur Charpentier)
Date: Thu, 5 May 2011 14:31:59 -0400
Subject: [Rd] matrix not positive definite (while it should be)
Message-ID: <BANLkTi=Qs53_EkwEKpxtnptcgFYF=0Gg2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110505/2223bda9/attachment.pl>

From josh.m.ulrich at gmail.com  Thu May  5 20:54:10 2011
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 5 May 2011 13:54:10 -0500
Subject: [Rd] median and data frames
In-Reply-To: <19898.51781.659704.798338@stat.math.ethz.ch>
References: <4DB85617.8090706@pburns.seanet.com>
	<BANLkTin6Cic0RhGdV_KWHcSz6JE5vj9igA@mail.gmail.com>
	<19898.51781.659704.798338@stat.math.ethz.ch>
Message-ID: <BANLkTinoAnZkKy+b8fKuJJ+_+31MAmyNOQ@mail.gmail.com>

On Fri, Apr 29, 2011 at 9:25 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Paul Johnson <pauljohn32 at gmail.com>
>>>>>> ? ? on Thu, 28 Apr 2011 00:20:27 -0500 writes:
>
> ? ?> On Wed, Apr 27, 2011 at 12:44 PM, Patrick Burns
> ? ?> <pburns at pburns.seanet.com> wrote:
> ? ?>> Here are some data frames:
> ? ?>>
> ? ?>> df3.2 <- data.frame(1:3, 7:9)
> ? ?>> df4.2 <- data.frame(1:4, 7:10)
> ? ?>> df3.3 <- data.frame(1:3, 7:9, 10:12)
> ? ?>> df4.3 <- data.frame(1:4, 7:10, 10:13)
> ? ?>> df3.4 <- data.frame(1:3, 7:9, 10:12, 15:17)
> ? ?>> df4.4 <- data.frame(1:4, 7:10, 10:13, 15:18)
> ? ?>>
> ? ?>> Now here are some commands and their answers:
>
> ? ?>>> median(df4.4)
> ? ?>> [1] ?8.5 11.5
> ? ?>>> median(df3.2[c(1,2,3),])
> ? ?>> [1] 2 8
> ? ?>>> median(df3.2[c(1,3,2),])
> ? ?>> [1] ?2 NA
> ? ?>> Warning message:
> ? ?>> In mean.default(X[[2L]], ...) :
> ? ?>> ?argument is not numeric or logical: returning NA
> ? ?>>
> ? ?>>
> ? ?>>
> ? ?>> The sessionInfo is below, but it looks
> ? ?>> to me like the present behavior started
> ? ?>> in 2.10.0.
> ? ?>>
> ? ?>> Sometimes it gets the right answer. ?I'd
> ? ?>> be grateful to hear how it does that -- I
> ? ?>> can't figure it out.
> ? ?>>
>
> ? ?> Hello, Pat.
>
> ? ?> Nice poetry there! ?I think I have an actual answer, as opposed to the
> ? ?> usual crap I spew.
>
> ? ?> I would agree if you said median.data.frame ought to be written to
> ? ?> work columnwise, similar to mean.data.frame.
>
> ? ?> apply and sapply ?always give the correct answer
>
> ? ?>> apply(df3.3, 2, median)
> ? ?> X1.3 ? X7.9 X10.12
> ? ?> 2 ? ? ?8 ? ? 11
>
> ? ?[...........]
>
> exactly
>
> ? ?> mean.data.frame is now implemented as
>
> ? ?> mean.data.frame <- function(x, ...) sapply(x, mean, ...)
>
> exactly.
>
> My personal oppinion is that ?mean.data.frame() should never have
> been written.
> People should know, or learn, to use apply functions for such a
> task.
>
> The unfortunate fact that mean.data.frame() exists makes people
> think that median.data.frame() should too,
> and then
>
> ?var.data.frame()
> ? sd.data.frame()
> ?mad.data.frame()
> ?min.data.frame()
> ?max.data.frame()
> ?...
> ?...
>
> all just in order to *not* to have to know ?sapply()
> ????
>
> No, rather not.
>
> My vote is for deprecating ?mean.data.frame().
>
> Martin
>

I agree.  However, sd() isn't currently (as of R-2.13.0) generic and
it operates by column for matrix and data.frame objects, so it behaves
a bit more like mean() and is similarly inconsistent from the other
listed functions.  I have no input on how this should be handled, but
thought it may be worth addressing.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


From detlef.steuer at hsu-hamburg.de  Thu May  5 21:55:27 2011
From: detlef.steuer at hsu-hamburg.de (Detlef Steuer)
Date: Thu, 5 May 2011 21:55:27 +0200
Subject: [Rd] problem with location of libraries 64-bit (opensuse)
In-Reply-To: <6BEF8C75-BC37-4CD6-8F98-4822BDA38DA0@r-project.org>
References: <20110505165042.24ab4348@gaia.hsu-hh.de>
	<6BEF8C75-BC37-4CD6-8F98-4822BDA38DA0@r-project.org>
Message-ID: <20110505215527.157ed249@rechenknecht.site>

Simon,

thank you very much for the detailed answer.

> This shows that rpy2 doesn't setup up the environment correctly (see the R script for the necessary settings). libR* are NOT supposed to the in /usr/lib64 - it is a bad hack and very dangerous (programs may pick the incorrect R libraries). Given that the setup is already messed up it's hard to tell what causes the gfortran problem. 


Ok, this mess up is easily identified. In my spec file I link
$libdir/R/lib/libRblas.so to $libdir/libRblas.so and the same for libR
and liblapack. Hmm. It works that way for ages, I can`t even vaguely
remember when and why I introduced that. 
Now I`ve build  R-patched with these links removed. 
At least "here it works". May be that cures rpy2, too.

Thx again
Detlef


From mailinglist.honeypot at gmail.com  Thu May  5 19:07:14 2011
From: mailinglist.honeypot at gmail.com (Steve Lianoglou)
Date: Thu, 5 May 2011 13:07:14 -0400
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
	<BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>
	<BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
Message-ID: <BANLkTinDgP3BZLvdXWOn=SBdOCt4DYEuuw@mail.gmail.com>

On Wed, May 4, 2011 at 9:24 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Wed, May 4, 2011 at 2:21 PM, Hadley Wickham <hadley at rice.edu> wrote:
>
>> Any hints as to what to search for?
>
> ?For recursive objects, search for recursive objects.

Awesome :-)

And completely OT but strangely related -- in case you've never
stumbled on this gem:

google for "recursion" and look for Google's "Did you mean" suggestion ...

-- 
Steve Lianoglou
Graduate Student: Computational Systems Biology
?| Memorial Sloan-Kettering Cancer Center
?| Weill Medical College of Cornell University
Contact Info: http://cbio.mskcc.org/~lianos/contact


From dwinsemius at comcast.net  Thu May  5 22:30:03 2011
From: dwinsemius at comcast.net (David Winsemius)
Date: Thu, 5 May 2011 16:30:03 -0400
Subject: [Rd] Recursive objects
In-Reply-To: <BANLkTinDgP3BZLvdXWOn=SBdOCt4DYEuuw@mail.gmail.com>
References: <BANLkTi=jOrtXY-njYJu7Z7pmokSzLDPfkA@mail.gmail.com>
	<alpine.DEB.2.00.1105040752190.4973@luke-inspiron>
	<BANLkTi=P6cZRXqdGfs8pv+0p7nTN-Gb4Ew@mail.gmail.com>
	<BANLkTimnMOWwKs9BGGeCDoU-5kkzUnazrg@mail.gmail.com>
	<BANLkTinDgP3BZLvdXWOn=SBdOCt4DYEuuw@mail.gmail.com>
Message-ID: <672045BE-819C-4CB2-81E4-1AA84B1B03F8@comcast.net>


On May 5, 2011, at 1:07 PM, Steve Lianoglou wrote:

> On Wed, May 4, 2011 at 9:24 AM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>> On Wed, May 4, 2011 at 2:21 PM, Hadley Wickham <hadley at rice.edu>  
>> wrote:
>>
>>> Any hints as to what to search for?
>>
>>  For recursive objects, search for recursive objects.
>
> Awesome :-)
>
> And completely OT but strangely related -- in case you've never
> stumbled on this gem:
>
> google for "recursion" and look for Google's "Did you mean"  
> suggestion ...

Man  ... sometimes I am so slow!

>
> -- 
> Steve Lianoglou
> Graduate Student: Computational Systems Biology
>  | Memorial Sloan-Kettering Cancer Center
>  | Weill Medical College of Cornell University
> Contact Info: http://cbio.mskcc.org/~lianos/contact
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

David Winsemius, MD
West Hartford, CT


From znmeb at borasky-research.net  Fri May  6 02:09:30 2011
From: znmeb at borasky-research.net (M. Edward (Ed) Borasky)
Date: Thu, 5 May 2011 17:09:30 -0700
Subject: [Rd] problem with location of libraries 64-bit (opensuse)
In-Reply-To: <20110505215527.157ed249@rechenknecht.site>
References: <20110505165042.24ab4348@gaia.hsu-hh.de>
	<6BEF8C75-BC37-4CD6-8F98-4822BDA38DA0@r-project.org>
	<20110505215527.157ed249@rechenknecht.site>
Message-ID: <BANLkTimQQr1N4K-7cJc=OhszagGy2savew@mail.gmail.com>

 I've got an openSUSE 11.4 machine using R-patched - do I need to
change anything?

On Thu, May 5, 2011 at 12:55 PM, Detlef Steuer
<detlef.steuer at hsu-hamburg.de> wrote:
> Simon,
>
> thank you very much for the detailed answer.
>
>> This shows that rpy2 doesn't setup up the environment correctly (see the R script for the necessary settings). libR* are NOT supposed to the in /usr/lib64 - it is a bad hack and very dangerous (programs may pick the incorrect R libraries). Given that the setup is already messed up it's hard to tell what causes the gfortran problem.
>
>
> Ok, this mess up is easily identified. In my spec file I link
> $libdir/R/lib/libRblas.so to $libdir/libRblas.so and the same for libR
> and liblapack. Hmm. It works that way for ages, I can`t even vaguely
> remember when and why I introduced that.
> Now I`ve build ?R-patched with these links removed.
> At least "here it works". May be that cures rpy2, too.
>
> Thx again
> Detlef
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
http://twitter.com/znmeb?http://borasky-research.net

"A mathematician is a device for turning coffee into theorems." -- Paul Erd?s


From detlef.steuer at hsu-hamburg.de  Fri May  6 08:57:06 2011
From: detlef.steuer at hsu-hamburg.de (Detlef Steuer)
Date: Fri, 6 May 2011 08:57:06 +0200
Subject: [Rd] problem with location of libraries 64-bit (opensuse)
In-Reply-To: <BANLkTimQQr1N4K-7cJc=OhszagGy2savew@mail.gmail.com>
References: <20110505165042.24ab4348@gaia.hsu-hh.de>
	<6BEF8C75-BC37-4CD6-8F98-4822BDA38DA0@r-project.org>
	<20110505215527.157ed249@rechenknecht.site>
	<BANLkTimQQr1N4K-7cJc=OhszagGy2savew@mail.gmail.com>
Message-ID: <20110506085706.44d4b817@gaia.hsu-hh.de>

Short answer: No!

I`ll just change/improve the procedure R is built.
Download R-patched tomorrow and some internals a "ordinary" user won`t notice will be changed. 

Detlef

On Thu, 5 May 2011 17:09:30 -0700
"M. Edward (Ed) Borasky" <znmeb at borasky-research.net> wrote:

>  I've got an openSUSE 11.4 machine using R-patched - do I need to
> change anything?
> 
> On Thu, May 5, 2011 at 12:55 PM, Detlef Steuer
> <detlef.steuer at hsu-hamburg.de> wrote:
> > Simon,
> >
> > thank you very much for the detailed answer.
> >
> >> This shows that rpy2 doesn't setup up the environment correctly (see the R script for the necessary settings). libR* are NOT supposed to the in /usr/lib64 - it is a bad hack and very dangerous (programs may pick the incorrect R libraries). Given that the setup is already messed up it's hard to tell what causes the gfortran problem.
> >
> >
> > Ok, this mess up is easily identified. In my spec file I link
> > $libdir/R/lib/libRblas.so to $libdir/libRblas.so and the same for libR
> > and liblapack. Hmm. It works that way for ages, I can`t even vaguely
> > remember when and why I introduced that.
> > Now I`ve build ?R-patched with these links removed.
> > At least "here it works". May be that cures rpy2, too.
> >
> > Thx again
> > Detlef
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> 
> 
> -- 
> http://twitter.com/znmeb?http://borasky-research.net
> 
> "A mathematician is a device for turning coffee into theorems." -- Paul Erd?s
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110506/42167fe3/attachment.bin>

From savicky at cs.cas.cz  Fri May  6 09:20:17 2011
From: savicky at cs.cas.cz (Petr Savicky)
Date: Fri, 6 May 2011 09:20:17 +0200
Subject: [Rd] matrix not positive definite (while it should be)
In-Reply-To: <BANLkTi=Qs53_EkwEKpxtnptcgFYF=0Gg2g@mail.gmail.com>
References: <BANLkTi=Qs53_EkwEKpxtnptcgFYF=0Gg2g@mail.gmail.com>
Message-ID: <20110506072017.GA19623@cs.cas.cz>

On Thu, May 05, 2011 at 02:31:59PM -0400, Arthur Charpentier wrote:
> I do have some trouble with matrices. I want to build up a covariance matrix
> with a hierarchical structure). For instance, in dimension n=10, I have two
> subgroups (called REGION).
> 
> NR=2; n=10
> CORRELATION=matrix(c(0.4,-0.25,
>                      -0.25,0.3),NR,NR)
> REGION=sample(1:NR,size=n,replace=TRUE)
> R1=REGION%*%t(rep(1,n))
> R2=rep(1,n)%*%t(REGION)
> SIGMA=matrix(NA,n,n)
> 
> for(i in 1:NR){
> for(j in 1:NR){
> SIGMA[(R1==i)&(R2==j)]=CORRELATION[i,j]
> }}
> 
> If I run quickly some simulations, I build up the following matrix
> 
> > CORRELATION
>       [,1]  [,2]
> [1,]  0.40 -0.25
> [2,] -0.25  0.30
> > REGION
>  [1] 2 2 1 1 2 1 2 1 1 2
> > SIGMA
>        [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
>  [1,]  0.30  0.30 -0.25 -0.25  0.30 -0.25  0.30 -0.25 -0.25  0.30
>  [2,]  0.30  0.30 -0.25 -0.25  0.30 -0.25  0.30 -0.25 -0.25  0.30
>  [3,] -0.25 -0.25  0.40  0.40 -0.25  0.40 -0.25  0.40  0.40 -0.25
>  [4,] -0.25 -0.25  0.40  0.40 -0.25  0.40 -0.25  0.40  0.40 -0.25
>  [5,]  0.30  0.30 -0.25 -0.25  0.30 -0.25  0.30 -0.25 -0.25  0.30
>  [6,] -0.25 -0.25  0.40  0.40 -0.25  0.40 -0.25  0.40  0.40 -0.25
>  [7,]  0.30  0.30 -0.25 -0.25  0.30 -0.25  0.30 -0.25 -0.25  0.30
>  [8,] -0.25 -0.25  0.40  0.40 -0.25  0.40 -0.25  0.40  0.40 -0.25
>  [9,] -0.25 -0.25  0.40  0.40 -0.25  0.40 -0.25  0.40  0.40 -0.25
> [10,]  0.30  0.30 -0.25 -0.25  0.30 -0.25  0.30 -0.25 -0.25  0.30

Hi.

If X is a random vector from the 2 dimensional normal distribution
with the covariance matrix

        [,1]  [,2]
  [1,]  0.40 -0.25
  [2,] -0.25  0.30

then the vector X[REGION], which consists of replicated components
of X, has the expanded covariance matrix n times n, which you ask
for. Since the mean and the covariance matrix determine the distribution
uniquely, this is also a description of the required distribution.

The distribution is concentrated in a 2 dimensional subspace, since
the covariance matrix has rank 2.

Hope this helps.

Petr Savicky.


From arthur.charpentier at gmail.com  Fri May  6 15:33:50 2011
From: arthur.charpentier at gmail.com (Arthur Charpentier)
Date: Fri, 6 May 2011 09:33:50 -0400
Subject: [Rd] matrix not positive definite (while it should be)
In-Reply-To: <20110506072017.GA19623@cs.cas.cz>
References: <BANLkTi=Qs53_EkwEKpxtnptcgFYF=0Gg2g@mail.gmail.com>
	<20110506072017.GA19623@cs.cas.cz>
Message-ID: <BANLkTim6LQa+7b+kCUgR6-4G5B0JBZNACw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110506/6053854b/attachment.pl>

From arthur.charpentier at gmail.com  Fri May  6 15:42:13 2011
From: arthur.charpentier at gmail.com (Arthur Charpentier)
Date: Fri, 6 May 2011 09:42:13 -0400
Subject: [Rd] matrix not positive definite (while it should be)
In-Reply-To: <BANLkTim6LQa+7b+kCUgR6-4G5B0JBZNACw@mail.gmail.com>
References: <BANLkTi=Qs53_EkwEKpxtnptcgFYF=0Gg2g@mail.gmail.com>
	<20110506072017.GA19623@cs.cas.cz>
	<BANLkTim6LQa+7b+kCUgR6-4G5B0JBZNACw@mail.gmail.com>
Message-ID: <BANLkTi=XyT_Uzpq0Vj82UvoSZViK53VUqw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110506/9d152706/attachment.pl>

From pgilbert at bank-banque-canada.ca  Fri May  6 17:04:51 2011
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 6 May 2011 15:04:51 +0000
Subject: [Rd] fortan common block
Message-ID: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110506/36f65161/attachment.pl>

From murdoch.duncan at gmail.com  Fri May  6 17:17:28 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 06 May 2011 11:17:28 -0400
Subject: [Rd] fortan common block
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
References: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <4DC41108.2020701@gmail.com>

On 06/05/2011 11:04 AM, Paul Gilbert wrote:
> Is it possible in R to call a fortran routine that sets variables in a common block and expect the values to persist when a call is made from R to a second routine that uses the common block?

I think the stats package does this; see src/library/stats/src/ppr.f.  
The Fortran functions don't "know" that R is doing the calling, so 
they'll set and read values as if they were called from a Fortran main 
program.

Duncan Murdoch

> If not (as I suspect),  is it possible to use a common block in a group of routines that are used together, for as long the routines do not return to R?
>
> Paul
> ====================================================================================
>
> La version fran??aise suit le texte anglais.
>
> ------------------------------------------------------------------------------------
>
> This email may contain privileged and/or confidential information, and the Bank of
> Canada does not waive any related rights. Any distribution, use, or copying of this
> email or the information it contains by other than the intended recipient is
> unauthorized. If you received this email in error please delete it immediately from
> your system and notify the sender promptly by email that you have done so.
>
> ------------------------------------------------------------------------------------
>
> Le pr??sent courriel peut contenir de l'information privil??gi??e ou confidentielle.
> La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute diffusion,
> utilisation ou copie de ce courriel ou des renseignements qu'il contient par une
> personne autre que le ou les destinataires d??sign??s est interdite. Si vous recevez
> ce courriel par erreur, veuillez le supprimer imm??diatement et envoyer sans d??lai ? 
> l'exp??diteur un message ??lectronique pour l'aviser que vous avez ??limin?? de votre
> ordinateur toute copie du courriel re??u.
>
> 	[[alternative HTML version deleted]]
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mtmorgan at fhcrc.org  Fri May  6 18:58:48 2011
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 06 May 2011 09:58:48 -0700
Subject: [Rd] Windows Rzlib.dll gzopen and friends
In-Reply-To: <4DBB381E.7020601@fhcrc.org>
References: <4DBB381E.7020601@fhcrc.org>
Message-ID: <4DC428C8.1000300@fhcrc.org>

This change has significant consequences for Windows packages using R's 
zlib, including packages providing core Bioconductor functionality. Are 
the changes in r55624 meant to be long-term?

Martin

On 04/29/2011 03:13 PM, Martin Morgan wrote:
> Several Bioconductor packages were expecting Windows Rzlib.dll to
> provide gzopen / gzread / gzseek / gzgets / gzrewind / gzclose. Are
> these gone for good, viz., r55624 ?
>
> Martin


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From sean.mcguffee at gmail.com  Fri May  6 19:23:00 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 06 May 2011 13:23:00 -0400
Subject: [Rd] cerr and cout not working
Message-ID: <C9E9A6B4.4097%sean.mcguffee@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110506/aa03286c/attachment.pl>

From sean.mcguffee at gmail.com  Fri May  6 20:21:01 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 06 May 2011 14:21:01 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
Message-ID: <C9E9B44D.409E%sean.mcguffee@gmail.com>

Hi,

Sorry, I just tried posting this but I had it in the wrong format of text,
so this is a cleared format repost:

I?m trying to call some of my c++ code from R and seem to be having an issue
with streams, although that?s just one obvious sign of something different
in performance between calling the same function from main in c++ vs.
calling the same function from R. I?m not getting any signs of errors from
R, but the behavior is different somehow and in a way that breaks my
algorithms. In both cases of launching a function from c++ or R, I redirect
cout to a file using a streambuf. In particular, I can see progress stop
when launching from R at a point when cout gets truncated when starting to
write out iterator values in a std::vector<string>. Then, I find no way to
write anything else to cout. When I write those values to Rprintf, they are
there and they are as expected. I?ve tried setting
ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
somehow, but that made no difference. I?m not quite sure how R uses those C
FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
be going on. At this point I don?t know if it might be an issue with R not
completely handling c++ from a library or if it is an issue with cout in
particular or if there is something else I?m missing. Please let me know if
you have any suggestions for me.

Thanks,
Sean


From edd at debian.org  Fri May  6 20:41:49 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 6 May 2011 13:41:49 -0500
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <C9E9B44D.409E%sean.mcguffee@gmail.com>
References: <C9E9B44D.409E%sean.mcguffee@gmail.com>
Message-ID: <19908.16621.998499.588171@max.nulle.part>


On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
| Hi,
| 
| Sorry, I just tried posting this but I had it in the wrong format of text,
| so this is a cleared format repost:
| 
| I?m trying to call some of my c++ code from R and seem to be having an issue
| with streams, although that?s just one obvious sign of something different
| in performance between calling the same function from main in c++ vs.
| calling the same function from R. I?m not getting any signs of errors from
| R, but the behavior is different somehow and in a way that breaks my
| algorithms. In both cases of launching a function from c++ or R, I redirect
| cout to a file using a streambuf. In particular, I can see progress stop
| when launching from R at a point when cout gets truncated when starting to
| write out iterator values in a std::vector<string>. Then, I find no way to
| write anything else to cout. When I write those values to Rprintf, they are
| there and they are as expected. I?ve tried setting
| ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
| somehow, but that made no difference. I?m not quite sure how R uses those C
| FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
| be going on. At this point I don?t know if it might be an issue with R not
| completely handling c++ from a library or if it is an issue with cout in
| particular or if there is something else I?m missing. Please let me know if
| you have any suggestions for me.

Doug Bates sometimes remarks that, once all other alternatives are exhausted,
one could consider reading the manual. And indeed, 'Writing R Extensions' has
this to say:

   5.6 Interfacing C++ code
   ========================

   [...]

      Using C++ iostreams, as in this example, is best avoided.  There is
   no guarantee that the output will appear in the R console, and indeed it
   will not on the R for Windows console.  Use R code or the C entry points
   (*note Printing::) for all I/O if at all possible.
   
In a nutshell, R 'owns' your console. That is part of the Faustian bargain.

Dirk

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com


From cubranic at stat.ubc.ca  Fri May  6 20:50:42 2011
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Fri, 6 May 2011 11:50:42 -0700
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <19908.16621.998499.588171@max.nulle.part>
References: <C9E9B44D.409E%sean.mcguffee@gmail.com>
	<19908.16621.998499.588171@max.nulle.part>
Message-ID: <36F4206A-461A-4159-91FB-92367B5FDB82@stat.ubc.ca>

On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:

> | I?m trying to call some of my c++ code from R and seem to be having an issue
> | with streams, although that?s just one obvious sign of something different
> | in performance between calling the same function from main in c++ vs.
> | calling the same function from R. [...]
> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.

But isn't he redirecting cout to a file, so the C++ output is not to the console?

Davor

From sean.mcguffee at gmail.com  Fri May  6 21:19:47 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 06 May 2011 15:19:47 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <19908.16621.998499.588171@max.nulle.part>
Message-ID: <C9E9C213.40A8%sean.mcguffee@gmail.com>

Hi,

Thanks for the comments so far.

I've been going through the code extensively and seem to be having trouble
reproducing what R is doing, so this confuses me. For example, when I write
out the pointer values for ptr_R_WriteConsole type functions, I can't find a
function that matches what is actually being called.

REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
R_WriteConsole);

It might be something like RTcl_WriteConsole too. However, I can't seem to
find the headers I would need to try to find it's pointer value. Anyway,
these are often hidden/protected/static which is an aspect of code that I
only understand in concept. The concept I understand about this type of
stuff is that if you provide a better way of doing things, then maybe you
hide some stuff that doesn't involve the better way. However, in this case,
the hidden stuff is just making it difficult for me to debug and get to
bottom of what is going on. Anyway, I get different results if I call on the
functions that simply use stdout when trying to reproduce Rprintf
functionality. I'm only doing that to try to get to the bottom of what R is
doing with stdout and stderr. I also am having a similar issue with trying
to understand what GNU GCC is doing with how it sync's cout and cerr with
stdout and stderr. Maybe R is intercepting some of these components. Anyway,

I was hoping to get around the
"5.6 Interfacing C++ code
   ========================   [...]
      Using C++ iostreams, as in this example, is best avoided.  There is
   no guarantee that the output will appear in the R console, and indeed it
   will not on the R for Windows console.  Use R code or the C entry points
   (*note Printing::) for all I/O if at all possible."
if at all possible. My reason is that I have 76386 lines of c++ code that
I'm trying to interface with R, and it literally might be faster for me to
update R rather than modify all of that code to suit R which seems to be
lacking a c++ ostream interface.

Ideally, I'd write rout and rerr versions of cout and cerr for R to become
more compatible with c++. I have had some trouble figuring a lot of this
hidden stuff out. Strategies I have considered are the following:
1) Write macros that conditionally replace cerr and cout with Rprintf
somehow throughout all of my c++ code that I'm trying to interface with R.
2) Recreate the std::cerr and std::cout type of classes but maybe add some
extra functionality for callbacks to when i/o events take place to somehow
try to fix things.
3) Make a scratch version of R source code that has no hidden aspects to try
to investigate what is going on a little better.

Also, I should mention that I found an unanswered post from someone who had
a similar problem when trying to use cerr and cout when accessing functions
from dynamically linked libraries. I wonder, is it possible that R hasn't
completely connected to these libraries? I mean, it's doing some sort of
magic where it finds a pointer to a function, but maybe c++ has a lot going
on in the background related to these ostream types that could be getting
messed up. Maybe some aspects of the global environment might be different
somehow? I directly link to my libraries via a c++ compiler when I get the
identical functions to work from main in c++.

One final thing I'm considering is that the R manual also mentions something
about garbage collection and some circumstances under which it's important
to explicitly request pointers to be maintained. Is it possible that R is
eating global pointers used by std::ostream ?

All suggestions are valued and if anyone has recommendations on strategy,
please let me know.

Thanks,
Sean


On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:

> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
> 
>> | I?m trying to call some of my c++ code from R and seem to be having an
>> issue
>> | with streams, although that?s just one obvious sign of something different
>> | in performance between calling the same function from main in c++ vs.
>> | calling the same function from R. [...]
>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
> 
> But isn't he redirecting cout to a file, so the C++ output is not to the
> console?
> 
> Davor


On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:

> 
> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
> | Hi,
> | 
> | Sorry, I just tried posting this but I had it in the wrong format of text,
> | so this is a cleared format repost:
> | 
> | I?m trying to call some of my c++ code from R and seem to be having an issue
> | with streams, although that?s just one obvious sign of something different
> | in performance between calling the same function from main in c++ vs.
> | calling the same function from R. I?m not getting any signs of errors from
> | R, but the behavior is different somehow and in a way that breaks my
> | algorithms. In both cases of launching a function from c++ or R, I redirect
> | cout to a file using a streambuf. In particular, I can see progress stop
> | when launching from R at a point when cout gets truncated when starting to
> | write out iterator values in a std::vector<string>. Then, I find no way to
> | write anything else to cout. When I write those values to Rprintf, they are
> | there and they are as expected. I?ve tried setting
> | ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
> | somehow, but that made no difference. I?m not quite sure how R uses those C
> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
> | be going on. At this point I don?t know if it might be an issue with R not
> | completely handling c++ from a library or if it is an issue with cout in
> | particular or if there is something else I?m missing. Please let me know if
> | you have any suggestions for me.
> 
> Doug Bates sometimes remarks that, once all other alternatives are exhausted,
> one could consider reading the manual. And indeed, 'Writing R Extensions' has
> this to say:
> 
>    5.6 Interfacing C++ code
>    ========================
> 
>    [...]
> 
>       Using C++ iostreams, as in this example, is best avoided.  There is
>    no guarantee that the output will appear in the R console, and indeed it
>    will not on the R for Windows console.  Use R code or the C entry points
>    (*note Printing::) for all I/O if at all possible.
>    
> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
> 
> Dirk
> 
> -- 
> Gauss once played himself in a zero-sum game and won $50.
>                       -- #11 at http://www.gaussfacts.com


From soeren.vogel at uzh.ch  Fri May  6 19:24:10 2011
From: soeren.vogel at uzh.ch (soeren.vogel at uzh.ch)
Date: Fri, 6 May 2011 19:24:10 +0200
Subject: [Rd] Create and access several instances of a C++ class from R
Message-ID: <49517500-0069-4F75-81E5-DAFFA2F53C08@uzh.ch>

Hello

We have a C++ class with several methods that manipulate an object. How is it possible to create several instances of that class *from R* in the C++ realm, which can then be accessed via a given name character? Symbolic example (we hope this illustrates our problem):

// C++ side:
class Foo{
...
}
// perhaps:
void my_new_instance_wrapper("the_character") // plain to see that I am no C++ programmer ;-)
{
  static Foo "the_character"; // no return needed since we know the name of the instance = "the_character"
}

# R side:
create_new_instance <- function(name){
  dono_what_to_use_here(???, class)
}
# perhaps:
create_new_instance <- function(name){
  .C("my_new_instance_wrapper", as.character(name))
}

dyn.load("Foo")
obj1 <- create_new_instance("bar", class="Foo")
obj2 <- create_new_instance("baz", class="Foo")
str(obj1)
: character which can be manipulated using class methods in the C++ realm

What we do not want: make simple copies of the object in R; use Rcpp modules (we tried that without success, pointers in constructors cause trouble); re-write our code such that C++ only "works off" heavy code, the rest is R-side. What we want: interfacing (from the R-side) instances of our class where the instances exist in the C++ realm.

Either there is a function (or code) in R that solve this task, perhaps by returning pointers to instances of C++ classes. (Or there is a possibility to create a wrapper in C++ creating a new instance, the wrapper we do not know of.)

Thanks for any notes, tips, experiences.

S?ren and Carlo


From edd at debian.org  Sat May  7 02:39:58 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 6 May 2011 19:39:58 -0500
Subject: [Rd] Create and access several instances of a C++ class from R
In-Reply-To: <49517500-0069-4F75-81E5-DAFFA2F53C08@uzh.ch>
References: <49517500-0069-4F75-81E5-DAFFA2F53C08@uzh.ch>
Message-ID: <19908.38110.411719.560626@max.nulle.part>


S?ren and Carlo,

On 6 May 2011 at 19:24, soeren.vogel at uzh.ch wrote:
| Hello
| 
| We have a C++ class with several methods that manipulate an object. How is
| it possible to create several instances of that class *from R* in the C++
| realm, which can then be accessed via a given name character? 

Yes it is, and even somewhat easily given Rcpp modules as we tried to explain
over at the Rcpp-devel list when you asked there.  As a real quick
proof-of-concept, I did the following:


1) Make sure you have a recent Rcpp such as 0.9.3 or 0.9.4


2) Let Rcpp create a complete 'stub' of a working package with Rcpp modules
   support for you via the Rcpp.package.skeleton.function() with the
   module=TRUE argument:


   R> library(Rcpp)
   R> Rcpp.package.skeleton("simple", module=TRUE)
   Creating directories ...
   Creating DESCRIPTION ...
   Creating NAMESPACE ...
   Creating Read-and-delete-me ...
   Saving functions and data ...
   Making help files ...
   Done.
   Further steps are described in './simple/Read-and-delete-me'.
   
   Adding Rcpp settings
    >> added RcppModules: yada
    >> added Depends: Rcpp
    >> added LinkingTo: Rcpp
    >> added useDynLib directive to NAMESPACE
    >> added Makevars file with Rcpp settings
    >> added Makevars.win file with Rcpp settings
    >> added example header file using Rcpp classes
    >> added example src file using Rcpp classes
    >> added example R file calling the C++ example
    >> added Rd file for rcpp_hello_world
    >> copied the example module 
   R> 

   
3) As you are keen to see that we get actual new objects, I am just doing
   the minimal code for by adding one for a new class member function:

    void showmyaddress() const { std::cout << "Address is " << this << std::endl; }

   which I add to the class 'World' in file simple/src/rcpp_module.rcpp -- on
   line 32 if it matters.   I also add this line to the module definition in
   the same file on line 62:

     .const_method( "showmyaddress", &World::showmyaddress, "get *this ptr address")

   It doesn't matter that the method is const, you can do without const in
   both eg

    void showmyaddress() { std::cout << "Address is " << this << std::endl; }

    .method( "showmyaddress", &World::showmyaddress, "get *this ptr address")

   All that the code does is reveal its pointer to stdout.


4) Install it via

   $ R CMD INSTALL simple


5) Try it in R (and I first

   R> library(simple)
   Loading required package: Rcpp
   R> World
   C++ class 'World' <0x2b84940>
   Constructors:
       World()
   
   Fields: No public fields exposed by this class
   
   Methods: 
        std::string greet()  
              docstring : get the message
        void set(std::string)  
              docstring : set the message
        void showmyaddress()  const 
              docstring : get *this ptr address
   R>
   R> w1 <- new( World )
   R> w1$showmyaddress()
   Address is 0x2748370
   R>
   R> w2 <- new( World )
   R> w2$showmyaddress()
   Address is 0x2f960b0
   R> 
   

   so w1 and w2 are indeed objects of class World which live in different
   memory locations.

This should show the mechanics.  This is somewhat easy -- especially if you
know some C++ where it then helps you from having to write boiler plate code.
If you are relatively new to C and C++, it can be a little tougher.  Either
way, to my mind it is shorter (and I'd argue, easier) than anything you could
do in plain C with the standard R API.

Good luck, and please bring Rcpp questions to rcpp-devel.

Regards, Dirk



| Symbolic example (we hope this illustrates our problem):
| 
| // C++ side:
| class Foo{
| ...
| }
| // perhaps:
| void my_new_instance_wrapper("the_character") // plain to see that I am no C++ programmer ;-)
| {
|   static Foo "the_character"; // no return needed since we know the name of the instance = "the_character"
| }
| 
| # R side:
| create_new_instance <- function(name){
|   dono_what_to_use_here(???, class)
| }
| # perhaps:
| create_new_instance <- function(name){
|   .C("my_new_instance_wrapper", as.character(name))
| }
| 
| dyn.load("Foo")
| obj1 <- create_new_instance("bar", class="Foo")
| obj2 <- create_new_instance("baz", class="Foo")
| str(obj1)
| : character which can be manipulated using class methods in the C++ realm
| 
| What we do not want: make simple copies of the object in R; use Rcpp modules (we tried that without success, pointers in constructors cause trouble); re-write our code such that C++ only "works off" heavy code, the rest is R-side. What we want: interfacing (from the R-side) instances of our class where the instances exist in the C++ realm.
| 
| Either there is a function (or code) in R that solve this task, perhaps by returning pointers to instances of C++ classes. (Or there is a possibility to create a wrapper in C++ creating a new instance, the wrapper we do not know of.)
| 
| Thanks for any notes, tips, experiences.
| 
| S?ren and Carlo
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com


From simon.urbanek at r-project.org  Sat May  7 04:09:06 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 6 May 2011 22:09:06 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <C9E9C213.40A8%sean.mcguffee@gmail.com>
References: <C9E9C213.40A8%sean.mcguffee@gmail.com>
Message-ID: <1CEBCBAE-AD21-4F00-99D6-13235E8D3E29@r-project.org>

Sean,

the path form the console is not under your control and it depends heavily on the internal settings in R (is console enabled, is R interactive, is the output a tty or a file ...) - that's why you have to use Rprint/REprintf - that's the only path that is guaranteed to work. Anything else is settings-specific and not guaranteed to work (it may appear to work in limited settings, but will not work in others). Note that, for example, WriteConsole is only used if R is not fed via I/O pipes - that may be what baffled you in that case.

So AFAICS the only C++ solution (other than using Rprintf/REprintf directly) is to create streams to pipes whose ends will call Rprintf/REprintf with the content. Anything else is not general. You may want to ask Rcpp people (Dirk is CC'd anyway ;)) - I'd imagine they must have thought of it as it seems very natural to request in a C++ interface ... (but I don't use Rcpp so I don't know).

Cheers,
Simon



On May 6, 2011, at 3:19 PM, Sean Robert McGuffee wrote:

> Hi,
> 
> Thanks for the comments so far.
> 
> I've been going through the code extensively and seem to be having trouble
> reproducing what R is doing, so this confuses me. For example, when I write
> out the pointer values for ptr_R_WriteConsole type functions, I can't find a
> function that matches what is actually being called.
> 
> REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
> R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
> R_WriteConsole);
> 
> It might be something like RTcl_WriteConsole too. However, I can't seem to
> find the headers I would need to try to find it's pointer value. Anyway,
> these are often hidden/protected/static which is an aspect of code that I
> only understand in concept. The concept I understand about this type of
> stuff is that if you provide a better way of doing things, then maybe you
> hide some stuff that doesn't involve the better way. However, in this case,
> the hidden stuff is just making it difficult for me to debug and get to
> bottom of what is going on. Anyway, I get different results if I call on the
> functions that simply use stdout when trying to reproduce Rprintf
> functionality. I'm only doing that to try to get to the bottom of what R is
> doing with stdout and stderr. I also am having a similar issue with trying
> to understand what GNU GCC is doing with how it sync's cout and cerr with
> stdout and stderr. Maybe R is intercepting some of these components. Anyway,
> 
> I was hoping to get around the
> "5.6 Interfacing C++ code
>   ========================   [...]
>      Using C++ iostreams, as in this example, is best avoided.  There is
>   no guarantee that the output will appear in the R console, and indeed it
>   will not on the R for Windows console.  Use R code or the C entry points
>   (*note Printing::) for all I/O if at all possible."
> if at all possible. My reason is that I have 76386 lines of c++ code that
> I'm trying to interface with R, and it literally might be faster for me to
> update R rather than modify all of that code to suit R which seems to be
> lacking a c++ ostream interface.
> 
> Ideally, I'd write rout and rerr versions of cout and cerr for R to become
> more compatible with c++. I have had some trouble figuring a lot of this
> hidden stuff out. Strategies I have considered are the following:
> 1) Write macros that conditionally replace cerr and cout with Rprintf
> somehow throughout all of my c++ code that I'm trying to interface with R.
> 2) Recreate the std::cerr and std::cout type of classes but maybe add some
> extra functionality for callbacks to when i/o events take place to somehow
> try to fix things.
> 3) Make a scratch version of R source code that has no hidden aspects to try
> to investigate what is going on a little better.
> 
> Also, I should mention that I found an unanswered post from someone who had
> a similar problem when trying to use cerr and cout when accessing functions
> from dynamically linked libraries. I wonder, is it possible that R hasn't
> completely connected to these libraries? I mean, it's doing some sort of
> magic where it finds a pointer to a function, but maybe c++ has a lot going
> on in the background related to these ostream types that could be getting
> messed up. Maybe some aspects of the global environment might be different
> somehow? I directly link to my libraries via a c++ compiler when I get the
> identical functions to work from main in c++.
> 
> One final thing I'm considering is that the R manual also mentions something
> about garbage collection and some circumstances under which it's important
> to explicitly request pointers to be maintained. Is it possible that R is
> eating global pointers used by std::ostream ?
> 
> All suggestions are valued and if anyone has recommendations on strategy,
> please let me know.
> 
> Thanks,
> Sean
> 
> 
> On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:
> 
>> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
>> 
>>> | I?m trying to call some of my c++ code from R and seem to be having an
>>> issue
>>> | with streams, although that?s just one obvious sign of something different
>>> | in performance between calling the same function from main in c++ vs.
>>> | calling the same function from R. [...]
>>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
>> 
>> But isn't he redirecting cout to a file, so the C++ output is not to the
>> console?
>> 
>> Davor
> 
> 
> On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:
> 
>> 
>> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
>> | Hi,
>> | 
>> | Sorry, I just tried posting this but I had it in the wrong format of text,
>> | so this is a cleared format repost:
>> | 
>> | I?m trying to call some of my c++ code from R and seem to be having an issue
>> | with streams, although that?s just one obvious sign of something different
>> | in performance between calling the same function from main in c++ vs.
>> | calling the same function from R. I?m not getting any signs of errors from
>> | R, but the behavior is different somehow and in a way that breaks my
>> | algorithms. In both cases of launching a function from c++ or R, I redirect
>> | cout to a file using a streambuf. In particular, I can see progress stop
>> | when launching from R at a point when cout gets truncated when starting to
>> | write out iterator values in a std::vector<string>. Then, I find no way to
>> | write anything else to cout. When I write those values to Rprintf, they are
>> | there and they are as expected. I?ve tried setting
>> | ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
>> | somehow, but that made no difference. I?m not quite sure how R uses those C
>> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
>> | be going on. At this point I don?t know if it might be an issue with R not
>> | completely handling c++ from a library or if it is an issue with cout in
>> | particular or if there is something else I?m missing. Please let me know if
>> | you have any suggestions for me.
>> 
>> Doug Bates sometimes remarks that, once all other alternatives are exhausted,
>> one could consider reading the manual. And indeed, 'Writing R Extensions' has
>> this to say:
>> 
>>   5.6 Interfacing C++ code
>>   ========================
>> 
>>   [...]
>> 
>>      Using C++ iostreams, as in this example, is best avoided.  There is
>>   no guarantee that the output will appear in the R console, and indeed it
>>   will not on the R for Windows console.  Use R code or the C entry points
>>   (*note Printing::) for all I/O if at all possible.
>> 
>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
>> 
>> Dirk
>> 
>> -- 
>> Gauss once played himself in a zero-sum game and won $50.
>>                      -- #11 at http://www.gaussfacts.com
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From edd at debian.org  Sat May  7 04:44:07 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 6 May 2011 21:44:07 -0500
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <1CEBCBAE-AD21-4F00-99D6-13235E8D3E29@r-project.org>
References: <C9E9C213.40A8%sean.mcguffee@gmail.com>
	<1CEBCBAE-AD21-4F00-99D6-13235E8D3E29@r-project.org>
Message-ID: <19908.45559.753550.277882@max.nulle.part>


On 6 May 2011 at 22:09, Simon Urbanek wrote:
| Sean,
| 
| the path form the console is not under your control and it depends heavily on the internal settings in R (is console enabled, is R interactive, is the output a tty or a file ...) - that's why you have to use Rprint/REprintf - that's the only path that is guaranteed to work. Anything else is settings-specific and not guaranteed to work (it may appear to work in limited settings, but will not work in others). Note that, for example, WriteConsole is only used if R is not fed via I/O pipes - that may be what baffled you in that case.
| 
| So AFAICS the only C++ solution (other than using Rprintf/REprintf directly) is to create streams to pipes whose ends will call Rprintf/REprintf with the content. Anything else is not general. You may want to ask Rcpp people (Dirk is CC'd anyway ;)) - I'd imagine they must have thought of it as it seems very natural to request in a C++ interface ... (but I don't use Rcpp so I don't know).

Rcpp makes no claims about reimplementing IO, or providing new IO facilities.
Rcpp is clearly bound by the R API upon which it builds; the R documentation
(which I quoted in my earlier email in this thread) suggests to expect nasty
things when one mixes IO systems between R and C++.

And that seems to be what Sean is experiencing; I for one am not surprised.
It was never clear from Seans's mails exactly how much time he has had for
reading of the available documentation, his approach seems to me mostly
driven by a vast and vague set of assumption on his part (eg the rout/rerr
business he comes back to), as well as a lot energy and a willingness to just
try this.  Which is perfectly fine, but it can also fail.

I'd suggest to start small with as little IO as possible. Maybe even comment
all IO out as much as possible. Or redo it as strstream and feed that to
Rprintf.

Dirk
 

| Cheers,
| Simon
| 
| 
| 
| On May 6, 2011, at 3:19 PM, Sean Robert McGuffee wrote:
| 
| > Hi,
| > 
| > Thanks for the comments so far.
| > 
| > I've been going through the code extensively and seem to be having trouble
| > reproducing what R is doing, so this confuses me. For example, when I write
| > out the pointer values for ptr_R_WriteConsole type functions, I can't find a
| > function that matches what is actually being called.
| > 
| > REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
| > R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
| > R_WriteConsole);
| > 
| > It might be something like RTcl_WriteConsole too. However, I can't seem to
| > find the headers I would need to try to find it's pointer value. Anyway,
| > these are often hidden/protected/static which is an aspect of code that I
| > only understand in concept. The concept I understand about this type of
| > stuff is that if you provide a better way of doing things, then maybe you
| > hide some stuff that doesn't involve the better way. However, in this case,
| > the hidden stuff is just making it difficult for me to debug and get to
| > bottom of what is going on. Anyway, I get different results if I call on the
| > functions that simply use stdout when trying to reproduce Rprintf
| > functionality. I'm only doing that to try to get to the bottom of what R is
| > doing with stdout and stderr. I also am having a similar issue with trying
| > to understand what GNU GCC is doing with how it sync's cout and cerr with
| > stdout and stderr. Maybe R is intercepting some of these components. Anyway,
| > 
| > I was hoping to get around the
| > "5.6 Interfacing C++ code
| >   ========================   [...]
| >      Using C++ iostreams, as in this example, is best avoided.  There is
| >   no guarantee that the output will appear in the R console, and indeed it
| >   will not on the R for Windows console.  Use R code or the C entry points
| >   (*note Printing::) for all I/O if at all possible."
| > if at all possible. My reason is that I have 76386 lines of c++ code that
| > I'm trying to interface with R, and it literally might be faster for me to
| > update R rather than modify all of that code to suit R which seems to be
| > lacking a c++ ostream interface.
| > 
| > Ideally, I'd write rout and rerr versions of cout and cerr for R to become
| > more compatible with c++. I have had some trouble figuring a lot of this
| > hidden stuff out. Strategies I have considered are the following:
| > 1) Write macros that conditionally replace cerr and cout with Rprintf
| > somehow throughout all of my c++ code that I'm trying to interface with R.
| > 2) Recreate the std::cerr and std::cout type of classes but maybe add some
| > extra functionality for callbacks to when i/o events take place to somehow
| > try to fix things.
| > 3) Make a scratch version of R source code that has no hidden aspects to try
| > to investigate what is going on a little better.
| > 
| > Also, I should mention that I found an unanswered post from someone who had
| > a similar problem when trying to use cerr and cout when accessing functions
| > from dynamically linked libraries. I wonder, is it possible that R hasn't
| > completely connected to these libraries? I mean, it's doing some sort of
| > magic where it finds a pointer to a function, but maybe c++ has a lot going
| > on in the background related to these ostream types that could be getting
| > messed up. Maybe some aspects of the global environment might be different
| > somehow? I directly link to my libraries via a c++ compiler when I get the
| > identical functions to work from main in c++.
| > 
| > One final thing I'm considering is that the R manual also mentions something
| > about garbage collection and some circumstances under which it's important
| > to explicitly request pointers to be maintained. Is it possible that R is
| > eating global pointers used by std::ostream ?
| > 
| > All suggestions are valued and if anyone has recommendations on strategy,
| > please let me know.
| > 
| > Thanks,
| > Sean
| > 
| > 
| > On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:
| > 
| >> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
| >> 
| >>> | I?m trying to call some of my c++ code from R and seem to be having an
| >>> issue
| >>> | with streams, although that?s just one obvious sign of something different
| >>> | in performance between calling the same function from main in c++ vs.
| >>> | calling the same function from R. [...]
| >>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
| >> 
| >> But isn't he redirecting cout to a file, so the C++ output is not to the
| >> console?
| >> 
| >> Davor
| > 
| > 
| > On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:
| > 
| >> 
| >> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
| >> | Hi,
| >> | 
| >> | Sorry, I just tried posting this but I had it in the wrong format of text,
| >> | so this is a cleared format repost:
| >> | 
| >> | I?m trying to call some of my c++ code from R and seem to be having an issue
| >> | with streams, although that?s just one obvious sign of something different
| >> | in performance between calling the same function from main in c++ vs.
| >> | calling the same function from R. I?m not getting any signs of errors from
| >> | R, but the behavior is different somehow and in a way that breaks my
| >> | algorithms. In both cases of launching a function from c++ or R, I redirect
| >> | cout to a file using a streambuf. In particular, I can see progress stop
| >> | when launching from R at a point when cout gets truncated when starting to
| >> | write out iterator values in a std::vector<string>. Then, I find no way to
| >> | write anything else to cout. When I write those values to Rprintf, they are
| >> | there and they are as expected. I?ve tried setting
| >> | ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
| >> | somehow, but that made no difference. I?m not quite sure how R uses those C
| >> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
| >> | be going on. At this point I don?t know if it might be an issue with R not
| >> | completely handling c++ from a library or if it is an issue with cout in
| >> | particular or if there is something else I?m missing. Please let me know if
| >> | you have any suggestions for me.
| >> 
| >> Doug Bates sometimes remarks that, once all other alternatives are exhausted,
| >> one could consider reading the manual. And indeed, 'Writing R Extensions' has
| >> this to say:
| >> 
| >>   5.6 Interfacing C++ code
| >>   ========================
| >> 
| >>   [...]
| >> 
| >>      Using C++ iostreams, as in this example, is best avoided.  There is
| >>   no guarantee that the output will appear in the R console, and indeed it
| >>   will not on the R for Windows console.  Use R code or the C entry points
| >>   (*note Printing::) for all I/O if at all possible.
| >> 
| >> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
| >> 
| >> Dirk
| >> 
| >> -- 
| >> Gauss once played himself in a zero-sum game and won $50.
| >>                      -- #11 at http://www.gaussfacts.com
| > 
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| > 
| > 
| 

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com


From sean.mcguffee at gmail.com  Sat May  7 06:42:44 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Sat, 7 May 2011 00:42:44 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <19908.45559.753550.277882@max.nulle.part>
References: <C9E9C213.40A8%sean.mcguffee@gmail.com>
	<1CEBCBAE-AD21-4F00-99D6-13235E8D3E29@r-project.org>
	<19908.45559.753550.277882@max.nulle.part>
Message-ID: <BANLkTimEDCkQ2xe2wyoJsU1Sk1We=u6d+A@mail.gmail.com>

This is a good idea as to converting to stringstream's because it
could let me remove cout and cerr from the equation. At the moment, I
get that feeling from the experts that having cout and cerr is causing
a bug by not mixing with R. I have other cases where algorithms that
avoid cout and cerr aren't working, but as far as my experience with
bugs in c code goes, a memory issue in one place can make everything
go haywire, and an random cout or cerr somewhere that I don't catch
could maybe be the source of the issue. I also like this idea of
piping and then calling Rprintf. Along the same lines, I could create
a string and then either spit to cout or cerr or spit to Rprintf
depending on some sort of setting. One of the key reasons I have been
hanging on to cout and cerr is that I want to keep all of my c++ code
identical to the status quo as far as the command line interface is
concerned. On the other hand, maybe I can just globally substitute
cout and cerr to random file streams and avoid the conflict with
stdout and stderr. I take it that it isn't ostreams per say causing
the problem but that it's something specific about cout and cerr not
mixing with R. Then maybe I can pass their buffers to cout, cerr, or
Rprintf, depending on preferences later. What I would really like to
do maybe be beyond my grasp, but that would be to integrate ostreams
into R. I am toying with an idea of mimicking cout and cerr with some
new classes that are almost verbatim copies of cout and cerr with
substituted names. Then maybe inside their internals I can more easily
create conditional access to Rprintf calls. What I like about this
strategy is that I could do a global substitution of cout and cerr
with new objects of more useful functionality, and that way I might
not have to re-write all my c++ code which constantly calls on these
standard streams. Plus, if I get something generic to work, maybe I
can pass it on to Dirk so others won't have to deal with this stuff in
the future. I find this fascinating that the output may be tty. I see
now that the device on my Mac that /dev/stdout points to is a tty. I
have never encountered tty before, but I have a vague memory of a term
like that back in the day of dial up! Oh the fun things I'm learning.
Just to clarify though, is the only way my code "mixes IO systems
between R and C++" by way of cout and cerr happening to be
synchronized with stderr and stdout by default? Or is there something
inherent in ostreams in general that doesn't mesh with R? I guess I
find it a little bit surprising that calling
ios_base::sync_with_stdio(false) and redirecting those streams to
other files doesn't dodge that bullet. I know that doesn't break the
ostreams themselves because it works fine from the command line
interface. I guess I'll have to delve more into how c++ works behind
the scenes to figure that part out. I think Dirk has a really good
suggestion to comment out all of my cout and cerr calls and see if
still get a bug. Obviously that wouldn't be any permanent fix for
future users who want to link code with cout and cerr, but it would
help me identify if this is the only source of error. It might take me
till past the weekend to get to the bottom of some of these things,
but I'll post what I find out.
Thanks again--I appreciate everyone's useful suggestions.
Sean

On Fri, May 6, 2011 at 10:44 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 6 May 2011 at 22:09, Simon Urbanek wrote:
> | Sean,
> |
> | the path form the console is not under your control and it depends heavily on the internal settings in R (is console enabled, is R interactive, is the output a tty or a file ...) - that's why you have to use Rprint/REprintf - that's the only path that is guaranteed to work. Anything else is settings-specific and not guaranteed to work (it may appear to work in limited settings, but will not work in others). Note that, for example, WriteConsole is only used if R is not fed via I/O pipes - that may be what baffled you in that case.
> |
> | So AFAICS the only C++ solution (other than using Rprintf/REprintf directly) is to create streams to pipes whose ends will call Rprintf/REprintf with the content. Anything else is not general. You may want to ask Rcpp people (Dirk is CC'd anyway ;)) - I'd imagine they must have thought of it as it seems very natural to request in a C++ interface ... (but I don't use Rcpp so I don't know).
>
> Rcpp makes no claims about reimplementing IO, or providing new IO facilities.
> Rcpp is clearly bound by the R API upon which it builds; the R documentation
> (which I quoted in my earlier email in this thread) suggests to expect nasty
> things when one mixes IO systems between R and C++.
>
> And that seems to be what Sean is experiencing; I for one am not surprised.
> It was never clear from Seans's mails exactly how much time he has had for
> reading of the available documentation, his approach seems to me mostly
> driven by a vast and vague set of assumption on his part (eg the rout/rerr
> business he comes back to), as well as a lot energy and a willingness to just
> try this. ?Which is perfectly fine, but it can also fail.
>
> I'd suggest to start small with as little IO as possible. Maybe even comment
> all IO out as much as possible. Or redo it as strstream and feed that to
> Rprintf.
>
> Dirk
>
>
> | Cheers,
> | Simon
> |
> |
> |
> | On May 6, 2011, at 3:19 PM, Sean Robert McGuffee wrote:
> |
> | > Hi,
> | >
> | > Thanks for the comments so far.
> | >
> | > I've been going through the code extensively and seem to be having trouble
> | > reproducing what R is doing, so this confuses me. For example, when I write
> | > out the pointer values for ptr_R_WriteConsole type functions, I can't find a
> | > function that matches what is actually being called.
> | >
> | > REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
> | > R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
> | > R_WriteConsole);
> | >
> | > It might be something like RTcl_WriteConsole too. However, I can't seem to
> | > find the headers I would need to try to find it's pointer value. Anyway,
> | > these are often hidden/protected/static which is an aspect of code that I
> | > only understand in concept. The concept I understand about this type of
> | > stuff is that if you provide a better way of doing things, then maybe you
> | > hide some stuff that doesn't involve the better way. However, in this case,
> | > the hidden stuff is just making it difficult for me to debug and get to
> | > bottom of what is going on. Anyway, I get different results if I call on the
> | > functions that simply use stdout when trying to reproduce Rprintf
> | > functionality. I'm only doing that to try to get to the bottom of what R is
> | > doing with stdout and stderr. I also am having a similar issue with trying
> | > to understand what GNU GCC is doing with how it sync's cout and cerr with
> | > stdout and stderr. Maybe R is intercepting some of these components. Anyway,
> | >
> | > I was hoping to get around the
> | > "5.6 Interfacing C++ code
> | > ? ======================== ? [...]
> | > ? ? ?Using C++ iostreams, as in this example, is best avoided. ?There is
> | > ? no guarantee that the output will appear in the R console, and indeed it
> | > ? will not on the R for Windows console. ?Use R code or the C entry points
> | > ? (*note Printing::) for all I/O if at all possible."
> | > if at all possible. My reason is that I have 76386 lines of c++ code that
> | > I'm trying to interface with R, and it literally might be faster for me to
> | > update R rather than modify all of that code to suit R which seems to be
> | > lacking a c++ ostream interface.
> | >
> | > Ideally, I'd write rout and rerr versions of cout and cerr for R to become
> | > more compatible with c++. I have had some trouble figuring a lot of this
> | > hidden stuff out. Strategies I have considered are the following:
> | > 1) Write macros that conditionally replace cerr and cout with Rprintf
> | > somehow throughout all of my c++ code that I'm trying to interface with R.
> | > 2) Recreate the std::cerr and std::cout type of classes but maybe add some
> | > extra functionality for callbacks to when i/o events take place to somehow
> | > try to fix things.
> | > 3) Make a scratch version of R source code that has no hidden aspects to try
> | > to investigate what is going on a little better.
> | >
> | > Also, I should mention that I found an unanswered post from someone who had
> | > a similar problem when trying to use cerr and cout when accessing functions
> | > from dynamically linked libraries. I wonder, is it possible that R hasn't
> | > completely connected to these libraries? I mean, it's doing some sort of
> | > magic where it finds a pointer to a function, but maybe c++ has a lot going
> | > on in the background related to these ostream types that could be getting
> | > messed up. Maybe some aspects of the global environment might be different
> | > somehow? I directly link to my libraries via a c++ compiler when I get the
> | > identical functions to work from main in c++.
> | >
> | > One final thing I'm considering is that the R manual also mentions something
> | > about garbage collection and some circumstances under which it's important
> | > to explicitly request pointers to be maintained. Is it possible that R is
> | > eating global pointers used by std::ostream ?
> | >
> | > All suggestions are valued and if anyone has recommendations on strategy,
> | > please let me know.
> | >
> | > Thanks,
> | > Sean
> | >
> | >
> | > On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:
> | >
> | >> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
> | >>
> | >>> | I?m trying to call some of my c++ code from R and seem to be having an
> | >>> issue
> | >>> | with streams, although that?s just one obvious sign of something different
> | >>> | in performance between calling the same function from main in c++ vs.
> | >>> | calling the same function from R. [...]
> | >>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
> | >>
> | >> But isn't he redirecting cout to a file, so the C++ output is not to the
> | >> console?
> | >>
> | >> Davor
> | >
> | >
> | > On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:
> | >
> | >>
> | >> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
> | >> | Hi,
> | >> |
> | >> | Sorry, I just tried posting this but I had it in the wrong format of text,
> | >> | so this is a cleared format repost:
> | >> |
> | >> | I?m trying to call some of my c++ code from R and seem to be having an issue
> | >> | with streams, although that?s just one obvious sign of something different
> | >> | in performance between calling the same function from main in c++ vs.
> | >> | calling the same function from R. I?m not getting any signs of errors from
> | >> | R, but the behavior is different somehow and in a way that breaks my
> | >> | algorithms. In both cases of launching a function from c++ or R, I redirect
> | >> | cout to a file using a streambuf. In particular, I can see progress stop
> | >> | when launching from R at a point when cout gets truncated when starting to
> | >> | write out iterator values in a std::vector<string>. Then, I find no way to
> | >> | write anything else to cout. When I write those values to Rprintf, they are
> | >> | there and they are as expected. I?ve tried setting
> | >> | ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
> | >> | somehow, but that made no difference. I?m not quite sure how R uses those C
> | >> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
> | >> | be going on. At this point I don?t know if it might be an issue with R not
> | >> | completely handling c++ from a library or if it is an issue with cout in
> | >> | particular or if there is something else I?m missing. Please let me know if
> | >> | you have any suggestions for me.
> | >>
> | >> Doug Bates sometimes remarks that, once all other alternatives are exhausted,
> | >> one could consider reading the manual. And indeed, 'Writing R Extensions' has
> | >> this to say:
> | >>
> | >> ? 5.6 Interfacing C++ code
> | >> ? ========================
> | >>
> | >> ? [...]
> | >>
> | >> ? ? ?Using C++ iostreams, as in this example, is best avoided. ?There is
> | >> ? no guarantee that the output will appear in the R console, and indeed it
> | >> ? will not on the R for Windows console. ?Use R code or the C entry points
> | >> ? (*note Printing::) for all I/O if at all possible.
> | >>
> | >> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
> | >>
> | >> Dirk
> | >>
> | >> --
> | >> Gauss once played himself in a zero-sum game and won $50.
> | >> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com
> | >
> | > ______________________________________________
> | > R-devel at r-project.org mailing list
> | > https://stat.ethz.ch/mailman/listinfo/r-devel
> | >
> | >
> |
>
> --
> Gauss once played himself in a zero-sum game and won $50.
> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com


From soeren.vogel at uzh.ch  Sat May  7 10:41:01 2011
From: soeren.vogel at uzh.ch (soeren.vogel at uzh.ch)
Date: Sat, 7 May 2011 10:41:01 +0200
Subject: [Rd] Create and access several instances of a C++ class from R
In-Reply-To: <19908.38110.411719.560626@max.nulle.part>
References: <49517500-0069-4F75-81E5-DAFFA2F53C08@uzh.ch>
	<19908.38110.411719.560626@max.nulle.part>
Message-ID: <E7B857D5-FA61-4215-838F-88F79CACADD6@uzh.ch>

Hello

Thanks again for help!

We have attached version info, code, and contents of 00install.out at the end of the message. The package can be found here:

http://sovo.md-hh.com/files/Foo.tar.gz

We had followed Dirks explanation in the Rcpp modules vignette and the presentation of Rcpp modules. The steps there and the ones Dirk listed here are basically the same, and all worked fine for us, so far. Even more, we have adapted some of the example code to a class Foo with two methods of interest, do_foo() and do_bar(). We have played around with various combinations of which method to expose in the module. In the end, exposing do_foo() works, R CMD CHECK does not complain. (Except for some namespacing error, but the same happens when I compile the example "simple", see below.)

Anyway, if we want the method do_bar() to expose, R CMD CHECK Foo stops with an error that says: "cannot convert ?SEXPREC*? to ?double*? in initialization". We *guess* that it is pointers as arguments in methods exposed that cause errors, because there is no wrappers "as()" and "wrap()" for pointers in Rcpp. Indee, we know that our crystal ball may fool us.

Summarising so far, principally, Rcpp modules works for us and coding with this module is very easy, especially with the help files provided in the package. However, Rcpp modules does not work if you want to expose methods with pointers as exposed methods' arguments (we assume). Yet, we have to use pointers, and rewriting the complete class is no option.

Recently, Dirk gave us the advice to have a look at STL containers. We have googled and found some information, and "looking at it" works fine, however, working with it is somewhat "beyond" our C++ skills. If the "STL things" *are* our *only* solution, could some reader here provide us with a specific solution to exposing do_bar()? Or what else can we do to (1) use the class as is (because it works with dyn.load as well as in other software outside R) and (2) incorporate things into Rcpp modules (or other code) anyway?

Thanks for all help!

S?ren and Carlo


On 07.05.2011, at 02:39, Dirk Eddelbuettel wrote:

> S?ren and Carlo,
> 
> On 6 May 2011 at 19:24, soeren.vogel at uzh.ch wrote:
> | Hello
> | 
> | We have a C++ class with several methods that manipulate an object. How is
> | it possible to create several instances of that class *from R* in the C++
> | realm, which can then be accessed via a given name character? 
> 
> Yes it is, and even somewhat easily given Rcpp modules as we tried to explain
> over at the Rcpp-devel list when you asked there.  As a real quick
> proof-of-concept, I did the following:
> 
> 
> 1) Make sure you have a recent Rcpp such as 0.9.3 or 0.9.4
> 
> 
> 2) Let Rcpp create a complete 'stub' of a working package with Rcpp modules
>   support for you via the Rcpp.package.skeleton.function() with the
>   module=TRUE argument:
> 
> 
>   R> library(Rcpp)
>   R> Rcpp.package.skeleton("simple", module=TRUE)
>   Creating directories ...
>   Creating DESCRIPTION ...
>   Creating NAMESPACE ...
>   Creating Read-and-delete-me ...
>   Saving functions and data ...
>   Making help files ...
>   Done.
>   Further steps are described in './simple/Read-and-delete-me'.
> 
>   Adding Rcpp settings
>>> added RcppModules: yada
>>> added Depends: Rcpp
>>> added LinkingTo: Rcpp
>>> added useDynLib directive to NAMESPACE
>>> added Makevars file with Rcpp settings
>>> added Makevars.win file with Rcpp settings
>>> added example header file using Rcpp classes
>>> added example src file using Rcpp classes
>>> added example R file calling the C++ example
>>> added Rd file for rcpp_hello_world
>>> copied the example module 
>   R> 
> 
> 
> 3) As you are keen to see that we get actual new objects, I am just doing
>   the minimal code for by adding one for a new class member function:
> 
>    void showmyaddress() const { std::cout << "Address is " << this << std::endl; }
> 
>   which I add to the class 'World' in file simple/src/rcpp_module.rcpp -- on
>   line 32 if it matters.   I also add this line to the module definition in
>   the same file on line 62:
> 
>     .const_method( "showmyaddress", &World::showmyaddress, "get *this ptr address")
> 
>   It doesn't matter that the method is const, you can do without const in
>   both eg
> 
>    void showmyaddress() { std::cout << "Address is " << this << std::endl; }
> 
>    .method( "showmyaddress", &World::showmyaddress, "get *this ptr address")
> 
>   All that the code does is reveal its pointer to stdout.
> 
> 
> 4) Install it via
> 
>   $ R CMD INSTALL simple
> 
> 
> 5) Try it in R (and I first
> 
>   R> library(simple)
>   Loading required package: Rcpp
>   R> World
>   C++ class 'World' <0x2b84940>
>   Constructors:
>       World()
> 
>   Fields: No public fields exposed by this class
> 
>   Methods: 
>        std::string greet()  
>              docstring : get the message
>        void set(std::string)  
>              docstring : set the message
>        void showmyaddress()  const 
>              docstring : get *this ptr address
>   R>
>   R> w1 <- new( World )
>   R> w1$showmyaddress()
>   Address is 0x2748370
>   R>
>   R> w2 <- new( World )
>   R> w2$showmyaddress()
>   Address is 0x2f960b0
>   R> 
> 
> 
>   so w1 and w2 are indeed objects of class World which live in different
>   memory locations.
> 
> This should show the mechanics.  This is somewhat easy -- especially if you
> know some C++ where it then helps you from having to write boiler plate code.
> If you are relatively new to C and C++, it can be a little tougher.  Either
> way, to my mind it is shorter (and I'd argue, easier) than anything you could
> do in plain C with the standard R API.
> 
> Good luck, and please bring Rcpp questions to rcpp-devel.
> 
> Regards, Dirk
> 
> 
> 
> | Symbolic example (we hope this illustrates our problem):
> | 
> | // C++ side:
> | class Foo{
> | ...
> | }
> | // perhaps:
> | void my_new_instance_wrapper("the_character") // plain to see that I am no C++ programmer ;-)
> | {
> |   static Foo "the_character"; // no return needed since we know the name of the instance = "the_character"
> | }
> | 
> | # R side:
> | create_new_instance <- function(name){
> |   dono_what_to_use_here(???, class)
> | }
> | # perhaps:
> | create_new_instance <- function(name){
> |   .C("my_new_instance_wrapper", as.character(name))
> | }
> | 
> | dyn.load("Foo")
> | obj1 <- create_new_instance("bar", class="Foo")
> | obj2 <- create_new_instance("baz", class="Foo")
> | str(obj1)
> | : character which can be manipulated using class methods in the C++ realm
> | 
> | What we do not want: make simple copies of the object in R; use Rcpp modules (we tried that without success, pointers in constructors cause trouble); re-write our code such that C++ only "works off" heavy code, the rest is R-side. What we want: interfacing (from the R-side) instances of our class where the instances exist in the C++ realm.
> | 
> | Either there is a function (or code) in R that solve this task, perhaps by returning pointers to instances of C++ classes. (Or there is a possibility to create a wrapper in C++ creating a new instance, the wrapper we do not know of.)
> | 
> | Thanks for any notes, tips, experiences.
> | 
> | S?ren and Carlo



R: sessionInfo()

R version 2.13.0 (2011-04-13)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] Rcpp_0.9.4

loaded via a namespace (and not attached):
[1] tools_2.13.0



/* ### Foo_mod.cpp ### */
#include <Rcpp.h>

class Foo
{
	int N, M, n, m;
	double dtau;
	double * C;
	double * t;
	double * s;
	double * par;
	double * D;
	double * ee;
	double * ff;
	double * S;
	int * y;
	public:
		Foo(int N_, int M_, int n_) : N(N_), M(M_), n(n_)
		{
			D = new double[M];
			ee= new double[N];
			ff= new double[N];
			S = new double[n+1];
		}
		~Foo()
		{
			delete[] D;
			delete[] ee;
			delete[] ff;
			delete[] S;
		}
		// important methods
//		void set_experiment(int m, double *C, double *s); // original code
		void do_foo(int m);
		void do_bar(double *C);
		// other stuff
		void set_data(int n, int *y, double *t);
		void set_accuracy(int N, int M);
		void set_par(double *par);
		double loglikelihood(double *z);
};

//void Foo::set_experiment(int mm, double *CC, double *ss)
void Foo::do_foo(int mm)
{
	m=mm;
}
void Foo::do_bar(double *CC)
{
	C=CC;
}

RCPP_MODULE(mod_foo)
{
	using namespace Rcpp;
	class_<Foo>( "Foo" )
		.constructor<int,int,int>()
		.method("do_foo", &Foo::do_foo) // works
		.method("do_bar", &Foo::do_bar) // does not work!
	;
}


### compile warning with the working version:
** checking whether the name space can be loaded with stated dependencies ... WARNING
Error: .onLoad failed in loadNamespace() for 'Foo', details:
  call: value[[3L]](cond)
  error: failed to load module mod_foo from package Foo
Execution halted
A namespace must be able to be loaded with just the base namespace
loaded: otherwise if the namespace gets loaded by a saved object, the
session will be unable to start.
Probably some imports need to be declared in the NAMESPACE file.


### 00install.out
* installing *source* package ?Foo? ...
** libs
*** arch - i386
g++-4.2 -arch i386 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include -I"/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include"   -fPIC  -g -O2 -c Foo_mod.cpp -o Foo_mod.o
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/traits/Exporter.h: In constructor ?Rcpp::traits::Exporter<T>::Exporter(SEXPREC*) [with T = double*]?:
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/as.h:51:   instantiated from ?T Rcpp::internal::as(SEXPREC*, Rcpp::traits::r_type_generic_tag) [with T = double*]?
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/as.h:75:   instantiated from ?T Rcpp::as(SEXPREC*) [with T = double*]?
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/module/Module_generated_CppMethod.h:122:   instantiated from ?SEXPREC* Rcpp::CppMethod1<Class, void, U0>::operator()(Class*, SEXPREC**) [with Class = Foo, U0 = double*]?
Foo_mod.cpp:59:   instantiated from here
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/traits/Exporter.h:31: error: cannot convert ?SEXPREC*? to ?double*? in initialization
make: *** [Foo_mod.o] Error 1
ERROR: compilation failed for package ?Foo?


From romain at r-enthusiasts.com  Sat May  7 11:15:37 2011
From: romain at r-enthusiasts.com (Romain Francois)
Date: Sat, 07 May 2011 11:15:37 +0200
Subject: [Rd] Create and access several instances of a C++ class from R
In-Reply-To: <E7B857D5-FA61-4215-838F-88F79CACADD6@uzh.ch>
References: <49517500-0069-4F75-81E5-DAFFA2F53C08@uzh.ch>	<19908.38110.411719.560626@max.nulle.part>
	<E7B857D5-FA61-4215-838F-88F79CACADD6@uzh.ch>
Message-ID: <4DC50DB9.8090300@r-enthusiasts.com>

Hello,

Try having do_bar with this signature:

void do_bar(NumericVector data);

And my advice would probably also to have your C field either as a 
NumericVector. NumericVector is just a thin wrapper around the internal 
R data structure.

Having data members as direct pointers is dangerous and not a very C++ 
way of doing things.

If you want to learn about the STL, there are many books that cover it 
and plenty of online resources. I use this : 
http://cplusplus.com/reference/stl/. Using the STL is easier than 
dealing with pointers and stuff.

If your game is to pass down a double* to some api you use, you can use 
the begin method of NumericVector, this will give you the array pointer 
(as would REAL do on the underlying SEXP):

Here's an example:

require( Rcpp )
require( inline )

inc <- '

     // some third party api function
     double foo( double* data, int n){
         double sum = 0.0 ;
         for( int i=0; i<n; i++){
             sum += data[i] ;
         }
         return sum ;
     }
'

fx <- cxxfunction( signature( x_ = "numeric" ), '

     NumericVector x(x_) ;

     double sum = foo( x.begin(), x.size() ) ;

     return wrap( sum ) ;

', includes = inc, plugin = "Rcpp" )


I hope this helps, please send other Rcpp questions to the Rcpp-devel 
mailing list, where you have more chances to have replies. As an 
example, I don't follow R-devel as much as I would like to these days.

Romain

Le 07/05/11 10:41, soeren.vogel at uzh.ch a ?crit :
>
> Hello
>
> Thanks again for help!
>
> We have attached version info, code, and contents of 00install.out at the end of the message. The package can be found here:
>
> http://sovo.md-hh.com/files/Foo.tar.gz
>
> We had followed Dirks explanation in the Rcpp modules vignette and the presentation of Rcpp modules. The steps there and the ones Dirk listed here are basically the same, and all worked fine for us, so far. Even more, we have adapted some of the example code to a class Foo with two methods of interest, do_foo() and do_bar(). We have played around with various combinations of which method to expose in the module. In the end, exposing do_foo() works, R CMD CHECK does not complain. (Except for some namespacing error, but the same happens when I compile the example "simple", see below.)
>
> Anyway, if we want the method do_bar() to expose, R CMD CHECK Foo stops with an error that says: "cannot convert ?SEXPREC*? to ?double*? in initialization". We *guess* that it is pointers as arguments in methods exposed that cause errors, because there is no wrappers "as()" and "wrap()" for pointers in Rcpp. Indee, we know that our crystal ball may fool us.
>
> Summarising so far, principally, Rcpp modules works for us and coding with this module is very easy, especially with the help files provided in the package. However, Rcpp modules does not work if you want to expose methods with pointers as exposed methods' arguments (we assume). Yet, we have to use pointers, and rewriting the complete class is no option.
>
> Recently, Dirk gave us the advice to have a look at STL containers. We have googled and found some information, and "looking at it" works fine, however, working with it is somewhat "beyond" our C++ skills. If the "STL things" *are* our *only* solution, could some reader here provide us with a specific solution to exposing do_bar()? Or what else can we do to (1) use the class as is (because it works with dyn.load as well as in other software outside R) and (2) incorporate things into Rcpp modules (or other code) anyway?
>
> Thanks for all help!
>
> S?ren and Carlo
>
>
> On 07.05.2011, at 02:39, Dirk Eddelbuettel wrote:
>
>> S?ren and Carlo,
>>
>> On 6 May 2011 at 19:24, soeren.vogel at uzh.ch wrote:
>> | Hello
>> |
>> | We have a C++ class with several methods that manipulate an object. How is
>> | it possible to create several instances of that class *from R* in the C++
>> | realm, which can then be accessed via a given name character?
>>
>> Yes it is, and even somewhat easily given Rcpp modules as we tried to explain
>> over at the Rcpp-devel list when you asked there.  As a real quick
>> proof-of-concept, I did the following:
>>
>>
>> 1) Make sure you have a recent Rcpp such as 0.9.3 or 0.9.4
>>
>>
>> 2) Let Rcpp create a complete 'stub' of a working package with Rcpp modules
>>    support for you via the Rcpp.package.skeleton.function() with the
>>    module=TRUE argument:
>>
>>
>>    R>  library(Rcpp)
>>    R>  Rcpp.package.skeleton("simple", module=TRUE)
>>    Creating directories ...
>>    Creating DESCRIPTION ...
>>    Creating NAMESPACE ...
>>    Creating Read-and-delete-me ...
>>    Saving functions and data ...
>>    Making help files ...
>>    Done.
>>    Further steps are described in './simple/Read-and-delete-me'.
>>
>>    Adding Rcpp settings
>>>> added RcppModules: yada
>>>> added Depends: Rcpp
>>>> added LinkingTo: Rcpp
>>>> added useDynLib directive to NAMESPACE
>>>> added Makevars file with Rcpp settings
>>>> added Makevars.win file with Rcpp settings
>>>> added example header file using Rcpp classes
>>>> added example src file using Rcpp classes
>>>> added example R file calling the C++ example
>>>> added Rd file for rcpp_hello_world
>>>> copied the example module
>>    R>
>>
>>
>> 3) As you are keen to see that we get actual new objects, I am just doing
>>    the minimal code for by adding one for a new class member function:
>>
>>     void showmyaddress() const { std::cout<<  "Address is "<<  this<<  std::endl; }
>>
>>    which I add to the class 'World' in file simple/src/rcpp_module.rcpp -- on
>>    line 32 if it matters.   I also add this line to the module definition in
>>    the same file on line 62:
>>
>>      .const_method( "showmyaddress",&World::showmyaddress, "get *this ptr address")
>>
>>    It doesn't matter that the method is const, you can do without const in
>>    both eg
>>
>>     void showmyaddress() { std::cout<<  "Address is "<<  this<<  std::endl; }
>>
>>     .method( "showmyaddress",&World::showmyaddress, "get *this ptr address")
>>
>>    All that the code does is reveal its pointer to stdout.
>>
>>
>> 4) Install it via
>>
>>    $ R CMD INSTALL simple
>>
>>
>> 5) Try it in R (and I first
>>
>>    R>  library(simple)
>>    Loading required package: Rcpp
>>    R>  World
>>    C++ class 'World'<0x2b84940>
>>    Constructors:
>>        World()
>>
>>    Fields: No public fields exposed by this class
>>
>>    Methods:
>>         std::string greet()
>>               docstring : get the message
>>         void set(std::string)
>>               docstring : set the message
>>         void showmyaddress()  const
>>               docstring : get *this ptr address
>>    R>
>>    R>  w1<- new( World )
>>    R>  w1$showmyaddress()
>>    Address is 0x2748370
>>    R>
>>    R>  w2<- new( World )
>>    R>  w2$showmyaddress()
>>    Address is 0x2f960b0
>>    R>
>>
>>
>>    so w1 and w2 are indeed objects of class World which live in different
>>    memory locations.
>>
>> This should show the mechanics.  This is somewhat easy -- especially if you
>> know some C++ where it then helps you from having to write boiler plate code.
>> If you are relatively new to C and C++, it can be a little tougher.  Either
>> way, to my mind it is shorter (and I'd argue, easier) than anything you could
>> do in plain C with the standard R API.
>>
>> Good luck, and please bring Rcpp questions to rcpp-devel.
>>
>> Regards, Dirk
>>
>>
>>
>> | Symbolic example (we hope this illustrates our problem):
>> |
>> | // C++ side:
>> | class Foo{
>> | ...
>> | }
>> | // perhaps:
>> | void my_new_instance_wrapper("the_character") // plain to see that I am no C++ programmer ;-)
>> | {
>> |   static Foo "the_character"; // no return needed since we know the name of the instance = "the_character"
>> | }
>> |
>> | # R side:
>> | create_new_instance<- function(name){
>> |   dono_what_to_use_here(???, class)
>> | }
>> | # perhaps:
>> | create_new_instance<- function(name){
>> |   .C("my_new_instance_wrapper", as.character(name))
>> | }
>> |
>> | dyn.load("Foo")
>> | obj1<- create_new_instance("bar", class="Foo")
>> | obj2<- create_new_instance("baz", class="Foo")
>> | str(obj1)
>> | : character which can be manipulated using class methods in the C++ realm
>> |
>> | What we do not want: make simple copies of the object in R; use Rcpp modules (we tried that without success, pointers in constructors cause trouble); re-write our code such that C++ only "works off" heavy code, the rest is R-side. What we want: interfacing (from the R-side) instances of our class where the instances exist in the C++ realm.
>> |
>> | Either there is a function (or code) in R that solve this task, perhaps by returning pointers to instances of C++ classes. (Or there is a possibility to create a wrapper in C++ creating a new instance, the wrapper we do not know of.)
>> |
>> | Thanks for any notes, tips, experiences.
>> |
>> | S?ren and Carlo
>
>
>
> R: sessionInfo()
>
> R version 2.13.0 (2011-04-13)
> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] Rcpp_0.9.4
>
> loaded via a namespace (and not attached):
> [1] tools_2.13.0
>
>
>
> /* ### Foo_mod.cpp ### */
> #include<Rcpp.h>
>
> class Foo
> {
> 	int N, M, n, m;
> 	double dtau;
> 	double * C;
> 	double * t;
> 	double * s;
> 	double * par;
> 	double * D;
> 	double * ee;
> 	double * ff;
> 	double * S;
> 	int * y;
> 	public:
> 		Foo(int N_, int M_, int n_) : N(N_), M(M_), n(n_)
> 		{
> 			D = new double[M];
> 			ee= new double[N];
> 			ff= new double[N];
> 			S = new double[n+1];
> 		}
> 		~Foo()
> 		{
> 			delete[] D;
> 			delete[] ee;
> 			delete[] ff;
> 			delete[] S;
> 		}
> 		// important methods
> //		void set_experiment(int m, double *C, double *s); // original code
> 		void do_foo(int m);
> 		void do_bar(double *C);
> 		// other stuff
> 		void set_data(int n, int *y, double *t);
> 		void set_accuracy(int N, int M);
> 		void set_par(double *par);
> 		double loglikelihood(double *z);
> };
>
> //void Foo::set_experiment(int mm, double *CC, double *ss)
> void Foo::do_foo(int mm)
> {
> 	m=mm;
> }
> void Foo::do_bar(double *CC)
> {
> 	C=CC;
> }
>
> RCPP_MODULE(mod_foo)
> {
> 	using namespace Rcpp;
> 	class_<Foo>( "Foo" )
> 		.constructor<int,int,int>()
> 		.method("do_foo",&Foo::do_foo) // works
> 		.method("do_bar",&Foo::do_bar) // does not work!
> 	;
> }
>
>
> ### compile warning with the working version:
> ** checking whether the name space can be loaded with stated dependencies ... WARNING
> Error: .onLoad failed in loadNamespace() for 'Foo', details:
>    call: value[[3L]](cond)
>    error: failed to load module mod_foo from package Foo
> Execution halted
> A namespace must be able to be loaded with just the base namespace
> loaded: otherwise if the namespace gets loaded by a saved object, the
> session will be unable to start.
> Probably some imports need to be declared in the NAMESPACE file.
>
>
> ### 00install.out
> * installing *source* package ?Foo? ...
> ** libs
> *** arch - i386
> g++-4.2 -arch i386 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include -I"/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include"   -fPIC  -g -O2 -c Foo_mod.cpp -o Foo_mod.o
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/traits/Exporter.h: In constructor ?Rcpp::traits::Exporter<T>::Exporter(SEXPREC*) [with T = double*]?:
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/as.h:51:   instantiated from ?T Rcpp::internal::as(SEXPREC*, Rcpp::traits::r_type_generic_tag) [with T = double*]?
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/as.h:75:   instantiated from ?T Rcpp::as(SEXPREC*) [with T = double*]?
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/module/Module_generated_CppMethod.h:122:   instantiated from ?SEXPREC* Rcpp::CppMethod1<Class, void, U0>::operator()(Class*, SEXPREC**) [with Class = Foo, U0 = double*]?
> Foo_mod.cpp:59:   instantiated from here
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/Rcpp/include/Rcpp/traits/Exporter.h:31: error: cannot convert ?SEXPREC*? to ?double*? in initialization
> make: *** [Foo_mod.o] Error 1
> ERROR: compilation failed for package ?Foo?
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
http://romain-francois.com
|- http://bit.ly/hdKhCy : Rcpp article in JSS
|- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
`- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th


From simon.urbanek at r-project.org  Sun May  8 00:13:08 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 7 May 2011 18:13:08 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <BANLkTimEDCkQ2xe2wyoJsU1Sk1We=u6d+A@mail.gmail.com>
References: <C9E9C213.40A8%sean.mcguffee@gmail.com>
	<1CEBCBAE-AD21-4F00-99D6-13235E8D3E29@r-project.org>
	<19908.45559.753550.277882@max.nulle.part>
	<BANLkTimEDCkQ2xe2wyoJsU1Sk1We=u6d+A@mail.gmail.com>
Message-ID: <7CB3AE31-B41F-4C61-80CB-851E2C152A7F@r-project.org>

Sean,

just to clarify - this is not about something "not working" or any leaks. cout/cerr do exactly what they are supposed to, it's just in most cases not what you want. The main reason is that R does not necessarily use stdin/stdout so cout/cerr may have nothing to do with the R console output. The effects of using cout/cerr vary by the actual setup in which you run R as I was explaining earlier. In the most complex setup (default for interactive R on OS X, actually) you have:

1) stdin/stdout/stderr - those are entirely independent of the R console
2) ReadConsole/WriteConsole - this is how R interacts with the console
3) C++ cin/cout/cerr - by default a buffered link to stdin/out/err

So as you see the reason for cout being strongly discouraged is simply because it has no relationship with R and produces no output in R itself. What makes things seemingly puzzling is that some UI implementations in R use stdin/out/err in Read/WriteConsole, so suddenly you are dealing with three independent streams and buffers (e.g., cout, WriteCondole and stdout all eventually ending in the same place but at different times). If your final output is a tty then they all get synchronized at the end into the same tty, but since each of them has a buffer, the result is random at the best.

Due to the interactions, you must be careful not to mess things up with any additional low-level stream manipulations. For example, the R.app GUI doesn't use stdout/err for console at all, since it is driven by text views instead, so it uses exclusively Read/WriteConsole (and so does the Windows GUI). However, it also monitors stdout/err for external output (e.g. from system()) and uses two separate pipes to merge that output into the console with different colors. So if you were to start to mess with the descriptors for stdout/err you could break that setup.

That said, if you want a solution for C++ you should simply write a stream or buffer that uses Rprintf/REprintf for output. I was assuming that others have done that before, but Dirk's response suggests that it is not as common. If you choose to do it, you may find this link helpful:
http://groups.google.com/group/comp.lang.c++/msg/1d941c0f26ea0d81

Cheers,
Simon


On May 7, 2011, at 12:42 AM, Sean Robert McGuffee wrote:

> This is a good idea as to converting to stringstream's because it
> could let me remove cout and cerr from the equation. At the moment, I
> get that feeling from the experts that having cout and cerr is causing
> a bug by not mixing with R. I have other cases where algorithms that
> avoid cout and cerr aren't working, but as far as my experience with
> bugs in c code goes, a memory issue in one place can make everything
> go haywire, and an random cout or cerr somewhere that I don't catch
> could maybe be the source of the issue. I also like this idea of
> piping and then calling Rprintf. Along the same lines, I could create
> a string and then either spit to cout or cerr or spit to Rprintf
> depending on some sort of setting. One of the key reasons I have been
> hanging on to cout and cerr is that I want to keep all of my c++ code
> identical to the status quo as far as the command line interface is
> concerned. On the other hand, maybe I can just globally substitute
> cout and cerr to random file streams and avoid the conflict with
> stdout and stderr. I take it that it isn't ostreams per say causing
> the problem but that it's something specific about cout and cerr not
> mixing with R. Then maybe I can pass their buffers to cout, cerr, or
> Rprintf, depending on preferences later. What I would really like to
> do maybe be beyond my grasp, but that would be to integrate ostreams
> into R. I am toying with an idea of mimicking cout and cerr with some
> new classes that are almost verbatim copies of cout and cerr with
> substituted names. Then maybe inside their internals I can more easily
> create conditional access to Rprintf calls. What I like about this
> strategy is that I could do a global substitution of cout and cerr
> with new objects of more useful functionality, and that way I might
> not have to re-write all my c++ code which constantly calls on these
> standard streams. Plus, if I get something generic to work, maybe I
> can pass it on to Dirk so others won't have to deal with this stuff in
> the future. I find this fascinating that the output may be tty. I see
> now that the device on my Mac that /dev/stdout points to is a tty. I
> have never encountered tty before, but I have a vague memory of a term
> like that back in the day of dial up! Oh the fun things I'm learning.
> Just to clarify though, is the only way my code "mixes IO systems
> between R and C++" by way of cout and cerr happening to be
> synchronized with stderr and stdout by default? Or is there something
> inherent in ostreams in general that doesn't mesh with R? I guess I
> find it a little bit surprising that calling
> ios_base::sync_with_stdio(false) and redirecting those streams to
> other files doesn't dodge that bullet. I know that doesn't break the
> ostreams themselves because it works fine from the command line
> interface. I guess I'll have to delve more into how c++ works behind
> the scenes to figure that part out. I think Dirk has a really good
> suggestion to comment out all of my cout and cerr calls and see if
> still get a bug. Obviously that wouldn't be any permanent fix for
> future users who want to link code with cout and cerr, but it would
> help me identify if this is the only source of error. It might take me
> till past the weekend to get to the bottom of some of these things,
> but I'll post what I find out.
> Thanks again--I appreciate everyone's useful suggestions.
> Sean
> 
> On Fri, May 6, 2011 at 10:44 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>> 
>> On 6 May 2011 at 22:09, Simon Urbanek wrote:
>> | Sean,
>> |
>> | the path form the console is not under your control and it depends heavily on the internal settings in R (is console enabled, is R interactive, is the output a tty or a file ...) - that's why you have to use Rprint/REprintf - that's the only path that is guaranteed to work. Anything else is settings-specific and not guaranteed to work (it may appear to work in limited settings, but will not work in others). Note that, for example, WriteConsole is only used if R is not fed via I/O pipes - that may be what baffled you in that case.
>> |
>> | So AFAICS the only C++ solution (other than using Rprintf/REprintf directly) is to create streams to pipes whose ends will call Rprintf/REprintf with the content. Anything else is not general. You may want to ask Rcpp people (Dirk is CC'd anyway ;)) - I'd imagine they must have thought of it as it seems very natural to request in a C++ interface ... (but I don't use Rcpp so I don't know).
>> 
>> Rcpp makes no claims about reimplementing IO, or providing new IO facilities.
>> Rcpp is clearly bound by the R API upon which it builds; the R documentation
>> (which I quoted in my earlier email in this thread) suggests to expect nasty
>> things when one mixes IO systems between R and C++.
>> 
>> And that seems to be what Sean is experiencing; I for one am not surprised.
>> It was never clear from Seans's mails exactly how much time he has had for
>> reading of the available documentation, his approach seems to me mostly
>> driven by a vast and vague set of assumption on his part (eg the rout/rerr
>> business he comes back to), as well as a lot energy and a willingness to just
>> try this.  Which is perfectly fine, but it can also fail.
>> 
>> I'd suggest to start small with as little IO as possible. Maybe even comment
>> all IO out as much as possible. Or redo it as strstream and feed that to
>> Rprintf.
>> 
>> Dirk
>> 
>> 
>> | Cheers,
>> | Simon
>> |
>> |
>> |
>> | On May 6, 2011, at 3:19 PM, Sean Robert McGuffee wrote:
>> |
>> | > Hi,
>> | >
>> | > Thanks for the comments so far.
>> | >
>> | > I've been going through the code extensively and seem to be having trouble
>> | > reproducing what R is doing, so this confuses me. For example, when I write
>> | > out the pointer values for ptr_R_WriteConsole type functions, I can't find a
>> | > function that matches what is actually being called.
>> | >
>> | > REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
>> | > R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
>> | > R_WriteConsole);
>> | >
>> | > It might be something like RTcl_WriteConsole too. However, I can't seem to
>> | > find the headers I would need to try to find it's pointer value. Anyway,
>> | > these are often hidden/protected/static which is an aspect of code that I
>> | > only understand in concept. The concept I understand about this type of
>> | > stuff is that if you provide a better way of doing things, then maybe you
>> | > hide some stuff that doesn't involve the better way. However, in this case,
>> | > the hidden stuff is just making it difficult for me to debug and get to
>> | > bottom of what is going on. Anyway, I get different results if I call on the
>> | > functions that simply use stdout when trying to reproduce Rprintf
>> | > functionality. I'm only doing that to try to get to the bottom of what R is
>> | > doing with stdout and stderr. I also am having a similar issue with trying
>> | > to understand what GNU GCC is doing with how it sync's cout and cerr with
>> | > stdout and stderr. Maybe R is intercepting some of these components. Anyway,
>> | >
>> | > I was hoping to get around the
>> | > "5.6 Interfacing C++ code
>> | >   ========================   [...]
>> | >      Using C++ iostreams, as in this example, is best avoided.  There is
>> | >   no guarantee that the output will appear in the R console, and indeed it
>> | >   will not on the R for Windows console.  Use R code or the C entry points
>> | >   (*note Printing::) for all I/O if at all possible."
>> | > if at all possible. My reason is that I have 76386 lines of c++ code that
>> | > I'm trying to interface with R, and it literally might be faster for me to
>> | > update R rather than modify all of that code to suit R which seems to be
>> | > lacking a c++ ostream interface.
>> | >
>> | > Ideally, I'd write rout and rerr versions of cout and cerr for R to become
>> | > more compatible with c++. I have had some trouble figuring a lot of this
>> | > hidden stuff out. Strategies I have considered are the following:
>> | > 1) Write macros that conditionally replace cerr and cout with Rprintf
>> | > somehow throughout all of my c++ code that I'm trying to interface with R.
>> | > 2) Recreate the std::cerr and std::cout type of classes but maybe add some
>> | > extra functionality for callbacks to when i/o events take place to somehow
>> | > try to fix things.
>> | > 3) Make a scratch version of R source code that has no hidden aspects to try
>> | > to investigate what is going on a little better.
>> | >
>> | > Also, I should mention that I found an unanswered post from someone who had
>> | > a similar problem when trying to use cerr and cout when accessing functions
>> | > from dynamically linked libraries. I wonder, is it possible that R hasn't
>> | > completely connected to these libraries? I mean, it's doing some sort of
>> | > magic where it finds a pointer to a function, but maybe c++ has a lot going
>> | > on in the background related to these ostream types that could be getting
>> | > messed up. Maybe some aspects of the global environment might be different
>> | > somehow? I directly link to my libraries via a c++ compiler when I get the
>> | > identical functions to work from main in c++.
>> | >
>> | > One final thing I'm considering is that the R manual also mentions something
>> | > about garbage collection and some circumstances under which it's important
>> | > to explicitly request pointers to be maintained. Is it possible that R is
>> | > eating global pointers used by std::ostream ?
>> | >
>> | > All suggestions are valued and if anyone has recommendations on strategy,
>> | > please let me know.
>> | >
>> | > Thanks,
>> | > Sean
>> | >
>> | >
>> | > On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:
>> | >
>> | >> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
>> | >>
>> | >>> | I?m trying to call some of my c++ code from R and seem to be having an
>> | >>> issue
>> | >>> | with streams, although that?s just one obvious sign of something different
>> | >>> | in performance between calling the same function from main in c++ vs.
>> | >>> | calling the same function from R. [...]
>> | >>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
>> | >>
>> | >> But isn't he redirecting cout to a file, so the C++ output is not to the
>> | >> console?
>> | >>
>> | >> Davor
>> | >
>> | >
>> | > On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:
>> | >
>> | >>
>> | >> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
>> | >> | Hi,
>> | >> |
>> | >> | Sorry, I just tried posting this but I had it in the wrong format of text,
>> | >> | so this is a cleared format repost:
>> | >> |
>> | >> | I?m trying to call some of my c++ code from R and seem to be having an issue
>> | >> | with streams, although that?s just one obvious sign of something different
>> | >> | in performance between calling the same function from main in c++ vs.
>> | >> | calling the same function from R. I?m not getting any signs of errors from
>> | >> | R, but the behavior is different somehow and in a way that breaks my
>> | >> | algorithms. In both cases of launching a function from c++ or R, I redirect
>> | >> | cout to a file using a streambuf. In particular, I can see progress stop
>> | >> | when launching from R at a point when cout gets truncated when starting to
>> | >> | write out iterator values in a std::vector<string>. Then, I find no way to
>> | >> | write anything else to cout. When I write those values to Rprintf, they are
>> | >> | there and they are as expected. I?ve tried setting
>> | >> | ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
>> | >> | somehow, but that made no difference. I?m not quite sure how R uses those C
>> | >> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
>> | >> | be going on. At this point I don?t know if it might be an issue with R not
>> | >> | completely handling c++ from a library or if it is an issue with cout in
>> | >> | particular or if there is something else I?m missing. Please let me know if
>> | >> | you have any suggestions for me.
>> | >>
>> | >> Doug Bates sometimes remarks that, once all other alternatives are exhausted,
>> | >> one could consider reading the manual. And indeed, 'Writing R Extensions' has
>> | >> this to say:
>> | >>
>> | >>   5.6 Interfacing C++ code
>> | >>   ========================
>> | >>
>> | >>   [...]
>> | >>
>> | >>      Using C++ iostreams, as in this example, is best avoided.  There is
>> | >>   no guarantee that the output will appear in the R console, and indeed it
>> | >>   will not on the R for Windows console.  Use R code or the C entry points
>> | >>   (*note Printing::) for all I/O if at all possible.
>> | >>
>> | >> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
>> | >>
>> | >> Dirk
>> | >>
>> | >> --
>> | >> Gauss once played himself in a zero-sum game and won $50.
>> | >>                      -- #11 at http://www.gaussfacts.com
>> | >
>> | > ______________________________________________
>> | > R-devel at r-project.org mailing list
>> | > https://stat.ethz.ch/mailman/listinfo/r-devel
>> | >
>> | >
>> |
>> 
>> --
>> Gauss once played himself in a zero-sum game and won $50.
>>                      -- #11 at http://www.gaussfacts.com
> 
> 


From chuck at sharpsteen.net  Sun May  8 03:09:18 2011
From: chuck at sharpsteen.net (Sharpie)
Date: Sat, 7 May 2011 18:09:18 -0700 (PDT)
Subject: [Rd] fortan common block
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
References: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <1304816958633-3506373.post@n4.nabble.com>


Paul Gilbert wrote:
> 
> Is it possible in R to call a fortran routine that sets variables in a
> common block and expect the values to persist when a call is made from R
> to a second routine that uses the common block?
> 
> If not (as I suspect),  is it possible to use a common block in a group of
> routines that are used together, for as long the routines do not return to
> R?
> 
> Paul
> 

Don't see why not--should be pretty easy to test. Personally, I would use
variables in a Fortran 90 module over a common block.

-Charlie

-----
Charlie Sharpsteen
Undergraduate-- Environmental Resources Engineering
Humboldt State University
--
View this message in context: http://r.789695.n4.nabble.com/fortan-common-block-tp3503204p3506373.html
Sent from the R devel mailing list archive at Nabble.com.


From sean.mcguffee at gmail.com  Sun May  8 06:56:35 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Sun, 8 May 2011 00:56:35 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <7CB3AE31-B41F-4C61-80CB-851E2C152A7F@r-project.org>
References: <C9E9C213.40A8%sean.mcguffee@gmail.com>
	<1CEBCBAE-AD21-4F00-99D6-13235E8D3E29@r-project.org>
	<19908.45559.753550.277882@max.nulle.part>
	<BANLkTimEDCkQ2xe2wyoJsU1Sk1We=u6d+A@mail.gmail.com>
	<7CB3AE31-B41F-4C61-80CB-851E2C152A7F@r-project.org>
Message-ID: <BANLkTimWcFJNxmymVMNv8SOqcBtoEE-BEQ@mail.gmail.com>

Thanks, Simon,
That link may prove to be very useful. I think what I can do is make a
similar version of a buffer to one in that example and then have it
conditionally write to Rprintf or cout and/or REprintf or cerr,
depending on whether I'm running a c++ program from the command line
or launching a function from R. Then I can just replace all of my cout
and cerr terms with this new buffer or two in global space. Before I
call those functions in R, I'll set them to write to R before I launch
any code that uses it. This should allow me to leave all my code
exactly how it is with a minor replacement of one or two terms for
another. So, if the errors in my performance are only caused by
writing to cout and/or cerr from R, then they can be completely
avoided by all of those substitutions writing to Rprintf and REprintf.
This seems like it is going to work exactly as I'm hoping.
Thanks again,
Sean

On Sat, May 7, 2011 at 6:13 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
> Sean,
>
> just to clarify - this is not about something "not working" or any leaks. cout/cerr do exactly what they are supposed to, it's just in most cases not what you want. The main reason is that R does not necessarily use stdin/stdout so cout/cerr may have nothing to do with the R console output. The effects of using cout/cerr vary by the actual setup in which you run R as I was explaining earlier. In the most complex setup (default for interactive R on OS X, actually) you have:
>
> 1) stdin/stdout/stderr - those are entirely independent of the R console
> 2) ReadConsole/WriteConsole - this is how R interacts with the console
> 3) C++ cin/cout/cerr - by default a buffered link to stdin/out/err
>
> So as you see the reason for cout being strongly discouraged is simply because it has no relationship with R and produces no output in R itself. What makes things seemingly puzzling is that some UI implementations in R use stdin/out/err in Read/WriteConsole, so suddenly you are dealing with three independent streams and buffers (e.g., cout, WriteCondole and stdout all eventually ending in the same place but at different times). If your final output is a tty then they all get synchronized at the end into the same tty, but since each of them has a buffer, the result is random at the best.
>
> Due to the interactions, you must be careful not to mess things up with any additional low-level stream manipulations. For example, the R.app GUI doesn't use stdout/err for console at all, since it is driven by text views instead, so it uses exclusively Read/WriteConsole (and so does the Windows GUI). However, it also monitors stdout/err for external output (e.g. from system()) and uses two separate pipes to merge that output into the console with different colors. So if you were to start to mess with the descriptors for stdout/err you could break that setup.
>
> That said, if you want a solution for C++ you should simply write a stream or buffer that uses Rprintf/REprintf for output. I was assuming that others have done that before, but Dirk's response suggests that it is not as common. If you choose to do it, you may find this link helpful:
> http://groups.google.com/group/comp.lang.c++/msg/1d941c0f26ea0d81
>
> Cheers,
> Simon
>
>
> On May 7, 2011, at 12:42 AM, Sean Robert McGuffee wrote:
>
>> This is a good idea as to converting to stringstream's because it
>> could let me remove cout and cerr from the equation. At the moment, I
>> get that feeling from the experts that having cout and cerr is causing
>> a bug by not mixing with R. I have other cases where algorithms that
>> avoid cout and cerr aren't working, but as far as my experience with
>> bugs in c code goes, a memory issue in one place can make everything
>> go haywire, and an random cout or cerr somewhere that I don't catch
>> could maybe be the source of the issue. I also like this idea of
>> piping and then calling Rprintf. Along the same lines, I could create
>> a string and then either spit to cout or cerr or spit to Rprintf
>> depending on some sort of setting. One of the key reasons I have been
>> hanging on to cout and cerr is that I want to keep all of my c++ code
>> identical to the status quo as far as the command line interface is
>> concerned. On the other hand, maybe I can just globally substitute
>> cout and cerr to random file streams and avoid the conflict with
>> stdout and stderr. I take it that it isn't ostreams per say causing
>> the problem but that it's something specific about cout and cerr not
>> mixing with R. Then maybe I can pass their buffers to cout, cerr, or
>> Rprintf, depending on preferences later. What I would really like to
>> do maybe be beyond my grasp, but that would be to integrate ostreams
>> into R. I am toying with an idea of mimicking cout and cerr with some
>> new classes that are almost verbatim copies of cout and cerr with
>> substituted names. Then maybe inside their internals I can more easily
>> create conditional access to Rprintf calls. What I like about this
>> strategy is that I could do a global substitution of cout and cerr
>> with new objects of more useful functionality, and that way I might
>> not have to re-write all my c++ code which constantly calls on these
>> standard streams. Plus, if I get something generic to work, maybe I
>> can pass it on to Dirk so others won't have to deal with this stuff in
>> the future. I find this fascinating that the output may be tty. I see
>> now that the device on my Mac that /dev/stdout points to is a tty. I
>> have never encountered tty before, but I have a vague memory of a term
>> like that back in the day of dial up! Oh the fun things I'm learning.
>> Just to clarify though, is the only way my code "mixes IO systems
>> between R and C++" by way of cout and cerr happening to be
>> synchronized with stderr and stdout by default? Or is there something
>> inherent in ostreams in general that doesn't mesh with R? I guess I
>> find it a little bit surprising that calling
>> ios_base::sync_with_stdio(false) and redirecting those streams to
>> other files doesn't dodge that bullet. I know that doesn't break the
>> ostreams themselves because it works fine from the command line
>> interface. I guess I'll have to delve more into how c++ works behind
>> the scenes to figure that part out. I think Dirk has a really good
>> suggestion to comment out all of my cout and cerr calls and see if
>> still get a bug. Obviously that wouldn't be any permanent fix for
>> future users who want to link code with cout and cerr, but it would
>> help me identify if this is the only source of error. It might take me
>> till past the weekend to get to the bottom of some of these things,
>> but I'll post what I find out.
>> Thanks again--I appreciate everyone's useful suggestions.
>> Sean
>>
>> On Fri, May 6, 2011 at 10:44 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>>>
>>> On 6 May 2011 at 22:09, Simon Urbanek wrote:
>>> | Sean,
>>> |
>>> | the path form the console is not under your control and it depends heavily on the internal settings in R (is console enabled, is R interactive, is the output a tty or a file ...) - that's why you have to use Rprint/REprintf - that's the only path that is guaranteed to work. Anything else is settings-specific and not guaranteed to work (it may appear to work in limited settings, but will not work in others). Note that, for example, WriteConsole is only used if R is not fed via I/O pipes - that may be what baffled you in that case.
>>> |
>>> | So AFAICS the only C++ solution (other than using Rprintf/REprintf directly) is to create streams to pipes whose ends will call Rprintf/REprintf with the content. Anything else is not general. You may want to ask Rcpp people (Dirk is CC'd anyway ;)) - I'd imagine they must have thought of it as it seems very natural to request in a C++ interface ... (but I don't use Rcpp so I don't know).
>>>
>>> Rcpp makes no claims about reimplementing IO, or providing new IO facilities.
>>> Rcpp is clearly bound by the R API upon which it builds; the R documentation
>>> (which I quoted in my earlier email in this thread) suggests to expect nasty
>>> things when one mixes IO systems between R and C++.
>>>
>>> And that seems to be what Sean is experiencing; I for one am not surprised.
>>> It was never clear from Seans's mails exactly how much time he has had for
>>> reading of the available documentation, his approach seems to me mostly
>>> driven by a vast and vague set of assumption on his part (eg the rout/rerr
>>> business he comes back to), as well as a lot energy and a willingness to just
>>> try this. ?Which is perfectly fine, but it can also fail.
>>>
>>> I'd suggest to start small with as little IO as possible. Maybe even comment
>>> all IO out as much as possible. Or redo it as strstream and feed that to
>>> Rprintf.
>>>
>>> Dirk
>>>
>>>
>>> | Cheers,
>>> | Simon
>>> |
>>> |
>>> |
>>> | On May 6, 2011, at 3:19 PM, Sean Robert McGuffee wrote:
>>> |
>>> | > Hi,
>>> | >
>>> | > Thanks for the comments so far.
>>> | >
>>> | > I've been going through the code extensively and seem to be having trouble
>>> | > reproducing what R is doing, so this confuses me. For example, when I write
>>> | > out the pointer values for ptr_R_WriteConsole type functions, I can't find a
>>> | > function that matches what is actually being called.
>>> | >
>>> | > REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
>>> | > R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
>>> | > R_WriteConsole);
>>> | >
>>> | > It might be something like RTcl_WriteConsole too. However, I can't seem to
>>> | > find the headers I would need to try to find it's pointer value. Anyway,
>>> | > these are often hidden/protected/static which is an aspect of code that I
>>> | > only understand in concept. The concept I understand about this type of
>>> | > stuff is that if you provide a better way of doing things, then maybe you
>>> | > hide some stuff that doesn't involve the better way. However, in this case,
>>> | > the hidden stuff is just making it difficult for me to debug and get to
>>> | > bottom of what is going on. Anyway, I get different results if I call on the
>>> | > functions that simply use stdout when trying to reproduce Rprintf
>>> | > functionality. I'm only doing that to try to get to the bottom of what R is
>>> | > doing with stdout and stderr. I also am having a similar issue with trying
>>> | > to understand what GNU GCC is doing with how it sync's cout and cerr with
>>> | > stdout and stderr. Maybe R is intercepting some of these components. Anyway,
>>> | >
>>> | > I was hoping to get around the
>>> | > "5.6 Interfacing C++ code
>>> | > ? ======================== ? [...]
>>> | > ? ? ?Using C++ iostreams, as in this example, is best avoided. ?There is
>>> | > ? no guarantee that the output will appear in the R console, and indeed it
>>> | > ? will not on the R for Windows console. ?Use R code or the C entry points
>>> | > ? (*note Printing::) for all I/O if at all possible."
>>> | > if at all possible. My reason is that I have 76386 lines of c++ code that
>>> | > I'm trying to interface with R, and it literally might be faster for me to
>>> | > update R rather than modify all of that code to suit R which seems to be
>>> | > lacking a c++ ostream interface.
>>> | >
>>> | > Ideally, I'd write rout and rerr versions of cout and cerr for R to become
>>> | > more compatible with c++. I have had some trouble figuring a lot of this
>>> | > hidden stuff out. Strategies I have considered are the following:
>>> | > 1) Write macros that conditionally replace cerr and cout with Rprintf
>>> | > somehow throughout all of my c++ code that I'm trying to interface with R.
>>> | > 2) Recreate the std::cerr and std::cout type of classes but maybe add some
>>> | > extra functionality for callbacks to when i/o events take place to somehow
>>> | > try to fix things.
>>> | > 3) Make a scratch version of R source code that has no hidden aspects to try
>>> | > to investigate what is going on a little better.
>>> | >
>>> | > Also, I should mention that I found an unanswered post from someone who had
>>> | > a similar problem when trying to use cerr and cout when accessing functions
>>> | > from dynamically linked libraries. I wonder, is it possible that R hasn't
>>> | > completely connected to these libraries? I mean, it's doing some sort of
>>> | > magic where it finds a pointer to a function, but maybe c++ has a lot going
>>> | > on in the background related to these ostream types that could be getting
>>> | > messed up. Maybe some aspects of the global environment might be different
>>> | > somehow? I directly link to my libraries via a c++ compiler when I get the
>>> | > identical functions to work from main in c++.
>>> | >
>>> | > One final thing I'm considering is that the R manual also mentions something
>>> | > about garbage collection and some circumstances under which it's important
>>> | > to explicitly request pointers to be maintained. Is it possible that R is
>>> | > eating global pointers used by std::ostream ?
>>> | >
>>> | > All suggestions are valued and if anyone has recommendations on strategy,
>>> | > please let me know.
>>> | >
>>> | > Thanks,
>>> | > Sean
>>> | >
>>> | >
>>> | > On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:
>>> | >
>>> | >> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
>>> | >>
>>> | >>> | I?m trying to call some of my c++ code from R and seem to be having an
>>> | >>> issue
>>> | >>> | with streams, although that?s just one obvious sign of something different
>>> | >>> | in performance between calling the same function from main in c++ vs.
>>> | >>> | calling the same function from R. [...]
>>> | >>> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
>>> | >>
>>> | >> But isn't he redirecting cout to a file, so the C++ output is not to the
>>> | >> console?
>>> | >>
>>> | >> Davor
>>> | >
>>> | >
>>> | > On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:
>>> | >
>>> | >>
>>> | >> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
>>> | >> | Hi,
>>> | >> |
>>> | >> | Sorry, I just tried posting this but I had it in the wrong format of text,
>>> | >> | so this is a cleared format repost:
>>> | >> |
>>> | >> | I?m trying to call some of my c++ code from R and seem to be having an issue
>>> | >> | with streams, although that?s just one obvious sign of something different
>>> | >> | in performance between calling the same function from main in c++ vs.
>>> | >> | calling the same function from R. I?m not getting any signs of errors from
>>> | >> | R, but the behavior is different somehow and in a way that breaks my
>>> | >> | algorithms. In both cases of launching a function from c++ or R, I redirect
>>> | >> | cout to a file using a streambuf. In particular, I can see progress stop
>>> | >> | when launching from R at a point when cout gets truncated when starting to
>>> | >> | write out iterator values in a std::vector<string>. Then, I find no way to
>>> | >> | write anything else to cout. When I write those values to Rprintf, they are
>>> | >> | there and they are as expected. I?ve tried setting
>>> | >> | ios_base::sync_with_stdio(false) in case R is messing with stdout and stderr
>>> | >> | somehow, but that made no difference. I?m not quite sure how R uses those C
>>> | >> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to what might
>>> | >> | be going on. At this point I don?t know if it might be an issue with R not
>>> | >> | completely handling c++ from a library or if it is an issue with cout in
>>> | >> | particular or if there is something else I?m missing. Please let me know if
>>> | >> | you have any suggestions for me.
>>> | >>
>>> | >> Doug Bates sometimes remarks that, once all other alternatives are exhausted,
>>> | >> one could consider reading the manual. And indeed, 'Writing R Extensions' has
>>> | >> this to say:
>>> | >>
>>> | >> ? 5.6 Interfacing C++ code
>>> | >> ? ========================
>>> | >>
>>> | >> ? [...]
>>> | >>
>>> | >> ? ? ?Using C++ iostreams, as in this example, is best avoided. ?There is
>>> | >> ? no guarantee that the output will appear in the R console, and indeed it
>>> | >> ? will not on the R for Windows console. ?Use R code or the C entry points
>>> | >> ? (*note Printing::) for all I/O if at all possible.
>>> | >>
>>> | >> In a nutshell, R 'owns' your console. That is part of the Faustian bargain.
>>> | >>
>>> | >> Dirk
>>> | >>
>>> | >> --
>>> | >> Gauss once played himself in a zero-sum game and won $50.
>>> | >> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com
>>> | >
>>> | > ______________________________________________
>>> | > R-devel at r-project.org mailing list
>>> | > https://stat.ethz.ch/mailman/listinfo/r-devel
>>> | >
>>> | >
>>> |
>>>
>>> --
>>> Gauss once played himself in a zero-sum game and won $50.
>>> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com
>>
>>
>
>


From john.maindonald at anu.edu.au  Sun May  8 09:25:56 2011
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Sun, 8 May 2011 17:25:56 +1000
Subject: [Rd] anova.lm fails with test="Cp"
Message-ID: <0E28A214-9F72-45A2-AAA2-E1D7EC46C6B1@anu.edu.au>

Here is an example, modified from the help page to use test="Cp":

--------------------------------------------------------------------------------
> fit0 <- lm(sr ~ 1, data = LifeCycleSavings)
> fit1 <- update(fit0, . ~ . + pop15)
> fit2 <- update(fit1, . ~ . + pop75)
> anova(fit0, fit1, fit2, test="Cp")
Error in `[.data.frame`(table, , "Resid. Dev") : 
 undefined columns selected
> sessionInfo()
R version 2.13.0 Patched (2011-04-28 r55678)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_2.13.0

--------------------------------------------------------------------------------------

The help page says for  "test:" 	
"a character string specifying the test statistic to be used. 
Can be one of "F", "Chisq" or "Cp", with partial matching allowed, 
or NULL for no test."

test="Cp" is, following the help page, intended to work?  Setting
the scale parameter does not help.

John Maindonald             email: john.maindonald at anu.edu.au
phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
Centre for Mathematics & Its Applications, Room 1194,
John Dedman Mathematical Sciences Building (Building 27)
Australian National University, Canberra ACT 0200.
http://www.maths.anu.edu.au/~johnm


From b.rowlingson at lancaster.ac.uk  Sun May  8 09:43:31 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 8 May 2011 08:43:31 +0100
Subject: [Rd] fortan common block
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
References: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <BANLkTi=9TBmpxT-UL-FGCsejnEZ0-X3c8A@mail.gmail.com>

On Fri, May 6, 2011 at 4:04 PM, Paul Gilbert
<pgilbert at bank-banque-canada.ca> wrote:
> Is it possible in R to call a fortran routine that sets variables in a common block and expect the values to persist when a call is made from R to a second routine that uses the common block?
>
> If not (as I suspect), ?is it possible to use a common block in a group of routines that are used together, for as long the routines do not return to R?

Simple test seems to confirm it. Here's some 'tran with a setter and a getter:

comchk.f:

      subroutine bar(n)
      common /c/ i
      i=n
      end

      subroutine geti(j)
      common /c/ i
      j = i
      end

R CMD SHLIB comchk.f
 > dyn.load("comchk.so")

 > .Fortran("bar",as.integer(9))
 [[1]]
 [1] 9

 > .Fortran("geti",as.integer(-1))
 [[1]]
 [1] 9

Barry


From pdalgd at gmail.com  Sun May  8 10:15:20 2011
From: pdalgd at gmail.com (peter dalgaard)
Date: Sun, 8 May 2011 10:15:20 +0200
Subject: [Rd] anova.lm fails with test="Cp"
In-Reply-To: <0E28A214-9F72-45A2-AAA2-E1D7EC46C6B1@anu.edu.au>
References: <0E28A214-9F72-45A2-AAA2-E1D7EC46C6B1@anu.edu.au>
Message-ID: <AA81EAC1-22CD-4550-BFCA-C04F42F8FB3A@gmail.com>


On May 8, 2011, at 09:25 , John Maindonald wrote:

> Here is an example, modified from the help page to use test="Cp":
> 
> --------------------------------------------------------------------------------
>> fit0 <- lm(sr ~ 1, data = LifeCycleSavings)
>> fit1 <- update(fit0, . ~ . + pop15)
>> fit2 <- update(fit1, . ~ . + pop75)
>> anova(fit0, fit1, fit2, test="Cp")
> Error in `[.data.frame`(table, , "Resid. Dev") : 
> undefined columns selected

Yes, the "Resid. Dev" column is only there in analysis of deviance tables. For the lm() case, it looks like you should have "RSS". 

This has probably been there "forever". Just goes to show how often people use these things...

Also, now that I'm looking at it, are we calculating it correctly in any case? We have

        cbind(table, Cp = table[, "Resid. Dev"] + 2 * scale * 
            (n - table[, "Resid. Df"]))

whereas all the references I can find have Cp=RSS/MS-N+2P, so the above would actually be scale*Cp+N. 


-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From hadley at rice.edu  Sun May  8 17:41:35 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Sun, 8 May 2011 10:41:35 -0500
Subject: [Rd] Warning when drop is missing
Message-ID: <BANLkTi=rUDyb6z0kbO_dt0rYFGbfNwwsZQ@mail.gmail.com>

Hi all,

One common bug I find in my code is that I've forgotten to specify
drop = F when subsetting a data frame, and then my code breaks when
the result is unexpectedly a vector. Does anyone have an effective
technique for preventing this from happening?  I have an approach (see
below) that works for the similar case of not explicitly specifying
na.rm behaviour, but since the subsetting functions are primitive this
approach doesn't work.

Thanks!

Hadley

  objs <- c(ls("package:base", "package:stats"))
  has_missing_arg <- function(name) {
    x <- get(name)
    if (!is.function(x)) return(FALSE)

    args <- names(formals(x))
    "na.rm" %in% args
  }
  f_miss <- Filter(has_missing_arg, objs)

  trace_all <- function(fs, tracer) {
    sapply(fs, trace, tracer = tracer, print = FALSE)
    return()
  }

  trace_all(f_miss, quote(if(missing(na.rm)) stop("na.rm not set")))


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From mtmorgan at fhcrc.org  Sun May  8 18:25:53 2011
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 08 May 2011 09:25:53 -0700
Subject: [Rd] Devel version of R CMD build may create packages with
 incomplete doc/ directories
Message-ID: <4DC6C411.6050508@fhcrc.org>

An .Rnw file in the vignettes/ directory might reasonably \usepackage or 
\include .sty, .bib, or other (e.g., image) files in the same directory 
or a sub-directory. The .Rnw file is copied to inst/doc and hence 
installed, but the additional files are not. This means that the 
installed .Rnw files are not useful. What can the package author do to 
ensure that the installed .Rnw file is fully functional? Or is it more 
appropriate to add only Stangled and pdf versions of .Rnw to the 
installed doc/ directory?

R version 2.14.0 Under development (unstable) (2011-05-07 r55798)
-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From hpages at fhcrc.org  Sun May  8 21:29:20 2011
From: hpages at fhcrc.org (=?windows-1252?Q?Herv=E9_Pag=E8s?=)
Date: Sun, 08 May 2011 12:29:20 -0700
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC1B0BD.6030509@aon.at>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>	<4DBF04E4.8020806@aon.at>	<4DBFE206.3030708@statistik.tu-dortmund.de>	<4DC05427.7060908@aon.at>	<4DC061D1.3080105@statistik.tu-dortmund.de>	<4DC06A03.2010205@aon.at>	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>	<4DC0708C.2060708@aon.at>	<CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>
	<4DC1B0BD.6030509@aon.at>
Message-ID: <4DC6EF10.3040308@fhcrc.org>

Hi Christian,

On 11-05-04 01:02 PM, cstrato wrote:
> Dear Simon,
>
> I did not complain about the R doing something wrong. I only wanted to
> know why, after all these years, R CMD check does suddenly no longer
> build the pdf-files of the vignettes. I also think that this is a legal
> question.
>
> Let me compare the times spent:
>
> 1, the "official" development cycle:
> - R CMD build: 5 minutes
> - R CMD INSTALL: 3 minutes
> - R CMD check: 6 minutes
>
> 2, my own development cycle:
> - manual tarring: 2 seconds
> - R CMD check: 6 minutes
>
> This means spending 14 minutes vs 6 minutes.

My understanding is that R CMD INSTALL is not strictly necessary in
the official devel cycle. However, to be fair you should either include
that step in both cycles (devel and yours) or not. Then the numbers are
14 minutes vs 9 minutes (or 11 minutes vs 6 minutes).

> If I assume that in one
> evening I have to make 10 corrections this would mean 140 minutes vs 60
> minutes, i.e. the official development cycle would take 1 hr and 20 min
> longer than my own development cycle. This is time I do not have.

No matter how you put it and how much benefits you get from this,
manual tarring is *wrong* and "after all these years" you should really
know this. Furthermore, here is what you claimed in a previous email:

   This is my development cycle:

   First, I run R CMD check until there are no more warnings/errors.
   Since years it was very convenient that R CMD check builds the
   pdf-files of the vignettes, too, since this allowed me to correct
   errors in the manual files and the vignette files at the same time!

   Afterwards I run R CMD INSTALL to install my package and do more
   tests until everything works.

   As you see I do not use R CMD build, since every run takes about
   5 minutes, it overwrites my zipped source code, and I would need
   to unzip it to get access to the vignette pdf-files.

You didn't mention the manual tarring.

Then later:

   Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
   code is not polluted.

So you are contradicting yourself.

   No, I simply do "tar czf xps_1.13.1.tar.gz xps".

Whaooo, finally! Note that, among other problems, this manual tarring
is very likely to pollute your source tree (this is one of the things
R CMD build will take care of).

You are free to do manual tarring for your own internal business if
you want, nobody cares, but you should keep this kind of dirty little
secrets for you. For your 10 corrections, you can do manual tarring
10 times, that's your problem, but that doesn't prevent you from doing
the right thing, i.e. R CMD build + R CMD check, as a *final* pass (e.g.
just before you commit your changes to svn). Now that means 71 minutes
vs 60 minutes, but you did the *right* thing.

Cheers,
H.



>
> Best regards
> Christian
>
>
> On 5/4/11 12:13 AM, Simon Urbanek wrote:
>> On May 3, 2011, at 5:15 PM, cstrato wrote:
>>
>>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>>
>>
>> Well, that's your problem then, not R's. Source packages are created
>> using R CMD build, not by manual tarring (you can do the latter if you
>> know what you're doing, but then you can't complain about the R doing
>> something wrong).
>>
>> Cheers,
>> S
>>
>>
>>>
>>> On 5/3/11 11:11 PM, Simon Urbanek wrote:
>>>> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at> wrote:
>>>>
>>>>> Dear Uwe,
>>>>>
>>>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
>>>>> code is not polluted.
>>>>>
>>>>
>>>> But then you already used build to create the tar ball so the
>>>> vignette has been built. So what is your point?
>>>>
>>>> Cheers,
>>>> S
>>>>
>>>>
>>>>> Furthermore, I forgot to mention that finally I upload the source
>>>>> code only to the BioC svn repository. The rest is done by the BioC
>>>>> servers, including building the pdf-files for the vignettes.
>>>>>
>>>>> Best regards
>>>>> Christian
>>>>>
>>>>>
>>>>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>>>>
>>>>>>
>>>>>> On 03.05.2011 21:14, cstrato wrote:
>>>>>>> Dear Uwe,
>>>>>>>
>>>>>>> This is my development cycle:
>>>>>>>
>>>>>>> First, I run R CMD check until there are no more warnings/errors.
>>>>>>> Since
>>>>>>> years it was very convenient that R CMD check builds the
>>>>>>> pdf-files of
>>>>>>> the vignettes, too, since this allowed me to correct errors in the
>>>>>>> manual files and the vignette files at the same time!
>>>>>>>
>>>>>>> Afterwards I run R CMD INSTALL to install my package and do more
>>>>>>> tests
>>>>>>> until everything works.
>>>>>>>
>>>>>>> As you see I do not use R CMD build, since every run takes about 5
>>>>>>> minutes, it overwrites my zipped source code, and I would need to
>>>>>>> unzip
>>>>>>> it to get access to the vignette pdf-files.
>>>>>>
>>>>>>
>>>>>> Then this is the main problem here. The *recommended* development
>>>>>> cycle
>>>>>> from the manuals is to run
>>>>>>
>>>>>> 1. R CMD build in order to get a valid source tarball and clean
>>>>>> the sources
>>>>>> 2. R CMD INSTALL to check if your package can be installed
>>>>>> 3. R CMD check in order to finally check your package
>>>>>>
>>>>>> Running R CMD INSTALL on your source directory may pollute it, hence
>>>>>> this is not recommended at all.
>>>>>>
>>>>>>
>>>>>> Best,
>>>>>> UWe
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>>
>>>>>>>
>>>>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>>>>> Dear Prof. Ripley,
>>>>>>>>>
>>>>>>>>> Thank you for your confirmation and explanation, I understand the
>>>>>>>>> reason
>>>>>>>>> for cleaning things up to save memory. However, it was very
>>>>>>>>> convenient
>>>>>>>>> to have this feature in earlier versions of R. It would be really
>>>>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>>>>> "--no-clean-vignettes".
>>>>>>>>>
>>>>>>>>> FYI, I did not claim "..create the vignettes *in<pkg>inst/doc*",
>>>>>>>>> instead my words were:
>>>>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2
>>>>>>>>> contains
>>>>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck
>>>>>>>>> from
>>>>>>>>> R-2.13.0 does not contain "inst".
>>>>>>>>
>>>>>>>>
>>>>>>>> But you do not need it. I do not know how often I have to
>>>>>>>> mention that
>>>>>>>> vignettes are produced by R CMD build! They are already build when
>>>>>>>> running R CMD check. And please do not tell us about tzhe PDF
>>>>>>>> version
>>>>>>>> oif manuals which are *unrelated* to vignettes, because they are
>>>>>>>> not
>>>>>>>> built in advance and need to be checked, since they should be
>>>>>>>> produced
>>>>>>>> at user level while vignettes are built at developer level already.
>>>>>>>>
>>>>>>>> Uwe Ligges
>>>>>>>>
>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>>>>
>>>>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>
>>>>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my
>>>>>>>>>>>> Mac in a
>>>>>>>>>>>> virtual machine, I have now done the following tests on all
>>>>>>>>>>>> three
>>>>>>>>>>>> architectures:
>>>>>>>>>>>>
>>>>>>>>>>>> 1, R CMD build xps:
>>>>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all
>>>>>>>>>>>> vignettes as
>>>>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>>>>
>>>>>>>>>>>> 2, R CMD check xps:
>>>>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no
>>>>>>>>>>>> longer build
>>>>>>>>>>>> the
>>>>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did
>>>>>>>>>>>> create the
>>>>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>>>>
>>>>>>>>>>>> Thus the question is:
>>>>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>>>>
>>>>>>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>>>>>>> reliable check, you should build the package, then check the
>>>>>>>>>>> tar.gz
>>>>>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>>>>>>
>>>>>>>>>> Actually, it does. What earlier versions never did (despite
>>>>>>>>>> 'cstrato's
>>>>>>>>>> repeated delusional claims earlier) was to create the
>>>>>>>>>> vignettes *in
>>>>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes
>>>>>>>>>> in a
>>>>>>>>>> working directory. The difference is that 2.13.0 deletes that
>>>>>>>>>> working
>>>>>>>>>> directory if the test was successful, whereas earlier versions
>>>>>>>>>> left
>>>>>>>>>> the
>>>>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>>>>> However,
>>>>>>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>>>>>>> succeeded
>>>>>>>>>>
>>>>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>>>>
>>>>>>>>>> R 2.12.2 gave
>>>>>>>>>>
>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>>>>
>>>>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>>>>
>>>>>>>>>> R 2.13.0 gives
>>>>>>>>>>
>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>> Animal.Rnw
>>>>>>>>>>
>>>>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>>>>> Animal.Rnw
>>>>>>>>>>
>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>
>>>>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>>>>
>>>>>>>>>> The main reason for cleaning up is that to mimic R CMD build
>>>>>>>>>> the test
>>>>>>>>>> has to make a complete copy of the package sources, and that
>>>>>>>>>> adds up:
>>>>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>>>>>> converted to
>>>>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my
>>>>>>>>>>>>>> Mac did
>>>>>>>>>>>>>> not
>>>>>>>>>>>>>> like
>>>>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any
>>>>>>>>>>>>>> pdf files
>>>>>>>>>>>>>> for
>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Dioes it give an error or warning? It should check the
>>>>>>>>>>>>> code. R CMD
>>>>>>>>>>>>> build
>>>>>>>>>>>>> creates the pdf files.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> My problem seems to be that at the moment the problem
>>>>>>>>>>>>>>>> can be
>>>>>>>>>>>>>>>> seen
>>>>>>>>>>>>>>>> only
>>>>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no
>>>>>>>>>>>>>>>> problems
>>>>>>>>>>>>>>>> creating
>>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Then you are definitely the one in the best position to
>>>>>>>>>>>>>>> diagnose
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>> that looks unrelated. Verify that the problem still
>>>>>>>>>>>>>>> exists, then
>>>>>>>>>>>>>>> cut
>>>>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>>>>> particular
>>>>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>>>>> statements, or
>>>>>>>>>>>>>>> use
>>>>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so
>>>>>>>>>>>>>>> special
>>>>>>>>>>>>>>> about your
>>>>>>>>>>>>>>> system.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>>>>>> that is
>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>>>>>>> it. If
>>>>>>>>>>>>>>> it's
>>>>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Thank you for your example, however it is different
>>>>>>>>>>>>>>>>>> since it
>>>>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my
>>>>>>>>>>>>>>>>>> code, since:
>>>>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with
>>>>>>>>>>>>>>>>>> R-2.6.0 till
>>>>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code
>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in
>>>>>>>>>>>>>>>>> your
>>>>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>>>>> far
>>>>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd guess
>>>>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>>>>> where
>>>>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an
>>>>>>>>>>>>>>>>> example
>>>>>>>>>>>>>>>>> illustrating the problem that doesn't involve your
>>>>>>>>>>>>>>>>> code, and
>>>>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped
>>>>>>>>>>>>>>>>>>>> me to
>>>>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can
>>>>>>>>>>>>>>>>>>>> use the
>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong.
>>>>>>>>>>>>>>>>>>> If I
>>>>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> I will see the value of x getting printed, even
>>>>>>>>>>>>>>>>>>> though it
>>>>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code
>>>>>>>>>>>>>>>>>>> you're
>>>>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk
>>>>>>>>>>>>>>>>>>>> 5 needs
>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then everything
>>>>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not
>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also
>>>>>>>>>>>>>>>>>>>> xps.tex
>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does not
>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I
>>>>>>>>>>>>>>>>>>>> have to
>>>>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the
>>>>>>>>>>>>>>>>>>>> usual case?
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating
>>>>>>>>>>>>>>>>>>>>>>>> pdf-files
>>>>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific
>>>>>>>>>>>>>>>>>>>>>>>> problem
>>>>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I
>>>>>>>>>>>>>>>>>>>>>> will, since
>>>>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same
>>>>>>>>>>>>>>>>>>>>>> machine
>>>>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD
>>>>>>>>>>>>>>>>>>>>>>> build is
>>>>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but
>>>>>>>>>>>>>>>>>>>>>>>> now I get:
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0 (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the command
>>>>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the
>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0
>>>>>>>>>>>>>>>>>>>>>>>> I get:
>>>>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps",
>>>>>>>>>>>>>>>>>>>>>>>>> dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>>>>> Overfull ?vbox (21.68121pt too high) has
>>>>>>>>>>>>>>>>>>>>>>>> occurred while
>>>>>>>>>>>>>>>>>>>>>>>> ?output is
>>>>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>>>>> Error: Could not create
>>>>>>>>>>>>>>>>>>>>>>>> file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which
>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line
>>>>>>>>>>>>>>>>>>>>>>>> defining
>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused
>>>>>>>>>>>>>>>>>>>>>>> later
>>>>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>>>>> is not clear to me since
>>>>>>>>>>>>>>>>>>>>>>>> "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the
>>>>>>>>>>>>>>>>>>>>>>> supplied
>>>>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean.
>>>>>>>>>>>>>>>>>>>>>> root.scheme does
>>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and
>>>>>>>>>>>>>>>>>>>>> you tell
>>>>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by
>>>>>>>>>>>>>>>>>>>>> root.scheme
>>>>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work
>>>>>>>>>>>>>>>>>>>>>>>> for the
>>>>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor
>>>>>>>>>>>>>>>>>>>>>>>> servers are
>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine
>>>>>>>>>>>>>>>>>>>>>>> with it. So
>>>>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted,
>>>>>>>>>>>>>>>>>>>>>> but on
>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted,
>>>>>>>>>>>>>>>>>>>>>> but
>>>>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no
>>>>>>>>>>>>>>>>>>>>>>>>>> longer
>>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following
>>>>>>>>>>>>>>>>>>>>>>>>>> output:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes?
>>>>>>>>>>>>>>>>>>>>>>>>> Have
>>>>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the file
>>>>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated
>>>>>>>>>>>>>>>>>>>>>>>>> to the
>>>>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64
>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets
>>>>>>>>>>>>>>>>>>>>>>>>>> methods
>>>>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>> IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>>
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From cstrato at aon.at  Sun May  8 22:19:51 2011
From: cstrato at aon.at (cstrato)
Date: Sun, 08 May 2011 22:19:51 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC6EF10.3040308@fhcrc.org>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>	<4DBF04E4.8020806@aon.at>	<4DBFE206.3030708@statistik.tu-dortmund.de>	<4DC05427.7060908@aon.at>	<4DC061D1.3080105@statistik.tu-dortmund.de>	<4DC06A03.2010205@aon.at>	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>	<4DC0708C.2060708@aon.at>	<CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>
	<4DC1B0BD.6030509@aon.at> <4DC6EF10.3040308@fhcrc.org>
Message-ID: <4DC6FAE7.6090106@aon.at>

Dear Herve,

In my initial mail:
https://stat.ethz.ch/pipermail/r-devel/2011-April/060688.html
I wrote: "While R CMD check and R CMD INSTALL have always created the 
vignettes on R-2.12.1 or any earlier versions of R, I am no longer able 
to build the vignettes on R-2.13.0."

Although I made the mistake to include R CMD INSTALL, I wanted simply to 
know why R CMD check suddenly (after all these years) does no longer 
build the pdf-versions of the vignettes.

After many replies and discussions Prof. Ripley gave finally the answer:
https://stat.ethz.ch/pipermail/r-devel/2011-May/060782.html

I understand the reason for this and made the suggestion to include an 
option such as "--no-clean-vignettes" to R CMD check, since this would 
be a convenient option for me:
https://stat.ethz.ch/pipermail/r-devel/2011-May/060797.html

Best regards
Christian


On 5/8/11 9:29 PM, Herv? Pag?s wrote:
> Hi Christian,
>
> On 11-05-04 01:02 PM, cstrato wrote:
>> Dear Simon,
>>
>> I did not complain about the R doing something wrong. I only wanted to
>> know why, after all these years, R CMD check does suddenly no longer
>> build the pdf-files of the vignettes. I also think that this is a legal
>> question.
>>
>> Let me compare the times spent:
>>
>> 1, the "official" development cycle:
>> - R CMD build: 5 minutes
>> - R CMD INSTALL: 3 minutes
>> - R CMD check: 6 minutes
>>
>> 2, my own development cycle:
>> - manual tarring: 2 seconds
>> - R CMD check: 6 minutes
>>
>> This means spending 14 minutes vs 6 minutes.
>
> My understanding is that R CMD INSTALL is not strictly necessary in
> the official devel cycle. However, to be fair you should either include
> that step in both cycles (devel and yours) or not. Then the numbers are
> 14 minutes vs 9 minutes (or 11 minutes vs 6 minutes).
>
>> If I assume that in one
>> evening I have to make 10 corrections this would mean 140 minutes vs 60
>> minutes, i.e. the official development cycle would take 1 hr and 20 min
>> longer than my own development cycle. This is time I do not have.
>
> No matter how you put it and how much benefits you get from this,
> manual tarring is *wrong* and "after all these years" you should really
> know this. Furthermore, here is what you claimed in a previous email:
>
> This is my development cycle:
>
> First, I run R CMD check until there are no more warnings/errors.
> Since years it was very convenient that R CMD check builds the
> pdf-files of the vignettes, too, since this allowed me to correct
> errors in the manual files and the vignette files at the same time!
>
> Afterwards I run R CMD INSTALL to install my package and do more
> tests until everything works.
>
> As you see I do not use R CMD build, since every run takes about
> 5 minutes, it overwrites my zipped source code, and I would need
> to unzip it to get access to the vignette pdf-files.
>
> You didn't mention the manual tarring.
>
> Then later:
>
> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
> code is not polluted.
>
> So you are contradicting yourself.
>
> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>
> Whaooo, finally! Note that, among other problems, this manual tarring
> is very likely to pollute your source tree (this is one of the things
> R CMD build will take care of).
>
> You are free to do manual tarring for your own internal business if
> you want, nobody cares, but you should keep this kind of dirty little
> secrets for you. For your 10 corrections, you can do manual tarring
> 10 times, that's your problem, but that doesn't prevent you from doing
> the right thing, i.e. R CMD build + R CMD check, as a *final* pass (e.g.
> just before you commit your changes to svn). Now that means 71 minutes
> vs 60 minutes, but you did the *right* thing.
>
> Cheers,
> H.
>
>
>
>>
>> Best regards
>> Christian
>>
>>
>> On 5/4/11 12:13 AM, Simon Urbanek wrote:
>>> On May 3, 2011, at 5:15 PM, cstrato wrote:
>>>
>>>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>>>
>>>
>>> Well, that's your problem then, not R's. Source packages are created
>>> using R CMD build, not by manual tarring (you can do the latter if you
>>> know what you're doing, but then you can't complain about the R doing
>>> something wrong).
>>>
>>> Cheers,
>>> S
>>>
>>>
>>>>
>>>> On 5/3/11 11:11 PM, Simon Urbanek wrote:
>>>>> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at> wrote:
>>>>>
>>>>>> Dear Uwe,
>>>>>>
>>>>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
>>>>>> code is not polluted.
>>>>>>
>>>>>
>>>>> But then you already used build to create the tar ball so the
>>>>> vignette has been built. So what is your point?
>>>>>
>>>>> Cheers,
>>>>> S
>>>>>
>>>>>
>>>>>> Furthermore, I forgot to mention that finally I upload the source
>>>>>> code only to the BioC svn repository. The rest is done by the BioC
>>>>>> servers, including building the pdf-files for the vignettes.
>>>>>>
>>>>>> Best regards
>>>>>> Christian
>>>>>>
>>>>>>
>>>>>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>>>>>
>>>>>>>
>>>>>>> On 03.05.2011 21:14, cstrato wrote:
>>>>>>>> Dear Uwe,
>>>>>>>>
>>>>>>>> This is my development cycle:
>>>>>>>>
>>>>>>>> First, I run R CMD check until there are no more warnings/errors.
>>>>>>>> Since
>>>>>>>> years it was very convenient that R CMD check builds the
>>>>>>>> pdf-files of
>>>>>>>> the vignettes, too, since this allowed me to correct errors in the
>>>>>>>> manual files and the vignette files at the same time!
>>>>>>>>
>>>>>>>> Afterwards I run R CMD INSTALL to install my package and do more
>>>>>>>> tests
>>>>>>>> until everything works.
>>>>>>>>
>>>>>>>> As you see I do not use R CMD build, since every run takes about 5
>>>>>>>> minutes, it overwrites my zipped source code, and I would need to
>>>>>>>> unzip
>>>>>>>> it to get access to the vignette pdf-files.
>>>>>>>
>>>>>>>
>>>>>>> Then this is the main problem here. The *recommended* development
>>>>>>> cycle
>>>>>>> from the manuals is to run
>>>>>>>
>>>>>>> 1. R CMD build in order to get a valid source tarball and clean
>>>>>>> the sources
>>>>>>> 2. R CMD INSTALL to check if your package can be installed
>>>>>>> 3. R CMD check in order to finally check your package
>>>>>>>
>>>>>>> Running R CMD INSTALL on your source directory may pollute it, hence
>>>>>>> this is not recommended at all.
>>>>>>>
>>>>>>>
>>>>>>> Best,
>>>>>>> UWe
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>>
>>>>>>>>
>>>>>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>>>>>> Dear Prof. Ripley,
>>>>>>>>>>
>>>>>>>>>> Thank you for your confirmation and explanation, I understand the
>>>>>>>>>> reason
>>>>>>>>>> for cleaning things up to save memory. However, it was very
>>>>>>>>>> convenient
>>>>>>>>>> to have this feature in earlier versions of R. It would be really
>>>>>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>>>>>> "--no-clean-vignettes".
>>>>>>>>>>
>>>>>>>>>> FYI, I did not claim "..create the vignettes *in<pkg>inst/doc*",
>>>>>>>>>> instead my words were:
>>>>>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2
>>>>>>>>>> contains
>>>>>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck
>>>>>>>>>> from
>>>>>>>>>> R-2.13.0 does not contain "inst".
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> But you do not need it. I do not know how often I have to
>>>>>>>>> mention that
>>>>>>>>> vignettes are produced by R CMD build! They are already build when
>>>>>>>>> running R CMD check. And please do not tell us about tzhe PDF
>>>>>>>>> version
>>>>>>>>> oif manuals which are *unrelated* to vignettes, because they are
>>>>>>>>> not
>>>>>>>>> built in advance and need to be checked, since they should be
>>>>>>>>> produced
>>>>>>>>> at user level while vignettes are built at developer level
>>>>>>>>> already.
>>>>>>>>>
>>>>>>>>> Uwe Ligges
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>>>>>
>>>>>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my
>>>>>>>>>>>>> Mac in a
>>>>>>>>>>>>> virtual machine, I have now done the following tests on all
>>>>>>>>>>>>> three
>>>>>>>>>>>>> architectures:
>>>>>>>>>>>>>
>>>>>>>>>>>>> 1, R CMD build xps:
>>>>>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all
>>>>>>>>>>>>> vignettes as
>>>>>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>>>>>
>>>>>>>>>>>>> 2, R CMD check xps:
>>>>>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no
>>>>>>>>>>>>> longer build
>>>>>>>>>>>>> the
>>>>>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did
>>>>>>>>>>>>> create the
>>>>>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thus the question is:
>>>>>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>>>>>
>>>>>>>>>>>> Probably the answer is simply "because it doesn't". For a truly
>>>>>>>>>>>> reliable check, you should build the package, then check the
>>>>>>>>>>>> tar.gz
>>>>>>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>>>>>>>
>>>>>>>>>>> Actually, it does. What earlier versions never did (despite
>>>>>>>>>>> 'cstrato's
>>>>>>>>>>> repeated delusional claims earlier) was to create the
>>>>>>>>>>> vignettes *in
>>>>>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes
>>>>>>>>>>> in a
>>>>>>>>>>> working directory. The difference is that 2.13.0 deletes that
>>>>>>>>>>> working
>>>>>>>>>>> directory if the test was successful, whereas earlier versions
>>>>>>>>>>> left
>>>>>>>>>>> the
>>>>>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>>>>>> However,
>>>>>>>>>>> earier versions of R CMD check sometimes failed when R CMD build
>>>>>>>>>>> succeeded
>>>>>>>>>>>
>>>>>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>>>>>
>>>>>>>>>>> R 2.12.2 gave
>>>>>>>>>>>
>>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>>>>>
>>>>>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>>>>>
>>>>>>>>>>> R 2.13.0 gives
>>>>>>>>>>>
>>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>> Animal.Rnw
>>>>>>>>>>>
>>>>>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>>>>>> Animal.Rnw
>>>>>>>>>>>
>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>
>>>>>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>>>>>
>>>>>>>>>>> The main reason for cleaning up is that to mimic R CMD build
>>>>>>>>>>> the test
>>>>>>>>>>> has to make a complete copy of the package sources, and that
>>>>>>>>>>> adds up:
>>>>>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>>>>>>> converted to
>>>>>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my
>>>>>>>>>>>>>>> Mac did
>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>> like
>>>>>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any
>>>>>>>>>>>>>>> pdf files
>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Dioes it give an error or warning? It should check the
>>>>>>>>>>>>>> code. R CMD
>>>>>>>>>>>>>> build
>>>>>>>>>>>>>> creates the pdf files.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> My problem seems to be that at the moment the problem
>>>>>>>>>>>>>>>>> can be
>>>>>>>>>>>>>>>>> seen
>>>>>>>>>>>>>>>>> only
>>>>>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no
>>>>>>>>>>>>>>>>> problems
>>>>>>>>>>>>>>>>> creating
>>>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Then you are definitely the one in the best position to
>>>>>>>>>>>>>>>> diagnose
>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting out
>>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>>> that looks unrelated. Verify that the problem still
>>>>>>>>>>>>>>>> exists, then
>>>>>>>>>>>>>>>> cut
>>>>>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>>>>>> particular
>>>>>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>>>>>> statements, or
>>>>>>>>>>>>>>>> use
>>>>>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so
>>>>>>>>>>>>>>>> special
>>>>>>>>>>>>>>>> about your
>>>>>>>>>>>>>>>> system.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>>>>>>> that is
>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> If the assumption is being made by code you wrote, then fix
>>>>>>>>>>>>>>>> it. If
>>>>>>>>>>>>>>>> it's
>>>>>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Thank you for your example, however it is different
>>>>>>>>>>>>>>>>>>> since it
>>>>>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my
>>>>>>>>>>>>>>>>>>> code, since:
>>>>>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with
>>>>>>>>>>>>>>>>>>> R-2.6.0 till
>>>>>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code
>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in
>>>>>>>>>>>>>>>>>> your
>>>>>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>>>>>> far
>>>>>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd
>>>>>>>>>>>>>>>>>> guess
>>>>>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>>>>>> where
>>>>>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an
>>>>>>>>>>>>>>>>>> example
>>>>>>>>>>>>>>>>>> illustrating the problem that doesn't involve your
>>>>>>>>>>>>>>>>>> code, and
>>>>>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped
>>>>>>>>>>>>>>>>>>>>> me to
>>>>>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can
>>>>>>>>>>>>>>>>>>>>> use the
>>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong.
>>>>>>>>>>>>>>>>>>>> If I
>>>>>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> I will see the value of x getting printed, even
>>>>>>>>>>>>>>>>>>>> though it
>>>>>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code
>>>>>>>>>>>>>>>>>>>> you're
>>>>>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk
>>>>>>>>>>>>>>>>>>>>> 5 needs
>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then
>>>>>>>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not
>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ... WARNING
>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also
>>>>>>>>>>>>>>>>>>>>> xps.tex
>>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the subdirectory
>>>>>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does
>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I
>>>>>>>>>>>>>>>>>>>>> have to
>>>>>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the
>>>>>>>>>>>>>>>>>>>>> usual case?
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating
>>>>>>>>>>>>>>>>>>>>>>>>> pdf-files
>>>>>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific
>>>>>>>>>>>>>>>>>>>>>>>>> problem
>>>>>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I
>>>>>>>>>>>>>>>>>>>>>>> will, since
>>>>>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same
>>>>>>>>>>>>>>>>>>>>>>> machine
>>>>>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD
>>>>>>>>>>>>>>>>>>>>>>>> build is
>>>>>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0
>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but
>>>>>>>>>>>>>>>>>>>>>>>>> now I get:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0
>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the vignettes
>>>>>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the
>>>>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the
>>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0
>>>>>>>>>>>>>>>>>>>>>>>>> I get:
>>>>>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps",
>>>>>>>>>>>>>>>>>>>>>>>>>> dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>>>>>> Overfull ?vbox (21.68121pt too high) has
>>>>>>>>>>>>>>>>>>>>>>>>> occurred while
>>>>>>>>>>>>>>>>>>>>>>>>> ?output is
>>>>>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>>>>>> Error: Could not create
>>>>>>>>>>>>>>>>>>>>>>>>> file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which
>>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line
>>>>>>>>>>>>>>>>>>>>>>>>> defining
>>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused
>>>>>>>>>>>>>>>>>>>>>>>> later
>>>>>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>>>>>> is not clear to me since
>>>>>>>>>>>>>>>>>>>>>>>>> "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the
>>>>>>>>>>>>>>>>>>>>>>>> supplied
>>>>>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean.
>>>>>>>>>>>>>>>>>>>>>>> root.scheme does
>>>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and
>>>>>>>>>>>>>>>>>>>>>> you tell
>>>>>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by
>>>>>>>>>>>>>>>>>>>>>> root.scheme
>>>>>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work
>>>>>>>>>>>>>>>>>>>>>>>>> for the
>>>>>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor
>>>>>>>>>>>>>>>>>>>>>>>>> servers are
>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine
>>>>>>>>>>>>>>>>>>>>>>>> with it. So
>>>>>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted,
>>>>>>>>>>>>>>>>>>>>>>> but on
>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted,
>>>>>>>>>>>>>>>>>>>>>>> but
>>>>>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no
>>>>>>>>>>>>>>>>>>>>>>>>>>> longer
>>>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following
>>>>>>>>>>>>>>>>>>>>>>>>>>> output:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in
>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes?
>>>>>>>>>>>>>>>>>>>>>>>>>> Have
>>>>>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the
>>>>>>>>>>>>>>>>>>>>>>>>>>> file
>>>>>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated
>>>>>>>>>>>>>>>>>>>>>>>>>> to the
>>>>>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64
>>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets
>>>>>>>>>>>>>>>>>>>>>>>>>>> methods
>>>>>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>>> IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>>
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From hpages at fhcrc.org  Mon May  9 07:20:04 2011
From: hpages at fhcrc.org (=?windows-1252?Q?Herv=E9_Pag=E8s?=)
Date: Sun, 08 May 2011 22:20:04 -0700
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC6FAE7.6090106@aon.at>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>	<4DBF04E4.8020806@aon.at>	<4DBFE206.3030708@statistik.tu-dortmund.de>	<4DC05427.7060908@aon.at>	<4DC061D1.3080105@statistik.tu-dortmund.de>	<4DC06A03.2010205@aon.at>	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>	<4DC0708C.2060708@aon.at>	<CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>
	<4DC1B0BD.6030509@aon.at> <4DC6EF10.3040308@fhcrc.org>
	<4DC6FAE7.6090106@aon.at>
Message-ID: <4DC77984.6020005@fhcrc.org>

Christian,

On 11-05-08 01:19 PM, cstrato wrote:
> Dear Herve,
>
> In my initial mail:
> https://stat.ethz.ch/pipermail/r-devel/2011-April/060688.html
> I wrote: "While R CMD check and R CMD INSTALL have always created the
> vignettes on R-2.12.1 or any earlier versions of R, I am no longer able
> to build the vignettes on R-2.13.0."
>
> Although I made the mistake to include R CMD INSTALL, I wanted simply to
> know why R CMD check suddenly (after all these years) does no longer
> build the pdf-versions of the vignettes.
>
> After many replies and discussions Prof. Ripley gave finally the answer:
> https://stat.ethz.ch/pipermail/r-devel/2011-May/060782.html
>
> I understand the reason for this and made the suggestion to include an
> option such as "--no-clean-vignettes" to R CMD check, since this would
> be a convenient option for me:
> https://stat.ethz.ch/pipermail/r-devel/2011-May/060797.html

and then someone tried to explain you that you didn't need that,
you just need to use the standard development cycle. And in your
last 5 emails you're still trying to convince the people around
that you have a better/faster development cycle that doesn't use
'R CMD build' at all. No matter this better development cycle is
broken, it should be supported anyway by adding a
"--no-clean-vignettes" option to 'R CMD check' just because
that would be a "convenient option for you"? I know, you are
just suggesting this option, but still...

H.

>
> Best regards
> Christian
>
>
> On 5/8/11 9:29 PM, Herv? Pag?s wrote:
>> Hi Christian,
>>
>> On 11-05-04 01:02 PM, cstrato wrote:
>>> Dear Simon,
>>>
>>> I did not complain about the R doing something wrong. I only wanted to
>>> know why, after all these years, R CMD check does suddenly no longer
>>> build the pdf-files of the vignettes. I also think that this is a legal
>>> question.
>>>
>>> Let me compare the times spent:
>>>
>>> 1, the "official" development cycle:
>>> - R CMD build: 5 minutes
>>> - R CMD INSTALL: 3 minutes
>>> - R CMD check: 6 minutes
>>>
>>> 2, my own development cycle:
>>> - manual tarring: 2 seconds
>>> - R CMD check: 6 minutes
>>>
>>> This means spending 14 minutes vs 6 minutes.
>>
>> My understanding is that R CMD INSTALL is not strictly necessary in
>> the official devel cycle. However, to be fair you should either include
>> that step in both cycles (devel and yours) or not. Then the numbers are
>> 14 minutes vs 9 minutes (or 11 minutes vs 6 minutes).
>>
>>> If I assume that in one
>>> evening I have to make 10 corrections this would mean 140 minutes vs 60
>>> minutes, i.e. the official development cycle would take 1 hr and 20 min
>>> longer than my own development cycle. This is time I do not have.
>>
>> No matter how you put it and how much benefits you get from this,
>> manual tarring is *wrong* and "after all these years" you should really
>> know this. Furthermore, here is what you claimed in a previous email:
>>
>> This is my development cycle:
>>
>> First, I run R CMD check until there are no more warnings/errors.
>> Since years it was very convenient that R CMD check builds the
>> pdf-files of the vignettes, too, since this allowed me to correct
>> errors in the manual files and the vignette files at the same time!
>>
>> Afterwards I run R CMD INSTALL to install my package and do more
>> tests until everything works.
>>
>> As you see I do not use R CMD build, since every run takes about
>> 5 minutes, it overwrites my zipped source code, and I would need
>> to unzip it to get access to the vignette pdf-files.
>>
>> You didn't mention the manual tarring.
>>
>> Then later:
>>
>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
>> code is not polluted.
>>
>> So you are contradicting yourself.
>>
>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>
>> Whaooo, finally! Note that, among other problems, this manual tarring
>> is very likely to pollute your source tree (this is one of the things
>> R CMD build will take care of).
>>
>> You are free to do manual tarring for your own internal business if
>> you want, nobody cares, but you should keep this kind of dirty little
>> secrets for you. For your 10 corrections, you can do manual tarring
>> 10 times, that's your problem, but that doesn't prevent you from doing
>> the right thing, i.e. R CMD build + R CMD check, as a *final* pass (e.g.
>> just before you commit your changes to svn). Now that means 71 minutes
>> vs 60 minutes, but you did the *right* thing.
>>
>> Cheers,
>> H.
>>
>>
>>
>>>
>>> Best regards
>>> Christian
>>>
>>>
>>> On 5/4/11 12:13 AM, Simon Urbanek wrote:
>>>> On May 3, 2011, at 5:15 PM, cstrato wrote:
>>>>
>>>>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>>>>
>>>>
>>>> Well, that's your problem then, not R's. Source packages are created
>>>> using R CMD build, not by manual tarring (you can do the latter if you
>>>> know what you're doing, but then you can't complain about the R doing
>>>> something wrong).
>>>>
>>>> Cheers,
>>>> S
>>>>
>>>>
>>>>>
>>>>> On 5/3/11 11:11 PM, Simon Urbanek wrote:
>>>>>> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at> wrote:
>>>>>>
>>>>>>> Dear Uwe,
>>>>>>>
>>>>>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
>>>>>>> code is not polluted.
>>>>>>>
>>>>>>
>>>>>> But then you already used build to create the tar ball so the
>>>>>> vignette has been built. So what is your point?
>>>>>>
>>>>>> Cheers,
>>>>>> S
>>>>>>
>>>>>>
>>>>>>> Furthermore, I forgot to mention that finally I upload the source
>>>>>>> code only to the BioC svn repository. The rest is done by the BioC
>>>>>>> servers, including building the pdf-files for the vignettes.
>>>>>>>
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>>
>>>>>>>
>>>>>>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>> On 03.05.2011 21:14, cstrato wrote:
>>>>>>>>> Dear Uwe,
>>>>>>>>>
>>>>>>>>> This is my development cycle:
>>>>>>>>>
>>>>>>>>> First, I run R CMD check until there are no more warnings/errors.
>>>>>>>>> Since
>>>>>>>>> years it was very convenient that R CMD check builds the
>>>>>>>>> pdf-files of
>>>>>>>>> the vignettes, too, since this allowed me to correct errors in the
>>>>>>>>> manual files and the vignette files at the same time!
>>>>>>>>>
>>>>>>>>> Afterwards I run R CMD INSTALL to install my package and do more
>>>>>>>>> tests
>>>>>>>>> until everything works.
>>>>>>>>>
>>>>>>>>> As you see I do not use R CMD build, since every run takes about 5
>>>>>>>>> minutes, it overwrites my zipped source code, and I would need to
>>>>>>>>> unzip
>>>>>>>>> it to get access to the vignette pdf-files.
>>>>>>>>
>>>>>>>>
>>>>>>>> Then this is the main problem here. The *recommended* development
>>>>>>>> cycle
>>>>>>>> from the manuals is to run
>>>>>>>>
>>>>>>>> 1. R CMD build in order to get a valid source tarball and clean
>>>>>>>> the sources
>>>>>>>> 2. R CMD INSTALL to check if your package can be installed
>>>>>>>> 3. R CMD check in order to finally check your package
>>>>>>>>
>>>>>>>> Running R CMD INSTALL on your source directory may pollute it,
>>>>>>>> hence
>>>>>>>> this is not recommended at all.
>>>>>>>>
>>>>>>>>
>>>>>>>> Best,
>>>>>>>> UWe
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Best regards
>>>>>>>>> Christian
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>>>>>>> Dear Prof. Ripley,
>>>>>>>>>>>
>>>>>>>>>>> Thank you for your confirmation and explanation, I understand
>>>>>>>>>>> the
>>>>>>>>>>> reason
>>>>>>>>>>> for cleaning things up to save memory. However, it was very
>>>>>>>>>>> convenient
>>>>>>>>>>> to have this feature in earlier versions of R. It would be
>>>>>>>>>>> really
>>>>>>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>>>>>>> "--no-clean-vignettes".
>>>>>>>>>>>
>>>>>>>>>>> FYI, I did not claim "..create the vignettes *in<pkg>inst/doc*",
>>>>>>>>>>> instead my words were:
>>>>>>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2
>>>>>>>>>>> contains
>>>>>>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck
>>>>>>>>>>> from
>>>>>>>>>>> R-2.13.0 does not contain "inst".
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> But you do not need it. I do not know how often I have to
>>>>>>>>>> mention that
>>>>>>>>>> vignettes are produced by R CMD build! They are already build
>>>>>>>>>> when
>>>>>>>>>> running R CMD check. And please do not tell us about tzhe PDF
>>>>>>>>>> version
>>>>>>>>>> oif manuals which are *unrelated* to vignettes, because they are
>>>>>>>>>> not
>>>>>>>>>> built in advance and need to be checked, since they should be
>>>>>>>>>> produced
>>>>>>>>>> at user level while vignettes are built at developer level
>>>>>>>>>> already.
>>>>>>>>>>
>>>>>>>>>> Uwe Ligges
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>> Best regards
>>>>>>>>>>> Christian
>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>>>>>>
>>>>>>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my
>>>>>>>>>>>>>> Mac in a
>>>>>>>>>>>>>> virtual machine, I have now done the following tests on all
>>>>>>>>>>>>>> three
>>>>>>>>>>>>>> architectures:
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> 1, R CMD build xps:
>>>>>>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all
>>>>>>>>>>>>>> vignettes as
>>>>>>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> 2, R CMD check xps:
>>>>>>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no
>>>>>>>>>>>>>> longer build
>>>>>>>>>>>>>> the
>>>>>>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did
>>>>>>>>>>>>>> create the
>>>>>>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Thus the question is:
>>>>>>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>>>>>>
>>>>>>>>>>>>> Probably the answer is simply "because it doesn't". For a
>>>>>>>>>>>>> truly
>>>>>>>>>>>>> reliable check, you should build the package, then check the
>>>>>>>>>>>>> tar.gz
>>>>>>>>>>>>> file. Anything else is, and always has been, an approximation.
>>>>>>>>>>>>
>>>>>>>>>>>> Actually, it does. What earlier versions never did (despite
>>>>>>>>>>>> 'cstrato's
>>>>>>>>>>>> repeated delusional claims earlier) was to create the
>>>>>>>>>>>> vignettes *in
>>>>>>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes
>>>>>>>>>>>> in a
>>>>>>>>>>>> working directory. The difference is that 2.13.0 deletes that
>>>>>>>>>>>> working
>>>>>>>>>>>> directory if the test was successful, whereas earlier versions
>>>>>>>>>>>> left
>>>>>>>>>>>> the
>>>>>>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>>>>>>> However,
>>>>>>>>>>>> earier versions of R CMD check sometimes failed when R CMD
>>>>>>>>>>>> build
>>>>>>>>>>>> succeeded
>>>>>>>>>>>>
>>>>>>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>>>>>>
>>>>>>>>>>>> R 2.12.2 gave
>>>>>>>>>>>>
>>>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>>>>>>
>>>>>>>>>>>> R 2.13.0 gives
>>>>>>>>>>>>
>>>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>> Animal.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>>>>>>> Animal.Rnw
>>>>>>>>>>>>
>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>
>>>>>>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>>>>>>
>>>>>>>>>>>> The main reason for cleaning up is that to mimic R CMD build
>>>>>>>>>>>> the test
>>>>>>>>>>>> has to make a complete copy of the package sources, and that
>>>>>>>>>>>> adds up:
>>>>>>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw can be
>>>>>>>>>>>>>>>> converted to
>>>>>>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my
>>>>>>>>>>>>>>>> Mac did
>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>> like
>>>>>>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any
>>>>>>>>>>>>>>>> pdf files
>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Dioes it give an error or warning? It should check the
>>>>>>>>>>>>>>> code. R CMD
>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>> creates the pdf files.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> My problem seems to be that at the moment the problem
>>>>>>>>>>>>>>>>>> can be
>>>>>>>>>>>>>>>>>> seen
>>>>>>>>>>>>>>>>>> only
>>>>>>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no
>>>>>>>>>>>>>>>>>> problems
>>>>>>>>>>>>>>>>>> creating
>>>>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Then you are definitely the one in the best position to
>>>>>>>>>>>>>>>>> diagnose
>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting
>>>>>>>>>>>>>>>>> out
>>>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>>>> that looks unrelated. Verify that the problem still
>>>>>>>>>>>>>>>>> exists, then
>>>>>>>>>>>>>>>>> cut
>>>>>>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>>>>>>> particular
>>>>>>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>>>>>>> statements, or
>>>>>>>>>>>>>>>>> use
>>>>>>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so
>>>>>>>>>>>>>>>>> special
>>>>>>>>>>>>>>>>> about your
>>>>>>>>>>>>>>>>> system.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> I suspect it will turn out to be an assumption in the code
>>>>>>>>>>>>>>>>> that is
>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> If the assumption is being made by code you wrote, then
>>>>>>>>>>>>>>>>> fix
>>>>>>>>>>>>>>>>> it. If
>>>>>>>>>>>>>>>>> it's
>>>>>>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Thank you for your example, however it is different
>>>>>>>>>>>>>>>>>>>> since it
>>>>>>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my
>>>>>>>>>>>>>>>>>>>> code, since:
>>>>>>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with
>>>>>>>>>>>>>>>>>>>> R-2.6.0 till
>>>>>>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code
>>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in
>>>>>>>>>>>>>>>>>>> your
>>>>>>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>>>>>>> far
>>>>>>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd
>>>>>>>>>>>>>>>>>>> guess
>>>>>>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>>>>>>> where
>>>>>>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an
>>>>>>>>>>>>>>>>>>> example
>>>>>>>>>>>>>>>>>>> illustrating the problem that doesn't involve your
>>>>>>>>>>>>>>>>>>> code, and
>>>>>>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped
>>>>>>>>>>>>>>>>>>>>>> me to
>>>>>>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can
>>>>>>>>>>>>>>>>>>>>>> use the
>>>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong.
>>>>>>>>>>>>>>>>>>>>> If I
>>>>>>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> I will see the value of x getting printed, even
>>>>>>>>>>>>>>>>>>>>> though it
>>>>>>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code
>>>>>>>>>>>>>>>>>>>>> you're
>>>>>>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk
>>>>>>>>>>>>>>>>>>>>>> 5 needs
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then
>>>>>>>>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not
>>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the vignettes,
>>>>>>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF: ........
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are added:
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc" will be
>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also
>>>>>>>>>>>>>>>>>>>>>> xps.tex
>>>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the
>>>>>>>>>>>>>>>>>>>>>> subdirectory
>>>>>>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does
>>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I
>>>>>>>>>>>>>>>>>>>>>> have to
>>>>>>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the
>>>>>>>>>>>>>>>>>>>>>> usual case?
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating
>>>>>>>>>>>>>>>>>>>>>>>>>> pdf-files
>>>>>>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific
>>>>>>>>>>>>>>>>>>>>>>>>>> problem
>>>>>>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I
>>>>>>>>>>>>>>>>>>>>>>>> will, since
>>>>>>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then
>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same
>>>>>>>>>>>>>>>>>>>>>>>> machine
>>>>>>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>> ........
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD
>>>>>>>>>>>>>>>>>>>>>>>>> build is
>>>>>>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0
>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but
>>>>>>>>>>>>>>>>>>>>>>>>>> now I get:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0
>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the
>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the
>>>>>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the
>>>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0
>>>>>>>>>>>>>>>>>>>>>>>>>> I get:
>>>>>>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps",
>>>>>>>>>>>>>>>>>>>>>>>>>>> dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>>>>>>> Overfull ?vbox (21.68121pt too high) has
>>>>>>>>>>>>>>>>>>>>>>>>>> occurred while
>>>>>>>>>>>>>>>>>>>>>>>>>> ?output is
>>>>>>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>>>>>>> Error: Could not create
>>>>>>>>>>>>>>>>>>>>>>>>>> file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which
>>>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line
>>>>>>>>>>>>>>>>>>>>>>>>>> defining
>>>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused
>>>>>>>>>>>>>>>>>>>>>>>>> later
>>>>>>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>>>>>>> is not clear to me since
>>>>>>>>>>>>>>>>>>>>>>>>>> "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the
>>>>>>>>>>>>>>>>>>>>>>>>> supplied
>>>>>>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean.
>>>>>>>>>>>>>>>>>>>>>>>> root.scheme does
>>>>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and
>>>>>>>>>>>>>>>>>>>>>>> you tell
>>>>>>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by
>>>>>>>>>>>>>>>>>>>>>>> root.scheme
>>>>>>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work
>>>>>>>>>>>>>>>>>>>>>>>>>> for the
>>>>>>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor
>>>>>>>>>>>>>>>>>>>>>>>>>> servers are
>>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine
>>>>>>>>>>>>>>>>>>>>>>>>> with it. So
>>>>>>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted,
>>>>>>>>>>>>>>>>>>>>>>>> but on
>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted,
>>>>>>>>>>>>>>>>>>>>>>>> but
>>>>>>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have always
>>>>>>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no
>>>>>>>>>>>>>>>>>>>>>>>>>>>> longer
>>>>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following
>>>>>>>>>>>>>>>>>>>>>>>>>>>> output:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in
>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes?
>>>>>>>>>>>>>>>>>>>>>>>>>>> Have
>>>>>>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the
>>>>>>>>>>>>>>>>>>>>>>>>>>>> file
>>>>>>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated
>>>>>>>>>>>>>>>>>>>>>>>>>>> to the
>>>>>>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64
>>>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets
>>>>>>>>>>>>>>>>>>>>>>>>>>>> methods
>>>>>>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>> IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From vioravis at gmail.com  Mon May  9 10:49:36 2011
From: vioravis at gmail.com (vioravis)
Date: Mon, 9 May 2011 01:49:36 -0700 (PDT)
Subject: [Rd] Fortran Symbol Name not in Load Table
Message-ID: <1304930976028-3508719.post@n4.nabble.com>

I am trying to call a FORTRAN subroutine from R. is.loaded is turning out to
be TRUE. However when I run my .Fortran command I get the following error:

Error in .Fortran("VALUEAHROPTIMIZE", as.double(ahrArray),
as.double(kwArray),  : 
  Fortran symbol name "valueahroptimize" not in load table


I have given the FORTRAN declaration below:

subroutine VALUEAHROPTIMIZE(AHR,    &
        KW,    &
        min_IHR_delta,  &
        max_AHR_error,  &
        AHR_out,   & !! Output AHE array
        IHR_out,   & !! Output IHR array
        Errors_out)
  ! Expose subroutine my_function to users of this DLL
  !DEC$ ATTRIBUTES
DLLEXPORT,C,REFERENCE,ALIAS:'VALUEAHROPTIMIZE_'::VALUEAHROPTIMIZE
 
  ! Body of my_function
 
  Implicit None
 
  Integer *4  IERR, iSum
  DOUBLE PRECISION min_IHR_delta, max_AHR_error
  logical switch_AHR_tuner
  character * 512 AHR_tuner_FilePath
 
  !!DOUBLE PRECISION  AHR(500), kW(500)  !! Initial Array for reading
Namelist
  
  DOUBLE PRECISION  AHR(*), kW(*)  !! Initial Array for reading Namelist
  DOUBLE PRECISION  AHR_out(*), IHR_out(*)
  integer Errors_out(*)


The R code I tried using is given below:

ahrArray <- runif(147)
kwArray <- runif(147)
outputAHR <- c(rep(0,11*11))
outputIHR <- c(rep(0,11*11))
outputError <- c(rep(NA,11))

dyn.load("my_function.dll")
is.loaded("VALUEAHROPTIMIZE")

[1] TRUE

> .Fortran("VALUEAHROPTIMIZE",
          as.double(ahrArray),
          as.double(kwArray),
          as.double(0.0005),
          as.double(50000),
          as.double(outputAHR),
          as.double(outputIHR),
          as.integer(outputError))

Can someone please help me with how to fix this issue? Thank you.

Ravi

--
View this message in context: http://r.789695.n4.nabble.com/Fortran-Symbol-Name-not-in-Load-Table-tp3508719p3508719.html
Sent from the R devel mailing list archive at Nabble.com.


From vioravis at gmail.com  Mon May  9 12:07:14 2011
From: vioravis at gmail.com (vioravis)
Date: Mon, 9 May 2011 03:07:14 -0700 (PDT)
Subject: [Rd] Fortran Symbol Name not in Load Table
In-Reply-To: <1304930976028-3508719.post@n4.nabble.com>
References: <1304930976028-3508719.post@n4.nabble.com>
Message-ID: <1304935634803-3508852.post@n4.nabble.com>

Just realized that there are two functions in the same DLL. The other
function is working fine.

--
View this message in context: http://r.789695.n4.nabble.com/Fortran-Symbol-Name-not-in-Load-Table-tp3508719p3508852.html
Sent from the R devel mailing list archive at Nabble.com.


From pgilbert at bank-banque-canada.ca  Mon May  9 16:26:26 2011
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 9 May 2011 14:26:26 +0000
Subject: [Rd] fortan common block
In-Reply-To: <BANLkTi=9TBmpxT-UL-FGCsejnEZ0-X3c8A@mail.gmail.com>
References: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
	<BANLkTi=9TBmpxT-UL-FGCsejnEZ0-X3c8A@mail.gmail.com>
Message-ID: <6441154A9FF1CD4386AF4ABF141A056D215A0FF9@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>

Thanks to everyone that replied to this (some offline). I should have been a bit clearer about my question. I did realize that it does work sometimes. My worry is whether it can be expected to work reliably. In this respect, I am aware of three specific reasons for concern: i/ if common data is swapped out does it get swapped back in ok (e.g. the data segment does not get compressed because it should be all zero or NA);  ii/ would R release memory (garbage collect) between different calls to the fortran; and iii/ does another R process using the same package get its own copy of the dll/.so data segment.

I have been relatively well convinced about the first two i/ swap treats this as user data and preserves it (though some OSes might prevent writing to the code segment); and ii/ R does not garbage collect the dll/.so so the data segment is safely (or otherwise) under fortran's control.

I am less certain about the third. This seems to depend on sharing the data segment of the shared object within a process but not sharing it between processes. That is, each process has its own data block even though different processes might or might not share the code block. Googling turned up discussions about using common blocks for inter-process communications, but I did not find the conclusion. It seems pretty clear that for the common block to be reliable in the sense I have in mind, inter-process communication would be prevented.

I am a bit concerned that the answer may be compiler and/or OS dependent.  This is well outside of my expertise, so assurances would be greatly appreciated.

Paul

> -----Original Message-----
> From: b.rowlingson at googlemail.com [mailto:b.rowlingson at googlemail.com]
> On Behalf Of Barry Rowlingson
> Sent: May 8, 2011 3:44 AM
> To: Paul Gilbert
> Cc: r-devel at r-project. org
> Subject: Re: [Rd] fortan common block
> 
> On Fri, May 6, 2011 at 4:04 PM, Paul Gilbert
> <pgilbert at bank-banque-canada.ca> wrote:
> > Is it possible in R to call a fortran routine that sets variables in
> a common block and expect the values to persist when a call is made
> from R to a second routine that uses the common block?
> >
> > If not (as I suspect), ?is it possible to use a common block in a
> group of routines that are used together, for as long the routines do
> not return to R?
> 
> Simple test seems to confirm it. Here's some 'tran with a setter and a
> getter:
> 
> comchk.f:
> 
>       subroutine bar(n)
>       common /c/ i
>       i=n
>       end
> 
>       subroutine geti(j)
>       common /c/ i
>       j = i
>       end
> 
> R CMD SHLIB comchk.f
>  > dyn.load("comchk.so")
> 
>  > .Fortran("bar",as.integer(9))
>  [[1]]
>  [1] 9
> 
>  > .Fortran("geti",as.integer(-1))
>  [[1]]
>  [1] 9
> 
> Barry
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential in...{{dropped:26}}


From simon.urbanek at r-project.org  Mon May  9 17:48:13 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 9 May 2011 11:48:13 -0400
Subject: [Rd] fortan common block
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D215A0FF9@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
References: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
	<BANLkTi=9TBmpxT-UL-FGCsejnEZ0-X3c8A@mail.gmail.com>
	<6441154A9FF1CD4386AF4ABF141A056D215A0FF9@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <5A2FB630-196E-45D9-B0B2-CAC75B03340D@r-project.org>

AFAIK it's all much simpler that you think. Technically common blocks are just FORTRAN's slightly complicated way to declare and access global variables. They have nothing to do with IPC - each process is loading SOs in its own virtual memory, so other processes are irrelevant (the actual implementation is usually COW which has the same effect but is more memory-efficient -- but this doesn't change the semantics). The confusion may come from the fact that in Fortran literature "shared" has a different meaning (shared between modules of the same program = process) than in IPC (shared across processes).

Cheers,
Simon


On May 9, 2011, at 10:26 AM, Paul Gilbert wrote:

> Thanks to everyone that replied to this (some offline). I should have been a bit clearer about my question. I did realize that it does work sometimes. My worry is whether it can be expected to work reliably. In this respect, I am aware of three specific reasons for concern: i/ if common data is swapped out does it get swapped back in ok (e.g. the data segment does not get compressed because it should be all zero or NA);  ii/ would R release memory (garbage collect) between different calls to the fortran; and iii/ does another R process using the same package get its own copy of the dll/.so data segment.
> 
> I have been relatively well convinced about the first two i/ swap treats this as user data and preserves it (though some OSes might prevent writing to the code segment); and ii/ R does not garbage collect the dll/.so so the data segment is safely (or otherwise) under fortran's control.
> 
> I am less certain about the third. This seems to depend on sharing the data segment of the shared object within a process but not sharing it between processes. That is, each process has its own data block even though different processes might or might not share the code block. Googling turned up discussions about using common blocks for inter-process communications, but I did not find the conclusion. It seems pretty clear that for the common block to be reliable in the sense I have in mind, inter-process communication would be prevented.
> 
> I am a bit concerned that the answer may be compiler and/or OS dependent.  This is well outside of my expertise, so assurances would be greatly appreciated.
> 
> Paul
> 
>> -----Original Message-----
>> From: b.rowlingson at googlemail.com [mailto:b.rowlingson at googlemail.com]
>> On Behalf Of Barry Rowlingson
>> Sent: May 8, 2011 3:44 AM
>> To: Paul Gilbert
>> Cc: r-devel at r-project. org
>> Subject: Re: [Rd] fortan common block
>> 
>> On Fri, May 6, 2011 at 4:04 PM, Paul Gilbert
>> <pgilbert at bank-banque-canada.ca> wrote:
>>> Is it possible in R to call a fortran routine that sets variables in
>> a common block and expect the values to persist when a call is made
>> from R to a second routine that uses the common block?
>>> 
>>> If not (as I suspect),  is it possible to use a common block in a
>> group of routines that are used together, for as long the routines do
>> not return to R?
>> 
>> Simple test seems to confirm it. Here's some 'tran with a setter and a
>> getter:
>> 
>> comchk.f:
>> 
>>      subroutine bar(n)
>>      common /c/ i
>>      i=n
>>      end
>> 
>>      subroutine geti(j)
>>      common /c/ i
>>      j = i
>>      end
>> 
>> R CMD SHLIB comchk.f
>>> dyn.load("comchk.so")
>> 
>>> .Fortran("bar",as.integer(9))
>> [[1]]
>> [1] 9
>> 
>>> .Fortran("geti",as.integer(-1))
>> [[1]]
>> [1] 9
>> 
>> Barry
> ====================================================================================
> 
> La version fran?aise suit le texte anglais.
> 
> ------------------------------------------------------------------------------------
> 
> This email may contain privileged and/or confidential in...{{dropped:26}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From cstrato at aon.at  Mon May  9 20:40:50 2011
From: cstrato at aon.at (cstrato)
Date: Mon, 09 May 2011 20:40:50 +0200
Subject: [Rd] How to create vignette.pdf for R-2.13.0?
In-Reply-To: <4DC77984.6020005@fhcrc.org>
References: <4DB32D9F.5010406@aon.at>	<4DB42FB3.9090401@statistik.tu-dortmund.de>	<4DB472F8.9060903@aon.at>	<4DB489EC.9080301@statistik.tu-dortmund.de>	<4DB491BE.8080104@aon.at>	<4DB57E7A.1080507@statistik.tu-dortmund.de>	<4DB5AFD4.9020303@aon.at>
	<4DB5B6B0.90607@gmail.com>	<4DB5C286.40306@aon.at>
	<4DB5C38D.6030400@gmail.com>	<4DB5C87C.5040905@aon.at>
	<4DB5CBFD.6050508@gmail.com>	<4DB723F9.7090800@aon.at>	<4DB7D0DD.6040201@statistik.tu-dortmund.de>	<4DBDBE4F.8020702@aon.at>
	<4DBDEA8F.60000@gmail.com>	<alpine.LFD.2.02.1105020549360.441@gannet.stats.ox.ac.uk>	<4DBF04E4.8020806@aon.at>	<4DBFE206.3030708@statistik.tu-dortmund.de>	<4DC05427.7060908@aon.at>	<4DC061D1.3080105@statistik.tu-dortmund.de>	<4DC06A03.2010205@aon.at>	<602EC185-8BED-4EF4-B2AF-2EDF29B6EE84@r-project.org>	<4DC0708C.2060708@aon.at>	<CB833A13-DB66-45F1-B45C-D79AAC819B17@r-project.org>
	<4DC1B0BD.6030509@aon.at> <4DC6EF10.3040308@fhcrc.org>
	<4DC6FAE7.6090106@aon.at> <4DC77984.6020005@fhcrc.org>
Message-ID: <4DC83532.2040109@aon.at>

Dear Herve,

Since 'R CMD check' has already options '--no-vignettes' and 
'--no-rebuild-vignettes', so why not option '--no-clean-vignettes'?
But, as you admitted, it is only a suggestion.

Maybe it is time to close this thread.
(If you want we can discuss this issue further privately.)

Best regards
Christian


On 5/9/11 7:20 AM, Herv? Pag?s wrote:
> Christian,
>
> On 11-05-08 01:19 PM, cstrato wrote:
>> Dear Herve,
>>
>> In my initial mail:
>> https://stat.ethz.ch/pipermail/r-devel/2011-April/060688.html
>> I wrote: "While R CMD check and R CMD INSTALL have always created the
>> vignettes on R-2.12.1 or any earlier versions of R, I am no longer able
>> to build the vignettes on R-2.13.0."
>>
>> Although I made the mistake to include R CMD INSTALL, I wanted simply to
>> know why R CMD check suddenly (after all these years) does no longer
>> build the pdf-versions of the vignettes.
>>
>> After many replies and discussions Prof. Ripley gave finally the answer:
>> https://stat.ethz.ch/pipermail/r-devel/2011-May/060782.html
>>
>> I understand the reason for this and made the suggestion to include an
>> option such as "--no-clean-vignettes" to R CMD check, since this would
>> be a convenient option for me:
>> https://stat.ethz.ch/pipermail/r-devel/2011-May/060797.html
>
> and then someone tried to explain you that you didn't need that,
> you just need to use the standard development cycle. And in your
> last 5 emails you're still trying to convince the people around
> that you have a better/faster development cycle that doesn't use
> 'R CMD build' at all. No matter this better development cycle is
> broken, it should be supported anyway by adding a
> "--no-clean-vignettes" option to 'R CMD check' just because
> that would be a "convenient option for you"? I know, you are
> just suggesting this option, but still...
>
> H.
>
>>
>> Best regards
>> Christian
>>
>>
>> On 5/8/11 9:29 PM, Herv? Pag?s wrote:
>>> Hi Christian,
>>>
>>> On 11-05-04 01:02 PM, cstrato wrote:
>>>> Dear Simon,
>>>>
>>>> I did not complain about the R doing something wrong. I only wanted to
>>>> know why, after all these years, R CMD check does suddenly no longer
>>>> build the pdf-files of the vignettes. I also think that this is a legal
>>>> question.
>>>>
>>>> Let me compare the times spent:
>>>>
>>>> 1, the "official" development cycle:
>>>> - R CMD build: 5 minutes
>>>> - R CMD INSTALL: 3 minutes
>>>> - R CMD check: 6 minutes
>>>>
>>>> 2, my own development cycle:
>>>> - manual tarring: 2 seconds
>>>> - R CMD check: 6 minutes
>>>>
>>>> This means spending 14 minutes vs 6 minutes.
>>>
>>> My understanding is that R CMD INSTALL is not strictly necessary in
>>> the official devel cycle. However, to be fair you should either include
>>> that step in both cycles (devel and yours) or not. Then the numbers are
>>> 14 minutes vs 9 minutes (or 11 minutes vs 6 minutes).
>>>
>>>> If I assume that in one
>>>> evening I have to make 10 corrections this would mean 140 minutes vs 60
>>>> minutes, i.e. the official development cycle would take 1 hr and 20 min
>>>> longer than my own development cycle. This is time I do not have.
>>>
>>> No matter how you put it and how much benefits you get from this,
>>> manual tarring is *wrong* and "after all these years" you should really
>>> know this. Furthermore, here is what you claimed in a previous email:
>>>
>>> This is my development cycle:
>>>
>>> First, I run R CMD check until there are no more warnings/errors.
>>> Since years it was very convenient that R CMD check builds the
>>> pdf-files of the vignettes, too, since this allowed me to correct
>>> errors in the manual files and the vignette files at the same time!
>>>
>>> Afterwards I run R CMD INSTALL to install my package and do more
>>> tests until everything works.
>>>
>>> As you see I do not use R CMD build, since every run takes about
>>> 5 minutes, it overwrites my zipped source code, and I would need
>>> to unzip it to get access to the vignette pdf-files.
>>>
>>> You didn't mention the manual tarring.
>>>
>>> Then later:
>>>
>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
>>> code is not polluted.
>>>
>>> So you are contradicting yourself.
>>>
>>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>>
>>> Whaooo, finally! Note that, among other problems, this manual tarring
>>> is very likely to pollute your source tree (this is one of the things
>>> R CMD build will take care of).
>>>
>>> You are free to do manual tarring for your own internal business if
>>> you want, nobody cares, but you should keep this kind of dirty little
>>> secrets for you. For your 10 corrections, you can do manual tarring
>>> 10 times, that's your problem, but that doesn't prevent you from doing
>>> the right thing, i.e. R CMD build + R CMD check, as a *final* pass (e.g.
>>> just before you commit your changes to svn). Now that means 71 minutes
>>> vs 60 minutes, but you did the *right* thing.
>>>
>>> Cheers,
>>> H.
>>>
>>>
>>>
>>>>
>>>> Best regards
>>>> Christian
>>>>
>>>>
>>>> On 5/4/11 12:13 AM, Simon Urbanek wrote:
>>>>> On May 3, 2011, at 5:15 PM, cstrato wrote:
>>>>>
>>>>>> No, I simply do "tar czf xps_1.13.1.tar.gz xps".
>>>>>>
>>>>>
>>>>> Well, that's your problem then, not R's. Source packages are created
>>>>> using R CMD build, not by manual tarring (you can do the latter if you
>>>>> know what you're doing, but then you can't complain about the R doing
>>>>> something wrong).
>>>>>
>>>>> Cheers,
>>>>> S
>>>>>
>>>>>
>>>>>>
>>>>>> On 5/3/11 11:11 PM, Simon Urbanek wrote:
>>>>>>> On May 3, 2011, at 4:48 PM, cstrato<cstrato at aon.at> wrote:
>>>>>>>
>>>>>>>> Dear Uwe,
>>>>>>>>
>>>>>>>> Thank you, however since I use "R CMD INSTALL xps.tar.gz" my source
>>>>>>>> code is not polluted.
>>>>>>>>
>>>>>>>
>>>>>>> But then you already used build to create the tar ball so the
>>>>>>> vignette has been built. So what is your point?
>>>>>>>
>>>>>>> Cheers,
>>>>>>> S
>>>>>>>
>>>>>>>
>>>>>>>> Furthermore, I forgot to mention that finally I upload the source
>>>>>>>> code only to the BioC svn repository. The rest is done by the BioC
>>>>>>>> servers, including building the pdf-files for the vignettes.
>>>>>>>>
>>>>>>>> Best regards
>>>>>>>> Christian
>>>>>>>>
>>>>>>>>
>>>>>>>> On 5/3/11 10:13 PM, Uwe Ligges wrote:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 03.05.2011 21:14, cstrato wrote:
>>>>>>>>>> Dear Uwe,
>>>>>>>>>>
>>>>>>>>>> This is my development cycle:
>>>>>>>>>>
>>>>>>>>>> First, I run R CMD check until there are no more warnings/errors.
>>>>>>>>>> Since
>>>>>>>>>> years it was very convenient that R CMD check builds the
>>>>>>>>>> pdf-files of
>>>>>>>>>> the vignettes, too, since this allowed me to correct errors in
>>>>>>>>>> the
>>>>>>>>>> manual files and the vignette files at the same time!
>>>>>>>>>>
>>>>>>>>>> Afterwards I run R CMD INSTALL to install my package and do more
>>>>>>>>>> tests
>>>>>>>>>> until everything works.
>>>>>>>>>>
>>>>>>>>>> As you see I do not use R CMD build, since every run takes
>>>>>>>>>> about 5
>>>>>>>>>> minutes, it overwrites my zipped source code, and I would need to
>>>>>>>>>> unzip
>>>>>>>>>> it to get access to the vignette pdf-files.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Then this is the main problem here. The *recommended* development
>>>>>>>>> cycle
>>>>>>>>> from the manuals is to run
>>>>>>>>>
>>>>>>>>> 1. R CMD build in order to get a valid source tarball and clean
>>>>>>>>> the sources
>>>>>>>>> 2. R CMD INSTALL to check if your package can be installed
>>>>>>>>> 3. R CMD check in order to finally check your package
>>>>>>>>>
>>>>>>>>> Running R CMD INSTALL on your source directory may pollute it,
>>>>>>>>> hence
>>>>>>>>> this is not recommended at all.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Best,
>>>>>>>>> UWe
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Best regards
>>>>>>>>>> Christian
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 5/3/11 1:07 PM, Uwe Ligges wrote:
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 02.05.2011 21:24, cstrato wrote:
>>>>>>>>>>>> Dear Prof. Ripley,
>>>>>>>>>>>>
>>>>>>>>>>>> Thank you for your confirmation and explanation, I understand
>>>>>>>>>>>> the
>>>>>>>>>>>> reason
>>>>>>>>>>>> for cleaning things up to save memory. However, it was very
>>>>>>>>>>>> convenient
>>>>>>>>>>>> to have this feature in earlier versions of R. It would be
>>>>>>>>>>>> really
>>>>>>>>>>>> helpful to have an additional option to R CMD check, e.g.
>>>>>>>>>>>> "--no-clean-vignettes".
>>>>>>>>>>>>
>>>>>>>>>>>> FYI, I did not claim "..create the vignettes
>>>>>>>>>>>> *in<pkg>inst/doc*",
>>>>>>>>>>>> instead my words were:
>>>>>>>>>>>> One interesting observation is that xps.Rcheck from R-2.12.2
>>>>>>>>>>>> contains
>>>>>>>>>>>> the subdirectory "inst/doc" with the vignettes while xps.Rcheck
>>>>>>>>>>>> from
>>>>>>>>>>>> R-2.13.0 does not contain "inst".
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> But you do not need it. I do not know how often I have to
>>>>>>>>>>> mention that
>>>>>>>>>>> vignettes are produced by R CMD build! They are already build
>>>>>>>>>>> when
>>>>>>>>>>> running R CMD check. And please do not tell us about tzhe PDF
>>>>>>>>>>> version
>>>>>>>>>>> oif manuals which are *unrelated* to vignettes, because they are
>>>>>>>>>>> not
>>>>>>>>>>> built in advance and need to be checked, since they should be
>>>>>>>>>>> produced
>>>>>>>>>>> at user level while vignettes are built at developer level
>>>>>>>>>>> already.
>>>>>>>>>>>
>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>> Best regards
>>>>>>>>>>>> Christian
>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 5/2/11 7:08 AM, Prof Brian Ripley wrote:
>>>>>>>>>>>>> On Sun, 1 May 2011, Duncan Murdoch wrote:
>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 11-05-01 4:10 PM, cstrato wrote:
>>>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Since I have installed both WinXP and OpenSUSE 11.3 on my
>>>>>>>>>>>>>>> Mac in a
>>>>>>>>>>>>>>> virtual machine, I have now done the following tests on all
>>>>>>>>>>>>>>> three
>>>>>>>>>>>>>>> architectures:
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> 1, R CMD build xps:
>>>>>>>>>>>>>>> This creates "xps_1.13.1.tar.gz" which DOES contain all
>>>>>>>>>>>>>>> vignettes as
>>>>>>>>>>>>>>> pdf-file. Thus R CMD build is ok.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> 2, R CMD check xps:
>>>>>>>>>>>>>>> This does NOT build the vignettes as pdf-files on all three
>>>>>>>>>>>>>>> architectures. Or to be more precise, R-2.13.0 does no
>>>>>>>>>>>>>>> longer build
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> vignettes since with R-2.12.2 and earlier versions R did
>>>>>>>>>>>>>>> create the
>>>>>>>>>>>>>>> vignettes as pdf-files.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thus the question is:
>>>>>>>>>>>>>>> Why does R CMD check no longer create the vignettes?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Probably the answer is simply "because it doesn't". For a
>>>>>>>>>>>>>> truly
>>>>>>>>>>>>>> reliable check, you should build the package, then check the
>>>>>>>>>>>>>> tar.gz
>>>>>>>>>>>>>> file. Anything else is, and always has been, an
>>>>>>>>>>>>>> approximation.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Actually, it does. What earlier versions never did (despite
>>>>>>>>>>>>> 'cstrato's
>>>>>>>>>>>>> repeated delusional claims earlier) was to create the
>>>>>>>>>>>>> vignettes *in
>>>>>>>>>>>>> <pkg>inst/doc*. All of them re-created (by default) vignettes
>>>>>>>>>>>>> in a
>>>>>>>>>>>>> working directory. The difference is that 2.13.0 deletes that
>>>>>>>>>>>>> working
>>>>>>>>>>>>> directory if the test was successful, whereas earlier versions
>>>>>>>>>>>>> left
>>>>>>>>>>>>> the
>>>>>>>>>>>>> results somewhere in<pkg>.Rcheck (the 'somewhere' has varied).
>>>>>>>>>>>>> However,
>>>>>>>>>>>>> earier versions of R CMD check sometimes failed when R CMD
>>>>>>>>>>>>> build
>>>>>>>>>>>>> succeeded
>>>>>>>>>>>>>
>>>>>>>>>>>>> Using Animal (a small CRAN package with one vignette).
>>>>>>>>>>>>>
>>>>>>>>>>>>> R 2.12.2 gave
>>>>>>>>>>>>>
>>>>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>> /tmp/Animal/inst/doc/Animal.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>> and the vignette was re-created in Animal.Rcheck/inst/doc.
>>>>>>>>>>>>>
>>>>>>>>>>>>> R 2.13.0 gives
>>>>>>>>>>>>>
>>>>>>>>>>>>> * checking package vignettes in ?inst/doc? ... WARNING
>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>> Animal.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>> Non-ASCII package vignette(s) without specified encoding:
>>>>>>>>>>>>> Animal.Rnw
>>>>>>>>>>>>>
>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>
>>>>>>>>>>>>> and the working directory was Animal.Rcheck/vign_test .
>>>>>>>>>>>>>
>>>>>>>>>>>>> The main reason for cleaning up is that to mimic R CMD build
>>>>>>>>>>>>> the test
>>>>>>>>>>>>> has to make a complete copy of the package sources, and that
>>>>>>>>>>>>> adds up:
>>>>>>>>>>>>> checking CRAN already takes 17GB for each flavour.
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 4/27/11 10:16 AM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> On 26.04.2011 21:58, cstrato wrote:
>>>>>>>>>>>>>>>>> Dear Duncan, dear Uwe,
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Just now I have re-run everything, and today xps.Rnw
>>>>>>>>>>>>>>>>> can be
>>>>>>>>>>>>>>>>> converted to
>>>>>>>>>>>>>>>>> a vignette w/o any problems using:
>>>>>>>>>>>>>>>>> a, buildVignettes("xps", dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>> b, R CMD Sweave xps.Rnw
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> In both cases the vignette xps.pdf is created (maybe my
>>>>>>>>>>>>>>>>> Mac did
>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>> like
>>>>>>>>>>>>>>>>> to work during eastern holidays).
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> However, one issue remains:
>>>>>>>>>>>>>>>>> "R64 CMD check xps_1.13.1.tar.gz" no longer creates any
>>>>>>>>>>>>>>>>> pdf files
>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Dioes it give an error or warning? It should check the
>>>>>>>>>>>>>>>> code. R CMD
>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>> creates the pdf files.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>> On 4/25/11 9:31 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>> On 25/04/2011 3:16 PM, cstrato wrote:
>>>>>>>>>>>>>>>>>>> Thank you.
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> My problem seems to be that at the moment the problem
>>>>>>>>>>>>>>>>>>> can be
>>>>>>>>>>>>>>>>>>> seen
>>>>>>>>>>>>>>>>>>> only
>>>>>>>>>>>>>>>>>>> on my Mac, since e.g. the Bioconductor servers have no
>>>>>>>>>>>>>>>>>>> problems
>>>>>>>>>>>>>>>>>>> creating
>>>>>>>>>>>>>>>>>>> the vignettes.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Then you are definitely the one in the best position to
>>>>>>>>>>>>>>>>>> diagnose
>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>> problem. Use the usual approach: simplify it by cutting
>>>>>>>>>>>>>>>>>> out
>>>>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>>>>> that looks unrelated. Verify that the problem still
>>>>>>>>>>>>>>>>>> exists, then
>>>>>>>>>>>>>>>>>> cut
>>>>>>>>>>>>>>>>>> some more. Eventually you'll have isolated the error to a
>>>>>>>>>>>>>>>>>> particular
>>>>>>>>>>>>>>>>>> small snippet of code, and then you can add print()
>>>>>>>>>>>>>>>>>> statements, or
>>>>>>>>>>>>>>>>>> use
>>>>>>>>>>>>>>>>>> trace(), or do whatever is necessary to see what's so
>>>>>>>>>>>>>>>>>> special
>>>>>>>>>>>>>>>>>> about your
>>>>>>>>>>>>>>>>>> system.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> I suspect it will turn out to be an assumption in the
>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>> that is
>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>> true on your system.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> If the assumption is being made by code you wrote, then
>>>>>>>>>>>>>>>>>> fix
>>>>>>>>>>>>>>>>>> it. If
>>>>>>>>>>>>>>>>>> it's
>>>>>>>>>>>>>>>>>> being made by R, let us know.
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>> On 4/25/11 8:55 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>>>> Dear Duncan,
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Thank you for your example, however it is different
>>>>>>>>>>>>>>>>>>>>> since it
>>>>>>>>>>>>>>>>>>>>> does not
>>>>>>>>>>>>>>>>>>>>> use x and y. What about print(x+y)?
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Try it.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Sorry, I do not believe that there is a bug in my
>>>>>>>>>>>>>>>>>>>>> code, since:
>>>>>>>>>>>>>>>>>>>>> 1, it worked in all versions from R starting with
>>>>>>>>>>>>>>>>>>>>> R-2.6.0 till
>>>>>>>>>>>>>>>>>>>>> R-2.12.2.
>>>>>>>>>>>>>>>>>>>>> 2, the identical code works in the examples
>>>>>>>>>>>>>>>>>>>>> 3, this code (or a similar code) is the starting code
>>>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>>>> all
>>>>>>>>>>>>>>>>>>>>> users
>>>>>>>>>>>>>>>>>>>>> of xps have to use, and there was never a problem.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> This might be a problem in R, or might be a problem in
>>>>>>>>>>>>>>>>>>>> your
>>>>>>>>>>>>>>>>>>>> code. As
>>>>>>>>>>>>>>>>>>>> far
>>>>>>>>>>>>>>>>>>>> as I know, it has only shown up in your code, so I'd
>>>>>>>>>>>>>>>>>>>> guess
>>>>>>>>>>>>>>>>>>>> that's
>>>>>>>>>>>>>>>>>>>> where
>>>>>>>>>>>>>>>>>>>> the problem is. In any case, you're the one in the best
>>>>>>>>>>>>>>>>>>>> position to
>>>>>>>>>>>>>>>>>>>> isolate it and debug it.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> If it turns out to be a problem in R, put together an
>>>>>>>>>>>>>>>>>>>> example
>>>>>>>>>>>>>>>>>>>> illustrating the problem that doesn't involve your
>>>>>>>>>>>>>>>>>>>> code, and
>>>>>>>>>>>>>>>>>>>> I'll
>>>>>>>>>>>>>>>>>>>> take a
>>>>>>>>>>>>>>>>>>>> look.
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Maybe the reason could be that my code has to import
>>>>>>>>>>>>>>>>>>>>> - the CEL-files from the package dir
>>>>>>>>>>>>>>>>>>>>> - the file SchemeTest3.root from the package dir
>>>>>>>>>>>>>>>>>>>>> ??
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>> On 4/25/11 8:00 PM, Duncan Murdoch wrote:
>>>>>>>>>>>>>>>>>>>>>> cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Your suggestion to look at the Sweave manual helped
>>>>>>>>>>>>>>>>>>>>>>> me to
>>>>>>>>>>>>>>>>>>>>>>> solve the
>>>>>>>>>>>>>>>>>>>>>>> problem. It seems that in R-2.13.0 every chunk can
>>>>>>>>>>>>>>>>>>>>>>> use the
>>>>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>>>> the chunk before but not from an earlier chunk.
>>>>>>>>>>>>>>>>>>>>>> I'm either misreading what you wrote, or it's wrong.
>>>>>>>>>>>>>>>>>>>>>> If I
>>>>>>>>>>>>>>>>>>>>>> have
>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>> in a
>>>>>>>>>>>>>>>>>>>>>> Sweave file:
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>>>> x<- 1
>>>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>>>> y<- 2
>>>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> <<>>=
>>>>>>>>>>>>>>>>>>>>>> print(x)
>>>>>>>>>>>>>>>>>>>>>> @
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> I will see the value of x getting printed, even
>>>>>>>>>>>>>>>>>>>>>> though it
>>>>>>>>>>>>>>>>>>>>>> came
>>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>> chunks earlier.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> I think Uwe is right: there is some bug in the code
>>>>>>>>>>>>>>>>>>>>>> you're
>>>>>>>>>>>>>>>>>>>>>> running.
>>>>>>>>>>>>>>>>>>>>>> Sweave isn't the problem.
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Concretely, the following does not work since chunk
>>>>>>>>>>>>>>>>>>>>>>> 5 needs
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> code
>>>>>>>>>>>>>>>>>>>>>>> from chunk 3 and 4:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 3:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 126 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> However, when I add "celdir" to chunk 5 then
>>>>>>>>>>>>>>>>>>>>>>> everything
>>>>>>>>>>>>>>>>>>>>>>> works
>>>>>>>>>>>>>>>>>>>>>>> since
>>>>>>>>>>>>>>>>>>>>>>> now chunk 5 needs only the code from chunk 4 but not
>>>>>>>>>>>>>>>>>>>>>>> from
>>>>>>>>>>>>>>>>>>>>>>> chunk 3:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>> celdir<- file.path(.path.package("xps"), "raw")
>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Now buildVignettes() is able to create the
>>>>>>>>>>>>>>>>>>>>>>> vignettes,
>>>>>>>>>>>>>>>>>>>>>>> however
>>>>>>>>>>>>>>>>>>>>>>> R CMD
>>>>>>>>>>>>>>>>>>>>>>> check still does not build the vignettes.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Yes, I get a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>> ........
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> However, with R-2.12.2 the following lines are
>>>>>>>>>>>>>>>>>>>>>>> added:
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> and in xps.Rcheck the subdirectory "inst/doc"
>>>>>>>>>>>>>>>>>>>>>>> will be
>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>> which
>>>>>>>>>>>>>>>>>>>>>>> contains the vignette data such as xps.Rnw, but also
>>>>>>>>>>>>>>>>>>>>>>> xps.tex
>>>>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>>>>> xps.pdf.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> In contrast, R-2.13.0 does not create the
>>>>>>>>>>>>>>>>>>>>>>> subdirectory
>>>>>>>>>>>>>>>>>>>>>>> "inst/doc"
>>>>>>>>>>>>>>>>>>>>>>> and
>>>>>>>>>>>>>>>>>>>>>>> no vignettes are built.
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> One more issue:
>>>>>>>>>>>>>>>>>>>>>>> In contrast to my former believe R CMD INSTALL does
>>>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>> vignettes, neither in R-2.12.2 nor in R-2.13.0. I
>>>>>>>>>>>>>>>>>>>>>>> have to
>>>>>>>>>>>>>>>>>>>>>>> run
>>>>>>>>>>>>>>>>>>>>>>> buildVignettes() after installation. Is this the
>>>>>>>>>>>>>>>>>>>>>>> usual case?
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>> On 4/25/11 4:00 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 23:10, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 10:37 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>> On 24.04.2011 20:59, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>>> Dear Uwe,
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Thank you for your reply.
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ad 2, Yes, i know that "xps-manual.pdf" is the
>>>>>>>>>>>>>>>>>>>>>>>>>>> collection of
>>>>>>>>>>>>>>>>>>>>>>>>>>> help
>>>>>>>>>>>>>>>>>>>>>>>>>>> pages,
>>>>>>>>>>>>>>>>>>>>>>>>>>> I have mentioned it only to show that creating
>>>>>>>>>>>>>>>>>>>>>>>>>>> pdf-files
>>>>>>>>>>>>>>>>>>>>>>>>>>> does
>>>>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>>>>> for
>>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ad 1, Could it be that this is a Mac-specific
>>>>>>>>>>>>>>>>>>>>>>>>>>> problem
>>>>>>>>>>>>>>>>>>>>>>>>>>> since I
>>>>>>>>>>>>>>>>>>>>>>>>>>> see
>>>>>>>>>>>>>>>>>>>>>>>>>>> it on
>>>>>>>>>>>>>>>>>>>>>>>>>>> both my old MacBook Pro and my new Mac Mini.
>>>>>>>>>>>>>>>>>>>>>>>>>> Have you tried on any other OS? I did not since
>>>>>>>>>>>>>>>>>>>>>>>>>> installing
>>>>>>>>>>>>>>>>>>>>>>>>>> root is
>>>>>>>>>>>>>>>>>>>>>>>>>> a bit
>>>>>>>>>>>>>>>>>>>>>>>>>> too much effort.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> No, until now I did not try another OS, but I
>>>>>>>>>>>>>>>>>>>>>>>>> will, since
>>>>>>>>>>>>>>>>>>>>>>>>> xps
>>>>>>>>>>>>>>>>>>>>>>>>> has to
>>>>>>>>>>>>>>>>>>>>>>>>> work on all three OSes.
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Using R CMD check with R-2.12.2 I get:
>>>>>>>>>>>>>>>>>>>>>>>>>> I thought we are talking about R-2.13.0?
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> I showed you the output of R-2.12.2 first and then
>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>> output of
>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0, so that you can see that on the same
>>>>>>>>>>>>>>>>>>>>>>>>> machine
>>>>>>>>>>>>>>>>>>>>>>>>> with
>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>> same
>>>>>>>>>>>>>>>>>>>>>>>>> file it works with one version but not the other.
>>>>>>>>>>>>>>>>>>>>>>>> But you got a Warning in both cases:
>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>> ........
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Where is the R CMD build output (since R CMD
>>>>>>>>>>>>>>>>>>>>>>>>>> build is
>>>>>>>>>>>>>>>>>>>>>>>>>> supposed to
>>>>>>>>>>>>>>>>>>>>>>>>>> prepare the vignette).
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.12.2 (2011-02-25)
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0
>>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignettes without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> /Volumes/CoreData/CRAN/xps.Rcheck/00_pkg_src/xps/inst/doc/xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Using "RSwitch.app" I switch to R-2.13.0, but
>>>>>>>>>>>>>>>>>>>>>>>>>>> now I get:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> $ R64 CMD check xps_1.13.1.tar.gz
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using log directory
>>>>>>>>>>>>>>>>>>>>>>>>>>> '/Volumes/CoreData/CRAN/xps.Rcheck'
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using platform: x86_64-apple-darwin9.8.0
>>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>>> * using session charset: ASCII
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for file 'xps/DESCRIPTION' ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * this is package 'xps' version '1.13.1'
>>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> I must admit that I have never built the
>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>>> manually,
>>>>>>>>>>>>>>>>>>>>>>>>>>> and I
>>>>>>>>>>>>>>>>>>>>>>>>>>> cannot find a hint how I can do it from the
>>>>>>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>>>>>>> line. Is
>>>>>>>>>>>>>>>>>>>>>>>>>>> this
>>>>>>>>>>>>>>>>>>>>>>>>>>> possible?
>>>>>>>>>>>>>>>>>>>>>>>>> Is it possible to build the vignettes from the
>>>>>>>>>>>>>>>>>>>>>>>>> command
>>>>>>>>>>>>>>>>>>>>>>>>> line?
>>>>>>>>>>>>>>>>>>>>>>>> R --help suggests there is
>>>>>>>>>>>>>>>>>>>>>>>> R CMD Sweave .....
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> However, building the vignettes within R-2.13.0
>>>>>>>>>>>>>>>>>>>>>>>>>>> I get:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> library(tools)
>>>>>>>>>>>>>>>>>>>>>>>>>>>> buildVignettes("xps",
>>>>>>>>>>>>>>>>>>>>>>>>>>>> dir="/Volumes/CoreData/CRAN/xps",
>>>>>>>>>>>>>>>>>>>>>>>>>>>> quiet=F)
>>>>>>>>>>>>>>>>>>>>>>>>>>> Overfull ?vbox (21.68121pt too high) has
>>>>>>>>>>>>>>>>>>>>>>>>>>> occurred while
>>>>>>>>>>>>>>>>>>>>>>>>>>> ?output is
>>>>>>>>>>>>>>>>>>>>>>>>>>> Writing to file xps.tex
>>>>>>>>>>>>>>>>>>>>>>>>>>> Processing code chunks with options ...
>>>>>>>>>>>>>>>>>>>>>>>>>>> 1 : term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>>> 2 : echo term hide
>>>>>>>>>>>>>>>>>>>>>>>>>>> 3 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>>> 4 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>>> 5 : echo term verbatim
>>>>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>>>>> not be opened (No such file or directory)
>>>>>>>>>>>>>>>>>>>>>>>>>>> Error: Could not create
>>>>>>>>>>>>>>>>>>>>>>>>>>> file</tmpdt_DataTest3_cel.root>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Here are the two important chunks 4 and 5, which
>>>>>>>>>>>>>>>>>>>>>>>>>>> work
>>>>>>>>>>>>>>>>>>>>>>>>>>> fine with
>>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.2
>>>>>>>>>>>>>>>>>>>>>>>>>>> and earlier versions:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 4:
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> #line 132 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> However, in R-2.13.0 chunk 5 crashes!!!
>>>>>>>>>>>>>>>>>>>>>>>>>>> It works only when replacing chunk 5 with:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 5:
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> #line 137 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>>> celfiles<- c("TestA1.CEL","TestA2.CEL")
>>>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- import.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>>>> "tmpdt_DataTest3",
>>>>>>>>>>>>>>>>>>>>>>>>>>> celdir=celdir, celfiles=celfiles, verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> As you see R-2.13.0 does no longer remember the
>>>>>>>>>>>>>>>>>>>>>>>>>>> result of
>>>>>>>>>>>>>>>>>>>>>>>>>>> chunk 4,
>>>>>>>>>>>>>>>>>>>>>>>>>>> i.e.
>>>>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3". Now I have to include the line
>>>>>>>>>>>>>>>>>>>>>>>>>>> defining
>>>>>>>>>>>>>>>>>>>>>>>>>>> "scheme.test3"
>>>>>>>>>>>>>>>>>>>>>>>>>>> also in chunk 5.
>>>>>>>>>>>>>>>>>>>>>>>>>> How objects generated in one chunk can be reused
>>>>>>>>>>>>>>>>>>>>>>>>>> later
>>>>>>>>>>>>>>>>>>>>>>>>>> on is
>>>>>>>>>>>>>>>>>>>>>>>>>> explained
>>>>>>>>>>>>>>>>>>>>>>>>>> in the Sweave manual.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Do you have any idea for this behavior?
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> An example, which does work in R-2.13.0 are the
>>>>>>>>>>>>>>>>>>>>>>>>>>> following
>>>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>>>> chunks:
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> #################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 20:
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> #line 300 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>>> library(xps)
>>>>>>>>>>>>>>>>>>>>>>>>>>> scheme.test3<-
>>>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme(file.path(.path.package("xps"),
>>>>>>>>>>>>>>>>>>>>>>>>>>> "schemes",
>>>>>>>>>>>>>>>>>>>>>>>>>>> "SchemeTest3.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>>> data.test3<- root.data(scheme.test3,
>>>>>>>>>>>>>>>>>>>>>>>>>>> file.path(.path.package("xps"),"rootdata",
>>>>>>>>>>>>>>>>>>>>>>>>>>> "DataTest3_cel.root"))
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> ### chunk number 21:
>>>>>>>>>>>>>>>>>>>>>>>>>>> ###################################################
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> #line 318 "xps.Rnw"
>>>>>>>>>>>>>>>>>>>>>>>>>>> data.rma<- rma(data.test3, "tmpdt_Test3RMA",
>>>>>>>>>>>>>>>>>>>>>>>>>>> verbose=FALSE)
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> In summary it is not quite clear to me what has
>>>>>>>>>>>>>>>>>>>>>>>>>>> changed in
>>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.13.0 so
>>>>>>>>>>>>>>>>>>>>>>>>>>> that chunk 5 no longer works.
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> BTW, the error:
>>>>>>>>>>>>>>>>>>>>>>>>>>> SysError in<TFile::TFile>: file
>>>>>>>>>>>>>>>>>>>>>>>>>>> /tmpdt_DataTest3_cel.root/tmpdt_DataTest3_cel_20110424_201301.root
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> can
>>>>>>>>>>>>>>>>>>>>>>>>>>> not be opened
>>>>>>>>>>>>>>>>>>>>>>>>>>> is not clear to me since
>>>>>>>>>>>>>>>>>>>>>>>>>>> "/tmpdt_DataTest3_cel.root/" is
>>>>>>>>>>>>>>>>>>>>>>>>>>> definitively
>>>>>>>>>>>>>>>>>>>>>>>>>>> NOT a directory.
>>>>>>>>>>>>>>>>>>>>>>>>>> Time to debug what root.scheme is doing with the
>>>>>>>>>>>>>>>>>>>>>>>>>> supplied
>>>>>>>>>>>>>>>>>>>>>>>>>> path.
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Sorry, I do not understand what you mean.
>>>>>>>>>>>>>>>>>>>>>>>>> root.scheme does
>>>>>>>>>>>>>>>>>>>>>>>>> not
>>>>>>>>>>>>>>>>>>>>>>>>> change
>>>>>>>>>>>>>>>>>>>>>>>>> the path, otherwise it would not work on all older
>>>>>>>>>>>>>>>>>>>>>>>>> versions
>>>>>>>>>>>>>>>>>>>>>>>>> of R.
>>>>>>>>>>>>>>>>>>>>>>>> Right, but since something changed obviously, and
>>>>>>>>>>>>>>>>>>>>>>>> you tell
>>>>>>>>>>>>>>>>>>>>>>>> us the
>>>>>>>>>>>>>>>>>>>>>>>> path
>>>>>>>>>>>>>>>>>>>>>>>> is not a path, it might be a function used by
>>>>>>>>>>>>>>>>>>>>>>>> root.scheme
>>>>>>>>>>>>>>>>>>>>>>>> ....
>>>>>>>>>>>>>>>>>>>>>>>> That's
>>>>>>>>>>>>>>>>>>>>>>>> why I said time to debug the code in your vignette!
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Do you have any ideas?
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Please note that the vignette "xps.Rnw" did work
>>>>>>>>>>>>>>>>>>>>>>>>>>> for the
>>>>>>>>>>>>>>>>>>>>>>>>>>> last
>>>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>>>> years
>>>>>>>>>>>>>>>>>>>>>>>>>>> w/o problem. Furthermore, the Bioconductor
>>>>>>>>>>>>>>>>>>>>>>>>>>> servers are
>>>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>> vignette, see:
>>>>>>>>>>>>>>>>>>>>>>>>>>> http://www.bioconductor.org/packages/release/bioc/html/xps.html
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> See
>>>>>>>>>>>>>>>>>>>>>>>>>> http://bioconductor.org/checkResults/2.8/bioc-20110225/xps/liverpool-checksrc.html
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> and find that their Mac Servers are also fine
>>>>>>>>>>>>>>>>>>>>>>>>>> with it. So
>>>>>>>>>>>>>>>>>>>>>>>>>> maybe
>>>>>>>>>>>>>>>>>>>>>>>>>> it is
>>>>>>>>>>>>>>>>>>>>>>>>>> your setup that is corrupted?
>>>>>>>>>>>>>>>>>>>>>>>>> Maybe, you are right that my setup is corrupted,
>>>>>>>>>>>>>>>>>>>>>>>>> but on
>>>>>>>>>>>>>>>>>>>>>>>>> two
>>>>>>>>>>>>>>>>>>>>>>>>> independent
>>>>>>>>>>>>>>>>>>>>>>>>> machines?
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Maybe the download of "R-2.13.0.pkg" is corrupted,
>>>>>>>>>>>>>>>>>>>>>>>>> but
>>>>>>>>>>>>>>>>>>>>>>>>> then
>>>>>>>>>>>>>>>>>>>>>>>>> nothing
>>>>>>>>>>>>>>>>>>>>>>>>> should work, or am I wrong?
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> How can I check if my setup is corrupted?
>>>>>>>>>>>>>>>>>>>>>>>> By debugging the code in your package's vignette.
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>> Best wishes,
>>>>>>>>>>>>>>>>>>>>>>>>>> Uwe
>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>> On 4/24/11 4:12 PM, Uwe Ligges wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>>>> On 23.04.2011 21:50, cstrato wrote:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Dear all,
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> While R CMD check and R CMD INSTALL have
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> always
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> created
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> R-2.12.1 or any earlier versions of R, I am no
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> longer
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> able to
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes on R-2.13.0.
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Instead R CMD check gives me the following
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> output:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking for unstated dependencies in
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking package vignettes in 'inst/doc' ...
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> WARNING
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Package vignette(s) without corresponding PDF:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> APTvsXPS.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> xps.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsClasses.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> xpsPreprocess.Rnw
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking running R code from vignettes
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking re-building of vignettes ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> * checking PDF version of manual ... OK
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Does someone know what the reason might be?
>>>>>>>>>>>>>>>>>>>>>>>>>>>> No, it does for me for other packages.
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Perhaps an error when processing the vignettes?
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Have
>>>>>>>>>>>>>>>>>>>>>>>>>>>> you
>>>>>>>>>>>>>>>>>>>>>>>>>>>> tried to
>>>>>>>>>>>>>>>>>>>>>>>>>>>> build
>>>>>>>>>>>>>>>>>>>>>>>>>>>> them manually?
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> (R64 CMD check --help says that be default
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> rebuild-vignettes is
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> turned
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> on.)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Interestingly, R CMD check still creates the
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> file
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> "xps-manual.pdf".
>>>>>>>>>>>>>>>>>>>>>>>>>>>> That is the collection of help pages, unrelated
>>>>>>>>>>>>>>>>>>>>>>>>>>>> to the
>>>>>>>>>>>>>>>>>>>>>>>>>>>> vignette.
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>> Uwe Ligges
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Here is my sessionInfo:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> R version 2.13.0 (2011-04-13)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Platform: x86_64-apple-darwin9.8.0/x86_64
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> (64-bit)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> locale:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] C
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> attached base packages:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] stats graphics grDevices utils datasets
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> methods
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> base
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> other attached packages:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] xps_1.13.1
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [1] Biobase_2.12.1 Biostrings_2.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> IRanges_1.10.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [4] affy_1.30.0 affyPLM_1.28.5 affyio_1.20.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [7] preprocessCore_1.14.0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Thank you in advance.
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Best regards
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Christian
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> C.h.r.i.s.t.i.a.n S.t.r.a.t.o.w.a
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> V.i.e.n.n.a A.u.s.t.r.i.a
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> e.m.a.i.l: cstrato at aon.at
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>
>


From ligges at statistik.tu-dortmund.de  Mon May  9 22:45:06 2011
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 09 May 2011 22:45:06 +0200
Subject: [Rd] winbuilder temporary down
Message-ID: <4DC85252.7020603@statistik.tu-dortmund.de>

Due to a failure of our air condition, winbuilder is out of service for 
at least 12 hours until 10:30 am CEST tomorrow morning.

Best,
Uwe Ligges


From pgilbert at bank-banque-canada.ca  Mon May  9 23:08:12 2011
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 9 May 2011 21:08:12 +0000
Subject: [Rd] fortan common block
In-Reply-To: <5A2FB630-196E-45D9-B0B2-CAC75B03340D@r-project.org>
References: <6441154A9FF1CD4386AF4ABF141A056D2159FADE@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
	<BANLkTi=9TBmpxT-UL-FGCsejnEZ0-X3c8A@mail.gmail.com>
	<6441154A9FF1CD4386AF4ABF141A056D215A0FF9@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
	<5A2FB630-196E-45D9-B0B2-CAC75B03340D@r-project.org>
Message-ID: <6441154A9FF1CD4386AF4ABF141A056D215A12C4@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>

Simon

Thanks. It is not the first time things are simpler than I think. On the other hand, there have also been a number of occasions when they are not as simple as I think.

Paul

> -----Original Message-----
> From: Simon Urbanek [mailto:simon.urbanek at r-project.org]
> Sent: May 9, 2011 11:48 AM
> To: Paul Gilbert
> Cc: r-devel at r-project. org
> Subject: Re: [Rd] fortan common block
> 
> AFAIK it's all much simpler that you think. Technically common blocks
> are just FORTRAN's slightly complicated way to declare and access
> global variables. They have nothing to do with IPC - each process is
> loading SOs in its own virtual memory, so other processes are
> irrelevant (the actual implementation is usually COW which has the same
> effect but is more memory-efficient -- but this doesn't change the
> semantics). The confusion may come from the fact that in Fortran
> literature "shared" has a different meaning (shared between modules of
> the same program = process) than in IPC (shared across processes).
> 
> Cheers,
> Simon
> 
> 
> On May 9, 2011, at 10:26 AM, Paul Gilbert wrote:
> 
> > Thanks to everyone that replied to this (some offline). I should have
> been a bit clearer about my question. I did realize that it does work
> sometimes. My worry is whether it can be expected to work reliably. In
> this respect, I am aware of three specific reasons for concern: i/ if
> common data is swapped out does it get swapped back in ok (e.g. the
> data segment does not get compressed because it should be all zero or
> NA);  ii/ would R release memory (garbage collect) between different
> calls to the fortran; and iii/ does another R process using the same
> package get its own copy of the dll/.so data segment.
> >
> > I have been relatively well convinced about the first two i/ swap
> treats this as user data and preserves it (though some OSes might
> prevent writing to the code segment); and ii/ R does not garbage
> collect the dll/.so so the data segment is safely (or otherwise) under
> fortran's control.
> >
> > I am less certain about the third. This seems to depend on sharing
> the data segment of the shared object within a process but not sharing
> it between processes. That is, each process has its own data block even
> though different processes might or might not share the code block.
> Googling turned up discussions about using common blocks for inter-
> process communications, but I did not find the conclusion. It seems
> pretty clear that for the common block to be reliable in the sense I
> have in mind, inter-process communication would be prevented.
> >
> > I am a bit concerned that the answer may be compiler and/or OS
> dependent.  This is well outside of my expertise, so assurances would
> be greatly appreciated.
> >
> > Paul
> >
> >> -----Original Message-----
> >> From: b.rowlingson at googlemail.com
> [mailto:b.rowlingson at googlemail.com]
> >> On Behalf Of Barry Rowlingson
> >> Sent: May 8, 2011 3:44 AM
> >> To: Paul Gilbert
> >> Cc: r-devel at r-project. org
> >> Subject: Re: [Rd] fortan common block
> >>
> >> On Fri, May 6, 2011 at 4:04 PM, Paul Gilbert
> >> <pgilbert at bank-banque-canada.ca> wrote:
> >>> Is it possible in R to call a fortran routine that sets variables
> in
> >> a common block and expect the values to persist when a call is made
> >> from R to a second routine that uses the common block?
> >>>
> >>> If not (as I suspect),  is it possible to use a common block in a
> >> group of routines that are used together, for as long the routines
> do
> >> not return to R?
> >>
> >> Simple test seems to confirm it. Here's some 'tran with a setter and
> a
> >> getter:
> >>
> >> comchk.f:
> >>
> >>      subroutine bar(n)
> >>      common /c/ i
> >>      i=n
> >>      end
> >>
> >>      subroutine geti(j)
> >>      common /c/ i
> >>      j = i
> >>      end
> >>
> >> R CMD SHLIB comchk.f
> >>> dyn.load("comchk.so")
> >>
> >>> .Fortran("bar",as.integer(9))
> >> [[1]]
> >> [1] 9
> >>
> >>> .Fortran("geti",as.integer(-1))
> >> [[1]]
> >> [1] 9
> >>
> >> Barry
> >
> =======================================================================
> =============
> >
> > La version fran?aise suit le texte anglais.
> >
> > ---------------------------------------------------------------------
> ---------------
> >
> > This email may contain privileged and/or confidential
> in...{{dropped:26}}
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >

====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential in...{{dropped:26}}


From jmc at r-project.org  Tue May 10 01:15:02 2011
From: jmc at r-project.org (John Chambers)
Date: Mon, 09 May 2011 16:15:02 -0700
Subject: [Rd] Examples for performance studies
Message-ID: <4DC87576.1030404@r-project.org>

A number of activities are underway related to understanding R 
performance in practice and to exploring techniques for improving 
performance generally or in important special cases.  I'm writing 
directly on behalf of an informal group centered in the Computer Science 
department here at Stanford, but also on behalf of similar activities 
elsewhere.

We would all be helped by realistic examples of serious computations 
with R, where substantial computing is required and the results are 
important to users.  The more and the more representative the data 
available, the more likely that useful performance tools can be designed.

If you can provide us with examples that we can use and share, please 
send a description to:
   Justin Talbot <jtalbot at stanford.edu>

As examples accumulate, the plan is to make them available to the 
community---details to be worked out.

Thanks in advance,
   John Chambers


From vioravis at gmail.com  Tue May 10 03:28:37 2011
From: vioravis at gmail.com (vioravis)
Date: Mon, 9 May 2011 18:28:37 -0700 (PDT)
Subject: [Rd] Fortran Symbol Name not in Load Table
In-Reply-To: <1304935634803-3508852.post@n4.nabble.com>
References: <1304930976028-3508719.post@n4.nabble.com>
	<1304935634803-3508852.post@n4.nabble.com>
Message-ID: <1304990917157-3510758.post@n4.nabble.com>

I used the DLL export viewer to what is the table name being exported. It is
showing as VALUEAHROPTIMIZE_. This is the name of the function we have used
plus the underscore.

Is there any other reason for the function not getting recognized??? Thanks.

--
View this message in context: http://r.789695.n4.nabble.com/Fortran-Symbol-Name-not-in-Load-Table-tp3508719p3510758.html
Sent from the R devel mailing list archive at Nabble.com.


From chuck at sharpsteen.net  Tue May 10 06:26:00 2011
From: chuck at sharpsteen.net (Sharpie)
Date: Mon, 9 May 2011 21:26:00 -0700 (PDT)
Subject: [Rd] matrix multiplication speed R
In-Reply-To: <1304955156757-3509596.post@n4.nabble.com>
References: <1294992591724-3217257.post@n4.nabble.com>
	<AANLkTinaCO61x_fWzqFFawWrnBN+LZ_APLpsaBZYAw-j@mail.gmail.com>
	<4D302DCF.1020003@statistik.tu-dortmund.de>
	<1295007321497-3217539.post@n4.nabble.com>
	<1304955156757-3509596.post@n4.nabble.com>
Message-ID: <1305001560672-3510979.post@n4.nabble.com>


aftar wrote:
> 
> Hi
> 
> Can we use BLAS in R X64 for windows?
> 
> Regards
> Aftar
> 

You are already using BLAS in R as R includes its own BLAS library. On
Windows the 64-bit DLL is located at R_HOME\bin\x64\Rblas.dll.

If you are asking about swapping that out for an optimized BLAS, you will
probably have to:

  1. Obtain and build an optimized BLAS such as ATLAS, Goto BLAS or Intel
MKL

  2. Build your own copy of R from source that links against this new blas.

If there is a simpler way, I'm sure someone will correct me.


-----
Charlie Sharpsteen
Undergraduate-- Environmental Resources Engineering
Humboldt State University
--
View this message in context: http://r.789695.n4.nabble.com/matrix-multiplication-speed-R-tp3217257p3510979.html
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Tue May 10 08:07:46 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 10 May 2011 07:07:46 +0100 (BST)
Subject: [Rd] matrix multiplication speed R
In-Reply-To: <1305001560672-3510979.post@n4.nabble.com>
References: <1294992591724-3217257.post@n4.nabble.com>
	<AANLkTinaCO61x_fWzqFFawWrnBN+LZ_APLpsaBZYAw-j@mail.gmail.com>
	<4D302DCF.1020003@statistik.tu-dortmund.de>
	<1295007321497-3217539.post@n4.nabble.com>
	<1304955156757-3509596.post@n4.nabble.com>
	<1305001560672-3510979.post@n4.nabble.com>
Message-ID: <alpine.LFD.2.02.1105100703550.8562@gannet.stats.ox.ac.uk>

On Mon, 9 May 2011, Sharpie wrote:

>
> aftar wrote:
>>
>> Hi
>>
>> Can we use BLAS in R X64 for windows?
>>
>> Regards
>> Aftar
>>
>
> You are already using BLAS in R as R includes its own BLAS library. On
> Windows the 64-bit DLL is located at R_HOME\bin\x64\Rblas.dll.
>
> If you are asking about swapping that out for an optimized BLAS, you will
> probably have to:
>
>  1. Obtain and build an optimized BLAS such as ATLAS, Goto BLAS or Intel
> MKL
>
>  2. Build your own copy of R from source that links against this new blas.
>
> If there is a simpler way, I'm sure someone will correct me.

All you need is a copy of Rblas.dll containing the BLAS you wish to 
use.  You do not need to rebuild anything else in R.  Some (not 
recent) such Rblas.dll are made available: see the R for Windows 
documentation.  In addition, Ei-ji Nakama has posted (on this list) 
how to use the Goto BLAS on x64 Windows.

>
>
> -----
> Charlie Sharpsteen
> Undergraduate-- Environmental Resources Engineering
> Humboldt State University
> --
> View this message in context: http://r.789695.n4.nabble.com/matrix-multiplication-speed-R-tp3217257p3510979.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From aftar at ukm.my  Mon May  9 17:32:36 2011
From: aftar at ukm.my (aftar)
Date: Mon, 9 May 2011 08:32:36 -0700 (PDT)
Subject: [Rd] matrix multiplication speed R
In-Reply-To: <1295007321497-3217539.post@n4.nabble.com>
References: <1294992591724-3217257.post@n4.nabble.com>
	<AANLkTinaCO61x_fWzqFFawWrnBN+LZ_APLpsaBZYAw-j@mail.gmail.com>
	<4D302DCF.1020003@statistik.tu-dortmund.de>
	<1295007321497-3217539.post@n4.nabble.com>
Message-ID: <1304955156757-3509596.post@n4.nabble.com>

Hi

Can we use BLAS in R X64 for windows?

Regards
Aftar

--
View this message in context: http://r.789695.n4.nabble.com/matrix-multiplication-speed-R-tp3217257p3509596.html
Sent from the R devel mailing list archive at Nabble.com.


From hadley at rice.edu  Tue May 10 15:38:11 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 10 May 2011 08:38:11 -0500
Subject: [Rd] Which higher-order function
Message-ID: <BANLkTi=CydXKyDQUoY0t9F_VAcYKuPS0ow@mail.gmail.com>

Would it be appropriate to add a Which higher-order function?

Which <- function(f, x) {
   ind <- vapply(x, f, logical(1))
   !is.na(ind) & ind
}

Then Filter would be:

Filter <- function(f, x) x[Which(f, x)]

I think the use of vapply is slightly better than the current
as.logical(sapply(x, f)) because it will return a more informative
error message if the predicate doesn't return a logical vector of the
correct length.

Hadley



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Tue May 10 16:35:03 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 10 May 2011 09:35:03 -0500
Subject: [Rd] Debugging warnings
Message-ID: <BANLkTimn7nv3VwUGf-fV+0miCtGz3y2D3Q@mail.gmail.com>

Hi all,

One thing that's currently a little tricky in R is debugging warnings.
 One solution is to turn them into errors and then use the usual error
tracking mechanisms (e.g. options(error = recover)).  But it should be
possible to use withCallingHandlers to provide more flexibility.  The
function below works, but I'm wondering if there's a more elegant way
to figure out the correct frame to evaluate the action in - I'm
currently counting back one from where warning was called.

on_warning <- function(action, code) {
  q_action <- substitute(action)

  withCallingHandlers(code, warning = function(c) {
    for(i in seq_len(sys.nframe())) {
      f <- as.character(sys.call(i)[[1]])
      if (f == "warning") break;
    }

    eval(q_action, sys.frame(i - 1))
  })
}

x <- 1
f <- function() {
  x <- 2
  g()
}
g <- function() {
  x <- 3
  warning("Leaving g")
}
on_warning(browser(), f())
on_warning(print(ls()), f())

Thanks,

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From edd at debian.org  Tue May 10 17:26:34 2011
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 10 May 2011 10:26:34 -0500
Subject: [Rd] Time-machine typo
Message-ID: <19913.22826.268698.780107@max.nulle.part>


Just noticed this in R 2.13.0, it is also still present in R-devel in SVN:

   %%% Rd.sty ... Style for printing the R manual
   %%% Part of the R package, http://www.R-project.org
   %%% Copyright (C) 2003-20010 The R Foundation
                          ^^^^^

Very forward-looking ...

Dirk

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com


From rvaradhan at jhmi.edu  Tue May 10 17:35:50 2011
From: rvaradhan at jhmi.edu (Ravi Varadhan)
Date: Tue, 10 May 2011 11:35:50 -0400
Subject: [Rd] Time-machine typo
In-Reply-To: <19913.22826.268698.780107@max.nulle.part>
References: <19913.22826.268698.780107@max.nulle.part>
Message-ID: <79F23BA7BB084E4FA01A8B93904CD02CF66AEC0AC0@WIGGUMVS.win.ad.jhu.edu>

Indeed, Dirk, but realistic, I might add!

BTW, I enjoyed some of the "Gaussian Facts".  

My favorite:  It only takes Gauss 4 minutes to sing "Aleph-Null Bottles of Beer on the Wall". 

Best,
Ravi.
-------------------------------------------------------
Ravi Varadhan, Ph.D.
Assistant Professor,
Division of Geriatric Medicine and Gerontology School of Medicine Johns Hopkins University

Ph. (410) 502-2619
email: rvaradhan at jhmi.edu


-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Dirk Eddelbuettel
Sent: Tuesday, May 10, 2011 11:27 AM
To: R-devel org
Subject: [Rd] Time-machine typo


Just noticed this in R 2.13.0, it is also still present in R-devel in SVN:

   %%% Rd.sty ... Style for printing the R manual
   %%% Part of the R package, http://www.R-project.org
   %%% Copyright (C) 2003-20010 The R Foundation
                          ^^^^^

Very forward-looking ...

Dirk

-- 
Gauss once played himself in a zero-sum game and won $50.
                      -- #11 at http://www.gaussfacts.com

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From sean.mcguffee at gmail.com  Tue May 10 20:08:45 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Tue, 10 May 2011 14:08:45 -0400
Subject: [Rd] cerr and cout not working calling c++ from R
In-Reply-To: <BANLkTimWcFJNxmymVMNv8SOqcBtoEE-BEQ@mail.gmail.com>
Message-ID: <C9EEF76D.412B%sean.mcguffee@gmail.com>

Just a short follow up to the list.
It turns out that the strange behavior I was experiencing had nothing to do
with cout and cerr, but ostreams in general. For some reason, at a minimum,
the operators: 
ostream& operator<< (long& val );
ostream& operator<< (double& val );
were not functioning properly and were causing my problem.
To get around this, I simply had to convert types like these to strings
before passing them into the ostreams with << operators.
I don't know if this was due to a mistake in which libraries I linked to or
which headers are being read when I make my project. However, it seems that
I have ruled out the possibility of this being unique to 64-bit longs as the
doubles are standard types on any machine. Anyway, I appreciate everyone's
help, and if anyone has trouble with this type of thing in the future, a
simple couple of functions I used to convert the long or double values to
strings were:
string getStringFromDouble(double d)
{
    char*doubleValue = (char*)calloc(1000,sizeof(char));
    sprintf(doubleValue,"%f",d);
    string returnValue(doubleValue);
    free(doubleValue);
    return(returnValue);
}
string getStringFromLong(long i)
{
    char*intValue = (char*)calloc(1000,sizeof(char));
    sprintf(intValue,"%ld",i);
    string returnValue(intValue);
    free(intValue);
    return(returnValue);
}
I'm not sure why this was necessary, but it solves my issue.
Thanks again for all the help--I learned a lot about streams and stream
buffers in the process.
Thanks,
Sean



On 5/8/11 12:56 AM, "Sean Robert McGuffee" <sean.mcguffee at gmail.com> wrote:

> Thanks, Simon,
> That link may prove to be very useful. I think what I can do is make a
> similar version of a buffer to one in that example and then have it
> conditionally write to Rprintf or cout and/or REprintf or cerr,
> depending on whether I'm running a c++ program from the command line
> or launching a function from R. Then I can just replace all of my cout
> and cerr terms with this new buffer or two in global space. Before I
> call those functions in R, I'll set them to write to R before I launch
> any code that uses it. This should allow me to leave all my code
> exactly how it is with a minor replacement of one or two terms for
> another. So, if the errors in my performance are only caused by
> writing to cout and/or cerr from R, then they can be completely
> avoided by all of those substitutions writing to Rprintf and REprintf.
> This seems like it is going to work exactly as I'm hoping.
> Thanks again,
> Sean
> 
> On Sat, May 7, 2011 at 6:13 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>> Sean,
>> 
>> just to clarify - this is not about something "not working" or any leaks.
>> cout/cerr do exactly what they are supposed to, it's just in most cases not
>> what you want. The main reason is that R does not necessarily use
>> stdin/stdout so cout/cerr may have nothing to do with the R console output.
>> The effects of using cout/cerr vary by the actual setup in which you run R as
>> I was explaining earlier. In the most complex setup (default for interactive
>> R on OS X, actually) you have:
>> 
>> 1) stdin/stdout/stderr - those are entirely independent of the R console
>> 2) ReadConsole/WriteConsole - this is how R interacts with the console
>> 3) C++ cin/cout/cerr - by default a buffered link to stdin/out/err
>> 
>> So as you see the reason for cout being strongly discouraged is simply
>> because it has no relationship with R and produces no output in R itself.
>> What makes things seemingly puzzling is that some UI implementations in R use
>> stdin/out/err in Read/WriteConsole, so suddenly you are dealing with three
>> independent streams and buffers (e.g., cout, WriteCondole and stdout all
>> eventually ending in the same place but at different times). If your final
>> output is a tty then they all get synchronized at the end into the same tty,
>> but since each of them has a buffer, the result is random at the best.
>> 
>> Due to the interactions, you must be careful not to mess things up with any
>> additional low-level stream manipulations. For example, the R.app GUI doesn't
>> use stdout/err for console at all, since it is driven by text views instead,
>> so it uses exclusively Read/WriteConsole (and so does the Windows GUI).
>> However, it also monitors stdout/err for external output (e.g. from system())
>> and uses two separate pipes to merge that output into the console with
>> different colors. So if you were to start to mess with the descriptors for
>> stdout/err you could break that setup.
>> 
>> That said, if you want a solution for C++ you should simply write a stream or
>> buffer that uses Rprintf/REprintf for output. I was assuming that others have
>> done that before, but Dirk's response suggests that it is not as common. If
>> you choose to do it, you may find this link helpful:
>> http://groups.google.com/group/comp.lang.c++/msg/1d941c0f26ea0d81
>> 
>> Cheers,
>> Simon
>> 
>> 
>> On May 7, 2011, at 12:42 AM, Sean Robert McGuffee wrote:
>> 
>>> This is a good idea as to converting to stringstream's because it
>>> could let me remove cout and cerr from the equation. At the moment, I
>>> get that feeling from the experts that having cout and cerr is causing
>>> a bug by not mixing with R. I have other cases where algorithms that
>>> avoid cout and cerr aren't working, but as far as my experience with
>>> bugs in c code goes, a memory issue in one place can make everything
>>> go haywire, and an random cout or cerr somewhere that I don't catch
>>> could maybe be the source of the issue. I also like this idea of
>>> piping and then calling Rprintf. Along the same lines, I could create
>>> a string and then either spit to cout or cerr or spit to Rprintf
>>> depending on some sort of setting. One of the key reasons I have been
>>> hanging on to cout and cerr is that I want to keep all of my c++ code
>>> identical to the status quo as far as the command line interface is
>>> concerned. On the other hand, maybe I can just globally substitute
>>> cout and cerr to random file streams and avoid the conflict with
>>> stdout and stderr. I take it that it isn't ostreams per say causing
>>> the problem but that it's something specific about cout and cerr not
>>> mixing with R. Then maybe I can pass their buffers to cout, cerr, or
>>> Rprintf, depending on preferences later. What I would really like to
>>> do maybe be beyond my grasp, but that would be to integrate ostreams
>>> into R. I am toying with an idea of mimicking cout and cerr with some
>>> new classes that are almost verbatim copies of cout and cerr with
>>> substituted names. Then maybe inside their internals I can more easily
>>> create conditional access to Rprintf calls. What I like about this
>>> strategy is that I could do a global substitution of cout and cerr
>>> with new objects of more useful functionality, and that way I might
>>> not have to re-write all my c++ code which constantly calls on these
>>> standard streams. Plus, if I get something generic to work, maybe I
>>> can pass it on to Dirk so others won't have to deal with this stuff in
>>> the future. I find this fascinating that the output may be tty. I see
>>> now that the device on my Mac that /dev/stdout points to is a tty. I
>>> have never encountered tty before, but I have a vague memory of a term
>>> like that back in the day of dial up! Oh the fun things I'm learning.
>>> Just to clarify though, is the only way my code "mixes IO systems
>>> between R and C++" by way of cout and cerr happening to be
>>> synchronized with stderr and stdout by default? Or is there something
>>> inherent in ostreams in general that doesn't mesh with R? I guess I
>>> find it a little bit surprising that calling
>>> ios_base::sync_with_stdio(false) and redirecting those streams to
>>> other files doesn't dodge that bullet. I know that doesn't break the
>>> ostreams themselves because it works fine from the command line
>>> interface. I guess I'll have to delve more into how c++ works behind
>>> the scenes to figure that part out. I think Dirk has a really good
>>> suggestion to comment out all of my cout and cerr calls and see if
>>> still get a bug. Obviously that wouldn't be any permanent fix for
>>> future users who want to link code with cout and cerr, but it would
>>> help me identify if this is the only source of error. It might take me
>>> till past the weekend to get to the bottom of some of these things,
>>> but I'll post what I find out.
>>> Thanks again--I appreciate everyone's useful suggestions.
>>> Sean
>>> 
>>> On Fri, May 6, 2011 at 10:44 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>>>> 
>>>> On 6 May 2011 at 22:09, Simon Urbanek wrote:
>>>> | Sean,
>>>> |
>>>> | the path form the console is not under your control and it depends
>>>> heavily on the internal settings in R (is console enabled, is R
>>>> interactive, is the output a tty or a file ...) - that's why you have to
>>>> use Rprint/REprintf - that's the only path that is guaranteed to work.
>>>> Anything else is settings-specific and not guaranteed to work (it may
>>>> appear to work in limited settings, but will not work in others). Note
>>>> that, for example, WriteConsole is only used if R is not fed via I/O pipes
>>>> - that may be what baffled you in that case.
>>>> |
>>>> | So AFAICS the only C++ solution (other than using Rprintf/REprintf
>>>> directly) is to create streams to pipes whose ends will call
>>>> Rprintf/REprintf with the content. Anything else is not general. You may
>>>> want to ask Rcpp people (Dirk is CC'd anyway ;)) - I'd imagine they must
>>>> have thought of it as it seems very natural to request in a C++ interface
>>>> ... (but I don't use Rcpp so I don't know).
>>>> 
>>>> Rcpp makes no claims about reimplementing IO, or providing new IO
>>>> facilities.
>>>> Rcpp is clearly bound by the R API upon which it builds; the R
>>>> documentation
>>>> (which I quoted in my earlier email in this thread) suggests to expect
>>>> nasty
>>>> things when one mixes IO systems between R and C++.
>>>> 
>>>> And that seems to be what Sean is experiencing; I for one am not surprised.
>>>> It was never clear from Seans's mails exactly how much time he has had for
>>>> reading of the available documentation, his approach seems to me mostly
>>>> driven by a vast and vague set of assumption on his part (eg the rout/rerr
>>>> business he comes back to), as well as a lot energy and a willingness to
>>>> just
>>>> try this. ?Which is perfectly fine, but it can also fail.
>>>> 
>>>> I'd suggest to start small with as little IO as possible. Maybe even
>>>> comment
>>>> all IO out as much as possible. Or redo it as strstream and feed that to
>>>> Rprintf.
>>>> 
>>>> Dirk
>>>> 
>>>> 
>>>> | Cheers,
>>>> | Simon
>>>> |
>>>> |
>>>> |
>>>> | On May 6, 2011, at 3:19 PM, Sean Robert McGuffee wrote:
>>>> |
>>>> | > Hi,
>>>> | >
>>>> | > Thanks for the comments so far.
>>>> | >
>>>> | > I've been going through the code extensively and seem to be having
>>>> trouble
>>>> | > reproducing what R is doing, so this confuses me. For example, when I
>>>> write
>>>> | > out the pointer values for ptr_R_WriteConsole type functions, I can't
>>>> find a
>>>> | > function that matches what is actually being called.
>>>> | >
>>>> | > REprintf("Rstd_WriteConsole=%ld, ptr_R_WriteConsole=%ld,
>>>> | > R_WriteConsole=%ld\n", Rstd_WriteConsole, ptr_R_WriteConsole,
>>>> | > R_WriteConsole);
>>>> | >
>>>> | > It might be something like RTcl_WriteConsole too. However, I can't seem
>>>> to
>>>> | > find the headers I would need to try to find it's pointer value.
>>>> Anyway,
>>>> | > these are often hidden/protected/static which is an aspect of code that
>>>> I
>>>> | > only understand in concept. The concept I understand about this type of
>>>> | > stuff is that if you provide a better way of doing things, then maybe
>>>> you
>>>> | > hide some stuff that doesn't involve the better way. However, in this
>>>> case,
>>>> | > the hidden stuff is just making it difficult for me to debug and get to
>>>> | > bottom of what is going on. Anyway, I get different results if I call
>>>> on the
>>>> | > functions that simply use stdout when trying to reproduce Rprintf
>>>> | > functionality. I'm only doing that to try to get to the bottom of what
>>>> R is
>>>> | > doing with stdout and stderr. I also am having a similar issue with
>>>> trying
>>>> | > to understand what GNU GCC is doing with how it sync's cout and cerr
>>>> with
>>>> | > stdout and stderr. Maybe R is intercepting some of these components.
>>>> Anyway,
>>>> | >
>>>> | > I was hoping to get around the
>>>> | > "5.6 Interfacing C++ code
>>>> | > ? ======================== ? [...]
>>>> | > ? ? ?Using C++ iostreams, as in this example, is best avoided. ?There
>>>> is
>>>> | > ? no guarantee that the output will appear in the R console, and indeed
>>>> it
>>>> | > ? will not on the R for Windows console. ?Use R code or the C entry
>>>> points
>>>> | > ? (*note Printing::) for all I/O if at all possible."
>>>> | > if at all possible. My reason is that I have 76386 lines of c++ code
>>>> that
>>>> | > I'm trying to interface with R, and it literally might be faster for me
>>>> to
>>>> | > update R rather than modify all of that code to suit R which seems to
>>>> be
>>>> | > lacking a c++ ostream interface.
>>>> | >
>>>> | > Ideally, I'd write rout and rerr versions of cout and cerr for R to
>>>> become
>>>> | > more compatible with c++. I have had some trouble figuring a lot of
>>>> this
>>>> | > hidden stuff out. Strategies I have considered are the following:
>>>> | > 1) Write macros that conditionally replace cerr and cout with Rprintf
>>>> | > somehow throughout all of my c++ code that I'm trying to interface with
>>>> R.
>>>> | > 2) Recreate the std::cerr and std::cout type of classes but maybe add
>>>> some
>>>> | > extra functionality for callbacks to when i/o events take place to
>>>> somehow
>>>> | > try to fix things.
>>>> | > 3) Make a scratch version of R source code that has no hidden aspects
>>>> to try
>>>> | > to investigate what is going on a little better.
>>>> | >
>>>> | > Also, I should mention that I found an unanswered post from someone who
>>>> had
>>>> | > a similar problem when trying to use cerr and cout when accessing
>>>> functions
>>>> | > from dynamically linked libraries. I wonder, is it possible that R
>>>> hasn't
>>>> | > completely connected to these libraries? I mean, it's doing some sort
>>>> of
>>>> | > magic where it finds a pointer to a function, but maybe c++ has a lot
>>>> going
>>>> | > on in the background related to these ostream types that could be
>>>> getting
>>>> | > messed up. Maybe some aspects of the global environment might be
>>>> different
>>>> | > somehow? I directly link to my libraries via a c++ compiler when I get
>>>> the
>>>> | > identical functions to work from main in c++.
>>>> | >
>>>> | > One final thing I'm considering is that the R manual also mentions
>>>> something
>>>> | > about garbage collection and some circumstances under which it's
>>>> important
>>>> | > to explicitly request pointers to be maintained. Is it possible that R
>>>> is
>>>> | > eating global pointers used by std::ostream ?
>>>> | >
>>>> | > All suggestions are valued and if anyone has recommendations on
>>>> strategy,
>>>> | > please let me know.
>>>> | >
>>>> | > Thanks,
>>>> | > Sean
>>>> | >
>>>> | >
>>>> | > On 5/6/11 2:50 PM, "Davor Cubranic" <cubranic at stat.ubc.ca> wrote:
>>>> | >
>>>> | >> On 2011-05-06, at 11:41 AM, Dirk Eddelbuettel wrote:
>>>> | >>
>>>> | >>> | I?m trying to call some of my c++ code from R and seem to be having
>>>> an
>>>> | >>> issue
>>>> | >>> | with streams, although that?s just one obvious sign of something
>>>> different
>>>> | >>> | in performance between calling the same function from main in c++
>>>> vs.
>>>> | >>> | calling the same function from R. [...]
>>>> | >>> In a nutshell, R 'owns' your console. That is part of the Faustian
>>>> bargain.
>>>> | >>
>>>> | >> But isn't he redirecting cout to a file, so the C++ output is not to
>>>> the
>>>> | >> console?
>>>> | >>
>>>> | >> Davor
>>>> | >
>>>> | >
>>>> | > On 5/6/11 2:41 PM, "Dirk Eddelbuettel" <edd at debian.org> wrote:
>>>> | >
>>>> | >>
>>>> | >> On 6 May 2011 at 14:21, Sean Robert McGuffee wrote:
>>>> | >> | Hi,
>>>> | >> |
>>>> | >> | Sorry, I just tried posting this but I had it in the wrong format of
>>>> text,
>>>> | >> | so this is a cleared format repost:
>>>> | >> |
>>>> | >> | I?m trying to call some of my c++ code from R and seem to be having
>>>> an issue
>>>> | >> | with streams, although that?s just one obvious sign of something
>>>> different
>>>> | >> | in performance between calling the same function from main in c++
>>>> vs.
>>>> | >> | calling the same function from R. I?m not getting any signs of
>>>> errors from
>>>> | >> | R, but the behavior is different somehow and in a way that breaks my
>>>> | >> | algorithms. In both cases of launching a function from c++ or R, I
>>>> redirect
>>>> | >> | cout to a file using a streambuf. In particular, I can see progress
>>>> stop
>>>> | >> | when launching from R at a point when cout gets truncated when
>>>> starting to
>>>> | >> | write out iterator values in a std::vector<string>. Then, I find no
>>>> way to
>>>> | >> | write anything else to cout. When I write those values to Rprintf,
>>>> they are
>>>> | >> | there and they are as expected. I?ve tried setting
>>>> | >> | ios_base::sync_with_stdio(false) in case R is messing with stdout
>>>> and stderr
>>>> | >> | somehow, but that made no difference. I?m not quite sure how R uses
>>>> those C
>>>> | >> | FILE* streams. Anyway, I am wondering if anyone has a hunch as to
>>>> what might
>>>> | >> | be going on. At this point I don?t know if it might be an issue with
>>>> R not
>>>> | >> | completely handling c++ from a library or if it is an issue with
>>>> cout in
>>>> | >> | particular or if there is something else I?m missing. Please let me
>>>> know if
>>>> | >> | you have any suggestions for me.
>>>> | >>
>>>> | >> Doug Bates sometimes remarks that, once all other alternatives are
>>>> exhausted,
>>>> | >> one could consider reading the manual. And indeed, 'Writing R
>>>> Extensions' has
>>>> | >> this to say:
>>>> | >>
>>>> | >> ? 5.6 Interfacing C++ code
>>>> | >> ? ========================
>>>> | >>
>>>> | >> ? [...]
>>>> | >>
>>>> | >> ? ? ?Using C++ iostreams, as in this example, is best avoided. ?There
>>>> is
>>>> | >> ? no guarantee that the output will appear in the R console, and
>>>> indeed it
>>>> | >> ? will not on the R for Windows console. ?Use R code or the C entry
>>>> points
>>>> | >> ? (*note Printing::) for all I/O if at all possible.
>>>> | >>
>>>> | >> In a nutshell, R 'owns' your console. That is part of the Faustian
>>>> bargain.
>>>> | >>
>>>> | >> Dirk
>>>> | >>
>>>> | >> --
>>>> | >> Gauss once played himself in a zero-sum game and won $50.
>>>> | >> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com
>>>> | >
>>>> | > ______________________________________________
>>>> | > R-devel at r-project.org mailing list
>>>> | > https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> | >
>>>> | >
>>>> |
>>>> 
>>>> --
>>>> Gauss once played himself in a zero-sum game and won $50.
>>>> ? ? ? ? ? ? ? ? ? ? ?-- #11 at http://www.gaussfacts.com
>>> 
>>> 
>> 
>> 


From chuck at sharpsteen.net  Tue May 10 23:03:17 2011
From: chuck at sharpsteen.net (Sharpie)
Date: Tue, 10 May 2011 14:03:17 -0700 (PDT)
Subject: [Rd] Fortran Symbol Name not in Load Table
In-Reply-To: <1304990917157-3510758.post@n4.nabble.com>
References: <1304930976028-3508719.post@n4.nabble.com>
	<1304935634803-3508852.post@n4.nabble.com>
	<1304990917157-3510758.post@n4.nabble.com>
Message-ID: <1305061397740-3513005.post@n4.nabble.com>


vioravis wrote:
> 
> I used the DLL export viewer to what is the table name being exported. It
> is showing as VALUEAHROPTIMIZE_. This is the name of the function we have
> used plus the underscore.
> 
> Is there any other reason for the function not getting recognized???
> Thanks.
> 

Which compiler are you using? Which version of R?

-----
Charlie Sharpsteen
Undergraduate-- Environmental Resources Engineering
Humboldt State University
--
View this message in context: http://r.789695.n4.nabble.com/Fortran-Symbol-Name-not-in-Load-Table-tp3508719p3513005.html
Sent from the R devel mailing list archive at Nabble.com.


From john.maindonald at anu.edu.au  Wed May 11 01:06:33 2011
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Wed, 11 May 2011 09:06:33 +1000
Subject: [Rd] anova.lm fails with test="Cp"
In-Reply-To: <AA81EAC1-22CD-4550-BFCA-C04F42F8FB3A@gmail.com>
References: <0E28A214-9F72-45A2-AAA2-E1D7EC46C6B1@anu.edu.au>
	<AA81EAC1-22CD-4550-BFCA-C04F42F8FB3A@gmail.com>
Message-ID: <13D70C43-99FF-45E6-B4EE-6D9951DE00DB@anu.edu.au>

For unknown sigma^2, a version that is a modification of AIC
may be preferred, i.e.

n log(RSS/n) + 2p - n

I notice that this is what is given in Maindonald and Braun (2010)
Data Analysis & Graphics Using R, 3rd edition.

Cf: Venables and Ripley, MASS, 4th edn, p.174.  V&R do however
stop short of actually saying that Cp should be modified in the same
way as AIC when sigma^2 has to be estimated.  

Better still, perhaps,  give the AIC statistic.  This would make the
output consistent with dropterm(), drop1() and add1().  Or if Cp
is to stay, allow AIC as a a further "test".

John Maindonald             email: john.maindonald at anu.edu.au
phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
Centre for Mathematics & Its Applications, Room 1194,
John Dedman Mathematical Sciences Building (Building 27)
Australian National University, Canberra ACT 0200.
http://www.maths.anu.edu.au/~johnm

On 08/05/2011, at 6:15 PM, peter dalgaard wrote:

> 
> On May 8, 2011, at 09:25 , John Maindonald wrote:
> 
>> Here is an example, modified from the help page to use test="Cp":
>> 
>> --------------------------------------------------------------------------------
>>> fit0 <- lm(sr ~ 1, data = LifeCycleSavings)
>>> fit1 <- update(fit0, . ~ . + pop15)
>>> fit2 <- update(fit1, . ~ . + pop75)
>>> anova(fit0, fit1, fit2, test="Cp")
>> Error in `[.data.frame`(table, , "Resid. Dev") : 
>> undefined columns selected
> 
> Yes, the "Resid. Dev" column is only there in analysis of deviance tables. For the lm() case, it looks like you should have "RSS". 
> 
> This has probably been there "forever". Just goes to show how often people use these things...
> 
> Also, now that I'm looking at it, are we calculating it correctly in any case? We have
> 
>       cbind(table, Cp = table[, "Resid. Dev"] + 2 * scale * 
>           (n - table[, "Resid. Df"]))
> 
> whereas all the references I can find have Cp=RSS/MS-N+2P, so the above would actually be scale*Cp+N. 
> 
> 
> -- 
> Peter Dalgaard
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> 


From manuel.castejon at unileon.es  Wed May 11 01:44:19 2011
From: manuel.castejon at unileon.es (Manuel =?ISO-8859-1?B?Q2FzdGVq824=?= Limas)
Date: Wed, 11 May 2011 01:44:19 +0200
Subject: [Rd] Reference Classes  copy(shallow=FALSE) unexpected behavior.
Message-ID: <C9EF9A73.4978%manuel.castejon@unileon.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/4a20f175/attachment.pl>

From murdoch.duncan at gmail.com  Wed May 11 02:24:55 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 10 May 2011 20:24:55 -0400
Subject: [Rd] Fortran Symbol Name not in Load Table
In-Reply-To: <1304990917157-3510758.post@n4.nabble.com>
References: <1304930976028-3508719.post@n4.nabble.com>	<1304935634803-3508852.post@n4.nabble.com>
	<1304990917157-3510758.post@n4.nabble.com>
Message-ID: <4DC9D757.5020500@gmail.com>

On 11-05-09 9:28 PM, vioravis wrote:
> I used the DLL export viewer to what is the table name being exported. It is
> showing as VALUEAHROPTIMIZE_. This is the name of the function we have used
> plus the underscore.
>

I believe R will be looking for the lower case version of that name, 
which is what gfortran would produce.

Duncan Murdoch

> Is there any other reason for the function not getting recognized??? Thanks.
>
> --
> View this message in context: http://r.789695.n4.nabble.com/Fortran-Symbol-Name-not-in-Load-Table-tp3508719p3510758.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From vioravis at gmail.com  Wed May 11 07:39:07 2011
From: vioravis at gmail.com (vioravis)
Date: Tue, 10 May 2011 22:39:07 -0700 (PDT)
Subject: [Rd] Fortran Symbol Name not in Load Table
In-Reply-To: <4DC9D757.5020500@gmail.com>
References: <1304930976028-3508719.post@n4.nabble.com>
	<1304935634803-3508852.post@n4.nabble.com>
	<1304990917157-3510758.post@n4.nabble.com>
	<4DC9D757.5020500@gmail.com>
Message-ID: <1305092347664-3513909.post@n4.nabble.com>

Thank you Sharpie and Duncan.

I am using Compaq Visual Fortran compiler on a Windows machine.

I tried with all small letters for the function names and created the DLLs.
But somehow the DLL created only had all CAPS. But the DLL worked when I
changed the function name to myxmean. Not really sure what changed but it
worked fine :)

Ravi



--
View this message in context: http://r.789695.n4.nabble.com/Fortran-Symbol-Name-not-in-Load-Table-tp3508719p3513909.html
Sent from the R devel mailing list archive at Nabble.com.


From Thorn.Thaler at rdls.nestle.com  Wed May 11 09:11:10 2011
From: Thorn.Thaler at rdls.nestle.com (Thaler, Thorn, LAUSANNE,
	Applied Mathematics)
Date: Wed, 11 May 2011 09:11:10 +0200
Subject: [Rd] stats:::biplot.prcomp: Scaling, typo in the help file?
Message-ID: <F54EF8F1B477CF448729593FE421F6464F8FB5@HQVEVE0032.nestle.com>

Dear all,

>From the documentation of biplot.prcomp:

scale: The variables are scaled by 'lambda ^ scale' and the
       observations are scaled by 'lambda ^ (1-scale)' where
       'lambda' are the singular values as computed by 'princomp'.

>From the source code of prcomp:

    lam <- x$sdev[choices]
    n <- NROW(scores)
    lam <- lam * sqrt(n)
    if (scale < 0 || scale > 1) 
        warning("'scale' is outside [0, 1]")
    if (scale != 0) 
        lam <- lam^scale
    else lam <- 1
    if (pc.biplot) 
        lam <- lam/sqrt(n)
    biplot.default(t(t(scores[, choices])/lam), t(t(x$rotation[, 
        choices]) * lam), ...)


Thus, the observations are divided by the scale factor, i.e. they are scaled by lambda^(-scale) and not by lambda^(1-scale).

Am I missing something?

Kind Regards,

Thorn Thaler
Mathematician

Applied Mathematics Group 
Nestl? Research Center
PO Box 44 
CH-1000 Lausanne 26, Switzerland
Phone: +41 21 785 8220
Fax: +41 21 785 8556


From pdalgd at gmail.com  Wed May 11 11:36:59 2011
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 11 May 2011 11:36:59 +0200
Subject: [Rd] New code in R-devel: Rao score test for glm.
Message-ID: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com>

I have just committed some code to the r-devel branch to implement the Rao efficient score test. This is asymptotically equivalent to the LRT, but there is some indication that it might have better properties in smaller samples since it is based more directly on the distribution of the sufficient sums under the null hypothesis (e.g., if you have a divergent fit to the model under the alternative, the chi-square distribution of the likelihood ratio may be dubious and the Wald test is surely wrong).

It works fairly obviously by using test="Rao" in various methods. See for instance the last part of example(anova.glm).

While going over the code, I took the liberty of standardizing the labeling of the p-value column to Pr(>Chi) and Pr(>F). This may break some scripts if they extract p-values using constructs like anova(glm.D93,test="Chisq")$"P(>|Chi|)"[2]. Apologies for the disturbance, but this sort of change just doesn't let itself be implemented with the usual deprecation sequence. The workaround should be straightforward (if you need something that works in multiple versions, then try both and choose the result that isn't NULL). 

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From Stefan.Hoj-Edwards at agrsci.dk  Wed May 11 12:18:01 2011
From: Stefan.Hoj-Edwards at agrsci.dk (=?iso-8859-1?Q?Stefan_McKinnon_H=F8j-Edwards?=)
Date: Wed, 11 May 2011 12:18:01 +0200
Subject: [Rd] RCMD check fails on "checkin installed package size"
Message-ID: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>

Hi,

When I run RCMD check on my package, I receive the following error:
C:\R-packages\AnnotationFuncs>RCMD check --no-vignettes AnnotationFuncs
* using log directory 'C:/R-packages/AnnotationFuncs/AnnotationFuncs.Rcheck'
* using R version 2.13.0 (2011-04-13)
* using platform: i386-pc-mingw32 (32-bit)
* using session charset: ISO8859-1
* using option '--no-vignettes'
* checking for file 'AnnotationFuncs/DESCRIPTION' ... OK
* this is package 'AnnotationFuncs' version '1.1.2'
* checking package name space information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking for executable files ... OK
* checking whether package 'AnnotationFuncs' can be installed ... OK
* checking installed package size ...Error in if (total > 1024 * 5) { : missing
value where TRUE/FALSE needed
Execution halted


I am running it on Windows 7 (32-bit) and my PATH environment variable starts with this:
C:\Rtools\bin;C:\Rtools\MinGW\bin;C:\Program Files\R\R-2.13.0\bin\i386;

I have updated Rtools to the newest with 2.13.

Any suggestions?

Thanks in advanced,
Stefan McKinnon H?j-Edwards


From ripley at stats.ox.ac.uk  Wed May 11 13:51:17 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 11 May 2011 12:51:17 +0100 (BST)
Subject: [Rd] RCMD check fails on "checkin installed package size"
In-Reply-To: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>
References: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>
Message-ID: <alpine.LFD.2.02.1105111247140.8673@toucan.stats.ox.ac.uk>

On Wed, 11 May 2011, Stefan McKinnon H?j-Edwards wrote:

> Hi,
>
> When I run RCMD check on my package, I receive the following error:
> C:\R-packages\AnnotationFuncs>RCMD check --no-vignettes AnnotationFuncs
> * using log directory 'C:/R-packages/AnnotationFuncs/AnnotationFuncs.Rcheck'
> * using R version 2.13.0 (2011-04-13)
> * using platform: i386-pc-mingw32 (32-bit)
> * using session charset: ISO8859-1
> * using option '--no-vignettes'
> * checking for file 'AnnotationFuncs/DESCRIPTION' ... OK
> * this is package 'AnnotationFuncs' version '1.1.2'
> * checking package name space information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking for executable files ... OK
> * checking whether package 'AnnotationFuncs' can be installed ... OK
> * checking installed package size ...Error in if (total > 1024 * 5) { : missing
> value where TRUE/FALSE needed
> Execution halted
>
>
> I am running it on Windows 7 (32-bit) and my PATH environment variable starts with this:
> C:\Rtools\bin;C:\Rtools\MinGW\bin;C:\Program Files\R\R-2.13.0\bin\i386;
>
> I have updated Rtools to the newest with 2.13.
>
> Any suggestions?

Set _R_CHECK_PKG_SIZES_ to 'no' (see 'Writing R Extensions' and its 
references on customizing R CMD check), or correct your paths so the 
'du' program in Rtools is the one that is found.  (The only reported 
example was from using a different 'du' program.)

I believe that current R-patched works around this: R-devel definitely 
does.

>
> Thanks in advanced,
> Stefan McKinnon H?j-Edwards
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hadley at rice.edu  Wed May 11 14:00:42 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 11 May 2011 07:00:42 -0500
Subject: [Rd] Reference Classes copy(shallow=FALSE) unexpected behavior.
In-Reply-To: <C9EF9A73.4978%manuel.castejon@unileon.es>
References: <C9EF9A73.4978%manuel.castejon@unileon.es>
Message-ID: <BANLkTi=GoqXmLm5y8VKu11=H7jebCG=9DA@mail.gmail.com>

2011/5/10 Manuel Castej?n Limas <manuel.castejon at unileon.es>:
> Dear all,
>
> I've just discovered the 'Reference Classes'.
> In a previous attempt ---a year ago--- to re-implement in a Object Oriented
> fashion the AMORE package using S4 classes I strongly felt the need of such
> capability. It's great to have the Reference Classes now available. Along
> with the discovery of the Rcpp package, this new programming paradigm has
> boosted my interest in rewriting that package.
>
> Nevertheless, I have found a surprising behavior in the $copy(shallow=FALSE)
> method. Let's have a look at the results which I believe are
> self-explanatories. The ".Data" field is a list which contains objects from
> the "Con" class ?---connections for what is worth---.

What sort of class is the Con class? S4 or reference?

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From presnell at stat.ufl.edu  Wed May 11 15:10:57 2011
From: presnell at stat.ufl.edu (Brett Presnell)
Date: Wed, 11 May 2011 09:10:57 -0400
Subject: [Rd] New code in R-devel: Rao score test for glm.
In-Reply-To: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com> (peter
	dalgaard's message of "Wed, 11 May 2011 11:36:59 +0200")
References: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com>
Message-ID: <87hb91s7q6.fsf@stat.ufl.edu>


Thanks for doing this Peter.  I'll have to install the development
version to try this out.

One suggestion though.  I'm pretty confident that plain old "score test"
is a more common terminology than anything involving Rao's name
(econometricians even call it the Lagrange multiplier test).  In light
of this, I think that it would be much better to use test = "score"
rather than test = "Rao".

-- 
Brett Presnell
Department of Statistics
University of Florida
http://www.stat.ufl.edu/~presnell/

"We don't think that the popularity of an error makes it the truth."
   -- Richard Stallman


From f.harrell at vanderbilt.edu  Wed May 11 15:24:20 2011
From: f.harrell at vanderbilt.edu (Frank Harrell)
Date: Wed, 11 May 2011 06:24:20 -0700 (PDT)
Subject: [Rd] New code in R-devel: Rao score test for glm.
In-Reply-To: <87hb91s7q6.fsf@stat.ufl.edu>
References: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com>
	<87hb91s7q6.fsf@stat.ufl.edu>
Message-ID: <1305120260666-3514679.post@n4.nabble.com>

Economists re-invented the Rao efficient score test, calling it the Lagrange
multiplier test.  Please check the history of this test.  Rao's paper was
published in 1947.  That being said, "score" would be more consistent with
the survival and rms packages.
Frank

Brett Presnell wrote:
> 
> Thanks for doing this Peter.  I'll have to install the development
> version to try this out.
> 
> One suggestion though.  I'm pretty confident that plain old "score test"
> is a more common terminology than anything involving Rao's name
> (econometricians even call it the Lagrange multiplier test).  In light
> of this, I think that it would be much better to use test = "score"
> rather than test = "Rao".
> 
> -- 
> Brett Presnell
> Department of Statistics
> University of Florida
> http://www.stat.ufl.edu/~presnell/
> 
> "We don't think that the popularity of an error makes it the truth."
>    -- Richard Stallman
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


-----
Frank Harrell
Department of Biostatistics, Vanderbilt University
--
View this message in context: http://r.789695.n4.nabble.com/New-code-in-R-devel-Rao-score-test-for-glm-tp3514262p3514679.html
Sent from the R devel mailing list archive at Nabble.com.


From hadley at rice.edu  Wed May 11 15:37:42 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 11 May 2011 08:37:42 -0500
Subject: [Rd] Reference Classes copy(shallow=FALSE) unexpected behavior.
In-Reply-To: <C9F048E6.49A8%manuel.castejon@unileon.es>
References: <BANLkTi=GoqXmLm5y8VKu11=H7jebCG=9DA@mail.gmail.com>
	<C9F048E6.49A8%manuel.castejon@unileon.es>
Message-ID: <BANLkTim4atRJrkBvU6FWqyoEwbsvKurM4A@mail.gmail.com>

Hi Manuel,

The source code for copy is short and pretty readable, so I'd
encourage you to look at it:

> setRefClass("XXX")$copy
Class method definition for method copy()
function (shallow = FALSE)
{
    def <- .refClassDef
    value <- new(def)
    vEnv <- as.environment(value)
    selfEnv <- as.environment(.self)
    for (field in names(def at fieldClasses)) {
        if (shallow)
            assign(field, get(field, envir = selfEnv), envir = vEnv)
        else {
            current <- get(field, envir = selfEnv)
            if (is(current, "envRefClass"))
                current <- current$copy(FALSE)
            assign(field, current, envir = vEnv)
        }
    }
    value
}

The basic problem is that you have a list of reference class objects,
and currently copy does not recurse into lists.  I think this could be
fixed with

deep_copy <- function(x) {
  if (is(current, "envRefClass")) {
    x$copy()
  } else if (is.list(x))
    lapply(x, deep_copy)
  } else {
    x
  }
}

function (shallow = FALSE){
    def <- .refClassDef
    value <- new(def)
    vEnv <- as.environment(value)
    selfEnv <- as.environment(.self)
    for (field in names(def at fieldClasses)) {
        if (shallow)
            assign(field, get(field, envir = selfEnv), envir = vEnv)
        else {
            current <- get(field, envir = selfEnv)
            assign(field, deep_copy(current), envir = vEnv)
        }
    }
    value
}

Hadley

2011/5/11 Manuel Castej?n Limas <manuel.castejon at unileon.es>:
> Dear Hadley,
>
> Thank you very much for your interest in the question proposed.
> The Con class is a Reference Class. P and k are from class listCon.
>
> I provide in the following lines a little more detail in order to be able
> to reproduce the case.
>
> #Class declaration
> gCon <- setRefClass("Con", fields=list(from="ANY",weight="numeric"))
> gListAMORE <- setRefClass("listAMORE", fields=list(.Data="list"))
> gListCon <- setRefClass("listCon", contains="listAMORE")
>
> # Let's create a few connections
> con1 <- gCon$new(from=1, weight=1.1)
> con2 <- gCon$new(from=2, weight=2.2)
> con3 <- gCon$new(from=3, weight=3.3)
>
> # And a list of connections
> lcon <-gListCon$new()
> lcon$.Data <- list(con1, con2, con3)
>
> # At this point, lcon contains:
> lcon$.Data
> [[1]]
> An object of class "Con"
> <environment: 0x9a1534>
>
> [[2]]
> An object of class "Con"
> <environment: 0xcd7ff0>
>
> [[3]]
> An object of class "Con"
> <environment: 0xdca724>
>
> # Let's copy lcon to k
> k <- lcon$copy(shallow=FALSE)
>
> # Now k is a new object but the cons are shared with lcon!
> k$.Data
> [[1]]
> An object of class "Con"
> <environment: 0x9a1534>
>
> [[2]]
> An object of class "Con"
> <environment: 0xcd7ff0>
>
> [[3]]
> An object of class "Con"
> <environment: 0xdca724>
>
>
> Best regards
>
> Manuel
>
>
>
> El 11/05/11 14:00, "Hadley Wickham" <hadley at rice.edu> escribi?:
>
>>2011/5/10 Manuel Castej?n Limas <manuel.castejon at unileon.es>:
>>> Dear all,
>>>
>>> I've just discovered the 'Reference Classes'.
>>> In a previous attempt ---a year ago--- to re-implement in a Object
>>>Oriented
>>> fashion the AMORE package using S4 classes I strongly felt the need of
>>>such
>>> capability. It's great to have the Reference Classes now available.
>>>Along
>>> with the discovery of the Rcpp package, this new programming paradigm
>>>has
>>> boosted my interest in rewriting that package.
>>>
>>> Nevertheless, I have found a surprising behavior in the
>>>$copy(shallow=FALSE)
>>> method. Let's have a look at the results which I believe are
>>> self-explanatories. The ".Data" field is a list which contains objects
>>>from
>>> the "Con" class ?---connections for what is worth---.
>>
>>What sort of class is the Con class? S4 or reference?
>>
>>Hadley
>>
>>
>>--
>>Assistant Professor / Dobelman Family Junior Chair
>>Department of Statistics / Rice University
>>http://had.co.nz/
>>
>
>
>
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From pdalgd at gmail.com  Wed May 11 16:30:25 2011
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 11 May 2011 16:30:25 +0200
Subject: [Rd] New code in R-devel: Rao score test for glm.
In-Reply-To: <87hb91s7q6.fsf@stat.ufl.edu>
References: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com>
	<87hb91s7q6.fsf@stat.ufl.edu>
Message-ID: <30B91EC8-25CE-4AB8-BE39-22F529834A50@gmail.com>


On May 11, 2011, at 15:10 , Brett Presnell wrote:

> 
> Thanks for doing this Peter.  I'll have to install the development
> version to try this out.
> 
> One suggestion though.  I'm pretty confident that plain old "score test"
> is a more common terminology than anything involving Rao's name
> (econometricians even call it the Lagrange multiplier test).  In light
> of this, I think that it would be much better to use test = "score"
> rather than test = "Rao".

It's not like that didn't cross my mind, in fact I started out that way, but... 

- A column labeled "score" just looks odd, whereas there is some precedence for labeling tests according to authors (e.g. Pillai). 
- CR Rao is still around, now 90 years of age, and having been taught from "Linear Statistical Inference with Applications", I thought paying a little homage would be appropriate
- At least the curator calls it "Rao score test": http://www.scholarpedia.org/article/Rao_score_test 


> 
> -- 
> Brett Presnell
> Department of Statistics
> University of Florida
> http://www.stat.ufl.edu/~presnell/
> 
> "We don't think that the popularity of an error makes it the truth."
>   -- Richard Stallman
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ehlers at ucalgary.ca  Wed May 11 16:49:49 2011
From: ehlers at ucalgary.ca (Peter Ehlers)
Date: Wed, 11 May 2011 07:49:49 -0700
Subject: [Rd] New code in R-devel: Rao score test for glm.
In-Reply-To: <30B91EC8-25CE-4AB8-BE39-22F529834A50@gmail.com>
References: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com>	<87hb91s7q6.fsf@stat.ufl.edu>
	<30B91EC8-25CE-4AB8-BE39-22F529834A50@gmail.com>
Message-ID: <4DCAA20D.5090806@ucalgary.ca>

On 2011-05-11 07:30, peter dalgaard wrote:
>
> On May 11, 2011, at 15:10 , Brett Presnell wrote:
>
>>
>> Thanks for doing this Peter.  I'll have to install the development
>> version to try this out.
>>
>> One suggestion though.  I'm pretty confident that plain old "score test"
>> is a more common terminology than anything involving Rao's name
>> (econometricians even call it the Lagrange multiplier test).  In light
>> of this, I think that it would be much better to use test = "score"
>> rather than test = "Rao".
>
> It's not like that didn't cross my mind, in fact I started out that way, but...
>
> - A column labeled "score" just looks odd, whereas there is some precedence for labeling tests according to authors (e.g. Pillai).
> - CR Rao is still around, now 90 years of age, and having been taught from "Linear Statistical Inference with Applications", I thought paying a little homage would be appropriate
> - At least the curator calls it "Rao score test": http://www.scholarpedia.org/article/Rao_score_test
>

Yes, thanks, Peter, for coding this test.
As to the name, my vote is for "Rao".

Peter Ehlers

>
>>
>> --
>> Brett Presnell
>> Department of Statistics
>> University of Florida
>> http://www.stat.ufl.edu/~presnell/
>>
>> "We don't think that the popularity of an error makes it the truth."
>>    -- Richard Stallman
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From presnell at stat.ufl.edu  Wed May 11 17:45:51 2011
From: presnell at stat.ufl.edu (Brett Presnell)
Date: Wed, 11 May 2011 11:45:51 -0400
Subject: [Rd] New code in R-devel: Rao score test for glm.
In-Reply-To: <4DCAA20D.5090806@ucalgary.ca> (Peter Ehlers's message of "Wed,
	11 May 2011 07:49:49 -0700")
References: <3B67DBA8-A457-4966-A0E1-A3FA6E6EAF92@gmail.com>
	<87hb91s7q6.fsf@stat.ufl.edu>
	<30B91EC8-25CE-4AB8-BE39-22F529834A50@gmail.com>
	<4DCAA20D.5090806@ucalgary.ca>
Message-ID: <87vcxhmea8.fsf@stat.ufl.edu>


I agree that homage is nice, but I really think you'll get more
confusion from "Rao" than you would from "score".  You could always
label the column some other way, right?  I mean, it doesn't have to be
exactly the same as the option.  FWIW, I also have another vote for
"score" from Alan Agresti, the only other person with whom I've
discussed this.

But I don't want to argue the point any more than that.  It seems right
for the person who wrote the code to have the final say, and I'll be
very happy to have this functionality regardless of how it's called.

Peter Ehlers <ehlers at ucalgary.ca> writes:

> On 2011-05-11 07:30, peter dalgaard wrote:
>>
>> On May 11, 2011, at 15:10 , Brett Presnell wrote:
>>
>>>
>>> Thanks for doing this Peter.  I'll have to install the development
>>> version to try this out.
>>>
>>> One suggestion though.  I'm pretty confident that plain old "score test"
>>> is a more common terminology than anything involving Rao's name
>>> (econometricians even call it the Lagrange multiplier test).  In light
>>> of this, I think that it would be much better to use test = "score"
>>> rather than test = "Rao".
>>
>> It's not like that didn't cross my mind, in fact I started out that way, but...
>>
>> - A column labeled "score" just looks odd, whereas there is some precedence for labeling tests according to authors (e.g. Pillai).
>> - CR Rao is still around, now 90 years of age, and having been taught from "Linear Statistical Inference with Applications", I thought paying a little homage would be appropriate
>> - At least the curator calls it "Rao score test": http://www.scholarpedia.org/article/Rao_score_test
>>
>
> Yes, thanks, Peter, for coding this test.
> As to the name, my vote is for "Rao".
>
> Peter Ehlers


From jmc at r-project.org  Wed May 11 18:32:39 2011
From: jmc at r-project.org (John Chambers)
Date: Wed, 11 May 2011 09:32:39 -0700
Subject: [Rd] Reference Classes copy(shallow=FALSE) unexpected behavior.
In-Reply-To: <BANLkTim4atRJrkBvU6FWqyoEwbsvKurM4A@mail.gmail.com>
References: <BANLkTi=GoqXmLm5y8VKu11=H7jebCG=9DA@mail.gmail.com>
	<C9F048E6.49A8%manuel.castejon@unileon.es>
	<BANLkTim4atRJrkBvU6FWqyoEwbsvKurM4A@mail.gmail.com>
Message-ID: <4DCABA27.2030408@r-project.org>

Good suggestion for this case.

But the general problem is tricky.  What about reference objects 
contained in attributes or slots of other objects, etc?  What is  needed 
for total copying is a switch in the low-level duplication code that 
says to copy reference objects.  It's also possible that one does NOT 
want all such objects copied.

For now, it may be that specialized copy() methods are needed for 
classes that have subsidiary reference objects inside non-reference objects.

John

On 5/11/11 6:37 AM, Hadley Wickham wrote:
> Hi Manuel,
>
> The source code for copy is short and pretty readable, so I'd
> encourage you to look at it:
>
>> setRefClass("XXX")$copy
> Class method definition for method copy()
> function (shallow = FALSE)
> {
>      def<- .refClassDef
>      value<- new(def)
>      vEnv<- as.environment(value)
>      selfEnv<- as.environment(.self)
>      for (field in names(def at fieldClasses)) {
>          if (shallow)
>              assign(field, get(field, envir = selfEnv), envir = vEnv)
>          else {
>              current<- get(field, envir = selfEnv)
>              if (is(current, "envRefClass"))
>                  current<- current$copy(FALSE)
>              assign(field, current, envir = vEnv)
>          }
>      }
>      value
> }
>
> The basic problem is that you have a list of reference class objects,
> and currently copy does not recurse into lists.  I think this could be
> fixed with
>
> deep_copy<- function(x) {
>    if (is(current, "envRefClass")) {
>      x$copy()
>    } else if (is.list(x))
>      lapply(x, deep_copy)
>    } else {
>      x
>    }
> }
>
> function (shallow = FALSE){
>      def<- .refClassDef
>      value<- new(def)
>      vEnv<- as.environment(value)
>      selfEnv<- as.environment(.self)
>      for (field in names(def at fieldClasses)) {
>          if (shallow)
>              assign(field, get(field, envir = selfEnv), envir = vEnv)
>          else {
>              current<- get(field, envir = selfEnv)
>              assign(field, deep_copy(current), envir = vEnv)
>          }
>      }
>      value
> }
>
> Hadley
>
> 2011/5/11 Manuel Castej?n Limas<manuel.castejon at unileon.es>:
>> Dear Hadley,
>>
>> Thank you very much for your interest in the question proposed.
>> The Con class is a Reference Class. P and k are from class listCon.
>>
>> I provide in the following lines a little more detail in order to be able
>> to reproduce the case.
>>
>> #Class declaration
>> gCon<- setRefClass("Con", fields=list(from="ANY",weight="numeric"))
>> gListAMORE<- setRefClass("listAMORE", fields=list(.Data="list"))
>> gListCon<- setRefClass("listCon", contains="listAMORE")
>>
>> # Let's create a few connections
>> con1<- gCon$new(from=1, weight=1.1)
>> con2<- gCon$new(from=2, weight=2.2)
>> con3<- gCon$new(from=3, weight=3.3)
>>
>> # And a list of connections
>> lcon<-gListCon$new()
>> lcon$.Data<- list(con1, con2, con3)
>>
>> # At this point, lcon contains:
>> lcon$.Data
>> [[1]]
>> An object of class "Con"
>> <environment: 0x9a1534>
>>
>> [[2]]
>> An object of class "Con"
>> <environment: 0xcd7ff0>
>>
>> [[3]]
>> An object of class "Con"
>> <environment: 0xdca724>
>>
>> # Let's copy lcon to k
>> k<- lcon$copy(shallow=FALSE)
>>
>> # Now k is a new object but the cons are shared with lcon!
>> k$.Data
>> [[1]]
>> An object of class "Con"
>> <environment: 0x9a1534>
>>
>> [[2]]
>> An object of class "Con"
>> <environment: 0xcd7ff0>
>>
>> [[3]]
>> An object of class "Con"
>> <environment: 0xdca724>
>>
>>
>> Best regards
>>
>> Manuel
>>
>>
>>
>> El 11/05/11 14:00, "Hadley Wickham"<hadley at rice.edu>  escribi?:
>>
>>> 2011/5/10 Manuel Castej?n Limas<manuel.castejon at unileon.es>:
>>>> Dear all,
>>>>
>>>> I've just discovered the 'Reference Classes'.
>>>> In a previous attempt ---a year ago--- to re-implement in a Object
>>>> Oriented
>>>> fashion the AMORE package using S4 classes I strongly felt the need of
>>>> such
>>>> capability. It's great to have the Reference Classes now available.
>>>> Along
>>>> with the discovery of the Rcpp package, this new programming paradigm
>>>> has
>>>> boosted my interest in rewriting that package.
>>>>
>>>> Nevertheless, I have found a surprising behavior in the
>>>> $copy(shallow=FALSE)
>>>> method. Let's have a look at the results which I believe are
>>>> self-explanatories. The ".Data" field is a list which contains objects
>>>> from
>>>> the "Con" class  ---connections for what is worth---.
>>>
>>> What sort of class is the Con class? S4 or reference?
>>>
>>> Hadley
>>>
>>>
>>> --
>>> Assistant Professor / Dobelman Family Junior Chair
>>> Department of Statistics / Rice University
>>> http://had.co.nz/
>>>
>>
>>
>>
>>
>
>
>


From sean.mcguffee at gmail.com  Wed May 11 21:08:27 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Wed, 11 May 2011 15:08:27 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
Message-ID: <C9F056EB.4153%sean.mcguffee@gmail.com>

Hi,
I?m trying to figure out how to put images into my package?s help
documentation. I?ve gotten to the point where I can put the images in the
/inst/doc/ directory. I have also gotten to the point where I have package
checks without any warnings. I couldn?t find the terms ?picture,? ?image,?
or ?graphic? in a text search within the Writing R Extensions: 2 Writing R
documentation files
<http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-documentation-f
iles> 
I tried a couple of LaTeX guesses, but they lead to the following errors on
check:
Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3: unexpected
UNKNOWN '\usepackage'
Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown macro
'\includegraphics'
What is the right way to do this?
Thanks,
Sean
 


From dtenenba at fhcrc.org  Wed May 11 21:13:26 2011
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Wed, 11 May 2011 12:13:26 -0700
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <C9F056EB.4153%sean.mcguffee@gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
Message-ID: <BANLkTikh9pT6R_obDz+a5UzpfrY1cDLmUg@mail.gmail.com>

On Wed, May 11, 2011 at 12:08 PM, Sean Robert McGuffee
<sean.mcguffee at gmail.com> wrote:
> Hi,
> I?m trying to figure out how to put images into my package?s help
> documentation. I?ve gotten to the point where I can put the images in the
> /inst/doc/ directory. I have also gotten to the point where I have package
> checks without any warnings. I couldn?t find the terms ?picture,? ?image,?
> or ?graphic? in a text search within the Writing R Extensions: 2 Writing R
> documentation files
> <http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-documentation-f
> iles>
> I tried a couple of LaTeX guesses, but they lead to the following errors on
> check:
> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3: unexpected
> UNKNOWN '\usepackage'
> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown macro
> '\includegraphics'
> What is the right way to do this?
> Thanks,
> Sean
>

Given a graphics file called foo.png, you can include it in a vignette
as follows:
\includegraphics[width=0.5\textwidth]{foo}

http://amath.colorado.edu/documentation/LaTeX/reference/figures.html
Dan


>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From sean.mcguffee at gmail.com  Wed May 11 21:42:16 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Wed, 11 May 2011 15:42:16 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <BANLkTikh9pT6R_obDz+a5UzpfrY1cDLmUg@mail.gmail.com>
Message-ID: <C9F05ED8.4158%sean.mcguffee@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/c04e17a4/attachment.pl>

From hadley at rice.edu  Wed May 11 21:48:03 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 11 May 2011 14:48:03 -0500
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <C9F056EB.4153%sean.mcguffee@gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
Message-ID: <BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>

> I?m trying to figure out how to put images into my package?s help
> documentation. I?ve gotten to the point where I can put the images in the
> /inst/doc/ directory. I have also gotten to the point where I have package
> checks without any warnings. I couldn?t find the terms ?picture,? ?image,?
> or ?graphic? in a text search within the Writing R Extensions: 2 Writing R
> documentation files

I think you're asking the wrong question.  You should be asking: "Can
I include images in help files?".  As far as I know, the answer is no.

You might be able to do it for specific output formats.  See
http://cran.r-project.org/doc/manuals/R-exts.html#Conditional-text

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From thomas.k.roth at googlemail.com  Wed May 11 22:00:11 2011
From: thomas.k.roth at googlemail.com (Thomas Roth)
Date: Wed, 11 May 2011 22:00:11 +0200
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
Message-ID: <BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/58706e58/attachment.pl>

From simon.urbanek at r-project.org  Wed May 11 22:10:04 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 11 May 2011 16:10:04 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
Message-ID: <FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/859be77a/attachment.pl>

From thomas.k.roth at googlemail.com  Wed May 11 22:16:18 2011
From: thomas.k.roth at googlemail.com (Thomas Roth)
Date: Wed, 11 May 2011 22:16:18 +0200
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
Message-ID: <BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/79ccd8e9/attachment.pl>

From pgilbert at bank-banque-canada.ca  Wed May 11 22:20:36 2011
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 11 May 2011 20:20:36 +0000
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <C9F056EB.4153%sean.mcguffee@gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
Message-ID: <6441154A9FF1CD4386AF4ABF141A056D215A2395@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>

I thought the usual logic was that you might put graphs and images into a vignette, and you might refer to the vignette in an Rd help file, but you would not put the graphs into the help because ? access to the page cannot assume that you actual have a graphics device. Of course, examples in the Rd file can generate the graphs.

Paul

> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of Sean Robert McGuffee
> Sent: May 11, 2011 3:08 PM
> To: r-devel at r-project.org
> Subject: [Rd] How to document man/*.Rd pages with images?
> 
> Hi,
> I?m trying to figure out how to put images into my package?s help
> documentation. I?ve gotten to the point where I can put the images in
> the
> /inst/doc/ directory. I have also gotten to the point where I have
> package
> checks without any warnings. I couldn?t find the terms ?picture,?
> ?image,?
> or ?graphic? in a text search within the Writing R Extensions: 2
> Writing R
> documentation files
> <http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-
> documentation-f
> iles>
> I tried a couple of LaTeX guesses, but they lead to the following
> errors on
> check:
> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3:
> unexpected
> UNKNOWN '\usepackage'
> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown
> macro
> '\includegraphics'
> What is the right way to do this?
> Thanks,
> Sean
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential in...{{dropped:26}}


From simon.urbanek at r-project.org  Wed May 11 22:35:56 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 11 May 2011 16:35:56 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
Message-ID: <1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>


On May 11, 2011, at 4:16 PM, Thomas Roth wrote:

> Well, it takes 5 seconds on a regular notebook... which i have
> 
> Basically there's small simulation going on, so if you don't need any simulation just  a small plot it will go in less then a second. Haven't seen any other solution :-)
> 

Oh, my ... it's worse than I thought. Not only does it run things so you have to wait forever - it actually installs packages behind your back!  Wow, now there is the nightmare abuse of \Sexpr - the malicious package retrieves private data from your machine and deletes your files... and I was worrying about leaving a tiny crack open for Rhttpd injection attacks - yet there is a big gaping door open to all packages ... Does it mean we need more stringent checks on Rd files now as well since they contain code?

What is interesting, though, is that the code gets executed even if html is not the back-end (e.g., in terminal) .. is this a bug? 

Cheers,
S


> it only takes long because there's a simulation going on in the background...
> 
> 2011/5/11 Simon Urbanek <simon.urbanek at r-project.org>
> 
> On May 11, 2011, at 4:00 PM, Thomas Roth wrote:
> 
>> Hi,
>> 
>> There's a possibility to put images into documentation files. Have a look at
>> the package visualizationTools to see how it works. The original idea is/was
>> by Romain Francois as far as i remember.
>> 
>> For instance have a look at the documentation for the function CLT
>> 
> 
> Interesting - ?CLT takes forever (about 30s) on a fairly fast machine (8-core Xeon) - every time! That sort of defeats the purpose of help pages ... so whatever it's doing (behind your back - the help in the console still shows no images, obviously), I would not recommend it as it makes the help unusable.
> 
> Cheers,
> S
> 
> 
>> 
>> 2011/5/11 Hadley Wickham <hadley at rice.edu>
>> 
>>>> I?m trying to figure out how to put images into my package?s help
>>>> documentation. I?ve gotten to the point where I can put the images in the
>>>> /inst/doc/ directory. I have also gotten to the point where I have
>>> package
>>>> checks without any warnings. I couldn?t find the terms ?picture,?
>>> ?image,?
>>>> or ?graphic? in a text search within the Writing R Extensions: 2 Writing
>>> R
>>>> documentation files
>>> 
>>> I think you're asking the wrong question.  You should be asking: "Can
>>> I include images in help files?".  As far as I know, the answer is no.
>>> 
>>> You might be able to do it for specific output formats.  See
>>> http://cran.r-project.org/doc/manuals/R-exts.html#Conditional-text
>>> 
>>> Hadley
>>> 
>>> --
>>> Assistant Professor / Dobelman Family Junior Chair
>>> Department of Statistics / Rice University
>>> http://had.co.nz/
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> 	
>> [[alternative HTML version deleted]]
>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From thomas.k.roth at googlemail.com  Wed May 11 22:43:37 2011
From: thomas.k.roth at googlemail.com (Thomas Roth)
Date: Wed, 11 May 2011 22:43:37 +0200
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
	<1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
Message-ID: <BANLkTimoHj5fpn2R+qpe3xuz2ATwLj9J5A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/cb20c81d/attachment.pl>

From sean.mcguffee at gmail.com  Wed May 11 22:44:56 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Wed, 11 May 2011 16:44:56 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D215A2395@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <C9F06D88.4164%sean.mcguffee@gmail.com>




On 5/11/11 4:20 PM, "Paul Gilbert" <pgilbert at bank-banque-canada.ca> wrote:

> I thought the usual logic was that you might put graphs and images into a
> vignette, and you might refer to the vignette in an Rd help file, but you
> would not put the graphs into the help because ? access to the page cannot
> assume that you actual have a graphics device. Of course, examples in the Rd
> file can generate the graphs.
> 
> Paul

My understanding was that one can require graphics for a package that does
require graphics, right?

> 
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>> project.org] On Behalf Of Sean Robert McGuffee
>> Sent: May 11, 2011 3:08 PM
>> To: r-devel at r-project.org
>> Subject: [Rd] How to document man/*.Rd pages with images?
>> 
>> Hi,
>> I?m trying to figure out how to put images into my package?s help
>> documentation. I?ve gotten to the point where I can put the images in
>> the
>> /inst/doc/ directory. I have also gotten to the point where I have
>> package
>> checks without any warnings. I couldn?t find the terms ?picture,?
>> ?image,?
>> or ?graphic? in a text search within the Writing R Extensions: 2
>> Writing R
>> documentation files
>> <http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-
>> documentation-f
>> iles>
>> I tried a couple of LaTeX guesses, but they lead to the following
>> errors on
>> check:
>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3:
>> unexpected
>> UNKNOWN '\usepackage'
>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown
>> macro
>> '\includegraphics'
>> What is the right way to do this?
>> Thanks,
>> Sean
>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> ==============================================================================
> ======
> 
> La version fran?aise suit le texte anglais.
> 
> ------------------------------------------------------------------------------
> ------
> 
> This email may contain privileged and/or confidential in...{{dropped:26}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From sean.mcguffee at gmail.com  Wed May 11 22:45:41 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Wed, 11 May 2011 16:45:41 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D215A2395@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <C9F06DB5.4165%sean.mcguffee@gmail.com>




On 5/11/11 4:20 PM, "Paul Gilbert" <pgilbert at bank-banque-canada.ca> wrote:

> I thought the usual logic was that you might put graphs and images into a
> vignette, and you might refer to the vignette in an Rd help file, but you
> would not put the graphs into the help because ? access to the page cannot
> assume that you actual have a graphics device. Of course, examples in the Rd
> file can generate the graphs.
> 
> Paul


My understanding was that one can require graphics for a package that does
require graphics, right?

> 
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>> project.org] On Behalf Of Sean Robert McGuffee
>> Sent: May 11, 2011 3:08 PM
>> To: r-devel at r-project.org
>> Subject: [Rd] How to document man/*.Rd pages with images?
>> 
>> Hi,
>> I?m trying to figure out how to put images into my package?s help
>> documentation. I?ve gotten to the point where I can put the images in
>> the
>> /inst/doc/ directory. I have also gotten to the point where I have
>> package
>> checks without any warnings. I couldn?t find the terms ?picture,?
>> ?image,?
>> or ?graphic? in a text search within the Writing R Extensions: 2
>> Writing R
>> documentation files
>> <http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-
>> documentation-f
>> iles>
>> I tried a couple of LaTeX guesses, but they lead to the following
>> errors on
>> check:
>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3:
>> unexpected
>> UNKNOWN '\usepackage'
>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown
>> macro
>> '\includegraphics'
>> What is the right way to do this?
>> Thanks,
>> Sean
>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> ==============================================================================
> ======
> 
> La version fran?aise suit le texte anglais.
> 
> ------------------------------------------------------------------------------
> ------
> 
> This email may contain privileged and/or confidential in...{{dropped:26}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Wed May 11 23:05:47 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 11 May 2011 17:05:47 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <BANLkTimoHj5fpn2R+qpe3xuz2ATwLj9J5A@mail.gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
	<1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
	<BANLkTimoHj5fpn2R+qpe3xuz2ATwLj9J5A@mail.gmail.com>
Message-ID: <8DD73727-7F35-44F4-BD06-1885B7DBB2D7@r-project.org>

On May 11, 2011, at 4:43 PM, Thomas Roth wrote:

> i got the original idea from
> 
> http://romainfrancois.blog.free.fr/index.php?post/2010/04/03/embed-images-in-Rd-documents
> 
> i really won't mind if this is removed. i can put a "clean" package online. Didn't mean to do any harm.
> 

Well, except it does things that the user did not ask for (such as installing packages). Yes, it is "clean" in that the intention was benign, but modifying local file system other than the temporary directory is a transgression - especially since the user doesn't know about it. But it does raise a serious question about "invisible" code -- most R code is visible as the user can look at functions or read examples, but the \Sexpr code is invisible (you have to go to the sources to find out what it does -- admittedly, the same is true for the C/FORTRAN code) and I'm not sure whether it's checked.

Just to reiterate - the other point was that whatever you do, should not hamper the usability and performing a taking 30s to display a help page is doing so. (FWIW it's not the simulation that takes up the time - it's the plotting and since you fixed the seed there is really no point to re-render it -- you can as well do as Paul suggested, just ship the rendered image with the package..)

Cheers,
Simon


> 
> 2011/5/11 Simon Urbanek <simon.urbanek at r-project.org>
> 
> On May 11, 2011, at 4:16 PM, Thomas Roth wrote:
> 
> > Well, it takes 5 seconds on a regular notebook... which i have
> >
> > Basically there's small simulation going on, so if you don't need any simulation just  a small plot it will go in less then a second. Haven't seen any other solution :-)
> >
> 
> Oh, my ... it's worse than I thought. Not only does it run things so you have to wait forever - it actually installs packages behind your back!  Wow, now there is the nightmare abuse of \Sexpr - the malicious package retrieves private data from your machine and deletes your files... and I was worrying about leaving a tiny crack open for Rhttpd injection attacks - yet there is a big gaping door open to all packages ... Does it mean we need more stringent checks on Rd files now as well since they contain code?
> 
> What is interesting, though, is that the code gets executed even if html is not the back-end (e.g., in terminal) .. is this a bug?
> 
> Cheers,
> S
> 
> 
> > it only takes long because there's a simulation going on in the background...
> >
> > 2011/5/11 Simon Urbanek <simon.urbanek at r-project.org>
> >
> > On May 11, 2011, at 4:00 PM, Thomas Roth wrote:
> >
> >> Hi,
> >>
> >> There's a possibility to put images into documentation files. Have a look at
> >> the package visualizationTools to see how it works. The original idea is/was
> >> by Romain Francois as far as i remember.
> >>
> >> For instance have a look at the documentation for the function CLT
> >>
> >
> > Interesting - ?CLT takes forever (about 30s) on a fairly fast machine (8-core Xeon) - every time! That sort of defeats the purpose of help pages ... so whatever it's doing (behind your back - the help in the console still shows no images, obviously), I would not recommend it as it makes the help unusable.
> >
> > Cheers,
> > S
> >
> >
> >>
> >> 2011/5/11 Hadley Wickham <hadley at rice.edu>
> >>
> >>>> I?m trying to figure out how to put images into my package?s help
> >>>> documentation. I?ve gotten to the point where I can put the images in the
> >>>> /inst/doc/ directory. I have also gotten to the point where I have
> >>> package
> >>>> checks without any warnings. I couldn?t find the terms ?picture,?
> >>> ?image,?
> >>>> or ?graphic? in a text search within the Writing R Extensions: 2 Writing
> >>> R
> >>>> documentation files
> >>>
> >>> I think you're asking the wrong question.  You should be asking: "Can
> >>> I include images in help files?".  As far as I know, the answer is no.
> >>>
> >>> You might be able to do it for specific output formats.  See
> >>> http://cran.r-project.org/doc/manuals/R-exts.html#Conditional-text
> >>>
> >>> Hadley
> >>>
> >>> --
> >>> Assistant Professor / Dobelman Family Junior Chair
> >>> Department of Statistics / Rice University
> >>> http://had.co.nz/
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>
> >>
> >>
> >> [[alternative HTML version deleted]]
> >>
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> 
> 


From murdoch.duncan at gmail.com  Wed May 11 23:07:49 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 11 May 2011 17:07:49 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
	<1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
Message-ID: <4DCAFAA5.9050508@gmail.com>

On 11/05/2011 4:35 PM, Simon Urbanek wrote:
>
> On May 11, 2011, at 4:16 PM, Thomas Roth wrote:
>
>> Well, it takes 5 seconds on a regular notebook... which i have
>>
>> Basically there's small simulation going on, so if you don't need any simulation just  a small plot it will go in less then a second. Haven't seen any other solution :-)
>>
>
> Oh, my ... it's worse than I thought. Not only does it run things so you have to wait forever - it actually installs packages behind your back!  Wow, now there is the nightmare abuse of \Sexpr - the malicious package retrieves private data from your machine and deletes your files... and I was worrying about leaving a tiny crack open for Rhttpd injection attacks - yet there is a big gaping door open to all packages ... Does it mean we need more stringent checks on Rd files now as well since they contain code?

I don't think it's any more of a security problem than packages have 
always had, since they can execute arbitrary code when you load them.

> What is interesting, though, is that the code gets executed even if html is not the back-end (e.g., in terminal) .. is this a bug?

The docs say that \Sexpr is evaluated before \if, so probably not...

Duncan Murdoch

>
> Cheers,
> S
>
>
>> it only takes long because there's a simulation going on in the background...
>>
>> 2011/5/11 Simon Urbanek<simon.urbanek at r-project.org>
>>
>> On May 11, 2011, at 4:00 PM, Thomas Roth wrote:
>>
>>> Hi,
>>>
>>> There's a possibility to put images into documentation files. Have a look at
>>> the package visualizationTools to see how it works. The original idea is/was
>>> by Romain Francois as far as i remember.
>>>
>>> For instance have a look at the documentation for the function CLT
>>>
>>
>> Interesting - ?CLT takes forever (about 30s) on a fairly fast machine (8-core Xeon) - every time! That sort of defeats the purpose of help pages ... so whatever it's doing (behind your back - the help in the console still shows no images, obviously), I would not recommend it as it makes the help unusable.
>>
>> Cheers,
>> S
>>
>>
>>>
>>> 2011/5/11 Hadley Wickham<hadley at rice.edu>
>>>
>>>>> I?m trying to figure out how to put images into my package?s help
>>>>> documentation. I?ve gotten to the point where I can put the images in the
>>>>> /inst/doc/ directory. I have also gotten to the point where I have
>>>> package
>>>>> checks without any warnings. I couldn?t find the terms ?picture,?
>>>> ?image,?
>>>>> or ?graphic? in a text search within the Writing R Extensions: 2 Writing
>>>> R
>>>>> documentation files
>>>>
>>>> I think you're asking the wrong question.  You should be asking: "Can
>>>> I include images in help files?".  As far as I know, the answer is no.
>>>>
>>>> You might be able to do it for specific output formats.  See
>>>> http://cran.r-project.org/doc/manuals/R-exts.html#Conditional-text
>>>>
>>>> Hadley
>>>>
>>>> --
>>>> Assistant Professor / Dobelman Family Junior Chair
>>>> Department of Statistics / Rice University
>>>> http://had.co.nz/
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> 	
>>> [[alternative HTML version deleted]]
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Wed May 11 23:11:09 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 11 May 2011 17:11:09 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <C9F06DB5.4165%sean.mcguffee@gmail.com>
References: <C9F06DB5.4165%sean.mcguffee@gmail.com>
Message-ID: <4DCAFB6D.2040006@gmail.com>

On 11/05/2011 4:45 PM, Sean Robert McGuffee wrote:
>
>
>
> On 5/11/11 4:20 PM, "Paul Gilbert"<pgilbert at bank-banque-canada.ca>  wrote:
>
>> I thought the usual logic was that you might put graphs and images into a
>> vignette, and you might refer to the vignette in an Rd help file, but you
>> would not put the graphs into the help because ? access to the page cannot
>> assume that you actual have a graphics device. Of course, examples in the Rd
>> file can generate the graphs.
>>
>> Paul
>
>
> My understanding was that one can require graphics for a package that does
> require graphics, right?

No, there's no simple way to require particular hardware, or particular 
user options (e.g. options(help_type="text") would mean no HTML).  The 
startup code for a package might be able to check for the hardware and 
abort if it is unavailable, but a user could change help type at any time.

Duncan Murdoch

>
>>
>>> -----Original Message-----
>>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
>>> project.org] On Behalf Of Sean Robert McGuffee
>>> Sent: May 11, 2011 3:08 PM
>>> To: r-devel at r-project.org
>>> Subject: [Rd] How to document man/*.Rd pages with images?
>>>
>>> Hi,
>>> I?m trying to figure out how to put images into my package?s help
>>> documentation. I?ve gotten to the point where I can put the images in
>>> the
>>> /inst/doc/ directory. I have also gotten to the point where I have
>>> package
>>> checks without any warnings. I couldn?t find the terms ?picture,?
>>> ?image,?
>>> or ?graphic? in a text search within the Writing R Extensions: 2
>>> Writing R
>>> documentation files
>>> <http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-
>>> documentation-f
>>> iles>
>>> I tried a couple of LaTeX guesses, but they lead to the following
>>> errors on
>>> check:
>>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3:
>>> unexpected
>>> UNKNOWN '\usepackage'
>>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown
>>> macro
>>> '\includegraphics'
>>> What is the right way to do this?
>>> Thanks,
>>> Sean
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ==============================================================================
>> ======
>>
>> La version fran?aise suit le texte anglais.
>>
>> ------------------------------------------------------------------------------
>> ------
>>
>> This email may contain privileged and/or confidential in...{{dropped:26}}
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From thomas.k.roth at googlemail.com  Wed May 11 23:16:27 2011
From: thomas.k.roth at googlemail.com (Thomas Roth)
Date: Wed, 11 May 2011 23:16:27 +0200
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <8DD73727-7F35-44F4-BD06-1885B7DBB2D7@r-project.org>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
	<1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
	<BANLkTimoHj5fpn2R+qpe3xuz2ATwLj9J5A@mail.gmail.com>
	<8DD73727-7F35-44F4-BD06-1885B7DBB2D7@r-project.org>
Message-ID: <BANLkTik5GHGqCOuj-RYMHOtiZeY3Z+cV=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/d87fa7b9/attachment.pl>

From hadley at rice.edu  Wed May 11 23:31:18 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 11 May 2011 16:31:18 -0500
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
	<1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
Message-ID: <BANLkTikdSNdr9R7SaqGk+ty9GnWEaxCDcw@mail.gmail.com>

> Oh, my ... it's worse than I thought. Not only does it run things so you have to wait forever - it actually installs packages behind your back! ?Wow, now there is the nightmare abuse of \Sexpr - the malicious package retrieves private data from your machine and deletes your files... and I was worrying about leaving a tiny crack open for Rhttpd injection attacks - yet there is a big gaping door open to all packages ... Does it mean we need more stringent checks on Rd files now as well since they contain code?

As long as you realise Rd files can run arbitrary R code, you're no
worse off than you were before Rd files could run code.  No one is
checking that there's not a function in ggplot2 that secretly sends me
all your code and data ;)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Wed May 11 23:33:39 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 11 May 2011 16:33:39 -0500
Subject: [Rd] Reference Classes copy(shallow=FALSE) unexpected behavior.
In-Reply-To: <4DCABA27.2030408@r-project.org>
References: <BANLkTi=GoqXmLm5y8VKu11=H7jebCG=9DA@mail.gmail.com>
	<C9F048E6.49A8%manuel.castejon@unileon.es>
	<BANLkTim4atRJrkBvU6FWqyoEwbsvKurM4A@mail.gmail.com>
	<4DCABA27.2030408@r-project.org>
Message-ID: <BANLkTikBMeJM1g-Grn+WM_VKsw2DV4cDuA@mail.gmail.com>

> But the general problem is tricky. ?What about reference objects contained
> in attributes or slots of other objects, etc? ?What is ?needed for total
> copying is a switch in the low-level duplication code that says to copy
> reference objects. ?It's also possible that one does NOT want all such
> objects copied.

Good point.  I wonder what other languages do? And in fact, are there
any other languages that mix mutable and non-mutable objects in this
way?

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From pgilbert at bank-banque-canada.ca  Wed May 11 23:45:05 2011
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 11 May 2011 21:45:05 +0000
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <BANLkTikdSNdr9R7SaqGk+ty9GnWEaxCDcw@mail.gmail.com>
References: <C9F056EB.4153%sean.mcguffee@gmail.com>
	<BANLkTinGiKMURAWGxppQE=d3n4a8tBADoA@mail.gmail.com>
	<BANLkTikGWmpkyi3nQPBtTuAXaA-X9_3E3w@mail.gmail.com>
	<FF125FB4-5E81-4282-8970-ECBFA4C5598B@r-project.org>
	<BANLkTin4R7JERZWZ+myq5e4HDVWbJSD5wg@mail.gmail.com>
	<1E65C09B-3C63-47C3-8EF6-2FCE13F61F15@r-project.org>
	<BANLkTikdSNdr9R7SaqGk+ty9GnWEaxCDcw@mail.gmail.com>
Message-ID: <6441154A9FF1CD4386AF4ABF141A056D215A2421@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>

> No one is
> checking that there's not a function in ggplot2 that secretly sends me
> all your code and data ;)

Well, it is open source so we could check it.  Hopefully you are checking this yourself, because it would be a criminal offense to do that. ;)

Paul
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential information, and the Bank of
Canada does not waive any related rights. Any distribution, use, or copying of this
email or the information it contains by other than the intended recipient is
unauthorized. If you received this email in error please delete it immediately from
your system and notify the sender promptly by email that you have done so. 

------------------------------------------------------------------------------------

Le pr?sent courriel peut contenir de l'information privil?gi?e ou confidentielle.
La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute diffusion,
utilisation ou copie de ce courriel ou des renseignements qu'il contient par une
personne autre que le ou les destinataires d?sign?s est interdite. Si vous recevez
ce courriel par erreur, veuillez le supprimer imm?diatement et envoyer sans d?lai ?
l'exp?diteur un message ?lectronique pour l'aviser que vous avez ?limin? de votre
ordinateur toute copie du courriel re?u.

From sean.mcguffee at gmail.com  Thu May 12 01:14:47 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Wed, 11 May 2011 19:14:47 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <6441154A9FF1CD4386AF4ABF141A056D215A2421@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>
Message-ID: <C9F090A7.4174%sean.mcguffee@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110511/866b4ec2/attachment.pl>

From mailinglist.honeypot at gmail.com  Wed May 11 22:00:12 2011
From: mailinglist.honeypot at gmail.com (Steve Lianoglou)
Date: Wed, 11 May 2011 16:00:12 -0400
Subject: [Rd] How to document man/*.Rd pages with images?
In-Reply-To: <C9F05ED8.4158%sean.mcguffee@gmail.com>
References: <BANLkTikh9pT6R_obDz+a5UzpfrY1cDLmUg@mail.gmail.com>
	<C9F05ED8.4158%sean.mcguffee@gmail.com>
Message-ID: <BANLkTimgHbDmCu_aR=1feKUWc6wBNxSS+Q@mail.gmail.com>

Hi,

On Wed, May 11, 2011 at 3:42 PM, Sean Robert McGuffee
<sean.mcguffee at gmail.com> wrote:
>
>
>
> On 5/11/11 3:13 PM, "Dan Tenenbaum" <dtenenba at fhcrc.org> wrote:
>
>> On Wed, May 11, 2011 at 12:08 PM, Sean Robert McGuffee
>> <sean.mcguffee at gmail.com> wrote:
>>> Hi,
>>> I?m trying to figure out how to put images into my package?s help
>>> documentation. I?ve gotten to the point where I can put the images in the
>>> /inst/doc/ directory. I have also gotten to the point where I have package
>>> checks without any warnings. I couldn?t find the terms ?picture,? ?image,?
>>> or ?graphic? in a text search within the Writing R Extensions: 2 Writing R
>>> documentation files
>>> <http://cran.r-project.org/doc/manuals/R-exts.html#Writing-R-documentation-f
>>> iles>
>>> I tried a couple of LaTeX guesses, but they lead to the following errors on
>>> check:
>>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:3: unexpected
>>> UNKNOWN '\usepackage'
>>> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:36: unknown macro
>>> '\includegraphics'
>>> What is the right way to do this?
>>> Thanks,
>>> Sean
>>>
>>
>> Given a graphics file called foo.png, you can include it in a vignette
>> as follows:
>> \includegraphics[width=0.5\textwidth]{foo}
>
> I've tried adding this in a man/*.Rd file, but I get the following warning:
> Warning: /LAB/SRM/PROGS/R_PACKAGES/Ralign/man/Ralign139.Rd:16: unknown macro
> '\includegraphics'
> In particular, I put
> \includegraphics{../doc/Sean.jpg}
> inside a \details{} section.
> It seems that the term "vignette" may somehow be different than the man/*.Rd
> files. As is somewhat typical of the R documentation, there is a whole
> section on 1.4 Writing package vignettes without a definition of "vignette"
> as far as I can tell.

Think of vignettes as "tutorials" you include in your package to show
how consumers of your package can use it in different ways ..
something like an advertisement of how cool your package really is,
which is a bit harder for a user to appreciate by just browsing a list
of function documentation (which the *.Rd files generate).

As you are suspecting, they are indeed different than the help files
that pop up via the ?myFunction route.

> I want to clarify that I'm trying to put the images in
> a file that will come up when I type ??myPackageName or
> library(myPackageName);help(myPackageName).

I actually don't believe you can do this.

> I'm not sure if that's the same as a vignette or not,

They are not the same.

A good source to learn more about what you might use vignettes for are
the bioconductor packages. All bioconductor packages are required
(strongly encouraged(?)) to include vignettes. For example, look at
their ShortRead package:

http://www.bioconductor.org/packages/release/bioc/html/ShortRead.html

In the "Documentation" section, you will find two vignettes there,
both of which include pictures embedded in them.

I can see how including pics in the function documentation can also be
helpful. An alternative is to have the pictures that you would include
in these files be generated by the code in the "Examples" section of
your function documentation, so that the user can do:

R> example(yourFunction)

And have R produce the plots "live".

> [some quote grooming]
> I literally have everything
> I need working in man/*.Rd files except image references. Do I have to learn
> about vignettes now after all that work to get the man/*.Rd files going?

Only if you want to embed images in some type of documentation.

They're more or less ordinary LaTeX files that you can embed R code
into. Very handy to know how to use, actually, even outside of the
"Package Authoring" context, so ... perhaps you can consider it as
good exercise if you decide to take it on :-)

But again, you can always go the other route I proposed, which is to
have your Example code generate these plots on the fly.

In hopes of saving you some time, to go the "Example route," it is
often helpful to include a small example dataset in your package that
your Example code can load and work off of.

Hope that helps,

-steve

-- 
Steve Lianoglou
Graduate Student: Computational Systems Biology
?| Memorial Sloan-Kettering Cancer Center
?| Weill Medical College of Cornell University
Contact Info: http://cbio.mskcc.org/~lianos/contact


From Stefan.Hoj-Edwards at agrsci.dk  Wed May 11 14:07:26 2011
From: Stefan.Hoj-Edwards at agrsci.dk (=?iso-8859-1?Q?Stefan_McKinnon_H=F8j-Edwards?=)
Date: Wed, 11 May 2011 14:07:26 +0200
Subject: [Rd] RCMD check fails on "checkin installed package size"
In-Reply-To: <alpine.LFD.2.02.1105111247140.8673@toucan.stats.ox.ac.uk>
References: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>
	<alpine.LFD.2.02.1105111247140.8673@toucan.stats.ox.ac.uk>
Message-ID: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F8A3@DJFEXMBX01.djf.agrsci.dk>

Thanks. It worked.
I added the line "_R_CHECK_PKG_SIZES_=no" to /etc/Rcmd_environ (I am the only user of this computer).

Regarding the 'du' executable, it is found in the first directory in the PATH environment variable and came with Rtools for R 2.13.

Kind regards,
Stefan McKinnon H?j-Edwards
PhD student
Dept. of Genetics and Biotechnology
Faculty of Agricultural Sciences
Aarhus University
Blichers All? 20, Postboks 50
DK-8830?Tjele

Tel.: +45 8999 1291
Email: stefanm.edwards at agrsci.dk

Tel.: +45 8999 1900
Web: www.agrsci.au.dk




-----Oprindelig meddelelse-----
Fra: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sendt: 11. maj 2011 13:51
Til: Stefan McKinnon H?j-Edwards
Cc: r-devel at r-project.org
Emne: Re: [Rd] RCMD check fails on "checkin installed package size"

On Wed, 11 May 2011, Stefan McKinnon H?j-Edwards wrote:

> Hi,
>
> When I run RCMD check on my package, I receive the following error:
> C:\R-packages\AnnotationFuncs>RCMD check --no-vignettes AnnotationFuncs
> * using log directory 'C:/R-packages/AnnotationFuncs/AnnotationFuncs.Rcheck'
> * using R version 2.13.0 (2011-04-13)
> * using platform: i386-pc-mingw32 (32-bit)
> * using session charset: ISO8859-1
> * using option '--no-vignettes'
> * checking for file 'AnnotationFuncs/DESCRIPTION' ... OK
> * this is package 'AnnotationFuncs' version '1.1.2'
> * checking package name space information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking for executable files ... OK
> * checking whether package 'AnnotationFuncs' can be installed ... OK
> * checking installed package size ...Error in if (total > 1024 * 5) { : missing
> value where TRUE/FALSE needed
> Execution halted
>
>
> I am running it on Windows 7 (32-bit) and my PATH environment variable starts with this:
> C:\Rtools\bin;C:\Rtools\MinGW\bin;C:\Program Files\R\R-2.13.0\bin\i386;
>
> I have updated Rtools to the newest with 2.13.
>
> Any suggestions?

Set _R_CHECK_PKG_SIZES_ to 'no' (see 'Writing R Extensions' and its 
references on customizing R CMD check), or correct your paths so the 
'du' program in Rtools is the one that is found.  (The only reported 
example was from using a different 'du' program.)

I believe that current R-patched works around this: R-devel definitely 
does.

>
> Thanks in advanced,
> Stefan McKinnon H?j-Edwards
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From manuel.castejon at unileon.es  Wed May 11 14:27:39 2011
From: manuel.castejon at unileon.es (Manuel =?ISO-8859-1?B?Q2FzdGVq824=?= Limas)
Date: Wed, 11 May 2011 14:27:39 +0200
Subject: [Rd] Reference Classes copy(shallow=FALSE) unexpected behavior.
In-Reply-To: <BANLkTi=GoqXmLm5y8VKu11=H7jebCG=9DA@mail.gmail.com>
Message-ID: <C9F048E6.49A8%manuel.castejon@unileon.es>

Dear Hadley,

Thank you very much for your interest in the question proposed.
The Con class is a Reference Class. P and k are from class listCon.

I provide in the following lines a little more detail in order to be able
to reproduce the case.

#Class declaration
gCon <- setRefClass("Con", fields=list(from="ANY",weight="numeric"))
gListAMORE <- setRefClass("listAMORE", fields=list(.Data="list"))
gListCon <- setRefClass("listCon", contains="listAMORE")

# Let's create a few connections
con1 <- gCon$new(from=1, weight=1.1)
con2 <- gCon$new(from=2, weight=2.2)
con3 <- gCon$new(from=3, weight=3.3)

# And a list of connections
lcon <-gListCon$new()
lcon$.Data <- list(con1, con2, con3)

# At this point, lcon contains:
lcon$.Data
[[1]]
An object of class "Con"
<environment: 0x9a1534>

[[2]]
An object of class "Con"
<environment: 0xcd7ff0>

[[3]]
An object of class "Con"
<environment: 0xdca724>

# Let's copy lcon to k
k <- lcon$copy(shallow=FALSE)

# Now k is a new object but the cons are shared with lcon!
k$.Data
[[1]]
An object of class "Con"
<environment: 0x9a1534>

[[2]]
An object of class "Con"
<environment: 0xcd7ff0>

[[3]]
An object of class "Con"
<environment: 0xdca724>


Best regards

Manuel



El 11/05/11 14:00, "Hadley Wickham" <hadley at rice.edu> escribi?:

>2011/5/10 Manuel Castej?n Limas <manuel.castejon at unileon.es>:
>> Dear all,
>>
>> I've just discovered the 'Reference Classes'.
>> In a previous attempt ---a year ago--- to re-implement in a Object
>>Oriented
>> fashion the AMORE package using S4 classes I strongly felt the need of
>>such
>> capability. It's great to have the Reference Classes now available.
>>Along
>> with the discovery of the Rcpp package, this new programming paradigm
>>has
>> boosted my interest in rewriting that package.
>>
>> Nevertheless, I have found a surprising behavior in the
>>$copy(shallow=FALSE)
>> method. Let's have a look at the results which I believe are
>> self-explanatories. The ".Data" field is a list which contains objects
>>from
>> the "Con" class  ---connections for what is worth---.
>
>What sort of class is the Con class? S4 or reference?
>
>Hadley
>
>
>-- 
>Assistant Professor / Dobelman Family Junior Chair
>Department of Statistics / Rice University
>http://had.co.nz/
>


From manuel.castejon at unileon.es  Wed May 11 23:24:09 2011
From: manuel.castejon at unileon.es (Manuel =?ISO-8859-1?B?Q2FzdGVq824=?= Limas)
Date: Wed, 11 May 2011 23:24:09 +0200
Subject: [Rd] Reference Classes copy(shallow=FALSE) unexpected behavior.
In-Reply-To: <4DCABA27.2030408@r-project.org>
Message-ID: <C9F0C90F.49F8%manuel.castejon@unileon.es>

Dear Hadley and John,

My main interest in the question was to understand what was happening.
Thank you very much for your clarifications and the piece of code.


Manuel


El 11/05/11 18:32, "John Chambers" <jmc at r-project.org> escribi?:

>Good suggestion for this case.
>
>But the general problem is tricky.  What about reference objects
>contained in attributes or slots of other objects, etc?  What is  needed
>for total copying is a switch in the low-level duplication code that
>says to copy reference objects.  It's also possible that one does NOT
>want all such objects copied.
>
>For now, it may be that specialized copy() methods are needed for
>classes that have subsidiary reference objects inside non-reference
>objects.
>
>John
>
>On 5/11/11 6:37 AM, Hadley Wickham wrote:
>> Hi Manuel,
>>
>> The source code for copy is short and pretty readable, so I'd
>> encourage you to look at it:
>>
>>> setRefClass("XXX")$copy
>> Class method definition for method copy()
>> function (shallow = FALSE)
>> {
>>      def<- .refClassDef
>>      value<- new(def)
>>      vEnv<- as.environment(value)
>>      selfEnv<- as.environment(.self)
>>      for (field in names(def at fieldClasses)) {
>>          if (shallow)
>>              assign(field, get(field, envir = selfEnv), envir = vEnv)
>>          else {
>>              current<- get(field, envir = selfEnv)
>>              if (is(current, "envRefClass"))
>>                  current<- current$copy(FALSE)
>>              assign(field, current, envir = vEnv)
>>          }
>>      }
>>      value
>> }
>>
>> The basic problem is that you have a list of reference class objects,
>> and currently copy does not recurse into lists.  I think this could be
>> fixed with
>>
>> deep_copy<- function(x) {
>>    if (is(current, "envRefClass")) {
>>      x$copy()
>>    } else if (is.list(x))
>>      lapply(x, deep_copy)
>>    } else {
>>      x
>>    }
>> }
>>
>> function (shallow = FALSE){
>>      def<- .refClassDef
>>      value<- new(def)
>>      vEnv<- as.environment(value)
>>      selfEnv<- as.environment(.self)
>>      for (field in names(def at fieldClasses)) {
>>          if (shallow)
>>              assign(field, get(field, envir = selfEnv), envir = vEnv)
>>          else {
>>              current<- get(field, envir = selfEnv)
>>              assign(field, deep_copy(current), envir = vEnv)
>>          }
>>      }
>>      value
>> }
>>
>> Hadley
>>
>> 2011/5/11 Manuel Castej?n Limas<manuel.castejon at unileon.es>:
>>> Dear Hadley,
>>>
>>> Thank you very much for your interest in the question proposed.
>>> The Con class is a Reference Class. P and k are from class listCon.
>>>
>>> I provide in the following lines a little more detail in order to be
>>>able
>>> to reproduce the case.
>>>
>>> #Class declaration
>>> gCon<- setRefClass("Con", fields=list(from="ANY",weight="numeric"))
>>> gListAMORE<- setRefClass("listAMORE", fields=list(.Data="list"))
>>> gListCon<- setRefClass("listCon", contains="listAMORE")
>>>
>>> # Let's create a few connections
>>> con1<- gCon$new(from=1, weight=1.1)
>>> con2<- gCon$new(from=2, weight=2.2)
>>> con3<- gCon$new(from=3, weight=3.3)
>>>
>>> # And a list of connections
>>> lcon<-gListCon$new()
>>> lcon$.Data<- list(con1, con2, con3)
>>>
>>> # At this point, lcon contains:
>>> lcon$.Data
>>> [[1]]
>>> An object of class "Con"
>>> <environment: 0x9a1534>
>>>
>>> [[2]]
>>> An object of class "Con"
>>> <environment: 0xcd7ff0>
>>>
>>> [[3]]
>>> An object of class "Con"
>>> <environment: 0xdca724>
>>>
>>> # Let's copy lcon to k
>>> k<- lcon$copy(shallow=FALSE)
>>>
>>> # Now k is a new object but the cons are shared with lcon!
>>> k$.Data
>>> [[1]]
>>> An object of class "Con"
>>> <environment: 0x9a1534>
>>>
>>> [[2]]
>>> An object of class "Con"
>>> <environment: 0xcd7ff0>
>>>
>>> [[3]]
>>> An object of class "Con"
>>> <environment: 0xdca724>
>>>
>>>
>>> Best regards
>>>
>>> Manuel
>>>
>>>
>>>
>>> El 11/05/11 14:00, "Hadley Wickham"<hadley at rice.edu>  escribi?:
>>>
>>>> 2011/5/10 Manuel Castej?n Limas<manuel.castejon at unileon.es>:
>>>>> Dear all,
>>>>>
>>>>> I've just discovered the 'Reference Classes'.
>>>>> In a previous attempt ---a year ago--- to re-implement in a Object
>>>>> Oriented
>>>>> fashion the AMORE package using S4 classes I strongly felt the need
>>>>>of
>>>>> such
>>>>> capability. It's great to have the Reference Classes now available.
>>>>> Along
>>>>> with the discovery of the Rcpp package, this new programming paradigm
>>>>> has
>>>>> boosted my interest in rewriting that package.
>>>>>
>>>>> Nevertheless, I have found a surprising behavior in the
>>>>> $copy(shallow=FALSE)
>>>>> method. Let's have a look at the results which I believe are
>>>>> self-explanatories. The ".Data" field is a list which contains
>>>>>objects
>>>>> from
>>>>> the "Con" class  ---connections for what is worth---.
>>>>
>>>> What sort of class is the Con class? S4 or reference?
>>>>
>>>> Hadley
>>>>
>>>>
>>>> --
>>>> Assistant Professor / Dobelman Family Junior Chair
>>>> Department of Statistics / Rice University
>>>> http://had.co.nz/
>>>>
>>>
>>>
>>>
>>>
>>
>>
>>


From ripley at stats.ox.ac.uk  Thu May 12 12:13:27 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 12 May 2011 11:13:27 +0100 (BST)
Subject: [Rd] raw connections: reading does not alter current position
 pointer
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D700042B926D@NA-PA-VBE03.na.tibco.com>
References: <77EB52C6DD32BA4D87471DCD70C8D700042B926D@NA-PA-VBE03.na.tibco.com>
Message-ID: <alpine.LFD.2.02.1105121112310.4428@gannet.stats.ox.ac.uk>

I am not the author, but looking at the code shows that raw_read has a 
line missing compared to raw_write.

It should work now in R-devel/R-patched.

Thanks for the report.

On Mon, 2 May 2011, William Dunlap wrote:

> Am I misunderstanding rawConnections here or are
> rawConnections not working right yet?  It looks
> like I can use seek() to position the read pointer
> but readBin does not position the read pointer past
> what has just been read.
>
>  > myRawTen <- as.raw(101:110)
>  > str(myRawTen)
>   raw [1:10] 65 66 67 68 ...
>  > rawToChar(myRawTen)
>  [1] "efghijklmn"
>  > myRawTenCon <- rawConnection(myRawTen)
>  > readBin(myRawTenCon, what="integer", size=2, n=1)
>  [1] 26213
>  > c(26213%%256, 26213%/%256)
>  [1] 101 102
>  > # next 2-byte integer should be 104*256 + 103 = 26727
>  > readBin(myRawTenCon, what="integer", size=2, n=1)
>  [1] 26213
>  > # if I seek() explicitly it works
>  > seek(myRawTenCon, 2)
>  [1] 6
>  > readBin(myRawTenCon, what="integer", size=2, n=1)
>  [1] 26727
>
>  > seek(myRawTenCon, 6) # look at last 4 bytes: 107:110
>  [1] 0
>  > # multiple reads in one call to readBin do not advance
>  > # the position pointer:
>  > readBin(myRawTenCon, what="integer", size=1, n=4)
>  [1] 107 107 107 107
>
>  > sessionInfo()
>  R version 2.13.0 (2011-04-13)
>  Platform: i386-pc-mingw32/i386 (32-bit)
>
>  locale:
>  [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252    LC_MONETARY=English_United States.1252
>  [4] LC_NUMERIC=C                           LC_TIME=English_United
> States.1252
>
>  attached base packages:
>  [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>  other attached packages:
>  [1] lattice_0.19-23 MASS_7.3-12
>
>  loaded via a namespace (and not attached):
>  [1] compiler_2.13.0 grid_2.13.0     tools_2.13.0
>
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Thu May 12 14:11:25 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 12 May 2011 08:11:25 -0400
Subject: [Rd] RCMD check fails on "checkin installed package size"
In-Reply-To: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F8A3@DJFEXMBX01.djf.agrsci.dk>
References: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>	<alpine.LFD.2.02.1105111247140.8673@toucan.stats.ox.ac.uk>
	<1C56F3EE22DF4F458FE02F58B96D4150555EA9F8A3@DJFEXMBX01.djf.agrsci.dk>
Message-ID: <4DCBCE6D.1050100@gmail.com>

On 11/05/2011 8:07 AM, Stefan McKinnon H?j-Edwards wrote:
> Thanks. It worked.
> I added the line "_R_CHECK_PKG_SIZES_=no" to /etc/Rcmd_environ (I am the only user of this computer).
>
> Regarding the 'du' executable, it is found in the first directory in the PATH environment variable and came with Rtools for R 2.13.

R CMD check will try to run "du -k" while the current directory is the 
one where it just installed the package during the check.  If you do 
that from the command line, (i.e. install AnnotationFuncs, switch to 
RHOME/library/AnnotationFuncs, and run "du -k") what do you see as output?

Duncan Murdoch
> Kind regards,
> Stefan McKinnon H?j-Edwards
> PhD student
> Dept. of Genetics and Biotechnology
> Faculty of Agricultural Sciences
> Aarhus University
> Blichers All? 20, Postboks 50
> DK-8830 Tjele
>
> Tel.: +45 8999 1291
> Email: stefanm.edwards at agrsci.dk
>
> Tel.: +45 8999 1900
> Web: www.agrsci.au.dk
>
>
>
>
> -----Oprindelig meddelelse-----
> Fra: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Sendt: 11. maj 2011 13:51
> Til: Stefan McKinnon H?j-Edwards
> Cc: r-devel at r-project.org
> Emne: Re: [Rd] RCMD check fails on "checkin installed package size"
>
> On Wed, 11 May 2011, Stefan McKinnon H?j-Edwards wrote:
>
> >  Hi,
> >
> >  When I run RCMD check on my package, I receive the following error:
> >  C:\R-packages\AnnotationFuncs>RCMD check --no-vignettes AnnotationFuncs
> >  * using log directory 'C:/R-packages/AnnotationFuncs/AnnotationFuncs.Rcheck'
> >  * using R version 2.13.0 (2011-04-13)
> >  * using platform: i386-pc-mingw32 (32-bit)
> >  * using session charset: ISO8859-1
> >  * using option '--no-vignettes'
> >  * checking for file 'AnnotationFuncs/DESCRIPTION' ... OK
> >  * this is package 'AnnotationFuncs' version '1.1.2'
> >  * checking package name space information ... OK
> >  * checking package dependencies ... OK
> >  * checking if this is a source package ... OK
> >  * checking for executable files ... OK
> >  * checking whether package 'AnnotationFuncs' can be installed ... OK
> >  * checking installed package size ...Error in if (total>  1024 * 5) { : missing
> >  value where TRUE/FALSE needed
> >  Execution halted
> >
> >
> >  I am running it on Windows 7 (32-bit) and my PATH environment variable starts with this:
> >  C:\Rtools\bin;C:\Rtools\MinGW\bin;C:\Program Files\R\R-2.13.0\bin\i386;
> >
> >  I have updated Rtools to the newest with 2.13.
> >
> >  Any suggestions?
>
> Set _R_CHECK_PKG_SIZES_ to 'no' (see 'Writing R Extensions' and its
> references on customizing R CMD check), or correct your paths so the
> 'du' program in Rtools is the one that is found.  (The only reported
> example was from using a different 'du' program.)
>
> I believe that current R-patched works around this: R-devel definitely
> does.
>
> >
> >  Thanks in advanced,
> >  Stefan McKinnon H?j-Edwards
> >
> >  ______________________________________________
> >  R-devel at r-project.org mailing list
> >  https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>


From alex at bedatadriven.com  Thu May 12 14:25:56 2011
From: alex at bedatadriven.com (Bertram, Alexander)
Date: Thu, 12 May 2011 14:25:56 +0200
Subject: [Rd] Renjin - R for the JVM - new milestone released
Message-ID: <BANLkTikYtxGKKQnppQHiPbTFfzALfM6i5g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110512/1e5e76f3/attachment.pl>

From simon.urbanek at r-project.org  Thu May 12 15:13:20 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 12 May 2011 09:13:20 -0400
Subject: [Rd] R html help system [Was: How to document man/*.Rd pages with
	images?]
In-Reply-To: <C9F090A7.4174%sean.mcguffee@gmail.com>
References: <C9F090A7.4174%sean.mcguffee@gmail.com>
Message-ID: <56C958F1-C50C-4ABB-84BB-160207F8F190@r-project.org>

I just want to clarify the mechanics of the help system when using html.

R has a built-in HTTP server (aka Rhttpd) which transforms HTTP requests to function calls. It is not your usual web server, because it doesn't map URL paths to files, it just allows R functions to do anything with it -- something like CGI except that we are talking about functions and not files. Therefore you won't find any files and there is no file structure involved.

For the help system, the function handling the requests is tools:::httpd() - you can look at what it does. Basically, it generates pages according to the various paths it supports. As part of its path handling it allows certain paths to reference files, e.g. /library/myPackage/doc/randomStuffInPackagesDocDirectory.html will read the file doc/randomStuffInPackagesDocDirectory.html in myPackage.

Note that the whole point of the dynamic help *is* to generate content on the fly, because the content depends on the state of your current workspace -- packages loaded, classes defined, etc. so you cannot pre-generate pages as they won't have correct links - that's why we shifted from static html pages to the dynamic ones.


I'm curious about "If it?s a large picture this process nearly crashes my machine when trying to access the file via help" - do you have an example package that would illustrate the problem?

Thanks,
Simon


On May 11, 2011, at 7:14 PM, Sean Robert McGuffee wrote:

> Thanks everyone for your help,
> 
> To summarize a resolution to my issue, it turns out that an image can be include in a documentation file via html by putting an image file in the inst/doc directory, for example inst/doc/myPic.png, and then pointing to it in the man/myHelpPage.Rd file, for example as follows:
> 
> \if{html}{
> \out{<img src="../doc/myPic.png" alt="image ../doc/myPic.png should be here"/>}
> }\ifelse{latex}{}{}
> 
> Note, this doesn?t mean that R?s help browser will view those images inside the properly generated html help files.
> Also, note that without the \out{} part, the text of the <img .../>  line would show up instead of the html commands. 
>  
> I have some concerns incase anyone on the list is interested. If it?s a large picture this process nearly crashes my machine when trying to access the file via help?and I?m sure there must be some bug in that. I should note that the picture won?t actually display within R?s help console (at least on my machine--I?m on a mac with a binary version of R). To see that the html files are created properly, I have to copy a link to the help file and then point an actual browser such as firefox to the help file to see the page with the image. I?m not sure how R is running httpd or how that interacts with help. I?m not even sure about the basics of help. Is there a way to configure R to use an actual web browser by default instead of it?s slow one that doesn?t show images? It would also be nice if there were an address bar on R?s help browser. I mean, until I put a link to my help file inside another help file, there was no way for me to even get it?s address to copy and paste into firefox. It would also be nice if it didn?t almost crash and let me more easily get the link, but ideally it would be best not to have a semi-functional help browser. Furthermore, this brings up the point that I can?t find the files I?m browsing with the link. In this case, I get a link such as: 
> http://127.0.0.1:23269/library/MyPackage/html/MyPackage.html 
> But I can?t find the MyPackage.html file anywhere on my computer. It?s there in the web browser, but seems to be only in existence via R?s httpd without actually existing on my file system. 
> Is it there and I can?t find it or is it encoded in R somehow? If it is there, where would it be? If I close R, I no longer have access to the page that R?s httpd is serving. It seems to me that it?s being created every time I use help?and I think that is extremely inefficient. I think firefox can handle file-type urls, so I if there is a way to get R to both generate these files and use firefox to browse them for help, I would very much like to know more about it. It would be much faster and useful than the status quo on my machine if this file were generated once at installation and remained as a file--and and using help simply pointed a web-browser to the file.
> Anyway, I suppose this is a tangent. The main point is that there is a way to provide help documentation with images?but even though it tries to view them correctly via help?R?s help browser displays broken images so I have the awkward need to copy and paste links into other web browsers.
> 
> Regarding some feedback I?ve gotten about some user?s interests in help formatted as text, I think there are two things in this process that keep a text help user on track: (1) the conditional html part and (2) even if using a textual html browser, <img ... alt=?alternate text?/> take care of displaying images as text. I think though that the other way around, the users who require images in their help files are having less functionality via help in R. At least in this case, the best I could do was get R to generate the proper help pages in html, but R?s default html help browser (at least on my machine) doesn?t display the images (although they are there and can be displayed by the same link in firefox).  
> Sometimes it?s true what they say about a picture being worth a thousand words?I think in general this is true for complex things that need computer power to deal with, so I hope R can eventually support images in help files due to the usefulness of doing so in some cases.
> 
> Thanks again,
> 
> Sean


From hb at biostat.ucsf.edu  Thu May 12 16:33:36 2011
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 12 May 2011 07:33:36 -0700
Subject: [Rd] Milestone: 3000 packages on CRAN
Message-ID: <BANLkTi=QF4opvLM8yvhbGkwfNugkF7mTkw@mail.gmail.com>

So, it's time again.  Today (2011-05-12) on CRAN [1]:

"Currently, the CRAN package repository features 3000 available packages."

Previous milestones:

2009-10-04: 2,000 packages [2]
2007-04-12: 1,000 packages [3]
2004-10-01:    500 packages [4]
2003-04-01:    250 packages [4]

[1] http://cran.r-project.org/web/packages/
[2] https://stat.ethz.ch/pipermail/r-devel/2009-October/055049.html
[3] https://stat.ethz.ch/pipermail/r-devel/2007-April/045359.html
[4] My private in-house data.

/Henrik

PS. There are obviously other package repositories out there, but here
we're counting CRAN packages.


From hadley at rice.edu  Thu May 12 19:02:59 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 12 May 2011 12:02:59 -0500
Subject: [Rd] Recursively parsing srcrefs
Message-ID: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>

Hi all,

Is it possible to "recursively" parse srcrefs to match the recursive
structure of the underlying code?  I'm interested in this because it's
the final step in allowing functions to modify other functions while
preserving the original source. I've tried to make a bit of demo of
what I want to do below, and I think I may uncovered a bug in parse.

f <- function(x = T) {
  # This is a comment
  if (x)                  return(4)
  if (emergency_status()) return(T)
}

parsed_src <- parse(text = attr(f, "source"))
src_ref <- attr(parsed_src, "srcref")[[1]]

f_one <- parse(text = "{
  # This is a comment
  if (x)                  return(4)
  if (emergency_status()) return(T)
}")
attr(f_one, "srcref")[[1]]

f_inside <- parse(text = "
  # This is a comment
  if (x)                  return(4)
  if (emergency_status()) return(T)
")
f_inside # Displays incorrectly?
attr(f_inside, "srcref")[[1]]
# Should be:
#  # This is a comment
#  if (x)                  return(4)


Regards,

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hb at biostat.ucsf.edu  Thu May 12 19:55:34 2011
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 12 May 2011 10:55:34 -0700
Subject: [Rd] Reproducible use case for R crash after updating R
Message-ID: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>

This might have been discussed before, but below is a
"not-so-unlikely" use case where the user follows normal procedures,
updates R to a major release version, and then R crashes:

1. Use runs R stable (e.g. v2.13.0).
2. User installs a package with a namespace, e.g. install.packages("fortunes").
3. User uses the package and one of the package's objects are assigned
to the global env, e.g. foo <- fortune.
4. The user quits R and stores the session data, e.g. q("yes").  The
session is stored in users home directory.
5. User update to new major release of R (e.g. 2.14.0).
6. User starts R.  R crashes with "Fatal error: unable to restore
saved object in .RData" because 'fortunes' is not installed for this
new version of R.  There is also an error message before that
reporting "Error in loadNamespace(name) : there is no package called
'fortunes'".

This can also be reproduced using a single R version as follows:

1. Start R and do:
install.packages("fortunes")
library("fortunes")
foo <- fortune
remove.packages("fortunes")
q("yes")
2. Restart R.  R crashes.

For a GUI-only user this is complicated, because although the users
sees the informative error message that "Error in loadNamespace(name)
: there is no package called 'fortunes'", s/he cannot get to the point
where it is possible to install that missing package.  The key for the
user is to understand to remove the .RData.  In order to do this, s/he
has to locate that file first.

To simplify this, a few alternatives exists:

1. R reports the full path to the problematic .RData file.
2. R renames the problematic .RData file to
erroneous_20110512-123404UTC.RData and reports the new full pathname.

In both cases there could be the option for R to either exit, or
ignore the problematic .RData file and give the user access to the
prompt.  One could also imaging a fancy recovery feature where R
detects "erroneous" .RData files and asks the user if s/he wish to try
to load them (maybe the packages has been installed since).

I'm sure there are complications to implement the above, because
.RData is loaded during startup, but that's my $.02 to this problem

/Henrik


From hb at biostat.ucsf.edu  Thu May 12 20:26:10 2011
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 12 May 2011 11:26:10 -0700
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
Message-ID: <BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>

On Thu, May 12, 2011 at 10:55 AM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
> This might have been discussed before, but below is a
> "not-so-unlikely" use case where the user follows normal procedures,
> updates R to a major release version, and then R crashes:
>
> 1. Use runs R stable (e.g. v2.13.0).
> 2. User installs a package with a namespace, e.g. install.packages("fortunes").
> 3. User uses the package and one of the package's objects are assigned
> to the global env, e.g. foo <- fortune.
> 4. The user quits R and stores the session data, e.g. q("yes"). ?The
> session is stored in users home directory.
> 5. User update to new major release of R (e.g. 2.14.0).
> 6. User starts R. ?R crashes with "Fatal error: unable to restore
> saved object in .RData" because 'fortunes' is not installed for this
> new version of R. ?There is also an error message before that
> reporting "Error in loadNamespace(name) : there is no package called
> 'fortunes'".
>
> This can also be reproduced using a single R version as follows:
>
> 1. Start R and do:
> install.packages("fortunes")
> library("fortunes")
> foo <- fortune
> remove.packages("fortunes")
> q("yes")
> 2. Restart R. ?R crashes.
>
> For a GUI-only user this is complicated, because although the users
> sees the informative error message that "Error in loadNamespace(name)
> : there is no package called 'fortunes'", s/he cannot get to the point
> where it is possible to install that missing package. ?The key for the
> user is to understand to remove the .RData. ?In order to do this, s/he
> has to locate that file first.
>
> To simplify this, a few alternatives exists:
>
> 1. R reports the full path to the problematic .RData file.
> 2. R renames the problematic .RData file to
> erroneous_20110512-123404UTC.RData and reports the new full pathname.
>
> In both cases there could be the option for R to either exit, or
> ignore the problematic .RData file and give the user access to the
> prompt. ?One could also imaging a fancy recovery feature where R
> detects "erroneous" .RData files and asks the user if s/he wish to try
> to load them (maybe the packages has been installed since).

On Windows, the easiest way to give a GUI-only user access to the R
prompt is to also install an "R (vanilla mode)" shortcut/icon on the
Startup menu and Desktop (with target "...\Rgui.exe" --vanilla) in
addition to the default one.

/Henrik

>
> I'm sure there are complications to implement the above, because
> .RData is loaded during startup, but that's my $.02 to this problem
>
> /Henrik
>


From murdoch.duncan at gmail.com  Thu May 12 20:37:42 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 12 May 2011 14:37:42 -0400
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
Message-ID: <4DCC28F6.2090502@gmail.com>

On 12/05/2011 1:02 PM, Hadley Wickham wrote:
> Hi all,
>
> Is it possible to "recursively" parse srcrefs to match the recursive
> structure of the underlying code?  I'm interested in this because it's

I don't understand what you mean by that.  It is certainly possible to 
walk through nested srcrefs, to zoom in on a particular location; that's 
what findLineNum() does.
> the final step in allowing functions to modify other functions while
> preserving the original source. I've tried to make a bit of demo of
> what I want to do below, and I think I may uncovered a bug in parse.
>
> f<- function(x = T) {
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> }
>
> parsed_src<- parse(text = attr(f, "source"))
> src_ref<- attr(parsed_src, "srcref")[[1]]
>
> f_one<- parse(text = "{
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> }")
> attr(f_one, "srcref")[[1]]
>
> f_inside<- parse(text = "
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> ")
> f_inside # Displays incorrectly?
> attr(f_inside, "srcref")[[1]]
> # Should be:
> #  # This is a comment
> #  if (x)                  return(4)


That last display looks like a bug indeed.  I'll take a look.

Duncan Murdoch


From murdoch.duncan at gmail.com  Thu May 12 20:48:03 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 12 May 2011 14:48:03 -0400
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
Message-ID: <4DCC2B63.6010506@gmail.com>

On 12/05/2011 1:55 PM, Henrik Bengtsson wrote:
> This might have been discussed before, but below is a
> "not-so-unlikely" use case where the user follows normal procedures,
> updates R to a major release version, and then R crashes:

Thanks for putting together this nice reproducible example.   I think 
acceptable behaviour in this case would be to offer to run in --vanilla 
mode, with a message that makes clear that installing the missing 
package would fix things.  I don't know if that's feasible or not; it 
may be hard to back out of a partial load of .RData.

Nice behaviour would be to be able to analyze an .RData file, and point 
out which objects in it can't be loaded because of missing packages, and 
do a partial load of just the required objects; that might be very 
helpful in a case where the file contains both valuable data and objects 
that can no longer be loaded, e.g. because a package won't run in the 
latest R release.

I'll take a look at this.  I don't expect the nice behaviour would make 
it into base R, but it would be nice if someone with spare time wrote a 
package to do that...

Duncan
> 1. Use runs R stable (e.g. v2.13.0).
> 2. User installs a package with a namespace, e.g. install.packages("fortunes").
> 3. User uses the package and one of the package's objects are assigned
> to the global env, e.g. foo<- fortune.
> 4. The user quits R and stores the session data, e.g. q("yes").  The
> session is stored in users home directory.
> 5. User update to new major release of R (e.g. 2.14.0).
> 6. User starts R.  R crashes with "Fatal error: unable to restore
> saved object in .RData" because 'fortunes' is not installed for this
> new version of R.  There is also an error message before that
> reporting "Error in loadNamespace(name) : there is no package called
> 'fortunes'".
>
> This can also be reproduced using a single R version as follows:
>
> 1. Start R and do:
> install.packages("fortunes")
> library("fortunes")
> foo<- fortune
> remove.packages("fortunes")
> q("yes")
> 2. Restart R.  R crashes.
>
> For a GUI-only user this is complicated, because although the users
> sees the informative error message that "Error in loadNamespace(name)
> : there is no package called 'fortunes'", s/he cannot get to the point
> where it is possible to install that missing package.  The key for the
> user is to understand to remove the .RData.  In order to do this, s/he
> has to locate that file first.
>
> To simplify this, a few alternatives exists:
>
> 1. R reports the full path to the problematic .RData file.
> 2. R renames the problematic .RData file to
> erroneous_20110512-123404UTC.RData and reports the new full pathname.
>
> In both cases there could be the option for R to either exit, or
> ignore the problematic .RData file and give the user access to the
> prompt.  One could also imaging a fancy recovery feature where R
> detects "erroneous" .RData files and asks the user if s/he wish to try
> to load them (maybe the packages has been installed since).
>
> I'm sure there are complications to implement the above, because
> .RData is loaded during startup, but that's my $.02 to this problem
>
> /Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hadley at rice.edu  Thu May 12 21:59:19 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 12 May 2011 14:59:19 -0500
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <4DCC28F6.2090502@gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
	<4DCC28F6.2090502@gmail.com>
Message-ID: <BANLkTimkrQ3AXViGgnxB6hgVN90abXcL5Q@mail.gmail.com>

>> Is it possible to "recursively" parse srcrefs to match the recursive
>> structure of the underlying code? ?I'm interested in this because it's
>
> I don't understand what you mean by that. ?It is certainly possible to walk
> through nested srcrefs, to zoom in on a particular location; that's what
> findLineNum() does.

Does the example below not help?  Given the whole function, I want to
be able to walk down the call tree, finding the matching src refs as I
go.  i.e. given f, how do I get f_inside?

f <- function(x = T) {
  # This is a comment
  if (x)                  return(4)
  if (emergency_status()) return(T)
}

f_inside <- parse(text = "
  # This is a comment
  if (x)                  return(4)
  if (emergency_status()) return(T)
")

findLineNum doesn't quite do what I want - it works on the text of the
srcref, not on the parse tree.

Here's another go at explaining what I want:

h <- quote(
  1 # one
  + # plus
  2 # two
)

h[[1]] extracts +.  What can I do to extract "+ # plus" (on an object
created in the appropriate manner to keep the srcref)?  Is that even
possible?

My eventual goal is something like

f <- function(x) {
  # This is my function
  T
}

g <- fix_logical_abbreviations(f)

which would be equivalent to

g <- function(x) {
  # This is my function
  TRUE
}


> That last display looks like a bug indeed. ?I'll take a look.

The key seems to be a leading newline:

parse(text = "\nx")
parse(text = "x")

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From murdoch.duncan at gmail.com  Fri May 13 01:50:31 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 12 May 2011 19:50:31 -0400
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <BANLkTimkrQ3AXViGgnxB6hgVN90abXcL5Q@mail.gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
	<4DCC28F6.2090502@gmail.com>
	<BANLkTimkrQ3AXViGgnxB6hgVN90abXcL5Q@mail.gmail.com>
Message-ID: <4DCC7247.8030903@gmail.com>

On 12/05/2011 3:59 PM, Hadley Wickham wrote:
>>> Is it possible to "recursively" parse srcrefs to match the recursive
>>> structure of the underlying code?  I'm interested in this because it's
>>
>> I don't understand what you mean by that.  It is certainly possible to walk
>> through nested srcrefs, to zoom in on a particular location; that's what
>> findLineNum() does.
>
> Does the example below not help?  Given the whole function, I want to
> be able to walk down the call tree, finding the matching src refs as I
> go.  i.e. given f, how do I get f_inside?
>
> f<- function(x = T) {
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> }
>
> f_inside<- parse(text = "
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> ")

I don't think you will get exactly the same thing.  The problem is that 
srcrefs are attributes, and not all statements can have attributes 
attached to them, so the attributes are attached to the container of the 
statements.  (For example, NULL is a statement and it is stored as the 
NULL object, but the NULL object can't have any attributes on it.) In 
those two cases, the containers are different, so I would expect some 
differences between what's in f and what's in f_inside (though I expect 
you could convert one to the other).


>
> findLineNum doesn't quite do what I want - it works on the text of the
> srcref, not on the parse tree.

It searches through the parse tree for the smallest source ref that 
contains a given line.  So for example,

if(condition) {
   blah
   blah
   blah
}

is a single statement, and there will be a srcref stored in its 
container that goes from line N to line N+4.  But it also contains the 
compound statement

{
   blah
   blah
   blah
}

and there will be srcrefs attached to that for each of the statements in 
it.  (I forget right now whether there are 3 or 4 statements there:  R 
treats braces in a funny way, and I'd have to look at an example to 
check.)  Each of the "blah"'s will get a srcref spanning one line, and 
it will be stored in the container.

>
> Here's another go at explaining what I want:
>
> h<- quote(
>    1 # one
>    + # plus
>    2 # two
> )
>
> h[[1]] extracts +.  What can I do to extract "+ # plus" (on an object
> created in the appropriate manner to keep the srcref)?  Is that even
> possible?

You can't easily do that.  The current parser only attaches srcrefs down 
to the statement level, and the + is part of the statement which parses 
to "+ 2".  (The 1 is a separate statement.)

Duncan Murdoch

>
> My eventual goal is something like
>
> f<- function(x) {
>    # This is my function
>    T
> }
>
> g<- fix_logical_abbreviations(f)
>
> which would be equivalent to
>
> g<- function(x) {
>    # This is my function
>    TRUE
> }
>
>
>> That last display looks like a bug indeed.  I'll take a look.
>
> The key seems to be a leading newline:
>
> parse(text = "\nx")
> parse(text = "x")
>
> Hadley
>
>


From romain at r-enthusiasts.com  Fri May 13 08:30:06 2011
From: romain at r-enthusiasts.com (Romain Francois)
Date: Fri, 13 May 2011 08:30:06 +0200
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <BANLkTimkrQ3AXViGgnxB6hgVN90abXcL5Q@mail.gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>	<4DCC28F6.2090502@gmail.com>
	<BANLkTimkrQ3AXViGgnxB6hgVN90abXcL5Q@mail.gmail.com>
Message-ID: <4DCCCFEE.7050506@r-enthusiasts.com>

Le 12/05/11 21:59, Hadley Wickham a ?crit :
>
>>> Is it possible to "recursively" parse srcrefs to match the recursive
>>> structure of the underlying code?  I'm interested in this because it's
>>
>> I don't understand what you mean by that.  It is certainly possible to walk
>> through nested srcrefs, to zoom in on a particular location; that's what
>> findLineNum() does.
>
> Does the example below not help?  Given the whole function, I want to
> be able to walk down the call tree, finding the matching src refs as I
> go.  i.e. given f, how do I get f_inside?
>
> f<- function(x = T) {
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> }
>
> f_inside<- parse(text = "
>    # This is a comment
>    if (x)                  return(4)
>    if (emergency_status()) return(T)
> ")
>
> findLineNum doesn't quite do what I want - it works on the text of the
> srcref, not on the parse tree.
>
> Here's another go at explaining what I want:
>
> h<- quote(
>    1 # one
>    + # plus
>    2 # two
> )
>
> h[[1]] extracts +.  What can I do to extract "+ # plus" (on an object
> created in the appropriate manner to keep the srcref)?  Is that even
> possible?

Maybe the parser package can help you.

 > x <- parser( "/tmp/test.R" )
 > attr( x, "data" )
    line1 col1 byte1 line2 col2 byte2 token id parent top_level 
   token.desc terminal   text
1      1    0     0     1    1     1   263  1      3         0 
      SYMBOL     TRUE      h
2      1    1     1     1    3     3   265  2     32         0 
LEFT_ASSIGN     TRUE     <-
3      1    0     0     1    1     1    77  3     32         0 
        expr    FALSE
4      1    4     4     1    9     9   296  5      7         0 
SYMBOL_FUNCTION_CALL     TRUE  quote
5      1    9     9     1   10    10    40  6     30         0 
         '('     TRUE      (
6      1    4     4     1    9     9    77  7     30         0 
        expr    FALSE
7      2    3     3     2    4     4   261 10     11         0 
   NUM_CONST     TRUE      1
8      2    3     3     2    4     4    77 11     27         0 
        expr    FALSE
9      2    5     5     2   10    10   289 13     27         0 
     COMMENT     TRUE  # one
10     3    3     3     3    4     4    43 16     27         0 
         '+'     TRUE      +
11     3    5     5     3   11    11   289 18     27         0 
     COMMENT     TRUE # plus
12     4    3     3     4    4     4   261 21     22         0 
   NUM_CONST     TRUE      2
13     4    3     3     4    4     4    77 22     27         0 
        expr    FALSE
14     4    5     5     4   10    10   289 24     30         0 
     COMMENT     TRUE  # two
15     5    0     0     5    1     1    41 26     30         0 
         ')'     TRUE      )
16     2    3     3     4    4     4    77 27     30         0 
        expr    FALSE
17     1    4     4     5    1     1    77 30     32         0 
        expr    FALSE
18     1    0     0     5    1     1    77 32      0         0 
        expr    FALSE

Romain

> My eventual goal is something like
>
> f<- function(x) {
>    # This is my function
>    T
> }
>
> g<- fix_logical_abbreviations(f)
>
> which would be equivalent to
>
> g<- function(x) {
>    # This is my function
>    TRUE
> }
>
>
>> That last display looks like a bug indeed.  I'll take a look.
>
> The key seems to be a leading newline:
>
> parse(text = "\nx")
> parse(text = "x")
>
> Hadley
>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
http://romain-francois.com
|- http://bit.ly/hdKhCy : Rcpp article in JSS
|- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
`- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th


From wolfgang.viechtbauer at maastrichtuniversity.nl  Thu May 12 17:12:03 2011
From: wolfgang.viechtbauer at maastrichtuniversity.nl (Viechtbauer Wolfgang (STAT))
Date: Thu, 12 May 2011 17:12:03 +0200
Subject: [Rd] Generic Function for dffits?
Message-ID: <077E31A57DA26E46AB0D493C9966AC730C17E24DD9@UM-MAIL4112.unimaas.nl>

Dear All,

help(influence.measures) shows that there are generic functions for dfbetas(), covratio(), cooks.distance(), hatvalues(), and a few others, but apparently not for dffits(). Wouldn't it be more consistent to have a generic function for this in stats as well?

Best,

--
Wolfgang Viechtbauer
Department of Psychiatry and Neuropsychology
School for Mental Health and Neuroscience
Maastricht University, P.O. Box 616
6200 MD Maastricht, The Netherlands
Tel: +31 (43) 368-5248
Fax: +31 (43) 368-8689
Web: http://www.wvbauer.com


From jorismeys at gmail.com  Fri May 13 15:13:26 2011
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 13 May 2011 15:13:26 +0200
Subject: [Rd] readTableHead refers to itself as readTableHeader in some
	messages
Message-ID: <BANLkTi=5mR8XvD7fGN9xqoDu7oJ_9Ewa5A@mail.gmail.com>

Dear all,

is there a reason why the function readTableHead refers to itself in
the error or warning messages as readTableHeader?

lines 1590-1596 of scan.c :

	if(data.con->text && data.con->blocking) {
	    warning(_("incomplete final line found by readTableHeader on '%s'"),
		    data.con->description);
	} else
	    error(_("incomplete final line found by readTableHeader on '%s'"),
		  data.con->description);
    }

Cheers
Joris


-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Applied mathematics, biometrics and process control

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From soeren.vogel at uzh.ch  Fri May 13 16:19:16 2011
From: soeren.vogel at uzh.ch (soeren.vogel at uzh.ch)
Date: Fri, 13 May 2011 16:19:16 +0200
Subject: [Rd] Create and access several instances of a C++ class from R
In-Reply-To: <4DC50DB9.8090300@r-enthusiasts.com>
References: <49517500-0069-4F75-81E5-DAFFA2F53C08@uzh.ch>	<19908.38110.411719.560626@max.nulle.part>
	<E7B857D5-FA61-4215-838F-88F79CACADD6@uzh.ch>
	<4DC50DB9.8090300@r-enthusiasts.com>
Message-ID: <0A8C949C-0865-4C34-AB12-1F8CE5ECB8F7@uzh.ch>

On 07.05.2011, at 11:15, Romain Francois wrote:

> Try having do_bar with this signature:
> 
> void do_bar(NumericVector data);
> 
> And my advice would probably also to have your C field either as a NumericVector. NumericVector is just a thin wrapper around the internal R data structure.
> 
> Having data members as direct pointers is dangerous and not a very C++ way of doing things.
> 
> If you want to learn about the STL, there are many books that cover it and plenty of online resources. I use this : http://cplusplus.com/reference/stl/. Using the STL is easier than dealing with pointers and stuff.
> 
> If your game is to pass down a double* to some api you use, you can use the begin method of NumericVector, this will give you the array pointer (as would REAL do on the underlying SEXP):

[...]

For the files: the discussion continues here:

http://lists.r-forge.r-project.org/pipermail/rcpp-devel/2011-May/002261.html

Regards
S?ren


From hadley at rice.edu  Fri May 13 19:00:19 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 13 May 2011 12:00:19 -0500
Subject: [Rd] RProfmem output format
Message-ID: <BANLkTinazNHgW44pYFycun576E6C9U1L=Q@mail.gmail.com>

Hi all,

When I run the example in RProfmem, I get:


     Rprofmem("Rprofmem.out", threshold=1000)
     example(glm)
     Rprofmem(NULL)
     noquote(readLines("Rprofmem.out", n=5))

...

[1] 1384 :5416 :5416 :1064 :1064 :"readRDS" "index.search" "example"
[2] 1064 :"readRDS" "index.search" "example"
[3] 4712 :"readRDS" "index.search" "example"
[4] 4712 :"readRDS" "index.search" "example"
[5] 1064 :"readRDS" "index.search" "example"

What do 5 the numbers in the first line mean?

In the subsequence lines I'm assuming the structure is bytes allocated : call.

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From murdoch.duncan at gmail.com  Fri May 13 23:34:37 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 13 May 2011 17:34:37 -0400
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
Message-ID: <4DCDA3ED.4050607@gmail.com>

A simple version of a fix is now in R-devel:  if the .RData file can't 
be loaded during startup, an error message is printed, and R starts with 
an empty workspace.

The name of the .RData file is printed.  It's usually just ".RData", 
because that's what R tries to load; the file will be in the current 
directory if you want to delete it.  If it contains objects that you 
want to recover, you can try to deal with the error message (e.g. by 
installing fortunes in your example), exiting without saving, and then 
the next restart may succeed.

Duncan Murdoch


On 11-05-12 2:26 PM, Henrik Bengtsson wrote:
> On Thu, May 12, 2011 at 10:55 AM, Henrik Bengtsson<hb at biostat.ucsf.edu>  wrote:
>> This might have been discussed before, but below is a
>> "not-so-unlikely" use case where the user follows normal procedures,
>> updates R to a major release version, and then R crashes:
>>
>> 1. Use runs R stable (e.g. v2.13.0).
>> 2. User installs a package with a namespace, e.g. install.packages("fortunes").
>> 3. User uses the package and one of the package's objects are assigned
>> to the global env, e.g. foo<- fortune.
>> 4. The user quits R and stores the session data, e.g. q("yes").  The
>> session is stored in users home directory.
>> 5. User update to new major release of R (e.g. 2.14.0).
>> 6. User starts R.  R crashes with "Fatal error: unable to restore
>> saved object in .RData" because 'fortunes' is not installed for this
>> new version of R.  There is also an error message before that
>> reporting "Error in loadNamespace(name) : there is no package called
>> 'fortunes'".
>>
>> This can also be reproduced using a single R version as follows:
>>
>> 1. Start R and do:
>> install.packages("fortunes")
>> library("fortunes")
>> foo<- fortune
>> remove.packages("fortunes")
>> q("yes")
>> 2. Restart R.  R crashes.
>>
>> For a GUI-only user this is complicated, because although the users
>> sees the informative error message that "Error in loadNamespace(name)
>> : there is no package called 'fortunes'", s/he cannot get to the point
>> where it is possible to install that missing package.  The key for the
>> user is to understand to remove the .RData.  In order to do this, s/he
>> has to locate that file first.
>>
>> To simplify this, a few alternatives exists:
>>
>> 1. R reports the full path to the problematic .RData file.
>> 2. R renames the problematic .RData file to
>> erroneous_20110512-123404UTC.RData and reports the new full pathname.
>>
>> In both cases there could be the option for R to either exit, or
>> ignore the problematic .RData file and give the user access to the
>> prompt.  One could also imaging a fancy recovery feature where R
>> detects "erroneous" .RData files and asks the user if s/he wish to try
>> to load them (maybe the packages has been installed since).
>
> On Windows, the easiest way to give a GUI-only user access to the R
> prompt is to also install an "R (vanilla mode)" shortcut/icon on the
> Startup menu and Desktop (with target "...\Rgui.exe" --vanilla) in
> addition to the default one.
>
> /Henrik
>
>>
>> I'm sure there are complications to implement the above, because
>> .RData is loaded during startup, but that's my $.02 to this problem
>>
>> /Henrik
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Fri May 13 23:35:37 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 13 May 2011 17:35:37 -0400
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <4DCC28F6.2090502@gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
	<4DCC28F6.2090502@gmail.com>
Message-ID: <4DCDA429.9000206@gmail.com>

On 11-05-12 2:37 PM, Duncan Murdoch wrote:
> On 12/05/2011 1:02 PM, Hadley Wickham wrote:
>> Hi all,
>>
>> Is it possible to "recursively" parse srcrefs to match the recursive
>> structure of the underlying code?  I'm interested in this because it's
>
> I don't understand what you mean by that.  It is certainly possible to
> walk through nested srcrefs, to zoom in on a particular location; that's
> what findLineNum() does.
>> the final step in allowing functions to modify other functions while
>> preserving the original source. I've tried to make a bit of demo of
>> what I want to do below, and I think I may uncovered a bug in parse.
>>
>> f<- function(x = T) {
>>     # This is a comment
>>     if (x)                  return(4)
>>     if (emergency_status()) return(T)
>> }
>>
>> parsed_src<- parse(text = attr(f, "source"))
>> src_ref<- attr(parsed_src, "srcref")[[1]]
>>
>> f_one<- parse(text = "{
>>     # This is a comment
>>     if (x)                  return(4)
>>     if (emergency_status()) return(T)
>> }")
>> attr(f_one, "srcref")[[1]]
>>
>> f_inside<- parse(text = "
>>     # This is a comment
>>     if (x)                  return(4)
>>     if (emergency_status()) return(T)
>> ")
>> f_inside # Displays incorrectly?
>> attr(f_inside, "srcref")[[1]]
>> # Should be:
>> #  # This is a comment
>> #  if (x)                  return(4)
>
>
> That last display looks like a bug indeed.  I'll take a look.

The bug is now fixed in R-devel and R-patched.

Duncan Murdoch


From sean.mcguffee at gmail.com  Sat May 14 01:08:11 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 13 May 2011 19:08:11 -0400
Subject: [Rd] R html help system [Was: How to document man/*.Rd pages
 with images?]
In-Reply-To: <56C958F1-C50C-4ABB-84BB-160207F8F190@r-project.org>
Message-ID: <C9F3321B.41B9%sean.mcguffee@gmail.com>


On 5/12/11 9:13 AM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:

> I just want to clarify the mechanics of the help system when using html.
> 
> R has a built-in HTTP server (aka Rhttpd) which transforms HTTP requests to
> function calls. It is not your usual web server, because it doesn't map URL
> paths to files, it just allows R functions to do anything with it -- something
> like CGI except that we are talking about functions and not files. Therefore
> you won't find any files and there is no file structure involved.
> 
> For the help system, the function handling the requests is tools:::httpd() -
> you can look at what it does.

Awesome, will do!

> Basically, it generates pages according to the
> various paths it supports. As part of its path handling it allows certain
> paths to reference files, e.g.
> /library/myPackage/doc/randomStuffInPackagesDocDirectory.html will read the
> file doc/randomStuffInPackagesDocDirectory.html in myPackage.
> 
> Note that the whole point of the dynamic help *is* to generate content on the
> fly, because the content depends on the state of your current workspace --
> packages loaded, classes defined, etc. so you cannot pre-generate pages as
> they won't have correct links - that's why we shifted from static html pages
> to the dynamic ones.

This is interesting. It actually speaks to a constructive criticism I have
of R. As a user of R, I don't want to have conditional dynamic help. I want
to always get the same answer to a question so to say. If there is a way to
do something that works and is reproducible, then I don't want to maybe or
maybe not get that answer. Thus, I guess what I'm thinking is that there
should maybe be selection within help that has organization based on
packages loaded and classes defined, but I would hope that the state of my
system doesn't change the help that is displayed. At least I as one user
would prefer to see all of my options will all packages and not have any of
it emphasized or excluded by how my system is currently set up.

In the satus quo, I can see how the choice of which pages to look at is
dynamic if more than one comes up on a search, but it seems inefficient to
me to have the page itself be dynamic. I think it would be a good idea if
package authors could at least have an option to have their help pages
produced as files either way. I mean, when my package will be loaded, I
certainly won't want options and do want to be able to point my users to an
unconditional file location to point their browser to.

> 
> I'm curious about "If it?s a large picture this process nearly crashes my
> machine when trying to access the file via help" - do you have an example
> package that would illustrate the problem?

I?ve tried to recreate the problem with a small fake package, and although
it passes the check it doesn?t seem to work quite right on my system. I
might have some compiler issues or configuration issues though, so it might
work as is on your system. If not, I think you could quickly find the
relevant parts though and add them to a package of your own to see the bug
if this doesn?t work as is on your machine. I?m not really sure why this
doesn?t work on my machine. I did almost exactly the same thing as in the
huge package that I can?t fit on my file transfer site. However, it is set
up to only install in 64-bit and I couldn't remember how I set that up. So
it might be the 32-bit part that is messing things up on my system. I think
there should be a simple way to declare an architecture in a package
DESCRIPTION or something. I can't remember. Anyway, that's beside the point.
Here is an example of a syntax and image file that makes my help go
extremely slow and not show images:

http://ftsext.mskcc.org/FileExchange/FileList.aspx?id=9afb4fe1-ce1c-406d-b1a
1-c9360493137c

Please let me know if you see why this isn?t working for me--both as to if
this works as is on your system and as to if this causes the bug. At the
moment this tells me " Error in gzfile(file, "rb") : cannot open the
connection" even though it passes all the build check install tests on my
machine.

> 
> Thanks,
> Simon
> 
> 
> On May 11, 2011, at 7:14 PM, Sean Robert McGuffee wrote:
> 
>> Thanks everyone for your help,
>> 
>> To summarize a resolution to my issue, it turns out that an image can be
>> include in a documentation file via html by putting an image file in the
>> inst/doc directory, for example inst/doc/myPic.png, and then pointing to it
>> in the man/myHelpPage.Rd file, for example as follows:
>> 
>> \if{html}{
>> \out{<img src="../doc/myPic.png" alt="image ../doc/myPic.png should be
>> here"/>}
>> }\ifelse{latex}{}{}
>> 
>> Note, this doesn?t mean that R?s help browser will view those images inside
>> the properly generated html help files.
>> Also, note that without the \out{} part, the text of the <img .../>  line
>> would show up instead of the html commands.
>>  
>> I have some concerns incase anyone on the list is interested. If it?s a large
>> picture this process nearly crashes my machine when trying to access the file
>> via help?and I?m sure there must be some bug in that. I should note that the
>> picture won?t actually display within R?s help console (at least on my
>> machine--I?m on a mac with a binary version of R). To see that the html files
>> are created properly, I have to copy a link to the help file and then point
>> an actual browser such as firefox to the help file to see the page with the
>> image. I?m not sure how R is running httpd or how that interacts with help.
>> I?m not even sure about the basics of help. Is there a way to configure R to
>> use an actual web browser by default instead of it?s slow one that doesn?t
>> show images? It would also be nice if there were an address bar on R?s help
>> browser. I mean, until I put a link to my help file inside another help file,
>> there was no way for me to even get it?s address to copy and paste into
>> firefox. It would also be nice if it didn?t almost crash and let me more
>> easily get the link, but ideally it would be best not to have a
>> semi-functional help browser. Furthermore, this brings up the point that I
>> can?t find the files I?m browsing with the link. In this case, I get a link
>> such as: 
>> http://127.0.0.1:23269/library/MyPackage/html/MyPackage.html
>> But I can?t find the MyPackage.html file anywhere on my computer. It?s there
>> in the web browser, but seems to be only in existence via R?s httpd without
>> actually existing on my file system.
>> Is it there and I can?t find it or is it encoded in R somehow? If it is
>> there, where would it be? If I close R, I no longer have access to the page
>> that R?s httpd is serving. It seems to me that it?s being created every time
>> I use help?and I think that is extremely inefficient. I think firefox can
>> handle file-type urls, so I if there is a way to get R to both generate these
>> files and use firefox to browse them for help, I would very much like to know
>> more about it. It would be much faster and useful than the status quo on my
>> machine if this file were generated once at installation and remained as a
>> file--and and using help simply pointed a web-browser to the file.
>> Anyway, I suppose this is a tangent. The main point is that there is a way to
>> provide help documentation with images?but even though it tries to view them
>> correctly via help?R?s help browser displays broken images so I have the
>> awkward need to copy and paste links into other web browsers.
>> 
>> Regarding some feedback I?ve gotten about some user?s interests in help
>> formatted as text, I think there are two things in this process that keep a
>> text help user on track: (1) the conditional html part and (2) even if using
>> a textual html browser, <img ... alt=?alternate text?/> take care of
>> displaying images as text. I think though that the other way around, the
>> users who require images in their help files are having less functionality
>> via help in R. At least in this case, the best I could do was get R to
>> generate the proper help pages in html, but R?s default html help browser (at
>> least on my machine) doesn?t display the images (although they are there and
>> can be displayed by the same link in firefox).
>> Sometimes it?s true what they say about a picture being worth a thousand
>> words?I think in general this is true for complex things that need computer
>> power to deal with, so I hope R can eventually support images in help files
>> due to the usefulness of doing so in some cases.
>> 
>> Thanks again,
>> 
>> Sean
> 


From simon.urbanek at r-project.org  Sat May 14 02:20:59 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 13 May 2011 20:20:59 -0400
Subject: [Rd] R html help system [Was: How to document man/*.Rd pages
	with images?]
In-Reply-To: <C9F3321B.41B9%sean.mcguffee@gmail.com>
References: <C9F3321B.41B9%sean.mcguffee@gmail.com>
Message-ID: <10F72106-27E3-4098-B206-E17EB94BC4D7@r-project.org>


On May 13, 2011, at 7:08 PM, Sean Robert McGuffee wrote:

> 
> On 5/12/11 9:13 AM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
> 
>> I just want to clarify the mechanics of the help system when using html.
>> 
>> R has a built-in HTTP server (aka Rhttpd) which transforms HTTP requests to
>> function calls. It is not your usual web server, because it doesn't map URL
>> paths to files, it just allows R functions to do anything with it -- something
>> like CGI except that we are talking about functions and not files. Therefore
>> you won't find any files and there is no file structure involved.
>> 
>> For the help system, the function handling the requests is tools:::httpd() -
>> you can look at what it does.
> 
> Awesome, will do!
> 
>> Basically, it generates pages according to the
>> various paths it supports. As part of its path handling it allows certain
>> paths to reference files, e.g.
>> /library/myPackage/doc/randomStuffInPackagesDocDirectory.html will read the
>> file doc/randomStuffInPackagesDocDirectory.html in myPackage.
>> 
>> Note that the whole point of the dynamic help *is* to generate content on the
>> fly, because the content depends on the state of your current workspace --
>> packages loaded, classes defined, etc. so you cannot pre-generate pages as
>> they won't have correct links - that's why we shifted from static html pages
>> to the dynamic ones.
> 
> This is interesting. It actually speaks to a constructive criticism I have of R. As a user of R, I don't want to have conditional dynamic help. I want to always get the same answer to a question so to say. If there is a way to do something that works and is reproducible, then I don't want to maybe or maybe not get that answer. Thus, I guess what I'm thinking is that there should maybe be selection within help that has organization based on packages loaded and classes defined, but I would hope that the state of my system doesn't change the help that is displayed. At least I as one user would prefer to see all of my options will all packages and not have any of it emphasized or excluded by how my system is currently set up.
> 

I don't think I follow you. Your options will be different, by definition, depending on which packages you have installed and loaded. As one obvious example, you can't refer to documentation of packages that you did not install. As another example (more future-directed I suspect), the generics and methods depend on your currently defined classes, methods etc. That is true in R itself, so I don't see why you would prefer documentation that doesn't match your R.


> In the satus quo, I can see how the choice of which pages to look at is dynamic if more than one comes up on a search, but it seems inefficient to me to have the page itself be dynamic. I think it would be a good idea if package authors could at least have an option to have their help pages produced as files either way.

That decision is left to the user - you can use --html to generate html pages.


> I mean, when my package will be loaded, I certainly won't want options and do want to be able to point my users to an unconditional file location to point their browser to.
> 

You can do that with dynamically generated pages (you can't do that with static pages in fact) - the paths are well defined (unlike in your file system). Even better is fact, because the dynamic help is smart enough to find packages in different libraries, for example.


>> I'm curious about "If it?s a large picture this process nearly crashes my
>> machine when trying to access the file via help" - do you have an example
>> package that would illustrate the problem?
> 
> I?ve tried to recreate the problem with a small fake package, and although
> it passes the check it doesn?t seem to work quite right on my system. I
> might have some compiler issues or configuration issues though, so it might
> work as is on your system. If not, I think you could quickly find the
> relevant parts though and add them to a package of your own to see the bug
> if this doesn?t work as is on your machine. I?m not really sure why this
> doesn?t work on my machine. I did almost exactly the same thing as in the
> huge package that I can?t fit on my file transfer site. However, it is set
> up to only install in 64-bit and I couldn't remember how I set that up. So
> it might be the 32-bit part that is messing things up on my system. I think
> there should be a simple way to declare an architecture in a package
> DESCRIPTION or something. I can't remember. Anyway, that's beside the point.
> Here is an example of a syntax and image file that makes my help go
> extremely slow and not show images:
> 
> http://ftsext.mskcc.org/FileExchange/FileList.aspx?id=9afb4fe1-ce1c-406d-b1a
> 1-c9360493137c
> 
> Please let me know if you see why this isn?t working for me--both as to if
> this works as is on your system and as to if this causes the bug. At the
> moment this tells me " Error in gzfile(file, "rb") : cannot open the
> connection" even though it passes all the build check install tests on my
> machine.
> 

There seem to be two bugs AFAICS:

a) The path generated from the URL is either wrong or something is not in syncs - it says
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/Meta/Rd.rdsBug/help
but the meta file is really in
/Library/Frameworks/R.framework/Versions/2.13/Resources/library/helpBug/Meta/Rd.rds
It seems like some strange permutation issue - but I didn't look at httpd() yet (I'm a bit puzzled as of why it doesn't affect other packages - maybe it's some regexp thing ...).

b) there seems to be an issue with WebKit and Rhttpd interaction in that Rhttpd gets blocked by WebKit not fetching the data. If you look at the page from an external browser, all is well. This will be a bit tricky to address and will need modifications to R...

Cheers,
Simon


>> 
>> Thanks,
>> Simon
>> 
>> 
>> On May 11, 2011, at 7:14 PM, Sean Robert McGuffee wrote:
>> 
>>> Thanks everyone for your help,
>>> 
>>> To summarize a resolution to my issue, it turns out that an image can be
>>> include in a documentation file via html by putting an image file in the
>>> inst/doc directory, for example inst/doc/myPic.png, and then pointing to it
>>> in the man/myHelpPage.Rd file, for example as follows:
>>> 
>>> \if{html}{
>>> \out{<img src="../doc/myPic.png" alt="image ../doc/myPic.png should be
>>> here"/>}
>>> }\ifelse{latex}{}{}
>>> 
>>> Note, this doesn?t mean that R?s help browser will view those images inside
>>> the properly generated html help files.
>>> Also, note that without the \out{} part, the text of the <img .../>  line
>>> would show up instead of the html commands.
>>> 
>>> I have some concerns incase anyone on the list is interested. If it?s a large
>>> picture this process nearly crashes my machine when trying to access the file
>>> via help?and I?m sure there must be some bug in that. I should note that the
>>> picture won?t actually display within R?s help console (at least on my
>>> machine--I?m on a mac with a binary version of R). To see that the html files
>>> are created properly, I have to copy a link to the help file and then point
>>> an actual browser such as firefox to the help file to see the page with the
>>> image. I?m not sure how R is running httpd or how that interacts with help.
>>> I?m not even sure about the basics of help. Is there a way to configure R to
>>> use an actual web browser by default instead of it?s slow one that doesn?t
>>> show images? It would also be nice if there were an address bar on R?s help
>>> browser. I mean, until I put a link to my help file inside another help file,
>>> there was no way for me to even get it?s address to copy and paste into
>>> firefox. It would also be nice if it didn?t almost crash and let me more
>>> easily get the link, but ideally it would be best not to have a
>>> semi-functional help browser. Furthermore, this brings up the point that I
>>> can?t find the files I?m browsing with the link. In this case, I get a link
>>> such as: 
>>> http://127.0.0.1:23269/library/MyPackage/html/MyPackage.html
>>> But I can?t find the MyPackage.html file anywhere on my computer. It?s there
>>> in the web browser, but seems to be only in existence via R?s httpd without
>>> actually existing on my file system.
>>> Is it there and I can?t find it or is it encoded in R somehow? If it is
>>> there, where would it be? If I close R, I no longer have access to the page
>>> that R?s httpd is serving. It seems to me that it?s being created every time
>>> I use help?and I think that is extremely inefficient. I think firefox can
>>> handle file-type urls, so I if there is a way to get R to both generate these
>>> files and use firefox to browse them for help, I would very much like to know
>>> more about it. It would be much faster and useful than the status quo on my
>>> machine if this file were generated once at installation and remained as a
>>> file--and and using help simply pointed a web-browser to the file.
>>> Anyway, I suppose this is a tangent. The main point is that there is a way to
>>> provide help documentation with images?but even though it tries to view them
>>> correctly via help?R?s help browser displays broken images so I have the
>>> awkward need to copy and paste links into other web browsers.
>>> 
>>> Regarding some feedback I?ve gotten about some user?s interests in help
>>> formatted as text, I think there are two things in this process that keep a
>>> text help user on track: (1) the conditional html part and (2) even if using
>>> a textual html browser, <img ... alt=?alternate text?/> take care of
>>> displaying images as text. I think though that the other way around, the
>>> users who require images in their help files are having less functionality
>>> via help in R. At least in this case, the best I could do was get R to
>>> generate the proper help pages in html, but R?s default html help browser (at
>>> least on my machine) doesn?t display the images (although they are there and
>>> can be displayed by the same link in firefox).
>>> Sometimes it?s true what they say about a picture being worth a thousand
>>> words?I think in general this is true for complex things that need computer
>>> power to deal with, so I hope R can eventually support images in help files
>>> due to the usefulness of doing so in some cases.
>>> 
>>> Thanks again,
>>> 
>>> Sean
>> 
> 
> 
> 


From spencer.graves at prodsyse.com  Sat May 14 13:39:12 2011
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Sat, 14 May 2011 04:39:12 -0700
Subject: [Rd] Add "See Also:  missing" to help('exists')?
In-Reply-To: <AF4C61A5-E05A-4FD7-B161-516A234D4F58@comcast.net>
References: <4DCE2F89.2090503@global-analytics.com>
	<AF4C61A5-E05A-4FD7-B161-516A234D4F58@comcast.net>
Message-ID: <4DCE69E0.4070107@prodsyse.com>

       Might it be feasible to add, "See Also:  missing" to the help 
page for "exists"?


       Currently, one can spend hours studying the help page for 
"exists" without getting a clue to the answer to the post copied below.


       Thanks,
       Spencer


On 5/14/2011 3:30 AM, David Winsemius wrote:
>
> On May 14, 2011, at 3:30 AM, utkarshsinghal wrote:
>
>>
>>   Hi all,
>>   I want to define a function such that one of its argument if passed 
>> do one
>>   thing and if not passed do the second thing.
>
> ?missing
>
>> So basically, I have to check
>>   whether the argument is passed or not inside the function. I am 
>> trying to
>>   use 'exists' function to do this.
>>> f = function(a,b){exists("b")}
>>> f(a=3, b=4)
>>   [1] TRUE
>>   This is working as expected.
>>   But if I do the following:
>>> f(a=3)
>>   [1] TRUE
>>   Can anybody explain why this function is returning TRUE here.
>> -- 
>> Many thanks,
>> Utkarsh
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> David Winsemius, MD
> West Hartford, CT
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From hpages at fhcrc.org  Sun May 15 00:47:18 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Sat, 14 May 2011 15:47:18 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
Message-ID: <4DCF0676.5070407@fhcrc.org>

Hi,

I was stumped by this. The two S4 objects below looked exactly the same:

   > a1
   An object of class "A"
   Slot "aa":
   integer(0)
   > a2
   An object of class "A"
   Slot "aa":
   integer(0)

   > str(a1)
   Formal class 'A' [package ".GlobalEnv"] with 1 slots
     ..@ aa: int(0)
   > str(a2)
   Formal class 'A' [package ".GlobalEnv"] with 1 slots
     ..@ aa: int(0)

But they were not identical:

   > identical(a1,a2)
   [1] FALSE

Then I found that one had a "names" attribute but not the other:

   > names(attributes(a1))
   [1] "aa"    "class" "names"
   > names(attributes(a2))
   [1] "aa"    "class"

   > names(a1)
   NULL
   > names(a2)
   NULL

Which explained why they were not reported as identical.

After tracking the history of 'a1', I found that it was created with
something like:

   > setClass("A", representation(aa="integer"))
   [1] "A"
   > a1 <- new("A")
   > names(a1) <- "K"
   > names(a1)
   NULL

So it seems that, by default (i.e. in the absence of a specialized
method), the `names<-` primitive is adding a "names" attribute to the
object. Could this behaviour be modified so it doesn't alter the object?

Thanks,
H.


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From tlumley at uw.edu  Sun May 15 01:50:48 2011
From: tlumley at uw.edu (Thomas Lumley)
Date: Sun, 15 May 2011 11:50:48 +1200
Subject: [Rd] RProfmem output format
In-Reply-To: <BANLkTinazNHgW44pYFycun576E6C9U1L=Q@mail.gmail.com>
References: <BANLkTinazNHgW44pYFycun576E6C9U1L=Q@mail.gmail.com>
Message-ID: <BANLkTim=QW62QLuduMsXuPp+5N-rTMjdjg@mail.gmail.com>

On Sat, May 14, 2011 at 5:00 AM, Hadley Wickham <hadley at rice.edu> wrote:
> Hi all,
>
> When I run the example in RProfmem, I get:
>
>
> ? ? Rprofmem("Rprofmem.out", threshold=1000)
> ? ? example(glm)
> ? ? Rprofmem(NULL)
> ? ? noquote(readLines("Rprofmem.out", n=5))
>
> ...
>
> [1] 1384 :5416 :5416 :1064 :1064 :"readRDS" "index.search" "example"
> [2] 1064 :"readRDS" "index.search" "example"
> [3] 4712 :"readRDS" "index.search" "example"
> [4] 4712 :"readRDS" "index.search" "example"
> [5] 1064 :"readRDS" "index.search" "example"
>
> What do 5 the numbers in the first line mean?
>
> In the subsequence lines I'm assuming the structure is bytes allocated : call.

I think the five numbers come from four memory allocations before
example() is called.  Looking at the code in src/main/memory.c, it
prints newline only when the call stack is not empty.

I don't see why this is done, and I may well be the person who did it
(I don't have svn on this computer to check), but it is clearly
deliberate.

   -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From hadley at rice.edu  Sun May 15 15:02:56 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Sun, 15 May 2011 08:02:56 -0500
Subject: [Rd] RProfmem output format
In-Reply-To: <BANLkTim=QW62QLuduMsXuPp+5N-rTMjdjg@mail.gmail.com>
References: <BANLkTinazNHgW44pYFycun576E6C9U1L=Q@mail.gmail.com>
	<BANLkTim=QW62QLuduMsXuPp+5N-rTMjdjg@mail.gmail.com>
Message-ID: <BANLkTike1kM-wN_GYJEH5WVKQHJMdRijMQ@mail.gmail.com>

>> In the subsequence lines I'm assuming the structure is bytes allocated : call.
>
> I think the five numbers come from four memory allocations before
> example() is called. ?Looking at the code in src/main/memory.c, it
> prints newline only when the call stack is not empty.

Looking into that example in more detail, here's the distribution of
allocation numbers:

   1    3    4
4621   30    2

(with a threshold of 5k)

So it happens ~30 times in total.

So what causes allocations when the call stack is empty?  Something
internal?  Does the garbage collector trigger allocations (i.e. could
it be caused by moving data to contiguous memory)?

Any ideas what the correct thing to do with these memory allocations?
Ignore them because they're not really related to the function they're
attributed to?  Sum them up?

> I don't see why this is done, and I may well be the person who did it
> (I don't have svn on this computer to check), but it is clearly
> deliberate.

It seems like it would be more consistent to always print a newline,
and then it would obvious those allocations occurred when the call
stack was empty.  This would make parsing the file a little bit
easier.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Sun May 15 15:05:11 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Sun, 15 May 2011 08:05:11 -0500
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <4DCDA429.9000206@gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
	<4DCC28F6.2090502@gmail.com> <4DCDA429.9000206@gmail.com>
Message-ID: <BANLkTi=sA7ywxo5CcxA+BRVfRY4+1P=Ggw@mail.gmail.com>

> The bug is now fixed in R-devel and R-patched.

Thanks!

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Sun May 15 15:04:56 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Sun, 15 May 2011 08:04:56 -0500
Subject: [Rd] Recursively parsing srcrefs
In-Reply-To: <4DCC7247.8030903@gmail.com>
References: <BANLkTikpgh27=EJGnmfrmuQ7QBh1vV-Qkw@mail.gmail.com>
	<4DCC28F6.2090502@gmail.com>
	<BANLkTimkrQ3AXViGgnxB6hgVN90abXcL5Q@mail.gmail.com>
	<4DCC7247.8030903@gmail.com>
Message-ID: <BANLkTi=S=AxnBkOP=9eiCDCo+rYG2eQNYQ@mail.gmail.com>

>> findLineNum doesn't quite do what I want - it works on the text of the
>> srcref, not on the parse tree.
>
> It searches through the parse tree for the smallest source ref that contains
> a given line. ?So for example,
>
> if(condition) {
> ?blah
> ?blah
> ?blah
> }
>
> is a single statement, and there will be a srcref stored in its container
> that goes from line N to line N+4. ?But it also contains the compound
> statement
>
> {
> ?blah
> ?blah
> ?blah
> }
>
> and there will be srcrefs attached to that for each of the statements in it.
> ?(I forget right now whether there are 3 or 4 statements there: ?R treats
> braces in a funny way, and I'd have to look at an example to check.) ?Each
> of the "blah"'s will get a srcref spanning one line, and it will be stored
> in the container.

I'm clearly missing something obvious because I don't see how to
access these lower-level srcrefs.  Would you mind providing a small
example?

Thanks!

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Sun May 15 15:07:19 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Sun, 15 May 2011 08:07:19 -0500
Subject: [Rd] RProfmem output format
In-Reply-To: <BANLkTike1kM-wN_GYJEH5WVKQHJMdRijMQ@mail.gmail.com>
References: <BANLkTinazNHgW44pYFycun576E6C9U1L=Q@mail.gmail.com>
	<BANLkTim=QW62QLuduMsXuPp+5N-rTMjdjg@mail.gmail.com>
	<BANLkTike1kM-wN_GYJEH5WVKQHJMdRijMQ@mail.gmail.com>
Message-ID: <BANLkTikJEEKDRB9p-BBzAqs7a=hHpgr9=g@mail.gmail.com>

Also, would you mind commenting how RProfmem is misleading?

There are three ways to profile memory use over time in R code. ...
All can be misleading, for different reasons.
--- http://cran.r-project.org/doc/manuals/R-exts.html#Profiling-R-code-for-memory-use

The other two ways describe why they are misleading.

Hadley

On Sun, May 15, 2011 at 8:02 AM, Hadley Wickham <hadley at rice.edu> wrote:
>>> In the subsequence lines I'm assuming the structure is bytes allocated : call.
>>
>> I think the five numbers come from four memory allocations before
>> example() is called. ?Looking at the code in src/main/memory.c, it
>> prints newline only when the call stack is not empty.
>
> Looking into that example in more detail, here's the distribution of
> allocation numbers:
>
> ? 1 ? ?3 ? ?4
> 4621 ? 30 ? ?2
>
> (with a threshold of 5k)
>
> So it happens ~30 times in total.
>
> So what causes allocations when the call stack is empty? ?Something
> internal? ?Does the garbage collector trigger allocations (i.e. could
> it be caused by moving data to contiguous memory)?
>
> Any ideas what the correct thing to do with these memory allocations?
> Ignore them because they're not really related to the function they're
> attributed to? ?Sum them up?
>
>> I don't see why this is done, and I may well be the person who did it
>> (I don't have svn on this computer to check), but it is clearly
>> deliberate.
>
> It seems like it would be more consistent to always print a newline,
> and then it would obvious those allocations occurred when the call
> stack was empty. ?This would make parsing the file a little bit
> easier.
>
> Hadley
>
> --
> Assistant Professor / Dobelman Family Junior Chair
> Department of Statistics / Rice University
> http://had.co.nz/
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From jmc at r-project.org  Sun May 15 20:33:43 2011
From: jmc at r-project.org (John Chambers)
Date: Sun, 15 May 2011 11:33:43 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DCF0676.5070407@fhcrc.org>
References: <4DCF0676.5070407@fhcrc.org>
Message-ID: <4DD01C87.8040202@r-project.org>

This is basically a case of a user error that is not being caught:

On 5/14/11 3:47 PM, Herv? Pag?s wrote:
> Hi,
>
> I was stumped by this. The two S4 objects below looked exactly the same:
>
>  > a1
> An object of class "A"
> Slot "aa":
> integer(0)
>  > a2
> An object of class "A"
> Slot "aa":
> integer(0)
>
>  > str(a1)
> Formal class 'A' [package ".GlobalEnv"] with 1 slots
> ..@ aa: int(0)
>  > str(a2)
> Formal class 'A' [package ".GlobalEnv"] with 1 slots
> ..@ aa: int(0)
>
> But they were not identical:
>
>  > identical(a1,a2)
> [1] FALSE
>
> Then I found that one had a "names" attribute but not the other:
>
>  > names(attributes(a1))
> [1] "aa" "class" "names"
>  > names(attributes(a2))
> [1] "aa" "class"
>
>  > names(a1)
> NULL
>  > names(a2)
> NULL
>
> Which explained why they were not reported as identical.
>
> After tracking the history of 'a1', I found that it was created with
> something like:
>
>  > setClass("A", representation(aa="integer"))
> [1] "A"
>  > a1 <- new("A")
>  > names(a1) <- "K"
>  > names(a1)
> NULL
>
> So it seems that, by default (i.e. in the absence of a specialized
> method), the `names<-` primitive is adding a "names" attribute to the
> object. Could this behaviour be modified so it doesn't alter the object?

Eh?  But you did alter the object.  Not only that, you altered it in 
what is technically an invalid way:  Adding a names attribute to a class 
that has no names slot.

The modification that would make sense would be to give you an error in 
the above code.  Not a bad idea, but it's likely to generate more 
complaints in other contexts, particularly where people don't 
distinguish the "list" class from lists with names (the "namedList" class).

A plausible strategy:
  1.  If the class has a vector data slot and no names slot, assign the 
names but with a warning.

  2. Otherwise, throw an error.

(I.e., I would prefer an error throughout, but discretion ....)

Comments?

John


>
> Thanks,
> H.
>
>


From tlumley at uw.edu  Sun May 15 22:16:22 2011
From: tlumley at uw.edu (Thomas Lumley)
Date: Mon, 16 May 2011 08:16:22 +1200
Subject: [Rd] RProfmem output format
In-Reply-To: <BANLkTike1kM-wN_GYJEH5WVKQHJMdRijMQ@mail.gmail.com>
References: <BANLkTinazNHgW44pYFycun576E6C9U1L=Q@mail.gmail.com>
	<BANLkTim=QW62QLuduMsXuPp+5N-rTMjdjg@mail.gmail.com>
	<BANLkTike1kM-wN_GYJEH5WVKQHJMdRijMQ@mail.gmail.com>
Message-ID: <BANLkTimiLvxHYaV3DT9FVsh+p6nxPoW+5g@mail.gmail.com>

On Mon, May 16, 2011 at 1:02 AM, Hadley Wickham <hadley at rice.edu> wrote:
> So what causes allocations when the call stack is empty? ?Something
> internal? ?Does the garbage collector trigger allocations (i.e. could
> it be caused by moving data to contiguous memory)?

The garbage collector doesn't move anything, it just swaps pointers in
a linked list.

The lexer, parser, and evaluator all have  to do some work before a
function context is set up for the top-level function, so I assume
that's where it is happening.

> Any ideas what the correct thing to do with these memory allocations?
> Ignore them because they're not really related to the function they're
> attributed to? ?Sum them up?
>
>> I don't see why this is done, and I may well be the person who did it
>> (I don't have svn on this computer to check), but it is clearly
>> deliberate.
>
> It seems like it would be more consistent to always print a newline,
> and then it would obvious those allocations occurred when the call
> stack was empty. ?This would make parsing the file a little bit
> easier.

Yes. It's obviously better to always print a newline, and so clearly
deliberate not to, that I suspect there may have been a good reason.
If I can't work it out (after my grant deadline this week) I will just
assume it's wrong.


   -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From hpages at fhcrc.org  Mon May 16 00:02:26 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Sun, 15 May 2011 15:02:26 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD01C87.8040202@r-project.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
Message-ID: <4DD04D72.9070807@fhcrc.org>

On 11-05-15 11:33 AM, John Chambers wrote:
> This is basically a case of a user error that is not being caught:

Sure!

   https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html

>
> On 5/14/11 3:47 PM, Herv? Pag?s wrote:
>> Hi,
>>
>> I was stumped by this. The two S4 objects below looked exactly the same:
>>
>> > a1
>> An object of class "A"
>> Slot "aa":
>> integer(0)
>> > a2
>> An object of class "A"
>> Slot "aa":
>> integer(0)
>>
>> > str(a1)
>> Formal class 'A' [package ".GlobalEnv"] with 1 slots
>> ..@ aa: int(0)
>> > str(a2)
>> Formal class 'A' [package ".GlobalEnv"] with 1 slots
>> ..@ aa: int(0)
>>
>> But they were not identical:
>>
>> > identical(a1,a2)
>> [1] FALSE
>>
>> Then I found that one had a "names" attribute but not the other:
>>
>> > names(attributes(a1))
>> [1] "aa" "class" "names"
>> > names(attributes(a2))
>> [1] "aa" "class"
>>
>> > names(a1)
>> NULL
>> > names(a2)
>> NULL
>>
>> Which explained why they were not reported as identical.
>>
>> After tracking the history of 'a1', I found that it was created with
>> something like:
>>
>> > setClass("A", representation(aa="integer"))
>> [1] "A"
>> > a1 <- new("A")
>> > names(a1) <- "K"
>> > names(a1)
>> NULL
>>
>> So it seems that, by default (i.e. in the absence of a specialized
>> method), the `names<-` primitive is adding a "names" attribute to the
>> object. Could this behaviour be modified so it doesn't alter the object?
>
> Eh? But you did alter the object. Not only that, you altered it in what
> is technically an invalid way: Adding a names attribute to a class that
> has no names slot.

Ah, that's interesting. I didn't know I could put a names slot in my
class. Last time I tried was at least 3 years ago and that was causing
problems (don't remember the exact details) so I ended up using NAMES
instead. Trying again with R-2.14:

   > setClass("A", representation(names="character"))

   > a <- new("A")

   > attributes(a)
   $names
   character(0)

   $class
   [1] "A"
   attr(,"package")
   [1] ".GlobalEnv"

   > names(a)
   NULL

   > names(a) <- "K"

   > attributes(a)
   $names
   [1] "K"

   $class
   [1] "A"
   attr(,"package")
   [1] ".GlobalEnv"

   > names(a)
   NULL

Surprise! But that's another story...

>
> The modification that would make sense would be to give you an error in
> the above code. Not a bad idea, but it's likely to generate more
> complaints in other contexts, particularly where people don't
> distinguish the "list" class from lists with names (the "namedList" class).
>
> A plausible strategy:
> 1. If the class has a vector data slot and no names slot, assign the
> names but with a warning.
>
> 2. Otherwise, throw an error.
>
> (I.e., I would prefer an error throughout, but discretion ....)

Or, at a minimum (if no consensus can be reached about the above
strategy), not add a "names" attribute set to NULL. My original
post was more about keeping the internal representation of objects
"normalized", in general, so identical() is more likely to be
meaningful.

Thanks,
H.

>
> Comments?
>
> John
>
>
>>
>> Thanks,
>> H.
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From maechler at stat.math.ethz.ch  Mon May 16 10:43:30 2011
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 16 May 2011 10:43:30 +0200
Subject: [Rd] Add "See Also:  missing" to help('exists')?
In-Reply-To: <4DCE69E0.4070107@prodsyse.com>
References: <4DCE2F89.2090503@global-analytics.com>
	<AF4C61A5-E05A-4FD7-B161-516A234D4F58@comcast.net>
	<4DCE69E0.4070107@prodsyse.com>
Message-ID: <19920.58290.687681.804857@stat.math.ethz.ch>


    SpG>        Might it be feasible to add, "See Also: missing"
    SpG> to the help page for "exists"?


    SpG>        Currently, one can spend hours studying the help
    SpG> page for "exists" without getting a clue to the answer
    SpG> to the post copied below.

Yes. I've added such a link now...
though quite disillusioned with a very vague hope that useRs
would read the help page so thoroughly ...

Martin Maechler, ETH Zurich

    SpG>        Thanks, Spencer


    SpG> On 5/14/2011 3:30 AM, David Winsemius wrote:
    >> 
    >> On May 14, 2011, at 3:30 AM, utkarshsinghal wrote:
    >> 
    >>> 
>>   Hi all,
>>   I want to define a function such that one of its argument if passed 
>> do one
>>   thing and if not passed do the second thing.
>
> ?missing
>
>> So basically, I have to check
>>   whether the argument is passed or not inside the function. I am 
>> trying to
>>   use 'exists' function to do this.
>>> f = function(a,b){exists("b")}
>>> f(a=3, b=4)
>>   [1] TRUE
>>   This is working as expected.
>>   But if I do the following:
>>> f(a=3)
>>   [1] TRUE
>>   Can anybody explain why this function is returning TRUE here.
>> -- 
>> Many thanks,
>> Utkarsh

>>...

> David Winsemius, MD
> West Hartford, CT


From spencer.graves at structuremonitoring.com  Mon May 16 12:06:02 2011
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Mon, 16 May 2011 03:06:02 -0700
Subject: [Rd] Add "See Also:  missing" to help('exists')?
In-Reply-To: <19920.58290.687681.804857@stat.math.ethz.ch>
References: <4DCE2F89.2090503@global-analytics.com>	<AF4C61A5-E05A-4FD7-B161-516A234D4F58@comcast.net>	<4DCE69E0.4070107@prodsyse.com>
	<19920.58290.687681.804857@stat.math.ethz.ch>
Message-ID: <4DD0F70A.9060803@structuremonitoring.com>

On 5/16/2011 1:43 AM, Martin Maechler wrote:
>      SpG>         Might it be feasible to add, "See Also: missing"
>      SpG>  to the help page for "exists"?
>
>
>      SpG>         Currently, one can spend hours studying the help
>      SpG>  page for "exists" without getting a clue to the answer
>      SpG>  to the post copied below.
>
> Yes. I've added such a link now...
> though quite disillusioned with a very vague hope that useRs
> would read the help page so thoroughly ...
>
> Martin Maechler, ETH Zurich

Hi, Martin:  Thanks much.  I mentioned this because I have looked in 
"See Also" for that kind of thing in the past.  Of course, I may be the 
only person who does this, so this change might not help anyone else.  
Best Wishes, Spencer

>      SpG>         Thanks, Spencer
>
>
>      SpG>  On 5/14/2011 3:30 AM, David Winsemius wrote:
>      >>
>      >>  On May 14, 2011, at 3:30 AM, utkarshsinghal wrote:
>      >>
>      >>>
>>>    Hi all,
>>>    I want to define a function such that one of its argument if passed
>>> do one
>>>    thing and if not passed do the second thing.
>> ?missing
>>
>>> So basically, I have to check
>>>    whether the argument is passed or not inside the function. I am
>>> trying to
>>>    use 'exists' function to do this.
>>>> f = function(a,b){exists("b")}
>>>> f(a=3, b=4)
>>>    [1] TRUE
>>>    This is working as expected.
>>>    But if I do the following:
>>>> f(a=3)
>>>    [1] TRUE
>>>    Can anybody explain why this function is returning TRUE here.
>>> -- 
>>> Many thanks,
>>> Utkarsh
>>> ...
>> David Winsemius, MD
>> West Hartford, CT


From murdoch.duncan at gmail.com  Mon May 16 13:04:25 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 16 May 2011 07:04:25 -0400
Subject: [Rd] RCMD check fails on "checkin installed package size"
In-Reply-To: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F965@DJFEXMBX01.djf.agrsci.dk>
References: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>	<alpine.LFD.2.02.1105111247140.8673@toucan.stats.ox.ac.uk>
	<1C56F3EE22DF4F458FE02F58B96D4150555EA9F8A3@DJFEXMBX01.djf.agrsci.dk>
	<4DCBCE6D.1050100@gmail.com>
	<1C56F3EE22DF4F458FE02F58B96D4150555EA9F965@DJFEXMBX01.djf.agrsci.dk>
Message-ID: <4DD104B9.5010306@gmail.com>

On 11-05-16 6:39 AM, Stefan McKinnon H?j-Edwards wrote:
> Hello Duncan,
>
> This is what I get:
> C:\Users\STME\Documents\R\win-library\2.13\AnnotationFuncs>du -k
> 209     ./doc
> 24      ./help
> 8       ./html
> 9       ./Meta
> 10      ./R
> 279     .

Assuming that this was the output when check ran it, I don't see why it 
didn't work from Rcmd check.

Duncan Murdoch

>
> Kind regards,
>
> Stefan McKinnon H?j-Edwards     Dept. of Genetics and Biotechnology
> PhD student                     Faculty of Agricultural Sciences
> stefan.hoj-edwards at agrsci.dk    Aarhus University
> Tel.: +45 8999 1291             Blichers All? 20, Postboks 50
> Web: www.iysik.com              DK-8830 Tjele
>                                  Tel.: +45 8999 1900
>                                  Web: www.agrsci.au.dk
>
>
>
> -----Oprindelig meddelelse-----
> Fra: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
> Sendt: 12. maj 2011 14:11
> Til: Stefan McKinnon H?j-Edwards
> Cc: Prof Brian Ripley; r-devel at r-project.org
> Emne: Re: [Rd] RCMD check fails on "checkin installed package size"
>
> On 11/05/2011 8:07 AM, Stefan McKinnon H?j-Edwards wrote:
>> Thanks. It worked.
>> I added the line "_R_CHECK_PKG_SIZES_=no" to /etc/Rcmd_environ (I am the only user of this computer).
>>
>> Regarding the 'du' executable, it is found in the first directory in the PATH environment variable and came with Rtools for R 2.13.
>
> R CMD check will try to run "du -k" while the current directory is the
> one where it just installed the package during the check.  If you do
> that from the command line, (i.e. install AnnotationFuncs, switch to
> RHOME/library/AnnotationFuncs, and run "du -k") what do you see as output?
>
> Duncan Murdoch
>> Kind regards,
>> Stefan McKinnon H?j-Edwards
>> PhD student
>> Dept. of Genetics and Biotechnology
>> Faculty of Agricultural Sciences
>> Aarhus University
>> Blichers All? 20, Postboks 50
>> DK-8830 Tjele
>>
>> Tel.: +45 8999 1291
>> Email: stefanm.edwards at agrsci.dk
>>
>> Tel.: +45 8999 1900
>> Web: www.agrsci.au.dk
>>
>>
>>
>>
>> -----Oprindelig meddelelse-----
>> Fra: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
>> Sendt: 11. maj 2011 13:51
>> Til: Stefan McKinnon H?j-Edwards
>> Cc: r-devel at r-project.org
>> Emne: Re: [Rd] RCMD check fails on "checkin installed package size"
>>
>> On Wed, 11 May 2011, Stefan McKinnon H?j-Edwards wrote:
>>
>>>   Hi,
>>>
>>>   When I run RCMD check on my package, I receive the following error:
>>>   C:\R-packages\AnnotationFuncs>RCMD check --no-vignettes AnnotationFuncs
>>>   * using log directory 'C:/R-packages/AnnotationFuncs/AnnotationFuncs.Rcheck'
>>>   * using R version 2.13.0 (2011-04-13)
>>>   * using platform: i386-pc-mingw32 (32-bit)
>>>   * using session charset: ISO8859-1
>>>   * using option '--no-vignettes'
>>>   * checking for file 'AnnotationFuncs/DESCRIPTION' ... OK
>>>   * this is package 'AnnotationFuncs' version '1.1.2'
>>>   * checking package name space information ... OK
>>>   * checking package dependencies ... OK
>>>   * checking if this is a source package ... OK
>>>   * checking for executable files ... OK
>>>   * checking whether package 'AnnotationFuncs' can be installed ... OK
>>>   * checking installed package size ...Error in if (total>   1024 * 5) { : missing
>>>   value where TRUE/FALSE needed
>>>   Execution halted
>>>
>>>
>>>   I am running it on Windows 7 (32-bit) and my PATH environment variable starts with this:
>>>   C:\Rtools\bin;C:\Rtools\MinGW\bin;C:\Program Files\R\R-2.13.0\bin\i386;
>>>
>>>   I have updated Rtools to the newest with 2.13.
>>>
>>>   Any suggestions?
>>
>> Set _R_CHECK_PKG_SIZES_ to 'no' (see 'Writing R Extensions' and its
>> references on customizing R CMD check), or correct your paths so the
>> 'du' program in Rtools is the one that is found.  (The only reported
>> example was from using a different 'du' program.)
>>
>> I believe that current R-patched works around this: R-devel definitely
>> does.
>>
>>>
>>>   Thanks in advanced,
>>>   Stefan McKinnon H?j-Edwards
>>>
>>>   ______________________________________________
>>>   R-devel at r-project.org mailing list
>>>   https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>


From jmc at r-project.org  Mon May 16 18:36:41 2011
From: jmc at r-project.org (John Chambers)
Date: Mon, 16 May 2011 09:36:41 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD04D72.9070807@fhcrc.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org>
Message-ID: <4DD15299.7090000@r-project.org>

You set up a names slot in a non-vector.  Maybe that should be allowed, 
maybe not.  But in any case I would not expect the names() primitive to 
find it, because your object has a non-vector type ("S4").  You could do 
a at names if you thought that made sense:


 > setClass("A", representation(names="character"))
[1] "A"
 > a <- new("A")
 > a at names <- "xx"
 > a at names
[1] "xx"
 > names(a)
NULL


If you wanted something sensible, it's more like:

 > setClass("B", representation(names = "character"), contains = "integer")
[1] "B"
 > b <- new("B", 1:5)
 > names(b) <- letters[1:5]
 > b
An object of class "B"
[1] 1 2 3 4 5
Slot "names":
[1] "a" "b" "c" "d" "e"

 > names(b)
[1] "a" "b" "c" "d" "e"

This allows both the S4 and the primitive code to deal with a 
well-defined object.

John


On 5/15/11 3:02 PM, Herv? Pag?s wrote:
> On 11-05-15 11:33 AM, John Chambers wrote:
>> This is basically a case of a user error that is not being caught:
>
> Sure!
>
> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
......

>
> Ah, that's interesting. I didn't know I could put a names slot in my
> class. Last time I tried was at least 3 years ago and that was causing
> problems (don't remember the exact details) so I ended up using NAMES
> instead. Trying again with R-2.14:
>
>  > setClass("A", representation(names="character"))
>
>  > a <- new("A")
>
>  > attributes(a)
> $names
> character(0)
>
> $class
> [1] "A"
> attr(,"package")
> [1] ".GlobalEnv"
>
>  > names(a)
> NULL
>
>  > names(a) <- "K"
>
>  > attributes(a)
> $names
> [1] "K"
>
> $class
> [1] "A"
> attr(,"package")
> [1] ".GlobalEnv"
>
>  > names(a)
> NULL
>
> Surprise! But that's another story...
>
>>
>> The modification that would make sense would be to give you an error in
>> the above code. Not a bad idea, but it's likely to generate more
>> complaints in other contexts, particularly where people don't
>> distinguish the "list" class from lists with names (the "namedList"
>> class).
>>
>> A plausible strategy:
>> 1. If the class has a vector data slot and no names slot, assign the
>> names but with a warning.
>>
>> 2. Otherwise, throw an error.
>>
>> (I.e., I would prefer an error throughout, but discretion ....)
>
> Or, at a minimum (if no consensus can be reached about the above
> strategy), not add a "names" attribute set to NULL. My original
> post was more about keeping the internal representation of objects
> "normalized", in general, so identical() is more likely to be
> meaningful.
>
> Thanks,
> H.
>
>>
>> Comments?
>>
>> John
>>
>>
>>>
>>> Thanks,
>>> H.
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From hpages at fhcrc.org  Mon May 16 19:09:01 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 16 May 2011 10:09:01 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD15299.7090000@r-project.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
Message-ID: <4DD15A2D.9020504@fhcrc.org>

On 11-05-16 09:36 AM, John Chambers wrote:
> You set up a names slot in a non-vector. Maybe that should be allowed,
> maybe not. But in any case I would not expect the names() primitive to
> find it, because your object has a non-vector type ("S4").

But the names<-() primitive *does* find it. So either names() and
names<-() should both find it, or they shouldn't. I mean, if you care
about consistency and predictability of course.

H.


> You could do
> a at names if you thought that made sense:
>
>
>  > setClass("A", representation(names="character"))
> [1] "A"
>  > a <- new("A")
>  > a at names <- "xx"
>  > a at names
> [1] "xx"
>  > names(a)
> NULL
>
>
> If you wanted something sensible, it's more like:
>
>  > setClass("B", representation(names = "character"), contains = "integer")
> [1] "B"
>  > b <- new("B", 1:5)
>  > names(b) <- letters[1:5]
>  > b
> An object of class "B"
> [1] 1 2 3 4 5
> Slot "names":
> [1] "a" "b" "c" "d" "e"
>
>  > names(b)
> [1] "a" "b" "c" "d" "e"
>
> This allows both the S4 and the primitive code to deal with a
> well-defined object.
>
> John
>
>
> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>> On 11-05-15 11:33 AM, John Chambers wrote:
>>> This is basically a case of a user error that is not being caught:
>>
>> Sure!
>>
>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
> ......
>
>>
>> Ah, that's interesting. I didn't know I could put a names slot in my
>> class. Last time I tried was at least 3 years ago and that was causing
>> problems (don't remember the exact details) so I ended up using NAMES
>> instead. Trying again with R-2.14:
>>
>> > setClass("A", representation(names="character"))
>>
>> > a <- new("A")
>>
>> > attributes(a)
>> $names
>> character(0)
>>
>> $class
>> [1] "A"
>> attr(,"package")
>> [1] ".GlobalEnv"
>>
>> > names(a)
>> NULL
>>
>> > names(a) <- "K"
>>
>> > attributes(a)
>> $names
>> [1] "K"
>>
>> $class
>> [1] "A"
>> attr(,"package")
>> [1] ".GlobalEnv"
>>
>> > names(a)
>> NULL
>>
>> Surprise! But that's another story...
>>
>>>
>>> The modification that would make sense would be to give you an error in
>>> the above code. Not a bad idea, but it's likely to generate more
>>> complaints in other contexts, particularly where people don't
>>> distinguish the "list" class from lists with names (the "namedList"
>>> class).
>>>
>>> A plausible strategy:
>>> 1. If the class has a vector data slot and no names slot, assign the
>>> names but with a warning.
>>>
>>> 2. Otherwise, throw an error.
>>>
>>> (I.e., I would prefer an error throughout, but discretion ....)
>>
>> Or, at a minimum (if no consensus can be reached about the above
>> strategy), not add a "names" attribute set to NULL. My original
>> post was more about keeping the internal representation of objects
>> "normalized", in general, so identical() is more likely to be
>> meaningful.
>>
>> Thanks,
>> H.
>>
>>>
>>> Comments?
>>>
>>> John
>>>
>>>
>>>>
>>>> Thanks,
>>>> H.
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From sean.mcguffee at gmail.com  Mon May 16 20:15:36 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Mon, 16 May 2011 14:15:36 -0400
Subject: [Rd] R html help system [Was: How to document man/*.Rd pages
 with images?]
In-Reply-To: <10F72106-27E3-4098-B206-E17EB94BC4D7@r-project.org>
Message-ID: <C9F6E208.4212%sean.mcguffee@gmail.com>




On 5/13/11 8:20 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:

> 
> On May 13, 2011, at 7:08 PM, Sean Robert McGuffee wrote:
> 
>> 
>> On 5/12/11 9:13 AM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
>> 
>>> I just want to clarify the mechanics of the help system when using html.
>>> 
>>> R has a built-in HTTP server (aka Rhttpd) which transforms HTTP requests to
>>> function calls. It is not your usual web server, because it doesn't map URL
>>> paths to files, it just allows R functions to do anything with it --
>>> something
>>> like CGI except that we are talking about functions and not files. Therefore
>>> you won't find any files and there is no file structure involved.
>>> 
>>> For the help system, the function handling the requests is tools:::httpd() -
>>> you can look at what it does.
>> 
>> Awesome, will do!
>> 
>>> Basically, it generates pages according to the
>>> various paths it supports. As part of its path handling it allows certain
>>> paths to reference files, e.g.
>>> /library/myPackage/doc/randomStuffInPackagesDocDirectory.html will read the
>>> file doc/randomStuffInPackagesDocDirectory.html in myPackage.
>>> 
>>> Note that the whole point of the dynamic help *is* to generate content on
>>> the
>>> fly, because the content depends on the state of your current workspace --
>>> packages loaded, classes defined, etc. so you cannot pre-generate pages as
>>> they won't have correct links - that's why we shifted from static html pages
>>> to the dynamic ones.
>> 
>> This is interesting. It actually speaks to a constructive criticism I have of
>> R. As a user of R, I don't want to have conditional dynamic help. I want to
>> always get the same answer to a question so to say. If there is a way to do
>> something that works and is reproducible, then I don't want to maybe or maybe
>> not get that answer. Thus, I guess what I'm thinking is that there should
>> maybe be selection within help that has organization based on packages loaded
>> and classes defined, but I would hope that the state of my system doesn't
>> change the help that is displayed. At least I as one user would prefer to see
>> all of my options will all packages and not have any of it emphasized or
>> excluded by how my system is currently set up.
>> 
> 
> I don't think I follow you. Your options will be different, by definition,
> depending on which packages you have installed and loaded. As one obvious
> example, you can't refer to documentation of packages that you did not
> install. As another example (more future-directed I suspect), the generics and
> methods depend on your currently defined classes, methods etc. That is true in
> R itself, so I don't see why you would prefer documentation that doesn't match
> your R.

I guess what I mean to say is that although a user's options depend on
context, when I use help, I want to know what my options are outside of the
current context. Especially at a stage where I need help, I definitely might
not have the right context set up, so it's very important to me to have
non-context-specific help. I recognize that this is my opinion and by no
means agreed upon, but this was a huge barrier for me when I first began
using R. For example, sometimes I would load a library while following an
example in the documentation before I even knew about libraries or realized
what I was doing. Then, within that context, a help command within that
library would work. On another day, when I hadn't set up that context by
accident, using my notes of "help(whatever)" wouldn't work. That was very
confusing and frustrating for me, and I'm much more computer literate than
many of the test-tube wet lab scientists I would hope to have using my
packages. I realize that "??whatever" gets around this, but the "??" symbol
is hard to lookup and learn about, especially when there is a
"help(whatever)" syntax that worked on a previous day. It took me months to
understand that "??" even existed as something separate from
"help(whatever)." In general, as a beginner, I found it very confusing that
there were more than one help commands, and I'm not sure if that's a good
thing for people who need help. Those are my two cents anyway. This might be
best for most people--I tend to be a very literal and concrete thinker and
may not be very representative. On the other hand, I don't see what the
benefit is to having less options for help if a package isn't loaded. I
suppose it provides more focus for someone who knows very well what they are
doing and wants to know something specific to their current context.
However, I'm not sure if helping that person focus is as critical to
providing help as assisting a new user who is likely to be oblivious to
contexts as a concept. Am I making any sense?

Let me make up an extreme example, just to clarify:
Suppose there are packages A and B, both with command C.
Regardless of what packages I have loaded, I would want help( C ) to bring
up a list with two files to choose from: one corresponding to A::C and one
corresponding to B::C, both containing the information that to use C one
must first type library(A) or library(B) to create the context that makes
the help information about how to use C relevant. My understanding is that
as it stands, typing help( C ) would do one of three things, depending on
whether library(A) or library(B) has been loaded. If neither has been
loaded, help( C ) would produce an error. If library(A) had been loaded,
then help would be generated regarding A::C and the user would be otherwise
oblivious to B::C, even if that were the useful info to the user. Likewise
for the vis-a-versa case with library(B) loaded. So that's to help me
explain my perspective of what I mean by non-context-specific help and why I
think it would be advantageous. Does that make sense? What I don't
understand is a case where it is advantageous to be oblivious to out of
context options. Could someone show me an example of that? I'm sure I am
missing something because I can't think of a case like that on my own and
have been considering it for days.

> 
> 
>> In the satus quo, I can see how the choice of which pages to look at is
>> dynamic if more than one comes up on a search, but it seems inefficient to me
>> to have the page itself be dynamic. I think it would be a good idea if
>> package authors could at least have an option to have their help pages
>> produced as files either way.
> 
> That decision is left to the user - you can use --html to generate html pages.

This is appealing to me, but I can't seem to find any info about it. Maybe
having the "--" part of the "--help" is throwing off my searches. I couldn't
find "--help" when I searched R's help. If my package is named MyPackage,
how would a user generate the html pages from it with "--html"?

> 
> 
>> I mean, when my package will be loaded, I certainly won't want options and do
>> want to be able to point my users to an unconditional file location to point
>> their browser to.
>> 
> 
> You can do that with dynamically generated pages (you can't do that with
> static pages in fact) - the paths are well defined (unlike in your file
> system). Even better is fact, because the dynamic help is smart enough to find
> packages in different libraries, for example.

I think this is a very good thing. Having the dynamic help is probably the
very best way to go from that perspective. I personally find file-system
paths to be annoyingly less well defined, so I'm completely sold by what you
are saying. It seems from what you said below that the performance issue I
have is from a bug. Am I right about that? I could be mistaking the context
of what you said below because I was a bit ambiguous about more than one
issue below. Since I can control what my package generates for help my
context-specific issue is not a problem for me, so a this is a distinct
issue I have with dynamic help and what appeared to me to be a performance
problem. My machine tends to lag for quite a while on many packages when
using the dynamic help system. Almost enough to discourage use. I found my
case with a large image to be a particularly bad anecdotal example of a
specific help problem, and maybe it is relevant to that more general issue
if there is a general bug. If this is caused by a bug, I would see no
problem with the concept of dynamic help at all--especially if it can react
instantaneously. However, I'm not completely convinced of that yet. It seem
very efficient to me to have a dynamic system point to pre-generated files.
However, generating those files dynamically, especially if many of them are
relevant, seems potentially inefficient. I don't claim to understand how it
is working yet, although looking into it has been fascinating so far.

> 
> 
>>> I'm curious about "If it?s a large picture this process nearly crashes my
>>> machine when trying to access the file via help" - do you have an example
>>> package that would illustrate the problem?
>> 
>> I?ve tried to recreate the problem with a small fake package, and although
>> it passes the check it doesn?t seem to work quite right on my system. I
>> might have some compiler issues or configuration issues though, so it might
>> work as is on your system. If not, I think you could quickly find the
>> relevant parts though and add them to a package of your own to see the bug
>> if this doesn?t work as is on your machine. I?m not really sure why this
>> doesn?t work on my machine. I did almost exactly the same thing as in the
>> huge package that I can?t fit on my file transfer site. However, it is set
>> up to only install in 64-bit and I couldn't remember how I set that up. So
>> it might be the 32-bit part that is messing things up on my system. I think
>> there should be a simple way to declare an architecture in a package
>> DESCRIPTION or something. I can't remember. Anyway, that's beside the point.
>> Here is an example of a syntax and image file that makes my help go
>> extremely slow and not show images:
>> 
>> http://ftsext.mskcc.org/FileExchange/FileList.aspx?id=9afb4fe1-ce1c-406d-b1a
>> 1-c9360493137c
>> 
>> Please let me know if you see why this isn?t working for me--both as to if
>> this works as is on your system and as to if this causes the bug. At the
>> moment this tells me " Error in gzfile(file, "rb") : cannot open the
>> connection" even though it passes all the build check install tests on my
>> machine.
>> 
> 
> There seem to be two bugs AFAICS:
> 
> a) The path generated from the URL is either wrong or something is not in
> syncs - it says
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/Meta/Rd.rdsBug
> /help
> but the meta file is really in
> /Library/Frameworks/R.framework/Versions/2.13/Resources/library/helpBug/Meta/R
> d.rds
> It seems like some strange permutation issue - but I didn't look at httpd()
> yet (I'm a bit puzzled as of why it doesn't affect other packages - maybe it's
> some regexp thing ...).
> 
> b) there seems to be an issue with WebKit and Rhttpd interaction in that
> Rhttpd gets blocked by WebKit not fetching the data. If you look at the page
> from an external browser, all is well. This will be a bit tricky to address
> and will need modifications to R...

Should I look into making these modifications to R? Or would this type of
thing be addressed by more official R personnel?

> 
> Cheers,
> Simon
> 
> 
>>> 
>>> Thanks,
>>> Simon
>>> 
>>> 
>>> On May 11, 2011, at 7:14 PM, Sean Robert McGuffee wrote:
>>> 
>>>> Thanks everyone for your help,
>>>> 
>>>> To summarize a resolution to my issue, it turns out that an image can be
>>>> include in a documentation file via html by putting an image file in the
>>>> inst/doc directory, for example inst/doc/myPic.png, and then pointing to it
>>>> in the man/myHelpPage.Rd file, for example as follows:
>>>> 
>>>> \if{html}{
>>>> \out{<img src="../doc/myPic.png" alt="image ../doc/myPic.png should be
>>>> here"/>}
>>>> }\ifelse{latex}{}{}
>>>> 
>>>> Note, this doesn?t mean that R?s help browser will view those images inside
>>>> the properly generated html help files.
>>>> Also, note that without the \out{} part, the text of the <img .../>  line
>>>> would show up instead of the html commands.
>>>> 
>>>> I have some concerns incase anyone on the list is interested. If it?s a
>>>> large
>>>> picture this process nearly crashes my machine when trying to access the
>>>> file
>>>> via help?and I?m sure there must be some bug in that. I should note that
>>>> the
>>>> picture won?t actually display within R?s help console (at least on my
>>>> machine--I?m on a mac with a binary version of R). To see that the html
>>>> files
>>>> are created properly, I have to copy a link to the help file and then point
>>>> an actual browser such as firefox to the help file to see the page with the
>>>> image. I?m not sure how R is running httpd or how that interacts with help.
>>>> I?m not even sure about the basics of help. Is there a way to configure R
>>>> to
>>>> use an actual web browser by default instead of it?s slow one that doesn?t
>>>> show images? It would also be nice if there were an address bar on R?s help
>>>> browser. I mean, until I put a link to my help file inside another help
>>>> file,
>>>> there was no way for me to even get it?s address to copy and paste into
>>>> firefox. It would also be nice if it didn?t almost crash and let me more
>>>> easily get the link, but ideally it would be best not to have a
>>>> semi-functional help browser. Furthermore, this brings up the point that I
>>>> can?t find the files I?m browsing with the link. In this case, I get a link
>>>> such as: 
>>>> http://127.0.0.1:23269/library/MyPackage/html/MyPackage.html
>>>> But I can?t find the MyPackage.html file anywhere on my computer. It?s
>>>> there
>>>> in the web browser, but seems to be only in existence via R?s httpd without
>>>> actually existing on my file system.
>>>> Is it there and I can?t find it or is it encoded in R somehow? If it is
>>>> there, where would it be? If I close R, I no longer have access to the page
>>>> that R?s httpd is serving. It seems to me that it?s being created every
>>>> time
>>>> I use help?and I think that is extremely inefficient. I think firefox can
>>>> handle file-type urls, so I if there is a way to get R to both generate
>>>> these
>>>> files and use firefox to browse them for help, I would very much like to
>>>> know
>>>> more about it. It would be much faster and useful than the status quo on my
>>>> machine if this file were generated once at installation and remained as a
>>>> file--and and using help simply pointed a web-browser to the file.
>>>> Anyway, I suppose this is a tangent. The main point is that there is a way
>>>> to
>>>> provide help documentation with images?but even though it tries to view
>>>> them
>>>> correctly via help?R?s help browser displays broken images so I have the
>>>> awkward need to copy and paste links into other web browsers.
>>>> 
>>>> Regarding some feedback I?ve gotten about some user?s interests in help
>>>> formatted as text, I think there are two things in this process that keep a
>>>> text help user on track: (1) the conditional html part and (2) even if
>>>> using
>>>> a textual html browser, <img ... alt=?alternate text?/> take care of
>>>> displaying images as text. I think though that the other way around, the
>>>> users who require images in their help files are having less functionality
>>>> via help in R. At least in this case, the best I could do was get R to
>>>> generate the proper help pages in html, but R?s default html help browser
>>>> (at
>>>> least on my machine) doesn?t display the images (although they are there
>>>> and
>>>> can be displayed by the same link in firefox).
>>>> Sometimes it?s true what they say about a picture being worth a thousand
>>>> words?I think in general this is true for complex things that need computer
>>>> power to deal with, so I hope R can eventually support images in help files
>>>> due to the usefulness of doing so in some cases.
>>>> 
>>>> Thanks again,
>>>> 
>>>> Sean
>>> 
>> 
>> 
>> 
> 


From bbolker at gmail.com  Sat May 14 14:46:17 2011
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 14 May 2011 08:46:17 -0400
Subject: [Rd] obscure error message from splines::ns
Message-ID: <4DCE7999.9050806@gmail.com>


  In the following case,


library(splines)
tt <- c(55, 251, 380, 289, 210, 385, 361, 669)
nn <- rep(0:7,tt)
ns(nn,4)
## knots are located at (0.25,0.5,0.75); quantiles = (2,5,7)

  we get the error

Error in qr.default(t(const)) :
  NA/NaN/Inf in foreign function call (arg 1)

  because the 75th quantile (the location of the last "interior" knot)
ends up on the boundary.  As a result, the call to
spline.des(...)$design within the bs() function call returns a design
matrix that includes NaN values, which triggers the error when qr() is
called.

(This alternative works OK:
ns(nn,4,knots=seq(min(nn),max(nn),length=5)[2:4])
)

   This could be argued to be a "well, just don't do that" case: splines
are designed for continuous data where this wouldn't happen.  On the
other hand, this was encountered as part of a sensible (IMO) data
analysis strategy, and it would be nice if there were at least an
informative warning message.  If there were any enthusiasm for it, I
would try to come up with a test and warning to incorporate into the
current version of bs() ...

  Ben Bolker


From jmc at r-project.org  Mon May 16 22:53:08 2011
From: jmc at r-project.org (John Chambers)
Date: Mon, 16 May 2011 13:53:08 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD15A2D.9020504@fhcrc.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
	<4DD15A2D.9020504@fhcrc.org>
Message-ID: <4DD18EB4.2060509@r-project.org>



On 5/16/11 10:09 AM, Herv? Pag?s wrote:
> On 11-05-16 09:36 AM, John Chambers wrote:
>> You set up a names slot in a non-vector. Maybe that should be allowed,
>> maybe not. But in any case I would not expect the names() primitive to
>> find it, because your object has a non-vector type ("S4").
>
> But the names<-() primitive *does* find it. So either names() and
> names<-() should both find it, or they shouldn't. I mean, if you care
> about consistency and predictability of course.

That's not the only case where borderline or mistaken behavior is caught 
on assignment, but not on access.  The argument is that assignment can 
afford to check things, but access needs to be fast.  Slot access is 
another case.  There, assignment ensures legality so access can be quick.

The catch is that there are sometimes backdoor ways to assignments, 
partly because slots, attributes and some "builtin" properties like 
names overlap.

What we were talking about before was trying to evolve a sensible rule 
for assigning names to S4 objects.  Let's try to discuss what people 
need to do before carping or indulging in sarcasm.

John

>
> H.
>
>
>> You could do
>> a at names if you thought that made sense:
>>
>>
>> > setClass("A", representation(names="character"))
>> [1] "A"
>> > a <- new("A")
>> > a at names <- "xx"
>> > a at names
>> [1] "xx"
>> > names(a)
>> NULL
>>
>>
>> If you wanted something sensible, it's more like:
>>
>> > setClass("B", representation(names = "character"), contains =
>> "integer")
>> [1] "B"
>> > b <- new("B", 1:5)
>> > names(b) <- letters[1:5]
>> > b
>> An object of class "B"
>> [1] 1 2 3 4 5
>> Slot "names":
>> [1] "a" "b" "c" "d" "e"
>>
>> > names(b)
>> [1] "a" "b" "c" "d" "e"
>>
>> This allows both the S4 and the primitive code to deal with a
>> well-defined object.
>>
>> John
>>
>>
>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>> This is basically a case of a user error that is not being caught:
>>>
>>> Sure!
>>>
>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>> ......
>>
>>>
>>> Ah, that's interesting. I didn't know I could put a names slot in my
>>> class. Last time I tried was at least 3 years ago and that was causing
>>> problems (don't remember the exact details) so I ended up using NAMES
>>> instead. Trying again with R-2.14:
>>>
>>> > setClass("A", representation(names="character"))
>>>
>>> > a <- new("A")
>>>
>>> > attributes(a)
>>> $names
>>> character(0)
>>>
>>> $class
>>> [1] "A"
>>> attr(,"package")
>>> [1] ".GlobalEnv"
>>>
>>> > names(a)
>>> NULL
>>>
>>> > names(a) <- "K"
>>>
>>> > attributes(a)
>>> $names
>>> [1] "K"
>>>
>>> $class
>>> [1] "A"
>>> attr(,"package")
>>> [1] ".GlobalEnv"
>>>
>>> > names(a)
>>> NULL
>>>
>>> Surprise! But that's another story...
>>>
>>>>
>>>> The modification that would make sense would be to give you an error in
>>>> the above code. Not a bad idea, but it's likely to generate more
>>>> complaints in other contexts, particularly where people don't
>>>> distinguish the "list" class from lists with names (the "namedList"
>>>> class).
>>>>
>>>> A plausible strategy:
>>>> 1. If the class has a vector data slot and no names slot, assign the
>>>> names but with a warning.
>>>>
>>>> 2. Otherwise, throw an error.
>>>>
>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>
>>> Or, at a minimum (if no consensus can be reached about the above
>>> strategy), not add a "names" attribute set to NULL. My original
>>> post was more about keeping the internal representation of objects
>>> "normalized", in general, so identical() is more likely to be
>>> meaningful.
>>>
>>> Thanks,
>>> H.
>>>
>>>>
>>>> Comments?
>>>>
>>>> John
>>>>
>>>>
>>>>>
>>>>> Thanks,
>>>>> H.
>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>
>


From hpages at fhcrc.org  Mon May 16 23:23:28 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 16 May 2011 14:23:28 -0700
Subject: [Rd] R html help system [Was: How to document man/*.Rd pages
 with images?]
In-Reply-To: <C9F6E208.4212%sean.mcguffee@gmail.com>
References: <C9F6E208.4212%sean.mcguffee@gmail.com>
Message-ID: <4DD195D0.70508@fhcrc.org>

Hi Sean,

On 11-05-16 11:15 AM, Sean Robert McGuffee wrote:
>
>
>
> On 5/13/11 8:20 PM, "Simon Urbanek"<simon.urbanek at r-project.org>  wrote:
>
>>
>> On May 13, 2011, at 7:08 PM, Sean Robert McGuffee wrote:
[...]
>>> In the satus quo, I can see how the choice of which pages to look at is
>>> dynamic if more than one comes up on a search, but it seems inefficient to me
>>> to have the page itself be dynamic. I think it would be a good idea if
>>> package authors could at least have an option to have their help pages
>>> produced as files either way.
>>
>> That decision is left to the user - you can use --html to generate html pages.
>
> This is appealing to me, but I can't seem to find any info about it. Maybe
> having the "--" part of the "--help" is throwing off my searches. I couldn't
> find "--help" when I searched R's help. If my package is named MyPackage,
> how would a user generate the html pages from it with "--html"?

I guess by "user" Simon meant the person who installed the package
(--html is an option to R CMD INSTALL), which AFAICT is not necessarily
the same as the user. In any case, it seems that this is not in the
hands of the package author.

H.


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fhcrc.org  Tue May 17 01:13:34 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 16 May 2011 16:13:34 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD18EB4.2060509@r-project.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
	<4DD15A2D.9020504@fhcrc.org> <4DD18EB4.2060509@r-project.org>
Message-ID: <4DD1AF9E.7030104@fhcrc.org>

On 11-05-16 01:53 PM, John Chambers wrote:
>
>
> On 5/16/11 10:09 AM, Herv? Pag?s wrote:
>> On 11-05-16 09:36 AM, John Chambers wrote:
>>> You set up a names slot in a non-vector. Maybe that should be allowed,
>>> maybe not. But in any case I would not expect the names() primitive to
>>> find it, because your object has a non-vector type ("S4").
>>
>> But the names<-() primitive *does* find it. So either names() and
>> names<-() should both find it, or they shouldn't. I mean, if you care
>> about consistency and predictability of course.
>
> That's not the only case where borderline or mistaken behavior is caught
> on assignment, but not on access. The argument is that assignment can
> afford to check things, but access needs to be fast. Slot access is
> another case. There, assignment ensures legality so access can be quick.
>
> The catch is that there are sometimes backdoor ways to assignments,
> partly because slots, attributes and some "builtin" properties like
> names overlap.
>
> What we were talking about before was trying to evolve a sensible rule
> for assigning names to S4 objects. Let's try to discuss what people need
> to do before carping or indulging in sarcasm.

What *you* were talking about but not what my original post was about.
Anyway, about the following proposal:

    1.  If the class has a vector data slot and no names slot, assign 
the names but with a warning.

    2. Otherwise, throw an error.

   (I.e., I would prefer an error throughout, but discretion ....)

I personally don't like it because it breaks inheritance. Let's
say I have a class B with a vector data slot and no names slot.
According to 1. names<-() would work out-of-the-box on it (with
a warning), but now if I extend it by adding a names slot, it
breaks.

One thing to consider though is that this works right now (and with
no warning):

   > setClass("I", contains="integer")
   [1] "I"
   > i <- new("I", 1:4)
   > names(i) <- LETTERS[1:4]
   > attributes(i)
   $class
   [1] "I"
   attr(,"package")
   [1] ".GlobalEnv"

   $names
   [1] "A" "B" "C" "D"

   > names(i)
   [1] "A" "B" "C" "D"

and it's probably what most people would expect (sounds reasonable
after all). So this needs to keep working (with no warning). I can
see 2 ways to avoid breaking inheritance:

   (a) not allow a names slot to be added to class I or any
       of its subclasses (in other words the .Data and names
       slots cannot coexist),
or
   (b) have names() and names<-() keep working when the names slot is
       added but that is maybe dangerous as it might break C code that
       is trying to access the names, that is, inheritance might break
       but now at the C level

Now for classes that don't have a .Data slot, they can of course
have a names slot. I don't have a strong opinion on whether names()
and names<-() should access it by default, but honestly that's really
a very small convenience offered to the developer of the class. Also,
for the sake of consistency, the same would need to be done for dim,
dimnames and built-in attributes in general. And also that won't work
if those built-in-attributes-made-slots are not declared with the right
type in the setClass statement (i.e. "character" for names, "integer"
for dim, etc...). And also by default names() would return character(0)
and not NULL. So in the end, potentially a lot of complications /
surprise / inconsistencies for very little value.

Thanks,
H.

>
> John
>
>>
>> H.
>>
>>
>>> You could do
>>> a at names if you thought that made sense:
>>>
>>>
>>> > setClass("A", representation(names="character"))
>>> [1] "A"
>>> > a <- new("A")
>>> > a at names <- "xx"
>>> > a at names
>>> [1] "xx"
>>> > names(a)
>>> NULL
>>>
>>>
>>> If you wanted something sensible, it's more like:
>>>
>>> > setClass("B", representation(names = "character"), contains =
>>> "integer")
>>> [1] "B"
>>> > b <- new("B", 1:5)
>>> > names(b) <- letters[1:5]
>>> > b
>>> An object of class "B"
>>> [1] 1 2 3 4 5
>>> Slot "names":
>>> [1] "a" "b" "c" "d" "e"
>>>
>>> > names(b)
>>> [1] "a" "b" "c" "d" "e"
>>>
>>> This allows both the S4 and the primitive code to deal with a
>>> well-defined object.
>>>
>>> John
>>>
>>>
>>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>>> This is basically a case of a user error that is not being caught:
>>>>
>>>> Sure!
>>>>
>>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>>> ......
>>>
>>>>
>>>> Ah, that's interesting. I didn't know I could put a names slot in my
>>>> class. Last time I tried was at least 3 years ago and that was causing
>>>> problems (don't remember the exact details) so I ended up using NAMES
>>>> instead. Trying again with R-2.14:
>>>>
>>>> > setClass("A", representation(names="character"))
>>>>
>>>> > a <- new("A")
>>>>
>>>> > attributes(a)
>>>> $names
>>>> character(0)
>>>>
>>>> $class
>>>> [1] "A"
>>>> attr(,"package")
>>>> [1] ".GlobalEnv"
>>>>
>>>> > names(a)
>>>> NULL
>>>>
>>>> > names(a) <- "K"
>>>>
>>>> > attributes(a)
>>>> $names
>>>> [1] "K"
>>>>
>>>> $class
>>>> [1] "A"
>>>> attr(,"package")
>>>> [1] ".GlobalEnv"
>>>>
>>>> > names(a)
>>>> NULL
>>>>
>>>> Surprise! But that's another story...
>>>>
>>>>>
>>>>> The modification that would make sense would be to give you an
>>>>> error in
>>>>> the above code. Not a bad idea, but it's likely to generate more
>>>>> complaints in other contexts, particularly where people don't
>>>>> distinguish the "list" class from lists with names (the "namedList"
>>>>> class).
>>>>>
>>>>> A plausible strategy:
>>>>> 1. If the class has a vector data slot and no names slot, assign the
>>>>> names but with a warning.
>>>>>
>>>>> 2. Otherwise, throw an error.
>>>>>
>>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>
>>>> Or, at a minimum (if no consensus can be reached about the above
>>>> strategy), not add a "names" attribute set to NULL. My original
>>>> post was more about keeping the internal representation of objects
>>>> "normalized", in general, so identical() is more likely to be
>>>> meaningful.
>>>>
>>>> Thanks,
>>>> H.
>>>>
>>>>>
>>>>> Comments?
>>>>>
>>>>> John
>>>>>
>>>>>
>>>>>>
>>>>>> Thanks,
>>>>>> H.
>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>
>>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mwkimpel at gmail.com  Tue May 17 04:50:32 2011
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Mon, 16 May 2011 22:50:32 -0400
Subject: [Rd] R crashes if "toFile" given "~/" in Linux envirnonment
Message-ID: <BANLkTi=BqbLBC7yQ+ChtxM_OOnkJEXGfpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110516/a40aa3e2/attachment.pl>

From simon.urbanek at r-project.org  Tue May 17 05:02:08 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 16 May 2011 23:02:08 -0400
Subject: [Rd] R crashes if "toFile" given "~/" in Linux envirnonment
In-Reply-To: <BANLkTi=BqbLBC7yQ+ChtxM_OOnkJEXGfpg@mail.gmail.com>
References: <BANLkTi=BqbLBC7yQ+ChtxM_OOnkJEXGfpg@mail.gmail.com>
Message-ID: <EDF90C14-0996-4130-BEAB-41726A8223A6@r-project.org>

Mark,

I think you have the wrong list - this has nothing to do with R. to File() is a function in Rgraphviz and it doesn't crash, it simply exits R. Obviously it doesn't support path expansion (I suppose it should consider calling path.expand()) and it should also consider using R_error() instead of quitting -- but both issues should be best addressed to the Rgraphviz maintainers.

Cheers,
Simon


On May 16, 2011, at 10:50 PM, Mark Kimpel wrote:

> I was running some sample code from a help page tonight and wished to
> redirect the sample output to my Desktop under Linux (Mint-Debian 64 if it
> makes a different). I was surprised to find that file name expansion using
> the ubuquitious "~/" was not recognized, in fact it caused R to crash. Is
> this expected behavior? See my output below and sessionInfo().  Also, not
> shown, but 'setwd("~/Desktop")' works just fine.  Thanks, Mark
> 
> # sample code from Rgraphviz clusterData help page
> library(graph)
> library(Rgraphviz)
> g1_gz <- gzfile(system.file("GXL/graphExample-01.gxl.gz",package="graph"),
> open="rb")
> g11_gz <- gzfile(system.file("GXL/graphExample-11.gxl.gz",package="graph"),
> open="rb")
> g1 <- fromGXL(g1_gz)
> g11 <- fromGXL(g11_gz)
> g1_11 <- join(g1, g11)
> sgl <- vector(mode="list", length=2)
> sgl[[1]] <- list(graph=g1, cluster=TRUE)
> sgl[[2]] <- list(graph=g11, cluster=TRUE)
> ng <- agopenSimple(g1_11, "tmpsg", subGList=sgl)
> clusterData(ng, 1, c("bgcolor")) <- c("blue")
> clusterData(ng, 2, c("bgcolor")) <- c("red")
> ############################################
> # and now 2 usually equivalent ways to specify the location for output file,
> with the second way crashing:
> toFile(ng, layoutType="dot", filename="/home/mkimpel/Desktop/g1_11_dot.ps",
> fileType="ps")
> NULL
> toFile(ng, layoutType="dot", filename="~/Desktop/g1_11_dot.ps",
> fileType="ps")
> ~/Desktop/g1_11_dot.ps: No such file or directory
> 
> Process R exited abnormally with code 1 at Mon May 16 22:42:12 2011
> #################################################
> # and my sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> locale:
> [1] LC_CTYPE=en_US.utf8       LC_NUMERIC=C
> LC_TIME=en_US.utf8        LC_COLLATE=en_US.utf8     LC_MONETARY=C
> 
> [6] LC_MESSAGES=en_US.utf8    LC_PAPER=en_US.utf8
> LC_NAME=C                 LC_ADDRESS=C              LC_TELEPHONE=C
> 
> [11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices datasets  utils     methods   base
> ####################################################
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN  46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 399-1219 Skype No Voicemail please
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From mwkimpel at gmail.com  Tue May 17 05:05:53 2011
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Mon, 16 May 2011 23:05:53 -0400
Subject: [Rd] R crashes if "toFile" given "~/" in Linux envirnonment
In-Reply-To: <EDF90C14-0996-4130-BEAB-41726A8223A6@r-project.org>
References: <BANLkTi=BqbLBC7yQ+ChtxM_OOnkJEXGfpg@mail.gmail.com>
	<EDF90C14-0996-4130-BEAB-41726A8223A6@r-project.org>
Message-ID: <BANLkTinhUALuu9LnT6vvRMc4JfUt9G+ufQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110516/c7f33194/attachment.pl>

From hb at biostat.ucsf.edu  Tue May 17 05:59:56 2011
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Mon, 16 May 2011 20:59:56 -0700
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <4DCDA3ED.4050607@gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
	<4DCDA3ED.4050607@gmail.com>
Message-ID: <BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>

Great, thanks for this.

On Fri, May 13, 2011 at 2:34 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> A simple version of a fix is now in R-devel: ?if the .RData file can't be
> loaded during startup, an error message is printed, and R starts with an
> empty workspace.

I've just verified with the R v2.14.0 devel (2011-05-16 r55916) on
Windows.  For followers, here it is how it works now:

# GENERATE AN INVALID .RData file:
install.packages("fortunes")
library("fortunes")
foo <- fortune
remove.packages("fortunes")
q("yes")

Startup behavior when using either Rterm or Rgui:
[...]
Type 'q()' to quit R.

Error in loadNamespace(name) : there is no package called 'fortunes'
During startup - Warning message:
unable to restore saved data in .RData
> cat("Hello world!\n")
Hello world!
>

>
> The name of the .RData file is printed. ?It's usually just ".RData", because
> that's what R tries to load; the file will be in the current directory if
> you want to delete it.

I've looked at the code behind this and I kind of understand what you
mean by "just" .RData.  However, is there a reason for not reporting
the full pathname to .RData, e.g. file.path(getwd(), ".RData")?  It
would help the user further if the warning said:

(1) unable to restore saved data in .RData in directory /path/to/pwd/
(2) unable to restore saved data in /path/to/pwd/.RData

BTW, the following will not be correct if the working directory is
changed by one of the .Rprofile startup scripts:

(2) unable to restore saved data in .RData in the current working
directory, cf. getwd()

Thanks again

/Henrik

>?If it contains objects that you want to recover, you
> can try to deal with the error message (e.g. by installing fortunes in your
> example), exiting without saving, and then the next restart may succeed.
>
> Duncan Murdoch
>
>
> On 11-05-12 2:26 PM, Henrik Bengtsson wrote:
>>
>> On Thu, May 12, 2011 at 10:55 AM, Henrik Bengtsson<hb at biostat.ucsf.edu>
>> ?wrote:
>>>
>>> This might have been discussed before, but below is a
>>> "not-so-unlikely" use case where the user follows normal procedures,
>>> updates R to a major release version, and then R crashes:
>>>
>>> 1. Use runs R stable (e.g. v2.13.0).
>>> 2. User installs a package with a namespace, e.g.
>>> install.packages("fortunes").
>>> 3. User uses the package and one of the package's objects are assigned
>>> to the global env, e.g. foo<- fortune.
>>> 4. The user quits R and stores the session data, e.g. q("yes"). ?The
>>> session is stored in users home directory.
>>> 5. User update to new major release of R (e.g. 2.14.0).
>>> 6. User starts R. ?R crashes with "Fatal error: unable to restore
>>> saved object in .RData" because 'fortunes' is not installed for this
>>> new version of R. ?There is also an error message before that
>>> reporting "Error in loadNamespace(name) : there is no package called
>>> 'fortunes'".
>>>
>>> This can also be reproduced using a single R version as follows:
>>>
>>> 1. Start R and do:
>>> install.packages("fortunes")
>>> library("fortunes")
>>> foo<- fortune
>>> remove.packages("fortunes")
>>> q("yes")
>>> 2. Restart R. ?R crashes.
>>>
>>> For a GUI-only user this is complicated, because although the users
>>> sees the informative error message that "Error in loadNamespace(name)
>>> : there is no package called 'fortunes'", s/he cannot get to the point
>>> where it is possible to install that missing package. ?The key for the
>>> user is to understand to remove the .RData. ?In order to do this, s/he
>>> has to locate that file first.
>>>
>>> To simplify this, a few alternatives exists:
>>>
>>> 1. R reports the full path to the problematic .RData file.
>>> 2. R renames the problematic .RData file to
>>> erroneous_20110512-123404UTC.RData and reports the new full pathname.
>>>
>>> In both cases there could be the option for R to either exit, or
>>> ignore the problematic .RData file and give the user access to the
>>> prompt. ?One could also imaging a fancy recovery feature where R
>>> detects "erroneous" .RData files and asks the user if s/he wish to try
>>> to load them (maybe the packages has been installed since).
>>
>> On Windows, the easiest way to give a GUI-only user access to the R
>> prompt is to also install an "R (vanilla mode)" shortcut/icon on the
>> Startup menu and Desktop (with target "...\Rgui.exe" --vanilla) in
>> addition to the default one.
>>
>> /Henrik
>>
>>>
>>> I'm sure there are complications to implement the above, because
>>> .RData is loaded during startup, but that's my $.02 to this problem
>>>
>>> /Henrik
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hpages at fhcrc.org  Tue May 17 07:00:18 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 16 May 2011 22:00:18 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD1AF9E.7030104@fhcrc.org>
References: <4DCF0676.5070407@fhcrc.org>
	<4DD01C87.8040202@r-project.org>	<4DD04D72.9070807@fhcrc.org>
	<4DD15299.7090000@r-project.org>	<4DD15A2D.9020504@fhcrc.org>
	<4DD18EB4.2060509@r-project.org> <4DD1AF9E.7030104@fhcrc.org>
Message-ID: <4DD200E2.90706@fhcrc.org>

On 11-05-16 04:13 PM, Herv? Pag?s wrote:
> On 11-05-16 01:53 PM, John Chambers wrote:
>>
>>
>> On 5/16/11 10:09 AM, Herv? Pag?s wrote:
>>> On 11-05-16 09:36 AM, John Chambers wrote:
>>>> You set up a names slot in a non-vector. Maybe that should be allowed,
>>>> maybe not. But in any case I would not expect the names() primitive to
>>>> find it, because your object has a non-vector type ("S4").
>>>
>>> But the names<-() primitive *does* find it. So either names() and
>>> names<-() should both find it, or they shouldn't. I mean, if you care
>>> about consistency and predictability of course.
>>
>> That's not the only case where borderline or mistaken behavior is caught
>> on assignment, but not on access. The argument is that assignment can
>> afford to check things, but access needs to be fast. Slot access is
>> another case. There, assignment ensures legality so access can be quick.
>>
>> The catch is that there are sometimes backdoor ways to assignments,
>> partly because slots, attributes and some "builtin" properties like
>> names overlap.
>>
>> What we were talking about before was trying to evolve a sensible rule
>> for assigning names to S4 objects. Let's try to discuss what people need
>> to do before carping or indulging in sarcasm.
>
> What *you* were talking about but not what my original post was about.
> Anyway, about the following proposal:
>
> 1. If the class has a vector data slot and no names slot, assign the
> names but with a warning.
>
> 2. Otherwise, throw an error.
>
> (I.e., I would prefer an error throughout, but discretion ....)
>
> I personally don't like it because it breaks inheritance. Let's
> say I have a class B with a vector data slot and no names slot.
> According to 1. names<-() would work out-of-the-box on it (with
> a warning), but now if I extend it by adding a names slot, it
> breaks.
>
> One thing to consider though is that this works right now (and with
> no warning):
>
>  > setClass("I", contains="integer")
> [1] "I"
>  > i <- new("I", 1:4)
>  > names(i) <- LETTERS[1:4]
>  > attributes(i)
> $class
> [1] "I"
> attr(,"package")
> [1] ".GlobalEnv"
>
> $names
> [1] "A" "B" "C" "D"
>
>  > names(i)
> [1] "A" "B" "C" "D"
>
> and it's probably what most people would expect (sounds reasonable
> after all). So this needs to keep working (with no warning). I can
> see 2 ways to avoid breaking inheritance:
>
> (a) not allow a names slot to be added to class I or any
> of its subclasses (in other words the .Data and names
> slots cannot coexist),
> or
> (b) have names() and names<-() keep working when the names slot is
> added but that is maybe dangerous as it might break C code that
> is trying to access the names, that is, inheritance might break
> but now at the C level
>
> Now for classes that don't have a .Data slot, they can of course
> have a names slot. I don't have a strong opinion on whether names()
> and names<-() should access it by default, but honestly that's really
> a very small convenience offered to the developer of the class. Also,
> for the sake of consistency, the same would need to be done for dim,
> dimnames and built-in attributes in general. And also that won't work
> if those built-in-attributes-made-slots are not declared with the right
> type in the setClass statement (i.e. "character" for names, "integer"
> for dim, etc...). And also by default names() would return character(0)
> and not NULL. So in the end, potentially a lot of complications /
> surprise / inconsistencies for very little value.

But again (sorry to insist), it's not as important IMO what the
final rules for assigning names to S4 object are, than having
consistent rules. Consistent not only between names<-() and names(),
but also across "builtin" properties. For example (and focusing on
S4 objects with no .Data slot here):

   > setClass("A", representation(aa="integer"))
   [1] "A"
   > a <- new("A")
   > names(a) <- "K"
   > dim(a) <- 3:2
   Error in dim(a) <- 3:2 : invalid first argument
   > levels(a) <- letters[1:3]

Why dim<- returned an error but not levels<- or names<-?

   > attributes(a)
   $aa
   integer(0)

   $class
   [1] "A"
   attr(,"package")
   [1] ".GlobalEnv"

   $names
   [1] "K"

   $levels
   [1] "a" "b" "c"

   > names(a)
   NULL

   > levels(a)
   [1] "a" "b" "c"

Why levels() was able to see its attribute but not names()?

   > attr(a, "names")
   [1] "K"

   > attr(a, "levels")
   [1] "a" "b" "c"

Why isn't attr(a, "names") equivalent to names(a)?

   > setClass("B", representation(bb="integer",
                                  names="character",
                                  dim="integer"))
   [1] "B"

   > b <- new("B")

   > attr(b, "bb") <- 11:16

   > b at bb
   [1] 11 12 13 14 15 16

   > attr(b, "names") <- LETTERS[1:6]

   > names(b)
   NULL

   > b at names
   [1] "A" "B" "C" "D" "E" "F"

   > b at dim <- 3:2

   > dim(b)
   [1] 3 2

   > attr(b, "dim")
   [1] 3 2

   > attr(b, "dim") <- 5:4
   Error in attr(b, "dim") <- 5:4 : invalid first argument

Why is the dim slot an exception to the "slots are treated
as attributes" rule?

Thanks,
H.


>
> Thanks,
> H.
>
>>
>> John
>>
>>>
>>> H.
>>>
>>>
>>>> You could do
>>>> a at names if you thought that made sense:
>>>>
>>>>
>>>> > setClass("A", representation(names="character"))
>>>> [1] "A"
>>>> > a <- new("A")
>>>> > a at names <- "xx"
>>>> > a at names
>>>> [1] "xx"
>>>> > names(a)
>>>> NULL
>>>>
>>>>
>>>> If you wanted something sensible, it's more like:
>>>>
>>>> > setClass("B", representation(names = "character"), contains =
>>>> "integer")
>>>> [1] "B"
>>>> > b <- new("B", 1:5)
>>>> > names(b) <- letters[1:5]
>>>> > b
>>>> An object of class "B"
>>>> [1] 1 2 3 4 5
>>>> Slot "names":
>>>> [1] "a" "b" "c" "d" "e"
>>>>
>>>> > names(b)
>>>> [1] "a" "b" "c" "d" "e"
>>>>
>>>> This allows both the S4 and the primitive code to deal with a
>>>> well-defined object.
>>>>
>>>> John
>>>>
>>>>
>>>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>>>> This is basically a case of a user error that is not being caught:
>>>>>
>>>>> Sure!
>>>>>
>>>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>>>> ......
>>>>
>>>>>
>>>>> Ah, that's interesting. I didn't know I could put a names slot in my
>>>>> class. Last time I tried was at least 3 years ago and that was causing
>>>>> problems (don't remember the exact details) so I ended up using NAMES
>>>>> instead. Trying again with R-2.14:
>>>>>
>>>>> > setClass("A", representation(names="character"))
>>>>>
>>>>> > a <- new("A")
>>>>>
>>>>> > attributes(a)
>>>>> $names
>>>>> character(0)
>>>>>
>>>>> $class
>>>>> [1] "A"
>>>>> attr(,"package")
>>>>> [1] ".GlobalEnv"
>>>>>
>>>>> > names(a)
>>>>> NULL
>>>>>
>>>>> > names(a) <- "K"
>>>>>
>>>>> > attributes(a)
>>>>> $names
>>>>> [1] "K"
>>>>>
>>>>> $class
>>>>> [1] "A"
>>>>> attr(,"package")
>>>>> [1] ".GlobalEnv"
>>>>>
>>>>> > names(a)
>>>>> NULL
>>>>>
>>>>> Surprise! But that's another story...
>>>>>
>>>>>>
>>>>>> The modification that would make sense would be to give you an
>>>>>> error in
>>>>>> the above code. Not a bad idea, but it's likely to generate more
>>>>>> complaints in other contexts, particularly where people don't
>>>>>> distinguish the "list" class from lists with names (the "namedList"
>>>>>> class).
>>>>>>
>>>>>> A plausible strategy:
>>>>>> 1. If the class has a vector data slot and no names slot, assign the
>>>>>> names but with a warning.
>>>>>>
>>>>>> 2. Otherwise, throw an error.
>>>>>>
>>>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>>
>>>>> Or, at a minimum (if no consensus can be reached about the above
>>>>> strategy), not add a "names" attribute set to NULL. My original
>>>>> post was more about keeping the internal representation of objects
>>>>> "normalized", in general, so identical() is more likely to be
>>>>> meaningful.
>>>>>
>>>>> Thanks,
>>>>> H.
>>>>>
>>>>>>
>>>>>> Comments?
>>>>>>
>>>>>> John
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> Thanks,
>>>>>>> H.
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>
>>>
>
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From Stefan.Hoj-Edwards at agrsci.dk  Mon May 16 12:39:20 2011
From: Stefan.Hoj-Edwards at agrsci.dk (=?iso-8859-1?Q?Stefan_McKinnon_H=F8j-Edwards?=)
Date: Mon, 16 May 2011 12:39:20 +0200
Subject: [Rd] RCMD check fails on "checkin installed package size"
In-Reply-To: <4DCBCE6D.1050100@gmail.com>
References: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F89B@DJFEXMBX01.djf.agrsci.dk>
	<alpine.LFD.2.02.1105111247140.8673@toucan.stats.ox.ac.uk>
	<1C56F3EE22DF4F458FE02F58B96D4150555EA9F8A3@DJFEXMBX01.djf.agrsci.dk>
	<4DCBCE6D.1050100@gmail.com>
Message-ID: <1C56F3EE22DF4F458FE02F58B96D4150555EA9F965@DJFEXMBX01.djf.agrsci.dk>

Hello Duncan,

This is what I get:
C:\Users\STME\Documents\R\win-library\2.13\AnnotationFuncs>du -k
209     ./doc
24      ./help
8       ./html
9       ./Meta
10      ./R
279     .

Kind regards,

Stefan McKinnon H?j-Edwards     Dept. of Genetics and Biotechnology
PhD student                     Faculty of Agricultural Sciences
stefan.hoj-edwards at agrsci.dk    Aarhus University
Tel.: +45 8999 1291             Blichers All? 20, Postboks 50
Web: www.iysik.com              DK-8830?Tjele
                                Tel.: +45 8999 1900
                                Web: www.agrsci.au.dk



-----Oprindelig meddelelse-----
Fra: Duncan Murdoch [mailto:murdoch.duncan at gmail.com] 
Sendt: 12. maj 2011 14:11
Til: Stefan McKinnon H?j-Edwards
Cc: Prof Brian Ripley; r-devel at r-project.org
Emne: Re: [Rd] RCMD check fails on "checkin installed package size"

On 11/05/2011 8:07 AM, Stefan McKinnon H?j-Edwards wrote:
> Thanks. It worked.
> I added the line "_R_CHECK_PKG_SIZES_=no" to /etc/Rcmd_environ (I am the only user of this computer).
>
> Regarding the 'du' executable, it is found in the first directory in the PATH environment variable and came with Rtools for R 2.13.

R CMD check will try to run "du -k" while the current directory is the 
one where it just installed the package during the check.  If you do 
that from the command line, (i.e. install AnnotationFuncs, switch to 
RHOME/library/AnnotationFuncs, and run "du -k") what do you see as output?

Duncan Murdoch
> Kind regards,
> Stefan McKinnon H?j-Edwards
> PhD student
> Dept. of Genetics and Biotechnology
> Faculty of Agricultural Sciences
> Aarhus University
> Blichers All? 20, Postboks 50
> DK-8830 Tjele
>
> Tel.: +45 8999 1291
> Email: stefanm.edwards at agrsci.dk
>
> Tel.: +45 8999 1900
> Web: www.agrsci.au.dk
>
>
>
>
> -----Oprindelig meddelelse-----
> Fra: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Sendt: 11. maj 2011 13:51
> Til: Stefan McKinnon H?j-Edwards
> Cc: r-devel at r-project.org
> Emne: Re: [Rd] RCMD check fails on "checkin installed package size"
>
> On Wed, 11 May 2011, Stefan McKinnon H?j-Edwards wrote:
>
> >  Hi,
> >
> >  When I run RCMD check on my package, I receive the following error:
> >  C:\R-packages\AnnotationFuncs>RCMD check --no-vignettes AnnotationFuncs
> >  * using log directory 'C:/R-packages/AnnotationFuncs/AnnotationFuncs.Rcheck'
> >  * using R version 2.13.0 (2011-04-13)
> >  * using platform: i386-pc-mingw32 (32-bit)
> >  * using session charset: ISO8859-1
> >  * using option '--no-vignettes'
> >  * checking for file 'AnnotationFuncs/DESCRIPTION' ... OK
> >  * this is package 'AnnotationFuncs' version '1.1.2'
> >  * checking package name space information ... OK
> >  * checking package dependencies ... OK
> >  * checking if this is a source package ... OK
> >  * checking for executable files ... OK
> >  * checking whether package 'AnnotationFuncs' can be installed ... OK
> >  * checking installed package size ...Error in if (total>  1024 * 5) { : missing
> >  value where TRUE/FALSE needed
> >  Execution halted
> >
> >
> >  I am running it on Windows 7 (32-bit) and my PATH environment variable starts with this:
> >  C:\Rtools\bin;C:\Rtools\MinGW\bin;C:\Program Files\R\R-2.13.0\bin\i386;
> >
> >  I have updated Rtools to the newest with 2.13.
> >
> >  Any suggestions?
>
> Set _R_CHECK_PKG_SIZES_ to 'no' (see 'Writing R Extensions' and its
> references on customizing R CMD check), or correct your paths so the
> 'du' program in Rtools is the one that is found.  (The only reported
> example was from using a different 'du' program.)
>
> I believe that current R-patched works around this: R-devel definitely
> does.
>
> >
> >  Thanks in advanced,
> >  Stefan McKinnon H?j-Edwards
> >
> >  ______________________________________________
> >  R-devel at r-project.org mailing list
> >  https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>


From murdoch.duncan at gmail.com  Tue May 17 12:54:17 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 17 May 2011 06:54:17 -0400
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>	<4DCDA3ED.4050607@gmail.com>
	<BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>
Message-ID: <4DD253D9.5070108@gmail.com>

On 11-05-16 11:59 PM, Henrik Bengtsson wrote:
> Great, thanks for this.
>
> On Fri, May 13, 2011 at 2:34 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com>  wrote:
>> A simple version of a fix is now in R-devel:  if the .RData file can't be
>> loaded during startup, an error message is printed, and R starts with an
>> empty workspace.
>
> I've just verified with the R v2.14.0 devel (2011-05-16 r55916) on
> Windows.  For followers, here it is how it works now:
>
> # GENERATE AN INVALID .RData file:
> install.packages("fortunes")
> library("fortunes")
> foo<- fortune
> remove.packages("fortunes")
> q("yes")
>
> Startup behavior when using either Rterm or Rgui:
> [...]
> Type 'q()' to quit R.
>
> Error in loadNamespace(name) : there is no package called 'fortunes'
> During startup - Warning message:
> unable to restore saved data in .RData
>> cat("Hello world!\n")
> Hello world!
>>
>
>>
>> The name of the .RData file is printed.  It's usually just ".RData", because
>> that's what R tries to load; the file will be in the current directory if
>> you want to delete it.
>
> I've looked at the code behind this and I kind of understand what you
> mean by "just" .RData.  However, is there a reason for not reporting
> the full pathname to .RData, e.g. file.path(getwd(), ".RData")?  It
> would help the user further if the warning said:

This is coming from C code, so getting the current directory requires 
allocating memory for a buffer.  We're in a situation where something 
that normally succeeds has just failed, so it might not be safe to do that.

> (1) unable to restore saved data in .RData in directory /path/to/pwd/
> (2) unable to restore saved data in /path/to/pwd/.RData

If the file that it tried to load was named "/path/to/.RData", then your 
messages wouldn't be right:

  (1) unable to restore saved data in /path/to/.RData in directory 
/path/to/pwd/
  (2) unable to restore saved data in /path/to/pwd//path/to/.RData

You really want something like normalizePath(), but that's not a simple 
C function (and it has its own problems, e.g. if the file doesn't exist,
normalizePath doesn't work, at least on Windows).

Duncan Murdoch


> BTW, the following will not be correct if the working directory is
> changed by one of the .Rprofile startup scripts:
>
> (2) unable to restore saved data in .RData in the current working
> directory, cf. getwd()
>
> Thanks again
>
> /Henrik
>
>>   If it contains objects that you want to recover, you
>> can try to deal with the error message (e.g. by installing fortunes in your
>> example), exiting without saving, and then the next restart may succeed.
>>
>> Duncan Murdoch
>>
>>
>> On 11-05-12 2:26 PM, Henrik Bengtsson wrote:
>>>
>>> On Thu, May 12, 2011 at 10:55 AM, Henrik Bengtsson<hb at biostat.ucsf.edu>
>>>   wrote:
>>>>
>>>> This might have been discussed before, but below is a
>>>> "not-so-unlikely" use case where the user follows normal procedures,
>>>> updates R to a major release version, and then R crashes:
>>>>
>>>> 1. Use runs R stable (e.g. v2.13.0).
>>>> 2. User installs a package with a namespace, e.g.
>>>> install.packages("fortunes").
>>>> 3. User uses the package and one of the package's objects are assigned
>>>> to the global env, e.g. foo<- fortune.
>>>> 4. The user quits R and stores the session data, e.g. q("yes").  The
>>>> session is stored in users home directory.
>>>> 5. User update to new major release of R (e.g. 2.14.0).
>>>> 6. User starts R.  R crashes with "Fatal error: unable to restore
>>>> saved object in .RData" because 'fortunes' is not installed for this
>>>> new version of R.  There is also an error message before that
>>>> reporting "Error in loadNamespace(name) : there is no package called
>>>> 'fortunes'".
>>>>
>>>> This can also be reproduced using a single R version as follows:
>>>>
>>>> 1. Start R and do:
>>>> install.packages("fortunes")
>>>> library("fortunes")
>>>> foo<- fortune
>>>> remove.packages("fortunes")
>>>> q("yes")
>>>> 2. Restart R.  R crashes.
>>>>
>>>> For a GUI-only user this is complicated, because although the users
>>>> sees the informative error message that "Error in loadNamespace(name)
>>>> : there is no package called 'fortunes'", s/he cannot get to the point
>>>> where it is possible to install that missing package.  The key for the
>>>> user is to understand to remove the .RData.  In order to do this, s/he
>>>> has to locate that file first.
>>>>
>>>> To simplify this, a few alternatives exists:
>>>>
>>>> 1. R reports the full path to the problematic .RData file.
>>>> 2. R renames the problematic .RData file to
>>>> erroneous_20110512-123404UTC.RData and reports the new full pathname.
>>>>
>>>> In both cases there could be the option for R to either exit, or
>>>> ignore the problematic .RData file and give the user access to the
>>>> prompt.  One could also imaging a fancy recovery feature where R
>>>> detects "erroneous" .RData files and asks the user if s/he wish to try
>>>> to load them (maybe the packages has been installed since).
>>>
>>> On Windows, the easiest way to give a GUI-only user access to the R
>>> prompt is to also install an "R (vanilla mode)" shortcut/icon on the
>>> Startup menu and Desktop (with target "...\Rgui.exe" --vanilla) in
>>> addition to the default one.
>>>
>>> /Henrik
>>>
>>>>
>>>> I'm sure there are complications to implement the above, because
>>>> .RData is loaded during startup, but that's my $.02 to this problem
>>>>
>>>> /Henrik
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From Mark.Bravington at csiro.au  Tue May 17 14:33:59 2011
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Tue, 17 May 2011 22:33:59 +1000
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <4DD253D9.5070108@gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
	<4DCDA3ED.4050607@gmail.com>
	<BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>,
	<4DD253D9.5070108@gmail.com>
Message-ID: <3D59DF35E7CF3E42BA70C23BD5CBE6A85F42B80D2A@exvic-mbx04.nexus.csiro.au>

The ability to do a "wounded load", when a proper load() can't be completed but you still want as much of the stuff as possible, would be very useful. In my experience, the trouble has invariably been a missing namespace, eg (as in Henrik's example) from a package that can't be found. That's OK if the package can be identified and updated. But sometimes it can't be-- maybe it just doesn't exist for the latest greatest version of R, or the developer has decided to work in Q instead, or the internet is having a bad day. If there are lots of useful objects in the .RData, but a few things that won't load, it's pretty bad to lose the whole lot. So triggering an comprehensible error is useful for the specific case Henrik gives, but if this is being looked at anyway, perhaps more could be done.

How about giving load() an optional argument, such that if a (namespace?) environment is sought but can't be found, then it is replaced with emptyenv(), with a warning. That should stop catastrophic behaviour later on.

I wonder whether the "refhook" argument of 'unserialize' could somehow be perverted into doing this? Dunno, just a thought.

There might be other things besides missing packages that could cause a load() to fail, but I think all the cases I've come across have come down to that. It can be pretty hard to track down the problem, or worse than hard.

Mark Bravington
CSIRO CMIS
Marine Lab
Hobart
Australia
________________________________________
From: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] On Behalf Of Duncan Murdoch [murdoch.duncan at gmail.com]
Sent: 17 May 2011 20:54
To: Henrik Bengtsson
Cc: R-devel
Subject: Re: [Rd] Reproducible use case for R crash after updating R

On 11-05-16 11:59 PM, Henrik Bengtsson wrote:
> Great, thanks for this.
>
> On Fri, May 13, 2011 at 2:34 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com>  wrote:
>> A simple version of a fix is now in R-devel:  if the .RData file can't be
>> loaded during startup, an error message is printed, and R starts with an
>> empty workspace.
>
> I've just verified with the R v2.14.0 devel (2011-05-16 r55916) on
> Windows.  For followers, here it is how it works now:
>
> # GENERATE AN INVALID .RData file:
> install.packages("fortunes")
> library("fortunes")
> foo<- fortune
> remove.packages("fortunes")
> q("yes")
>
> Startup behavior when using either Rterm or Rgui:
> [...]
> Type 'q()' to quit R.
>
> Error in loadNamespace(name) : there is no package called 'fortunes'
> During startup - Warning message:
> unable to restore saved data in .RData
>> cat("Hello world!\n")
> Hello world!
>>
>
>>
>> The name of the .RData file is printed.  It's usually just ".RData", because
>> that's what R tries to load; the file will be in the current directory if
>> you want to delete it.
>
> I've looked at the code behind this and I kind of understand what you
> mean by "just" .RData.  However, is there a reason for not reporting
> the full pathname to .RData, e.g. file.path(getwd(), ".RData")?  It
> would help the user further if the warning said:

This is coming from C code, so getting the current directory requires
allocating memory for a buffer.  We're in a situation where something
that normally succeeds has just failed, so it might not be safe to do that.

> (1) unable to restore saved data in .RData in directory /path/to/pwd/
> (2) unable to restore saved data in /path/to/pwd/.RData

If the file that it tried to load was named "/path/to/.RData", then your
messages wouldn't be right:

  (1) unable to restore saved data in /path/to/.RData in directory
/path/to/pwd/
  (2) unable to restore saved data in /path/to/pwd//path/to/.RData

You really want something like normalizePath(), but that's not a simple
C function (and it has its own problems, e.g. if the file doesn't exist,
normalizePath doesn't work, at least on Windows).

Duncan Murdoch


> BTW, the following will not be correct if the working directory is
> changed by one of the .Rprofile startup scripts:
>
> (2) unable to restore saved data in .RData in the current working
> directory, cf. getwd()
>
> Thanks again
>
> /Henrik
>
>>   If it contains objects that you want to recover, you
>> can try to deal with the error message (e.g. by installing fortunes in your
>> example), exiting without saving, and then the next restart may succeed.
>>
>> Duncan Murdoch
>>
>>
>> On 11-05-12 2:26 PM, Henrik Bengtsson wrote:
>>>
>>> On Thu, May 12, 2011 at 10:55 AM, Henrik Bengtsson<hb at biostat.ucsf.edu>
>>>   wrote:
>>>>
>>>> This might have been discussed before, but below is a
>>>> "not-so-unlikely" use case where the user follows normal procedures,
>>>> updates R to a major release version, and then R crashes:
>>>>
>>>> 1. Use runs R stable (e.g. v2.13.0).
>>>> 2. User installs a package with a namespace, e.g.
>>>> install.packages("fortunes").
>>>> 3. User uses the package and one of the package's objects are assigned
>>>> to the global env, e.g. foo<- fortune.
>>>> 4. The user quits R and stores the session data, e.g. q("yes").  The
>>>> session is stored in users home directory.
>>>> 5. User update to new major release of R (e.g. 2.14.0).
>>>> 6. User starts R.  R crashes with "Fatal error: unable to restore
>>>> saved object in .RData" because 'fortunes' is not installed for this
>>>> new version of R.  There is also an error message before that
>>>> reporting "Error in loadNamespace(name) : there is no package called
>>>> 'fortunes'".
>>>>
>>>> This can also be reproduced using a single R version as follows:
>>>>
>>>> 1. Start R and do:
>>>> install.packages("fortunes")
>>>> library("fortunes")
>>>> foo<- fortune
>>>> remove.packages("fortunes")
>>>> q("yes")
>>>> 2. Restart R.  R crashes.
>>>>
>>>> For a GUI-only user this is complicated, because although the users
>>>> sees the informative error message that "Error in loadNamespace(name)
>>>> : there is no package called 'fortunes'", s/he cannot get to the point
>>>> where it is possible to install that missing package.  The key for the
>>>> user is to understand to remove the .RData.  In order to do this, s/he
>>>> has to locate that file first.
>>>>
>>>> To simplify this, a few alternatives exists:
>>>>
>>>> 1. R reports the full path to the problematic .RData file.
>>>> 2. R renames the problematic .RData file to
>>>> erroneous_20110512-123404UTC.RData and reports the new full pathname.
>>>>
>>>> In both cases there could be the option for R to either exit, or
>>>> ignore the problematic .RData file and give the user access to the
>>>> prompt.  One could also imaging a fancy recovery feature where R
>>>> detects "erroneous" .RData files and asks the user if s/he wish to try
>>>> to load them (maybe the packages has been installed since).
>>>
>>> On Windows, the easiest way to give a GUI-only user access to the R
>>> prompt is to also install an "R (vanilla mode)" shortcut/icon on the
>>> Startup menu and Desktop (with target "...\Rgui.exe" --vanilla) in
>>> addition to the default one.
>>>
>>> /Henrik
>>>
>>>>
>>>> I'm sure there are complications to implement the above, because
>>>> .RData is loaded during startup, but that's my $.02 to this problem
>>>>
>>>> /Henrik
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From jmc at r-project.org  Tue May 17 18:04:46 2011
From: jmc at r-project.org (John Chambers)
Date: Tue, 17 May 2011 09:04:46 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD1AF9E.7030104@fhcrc.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
	<4DD15A2D.9020504@fhcrc.org> <4DD18EB4.2060509@r-project.org>
	<4DD1AF9E.7030104@fhcrc.org>
Message-ID: <4DD29C9E.1050305@r-project.org>

One point that may have been unclear, though it's surprising if so.  The 
discussion was about assigning names to S4 objects from classes that do 
NOT have a formal "names" slot.  Of course, having a "names" slot is not 
illegal, it's what one should do to deal with names in S4.  Look at 
class "namedList" for example.

Assigning names() to such a class would go through without warning as it 
does now.

 > getClass("namedList")
Class "namedList" [package "methods"]

Slots:

Name:      .Data     names
Class:      list character

Extends:
Class "list", from data part
Class "vector", by class "list", distance 2

Known Subclasses: "listOfMethods"
 > xx <- new("namedList", list(a=1,b=2))
 > names(xx)
[1] "a" "b"
 > names(xx) <- c("D", "E")
 > xx at names
[1] "D" "E"
 >

There was no question of breaking inheritance.

On 5/16/11 4:13 PM, Herv? Pag?s wrote:
> On 11-05-16 01:53 PM, John Chambers wrote:
>>
>>
>> On 5/16/11 10:09 AM, Herv? Pag?s wrote:
>>> On 11-05-16 09:36 AM, John Chambers wrote:
>>>> You set up a names slot in a non-vector. Maybe that should be allowed,
>>>> maybe not. But in any case I would not expect the names() primitive to
>>>> find it, because your object has a non-vector type ("S4").
>>>
>>> But the names<-() primitive *does* find it. So either names() and
>>> names<-() should both find it, or they shouldn't. I mean, if you care
>>> about consistency and predictability of course.
>>
>> That's not the only case where borderline or mistaken behavior is caught
>> on assignment, but not on access. The argument is that assignment can
>> afford to check things, but access needs to be fast. Slot access is
>> another case. There, assignment ensures legality so access can be quick.
>>
>> The catch is that there are sometimes backdoor ways to assignments,
>> partly because slots, attributes and some "builtin" properties like
>> names overlap.
>>
>> What we were talking about before was trying to evolve a sensible rule
>> for assigning names to S4 objects. Let's try to discuss what people need
>> to do before carping or indulging in sarcasm.
>
> What *you* were talking about but not what my original post was about.
> Anyway, about the following proposal:
>
> 1. If the class has a vector data slot and no names slot, assign the
> names but with a warning.
>
> 2. Otherwise, throw an error.
>
> (I.e., I would prefer an error throughout, but discretion ....)
>
> I personally don't like it because it breaks inheritance. Let's
> say I have a class B with a vector data slot and no names slot.
> According to 1. names<-() would work out-of-the-box on it (with
> a warning), but now if I extend it by adding a names slot, it
> breaks.
>
> One thing to consider though is that this works right now (and with
> no warning):
>
>  > setClass("I", contains="integer")
> [1] "I"
>  > i <- new("I", 1:4)
>  > names(i) <- LETTERS[1:4]
>  > attributes(i)
> $class
> [1] "I"
> attr(,"package")
> [1] ".GlobalEnv"
>
> $names
> [1] "A" "B" "C" "D"
>
>  > names(i)
> [1] "A" "B" "C" "D"
>
> and it's probably what most people would expect (sounds reasonable
> after all). So this needs to keep working (with no warning). I can
> see 2 ways to avoid breaking inheritance:
>
> (a) not allow a names slot to be added to class I or any
> of its subclasses (in other words the .Data and names
> slots cannot coexist),
> or
> (b) have names() and names<-() keep working when the names slot is
> added but that is maybe dangerous as it might break C code that
> is trying to access the names, that is, inheritance might break
> but now at the C level
>
> Now for classes that don't have a .Data slot, they can of course
> have a names slot. I don't have a strong opinion on whether names()
> and names<-() should access it by default, but honestly that's really
> a very small convenience offered to the developer of the class. Also,
> for the sake of consistency, the same would need to be done for dim,
> dimnames and built-in attributes in general. And also that won't work
> if those built-in-attributes-made-slots are not declared with the right
> type in the setClass statement (i.e. "character" for names, "integer"
> for dim, etc...). And also by default names() would return character(0)
> and not NULL. So in the end, potentially a lot of complications /
> surprise / inconsistencies for very little value.
>
> Thanks,
> H.
>
>>
>> John
>>
>>>
>>> H.
>>>
>>>
>>>> You could do
>>>> a at names if you thought that made sense:
>>>>
>>>>
>>>> > setClass("A", representation(names="character"))
>>>> [1] "A"
>>>> > a <- new("A")
>>>> > a at names <- "xx"
>>>> > a at names
>>>> [1] "xx"
>>>> > names(a)
>>>> NULL
>>>>
>>>>
>>>> If you wanted something sensible, it's more like:
>>>>
>>>> > setClass("B", representation(names = "character"), contains =
>>>> "integer")
>>>> [1] "B"
>>>> > b <- new("B", 1:5)
>>>> > names(b) <- letters[1:5]
>>>> > b
>>>> An object of class "B"
>>>> [1] 1 2 3 4 5
>>>> Slot "names":
>>>> [1] "a" "b" "c" "d" "e"
>>>>
>>>> > names(b)
>>>> [1] "a" "b" "c" "d" "e"
>>>>
>>>> This allows both the S4 and the primitive code to deal with a
>>>> well-defined object.
>>>>
>>>> John
>>>>
>>>>
>>>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>>>> This is basically a case of a user error that is not being caught:
>>>>>
>>>>> Sure!
>>>>>
>>>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>>>> ......
>>>>
>>>>>
>>>>> Ah, that's interesting. I didn't know I could put a names slot in my
>>>>> class. Last time I tried was at least 3 years ago and that was causing
>>>>> problems (don't remember the exact details) so I ended up using NAMES
>>>>> instead. Trying again with R-2.14:
>>>>>
>>>>> > setClass("A", representation(names="character"))
>>>>>
>>>>> > a <- new("A")
>>>>>
>>>>> > attributes(a)
>>>>> $names
>>>>> character(0)
>>>>>
>>>>> $class
>>>>> [1] "A"
>>>>> attr(,"package")
>>>>> [1] ".GlobalEnv"
>>>>>
>>>>> > names(a)
>>>>> NULL
>>>>>
>>>>> > names(a) <- "K"
>>>>>
>>>>> > attributes(a)
>>>>> $names
>>>>> [1] "K"
>>>>>
>>>>> $class
>>>>> [1] "A"
>>>>> attr(,"package")
>>>>> [1] ".GlobalEnv"
>>>>>
>>>>> > names(a)
>>>>> NULL
>>>>>
>>>>> Surprise! But that's another story...
>>>>>
>>>>>>
>>>>>> The modification that would make sense would be to give you an
>>>>>> error in
>>>>>> the above code. Not a bad idea, but it's likely to generate more
>>>>>> complaints in other contexts, particularly where people don't
>>>>>> distinguish the "list" class from lists with names (the "namedList"
>>>>>> class).
>>>>>>
>>>>>> A plausible strategy:
>>>>>> 1. If the class has a vector data slot and no names slot, assign the
>>>>>> names but with a warning.
>>>>>>
>>>>>> 2. Otherwise, throw an error.
>>>>>>
>>>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>>
>>>>> Or, at a minimum (if no consensus can be reached about the above
>>>>> strategy), not add a "names" attribute set to NULL. My original
>>>>> post was more about keeping the internal representation of objects
>>>>> "normalized", in general, so identical() is more likely to be
>>>>> meaningful.
>>>>>
>>>>> Thanks,
>>>>> H.
>>>>>
>>>>>>
>>>>>> Comments?
>>>>>>
>>>>>> John
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> Thanks,
>>>>>>> H.
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>
>>>
>
>


From hpages at fhcrc.org  Tue May 17 18:53:30 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Tue, 17 May 2011 09:53:30 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD29C9E.1050305@r-project.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
	<4DD15A2D.9020504@fhcrc.org> <4DD18EB4.2060509@r-project.org>
	<4DD1AF9E.7030104@fhcrc.org> <4DD29C9E.1050305@r-project.org>
Message-ID: <4DD2A80A.8000805@fhcrc.org>

On 11-05-17 09:04 AM, John Chambers wrote:
> One point that may have been unclear, though it's surprising if so. The
> discussion was about assigning names to S4 objects from classes that do
> NOT have a formal "names" slot. Of course, having a "names" slot is not
> illegal, it's what one should do to deal with names in S4.

IMO it looks more like what one should avoid to do right now because
it's broken (as reported previously):

   > setClass("A", representation(names="character"))
   > a <- new("A")
   > names(a) <- "K"
   > names(a)
   NULL

And on that particular issue here is what you said:

   You set up a names slot in a non-vector.  Maybe that should be
   allowed, maybe not.

And now:

   Of course, having a "names" slot is not illegal, it's what one
   should do to deal with names in S4.

??!

H.


> Look at class
> "namedList" for example.
>
> Assigning names() to such a class would go through without warning as it
> does now.
>
>  > getClass("namedList")
> Class "namedList" [package "methods"]
>
> Slots:
>
> Name: .Data names
> Class: list character
>
> Extends:
> Class "list", from data part
> Class "vector", by class "list", distance 2
>
> Known Subclasses: "listOfMethods"
>  > xx <- new("namedList", list(a=1,b=2))
>  > names(xx)
> [1] "a" "b"
>  > names(xx) <- c("D", "E")
>  > xx at names
> [1] "D" "E"
>  >
>
> There was no question of breaking inheritance.
>
> On 5/16/11 4:13 PM, Herv? Pag?s wrote:
>> On 11-05-16 01:53 PM, John Chambers wrote:
>>>
>>>
>>> On 5/16/11 10:09 AM, Herv? Pag?s wrote:
>>>> On 11-05-16 09:36 AM, John Chambers wrote:
>>>>> You set up a names slot in a non-vector. Maybe that should be allowed,
>>>>> maybe not. But in any case I would not expect the names() primitive to
>>>>> find it, because your object has a non-vector type ("S4").
>>>>
>>>> But the names<-() primitive *does* find it. So either names() and
>>>> names<-() should both find it, or they shouldn't. I mean, if you care
>>>> about consistency and predictability of course.
>>>
>>> That's not the only case where borderline or mistaken behavior is caught
>>> on assignment, but not on access. The argument is that assignment can
>>> afford to check things, but access needs to be fast. Slot access is
>>> another case. There, assignment ensures legality so access can be quick.
>>>
>>> The catch is that there are sometimes backdoor ways to assignments,
>>> partly because slots, attributes and some "builtin" properties like
>>> names overlap.
>>>
>>> What we were talking about before was trying to evolve a sensible rule
>>> for assigning names to S4 objects. Let's try to discuss what people need
>>> to do before carping or indulging in sarcasm.
>>
>> What *you* were talking about but not what my original post was about.
>> Anyway, about the following proposal:
>>
>> 1. If the class has a vector data slot and no names slot, assign the
>> names but with a warning.
>>
>> 2. Otherwise, throw an error.
>>
>> (I.e., I would prefer an error throughout, but discretion ....)
>>
>> I personally don't like it because it breaks inheritance. Let's
>> say I have a class B with a vector data slot and no names slot.
>> According to 1. names<-() would work out-of-the-box on it (with
>> a warning), but now if I extend it by adding a names slot, it
>> breaks.
>>
>> One thing to consider though is that this works right now (and with
>> no warning):
>>
>> > setClass("I", contains="integer")
>> [1] "I"
>> > i <- new("I", 1:4)
>> > names(i) <- LETTERS[1:4]
>> > attributes(i)
>> $class
>> [1] "I"
>> attr(,"package")
>> [1] ".GlobalEnv"
>>
>> $names
>> [1] "A" "B" "C" "D"
>>
>> > names(i)
>> [1] "A" "B" "C" "D"
>>
>> and it's probably what most people would expect (sounds reasonable
>> after all). So this needs to keep working (with no warning). I can
>> see 2 ways to avoid breaking inheritance:
>>
>> (a) not allow a names slot to be added to class I or any
>> of its subclasses (in other words the .Data and names
>> slots cannot coexist),
>> or
>> (b) have names() and names<-() keep working when the names slot is
>> added but that is maybe dangerous as it might break C code that
>> is trying to access the names, that is, inheritance might break
>> but now at the C level
>>
>> Now for classes that don't have a .Data slot, they can of course
>> have a names slot. I don't have a strong opinion on whether names()
>> and names<-() should access it by default, but honestly that's really
>> a very small convenience offered to the developer of the class. Also,
>> for the sake of consistency, the same would need to be done for dim,
>> dimnames and built-in attributes in general. And also that won't work
>> if those built-in-attributes-made-slots are not declared with the right
>> type in the setClass statement (i.e. "character" for names, "integer"
>> for dim, etc...). And also by default names() would return character(0)
>> and not NULL. So in the end, potentially a lot of complications /
>> surprise / inconsistencies for very little value.
>>
>> Thanks,
>> H.
>>
>>>
>>> John
>>>
>>>>
>>>> H.
>>>>
>>>>
>>>>> You could do
>>>>> a at names if you thought that made sense:
>>>>>
>>>>>
>>>>> > setClass("A", representation(names="character"))
>>>>> [1] "A"
>>>>> > a <- new("A")
>>>>> > a at names <- "xx"
>>>>> > a at names
>>>>> [1] "xx"
>>>>> > names(a)
>>>>> NULL
>>>>>
>>>>>
>>>>> If you wanted something sensible, it's more like:
>>>>>
>>>>> > setClass("B", representation(names = "character"), contains =
>>>>> "integer")
>>>>> [1] "B"
>>>>> > b <- new("B", 1:5)
>>>>> > names(b) <- letters[1:5]
>>>>> > b
>>>>> An object of class "B"
>>>>> [1] 1 2 3 4 5
>>>>> Slot "names":
>>>>> [1] "a" "b" "c" "d" "e"
>>>>>
>>>>> > names(b)
>>>>> [1] "a" "b" "c" "d" "e"
>>>>>
>>>>> This allows both the S4 and the primitive code to deal with a
>>>>> well-defined object.
>>>>>
>>>>> John
>>>>>
>>>>>
>>>>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>>>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>>>>> This is basically a case of a user error that is not being caught:
>>>>>>
>>>>>> Sure!
>>>>>>
>>>>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>>>>> ......
>>>>>
>>>>>>
>>>>>> Ah, that's interesting. I didn't know I could put a names slot in my
>>>>>> class. Last time I tried was at least 3 years ago and that was
>>>>>> causing
>>>>>> problems (don't remember the exact details) so I ended up using NAMES
>>>>>> instead. Trying again with R-2.14:
>>>>>>
>>>>>> > setClass("A", representation(names="character"))
>>>>>>
>>>>>> > a <- new("A")
>>>>>>
>>>>>> > attributes(a)
>>>>>> $names
>>>>>> character(0)
>>>>>>
>>>>>> $class
>>>>>> [1] "A"
>>>>>> attr(,"package")
>>>>>> [1] ".GlobalEnv"
>>>>>>
>>>>>> > names(a)
>>>>>> NULL
>>>>>>
>>>>>> > names(a) <- "K"
>>>>>>
>>>>>> > attributes(a)
>>>>>> $names
>>>>>> [1] "K"
>>>>>>
>>>>>> $class
>>>>>> [1] "A"
>>>>>> attr(,"package")
>>>>>> [1] ".GlobalEnv"
>>>>>>
>>>>>> > names(a)
>>>>>> NULL
>>>>>>
>>>>>> Surprise! But that's another story...
>>>>>>
>>>>>>>
>>>>>>> The modification that would make sense would be to give you an
>>>>>>> error in
>>>>>>> the above code. Not a bad idea, but it's likely to generate more
>>>>>>> complaints in other contexts, particularly where people don't
>>>>>>> distinguish the "list" class from lists with names (the "namedList"
>>>>>>> class).
>>>>>>>
>>>>>>> A plausible strategy:
>>>>>>> 1. If the class has a vector data slot and no names slot, assign the
>>>>>>> names but with a warning.
>>>>>>>
>>>>>>> 2. Otherwise, throw an error.
>>>>>>>
>>>>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>>>
>>>>>> Or, at a minimum (if no consensus can be reached about the above
>>>>>> strategy), not add a "names" attribute set to NULL. My original
>>>>>> post was more about keeping the internal representation of objects
>>>>>> "normalized", in general, so identical() is more likely to be
>>>>>> meaningful.
>>>>>>
>>>>>> Thanks,
>>>>>> H.
>>>>>>
>>>>>>>
>>>>>>> Comments?
>>>>>>>
>>>>>>> John
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> Thanks,
>>>>>>>> H.
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>
>>>>
>>
>>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mtmorgan at fhcrc.org  Tue May 17 20:41:42 2011
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 17 May 2011 11:41:42 -0700
Subject: [Rd] Windows Rzlib.dll gzopen and friends
In-Reply-To: <4DC428C8.1000300@fhcrc.org>
References: <4DBB381E.7020601@fhcrc.org> <4DC428C8.1000300@fhcrc.org>
Message-ID: <4DD2C166.5020004@fhcrc.org>

R developers,

If the absence of a more complete zlib is a permanent change, then is 
the best strategy to build and distribute a package that wraps a 
functional zlib? This seems like it will create problems with symbol 
resolution at the least. Including a zlib in each package that uses it 
also seems like a poor choice. What other strategies are recommended?

Martin

On 05/06/2011 09:58 AM, Martin Morgan wrote:
> This change has significant consequences for Windows packages using R's
> zlib, including packages providing core Bioconductor functionality. Are
> the changes in r55624 meant to be long-term?
>
> Martin
>
> On 04/29/2011 03:13 PM, Martin Morgan wrote:
>> Several Bioconductor packages were expecting Windows Rzlib.dll to
>> provide gzopen / gzread / gzseek / gzgets / gzrewind / gzclose. Are
>> these gone for good, viz., r55624 ?
>>
>> Martin
>
>


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From tal.galili at gmail.com  Tue May 17 21:36:59 2011
From: tal.galili at gmail.com (Tal Galili)
Date: Tue, 17 May 2011 22:36:59 +0300
Subject: [Rd] lines.loess method - in order to make the plotting of loess
 consistent with that of lowess
Message-ID: <BANLkTi=zMWMQt5Su5bVfL0bkjYDRnGCUqA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110517/9f954a48/attachment.pl>

From jmc at r-project.org  Tue May 17 22:15:10 2011
From: jmc at r-project.org (John Chambers)
Date: Tue, 17 May 2011 13:15:10 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD2A80A.8000805@fhcrc.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
	<4DD15A2D.9020504@fhcrc.org> <4DD18EB4.2060509@r-project.org>
	<4DD1AF9E.7030104@fhcrc.org> <4DD29C9E.1050305@r-project.org>
	<4DD2A80A.8000805@fhcrc.org>
Message-ID: <4DD2D74E.4080105@r-project.org>



On 5/17/11 9:53 AM, Herv? Pag?s wrote:
> On 11-05-17 09:04 AM, John Chambers wrote:
>> One point that may have been unclear, though it's surprising if so. The
>> discussion was about assigning names to S4 objects from classes that do
>> NOT have a formal "names" slot. Of course, having a "names" slot is not
>> illegal, it's what one should do to deal with names in S4.
>
> IMO it looks more like what one should avoid to do right now because
> it's broken (as reported previously):
>
>  > setClass("A", representation(names="character"))
>  > a <- new("A")
>  > names(a) <- "K"
>  > names(a)
> NULL
>
> And on that particular issue here is what you said:
>
> You set up a names slot in a non-vector. Maybe that should be
> allowed, maybe not.
>
> And now:
>
> Of course, having a "names" slot is not illegal, it's what one
> should do to deal with names in S4.
>
> ??!]

Good grief.  The classes like namedList _are_ vectors, that's the point.

Anyway, this is a waste of time.  I will add some code to r-devel that 
checks S4 objects when assigning names.  People can try it out on their 
examples.

>
> H.
>
>
>> Look at class
>> "namedList" for example.
>>
>> Assigning names() to such a class would go through without warning as it
>> does now.
>>
>> > getClass("namedList")
>> Class "namedList" [package "methods"]
>>
>> Slots:
>>
>> Name: .Data names
>> Class: list character
>>
>> Extends:
>> Class "list", from data part
>> Class "vector", by class "list", distance 2
>>
>> Known Subclasses: "listOfMethods"
>> > xx <- new("namedList", list(a=1,b=2))
>> > names(xx)
>> [1] "a" "b"
>> > names(xx) <- c("D", "E")
>> > xx at names
>> [1] "D" "E"
>> >
>>
>> There was no question of breaking inheritance.
>>
>> On 5/16/11 4:13 PM, Herv? Pag?s wrote:
>>> On 11-05-16 01:53 PM, John Chambers wrote:
>>>>
>>>>
>>>> On 5/16/11 10:09 AM, Herv? Pag?s wrote:
>>>>> On 11-05-16 09:36 AM, John Chambers wrote:
>>>>>> You set up a names slot in a non-vector. Maybe that should be
>>>>>> allowed,
>>>>>> maybe not. But in any case I would not expect the names()
>>>>>> primitive to
>>>>>> find it, because your object has a non-vector type ("S4").
>>>>>
>>>>> But the names<-() primitive *does* find it. So either names() and
>>>>> names<-() should both find it, or they shouldn't. I mean, if you care
>>>>> about consistency and predictability of course.
>>>>
>>>> That's not the only case where borderline or mistaken behavior is
>>>> caught
>>>> on assignment, but not on access. The argument is that assignment can
>>>> afford to check things, but access needs to be fast. Slot access is
>>>> another case. There, assignment ensures legality so access can be
>>>> quick.
>>>>
>>>> The catch is that there are sometimes backdoor ways to assignments,
>>>> partly because slots, attributes and some "builtin" properties like
>>>> names overlap.
>>>>
>>>> What we were talking about before was trying to evolve a sensible rule
>>>> for assigning names to S4 objects. Let's try to discuss what people
>>>> need
>>>> to do before carping or indulging in sarcasm.
>>>
>>> What *you* were talking about but not what my original post was about.
>>> Anyway, about the following proposal:
>>>
>>> 1. If the class has a vector data slot and no names slot, assign the
>>> names but with a warning.
>>>
>>> 2. Otherwise, throw an error.
>>>
>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>
>>> I personally don't like it because it breaks inheritance. Let's
>>> say I have a class B with a vector data slot and no names slot.
>>> According to 1. names<-() would work out-of-the-box on it (with
>>> a warning), but now if I extend it by adding a names slot, it
>>> breaks.
>>>
>>> One thing to consider though is that this works right now (and with
>>> no warning):
>>>
>>> > setClass("I", contains="integer")
>>> [1] "I"
>>> > i <- new("I", 1:4)
>>> > names(i) <- LETTERS[1:4]
>>> > attributes(i)
>>> $class
>>> [1] "I"
>>> attr(,"package")
>>> [1] ".GlobalEnv"
>>>
>>> $names
>>> [1] "A" "B" "C" "D"
>>>
>>> > names(i)
>>> [1] "A" "B" "C" "D"
>>>
>>> and it's probably what most people would expect (sounds reasonable
>>> after all). So this needs to keep working (with no warning). I can
>>> see 2 ways to avoid breaking inheritance:
>>>
>>> (a) not allow a names slot to be added to class I or any
>>> of its subclasses (in other words the .Data and names
>>> slots cannot coexist),
>>> or
>>> (b) have names() and names<-() keep working when the names slot is
>>> added but that is maybe dangerous as it might break C code that
>>> is trying to access the names, that is, inheritance might break
>>> but now at the C level
>>>
>>> Now for classes that don't have a .Data slot, they can of course
>>> have a names slot. I don't have a strong opinion on whether names()
>>> and names<-() should access it by default, but honestly that's really
>>> a very small convenience offered to the developer of the class. Also,
>>> for the sake of consistency, the same would need to be done for dim,
>>> dimnames and built-in attributes in general. And also that won't work
>>> if those built-in-attributes-made-slots are not declared with the right
>>> type in the setClass statement (i.e. "character" for names, "integer"
>>> for dim, etc...). And also by default names() would return character(0)
>>> and not NULL. So in the end, potentially a lot of complications /
>>> surprise / inconsistencies for very little value.
>>>
>>> Thanks,
>>> H.
>>>
>>>>
>>>> John
>>>>
>>>>>
>>>>> H.
>>>>>
>>>>>
>>>>>> You could do
>>>>>> a at names if you thought that made sense:
>>>>>>
>>>>>>
>>>>>> > setClass("A", representation(names="character"))
>>>>>> [1] "A"
>>>>>> > a <- new("A")
>>>>>> > a at names <- "xx"
>>>>>> > a at names
>>>>>> [1] "xx"
>>>>>> > names(a)
>>>>>> NULL
>>>>>>
>>>>>>
>>>>>> If you wanted something sensible, it's more like:
>>>>>>
>>>>>> > setClass("B", representation(names = "character"), contains =
>>>>>> "integer")
>>>>>> [1] "B"
>>>>>> > b <- new("B", 1:5)
>>>>>> > names(b) <- letters[1:5]
>>>>>> > b
>>>>>> An object of class "B"
>>>>>> [1] 1 2 3 4 5
>>>>>> Slot "names":
>>>>>> [1] "a" "b" "c" "d" "e"
>>>>>>
>>>>>> > names(b)
>>>>>> [1] "a" "b" "c" "d" "e"
>>>>>>
>>>>>> This allows both the S4 and the primitive code to deal with a
>>>>>> well-defined object.
>>>>>>
>>>>>> John
>>>>>>
>>>>>>
>>>>>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>>>>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>>>>>> This is basically a case of a user error that is not being caught:
>>>>>>>
>>>>>>> Sure!
>>>>>>>
>>>>>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>>>>>> ......
>>>>>>
>>>>>>>
>>>>>>> Ah, that's interesting. I didn't know I could put a names slot in my
>>>>>>> class. Last time I tried was at least 3 years ago and that was
>>>>>>> causing
>>>>>>> problems (don't remember the exact details) so I ended up using
>>>>>>> NAMES
>>>>>>> instead. Trying again with R-2.14:
>>>>>>>
>>>>>>> > setClass("A", representation(names="character"))
>>>>>>>
>>>>>>> > a <- new("A")
>>>>>>>
>>>>>>> > attributes(a)
>>>>>>> $names
>>>>>>> character(0)
>>>>>>>
>>>>>>> $class
>>>>>>> [1] "A"
>>>>>>> attr(,"package")
>>>>>>> [1] ".GlobalEnv"
>>>>>>>
>>>>>>> > names(a)
>>>>>>> NULL
>>>>>>>
>>>>>>> > names(a) <- "K"
>>>>>>>
>>>>>>> > attributes(a)
>>>>>>> $names
>>>>>>> [1] "K"
>>>>>>>
>>>>>>> $class
>>>>>>> [1] "A"
>>>>>>> attr(,"package")
>>>>>>> [1] ".GlobalEnv"
>>>>>>>
>>>>>>> > names(a)
>>>>>>> NULL
>>>>>>>
>>>>>>> Surprise! But that's another story...
>>>>>>>
>>>>>>>>
>>>>>>>> The modification that would make sense would be to give you an
>>>>>>>> error in
>>>>>>>> the above code. Not a bad idea, but it's likely to generate more
>>>>>>>> complaints in other contexts, particularly where people don't
>>>>>>>> distinguish the "list" class from lists with names (the "namedList"
>>>>>>>> class).
>>>>>>>>
>>>>>>>> A plausible strategy:
>>>>>>>> 1. If the class has a vector data slot and no names slot, assign
>>>>>>>> the
>>>>>>>> names but with a warning.
>>>>>>>>
>>>>>>>> 2. Otherwise, throw an error.
>>>>>>>>
>>>>>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>>>>
>>>>>>> Or, at a minimum (if no consensus can be reached about the above
>>>>>>> strategy), not add a "names" attribute set to NULL. My original
>>>>>>> post was more about keeping the internal representation of objects
>>>>>>> "normalized", in general, so identical() is more likely to be
>>>>>>> meaningful.
>>>>>>>
>>>>>>> Thanks,
>>>>>>> H.
>>>>>>>
>>>>>>>>
>>>>>>>> Comments?
>>>>>>>>
>>>>>>>> John
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Thanks,
>>>>>>>>> H.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>>
>>>>>
>>>>>
>>>
>>>
>
>


From hpages at fhcrc.org  Tue May 17 23:39:23 2011
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Tue, 17 May 2011 14:39:23 -0700
Subject: [Rd] By default, `names<-` alters S4 objects
In-Reply-To: <4DD2D74E.4080105@r-project.org>
References: <4DCF0676.5070407@fhcrc.org> <4DD01C87.8040202@r-project.org>
	<4DD04D72.9070807@fhcrc.org> <4DD15299.7090000@r-project.org>
	<4DD15A2D.9020504@fhcrc.org> <4DD18EB4.2060509@r-project.org>
	<4DD1AF9E.7030104@fhcrc.org> <4DD29C9E.1050305@r-project.org>
	<4DD2A80A.8000805@fhcrc.org> <4DD2D74E.4080105@r-project.org>
Message-ID: <4DD2EB0B.10801@fhcrc.org>

On 11-05-17 01:15 PM, John Chambers wrote:
>
>
> On 5/17/11 9:53 AM, Herv? Pag?s wrote:
>> On 11-05-17 09:04 AM, John Chambers wrote:
>>> One point that may have been unclear, though it's surprising if so. The
>>> discussion was about assigning names to S4 objects from classes that do
>>> NOT have a formal "names" slot. Of course, having a "names" slot is not
>>> illegal, it's what one should do to deal with names in S4.
>>
>> IMO it looks more like what one should avoid to do right now because
>> it's broken (as reported previously):
>>
>> > setClass("A", representation(names="character"))
>> > a <- new("A")
>> > names(a) <- "K"
>> > names(a)
>> NULL
>>
>> And on that particular issue here is what you said:
>>
>> You set up a names slot in a non-vector. Maybe that should be
>> allowed, maybe not.
>>
>> And now:
>>
>> Of course, having a "names" slot is not illegal, it's what one
>> should do to deal with names in S4.
>>
>> ??!]
>
> Good grief. The classes like namedList _are_ vectors, that's the point.
>
> Anyway, this is a waste of time. I will add some code to r-devel that
> checks S4 objects when assigning names. People can try it out on their
> examples.

Thanks!

H.

>
>>
>> H.
>>
>>
>>> Look at class
>>> "namedList" for example.
>>>
>>> Assigning names() to such a class would go through without warning as it
>>> does now.
>>>
>>> > getClass("namedList")
>>> Class "namedList" [package "methods"]
>>>
>>> Slots:
>>>
>>> Name: .Data names
>>> Class: list character
>>>
>>> Extends:
>>> Class "list", from data part
>>> Class "vector", by class "list", distance 2
>>>
>>> Known Subclasses: "listOfMethods"
>>> > xx <- new("namedList", list(a=1,b=2))
>>> > names(xx)
>>> [1] "a" "b"
>>> > names(xx) <- c("D", "E")
>>> > xx at names
>>> [1] "D" "E"
>>> >
>>>
>>> There was no question of breaking inheritance.
>>>
>>> On 5/16/11 4:13 PM, Herv? Pag?s wrote:
>>>> On 11-05-16 01:53 PM, John Chambers wrote:
>>>>>
>>>>>
>>>>> On 5/16/11 10:09 AM, Herv? Pag?s wrote:
>>>>>> On 11-05-16 09:36 AM, John Chambers wrote:
>>>>>>> You set up a names slot in a non-vector. Maybe that should be
>>>>>>> allowed,
>>>>>>> maybe not. But in any case I would not expect the names()
>>>>>>> primitive to
>>>>>>> find it, because your object has a non-vector type ("S4").
>>>>>>
>>>>>> But the names<-() primitive *does* find it. So either names() and
>>>>>> names<-() should both find it, or they shouldn't. I mean, if you care
>>>>>> about consistency and predictability of course.
>>>>>
>>>>> That's not the only case where borderline or mistaken behavior is
>>>>> caught
>>>>> on assignment, but not on access. The argument is that assignment can
>>>>> afford to check things, but access needs to be fast. Slot access is
>>>>> another case. There, assignment ensures legality so access can be
>>>>> quick.
>>>>>
>>>>> The catch is that there are sometimes backdoor ways to assignments,
>>>>> partly because slots, attributes and some "builtin" properties like
>>>>> names overlap.
>>>>>
>>>>> What we were talking about before was trying to evolve a sensible rule
>>>>> for assigning names to S4 objects. Let's try to discuss what people
>>>>> need
>>>>> to do before carping or indulging in sarcasm.
>>>>
>>>> What *you* were talking about but not what my original post was about.
>>>> Anyway, about the following proposal:
>>>>
>>>> 1. If the class has a vector data slot and no names slot, assign the
>>>> names but with a warning.
>>>>
>>>> 2. Otherwise, throw an error.
>>>>
>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>
>>>> I personally don't like it because it breaks inheritance. Let's
>>>> say I have a class B with a vector data slot and no names slot.
>>>> According to 1. names<-() would work out-of-the-box on it (with
>>>> a warning), but now if I extend it by adding a names slot, it
>>>> breaks.
>>>>
>>>> One thing to consider though is that this works right now (and with
>>>> no warning):
>>>>
>>>> > setClass("I", contains="integer")
>>>> [1] "I"
>>>> > i <- new("I", 1:4)
>>>> > names(i) <- LETTERS[1:4]
>>>> > attributes(i)
>>>> $class
>>>> [1] "I"
>>>> attr(,"package")
>>>> [1] ".GlobalEnv"
>>>>
>>>> $names
>>>> [1] "A" "B" "C" "D"
>>>>
>>>> > names(i)
>>>> [1] "A" "B" "C" "D"
>>>>
>>>> and it's probably what most people would expect (sounds reasonable
>>>> after all). So this needs to keep working (with no warning). I can
>>>> see 2 ways to avoid breaking inheritance:
>>>>
>>>> (a) not allow a names slot to be added to class I or any
>>>> of its subclasses (in other words the .Data and names
>>>> slots cannot coexist),
>>>> or
>>>> (b) have names() and names<-() keep working when the names slot is
>>>> added but that is maybe dangerous as it might break C code that
>>>> is trying to access the names, that is, inheritance might break
>>>> but now at the C level
>>>>
>>>> Now for classes that don't have a .Data slot, they can of course
>>>> have a names slot. I don't have a strong opinion on whether names()
>>>> and names<-() should access it by default, but honestly that's really
>>>> a very small convenience offered to the developer of the class. Also,
>>>> for the sake of consistency, the same would need to be done for dim,
>>>> dimnames and built-in attributes in general. And also that won't work
>>>> if those built-in-attributes-made-slots are not declared with the right
>>>> type in the setClass statement (i.e. "character" for names, "integer"
>>>> for dim, etc...). And also by default names() would return character(0)
>>>> and not NULL. So in the end, potentially a lot of complications /
>>>> surprise / inconsistencies for very little value.
>>>>
>>>> Thanks,
>>>> H.
>>>>
>>>>>
>>>>> John
>>>>>
>>>>>>
>>>>>> H.
>>>>>>
>>>>>>
>>>>>>> You could do
>>>>>>> a at names if you thought that made sense:
>>>>>>>
>>>>>>>
>>>>>>> > setClass("A", representation(names="character"))
>>>>>>> [1] "A"
>>>>>>> > a <- new("A")
>>>>>>> > a at names <- "xx"
>>>>>>> > a at names
>>>>>>> [1] "xx"
>>>>>>> > names(a)
>>>>>>> NULL
>>>>>>>
>>>>>>>
>>>>>>> If you wanted something sensible, it's more like:
>>>>>>>
>>>>>>> > setClass("B", representation(names = "character"), contains =
>>>>>>> "integer")
>>>>>>> [1] "B"
>>>>>>> > b <- new("B", 1:5)
>>>>>>> > names(b) <- letters[1:5]
>>>>>>> > b
>>>>>>> An object of class "B"
>>>>>>> [1] 1 2 3 4 5
>>>>>>> Slot "names":
>>>>>>> [1] "a" "b" "c" "d" "e"
>>>>>>>
>>>>>>> > names(b)
>>>>>>> [1] "a" "b" "c" "d" "e"
>>>>>>>
>>>>>>> This allows both the S4 and the primitive code to deal with a
>>>>>>> well-defined object.
>>>>>>>
>>>>>>> John
>>>>>>>
>>>>>>>
>>>>>>> On 5/15/11 3:02 PM, Herv? Pag?s wrote:
>>>>>>>> On 11-05-15 11:33 AM, John Chambers wrote:
>>>>>>>>> This is basically a case of a user error that is not being caught:
>>>>>>>>
>>>>>>>> Sure!
>>>>>>>>
>>>>>>>> https://stat.ethz.ch/pipermail/r-devel/2009-March/052386.html
>>>>>>> ......
>>>>>>>
>>>>>>>>
>>>>>>>> Ah, that's interesting. I didn't know I could put a names slot
>>>>>>>> in my
>>>>>>>> class. Last time I tried was at least 3 years ago and that was
>>>>>>>> causing
>>>>>>>> problems (don't remember the exact details) so I ended up using
>>>>>>>> NAMES
>>>>>>>> instead. Trying again with R-2.14:
>>>>>>>>
>>>>>>>> > setClass("A", representation(names="character"))
>>>>>>>>
>>>>>>>> > a <- new("A")
>>>>>>>>
>>>>>>>> > attributes(a)
>>>>>>>> $names
>>>>>>>> character(0)
>>>>>>>>
>>>>>>>> $class
>>>>>>>> [1] "A"
>>>>>>>> attr(,"package")
>>>>>>>> [1] ".GlobalEnv"
>>>>>>>>
>>>>>>>> > names(a)
>>>>>>>> NULL
>>>>>>>>
>>>>>>>> > names(a) <- "K"
>>>>>>>>
>>>>>>>> > attributes(a)
>>>>>>>> $names
>>>>>>>> [1] "K"
>>>>>>>>
>>>>>>>> $class
>>>>>>>> [1] "A"
>>>>>>>> attr(,"package")
>>>>>>>> [1] ".GlobalEnv"
>>>>>>>>
>>>>>>>> > names(a)
>>>>>>>> NULL
>>>>>>>>
>>>>>>>> Surprise! But that's another story...
>>>>>>>>
>>>>>>>>>
>>>>>>>>> The modification that would make sense would be to give you an
>>>>>>>>> error in
>>>>>>>>> the above code. Not a bad idea, but it's likely to generate more
>>>>>>>>> complaints in other contexts, particularly where people don't
>>>>>>>>> distinguish the "list" class from lists with names (the
>>>>>>>>> "namedList"
>>>>>>>>> class).
>>>>>>>>>
>>>>>>>>> A plausible strategy:
>>>>>>>>> 1. If the class has a vector data slot and no names slot, assign
>>>>>>>>> the
>>>>>>>>> names but with a warning.
>>>>>>>>>
>>>>>>>>> 2. Otherwise, throw an error.
>>>>>>>>>
>>>>>>>>> (I.e., I would prefer an error throughout, but discretion ....)
>>>>>>>>
>>>>>>>> Or, at a minimum (if no consensus can be reached about the above
>>>>>>>> strategy), not add a "names" attribute set to NULL. My original
>>>>>>>> post was more about keeping the internal representation of objects
>>>>>>>> "normalized", in general, so identical() is more likely to be
>>>>>>>> meaningful.
>>>>>>>>
>>>>>>>> Thanks,
>>>>>>>> H.
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Comments?
>>>>>>>>>
>>>>>>>>> John
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Thanks,
>>>>>>>>>> H.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>
>>>>>>>>
>>>>>>
>>>>>>
>>>>
>>>>
>>
>>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From Bill.Venables at csiro.au  Wed May 18 01:32:06 2011
From: Bill.Venables at csiro.au (Bill.Venables at csiro.au)
Date: Wed, 18 May 2011 09:32:06 +1000
Subject: [Rd] S3 method dispatch - can methods come from the enclosing
 environment?
In-Reply-To: <4DD253D9.5070108@gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
	<4DCDA3ED.4050607@gmail.com>
	<BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>
	<4DD253D9.5070108@gmail.com>
Message-ID: <1BDAE2969943D540934EE8B4EF68F95FE49C204ED8@EXNSW-MBX03.nexus.csiro.au>

I was surprised to see that S3 methods are not found if they only reside in the enclosing environment.  E.g.:

> tstFn <- local({
+   print.tst <- function(x, ...) cat("found it!")
+ 
+   function(x) print(x)
+ })
> 
> z <- "The cat sat on the mat."
> class(x) <- "tst"
> 
> tstFn(z)
[1] "The cat sat on the mat."
> 

So the answer to the question posed in the subject line is apparently "no". Perhaps this is well known and fully documented somewhere, but if so it has eluded me.  Is there some reason for this?  

I'm not sure if this is a bug, a feature, or a proposal for development, but I would welcome people's views on this curious little issue.

Bill Venables.

From simon.urbanek at r-project.org  Wed May 18 02:36:09 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 17 May 2011 20:36:09 -0400
Subject: [Rd] S3 method dispatch - can methods come from the enclosing
	environment?
In-Reply-To: <1BDAE2969943D540934EE8B4EF68F95FE49C204ED8@EXNSW-MBX03.nexus.csiro.au>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
	<4DCDA3ED.4050607@gmail.com>
	<BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>
	<4DD253D9.5070108@gmail.com>
	<1BDAE2969943D540934EE8B4EF68F95FE49C204ED8@EXNSW-MBX03.nexus.csiro.au>
Message-ID: <AA244BFB-BC4E-486D-B15E-DB30807D5668@r-project.org>

Bill,

I suspect you have a typo there [class(x) instead of class(z)] which is why it doesn't work. Without the typo it does:

> tstFn <- local({
+   print.tst <- function(x, ...) cat("found it!")
+ 
+   function(x) print(x)
+ })
> 
> z <- "The cat sat on the mat."
> class(z) <- "tst"
> 
> tstFn(z)
found it!

Cheers,
Simon


On May 17, 2011, at 7:32 PM, <Bill.Venables at csiro.au> <Bill.Venables at csiro.au> wrote:

> I was surprised to see that S3 methods are not found if they only reside in the enclosing environment.  E.g.:
> 
>> tstFn <- local({
> +   print.tst <- function(x, ...) cat("found it!")
> + 
> +   function(x) print(x)
> + })
>> 
>> z <- "The cat sat on the mat."
>> class(x) <- "tst"
>> 
>> tstFn(z)
> [1] "The cat sat on the mat."
>> 
> 
> So the answer to the question posed in the subject line is apparently "no". Perhaps this is well known and fully documented somewhere, but if so it has eluded me.  Is there some reason for this?  
> 
> I'm not sure if this is a bug, a feature, or a proposal for development, but I would welcome people's views on this curious little issue.
> 
> Bill Venables.
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From Bill.Venables at csiro.au  Wed May 18 03:42:01 2011
From: Bill.Venables at csiro.au (Bill.Venables at csiro.au)
Date: Wed, 18 May 2011 11:42:01 +1000
Subject: [Rd] S3 method dispatch - can methods come from the enclosing
 environment?
In-Reply-To: <AA244BFB-BC4E-486D-B15E-DB30807D5668@r-project.org>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<BANLkTim0BpLDYtU=FebEriF7Q_AMmToGbA@mail.gmail.com>
	<4DCDA3ED.4050607@gmail.com>
	<BANLkTi=4ewhn1fm5EKS5hZ=pFtfgFT0PGw@mail.gmail.com>
	<4DD253D9.5070108@gmail.com>
	<1BDAE2969943D540934EE8B4EF68F95FE49C204ED8@EXNSW-MBX03.nexus.csiro.au>
	<AA244BFB-BC4E-486D-B15E-DB30807D5668@r-project.org>
Message-ID: <1BDAE2969943D540934EE8B4EF68F95FE49C204EDA@EXNSW-MBX03.nexus.csiro.au>

My apologies...  how embarrassing.

Please resume your normal duties.  :-)

Bill. 

-----Original Message-----
From: Simon Urbanek [mailto:simon.urbanek at r-project.org] 
Sent: Wednesday, 18 May 2011 10:36 AM
To: Venables, Bill (CMIS, Dutton Park)
Cc: r-devel at r-project.org
Subject: Re: [Rd] S3 method dispatch - can methods come from the enclosing environment?

Bill,

I suspect you have a typo there [class(x) instead of class(z)] which is why it doesn't work. Without the typo it does:

> tstFn <- local({
+   print.tst <- function(x, ...) cat("found it!")
+ 
+   function(x) print(x)
+ })
> 
> z <- "The cat sat on the mat."
> class(z) <- "tst"
> 
> tstFn(z)
found it!

Cheers,
Simon


On May 17, 2011, at 7:32 PM, <Bill.Venables at csiro.au> <Bill.Venables at csiro.au> wrote:

> I was surprised to see that S3 methods are not found if they only reside in the enclosing environment.  E.g.:
> 
>> tstFn <- local({
> +   print.tst <- function(x, ...) cat("found it!")
> + 
> +   function(x) print(x)
> + })
>> 
>> z <- "The cat sat on the mat."
>> class(x) <- "tst"
>> 
>> tstFn(z)
> [1] "The cat sat on the mat."
>> 
> 
> So the answer to the question posed in the subject line is apparently "no". Perhaps this is well known and fully documented somewhere, but if so it has eluded me.  Is there some reason for this?  
> 
> I'm not sure if this is a bug, a feature, or a proposal for development, but I would welcome people's views on this curious little issue.
> 
> Bill Venables.
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From andreas.borg at unimedizin-mainz.de  Wed May 18 09:19:42 2011
From: andreas.borg at unimedizin-mainz.de (Andreas Borg)
Date: Wed, 18 May 2011 09:19:42 +0200
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
Message-ID: <4DD3730E.1040006@unimedizin-mainz.de>

Hi all,

I'd like to add another suggestion:

Henrik Bengtsson schrieb:
> 6. User starts R.  R crashes with "Fatal error: unable to restore
> saved object in .RData" because 'fortunes' is not installed for this
> new version of R.  There is also an error message before that
> reporting "Error in loadNamespace(name) : there is no package called
> 'fortunes'".
>
>   
I would find it very useful if the installer offered an option to copy 
extension packages from the old version to the new version. Apart from 
possibly preventing this type of crash, it would save the hassle of 
reinstalling or copying the extension packages one regularly uses.

Andreas

-- 
Andreas Borg
Medizinische Informatik

UNIVERSIT?TSMEDIZIN
der Johannes Gutenberg-Universit?t
Institut f?r Medizinische Biometrie, Epidemiologie und Informatik
Obere Zahlbacher Stra?e 69, 55131 Mainz
www.imbei.uni-mainz.de

Telefon +49 (0) 6131 175062
E-Mail: borg at imbei.uni-mainz.de

Diese E-Mail enth?lt vertrauliche und/oder rechtlich gesch?tzte Informationen. Wenn Sie nicht der
richtige Adressat sind oder diese E-Mail irrt?mlich erhalten haben, informieren Sie bitte sofort den
Absender und l?schen Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe
dieser Mail und der darin enthaltenen Informationen ist nicht gestattet.


From oyvfos at yahoo.no  Wed May 18 11:07:23 2011
From: oyvfos at yahoo.no (oyvfos)
Date: Wed, 18 May 2011 02:07:23 -0700 (PDT)
Subject: [Rd] Max likelihood using GPU
Message-ID: <1305709643520-3532034.post@n4.nabble.com>

Dear all,
Probably many of you experience long computation times when estimating large
number of parameters using maximum likelihood  with functions that reguire
numerical methods such as integration or root-finding. Maximum likelihood is
an example of paralellization that could sucessfully utilize GPU. The
general algorithm is described here:
http://openlab-mu-internal.web.cern.ch/openlab-mu-internal/03_Documents/4_Presentations/Slides/2010-list/CHEP-Maximum-likelihood-fits-on-GPUs.pdf.
Is it possible to implement this algorithm in R ? 
Kind regards, Oyvind Foshaug

--
View this message in context: http://r.789695.n4.nabble.com/Max-likelihood-using-GPU-tp3532034p3532034.html
Sent from the R devel mailing list archive at Nabble.com.


From murdoch.duncan at gmail.com  Wed May 18 13:58:44 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 18 May 2011 07:58:44 -0400
Subject: [Rd] Reproducible use case for R crash after updating R
In-Reply-To: <4DD3730E.1040006@unimedizin-mainz.de>
References: <BANLkTi=zA1s+DwgN+0qhf7_4CkZ-VBPY9A@mail.gmail.com>
	<4DD3730E.1040006@unimedizin-mainz.de>
Message-ID: <4DD3B474.1050208@gmail.com>

On 11-05-18 3:19 AM, Andreas Borg wrote:
> Hi all,
>
> I'd like to add another suggestion:
>
> Henrik Bengtsson schrieb:
>> 6. User starts R.  R crashes with "Fatal error: unable to restore
>> saved object in .RData" because 'fortunes' is not installed for this
>> new version of R.  There is also an error message before that
>> reporting "Error in loadNamespace(name) : there is no package called
>> 'fortunes'".
>>
>>
> I would find it very useful if the installer offered an option to copy
> extension packages from the old version to the new version. Apart from
> possibly preventing this type of crash, it would save the hassle of
> reinstalling or copying the extension packages one regularly uses.

Often the old packages won't work in the new version, and you need to 
call update.packages(checkBuilt=TRUE) to update them.  That means that 
to install R, you would need an active Internet connection (or at least 
the ability to check for one).  All of that is possible, but it's not 
trivial to get it to work smoothly, and to handle errors when things go 
wrong (e.g. packages that are no longer available).

I think it would be better to move all of those details out of the 
installer, and into a user contributed package.  Then the maintainer of 
that package will handle the headaches, not me.

Duncan Murdoch


From ral64 at cam.ac.uk  Wed May 18 14:27:15 2011
From: ral64 at cam.ac.uk (Robert Lowe)
Date: Wed, 18 May 2011 13:27:15 +0100
Subject: [Rd] Max likelihood using GPU
In-Reply-To: <1305709643520-3532034.post@n4.nabble.com>
References: <1305709643520-3532034.post@n4.nabble.com>
Message-ID: <3AE5646A-FF55-405F-A5AC-E2EECDC80C0A@cam.ac.uk>

Hi Oyvind,

I believe this is possible to implement. There is already some work ongoing in using the GPU in R and they use the CUDA toolkit as the reference you supplied do.

http://brainarray.mbni.med.umich.edu/Brainarray/rgpgpu/

Thanks,
Rob


On 18 May 2011, at 10:07, oyvfos wrote:

> Dear all,
> Probably many of you experience long computation times when estimating large
> number of parameters using maximum likelihood  with functions that reguire
> numerical methods such as integration or root-finding. Maximum likelihood is
> an example of paralellization that could sucessfully utilize GPU. The
> general algorithm is described here:
> http://openlab-mu-internal.web.cern.ch/openlab-mu-internal/03_Documents/4_Presentations/Slides/2010-list/CHEP-Maximum-likelihood-fits-on-GPUs.pdf.
> Is it possible to implement this algorithm in R ? 
> Kind regards, Oyvind Foshaug
> 
> --
> View this message in context: http://r.789695.n4.nabble.com/Max-likelihood-using-GPU-tp3532034p3532034.html
> Sent from the R devel mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From oyvfos at yahoo.no  Wed May 18 14:39:31 2011
From: oyvfos at yahoo.no (=?iso-8859-1?Q?=D8yvind_Foshaug?=)
Date: Wed, 18 May 2011 13:39:31 +0100 (BST)
Subject: [Rd] Max likelihood using GPU
In-Reply-To: <3AE5646A-FF55-405F-A5AC-E2EECDC80C0A@cam.ac.uk>
References: <1305709643520-3532034.post@n4.nabble.com>
	<3AE5646A-FF55-405F-A5AC-E2EECDC80C0A@cam.ac.uk>
Message-ID: <141843.52902.qm@web24610.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110518/78bde4f0/attachment.pl>

From ruoccoma at gmail.com  Thu May 19 12:25:15 2011
From: ruoccoma at gmail.com (ruoccoma)
Date: Thu, 19 May 2011 03:25:15 -0700 (PDT)
Subject: [Rd] IDWT - Inverse Discrete Wavelet Transform
Message-ID: <1305800715324-3535334.post@n4.nabble.com>

Hello,
I am not expert in wavelet.
i am working with a discrete dataset in 3D. I applied the D4 wavelet
transform to each dimension sequentially. I made some analysis in the
transformed space and i detected some interesting vowel. 

My question is. How is it possible to map a 3d coordinate in the transformed
space to the related coordinate in the 3d original dataset? (i think that
probably one (x,y,z point in the 3d transformed space will be related
probably with 8 vowels in the orginal one...))

Thanks in advance for the help

Massimiliano

--
View this message in context: http://r.789695.n4.nabble.com/IDWT-Inverse-Discrete-Wavelet-Transform-tp3535334p3535334.html
Sent from the R devel mailing list archive at Nabble.com.


From janko.thyson.rstuff at googlemail.com  Thu May 19 14:15:31 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 19 May 2011 14:15:31 +0200
Subject: [Rd] Feature request: extend functionality of 'unlist()' by args
 'delim=c("/", "_", etc.)' and 'keep.special=TRUE/FALSE'
Message-ID: <4DD509E3.6020305@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110519/f42a6bfb/attachment.pl>

From karl.forner at gmail.com  Thu May 19 14:45:58 2011
From: karl.forner at gmail.com (Karl Forner)
Date: Thu, 19 May 2011 14:45:58 +0200
Subject: [Rd] Error in svg() : cairo-based devices are not supported on this
	build
Message-ID: <BANLkTikOvmxNV_-oJ9kLqO5J-CN35dWN2A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110519/71cfce87/attachment.pl>

From kasperdanielhansen at gmail.com  Thu May 19 14:47:35 2011
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Thu, 19 May 2011 08:47:35 -0400
Subject: [Rd] r-2.13 fails make check
Message-ID: <BANLkTim4MzWyv8fHo0K8DL4yechHRBHY9g@mail.gmail.com>

I am only reporting this because it is the current release branch and
not devel.

R-2.13 from svn revision 55957 builds fine, but fails make check.
This happened with a fresh svn checkout 12 hours ago and it still
happens as of now.  Two days ago I could build R-2.13 and it passed
make check on the same system, so I doubt it is a system problem.  But
just in case my system details are a fresh install of OS X Snow
Leopard (new machine) with Xcode 4 and Simon's gfortran and a number
of his other libraries (readline, cairo, libpng, jpeg, pixman and some
others).

Output from make check:

running code in '../../R-2.13-src/tests/reg-examples1.R' ... OK
running code in '../../R-2.13-src/tests/reg-examples2.R' ... OK
running code in '../../R-2.13-src/tests/reg-packages.R' ...make[3]:
*** [reg-packages.Rout] Error 1
make[2]: *** [test-Reg] Error 2
make[1]: *** [test-all-basics] Error 1
make: *** [check] Error 2

locating tests/reg-packages.Rout.fail I find

> stopifnot(require("myTst",lib = "myLib"))
Loading required package: myTst
> sm <- findMethods(show, where= as.environment("package:myTst"))
> stopifnot(names(sm at names) == "foo")
> unlink("myTst_*")
>
> ## More building & installing packages
> ## NB: tests were added here for 2.11.0.
> ## NB^2: do not do this in the R sources!
> ## and this testdir is not installed.
> pkgSrcPath <- file.path(Sys.getenv("SRCDIR"), "Pkgs")
> if(file_test("-d", pkgSrcPath)) {
+     ## could use file.copy(recursive = TRUE)
+     system(paste('cp -r', shQuote(pkgSrcPath), shQuote(tempdir())))
+     pkgPath <- file.path(tempdir(), "Pkgs")
+     op <- options(warn=2)    # There should be *NO* warnings here!
+     ## pkgB tests an empty R directory
+     dir.create(file.path(pkgPath, "pkgB", "R"), recursive = TRUE,
+                showWarnings = FALSE)
+     p.lis <- c("pkgA", "pkgB", "exS4noNS", "exNSS4")
+     for(p. in p.lis) {
+         cat("building package", p., "...\n")
+         r <- build.pkg(file.path(pkgPath, p.))
+         cat("installing package", p., "using file", r, "...\n")
+         ## we could install the tar file ... (see build.pkg()'s definition)
+         install.packages(r, lib = "myLib", repos=NULL, type = "source")
+         stopifnot(require(p.,lib = "myLib", character.only=TRUE))
+         detach(pos = match(p., sub("^package:","", search())))
+     }
+     ## TODO: not just print, but check the "list":
+     print(installed.packages(lib.loc = "myLib", priority = "NA"))
+     options(op)
+     unlink("myLib", recursive = TRUE)
+     unlink(file.path(pkgPath), recursive = TRUE)
+ }
building package pkgA ...
Error in parse_description_field(desc, "BuildKeepEmpty", keep_empty1) :
  object 'keep_empty1' not found
Execution halted
Error: (converted from warning) running command
'/Users/khansen/Source/R-2.13-build/bin/R CMD build --keep-empty-dirs
/var/folders/E3/E3ZBCIQ9El4LlIR92ARpyE+++TI/-Tmp-//Rtmpw9faGg/Pkgs/pkgA'
had status 1
Execution halted

Kasper


From murdoch.duncan at gmail.com  Thu May 19 14:58:00 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 19 May 2011 08:58:00 -0400
Subject: [Rd] Feature request: extend functionality of 'unlist()' by
 args 'delim=c("/", "_", etc.)' and 'keep.special=TRUE/FALSE'
In-Reply-To: <4DD509E3.6020305@googlemail.com>
References: <4DD509E3.6020305@googlemail.com>
Message-ID: <4DD513D8.2080708@gmail.com>

On 19/05/2011 8:15 AM, Janko Thyson wrote:
> Dear list,
>
> I hope this is the right place to post a feature request. If there's
> exists a more formal channel (e.g. as for bug reports), I'd appreciate a
> pointer.

This is a good place to post.

>
> I work a lot with named nested lists with arbitrary degrees of
> "nestedness". In order to retrieve the names and/or values of "bottom
> layer/bottom tier", I love the functionality of 'unlist()', or
> 'names(unlist(x))', respectively as it avoids traversing the nested
> lists via recursive loop constructs. I'm also aware that the general
> suggestion is probably to keep nestedness as low as possible when
> working with lists, but arbitrary deeply nested lists came in quite
> handy for me as long as each element is named and as long as I can
> quickly add and retrieve element values via "name paths".
>
> Here's a little example list:
> lst<- list(a=list(a.1=list(a.1.1=NA, a.1.2=5), a.2=list()), b=NULL)
>
> It would be awesome if 'unlist(x)' could be extended with the following
> functionality:
>
> 1) An argument such as 'delim' that controls how the respective layer
> names are pasted.
> Right now, they are always separated by a dot:
>   >  names(unlist(lst))
> [1] "a.a.1.a.1.1" "a.a.1.a.1.2"
> Desired:
>   >  names(unlist(lst, delim="/"))
> [1] "a/a.1/a.1.1" "a/a.1/a.1.2"
>   >  names(unlist(lst, delim="_"))
> [1] "a_a.1_a.1.1" "a_a.1_a.1.2"
>
> 2)  An argument that allows to include either elements of zero length or
> of value NULL to be *included* in the resulting output.
> Right now, they are dropped (which makes perfect sense as NULL values
> and zero length values are dropped in vectors):
>   >  c(1,2, NULL, numeric())
> [1] 1 2
>   >  unlist(lst)
> a.a.1.a.1.1 a.a.1.a.1.2
>            NA           5
> Desired:
>   >  unlist(lst, delim="/", keep.special=TRUE)
> $a/a.1/a.1.1
> [1] NA
>
> $a/a.1/a.1.2
> [1] 5
>
> $a/a.2
> list()
>
> $b
> NULL
> Of course, this would not be a true 'unlist' anymore, but something like
> 'retrieveBottomLayer()'.
>
> Thanks a lot for providing such fast stuff as 'unlist()'! Unfortunately,
> I don't know my way around internal C routines and therefore I would
> greatly appreciate if core team developers would consider my two
> suggestions.

The suggestions seem reasonable, but are difficult to implement.  The 
problem is that unlist() is a generic function, but there's no 
unlist.default() in R:  the default and method dispatch are implemented 
at the C level.  Normally adding arguments to the default method doesn't 
cause problems elsewhere, because methods only need to be compatible 
with the generic.  But since there's no way to modify the argument list 
of the default method in this case, the generic function would need to 
be modified, and that means every unlist method would need to be 
modified too.

So I wouldn't want to take this on.

In case someone else does, I'd suggest a different change than the 
"keep.special" argument.  I think a "coerce=TRUE" argument would be 
better:  If TRUE, you get the current behaviour, which coerces 
components according to the hierarchy listed on the help page.  If 
FALSE, then no coercion is done, and unlist() just flattens the list 
into a new one, e.g.

unlist( list(1, 2, NULL, list("A", "B")), coerce=FALSE)

would return list(1, 2, NULL, "A", "B") instead of c("1", "2", "A", "B").

One workaround I thought of was to add an element to the list that 
couldn't be coerced, but this doesn't work.  For example:

e <- environment() # can't be coerced
x <- list(1, 2, NULL, list("A", "B"), e)
unlist(x)

# Returns list(1,2,"A","B",e)

I think it would be reasonable for this version to retain the NULL, 
since it is not doing any coercion.

Duncan Murdoch


From bbolker at gmail.com  Thu May 19 15:46:16 2011
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 19 May 2011 13:46:16 +0000
Subject: [Rd] IDWT - Inverse Discrete Wavelet Transform
References: <1305800715324-3535334.post@n4.nabble.com>
Message-ID: <loom.20110519T154233-26@post.gmane.org>

ruoccoma <ruoccoma <at> gmail.com> writes:

> 
> Hello,
> I am not expert in wavelet.
> i am working with a discrete dataset in 3D. I applied the D4 wavelet
> transform to each dimension sequentially. I made some analysis in the
> transformed space and i detected some interesting vowel. 
> 
> My question is. How is it possible to map a 3d coordinate in the transformed
> space to the related coordinate in the 3d original dataset? (i think that
> probably one (x,y,z point in the 3d transformed space will be related
> probably with 8 vowels in the orginal one...))
> 
> Thanks in advance for the help
> 
> Massimiliano
> 

  As written, this is a wavelet question, not an R one ... it's
possible that you will get help, but if you don't it's because
you're asking in the wrong place (i.e. on an R-help list). Also,
if you do choose to continue asking on R lists, you should ask
on r-help (the general help list) rather than here (r-devel, the
list for r development).

  It would increase your chances a lot if you specified what you
were doing (at a minimum, which contributed packages you are using --
as far as I know there is know wavelet capability in base R -- and
probably which particular functions from those packages).  It would
be best if you could provide a reproducible question -- although I
recognize that could be difficult in this case.

  You might also try stackoverflow.com or stackexchange.com

  good luck
     Ben Bolker


From simon.urbanek at r-project.org  Thu May 19 16:00:39 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 19 May 2011 10:00:39 -0400
Subject: [Rd] Error in svg() : cairo-based devices are not supported on
	this build
In-Reply-To: <BANLkTikOvmxNV_-oJ9kLqO5J-CN35dWN2A@mail.gmail.com>
References: <BANLkTikOvmxNV_-oJ9kLqO5J-CN35dWN2A@mail.gmail.com>
Message-ID: <7DA13B0C-B551-472A-9EB1-EE40A05E107D@r-project.org>


On May 19, 2011, at 8:45 AM, Karl Forner wrote:

> Hello,
> 
> Sorry if it is not the right place..
> 
> 
> I installed R-2.13.0 on a x86_64 linux server.
> All went fine, but the svg()  function yells:
>> svg()
> Error in svg() : cairo-based devices are not supported on this build
> 
> I have the Cairo, cairoDevice, RSvgDevice packages installed, and running.
> 

Those are irrelevant for svg() which is provided by built-in cairo support in R, not the packages, so you want to check capabilities():
> capabilities("cairo")
cairo 
 TRUE 

But if you have working Cairo package can simply use CairoSVG() instead of svg().

Cheers,
Simon



>> Cairo.capabilities()
>  png  jpeg  tiff   pdf   svg    ps   x11   win
> TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
> 
> I tried to google around unsuccessfully. The only thing I noticed in
> config.log is:
> r_cv_has_pangocairo=no
> r_cv_cairo_works=yes
> r_cv_has_cairo=yes
> #define HAVE_WORKING_CAIRO 1
> #define HAVE_CAIRO_PDF 1
> #define HAVE_CAIRO_PS 1
> #define HAVE_CAIRO_SVG 1
> 
> 
> So what can be wrong ??
> 
> Thank you
> 
> Karl
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From simon.urbanek at r-project.org  Thu May 19 16:03:13 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 19 May 2011 10:03:13 -0400
Subject: [Rd] r-2.13 fails make check
In-Reply-To: <BANLkTim4MzWyv8fHo0K8DL4yechHRBHY9g@mail.gmail.com>
References: <BANLkTim4MzWyv8fHo0K8DL4yechHRBHY9g@mail.gmail.com>
Message-ID: <E4E57C33-7E16-444C-A8D5-085F68AC2C06@r-project.org>

Yes, this must be from some commit yesterday, because the build from previous night worked. I see the same error in the nightly builds:

http://r.research.att.com/log-R-2.13-branch.leopard.i386.html


On May 19, 2011, at 8:47 AM, Kasper Daniel Hansen wrote:

> I am only reporting this because it is the current release branch and
> not devel.
> 
> R-2.13 from svn revision 55957 builds fine, but fails make check.
> This happened with a fresh svn checkout 12 hours ago and it still
> happens as of now.  Two days ago I could build R-2.13 and it passed
> make check on the same system, so I doubt it is a system problem.  But
> just in case my system details are a fresh install of OS X Snow
> Leopard (new machine) with Xcode 4 and Simon's gfortran and a number
> of his other libraries (readline, cairo, libpng, jpeg, pixman and some
> others).
> 
> Output from make check:
> 
> running code in '../../R-2.13-src/tests/reg-examples1.R' ... OK
> running code in '../../R-2.13-src/tests/reg-examples2.R' ... OK
> running code in '../../R-2.13-src/tests/reg-packages.R' ...make[3]:
> *** [reg-packages.Rout] Error 1
> make[2]: *** [test-Reg] Error 2
> make[1]: *** [test-all-basics] Error 1
> make: *** [check] Error 2
> 
> locating tests/reg-packages.Rout.fail I find
> 
>> stopifnot(require("myTst",lib = "myLib"))
> Loading required package: myTst
>> sm <- findMethods(show, where= as.environment("package:myTst"))
>> stopifnot(names(sm at names) == "foo")
>> unlink("myTst_*")
>> 
>> ## More building & installing packages
>> ## NB: tests were added here for 2.11.0.
>> ## NB^2: do not do this in the R sources!
>> ## and this testdir is not installed.
>> pkgSrcPath <- file.path(Sys.getenv("SRCDIR"), "Pkgs")
>> if(file_test("-d", pkgSrcPath)) {
> +     ## could use file.copy(recursive = TRUE)
> +     system(paste('cp -r', shQuote(pkgSrcPath), shQuote(tempdir())))
> +     pkgPath <- file.path(tempdir(), "Pkgs")
> +     op <- options(warn=2)    # There should be *NO* warnings here!
> +     ## pkgB tests an empty R directory
> +     dir.create(file.path(pkgPath, "pkgB", "R"), recursive = TRUE,
> +                showWarnings = FALSE)
> +     p.lis <- c("pkgA", "pkgB", "exS4noNS", "exNSS4")
> +     for(p. in p.lis) {
> +         cat("building package", p., "...\n")
> +         r <- build.pkg(file.path(pkgPath, p.))
> +         cat("installing package", p., "using file", r, "...\n")
> +         ## we could install the tar file ... (see build.pkg()'s definition)
> +         install.packages(r, lib = "myLib", repos=NULL, type = "source")
> +         stopifnot(require(p.,lib = "myLib", character.only=TRUE))
> +         detach(pos = match(p., sub("^package:","", search())))
> +     }
> +     ## TODO: not just print, but check the "list":
> +     print(installed.packages(lib.loc = "myLib", priority = "NA"))
> +     options(op)
> +     unlink("myLib", recursive = TRUE)
> +     unlink(file.path(pkgPath), recursive = TRUE)
> + }
> building package pkgA ...
> Error in parse_description_field(desc, "BuildKeepEmpty", keep_empty1) :
>  object 'keep_empty1' not found
> Execution halted
> Error: (converted from warning) running command
> '/Users/khansen/Source/R-2.13-build/bin/R CMD build --keep-empty-dirs
> /var/folders/E3/E3ZBCIQ9El4LlIR92ARpyE+++TI/-Tmp-//Rtmpw9faGg/Pkgs/pkgA'
> had status 1
> Execution halted
> 
> Kasper
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From simon.urbanek at r-project.org  Thu May 19 16:07:50 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 19 May 2011 10:07:50 -0400
Subject: [Rd] r-2.13 fails make check
In-Reply-To: <E4E57C33-7E16-444C-A8D5-085F68AC2C06@r-project.org>
References: <BANLkTim4MzWyv8fHo0K8DL4yechHRBHY9g@mail.gmail.com>
	<E4E57C33-7E16-444C-A8D5-085F68AC2C06@r-project.org>
Message-ID: <6AE82EC4-8AD0-4577-BCE9-87575593A25D@r-project.org>

Note to myself: read R-core before R-devel ;). It's apparently fixed by now. I have restarted the nightly build so the binaries should be up again soon.

Cheers,
Simon


On May 19, 2011, at 10:03 AM, Simon Urbanek wrote:

> Yes, this must be from some commit yesterday, because the build from previous night worked. I see the same error in the nightly builds:
> 
> http://r.research.att.com/log-R-2.13-branch.leopard.i386.html
> 
> 
> On May 19, 2011, at 8:47 AM, Kasper Daniel Hansen wrote:
> 
>> I am only reporting this because it is the current release branch and
>> not devel.
>> 
>> R-2.13 from svn revision 55957 builds fine, but fails make check.
>> This happened with a fresh svn checkout 12 hours ago and it still
>> happens as of now.  Two days ago I could build R-2.13 and it passed
>> make check on the same system, so I doubt it is a system problem.  But
>> just in case my system details are a fresh install of OS X Snow
>> Leopard (new machine) with Xcode 4 and Simon's gfortran and a number
>> of his other libraries (readline, cairo, libpng, jpeg, pixman and some
>> others).
>> 
>> Output from make check:
>> 
>> running code in '../../R-2.13-src/tests/reg-examples1.R' ... OK
>> running code in '../../R-2.13-src/tests/reg-examples2.R' ... OK
>> running code in '../../R-2.13-src/tests/reg-packages.R' ...make[3]:
>> *** [reg-packages.Rout] Error 1
>> make[2]: *** [test-Reg] Error 2
>> make[1]: *** [test-all-basics] Error 1
>> make: *** [check] Error 2
>> 
>> locating tests/reg-packages.Rout.fail I find
>> 
>>> stopifnot(require("myTst",lib = "myLib"))
>> Loading required package: myTst
>>> sm <- findMethods(show, where= as.environment("package:myTst"))
>>> stopifnot(names(sm at names) == "foo")
>>> unlink("myTst_*")
>>> 
>>> ## More building & installing packages
>>> ## NB: tests were added here for 2.11.0.
>>> ## NB^2: do not do this in the R sources!
>>> ## and this testdir is not installed.
>>> pkgSrcPath <- file.path(Sys.getenv("SRCDIR"), "Pkgs")
>>> if(file_test("-d", pkgSrcPath)) {
>> +     ## could use file.copy(recursive = TRUE)
>> +     system(paste('cp -r', shQuote(pkgSrcPath), shQuote(tempdir())))
>> +     pkgPath <- file.path(tempdir(), "Pkgs")
>> +     op <- options(warn=2)    # There should be *NO* warnings here!
>> +     ## pkgB tests an empty R directory
>> +     dir.create(file.path(pkgPath, "pkgB", "R"), recursive = TRUE,
>> +                showWarnings = FALSE)
>> +     p.lis <- c("pkgA", "pkgB", "exS4noNS", "exNSS4")
>> +     for(p. in p.lis) {
>> +         cat("building package", p., "...\n")
>> +         r <- build.pkg(file.path(pkgPath, p.))
>> +         cat("installing package", p., "using file", r, "...\n")
>> +         ## we could install the tar file ... (see build.pkg()'s definition)
>> +         install.packages(r, lib = "myLib", repos=NULL, type = "source")
>> +         stopifnot(require(p.,lib = "myLib", character.only=TRUE))
>> +         detach(pos = match(p., sub("^package:","", search())))
>> +     }
>> +     ## TODO: not just print, but check the "list":
>> +     print(installed.packages(lib.loc = "myLib", priority = "NA"))
>> +     options(op)
>> +     unlink("myLib", recursive = TRUE)
>> +     unlink(file.path(pkgPath), recursive = TRUE)
>> + }
>> building package pkgA ...
>> Error in parse_description_field(desc, "BuildKeepEmpty", keep_empty1) :
>> object 'keep_empty1' not found
>> Execution halted
>> Error: (converted from warning) running command
>> '/Users/khansen/Source/R-2.13-build/bin/R CMD build --keep-empty-dirs
>> /var/folders/E3/E3ZBCIQ9El4LlIR92ARpyE+++TI/-Tmp-//Rtmpw9faGg/Pkgs/pkgA'
>> had status 1
>> Execution halted
>> 
>> Kasper
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From janko.thyson.rstuff at googlemail.com  Thu May 19 16:11:07 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 19 May 2011 16:11:07 +0200
Subject: [Rd] Feature request: extend functionality of 'unlist()' by
 args 'delim=c("/", "_", etc.)' and 'keep.special=TRUE/FALSE'
In-Reply-To: <4DD513D8.2080708@gmail.com>
References: <4DD509E3.6020305@googlemail.com> <4DD513D8.2080708@gmail.com>
Message-ID: <4DD524FB.7060604@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110519/bf72d004/attachment.pl>

From janko.thyson.rstuff at googlemail.com  Thu May 19 16:21:28 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 19 May 2011 16:21:28 +0200
Subject: [Rd] Feature request: extend functionality of 'unlist()' by
 args 'delim=c("/", "_", etc.)' and 'keep.special=TRUE/FALSE'
In-Reply-To: <4DD513D8.2080708@gmail.com>
References: <4DD509E3.6020305@googlemail.com> <4DD513D8.2080708@gmail.com>
Message-ID: <4DD52768.2060007@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110519/4914cc8b/attachment.pl>

From Martyn.Byng at nag.co.uk  Fri May 20 18:04:18 2011
From: Martyn.Byng at nag.co.uk (Martyn Byng)
Date: Fri, 20 May 2011 17:04:18 +0100
Subject: [Rd] Calling Rscript from Makevars
Message-ID: <49E76DF37649DC48A4CE882BC8CE51C901AD8398@nagmail2.nag.co.uk>

Hi,

I am trying to package some code to use with R and wanted to call
Rscript from within the Makevars file (I am trying to automate the
setting of the location of a third party library depending on what is
available / the system the package is being installed on).

If I just have a simple Makevars containing


PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib


the package is built without any errors, if I attempt to add a call to
Rscript, for example (which I think is the way that "Writing R
Extensions" recommends):


R_SCRIPT_NAME=Rscript
ifneq ($(R_HOME),)
  R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
else
  R_SCRIPT=$(R_SCRIPT_NAME)
endif
R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')

PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib


I get the following error:

* checking for file 'NAGFWrappers/DESCRIPTION' ... OK
* preparing 'NAGFWrappers':
* checking DESCRIPTION meta-information ... OK
* cleaning src
make: Nothing to be done for `clean'.
* removing junk files
* checking for LF line-endings in source and make files
* checking for empty or unneeded directories
* building binary distribution
* installing *source* package 'NAGFWrappers' ...
** libs
/usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
file or directory
make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
Stop.
ERROR: compilation failed for package 'NAGFWrappers'
* removing '/tmp/Rinst1513764321/NAGFWrappers'
 ERROR
* installation failed


Any help / pointers would be appreciated.

Cheers

Martyn

Output from R.version:

platform       x86_64-redhat-linux-gnu      
arch           x86_64                       
os             linux-gnu                    
system         x86_64, linux-gnu            
status                                      
major          2                            
minor          11.0                         
year           2010                         
month          04                           
day            22                           
svn rev        51801                        
language       R                            
version.string R version 2.11.0 (2010-04-22)


________________________________________________________________________
The Numerical Algorithms Group Ltd is a company registered in England
and Wales with company number 1249803. The registered office is:
Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.

This e-mail has been scanned for all viruses by Star. Th...{{dropped:4}}


From sean.mcguffee at gmail.com  Fri May 20 21:15:52 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 20 May 2011 15:15:52 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <49E76DF37649DC48A4CE882BC8CE51C901AD8398@nagmail2.nag.co.uk>
Message-ID: <C9FC3628.430F%sean.mcguffee@gmail.com>

Hi,
I've found this type of thing to be extremely confusing, myself, but I
managed to get something to work. I'm not sure how well. I also don't know
if R is running autoconf or just configure--at least I don't remember off
the top of my head. However, here are some examples of commands I put in my
configure.ac file: 
CC=`"${R_HOME}/bin/R" CMD config CC`
CXX=`"${R_HOME}/bin/R" CMD config CXX`
CFLAGS=`"${R_HOME}/bin/R" CMD config CFLAGS`
CXXFLAGS=`"${R_HOME}/bin/R" CMD config CXXFLAGS`
PKG_LIBS=`${R_HOME}/bin/Rscript -e "Rcpp:::LdFlags()"`
then you can use some preset commands such as:
AC_PROG_CC
or generic commands such as:
AC_SUBST(whateverVariableYouLike)
and make sure to put in the key command at the bottom before AC_OUTPUT:
AC_CONFIG_FILES([src/Makefile])
If R runs autoconf before ./configure when packaging or installing, you will
be fine with just the configure.ac. Otherwise you might have to run autoconf
before packaging. 
Anyway, what this will do is create a configure script when autoconf is run.
When ./configure is run by R when installing, it will execute replacement
commands on src/Makefile.in to generate the new Makefile.
Anything within two @ symbols will be replaced.
examples inside my Makefile.in:
CC = @CC@
CXX = @CXX@
I still haven't figured out how to do the Makevars thing, but I've
completely given up on R documentation. The key part from the R
documentation that I found useful was that it calls configure on install, so
you can use autoconf documentation to figure out how to set things up.
I'm sure I probably left out a ton of info, but those are my two cents.
Please feel free to ask me for more details if you are interested.
Good luck,
Sean 


On 5/20/11 12:04 PM, "Martyn Byng" <Martyn.Byng at nag.co.uk> wrote:

> Hi,
> 
> I am trying to package some code to use with R and wanted to call
> Rscript from within the Makevars file (I am trying to automate the
> setting of the location of a third party library depending on what is
> available / the system the package is being installed on).
> 
> If I just have a simple Makevars containing
> 
> 
> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
> 
> 
> the package is built without any errors, if I attempt to add a call to
> Rscript, for example (which I think is the way that "Writing R
> Extensions" recommends):
> 
> 
> R_SCRIPT_NAME=Rscript
> ifneq ($(R_HOME),)
>   R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
> else
>   R_SCRIPT=$(R_SCRIPT_NAME)
> endif
> R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')
> 
> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
> 
> 
> I get the following error:
> 
> * checking for file 'NAGFWrappers/DESCRIPTION' ... OK
> * preparing 'NAGFWrappers':
> * checking DESCRIPTION meta-information ... OK
> * cleaning src
> make: Nothing to be done for `clean'.
> * removing junk files
> * checking for LF line-endings in source and make files
> * checking for empty or unneeded directories
> * building binary distribution
> * installing *source* package 'NAGFWrappers' ...
> ** libs
> /usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
> file or directory
> make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
> Stop.
> ERROR: compilation failed for package 'NAGFWrappers'
> * removing '/tmp/Rinst1513764321/NAGFWrappers'
>  ERROR
> * installation failed
> 
> 
> Any help / pointers would be appreciated.
> 
> Cheers
> 
> Martyn
> 
> Output from R.version:
> 
> platform       x86_64-redhat-linux-gnu
> arch           x86_64
> os             linux-gnu
> system         x86_64, linux-gnu
> status           
> major          2 
> minor          11.0
> year           2010
> month          04
> day            22
> svn rev        51801
> language       R 
> version.string R version 2.11.0 (2010-04-22)
> 
> 
> ________________________________________________________________________
> The Numerical Algorithms Group Ltd is a company registered in England
> and Wales with company number 1249803. The registered office is:
> Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.
> 
> This e-mail has been scanned for all viruses by Star. Th...{{dropped:4}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Fri May 20 21:16:30 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 20 May 2011 15:16:30 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <49E76DF37649DC48A4CE882BC8CE51C901AD8398@nagmail2.nag.co.uk>
References: <49E76DF37649DC48A4CE882BC8CE51C901AD8398@nagmail2.nag.co.uk>
Message-ID: <86F6F0A1-391C-4481-B0BA-5681CC4CA148@r-project.org>


On May 20, 2011, at 12:04 PM, Martyn Byng wrote:

> Hi,
> 
> I am trying to package some code to use with R and wanted to call
> Rscript from within the Makevars file (I am trying to automate the
> setting of the location of a third party library depending on what is
> available / the system the package is being installed on).
> 
> If I just have a simple Makevars containing
> 
> 
> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
> 
> 
> the package is built without any errors, if I attempt to add a call to
> Rscript, for example (which I think is the way that "Writing R
> Extensions" recommends):
> 
> 
> R_SCRIPT_NAME=Rscript
> ifneq ($(R_HOME),)
>  R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
> else
>  R_SCRIPT=$(R_SCRIPT_NAME)
> endif
> R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')
> 

That's all pretty much unnecessary since all settings carry over from the R invocation and also it is what causes your error (since your "arch" is wrong). On unix it's as simple as

PKG_LIBS=`${R_HOME}/bin/Rscript -e 'whatever.you.meant.to.run()'`

and on Windows it's

PKG_LIBS=`${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe -e 'whatever.you.meant.to.run()'`

Note that you should NOT mess with the environment variables that R uses as you're likely to set them incorrectly.

Cheers,
Simon



> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
> 
> 
> I get the following error:
> 
> * checking for file 'NAGFWrappers/DESCRIPTION' ... OK
> * preparing 'NAGFWrappers':
> * checking DESCRIPTION meta-information ... OK
> * cleaning src
> make: Nothing to be done for `clean'.
> * removing junk files
> * checking for LF line-endings in source and make files
> * checking for empty or unneeded directories
> * building binary distribution
> * installing *source* package 'NAGFWrappers' ...
> ** libs
> /usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
> file or directory
> make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
> Stop.
> ERROR: compilation failed for package 'NAGFWrappers'
> * removing '/tmp/Rinst1513764321/NAGFWrappers'
> ERROR
> * installation failed
> 
> 
> Any help / pointers would be appreciated.
> 
> Cheers
> 
> Martyn
> 
> Output from R.version:
> 
> platform       x86_64-redhat-linux-gnu      
> arch           x86_64                       
> os             linux-gnu                    
> system         x86_64, linux-gnu            
> status                                      
> major          2                            
> minor          11.0                         
> year           2010                         
> month          04                           
> day            22                           
> svn rev        51801                        
> language       R                            
> version.string R version 2.11.0 (2010-04-22)
> 
> 
> ________________________________________________________________________
> The Numerical Algorithms Group Ltd is a company registered in England
> and Wales with company number 1249803. The registered office is:
> Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.
> 
> This e-mail has been scanned for all viruses by Star. Th...{{dropped:4}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From simon.urbanek at r-project.org  Sat May 21 00:05:01 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 20 May 2011 18:05:01 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <C9FC3628.430F%sean.mcguffee@gmail.com>
References: <C9FC3628.430F%sean.mcguffee@gmail.com>
Message-ID: <AF608EF8-782D-4AE0-8211-67E60EE46EDB@r-project.org>

This is unrelated to the original question, so clarifications inline for posterity.

On May 20, 2011, at 3:15 PM, Sean Robert McGuffee wrote:

> Hi,
> I've found this type of thing to be extremely confusing, myself, but I
> managed to get something to work. I'm not sure how well. I also don't know
> if R is running autoconf or just configure--at least I don't remember off
> the top of my head.


Martyn was asking about dynamic variables in Makevars which is less intrusive than having a configure script. In general, I recommend using the configure script only as the ultima ratio if there is no easy way to achieve the same effect with Makevars, because configure prevents the package from building all architectures.


> However, here are some examples of commands I put in my
> configure.ac file: 
> CC=`"${R_HOME}/bin/R" CMD config CC`
> CXX=`"${R_HOME}/bin/R" CMD config CXX`
> CFLAGS=`"${R_HOME}/bin/R" CMD config CFLAGS`
> CXXFLAGS=`"${R_HOME}/bin/R" CMD config CXXFLAGS`
> PKG_LIBS=`${R_HOME}/bin/Rscript -e "Rcpp:::LdFlags()"`
> then you can use some preset commands such as:

Note that setting PKG_LIBS in configure won't work since configure doesn't know how to handle it. It may be ok if you don't care that the flags won't be checked, but then you better know what you're doing ;).


> AC_PROG_CC
> or generic commands such as:
> AC_SUBST(whateverVariableYouLike)
> and make sure to put in the key command at the bottom before AC_OUTPUT:
> AC_CONFIG_FILES([src/Makefile])
> If R runs autoconf before ./configure when packaging or installing, you will
> be fine with just the configure.ac. Otherwise you might have to run autoconf
> before packaging. 

You have to run autoconf yourself - R has no way of knowing how to bootstrap your setup. Some authors prefer to use the maintainer mode in configure for that, but you still have to create some configure script.


> Anyway, what this will do is create a configure script when autoconf is run.
> When ./configure is run by R when installing, it will execute replacement
> commands on src/Makefile.in to generate the new Makefile.
> Anything within two @ symbols will be replaced.
> examples inside my Makefile.in:
> CC = @CC@
> CXX = @CXX@

You can omit all that if you use Makevars. Also using Makefile is discouraged because it forces you to replicate the whole building process which is very error prone (and may be different for each version of R).


> I still haven't figured out how to do the Makevars thing,


It's very simple - just remove all targets from your Makefile and you have Makevars since R will do the compilation and linking for you and correctly. If you feel like it, you can override its behavior by adding one rule (e.g., all:) that lists your desired dependency and you can pass on to the R default by depending on $(SHLIB).

Cheers,
Simon



> but I've
> completely given up on R documentation. The key part from the R
> documentation that I found useful was that it calls configure on install, so
> you can use autoconf documentation to figure out how to set things up.
> I'm sure I probably left out a ton of info, but those are my two cents.
> Please feel free to ask me for more details if you are interested.
> Good luck,
> Sean 
> 
> 
> On 5/20/11 12:04 PM, "Martyn Byng" <Martyn.Byng at nag.co.uk> wrote:
> 
>> Hi,
>> 
>> I am trying to package some code to use with R and wanted to call
>> Rscript from within the Makevars file (I am trying to automate the
>> setting of the location of a third party library depending on what is
>> available / the system the package is being installed on).
>> 
>> If I just have a simple Makevars containing
>> 
>> 
>> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
>> 
>> 
>> the package is built without any errors, if I attempt to add a call to
>> Rscript, for example (which I think is the way that "Writing R
>> Extensions" recommends):
>> 
>> 
>> R_SCRIPT_NAME=Rscript
>> ifneq ($(R_HOME),)
>>  R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
>> else
>>  R_SCRIPT=$(R_SCRIPT_NAME)
>> endif
>> R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')
>> 
>> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
>> 
>> 
>> I get the following error:
>> 
>> * checking for file 'NAGFWrappers/DESCRIPTION' ... OK
>> * preparing 'NAGFWrappers':
>> * checking DESCRIPTION meta-information ... OK
>> * cleaning src
>> make: Nothing to be done for `clean'.
>> * removing junk files
>> * checking for LF line-endings in source and make files
>> * checking for empty or unneeded directories
>> * building binary distribution
>> * installing *source* package 'NAGFWrappers' ...
>> ** libs
>> /usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
>> file or directory
>> make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
>> Stop.
>> ERROR: compilation failed for package 'NAGFWrappers'
>> * removing '/tmp/Rinst1513764321/NAGFWrappers'
>> ERROR
>> * installation failed
>> 
>> 
>> Any help / pointers would be appreciated.
>> 
>> Cheers
>> 
>> Martyn
>> 
>> Output from R.version:
>> 
>> platform       x86_64-redhat-linux-gnu
>> arch           x86_64
>> os             linux-gnu
>> system         x86_64, linux-gnu
>> status           
>> major          2 
>> minor          11.0
>> year           2010
>> month          04
>> day            22
>> svn rev        51801
>> language       R 
>> version.string R version 2.11.0 (2010-04-22)
>> 
>> 
>> ________________________________________________________________________
>> The Numerical Algorithms Group Ltd is a company registered in England
>> and Wales with company number 1249803. The registered office is:
>> Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.
>> 
>> This e-mail has been scanned for all viruses by Star. Th...{{dropped:4}}
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From sean.mcguffee at gmail.com  Sat May 21 03:00:45 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 20 May 2011 21:00:45 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <AF608EF8-782D-4AE0-8211-67E60EE46EDB@r-project.org>
Message-ID: <C9FC86FD.4323%sean.mcguffee@gmail.com>


> Note that setting PKG_LIBS in configure won't work since configure doesn't
> know how to handle it. It may be ok if you don't care that the flags won't be
> checked, but then you better know what you're doing ;).
> 
Why wouldn't PKG_LIBS work in configure?

configure.ac:

PKG_LIBS=`${R_HOME}/bin/Rscript -e "Rcpp:::LdFlags()"`
AC_SUBST(PKG_LIBS)

src/Makefile.in:
PKG_LIBS = @PKG_LIBS@

> You have to run autoconf yourself - R has no way of knowing how to bootstrap
> your setup. Some authors prefer to use the maintainer mode in configure for
> that, but you still have to create some configure script.

Good to know--I hoped that explained what was happening sometimes when
autoconf needed to be run.
NOTE: The manual says,
"1.2 Configure and cleanup
Note that most of this section is specfic to Unix-alikes: see the comments
later on about the Windows port of R.

If your package needs some system-dependent configuration before
installation you can include an executable (Bourne shell) script configure
in your package which (if present) is executed by R CMD INSTALL before any
other action is performed.  This can be a script created by the Autoconf
mechanism, but may also be a script written by yourself.  Use this to detect
if any nonstandard libraries are present such that corresponding code in the
package can be disabled at install time rather than giving error messages
when the package is compiled or used.  To summarize, the full power of
Autoconf is available for your extension package (including variable
substitution, searching for libraries, etc.). "

It might be worth someone revizing this to take out the Autoconf term if it
really isn't even being used.

 


> 
> 
>> Anyway, what this will do is create a configure script when autoconf is run.
>> When ./configure is run by R when installing, it will execute replacement
>> commands on src/Makefile.in to generate the new Makefile.
>> Anything within two @ symbols will be replaced.
>> examples inside my Makefile.in:
>> CC = @CC@
>> CXX = @CXX@
> 
> You can omit all that if you use Makevars. Also using Makefile is discouraged
> because it forces you to replicate the whole building process which is very
> error prone (and may be different for each version of R).
> 
> 
>> I still haven't figured out how to do the Makevars thing,
> 
> 
> It's very simple - just remove all targets from your Makefile and you have
> Makevars since R will do the compilation and linking for you and correctly. If
> you feel like it, you can override its behavior by adding one rule (e.g.,
> all:) that lists your desired dependency and you can pass on to the R default
> by depending on $(SHLIB).
> 
> Cheers,
> Simon
> 
> 
> 
>> but I've
>> completely given up on R documentation. The key part from the R
>> documentation that I found useful was that it calls configure on install, so
>> you can use autoconf documentation to figure out how to set things up.
>> I'm sure I probably left out a ton of info, but those are my two cents.
>> Please feel free to ask me for more details if you are interested.
>> Good luck,
>> Sean 
>> 
>> 
>> On 5/20/11 12:04 PM, "Martyn Byng" <Martyn.Byng at nag.co.uk> wrote:
>> 
>>> Hi,
>>> 
>>> I am trying to package some code to use with R and wanted to call
>>> Rscript from within the Makevars file (I am trying to automate the
>>> setting of the location of a third party library depending on what is
>>> available / the system the package is being installed on).
>>> 
>>> If I just have a simple Makevars containing
>>> 
>>> 
>>> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
>>> 
>>> 
>>> the package is built without any errors, if I attempt to add a call to
>>> Rscript, for example (which I think is the way that "Writing R
>>> Extensions" recommends):
>>> 
>>> 
>>> R_SCRIPT_NAME=Rscript
>>> ifneq ($(R_HOME),)
>>>  R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
>>> else
>>>  R_SCRIPT=$(R_SCRIPT_NAME)
>>> endif
>>> R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')
>>> 
>>> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
>>> 
>>> 
>>> I get the following error:
>>> 
>>> * checking for file 'NAGFWrappers/DESCRIPTION' ... OK
>>> * preparing 'NAGFWrappers':
>>> * checking DESCRIPTION meta-information ... OK
>>> * cleaning src
>>> make: Nothing to be done for `clean'.
>>> * removing junk files
>>> * checking for LF line-endings in source and make files
>>> * checking for empty or unneeded directories
>>> * building binary distribution
>>> * installing *source* package 'NAGFWrappers' ...
>>> ** libs
>>> /usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
>>> file or directory
>>> make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
>>> Stop.
>>> ERROR: compilation failed for package 'NAGFWrappers'
>>> * removing '/tmp/Rinst1513764321/NAGFWrappers'
>>> ERROR
>>> * installation failed
>>> 
>>> 
>>> Any help / pointers would be appreciated.
>>> 
>>> Cheers
>>> 
>>> Martyn
>>> 
>>> Output from R.version:
>>> 
>>> platform       x86_64-redhat-linux-gnu
>>> arch           x86_64
>>> os             linux-gnu
>>> system         x86_64, linux-gnu
>>> status         
>>> major          2
>>> minor          11.0
>>> year           2010
>>> month          04
>>> day            22
>>> svn rev        51801
>>> language       R
>>> version.string R version 2.11.0 (2010-04-22)
>>> 
>>> 
>>> ________________________________________________________________________
>>> The Numerical Algorithms Group Ltd is a company registered in England
>>> and Wales with company number 1249803. The registered office is:
>>> Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.
>>> 
>>> This e-mail has been scanned for all viruses by Star. Th...{{dropped:4}}
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>


From spencer.graves at structuremonitoring.com  Sat May 21 03:04:04 2011
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Fri, 20 May 2011 18:04:04 -0700
Subject: [Rd] non-R package development
Message-ID: <4DD70F84.2060401@structuremonitoring.com>

Hello, All:


       What would you recommend for software to support developing 
software in languages other than R?  I'm currently writing code in R to 
implement algorithms that may ultimately need to run with asynchronous, 
distributed computing in various languages including Python, Matlab, 
LabVIEW, vanilla Unix, etc.


       I routinely use the "R CMD check", etc., process with Subversion 
for version control and collaborative development.  I've looked for 
similar capabilities for other languages, so far without success.


       Thanks,
       Spencer Graves


-- 
Spencer Graves, PE, PhD
President and Chief Operating Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567


From sean.mcguffee at gmail.com  Sat May 21 03:15:52 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Fri, 20 May 2011 21:15:52 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <AF608EF8-782D-4AE0-8211-67E60EE46EDB@r-project.org>
Message-ID: <C9FC8A88.4327%sean.mcguffee@gmail.com>



> 
>> I still haven't figured out how to do the Makevars thing,
> 
> 
> It's very simple - just remove all targets from your Makefile and you have
> Makevars since R will do the compilation and linking for you and correctly. If
> you feel like it, you can override its behavior by adding one rule (e.g.,
> all:) that lists your desired dependency and you can pass on to the R default
> by depending on $(SHLIB).

I'm not clear on what to put in Makevars.
For example, in my Makefile.in, I have various header/include variables and
various library variables for compiling and linking different libraries that
could be in random locations on different platforms. In the Makefile.in, I
put these variables in the correct locations for compilation and linking. I
assume I can just change AC_CONFIG_FILES([src/Makefile]) to
AC_CONFIG_FILES([src/Makevars]) in autoconf.ac to get Makevars made from a
Makevars.in file. However, what I can't figure out is what my goal is to put
in a Makevars file. I've never seen any explanation of what Makevars files
do to accomplish all of the complexity of a Makefile. Does R use PKG_LIBS in
all compilation and linking steps or something? If so, then I guess I would
just have to set it equal to all of the other variables inside configure. I
haven't explicitly found that written somewhere, but I'm starting to wonder
if that's what it does. Anyway, if you could connect that dot for me, I'd
appreciate it. 

Thanks,
Sean


> 
> Cheers,
> Simon
>


From simon.urbanek at r-project.org  Sat May 21 03:40:09 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 20 May 2011 21:40:09 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <C9FC86FD.4323%sean.mcguffee@gmail.com>
References: <C9FC86FD.4323%sean.mcguffee@gmail.com>
Message-ID: <1DF2EDDB-A441-42B7-96CF-E267E74877AE@r-project.org>

Sean,

On May 20, 2011, at 9:00 PM, Sean Robert McGuffee wrote:

> 
>> Note that setting PKG_LIBS in configure won't work since configure doesn't
>> know how to handle it. It may be ok if you don't care that the flags won't be
>> checked, but then you better know what you're doing ;).
>> 
> Why wouldn't PKG_LIBS work in configure?
> 
> configure.ac:
> 
> PKG_LIBS=`${R_HOME}/bin/Rscript -e "Rcpp:::LdFlags()"`
> AC_SUBST(PKG_LIBS)
> 
> src/Makefile.in:
> PKG_LIBS = @PKG_LIBS@
> 

It will "work" as in the substitution will take place but any tests you run in configure will ignore it since autoconf only uses LIBS and not PKG_LIBS. That's why the standard procedure is to set LIBS and then use PKG_LIBS=@LIBS@ in Makevars.in (there are many ways to do this, though).


>> You have to run autoconf yourself - R has no way of knowing how to bootstrap
>> your setup. Some authors prefer to use the maintainer mode in configure for
>> that, but you still have to create some configure script.
> 
> Good to know--I hoped that explained what was happening sometimes when
> autoconf needed to be run.
> NOTE: The manual says,
> "1.2 Configure and cleanup
> Note that most of this section is specfic to Unix-alikes: see the comments
> later on about the Windows port of R.
> 
> If your package needs some system-dependent configuration before
> installation you can include an executable (Bourne shell) script configure
> in your package which (if present) is executed by R CMD INSTALL before any
> other action is performed.  This can be a script created by the Autoconf
> mechanism, but may also be a script written by yourself.  Use this to detect
> if any nonstandard libraries are present such that corresponding code in the
> package can be disabled at install time rather than giving error messages
> when the package is compiled or used.  To summarize, the full power of
> Autoconf is available for your extension package (including variable
> substitution, searching for libraries, etc.). "
> 
> It might be worth someone revizing this to take out the Autoconf term if it
> really isn't even being used.
> 

It simply says that the configure can be created by autoconf or manually - entirely up to you. It also says explicitly that for this you must include a script named configure so it's quite unmistakable that R won't be creating it.

Cheers,
Simon


> 
>> 
>> 
>>> Anyway, what this will do is create a configure script when autoconf is run.
>>> When ./configure is run by R when installing, it will execute replacement
>>> commands on src/Makefile.in to generate the new Makefile.
>>> Anything within two @ symbols will be replaced.
>>> examples inside my Makefile.in:
>>> CC = @CC@
>>> CXX = @CXX@
>> 
>> You can omit all that if you use Makevars. Also using Makefile is discouraged
>> because it forces you to replicate the whole building process which is very
>> error prone (and may be different for each version of R).
>> 
>> 
>>> I still haven't figured out how to do the Makevars thing,
>> 
>> 
>> It's very simple - just remove all targets from your Makefile and you have
>> Makevars since R will do the compilation and linking for you and correctly. If
>> you feel like it, you can override its behavior by adding one rule (e.g.,
>> all:) that lists your desired dependency and you can pass on to the R default
>> by depending on $(SHLIB).
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>>> but I've
>>> completely given up on R documentation. The key part from the R
>>> documentation that I found useful was that it calls configure on install, so
>>> you can use autoconf documentation to figure out how to set things up.
>>> I'm sure I probably left out a ton of info, but those are my two cents.
>>> Please feel free to ask me for more details if you are interested.
>>> Good luck,
>>> Sean 
>>> 
>>> 
>>> On 5/20/11 12:04 PM, "Martyn Byng" <Martyn.Byng at nag.co.uk> wrote:
>>> 
>>>> Hi,
>>>> 
>>>> I am trying to package some code to use with R and wanted to call
>>>> Rscript from within the Makevars file (I am trying to automate the
>>>> setting of the location of a third party library depending on what is
>>>> available / the system the package is being installed on).
>>>> 
>>>> If I just have a simple Makevars containing
>>>> 
>>>> 
>>>> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
>>>> 
>>>> 
>>>> the package is built without any errors, if I attempt to add a call to
>>>> Rscript, for example (which I think is the way that "Writing R
>>>> Extensions" recommends):
>>>> 
>>>> 
>>>> R_SCRIPT_NAME=Rscript
>>>> ifneq ($(R_HOME),)
>>>> R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
>>>> else
>>>> R_SCRIPT=$(R_SCRIPT_NAME)
>>>> endif
>>>> R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')
>>>> 
>>>> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
>>>> 
>>>> 
>>>> I get the following error:
>>>> 
>>>> * checking for file 'NAGFWrappers/DESCRIPTION' ... OK
>>>> * preparing 'NAGFWrappers':
>>>> * checking DESCRIPTION meta-information ... OK
>>>> * cleaning src
>>>> make: Nothing to be done for `clean'.
>>>> * removing junk files
>>>> * checking for LF line-endings in source and make files
>>>> * checking for empty or unneeded directories
>>>> * building binary distribution
>>>> * installing *source* package 'NAGFWrappers' ...
>>>> ** libs
>>>> /usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
>>>> file or directory
>>>> make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
>>>> Stop.
>>>> ERROR: compilation failed for package 'NAGFWrappers'
>>>> * removing '/tmp/Rinst1513764321/NAGFWrappers'
>>>> ERROR
>>>> * installation failed
>>>> 
>>>> 
>>>> Any help / pointers would be appreciated.
>>>> 
>>>> Cheers
>>>> 
>>>> Martyn
>>>> 
>>>> Output from R.version:
>>>> 
>>>> platform       x86_64-redhat-linux-gnu
>>>> arch           x86_64
>>>> os             linux-gnu
>>>> system         x86_64, linux-gnu
>>>> status         
>>>> major          2
>>>> minor          11.0
>>>> year           2010
>>>> month          04
>>>> day            22
>>>> svn rev        51801
>>>> language       R
>>>> version.string R version 2.11.0 (2010-04-22)
>>>> 
>>>> 
>>>> ________________________________________________________________________
>>>> The Numerical Algorithms Group Ltd is a company registered in England
>>>> and Wales with company number 1249803. The registered office is:
>>>> Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.
>>>> 
>>>> This e-mail has been scanned for all viruses by Star. Th...{{dropped:4}}
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>> 
> 
> 
> 


From b.rowlingson at lancaster.ac.uk  Sat May 21 15:48:35 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 21 May 2011 14:48:35 +0100
Subject: [Rd] non-R package development
In-Reply-To: <4DD70F84.2060401@structuremonitoring.com>
References: <4DD70F84.2060401@structuremonitoring.com>
Message-ID: <BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>

On Sat, May 21, 2011 at 2:04 AM, Spencer Graves
<spencer.graves at structuremonitoring.com> wrote:

> ? ? ?I routinely use the "R CMD check", etc., process with Subversion for
> version control and collaborative development. ?I've looked for similar
> capabilities for other languages, so far without success.

 Python has a similar package build system based around a directory
structure with a 'setup.py' at its root - you may have seen this if
youve ever installed a python package from source. This python script
enables you to do things like 'python setup.py build' and 'python
setup.py install' to build and install the package, as well as run
tests, build distributable archives and so on. There's probably a way
to get a boilerplate package structure all ready to start developing
but I cant think what it is off the top of my head.

SVN and most other version control systems will play nicely with
text-based program development, so get checking in your python,
matlab, and unix scripts. If LabVIEW has a binary format then you can
normally check these in but you won't get meaningful 'diffs' out of
the system to see what has changed between revisions.

Barry


From spencer.graves at structuremonitoring.com  Sat May 21 21:20:14 2011
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Sat, 21 May 2011 12:20:14 -0700
Subject: [Rd] non-R package development
In-Reply-To: <BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>
References: <4DD70F84.2060401@structuremonitoring.com>
	<BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>
Message-ID: <4DD8106E.1000501@structuremonitoring.com>

Hi, Barry:


       Thanks very much.


       Does the "python setup.py build" process include procedures for 
unit testing -- and preferably producing a manual of the module in *.pdf 
and other formats?  Where can I read more about this (beyond 
"http://docs.python.org/install/index.html")?


       I've been using Python almost daily for over 2 years now, but I 
my uses are mostly routine now, and I don't have easy access to a Python 
expert for questions like this.  Standard recommendations for Python 
suggests placing documentation in a certain format at the beginning of 
each *.py code file and function definition.  It also includes ending 
each *.py file with a section starting, 'if __name__ == "__main__":', 
when is a place where unit tests could be recorded, though I've been 
told that is not recommended.  I have not so far found anything that 
checks if all functions and arguments are documented and runs examples, 
like I get from "R CMD check".  (I routinely put unit tests in examples, 
sometimes with "\dontshow".  R experts have criticized me for suggesting 
people put unit tests in the examples sections.  I do it, because it's 
easy and useful.  At some point, I may try the "RUnit" package.)


       Thanks again,
       Spencer


On 5/21/2011 6:48 AM, Barry Rowlingson wrote:
> On Sat, May 21, 2011 at 2:04 AM, Spencer Graves
> <spencer.graves at structuremonitoring.com>  wrote:
>
>>       I routinely use the "R CMD check", etc., process with Subversion for
>> version control and collaborative development.  I've looked for similar
>> capabilities for other languages, so far without success.
>   Python has a similar package build system based around a directory
> structure with a 'setup.py' at its root - you may have seen this if
> youve ever installed a python package from source. This python script
> enables you to do things like 'python setup.py build' and 'python
> setup.py install' to build and install the package, as well as run
> tests, build distributable archives and so on. There's probably a way
> to get a boilerplate package structure all ready to start developing
> but I cant think what it is off the top of my head.
>
> SVN and most other version control systems will play nicely with
> text-based program development, so get checking in your python,
> matlab, and unix scripts. If LabVIEW has a binary format then you can
> normally check these in but you won't get meaningful 'diffs' out of
> the system to see what has changed between revisions.
>
> Barry


From spencer.graves at structuremonitoring.com  Sat May 21 21:35:38 2011
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Sat, 21 May 2011 12:35:38 -0700
Subject: [Rd] non-R package development
In-Reply-To: <BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>
References: <4DD70F84.2060401@structuremonitoring.com>
	<BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>
Message-ID: <4DD8140A.4080705@structuremonitoring.com>

p.s. I've used subversion successfully with LaTeX, R and Python.  I 
tried it with MS Word *.rtf format and found it was next to impossible, 
because any conflict produced an indecipherable diff file comparison.


########################
Hi, Barry:


       Thanks very much.


       Does the "python setup.py build" process include procedures for 
unit testing -- and preferably producing a manual of the module in *.pdf 
and other formats?  Where can I read more about this (beyond 
"http://docs.python.org/install/index.html")?


       I've been using Python almost daily for over 2 years now, but I 
my uses are mostly routine now, and I don't have easy access to a Python 
expert for questions like this.  Standard recommendations for Python 
suggests placing documentation in a certain format at the beginning of 
each *.py code file and function definition.  It also includes ending 
each *.py file with a section starting, 'if __name__ == "__main__":', 
when is a place where unit tests could be recorded, though I've been 
told that is not recommended.  I have not so far found anything that 
checks if all functions and arguments are documented and runs examples, 
like I get from "R CMD check".  (I routinely put unit tests in examples, 
sometimes with "\dontshow".  R experts have criticized me for suggesting 
people put unit tests in the examples sections.  I do it, because it's 
easy and useful.  At some point, I may try the "RUnit" package.)


       Thanks again,
       Spencer


On 5/21/2011 6:48 AM, Barry Rowlingson wrote:
> On Sat, May 21, 2011 at 2:04 AM, Spencer Graves
> <spencer.graves at structuremonitoring.com>  wrote:
>
>>       I routinely use the "R CMD check", etc., process with Subversion for
>> version control and collaborative development.  I've looked for similar
>> capabilities for other languages, so far without success.
>   Python has a similar package build system based around a directory
> structure with a 'setup.py' at its root - you may have seen this if
> youve ever installed a python package from source. This python script
> enables you to do things like 'python setup.py build' and 'python
> setup.py install' to build and install the package, as well as run
> tests, build distributable archives and so on. There's probably a way
> to get a boilerplate package structure all ready to start developing
> but I cant think what it is off the top of my head.
>
> SVN and most other version control systems will play nicely with
> text-based program development, so get checking in your python,
> matlab, and unix scripts. If LabVIEW has a binary format then you can
> normally check these in but you won't get meaningful 'diffs' out of
> the system to see what has changed between revisions.
>
> Barry


From ripley at stats.ox.ac.uk  Sat May 21 22:48:34 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 21 May 2011 21:48:34 +0100 (BST)
Subject: [Rd] non-R package development
In-Reply-To: <4DD8140A.4080705@structuremonitoring.com>
References: <4DD70F84.2060401@structuremonitoring.com>
	<BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>
	<4DD8140A.4080705@structuremonitoring.com>
Message-ID: <alpine.LFD.2.02.1105212141150.10934@gannet.stats.ox.ac.uk>

On Sat, 21 May 2011, Spencer Graves wrote:

> p.s. I've used subversion successfully with LaTeX, R and Python.  I tried it 
> with MS Word *.rtf format and found it was next to impossible, because any 
> conflict produced an indecipherable diff file comparison.

.rtf is not a Word format, although it is a Microsoft one.  It is used 
a lot more widely.

In any case .rtf is pretty indecipherable, so expect diffs to be too! 
As it was the base format for earlier forms of MS help, at one time I 
did get quite good at deciphering it.  As I recall I had .rtf files in 
CVS then --- and just checking, R has a License.rtf and that is ASCII 
not binary.

So I think the 'indecipherable' is entirely about .rtf and not about 
svn.

>
>
> ########################
> Hi, Barry:
>
>
>      Thanks very much.
>
>
>      Does the "python setup.py build" process include procedures for unit 
> testing -- and preferably producing a manual of the module in *.pdf and other 
> formats?  Where can I read more about this (beyond 
> "http://docs.python.org/install/index.html")?
>
>
>      I've been using Python almost daily for over 2 years now, but I my uses 
> are mostly routine now, and I don't have easy access to a Python expert for 
> questions like this.  Standard recommendations for Python suggests placing 
> documentation in a certain format at the beginning of each *.py code file and 
> function definition.  It also includes ending each *.py file with a section 
> starting, 'if __name__ == "__main__":', when is a place where unit tests 
> could be recorded, though I've been told that is not recommended.  I have not 
> so far found anything that checks if all functions and arguments are 
> documented and runs examples, like I get from "R CMD check".  (I routinely 
> put unit tests in examples, sometimes with "\dontshow".  R experts have 
> criticized me for suggesting people put unit tests in the examples sections. 
> I do it, because it's easy and useful.  At some point, I may try the "RUnit" 
> package.)
>
>
>      Thanks again,
>      Spencer
>
>
> On 5/21/2011 6:48 AM, Barry Rowlingson wrote:
>> On Sat, May 21, 2011 at 2:04 AM, Spencer Graves
>> <spencer.graves at structuremonitoring.com>  wrote:
>>
>>>       I routinely use the "R CMD check", etc., process with Subversion for
>>> version control and collaborative development.  I've looked for similar
>>> capabilities for other languages, so far without success.
>>   Python has a similar package build system based around a directory
>> structure with a 'setup.py' at its root - you may have seen this if
>> youve ever installed a python package from source. This python script
>> enables you to do things like 'python setup.py build' and 'python
>> setup.py install' to build and install the package, as well as run
>> tests, build distributable archives and so on. There's probably a way
>> to get a boilerplate package structure all ready to start developing
>> but I cant think what it is off the top of my head.
>> 
>> SVN and most other version control systems will play nicely with
>> text-based program development, so get checking in your python,
>> matlab, and unix scripts. If LabVIEW has a binary format then you can
>> normally check these in but you won't get meaningful 'diffs' out of
>> the system to see what has changed between revisions.
>> 
>> Barry
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From spencer.graves at structuremonitoring.com  Sat May 21 23:04:12 2011
From: spencer.graves at structuremonitoring.com (Spencer Graves)
Date: Sat, 21 May 2011 14:04:12 -0700
Subject: [Rd] non-R package development
In-Reply-To: <alpine.LFD.2.02.1105212141150.10934@gannet.stats.ox.ac.uk>
References: <4DD70F84.2060401@structuremonitoring.com>
	<BANLkTinpON=8_61GHG-fmy0TmR+EBK6qGg@mail.gmail.com>
	<4DD8140A.4080705@structuremonitoring.com>
	<alpine.LFD.2.02.1105212141150.10934@gannet.stats.ox.ac.uk>
Message-ID: <4DD828CC.7060301@structuremonitoring.com>

Dear Prof. Ripley:



On 5/21/2011 1:48 PM, Prof Brian Ripley wrote:
> On Sat, 21 May 2011, Spencer Graves wrote:
>
>> p.s. I've used subversion successfully with LaTeX, R and Python.  I 
>> tried it with MS Word *.rtf format and found it was next to 
>> impossible, because any conflict produced an indecipherable diff file 
>> comparison.
>
> .rtf is not a Word format, although it is a Microsoft one.  It is used 
> a lot more widely.
>
> In any case .rtf is pretty indecipherable, so expect diffs to be too! 
> As it was the base format for earlier forms of MS help, at one time I 
> did get quite good at deciphering it.  As I recall I had .rtf files in 
> CVS then --- and just checking, R has a License.rtf and that is ASCII 
> not binary.
>
> So I think the 'indecipherable' is entirely about .rtf and not about svn.


       Agreed.  I used RTF in part because it is ASCII not binary.  I 
had gotten excellent results from other types of ASCII files but learned 
what you just reported, that and the SVN diff function works great for 
other material in ASCII (including LaTeX), but not RTF -- which is 
arguably almost binary.  ;-)


       Thanks for the comment.
       Spencer

>
>>
>> ########################
>> Hi, Barry:
>>
>>
>>      Thanks very much.
>>
>>
>>      Does the "python setup.py build" process include procedures for 
>> unit testing -- and preferably producing a manual of the module in 
>> *.pdf and other formats?  Where can I read more about this (beyond 
>> "http://docs.python.org/install/index.html")?
>>
>>
>>      I've been using Python almost daily for over 2 years now, but I 
>> my uses are mostly routine now, and I don't have easy access to a 
>> Python expert for questions like this.  Standard recommendations for 
>> Python suggests placing documentation in a certain format at the 
>> beginning of each *.py code file and function definition.  It also 
>> includes ending each *.py file with a section starting, 'if __name__ 
>> == "__main__":', when is a place where unit tests could be recorded, 
>> though I've been told that is not recommended.  I have not so far 
>> found anything that checks if all functions and arguments are 
>> documented and runs examples, like I get from "R CMD check".  (I 
>> routinely put unit tests in examples, sometimes with "\dontshow".  R 
>> experts have criticized me for suggesting people put unit tests in 
>> the examples sections. I do it, because it's easy and useful.  At 
>> some point, I may try the "RUnit" package.)
>>
>>
>>      Thanks again,
>>      Spencer
>>
>>
>> On 5/21/2011 6:48 AM, Barry Rowlingson wrote:
>>> On Sat, May 21, 2011 at 2:04 AM, Spencer Graves
>>> <spencer.graves at structuremonitoring.com>  wrote:
>>>
>>>>       I routinely use the "R CMD check", etc., process with 
>>>> Subversion for
>>>> version control and collaborative development.  I've looked for 
>>>> similar
>>>> capabilities for other languages, so far without success.
>>>   Python has a similar package build system based around a directory
>>> structure with a 'setup.py' at its root - you may have seen this if
>>> youve ever installed a python package from source. This python script
>>> enables you to do things like 'python setup.py build' and 'python
>>> setup.py install' to build and install the package, as well as run
>>> tests, build distributable archives and so on. There's probably a way
>>> to get a boilerplate package structure all ready to start developing
>>> but I cant think what it is off the top of my head.
>>>
>>> SVN and most other version control systems will play nicely with
>>> text-based program development, so get checking in your python,
>>> matlab, and unix scripts. If LabVIEW has a binary format then you can
>>> normally check these in but you won't get meaningful 'diffs' out of
>>> the system to see what has changed between revisions.
>>>
>>> Barry
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From andralia.tolbus at gmail.com  Sun May 22 14:31:51 2011
From: andralia.tolbus at gmail.com (Andra)
Date: Sun, 22 May 2011 12:31:51 +0000
Subject: [Rd] Use of R in C#
References: <C3D16A4C8BD3F843860C73573C70DD952E255192@TK5EX14MBXC103.redmond.corp.microsoft.com>
Message-ID: <loom.20110522T142600-449@post.gmane.org>


Jeff Abrams <jeffab <at> microsoft.com> writes:

> 
> I have a C# program that requires the run of a logistic regression.  I have 
downloaded the R 2.11 package, and
> have added the following references to my code:
> 
> STATCONNECTORCLNTLib;
> StatConnectorCommonLib;
> STATCONNECTORSRVLib;
> 
> In my code I have:
> StatConnector scs = new STATCONNECTORSRVLib.StatConnectorClass();
> scs.Init("R");
> 
> The init step returns the below error which seems to indicate a connection 
failure.
> 
> System.Runtime.InteropServices.COMException was unhandled
>   Message="Exception from HRESULT: 0x80040013"
>   Source="Interop.STATCONNECTORSRVLib"
>   ErrorCode=-2147221485
> 
> Any ideas?
> 
> Jeff Abrams
> Research Engineer


Hi,

   I have solved this problem wit R 2.9 by running the com server installation 
in Win 7 Compatibility. Everything went perfectly fine until I have installed 
the latest version of R, 2.13. The problem was back. 
I can see that your post is a couple of weeks old. Have you managed to solve 
this problem?
> Auction Analytics, Microsoft
> 
> 	[[alternative HTML version deleted]]
> 
>


From erich.neuwirth at univie.ac.at  Mon May 23 12:05:09 2011
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Mon, 23 May 2011 12:05:09 +0200
Subject: [Rd] Use of R in C#
In-Reply-To: <loom.20110522T142600-449@post.gmane.org>
References: <C3D16A4C8BD3F843860C73573C70DD952E255192@TK5EX14MBXC103.redmond.corp.microsoft.com>
	<loom.20110522T142600-449@post.gmane.org>
Message-ID: <4DDA3155.7080103@univie.ac.at>

Please discuss statconnDCOM related problems on its dedicated mailing
list. You can subscribe at rcom.univie.ac.at


On 5/22/2011 2:31 PM, Andra wrote:
> 
> Jeff Abrams <jeffab <at> microsoft.com> writes:
> 
>>
>> I have a C# program that requires the run of a logistic regression.  I have 
> downloaded the R 2.11 package, and
>> have added the following references to my code:


From Martyn.Byng at nag.co.uk  Mon May 23 13:55:43 2011
From: Martyn.Byng at nag.co.uk (Martyn Byng)
Date: Mon, 23 May 2011 12:55:43 +0100
Subject: [Rd] Calling Rscript from Makevars
References: <49E76DF37649DC48A4CE882BC8CE51C901AD8398@nagmail2.nag.co.uk>
	<86F6F0A1-391C-4481-B0BA-5681CC4CA148@r-project.org>
Message-ID: <49E76DF37649DC48A4CE882BC8CE51C901AD84B4@nagmail2.nag.co.uk>

Hi,

Thanks for the help. 

Putting the call to Rscript directly in the definition of PKG_LIBS
rather than in a different makefile variable and using that variable
when defining PKG_LIBS did indeed fix my problem.

Martyn
-----Original Message-----
From: Simon Urbanek [mailto:simon.urbanek at r-project.org] 
Sent: 20 May 2011 20:17
To: Martyn Byng
Cc: r-devel at r-project.org
Subject: Re: [Rd] Calling Rscript from Makevars


On May 20, 2011, at 12:04 PM, Martyn Byng wrote:

> Hi,
> 
> I am trying to package some code to use with R and wanted to call
> Rscript from within the Makevars file (I am trying to automate the
> setting of the location of a third party library depending on what is
> available / the system the package is being installed on).
> 
> If I just have a simple Makevars containing
> 
> 
> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
> 
> 
> the package is built without any errors, if I attempt to add a call to
> Rscript, for example (which I think is the way that "Writing R
> Extensions" recommends):
> 
> 
> R_SCRIPT_NAME=Rscript
> ifneq ($(R_HOME),)
>  R_SCRIPT=$(R_HOME)/bin$(R_ARCH_BIN)/$(R_SCRIPT_NAME)
> else
>  R_SCRIPT=$(R_SCRIPT_NAME)
> endif
> R_ARCH=$(shell $(R_SCRIPT) -e 'cat(R.version$$arch)')
> 

That's all pretty much unnecessary since all settings carry over from
the R invocation and also it is what causes your error (since your
"arch" is wrong). On unix it's as simple as

PKG_LIBS=`${R_HOME}/bin/Rscript -e 'whatever.you.meant.to.run()'`

and on Windows it's

PKG_LIBS=`${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe -e
'whatever.you.meant.to.run()'`

Note that you should NOT mess with the environment variables that R uses
as you're likely to set them incorrectly.

Cheers,
Simon



> PKG_LIBS= -lnag_nag -L/fserver/nagprod/FL22/fll6a22df/lib
> 
> 
> I get the following error:
> 
> * checking for file 'NAGFWrappers/DESCRIPTION' ... OK
> * preparing 'NAGFWrappers':
> * checking DESCRIPTION meta-information ... OK
> * cleaning src
> make: Nothing to be done for `clean'.
> * removing junk files
> * checking for LF line-endings in source and make files
> * checking for empty or unneeded directories
> * building binary distribution
> * installing *source* package 'NAGFWrappers' ...
> ** libs
> /usr/share/R/make/shlib.mk:3: /usr/lib64/R/etcx86_64/Makeconf: No such
> file or directory
> make: *** No rule to make target `/usr/lib64/R/etcx86_64/Makeconf'.
> Stop.
> ERROR: compilation failed for package 'NAGFWrappers'
> * removing '/tmp/Rinst1513764321/NAGFWrappers'
> ERROR
> * installation failed
> 
> 
> Any help / pointers would be appreciated.
> 
> Cheers
> 
> Martyn
> 
> Output from R.version:
> 
> platform       x86_64-redhat-linux-gnu      
> arch           x86_64                       
> os             linux-gnu                    
> system         x86_64, linux-gnu            
> status                                      
> major          2                            
> minor          11.0                         
> year           2010                         
> month          04                           
> day            22                           
> svn rev        51801                        
> language       R                            
> version.string R version 2.11.0 (2010-04-22)
> 
> 
>
________________________________________________________________________
> The Numerical Algorithms Group Ltd is a company registered in England
> and Wales with company number 1249803. The registered office is:
> Wilkinson House, Jordan Hill Road, Oxford OX2 8DR, United Kingdom.
> 
> This e-mail has been scanned for all viruses by Star.
Th...{{dropped:4}}
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


________________________________________________________________________
This e-mail has been scanned for all viruses by Star.\ _...{{dropped:12}}


From sean.mcguffee at gmail.com  Mon May 23 18:56:54 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Mon, 23 May 2011 12:56:54 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <1DF2EDDB-A441-42B7-96CF-E267E74877AE@r-project.org>
Message-ID: <CA000A16.4362%sean.mcguffee@gmail.com>

Hi Simon,

I'm not sure what you mean by, "any tests you run in configure will ignore
it since autoconf only uses LIBS and not PKG_LIBS." I though autoconf used
any variable names you tell it to, so that it would use PKG_LIBS if you tell
it to. 

Also, I'm still not clear as to what a Makevars file is. To clarify, I do
understand a Makefile. When GNU's make program is run, it looks for a
Makefile and interprets it in ways that are documented very well by GNU. I
have yet to find any lead as to what a Makevars file is, what to put in it,
what it does, or how it helps in installation with R packages. I can
understand how to define variables in it, but the only way I know how to use
variables that are defined is by using them in a Makefile. Where and how are
variables defined in Makevars used?

Sean


From simon.urbanek at r-project.org  Mon May 23 19:30:48 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 23 May 2011 13:30:48 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <CA000A16.4362%sean.mcguffee@gmail.com>
References: <CA000A16.4362%sean.mcguffee@gmail.com>
Message-ID: <97C76D4A-77B3-4767-AF81-73E1F04DB611@r-project.org>


On May 23, 2011, at 12:56 PM, Sean Robert McGuffee wrote:

> I'm not sure what you mean by, "any tests you run in configure will ignore it since autoconf only uses LIBS and not PKG_LIBS." I though autoconf used any variable names you tell it to, so that it would use PKG_LIBS if you tell it to. 
> 

No, many variables have a special meanings in autoconf, such as CC, CPP, CFLAGS, LIBS, LDFLAGS etc. When you run tests like AC_PROG*, AC_HEADER*, AC_CHECK_*, AC_COMPILE*, AC_LINK* then those use (and set) only the variables supported by configure and they have no idea about things like PKG_LIBS. So as far as autoconf is concerned PKG_LIBS has no effect.

Because R has its own building process, using autoconf with packages means you have to a) set autoconf's flags to match the R configuration before you do anything, b) use autoconf tests which implies using autoconf's flags, c) map resulting autoconf flags to special R package flags. If you skip any of a,b,c the result will not be reliable. In theory, you can handle R's flags and autoconf flags in parallel, i.e., updating both in the success branch of each test, but that's a bit too tedious to implement (you can't use the autoconf default actions) and unnecessary.


> Also, I'm still not clear as to what a Makevars file is. To clarify, I do understand a Makefile. When GNU's make program is run, it looks for a Makefile and interprets it in ways that are documented very well by GNU. I have yet to find any lead as to what a Makevars file is, what to put in it, what it does, or how it helps in installation with R packages. I can understand how to define variables in it, but the only way I know how to use variables that are defined is by using them in a Makefile. Where and how are variables defined in Makevars used?
> 

Makevars is simply a file included in R's Makefile when it is building the package. So, technically, it is a makefile. The difference between Makevars and Makefile is that Makevars doesn't need to specify any rules or variables that R already knows about, because they are already included by R. So it is much more convenient since it saves you a lot of trouble trying to setup the correct rules for compilation, linking etc. At the same time, it is a makefile so you can add targets, modify dependencies etc., you're not constrained to just setting variables although that is its primary use.

In practice Makevars can be used in several ways:

a) just set PKG_CFLAGS, PKG_LIBS
this is the most common use and it leaves the standard targets in place so R will use those to compile $(SHLIB) automatically

b) include additional targets:
if you have additional features to build, you can specify them in a target, for example this is form rJava:

all: $(SHLIB) @WANT_JRI_TRUE@ jri
jri: ... 

It builds the standard $(SHLIB) which is loaded by the package, but it also builds a separate target "jri" if enabled in configure

c) include dependencies:
you can add dependent builds that are needed for your $(SHLIB), for example from RSQLite:

all: $(SHLIB)
$(SHLIB): do_includes
do_includes:

This makes sure that do_includes is built before R attempts to build the .so/.dll


So, as you can see you Makevars gives you the flexibility of Makefile but without the hassle.

Cheers,
Simon


From sean.mcguffee at gmail.com  Mon May 23 20:03:41 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Mon, 23 May 2011 14:03:41 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <97C76D4A-77B3-4767-AF81-73E1F04DB611@r-project.org>
Message-ID: <CA0019BD.4366%sean.mcguffee@gmail.com>




On 5/23/11 1:30 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:

> 
> On May 23, 2011, at 12:56 PM, Sean Robert McGuffee wrote:
> 
>> I'm not sure what you mean by, "any tests you run in configure will ignore it
>> since autoconf only uses LIBS and not PKG_LIBS." I though autoconf used any
>> variable names you tell it to, so that it would use PKG_LIBS if you tell it
>> to. 
>> 
> 
> No, many variables have a special meanings in autoconf, such as CC, CPP,
> CFLAGS, LIBS, LDFLAGS etc. When you run tests like AC_PROG*, AC_HEADER*,
> AC_CHECK_*, AC_COMPILE*, AC_LINK* then those use (and set) only the variables
> supported by configure and they have no idea about things like PKG_LIBS. So as
> far as autoconf is concerned PKG_LIBS has no effect.

I'm not familiar with all of the AC_* commands, but I'm pretty sure that
AC_SUBST(PKG_LIBS) will properly set the variable PKG_LIBS or any variable
you like. You can run tests to set it how you like before you run AC_SUBST
too. For example,
if test [ -n "$lmmin_include_path" ] ; then
   LMMIN_INCLUDE_CXXFLAGS="-I${lmmin_include_path}"
else
   if test [ -n "${LMMIN_INCLUDE}" ] ; then
      LMMIN_INCLUDE_CXXFLAGS="-I${LMMIN_INCLUDE}"
   else
      LMMIN_INCLUDE_CXXFLAGS="-I/default
   fi
fi
AC_SUBST(LMMIN_INCLUDE_CXXFLAGS)

> 
> Because R has its own building process, using autoconf with packages means you
> have to a) set autoconf's flags to match the R configuration before you do
> anything, b) use autoconf tests which implies using autoconf's flags, c) map
> resulting autoconf flags to special R package flags. If you skip any of a,b,c
> the result will not be reliable. In theory, you can handle R's flags and
> autoconf flags in parallel, i.e., updating both in the success branch of each
> test, but that's a bit too tedious to implement (you can't use the autoconf
> default actions) and unnecessary.
> 
> 
>> Also, I'm still not clear as to what a Makevars file is. To clarify, I do
>> understand a Makefile. When GNU's make program is run, it looks for a
>> Makefile and interprets it in ways that are documented very well by GNU. I
>> have yet to find any lead as to what a Makevars file is, what to put in it,
>> what it does, or how it helps in installation with R packages. I can
>> understand how to define variables in it, but the only way I know how to use
>> variables that are defined is by using them in a Makefile. Where and how are
>> variables defined in Makevars used?
>> 
> 
> Makevars is simply a file included in R's Makefile when it is building the
> package. 

I think this if *EXTREMEMLY* useful information and should be appended to
the beginning of "Writing R Extensions: 1.2.1 Using Makevars." Thank you so
much for sharing this crucial piece of information. Now it all makes sense.

> So, technically, it is a makefile. The difference between Makevars
> and Makefile is that Makevars doesn't need to specify any rules or variables
> that R already knows about, because they are already included by R. So it is
> much more convenient since it saves you a lot of trouble trying to setup the
> correct rules for compilation, linking etc. At the same time, it is a makefile
> so you can add targets, modify dependencies etc., you're not constrained to
> just setting variables although that is its primary use.
> 
> In practice Makevars can be used in several ways:
> 
> a) just set PKG_CFLAGS, PKG_LIBS
> this is the most common use and it leaves the standard targets in place so R
> will use those to compile $(SHLIB) automatically
> 
> b) include additional targets:
> if you have additional features to build, you can specify them in a target,
> for example this is form rJava:
> 
> all: $(SHLIB) @WANT_JRI_TRUE@ jri
> jri: ... 
> 
> It builds the standard $(SHLIB) which is loaded by the package, but it also
> builds a separate target "jri" if enabled in configure
> 
> c) include dependencies:
> you can add dependent builds that are needed for your $(SHLIB), for example
> from RSQLite:
> 
> all: $(SHLIB)
> $(SHLIB): do_includes
> do_includes:
> 
> This makes sure that do_includes is built before R attempts to build the
> .so/.dll
> 
> 
> So, as you can see you Makevars gives you the flexibility of Makefile but
> without the hassle.
> 
> Cheers,
> Simon
>


From simon.urbanek at r-project.org  Tue May 24 02:58:32 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 23 May 2011 20:58:32 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <CA0019BD.4366%sean.mcguffee@gmail.com>
References: <CA0019BD.4366%sean.mcguffee@gmail.com>
Message-ID: <54EFBBFE-EC4F-4B26-8C2E-2E31FBB71F51@r-project.org>

Sean,

On May 23, 2011, at 2:03 PM, Sean Robert McGuffee wrote:

> 
> On 5/23/11 1:30 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
> 
>> 
>> On May 23, 2011, at 12:56 PM, Sean Robert McGuffee wrote:
>> 
>>> I'm not sure what you mean by, "any tests you run in configure will ignore it
>>> since autoconf only uses LIBS and not PKG_LIBS." I though autoconf used any
>>> variable names you tell it to, so that it would use PKG_LIBS if you tell it
>>> to. 
>>> 
>> 
>> No, many variables have a special meanings in autoconf, such as CC, CPP,
>> CFLAGS, LIBS, LDFLAGS etc. When you run tests like AC_PROG*, AC_HEADER*,
>> AC_CHECK_*, AC_COMPILE*, AC_LINK* then those use (and set) only the variables
>> supported by configure and they have no idea about things like PKG_LIBS. So as
>> far as autoconf is concerned PKG_LIBS has no effect.
> 
> I'm not familiar with all of the AC_* commands, but I'm pretty sure that
> AC_SUBST(PKG_LIBS) will properly set the variable PKG_LIBS or any variable
> you like. You can run tests to set it how you like before you run AC_SUBST
> too. For example,
> if test [ -n "$lmmin_include_path" ] ; then
>   LMMIN_INCLUDE_CXXFLAGS="-I${lmmin_include_path}"
> else
>   if test [ -n "${LMMIN_INCLUDE}" ] ; then
>      LMMIN_INCLUDE_CXXFLAGS="-I${LMMIN_INCLUDE}"
>   else
>      LMMIN_INCLUDE_CXXFLAGS="-I/default
>   fi
> fi
> AC_SUBST(LMMIN_INCLUDE_CXXFLAGS)
> 

Yes, but the above don't actually test anything - it just performs a shell substitution, you still have no idea if that actually works. The point of autoconf is to provide tests of functionality - that's what all the tests I mentioned are about. If you just wanted to replace a variable, you can use sed and skip all autoconf ;) - or in fact you can simply use Makevars since that gives you all shell functionality and you don't sacrifice the ability to support multiple architectures (see my previous comment why configure should be only used if absolutely necessary as it impedes the package build process).


>> Because R has its own building process, using autoconf with packages means you
>> have to a) set autoconf's flags to match the R configuration before you do
>> anything, b) use autoconf tests which implies using autoconf's flags, c) map
>> resulting autoconf flags to special R package flags. If you skip any of a,b,c
>> the result will not be reliable. In theory, you can handle R's flags and
>> autoconf flags in parallel, i.e., updating both in the success branch of each
>> test, but that's a bit too tedious to implement (you can't use the autoconf
>> default actions) and unnecessary.
>> 
>> 
>>> Also, I'm still not clear as to what a Makevars file is. To clarify, I do
>>> understand a Makefile. When GNU's make program is run, it looks for a
>>> Makefile and interprets it in ways that are documented very well by GNU. I
>>> have yet to find any lead as to what a Makevars file is, what to put in it,
>>> what it does, or how it helps in installation with R packages. I can
>>> understand how to define variables in it, but the only way I know how to use
>>> variables that are defined is by using them in a Makefile. Where and how are
>>> variables defined in Makevars used?
>>> 
>> 
>> Makevars is simply a file included in R's Makefile when it is building the
>> package. 
> 
> I think this if *EXTREMEMLY* useful information and should be appended to
> the beginning of "Writing R Extensions: 1.2.1 Using Makevars." Thank you so
> much for sharing this crucial piece of information. Now it all makes sense.
> 

From R-admin: http://r.research.att.com/man/R-exts.html#Using-Makevars

"There are some macros which are set whilst configuring the building of R itself and are stored in R_HOME/etcR_ARCH/Makeconf. That makefile is included as a Makefile afterMakevars[.win], and the macros it defines can be used in macro assignments and make command lines in the latter."

(this attempts makes clear that Makevars is a makefile included before Makeconf)

and

"Note that Makevars should not normally contain targets, as it is included before the default makefile and make will call the first target, intended to be all in the default makefile. If you really need to circumvent that, use a suitable (phony) target all before any actual targets in Makevars.[win]:"

(this attempts to make clear that you can define targets in Makevars even if it's not customary)

Cheers,
Simon


>> So, technically, it is a makefile. The difference between Makevars
>> and Makefile is that Makevars doesn't need to specify any rules or variables
>> that R already knows about, because they are already included by R. So it is
>> much more convenient since it saves you a lot of trouble trying to setup the
>> correct rules for compilation, linking etc. At the same time, it is a makefile
>> so you can add targets, modify dependencies etc., you're not constrained to
>> just setting variables although that is its primary use.
>> 
>> In practice Makevars can be used in several ways:
>> 
>> a) just set PKG_CFLAGS, PKG_LIBS
>> this is the most common use and it leaves the standard targets in place so R
>> will use those to compile $(SHLIB) automatically
>> 
>> b) include additional targets:
>> if you have additional features to build, you can specify them in a target,
>> for example this is form rJava:
>> 
>> all: $(SHLIB) @WANT_JRI_TRUE@ jri
>> jri: ... 
>> 
>> It builds the standard $(SHLIB) which is loaded by the package, but it also
>> builds a separate target "jri" if enabled in configure
>> 
>> c) include dependencies:
>> you can add dependent builds that are needed for your $(SHLIB), for example
>> from RSQLite:
>> 
>> all: $(SHLIB)
>> $(SHLIB): do_includes
>> do_includes:
>> 
>> This makes sure that do_includes is built before R attempts to build the
>> .so/.dll
>> 
>> 
>> So, as you can see you Makevars gives you the flexibility of Makefile but
>> without the hassle.
>> 
>> Cheers,
>> Simon
>> 
> 
> 
> 


From pcd at roxygen.org  Wed May 25 19:10:38 2011
From: pcd at roxygen.org (Peter Danenberg)
Date: Wed, 25 May 2011 12:10:38 -0500
Subject: [Rd] External special functions (SPECIALSXP)
Message-ID: <20110525171038.GA21186@klutometis.wikitex.org>

Is it possible to define an external special function (SPECIALSXP)?
I'm trying to do some language-level work, and don't want my arguments
evaluated before they hit C.

It looks like the only way to define a SPECIALSXP is by using XX0 in
the `eval' field of R_FunTab; is there any way to make this applicable
to externally defined functions?


From murdoch.duncan at gmail.com  Wed May 25 19:45:06 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 25 May 2011 13:45:06 -0400
Subject: [Rd] External special functions (SPECIALSXP)
In-Reply-To: <20110525171038.GA21186@klutometis.wikitex.org>
References: <20110525171038.GA21186@klutometis.wikitex.org>
Message-ID: <4DDD4022.5060001@gmail.com>

On 25/05/2011 1:10 PM, Peter Danenberg wrote:
> Is it possible to define an external special function (SPECIALSXP)?
> I'm trying to do some language-level work, and don't want my arguments
> evaluated before they hit C.
>
> It looks like the only way to define a SPECIALSXP is by using XX0 in
> the `eval' field of R_FunTab; is there any way to make this applicable
> to externally defined functions?


I don't think so.  However, if you don't want to evaluate the arguments, 
just pass substitute(arg) to your function instead of arg.  For example,

  f <- function(a, b) {
    print(substitute(b))
    print(substitute(a))
  }

f( x <- 1, y <- 2 )

will print but never evaluate the assignments.

Duncan Murdoch


From pcd at roxygen.org  Wed May 25 20:05:47 2011
From: pcd at roxygen.org (Peter Danenberg)
Date: Wed, 25 May 2011 13:05:47 -0500
Subject: [Rd] External special functions (SPECIALSXP)
In-Reply-To: <4DDD4022.5060001@gmail.com>
References: <20110525171038.GA21186@klutometis.wikitex.org>
	<4DDD4022.5060001@gmail.com>
Message-ID: <20110525180547.GA23242@klutometis.wikitex.org>

> However, if you don't want to evaluate the arguments, just pass
> substitute(arg) to your function instead of arg.

Thanks, Duncan; the problem is, I'm trying to substitute on `...' and
I don't think I can access `...' without inadvertently evaluating it.

I'm trying to write a debugging function which, given any number of
expressions, prints the expression next to its evaluation.

This is trivial to do in the single arity case:

  debug <- function(expression) {
    cat(substitute(expression), expression, "\n")
  }

  a <- 2
  debug(a)

  a 2

but I'm not sure how to make it work with variable arity without
resorting to SPECIALSXP.


From wdunlap at tibco.com  Wed May 25 20:20:12 2011
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 25 May 2011 11:20:12 -0700
Subject: [Rd] External special functions (SPECIALSXP)
In-Reply-To: <20110525180547.GA23242@klutometis.wikitex.org>
References: <20110525171038.GA21186@klutometis.wikitex.org><4DDD4022.5060001@gmail.com>
	<20110525180547.GA23242@klutometis.wikitex.org>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D7000442F1FC@NA-PA-VBE03.na.tibco.com>

> f <- function(...) {
+     dotArgList <- substitute(list(...))
+     dotArgList
+ }
> f(cat("foo\n"), stop("Oops"), warning("Hmm"))
list(cat("foo\n"), stop("Oops"), warning("Hmm"))
> # i.e., no argument was evaluated

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Peter Danenberg
> Sent: Wednesday, May 25, 2011 11:06 AM
> To: Duncan Murdoch
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] External special functions (SPECIALSXP)
> 
> > However, if you don't want to evaluate the arguments, just pass
> > substitute(arg) to your function instead of arg.
> 
> Thanks, Duncan; the problem is, I'm trying to substitute on `...' and
> I don't think I can access `...' without inadvertently evaluating it.
> 
> I'm trying to write a debugging function which, given any number of
> expressions, prints the expression next to its evaluation.
> 
> This is trivial to do in the single arity case:
> 
>   debug <- function(expression) {
>     cat(substitute(expression), expression, "\n")
>   }
> 
>   a <- 2
>   debug(a)
> 
>   a 2
> 
> but I'm not sure how to make it work with variable arity without
> resorting to SPECIALSXP.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From wdunlap at tibco.com  Wed May 25 20:24:36 2011
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 25 May 2011 11:24:36 -0700
Subject: [Rd] External special functions (SPECIALSXP)
References: <20110525171038.GA21186@klutometis.wikitex.org><4DDD4022.5060001@gmail.com>
	<20110525180547.GA23242@klutometis.wikitex.org> 
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D7000442F1FE@NA-PA-VBE03.na.tibco.com>



Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com  

> -----Original Message-----
> From: William Dunlap 
> Sent: Wednesday, May 25, 2011 11:20 AM
> To: 'Peter Danenberg'
> Cc: r-devel at r-project.org
> Subject: RE: [Rd] External special functions (SPECIALSXP)
> 
> > f <- function(...) {
> +     dotArgList <- substitute(list(...))
> +     dotArgList
> + }
> > f(cat("foo\n"), stop("Oops"), warning("Hmm"))
> list(cat("foo\n"), stop("Oops"), warning("Hmm"))
> > # i.e., no argument was evaluated

Or, if you'd prefer a pairlist over a call to list:
  > fp <- function(...) {
  +     dotArgList <- substitute(...())
  +     dotArgList
  + }
  > fp(message=cat("foo\n"), error=stop("Oops"),
possibleProblem=warning("Hmm"))
  $message
  cat("foo\n")

  $error
  stop("Oops")
  
  $possibleProblem
  warning("Hmm")

  > class(.Last.value)
  [1] "pairlist"
I would not have thought of this syntax myself but have
seen it in other folks' code.

> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com  
> 
> > -----Original Message-----
> > From: r-devel-bounces at r-project.org 
> > [mailto:r-devel-bounces at r-project.org] On Behalf Of Peter Danenberg
> > Sent: Wednesday, May 25, 2011 11:06 AM
> > To: Duncan Murdoch
> > Cc: r-devel at r-project.org
> > Subject: Re: [Rd] External special functions (SPECIALSXP)
> > 
> > > However, if you don't want to evaluate the arguments, just pass
> > > substitute(arg) to your function instead of arg.
> > 
> > Thanks, Duncan; the problem is, I'm trying to substitute on 
> `...' and
> > I don't think I can access `...' without inadvertently 
> evaluating it.
> > 
> > I'm trying to write a debugging function which, given any number of
> > expressions, prints the expression next to its evaluation.
> > 
> > This is trivial to do in the single arity case:
> > 
> >   debug <- function(expression) {
> >     cat(substitute(expression), expression, "\n")
> >   }
> > 
> >   a <- 2
> >   debug(a)
> > 
> >   a 2
> > 
> > but I'm not sure how to make it work with variable arity without
> > resorting to SPECIALSXP.
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> > 


From murdoch.duncan at gmail.com  Wed May 25 20:24:08 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 25 May 2011 14:24:08 -0400
Subject: [Rd] External special functions (SPECIALSXP)
In-Reply-To: <20110525180547.GA23242@klutometis.wikitex.org>
References: <20110525171038.GA21186@klutometis.wikitex.org>
	<4DDD4022.5060001@gmail.com>
	<20110525180547.GA23242@klutometis.wikitex.org>
Message-ID: <4DDD4948.90800@gmail.com>

On 25/05/2011 2:05 PM, Peter Danenberg wrote:
> >  However, if you don't want to evaluate the arguments, just pass
> >  substitute(arg) to your function instead of arg.
>
> Thanks, Duncan; the problem is, I'm trying to substitute on `...' and
> I don't think I can access `...' without inadvertently evaluating it.
>
> I'm trying to write a debugging function which, given any number of
> expressions, prints the expression next to its evaluation.
>
> This is trivial to do in the single arity case:
>
>    debug<- function(expression) {
>      cat(substitute(expression), expression, "\n")
>    }
>
>    a<- 2
>    debug(a)
>
>    a 2
>
> but I'm not sure how to make it work with variable arity without
> resorting to SPECIALSXP.

I suppose you can do a clunky workaround like this:

   debug <- function(e1, e2, sentinel) {
     e1 <- if(!missing(e1)) substitute(e1)
     e2 <- if(!missing(e2)) substitute(e2)
     if (!missing(sentinel)) stop("this function only handles 2 
expressions")
     print(e1)
     print(e2)
}

(but use some finite limit that's more than 2).

Duncan Murdoch


From pcd at roxygen.org  Wed May 25 21:03:22 2011
From: pcd at roxygen.org (Peter Danenberg)
Date: Wed, 25 May 2011 14:03:22 -0500
Subject: [Rd] External special functions (SPECIALSXP)
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D7000442F1FC@NA-PA-VBE03.na.tibco.com>
References: <20110525171038.GA21186@klutometis.wikitex.org>
	<4DDD4022.5060001@gmail.com>
	<20110525180547.GA23242@klutometis.wikitex.org>
	<77EB52C6DD32BA4D87471DCD70C8D7000442F1FC@NA-PA-VBE03.na.tibco.com>
Message-ID: <20110525190322.GB24019@klutometis.wikitex.org>

Quoth William Dunlap on Setting Orange, the 72nd of Discord:
> > f <- function(...) {
> +     dotArgList <- substitute(list(...))
> +     dotArgList
> + }
> > f(cat("foo\n"), stop("Oops"), warning("Hmm"))
> list(cat("foo\n"), stop("Oops"), warning("Hmm"))
> > # i.e., no argument was evaluated

Thanks, William! Something like this works perfectly:

  > debug <- function(...) {
  +   promises <- as.list(substitute(list(...)))[-1]
  +   str(structure(Map(eval, promises),
  +                 names=Map(deparse, promises)))
  + }
  >
  > a <- 2
  > debug(a, a + a)
  List of 2
   $ a    : num 2
   $ a + a: num 4
  >

For some reason, I had tried every permutation of `substitute', `list'
and `...' except that one; coming to the erroneous conclusion that I
couldn't avoid eval-ing `...'.

I may have to screw around with the evaluation environment; but,
otherwise, this is fantastic!


From pcd at roxygen.org  Wed May 25 21:20:22 2011
From: pcd at roxygen.org (Peter Danenberg)
Date: Wed, 25 May 2011 14:20:22 -0500
Subject: [Rd] Curry: proposed new functional programming, er, function.
Message-ID: <20110525192022.GB24281@klutometis.wikitex.org>

Sharpie wrote:
> Currently, the only Curry implementation I know of is in the roxygen
> package which is kind of a weird dependency to install just for this
> one function.

I end up using Curry so much outside of Roxygen that I spun it off
into the `functional' package:

  https://r-forge.r-project.org/projects/functional/

Compose is there, too, and a couple other superfluous things.


From romain at r-enthusiasts.com  Thu May 26 16:40:21 2011
From: romain at r-enthusiasts.com (Romain Francois)
Date: Thu, 26 May 2011 16:40:21 +0200
Subject: [Rd] serialization of external pointers
Message-ID: <4DDE6655.2050209@r-enthusiasts.com>

Hello,

I'm looking for examples of how to handle serialization of external 
pointers.

We use external pointers intensively in Rcpp for modules and one popular 
request is to have persistence. And I guess we need to be able to 
serialize/deserialize external pointers for this.

Also, module objects are all instances of reference classes, so maybe 
that can be handled at the R level ?

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
http://romain-francois.com
|- http://bit.ly/hdKhCy : Rcpp article in JSS
|- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
`- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th


From simon.urbanek at r-project.org  Thu May 26 17:04:22 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 26 May 2011 11:04:22 -0400
Subject: [Rd] serialization of external pointers
In-Reply-To: <4DDE6655.2050209@r-enthusiasts.com>
References: <4DDE6655.2050209@r-enthusiasts.com>
Message-ID: <E7D773D2-EFDF-4149-B230-889932BDC592@r-project.org>


On May 26, 2011, at 10:40 AM, Romain Francois wrote:

> Hello,
> 
> I'm looking for examples of how to handle serialization of external pointers.
> 
> We use external pointers intensively in Rcpp for modules and one popular request is to have persistence. And I guess we need to be able to serialize/deserialize external pointers for this.
> 
> Also, module objects are all instances of reference classes, so maybe that can be handled at the R level ?
> 

Reference classes have nothing to do with EXTPTR - they are simply built around environments and as such have no issues with serialization.

As for EXTPTR, well, you can perform custom serialization (see refhook in serialize() and unserialize()), so to answer your question, yes it's easy to serialize EXPPTRs - you just have to provide functions that convert them to some string representation and back.

So far, so good, but if you were thinking of using save()/save.image()/load() to automatically serialize references in a workspace then the bad new is you can't since there is no way to provide the hooks (that's why rJava caches serialized representation inside the object so that you can restore the pointers on load when you see a NULL pointer with a serialized cache - less ideal solution, but doable).

Cheers,
Simon


From janko.thyson.rstuff at googlemail.com  Thu May 26 17:15:35 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 26 May 2011 17:15:35 +0200
Subject: [Rd] Is it possible to define a function's arguments via a wildcard
 in 'substitute()'?
Message-ID: <4DDE6E97.1040900@googlemail.com>

Dear List,

just out of pure curiosity: is it possible to define a function via 
'substitute()' such that the function's formal arguments are specified 
by a "wildcard" that is substituted when the expression is evaluated?

Simple example:

x.args <- formals("data.frame")
x.body <- expression(
     out <- myArg + 100,
     return(out)
)

expr <- substitute(
     myFoo <- function(
         ARGS,
         myArg
     ){
         print("hello world!")
         print(ARGS)
         eval(BODY)

     },
     list(ARGS=x.args, BODY=x.body)
)

eval(expr)
myFoo(myArg=5)
# works

myFoo(a=1:3, stringsAsFactors=FALSE, myArg=5)
# does not work

It works for wildcard 'BODY' in the function's body, but not for 
wildcard 'ARGS' in the argument definition part of the function definition.

I thought that when writing a function that depends on some other 
function like 'data.frame()', it would maybe be possible not to 
'hardcode' the formal arguments of 'data.frame()' in the new function 
def but to have it mapped somewhat dynamically so that when 
'data.frame()' changes, the new function would change as well. This is 
probably a bad idea for countless reasons, nevertheless I'd be 
interested in learning if it's possible at all ;-)

TIA,
Janko


From romain at r-enthusiasts.com  Thu May 26 17:15:51 2011
From: romain at r-enthusiasts.com (Romain Francois)
Date: Thu, 26 May 2011 17:15:51 +0200
Subject: [Rd] serialization of external pointers
In-Reply-To: <E7D773D2-EFDF-4149-B230-889932BDC592@r-project.org>
References: <4DDE6655.2050209@r-enthusiasts.com>
	<E7D773D2-EFDF-4149-B230-889932BDC592@r-project.org>
Message-ID: <4DDE6EA7.60205@r-enthusiasts.com>

Le 26/05/11 17:04, Simon Urbanek a ?crit :
>
>
> On May 26, 2011, at 10:40 AM, Romain Francois wrote:
>
>> Hello,
>>
>> I'm looking for examples of how to handle serialization of external pointers.
>>
>> We use external pointers intensively in Rcpp for modules and one popular request is to have persistence. And I guess we need to be able to serialize/deserialize external pointers for this.
>>
>> Also, module objects are all instances of reference classes, so maybe that can be handled at the R level ?
>>
>
> Reference classes have nothing to do with EXTPTR - they are simply built around environments and as such have no issues with serialization.

Sure. I understand that.

It just happens that our classes end up encapsulating an external 
pointer, so I figured instead of dealing with this at the xp level, I 
could deal with it higher up.

Sort of looking for a class specific serialization. But the comments in 
serialize.c sounds like a "maybe later" answer to my question.

> As for EXTPTR, well, you can perform custom serialization (see refhook in serialize() and unserialize()), so to answer your question, yes it's easy to serialize EXPPTRs - you just have to provide functions that convert them to some string representation and back.
>
> So far, so good, but if you were thinking of using save()/save.image()/load() to automatically serialize references in a workspace then the bad new is you can't since there is no way to provide the hooks (that's why rJava caches serialized representation inside the object so that you can restore the pointers on load when you see a NULL pointer with a serialized cache - less ideal solution, but doable).

Yes. That's what I'm looking for. I'll check what rJava does. Thanks.

> Cheers,
> Simon


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
http://romain-francois.com
|- http://bit.ly/hdKhCy : Rcpp article in JSS
|- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
`- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th


From hadley at rice.edu  Thu May 26 18:08:40 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 26 May 2011 11:08:40 -0500
Subject: [Rd] Is it possible to define a function's arguments via a
 wildcard in 'substitute()'?
In-Reply-To: <4DDE6E97.1040900@googlemail.com>
References: <4DDE6E97.1040900@googlemail.com>
Message-ID: <BANLkTinTmxc9S6HcDfff+TKF7fz9k3MkRg@mail.gmail.com>

I think for the case where you want to built up a call from a function
name + list of arguments, it's best to use call or as.call:

call("f", a = 1, b = 2, c = 3)

or if you already have the list:
l <- list(as.name("f"), a = 1, b = 2, c = 3)
as.call(l)

Hadley

On Thu, May 26, 2011 at 10:15 AM, Janko Thyson
<janko.thyson.rstuff at googlemail.com> wrote:
> Dear List,
>
> just out of pure curiosity: is it possible to define a function via
> 'substitute()' such that the function's formal arguments are specified by a
> "wildcard" that is substituted when the expression is evaluated?
>
> Simple example:
>
> x.args <- formals("data.frame")
> x.body <- expression(
> ? ?out <- myArg + 100,
> ? ?return(out)
> )
>
> expr <- substitute(
> ? ?myFoo <- function(
> ? ? ? ?ARGS,
> ? ? ? ?myArg
> ? ?){
> ? ? ? ?print("hello world!")
> ? ? ? ?print(ARGS)
> ? ? ? ?eval(BODY)
>
> ? ?},
> ? ?list(ARGS=x.args, BODY=x.body)
> )
>
> eval(expr)
> myFoo(myArg=5)
> # works
>
> myFoo(a=1:3, stringsAsFactors=FALSE, myArg=5)
> # does not work
>
> It works for wildcard 'BODY' in the function's body, but not for wildcard
> 'ARGS' in the argument definition part of the function definition.
>
> I thought that when writing a function that depends on some other function
> like 'data.frame()', it would maybe be possible not to 'hardcode' the formal
> arguments of 'data.frame()' in the new function def but to have it mapped
> somewhat dynamically so that when 'data.frame()' changes, the new function
> would change as well. This is probably a bad idea for countless reasons,
> nevertheless I'd be interested in learning if it's possible at all ;-)
>
> TIA,
> Janko
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From janko.thyson.rstuff at googlemail.com  Thu May 26 19:04:56 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 26 May 2011 19:04:56 +0200
Subject: [Rd] Is it possible to define a function's arguments via a
 wildcard in 'substitute()'?
In-Reply-To: <BANLkTinTmxc9S6HcDfff+TKF7fz9k3MkRg@mail.gmail.com>
References: <4DDE6E97.1040900@googlemail.com>
	<BANLkTinTmxc9S6HcDfff+TKF7fz9k3MkRg@mail.gmail.com>
Message-ID: <4DDE8838.5070107@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110526/38819b27/attachment.pl>

From janko.thyson.rstuff at googlemail.com  Thu May 26 19:12:58 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 26 May 2011 19:12:58 +0200
Subject: [Rd] Reference Classes: getter and setter functions/methods and
 possible shortcuts
Message-ID: <4DDE8A1A.8030105@googlemail.com>

Hi everyone,

just wanted to ask what's the smartest/recommended way of defining 
getter and setter function *shortcuts* (i.e. something like "[", "[<-") 
for Reference Class objects?
Or is it desired to not use this stuff, but define methods like 
'obj$getSubset(row=1:3, col=1)' and 'obj$setSubset(value=x)' instead?

I have some example code that might help in clarifying what I'm exactly 
after:

setRefClass(
     Class="MyDataFrame",
     fields=list(
         PRIMARYDATA="data.frame"
     ),
     methods=list(
         "subsetGet"=function(
             idx.row,
             idx.col,
             drop=if(missing(idx.row)) TRUE else length(PRIMARYDATA) == 1,
             ...
         ){
             PRIMARYDATA[idx.row, idx.col, drop=drop]
         }
     )
)

setMethod(
     f="initialize",
     signature=signature(.Object="MyDataFrame"),
     definition=function(
         .Object,
         ...,
         row.names=NULL,
         check.rows=FALSE,
         check.names=TRUE,
         stringsAsFactors=default.stringsAsFactors()
     ){
         x.primarydata <- data.frame(..., row.names=row.names,
             check.rows=check.rows, check.names=check.names,
             stringsAsFactors=stringsAsFactors)
         x.generator <- getRefClass(class(.Object))
         x.generator$accessors(names(x.generator$fields()))
         .Object$PRIMARYDATA <- x.primarydata
         return(.Object)
     }
)

myDataFrameCreate <- function(
     ...,
     row.names=NULL,
     check.rows=FALSE,
     check.names=TRUE,
     stringsAsFactors=default.stringsAsFactors(),
     .class.name="MyDataFrame"
){
     out <- getRefClass(.class.name)$new(
         ...,
         row.names=row.names, check.rows=check.rows,
         check.names=check.names,
         stringsAsFactors=stringsAsFactors
     )
     return(out)
}

"[.MyDataFrame" <- function(
     src,
     idx.row,
     idx.col,
     drop=if(missing(idx.row)) TRUE else length(src$PRIMARYDATA) == 1,
     ...
){
     if(!inherits(src, "MyDataFrame")){
         stop("Expecting 'src' to be of class 'MyDataFrame")
     }
     return(src$PRIMARYDATA[idx.row, idx.col, drop=drop])
}

mdf <- myDataFrameCreate(a=1:5, b=1:5)
mdf
mdf$PRIMARYDATA
mdf$getPRIMARYDATA() # automaticall set via 
'getRefClass("MyDataFrame")$accessors()'
mdf$subsetGet(1,1)
mdf$subsetGet(1,)
mdf$subsetGet(,1)
mdf$subsetGet(,1,drop=FALSE)

mdf[1,1]
mdf[1,]
mdf[,1]
mdf[,1, drop=FALSE]

Thanks a lot for any advice,
Janko


From janko.thyson.rstuff at googlemail.com  Thu May 26 19:56:30 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Thu, 26 May 2011 19:56:30 +0200
Subject: [Rd] Reference Classes: strange behavior when trying to change
 class def in the same R session
Message-ID: <4DDE944E.8070002@googlemail.com>

Dear list,

I'm getting some strange behavior with Reference Classes every once in a 
while and I can't really put my finger on the cause. It'd be great if 
someone using Reference Classes could check if he/she experiences 
similar problems:

The thing is that when I alter the definition of a Reference Class in a 
running R session and source the respective file containing the class 
def, sometimes the changes are reflected and sometimes not.
I also tried to explicitly remove the class via 'removeClass()', and 
that too works at times and then again it doesn't. If it doesn't work it 
means that I have to shut down the session and start a new one, which is 
quite bothersome. I thought that it maybe had something to do with 
whether an explicit 'initialize' method has been defined or not, but the 
"bug" was still erratic.

Here's some code that you can test it with:

# S4 Classes
setClass(Class="Horst", representation=list(a="numeric"))
horst <- new("Horst", a=5)
horst
removeClass("Horst")
horst <- new("Horst")
setClass(Class="Horst", representation=list(a="character"))
horst <- new("Horst", a="blabla")
horst

# Reference Classes
setRefClass(Class="Horst", fields=list(a="numeric"), methods=list(
         foo=function() print("hello world!")))
setMethod(
     f="initialize",
     signature=signature(.Object="Horst"),
     definition=function(
         .Object
     ){
         return(.Object)
     }
)
gen <- getRefClass("Horst")
horst <- gen$new()
horst$a
horst$a <- 5
horst$a
horst$foo()

removeClass("Horst")

setRefClass(Class="Horst", fields=list(a="character"), methods=list(
         foo=function(x) print(x)))
gen <- getRefClass("Horst")
horst <- gen$new()
horst$a
horst$a <- 5
horst$a
horst$foo(x=5)

Most of the times the change from the first to the second config of ref 
class "Horst" produced a problem and required a 'removeClass()'. 
Strangely, going from the second config back to the first usually works 
without 'removeClass()'.

Thanks in advance for taking the time to play this through,
Janko

R version 2.13.0 (2011-04-13)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C
[5] LC_TIME=German_Germany.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] codetools_0.2-8 tools_2.13.0


From arnima at hafro.is  Thu May 26 22:26:26 2011
From: arnima at hafro.is (Arni Magnusson)
Date: Thu, 26 May 2011 20:26:26 +0000 (UTC)
Subject: [Rd] Statistical mode
Message-ID: <alpine.LFD.2.02.1105261948510.6941@hafstokkur.hafro.is>

One descriptive statistic that is conspicuously missing from core R is the 
statistical mode - the most frequent value in a discrete distribution.

I would like to propose adding the attached 'statmode' (or a similar 
function) to the 'stats' package.

Currently, it can be quite cumbersome to calculate the mode of a 
distribution in R, both for experts and beginners. The lack of a function 
to do this is felt, both when teaching introductory R courses, and when 
using sapply() or the like.

Looking forward to your feedback,

Arni
-------------- next part --------------
statmode <- function(x, all=FALSE, ...)
{
  if(is.list(x))
  {
    output <- sapply(x, statmode, all=all, ...)
  }
  else
  {
    freq <- table(x, ...)
    if(all)
      output <- names(freq)[freq==max(freq)]
    else
      output <- names(freq)[which.max(freq)]
    ## Coerce to original data type, using any() to handle mts, xtabs, etc.
    if(any(class(x) %in% c("integer","numeric","ts","complex","matrix","table")))
      output <- as(output, storage.mode(x))
  }
  return(output)
}
-------------- next part --------------
\name{statmode}
\alias{statmode}
\title{Statistical Mode}
\description{
  Compute the statistical mode, the most frequent value in a discrete
  distribution.
}
\usage{
statmode(x, all = FALSE, \dots)
}
\arguments{
  \item{x}{an \R object, usually vector, matrix, or data frame.}
  \item{all}{whether all statistical modes should be returned.}
  \item{\dots}{further arguments passed to the \code{\link{table}}
    function.}
}
\details{The default is to return only the first statistical mode.}
\value{
  The most frequent value in \code{x}, possibly a vector or list,
  depending on the class of \code{x} and whether \code{all=TRUE}.
}
\seealso{
  \code{\link{mean}}, \code{\link{median}}, \code{\link{table}}.

  \code{\link{density}} can be used to compute the statistical mode of a
  continuous distribution.
}
\examples{
## Different location statistics
fw <- faithful$waiting
hist(fw)
barplot(table(fw))
mean(fw)
median(fw)
statmode(fw)
plot(density(fw))
with(density(fw), x[which.max(y)])

## Different classes
statmode(chickwts$feed)  # factor
statmode(volcano)        # matrix
statmode(discoveries)    # ts
statmode(mtcars)         # data frame

## Multiple modes
table(mtcars$carb)
statmode(mtcars$carb)
statmode(mtcars$carb, TRUE)
statmode(mtcars, TRUE)
}
\keyword{univar}

From sean.mcguffee at gmail.com  Fri May 27 00:44:05 2011
From: sean.mcguffee at gmail.com (Sean Robert McGuffee)
Date: Thu, 26 May 2011 18:44:05 -0400
Subject: [Rd] Calling Rscript from Makevars
In-Reply-To: <54EFBBFE-EC4F-4B26-8C2E-2E31FBB71F51@r-project.org>
Message-ID: <CA044FF5.441D%sean.mcguffee@gmail.com>

Thanks for the help!

On 5/23/11 8:58 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:

> Sean,
> 
> On May 23, 2011, at 2:03 PM, Sean Robert McGuffee wrote:
> 
>> 
>> On 5/23/11 1:30 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
>> 
>>> 
>>> On May 23, 2011, at 12:56 PM, Sean Robert McGuffee wrote:
>>> 
>>>> I'm not sure what you mean by, "any tests you run in configure will ignore
>>>> it
>>>> since autoconf only uses LIBS and not PKG_LIBS." I though autoconf used any
>>>> variable names you tell it to, so that it would use PKG_LIBS if you tell it
>>>> to. 
>>>> 
>>> 
>>> No, many variables have a special meanings in autoconf, such as CC, CPP,
>>> CFLAGS, LIBS, LDFLAGS etc. When you run tests like AC_PROG*, AC_HEADER*,
>>> AC_CHECK_*, AC_COMPILE*, AC_LINK* then those use (and set) only the
>>> variables
>>> supported by configure and they have no idea about things like PKG_LIBS. So
>>> as
>>> far as autoconf is concerned PKG_LIBS has no effect.
>> 
>> I'm not familiar with all of the AC_* commands, but I'm pretty sure that
>> AC_SUBST(PKG_LIBS) will properly set the variable PKG_LIBS or any variable
>> you like. You can run tests to set it how you like before you run AC_SUBST
>> too. For example,
>> if test [ -n "$lmmin_include_path" ] ; then
>>   LMMIN_INCLUDE_CXXFLAGS="-I${lmmin_include_path}"
>> else
>>   if test [ -n "${LMMIN_INCLUDE}" ] ; then
>>      LMMIN_INCLUDE_CXXFLAGS="-I${LMMIN_INCLUDE}"
>>   else
>>      LMMIN_INCLUDE_CXXFLAGS="-I/default
>>   fi
>> fi
>> AC_SUBST(LMMIN_INCLUDE_CXXFLAGS)
>> 
> 
> Yes, but the above don't actually test anything - it just performs a shell
> substitution, you still have no idea if that actually works. The point of
> autoconf is to provide tests of functionality - that's what all the tests I
> mentioned are about. If you just wanted to replace a variable, you can use sed
> and skip all autoconf ;) - or in fact you can simply use Makevars since that
> gives you all shell functionality and you don't sacrifice the ability to
> support multiple architectures (see my previous comment why configure should
> be only used if absolutely necessary as it impedes the package build process).

Good point--And now that I understand that Makevars is going to be included
in a Makefile that R will generate, that makes perfect sense.

> 
> 
>>> Because R has its own building process, using autoconf with packages means
>>> you
>>> have to a) set autoconf's flags to match the R configuration before you do
>>> anything, b) use autoconf tests which implies using autoconf's flags, c) map
>>> resulting autoconf flags to special R package flags. If you skip any of
>>> a,b,c
>>> the result will not be reliable. In theory, you can handle R's flags and
>>> autoconf flags in parallel, i.e., updating both in the success branch of
>>> each
>>> test, but that's a bit too tedious to implement (you can't use the autoconf
>>> default actions) and unnecessary.
>>> 
>>> 
>>>> Also, I'm still not clear as to what a Makevars file is. To clarify, I do
>>>> understand a Makefile. When GNU's make program is run, it looks for a
>>>> Makefile and interprets it in ways that are documented very well by GNU. I
>>>> have yet to find any lead as to what a Makevars file is, what to put in it,
>>>> what it does, or how it helps in installation with R packages. I can
>>>> understand how to define variables in it, but the only way I know how to
>>>> use
>>>> variables that are defined is by using them in a Makefile. Where and how
>>>> are
>>>> variables defined in Makevars used?
>>>> 
>>> 
>>> Makevars is simply a file included in R's Makefile when it is building the
>>> package. 
>> 
>> I think this if *EXTREMEMLY* useful information and should be appended to
>> the beginning of "Writing R Extensions: 1.2.1 Using Makevars." Thank you so
>> much for sharing this crucial piece of information. Now it all makes sense.
>> 
> 
> From R-admin: http://r.research.att.com/man/R-exts.html#Using-Makevars
> 
> "There are some macros which are set whilst configuring the building of R
> itself and are stored in R_HOME/etcR_ARCH/Makeconf. That makefile is included
> as a Makefile afterMakevars[.win], and the macros it defines can be used in
> macro assignments and make command lines in the latter."
> 
> (this attempts makes clear that Makevars is a makefile included before
> Makeconf)

Notice how the word "Makevars" is not in that quote... It tends to be
difficult to clarify something about Makevars without using the word
Makevars.

> 
> and
> 
> "Note that Makevars should not normally contain targets, as it is included
> before the default makefile and make will call the first target, intended to
> be all in the default makefile. If you really need to circumvent that, use a
> suitable (phony) target all before any actual targets in Makevars.[win]:"
> 
> (this attempts to make clear that you can define targets in Makevars even if
> it's not customary)

This makes sense now knowing that Makevars gets included in a Makefile that
R generates.

> 
> Cheers,
> Simon
> 
> 
>>> So, technically, it is a makefile. The difference between Makevars
>>> and Makefile is that Makevars doesn't need to specify any rules or variables
>>> that R already knows about, because they are already included by R. So it is
>>> much more convenient since it saves you a lot of trouble trying to setup the
>>> correct rules for compilation, linking etc. At the same time, it is a
>>> makefile
>>> so you can add targets, modify dependencies etc., you're not constrained to
>>> just setting variables although that is its primary use.
>>> 
>>> In practice Makevars can be used in several ways:
>>> 
>>> a) just set PKG_CFLAGS, PKG_LIBS
>>> this is the most common use and it leaves the standard targets in place so R
>>> will use those to compile $(SHLIB) automatically
>>> 
>>> b) include additional targets:
>>> if you have additional features to build, you can specify them in a target,
>>> for example this is form rJava:
>>> 
>>> all: $(SHLIB) @WANT_JRI_TRUE@ jri
>>> jri: ... 
>>> 
>>> It builds the standard $(SHLIB) which is loaded by the package, but it also
>>> builds a separate target "jri" if enabled in configure
>>> 
>>> c) include dependencies:
>>> you can add dependent builds that are needed for your $(SHLIB), for example
>>> from RSQLite:
>>> 
>>> all: $(SHLIB)
>>> $(SHLIB): do_includes
>>> do_includes:
>>> 
>>> This makes sure that do_includes is built before R attempts to build the
>>> .so/.dll
>>> 
>>> 
>>> So, as you can see you Makevars gives you the flexibility of Makefile but
>>> without the hassle.
>>> 
>>> Cheers,
>>> Simon
>>> 
>> 
>> 
>> 
>


From janko.thyson.rstuff at googlemail.com  Fri May 27 15:13:29 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Fri, 27 May 2011 15:13:29 +0200
Subject: [Rd] Reference Classes/S4 Classes: can method dispatch check
 superclasses BEFORE resorting to method for "ANY"?
Message-ID: <4DDFA379.10904@googlemail.com>

Dear list,

is it possible that method dispatch checks for superclasses/virtual 
classes before checking "ANY"?

I'd like to build a generic initialization method for all my Reference 
Class (say "MyDataFrame") objects by having them inherit from class, say 
"MyRefClassVirtual" (which would have to be a virtual S4 class; there 
are no virtual Reference Classes, are there?)

The problem is that 'getRefClass("MyDataFrame")$new' calls (I think) the 
method that was written for "ANY". Thus even though I write a explicit 
initialize method for class "MyRefClassVirtual" which I should be called 
for "MyDataFrame" as it inherits from this class, this method will never 
be called because "ANY beats anything else".

So, I think I'd like to tell the method somehow to check for 
superclass/virtual classes *before* resorting to "ANY".

Is that possible?

Regards,
Janko


From mtmorgan at fhcrc.org  Fri May 27 15:22:35 2011
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 27 May 2011 06:22:35 -0700
Subject: [Rd] Reference Classes/S4 Classes: can method dispatch check
 superclasses BEFORE resorting to method for "ANY"?
In-Reply-To: <4DDFA379.10904@googlemail.com>
References: <4DDFA379.10904@googlemail.com>
Message-ID: <4DDFA59B.9090807@fhcrc.org>

On 05/27/2011 06:13 AM, Janko Thyson wrote:
> Dear list,
>
> is it possible that method dispatch checks for superclasses/virtual
> classes before checking "ANY"?
>
> I'd like to build a generic initialization method for all my Reference
> Class (say "MyDataFrame") objects by having them inherit from class, say
> "MyRefClassVirtual" (which would have to be a virtual S4 class; there
> are no virtual Reference Classes, are there?)

Reference classes can be virtual; 'initialize' is a reference method, 
not an S4 method.

.A <- setRefClass("A", contains="VIRTUAL",
     methods=list(
       initialize=function(..., msg="initialize,AA") {
           callSuper(...)
           message(msg)
           .self
       }))
.AA <- setRefClass("AA", contains="A")

 > .A$new()
Error in methods::new(def, ...) :
   trying to generate an object from a virtual class ("A")
 > .AA$new()
initialize,AA
An object of class "AA"
<environment: 0x1b82f48>

Martin

> The problem is that 'getRefClass("MyDataFrame")$new' calls (I think) the
> method that was written for "ANY". Thus even though I write a explicit
> initialize method for class "MyRefClassVirtual" which I should be called
> for "MyDataFrame" as it inherits from this class, this method will never
> be called because "ANY beats anything else".
>
> So, I think I'd like to tell the method somehow to check for
> superclass/virtual classes *before* resorting to "ANY".
>
> Is that possible?
>
> Regards,
> Janko
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From janko.thyson.rstuff at googlemail.com  Fri May 27 15:42:02 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Fri, 27 May 2011 15:42:02 +0200
Subject: [Rd] Reference Classes/S4 Classes: can method dispatch check
 superclasses BEFORE resorting to method for "ANY"?
In-Reply-To: <4DDFA59B.9090807@fhcrc.org>
References: <4DDFA379.10904@googlemail.com> <4DDFA59B.9090807@fhcrc.org>
Message-ID: <4DDFAA2A.6080408@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110527/916a2f31/attachment.pl>

From kw.stat at gmail.com  Fri May 27 15:56:52 2011
From: kw.stat at gmail.com (Kevin Wright)
Date: Fri, 27 May 2011 08:56:52 -0500
Subject: [Rd] Statistical mode
In-Reply-To: <alpine.LFD.2.02.1105261948510.6941@hafstokkur.hafro.is>
References: <alpine.LFD.2.02.1105261948510.6941@hafstokkur.hafro.is>
Message-ID: <BANLkTi=soFxamk5TdwN=8Kbykog5id534g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110527/3723b46a/attachment.pl>

From murdoch.duncan at gmail.com  Fri May 27 17:33:18 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 27 May 2011 11:33:18 -0400
Subject: [Rd] [R] NaN, Inf to NA
In-Reply-To: <19935.48920.703526.489158@stat.math.ethz.ch>
References: <902176.39554.qm@web110703.mail.gq1.yahoo.com>	<2514ACD4-6654-45F1-A71F-1528DF05919E@me.com>	<77EB52C6DD32BA4D87471DCD70C8D7000442F527@NA-PA-VBE03.na.tibco.com>	<868607.63263.qm@web110716.mail.gq1.yahoo.com>	<4DDF97B2.6070601@gmail.com>
	<19935.48920.703526.489158@stat.math.ethz.ch>
Message-ID: <4DDFC43E.9070609@gmail.com>

On 27/05/2011 11:11 AM, Martin Maechler wrote:
> >>>>>  Duncan Murdoch<murdoch.duncan at gmail.com>
> >>>>>      on Fri, 27 May 2011 08:23:14 -0400 writes:
>
>      >  On 11-05-27 4:27 AM, Albert-Jan Roskam wrote:
>      >>  Aha! Thank you very much for that clarification! It would
>      >>  be much more user friendly if R generated a
>      >>  NotImplementedError or something similar. The 'garbage
>      >>  results' are pretty misleading, esp. to a novice.
>
>      >  I think that's a good idea.  The default methods are
>      >  documented to work on atomic vectors; dataframes are not
>      >  atomic vectors, so it would be reasonable to generate an
>      >  error.  (See ?is.atomic for a definition of atomic
>      >  vectors.)
>
>      >  I'll see if this causes a lot of trouble...
>
>      >  Duncan Murdoch
>
> Duncan,
> do you remember the issue of mean(), var(), median(),... etc
> that was the topic a few weeks ago ?
>
> I strongly advocated that  mean.data.frame() should become
> *deprecated*, and I would propose the same for the functions
> mentioned here.

I think you may have misunderstood my proposal.  Currently is.nan, 
is.finite and is.infinite have no data.frame methods, so the default 
method is used.  The problem is that the default method is too 
permissive:  it operates on the data.frame by treating it as a list; 
then it returns FALSE for each list element.  (If there is only one row, 
it applies the test to the singleton in the column.)   This is pretty 
strange default behaviour.

What I'm proposing is that the default method should trigger an error if 
you try to send it anything that's not atomic.  This gives sensible 
behaviour in most cases; the only one where it doesn't work is a list of 
singletons, which used to be handled sensibly, but will now fail.

(There's still a question about what the answer should be for these 
functions when applied to character or raw vectors, which are both 
atomic.  I'm leaning towards returning FALSE for every element, which 
matches the current behaviour, but perhaps those should also generate an 
error.)

I think this partially addresses Bill's objection, but not completely.  
Someone could still put a class on an atomic vector, and that might not 
be handled properly by the default method.

> People should  *apply (or *ply) on data frames, and not expect
> that all kind of functions have data.frame methods
> which are simply equivalent to basically  sapply(<df>,<function>)
>
> {and yes -- all this belongs to R-devel rather than R-help}

Where I've moved it now.

Duncan Murdoch
> Martin
>
>      >>  I wanted to recode every NaN and Inf value of an entire
>      >>  data.frame to NA. The data.frame also includes character
>      >>  variables. So the following might work (?)  (Can't test
>      >>  it here)
>      >>
>      >>  ditch<- function(x) ifelse(is.infinite(x) | is.nan(x),
>      >>  NA, x) df<- apply(df, 2, ditch)
>      >>
>      >>
>      >>
>      >>
>      >>
>      >>  ________________________________ From: William
>      >>  Dunlap<wdunlap at tibco.com>
>      >>
>      >>  Cc: R Mailing List<r-help at r-project.org>  Sent: Fri, May
>      >>  27, 2011 12:57:01 AM Subject: RE: [R] NaN, Inf to NA
>      >>
>      >>  I think the source of the OP's problem is that while
>      >>  things like df>30 and is.na(df) return a logical matrix
>      >>  with the dimensions of the data.frame df, both
>      >>  is.infinite(df) and is.nan(df) return a logical vector as
>      >>  long as the number of columns of df.  (`>` and is.na have
>      >>  data.frame methods but is.infinite and is.nan do not: the
>      >>  latter give garbage results for data.frames.)
>      >>
>      >>  Bill Dunlap Spotfire, TIBCO Software wdunlap tibco.com
>      >>
>      >>>  -----Original Message----- From:
>      >>>  r-help-bounces at r-project.org
>      >>>  [mailto:r-help-bounces at r-project.org] On Behalf Of Marc
>      >>>  Schwartz Sent: Thursday, May 26, 2011 2:15 PM To:
>      >>>  Albert-Jan Roskam Cc: R Mailing List Subject: Re: [R]
>      >>>  NaN, Inf to NA
>      >>>
>      >>>  On May 26, 2011, at 3:18 PM, Albert-Jan Roskam wrote:
>      >>>
>      >>>>  Hi,
>      >>>>
>      >>>>  I want to recode all Inf and NaN values to NA, but I;m
>      >>>  surprised to see the
>      >>>>  result of the following code. Could anybody enlighten
>      >>>>  me
>      >>>  about this?
>      >>>>
>      >>>>>  df<- data.frame(a=c(NA, NaN, Inf, 1:3))
>      >>>>>  df[is.infinite(df) | is.nan(df)]<- NA df
>      >>>>  a 1 NA 2 NaN 3 Inf 4 1 5 2 6 3
>      >>>>>
>      >>>>
> >>>
> >>>  Thanks!
>      >>>>
>      >>>>  Cheers!!  Albert-Jan
>      >>>
>      >>>
>      >>>  The canonical way is to use is.na() to assign the NA
>      >>>  value based upon a condition. See ?is.na for more
>      >>>  information.
>      >>>
>      >>>  is.na(df$a)<- !is.finite(df$a)
>      >>>
>      >>>>  df
>      >>>  a 1 NA 2 NA 3 NA 4 1 5 2 6 3
>      >>>
>      >>>
>      >>>  HTH,
>      >>>
>      >>>  Marc Schwartz
>      >>>
>      >>>  ______________________________________________
>      >>>  R-help at r-project.org mailing list
>      >>>  https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
>      >>>  read the posting guide
>      >>>  http://www.R-project.org/posting-guide.html and provide
>      >>>  commented, minimal, self-contained, reproducible code.
>      >>>
>      >>
> >  [[alternative HTML version deleted]]
>      >>
>      >>  ______________________________________________
>      >>  R-help at r-project.org mailing list
>      >>  https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
>      >>  read the posting guide
>      >>  http://www.R-project.org/posting-guide.html and provide
>      >>  commented, minimal, self-contained, reproducible code.
>
>      >  ______________________________________________
>      >  R-help at r-project.org mailing list
>      >  https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
>      >  read the posting guide
>      >  http://www.R-project.org/posting-guide.html and provide
>      >  commented, minimal, self-contained, reproducible code.


From arnima at hafro.is  Fri May 27 17:50:18 2011
From: arnima at hafro.is (Arni Magnusson)
Date: Fri, 27 May 2011 15:50:18 +0000 (GMT)
Subject: [Rd] Statistical mode
In-Reply-To: <BANLkTi=soFxamk5TdwN=8Kbykog5id534g@mail.gmail.com>
References: <alpine.LFD.2.02.1105261948510.6941@hafstokkur.hafro.is>
	<BANLkTi=soFxamk5TdwN=8Kbykog5id534g@mail.gmail.com>
Message-ID: <alpine.LFD.2.02.1105271506510.11754@hafstokkur.hafro.is>

Thank you, Kevin, for the feedback.

> 1. The mode is not so interesting for continuous data. I would much 
> rather use something like density().

Absolutely. The help page for statmode() says it is for discrete data, and 
points to density() for continuous data.


> 2. Both the iris and barley data sets are balanced (each factor level 
> appears equally often), and the current output from the statmode 
> function is misleading by only showing one level.

Try statmode(iris,TRUE). It points out that petal lengths 1.4 and 1.5 are 
equally common in the data. I decided to make all=FALSE the default 
behavior, but I'd be equally happy with all=TRUE as the default.

As for the barley data, statmode(barley,TRUE) is just the honest answer. 
The yield is continuous, so the discrete mode is not of interest, and the 
factors levels are all equally common as you point out.


> 3. I think the describe() function in the Hmisc package is much more 
> useful and informative, even for introductory stat classes.  I always 
> use describe() after importing data into R.

The describe() function is a verbose summary, usually of a data frame. The 
statmode() function is the discrete mode, usually of a vector. 
Importantly, describe(faithful$waiting) points out the mean, median and 
range, but not the mode.

---

Allow me to include two more valid comments, from Sarah Goslee and David 
Winsemius, respectively:


> 4. The 'modeest' package does this and more, see for example mfv().

I think core R should come with a basic function to get the mode of a 
discrete vector. One option would be to lift mfv() into the 'stats' 
package, but something like statmode() could also cover factors and 
strings. Might as well provide all=TRUE/FALSE functionality, too, and 
retain integers as integers.

It's common to find rudimentary basic functionality in the 'stats' 
package, and dedicated packages for more details; time series models and 
robust statistics come to mind. The 'modeest' package is impressive 
indeed.


> 5. Isn't this just table(Vec)[which.max(table(Vec))]?

Yes it is, only less cumbersome. Much like sd(Vec) is less cumbersome than 
sqrt(var(Vec)). Moreover, I find it confusing to see the count as well,

   table(volcano)[which.max(table(volcano))]
   # 110
   # 177

although this can be debated. Finally, I think the examples

   statmode(mtcars)
   statmode(mtcars, TRUE)

demonstrate practical functionality beyond 
table(Vec)[which.max(table(Vec))].

The mean, median, and mode are often mentioned together as fundamental 
descriptive statistics, and I just find it odd that statmode() is not 
already in core R. Sure, we could get by without the sd() function in core 
R, but why should we?

All the best,

Arni


From marc_schwartz at me.com  Fri May 27 17:52:38 2011
From: marc_schwartz at me.com (Marc Schwartz)
Date: Fri, 27 May 2011 10:52:38 -0500
Subject: [Rd] [R] NaN, Inf to NA
In-Reply-To: <4DDFC43E.9070609@gmail.com>
References: <902176.39554.qm@web110703.mail.gq1.yahoo.com>
	<2514ACD4-6654-45F1-A71F-1528DF05919E@me.com>
	<77EB52C6DD32BA4D87471DCD70C8D7000442F527@NA-PA-VBE03.na.tibco.com>
	<868607.63263.qm@web110716.mail.gq1.yahoo.com>
	<4DDF97B2.6070601@gmail.com>
	<19935.48920.703526.489158@stat.math.ethz.ch>
	<4DDFC43E.9070609@gmail.com>
Message-ID: <29F48FEA-CC98-4E2D-9574-FC0F5F8C516A@me.com>


On May 27, 2011, at 10:33 AM, Duncan Murdoch wrote:

> On 27/05/2011 11:11 AM, Martin Maechler wrote:
>> >>>>>  Duncan Murdoch<murdoch.duncan at gmail.com>
>> >>>>>      on Fri, 27 May 2011 08:23:14 -0400 writes:
>> 
>>     >  On 11-05-27 4:27 AM, Albert-Jan Roskam wrote:
>>     >>  Aha! Thank you very much for that clarification! It would
>>     >>  be much more user friendly if R generated a
>>     >>  NotImplementedError or something similar. The 'garbage
>>     >>  results' are pretty misleading, esp. to a novice.
>> 
>>     >  I think that's a good idea.  The default methods are
>>     >  documented to work on atomic vectors; dataframes are not
>>     >  atomic vectors, so it would be reasonable to generate an
>>     >  error.  (See ?is.atomic for a definition of atomic
>>     >  vectors.)
>> 
>>     >  I'll see if this causes a lot of trouble...
>> 
>>     >  Duncan Murdoch
>> 
>> Duncan,
>> do you remember the issue of mean(), var(), median(),... etc
>> that was the topic a few weeks ago ?
>> 
>> I strongly advocated that  mean.data.frame() should become
>> *deprecated*, and I would propose the same for the functions
>> mentioned here.
> 
> I think you may have misunderstood my proposal.  Currently is.nan, is.finite and is.infinite have no data.frame methods, so the default method is used.  The problem is that the default method is too permissive:  it operates on the data.frame by treating it as a list; then it returns FALSE for each list element.  (If there is only one row, it applies the test to the singleton in the column.)   This is pretty strange default behaviour.
> 
> What I'm proposing is that the default method should trigger an error if you try to send it anything that's not atomic.  This gives sensible behaviour in most cases; the only one where it doesn't work is a list of singletons, which used to be handled sensibly, but will now fail.
> 
> (There's still a question about what the answer should be for these functions when applied to character or raw vectors, which are both atomic.  I'm leaning towards returning FALSE for every element, which matches the current behaviour, but perhaps those should also generate an error.)
> 
> I think this partially addresses Bill's objection, but not completely.  Someone could still put a class on an atomic vector, and that might not be handled properly by the default method.
> 
>> People should  *apply (or *ply) on data frames, and not expect
>> that all kind of functions have data.frame methods
>> which are simply equivalent to basically  sapply(<df>,<function>)
>> 
>> {and yes -- all this belongs to R-devel rather than R-help}
> 
> Where I've moved it now.
> 
> Duncan Murdoch
>> Martin


I snipped some of the older content and added Bill.

It seems to me that unless the 'x' argument is both atomic and numeric, these functions really don't have much utility, if you are going to implement standard default behavior and more rigorous error checking. 

So I would support adding an error message if both conditions are not passed, rather than an unpredictable result, which an unsuspecting useR might not catch.

I agree that the non-default methods should be deprecated.

Regards,

Marc


From ripley at stats.ox.ac.uk  Fri May 27 17:53:08 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 27 May 2011 16:53:08 +0100 (BST)
Subject: [Rd] [R] NaN, Inf to NA
In-Reply-To: <4DDFC43E.9070609@gmail.com>
References: <902176.39554.qm@web110703.mail.gq1.yahoo.com>
	<2514ACD4-6654-45F1-A71F-1528DF05919E@me.com>
	<77EB52C6DD32BA4D87471DCD70C8D7000442F527@NA-PA-VBE03.na.tibco.com>
	<868607.63263.qm@web110716.mail.gq1.yahoo.com>
	<4DDF97B2.6070601@gmail.com>
	<19935.48920.703526.489158@stat.math.ethz.ch>
	<4DDFC43E.9070609@gmail.com>
Message-ID: <alpine.LFD.2.02.1105271646130.31259@gannet.stats.ox.ac.uk>

On Fri, 27 May 2011, Duncan Murdoch wrote:

> On 27/05/2011 11:11 AM, Martin Maechler wrote:
>> >>>>>  Duncan Murdoch<murdoch.duncan at gmail.com>
>> >>>>>      on Fri, 27 May 2011 08:23:14 -0400 writes:
>>
>>      >  On 11-05-27 4:27 AM, Albert-Jan Roskam wrote:
>>      >>  Aha! Thank you very much for that clarification! It would
>>      >>  be much more user friendly if R generated a
>>      >>  NotImplementedError or something similar. The 'garbage
>>      >>  results' are pretty misleading, esp. to a novice.
>>
>>      >  I think that's a good idea.  The default methods are
>>      >  documented to work on atomic vectors; dataframes are not
>>      >  atomic vectors, so it would be reasonable to generate an
>>      >  error.  (See ?is.atomic for a definition of atomic
>>      >  vectors.)
>>
>>      >  I'll see if this causes a lot of trouble...
>>
>>      >  Duncan Murdoch
>> 
>> Duncan,
>> do you remember the issue of mean(), var(), median(),... etc
>> that was the topic a few weeks ago ?
>> 
>> I strongly advocated that  mean.data.frame() should become
>> *deprecated*, and I would propose the same for the functions
>> mentioned here.
>
> I think you may have misunderstood my proposal.  Currently is.nan, is.finite 
> and is.infinite have no data.frame methods, so the default method is used. 
> The problem is that the default method is too permissive:  it operates on the 
> data.frame by treating it as a list; then it returns FALSE for each list 
> element.  (If there is only one row, it applies the test to the singleton in 
> the column.)   This is pretty strange default behaviour.
>
> What I'm proposing is that the default method should trigger an error if you 
> try to send it anything that's not atomic.  This gives sensible behaviour in 
> most cases; the only one where it doesn't work is a list of singletons, which 
> used to be handled sensibly, but will now fail.
>
> (There's still a question about what the answer should be for these functions 
> when applied to character or raw vectors, which are both atomic.  I'm leaning 
> towards returning FALSE for every element, which matches the current 
> behaviour, but perhaps those should also generate an error.)

I noticed you did not mention integer vectors.  Those are no 
different from character or raw: there are no NaN (nor infinite) 
integer elements.  I don't see it should be an error to ask in those 
cases.

>
> I think this partially addresses Bill's objection, but not completely. 
> Someone could still put a class on an atomic vector, and that might not be 
> handled properly by the default method.
>
>> People should  *apply (or *ply) on data frames, and not expect
>> that all kind of functions have data.frame methods
>> which are simply equivalent to basically  sapply(<df>,<function>)
>> 
>> {and yes -- all this belongs to R-devel rather than R-help}
>
> Where I've moved it now.
>
> Duncan Murdoch
>> Martin
>>
>>      >>  I wanted to recode every NaN and Inf value of an entire
>>      >>  data.frame to NA. The data.frame also includes character
>>      >>  variables. So the following might work (?)  (Can't test
>>      >>  it here)
>>      >>
>>      >>  ditch<- function(x) ifelse(is.infinite(x) | is.nan(x),
>>      >>  NA, x) df<- apply(df, 2, ditch)
>>      >>
>>      >>
>>      >>
>>      >>
>>      >>
>>      >>  ________________________________ From: William
>>      >>  Dunlap<wdunlap at tibco.com>
>>      >>
>>      >>  Cc: R Mailing List<r-help at r-project.org>  Sent: Fri, May
>>      >>  27, 2011 12:57:01 AM Subject: RE: [R] NaN, Inf to NA
>>      >>
>>      >>  I think the source of the OP's problem is that while
>>      >>  things like df>30 and is.na(df) return a logical matrix
>>      >>  with the dimensions of the data.frame df, both
>>      >>  is.infinite(df) and is.nan(df) return a logical vector as
>>      >>  long as the number of columns of df.  (`>` and is.na have
>>      >>  data.frame methods but is.infinite and is.nan do not: the
>>      >>  latter give garbage results for data.frames.)
>>      >>
>>      >>  Bill Dunlap Spotfire, TIBCO Software wdunlap tibco.com
>>      >>
>>      >>>  -----Original Message----- From:
>>      >>>  r-help-bounces at r-project.org
>>      >>>  [mailto:r-help-bounces at r-project.org] On Behalf Of Marc
>>      >>>  Schwartz Sent: Thursday, May 26, 2011 2:15 PM To:
>>      >>>  Albert-Jan Roskam Cc: R Mailing List Subject: Re: [R]
>>      >>>  NaN, Inf to NA
>>      >>>
>>      >>>  On May 26, 2011, at 3:18 PM, Albert-Jan Roskam wrote:
>>      >>>
>>      >>>>  Hi,
>>      >>>>
>>      >>>>  I want to recode all Inf and NaN values to NA, but I;m
>>      >>>  surprised to see the
>>      >>>>  result of the following code. Could anybody enlighten
>>      >>>>  me
>>      >>>  about this?
>>      >>>>
>>      >>>>>  df<- data.frame(a=c(NA, NaN, Inf, 1:3))
>>      >>>>>  df[is.infinite(df) | is.nan(df)]<- NA df
>>      >>>>  a 1 NA 2 NaN 3 Inf 4 1 5 2 6 3
>>      >>>>>
>>      >>>>
>> >>>
>> >>>  Thanks!
>>      >>>>
>>      >>>>  Cheers!!  Albert-Jan
>>      >>>
>>      >>>
>>      >>>  The canonical way is to use is.na() to assign the NA
>>      >>>  value based upon a condition. See ?is.na for more
>>      >>>  information.
>>      >>>
>>      >>>  is.na(df$a)<- !is.finite(df$a)
>>      >>>
>>      >>>>  df
>>      >>>  a 1 NA 2 NA 3 NA 4 1 5 2 6 3
>>      >>>
>>      >>>
>>      >>>  HTH,
>>      >>>
>>      >>>  Marc Schwartz
>>      >>>
>>      >>>  ______________________________________________
>>      >>>  R-help at r-project.org mailing list
>>      >>>  https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
>>      >>>  read the posting guide
>>      >>>  http://www.R-project.org/posting-guide.html and provide
>>      >>>  commented, minimal, self-contained, reproducible code.
>>      >>>
>>      >>
>> >  [[alternative HTML version deleted]]
>>      >>
>>      >>  ______________________________________________
>>      >>  R-help at r-project.org mailing list
>>      >>  https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
>>      >>  read the posting guide
>>      >>  http://www.R-project.org/posting-guide.html and provide
>>      >>  commented, minimal, self-contained, reproducible code.
>>
>>      >  ______________________________________________
>>      >  R-help at r-project.org mailing list
>>      >  https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
>>      >  read the posting guide
>>      >  http://www.R-project.org/posting-guide.html and provide
>>      >  commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch.duncan at gmail.com  Fri May 27 18:37:22 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 27 May 2011 12:37:22 -0400
Subject: [Rd] [R] NaN, Inf to NA
In-Reply-To: <alpine.LFD.2.02.1105271646130.31259@gannet.stats.ox.ac.uk>
References: <902176.39554.qm@web110703.mail.gq1.yahoo.com>
	<2514ACD4-6654-45F1-A71F-1528DF05919E@me.com>
	<77EB52C6DD32BA4D87471DCD70C8D7000442F527@NA-PA-VBE03.na.tibco.com>
	<868607.63263.qm@web110716.mail.gq1.yahoo.com>
	<4DDF97B2.6070601@gmail.com>
	<19935.48920.703526.489158@stat.math.ethz.ch>
	<4DDFC43E.9070609@gmail.com>
	<alpine.LFD.2.02.1105271646130.31259@gannet.stats.ox.ac.uk>
Message-ID: <4DDFD342.7060205@gmail.com>

On 27/05/2011 11:53 AM, Prof Brian Ripley wrote:
> On Fri, 27 May 2011, Duncan Murdoch wrote:
>
> >  On 27/05/2011 11:11 AM, Martin Maechler wrote:
> >>  >>>>>   Duncan Murdoch<murdoch.duncan at gmail.com>
> >>  >>>>>       on Fri, 27 May 2011 08:23:14 -0400 writes:
> >>
> >>       >   On 11-05-27 4:27 AM, Albert-Jan Roskam wrote:
> >>       >>   Aha! Thank you very much for that clarification! It would
> >>       >>   be much more user friendly if R generated a
> >>       >>   NotImplementedError or something similar. The 'garbage
> >>       >>   results' are pretty misleading, esp. to a novice.
> >>
> >>       >   I think that's a good idea.  The default methods are
> >>       >   documented to work on atomic vectors; dataframes are not
> >>       >   atomic vectors, so it would be reasonable to generate an
> >>       >   error.  (See ?is.atomic for a definition of atomic
> >>       >   vectors.)
> >>
> >>       >   I'll see if this causes a lot of trouble...
> >>
> >>       >   Duncan Murdoch
> >>
> >>  Duncan,
> >>  do you remember the issue of mean(), var(), median(),... etc
> >>  that was the topic a few weeks ago ?
> >>
> >>  I strongly advocated that  mean.data.frame() should become
> >>  *deprecated*, and I would propose the same for the functions
> >>  mentioned here.
> >
> >  I think you may have misunderstood my proposal.  Currently is.nan, is.finite
> >  and is.infinite have no data.frame methods, so the default method is used.
> >  The problem is that the default method is too permissive:  it operates on the
> >  data.frame by treating it as a list; then it returns FALSE for each list
> >  element.  (If there is only one row, it applies the test to the singleton in
> >  the column.)   This is pretty strange default behaviour.
> >
> >  What I'm proposing is that the default method should trigger an error if you
> >  try to send it anything that's not atomic.  This gives sensible behaviour in
> >  most cases; the only one where it doesn't work is a list of singletons, which
> >  used to be handled sensibly, but will now fail.
> >
> >  (There's still a question about what the answer should be for these functions
> >  when applied to character or raw vectors, which are both atomic.  I'm leaning
> >  towards returning FALSE for every element, which matches the current
> >  behaviour, but perhaps those should also generate an error.)
>
> I noticed you did not mention integer vectors.  Those are no
> different from character or raw: there are no NaN (nor infinite)
> integer elements.  I don't see it should be an error to ask in those
> cases.

Right, in those cases I think it's clear that is.finite should return 
TRUE for every element except NA_integer_, and is.infinite and is.nan 
should return FALSE.  I would treat logical the same way since we often 
promote logical to integer in a calculation.

Duncan Murdoch

> >
> >  I think this partially addresses Bill's objection, but not completely.
> >  Someone could still put a class on an atomic vector, and that might not be
> >  handled properly by the default method.
> >
> >>  People should  *apply (or *ply) on data frames, and not expect
> >>  that all kind of functions have data.frame methods
> >>  which are simply equivalent to basically  sapply(<df>,<function>)
> >>
> >>  {and yes -- all this belongs to R-devel rather than R-help}
> >
> >  Where I've moved it now.
> >
> >  Duncan Murdoch
> >>  Martin
> >>
> >>       >>   I wanted to recode every NaN and Inf value of an entire
> >>       >>   data.frame to NA. The data.frame also includes character
> >>       >>   variables. So the following might work (?)  (Can't test
> >>       >>   it here)
> >>       >>
> >>       >>   ditch<- function(x) ifelse(is.infinite(x) | is.nan(x),
> >>       >>   NA, x) df<- apply(df, 2, ditch)
> >>       >>
> >>       >>
> >>       >>
> >>       >>
> >>       >>
> >>       >>   ________________________________ From: William
> >>       >>   Dunlap<wdunlap at tibco.com>
> >>       >>
> >>       >>   Cc: R Mailing List<r-help at r-project.org>   Sent: Fri, May
> >>       >>   27, 2011 12:57:01 AM Subject: RE: [R] NaN, Inf to NA
> >>       >>
> >>       >>   I think the source of the OP's problem is that while
> >>       >>   things like df>30 and is.na(df) return a logical matrix
> >>       >>   with the dimensions of the data.frame df, both
> >>       >>   is.infinite(df) and is.nan(df) return a logical vector as
> >>       >>   long as the number of columns of df.  (`>` and is.na have
> >>       >>   data.frame methods but is.infinite and is.nan do not: the
> >>       >>   latter give garbage results for data.frames.)
> >>       >>
> >>       >>   Bill Dunlap Spotfire, TIBCO Software wdunlap tibco.com
> >>       >>
> >>       >>>   -----Original Message----- From:
> >>       >>>   r-help-bounces at r-project.org
> >>       >>>   [mailto:r-help-bounces at r-project.org] On Behalf Of Marc
> >>       >>>   Schwartz Sent: Thursday, May 26, 2011 2:15 PM To:
> >>       >>>   Albert-Jan Roskam Cc: R Mailing List Subject: Re: [R]
> >>       >>>   NaN, Inf to NA
> >>       >>>
> >>       >>>   On May 26, 2011, at 3:18 PM, Albert-Jan Roskam wrote:
> >>       >>>
> >>       >>>>   Hi,
> >>       >>>>
> >>       >>>>   I want to recode all Inf and NaN values to NA, but I;m
> >>       >>>   surprised to see the
> >>       >>>>   result of the following code. Could anybody enlighten
> >>       >>>>   me
> >>       >>>   about this?
> >>       >>>>
> >>       >>>>>   df<- data.frame(a=c(NA, NaN, Inf, 1:3))
> >>       >>>>>   df[is.infinite(df) | is.nan(df)]<- NA df
> >>       >>>>   a 1 NA 2 NaN 3 Inf 4 1 5 2 6 3
> >>       >>>>>
> >>       >>>>
> >>  >>>
> >>  >>>   Thanks!
> >>       >>>>
> >>       >>>>   Cheers!!  Albert-Jan
> >>       >>>
> >>       >>>
> >>       >>>   The canonical way is to use is.na() to assign the NA
> >>       >>>   value based upon a condition. See ?is.na for more
> >>       >>>   information.
> >>       >>>
> >>       >>>   is.na(df$a)<- !is.finite(df$a)
> >>       >>>
> >>       >>>>   df
> >>       >>>   a 1 NA 2 NA 3 NA 4 1 5 2 6 3
> >>       >>>
> >>       >>>
> >>       >>>   HTH,
> >>       >>>
> >>       >>>   Marc Schwartz
> >>       >>>
> >>       >>>   ______________________________________________
> >>       >>>   R-help at r-project.org mailing list
> >>       >>>   https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
> >>       >>>   read the posting guide
> >>       >>>   http://www.R-project.org/posting-guide.html and provide
> >>       >>>   commented, minimal, self-contained, reproducible code.
> >>       >>>
> >>       >>
> >>  >   [[alternative HTML version deleted]]
> >>       >>
> >>       >>   ______________________________________________
> >>       >>   R-help at r-project.org mailing list
> >>       >>   https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
> >>       >>   read the posting guide
> >>       >>   http://www.R-project.org/posting-guide.html and provide
> >>       >>   commented, minimal, self-contained, reproducible code.
> >>
> >>       >   ______________________________________________
> >>       >   R-help at r-project.org mailing list
> >>       >   https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do
> >>       >   read the posting guide
> >>       >   http://www.R-project.org/posting-guide.html and provide
> >>       >   commented, minimal, self-contained, reproducible code.
> >
> >  ______________________________________________
> >  R-devel at r-project.org mailing list
> >  https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>


From murdoch.duncan at gmail.com  Fri May 27 19:56:32 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 27 May 2011 13:56:32 -0400
Subject: [Rd] [R] NaN, Inf to NA
In-Reply-To: <29F48FEA-CC98-4E2D-9574-FC0F5F8C516A@me.com>
References: <902176.39554.qm@web110703.mail.gq1.yahoo.com>
	<2514ACD4-6654-45F1-A71F-1528DF05919E@me.com>
	<77EB52C6DD32BA4D87471DCD70C8D7000442F527@NA-PA-VBE03.na.tibco.com>
	<868607.63263.qm@web110716.mail.gq1.yahoo.com>
	<4DDF97B2.6070601@gmail.com>
	<19935.48920.703526.489158@stat.math.ethz.ch>
	<4DDFC43E.9070609@gmail.com>
	<29F48FEA-CC98-4E2D-9574-FC0F5F8C516A@me.com>
Message-ID: <4DDFE5D0.1010405@gmail.com>

Okay, I've now committed these changes to R-devel.  We'll see over the 
next few days if CRAN packages were making use of the old 
permissiveness, and if necessary modify or revert the change.

Duncan Murdoch

On 27/05/2011 11:52 AM, Marc Schwartz wrote:
> On May 27, 2011, at 10:33 AM, Duncan Murdoch wrote:
>
> >  On 27/05/2011 11:11 AM, Martin Maechler wrote:
> >>  >>>>>   Duncan Murdoch<murdoch.duncan at gmail.com>
> >>  >>>>>       on Fri, 27 May 2011 08:23:14 -0400 writes:
> >>
> >>      >   On 11-05-27 4:27 AM, Albert-Jan Roskam wrote:
> >>      >>   Aha! Thank you very much for that clarification! It would
> >>      >>   be much more user friendly if R generated a
> >>      >>   NotImplementedError or something similar. The 'garbage
> >>      >>   results' are pretty misleading, esp. to a novice.
> >>
> >>      >   I think that's a good idea.  The default methods are
> >>      >   documented to work on atomic vectors; dataframes are not
> >>      >   atomic vectors, so it would be reasonable to generate an
> >>      >   error.  (See ?is.atomic for a definition of atomic
> >>      >   vectors.)
> >>
> >>      >   I'll see if this causes a lot of trouble...
> >>
> >>      >   Duncan Murdoch
> >>
> >>  Duncan,
> >>  do you remember the issue of mean(), var(), median(),... etc
> >>  that was the topic a few weeks ago ?
> >>
> >>  I strongly advocated that  mean.data.frame() should become
> >>  *deprecated*, and I would propose the same for the functions
> >>  mentioned here.
> >
> >  I think you may have misunderstood my proposal.  Currently is.nan, is.finite and is.infinite have no data.frame methods, so the default method is used.  The problem is that the default method is too permissive:  it operates on the data.frame by treating it as a list; then it returns FALSE for each list element.  (If there is only one row, it applies the test to the singleton in the column.)   This is pretty strange default behaviour.
> >
> >  What I'm proposing is that the default method should trigger an error if you try to send it anything that's not atomic.  This gives sensible behaviour in most cases; the only one where it doesn't work is a list of singletons, which used to be handled sensibly, but will now fail.
> >
> >  (There's still a question about what the answer should be for these functions when applied to character or raw vectors, which are both atomic.  I'm leaning towards returning FALSE for every element, which matches the current behaviour, but perhaps those should also generate an error.)
> >
> >  I think this partially addresses Bill's objection, but not completely.  Someone could still put a class on an atomic vector, and that might not be handled properly by the default method.
> >
> >>  People should  *apply (or *ply) on data frames, and not expect
> >>  that all kind of functions have data.frame methods
> >>  which are simply equivalent to basically  sapply(<df>,<function>)
> >>
> >>  {and yes -- all this belongs to R-devel rather than R-help}
> >
> >  Where I've moved it now.
> >
> >  Duncan Murdoch
> >>  Martin
>
>
> I snipped some of the older content and added Bill.
>
> It seems to me that unless the 'x' argument is both atomic and numeric, these functions really don't have much utility, if you are going to implement standard default behavior and more rigorous error checking.
>
> So I would support adding an error message if both conditions are not passed, rather than an unpredictable result, which an unsuspecting useR might not catch.
>
> I agree that the non-default methods should be deprecated.
>
> Regards,
>
> Marc
>


From bjorn.robroek at gmail.com  Sat May 28 14:53:21 2011
From: bjorn.robroek at gmail.com (unpeatable)
Date: Sat, 28 May 2011 05:53:21 -0700 (PDT)
Subject: [Rd] Nested design
Message-ID: <1306587201493-3557388.post@n4.nabble.com>

Dear R-users,
I have the following problem. I have performed an experiment for which I
gathered a lot of data which I now want to test. The problem is that I
cannot find an appropriate test in R (I am a starter) and someone might give
me a hand. This is what I have done:
Across three sites (Site), I have laid out five transects (Trans)...meaning
five transects in each sites. In each transect I have five Microhabitats
(MH) which should be regarded as subplots (I think). In each transect, every
MH has the same position (so they are not randomized). I now want to test
the effect of Site and MH (nested in Trans) on my response variables.

This is what I do now: model<-aov(Response~Site*MH+error(Trans/MH))

I get the following output: 

Error: Trans
     Df   Sum Sq  Mean Sq
Site  1 0.030294 0.030294

Error: Trans:MH
     Df  Sum Sq Mean Sq
Site  1 10.8367 10.8367
MH    3  0.2836  0.0945

Error: Within
          Df  Sum Sq Mean Sq F value    Pr(>F)    
Site       2 0.92504 0.46252 11.7304 5.880e-05 ***
MH         4 1.86688 0.46672 11.8370 5.645e-07 ***
Site:MH    8 1.17041 0.14630  3.7105  0.001615 ** 
Residuals 54 2.12917 0.03943                      
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

How do I read this?
Any help appreciated!

BTW: I also tried the lme function: model<-lme(Response~Site*MH,
random=~1|Trans/MH)
but then the output is really complicated.

-----
Dr. Bjorn JM Robroek
Ecology and Biodiversity Group
Institute of Environmental Biology, Utrecht University
Padualaan 8, 3584 CH Utrecht, The Netherlands
Email address: b.j.m.robroek at uu.nl
http://www.researcherid.com/rid/C-4379-2008
Tel: +31-(0)30-253 6091
--
View this message in context: http://r.789695.n4.nabble.com/Nested-design-tp3557388p3557388.html
Sent from the R devel mailing list archive at Nabble.com.


From murdoch.duncan at gmail.com  Sat May 28 17:33:50 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 28 May 2011 11:33:50 -0400
Subject: [Rd] [R] NaN, Inf to NA
In-Reply-To: <29F48FEA-CC98-4E2D-9574-FC0F5F8C516A@me.com>
References: <902176.39554.qm@web110703.mail.gq1.yahoo.com>
	<2514ACD4-6654-45F1-A71F-1528DF05919E@me.com>
	<77EB52C6DD32BA4D87471DCD70C8D7000442F527@NA-PA-VBE03.na.tibco.com>
	<868607.63263.qm@web110716.mail.gq1.yahoo.com>
	<4DDF97B2.6070601@gmail.com>
	<19935.48920.703526.489158@stat.math.ethz.ch>
	<4DDFC43E.9070609@gmail.com>
	<29F48FEA-CC98-4E2D-9574-FC0F5F8C516A@me.com>
Message-ID: <4DE115DE.7040006@gmail.com>

On 27/05/2011 11:52 AM, Marc Schwartz wrote:
>
> On May 27, 2011, at 10:33 AM, Duncan Murdoch wrote:
>
>> On 27/05/2011 11:11 AM, Martin Maechler wrote:
>>>>>>>>   Duncan Murdoch<murdoch.duncan at gmail.com>
>>>>>>>>       on Fri, 27 May 2011 08:23:14 -0400 writes:
>>>
>>>      >   On 11-05-27 4:27 AM, Albert-Jan Roskam wrote:
>>>      >>   Aha! Thank you very much for that clarification! It would
>>>      >>   be much more user friendly if R generated a
>>>      >>   NotImplementedError or something similar. The 'garbage
>>>      >>   results' are pretty misleading, esp. to a novice.
>>>
>>>      >   I think that's a good idea.  The default methods are
>>>      >   documented to work on atomic vectors; dataframes are not
>>>      >   atomic vectors, so it would be reasonable to generate an
>>>      >   error.  (See ?is.atomic for a definition of atomic
>>>      >   vectors.)
>>>
>>>      >   I'll see if this causes a lot of trouble...
>>>
>>>      >   Duncan Murdoch
>>>
>>> Duncan,
>>> do you remember the issue of mean(), var(), median(),... etc
>>> that was the topic a few weeks ago ?
>>>
>>> I strongly advocated that  mean.data.frame() should become
>>> *deprecated*, and I would propose the same for the functions
>>> mentioned here.
>>
>> I think you may have misunderstood my proposal.  Currently is.nan, is.finite and is.infinite have no data.frame methods, so the default method is used.  The problem is that the default method is too permissive:  it operates on the data.frame by treating it as a list; then it returns FALSE for each list element.  (If there is only one row, it applies the test to the singleton in the column.)   This is pretty strange default behaviour.
>>
>> What I'm proposing is that the default method should trigger an error if you try to send it anything that's not atomic.  This gives sensible behaviour in most cases; the only one where it doesn't work is a list of singletons, which used to be handled sensibly, but will now fail.
>>
>> (There's still a question about what the answer should be for these functions when applied to character or raw vectors, which are both atomic.  I'm leaning towards returning FALSE for every element, which matches the current behaviour, but perhaps those should also generate an error.)
>>
>> I think this partially addresses Bill's objection, but not completely.  Someone could still put a class on an atomic vector, and that might not be handled properly by the default method.
>>
>>> People should  *apply (or *ply) on data frames, and not expect
>>> that all kind of functions have data.frame methods
>>> which are simply equivalent to basically  sapply(<df>,<function>)
>>>
>>> {and yes -- all this belongs to R-devel rather than R-help}
>>
>> Where I've moved it now.
>>
>> Duncan Murdoch
>>> Martin
>
>
> I snipped some of the older content and added Bill.
>
> It seems to me that unless the 'x' argument is both atomic and numeric, these functions really don't have much utility, if you are going to implement standard default behavior and more rigorous error checking.

In the commit yesterday I signalled an error for character or raw vector 
input, and this caused about 30 packages to fail testing.  I checked a 
couple of them, and they both had applied one of the functions to 
character data.  Before introducing the error, these tests were 
basically harmless.

One example had code like this:

stop.na.inf <- function(x) {
   if(any(is.na(x)) | any(is.infinite(x)))
         stop("Either an NA or an infinite in the data: ",
              deparse(substitute(x)), ".\n",
              "   Eliminate those values or use imputation")
}

This little utility function was used a lot, including on character 
data.  Since it is rather ugly to say which types are okay to pass, I've 
reverted that part of the change and am running new tests, I will commit 
soon.

(The test could be improved a little; I'll send advice to the author on 
that.  But I don't think we should require x not to be a character vector.)

Duncan Murdoch

>
> So I would support adding an error message if both conditions are not passed, rather than an unpredictable result, which an unsuspecting useR might not catch.
>
> I agree that the non-default methods should be deprecated.
>
> Regards,
>
> Marc
>


From oowar at yahoo.com  Mon May 30 14:36:08 2011
From: oowar at yahoo.com (Orin Richards)
Date: Mon, 30 May 2011 13:36:08 +0100 (BST)
Subject: [Rd] Table Figures and Listings
Message-ID: <435849.69375.qm@web29710.mail.ird.yahoo.com>

Dear All,
I am fairly new to R.  I work mainly in SAS.  Now, I know that SAS is approved 
by the FDA for submissions.  My question is, does  the FDA approve {R} for 
clinical trial  submissions.  Also has anyone ever tried to produce TFL's using 
R.  I would like to know how difficult it to produce the TFL's in R as compared 
to SAS.  I know that in SAS it is not difficult once you know what you are doing 
and what is required.  My limited knowledge of R  suggests that it may be a bit 
more difficult.  Can anyone please provide me with some guidance or sample code 
for producing a standard table or listing.  A good starting point can be a 
demography table.  I can produce a demog table quite easily in SAS.  My R 
knowledge is limited that's why I have ask for some sample code.



Thanks for your help.


Orin


From f.harrell at vanderbilt.edu  Mon May 30 14:49:52 2011
From: f.harrell at vanderbilt.edu (Frank Harrell)
Date: Mon, 30 May 2011 05:49:52 -0700 (PDT)
Subject: [Rd] Table Figures and Listings
In-Reply-To: <435849.69375.qm@web29710.mail.ird.yahoo.com>
References: <435849.69375.qm@web29710.mail.ird.yahoo.com>
Message-ID: <1306759792535-3560653.post@n4.nabble.com>

It is a common misperception that FDA "approves" software other than the
software used to drive medical devices such as pacemakers.  You can use any
software to make FDA submissions.  FDA gets submissions in Minitab and
Excel, for example.  That being said, base R is CFR11 compliant (see
www.r-project.org).

We developed the rreport package for R for clinical trials reporting
including FDA submission.  rreport includes several very high-level
functions for baseline stats, labs, AEs, etc.  Once you marry R with LaTeX
the sky is the limit.  And the graphics in R can be used to convert many
tired old listings to graphics as we have done for AEs.  See
http://biostat.mc.vanderbilt.edu/Rreport and
http://biostat.mc.vanderbilt.edu/wiki/pub/Main/StatGraphCourse/graphscourse.pdf

Frank

Orin Richards wrote:
> 
> Dear All,
> I am fairly new to R.  I work mainly in SAS.  Now, I know that SAS is
> approved 
> by the FDA for submissions.  My question is, does  the FDA approve {R} for 
> clinical trial  submissions.  Also has anyone ever tried to produce TFL's
> using 
> R.  I would like to know how difficult it to produce the TFL's in R as
> compared 
> to SAS.  I know that in SAS it is not difficult once you know what you are
> doing 
> and what is required.  My limited knowledge of R  suggests that it may be
> a bit 
> more difficult.  Can anyone please provide me with some guidance or sample
> code 
> for producing a standard table or listing.  A good starting point can be a 
> demography table.  I can produce a demog table quite easily in SAS.  My R 
> knowledge is limited that's why I have ask for some sample code.
> 
> 
> 
> Thanks for your help.
> 
> 
> Orin
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


-----
Frank Harrell
Department of Biostatistics, Vanderbilt University
--
View this message in context: http://r.789695.n4.nabble.com/Table-Figures-and-Listings-tp3560634p3560653.html
Sent from the R devel mailing list archive at Nabble.com.


From janko.thyson.rstuff at googlemail.com  Mon May 30 17:54:44 2011
From: janko.thyson.rstuff at googlemail.com (Janko Thyson)
Date: Mon, 30 May 2011 17:54:44 +0200
Subject: [Rd] Query super- and subclasses of a class: is there a better way
 than to use 'completeClassDefinition()'
Message-ID: <4DE3BDC4.8050009@googlemail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110530/2dd0429f/attachment.pl>

From romain at r-enthusiasts.com  Tue May 31 10:34:54 2011
From: romain at r-enthusiasts.com (Romain Francois)
Date: Tue, 31 May 2011 10:34:54 +0200
Subject: [Rd] assignInNamespace and new bindings
Message-ID: <4DE4A82E.7060803@r-enthusiasts.com>

Hello,

assignInNamespace refuses to assign an object to a name that is not 
already used in the namespace.

Something like this would make it possible:

--- src/library/utils/R/objects.R	(revision 56024)
+++ src/library/utils/R/objects.R	(working copy)
@@ -252,8 +252,9 @@
              stop("environment specified is not a package")
          ns <- asNamespace(substring(nm, 9L))
      } else ns <- asNamespace(ns)
-    if(bindingIsLocked(x, ns)) {
-        unlockBinding(x, ns)
+    new_binding <- !exists(x,ns)
+    if( new_binding || bindingIsLocked(x, ns)) {
+        if(!new_binding) unlockBinding(x, ns)
          assign(x, value, envir = ns, inherits = FALSE)
          w <- options("warn")
          on.exit(options(w))

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
http://romain-francois.com
|- http://bit.ly/hdKhCy : Rcpp article in JSS
|- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
`- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th


From ripley at stats.ox.ac.uk  Tue May 31 11:47:02 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 31 May 2011 10:47:02 +0100
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <4DE4A82E.7060803@r-enthusiasts.com>
References: <4DE4A82E.7060803@r-enthusiasts.com>
Message-ID: <alpine.LFD.2.02.1105311044280.28857@toucan.stats.ox.ac.uk>

On Tue, 31 May 2011, Romain Francois wrote:

> Hello,
>
> assignInNamespace refuses to assign an object to a name that is not already 
> used in the namespace.

That's intentional, and as documented:

      ?assignInNamespace? and ?fixInNamespace? are invoked for their
      side effect of changing the object in the name space.
                     ^^^^^^^^

I very much doubt we want to allow adding objects.

>
> Something like this would make it possible:
>
> --- src/library/utils/R/objects.R	(revision 56024)
> +++ src/library/utils/R/objects.R	(working copy)
> @@ -252,8 +252,9 @@
>             stop("environment specified is not a package")
>         ns <- asNamespace(substring(nm, 9L))
>     } else ns <- asNamespace(ns)
> -    if(bindingIsLocked(x, ns)) {
> -        unlockBinding(x, ns)
> +    new_binding <- !exists(x,ns)
> +    if( new_binding || bindingIsLocked(x, ns)) {
> +        if(!new_binding) unlockBinding(x, ns)
>         assign(x, value, envir = ns, inherits = FALSE)
>         w <- options("warn")
>         on.exit(options(w))
>
> Romain
>
> -- 
> Romain Francois
> Professional R Enthusiast
> +33(0) 6 28 91 30 30
> http://romainfrancois.blog.free.fr
> http://romain-francois.com
> |- http://bit.ly/hdKhCy : Rcpp article in JSS
> |- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
> `- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue May 31 12:01:22 2011
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 31 May 2011 11:01:22 +0100
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <alpine.LFD.2.02.1105311044280.28857@toucan.stats.ox.ac.uk>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<alpine.LFD.2.02.1105311044280.28857@toucan.stats.ox.ac.uk>
Message-ID: <alpine.LFD.2.02.1105311100290.32362@gannet.stats.ox.ac.uk>

On Tue, 31 May 2011, Prof Brian Ripley wrote:

> On Tue, 31 May 2011, Romain Francois wrote:
>
>> Hello,
>> 
>> assignInNamespace refuses to assign an object to a name that is not already 
>> used in the namespace.
>
> That's intentional, and as documented:
>
>     ?assignInNamespace? and ?fixInNamespace? are invoked for their
>     side effect of changing the object in the name space.
>                    ^^^^^^^^
>
> I very much doubt we want to allow adding objects.

Even clearer, the Note says

      They can only be used to change the values of objects in the name
      space, not to create new objects.


>
>> 
>> Something like this would make it possible:
>> 
>> --- src/library/utils/R/objects.R	(revision 56024)
>> +++ src/library/utils/R/objects.R	(working copy)
>> @@ -252,8 +252,9 @@
>>             stop("environment specified is not a package")
>>         ns <- asNamespace(substring(nm, 9L))
>>     } else ns <- asNamespace(ns)
>> -    if(bindingIsLocked(x, ns)) {
>> -        unlockBinding(x, ns)
>> +    new_binding <- !exists(x,ns)
>> +    if( new_binding || bindingIsLocked(x, ns)) {
>> +        if(!new_binding) unlockBinding(x, ns)
>>         assign(x, value, envir = ns, inherits = FALSE)
>>         w <- options("warn")
>>         on.exit(options(w))
>> 
>> Romain
>> 
>> -- 
>> Romain Francois
>> Professional R Enthusiast
>> +33(0) 6 28 91 30 30
>> http://romainfrancois.blog.free.fr
>> http://romain-francois.com
>> |- http://bit.ly/hdKhCy : Rcpp article in JSS
>> |- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
>> `- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ken.sensei at gmail.com  Tue May 31 13:35:24 2011
From: ken.sensei at gmail.com (Mohit Dayal)
Date: Tue, 31 May 2011 17:05:24 +0530
Subject: [Rd] Projection Pursuit Index
Message-ID: <BANLkTi=LZ-MobMi=N=yp6h6ciitmJHcxnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110531/ef7e0787/attachment.pl>

From ken.sensei at gmail.com  Tue May 31 13:56:08 2011
From: ken.sensei at gmail.com (Mohit Dayal)
Date: Tue, 31 May 2011 17:26:08 +0530
Subject: [Rd] Fwd: Projection Pursuit Index
In-Reply-To: <BANLkTi=LZ-MobMi=N=yp6h6ciitmJHcxnw@mail.gmail.com>
References: <BANLkTi=LZ-MobMi=N=yp6h6ciitmJHcxnw@mail.gmail.com>
Message-ID: <BANLkTimANnpppeUMRcHTHsA4B+qwbW2BiQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110531/3d189363/attachment.pl>

From romain at r-enthusiasts.com  Tue May 31 14:09:49 2011
From: romain at r-enthusiasts.com (Romain Francois)
Date: Tue, 31 May 2011 14:09:49 +0200
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <alpine.LFD.2.02.1105311100290.32362@gannet.stats.ox.ac.uk>
References: <4DE4A82E.7060803@r-enthusiasts.com>	<alpine.LFD.2.02.1105311044280.28857@toucan.stats.ox.ac.uk>
	<alpine.LFD.2.02.1105311100290.32362@gannet.stats.ox.ac.uk>
Message-ID: <4DE4DA8D.9050000@r-enthusiasts.com>

Le 31/05/11 12:01, Prof Brian Ripley a ?crit :
> On Tue, 31 May 2011, Prof Brian Ripley wrote:
>
>> On Tue, 31 May 2011, Romain Francois wrote:
>>
>>> Hello,
>>>
>>> assignInNamespace refuses to assign an object to a name that is not
>>> already used in the namespace.
>>
>> That's intentional, and as documented:
>>
>> ?assignInNamespace? and ?fixInNamespace? are invoked for their
>> side effect of changing the object in the name space.
>> ^^^^^^^^
>>
>> I very much doubt we want to allow adding objects.
>
> Even clearer, the Note says
>
> They can only be used to change the values of objects in the name
> space, not to create new objects.

Sure.

I'll just keep using this small workaround, unexported from the next Rcpp:

# just like assignInNamespace but first checks that the binding exists 

forceAssignInNamespace <- function( x, value, env ){
     is_ns <- isNamespace( env )
     if( is_ns && exists( x, env ) && bindingIsLocked(x, env ) ){
         unlockBinding( x, env )
     }

     assign( x, value, env )

     if( is_ns ){
         lockBinding( x, env )
     }
}

I find this useful for when a package wants to assign in its own namespace.

Romain

>>> Something like this would make it possible:
>>>
>>> --- src/library/utils/R/objects.R (revision 56024)
>>> +++ src/library/utils/R/objects.R (working copy)
>>> @@ -252,8 +252,9 @@
>>> stop("environment specified is not a package")
>>> ns <- asNamespace(substring(nm, 9L))
>>> } else ns <- asNamespace(ns)
>>> - if(bindingIsLocked(x, ns)) {
>>> - unlockBinding(x, ns)
>>> + new_binding <- !exists(x,ns)
>>> + if( new_binding || bindingIsLocked(x, ns)) {
>>> + if(!new_binding) unlockBinding(x, ns)
>>> assign(x, value, envir = ns, inherits = FALSE)
>>> w <- options("warn")
>>> on.exit(options(w))
>>>
>>> Romain
>>>
>>> --
>>> Romain Francois
>>> Professional R Enthusiast
>>> +33(0) 6 28 91 30 30
>>> http://romainfrancois.blog.free.fr
>>> http://romain-francois.com
>>> |- http://bit.ly/hdKhCy : Rcpp article in JSS
>>> |- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
>>> `- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Brian D. Ripley, ripley at stats.ox.ac.uk
>> Professor of Applied Statistics, http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford, Tel: +44 1865 272861 (self)
>> 1 South Parks Road, +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK Fax: +44 1865 272595
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
http://romain-francois.com
|- http://bit.ly/hdKhCy : Rcpp article in JSS
|- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
`- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th


From luke-tierney at uiowa.edu  Tue May 31 15:16:16 2011
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Tue, 31 May 2011 08:16:16 -0500
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <4DE4DA8D.9050000@r-enthusiasts.com>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<alpine.LFD.2.02.1105311044280.28857@toucan.stats.ox.ac.uk>
	<alpine.LFD.2.02.1105311100290.32362@gannet.stats.ox.ac.uk>
	<4DE4DA8D.9050000@r-enthusiasts.com>
Message-ID: <alpine.DEB.2.00.1105310813190.2045@luke-inspiron>

Also note at the beginning of of th help file:

      Utility functions to access and replace the non-exported functions
      in a name space, for use in developing packages with name spaces.
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This is intended only as a developer convenience, not as something to
be used in production code. It is quite deliberate the name spaces are
intended to be read-only once created. This allows the compiler to
make assumptions about functions/constants defined in a name space.
For now the compiler only uses this infomation for the base packages,
but that could change in the future.

Best,

luke

On Tue, 31 May 2011, Romain Francois wrote:

> Le 31/05/11 12:01, Prof Brian Ripley a ?crit :
>> On Tue, 31 May 2011, Prof Brian Ripley wrote:
>>
>>> On Tue, 31 May 2011, Romain Francois wrote:
>>>
>>>> Hello,
>>>>
>>>> assignInNamespace refuses to assign an object to a name that is not
>>>> already used in the namespace.
>>>
>>> That's intentional, and as documented:
>>>
>>> ?assignInNamespace? and ?fixInNamespace? are invoked for their
>>> side effect of changing the object in the name space.
>>> ^^^^^^^^
>>>
>>> I very much doubt we want to allow adding objects.
>>
>> Even clearer, the Note says
>>
>> They can only be used to change the values of objects in the name
>> space, not to create new objects.
>
> Sure.
>
> I'll just keep using this small workaround, unexported from the next Rcpp:
>
> # just like assignInNamespace but first checks that the binding exists 
>
> forceAssignInNamespace <- function( x, value, env ){
>     is_ns <- isNamespace( env )
>     if( is_ns && exists( x, env ) && bindingIsLocked(x, env ) ){
>         unlockBinding( x, env )
>     }
>
>     assign( x, value, env )
>
>     if( is_ns ){
>         lockBinding( x, env )
>     }
> }
>
> I find this useful for when a package wants to assign in its own namespace.
>
> Romain
>
>>>> Something like this would make it possible:
>>>>
>>>> --- src/library/utils/R/objects.R (revision 56024)
>>>> +++ src/library/utils/R/objects.R (working copy)
>>>> @@ -252,8 +252,9 @@
>>>> stop("environment specified is not a package")
>>>> ns <- asNamespace(substring(nm, 9L))
>>>> } else ns <- asNamespace(ns)
>>>> - if(bindingIsLocked(x, ns)) {
>>>> - unlockBinding(x, ns)
>>>> + new_binding <- !exists(x,ns)
>>>> + if( new_binding || bindingIsLocked(x, ns)) {
>>>> + if(!new_binding) unlockBinding(x, ns)
>>>> assign(x, value, envir = ns, inherits = FALSE)
>>>> w <- options("warn")
>>>> on.exit(options(w))
>>>>
>>>> Romain
>>>>
>>>> --
>>>> Romain Francois
>>>> Professional R Enthusiast
>>>> +33(0) 6 28 91 30 30
>>>> http://romainfrancois.blog.free.fr
>>>> http://romain-francois.com
>>>> |- http://bit.ly/hdKhCy : Rcpp article in JSS
>>>> |- http://bit.ly/elZJRJ : Montpellier Comedie Club - Avril 2011
>>>> `- http://bit.ly/fhqbRC : Rcpp workshop in Chicago on April 28th
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Brian D. Ripley, ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics, http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford, Tel: +44 1865 272861 (self)
>>> 1 South Parks Road, +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK Fax: +44 1865 272595
>>
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>

-- 
Luke Tierney
Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From mtmorgan at fhcrc.org  Tue May 31 18:15:52 2011
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 31 May 2011 09:15:52 -0700
Subject: [Rd] Query super- and subclasses of a class: is there a better
 way than to use 'completeClassDefinition()'
In-Reply-To: <4DE3BDC4.8050009@googlemail.com>
References: <4DE3BDC4.8050009@googlemail.com>
Message-ID: <4DE51438.6030109@fhcrc.org>

On 05/30/2011 08:54 AM, Janko Thyson wrote:
> Dear List,
>
> when I first started to use S4 classes, I used the function
> 'completeClassDef()' in order to see the super- and subclasses of a
> certain class:

Hi Janko -- I think 'complete' is meant as an adverb here; what you 
might want is names(getClassDef("A")@subclasses) (see 
slotNames(class(getClassDef("A"))) for other useful info).

Martin

>
> setClass(Class="A", representation=list(a="numeric"))
> setClass(Class="B", contains="A", representation=list(b="character"))
> # Super
> x<- completeClassDefinition("B")
> attributes(x)
> names(x at contains)
> # Sub
> x<- completeClassDefinition("A")
> attributes(x)
> names(x at subclasses)
>
> This also does the trick for Reference Classes for me. However, I
> re-read the respective section on the help page and wondered if I should
> be more careful about using this function for this purpose as the page says:
> "|completeClassDefinition: |Completes the definition of |Class|,
> relative to the class definitions visible from environment |where|. If
> |doExtends| is |TRUE|, complete the super- and sub-class information.
> This function is called when a class is defined or re-defined."
>
> So here are my questions:
> 1) Is it safe to call 'completeClassDef()' explicitly or can anything be
> "overwritten" by this?
> 2) Is there a better way to query the super-/subclasses of a certain
> S4/Reference Class?
>
> Best regards and I'd like to take this opportunity to express my
> gratitude to everyone on this list who takes the time to provide such
> great help!
> Janko
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Tue May 31 20:16:40 2011
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 31 May 2011 20:16:40 +0200
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <alpine.DEB.2.00.1105310813190.2045@luke-inspiron>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<4DE4DA8D.9050000@r-enthusiasts.com>
	<alpine.DEB.2.00.1105310813190.2045@luke-inspiron>
Message-ID: <201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>

On Tuesday 31 May 2011, luke-tierney at uiowa.edu wrote:
> Also note at the beginning of of th help file:
> 
>       Utility functions to access and replace the non-exported functions
>       in a name space, for use in developing packages with name spaces.
>                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> 
> This is intended only as a developer convenience, not as something to
> be used in production code. It is quite deliberate the name spaces are
> intended to be read-only once created. This allows the compiler to
> make assumptions about functions/constants defined in a name space.
> For now the compiler only uses this infomation for the base packages,
> but that could change in the future.

Could you elaborate a bit? In RKWard, we do make use of assignInNamespace(), 
mostly in order to insert hooks into functions where there are none by 
default. For example, in order to get correct interleaving of output generated 
by system() commands, and R output, we insert two calls for synchronization 
inside base::system() and base::system2(). As another example, we add some 
code into utils::select.list() to provide our own UI if graphics=TRUE. In 
total, currently, we have around a dozen calls to assignInNamespace(), for 
which I do not see any workable alternative.

None of these changes the function formals, environment, or type of return 
value. All of this is done only once, at the start of the session. Should I be 
worried that it will still interact badly with the compiler?

Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110531/efe27061/attachment.bin>

From simon.urbanek at r-project.org  Tue May 31 20:54:34 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 31 May 2011 14:54:34 -0400
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<4DE4DA8D.9050000@r-enthusiasts.com>
	<alpine.DEB.2.00.1105310813190.2045@luke-inspiron>
	<201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <74462CF4-AE5B-4034-BF2A-1B98734B4BB5@r-project.org>

Thomas,

On May 31, 2011, at 2:16 PM, Thomas Friedrichsmeier wrote:

> On Tuesday 31 May 2011, luke-tierney at uiowa.edu wrote:
>> Also note at the beginning of of th help file:
>> 
>>      Utility functions to access and replace the non-exported functions
>>      in a name space, for use in developing packages with name spaces.
>>                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>> 
>> This is intended only as a developer convenience, not as something to
>> be used in production code. It is quite deliberate the name spaces are
>> intended to be read-only once created. This allows the compiler to
>> make assumptions about functions/constants defined in a name space.
>> For now the compiler only uses this infomation for the base packages,
>> but that could change in the future.
> 
> Could you elaborate a bit? In RKWard, we do make use of assignInNamespace(), 
> mostly in order to insert hooks into functions where there are none by 
> default. For example, in order to get correct interleaving of output generated 
> by system() commands, and R output, we insert two calls for synchronization 
> inside base::system() and base::system2(). As another example, we add some 
> code into utils::select.list() to provide our own UI if graphics=TRUE. In 
> total, currently, we have around a dozen calls to assignInNamespace(), for 
> which I do not see any workable alternative.
> 
> None of these changes the function formals, environment, or type of return 
> value. All of this is done only once, at the start of the session. Should I be 
> worried that it will still interact badly with the compiler?
> 

I would expect so, but I'll let Luke comment on it. It is definitely a very bad idea.

R provides facilities for customization and other GUIs are using them properly. If you are lacking anything, I would suggest asking here first - it is much easier to add a useful customization path to R than to deal with hacks that are fragile due to unjustified assumptions. As a user, I'm really worried about packages modifying other packages behind my back (but I may be more paranoid than others).

Cheers,
Simon


From luke-tierney at uiowa.edu  Tue May 31 20:54:38 2011
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Tue, 31 May 2011 13:54:38 -0500
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<4DE4DA8D.9050000@r-enthusiasts.com>
	<alpine.DEB.2.00.1105310813190.2045@luke-inspiron>
	<201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <alpine.DEB.2.00.1105311353280.2045@luke-inspiron>

On Tue, 31 May 2011, Thomas Friedrichsmeier wrote:

> On Tuesday 31 May 2011, luke-tierney at uiowa.edu wrote:
>> Also note at the beginning of of th help file:
>>
>>       Utility functions to access and replace the non-exported functions
>>       in a name space, for use in developing packages with name spaces.
>>                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
>>
>> This is intended only as a developer convenience, not as something to
>> be used in production code. It is quite deliberate the name spaces are
>> intended to be read-only once created. This allows the compiler to
>> make assumptions about functions/constants defined in a name space.
>> For now the compiler only uses this infomation for the base packages,
>> but that could change in the future.
>
> Could you elaborate a bit? In RKWard, we do make use of assignInNamespace(),
> mostly in order to insert hooks into functions where there are none by
> default. For example, in order to get correct interleaving of output generated
> by system() commands, and R output, we insert two calls for synchronization
> inside base::system() and base::system2(). As another example, we add some
> code into utils::select.list() to provide our own UI if graphics=TRUE. In
> total, currently, we have around a dozen calls to assignInNamespace(), for
> which I do not see any workable alternative.
>
> None of these changes the function formals, environment, or type of return
> value. All of this is done only once, at the start of the session. Should I be
> worried that it will still interact badly with the compiler?

Yes you should. Changing things in other people's packages is not a
safe thing to do.

Best,

luke

>
> Regards
> Thomas
>

-- 
Luke Tierney
Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From rpbarry at alaska.edu  Tue May 31 21:29:10 2011
From: rpbarry at alaska.edu (Ronald Barry)
Date: Tue, 31 May 2011 11:29:10 -0800
Subject: [Rd] Comment on build and INSTALL
Message-ID: <BANLkTikbQ+9aczkq_Tvht68Q1t=Fc6yvzg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110531/681e3871/attachment.pl>

From murdoch.duncan at gmail.com  Tue May 31 21:38:07 2011
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 31 May 2011 15:38:07 -0400
Subject: [Rd] Comment on build and INSTALL
In-Reply-To: <BANLkTikbQ+9aczkq_Tvht68Q1t=Fc6yvzg@mail.gmail.com>
References: <BANLkTikbQ+9aczkq_Tvht68Q1t=Fc6yvzg@mail.gmail.com>
Message-ID: <4DE5439F.601@gmail.com>

On 11-05-31 3:29 PM, Ronald Barry wrote:
> Greetings,
>    I have noticed two possible small glitches with build and INSTALL.
> First, when I run R CMD build latticeDensity, I get the following message:
>
>                   *excluding invalid files from 'latticeDensity'
>                   Subdirectory R contains invalid file names:
>                        R
>
> However, all the files end up in the zip file (or tar) just fine, and
> neither INSTALL nor check seems to care.

What is the glitch?  Do you not have a file with that name?

>
> The other small glitch is that if you have unmatched brackets in a man file,
>
> INSTALL will flag an error and point out that there are unmatched brackets,
> but will often indicate that the unmatched bracket occurs in  a different
> file
> that is in perfect shape.
>

I have never seen that.  Do you have an example?

Duncan Murdoch


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Tue May 31 22:11:37 2011
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 31 May 2011 22:11:37 +0200
Subject: [Rd] assignInNamespace and new bindings
In-Reply-To: <74462CF4-AE5B-4034-BF2A-1B98734B4BB5@r-project.org>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<74462CF4-AE5B-4034-BF2A-1B98734B4BB5@r-project.org>
Message-ID: <201105312211.41716.thomas.friedrichsmeier@ruhr-uni-bochum.de>

On Tuesday 31 May 2011, Simon Urbanek wrote:
> I would expect so, but I'll let Luke comment on it. It is definitely a very
> bad idea.
> 
> R provides facilities for customization and other GUIs are using them
> properly. If you are lacking anything, I would suggest asking here first -
> it is much easier to add a useful customization path to R than to deal
> with hacks that are fragile due to unjustified assumptions.

I am not entirely convinced that this assessment of the relative difficulty of 
these options is also true for developers outside the R core group.

But, here's my list of requirements. I know that some of these have been 
requested on r-devel before. I'd appreciate, if you can help me with at least 
some:

- utils::loadhistory(), utils::savehistory(), utils::timestamp(): I am not 
using, and can not use readline history. prt_R_loadHistory, ptr_R_savehistory, 
and ptr_R_addhistory are not available on Windows. And they could do with a 
bit more documentation, if GUIs are expected to use these. I need a way to 
interface with my GUIs history mechanism, cross-platform.

- utils::select.list() and utils::menu(): I want to show my own UI if 
graphics==TRUE. Currently, select.list() has special code for windows, "aqua" 
and tcltk; menu() essentially assumes the same code. Give me a way to run 
register my own UI.

- base::system(), base::system2(): As you will be aware, capturing the output 
of system commands in a GUI is tricky on Unix. I do have a solution for that, 
but I need to run synchronization code at the start and end of system() and 
system2(), in order to get interleaving right. Give me a hook, each, at the 
start and end of these functions.

- graphics::plot.new(): I need a hook *before* the new plot is started, in 
order to properly implement device-independent plot history. I would 
appreciate not having to implement my own graphics device just to be able to 
run some code at this point.

- grDevices::dev.off(): I need a hook before the device is closed. Also for 
plot history.

- grDevices::dev.set(): I need a hook after the new device has been set. Also 
for plot history.

- grid::newpage(): See graphics::plot.new(). Of course, even better, I would 
like to have a hook that is called every time before a new page / frame is 
started on a device.

> As a user, I'm
> really worried about packages modifying other packages behind my back (but
> I may be more paranoid than others).

On the level of plain R code: I am very certain that the customizations that I 
am doing are perfectly harmless, because it's pretty trivial stuff. You don't 
have to trust me on that. And of course not any more than you trust the rest 
of any other person's work, in the first place.

Of course, if what I am doing is "illegal" because it steps on the compiler's 
turf, then my assumptions do not hold, indeed. That's what I'm worried about.

Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110531/fc8ddadf/attachment.bin>

From simon.urbanek at r-project.org  Tue May 31 22:56:08 2011
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 31 May 2011 16:56:08 -0400
Subject: [Rd] GUI hooks in R [Was: assignInNamespace and new bindings]
In-Reply-To: <201105312211.41716.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<201105312016.44472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<74462CF4-AE5B-4034-BF2A-1B98734B4BB5@r-project.org>
	<201105312211.41716.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <42ECBCC7-B920-444A-9BA4-014B994A0C38@r-project.org>

On May 31, 2011, at 4:11 PM, Thomas Friedrichsmeier wrote:

> On Tuesday 31 May 2011, Simon Urbanek wrote:
>> I would expect so, but I'll let Luke comment on it. It is definitely a very
>> bad idea.
>> 
>> R provides facilities for customization and other GUIs are using them
>> properly. If you are lacking anything, I would suggest asking here first -
>> it is much easier to add a useful customization path to R than to deal
>> with hacks that are fragile due to unjustified assumptions.
> 
> I am not entirely convinced that this assessment of the relative difficulty of 
> these options is also true for developers outside the R core group.
> 
> But, here's my list of requirements. I know that some of these have been 
> requested on r-devel before. I'd appreciate, if you can help me with at least 
> some:
> 
> - utils::loadhistory(), utils::savehistory(), utils::timestamp(): I am not 
> using, and can not use readline history. prt_R_loadHistory, ptr_R_savehistory, 
> and ptr_R_addhistory are not available on Windows. And they could do with a 
> bit more documentation, if GUIs are expected to use these. I need a way to 
> interface with my GUIs history mechanism, cross-platform.
> 

The history entries are somewhat in a grey area, because most GUIs use their own implementation of history (and thus they are irrelevant) and the *history() commands are documented to only use readline-backend. That said, they could be easily used by all GUIs if the Windows code is amended.


> - utils::select.list() and utils::menu(): I want to show my own UI if 
> graphics==TRUE. Currently, select.list() has special code for windows, "aqua" 
> and tcltk; menu() essentially assumes the same code. Give me a way to run 
> register my own UI.
> 

ptr_do_selectlist provides the customization and could be extended to other platforms.


> - base::system(), base::system2(): As you will be aware, capturing the output 
> of system commands in a GUI is tricky on Unix. I do have a solution for that, 
> but I need to run synchronization code at the start and end of system() and 
> system2(), in order to get interleaving right. Give me a hook, each, at the 
> start and end of these functions.
> 

I'm not sure I understand your concern here. What exactly is your worry? Capturing output is trivial since it simply involves creating a pipe when you initialize R which you can read while R is running and the synchronization is provided by the OS, no magic involved. 


> - graphics::plot.new(): I need a hook *before* the new plot is started, in 
> order to properly implement device-independent plot history. I would 
> appreciate not having to implement my own graphics device just to be able to 
> run some code at this point.
> 
> - grDevices::dev.off(): I need a hook before the device is closed. Also for 
> plot history.
> 
> - grDevices::dev.set(): I need a hook after the new device has been set. Also 
> for plot history.
> 
> - grid::newpage(): See graphics::plot.new(). Of course, even better, I would 
> like to have a hook that is called every time before a new page / frame is 
> started on a device.
> 

For all of the above: all of them are already available a device callbacks (newPage, close, activate and newPage again).

Cheers,
Simon




>> As a user, I'm
>> really worried about packages modifying other packages behind my back (but
>> I may be more paranoid than others).
> 
> On the level of plain R code: I am very certain that the customizations that I 
> am doing are perfectly harmless, because it's pretty trivial stuff. You don't 
> have to trust me on that. And of course not any more than you trust the rest 
> of any other person's work, in the first place.
> 
> Of course, if what I am doing is "illegal" because it steps on the compiler's 
> turf, then my assumptions do not hold, indeed. That's what I'm worried about.
> 
> Regards
> Thomas
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Tue May 31 23:23:36 2011
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 31 May 2011 23:23:36 +0200
Subject: [Rd] GUI hooks in R [Was: assignInNamespace and new bindings]
In-Reply-To: <42ECBCC7-B920-444A-9BA4-014B994A0C38@r-project.org>
References: <4DE4A82E.7060803@r-enthusiasts.com>
	<201105312211.41716.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<42ECBCC7-B920-444A-9BA4-014B994A0C38@r-project.org>
Message-ID: <201105312323.40199.thomas.friedrichsmeier@ruhr-uni-bochum.de>

On Tuesday 31 May 2011, Simon Urbanek wrote:
> The history entries are somewhat in a grey area, because most GUIs use
> their own implementation of history (and thus they are irrelevant) and the
> *history() commands are documented to only use readline-backend. That
> said, they could be easily used by all GUIs if the Windows code is
> amended.

Actually, I would suggest to use a different solution, though: This is not 
really a problem that needs to be addressed on a low level of pointers to C 
functions. Perhaps it would make more sense to allow to set some R function(s) 
to handle these via options() (or perhaps via a dedicated gui.options()).

> > - utils::select.list() and utils::menu(): I want to show my own UI if
> > graphics==TRUE. Currently, select.list() has special code for windows,
> > "aqua" and tcltk; menu() essentially assumes the same code. Give me a
> > way to run register my own UI.
> 
> ptr_do_selectlist provides the customization and could be extended to other
> platforms.

See above. But yes, if at least it was cross-platform, that would be nice.

> > - base::system(), base::system2(): As you will be aware, capturing the
> > output of system commands in a GUI is tricky on Unix. I do have a
> > solution for that, but I need to run synchronization code at the start
> > and end of system() and system2(), in order to get interleaving right.
> > Give me a hook, each, at the start and end of these functions.
> 
> I'm not sure I understand your concern here. What exactly is your worry?
> Capturing output is trivial since it simply involves creating a pipe when
> you initialize R which you can read while R is running and the
> synchronization is provided by the OS, no magic involved.

Is that pipe buffered? In my setup it is. And so consider code like this:
   for (i in 1:10) {
       print (i)
       system (paste ("echo", i)) 
   }
How do you ensure that this results in
1
1
2
2
...
rather than e.g.
1
2
3
1
2
4
3
5
6
...

I could not get it to work for RKWard without adding code to make sure the 
"other" output is flushed. (Note: I'm capturing regular R output via 
R_WriteConsoleEx, since I am interested in the differentiation between output 
types that this provides. So I cannot simply push that down the same pipe.).

> > - graphics::plot.new(): I need a hook *before* the new plot is started,
> > in order to properly implement device-independent plot history. I would
> > appreciate not having to implement my own graphics device just to be
> > able to run some code at this point.
> > 
> > - grDevices::dev.off(): I need a hook before the device is closed. Also
> > for plot history.
> > 
> > - grDevices::dev.set(): I need a hook after the new device has been set.
> > Also for plot history.
> > 
> > - grid::newpage(): See graphics::plot.new(). Of course, even better, I
> > would like to have a hook that is called every time before a new page /
> > frame is started on a device.
> 
> For all of the above: all of them are already available a device callbacks
> (newPage, close, activate and newPage again).

Quoting myself: I would appreciate not having to implement my own graphics 
device just to be able to run some code at [these] point[s].

Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20110531/8cffa37f/attachment.bin>

